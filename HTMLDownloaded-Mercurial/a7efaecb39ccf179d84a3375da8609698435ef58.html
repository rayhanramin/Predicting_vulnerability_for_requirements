<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 26418:a7efaecb39ccf179d84a3375da8609698435ef58</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ a7efaecb39ccf179d84a3375da8609698435ef58" />
<meta property="og:url" content="/comm-central/rev/a7efaecb39ccf179d84a3375da8609698435ef58" />
<meta property="og:description" content="Bug 1535725 - Follow-up: Fix multiple retrievals of bounding rect on same object. r=darktrojan" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / a7efaecb39ccf179d84a3375da8609698435ef58 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/a7efaecb39ccf179d84a3375da8609698435ef58">shortlog</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/a7efaecb39ccf179d84a3375da8609698435ef58">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58">files</a> |
changeset |
<a href="/comm-central/raw-rev/a7efaecb39ccf179d84a3375da8609698435ef58">raw</a>  | <a href="/comm-central/archive/a7efaecb39ccf179d84a3375da8609698435ef58.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1535725">Bug 1535725</a> - Follow-up: Fix multiple retrievals of bounding rect on same object. r=darktrojan
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#74;&#111;&#114;&#103;&#32;&#75;&#32;&#60;&#106;&#111;&#114;&#103;&#107;&#64;&#106;&#111;&#114;&#103;&#107;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Wed, 24 Apr 2019 09:26:01 +0200</td></tr>

<tr>
 <td>changeset 26418</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/a7efaecb39ccf179d84a3375da8609698435ef58">a7efaecb39ccf179d84a3375da8609698435ef58</a></td>
</tr>



<tr>
<td>parent 26417</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/409270f0615f29d21970eb823da2d7beb911bb1e">409270f0615f29d21970eb823da2d7beb911bb1e</a>
</td>
</tr>

<tr>
<td>child 26419</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/800083958fbff28505e21949e35db34901c9d71d">800083958fbff28505e21949e35db34901c9d71d</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=a7efaecb39ccf179d84a3375da8609698435ef58">15829</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Wed, 24 Apr 2019 08:37:09 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@4965f8d61f03 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=4965f8d61f03bad242a90df92454e5fd52763f4f">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=4965f8d61f03bad242a90df92454e5fd52763f4f&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=4965f8d61f03bad242a90df92454e5fd52763f4f&newProject=comm-central&newRevision=a7efaecb39ccf179d84a3375da8609698435ef58&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=4965f8d61f03bad242a90df92454e5fd52763f4f&newProject=comm-central&newRevision=a7efaecb39ccf179d84a3375da8609698435ef58&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=4965f8d61f03bad242a90df92454e5fd52763f4f&newProject=comm-central&newRevision=a7efaecb39ccf179d84a3375da8609698435ef58&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28darktrojan%29&revcount=50">darktrojan</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1535725">1535725</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1535725">Bug 1535725</a> - Follow-up: Fix multiple retrievals of bounding rect on same object. r=darktrojan</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/base/content/calendar-multiday-view.xml">calendar/base/content/calendar-multiday-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/base/content/calendar-multiday-view.xml">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/base/content/calendar-multiday-view.xml">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/base/content/calendar-multiday-view.xml">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/base/content/calendar-multiday-view.xml">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/base/content/calendar-multiday-view.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">calendar/base/content/dialogs/calendar-event-dialog-recurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/test/mozmill/testTimezones.js">calendar/test/mozmill/testTimezones.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/test/mozmill/testTimezones.js">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/test/mozmill/testTimezones.js">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/test/mozmill/testTimezones.js">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/test/mozmill/testTimezones.js">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/calendar/test/mozmill/testTimezones.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/common/bindings/richlistbox.xml">common/bindings/richlistbox.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/common/bindings/richlistbox.xml">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/common/bindings/richlistbox.xml">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/common/bindings/richlistbox.xml">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/common/bindings/richlistbox.xml">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/common/bindings/richlistbox.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/common/src/customizeToolbar.js">common/src/customizeToolbar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/common/src/customizeToolbar.js">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/common/src/customizeToolbar.js">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/common/src/customizeToolbar.js">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/common/src/customizeToolbar.js">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/common/src/customizeToolbar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/editor/ui/composer/content/StructBarContextMenu.js">editor/ui/composer/content/StructBarContextMenu.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/editor/ui/composer/content/StructBarContextMenu.js">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/editor/ui/composer/content/StructBarContextMenu.js">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/editor/ui/composer/content/StructBarContextMenu.js">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/editor/ui/composer/content/StructBarContextMenu.js">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/editor/ui/composer/content/StructBarContextMenu.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/content/mailWidgets.xml">mail/base/content/mailWidgets.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/content/mailWidgets.xml">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/content/mailWidgets.xml">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/content/mailWidgets.xml">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/content/mailWidgets.xml">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/content/mailWidgets.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/content/tabmail.xml">mail/base/content/tabmail.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/content/tabmail.xml">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/content/tabmail.xml">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/content/tabmail.xml">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/content/tabmail.xml">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/content/tabmail.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/modules/GlobalPopupNotifications.jsm">mail/base/modules/GlobalPopupNotifications.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/modules/GlobalPopupNotifications.jsm">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/modules/GlobalPopupNotifications.jsm">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/modules/GlobalPopupNotifications.jsm">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/modules/GlobalPopupNotifications.jsm">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/mail/base/modules/GlobalPopupNotifications.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/components/compose/content/addressingWidgetOverlay.js">mail/components/compose/content/addressingWidgetOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/mail/components/compose/content/addressingWidgetOverlay.js">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/mail/components/compose/content/addressingWidgetOverlay.js">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/components/compose/content/addressingWidgetOverlay.js">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/mail/components/compose/content/addressingWidgetOverlay.js">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/mail/components/compose/content/addressingWidgetOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/folder-display/test-opening-messages.js">mail/test/mozmill/folder-display/test-opening-messages.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/folder-display/test-opening-messages.js">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/folder-display/test-opening-messages.js">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/folder-display/test-opening-messages.js">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/folder-display/test-opening-messages.js">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/folder-display/test-opening-messages.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">mail/test/mozmill/shared-modules/test-folder-display-helpers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/shared-modules/test-mouse-event-helpers.js">mail/test/mozmill/shared-modules/test-mouse-event-helpers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/shared-modules/test-mouse-event-helpers.js">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/shared-modules/test-mouse-event-helpers.js">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/shared-modules/test-mouse-event-helpers.js">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/shared-modules/test-mouse-event-helpers.js">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/shared-modules/test-mouse-event-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js">mail/test/mozmill/tabmail/test-tabmail-dragndrop.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mailnews/extensions/smime/content/msgCompSecurityInfo.xul">mailnews/extensions/smime/content/msgCompSecurityInfo.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/mailnews/extensions/smime/content/msgCompSecurityInfo.xul">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/mailnews/extensions/smime/content/msgCompSecurityInfo.xul">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mailnews/extensions/smime/content/msgCompSecurityInfo.xul">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/mailnews/extensions/smime/content/msgCompSecurityInfo.xul">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/mailnews/extensions/smime/content/msgCompSecurityInfo.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mailnews/import/content/fieldMapImport.xul">mailnews/import/content/fieldMapImport.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7efaecb39ccf179d84a3375da8609698435ef58/mailnews/import/content/fieldMapImport.xul">file</a> |
<a href="/comm-central/annotate/a7efaecb39ccf179d84a3375da8609698435ef58/mailnews/import/content/fieldMapImport.xul">annotate</a> |
<a href="/comm-central/diff/a7efaecb39ccf179d84a3375da8609698435ef58/mailnews/import/content/fieldMapImport.xul">diff</a> |
<a href="/comm-central/comparison/a7efaecb39ccf179d84a3375da8609698435ef58/mailnews/import/content/fieldMapImport.xul">comparison</a> |
<a href="/comm-central/log/a7efaecb39ccf179d84a3375da8609698435ef58/mailnews/import/content/fieldMapImport.xul">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -1342,22 +1342,23 @@</span>
<a href="#l1.4"></a><span id="l1.4"> </span>
<a href="#l1.5"></a><span id="l1.5">             // If we are at the bottom or top of the view (or left/right when</span>
<a href="#l1.6"></a><span id="l1.6">             // rotated), calculate the difference and start accelerating the</span>
<a href="#l1.7"></a><span id="l1.7">             // scrollbar.</span>
<a href="#l1.8"></a><span id="l1.8">             let diffStart, diffEnd;</span>
<a href="#l1.9"></a><span id="l1.9">             let orient = event.target.getAttribute(&quot;orient&quot;);</span>
<a href="#l1.10"></a><span id="l1.10">             let scrollbox = document.getAnonymousElementByAttribute(</span>
<a href="#l1.11"></a><span id="l1.11">                            event.target, &quot;anonid&quot;, &quot;scrollbox&quot;);</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+            let boundingRect = scrollbox.getBoundingClientRect();</span>
<a href="#l1.13"></a><span id="l1.13">             if (orient == &quot;vertical&quot;) {</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineminus">-                diffStart = event.clientY - scrollbox.getBoundingClientRect().y;</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineminus">-                diffEnd = scrollbox.getBoundingClientRect().y + scrollbox.getBoundingClientRect().height - event.clientY;</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineplus">+                diffStart = event.clientY - boundingRect.y;</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineplus">+                diffEnd = boundingRect.y + boundingRect.height - event.clientY;</span>
<a href="#l1.18"></a><span id="l1.18">             } else {</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineminus">-                diffStart = event.clientX - scrollbox.getBoundingClientRect().x;</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineminus">-                diffEnd = scrollbox.getBoundingClientRect().x + scrollbox.getBoundingClientRect().width - event.clientX;</span>
<a href="#l1.21"></a><span id="l1.21" class="difflineplus">+                diffStart = event.clientX - boundingRect.x;</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineplus">+                diffEnd = boundingRect.x + boundingRect.width - event.clientX;</span>
<a href="#l1.23"></a><span id="l1.23">             }</span>
<a href="#l1.24"></a><span id="l1.24"> </span>
<a href="#l1.25"></a><span id="l1.25">             const SCROLLZONE = 55;     // Size (pixels) of the top/bottom view where the scroll starts.</span>
<a href="#l1.26"></a><span id="l1.26">             const MAXTIMEOUT = 250;    // Max and min time interval (ms) between</span>
<a href="#l1.27"></a><span id="l1.27">             const MINTIMEOUT = 30;     // two consecutive scrolls.</span>
<a href="#l1.28"></a><span id="l1.28">             const SCROLLBYHOUR = 0.33; // Part of hour to move for each scroll.</span>
<a href="#l1.29"></a><span id="l1.29">             let insideScrollZone = 0;</span>
<a href="#l1.30"></a><span id="l1.30">             let pxPerHr = event.target.mPixPerMin * 60;</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineat">@@ -1365,21 +1366,20 @@</span>
<a href="#l1.32"></a><span id="l1.32">             if (diffStart &lt; SCROLLZONE) {</span>
<a href="#l1.33"></a><span id="l1.33">                 insideScrollZone = SCROLLZONE - diffStart;</span>
<a href="#l1.34"></a><span id="l1.34">                 scrollBy *= -1;</span>
<a href="#l1.35"></a><span id="l1.35">             } else if (diffEnd &lt; SCROLLZONE) {</span>
<a href="#l1.36"></a><span id="l1.36">                 insideScrollZone = SCROLLZONE - diffEnd;</span>
<a href="#l1.37"></a><span id="l1.37">             }</span>
<a href="#l1.38"></a><span id="l1.38"> </span>
<a href="#l1.39"></a><span id="l1.39">             if (insideScrollZone) {</span>
<a href="#l1.40"></a><span id="l1.40" class="difflineminus">-                let sbo = scrollbox.boxObject;</span>
<a href="#l1.41"></a><span id="l1.41">                 let timeout = MAXTIMEOUT - insideScrollZone * (MAXTIMEOUT - MINTIMEOUT) / SCROLLZONE;</span>
<a href="#l1.42"></a><span id="l1.42">                 this.mMagicScrollTimer = setTimeout(() =&gt; {</span>
<a href="#l1.43"></a><span id="l1.43" class="difflineminus">-                    sbo.scrollBy(orient == &quot;horizontal&quot; &amp;&amp; scrollBy,</span>
<a href="#l1.44"></a><span id="l1.44" class="difflineminus">-                                 orient == &quot;vertical&quot; &amp;&amp; scrollBy);</span>
<a href="#l1.45"></a><span id="l1.45" class="difflineplus">+                    scrollbox.scrollBy(orient == &quot;horizontal&quot; &amp;&amp; scrollBy,</span>
<a href="#l1.46"></a><span id="l1.46" class="difflineplus">+                                       orient == &quot;vertical&quot; &amp;&amp; scrollBy);</span>
<a href="#l1.47"></a><span id="l1.47">                     this.onEventSweepMouseMove(event);</span>
<a href="#l1.48"></a><span id="l1.48">                 }, timeout);</span>
<a href="#l1.49"></a><span id="l1.49">             }</span>
<a href="#l1.50"></a><span id="l1.50">         ]]&gt;&lt;/body&gt;</span>
<a href="#l1.51"></a><span id="l1.51">       &lt;/method&gt;</span>
<a href="#l1.52"></a><span id="l1.52"> </span>
<a href="#l1.53"></a><span id="l1.53">       &lt;!--</span>
<a href="#l1.54"></a><span id="l1.54">          - Event sweep handlers</span>
<a href="#l1.55"></a><span id="l1.55" class="difflineat">@@ -1398,20 +1398,21 @@</span>
<a href="#l1.56"></a><span id="l1.56"> </span>
<a href="#l1.57"></a><span id="l1.57">             let lateralColumns = col.firstLastShadowColumns();</span>
<a href="#l1.58"></a><span id="l1.58">             let firstCol = lateralColumns.firstCol;</span>
<a href="#l1.59"></a><span id="l1.59">             let firstIndex = lateralColumns.firstIndex;</span>
<a href="#l1.60"></a><span id="l1.60"> </span>
<a href="#l1.61"></a><span id="l1.61">             // If we leave the view, then stop our internal sweeping and start a</span>
<a href="#l1.62"></a><span id="l1.62">             // real drag session. Someday we need to fix the sweep to soely be a</span>
<a href="#l1.63"></a><span id="l1.63">             // drag session, no sweeping.</span>
<a href="#l1.64"></a><span id="l1.64" class="difflineminus">-            if (event.clientX &lt; (event.target.getBoundingClientRect().x) ||</span>
<a href="#l1.65"></a><span id="l1.65" class="difflineminus">-                event.clientX &gt; (event.target.getBoundingClientRect().x + event.target.getBoundingClientRect().width) ||</span>
<a href="#l1.66"></a><span id="l1.66" class="difflineminus">-                event.clientY &lt; (event.target.getBoundingClientRect().y) ||</span>
<a href="#l1.67"></a><span id="l1.67" class="difflineminus">-                event.clientY &gt; (event.target.getBoundingClientRect().y + event.target.getBoundingClientRect().height)) {</span>
<a href="#l1.68"></a><span id="l1.68" class="difflineplus">+            let boundingRect = event.target.getBoundingClientRect();</span>
<a href="#l1.69"></a><span id="l1.69" class="difflineplus">+            if (event.clientX &lt; (boundingRect.x) ||</span>
<a href="#l1.70"></a><span id="l1.70" class="difflineplus">+                event.clientX &gt; (boundingRect.x + boundingRect.width) ||</span>
<a href="#l1.71"></a><span id="l1.71" class="difflineplus">+                event.clientY &lt; (boundingRect.y) ||</span>
<a href="#l1.72"></a><span id="l1.72" class="difflineplus">+                event.clientY &gt; (boundingRect.y + boundingRect.height)) {</span>
<a href="#l1.73"></a><span id="l1.73">                 // Remove the drag state</span>
<a href="#l1.74"></a><span id="l1.74">                 for (let column = firstCol, i = firstIndex;</span>
<a href="#l1.75"></a><span id="l1.75">                      column &amp;&amp; i &lt; col.mDragState.shadows;</span>
<a href="#l1.76"></a><span id="l1.76">                      column = column.nextSibling, i++) {</span>
<a href="#l1.77"></a><span id="l1.77">                     column.fgboxes.dragbox.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l1.78"></a><span id="l1.78">                     column.fgboxes.box.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l1.79"></a><span id="l1.79">                 }</span>
<a href="#l1.80"></a><span id="l1.80"> </span>
<a href="#l1.81"></a><span id="l1.81" class="difflineat">@@ -3562,20 +3563,21 @@</span>
<a href="#l1.82"></a><span id="l1.82">         &lt;parameter name=&quot;aClientX&quot;/&gt;</span>
<a href="#l1.83"></a><span id="l1.83">         &lt;parameter name=&quot;aClientY&quot;/&gt;</span>
<a href="#l1.84"></a><span id="l1.84">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l1.85"></a><span id="l1.85">             if (!this.mDateColumns) {</span>
<a href="#l1.86"></a><span id="l1.86">                 return null;</span>
<a href="#l1.87"></a><span id="l1.87">             }</span>
<a href="#l1.88"></a><span id="l1.88">             for (let col of this.mDateColumns) {</span>
<a href="#l1.89"></a><span id="l1.89">                 let element = document.getAnonymousElementByAttribute(col.column, &quot;anonid&quot;, &quot;boxstack&quot;);</span>
<a href="#l1.90"></a><span id="l1.90" class="difflineplus">+                let boundingRect = element.getBoundingClientRect();</span>
<a href="#l1.91"></a><span id="l1.91">                 if (aClientX &gt;= element.screenX &amp;&amp;</span>
<a href="#l1.92"></a><span id="l1.92" class="difflineminus">-                    aClientX &lt;= (element.screenX + element.getBoundingClientRect().width) &amp;&amp;</span>
<a href="#l1.93"></a><span id="l1.93" class="difflineplus">+                    aClientX &lt;= (element.screenX + boundingRect.width) &amp;&amp;</span>
<a href="#l1.94"></a><span id="l1.94">                     aClientY &gt;= element.screenY &amp;&amp;</span>
<a href="#l1.95"></a><span id="l1.95" class="difflineminus">-                    aClientY &lt;= (element.screenY + element.getBoundingClientRect().height)) {</span>
<a href="#l1.96"></a><span id="l1.96" class="difflineplus">+                    aClientY &lt;= (element.screenY + boundingRect.height)) {</span>
<a href="#l1.97"></a><span id="l1.97">                     return col.column;</span>
<a href="#l1.98"></a><span id="l1.98">                 }</span>
<a href="#l1.99"></a><span id="l1.99">             }</span>
<a href="#l1.100"></a><span id="l1.100">             return null;</span>
<a href="#l1.101"></a><span id="l1.101">         ]]&gt;&lt;/body&gt;</span>
<a href="#l1.102"></a><span id="l1.102">       &lt;/method&gt;</span>
<a href="#l1.103"></a><span id="l1.103"> </span>
<a href="#l1.104"></a><span id="l1.104">       &lt;method name=&quot;adjustScrollbarSpacersForAlldayEvents&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -57,26 +57,28 @@ const RecurrencePreview = {</span>
<a href="#l2.4"></a><span id="l2.4">      * Updates #recurrence-preview node layout on window resize.</span>
<a href="#l2.5"></a><span id="l2.5">      */</span>
<a href="#l2.6"></a><span id="l2.6">     onResize() {</span>
<a href="#l2.7"></a><span id="l2.7">         let minimonth = this.node.querySelector(&quot;minimonth&quot;);</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9">         let row = this.node.querySelector(&quot;row&quot;);</span>
<a href="#l2.10"></a><span id="l2.10">         let rows = row.parentNode;</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-        let contentWidth = minimonth.getBoundingClientRect().width;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-        let containerWidth = this.node.getBoundingClientRect().width;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+        let minimonthRect = minimonth.getBoundingClientRect();</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+        let nodeRect = this.node.getBoundingClientRect();</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+        let contentWidth = minimonthRect.width;</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+        let containerWidth = nodeRect.width;</span>
<a href="#l2.18"></a><span id="l2.18"> </span>
<a href="#l2.19"></a><span id="l2.19">         // Now find out how much elements can be displayed.</span>
<a href="#l2.20"></a><span id="l2.20">         // this is a simple division which always yields a positive integer value.</span>
<a href="#l2.21"></a><span id="l2.21">         const cWidth = containerWidth % contentWidth;</span>
<a href="#l2.22"></a><span id="l2.22">         let numHorizontal = (containerWidth - cWidth) / contentWidth;</span>
<a href="#l2.23"></a><span id="l2.23"> </span>
<a href="#l2.24"></a><span id="l2.24" class="difflineminus">-        let contentHeight = minimonth.getBoundingClientRect().height;</span>
<a href="#l2.25"></a><span id="l2.25" class="difflineminus">-        let containerHeight = this.node.getBoundingClientRect().height;</span>
<a href="#l2.26"></a><span id="l2.26" class="difflineplus">+        let contentHeight = minimonthRect.height;</span>
<a href="#l2.27"></a><span id="l2.27" class="difflineplus">+        let containerHeight = nodeRect.height;</span>
<a href="#l2.28"></a><span id="l2.28"> </span>
<a href="#l2.29"></a><span id="l2.29">         const cHeight = containerHeight % contentHeight;</span>
<a href="#l2.30"></a><span id="l2.30">         // Now find out how much elements can be displayed.</span>
<a href="#l2.31"></a><span id="l2.31">         // this is a simple division which always yields a positive integer value.</span>
<a href="#l2.32"></a><span id="l2.32">         let numVertical = (containerHeight - cHeight) / contentHeight;</span>
<a href="#l2.33"></a><span id="l2.33"> </span>
<a href="#l2.34"></a><span id="l2.34">         // Count the number of existing rows</span>
<a href="#l2.35"></a><span id="l2.35">         let numRows = 0;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/test/mozmill/testTimezones.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/test/mozmill/testTimezones.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -261,17 +261,18 @@ function verify(controller, dates, timez</span>
<a href="#l3.4"></a><span id="l3.4">     for (let [selectedYear, selectedMonth, selectedDay, selectedTime] of datetimes()) {</span>
<a href="#l3.5"></a><span id="l3.5">         goToDate(controller, selectedYear, selectedMonth, selectedDay);</span>
<a href="#l3.6"></a><span id="l3.6"> </span>
<a href="#l3.7"></a><span id="l3.7">         // Find event with timezone tz.</span>
<a href="#l3.8"></a><span id="l3.8">         for (let tzIdx = 0; tzIdx &lt; timezones.length; tzIdx++) {</span>
<a href="#l3.9"></a><span id="l3.9">             let [correctHour, minutes, day] = selectedTime[tzIdx];</span>
<a href="#l3.10"></a><span id="l3.10"> </span>
<a href="#l3.11"></a><span id="l3.11">             let timeNode = lookup(`${timeLine}/[${correctHour}]`).getNode();</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-            let timeY = timeNode.getBoundingClientRect().y + timeNode.getBoundingClientRect().height * (minutes / 60);</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+            let boundingRect = timeNode.getBoundingClientRect();</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+            let timeY = boundingRect.y + boundingRect.height * (minutes / 60);</span>
<a href="#l3.15"></a><span id="l3.15"> </span>
<a href="#l3.16"></a><span id="l3.16">             let eventNodes = [];</span>
<a href="#l3.17"></a><span id="l3.17"> </span>
<a href="#l3.18"></a><span id="l3.18">             // following day</span>
<a href="#l3.19"></a><span id="l3.19">             if (day == 1) {</span>
<a href="#l3.20"></a><span id="l3.20">                 viewForward(controller, 1);</span>
<a href="#l3.21"></a><span id="l3.21">             } else if (day == -1) {</span>
<a href="#l3.22"></a><span id="l3.22">                 viewBack(controller, 1);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/common/bindings/richlistbox.xml</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/common/bindings/richlistbox.xml</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -666,18 +666,19 @@</span>
<a href="#l4.4"></a><span id="l4.4">         &lt;body&gt;</span>
<a href="#l4.5"></a><span id="l4.5">           &lt;![CDATA[</span>
<a href="#l4.6"></a><span id="l4.6">             if (!aItem)</span>
<a href="#l4.7"></a><span id="l4.7">               return false;</span>
<a href="#l4.8"></a><span id="l4.8"> </span>
<a href="#l4.9"></a><span id="l4.9">             var y = this.scrollTop + this.getBoundingClientRect().y;</span>
<a href="#l4.10"></a><span id="l4.10"> </span>
<a href="#l4.11"></a><span id="l4.11">             // Partially visible items are also considered visible</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-            return (aItem.getBoundingClientRect().y + aItem.clientHeight &gt; y) &amp;&amp;</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-                   (aItem.getBoundingClientRect().y &lt; y + this.clientHeight);</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+            let boundingRect = aItem.getBoundingClientRect();</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+            return (boundingRect.y + aItem.clientHeight &gt; y) &amp;&amp;</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+                   (boundingRect.y &lt; y + this.clientHeight);</span>
<a href="#l4.17"></a><span id="l4.17">           ]]&gt;</span>
<a href="#l4.18"></a><span id="l4.18">         &lt;/body&gt;</span>
<a href="#l4.19"></a><span id="l4.19">       &lt;/method&gt;</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21">       &lt;property name=&quot;suppressOnSelect&quot;</span>
<a href="#l4.22"></a><span id="l4.22">                 onget=&quot;return this.getAttribute('suppressonselect') == 'true';&quot;</span>
<a href="#l4.23"></a><span id="l4.23">                 onset=&quot;this.setAttribute('suppressonselect', val);&quot;/&gt;</span>
<a href="#l4.24"></a><span id="l4.24"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/common/src/customizeToolbar.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/common/src/customizeToolbar.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -108,19 +108,20 @@ function repositionDialog(aWindow) {</span>
<a href="#l5.4"></a><span id="l5.4"> </span>
<a href="#l5.5"></a><span id="l5.5">   var width;</span>
<a href="#l5.6"></a><span id="l5.6">   if (aWindow != window)</span>
<a href="#l5.7"></a><span id="l5.7">     width = aWindow.getBoundingClientRect().width;</span>
<a href="#l5.8"></a><span id="l5.8">   else if (document.documentElement.hasAttribute(&quot;width&quot;))</span>
<a href="#l5.9"></a><span id="l5.9">     width = document.documentElement.getAttribute(&quot;width&quot;);</span>
<a href="#l5.10"></a><span id="l5.10">   else</span>
<a href="#l5.11"></a><span id="l5.11">     width = parseInt(document.documentElement.style.width);</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+  var boundingRect = gToolbox.getBoundingClientRect();</span>
<a href="#l5.13"></a><span id="l5.13">   var screenX = gToolbox.screenX</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineminus">-                + ((gToolbox.getBoundingClientRect().width - width) / 2);</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineminus">-  var screenY = gToolbox.screenY + gToolbox.getBoundingClientRect().height;</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+                + ((boundingRect.width - width) / 2);</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+  var screenY = gToolbox.screenY + boundingRect.height;</span>
<a href="#l5.18"></a><span id="l5.18"> </span>
<a href="#l5.19"></a><span id="l5.19">   aWindow.moveTo(screenX, screenY);</span>
<a href="#l5.20"></a><span id="l5.20"> }</span>
<a href="#l5.21"></a><span id="l5.21"> </span>
<a href="#l5.22"></a><span id="l5.22"> function removeToolboxListeners() {</span>
<a href="#l5.23"></a><span id="l5.23">   var elts = getRootElements();</span>
<a href="#l5.24"></a><span id="l5.24">   for (let i = 0; i &lt; elts.length; i++) {</span>
<a href="#l5.25"></a><span id="l5.25">     elts[i].removeEventListener(&quot;dragstart&quot;, onToolbarDragStart, true);</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineat">@@ -669,17 +670,18 @@ function onToolbarDragOver(aEvent) {</span>
<a href="#l5.27"></a><span id="l5.27">   var previousDragItem = gCurrentDragOverItem;</span>
<a href="#l5.28"></a><span id="l5.28"> </span>
<a href="#l5.29"></a><span id="l5.29">   if (dropTarget.localName == &quot;toolbar&quot;) {</span>
<a href="#l5.30"></a><span id="l5.30">     gCurrentDragOverItem = dropTarget;</span>
<a href="#l5.31"></a><span id="l5.31">   } else {</span>
<a href="#l5.32"></a><span id="l5.32">     gCurrentDragOverItem = null;</span>
<a href="#l5.33"></a><span id="l5.33"> </span>
<a href="#l5.34"></a><span id="l5.34">     var direction = window.getComputedStyle(dropTarget.parentNode).direction;</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineminus">-    var dropTargetCenter = dropTarget.getBoundingClientRect().x + (dropTarget.getBoundingClientRect().width / 2);</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineplus">+    var boundingRect = dropTarget.getBoundingClientRect();</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+    var dropTargetCenter = boundingRect.x + (boundingRect.width / 2);</span>
<a href="#l5.38"></a><span id="l5.38">     var dragAfter;</span>
<a href="#l5.39"></a><span id="l5.39">     if (direction == &quot;ltr&quot;)</span>
<a href="#l5.40"></a><span id="l5.40">       dragAfter = aEvent.clientX &gt; dropTargetCenter;</span>
<a href="#l5.41"></a><span id="l5.41">     else</span>
<a href="#l5.42"></a><span id="l5.42">       dragAfter = aEvent.clientX &lt; dropTargetCenter;</span>
<a href="#l5.43"></a><span id="l5.43"> </span>
<a href="#l5.44"></a><span id="l5.44">     if (dragAfter) {</span>
<a href="#l5.45"></a><span id="l5.45">       gCurrentDragOverItem = dropTarget.nextSibling;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/editor/ui/composer/content/StructBarContextMenu.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/editor/ui/composer/content/StructBarContextMenu.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -106,17 +106,17 @@ function MoveChildNodesAfterElement(edit</span>
<a href="#l6.4"></a><span id="l6.4">     editor.insertNode(clone, targetElement.parentNode, targetOffset + 1);</span>
<a href="#l6.5"></a><span id="l6.5">   }</span>
<a href="#l6.6"></a><span id="l6.6"> }</span>
<a href="#l6.7"></a><span id="l6.7"> </span>
<a href="#l6.8"></a><span id="l6.8"> function StructChangeTag()</span>
<a href="#l6.9"></a><span id="l6.9"> {</span>
<a href="#l6.10"></a><span id="l6.10">   var textbox = document.createElementNS(XUL_NS, &quot;textbox&quot;);</span>
<a href="#l6.11"></a><span id="l6.11">   textbox.setAttribute(&quot;value&quot;, gContextMenuNode.getAttribute(&quot;value&quot;));</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-  textbox.setAttribute(&quot;width&quot;, gContextMenuNode.boxObject.width);</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+  textbox.setAttribute(&quot;width&quot;, gContextMenuNode.getBoundingClientRect().width);</span>
<a href="#l6.14"></a><span id="l6.14">   textbox.className = &quot;struct-textbox&quot;;</span>
<a href="#l6.15"></a><span id="l6.15"> </span>
<a href="#l6.16"></a><span id="l6.16">   gContextMenuNode.parentNode.replaceChild(textbox, gContextMenuNode);</span>
<a href="#l6.17"></a><span id="l6.17"> </span>
<a href="#l6.18"></a><span id="l6.18">   textbox.addEventListener(&quot;keypress&quot;, OnKeyPress);</span>
<a href="#l6.19"></a><span id="l6.19">   textbox.addEventListener(&quot;blur&quot;, ResetStructToolbar, true);</span>
<a href="#l6.20"></a><span id="l6.20"> </span>
<a href="#l6.21"></a><span id="l6.21">   textbox.select();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/base/content/mailWidgets.xml</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/base/content/mailWidgets.xml</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -139,25 +139,25 @@</span>
<a href="#l7.4"></a><span id="l7.4">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l7.5"></a><span id="l7.5">           this.ensureElementIsVisible(this.getItemAtIndex(index));</span>
<a href="#l7.6"></a><span id="l7.6">         ]]&gt;&lt;/body&gt;</span>
<a href="#l7.7"></a><span id="l7.7">       &lt;/method&gt;</span>
<a href="#l7.8"></a><span id="l7.8">       &lt;method name=&quot;ensureElementIsVisible&quot;&gt;</span>
<a href="#l7.9"></a><span id="l7.9">         &lt;parameter name=&quot;item&quot;/&gt;</span>
<a href="#l7.10"></a><span id="l7.10">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l7.11"></a><span id="l7.11">           let box = this;</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+          let boxRect = box.getBoundingClientRect();</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+          let itemRect = item.getBoundingClientRect();</span>
<a href="#l7.14"></a><span id="l7.14"> </span>
<a href="#l7.15"></a><span id="l7.15">           // Are we too far down?</span>
<a href="#l7.16"></a><span id="l7.16">           if (item.screenY &lt; box.screenY)</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineminus">-            box.scrollTop = item.getBoundingClientRect().y - box.getBoundingClientRect().y;</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+            box.scrollTop = itemRect.y - boxRect.y;</span>
<a href="#l7.19"></a><span id="l7.19">           // ... or not far enough?</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineminus">-          else if (item.screenY + item.getBoundingClientRect().height &gt;</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineminus">-                   box.screenY + box.getBoundingClientRect().height)</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineminus">-            box.scrollTop = item.getBoundingClientRect().y + item.getBoundingClientRect().height -</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineminus">-                            box.getBoundingClientRect().y - box.getBoundingClientRect().height;</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineplus">+          else if (item.screenY + itemRect.height &gt; box.screenY + boxRect.height)</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineplus">+            box.scrollTop = itemRect.y + itemRect.height - boxRect.y - boxRect.height;</span>
<a href="#l7.26"></a><span id="l7.26">         ]]&gt;&lt;/body&gt;</span>
<a href="#l7.27"></a><span id="l7.27">       &lt;/method&gt;</span>
<a href="#l7.28"></a><span id="l7.28">       &lt;method name=&quot;scrollToIndex&quot;&gt;</span>
<a href="#l7.29"></a><span id="l7.29">         &lt;parameter name=&quot;index&quot;/&gt;</span>
<a href="#l7.30"></a><span id="l7.30">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l7.31"></a><span id="l7.31">           let box = this;</span>
<a href="#l7.32"></a><span id="l7.32">           let item = this.getItemAtIndex(index);</span>
<a href="#l7.33"></a><span id="l7.33">           if (!item)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/base/content/tabmail.xml</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/base/content/tabmail.xml</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -2295,20 +2295,21 @@</span>
<a href="#l8.4"></a><span id="l8.4">           if (event.target.localName != &quot;tab&quot;)</span>
<a href="#l8.5"></a><span id="l8.5">             return null;</span>
<a href="#l8.6"></a><span id="l8.6"> </span>
<a href="#l8.7"></a><span id="l8.7">           let tab = event.target;</span>
<a href="#l8.8"></a><span id="l8.8"> </span>
<a href="#l8.9"></a><span id="l8.9">           if ((event.type != &quot;drop&quot;) &amp;&amp; (event.type != &quot;dragover&quot;))</span>
<a href="#l8.10"></a><span id="l8.10">             return tab;</span>
<a href="#l8.11"></a><span id="l8.11"> </span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-          if (event.screenX &lt; tab.screenX + tab.getBoundingClientRect().width * .25)</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+          let tabRect = tab.getBoundingClientRect();</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+          if (event.screenX &lt; tab.screenX + tabRect.width * .25)</span>
<a href="#l8.15"></a><span id="l8.15">             return null;</span>
<a href="#l8.16"></a><span id="l8.16"> </span>
<a href="#l8.17"></a><span id="l8.17" class="difflineminus">-          if (event.screenX &gt; tab.screenX + tab.getBoundingClientRect().width * .75)</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineplus">+          if (event.screenX &gt; tab.screenX + tabRect.width * .75)</span>
<a href="#l8.19"></a><span id="l8.19">             return null;</span>
<a href="#l8.20"></a><span id="l8.20"> </span>
<a href="#l8.21"></a><span id="l8.21">           return tab;</span>
<a href="#l8.22"></a><span id="l8.22">         ]]&gt;&lt;/body&gt;</span>
<a href="#l8.23"></a><span id="l8.23">       &lt;/method&gt;</span>
<a href="#l8.24"></a><span id="l8.24"> </span>
<a href="#l8.25"></a><span id="l8.25"> </span>
<a href="#l8.26"></a><span id="l8.26">       &lt;method name=&quot;_getDropIndex&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mail/base/modules/GlobalPopupNotifications.jsm</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mail/base/modules/GlobalPopupNotifications.jsm</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -827,33 +827,39 @@ PopupNotifications.prototype = {</span>
<a href="#l9.4"></a><span id="l9.4">     });</span>
<a href="#l9.5"></a><span id="l9.5">     if (!notificationsToShow.length) {</span>
<a href="#l9.6"></a><span id="l9.6">       return;</span>
<a href="#l9.7"></a><span id="l9.7">     }</span>
<a href="#l9.8"></a><span id="l9.8">     let notificationIds = notificationsToShow.map(n =&gt; n.id);</span>
<a href="#l9.9"></a><span id="l9.9"> </span>
<a href="#l9.10"></a><span id="l9.10">     this._refreshPanel(notificationsToShow);</span>
<a href="#l9.11"></a><span id="l9.11"> </span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+    function isNullOrHidden(elem) {</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+      if (!elem) {</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+        return true;</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+      }</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineplus">+</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineplus">+      let anchorRect = elem.getBoundingClientRect();</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineplus">+      return (anchorRect.width == 0 &amp;&amp; anchorRect.height == 0);</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+    }</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineplus">+</span>
<a href="#l9.21"></a><span id="l9.21">     // If the anchor element is hidden or null, fall back to the identity icon.</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineminus">-    if (!anchorElement || (anchorElement.getBoundingClientRect().height == 0 &amp;&amp;</span>
<a href="#l9.23"></a><span id="l9.23" class="difflineminus">-                           anchorElement.getBoundingClientRect().width == 0)) {</span>
<a href="#l9.24"></a><span id="l9.24" class="difflineplus">+    if (isNullOrHidden(anchorElement)) {</span>
<a href="#l9.25"></a><span id="l9.25">       anchorElement = this.window.document.getElementById(&quot;identity-icon&quot;);</span>
<a href="#l9.26"></a><span id="l9.26"> </span>
<a href="#l9.27"></a><span id="l9.27">       // If the identity icon is not available in this window, or maybe the</span>
<a href="#l9.28"></a><span id="l9.28">       // entire location bar is hidden for any reason, use the tab as the</span>
<a href="#l9.29"></a><span id="l9.29">       // anchor. We only ever show notifications for the current browser, so we</span>
<a href="#l9.30"></a><span id="l9.30">       // can just use the current tab.</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineminus">-      if (!anchorElement || (anchorElement.getBoundingClientRect().height == 0 &amp;&amp;</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineminus">-                             anchorElement.getBoundingClientRect().width == 0)) {</span>
<a href="#l9.33"></a><span id="l9.33" class="difflineplus">+      if (isNullOrHidden(anchorElement)) {</span>
<a href="#l9.34"></a><span id="l9.34">         anchorElement = this.tabbrowser.selectedTab;</span>
<a href="#l9.35"></a><span id="l9.35"> </span>
<a href="#l9.36"></a><span id="l9.36">         // If we're in an entirely chromeless environment, set the anchorElement</span>
<a href="#l9.37"></a><span id="l9.37">         // to null and let openPopup show the notification at (0,0) later.</span>
<a href="#l9.38"></a><span id="l9.38" class="difflineminus">-        if (!anchorElement || (anchorElement.getBoundingClientRect().height == 0 &amp;&amp;</span>
<a href="#l9.39"></a><span id="l9.39" class="difflineminus">-                               anchorElement.getBoundingClientRect().width == 0)) {</span>
<a href="#l9.40"></a><span id="l9.40" class="difflineplus">+        if (isNullOrHidden(anchorElement)) {</span>
<a href="#l9.41"></a><span id="l9.41">           anchorElement = null;</span>
<a href="#l9.42"></a><span id="l9.42">         }</span>
<a href="#l9.43"></a><span id="l9.43">       }</span>
<a href="#l9.44"></a><span id="l9.44">     }</span>
<a href="#l9.45"></a><span id="l9.45"> </span>
<a href="#l9.46"></a><span id="l9.46">     if (this.isPanelOpen &amp;&amp; this._currentAnchorElement == anchorElement) {</span>
<a href="#l9.47"></a><span id="l9.47">       notificationsToShow.forEach(function(n) {</span>
<a href="#l9.48"></a><span id="l9.48">         this._fireCallback(n, NOTIFICATION_EVENT_SHOWN);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mail/components/compose/content/addressingWidgetOverlay.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mail/components/compose/content/addressingWidgetOverlay.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -56,19 +56,20 @@ function awInitializeNumberOfRowsShown()</span>
<a href="#l10.4"></a><span id="l10.4">   let extraHeight = 2;</span>
<a href="#l10.5"></a><span id="l10.5"> </span>
<a href="#l10.6"></a><span id="l10.6">   // Set minimum number of rows shown for address widget, per hardwired</span>
<a href="#l10.7"></a><span id="l10.7">   // rows=&quot;1&quot; attribute of addressingWidget, to prevent resizing the</span>
<a href="#l10.8"></a><span id="l10.8">   // subject and format toolbar over the address widget.</span>
<a href="#l10.9"></a><span id="l10.9">   // This lets users shrink the address widget to one row (with delicate UX)</span>
<a href="#l10.10"></a><span id="l10.10">   // and thus maximize the space available for composition body,</span>
<a href="#l10.11"></a><span id="l10.11">   // especially on small screens.</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-  msgHeadersToolbar.minHeight = msgHeadersToolbar.getBoundingClientRect().height;</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+  let toolbarRect = msgHeadersToolbar.getBoundingClientRect();</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+  msgHeadersToolbar.minHeight = toolbarRect.height;</span>
<a href="#l10.15"></a><span id="l10.15"> </span>
<a href="#l10.16"></a><span id="l10.16" class="difflineminus">-  msgHeadersToolbar.height = msgHeadersToolbar.getBoundingClientRect().height +</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineplus">+  msgHeadersToolbar.height = toolbarRect.height +</span>
<a href="#l10.18"></a><span id="l10.18">     addressingWidget.getBoundingClientRect().height * (awNumRowsShownDefault - 1) +</span>
<a href="#l10.19"></a><span id="l10.19">     extraHeight;</span>
<a href="#l10.20"></a><span id="l10.20"> </span>
<a href="#l10.21"></a><span id="l10.21">   // Update addressingWidget internals.</span>
<a href="#l10.22"></a><span id="l10.22">   awCreateOrRemoveDummyRows();</span>
<a href="#l10.23"></a><span id="l10.23"> }</span>
<a href="#l10.24"></a><span id="l10.24"> </span>
<a href="#l10.25"></a><span id="l10.25"> function awInputElementName() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-opening-messages.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-opening-messages.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -187,18 +187,19 @@ function check_message_pane_in_tab_full_</span>
<a href="#l11.4"></a><span id="l11.4">  */</span>
<a href="#l11.5"></a><span id="l11.5"> </span>
<a href="#l11.6"></a><span id="l11.6"> function check_message_pane_in_window_full_height(aWC) {</span>
<a href="#l11.7"></a><span id="l11.7">   let messengerWindowHeight = aWC.e(&quot;messengerWindow&quot;).getBoundingClientRect().height;</span>
<a href="#l11.8"></a><span id="l11.8">   let messengerChildren = aWC.e(&quot;messengerWindow&quot;).children;</span>
<a href="#l11.9"></a><span id="l11.9">   let childrenHeightsSum = 0;</span>
<a href="#l11.10"></a><span id="l11.10">   let childrenHeightsStr = &quot;&quot;;</span>
<a href="#l11.11"></a><span id="l11.11">   for (let child of messengerChildren) {</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-    if (&quot;boxObject&quot; in child) {</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-      childrenHeightsSum += child.getBoundingClientRect().height;</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineminus">-      childrenHeightsStr += '&quot;' + child.id + '&quot;: ' + child.getBoundingClientRect().height + ', ';</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineminus">-    }</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineplus">+    try {</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineplus">+      let childRect = child.getBoundingClientRect();</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineplus">+      childrenHeightsSum += childRect.height;</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineplus">+      childrenHeightsStr += '&quot;' + child.id + '&quot;: ' + childRect.height + ', ';</span>
<a href="#l11.20"></a><span id="l11.20" class="difflineplus">+    } catch (ex) {}</span>
<a href="#l11.21"></a><span id="l11.21">   }</span>
<a href="#l11.22"></a><span id="l11.22"> </span>
<a href="#l11.23"></a><span id="l11.23">   assert_equals(messengerWindowHeight, childrenHeightsSum,</span>
<a href="#l11.24"></a><span id="l11.24">     &quot;messenger window height not equal to the sum of children heights: &quot; +</span>
<a href="#l11.25"></a><span id="l11.25">     childrenHeightsStr);</span>
<a href="#l11.26"></a><span id="l11.26"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-folder-display-helpers.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/test-folder-display-helpers.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -1091,22 +1091,24 @@ function select_shift_click_row(aViewInd</span>
<a href="#l12.4"></a><span id="l12.4">  * Helper function to click on a row with a given button.</span>
<a href="#l12.5"></a><span id="l12.5">  */</span>
<a href="#l12.6"></a><span id="l12.6"> function _row_click_helper(aController, aTree, aViewIndex, aButton, aExtra) {</span>
<a href="#l12.7"></a><span id="l12.7">   // Force-focus the tree</span>
<a href="#l12.8"></a><span id="l12.8">   aTree.focus();</span>
<a href="#l12.9"></a><span id="l12.9">   // very important, gotta be able to see the row</span>
<a href="#l12.10"></a><span id="l12.10">   aTree.ensureRowIsVisible(aViewIndex);</span>
<a href="#l12.11"></a><span id="l12.11">   // coordinates of the upper left of the entire tree widget (headers included)</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  let tx = aTree.getBoundingClientRect().x, ty = aTree.getBoundingClientRect().y;</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+  let treeRect = aTree.getBoundingClientRect();</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+  let tx = treeRect.x, ty = treeRect.y;</span>
<a href="#l12.15"></a><span id="l12.15">   // coordinates of the row display region of the tree (below the headers)</span>
<a href="#l12.16"></a><span id="l12.16">   let children = aController.e(aTree.id, {tagName: &quot;treechildren&quot;});</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineminus">-  let x = children.getBoundingClientRect().x, y = children.getBoundingClientRect().y;</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+  let childrenRect = children.getBoundingClientRect();</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+  let x = childrenRect.x, y = childrenRect.y;</span>
<a href="#l12.20"></a><span id="l12.20">   // Click in the middle of the row by default</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineminus">-  let rowX = children.getBoundingClientRect().width / 2;</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineplus">+  let rowX = childrenRect.width / 2;</span>
<a href="#l12.23"></a><span id="l12.23">   // For the thread tree, Position our click on the subject column (which cannot</span>
<a href="#l12.24"></a><span id="l12.24">   // be hidden), and far enough in that we are in no danger of clicking the</span>
<a href="#l12.25"></a><span id="l12.25">   // expand toggler unless that is explicitly requested.</span>
<a href="#l12.26"></a><span id="l12.26">   if (aTree.id == &quot;threadTree&quot;) {</span>
<a href="#l12.27"></a><span id="l12.27">     let subjectCol = aController.e(&quot;subjectCol&quot;);</span>
<a href="#l12.28"></a><span id="l12.28">     rowX = subjectCol.getBoundingClientRect().x - tx + 8;</span>
<a href="#l12.29"></a><span id="l12.29">     // click on the toggle if so requested</span>
<a href="#l12.30"></a><span id="l12.30">     if (aExtra !== &quot;toggle&quot;)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-mouse-event-helpers.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/test-mouse-event-helpers.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -50,21 +50,20 @@ function installInto(module) {</span>
<a href="#l13.4"></a><span id="l13.4"> function drag_n_drop_element(aDragObject, aDragWindow, aDropObject,</span>
<a href="#l13.5"></a><span id="l13.5">                              aDropWindow, aRelDropX, aRelDropY, aListener)</span>
<a href="#l13.6"></a><span id="l13.6"> {</span>
<a href="#l13.7"></a><span id="l13.7">   let dt = synthesize_drag_start(aDragWindow, aDragObject, aListener);</span>
<a href="#l13.8"></a><span id="l13.8">   fdh.assert_true(dt, &quot;Drag target was undefined&quot;);</span>
<a href="#l13.9"></a><span id="l13.9"> </span>
<a href="#l13.10"></a><span id="l13.10">   synthesize_drag_over(aDropWindow, aDropObject, dt);</span>
<a href="#l13.11"></a><span id="l13.11"> </span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+  let dropRect = aDropObject.getBoundingClientRect();</span>
<a href="#l13.13"></a><span id="l13.13">   synthesize_drop(aDropWindow, aDropObject, dt,</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineminus">-      { screenX : aDropObject.screenX +</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineminus">-                    (aDropObject.getBoundingClientRect().width * aRelDropX),</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineminus">-        screenY : aDropObject.screenY +</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineminus">-                    (aDropObject.getBoundingClientRect().width * aRelDropY)</span>
<a href="#l13.18"></a><span id="l13.18" class="difflineplus">+      { screenX : aDropObject.screenX + (dropRect.width * aRelDropX),</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineplus">+        screenY : aDropObject.screenY + (dropRect.height * aRelDropY)</span>
<a href="#l13.20"></a><span id="l13.20">       });</span>
<a href="#l13.21"></a><span id="l13.21"> }</span>
<a href="#l13.22"></a><span id="l13.22"> </span>
<a href="#l13.23"></a><span id="l13.23"> /**</span>
<a href="#l13.24"></a><span id="l13.24">  * Starts a drag new session.</span>
<a href="#l13.25"></a><span id="l13.25">  * @param {} aWindow</span>
<a href="#l13.26"></a><span id="l13.26">  * @param {XULElement} aDispatcher</span>
<a href="#l13.27"></a><span id="l13.27">  *   the element from which the drag session should be started.</span>
<a href="#l13.28"></a><span id="l13.28" class="difflineat">@@ -166,21 +165,21 @@ function synthesize_drop(aWindow, aDispa</span>
<a href="#l13.29"></a><span id="l13.29">  *   arguments passed to the mouse event.</span>
<a href="#l13.30"></a><span id="l13.30">  */</span>
<a href="#l13.31"></a><span id="l13.31"> function _synthesizeDragEvent(aType, aWindow, aDispatcher, aDt, aArgs)</span>
<a href="#l13.32"></a><span id="l13.32"> {</span>
<a href="#l13.33"></a><span id="l13.33">   let screenX;</span>
<a href="#l13.34"></a><span id="l13.34">   if (aArgs &amp;&amp; (&quot;screenX&quot; in aArgs))</span>
<a href="#l13.35"></a><span id="l13.35">     screenX = aArgs.screenX;</span>
<a href="#l13.36"></a><span id="l13.36">   else</span>
<a href="#l13.37"></a><span id="l13.37" class="difflineminus">-    screenX = aDispatcher.ScreenX;</span>
<a href="#l13.38"></a><span id="l13.38" class="difflineplus">+    screenX = aDispatcher.screenX;</span>
<a href="#l13.39"></a><span id="l13.39"> </span>
<a href="#l13.40"></a><span id="l13.40">   let screenY;</span>
<a href="#l13.41"></a><span id="l13.41">   if (aArgs &amp;&amp; (&quot;screenY&quot; in aArgs))</span>
<a href="#l13.42"></a><span id="l13.42">     screenY = aArgs.screenY;</span>
<a href="#l13.43"></a><span id="l13.43">   else</span>
<a href="#l13.44"></a><span id="l13.44" class="difflineminus">-    screenY = aDispatcher.ScreenY;</span>
<a href="#l13.45"></a><span id="l13.45" class="difflineplus">+    screenY = aDispatcher.screenY;</span>
<a href="#l13.46"></a><span id="l13.46"> </span>
<a href="#l13.47"></a><span id="l13.47">   let event = aWindow.document.createEvent(&quot;DragEvent&quot;);</span>
<a href="#l13.48"></a><span id="l13.48">   event.initDragEvent(aType, true, true, aWindow, 0,</span>
<a href="#l13.49"></a><span id="l13.49">       screenX, screenY, 0, 0, false, false, false, false, 0, null, aDt);</span>
<a href="#l13.50"></a><span id="l13.50">   aDispatcher.dispatchEvent(event);</span>
<a href="#l13.51"></a><span id="l13.51"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mail/test/mozmill/tabmail/test-tabmail-dragndrop.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -229,19 +229,20 @@ function test_tab_reorder_detach(){</span>
<a href="#l14.4"></a><span id="l14.4">   let tab1 = mc.tabmail.tabContainer.childNodes[1];</span>
<a href="#l14.5"></a><span id="l14.5">   let dropContent = mc.e(&quot;tabpanelcontainer&quot;);</span>
<a href="#l14.6"></a><span id="l14.6"> </span>
<a href="#l14.7"></a><span id="l14.7">   let dt = synthesize_drag_start(mc.window, tab1, mc.tabmail.tabContainer);</span>
<a href="#l14.8"></a><span id="l14.8"> </span>
<a href="#l14.9"></a><span id="l14.9">   synthesize_drag_over(mc.window, dropContent, dt);</span>
<a href="#l14.10"></a><span id="l14.10"> </span>
<a href="#l14.11"></a><span id="l14.11">   // notify tab1 drag has ended</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineplus">+  let dropRect = aDropObject.getBoundingClientRect();</span>
<a href="#l14.13"></a><span id="l14.13">   synthesize_drag_end(mc.window, dropContent, tab1, dt,</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineminus">-      { screenX : (dropContent.screenX + dropContent.getBoundingClientRect().width / 2 ),</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineminus">-        screenY : (dropContent.screenY + dropContent.getBoundingClientRect().height / 2 ) });</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineplus">+      { screenX : (dropContent.screenX + dropRect.width / 2 ),</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineplus">+        screenY : (dropContent.screenY + dropRect.height / 2 ) });</span>
<a href="#l14.18"></a><span id="l14.18"> </span>
<a href="#l14.19"></a><span id="l14.19">   // ... and wait for the new window</span>
<a href="#l14.20"></a><span id="l14.20">   mc2 = wait_for_new_window(&quot;mail:3pane&quot;);</span>
<a href="#l14.21"></a><span id="l14.21">   wait_for_message_display_completion(mc2, true);</span>
<a href="#l14.22"></a><span id="l14.22"> </span>
<a href="#l14.23"></a><span id="l14.23">   assert_true(mc.tabmail.tabContainer.childNodes.length == 1,</span>
<a href="#l14.24"></a><span id="l14.24">       &quot;Moving tab to new window failed, tab still in old window&quot;);</span>
<a href="#l14.25"></a><span id="l14.25"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/extensions/smime/content/msgCompSecurityInfo.xul</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/extensions/smime/content/msgCompSecurityInfo.xul</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -15,20 +15,20 @@</span>
<a href="#l15.4"></a><span id="l15.4">   buttons=&quot;accept&quot;</span>
<a href="#l15.5"></a><span id="l15.5">   onload=&quot;onLoad();&quot;&gt;</span>
<a href="#l15.6"></a><span id="l15.6"> </span>
<a href="#l15.7"></a><span id="l15.7">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger-smime/content/msgCompSecurityInfo.js&quot;/&gt;</span>
<a href="#l15.8"></a><span id="l15.8">   &lt;script&gt;&lt;![CDATA[</span>
<a href="#l15.9"></a><span id="l15.9">       function resizeColumns() {</span>
<a href="#l15.10"></a><span id="l15.10">         let list = document.getElementById(&quot;infolist&quot;);</span>
<a href="#l15.11"></a><span id="l15.11">         let cols = list.getElementsByTagName(&quot;treecol&quot;);</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-        list.style.setProperty(&quot;--recipientWidth&quot;, cols[0].boxObject.width + &quot;px&quot;);</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-        list.style.setProperty(&quot;--statusWidth&quot;, cols[1].boxObject.width + &quot;px&quot;);</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineminus">-        list.style.setProperty(&quot;--issuedWidth&quot;, cols[2].boxObject.width + &quot;px&quot;);</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">-        list.style.setProperty(&quot;--expireWidth&quot;, cols[3].boxObject.width - 5 + &quot;px&quot;);</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineplus">+        list.style.setProperty(&quot;--recipientWidth&quot;, cols[0].getBoundingClientRect().width + &quot;px&quot;);</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineplus">+        list.style.setProperty(&quot;--statusWidth&quot;, cols[1].getBoundingClientRect().width + &quot;px&quot;);</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineplus">+        list.style.setProperty(&quot;--issuedWidth&quot;, cols[2].getBoundingClientRect().width + &quot;px&quot;);</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineplus">+        list.style.setProperty(&quot;--expireWidth&quot;, cols[3].getBoundingClientRect().width - 5 + &quot;px&quot;);</span>
<a href="#l15.20"></a><span id="l15.20">       }</span>
<a href="#l15.21"></a><span id="l15.21">       addEventListener(&quot;load&quot;, resizeColumns, { once: true });</span>
<a href="#l15.22"></a><span id="l15.22">       addEventListener(&quot;resize&quot;, resizeColumns);</span>
<a href="#l15.23"></a><span id="l15.23">   ]]&gt;&lt;/script&gt;</span>
<a href="#l15.24"></a><span id="l15.24"> </span>
<a href="#l15.25"></a><span id="l15.25">   &lt;stringbundle id=&quot;bundle_smime_comp_info&quot; src=&quot;chrome://messenger-smime/locale/msgCompSecurityInfo.properties&quot;/&gt;</span>
<a href="#l15.26"></a><span id="l15.26"> </span>
<a href="#l15.27"></a><span id="l15.27">   &lt;description&gt;&amp;subject.plaintextWarning;&lt;/description&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/import/content/fieldMapImport.xul</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/import/content/fieldMapImport.xul</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -18,18 +18,18 @@</span>
<a href="#l16.4"></a><span id="l16.4">         style=&quot;&amp;fieldMapImport.size;&quot;</span>
<a href="#l16.5"></a><span id="l16.5">         onload=&quot;OnLoadFieldMapImport();&quot;&gt;</span>
<a href="#l16.6"></a><span id="l16.6"> </span>
<a href="#l16.7"></a><span id="l16.7">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/fieldMapImport.js&quot;/&gt;</span>
<a href="#l16.8"></a><span id="l16.8">   &lt;script&gt;&lt;![CDATA[</span>
<a href="#l16.9"></a><span id="l16.9">       function resizeColumns() {</span>
<a href="#l16.10"></a><span id="l16.10">         let list = document.getElementById(&quot;fieldList&quot;);</span>
<a href="#l16.11"></a><span id="l16.11">         let cols = list.getElementsByTagName(&quot;treecol&quot;);</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-        list.style.setProperty(&quot;--column1width&quot;, cols[0].boxObject.width + &quot;px&quot;);</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineminus">-        list.style.setProperty(&quot;--column2width&quot;, cols[1].boxObject.width + &quot;px&quot;);</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineplus">+        list.style.setProperty(&quot;--column1width&quot;, cols[0].getBoundingClientRect().width + &quot;px&quot;);</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineplus">+        list.style.setProperty(&quot;--column2width&quot;, cols[1].getBoundingClientRect().width + &quot;px&quot;);</span>
<a href="#l16.16"></a><span id="l16.16">       }</span>
<a href="#l16.17"></a><span id="l16.17">       addEventListener(&quot;load&quot;, resizeColumns, { once: true });</span>
<a href="#l16.18"></a><span id="l16.18">       addEventListener(&quot;resize&quot;, resizeColumns);</span>
<a href="#l16.19"></a><span id="l16.19">   ]]&gt;&lt;/script&gt;</span>
<a href="#l16.20"></a><span id="l16.20"> </span>
<a href="#l16.21"></a><span id="l16.21">   &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l16.22"></a><span id="l16.22">     &lt;label value=&quot;&amp;fieldMapImport.recordNumber;&quot;/&gt;</span>
<a href="#l16.23"></a><span id="l16.23">     &lt;label id=&quot;recordNumber&quot;/&gt;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:32Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

