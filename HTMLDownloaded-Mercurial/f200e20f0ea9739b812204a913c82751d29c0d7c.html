<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 16604:f200e20f0ea9739b812204a913c82751d29c0d7c</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ f200e20f0ea9739b812204a913c82751d29c0d7c" />
<meta property="og:url" content="/comm-central/rev/f200e20f0ea9739b812204a913c82751d29c0d7c" />
<meta property="og:description" content="Bug 1044460 - Port relevant changes from Bug 1043344 for moving libraries and programs build to the compile tier r=standard8 for a CLOSED TREE" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / f200e20f0ea9739b812204a913c82751d29c0d7c 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/f200e20f0ea9739b812204a913c82751d29c0d7c">shortlog</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/f200e20f0ea9739b812204a913c82751d29c0d7c">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c">files</a> |
changeset |
<a href="/comm-central/raw-rev/f200e20f0ea9739b812204a913c82751d29c0d7c">raw</a>  | <a href="/comm-central/archive/f200e20f0ea9739b812204a913c82751d29c0d7c.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1044460">Bug 1044460</a> - Port relevant changes from <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1043344">Bug 1043344</a> for moving libraries and programs build to the compile tier r=standard8 for a CLOSED TREE
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#73;&#97;&#110;&#32;&#78;&#101;&#97;&#108;&#32;&#60;&#105;&#97;&#110;&#110;&#95;&#99;&#118;&#115;&#64;&#98;&#108;&#117;&#101;&#121;&#111;&#110;&#100;&#101;&#114;&#46;&#99;&#111;&#46;&#117;&#107;&#62;</td></tr>
<tr><td></td><td class="date age">Thu, 31 Jul 2014 15:15:22 +0100</td></tr>

<tr>
 <td>changeset 16604</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/f200e20f0ea9739b812204a913c82751d29c0d7c">f200e20f0ea9739b812204a913c82751d29c0d7c</a></td>
</tr>



<tr>
<td>parent 16603</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/20c91ae13439e7e25be0928b79ac058d2a325b4d">20c91ae13439e7e25be0928b79ac058d2a325b4d</a>
</td>
</tr>

<tr>
<td>child 16605</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/400d3f9380fb71bcea42d763cdfc1f53cfe83470">400d3f9380fb71bcea42d763cdfc1f53cfe83470</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=f200e20f0ea9739b812204a913c82751d29c0d7c">10327</a></td></tr>
<tr><td>push user</td><td>iann_cvs@blueyonder.co.uk</td></tr>
<tr><td>push date</td><td class="date age">Thu, 31 Jul 2014 14:17:36 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@400d3f9380fb [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=400d3f9380fb71bcea42d763cdfc1f53cfe83470">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=400d3f9380fb71bcea42d763cdfc1f53cfe83470&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=400d3f9380fb71bcea42d763cdfc1f53cfe83470&newProject=comm-central&newRevision=f200e20f0ea9739b812204a913c82751d29c0d7c&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=400d3f9380fb71bcea42d763cdfc1f53cfe83470&newProject=comm-central&newRevision=f200e20f0ea9739b812204a913c82751d29c0d7c&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=400d3f9380fb71bcea42d763cdfc1f53cfe83470&newProject=comm-central&newRevision=f200e20f0ea9739b812204a913c82751d29c0d7c&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28standard8%29&revcount=50">standard8</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1044460">1044460</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1043344">1043344</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1044460">Bug 1044460</a> - Port relevant changes from <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1043344">Bug 1043344</a> for moving libraries and programs build to the compile tier r=standard8 for a CLOSED TREE</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/Makefile.in">Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/Makefile.in">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/Makefile.in">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/Makefile.in">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/Makefile.in">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/chat/moz.build">chat/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/chat/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/chat/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/chat/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/chat/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/chat/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/config/config.mk">config/config.mk</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/config/config.mk">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/config/config.mk">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/config/config.mk">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/config/config.mk">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/config/config.mk">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/config/recurse.mk">config/recurse.mk</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/config/recurse.mk">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/config/recurse.mk">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/config/recurse.mk">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/config/recurse.mk">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/config/recurse.mk">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/config/rules.mk">config/rules.mk</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/config/rules.mk">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/config/rules.mk">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/config/rules.mk">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/config/rules.mk">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/config/rules.mk">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/im/moz.build">im/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/im/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/im/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/im/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/im/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/im/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/ldap/xpcom/moz.build">ldap/xpcom/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/ldap/xpcom/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/ldap/xpcom/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/ldap/xpcom/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/ldap/xpcom/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/ldap/xpcom/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/addrbook/moz.build">mailnews/addrbook/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/addrbook/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/addrbook/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/addrbook/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/addrbook/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/addrbook/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/base/moz.build">mailnews/base/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/base/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/base/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/base/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/base/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/base/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/compose/moz.build">mailnews/compose/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/compose/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/compose/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/compose/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/compose/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/compose/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/db/msgdb/moz.build">mailnews/db/msgdb/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/db/msgdb/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/db/msgdb/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/db/msgdb/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/db/msgdb/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/db/msgdb/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/bayesian-spam-filter/moz.build">mailnews/extensions/bayesian-spam-filter/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/bayesian-spam-filter/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/bayesian-spam-filter/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/bayesian-spam-filter/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/bayesian-spam-filter/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/bayesian-spam-filter/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/moz.build">mailnews/extensions/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/smime/moz.build">mailnews/extensions/smime/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/smime/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/smime/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/smime/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/smime/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/extensions/smime/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/intl/Makefile.in">mailnews/intl/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/intl/Makefile.in">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/intl/Makefile.in">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/intl/Makefile.in">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/intl/Makefile.in">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/intl/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/intl/moz.build">mailnews/intl/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/intl/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/intl/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/intl/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/intl/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/intl/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/mime/cthandlers/moz.build">mailnews/mime/cthandlers/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/mime/cthandlers/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/mime/cthandlers/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/mime/cthandlers/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/mime/cthandlers/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/mime/cthandlers/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/mime/moz.build">mailnews/mime/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/mime/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/mime/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/mime/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/mime/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/mime/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/moz.build">mailnews/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/news/moz.build">mailnews/news/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/news/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/news/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/news/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/news/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/mailnews/news/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/common/moz.build">suite/common/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/common/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/common/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/common/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/common/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/common/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/moz.build">suite/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/profile/moz.build">suite/profile/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/profile/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/profile/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/profile/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/profile/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/profile/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/smile/moz.build">suite/smile/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/smile/moz.build">file</a> |
<a href="/comm-central/annotate/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/smile/moz.build">annotate</a> |
<a href="/comm-central/diff/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/smile/moz.build">diff</a> |
<a href="/comm-central/comparison/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/smile/moz.build">comparison</a> |
<a href="/comm-central/log/f200e20f0ea9739b812204a913c82751d29c0d7c/suite/smile/moz.build">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/Makefile.in</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/Makefile.in</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -21,28 +21,28 @@ include $(DEPTH)/config/autoconf.mk</span>
<a href="#l1.4"></a><span id="l1.4"> default::</span>
<a href="#l1.5"></a><span id="l1.5"> </span>
<a href="#l1.6"></a><span id="l1.6"> ifdef COMPILE_ENVIRONMENT</span>
<a href="#l1.7"></a><span id="l1.7"> include $(topsrcdir)/$(MOZ_BUILD_APP)/build.mk</span>
<a href="#l1.8"></a><span id="l1.8"> endif</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10"> include $(topsrcdir)/config/config.mk</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-default alldep all:: $(topsrcdir)/configure config.status</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+libs binaries export tools:: $(topsrcdir)/configure config.status</span>
<a href="#l1.14"></a><span id="l1.14"> </span>
<a href="#l1.15"></a><span id="l1.15"> $(topsrcdir)/configure: $(topsrcdir)/configure.in</span>
<a href="#l1.16"></a><span id="l1.16"> 	@echo 'STOP!  configure.in has changed, and your configure is out of date.'</span>
<a href="#l1.17"></a><span id="l1.17"> 	@echo 'Please rerun autoconf and configure.'</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineminus">-	@echo 'To ignore this message, touch 'configure' in the source directory.'</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineplus">+	@echo 'To ignore this message, touch &quot;configure&quot; in the source directory.'</span>
<a href="#l1.20"></a><span id="l1.20"> 	@exit 1</span>
<a href="#l1.21"></a><span id="l1.21"> </span>
<a href="#l1.22"></a><span id="l1.22"> config.status: $(topsrcdir)/configure</span>
<a href="#l1.23"></a><span id="l1.23"> 	@echo 'STOP!  configure has changed and needs to be run in this build directory.'</span>
<a href="#l1.24"></a><span id="l1.24"> 	@echo 'Please rerun configure.'</span>
<a href="#l1.25"></a><span id="l1.25" class="difflineminus">-	@echo 'To ignore this message, touch 'config.status' in the build directory.'</span>
<a href="#l1.26"></a><span id="l1.26" class="difflineplus">+	@echo 'To ignore this message, touch &quot;config.status&quot; in the build directory.'</span>
<a href="#l1.27"></a><span id="l1.27"> 	@exit 1</span>
<a href="#l1.28"></a><span id="l1.28"> </span>
<a href="#l1.29"></a><span id="l1.29"> default export libs clean realclean distclean alldep \</span>
<a href="#l1.30"></a><span id="l1.30"> maybe_clobber_profiledbuild uploadsymbols all:: $(SUBMAKEFILES)</span>
<a href="#l1.31"></a><span id="l1.31"> 	$(MAKE) -C mozilla $@</span>
<a href="#l1.32"></a><span id="l1.32"> </span>
<a href="#l1.33"></a><span id="l1.33"> ifdef ENABLE_TESTS</span>
<a href="#l1.34"></a><span id="l1.34"> check mochitest reftest crashtest xpcshell-tests:: $(SUBMAKEFILES)</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineat">@@ -82,19 +82,25 @@ endif</span>
<a href="#l1.36"></a><span id="l1.36"> </span>
<a href="#l1.37"></a><span id="l1.37"> buildsymbols :: $(SUBMAKEFILES)</span>
<a href="#l1.38"></a><span id="l1.38"> 	$(MAKE) -C mozilla MAKE_SYM_STORE_PATH=$(MAKE_SYM_STORE_PATH) SYM_STORE_SOURCE_DIRS='$(topsrcdir)/mozilla/extensions/inspector $(topsrcdir)/ldap/sdks $(topsrcdir)/mozilla $(topsrcdir)' $@</span>
<a href="#l1.39"></a><span id="l1.39"> </span>
<a href="#l1.40"></a><span id="l1.40"> # If we don't specify this, then we will end up trying to build as if we were a</span>
<a href="#l1.41"></a><span id="l1.41"> # regular directory in the build tree.</span>
<a href="#l1.42"></a><span id="l1.42"> SUPPRESS_DEFAULT_RULES := 1</span>
<a href="#l1.43"></a><span id="l1.43"> </span>
<a href="#l1.44"></a><span id="l1.44" class="difflineplus">+default all::</span>
<a href="#l1.45"></a><span id="l1.45" class="difflineplus">+	$(call BUILDSTATUS,TIERS export $(if $(COMPILE_ENVIRONMENT),compile )libs tools)</span>
<a href="#l1.46"></a><span id="l1.46" class="difflineplus">+</span>
<a href="#l1.47"></a><span id="l1.47"> include $(topsrcdir)/config/rules.mk</span>
<a href="#l1.48"></a><span id="l1.48"> </span>
<a href="#l1.49"></a><span id="l1.49" class="difflineminus">-# defined in (mozilla/.../)package-name.mk</span>
<a href="#l1.50"></a><span id="l1.50" class="difflineplus">+# MOZ_SOURCE_STAMP is defined in (mozilla/.../)package-name.mk with a deferred</span>
<a href="#l1.51"></a><span id="l1.51" class="difflineplus">+# assignment. Exporting it makes make run its $(shell) command for each invoked</span>
<a href="#l1.52"></a><span id="l1.52" class="difflineplus">+# submake, so transform it to an immediate assignment.</span>
<a href="#l1.53"></a><span id="l1.53" class="difflineplus">+MOZ_SOURCE_STAMP := $(MOZ_SOURCE_STAMP)</span>
<a href="#l1.54"></a><span id="l1.54"> export MOZ_SOURCE_STAMP</span>
<a href="#l1.55"></a><span id="l1.55"> </span>
<a href="#l1.56"></a><span id="l1.56"> DIST_GARBAGE = config.cache config.log config.status* config-defs.h \</span>
<a href="#l1.57"></a><span id="l1.57">    config/autoconf.mk \</span>
<a href="#l1.58"></a><span id="l1.58">    unallmakefiles \</span>
<a href="#l1.59"></a><span id="l1.59">    .mozconfig.mk</span>
<a href="#l1.60"></a><span id="l1.60"> </span>
<a href="#l1.61"></a><span id="l1.61"> distclean::</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/chat/moz.build</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/chat/moz.build</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1,24 +1,24 @@</span>
<a href="#l2.4"></a><span id="l2.4"> # vim: set filetype=python:</span>
<a href="#l2.5"></a><span id="l2.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l2.6"></a><span id="l2.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l2.7"></a><span id="l2.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l2.10"></a><span id="l2.10" class="difflineplus">+DIRS += [</span>
<a href="#l2.11"></a><span id="l2.11">     'components/public',</span>
<a href="#l2.12"></a><span id="l2.12">     'components/src',</span>
<a href="#l2.13"></a><span id="l2.13">     'modules',</span>
<a href="#l2.14"></a><span id="l2.14">     'content',</span>
<a href="#l2.15"></a><span id="l2.15">     'themes',</span>
<a href="#l2.16"></a><span id="l2.16">     'locales',</span>
<a href="#l2.17"></a><span id="l2.17">     'protocols/facebook',</span>
<a href="#l2.18"></a><span id="l2.18">     'protocols/gtalk',</span>
<a href="#l2.19"></a><span id="l2.19">     'protocols/irc',</span>
<a href="#l2.20"></a><span id="l2.20">     'protocols/odnoklassniki',</span>
<a href="#l2.21"></a><span id="l2.21">     'protocols/twitter',</span>
<a href="#l2.22"></a><span id="l2.22">     'protocols/xmpp',</span>
<a href="#l2.23"></a><span id="l2.23">     'protocols/yahoo',</span>
<a href="#l2.24"></a><span id="l2.24"> ]</span>
<a href="#l2.25"></a><span id="l2.25"> </span>
<a href="#l2.26"></a><span id="l2.26"> if CONFIG['MOZ_DEBUG']:</span>
<a href="#l2.27"></a><span id="l2.27" class="difflineminus">-    PARALLEL_DIRS += ['protocols/jsTest']</span>
<a href="#l2.28"></a><span id="l2.28" class="difflineplus">+    DIRS += ['protocols/jsTest']</span>
<a href="#l2.29"></a><span id="l2.29"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/config/config.mk</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/config/config.mk</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -36,16 +36,17 @@ endif</span>
<a href="#l3.4"></a><span id="l3.4"> _MOZBUILD_EXTERNAL_VARIABLES := \</span>
<a href="#l3.5"></a><span id="l3.5">   ANDROID_GENERATED_RESFILES \</span>
<a href="#l3.6"></a><span id="l3.6">   ANDROID_RESFILES \</span>
<a href="#l3.7"></a><span id="l3.7">   CMMSRCS \</span>
<a href="#l3.8"></a><span id="l3.8">   CPP_UNIT_TESTS \</span>
<a href="#l3.9"></a><span id="l3.9">   DIRS \</span>
<a href="#l3.10"></a><span id="l3.10">   DIST_SUBDIR \</span>
<a href="#l3.11"></a><span id="l3.11">   EXTRA_DSO_LDOPTS \</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+  EXTRA_JS_MODULES \</span>
<a href="#l3.13"></a><span id="l3.13">   EXTRA_PP_COMPONENTS \</span>
<a href="#l3.14"></a><span id="l3.14">   EXTRA_PP_JS_MODULES \</span>
<a href="#l3.15"></a><span id="l3.15">   FINAL_LIBRARY \</span>
<a href="#l3.16"></a><span id="l3.16">   FINAL_TARGET \</span>
<a href="#l3.17"></a><span id="l3.17">   GTEST_CMMSRCS \</span>
<a href="#l3.18"></a><span id="l3.18">   GTEST_CPPSRCS \</span>
<a href="#l3.19"></a><span id="l3.19">   GTEST_CSRCS \</span>
<a href="#l3.20"></a><span id="l3.20">   HOST_CSRCS \</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineat">@@ -63,16 +64,18 @@ endif</span>
<a href="#l3.22"></a><span id="l3.22">   PARALLEL_DIRS \</span>
<a href="#l3.23"></a><span id="l3.23">   SDK_HEADERS \</span>
<a href="#l3.24"></a><span id="l3.24">   SDK_LIBRARY \</span>
<a href="#l3.25"></a><span id="l3.25">   SHARED_LIBRARY_LIBS \</span>
<a href="#l3.26"></a><span id="l3.26">   SHARED_LIBRARY_NAME \</span>
<a href="#l3.27"></a><span id="l3.27">   SIMPLE_PROGRAMS \</span>
<a href="#l3.28"></a><span id="l3.28">   STATIC_LIBRARY_NAME \</span>
<a href="#l3.29"></a><span id="l3.29">   TEST_DIRS \</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineplus">+  TESTING_JS_MODULES \</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineplus">+  TESTING_JS_MODULE_DIR \</span>
<a href="#l3.32"></a><span id="l3.32">   TIERS \</span>
<a href="#l3.33"></a><span id="l3.33">   TOOL_DIRS \</span>
<a href="#l3.34"></a><span id="l3.34">   XPCSHELL_TESTS \</span>
<a href="#l3.35"></a><span id="l3.35">   XPIDL_MODULE \</span>
<a href="#l3.36"></a><span id="l3.36">   XPI_NAME \</span>
<a href="#l3.37"></a><span id="l3.37">   $(NULL)</span>
<a href="#l3.38"></a><span id="l3.38"> </span>
<a href="#l3.39"></a><span id="l3.39"> _DEPRECATED_VARIABLES := \</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineat">@@ -305,39 +308,50 @@ ifdef IS_COMPONENT</span>
<a href="#l3.41"></a><span id="l3.41"> $(error IS_COMPONENT is set, but is not compatible with LIBXUL_LIBRARY)</span>
<a href="#l3.42"></a><span id="l3.42"> endif</span>
<a href="#l3.43"></a><span id="l3.43"> ifdef MODULE_NAME</span>
<a href="#l3.44"></a><span id="l3.44"> $(error MODULE_NAME is $(MODULE_NAME) but MODULE_NAME and LIBXUL_LIBRARY are not compatible)</span>
<a href="#l3.45"></a><span id="l3.45"> endif</span>
<a href="#l3.46"></a><span id="l3.46"> SHORT_LIBNAME=</span>
<a href="#l3.47"></a><span id="l3.47"> endif</span>
<a href="#l3.48"></a><span id="l3.48"> </span>
<a href="#l3.49"></a><span id="l3.49" class="difflineplus">+# No sense in profiling tools</span>
<a href="#l3.50"></a><span id="l3.50" class="difflineplus">+ifdef INTERNAL_TOOLS</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineplus">+NO_PROFILE_GUIDED_OPTIMIZE = 1</span>
<a href="#l3.52"></a><span id="l3.52" class="difflineplus">+endif</span>
<a href="#l3.53"></a><span id="l3.53" class="difflineplus">+</span>
<a href="#l3.54"></a><span id="l3.54" class="difflineplus">+# Don't build SIMPLE_PROGRAMS with PGO, since they don't need it anyway,</span>
<a href="#l3.55"></a><span id="l3.55" class="difflineplus">+# and we don't have the same build logic to re-link them in the second pass.</span>
<a href="#l3.56"></a><span id="l3.56" class="difflineplus">+ifdef SIMPLE_PROGRAMS</span>
<a href="#l3.57"></a><span id="l3.57" class="difflineplus">+NO_PROFILE_GUIDED_OPTIMIZE = 1</span>
<a href="#l3.58"></a><span id="l3.58" class="difflineplus">+endif</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineplus">+</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineplus">+# No sense in profiling unit tests</span>
<a href="#l3.61"></a><span id="l3.61" class="difflineplus">+ifdef CPP_UNIT_TESTS</span>
<a href="#l3.62"></a><span id="l3.62" class="difflineplus">+NO_PROFILE_GUIDED_OPTIMIZE = 1</span>
<a href="#l3.63"></a><span id="l3.63" class="difflineplus">+endif</span>
<a href="#l3.64"></a><span id="l3.64" class="difflineplus">+</span>
<a href="#l3.65"></a><span id="l3.65"> # Enable profile-based feedback</span>
<a href="#l3.66"></a><span id="l3.66" class="difflineminus">-ifndef NO_PROFILE_GUIDED_OPTIMIZE</span>
<a href="#l3.67"></a><span id="l3.67" class="difflineplus">+ifneq (1,$(NO_PROFILE_GUIDED_OPTIMIZE))</span>
<a href="#l3.68"></a><span id="l3.68"> ifdef MOZ_PROFILE_GENERATE</span>
<a href="#l3.69"></a><span id="l3.69" class="difflineminus">-# No sense in profiling tools</span>
<a href="#l3.70"></a><span id="l3.70" class="difflineminus">-ifndef INTERNAL_TOOLS</span>
<a href="#l3.71"></a><span id="l3.71" class="difflineminus">-OS_CFLAGS += $(PROFILE_GEN_CFLAGS)</span>
<a href="#l3.72"></a><span id="l3.72" class="difflineminus">-OS_CXXFLAGS += $(PROFILE_GEN_CFLAGS)</span>
<a href="#l3.73"></a><span id="l3.73" class="difflineplus">+OS_CFLAGS += $(if $(filter $(notdir $&lt;),$(notdir $(NO_PROFILE_GUIDED_OPTIMIZE))),,$(PROFILE_GEN_CFLAGS))</span>
<a href="#l3.74"></a><span id="l3.74" class="difflineplus">+OS_CXXFLAGS += $(if $(filter $(notdir $&lt;),$(notdir $(NO_PROFILE_GUIDED_OPTIMIZE))),,$(PROFILE_GEN_CFLAGS))</span>
<a href="#l3.75"></a><span id="l3.75"> OS_LDFLAGS += $(PROFILE_GEN_LDFLAGS)</span>
<a href="#l3.76"></a><span id="l3.76"> ifeq (WINNT,$(OS_ARCH))</span>
<a href="#l3.77"></a><span id="l3.77"> AR_FLAGS += -LTCG</span>
<a href="#l3.78"></a><span id="l3.78"> endif</span>
<a href="#l3.79"></a><span id="l3.79" class="difflineminus">-endif # INTERNAL_TOOLS</span>
<a href="#l3.80"></a><span id="l3.80"> endif # MOZ_PROFILE_GENERATE</span>
<a href="#l3.81"></a><span id="l3.81"> </span>
<a href="#l3.82"></a><span id="l3.82"> ifdef MOZ_PROFILE_USE</span>
<a href="#l3.83"></a><span id="l3.83" class="difflineminus">-ifndef INTERNAL_TOOLS</span>
<a href="#l3.84"></a><span id="l3.84" class="difflineminus">-OS_CFLAGS += $(PROFILE_USE_CFLAGS)</span>
<a href="#l3.85"></a><span id="l3.85" class="difflineminus">-OS_CXXFLAGS += $(PROFILE_USE_CFLAGS)</span>
<a href="#l3.86"></a><span id="l3.86" class="difflineplus">+OS_CFLAGS += $(if $(filter $(notdir $&lt;),$(notdir $(NO_PROFILE_GUIDED_OPTIMIZE))),,$(PROFILE_USE_CFLAGS))</span>
<a href="#l3.87"></a><span id="l3.87" class="difflineplus">+OS_CXXFLAGS += $(if $(filter $(notdir $&lt;),$(notdir $(NO_PROFILE_GUIDED_OPTIMIZE))),,$(PROFILE_USE_CFLAGS))</span>
<a href="#l3.88"></a><span id="l3.88"> OS_LDFLAGS += $(PROFILE_USE_LDFLAGS)</span>
<a href="#l3.89"></a><span id="l3.89"> ifeq (WINNT,$(OS_ARCH))</span>
<a href="#l3.90"></a><span id="l3.90"> AR_FLAGS += -LTCG</span>
<a href="#l3.91"></a><span id="l3.91"> endif</span>
<a href="#l3.92"></a><span id="l3.92" class="difflineminus">-endif # INTERNAL_TOOLS</span>
<a href="#l3.93"></a><span id="l3.93"> endif # MOZ_PROFILE_USE</span>
<a href="#l3.94"></a><span id="l3.94"> endif # NO_PROFILE_GUIDED_OPTIMIZE</span>
<a href="#l3.95"></a><span id="l3.95"> </span>
<a href="#l3.96"></a><span id="l3.96"> </span>
<a href="#l3.97"></a><span id="l3.97"> # Does the makefile specifies the internal XPCOM API linkage?</span>
<a href="#l3.98"></a><span id="l3.98"> ifneq (,$(MOZILLA_INTERNAL_API)$(LIBXUL_LIBRARY))</span>
<a href="#l3.99"></a><span id="l3.99"> DEFINES += -DMOZILLA_INTERNAL_API</span>
<a href="#l3.100"></a><span id="l3.100"> endif</span>
<a href="#l3.101"></a><span id="l3.101" class="difflineat">@@ -701,24 +715,27 @@ ifneq (WINNT,$(OS_ARCH))</span>
<a href="#l3.102"></a><span id="l3.102"> RUN_TEST_PROGRAM = $(DIST)/bin/run-mozilla.sh</span>
<a href="#l3.103"></a><span id="l3.103"> endif # ! WINNT</span>
<a href="#l3.104"></a><span id="l3.104"> </span>
<a href="#l3.105"></a><span id="l3.105"> CREATE_PRECOMPLETE_CMD = $(PYTHON) $(abspath $(MOZILLA_SRCDIR)/config/createprecomplete.py)</span>
<a href="#l3.106"></a><span id="l3.106"> </span>
<a href="#l3.107"></a><span id="l3.107"> # MDDEPDIR is the subdirectory where dependency files are stored</span>
<a href="#l3.108"></a><span id="l3.108"> MDDEPDIR := .deps</span>
<a href="#l3.109"></a><span id="l3.109"> </span>
<a href="#l3.110"></a><span id="l3.110" class="difflineminus">-EXPAND_LIBS = $(PYTHON) $(MOZILLA_SRCDIR)/config/expandlibs.py</span>
<a href="#l3.111"></a><span id="l3.111" class="difflineminus">-EXPAND_LIBS_EXEC = $(PYTHON) $(MOZILLA_SRCDIR)/config/expandlibs_exec.py $(if $@,--depend $(MDDEPDIR)/$(basename $(@F)).pp --target $@)</span>
<a href="#l3.112"></a><span id="l3.112" class="difflineminus">-EXPAND_LIBS_GEN = $(PYTHON) $(MOZILLA_SRCDIR)/config/expandlibs_gen.py $(if $@,--depend $(MDDEPDIR)/$(basename $(@F)).pp)</span>
<a href="#l3.113"></a><span id="l3.113" class="difflineplus">+EXPAND_LIBS_EXEC = $(PYTHON) $(MOZILLA_SRCDIR)/config/expandlibs_exec.py</span>
<a href="#l3.114"></a><span id="l3.114" class="difflineplus">+EXPAND_LIBS_GEN = $(PYTHON) $(MOZILLA_SRCDIR)/config/expandlibs_gen.py</span>
<a href="#l3.115"></a><span id="l3.115"> EXPAND_AR = $(EXPAND_LIBS_EXEC) --extract -- $(AR)</span>
<a href="#l3.116"></a><span id="l3.116"> EXPAND_CC = $(EXPAND_LIBS_EXEC) --uselist -- $(CC)</span>
<a href="#l3.117"></a><span id="l3.117"> EXPAND_CCC = $(EXPAND_LIBS_EXEC) --uselist -- $(CCC)</span>
<a href="#l3.118"></a><span id="l3.118"> EXPAND_LD = $(EXPAND_LIBS_EXEC) --uselist -- $(LD)</span>
<a href="#l3.119"></a><span id="l3.119" class="difflineminus">-EXPAND_MKSHLIB = $(EXPAND_LIBS_EXEC) --uselist -- $(MKSHLIB)</span>
<a href="#l3.120"></a><span id="l3.120" class="difflineplus">+EXPAND_MKSHLIB_ARGS = --uselist</span>
<a href="#l3.121"></a><span id="l3.121" class="difflineplus">+ifdef SYMBOL_ORDER</span>
<a href="#l3.122"></a><span id="l3.122" class="difflineplus">+EXPAND_MKSHLIB_ARGS += --symbol-order $(SYMBOL_ORDER)</span>
<a href="#l3.123"></a><span id="l3.123" class="difflineplus">+endif</span>
<a href="#l3.124"></a><span id="l3.124" class="difflineplus">+EXPAND_MKSHLIB = $(EXPAND_LIBS_EXEC) $(EXPAND_MKSHLIB_ARGS) -- $(MKSHLIB)</span>
<a href="#l3.125"></a><span id="l3.125"> </span>
<a href="#l3.126"></a><span id="l3.126"> # EXPAND_LIBNAME - $(call EXPAND_LIBNAME,foo)</span>
<a href="#l3.127"></a><span id="l3.127"> # expands to $(LIB_PREFIX)foo.$(LIB_SUFFIX) or -lfoo, depending on linker</span>
<a href="#l3.128"></a><span id="l3.128"> # arguments syntax. Should only be used for system libraries</span>
<a href="#l3.129"></a><span id="l3.129"> </span>
<a href="#l3.130"></a><span id="l3.130"> # EXPAND_LIBNAME_PATH - $(call EXPAND_LIBNAME_PATH,foo,dir)</span>
<a href="#l3.131"></a><span id="l3.131"> # expands to dir/$(LIB_PREFIX)foo.$(LIB_SUFFIX)</span>
<a href="#l3.132"></a><span id="l3.132"> </span>
<a href="#l3.133"></a><span id="l3.133" class="difflineat">@@ -736,22 +753,16 @@ EXPAND_MOZLIBNAME = $(foreach lib,$(1),$</span>
<a href="#l3.134"></a><span id="l3.134"> # Include internal ply only if needed</span>
<a href="#l3.135"></a><span id="l3.135"> ifndef MOZ_SYSTEM_PLY</span>
<a href="#l3.136"></a><span id="l3.136"> PLY_INCLUDE = -I$(MOZILLA_DIR)/other-licenses/ply</span>
<a href="#l3.137"></a><span id="l3.137"> endif</span>
<a href="#l3.138"></a><span id="l3.138">  </span>
<a href="#l3.139"></a><span id="l3.139"> export CL_INCLUDES_PREFIX</span>
<a href="#l3.140"></a><span id="l3.140"> </span>
<a href="#l3.141"></a><span id="l3.141"> ifneq (,$(MOZ_LIBSTDCXX_TARGET_VERSION)$(MOZ_LIBSTDCXX_HOST_VERSION))</span>
<a href="#l3.142"></a><span id="l3.142" class="difflineminus">-ifdef MOZ_LIBSTDCXX_TARGET_VERSION</span>
<a href="#l3.143"></a><span id="l3.143" class="difflineminus">-OS_LIBS += $(call EXPAND_LIBNAME_PATH,stdc++compat,$(DEPTH)/mozilla/build/unix/stdc++compat)</span>
<a href="#l3.144"></a><span id="l3.144" class="difflineminus">-endif</span>
<a href="#l3.145"></a><span id="l3.145" class="difflineminus">-ifdef MOZ_LIBSTDCXX_HOST_VERSION</span>
<a href="#l3.146"></a><span id="l3.146" class="difflineminus">-HOST_EXTRA_LIBS += $(call EXPAND_LIBNAME_PATH,host_stdc++compat,$(DEPTH)/mozilla/build/unix/stdc++compat)</span>
<a href="#l3.147"></a><span id="l3.147" class="difflineminus">-endif</span>
<a href="#l3.148"></a><span id="l3.148"> endif</span>
<a href="#l3.149"></a><span id="l3.149"> </span>
<a href="#l3.150"></a><span id="l3.150"> # autoconf.mk sets OBJ_SUFFIX to an error to avoid use before including</span>
<a href="#l3.151"></a><span id="l3.151"> # this file</span>
<a href="#l3.152"></a><span id="l3.152"> OBJ_SUFFIX := $(_OBJ_SUFFIX)</span>
<a href="#l3.153"></a><span id="l3.153"> </span>
<a href="#l3.154"></a><span id="l3.154"> DEFINES += -DNO_NSPR_10_SUPPORT</span>
<a href="#l3.155"></a><span id="l3.155"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/config/recurse.mk</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/config/recurse.mk</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -1,52 +1,158 @@</span>
<a href="#l4.4"></a><span id="l4.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l4.5"></a><span id="l4.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l4.6"></a><span id="l4.6"> # You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l4.7"></a><span id="l4.7"> </span>
<a href="#l4.8"></a><span id="l4.8"> ifndef INCLUDED_RULES_MK</span>
<a href="#l4.9"></a><span id="l4.9"> include $(topsrcdir)/config/rules.mk</span>
<a href="#l4.10"></a><span id="l4.10"> endif</span>
<a href="#l4.11"></a><span id="l4.11"> </span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+# The traditional model of directory traversal with make is as follows:</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+#   make -C foo</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+#     Entering foo</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+#     make -C bar</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+#       Entering foo/bar</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+#     make -C baz</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineplus">+#       Entering foo/baz</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineplus">+#   make -C qux</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineplus">+#     Entering qux</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineplus">+#</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineplus">+# Pseudo derecurse transforms the above into:</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineplus">+#   make -C foo</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineplus">+#   make -C foo/bar</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineplus">+#   make -C foo/baz</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineplus">+#   make -C qux</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineplus">+</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineplus">+ifeq (.,$(DEPTH))</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineplus">+</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineplus">+include root.mk</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineplus">+</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+# Disable build status for mach in top directories without TIERS.</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+# In practice this disables it when recursing under js/src, which confuses mach.</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+ifndef TIERS</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+BUILDSTATUS =</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+endif</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineplus">+# Main rules (export, compile, libs and tools) call recurse_* rules.</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+# This wrapping is only really useful for build status.</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+compile libs export tools::</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineplus">+	$(call BUILDSTATUS,TIER_START $@)</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+	+$(MAKE) recurse_$@</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+	$(call BUILDSTATUS,TIER_FINISH $@)</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineplus">+</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineplus">+# Special rule that does install-manifests (cf. Makefile.in) + compile</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineplus">+binaries::</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineplus">+	+$(MAKE) recurse_compile</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineplus">+</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineplus">+# Carefully avoid $(eval) type of rule generation, which makes pymake slower</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineplus">+# than necessary.</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineplus">+# Get current tier and corresponding subtiers from the data in root.mk.</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineplus">+CURRENT_TIER := $(filter $(foreach tier,compile libs export tools,recurse_$(tier) $(tier)-deps),$(MAKECMDGOALS))</span>
<a href="#l4.53"></a><span id="l4.53" class="difflineplus">+ifneq (,$(filter-out 0 1,$(words $(CURRENT_TIER))))</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineplus">+$(error $(CURRENT_TIER) not supported on the same make command line)</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineplus">+endif</span>
<a href="#l4.56"></a><span id="l4.56" class="difflineplus">+CURRENT_TIER := $(subst recurse_,,$(CURRENT_TIER:-deps=))</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineplus">+</span>
<a href="#l4.58"></a><span id="l4.58" class="difflineplus">+# The rules here are doing directory traversal, so we don't want further</span>
<a href="#l4.59"></a><span id="l4.59" class="difflineplus">+# recursion to happen when running make -C subdir $tier. But some make files</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineplus">+# further call make -C something else, and sometimes expect recursion to</span>
<a href="#l4.61"></a><span id="l4.61" class="difflineplus">+# happen in that case (see browser/metro/locales/Makefile.in for example).</span>
<a href="#l4.62"></a><span id="l4.62" class="difflineplus">+# Conveniently, every invocation of make increases MAKELEVEL, so only stop</span>
<a href="#l4.63"></a><span id="l4.63" class="difflineplus">+# recursion from happening at current MAKELEVEL + 1.</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineplus">+ifdef CURRENT_TIER</span>
<a href="#l4.65"></a><span id="l4.65" class="difflineplus">+ifeq (0,$(MAKELEVEL))</span>
<a href="#l4.66"></a><span id="l4.66" class="difflineplus">+export NO_RECURSE_MAKELEVEL=1</span>
<a href="#l4.67"></a><span id="l4.67" class="difflineplus">+else</span>
<a href="#l4.68"></a><span id="l4.68" class="difflineplus">+export NO_RECURSE_MAKELEVEL=$(word $(MAKELEVEL),2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20)</span>
<a href="#l4.69"></a><span id="l4.69" class="difflineplus">+endif</span>
<a href="#l4.70"></a><span id="l4.70" class="difflineplus">+endif</span>
<a href="#l4.71"></a><span id="l4.71" class="difflineplus">+</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineplus">+# Get all directories traversed for all subtiers in the current tier, or use</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineplus">+# directly the $(*_dirs) variables available in root.mk when there is no</span>
<a href="#l4.74"></a><span id="l4.74" class="difflineplus">+# TIERS (like for js/src).</span>
<a href="#l4.75"></a><span id="l4.75" class="difflineplus">+CURRENT_DIRS := $($(CURRENT_TIER)_dirs)</span>
<a href="#l4.76"></a><span id="l4.76" class="difflineplus">+</span>
<a href="#l4.77"></a><span id="l4.77" class="difflineplus">+# The compile tier has different rules from other tiers.</span>
<a href="#l4.78"></a><span id="l4.78" class="difflineplus">+ifeq ($(CURRENT_TIER),compile)</span>
<a href="#l4.79"></a><span id="l4.79" class="difflineplus">+</span>
<a href="#l4.80"></a><span id="l4.80" class="difflineplus">+# Need a list of compile targets because we can't use pattern rules:</span>
<a href="#l4.81"></a><span id="l4.81" class="difflineplus">+# https://savannah.gnu.org/bugs/index.php?42833</span>
<a href="#l4.82"></a><span id="l4.82" class="difflineplus">+.PHONY: $(compile_targets)</span>
<a href="#l4.83"></a><span id="l4.83" class="difflineplus">+$(compile_targets):</span>
<a href="#l4.84"></a><span id="l4.84" class="difflineplus">+	$(call SUBMAKE,$(if $(filter $(@D),$(staticdirs)),,$(@F)),$(@D))</span>
<a href="#l4.85"></a><span id="l4.85" class="difflineplus">+</span>
<a href="#l4.86"></a><span id="l4.86" class="difflineplus">+else</span>
<a href="#l4.87"></a><span id="l4.87" class="difflineplus">+</span>
<a href="#l4.88"></a><span id="l4.88" class="difflineplus">+# Recursion rule for all directories traversed for all subtiers in the</span>
<a href="#l4.89"></a><span id="l4.89" class="difflineplus">+# current tier.</span>
<a href="#l4.90"></a><span id="l4.90" class="difflineplus">+$(addsuffix /$(CURRENT_TIER),$(CURRENT_DIRS)): %/$(CURRENT_TIER):</span>
<a href="#l4.91"></a><span id="l4.91" class="difflineplus">+	$(call SUBMAKE,$(CURRENT_TIER),$*)</span>
<a href="#l4.92"></a><span id="l4.92" class="difflineplus">+</span>
<a href="#l4.93"></a><span id="l4.93" class="difflineplus">+.PHONY: $(addsuffix /$(CURRENT_TIER),$(CURRENT_DIRS))</span>
<a href="#l4.94"></a><span id="l4.94" class="difflineplus">+</span>
<a href="#l4.95"></a><span id="l4.95" class="difflineplus">+# Dummy rules for possibly inexisting dependencies for the above tier targets</span>
<a href="#l4.96"></a><span id="l4.96" class="difflineplus">+$(addsuffix /Makefile,$(CURRENT_DIRS)) $(addsuffix /backend.mk,$(CURRENT_DIRS)):</span>
<a href="#l4.97"></a><span id="l4.97" class="difflineplus">+</span>
<a href="#l4.98"></a><span id="l4.98" class="difflineplus">+ifeq ($(CURRENT_TIER),export)</span>
<a href="#l4.99"></a><span id="l4.99" class="difflineplus">+# At least build/export requires config/export for buildid, but who knows what</span>
<a href="#l4.100"></a><span id="l4.100" class="difflineplus">+# else, so keep this global dependency to make config/export first for now.</span>
<a href="#l4.101"></a><span id="l4.101" class="difflineplus">+$(addsuffix /$(CURRENT_TIER),$(filter-out config,$(CURRENT_DIRS))): config/$(CURRENT_TIER)</span>
<a href="#l4.102"></a><span id="l4.102" class="difflineplus">+</span>
<a href="#l4.103"></a><span id="l4.103" class="difflineplus">+# The export tier requires nsinstall, which is built from config. So every</span>
<a href="#l4.104"></a><span id="l4.104" class="difflineplus">+# subdirectory traversal needs to happen after building nsinstall in config,</span>
<a href="#l4.105"></a><span id="l4.105" class="difflineplus">+# which is done with the config/host target. Note the config/host target only</span>
<a href="#l4.106"></a><span id="l4.106" class="difflineplus">+# exists if nsinstall is actually built, which it is not on Windows, because we</span>
<a href="#l4.107"></a><span id="l4.107" class="difflineplus">+# use nsinstall.py there.</span>
<a href="#l4.108"></a><span id="l4.108" class="difflineplus">+ifneq (,$(filter config/host, $(compile_targets)))</span>
<a href="#l4.109"></a><span id="l4.109" class="difflineplus">+$(addsuffix /$(CURRENT_TIER),$(CURRENT_DIRS)): config/host</span>
<a href="#l4.110"></a><span id="l4.110" class="difflineplus">+</span>
<a href="#l4.111"></a><span id="l4.111" class="difflineplus">+# Ensure rules for config/host and its possible dependencies.</span>
<a href="#l4.112"></a><span id="l4.112" class="difflineplus">+.PHONY: $(filter %/host, $(compile_targets))</span>
<a href="#l4.113"></a><span id="l4.113" class="difflineplus">+$(filter %/host, $(compile_targets)):</span>
<a href="#l4.114"></a><span id="l4.114" class="difflineplus">+	$(call SUBMAKE,host,$(@D))</span>
<a href="#l4.115"></a><span id="l4.115" class="difflineplus">+endif</span>
<a href="#l4.116"></a><span id="l4.116" class="difflineplus">+endif</span>
<a href="#l4.117"></a><span id="l4.117" class="difflineplus">+</span>
<a href="#l4.118"></a><span id="l4.118" class="difflineplus">+endif # ifeq ($(CURRENT_TIER),compile)</span>
<a href="#l4.119"></a><span id="l4.119" class="difflineplus">+</span>
<a href="#l4.120"></a><span id="l4.120" class="difflineplus">+else</span>
<a href="#l4.121"></a><span id="l4.121" class="difflineplus">+</span>
<a href="#l4.122"></a><span id="l4.122" class="difflineplus">+# Don't recurse if MAKELEVEL is NO_RECURSE_MAKELEVEL as defined above</span>
<a href="#l4.123"></a><span id="l4.123" class="difflineplus">+ifeq ($(NO_RECURSE_MAKELEVEL),$(MAKELEVEL))</span>
<a href="#l4.124"></a><span id="l4.124" class="difflineplus">+</span>
<a href="#l4.125"></a><span id="l4.125" class="difflineplus">+compile libs export tools::</span>
<a href="#l4.126"></a><span id="l4.126" class="difflineplus">+</span>
<a href="#l4.127"></a><span id="l4.127" class="difflineplus">+else</span>
<a href="#l4.128"></a><span id="l4.128"> #########################</span>
<a href="#l4.129"></a><span id="l4.129"> # Tier traversal handling</span>
<a href="#l4.130"></a><span id="l4.130"> #########################</span>
<a href="#l4.131"></a><span id="l4.131"> </span>
<a href="#l4.132"></a><span id="l4.132"> ifdef TIERS</span>
<a href="#l4.133"></a><span id="l4.133"> </span>
<a href="#l4.134"></a><span id="l4.134" class="difflineminus">-compile libs export tools::</span>
<a href="#l4.135"></a><span id="l4.135" class="difflineminus">-	$(call BUILDSTATUS,TIER_START $@ $(filter-out $(if $(filter export,$@),,precompile),$(TIERS)))</span>
<a href="#l4.136"></a><span id="l4.136" class="difflineminus">-	$(foreach tier,$(TIERS), $(if $(filter-out compile_precompile libs_precompile tools_precompile,$@_$(tier)), \</span>
<a href="#l4.137"></a><span id="l4.137" class="difflineminus">-		$(call BUILDSTATUS,SUBTIER_START $@ $(tier) $(if $(filter libs,$@),$(tier_$(tier)_staticdirs)) $(tier_$(tier)_dirs)) \</span>
<a href="#l4.138"></a><span id="l4.138" class="difflineplus">+libs export tools::</span>
<a href="#l4.139"></a><span id="l4.139" class="difflineplus">+	$(call BUILDSTATUS,TIER_START $@)</span>
<a href="#l4.140"></a><span id="l4.140" class="difflineplus">+	$(foreach tier,$(TIERS), $(if $(filter-out libs_precompile tools_precompile,$@_$(tier)), \</span>
<a href="#l4.141"></a><span id="l4.141"> 		$(if $(filter libs,$@),$(foreach dir, $(tier_$(tier)_staticdirs), $(call TIER_DIR_SUBMAKE,$@,$(tier),$(dir),,1))) \</span>
<a href="#l4.142"></a><span id="l4.142" class="difflineminus">-		$(foreach dir, $(tier_$(tier)_dirs), $(call TIER_DIR_SUBMAKE,$@,$(tier),$(dir),$@)) \</span>
<a href="#l4.143"></a><span id="l4.143" class="difflineminus">-		$(call BUILDSTATUS,SUBTIER_FINISH $@ $(tier))))</span>
<a href="#l4.144"></a><span id="l4.144" class="difflineplus">+		$(foreach dir, $(tier_$(tier)_dirs), $(call TIER_DIR_SUBMAKE,$@,$(tier),$(dir),$@))))</span>
<a href="#l4.145"></a><span id="l4.145"> 	$(call BUILDSTATUS,TIER_FINISH $@)</span>
<a href="#l4.146"></a><span id="l4.146"> </span>
<a href="#l4.147"></a><span id="l4.147"> else</span>
<a href="#l4.148"></a><span id="l4.148"> </span>
<a href="#l4.149"></a><span id="l4.149"> define CREATE_SUBTIER_TRAVERSAL_RULE</span>
<a href="#l4.150"></a><span id="l4.150" class="difflineminus">-PARALLEL_DIRS_$(1) = $$(addsuffix _$(1),$$(PARALLEL_DIRS))</span>
<a href="#l4.151"></a><span id="l4.151" class="difflineminus">-</span>
<a href="#l4.152"></a><span id="l4.152" class="difflineminus">-.PHONY: $(1) $$(PARALLEL_DIRS_$(1))</span>
<a href="#l4.153"></a><span id="l4.153" class="difflineminus">-</span>
<a href="#l4.154"></a><span id="l4.154" class="difflineminus">-ifdef PARALLEL_DIRS</span>
<a href="#l4.155"></a><span id="l4.155" class="difflineminus">-$$(PARALLEL_DIRS_$(1)): %_$(1): %/Makefile</span>
<a href="#l4.156"></a><span id="l4.156" class="difflineminus">-	+@$$(call SUBMAKE,$(1),$$*)</span>
<a href="#l4.157"></a><span id="l4.157" class="difflineminus">-endif</span>
<a href="#l4.158"></a><span id="l4.158" class="difflineplus">+.PHONY: $(1)</span>
<a href="#l4.159"></a><span id="l4.159"> </span>
<a href="#l4.160"></a><span id="l4.160"> $(1):: $$(SUBMAKEFILES)</span>
<a href="#l4.161"></a><span id="l4.161" class="difflineminus">-ifdef PARALLEL_DIRS</span>
<a href="#l4.162"></a><span id="l4.162" class="difflineminus">-	+@$(MAKE) $$(PARALLEL_DIRS_$(1))</span>
<a href="#l4.163"></a><span id="l4.163" class="difflineminus">-endif</span>
<a href="#l4.164"></a><span id="l4.164"> 	$$(LOOP_OVER_DIRS)</span>
<a href="#l4.165"></a><span id="l4.165"> </span>
<a href="#l4.166"></a><span id="l4.166"> endef</span>
<a href="#l4.167"></a><span id="l4.167"> </span>
<a href="#l4.168"></a><span id="l4.168" class="difflineminus">-$(foreach subtier,export compile libs tools,$(eval $(call CREATE_SUBTIER_TRAVERSAL_RULE,$(subtier))))</span>
<a href="#l4.169"></a><span id="l4.169" class="difflineplus">+$(foreach subtier,export libs tools,$(eval $(call CREATE_SUBTIER_TRAVERSAL_RULE,$(subtier))))</span>
<a href="#l4.170"></a><span id="l4.170"> </span>
<a href="#l4.171"></a><span id="l4.171" class="difflineminus">-compile export:: $(SUBMAKEFILES)</span>
<a href="#l4.172"></a><span id="l4.172" class="difflineminus">-	$(LOOP_OVER_TOOL_DIRS)</span>
<a href="#l4.173"></a><span id="l4.173" class="difflineplus">+endif # ifdef TIERS</span>
<a href="#l4.174"></a><span id="l4.174" class="difflineplus">+</span>
<a href="#l4.175"></a><span id="l4.175" class="difflineplus">+endif # ifeq ($(NO_RECURSE_MAKELEVEL),$(MAKELEVEL))</span>
<a href="#l4.176"></a><span id="l4.176"> </span>
<a href="#l4.177"></a><span id="l4.177" class="difflineminus">-tools:: $(SUBMAKEFILES)</span>
<a href="#l4.178"></a><span id="l4.178" class="difflineminus">-	$(foreach dir,$(TOOL_DIRS),$(call SUBMAKE,libs,$(dir)))</span>
<a href="#l4.179"></a><span id="l4.179" class="difflineplus">+endif # ifeq (.,$(DEPTH))</span>
<a href="#l4.180"></a><span id="l4.180"> </span>
<a href="#l4.181"></a><span id="l4.181" class="difflineminus">-endif</span>
<a href="#l4.182"></a><span id="l4.182" class="difflineplus">+recurse:</span>
<a href="#l4.183"></a><span id="l4.183" class="difflineplus">+	@$(RECURSED_COMMAND)</span>
<a href="#l4.184"></a><span id="l4.184" class="difflineplus">+	$(LOOP_OVER_DIRS)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/config/rules.mk</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/config/rules.mk</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -14,94 +14,89 @@ ifdef INCLUDED_RULES_MK</span>
<a href="#l5.4"></a><span id="l5.4"> $(error Do not include rules.mk twice!)</span>
<a href="#l5.5"></a><span id="l5.5"> endif</span>
<a href="#l5.6"></a><span id="l5.6"> INCLUDED_RULES_MK = 1</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8"> # Make sure that anything that needs to be defined in moz.build wasn't</span>
<a href="#l5.9"></a><span id="l5.9"> # overwritten.</span>
<a href="#l5.10"></a><span id="l5.10"> _eval_for_side_effects := $(CHECK_MOZBUILD_VARIABLES)</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-ifdef TIERS</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-DIRS += $(foreach tier,$(TIERS),$(tier_$(tier)_dirs))</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineminus">-STATIC_DIRS += $(foreach tier,$(TIERS),$(tier_$(tier)_staticdirs))</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineminus">-endif</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineminus">-</span>
<a href="#l5.17"></a><span id="l5.17"> ifndef MOZILLA_DIR</span>
<a href="#l5.18"></a><span id="l5.18"> MOZILLA_DIR = $(MOZILLA_SRCDIR)</span>
<a href="#l5.19"></a><span id="l5.19"> endif</span>
<a href="#l5.20"></a><span id="l5.20"> </span>
<a href="#l5.21"></a><span id="l5.21"> ifndef INCLUDED_CONFIG_MK</span>
<a href="#l5.22"></a><span id="l5.22"> include $(topsrcdir)/config/config.mk</span>
<a href="#l5.23"></a><span id="l5.23"> endif</span>
<a href="#l5.24"></a><span id="l5.24"> </span>
<a href="#l5.25"></a><span id="l5.25"> ifndef INCLUDED_VERSION_MK</span>
<a href="#l5.26"></a><span id="l5.26"> include $(topsrcdir)/config/version.mk</span>
<a href="#l5.27"></a><span id="l5.27"> endif</span>
<a href="#l5.28"></a><span id="l5.28"> </span>
<a href="#l5.29"></a><span id="l5.29"> USE_AUTOTARGETS_MK = 1</span>
<a href="#l5.30"></a><span id="l5.30"> include $(topsrcdir)/config/makefiles/makeutils.mk</span>
<a href="#l5.31"></a><span id="l5.31"> </span>
<a href="#l5.32"></a><span id="l5.32" class="difflineminus">-ifdef SDK_HEADERS</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineminus">-EXPORTS += $(SDK_HEADERS)</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineminus">-endif</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineminus">-</span>
<a href="#l5.36"></a><span id="l5.36"> REPORT_BUILD = $(info $(notdir $&lt;))</span>
<a href="#l5.37"></a><span id="l5.37"> </span>
<a href="#l5.38"></a><span id="l5.38"> EXEC			= exec</span>
<a href="#l5.39"></a><span id="l5.39"> </span>
<a href="#l5.40"></a><span id="l5.40" class="difflineminus">-# Don't copy xulrunner files at install time, when using system xulrunner</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineminus">-ifdef SYSTEM_LIBXUL</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineminus">-  SKIP_COPY_XULRUNNER=1</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineminus">-endif</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineminus">-</span>
<a href="#l5.45"></a><span id="l5.45"> # ELOG prints out failed command when building silently (gmake -s). Pymake</span>
<a href="#l5.46"></a><span id="l5.46"> # prints out failed commands anyway, so ELOG just makes things worse by</span>
<a href="#l5.47"></a><span id="l5.47"> # forcing shell invocations.</span>
<a href="#l5.48"></a><span id="l5.48"> ifndef .PYMAKE</span>
<a href="#l5.49"></a><span id="l5.49"> ifneq (,$(findstring s, $(filter-out --%, $(MAKEFLAGS))))</span>
<a href="#l5.50"></a><span id="l5.50">   ELOG := $(EXEC) sh $(BUILD_TOOLS)/print-failed-commands.sh</span>
<a href="#l5.51"></a><span id="l5.51"> else</span>
<a href="#l5.52"></a><span id="l5.52">   ELOG :=</span>
<a href="#l5.53"></a><span id="l5.53"> endif # -s</span>
<a href="#l5.54"></a><span id="l5.54"> else</span>
<a href="#l5.55"></a><span id="l5.55">   ELOG :=</span>
<a href="#l5.56"></a><span id="l5.56"> endif # ifndef .PYMAKE</span>
<a href="#l5.57"></a><span id="l5.57"> </span>
<a href="#l5.58"></a><span id="l5.58"> _VPATH_SRCS = $(abspath $&lt;)</span>
<a href="#l5.59"></a><span id="l5.59"> </span>
<a href="#l5.60"></a><span id="l5.60" class="difflineminus">-# Add $(DIST)/lib to VPATH so that -lfoo dependencies are followed</span>
<a href="#l5.61"></a><span id="l5.61" class="difflineminus">-VPATH += $(DIST)/lib</span>
<a href="#l5.62"></a><span id="l5.62" class="difflineminus">-ifdef LIBXUL_SDK</span>
<a href="#l5.63"></a><span id="l5.63" class="difflineminus">-VPATH += $(LIBXUL_SDK)/lib</span>
<a href="#l5.64"></a><span id="l5.64" class="difflineminus">-endif</span>
<a href="#l5.65"></a><span id="l5.65" class="difflineminus">-</span>
<a href="#l5.66"></a><span id="l5.66"> ################################################################################</span>
<a href="#l5.67"></a><span id="l5.67"> # Testing frameworks support</span>
<a href="#l5.68"></a><span id="l5.68"> ################################################################################</span>
<a href="#l5.69"></a><span id="l5.69"> </span>
<a href="#l5.70"></a><span id="l5.70"> ifdef ENABLE_TESTS</span>
<a href="#l5.71"></a><span id="l5.71"> </span>
<a href="#l5.72"></a><span id="l5.72" class="difflineplus">+# Add test directories to the regular directories list. TEST_DIRS should</span>
<a href="#l5.73"></a><span id="l5.73" class="difflineplus">+# arguably have the same status as other *_DIRS variables. It is coded this way</span>
<a href="#l5.74"></a><span id="l5.74" class="difflineplus">+# until Makefiles stop using the &quot;ifdef ENABLE_TESTS; DIRS +=&quot; convention.</span>
<a href="#l5.75"></a><span id="l5.75" class="difflineplus">+#</span>
<a href="#l5.76"></a><span id="l5.76" class="difflineplus">+# The current developer workflow expects tests to be updated when processing</span>
<a href="#l5.77"></a><span id="l5.77" class="difflineplus">+# the default target. If we ever change this implementation, the behavior</span>
<a href="#l5.78"></a><span id="l5.78" class="difflineplus">+# should be preserved or the change should be widely communicated. A</span>
<a href="#l5.79"></a><span id="l5.79" class="difflineplus">+# consequence of not processing test dir targets during the default target is</span>
<a href="#l5.80"></a><span id="l5.80" class="difflineplus">+# that changes to tests may not be updated and code could assume to pass</span>
<a href="#l5.81"></a><span id="l5.81" class="difflineplus">+# locally against non-current test code.</span>
<a href="#l5.82"></a><span id="l5.82"> DIRS += $(TEST_DIRS)</span>
<a href="#l5.83"></a><span id="l5.83"> </span>
<a href="#l5.84"></a><span id="l5.84"> ifdef CPP_UNIT_TESTS</span>
<a href="#l5.85"></a><span id="l5.85" class="difflineplus">+ifdef COMPILE_ENVIRONMENT</span>
<a href="#l5.86"></a><span id="l5.86"> </span>
<a href="#l5.87"></a><span id="l5.87"> # Compile the tests to $(DIST)/bin.  Make lots of niceties available by default</span>
<a href="#l5.88"></a><span id="l5.88"> # through TestHarness.h, by modifying the list of includes and the libs against</span>
<a href="#l5.89"></a><span id="l5.89"> # which stuff links.</span>
<a href="#l5.90"></a><span id="l5.90"> SIMPLE_PROGRAMS += $(CPP_UNIT_TESTS)</span>
<a href="#l5.91"></a><span id="l5.91"> INCLUDES += -I$(DIST)/include/testing</span>
<a href="#l5.92"></a><span id="l5.92" class="difflineminus">-LIBS += $(NSPR_LIBS)</span>
<a href="#l5.93"></a><span id="l5.93" class="difflineplus">+EXTRA_LIBS += $(NSPR_LIBS)</span>
<a href="#l5.94"></a><span id="l5.94"> </span>
<a href="#l5.95"></a><span id="l5.95" class="difflineminus">-# ...and run them the usual way</span>
<a href="#l5.96"></a><span id="l5.96" class="difflineminus">-check::</span>
<a href="#l5.97"></a><span id="l5.97" class="difflineminus">-	@$(EXIT_ON_ERROR) \</span>
<a href="#l5.98"></a><span id="l5.98" class="difflineminus">-	  for f in $(CPP_UNIT_TESTS); do \</span>
<a href="#l5.99"></a><span id="l5.99" class="difflineminus">-	    XPCOM_DEBUG_BREAK=stack-and-abort $(RUN_TEST_PROGRAM) $(DIST)/bin/$$f; \</span>
<a href="#l5.100"></a><span id="l5.100" class="difflineminus">-	  done</span>
<a href="#l5.101"></a><span id="l5.101" class="difflineplus">+ifndef MOZ_PROFILE_GENERATE</span>
<a href="#l5.102"></a><span id="l5.102" class="difflineplus">+CPP_UNIT_TESTS_FILES = $(CPP_UNIT_TESTS)</span>
<a href="#l5.103"></a><span id="l5.103" class="difflineplus">+CPP_UNIT_TESTS_DEST = $(DIST)/cppunittests</span>
<a href="#l5.104"></a><span id="l5.104" class="difflineplus">+CPP_UNIT_TESTS_TARGET = target</span>
<a href="#l5.105"></a><span id="l5.105" class="difflineplus">+INSTALL_TARGETS += CPP_UNIT_TESTS</span>
<a href="#l5.106"></a><span id="l5.106" class="difflineplus">+endif</span>
<a href="#l5.107"></a><span id="l5.107"> </span>
<a href="#l5.108"></a><span id="l5.108" class="difflineplus">+run-cppunittests::</span>
<a href="#l5.109"></a><span id="l5.109" class="difflineplus">+	@$(PYTHON) $(topsrcdir)/testing/runcppunittests.py --xre-path=$(DIST)/bin --symbols-path=$(DIST)/crashreporter-symbols $(CPP_UNIT_TESTS)</span>
<a href="#l5.110"></a><span id="l5.110" class="difflineplus">+</span>
<a href="#l5.111"></a><span id="l5.111" class="difflineplus">+endif # COMPILE_ENVIRONMENT</span>
<a href="#l5.112"></a><span id="l5.112"> endif # CPP_UNIT_TESTS</span>
<a href="#l5.113"></a><span id="l5.113"> </span>
<a href="#l5.114"></a><span id="l5.114"> .PHONY: check xpcshell-tests check-interactive check-one</span>
<a href="#l5.115"></a><span id="l5.115"> </span>
<a href="#l5.116"></a><span id="l5.116"> endif # ENABLE_TESTS</span>
<a href="#l5.117"></a><span id="l5.117"> </span>
<a href="#l5.118"></a><span id="l5.118"> </span>
<a href="#l5.119"></a><span id="l5.119"> #</span>
<a href="#l5.120"></a><span id="l5.120" class="difflineat">@@ -162,93 +157,109 @@ ifndef GNU_CC</span>
<a href="#l5.121"></a><span id="l5.121"> # without SP1, don't do parallel builds.</span>
<a href="#l5.122"></a><span id="l5.122"> #</span>
<a href="#l5.123"></a><span id="l5.123"> # The final PDB for libraries and programs is created by the linker and uses</span>
<a href="#l5.124"></a><span id="l5.124"> # a different name from the single PDB file created by the compiler. See</span>
<a href="#l5.125"></a><span id="l5.125"> # bug 462740.</span>
<a href="#l5.126"></a><span id="l5.126"> #</span>
<a href="#l5.127"></a><span id="l5.127"> </span>
<a href="#l5.128"></a><span id="l5.128"> ifdef SIMPLE_PROGRAMS</span>
<a href="#l5.129"></a><span id="l5.129" class="difflineminus">-COMPILE_PDBFILE = $(basename $(@F)).pdb</span>
<a href="#l5.130"></a><span id="l5.130" class="difflineplus">+COMPILE_PDB_FLAG ?= -Fd$(basename $(@F)).pdb</span>
<a href="#l5.131"></a><span id="l5.131"> else</span>
<a href="#l5.132"></a><span id="l5.132" class="difflineminus">-COMPILE_PDBFILE = generated.pdb</span>
<a href="#l5.133"></a><span id="l5.133" class="difflineplus">+COMPILE_PDB_FLAG ?= -Fdgenerated.pdb</span>
<a href="#l5.134"></a><span id="l5.134"> endif</span>
<a href="#l5.135"></a><span id="l5.135" class="difflineplus">+COMPILE_CFLAGS += $(COMPILE_PDB_FLAG)</span>
<a href="#l5.136"></a><span id="l5.136" class="difflineplus">+COMPILE_CXXFLAGS += $(COMPILE_PDB_FLAG)</span>
<a href="#l5.137"></a><span id="l5.137"> </span>
<a href="#l5.138"></a><span id="l5.138" class="difflineminus">-LINK_PDBFILE = $(basename $(@F)).pdb</span>
<a href="#l5.139"></a><span id="l5.139" class="difflineplus">+LINK_PDBFILE ?= $(basename $(@F)).pdb</span>
<a href="#l5.140"></a><span id="l5.140"> ifdef MOZ_DEBUG</span>
<a href="#l5.141"></a><span id="l5.141"> CODFILE=$(basename $(@F)).cod</span>
<a href="#l5.142"></a><span id="l5.142"> endif</span>
<a href="#l5.143"></a><span id="l5.143"> </span>
<a href="#l5.144"></a><span id="l5.144" class="difflineminus">-ifdef MOZ_MAPINFO</span>
<a href="#l5.145"></a><span id="l5.145" class="difflineminus">-ifdef SHARED_LIBRARY_NAME</span>
<a href="#l5.146"></a><span id="l5.146" class="difflineminus">-MAPFILE=$(SHARED_LIBRARY_NAME).map</span>
<a href="#l5.147"></a><span id="l5.147" class="difflineminus">-else</span>
<a href="#l5.148"></a><span id="l5.148" class="difflineminus">-MAPFILE=$(basename $(@F)).map</span>
<a href="#l5.149"></a><span id="l5.149" class="difflineminus">-endif # SHARED_LIBRARY_NAME</span>
<a href="#l5.150"></a><span id="l5.150" class="difflineminus">-endif # MOZ_MAPINFO</span>
<a href="#l5.151"></a><span id="l5.151" class="difflineminus">-</span>
<a href="#l5.152"></a><span id="l5.152"> ifdef DEFFILE</span>
<a href="#l5.153"></a><span id="l5.153"> OS_LDFLAGS += -DEF:$(call normalizepath,$(DEFFILE))</span>
<a href="#l5.154"></a><span id="l5.154"> EXTRA_DEPS += $(DEFFILE)</span>
<a href="#l5.155"></a><span id="l5.155"> endif</span>
<a href="#l5.156"></a><span id="l5.156"> </span>
<a href="#l5.157"></a><span id="l5.157" class="difflineminus">-ifdef MAPFILE</span>
<a href="#l5.158"></a><span id="l5.158" class="difflineminus">-OS_LDFLAGS += -MAP:$(MAPFILE)</span>
<a href="#l5.159"></a><span id="l5.159" class="difflineplus">+else #!GNU_CC</span>
<a href="#l5.160"></a><span id="l5.160" class="difflineplus">+</span>
<a href="#l5.161"></a><span id="l5.161" class="difflineplus">+ifdef DEFFILE</span>
<a href="#l5.162"></a><span id="l5.162" class="difflineplus">+OS_LDFLAGS += $(call normalizepath,$(DEFFILE))</span>
<a href="#l5.163"></a><span id="l5.163" class="difflineplus">+EXTRA_DEPS += $(DEFFILE)</span>
<a href="#l5.164"></a><span id="l5.164"> endif</span>
<a href="#l5.165"></a><span id="l5.165"> </span>
<a href="#l5.166"></a><span id="l5.166"> endif # !GNU_CC</span>
<a href="#l5.167"></a><span id="l5.167"> </span>
<a href="#l5.168"></a><span id="l5.168"> endif # WINNT</span>
<a href="#l5.169"></a><span id="l5.169"> </span>
<a href="#l5.170"></a><span id="l5.170"> ifeq ($(SOLARIS_SUNPRO_CXX),1)</span>
<a href="#l5.171"></a><span id="l5.171"> ifeq (86,$(findstring 86,$(OS_TEST)))</span>
<a href="#l5.172"></a><span id="l5.172"> OS_LDFLAGS += -M $(MOZILLA_DIR)/config/solaris_ia32.map</span>
<a href="#l5.173"></a><span id="l5.173"> endif # x86</span>
<a href="#l5.174"></a><span id="l5.174"> endif # Solaris Sun Studio C++</span>
<a href="#l5.175"></a><span id="l5.175"> </span>
<a href="#l5.176"></a><span id="l5.176"> ifeq ($(HOST_OS_ARCH),WINNT)</span>
<a href="#l5.177"></a><span id="l5.177"> HOST_PDBFILE=$(basename $(@F)).pdb</span>
<a href="#l5.178"></a><span id="l5.178" class="difflineplus">+HOST_PDB_FLAG ?= -Fd$(HOST_PDBFILE)</span>
<a href="#l5.179"></a><span id="l5.179" class="difflineplus">+HOST_CFLAGS += $(HOST_PDB_FLAG)</span>
<a href="#l5.180"></a><span id="l5.180" class="difflineplus">+HOST_CXXFLAGS += $(HOST_PDB_FLAG)</span>
<a href="#l5.181"></a><span id="l5.181"> endif</span>
<a href="#l5.182"></a><span id="l5.182"> </span>
<a href="#l5.183"></a><span id="l5.183" class="difflineplus">+# Don't build SIMPLE_PROGRAMS during the MOZ_PROFILE_GENERATE pass</span>
<a href="#l5.184"></a><span id="l5.184" class="difflineplus">+ifdef MOZ_PROFILE_GENERATE</span>
<a href="#l5.185"></a><span id="l5.185" class="difflineplus">+SIMPLE_PROGRAMS :=</span>
<a href="#l5.186"></a><span id="l5.186" class="difflineplus">+endif</span>
<a href="#l5.187"></a><span id="l5.187" class="difflineplus">+</span>
<a href="#l5.188"></a><span id="l5.188" class="difflineplus">+ifdef COMPILE_ENVIRONMENT</span>
<a href="#l5.189"></a><span id="l5.189"> ifndef TARGETS</span>
<a href="#l5.190"></a><span id="l5.190"> TARGETS			= $(LIBRARY) $(SHARED_LIBRARY) $(PROGRAM) $(SIMPLE_PROGRAMS) $(HOST_LIBRARY) $(HOST_PROGRAM) $(HOST_SIMPLE_PROGRAMS)</span>
<a href="#l5.191"></a><span id="l5.191"> endif</span>
<a href="#l5.192"></a><span id="l5.192"> </span>
<a href="#l5.193"></a><span id="l5.193" class="difflineplus">+COBJS = $(notdir $(CSRCS:.c=.$(OBJ_SUFFIX)))</span>
<a href="#l5.194"></a><span id="l5.194" class="difflineplus">+SOBJS = $(notdir $(SSRCS:.S=.$(OBJ_SUFFIX)))</span>
<a href="#l5.195"></a><span id="l5.195" class="difflineplus">+# CPPSRCS can have different extensions (eg: .cpp, .cc)</span>
<a href="#l5.196"></a><span id="l5.196" class="difflineplus">+CPPOBJS = $(notdir $(addsuffix .$(OBJ_SUFFIX),$(basename $(CPPSRCS))))</span>
<a href="#l5.197"></a><span id="l5.197" class="difflineplus">+CMOBJS = $(notdir $(CMSRCS:.m=.$(OBJ_SUFFIX)))</span>
<a href="#l5.198"></a><span id="l5.198" class="difflineplus">+CMMOBJS = $(notdir $(CMMSRCS:.mm=.$(OBJ_SUFFIX)))</span>
<a href="#l5.199"></a><span id="l5.199" class="difflineplus">+ASOBJS = $(notdir $(ASFILES:.$(ASM_SUFFIX)=.$(OBJ_SUFFIX)))</span>
<a href="#l5.200"></a><span id="l5.200"> ifndef OBJS</span>
<a href="#l5.201"></a><span id="l5.201" class="difflineminus">-_OBJS			= \</span>
<a href="#l5.202"></a><span id="l5.202" class="difflineminus">-	$(JRI_STUB_CFILES) \</span>
<a href="#l5.203"></a><span id="l5.203" class="difflineminus">-	$(addsuffix .$(OBJ_SUFFIX), $(JMC_GEN)) \</span>
<a href="#l5.204"></a><span id="l5.204" class="difflineminus">-	$(CSRCS:.c=.$(OBJ_SUFFIX)) \</span>
<a href="#l5.205"></a><span id="l5.205" class="difflineminus">-	$(SSRCS:.S=.$(OBJ_SUFFIX)) \</span>
<a href="#l5.206"></a><span id="l5.206" class="difflineminus">-	$(patsubst %.cc,%.$(OBJ_SUFFIX),$(CPPSRCS:.cpp=.$(OBJ_SUFFIX))) \</span>
<a href="#l5.207"></a><span id="l5.207" class="difflineminus">-	$(CMSRCS:.m=.$(OBJ_SUFFIX)) \</span>
<a href="#l5.208"></a><span id="l5.208" class="difflineminus">-	$(CMMSRCS:.mm=.$(OBJ_SUFFIX)) \</span>
<a href="#l5.209"></a><span id="l5.209" class="difflineminus">-	$(ASFILES:.$(ASM_SUFFIX)=.$(OBJ_SUFFIX))</span>
<a href="#l5.210"></a><span id="l5.210" class="difflineminus">-OBJS	= $(strip $(_OBJS))</span>
<a href="#l5.211"></a><span id="l5.211" class="difflineplus">+_OBJS = $(COBJS) $(SOBJS) $(CPPOBJS) $(CMOBJS) $(CMMOBJS) $(ASOBJS)</span>
<a href="#l5.212"></a><span id="l5.212" class="difflineplus">+OBJS = $(strip $(_OBJS))</span>
<a href="#l5.213"></a><span id="l5.213"> endif</span>
<a href="#l5.214"></a><span id="l5.214"> </span>
<a href="#l5.215"></a><span id="l5.215" class="difflineplus">+HOST_COBJS = $(addprefix host_,$(notdir $(HOST_CSRCS:.c=.$(OBJ_SUFFIX))))</span>
<a href="#l5.216"></a><span id="l5.216" class="difflineplus">+# HOST_CPPOBJS can have different extensions (eg: .cpp, .cc)</span>
<a href="#l5.217"></a><span id="l5.217" class="difflineplus">+HOST_CPPOBJS = $(addprefix host_,$(notdir $(addsuffix .$(OBJ_SUFFIX),$(basename $(HOST_CPPSRCS)))))</span>
<a href="#l5.218"></a><span id="l5.218" class="difflineplus">+HOST_CMOBJS = $(addprefix host_,$(notdir $(HOST_CMSRCS:.m=.$(OBJ_SUFFIX))))</span>
<a href="#l5.219"></a><span id="l5.219" class="difflineplus">+HOST_CMMOBJS = $(addprefix host_,$(notdir $(HOST_CMMSRCS:.mm=.$(OBJ_SUFFIX))))</span>
<a href="#l5.220"></a><span id="l5.220"> ifndef HOST_OBJS</span>
<a href="#l5.221"></a><span id="l5.221" class="difflineminus">-_HOST_OBJS		= \</span>
<a href="#l5.222"></a><span id="l5.222" class="difflineminus">-        $(addprefix host_,$(HOST_CSRCS:.c=.$(OBJ_SUFFIX))) \</span>
<a href="#l5.223"></a><span id="l5.223" class="difflineminus">-	$(addprefix host_,$(patsubst %.cc,%.$(OBJ_SUFFIX),$(HOST_CPPSRCS:.cpp=.$(OBJ_SUFFIX)))) \</span>
<a href="#l5.224"></a><span id="l5.224" class="difflineminus">-	$(addprefix host_,$(HOST_CMSRCS:.m=.$(OBJ_SUFFIX))) \</span>
<a href="#l5.225"></a><span id="l5.225" class="difflineminus">-	$(addprefix host_,$(HOST_CMMSRCS:.mm=.$(OBJ_SUFFIX)))</span>
<a href="#l5.226"></a><span id="l5.226" class="difflineplus">+_HOST_OBJS = $(HOST_COBJS) $(HOST_CPPOBJS) $(HOST_CMOBJS) $(HOST_CMMOBJS)</span>
<a href="#l5.227"></a><span id="l5.227"> HOST_OBJS = $(strip $(_HOST_OBJS))</span>
<a href="#l5.228"></a><span id="l5.228"> endif</span>
<a href="#l5.229"></a><span id="l5.229" class="difflineminus">-</span>
<a href="#l5.230"></a><span id="l5.230" class="difflineminus">-LIBOBJS			:= $(addprefix \&quot;, $(OBJS))</span>
<a href="#l5.231"></a><span id="l5.231" class="difflineminus">-LIBOBJS			:= $(addsuffix \&quot;, $(LIBOBJS))</span>
<a href="#l5.232"></a><span id="l5.232" class="difflineplus">+else</span>
<a href="#l5.233"></a><span id="l5.233" class="difflineplus">+LIBRARY :=</span>
<a href="#l5.234"></a><span id="l5.234" class="difflineplus">+SHARED_LIBRARY :=</span>
<a href="#l5.235"></a><span id="l5.235" class="difflineplus">+IMPORT_LIBRARY :=</span>
<a href="#l5.236"></a><span id="l5.236" class="difflineplus">+REAL_LIBRARY :=</span>
<a href="#l5.237"></a><span id="l5.237" class="difflineplus">+PROGRAM :=</span>
<a href="#l5.238"></a><span id="l5.238" class="difflineplus">+SIMPLE_PROGRAMS :=</span>
<a href="#l5.239"></a><span id="l5.239" class="difflineplus">+HOST_LIBRARY :=</span>
<a href="#l5.240"></a><span id="l5.240" class="difflineplus">+HOST_PROGRAM :=</span>
<a href="#l5.241"></a><span id="l5.241" class="difflineplus">+HOST_SIMPLE_PROGRAMS :=</span>
<a href="#l5.242"></a><span id="l5.242" class="difflineplus">+SDK_BINARY := $(filter %.py,$(SDK_BINARY))</span>
<a href="#l5.243"></a><span id="l5.243" class="difflineplus">+SDK_LIBRARY :=</span>
<a href="#l5.244"></a><span id="l5.244" class="difflineplus">+endif</span>
<a href="#l5.245"></a><span id="l5.245"> </span>
<a href="#l5.246"></a><span id="l5.246"> ALL_TRASH = \</span>
<a href="#l5.247"></a><span id="l5.247"> 	$(GARBAGE) $(TARGETS) $(OBJS) $(PROGOBJS) LOGS TAGS a.out \</span>
<a href="#l5.248"></a><span id="l5.248"> 	$(filter-out $(ASFILES),$(OBJS:.$(OBJ_SUFFIX)=.s)) $(OBJS:.$(OBJ_SUFFIX)=.ii) \</span>
<a href="#l5.249"></a><span id="l5.249" class="difflineminus">-	$(OBJS:.$(OBJ_SUFFIX)=.i) \</span>
<a href="#l5.250"></a><span id="l5.250" class="difflineplus">+	$(OBJS:.$(OBJ_SUFFIX)=.i) $(OBJS:.$(OBJ_SUFFIX)=.i_o) \</span>
<a href="#l5.251"></a><span id="l5.251"> 	$(HOST_PROGOBJS) $(HOST_OBJS) $(IMPORT_LIBRARY) \</span>
<a href="#l5.252"></a><span id="l5.252"> 	$(EXE_DEF_FILE) so_locations _gen _stubs $(wildcard *.res) $(wildcard *.RES) \</span>
<a href="#l5.253"></a><span id="l5.253" class="difflineminus">-	$(wildcard *.pdb) $(CODFILE) $(MAPFILE) $(IMPORT_LIBRARY) \</span>
<a href="#l5.254"></a><span id="l5.254" class="difflineplus">+	$(wildcard *.pdb) $(CODFILE) $(IMPORT_LIBRARY) \</span>
<a href="#l5.255"></a><span id="l5.255"> 	$(SHARED_LIBRARY:$(DLL_SUFFIX)=.exp) $(wildcard *.ilk) \</span>
<a href="#l5.256"></a><span id="l5.256"> 	$(PROGRAM:$(BIN_SUFFIX)=.exp) $(SIMPLE_PROGRAMS:$(BIN_SUFFIX)=.exp) \</span>
<a href="#l5.257"></a><span id="l5.257"> 	$(PROGRAM:$(BIN_SUFFIX)=.lib) $(SIMPLE_PROGRAMS:$(BIN_SUFFIX)=.lib) \</span>
<a href="#l5.258"></a><span id="l5.258"> 	$(SIMPLE_PROGRAMS:$(BIN_SUFFIX)=.$(OBJ_SUFFIX)) \</span>
<a href="#l5.259"></a><span id="l5.259"> 	$(wildcard gts_tmp_*) $(LIBRARY:%.a=.%.timestamp)</span>
<a href="#l5.260"></a><span id="l5.260"> ALL_TRASH_DIRS = \</span>
<a href="#l5.261"></a><span id="l5.261"> 	$(GARBAGE_DIRS) /no-such-file</span>
<a href="#l5.262"></a><span id="l5.262"> </span>
<a href="#l5.263"></a><span id="l5.263" class="difflineat">@@ -267,74 +278,61 @@ endif</span>
<a href="#l5.264"></a><span id="l5.264"> ifeq ($(SOLARIS_SUNPRO_CXX),1)</span>
<a href="#l5.265"></a><span id="l5.265"> GARBAGE_DIRS += SunWS_cache</span>
<a href="#l5.266"></a><span id="l5.266"> endif</span>
<a href="#l5.267"></a><span id="l5.267"> </span>
<a href="#l5.268"></a><span id="l5.268"> ifdef MOZ_UPDATE_XTERM</span>
<a href="#l5.269"></a><span id="l5.269"> # Its good not to have a newline at the end of the titlebar string because it</span>
<a href="#l5.270"></a><span id="l5.270"> # makes the make -s output easier to read.  Echo -n does not work on all</span>
<a href="#l5.271"></a><span id="l5.271"> # platforms, but we can trick printf into doing it.</span>
<a href="#l5.272"></a><span id="l5.272" class="difflineplus">+ifeq (.,$(relativesrcdir))</span>
<a href="#l5.273"></a><span id="l5.273" class="difflineplus">+UPDATE_TITLE = printf '\033]0;%s in %s\007' $(1) $(2) ;</span>
<a href="#l5.274"></a><span id="l5.274" class="difflineplus">+else</span>
<a href="#l5.275"></a><span id="l5.275"> UPDATE_TITLE = printf '\033]0;%s in %s\007' $(1) $(relativesrcdir)/$(2) ;</span>
<a href="#l5.276"></a><span id="l5.276"> endif</span>
<a href="#l5.277"></a><span id="l5.277" class="difflineplus">+endif</span>
<a href="#l5.278"></a><span id="l5.278"> </span>
<a href="#l5.279"></a><span id="l5.279" class="difflineminus">-define SUBMAKE # $(call SUBMAKE,target,directory)</span>
<a href="#l5.280"></a><span id="l5.280" class="difflineplus">+ifdef MACH</span>
<a href="#l5.281"></a><span id="l5.281" class="difflineplus">+ifndef NO_BUILDSTATUS_MESSAGES</span>
<a href="#l5.282"></a><span id="l5.282" class="difflineplus">+define BUILDSTATUS</span>
<a href="#l5.283"></a><span id="l5.283" class="difflineplus">+@echo 'BUILDSTATUS $1'</span>
<a href="#l5.284"></a><span id="l5.284" class="difflineplus">+</span>
<a href="#l5.285"></a><span id="l5.285" class="difflineplus">+endef</span>
<a href="#l5.286"></a><span id="l5.286" class="difflineplus">+endif</span>
<a href="#l5.287"></a><span id="l5.287" class="difflineplus">+endif</span>
<a href="#l5.288"></a><span id="l5.288" class="difflineplus">+</span>
<a href="#l5.289"></a><span id="l5.289" class="difflineplus">+define SUBMAKE # $(call SUBMAKE,target,directory,static)</span>
<a href="#l5.290"></a><span id="l5.290"> +@$(UPDATE_TITLE)</span>
<a href="#l5.291"></a><span id="l5.291"> +@$(MAKE) $(if $(2),-C $(2)) $(1)</span>
<a href="#l5.292"></a><span id="l5.292"> </span>
<a href="#l5.293"></a><span id="l5.293"> endef # The extra line is important here! don't delete it</span>
<a href="#l5.294"></a><span id="l5.294"> </span>
<a href="#l5.295"></a><span id="l5.295" class="difflineplus">+define TIER_DIR_SUBMAKE</span>
<a href="#l5.296"></a><span id="l5.296" class="difflineplus">+$(call SUBMAKE,$(4),$(3),$(5))</span>
<a href="#l5.297"></a><span id="l5.297" class="difflineplus">+</span>
<a href="#l5.298"></a><span id="l5.298" class="difflineplus">+endef # Ths empty line is important.</span>
<a href="#l5.299"></a><span id="l5.299" class="difflineplus">+</span>
<a href="#l5.300"></a><span id="l5.300"> ifneq (,$(strip $(DIRS)))</span>
<a href="#l5.301"></a><span id="l5.301"> LOOP_OVER_DIRS = \</span>
<a href="#l5.302"></a><span id="l5.302">   $(foreach dir,$(DIRS),$(call SUBMAKE,$@,$(dir)))</span>
<a href="#l5.303"></a><span id="l5.303"> endif</span>
<a href="#l5.304"></a><span id="l5.304"> </span>
<a href="#l5.305"></a><span id="l5.305" class="difflineminus">-# we only use this for the makefiles target and other stuff that doesn't matter</span>
<a href="#l5.306"></a><span id="l5.306" class="difflineminus">-ifneq (,$(strip $(PARALLEL_DIRS)))</span>
<a href="#l5.307"></a><span id="l5.307" class="difflineminus">-LOOP_OVER_PARALLEL_DIRS = \</span>
<a href="#l5.308"></a><span id="l5.308" class="difflineminus">-  $(foreach dir,$(PARALLEL_DIRS),$(call SUBMAKE,$@,$(dir)))</span>
<a href="#l5.309"></a><span id="l5.309" class="difflineminus">-endif</span>
<a href="#l5.310"></a><span id="l5.310" class="difflineminus">-</span>
<a href="#l5.311"></a><span id="l5.311" class="difflineminus">-ifneq (,$(strip $(STATIC_DIRS)))</span>
<a href="#l5.312"></a><span id="l5.312" class="difflineminus">-LOOP_OVER_STATIC_DIRS = \</span>
<a href="#l5.313"></a><span id="l5.313" class="difflineminus">-  $(foreach dir,$(STATIC_DIRS),$(call SUBMAKE,$@,$(dir)))</span>
<a href="#l5.314"></a><span id="l5.314" class="difflineminus">-endif</span>
<a href="#l5.315"></a><span id="l5.315" class="difflineminus">-</span>
<a href="#l5.316"></a><span id="l5.316" class="difflineminus">-ifneq (,$(strip $(TOOL_DIRS)))</span>
<a href="#l5.317"></a><span id="l5.317" class="difflineminus">-LOOP_OVER_TOOL_DIRS = \</span>
<a href="#l5.318"></a><span id="l5.318" class="difflineminus">-  $(foreach dir,$(TOOL_DIRS),$(call SUBMAKE,$@,$(dir)))</span>
<a href="#l5.319"></a><span id="l5.319" class="difflineminus">-endif</span>
<a href="#l5.320"></a><span id="l5.320" class="difflineminus">-</span>
<a href="#l5.321"></a><span id="l5.321" class="difflineminus">-ifdef PARALLEL_DIRS</span>
<a href="#l5.322"></a><span id="l5.322" class="difflineminus">-# create a bunch of fake targets for order-only processing</span>
<a href="#l5.323"></a><span id="l5.323" class="difflineminus">-PARALLEL_DIRS_export = $(addsuffix _export,$(PARALLEL_DIRS))</span>
<a href="#l5.324"></a><span id="l5.324" class="difflineminus">-PARALLEL_DIRS_libs = $(addsuffix _libs,$(PARALLEL_DIRS))</span>
<a href="#l5.325"></a><span id="l5.325" class="difflineminus">-PARALLEL_DIRS_tools = $(addsuffix _tools,$(PARALLEL_DIRS))</span>
<a href="#l5.326"></a><span id="l5.326" class="difflineminus">-</span>
<a href="#l5.327"></a><span id="l5.327" class="difflineminus">-.PHONY: $(PARALLEL_DIRS_export) $(PARALLEL_DIRS_libs) $(PARALLEL_DIRS_tools)</span>
<a href="#l5.328"></a><span id="l5.328" class="difflineminus">-endif</span>
<a href="#l5.329"></a><span id="l5.329" class="difflineminus">-</span>
<a href="#l5.330"></a><span id="l5.330"> #</span>
<a href="#l5.331"></a><span id="l5.331"> # Now we can differentiate between objects used to build a library, and</span>
<a href="#l5.332"></a><span id="l5.332"> # objects used to build an executable in the same directory.</span>
<a href="#l5.333"></a><span id="l5.333"> #</span>
<a href="#l5.334"></a><span id="l5.334"> ifndef PROGOBJS</span>
<a href="#l5.335"></a><span id="l5.335"> PROGOBJS		= $(OBJS)</span>
<a href="#l5.336"></a><span id="l5.336"> endif</span>
<a href="#l5.337"></a><span id="l5.337"> </span>
<a href="#l5.338"></a><span id="l5.338"> ifndef HOST_PROGOBJS</span>
<a href="#l5.339"></a><span id="l5.339"> HOST_PROGOBJS		= $(HOST_OBJS)</span>
<a href="#l5.340"></a><span id="l5.340"> endif</span>
<a href="#l5.341"></a><span id="l5.341"> </span>
<a href="#l5.342"></a><span id="l5.342" class="difflineminus">-# MAKE_DIRS: List of directories to build while looping over directories.</span>
<a href="#l5.343"></a><span id="l5.343" class="difflineminus">-# A Makefile that needs $(MDDEPDIR) created but doesn't set any of these</span>
<a href="#l5.344"></a><span id="l5.344" class="difflineminus">-# variables we know to check can just set NEED_MDDEPDIR explicitly.</span>
<a href="#l5.345"></a><span id="l5.345" class="difflineminus">-ifneq (,$(OBJS)$(SIMPLE_PROGRAMS)$(NEED_MDDEPDIR))</span>
<a href="#l5.346"></a><span id="l5.346" class="difflineminus">-MAKE_DIRS	+= $(CURDIR)/$(MDDEPDIR)</span>
<a href="#l5.347"></a><span id="l5.347" class="difflineminus">-GARBAGE_DIRS	+= $(CURDIR)/$(MDDEPDIR)</span>
<a href="#l5.348"></a><span id="l5.348" class="difflineminus">-endif</span>
<a href="#l5.349"></a><span id="l5.349" class="difflineplus">+GARBAGE_DIRS    += $(wildcard $(CURDIR)/$(MDDEPDIR))</span>
<a href="#l5.350"></a><span id="l5.350"> </span>
<a href="#l5.351"></a><span id="l5.351"> #</span>
<a href="#l5.352"></a><span id="l5.352"> # Tags: emacs (etags), vi (ctags)</span>
<a href="#l5.353"></a><span id="l5.353"> # TAG_PROGRAM := ctags -L -</span>
<a href="#l5.354"></a><span id="l5.354"> #</span>
<a href="#l5.355"></a><span id="l5.355"> TAG_PROGRAM		= xargs etags -a</span>
<a href="#l5.356"></a><span id="l5.356"> </span>
<a href="#l5.357"></a><span id="l5.357"> #</span>
<a href="#l5.358"></a><span id="l5.358" class="difflineat">@@ -383,17 +381,17 @@ endif</span>
<a href="#l5.359"></a><span id="l5.359"> ifeq ($(OS_ARCH),FreeBSD)</span>
<a href="#l5.360"></a><span id="l5.360"> ifdef IS_COMPONENT</span>
<a href="#l5.361"></a><span id="l5.361"> EXTRA_DSO_LDOPTS += -Wl,-Bsymbolic</span>
<a href="#l5.362"></a><span id="l5.362"> endif</span>
<a href="#l5.363"></a><span id="l5.363"> endif</span>
<a href="#l5.364"></a><span id="l5.364"> </span>
<a href="#l5.365"></a><span id="l5.365"> ifeq ($(OS_ARCH),NetBSD)</span>
<a href="#l5.366"></a><span id="l5.366"> ifneq (,$(filter arc cobalt hpcmips mipsco newsmips pmax sgimips,$(OS_TEST)))</span>
<a href="#l5.367"></a><span id="l5.367" class="difflineminus">-ifeq ($(MODULE),layout)</span>
<a href="#l5.368"></a><span id="l5.368" class="difflineplus">+ifneq (,$(filter layout/%,$(relativesrcdir)))</span>
<a href="#l5.369"></a><span id="l5.369"> OS_CFLAGS += -Wa,-xgot</span>
<a href="#l5.370"></a><span id="l5.370"> OS_CXXFLAGS += -Wa,-xgot</span>
<a href="#l5.371"></a><span id="l5.371"> endif</span>
<a href="#l5.372"></a><span id="l5.372"> endif</span>
<a href="#l5.373"></a><span id="l5.373"> endif</span>
<a href="#l5.374"></a><span id="l5.374"> </span>
<a href="#l5.375"></a><span id="l5.375"> #</span>
<a href="#l5.376"></a><span id="l5.376"> # HP-UXBeOS specific section: for COMPONENTS only, add -Bsymbolic flag</span>
<a href="#l5.377"></a><span id="l5.377" class="difflineat">@@ -426,26 +424,36 @@ endif # AIX</span>
<a href="#l5.378"></a><span id="l5.378"> </span>
<a href="#l5.379"></a><span id="l5.379"> #</span>
<a href="#l5.380"></a><span id="l5.380"> # Linux: add -Bsymbolic flag for components</span>
<a href="#l5.381"></a><span id="l5.381"> #</span>
<a href="#l5.382"></a><span id="l5.382"> ifeq ($(OS_ARCH),Linux)</span>
<a href="#l5.383"></a><span id="l5.383"> ifdef IS_COMPONENT</span>
<a href="#l5.384"></a><span id="l5.384"> EXTRA_DSO_LDOPTS += -Wl,-Bsymbolic</span>
<a href="#l5.385"></a><span id="l5.385"> endif</span>
<a href="#l5.386"></a><span id="l5.386" class="difflineplus">+ifdef LD_VERSION_SCRIPT</span>
<a href="#l5.387"></a><span id="l5.387" class="difflineplus">+EXTRA_DSO_LDOPTS += -Wl,--version-script,$(LD_VERSION_SCRIPT)</span>
<a href="#l5.388"></a><span id="l5.388" class="difflineplus">+EXTRA_DEPS += $(LD_VERSION_SCRIPT)</span>
<a href="#l5.389"></a><span id="l5.389" class="difflineplus">+endif</span>
<a href="#l5.390"></a><span id="l5.390"> endif</span>
<a href="#l5.391"></a><span id="l5.391"> </span>
<a href="#l5.392"></a><span id="l5.392"> #</span>
<a href="#l5.393"></a><span id="l5.393"> # GNU doesn't have path length limitation</span>
<a href="#l5.394"></a><span id="l5.394"> #</span>
<a href="#l5.395"></a><span id="l5.395"> </span>
<a href="#l5.396"></a><span id="l5.396"> ifeq ($(OS_ARCH),GNU)</span>
<a href="#l5.397"></a><span id="l5.397"> OS_CPPFLAGS += -DPATH_MAX=1024 -DMAXPATHLEN=1024</span>
<a href="#l5.398"></a><span id="l5.398"> endif</span>
<a href="#l5.399"></a><span id="l5.399"> </span>
<a href="#l5.400"></a><span id="l5.400" class="difflineplus">+ifeq ($(OS_ARCH),WINNT)</span>
<a href="#l5.401"></a><span id="l5.401" class="difflineplus">+ifdef USE_DELAYIMP</span>
<a href="#l5.402"></a><span id="l5.402" class="difflineplus">+OS_LIBS += $(call EXPAND_LIBNAME,delayimp)</span>
<a href="#l5.403"></a><span id="l5.403" class="difflineplus">+endif</span>
<a href="#l5.404"></a><span id="l5.404" class="difflineplus">+endif</span>
<a href="#l5.405"></a><span id="l5.405" class="difflineplus">+</span>
<a href="#l5.406"></a><span id="l5.406"> #</span>
<a href="#l5.407"></a><span id="l5.407"> # MINGW32</span>
<a href="#l5.408"></a><span id="l5.408"> #</span>
<a href="#l5.409"></a><span id="l5.409"> ifeq ($(OS_ARCH),WINNT)</span>
<a href="#l5.410"></a><span id="l5.410"> ifdef GNU_CC</span>
<a href="#l5.411"></a><span id="l5.411"> ifndef IS_COMPONENT</span>
<a href="#l5.412"></a><span id="l5.412"> DSO_LDOPTS += -Wl,--out-implib -Wl,$(IMPORT_LIBRARY)</span>
<a href="#l5.413"></a><span id="l5.413"> endif</span>
<a href="#l5.414"></a><span id="l5.414" class="difflineat">@@ -457,149 +465,158 @@ IFLAGS1 = -rb</span>
<a href="#l5.415"></a><span id="l5.415"> IFLAGS2 = -rb</span>
<a href="#l5.416"></a><span id="l5.416"> else</span>
<a href="#l5.417"></a><span id="l5.417"> IFLAGS1 = -m 644</span>
<a href="#l5.418"></a><span id="l5.418"> IFLAGS2 = -m 755</span>
<a href="#l5.419"></a><span id="l5.419"> endif</span>
<a href="#l5.420"></a><span id="l5.420"> </span>
<a href="#l5.421"></a><span id="l5.421"> ifeq (_WINNT,$(GNU_CC)_$(OS_ARCH))</span>
<a href="#l5.422"></a><span id="l5.422"> OUTOPTION = -Fo# eol</span>
<a href="#l5.423"></a><span id="l5.423" class="difflineplus">+PREPROCESS_OPTION = -P -Fi# eol</span>
<a href="#l5.424"></a><span id="l5.424"> else</span>
<a href="#l5.425"></a><span id="l5.425"> OUTOPTION = -o # eol</span>
<a href="#l5.426"></a><span id="l5.426" class="difflineplus">+PREPROCESS_OPTION = -E -o #eol</span>
<a href="#l5.427"></a><span id="l5.427"> endif # WINNT &amp;&amp; !GNU_CC</span>
<a href="#l5.428"></a><span id="l5.428"> </span>
<a href="#l5.429"></a><span id="l5.429" class="difflineplus">+ifneq (,$(filter ml%,$(AS)))</span>
<a href="#l5.430"></a><span id="l5.430" class="difflineplus">+ASOUTOPTION = -Fo# eol</span>
<a href="#l5.431"></a><span id="l5.431" class="difflineplus">+else</span>
<a href="#l5.432"></a><span id="l5.432" class="difflineplus">+ASOUTOPTION = -o # eol</span>
<a href="#l5.433"></a><span id="l5.433" class="difflineplus">+endif</span>
<a href="#l5.434"></a><span id="l5.434" class="difflineplus">+</span>
<a href="#l5.435"></a><span id="l5.435"> ifeq (,$(CROSS_COMPILE))</span>
<a href="#l5.436"></a><span id="l5.436"> HOST_OUTOPTION = $(OUTOPTION)</span>
<a href="#l5.437"></a><span id="l5.437"> else</span>
<a href="#l5.438"></a><span id="l5.438"> HOST_OUTOPTION = -o # eol</span>
<a href="#l5.439"></a><span id="l5.439"> endif</span>
<a href="#l5.440"></a><span id="l5.440"> ################################################################################</span>
<a href="#l5.441"></a><span id="l5.441"> </span>
<a href="#l5.442"></a><span id="l5.442"> # The root makefile doesn't want to do a plain export/libs, because</span>
<a href="#l5.443"></a><span id="l5.443"> # of the tiers and because of libxul. Suppress the default rules in favor</span>
<a href="#l5.444"></a><span id="l5.444"> # of something else. Makefiles which use this var *must* provide a sensible</span>
<a href="#l5.445"></a><span id="l5.445"> # default rule before including rules.mk</span>
<a href="#l5.446"></a><span id="l5.446"> ifndef SUPPRESS_DEFAULT_RULES</span>
<a href="#l5.447"></a><span id="l5.447"> default all::</span>
<a href="#l5.448"></a><span id="l5.448"> 	$(MAKE) export</span>
<a href="#l5.449"></a><span id="l5.449" class="difflineplus">+ifdef COMPILE_ENVIRONMENT</span>
<a href="#l5.450"></a><span id="l5.450"> 	$(MAKE) compile</span>
<a href="#l5.451"></a><span id="l5.451" class="difflineminus">-	$(MAKE) libs</span>
<a href="#l5.452"></a><span id="l5.452" class="difflineminus">-	$(MAKE) tools</span>
<a href="#l5.453"></a><span id="l5.453" class="difflineminus">-</span>
<a href="#l5.454"></a><span id="l5.454" class="difflineminus">-# Do depend as well</span>
<a href="#l5.455"></a><span id="l5.455" class="difflineminus">-alldep::</span>
<a href="#l5.456"></a><span id="l5.456" class="difflineminus">-	$(MAKE) export</span>
<a href="#l5.457"></a><span id="l5.457" class="difflineminus">-	$(MAKE) depend</span>
<a href="#l5.458"></a><span id="l5.458" class="difflineplus">+endif</span>
<a href="#l5.459"></a><span id="l5.459"> 	$(MAKE) libs</span>
<a href="#l5.460"></a><span id="l5.460"> 	$(MAKE) tools</span>
<a href="#l5.461"></a><span id="l5.461"> </span>
<a href="#l5.462"></a><span id="l5.462"> endif # SUPPRESS_DEFAULT_RULES</span>
<a href="#l5.463"></a><span id="l5.463"> </span>
<a href="#l5.464"></a><span id="l5.464" class="difflineminus">-ifeq ($(filter s,$(MAKEFLAGS)),)</span>
<a href="#l5.465"></a><span id="l5.465" class="difflineplus">+ifeq ($(findstring s,$(filter-out --%, $(MAKEFLAGS))),)</span>
<a href="#l5.466"></a><span id="l5.466"> ECHO := echo</span>
<a href="#l5.467"></a><span id="l5.467"> QUIET :=</span>
<a href="#l5.468"></a><span id="l5.468"> else</span>
<a href="#l5.469"></a><span id="l5.469"> ECHO := true</span>
<a href="#l5.470"></a><span id="l5.470"> QUIET := -q</span>
<a href="#l5.471"></a><span id="l5.471"> endif</span>
<a href="#l5.472"></a><span id="l5.472"> </span>
<a href="#l5.473"></a><span id="l5.473" class="difflineminus">-MAKE_TIER_SUBMAKEFILES = +$(if $(tier_$*_dirs),$(MAKE) $(addsuffix /Makefile,$(tier_$*_dirs)))</span>
<a href="#l5.474"></a><span id="l5.474" class="difflineminus">-</span>
<a href="#l5.475"></a><span id="l5.475" class="difflineminus">-export_tier_%:</span>
<a href="#l5.476"></a><span id="l5.476" class="difflineminus">-	@$(ECHO) &quot;$@&quot;</span>
<a href="#l5.477"></a><span id="l5.477" class="difflineminus">-	@$(MAKE_TIER_SUBMAKEFILES)</span>
<a href="#l5.478"></a><span id="l5.478" class="difflineminus">-	$(foreach dir,$(tier_$*_dirs),$(call SUBMAKE,export,$(dir)))</span>
<a href="#l5.479"></a><span id="l5.479" class="difflineminus">-</span>
<a href="#l5.480"></a><span id="l5.480" class="difflineminus">-libs_tier_%:</span>
<a href="#l5.481"></a><span id="l5.481" class="difflineminus">-	@$(ECHO) &quot;$@&quot;</span>
<a href="#l5.482"></a><span id="l5.482" class="difflineminus">-	@$(MAKE_TIER_SUBMAKEFILES)</span>
<a href="#l5.483"></a><span id="l5.483" class="difflineminus">-	$(foreach dir,$(tier_$*_dirs),$(call SUBMAKE,libs,$(dir)))</span>
<a href="#l5.484"></a><span id="l5.484" class="difflineminus">-</span>
<a href="#l5.485"></a><span id="l5.485" class="difflineminus">-tools_tier_%:</span>
<a href="#l5.486"></a><span id="l5.486" class="difflineminus">-	@$(ECHO) &quot;$@&quot;</span>
<a href="#l5.487"></a><span id="l5.487" class="difflineminus">-	@$(MAKE_TIER_SUBMAKEFILES)</span>
<a href="#l5.488"></a><span id="l5.488" class="difflineminus">-	$(foreach dir,$(tier_$*_dirs),$(call SUBMAKE,tools,$(dir)))</span>
<a href="#l5.489"></a><span id="l5.489" class="difflineminus">-</span>
<a href="#l5.490"></a><span id="l5.490" class="difflineminus">-$(foreach tier,$(TIERS),tier_$(tier))::</span>
<a href="#l5.491"></a><span id="l5.491" class="difflineminus">-	@$(ECHO) &quot;$@: $($@_staticdirs) $($@_dirs)&quot;</span>
<a href="#l5.492"></a><span id="l5.492" class="difflineminus">-	$(foreach dir,$($@_staticdirs),$(call SUBMAKE,,$(dir)))</span>
<a href="#l5.493"></a><span id="l5.493" class="difflineminus">-	$(MAKE) export_$@</span>
<a href="#l5.494"></a><span id="l5.494" class="difflineminus">-	$(MAKE) libs_$@</span>
<a href="#l5.495"></a><span id="l5.495" class="difflineminus">-	$(MAKE) tools_$@</span>
<a href="#l5.496"></a><span id="l5.496" class="difflineminus">-</span>
<a href="#l5.497"></a><span id="l5.497"> # Do everything from scratch</span>
<a href="#l5.498"></a><span id="l5.498"> everything::</span>
<a href="#l5.499"></a><span id="l5.499"> 	$(MAKE) clean</span>
<a href="#l5.500"></a><span id="l5.500" class="difflineminus">-	$(MAKE) alldep</span>
<a href="#l5.501"></a><span id="l5.501" class="difflineminus">-</span>
<a href="#l5.502"></a><span id="l5.502" class="difflineminus">-# Add dummy depend target for tinderboxes</span>
<a href="#l5.503"></a><span id="l5.503" class="difflineminus">-depend::</span>
<a href="#l5.504"></a><span id="l5.504" class="difflineplus">+	$(MAKE) all</span>
<a href="#l5.505"></a><span id="l5.505"> </span>
<a href="#l5.506"></a><span id="l5.506" class="difflineminus">-ifneq (,$(filter-out %.$(LIB_SUFFIX),$(SHARED_LIBRARY_LIBS)))</span>
<a href="#l5.507"></a><span id="l5.507" class="difflineminus">-$(error SHARED_LIBRARY_LIBS must contain .$(LIB_SUFFIX) files only)</span>
<a href="#l5.508"></a><span id="l5.508" class="difflineminus">-endif</span>
<a href="#l5.509"></a><span id="l5.509" class="difflineminus">-</span>
<a href="#l5.510"></a><span id="l5.510" class="difflineminus">-HOST_LIBS_DEPS = $(filter %.$(LIB_SUFFIX),$(HOST_LIBS))</span>
<a href="#l5.511"></a><span id="l5.511" class="difflineplus">+STATIC_LIBS_DEPS := $(addsuffix .$(LIBS_DESC_SUFFIX),$(STATIC_LIBS))</span>
<a href="#l5.512"></a><span id="l5.512"> </span>
<a href="#l5.513"></a><span id="l5.513"> # Dependencies which, if modified, should cause everything to rebuild</span>
<a href="#l5.514"></a><span id="l5.514"> GLOBAL_DEPS += Makefile $(DEPTH)/config/autoconf.mk $(topsrcdir)/config/config.mk</span>
<a href="#l5.515"></a><span id="l5.515"> </span>
<a href="#l5.516"></a><span id="l5.516"> ##############################################</span>
<a href="#l5.517"></a><span id="l5.517" class="difflineminus">-compile:: $(MAKE_DIRS) $(OBJS) $(HOST_OBJS)</span>
<a href="#l5.518"></a><span id="l5.518" class="difflineplus">+ifdef COMPILE_ENVIRONMENT</span>
<a href="#l5.519"></a><span id="l5.519" class="difflineplus">+OBJ_TARGETS = $(OBJS) $(PROGOBJS) $(HOST_OBJS) $(HOST_PROGOBJS)</span>
<a href="#l5.520"></a><span id="l5.520" class="difflineplus">+</span>
<a href="#l5.521"></a><span id="l5.521" class="difflineplus">+compile:: host target</span>
<a href="#l5.522"></a><span id="l5.522"> </span>
<a href="#l5.523"></a><span id="l5.523" class="difflineminus">-libs:: $(MAKE_DIRS) $(HOST_LIBRARY) $(LIBRARY) $(SHARED_LIBRARY) $(IMPORT_LIBRARY) $(HOST_PROGRAM) $(PROGRAM) $(HOST_SIMPLE_PROGRAMS) $(SIMPLE_PROGRAMS)</span>
<a href="#l5.524"></a><span id="l5.524" class="difflineplus">+host:: $(HOST_LIBRARY) $(HOST_PROGRAM) $(HOST_SIMPLE_PROGRAMS)</span>
<a href="#l5.525"></a><span id="l5.525" class="difflineplus">+</span>
<a href="#l5.526"></a><span id="l5.526" class="difflineplus">+target:: $(LIBRARY) $(SHARED_LIBRARY) $(PROGRAM) $(SIMPLE_PROGRAMS)</span>
<a href="#l5.527"></a><span id="l5.527" class="difflineplus">+</span>
<a href="#l5.528"></a><span id="l5.528"> ifndef NO_DIST_INSTALL</span>
<a href="#l5.529"></a><span id="l5.529" class="difflineminus">-ifdef LIBRARY</span>
<a href="#l5.530"></a><span id="l5.530" class="difflineminus">-ifdef DIST_INSTALL</span>
<a href="#l5.531"></a><span id="l5.531" class="difflineminus">-ifdef IS_COMPONENT</span>
<a href="#l5.532"></a><span id="l5.532" class="difflineminus">-	$(error Shipping static component libs makes no sense.)</span>
<a href="#l5.533"></a><span id="l5.533" class="difflineminus">-else</span>
<a href="#l5.534"></a><span id="l5.534" class="difflineminus">-	$(call install_cmd,$(IFLAGS1) $(LIBRARY) $(DIST)/lib)</span>
<a href="#l5.535"></a><span id="l5.535" class="difflineminus">-endif</span>
<a href="#l5.536"></a><span id="l5.536" class="difflineminus">-endif # DIST_INSTALL</span>
<a href="#l5.537"></a><span id="l5.537" class="difflineminus">-endif # LIBRARY</span>
<a href="#l5.538"></a><span id="l5.538"> ifdef SHARED_LIBRARY</span>
<a href="#l5.539"></a><span id="l5.539"> ifdef IS_COMPONENT</span>
<a href="#l5.540"></a><span id="l5.540" class="difflineminus">-	$(call install_cmd,$(IFLAGS2) $(SHARED_LIBRARY) $(FINAL_TARGET)/components)</span>
<a href="#l5.541"></a><span id="l5.541" class="difflineminus">-	$(ELF_DYNSTR_GC) $(FINAL_TARGET)/components/$(SHARED_LIBRARY)</span>
<a href="#l5.542"></a><span id="l5.542" class="difflineplus">+target:: $(SUBMAKEFILES) $(SHARED_LIBRARY)</span>
<a href="#l5.543"></a><span id="l5.543" class="difflineplus">+	$(INSTALL) $(IFLAGS2) $(SHARED_LIBRARY) $(FINAL_TARGET)/components</span>
<a href="#l5.544"></a><span id="l5.544"> ifndef NO_COMPONENTS_MANIFEST</span>
<a href="#l5.545"></a><span id="l5.545"> 	$(call py_action,buildlist,$(FINAL_TARGET)/chrome.manifest 'manifest components/components.manifest')</span>
<a href="#l5.546"></a><span id="l5.546"> 	$(call py_action,buildlist,$(FINAL_TARGET)/components/components.manifest 'binary-component $(SHARED_LIBRARY)')</span>
<a href="#l5.547"></a><span id="l5.547"> endif</span>
<a href="#l5.548"></a><span id="l5.548" class="difflineminus">-else # ! IS_COMPONENT</span>
<a href="#l5.549"></a><span id="l5.549" class="difflineminus">-ifneq (,$(filter WINNT,$(OS_ARCH)))</span>
<a href="#l5.550"></a><span id="l5.550" class="difflineminus">-ifndef NO_INSTALL_IMPORT_LIBRARY</span>
<a href="#l5.551"></a><span id="l5.551" class="difflineminus">-	$(call install_cmd,$(IFLAGS2) $(IMPORT_LIBRARY) $(DIST)/lib)</span>
<a href="#l5.552"></a><span id="l5.552" class="difflineminus">-endif</span>
<a href="#l5.553"></a><span id="l5.553" class="difflineminus">-else</span>
<a href="#l5.554"></a><span id="l5.554" class="difflineminus">-	$(call install_cmd,$(IFLAGS2) $(SHARED_LIBRARY) $(DIST)/lib)</span>
<a href="#l5.555"></a><span id="l5.555" class="difflineminus">-endif</span>
<a href="#l5.556"></a><span id="l5.556" class="difflineminus">-	$(call install_cmd,$(IFLAGS2) $(SHARED_LIBRARY) $(FINAL_TARGET))</span>
<a href="#l5.557"></a><span id="l5.557"> endif # IS_COMPONENT</span>
<a href="#l5.558"></a><span id="l5.558"> endif # SHARED_LIBRARY</span>
<a href="#l5.559"></a><span id="l5.559" class="difflineminus">-ifdef PROGRAM</span>
<a href="#l5.560"></a><span id="l5.560" class="difflineminus">-	$(call install_cmd,$(IFLAGS2) $(PROGRAM) $(FINAL_TARGET))</span>
<a href="#l5.561"></a><span id="l5.561" class="difflineminus">-endif</span>
<a href="#l5.562"></a><span id="l5.562" class="difflineminus">-ifdef SIMPLE_PROGRAMS</span>
<a href="#l5.563"></a><span id="l5.563" class="difflineminus">-	$(call install_cmd,$(IFLAGS2) $(SIMPLE_PROGRAMS) $(FINAL_TARGET))</span>
<a href="#l5.564"></a><span id="l5.564" class="difflineminus">-endif</span>
<a href="#l5.565"></a><span id="l5.565" class="difflineminus">-ifdef HOST_PROGRAM</span>
<a href="#l5.566"></a><span id="l5.566" class="difflineminus">-	$(call install_cmd,$(IFLAGS2) $(HOST_PROGRAM) $(DIST)/host/bin)</span>
<a href="#l5.567"></a><span id="l5.567" class="difflineminus">-endif</span>
<a href="#l5.568"></a><span id="l5.568" class="difflineminus">-ifdef HOST_SIMPLE_PROGRAMS</span>
<a href="#l5.569"></a><span id="l5.569" class="difflineminus">-	$(call install_cmd,$(IFLAGS2) $(HOST_SIMPLE_PROGRAMS) $(DIST)/host/bin)</span>
<a href="#l5.570"></a><span id="l5.570" class="difflineminus">-endif</span>
<a href="#l5.571"></a><span id="l5.571" class="difflineminus">-ifdef HOST_LIBRARY</span>
<a href="#l5.572"></a><span id="l5.572" class="difflineminus">-	$(call install_cmd,$(IFLAGS1) $(HOST_LIBRARY) $(DIST)/host/lib)</span>
<a href="#l5.573"></a><span id="l5.573" class="difflineminus">-endif</span>
<a href="#l5.574"></a><span id="l5.574"> endif # !NO_DIST_INSTALL</span>
<a href="#l5.575"></a><span id="l5.575"> </span>
<a href="#l5.576"></a><span id="l5.576" class="difflineminus">-##############################################</span>
<a href="#l5.577"></a><span id="l5.577" class="difflineplus">+ifndef NO_DIST_INSTALL</span>
<a href="#l5.578"></a><span id="l5.578" class="difflineplus">+</span>
<a href="#l5.579"></a><span id="l5.579" class="difflineplus">+ifneq (,$(strip $(PROGRAM)$(SIMPLE_PROGRAMS)))</span>
<a href="#l5.580"></a><span id="l5.580" class="difflineplus">+PROGRAMS_EXECUTABLES = $(SIMPLE_PROGRAMS) $(PROGRAM)</span>
<a href="#l5.581"></a><span id="l5.581" class="difflineplus">+PROGRAMS_DEST ?= $(FINAL_TARGET)</span>
<a href="#l5.582"></a><span id="l5.582" class="difflineplus">+PROGRAMS_TARGET := target</span>
<a href="#l5.583"></a><span id="l5.583" class="difflineplus">+INSTALL_TARGETS += PROGRAMS</span>
<a href="#l5.584"></a><span id="l5.584" class="difflineplus">+endif</span>
<a href="#l5.585"></a><span id="l5.585" class="difflineplus">+</span>
<a href="#l5.586"></a><span id="l5.586" class="difflineplus">+ifdef LIBRARY</span>
<a href="#l5.587"></a><span id="l5.587" class="difflineplus">+ifdef DIST_INSTALL</span>
<a href="#l5.588"></a><span id="l5.588" class="difflineplus">+ifdef IS_COMPONENT</span>
<a href="#l5.589"></a><span id="l5.589" class="difflineplus">+        $(error Shipping static component libs makes no sense.)</span>
<a href="#l5.590"></a><span id="l5.590" class="difflineplus">+else</span>
<a href="#l5.591"></a><span id="l5.591" class="difflineplus">+DIST_LIBRARY_FILES = $(LIBRARY)</span>
<a href="#l5.592"></a><span id="l5.592" class="difflineplus">+DIST_LIBRARY_DEST ?= $(DIST)/lib</span>
<a href="#l5.593"></a><span id="l5.593" class="difflineplus">+DIST_LIBRARY_TARGET = target</span>
<a href="#l5.594"></a><span id="l5.594" class="difflineplus">+INSTALL_TARGETS += DIST_LIBRARY</span>
<a href="#l5.595"></a><span id="l5.595" class="difflineplus">+endif</span>
<a href="#l5.596"></a><span id="l5.596" class="difflineplus">+endif # DIST_INSTALL</span>
<a href="#l5.597"></a><span id="l5.597" class="difflineplus">+endif # LIBRARY</span>
<a href="#l5.598"></a><span id="l5.598" class="difflineplus">+</span>
<a href="#l5.599"></a><span id="l5.599" class="difflineplus">+</span>
<a href="#l5.600"></a><span id="l5.600" class="difflineplus">+ifdef SHARED_LIBRARY</span>
<a href="#l5.601"></a><span id="l5.601" class="difflineplus">+ifndef IS_COMPONENT</span>
<a href="#l5.602"></a><span id="l5.602" class="difflineplus">+SHARED_LIBRARY_FILES = $(SHARED_LIBRARY)</span>
<a href="#l5.603"></a><span id="l5.603" class="difflineplus">+SHARED_LIBRARY_DEST ?= $(FINAL_TARGET)</span>
<a href="#l5.604"></a><span id="l5.604" class="difflineplus">+SHARED_LIBRARY_TARGET = target</span>
<a href="#l5.605"></a><span id="l5.605" class="difflineplus">+INSTALL_TARGETS += SHARED_LIBRARY</span>
<a href="#l5.606"></a><span id="l5.606"> </span>
<a href="#l5.607"></a><span id="l5.607" class="difflineminus">-ifndef NO_PROFILE_GUIDED_OPTIMIZE</span>
<a href="#l5.608"></a><span id="l5.608" class="difflineplus">+ifneq (,$(filter WINNT,$(OS_ARCH)))</span>
<a href="#l5.609"></a><span id="l5.609" class="difflineplus">+ifndef NO_INSTALL_IMPORT_LIBRARY</span>
<a href="#l5.610"></a><span id="l5.610" class="difflineplus">+IMPORT_LIB_FILES = $(IMPORT_LIBRARY)</span>
<a href="#l5.611"></a><span id="l5.611" class="difflineplus">+endif # NO_INSTALL_IMPORT_LIBRARY</span>
<a href="#l5.612"></a><span id="l5.612" class="difflineplus">+else</span>
<a href="#l5.613"></a><span id="l5.613" class="difflineplus">+IMPORT_LIB_FILES = $(SHARED_LIBRARY)</span>
<a href="#l5.614"></a><span id="l5.614" class="difflineplus">+endif</span>
<a href="#l5.615"></a><span id="l5.615" class="difflineplus">+</span>
<a href="#l5.616"></a><span id="l5.616" class="difflineplus">+IMPORT_LIB_DEST ?= $(DIST)/lib</span>
<a href="#l5.617"></a><span id="l5.617" class="difflineplus">+IMPORT_LIB_TARGET = target</span>
<a href="#l5.618"></a><span id="l5.618" class="difflineplus">+ifdef IMPORT_LIB_FILES</span>
<a href="#l5.619"></a><span id="l5.619" class="difflineplus">+INSTALL_TARGETS += IMPORT_LIB</span>
<a href="#l5.620"></a><span id="l5.620" class="difflineplus">+endif</span>
<a href="#l5.621"></a><span id="l5.621" class="difflineplus">+</span>
<a href="#l5.622"></a><span id="l5.622" class="difflineplus">+endif # ! IS_COMPONENT</span>
<a href="#l5.623"></a><span id="l5.623" class="difflineplus">+endif # SHARED_LIBRARY</span>
<a href="#l5.624"></a><span id="l5.624" class="difflineplus">+</span>
<a href="#l5.625"></a><span id="l5.625" class="difflineplus">+ifneq (,$(strip $(HOST_SIMPLE_PROGRAMS)$(HOST_PROGRAM)))</span>
<a href="#l5.626"></a><span id="l5.626" class="difflineplus">+HOST_PROGRAMS_EXECUTABLES = $(HOST_SIMPLE_PROGRAMS) $(HOST_PROGRAM)</span>
<a href="#l5.627"></a><span id="l5.627" class="difflineplus">+HOST_PROGRAMS_DEST ?= $(DIST)/host/bin</span>
<a href="#l5.628"></a><span id="l5.628" class="difflineplus">+HOST_PROGRAMS_TARGET = host</span>
<a href="#l5.629"></a><span id="l5.629" class="difflineplus">+INSTALL_TARGETS += HOST_PROGRAMS</span>
<a href="#l5.630"></a><span id="l5.630" class="difflineplus">+endif</span>
<a href="#l5.631"></a><span id="l5.631" class="difflineplus">+</span>
<a href="#l5.632"></a><span id="l5.632" class="difflineplus">+ifdef HOST_LIBRARY</span>
<a href="#l5.633"></a><span id="l5.633" class="difflineplus">+HOST_LIBRARY_FILES = $(HOST_LIBRARY)</span>
<a href="#l5.634"></a><span id="l5.634" class="difflineplus">+HOST_LIBRARY_DEST ?= $(DIST)/host/lib</span>
<a href="#l5.635"></a><span id="l5.635" class="difflineplus">+HOST_LIBRARY_TARGET = host</span>
<a href="#l5.636"></a><span id="l5.636" class="difflineplus">+INSTALL_TARGETS += HOST_LIBRARY</span>
<a href="#l5.637"></a><span id="l5.637" class="difflineplus">+endif</span>
<a href="#l5.638"></a><span id="l5.638" class="difflineplus">+</span>
<a href="#l5.639"></a><span id="l5.639" class="difflineplus">+endif # !NO_DIST_INSTALL</span>
<a href="#l5.640"></a><span id="l5.640" class="difflineplus">+</span>
<a href="#l5.641"></a><span id="l5.641" class="difflineplus">+endif</span>
<a href="#l5.642"></a><span id="l5.642" class="difflineplus">+</span>
<a href="#l5.643"></a><span id="l5.643" class="difflineplus">+##############################################</span>
<a href="#l5.644"></a><span id="l5.644" class="difflineplus">+ifneq (1,$(NO_PROFILE_GUIDED_OPTIMIZE))</span>
<a href="#l5.645"></a><span id="l5.645"> ifdef MOZ_PROFILE_USE</span>
<a href="#l5.646"></a><span id="l5.646"> ifeq ($(OS_ARCH)_$(GNU_CC), WINNT_)</span>
<a href="#l5.647"></a><span id="l5.647"> # When building with PGO, we have to make sure to re-link</span>
<a href="#l5.648"></a><span id="l5.648"> # in the MOZ_PROFILE_USE phase if we linked in the</span>
<a href="#l5.649"></a><span id="l5.649"> # MOZ_PROFILE_GENERATE phase. We'll touch this pgo.relink</span>
<a href="#l5.650"></a><span id="l5.650"> # file in the link rule in the GENERATE phase to indicate</span>
<a href="#l5.651"></a><span id="l5.651"> # that we need a relink.</span>
<a href="#l5.652"></a><span id="l5.652"> ifdef SHARED_LIBRARY</span>
<a href="#l5.653"></a><span id="l5.653" class="difflineat">@@ -619,50 +636,78 @@ ifdef PROGRAM</span>
<a href="#l5.654"></a><span id="l5.654"> 	  $(PROGRAM:$(BIN_SUFFIX)=) $(DIST)/bin</span>
<a href="#l5.655"></a><span id="l5.655"> endif</span>
<a href="#l5.656"></a><span id="l5.656"> ifdef SHARED_LIBRARY</span>
<a href="#l5.657"></a><span id="l5.657"> 	$(PYTHON) $(MOZILLA_SRCDIR)/build/win32/pgomerge.py \</span>
<a href="#l5.658"></a><span id="l5.658"> 	  $(patsubst $(DLL_PREFIX)%$(DLL_SUFFIX),%,$(SHARED_LIBRARY)) $(DIST)/bin</span>
<a href="#l5.659"></a><span id="l5.659"> endif</span>
<a href="#l5.660"></a><span id="l5.660"> endif # SHARED_LIBRARY || PROGRAM</span>
<a href="#l5.661"></a><span id="l5.661"> endif # WINNT_</span>
<a href="#l5.662"></a><span id="l5.662" class="difflineminus">-endif # MOZ_PROFILE_GENERATE || MOZ_PROFILE_USE</span>
<a href="#l5.663"></a><span id="l5.663" class="difflineplus">+endif # MOZ_PROFILE_USE</span>
<a href="#l5.664"></a><span id="l5.664" class="difflineplus">+ifdef MOZ_PROFILE_GENERATE</span>
<a href="#l5.665"></a><span id="l5.665" class="difflineplus">+# Clean up profiling data during PROFILE_GENERATE phase</span>
<a href="#l5.666"></a><span id="l5.666" class="difflineplus">+export::</span>
<a href="#l5.667"></a><span id="l5.667" class="difflineplus">+ifeq ($(OS_ARCH)_$(GNU_CC), WINNT_)</span>
<a href="#l5.668"></a><span id="l5.668" class="difflineplus">+	$(foreach pgd,$(wildcard *.pgd),pgomgr -clear $(pgd);)</span>
<a href="#l5.669"></a><span id="l5.669" class="difflineplus">+else</span>
<a href="#l5.670"></a><span id="l5.670" class="difflineplus">+ifdef GNU_CC</span>
<a href="#l5.671"></a><span id="l5.671" class="difflineplus">+	-$(RM) *.gcda</span>
<a href="#l5.672"></a><span id="l5.672" class="difflineplus">+endif</span>
<a href="#l5.673"></a><span id="l5.673" class="difflineplus">+endif</span>
<a href="#l5.674"></a><span id="l5.674" class="difflineplus">+endif</span>
<a href="#l5.675"></a><span id="l5.675" class="difflineplus">+</span>
<a href="#l5.676"></a><span id="l5.676" class="difflineplus">+ifneq (,$(MOZ_PROFILE_GENERATE)$(MOZ_PROFILE_USE))</span>
<a href="#l5.677"></a><span id="l5.677" class="difflineplus">+ifdef GNU_CC</span>
<a href="#l5.678"></a><span id="l5.678" class="difflineplus">+# Force rebuilding libraries and programs in both passes because each</span>
<a href="#l5.679"></a><span id="l5.679" class="difflineplus">+# pass uses different object files.</span>
<a href="#l5.680"></a><span id="l5.680" class="difflineplus">+$(PROGRAM) $(SHARED_LIBRARY) $(LIBRARY): FORCE</span>
<a href="#l5.681"></a><span id="l5.681" class="difflineplus">+endif</span>
<a href="#l5.682"></a><span id="l5.682" class="difflineplus">+endif</span>
<a href="#l5.683"></a><span id="l5.683" class="difflineplus">+</span>
<a href="#l5.684"></a><span id="l5.684"> endif # NO_PROFILE_GUIDED_OPTIMIZE</span>
<a href="#l5.685"></a><span id="l5.685"> </span>
<a href="#l5.686"></a><span id="l5.686"> ##############################################</span>
<a href="#l5.687"></a><span id="l5.687"> </span>
<a href="#l5.688"></a><span id="l5.688"> checkout:</span>
<a href="#l5.689"></a><span id="l5.689"> 	$(PYTHON) $(topsrcdir)/client.py checkout</span>
<a href="#l5.690"></a><span id="l5.690"> </span>
<a href="#l5.691"></a><span id="l5.691"> clean clobber realclean clobber_all::</span>
<a href="#l5.692"></a><span id="l5.692"> 	-$(RM) $(ALL_TRASH)</span>
<a href="#l5.693"></a><span id="l5.693"> 	-$(RM) -r $(ALL_TRASH_DIRS)</span>
<a href="#l5.694"></a><span id="l5.694" class="difflineminus">-	$(foreach dir,$(PARALLEL_DIRS) $(DIRS) $(STATIC_DIRS) $(TOOL_DIRS),-$(call SUBMAKE,$@,$(dir)))</span>
<a href="#l5.695"></a><span id="l5.695" class="difflineplus">+</span>
<a href="#l5.696"></a><span id="l5.696" class="difflineplus">+ifdef TIERS</span>
<a href="#l5.697"></a><span id="l5.697" class="difflineplus">+clean clobber realclean clobber_all distclean::</span>
<a href="#l5.698"></a><span id="l5.698" class="difflineplus">+	$(foreach dir, \</span>
<a href="#l5.699"></a><span id="l5.699" class="difflineplus">+		$(foreach tier, $(TIERS), $(tier_$(tier)_staticdirs) $(tier_$(tier)_dirs)), \</span>
<a href="#l5.700"></a><span id="l5.700" class="difflineplus">+		-$(call SUBMAKE,$@,$(dir)))</span>
<a href="#l5.701"></a><span id="l5.701" class="difflineplus">+else</span>
<a href="#l5.702"></a><span id="l5.702" class="difflineplus">+clean clobber realclean clobber_all distclean::</span>
<a href="#l5.703"></a><span id="l5.703" class="difflineplus">+	$(foreach dir,$(DIRS),-$(call SUBMAKE,$@,$(dir)))</span>
<a href="#l5.704"></a><span id="l5.704" class="difflineplus">+endif</span>
<a href="#l5.705"></a><span id="l5.705"> </span>
<a href="#l5.706"></a><span id="l5.706"> distclean::</span>
<a href="#l5.707"></a><span id="l5.707" class="difflineminus">-	$(foreach dir,$(PARALLEL_DIRS) $(DIRS) $(STATIC_DIRS) $(TOOL_DIRS),-$(call SUBMAKE,$@,$(dir)))</span>
<a href="#l5.708"></a><span id="l5.708"> 	-$(RM) -r $(ALL_TRASH_DIRS)</span>
<a href="#l5.709"></a><span id="l5.709"> 	-$(RM) $(ALL_TRASH)  \</span>
<a href="#l5.710"></a><span id="l5.710"> 	Makefile .HSancillary \</span>
<a href="#l5.711"></a><span id="l5.711"> 	$(wildcard *.$(OBJ_SUFFIX)) $(wildcard *.ho) $(wildcard host_*.o*) \</span>
<a href="#l5.712"></a><span id="l5.712"> 	$(wildcard *.$(LIB_SUFFIX)) $(wildcard *$(DLL_SUFFIX)) \</span>
<a href="#l5.713"></a><span id="l5.713"> 	$(wildcard *.$(IMPORT_LIB_SUFFIX))</span>
<a href="#l5.714"></a><span id="l5.714"> </span>
<a href="#l5.715"></a><span id="l5.715"> alltags:</span>
<a href="#l5.716"></a><span id="l5.716"> 	$(RM) TAGS</span>
<a href="#l5.717"></a><span id="l5.717"> 	find $(topsrcdir) -name dist -prune -o \( -name '*.[hc]' -o -name '*.cp' -o -name '*.cpp' -o -name '*.idl' \) -print | $(TAG_PROGRAM)</span>
<a href="#l5.718"></a><span id="l5.718"> </span>
<a href="#l5.719"></a><span id="l5.719"> #</span>
<a href="#l5.720"></a><span id="l5.720"> # PROGRAM = Foo</span>
<a href="#l5.721"></a><span id="l5.721"> # creates OBJS, links with LIBS to create Foo</span>
<a href="#l5.722"></a><span id="l5.722"> #</span>
<a href="#l5.723"></a><span id="l5.723" class="difflineminus">-$(PROGRAM): $(PROGOBJS) $(EXTRA_DEPS) $(EXE_DEF_FILE) $(RESFILE) $(GLOBAL_DEPS)</span>
<a href="#l5.724"></a><span id="l5.724" class="difflineplus">+$(PROGRAM): $(PROGOBJS) $(STATIC_LIBS_DEPS) $(EXTRA_DEPS) $(EXE_DEF_FILE) $(RESFILE) $(GLOBAL_DEPS)</span>
<a href="#l5.725"></a><span id="l5.725"> 	@$(RM) $@.manifest</span>
<a href="#l5.726"></a><span id="l5.726"> ifeq (_WINNT,$(GNU_CC)_$(OS_ARCH))</span>
<a href="#l5.727"></a><span id="l5.727" class="difflineminus">-	$(EXPAND_LD) -NOLOGO -OUT:$@ -PDB:$(LINK_PDBFILE) $(WIN32_EXE_LDFLAGS) $(LDFLAGS) $(MOZ_GLUE_PROGRAM_LDFLAGS) $(PROGOBJS) $(RESFILE) $(LIBS) $(EXTRA_LIBS) $(OS_LIBS)</span>
<a href="#l5.728"></a><span id="l5.728" class="difflineplus">+	$(EXPAND_LD) -NOLOGO -OUT:$@ -PDB:$(LINK_PDBFILE) $(WIN32_EXE_LDFLAGS) $(LDFLAGS) $(MOZ_GLUE_PROGRAM_LDFLAGS) $(PROGOBJS) $(RESFILE) $(STATIC_LIBS) $(SHARED_LIBS) $(EXTRA_LIBS) $(OS_LIBS)</span>
<a href="#l5.729"></a><span id="l5.729"> ifdef MSMANIFEST_TOOL</span>
<a href="#l5.730"></a><span id="l5.730"> 	@if test -f $@.manifest; then \</span>
<a href="#l5.731"></a><span id="l5.731"> 		if test -f '$(srcdir)/$@.manifest'; then \</span>
<a href="#l5.732"></a><span id="l5.732"> 			echo 'Embedding manifest from $(srcdir)/$@.manifest and $@.manifest'; \</span>
<a href="#l5.733"></a><span id="l5.733"> 			mt.exe -NOLOGO -MANIFEST '$(win_srcdir)/$@.manifest' $@.manifest -OUTPUTRESOURCE:$@\;1; \</span>
<a href="#l5.734"></a><span id="l5.734"> 		else \</span>
<a href="#l5.735"></a><span id="l5.735"> 			echo 'Embedding manifest from $@.manifest'; \</span>
<a href="#l5.736"></a><span id="l5.736"> 			mt.exe -NOLOGO -MANIFEST $@.manifest -OUTPUTRESOURCE:$@\;1; \</span>
<a href="#l5.737"></a><span id="l5.737" class="difflineat">@@ -673,141 +718,150 @@ ifdef MSMANIFEST_TOOL</span>
<a href="#l5.738"></a><span id="l5.738"> 	fi</span>
<a href="#l5.739"></a><span id="l5.739"> endif	# MSVC with manifest tool</span>
<a href="#l5.740"></a><span id="l5.740"> ifdef MOZ_PROFILE_GENERATE</span>
<a href="#l5.741"></a><span id="l5.741"> # touch it a few seconds into the future to work around FAT's</span>
<a href="#l5.742"></a><span id="l5.742"> # 2-second granularity</span>
<a href="#l5.743"></a><span id="l5.743"> 	touch -t `date +%Y%m%d%H%M.%S -d 'now+5seconds'` pgo.relink</span>
<a href="#l5.744"></a><span id="l5.744"> endif</span>
<a href="#l5.745"></a><span id="l5.745"> else # !WINNT || GNU_CC</span>
<a href="#l5.746"></a><span id="l5.746" class="difflineminus">-	$(EXPAND_CCC) -o $@ $(CXXFLAGS) $(PROGOBJS) $(RESFILE) $(WIN32_EXE_LDFLAGS) $(LDFLAGS) $(WRAP_LDFLAGS) $(LIBS) $(MOZ_GLUE_PROGRAM_LDFLAGS) $(EXTRA_LIBS) $(OS_LIBS) $(BIN_FLAGS) $(EXE_DEF_FILE) $(STLPORT_LIBS)</span>
<a href="#l5.747"></a><span id="l5.747" class="difflineplus">+	$(EXPAND_CCC) -o $@ $(CXXFLAGS) $(PROGOBJS) $(RESFILE) $(WIN32_EXE_LDFLAGS) $(LDFLAGS) $(WRAP_LDFLAGS) $(MOZ_GLUE_PROGRAM_LDFLAGS) $(STATIC_LIBS) $(SHARED_LIBS) $(EXTRA_LIBS) $(OS_LIBS) $(BIN_FLAGS) $(EXE_DEF_FILE) $(STLPORT_LIBS)</span>
<a href="#l5.748"></a><span id="l5.748"> endif # WINNT &amp;&amp; !GNU_CC</span>
<a href="#l5.749"></a><span id="l5.749"> </span>
<a href="#l5.750"></a><span id="l5.750"> ifdef ENABLE_STRIP</span>
<a href="#l5.751"></a><span id="l5.751" class="difflineminus">-	$(STRIP) $@</span>
<a href="#l5.752"></a><span id="l5.752" class="difflineplus">+	$(STRIP) $(STRIP_FLAGS) $@</span>
<a href="#l5.753"></a><span id="l5.753"> endif</span>
<a href="#l5.754"></a><span id="l5.754"> ifdef MOZ_POST_PROGRAM_COMMAND</span>
<a href="#l5.755"></a><span id="l5.755"> 	$(MOZ_POST_PROGRAM_COMMAND) $@</span>
<a href="#l5.756"></a><span id="l5.756"> endif</span>
<a href="#l5.757"></a><span id="l5.757"> </span>
<a href="#l5.758"></a><span id="l5.758" class="difflineminus">-$(HOST_PROGRAM): $(HOST_PROGOBJS) $(HOST_LIBS_DEPS) $(HOST_EXTRA_DEPS) $(GLOBAL_DEPS)</span>
<a href="#l5.759"></a><span id="l5.759" class="difflineplus">+$(HOST_PROGRAM): $(HOST_PROGOBJS) $(HOST_LIBS) $(HOST_EXTRA_DEPS) $(GLOBAL_DEPS)</span>
<a href="#l5.760"></a><span id="l5.760"> ifeq (_WINNT,$(GNU_CC)_$(HOST_OS_ARCH))</span>
<a href="#l5.761"></a><span id="l5.761" class="difflineminus">-	$(HOST_LD) -NOLOGO -OUT:$@ -PDB:$(HOST_PDBFILE) $(HOST_OBJS) $(WIN32_EXE_LDFLAGS) $(HOST_LDFLAGS) $(HOST_LIBS) $(HOST_EXTRA_LIBS)</span>
<a href="#l5.762"></a><span id="l5.762" class="difflineplus">+	$(EXPAND_LIBS_EXEC) -- $(HOST_LD) -NOLOGO -OUT:$@ -PDB:$(HOST_PDBFILE) $(HOST_OBJS) $(WIN32_EXE_LDFLAGS) $(HOST_LDFLAGS) $(HOST_LIBS) $(HOST_EXTRA_LIBS)</span>
<a href="#l5.763"></a><span id="l5.763"> ifdef MSMANIFEST_TOOL</span>
<a href="#l5.764"></a><span id="l5.764"> 	@if test -f $@.manifest; then \</span>
<a href="#l5.765"></a><span id="l5.765"> 		if test -f '$(srcdir)/$@.manifest'; then \</span>
<a href="#l5.766"></a><span id="l5.766"> 			echo 'Embedding manifest from $(srcdir)/$@.manifest and $@.manifest'; \</span>
<a href="#l5.767"></a><span id="l5.767"> 			mt.exe -NOLOGO -MANIFEST '$(win_srcdir)/$@.manifest' $@.manifest -OUTPUTRESOURCE:$@\;1; \</span>
<a href="#l5.768"></a><span id="l5.768"> 		else \</span>
<a href="#l5.769"></a><span id="l5.769"> 			echo 'Embedding manifest from $@.manifest'; \</span>
<a href="#l5.770"></a><span id="l5.770"> 			mt.exe -NOLOGO -MANIFEST $@.manifest -OUTPUTRESOURCE:$@\;1; \</span>
<a href="#l5.771"></a><span id="l5.771"> 		fi; \</span>
<a href="#l5.772"></a><span id="l5.772"> 	elif test -f '$(srcdir)/$@.manifest'; then \</span>
<a href="#l5.773"></a><span id="l5.773"> 		echo 'Embedding manifest from $(srcdir)/$@.manifest'; \</span>
<a href="#l5.774"></a><span id="l5.774"> 		mt.exe -NOLOGO -MANIFEST '$(win_srcdir)/$@.manifest' -OUTPUTRESOURCE:$@\;1; \</span>
<a href="#l5.775"></a><span id="l5.775"> 	fi</span>
<a href="#l5.776"></a><span id="l5.776"> endif	# MSVC with manifest tool</span>
<a href="#l5.777"></a><span id="l5.777"> else</span>
<a href="#l5.778"></a><span id="l5.778"> ifeq ($(HOST_CPP_PROG_LINK),1)</span>
<a href="#l5.779"></a><span id="l5.779" class="difflineminus">-	$(HOST_CXX) -o $@ $(HOST_CXXFLAGS) $(HOST_LDFLAGS) $(HOST_PROGOBJS) $(HOST_LIBS) $(HOST_EXTRA_LIBS)</span>
<a href="#l5.780"></a><span id="l5.780" class="difflineplus">+	$(EXPAND_LIBS_EXEC) -- $(HOST_CXX) -o $@ $(HOST_CXXFLAGS) $(HOST_LDFLAGS) $(HOST_PROGOBJS) $(HOST_LIBS) $(HOST_EXTRA_LIBS)</span>
<a href="#l5.781"></a><span id="l5.781"> else</span>
<a href="#l5.782"></a><span id="l5.782" class="difflineminus">-	$(HOST_CC) -o $@ $(HOST_CFLAGS) $(HOST_LDFLAGS) $(HOST_PROGOBJS) $(HOST_LIBS) $(HOST_EXTRA_LIBS)</span>
<a href="#l5.783"></a><span id="l5.783" class="difflineplus">+	$(EXPAND_LIBS_EXEC) -- $(HOST_CC) -o $@ $(HOST_CFLAGS) $(HOST_LDFLAGS) $(HOST_PROGOBJS) $(HOST_LIBS) $(HOST_EXTRA_LIBS)</span>
<a href="#l5.784"></a><span id="l5.784"> endif # HOST_CPP_PROG_LINK</span>
<a href="#l5.785"></a><span id="l5.785"> endif</span>
<a href="#l5.786"></a><span id="l5.786"> </span>
<a href="#l5.787"></a><span id="l5.787"> #</span>
<a href="#l5.788"></a><span id="l5.788"> # This is an attempt to support generation of multiple binaries</span>
<a href="#l5.789"></a><span id="l5.789"> # in one directory, it assumes everything to compile Foo is in</span>
<a href="#l5.790"></a><span id="l5.790"> # Foo.o (from either Foo.c or Foo.cpp).</span>
<a href="#l5.791"></a><span id="l5.791"> #</span>
<a href="#l5.792"></a><span id="l5.792"> # SIMPLE_PROGRAMS = Foo Bar</span>
<a href="#l5.793"></a><span id="l5.793"> # creates Foo.o Bar.o, links with LIBS to create Foo, Bar.</span>
<a href="#l5.794"></a><span id="l5.794"> #</span>
<a href="#l5.795"></a><span id="l5.795" class="difflineminus">-$(SIMPLE_PROGRAMS): %$(BIN_SUFFIX): %.$(OBJ_SUFFIX) $(EXTRA_DEPS) $(GLOBAL_DEPS)</span>
<a href="#l5.796"></a><span id="l5.796" class="difflineplus">+$(SIMPLE_PROGRAMS): %$(BIN_SUFFIX): %.$(OBJ_SUFFIX) $(STATIC_LIBS_DEPS) $(EXTRA_DEPS) $(GLOBAL_DEPS)</span>
<a href="#l5.797"></a><span id="l5.797"> ifeq (_WINNT,$(GNU_CC)_$(OS_ARCH))</span>
<a href="#l5.798"></a><span id="l5.798" class="difflineminus">-	$(EXPAND_LD) -nologo -out:$@ -pdb:$(LINK_PDBFILE) $&lt; $(WIN32_EXE_LDFLAGS) $(LDFLAGS) $(MOZ_GLUE_PROGRAM_LDFLAGS) $(LIBS) $(EXTRA_LIBS) $(OS_LIBS)</span>
<a href="#l5.799"></a><span id="l5.799" class="difflineplus">+	$(EXPAND_LD) -nologo -out:$@ -pdb:$(LINK_PDBFILE) $&lt; $(WIN32_EXE_LDFLAGS) $(LDFLAGS) $(MOZ_GLUE_PROGRAM_LDFLAGS) $(STATIC_LIBS) $(SHARED_LIBS) $(EXTRA_LIBS) $(OS_LIBS)</span>
<a href="#l5.800"></a><span id="l5.800"> ifdef MSMANIFEST_TOOL</span>
<a href="#l5.801"></a><span id="l5.801"> 	@if test -f $@.manifest; then \</span>
<a href="#l5.802"></a><span id="l5.802"> 		mt.exe -NOLOGO -MANIFEST $@.manifest -OUTPUTRESOURCE:$@\;1; \</span>
<a href="#l5.803"></a><span id="l5.803"> 		rm -f $@.manifest; \</span>
<a href="#l5.804"></a><span id="l5.804"> 	fi</span>
<a href="#l5.805"></a><span id="l5.805"> endif	# MSVC with manifest tool</span>
<a href="#l5.806"></a><span id="l5.806"> else</span>
<a href="#l5.807"></a><span id="l5.807" class="difflineminus">-	$(EXPAND_CCC) $(CXXFLAGS) -o $@ $&lt; $(WIN32_EXE_LDFLAGS) $(LDFLAGS) $(WRAP_LDFLAGS) $(LIBS) $(MOZ_GLUE_PROGRAM_LDFLAGS) $(EXTRA_LIBS) $(OS_LIBS) $(BIN_FLAGS) $(STLPORT_LIBS)</span>
<a href="#l5.808"></a><span id="l5.808" class="difflineplus">+	$(EXPAND_CCC) $(CXXFLAGS) -o $@ $&lt; $(WIN32_EXE_LDFLAGS) $(LDFLAGS) $(WRAP_LDFLAGS) $(MOZ_GLUE_PROGRAM_LDFLAGS) $(STATIC_LIBS) $(SHARED_LIBS) $(EXTRA_LIBS) $(OS_LIBS) $(BIN_FLAGS) $(STLPORT_LIBS)</span>
<a href="#l5.809"></a><span id="l5.809"> endif # WINNT &amp;&amp; !GNU_CC</span>
<a href="#l5.810"></a><span id="l5.810"> </span>
<a href="#l5.811"></a><span id="l5.811"> ifdef ENABLE_STRIP</span>
<a href="#l5.812"></a><span id="l5.812" class="difflineminus">-	$(STRIP) $@</span>
<a href="#l5.813"></a><span id="l5.813" class="difflineplus">+	$(STRIP) $(STRIP_FLAGS) $@</span>
<a href="#l5.814"></a><span id="l5.814"> endif</span>
<a href="#l5.815"></a><span id="l5.815"> ifdef MOZ_POST_PROGRAM_COMMAND</span>
<a href="#l5.816"></a><span id="l5.816"> 	$(MOZ_POST_PROGRAM_COMMAND) $@</span>
<a href="#l5.817"></a><span id="l5.817"> endif</span>
<a href="#l5.818"></a><span id="l5.818"> </span>
<a href="#l5.819"></a><span id="l5.819" class="difflineminus">-$(HOST_SIMPLE_PROGRAMS): host_%$(HOST_BIN_SUFFIX): host_%.$(OBJ_SUFFIX) $(HOST_LIBS_DEPS) $(HOST_EXTRA_DEPS) $(GLOBAL_DEPS)</span>
<a href="#l5.820"></a><span id="l5.820" class="difflineplus">+$(HOST_SIMPLE_PROGRAMS): host_%$(HOST_BIN_SUFFIX): host_%.$(OBJ_SUFFIX) $(HOST_LIBS) $(HOST_EXTRA_DEPS) $(GLOBAL_DEPS)</span>
<a href="#l5.821"></a><span id="l5.821"> ifeq (WINNT_,$(HOST_OS_ARCH)_$(GNU_CC))</span>
<a href="#l5.822"></a><span id="l5.822" class="difflineminus">-	$(HOST_LD) -NOLOGO -OUT:$@ -PDB:$(HOST_PDBFILE) $&lt; $(WIN32_EXE_LDFLAGS) $(HOST_LIBS) $(HOST_EXTRA_LIBS)</span>
<a href="#l5.823"></a><span id="l5.823" class="difflineplus">+	$(EXPAND_LIBS_EXEC) -- $(HOST_LD) -NOLOGO -OUT:$@ -PDB:$(HOST_PDBFILE) $&lt; $(WIN32_EXE_LDFLAGS) $(HOST_LIBS) $(HOST_EXTRA_LIBS)</span>
<a href="#l5.824"></a><span id="l5.824"> else</span>
<a href="#l5.825"></a><span id="l5.825"> ifneq (,$(HOST_CPPSRCS)$(USE_HOST_CXX))</span>
<a href="#l5.826"></a><span id="l5.826" class="difflineminus">-	$(HOST_CXX) $(HOST_OUTOPTION)$@ $(HOST_CXXFLAGS) $(INCLUDES) $&lt; $(HOST_LIBS) $(HOST_EXTRA_LIBS)</span>
<a href="#l5.827"></a><span id="l5.827" class="difflineplus">+	$(EXPAND_LIBS_EXEC) -- $(HOST_CXX) $(HOST_OUTOPTION)$@ $(HOST_CXXFLAGS) $(INCLUDES) $&lt; $(HOST_LIBS) $(HOST_EXTRA_LIBS)</span>
<a href="#l5.828"></a><span id="l5.828"> else</span>
<a href="#l5.829"></a><span id="l5.829" class="difflineminus">-	$(HOST_CC) $(HOST_OUTOPTION)$@ $(HOST_CFLAGS) $(INCLUDES) $&lt; $(HOST_LIBS) $(HOST_EXTRA_LIBS)</span>
<a href="#l5.830"></a><span id="l5.830" class="difflineplus">+	$(EXPAND_LIBS_EXEC) -- $(HOST_CC) $(HOST_OUTOPTION)$@ $(HOST_CFLAGS) $(INCLUDES) $&lt; $(HOST_LIBS) $(HOST_EXTRA_LIBS)</span>
<a href="#l5.831"></a><span id="l5.831"> endif</span>
<a href="#l5.832"></a><span id="l5.832"> endif</span>
<a href="#l5.833"></a><span id="l5.833"> </span>
<a href="#l5.834"></a><span id="l5.834"> ifdef DTRACE_PROBE_OBJ</span>
<a href="#l5.835"></a><span id="l5.835"> EXTRA_DEPS += $(DTRACE_PROBE_OBJ)</span>
<a href="#l5.836"></a><span id="l5.836" class="difflineplus">+OBJS += $(DTRACE_PROBE_OBJ)</span>
<a href="#l5.837"></a><span id="l5.837"> endif</span>
<a href="#l5.838"></a><span id="l5.838"> </span>
<a href="#l5.839"></a><span id="l5.839" class="difflineminus">-$(filter %.$(LIB_SUFFIX),$(LIBRARY)): $(OBJS) $(EXTRA_DEPS) $(GLOBAL_DEPS)</span>
<a href="#l5.840"></a><span id="l5.840" class="difflineplus">+$(filter %.$(LIB_SUFFIX),$(LIBRARY)): $(OBJS) $(STATIC_LIBS_DEPS) $(filter %.$(LIB_SUFFIX),$(EXTRA_LIBS)) $(EXTRA_DEPS) $(GLOBAL_DEPS)</span>
<a href="#l5.841"></a><span id="l5.841"> 	$(RM) $(LIBRARY)</span>
<a href="#l5.842"></a><span id="l5.842" class="difflineminus">-	$(EXPAND_AR) $(AR_FLAGS) $(OBJS) $(SHARED_LIBRARY_LIBS) $(filter %.$(LIB_SUFFIX),$(EXTRA_LIBS))</span>
<a href="#l5.843"></a><span id="l5.843" class="difflineplus">+	$(EXPAND_AR) $(AR_FLAGS) $(OBJS) $(STATIC_LIBS) $(filter %.$(LIB_SUFFIX),$(EXTRA_LIBS))</span>
<a href="#l5.844"></a><span id="l5.844"> 	$(RANLIB) $@</span>
<a href="#l5.845"></a><span id="l5.845"> </span>
<a href="#l5.846"></a><span id="l5.846" class="difflineminus">-$(filter-out %.$(LIB_SUFFIX),$(LIBRARY)): $(filter %.$(LIB_SUFFIX),$(LIBRARY)) $(OBJS) $(EXTRA_DEPS) $(GLOBAL_DEPS)</span>
<a href="#l5.847"></a><span id="l5.847" class="difflineplus">+$(filter-out %.$(LIB_SUFFIX),$(LIBRARY)): $(filter %.$(LIB_SUFFIX),$(LIBRARY)) $(OBJS) $(STATIC_LIBS_DEPS) $(filter %.$(LIB_SUFFIX),$(EXTRA_LIBS)) $(EXTRA_DEPS) $(GLOBAL_DEPS)</span>
<a href="#l5.848"></a><span id="l5.848"> # When we only build a library descriptor, blow out any existing library</span>
<a href="#l5.849"></a><span id="l5.849"> 	$(if $(filter %.$(LIB_SUFFIX),$(LIBRARY)),,$(RM) $(REAL_LIBRARY))</span>
<a href="#l5.850"></a><span id="l5.850" class="difflineminus">-	$(EXPAND_LIBS_GEN) -o $@ $(OBJS) $(SHARED_LIBRARY_LIBS) $(filter %.$(LIB_SUFFIX),$(EXTRA_LIBS))</span>
<a href="#l5.851"></a><span id="l5.851" class="difflineplus">+	$(EXPAND_LIBS_GEN) -o $@ $(OBJS) $(STATIC_LIBS) $(filter %.$(LIB_SUFFIX),$(EXTRA_LIBS))</span>
<a href="#l5.852"></a><span id="l5.852"> </span>
<a href="#l5.853"></a><span id="l5.853"> ifeq ($(OS_ARCH),WINNT)</span>
<a href="#l5.854"></a><span id="l5.854" class="difflineminus">-$(IMPORT_LIBRARY): $(SHARED_LIBRARY)</span>
<a href="#l5.855"></a><span id="l5.855" class="difflineplus">+# Import libraries are created by the rules creating shared libraries.</span>
<a href="#l5.856"></a><span id="l5.856" class="difflineplus">+# The rules to copy them to $(DIST)/lib depend on $(IMPORT_LIBRARY),</span>
<a href="#l5.857"></a><span id="l5.857" class="difflineplus">+# but make will happily consider the import library before it is refreshed</span>
<a href="#l5.858"></a><span id="l5.858" class="difflineplus">+# when rebuilding the corresponding shared library. Defining an empty recipe</span>
<a href="#l5.859"></a><span id="l5.859" class="difflineplus">+# for import libraries forces make to wait for the shared library recipe to</span>
<a href="#l5.860"></a><span id="l5.860" class="difflineplus">+# have run before considering other targets that depend on the import library.</span>
<a href="#l5.861"></a><span id="l5.861" class="difflineplus">+# See bug 795204.</span>
<a href="#l5.862"></a><span id="l5.862" class="difflineplus">+$(IMPORT_LIBRARY): $(SHARED_LIBRARY) ;</span>
<a href="#l5.863"></a><span id="l5.863"> endif</span>
<a href="#l5.864"></a><span id="l5.864"> </span>
<a href="#l5.865"></a><span id="l5.865"> $(HOST_LIBRARY): $(HOST_OBJS) Makefile</span>
<a href="#l5.866"></a><span id="l5.866"> 	$(RM) $@</span>
<a href="#l5.867"></a><span id="l5.867" class="difflineminus">-	$(HOST_AR) $(HOST_AR_FLAGS) $(HOST_OBJS)</span>
<a href="#l5.868"></a><span id="l5.868" class="difflineplus">+	$(EXPAND_LIBS_EXEC) --extract -- $(HOST_AR) $(HOST_AR_FLAGS) $(HOST_OBJS)</span>
<a href="#l5.869"></a><span id="l5.869"> 	$(HOST_RANLIB) $@</span>
<a href="#l5.870"></a><span id="l5.870"> </span>
<a href="#l5.871"></a><span id="l5.871"> ifdef HAVE_DTRACE</span>
<a href="#l5.872"></a><span id="l5.872"> ifndef XP_MACOSX</span>
<a href="#l5.873"></a><span id="l5.873"> ifdef DTRACE_PROBE_OBJ</span>
<a href="#l5.874"></a><span id="l5.874"> ifndef DTRACE_LIB_DEPENDENT</span>
<a href="#l5.875"></a><span id="l5.875" class="difflineminus">-$(DTRACE_PROBE_OBJ): $(OBJS)</span>
<a href="#l5.876"></a><span id="l5.876" class="difflineminus">-	dtrace -G -C -s $(MOZILLA_DTRACE_SRC) -o $(DTRACE_PROBE_OBJ) $(OBJS)</span>
<a href="#l5.877"></a><span id="l5.877" class="difflineplus">+NON_DTRACE_OBJS := $(filter-out $(DTRACE_PROBE_OBJ),$(OBJS))</span>
<a href="#l5.878"></a><span id="l5.878" class="difflineplus">+$(DTRACE_PROBE_OBJ): $(NON_DTRACE_OBJS)</span>
<a href="#l5.879"></a><span id="l5.879" class="difflineplus">+	dtrace -G -C -s $(MOZILLA_DTRACE_SRC) -o $(DTRACE_PROBE_OBJ) $(NON_DTRACE_OBJS)</span>
<a href="#l5.880"></a><span id="l5.880"> endif</span>
<a href="#l5.881"></a><span id="l5.881"> endif</span>
<a href="#l5.882"></a><span id="l5.882"> endif</span>
<a href="#l5.883"></a><span id="l5.883"> endif</span>
<a href="#l5.884"></a><span id="l5.884"> </span>
<a href="#l5.885"></a><span id="l5.885"> # On Darwin (Mac OS X), dwarf2 debugging uses debug info left in .o files,</span>
<a href="#l5.886"></a><span id="l5.886"> # so instead of deleting .o files after repacking them into a dylib, we make</span>
<a href="#l5.887"></a><span id="l5.887"> # symlinks back to the originals. The symlinks are a no-op for stabs debugging,</span>
<a href="#l5.888"></a><span id="l5.888"> # so no need to conditionalize on OS version or debugging format.</span>
<a href="#l5.889"></a><span id="l5.889"> </span>
<a href="#l5.890"></a><span id="l5.890" class="difflineminus">-$(SHARED_LIBRARY): $(OBJS) $(RESFILE) $(LIBRARY) $(EXTRA_DEPS) $(DSO_LDOPTS_DEPS) $(GLOBAL_DEPS)</span>
<a href="#l5.891"></a><span id="l5.891" class="difflineplus">+$(SHARED_LIBRARY): $(OBJS) $(RESFILE) $(STATIC_LIBS_DEPS) $(EXTRA_DEPS) $(GLOBAL_DEPS)</span>
<a href="#l5.892"></a><span id="l5.892"> ifndef INCREMENTAL_LINKER</span>
<a href="#l5.893"></a><span id="l5.893"> 	$(RM) $@</span>
<a href="#l5.894"></a><span id="l5.894"> endif</span>
<a href="#l5.895"></a><span id="l5.895"> ifdef DTRACE_LIB_DEPENDENT</span>
<a href="#l5.896"></a><span id="l5.896"> ifndef XP_MACOSX</span>
<a href="#l5.897"></a><span id="l5.897"> 	dtrace -G -C -s $(MOZILLA_DTRACE_SRC) -o  $(DTRACE_PROBE_OBJ) $(shell $(EXPAND_LIBS) $(MOZILLA_PROBE_LIBS))</span>
<a href="#l5.898"></a><span id="l5.898"> endif</span>
<a href="#l5.899"></a><span id="l5.899" class="difflineminus">-	$(EXPAND_MKSHLIB) $(SHLIB_LDSTARTFILE) $(OBJS) $(SUB_SHLOBJS) $(DTRACE_PROBE_OBJ) $(MOZILLA_PROBE_LIBS) $(RESFILE) $(LDFLAGS) $(WRAP_LDFLAGS) $(SHARED_LIBRARY_LIBS) $(EXTRA_DSO_LDOPTS) $(MOZ_GLUE_LDFLAGS) $(EXTRA_LIBS) $(OS_LIBS) $(SHLIB_LDENDFILE) $(if $(LIB_IS_C_ONLY),,$(STLPORT_LIBS))</span>
<a href="#l5.900"></a><span id="l5.900" class="difflineplus">+	$(EXPAND_MKSHLIB) $(SHLIB_LDSTARTFILE) $(OBJS) $(SUB_SHLOBJS) $(DTRACE_PROBE_OBJ) $(MOZILLA_PROBE_LIBS) $(RESFILE) $(LDFLAGS) $(WRAP_LDFLAGS) $(STATIC_LIBS) $(SHARED_LIBS) $(EXTRA_DSO_LDOPTS) $(MOZ_GLUE_LDFLAGS) $(EXTRA_LIBS) $(OS_LIBS) $(SHLIB_LDENDFILE) $(if $(LIB_IS_C_ONLY),,$(STLPORT_LIBS))</span>
<a href="#l5.901"></a><span id="l5.901"> 	@$(RM) $(DTRACE_PROBE_OBJ)</span>
<a href="#l5.902"></a><span id="l5.902"> else # ! DTRACE_LIB_DEPENDENT</span>
<a href="#l5.903"></a><span id="l5.903" class="difflineminus">-	$(EXPAND_MKSHLIB) $(SHLIB_LDSTARTFILE) $(OBJS) $(SUB_SHLOBJS) $(RESFILE) $(LDFLAGS) $(WRAP_LDFLAGS) $(SHARED_LIBRARY_LIBS) $(EXTRA_DSO_LDOPTS) $(MOZ_GLUE_LDFLAGS) $(EXTRA_LIBS) $(OS_LIBS) $(SHLIB_LDENDFILE) $(if $(LIB_IS_C_ONLY),,$(STLPORT_LIBS))</span>
<a href="#l5.904"></a><span id="l5.904" class="difflineplus">+	$(EXPAND_MKSHLIB) $(SHLIB_LDSTARTFILE) $(OBJS) $(SUB_SHLOBJS) $(RESFILE) $(LDFLAGS) $(WRAP_LDFLAGS) $(STATIC_LIBS) $(SHARED_LIBS) $(EXTRA_DSO_LDOPTS) $(MOZ_GLUE_LDFLAGS) $(EXTRA_LIBS) $(OS_LIBS) $(SHLIB_LDENDFILE) $(if $(LIB_IS_C_ONLY),,$(STLPORT_LIBS))</span>
<a href="#l5.905"></a><span id="l5.905"> endif # DTRACE_LIB_DEPENDENT</span>
<a href="#l5.906"></a><span id="l5.906"> </span>
<a href="#l5.907"></a><span id="l5.907"> ifeq (_WINNT,$(GNU_CC)_$(OS_ARCH))</span>
<a href="#l5.908"></a><span id="l5.908"> ifdef MSMANIFEST_TOOL</span>
<a href="#l5.909"></a><span id="l5.909"> ifdef EMBED_MANIFEST_AT</span>
<a href="#l5.910"></a><span id="l5.910"> 	@if test -f $@.manifest; then \</span>
<a href="#l5.911"></a><span id="l5.911"> 		mt.exe -NOLOGO -MANIFEST $@.manifest -OUTPUTRESOURCE:$@\;$(EMBED_MANIFEST_AT); \</span>
<a href="#l5.912"></a><span id="l5.912"> 		rm -f $@.manifest; \</span>
<a href="#l5.913"></a><span id="l5.913" class="difflineat">@@ -816,17 +870,17 @@ endif   # EMBED_MANIFEST_AT</span>
<a href="#l5.914"></a><span id="l5.914"> endif	# MSVC with manifest tool</span>
<a href="#l5.915"></a><span id="l5.915"> ifdef MOZ_PROFILE_GENERATE</span>
<a href="#l5.916"></a><span id="l5.916"> 	touch -t `date +%Y%m%d%H%M.%S -d 'now+5seconds'` pgo.relink</span>
<a href="#l5.917"></a><span id="l5.917"> endif</span>
<a href="#l5.918"></a><span id="l5.918"> endif	# WINNT &amp;&amp; !GCC</span>
<a href="#l5.919"></a><span id="l5.919"> 	@$(RM) foodummyfilefoo $(DELETE_AFTER_LINK)</span>
<a href="#l5.920"></a><span id="l5.920"> 	chmod +x $@</span>
<a href="#l5.921"></a><span id="l5.921"> ifdef ENABLE_STRIP</span>
<a href="#l5.922"></a><span id="l5.922" class="difflineminus">-	$(STRIP) $@</span>
<a href="#l5.923"></a><span id="l5.923" class="difflineplus">+	$(STRIP) $(STRIP_FLAGS) $@</span>
<a href="#l5.924"></a><span id="l5.924"> endif</span>
<a href="#l5.925"></a><span id="l5.925"> ifdef MOZ_POST_DSO_LIB_COMMAND</span>
<a href="#l5.926"></a><span id="l5.926"> 	$(MOZ_POST_DSO_LIB_COMMAND) $@</span>
<a href="#l5.927"></a><span id="l5.927"> endif</span>
<a href="#l5.928"></a><span id="l5.928"> </span>
<a href="#l5.929"></a><span id="l5.929"> ifeq ($(SOLARIS_SUNPRO_CC),1)</span>
<a href="#l5.930"></a><span id="l5.930"> _MDDEPFILE = $(MDDEPDIR)/$(@F).pp</span>
<a href="#l5.931"></a><span id="l5.931"> </span>
<a href="#l5.932"></a><span id="l5.932" class="difflineat">@@ -841,145 +895,234 @@ define MAKE_DEPS_AUTO_CXX</span>
<a href="#l5.933"></a><span id="l5.933"> if test -d $(@D); then \</span>
<a href="#l5.934"></a><span id="l5.934"> 	echo 'Building deps for $&lt; using Sun Studio CC'; \</span>
<a href="#l5.935"></a><span id="l5.935"> 	$(CXX) $(COMPILE_CXXFLAGS) -xM $&lt; &gt;$(_MDDEPFILE) ; \</span>
<a href="#l5.936"></a><span id="l5.936"> 	$(PYTHON) $(MOZILLA_DIR)/build/unix/add_phony_targets.py $(_MDDEPFILE) ; \</span>
<a href="#l5.937"></a><span id="l5.937"> fi</span>
<a href="#l5.938"></a><span id="l5.938"> endef</span>
<a href="#l5.939"></a><span id="l5.939"> endif # Sun Studio on Solaris</span>
<a href="#l5.940"></a><span id="l5.940"> </span>
<a href="#l5.941"></a><span id="l5.941" class="difflineplus">+# The object file is in the current directory, and the source file can be any</span>
<a href="#l5.942"></a><span id="l5.942" class="difflineplus">+# relative path. This macro adds the dependency obj: src for each source file.</span>
<a href="#l5.943"></a><span id="l5.943" class="difflineplus">+# This dependency must be first for the $&lt; flag to work correctly, and the</span>
<a href="#l5.944"></a><span id="l5.944" class="difflineplus">+# rules that have commands for these targets must not list any other</span>
<a href="#l5.945"></a><span id="l5.945" class="difflineplus">+# prerequisites, or they will override the $&lt; variable.</span>
<a href="#l5.946"></a><span id="l5.946" class="difflineplus">+define src_objdep</span>
<a href="#l5.947"></a><span id="l5.947" class="difflineplus">+$(basename $2$(notdir $1)).$(OBJ_SUFFIX): $1 $$(call mkdir_deps,$$(MDDEPDIR))</span>
<a href="#l5.948"></a><span id="l5.948" class="difflineplus">+endef</span>
<a href="#l5.949"></a><span id="l5.949" class="difflineplus">+$(foreach f,$(CSRCS) $(SSRCS) $(CPPSRCS) $(CMSRCS) $(CMMSRCS) $(ASFILES),$(eval $(call src_objdep,$(f))))</span>
<a href="#l5.950"></a><span id="l5.950" class="difflineplus">+$(foreach f,$(HOST_CSRCS) $(HOST_CPPSRCS) $(HOST_CMSRCS) $(HOST_CMMSRCS),$(eval $(call src_objdep,$(f),host_)))</span>
<a href="#l5.951"></a><span id="l5.951" class="difflineplus">+</span>
<a href="#l5.952"></a><span id="l5.952" class="difflineplus">+$(OBJS) $(HOST_OBJS) $(PROGOBJS) $(HOST_PROGOBJS): $(GLOBAL_DEPS)</span>
<a href="#l5.953"></a><span id="l5.953" class="difflineplus">+</span>
<a href="#l5.954"></a><span id="l5.954"> # Rules for building native targets must come first because of the host_ prefix</span>
<a href="#l5.955"></a><span id="l5.955" class="difflineminus">-host_%.$(OBJ_SUFFIX): %.c $(GLOBAL_DEPS)</span>
<a href="#l5.956"></a><span id="l5.956" class="difflineplus">+$(HOST_COBJS):</span>
<a href="#l5.957"></a><span id="l5.957"> 	$(REPORT_BUILD)</span>
<a href="#l5.958"></a><span id="l5.958"> 	$(ELOG) $(HOST_CC) $(HOST_OUTOPTION)$@ -c $(HOST_CFLAGS) $(INCLUDES) $(NSPR_CFLAGS) $(_VPATH_SRCS)</span>
<a href="#l5.959"></a><span id="l5.959"> </span>
<a href="#l5.960"></a><span id="l5.960" class="difflineminus">-host_%.$(OBJ_SUFFIX): %.cpp $(GLOBAL_DEPS)</span>
<a href="#l5.961"></a><span id="l5.961" class="difflineminus">-	$(REPORT_BUILD)</span>
<a href="#l5.962"></a><span id="l5.962" class="difflineminus">-	$(ELOG) $(HOST_CXX) $(HOST_OUTOPTION)$@ -c $(HOST_CXXFLAGS) $(INCLUDES) $(NSPR_CFLAGS) $(_VPATH_SRCS)</span>
<a href="#l5.963"></a><span id="l5.963" class="difflineminus">-</span>
<a href="#l5.964"></a><span id="l5.964" class="difflineminus">-host_%.$(OBJ_SUFFIX): %.cc $(GLOBAL_DEPS)</span>
<a href="#l5.965"></a><span id="l5.965" class="difflineplus">+$(HOST_CPPOBJS):</span>
<a href="#l5.966"></a><span id="l5.966"> 	$(REPORT_BUILD)</span>
<a href="#l5.967"></a><span id="l5.967"> 	$(ELOG) $(HOST_CXX) $(HOST_OUTOPTION)$@ -c $(HOST_CXXFLAGS) $(INCLUDES) $(NSPR_CFLAGS) $(_VPATH_SRCS)</span>
<a href="#l5.968"></a><span id="l5.968"> </span>
<a href="#l5.969"></a><span id="l5.969" class="difflineminus">-host_%.$(OBJ_SUFFIX): %.m $(GLOBAL_DEPS)</span>
<a href="#l5.970"></a><span id="l5.970" class="difflineplus">+$(HOST_CMOBJS):</span>
<a href="#l5.971"></a><span id="l5.971"> 	$(REPORT_BUILD)</span>
<a href="#l5.972"></a><span id="l5.972"> 	$(ELOG) $(HOST_CC) $(HOST_OUTOPTION)$@ -c $(HOST_CFLAGS) $(HOST_CMFLAGS) $(INCLUDES) $(NSPR_CFLAGS) $(_VPATH_SRCS)</span>
<a href="#l5.973"></a><span id="l5.973"> </span>
<a href="#l5.974"></a><span id="l5.974" class="difflineminus">-host_%.$(OBJ_SUFFIX): %.mm $(GLOBAL_DEPS)</span>
<a href="#l5.975"></a><span id="l5.975" class="difflineplus">+$(HOST_CMMOBJS):</span>
<a href="#l5.976"></a><span id="l5.976"> 	$(REPORT_BUILD)</span>
<a href="#l5.977"></a><span id="l5.977"> 	$(ELOG) $(HOST_CXX) $(HOST_OUTOPTION)$@ -c $(HOST_CXXFLAGS) $(HOST_CMMFLAGS) $(INCLUDES) $(NSPR_CFLAGS) $(_VPATH_SRCS)</span>
<a href="#l5.978"></a><span id="l5.978"> </span>
<a href="#l5.979"></a><span id="l5.979" class="difflineminus">-%:: %.c $(GLOBAL_DEPS)</span>
<a href="#l5.980"></a><span id="l5.980" class="difflineplus">+$(COBJS):</span>
<a href="#l5.981"></a><span id="l5.981"> 	$(REPORT_BUILD)</span>
<a href="#l5.982"></a><span id="l5.982"> 	@$(MAKE_DEPS_AUTO_CC)</span>
<a href="#l5.983"></a><span id="l5.983" class="difflineminus">-	$(ELOG) $(CC) $(CFLAGS) $(LDFLAGS) $(OUTOPTION)$@ $(_VPATH_SRCS)</span>
<a href="#l5.984"></a><span id="l5.984" class="difflineplus">+	$(ELOG) $(CC) $(OUTOPTION)$@ -c $(COMPILE_CFLAGS) $($(notdir $&lt;)_FLAGS) $(TARGET_LOCAL_INCLUDES) $(_VPATH_SRCS)</span>
<a href="#l5.985"></a><span id="l5.985"> </span>
<a href="#l5.986"></a><span id="l5.986" class="difflineminus">-%.$(OBJ_SUFFIX): %.c $(GLOBAL_DEPS)</span>
<a href="#l5.987"></a><span id="l5.987" class="difflineplus">+# DEFINES and ACDEFINES are needed here to enable conditional compilation of Q_OBJECTs:</span>
<a href="#l5.988"></a><span id="l5.988" class="difflineplus">+# 'moc' only knows about #defines it gets on the command line (-D...), not in</span>
<a href="#l5.989"></a><span id="l5.989" class="difflineplus">+# included headers like mozilla-config.h</span>
<a href="#l5.990"></a><span id="l5.990" class="difflineplus">+$(filter moc_%.cpp,$(CPPSRCS)): moc_%.cpp: %.h</span>
<a href="#l5.991"></a><span id="l5.991"> 	$(REPORT_BUILD)</span>
<a href="#l5.992"></a><span id="l5.992" class="difflineminus">-	@$(MAKE_DEPS_AUTO_CC)</span>
<a href="#l5.993"></a><span id="l5.993" class="difflineminus">-	$(ELOG) $(CC) $(OUTOPTION)$@ -c $(COMPILE_CFLAGS) $(_VPATH_SRCS)</span>
<a href="#l5.994"></a><span id="l5.994" class="difflineplus">+	$(ELOG) $(MOC) $(DEFINES) $(ACDEFINES) $&lt; $(OUTOPTION)$@</span>
<a href="#l5.995"></a><span id="l5.995" class="difflineplus">+</span>
<a href="#l5.996"></a><span id="l5.996" class="difflineplus">+$(filter moc_%.cc,$(CPPSRCS)): moc_%.cc: %.cc</span>
<a href="#l5.997"></a><span id="l5.997" class="difflineplus">+	$(REPORT_BUILD)</span>
<a href="#l5.998"></a><span id="l5.998" class="difflineplus">+	$(ELOG) $(MOC) $(DEFINES) $(ACDEFINES) $(_VPATH_SRCS:.cc=.h) $(OUTOPTION)$@</span>
<a href="#l5.999"></a><span id="l5.999" class="difflineplus">+</span>
<a href="#l5.1000"></a><span id="l5.1000" class="difflineplus">+$(filter qrc_%.cpp,$(CPPSRCS)): qrc_%.cpp: %.qrc</span>
<a href="#l5.1001"></a><span id="l5.1001" class="difflineplus">+	$(REPORT_BUILD)</span>
<a href="#l5.1002"></a><span id="l5.1002" class="difflineplus">+	$(ELOG) $(RCC) -name $* $&lt; $(OUTOPTION)$@</span>
<a href="#l5.1003"></a><span id="l5.1003"> </span>
<a href="#l5.1004"></a><span id="l5.1004"> ifdef ASFILES</span>
<a href="#l5.1005"></a><span id="l5.1005"> # The AS_DASH_C_FLAG is needed cause not all assemblers (Solaris) accept</span>
<a href="#l5.1006"></a><span id="l5.1006"> # a '-c' flag.</span>
<a href="#l5.1007"></a><span id="l5.1007" class="difflineminus">-%.$(OBJ_SUFFIX): %.$(ASM_SUFFIX) $(GLOBAL_DEPS)</span>
<a href="#l5.1008"></a><span id="l5.1008" class="difflineminus">-	$(AS) -o $@ $(ASFLAGS) $(AS_DASH_C_FLAG) $(_VPATH_SRCS)</span>
<a href="#l5.1009"></a><span id="l5.1009" class="difflineplus">+$(ASOBJS):</span>
<a href="#l5.1010"></a><span id="l5.1010" class="difflineplus">+	$(REPORT_BUILD)</span>
<a href="#l5.1011"></a><span id="l5.1011" class="difflineplus">+	$(AS) $(ASOUTOPTION)$@ $(ASFLAGS) $($(notdir $&lt;)_FLAGS) $(AS_DASH_C_FLAG) $(_VPATH_SRCS)</span>
<a href="#l5.1012"></a><span id="l5.1012"> endif</span>
<a href="#l5.1013"></a><span id="l5.1013"> </span>
<a href="#l5.1014"></a><span id="l5.1014" class="difflineminus">-%.$(OBJ_SUFFIX): %.S $(GLOBAL_DEPS)</span>
<a href="#l5.1015"></a><span id="l5.1015" class="difflineminus">-	$(AS) -o $@ $(ASFLAGS) -c $&lt;</span>
<a href="#l5.1016"></a><span id="l5.1016" class="difflineplus">+$(SOBJS):</span>
<a href="#l5.1017"></a><span id="l5.1017" class="difflineplus">+	$(REPORT_BUILD)</span>
<a href="#l5.1018"></a><span id="l5.1018" class="difflineplus">+	$(AS) -o $@ $(ASFLAGS) $($(notdir $&lt;)_FLAGS) $(LOCAL_INCLUDES) $(TARGET_LOCAL_INCLUDES) -c $&lt;</span>
<a href="#l5.1019"></a><span id="l5.1019"> </span>
<a href="#l5.1020"></a><span id="l5.1020" class="difflineminus">-%:: %.cpp $(GLOBAL_DEPS)</span>
<a href="#l5.1021"></a><span id="l5.1021" class="difflineminus">-	@$(MAKE_DEPS_AUTO_CXX)</span>
<a href="#l5.1022"></a><span id="l5.1022" class="difflineminus">-	$(CCC) $(OUTOPTION)$@ $(CXXFLAGS) $(_VPATH_SRCS) $(LDFLAGS)</span>
<a href="#l5.1023"></a><span id="l5.1023" class="difflineminus">-</span>
<a href="#l5.1024"></a><span id="l5.1024" class="difflineminus">-#</span>
<a href="#l5.1025"></a><span id="l5.1025" class="difflineminus">-# Please keep the next two rules in sync.</span>
<a href="#l5.1026"></a><span id="l5.1026" class="difflineminus">-#</span>
<a href="#l5.1027"></a><span id="l5.1027" class="difflineminus">-%.$(OBJ_SUFFIX): %.cc $(GLOBAL_DEPS)</span>
<a href="#l5.1028"></a><span id="l5.1028" class="difflineplus">+$(CPPOBJS):</span>
<a href="#l5.1029"></a><span id="l5.1029"> 	$(REPORT_BUILD)</span>
<a href="#l5.1030"></a><span id="l5.1030"> 	@$(MAKE_DEPS_AUTO_CXX)</span>
<a href="#l5.1031"></a><span id="l5.1031" class="difflineminus">-	$(ELOG) $(CCC) $(OUTOPTION)$@ -c $(COMPILE_CXXFLAGS) $(_VPATH_SRCS)</span>
<a href="#l5.1032"></a><span id="l5.1032" class="difflineplus">+	$(ELOG) $(CCC) $(OUTOPTION)$@ -c $(COMPILE_CXXFLAGS) $($(notdir $&lt;)_FLAGS) $(TARGET_LOCAL_INCLUDES) $(_VPATH_SRCS)</span>
<a href="#l5.1033"></a><span id="l5.1033"> </span>
<a href="#l5.1034"></a><span id="l5.1034" class="difflineminus">-%.$(OBJ_SUFFIX): %.cpp $(GLOBAL_DEPS)</span>
<a href="#l5.1035"></a><span id="l5.1035" class="difflineplus">+$(CMMOBJS):</span>
<a href="#l5.1036"></a><span id="l5.1036"> 	$(REPORT_BUILD)</span>
<a href="#l5.1037"></a><span id="l5.1037"> 	@$(MAKE_DEPS_AUTO_CXX)</span>
<a href="#l5.1038"></a><span id="l5.1038" class="difflineminus">-ifdef STRICT_CPLUSPLUS_SUFFIX</span>
<a href="#l5.1039"></a><span id="l5.1039" class="difflineminus">-	echo &quot;#line 1 \&quot;$*.cpp\&quot;&quot; | cat - $*.cpp &gt; t_$*.cc</span>
<a href="#l5.1040"></a><span id="l5.1040" class="difflineminus">-	$(ELOG) $(CCC) -o $@ -c $(COMPILE_CXXFLAGS) t_$*.cc</span>
<a href="#l5.1041"></a><span id="l5.1041" class="difflineminus">-	$(RM) t_$*.cc</span>
<a href="#l5.1042"></a><span id="l5.1042" class="difflineminus">-else</span>
<a href="#l5.1043"></a><span id="l5.1043" class="difflineminus">-	$(ELOG) $(CCC) $(OUTOPTION)$@ -c $(COMPILE_CXXFLAGS) $(_VPATH_SRCS)</span>
<a href="#l5.1044"></a><span id="l5.1044" class="difflineminus">-endif #STRICT_CPLUSPLUS_SUFFIX</span>
<a href="#l5.1045"></a><span id="l5.1045" class="difflineplus">+	$(ELOG) $(CCC) -o $@ -c $(COMPILE_CXXFLAGS) $(COMPILE_CMMFLAGS) $($(notdir $&lt;)_FLAGS) $(TARGET_LOCAL_INCLUDES) $(_VPATH_SRCS)</span>
<a href="#l5.1046"></a><span id="l5.1046"> </span>
<a href="#l5.1047"></a><span id="l5.1047" class="difflineminus">-$(OBJ_PREFIX)%.$(OBJ_SUFFIX): %.mm $(GLOBAL_DEPS)</span>
<a href="#l5.1048"></a><span id="l5.1048" class="difflineminus">-	$(REPORT_BUILD)</span>
<a href="#l5.1049"></a><span id="l5.1049" class="difflineminus">-	@$(MAKE_DEPS_AUTO_CXX)</span>
<a href="#l5.1050"></a><span id="l5.1050" class="difflineminus">-	$(ELOG) $(CCC) -o $@ -c $(COMPILE_CXXFLAGS) $(COMPILE_CMMFLAGS) $(_VPATH_SRCS)</span>
<a href="#l5.1051"></a><span id="l5.1051" class="difflineminus">-</span>
<a href="#l5.1052"></a><span id="l5.1052" class="difflineminus">-$(OBJ_PREFIX)%.$(OBJ_SUFFIX): %.m $(GLOBAL_DEPS)</span>
<a href="#l5.1053"></a><span id="l5.1053" class="difflineplus">+$(CMOBJS):</span>
<a href="#l5.1054"></a><span id="l5.1054"> 	$(REPORT_BUILD)</span>
<a href="#l5.1055"></a><span id="l5.1055"> 	@$(MAKE_DEPS_AUTO_CC)</span>
<a href="#l5.1056"></a><span id="l5.1056" class="difflineminus">-	$(ELOG) $(CC) -o $@ -c $(COMPILE_CFLAGS) $(COMPILE_CMFLAGS) $(_VPATH_SRCS)</span>
<a href="#l5.1057"></a><span id="l5.1057" class="difflineplus">+	$(ELOG) $(CC) -o $@ -c $(COMPILE_CFLAGS) $(COMPILE_CMFLAGS) $($(notdir $&lt;)_FLAGS) $(TARGET_LOCAL_INCLUDES) $(_VPATH_SRCS)</span>
<a href="#l5.1058"></a><span id="l5.1058" class="difflineplus">+</span>
<a href="#l5.1059"></a><span id="l5.1059" class="difflineplus">+$(filter %.s,$(CPPSRCS:%.cpp=%.s)): %.s: %.cpp $(call mkdir_deps,$(MDDEPDIR))</span>
<a href="#l5.1060"></a><span id="l5.1060" class="difflineplus">+	$(REPORT_BUILD)</span>
<a href="#l5.1061"></a><span id="l5.1061" class="difflineplus">+	$(CCC) -S $(COMPILE_CXXFLAGS) $($(notdir $&lt;)_FLAGS) $(TARGET_LOCAL_INCLUDES) $(_VPATH_SRCS)</span>
<a href="#l5.1062"></a><span id="l5.1062"> </span>
<a href="#l5.1063"></a><span id="l5.1063" class="difflineminus">-%.s: %.cpp</span>
<a href="#l5.1064"></a><span id="l5.1064" class="difflineminus">-	$(CCC) -S $(COMPILE_CXXFLAGS) $(_VPATH_SRCS)</span>
<a href="#l5.1065"></a><span id="l5.1065" class="difflineplus">+$(filter %.s,$(CPPSRCS:%.cc=%.s)): %.s: %.cc $(call mkdir_deps,$(MDDEPDIR))</span>
<a href="#l5.1066"></a><span id="l5.1066" class="difflineplus">+	$(REPORT_BUILD)</span>
<a href="#l5.1067"></a><span id="l5.1067" class="difflineplus">+	$(CCC) -S $(COMPILE_CXXFLAGS) $($(notdir $&lt;)_FLAGS) $(TARGET_LOCAL_INCLUDES) $(_VPATH_SRCS)</span>
<a href="#l5.1068"></a><span id="l5.1068" class="difflineplus">+</span>
<a href="#l5.1069"></a><span id="l5.1069" class="difflineplus">+$(filter %.s,$(CPPSRCS:%.cxx=%.s)): %.s: %.cpp $(call mkdir_deps,$(MDDEPDIR))</span>
<a href="#l5.1070"></a><span id="l5.1070" class="difflineplus">+	$(REPORT_BUILD)</span>
<a href="#l5.1071"></a><span id="l5.1071" class="difflineplus">+	$(CCC) -S $(COMPILE_CXXFLAGS) $($(notdir $&lt;)_FLAGS) $(TARGET_LOCAL_INCLUDES) $(_VPATH_SRCS)</span>
<a href="#l5.1072"></a><span id="l5.1072" class="difflineplus">+</span>
<a href="#l5.1073"></a><span id="l5.1073" class="difflineplus">+$(filter %.s,$(CSRCS:%.c=%.s)): %.s: %.c $(call mkdir_deps,$(MDDEPDIR))</span>
<a href="#l5.1074"></a><span id="l5.1074" class="difflineplus">+	$(REPORT_BUILD)</span>
<a href="#l5.1075"></a><span id="l5.1075" class="difflineplus">+	$(CC) -S $(COMPILE_CFLAGS) $($(notdir $&lt;)_FLAGS) $(TARGET_LOCAL_INCLUDES) $(_VPATH_SRCS)</span>
<a href="#l5.1076"></a><span id="l5.1076"> </span>
<a href="#l5.1077"></a><span id="l5.1077" class="difflineminus">-%.s: %.cc</span>
<a href="#l5.1078"></a><span id="l5.1078" class="difflineminus">-	$(CCC) -S $(COMPILE_CXXFLAGS) $(_VPATH_SRCS)</span>
<a href="#l5.1079"></a><span id="l5.1079" class="difflineplus">+ifneq (,$(filter %.i,$(MAKECMDGOALS)))</span>
<a href="#l5.1080"></a><span id="l5.1080" class="difflineplus">+# Call as $(call _group_srcs,extension,$(SRCS)) - this will create a list</span>
<a href="#l5.1081"></a><span id="l5.1081" class="difflineplus">+# of the full sources, as well as the $(notdir) version. So:</span>
<a href="#l5.1082"></a><span id="l5.1082" class="difflineplus">+#   foo.cpp sub/bar.cpp</span>
<a href="#l5.1083"></a><span id="l5.1083" class="difflineplus">+# becomes:</span>
<a href="#l5.1084"></a><span id="l5.1084" class="difflineplus">+#   foo.cpp sub/bar.cpp bar.cpp</span>
<a href="#l5.1085"></a><span id="l5.1085" class="difflineplus">+#</span>
<a href="#l5.1086"></a><span id="l5.1086" class="difflineplus">+# This way we can match both 'make sub/bar.i' and 'make bar.i'</span>
<a href="#l5.1087"></a><span id="l5.1087" class="difflineplus">+_group_srcs = $(sort $(patsubst %.$1,%.i,$(filter %.$1,$2 $(notdir $2))))</span>
<a href="#l5.1088"></a><span id="l5.1088" class="difflineplus">+_PREPROCESSED_CPP_FILES := $(call _group_srcs,cpp,$(CPPSRCS))</span>
<a href="#l5.1089"></a><span id="l5.1089" class="difflineplus">+_PREPROCESSED_CC_FILES := $(call _group_srcs,cc,$(CPPSRCS))</span>
<a href="#l5.1090"></a><span id="l5.1090" class="difflineplus">+_PREPROCESSED_CXX_FILES := $(call _group_srcs,cxx,$(CPPSRCS))</span>
<a href="#l5.1091"></a><span id="l5.1091" class="difflineplus">+_PREPROCESSED_C_FILES := $(call _group_srcs,c,$(CSRCS))</span>
<a href="#l5.1092"></a><span id="l5.1092" class="difflineplus">+_PREPROCESSED_CMM_FILES := $(call _group_srcs,mm,$(CMMSRCS))</span>
<a href="#l5.1093"></a><span id="l5.1093" class="difflineplus">+</span>
<a href="#l5.1094"></a><span id="l5.1094" class="difflineplus">+# Hack up VPATH so we can reach the sources. Eg: 'make Parser.i' may need to</span>
<a href="#l5.1095"></a><span id="l5.1095" class="difflineplus">+# reach $(srcdir)/frontend/Parser.i</span>
<a href="#l5.1096"></a><span id="l5.1096" class="difflineplus">+VPATH += $(addprefix $(srcdir)/,$(sort $(dir $(CPPSRCS) $(CSRCS) $(CMMSRCS))))</span>
<a href="#l5.1097"></a><span id="l5.1097"> </span>
<a href="#l5.1098"></a><span id="l5.1098" class="difflineminus">-%.s: %.c</span>
<a href="#l5.1099"></a><span id="l5.1099" class="difflineminus">-	$(CC) -S $(COMPILE_CFLAGS) $(_VPATH_SRCS)</span>
<a href="#l5.1100"></a><span id="l5.1100" class="difflineplus">+# Make preprocessed files PHONY so they are always executed, since they are</span>
<a href="#l5.1101"></a><span id="l5.1101" class="difflineplus">+# manual targets and we don't necessarily write to $@.</span>
<a href="#l5.1102"></a><span id="l5.1102" class="difflineplus">+.PHONY: $(_PREPROCESSED_CPP_FILES) $(_PREPROCESSED_CC_FILES) $(_PREPROCESSED_CXX_FILES) $(_PREPROCESSED_C_FILES) $(_PREPROCESSED_CMM_FILES)</span>
<a href="#l5.1103"></a><span id="l5.1103" class="difflineplus">+</span>
<a href="#l5.1104"></a><span id="l5.1104" class="difflineplus">+$(_PREPROCESSED_CPP_FILES): %.i: %.cpp $(call mkdir_deps,$(MDDEPDIR))</span>
<a href="#l5.1105"></a><span id="l5.1105" class="difflineplus">+	$(REPORT_BUILD)</span>
<a href="#l5.1106"></a><span id="l5.1106" class="difflineplus">+	$(addprefix $(MKDIR) -p ,$(filter-out .,$(@D)))</span>
<a href="#l5.1107"></a><span id="l5.1107" class="difflineplus">+	$(CCC) -C $(PREPROCESS_OPTION)$@ $(COMPILE_CXXFLAGS) $($(notdir $&lt;)_FLAGS) $(TARGET_LOCAL_INCLUDES) $(_VPATH_SRCS)</span>
<a href="#l5.1108"></a><span id="l5.1108" class="difflineplus">+</span>
<a href="#l5.1109"></a><span id="l5.1109" class="difflineplus">+$(_PREPROCESSED_CC_FILES): %.i: %.cc $(call mkdir_deps,$(MDDEPDIR))</span>
<a href="#l5.1110"></a><span id="l5.1110" class="difflineplus">+	$(REPORT_BUILD)</span>
<a href="#l5.1111"></a><span id="l5.1111" class="difflineplus">+	$(addprefix $(MKDIR) -p ,$(filter-out .,$(@D)))</span>
<a href="#l5.1112"></a><span id="l5.1112" class="difflineplus">+	$(CCC) -C $(PREPROCESS_OPTION)$@ $(COMPILE_CXXFLAGS) $($(notdir $&lt;)_FLAGS) $(TARGET_LOCAL_INCLUDES) $(_VPATH_SRCS)</span>
<a href="#l5.1113"></a><span id="l5.1113" class="difflineplus">+</span>
<a href="#l5.1114"></a><span id="l5.1114" class="difflineplus">+$(_PREPROCESSED_CXX_FILES): %.i: %.cxx $(call mkdir_deps,$(MDDEPDIR))</span>
<a href="#l5.1115"></a><span id="l5.1115" class="difflineplus">+	$(REPORT_BUILD)</span>
<a href="#l5.1116"></a><span id="l5.1116" class="difflineplus">+	$(addprefix $(MKDIR) -p ,$(filter-out .,$(@D)))</span>
<a href="#l5.1117"></a><span id="l5.1117" class="difflineplus">+	$(CCC) -C $(PREPROCESS_OPTION)$@ $(COMPILE_CXXFLAGS) $($(notdir $&lt;)_FLAGS) $(TARGET_LOCAL_INCLUDES) $(_VPATH_SRCS)</span>
<a href="#l5.1118"></a><span id="l5.1118"> </span>
<a href="#l5.1119"></a><span id="l5.1119" class="difflineminus">-%.i: %.cpp</span>
<a href="#l5.1120"></a><span id="l5.1120" class="difflineminus">-	$(CCC) -C -E $(COMPILE_CXXFLAGS) $(_VPATH_SRCS) &gt; $*.i</span>
<a href="#l5.1121"></a><span id="l5.1121" class="difflineplus">+$(_PREPROCESSED_C_FILES): %.i: %.c $(call mkdir_deps,$(MDDEPDIR))</span>
<a href="#l5.1122"></a><span id="l5.1122" class="difflineplus">+	$(REPORT_BUILD)</span>
<a href="#l5.1123"></a><span id="l5.1123" class="difflineplus">+	$(addprefix $(MKDIR) -p ,$(filter-out .,$(@D)))</span>
<a href="#l5.1124"></a><span id="l5.1124" class="difflineplus">+	$(CC) -C $(PREPROCESS_OPTION)$@ $(COMPILE_CFLAGS) $($(notdir $&lt;)_FLAGS) $(TARGET_LOCAL_INCLUDES) $(_VPATH_SRCS)</span>
<a href="#l5.1125"></a><span id="l5.1125" class="difflineplus">+</span>
<a href="#l5.1126"></a><span id="l5.1126" class="difflineplus">+$(_PREPROCESSED_CMM_FILES): %.i: %.mm $(call mkdir_deps,$(MDDEPDIR))</span>
<a href="#l5.1127"></a><span id="l5.1127" class="difflineplus">+	$(REPORT_BUILD)</span>
<a href="#l5.1128"></a><span id="l5.1128" class="difflineplus">+	$(addprefix $(MKDIR) -p ,$(filter-out .,$(@D)))</span>
<a href="#l5.1129"></a><span id="l5.1129" class="difflineplus">+	$(CCC) -C $(PREPROCESS_OPTION)$@ $(COMPILE_CXXFLAGS) $(COMPILE_CMMFLAGS) $($(notdir $&lt;)_FLAGS) $(TARGET_LOCAL_INCLUDES) $(_VPATH_SRCS)</span>
<a href="#l5.1130"></a><span id="l5.1130" class="difflineplus">+</span>
<a href="#l5.1131"></a><span id="l5.1131" class="difflineplus">+# Default to pre-processing the actual unified file. This can be overridden</span>
<a href="#l5.1132"></a><span id="l5.1132" class="difflineplus">+# at the command-line to pre-process only the individual source file.</span>
<a href="#l5.1133"></a><span id="l5.1133" class="difflineplus">+PP_UNIFIED ?= 1</span>
<a href="#l5.1134"></a><span id="l5.1134"> </span>
<a href="#l5.1135"></a><span id="l5.1135" class="difflineminus">-%.i: %.cc</span>
<a href="#l5.1136"></a><span id="l5.1136" class="difflineminus">-	$(CCC) -C -E $(COMPILE_CXXFLAGS) $(_VPATH_SRCS) &gt; $*.i</span>
<a href="#l5.1137"></a><span id="l5.1137" class="difflineplus">+# PP_REINVOKE gets set on the sub-make to prevent us from going in an</span>
<a href="#l5.1138"></a><span id="l5.1138" class="difflineplus">+# infinite loop if the filename doesn't exist in the unified source files.</span>
<a href="#l5.1139"></a><span id="l5.1139" class="difflineplus">+ifndef PP_REINVOKE</span>
<a href="#l5.1140"></a><span id="l5.1140" class="difflineplus">+</span>
<a href="#l5.1141"></a><span id="l5.1141" class="difflineplus">+MATCH_cpp = \(cpp\|cc|cxx\)</span>
<a href="#l5.1142"></a><span id="l5.1142" class="difflineplus">+UPPER_c = C</span>
<a href="#l5.1143"></a><span id="l5.1143" class="difflineplus">+UPPER_cpp = CPP</span>
<a href="#l5.1144"></a><span id="l5.1144" class="difflineplus">+UPPER_mm = CMM</span>
<a href="#l5.1145"></a><span id="l5.1145" class="difflineplus">+</span>
<a href="#l5.1146"></a><span id="l5.1146" class="difflineplus">+# When building with PP_UNIFIED=0, we also have to look in the Unified files to</span>
<a href="#l5.1147"></a><span id="l5.1147" class="difflineplus">+# find a matching pathname.</span>
<a href="#l5.1148"></a><span id="l5.1148" class="difflineplus">+_get_all_sources = $1 $(if $(filter Unified%,$1),$(shell sed -n 's/\#include &quot;\(.*\)&quot;$$/\1/p' $(filter Unified%,$1)))</span>
<a href="#l5.1149"></a><span id="l5.1149" class="difflineplus">+all_cpp_sources := $(call _get_all_sources,$(CPPSRCS))</span>
<a href="#l5.1150"></a><span id="l5.1150" class="difflineplus">+all_mm_sources := $(call _get_all_sources,$(CMMSRCS))</span>
<a href="#l5.1151"></a><span id="l5.1151" class="difflineplus">+all_c_sources := $(call _get_all_sources,$(CSRCS))</span>
<a href="#l5.1152"></a><span id="l5.1152" class="difflineplus">+all_sources := $(all_cpp_sources) $(all_cmm_sources) $(all_c_sources)</span>
<a href="#l5.1153"></a><span id="l5.1153"> </span>
<a href="#l5.1154"></a><span id="l5.1154" class="difflineminus">-%.i: %.c</span>
<a href="#l5.1155"></a><span id="l5.1155" class="difflineminus">-	$(CC) -C -E $(COMPILE_CFLAGS) $(_VPATH_SRCS) &gt; $*.i</span>
<a href="#l5.1156"></a><span id="l5.1156" class="difflineplus">+# The catch-all %.i rule runs when we pass in a .i filename that doesn't match</span>
<a href="#l5.1157"></a><span id="l5.1157" class="difflineplus">+# one of the *SRCS variables. The two code paths depend on whether or not</span>
<a href="#l5.1158"></a><span id="l5.1158" class="difflineplus">+# we are requesting a unified file (PP_UNIFIED=1, the default) or not:</span>
<a href="#l5.1159"></a><span id="l5.1159" class="difflineplus">+#</span>
<a href="#l5.1160"></a><span id="l5.1160" class="difflineplus">+# PP_UNIFIED=1:</span>
<a href="#l5.1161"></a><span id="l5.1161" class="difflineplus">+#  - Look for it in any of the Unified files, and re-exec make with</span>
<a href="#l5.1162"></a><span id="l5.1162" class="difflineplus">+#    Unified_foo0.i as the target. This gets us the full unified preprocessed</span>
<a href="#l5.1163"></a><span id="l5.1163" class="difflineplus">+#    file.</span>
<a href="#l5.1164"></a><span id="l5.1164" class="difflineplus">+#</span>
<a href="#l5.1165"></a><span id="l5.1165" class="difflineplus">+# PP_UNIFIED=0:</span>
<a href="#l5.1166"></a><span id="l5.1166" class="difflineplus">+#  - If the .i filename is in *SRCS, or in a Unified filename, then we re-exec</span>
<a href="#l5.1167"></a><span id="l5.1167" class="difflineplus">+#    make with that filename as the target. The *SRCS variables are modified</span>
<a href="#l5.1168"></a><span id="l5.1168" class="difflineplus">+#    to have the Unified sources appended to them so that the static pattern</span>
<a href="#l5.1169"></a><span id="l5.1169" class="difflineplus">+#    rules will match.</span>
<a href="#l5.1170"></a><span id="l5.1170" class="difflineplus">+%.i: FORCE</span>
<a href="#l5.1171"></a><span id="l5.1171" class="difflineplus">+ifeq ($(PP_UNIFIED),1)</span>
<a href="#l5.1172"></a><span id="l5.1172" class="difflineplus">+	@$(MAKE) PP_REINVOKE=1 \</span>
<a href="#l5.1173"></a><span id="l5.1173" class="difflineplus">+	    $(or $(addsuffix .i, \</span>
<a href="#l5.1174"></a><span id="l5.1174" class="difflineplus">+              $(foreach type,c cpp mm, \</span>
<a href="#l5.1175"></a><span id="l5.1175" class="difflineplus">+	        $(if $(filter Unified%,$($(UPPER_$(type))SRCS)), \</span>
<a href="#l5.1176"></a><span id="l5.1176" class="difflineplus">+	          $(shell grep -l '#include &quot;\(.*/\)\?$(basename $@).$(or $(MATCH_$(type)),$(type))&quot;' Unified*.$(type) | sed 's/\.$(type)$$//') \</span>
<a href="#l5.1177"></a><span id="l5.1177" class="difflineplus">+            ))),$(error &quot;File not found for preprocessing: $@&quot;))</span>
<a href="#l5.1178"></a><span id="l5.1178" class="difflineplus">+else</span>
<a href="#l5.1179"></a><span id="l5.1179" class="difflineplus">+	@$(MAKE) PP_REINVOKE=1 $@ \</span>
<a href="#l5.1180"></a><span id="l5.1180" class="difflineplus">+	    $(foreach type,c cpp mm,$(UPPER_$(type))SRCS=&quot;$(all_$(type)_sources)&quot;)</span>
<a href="#l5.1181"></a><span id="l5.1181" class="difflineplus">+endif</span>
<a href="#l5.1182"></a><span id="l5.1182"> </span>
<a href="#l5.1183"></a><span id="l5.1183" class="difflineminus">-%.i: %.mm</span>
<a href="#l5.1184"></a><span id="l5.1184" class="difflineminus">-	$(CCC) -C -E $(COMPILE_CXXFLAGS) $(COMPILE_CMMFLAGS) $(_VPATH_SRCS) &gt; $*.i</span>
<a href="#l5.1185"></a><span id="l5.1185" class="difflineplus">+endif</span>
<a href="#l5.1186"></a><span id="l5.1186"> </span>
<a href="#l5.1187"></a><span id="l5.1187" class="difflineminus">-%.res: %.rc</span>
<a href="#l5.1188"></a><span id="l5.1188" class="difflineplus">+endif</span>
<a href="#l5.1189"></a><span id="l5.1189" class="difflineplus">+</span>
<a href="#l5.1190"></a><span id="l5.1190" class="difflineplus">+$(RESFILE): %.res: %.rc</span>
<a href="#l5.1191"></a><span id="l5.1191" class="difflineplus">+	$(REPORT_BUILD)</span>
<a href="#l5.1192"></a><span id="l5.1192"> 	@echo Creating Resource file: $@</span>
<a href="#l5.1193"></a><span id="l5.1193"> ifdef GNU_CC</span>
<a href="#l5.1194"></a><span id="l5.1194"> 	$(RC) $(RCFLAGS) $(filter-out -U%,$(DEFINES)) $(INCLUDES:-I%=--include-dir %) $(OUTOPTION)$@ $(_VPATH_SRCS)</span>
<a href="#l5.1195"></a><span id="l5.1195"> else</span>
<a href="#l5.1196"></a><span id="l5.1196"> 	$(RC) $(RCFLAGS) -r $(DEFINES) $(INCLUDES) $(OUTOPTION)$@ $(_VPATH_SRCS)</span>
<a href="#l5.1197"></a><span id="l5.1197"> endif</span>
<a href="#l5.1198"></a><span id="l5.1198"> </span>
<a href="#l5.1199"></a><span id="l5.1199" class="difflineminus">-# need 3 separate lines for OS/2</span>
<a href="#l5.1200"></a><span id="l5.1200" class="difflineminus">-%:: %.pl</span>
<a href="#l5.1201"></a><span id="l5.1201" class="difflineminus">-	$(RM) $@</span>
<a href="#l5.1202"></a><span id="l5.1202" class="difflineminus">-	cp $&lt; $@</span>
<a href="#l5.1203"></a><span id="l5.1203" class="difflineminus">-	chmod +x $@</span>
<a href="#l5.1204"></a><span id="l5.1204" class="difflineplus">+# Cancel GNU make built-in implicit rules</span>
<a href="#l5.1205"></a><span id="l5.1205" class="difflineplus">+MAKEFLAGS += -r</span>
<a href="#l5.1206"></a><span id="l5.1206"> </span>
<a href="#l5.1207"></a><span id="l5.1207" class="difflineminus">-%:: %.sh</span>
<a href="#l5.1208"></a><span id="l5.1208" class="difflineminus">-	$(RM) $@</span>
<a href="#l5.1209"></a><span id="l5.1209" class="difflineminus">-	cp $&lt; $@</span>
<a href="#l5.1210"></a><span id="l5.1210" class="difflineminus">-	chmod +x $@</span>
<a href="#l5.1211"></a><span id="l5.1211" class="difflineplus">+ifneq (,$(filter WINNT,$(OS_ARCH)))</span>
<a href="#l5.1212"></a><span id="l5.1212" class="difflineplus">+SEP := ;</span>
<a href="#l5.1213"></a><span id="l5.1213" class="difflineplus">+else</span>
<a href="#l5.1214"></a><span id="l5.1214" class="difflineplus">+SEP := :</span>
<a href="#l5.1215"></a><span id="l5.1215" class="difflineplus">+endif</span>
<a href="#l5.1216"></a><span id="l5.1216"> </span>
<a href="#l5.1217"></a><span id="l5.1217" class="difflineminus">-# Cancel these implicit rules</span>
<a href="#l5.1218"></a><span id="l5.1218" class="difflineminus">-#</span>
<a href="#l5.1219"></a><span id="l5.1219" class="difflineminus">-%: %,v</span>
<a href="#l5.1220"></a><span id="l5.1220" class="difflineminus">-</span>
<a href="#l5.1221"></a><span id="l5.1221" class="difflineminus">-%: RCS/%,v</span>
<a href="#l5.1222"></a><span id="l5.1222" class="difflineminus">-</span>
<a href="#l5.1223"></a><span id="l5.1223" class="difflineminus">-%: s.%</span>
<a href="#l5.1224"></a><span id="l5.1224" class="difflineminus">-</span>
<a href="#l5.1225"></a><span id="l5.1225" class="difflineminus">-%: SCCS/s.%</span>
<a href="#l5.1226"></a><span id="l5.1226" class="difflineplus">+EMPTY :=</span>
<a href="#l5.1227"></a><span id="l5.1227" class="difflineplus">+SPACE := $(EMPTY) $(EMPTY)</span>
<a href="#l5.1228"></a><span id="l5.1228"> </span>
<a href="#l5.1229"></a><span id="l5.1229"> # MSYS has its own special path form, but javac expects the source and class</span>
<a href="#l5.1230"></a><span id="l5.1230"> # paths to be in the DOS form (i.e. e:/builds/...).  This function does the</span>
<a href="#l5.1231"></a><span id="l5.1231"> # appropriate conversion on Windows, but is a noop on other systems.</span>
<a href="#l5.1232"></a><span id="l5.1232"> ifeq ($(HOST_OS_ARCH),WINNT)</span>
<a href="#l5.1233"></a><span id="l5.1233" class="difflineminus">-# assume MSYS</span>
<a href="#l5.1234"></a><span id="l5.1234"> #  We use 'pwd -W' to get DOS form of the path.  However, since the given path</span>
<a href="#l5.1235"></a><span id="l5.1235"> #  could be a file or a non-existent path, we cannot call 'pwd -W' directly</span>
<a href="#l5.1236"></a><span id="l5.1236"> #  on the path.  Instead, we extract the root path (i.e. &quot;c:/&quot;), call 'pwd -W'</span>
<a href="#l5.1237"></a><span id="l5.1237"> #  on it, then merge with the rest of the path.</span>
<a href="#l5.1238"></a><span id="l5.1238"> root-path = $(shell echo $(1) | sed -e 's|\(/[^/]*\)/\?\(.*\)|\1|')</span>
<a href="#l5.1239"></a><span id="l5.1239"> non-root-path = $(shell echo $(1) | sed -e 's|\(/[^/]*\)/\?\(.*\)|\2|')</span>
<a href="#l5.1240"></a><span id="l5.1240"> normalizepath = $(foreach p,$(1),$(if $(filter /%,$(1)),$(patsubst %/,%,$(shell cd $(call root-path,$(1)) &amp;&amp; pwd -W))/$(call non-root-path,$(1)),$(1)))</span>
<a href="#l5.1241"></a><span id="l5.1241"> else</span>
<a href="#l5.1242"></a><span id="l5.1242" class="difflineat">@@ -1009,102 +1152,59 @@ backend.mk: $(BACKEND_INPUT_FILES)</span>
<a href="#l5.1243"></a><span id="l5.1243"> endif</span>
<a href="#l5.1244"></a><span id="l5.1244"> </span>
<a href="#l5.1245"></a><span id="l5.1245"> endif # MOZBUILD_DERIVED</span>
<a href="#l5.1246"></a><span id="l5.1246"> </span>
<a href="#l5.1247"></a><span id="l5.1247"> ###############################################################################</span>
<a href="#l5.1248"></a><span id="l5.1248"> # Bunch of things that extend the 'export' rule (in order):</span>
<a href="#l5.1249"></a><span id="l5.1249"> ###############################################################################</span>
<a href="#l5.1250"></a><span id="l5.1250"> </span>
<a href="#l5.1251"></a><span id="l5.1251" class="difflineminus">-################################################################################</span>
<a href="#l5.1252"></a><span id="l5.1252" class="difflineminus">-# Copy each element of EXPORTS to $(DIST)/include</span>
<a href="#l5.1253"></a><span id="l5.1253" class="difflineminus">-</span>
<a href="#l5.1254"></a><span id="l5.1254"> ifneq ($(XPI_NAME),)</span>
<a href="#l5.1255"></a><span id="l5.1255"> $(FINAL_TARGET):</span>
<a href="#l5.1256"></a><span id="l5.1256"> 	$(NSINSTALL) -D $@</span>
<a href="#l5.1257"></a><span id="l5.1257"> </span>
<a href="#l5.1258"></a><span id="l5.1258"> export:: $(FINAL_TARGET)</span>
<a href="#l5.1259"></a><span id="l5.1259"> endif</span>
<a href="#l5.1260"></a><span id="l5.1260"> </span>
<a href="#l5.1261"></a><span id="l5.1261" class="difflineminus">-ifndef NO_DIST_INSTALL</span>
<a href="#l5.1262"></a><span id="l5.1262" class="difflineminus">-ifneq (,$(EXPORTS))</span>
<a href="#l5.1263"></a><span id="l5.1263" class="difflineminus">-export:: $(EXPORTS)</span>
<a href="#l5.1264"></a><span id="l5.1264" class="difflineminus">-	$(call install_cmd,$(IFLAGS1) $^ $(DIST)/include)</span>
<a href="#l5.1265"></a><span id="l5.1265" class="difflineminus">-endif</span>
<a href="#l5.1266"></a><span id="l5.1266" class="difflineminus">-endif # NO_DIST_INSTALL</span>
<a href="#l5.1267"></a><span id="l5.1267" class="difflineminus">-</span>
<a href="#l5.1268"></a><span id="l5.1268" class="difflineminus">-define EXPORT_NAMESPACE_RULE</span>
<a href="#l5.1269"></a><span id="l5.1269" class="difflineminus">-ifndef NO_DIST_INSTALL</span>
<a href="#l5.1270"></a><span id="l5.1270" class="difflineminus">-export:: $(EXPORTS_$(namespace))</span>
<a href="#l5.1271"></a><span id="l5.1271" class="difflineminus">-	$(call install_cmd,$(IFLAGS1) $$^ $(DIST)/include/$(namespace))</span>
<a href="#l5.1272"></a><span id="l5.1272" class="difflineminus">-endif # NO_DIST_INSTALL</span>
<a href="#l5.1273"></a><span id="l5.1273" class="difflineminus">-endef</span>
<a href="#l5.1274"></a><span id="l5.1274" class="difflineminus">-</span>
<a href="#l5.1275"></a><span id="l5.1275" class="difflineminus">-$(foreach namespace,$(EXPORTS_NAMESPACES),$(eval $(EXPORT_NAMESPACE_RULE)))</span>
<a href="#l5.1276"></a><span id="l5.1276" class="difflineminus">-</span>
<a href="#l5.1277"></a><span id="l5.1277"> ################################################################################</span>
<a href="#l5.1278"></a><span id="l5.1278"> # Copy each element of PREF_JS_EXPORTS</span>
<a href="#l5.1279"></a><span id="l5.1279"> </span>
<a href="#l5.1280"></a><span id="l5.1280"> # The default location for PREF_JS_EXPORTS is the gre prefs directory.</span>
<a href="#l5.1281"></a><span id="l5.1281"> PREF_DIR = defaults/pref</span>
<a href="#l5.1282"></a><span id="l5.1282"> </span>
<a href="#l5.1283"></a><span id="l5.1283"> # If DIST_SUBDIR is defined it indicates that app and gre dirs are</span>
<a href="#l5.1284"></a><span id="l5.1284"> # different and that we are building app related resources. Hence,</span>
<a href="#l5.1285"></a><span id="l5.1285"> # PREF_DIR should point to the app prefs location.</span>
<a href="#l5.1286"></a><span id="l5.1286"> ifneq (,$(DIST_SUBDIR)$(XPI_NAME)$(LIBXUL_SDK))</span>
<a href="#l5.1287"></a><span id="l5.1287"> PREF_DIR = defaults/preferences</span>
<a href="#l5.1288"></a><span id="l5.1288"> endif</span>
<a href="#l5.1289"></a><span id="l5.1289"> </span>
<a href="#l5.1290"></a><span id="l5.1290" class="difflineminus">-ifneq ($(PREF_JS_EXPORTS),)</span>
<a href="#l5.1291"></a><span id="l5.1291"> # on win32, pref files need CRLF line endings... see bug 206029</span>
<a href="#l5.1292"></a><span id="l5.1292"> ifeq (WINNT,$(OS_ARCH))</span>
<a href="#l5.1293"></a><span id="l5.1293" class="difflineminus">-PREF_PPFLAGS = --line-endings=crlf</span>
<a href="#l5.1294"></a><span id="l5.1294" class="difflineplus">+PREF_PPFLAGS += --line-endings=crlf</span>
<a href="#l5.1295"></a><span id="l5.1295"> endif</span>
<a href="#l5.1296"></a><span id="l5.1296"> </span>
<a href="#l5.1297"></a><span id="l5.1297" class="difflineplus">+ifneq ($(PREF_JS_EXPORTS),)</span>
<a href="#l5.1298"></a><span id="l5.1298"> ifndef NO_DIST_INSTALL</span>
<a href="#l5.1299"></a><span id="l5.1299"> PREF_JS_EXPORTS_PATH := $(FINAL_TARGET)/$(PREF_DIR)</span>
<a href="#l5.1300"></a><span id="l5.1300"> PREF_JS_EXPORTS_FLAGS := $(PREF_PPFLAGS)</span>
<a href="#l5.1301"></a><span id="l5.1301"> PP_TARGETS += PREF_JS_EXPORTS</span>
<a href="#l5.1302"></a><span id="l5.1302"> endif</span>
<a href="#l5.1303"></a><span id="l5.1303"> endif</span>
<a href="#l5.1304"></a><span id="l5.1304"> </span>
<a href="#l5.1305"></a><span id="l5.1305"> ################################################################################</span>
<a href="#l5.1306"></a><span id="l5.1306" class="difflineminus">-# Copy testing-only JS modules to appropriate destination.</span>
<a href="#l5.1307"></a><span id="l5.1307" class="difflineminus">-#</span>
<a href="#l5.1308"></a><span id="l5.1308" class="difflineminus">-# For each file defined in TESTING_JS_MODULES, copy it to</span>
<a href="#l5.1309"></a><span id="l5.1309" class="difflineminus">-# objdir/_tests/modules/. If TESTING_JS_MODULE_DIR is defined, that path</span>
<a href="#l5.1310"></a><span id="l5.1310" class="difflineminus">-# wlll be appended to the output directory.</span>
<a href="#l5.1311"></a><span id="l5.1311" class="difflineminus">-</span>
<a href="#l5.1312"></a><span id="l5.1312" class="difflineminus">-ifdef ENABLE_TESTS</span>
<a href="#l5.1313"></a><span id="l5.1313" class="difflineminus">-ifdef TESTING_JS_MODULES</span>
<a href="#l5.1314"></a><span id="l5.1314" class="difflineminus">-testmodulesdir = $(MOZDEPTH)/_tests/modules/$(TESTING_JS_MODULE_DIR)</span>
<a href="#l5.1315"></a><span id="l5.1315" class="difflineminus">-</span>
<a href="#l5.1316"></a><span id="l5.1316" class="difflineminus">-libs::</span>
<a href="#l5.1317"></a><span id="l5.1317" class="difflineminus">-	$(NSINSTALL) -D $(testmodulesdir)</span>
<a href="#l5.1318"></a><span id="l5.1318" class="difflineminus">-</span>
<a href="#l5.1319"></a><span id="l5.1319" class="difflineminus">-libs:: $(TESTING_JS_MODULES)</span>
<a href="#l5.1320"></a><span id="l5.1320" class="difflineminus">-ifndef NO_DIST_INSTALL</span>
<a href="#l5.1321"></a><span id="l5.1321" class="difflineminus">-	$(INSTALL) $(IFLAGS) $^ $(testmodulesdir)</span>
<a href="#l5.1322"></a><span id="l5.1322" class="difflineminus">-endif</span>
<a href="#l5.1323"></a><span id="l5.1323" class="difflineminus">-</span>
<a href="#l5.1324"></a><span id="l5.1324" class="difflineminus">-endif</span>
<a href="#l5.1325"></a><span id="l5.1325" class="difflineminus">-endif</span>
<a href="#l5.1326"></a><span id="l5.1326" class="difflineminus">-</span>
<a href="#l5.1327"></a><span id="l5.1327" class="difflineminus">-################################################################################</span>
<a href="#l5.1328"></a><span id="l5.1328"> # Copy each element of AUTOCFG_JS_EXPORTS to $(FINAL_TARGET)/defaults/autoconfig</span>
<a href="#l5.1329"></a><span id="l5.1329"> </span>
<a href="#l5.1330"></a><span id="l5.1330"> ifneq ($(AUTOCFG_JS_EXPORTS),)</span>
<a href="#l5.1331"></a><span id="l5.1331" class="difflineminus">-$(FINAL_TARGET)/defaults/autoconfig::</span>
<a href="#l5.1332"></a><span id="l5.1332" class="difflineminus">-	$(NSINSTALL) -D $@</span>
<a href="#l5.1333"></a><span id="l5.1333" class="difflineminus">-</span>
<a href="#l5.1334"></a><span id="l5.1334"> ifndef NO_DIST_INSTALL</span>
<a href="#l5.1335"></a><span id="l5.1335" class="difflineminus">-export:: $(AUTOCFG_JS_EXPORTS) $(FINAL_TARGET)/defaults/autoconfig</span>
<a href="#l5.1336"></a><span id="l5.1336" class="difflineminus">-	$(call install_cmd,$(IFLAGS1) $^)</span>
<a href="#l5.1337"></a><span id="l5.1337" class="difflineplus">+AUTOCFG_JS_EXPORTS_FILES := $(AUTOCFG_JS_EXPORTS)</span>
<a href="#l5.1338"></a><span id="l5.1338" class="difflineplus">+AUTOCFG_JS_EXPORTS_DEST := $(FINAL_TARGET)/defaults/autoconfig</span>
<a href="#l5.1339"></a><span id="l5.1339" class="difflineplus">+AUTOCFG_JS_EXPORTS_TARGET := export</span>
<a href="#l5.1340"></a><span id="l5.1340" class="difflineplus">+INSTALL_TARGETS += AUTOCFG_JS_EXPORTS</span>
<a href="#l5.1341"></a><span id="l5.1341"> endif</span>
<a href="#l5.1342"></a><span id="l5.1342" class="difflineminus">-</span>
<a href="#l5.1343"></a><span id="l5.1343"> endif</span>
<a href="#l5.1344"></a><span id="l5.1344"> </span>
<a href="#l5.1345"></a><span id="l5.1345"> ################################################################################</span>
<a href="#l5.1346"></a><span id="l5.1346"> # Install a linked .xpt into the appropriate place.</span>
<a href="#l5.1347"></a><span id="l5.1347"> # This should ideally be performed by the non-recursive idl make file. Some day.</span>
<a href="#l5.1348"></a><span id="l5.1348"> ifdef XPT_NAME #{</span>
<a href="#l5.1349"></a><span id="l5.1349"> </span>
<a href="#l5.1350"></a><span id="l5.1350"> ifndef NO_DIST_INSTALL</span>
<a href="#l5.1351"></a><span id="l5.1351" class="difflineat">@@ -1129,19 +1229,20 @@ ifndef NO_JS_MANIFEST</span>
<a href="#l5.1352"></a><span id="l5.1352"> $(error .js component without matching .manifest. See https://developer.mozilla.org/en/XPCOM/XPCOM_changes_in_Gecko_2.0)</span>
<a href="#l5.1353"></a><span id="l5.1353"> endif</span>
<a href="#l5.1354"></a><span id="l5.1354"> endif</span>
<a href="#l5.1355"></a><span id="l5.1355"> endif</span>
<a href="#l5.1356"></a><span id="l5.1356"> </span>
<a href="#l5.1357"></a><span id="l5.1357"> ifdef EXTRA_COMPONENTS</span>
<a href="#l5.1358"></a><span id="l5.1358"> libs:: $(EXTRA_COMPONENTS)</span>
<a href="#l5.1359"></a><span id="l5.1359"> ifndef NO_DIST_INSTALL</span>
<a href="#l5.1360"></a><span id="l5.1360" class="difflineminus">-	$(call install_cmd,$(IFLAGS1) $^ $(FINAL_TARGET)/components)</span>
<a href="#l5.1361"></a><span id="l5.1361" class="difflineplus">+EXTRA_COMPONENTS_FILES := $(EXTRA_COMPONENTS)</span>
<a href="#l5.1362"></a><span id="l5.1362" class="difflineplus">+EXTRA_COMPONENTS_DEST := $(FINAL_TARGET)/components</span>
<a href="#l5.1363"></a><span id="l5.1363" class="difflineplus">+INSTALL_TARGETS += EXTRA_COMPONENTS</span>
<a href="#l5.1364"></a><span id="l5.1364"> endif</span>
<a href="#l5.1365"></a><span id="l5.1365" class="difflineminus">-</span>
<a href="#l5.1366"></a><span id="l5.1366"> endif</span>
<a href="#l5.1367"></a><span id="l5.1367"> </span>
<a href="#l5.1368"></a><span id="l5.1368"> ifdef EXTRA_PP_COMPONENTS</span>
<a href="#l5.1369"></a><span id="l5.1369"> ifndef NO_DIST_INSTALL</span>
<a href="#l5.1370"></a><span id="l5.1370"> EXTRA_PP_COMPONENTS_PATH := $(FINAL_TARGET)/components</span>
<a href="#l5.1371"></a><span id="l5.1371"> PP_TARGETS += EXTRA_PP_COMPONENTS</span>
<a href="#l5.1372"></a><span id="l5.1372"> endif</span>
<a href="#l5.1373"></a><span id="l5.1373"> endif</span>
<a href="#l5.1374"></a><span id="l5.1374" class="difflineat">@@ -1155,70 +1256,66 @@ endif</span>
<a href="#l5.1375"></a><span id="l5.1375"> ################################################################################</span>
<a href="#l5.1376"></a><span id="l5.1376"> # Copy each element of EXTRA_JS_MODULES to</span>
<a href="#l5.1377"></a><span id="l5.1377"> # $(FINAL_TARGET)/$(JS_MODULES_PATH). JS_MODULES_PATH defaults to &quot;modules&quot;</span>
<a href="#l5.1378"></a><span id="l5.1378"> # if it is undefined.</span>
<a href="#l5.1379"></a><span id="l5.1379"> JS_MODULES_PATH ?= modules</span>
<a href="#l5.1380"></a><span id="l5.1380"> FINAL_JS_MODULES_PATH := $(FINAL_TARGET)/$(JS_MODULES_PATH)</span>
<a href="#l5.1381"></a><span id="l5.1381"> </span>
<a href="#l5.1382"></a><span id="l5.1382"> ifdef EXTRA_JS_MODULES</span>
<a href="#l5.1383"></a><span id="l5.1383" class="difflineminus">-libs:: $(EXTRA_JS_MODULES)</span>
<a href="#l5.1384"></a><span id="l5.1384"> ifndef NO_DIST_INSTALL</span>
<a href="#l5.1385"></a><span id="l5.1385" class="difflineminus">-	$(call install_cmd,$(IFLAGS1) $^ $(FINAL_JS_MODULES_PATH))</span>
<a href="#l5.1386"></a><span id="l5.1386" class="difflineplus">+EXTRA_JS_MODULES_FILES := $(EXTRA_JS_MODULES)</span>
<a href="#l5.1387"></a><span id="l5.1387" class="difflineplus">+EXTRA_JS_MODULES_DEST := $(FINAL_JS_MODULES_PATH)</span>
<a href="#l5.1388"></a><span id="l5.1388" class="difflineplus">+INSTALL_TARGETS += EXTRA_JS_MODULES</span>
<a href="#l5.1389"></a><span id="l5.1389"> endif</span>
<a href="#l5.1390"></a><span id="l5.1390" class="difflineminus">-</span>
<a href="#l5.1391"></a><span id="l5.1391"> endif</span>
<a href="#l5.1392"></a><span id="l5.1392"> </span>
<a href="#l5.1393"></a><span id="l5.1393"> ifdef EXTRA_PP_JS_MODULES</span>
<a href="#l5.1394"></a><span id="l5.1394"> ifndef NO_DIST_INSTALL</span>
<a href="#l5.1395"></a><span id="l5.1395"> EXTRA_PP_JS_MODULES_PATH := $(FINAL_JS_MODULES_PATH)</span>
<a href="#l5.1396"></a><span id="l5.1396"> PP_TARGETS += EXTRA_PP_JS_MODULES</span>
<a href="#l5.1397"></a><span id="l5.1397"> endif</span>
<a href="#l5.1398"></a><span id="l5.1398"> endif</span>
<a href="#l5.1399"></a><span id="l5.1399"> </span>
<a href="#l5.1400"></a><span id="l5.1400"> ################################################################################</span>
<a href="#l5.1401"></a><span id="l5.1401"> # SDK</span>
<a href="#l5.1402"></a><span id="l5.1402"> </span>
<a href="#l5.1403"></a><span id="l5.1403"> ifneq (,$(SDK_LIBRARY))</span>
<a href="#l5.1404"></a><span id="l5.1404" class="difflineminus">-$(SDK_LIB_DIR)::</span>
<a href="#l5.1405"></a><span id="l5.1405" class="difflineminus">-	$(NSINSTALL) -D $@</span>
<a href="#l5.1406"></a><span id="l5.1406" class="difflineminus">-</span>
<a href="#l5.1407"></a><span id="l5.1407"> ifndef NO_DIST_INSTALL</span>
<a href="#l5.1408"></a><span id="l5.1408" class="difflineminus">-libs:: $(SDK_LIBRARY) $(SDK_LIB_DIR)</span>
<a href="#l5.1409"></a><span id="l5.1409" class="difflineminus">-	$(call install_cmd,$(IFLAGS2) $^)</span>
<a href="#l5.1410"></a><span id="l5.1410" class="difflineplus">+SDK_LIBRARY_FILES := $(SDK_LIBRARY)</span>
<a href="#l5.1411"></a><span id="l5.1411" class="difflineplus">+SDK_LIBRARY_DEST := $(SDK_LIB_DIR)</span>
<a href="#l5.1412"></a><span id="l5.1412" class="difflineplus">+SDK_LIBRARY_TARGET := target</span>
<a href="#l5.1413"></a><span id="l5.1413" class="difflineplus">+INSTALL_TARGETS += SDK_LIBRARY</span>
<a href="#l5.1414"></a><span id="l5.1414"> endif</span>
<a href="#l5.1415"></a><span id="l5.1415" class="difflineminus">-</span>
<a href="#l5.1416"></a><span id="l5.1416"> endif # SDK_LIBRARY</span>
<a href="#l5.1417"></a><span id="l5.1417"> </span>
<a href="#l5.1418"></a><span id="l5.1418" class="difflineminus">-ifneq (,$(SDK_BINARY))</span>
<a href="#l5.1419"></a><span id="l5.1419" class="difflineminus">-$(SDK_BIN_DIR)::</span>
<a href="#l5.1420"></a><span id="l5.1420" class="difflineminus">-	$(NSINSTALL) -D $@</span>
<a href="#l5.1421"></a><span id="l5.1421" class="difflineminus">-</span>
<a href="#l5.1422"></a><span id="l5.1422" class="difflineplus">+# SDK_BINARY is still used in various makefiles for non-products of the</span>
<a href="#l5.1423"></a><span id="l5.1423" class="difflineplus">+# compilation, so we need to keep that running on the libs tier.</span>
<a href="#l5.1424"></a><span id="l5.1424" class="difflineplus">+ifneq (,$(strip $(SDK_BINARY)))</span>
<a href="#l5.1425"></a><span id="l5.1425"> ifndef NO_DIST_INSTALL</span>
<a href="#l5.1426"></a><span id="l5.1426" class="difflineminus">-libs:: $(SDK_BINARY) $(SDK_BIN_DIR)</span>
<a href="#l5.1427"></a><span id="l5.1427" class="difflineminus">-	$(call install_cmd,$(IFLAGS2) $^)</span>
<a href="#l5.1428"></a><span id="l5.1428" class="difflineplus">+SDK_BINARY_FILES := $(SDK_BINARY)</span>
<a href="#l5.1429"></a><span id="l5.1429" class="difflineplus">+SDK_BINARY_DEST := $(SDK_BIN_DIR)</span>
<a href="#l5.1430"></a><span id="l5.1430" class="difflineplus">+# SDK_BINARY_TARGET is set in xpcom/idl-parser/Makefile.in</span>
<a href="#l5.1431"></a><span id="l5.1431" class="difflineplus">+SDK_BINARY_TARGET ?= libs target</span>
<a href="#l5.1432"></a><span id="l5.1432" class="difflineplus">+INSTALL_TARGETS += SDK_BINARY</span>
<a href="#l5.1433"></a><span id="l5.1433"> endif</span>
<a href="#l5.1434"></a><span id="l5.1434" class="difflineminus">-</span>
<a href="#l5.1435"></a><span id="l5.1435"> endif # SDK_BINARY</span>
<a href="#l5.1436"></a><span id="l5.1436"> </span>
<a href="#l5.1437"></a><span id="l5.1437"> ################################################################################</span>
<a href="#l5.1438"></a><span id="l5.1438"> # CHROME PACKAGING</span>
<a href="#l5.1439"></a><span id="l5.1439"> </span>
<a href="#l5.1440"></a><span id="l5.1440"> chrome::</span>
<a href="#l5.1441"></a><span id="l5.1441"> 	$(MAKE) realchrome</span>
<a href="#l5.1442"></a><span id="l5.1442" class="difflineminus">-	$(LOOP_OVER_PARALLEL_DIRS)</span>
<a href="#l5.1443"></a><span id="l5.1443"> 	$(LOOP_OVER_DIRS)</span>
<a href="#l5.1444"></a><span id="l5.1444" class="difflineminus">-	$(LOOP_OVER_TOOL_DIRS)</span>
<a href="#l5.1445"></a><span id="l5.1445"> </span>
<a href="#l5.1446"></a><span id="l5.1446" class="difflineminus">-$(FINAL_TARGET)/chrome:</span>
<a href="#l5.1447"></a><span id="l5.1447" class="difflineminus">-	$(NSINSTALL) -D $@</span>
<a href="#l5.1448"></a><span id="l5.1448" class="difflineplus">+$(FINAL_TARGET)/chrome: $(call mkdir_deps,$(FINAL_TARGET)/chrome)</span>
<a href="#l5.1449"></a><span id="l5.1449"> </span>
<a href="#l5.1450"></a><span id="l5.1450" class="difflineminus">-libs realchrome:: $(CHROME_DEPS) $(FINAL_TARGET)/chrome</span>
<a href="#l5.1451"></a><span id="l5.1451"> ifneq (,$(JAR_MANIFEST))</span>
<a href="#l5.1452"></a><span id="l5.1452"> ifndef NO_DIST_INSTALL</span>
<a href="#l5.1453"></a><span id="l5.1453" class="difflineplus">+libs realchrome:: $(FINAL_TARGET)/chrome</span>
<a href="#l5.1454"></a><span id="l5.1454"> 	$(call py_action,jar_maker,\</span>
<a href="#l5.1455"></a><span id="l5.1455"> 	  $(QUIET) -j $(FINAL_TARGET)/chrome \</span>
<a href="#l5.1456"></a><span id="l5.1456"> 	  $(MAKE_JARS_FLAGS) $(XULPPFLAGS) $(DEFINES) $(ACDEFINES) \</span>
<a href="#l5.1457"></a><span id="l5.1457"> 	  $(JAR_MANIFEST))</span>
<a href="#l5.1458"></a><span id="l5.1458"> endif</span>
<a href="#l5.1459"></a><span id="l5.1459"> </span>
<a href="#l5.1460"></a><span id="l5.1460"> # This is a temporary check to ensure patches relying on the old behavior</span>
<a href="#l5.1461"></a><span id="l5.1461"> # of silently picking up jar.mn files continue to work.</span>
<a href="#l5.1462"></a><span id="l5.1462" class="difflineat">@@ -1229,22 +1326,18 @@ endif</span>
<a href="#l5.1463"></a><span id="l5.1463"> endif</span>
<a href="#l5.1464"></a><span id="l5.1464"> </span>
<a href="#l5.1465"></a><span id="l5.1465"> ifneq ($(DIST_FILES),)</span>
<a href="#l5.1466"></a><span id="l5.1466"> DIST_FILES_PATH := $(FINAL_TARGET)</span>
<a href="#l5.1467"></a><span id="l5.1467"> DIST_FILES_FLAGS := $(XULAPP_DEFINES)</span>
<a href="#l5.1468"></a><span id="l5.1468"> PP_TARGETS += DIST_FILES</span>
<a href="#l5.1469"></a><span id="l5.1469"> endif</span>
<a href="#l5.1470"></a><span id="l5.1470"> </span>
<a href="#l5.1471"></a><span id="l5.1471" class="difflineminus">-ifneq ($(DIST_CHROME_FILES),)</span>
<a href="#l5.1472"></a><span id="l5.1472" class="difflineminus">-DIST_CHROME_FILES_PATH := $(FINAL_TARGET)/chrome</span>
<a href="#l5.1473"></a><span id="l5.1473" class="difflineminus">-DIST_CHROME_FILES_FLAGS := $(XULAPP_DEFINES)</span>
<a href="#l5.1474"></a><span id="l5.1474" class="difflineminus">-PP_TARGETS += DIST_CHROME_FILES</span>
<a href="#l5.1475"></a><span id="l5.1475" class="difflineminus">-endif</span>
<a href="#l5.1476"></a><span id="l5.1476" class="difflineminus">-</span>
<a href="#l5.1477"></a><span id="l5.1477" class="difflineplus">+# When you move this out of the tools tier, please remove the corresponding</span>
<a href="#l5.1478"></a><span id="l5.1478" class="difflineplus">+# hacks in recursivemake.py that check if Makefile.in sets the variable.</span>
<a href="#l5.1479"></a><span id="l5.1479"> ifneq ($(XPI_PKGNAME),)</span>
<a href="#l5.1480"></a><span id="l5.1480"> tools realchrome::</span>
<a href="#l5.1481"></a><span id="l5.1481"> ifdef STRIP_XPI</span>
<a href="#l5.1482"></a><span id="l5.1482"> ifndef MOZ_DEBUG</span>
<a href="#l5.1483"></a><span id="l5.1483"> 	@echo 'Stripping $(XPI_PKGNAME) package directory...'</span>
<a href="#l5.1484"></a><span id="l5.1484"> 	@echo $(FINAL_TARGET)</span>
<a href="#l5.1485"></a><span id="l5.1485"> 	@cd $(FINAL_TARGET) &amp;&amp; find . ! -type d \</span>
<a href="#l5.1486"></a><span id="l5.1486"> 			! -name '*.js' \</span>
<a href="#l5.1487"></a><span id="l5.1487" class="difflineat">@@ -1270,16 +1363,17 @@ ifndef MOZ_DEBUG</span>
<a href="#l5.1488"></a><span id="l5.1488"> 			$(PLATFORM_EXCLUDE_LIST) \</span>
<a href="#l5.1489"></a><span id="l5.1489"> 			-exec $(STRIP) $(STRIP_FLAGS) {} &gt;/dev/null 2&gt;&amp;1 \;</span>
<a href="#l5.1490"></a><span id="l5.1490"> endif</span>
<a href="#l5.1491"></a><span id="l5.1491"> endif</span>
<a href="#l5.1492"></a><span id="l5.1492"> 	@echo 'Packaging $(XPI_PKGNAME).xpi...'</span>
<a href="#l5.1493"></a><span id="l5.1493"> 	cd $(FINAL_TARGET) &amp;&amp; $(ZIP) -qr ../$(XPI_PKGNAME).xpi *</span>
<a href="#l5.1494"></a><span id="l5.1494"> endif</span>
<a href="#l5.1495"></a><span id="l5.1495"> </span>
<a href="#l5.1496"></a><span id="l5.1496" class="difflineplus">+# See comment above about moving this out of the tools tier.</span>
<a href="#l5.1497"></a><span id="l5.1497"> ifdef INSTALL_EXTENSION_ID</span>
<a href="#l5.1498"></a><span id="l5.1498"> ifndef XPI_NAME</span>
<a href="#l5.1499"></a><span id="l5.1499"> $(error XPI_NAME must be set for INSTALL_EXTENSION_ID)</span>
<a href="#l5.1500"></a><span id="l5.1500"> endif</span>
<a href="#l5.1501"></a><span id="l5.1501"> </span>
<a href="#l5.1502"></a><span id="l5.1502"> tools::</span>
<a href="#l5.1503"></a><span id="l5.1503"> 	$(RM) -r '$(DIST)/bin/extensions/$(INSTALL_EXTENSION_ID)'</span>
<a href="#l5.1504"></a><span id="l5.1504"> 	$(NSINSTALL) -D '$(DIST)/bin/extensions/$(INSTALL_EXTENSION_ID)'</span>
<a href="#l5.1505"></a><span id="l5.1505" class="difflineat">@@ -1311,33 +1405,35 @@ REGCHROME_INSTALL = $(PERL) -I$(MOZILLA_</span>
<a href="#l5.1506"></a><span id="l5.1506"> #   processes could simultaneously try to create the same directory.</span>
<a href="#l5.1507"></a><span id="l5.1507"> #</span>
<a href="#l5.1508"></a><span id="l5.1508"> #   We use $(CURDIR) in the rule's target to ensure that we don't find</span>
<a href="#l5.1509"></a><span id="l5.1509"> #   a dependency directory in the source tree via VPATH (perhaps from</span>
<a href="#l5.1510"></a><span id="l5.1510"> #   a previous build in the source tree) and thus neglect to create a</span>
<a href="#l5.1511"></a><span id="l5.1511"> #   dependency directory in the object directory, where we really need</span>
<a href="#l5.1512"></a><span id="l5.1512"> #   it.</span>
<a href="#l5.1513"></a><span id="l5.1513"> </span>
<a href="#l5.1514"></a><span id="l5.1514" class="difflineminus">-$(CURDIR)/$(MDDEPDIR):</span>
<a href="#l5.1515"></a><span id="l5.1515" class="difflineminus">-	$(MKDIR) -p $@</span>
<a href="#l5.1516"></a><span id="l5.1516" class="difflineminus">-</span>
<a href="#l5.1517"></a><span id="l5.1517" class="difflineminus">-ifneq (,$(filter-out all chrome default export realchrome tools clean clobber clobber_all distclean realclean,$(MAKECMDGOALS)))</span>
<a href="#l5.1518"></a><span id="l5.1518" class="difflineminus">-ifneq (,$(OBJS)$(SIMPLE_PROGRAMS))</span>
<a href="#l5.1519"></a><span id="l5.1519" class="difflineminus">-MDDEPEND_FILES		:= $(strip $(wildcard $(MDDEPDIR)/*.pp))</span>
<a href="#l5.1520"></a><span id="l5.1520" class="difflineplus">+ifneq (,$(filter-out all chrome default export realchrome clean clobber clobber_all distclean realclean,$(MAKECMDGOALS)))</span>
<a href="#l5.1521"></a><span id="l5.1521" class="difflineplus">+MDDEPEND_FILES		:= $(strip $(wildcard $(addprefix $(MDDEPDIR)/,$(EXTRA_MDDEPEND_FILES) $(addsuffix .pp,$(notdir $(sort $(OBJS) $(PROGOBJS) $(HOST_OBJS) $(HOST_PROGOBJS)))))))</span>
<a href="#l5.1522"></a><span id="l5.1522"> </span>
<a href="#l5.1523"></a><span id="l5.1523"> ifneq (,$(MDDEPEND_FILES))</span>
<a href="#l5.1524"></a><span id="l5.1524" class="difflineminus">-ifdef .PYMAKE</span>
<a href="#l5.1525"></a><span id="l5.1525" class="difflineminus">-includedeps $(MDDEPEND_FILES)</span>
<a href="#l5.1526"></a><span id="l5.1526" class="difflineminus">-else</span>
<a href="#l5.1527"></a><span id="l5.1527" class="difflineminus">-include $(MDDEPEND_FILES)</span>
<a href="#l5.1528"></a><span id="l5.1528" class="difflineminus">-endif</span>
<a href="#l5.1529"></a><span id="l5.1529" class="difflineplus">+$(call include_deps,$(MDDEPEND_FILES))</span>
<a href="#l5.1530"></a><span id="l5.1530"> endif</span>
<a href="#l5.1531"></a><span id="l5.1531"> </span>
<a href="#l5.1532"></a><span id="l5.1532"> endif</span>
<a href="#l5.1533"></a><span id="l5.1533" class="difflineplus">+</span>
<a href="#l5.1534"></a><span id="l5.1534" class="difflineplus">+</span>
<a href="#l5.1535"></a><span id="l5.1535" class="difflineplus">+ifneq (,$(filter export,$(MAKECMDGOALS)))</span>
<a href="#l5.1536"></a><span id="l5.1536" class="difflineplus">+MDDEPEND_FILES		:= $(strip $(wildcard $(addprefix $(MDDEPDIR)/,$(EXTRA_EXPORT_MDDEPEND_FILES))))</span>
<a href="#l5.1537"></a><span id="l5.1537" class="difflineplus">+</span>
<a href="#l5.1538"></a><span id="l5.1538" class="difflineplus">+ifneq (,$(MDDEPEND_FILES))</span>
<a href="#l5.1539"></a><span id="l5.1539" class="difflineplus">+$(call include_deps,$(MDDEPEND_FILES))</span>
<a href="#l5.1540"></a><span id="l5.1540"> endif</span>
<a href="#l5.1541"></a><span id="l5.1541" class="difflineplus">+</span>
<a href="#l5.1542"></a><span id="l5.1542" class="difflineplus">+endif</span>
<a href="#l5.1543"></a><span id="l5.1543" class="difflineplus">+</span>
<a href="#l5.1544"></a><span id="l5.1544"> #############################################################################</span>
<a href="#l5.1545"></a><span id="l5.1545"> </span>
<a href="#l5.1546"></a><span id="l5.1546"> -include $(topsrcdir)/$(MOZ_BUILD_APP)/app-rules.mk</span>
<a href="#l5.1547"></a><span id="l5.1547"> -include $(MY_RULES)</span>
<a href="#l5.1548"></a><span id="l5.1548"> </span>
<a href="#l5.1549"></a><span id="l5.1549"> #</span>
<a href="#l5.1550"></a><span id="l5.1550"> # Generate Emacs tags in a file named TAGS if ETAGS was set in $(MY_CONFIG)</span>
<a href="#l5.1551"></a><span id="l5.1551"> # or in $(MY_RULES)</span>
<a href="#l5.1552"></a><span id="l5.1552" class="difflineat">@@ -1359,132 +1455,198 @@ endif</span>
<a href="#l5.1553"></a><span id="l5.1553"> #</span>
<a href="#l5.1554"></a><span id="l5.1554"> # FOO_FILES := foo bar</span>
<a href="#l5.1555"></a><span id="l5.1555"> # FOO_EXECUTABLES := baz</span>
<a href="#l5.1556"></a><span id="l5.1556"> # FOO_DEST := target_path</span>
<a href="#l5.1557"></a><span id="l5.1557"> # INSTALL_TARGETS += FOO</span>
<a href="#l5.1558"></a><span id="l5.1558"> #</span>
<a href="#l5.1559"></a><span id="l5.1559"> # Additionally, a FOO_TARGET variable may be added to indicate the target for</span>
<a href="#l5.1560"></a><span id="l5.1560"> # which the files and executables are installed. Default is &quot;libs&quot;.</span>
<a href="#l5.1561"></a><span id="l5.1561" class="difflineplus">+#</span>
<a href="#l5.1562"></a><span id="l5.1562" class="difflineplus">+# Finally, a FOO_KEEP_PATH variable may be set to 1 to indicate the paths given</span>
<a href="#l5.1563"></a><span id="l5.1563" class="difflineplus">+# in FOO_FILES/FOO_EXECUTABLES are to be kept at the destination. That is,</span>
<a href="#l5.1564"></a><span id="l5.1564" class="difflineplus">+# if FOO_FILES is bar/baz/qux.h, and FOO_DEST is $(DIST)/include, the installed</span>
<a href="#l5.1565"></a><span id="l5.1565" class="difflineplus">+# file would be $(DIST)/include/bar/baz/qux.h instead of $(DIST)/include/qux.h</span>
<a href="#l5.1566"></a><span id="l5.1566"> </span>
<a href="#l5.1567"></a><span id="l5.1567"> # If we're using binary nsinstall and it's not built yet, fallback to python nsinstall.</span>
<a href="#l5.1568"></a><span id="l5.1568" class="difflineminus">-ifneq (,$(filter $(CONFIG_TOOLS)/nsinstall$(HOST_BIN_SUFFIX),$(install_cmd)))</span>
<a href="#l5.1569"></a><span id="l5.1569" class="difflineminus">-ifeq (,$(wildcard $(CONFIG_TOOLS)/nsinstall$(HOST_BIN_SUFFIX)))</span>
<a href="#l5.1570"></a><span id="l5.1570" class="difflineminus">-nsinstall_is_usable = $(if $(wildcard $(CONFIG_TOOLS)/nsinstall$(HOST_BIN_SUFFIX)),yes)</span>
<a href="#l5.1571"></a><span id="l5.1571" class="difflineplus">+ifneq (,$(filter $(DIST)/bin/nsinstall$(HOST_BIN_SUFFIX),$(install_cmd)))</span>
<a href="#l5.1572"></a><span id="l5.1572" class="difflineplus">+ifeq (,$(wildcard $(DIST)/bin/nsinstall$(HOST_BIN_SUFFIX)))</span>
<a href="#l5.1573"></a><span id="l5.1573" class="difflineplus">+nsinstall_is_usable = $(if $(wildcard $(DIST)/bin/nsinstall$(HOST_BIN_SUFFIX)),yes)</span>
<a href="#l5.1574"></a><span id="l5.1574"> </span>
<a href="#l5.1575"></a><span id="l5.1575"> define install_cmd_override</span>
<a href="#l5.1576"></a><span id="l5.1576" class="difflineminus">-$(1): install_cmd = $$(if $$(nsinstall_is_usable),$$(INSTALL),$$(NSINSTALL_PY)) $$(1)</span>
<a href="#l5.1577"></a><span id="l5.1577" class="difflineplus">+$(1): install_cmd = $$(if $$(nsinstall_is_usable),$$(INSTALL),$$(NSINSTALL_PY) -t) $$(1)</span>
<a href="#l5.1578"></a><span id="l5.1578"> endef</span>
<a href="#l5.1579"></a><span id="l5.1579"> endif</span>
<a href="#l5.1580"></a><span id="l5.1580"> endif</span>
<a href="#l5.1581"></a><span id="l5.1581"> </span>
<a href="#l5.1582"></a><span id="l5.1582" class="difflineminus">-define install_file_template</span>
<a href="#l5.1583"></a><span id="l5.1583" class="difflineminus">-$(or $(3),libs):: $(2)/$(notdir $(1))</span>
<a href="#l5.1584"></a><span id="l5.1584" class="difflineminus">-$(call install_cmd_override,$(2)/$(notdir $(1)))</span>
<a href="#l5.1585"></a><span id="l5.1585" class="difflineminus">-$(2)/$(notdir $(1)): $(1)</span>
<a href="#l5.1586"></a><span id="l5.1586" class="difflineminus">-	$$(call install_cmd,$(4) '$$&lt;' '$${@D}')</span>
<a href="#l5.1587"></a><span id="l5.1587" class="difflineplus">+install_target_tier = $(or $($(1)_TARGET),libs)</span>
<a href="#l5.1588"></a><span id="l5.1588" class="difflineplus">+INSTALL_TARGETS_TIERS := $(sort $(foreach category,$(INSTALL_TARGETS),$(call install_target_tier,$(category))))</span>
<a href="#l5.1589"></a><span id="l5.1589" class="difflineplus">+</span>
<a href="#l5.1590"></a><span id="l5.1590" class="difflineplus">+install_target_result = $($(1)_DEST:%/=%)/$(if $($(1)_KEEP_PATH),$(2),$(notdir $(2)))</span>
<a href="#l5.1591"></a><span id="l5.1591" class="difflineplus">+install_target_files = $(foreach file,$($(1)_FILES),$(call install_target_result,$(category),$(file)))</span>
<a href="#l5.1592"></a><span id="l5.1592" class="difflineplus">+install_target_executables = $(foreach file,$($(1)_EXECUTABLES),$(call install_target_result,$(category),$(file)))</span>
<a href="#l5.1593"></a><span id="l5.1593" class="difflineplus">+</span>
<a href="#l5.1594"></a><span id="l5.1594" class="difflineplus">+# Work around a GNU make 3.81 bug where it gives $&lt; the wrong value.</span>
<a href="#l5.1595"></a><span id="l5.1595" class="difflineplus">+# See details in bug 934864.</span>
<a href="#l5.1596"></a><span id="l5.1596" class="difflineplus">+define create_dependency</span>
<a href="#l5.1597"></a><span id="l5.1597" class="difflineplus">+$(1): $(2)</span>
<a href="#l5.1598"></a><span id="l5.1598" class="difflineplus">+$(1): $(2)</span>
<a href="#l5.1599"></a><span id="l5.1599"> endef</span>
<a href="#l5.1600"></a><span id="l5.1600" class="difflineplus">+</span>
<a href="#l5.1601"></a><span id="l5.1601" class="difflineplus">+define install_target_template</span>
<a href="#l5.1602"></a><span id="l5.1602" class="difflineplus">+$(call install_cmd_override,$(2))</span>
<a href="#l5.1603"></a><span id="l5.1603" class="difflineplus">+$(call create_dependency,$(2),$(1))</span>
<a href="#l5.1604"></a><span id="l5.1604" class="difflineplus">+endef</span>
<a href="#l5.1605"></a><span id="l5.1605" class="difflineplus">+</span>
<a href="#l5.1606"></a><span id="l5.1606"> $(foreach category,$(INSTALL_TARGETS),\</span>
<a href="#l5.1607"></a><span id="l5.1607" class="difflineminus">-  $(if $($(category)_DEST),,$(error Missing $(category)_DEST))\</span>
<a href="#l5.1608"></a><span id="l5.1608" class="difflineminus">-  $(foreach file,$($(category)_FILES),\</span>
<a href="#l5.1609"></a><span id="l5.1609" class="difflineminus">-    $(eval $(call install_file_template,$(file),$($(category)_DEST),$($(category)_TARGET),$(IFLAGS1)))\</span>
<a href="#l5.1610"></a><span id="l5.1610" class="difflineminus">-  )\</span>
<a href="#l5.1611"></a><span id="l5.1611" class="difflineminus">-  $(foreach file,$($(category)_EXECUTABLES),\</span>
<a href="#l5.1612"></a><span id="l5.1612" class="difflineminus">-    $(eval $(call install_file_template,$(file),$($(category)_DEST),$($(category)_TARGET),$(IFLAGS2)))\</span>
<a href="#l5.1613"></a><span id="l5.1613" class="difflineminus">-  )\</span>
<a href="#l5.1614"></a><span id="l5.1614" class="difflineplus">+  $(if $($(category)_DEST),,$(error Missing $(category)_DEST)) \</span>
<a href="#l5.1615"></a><span id="l5.1615" class="difflineplus">+  $(foreach tier,$(call install_target_tier,$(category)),\</span>
<a href="#l5.1616"></a><span id="l5.1616" class="difflineplus">+    $(eval INSTALL_TARGETS_FILES_$(tier) += $(call install_target_files,$(category))) \</span>
<a href="#l5.1617"></a><span id="l5.1617" class="difflineplus">+    $(eval INSTALL_TARGETS_EXECUTABLES_$(tier) += $(call install_target_executables,$(category))) \</span>
<a href="#l5.1618"></a><span id="l5.1618" class="difflineplus">+  ) \</span>
<a href="#l5.1619"></a><span id="l5.1619" class="difflineplus">+  $(foreach file,$($(category)_FILES) $($(category)_EXECUTABLES), \</span>
<a href="#l5.1620"></a><span id="l5.1620" class="difflineplus">+    $(eval $(call install_target_template,$(file),$(call install_target_result,$(category),$(file)))) \</span>
<a href="#l5.1621"></a><span id="l5.1621" class="difflineplus">+  ) \</span>
<a href="#l5.1622"></a><span id="l5.1622"> )</span>
<a href="#l5.1623"></a><span id="l5.1623"> </span>
<a href="#l5.1624"></a><span id="l5.1624" class="difflineplus">+$(foreach tier,$(INSTALL_TARGETS_TIERS), \</span>
<a href="#l5.1625"></a><span id="l5.1625" class="difflineplus">+  $(eval $(tier):: $(INSTALL_TARGETS_FILES_$(tier)) $(INSTALL_TARGETS_EXECUTABLES_$(tier))) \</span>
<a href="#l5.1626"></a><span id="l5.1626" class="difflineplus">+)</span>
<a href="#l5.1627"></a><span id="l5.1627" class="difflineplus">+</span>
<a href="#l5.1628"></a><span id="l5.1628" class="difflineplus">+install_targets_sanity = $(if $(filter-out $(notdir $@),$(notdir $(&lt;))),$(error Looks like $@ has an unexpected dependency on $&lt; which breaks INSTALL_TARGETS))</span>
<a href="#l5.1629"></a><span id="l5.1629" class="difflineplus">+</span>
<a href="#l5.1630"></a><span id="l5.1630" class="difflineplus">+$(sort $(foreach tier,$(INSTALL_TARGETS_TIERS),$(INSTALL_TARGETS_FILES_$(tier)))):</span>
<a href="#l5.1631"></a><span id="l5.1631" class="difflineplus">+	$(install_targets_sanity)</span>
<a href="#l5.1632"></a><span id="l5.1632" class="difflineplus">+	$(call install_cmd,$(IFLAGS1) '$&lt;' '$(@D)')</span>
<a href="#l5.1633"></a><span id="l5.1633" class="difflineplus">+</span>
<a href="#l5.1634"></a><span id="l5.1634" class="difflineplus">+$(sort $(foreach tier,$(INSTALL_TARGETS_TIERS),$(INSTALL_TARGETS_EXECUTABLES_$(tier)))):</span>
<a href="#l5.1635"></a><span id="l5.1635" class="difflineplus">+	$(install_targets_sanity)</span>
<a href="#l5.1636"></a><span id="l5.1636" class="difflineplus">+	$(call install_cmd,$(IFLAGS2) '$&lt;' '$(@D)')</span>
<a href="#l5.1637"></a><span id="l5.1637" class="difflineplus">+</span>
<a href="#l5.1638"></a><span id="l5.1638"> ################################################################################</span>
<a href="#l5.1639"></a><span id="l5.1639"> # Preprocessing rules</span>
<a href="#l5.1640"></a><span id="l5.1640"> #</span>
<a href="#l5.1641"></a><span id="l5.1641"> # The PP_TARGETS variable contains a list of all preprocessing target</span>
<a href="#l5.1642"></a><span id="l5.1642"> # categories. Each category has associated variables listing input files, the</span>
<a href="#l5.1643"></a><span id="l5.1643"> # output directory, extra preprocessor flags, and so on. For example:</span>
<a href="#l5.1644"></a><span id="l5.1644"> #</span>
<a href="#l5.1645"></a><span id="l5.1645"> #   FOO := input-file</span>
<a href="#l5.1646"></a><span id="l5.1646"> #   FOO_PATH := target-directory</span>
<a href="#l5.1647"></a><span id="l5.1647"> #   FOO_FLAGS := -Dsome_flag</span>
<a href="#l5.1648"></a><span id="l5.1648"> #   PP_TARGETS += FOO</span>
<a href="#l5.1649"></a><span id="l5.1649"> #</span>
<a href="#l5.1650"></a><span id="l5.1650"> # If PP_TARGETS lists a category name &lt;C&gt; (like FOO, above), then we consult the</span>
<a href="#l5.1651"></a><span id="l5.1651"> # following make variables to see what to do:</span>
<a href="#l5.1652"></a><span id="l5.1652"> #</span>
<a href="#l5.1653"></a><span id="l5.1653" class="difflineminus">-# - &lt;C&gt; lists input files to be preprocessed with config/Preprocessor.py. We</span>
<a href="#l5.1654"></a><span id="l5.1654" class="difflineminus">-#   search VPATH for the names given here. If an input file name ends in '.in',</span>
<a href="#l5.1655"></a><span id="l5.1655" class="difflineminus">-#   that suffix is omitted from the output file name.</span>
<a href="#l5.1656"></a><span id="l5.1656" class="difflineplus">+# - &lt;C&gt; lists input files to be preprocessed with mozbuild.action.preprocessor.</span>
<a href="#l5.1657"></a><span id="l5.1657" class="difflineplus">+#   We search VPATH for the names given here. If an input file name ends in</span>
<a href="#l5.1658"></a><span id="l5.1658" class="difflineplus">+#   '.in', that suffix is omitted from the output file name.</span>
<a href="#l5.1659"></a><span id="l5.1659"> #</span>
<a href="#l5.1660"></a><span id="l5.1660"> # - &lt;C&gt;_PATH names the directory in which to place the preprocessed output</span>
<a href="#l5.1661"></a><span id="l5.1661"> #   files. We create this directory if it does not already exist. Setting</span>
<a href="#l5.1662"></a><span id="l5.1662"> #   this variable is optional; if unset, we install the files in $(CURDIR).</span>
<a href="#l5.1663"></a><span id="l5.1663"> #</span>
<a href="#l5.1664"></a><span id="l5.1664" class="difflineminus">-# - &lt;C&gt;_FLAGS lists flags to pass to Preprocessor.py, in addition to the usual</span>
<a href="#l5.1665"></a><span id="l5.1665" class="difflineminus">-#   bunch. Setting this variable is optional.</span>
<a href="#l5.1666"></a><span id="l5.1666" class="difflineplus">+# - &lt;C&gt;_FLAGS lists flags to pass to mozbuild.action.preprocessor, in addition</span>
<a href="#l5.1667"></a><span id="l5.1667" class="difflineplus">+#   to the usual bunch. Setting this variable is optional.</span>
<a href="#l5.1668"></a><span id="l5.1668"> #</span>
<a href="#l5.1669"></a><span id="l5.1669"> # - &lt;C&gt;_TARGET names the 'make' target that should depend on creating the output</span>
<a href="#l5.1670"></a><span id="l5.1670"> #   files. Setting this variable is optional; if unset, we preprocess the</span>
<a href="#l5.1671"></a><span id="l5.1671"> #   files for the 'libs' target.</span>
<a href="#l5.1672"></a><span id="l5.1672" class="difflineplus">+#</span>
<a href="#l5.1673"></a><span id="l5.1673" class="difflineplus">+# - &lt;C&gt;_KEEP_PATH may be set to 1 to indicate the paths given in &lt;C&gt; are to be</span>
<a href="#l5.1674"></a><span id="l5.1674" class="difflineplus">+#   kept under &lt;C&gt;_PATH. That is, if &lt;C&gt; is bar/baz/qux.h.in and &lt;C&gt;_PATH is</span>
<a href="#l5.1675"></a><span id="l5.1675" class="difflineplus">+#   $(DIST)/include, the preprocessed file would be $(DIST)/include/bar/baz/qux.h</span>
<a href="#l5.1676"></a><span id="l5.1676" class="difflineplus">+#   instead of $(DIST)/include/qux.h.</span>
<a href="#l5.1677"></a><span id="l5.1677"> </span>
<a href="#l5.1678"></a><span id="l5.1678" class="difflineminus">-# preprocess_file_template defines preprocessing rules.</span>
<a href="#l5.1679"></a><span id="l5.1679" class="difflineminus">-# $(call preprocess_file_template, source_file, output_file,</span>
<a href="#l5.1680"></a><span id="l5.1680" class="difflineminus">-#                                  makefile_target, extra_flags)</span>
<a href="#l5.1681"></a><span id="l5.1681" class="difflineminus">-define preprocess_file_template</span>
<a href="#l5.1682"></a><span id="l5.1682" class="difflineminus">-$(2): $(1) $$(GLOBAL_DEPS)</span>
<a href="#l5.1683"></a><span id="l5.1683" class="difflineminus">-	$$(RM) '$$@'</span>
<a href="#l5.1684"></a><span id="l5.1684" class="difflineminus">-	$$(call py_action,preprocessor,$(4) $$(DEFINES) $$(ACDEFINES) $$(XULPPFLAGS) '$$&lt;' -o '$$@')</span>
<a href="#l5.1685"></a><span id="l5.1685" class="difflineminus">-$(3):: $(2)</span>
<a href="#l5.1686"></a><span id="l5.1686" class="difflineminus">-endef</span>
<a href="#l5.1687"></a><span id="l5.1687" class="difflineplus">+pp_target_tier = $(or $($(1)_TARGET),libs)</span>
<a href="#l5.1688"></a><span id="l5.1688" class="difflineplus">+PP_TARGETS_TIERS := $(sort $(foreach category,$(PP_TARGETS),$(call pp_target_tier,$(category))))</span>
<a href="#l5.1689"></a><span id="l5.1689" class="difflineplus">+</span>
<a href="#l5.1690"></a><span id="l5.1690" class="difflineplus">+pp_target_result = $(or $($(1)_PATH:%/=%),$(CURDIR))/$(if $($(1)_KEEP_PATH),$(2:.in=),$(notdir $(2:.in=)))</span>
<a href="#l5.1691"></a><span id="l5.1691" class="difflineplus">+pp_target_results = $(foreach file,$($(1)),$(call pp_target_result,$(category),$(file)))</span>
<a href="#l5.1692"></a><span id="l5.1692" class="difflineplus">+</span>
<a href="#l5.1693"></a><span id="l5.1693" class="difflineplus">+$(foreach category,$(PP_TARGETS), \</span>
<a href="#l5.1694"></a><span id="l5.1694" class="difflineplus">+  $(foreach tier,$(call pp_target_tier,$(category)), \</span>
<a href="#l5.1695"></a><span id="l5.1695" class="difflineplus">+    $(eval PP_TARGETS_RESULTS_$(tier) += $(call pp_target_results,$(category))) \</span>
<a href="#l5.1696"></a><span id="l5.1696" class="difflineplus">+  ) \</span>
<a href="#l5.1697"></a><span id="l5.1697" class="difflineplus">+  $(foreach file,$($(category)), \</span>
<a href="#l5.1698"></a><span id="l5.1698" class="difflineplus">+    $(eval $(call create_dependency,$(call pp_target_result,$(category),$(file)), \</span>
<a href="#l5.1699"></a><span id="l5.1699" class="difflineplus">+                                    $(file) $(GLOBAL_DEPS))) \</span>
<a href="#l5.1700"></a><span id="l5.1700" class="difflineplus">+  ) \</span>
<a href="#l5.1701"></a><span id="l5.1701" class="difflineplus">+  $(eval $(call pp_target_results,$(category)): PP_TARGET_FLAGS=$($(category)_FLAGS)) \</span>
<a href="#l5.1702"></a><span id="l5.1702" class="difflineplus">+)</span>
<a href="#l5.1703"></a><span id="l5.1703" class="difflineplus">+</span>
<a href="#l5.1704"></a><span id="l5.1704" class="difflineplus">+$(foreach tier,$(PP_TARGETS_TIERS), \</span>
<a href="#l5.1705"></a><span id="l5.1705" class="difflineplus">+  $(eval $(tier):: $(PP_TARGETS_RESULTS_$(tier))) \</span>
<a href="#l5.1706"></a><span id="l5.1706" class="difflineplus">+)</span>
<a href="#l5.1707"></a><span id="l5.1707" class="difflineplus">+</span>
<a href="#l5.1708"></a><span id="l5.1708" class="difflineplus">+PP_TARGETS_ALL_RESULTS := $(sort $(foreach tier,$(PP_TARGETS_TIERS),$(PP_TARGETS_RESULTS_$(tier))))</span>
<a href="#l5.1709"></a><span id="l5.1709" class="difflineplus">+$(PP_TARGETS_ALL_RESULTS):</span>
<a href="#l5.1710"></a><span id="l5.1710" class="difflineplus">+	$(if $(filter-out $(notdir $@),$(notdir $(&lt;:.in=))),$(error Looks like $@ has an unexpected dependency on $&lt; which breaks PP_TARGETS))</span>
<a href="#l5.1711"></a><span id="l5.1711" class="difflineplus">+	$(RM) '$@'</span>
<a href="#l5.1712"></a><span id="l5.1712" class="difflineplus">+	$(call py_action,preprocessor,--depend $(MDDEPDIR)/$(@F).pp $(PP_TARGET_FLAGS) $(DEFINES) $(ACDEFINES) $(XULPPFLAGS) '$&lt;' -o '$@')</span>
<a href="#l5.1713"></a><span id="l5.1713"> </span>
<a href="#l5.1714"></a><span id="l5.1714" class="difflineminus">-$(foreach category,$(PP_TARGETS),						\</span>
<a href="#l5.1715"></a><span id="l5.1715" class="difflineminus">-  $(foreach file,$($(category)),						\</span>
<a href="#l5.1716"></a><span id="l5.1716" class="difflineminus">-    $(eval $(call preprocess_file_template,					\</span>
<a href="#l5.1717"></a><span id="l5.1717" class="difflineminus">-                  $(file),							\</span>
<a href="#l5.1718"></a><span id="l5.1718" class="difflineminus">-                  $(or $($(category)_PATH),$(CURDIR))/$(notdir $(file:.in=)),	\</span>
<a href="#l5.1719"></a><span id="l5.1719" class="difflineminus">-                  $(or $($(category)_TARGET),libs),				\</span>
<a href="#l5.1720"></a><span id="l5.1720" class="difflineminus">-                  $($(category)_FLAGS)))					\</span>
<a href="#l5.1721"></a><span id="l5.1721" class="difflineminus">-   )										\</span>
<a href="#l5.1722"></a><span id="l5.1722" class="difflineminus">- )</span>
<a href="#l5.1723"></a><span id="l5.1723" class="difflineplus">+# The depfile is based on the filename, and we don't want conflicts. So check</span>
<a href="#l5.1724"></a><span id="l5.1724" class="difflineplus">+# there's only one occurrence of any given filename in PP_TARGETS_ALL_RESULTS.</span>
<a href="#l5.1725"></a><span id="l5.1725" class="difflineplus">+PP_TARGETS_ALL_RESULT_NAMES := $(notdir $(PP_TARGETS_ALL_RESULTS))</span>
<a href="#l5.1726"></a><span id="l5.1726" class="difflineplus">+$(foreach file,$(sort $(PP_TARGETS_ALL_RESULT_NAMES)), \</span>
<a href="#l5.1727"></a><span id="l5.1727" class="difflineplus">+  $(if $(filter-out 1,$(words $(filter $(file),$(PP_TARGETS_ALL_RESULT_NAMES)))), \</span>
<a href="#l5.1728"></a><span id="l5.1728" class="difflineplus">+    $(error Multiple preprocessing rules are creating a $(file) file) \</span>
<a href="#l5.1729"></a><span id="l5.1729" class="difflineplus">+  ) \</span>
<a href="#l5.1730"></a><span id="l5.1730" class="difflineplus">+)</span>
<a href="#l5.1731"></a><span id="l5.1731" class="difflineplus">+</span>
<a href="#l5.1732"></a><span id="l5.1732" class="difflineplus">+ifneq (,$(filter $(PP_TARGETS_TIERS) $(PP_TARGETS_ALL_RESULTS),$(MAKECMDGOALS)))</span>
<a href="#l5.1733"></a><span id="l5.1733" class="difflineplus">+# If the depfile for a preprocessed file doesn't exist, add a dep to force</span>
<a href="#l5.1734"></a><span id="l5.1734" class="difflineplus">+# re-preprocessing.</span>
<a href="#l5.1735"></a><span id="l5.1735" class="difflineplus">+$(foreach file,$(PP_TARGETS_ALL_RESULTS), \</span>
<a href="#l5.1736"></a><span id="l5.1736" class="difflineplus">+  $(if $(wildcard $(MDDEPDIR)/$(notdir $(file)).pp), \</span>
<a href="#l5.1737"></a><span id="l5.1737" class="difflineplus">+    , \</span>
<a href="#l5.1738"></a><span id="l5.1738" class="difflineplus">+    $(eval $(file): FORCE) \</span>
<a href="#l5.1739"></a><span id="l5.1739" class="difflineplus">+  ) \</span>
<a href="#l5.1740"></a><span id="l5.1740" class="difflineplus">+)</span>
<a href="#l5.1741"></a><span id="l5.1741" class="difflineplus">+</span>
<a href="#l5.1742"></a><span id="l5.1742" class="difflineplus">+MDDEPEND_FILES := $(strip $(wildcard $(addprefix $(MDDEPDIR)/,$(addsuffix .pp,$(notdir $(PP_TARGETS_ALL_RESULTS))))))</span>
<a href="#l5.1743"></a><span id="l5.1743" class="difflineplus">+</span>
<a href="#l5.1744"></a><span id="l5.1744" class="difflineplus">+ifneq (,$(MDDEPEND_FILES))</span>
<a href="#l5.1745"></a><span id="l5.1745" class="difflineplus">+$(call include_deps,$(MDDEPEND_FILES))</span>
<a href="#l5.1746"></a><span id="l5.1746" class="difflineplus">+endif</span>
<a href="#l5.1747"></a><span id="l5.1747" class="difflineplus">+</span>
<a href="#l5.1748"></a><span id="l5.1748" class="difflineplus">+endif</span>
<a href="#l5.1749"></a><span id="l5.1749" class="difflineplus">+</span>
<a href="#l5.1750"></a><span id="l5.1750" class="difflineplus">+# Pull in non-recursive targets if this is a partial tree build.</span>
<a href="#l5.1751"></a><span id="l5.1751" class="difflineplus">+ifndef TOPLEVEL_BUILD</span>
<a href="#l5.1752"></a><span id="l5.1752" class="difflineplus">+include $(MOZILLA_SRCDIR)/config/makefiles/nonrecursive.mk</span>
<a href="#l5.1753"></a><span id="l5.1753" class="difflineplus">+endif</span>
<a href="#l5.1754"></a><span id="l5.1754"> </span>
<a href="#l5.1755"></a><span id="l5.1755"> ################################################################################</span>
<a href="#l5.1756"></a><span id="l5.1756"> # Special gmake rules.</span>
<a href="#l5.1757"></a><span id="l5.1757"> ################################################################################</span>
<a href="#l5.1758"></a><span id="l5.1758"> </span>
<a href="#l5.1759"></a><span id="l5.1759"> </span>
<a href="#l5.1760"></a><span id="l5.1760"> #</span>
<a href="#l5.1761"></a><span id="l5.1761" class="difflineminus">-# Disallow parallel builds with MSVC &lt; 8</span>
<a href="#l5.1762"></a><span id="l5.1762" class="difflineminus">-#</span>
<a href="#l5.1763"></a><span id="l5.1763" class="difflineminus">-ifneq (,$(filter 1200 1300 1310,$(_MSC_VER)))</span>
<a href="#l5.1764"></a><span id="l5.1764" class="difflineminus">-.NOTPARALLEL:</span>
<a href="#l5.1765"></a><span id="l5.1765" class="difflineminus">-endif</span>
<a href="#l5.1766"></a><span id="l5.1766" class="difflineminus">-</span>
<a href="#l5.1767"></a><span id="l5.1767" class="difflineminus">-#</span>
<a href="#l5.1768"></a><span id="l5.1768"> # Re-define the list of default suffixes, so gmake won't have to churn through</span>
<a href="#l5.1769"></a><span id="l5.1769"> # hundreds of built-in suffix rules for stuff we don't need.</span>
<a href="#l5.1770"></a><span id="l5.1770"> #</span>
<a href="#l5.1771"></a><span id="l5.1771"> .SUFFIXES:</span>
<a href="#l5.1772"></a><span id="l5.1772"> </span>
<a href="#l5.1773"></a><span id="l5.1773"> #</span>
<a href="#l5.1774"></a><span id="l5.1774"> # Fake targets.  Always run these rules, even if a file/directory with that</span>
<a href="#l5.1775"></a><span id="l5.1775"> # name already exists.</span>
<a href="#l5.1776"></a><span id="l5.1776"> #</span>
<a href="#l5.1777"></a><span id="l5.1777" class="difflineminus">-.PHONY: all alltags boot checkout chrome realchrome clean clobber clobber_all export install libs makefiles realclean run_apprunner tools $(DIRS) $(TOOL_DIRS) FORCE</span>
<a href="#l5.1778"></a><span id="l5.1778" class="difflineplus">+.PHONY: all alltags boot checkout chrome realchrome clean clobber clobber_all export install libs makefiles realclean run_apprunner tools $(DIRS) FORCE</span>
<a href="#l5.1779"></a><span id="l5.1779"> </span>
<a href="#l5.1780"></a><span id="l5.1780"> # Used as a dependency to force targets to rebuild</span>
<a href="#l5.1781"></a><span id="l5.1781"> FORCE:</span>
<a href="#l5.1782"></a><span id="l5.1782"> </span>
<a href="#l5.1783"></a><span id="l5.1783"> # Delete target if error occurs when building target</span>
<a href="#l5.1784"></a><span id="l5.1784"> .DELETE_ON_ERROR:</span>
<a href="#l5.1785"></a><span id="l5.1785"> </span>
<a href="#l5.1786"></a><span id="l5.1786" class="difflineminus">-# Properly set LIBPATTERNS for the platform</span>
<a href="#l5.1787"></a><span id="l5.1787" class="difflineminus">-.LIBPATTERNS = $(if $(IMPORT_LIB_SUFFIX),$(LIB_PREFIX)%.$(IMPORT_LIB_SUFFIX)) $(LIB_PREFIX)%.$(LIB_SUFFIX) $(DLL_PREFIX)%$(DLL_SUFFIX)</span>
<a href="#l5.1788"></a><span id="l5.1788" class="difflineminus">-</span>
<a href="#l5.1789"></a><span id="l5.1789"> tags: TAGS</span>
<a href="#l5.1790"></a><span id="l5.1790"> </span>
<a href="#l5.1791"></a><span id="l5.1791"> TAGS: $(CSRCS) $(CPPSRCS) $(wildcard *.h)</span>
<a href="#l5.1792"></a><span id="l5.1792"> 	-etags $(CSRCS) $(CPPSRCS) $(wildcard *.h)</span>
<a href="#l5.1793"></a><span id="l5.1793" class="difflineminus">-	$(LOOP_OVER_PARALLEL_DIRS)</span>
<a href="#l5.1794"></a><span id="l5.1794"> 	$(LOOP_OVER_DIRS)</span>
<a href="#l5.1795"></a><span id="l5.1795"> </span>
<a href="#l5.1796"></a><span id="l5.1796"> echo-variable-%:</span>
<a href="#l5.1797"></a><span id="l5.1797"> 	@echo &quot;$($*)&quot;</span>
<a href="#l5.1798"></a><span id="l5.1798"> </span>
<a href="#l5.1799"></a><span id="l5.1799"> echo-tiers:</span>
<a href="#l5.1800"></a><span id="l5.1800"> 	@echo $(TIERS)</span>
<a href="#l5.1801"></a><span id="l5.1801"> </span>
<a href="#l5.1802"></a><span id="l5.1802" class="difflineat">@@ -1508,27 +1670,25 @@ echo-module-filelist:</span>
<a href="#l5.1803"></a><span id="l5.1803"> </span>
<a href="#l5.1804"></a><span id="l5.1804"> showtargs:</span>
<a href="#l5.1805"></a><span id="l5.1805"> ifneq (,$(filter $(PROGRAM) $(HOST_PROGRAM) $(SIMPLE_PROGRAMS) $(HOST_LIBRARY) $(LIBRARY) $(SHARED_LIBRARY),$(TARGETS)))</span>
<a href="#l5.1806"></a><span id="l5.1806"> 	@echo --------------------------------------------------------------------------------</span>
<a href="#l5.1807"></a><span id="l5.1807"> 	@echo &quot;PROGRAM             = $(PROGRAM)&quot;</span>
<a href="#l5.1808"></a><span id="l5.1808"> 	@echo &quot;SIMPLE_PROGRAMS     = $(SIMPLE_PROGRAMS)&quot;</span>
<a href="#l5.1809"></a><span id="l5.1809"> 	@echo &quot;LIBRARY             = $(LIBRARY)&quot;</span>
<a href="#l5.1810"></a><span id="l5.1810"> 	@echo &quot;SHARED_LIBRARY      = $(SHARED_LIBRARY)&quot;</span>
<a href="#l5.1811"></a><span id="l5.1811" class="difflineminus">-	@echo &quot;SHARED_LIBRARY_LIBS = $(SHARED_LIBRARY_LIBS)&quot;</span>
<a href="#l5.1812"></a><span id="l5.1812"> 	@echo &quot;LIBS                = $(LIBS)&quot;</span>
<a href="#l5.1813"></a><span id="l5.1813"> 	@echo &quot;DEF_FILE            = $(DEF_FILE)&quot;</span>
<a href="#l5.1814"></a><span id="l5.1814"> 	@echo &quot;IMPORT_LIBRARY      = $(IMPORT_LIBRARY)&quot;</span>
<a href="#l5.1815"></a><span id="l5.1815"> 	@echo &quot;STATIC_LIBS         = $(STATIC_LIBS)&quot;</span>
<a href="#l5.1816"></a><span id="l5.1816"> 	@echo &quot;SHARED_LIBS         = $(SHARED_LIBS)&quot;</span>
<a href="#l5.1817"></a><span id="l5.1817"> 	@echo &quot;EXTRA_DSO_LDOPTS    = $(EXTRA_DSO_LDOPTS)&quot;</span>
<a href="#l5.1818"></a><span id="l5.1818"> 	@echo &quot;DEPENDENT_LIBS      = $(DEPENDENT_LIBS)&quot;</span>
<a href="#l5.1819"></a><span id="l5.1819"> 	@echo --------------------------------------------------------------------------------</span>
<a href="#l5.1820"></a><span id="l5.1820"> endif</span>
<a href="#l5.1821"></a><span id="l5.1821" class="difflineminus">-	$(LOOP_OVER_PARALLEL_DIRS)</span>
<a href="#l5.1822"></a><span id="l5.1822"> 	$(LOOP_OVER_DIRS)</span>
<a href="#l5.1823"></a><span id="l5.1823"> </span>
<a href="#l5.1824"></a><span id="l5.1824"> showbuild:</span>
<a href="#l5.1825"></a><span id="l5.1825"> 	@echo &quot;MOZ_BUILD_ROOT     = $(MOZ_BUILD_ROOT)&quot;</span>
<a href="#l5.1826"></a><span id="l5.1826"> 	@echo &quot;MOZ_WIDGET_TOOLKIT = $(MOZ_WIDGET_TOOLKIT)&quot;</span>
<a href="#l5.1827"></a><span id="l5.1827"> 	@echo &quot;CC                 = $(CC)&quot;</span>
<a href="#l5.1828"></a><span id="l5.1828"> 	@echo &quot;CXX                = $(CXX)&quot;</span>
<a href="#l5.1829"></a><span id="l5.1829"> 	@echo &quot;CCC                = $(CCC)&quot;</span>
<a href="#l5.1830"></a><span id="l5.1830" class="difflineat">@@ -1581,20 +1741,18 @@ showbuildmods::</span>
<a href="#l5.1831"></a><span id="l5.1831"> 	@echo &quot;Build Modules	= $(BUILD_MODULES)&quot;</span>
<a href="#l5.1832"></a><span id="l5.1832"> 	@echo &quot;Module dirs	= $(BUILD_MODULE_DIRS)&quot;</span>
<a href="#l5.1833"></a><span id="l5.1833"> </span>
<a href="#l5.1834"></a><span id="l5.1834"> documentation:</span>
<a href="#l5.1835"></a><span id="l5.1835"> 	@cd $(DEPTH)</span>
<a href="#l5.1836"></a><span id="l5.1836"> 	$(DOXYGEN) $(DEPTH)/config/doxygen.cfg</span>
<a href="#l5.1837"></a><span id="l5.1837"> </span>
<a href="#l5.1838"></a><span id="l5.1838"> ifdef ENABLE_TESTS</span>
<a href="#l5.1839"></a><span id="l5.1839" class="difflineminus">-check:: $(MAKE_DIRS)</span>
<a href="#l5.1840"></a><span id="l5.1840" class="difflineminus">-	$(LOOP_OVER_PARALLEL_DIRS)</span>
<a href="#l5.1841"></a><span id="l5.1841" class="difflineplus">+check::</span>
<a href="#l5.1842"></a><span id="l5.1842"> 	$(LOOP_OVER_DIRS)</span>
<a href="#l5.1843"></a><span id="l5.1843" class="difflineminus">-	$(LOOP_OVER_TOOL_DIRS)</span>
<a href="#l5.1844"></a><span id="l5.1844"> endif</span>
<a href="#l5.1845"></a><span id="l5.1845"> </span>
<a href="#l5.1846"></a><span id="l5.1846"> </span>
<a href="#l5.1847"></a><span id="l5.1847"> FREEZE_VARIABLES = \</span>
<a href="#l5.1848"></a><span id="l5.1848">   CSRCS \</span>
<a href="#l5.1849"></a><span id="l5.1849">   CPPSRCS \</span>
<a href="#l5.1850"></a><span id="l5.1850">   EXPORTS \</span>
<a href="#l5.1851"></a><span id="l5.1851">   DIRS \</span>
<a href="#l5.1852"></a><span id="l5.1852" class="difflineat">@@ -1609,10 +1767,34 @@ FREEZE_VARIABLES = \</span>
<a href="#l5.1853"></a><span id="l5.1853"> $(foreach var,$(FREEZE_VARIABLES),$(eval $(var)_FROZEN := '$($(var))'))</span>
<a href="#l5.1854"></a><span id="l5.1854"> </span>
<a href="#l5.1855"></a><span id="l5.1855"> CHECK_FROZEN_VARIABLES = $(foreach var,$(FREEZE_VARIABLES), \</span>
<a href="#l5.1856"></a><span id="l5.1856">   $(if $(subst $($(var)_FROZEN),,'$($(var))'),$(error Makefile variable '$(var)' changed value after including rules.mk. Was $($(var)_FROZEN), now $($(var)).)))</span>
<a href="#l5.1857"></a><span id="l5.1857"> </span>
<a href="#l5.1858"></a><span id="l5.1858"> libs export::</span>
<a href="#l5.1859"></a><span id="l5.1859"> 	$(CHECK_FROZEN_VARIABLES)</span>
<a href="#l5.1860"></a><span id="l5.1860"> </span>
<a href="#l5.1861"></a><span id="l5.1861" class="difflineminus">-default all::</span>
<a href="#l5.1862"></a><span id="l5.1862" class="difflineminus">-	if test -d $(DIST)/bin ; then touch $(DIST)/bin/.purgecaches ; fi</span>
<a href="#l5.1863"></a><span id="l5.1863" class="difflineplus">+PURGECACHES_DIRS ?= $(DIST)/bin</span>
<a href="#l5.1864"></a><span id="l5.1864" class="difflineplus">+ifdef MOZ_WEBAPP_RUNTIME</span>
<a href="#l5.1865"></a><span id="l5.1865" class="difflineplus">+PURGECACHES_DIRS += $(DIST)/bin/webapprt</span>
<a href="#l5.1866"></a><span id="l5.1866" class="difflineplus">+endif</span>
<a href="#l5.1867"></a><span id="l5.1867" class="difflineplus">+</span>
<a href="#l5.1868"></a><span id="l5.1868" class="difflineplus">+PURGECACHES_FILES = $(addsuffix /.purgecaches,$(PURGECACHES_DIRS))</span>
<a href="#l5.1869"></a><span id="l5.1869" class="difflineplus">+</span>
<a href="#l5.1870"></a><span id="l5.1870" class="difflineplus">+default all:: $(PURGECACHES_FILES)</span>
<a href="#l5.1871"></a><span id="l5.1871" class="difflineplus">+</span>
<a href="#l5.1872"></a><span id="l5.1872" class="difflineplus">+$(PURGECACHES_FILES):</span>
<a href="#l5.1873"></a><span id="l5.1873" class="difflineplus">+	if test -d $(@D) ; then touch $@ ; fi</span>
<a href="#l5.1874"></a><span id="l5.1874" class="difflineplus">+</span>
<a href="#l5.1875"></a><span id="l5.1875" class="difflineplus">+.DEFAULT_GOAL := $(or $(OVERRIDE_DEFAULT_GOAL),default)</span>
<a href="#l5.1876"></a><span id="l5.1876" class="difflineplus">+</span>
<a href="#l5.1877"></a><span id="l5.1877" class="difflineplus">+#############################################################################</span>
<a href="#l5.1878"></a><span id="l5.1878" class="difflineplus">+# Derived targets and dependencies</span>
<a href="#l5.1879"></a><span id="l5.1879" class="difflineplus">+</span>
<a href="#l5.1880"></a><span id="l5.1880" class="difflineplus">+include $(topsrcdir)/config/makefiles/autotargets.mk</span>
<a href="#l5.1881"></a><span id="l5.1881" class="difflineplus">+ifneq ($(NULL),$(AUTO_DEPS))</span>
<a href="#l5.1882"></a><span id="l5.1882" class="difflineplus">+  default all libs tools export:: $(AUTO_DEPS)</span>
<a href="#l5.1883"></a><span id="l5.1883" class="difflineplus">+endif</span>
<a href="#l5.1884"></a><span id="l5.1884" class="difflineplus">+</span>
<a href="#l5.1885"></a><span id="l5.1885" class="difflineplus">+export:: $(GENERATED_FILES)</span>
<a href="#l5.1886"></a><span id="l5.1886" class="difflineplus">+</span>
<a href="#l5.1887"></a><span id="l5.1887" class="difflineplus">+GARBAGE += $(GENERATED_FILES)</span>
<a href="#l5.1888"></a><span id="l5.1888" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/im/moz.build</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/im/moz.build</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -1,20 +1,21 @@</span>
<a href="#l6.4"></a><span id="l6.4"> # vim: set filetype=python:</span>
<a href="#l6.5"></a><span id="l6.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.6"></a><span id="l6.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.7"></a><span id="l6.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l6.8"></a><span id="l6.8"> </span>
<a href="#l6.9"></a><span id="l6.9"> CONFIGURE_SUBST_FILES += ['installer/Makefile']</span>
<a href="#l6.10"></a><span id="l6.10"> </span>
<a href="#l6.11"></a><span id="l6.11" class="difflineplus">+DIRS += [</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+    'content',</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+    'locales',</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+    'themes',</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+    'modules',</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+    'components'</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+]</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+</span>
<a href="#l6.19"></a><span id="l6.19"> # app is always last as it packages up the built files on mac.</span>
<a href="#l6.20"></a><span id="l6.20"> DIRS += ['app']</span>
<a href="#l6.21"></a><span id="l6.21"> </span>
<a href="#l6.22"></a><span id="l6.22"> if CONFIG['OS_ARCH'] == 'WINNT':</span>
<a href="#l6.23"></a><span id="l6.23">     DIRS += ['installer/windows']</span>
<a href="#l6.24"></a><span id="l6.24"> </span>
<a href="#l6.25"></a><span id="l6.25" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineminus">-    'content',</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineminus">-    'locales',</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineminus">-    'themes',</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineminus">-    'modules',</span>
<a href="#l6.30"></a><span id="l6.30" class="difflineminus">-    'components'</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineminus">-]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/ldap/xpcom/moz.build</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/ldap/xpcom/moz.build</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -1,12 +1,11 @@</span>
<a href="#l7.4"></a><span id="l7.4"> # vim: set filetype=python:</span>
<a href="#l7.5"></a><span id="l7.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l7.6"></a><span id="l7.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l7.7"></a><span id="l7.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l7.8"></a><span id="l7.8"> </span>
<a href="#l7.9"></a><span id="l7.9" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l7.10"></a><span id="l7.10" class="difflineplus">+DIRS += [</span>
<a href="#l7.11"></a><span id="l7.11">     'public',</span>
<a href="#l7.12"></a><span id="l7.12">     'src',</span>
<a href="#l7.13"></a><span id="l7.13"> ]</span>
<a href="#l7.14"></a><span id="l7.14"> </span>
<a href="#l7.15"></a><span id="l7.15" class="difflineminus">-TEST_TOOL_DIRS += ['tests']</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineminus">-</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+TEST_DIRS += ['tests']</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/addrbook/moz.build</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/addrbook/moz.build</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -1,12 +1,12 @@</span>
<a href="#l8.4"></a><span id="l8.4"> # vim: set filetype=python:</span>
<a href="#l8.5"></a><span id="l8.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l8.6"></a><span id="l8.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l8.7"></a><span id="l8.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l8.8"></a><span id="l8.8"> </span>
<a href="#l8.9"></a><span id="l8.9" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l8.10"></a><span id="l8.10" class="difflineplus">+DIRS += [</span>
<a href="#l8.11"></a><span id="l8.11">     'public',</span>
<a href="#l8.12"></a><span id="l8.12">     'src',</span>
<a href="#l8.13"></a><span id="l8.13"> ]</span>
<a href="#l8.14"></a><span id="l8.14"> </span>
<a href="#l8.15"></a><span id="l8.15"> TEST_DIRS += ['test']</span>
<a href="#l8.16"></a><span id="l8.16"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/base/moz.build</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/base/moz.build</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -1,16 +1,15 @@</span>
<a href="#l9.4"></a><span id="l9.4"> # vim: set filetype=python:</span>
<a href="#l9.5"></a><span id="l9.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l9.6"></a><span id="l9.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l9.7"></a><span id="l9.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l9.8"></a><span id="l9.8"> </span>
<a href="#l9.9"></a><span id="l9.9" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l9.10"></a><span id="l9.10" class="difflineplus">+DIRS += [</span>
<a href="#l9.11"></a><span id="l9.11">     'public',</span>
<a href="#l9.12"></a><span id="l9.12">     'src',</span>
<a href="#l9.13"></a><span id="l9.13">     'util',</span>
<a href="#l9.14"></a><span id="l9.14">     'ispdata',</span>
<a href="#l9.15"></a><span id="l9.15">     'search/public',</span>
<a href="#l9.16"></a><span id="l9.16">     'search/src',</span>
<a href="#l9.17"></a><span id="l9.17"> ]</span>
<a href="#l9.18"></a><span id="l9.18"> </span>
<a href="#l9.19"></a><span id="l9.19" class="difflineminus">-TEST_TOOL_DIRS += ['test']</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineminus">-</span>
<a href="#l9.21"></a><span id="l9.21" class="difflineplus">+TEST_DIRS += ['test']</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/compose/moz.build</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/compose/moz.build</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -1,12 +1,12 @@</span>
<a href="#l10.4"></a><span id="l10.4"> # vim: set filetype=python:</span>
<a href="#l10.5"></a><span id="l10.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l10.6"></a><span id="l10.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l10.7"></a><span id="l10.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l10.8"></a><span id="l10.8"> </span>
<a href="#l10.9"></a><span id="l10.9" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l10.10"></a><span id="l10.10" class="difflineplus">+DIRS += [</span>
<a href="#l10.11"></a><span id="l10.11">     'public',</span>
<a href="#l10.12"></a><span id="l10.12">     'src',</span>
<a href="#l10.13"></a><span id="l10.13"> ]</span>
<a href="#l10.14"></a><span id="l10.14"> </span>
<a href="#l10.15"></a><span id="l10.15"> TEST_DIRS += ['test']</span>
<a href="#l10.16"></a><span id="l10.16"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/db/msgdb/moz.build</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/db/msgdb/moz.build</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -1,12 +1,12 @@</span>
<a href="#l11.4"></a><span id="l11.4"> # vim: set filetype=python:</span>
<a href="#l11.5"></a><span id="l11.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l11.6"></a><span id="l11.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l11.7"></a><span id="l11.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l11.8"></a><span id="l11.8"> </span>
<a href="#l11.9"></a><span id="l11.9" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineplus">+DIRS += [</span>
<a href="#l11.11"></a><span id="l11.11">     'public',</span>
<a href="#l11.12"></a><span id="l11.12">     'src',</span>
<a href="#l11.13"></a><span id="l11.13"> ]</span>
<a href="#l11.14"></a><span id="l11.14"> </span>
<a href="#l11.15"></a><span id="l11.15"> TEST_DIRS += ['test']</span>
<a href="#l11.16"></a><span id="l11.16"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/extensions/bayesian-spam-filter/moz.build</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/extensions/bayesian-spam-filter/moz.build</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -1,8 +1,8 @@</span>
<a href="#l12.4"></a><span id="l12.4"> # vim: set filetype=python:</span>
<a href="#l12.5"></a><span id="l12.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l12.6"></a><span id="l12.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l12.7"></a><span id="l12.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l12.8"></a><span id="l12.8"> </span>
<a href="#l12.9"></a><span id="l12.9" class="difflineminus">-PARALLEL_DIRS += ['src']</span>
<a href="#l12.10"></a><span id="l12.10" class="difflineplus">+DIRS += ['src']</span>
<a href="#l12.11"></a><span id="l12.11"> TEST_DIRS += ['test']</span>
<a href="#l12.12"></a><span id="l12.12"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/extensions/moz.build</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/extensions/moz.build</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -1,15 +1,15 @@</span>
<a href="#l13.4"></a><span id="l13.4"> # vim: set filetype=python:</span>
<a href="#l13.5"></a><span id="l13.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l13.6"></a><span id="l13.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l13.7"></a><span id="l13.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l13.8"></a><span id="l13.8"> </span>
<a href="#l13.9"></a><span id="l13.9"> # These extensions are not optional.</span>
<a href="#l13.10"></a><span id="l13.10" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l13.11"></a><span id="l13.11" class="difflineplus">+DIRS += [</span>
<a href="#l13.12"></a><span id="l13.12">     'mdn',</span>
<a href="#l13.13"></a><span id="l13.13">     'mailviews/public',</span>
<a href="#l13.14"></a><span id="l13.14">     'mailviews/src',</span>
<a href="#l13.15"></a><span id="l13.15">     'mailviews/content',</span>
<a href="#l13.16"></a><span id="l13.16">     'bayesian-spam-filter',</span>
<a href="#l13.17"></a><span id="l13.17">     'offline-startup',</span>
<a href="#l13.18"></a><span id="l13.18">     'newsblog',</span>
<a href="#l13.19"></a><span id="l13.19">     'fts3/public',</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/extensions/smime/moz.build</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/extensions/smime/moz.build</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -1,11 +1,11 @@</span>
<a href="#l14.4"></a><span id="l14.4"> # vim: set filetype=python:</span>
<a href="#l14.5"></a><span id="l14.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l14.6"></a><span id="l14.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l14.7"></a><span id="l14.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l14.8"></a><span id="l14.8"> </span>
<a href="#l14.9"></a><span id="l14.9" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l14.10"></a><span id="l14.10" class="difflineplus">+DIRS += [</span>
<a href="#l14.11"></a><span id="l14.11">     'public',</span>
<a href="#l14.12"></a><span id="l14.12">     'src',</span>
<a href="#l14.13"></a><span id="l14.13"> ]</span>
<a href="#l14.14"></a><span id="l14.14"> </span>
<a href="#l14.15"></a><span id="l14.15"> JAR_MANIFESTS += ['jar.mn']</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/intl/Makefile.in</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/intl/Makefile.in</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -3,10 +3,8 @@</span>
<a href="#l15.4"></a><span id="l15.4"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l15.5"></a><span id="l15.5"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l15.6"></a><span id="l15.6"> </span>
<a href="#l15.7"></a><span id="l15.7"> include $(topsrcdir)/config/rules.mk</span>
<a href="#l15.8"></a><span id="l15.8"> </span>
<a href="#l15.9"></a><span id="l15.9"> PROPS2ARRAYS := $(MOZILLA_DIR)/intl/locale/props2arrays.py</span>
<a href="#l15.10"></a><span id="l15.10"> charsetalias.properties.h: $(PROPS2ARRAYS) charsetalias.properties</span>
<a href="#l15.11"></a><span id="l15.11"> 	$(PYTHON) $^ $@</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-export:: charsetalias.properties.h</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/intl/moz.build</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/intl/moz.build</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -15,17 +15,21 @@ UNIFIED_SOURCES += [</span>
<a href="#l16.4"></a><span id="l16.4">     'nsUnicodeToMUTF7.cpp',</span>
<a href="#l16.5"></a><span id="l16.5">     'nsUnicodeToUTF7.cpp',</span>
<a href="#l16.6"></a><span id="l16.6">     'nsUTF7ToUnicode.cpp',</span>
<a href="#l16.7"></a><span id="l16.7"> ]</span>
<a href="#l16.8"></a><span id="l16.8"> </span>
<a href="#l16.9"></a><span id="l16.9"> XPIDL_MODULE = 'commuconv'</span>
<a href="#l16.10"></a><span id="l16.10"> </span>
<a href="#l16.11"></a><span id="l16.11"> LOCAL_INCLUDES += [</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-    '/mozilla/intl/locale/src',</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+    '/mozilla/intl/locale',</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineplus">+]</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineplus">+</span>
<a href="#l16.16"></a><span id="l16.16" class="difflineplus">+GENERATED_FILES += [</span>
<a href="#l16.17"></a><span id="l16.17" class="difflineplus">+    'charsetalias.properties.h',</span>
<a href="#l16.18"></a><span id="l16.18"> ]</span>
<a href="#l16.19"></a><span id="l16.19"> </span>
<a href="#l16.20"></a><span id="l16.20"> MSVC_ENABLE_PGO = True</span>
<a href="#l16.21"></a><span id="l16.21"> </span>
<a href="#l16.22"></a><span id="l16.22"> FINAL_LIBRARY = 'mail'</span>
<a href="#l16.23"></a><span id="l16.23"> </span>
<a href="#l16.24"></a><span id="l16.24"> # Tests need more attention before they can be enabled.</span>
<a href="#l16.25"></a><span id="l16.25"> TEST_DIRS += ['test']</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mailnews/mime/cthandlers/moz.build</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mailnews/mime/cthandlers/moz.build</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -1,12 +1,12 @@</span>
<a href="#l17.4"></a><span id="l17.4"> # vim: set filetype=python:</span>
<a href="#l17.5"></a><span id="l17.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l17.6"></a><span id="l17.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l17.7"></a><span id="l17.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l17.8"></a><span id="l17.8"> </span>
<a href="#l17.9"></a><span id="l17.9" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l17.10"></a><span id="l17.10" class="difflineplus">+# pgpmime depends on glue.</span>
<a href="#l17.11"></a><span id="l17.11" class="difflineplus">+DIRS += [</span>
<a href="#l17.12"></a><span id="l17.12">     'glue',</span>
<a href="#l17.13"></a><span id="l17.13">     'vcard',</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineplus">+    'pgpmime',</span>
<a href="#l17.15"></a><span id="l17.15"> ]</span>
<a href="#l17.16"></a><span id="l17.16"> </span>
<a href="#l17.17"></a><span id="l17.17" class="difflineminus">-# pgpmime depends on glue.</span>
<a href="#l17.18"></a><span id="l17.18" class="difflineminus">-DIRS += ['pgpmime']</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mailnews/mime/moz.build</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mailnews/mime/moz.build</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -1,14 +1,14 @@</span>
<a href="#l18.4"></a><span id="l18.4"> # vim: set filetype=python:</span>
<a href="#l18.5"></a><span id="l18.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l18.6"></a><span id="l18.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l18.7"></a><span id="l18.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l18.8"></a><span id="l18.8"> </span>
<a href="#l18.9"></a><span id="l18.9" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l18.10"></a><span id="l18.10" class="difflineplus">+DIRS += [</span>
<a href="#l18.11"></a><span id="l18.11">     'public',</span>
<a href="#l18.12"></a><span id="l18.12">     'src',</span>
<a href="#l18.13"></a><span id="l18.13">     'emitters',</span>
<a href="#l18.14"></a><span id="l18.14">     'cthandlers',</span>
<a href="#l18.15"></a><span id="l18.15"> ]</span>
<a href="#l18.16"></a><span id="l18.16"> </span>
<a href="#l18.17"></a><span id="l18.17"> TEST_DIRS += ['test']</span>
<a href="#l18.18"></a><span id="l18.18"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mailnews/moz.build</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mailnews/moz.build</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -1,14 +1,14 @@</span>
<a href="#l19.4"></a><span id="l19.4"> # vim: set filetype=python:</span>
<a href="#l19.5"></a><span id="l19.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l19.6"></a><span id="l19.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l19.7"></a><span id="l19.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l19.8"></a><span id="l19.8"> </span>
<a href="#l19.9"></a><span id="l19.9" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l19.10"></a><span id="l19.10" class="difflineplus">+DIRS += [</span>
<a href="#l19.11"></a><span id="l19.11">     'addrbook',</span>
<a href="#l19.12"></a><span id="l19.12">     'base',</span>
<a href="#l19.13"></a><span id="l19.13">     'compose',</span>
<a href="#l19.14"></a><span id="l19.14">     'db/gloda',</span>
<a href="#l19.15"></a><span id="l19.15">     'db/msgdb',</span>
<a href="#l19.16"></a><span id="l19.16">     'extensions',</span>
<a href="#l19.17"></a><span id="l19.17">     'imap/public',</span>
<a href="#l19.18"></a><span id="l19.18">     'imap/src',</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineat">@@ -19,41 +19,41 @@ PARALLEL_DIRS += [</span>
<a href="#l19.20"></a><span id="l19.20">     'intl',</span>
<a href="#l19.21"></a><span id="l19.21">     'local/public',</span>
<a href="#l19.22"></a><span id="l19.22">     'local/src',</span>
<a href="#l19.23"></a><span id="l19.23">     'mime',</span>
<a href="#l19.24"></a><span id="l19.24">     'news',</span>
<a href="#l19.25"></a><span id="l19.25"> ]</span>
<a href="#l19.26"></a><span id="l19.26"> </span>
<a href="#l19.27"></a><span id="l19.27"> if CONFIG['MOZ_WIDGET_TOOLKIT'] == 'cocoa':</span>
<a href="#l19.28"></a><span id="l19.28" class="difflineminus">-    PARALLEL_DIRS += [</span>
<a href="#l19.29"></a><span id="l19.29" class="difflineplus">+    DIRS += [</span>
<a href="#l19.30"></a><span id="l19.30">         'import/eudora/src',</span>
<a href="#l19.31"></a><span id="l19.31">         'import/applemail/src',</span>
<a href="#l19.32"></a><span id="l19.32">     ]</span>
<a href="#l19.33"></a><span id="l19.33"> </span>
<a href="#l19.34"></a><span id="l19.34"> if CONFIG['OS_ARCH'] == 'WINNT':</span>
<a href="#l19.35"></a><span id="l19.35" class="difflineminus">-    PARALLEL_DIRS += ['import/eudora/src']</span>
<a href="#l19.36"></a><span id="l19.36" class="difflineplus">+    DIRS += ['import/eudora/src']</span>
<a href="#l19.37"></a><span id="l19.37"> </span>
<a href="#l19.38"></a><span id="l19.38">     if CONFIG['MOZ_MAPI_SUPPORT']:</span>
<a href="#l19.39"></a><span id="l19.39" class="difflineminus">-        PARALLEL_DIRS += ['import/outlook/src']</span>
<a href="#l19.40"></a><span id="l19.40" class="difflineplus">+        DIRS += ['import/outlook/src']</span>
<a href="#l19.41"></a><span id="l19.41"> </span>
<a href="#l19.42"></a><span id="l19.42">     if not CONFIG['GNU_CC']:</span>
<a href="#l19.43"></a><span id="l19.43" class="difflineminus">-        PARALLEL_DIRS += [</span>
<a href="#l19.44"></a><span id="l19.44" class="difflineplus">+        DIRS += [</span>
<a href="#l19.45"></a><span id="l19.45">             'import/oexpress',</span>
<a href="#l19.46"></a><span id="l19.46">             'import/winlivemail',</span>
<a href="#l19.47"></a><span id="l19.47">         ]</span>
<a href="#l19.48"></a><span id="l19.48"> </span>
<a href="#l19.49"></a><span id="l19.49" class="difflineminus">-TEST_TOOL_DIRS += [</span>
<a href="#l19.50"></a><span id="l19.50" class="difflineplus">+TEST_DIRS += [</span>
<a href="#l19.51"></a><span id="l19.51">     'imap/test',</span>
<a href="#l19.52"></a><span id="l19.52">     'import/test',</span>
<a href="#l19.53"></a><span id="l19.53">     'local/test',</span>
<a href="#l19.54"></a><span id="l19.54"> ]</span>
<a href="#l19.55"></a><span id="l19.55"> </span>
<a href="#l19.56"></a><span id="l19.56"> if CONFIG['MOZ_MAPI_SUPPORT']:</span>
<a href="#l19.57"></a><span id="l19.57" class="difflineminus">-    PARALLEL_DIRS += [</span>
<a href="#l19.58"></a><span id="l19.58" class="difflineplus">+    DIRS += [</span>
<a href="#l19.59"></a><span id="l19.59">         'mapi/mapiDLL',</span>
<a href="#l19.60"></a><span id="l19.60">         'mapi/mapihook',</span>
<a href="#l19.61"></a><span id="l19.61">     ]</span>
<a href="#l19.62"></a><span id="l19.62"> </span>
<a href="#l19.63"></a><span id="l19.63"> DIRS += [</span>
<a href="#l19.64"></a><span id="l19.64">     'build',</span>
<a href="#l19.65"></a><span id="l19.65">     'import/build',</span>
<a href="#l19.66"></a><span id="l19.66"> ]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mailnews/news/moz.build</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mailnews/news/moz.build</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -1,12 +1,12 @@</span>
<a href="#l20.4"></a><span id="l20.4"> # vim: set filetype=python:</span>
<a href="#l20.5"></a><span id="l20.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l20.6"></a><span id="l20.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l20.7"></a><span id="l20.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l20.8"></a><span id="l20.8"> </span>
<a href="#l20.9"></a><span id="l20.9" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l20.10"></a><span id="l20.10" class="difflineplus">+DIRS += [</span>
<a href="#l20.11"></a><span id="l20.11">     'public',</span>
<a href="#l20.12"></a><span id="l20.12">     'src',</span>
<a href="#l20.13"></a><span id="l20.13"> ]</span>
<a href="#l20.14"></a><span id="l20.14"> </span>
<a href="#l20.15"></a><span id="l20.15"> TEST_DIRS += ['test']</span>
<a href="#l20.16"></a><span id="l20.16"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/suite/common/moz.build</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/suite/common/moz.build</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -1,14 +1,14 @@</span>
<a href="#l21.4"></a><span id="l21.4"> # vim: set filetype=python:</span>
<a href="#l21.5"></a><span id="l21.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l21.6"></a><span id="l21.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l21.7"></a><span id="l21.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l21.8"></a><span id="l21.8"> </span>
<a href="#l21.9"></a><span id="l21.9" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l21.10"></a><span id="l21.10" class="difflineplus">+DIRS += [</span>
<a href="#l21.11"></a><span id="l21.11">     'public',</span>
<a href="#l21.12"></a><span id="l21.12">     'src',</span>
<a href="#l21.13"></a><span id="l21.13"> ]</span>
<a href="#l21.14"></a><span id="l21.14"> </span>
<a href="#l21.15"></a><span id="l21.15"> TEST_DIRS += [</span>
<a href="#l21.16"></a><span id="l21.16">     'tests',</span>
<a href="#l21.17"></a><span id="l21.17">     'dataman/tests',</span>
<a href="#l21.18"></a><span id="l21.18">     'downloads/tests',</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/suite/moz.build</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/suite/moz.build</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -2,19 +2,19 @@</span>
<a href="#l22.4"></a><span id="l22.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l22.5"></a><span id="l22.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l22.6"></a><span id="l22.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l22.7"></a><span id="l22.7"> </span>
<a href="#l22.8"></a><span id="l22.8"> CONFIGURE_SUBST_FILES += ['installer/Makefile']</span>
<a href="#l22.9"></a><span id="l22.9"> </span>
<a href="#l22.10"></a><span id="l22.10"> # This should match /suite/installer/moz.build.</span>
<a href="#l22.11"></a><span id="l22.11"> if 'pre' in CONFIG['MOZ_APP_VERSION'] or 'a' in CONFIG['MOZ_APP_VERSION']:</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-    PARALLEL_DIRS += ['debugQA']</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+    DIRS += ['debugQA']</span>
<a href="#l22.14"></a><span id="l22.14"> </span>
<a href="#l22.15"></a><span id="l22.15" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l22.16"></a><span id="l22.16" class="difflineplus">+DIRS += [</span>
<a href="#l22.17"></a><span id="l22.17">     'browser',</span>
<a href="#l22.18"></a><span id="l22.18">     'common',</span>
<a href="#l22.19"></a><span id="l22.19">     'feeds/public',</span>
<a href="#l22.20"></a><span id="l22.20">     'feeds/src',</span>
<a href="#l22.21"></a><span id="l22.21">     'locales',</span>
<a href="#l22.22"></a><span id="l22.22">     'mailnews',</span>
<a href="#l22.23"></a><span id="l22.23">     'modules',</span>
<a href="#l22.24"></a><span id="l22.24">     'themes/classic',</span>
<a href="#l22.25"></a><span id="l22.25" class="difflineat">@@ -22,16 +22,16 @@ PARALLEL_DIRS += [</span>
<a href="#l22.26"></a><span id="l22.26">     'profile',</span>
<a href="#l22.27"></a><span id="l22.27">     'security',</span>
<a href="#l22.28"></a><span id="l22.28">     'shell/public',</span>
<a href="#l22.29"></a><span id="l22.29">     'shell/src',</span>
<a href="#l22.30"></a><span id="l22.30">     'smile',</span>
<a href="#l22.31"></a><span id="l22.31"> ]</span>
<a href="#l22.32"></a><span id="l22.32"> </span>
<a href="#l22.33"></a><span id="l22.33"> if CONFIG['OS_ARCH'] == 'WINNT':</span>
<a href="#l22.34"></a><span id="l22.34" class="difflineminus">-    PARALLEL_DIRS += ['installer/windows']</span>
<a href="#l22.35"></a><span id="l22.35" class="difflineplus">+    DIRS += ['installer/windows']</span>
<a href="#l22.36"></a><span id="l22.36"> </span>
<a href="#l22.37"></a><span id="l22.37"> # app is always last as it packages up the built files on mac.</span>
<a href="#l22.38"></a><span id="l22.38"> DIRS += [</span>
<a href="#l22.39"></a><span id="l22.39">     'build',</span>
<a href="#l22.40"></a><span id="l22.40">     'app',</span>
<a href="#l22.41"></a><span id="l22.41"> ]</span>
<a href="#l22.42"></a><span id="l22.42"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/suite/profile/moz.build</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/suite/profile/moz.build</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -1,14 +1,14 @@</span>
<a href="#l23.4"></a><span id="l23.4"> # vim: set filetype=python:</span>
<a href="#l23.5"></a><span id="l23.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l23.6"></a><span id="l23.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l23.7"></a><span id="l23.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l23.8"></a><span id="l23.8"> </span>
<a href="#l23.9"></a><span id="l23.9" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l23.10"></a><span id="l23.10" class="difflineplus">+DIRS += [</span>
<a href="#l23.11"></a><span id="l23.11">     'migration/public',</span>
<a href="#l23.12"></a><span id="l23.12">     'migration/src',</span>
<a href="#l23.13"></a><span id="l23.13"> ]</span>
<a href="#l23.14"></a><span id="l23.14"> </span>
<a href="#l23.15"></a><span id="l23.15"> SOURCES += [</span>
<a href="#l23.16"></a><span id="l23.16">     'nsSuiteDirectoryProvider.cpp',</span>
<a href="#l23.17"></a><span id="l23.17"> ]</span>
<a href="#l23.18"></a><span id="l23.18"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/suite/smile/moz.build</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/suite/smile/moz.build</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -1,12 +1,12 @@</span>
<a href="#l24.4"></a><span id="l24.4"> # vim: set filetype=python:</span>
<a href="#l24.5"></a><span id="l24.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l24.6"></a><span id="l24.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l24.7"></a><span id="l24.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l24.8"></a><span id="l24.8"> </span>
<a href="#l24.9"></a><span id="l24.9" class="difflineminus">-PARALLEL_DIRS += [</span>
<a href="#l24.10"></a><span id="l24.10" class="difflineplus">+DIRS += [</span>
<a href="#l24.11"></a><span id="l24.11">     'public',</span>
<a href="#l24.12"></a><span id="l24.12">     'src',</span>
<a href="#l24.13"></a><span id="l24.13"> ]</span>
<a href="#l24.14"></a><span id="l24.14"> </span>
<a href="#l24.15"></a><span id="l24.15"> TEST_DIRS += ['test']</span>
<a href="#l24.16"></a><span id="l24.16"> </span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

