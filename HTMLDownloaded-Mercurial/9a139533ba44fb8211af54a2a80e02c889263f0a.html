<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 26454:9a139533ba44fb8211af54a2a80e02c889263f0a</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 9a139533ba44fb8211af54a2a80e02c889263f0a" />
<meta property="og:url" content="/comm-central/rev/9a139533ba44fb8211af54a2a80e02c889263f0a" />
<meta property="og:description" content="Bug 1536935 - [de-xbl] remove the forked notification binding. r=mkmelin" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 9a139533ba44fb8211af54a2a80e02c889263f0a 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/9a139533ba44fb8211af54a2a80e02c889263f0a">shortlog</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/9a139533ba44fb8211af54a2a80e02c889263f0a">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a">files</a> |
changeset |
<a href="/comm-central/raw-rev/9a139533ba44fb8211af54a2a80e02c889263f0a">raw</a>  | <a href="/comm-central/archive/9a139533ba44fb8211af54a2a80e02c889263f0a.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1536935">Bug 1536935</a> - [de-xbl] remove the forked notification binding. r=mkmelin
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#65;&#108;&#101;&#115;&#115;&#97;&#110;&#100;&#114;&#111;&#32;&#67;&#97;&#115;&#116;&#101;&#108;&#108;&#97;&#110;&#105;&#32;&#60;&#97;&#108;&#101;&#115;&#115;&#97;&#110;&#100;&#114;&#111;&#64;&#116;&#104;&#117;&#110;&#100;&#101;&#114;&#98;&#105;&#114;&#100;&#46;&#110;&#101;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 26 Apr 2019 10:23:36 +0200</td></tr>

<tr>
 <td>changeset 26454</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/9a139533ba44fb8211af54a2a80e02c889263f0a">9a139533ba44fb8211af54a2a80e02c889263f0a</a></td>
</tr>



<tr>
<td>parent 26453</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/72b0cb7ae598b860130e89ad39906a98337df203">72b0cb7ae598b860130e89ad39906a98337df203</a>
</td>
</tr>

<tr>
<td>child 26455</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/0b4ea11f26f8983529311b4f728753eb31868395">0b4ea11f26f8983529311b4f728753eb31868395</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=9a139533ba44fb8211af54a2a80e02c889263f0a">15839</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Fri, 26 Apr 2019 08:28:45 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@87de40d001ca [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=87de40d001ca77e92342b9f1e6b5fc1f98fc4c45">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=87de40d001ca77e92342b9f1e6b5fc1f98fc4c45&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=87de40d001ca77e92342b9f1e6b5fc1f98fc4c45&newProject=comm-central&newRevision=72b0cb7ae598b860130e89ad39906a98337df203&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=87de40d001ca77e92342b9f1e6b5fc1f98fc4c45&newProject=comm-central&newRevision=72b0cb7ae598b860130e89ad39906a98337df203&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=87de40d001ca77e92342b9f1e6b5fc1f98fc4c45&newProject=comm-central&newRevision=72b0cb7ae598b860130e89ad39906a98337df203&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28mkmelin%29&revcount=50">mkmelin</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1536935">1536935</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1536935">Bug 1536935</a> - [de-xbl] remove the forked notification binding. r=mkmelin</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-alarm-dialog.js">calendar/base/content/dialogs/calendar-alarm-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-alarm-dialog.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-alarm-dialog.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-alarm-dialog.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-alarm-dialog.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-alarm-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-alarm-dialog.xul">calendar/base/content/dialogs/calendar-alarm-dialog.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-alarm-dialog.xul">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-alarm-dialog.xul">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-alarm-dialog.xul">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-alarm-dialog.xul">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-alarm-dialog.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">calendar/base/content/dialogs/calendar-event-dialog-reminder.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul">calendar/base/content/dialogs/calendar-event-dialog-reminder.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-summary-dialog.js">calendar/base/content/dialogs/calendar-summary-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-summary-dialog.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-summary-dialog.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-summary-dialog.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-summary-dialog.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-summary-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-summary-dialog.xul">calendar/base/content/dialogs/calendar-summary-dialog.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-summary-dialog.xul">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-summary-dialog.xul">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-summary-dialog.xul">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-summary-dialog.xul">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/content/dialogs/calendar-summary-dialog.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/themes/common/calendar-alarms.css">calendar/base/themes/common/calendar-alarms.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/themes/common/calendar-alarms.css">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/themes/common/calendar-alarms.css">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/themes/common/calendar-alarms.css">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/themes/common/calendar-alarms.css">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/themes/common/calendar-alarms.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/themes/common/calendar-creation-wizard.css">calendar/base/themes/common/calendar-creation-wizard.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/themes/common/calendar-creation-wizard.css">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/themes/common/calendar-creation-wizard.css">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/themes/common/calendar-creation-wizard.css">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/themes/common/calendar-creation-wizard.css">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/base/themes/common/calendar-creation-wizard.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-calendar-creation.xul">calendar/lightning/content/lightning-calendar-creation.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-calendar-creation.xul">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-calendar-creation.xul">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-calendar-creation.xul">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-calendar-creation.xul">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-calendar-creation.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-calendar-properties.xul">calendar/lightning/content/lightning-calendar-properties.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-calendar-properties.xul">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-calendar-properties.xul">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-calendar-properties.xul">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-calendar-properties.xul">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-calendar-properties.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-item-iframe.js">calendar/lightning/content/lightning-item-iframe.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-item-iframe.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-item-iframe.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-item-iframe.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-item-iframe.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-item-iframe.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-item-iframe.xul">calendar/lightning/content/lightning-item-iframe.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-item-iframe.xul">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-item-iframe.xul">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-item-iframe.xul">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-item-iframe.xul">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-item-iframe.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-utils.js">calendar/lightning/content/lightning-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-utils.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-utils.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-utils.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-utils.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/lightning/content/lightning-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.css">calendar/providers/gdata/content/gdata-event-dialog-reminder.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.css">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.css">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.css">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.css">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.js">calendar/providers/gdata/content/gdata-event-dialog-reminder.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.xul">calendar/providers/gdata/content/gdata-event-dialog-reminder.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.xul">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.xul">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.xul">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.xul">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/providers/gdata/content/gdata-event-dialog-reminder.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/resources/content/calendarCreation.js">calendar/resources/content/calendarCreation.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/resources/content/calendarCreation.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/resources/content/calendarCreation.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/resources/content/calendarCreation.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/resources/content/calendarCreation.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/resources/content/calendarCreation.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/resources/content/calendarCreation.xul">calendar/resources/content/calendarCreation.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/resources/content/calendarCreation.xul">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/resources/content/calendarCreation.xul">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/resources/content/calendarCreation.xul">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/resources/content/calendarCreation.xul">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/calendar/resources/content/calendarCreation.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/common/bindings/notificationbox.xml">common/bindings/notificationbox.xml</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/common/bindings/notificationbox.xml">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/common/bindings/notificationbox.xml">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/common/bindings/notificationbox.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/bindings.css">mail/base/content/bindings.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/bindings.css">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/bindings.css">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/bindings.css">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/bindings.css">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/bindings.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mail3PaneWindowCommands.js">mail/base/content/mail3PaneWindowCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mail3PaneWindowCommands.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mail3PaneWindowCommands.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mail3PaneWindowCommands.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mail3PaneWindowCommands.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mail3PaneWindowCommands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mailWidgets.js">mail/base/content/mailWidgets.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mailWidgets.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mailWidgets.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mailWidgets.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mailWidgets.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mailWidgets.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mailWindowOverlay.js">mail/base/content/mailWindowOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mailWindowOverlay.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mailWindowOverlay.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mailWindowOverlay.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mailWindowOverlay.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/mailWindowOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messageWindow.xul">mail/base/content/messageWindow.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messageWindow.xul">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messageWindow.xul">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messageWindow.xul">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messageWindow.xul">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messageWindow.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messenger.css">mail/base/content/messenger.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messenger.css">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messenger.css">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messenger.css">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messenger.css">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messenger.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messenger.xul">mail/base/content/messenger.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messenger.xul">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messenger.xul">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messenger.xul">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messenger.xul">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/messenger.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/msgMail3PaneWindow.js">mail/base/content/msgMail3PaneWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/msgMail3PaneWindow.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/msgMail3PaneWindow.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/msgMail3PaneWindow.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/msgMail3PaneWindow.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/msgMail3PaneWindow.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/notification.css">mail/base/content/notification.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/notification.css">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/notification.css">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/notification.css">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/notification.css">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/notification.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/specialTabs.js">mail/base/content/specialTabs.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/specialTabs.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/specialTabs.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/specialTabs.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/specialTabs.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/content/specialTabs.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/jar.mn">mail/base/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/jar.mn">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/jar.mn">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/jar.mn">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/jar.mn">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/base/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/MsgComposeCommands.js">mail/components/compose/content/MsgComposeCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/MsgComposeCommands.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/MsgComposeCommands.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/MsgComposeCommands.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/MsgComposeCommands.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/MsgComposeCommands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/bigFileObserver.js">mail/components/compose/content/bigFileObserver.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/bigFileObserver.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/bigFileObserver.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/bigFileObserver.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/bigFileObserver.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/bigFileObserver.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/messengercompose.xul">mail/components/compose/content/messengercompose.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/messengercompose.xul">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/messengercompose.xul">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/messengercompose.xul">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/messengercompose.xul">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/compose/content/messengercompose.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/chat-messenger.inc.xul">mail/components/im/content/chat-messenger.inc.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/chat-messenger.inc.xul">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/chat-messenger.inc.xul">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/chat-messenger.inc.xul">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/chat-messenger.inc.xul">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/chat-messenger.inc.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/chat-messenger.js">mail/components/im/content/chat-messenger.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/chat-messenger.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/chat-messenger.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/chat-messenger.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/chat-messenger.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/chat-messenger.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/imAccounts.js">mail/components/im/content/imAccounts.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/imAccounts.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/imAccounts.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/imAccounts.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/imAccounts.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/imAccounts.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/imAccounts.xul">mail/components/im/content/imAccounts.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/imAccounts.xul">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/imAccounts.xul">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/imAccounts.xul">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/imAccounts.xul">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/components/im/content/imAccounts.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">mail/test/mozmill/cloudfile/test-cloudfile-notifications.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-attachment-reminder.js">mail/test/mozmill/composition/test-attachment-reminder.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-attachment-reminder.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-attachment-reminder.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-attachment-reminder.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-attachment-reminder.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-attachment-reminder.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-blocked-content.js">mail/test/mozmill/composition/test-blocked-content.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-blocked-content.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-blocked-content.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-blocked-content.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-blocked-content.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-blocked-content.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-charset-edit.js">mail/test/mozmill/composition/test-charset-edit.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-charset-edit.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-charset-edit.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-charset-edit.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-charset-edit.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-charset-edit.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-draft-identity.js">mail/test/mozmill/composition/test-draft-identity.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-draft-identity.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-draft-identity.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-draft-identity.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-draft-identity.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-draft-identity.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-drafts.js">mail/test/mozmill/composition/test-drafts.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-drafts.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-drafts.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-drafts.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-drafts.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/composition/test-drafts.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/content-policy/test-general-content-policy.js">mail/test/mozmill/content-policy/test-general-content-policy.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/content-policy/test-general-content-policy.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/content-policy/test-general-content-policy.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/content-policy/test-general-content-policy.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/content-policy/test-general-content-policy.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/content-policy/test-general-content-policy.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/folder-display/test-opening-messages.js">mail/test/mozmill/folder-display/test-opening-messages.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/folder-display/test-opening-messages.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/folder-display/test-opening-messages.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/folder-display/test-opening-messages.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/folder-display/test-opening-messages.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/folder-display/test-opening-messages.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/message-header/test-phishing-bar.js">mail/test/mozmill/message-header/test-phishing-bar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/message-header/test-phishing-bar.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/message-header/test-phishing-bar.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/message-header/test-phishing-bar.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/message-header/test-phishing-bar.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/message-header/test-phishing-bar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/message-header/test-return-receipt.js">mail/test/mozmill/message-header/test-return-receipt.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/message-header/test-return-receipt.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/message-header/test-return-receipt.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/message-header/test-return-receipt.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/message-header/test-return-receipt.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/message-header/test-return-receipt.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-compose-helpers.js">mail/test/mozmill/shared-modules/test-compose-helpers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-compose-helpers.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-compose-helpers.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-compose-helpers.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-compose-helpers.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-compose-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-notificationbox-helpers.js">mail/test/mozmill/shared-modules/test-notificationbox-helpers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-notificationbox-helpers.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-notificationbox-helpers.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-notificationbox-helpers.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-notificationbox-helpers.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-notificationbox-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-window-helpers.js">mail/test/mozmill/shared-modules/test-window-helpers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-window-helpers.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-window-helpers.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-window-helpers.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-window-helpers.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/test/mozmill/shared-modules/test-window-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/osx/mail/messenger.css">mail/themes/osx/mail/messenger.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/osx/mail/messenger.css">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/osx/mail/messenger.css">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/osx/mail/messenger.css">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/osx/mail/messenger.css">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/osx/mail/messenger.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/jar.inc.mn">mail/themes/shared/jar.inc.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/jar.inc.mn">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/jar.inc.mn">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/jar.inc.mn">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/jar.inc.mn">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/jar.inc.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/mail/messengercompose.css">mail/themes/shared/mail/messengercompose.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/mail/messengercompose.css">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/mail/messengercompose.css">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/mail/messengercompose.css">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/mail/messengercompose.css">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/mail/messengercompose.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/mail/xbl-notification.css">mail/themes/shared/mail/xbl-notification.css</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/mail/xbl-notification.css">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/mail/xbl-notification.css">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mail/themes/shared/mail/xbl-notification.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mailnews/extensions/newsblog/content/newsblogOverlay.js">mailnews/extensions/newsblog/content/newsblogOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/9a139533ba44fb8211af54a2a80e02c889263f0a/mailnews/extensions/newsblog/content/newsblogOverlay.js">file</a> |
<a href="/comm-central/annotate/9a139533ba44fb8211af54a2a80e02c889263f0a/mailnews/extensions/newsblog/content/newsblogOverlay.js">annotate</a> |
<a href="/comm-central/diff/9a139533ba44fb8211af54a2a80e02c889263f0a/mailnews/extensions/newsblog/content/newsblogOverlay.js">diff</a> |
<a href="/comm-central/comparison/9a139533ba44fb8211af54a2a80e02c889263f0a/mailnews/extensions/newsblog/content/newsblogOverlay.js">comparison</a> |
<a href="/comm-central/log/9a139533ba44fb8211af54a2a80e02c889263f0a/mailnews/extensions/newsblog/content/newsblogOverlay.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-alarm-dialog.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-alarm-dialog.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -1,28 +1,40 @@</span>
<a href="#l1.4"></a><span id="l1.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l1.5"></a><span id="l1.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l1.6"></a><span id="l1.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8"> /* exported onDismissAllAlarms, setupWindow, finishWindow, addWidgetFor,</span>
<a href="#l1.9"></a><span id="l1.9">  *         removeWidgetFor, onSelectAlarm, ensureCalendarVisible</span>
<a href="#l1.10"></a><span id="l1.10">  */</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+/* global MozElements */</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+</span>
<a href="#l1.14"></a><span id="l1.14"> /* import-globals-from ../calendar-item-editing.js */</span>
<a href="#l1.15"></a><span id="l1.15"> </span>
<a href="#l1.16"></a><span id="l1.16"> var { PluralForm } = ChromeUtils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l1.17"></a><span id="l1.17"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l1.18"></a><span id="l1.18"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineplus">+var { XPCOMUtils } = ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l1.20"></a><span id="l1.20"> </span>
<a href="#l1.21"></a><span id="l1.21"> addEventListener(&quot;DOMContentLoaded&quot;, () =&gt; {</span>
<a href="#l1.22"></a><span id="l1.22">     document.getElementById(&quot;alarm-snooze-all-popup&quot;).addEventListener(&quot;snooze&quot;, (event) =&gt; {</span>
<a href="#l1.23"></a><span id="l1.23">         snoozeAllItems(event.detail);</span>
<a href="#l1.24"></a><span id="l1.24">     });</span>
<a href="#l1.25"></a><span id="l1.25"> });</span>
<a href="#l1.26"></a><span id="l1.26"> </span>
<a href="#l1.27"></a><span id="l1.27" class="difflineplus">+const gNotification = {};</span>
<a href="#l1.28"></a><span id="l1.28" class="difflineplus">+XPCOMUtils.defineLazyGetter(gNotification, &quot;notificationbox&quot;, () =&gt; {</span>
<a href="#l1.29"></a><span id="l1.29" class="difflineplus">+    return new MozElements.NotificationBox(element =&gt; {</span>
<a href="#l1.30"></a><span id="l1.30" class="difflineplus">+        element.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineplus">+        element.setAttribute(&quot;notificationside&quot;, &quot;top&quot;);</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineplus">+        document.getElementById(&quot;readonly-notification&quot;).append(element);</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineplus">+    });</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineplus">+});</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineplus">+</span>
<a href="#l1.36"></a><span id="l1.36"> /**</span>
<a href="#l1.37"></a><span id="l1.37">  * Helper function to get the alarm service and cache it.</span>
<a href="#l1.38"></a><span id="l1.38">  *</span>
<a href="#l1.39"></a><span id="l1.39">  * @return The alarm service component</span>
<a href="#l1.40"></a><span id="l1.40">  */</span>
<a href="#l1.41"></a><span id="l1.41"> function getAlarmService() {</span>
<a href="#l1.42"></a><span id="l1.42">     if (!(&quot;mAlarmService&quot; in window)) {</span>
<a href="#l1.43"></a><span id="l1.43">         window.mAlarmService = Cc[&quot;@mozilla.org/calendar/alarm-service;1&quot;]</span>
<a href="#l1.44"></a><span id="l1.44" class="difflineat">@@ -365,30 +377,30 @@ function doReadOnlyChecks() {</span>
<a href="#l1.45"></a><span id="l1.45">     snoozeAllButton.disabled = (countRO &amp;&amp; countRO == alarmRichlist.childNodes.length);</span>
<a href="#l1.46"></a><span id="l1.46">     if (snoozeAllButton.disabled) {</span>
<a href="#l1.47"></a><span id="l1.47">         let tooltip = cal.l10n.getString(&quot;calendar-alarms&quot;, &quot;reminderDisabledSnoozeButtonTooltip&quot;);</span>
<a href="#l1.48"></a><span id="l1.48">         snoozeAllButton.setAttribute(&quot;tooltiptext&quot;, tooltip);</span>
<a href="#l1.49"></a><span id="l1.49">     } else {</span>
<a href="#l1.50"></a><span id="l1.50">         snoozeAllButton.removeAttribute(&quot;tooltiptext&quot;);</span>
<a href="#l1.51"></a><span id="l1.51">     }</span>
<a href="#l1.52"></a><span id="l1.52"> </span>
<a href="#l1.53"></a><span id="l1.53" class="difflineminus">-    let nBox = document.getElementById(&quot;readonly-notification&quot;);</span>
<a href="#l1.54"></a><span id="l1.54" class="difflineminus">-    let notification = nBox.getNotificationWithValue(&quot;calendar-readonly&quot;);</span>
<a href="#l1.55"></a><span id="l1.55" class="difflineplus">+    let notification = gNotification.notificationbox</span>
<a href="#l1.56"></a><span id="l1.56" class="difflineplus">+        .getNotificationWithValue(&quot;calendar-readonly&quot;);</span>
<a href="#l1.57"></a><span id="l1.57">     if (countRO &amp;&amp; !notification) {</span>
<a href="#l1.58"></a><span id="l1.58">         let message = cal.l10n.getString(&quot;calendar-alarms&quot;,</span>
<a href="#l1.59"></a><span id="l1.59">                                          &quot;reminderReadonlyNotification&quot;,</span>
<a href="#l1.60"></a><span id="l1.60">                                          [snoozeAllButton.label]);</span>
<a href="#l1.61"></a><span id="l1.61" class="difflineminus">-        nBox.appendNotification(message,</span>
<a href="#l1.62"></a><span id="l1.62" class="difflineminus">-                                &quot;calendar-readonly&quot;,</span>
<a href="#l1.63"></a><span id="l1.63" class="difflineminus">-                                null,</span>
<a href="#l1.64"></a><span id="l1.64" class="difflineminus">-                                nBox.PRIORITY_WARNING_MEDIUM,</span>
<a href="#l1.65"></a><span id="l1.65" class="difflineminus">-                                null,</span>
<a href="#l1.66"></a><span id="l1.66" class="difflineminus">-                                null);</span>
<a href="#l1.67"></a><span id="l1.67" class="difflineplus">+        gNotification.notificationbox.appendNotification(message,</span>
<a href="#l1.68"></a><span id="l1.68" class="difflineplus">+            &quot;calendar-readonly&quot;,</span>
<a href="#l1.69"></a><span id="l1.69" class="difflineplus">+            null,</span>
<a href="#l1.70"></a><span id="l1.70" class="difflineplus">+            gNotification.notificationbox.PRIORITY_WARNING_MEDIUM,</span>
<a href="#l1.71"></a><span id="l1.71" class="difflineplus">+            null,</span>
<a href="#l1.72"></a><span id="l1.72" class="difflineplus">+            null);</span>
<a href="#l1.73"></a><span id="l1.73">     } else if (notification &amp;&amp; !countRO) {</span>
<a href="#l1.74"></a><span id="l1.74" class="difflineminus">-        nBox.removeNotification(notification);</span>
<a href="#l1.75"></a><span id="l1.75" class="difflineplus">+        gNotification.notificationbox.removeNotification(notification);</span>
<a href="#l1.76"></a><span id="l1.76">     }</span>
<a href="#l1.77"></a><span id="l1.77"> }</span>
<a href="#l1.78"></a><span id="l1.78"> </span>
<a href="#l1.79"></a><span id="l1.79"> /**</span>
<a href="#l1.80"></a><span id="l1.80">  * Close the alarm dialog if there are no further alarm widgets</span>
<a href="#l1.81"></a><span id="l1.81">  */</span>
<a href="#l1.82"></a><span id="l1.82"> function closeIfEmpty() {</span>
<a href="#l1.83"></a><span id="l1.83">     let alarmRichlist = document.getElementById(&quot;alarm-richlist&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-alarm-dialog.xul</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-alarm-dialog.xul</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1,15 +1,16 @@</span>
<a href="#l2.4"></a><span id="l2.4"> &lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l2.5"></a><span id="l2.5"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l2.6"></a><span id="l2.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l2.7"></a><span id="l2.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/global.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l2.10"></a><span id="l2.10"> &lt;?xml-stylesheet href=&quot;chrome://messenger/content/bindings.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l2.11"></a><span id="l2.11" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://messenger/content/notification.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l2.12"></a><span id="l2.12"> &lt;?xml-stylesheet href=&quot;chrome://calendar/skin/calendar-alarm-dialog.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l2.13"></a><span id="l2.13"> </span>
<a href="#l2.14"></a><span id="l2.14"> &lt;!-- used for button-text and button-menu-dropmarker classes --&gt;</span>
<a href="#l2.15"></a><span id="l2.15"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/button.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l2.16"></a><span id="l2.16"> </span>
<a href="#l2.17"></a><span id="l2.17"> &lt;!-- DTD File with all strings specific to the calendar --&gt;</span>
<a href="#l2.18"></a><span id="l2.18"> &lt;!DOCTYPE dialog SYSTEM &quot;chrome://calendar/locale/calendar.dtd&quot;&gt;</span>
<a href="#l2.19"></a><span id="l2.19"> </span>
<a href="#l2.20"></a><span id="l2.20" class="difflineat">@@ -24,17 +25,20 @@</span>
<a href="#l2.21"></a><span id="l2.21">         onfocus=&quot;onFocusWindow();&quot;</span>
<a href="#l2.22"></a><span id="l2.22">         onkeypress=&quot;if (event.key == 'Escape') { window.close(); }&quot;</span>
<a href="#l2.23"></a><span id="l2.23">         width=&quot;600&quot;</span>
<a href="#l2.24"></a><span id="l2.24">         height=&quot;300&quot;&gt;</span>
<a href="#l2.25"></a><span id="l2.25">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://calendar/content/calendar-alarm-dialog.js&quot;/&gt;</span>
<a href="#l2.26"></a><span id="l2.26">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://calendar/content/calendar-item-editing.js&quot;/&gt;</span>
<a href="#l2.27"></a><span id="l2.27">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://calendar/content/widgets/calendar-alarm-widget.js&quot;/&gt;</span>
<a href="#l2.28"></a><span id="l2.28"> </span>
<a href="#l2.29"></a><span id="l2.29" class="difflineminus">-  &lt;notificationbox id=&quot;readonly-notification&quot; notificationside=&quot;top&quot;/&gt;</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineplus">+  &lt;hbox id=&quot;readonly-notification&quot;&gt;</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineplus">+    &lt;!-- notificationbox will be added here lazily. --&gt;</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+  &lt;/hbox&gt;</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineplus">+</span>
<a href="#l2.34"></a><span id="l2.34">   &lt;richlistbox id=&quot;alarm-richlist&quot; flex=&quot;1&quot; onselect=&quot;onSelectAlarm(event)&quot;/&gt;</span>
<a href="#l2.35"></a><span id="l2.35"> </span>
<a href="#l2.36"></a><span id="l2.36">   &lt;hbox pack=&quot;end&quot; id=&quot;alarm-actionbar&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.37"></a><span id="l2.37">     &lt;button id=&quot;alarm-snooze-all-button&quot;</span>
<a href="#l2.38"></a><span id="l2.38">             type=&quot;menu&quot;</span>
<a href="#l2.39"></a><span id="l2.39">             label=&quot;&amp;calendar.alarm.snoozeallfor.label;&quot;&gt;</span>
<a href="#l2.40"></a><span id="l2.40">       &lt;menupopup is=&quot;calendar-snooze-popup&quot; id=&quot;alarm-snooze-all-popup&quot;</span>
<a href="#l2.41"></a><span id="l2.41">                  ignorekeys=&quot;true&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-reminder.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-reminder.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1,24 +1,34 @@</span>
<a href="#l3.4"></a><span id="l3.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l3.5"></a><span id="l3.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l3.6"></a><span id="l3.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8"> /* exported onLoad, onReminderSelected, updateReminder, onNewReminder, onRemoveReminder */</span>
<a href="#l3.9"></a><span id="l3.9"> </span>
<a href="#l3.10"></a><span id="l3.10" class="difflineplus">+/* global MozElements */</span>
<a href="#l3.11"></a><span id="l3.11" class="difflineplus">+</span>
<a href="#l3.12"></a><span id="l3.12"> /* import-globals-from ../calendar-ui-utils.js */</span>
<a href="#l3.13"></a><span id="l3.13"> </span>
<a href="#l3.14"></a><span id="l3.14"> var { PluralForm } = ChromeUtils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l3.15"></a><span id="l3.15"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineminus">-</span>
<a href="#l3.17"></a><span id="l3.17"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineplus">+var { XPCOMUtils } = ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l3.19"></a><span id="l3.19"> </span>
<a href="#l3.20"></a><span id="l3.20"> var allowedActionsMap = {};</span>
<a href="#l3.21"></a><span id="l3.21"> var suppressListUpdate = false;</span>
<a href="#l3.22"></a><span id="l3.22"> </span>
<a href="#l3.23"></a><span id="l3.23" class="difflineplus">+const gNotification = {};</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineplus">+XPCOMUtils.defineLazyGetter(gNotification, &quot;notificationbox&quot;, () =&gt; {</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineplus">+    return new MozElements.NotificationBox(element =&gt; {</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineplus">+        element.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l3.27"></a><span id="l3.27" class="difflineplus">+        document.getElementById(&quot;reminder-notifications&quot;).append(element);</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineplus">+    });</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineplus">+});</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineplus">+</span>
<a href="#l3.31"></a><span id="l3.31"> /**</span>
<a href="#l3.32"></a><span id="l3.32">  * Sets up the reminder dialog.</span>
<a href="#l3.33"></a><span id="l3.33">  */</span>
<a href="#l3.34"></a><span id="l3.34"> function onLoad() {</span>
<a href="#l3.35"></a><span id="l3.35">     let calendar = window.arguments[0].calendar;</span>
<a href="#l3.36"></a><span id="l3.36"> </span>
<a href="#l3.37"></a><span id="l3.37">     // Make sure the origin menulist uses the right labels, depending on if the</span>
<a href="#l3.38"></a><span id="l3.38">     // dialog is showing an event or task.</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineat">@@ -153,54 +163,42 @@ function setupRadioEnabledState(aDisable</span>
<a href="#l3.40"></a><span id="l3.40"> </span>
<a href="#l3.41"></a><span id="l3.41"> /**</span>
<a href="#l3.42"></a><span id="l3.42">  * Sets up the max reminders notification. Shows or hides the notification</span>
<a href="#l3.43"></a><span id="l3.43">  * depending on if the max reminders limit has been hit or not.</span>
<a href="#l3.44"></a><span id="l3.44">  */</span>
<a href="#l3.45"></a><span id="l3.45"> function setupMaxReminders() {</span>
<a href="#l3.46"></a><span id="l3.46">     let args = window.arguments[0];</span>
<a href="#l3.47"></a><span id="l3.47">     let listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineminus">-    let notificationbox = document.getElementById(&quot;reminder-notifications&quot;);</span>
<a href="#l3.49"></a><span id="l3.49">     let maxReminders = args.calendar.getProperty(&quot;capabilities.alarms.maxCount&quot;);</span>
<a href="#l3.50"></a><span id="l3.50"> </span>
<a href="#l3.51"></a><span id="l3.51">     // != null is needed here to ensure cond to be true/false, instead of</span>
<a href="#l3.52"></a><span id="l3.52">     // true/null. The former is needed for setElementValue.</span>
<a href="#l3.53"></a><span id="l3.53">     let cond = (maxReminders != null &amp;&amp; listbox.childNodes.length &gt;= maxReminders);</span>
<a href="#l3.54"></a><span id="l3.54"> </span>
<a href="#l3.55"></a><span id="l3.55">     // If we hit the maximum number of reminders, show the error box and</span>
<a href="#l3.56"></a><span id="l3.56">     // disable the new button.</span>
<a href="#l3.57"></a><span id="l3.57">     setElementValue(&quot;reminder-new-button&quot;, cond &amp;&amp; &quot;true&quot;, &quot;disabled&quot;);</span>
<a href="#l3.58"></a><span id="l3.58"> </span>
<a href="#l3.59"></a><span id="l3.59" class="difflineminus">-    if (!setupMaxReminders.notification) {</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineminus">-        let notification = document.createXULElement(&quot;xbl-notification&quot;);</span>
<a href="#l3.61"></a><span id="l3.61" class="difflineminus">-        let localeErrorString =</span>
<a href="#l3.62"></a><span id="l3.62" class="difflineminus">-            cal.l10n.getString(&quot;calendar-alarms&quot;,</span>
<a href="#l3.63"></a><span id="l3.63" class="difflineminus">-                               getItemBundleStringName(&quot;reminderErrorMaxCountReached&quot;),</span>
<a href="#l3.64"></a><span id="l3.64" class="difflineminus">-                               [maxReminders]);</span>
<a href="#l3.65"></a><span id="l3.65" class="difflineminus">-        let pluralErrorLabel = PluralForm.get(maxReminders, localeErrorString)</span>
<a href="#l3.66"></a><span id="l3.66" class="difflineminus">-                                         .replace(&quot;#1&quot;, maxReminders);</span>
<a href="#l3.67"></a><span id="l3.67" class="difflineminus">-</span>
<a href="#l3.68"></a><span id="l3.68" class="difflineminus">-        notification.setAttribute(&quot;label&quot;, pluralErrorLabel);</span>
<a href="#l3.69"></a><span id="l3.69" class="difflineminus">-        notification.setAttribute(&quot;type&quot;, &quot;warning&quot;);</span>
<a href="#l3.70"></a><span id="l3.70" class="difflineminus">-        notification.setAttribute(&quot;hideclose&quot;, &quot;true&quot;);</span>
<a href="#l3.71"></a><span id="l3.71" class="difflineminus">-        setupMaxReminders.notification = notification;</span>
<a href="#l3.72"></a><span id="l3.72" class="difflineminus">-    }</span>
<a href="#l3.73"></a><span id="l3.73" class="difflineplus">+    let localeErrorString = cal.l10n.getString(&quot;calendar-alarms&quot;,</span>
<a href="#l3.74"></a><span id="l3.74" class="difflineplus">+        getItemBundleStringName(&quot;reminderErrorMaxCountReached&quot;), [maxReminders]);</span>
<a href="#l3.75"></a><span id="l3.75" class="difflineplus">+    let pluralErrorLabel = PluralForm.get(maxReminders, localeErrorString)</span>
<a href="#l3.76"></a><span id="l3.76" class="difflineplus">+        .replace(&quot;#1&quot;, maxReminders);</span>
<a href="#l3.77"></a><span id="l3.77"> </span>
<a href="#l3.78"></a><span id="l3.78">     if (cond) {</span>
<a href="#l3.79"></a><span id="l3.79" class="difflineminus">-        notificationbox.appendChild(setupMaxReminders.notification);</span>
<a href="#l3.80"></a><span id="l3.80" class="difflineplus">+        let notification = gNotification.notificationbox.appendNotification(</span>
<a href="#l3.81"></a><span id="l3.81" class="difflineplus">+            pluralErrorLabel,</span>
<a href="#l3.82"></a><span id="l3.82" class="difflineplus">+            &quot;reminderNotification&quot;,</span>
<a href="#l3.83"></a><span id="l3.83" class="difflineplus">+            null,</span>
<a href="#l3.84"></a><span id="l3.84" class="difflineplus">+            gNotification.notificationbox.PRIORITY_WARNING_MEDIUM);</span>
<a href="#l3.85"></a><span id="l3.85" class="difflineplus">+</span>
<a href="#l3.86"></a><span id="l3.86" class="difflineplus">+        let closeButton = notification.messageDetails.nextSibling;</span>
<a href="#l3.87"></a><span id="l3.87" class="difflineplus">+        closeButton.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l3.88"></a><span id="l3.88">     } else {</span>
<a href="#l3.89"></a><span id="l3.89" class="difflineminus">-        try {</span>
<a href="#l3.90"></a><span id="l3.90" class="difflineminus">-            notificationbox.removeNotification(setupMaxReminders.notification);</span>
<a href="#l3.91"></a><span id="l3.91" class="difflineminus">-        } catch (e) {</span>
<a href="#l3.92"></a><span id="l3.92" class="difflineminus">-            // It's only ok to swallow this if the notification element hasn't been</span>
<a href="#l3.93"></a><span id="l3.93" class="difflineminus">-            // added. Then the call will throw a DOM NOT_FOUND_ERR.</span>
<a href="#l3.94"></a><span id="l3.94" class="difflineminus">-            if (e.code != e.NOT_FOUND_ERR) {</span>
<a href="#l3.95"></a><span id="l3.95" class="difflineminus">-                throw e;</span>
<a href="#l3.96"></a><span id="l3.96" class="difflineminus">-            }</span>
<a href="#l3.97"></a><span id="l3.97" class="difflineminus">-        }</span>
<a href="#l3.98"></a><span id="l3.98" class="difflineplus">+        gNotification.notificationbox.removeAllNotifications();</span>
<a href="#l3.99"></a><span id="l3.99">     }</span>
<a href="#l3.100"></a><span id="l3.100"> }</span>
<a href="#l3.101"></a><span id="l3.101"> </span>
<a href="#l3.102"></a><span id="l3.102"> /**</span>
<a href="#l3.103"></a><span id="l3.103">  * Sets up a reminder listitem for the list of reminders applied to this item.</span>
<a href="#l3.104"></a><span id="l3.104">  *</span>
<a href="#l3.105"></a><span id="l3.105">  * @param aListItem     (optional) A reference listitem to set up. If not</span>
<a href="#l3.106"></a><span id="l3.106">  *                                   passed, a new listitem will be created.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -1,15 +1,16 @@</span>
<a href="#l4.4"></a><span id="l4.4"> &lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l4.5"></a><span id="l4.5"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l4.6"></a><span id="l4.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l4.7"></a><span id="l4.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l4.8"></a><span id="l4.8"> </span>
<a href="#l4.9"></a><span id="l4.9"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://global/skin/global.css&quot;?&gt;</span>
<a href="#l4.10"></a><span id="l4.10"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://messenger/content/bindings.css&quot;?&gt;</span>
<a href="#l4.11"></a><span id="l4.11" class="difflineplus">+&lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://messenger/content/notification.css&quot;?&gt;</span>
<a href="#l4.12"></a><span id="l4.12"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar-common/skin/calendar-alarms.css&quot;?&gt;</span>
<a href="#l4.13"></a><span id="l4.13"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar-common/skin/widgets/minimonth.css&quot;?&gt;</span>
<a href="#l4.14"></a><span id="l4.14"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar/skin/calendar-event-dialog.css&quot;?&gt;</span>
<a href="#l4.15"></a><span id="l4.15"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar/content/widgets/calendar-widget-bindings.css&quot;?&gt;</span>
<a href="#l4.16"></a><span id="l4.16"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://lightning-common/skin/datetimepickers.css&quot;?&gt;</span>
<a href="#l4.17"></a><span id="l4.17"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar/content/calendar-bindings.css&quot;?&gt;</span>
<a href="#l4.18"></a><span id="l4.18"> </span>
<a href="#l4.19"></a><span id="l4.19"> &lt;!DOCTYPE dialog SYSTEM &quot;chrome://calendar/locale/dialogs/calendar-event-dialog-reminder.dtd&quot; &gt;</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineat">@@ -22,17 +23,19 @@</span>
<a href="#l4.21"></a><span id="l4.21">         xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot; xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span>
<a href="#l4.22"></a><span id="l4.22"> </span>
<a href="#l4.23"></a><span id="l4.23">   &lt;!-- Javascript includes --&gt;</span>
<a href="#l4.24"></a><span id="l4.24">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://calendar/content/calendar-event-dialog-reminder.js&quot;/&gt;</span>
<a href="#l4.25"></a><span id="l4.25">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://calendar/content/calendar-ui-utils.js&quot;/&gt;</span>
<a href="#l4.26"></a><span id="l4.26">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/customElements.js&quot;/&gt;</span>
<a href="#l4.27"></a><span id="l4.27">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://calendar/content/datetimepickers/datetimepickers.js&quot;/&gt;</span>
<a href="#l4.28"></a><span id="l4.28"> </span>
<a href="#l4.29"></a><span id="l4.29" class="difflineminus">-  &lt;notificationbox id=&quot;reminder-notifications&quot;/&gt;</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineplus">+  &lt;hbox id=&quot;reminder-notifications&quot; class=&quot;notification-inline&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineplus">+    &lt;!-- notificationbox will be added here lazily. --&gt;</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+  &lt;/hbox&gt;</span>
<a href="#l4.33"></a><span id="l4.33"> </span>
<a href="#l4.34"></a><span id="l4.34">   &lt;!-- Listbox with custom reminders --&gt;</span>
<a href="#l4.35"></a><span id="l4.35">   &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l4.36"></a><span id="l4.36">     &lt;richlistbox id=&quot;reminder-listbox&quot;</span>
<a href="#l4.37"></a><span id="l4.37">                  seltype=&quot;single&quot;</span>
<a href="#l4.38"></a><span id="l4.38">                  class=&quot;event-dialog-listbox&quot;</span>
<a href="#l4.39"></a><span id="l4.39">                  onselect=&quot;onReminderSelected()&quot;</span>
<a href="#l4.40"></a><span id="l4.40">                  flex=&quot;1&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-summary-dialog.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-summary-dialog.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -1,21 +1,32 @@</span>
<a href="#l5.4"></a><span id="l5.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l5.5"></a><span id="l5.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l5.6"></a><span id="l5.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8"> /* exported onLoad, onUnload, updatePartStat, browseDocument,</span>
<a href="#l5.9"></a><span id="l5.9">  *          sendMailToOrganizer, openAttachment, reply</span>
<a href="#l5.10"></a><span id="l5.10">  */</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+/* global MozElements */</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+</span>
<a href="#l5.14"></a><span id="l5.14"> /* import-globals-from ../../src/calApplicationUtils.js */</span>
<a href="#l5.15"></a><span id="l5.15"> /* import-globals-from calendar-dialog-utils.js */</span>
<a href="#l5.16"></a><span id="l5.16"> </span>
<a href="#l5.17"></a><span id="l5.17"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l5.18"></a><span id="l5.18"> var { recurrenceRule2String } = ChromeUtils.import(&quot;resource://calendar/modules/calRecurrenceUtils.jsm&quot;);</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+var { XPCOMUtils } = ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineplus">+</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineplus">+const gNotification = {};</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineplus">+XPCOMUtils.defineLazyGetter(gNotification, &quot;notificationbox&quot;, () =&gt; {</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineplus">+    return new MozElements.NotificationBox(element =&gt; {</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineplus">+        element.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineplus">+        document.getElementById(&quot;status-notifications&quot;).append(element);</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineplus">+    });</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineplus">+});</span>
<a href="#l5.28"></a><span id="l5.28"> </span>
<a href="#l5.29"></a><span id="l5.29"> /**</span>
<a href="#l5.30"></a><span id="l5.30">  * Sets up the summary dialog, setting all needed fields on the dialog from the</span>
<a href="#l5.31"></a><span id="l5.31">  * item received in the window arguments.</span>
<a href="#l5.32"></a><span id="l5.32">  */</span>
<a href="#l5.33"></a><span id="l5.33"> function onLoad() {</span>
<a href="#l5.34"></a><span id="l5.34">     let args = window.arguments[0];</span>
<a href="#l5.35"></a><span id="l5.35">     let item = args.calendarEvent;</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineat">@@ -343,17 +354,16 @@ function updateToolbar() {</span>
<a href="#l5.37"></a><span id="l5.37">             if (element.getAttribute(&quot;value&quot;) == status) {</span>
<a href="#l5.38"></a><span id="l5.38">                 element.setAttribute(&quot;disabled&quot;, &quot;true&quot;);</span>
<a href="#l5.39"></a><span id="l5.39">             } else {</span>
<a href="#l5.40"></a><span id="l5.40">                 element.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l5.41"></a><span id="l5.41">             }</span>
<a href="#l5.42"></a><span id="l5.42">         }</span>
<a href="#l5.43"></a><span id="l5.43">     }</span>
<a href="#l5.44"></a><span id="l5.44"> </span>
<a href="#l5.45"></a><span id="l5.45" class="difflineminus">-    let notificationBox = document.getElementById(&quot;status-notification&quot;);</span>
<a href="#l5.46"></a><span id="l5.46">     if (window.attendee) {</span>
<a href="#l5.47"></a><span id="l5.47">         // we display a notification about the users partstat</span>
<a href="#l5.48"></a><span id="l5.48">         let partStat = window.attendee.participationStatus || &quot;NEEDS-ACTION&quot;;</span>
<a href="#l5.49"></a><span id="l5.49">         let type = cal.item.isEvent(window.calendarItem) ? &quot;event&quot; : &quot;task&quot;;</span>
<a href="#l5.50"></a><span id="l5.50"> </span>
<a href="#l5.51"></a><span id="l5.51">         let msgStr = {</span>
<a href="#l5.52"></a><span id="l5.52">             ACCEPTED: type + &quot;Accepted&quot;,</span>
<a href="#l5.53"></a><span id="l5.53">             COMPLETED: &quot;taskCompleted&quot;,</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineat">@@ -362,22 +372,22 @@ function updateToolbar() {</span>
<a href="#l5.55"></a><span id="l5.55">             TENTATIVE:  type + &quot;Tentative&quot;</span>
<a href="#l5.56"></a><span id="l5.56">         };</span>
<a href="#l5.57"></a><span id="l5.57">         // this needs to be noted differently to get accepted the '-' in the key</span>
<a href="#l5.58"></a><span id="l5.58">         msgStr[&quot;NEEDS-ACTION&quot;] = type + &quot;NeedsAction&quot;;</span>
<a href="#l5.59"></a><span id="l5.59">         msgStr[&quot;IN-PROGRESS&quot;] = &quot;taskInProgress&quot;;</span>
<a href="#l5.60"></a><span id="l5.60"> </span>
<a href="#l5.61"></a><span id="l5.61">         let msg = cal.l10n.getString(&quot;calendar-event-dialog&quot;, msgStr[partStat]);</span>
<a href="#l5.62"></a><span id="l5.62"> </span>
<a href="#l5.63"></a><span id="l5.63" class="difflineminus">-        notificationBox.appendNotification(msg,</span>
<a href="#l5.64"></a><span id="l5.64" class="difflineminus">-                                           &quot;statusNotification&quot;,</span>
<a href="#l5.65"></a><span id="l5.65" class="difflineminus">-                                           null,</span>
<a href="#l5.66"></a><span id="l5.66" class="difflineminus">-                                           notificationBox.PRIORITY_INFO_MEDIUM);</span>
<a href="#l5.67"></a><span id="l5.67" class="difflineplus">+        gNotification.notificationbox.appendNotification(msg,</span>
<a href="#l5.68"></a><span id="l5.68" class="difflineplus">+            &quot;statusNotification&quot;,</span>
<a href="#l5.69"></a><span id="l5.69" class="difflineplus">+            null,</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineplus">+            gNotification.notificationbox.PRIORITY_INFO_MEDIUM);</span>
<a href="#l5.71"></a><span id="l5.71">     } else {</span>
<a href="#l5.72"></a><span id="l5.72" class="difflineminus">-        notificationBox.removeAllNotifications();</span>
<a href="#l5.73"></a><span id="l5.73" class="difflineplus">+        gNotification.notificationbox.removeAllNotifications();</span>
<a href="#l5.74"></a><span id="l5.74">     }</span>
<a href="#l5.75"></a><span id="l5.75"> }</span>
<a href="#l5.76"></a><span id="l5.76"> </span>
<a href="#l5.77"></a><span id="l5.77"> /**</span>
<a href="#l5.78"></a><span id="l5.78">  * Updates the dialog w.r.t recurrence, i.e shows a text describing the item's</span>
<a href="#l5.79"></a><span id="l5.79">  * recurrence)</span>
<a href="#l5.80"></a><span id="l5.80">  */</span>
<a href="#l5.81"></a><span id="l5.81"> function updateRepeatDetails() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-summary-dialog.xul</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-summary-dialog.xul</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -121,17 +121,19 @@</span>
<a href="#l6.4"></a><span id="l6.4">                     tooltiptext=&quot;&amp;summary.dialog.dontsend.tooltiptext;&quot;</span>
<a href="#l6.5"></a><span id="l6.5">                     label=&quot;&amp;summary.dialog.dontsend.label;&quot;</span>
<a href="#l6.6"></a><span id="l6.6">                     oncommand=&quot;reply('NONE', 'DECLINED');&quot;/&gt;</span>
<a href="#l6.7"></a><span id="l6.7">         &lt;/menupopup&gt;</span>
<a href="#l6.8"></a><span id="l6.8">       &lt;/toolbarbutton&gt;</span>
<a href="#l6.9"></a><span id="l6.9">     &lt;/toolbar&gt;</span>
<a href="#l6.10"></a><span id="l6.10">   &lt;/toolbox&gt;</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-  &lt;notificationbox id=&quot;status-notification&quot;/&gt;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+  &lt;hbox id=&quot;status-notification&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+    &lt;!-- notificationbox will be added here lazily. --&gt;</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+  &lt;/hbox&gt;</span>
<a href="#l6.16"></a><span id="l6.16"> </span>
<a href="#l6.17"></a><span id="l6.17">   &lt;!-- General --&gt;</span>
<a href="#l6.18"></a><span id="l6.18">   &lt;box id=&quot;item-general-box&quot; orient=&quot;vertical&quot;&gt;</span>
<a href="#l6.19"></a><span id="l6.19">     &lt;hbox id=&quot;item-general-caption&quot; class=&quot;calendar-caption&quot; align=&quot;center&quot;&gt;</span>
<a href="#l6.20"></a><span id="l6.20">       &lt;label value=&quot;&amp;read.only.general.label;&quot; class=&quot;header&quot;/&gt;</span>
<a href="#l6.21"></a><span id="l6.21">       &lt;separator class=&quot;groove&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l6.22"></a><span id="l6.22">     &lt;/hbox&gt;</span>
<a href="#l6.23"></a><span id="l6.23">     &lt;box orient=&quot;horizontal&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/themes/common/calendar-alarms.css</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/themes/common/calendar-alarms.css</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -45,30 +45,26 @@</span>
<a href="#l7.4"></a><span id="l7.4"> #reminder-absolute-radio &gt; .radio-label-center-box &gt; .radio-label-box {</span>
<a href="#l7.5"></a><span id="l7.5">     display: none;</span>
<a href="#l7.6"></a><span id="l7.6"> }</span>
<a href="#l7.7"></a><span id="l7.7"> </span>
<a href="#l7.8"></a><span id="l7.8"> #reminder-actions-menulist &gt; menupopup &gt; menuitem &gt; .menu-iconic-left {</span>
<a href="#l7.9"></a><span id="l7.9">     display: -moz-box;</span>
<a href="#l7.10"></a><span id="l7.10"> }</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-#reminder-notifications {</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-    overflow-y: visible;</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-}</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineminus">-</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineminus">-#reminder-notifications &gt; xbl-notification {</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineminus">-    background-color: transparent;</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineminus">-    border-width: 0;</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineminus">-}</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineminus">-#reminder-notifications &gt; xbl-notification[type=&quot;warning&quot;] &gt; hbox &gt; .messageImage {</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineplus">+#reminder-notifications &gt; notification[type=&quot;warning&quot;] &gt; hbox &gt; .messageImage {</span>
<a href="#l7.22"></a><span id="l7.22">     width: 32px;</span>
<a href="#l7.23"></a><span id="l7.23">     height: 32px;</span>
<a href="#l7.24"></a><span id="l7.24">     fill: #ffbf00;</span>
<a href="#l7.25"></a><span id="l7.25"> }</span>
<a href="#l7.26"></a><span id="l7.26"> </span>
<a href="#l7.27"></a><span id="l7.27" class="difflineplus">+#reminder-notifications {</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineplus">+  padding: 0 4px 4px;</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineplus">+}</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineplus">+</span>
<a href="#l7.31"></a><span id="l7.31"> #reminder-actions-caption,</span>
<a href="#l7.32"></a><span id="l7.32"> #reminder-details-caption,</span>
<a href="#l7.33"></a><span id="l7.33"> #calendar-event-dialog-reminder &gt; .dialog-button-box {</span>
<a href="#l7.34"></a><span id="l7.34">     padding-top: 20px;</span>
<a href="#l7.35"></a><span id="l7.35"> }</span>
<a href="#l7.36"></a><span id="l7.36"> </span>
<a href="#l7.37"></a><span id="l7.37"> .reminder-icon &gt; .menu-iconic-left &gt; .menu-iconic-icon {</span>
<a href="#l7.38"></a><span id="l7.38">     width: auto;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/themes/common/calendar-creation-wizard.css</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/themes/common/calendar-creation-wizard.css</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -1,15 +1,19 @@</span>
<a href="#l8.4"></a><span id="l8.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l8.5"></a><span id="l8.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l8.6"></a><span id="l8.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l8.7"></a><span id="l8.7"> </span>
<a href="#l8.8"></a><span id="l8.8"> #customize-rows &gt; row {</span>
<a href="#l8.9"></a><span id="l8.9" class="difflineminus">-    min-height: 26px;</span>
<a href="#l8.10"></a><span id="l8.10" class="difflineplus">+  min-height: 26px;</span>
<a href="#l8.11"></a><span id="l8.11"> }</span>
<a href="#l8.12"></a><span id="l8.12"> </span>
<a href="#l8.13"></a><span id="l8.13"> .checkbox-no-label &gt; .checkbox-label-box {</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineminus">-    display: none;</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineplus">+  display: none;</span>
<a href="#l8.16"></a><span id="l8.16"> }</span>
<a href="#l8.17"></a><span id="l8.17"> </span>
<a href="#l8.18"></a><span id="l8.18"> #calendar-uri &gt; .textbox-input-box &gt; .textbox-search-icons {</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineminus">-    display: none;</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineplus">+  display: none;</span>
<a href="#l8.21"></a><span id="l8.21"> }</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineplus">+</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineplus">+.wizard-buttons-separator {</span>
<a href="#l8.24"></a><span id="l8.24" class="difflineplus">+  border-top: none !important;</span>
<a href="#l8.25"></a><span id="l8.25" class="difflineplus">+}</span>
<a href="#l8.26"></a><span id="l8.26">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/lightning/content/lightning-calendar-creation.xul</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-calendar-creation.xul</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -1,30 +1,32 @@</span>
<a href="#l9.4"></a><span id="l9.4"> &lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l9.5"></a><span id="l9.5"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l9.6"></a><span id="l9.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l9.7"></a><span id="l9.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l9.8"></a><span id="l9.8"> --&gt;</span>
<a href="#l9.9"></a><span id="l9.9"> </span>
<a href="#l9.10"></a><span id="l9.10" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://messenger/content/notification.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l9.11"></a><span id="l9.11" class="difflineplus">+</span>
<a href="#l9.12"></a><span id="l9.12"> &lt;!DOCTYPE overlay SYSTEM &quot;chrome://lightning/locale/lightning.dtd&quot;&gt;</span>
<a href="#l9.13"></a><span id="l9.13"> </span>
<a href="#l9.14"></a><span id="l9.14"> &lt;overlay id=&quot;ltnCalendarCreationOverlay&quot;</span>
<a href="#l9.15"></a><span id="l9.15">          xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot; xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span>
<a href="#l9.16"></a><span id="l9.16"> </span>
<a href="#l9.17"></a><span id="l9.17">   &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l9.18"></a><span id="l9.18">           src=&quot;chrome://calendar/content/calendar-ui-utils.js&quot;/&gt;</span>
<a href="#l9.19"></a><span id="l9.19">   &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l9.20"></a><span id="l9.20">           src=&quot;chrome://lightning/content/lightning-utils.js&quot;/&gt;</span>
<a href="#l9.21"></a><span id="l9.21">   &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l9.22"></a><span id="l9.22">           src=&quot;chrome://lightning/content/lightning-calendar-creation.js&quot;/&gt;</span>
<a href="#l9.23"></a><span id="l9.23"> </span>
<a href="#l9.24"></a><span id="l9.24">   &lt;rows id=&quot;customize-rows&quot;&gt;</span>
<a href="#l9.25"></a><span id="l9.25" class="difflineminus">-    &lt;notificationbox id=&quot;no-identity-notification&quot;</span>
<a href="#l9.26"></a><span id="l9.26" class="difflineminus">-                     flex=&quot;1&quot;</span>
<a href="#l9.27"></a><span id="l9.27" class="difflineminus">-                     insertafter=&quot;customize-suppressAlarms-row&quot; /&gt;</span>
<a href="#l9.28"></a><span id="l9.28" class="difflineplus">+    &lt;hbox id=&quot;no-identity-notification&quot; class=&quot;notification-inline&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l9.29"></a><span id="l9.29" class="difflineplus">+      &lt;!-- notificationbox will be added here lazily. --&gt;</span>
<a href="#l9.30"></a><span id="l9.30" class="difflineplus">+    &lt;/hbox&gt;</span>
<a href="#l9.31"></a><span id="l9.31">     &lt;row id=&quot;calendar-email-identity-row&quot;</span>
<a href="#l9.32"></a><span id="l9.32">          align=&quot;center&quot;</span>
<a href="#l9.33"></a><span id="l9.33">          insertafter=&quot;no-identity-notification&quot;&gt;</span>
<a href="#l9.34"></a><span id="l9.34">       &lt;label value=&quot;&amp;lightning.calendarproperties.email.label;&quot;</span>
<a href="#l9.35"></a><span id="l9.35">              control=&quot;email-identity-menulist&quot;/&gt;</span>
<a href="#l9.36"></a><span id="l9.36">       &lt;menulist id=&quot;email-identity-menulist&quot;</span>
<a href="#l9.37"></a><span id="l9.37">                 oncommand=&quot;onChangeIdentity(event)&quot;&gt;</span>
<a href="#l9.38"></a><span id="l9.38">         &lt;menupopup id=&quot;email-identity-menupopup&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/lightning/content/lightning-calendar-properties.xul</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-calendar-properties.xul</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -1,30 +1,32 @@</span>
<a href="#l10.4"></a><span id="l10.4"> &lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l10.5"></a><span id="l10.5"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l10.6"></a><span id="l10.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l10.7"></a><span id="l10.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l10.8"></a><span id="l10.8"> --&gt;</span>
<a href="#l10.9"></a><span id="l10.9"> </span>
<a href="#l10.10"></a><span id="l10.10" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://messenger/content/notification.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l10.11"></a><span id="l10.11" class="difflineplus">+</span>
<a href="#l10.12"></a><span id="l10.12"> &lt;!DOCTYPE overlay SYSTEM &quot;chrome://lightning/locale/lightning.dtd&quot;&gt;</span>
<a href="#l10.13"></a><span id="l10.13"> </span>
<a href="#l10.14"></a><span id="l10.14"> &lt;overlay id=&quot;ltnCalendarPropertiesOverlay&quot;</span>
<a href="#l10.15"></a><span id="l10.15">          xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot; xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span>
<a href="#l10.16"></a><span id="l10.16"> </span>
<a href="#l10.17"></a><span id="l10.17">   &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l10.18"></a><span id="l10.18">           src=&quot;chrome://calendar/content/calendar-ui-utils.js&quot;/&gt;</span>
<a href="#l10.19"></a><span id="l10.19">   &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l10.20"></a><span id="l10.20">           src=&quot;chrome://lightning/content/lightning-utils.js&quot;/&gt;</span>
<a href="#l10.21"></a><span id="l10.21">   &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l10.22"></a><span id="l10.22">           src=&quot;chrome://lightning/content/lightning-calendar-properties.js&quot;/&gt;</span>
<a href="#l10.23"></a><span id="l10.23"> </span>
<a href="#l10.24"></a><span id="l10.24">   &lt;rows id=&quot;calendar-properties-rows&quot;&gt;</span>
<a href="#l10.25"></a><span id="l10.25" class="difflineminus">-    &lt;notificationbox id=&quot;no-identity-notification&quot;</span>
<a href="#l10.26"></a><span id="l10.26" class="difflineminus">-                     flex=&quot;1&quot;</span>
<a href="#l10.27"></a><span id="l10.27" class="difflineminus">-                     insertafter=&quot;calendar-uri-row&quot; /&gt;</span>
<a href="#l10.28"></a><span id="l10.28" class="difflineplus">+    &lt;hbox id=&quot;no-identity-notification&quot; class=&quot;notification-inline&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l10.29"></a><span id="l10.29" class="difflineplus">+      &lt;!-- notificationbox will be added here lazily. --&gt;</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineplus">+    &lt;/hbox&gt;</span>
<a href="#l10.31"></a><span id="l10.31">     &lt;row id=&quot;calendar-email-identity-row&quot;</span>
<a href="#l10.32"></a><span id="l10.32">          align=&quot;center&quot;</span>
<a href="#l10.33"></a><span id="l10.33">          insertafter=&quot;no-identity-notification&quot;&gt;</span>
<a href="#l10.34"></a><span id="l10.34">       &lt;label value=&quot;&amp;lightning.calendarproperties.email.label;&quot;</span>
<a href="#l10.35"></a><span id="l10.35">              control=&quot;email-identity-menulist&quot;</span>
<a href="#l10.36"></a><span id="l10.36">              disable-with-calendar=&quot;true&quot;/&gt;</span>
<a href="#l10.37"></a><span id="l10.37">       &lt;menulist id=&quot;email-identity-menulist&quot;</span>
<a href="#l10.38"></a><span id="l10.38">                 disable-with-calendar=&quot;true&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/lightning/content/lightning-item-iframe.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-item-iframe.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -9,30 +9,33 @@</span>
<a href="#l11.4"></a><span id="l11.4">  *          deleteAllAttachments, copyAttachment, attachmentLinkKeyPress,</span>
<a href="#l11.5"></a><span id="l11.5">  *          attachmentDblClick, attachmentClick, notifyUser,</span>
<a href="#l11.6"></a><span id="l11.6">  *          removeNotification, chooseRecentTimezone, showTimezonePopup,</span>
<a href="#l11.7"></a><span id="l11.7">  *          attendeeDblClick, setAttendeeContext, removeAttendee,</span>
<a href="#l11.8"></a><span id="l11.8">  *          removeAllAttendees, sendMailToUndecidedAttendees, checkUntilDate,</span>
<a href="#l11.9"></a><span id="l11.9">  *          applyValues</span>
<a href="#l11.10"></a><span id="l11.10">  */</span>
<a href="#l11.11"></a><span id="l11.11"> </span>
<a href="#l11.12"></a><span id="l11.12" class="difflineplus">+/* global MozElements */</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+</span>
<a href="#l11.14"></a><span id="l11.14"> /* import-globals-from ../../base/content/calendar-ui-utils.js */</span>
<a href="#l11.15"></a><span id="l11.15"> /* import-globals-from ../../base/content/dialogs/calendar-dialog-utils.js */</span>
<a href="#l11.16"></a><span id="l11.16"> /* import-globals-from html-item-editing/react-code.js */</span>
<a href="#l11.17"></a><span id="l11.17"> /* globals gTimezonesEnabled, gShowLink */// Set by lightning-item-panel.js.</span>
<a href="#l11.18"></a><span id="l11.18"> </span>
<a href="#l11.19"></a><span id="l11.19"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l11.20"></a><span id="l11.20"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l11.21"></a><span id="l11.21"> var {</span>
<a href="#l11.22"></a><span id="l11.22">     recurrenceRule2String,</span>
<a href="#l11.23"></a><span id="l11.23">     splitRecurrenceRules,</span>
<a href="#l11.24"></a><span id="l11.24">     checkRecurrenceRule,</span>
<a href="#l11.25"></a><span id="l11.25">     countOccurrences</span>
<a href="#l11.26"></a><span id="l11.26"> } = ChromeUtils.import(&quot;resource://calendar/modules/calRecurrenceUtils.jsm&quot;);</span>
<a href="#l11.27"></a><span id="l11.27"> var { PluralForm } = ChromeUtils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l11.28"></a><span id="l11.28" class="difflineplus">+var { XPCOMUtils } = ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l11.29"></a><span id="l11.29"> </span>
<a href="#l11.30"></a><span id="l11.30"> var cloudFileAccounts;</span>
<a href="#l11.31"></a><span id="l11.31"> try {</span>
<a href="#l11.32"></a><span id="l11.32">     let temp = ChromeUtils.import(&quot;resource:///modules/cloudFileAccounts.js&quot;);</span>
<a href="#l11.33"></a><span id="l11.33">     cloudFileAccounts = temp.cloudFileAccounts;</span>
<a href="#l11.34"></a><span id="l11.34"> } catch (e) {</span>
<a href="#l11.35"></a><span id="l11.35">     // This will fail on Seamonkey, but that's ok since the pref for cloudfiles</span>
<a href="#l11.36"></a><span id="l11.36">     // is false, which means the UI will not be shown</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineat">@@ -65,16 +68,24 @@ var gConfig = {</span>
<a href="#l11.38"></a><span id="l11.38">     showTimeAs: null,</span>
<a href="#l11.39"></a><span id="l11.39">     percentComplete: 0</span>
<a href="#l11.40"></a><span id="l11.40"> };</span>
<a href="#l11.41"></a><span id="l11.41"> // The following variables are set by the load handler function of the</span>
<a href="#l11.42"></a><span id="l11.42"> // parent context, so that they are already set before iframe content load:</span>
<a href="#l11.43"></a><span id="l11.43"> //   - gTimezoneEnabled</span>
<a href="#l11.44"></a><span id="l11.44"> //   - gShowLink</span>
<a href="#l11.45"></a><span id="l11.45"> </span>
<a href="#l11.46"></a><span id="l11.46" class="difflineplus">+const gNotification = {};</span>
<a href="#l11.47"></a><span id="l11.47" class="difflineplus">+XPCOMUtils.defineLazyGetter(gNotification, &quot;notificationbox&quot;, () =&gt; {</span>
<a href="#l11.48"></a><span id="l11.48" class="difflineplus">+    return new MozElements.NotificationBox(element =&gt; {</span>
<a href="#l11.49"></a><span id="l11.49" class="difflineplus">+        element.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l11.50"></a><span id="l11.50" class="difflineplus">+        document.getElementById(&quot;status-notifications&quot;).append(element);</span>
<a href="#l11.51"></a><span id="l11.51" class="difflineplus">+    });</span>
<a href="#l11.52"></a><span id="l11.52" class="difflineplus">+});</span>
<a href="#l11.53"></a><span id="l11.53" class="difflineplus">+</span>
<a href="#l11.54"></a><span id="l11.54"> var eventDialogQuitObserver = {</span>
<a href="#l11.55"></a><span id="l11.55">     observe: function(aSubject, aTopic, aData) {</span>
<a href="#l11.56"></a><span id="l11.56">         // Check whether or not we want to veto the quit request (unless another</span>
<a href="#l11.57"></a><span id="l11.57">         // observer already did.</span>
<a href="#l11.58"></a><span id="l11.58">         if (aTopic == &quot;quit-application-requested&quot; &amp;&amp;</span>
<a href="#l11.59"></a><span id="l11.59">             (aSubject instanceof Ci.nsISupportsPRBool) &amp;&amp; !aSubject.data) {</span>
<a href="#l11.60"></a><span id="l11.60">             aSubject.data = !onCancel();</span>
<a href="#l11.61"></a><span id="l11.61">         }</span>
<a href="#l11.62"></a><span id="l11.62" class="difflineat">@@ -2480,53 +2491,52 @@ function attachmentClick(aEvent) {</span>
<a href="#l11.63"></a><span id="l11.63">             showElement(node);</span>
<a href="#l11.64"></a><span id="l11.64">         } else {</span>
<a href="#l11.65"></a><span id="l11.65">             hideElement(node);</span>
<a href="#l11.66"></a><span id="l11.66">         }</span>
<a href="#l11.67"></a><span id="l11.67">     }</span>
<a href="#l11.68"></a><span id="l11.68"> }</span>
<a href="#l11.69"></a><span id="l11.69"> </span>
<a href="#l11.70"></a><span id="l11.70"> /**</span>
<a href="#l11.71"></a><span id="l11.71" class="difflineminus">- * Helper function to show a notification in the event-dialog's notificationBox</span>
<a href="#l11.72"></a><span id="l11.72" class="difflineplus">+ * Helper function to show a notification in the event-dialog's notificationbox</span>
<a href="#l11.73"></a><span id="l11.73">  *</span>
<a href="#l11.74"></a><span id="l11.74">  * @param aMessage     the message text to show</span>
<a href="#l11.75"></a><span id="l11.75">  * @param aValue       string identifying the notification</span>
<a href="#l11.76"></a><span id="l11.76">  * @param aPriority    (optional) the priority of the warning (info, critical), default is 'warn'</span>
<a href="#l11.77"></a><span id="l11.77">  * @param aImage       (optional) URL of image to appear on the notification</span>
<a href="#l11.78"></a><span id="l11.78">  * @param aButtonset   (optional) array of button descriptions to appear on the notification</span>
<a href="#l11.79"></a><span id="l11.79" class="difflineminus">- * @param aCallback    (optional) a function to handle events from the notificationBox</span>
<a href="#l11.80"></a><span id="l11.80" class="difflineplus">+ * @param aCallback    (optional) a function to handle events from the notificationbox</span>
<a href="#l11.81"></a><span id="l11.81">  */</span>
<a href="#l11.82"></a><span id="l11.82"> function notifyUser(aMessage, aValue, aPriority, aImage, aButtonset, aCallback) {</span>
<a href="#l11.83"></a><span id="l11.83" class="difflineminus">-    let notificationBox = document.getElementById(&quot;event-dialog-notifications&quot;);</span>
<a href="#l11.84"></a><span id="l11.84">     // only append, if the notification does not already exist</span>
<a href="#l11.85"></a><span id="l11.85" class="difflineminus">-    if (notificationBox.getNotificationWithValue(aValue) == null) {</span>
<a href="#l11.86"></a><span id="l11.86" class="difflineplus">+    if (gNotification.notificationbox.getNotificationWithValue(aValue) == null) {</span>
<a href="#l11.87"></a><span id="l11.87">         const prioMap = {</span>
<a href="#l11.88"></a><span id="l11.88" class="difflineminus">-            info: notificationBox.PRIORITY_INFO_MEDIUM,</span>
<a href="#l11.89"></a><span id="l11.89" class="difflineminus">-            critical: notificationBox.PRIORITY_CRITICAL_MEDIUM</span>
<a href="#l11.90"></a><span id="l11.90" class="difflineplus">+            info: gNotification.notificationbox.PRIORITY_INFO_MEDIUM,</span>
<a href="#l11.91"></a><span id="l11.91" class="difflineplus">+            critical: gNotification.notificationbox.PRIORITY_CRITICAL_MEDIUM</span>
<a href="#l11.92"></a><span id="l11.92">         };</span>
<a href="#l11.93"></a><span id="l11.93" class="difflineminus">-        let priority = prioMap[aPriority] || notificationBox.PRIORITY_WARNING_MEDIUM;</span>
<a href="#l11.94"></a><span id="l11.94" class="difflineminus">-        notificationBox.appendNotification(aMessage,</span>
<a href="#l11.95"></a><span id="l11.95" class="difflineminus">-                                           aValue,</span>
<a href="#l11.96"></a><span id="l11.96" class="difflineminus">-                                           aImage,</span>
<a href="#l11.97"></a><span id="l11.97" class="difflineminus">-                                           priority,</span>
<a href="#l11.98"></a><span id="l11.98" class="difflineminus">-                                           aButtonset,</span>
<a href="#l11.99"></a><span id="l11.99" class="difflineminus">-                                           aCallback);</span>
<a href="#l11.100"></a><span id="l11.100" class="difflineplus">+        let priority = prioMap[aPriority] ||</span>
<a href="#l11.101"></a><span id="l11.101" class="difflineplus">+                       gNotification.notificationbox.PRIORITY_WARNING_MEDIUM;</span>
<a href="#l11.102"></a><span id="l11.102" class="difflineplus">+        gNotification.notificationbox.appendNotification(aMessage,</span>
<a href="#l11.103"></a><span id="l11.103" class="difflineplus">+                                                         aValue,</span>
<a href="#l11.104"></a><span id="l11.104" class="difflineplus">+                                                         aImage,</span>
<a href="#l11.105"></a><span id="l11.105" class="difflineplus">+                                                         priority,</span>
<a href="#l11.106"></a><span id="l11.106" class="difflineplus">+                                                         aButtonset,</span>
<a href="#l11.107"></a><span id="l11.107" class="difflineplus">+                                                         aCallback);</span>
<a href="#l11.108"></a><span id="l11.108">     }</span>
<a href="#l11.109"></a><span id="l11.109"> }</span>
<a href="#l11.110"></a><span id="l11.110"> </span>
<a href="#l11.111"></a><span id="l11.111"> /**</span>
<a href="#l11.112"></a><span id="l11.112">  * Remove a notification from the notifiactionBox</span>
<a href="#l11.113"></a><span id="l11.113">  *</span>
<a href="#l11.114"></a><span id="l11.114" class="difflineminus">- * @param aValue      string identifying the notification to remove</span>
<a href="#l11.115"></a><span id="l11.115" class="difflineplus">+ * @param {string} aValue    string identifying the notification to remove</span>
<a href="#l11.116"></a><span id="l11.116">  */</span>
<a href="#l11.117"></a><span id="l11.117"> function removeNotification(aValue) {</span>
<a href="#l11.118"></a><span id="l11.118" class="difflineminus">-    let notificationBox = document.getElementById(&quot;event-dialog-notifications&quot;);</span>
<a href="#l11.119"></a><span id="l11.119" class="difflineminus">-    let notification = notificationBox.getNotificationWithValue(aValue);</span>
<a href="#l11.120"></a><span id="l11.120" class="difflineplus">+    let notification = gNotification.notificationbox.getNotificationWithValue(aValue);</span>
<a href="#l11.121"></a><span id="l11.121">     if (notification != null) {</span>
<a href="#l11.122"></a><span id="l11.122" class="difflineminus">-        notificationBox.removeNotification(notification);</span>
<a href="#l11.123"></a><span id="l11.123" class="difflineplus">+        gNotification.notificationbox.removeNotification(notification);</span>
<a href="#l11.124"></a><span id="l11.124">     }</span>
<a href="#l11.125"></a><span id="l11.125"> }</span>
<a href="#l11.126"></a><span id="l11.126"> </span>
<a href="#l11.127"></a><span id="l11.127"> /**</span>
<a href="#l11.128"></a><span id="l11.128">  * Update the dialog controls related to the item's calendar.</span>
<a href="#l11.129"></a><span id="l11.129">  */</span>
<a href="#l11.130"></a><span id="l11.130"> function updateCalendar() {</span>
<a href="#l11.131"></a><span id="l11.131">     let item = window.calendarItem;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/lightning/content/lightning-item-iframe.xul</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-item-iframe.xul</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -132,17 +132,19 @@</span>
<a href="#l12.4"></a><span id="l12.4">               orient=&quot;horizontal&quot;</span>
<a href="#l12.5"></a><span id="l12.5">               disabled=&quot;true&quot;</span>
<a href="#l12.6"></a><span id="l12.6">               class=&quot;counter-buttons&quot;</span>
<a href="#l12.7"></a><span id="l12.7">               accesskey=&quot;&amp;counter.button.original.accesskey;&quot;</span>
<a href="#l12.8"></a><span id="l12.8">               tooltip=&quot;&amp;counter.button.original.tooltip2;&quot; /&gt;</span>
<a href="#l12.9"></a><span id="l12.9">     &lt;/vbox&gt;</span>
<a href="#l12.10"></a><span id="l12.10">   &lt;/hbox&gt;</span>
<a href="#l12.11"></a><span id="l12.11"> </span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  &lt;notificationbox id=&quot;event-dialog-notifications&quot; notificationside=&quot;top&quot;/&gt;</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+  &lt;hbox id=&quot;event-dialog-notifications&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+    &lt;!-- notificationbox will be added here lazily. --&gt;</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+  &lt;/hbox&gt;</span>
<a href="#l12.16"></a><span id="l12.16"> </span>
<a href="#l12.17"></a><span id="l12.17">   &lt;grid id=&quot;event-grid&quot;</span>
<a href="#l12.18"></a><span id="l12.18">         flex=&quot;1&quot;</span>
<a href="#l12.19"></a><span id="l12.19">         style=&quot;padding-top: 8px; padding-bottom: 10px; padding-inline-start: 8px; padding-inline-end: 10px;&quot;&gt;</span>
<a href="#l12.20"></a><span id="l12.20">     &lt;columns id=&quot;event-grid-columns&quot;&gt;</span>
<a href="#l12.21"></a><span id="l12.21">         &lt;column id=&quot;event-description-column&quot;/&gt;</span>
<a href="#l12.22"></a><span id="l12.22">         &lt;column id=&quot;event-controls-column&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l12.23"></a><span id="l12.23">     &lt;/columns&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/lightning/content/lightning-utils.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-utils.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -1,22 +1,25 @@</span>
<a href="#l13.4"></a><span id="l13.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l13.5"></a><span id="l13.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l13.6"></a><span id="l13.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l13.7"></a><span id="l13.7"> </span>
<a href="#l13.8"></a><span id="l13.8"> /* exported ltnInitMailIdentitiesRow, ltnGetMailIdentitySelection,</span>
<a href="#l13.9"></a><span id="l13.9">  *          ltnSaveMailIdentitySelection, ltnNotifyOnIdentitySelection</span>
<a href="#l13.10"></a><span id="l13.10">  */</span>
<a href="#l13.11"></a><span id="l13.11"> </span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+/* global MozElements */</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+</span>
<a href="#l13.14"></a><span id="l13.14"> /* import-globals-from ../../base/content/calendar-ui-utils.js */</span>
<a href="#l13.15"></a><span id="l13.15"> /* globals gCalendar */</span>
<a href="#l13.16"></a><span id="l13.16"> </span>
<a href="#l13.17"></a><span id="l13.17"> var { fixIterator } = ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l13.18"></a><span id="l13.18"> var { MailServices } = ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l13.19"></a><span id="l13.19"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l13.20"></a><span id="l13.20" class="difflineplus">+var { XPCOMUtils } = ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l13.21"></a><span id="l13.21"> </span>
<a href="#l13.22"></a><span id="l13.22"> /**</span>
<a href="#l13.23"></a><span id="l13.23">  * Initializing the email identity row</span>
<a href="#l13.24"></a><span id="l13.24">  * (shared between calendar creation wizard and properties dialog)</span>
<a href="#l13.25"></a><span id="l13.25">  */</span>
<a href="#l13.26"></a><span id="l13.26"> function ltnInitMailIdentitiesRow() {</span>
<a href="#l13.27"></a><span id="l13.27">     if (!gCalendar) {</span>
<a href="#l13.28"></a><span id="l13.28">         collapseElement(&quot;calendar-email-identity-row&quot;);</span>
<a href="#l13.29"></a><span id="l13.29" class="difflineat">@@ -97,23 +100,30 @@ function ltnSaveMailIdentitySelection() </span>
<a href="#l13.30"></a><span id="l13.30">     }</span>
<a href="#l13.31"></a><span id="l13.31"> }</span>
<a href="#l13.32"></a><span id="l13.32"> </span>
<a href="#l13.33"></a><span id="l13.33"> /**</span>
<a href="#l13.34"></a><span id="l13.34">  * Displays a warning if the user doesn't assign an email identity to a calendar</span>
<a href="#l13.35"></a><span id="l13.35">  * (shared between calendar creation wizard and properties dialog)</span>
<a href="#l13.36"></a><span id="l13.36">  */</span>
<a href="#l13.37"></a><span id="l13.37"> function ltnNotifyOnIdentitySelection() {</span>
<a href="#l13.38"></a><span id="l13.38" class="difflineminus">-    let notificationBox = document.getElementById(&quot;no-identity-notification&quot;);</span>
<a href="#l13.39"></a><span id="l13.39" class="difflineplus">+    let gNotification = {};</span>
<a href="#l13.40"></a><span id="l13.40" class="difflineplus">+    XPCOMUtils.defineLazyGetter(gNotification, &quot;notificationbox&quot;, () =&gt; {</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineplus">+        return new MozElements.NotificationBox(element =&gt; {</span>
<a href="#l13.42"></a><span id="l13.42" class="difflineplus">+            element.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l13.43"></a><span id="l13.43" class="difflineplus">+            document.getElementById(&quot;no-identity-notification&quot;).append(element);</span>
<a href="#l13.44"></a><span id="l13.44" class="difflineplus">+        });</span>
<a href="#l13.45"></a><span id="l13.45" class="difflineplus">+    });</span>
<a href="#l13.46"></a><span id="l13.46" class="difflineplus">+</span>
<a href="#l13.47"></a><span id="l13.47">     let msg = cal.l10n.getLtnString(&quot;noIdentitySelectedNotification&quot;);</span>
<a href="#l13.48"></a><span id="l13.48">     let sel = ltnGetMailIdentitySelection();</span>
<a href="#l13.49"></a><span id="l13.49"> </span>
<a href="#l13.50"></a><span id="l13.50">     if (sel == &quot;none&quot;) {</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineminus">-        notificationBox.appendNotification(</span>
<a href="#l13.52"></a><span id="l13.52" class="difflineplus">+        gNotification.notificationbox.appendNotification(</span>
<a href="#l13.53"></a><span id="l13.53">             msg,</span>
<a href="#l13.54"></a><span id="l13.54">             &quot;noIdentitySelected&quot;,</span>
<a href="#l13.55"></a><span id="l13.55">             null,</span>
<a href="#l13.56"></a><span id="l13.56" class="difflineminus">-            notificationBox.PRIORITY_WARNING_MEDIUM</span>
<a href="#l13.57"></a><span id="l13.57" class="difflineplus">+            gNotification.notificationbox.PRIORITY_WARNING_MEDIUM</span>
<a href="#l13.58"></a><span id="l13.58">         );</span>
<a href="#l13.59"></a><span id="l13.59">     } else {</span>
<a href="#l13.60"></a><span id="l13.60" class="difflineminus">-        notificationBox.removeAllNotifications();</span>
<a href="#l13.61"></a><span id="l13.61" class="difflineplus">+        gNotification.notificationbox.removeAllNotifications();</span>
<a href="#l13.62"></a><span id="l13.62">     }</span>
<a href="#l13.63"></a><span id="l13.63"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/providers/gdata/content/gdata-event-dialog-reminder.css</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/providers/gdata/content/gdata-event-dialog-reminder.css</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -1,11 +1,7 @@</span>
<a href="#l14.4"></a><span id="l14.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l14.5"></a><span id="l14.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l14.6"></a><span id="l14.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l14.7"></a><span id="l14.7"> </span>
<a href="#l14.8"></a><span id="l14.8"> .reminder-icon[value=&quot;SMS&quot;] {</span>
<a href="#l14.9"></a><span id="l14.9">   list-style-image: url(chrome://gdata-provider/skin/reminder-action-sms.svg);</span>
<a href="#l14.10"></a><span id="l14.10"> }</span>
<a href="#l14.11"></a><span id="l14.11" class="difflineminus">-</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-#reminder-notifications &gt; xbl-notification[type=&quot;critical&quot;] {</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-  background-color: #d70022;</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/calendar/providers/gdata/content/gdata-event-dialog-reminder.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/calendar/providers/gdata/content/gdata-event-dialog-reminder.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -1,64 +1,72 @@</span>
<a href="#l15.4"></a><span id="l15.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l15.5"></a><span id="l15.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l15.6"></a><span id="l15.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l15.7"></a><span id="l15.7"> </span>
<a href="#l15.8"></a><span id="l15.8" class="difflineplus">+/* global MozElements */</span>
<a href="#l15.9"></a><span id="l15.9" class="difflineplus">+</span>
<a href="#l15.10"></a><span id="l15.10"> /* import-globals-from ../../../base/content/dialogs/calendar-event-dialog-reminder.js */</span>
<a href="#l15.11"></a><span id="l15.11"> </span>
<a href="#l15.12"></a><span id="l15.12"> (function() {</span>
<a href="#l15.13"></a><span id="l15.13">     const FOUR_WEEKS_BEFORE = -2419200;</span>
<a href="#l15.14"></a><span id="l15.14">     const { cal } = ChromeUtils.import(&quot;resource://gdata-provider/modules/calUtilsShim.jsm&quot;);</span>
<a href="#l15.15"></a><span id="l15.15">     const {</span>
<a href="#l15.16"></a><span id="l15.16">         monkeyPatch,</span>
<a href="#l15.17"></a><span id="l15.17">         getProviderString,</span>
<a href="#l15.18"></a><span id="l15.18">     } = ChromeUtils.import(&quot;resource://gdata-provider/modules/gdataUtils.jsm&quot;);</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineplus">+    const { XPCOMUtils } = ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineplus">+</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineplus">+    XPCOMUtils.defineLazyGetter(this, &quot;notificationbox&quot;, () =&gt; {</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineplus">+        return new MozElements.NotificationBox(element =&gt; {</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineplus">+            element.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineplus">+            document.getElementById(&quot;reminder-notifications&quot;).append(element);</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineplus">+        });</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineplus">+    });</span>
<a href="#l15.27"></a><span id="l15.27"> </span>
<a href="#l15.28"></a><span id="l15.28">     // NOTE: This function exits early if its not a gdata calendar</span>
<a href="#l15.29"></a><span id="l15.29">     let item = window.arguments[0].item;</span>
<a href="#l15.30"></a><span id="l15.30">     let calendar = window.arguments[0].calendar;</span>
<a href="#l15.31"></a><span id="l15.31">     if (calendar.type != &quot;gdata&quot;) {</span>
<a href="#l15.32"></a><span id="l15.32">         return;</span>
<a href="#l15.33"></a><span id="l15.33">     }</span>
<a href="#l15.34"></a><span id="l15.34"> </span>
<a href="#l15.35"></a><span id="l15.35">     let label = getProviderString(&quot;reminderOutOfRange&quot;);</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineminus">-    let notification = document.createXULElement(&quot;xbl-notification&quot;);</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineminus">-    notification.setAttribute(&quot;label&quot;, label);</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineminus">-    notification.setAttribute(&quot;type&quot;, &quot;critical&quot;);</span>
<a href="#l15.39"></a><span id="l15.39" class="difflineminus">-    notification.setAttribute(&quot;hideclose&quot;, &quot;true&quot;);</span>
<a href="#l15.40"></a><span id="l15.40"> </span>
<a href="#l15.41"></a><span id="l15.41">     function checkReminderRange(reminder) {</span>
<a href="#l15.42"></a><span id="l15.42">         let offset = cal.alarms.calculateAlarmOffset(item, reminder);</span>
<a href="#l15.43"></a><span id="l15.43">         let seconds = offset.inSeconds;</span>
<a href="#l15.44"></a><span id="l15.44">         return (seconds &lt; 1 &amp;&amp; seconds &gt;= FOUR_WEEKS_BEFORE);</span>
<a href="#l15.45"></a><span id="l15.45">     }</span>
<a href="#l15.46"></a><span id="l15.46"> </span>
<a href="#l15.47"></a><span id="l15.47">     function checkAllReminders() {</span>
<a href="#l15.48"></a><span id="l15.48">         let listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l15.49"></a><span id="l15.49" class="difflineminus">-        let notificationbox = document.getElementById(&quot;reminder-notifications&quot;);</span>
<a href="#l15.50"></a><span id="l15.50"> </span>
<a href="#l15.51"></a><span id="l15.51">         let validated = true;</span>
<a href="#l15.52"></a><span id="l15.52">         for (let node of listbox.childNodes) {</span>
<a href="#l15.53"></a><span id="l15.53">             validated = validated &amp;&amp; checkReminderRange(node.reminder);</span>
<a href="#l15.54"></a><span id="l15.54">             if (!validated) {</span>
<a href="#l15.55"></a><span id="l15.55">                 break;</span>
<a href="#l15.56"></a><span id="l15.56">             }</span>
<a href="#l15.57"></a><span id="l15.57">         }</span>
<a href="#l15.58"></a><span id="l15.58"> </span>
<a href="#l15.59"></a><span id="l15.59">         let acceptButton = document.documentElement.getButton(&quot;accept&quot;);</span>
<a href="#l15.60"></a><span id="l15.60">         acceptButton.disabled = !validated;</span>
<a href="#l15.61"></a><span id="l15.61"> </span>
<a href="#l15.62"></a><span id="l15.62">         if (validated) {</span>
<a href="#l15.63"></a><span id="l15.63" class="difflineminus">-            try {</span>
<a href="#l15.64"></a><span id="l15.64" class="difflineminus">-                notificationbox.removeNotification(notification);</span>
<a href="#l15.65"></a><span id="l15.65" class="difflineminus">-            } catch (e) {</span>
<a href="#l15.66"></a><span id="l15.66" class="difflineminus">-                // Ok to swallow if it hasn't been added yet.</span>
<a href="#l15.67"></a><span id="l15.67" class="difflineminus">-            }</span>
<a href="#l15.68"></a><span id="l15.68" class="difflineplus">+            this.notificationbox.removeAllNotifications();</span>
<a href="#l15.69"></a><span id="l15.69">         } else {</span>
<a href="#l15.70"></a><span id="l15.70" class="difflineminus">-            notificationbox.appendChild(notification);</span>
<a href="#l15.71"></a><span id="l15.71" class="difflineplus">+            let notification = this.notificationbox.appendNotification(</span>
<a href="#l15.72"></a><span id="l15.72" class="difflineplus">+                label,</span>
<a href="#l15.73"></a><span id="l15.73" class="difflineplus">+                &quot;reminderNotification&quot;,</span>
<a href="#l15.74"></a><span id="l15.74" class="difflineplus">+                null,</span>
<a href="#l15.75"></a><span id="l15.75" class="difflineplus">+                this.notificationbox.PRIORITY_CRITICAL_HIGH);</span>
<a href="#l15.76"></a><span id="l15.76" class="difflineplus">+</span>
<a href="#l15.77"></a><span id="l15.77" class="difflineplus">+            let closeButton = notification.messageDetails.nextSibling;</span>
<a href="#l15.78"></a><span id="l15.78" class="difflineplus">+            closeButton.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l15.79"></a><span id="l15.79">         }</span>
<a href="#l15.80"></a><span id="l15.80">     }</span>
<a href="#l15.81"></a><span id="l15.81"> </span>
<a href="#l15.82"></a><span id="l15.82">     /**</span>
<a href="#l15.83"></a><span id="l15.83">      * Hides the &quot;after the event starts&quot; reminder relations, these are not</span>
<a href="#l15.84"></a><span id="l15.84">      * supported by Google.</span>
<a href="#l15.85"></a><span id="l15.85">      */</span>
<a href="#l15.86"></a><span id="l15.86">     function hideReminderRelations() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/calendar/providers/gdata/content/gdata-event-dialog-reminder.xul</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/calendar/providers/gdata/content/gdata-event-dialog-reminder.xul</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -1,13 +1,14 @@</span>
<a href="#l16.4"></a><span id="l16.4"> &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<a href="#l16.5"></a><span id="l16.5"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l16.6"></a><span id="l16.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l16.7"></a><span id="l16.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l16.8"></a><span id="l16.8"> </span>
<a href="#l16.9"></a><span id="l16.9" class="difflineplus">+&lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://messenger/content/notification.css&quot;?&gt;</span>
<a href="#l16.10"></a><span id="l16.10"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://gdata-provider/skin/gdata-event-dialog-reminder.css&quot;?&gt;</span>
<a href="#l16.11"></a><span id="l16.11"> </span>
<a href="#l16.12"></a><span id="l16.12"> &lt;!DOCTYPE overlay SYSTEM &quot;chrome://gdata-provider/locale/gdata.dtd&quot;&gt;</span>
<a href="#l16.13"></a><span id="l16.13"> </span>
<a href="#l16.14"></a><span id="l16.14"> &lt;overlay id=&quot;gdata-event-dialog-reminder-overlay&quot;</span>
<a href="#l16.15"></a><span id="l16.15">          xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot; xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span>
<a href="#l16.16"></a><span id="l16.16">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://gdata-provider/content/gdata-event-dialog-reminder.js&quot;/&gt;</span>
<a href="#l16.17"></a><span id="l16.17">   &lt;menupopup id=&quot;reminder-actions-menupopup&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/calendar/resources/content/calendarCreation.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/calendar/resources/content/calendarCreation.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -2,32 +2,43 @@</span>
<a href="#l17.4"></a><span id="l17.4">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l17.5"></a><span id="l17.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l17.6"></a><span id="l17.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l17.7"></a><span id="l17.7"> </span>
<a href="#l17.8"></a><span id="l17.8"> /* exported onLoad, initLocationPage, initCustomizePage, onSelectProvider,</span>
<a href="#l17.9"></a><span id="l17.9">  *          onInitialAdvance, doCreateCalendar, setCanRewindFalse</span>
<a href="#l17.10"></a><span id="l17.10">  */</span>
<a href="#l17.11"></a><span id="l17.11"> </span>
<a href="#l17.12"></a><span id="l17.12" class="difflineplus">+/* global MozElements */</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+</span>
<a href="#l17.14"></a><span id="l17.14"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l17.15"></a><span id="l17.15"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineplus">+var { XPCOMUtils } = ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l17.17"></a><span id="l17.17"> </span>
<a href="#l17.18"></a><span id="l17.18"> var gCalendar;</span>
<a href="#l17.19"></a><span id="l17.19"> </span>
<a href="#l17.20"></a><span id="l17.20"> var errorConstants = {</span>
<a href="#l17.21"></a><span id="l17.21">     SUCCESS: 0,</span>
<a href="#l17.22"></a><span id="l17.22">     INVALID_URI: 1,</span>
<a href="#l17.23"></a><span id="l17.23">     ALREADY_EXISTS: 2</span>
<a href="#l17.24"></a><span id="l17.24"> };</span>
<a href="#l17.25"></a><span id="l17.25"> </span>
<a href="#l17.26"></a><span id="l17.26"> var l10nStrings = {};</span>
<a href="#l17.27"></a><span id="l17.27"> l10nStrings[errorConstants.SUCCESS] = &quot;&quot;;</span>
<a href="#l17.28"></a><span id="l17.28"> l10nStrings[errorConstants.INVALID_URI] = cal.l10n.getString(&quot;calendarCreation&quot;, &quot;error.invalidUri&quot;);</span>
<a href="#l17.29"></a><span id="l17.29"> l10nStrings[errorConstants.ALREADY_EXISTS] = cal.l10n.getString(&quot;calendarCreation&quot;, &quot;error.alreadyExists&quot;);</span>
<a href="#l17.30"></a><span id="l17.30"> </span>
<a href="#l17.31"></a><span id="l17.31" class="difflineplus">+var gNotification = {};</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineplus">+XPCOMUtils.defineLazyGetter(gNotification, &quot;notificationbox&quot;, () =&gt; {</span>
<a href="#l17.33"></a><span id="l17.33" class="difflineplus">+    return new MozElements.NotificationBox(element =&gt; {</span>
<a href="#l17.34"></a><span id="l17.34" class="difflineplus">+        element.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l17.35"></a><span id="l17.35" class="difflineplus">+        document.getElementById(&quot;calendar-notification-location&quot;).append(element);</span>
<a href="#l17.36"></a><span id="l17.36" class="difflineplus">+    });</span>
<a href="#l17.37"></a><span id="l17.37" class="difflineplus">+});</span>
<a href="#l17.38"></a><span id="l17.38" class="difflineplus">+</span>
<a href="#l17.39"></a><span id="l17.39"> function onLoad() {</span>
<a href="#l17.40"></a><span id="l17.40">     // The functions referred to here are not the ones in this file,</span>
<a href="#l17.41"></a><span id="l17.41">     // that's why this code is in an onload handler.</span>
<a href="#l17.42"></a><span id="l17.42">     // See lightning-calendar-creation.js.</span>
<a href="#l17.43"></a><span id="l17.43">     let initialPage = document.getElementById(&quot;initialPage&quot;);</span>
<a href="#l17.44"></a><span id="l17.44">     initialPage.addEventListener(&quot;pageshow&quot;, checkRequired);</span>
<a href="#l17.45"></a><span id="l17.45">     initialPage.addEventListener(&quot;pageadvanced&quot;, onInitialAdvance);</span>
<a href="#l17.46"></a><span id="l17.46"> </span>
<a href="#l17.47"></a><span id="l17.47" class="difflineat">@@ -54,50 +65,49 @@ function initLocationPage() {</span>
<a href="#l17.48"></a><span id="l17.48">  * Initialize the customize page</span>
<a href="#l17.49"></a><span id="l17.49">  */</span>
<a href="#l17.50"></a><span id="l17.50"> function initCustomizePage() {</span>
<a href="#l17.51"></a><span id="l17.51">     initNameFromURI();</span>
<a href="#l17.52"></a><span id="l17.52">     checkRequired();</span>
<a href="#l17.53"></a><span id="l17.53"> </span>
<a href="#l17.54"></a><span id="l17.54">     let suppressAlarmsRow = document.getElementById(&quot;customize-suppressAlarms-row&quot;);</span>
<a href="#l17.55"></a><span id="l17.55">     suppressAlarmsRow.hidden =</span>
<a href="#l17.56"></a><span id="l17.56" class="difflineminus">-        gCalendar &amp;&amp; gCalendar.getProperty(&quot;capabilities.alarms.popup.supported&quot;) === false;</span>
<a href="#l17.57"></a><span id="l17.57" class="difflineplus">+    gCalendar &amp;&amp; gCalendar.getProperty(&quot;capabilities.alarms.popup.supported&quot;) === false;</span>
<a href="#l17.58"></a><span id="l17.58">     document.getElementById(&quot;calendar-color&quot;).value = &quot;#A8C2E1&quot;;</span>
<a href="#l17.59"></a><span id="l17.59"> }</span>
<a href="#l17.60"></a><span id="l17.60"> </span>
<a href="#l17.61"></a><span id="l17.61"> /**</span>
<a href="#l17.62"></a><span id="l17.62">  * Sets up notifications for the location page. On aReason == SUCCESS, all</span>
<a href="#l17.63"></a><span id="l17.63">  * notifications are removed. Otherwise, the respective notification is added to</span>
<a href="#l17.64"></a><span id="l17.64">  * the notification box. Only one notification per reason will be shown.</span>
<a href="#l17.65"></a><span id="l17.65">  *</span>
<a href="#l17.66"></a><span id="l17.66" class="difflineminus">- * @param aReason           The reason of notification, one of |errorConstants|.</span>
<a href="#l17.67"></a><span id="l17.67" class="difflineplus">+ * @param {errorConstants} aReason   The reason of notification, one of |errorConstants|.</span>
<a href="#l17.68"></a><span id="l17.68">  */</span>
<a href="#l17.69"></a><span id="l17.69"> function setNotification(aReason) {</span>
<a href="#l17.70"></a><span id="l17.70" class="difflineminus">-    let notificationBox = document.getElementById(&quot;location-notifications&quot;);</span>
<a href="#l17.71"></a><span id="l17.71" class="difflineminus">-</span>
<a href="#l17.72"></a><span id="l17.72">     if (aReason == errorConstants.SUCCESS) {</span>
<a href="#l17.73"></a><span id="l17.73" class="difflineminus">-        notificationBox.removeAllNotifications();</span>
<a href="#l17.74"></a><span id="l17.74" class="difflineplus">+        gNotification.notificationbox.removeAllNotifications();</span>
<a href="#l17.75"></a><span id="l17.75">     } else {</span>
<a href="#l17.76"></a><span id="l17.76" class="difflineminus">-        let existingBox = notificationBox.getNotificationWithValue(aReason);</span>
<a href="#l17.77"></a><span id="l17.77" class="difflineplus">+        let existingBox = gNotification.notificationbox.getNotificationWithValue(aReason);</span>
<a href="#l17.78"></a><span id="l17.78">         if (!existingBox) {</span>
<a href="#l17.79"></a><span id="l17.79" class="difflineminus">-            notificationBox.appendNotification(l10nStrings[aReason],</span>
<a href="#l17.80"></a><span id="l17.80" class="difflineminus">-                                               aReason,</span>
<a href="#l17.81"></a><span id="l17.81" class="difflineminus">-                                               null,</span>
<a href="#l17.82"></a><span id="l17.82" class="difflineminus">-                                               notificationBox.PRIORITY_WARNING_MEDIUM,</span>
<a href="#l17.83"></a><span id="l17.83" class="difflineminus">-                                               null);</span>
<a href="#l17.84"></a><span id="l17.84" class="difflineminus">-            notificationBox.getNotificationWithValue(aReason).setAttribute(&quot;hideclose&quot;, &quot;true&quot;);</span>
<a href="#l17.85"></a><span id="l17.85" class="difflineplus">+            gNotification.notificationbox.appendNotification(l10nStrings[aReason],</span>
<a href="#l17.86"></a><span id="l17.86" class="difflineplus">+                aReason,</span>
<a href="#l17.87"></a><span id="l17.87" class="difflineplus">+                null,</span>
<a href="#l17.88"></a><span id="l17.88" class="difflineplus">+                gNotification.notificationbox.PRIORITY_WARNING_MEDIUM,</span>
<a href="#l17.89"></a><span id="l17.89" class="difflineplus">+                null);</span>
<a href="#l17.90"></a><span id="l17.90" class="difflineplus">+            gNotification.notificationbox.getNotificationWithValue(aReason)</span>
<a href="#l17.91"></a><span id="l17.91" class="difflineplus">+                .setAttribute(&quot;hideclose&quot;, &quot;true&quot;);</span>
<a href="#l17.92"></a><span id="l17.92">         }</span>
<a href="#l17.93"></a><span id="l17.93">     }</span>
<a href="#l17.94"></a><span id="l17.94"> }</span>
<a href="#l17.95"></a><span id="l17.95"> </span>
<a href="#l17.96"></a><span id="l17.96"> /**</span>
<a href="#l17.97"></a><span id="l17.97">  * Called when a provider is selected in the network calendar list. Makes sure</span>
<a href="#l17.98"></a><span id="l17.98">  * the page is set up for the provider.</span>
<a href="#l17.99"></a><span id="l17.99">  *</span>
<a href="#l17.100"></a><span id="l17.100" class="difflineminus">- * @param type      The provider type selected</span>
<a href="#l17.101"></a><span id="l17.101" class="difflineplus">+ * @param {string} type   The provider type selected</span>
<a href="#l17.102"></a><span id="l17.102">  */</span>
<a href="#l17.103"></a><span id="l17.103"> function onSelectProvider(type) {</span>
<a href="#l17.104"></a><span id="l17.104">     let cache = document.getElementById(&quot;cache&quot;);</span>
<a href="#l17.105"></a><span id="l17.105">     let tempCal;</span>
<a href="#l17.106"></a><span id="l17.106">     try {</span>
<a href="#l17.107"></a><span id="l17.107">         tempCal = Cc[&quot;@mozilla.org/calendar/calendar;1?type=&quot; + type].createInstance(Ci.calICalendar);</span>
<a href="#l17.108"></a><span id="l17.108">     } catch (e) {</span>
<a href="#l17.109"></a><span id="l17.109">         // keep tempCal undefined if the calendar can not be created</span>
<a href="#l17.110"></a><span id="l17.110" class="difflineat">@@ -124,25 +134,24 @@ function checkRequired() {</span>
<a href="#l17.111"></a><span id="l17.111">     let canAdvance = true;</span>
<a href="#l17.112"></a><span id="l17.112">     let curPage = document.getElementById(&quot;calendar-wizard&quot;).currentPage;</span>
<a href="#l17.113"></a><span id="l17.113">     if (curPage) {</span>
<a href="#l17.114"></a><span id="l17.114">         let eList = curPage.getElementsByAttribute(&quot;required&quot;, &quot;true&quot;);</span>
<a href="#l17.115"></a><span id="l17.115">         for (let i = 0; i &lt; eList.length &amp;&amp; canAdvance; ++i) {</span>
<a href="#l17.116"></a><span id="l17.116">             canAdvance = (eList[i].value != &quot;&quot;);</span>
<a href="#l17.117"></a><span id="l17.117">         }</span>
<a href="#l17.118"></a><span id="l17.118"> </span>
<a href="#l17.119"></a><span id="l17.119" class="difflineminus">-        let notificationbox = document.getElementById(&quot;location-notifications&quot;);</span>
<a href="#l17.120"></a><span id="l17.120">         if (canAdvance &amp;&amp; document.getElementById(&quot;calendar-uri&quot;).value &amp;&amp;</span>
<a href="#l17.121"></a><span id="l17.121">             curPage.pageid == &quot;locationPage&quot;) {</span>
<a href="#l17.122"></a><span id="l17.122">             // eslint-disable-next-line array-bracket-spacing</span>
<a href="#l17.123"></a><span id="l17.123">             let [reason, ] = parseUri(document.getElementById(&quot;calendar-uri&quot;).value);</span>
<a href="#l17.124"></a><span id="l17.124">             canAdvance = (reason == errorConstants.SUCCESS);</span>
<a href="#l17.125"></a><span id="l17.125">             setNotification(reason);</span>
<a href="#l17.126"></a><span id="l17.126">         } else {</span>
<a href="#l17.127"></a><span id="l17.127" class="difflineminus">-            notificationbox.removeAllNotifications();</span>
<a href="#l17.128"></a><span id="l17.128" class="difflineplus">+            gNotification.notificationbox.removeAllNotifications();</span>
<a href="#l17.129"></a><span id="l17.129">         }</span>
<a href="#l17.130"></a><span id="l17.130">         document.getElementById(&quot;calendar-wizard&quot;).canAdvance = canAdvance;</span>
<a href="#l17.131"></a><span id="l17.131">     }</span>
<a href="#l17.132"></a><span id="l17.132"> }</span>
<a href="#l17.133"></a><span id="l17.133"> </span>
<a href="#l17.134"></a><span id="l17.134"> /**</span>
<a href="#l17.135"></a><span id="l17.135">  * Handler function called when the advance button is pressed on the initial</span>
<a href="#l17.136"></a><span id="l17.136">  * wizard page</span>
<a href="#l17.137"></a><span id="l17.137" class="difflineat">@@ -227,17 +236,17 @@ function initNameFromURI() {</span>
<a href="#l17.138"></a><span id="l17.138">         nameField.value = decodeURIComponent(captures[1]);</span>
<a href="#l17.139"></a><span id="l17.139">     }</span>
<a href="#l17.140"></a><span id="l17.140"> }</span>
<a href="#l17.141"></a><span id="l17.141"> </span>
<a href="#l17.142"></a><span id="l17.142"> /**</span>
<a href="#l17.143"></a><span id="l17.143">  * Parses the given uri value to check if it is valid and there is not already</span>
<a href="#l17.144"></a><span id="l17.144">  * a calendar with this uri.</span>
<a href="#l17.145"></a><span id="l17.145">  *</span>
<a href="#l17.146"></a><span id="l17.146" class="difflineminus">- * @param aUri              The string to parse as an uri.</span>
<a href="#l17.147"></a><span id="l17.147" class="difflineplus">+ * @param {string} aUri     The string to parse as an uri.</span>
<a href="#l17.148"></a><span id="l17.148">  * @return [error, uri]     |error| is the error code from errorConstants,</span>
<a href="#l17.149"></a><span id="l17.149">  *                          |uri| the parsed nsIURI, or null on error.</span>
<a href="#l17.150"></a><span id="l17.150">  */</span>
<a href="#l17.151"></a><span id="l17.151"> function parseUri(aUri) {</span>
<a href="#l17.152"></a><span id="l17.152">     let uri;</span>
<a href="#l17.153"></a><span id="l17.153">     try {</span>
<a href="#l17.154"></a><span id="l17.154">         // Test if the entered uri can be parsed.</span>
<a href="#l17.155"></a><span id="l17.155">         uri = Services.io.newURI(aUri);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/calendar/resources/content/calendarCreation.xul</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/calendar/resources/content/calendarCreation.xul</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -1,15 +1,16 @@</span>
<a href="#l18.4"></a><span id="l18.4"> &lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l18.5"></a><span id="l18.5"> &lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l18.6"></a><span id="l18.6">    - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l18.7"></a><span id="l18.7">    - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l18.8"></a><span id="l18.8"> </span>
<a href="#l18.9"></a><span id="l18.9"> &lt;?xml-stylesheet href=&quot;chrome://global/skin/&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l18.10"></a><span id="l18.10"> &lt;?xml-stylesheet href=&quot;chrome://messenger/content/bindings.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l18.11"></a><span id="l18.11" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://messenger/content/notification.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l18.12"></a><span id="l18.12"> &lt;?xml-stylesheet href=&quot;chrome://calendar-common/skin/calendar-creation-wizard.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l18.13"></a><span id="l18.13"> </span>
<a href="#l18.14"></a><span id="l18.14"> &lt;!DOCTYPE dialog [</span>
<a href="#l18.15"></a><span id="l18.15">   &lt;!ENTITY % dtd1 SYSTEM &quot;chrome://calendar/locale/calendarCreation.dtd&quot; &gt; %dtd1;</span>
<a href="#l18.16"></a><span id="l18.16">   &lt;!ENTITY % dtd2 SYSTEM &quot;chrome://calendar/locale/calendar.dtd&quot; &gt; %dtd2;</span>
<a href="#l18.17"></a><span id="l18.17"> ]&gt;</span>
<a href="#l18.18"></a><span id="l18.18"> </span>
<a href="#l18.19"></a><span id="l18.19"> &lt;wizard id=&quot;calendar-wizard&quot;</span>
<a href="#l18.20"></a><span id="l18.20" class="difflineat">@@ -62,17 +63,21 @@</span>
<a href="#l18.21"></a><span id="l18.21">                    oninput=&quot;checkRequired();&quot;/&gt;</span>
<a href="#l18.22"></a><span id="l18.22">         &lt;/row&gt;</span>
<a href="#l18.23"></a><span id="l18.23">         &lt;row&gt;</span>
<a href="#l18.24"></a><span id="l18.24">           &lt;label/&gt;</span>
<a href="#l18.25"></a><span id="l18.25">           &lt;checkbox id=&quot;cache&quot;</span>
<a href="#l18.26"></a><span id="l18.26">                     checked=&quot;true&quot;</span>
<a href="#l18.27"></a><span id="l18.27">                     label=&quot;&amp;calendarproperties.cache3.label;&quot;/&gt;</span>
<a href="#l18.28"></a><span id="l18.28">         &lt;/row&gt;</span>
<a href="#l18.29"></a><span id="l18.29" class="difflineminus">-        &lt;notificationbox id=&quot;location-notifications&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineplus">+        &lt;hbox id=&quot;calendar-notification-location&quot;</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineplus">+              class=&quot;notification-inline&quot;</span>
<a href="#l18.32"></a><span id="l18.32" class="difflineplus">+              flex=&quot;1&quot;&gt;</span>
<a href="#l18.33"></a><span id="l18.33" class="difflineplus">+          &lt;!-- notificationbox will be added here lazily. --&gt;</span>
<a href="#l18.34"></a><span id="l18.34" class="difflineplus">+        &lt;/hbox&gt;</span>
<a href="#l18.35"></a><span id="l18.35">         &lt;!--</span>
<a href="#l18.36"></a><span id="l18.36">         &lt;description&gt;&amp;locationpage.login.description;&lt;/description&gt;</span>
<a href="#l18.37"></a><span id="l18.37">         &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l18.38"></a><span id="l18.38">           &lt;label value=&quot;&amp;locationpage.username.label;&quot; control=&quot;calendar-username&quot;/&gt;</span>
<a href="#l18.39"></a><span id="l18.39">           &lt;textbox id=&quot;calendar-username&quot;/&gt;</span>
<a href="#l18.40"></a><span id="l18.40">         &lt;/row&gt;</span>
<a href="#l18.41"></a><span id="l18.41">         &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l18.42"></a><span id="l18.42">           &lt;label value=&quot;&amp;locationpage.password.label;&quot; control=&quot;calendar-password&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1">deleted file mode 100644</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineminus">--- a/common/bindings/notificationbox.xml</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineplus">+++ /dev/null</span>
<a href="#l19.4"></a><span id="l19.4" class="difflineat">@@ -1,498 +0,0 @@</span>
<a href="#l19.5"></a><span id="l19.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l19.6"></a><span id="l19.6" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l19.7"></a><span id="l19.7" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l19.8"></a><span id="l19.8" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l19.9"></a><span id="l19.9" class="difflineminus">-</span>
<a href="#l19.10"></a><span id="l19.10" class="difflineminus">-</span>
<a href="#l19.11"></a><span id="l19.11" class="difflineminus">-&lt;!DOCTYPE bindings [</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-&lt;!ENTITY % notificationDTD SYSTEM &quot;chrome://global/locale/notification.dtd&quot;&gt;</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineminus">-%notificationDTD;</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineminus">-]&gt;</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineminus">-</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineminus">-&lt;bindings id=&quot;notificationboxBindings&quot;</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineminus">-          xmlns=&quot;http://www.mozilla.org/xbl&quot;</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineminus">-          xmlns:xbl=&quot;http://www.mozilla.org/xbl&quot;</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineminus">-          xmlns:xul=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineminus">-          xmlns:html = &quot;http://www.w3.org/1999/xhtml&quot;&gt;</span>
<a href="#l19.21"></a><span id="l19.21" class="difflineminus">-</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineminus">-  &lt;binding id=&quot;notificationbox&quot;&gt;</span>
<a href="#l19.23"></a><span id="l19.23" class="difflineminus">-    &lt;content&gt;</span>
<a href="#l19.24"></a><span id="l19.24" class="difflineminus">-      &lt;xul:stack xbl:inherits=&quot;hidden=notificationshidden&quot;</span>
<a href="#l19.25"></a><span id="l19.25" class="difflineminus">-                 class=&quot;notificationbox-stack&quot;&gt;</span>
<a href="#l19.26"></a><span id="l19.26" class="difflineminus">-        &lt;xul:spacer/&gt;</span>
<a href="#l19.27"></a><span id="l19.27" class="difflineminus">-        &lt;children includes=&quot;xbl-notification&quot;/&gt;</span>
<a href="#l19.28"></a><span id="l19.28" class="difflineminus">-      &lt;/xul:stack&gt;</span>
<a href="#l19.29"></a><span id="l19.29" class="difflineminus">-      &lt;children/&gt;</span>
<a href="#l19.30"></a><span id="l19.30" class="difflineminus">-    &lt;/content&gt;</span>
<a href="#l19.31"></a><span id="l19.31" class="difflineminus">-</span>
<a href="#l19.32"></a><span id="l19.32" class="difflineminus">-    &lt;implementation&gt;</span>
<a href="#l19.33"></a><span id="l19.33" class="difflineminus">-      &lt;field name=&quot;PRIORITY_INFO_LOW&quot; readonly=&quot;true&quot;&gt;1&lt;/field&gt;</span>
<a href="#l19.34"></a><span id="l19.34" class="difflineminus">-      &lt;field name=&quot;PRIORITY_INFO_MEDIUM&quot; readonly=&quot;true&quot;&gt;2&lt;/field&gt;</span>
<a href="#l19.35"></a><span id="l19.35" class="difflineminus">-      &lt;field name=&quot;PRIORITY_INFO_HIGH&quot; readonly=&quot;true&quot;&gt;3&lt;/field&gt;</span>
<a href="#l19.36"></a><span id="l19.36" class="difflineminus">-      &lt;field name=&quot;PRIORITY_WARNING_LOW&quot; readonly=&quot;true&quot;&gt;4&lt;/field&gt;</span>
<a href="#l19.37"></a><span id="l19.37" class="difflineminus">-      &lt;field name=&quot;PRIORITY_WARNING_MEDIUM&quot; readonly=&quot;true&quot;&gt;5&lt;/field&gt;</span>
<a href="#l19.38"></a><span id="l19.38" class="difflineminus">-      &lt;field name=&quot;PRIORITY_WARNING_HIGH&quot; readonly=&quot;true&quot;&gt;6&lt;/field&gt;</span>
<a href="#l19.39"></a><span id="l19.39" class="difflineminus">-      &lt;field name=&quot;PRIORITY_CRITICAL_LOW&quot; readonly=&quot;true&quot;&gt;7&lt;/field&gt;</span>
<a href="#l19.40"></a><span id="l19.40" class="difflineminus">-      &lt;field name=&quot;PRIORITY_CRITICAL_MEDIUM&quot; readonly=&quot;true&quot;&gt;8&lt;/field&gt;</span>
<a href="#l19.41"></a><span id="l19.41" class="difflineminus">-      &lt;field name=&quot;PRIORITY_CRITICAL_HIGH&quot; readonly=&quot;true&quot;&gt;9&lt;/field&gt;</span>
<a href="#l19.42"></a><span id="l19.42" class="difflineminus">-      &lt;field name=&quot;PRIORITY_CRITICAL_BLOCK&quot; readonly=&quot;true&quot;&gt;10&lt;/field&gt;</span>
<a href="#l19.43"></a><span id="l19.43" class="difflineminus">-</span>
<a href="#l19.44"></a><span id="l19.44" class="difflineminus">-      &lt;field name=&quot;currentNotification&quot;&gt;null&lt;/field&gt;</span>
<a href="#l19.45"></a><span id="l19.45" class="difflineminus">-</span>
<a href="#l19.46"></a><span id="l19.46" class="difflineminus">-      &lt;field name=&quot;_closedNotification&quot;&gt;null&lt;/field&gt;</span>
<a href="#l19.47"></a><span id="l19.47" class="difflineminus">-      &lt;field name=&quot;_blockingCanvas&quot;&gt;null&lt;/field&gt;</span>
<a href="#l19.48"></a><span id="l19.48" class="difflineminus">-      &lt;field name=&quot;_animating&quot;&gt;false&lt;/field&gt;</span>
<a href="#l19.49"></a><span id="l19.49" class="difflineminus">-</span>
<a href="#l19.50"></a><span id="l19.50" class="difflineminus">-      &lt;property name=&quot;_allowAnimation&quot;&gt;</span>
<a href="#l19.51"></a><span id="l19.51" class="difflineminus">-        &lt;getter&gt;</span>
<a href="#l19.52"></a><span id="l19.52" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.53"></a><span id="l19.53" class="difflineminus">-            var prefs = Cc[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l19.54"></a><span id="l19.54" class="difflineminus">-                          .getService(Ci.nsIPrefBranch);</span>
<a href="#l19.55"></a><span id="l19.55" class="difflineminus">-            return prefs.getBoolPref(&quot;toolkit.cosmeticAnimations.enabled&quot;);</span>
<a href="#l19.56"></a><span id="l19.56" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.57"></a><span id="l19.57" class="difflineminus">-        &lt;/getter&gt;</span>
<a href="#l19.58"></a><span id="l19.58" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l19.59"></a><span id="l19.59" class="difflineminus">-</span>
<a href="#l19.60"></a><span id="l19.60" class="difflineminus">-      &lt;property name=&quot;notificationsHidden&quot;</span>
<a href="#l19.61"></a><span id="l19.61" class="difflineminus">-                onget=&quot;return this.getAttribute('notificationshidden') == 'true';&quot;&gt;</span>
<a href="#l19.62"></a><span id="l19.62" class="difflineminus">-        &lt;setter&gt;</span>
<a href="#l19.63"></a><span id="l19.63" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.64"></a><span id="l19.64" class="difflineminus">-            if (val)</span>
<a href="#l19.65"></a><span id="l19.65" class="difflineminus">-              this.setAttribute(&quot;notificationshidden&quot;, true);</span>
<a href="#l19.66"></a><span id="l19.66" class="difflineminus">-            else this.removeAttribute(&quot;notificationshidden&quot;);</span>
<a href="#l19.67"></a><span id="l19.67" class="difflineminus">-            return val;</span>
<a href="#l19.68"></a><span id="l19.68" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.69"></a><span id="l19.69" class="difflineminus">-        &lt;/setter&gt;</span>
<a href="#l19.70"></a><span id="l19.70" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l19.71"></a><span id="l19.71" class="difflineminus">-</span>
<a href="#l19.72"></a><span id="l19.72" class="difflineminus">-      &lt;property name=&quot;allNotifications&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l19.73"></a><span id="l19.73" class="difflineminus">-        &lt;getter&gt;</span>
<a href="#l19.74"></a><span id="l19.74" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.75"></a><span id="l19.75" class="difflineminus">-            var closedNotification = this._closedNotification;</span>
<a href="#l19.76"></a><span id="l19.76" class="difflineminus">-            var notifications = this.getElementsByTagName(&quot;xbl-notification&quot;);</span>
<a href="#l19.77"></a><span id="l19.77" class="difflineminus">-            return Array.from(notifications).filter(n =&gt; n != closedNotification);</span>
<a href="#l19.78"></a><span id="l19.78" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.79"></a><span id="l19.79" class="difflineminus">-        &lt;/getter&gt;</span>
<a href="#l19.80"></a><span id="l19.80" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l19.81"></a><span id="l19.81" class="difflineminus">-</span>
<a href="#l19.82"></a><span id="l19.82" class="difflineminus">-      &lt;method name=&quot;getNotificationWithValue&quot;&gt;</span>
<a href="#l19.83"></a><span id="l19.83" class="difflineminus">-        &lt;parameter name=&quot;aValue&quot;/&gt;</span>
<a href="#l19.84"></a><span id="l19.84" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l19.85"></a><span id="l19.85" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.86"></a><span id="l19.86" class="difflineminus">-            var notifications = this.allNotifications;</span>
<a href="#l19.87"></a><span id="l19.87" class="difflineminus">-            for (var n = notifications.length - 1; n &gt;= 0; n--) {</span>
<a href="#l19.88"></a><span id="l19.88" class="difflineminus">-              if (aValue == notifications[n].getAttribute(&quot;value&quot;))</span>
<a href="#l19.89"></a><span id="l19.89" class="difflineminus">-                return notifications[n];</span>
<a href="#l19.90"></a><span id="l19.90" class="difflineminus">-            }</span>
<a href="#l19.91"></a><span id="l19.91" class="difflineminus">-            return null;</span>
<a href="#l19.92"></a><span id="l19.92" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.93"></a><span id="l19.93" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l19.94"></a><span id="l19.94" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l19.95"></a><span id="l19.95" class="difflineminus">-</span>
<a href="#l19.96"></a><span id="l19.96" class="difflineminus">-      &lt;method name=&quot;appendNotification&quot;&gt;</span>
<a href="#l19.97"></a><span id="l19.97" class="difflineminus">-        &lt;parameter name=&quot;aLabel&quot;/&gt;</span>
<a href="#l19.98"></a><span id="l19.98" class="difflineminus">-        &lt;parameter name=&quot;aValue&quot;/&gt;</span>
<a href="#l19.99"></a><span id="l19.99" class="difflineminus">-        &lt;parameter name=&quot;aImage&quot;/&gt;</span>
<a href="#l19.100"></a><span id="l19.100" class="difflineminus">-        &lt;parameter name=&quot;aPriority&quot;/&gt;</span>
<a href="#l19.101"></a><span id="l19.101" class="difflineminus">-        &lt;parameter name=&quot;aButtons&quot;/&gt;</span>
<a href="#l19.102"></a><span id="l19.102" class="difflineminus">-        &lt;parameter name=&quot;aEventCallback&quot;/&gt;</span>
<a href="#l19.103"></a><span id="l19.103" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l19.104"></a><span id="l19.104" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.105"></a><span id="l19.105" class="difflineminus">-            if (aPriority &lt; this.PRIORITY_INFO_LOW ||</span>
<a href="#l19.106"></a><span id="l19.106" class="difflineminus">-                aPriority &gt; this.PRIORITY_CRITICAL_BLOCK)</span>
<a href="#l19.107"></a><span id="l19.107" class="difflineminus">-              throw new Error(&quot;Invalid notification priority &quot; + aPriority);</span>
<a href="#l19.108"></a><span id="l19.108" class="difflineminus">-</span>
<a href="#l19.109"></a><span id="l19.109" class="difflineminus">-            // check for where the notification should be inserted according to</span>
<a href="#l19.110"></a><span id="l19.110" class="difflineminus">-            // priority. If two are equal, the existing one appears on top.</span>
<a href="#l19.111"></a><span id="l19.111" class="difflineminus">-            var notifications = this.allNotifications;</span>
<a href="#l19.112"></a><span id="l19.112" class="difflineminus">-            var insertPos = null;</span>
<a href="#l19.113"></a><span id="l19.113" class="difflineminus">-            for (var n = notifications.length - 1; n &gt;= 0; n--) {</span>
<a href="#l19.114"></a><span id="l19.114" class="difflineminus">-              if (notifications[n].priority &lt; aPriority)</span>
<a href="#l19.115"></a><span id="l19.115" class="difflineminus">-                break;</span>
<a href="#l19.116"></a><span id="l19.116" class="difflineminus">-              insertPos = notifications[n];</span>
<a href="#l19.117"></a><span id="l19.117" class="difflineminus">-            }</span>
<a href="#l19.118"></a><span id="l19.118" class="difflineminus">-</span>
<a href="#l19.119"></a><span id="l19.119" class="difflineminus">-            var newitem = document.createXULElement(&quot;xbl-notification&quot;);</span>
<a href="#l19.120"></a><span id="l19.120" class="difflineminus">-            // Can't use instanceof in case this was created from a different document:</span>
<a href="#l19.121"></a><span id="l19.121" class="difflineminus">-            let labelIsDocFragment = aLabel &amp;&amp; typeof aLabel == &quot;object&quot; &amp;&amp; aLabel.nodeType &amp;&amp;</span>
<a href="#l19.122"></a><span id="l19.122" class="difflineminus">-                                     aLabel.nodeType == aLabel.DOCUMENT_FRAGMENT_NODE;</span>
<a href="#l19.123"></a><span id="l19.123" class="difflineminus">-            if (!labelIsDocFragment)</span>
<a href="#l19.124"></a><span id="l19.124" class="difflineminus">-              newitem.setAttribute(&quot;label&quot;, aLabel);</span>
<a href="#l19.125"></a><span id="l19.125" class="difflineminus">-            newitem.setAttribute(&quot;value&quot;, aValue);</span>
<a href="#l19.126"></a><span id="l19.126" class="difflineminus">-            if (aImage)</span>
<a href="#l19.127"></a><span id="l19.127" class="difflineminus">-              newitem.setAttribute(&quot;image&quot;, aImage);</span>
<a href="#l19.128"></a><span id="l19.128" class="difflineminus">-            newitem.eventCallback = aEventCallback;</span>
<a href="#l19.129"></a><span id="l19.129" class="difflineminus">-</span>
<a href="#l19.130"></a><span id="l19.130" class="difflineminus">-            if (aButtons) {</span>
<a href="#l19.131"></a><span id="l19.131" class="difflineminus">-              // The notification-button-default class is added to the button</span>
<a href="#l19.132"></a><span id="l19.132" class="difflineminus">-              // with isDefault set to true. If there is no such button, it is</span>
<a href="#l19.133"></a><span id="l19.133" class="difflineminus">-              // added to the first button (unless that button has isDefault</span>
<a href="#l19.134"></a><span id="l19.134" class="difflineminus">-              // set to false). There cannot be multiple default buttons.</span>
<a href="#l19.135"></a><span id="l19.135" class="difflineminus">-              var defaultElem;</span>
<a href="#l19.136"></a><span id="l19.136" class="difflineminus">-</span>
<a href="#l19.137"></a><span id="l19.137" class="difflineminus">-              for (var b = 0; b &lt; aButtons.length; b++) {</span>
<a href="#l19.138"></a><span id="l19.138" class="difflineminus">-                var button = aButtons[b];</span>
<a href="#l19.139"></a><span id="l19.139" class="difflineminus">-                var buttonElem = document.createXULElement(&quot;button&quot;);</span>
<a href="#l19.140"></a><span id="l19.140" class="difflineminus">-                buttonElem.setAttribute(&quot;label&quot;, button.label);</span>
<a href="#l19.141"></a><span id="l19.141" class="difflineminus">-                if (typeof button.accessKey == &quot;string&quot;)</span>
<a href="#l19.142"></a><span id="l19.142" class="difflineminus">-                  buttonElem.setAttribute(&quot;accesskey&quot;, button.accessKey);</span>
<a href="#l19.143"></a><span id="l19.143" class="difflineminus">-                if (typeof button.type == &quot;string&quot;) {</span>
<a href="#l19.144"></a><span id="l19.144" class="difflineminus">-                  buttonElem.setAttribute(&quot;type&quot;, button.type);</span>
<a href="#l19.145"></a><span id="l19.145" class="difflineminus">-                  if ((button.type == &quot;menu-button&quot; || button.type == &quot;menu&quot;) &amp;&amp;</span>
<a href="#l19.146"></a><span id="l19.146" class="difflineminus">-                      &quot;popup&quot; in button) {</span>
<a href="#l19.147"></a><span id="l19.147" class="difflineminus">-                    buttonElem.appendChild(button.popup);</span>
<a href="#l19.148"></a><span id="l19.148" class="difflineminus">-                    delete button.popup;</span>
<a href="#l19.149"></a><span id="l19.149" class="difflineminus">-                  }</span>
<a href="#l19.150"></a><span id="l19.150" class="difflineminus">-                  if (typeof button.anchor == &quot;string&quot;)</span>
<a href="#l19.151"></a><span id="l19.151" class="difflineminus">-                    buttonElem.setAttribute(&quot;anchor&quot;, button.anchor);</span>
<a href="#l19.152"></a><span id="l19.152" class="difflineminus">-                }</span>
<a href="#l19.153"></a><span id="l19.153" class="difflineminus">-                buttonElem.classList.add(&quot;notification-button&quot;);</span>
<a href="#l19.154"></a><span id="l19.154" class="difflineminus">-</span>
<a href="#l19.155"></a><span id="l19.155" class="difflineminus">-                if (button.isDefault ||</span>
<a href="#l19.156"></a><span id="l19.156" class="difflineminus">-                    b == 0 &amp;&amp; !(&quot;isDefault&quot; in button))</span>
<a href="#l19.157"></a><span id="l19.157" class="difflineminus">-                  defaultElem = buttonElem;</span>
<a href="#l19.158"></a><span id="l19.158" class="difflineminus">-</span>
<a href="#l19.159"></a><span id="l19.159" class="difflineminus">-                newitem.appendChild(buttonElem);</span>
<a href="#l19.160"></a><span id="l19.160" class="difflineminus">-                buttonElem.buttonInfo = button;</span>
<a href="#l19.161"></a><span id="l19.161" class="difflineminus">-              }</span>
<a href="#l19.162"></a><span id="l19.162" class="difflineminus">-</span>
<a href="#l19.163"></a><span id="l19.163" class="difflineminus">-              if (defaultElem)</span>
<a href="#l19.164"></a><span id="l19.164" class="difflineminus">-                defaultElem.classList.add(&quot;notification-button-default&quot;);</span>
<a href="#l19.165"></a><span id="l19.165" class="difflineminus">-            }</span>
<a href="#l19.166"></a><span id="l19.166" class="difflineminus">-</span>
<a href="#l19.167"></a><span id="l19.167" class="difflineminus">-            newitem.setAttribute(&quot;priority&quot;, aPriority);</span>
<a href="#l19.168"></a><span id="l19.168" class="difflineminus">-            if (aPriority &gt;= this.PRIORITY_CRITICAL_LOW)</span>
<a href="#l19.169"></a><span id="l19.169" class="difflineminus">-              newitem.setAttribute(&quot;type&quot;, &quot;critical&quot;);</span>
<a href="#l19.170"></a><span id="l19.170" class="difflineminus">-            else if (aPriority &lt;= this.PRIORITY_INFO_HIGH)</span>
<a href="#l19.171"></a><span id="l19.171" class="difflineminus">-              newitem.setAttribute(&quot;type&quot;, &quot;info&quot;);</span>
<a href="#l19.172"></a><span id="l19.172" class="difflineminus">-            else</span>
<a href="#l19.173"></a><span id="l19.173" class="difflineminus">-              newitem.setAttribute(&quot;type&quot;, &quot;warning&quot;);</span>
<a href="#l19.174"></a><span id="l19.174" class="difflineminus">-</span>
<a href="#l19.175"></a><span id="l19.175" class="difflineminus">-            if (!insertPos) {</span>
<a href="#l19.176"></a><span id="l19.176" class="difflineminus">-              newitem.style.position = &quot;fixed&quot;;</span>
<a href="#l19.177"></a><span id="l19.177" class="difflineminus">-              newitem.style.top = &quot;100%&quot;;</span>
<a href="#l19.178"></a><span id="l19.178" class="difflineminus">-              newitem.style.marginTop = &quot;-15px&quot;;</span>
<a href="#l19.179"></a><span id="l19.179" class="difflineminus">-              newitem.style.opacity = &quot;0&quot;;</span>
<a href="#l19.180"></a><span id="l19.180" class="difflineminus">-            }</span>
<a href="#l19.181"></a><span id="l19.181" class="difflineminus">-            this.insertBefore(newitem, insertPos);</span>
<a href="#l19.182"></a><span id="l19.182" class="difflineminus">-            // Can only insert the document fragment after the item has been created because</span>
<a href="#l19.183"></a><span id="l19.183" class="difflineminus">-            // otherwise the XBL structure isn't there yet:</span>
<a href="#l19.184"></a><span id="l19.184" class="difflineminus">-            if (labelIsDocFragment) {</span>
<a href="#l19.185"></a><span id="l19.185" class="difflineminus">-              document.getAnonymousElementByAttribute(newitem, &quot;anonid&quot;, &quot;messageText&quot;)</span>
<a href="#l19.186"></a><span id="l19.186" class="difflineminus">-                .appendChild(aLabel);</span>
<a href="#l19.187"></a><span id="l19.187" class="difflineminus">-            }</span>
<a href="#l19.188"></a><span id="l19.188" class="difflineminus">-</span>
<a href="#l19.189"></a><span id="l19.189" class="difflineminus">-            if (!insertPos)</span>
<a href="#l19.190"></a><span id="l19.190" class="difflineminus">-              this._showNotification(newitem, true);</span>
<a href="#l19.191"></a><span id="l19.191" class="difflineminus">-</span>
<a href="#l19.192"></a><span id="l19.192" class="difflineminus">-            // Fire event for accessibility APIs</span>
<a href="#l19.193"></a><span id="l19.193" class="difflineminus">-            var event = document.createEvent(&quot;Events&quot;);</span>
<a href="#l19.194"></a><span id="l19.194" class="difflineminus">-            event.initEvent(&quot;AlertActive&quot;, true, true);</span>
<a href="#l19.195"></a><span id="l19.195" class="difflineminus">-            newitem.dispatchEvent(event);</span>
<a href="#l19.196"></a><span id="l19.196" class="difflineminus">-</span>
<a href="#l19.197"></a><span id="l19.197" class="difflineminus">-            return newitem;</span>
<a href="#l19.198"></a><span id="l19.198" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.199"></a><span id="l19.199" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l19.200"></a><span id="l19.200" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l19.201"></a><span id="l19.201" class="difflineminus">-</span>
<a href="#l19.202"></a><span id="l19.202" class="difflineminus">-      &lt;method name=&quot;removeNotification&quot;&gt;</span>
<a href="#l19.203"></a><span id="l19.203" class="difflineminus">-        &lt;parameter name=&quot;aItem&quot;/&gt;</span>
<a href="#l19.204"></a><span id="l19.204" class="difflineminus">-        &lt;parameter name=&quot;aSkipAnimation&quot;/&gt;</span>
<a href="#l19.205"></a><span id="l19.205" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l19.206"></a><span id="l19.206" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.207"></a><span id="l19.207" class="difflineminus">-            if (aItem == this.currentNotification)</span>
<a href="#l19.208"></a><span id="l19.208" class="difflineminus">-              this.removeCurrentNotification(aSkipAnimation);</span>
<a href="#l19.209"></a><span id="l19.209" class="difflineminus">-            else if (aItem != this._closedNotification)</span>
<a href="#l19.210"></a><span id="l19.210" class="difflineminus">-              this._removeNotificationElement(aItem);</span>
<a href="#l19.211"></a><span id="l19.211" class="difflineminus">-            return aItem;</span>
<a href="#l19.212"></a><span id="l19.212" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.213"></a><span id="l19.213" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l19.214"></a><span id="l19.214" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l19.215"></a><span id="l19.215" class="difflineminus">-</span>
<a href="#l19.216"></a><span id="l19.216" class="difflineminus">-      &lt;method name=&quot;_removeNotificationElement&quot;&gt;</span>
<a href="#l19.217"></a><span id="l19.217" class="difflineminus">-        &lt;parameter name=&quot;aChild&quot;/&gt;</span>
<a href="#l19.218"></a><span id="l19.218" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l19.219"></a><span id="l19.219" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.220"></a><span id="l19.220" class="difflineminus">-            if (aChild.eventCallback)</span>
<a href="#l19.221"></a><span id="l19.221" class="difflineminus">-              aChild.eventCallback(&quot;removed&quot;);</span>
<a href="#l19.222"></a><span id="l19.222" class="difflineminus">-            this.removeChild(aChild);</span>
<a href="#l19.223"></a><span id="l19.223" class="difflineminus">-</span>
<a href="#l19.224"></a><span id="l19.224" class="difflineminus">-            // make sure focus doesn't get lost (workaround for bug 570835)</span>
<a href="#l19.225"></a><span id="l19.225" class="difflineminus">-            let fm = Cc[&quot;@mozilla.org/focus-manager;1&quot;]</span>
<a href="#l19.226"></a><span id="l19.226" class="difflineminus">-                       .getService(Ci.nsIFocusManager);</span>
<a href="#l19.227"></a><span id="l19.227" class="difflineminus">-            if (!fm.getFocusedElementForWindow(window, false, {}))</span>
<a href="#l19.228"></a><span id="l19.228" class="difflineminus">-              fm.moveFocus(window, this, fm.MOVEFOCUS_FORWARD, 0);</span>
<a href="#l19.229"></a><span id="l19.229" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.230"></a><span id="l19.230" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l19.231"></a><span id="l19.231" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l19.232"></a><span id="l19.232" class="difflineminus">-</span>
<a href="#l19.233"></a><span id="l19.233" class="difflineminus">-      &lt;method name=&quot;removeCurrentNotification&quot;&gt;</span>
<a href="#l19.234"></a><span id="l19.234" class="difflineminus">-        &lt;parameter name=&quot;aSkipAnimation&quot;/&gt;</span>
<a href="#l19.235"></a><span id="l19.235" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l19.236"></a><span id="l19.236" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.237"></a><span id="l19.237" class="difflineminus">-            this._showNotification(this.currentNotification, false, aSkipAnimation);</span>
<a href="#l19.238"></a><span id="l19.238" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.239"></a><span id="l19.239" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l19.240"></a><span id="l19.240" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l19.241"></a><span id="l19.241" class="difflineminus">-</span>
<a href="#l19.242"></a><span id="l19.242" class="difflineminus">-      &lt;method name=&quot;removeAllNotifications&quot;&gt;</span>
<a href="#l19.243"></a><span id="l19.243" class="difflineminus">-        &lt;parameter name=&quot;aImmediate&quot;/&gt;</span>
<a href="#l19.244"></a><span id="l19.244" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l19.245"></a><span id="l19.245" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.246"></a><span id="l19.246" class="difflineminus">-            var notifications = this.allNotifications;</span>
<a href="#l19.247"></a><span id="l19.247" class="difflineminus">-            for (var n = notifications.length - 1; n &gt;= 0; n--) {</span>
<a href="#l19.248"></a><span id="l19.248" class="difflineminus">-              if (aImmediate)</span>
<a href="#l19.249"></a><span id="l19.249" class="difflineminus">-                this._removeNotificationElement(notifications[n]);</span>
<a href="#l19.250"></a><span id="l19.250" class="difflineminus">-              else</span>
<a href="#l19.251"></a><span id="l19.251" class="difflineminus">-                this.removeNotification(notifications[n]);</span>
<a href="#l19.252"></a><span id="l19.252" class="difflineminus">-            }</span>
<a href="#l19.253"></a><span id="l19.253" class="difflineminus">-            this.currentNotification = null;</span>
<a href="#l19.254"></a><span id="l19.254" class="difflineminus">-</span>
<a href="#l19.255"></a><span id="l19.255" class="difflineminus">-            // Clean up any currently-animating notification; this is necessary</span>
<a href="#l19.256"></a><span id="l19.256" class="difflineminus">-            // if a notification was just opened and is still animating, but we</span>
<a href="#l19.257"></a><span id="l19.257" class="difflineminus">-            // want to close it *without* animating.  This can even happen if</span>
<a href="#l19.258"></a><span id="l19.258" class="difflineminus">-            // the user toggled `toolkit.cosmeticAnimations.enabled` to false</span>
<a href="#l19.259"></a><span id="l19.259" class="difflineminus">-            // and called this method immediately after an animated notification</span>
<a href="#l19.260"></a><span id="l19.260" class="difflineminus">-            // displayed (although this case isn't very likely).</span>
<a href="#l19.261"></a><span id="l19.261" class="difflineminus">-            if (aImmediate || !this._allowAnimation)</span>
<a href="#l19.262"></a><span id="l19.262" class="difflineminus">-              this._finishAnimation();</span>
<a href="#l19.263"></a><span id="l19.263" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.264"></a><span id="l19.264" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l19.265"></a><span id="l19.265" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l19.266"></a><span id="l19.266" class="difflineminus">-</span>
<a href="#l19.267"></a><span id="l19.267" class="difflineminus">-      &lt;method name=&quot;removeTransientNotifications&quot;&gt;</span>
<a href="#l19.268"></a><span id="l19.268" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l19.269"></a><span id="l19.269" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.270"></a><span id="l19.270" class="difflineminus">-            var notifications = this.allNotifications;</span>
<a href="#l19.271"></a><span id="l19.271" class="difflineminus">-            for (var n = notifications.length - 1; n &gt;= 0; n--) {</span>
<a href="#l19.272"></a><span id="l19.272" class="difflineminus">-              var notification = notifications[n];</span>
<a href="#l19.273"></a><span id="l19.273" class="difflineminus">-              if (notification.persistence)</span>
<a href="#l19.274"></a><span id="l19.274" class="difflineminus">-                notification.persistence--;</span>
<a href="#l19.275"></a><span id="l19.275" class="difflineminus">-              else if (Date.now() &gt; notification.timeout)</span>
<a href="#l19.276"></a><span id="l19.276" class="difflineminus">-                this.removeNotification(notification);</span>
<a href="#l19.277"></a><span id="l19.277" class="difflineminus">-            }</span>
<a href="#l19.278"></a><span id="l19.278" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.279"></a><span id="l19.279" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l19.280"></a><span id="l19.280" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l19.281"></a><span id="l19.281" class="difflineminus">-</span>
<a href="#l19.282"></a><span id="l19.282" class="difflineminus">-      &lt;method name=&quot;_showNotification&quot;&gt;</span>
<a href="#l19.283"></a><span id="l19.283" class="difflineminus">-        &lt;parameter name=&quot;aNotification&quot;/&gt;</span>
<a href="#l19.284"></a><span id="l19.284" class="difflineminus">-        &lt;parameter name=&quot;aSlideIn&quot;/&gt;</span>
<a href="#l19.285"></a><span id="l19.285" class="difflineminus">-        &lt;parameter name=&quot;aSkipAnimation&quot;/&gt;</span>
<a href="#l19.286"></a><span id="l19.286" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l19.287"></a><span id="l19.287" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.288"></a><span id="l19.288" class="difflineminus">-            this._finishAnimation();</span>
<a href="#l19.289"></a><span id="l19.289" class="difflineminus">-</span>
<a href="#l19.290"></a><span id="l19.290" class="difflineminus">-            var height = aNotification.getBoundingClientRect().height;</span>
<a href="#l19.291"></a><span id="l19.291" class="difflineminus">-            var skipAnimation = aSkipAnimation || height == 0 ||</span>
<a href="#l19.292"></a><span id="l19.292" class="difflineminus">-                                !this._allowAnimation;</span>
<a href="#l19.293"></a><span id="l19.293" class="difflineminus">-            aNotification.classList.toggle(&quot;animated&quot;, !skipAnimation);</span>
<a href="#l19.294"></a><span id="l19.294" class="difflineminus">-</span>
<a href="#l19.295"></a><span id="l19.295" class="difflineminus">-            if (aSlideIn) {</span>
<a href="#l19.296"></a><span id="l19.296" class="difflineminus">-              this.currentNotification = aNotification;</span>
<a href="#l19.297"></a><span id="l19.297" class="difflineminus">-              aNotification.style.removeProperty(&quot;position&quot;);</span>
<a href="#l19.298"></a><span id="l19.298" class="difflineminus">-              aNotification.style.removeProperty(&quot;top&quot;);</span>
<a href="#l19.299"></a><span id="l19.299" class="difflineminus">-              aNotification.style.removeProperty(&quot;margin-top&quot;);</span>
<a href="#l19.300"></a><span id="l19.300" class="difflineminus">-              aNotification.style.removeProperty(&quot;opacity&quot;);</span>
<a href="#l19.301"></a><span id="l19.301" class="difflineminus">-</span>
<a href="#l19.302"></a><span id="l19.302" class="difflineminus">-              if (skipAnimation) {</span>
<a href="#l19.303"></a><span id="l19.303" class="difflineminus">-                this._setBlockingState(this.currentNotification);</span>
<a href="#l19.304"></a><span id="l19.304" class="difflineminus">-                return;</span>
<a href="#l19.305"></a><span id="l19.305" class="difflineminus">-              }</span>
<a href="#l19.306"></a><span id="l19.306" class="difflineminus">-            } else {</span>
<a href="#l19.307"></a><span id="l19.307" class="difflineminus">-              this._closedNotification = aNotification;</span>
<a href="#l19.308"></a><span id="l19.308" class="difflineminus">-              var notifications = this.allNotifications;</span>
<a href="#l19.309"></a><span id="l19.309" class="difflineminus">-              var idx = notifications.length - 1;</span>
<a href="#l19.310"></a><span id="l19.310" class="difflineminus">-              this.currentNotification = (idx &gt;= 0) ? notifications[idx] : null;</span>
<a href="#l19.311"></a><span id="l19.311" class="difflineminus">-</span>
<a href="#l19.312"></a><span id="l19.312" class="difflineminus">-              if (skipAnimation) {</span>
<a href="#l19.313"></a><span id="l19.313" class="difflineminus">-                this._removeNotificationElement(this._closedNotification);</span>
<a href="#l19.314"></a><span id="l19.314" class="difflineminus">-                this._closedNotification = null;</span>
<a href="#l19.315"></a><span id="l19.315" class="difflineminus">-                this._setBlockingState(this.currentNotification);</span>
<a href="#l19.316"></a><span id="l19.316" class="difflineminus">-                return;</span>
<a href="#l19.317"></a><span id="l19.317" class="difflineminus">-              }</span>
<a href="#l19.318"></a><span id="l19.318" class="difflineminus">-</span>
<a href="#l19.319"></a><span id="l19.319" class="difflineminus">-              aNotification.style.marginTop = -height + &quot;px&quot;;</span>
<a href="#l19.320"></a><span id="l19.320" class="difflineminus">-              aNotification.style.opacity = 0;</span>
<a href="#l19.321"></a><span id="l19.321" class="difflineminus">-            }</span>
<a href="#l19.322"></a><span id="l19.322" class="difflineminus">-</span>
<a href="#l19.323"></a><span id="l19.323" class="difflineminus">-            this._animating = true;</span>
<a href="#l19.324"></a><span id="l19.324" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.325"></a><span id="l19.325" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l19.326"></a><span id="l19.326" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l19.327"></a><span id="l19.327" class="difflineminus">-</span>
<a href="#l19.328"></a><span id="l19.328" class="difflineminus">-      &lt;method name=&quot;_finishAnimation&quot;&gt;</span>
<a href="#l19.329"></a><span id="l19.329" class="difflineminus">-        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l19.330"></a><span id="l19.330" class="difflineminus">-          if (this._animating) {</span>
<a href="#l19.331"></a><span id="l19.331" class="difflineminus">-            this._animating = false;</span>
<a href="#l19.332"></a><span id="l19.332" class="difflineminus">-            if (this._closedNotification) {</span>
<a href="#l19.333"></a><span id="l19.333" class="difflineminus">-              this._removeNotificationElement(this._closedNotification);</span>
<a href="#l19.334"></a><span id="l19.334" class="difflineminus">-              this._closedNotification = null;</span>
<a href="#l19.335"></a><span id="l19.335" class="difflineminus">-            }</span>
<a href="#l19.336"></a><span id="l19.336" class="difflineminus">-            this._setBlockingState(this.currentNotification);</span>
<a href="#l19.337"></a><span id="l19.337" class="difflineminus">-          }</span>
<a href="#l19.338"></a><span id="l19.338" class="difflineminus">-        ]]&gt;&lt;/body&gt;</span>
<a href="#l19.339"></a><span id="l19.339" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l19.340"></a><span id="l19.340" class="difflineminus">-</span>
<a href="#l19.341"></a><span id="l19.341" class="difflineminus">-      &lt;method name=&quot;_setBlockingState&quot;&gt;</span>
<a href="#l19.342"></a><span id="l19.342" class="difflineminus">-        &lt;parameter name=&quot;aNotification&quot;/&gt;</span>
<a href="#l19.343"></a><span id="l19.343" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l19.344"></a><span id="l19.344" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.345"></a><span id="l19.345" class="difflineminus">-            var isblock = aNotification &amp;&amp;</span>
<a href="#l19.346"></a><span id="l19.346" class="difflineminus">-                          aNotification.priority == this.PRIORITY_CRITICAL_BLOCK;</span>
<a href="#l19.347"></a><span id="l19.347" class="difflineminus">-            var canvas = this._blockingCanvas;</span>
<a href="#l19.348"></a><span id="l19.348" class="difflineminus">-            if (isblock) {</span>
<a href="#l19.349"></a><span id="l19.349" class="difflineminus">-              if (!canvas)</span>
<a href="#l19.350"></a><span id="l19.350" class="difflineminus">-                canvas = document.createElementNS(&quot;http://www.w3.org/1999/xhtml&quot;, &quot;canvas&quot;);</span>
<a href="#l19.351"></a><span id="l19.351" class="difflineminus">-              const XULNS = &quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;;</span>
<a href="#l19.352"></a><span id="l19.352" class="difflineminus">-              let content = this.firstChild;</span>
<a href="#l19.353"></a><span id="l19.353" class="difflineminus">-              if (!content ||</span>
<a href="#l19.354"></a><span id="l19.354" class="difflineminus">-                   content.namespaceURI != XULNS ||</span>
<a href="#l19.355"></a><span id="l19.355" class="difflineminus">-                   content.localName != &quot;browser&quot;)</span>
<a href="#l19.356"></a><span id="l19.356" class="difflineminus">-                return;</span>
<a href="#l19.357"></a><span id="l19.357" class="difflineminus">-</span>
<a href="#l19.358"></a><span id="l19.358" class="difflineminus">-              var width = content.getBoundingClientRect().width;</span>
<a href="#l19.359"></a><span id="l19.359" class="difflineminus">-              var height = content.getBoundingClientRect().height;</span>
<a href="#l19.360"></a><span id="l19.360" class="difflineminus">-              content.collapsed = true;</span>
<a href="#l19.361"></a><span id="l19.361" class="difflineminus">-</span>
<a href="#l19.362"></a><span id="l19.362" class="difflineminus">-              canvas.setAttribute(&quot;width&quot;, width);</span>
<a href="#l19.363"></a><span id="l19.363" class="difflineminus">-              canvas.setAttribute(&quot;height&quot;, height);</span>
<a href="#l19.364"></a><span id="l19.364" class="difflineminus">-              canvas.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l19.365"></a><span id="l19.365" class="difflineminus">-</span>
<a href="#l19.366"></a><span id="l19.366" class="difflineminus">-              this.appendChild(canvas);</span>
<a href="#l19.367"></a><span id="l19.367" class="difflineminus">-              this._blockingCanvas = canvas;</span>
<a href="#l19.368"></a><span id="l19.368" class="difflineminus">-</span>
<a href="#l19.369"></a><span id="l19.369" class="difflineminus">-              var bgcolor = &quot;white&quot;;</span>
<a href="#l19.370"></a><span id="l19.370" class="difflineminus">-              try {</span>
<a href="#l19.371"></a><span id="l19.371" class="difflineminus">-                var prefService = Cc[&quot;@mozilla.org/preferences-service;1&quot;].</span>
<a href="#l19.372"></a><span id="l19.372" class="difflineminus">-                                    getService(Ci.nsIPrefBranch);</span>
<a href="#l19.373"></a><span id="l19.373" class="difflineminus">-                bgcolor = prefService.getCharPref(&quot;browser.display.background_color&quot;);</span>
<a href="#l19.374"></a><span id="l19.374" class="difflineminus">-</span>
<a href="#l19.375"></a><span id="l19.375" class="difflineminus">-                var win = content.contentWindow;</span>
<a href="#l19.376"></a><span id="l19.376" class="difflineminus">-                var context = canvas.getContext(&quot;2d&quot;);</span>
<a href="#l19.377"></a><span id="l19.377" class="difflineminus">-                context.globalAlpha = 0.5;</span>
<a href="#l19.378"></a><span id="l19.378" class="difflineminus">-                context.drawWindow(win, win.scrollX, win.scrollY,</span>
<a href="#l19.379"></a><span id="l19.379" class="difflineminus">-                                   width, height, bgcolor);</span>
<a href="#l19.380"></a><span id="l19.380" class="difflineminus">-              } catch (ex) { }</span>
<a href="#l19.381"></a><span id="l19.381" class="difflineminus">-            } else if (canvas) {</span>
<a href="#l19.382"></a><span id="l19.382" class="difflineminus">-              canvas.remove();</span>
<a href="#l19.383"></a><span id="l19.383" class="difflineminus">-              this._blockingCanvas = null;</span>
<a href="#l19.384"></a><span id="l19.384" class="difflineminus">-              let content = this.firstChild;</span>
<a href="#l19.385"></a><span id="l19.385" class="difflineminus">-              if (content)</span>
<a href="#l19.386"></a><span id="l19.386" class="difflineminus">-                content.collapsed = false;</span>
<a href="#l19.387"></a><span id="l19.387" class="difflineminus">-            }</span>
<a href="#l19.388"></a><span id="l19.388" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.389"></a><span id="l19.389" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l19.390"></a><span id="l19.390" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l19.391"></a><span id="l19.391" class="difflineminus">-</span>
<a href="#l19.392"></a><span id="l19.392" class="difflineminus">-    &lt;/implementation&gt;</span>
<a href="#l19.393"></a><span id="l19.393" class="difflineminus">-</span>
<a href="#l19.394"></a><span id="l19.394" class="difflineminus">-    &lt;handlers&gt;</span>
<a href="#l19.395"></a><span id="l19.395" class="difflineminus">-      &lt;handler event=&quot;transitionend&quot;&gt;&lt;![CDATA[</span>
<a href="#l19.396"></a><span id="l19.396" class="difflineminus">-        if (event.target.localName == &quot;xbl-notification&quot; &amp;&amp;</span>
<a href="#l19.397"></a><span id="l19.397" class="difflineminus">-            event.propertyName == &quot;margin-top&quot;)</span>
<a href="#l19.398"></a><span id="l19.398" class="difflineminus">-          this._finishAnimation();</span>
<a href="#l19.399"></a><span id="l19.399" class="difflineminus">-      ]]&gt;&lt;/handler&gt;</span>
<a href="#l19.400"></a><span id="l19.400" class="difflineminus">-    &lt;/handlers&gt;</span>
<a href="#l19.401"></a><span id="l19.401" class="difflineminus">-</span>
<a href="#l19.402"></a><span id="l19.402" class="difflineminus">-  &lt;/binding&gt;</span>
<a href="#l19.403"></a><span id="l19.403" class="difflineminus">-</span>
<a href="#l19.404"></a><span id="l19.404" class="difflineminus">-  &lt;binding id=&quot;notification&quot;&gt;</span>
<a href="#l19.405"></a><span id="l19.405" class="difflineminus">-    &lt;content&gt;</span>
<a href="#l19.406"></a><span id="l19.406" class="difflineminus">-      &lt;xul:hbox anonid=&quot;details&quot; align=&quot;center&quot; flex=&quot;1&quot;</span>
<a href="#l19.407"></a><span id="l19.407" class="difflineminus">-                oncommand=&quot;this.parentNode._doButtonCommand(event);&quot;&gt;</span>
<a href="#l19.408"></a><span id="l19.408" class="difflineminus">-        &lt;xul:image anonid=&quot;messageImage&quot; class=&quot;messageImage&quot; xbl:inherits=&quot;src=image,type,value&quot;/&gt;</span>
<a href="#l19.409"></a><span id="l19.409" class="difflineminus">-        &lt;xul:description anonid=&quot;messageText&quot; class=&quot;messageText&quot; flex=&quot;1&quot; xbl:inherits=&quot;xbl:text=label&quot;/&gt;</span>
<a href="#l19.410"></a><span id="l19.410" class="difflineminus">-        &lt;xul:spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l19.411"></a><span id="l19.411" class="difflineminus">-        &lt;children/&gt;</span>
<a href="#l19.412"></a><span id="l19.412" class="difflineminus">-      &lt;/xul:hbox&gt;</span>
<a href="#l19.413"></a><span id="l19.413" class="difflineminus">-      &lt;xul:toolbarbutton ondblclick=&quot;event.stopPropagation();&quot;</span>
<a href="#l19.414"></a><span id="l19.414" class="difflineminus">-                         class=&quot;messageCloseButton close-icon tabbable&quot;</span>
<a href="#l19.415"></a><span id="l19.415" class="difflineminus">-                         anonid=&quot;close-button&quot;</span>
<a href="#l19.416"></a><span id="l19.416" class="difflineminus">-                         xbl:inherits=&quot;hidden=hideclose&quot;</span>
<a href="#l19.417"></a><span id="l19.417" class="difflineminus">-                         tooltiptext=&quot;&amp;closeNotification.tooltip;&quot;</span>
<a href="#l19.418"></a><span id="l19.418" class="difflineminus">-                         oncommand=&quot;document.getBindingParent(this).dismiss();&quot;/&gt;</span>
<a href="#l19.419"></a><span id="l19.419" class="difflineminus">-    &lt;/content&gt;</span>
<a href="#l19.420"></a><span id="l19.420" class="difflineminus">-    &lt;implementation&gt;</span>
<a href="#l19.421"></a><span id="l19.421" class="difflineminus">-      &lt;property name=&quot;label&quot; onset=&quot;this.setAttribute('label', val); return val;&quot;</span>
<a href="#l19.422"></a><span id="l19.422" class="difflineminus">-                             onget=&quot;return this.getAttribute('label');&quot;/&gt;</span>
<a href="#l19.423"></a><span id="l19.423" class="difflineminus">-      &lt;property name=&quot;value&quot; onset=&quot;this.setAttribute('value', val); return val;&quot;</span>
<a href="#l19.424"></a><span id="l19.424" class="difflineminus">-                             onget=&quot;return this.getAttribute('value');&quot;/&gt;</span>
<a href="#l19.425"></a><span id="l19.425" class="difflineminus">-      &lt;property name=&quot;image&quot; onset=&quot;this.setAttribute('image', val); return val;&quot;</span>
<a href="#l19.426"></a><span id="l19.426" class="difflineminus">-                             onget=&quot;return this.getAttribute('image');&quot;/&gt;</span>
<a href="#l19.427"></a><span id="l19.427" class="difflineminus">-      &lt;property name=&quot;type&quot; onset=&quot;this.setAttribute('type', val); return val;&quot;</span>
<a href="#l19.428"></a><span id="l19.428" class="difflineminus">-                            onget=&quot;return this.getAttribute('type');&quot;/&gt;</span>
<a href="#l19.429"></a><span id="l19.429" class="difflineminus">-      &lt;property name=&quot;priority&quot; onget=&quot;return parseInt(this.getAttribute('priority')) || 0;&quot;</span>
<a href="#l19.430"></a><span id="l19.430" class="difflineminus">-                                onset=&quot;this.setAttribute('priority', val); return val;&quot;/&gt;</span>
<a href="#l19.431"></a><span id="l19.431" class="difflineminus">-      &lt;property name=&quot;persistence&quot; onget=&quot;return parseInt(this.getAttribute('persistence')) || 0;&quot;</span>
<a href="#l19.432"></a><span id="l19.432" class="difflineminus">-                                   onset=&quot;this.setAttribute('persistence', val); return val;&quot;/&gt;</span>
<a href="#l19.433"></a><span id="l19.433" class="difflineminus">-      &lt;field name=&quot;timeout&quot;&gt;0&lt;/field&gt;</span>
<a href="#l19.434"></a><span id="l19.434" class="difflineminus">-</span>
<a href="#l19.435"></a><span id="l19.435" class="difflineminus">-      &lt;property name=&quot;control&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l19.436"></a><span id="l19.436" class="difflineminus">-        &lt;getter&gt;</span>
<a href="#l19.437"></a><span id="l19.437" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.438"></a><span id="l19.438" class="difflineminus">-            var parent = this.parentNode;</span>
<a href="#l19.439"></a><span id="l19.439" class="difflineminus">-            while (parent) {</span>
<a href="#l19.440"></a><span id="l19.440" class="difflineminus">-              if (parent.localName == &quot;notificationbox&quot;)</span>
<a href="#l19.441"></a><span id="l19.441" class="difflineminus">-                return parent;</span>
<a href="#l19.442"></a><span id="l19.442" class="difflineminus">-              parent = parent.parentNode;</span>
<a href="#l19.443"></a><span id="l19.443" class="difflineminus">-            }</span>
<a href="#l19.444"></a><span id="l19.444" class="difflineminus">-            return null;</span>
<a href="#l19.445"></a><span id="l19.445" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.446"></a><span id="l19.446" class="difflineminus">-        &lt;/getter&gt;</span>
<a href="#l19.447"></a><span id="l19.447" class="difflineminus">-      &lt;/property&gt;</span>
<a href="#l19.448"></a><span id="l19.448" class="difflineminus">-</span>
<a href="#l19.449"></a><span id="l19.449" class="difflineminus">-      &lt;!-- This method should only be called when the user has</span>
<a href="#l19.450"></a><span id="l19.450" class="difflineminus">-           manually closed the notification. If you want to</span>
<a href="#l19.451"></a><span id="l19.451" class="difflineminus">-           programmatically close the notification, you should</span>
<a href="#l19.452"></a><span id="l19.452" class="difflineminus">-           call close() instead. --&gt;</span>
<a href="#l19.453"></a><span id="l19.453" class="difflineminus">-      &lt;method name=&quot;dismiss&quot;&gt;</span>
<a href="#l19.454"></a><span id="l19.454" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l19.455"></a><span id="l19.455" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.456"></a><span id="l19.456" class="difflineminus">-            if (this.eventCallback) {</span>
<a href="#l19.457"></a><span id="l19.457" class="difflineminus">-              this.eventCallback(&quot;dismissed&quot;);</span>
<a href="#l19.458"></a><span id="l19.458" class="difflineminus">-            }</span>
<a href="#l19.459"></a><span id="l19.459" class="difflineminus">-            this.close();</span>
<a href="#l19.460"></a><span id="l19.460" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.461"></a><span id="l19.461" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l19.462"></a><span id="l19.462" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l19.463"></a><span id="l19.463" class="difflineminus">-</span>
<a href="#l19.464"></a><span id="l19.464" class="difflineminus">-      &lt;method name=&quot;close&quot;&gt;</span>
<a href="#l19.465"></a><span id="l19.465" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l19.466"></a><span id="l19.466" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.467"></a><span id="l19.467" class="difflineminus">-            var control = this.control;</span>
<a href="#l19.468"></a><span id="l19.468" class="difflineminus">-            if (control)</span>
<a href="#l19.469"></a><span id="l19.469" class="difflineminus">-              control.removeNotification(this);</span>
<a href="#l19.470"></a><span id="l19.470" class="difflineminus">-            else</span>
<a href="#l19.471"></a><span id="l19.471" class="difflineminus">-              this.hidden = true;</span>
<a href="#l19.472"></a><span id="l19.472" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.473"></a><span id="l19.473" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l19.474"></a><span id="l19.474" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l19.475"></a><span id="l19.475" class="difflineminus">-</span>
<a href="#l19.476"></a><span id="l19.476" class="difflineminus">-      &lt;method name=&quot;_doButtonCommand&quot;&gt;</span>
<a href="#l19.477"></a><span id="l19.477" class="difflineminus">-        &lt;parameter name=&quot;aEvent&quot;/&gt;</span>
<a href="#l19.478"></a><span id="l19.478" class="difflineminus">-        &lt;body&gt;</span>
<a href="#l19.479"></a><span id="l19.479" class="difflineminus">-          &lt;![CDATA[</span>
<a href="#l19.480"></a><span id="l19.480" class="difflineminus">-            if (!(&quot;buttonInfo&quot; in aEvent.target))</span>
<a href="#l19.481"></a><span id="l19.481" class="difflineminus">-              return;</span>
<a href="#l19.482"></a><span id="l19.482" class="difflineminus">-</span>
<a href="#l19.483"></a><span id="l19.483" class="difflineminus">-            var button = aEvent.target.buttonInfo;</span>
<a href="#l19.484"></a><span id="l19.484" class="difflineminus">-            if (button.popup) {</span>
<a href="#l19.485"></a><span id="l19.485" class="difflineminus">-              document.getElementById(button.popup).</span>
<a href="#l19.486"></a><span id="l19.486" class="difflineminus">-                openPopup(aEvent.originalTarget, &quot;after_start&quot;, 0, 0, false, false, aEvent);</span>
<a href="#l19.487"></a><span id="l19.487" class="difflineminus">-              aEvent.stopPropagation();</span>
<a href="#l19.488"></a><span id="l19.488" class="difflineminus">-            } else {</span>
<a href="#l19.489"></a><span id="l19.489" class="difflineminus">-              var callback = button.callback;</span>
<a href="#l19.490"></a><span id="l19.490" class="difflineminus">-              if (callback) {</span>
<a href="#l19.491"></a><span id="l19.491" class="difflineminus">-                var result = callback(this, button, aEvent.target, aEvent);</span>
<a href="#l19.492"></a><span id="l19.492" class="difflineminus">-                if (!result)</span>
<a href="#l19.493"></a><span id="l19.493" class="difflineminus">-                  this.close();</span>
<a href="#l19.494"></a><span id="l19.494" class="difflineminus">-                aEvent.stopPropagation();</span>
<a href="#l19.495"></a><span id="l19.495" class="difflineminus">-              }</span>
<a href="#l19.496"></a><span id="l19.496" class="difflineminus">-            }</span>
<a href="#l19.497"></a><span id="l19.497" class="difflineminus">-          ]]&gt;</span>
<a href="#l19.498"></a><span id="l19.498" class="difflineminus">-        &lt;/body&gt;</span>
<a href="#l19.499"></a><span id="l19.499" class="difflineminus">-      &lt;/method&gt;</span>
<a href="#l19.500"></a><span id="l19.500" class="difflineminus">-    &lt;/implementation&gt;</span>
<a href="#l19.501"></a><span id="l19.501" class="difflineminus">-  &lt;/binding&gt;</span>
<a href="#l19.502"></a><span id="l19.502" class="difflineminus">-&lt;/bindings&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mail/base/content/bindings.css</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mail/base/content/bindings.css</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -1,14 +1,13 @@</span>
<a href="#l20.4"></a><span id="l20.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l20.5"></a><span id="l20.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l20.6"></a><span id="l20.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l20.7"></a><span id="l20.7"> </span>
<a href="#l20.8"></a><span id="l20.8"> @import url(&quot;chrome://messenger/skin/textbox.css&quot;);</span>
<a href="#l20.9"></a><span id="l20.9" class="difflineminus">-@import url(&quot;chrome://messenger/skin/xbl-notification.css&quot;);</span>
<a href="#l20.10"></a><span id="l20.10"> </span>
<a href="#l20.11"></a><span id="l20.11"> @namespace url(&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;);</span>
<a href="#l20.12"></a><span id="l20.12"> </span>
<a href="#l20.13"></a><span id="l20.13"> toolbox {</span>
<a href="#l20.14"></a><span id="l20.14">   -moz-binding: url(&quot;chrome://messenger/content/toolbar.xml#toolbox&quot;);</span>
<a href="#l20.15"></a><span id="l20.15"> }</span>
<a href="#l20.16"></a><span id="l20.16"> </span>
<a href="#l20.17"></a><span id="l20.17"> toolbar {</span>
<a href="#l20.18"></a><span id="l20.18" class="difflineat">@@ -29,27 +28,15 @@ toolbarpaletteitem {</span>
<a href="#l20.19"></a><span id="l20.19">   -moz-binding: url(&quot;chrome://messenger/content/toolbar.xml#toolbarpaletteitem&quot;);</span>
<a href="#l20.20"></a><span id="l20.20"> }</span>
<a href="#l20.21"></a><span id="l20.21"> </span>
<a href="#l20.22"></a><span id="l20.22"> toolbarpaletteitem[place=&quot;palette&quot;] {</span>
<a href="#l20.23"></a><span id="l20.23">   -moz-box-orient: vertical;</span>
<a href="#l20.24"></a><span id="l20.24">   -moz-binding: url(&quot;chrome://messenger/content/toolbar.xml#toolbarpaletteitem-palette&quot;);</span>
<a href="#l20.25"></a><span id="l20.25"> }</span>
<a href="#l20.26"></a><span id="l20.26"> </span>
<a href="#l20.27"></a><span id="l20.27" class="difflineminus">-notificationbox {</span>
<a href="#l20.28"></a><span id="l20.28" class="difflineminus">-  -moz-binding: url(&quot;chrome://messenger/content/notificationbox.xml#notificationbox&quot;);</span>
<a href="#l20.29"></a><span id="l20.29" class="difflineminus">-  -moz-box-orient: vertical;</span>
<a href="#l20.30"></a><span id="l20.30" class="difflineminus">-}</span>
<a href="#l20.31"></a><span id="l20.31" class="difflineminus">-.notificationbox-stack {</span>
<a href="#l20.32"></a><span id="l20.32" class="difflineminus">-  overflow: -moz-hidden-unscrollable;</span>
<a href="#l20.33"></a><span id="l20.33" class="difflineminus">-}</span>
<a href="#l20.34"></a><span id="l20.34" class="difflineminus">-</span>
<a href="#l20.35"></a><span id="l20.35" class="difflineminus">-xbl-notification {</span>
<a href="#l20.36"></a><span id="l20.36" class="difflineminus">-  -moz-binding: url(&quot;chrome://messenger/content/notificationbox.xml#notification&quot;);</span>
<a href="#l20.37"></a><span id="l20.37" class="difflineminus">-}</span>
<a href="#l20.38"></a><span id="l20.38" class="difflineminus">-</span>
<a href="#l20.39"></a><span id="l20.39"> button[type=&quot;menu-button&quot;] {</span>
<a href="#l20.40"></a><span id="l20.40">   -moz-binding: url(&quot;chrome://messenger/content/menubutton.xml#menu-button&quot;);</span>
<a href="#l20.41"></a><span id="l20.41"> }</span>
<a href="#l20.42"></a><span id="l20.42"> </span>
<a href="#l20.43"></a><span id="l20.43"> menulist[type=&quot;description&quot;] &gt; menupopup &gt; menuitem[description] {</span>
<a href="#l20.44"></a><span id="l20.44">   -moz-binding: url(&quot;chrome://messenger/content/mailWidgets.xml#menuitem-iconic-desc-noaccel&quot;);</span>
<a href="#l20.45"></a><span id="l20.45"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/mail/base/content/mail3PaneWindowCommands.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/mail/base/content/mail3PaneWindowCommands.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -2,31 +2,45 @@</span>
<a href="#l21.4"></a><span id="l21.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l21.5"></a><span id="l21.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l21.6"></a><span id="l21.6"> </span>
<a href="#l21.7"></a><span id="l21.7"> /**</span>
<a href="#l21.8"></a><span id="l21.8">  * Functionality for the main application window (aka the 3pane) usually</span>
<a href="#l21.9"></a><span id="l21.9">  * consisting of folder pane, thread pane and message pane.</span>
<a href="#l21.10"></a><span id="l21.10">  */</span>
<a href="#l21.11"></a><span id="l21.11"> </span>
<a href="#l21.12"></a><span id="l21.12" class="difflineplus">+/* global MozElements */</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+</span>
<a href="#l21.14"></a><span id="l21.14"> /* import-globals-from ../../components/im/content/chat-messenger.js */</span>
<a href="#l21.15"></a><span id="l21.15"> /* import-globals-from commandglue.js */</span>
<a href="#l21.16"></a><span id="l21.16"> /* import-globals-from folderDisplay.js */</span>
<a href="#l21.17"></a><span id="l21.17"> /* import-globals-from mailWindow.js */</span>
<a href="#l21.18"></a><span id="l21.18"> /* import-globals-from msgViewNavigation.js */</span>
<a href="#l21.19"></a><span id="l21.19"> /* import-globals-from threadPane.js */</span>
<a href="#l21.20"></a><span id="l21.20"> /* import-globals-from utilityOverlay.js */</span>
<a href="#l21.21"></a><span id="l21.21"> </span>
<a href="#l21.22"></a><span id="l21.22"> var {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l21.23"></a><span id="l21.23"> var {MailServices} = ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l21.24"></a><span id="l21.24"> var {MailUtils} = ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l21.25"></a><span id="l21.25"> var {PluralForm} = ChromeUtils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l21.26"></a><span id="l21.26"> </span>
<a href="#l21.27"></a><span id="l21.27"> // Controller object for folder pane</span>
<a href="#l21.28"></a><span id="l21.28"> var FolderPaneController = {</span>
<a href="#l21.29"></a><span id="l21.29" class="difflineplus">+  get notificationbox() {</span>
<a href="#l21.30"></a><span id="l21.30" class="difflineplus">+    delete this.notificationbox;</span>
<a href="#l21.31"></a><span id="l21.31" class="difflineplus">+</span>
<a href="#l21.32"></a><span id="l21.32" class="difflineplus">+    let newNotificationBox = new MozElements.NotificationBox(element =&gt; {</span>
<a href="#l21.33"></a><span id="l21.33" class="difflineplus">+      element.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l21.34"></a><span id="l21.34" class="difflineplus">+      element.setAttribute(&quot;notificationside&quot;, &quot;bottom&quot;);</span>
<a href="#l21.35"></a><span id="l21.35" class="difflineplus">+      document.getElementById(&quot;messenger-notification-footer&quot;).append(element);</span>
<a href="#l21.36"></a><span id="l21.36" class="difflineplus">+    });</span>
<a href="#l21.37"></a><span id="l21.37" class="difflineplus">+</span>
<a href="#l21.38"></a><span id="l21.38" class="difflineplus">+    return this.notificationbox = newNotificationBox;</span>
<a href="#l21.39"></a><span id="l21.39" class="difflineplus">+  },</span>
<a href="#l21.40"></a><span id="l21.40" class="difflineplus">+</span>
<a href="#l21.41"></a><span id="l21.41">   supportsCommand(command) {</span>
<a href="#l21.42"></a><span id="l21.42">     switch (command) {</span>
<a href="#l21.43"></a><span id="l21.43">       case &quot;cmd_delete&quot;:</span>
<a href="#l21.44"></a><span id="l21.44">       case &quot;cmd_shiftDelete&quot;:</span>
<a href="#l21.45"></a><span id="l21.45">       case &quot;button_delete&quot;:</span>
<a href="#l21.46"></a><span id="l21.46">       case &quot;button_shiftDelete&quot;:</span>
<a href="#l21.47"></a><span id="l21.47">         // Even if the folder pane has focus, don't do a folder delete if</span>
<a href="#l21.48"></a><span id="l21.48">         // we have a selected message, but do a message delete instead.</span>
<a href="#l21.49"></a><span id="l21.49" class="difflineat">@@ -679,30 +693,28 @@ var DefaultController = {</span>
<a href="#l21.50"></a><span id="l21.50">       case &quot;cmd_deleteFolder&quot;:</span>
<a href="#l21.51"></a><span id="l21.51">         gFolderTreeController.deleteFolder();</span>
<a href="#l21.52"></a><span id="l21.52">         break;</span>
<a href="#l21.53"></a><span id="l21.53">       case &quot;cmd_killThread&quot;:</span>
<a href="#l21.54"></a><span id="l21.54">         if (!gFolderDisplay.selectedMessageIsNews) {</span>
<a href="#l21.55"></a><span id="l21.55">           if (!gFolderDisplay.selectedMessageThreadIgnored) {</span>
<a href="#l21.56"></a><span id="l21.56">             ShowIgnoredMessageNotification(gFolderDisplay.selectedMessages, false);</span>
<a href="#l21.57"></a><span id="l21.57">           } else {</span>
<a href="#l21.58"></a><span id="l21.58" class="difflineminus">-            document.getElementById(&quot;msg-footer-notification-box&quot;)</span>
<a href="#l21.59"></a><span id="l21.59" class="difflineminus">-                    .removeTransientNotifications();</span>
<a href="#l21.60"></a><span id="l21.60" class="difflineplus">+            this.notificationbox.removeTransientNotifications();</span>
<a href="#l21.61"></a><span id="l21.61">           }</span>
<a href="#l21.62"></a><span id="l21.62">         }</span>
<a href="#l21.63"></a><span id="l21.63">         // kill thread kills the thread and then does a next unread</span>
<a href="#l21.64"></a><span id="l21.64">         GoNextMessage(Ci.nsMsgNavigationType.toggleThreadKilled, true);</span>
<a href="#l21.65"></a><span id="l21.65">         break;</span>
<a href="#l21.66"></a><span id="l21.66">       case &quot;cmd_killSubthread&quot;:</span>
<a href="#l21.67"></a><span id="l21.67">         if (!gFolderDisplay.selectedMessageIsNews) {</span>
<a href="#l21.68"></a><span id="l21.68">           if (!gFolderDisplay.selectedMessageSubthreadIgnored) {</span>
<a href="#l21.69"></a><span id="l21.69">             ShowIgnoredMessageNotification(gFolderDisplay.selectedMessages, true);</span>
<a href="#l21.70"></a><span id="l21.70">           } else {</span>
<a href="#l21.71"></a><span id="l21.71" class="difflineminus">-            document.getElementById(&quot;msg-footer-notification-box&quot;)</span>
<a href="#l21.72"></a><span id="l21.72" class="difflineminus">-                    .removeTransientNotifications();</span>
<a href="#l21.73"></a><span id="l21.73" class="difflineplus">+            this.notificationbox.removeTransientNotifications();</span>
<a href="#l21.74"></a><span id="l21.74">           }</span>
<a href="#l21.75"></a><span id="l21.75">         }</span>
<a href="#l21.76"></a><span id="l21.76">         GoNextMessage(Ci.nsMsgNavigationType.toggleSubthreadKilled, true);</span>
<a href="#l21.77"></a><span id="l21.77">         break;</span>
<a href="#l21.78"></a><span id="l21.78">       case &quot;cmd_watchThread&quot;:</span>
<a href="#l21.79"></a><span id="l21.79">         gFolderDisplay.doCommand(Ci.nsMsgViewCommandType.toggleThreadWatched);</span>
<a href="#l21.80"></a><span id="l21.80">         break;</span>
<a href="#l21.81"></a><span id="l21.81">       case &quot;button_next&quot;:</span>
<a href="#l21.82"></a><span id="l21.82" class="difflineat">@@ -1020,17 +1032,17 @@ var DefaultController = {</span>
<a href="#l21.83"></a><span id="l21.83"> /**</span>
<a href="#l21.84"></a><span id="l21.84">  * Show a notification in the message pane footer, allowing the user to learn</span>
<a href="#l21.85"></a><span id="l21.85">  * more about the ignore thread feature, and also allowing undo ignore thread.</span>
<a href="#l21.86"></a><span id="l21.86">  * @param aMsgs the messages that were ignore</span>
<a href="#l21.87"></a><span id="l21.87">  * @param aSubThread only boolean indicating if it was ignore subthread or</span>
<a href="#l21.88"></a><span id="l21.88">  *                   ignore thread</span>
<a href="#l21.89"></a><span id="l21.89">  */</span>
<a href="#l21.90"></a><span id="l21.90"> function ShowIgnoredMessageNotification(aMsgs, aSubthreadOnly) {</span>
<a href="#l21.91"></a><span id="l21.91" class="difflineminus">-  let notifyBox = document.getElementById(&quot;msg-footer-notification-box&quot;);</span>
<a href="#l21.92"></a><span id="l21.92" class="difflineplus">+  let notifyBox = FolderPaneController.notificationbox;</span>
<a href="#l21.93"></a><span id="l21.93">   notifyBox.removeTransientNotifications(); // don't want to pile these up</span>
<a href="#l21.94"></a><span id="l21.94"> </span>
<a href="#l21.95"></a><span id="l21.95">   let bundle = new StringBundle(&quot;chrome://messenger/locale/messenger.properties&quot;);</span>
<a href="#l21.96"></a><span id="l21.96"> </span>
<a href="#l21.97"></a><span id="l21.97">   let buttons = [</span>
<a href="#l21.98"></a><span id="l21.98">     {</span>
<a href="#l21.99"></a><span id="l21.99">       label:     bundle.get(&quot;learnMoreAboutIgnoreThread&quot;),</span>
<a href="#l21.100"></a><span id="l21.100">       accessKey: bundle.get(&quot;learnMoreAboutIgnoreThreadAccessKey&quot;),</span>
<a href="#l21.101"></a><span id="l21.101" class="difflineat">@@ -1069,18 +1081,19 @@ function ShowIgnoredMessageNotification(</span>
<a href="#l21.102"></a><span id="l21.102">       threadIds.add(msg.threadId);</span>
<a href="#l21.103"></a><span id="l21.103">   });</span>
<a href="#l21.104"></a><span id="l21.104">   let nbrOfThreads = threadIds.size;</span>
<a href="#l21.105"></a><span id="l21.105"> </span>
<a href="#l21.106"></a><span id="l21.106">   if (nbrOfThreads == 1) {</span>
<a href="#l21.107"></a><span id="l21.107">     let ignoredThreadText = bundle.get(!aSubthreadOnly ?</span>
<a href="#l21.108"></a><span id="l21.108">       &quot;ignoredThreadFeedback&quot; : &quot;ignoredSubthreadFeedback&quot;);</span>
<a href="#l21.109"></a><span id="l21.109">     let subj = aMsgs[0].mime2DecodedSubject || &quot;&quot;;</span>
<a href="#l21.110"></a><span id="l21.110" class="difflineminus">-    if (subj.length &gt; 45)</span>
<a href="#l21.111"></a><span id="l21.111" class="difflineplus">+    if (subj.length &gt; 45) {</span>
<a href="#l21.112"></a><span id="l21.112">       subj = subj.substring(0, 45) + &quot;…&quot;;</span>
<a href="#l21.113"></a><span id="l21.113" class="difflineplus">+    }</span>
<a href="#l21.114"></a><span id="l21.114">     let text = ignoredThreadText.replace(&quot;#1&quot;, subj);</span>
<a href="#l21.115"></a><span id="l21.115"> </span>
<a href="#l21.116"></a><span id="l21.116">     notifyBox.appendNotification(</span>
<a href="#l21.117"></a><span id="l21.117">       text, &quot;ignoreThreadInfo&quot;, null,</span>
<a href="#l21.118"></a><span id="l21.118">       notifyBox.PRIORITY_INFO_MEDIUM, buttons);</span>
<a href="#l21.119"></a><span id="l21.119">   } else {</span>
<a href="#l21.120"></a><span id="l21.120">     let ignoredThreadText = bundle.get(!aSubthreadOnly ?</span>
<a href="#l21.121"></a><span id="l21.121">       &quot;ignoredThreadsFeedback&quot; : &quot;ignoredSubthreadsFeedback&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mail/base/content/mailWidgets.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mail/base/content/mailWidgets.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -751,17 +751,16 @@ customElements.whenDefined(&quot;menulist&quot;).t</span>
<a href="#l22.4"></a><span id="l22.4"> </span>
<a href="#l22.5"></a><span id="l22.5">   const MenuBaseControl = MozElements.BaseControlMixin(MozElements.MozElementMixin(XULMenuElement));</span>
<a href="#l22.6"></a><span id="l22.6">   MenuBaseControl.implementCustomInterface(</span>
<a href="#l22.7"></a><span id="l22.7">     MozMenulistEditable, [Ci.nsIDOMXULMenuListElement, Ci.nsIDOMXULSelectControlElement]</span>
<a href="#l22.8"></a><span id="l22.8">   );</span>
<a href="#l22.9"></a><span id="l22.9"> </span>
<a href="#l22.10"></a><span id="l22.10">   customElements.define(&quot;menulist-editable&quot;, MozMenulistEditable, { extends: &quot;menulist&quot; });</span>
<a href="#l22.11"></a><span id="l22.11"> });</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-</span>
<a href="#l22.13"></a><span id="l22.13"> /**</span>
<a href="#l22.14"></a><span id="l22.14">  * The mail-multiemail-headerfield widgets shows multiple emails. It collapses long rows and allows</span>
<a href="#l22.15"></a><span id="l22.15">  * toggling the full view open. This widget is typically used in the message header pane to show</span>
<a href="#l22.16"></a><span id="l22.16">  * addresses for To, Cc, Bcc, and any other addressing type header that can contain more than one</span>
<a href="#l22.17"></a><span id="l22.17">  * mailbox.</span>
<a href="#l22.18"></a><span id="l22.18">  *</span>
<a href="#l22.19"></a><span id="l22.19">  * extends {MozXULElement}</span>
<a href="#l22.20"></a><span id="l22.20">  */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mail/base/content/mailWindowOverlay.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mail/base/content/mailWindowOverlay.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -1,13 +1,15 @@</span>
<a href="#l23.4"></a><span id="l23.4"> /* -*- indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l23.5"></a><span id="l23.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l23.6"></a><span id="l23.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l23.7"></a><span id="l23.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l23.8"></a><span id="l23.8"> </span>
<a href="#l23.9"></a><span id="l23.9" class="difflineplus">+/* global MozElements */</span>
<a href="#l23.10"></a><span id="l23.10" class="difflineplus">+</span>
<a href="#l23.11"></a><span id="l23.11"> /* import-globals-from ../../../mailnews/base/content/junkCommands.js */</span>
<a href="#l23.12"></a><span id="l23.12"> /* import-globals-from ../../../mailnews/extensions/newsblog/content/newsblogOverlay.js */</span>
<a href="#l23.13"></a><span id="l23.13"> /* import-globals-from commandglue.js */</span>
<a href="#l23.14"></a><span id="l23.14"> /* import-globals-from contentAreaClick.js */</span>
<a href="#l23.15"></a><span id="l23.15"> /* import-globals-from folderDisplay.js */</span>
<a href="#l23.16"></a><span id="l23.16"> /* import-globals-from mail3PaneWindowCommands.js */</span>
<a href="#l23.17"></a><span id="l23.17"> /* import-globals-from mailCommands.js */</span>
<a href="#l23.18"></a><span id="l23.18"> /* import-globals-from mailContextMenus.js */</span>
<a href="#l23.19"></a><span id="l23.19" class="difflineat">@@ -2528,17 +2530,24 @@ var gMessageNotificationBar = {</span>
<a href="#l23.20"></a><span id="l23.20"> </span>
<a href="#l23.21"></a><span id="l23.21">   get brandBundle() {</span>
<a href="#l23.22"></a><span id="l23.22">     delete this.brandBundle;</span>
<a href="#l23.23"></a><span id="l23.23">     return this.brandBundle = document.getElementById(&quot;bundle_brand&quot;);</span>
<a href="#l23.24"></a><span id="l23.24">   },</span>
<a href="#l23.25"></a><span id="l23.25"> </span>
<a href="#l23.26"></a><span id="l23.26">   get msgNotificationBar() {</span>
<a href="#l23.27"></a><span id="l23.27">     delete this.msgNotificationBar;</span>
<a href="#l23.28"></a><span id="l23.28" class="difflineminus">-    return this.msgNotificationBar = document.getElementById(&quot;msgNotificationBar&quot;);</span>
<a href="#l23.29"></a><span id="l23.29" class="difflineplus">+</span>
<a href="#l23.30"></a><span id="l23.30" class="difflineplus">+    let newNotificationBox = new MozElements.NotificationBox(element =&gt; {</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineplus">+      element.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineplus">+      element.setAttribute(&quot;notificationside&quot;, &quot;top&quot;);</span>
<a href="#l23.33"></a><span id="l23.33" class="difflineplus">+      document.getElementById(&quot;mail-notification-top&quot;).append(element);</span>
<a href="#l23.34"></a><span id="l23.34" class="difflineplus">+    });</span>
<a href="#l23.35"></a><span id="l23.35" class="difflineplus">+</span>
<a href="#l23.36"></a><span id="l23.36" class="difflineplus">+    return this.msgNotificationBar = newNotificationBox;</span>
<a href="#l23.37"></a><span id="l23.37">   },</span>
<a href="#l23.38"></a><span id="l23.38"> </span>
<a href="#l23.39"></a><span id="l23.39">   setJunkMsg(aMsgHdr) {</span>
<a href="#l23.40"></a><span id="l23.40">     goUpdateCommand(&quot;button_junk&quot;);</span>
<a href="#l23.41"></a><span id="l23.41"> </span>
<a href="#l23.42"></a><span id="l23.42">     let brandName = this.brandBundle.getString(&quot;brandShortName&quot;);</span>
<a href="#l23.43"></a><span id="l23.43">     let junkBarMsg = this.stringBundle.getFormattedString(&quot;junkBarMessage&quot;,</span>
<a href="#l23.44"></a><span id="l23.44">                                                           [brandName]);</span>
<a href="#l23.45"></a><span id="l23.45" class="difflineat">@@ -2601,31 +2610,37 @@ var gMessageNotificationBar = {</span>
<a href="#l23.46"></a><span id="l23.46"> </span>
<a href="#l23.47"></a><span id="l23.47">     let buttons = [{</span>
<a href="#l23.48"></a><span id="l23.48">       label: buttonLabel,</span>
<a href="#l23.49"></a><span id="l23.49">       accessKey: buttonAccesskey,</span>
<a href="#l23.50"></a><span id="l23.50">       popup: &quot;remoteContentOptions&quot;,</span>
<a href="#l23.51"></a><span id="l23.51">       callback() {},</span>
<a href="#l23.52"></a><span id="l23.52">     }];</span>
<a href="#l23.53"></a><span id="l23.53"> </span>
<a href="#l23.54"></a><span id="l23.54" class="difflineplus">+    // The popup value is a space separated list of all the blocked origins.</span>
<a href="#l23.55"></a><span id="l23.55" class="difflineplus">+    let popup = document.getElementById(&quot;remoteContentOptions&quot;);</span>
<a href="#l23.56"></a><span id="l23.56" class="difflineplus">+    let principal = Services.scriptSecurityManager</span>
<a href="#l23.57"></a><span id="l23.57" class="difflineplus">+                            .createCodebasePrincipal(aContentURI, {});</span>
<a href="#l23.58"></a><span id="l23.58" class="difflineplus">+    let origins = popup.value ? popup.value.split(&quot; &quot;) : [];</span>
<a href="#l23.59"></a><span id="l23.59" class="difflineplus">+    if (!origins.includes(principal.origin)) {</span>
<a href="#l23.60"></a><span id="l23.60" class="difflineplus">+      origins.push(principal.origin);</span>
<a href="#l23.61"></a><span id="l23.61" class="difflineplus">+    }</span>
<a href="#l23.62"></a><span id="l23.62" class="difflineplus">+    popup.value = origins.join(&quot; &quot;);</span>
<a href="#l23.63"></a><span id="l23.63" class="difflineplus">+</span>
<a href="#l23.64"></a><span id="l23.64">     if (!this.isShowingRemoteContentNotification()) {</span>
<a href="#l23.65"></a><span id="l23.65" class="difflineminus">-      this.msgNotificationBar.appendNotification(remoteContentMsg, &quot;remoteContent&quot;,</span>
<a href="#l23.66"></a><span id="l23.66" class="difflineplus">+      let notification = this.msgNotificationBar.appendNotification(</span>
<a href="#l23.67"></a><span id="l23.67" class="difflineplus">+        remoteContentMsg,</span>
<a href="#l23.68"></a><span id="l23.68" class="difflineplus">+        &quot;remoteContent&quot;,</span>
<a href="#l23.69"></a><span id="l23.69">         &quot;chrome://messenger/skin/icons/remote-blocked.svg&quot;,</span>
<a href="#l23.70"></a><span id="l23.70">         this.msgNotificationBar.PRIORITY_WARNING_MEDIUM,</span>
<a href="#l23.71"></a><span id="l23.71">         (aCanOverride ? buttons : []));</span>
<a href="#l23.72"></a><span id="l23.72" class="difflineplus">+</span>
<a href="#l23.73"></a><span id="l23.73" class="difflineplus">+      let button = notification.spacer.nextSibling;</span>
<a href="#l23.74"></a><span id="l23.74" class="difflineplus">+      button.classList.add(&quot;button-menu-list&quot;);</span>
<a href="#l23.75"></a><span id="l23.75">     }</span>
<a href="#l23.76"></a><span id="l23.76" class="difflineminus">-</span>
<a href="#l23.77"></a><span id="l23.77" class="difflineminus">-    // The popup value is a space separated list of all the blocked origins.</span>
<a href="#l23.78"></a><span id="l23.78" class="difflineminus">-    let popup = document.getElementById(&quot;remoteContentOptions&quot;);</span>
<a href="#l23.79"></a><span id="l23.79" class="difflineminus">-    let principal = Services.scriptSecurityManager</span>
<a href="#l23.80"></a><span id="l23.80" class="difflineminus">-      .createCodebasePrincipal(aContentURI, {});</span>
<a href="#l23.81"></a><span id="l23.81" class="difflineminus">-    let origins = popup.value ? popup.value.split(&quot; &quot;) : [];</span>
<a href="#l23.82"></a><span id="l23.82" class="difflineminus">-    if (!origins.includes(principal.origin))</span>
<a href="#l23.83"></a><span id="l23.83" class="difflineminus">-      origins.push(principal.origin);</span>
<a href="#l23.84"></a><span id="l23.84" class="difflineminus">-    popup.value = origins.join(&quot; &quot;);</span>
<a href="#l23.85"></a><span id="l23.85">   },</span>
<a href="#l23.86"></a><span id="l23.86"> </span>
<a href="#l23.87"></a><span id="l23.87">   isShowingRemoteContentNotification() {</span>
<a href="#l23.88"></a><span id="l23.88">     return !!this.msgNotificationBar.getNotificationWithValue(&quot;remoteContent&quot;);</span>
<a href="#l23.89"></a><span id="l23.89">   },</span>
<a href="#l23.90"></a><span id="l23.90"> </span>
<a href="#l23.91"></a><span id="l23.91">   setPhishingMsg() {</span>
<a href="#l23.92"></a><span id="l23.92">     let phishingMsgNote = this.stringBundle.getString(&quot;phishingBarMessage&quot;);</span>
<a href="#l23.93"></a><span id="l23.93" class="difflineat">@@ -2639,20 +2654,24 @@ var gMessageNotificationBar = {</span>
<a href="#l23.94"></a><span id="l23.94">     {</span>
<a href="#l23.95"></a><span id="l23.95">       label: buttonLabel,</span>
<a href="#l23.96"></a><span id="l23.96">       accessKey: buttonAccesskey,</span>
<a href="#l23.97"></a><span id="l23.97">       popup: &quot;phishingOptions&quot;,</span>
<a href="#l23.98"></a><span id="l23.98">       callback(aNotification, aButton) {},</span>
<a href="#l23.99"></a><span id="l23.99">     }];</span>
<a href="#l23.100"></a><span id="l23.100"> </span>
<a href="#l23.101"></a><span id="l23.101">     if (!this.isShowingPhishingNotification()) {</span>
<a href="#l23.102"></a><span id="l23.102" class="difflineminus">-       this.msgNotificationBar.appendNotification(phishingMsgNote, &quot;maybeScam&quot;,</span>
<a href="#l23.103"></a><span id="l23.103" class="difflineminus">-         &quot;chrome://messenger/skin/icons/phishing.png&quot;,</span>
<a href="#l23.104"></a><span id="l23.104" class="difflineminus">-         this.msgNotificationBar.PRIORITY_CRITICAL_MEDIUM,</span>
<a href="#l23.105"></a><span id="l23.105" class="difflineminus">-         buttons);</span>
<a href="#l23.106"></a><span id="l23.106" class="difflineplus">+      let notification = this.msgNotificationBar.appendNotification(</span>
<a href="#l23.107"></a><span id="l23.107" class="difflineplus">+        phishingMsgNote, &quot;maybeScam&quot;,</span>
<a href="#l23.108"></a><span id="l23.108" class="difflineplus">+        &quot;chrome://messenger/skin/icons/phishing.png&quot;,</span>
<a href="#l23.109"></a><span id="l23.109" class="difflineplus">+        this.msgNotificationBar.PRIORITY_CRITICAL_MEDIUM,</span>
<a href="#l23.110"></a><span id="l23.110" class="difflineplus">+        buttons);</span>
<a href="#l23.111"></a><span id="l23.111" class="difflineplus">+</span>
<a href="#l23.112"></a><span id="l23.112" class="difflineplus">+      let button = notification.spacer.nextSibling;</span>
<a href="#l23.113"></a><span id="l23.113" class="difflineplus">+      button.classList.add(&quot;button-menu-list&quot;);</span>
<a href="#l23.114"></a><span id="l23.114">     }</span>
<a href="#l23.115"></a><span id="l23.115">   },</span>
<a href="#l23.116"></a><span id="l23.116"> </span>
<a href="#l23.117"></a><span id="l23.117">   isShowingPhishingNotification() {</span>
<a href="#l23.118"></a><span id="l23.118">     return !!this.msgNotificationBar.getNotificationWithValue(&quot;maybeScam&quot;);</span>
<a href="#l23.119"></a><span id="l23.119">   },</span>
<a href="#l23.120"></a><span id="l23.120"> </span>
<a href="#l23.121"></a><span id="l23.121">   setMDNMsg(aMdnGenerator, aMsgHeader, aMimeHdr) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/mail/base/content/messageWindow.xul</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/mail/base/content/messageWindow.xul</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -200,17 +200,19 @@</span>
<a href="#l24.4"></a><span id="l24.4">           ondrop=&quot;nsDragAndDrop.drop(event, messagepaneObserver);&quot;</span>
<a href="#l24.5"></a><span id="l24.5">           ondragexit=&quot;nsDragAndDrop.dragExit(event, messagepaneObserver);&quot;&gt;</span>
<a href="#l24.6"></a><span id="l24.6"> </span>
<a href="#l24.7"></a><span id="l24.7">       &lt;hbox id=&quot;msgHeaderView&quot; collapsed=&quot;true&quot; class=&quot;main-header-area&quot;&gt;</span>
<a href="#l24.8"></a><span id="l24.8"> #include msgHdrView.inc.xul</span>
<a href="#l24.9"></a><span id="l24.9">       &lt;/hbox&gt;</span>
<a href="#l24.10"></a><span id="l24.10">       &lt;!-- The msgNotificationBar appears on top of the message and displays</span>
<a href="#l24.11"></a><span id="l24.11">            information like: junk, mdn, remote content and phishing warnings --&gt;</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-      &lt;notificationbox id=&quot;msgNotificationBar&quot; notificationside=&quot;top&quot;/&gt;</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+      &lt;hbox id=&quot;mail-notification-top&quot;&gt;</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineplus">+        &lt;!-- notificationbox will be added here lazily. --&gt;</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineplus">+      &lt;/hbox&gt;</span>
<a href="#l24.16"></a><span id="l24.16"> </span>
<a href="#l24.17"></a><span id="l24.17">       &lt;!-- message view --&gt;</span>
<a href="#l24.18"></a><span id="l24.18">       &lt;browser id=&quot;messagepane&quot; context=&quot;mailContext&quot; tooltip=&quot;aHTMLTooltip&quot;</span>
<a href="#l24.19"></a><span id="l24.19">                style=&quot;height: 0px; min-height: 1px&quot; flex=&quot;1&quot; name=&quot;messagepane&quot;</span>
<a href="#l24.20"></a><span id="l24.20">                disablesecurity=&quot;true&quot; disablehistory=&quot;true&quot; type=&quot;content&quot; primary=&quot;true&quot;</span>
<a href="#l24.21"></a><span id="l24.21">                onresize=&quot;return messagePaneOnResize(event);&quot; autofind=&quot;false&quot;</span>
<a href="#l24.22"></a><span id="l24.22">                src=&quot;about:blank&quot; onclick=&quot;return contentAreaClick(event);&quot; /&gt;</span>
<a href="#l24.23"></a><span id="l24.23">       &lt;splitter id=&quot;attachment-splitter&quot; collapse=&quot;after&quot; resizebefore=&quot;closest&quot; resizeafter=&quot;closest&quot; collapsed=&quot;true&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/mail/base/content/messenger.css</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/mail/base/content/messenger.css</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -1,15 +1,16 @@</span>
<a href="#l25.4"></a><span id="l25.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l25.5"></a><span id="l25.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l25.6"></a><span id="l25.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l25.7"></a><span id="l25.7"> </span>
<a href="#l25.8"></a><span id="l25.8"> /* ===== messenger.css ==================================================</span>
<a href="#l25.9"></a><span id="l25.9">   == Content specific styles for Messenger.</span>
<a href="#l25.10"></a><span id="l25.10">   ======================================================================= */</span>
<a href="#l25.11"></a><span id="l25.11" class="difflineplus">+@import url(&quot;chrome://messenger/content/notification.css&quot;);</span>
<a href="#l25.12"></a><span id="l25.12"> </span>
<a href="#l25.13"></a><span id="l25.13"> @namespace url(&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;);</span>
<a href="#l25.14"></a><span id="l25.14"> </span>
<a href="#l25.15"></a><span id="l25.15"> :root {</span>
<a href="#l25.16"></a><span id="l25.16">   --lwt-additional-images: none;</span>
<a href="#l25.17"></a><span id="l25.17">   --lwt-background-alignment: right top;</span>
<a href="#l25.18"></a><span id="l25.18">   --lwt-background-tiling: no-repeat;</span>
<a href="#l25.19"></a><span id="l25.19"> </span>
<a href="#l25.20"></a><span id="l25.20" class="difflineat">@@ -567,9 +568,9 @@ statuspanel[label=&quot;&quot;],</span>
<a href="#l25.21"></a><span id="l25.21"> statuspanel:not([label]) {</span>
<a href="#l25.22"></a><span id="l25.22">   opacity: 0;</span>
<a href="#l25.23"></a><span id="l25.23">   pointer-events: none;</span>
<a href="#l25.24"></a><span id="l25.24"> }</span>
<a href="#l25.25"></a><span id="l25.25"> </span>
<a href="#l25.26"></a><span id="l25.26"> .statuspanel-inner {</span>
<a href="#l25.27"></a><span id="l25.27">   height: 3em;</span>
<a href="#l25.28"></a><span id="l25.28">   -moz-box-align: end;</span>
<a href="#l25.29"></a><span id="l25.29" class="difflineminus">-}</span>
<a href="#l25.30"></a><span id="l25.30" class="difflineplus">+}</span>
<a href="#l25.31"></a><span id="l25.31">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mail/base/content/messenger.xul</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mail/base/content/messenger.xul</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -674,17 +674,19 @@</span>
<a href="#l26.4"></a><span id="l26.4">                              autofind=&quot;false&quot;/&gt;</span>
<a href="#l26.5"></a><span id="l26.5">                     &lt;vbox id=&quot;singlemessage&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l26.6"></a><span id="l26.6">                       &lt;hbox id=&quot;msgHeaderView&quot; collapsed=&quot;true&quot; class=&quot;main-header-area&quot;&gt;</span>
<a href="#l26.7"></a><span id="l26.7"> #include msgHdrView.inc.xul</span>
<a href="#l26.8"></a><span id="l26.8">                       &lt;/hbox&gt;</span>
<a href="#l26.9"></a><span id="l26.9">                       &lt;!-- The msgNotificationBar appears on top of the message</span>
<a href="#l26.10"></a><span id="l26.10">                            and displays information like: junk, contains remote</span>
<a href="#l26.11"></a><span id="l26.11">                            images, or is a suspected phishing URL. --&gt;</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-                      &lt;notificationbox id=&quot;msgNotificationBar&quot; notificationside=&quot;top&quot;/&gt;</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+                      &lt;hbox id=&quot;mail-notification-top&quot;&gt;</span>
<a href="#l26.14"></a><span id="l26.14" class="difflineplus">+                        &lt;!-- notificationbox will be added here lazily. --&gt;</span>
<a href="#l26.15"></a><span id="l26.15" class="difflineplus">+                      &lt;/hbox&gt;</span>
<a href="#l26.16"></a><span id="l26.16">                       &lt;!-- The messagepanewrapper hbox exists to allow</span>
<a href="#l26.17"></a><span id="l26.17">                            extensions to add sidebars to the message. --&gt;</span>
<a href="#l26.18"></a><span id="l26.18">                       &lt;hbox id=&quot;messagepanewrapper&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l26.19"></a><span id="l26.19">                         &lt;browser id=&quot;messagepane&quot; context=&quot;mailContext&quot;</span>
<a href="#l26.20"></a><span id="l26.20">                                  autofind=&quot;false&quot; minheight=&quot;1&quot; flex=&quot;1&quot;</span>
<a href="#l26.21"></a><span id="l26.21">                                  name=&quot;messagepane&quot; tooltip=&quot;aHTMLTooltip&quot;</span>
<a href="#l26.22"></a><span id="l26.22">                                  disablehistory=&quot;true&quot; type=&quot;content&quot;</span>
<a href="#l26.23"></a><span id="l26.23">                                  primary=&quot;true&quot; src=&quot;about:blank&quot;</span>
<a href="#l26.24"></a><span id="l26.24" class="difflineat">@@ -697,17 +699,19 @@</span>
<a href="#l26.25"></a><span id="l26.25">                                 collapsed=&quot;true&quot;/&gt;</span>
<a href="#l26.26"></a><span id="l26.26">                       &lt;vbox id=&quot;attachmentView&quot; collapsed=&quot;true&quot;&gt;</span>
<a href="#l26.27"></a><span id="l26.27"> #include msgAttachmentView.inc.xul</span>
<a href="#l26.28"></a><span id="l26.28">                       &lt;/vbox&gt;</span>
<a href="#l26.29"></a><span id="l26.29">                       &lt;findbar id=&quot;FindToolbar&quot; browserid=&quot;messagepane&quot;/&gt;</span>
<a href="#l26.30"></a><span id="l26.30">                     &lt;/vbox&gt;</span>
<a href="#l26.31"></a><span id="l26.31">                   &lt;/vbox&gt;</span>
<a href="#l26.32"></a><span id="l26.32">                 &lt;/hbox&gt;</span>
<a href="#l26.33"></a><span id="l26.33" class="difflineminus">-               &lt;notificationbox id=&quot;msg-footer-notification-box&quot; notificationside=&quot;bottom&quot;/&gt;</span>
<a href="#l26.34"></a><span id="l26.34" class="difflineplus">+                &lt;hbox id=&quot;messenger-notification-footer&quot;&gt;</span>
<a href="#l26.35"></a><span id="l26.35" class="difflineplus">+                  &lt;!-- notificationbox will be added here lazily. --&gt;</span>
<a href="#l26.36"></a><span id="l26.36" class="difflineplus">+                &lt;/hbox&gt;</span>
<a href="#l26.37"></a><span id="l26.37">               &lt;/box&gt;</span>
<a href="#l26.38"></a><span id="l26.38">             &lt;/vbox&gt;</span>
<a href="#l26.39"></a><span id="l26.39">           &lt;/box&gt;</span>
<a href="#l26.40"></a><span id="l26.40">         &lt;/box&gt; &lt;!-- end of mailContent --&gt;</span>
<a href="#l26.41"></a><span id="l26.41"> #include ../../components/im/content/chat-messenger.inc.xul</span>
<a href="#l26.42"></a><span id="l26.42">       &lt;/tabpanels&gt;</span>
<a href="#l26.43"></a><span id="l26.43">      &lt;/tabbox&gt;</span>
<a href="#l26.44"></a><span id="l26.44">     &lt;/tabmail&gt;</span>
<a href="#l26.45"></a><span id="l26.45" class="difflineat">@@ -718,34 +722,30 @@</span>
<a href="#l26.46"></a><span id="l26.46">             &lt;toolbaritem class=&quot;contentTabAddress&quot; align=&quot;center&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l26.47"></a><span id="l26.47">               &lt;hbox class=&quot;themeableSearchBox&quot; align=&quot;center&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l26.48"></a><span id="l26.48">                 &lt;image class=&quot;contentTabSecurity&quot;/&gt;</span>
<a href="#l26.49"></a><span id="l26.49">                 &lt;label class=&quot;contentTabUrlbar&quot; crop=&quot;end&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l26.50"></a><span id="l26.50">               &lt;/hbox&gt;</span>
<a href="#l26.51"></a><span id="l26.51">             &lt;/toolbaritem&gt;</span>
<a href="#l26.52"></a><span id="l26.52">           &lt;/hbox&gt;</span>
<a href="#l26.53"></a><span id="l26.53">         &lt;/vbox&gt;</span>
<a href="#l26.54"></a><span id="l26.54" class="difflineminus">-        &lt;notificationbox flex=&quot;1&quot; notificationside=&quot;top&quot;&gt;</span>
<a href="#l26.55"></a><span id="l26.55" class="difflineminus">-          &lt;browser id=&quot;dummycontentbrowser&quot; type=&quot;content&quot; flex=&quot;1&quot;</span>
<a href="#l26.56"></a><span id="l26.56" class="difflineminus">-                   disablehistory=&quot;true&quot; autocompletepopup=&quot;PopupAutoComplete&quot;</span>
<a href="#l26.57"></a><span id="l26.57" class="difflineminus">-                   context=&quot;mailContext&quot;/&gt;</span>
<a href="#l26.58"></a><span id="l26.58" class="difflineminus">-        &lt;/notificationbox&gt;</span>
<a href="#l26.59"></a><span id="l26.59" class="difflineplus">+        &lt;browser id=&quot;dummycontentbrowser&quot; type=&quot;content&quot; flex=&quot;1&quot;</span>
<a href="#l26.60"></a><span id="l26.60" class="difflineplus">+                 disablehistory=&quot;true&quot; autocompletepopup=&quot;PopupAutoComplete&quot;</span>
<a href="#l26.61"></a><span id="l26.61" class="difflineplus">+                 context=&quot;mailContext&quot;/&gt;</span>
<a href="#l26.62"></a><span id="l26.62">       &lt;/vbox&gt;</span>
<a href="#l26.63"></a><span id="l26.63">     &lt;/vbox&gt;</span>
<a href="#l26.64"></a><span id="l26.64"> </span>
<a href="#l26.65"></a><span id="l26.65">     &lt;vbox id=&quot;chromeTab&quot; collapsed=&quot;true&quot;&gt;</span>
<a href="#l26.66"></a><span id="l26.66">       &lt;vbox flex=&quot;1&quot; class=&quot;chromeTabInstance&quot;&gt;</span>
<a href="#l26.67"></a><span id="l26.67">         &lt;vbox id=&quot;dummychrometoolbox&quot; class=&quot;contentTabToolbox&quot;&gt;</span>
<a href="#l26.68"></a><span id="l26.68">           &lt;hbox id=&quot;dummychrometoolbar&quot; class=&quot;contentTabToolbar&quot;&gt;&lt;/hbox&gt;</span>
<a href="#l26.69"></a><span id="l26.69">         &lt;/vbox&gt;</span>
<a href="#l26.70"></a><span id="l26.70" class="difflineminus">-        &lt;notificationbox flex=&quot;1&quot; notificationside=&quot;top&quot;&gt;</span>
<a href="#l26.71"></a><span id="l26.71" class="difflineminus">-          &lt;browser id=&quot;dummychromebrowser&quot; flex=&quot;1&quot;</span>
<a href="#l26.72"></a><span id="l26.72" class="difflineminus">-                   disablesecurity=&quot;true&quot; disablehistory=&quot;true&quot;</span>
<a href="#l26.73"></a><span id="l26.73" class="difflineminus">-                   autocompletepopup=&quot;PopupAutoComplete&quot;/&gt;</span>
<a href="#l26.74"></a><span id="l26.74" class="difflineminus">-        &lt;/notificationbox&gt;</span>
<a href="#l26.75"></a><span id="l26.75" class="difflineplus">+        &lt;browser id=&quot;dummychromebrowser&quot; flex=&quot;1&quot;</span>
<a href="#l26.76"></a><span id="l26.76" class="difflineplus">+                 disablesecurity=&quot;true&quot; disablehistory=&quot;true&quot;</span>
<a href="#l26.77"></a><span id="l26.77" class="difflineplus">+                 autocompletepopup=&quot;PopupAutoComplete&quot;/&gt;</span>
<a href="#l26.78"></a><span id="l26.78">       &lt;/vbox&gt;</span>
<a href="#l26.79"></a><span id="l26.79">     &lt;/vbox&gt;</span>
<a href="#l26.80"></a><span id="l26.80"> </span>
<a href="#l26.81"></a><span id="l26.81">     &lt;vbox id=&quot;glodaTab&quot; collapsed=&quot;true&quot;&gt;</span>
<a href="#l26.82"></a><span id="l26.82">       &lt;vbox flex=&quot;1&quot; class=&quot;chromeTabInstance&quot;&gt;</span>
<a href="#l26.83"></a><span id="l26.83">         &lt;vbox class=&quot;contentTabToolbox&quot;&gt;</span>
<a href="#l26.84"></a><span id="l26.84">           &lt;hbox class=&quot;glodaTabToolbar inline-toolbar chromeclass-toolbar&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l26.85"></a><span id="l26.85">             &lt;spacer flex=&quot;1&quot; /&gt;</span>
<a href="#l26.86"></a><span id="l26.86" class="difflineat">@@ -771,34 +771,36 @@</span>
<a href="#l26.87"></a><span id="l26.87">             &lt;/hbox&gt;</span>
<a href="#l26.88"></a><span id="l26.88">           &lt;/hbox&gt;</span>
<a href="#l26.89"></a><span id="l26.89">         &lt;/vbox&gt;</span>
<a href="#l26.90"></a><span id="l26.90">         &lt;iframe flex=&quot;1&quot;/&gt;</span>
<a href="#l26.91"></a><span id="l26.91">       &lt;/vbox&gt;</span>
<a href="#l26.92"></a><span id="l26.92">     &lt;/vbox&gt;</span>
<a href="#l26.93"></a><span id="l26.93">     &lt;vbox id=&quot;preferencesTab&quot; collapsed=&quot;true&quot;&gt;</span>
<a href="#l26.94"></a><span id="l26.94">       &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l26.95"></a><span id="l26.95" class="difflineminus">-        &lt;notificationbox flex=&quot;1&quot;&gt;</span>
<a href="#l26.96"></a><span id="l26.96" class="difflineplus">+        &lt;hbox flex=&quot;1&quot;&gt;</span>
<a href="#l26.97"></a><span id="l26.97">           &lt;browser id=&quot;preferencesbrowser&quot;</span>
<a href="#l26.98"></a><span id="l26.98">                    type=&quot;content&quot;</span>
<a href="#l26.99"></a><span id="l26.99">                    flex=&quot;1&quot;</span>
<a href="#l26.100"></a><span id="l26.100">                    disablehistory=&quot;true&quot;</span>
<a href="#l26.101"></a><span id="l26.101">                    onclick=&quot;specialTabs.defaultClickHandler(event);&quot;/&gt;</span>
<a href="#l26.102"></a><span id="l26.102" class="difflineminus">-        &lt;/notificationbox&gt;</span>
<a href="#l26.103"></a><span id="l26.103" class="difflineplus">+        &lt;/hbox&gt;</span>
<a href="#l26.104"></a><span id="l26.104">         &lt;findbar browserid=&quot;preferencesbrowser&quot;/&gt;</span>
<a href="#l26.105"></a><span id="l26.105">       &lt;/vbox&gt;</span>
<a href="#l26.106"></a><span id="l26.106">     &lt;/vbox&gt;</span>
<a href="#l26.107"></a><span id="l26.107">   &lt;/hbox&gt;</span>
<a href="#l26.108"></a><span id="l26.108">   &lt;panel id=&quot;customizeToolbarSheetPopup&quot; noautohide=&quot;true&quot;&gt;</span>
<a href="#l26.109"></a><span id="l26.109">     &lt;iframe id=&quot;customizeToolbarSheetIFrame&quot;</span>
<a href="#l26.110"></a><span id="l26.110">             style=&quot;&amp;dialog.dimensions;&quot;</span>
<a href="#l26.111"></a><span id="l26.111">             hidden=&quot;true&quot;/&gt;</span>
<a href="#l26.112"></a><span id="l26.112">   &lt;/panel&gt;</span>
<a href="#l26.113"></a><span id="l26.113"> </span>
<a href="#l26.114"></a><span id="l26.114" class="difflineminus">-  &lt;notificationbox id=&quot;mail-notification-box&quot; notificationside=&quot;bottom&quot;/&gt;</span>
<a href="#l26.115"></a><span id="l26.115" class="difflineplus">+  &lt;hbox id=&quot;messenger-notification-bottom&quot;&gt;</span>
<a href="#l26.116"></a><span id="l26.116" class="difflineplus">+      &lt;!-- notificationbox will be added here lazily. --&gt;</span>
<a href="#l26.117"></a><span id="l26.117" class="difflineplus">+  &lt;/hbox&gt;</span>
<a href="#l26.118"></a><span id="l26.118">   &lt;statuspanel id=&quot;statusbar-display&quot;/&gt;</span>
<a href="#l26.119"></a><span id="l26.119">   &lt;hbox id=&quot;status-bar&quot; class=&quot;statusbar chromeclass-status&quot;&gt;</span>
<a href="#l26.120"></a><span id="l26.120"> #include mainStatusbar.inc.xul</span>
<a href="#l26.121"></a><span id="l26.121">     &lt;statusbarpanel id=&quot;unreadMessageCount&quot;/&gt;</span>
<a href="#l26.122"></a><span id="l26.122">     &lt;statusbarpanel id=&quot;totalMessageCount&quot;/&gt;</span>
<a href="#l26.123"></a><span id="l26.123">   &lt;/hbox&gt;</span>
<a href="#l26.124"></a><span id="l26.124"> </span>
<a href="#l26.125"></a><span id="l26.125"> &lt;/window&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mail/base/content/msgMail3PaneWindow.js</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mail/base/content/msgMail3PaneWindow.js</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -317,17 +317,17 @@ function UpdateMailPaneConfig(aMsgWindow</span>
<a href="#l27.4"></a><span id="l27.4"> </span>
<a href="#l27.5"></a><span id="l27.5">     // See Bug 381992. The ctor for the browser element will fire again when we</span>
<a href="#l27.6"></a><span id="l27.6">     // re-insert the messagePaneBoxWrapper back into the document.  But the dtor</span>
<a href="#l27.7"></a><span id="l27.7">     // doesn't fire when the element is removed from the document.  Manually</span>
<a href="#l27.8"></a><span id="l27.8">     // call destroy here to avoid a nasty leak.</span>
<a href="#l27.9"></a><span id="l27.9">     document.getElementById(&quot;messagepane&quot;).destroy();</span>
<a href="#l27.10"></a><span id="l27.10">     document.getElementById(&quot;FindToolbar&quot;).destroy();</span>
<a href="#l27.11"></a><span id="l27.11">     let footerBox = desiredParent.lastChild;</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-    if (footerBox &amp;&amp; footerBox.id == &quot;msg-footer-notification-box&quot;) {</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+    if (footerBox &amp;&amp; footerBox.id == &quot;messenger-notification-footer&quot;) {</span>
<a href="#l27.14"></a><span id="l27.14">       desiredParent.insertBefore(messagePaneSplitter, footerBox);</span>
<a href="#l27.15"></a><span id="l27.15">       desiredParent.insertBefore(messagePaneBoxWrapper, footerBox);</span>
<a href="#l27.16"></a><span id="l27.16">     } else {</span>
<a href="#l27.17"></a><span id="l27.17">       desiredParent.appendChild(messagePaneSplitter);</span>
<a href="#l27.18"></a><span id="l27.18">       desiredParent.appendChild(messagePaneBoxWrapper);</span>
<a href="#l27.19"></a><span id="l27.19">     }</span>
<a href="#l27.20"></a><span id="l27.20">     hdrToolbox.palette  = cloneToolboxPalette;</span>
<a href="#l27.21"></a><span id="l27.21">     hdrToolbox.toolbarset = cloneToolbarset;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1">new file mode 100644</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineminus">--- /dev/null</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineplus">+++ b/mail/base/content/notification.css</span>
<a href="#l28.4"></a><span id="l28.4" class="difflineat">@@ -0,0 +1,40 @@</span>
<a href="#l28.5"></a><span id="l28.5" class="difflineplus">+/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l28.6"></a><span id="l28.6" class="difflineplus">+ * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l28.7"></a><span id="l28.7" class="difflineplus">+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l28.8"></a><span id="l28.8" class="difflineplus">+</span>
<a href="#l28.9"></a><span id="l28.9" class="difflineplus">+/* ===== notification.css ===============================================</span>
<a href="#l28.10"></a><span id="l28.10" class="difflineplus">+  == Content specific styles for Notification.</span>
<a href="#l28.11"></a><span id="l28.11" class="difflineplus">+  ======================================================================= */</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineplus">+</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+notification[type=&quot;warning&quot;] {</span>
<a href="#l28.14"></a><span id="l28.14" class="difflineplus">+  background: #fff160;</span>
<a href="#l28.15"></a><span id="l28.15" class="difflineplus">+}</span>
<a href="#l28.16"></a><span id="l28.16" class="difflineplus">+</span>
<a href="#l28.17"></a><span id="l28.17" class="difflineplus">+notification[type=&quot;info&quot;] &gt; hbox &gt; .messageImage {</span>
<a href="#l28.18"></a><span id="l28.18" class="difflineplus">+  list-style-image: url(&quot;chrome://global/skin/icons/help.svg&quot;);</span>
<a href="#l28.19"></a><span id="l28.19" class="difflineplus">+}</span>
<a href="#l28.20"></a><span id="l28.20" class="difflineplus">+</span>
<a href="#l28.21"></a><span id="l28.21" class="difflineplus">+notification[type=&quot;warning&quot;] &gt; hbox &gt; .messageImage {</span>
<a href="#l28.22"></a><span id="l28.22" class="difflineplus">+  list-style-image: url(&quot;chrome://global/skin/icons/warning.svg&quot;);</span>
<a href="#l28.23"></a><span id="l28.23" class="difflineplus">+}</span>
<a href="#l28.24"></a><span id="l28.24" class="difflineplus">+</span>
<a href="#l28.25"></a><span id="l28.25" class="difflineplus">+notification[type=&quot;critical&quot;] &gt; hbox &gt; .messageImage {</span>
<a href="#l28.26"></a><span id="l28.26" class="difflineplus">+  list-style-image: url(&quot;chrome://global/skin/icons/error.svg&quot;);</span>
<a href="#l28.27"></a><span id="l28.27" class="difflineplus">+}</span>
<a href="#l28.28"></a><span id="l28.28" class="difflineplus">+</span>
<a href="#l28.29"></a><span id="l28.29" class="difflineplus">+notification[value=&quot;draftMsgContent&quot;] &gt; hbox &gt; .messageImage {</span>
<a href="#l28.30"></a><span id="l28.30" class="difflineplus">+  list-style-image: url(&quot;chrome://messenger/skin/icons/newmsg.svg&quot;);</span>
<a href="#l28.31"></a><span id="l28.31" class="difflineplus">+}</span>
<a href="#l28.32"></a><span id="l28.32" class="difflineplus">+</span>
<a href="#l28.33"></a><span id="l28.33" class="difflineplus">+.notification-inline notification {</span>
<a href="#l28.34"></a><span id="l28.34" class="difflineplus">+  border-width: 1px;</span>
<a href="#l28.35"></a><span id="l28.35" class="difflineplus">+  border-radius: 2px;</span>
<a href="#l28.36"></a><span id="l28.36" class="difflineplus">+}</span>
<a href="#l28.37"></a><span id="l28.37" class="difflineplus">+</span>
<a href="#l28.38"></a><span id="l28.38" class="difflineplus">+button.button-menu-list {</span>
<a href="#l28.39"></a><span id="l28.39" class="difflineplus">+  -moz-appearance: menulist-button;</span>
<a href="#l28.40"></a><span id="l28.40" class="difflineplus">+}</span>
<a href="#l28.41"></a><span id="l28.41" class="difflineplus">+</span>
<a href="#l28.42"></a><span id="l28.42" class="difflineplus">+.messageText &gt; .text-link {</span>
<a href="#l28.43"></a><span id="l28.43" class="difflineplus">+  margin-inline-start: 6px;</span>
<a href="#l28.44"></a><span id="l28.44" class="difflineplus">+}</span>
<a href="#l28.45"></a><span id="l28.45">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/mail/base/content/specialTabs.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/mail/base/content/specialTabs.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l29.4"></a><span id="l29.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l29.5"></a><span id="l29.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l29.6"></a><span id="l29.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l29.7"></a><span id="l29.7"> </span>
<a href="#l29.8"></a><span id="l29.8" class="difflineplus">+/* global MozElements */</span>
<a href="#l29.9"></a><span id="l29.9" class="difflineplus">+</span>
<a href="#l29.10"></a><span id="l29.10"> /* import-globals-from ../../../../toolkit/components/printing/content/printUtils.js */</span>
<a href="#l29.11"></a><span id="l29.11"> /* import-globals-from mailWindow.js */</span>
<a href="#l29.12"></a><span id="l29.12"> /* import-globals-from utilityOverlay.js */</span>
<a href="#l29.13"></a><span id="l29.13"> </span>
<a href="#l29.14"></a><span id="l29.14"> var {XPCOMUtils} = ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l29.15"></a><span id="l29.15"> var {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l29.16"></a><span id="l29.16"> var {AddonManager} = ChromeUtils.import(&quot;resource://gre/modules/AddonManager.jsm&quot;);</span>
<a href="#l29.17"></a><span id="l29.17"> var {StringBundle} = ChromeUtils.import(&quot;resource:///modules/StringBundle.js&quot;);</span>
<a href="#l29.18"></a><span id="l29.18" class="difflineat">@@ -503,16 +505,28 @@ var specialTabs = {</span>
<a href="#l29.19"></a><span id="l29.19"> </span>
<a href="#l29.20"></a><span id="l29.20">   get mFaviconService() {</span>
<a href="#l29.21"></a><span id="l29.21">     delete this.mFaviconService;</span>
<a href="#l29.22"></a><span id="l29.22">     return this.mFaviconService =</span>
<a href="#l29.23"></a><span id="l29.23">       Cc[&quot;@mozilla.org/browser/favicon-service;1&quot;]</span>
<a href="#l29.24"></a><span id="l29.24">         .getService(Ci.nsIFaviconService);</span>
<a href="#l29.25"></a><span id="l29.25">   },</span>
<a href="#l29.26"></a><span id="l29.26"> </span>
<a href="#l29.27"></a><span id="l29.27" class="difflineplus">+  get msgNotificationBar() {</span>
<a href="#l29.28"></a><span id="l29.28" class="difflineplus">+    delete this.msgNotificationBar;</span>
<a href="#l29.29"></a><span id="l29.29" class="difflineplus">+</span>
<a href="#l29.30"></a><span id="l29.30" class="difflineplus">+    let newNotificationBox = new MozElements.NotificationBox(element =&gt; {</span>
<a href="#l29.31"></a><span id="l29.31" class="difflineplus">+      element.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l29.32"></a><span id="l29.32" class="difflineplus">+      element.setAttribute(&quot;notificationside&quot;, &quot;bottom&quot;);</span>
<a href="#l29.33"></a><span id="l29.33" class="difflineplus">+      document.getElementById(&quot;messenger-notification-bottom&quot;).append(element);</span>
<a href="#l29.34"></a><span id="l29.34" class="difflineplus">+    });</span>
<a href="#l29.35"></a><span id="l29.35" class="difflineplus">+</span>
<a href="#l29.36"></a><span id="l29.36" class="difflineplus">+    return this.msgNotificationBar = newNotificationBox;</span>
<a href="#l29.37"></a><span id="l29.37" class="difflineplus">+  },</span>
<a href="#l29.38"></a><span id="l29.38" class="difflineplus">+</span>
<a href="#l29.39"></a><span id="l29.39">   /**</span>
<a href="#l29.40"></a><span id="l29.40">    * We use an html image node to test the favicon, errors are well returned.</span>
<a href="#l29.41"></a><span id="l29.41">    * Returning a url for nsITreeView.getImageSrc() will not indicate any</span>
<a href="#l29.42"></a><span id="l29.42">    * error, and setAndFetchFaviconForPage() can't be used to detect</span>
<a href="#l29.43"></a><span id="l29.43">    * failed icons due to Bug 740457. This also ensures 301 Moved or</span>
<a href="#l29.44"></a><span id="l29.44">    * redirected urls will work (they won't otherwise in getImageSrc).</span>
<a href="#l29.45"></a><span id="l29.45">    *</span>
<a href="#l29.46"></a><span id="l29.46">    * @param  function successFunc - caller's success function.</span>
<a href="#l29.47"></a><span id="l29.47" class="difflineat">@@ -911,18 +925,16 @@ var specialTabs = {</span>
<a href="#l29.48"></a><span id="l29.48"> </span>
<a href="#l29.49"></a><span id="l29.49">     if (telemetryEnabled || telemetryPrompted)</span>
<a href="#l29.50"></a><span id="l29.50">       return false;</span>
<a href="#l29.51"></a><span id="l29.51"> </span>
<a href="#l29.52"></a><span id="l29.52">     return true;</span>
<a href="#l29.53"></a><span id="l29.53">   },</span>
<a href="#l29.54"></a><span id="l29.54"> </span>
<a href="#l29.55"></a><span id="l29.55">   showTelemetryNotification() {</span>
<a href="#l29.56"></a><span id="l29.56" class="difflineminus">-    var notifyBox = document.getElementById(&quot;mail-notification-box&quot;);</span>
<a href="#l29.57"></a><span id="l29.57" class="difflineminus">-</span>
<a href="#l29.58"></a><span id="l29.58">     var brandBundle =</span>
<a href="#l29.59"></a><span id="l29.59">       new StringBundle(&quot;chrome://branding/locale/brand.properties&quot;);</span>
<a href="#l29.60"></a><span id="l29.60">     var telemetryBundle =</span>
<a href="#l29.61"></a><span id="l29.61">       new StringBundle(&quot;chrome://messenger/locale/telemetry.properties&quot;);</span>
<a href="#l29.62"></a><span id="l29.62"> </span>
<a href="#l29.63"></a><span id="l29.63">     var productName = brandBundle.get(&quot;brandFullName&quot;);</span>
<a href="#l29.64"></a><span id="l29.64">     var serverOwner = Services.prefs.getCharPref(kTelemetryServerOwner);</span>
<a href="#l29.65"></a><span id="l29.65">     var telemetryText = telemetryBundle.get(&quot;telemetryText&quot;, [productName, serverOwner]);</span>
<a href="#l29.66"></a><span id="l29.66" class="difflineat">@@ -949,32 +961,33 @@ var specialTabs = {</span>
<a href="#l29.67"></a><span id="l29.67">           Services.prefs.setBoolPref(kTelemetryRejected, true);</span>
<a href="#l29.68"></a><span id="l29.68">         },</span>
<a href="#l29.69"></a><span id="l29.69">       },</span>
<a href="#l29.70"></a><span id="l29.70">     ];</span>
<a href="#l29.71"></a><span id="l29.71"> </span>
<a href="#l29.72"></a><span id="l29.72">     // Set pref to indicate we've shown the notification.</span>
<a href="#l29.73"></a><span id="l29.73">     Services.prefs.setIntPref(kTelemetryPrompted, kTelemetryPromptRev);</span>
<a href="#l29.74"></a><span id="l29.74"> </span>
<a href="#l29.75"></a><span id="l29.75" class="difflineminus">-    var notification = notifyBox.appendNotification(telemetryText, &quot;telemetry&quot;, null, notifyBox.PRIORITY_INFO_LOW, buttons);</span>
<a href="#l29.76"></a><span id="l29.76" class="difflineplus">+    let notification = this.msgNotificationBar.appendNotification(</span>
<a href="#l29.77"></a><span id="l29.77" class="difflineplus">+      telemetryText, &quot;telemetry&quot;, null, this.msgNotificationBar.PRIORITY_INFO_LOW, buttons);</span>
<a href="#l29.78"></a><span id="l29.78">     notification.persistence = 3; // arbitrary number, just so bar sticks around for a bit</span>
<a href="#l29.79"></a><span id="l29.79"> </span>
<a href="#l29.80"></a><span id="l29.80">     let link = notification.ownerDocument.createXULElement(&quot;label&quot;, {is: &quot;text-link&quot;});</span>
<a href="#l29.81"></a><span id="l29.81">     link.className = &quot;telemetry-text-link&quot;;</span>
<a href="#l29.82"></a><span id="l29.82">     link.setAttribute(&quot;value&quot;, telemetryBundle.get(&quot;telemetryLinkLabel&quot;));</span>
<a href="#l29.83"></a><span id="l29.83">     link.addEventListener(&quot;click&quot;, function() {</span>
<a href="#l29.84"></a><span id="l29.84">       openPrivacyPolicy(&quot;tab&quot;);</span>
<a href="#l29.85"></a><span id="l29.85">       // Remove the notification on which the user clicked</span>
<a href="#l29.86"></a><span id="l29.86">       notification.parentNode.removeNotification(notification, true);</span>
<a href="#l29.87"></a><span id="l29.87">       // Add a new notification to that tab, with no &quot;Learn more&quot; link</span>
<a href="#l29.88"></a><span id="l29.88" class="difflineminus">-      notifyBox.appendNotification(telemetryText, &quot;telemetry&quot;, null, notifyBox.PRIORITY_INFO_LOW, buttons);</span>
<a href="#l29.89"></a><span id="l29.89" class="difflineplus">+      this.msgNotificationBar.appendNotification(</span>
<a href="#l29.90"></a><span id="l29.90" class="difflineplus">+        telemetryText, &quot;telemetry&quot;, null, this.msgNotificationBar.PRIORITY_INFO_LOW, buttons);</span>
<a href="#l29.91"></a><span id="l29.91">     });</span>
<a href="#l29.92"></a><span id="l29.92"> </span>
<a href="#l29.93"></a><span id="l29.93" class="difflineminus">-    let description = notification.ownerDocument.getAnonymousElementByAttribute(notification, &quot;anonid&quot;, &quot;messageText&quot;);</span>
<a href="#l29.94"></a><span id="l29.94" class="difflineminus">-    description.appendChild(link);</span>
<a href="#l29.95"></a><span id="l29.95" class="difflineplus">+    notification.messageText.appendChild(link);</span>
<a href="#l29.96"></a><span id="l29.96">   },</span>
<a href="#l29.97"></a><span id="l29.97">   /**</span>
<a href="#l29.98"></a><span id="l29.98">    * Looks at the existing prefs and determines if we should show about:rights</span>
<a href="#l29.99"></a><span id="l29.99">    * or not.</span>
<a href="#l29.100"></a><span id="l29.100">    *</span>
<a href="#l29.101"></a><span id="l29.101">    * This is controlled by two prefs:</span>
<a href="#l29.102"></a><span id="l29.102">    *</span>
<a href="#l29.103"></a><span id="l29.103">    *   mail.rights.override</span>
<a href="#l29.104"></a><span id="l29.104" class="difflineat">@@ -992,18 +1005,16 @@ var specialTabs = {</span>
<a href="#l29.105"></a><span id="l29.105">     try {</span>
<a href="#l29.106"></a><span id="l29.106">       return !Services.prefs.getBoolPref(&quot;mail.rights.override&quot;);</span>
<a href="#l29.107"></a><span id="l29.107">     } catch (e) {}</span>
<a href="#l29.108"></a><span id="l29.108"> </span>
<a href="#l29.109"></a><span id="l29.109">     return Services.prefs.getIntPref(&quot;mail.rights.version&quot;) &lt; this._kAboutRightsVersion;</span>
<a href="#l29.110"></a><span id="l29.110">   },</span>
<a href="#l29.111"></a><span id="l29.111"> </span>
<a href="#l29.112"></a><span id="l29.112">   showAboutRightsNotification() {</span>
<a href="#l29.113"></a><span id="l29.113" class="difflineminus">-    var notifyBox = document.getElementById(&quot;mail-notification-box&quot;);</span>
<a href="#l29.114"></a><span id="l29.114" class="difflineminus">-</span>
<a href="#l29.115"></a><span id="l29.115">     var brandBundle =</span>
<a href="#l29.116"></a><span id="l29.116">       Services.strings.createBundle(&quot;chrome://branding/locale/brand.properties&quot;);</span>
<a href="#l29.117"></a><span id="l29.117">     var rightsBundle =</span>
<a href="#l29.118"></a><span id="l29.118">       Services.strings.createBundle(&quot;chrome://messenger/locale/aboutRights.properties&quot;);</span>
<a href="#l29.119"></a><span id="l29.119"> </span>
<a href="#l29.120"></a><span id="l29.120">     var productName = brandBundle.GetStringFromName(&quot;brandFullName&quot;);</span>
<a href="#l29.121"></a><span id="l29.121">     var notifyRightsText = rightsBundle.formatStringFromName(&quot;notifyRightsText&quot;,</span>
<a href="#l29.122"></a><span id="l29.122">                                                              [productName], 1);</span>
<a href="#l29.123"></a><span id="l29.123" class="difflineat">@@ -1017,19 +1028,19 @@ var specialTabs = {</span>
<a href="#l29.124"></a><span id="l29.124">           // Show the about:rights tab</span>
<a href="#l29.125"></a><span id="l29.125">           document.getElementById(&quot;tabmail&quot;)</span>
<a href="#l29.126"></a><span id="l29.126">                   .openTab(&quot;contentTab&quot;, { contentPage: &quot;about:rights&quot;,</span>
<a href="#l29.127"></a><span id="l29.127">                                            clickHandler: &quot;specialTabs.aboutClickHandler(event);&quot; });</span>
<a href="#l29.128"></a><span id="l29.128">         },</span>
<a href="#l29.129"></a><span id="l29.129">       },</span>
<a href="#l29.130"></a><span id="l29.130">     ];</span>
<a href="#l29.131"></a><span id="l29.131"> </span>
<a href="#l29.132"></a><span id="l29.132" class="difflineminus">-    var box = notifyBox.appendNotification(notifyRightsText, &quot;about-rights&quot;,</span>
<a href="#l29.133"></a><span id="l29.133" class="difflineminus">-                                           null, notifyBox.PRIORITY_INFO_LOW,</span>
<a href="#l29.134"></a><span id="l29.134" class="difflineminus">-                                           buttons);</span>
<a href="#l29.135"></a><span id="l29.135" class="difflineplus">+    var box = this.msgNotificationBar.appendNotification(</span>
<a href="#l29.136"></a><span id="l29.136" class="difflineplus">+      notifyRightsText, &quot;about-rights&quot;, null,</span>
<a href="#l29.137"></a><span id="l29.137" class="difflineplus">+      this.msgNotificationBar.PRIORITY_INFO_LOW, buttons);</span>
<a href="#l29.138"></a><span id="l29.138">     // arbitrary number, just so bar sticks around for a bit</span>
<a href="#l29.139"></a><span id="l29.139">     box.persistence = 3;</span>
<a href="#l29.140"></a><span id="l29.140"> </span>
<a href="#l29.141"></a><span id="l29.141">     // Set the pref to say we've displayed the notification.</span>
<a href="#l29.142"></a><span id="l29.142">     Services.prefs.setIntPref(&quot;mail.rights.version&quot;, this._kAboutRightsVersion);</span>
<a href="#l29.143"></a><span id="l29.143">   },</span>
<a href="#l29.144"></a><span id="l29.144"> </span>
<a href="#l29.145"></a><span id="l29.145">   /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/mail/base/jar.mn</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/mail/base/jar.mn</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -33,17 +33,16 @@ messenger.jar:</span>
<a href="#l30.4"></a><span id="l30.4">     content/messenger/customizeToolbar.css          (../../common/src/customizeToolbar.css)</span>
<a href="#l30.5"></a><span id="l30.5">     content/messenger/customizeToolbar.js           (../../common/src/customizeToolbar.js)</span>
<a href="#l30.6"></a><span id="l30.6"> *   content/messenger/customizeToolbar.xul          (../../common/src/customizeToolbar.xul)</span>
<a href="#l30.7"></a><span id="l30.7">     content/messenger/viewSource.js                 (../../common/src/viewSource.js)</span>
<a href="#l30.8"></a><span id="l30.8"> *   content/messenger/viewSource.xul                (../../common/src/viewSource.xul)</span>
<a href="#l30.9"></a><span id="l30.9">     content/messenger/generalBindings.xml           (../../common/bindings/generalBindings.xml)</span>
<a href="#l30.10"></a><span id="l30.10">     content/messenger/generalBindings.js            (../../common/bindings/generalBindings.js)</span>
<a href="#l30.11"></a><span id="l30.11">     content/messenger/menubutton.xml                (../../common/bindings/menubutton.xml)</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-    content/messenger/notificationbox.xml           (../../common/bindings/notificationbox.xml)</span>
<a href="#l30.13"></a><span id="l30.13">     content/messenger/richlistbox.xml               (../../common/bindings/richlistbox.xml)</span>
<a href="#l30.14"></a><span id="l30.14"> *   content/messenger/toolbar.xml                   (../../common/bindings/toolbar.xml)</span>
<a href="#l30.15"></a><span id="l30.15">     content/messenger/attachmentList.css            (content/attachmentList.css)</span>
<a href="#l30.16"></a><span id="l30.16">     content/messenger/menulist.css                  (content/menulist.css)</span>
<a href="#l30.17"></a><span id="l30.17"> *   content/messenger/bindings.css                  (content/bindings.css)</span>
<a href="#l30.18"></a><span id="l30.18">     content/messenger/nsDragAndDrop.js              (content/nsDragAndDrop.js)</span>
<a href="#l30.19"></a><span id="l30.19">     content/messenger/editContactPanel.js           (content/editContactPanel.js)</span>
<a href="#l30.20"></a><span id="l30.20">     content/messenger/msgMail3PaneWindow.js         (content/msgMail3PaneWindow.js)</span>
<a href="#l30.21"></a><span id="l30.21" class="difflineat">@@ -67,16 +66,17 @@ messenger.jar:</span>
<a href="#l30.22"></a><span id="l30.22"> *   content/messenger/systemIntegrationDialog.xul   (content/systemIntegrationDialog.xul)</span>
<a href="#l30.23"></a><span id="l30.23">     content/messenger/systemIntegrationDialog.js    (content/systemIntegrationDialog.js)</span>
<a href="#l30.24"></a><span id="l30.24">     content/messenger/folderPane.js                 (content/folderPane.js)</span>
<a href="#l30.25"></a><span id="l30.25">     content/messenger/searchBar.js                  (content/searchBar.js)</span>
<a href="#l30.26"></a><span id="l30.26">     content/messenger/phishingDetector.js           (content/phishingDetector.js)</span>
<a href="#l30.27"></a><span id="l30.27">     content/messenger/mail-offline.js               (content/mail-offline.js)</span>
<a href="#l30.28"></a><span id="l30.28">     content/messenger/aboutDialog.css               (content/aboutDialog.css)</span>
<a href="#l30.29"></a><span id="l30.29">     content/messenger/converterDialog.css           (content/converterDialog.css)</span>
<a href="#l30.30"></a><span id="l30.30" class="difflineplus">+    content/messenger/notification.css              (content/notification.css)</span>
<a href="#l30.31"></a><span id="l30.31"> *   content/messenger/messenger.css                 (content/messenger.css)</span>
<a href="#l30.32"></a><span id="l30.32">     content/messenger/search.xml                    (content/search.xml)</span>
<a href="#l30.33"></a><span id="l30.33">     content/messenger/tabmail.xml                   (content/tabmail.xml)</span>
<a href="#l30.34"></a><span id="l30.34">     content/messenger/tabmail.css                   (content/tabmail.css)</span>
<a href="#l30.35"></a><span id="l30.35">     content/messenger/statuspanel.js                (content/statuspanel.js)</span>
<a href="#l30.36"></a><span id="l30.36">     content/messenger/newTagDialog.xul              (content/newTagDialog.xul)</span>
<a href="#l30.37"></a><span id="l30.37">     content/messenger/newTagDialog.js               (content/newTagDialog.js)</span>
<a href="#l30.38"></a><span id="l30.38">     content/messenger/composerOverlay.css           (content/composerOverlay.css)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l31.4"></a><span id="l31.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l31.5"></a><span id="l31.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l31.6"></a><span id="l31.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l31.7"></a><span id="l31.7"> </span>
<a href="#l31.8"></a><span id="l31.8" class="difflineplus">+/* global MozElements */</span>
<a href="#l31.9"></a><span id="l31.9" class="difflineplus">+</span>
<a href="#l31.10"></a><span id="l31.10"> /* import-globals-from ../../../../editor/ui/composer/content/ComposerCommands.js */</span>
<a href="#l31.11"></a><span id="l31.11"> /* import-globals-from ../../../../editor/ui/composer/content/editor.js */</span>
<a href="#l31.12"></a><span id="l31.12"> /* import-globals-from ../../../../editor/ui/composer/content/editorUtilities.js */</span>
<a href="#l31.13"></a><span id="l31.13"> /* import-globals-from ../../../../mailnews/addrbook/content/abDragDrop.js */</span>
<a href="#l31.14"></a><span id="l31.14"> /* import-globals-from ../../../base/content/mailCore.js */</span>
<a href="#l31.15"></a><span id="l31.15"> /* import-globals-from ../../../base/content/utilityOverlay.js */</span>
<a href="#l31.16"></a><span id="l31.16"> /* import-globals-from addressingWidgetOverlay.js */</span>
<a href="#l31.17"></a><span id="l31.17"> </span>
<a href="#l31.18"></a><span id="l31.18" class="difflineat">@@ -148,16 +150,26 @@ function ReleaseGlobalVariables() {</span>
<a href="#l31.19"></a><span id="l31.19">   gOriginalMsgURI = null;</span>
<a href="#l31.20"></a><span id="l31.20">   gMessenger = null;</span>
<a href="#l31.21"></a><span id="l31.21">   gDisableAttachmentReminder = false;</span>
<a href="#l31.22"></a><span id="l31.22">   _gComposeBundle = null;</span>
<a href="#l31.23"></a><span id="l31.23">   MailServices.mailSession.RemoveMsgWindow(msgWindow);</span>
<a href="#l31.24"></a><span id="l31.24">   msgWindow = null;</span>
<a href="#l31.25"></a><span id="l31.25"> }</span>
<a href="#l31.26"></a><span id="l31.26"> </span>
<a href="#l31.27"></a><span id="l31.27" class="difflineplus">+// Notification box shown at the bottom of the window.</span>
<a href="#l31.28"></a><span id="l31.28" class="difflineplus">+var gNotification = {};</span>
<a href="#l31.29"></a><span id="l31.29" class="difflineplus">+XPCOMUtils.defineLazyGetter(gNotification, &quot;notificationbox&quot;, () =&gt; {</span>
<a href="#l31.30"></a><span id="l31.30" class="difflineplus">+  return new MozElements.NotificationBox(element =&gt; {</span>
<a href="#l31.31"></a><span id="l31.31" class="difflineplus">+    element.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l31.32"></a><span id="l31.32" class="difflineplus">+    element.setAttribute(&quot;notificationside&quot;, &quot;bottom&quot;);</span>
<a href="#l31.33"></a><span id="l31.33" class="difflineplus">+    document.getElementById(&quot;compose-notification-bottom&quot;).append(element);</span>
<a href="#l31.34"></a><span id="l31.34" class="difflineplus">+  });</span>
<a href="#l31.35"></a><span id="l31.35" class="difflineplus">+});</span>
<a href="#l31.36"></a><span id="l31.36" class="difflineplus">+</span>
<a href="#l31.37"></a><span id="l31.37"> /**</span>
<a href="#l31.38"></a><span id="l31.38">  * Get a pretty, human-readable shortcut key string from a given &lt;key&gt; id.</span>
<a href="#l31.39"></a><span id="l31.39">  *</span>
<a href="#l31.40"></a><span id="l31.40">  * @param aKeyId   the ID of a &lt;key&gt; element</span>
<a href="#l31.41"></a><span id="l31.41">  * @return string  pretty, human-readable shortcut key string from the &lt;key&gt;</span>
<a href="#l31.42"></a><span id="l31.42">  */</span>
<a href="#l31.43"></a><span id="l31.43"> function getPrettyKey(aKeyId) {</span>
<a href="#l31.44"></a><span id="l31.44">   return ShortcutUtils.prettifyShortcut(document.getElementById(aKeyId));</span>
<a href="#l31.45"></a><span id="l31.45" class="difflineat">@@ -2074,18 +2086,17 @@ function handleEsc() {</span>
<a href="#l31.46"></a><span id="l31.46">   if (!findbar.hidden &amp;&amp; activeElement.id == &quot;content-frame&quot;) {</span>
<a href="#l31.47"></a><span id="l31.47">     findbar.close();</span>
<a href="#l31.48"></a><span id="l31.48">     return;</span>
<a href="#l31.49"></a><span id="l31.49">   }</span>
<a href="#l31.50"></a><span id="l31.50"> </span>
<a href="#l31.51"></a><span id="l31.51">   // If there is a notification in the attachmentNotificationBox</span>
<a href="#l31.52"></a><span id="l31.52">   // AND focus is in message body, subject field or on the notification,</span>
<a href="#l31.53"></a><span id="l31.53">   // hide it.</span>
<a href="#l31.54"></a><span id="l31.54" class="difflineminus">-  let notification = document.getElementById(&quot;attachmentNotificationBox&quot;)</span>
<a href="#l31.55"></a><span id="l31.55" class="difflineminus">-                             .currentNotification;</span>
<a href="#l31.56"></a><span id="l31.56" class="difflineplus">+  let notification = gNotification.notificationbox.currentNotification;</span>
<a href="#l31.57"></a><span id="l31.57">   if (notification &amp;&amp; (activeElement.id == &quot;content-frame&quot; ||</span>
<a href="#l31.58"></a><span id="l31.58">       activeElement.parentNode.parentNode.id == &quot;msgSubject&quot; ||</span>
<a href="#l31.59"></a><span id="l31.59">       notification.contains(activeElement) ||</span>
<a href="#l31.60"></a><span id="l31.60">       activeElement.classList.contains(&quot;messageCloseButton&quot;))) {</span>
<a href="#l31.61"></a><span id="l31.61">     notification.close();</span>
<a href="#l31.62"></a><span id="l31.62">   }</span>
<a href="#l31.63"></a><span id="l31.63"> }</span>
<a href="#l31.64"></a><span id="l31.64"> </span>
<a href="#l31.65"></a><span id="l31.65" class="difflineat">@@ -2136,22 +2147,22 @@ function manageAttachmentNotification(aF</span>
<a href="#l31.66"></a><span id="l31.66">       // We don't know keywords, so get them first.</span>
<a href="#l31.67"></a><span id="l31.67">       // If aForce was true, and some keywords are found, we get to run again from</span>
<a href="#l31.68"></a><span id="l31.68">       // attachmentWorker.onmessage().</span>
<a href="#l31.69"></a><span id="l31.69">       gAttachmentNotifier.redetectKeywords(aForce);</span>
<a href="#l31.70"></a><span id="l31.70">       return;</span>
<a href="#l31.71"></a><span id="l31.71">     }</span>
<a href="#l31.72"></a><span id="l31.72">   }</span>
<a href="#l31.73"></a><span id="l31.73"> </span>
<a href="#l31.74"></a><span id="l31.74" class="difflineminus">-  let nBox = document.getElementById(&quot;attachmentNotificationBox&quot;);</span>
<a href="#l31.75"></a><span id="l31.75" class="difflineminus">-  let notification = nBox.getNotificationWithValue(&quot;attachmentReminder&quot;);</span>
<a href="#l31.76"></a><span id="l31.76" class="difflineplus">+  let notification = gNotification.notificationbox.</span>
<a href="#l31.77"></a><span id="l31.77" class="difflineplus">+    getNotificationWithValue(&quot;attachmentReminder&quot;);</span>
<a href="#l31.78"></a><span id="l31.78">   if (removeNotification) {</span>
<a href="#l31.79"></a><span id="l31.79" class="difflineminus">-    if (notification)</span>
<a href="#l31.80"></a><span id="l31.80" class="difflineminus">-      nBox.removeNotification(notification);</span>
<a href="#l31.81"></a><span id="l31.81" class="difflineminus">-</span>
<a href="#l31.82"></a><span id="l31.82" class="difflineplus">+    if (notification) {</span>
<a href="#l31.83"></a><span id="l31.83" class="difflineplus">+      gNotification.notificationbox.removeNotification(notification);</span>
<a href="#l31.84"></a><span id="l31.84" class="difflineplus">+    }</span>
<a href="#l31.85"></a><span id="l31.85">     return;</span>
<a href="#l31.86"></a><span id="l31.86">   }</span>
<a href="#l31.87"></a><span id="l31.87"> </span>
<a href="#l31.88"></a><span id="l31.88">   // We have some keywords, however only pop up the notification if requested</span>
<a href="#l31.89"></a><span id="l31.89">   // to do so.</span>
<a href="#l31.90"></a><span id="l31.90">   if (!aForce)</span>
<a href="#l31.91"></a><span id="l31.91">     return;</span>
<a href="#l31.92"></a><span id="l31.92"> </span>
<a href="#l31.93"></a><span id="l31.93" class="difflineat">@@ -2206,29 +2217,33 @@ function manageAttachmentNotification(aF</span>
<a href="#l31.94"></a><span id="l31.94">     getComposeBundle().getString(&quot;disableAttachmentReminderButton&quot;));</span>
<a href="#l31.95"></a><span id="l31.95">   disableAttachmentReminder.setAttribute(&quot;command&quot;, &quot;cmd_doNotRemindForAttachments&quot;);</span>
<a href="#l31.96"></a><span id="l31.96">   remindLaterMenuPopup.appendChild(disableAttachmentReminder);</span>
<a href="#l31.97"></a><span id="l31.97"> </span>
<a href="#l31.98"></a><span id="l31.98">   let remindButton = {</span>
<a href="#l31.99"></a><span id="l31.99">     type: &quot;menu-button&quot;,</span>
<a href="#l31.100"></a><span id="l31.100">     accessKey: getComposeBundle().getString(&quot;remindLaterButton.accesskey&quot;),</span>
<a href="#l31.101"></a><span id="l31.101">     label: getComposeBundle().getString(&quot;remindLaterButton&quot;),</span>
<a href="#l31.102"></a><span id="l31.102" class="difflineminus">-    popup: remindLaterMenuPopup,</span>
<a href="#l31.103"></a><span id="l31.103">     callback(aNotificationBar, aButton) {</span>
<a href="#l31.104"></a><span id="l31.104">       toggleAttachmentReminder(true);</span>
<a href="#l31.105"></a><span id="l31.105">     },</span>
<a href="#l31.106"></a><span id="l31.106">   };</span>
<a href="#l31.107"></a><span id="l31.107"> </span>
<a href="#l31.108"></a><span id="l31.108" class="difflineminus">-  notification = nBox.appendNotification(&quot;&quot;, &quot;attachmentReminder&quot;,</span>
<a href="#l31.109"></a><span id="l31.109" class="difflineminus">-                               /* fake out the image so we can do it in CSS */</span>
<a href="#l31.110"></a><span id="l31.110" class="difflineminus">-                               &quot;null&quot;,</span>
<a href="#l31.111"></a><span id="l31.111" class="difflineminus">-                               nBox.PRIORITY_WARNING_MEDIUM,</span>
<a href="#l31.112"></a><span id="l31.112" class="difflineminus">-                               [addButton, remindButton]);</span>
<a href="#l31.113"></a><span id="l31.113" class="difflineminus">-  let buttons = notification.childNodes[0];</span>
<a href="#l31.114"></a><span id="l31.114" class="difflineminus">-  notification.insertBefore(msg, buttons);</span>
<a href="#l31.115"></a><span id="l31.115" class="difflineplus">+  notification = gNotification.notificationbox.appendNotification(</span>
<a href="#l31.116"></a><span id="l31.116" class="difflineplus">+    &quot;&quot;, &quot;attachmentReminder&quot;, &quot;null&quot;,</span>
<a href="#l31.117"></a><span id="l31.117" class="difflineplus">+    gNotification.notificationbox.PRIORITY_WARNING_MEDIUM,</span>
<a href="#l31.118"></a><span id="l31.118" class="difflineplus">+    [addButton, remindButton]);</span>
<a href="#l31.119"></a><span id="l31.119" class="difflineplus">+  notification.setAttribute(&quot;id&quot;, &quot;attachmentNotificationBox&quot;);</span>
<a href="#l31.120"></a><span id="l31.120" class="difflineplus">+</span>
<a href="#l31.121"></a><span id="l31.121" class="difflineplus">+  let button = notification.spacer.nextSibling;</span>
<a href="#l31.122"></a><span id="l31.122" class="difflineplus">+  notification.messageDetails.insertBefore(msg, button);</span>
<a href="#l31.123"></a><span id="l31.123" class="difflineplus">+</span>
<a href="#l31.124"></a><span id="l31.124" class="difflineplus">+  let nextButton = button.nextSibling;</span>
<a href="#l31.125"></a><span id="l31.125" class="difflineplus">+  nextButton.setAttribute(&quot;type&quot;, &quot;menu-button&quot;);</span>
<a href="#l31.126"></a><span id="l31.126" class="difflineplus">+  nextButton.appendChild(remindLaterMenuPopup);</span>
<a href="#l31.127"></a><span id="l31.127"> }</span>
<a href="#l31.128"></a><span id="l31.128"> </span>
<a href="#l31.129"></a><span id="l31.129"> /**</span>
<a href="#l31.130"></a><span id="l31.130">  * Returns whether the attachment notification should be suppressed regardless of</span>
<a href="#l31.131"></a><span id="l31.131">  * the state of keywords.</span>
<a href="#l31.132"></a><span id="l31.132">  */</span>
<a href="#l31.133"></a><span id="l31.133"> function attachmentNotificationSupressed() {</span>
<a href="#l31.134"></a><span id="l31.134">   return (gDisableAttachmentReminder || gManualAttachmentReminder ||</span>
<a href="#l31.135"></a><span id="l31.135" class="difflineat">@@ -3149,18 +3164,17 @@ function GenericSendMessage(msgType) {</span>
<a href="#l31.136"></a><span id="l31.136">     //  - the user requested &quot;Remind me later&quot; from either the notification bar or the menu</span>
<a href="#l31.137"></a><span id="l31.137">     //    (alert regardless of the number of files already attached: we can't guess for how many</span>
<a href="#l31.138"></a><span id="l31.138">     //    or which files users want the reminder, and guessing wrong will annoy them a lot), OR</span>
<a href="#l31.139"></a><span id="l31.139">     //  - the aggressive pref is set and the latest notification is still showing (implying</span>
<a href="#l31.140"></a><span id="l31.140">     //    that the message has no attachment(s) yet, message still contains some attachment</span>
<a href="#l31.141"></a><span id="l31.141">     //    keywords, and notification was not dismissed).</span>
<a href="#l31.142"></a><span id="l31.142">     if (gManualAttachmentReminder ||</span>
<a href="#l31.143"></a><span id="l31.143">         (Services.prefs.getBoolPref(&quot;mail.compose.attachment_reminder_aggressive&quot;) &amp;&amp;</span>
<a href="#l31.144"></a><span id="l31.144" class="difflineminus">-         document.getElementById(&quot;attachmentNotificationBox&quot;)</span>
<a href="#l31.145"></a><span id="l31.145" class="difflineminus">-                 .getNotificationWithValue(&quot;attachmentReminder&quot;))) {</span>
<a href="#l31.146"></a><span id="l31.146" class="difflineplus">+         gNotification.notificationbox.getNotificationWithValue(&quot;attachmentReminder&quot;))) {</span>
<a href="#l31.147"></a><span id="l31.147">       let flags = Services.prompt.BUTTON_POS_0 * Services.prompt.BUTTON_TITLE_IS_STRING +</span>
<a href="#l31.148"></a><span id="l31.148">                   Services.prompt.BUTTON_POS_1 * Services.prompt.BUTTON_TITLE_IS_STRING;</span>
<a href="#l31.149"></a><span id="l31.149">       let hadForgotten = Services.prompt.confirmEx(window,</span>
<a href="#l31.150"></a><span id="l31.150">                          getComposeBundle().getString(&quot;attachmentReminderTitle&quot;),</span>
<a href="#l31.151"></a><span id="l31.151">                          getComposeBundle().getString(&quot;attachmentReminderMsg&quot;),</span>
<a href="#l31.152"></a><span id="l31.152">                          flags,</span>
<a href="#l31.153"></a><span id="l31.153">                          getComposeBundle().getString(&quot;attachmentReminderFalseAlarm&quot;),</span>
<a href="#l31.154"></a><span id="l31.154">                          getComposeBundle().getString(&quot;attachmentReminderYesIForgot&quot;),</span>
<a href="#l31.155"></a><span id="l31.155" class="difflineat">@@ -6701,17 +6715,18 @@ function updateDocumentLanguage(e) {</span>
<a href="#l31.156"></a><span id="l31.156"> // one of the two menu items that allow them to toggle the spellcheck feature</span>
<a href="#l31.157"></a><span id="l31.157"> // (either context menu or Options menu).</span>
<a href="#l31.158"></a><span id="l31.158"> function enableInlineSpellCheck(aEnableInlineSpellCheck) {</span>
<a href="#l31.159"></a><span id="l31.159">   if (gSpellChecker.enabled != aEnableInlineSpellCheck) {</span>
<a href="#l31.160"></a><span id="l31.160">     // If state of spellchecker is about to change, clear any pending observer.</span>
<a href="#l31.161"></a><span id="l31.161">     spellCheckReadyObserver.removeObserver();</span>
<a href="#l31.162"></a><span id="l31.162">   }</span>
<a href="#l31.163"></a><span id="l31.163">   gSpellChecker.enabled = aEnableInlineSpellCheck;</span>
<a href="#l31.164"></a><span id="l31.164" class="difflineminus">-  document.getElementById(&quot;msgSubject&quot;).setAttribute(&quot;spellcheck&quot;, aEnableInlineSpellCheck);</span>
<a href="#l31.165"></a><span id="l31.165" class="difflineplus">+  document.getElementById(&quot;msgSubject&quot;).setAttribute(&quot;spellcheck&quot;,</span>
<a href="#l31.166"></a><span id="l31.166" class="difflineplus">+                                                     aEnableInlineSpellCheck);</span>
<a href="#l31.167"></a><span id="l31.167">   document.getElementById(&quot;menu_inlineSpellCheck&quot;)</span>
<a href="#l31.168"></a><span id="l31.168">           .setAttribute(&quot;checked&quot;, aEnableInlineSpellCheck);</span>
<a href="#l31.169"></a><span id="l31.169">   document.getElementById(&quot;spellCheckEnable&quot;)</span>
<a href="#l31.170"></a><span id="l31.170">           .setAttribute(&quot;checked&quot;, aEnableInlineSpellCheck);</span>
<a href="#l31.171"></a><span id="l31.171">   document.getElementById(&quot;spellCheckDictionaries&quot;)</span>
<a href="#l31.172"></a><span id="l31.172">           .setAttribute(&quot;hidden&quot;, !aEnableInlineSpellCheck);</span>
<a href="#l31.173"></a><span id="l31.173"> }</span>
<a href="#l31.174"></a><span id="l31.174"> </span>
<a href="#l31.175"></a><span id="l31.175" class="difflineat">@@ -6760,21 +6775,16 @@ function goUpdateMailMenuItems(commandse</span>
<a href="#l31.176"></a><span id="l31.176">  * notificationbox below the composed message content.</span>
<a href="#l31.177"></a><span id="l31.177">  */</span>
<a href="#l31.178"></a><span id="l31.178"> var gComposeNotificationBar = {</span>
<a href="#l31.179"></a><span id="l31.179">   get brandBundle() {</span>
<a href="#l31.180"></a><span id="l31.180">     delete this.brandBundle;</span>
<a href="#l31.181"></a><span id="l31.181">     return this.brandBundle = document.getElementById(&quot;brandBundle&quot;);</span>
<a href="#l31.182"></a><span id="l31.182">   },</span>
<a href="#l31.183"></a><span id="l31.183"> </span>
<a href="#l31.184"></a><span id="l31.184" class="difflineminus">-  get notificationBar() {</span>
<a href="#l31.185"></a><span id="l31.185" class="difflineminus">-    delete this.notificationBar;</span>
<a href="#l31.186"></a><span id="l31.186" class="difflineminus">-    return this.notificationBar = document.getElementById(&quot;attachmentNotificationBox&quot;);</span>
<a href="#l31.187"></a><span id="l31.187" class="difflineminus">-  },</span>
<a href="#l31.188"></a><span id="l31.188" class="difflineminus">-</span>
<a href="#l31.189"></a><span id="l31.189">   setBlockedContent(aBlockedURI) {</span>
<a href="#l31.190"></a><span id="l31.190">     let brandName = this.brandBundle.getString(&quot;brandShortName&quot;);</span>
<a href="#l31.191"></a><span id="l31.191">     let buttonLabel = getComposeBundle().getString((AppConstants.platform == &quot;win&quot;) ?</span>
<a href="#l31.192"></a><span id="l31.192">       &quot;blockedContentPrefLabel&quot; : &quot;blockedContentPrefLabelUnix&quot;);</span>
<a href="#l31.193"></a><span id="l31.193">     let buttonAccesskey = getComposeBundle().getString((AppConstants.platform == &quot;win&quot;) ?</span>
<a href="#l31.194"></a><span id="l31.194">       &quot;blockedContentPrefAccesskey&quot; : &quot;blockedContentPrefAccesskeyUnix&quot;);</span>
<a href="#l31.195"></a><span id="l31.195"> </span>
<a href="#l31.196"></a><span id="l31.196">     let buttons = [{</span>
<a href="#l31.197"></a><span id="l31.197" class="difflineat">@@ -6793,55 +6803,56 @@ var gComposeNotificationBar = {</span>
<a href="#l31.198"></a><span id="l31.198">       urls.push(aBlockedURI);</span>
<a href="#l31.199"></a><span id="l31.199">     popup.value = urls.join(&quot; &quot;);</span>
<a href="#l31.200"></a><span id="l31.200"> </span>
<a href="#l31.201"></a><span id="l31.201">     let msg = getComposeBundle().getFormattedString(</span>
<a href="#l31.202"></a><span id="l31.202">       &quot;blockedContentMessage&quot;, [brandName, brandName]);</span>
<a href="#l31.203"></a><span id="l31.203">     msg = PluralForm.get(urls.length, msg);</span>
<a href="#l31.204"></a><span id="l31.204"> </span>
<a href="#l31.205"></a><span id="l31.205">     if (!this.isShowingBlockedContentNotification()) {</span>
<a href="#l31.206"></a><span id="l31.206" class="difflineminus">-      this.notificationBar.appendNotification(msg, &quot;blockedContent&quot;,</span>
<a href="#l31.207"></a><span id="l31.207" class="difflineminus">-        null, this.notificationBar.PRIORITY_WARNING_MEDIUM, buttons);</span>
<a href="#l31.208"></a><span id="l31.208" class="difflineplus">+      gNotification.notificationbox.appendNotification(msg, &quot;blockedContent&quot;,</span>
<a href="#l31.209"></a><span id="l31.209" class="difflineplus">+        null, gNotification.notificationbox.PRIORITY_WARNING_MEDIUM, buttons);</span>
<a href="#l31.210"></a><span id="l31.210">     } else {</span>
<a href="#l31.211"></a><span id="l31.211" class="difflineminus">-      this.notificationBar.getNotificationWithValue(&quot;blockedContent&quot;)</span>
<a href="#l31.212"></a><span id="l31.212" class="difflineplus">+      gNotification.notificationbox.getNotificationWithValue(&quot;blockedContent&quot;)</span>
<a href="#l31.213"></a><span id="l31.213">         .setAttribute(&quot;label&quot;, msg);</span>
<a href="#l31.214"></a><span id="l31.214">     }</span>
<a href="#l31.215"></a><span id="l31.215">   },</span>
<a href="#l31.216"></a><span id="l31.216"> </span>
<a href="#l31.217"></a><span id="l31.217">   isShowingBlockedContentNotification() {</span>
<a href="#l31.218"></a><span id="l31.218" class="difflineminus">-    return !!this.notificationBar.getNotificationWithValue(&quot;blockedContent&quot;);</span>
<a href="#l31.219"></a><span id="l31.219" class="difflineplus">+    return !!gNotification.notificationbox.getNotificationWithValue(&quot;blockedContent&quot;);</span>
<a href="#l31.220"></a><span id="l31.220">   },</span>
<a href="#l31.221"></a><span id="l31.221"> </span>
<a href="#l31.222"></a><span id="l31.222">   clearBlockedContentNotification() {</span>
<a href="#l31.223"></a><span id="l31.223" class="difflineminus">-    this.notificationBar.removeNotification(</span>
<a href="#l31.224"></a><span id="l31.224" class="difflineminus">-      this.notificationBar.getNotificationWithValue(&quot;blockedContent&quot;));</span>
<a href="#l31.225"></a><span id="l31.225" class="difflineplus">+    gNotification.notificationbox.removeNotification(</span>
<a href="#l31.226"></a><span id="l31.226" class="difflineplus">+      gNotification.notificationbox.getNotificationWithValue(&quot;blockedContent&quot;));</span>
<a href="#l31.227"></a><span id="l31.227">   },</span>
<a href="#l31.228"></a><span id="l31.228"> </span>
<a href="#l31.229"></a><span id="l31.229">   clearNotifications(aValue) {</span>
<a href="#l31.230"></a><span id="l31.230" class="difflineminus">-    this.notificationBar.removeAllNotifications(true);</span>
<a href="#l31.231"></a><span id="l31.231" class="difflineplus">+    gNotification.notificationbox.removeAllNotifications(true);</span>
<a href="#l31.232"></a><span id="l31.232">   },</span>
<a href="#l31.233"></a><span id="l31.233"> </span>
<a href="#l31.234"></a><span id="l31.234">   setIdentityWarning(aIdentityName) {</span>
<a href="#l31.235"></a><span id="l31.235" class="difflineminus">-    if (!this.notificationBar.getNotificationWithValue(&quot;identityWarning&quot;)) {</span>
<a href="#l31.236"></a><span id="l31.236" class="difflineminus">-      let text = getComposeBundle().getString(&quot;identityWarning&quot;)</span>
<a href="#l31.237"></a><span id="l31.237" class="difflineminus">-                                   .split(&quot;%S&quot;);</span>
<a href="#l31.238"></a><span id="l31.238" class="difflineplus">+    if (!gNotification.notificationbox.getNotificationWithValue(&quot;identityWarning&quot;)) {</span>
<a href="#l31.239"></a><span id="l31.239" class="difflineplus">+      let text = getComposeBundle().getString(&quot;identityWarning&quot;).split(&quot;%S&quot;);</span>
<a href="#l31.240"></a><span id="l31.240">       let label = new DocumentFragment();</span>
<a href="#l31.241"></a><span id="l31.241">       label.appendChild(document.createTextNode(text[0]));</span>
<a href="#l31.242"></a><span id="l31.242">       label.appendChild(document.createElement(&quot;b&quot;));</span>
<a href="#l31.243"></a><span id="l31.243">       label.lastChild.appendChild(document.createTextNode(aIdentityName));</span>
<a href="#l31.244"></a><span id="l31.244">       label.appendChild(document.createTextNode(text[1]));</span>
<a href="#l31.245"></a><span id="l31.245" class="difflineminus">-      this.notificationBar.appendNotification(label, &quot;identityWarning&quot;, null,</span>
<a href="#l31.246"></a><span id="l31.246" class="difflineminus">-        this.notificationBar.PRIORITY_WARNING_HIGH, null);</span>
<a href="#l31.247"></a><span id="l31.247" class="difflineplus">+      gNotification.notificationbox.appendNotification(label, &quot;identityWarning&quot;, null,</span>
<a href="#l31.248"></a><span id="l31.248" class="difflineplus">+        gNotification.notificationbox.PRIORITY_WARNING_HIGH, null);</span>
<a href="#l31.249"></a><span id="l31.249">     }</span>
<a href="#l31.250"></a><span id="l31.250">   },</span>
<a href="#l31.251"></a><span id="l31.251"> </span>
<a href="#l31.252"></a><span id="l31.252">   clearIdentityWarning() {</span>
<a href="#l31.253"></a><span id="l31.253" class="difflineminus">-    let idWarning = this.notificationBar.getNotificationWithValue(&quot;identityWarning&quot;);</span>
<a href="#l31.254"></a><span id="l31.254" class="difflineminus">-    if (idWarning)</span>
<a href="#l31.255"></a><span id="l31.255" class="difflineminus">-      this.notificationBar.removeNotification(idWarning);</span>
<a href="#l31.256"></a><span id="l31.256" class="difflineplus">+    let idWarning = gNotification.notificationbox</span>
<a href="#l31.257"></a><span id="l31.257" class="difflineplus">+      .getNotificationWithValue(&quot;identityWarning&quot;);</span>
<a href="#l31.258"></a><span id="l31.258" class="difflineplus">+    if (idWarning) {</span>
<a href="#l31.259"></a><span id="l31.259" class="difflineplus">+      gNotification.notificationbox.removeNotification(idWarning);</span>
<a href="#l31.260"></a><span id="l31.260" class="difflineplus">+    }</span>
<a href="#l31.261"></a><span id="l31.261">   },</span>
<a href="#l31.262"></a><span id="l31.262"> };</span>
<a href="#l31.263"></a><span id="l31.263"> </span>
<a href="#l31.264"></a><span id="l31.264"> /**</span>
<a href="#l31.265"></a><span id="l31.265">  * Populate the menuitems of what blocked content to unblock.</span>
<a href="#l31.266"></a><span id="l31.266">  */</span>
<a href="#l31.267"></a><span id="l31.267"> function onBlockedContentOptionsShowing(aEvent) {</span>
<a href="#l31.268"></a><span id="l31.268">   let urls = aEvent.target.value ? aEvent.target.value.split(&quot; &quot;) : [];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/mail/components/compose/content/bigFileObserver.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/mail/components/compose/content/bigFileObserver.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l32.4"></a><span id="l32.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l32.5"></a><span id="l32.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l32.6"></a><span id="l32.6">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l32.7"></a><span id="l32.7"> </span>
<a href="#l32.8"></a><span id="l32.8" class="difflineplus">+/* global MozElements */</span>
<a href="#l32.9"></a><span id="l32.9" class="difflineplus">+</span>
<a href="#l32.10"></a><span id="l32.10"> /* import-globals-from MsgComposeCommands.js */</span>
<a href="#l32.11"></a><span id="l32.11"> </span>
<a href="#l32.12"></a><span id="l32.12"> var {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l32.13"></a><span id="l32.13"> var {cloudFileAccounts} = ChromeUtils.import(&quot;resource:///modules/cloudFileAccounts.js&quot;);</span>
<a href="#l32.14"></a><span id="l32.14"> </span>
<a href="#l32.15"></a><span id="l32.15"> var kUploadNotificationValue = &quot;bigAttachmentUploading&quot;;</span>
<a href="#l32.16"></a><span id="l32.16"> var kPrivacyWarningNotificationValue = &quot;bigAttachmentPrivacyWarning&quot;;</span>
<a href="#l32.17"></a><span id="l32.17"> </span>
<a href="#l32.18"></a><span id="l32.18" class="difflineat">@@ -131,17 +133,17 @@ var gBigFileObserver = {</span>
<a href="#l32.19"></a><span id="l32.19">   },</span>
<a href="#l32.20"></a><span id="l32.20"> </span>
<a href="#l32.21"></a><span id="l32.21">   attachmentUploadFailed(aAttachment, aStatusCode) {</span>
<a href="#l32.22"></a><span id="l32.22">     if (!this._anyUploadsInProgress())</span>
<a href="#l32.23"></a><span id="l32.23">       this.hideUploadingNotification();</span>
<a href="#l32.24"></a><span id="l32.24">   },</span>
<a href="#l32.25"></a><span id="l32.25"> </span>
<a href="#l32.26"></a><span id="l32.26">   updateNotification() {</span>
<a href="#l32.27"></a><span id="l32.27" class="difflineminus">-    let nb = document.getElementById(&quot;attachmentNotificationBox&quot;);</span>
<a href="#l32.28"></a><span id="l32.28" class="difflineplus">+    let nb = gNotification.notificationbox;</span>
<a href="#l32.29"></a><span id="l32.29">     let notification = nb.getNotificationWithValue(&quot;bigAttachment&quot;);</span>
<a href="#l32.30"></a><span id="l32.30"> </span>
<a href="#l32.31"></a><span id="l32.31">     if (this.bigFiles.length) {</span>
<a href="#l32.32"></a><span id="l32.32">       if (notification) {</span>
<a href="#l32.33"></a><span id="l32.33">         notification.label = this.formatString(&quot;bigFileDescription&quot;,</span>
<a href="#l32.34"></a><span id="l32.34">                                                [this.bigFiles.length],</span>
<a href="#l32.35"></a><span id="l32.35">                                                this.bigFiles.length);</span>
<a href="#l32.36"></a><span id="l32.36">         return;</span>
<a href="#l32.37"></a><span id="l32.37" class="difflineat">@@ -223,17 +225,17 @@ var gBigFileObserver = {</span>
<a href="#l32.38"></a><span id="l32.38">     // seconds.</span>
<a href="#l32.39"></a><span id="l32.39">     const kThreshold = 2500; // milliseconds</span>
<a href="#l32.40"></a><span id="l32.40"> </span>
<a href="#l32.41"></a><span id="l32.41">     if (!aAttachments.length ||</span>
<a href="#l32.42"></a><span id="l32.42">         !Services.prefs</span>
<a href="#l32.43"></a><span id="l32.43">                  .getBoolPref(&quot;mail.compose.big_attachments.insert_notification&quot;))</span>
<a href="#l32.44"></a><span id="l32.44">       return;</span>
<a href="#l32.45"></a><span id="l32.45"> </span>
<a href="#l32.46"></a><span id="l32.46" class="difflineminus">-    let nb = document.getElementById(&quot;attachmentNotificationBox&quot;);</span>
<a href="#l32.47"></a><span id="l32.47" class="difflineplus">+    let nb = gNotification.notificationbox;</span>
<a href="#l32.48"></a><span id="l32.48">     let notification = nb.getNotificationWithValue(kUploadNotificationValue);</span>
<a href="#l32.49"></a><span id="l32.49"> </span>
<a href="#l32.50"></a><span id="l32.50">     if (notification)</span>
<a href="#l32.51"></a><span id="l32.51">       return;</span>
<a href="#l32.52"></a><span id="l32.52"> </span>
<a href="#l32.53"></a><span id="l32.53">     let message = this.formatString(&quot;cloudFileUploadingNotification&quot;);</span>
<a href="#l32.54"></a><span id="l32.54">     message = PluralForm.get(aAttachments.length, message);</span>
<a href="#l32.55"></a><span id="l32.55">     let showUploadButton = {</span>
<a href="#l32.56"></a><span id="l32.56" class="difflineat">@@ -245,17 +247,17 @@ var gBigFileObserver = {</span>
<a href="#l32.57"></a><span id="l32.57">     };</span>
<a href="#l32.58"></a><span id="l32.58">     notification = nb.appendNotification(message, kUploadNotificationValue,</span>
<a href="#l32.59"></a><span id="l32.59">                                          &quot;null&quot;, nb.PRIORITY_WARNING_MEDIUM,</span>
<a href="#l32.60"></a><span id="l32.60">                                          [showUploadButton]);</span>
<a href="#l32.61"></a><span id="l32.61">     notification.timeout = Date.now() + kThreshold;</span>
<a href="#l32.62"></a><span id="l32.62">   },</span>
<a href="#l32.63"></a><span id="l32.63"> </span>
<a href="#l32.64"></a><span id="l32.64">   hideUploadingNotification() {</span>
<a href="#l32.65"></a><span id="l32.65" class="difflineminus">-    let nb = document.getElementById(&quot;attachmentNotificationBox&quot;);</span>
<a href="#l32.66"></a><span id="l32.66" class="difflineplus">+    let nb = gNotification.notificationbox;</span>
<a href="#l32.67"></a><span id="l32.67">     let notification = nb.getNotificationWithValue(kUploadNotificationValue);</span>
<a href="#l32.68"></a><span id="l32.68"> </span>
<a href="#l32.69"></a><span id="l32.69">     if (notification) {</span>
<a href="#l32.70"></a><span id="l32.70">       // Check the timestamp that we stashed in the timeout field of the</span>
<a href="#l32.71"></a><span id="l32.71">       // notification...</span>
<a href="#l32.72"></a><span id="l32.72">       let now = Date.now();</span>
<a href="#l32.73"></a><span id="l32.73">       if (now &gt;= notification.timeout) {</span>
<a href="#l32.74"></a><span id="l32.74">         nb.removeNotification(notification);</span>
<a href="#l32.75"></a><span id="l32.75" class="difflineat">@@ -264,18 +266,17 @@ var gBigFileObserver = {</span>
<a href="#l32.76"></a><span id="l32.76">           nb.removeNotification(notification);</span>
<a href="#l32.77"></a><span id="l32.77">         }, notification.timeout - now);</span>
<a href="#l32.78"></a><span id="l32.78">       }</span>
<a href="#l32.79"></a><span id="l32.79">     }</span>
<a href="#l32.80"></a><span id="l32.80">   },</span>
<a href="#l32.81"></a><span id="l32.81"> </span>
<a href="#l32.82"></a><span id="l32.82">   showPrivacyNotification() {</span>
<a href="#l32.83"></a><span id="l32.83">     const kPrivacyNotificationValue = &quot;bigAttachmentPrivacyWarning&quot;;</span>
<a href="#l32.84"></a><span id="l32.84" class="difflineminus">-</span>
<a href="#l32.85"></a><span id="l32.85" class="difflineminus">-    let nb = document.getElementById(&quot;attachmentNotificationBox&quot;);</span>
<a href="#l32.86"></a><span id="l32.86" class="difflineplus">+    let nb = gNotification.notificationbox;</span>
<a href="#l32.87"></a><span id="l32.87">     let notification = nb.getNotificationWithValue(kPrivacyNotificationValue);</span>
<a href="#l32.88"></a><span id="l32.88"> </span>
<a href="#l32.89"></a><span id="l32.89">     if (notification)</span>
<a href="#l32.90"></a><span id="l32.90">       return;</span>
<a href="#l32.91"></a><span id="l32.91"> </span>
<a href="#l32.92"></a><span id="l32.92">     let message = this.formatString(&quot;cloudFilePrivacyNotification&quot;);</span>
<a href="#l32.93"></a><span id="l32.93">     nb.appendNotification(message, kPrivacyNotificationValue, &quot;null&quot;,</span>
<a href="#l32.94"></a><span id="l32.94">                           nb.PRIORITY_WARNING_MEDIUM, null);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/mail/components/compose/content/messengercompose.xul</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/mail/components/compose/content/messengercompose.xul</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -2076,20 +2076,18 @@</span>
<a href="#l33.4"></a><span id="l33.4">   &lt;/vbox&gt;</span>
<a href="#l33.5"></a><span id="l33.5">   &lt;/hbox&gt;</span>
<a href="#l33.6"></a><span id="l33.6">   &lt;panel id=&quot;customizeToolbarSheetPopup&quot; noautohide=&quot;true&quot;&gt;</span>
<a href="#l33.7"></a><span id="l33.7">     &lt;iframe id=&quot;customizeToolbarSheetIFrame&quot;</span>
<a href="#l33.8"></a><span id="l33.8">             style=&quot;&amp;dialog.dimensions;&quot;</span>
<a href="#l33.9"></a><span id="l33.9">             hidden=&quot;true&quot;/&gt;</span>
<a href="#l33.10"></a><span id="l33.10">   &lt;/panel&gt;</span>
<a href="#l33.11"></a><span id="l33.11"> </span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-  &lt;hbox&gt;</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineminus">-    &lt;notificationbox id=&quot;attachmentNotificationBox&quot;</span>
<a href="#l33.14"></a><span id="l33.14" class="difflineminus">-                     flex=&quot;1&quot;</span>
<a href="#l33.15"></a><span id="l33.15" class="difflineminus">-                     notificationside=&quot;bottom&quot;/&gt;</span>
<a href="#l33.16"></a><span id="l33.16" class="difflineplus">+  &lt;hbox id=&quot;compose-notification-bottom&quot;&gt;</span>
<a href="#l33.17"></a><span id="l33.17" class="difflineplus">+    &lt;!-- notificationbox will be added here lazily. --&gt;</span>
<a href="#l33.18"></a><span id="l33.18">   &lt;/hbox&gt;</span>
<a href="#l33.19"></a><span id="l33.19"> </span>
<a href="#l33.20"></a><span id="l33.20">   &lt;hbox id=&quot;status-bar&quot; class=&quot;statusbar chromeclass-status&quot;&gt;</span>
<a href="#l33.21"></a><span id="l33.21">     &lt;statusbarpanel id=&quot;statusText&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l33.22"></a><span id="l33.22">     &lt;hbox id=&quot;statusbar-progresspanel&quot;</span>
<a href="#l33.23"></a><span id="l33.23">           class=&quot;statusbarpanel statusbarpanel-progress&quot;</span>
<a href="#l33.24"></a><span id="l33.24">           collapsed=&quot;true&quot;&gt;</span>
<a href="#l33.25"></a><span id="l33.25">       &lt;html:progress id=&quot;compose-progressmeter&quot; class=&quot;progressmeter-statusbar&quot; value=&quot;0&quot; max=&quot;100&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/mail/components/im/content/chat-messenger.inc.xul</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/mail/components/im/content/chat-messenger.inc.xul</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -88,17 +88,18 @@</span>
<a href="#l34.4"></a><span id="l34.4">                              type=&quot;menu&quot;</span>
<a href="#l34.5"></a><span id="l34.5">                              class=&quot;toolbarbutton-1 button-appmenu&quot;</span>
<a href="#l34.6"></a><span id="l34.6">                              label=&quot;&amp;appmenuButton.label;&quot;</span>
<a href="#l34.7"></a><span id="l34.7">                              tooltiptext=&quot;&amp;appmenuButton1.tooltip;&quot;/&gt;</span>
<a href="#l34.8"></a><span id="l34.8">             &lt;/toolbarpalette&gt;</span>
<a href="#l34.9"></a><span id="l34.9">             &lt;toolbarset id=&quot;customChatToolbars&quot; context=&quot;chat-toolbar-context-menu&quot;/&gt;</span>
<a href="#l34.10"></a><span id="l34.10">           &lt;/toolbox&gt;</span>
<a href="#l34.11"></a><span id="l34.11"> </span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-          &lt;notificationbox id=&quot;chatNotificationBox&quot; flex=&quot;1&quot; notificationside=&quot;top&quot;&gt;</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+          &lt;vbox id=&quot;chat-notification-top&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l34.14"></a><span id="l34.14" class="difflineplus">+            &lt;!-- notificationbox will be added here lazily. --&gt;</span>
<a href="#l34.15"></a><span id="l34.15">             &lt;hbox id=&quot;chatPanel&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l34.16"></a><span id="l34.16">               &lt;vbox id=&quot;listPaneBox&quot; minwidth=&quot;125&quot; width=&quot;200&quot; persist=&quot;width&quot;&gt;</span>
<a href="#l34.17"></a><span id="l34.17">                 &lt;richlistbox id=&quot;contactlistbox&quot;</span>
<a href="#l34.18"></a><span id="l34.18">                              context=&quot;buddyListContextMenu&quot;</span>
<a href="#l34.19"></a><span id="l34.19">                              tooltip=&quot;imTooltip&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l34.20"></a><span id="l34.20">                   &lt;richlistitem is=&quot;chat-group&quot; id=&quot;conversationsGroup&quot;</span>
<a href="#l34.21"></a><span id="l34.21">                                 name=&quot;&amp;conversationsHeader.label;&quot;/&gt;</span>
<a href="#l34.22"></a><span id="l34.22">                   &lt;imconv id=&quot;searchResultConv&quot; displayname=&quot;&amp;searchResultConversation.label;&quot; hidden=&quot;true&quot;/&gt;</span>
<a href="#l34.23"></a><span id="l34.23" class="difflineat">@@ -192,10 +193,10 @@</span>
<a href="#l34.24"></a><span id="l34.24">                                  crop=&quot;center&quot; ignoreincolumnpicker=&quot;true&quot;/&gt;</span>
<a href="#l34.25"></a><span id="l34.25">                       &lt;/treecols&gt;</span>
<a href="#l34.26"></a><span id="l34.26">                       &lt;treechildren/&gt;</span>
<a href="#l34.27"></a><span id="l34.27">                     &lt;/tree&gt;</span>
<a href="#l34.28"></a><span id="l34.28">                   &lt;/vbox&gt;</span>
<a href="#l34.29"></a><span id="l34.29">                 &lt;/vbox&gt;</span>
<a href="#l34.30"></a><span id="l34.30">               &lt;/vbox&gt;</span>
<a href="#l34.31"></a><span id="l34.31">             &lt;/hbox&gt;</span>
<a href="#l34.32"></a><span id="l34.32" class="difflineminus">-          &lt;/notificationbox&gt;</span>
<a href="#l34.33"></a><span id="l34.33" class="difflineplus">+          &lt;/vbox&gt;</span>
<a href="#l34.34"></a><span id="l34.34">         &lt;/vbox&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/mail/components/im/content/chat-messenger.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/mail/components/im/content/chat-messenger.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l35.4"></a><span id="l35.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l35.5"></a><span id="l35.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l35.6"></a><span id="l35.6">  * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l35.7"></a><span id="l35.7"> </span>
<a href="#l35.8"></a><span id="l35.8" class="difflineplus">+/* global MozElements */</span>
<a href="#l35.9"></a><span id="l35.9" class="difflineplus">+</span>
<a href="#l35.10"></a><span id="l35.10"> // This file is loaded in messenger.xul.</span>
<a href="#l35.11"></a><span id="l35.11"> /* globals fixIterator, MailToolboxCustomizeDone, Notifications, openIMAccountMgr,</span>
<a href="#l35.12"></a><span id="l35.12">    PROTO_TREE_VIEW, Services, Status, statusSelector, ZoomManager */</span>
<a href="#l35.13"></a><span id="l35.13"> </span>
<a href="#l35.14"></a><span id="l35.14"> var {Notifications} = ChromeUtils.import(&quot;resource:///modules/chatNotifications.jsm&quot;);</span>
<a href="#l35.15"></a><span id="l35.15"> var { Services: imServices } = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l35.16"></a><span id="l35.16"> var {AppConstants} = ChromeUtils.import(&quot;resource://gre/modules/AppConstants.jsm&quot;);</span>
<a href="#l35.17"></a><span id="l35.17"> </span>
<a href="#l35.18"></a><span id="l35.18" class="difflineat">@@ -271,16 +273,27 @@ var chatTabType = {</span>
<a href="#l35.19"></a><span id="l35.19">     }</span>
<a href="#l35.20"></a><span id="l35.20">     return null;</span>
<a href="#l35.21"></a><span id="l35.21">   },</span>
<a href="#l35.22"></a><span id="l35.22"> </span>
<a href="#l35.23"></a><span id="l35.23">   saveTabState(aTab) {},</span>
<a href="#l35.24"></a><span id="l35.24"> };</span>
<a href="#l35.25"></a><span id="l35.25"> </span>
<a href="#l35.26"></a><span id="l35.26"> var chatHandler = {</span>
<a href="#l35.27"></a><span id="l35.27" class="difflineplus">+  get msgNotificationBar() {</span>
<a href="#l35.28"></a><span id="l35.28" class="difflineplus">+    delete this.msgNotificationBar;</span>
<a href="#l35.29"></a><span id="l35.29" class="difflineplus">+</span>
<a href="#l35.30"></a><span id="l35.30" class="difflineplus">+    let newNotificationBox = new MozElements.NotificationBox(element =&gt; {</span>
<a href="#l35.31"></a><span id="l35.31" class="difflineplus">+      element.setAttribute(&quot;notificationside&quot;, &quot;top&quot;);</span>
<a href="#l35.32"></a><span id="l35.32" class="difflineplus">+      document.getElementById(&quot;chat-notification-top&quot;).prepend(element);</span>
<a href="#l35.33"></a><span id="l35.33" class="difflineplus">+    });</span>
<a href="#l35.34"></a><span id="l35.34" class="difflineplus">+</span>
<a href="#l35.35"></a><span id="l35.35" class="difflineplus">+    return this.msgNotificationBar = newNotificationBox;</span>
<a href="#l35.36"></a><span id="l35.36" class="difflineplus">+  },</span>
<a href="#l35.37"></a><span id="l35.37" class="difflineplus">+</span>
<a href="#l35.38"></a><span id="l35.38">   _addConversation(aConv) {</span>
<a href="#l35.39"></a><span id="l35.39">     let list = document.getElementById(&quot;contactlistbox&quot;);</span>
<a href="#l35.40"></a><span id="l35.40">     let convs = document.getElementById(&quot;conversationsGroup&quot;);</span>
<a href="#l35.41"></a><span id="l35.41">     let selectedItem = list.selectedItem;</span>
<a href="#l35.42"></a><span id="l35.42">     let shouldSelect =</span>
<a href="#l35.43"></a><span id="l35.43">       gChatTab &amp;&amp; gChatTab.tabNode.selected &amp;&amp;</span>
<a href="#l35.44"></a><span id="l35.44">       (!selectedItem || (selectedItem == convs &amp;&amp;</span>
<a href="#l35.45"></a><span id="l35.45">                         convs.nextSibling.localName != &quot;imconv&quot;));</span>
<a href="#l35.46"></a><span id="l35.46" class="difflineat">@@ -1030,33 +1043,34 @@ var chatHandler = {</span>
<a href="#l35.47"></a><span id="l35.47">         label: bundle.getString(&quot;buddy.authRequest.allow.label&quot;),</span>
<a href="#l35.48"></a><span id="l35.48">         callback() { aSubject.grant(); },</span>
<a href="#l35.49"></a><span id="l35.49">       };</span>
<a href="#l35.50"></a><span id="l35.50">       let denyButton = {</span>
<a href="#l35.51"></a><span id="l35.51">         accessKey: bundle.getString(&quot;buddy.authRequest.deny.accesskey&quot;),</span>
<a href="#l35.52"></a><span id="l35.52">         label: bundle.getString(&quot;buddy.authRequest.deny.label&quot;),</span>
<a href="#l35.53"></a><span id="l35.53">         callback() { aSubject.deny(); },</span>
<a href="#l35.54"></a><span id="l35.54">       };</span>
<a href="#l35.55"></a><span id="l35.55" class="difflineminus">-      let box = document.getElementById(&quot;chatNotificationBox&quot;);</span>
<a href="#l35.56"></a><span id="l35.56" class="difflineplus">+      let box = this.msgNotificationBar;</span>
<a href="#l35.57"></a><span id="l35.57">       box.appendNotification(label, value, null, box.PRIORITY_INFO_HIGH,</span>
<a href="#l35.58"></a><span id="l35.58">                             [acceptButton, denyButton]);</span>
<a href="#l35.59"></a><span id="l35.59">       if (!gChatTab) {</span>
<a href="#l35.60"></a><span id="l35.60">         let tabmail = document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l35.61"></a><span id="l35.61">         tabmail.openTab(&quot;chat&quot;, {background: true});</span>
<a href="#l35.62"></a><span id="l35.62">       }</span>
<a href="#l35.63"></a><span id="l35.63">       return;</span>
<a href="#l35.64"></a><span id="l35.64">     }</span>
<a href="#l35.65"></a><span id="l35.65">     if (aTopic == &quot;buddy-authorization-request-canceled&quot;) {</span>
<a href="#l35.66"></a><span id="l35.66">       aSubject.QueryInterface(Ci.prplIBuddyRequest);</span>
<a href="#l35.67"></a><span id="l35.67">       let value =</span>
<a href="#l35.68"></a><span id="l35.68">         &quot;buddy-auth-request-&quot; + aSubject.account.id + aSubject.userName;</span>
<a href="#l35.69"></a><span id="l35.69" class="difflineminus">-      let box = document.getElementById(&quot;chatNotificationBox&quot;);</span>
<a href="#l35.70"></a><span id="l35.70" class="difflineplus">+      let box = this.msgNotificationBar;</span>
<a href="#l35.71"></a><span id="l35.71">       let notification = box.getNotificationWithValue(value);</span>
<a href="#l35.72"></a><span id="l35.72" class="difflineminus">-      if (notification)</span>
<a href="#l35.73"></a><span id="l35.73" class="difflineplus">+      if (notification) {</span>
<a href="#l35.74"></a><span id="l35.74">         notification.close();</span>
<a href="#l35.75"></a><span id="l35.75" class="difflineplus">+      }</span>
<a href="#l35.76"></a><span id="l35.76">     }</span>
<a href="#l35.77"></a><span id="l35.77">   },</span>
<a href="#l35.78"></a><span id="l35.78">   initAfterChatCore() {</span>
<a href="#l35.79"></a><span id="l35.79">     let onGroup = document.getElementById(&quot;onlinecontactsGroup&quot;);</span>
<a href="#l35.80"></a><span id="l35.80">     let offGroup = document.getElementById(&quot;offlinecontactsGroup&quot;);</span>
<a href="#l35.81"></a><span id="l35.81"> </span>
<a href="#l35.82"></a><span id="l35.82">     for (let name in chatHandler.allContacts) {</span>
<a href="#l35.83"></a><span id="l35.83">       let contact = chatHandler.allContacts[name];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/mail/components/im/content/imAccounts.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/mail/components/im/content/imAccounts.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -1,14 +1,14 @@</span>
<a href="#l36.4"></a><span id="l36.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l36.5"></a><span id="l36.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l36.6"></a><span id="l36.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l36.7"></a><span id="l36.7"> </span>
<a href="#l36.8"></a><span id="l36.8"> // mail/base/content/nsDragAndDrop.js</span>
<a href="#l36.9"></a><span id="l36.9" class="difflineminus">-/* globals FlavourSet, TransferData */</span>
<a href="#l36.10"></a><span id="l36.10" class="difflineplus">+/* globals FlavourSet, TransferData, MozElements */</span>
<a href="#l36.11"></a><span id="l36.11"> // imStatusSelector.js</span>
<a href="#l36.12"></a><span id="l36.12"> /* globals statusSelector */</span>
<a href="#l36.13"></a><span id="l36.13"> </span>
<a href="#l36.14"></a><span id="l36.14"> var {Services} = ChromeUtils.import(&quot;resource:///modules/imServices.jsm&quot;);</span>
<a href="#l36.15"></a><span id="l36.15"> var {fixIterator} = ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l36.16"></a><span id="l36.16"> var {MailServices} = ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l36.17"></a><span id="l36.17"> var {DownloadUtils} = ChromeUtils.import(&quot;resource://gre/modules/DownloadUtils.jsm&quot;);</span>
<a href="#l36.18"></a><span id="l36.18"> ChromeUtils.defineModuleGetter(this, &quot;PluralForm&quot;, &quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l36.19"></a><span id="l36.19" class="difflineat">@@ -32,16 +32,27 @@ var events = [</span>
<a href="#l36.20"></a><span id="l36.20"> ];</span>
<a href="#l36.21"></a><span id="l36.21"> </span>
<a href="#l36.22"></a><span id="l36.22"> var gAccountManager = {</span>
<a href="#l36.23"></a><span id="l36.23">   // Sets the delay after connect() or disconnect() during which</span>
<a href="#l36.24"></a><span id="l36.24">   // it is impossible to perform disconnect() and connect()</span>
<a href="#l36.25"></a><span id="l36.25">   _disabledDelay: 500,</span>
<a href="#l36.26"></a><span id="l36.26">   disableTimerID: 0,</span>
<a href="#l36.27"></a><span id="l36.27">   _connectedLabelInterval: 0,</span>
<a href="#l36.28"></a><span id="l36.28" class="difflineplus">+</span>
<a href="#l36.29"></a><span id="l36.29" class="difflineplus">+  get msgNotificationBar() {</span>
<a href="#l36.30"></a><span id="l36.30" class="difflineplus">+    delete this.msgNotificationBar;</span>
<a href="#l36.31"></a><span id="l36.31" class="difflineplus">+</span>
<a href="#l36.32"></a><span id="l36.32" class="difflineplus">+    let newNotificationBox = new MozElements.NotificationBox(element =&gt; {</span>
<a href="#l36.33"></a><span id="l36.33" class="difflineplus">+      document.getElementById(&quot;accounts-notification-box&quot;).prepend(element);</span>
<a href="#l36.34"></a><span id="l36.34" class="difflineplus">+    });</span>
<a href="#l36.35"></a><span id="l36.35" class="difflineplus">+</span>
<a href="#l36.36"></a><span id="l36.36" class="difflineplus">+    return this.msgNotificationBar = newNotificationBox;</span>
<a href="#l36.37"></a><span id="l36.37" class="difflineplus">+  },</span>
<a href="#l36.38"></a><span id="l36.38" class="difflineplus">+</span>
<a href="#l36.39"></a><span id="l36.39">   load() {</span>
<a href="#l36.40"></a><span id="l36.40">     // Wait until the password service is ready before offering anything.</span>
<a href="#l36.41"></a><span id="l36.41">     Services.logins.initializationPromise.then(() =&gt; {</span>
<a href="#l36.42"></a><span id="l36.42">       this.accountList = document.getElementById(&quot;accountlist&quot;);</span>
<a href="#l36.43"></a><span id="l36.43">       let defaultID;</span>
<a href="#l36.44"></a><span id="l36.44">       Services.core.init(); // ensure the imCore is initialized.</span>
<a href="#l36.45"></a><span id="l36.45">       for (let acc of this.getAccounts()) {</span>
<a href="#l36.46"></a><span id="l36.46">         let elt = document.createElement(&quot;richlistitem&quot;, { is: &quot;chat-account-richlistitem&quot; });</span>
<a href="#l36.47"></a><span id="l36.47" class="difflineat">@@ -112,18 +123,18 @@ var gAccountManager = {</span>
<a href="#l36.48"></a><span id="l36.48">   },</span>
<a href="#l36.49"></a><span id="l36.49">   observe(aObject, aTopic, aData) {</span>
<a href="#l36.50"></a><span id="l36.50">     if (aTopic == &quot;prpl-quit&quot;) {</span>
<a href="#l36.51"></a><span id="l36.51">       // libpurple is being uninitialized. We don't need the account</span>
<a href="#l36.52"></a><span id="l36.52">       // manager window anymore, close it.</span>
<a href="#l36.53"></a><span id="l36.53">       this.close();</span>
<a href="#l36.54"></a><span id="l36.54">       return;</span>
<a href="#l36.55"></a><span id="l36.55">     } else if (aTopic == &quot;autologin-processed&quot;) {</span>
<a href="#l36.56"></a><span id="l36.56" class="difflineminus">-      var notification = document.getElementById(&quot;accountsNotificationBox&quot;)</span>
<a href="#l36.57"></a><span id="l36.57" class="difflineminus">-                                 .getNotificationWithValue(&quot;autoLoginStatus&quot;);</span>
<a href="#l36.58"></a><span id="l36.58" class="difflineplus">+      let notification = this.msgNotificationBar</span>
<a href="#l36.59"></a><span id="l36.59" class="difflineplus">+                             .getNotificationWithValue(&quot;autoLoginStatus&quot;);</span>
<a href="#l36.60"></a><span id="l36.60">       if (notification)</span>
<a href="#l36.61"></a><span id="l36.61">         notification.close();</span>
<a href="#l36.62"></a><span id="l36.62">       return;</span>
<a href="#l36.63"></a><span id="l36.63">     } else if (aTopic == &quot;network:offline-status-changed&quot;) {</span>
<a href="#l36.64"></a><span id="l36.64">       this.setOffline(aData == &quot;offline&quot;);</span>
<a href="#l36.65"></a><span id="l36.65">       return;</span>
<a href="#l36.66"></a><span id="l36.66">     } else if (aTopic == &quot;status-changed&quot;) {</span>
<a href="#l36.67"></a><span id="l36.67">       this.setOffline(aObject.statusType == Ci.imIStatusInfo.STATUS_OFFLINE);</span>
<a href="#l36.68"></a><span id="l36.68" class="difflineat">@@ -463,33 +474,36 @@ var gAccountManager = {</span>
<a href="#l36.69"></a><span id="l36.69">       yield accounts.getNext();</span>
<a href="#l36.70"></a><span id="l36.70">   },</span>
<a href="#l36.71"></a><span id="l36.71"> </span>
<a href="#l36.72"></a><span id="l36.72">   openDialog(aUrl, aArgs) {</span>
<a href="#l36.73"></a><span id="l36.73">     this.modalDialog = true;</span>
<a href="#l36.74"></a><span id="l36.74">     window.openDialog(aUrl, &quot;&quot;, &quot;chrome,modal,titlebar,centerscreen&quot;, aArgs);</span>
<a href="#l36.75"></a><span id="l36.75">     this.modalDialog = false;</span>
<a href="#l36.76"></a><span id="l36.76">   },</span>
<a href="#l36.77"></a><span id="l36.77" class="difflineplus">+</span>
<a href="#l36.78"></a><span id="l36.78">   setAutoLoginNotification() {</span>
<a href="#l36.79"></a><span id="l36.79">     var as = Services.accounts;</span>
<a href="#l36.80"></a><span id="l36.80">     var autoLoginStatus = as.autoLoginStatus;</span>
<a href="#l36.81"></a><span id="l36.81">     let isOffline = false;</span>
<a href="#l36.82"></a><span id="l36.82">     let crashCount = 0;</span>
<a href="#l36.83"></a><span id="l36.83" class="difflineminus">-    for (let acc of this.getAccounts())</span>
<a href="#l36.84"></a><span id="l36.84" class="difflineminus">-      if (acc.autoLogin &amp;&amp; acc.firstConnectionState == acc.FIRST_CONNECTION_CRASHED)</span>
<a href="#l36.85"></a><span id="l36.85" class="difflineplus">+    for (let acc of this.getAccounts()) {</span>
<a href="#l36.86"></a><span id="l36.86" class="difflineplus">+      if (acc.autoLogin &amp;&amp; acc.firstConnectionState == acc.FIRST_CONNECTION_CRASHED) {</span>
<a href="#l36.87"></a><span id="l36.87">         ++crashCount;</span>
<a href="#l36.88"></a><span id="l36.88" class="difflineplus">+      }</span>
<a href="#l36.89"></a><span id="l36.89" class="difflineplus">+    }</span>
<a href="#l36.90"></a><span id="l36.90"> </span>
<a href="#l36.91"></a><span id="l36.91">     if (autoLoginStatus == as.AUTOLOGIN_ENABLED &amp;&amp; crashCount == 0) {</span>
<a href="#l36.92"></a><span id="l36.92">       let status = Services.core.globalUserStatus.statusType;</span>
<a href="#l36.93"></a><span id="l36.93">       this.setOffline(isOffline || status == Ci.imIStatusInfo.STATUS_OFFLINE);</span>
<a href="#l36.94"></a><span id="l36.94">       return;</span>
<a href="#l36.95"></a><span id="l36.95">     }</span>
<a href="#l36.96"></a><span id="l36.96"> </span>
<a href="#l36.97"></a><span id="l36.97">     var bundle = document.getElementById(&quot;accountsBundle&quot;);</span>
<a href="#l36.98"></a><span id="l36.98" class="difflineminus">-    var box = document.getElementById(&quot;accountsNotificationBox&quot;);</span>
<a href="#l36.99"></a><span id="l36.99" class="difflineplus">+    let box = this.msgNotificationBar;</span>
<a href="#l36.100"></a><span id="l36.100">     var priority = box.PRIORITY_INFO_HIGH;</span>
<a href="#l36.101"></a><span id="l36.101">     var connectNowButton = {</span>
<a href="#l36.102"></a><span id="l36.102">       accessKey: bundle.getString(&quot;accountsManager.notification.button.accessKey&quot;),</span>
<a href="#l36.103"></a><span id="l36.103">       callback: this.processAutoLogin,</span>
<a href="#l36.104"></a><span id="l36.104">       label: bundle.getString(&quot;accountsManager.notification.button.label&quot;),</span>
<a href="#l36.105"></a><span id="l36.105">     };</span>
<a href="#l36.106"></a><span id="l36.106">     var label;</span>
<a href="#l36.107"></a><span id="l36.107"> </span>
<a href="#l36.108"></a><span id="l36.108" class="difflineat">@@ -522,39 +536,46 @@ var gAccountManager = {</span>
<a href="#l36.109"></a><span id="l36.109">         break;</span>
<a href="#l36.110"></a><span id="l36.110"> </span>
<a href="#l36.111"></a><span id="l36.111">       default:</span>
<a href="#l36.112"></a><span id="l36.112">         label = bundle.getString(&quot;accountsManager.notification.other.label&quot;);</span>
<a href="#l36.113"></a><span id="l36.113">     }</span>
<a href="#l36.114"></a><span id="l36.114">     let status = Services.core.globalUserStatus.statusType;</span>
<a href="#l36.115"></a><span id="l36.115">     this.setOffline(isOffline || status == Ci.imIStatusInfo.STATUS_OFFLINE);</span>
<a href="#l36.116"></a><span id="l36.116"> </span>
<a href="#l36.117"></a><span id="l36.117" class="difflineminus">-    box.appendNotification(label, &quot;autologinStatus&quot;, null, priority, [connectNowButton]);</span>
<a href="#l36.118"></a><span id="l36.118" class="difflineplus">+    box.appendNotification(label,</span>
<a href="#l36.119"></a><span id="l36.119" class="difflineplus">+                           &quot;autologinStatus&quot;,</span>
<a href="#l36.120"></a><span id="l36.120" class="difflineplus">+                           null,</span>
<a href="#l36.121"></a><span id="l36.121" class="difflineplus">+                           priority,</span>
<a href="#l36.122"></a><span id="l36.122" class="difflineplus">+                           [connectNowButton]);</span>
<a href="#l36.123"></a><span id="l36.123">   },</span>
<a href="#l36.124"></a><span id="l36.124">   processAutoLogin() {</span>
<a href="#l36.125"></a><span id="l36.125">     var ioService = Services.io;</span>
<a href="#l36.126"></a><span id="l36.126">     if (ioService.offline) {</span>
<a href="#l36.127"></a><span id="l36.127">       ioService.manageOfflineStatus = false;</span>
<a href="#l36.128"></a><span id="l36.128">       ioService.offline = false;</span>
<a href="#l36.129"></a><span id="l36.129">     }</span>
<a href="#l36.130"></a><span id="l36.130"> </span>
<a href="#l36.131"></a><span id="l36.131">     Services.accounts.processAutoLogin();</span>
<a href="#l36.132"></a><span id="l36.132"> </span>
<a href="#l36.133"></a><span id="l36.133">     gAccountManager.accountList.selectedItem.buttons.setFocus();</span>
<a href="#l36.134"></a><span id="l36.134">   },</span>
<a href="#l36.135"></a><span id="l36.135">   processCrashedAccountsLogin() {</span>
<a href="#l36.136"></a><span id="l36.136" class="difflineminus">-    for (let acc in gAccountManager.getAccounts())</span>
<a href="#l36.137"></a><span id="l36.137" class="difflineplus">+    for (let acc in gAccountManager.getAccounts()) {</span>
<a href="#l36.138"></a><span id="l36.138">       if (acc.disconnected &amp;&amp; acc.autoLogin &amp;&amp;</span>
<a href="#l36.139"></a><span id="l36.139" class="difflineminus">-          acc.firstConnectionState == acc.FIRST_CONNECTION_CRASHED)</span>
<a href="#l36.140"></a><span id="l36.140" class="difflineplus">+          acc.firstConnectionState == acc.FIRST_CONNECTION_CRASHED) {</span>
<a href="#l36.141"></a><span id="l36.141">         acc.connect();</span>
<a href="#l36.142"></a><span id="l36.142" class="difflineplus">+      }</span>
<a href="#l36.143"></a><span id="l36.143" class="difflineplus">+    }</span>
<a href="#l36.144"></a><span id="l36.144"> </span>
<a href="#l36.145"></a><span id="l36.145" class="difflineminus">-    let notification = document.getElementById(&quot;accountsNotificationBox&quot;)</span>
<a href="#l36.146"></a><span id="l36.146" class="difflineminus">-                               .getNotificationWithValue(&quot;autoLoginStatus&quot;);</span>
<a href="#l36.147"></a><span id="l36.147" class="difflineminus">-    if (notification)</span>
<a href="#l36.148"></a><span id="l36.148" class="difflineplus">+    let notification = this.msgNotificationBar</span>
<a href="#l36.149"></a><span id="l36.149" class="difflineplus">+                           .getNotificationWithValue(&quot;autoLoginStatus&quot;);</span>
<a href="#l36.150"></a><span id="l36.150" class="difflineplus">+    if (notification) {</span>
<a href="#l36.151"></a><span id="l36.151">       notification.close();</span>
<a href="#l36.152"></a><span id="l36.152" class="difflineplus">+    }</span>
<a href="#l36.153"></a><span id="l36.153"> </span>
<a href="#l36.154"></a><span id="l36.154">     gAccountManager.accountList.selectedItem.buttons.setFocus();</span>
<a href="#l36.155"></a><span id="l36.155">   },</span>
<a href="#l36.156"></a><span id="l36.156">   setOffline(aState) {</span>
<a href="#l36.157"></a><span id="l36.157">     this.isOffline = aState;</span>
<a href="#l36.158"></a><span id="l36.158">     if (aState)</span>
<a href="#l36.159"></a><span id="l36.159">       this.accountList.setAttribute(&quot;offline&quot;, &quot;true&quot;);</span>
<a href="#l36.160"></a><span id="l36.160">     else</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/mail/components/im/content/imAccounts.xul</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/mail/components/im/content/imAccounts.xul</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -25,16 +25,17 @@</span>
<a href="#l37.4"></a><span id="l37.4">         title=&quot;&amp;accountsWindow.title;&quot;</span>
<a href="#l37.5"></a><span id="l37.5">         style=&quot;&amp;accountsWindow2.style;&quot;</span>
<a href="#l37.6"></a><span id="l37.6">         persist=&quot;width height screenX screenY&quot;&gt;</span>
<a href="#l37.7"></a><span id="l37.7">  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/chat/imAccounts.js&quot;/&gt;</span>
<a href="#l37.8"></a><span id="l37.8">  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://messenger/content/chat/imStatusSelector.js&quot;/&gt;</span>
<a href="#l37.9"></a><span id="l37.9">  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/nsDragAndDrop.js&quot; /&gt;</span>
<a href="#l37.10"></a><span id="l37.10">  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://global/content/nsTransferable.js&quot; /&gt;</span>
<a href="#l37.11"></a><span id="l37.11">  &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://chat/content/chat-account-richlistitem.js&quot; /&gt;</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineplus">+ &lt;stringbundle id=&quot;accountsBundle&quot; src=&quot;chrome://messenger/locale/imAccounts.properties&quot;/&gt;</span>
<a href="#l37.13"></a><span id="l37.13"> </span>
<a href="#l37.14"></a><span id="l37.14">  &lt;linkset&gt;</span>
<a href="#l37.15"></a><span id="l37.15">    &lt;html:link rel=&quot;localization&quot; href=&quot;security/certificates/certManager.ftl&quot;/&gt;</span>
<a href="#l37.16"></a><span id="l37.16">  &lt;/linkset&gt;</span>
<a href="#l37.17"></a><span id="l37.17"> </span>
<a href="#l37.18"></a><span id="l37.18">  &lt;stringbundle id=&quot;chatBundle&quot; src=&quot;chrome://messenger/locale/chat.properties&quot;/&gt;</span>
<a href="#l37.19"></a><span id="l37.19"> </span>
<a href="#l37.20"></a><span id="l37.20">  &lt;commandset id=&quot;accountsCommands&quot;&gt;</span>
<a href="#l37.21"></a><span id="l37.21" class="difflineat">@@ -126,32 +127,35 @@</span>
<a href="#l37.22"></a><span id="l37.22">          &lt;label id=&quot;displayName&quot; onclick=&quot;statusSelector.displayNameClick();&quot;/&gt;</span>
<a href="#l37.23"></a><span id="l37.23">        &lt;/vbox&gt;</span>
<a href="#l37.24"></a><span id="l37.24">        &lt;label id=&quot;statusMessage&quot; crop=&quot;end&quot; value=&quot;&quot;</span>
<a href="#l37.25"></a><span id="l37.25">               onclick=&quot;statusSelector.statusMessageClick();&quot;/&gt;</span>
<a href="#l37.26"></a><span id="l37.26">      &lt;/stack&gt;</span>
<a href="#l37.27"></a><span id="l37.27">    &lt;/toolbar&gt;</span>
<a href="#l37.28"></a><span id="l37.28">  &lt;/toolbox&gt;</span>
<a href="#l37.29"></a><span id="l37.29"> </span>
<a href="#l37.30"></a><span id="l37.30" class="difflineminus">- &lt;deck flex=&quot;1&quot; id=&quot;accountsDesk&quot; ondblclick=&quot;gAccountManager.new();&quot;&gt;</span>
<a href="#l37.31"></a><span id="l37.31" class="difflineminus">-   &lt;vbox flex=&quot;1&quot; id=&quot;noAccountScreen&quot; align=&quot;center&quot; pack=&quot;center&quot;&gt;</span>
<a href="#l37.32"></a><span id="l37.32" class="difflineminus">-     &lt;hbox id=&quot;noAccountBox&quot; align=&quot;top&quot;&gt;</span>
<a href="#l37.33"></a><span id="l37.33" class="difflineminus">-       &lt;vbox id=&quot;noAccountInnerBox&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l37.34"></a><span id="l37.34" class="difflineminus">-         &lt;label id=&quot;noAccountTitle&quot; value=&quot;&amp;accountManager.noAccount.title;&quot;/&gt;</span>
<a href="#l37.35"></a><span id="l37.35" class="difflineminus">-         &lt;description id=&quot;noAccountDesc&quot;&gt;&amp;accountManager.noAccount.description;&lt;/description&gt;</span>
<a href="#l37.36"></a><span id="l37.36" class="difflineminus">-       &lt;/vbox&gt;</span>
<a href="#l37.37"></a><span id="l37.37" class="difflineminus">-     &lt;/hbox&gt;</span>
<a href="#l37.38"></a><span id="l37.38" class="difflineminus">-   &lt;/vbox&gt;</span>
<a href="#l37.39"></a><span id="l37.39" class="difflineminus">-   &lt;notificationbox id=&quot;accountsNotificationBox&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l37.40"></a><span id="l37.40" class="difflineminus">-     &lt;richlistbox id=&quot;accountlist&quot; flex=&quot;1&quot; context=&quot;accountsContextMenu&quot;</span>
<a href="#l37.41"></a><span id="l37.41" class="difflineminus">-                  onselect=&quot;gAccountManager.onAccountSelect();&quot;</span>
<a href="#l37.42"></a><span id="l37.42" class="difflineminus">-                  ondragstart=&quot;nsDragAndDrop.startDrag(event, gAMDragAndDrop);&quot;</span>
<a href="#l37.43"></a><span id="l37.43" class="difflineminus">-                  ondragover=&quot;nsDragAndDrop.dragOver(event, gAMDragAndDrop);&quot;</span>
<a href="#l37.44"></a><span id="l37.44" class="difflineminus">-                  ondragend=&quot;gAMDragAndDrop.cleanBorders(true);&quot;</span>
<a href="#l37.45"></a><span id="l37.45" class="difflineminus">-                  ondrop=&quot;nsDragAndDrop.drop(event, gAMDragAndDrop);&quot;/&gt;</span>
<a href="#l37.46"></a><span id="l37.46" class="difflineminus">-   &lt;/notificationbox&gt;</span>
<a href="#l37.47"></a><span id="l37.47" class="difflineminus">- &lt;/deck&gt;</span>
<a href="#l37.48"></a><span id="l37.48" class="difflineminus">- &lt;hbox id=&quot;bottombuttons&quot; align=&quot;center&quot;&gt;</span>
<a href="#l37.49"></a><span id="l37.49" class="difflineminus">-  &lt;button id=&quot;newaccount&quot; command=&quot;cmd_new&quot;/&gt;</span>
<a href="#l37.50"></a><span id="l37.50" class="difflineminus">-  &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l37.51"></a><span id="l37.51" class="difflineminus">-  &lt;button id=&quot;close&quot; command=&quot;cmd_close&quot;/&gt;</span>
<a href="#l37.52"></a><span id="l37.52" class="difflineminus">- &lt;/hbox&gt;</span>
<a href="#l37.53"></a><span id="l37.53" class="difflineplus">+  &lt;deck flex=&quot;1&quot; id=&quot;accountsDesk&quot; ondblclick=&quot;gAccountManager.new();&quot;&gt;</span>
<a href="#l37.54"></a><span id="l37.54" class="difflineplus">+    &lt;vbox flex=&quot;1&quot; id=&quot;noAccountScreen&quot; align=&quot;center&quot; pack=&quot;center&quot;&gt;</span>
<a href="#l37.55"></a><span id="l37.55" class="difflineplus">+      &lt;hbox id=&quot;noAccountBox&quot; align=&quot;top&quot;&gt;</span>
<a href="#l37.56"></a><span id="l37.56" class="difflineplus">+        &lt;vbox id=&quot;noAccountInnerBox&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l37.57"></a><span id="l37.57" class="difflineplus">+          &lt;label id=&quot;noAccountTitle&quot; value=&quot;&amp;accountManager.noAccount.title;&quot;/&gt;</span>
<a href="#l37.58"></a><span id="l37.58" class="difflineplus">+          &lt;description id=&quot;noAccountDesc&quot;&gt;&amp;accountManager.noAccount.description;&lt;/description&gt;</span>
<a href="#l37.59"></a><span id="l37.59" class="difflineplus">+        &lt;/vbox&gt;</span>
<a href="#l37.60"></a><span id="l37.60" class="difflineplus">+      &lt;/hbox&gt;</span>
<a href="#l37.61"></a><span id="l37.61" class="difflineplus">+    &lt;/vbox&gt;</span>
<a href="#l37.62"></a><span id="l37.62" class="difflineplus">+</span>
<a href="#l37.63"></a><span id="l37.63" class="difflineplus">+    &lt;vbox id=&quot;accounts-notification-box&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l37.64"></a><span id="l37.64" class="difflineplus">+      &lt;!-- notificationbox will be added here lazily. --&gt;</span>
<a href="#l37.65"></a><span id="l37.65" class="difflineplus">+      &lt;richlistbox id=&quot;accountlist&quot; flex=&quot;1&quot; context=&quot;accountsContextMenu&quot;</span>
<a href="#l37.66"></a><span id="l37.66" class="difflineplus">+                   onselect=&quot;gAccountManager.onAccountSelect();&quot;</span>
<a href="#l37.67"></a><span id="l37.67" class="difflineplus">+                   ondragstart=&quot;nsDragAndDrop.startDrag(event, gAMDragAndDrop);&quot;</span>
<a href="#l37.68"></a><span id="l37.68" class="difflineplus">+                   ondragover=&quot;nsDragAndDrop.dragOver(event, gAMDragAndDrop);&quot;</span>
<a href="#l37.69"></a><span id="l37.69" class="difflineplus">+                   ondragend=&quot;gAMDragAndDrop.cleanBorders(true);&quot;</span>
<a href="#l37.70"></a><span id="l37.70" class="difflineplus">+                   ondrop=&quot;nsDragAndDrop.drop(event, gAMDragAndDrop);&quot;/&gt;</span>
<a href="#l37.71"></a><span id="l37.71" class="difflineplus">+    &lt;/vbox&gt;</span>
<a href="#l37.72"></a><span id="l37.72" class="difflineplus">+  &lt;/deck&gt;</span>
<a href="#l37.73"></a><span id="l37.73" class="difflineplus">+</span>
<a href="#l37.74"></a><span id="l37.74" class="difflineplus">+  &lt;hbox id=&quot;bottombuttons&quot; align=&quot;center&quot;&gt;</span>
<a href="#l37.75"></a><span id="l37.75" class="difflineplus">+    &lt;button id=&quot;newaccount&quot; command=&quot;cmd_new&quot;/&gt;</span>
<a href="#l37.76"></a><span id="l37.76" class="difflineplus">+    &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l37.77"></a><span id="l37.77" class="difflineplus">+    &lt;button id=&quot;close&quot; command=&quot;cmd_close&quot;/&gt;</span>
<a href="#l37.78"></a><span id="l37.78" class="difflineplus">+  &lt;/hbox&gt;</span>
<a href="#l37.79"></a><span id="l37.79"> &lt;/window&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/mail/test/mozmill/cloudfile/test-cloudfile-notifications.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -21,17 +21,17 @@ var MODULE_REQUIRES = [&quot;folder-display-h</span>
<a href="#l38.4"></a><span id="l38.4"> var {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l38.5"></a><span id="l38.5"> var {cloudFileAccounts} = ChromeUtils.import(&quot;resource:///modules/cloudFileAccounts.js&quot;);</span>
<a href="#l38.6"></a><span id="l38.6"> </span>
<a href="#l38.7"></a><span id="l38.7"> var maxSize, oldInsertNotificationPref;</span>
<a href="#l38.8"></a><span id="l38.8"> </span>
<a href="#l38.9"></a><span id="l38.9"> var kOfferThreshold = &quot;mail.compose.big_attachments.threshold_kb&quot;;</span>
<a href="#l38.10"></a><span id="l38.10"> var kInsertNotificationPref = &quot;mail.compose.big_attachments.insert_notification&quot;;</span>
<a href="#l38.11"></a><span id="l38.11"> </span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-var kBoxId = &quot;attachmentNotificationBox&quot;;</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineplus">+var kBoxId = &quot;compose-notification-bottom&quot;;</span>
<a href="#l38.14"></a><span id="l38.14"> </span>
<a href="#l38.15"></a><span id="l38.15"> function setupModule(module) {</span>
<a href="#l38.16"></a><span id="l38.16">   for (let lib of MODULE_REQUIRES) {</span>
<a href="#l38.17"></a><span id="l38.17">     collector.getModule(lib).installInto(module);</span>
<a href="#l38.18"></a><span id="l38.18">   }</span>
<a href="#l38.19"></a><span id="l38.19"> </span>
<a href="#l38.20"></a><span id="l38.20">   gMockCloudfileManager.register();</span>
<a href="#l38.21"></a><span id="l38.21">   gMockFilePickReg.register();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-attachment-reminder.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-attachment-reminder.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -17,17 +17,17 @@ var MODULE_REQUIRES = [&quot;folder-display-h</span>
<a href="#l39.4"></a><span id="l39.4">                          &quot;compose-helpers&quot;,</span>
<a href="#l39.5"></a><span id="l39.5">                          &quot;window-helpers&quot;,</span>
<a href="#l39.6"></a><span id="l39.6">                          &quot;notificationbox-helpers&quot;,</span>
<a href="#l39.7"></a><span id="l39.7">                          &quot;keyboard-helpers&quot;];</span>
<a href="#l39.8"></a><span id="l39.8"> </span>
<a href="#l39.9"></a><span id="l39.9"> var {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l39.10"></a><span id="l39.10"> var {MailServices} = ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l39.11"></a><span id="l39.11"> </span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-var kBoxId = &quot;attachmentNotificationBox&quot;;</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+var kBoxId = &quot;compose-notification-bottom&quot;;</span>
<a href="#l39.14"></a><span id="l39.14"> var kNotificationId = &quot;attachmentReminder&quot;;</span>
<a href="#l39.15"></a><span id="l39.15"> var kReminderPref = &quot;mail.compose.attachment_reminder&quot;;</span>
<a href="#l39.16"></a><span id="l39.16"> var gDrafts;</span>
<a href="#l39.17"></a><span id="l39.17"> var gOutbox;</span>
<a href="#l39.18"></a><span id="l39.18"> </span>
<a href="#l39.19"></a><span id="l39.19"> function setupModule(module) {</span>
<a href="#l39.20"></a><span id="l39.20">   for (let lib of MODULE_REQUIRES) {</span>
<a href="#l39.21"></a><span id="l39.21">     collector.getModule(lib).installInto(module);</span>
<a href="#l39.22"></a><span id="l39.22" class="difflineat">@@ -96,17 +96,17 @@ function assert_manual_reminder_state(aC</span>
<a href="#l39.23"></a><span id="l39.23"> </span>
<a href="#l39.24"></a><span id="l39.24"> /**</span>
<a href="#l39.25"></a><span id="l39.25">  * Returns the keywords string currently shown in the notification message.</span>
<a href="#l39.26"></a><span id="l39.26">  *</span>
<a href="#l39.27"></a><span id="l39.27">  * @param aCwc A compose window controller.</span>
<a href="#l39.28"></a><span id="l39.28">  */</span>
<a href="#l39.29"></a><span id="l39.29"> function get_reminder_keywords(aCwc) {</span>
<a href="#l39.30"></a><span id="l39.30">   assert_automatic_reminder_state(aCwc, true);</span>
<a href="#l39.31"></a><span id="l39.31" class="difflineminus">-  let nBox = aCwc.e(kBoxId);</span>
<a href="#l39.32"></a><span id="l39.32" class="difflineplus">+  let nBox = aCwc.e(kBoxId).querySelector(&quot;.notificationbox-stack&quot;)._notificationBox;</span>
<a href="#l39.33"></a><span id="l39.33">   let notification = nBox.getNotificationWithValue(kNotificationId);</span>
<a href="#l39.34"></a><span id="l39.34">   return notification.querySelector(&quot;#attachmentKeywords&quot;).getAttribute(&quot;value&quot;);</span>
<a href="#l39.35"></a><span id="l39.35"> }</span>
<a href="#l39.36"></a><span id="l39.36"> </span>
<a href="#l39.37"></a><span id="l39.37"> </span>
<a href="#l39.38"></a><span id="l39.38"> /**</span>
<a href="#l39.39"></a><span id="l39.39">  * Test that the attachment reminder works, in general.</span>
<a href="#l39.40"></a><span id="l39.40">  */</span>
<a href="#l39.41"></a><span id="l39.41" class="difflineat">@@ -321,21 +321,21 @@ function test_manual_attachment_reminder</span>
<a href="#l39.42"></a><span id="l39.42"> </span>
<a href="#l39.43"></a><span id="l39.43">   close_compose_window(cwc);</span>
<a href="#l39.44"></a><span id="l39.44"> </span>
<a href="#l39.45"></a><span id="l39.45">   // The draft message was saved into Local Folders/Drafts.</span>
<a href="#l39.46"></a><span id="l39.46">   be_in_folder(gDrafts);</span>
<a href="#l39.47"></a><span id="l39.47"> </span>
<a href="#l39.48"></a><span id="l39.48">   select_click_row(0);</span>
<a href="#l39.49"></a><span id="l39.49">   // Wait for the notification with the Edit button.</span>
<a href="#l39.50"></a><span id="l39.50" class="difflineminus">-  wait_for_notification_to_show(mc, &quot;msgNotificationBar&quot;, &quot;draftMsgContent&quot;);</span>
<a href="#l39.51"></a><span id="l39.51" class="difflineplus">+  wait_for_notification_to_show(mc, &quot;mail-notification-top&quot;, &quot;draftMsgContent&quot;);</span>
<a href="#l39.52"></a><span id="l39.52">   // Edit the draft again...</span>
<a href="#l39.53"></a><span id="l39.53">   plan_for_new_window(&quot;msgcompose&quot;);</span>
<a href="#l39.54"></a><span id="l39.54">   // ... by clicking Edit in the draft message notification bar.</span>
<a href="#l39.55"></a><span id="l39.55" class="difflineminus">-  mc.click(mc.eid(&quot;msgNotificationBar&quot;, {tagName: &quot;button&quot;, label: &quot;Edit&quot;}));</span>
<a href="#l39.56"></a><span id="l39.56" class="difflineplus">+  mc.click(mc.eid(&quot;mail-notification-top&quot;, {tagName: &quot;button&quot;, label: &quot;Edit&quot;}));</span>
<a href="#l39.57"></a><span id="l39.57">   cwc = wait_for_compose_window();</span>
<a href="#l39.58"></a><span id="l39.58"> </span>
<a href="#l39.59"></a><span id="l39.59">   // Check the reminder enablement was preserved in the message.</span>
<a href="#l39.60"></a><span id="l39.60">   assert_manual_reminder_state(cwc, true);</span>
<a href="#l39.61"></a><span id="l39.61">   // There should be no attachment notification.</span>
<a href="#l39.62"></a><span id="l39.62">   assert_automatic_reminder_state(cwc, false);</span>
<a href="#l39.63"></a><span id="l39.63"> </span>
<a href="#l39.64"></a><span id="l39.64">   // Now try to send, make sure we get the alert.</span>
<a href="#l39.65"></a><span id="l39.65" class="difflineat">@@ -582,21 +582,21 @@ function test_reminder_in_draft() {</span>
<a href="#l39.66"></a><span id="l39.66">   cwc.window.goDoCommand(&quot;cmd_close&quot;);</span>
<a href="#l39.67"></a><span id="l39.67">   wait_for_modal_dialog(&quot;commonDialog&quot;);</span>
<a href="#l39.68"></a><span id="l39.68"> </span>
<a href="#l39.69"></a><span id="l39.69">   // The draft message was saved into Local Folders/Drafts.</span>
<a href="#l39.70"></a><span id="l39.70">   be_in_folder(gDrafts);</span>
<a href="#l39.71"></a><span id="l39.71"> </span>
<a href="#l39.72"></a><span id="l39.72">   select_click_row(0);</span>
<a href="#l39.73"></a><span id="l39.73">   // Wait for the notification with the Edit button.</span>
<a href="#l39.74"></a><span id="l39.74" class="difflineminus">-  wait_for_notification_to_show(mc, &quot;msgNotificationBar&quot;, &quot;draftMsgContent&quot;);</span>
<a href="#l39.75"></a><span id="l39.75" class="difflineplus">+  wait_for_notification_to_show(mc, &quot;mail-notification-top&quot;, &quot;draftMsgContent&quot;);</span>
<a href="#l39.76"></a><span id="l39.76">   // Edit the draft again...</span>
<a href="#l39.77"></a><span id="l39.77">   plan_for_new_window(&quot;msgcompose&quot;);</span>
<a href="#l39.78"></a><span id="l39.78">   // ... by clicking Edit in the draft message notification bar.</span>
<a href="#l39.79"></a><span id="l39.79" class="difflineminus">-  mc.click(mc.eid(&quot;msgNotificationBar&quot;, {tagName: &quot;button&quot;, label: &quot;Edit&quot;}));</span>
<a href="#l39.80"></a><span id="l39.80" class="difflineplus">+  mc.click(mc.eid(&quot;mail-notification-top&quot;, {tagName: &quot;button&quot;, label: &quot;Edit&quot;}));</span>
<a href="#l39.81"></a><span id="l39.81">   cwc = wait_for_compose_window();</span>
<a href="#l39.82"></a><span id="l39.82"> </span>
<a href="#l39.83"></a><span id="l39.83">   // Give the notification time to appear.</span>
<a href="#l39.84"></a><span id="l39.84">   wait_for_reminder_state(cwc, true);</span>
<a href="#l39.85"></a><span id="l39.85"> </span>
<a href="#l39.86"></a><span id="l39.86">   close_compose_window(cwc);</span>
<a href="#l39.87"></a><span id="l39.87"> </span>
<a href="#l39.88"></a><span id="l39.88">   // Delete the leftover draft message.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-blocked-content.js</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-blocked-content.js</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -22,17 +22,17 @@ var MODULE_REQUIRES = [</span>
<a href="#l40.4"></a><span id="l40.4"> </span>
<a href="#l40.5"></a><span id="l40.5"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l40.6"></a><span id="l40.6"> var {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l40.7"></a><span id="l40.7"> var {MailServices} = ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l40.8"></a><span id="l40.8"> var {OS} = ChromeUtils.import(&quot;resource://gre/modules/osfile.jsm&quot;);</span>
<a href="#l40.9"></a><span id="l40.9"> </span>
<a href="#l40.10"></a><span id="l40.10"> var gOutboxFolder;</span>
<a href="#l40.11"></a><span id="l40.11"> </span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-var kBoxId = &quot;attachmentNotificationBox&quot;;</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+var kBoxId = &quot;compose-notification-bottom&quot;;</span>
<a href="#l40.14"></a><span id="l40.14"> var kNotificationId = &quot;blockedContent&quot;;</span>
<a href="#l40.15"></a><span id="l40.15"> </span>
<a href="#l40.16"></a><span id="l40.16"> function setupModule(module) {</span>
<a href="#l40.17"></a><span id="l40.17">   for (let req of MODULE_REQUIRES) {</span>
<a href="#l40.18"></a><span id="l40.18">     collector.getModule(req).installInto(module);</span>
<a href="#l40.19"></a><span id="l40.19">   }</span>
<a href="#l40.20"></a><span id="l40.20">   gOutboxFolder = get_special_folder(Ci.nsMsgFolderFlags.Queue);</span>
<a href="#l40.21"></a><span id="l40.21"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-charset-edit.js</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-charset-edit.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -106,20 +106,20 @@ function test_wrong_reply_charset() {</span>
<a href="#l41.4"></a><span id="l41.4">   let draftMsg = select_click_row(1);</span>
<a href="#l41.5"></a><span id="l41.5">   assert_equals(getMsgHeaders(draftMsg).get(&quot;&quot;).charset, &quot;windows-1252&quot;);</span>
<a href="#l41.6"></a><span id="l41.6">   press_delete(mc); // Delete message</span>
<a href="#l41.7"></a><span id="l41.7"> </span>
<a href="#l41.8"></a><span id="l41.8">   // Edit the original message. Charset should be windows-1252 now.</span>
<a href="#l41.9"></a><span id="l41.9">   msg = select_click_row(0);</span>
<a href="#l41.10"></a><span id="l41.10"> </span>
<a href="#l41.11"></a><span id="l41.11">   // Wait for the notification with the Edit button.</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-  wait_for_notification_to_show(mc, &quot;msgNotificationBar&quot;, &quot;draftMsgContent&quot;);</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+  wait_for_notification_to_show(mc, &quot;mail-notification-top&quot;, &quot;draftMsgContent&quot;);</span>
<a href="#l41.14"></a><span id="l41.14"> </span>
<a href="#l41.15"></a><span id="l41.15">   plan_for_new_window(&quot;msgcompose&quot;);</span>
<a href="#l41.16"></a><span id="l41.16" class="difflineminus">-  mc.click(mc.eid(&quot;msgNotificationBar&quot;, {tagName: &quot;button&quot;, label: &quot;Edit&quot;}));</span>
<a href="#l41.17"></a><span id="l41.17" class="difflineplus">+  mc.click(mc.eid(&quot;mail-notification-top&quot;, {tagName: &quot;button&quot;, label: &quot;Edit&quot;}));</span>
<a href="#l41.18"></a><span id="l41.18">   rwc = wait_for_compose_window();</span>
<a href="#l41.19"></a><span id="l41.19">   rwc.keypress(null, &quot;s&quot;, {shiftKey: false, accelKey: true});</span>
<a href="#l41.20"></a><span id="l41.20">   close_compose_window(rwc);</span>
<a href="#l41.21"></a><span id="l41.21">   msg = select_click_row(0);</span>
<a href="#l41.22"></a><span id="l41.22">   assert_equals(getMsgHeaders(msg).get(&quot;&quot;).charset, &quot;windows-1252&quot;);</span>
<a href="#l41.23"></a><span id="l41.23">   press_delete(mc); // Delete message</span>
<a href="#l41.24"></a><span id="l41.24"> }</span>
<a href="#l41.25"></a><span id="l41.25"> </span>
<a href="#l41.26"></a><span id="l41.26" class="difflineat">@@ -152,20 +152,20 @@ function test_no_mojibake() {</span>
<a href="#l41.27"></a><span id="l41.27">   press_delete(mc);</span>
<a href="#l41.28"></a><span id="l41.28">   if (!text.includes(nonASCII))</span>
<a href="#l41.29"></a><span id="l41.29">     throw new Error(&quot;Expected to find &quot; + nonASCII + &quot; in &quot; + text);</span>
<a href="#l41.30"></a><span id="l41.30"> </span>
<a href="#l41.31"></a><span id="l41.31">   // Edit the original message. Charset should be UTF-8 now.</span>
<a href="#l41.32"></a><span id="l41.32">   msg = select_click_row(0);</span>
<a href="#l41.33"></a><span id="l41.33"> </span>
<a href="#l41.34"></a><span id="l41.34">   // Wait for the notification with the Edit button.</span>
<a href="#l41.35"></a><span id="l41.35" class="difflineminus">-  wait_for_notification_to_show(mc, &quot;msgNotificationBar&quot;, &quot;draftMsgContent&quot;);</span>
<a href="#l41.36"></a><span id="l41.36" class="difflineplus">+  wait_for_notification_to_show(mc, &quot;mail-notification-top&quot;, &quot;draftMsgContent&quot;);</span>
<a href="#l41.37"></a><span id="l41.37"> </span>
<a href="#l41.38"></a><span id="l41.38">   plan_for_new_window(&quot;msgcompose&quot;);</span>
<a href="#l41.39"></a><span id="l41.39" class="difflineminus">-  mc.click(mc.eid(&quot;msgNotificationBar&quot;, {tagName: &quot;button&quot;, label: &quot;Edit&quot;}));</span>
<a href="#l41.40"></a><span id="l41.40" class="difflineplus">+  mc.click(mc.eid(&quot;mail-notification-top&quot;, {tagName: &quot;button&quot;, label: &quot;Edit&quot;}));</span>
<a href="#l41.41"></a><span id="l41.41">   rwc = wait_for_compose_window();</span>
<a href="#l41.42"></a><span id="l41.42">   rwc.keypress(null, &quot;s&quot;, {shiftKey: false, accelKey: true});</span>
<a href="#l41.43"></a><span id="l41.43">   close_compose_window(rwc);</span>
<a href="#l41.44"></a><span id="l41.44">   msg = select_click_row(0);</span>
<a href="#l41.45"></a><span id="l41.45">   assert_equals(getMsgHeaders(msg).get(&quot;&quot;).charset.toUpperCase(), &quot;UTF-8&quot;);</span>
<a href="#l41.46"></a><span id="l41.46">   assert_equals(getMsgHeaders(msg, true).get(&quot;&quot;).trim(), nonASCII);</span>
<a href="#l41.47"></a><span id="l41.47">   press_delete(mc); // Delete message</span>
<a href="#l41.48"></a><span id="l41.48"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-draft-identity.js</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-draft-identity.js</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -173,39 +173,39 @@ function test_draft_identity_selection()</span>
<a href="#l42.4"></a><span id="l42.4">     dump(&quot;Running draft identity test&quot; + tests.indexOf(test));</span>
<a href="#l42.5"></a><span id="l42.5">     be_in_folder(gDrafts);</span>
<a href="#l42.6"></a><span id="l42.6">     select_click_row(test.draftIndex);</span>
<a href="#l42.7"></a><span id="l42.7"> </span>
<a href="#l42.8"></a><span id="l42.8">     let cwc = open_compose_from_draft();</span>
<a href="#l42.9"></a><span id="l42.9">     checkCompIdentity(cwc, gIdentities[test.idIndex].key,</span>
<a href="#l42.10"></a><span id="l42.10">                       test.from ? test.from : test.draftFrom);</span>
<a href="#l42.11"></a><span id="l42.11">     if (test.warning) {</span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-      wait_for_notification_to_show(cwc, &quot;attachmentNotificationBox&quot;,</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineplus">+      wait_for_notification_to_show(cwc, &quot;compose-notification-bottom&quot;,</span>
<a href="#l42.14"></a><span id="l42.14">                                     &quot;identityWarning&quot;);</span>
<a href="#l42.15"></a><span id="l42.15">     } else {</span>
<a href="#l42.16"></a><span id="l42.16" class="difflineminus">-      assert_notification_displayed(cwc, &quot;attachmentNotificationBox&quot;,</span>
<a href="#l42.17"></a><span id="l42.17" class="difflineplus">+      assert_notification_displayed(cwc, &quot;compose-notification-bottom&quot;,</span>
<a href="#l42.18"></a><span id="l42.18">                                     &quot;identityWarning&quot;, false);</span>
<a href="#l42.19"></a><span id="l42.19">     }</span>
<a href="#l42.20"></a><span id="l42.20"> </span>
<a href="#l42.21"></a><span id="l42.21">     close_compose_window(cwc, false);</span>
<a href="#l42.22"></a><span id="l42.22">   }</span>
<a href="#l42.23"></a><span id="l42.23"> /*</span>
<a href="#l42.24"></a><span id="l42.24">   // TODO: fix this in bug 1238264, the identity selector does not properly close.</span>
<a href="#l42.25"></a><span id="l42.25">   // Open a draft again that shows the notification.</span>
<a href="#l42.26"></a><span id="l42.26">   be_in_folder(gDrafts);</span>
<a href="#l42.27"></a><span id="l42.27">   select_click_row(tests[tests.length-1].draftIndex);</span>
<a href="#l42.28"></a><span id="l42.28">   let cwc = open_compose_from_draft();</span>
<a href="#l42.29"></a><span id="l42.29" class="difflineminus">-  wait_for_notification_to_show(cwc, &quot;attachmentNotificationBox&quot;,</span>
<a href="#l42.30"></a><span id="l42.30" class="difflineplus">+  wait_for_notification_to_show(cwc, &quot;compose-notification-bottom&quot;,</span>
<a href="#l42.31"></a><span id="l42.31">                                 &quot;identityWarning&quot;);</span>
<a href="#l42.32"></a><span id="l42.32">   // Notification should go away when another identity is chosen.</span>
<a href="#l42.33"></a><span id="l42.33">   cwc.click(cwc.eid(&quot;msgIdentity&quot;));</span>
<a href="#l42.34"></a><span id="l42.34">   cwc.click_menus_in_sequence(cwc.e(&quot;msgIdentityPopup&quot;),</span>
<a href="#l42.35"></a><span id="l42.35">                               [ { identitykey: gIdentities[0].key } ]);</span>
<a href="#l42.36"></a><span id="l42.36"> </span>
<a href="#l42.37"></a><span id="l42.37" class="difflineminus">-  wait_for_notification_to_stop(cwc, &quot;attachmentNotificationBox&quot;,</span>
<a href="#l42.38"></a><span id="l42.38" class="difflineplus">+  wait_for_notification_to_stop(cwc, &quot;compose-notification-bottom&quot;,</span>
<a href="#l42.39"></a><span id="l42.39">                                 &quot;identityWarning&quot;);</span>
<a href="#l42.40"></a><span id="l42.40">   close_compose_window(cwc, false);</span>
<a href="#l42.41"></a><span id="l42.41"> */</span>
<a href="#l42.42"></a><span id="l42.42"> }</span>
<a href="#l42.43"></a><span id="l42.43"> test_draft_identity_selection.EXCLUDED_PLATFORMS = [&quot;darwin&quot;]; // See bug 1413851.</span>
<a href="#l42.44"></a><span id="l42.44"> </span>
<a href="#l42.45"></a><span id="l42.45"> function teardownModule(module) {</span>
<a href="#l42.46"></a><span id="l42.46">   for (let id = 1; id &lt; gIdentities.length; id++) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/mail/test/mozmill/composition/test-drafts.js</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/mail/test/mozmill/composition/test-drafts.js</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -15,17 +15,17 @@ var MODULE_NAME = &quot;test-drafts&quot;;</span>
<a href="#l43.4"></a><span id="l43.4"> </span>
<a href="#l43.5"></a><span id="l43.5"> var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l43.6"></a><span id="l43.6"> var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;compose-helpers&quot;,</span>
<a href="#l43.7"></a><span id="l43.7">                        &quot;window-helpers&quot;, &quot;notificationbox-helpers&quot;];</span>
<a href="#l43.8"></a><span id="l43.8"> </span>
<a href="#l43.9"></a><span id="l43.9"> var {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l43.10"></a><span id="l43.10"> var {MailServices} = ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l43.11"></a><span id="l43.11"> </span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-var kBoxId = &quot;msgNotificationBar&quot;;</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineplus">+var kBoxId = &quot;mail-notification-top&quot;;</span>
<a href="#l43.14"></a><span id="l43.14"> var draftsFolder;</span>
<a href="#l43.15"></a><span id="l43.15"> </span>
<a href="#l43.16"></a><span id="l43.16"> function setupModule(module) {</span>
<a href="#l43.17"></a><span id="l43.17">   for (let lib of MODULE_REQUIRES) {</span>
<a href="#l43.18"></a><span id="l43.18">     collector.getModule(lib).installInto(module);</span>
<a href="#l43.19"></a><span id="l43.19">   }</span>
<a href="#l43.20"></a><span id="l43.20"> </span>
<a href="#l43.21"></a><span id="l43.21">   draftsFolder = get_special_folder(Ci.nsMsgFolderFlags.Drafts, true);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/mail/test/mozmill/content-policy/test-general-content-policy.js</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/mail/test/mozmill/content-policy/test-general-content-policy.js</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -201,19 +201,19 @@ function checkStandaloneMessageWindow(te</span>
<a href="#l44.4"></a><span id="l44.4"> }</span>
<a href="#l44.5"></a><span id="l44.5"> </span>
<a href="#l44.6"></a><span id="l44.6"> /**</span>
<a href="#l44.7"></a><span id="l44.7">  * Check remote content in stand-alone message window loaded from .eml file.</span>
<a href="#l44.8"></a><span id="l44.8">  * Make sure there's a notification bar.</span>
<a href="#l44.9"></a><span id="l44.9">  */</span>
<a href="#l44.10"></a><span id="l44.10">  function checkEMLMessageWindow(test, emlFile) {</span>
<a href="#l44.11"></a><span id="l44.11">   let msgc = open_message_from_file(emlFile);</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-  if (!msgc.e(&quot;msgNotificationBar&quot;))</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineplus">+  if (!msgc.e(&quot;mail-notification-top&quot;))</span>
<a href="#l44.14"></a><span id="l44.14">     throw new Error(test.type + &quot; has no content notification bar.&quot;);</span>
<a href="#l44.15"></a><span id="l44.15" class="difflineminus">-  if (msgc.e(&quot;msgNotificationBar&quot;).collapsed)</span>
<a href="#l44.16"></a><span id="l44.16" class="difflineplus">+  if (msgc.e(&quot;mail-notification-top&quot;).collapsed)</span>
<a href="#l44.17"></a><span id="l44.17">     throw new Error(test.type + &quot; content notification bar not shown.&quot;);</span>
<a href="#l44.18"></a><span id="l44.18"> </span>
<a href="#l44.19"></a><span id="l44.19">   // Clean up, close the window</span>
<a href="#l44.20"></a><span id="l44.20">   close_message_window(msgc);</span>
<a href="#l44.21"></a><span id="l44.21"> }</span>
<a href="#l44.22"></a><span id="l44.22"> </span>
<a href="#l44.23"></a><span id="l44.23"> /**</span>
<a href="#l44.24"></a><span id="l44.24">  * Helper method to save one of the test files as an .eml file.</span>
<a href="#l44.25"></a><span id="l44.25" class="difflineat">@@ -233,17 +233,17 @@ function saveAsEMLFile(msgNo) {</span>
<a href="#l44.26"></a><span id="l44.26"> }</span>
<a href="#l44.27"></a><span id="l44.27"> </span>
<a href="#l44.28"></a><span id="l44.28"> function allowRemoteContentAndCheck(test) {</span>
<a href="#l44.29"></a><span id="l44.29">   addMsgToFolderAndCheckContent(folder, test);</span>
<a href="#l44.30"></a><span id="l44.30"> </span>
<a href="#l44.31"></a><span id="l44.31">   plan_for_message_display(mc);</span>
<a href="#l44.32"></a><span id="l44.32"> </span>
<a href="#l44.33"></a><span id="l44.33">   // Click on the allow remote content button</span>
<a href="#l44.34"></a><span id="l44.34" class="difflineminus">-  const kBoxId = &quot;msgNotificationBar&quot;;</span>
<a href="#l44.35"></a><span id="l44.35" class="difflineplus">+  const kBoxId = &quot;mail-notification-top&quot;;</span>
<a href="#l44.36"></a><span id="l44.36">   const kNotificationValue = &quot;remoteContent&quot;;</span>
<a href="#l44.37"></a><span id="l44.37">   wait_for_notification_to_show(mc, kBoxId, kNotificationValue);</span>
<a href="#l44.38"></a><span id="l44.38">   let prefButton = get_notification_button(mc, kBoxId, kNotificationValue,</span>
<a href="#l44.39"></a><span id="l44.39">                                            { popup: &quot;remoteContentOptions&quot; });</span>
<a href="#l44.40"></a><span id="l44.40">   mc.click(new elib.Elem(prefButton));</span>
<a href="#l44.41"></a><span id="l44.41">   mc.click_menus_in_sequence(mc.e(&quot;remoteContentOptions&quot;),</span>
<a href="#l44.42"></a><span id="l44.42">                              [{id: &quot;remoteContentOptionAllowForMsg&quot;}]);</span>
<a href="#l44.43"></a><span id="l44.43">   wait_for_notification_to_stop(mc, kBoxId, kNotificationValue);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-opening-messages.js</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-opening-messages.js</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -166,20 +166,21 @@ function test_open_message_in_existing_w</span>
<a href="#l45.4"></a><span id="l45.4">  * Check if the message pane in a new tab has the full height, so no</span>
<a href="#l45.5"></a><span id="l45.5">  * empty box is visible below it.</span>
<a href="#l45.6"></a><span id="l45.6">  */</span>
<a href="#l45.7"></a><span id="l45.7"> </span>
<a href="#l45.8"></a><span id="l45.8"> function check_message_pane_in_tab_full_height() {</span>
<a href="#l45.9"></a><span id="l45.9">   let messagesBoxHeight = mc.e(&quot;messagesBox&quot;).getBoundingClientRect().height;</span>
<a href="#l45.10"></a><span id="l45.10">   let displayDeckHeight = mc.e(&quot;displayDeck&quot;).getBoundingClientRect().height;</span>
<a href="#l45.11"></a><span id="l45.11">   let messagePaneBoxWrapperHeight = mc.e(&quot;messagepaneboxwrapper&quot;).getBoundingClientRect().height;</span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-  let notificationBoxHeight = mc.e(&quot;msg-footer-notification-box&quot;).getBoundingClientRect().height;</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineplus">+  let notificationBoxHeight = mc.e(&quot;messenger-notification-footer&quot;).getBoundingClientRect().height;</span>
<a href="#l45.14"></a><span id="l45.14"> </span>
<a href="#l45.15"></a><span id="l45.15" class="difflineminus">-  assert_equals(messagesBoxHeight, displayDeckHeight + messagePaneBoxWrapperHeight + notificationBoxHeight,</span>
<a href="#l45.16"></a><span id="l45.16" class="difflineminus">-      &quot;messanges box height (&quot; + messagesBoxHeight +</span>
<a href="#l45.17"></a><span id="l45.17" class="difflineplus">+  assert_equals(messagesBoxHeight, displayDeckHeight +</span>
<a href="#l45.18"></a><span id="l45.18" class="difflineplus">+    messagePaneBoxWrapperHeight + notificationBoxHeight,</span>
<a href="#l45.19"></a><span id="l45.19" class="difflineplus">+      &quot;messages box height (&quot; + messagesBoxHeight +</span>
<a href="#l45.20"></a><span id="l45.20">       &quot;) not equal to the sum of displayDeck height (&quot; + displayDeckHeight +</span>
<a href="#l45.21"></a><span id="l45.21">       &quot;) and message pane box wrapper height (&quot; + messagePaneBoxWrapperHeight +</span>
<a href="#l45.22"></a><span id="l45.22">       &quot;) and message notification box height (&quot; + notificationBoxHeight +</span>
<a href="#l45.23"></a><span id="l45.23">       &quot;)&quot;);</span>
<a href="#l45.24"></a><span id="l45.24"> }</span>
<a href="#l45.25"></a><span id="l45.25"> </span>
<a href="#l45.26"></a><span id="l45.26"> /**</span>
<a href="#l45.27"></a><span id="l45.27">  * Check if the message pane in a new window has the full height, so no</span>
<a href="#l45.28"></a><span id="l45.28" class="difflineat">@@ -194,12 +195,12 @@ function check_message_pane_in_window_fu</span>
<a href="#l45.29"></a><span id="l45.29">   for (let child of messengerChildren) {</span>
<a href="#l45.30"></a><span id="l45.30">     try {</span>
<a href="#l45.31"></a><span id="l45.31">       let childRect = child.getBoundingClientRect();</span>
<a href="#l45.32"></a><span id="l45.32">       childrenHeightsSum += childRect.height;</span>
<a href="#l45.33"></a><span id="l45.33">       childrenHeightsStr += '&quot;' + child.id + '&quot;: ' + childRect.height + ', ';</span>
<a href="#l45.34"></a><span id="l45.34">     } catch (ex) {}</span>
<a href="#l45.35"></a><span id="l45.35">   }</span>
<a href="#l45.36"></a><span id="l45.36"> </span>
<a href="#l45.37"></a><span id="l45.37" class="difflineminus">-  assert_equals(messengerWindowHeight, childrenHeightsSum,</span>
<a href="#l45.38"></a><span id="l45.38" class="difflineplus">+  assert_equals(Math.round(messengerWindowHeight), Math.round(childrenHeightsSum),</span>
<a href="#l45.39"></a><span id="l45.39">     &quot;messenger window height not equal to the sum of children heights: &quot; +</span>
<a href="#l45.40"></a><span id="l45.40">     childrenHeightsStr);</span>
<a href="#l45.41"></a><span id="l45.41"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/mail/test/mozmill/message-header/test-phishing-bar.js</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/mail/test/mozmill/message-header/test-phishing-bar.js</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -15,17 +15,17 @@ var MODULE_NAME = &quot;test-phishing-bar&quot;;</span>
<a href="#l46.4"></a><span id="l46.4"> var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l46.5"></a><span id="l46.5"> var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;,</span>
<a href="#l46.6"></a><span id="l46.6">                          &quot;window-helpers&quot;, &quot;notificationbox-helpers&quot;];</span>
<a href="#l46.7"></a><span id="l46.7"> </span>
<a href="#l46.8"></a><span id="l46.8"> var os = ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.jsm&quot;);</span>
<a href="#l46.9"></a><span id="l46.9"> </span>
<a href="#l46.10"></a><span id="l46.10"> var folder;</span>
<a href="#l46.11"></a><span id="l46.11"> </span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-var kBoxId = &quot;msgNotificationBar&quot;;</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineplus">+var kBoxId = &quot;mail-notification-top&quot;;</span>
<a href="#l46.14"></a><span id="l46.14"> var kNotificationValue = &quot;maybeScam&quot;;</span>
<a href="#l46.15"></a><span id="l46.15"> </span>
<a href="#l46.16"></a><span id="l46.16"> function setupModule(module) {</span>
<a href="#l46.17"></a><span id="l46.17">   for (let dep of MODULE_REQUIRES) {</span>
<a href="#l46.18"></a><span id="l46.18">     collector.getModule(dep).installInto(module);</span>
<a href="#l46.19"></a><span id="l46.19">   }</span>
<a href="#l46.20"></a><span id="l46.20"> </span>
<a href="#l46.21"></a><span id="l46.21">   folder = create_folder(&quot;PhishingBarA&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/mail/test/mozmill/message-header/test-return-receipt.js</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/mail/test/mozmill/message-header/test-return-receipt.js</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -13,17 +13,17 @@</span>
<a href="#l47.4"></a><span id="l47.4"> var MODULE_NAME = &quot;test-return-receipt&quot;;</span>
<a href="#l47.5"></a><span id="l47.5"> </span>
<a href="#l47.6"></a><span id="l47.6"> var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l47.7"></a><span id="l47.7"> var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;window-helpers&quot;,</span>
<a href="#l47.8"></a><span id="l47.8">                         &quot;notificationbox-helpers&quot;];</span>
<a href="#l47.9"></a><span id="l47.9"> </span>
<a href="#l47.10"></a><span id="l47.10"> var folder;</span>
<a href="#l47.11"></a><span id="l47.11"> </span>
<a href="#l47.12"></a><span id="l47.12" class="difflineminus">-var kBoxId = &quot;msgNotificationBar&quot;;</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineplus">+var kBoxId = &quot;mail-notification-top&quot;;</span>
<a href="#l47.14"></a><span id="l47.14"> var kNotificationValue = &quot;mdnRequested&quot;;</span>
<a href="#l47.15"></a><span id="l47.15"> </span>
<a href="#l47.16"></a><span id="l47.16"> function setupModule(module) {</span>
<a href="#l47.17"></a><span id="l47.17">   collector.getModule(&quot;folder-display-helpers&quot;).installInto(module);</span>
<a href="#l47.18"></a><span id="l47.18">   collector.getModule(&quot;window-helpers&quot;).installInto(module);</span>
<a href="#l47.19"></a><span id="l47.19">   collector.getModule(&quot;notificationbox-helpers&quot;).installInto(module);</span>
<a href="#l47.20"></a><span id="l47.20"> </span>
<a href="#l47.21"></a><span id="l47.21">   folder = create_folder(&quot;ReturnReceiptTest&quot;);</span>
<a href="#l47.22"></a><span id="l47.22" class="difflineat">@@ -83,26 +83,27 @@ function gotoMsg(row) {</span>
<a href="#l47.23"></a><span id="l47.23">   let curMessage = select_click_row(row);</span>
<a href="#l47.24"></a><span id="l47.24">   assert_selected_and_displayed(mc, curMessage);</span>
<a href="#l47.25"></a><span id="l47.25"> }</span>
<a href="#l47.26"></a><span id="l47.26"> </span>
<a href="#l47.27"></a><span id="l47.27"> /**</span>
<a href="#l47.28"></a><span id="l47.28">  * Utility to make sure the MDN bar is shown / not shown.</span>
<a href="#l47.29"></a><span id="l47.29">  */</span>
<a href="#l47.30"></a><span id="l47.30"> function assert_mdn_shown(shouldShow) {</span>
<a href="#l47.31"></a><span id="l47.31" class="difflineminus">-  let msgNotBar = mc.e(&quot;msgNotificationBar&quot;);</span>
<a href="#l47.32"></a><span id="l47.32" class="difflineplus">+  let msgNotBar = mc.e(&quot;mail-notification-top&quot;);</span>
<a href="#l47.33"></a><span id="l47.33">   assert_notification_displayed(mc, kBoxId, kNotificationValue, shouldShow);</span>
<a href="#l47.34"></a><span id="l47.34"> }</span>
<a href="#l47.35"></a><span id="l47.35"> </span>
<a href="#l47.36"></a><span id="l47.36"> /**</span>
<a href="#l47.37"></a><span id="l47.37">  * Utility function to make sure the notification contains a certain text.</span>
<a href="#l47.38"></a><span id="l47.38">  */</span>
<a href="#l47.39"></a><span id="l47.39"> function assert_mdn_text_contains(text, shouldContain) {</span>
<a href="#l47.40"></a><span id="l47.40">   let nb = mc.window.document.getElementById(kBoxId);</span>
<a href="#l47.41"></a><span id="l47.41" class="difflineminus">-  let notificationText = nb.currentNotification.label;</span>
<a href="#l47.42"></a><span id="l47.42" class="difflineplus">+  let box = nb.querySelector(&quot;.notificationbox-stack&quot;)._notificationBox;</span>
<a href="#l47.43"></a><span id="l47.43" class="difflineplus">+  let notificationText = box.currentNotification.messageText.textContent;</span>
<a href="#l47.44"></a><span id="l47.44">   if (shouldContain &amp;&amp; !notificationText.includes(text))</span>
<a href="#l47.45"></a><span id="l47.45">     throw new Error(&quot;mdnBar should contain text=&quot; + text +</span>
<a href="#l47.46"></a><span id="l47.46">                     &quot;; notificationText=&quot; + notificationText);</span>
<a href="#l47.47"></a><span id="l47.47">   if (!shouldContain &amp;&amp; notificationText.includes(text))</span>
<a href="#l47.48"></a><span id="l47.48">     throw new Error(&quot;mdnBar shouldn't contain text=&quot; + text +</span>
<a href="#l47.49"></a><span id="l47.49">                     &quot;; notificationText=&quot; + notificationText);</span>
<a href="#l47.50"></a><span id="l47.50"> }</span>
<a href="#l47.51"></a><span id="l47.51"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-compose-helpers.js</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/test-compose-helpers.js</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineat">@@ -207,17 +207,17 @@ function open_compose_with_element_click</span>
<a href="#l48.4"></a><span id="l48.4">  * @return The loaded window of type &quot;msgcompose&quot; wrapped in a MozmillController</span>
<a href="#l48.5"></a><span id="l48.5">  *         that is augmented using augment_controller.</span>
<a href="#l48.6"></a><span id="l48.6">  */</span>
<a href="#l48.7"></a><span id="l48.7"> function open_compose_from_draft(aController) {</span>
<a href="#l48.8"></a><span id="l48.8">   if (aController === undefined)</span>
<a href="#l48.9"></a><span id="l48.9">     aController = mc;</span>
<a href="#l48.10"></a><span id="l48.10"> </span>
<a href="#l48.11"></a><span id="l48.11">   windowHelper.plan_for_new_window(&quot;msgcompose&quot;);</span>
<a href="#l48.12"></a><span id="l48.12" class="difflineminus">-  aController.click(aController.eid(&quot;msgNotificationBar&quot;,</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineplus">+  aController.click(aController.eid(&quot;mail-notification-top&quot;,</span>
<a href="#l48.14"></a><span id="l48.14">                                     {tagName: &quot;button&quot;, label: &quot;Edit&quot;}));</span>
<a href="#l48.15"></a><span id="l48.15">   return wait_for_compose_window();</span>
<a href="#l48.16"></a><span id="l48.16"> }</span>
<a href="#l48.17"></a><span id="l48.17"> </span>
<a href="#l48.18"></a><span id="l48.18"> /**</span>
<a href="#l48.19"></a><span id="l48.19">  * Closes the requested compose window.</span>
<a href="#l48.20"></a><span id="l48.20">  *</span>
<a href="#l48.21"></a><span id="l48.21">  * @param aController the controller whose window is to be closed.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-notificationbox-helpers.js</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/test-notificationbox-helpers.js</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineat">@@ -29,22 +29,28 @@ function installInto(module) {</span>
<a href="#l49.4"></a><span id="l49.4">  *                       notification element out of this function in its</span>
<a href="#l49.5"></a><span id="l49.5">  *                       'notification' property</span>
<a href="#l49.6"></a><span id="l49.6">  *</span>
<a href="#l49.7"></a><span id="l49.7">  * @return  True/false depending on the state of the notification.</span>
<a href="#l49.8"></a><span id="l49.8">  */</span>
<a href="#l49.9"></a><span id="l49.9"> function check_notification_displayed(aController, aBoxId, aValue, aNotification) {</span>
<a href="#l49.10"></a><span id="l49.10">   let nb = aController.window.document.getElementById(aBoxId);</span>
<a href="#l49.11"></a><span id="l49.11">   if (!nb)</span>
<a href="#l49.12"></a><span id="l49.12" class="difflineminus">-     throw new Error(&quot;Couldn't find a notification box for id=&quot; + aBoxId);</span>
<a href="#l49.13"></a><span id="l49.13" class="difflineplus">+    throw new Error(&quot;Couldn't find a notification box for id=&quot; + aBoxId);</span>
<a href="#l49.14"></a><span id="l49.14"> </span>
<a href="#l49.15"></a><span id="l49.15" class="difflineminus">-  let notification = nb.getNotificationWithValue(aValue);</span>
<a href="#l49.16"></a><span id="l49.16" class="difflineminus">-  if (aNotification)</span>
<a href="#l49.17"></a><span id="l49.17" class="difflineminus">-    aNotification.notification = notification;</span>
<a href="#l49.18"></a><span id="l49.18" class="difflineminus">-  return (notification != null);</span>
<a href="#l49.19"></a><span id="l49.19" class="difflineplus">+  if (nb.querySelector(&quot;.notificationbox-stack&quot;)) {</span>
<a href="#l49.20"></a><span id="l49.20" class="difflineplus">+    let box = nb.querySelector(&quot;.notificationbox-stack&quot;)._notificationBox</span>
<a href="#l49.21"></a><span id="l49.21" class="difflineplus">+    let notification = box.getNotificationWithValue(aValue);</span>
<a href="#l49.22"></a><span id="l49.22" class="difflineplus">+    if (aNotification) {</span>
<a href="#l49.23"></a><span id="l49.23" class="difflineplus">+      aNotification.notification = notification;</span>
<a href="#l49.24"></a><span id="l49.24" class="difflineplus">+    }</span>
<a href="#l49.25"></a><span id="l49.25" class="difflineplus">+    return (notification != null);</span>
<a href="#l49.26"></a><span id="l49.26" class="difflineplus">+  }</span>
<a href="#l49.27"></a><span id="l49.27" class="difflineplus">+</span>
<a href="#l49.28"></a><span id="l49.28" class="difflineplus">+  return false;</span>
<a href="#l49.29"></a><span id="l49.29"> }</span>
<a href="#l49.30"></a><span id="l49.30"> </span>
<a href="#l49.31"></a><span id="l49.31"> /**</span>
<a href="#l49.32"></a><span id="l49.32">  * A helper function ensuring whether or not a notification with</span>
<a href="#l49.33"></a><span id="l49.33">  * a particular value is being displayed. Throws if the state is</span>
<a href="#l49.34"></a><span id="l49.34">  * not the expected one.</span>
<a href="#l49.35"></a><span id="l49.35">  *</span>
<a href="#l49.36"></a><span id="l49.36">  * @param aController the controller of the window to check</span>
<a href="#l49.37"></a><span id="l49.37" class="difflineat">@@ -73,34 +79,37 @@ function assert_notification_displayed(a</span>
<a href="#l49.38"></a><span id="l49.38">  * @param aBoxId the id of the notification box</span>
<a href="#l49.39"></a><span id="l49.39">  * @param aValue the value of the notification to close</span>
<a href="#l49.40"></a><span id="l49.40">  */</span>
<a href="#l49.41"></a><span id="l49.41"> function close_notification(aController, aBoxId, aValue) {</span>
<a href="#l49.42"></a><span id="l49.42">   let nb = aController.window.document.getElementById(aBoxId);</span>
<a href="#l49.43"></a><span id="l49.43">   if (!nb)</span>
<a href="#l49.44"></a><span id="l49.44">     throw new Error(&quot;Couldn't find a notification box for id=&quot; + aBoxId);</span>
<a href="#l49.45"></a><span id="l49.45"> </span>
<a href="#l49.46"></a><span id="l49.46" class="difflineminus">-  let notification = nb.getNotificationWithValue(aValue);</span>
<a href="#l49.47"></a><span id="l49.47" class="difflineplus">+  let box = nb.querySelector(&quot;.notificationbox-stack&quot;)._notificationBox</span>
<a href="#l49.48"></a><span id="l49.48" class="difflineplus">+  let notification = box.getNotificationWithValue(aValue);</span>
<a href="#l49.49"></a><span id="l49.49">   if (notification)</span>
<a href="#l49.50"></a><span id="l49.50">     notification.close();</span>
<a href="#l49.51"></a><span id="l49.51"> }</span>
<a href="#l49.52"></a><span id="l49.52"> </span>
<a href="#l49.53"></a><span id="l49.53"> /**</span>
<a href="#l49.54"></a><span id="l49.54">  * A helper function that waits for a notification with value aValue</span>
<a href="#l49.55"></a><span id="l49.55">  * to stop displaying in the window.</span>
<a href="#l49.56"></a><span id="l49.56">  *</span>
<a href="#l49.57"></a><span id="l49.57">  * @param aController the controller for the window with the notification</span>
<a href="#l49.58"></a><span id="l49.58">  * @param aBoxId the id of the notification box</span>
<a href="#l49.59"></a><span id="l49.59">  * @param aValue the value of the notification to wait to stop</span>
<a href="#l49.60"></a><span id="l49.60">  */</span>
<a href="#l49.61"></a><span id="l49.61"> function wait_for_notification_to_stop(aController, aBoxId, aValue) {</span>
<a href="#l49.62"></a><span id="l49.62">   let nb = aController.window.document.getElementById(aBoxId);</span>
<a href="#l49.63"></a><span id="l49.63">   if (!nb)</span>
<a href="#l49.64"></a><span id="l49.64">     throw new Error(&quot;Couldn't find a notification box for id=&quot; + aBoxId);</span>
<a href="#l49.65"></a><span id="l49.65" class="difflineminus">-  aController.waitFor(() =&gt; !nb.getNotificationWithValue(aValue),</span>
<a href="#l49.66"></a><span id="l49.66" class="difflineplus">+</span>
<a href="#l49.67"></a><span id="l49.67" class="difflineplus">+  let box = nb.querySelector(&quot;.notificationbox-stack&quot;)._notificationBox</span>
<a href="#l49.68"></a><span id="l49.68" class="difflineplus">+  aController.waitFor(() =&gt; !box.getNotificationWithValue(aValue),</span>
<a href="#l49.69"></a><span id="l49.69">                       &quot;Timed out waiting for notification with value &quot; +</span>
<a href="#l49.70"></a><span id="l49.70">                       aValue + &quot; to stop.&quot;);</span>
<a href="#l49.71"></a><span id="l49.71"> }</span>
<a href="#l49.72"></a><span id="l49.72"> </span>
<a href="#l49.73"></a><span id="l49.73"> /**</span>
<a href="#l49.74"></a><span id="l49.74">  * A helper function that waits for a notification with value aValue</span>
<a href="#l49.75"></a><span id="l49.75">  * to show in the window.</span>
<a href="#l49.76"></a><span id="l49.76">  *</span>
<a href="#l49.77"></a><span id="l49.77" class="difflineat">@@ -110,17 +119,20 @@ function wait_for_notification_to_stop(a</span>
<a href="#l49.78"></a><span id="l49.78">  * @param aValue the value of the notification to wait for</span>
<a href="#l49.79"></a><span id="l49.79">  */</span>
<a href="#l49.80"></a><span id="l49.80"> function wait_for_notification_to_show(aController, aBoxId, aValue) {</span>
<a href="#l49.81"></a><span id="l49.81">   let nb = aController.window.document.getElementById(aBoxId);</span>
<a href="#l49.82"></a><span id="l49.82">   if (!nb)</span>
<a href="#l49.83"></a><span id="l49.83">     throw new Error(&quot;Couldn't find a notification box for id=&quot; + aBoxId);</span>
<a href="#l49.84"></a><span id="l49.84"> </span>
<a href="#l49.85"></a><span id="l49.85">   function nbReady() {</span>
<a href="#l49.86"></a><span id="l49.86" class="difflineminus">-    return (nb.getNotificationWithValue(aValue) != null) &amp;&amp; !nb._animating;</span>
<a href="#l49.87"></a><span id="l49.87" class="difflineplus">+    if (nb.querySelector(&quot;.notificationbox-stack&quot;)) {</span>
<a href="#l49.88"></a><span id="l49.88" class="difflineplus">+      let box = nb.querySelector(&quot;.notificationbox-stack&quot;)._notificationBox</span>
<a href="#l49.89"></a><span id="l49.89" class="difflineplus">+      return (box.getNotificationWithValue(aValue) != null) &amp;&amp; !box._animating;</span>
<a href="#l49.90"></a><span id="l49.90" class="difflineplus">+    }</span>
<a href="#l49.91"></a><span id="l49.91">   }</span>
<a href="#l49.92"></a><span id="l49.92">   aController.waitFor(nbReady,</span>
<a href="#l49.93"></a><span id="l49.93">                       &quot;Timed out waiting for notification with value &quot; +</span>
<a href="#l49.94"></a><span id="l49.94">                       aValue + &quot; to show.&quot;);</span>
<a href="#l49.95"></a><span id="l49.95"> }</span>
<a href="#l49.96"></a><span id="l49.96"> </span>
<a href="#l49.97"></a><span id="l49.97"> </span>
<a href="#l49.98"></a><span id="l49.98"> /**</span>
<a href="#l49.99"></a><span id="l49.99" class="difflineat">@@ -134,17 +146,18 @@ function wait_for_notification_to_show(a</span>
<a href="#l49.100"></a><span id="l49.100">  *                    An object with key:value pairs,</span>
<a href="#l49.101"></a><span id="l49.101">  *                    similar to click_menus_in_sequence().</span>
<a href="#l49.102"></a><span id="l49.102">  */</span>
<a href="#l49.103"></a><span id="l49.103"> function get_notification_button(aController, aBoxId, aValue, aMatch) {</span>
<a href="#l49.104"></a><span id="l49.104">   let nb = aController.window.document.getElementById(aBoxId);</span>
<a href="#l49.105"></a><span id="l49.105">   if (!nb)</span>
<a href="#l49.106"></a><span id="l49.106">     throw new Error(&quot;Couldn't find a notification box for id=&quot; + aBoxId);</span>
<a href="#l49.107"></a><span id="l49.107"> </span>
<a href="#l49.108"></a><span id="l49.108" class="difflineminus">-  let notification = nb.getNotificationWithValue(aValue);</span>
<a href="#l49.109"></a><span id="l49.109" class="difflineplus">+  let box = nb.querySelector(&quot;.notificationbox-stack&quot;)._notificationBox</span>
<a href="#l49.110"></a><span id="l49.110" class="difflineplus">+  let notification = box.getNotificationWithValue(aValue);</span>
<a href="#l49.111"></a><span id="l49.111">   let buttons = notification.querySelectorAll(&quot;button&quot;);</span>
<a href="#l49.112"></a><span id="l49.112">   for (let button of buttons) {</span>
<a href="#l49.113"></a><span id="l49.113">     let matchedAll = true;</span>
<a href="#l49.114"></a><span id="l49.114">     for (let name in aMatch) {</span>
<a href="#l49.115"></a><span id="l49.115">       let value = aMatch[name];</span>
<a href="#l49.116"></a><span id="l49.116">       let matched = false;</span>
<a href="#l49.117"></a><span id="l49.117">       if (name == &quot;popup&quot;) {</span>
<a href="#l49.118"></a><span id="l49.118">         if (button.getAttribute(&quot;type&quot;) == &quot;menu-button&quot; ||</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-window-helpers.js</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/test-window-helpers.js</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -814,17 +814,22 @@ function resize_to(aController, aWidth, </span>
<a href="#l50.4"></a><span id="l50.4">   mark_action(&quot;test&quot;, &quot;resize_to&quot;, [aWidth, &quot;x&quot;, aHeight]);</span>
<a href="#l50.5"></a><span id="l50.5">   aController.window.resizeTo(aWidth, aHeight);</span>
<a href="#l50.6"></a><span id="l50.6">   // Give the event loop a spin in order to let the reality of an asynchronously</span>
<a href="#l50.7"></a><span id="l50.7">   // interacting window manager have its impact. This still may not be</span>
<a href="#l50.8"></a><span id="l50.8">   // sufficient.</span>
<a href="#l50.9"></a><span id="l50.9">   aController.sleep(0);</span>
<a href="#l50.10"></a><span id="l50.10">   aController.waitFor(() =&gt; (aController.window.outerWidth == aWidth) &amp;&amp;</span>
<a href="#l50.11"></a><span id="l50.11">                             (aController.window.outerHeight == aHeight),</span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-                      &quot;Timeout waiting for resize (is the screen resolution at least 1280 x 1024?)&quot;,</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineplus">+                      &quot;Timeout waiting for resize (current screen size: &quot; +</span>
<a href="#l50.14"></a><span id="l50.14" class="difflineplus">+                      aController.window.screen.availWidth + &quot;X&quot; +</span>
<a href="#l50.15"></a><span id="l50.15" class="difflineplus">+                      aController.window.screen.availHeight +</span>
<a href="#l50.16"></a><span id="l50.16" class="difflineplus">+                      &quot;), Requested width &quot; + aWidth + &quot; but got &quot; +</span>
<a href="#l50.17"></a><span id="l50.17" class="difflineplus">+                      aController.window.outerWidth + &quot;, Request height &quot; +</span>
<a href="#l50.18"></a><span id="l50.18" class="difflineplus">+                      aHeight + &quot; but got &quot; + aController.window.outerHeight,</span>
<a href="#l50.19"></a><span id="l50.19">                       10000, 50);</span>
<a href="#l50.20"></a><span id="l50.20"> }</span>
<a href="#l50.21"></a><span id="l50.21"> </span>
<a href="#l50.22"></a><span id="l50.22"> /**</span>
<a href="#l50.23"></a><span id="l50.23">  * Methods to augment every controller that passes through augment_controller.</span>
<a href="#l50.24"></a><span id="l50.24">  */</span>
<a href="#l50.25"></a><span id="l50.25"> var AugmentEverybodyWith = {</span>
<a href="#l50.26"></a><span id="l50.26">   methods: {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1" class="difflineminus">--- a/mail/themes/osx/mail/messenger.css</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineplus">+++ b/mail/themes/osx/mail/messenger.css</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineat">@@ -612,17 +612,16 @@ treecol.treecol-image:hover:active {</span>
<a href="#l51.4"></a><span id="l51.4"> }</span>
<a href="#l51.5"></a><span id="l51.5"> </span>
<a href="#l51.6"></a><span id="l51.6"> #messengerWindow[sizemode=&quot;fullscreen&quot;] .titlebar-placeholder[type=&quot;fullscreen-button&quot;],</span>
<a href="#l51.7"></a><span id="l51.7"> #messengerWindow[sizemode=&quot;fullscreen&quot;] .titlebar-placeholder[type=&quot;caption-buttons&quot;] {</span>
<a href="#l51.8"></a><span id="l51.8">   display: none;</span>
<a href="#l51.9"></a><span id="l51.9"> }</span>
<a href="#l51.10"></a><span id="l51.10"> </span>
<a href="#l51.11"></a><span id="l51.11"> button[type=&quot;menu-button&quot;] {</span>
<a href="#l51.12"></a><span id="l51.12" class="difflineminus">-  border: none;</span>
<a href="#l51.13"></a><span id="l51.13">   margin: 0 6px;</span>
<a href="#l51.14"></a><span id="l51.14"> }</span>
<a href="#l51.15"></a><span id="l51.15"> </span>
<a href="#l51.16"></a><span id="l51.16"> button[type=&quot;menu-button&quot;] &gt; button {</span>
<a href="#l51.17"></a><span id="l51.17">   margin-top: -1px;</span>
<a href="#l51.18"></a><span id="l51.18">   margin-bottom: -3px;</span>
<a href="#l51.19"></a><span id="l51.19">   margin-inline-start: -7px;</span>
<a href="#l51.20"></a><span id="l51.20">   margin-inline-end: 0;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1" class="difflineminus">--- a/mail/themes/shared/jar.inc.mn</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineplus">+++ b/mail/themes/shared/jar.inc.mn</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineat">@@ -4,17 +4,16 @@</span>
<a href="#l52.4"></a><span id="l52.4"> </span>
<a href="#l52.5"></a><span id="l52.5"> # This is not a complete / proper jar manifest. It is included by the</span>
<a href="#l52.6"></a><span id="l52.6"> # actual theme-specific manifests, so that shared resources need only</span>
<a href="#l52.7"></a><span id="l52.7"> # be specified once. As a result, the source file paths are relative</span>
<a href="#l52.8"></a><span id="l52.8"> # to the location of the actual manifest.</span>
<a href="#l52.9"></a><span id="l52.9"> </span>
<a href="#l52.10"></a><span id="l52.10">   skin/classic/messenger/aboutNetError.css                    (../shared/mail/aboutNetError.css)</span>
<a href="#l52.11"></a><span id="l52.11">   skin/classic/messenger/aboutSupport.css                     (../shared/mail/aboutSupport.css)</span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">-  skin/classic/messenger/xbl-notification.css                 (../shared/mail/xbl-notification.css)</span>
<a href="#l52.13"></a><span id="l52.13">   skin/classic/messenger/addressbook/icons/menu.svg           (../shared/mail/icons/menu.svg)</span>
<a href="#l52.14"></a><span id="l52.14">   skin/classic/messenger/downloads/download.svg               (../shared/mail/icons/download.svg)</span>
<a href="#l52.15"></a><span id="l52.15">   skin/classic/messenger/extensionsOverlay.css                (../shared/mail/extensionsOverlay.css)</span>
<a href="#l52.16"></a><span id="l52.16">   skin/classic/messenger/icons/address.svg                    (../shared/mail/icons/address.svg)</span>
<a href="#l52.17"></a><span id="l52.17">   skin/classic/messenger/icons/addcontact.svg                 (../shared/mail/icons/addcontact.svg)</span>
<a href="#l52.18"></a><span id="l52.18">   skin/classic/messenger/icons/addlist.svg                    (../shared/mail/icons/addlist.svg)</span>
<a href="#l52.19"></a><span id="l52.19">   skin/classic/messenger/icons/accounts.svg                   (../shared/mail/icons/accounts.svg)</span>
<a href="#l52.20"></a><span id="l52.20">   skin/classic/messenger/icons/appbutton.svg                  (../shared/mail/icons/appbutton.svg)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/mail/themes/shared/mail/messengercompose.css</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/mail/themes/shared/mail/messengercompose.css</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -376,29 +376,25 @@</span>
<a href="#l53.4"></a><span id="l53.4"> .autocomplete-richlistitem[type=&quot;remote-abook&quot;] &gt; .ac-site-icon {</span>
<a href="#l53.5"></a><span id="l53.5">   list-style-image: url(&quot;chrome://messenger/skin/addressbook/icons/remote-addrbook.png&quot;);</span>
<a href="#l53.6"></a><span id="l53.6"> }</span>
<a href="#l53.7"></a><span id="l53.7"> </span>
<a href="#l53.8"></a><span id="l53.8"> .autocomplete-richlistitem[type=&quot;remote-err&quot;] &gt; .ac-site-icon {</span>
<a href="#l53.9"></a><span id="l53.9">   list-style-image: url(&quot;chrome://messenger/skin/addressbook/icons/remote-addrbook-error.png&quot;);</span>
<a href="#l53.10"></a><span id="l53.10"> }</span>
<a href="#l53.11"></a><span id="l53.11"> </span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-/* ::::: attachment reminder ::::: */</span>
<a href="#l53.13"></a><span id="l53.13" class="difflineminus">-</span>
<a href="#l53.14"></a><span id="l53.14" class="difflineminus">-#attachmentNotificationBox b {</span>
<a href="#l53.15"></a><span id="l53.15" class="difflineminus">-  font-weight: bold;</span>
<a href="#l53.16"></a><span id="l53.16" class="difflineminus">-}</span>
<a href="#l53.17"></a><span id="l53.17" class="difflineminus">-</span>
<a href="#l53.18"></a><span id="l53.18" class="difflineminus">-#attachmentNotificationBox &gt; xbl-notification[image=&quot;null&quot;] .messageImage {</span>
<a href="#l53.19"></a><span id="l53.19" class="difflineminus">-  background-image: url(&quot;chrome://messenger/skin/icons/attach.svg&quot;);</span>
<a href="#l53.20"></a><span id="l53.20" class="difflineminus">-}</span>
<a href="#l53.21"></a><span id="l53.21" class="difflineplus">+/* :::: attachment notification :::: */</span>
<a href="#l53.22"></a><span id="l53.22"> </span>
<a href="#l53.23"></a><span id="l53.23"> #attachmentReminderText {</span>
<a href="#l53.24"></a><span id="l53.24">   margin-inline-start: 0;</span>
<a href="#l53.25"></a><span id="l53.25">   cursor: pointer;</span>
<a href="#l53.26"></a><span id="l53.26"> }</span>
<a href="#l53.27"></a><span id="l53.27"> </span>
<a href="#l53.28"></a><span id="l53.28"> #attachmentKeywords {</span>
<a href="#l53.29"></a><span id="l53.29">   font-weight: bold;</span>
<a href="#l53.30"></a><span id="l53.30">   margin-inline-start: 0;</span>
<a href="#l53.31"></a><span id="l53.31">   text-decoration: underline;</span>
<a href="#l53.32"></a><span id="l53.32">   cursor: pointer;</span>
<a href="#l53.33"></a><span id="l53.33"> }</span>
<a href="#l53.34"></a><span id="l53.34" class="difflineplus">+</span>
<a href="#l53.35"></a><span id="l53.35" class="difflineplus">+#attachmentNotificationBox &gt; hbox &gt; .messageImage {</span>
<a href="#l53.36"></a><span id="l53.36" class="difflineplus">+  background-image: url(&quot;chrome://messenger/skin/icons/attach.svg&quot;);</span>
<a href="#l53.37"></a><span id="l53.37" class="difflineplus">+}</span>
<a href="#l53.38"></a><span id="l53.38">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1">deleted file mode 100644</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineminus">--- a/mail/themes/shared/mail/xbl-notification.css</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineplus">+++ /dev/null</span>
<a href="#l54.4"></a><span id="l54.4" class="difflineat">@@ -1,59 +0,0 @@</span>
<a href="#l54.5"></a><span id="l54.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l54.6"></a><span id="l54.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l54.7"></a><span id="l54.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l54.8"></a><span id="l54.8" class="difflineminus">-</span>
<a href="#l54.9"></a><span id="l54.9" class="difflineminus">-@namespace url(&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;);</span>
<a href="#l54.10"></a><span id="l54.10" class="difflineminus">-</span>
<a href="#l54.11"></a><span id="l54.11" class="difflineminus">-xbl-notification {</span>
<a href="#l54.12"></a><span id="l54.12" class="difflineminus">-  padding: 2px 0;</span>
<a href="#l54.13"></a><span id="l54.13" class="difflineminus">-  padding-inline-start: 12px;</span>
<a href="#l54.14"></a><span id="l54.14" class="difflineminus">-  background: -moz-dialog;</span>
<a href="#l54.15"></a><span id="l54.15" class="difflineminus">-  color: -moz-dialogText;</span>
<a href="#l54.16"></a><span id="l54.16" class="difflineminus">-  border-color: ThreeDLightShadow;</span>
<a href="#l54.17"></a><span id="l54.17" class="difflineminus">-  border-style: solid;</span>
<a href="#l54.18"></a><span id="l54.18" class="difflineminus">-  border-width: 1px 0;</span>
<a href="#l54.19"></a><span id="l54.19" class="difflineminus">-  text-shadow: none;</span>
<a href="#l54.20"></a><span id="l54.20" class="difflineminus">-}</span>
<a href="#l54.21"></a><span id="l54.21" class="difflineminus">-</span>
<a href="#l54.22"></a><span id="l54.22" class="difflineminus">-xbl-notification.animated {</span>
<a href="#l54.23"></a><span id="l54.23" class="difflineminus">-  transition: margin-top 300ms var(--animation-easing-function), opacity 300ms var(--animation-easing-function);</span>
<a href="#l54.24"></a><span id="l54.24" class="difflineminus">-}</span>
<a href="#l54.25"></a><span id="l54.25" class="difflineminus">-</span>
<a href="#l54.26"></a><span id="l54.26" class="difflineminus">-notificationbox[notificationside=&quot;top&quot;] xbl-notification {</span>
<a href="#l54.27"></a><span id="l54.27" class="difflineminus">-  border-top-style: none;</span>
<a href="#l54.28"></a><span id="l54.28" class="difflineminus">-}</span>
<a href="#l54.29"></a><span id="l54.29" class="difflineminus">-</span>
<a href="#l54.30"></a><span id="l54.30" class="difflineminus">-notificationbox[notificationside=&quot;bottom&quot;] xbl-notification {</span>
<a href="#l54.31"></a><span id="l54.31" class="difflineminus">-  border-bottom-style: none;</span>
<a href="#l54.32"></a><span id="l54.32" class="difflineminus">-}</span>
<a href="#l54.33"></a><span id="l54.33" class="difflineminus">-</span>
<a href="#l54.34"></a><span id="l54.34" class="difflineminus">-xbl-notification[type=&quot;warning&quot;],</span>
<a href="#l54.35"></a><span id="l54.35" class="difflineminus">-xbl-notification[type=&quot;critical&quot;] {</span>
<a href="#l54.36"></a><span id="l54.36" class="difflineminus">-  border-color: rgba(12, 12, 13, 0.2);</span>
<a href="#l54.37"></a><span id="l54.37" class="difflineminus">-}</span>
<a href="#l54.38"></a><span id="l54.38" class="difflineminus">-</span>
<a href="#l54.39"></a><span id="l54.39" class="difflineminus">-xbl-notification[type=&quot;warning&quot;] {</span>
<a href="#l54.40"></a><span id="l54.40" class="difflineminus">-  background: #ffc;</span>
<a href="#l54.41"></a><span id="l54.41" class="difflineminus">-  color: #0c0c0d;</span>
<a href="#l54.42"></a><span id="l54.42" class="difflineminus">-}</span>
<a href="#l54.43"></a><span id="l54.43" class="difflineminus">-</span>
<a href="#l54.44"></a><span id="l54.44" class="difflineminus">-xbl-notification[type=&quot;critical&quot;] {</span>
<a href="#l54.45"></a><span id="l54.45" class="difflineminus">-  background: #d70022;</span>
<a href="#l54.46"></a><span id="l54.46" class="difflineminus">-  color: #fff;</span>
<a href="#l54.47"></a><span id="l54.47" class="difflineminus">-}</span>
<a href="#l54.48"></a><span id="l54.48" class="difflineminus">-</span>
<a href="#l54.49"></a><span id="l54.49" class="difflineminus">-xbl-notification[type=&quot;info&quot;] &gt; hbox &gt; .messageImage {</span>
<a href="#l54.50"></a><span id="l54.50" class="difflineminus">-  list-style-image: url(&quot;chrome://global/skin/icons/help.svg&quot;);</span>
<a href="#l54.51"></a><span id="l54.51" class="difflineminus">-}</span>
<a href="#l54.52"></a><span id="l54.52" class="difflineminus">-</span>
<a href="#l54.53"></a><span id="l54.53" class="difflineminus">-xbl-notification[type=&quot;warning&quot;] &gt; hbox &gt; .messageImage {</span>
<a href="#l54.54"></a><span id="l54.54" class="difflineminus">-  list-style-image: url(&quot;chrome://global/skin/icons/warning.svg&quot;);</span>
<a href="#l54.55"></a><span id="l54.55" class="difflineminus">-}</span>
<a href="#l54.56"></a><span id="l54.56" class="difflineminus">-</span>
<a href="#l54.57"></a><span id="l54.57" class="difflineminus">-xbl-notification[type=&quot;critical&quot;] &gt; hbox &gt; .messageImage {</span>
<a href="#l54.58"></a><span id="l54.58" class="difflineminus">-  list-style-image: url(&quot;chrome://global/skin/icons/error.svg&quot;);</span>
<a href="#l54.59"></a><span id="l54.59" class="difflineminus">-}</span>
<a href="#l54.60"></a><span id="l54.60" class="difflineminus">-</span>
<a href="#l54.61"></a><span id="l54.61" class="difflineminus">-xbl-notification[value=&quot;draftMsgContent&quot;] &gt; hbox &gt; .messageImage {</span>
<a href="#l54.62"></a><span id="l54.62" class="difflineminus">-  list-style-image: url(&quot;chrome://messenger/skin/icons/newmsg.svg&quot;);</span>
<a href="#l54.63"></a><span id="l54.63" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1" class="difflineminus">--- a/mailnews/extensions/newsblog/content/newsblogOverlay.js</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineplus">+++ b/mailnews/extensions/newsblog/content/newsblogOverlay.js</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineat">@@ -254,19 +254,17 @@ var FeedMessageHandler = {</span>
<a href="#l55.4"></a><span id="l55.4">       }</span>
<a href="#l55.5"></a><span id="l55.5">     } else {</span>
<a href="#l55.6"></a><span id="l55.6">       let browser = getBrowser();</span>
<a href="#l55.7"></a><span id="l55.7">       if (browser &amp;&amp; browser.contentDocument &amp;&amp; browser.contentDocument.body) {</span>
<a href="#l55.8"></a><span id="l55.8">         browser.contentDocument.body.hidden = true;</span>
<a href="#l55.9"></a><span id="l55.9">       }</span>
<a href="#l55.10"></a><span id="l55.10">       // If in a non rss folder, hide possible remote content bar on a web</span>
<a href="#l55.11"></a><span id="l55.11">       // page load, as it doesn't apply.</span>
<a href="#l55.12"></a><span id="l55.12" class="difflineminus">-      if (&quot;msgNotificationBar&quot; in window) {</span>
<a href="#l55.13"></a><span id="l55.13" class="difflineminus">-        gMessageNotificationBar.clearMsgNotifications();</span>
<a href="#l55.14"></a><span id="l55.14" class="difflineminus">-      }</span>
<a href="#l55.15"></a><span id="l55.15" class="difflineplus">+      gMessageNotificationBar.clearMsgNotifications();</span>
<a href="#l55.16"></a><span id="l55.16"> </span>
<a href="#l55.17"></a><span id="l55.17">       this.loadWebPage(aMsgHdr, {messagepane: true});</span>
<a href="#l55.18"></a><span id="l55.18">       this.gToggle = false;</span>
<a href="#l55.19"></a><span id="l55.19">     }</span>
<a href="#l55.20"></a><span id="l55.20">   },</span>
<a href="#l55.21"></a><span id="l55.21"> };</span>
<a href="#l55.22"></a><span id="l55.22"> </span>
<a href="#l55.23"></a><span id="l55.23"> function openSubscriptionsDialog(aFolder) {</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:32Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

