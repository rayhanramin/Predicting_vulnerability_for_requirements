<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 7109:8c523bf1fb545dac544ed0def233a08e4a03ebca</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 8c523bf1fb545dac544ed0def233a08e4a03ebca" />
<meta property="og:url" content="/comm-central/rev/8c523bf1fb545dac544ed0def233a08e4a03ebca" />
<meta property="og:description" content="Fix bug 456208 - Disabling calendars autorefresh does not prevent cached calendar sync. r=nomisvai" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 8c523bf1fb545dac544ed0def233a08e4a03ebca 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/8c523bf1fb545dac544ed0def233a08e4a03ebca">shortlog</a> |
<a href="/comm-central/log/8c523bf1fb545dac544ed0def233a08e4a03ebca">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/8c523bf1fb545dac544ed0def233a08e4a03ebca">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/8c523bf1fb545dac544ed0def233a08e4a03ebca">files</a> |
changeset |
<a href="/comm-central/raw-rev/8c523bf1fb545dac544ed0def233a08e4a03ebca">raw</a>  | <a href="/comm-central/archive/8c523bf1fb545dac544ed0def233a08e4a03ebca.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
Fix <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=456208">bug 456208</a> - Disabling calendars autorefresh does not prevent cached calendar sync. r=nomisvai
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#80;&#104;&#105;&#108;&#105;&#112;&#112;&#32;&#75;&#101;&#119;&#105;&#115;&#99;&#104;&#32;&#60;&#109;&#111;&#122;&#105;&#108;&#108;&#97;&#64;&#107;&#101;&#119;&#105;&#115;&#46;&#99;&#104;&#62;</td></tr>
<tr><td></td><td class="date age">Wed, 09 Feb 2011 15:47:20 +0100</td></tr>

<tr>
 <td>changeset 7109</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/8c523bf1fb545dac544ed0def233a08e4a03ebca">8c523bf1fb545dac544ed0def233a08e4a03ebca</a></td>
</tr>



<tr>
<td>parent 7108</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/fff23d6310c906b68b8cffdafa25f77ddad388cd">fff23d6310c906b68b8cffdafa25f77ddad388cd</a>
</td>
</tr>

<tr>
<td>child 7111</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/5dfe22893e47b64072eac685e63fe52c10d53f77">5dfe22893e47b64072eac685e63fe52c10d53f77</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=8c523bf1fb545dac544ed0def233a08e4a03ebca">5445</a></td></tr>
<tr><td>push user</td><td>mozilla@kewis.ch</td></tr>
<tr><td>push date</td><td class="date age">Wed, 09 Feb 2011 14:47:49 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@8c523bf1fb54 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=8c523bf1fb545dac544ed0def233a08e4a03ebca">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=8c523bf1fb545dac544ed0def233a08e4a03ebca&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=8c523bf1fb545dac544ed0def233a08e4a03ebca&newProject=comm-central&newRevision=8c523bf1fb545dac544ed0def233a08e4a03ebca&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=8c523bf1fb545dac544ed0def233a08e4a03ebca&newProject=comm-central&newRevision=8c523bf1fb545dac544ed0def233a08e4a03ebca&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=8c523bf1fb545dac544ed0def233a08e4a03ebca&newProject=comm-central&newRevision=8c523bf1fb545dac544ed0def233a08e4a03ebca&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28nomisvai%29&revcount=50">nomisvai</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=456208">456208</a></td></tr>




</table></div>

<div class="page_body description">Fix <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=456208">bug 456208</a> - Disabling calendars autorefresh does not prevent cached calendar sync. r=nomisvai</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/dialogs/calendar-properties-dialog.js">calendar/base/content/dialogs/calendar-properties-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/dialogs/calendar-properties-dialog.js">file</a> |
<a href="/comm-central/annotate/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/dialogs/calendar-properties-dialog.js">annotate</a> |
<a href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/dialogs/calendar-properties-dialog.js">diff</a> |
<a href="/comm-central/comparison/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/dialogs/calendar-properties-dialog.js">comparison</a> |
<a href="/comm-central/log/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/dialogs/calendar-properties-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/dialogs/calendar-properties-dialog.xul">calendar/base/content/dialogs/calendar-properties-dialog.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/dialogs/calendar-properties-dialog.xul">file</a> |
<a href="/comm-central/annotate/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/dialogs/calendar-properties-dialog.xul">annotate</a> |
<a href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/dialogs/calendar-properties-dialog.xul">diff</a> |
<a href="/comm-central/comparison/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/dialogs/calendar-properties-dialog.xul">comparison</a> |
<a href="/comm-central/log/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/dialogs/calendar-properties-dialog.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/preferences/general.js">calendar/base/content/preferences/general.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/preferences/general.js">file</a> |
<a href="/comm-central/annotate/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/preferences/general.js">annotate</a> |
<a href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/preferences/general.js">diff</a> |
<a href="/comm-central/comparison/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/preferences/general.js">comparison</a> |
<a href="/comm-central/log/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/preferences/general.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/preferences/general.xul">calendar/base/content/preferences/general.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/preferences/general.xul">file</a> |
<a href="/comm-central/annotate/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/preferences/general.xul">annotate</a> |
<a href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/preferences/general.xul">diff</a> |
<a href="/comm-central/comparison/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/preferences/general.xul">comparison</a> |
<a href="/comm-central/log/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/content/preferences/general.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/src/calCachedCalendar.js">calendar/base/src/calCachedCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/src/calCachedCalendar.js">file</a> |
<a href="/comm-central/annotate/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/src/calCachedCalendar.js">annotate</a> |
<a href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/src/calCachedCalendar.js">diff</a> |
<a href="/comm-central/comparison/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/src/calCachedCalendar.js">comparison</a> |
<a href="/comm-central/log/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/src/calCachedCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/src/calCalendarManager.js">calendar/base/src/calCalendarManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/src/calCalendarManager.js">file</a> |
<a href="/comm-central/annotate/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/src/calCalendarManager.js">annotate</a> |
<a href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/src/calCalendarManager.js">diff</a> |
<a href="/comm-central/comparison/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/src/calCalendarManager.js">comparison</a> |
<a href="/comm-central/log/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/base/src/calCalendarManager.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/lightning/content/lightning.js">calendar/lightning/content/lightning.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/lightning/content/lightning.js">file</a> |
<a href="/comm-central/annotate/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/lightning/content/lightning.js">annotate</a> |
<a href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/lightning/content/lightning.js">diff</a> |
<a href="/comm-central/comparison/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/lightning/content/lightning.js">comparison</a> |
<a href="/comm-central/log/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/lightning/content/lightning.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/calendar.dtd">calendar/locales/en-US/chrome/calendar/calendar.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/calendar.dtd">file</a> |
<a href="/comm-central/annotate/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/calendar.dtd">annotate</a> |
<a href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/calendar.dtd">diff</a> |
<a href="/comm-central/comparison/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/calendar.dtd">comparison</a> |
<a href="/comm-central/log/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/calendar.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/calendar.properties">calendar/locales/en-US/chrome/calendar/calendar.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/calendar.properties">file</a> |
<a href="/comm-central/annotate/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/calendar.properties">annotate</a> |
<a href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/calendar.properties">diff</a> |
<a href="/comm-central/comparison/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/calendar.properties">comparison</a> |
<a href="/comm-central/log/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/calendar.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/preferences/general.dtd">calendar/locales/en-US/chrome/calendar/preferences/general.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/preferences/general.dtd">file</a> |
<a href="/comm-central/annotate/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/preferences/general.dtd">annotate</a> |
<a href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/preferences/general.dtd">diff</a> |
<a href="/comm-central/comparison/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/preferences/general.dtd">comparison</a> |
<a href="/comm-central/log/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/locales/en-US/chrome/calendar/preferences/general.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/providers/caldav/calDavCalendar.js">calendar/providers/caldav/calDavCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/providers/caldav/calDavCalendar.js">file</a> |
<a href="/comm-central/annotate/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/providers/caldav/calDavCalendar.js">annotate</a> |
<a href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/providers/caldav/calDavCalendar.js">diff</a> |
<a href="/comm-central/comparison/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/providers/caldav/calDavCalendar.js">comparison</a> |
<a href="/comm-central/log/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/providers/caldav/calDavCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/sunbird/app/profile/sunbird.js">calendar/sunbird/app/profile/sunbird.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/sunbird/app/profile/sunbird.js">file</a> |
<a href="/comm-central/annotate/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/sunbird/app/profile/sunbird.js">annotate</a> |
<a href="/comm-central/diff/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/sunbird/app/profile/sunbird.js">diff</a> |
<a href="/comm-central/comparison/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/sunbird/app/profile/sunbird.js">comparison</a> |
<a href="/comm-central/log/8c523bf1fb545dac544ed0def233a08e4a03ebca/calendar/sunbird/app/profile/sunbird.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-properties-dialog.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-properties-dialog.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -32,16 +32,17 @@</span>
<a href="#l1.4"></a><span id="l1.4">  * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l1.5"></a><span id="l1.5">  * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l1.6"></a><span id="l1.6">  * the provisions above, a recipient may use your version of this file under</span>
<a href="#l1.7"></a><span id="l1.7">  * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l1.8"></a><span id="l1.8">  *</span>
<a href="#l1.9"></a><span id="l1.9">  * ***** END LICENSE BLOCK ***** */</span>
<a href="#l1.10"></a><span id="l1.10"> </span>
<a href="#l1.11"></a><span id="l1.11"> Components.utils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+Components.utils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l1.13"></a><span id="l1.13"> </span>
<a href="#l1.14"></a><span id="l1.14"> /**</span>
<a href="#l1.15"></a><span id="l1.15">  * The calendar to modify, is retrieved from window.arguments[0].calendar</span>
<a href="#l1.16"></a><span id="l1.16">  */</span>
<a href="#l1.17"></a><span id="l1.17"> var gCalendar;</span>
<a href="#l1.18"></a><span id="l1.18"> </span>
<a href="#l1.19"></a><span id="l1.19"> /**</span>
<a href="#l1.20"></a><span id="l1.20">  * This function gets called when the calendar properties dialog gets opened. To</span>
<a href="#l1.21"></a><span id="l1.21" class="difflineat">@@ -54,18 +55,20 @@ function onLoad() {</span>
<a href="#l1.22"></a><span id="l1.22">     document.getElementById(&quot;calendar-name&quot;).value = gCalendar.name;</span>
<a href="#l1.23"></a><span id="l1.23">     var calColor = gCalendar.getProperty('color');</span>
<a href="#l1.24"></a><span id="l1.24">     if (calColor) {</span>
<a href="#l1.25"></a><span id="l1.25">        document.getElementById(&quot;calendar-color&quot;).color = calColor;</span>
<a href="#l1.26"></a><span id="l1.26">     }</span>
<a href="#l1.27"></a><span id="l1.27">     document.getElementById(&quot;calendar-uri&quot;).value = gCalendar.uri.spec;</span>
<a href="#l1.28"></a><span id="l1.28">     document.getElementById(&quot;read-only&quot;).checked = gCalendar.readOnly;</span>
<a href="#l1.29"></a><span id="l1.29"> </span>
<a href="#l1.30"></a><span id="l1.30" class="difflineplus">+    // Set up refresh interval</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineplus">+    initRefreshInterval();</span>
<a href="#l1.32"></a><span id="l1.32"> </span>
<a href="#l1.33"></a><span id="l1.33" class="difflineminus">-    // set up the cache field</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineplus">+    // Set up the cache field</span>
<a href="#l1.35"></a><span id="l1.35">     var cacheBox = document.getElementById(&quot;cache&quot;);</span>
<a href="#l1.36"></a><span id="l1.36">     var canCache = (gCalendar.getProperty(&quot;cache.supported&quot;) !== false);</span>
<a href="#l1.37"></a><span id="l1.37">     if (!canCache) {</span>
<a href="#l1.38"></a><span id="l1.38">         cacheBox.setAttribute(&quot;disable-capability&quot;, &quot;true&quot;);</span>
<a href="#l1.39"></a><span id="l1.39">         cacheBox.disabled = true;</span>
<a href="#l1.40"></a><span id="l1.40">     }</span>
<a href="#l1.41"></a><span id="l1.41">     cacheBox.checked = (canCache &amp;&amp; gCalendar.getProperty(&quot;cache.enabled&quot;));</span>
<a href="#l1.42"></a><span id="l1.42"> </span>
<a href="#l1.43"></a><span id="l1.43" class="difflineat">@@ -110,16 +113,22 @@ function onAcceptDialog() {</span>
<a href="#l1.44"></a><span id="l1.44">     gCalendar.setProperty(&quot;color&quot;, document.getElementById(&quot;calendar-color&quot;).color);</span>
<a href="#l1.45"></a><span id="l1.45"> </span>
<a href="#l1.46"></a><span id="l1.46">     // Save readonly state</span>
<a href="#l1.47"></a><span id="l1.47">     gCalendar.readOnly = document.getElementById(&quot;read-only&quot;).checked;</span>
<a href="#l1.48"></a><span id="l1.48"> </span>
<a href="#l1.49"></a><span id="l1.49">     // Save supressAlarms</span>
<a href="#l1.50"></a><span id="l1.50">     gCalendar.setProperty(&quot;suppressAlarms&quot;, !document.getElementById(&quot;fire-alarms&quot;).checked);</span>
<a href="#l1.51"></a><span id="l1.51"> </span>
<a href="#l1.52"></a><span id="l1.52" class="difflineplus">+    // Save refresh interval</span>
<a href="#l1.53"></a><span id="l1.53" class="difflineplus">+    if (gCalendar.canRefresh) {</span>
<a href="#l1.54"></a><span id="l1.54" class="difflineplus">+        let value = getElementValue(&quot;calendar-refreshInterval-menulist&quot;);</span>
<a href="#l1.55"></a><span id="l1.55" class="difflineplus">+        gCalendar.setProperty(&quot;refreshInterval&quot;, value);</span>
<a href="#l1.56"></a><span id="l1.56" class="difflineplus">+    }</span>
<a href="#l1.57"></a><span id="l1.57" class="difflineplus">+</span>
<a href="#l1.58"></a><span id="l1.58">     // Save cache options</span>
<a href="#l1.59"></a><span id="l1.59">     gCalendar.setProperty(&quot;cache.enabled&quot;, document.getElementById(&quot;cache&quot;).checked);</span>
<a href="#l1.60"></a><span id="l1.60"> </span>
<a href="#l1.61"></a><span id="l1.61">     if (!gCalendar.getProperty(&quot;force-disabled&quot;)) {</span>
<a href="#l1.62"></a><span id="l1.62">         // Save disabled option (should do this last), remove auto-enabled</span>
<a href="#l1.63"></a><span id="l1.63">         gCalendar.setProperty(&quot;disabled&quot;, !document.getElementById(&quot;calendar-enabled-checkbox&quot;).checked);</span>
<a href="#l1.64"></a><span id="l1.64">         gCalendar.deleteProperty(&quot;auto-enabled&quot;);</span>
<a href="#l1.65"></a><span id="l1.65">     }</span>
<a href="#l1.66"></a><span id="l1.66" class="difflineat">@@ -144,8 +153,53 @@ function setupEnabledCheckbox() {</span>
<a href="#l1.67"></a><span id="l1.67">  * shown unless the provider for the calendar is missing (i.e force-disabled)</span>
<a href="#l1.68"></a><span id="l1.68">  */</span>
<a href="#l1.69"></a><span id="l1.69"> function unsubscribeCalendar() {</span>
<a href="#l1.70"></a><span id="l1.70">     let calmgr =  cal.getCalendarManager();</span>
<a href="#l1.71"></a><span id="l1.71"> </span>
<a href="#l1.72"></a><span id="l1.72">     calmgr.unregisterCalendar(gCalendar);</span>
<a href="#l1.73"></a><span id="l1.73">     window.close();</span>
<a href="#l1.74"></a><span id="l1.74"> }</span>
<a href="#l1.75"></a><span id="l1.75" class="difflineplus">+</span>
<a href="#l1.76"></a><span id="l1.76" class="difflineplus">+function initRefreshInterval() {</span>
<a href="#l1.77"></a><span id="l1.77" class="difflineplus">+    setBooleanAttribute(&quot;calendar-refreshInterval-row&quot;, &quot;hidden&quot;, !gCalendar.canRefresh);</span>
<a href="#l1.78"></a><span id="l1.78" class="difflineplus">+</span>
<a href="#l1.79"></a><span id="l1.79" class="difflineplus">+    if (gCalendar.canRefresh) {</span>
<a href="#l1.80"></a><span id="l1.80" class="difflineplus">+        function createMenuItem(minutes) {</span>
<a href="#l1.81"></a><span id="l1.81" class="difflineplus">+            let menuitem = createXULElement(&quot;menuitem&quot;);</span>
<a href="#l1.82"></a><span id="l1.82" class="difflineplus">+            menuitem.setAttribute(&quot;value&quot;, minutes);</span>
<a href="#l1.83"></a><span id="l1.83" class="difflineplus">+</span>
<a href="#l1.84"></a><span id="l1.84" class="difflineplus">+            let everyMinuteString = cal.calGetString(&quot;calendar&quot;, &quot;calendarPropertiesEveryMinute&quot;);</span>
<a href="#l1.85"></a><span id="l1.85" class="difflineplus">+            let label = PluralForm.get(minutes, everyMinuteString).replace(&quot;#1&quot;, minutes);</span>
<a href="#l1.86"></a><span id="l1.86" class="difflineplus">+            menuitem.setAttribute(&quot;label&quot;, label);</span>
<a href="#l1.87"></a><span id="l1.87" class="difflineplus">+</span>
<a href="#l1.88"></a><span id="l1.88" class="difflineplus">+            return menuitem;</span>
<a href="#l1.89"></a><span id="l1.89" class="difflineplus">+        }</span>
<a href="#l1.90"></a><span id="l1.90" class="difflineplus">+</span>
<a href="#l1.91"></a><span id="l1.91" class="difflineplus">+        let refreshInterval = gCalendar.getProperty(&quot;refreshInterval&quot;);</span>
<a href="#l1.92"></a><span id="l1.92" class="difflineplus">+        if (refreshInterval === null) refreshInterval = 30;</span>
<a href="#l1.93"></a><span id="l1.93" class="difflineplus">+</span>
<a href="#l1.94"></a><span id="l1.94" class="difflineplus">+        let foundValue = false;</span>
<a href="#l1.95"></a><span id="l1.95" class="difflineplus">+        let separator = document.getElementById(&quot;calendar-refreshInterval-manual-separator&quot;);</span>
<a href="#l1.96"></a><span id="l1.96" class="difflineplus">+        let menulist = document.getElementById(&quot;calendar-refreshInterval-menulist&quot;);</span>
<a href="#l1.97"></a><span id="l1.97" class="difflineplus">+        for each (let min in [1, 5, 15, 30, 60]) {</span>
<a href="#l1.98"></a><span id="l1.98" class="difflineplus">+            let menuitem = createMenuItem(min);</span>
<a href="#l1.99"></a><span id="l1.99" class="difflineplus">+</span>
<a href="#l1.100"></a><span id="l1.100" class="difflineplus">+            separator.parentNode.insertBefore(menuitem, separator);</span>
<a href="#l1.101"></a><span id="l1.101" class="difflineplus">+            if (refreshInterval == min) {</span>
<a href="#l1.102"></a><span id="l1.102" class="difflineplus">+                menulist.selectedItem = menuitem;</span>
<a href="#l1.103"></a><span id="l1.103" class="difflineplus">+                foundValue = true;</span>
<a href="#l1.104"></a><span id="l1.104" class="difflineplus">+            }</span>
<a href="#l1.105"></a><span id="l1.105" class="difflineplus">+        }</span>
<a href="#l1.106"></a><span id="l1.106" class="difflineplus">+</span>
<a href="#l1.107"></a><span id="l1.107" class="difflineplus">+        if (refreshInterval == 0) {</span>
<a href="#l1.108"></a><span id="l1.108" class="difflineplus">+            setBooleanAttribute(&quot;calendar-refreshInterval-manual&quot;, &quot;checked&quot;, true);</span>
<a href="#l1.109"></a><span id="l1.109" class="difflineplus">+            foundValue = true;</span>
<a href="#l1.110"></a><span id="l1.110" class="difflineplus">+        }</span>
<a href="#l1.111"></a><span id="l1.111" class="difflineplus">+</span>
<a href="#l1.112"></a><span id="l1.112" class="difflineplus">+        if (!foundValue) {</span>
<a href="#l1.113"></a><span id="l1.113" class="difflineplus">+          // Special menuitem in case the user changed the value in the config editor.</span>
<a href="#l1.114"></a><span id="l1.114" class="difflineplus">+          let menuitem = createMenuItem(refreshInterval);</span>
<a href="#l1.115"></a><span id="l1.115" class="difflineplus">+          separator.parentNode.insertBefore(menuitem, separator.nextSibling);</span>
<a href="#l1.116"></a><span id="l1.116" class="difflineplus">+          menulist.selectedItem = menuitem;</span>
<a href="#l1.117"></a><span id="l1.117" class="difflineplus">+        }</span>
<a href="#l1.118"></a><span id="l1.118" class="difflineplus">+    }</span>
<a href="#l1.119"></a><span id="l1.119" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-properties-dialog.xul</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-properties-dialog.xul</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -100,16 +100,32 @@</span>
<a href="#l2.4"></a><span id="l2.4">       &lt;/row&gt;</span>
<a href="#l2.5"></a><span id="l2.5">       &lt;row id=&quot;calendar-uri-row&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.6"></a><span id="l2.6">         &lt;label value=&quot;&amp;calendarproperties.location.label;&quot;</span>
<a href="#l2.7"></a><span id="l2.7">                disable-with-calendar=&quot;true&quot;</span>
<a href="#l2.8"></a><span id="l2.8">                control=&quot;calendar-uri&quot;/&gt;</span>
<a href="#l2.9"></a><span id="l2.9">         &lt;!-- XXX Make location field readonly until Bug 315307 is fixed --&gt;</span>
<a href="#l2.10"></a><span id="l2.10">         &lt;textbox id=&quot;calendar-uri&quot; readonly=&quot;true&quot; disable-with-calendar=&quot;true&quot;/&gt;</span>
<a href="#l2.11"></a><span id="l2.11">       &lt;/row&gt;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+      &lt;row id=&quot;calendar-refreshInterval-row&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+        &lt;label value=&quot;&amp;calendarproperties.refreshInterval.label;&quot;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+               disable-with-calendar=&quot;true&quot;</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+               control=&quot;calendar-refreshInterval-textbox&quot;/&gt;</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+        &lt;menulist id=&quot;calendar-refreshInterval-menulist&quot;</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+                  disable-with-calendar=&quot;true&quot;</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineplus">+                  label=&quot;&amp;calendarproperties.refreshInterval.label;&quot;&gt;</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+          &lt;menupopup id=&quot;calendar-refreshInterval-menupopup&quot;&gt;</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineplus">+            &lt;!-- This will be filled programatically to reduce the number of needed strings --&gt;</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineplus">+            &lt;menuseparator id=&quot;calendar-refreshInterval-manual-separator&quot;/&gt;</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineplus">+            &lt;menuitem id=&quot;calendar-refreshInterval-manual&quot;</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineplus">+                      value=&quot;0&quot;</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineplus">+                      label=&quot;&amp;calendarproperties.refreshInterval.manual.label;&quot;/&gt;</span>
<a href="#l2.25"></a><span id="l2.25" class="difflineplus">+          &lt;/menupopup&gt;</span>
<a href="#l2.26"></a><span id="l2.26" class="difflineplus">+        &lt;/menulist&gt;</span>
<a href="#l2.27"></a><span id="l2.27" class="difflineplus">+      &lt;/row&gt;</span>
<a href="#l2.28"></a><span id="l2.28">       &lt;row id=&quot;calendar-readOnly-row&quot;</span>
<a href="#l2.29"></a><span id="l2.29">            align=&quot;center&quot;&gt;</span>
<a href="#l2.30"></a><span id="l2.30">         &lt;spacer/&gt;</span>
<a href="#l2.31"></a><span id="l2.31">         &lt;checkbox id=&quot;read-only&quot;</span>
<a href="#l2.32"></a><span id="l2.32">                   label=&quot;&amp;calendarproperties.readonly.label;&quot;</span>
<a href="#l2.33"></a><span id="l2.33">                   disable-with-calendar=&quot;true&quot;/&gt;</span>
<a href="#l2.34"></a><span id="l2.34">       &lt;/row&gt;</span>
<a href="#l2.35"></a><span id="l2.35">       &lt;row id=&quot;calendar-suppressAlarms-row&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/preferences/general.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/preferences/general.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -56,21 +56,10 @@ var gCalendarGeneralPane = {</span>
<a href="#l3.4"></a><span id="l3.4">         // menu items include examples of current date formats.</span>
<a href="#l3.5"></a><span id="l3.5">         document.getElementById(&quot;dateformat-long-menuitem&quot;)</span>
<a href="#l3.6"></a><span id="l3.6">                 .setAttribute(&quot;label&quot;, labelLong + &quot;: &quot; + dateFormattedLong);</span>
<a href="#l3.7"></a><span id="l3.7">         document.getElementById(&quot;dateformat-short-menuitem&quot;)</span>
<a href="#l3.8"></a><span id="l3.8">                 .setAttribute(&quot;label&quot;, labelShort + &quot;: &quot; + dateFormattedShort);</span>
<a href="#l3.9"></a><span id="l3.9"> </span>
<a href="#l3.10"></a><span id="l3.10">         // deselect and reselect to update visible item title</span>
<a href="#l3.11"></a><span id="l3.11">         updateSelectedLabel(&quot;dateformat&quot;);</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-    },</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineminus">-    /**</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineminus">-     * Update disabled state of the controls that depend on the</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineminus">-     * calendar.autorefresh.enabled preference.</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineminus">-     */</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineminus">-    autoRefreshPrefChanged: function gCGP_autoRefreshPrefChanged() {</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineminus">-        var autoRefreshPref =</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineminus">-            document.getElementById(&quot;calendar.autorefresh.enabled&quot;).value;</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineminus">-        document.getElementById(&quot;calendar.autorefresh.timeout&quot;).disabled = </span>
<a href="#l3.22"></a><span id="l3.22" class="difflineminus">-            !autoRefreshPref;</span>
<a href="#l3.23"></a><span id="l3.23">     }</span>
<a href="#l3.24"></a><span id="l3.24"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/preferences/general.xul</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/preferences/general.xul</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -65,23 +65,16 @@</span>
<a href="#l4.4"></a><span id="l4.4">                         name=&quot;calendar.date.format&quot;</span>
<a href="#l4.5"></a><span id="l4.5">                         type=&quot;int&quot;/&gt;</span>
<a href="#l4.6"></a><span id="l4.6">             &lt;preference id=&quot;calendar.event.defaultlength&quot;</span>
<a href="#l4.7"></a><span id="l4.7">                         name=&quot;calendar.event.defaultlength&quot;</span>
<a href="#l4.8"></a><span id="l4.8">                         type=&quot;int&quot;/&gt;</span>
<a href="#l4.9"></a><span id="l4.9">             &lt;preference id=&quot;calendar.alarms.defaultsnoozelength&quot;</span>
<a href="#l4.10"></a><span id="l4.10">                         name=&quot;calendar.alarms.defaultsnoozelength&quot;</span>
<a href="#l4.11"></a><span id="l4.11">                         type=&quot;int&quot;/&gt;</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-            &lt;preference id=&quot;calendar.autorefresh.enabled&quot;</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-                        name=&quot;calendar.autorefresh.enabled&quot;</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-                        type=&quot;bool&quot;</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">-                        onchange=&quot;gCalendarGeneralPane.autoRefreshPrefChanged();&quot;/&gt;</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineminus">-            &lt;preference id=&quot;calendar.autorefresh.timeout&quot;</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineminus">-                        name=&quot;calendar.autorefresh.timeout&quot;</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineminus">-                        type=&quot;int&quot;/&gt;</span>
<a href="#l4.19"></a><span id="l4.19">         &lt;/preferences&gt;</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21">         &lt;groupbox&gt;</span>
<a href="#l4.22"></a><span id="l4.22">             &lt;caption label=&quot;&amp;pref.mainbox.label;&quot;/&gt;</span>
<a href="#l4.23"></a><span id="l4.23">             &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l4.24"></a><span id="l4.24">                 &lt;label value=&quot;&amp;pref.dateformat.label;&quot;</span>
<a href="#l4.25"></a><span id="l4.25">                        accesskey=&quot;&amp;pref.dateformat.accesskey;&quot;</span>
<a href="#l4.26"></a><span id="l4.26">                        control=&quot;dateformat&quot;/&gt;</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineat">@@ -120,28 +113,10 @@</span>
<a href="#l4.28"></a><span id="l4.28">                          type=&quot;number&quot;</span>
<a href="#l4.29"></a><span id="l4.29">                          min=&quot;0&quot;</span>
<a href="#l4.30"></a><span id="l4.30">                          maxlength=&quot;3&quot;</span>
<a href="#l4.31"></a><span id="l4.31">                          size=&quot;3&quot;/&gt;</span>
<a href="#l4.32"></a><span id="l4.32">                 &lt;label value=&quot;&amp;calendar.global.units.minutes;&quot;/&gt;</span>
<a href="#l4.33"></a><span id="l4.33">             &lt;/hbox&gt;</span>
<a href="#l4.34"></a><span id="l4.34"> </span>
<a href="#l4.35"></a><span id="l4.35">         &lt;/groupbox&gt;</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineminus">-</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineminus">-        &lt;groupbox&gt;</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineminus">-            &lt;caption label=&quot;&amp;pref.refreshbox.label;&quot;/&gt;</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineminus">-            &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineminus">-                &lt;checkbox id=&quot;autorefreshenabled&quot;</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineminus">-                          label=&quot;&amp;pref.autorefresh.label;&quot;</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineminus">-                          preference=&quot;calendar.autorefresh.enabled&quot;</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineminus">-                          accesskey=&quot;&amp;pref.autorefresh.accesskey;&quot;/&gt;</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineminus">-                &lt;textbox id=&quot;refreshtimeout&quot;</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineminus">-                         preference=&quot;calendar.autorefresh.timeout&quot;</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineminus">-                         type=&quot;number&quot;</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineminus">-                         min=&quot;1&quot;</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineminus">-                         max=&quot;0x7FFFF&quot;</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineminus">-                         size=&quot;3&quot;/&gt;</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineminus">-                &lt;label value=&quot;&amp;calendar.global.units.minutes;&quot;/&gt;</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineminus">-            &lt;/hbox&gt;</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineminus">-        &lt;/groupbox&gt;</span>
<a href="#l4.53"></a><span id="l4.53" class="difflineminus">-</span>
<a href="#l4.54"></a><span id="l4.54">     &lt;/vbox&gt;</span>
<a href="#l4.55"></a><span id="l4.55"> &lt;/overlay&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/src/calCachedCalendar.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/src/calCachedCalendar.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -106,37 +106,16 @@ calCachedCalendarObserverHelper.prototyp</span>
<a href="#l5.4"></a><span id="l5.4"> function calCachedCalendar(uncachedCalendar) {</span>
<a href="#l5.5"></a><span id="l5.5">     this.wrappedJSObject = this;</span>
<a href="#l5.6"></a><span id="l5.6">     this.mSyncQueue = [];</span>
<a href="#l5.7"></a><span id="l5.7">     this.mObservers = new cal.ObserverBag(Components.interfaces.calIObserver);</span>
<a href="#l5.8"></a><span id="l5.8">     uncachedCalendar.superCalendar = this;</span>
<a href="#l5.9"></a><span id="l5.9">     uncachedCalendar.addObserver(new calCachedCalendarObserverHelper(this, false));</span>
<a href="#l5.10"></a><span id="l5.10">     this.mUncachedCalendar = uncachedCalendar;</span>
<a href="#l5.11"></a><span id="l5.11">     this.setupCachedCalendar();</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-    if (this.supportsChangeLog) {</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineminus">-        var updateTimer = this.getProperty(&quot;cache.updateTimer&quot;);</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineminus">-        if (updateTimer === null) {</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineminus">-            updateTimer = 4; // override for changelog based providers</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineminus">-        }</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineminus">-        var timerCallback = {</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineminus">-            mCalendar: this,</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineminus">-            notify: function(timer) {</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineminus">-                LOG(&quot;[calCachedCalendar] replay timer&quot;);</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineminus">-                if (!this.mCalendar.getProperty(&quot;disabled&quot;)) {</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineminus">-                    this.mCalendar.refresh();</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineminus">-                }</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineminus">-            }</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineminus">-        };</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineminus">-        this.mReplayTimer = Components.classes[&quot;@mozilla.org/timer;1&quot;]</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineminus">-                                      .createInstance(Components.interfaces.nsITimer);</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineminus">-        this.mReplayTimer.initWithCallback(timerCallback,</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineminus">-                                           updateTimer * 60 * 1000,</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineminus">-                                           Components.interfaces.nsITimer.TYPE_REPEATING_SLACK);</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineminus">-    }</span>
<a href="#l5.33"></a><span id="l5.33"> }</span>
<a href="#l5.34"></a><span id="l5.34"> calCachedCalendar.prototype = {</span>
<a href="#l5.35"></a><span id="l5.35">     QueryInterface: function cCC_QueryInterface(aIID) {</span>
<a href="#l5.36"></a><span id="l5.36">         if (aIID.equals(Components.interfaces.calISchedulingSupport)) {</span>
<a href="#l5.37"></a><span id="l5.37">             // check whether uncached calendar supports it:</span>
<a href="#l5.38"></a><span id="l5.38">             if (this.mUncachedCalendar.QueryInterface(aIID)) {</span>
<a href="#l5.39"></a><span id="l5.39">                 return this;</span>
<a href="#l5.40"></a><span id="l5.40">             }</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineat">@@ -146,23 +125,18 @@ calCachedCalendar.prototype = {</span>
<a href="#l5.42"></a><span id="l5.42">                                  Components.interfaces.nsISupports]);</span>
<a href="#l5.43"></a><span id="l5.43">     },</span>
<a href="#l5.44"></a><span id="l5.44"> </span>
<a href="#l5.45"></a><span id="l5.45">     mCachedCalendar: null,</span>
<a href="#l5.46"></a><span id="l5.46">     mCachedObserver: null,</span>
<a href="#l5.47"></a><span id="l5.47">     mUncachedCalendar: null,</span>
<a href="#l5.48"></a><span id="l5.48">     mObservers: null,</span>
<a href="#l5.49"></a><span id="l5.49">     mSuperCalendar: null,</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineminus">-    mReplayTimer: null,</span>
<a href="#l5.51"></a><span id="l5.51"> </span>
<a href="#l5.52"></a><span id="l5.52">     onCalendarUnregistering: function() {</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineminus">-        if (this.mReplayTimer) {</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineminus">-            this.mReplayTimer.cancel();</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineminus">-            this.mReplayTimer = null;</span>
<a href="#l5.56"></a><span id="l5.56" class="difflineminus">-        }</span>
<a href="#l5.57"></a><span id="l5.57">         if (this.mCachedCalendar) {</span>
<a href="#l5.58"></a><span id="l5.58">             this.mCachedCalendar.removeObserver(this.mCachedObserver);</span>
<a href="#l5.59"></a><span id="l5.59">             // Although this doesn't really follow the spec, we know the</span>
<a href="#l5.60"></a><span id="l5.60">             // storage calendar's deleteCalendar method is synchronous.</span>
<a href="#l5.61"></a><span id="l5.61">             // TODO put changes into a different calendar and delete</span>
<a href="#l5.62"></a><span id="l5.62">             // afterwards.</span>
<a href="#l5.63"></a><span id="l5.63">             this.mCachedCalendar.QueryInterface(Components.interfaces.calICalendarProvider)</span>
<a href="#l5.64"></a><span id="l5.64">                                 .deleteCalendar(this.mCachedCalendar, null);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/src/calCalendarManager.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/src/calCalendarManager.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -66,16 +66,31 @@ function createStatement(dbconn, sql) {</span>
<a href="#l6.4"></a><span id="l6.4">  * won't show up. Writing the prefs helps counteract.</span>
<a href="#l6.5"></a><span id="l6.5">  */</span>
<a href="#l6.6"></a><span id="l6.6"> function flushPrefs() {</span>
<a href="#l6.7"></a><span id="l6.7">     Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l6.8"></a><span id="l6.8">               .getService(Components.interfaces.nsIPrefService)</span>
<a href="#l6.9"></a><span id="l6.9">               .savePrefFile(null);</span>
<a href="#l6.10"></a><span id="l6.10"> }</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+/**</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+ * Callback object for the refresh timer. Should be called as an object, i.e</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+ * let foo = new timerCallback(calendar);</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+ *</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+ * @param aCalendar     The calendar to refresh on notification</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+ */</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineplus">+function timerCallback(aCalendar) {</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineplus">+    this.notify = function refreshNotify(aTimer) {</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineplus">+        if (!aCalendar.getProperty(&quot;disabled&quot;) &amp;&amp; aCalendar.canRefresh) {</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineplus">+            aCalendar.refresh();</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineplus">+        }</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineplus">+    }</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineplus">+}</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineplus">+</span>
<a href="#l6.27"></a><span id="l6.27"> var gCalendarManagerAddonListener = {</span>
<a href="#l6.28"></a><span id="l6.28">     onDisabling: function(aAddon, aNeedsRestart) {</span>
<a href="#l6.29"></a><span id="l6.29">         if (!this.queryUninstallProvider(aAddon)) {</span>
<a href="#l6.30"></a><span id="l6.30">             // If the addon should not be disabled, then re-enable it.</span>
<a href="#l6.31"></a><span id="l6.31">             aAddon.userDisabled = false;</span>
<a href="#l6.32"></a><span id="l6.32">         }</span>
<a href="#l6.33"></a><span id="l6.33">     },</span>
<a href="#l6.34"></a><span id="l6.34"> </span>
<a href="#l6.35"></a><span id="l6.35" class="difflineat">@@ -161,71 +176,42 @@ calCalendarManager.prototype = {</span>
<a href="#l6.36"></a><span id="l6.36">         return this.mCalendarCount;</span>
<a href="#l6.37"></a><span id="l6.37">     },</span>
<a href="#l6.38"></a><span id="l6.38"> </span>
<a href="#l6.39"></a><span id="l6.39">     startup: function ccm_startup(aCompleteListener) {</span>
<a href="#l6.40"></a><span id="l6.40">         AddonManager.addAddonListener(gCalendarManagerAddonListener);</span>
<a href="#l6.41"></a><span id="l6.41">         this.checkAndMigrateDB();</span>
<a href="#l6.42"></a><span id="l6.42">         this.mCache = null;</span>
<a href="#l6.43"></a><span id="l6.43">         this.mCalObservers = null;</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineminus">-        this.mRefreshTimer = null;</span>
<a href="#l6.45"></a><span id="l6.45" class="difflineminus">-        this.setUpPrefObservers();</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineminus">-        this.setUpRefreshTimer();</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineplus">+        this.mRefreshTimer = {};</span>
<a href="#l6.48"></a><span id="l6.48">         this.setupOfflineObservers();</span>
<a href="#l6.49"></a><span id="l6.49">         if (cal.isSunbird()) {</span>
<a href="#l6.50"></a><span id="l6.50">             this.loginMasterPassword();</span>
<a href="#l6.51"></a><span id="l6.51">         }</span>
<a href="#l6.52"></a><span id="l6.52">         this.mNetworkCalendarCount = 0;</span>
<a href="#l6.53"></a><span id="l6.53">         this.mReadonlyCalendarCount = 0;</span>
<a href="#l6.54"></a><span id="l6.54">         this.mCalendarCount = 0;</span>
<a href="#l6.55"></a><span id="l6.55"> </span>
<a href="#l6.56"></a><span id="l6.56">         aCompleteListener.onResult(null, Components.results.NS_OK);</span>
<a href="#l6.57"></a><span id="l6.57">     },</span>
<a href="#l6.58"></a><span id="l6.58"> </span>
<a href="#l6.59"></a><span id="l6.59">     shutdown: function ccm_shutdown(aCompleteListener) {</span>
<a href="#l6.60"></a><span id="l6.60">         for each (var cal in this.mCache) {</span>
<a href="#l6.61"></a><span id="l6.61">             cal.removeObserver(this.mCalObservers[cal.id]);</span>
<a href="#l6.62"></a><span id="l6.62">         }</span>
<a href="#l6.63"></a><span id="l6.63"> </span>
<a href="#l6.64"></a><span id="l6.64" class="difflineminus">-        this.cleanupPrefObservers();</span>
<a href="#l6.65"></a><span id="l6.65">         this.cleanupOfflineObservers();</span>
<a href="#l6.66"></a><span id="l6.66"> </span>
<a href="#l6.67"></a><span id="l6.67">         Services.obs.removeObserver(this, &quot;profile-after-change&quot;);</span>
<a href="#l6.68"></a><span id="l6.68">         Services.obs.removeObserver(this, &quot;profile-before-change&quot;);</span>
<a href="#l6.69"></a><span id="l6.69">         AddonManager.removeAddonListener(gCalendarManagerAddonListener);</span>
<a href="#l6.70"></a><span id="l6.70"> </span>
<a href="#l6.71"></a><span id="l6.71">         aCompleteListener.onResult(null, Components.results.NS_OK);</span>
<a href="#l6.72"></a><span id="l6.72">     },</span>
<a href="#l6.73"></a><span id="l6.73"> </span>
<a href="#l6.74"></a><span id="l6.74" class="difflineminus">-    setUpPrefObservers: function ccm_setUpPrefObservers() {</span>
<a href="#l6.75"></a><span id="l6.75" class="difflineminus">-        Services.prefs.addObserver(&quot;calendar.autorefresh.enabled&quot;, this, false);</span>
<a href="#l6.76"></a><span id="l6.76" class="difflineminus">-        Services.prefs.addObserver(&quot;calendar.autorefresh.timeout&quot;, this, false);</span>
<a href="#l6.77"></a><span id="l6.77" class="difflineminus">-    },</span>
<a href="#l6.78"></a><span id="l6.78" class="difflineminus">-</span>
<a href="#l6.79"></a><span id="l6.79" class="difflineminus">-    cleanupPrefObservers: function ccm_cleanupPrefObservers() {</span>
<a href="#l6.80"></a><span id="l6.80" class="difflineminus">-        Services.prefs.removeObserver(&quot;calendar.autorefresh.enabled&quot;, this);</span>
<a href="#l6.81"></a><span id="l6.81" class="difflineminus">-        Services.prefs.removeObserver(&quot;calendar.autorefresh.timeout&quot;, this);</span>
<a href="#l6.82"></a><span id="l6.82" class="difflineminus">-    },</span>
<a href="#l6.83"></a><span id="l6.83" class="difflineminus">-</span>
<a href="#l6.84"></a><span id="l6.84" class="difflineminus">-    setUpRefreshTimer: function ccm_setUpRefreshTimer() {</span>
<a href="#l6.85"></a><span id="l6.85" class="difflineminus">-        if (this.mRefreshTimer) {</span>
<a href="#l6.86"></a><span id="l6.86" class="difflineminus">-            this.mRefreshTimer.cancel();</span>
<a href="#l6.87"></a><span id="l6.87" class="difflineminus">-        }</span>
<a href="#l6.88"></a><span id="l6.88" class="difflineminus">-</span>
<a href="#l6.89"></a><span id="l6.89" class="difflineminus">-        // Read and convert the minute-based pref to msecs</span>
<a href="#l6.90"></a><span id="l6.90" class="difflineminus">-        let refreshEnabled = cal.getPrefSafe(&quot;calendar.autorefresh.enabled&quot;, false);</span>
<a href="#l6.91"></a><span id="l6.91" class="difflineminus">-        let refreshTimeout = cal.getPrefSafe(&quot;calendar.autorefresh.timeout&quot;, 0) * 60000;</span>
<a href="#l6.92"></a><span id="l6.92" class="difflineminus">-</span>
<a href="#l6.93"></a><span id="l6.93" class="difflineminus">-        if (refreshEnabled &amp;&amp; refreshTimeout &gt; 0) {</span>
<a href="#l6.94"></a><span id="l6.94" class="difflineminus">-            this.mRefreshTimer = Components.classes[&quot;@mozilla.org/timer;1&quot;]</span>
<a href="#l6.95"></a><span id="l6.95" class="difflineminus">-                                    .createInstance(Components.interfaces.nsITimer);</span>
<a href="#l6.96"></a><span id="l6.96" class="difflineminus">-            this.mRefreshTimer.init(this, refreshTimeout,</span>
<a href="#l6.97"></a><span id="l6.97" class="difflineminus">-                                   Components.interfaces.nsITimer.TYPE_REPEATING_SLACK);</span>
<a href="#l6.98"></a><span id="l6.98" class="difflineminus">-        }</span>
<a href="#l6.99"></a><span id="l6.99" class="difflineminus">-    },</span>
<a href="#l6.100"></a><span id="l6.100"> </span>
<a href="#l6.101"></a><span id="l6.101">     setupOfflineObservers: function ccm_setupOfflineObservers() {</span>
<a href="#l6.102"></a><span id="l6.102">         Services.obs.addObserver(this, &quot;network:offline-status-changed&quot;, false);</span>
<a href="#l6.103"></a><span id="l6.103">     },</span>
<a href="#l6.104"></a><span id="l6.104"> </span>
<a href="#l6.105"></a><span id="l6.105">     cleanupOfflineObservers: function ccm_cleanupOfflineObservers() {</span>
<a href="#l6.106"></a><span id="l6.106">         Services.obs.removeObserver(this, &quot;network:offline-status-changed&quot;);</span>
<a href="#l6.107"></a><span id="l6.107">     },</span>
<a href="#l6.108"></a><span id="l6.108" class="difflineat">@@ -260,22 +246,16 @@ calCalendarManager.prototype = {</span>
<a href="#l6.109"></a><span id="l6.109">                 // Refresh all the calendars that can be refreshed.</span>
<a href="#l6.110"></a><span id="l6.110">                 var cals = this.getCalendars({});</span>
<a href="#l6.111"></a><span id="l6.111">                 for each (var cal in cals) {</span>
<a href="#l6.112"></a><span id="l6.112">                     if (!cal.getProperty(&quot;disabled&quot;) &amp;&amp; cal.canRefresh) {</span>
<a href="#l6.113"></a><span id="l6.113">                         cal.refresh();</span>
<a href="#l6.114"></a><span id="l6.114">                     }</span>
<a href="#l6.115"></a><span id="l6.115">                 }</span>
<a href="#l6.116"></a><span id="l6.116">                 break;</span>
<a href="#l6.117"></a><span id="l6.117" class="difflineminus">-            case &quot;nsPref:changed&quot;:</span>
<a href="#l6.118"></a><span id="l6.118" class="difflineminus">-                if (aData == &quot;calendar.autorefresh.enabled&quot; ||</span>
<a href="#l6.119"></a><span id="l6.119" class="difflineminus">-                    aData == &quot;calendar.autorefresh.timeout&quot;) {</span>
<a href="#l6.120"></a><span id="l6.120" class="difflineminus">-                    this.setUpRefreshTimer();</span>
<a href="#l6.121"></a><span id="l6.121" class="difflineminus">-                }</span>
<a href="#l6.122"></a><span id="l6.122" class="difflineminus">-                break;</span>
<a href="#l6.123"></a><span id="l6.123">             case &quot;network:offline-status-changed&quot;:</span>
<a href="#l6.124"></a><span id="l6.124">                 for each (var calendar in this.mCache) {</span>
<a href="#l6.125"></a><span id="l6.125">                     if (calendar instanceof calCachedCalendar) {</span>
<a href="#l6.126"></a><span id="l6.126">                         calendar.onOfflineStatusChanged(aData == &quot;offline&quot;);</span>
<a href="#l6.127"></a><span id="l6.127">                     }</span>
<a href="#l6.128"></a><span id="l6.128">                 }</span>
<a href="#l6.129"></a><span id="l6.129">                 break;</span>
<a href="#l6.130"></a><span id="l6.130">         }</span>
<a href="#l6.131"></a><span id="l6.131" class="difflineat">@@ -396,19 +376,16 @@ calCalendarManager.prototype = {</span>
<a href="#l6.132"></a><span id="l6.132">                         case &quot;auto-enabled&quot;:</span>
<a href="#l6.133"></a><span id="l6.133">                         case &quot;cache.enabled&quot;:</span>
<a href="#l6.134"></a><span id="l6.134">                         case &quot;lightning-main-in-composite&quot;:</span>
<a href="#l6.135"></a><span id="l6.135">                         case &quot;calendar-main-in-composite&quot;:</span>
<a href="#l6.136"></a><span id="l6.136">                         case &quot;lightning-main-default&quot;:</span>
<a href="#l6.137"></a><span id="l6.137">                         case &quot;calendar-main-default&quot;:</span>
<a href="#l6.138"></a><span id="l6.138">                             cal.setPref(getPrefBranchFor(id) + name, value == &quot;true&quot;);</span>
<a href="#l6.139"></a><span id="l6.139">                             break;</span>
<a href="#l6.140"></a><span id="l6.140" class="difflineminus">-                        case &quot;cache.updatetimer&quot;:</span>
<a href="#l6.141"></a><span id="l6.141" class="difflineminus">-                            cal.setPref(getPrefBranchFor(id) + &quot;cache.updateTimer&quot;, Number(value));</span>
<a href="#l6.142"></a><span id="l6.142" class="difflineminus">-                            break;</span>
<a href="#l6.143"></a><span id="l6.143">                         case &quot;backup-time&quot;:</span>
<a href="#l6.144"></a><span id="l6.144">                         case &quot;uniquenum&quot;:</span>
<a href="#l6.145"></a><span id="l6.145">                             cal.setPref(getPrefBranchFor(id) + name, Number(value));</span>
<a href="#l6.146"></a><span id="l6.146">                             break;</span>
<a href="#l6.147"></a><span id="l6.147">                         case &quot;name&quot;:</span>
<a href="#l6.148"></a><span id="l6.148">                             cal.setLocalizedPref(getPrefBranchFor(id) + name, value);</span>
<a href="#l6.149"></a><span id="l6.149">                             break;</span>
<a href="#l6.150"></a><span id="l6.150">                         default: // keep as string</span>
<a href="#l6.151"></a><span id="l6.151" class="difflineat">@@ -654,16 +631,49 @@ calCalendarManager.prototype = {</span>
<a href="#l6.152"></a><span id="l6.152">         // Set up statistics</span>
<a href="#l6.153"></a><span id="l6.153">         if (calendar.getProperty(&quot;requiresNetwork&quot;) !== false) {</span>
<a href="#l6.154"></a><span id="l6.154">             this.mNetworkCalendarCount++;</span>
<a href="#l6.155"></a><span id="l6.155">         }</span>
<a href="#l6.156"></a><span id="l6.156">         if (calendar.readOnly) {</span>
<a href="#l6.157"></a><span id="l6.157">             this.mReadonlyCalendarCount++;</span>
<a href="#l6.158"></a><span id="l6.158">         }</span>
<a href="#l6.159"></a><span id="l6.159">         this.mCalendarCount++;</span>
<a href="#l6.160"></a><span id="l6.160" class="difflineplus">+</span>
<a href="#l6.161"></a><span id="l6.161" class="difflineplus">+        // Set up the refresh timer</span>
<a href="#l6.162"></a><span id="l6.162" class="difflineplus">+        this.setupRefreshTimer(calendar);</span>
<a href="#l6.163"></a><span id="l6.163" class="difflineplus">+    },</span>
<a href="#l6.164"></a><span id="l6.164" class="difflineplus">+</span>
<a href="#l6.165"></a><span id="l6.165" class="difflineplus">+    setupRefreshTimer: function setupRefreshTimer(aCalendar) {</span>
<a href="#l6.166"></a><span id="l6.166" class="difflineplus">+        // Add the refresh timer for this calendar</span>
<a href="#l6.167"></a><span id="l6.167" class="difflineplus">+        let refreshInterval = aCalendar.getProperty(&quot;refreshInterval&quot;);</span>
<a href="#l6.168"></a><span id="l6.168" class="difflineplus">+        if (refreshInterval === null) {</span>
<a href="#l6.169"></a><span id="l6.169" class="difflineplus">+            // Default to 30 minutes, in case the value is missing</span>
<a href="#l6.170"></a><span id="l6.170" class="difflineplus">+            refreshInterval = 30;</span>
<a href="#l6.171"></a><span id="l6.171" class="difflineplus">+        }</span>
<a href="#l6.172"></a><span id="l6.172" class="difflineplus">+</span>
<a href="#l6.173"></a><span id="l6.173" class="difflineplus">+        this.clearRefreshTimer(aCalendar);</span>
<a href="#l6.174"></a><span id="l6.174" class="difflineplus">+</span>
<a href="#l6.175"></a><span id="l6.175" class="difflineplus">+        if (refreshInterval &gt; 0) {</span>
<a href="#l6.176"></a><span id="l6.176" class="difflineplus">+            this.mRefreshTimer[aCalendar.id] =</span>
<a href="#l6.177"></a><span id="l6.177" class="difflineplus">+                Components.classes[&quot;@mozilla.org/timer;1&quot;]</span>
<a href="#l6.178"></a><span id="l6.178" class="difflineplus">+                          .createInstance(Components.interfaces.nsITimer);</span>
<a href="#l6.179"></a><span id="l6.179" class="difflineplus">+</span>
<a href="#l6.180"></a><span id="l6.180" class="difflineplus">+            this.mRefreshTimer[aCalendar.id]</span>
<a href="#l6.181"></a><span id="l6.181" class="difflineplus">+                .initWithCallback(new timerCallback(aCalendar),</span>
<a href="#l6.182"></a><span id="l6.182" class="difflineplus">+                                  refreshInterval * 60000,</span>
<a href="#l6.183"></a><span id="l6.183" class="difflineplus">+                                  Components.interfaces.nsITimer.TYPE_REPEATING_SLACK);</span>
<a href="#l6.184"></a><span id="l6.184" class="difflineplus">+        }</span>
<a href="#l6.185"></a><span id="l6.185" class="difflineplus">+    },</span>
<a href="#l6.186"></a><span id="l6.186" class="difflineplus">+</span>
<a href="#l6.187"></a><span id="l6.187" class="difflineplus">+    clearRefreshTimer: function clearRefreshTimer(aCalendar) {</span>
<a href="#l6.188"></a><span id="l6.188" class="difflineplus">+        if (aCalendar.id in this.mRefreshTimer &amp;&amp;</span>
<a href="#l6.189"></a><span id="l6.189" class="difflineplus">+            this.mRefreshTimer[aCalendar.id]) {</span>
<a href="#l6.190"></a><span id="l6.190" class="difflineplus">+            this.mRefreshTimer[aCalendar.id].cancel();</span>
<a href="#l6.191"></a><span id="l6.191" class="difflineplus">+            delete this.mRefreshTimer[aCalendar.id]</span>
<a href="#l6.192"></a><span id="l6.192" class="difflineplus">+        }</span>
<a href="#l6.193"></a><span id="l6.193">     },</span>
<a href="#l6.194"></a><span id="l6.194"> </span>
<a href="#l6.195"></a><span id="l6.195">     unregisterCalendar: function(calendar) {</span>
<a href="#l6.196"></a><span id="l6.196">         this.notifyObservers(&quot;onCalendarUnregistering&quot;, [calendar]);</span>
<a href="#l6.197"></a><span id="l6.197"> </span>
<a href="#l6.198"></a><span id="l6.198">         // calendar may be a calICalendar wrapper:</span>
<a href="#l6.199"></a><span id="l6.199">         if (calendar.wrappedJSObject instanceof calCachedCalendar) {</span>
<a href="#l6.200"></a><span id="l6.200">             calendar.wrappedJSObject.onCalendarUnregistering();</span>
<a href="#l6.201"></a><span id="l6.201" class="difflineat">@@ -680,16 +690,18 @@ calCalendarManager.prototype = {</span>
<a href="#l6.202"></a><span id="l6.202">         if (calendar.readOnly) {</span>
<a href="#l6.203"></a><span id="l6.203">             this.mReadonlyCalendarCount--;</span>
<a href="#l6.204"></a><span id="l6.204">         }</span>
<a href="#l6.205"></a><span id="l6.205"> </span>
<a href="#l6.206"></a><span id="l6.206">         if (calendar.getProperty(&quot;requiresNetwork&quot;) !== false) {</span>
<a href="#l6.207"></a><span id="l6.207">             this.mNetworkCalendarCount--;</span>
<a href="#l6.208"></a><span id="l6.208">         }</span>
<a href="#l6.209"></a><span id="l6.209">         this.mCalendarCount--;</span>
<a href="#l6.210"></a><span id="l6.210" class="difflineplus">+</span>
<a href="#l6.211"></a><span id="l6.211" class="difflineplus">+        this.clearRefreshTimer(calendar);</span>
<a href="#l6.212"></a><span id="l6.212">     },</span>
<a href="#l6.213"></a><span id="l6.213"> </span>
<a href="#l6.214"></a><span id="l6.214">     deleteCalendar: function(calendar) {</span>
<a href="#l6.215"></a><span id="l6.215">         /* check to see if calendar is unregistered first... */</span>
<a href="#l6.216"></a><span id="l6.216">         /* delete the calendar for good */</span>
<a href="#l6.217"></a><span id="l6.217">         if (this.mCache &amp;&amp; (calendar.id in this.mCache)) {</span>
<a href="#l6.218"></a><span id="l6.218">             throw &quot;Can't delete a registered calendar&quot;;</span>
<a href="#l6.219"></a><span id="l6.219">         }</span>
<a href="#l6.220"></a><span id="l6.220" class="difflineat">@@ -879,16 +891,19 @@ calMgrCalendarObserver.prototype = {</span>
<a href="#l6.221"></a><span id="l6.221">     onPropertyChanged: function(aCalendar, aName, aValue, aOldValue) {</span>
<a href="#l6.222"></a><span id="l6.222">         switch (aName) {</span>
<a href="#l6.223"></a><span id="l6.223">             case &quot;requiresNetwork&quot;:</span>
<a href="#l6.224"></a><span id="l6.224">                 this.calMgr.mNetworkCalendarCount += (aValue ? 1 : -1);</span>
<a href="#l6.225"></a><span id="l6.225">                 break;</span>
<a href="#l6.226"></a><span id="l6.226">             case &quot;readOnly&quot;:</span>
<a href="#l6.227"></a><span id="l6.227">                 this.calMgr.mReadonlyCalendarCount += (aValue ? 1 : -1);</span>
<a href="#l6.228"></a><span id="l6.228">                 break;</span>
<a href="#l6.229"></a><span id="l6.229" class="difflineplus">+            case &quot;refreshInterval&quot;:</span>
<a href="#l6.230"></a><span id="l6.230" class="difflineplus">+                this.calMgr.setupRefreshTimer(aCalendar);</span>
<a href="#l6.231"></a><span id="l6.231" class="difflineplus">+                break;</span>
<a href="#l6.232"></a><span id="l6.232">             case &quot;cache.enabled&quot;:</span>
<a href="#l6.233"></a><span id="l6.233">                 aOldValue = aOldValue || false;</span>
<a href="#l6.234"></a><span id="l6.234">                 aValue = aValue || false;</span>
<a href="#l6.235"></a><span id="l6.235"> </span>
<a href="#l6.236"></a><span id="l6.236">                 if (aOldValue != aValue) {</span>
<a href="#l6.237"></a><span id="l6.237"> </span>
<a href="#l6.238"></a><span id="l6.238">                     // Try to find the current sort order</span>
<a href="#l6.239"></a><span id="l6.239">                     let sortOrderPref = cal.getPrefSafe(&quot;calendar.list.sortOrder&quot;, &quot;&quot;).split(&quot; &quot;);</span>
<a href="#l6.240"></a><span id="l6.240" class="difflineat">@@ -909,16 +924,17 @@ calMgrCalendarObserver.prototype = {</span>
<a href="#l6.241"></a><span id="l6.241"> </span>
<a href="#l6.242"></a><span id="l6.242">                     // TODO: if properties get added this list will need to be adjusted,</span>
<a href="#l6.243"></a><span id="l6.243">                     // ideally we should add a &quot;getProperties&quot; method to calICalendar.idl</span>
<a href="#l6.244"></a><span id="l6.244">                     // to retrieve all non-transient properties for a calendar.</span>
<a href="#l6.245"></a><span id="l6.245">                     let propsToCopy = [ &quot;color&quot;,</span>
<a href="#l6.246"></a><span id="l6.246">                                         &quot;disabled&quot;,</span>
<a href="#l6.247"></a><span id="l6.247">                                         &quot;auto-enabled&quot;,</span>
<a href="#l6.248"></a><span id="l6.248">                                         &quot;cache.enabled&quot;,</span>
<a href="#l6.249"></a><span id="l6.249" class="difflineplus">+                                        &quot;refreshInterval&quot;,</span>
<a href="#l6.250"></a><span id="l6.250">                                         &quot;suppressAlarms&quot;,</span>
<a href="#l6.251"></a><span id="l6.251">                                         &quot;calendar-main-in-composite&quot;,</span>
<a href="#l6.252"></a><span id="l6.252">                                         &quot;calendar-main-default&quot;,</span>
<a href="#l6.253"></a><span id="l6.253">                                         &quot;readOnly&quot;,</span>
<a href="#l6.254"></a><span id="l6.254">                                         &quot;imip.identity.key&quot;];</span>
<a href="#l6.255"></a><span id="l6.255">                     for each (let prop in propsToCopy ) {</span>
<a href="#l6.256"></a><span id="l6.256">                       newCal.setProperty(prop,</span>
<a href="#l6.257"></a><span id="l6.257">                                          aCalendar.getProperty(prop));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/lightning/content/lightning.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/lightning/content/lightning.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -76,20 +76,16 @@ pref(&quot;calendar.alarms.onforevents&quot;, 0);</span>
<a href="#l7.4"></a><span id="l7.4"> pref(&quot;calendar.alarms.eventalarmlen&quot;, 15);</span>
<a href="#l7.5"></a><span id="l7.5"> pref(&quot;calendar.alarms.eventalarmunit&quot;, &quot;minutes&quot;);</span>
<a href="#l7.6"></a><span id="l7.6"> </span>
<a href="#l7.7"></a><span id="l7.7"> // default alarm settings for new task</span>
<a href="#l7.8"></a><span id="l7.8"> pref(&quot;calendar.alarms.onfortodos&quot;, 0);</span>
<a href="#l7.9"></a><span id="l7.9"> pref(&quot;calendar.alarms.todoalarmlen&quot;, 15);</span>
<a href="#l7.10"></a><span id="l7.10"> pref(&quot;calendar.alarms.todoalarmunit&quot;, &quot;minutes&quot;);</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-// autorefresh settings</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-pref(&quot;calendar.autorefresh.enabled&quot;, true);</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-pref(&quot;calendar.autorefresh.timeout&quot;, 30);</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineminus">-</span>
<a href="#l7.16"></a><span id="l7.16"> // open invitations autorefresh settings</span>
<a href="#l7.17"></a><span id="l7.17"> pref(&quot;calendar.invitations.autorefresh.enabled&quot;, true);</span>
<a href="#l7.18"></a><span id="l7.18"> pref(&quot;calendar.invitations.autorefresh.timeout&quot;, 3);</span>
<a href="#l7.19"></a><span id="l7.19"> </span>
<a href="#l7.20"></a><span id="l7.20"> // iTIP compatibility send mode</span>
<a href="#l7.21"></a><span id="l7.21"> // 0 -- Outlook 2003 and following with text/plain and application/ics (default)</span>
<a href="#l7.22"></a><span id="l7.22"> // 1 -- all Outlook, but no text/plain nor application/ics</span>
<a href="#l7.23"></a><span id="l7.23"> // We may extend the compat mode if necessary.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/locales/en-US/chrome/calendar/calendar.dtd</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/locales/en-US/chrome/calendar/calendar.dtd</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -316,16 +316,18 @@</span>
<a href="#l8.4"></a><span id="l8.4"> </span>
<a href="#l8.5"></a><span id="l8.5"> &lt;!-- Calendar Properties --&gt;</span>
<a href="#l8.6"></a><span id="l8.6"> &lt;!ENTITY calendarproperties.color.label                    &quot;Color:&quot;&gt;</span>
<a href="#l8.7"></a><span id="l8.7"> &lt;!ENTITY calendarproperties.webdav.label                   &quot;iCalendar (ICS)&quot;&gt;</span>
<a href="#l8.8"></a><span id="l8.8"> &lt;!ENTITY calendarproperties.caldav.label                   &quot;CalDAV&quot;&gt;</span>
<a href="#l8.9"></a><span id="l8.9"> &lt;!ENTITY calendarproperties.wcap.label                     &quot;Sun Java System Calendar Server (WCAP)&quot;&gt;</span>
<a href="#l8.10"></a><span id="l8.10"> &lt;!ENTITY calendarproperties.format.label                   &quot;Format:&quot;&gt;</span>
<a href="#l8.11"></a><span id="l8.11"> &lt;!ENTITY calendarproperties.location.label                 &quot;Location:&quot;&gt;</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+&lt;!ENTITY calendarproperties.refreshInterval.label          &quot;Refresh Calendar:&quot;&gt;</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+&lt;!ENTITY calendarproperties.refreshInterval.manual.label   &quot;Manually&quot;&gt;</span>
<a href="#l8.14"></a><span id="l8.14"> &lt;!ENTITY calendarproperties.name.label                     &quot;Name:&quot;&gt;</span>
<a href="#l8.15"></a><span id="l8.15"> &lt;!ENTITY calendarproperties.readonly.label                 &quot;Read Only&quot;&gt;</span>
<a href="#l8.16"></a><span id="l8.16"> &lt;!ENTITY calendarproperties.firealarms.label               &quot;Show Alarms&quot;&gt;</span>
<a href="#l8.17"></a><span id="l8.17"> &lt;!ENTITY calendarproperties.cache.label                    &quot;Cache (EXPERIMENTAL)&quot;&gt;</span>
<a href="#l8.18"></a><span id="l8.18"> &lt;!ENTITY calendarproperties.enabled.label                  &quot;Switch this calendar on&quot;&gt;</span>
<a href="#l8.19"></a><span id="l8.19"> &lt;!ENTITY calendarproperties.forceDisabled.label            &quot;The provider for this calendar could not be found. This often happens if you have disabled or uninstalled certain addons.&quot;&gt;</span>
<a href="#l8.20"></a><span id="l8.20"> &lt;!ENTITY calendarproperties.unsubscribe.label              &quot;Unsubscribe&quot;&gt;</span>
<a href="#l8.21"></a><span id="l8.21"> &lt;!ENTITY calendarproperties.unsubscribe.accesskey          &quot;U&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/locales/en-US/chrome/calendar/calendar.properties</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/locales/en-US/chrome/calendar/calendar.properties</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -620,8 +620,10 @@ deleteTaskLabel=Delete Task</span>
<a href="#l9.4"></a><span id="l9.4"> deleteTaskMessage=Do you really want to delete this Task?</span>
<a href="#l9.5"></a><span id="l9.5"> deleteTaskAccesskey=l</span>
<a href="#l9.6"></a><span id="l9.6"> deleteItemLabel=Delete</span>
<a href="#l9.7"></a><span id="l9.7"> deleteItemMessage=Do you really want to delete this Item?</span>
<a href="#l9.8"></a><span id="l9.8"> deleteItemAccesskey=l</span>
<a href="#l9.9"></a><span id="l9.9"> deleteEventLabel=Delete Event</span>
<a href="#l9.10"></a><span id="l9.10"> deleteEventMessage=Do you really want to delete this Event?</span>
<a href="#l9.11"></a><span id="l9.11"> deleteEventAccesskey=l</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+calendarPropertiesEveryMinute=Every minute;Every #1 minutes</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/locales/en-US/chrome/calendar/preferences/general.dtd</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/locales/en-US/chrome/calendar/preferences/general.dtd</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -44,11 +44,8 @@</span>
<a href="#l10.4"></a><span id="l10.4"> &lt;!ENTITY pref.dateformat.label &quot;Date Text Format:&quot; &gt;</span>
<a href="#l10.5"></a><span id="l10.5"> &lt;!ENTITY pref.dateformat.accesskey &quot;D&quot;&gt;</span>
<a href="#l10.6"></a><span id="l10.6"> &lt;!ENTITY pref.dateformat.long &quot;Long&quot; &gt;</span>
<a href="#l10.7"></a><span id="l10.7"> &lt;!ENTITY pref.dateformat.short &quot;Short&quot;  &gt;</span>
<a href="#l10.8"></a><span id="l10.8"> &lt;!ENTITY pref.defaultlength.label &quot;Default Event Length:&quot; &gt;</span>
<a href="#l10.9"></a><span id="l10.9"> &lt;!ENTITY pref.defaultlength.accesskey &quot;E&quot;&gt;</span>
<a href="#l10.10"></a><span id="l10.10"> &lt;!ENTITY pref.defaultsnoozelength.label &quot;Default Snooze Length:&quot; &gt;</span>
<a href="#l10.11"></a><span id="l10.11"> &lt;!ENTITY pref.defaultsnoozelength.accesskey &quot;S&quot;&gt;</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-&lt;!ENTITY pref.refreshbox.label &quot;Refresh Settings&quot; &gt;</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-&lt;!ENTITY pref.autorefresh.label &quot;Refresh calendars every&quot; &gt;</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineminus">-&lt;!ENTITY pref.autorefresh.accesskey &quot;R&quot; &gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -424,18 +424,16 @@ calDavCalendar.prototype = {</span>
<a href="#l11.4"></a><span id="l11.4">         switch (aName) {</span>
<a href="#l11.5"></a><span id="l11.5">             case &quot;organizerId&quot;:</span>
<a href="#l11.6"></a><span id="l11.6">                 if (this.calendarUserAddress) {</span>
<a href="#l11.7"></a><span id="l11.7">                     return this.calendarUserAddress;</span>
<a href="#l11.8"></a><span id="l11.8">                 } // else use configured email identity</span>
<a href="#l11.9"></a><span id="l11.9">                 break;</span>
<a href="#l11.10"></a><span id="l11.10">             case &quot;organizerCN&quot;:</span>
<a href="#l11.11"></a><span id="l11.11">                 return null; // xxx todo</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-            case &quot;cache.updateTimer&quot;:</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-                return getPrefSafe(&quot;calendar.autorefresh.timeout&quot;);</span>
<a href="#l11.14"></a><span id="l11.14">             case &quot;itip.transport&quot;:</span>
<a href="#l11.15"></a><span id="l11.15">                 if (this.hasAutoScheduling || this.hasScheduling) {</span>
<a href="#l11.16"></a><span id="l11.16">                     return this.QueryInterface(Components.interfaces.calIItipTransport);</span>
<a href="#l11.17"></a><span id="l11.17">                 } // else use outbound email-based iTIP (from cal.ProviderBase)</span>
<a href="#l11.18"></a><span id="l11.18">                 break;</span>
<a href="#l11.19"></a><span id="l11.19">             case &quot;capabilities.tasks.supported&quot;:</span>
<a href="#l11.20"></a><span id="l11.20">                 return (this.supportedItemTypes.indexOf(&quot;VTODO&quot;) &gt; -1);</span>
<a href="#l11.21"></a><span id="l11.21">             case &quot;capabilities.events.supported&quot;:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/sunbird/app/profile/sunbird.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/sunbird/app/profile/sunbird.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -54,18 +54,16 @@ pref(&quot;calendar.alarms.onforevents&quot;, 0); </span>
<a href="#l12.4"></a><span id="l12.4"> pref(&quot;calendar.alarms.onfortodos&quot;, 0); //XXX this should be a bool</span>
<a href="#l12.5"></a><span id="l12.5"> pref(&quot;calendar.alarms.eventalarmlen&quot;, 15);</span>
<a href="#l12.6"></a><span id="l12.6"> pref(&quot;calendar.alarms.todoalarmlen&quot;, 15);</span>
<a href="#l12.7"></a><span id="l12.7"> pref(&quot;calendar.alarms.eventalarmunit&quot;, &quot;minutes&quot;);</span>
<a href="#l12.8"></a><span id="l12.8"> pref(&quot;calendar.alarms.todoalarmunit&quot;, &quot;minutes&quot;);</span>
<a href="#l12.9"></a><span id="l12.9"> pref(&quot;calendar.alarms.defaultsnoozelength&quot;, 5);</span>
<a href="#l12.10"></a><span id="l12.10"> pref(&quot;calendar.alarms.indicator.show&quot;, true);</span>
<a href="#l12.11"></a><span id="l12.11"> pref(&quot;calendar.alarms.indicator.totaltime&quot;, 3600);</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-pref(&quot;calendar.autorefresh.enabled&quot;, true);</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-pref(&quot;calendar.autorefresh.timeout&quot;, 30);</span>
<a href="#l12.14"></a><span id="l12.14"> pref(&quot;calendar.date.format&quot;, 0);</span>
<a href="#l12.15"></a><span id="l12.15"> pref(&quot;calendar.event.defaultlength&quot;, 60);</span>
<a href="#l12.16"></a><span id="l12.16"> // Do NOT set this.  If it is unset, we guess the timezone from the system</span>
<a href="#l12.17"></a><span id="l12.17"> //pref(&quot;calendar.timezone.local&quot;, &quot;America/New_York);</span>
<a href="#l12.18"></a><span id="l12.18"> </span>
<a href="#l12.19"></a><span id="l12.19"> // start and end work hour for day and week views</span>
<a href="#l12.20"></a><span id="l12.20"> pref(&quot;calendar.view.daystarthour&quot;, 8);</span>
<a href="#l12.21"></a><span id="l12.21"> pref(&quot;calendar.view.dayendhour&quot;, 17);</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

