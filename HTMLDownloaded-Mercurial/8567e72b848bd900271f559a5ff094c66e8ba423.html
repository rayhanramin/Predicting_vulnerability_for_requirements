<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 17695:8567e72b848bd900271f559a5ff094c66e8ba423</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 8567e72b848bd900271f559a5ff094c66e8ba423" />
<meta property="og:url" content="/comm-central/rev/8567e72b848bd900271f559a5ff094c66e8ba423" />
<meta property="og:description" content="Bug 36489 Combined To/From column in thread pane r=mkmelin ui-r=bwinton" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 8567e72b848bd900271f559a5ff094c66e8ba423 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/8567e72b848bd900271f559a5ff094c66e8ba423">shortlog</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/8567e72b848bd900271f559a5ff094c66e8ba423">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423">files</a> |
changeset |
<a href="/comm-central/raw-rev/8567e72b848bd900271f559a5ff094c66e8ba423">raw</a>  | <a href="/comm-central/archive/8567e72b848bd900271f559a5ff094c66e8ba423.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=36489">Bug 36489</a> Combined To/From column in thread pane r=mkmelin ui-r=bwinton
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#78;&#101;&#105;&#108;&#32;&#82;&#97;&#115;&#104;&#98;&#114;&#111;&#111;&#107;&#32;&#60;&#110;&#101;&#105;&#108;&#64;&#112;&#97;&#114;&#107;&#119;&#97;&#121;&#99;&#99;&#46;&#99;&#111;&#46;&#117;&#107;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 24 Mar 2015 14:55:02 +0000</td></tr>

<tr>
 <td>changeset 17695</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/8567e72b848bd900271f559a5ff094c66e8ba423">8567e72b848bd900271f559a5ff094c66e8ba423</a></td>
</tr>



<tr>
<td>parent 17694</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/5ec38389ad9ab8255075cff3a8e283697b1fb9d7">5ec38389ad9ab8255075cff3a8e283697b1fb9d7</a>
</td>
</tr>

<tr>
<td>child 17696</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/35d9101cb3b18884c0bcb35503ef714137fafc0e">35d9101cb3b18884c0bcb35503ef714137fafc0e</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=8567e72b848bd900271f559a5ff094c66e8ba423">10897</a></td></tr>
<tr><td>push user</td><td>neil@parkwaycc.co.uk</td></tr>
<tr><td>push date</td><td class="date age">Tue, 24 Mar 2015 14:55:19 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@8567e72b848b [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=8567e72b848bd900271f559a5ff094c66e8ba423">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=8567e72b848bd900271f559a5ff094c66e8ba423&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=8567e72b848bd900271f559a5ff094c66e8ba423&newProject=comm-central&newRevision=8567e72b848bd900271f559a5ff094c66e8ba423&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=8567e72b848bd900271f559a5ff094c66e8ba423&newProject=comm-central&newRevision=8567e72b848bd900271f559a5ff094c66e8ba423&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=8567e72b848bd900271f559a5ff094c66e8ba423&newProject=comm-central&newRevision=8567e72b848bd900271f559a5ff094c66e8ba423&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28mkmelin%29&revcount=50">mkmelin</a>, <a href="/comm-central/log?rev=reviewer%28bwinton%29&revcount=50">bwinton</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=36489">36489</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=36489">Bug 36489</a> Combined To/From column in thread pane r=mkmelin ui-r=bwinton</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/SearchDialog.js">mail/base/content/SearchDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/SearchDialog.js">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/SearchDialog.js">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/SearchDialog.js">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/SearchDialog.js">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/SearchDialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/SearchDialog.xul">mail/base/content/SearchDialog.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/SearchDialog.xul">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/SearchDialog.xul">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/SearchDialog.xul">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/SearchDialog.xul">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/SearchDialog.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/commandglue.js">mail/base/content/commandglue.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/commandglue.js">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/commandglue.js">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/commandglue.js">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/commandglue.js">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/commandglue.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/folderDisplay.js">mail/base/content/folderDisplay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/folderDisplay.js">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/folderDisplay.js">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/folderDisplay.js">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/folderDisplay.js">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/folderDisplay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/mailWindowOverlay.js">mail/base/content/mailWindowOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/mailWindowOverlay.js">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/mailWindowOverlay.js">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/mailWindowOverlay.js">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/mailWindowOverlay.js">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/mailWindowOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/mailWindowOverlay.xul">mail/base/content/mailWindowOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/mailWindowOverlay.xul">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/mailWindowOverlay.xul">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/mailWindowOverlay.xul">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/mailWindowOverlay.xul">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/mailWindowOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/messenger.css">mail/base/content/messenger.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/messenger.css">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/messenger.css">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/messenger.css">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/messenger.css">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/messenger.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/messenger.xul">mail/base/content/messenger.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/messenger.xul">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/messenger.xul">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/messenger.xul">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/messenger.xul">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/messenger.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/tabmail.css">mail/base/content/tabmail.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/tabmail.css">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/tabmail.css">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/tabmail.css">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/tabmail.css">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/tabmail.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/threadPane.js">mail/base/content/threadPane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/threadPane.js">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/threadPane.js">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/threadPane.js">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/threadPane.js">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/content/threadPane.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/modules/dbViewWrapper.js">mail/base/modules/dbViewWrapper.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/modules/dbViewWrapper.js">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/modules/dbViewWrapper.js">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/modules/dbViewWrapper.js">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/modules/dbViewWrapper.js">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/base/modules/dbViewWrapper.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/locales/en-US/chrome/messenger/SearchDialog.dtd">mail/locales/en-US/chrome/messenger/SearchDialog.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/locales/en-US/chrome/messenger/SearchDialog.dtd">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/locales/en-US/chrome/messenger/SearchDialog.dtd">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/locales/en-US/chrome/messenger/SearchDialog.dtd">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/locales/en-US/chrome/messenger/SearchDialog.dtd">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/locales/en-US/chrome/messenger/SearchDialog.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/locales/en-US/chrome/messenger/messenger.dtd">mail/locales/en-US/chrome/messenger/messenger.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/locales/en-US/chrome/messenger/messenger.dtd">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/locales/en-US/chrome/messenger/messenger.dtd">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/locales/en-US/chrome/messenger/messenger.dtd">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/locales/en-US/chrome/messenger/messenger.dtd">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/locales/en-US/chrome/messenger/messenger.dtd">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/test/mozmill/folder-display/test-columns.js">mail/test/mozmill/folder-display/test-columns.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/test/mozmill/folder-display/test-columns.js">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/test/mozmill/folder-display/test-columns.js">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/test/mozmill/folder-display/test-columns.js">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/test/mozmill/folder-display/test-columns.js">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/test/mozmill/folder-display/test-columns.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/linux/mail/mailWindow1.css">mail/themes/linux/mail/mailWindow1.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/linux/mail/mailWindow1.css">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/linux/mail/mailWindow1.css">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/linux/mail/mailWindow1.css">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/linux/mail/mailWindow1.css">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/linux/mail/mailWindow1.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/osx/mail/mailWindow1.css">mail/themes/osx/mail/mailWindow1.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/osx/mail/mailWindow1.css">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/osx/mail/mailWindow1.css">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/osx/mail/mailWindow1.css">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/osx/mail/mailWindow1.css">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/osx/mail/mailWindow1.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/windows/mail/mailWindow1.css">mail/themes/windows/mail/mailWindow1.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/windows/mail/mailWindow1.css">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/windows/mail/mailWindow1.css">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/windows/mail/mailWindow1.css">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/windows/mail/mailWindow1.css">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mail/themes/windows/mail/mailWindow1.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/public/nsIMsgDBView.idl">mailnews/base/public/nsIMsgDBView.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/public/nsIMsgDBView.idl">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/public/nsIMsgDBView.idl">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/public/nsIMsgDBView.idl">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/public/nsIMsgDBView.idl">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/public/nsIMsgDBView.idl">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgDBView.cpp">mailnews/base/src/nsMsgDBView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgDBView.cpp">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgDBView.cpp">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgDBView.cpp">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgDBView.cpp">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgDBView.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgDBView.h">mailnews/base/src/nsMsgDBView.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgDBView.h">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgDBView.h">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgDBView.h">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgDBView.h">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgDBView.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgGroupView.cpp">mailnews/base/src/nsMsgGroupView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgGroupView.cpp">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgGroupView.cpp">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgGroupView.cpp">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgGroupView.cpp">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/base/src/nsMsgGroupView.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/db/gloda/modules/dbview.js">mailnews/db/gloda/modules/dbview.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/db/gloda/modules/dbview.js">file</a> |
<a href="/comm-central/annotate/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/db/gloda/modules/dbview.js">annotate</a> |
<a href="/comm-central/diff/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/db/gloda/modules/dbview.js">diff</a> |
<a href="/comm-central/comparison/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/db/gloda/modules/dbview.js">comparison</a> |
<a href="/comm-central/log/8567e72b848bd900271f559a5ff094c66e8ba423/mailnews/db/gloda/modules/dbview.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/base/content/SearchDialog.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/base/content/SearchDialog.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -238,17 +238,17 @@ function searchOnLoad()</span>
<a href="#l1.4"></a><span id="l1.4">   gFolderDisplay.tree = document.getElementById(&quot;threadTree&quot;);</span>
<a href="#l1.5"></a><span id="l1.5">   gFolderDisplay.treeBox = gFolderDisplay.tree.boxObject.QueryInterface(</span>
<a href="#l1.6"></a><span id="l1.6">                              Components.interfaces.nsITreeBoxObject);</span>
<a href="#l1.7"></a><span id="l1.7">   gFolderDisplay.view.openSearchView();</span>
<a href="#l1.8"></a><span id="l1.8">   gFolderDisplay.makeActive();</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10">   gFolderDisplay.setColumnStates({</span>
<a href="#l1.11"></a><span id="l1.11">     subjectCol: { visible: true },</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-    senderCol: { visible: true },</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    correspondentCol: { visible: true },</span>
<a href="#l1.14"></a><span id="l1.14">     dateCol: { visible: true },</span>
<a href="#l1.15"></a><span id="l1.15">     locationCol: { visible: true },</span>
<a href="#l1.16"></a><span id="l1.16">   });</span>
<a href="#l1.17"></a><span id="l1.17"> </span>
<a href="#l1.18"></a><span id="l1.18">   if (window.arguments &amp;&amp; window.arguments[0])</span>
<a href="#l1.19"></a><span id="l1.19">       updateSearchFolderPicker(window.arguments[0].folder);</span>
<a href="#l1.20"></a><span id="l1.20"> </span>
<a href="#l1.21"></a><span id="l1.21">   // trigger searchTermOverlay.js to create the first criterion</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/SearchDialog.xul</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/SearchDialog.xul</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -135,16 +135,19 @@</span>
<a href="#l2.4"></a><span id="l2.4">             &lt;treecol id=&quot;senderCol&quot; persist=&quot;hidden swappedhidden ordinal width&quot; flex=&quot;4&quot;</span>
<a href="#l2.5"></a><span id="l2.5">                      hidden=&quot;false&quot; swappedhidden=&quot;true&quot;</span>
<a href="#l2.6"></a><span id="l2.6">                      label=&quot;&amp;fromColumn.label;&quot; tooltiptext=&quot;&amp;fromColumn2.tooltip;&quot;/&gt;</span>
<a href="#l2.7"></a><span id="l2.7">             &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l2.8"></a><span id="l2.8">             &lt;treecol id=&quot;recipientCol&quot; persist=&quot;hidden swappedhidden ordinal width&quot; flex=&quot;4&quot;</span>
<a href="#l2.9"></a><span id="l2.9">                      hidden=&quot;true&quot; swappedhidden=&quot;false&quot;</span>
<a href="#l2.10"></a><span id="l2.10">                      label=&quot;&amp;recipientColumn.label;&quot; tooltiptext=&quot;&amp;recipientColumn2.tooltip;&quot;/&gt;</span>
<a href="#l2.11"></a><span id="l2.11">             &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+            &lt;treecol id=&quot;correspondentCol&quot; persist=&quot;hidden ordinal width&quot; flex=&quot;4&quot;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+                     label=&quot;&amp;correspondentColumn.label;&quot; tooltiptext=&quot;&amp;correspondentColumn2.tooltip;&quot;/&gt;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+            &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l2.15"></a><span id="l2.15">             &lt;treecol id=&quot;unreadButtonColHeader&quot; persist=&quot;hidden ordinal&quot; fixed=&quot;true&quot; cycler=&quot;true&quot;</span>
<a href="#l2.16"></a><span id="l2.16">                      class=&quot;treecol-image readColumnHeader&quot;</span>
<a href="#l2.17"></a><span id="l2.17">                      label=&quot;&amp;readColumn.label;&quot; tooltiptext=&quot;&amp;readColumn2.tooltip;&quot;/&gt;</span>
<a href="#l2.18"></a><span id="l2.18">             &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l2.19"></a><span id="l2.19">             &lt;treecol id=&quot;dateCol&quot; persist=&quot;hidden ordinal width&quot; flex=&quot;2&quot;</span>
<a href="#l2.20"></a><span id="l2.20">                      label=&quot;&amp;dateColumn.label;&quot; tooltiptext=&quot;&amp;dateColumn2.tooltip;&quot;/&gt;</span>
<a href="#l2.21"></a><span id="l2.21">             &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l2.22"></a><span id="l2.22">             &lt;treecol id=&quot;statusCol&quot; persist=&quot;hidden ordinal width&quot; flex=&quot;1&quot; hidden=&quot;true&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/base/content/commandglue.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/base/content/commandglue.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -256,16 +256,19 @@ function ConvertSortTypeToColumnID(sortK</span>
<a href="#l3.4"></a><span id="l3.4">         columnID = gDBView.curCustomColumn;</span>
<a href="#l3.5"></a><span id="l3.5">       }</span>
<a href="#l3.6"></a><span id="l3.6">       catch (err) { //error - means no handler</span>
<a href="#l3.7"></a><span id="l3.7">         dump(&quot;ConvertSortTypeToColumnID: custom sort key but no handler for column '&quot; + columnID + &quot;'\n&quot;);</span>
<a href="#l3.8"></a><span id="l3.8">         columnID = &quot;dateCol&quot;;</span>
<a href="#l3.9"></a><span id="l3.9">       }</span>
<a href="#l3.10"></a><span id="l3.10"> </span>
<a href="#l3.11"></a><span id="l3.11">       break;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+    case nsMsgViewSortType.byCorrespondent:</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+      columnID = &quot;correspondentCol&quot;;</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+      break;</span>
<a href="#l3.15"></a><span id="l3.15">     default:</span>
<a href="#l3.16"></a><span id="l3.16">       dump(&quot;unsupported sort key: &quot; + sortKey + &quot;\n&quot;);</span>
<a href="#l3.17"></a><span id="l3.17">       columnID = &quot;dateCol&quot;;</span>
<a href="#l3.18"></a><span id="l3.18">       break;</span>
<a href="#l3.19"></a><span id="l3.19">   }</span>
<a href="#l3.20"></a><span id="l3.20">   return columnID;</span>
<a href="#l3.21"></a><span id="l3.21"> }</span>
<a href="#l3.22"></a><span id="l3.22"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/base/content/folderDisplay.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/base/content/folderDisplay.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -368,18 +368,18 @@ FolderDisplayWidget.prototype = {</span>
<a href="#l4.4"></a><span id="l4.4">    *  it is actually an appropriate default for the folder type.</span>
<a href="#l4.5"></a><span id="l4.5">    */</span>
<a href="#l4.6"></a><span id="l4.6">   DEFAULT_COLUMNS: [</span>
<a href="#l4.7"></a><span id="l4.7">     &quot;threadCol&quot;,</span>
<a href="#l4.8"></a><span id="l4.8">     &quot;attachmentCol&quot;,</span>
<a href="#l4.9"></a><span id="l4.9">     &quot;flaggedCol&quot;,</span>
<a href="#l4.10"></a><span id="l4.10">     &quot;subjectCol&quot;,</span>
<a href="#l4.11"></a><span id="l4.11">     &quot;unreadButtonColHeader&quot;,</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-    &quot;senderCol&quot;, // incoming folders</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-    &quot;recipientCol&quot;, // outgoing folders</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+    &quot;senderCol&quot;, // news folders</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+    &quot;correspondentCol&quot;, // mail folders</span>
<a href="#l4.16"></a><span id="l4.16">     &quot;junkStatusCol&quot;,</span>
<a href="#l4.17"></a><span id="l4.17">     &quot;dateCol&quot;,</span>
<a href="#l4.18"></a><span id="l4.18">     &quot;locationCol&quot;, // multiple-folder backed folders</span>
<a href="#l4.19"></a><span id="l4.19">   ],</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21">   /**</span>
<a href="#l4.22"></a><span id="l4.22">    * Maps column ids to functions that test whether the column is a good default</span>
<a href="#l4.23"></a><span id="l4.23">    *  for display for the folder.  Each function should expect a DBViewWrapper</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineat">@@ -387,23 +387,23 @@ FolderDisplayWidget.prototype = {</span>
<a href="#l4.25"></a><span id="l4.25">    *  properties like isMailFolder/isIncomingFolder/isOutgoingFolder allow the</span>
<a href="#l4.26"></a><span id="l4.26">    *  constraint to be expressed concisely.  If a helper does not exist, add</span>
<a href="#l4.27"></a><span id="l4.27">    *  one! (If doing so is out of reach, than access viewWrapper.displayedFolder</span>
<a href="#l4.28"></a><span id="l4.28">    *  to get at the nsIMsgFolder.)</span>
<a href="#l4.29"></a><span id="l4.29">    * If a column does not have a function, it is assumed that it should be</span>
<a href="#l4.30"></a><span id="l4.30">    *  displayed by default.</span>
<a href="#l4.31"></a><span id="l4.31">    */</span>
<a href="#l4.32"></a><span id="l4.32">   COLUMN_DEFAULT_TESTERS: {</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineminus">-    // senderCol = From.  You only care in incoming folders.</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineminus">-    senderCol: function (viewWrapper) {</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineminus">-      return viewWrapper.isIncomingFolder;</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+    // Don't show the correspondent for news or RSS where it doesn't make sense.</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+    correspondentCol: function (viewWrapper) {</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineplus">+      return viewWrapper.isMailFolder &amp;&amp; !viewWrapper.isFeedFolder;</span>
<a href="#l4.39"></a><span id="l4.39">     },</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineminus">-    // recipient = To. You only care in outgoing folders.</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineminus">-    recipientCol: function (viewWrapper) {</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineminus">-      return viewWrapper.isOutgoingFolder;</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+    // Instead show the sender.</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineplus">+    senderCol: function (viewWrapper) {</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineplus">+      return viewWrapper.isNewsFolder || viewWrapper.isFeedFolder;</span>
<a href="#l4.46"></a><span id="l4.46">     },</span>
<a href="#l4.47"></a><span id="l4.47">     // Only show the location column for non-single-folder results</span>
<a href="#l4.48"></a><span id="l4.48">     locationCol: function(viewWrapper) {</span>
<a href="#l4.49"></a><span id="l4.49">       return !viewWrapper.isSingleFolder;</span>
<a href="#l4.50"></a><span id="l4.50">     },</span>
<a href="#l4.51"></a><span id="l4.51">     // core UI does not provide an ability to mark newsgroup messages as spam</span>
<a href="#l4.52"></a><span id="l4.52">     junkStatusCol: function(viewWrapper) {</span>
<a href="#l4.53"></a><span id="l4.53">       return !viewWrapper.isNewsFolder;</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineat">@@ -496,23 +496,26 @@ FolderDisplayWidget.prototype = {</span>
<a href="#l4.55"></a><span id="l4.55">     }</span>
<a href="#l4.56"></a><span id="l4.56"> </span>
<a href="#l4.57"></a><span id="l4.57">     // do not inherit from the inbox if:</span>
<a href="#l4.58"></a><span id="l4.58">     // - It's an outgoing folder; these have a different use-case and there</span>
<a href="#l4.59"></a><span id="l4.59">     //    should be a small number of these, so it's okay to have no defaults.</span>
<a href="#l4.60"></a><span id="l4.60">     // - It's a virtual folder (single or multi-folder backed).  Who knows what</span>
<a href="#l4.61"></a><span id="l4.61">     //    the intent of the user is in this case.  This should also be bounded</span>
<a href="#l4.62"></a><span id="l4.62">     //    in number and our default heuristics should be pretty good.</span>
<a href="#l4.63"></a><span id="l4.63" class="difflineplus">+    // - It's a multiple folder; this is either a search view (which has no</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineplus">+    //   displayed folder) or a virtual folder (which we eliminated above).</span>
<a href="#l4.65"></a><span id="l4.65">     // - News folders.  There is no inbox so there's nothing to inherit from.</span>
<a href="#l4.66"></a><span id="l4.66">     //    (Although we could try and see if they have opened any other news</span>
<a href="#l4.67"></a><span id="l4.67">     //    folders in the same account.  But it's not all that important to us.)</span>
<a href="#l4.68"></a><span id="l4.68">     // - It's an inbox!</span>
<a href="#l4.69"></a><span id="l4.69">     let doNotInherit =</span>
<a href="#l4.70"></a><span id="l4.70">       this.view.isOutgoingFolder ||</span>
<a href="#l4.71"></a><span id="l4.71">       this.view.isVirtual ||</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineplus">+      this.view.isMultiFolder ||</span>
<a href="#l4.73"></a><span id="l4.73">       this.view.isNewsFolder ||</span>
<a href="#l4.74"></a><span id="l4.74">       this.displayedFolder.flags &amp; InboxFlag;</span>
<a href="#l4.75"></a><span id="l4.75"> </span>
<a href="#l4.76"></a><span id="l4.76">     // Try and grab the inbox for this account's settings.  we may not be able</span>
<a href="#l4.77"></a><span id="l4.77">     //  to, in which case we just won't inherit.  (It ends up the same since the</span>
<a href="#l4.78"></a><span id="l4.78">     //  inbox is obviously not customized in this case.)</span>
<a href="#l4.79"></a><span id="l4.79">     if (!doNotInherit) {</span>
<a href="#l4.80"></a><span id="l4.80">       let inboxFolder =</span>
<a href="#l4.81"></a><span id="l4.81" class="difflineat">@@ -682,16 +685,40 @@ FolderDisplayWidget.prototype = {</span>
<a href="#l4.82"></a><span id="l4.82">     this._savedColumnStates = this.getColumnStates();</span>
<a href="#l4.83"></a><span id="l4.83">   },</span>
<a href="#l4.84"></a><span id="l4.84"> </span>
<a href="#l4.85"></a><span id="l4.85">   /**</span>
<a href="#l4.86"></a><span id="l4.86">    * Restores the visible columns saved by |_saveColumnStates|.</span>
<a href="#l4.87"></a><span id="l4.87">    */</span>
<a href="#l4.88"></a><span id="l4.88">   _restoreColumnStates: function FolderDisplayWidget__restoreColumnStates() {</span>
<a href="#l4.89"></a><span id="l4.89">     if (this._savedColumnStates) {</span>
<a href="#l4.90"></a><span id="l4.90" class="difflineplus">+      // upgrade column states that don't have a correspondent column</span>
<a href="#l4.91"></a><span id="l4.91" class="difflineplus">+      if (!(&quot;correspondentCol&quot; in this._savedColumnStates) &amp;&amp;</span>
<a href="#l4.92"></a><span id="l4.92" class="difflineplus">+          (this._savedColumnStates.correspondentCol =</span>
<a href="#l4.93"></a><span id="l4.93" class="difflineplus">+            this._getDefaultColumnsForCurrentFolder().correspondentCol)) {</span>
<a href="#l4.94"></a><span id="l4.94" class="difflineplus">+        if (this._savedColumnStates.correspondentCol.visible) {</span>
<a href="#l4.95"></a><span id="l4.95" class="difflineplus">+          if (this._savedColumnStates.senderCol &amp;&amp;</span>
<a href="#l4.96"></a><span id="l4.96" class="difflineplus">+            this._savedColumnStates.senderCol.visible &amp;&amp;</span>
<a href="#l4.97"></a><span id="l4.97" class="difflineplus">+            this._savedColumnStates.senderCol.ordinal) {</span>
<a href="#l4.98"></a><span id="l4.98" class="difflineplus">+            this._savedColumnStates.senderCol.visible = false;</span>
<a href="#l4.99"></a><span id="l4.99" class="difflineplus">+            this._savedColumnStates.correspondentCol.ordinal =</span>
<a href="#l4.100"></a><span id="l4.100" class="difflineplus">+              this._savedColumnStates.senderCol.ordinal;</span>
<a href="#l4.101"></a><span id="l4.101" class="difflineplus">+          }</span>
<a href="#l4.102"></a><span id="l4.102" class="difflineplus">+          if (this._savedColumnStates.recipientCol &amp;&amp;</span>
<a href="#l4.103"></a><span id="l4.103" class="difflineplus">+            this._savedColumnStates.recipientCol.visible &amp;&amp;</span>
<a href="#l4.104"></a><span id="l4.104" class="difflineplus">+            this._savedColumnStates.recipientCol.ordinal) {</span>
<a href="#l4.105"></a><span id="l4.105" class="difflineplus">+            this._savedColumnStates.recipientCol.visible = false;</span>
<a href="#l4.106"></a><span id="l4.106" class="difflineplus">+            this._savedColumnStates.correspondentCol.ordinal =</span>
<a href="#l4.107"></a><span id="l4.107" class="difflineplus">+              this._savedColumnStates.recipientCol.ordinal;</span>
<a href="#l4.108"></a><span id="l4.108" class="difflineplus">+          }</span>
<a href="#l4.109"></a><span id="l4.109" class="difflineplus">+          if (!this._savedColumnStates.correspondentCol.ordinal)</span>
<a href="#l4.110"></a><span id="l4.110" class="difflineplus">+            this._savedColumnStates.correspondentCol.visible = false;</span>
<a href="#l4.111"></a><span id="l4.111" class="difflineplus">+        }</span>
<a href="#l4.112"></a><span id="l4.112" class="difflineplus">+      }</span>
<a href="#l4.113"></a><span id="l4.113" class="difflineplus">+</span>
<a href="#l4.114"></a><span id="l4.114">       this.setColumnStates(this._savedColumnStates);</span>
<a href="#l4.115"></a><span id="l4.115">       this._savedColumnStates = null;</span>
<a href="#l4.116"></a><span id="l4.116">     }</span>
<a href="#l4.117"></a><span id="l4.117">   },</span>
<a href="#l4.118"></a><span id="l4.118">   //@}</span>
<a href="#l4.119"></a><span id="l4.119"> </span>
<a href="#l4.120"></a><span id="l4.120">   /**</span>
<a href="#l4.121"></a><span id="l4.121">    * @name What To Display</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/base/content/mailWindowOverlay.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/base/content/mailWindowOverlay.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -314,25 +314,26 @@ function InitViewSortByMenu()</span>
<a href="#l5.4"></a><span id="l5.4">   setSortByMenuItemCheckState(&quot;sortByStatusMenuitem&quot;, (sortType == nsMsgViewSortType.byStatus));</span>
<a href="#l5.5"></a><span id="l5.5">   setSortByMenuItemCheckState(&quot;sortBySubjectMenuitem&quot;, (sortType == nsMsgViewSortType.bySubject));</span>
<a href="#l5.6"></a><span id="l5.6">   setSortByMenuItemCheckState(&quot;sortByUnreadMenuitem&quot;, (sortType == nsMsgViewSortType.byUnread));</span>
<a href="#l5.7"></a><span id="l5.7">   setSortByMenuItemCheckState(&quot;sortByTagsMenuitem&quot;, (sortType == nsMsgViewSortType.byTags));</span>
<a href="#l5.8"></a><span id="l5.8">   setSortByMenuItemCheckState(&quot;sortByJunkStatusMenuitem&quot;, (sortType == nsMsgViewSortType.byJunkStatus));</span>
<a href="#l5.9"></a><span id="l5.9">   setSortByMenuItemCheckState(&quot;sortByFromMenuitem&quot;, (sortType == nsMsgViewSortType.byAuthor));</span>
<a href="#l5.10"></a><span id="l5.10">   setSortByMenuItemCheckState(&quot;sortByRecipientMenuitem&quot;, (sortType == nsMsgViewSortType.byRecipient));</span>
<a href="#l5.11"></a><span id="l5.11">   setSortByMenuItemCheckState(&quot;sortByAttachmentsMenuitem&quot;, (sortType == nsMsgViewSortType.byAttachments));</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+  setSortByMenuItemCheckState(&quot;sortByCorrespondentMenuitem&quot;, (sortType == nsMsgViewSortType.byCorrespondent));</span>
<a href="#l5.13"></a><span id="l5.13"> </span>
<a href="#l5.14"></a><span id="l5.14">   var sortOrder = gFolderDisplay.view.primarySortOrder;</span>
<a href="#l5.15"></a><span id="l5.15">   var sortTypeSupportsGrouping = (sortType == nsMsgViewSortType.byAuthor ||</span>
<a href="#l5.16"></a><span id="l5.16">       sortType == nsMsgViewSortType.byDate || sortType == nsMsgViewSortType.byReceived ||</span>
<a href="#l5.17"></a><span id="l5.17">       sortType == nsMsgViewSortType.byPriority ||</span>
<a href="#l5.18"></a><span id="l5.18">       sortType == nsMsgViewSortType.bySubject || sortType == nsMsgViewSortType.byTags ||</span>
<a href="#l5.19"></a><span id="l5.19">       sortType == nsMsgViewSortType.byRecipient || sortType == nsMsgViewSortType.byAccount ||</span>
<a href="#l5.20"></a><span id="l5.20">       sortType == nsMsgViewSortType.byStatus || sortType == nsMsgViewSortType.byFlagged ||</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineminus">-      sortType == nsMsgViewSortType.byAttachments);</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineplus">+      sortType == nsMsgViewSortType.byAttachments || sortType == nsMsgViewSortType.byCorrespondent);</span>
<a href="#l5.23"></a><span id="l5.23"> </span>
<a href="#l5.24"></a><span id="l5.24">   setSortByMenuItemCheckState(&quot;sortAscending&quot;, (sortOrder == nsMsgViewSortOrder.ascending));</span>
<a href="#l5.25"></a><span id="l5.25">   setSortByMenuItemCheckState(&quot;sortDescending&quot;, (sortOrder == nsMsgViewSortOrder.descending));</span>
<a href="#l5.26"></a><span id="l5.26"> </span>
<a href="#l5.27"></a><span id="l5.27">   var grouped = gFolderDisplay.view.showGroupedBySort;</span>
<a href="#l5.28"></a><span id="l5.28">   var threaded = gFolderDisplay.view.showThreaded;</span>
<a href="#l5.29"></a><span id="l5.29">   var sortThreadedMenuItem = document.getElementById(&quot;sortThreaded&quot;);</span>
<a href="#l5.30"></a><span id="l5.30">   var sortUnthreadedMenuItem = document.getElementById(&quot;sortUnthreaded&quot;);</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineat">@@ -371,17 +372,18 @@ function InitAppViewSortByMenu()</span>
<a href="#l5.32"></a><span id="l5.32">                                   sortType == nsMsgViewSortType.byReceived ||</span>
<a href="#l5.33"></a><span id="l5.33">                                   sortType == nsMsgViewSortType.byPriority ||</span>
<a href="#l5.34"></a><span id="l5.34">                                   sortType == nsMsgViewSortType.bySubject ||</span>
<a href="#l5.35"></a><span id="l5.35">                                   sortType == nsMsgViewSortType.byTags ||</span>
<a href="#l5.36"></a><span id="l5.36">                                   sortType == nsMsgViewSortType.byRecipient ||</span>
<a href="#l5.37"></a><span id="l5.37">                                   sortType == nsMsgViewSortType.byAccount ||</span>
<a href="#l5.38"></a><span id="l5.38">                                   sortType == nsMsgViewSortType.byStatus ||</span>
<a href="#l5.39"></a><span id="l5.39">                                   sortType == nsMsgViewSortType.byFlagged ||</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineminus">-                                  sortType == nsMsgViewSortType.byAttachments);</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+                                  sortType == nsMsgViewSortType.byAttachments ||</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+                                  sortType == nsMsgViewSortType.byCorrespondent);</span>
<a href="#l5.43"></a><span id="l5.43"> </span>
<a href="#l5.44"></a><span id="l5.44">   setSortByMenuItemCheckState(&quot;appmenu_sortAscending&quot;, (sortOrder == nsMsgViewSortOrder.ascending));</span>
<a href="#l5.45"></a><span id="l5.45">   setSortByMenuItemCheckState(&quot;appmenu_sortDescending&quot;, (sortOrder == nsMsgViewSortOrder.descending));</span>
<a href="#l5.46"></a><span id="l5.46"> </span>
<a href="#l5.47"></a><span id="l5.47">   let grouped = gFolderDisplay.view.showGroupedBySort;</span>
<a href="#l5.48"></a><span id="l5.48">   let threaded = gFolderDisplay.view.showThreaded;</span>
<a href="#l5.49"></a><span id="l5.49">   let sortThreadedMenuItem = document.getElementById(&quot;appmenu_sortThreaded&quot;);</span>
<a href="#l5.50"></a><span id="l5.50">   let sortUnthreadedMenuItem = document.getElementById(&quot;appmenu_sortUnthreaded&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/base/content/mailWindowOverlay.xul</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/base/content/mailWindowOverlay.xul</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -1475,16 +1475,21 @@</span>
<a href="#l6.4"></a><span id="l6.4">                           name=&quot;sortby&quot;</span>
<a href="#l6.5"></a><span id="l6.5">                           label=&quot;&amp;sortByFromCmd.label;&quot;</span>
<a href="#l6.6"></a><span id="l6.6">                           oncommand=&quot;MsgSortThreadPane('byAuthor')&quot;/&gt;</span>
<a href="#l6.7"></a><span id="l6.7">                 &lt;menuitem id=&quot;appmenu_sortByRecipientMenuitem&quot;</span>
<a href="#l6.8"></a><span id="l6.8">                           type=&quot;radio&quot;</span>
<a href="#l6.9"></a><span id="l6.9">                           name=&quot;sortby&quot;</span>
<a href="#l6.10"></a><span id="l6.10">                           label=&quot;&amp;sortByRecipientCmd.label;&quot;</span>
<a href="#l6.11"></a><span id="l6.11">                           oncommand=&quot;MsgSortThreadPane('byRecipient')&quot;/&gt;</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+                &lt;menuitem id=&quot;appmenu_sortByCorrespondentMenuitem&quot;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+                          type=&quot;radio&quot;</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+                          name=&quot;sortby&quot;</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+                          label=&quot;&amp;sortByCorrespondentCmd.label;&quot;</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+                          oncommand=&quot;MsgSortThreadPane('byCorrespondent')&quot;/&gt;</span>
<a href="#l6.17"></a><span id="l6.17">                 &lt;menuitem id=&quot;appmenu_sortBySizeMenuitem&quot;</span>
<a href="#l6.18"></a><span id="l6.18">                           type=&quot;radio&quot;</span>
<a href="#l6.19"></a><span id="l6.19">                           name=&quot;sortby&quot;</span>
<a href="#l6.20"></a><span id="l6.20">                           label=&quot;&amp;sortBySizeCmd.label;&quot;</span>
<a href="#l6.21"></a><span id="l6.21">                           oncommand=&quot;MsgSortThreadPane('bySize')&quot;/&gt;</span>
<a href="#l6.22"></a><span id="l6.22">                 &lt;menuitem id=&quot;appmenu_sortByStatusMenuitem&quot;</span>
<a href="#l6.23"></a><span id="l6.23">                           type=&quot;radio&quot;</span>
<a href="#l6.24"></a><span id="l6.24">                           name=&quot;sortby&quot;</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineat">@@ -2420,16 +2425,17 @@</span>
<a href="#l6.26"></a><span id="l6.26">           &lt;menupopup id=&quot;menu_viewSortPopup&quot; onpopupshowing=&quot;InitViewSortByMenu()&quot;&gt;</span>
<a href="#l6.27"></a><span id="l6.27">             &lt;menuitem id=&quot;sortByDateMenuitem&quot; type=&quot;radio&quot; name=&quot;sortby&quot; label=&quot;&amp;sortByDateCmd.label;&quot; accesskey=&quot;&amp;sortByDateCmd.accesskey;&quot; oncommand=&quot;MsgSortThreadPane('byDate')&quot;/&gt;</span>
<a href="#l6.28"></a><span id="l6.28">             &lt;menuitem id=&quot;sortByReceivedMenuitem&quot; type=&quot;radio&quot; name=&quot;sortby&quot; label=&quot;&amp;sortByReceivedCmd.label;&quot; accesskey=&quot;&amp;sortByReceivedCmd.accesskey;&quot; oncommand=&quot;MsgSortThreadPane('byReceived')&quot;/&gt;</span>
<a href="#l6.29"></a><span id="l6.29">             &lt;menuitem id=&quot;sortByFlagMenuitem&quot; type=&quot;radio&quot; name=&quot;sortby&quot; label=&quot;&amp;sortByStarCmd.label;&quot; accesskey=&quot;&amp;sortByStarCmd.accesskey;&quot; oncommand=&quot;MsgSortThreadPane('byFlagged')&quot;/&gt;</span>
<a href="#l6.30"></a><span id="l6.30">             &lt;menuitem id=&quot;sortByOrderReceivedMenuitem&quot; type=&quot;radio&quot; name=&quot;sortby&quot; label=&quot;&amp;sortByOrderReceivedCmd.label;&quot;  accesskey=&quot;&amp;sortByOrderReceivedCmd.accesskey;&quot; oncommand=&quot;MsgSortThreadPane('byId')&quot;/&gt;</span>
<a href="#l6.31"></a><span id="l6.31">             &lt;menuitem id=&quot;sortByPriorityMenuitem&quot; type=&quot;radio&quot; name=&quot;sortby&quot; label=&quot;&amp;sortByPriorityCmd.label;&quot; accesskey=&quot;&amp;sortByPriorityCmd.accesskey;&quot; oncommand=&quot;MsgSortThreadPane('byPriority')&quot;/&gt;</span>
<a href="#l6.32"></a><span id="l6.32">             &lt;menuitem id=&quot;sortByFromMenuitem&quot; type=&quot;radio&quot; name=&quot;sortby&quot; label=&quot;&amp;sortByFromCmd.label;&quot; accesskey=&quot;&amp;sortByFromCmd.accesskey;&quot; oncommand=&quot;MsgSortThreadPane('byAuthor')&quot;/&gt;</span>
<a href="#l6.33"></a><span id="l6.33">             &lt;menuitem id=&quot;sortByRecipientMenuitem&quot; type=&quot;radio&quot; name=&quot;sortby&quot; label=&quot;&amp;sortByRecipientCmd.label;&quot; accesskey=&quot;&amp;sortByRecipientCmd.accesskey;&quot; oncommand=&quot;MsgSortThreadPane('byRecipient')&quot;/&gt;</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineplus">+            &lt;menuitem id=&quot;sortByCorrespondentMenuitem&quot; type=&quot;radio&quot; name=&quot;sortby&quot; label=&quot;&amp;sortByCorrespondentCmd.label;&quot; accesskey=&quot;&amp;sortByCorrespondentCmd.accesskey;&quot; oncommand=&quot;MsgSortThreadPane('byCorrespondent')&quot;/&gt;</span>
<a href="#l6.35"></a><span id="l6.35">             &lt;menuitem id=&quot;sortBySizeMenuitem&quot; type=&quot;radio&quot; name=&quot;sortby&quot; label=&quot;&amp;sortBySizeCmd.label;&quot; accesskey=&quot;&amp;sortBySizeCmd.accesskey;&quot; oncommand=&quot;MsgSortThreadPane('bySize')&quot;/&gt;</span>
<a href="#l6.36"></a><span id="l6.36">             &lt;menuitem id=&quot;sortByStatusMenuitem&quot; type=&quot;radio&quot; name=&quot;sortby&quot; label=&quot;&amp;sortByStatusCmd.label;&quot; accesskey=&quot;&amp;sortByStatusCmd.accesskey;&quot; oncommand=&quot;MsgSortThreadPane('byStatus')&quot;/&gt;</span>
<a href="#l6.37"></a><span id="l6.37">             &lt;menuitem id=&quot;sortBySubjectMenuitem&quot; type=&quot;radio&quot; name=&quot;sortby&quot; label=&quot;&amp;sortBySubjectCmd.label;&quot; accesskey=&quot;&amp;sortBySubjectCmd.accesskey;&quot; oncommand=&quot;MsgSortThreadPane('bySubject')&quot;/&gt;</span>
<a href="#l6.38"></a><span id="l6.38">             &lt;menuitem id=&quot;sortByUnreadMenuitem&quot; type=&quot;radio&quot; name=&quot;sortby&quot; label=&quot;&amp;sortByUnreadCmd.label;&quot;  accesskey=&quot;&amp;sortByUnreadCmd.accesskey;&quot; oncommand=&quot;MsgSortThreadPane('byUnread')&quot;/&gt;</span>
<a href="#l6.39"></a><span id="l6.39">             &lt;menuitem id=&quot;sortByTagsMenuitem&quot; type=&quot;radio&quot; name=&quot;sortby&quot; label=&quot;&amp;sortByTagsCmd.label;&quot; accesskey=&quot;&amp;sortByTagsCmd.accesskey;&quot; oncommand=&quot;MsgSortThreadPane('byTags')&quot;/&gt;</span>
<a href="#l6.40"></a><span id="l6.40">             &lt;menuitem id=&quot;sortByJunkStatusMenuitem&quot; type=&quot;radio&quot; name=&quot;sortby&quot; label=&quot;&amp;sortByJunkStatusCmd.label;&quot; accesskey=&quot;&amp;sortByJunkStatusCmd.accesskey;&quot; oncommand=&quot;MsgSortThreadPane('byJunkStatus')&quot;/&gt;</span>
<a href="#l6.41"></a><span id="l6.41">             &lt;menuitem id=&quot;sortByAttachmentsMenuitem&quot; type=&quot;radio&quot; name=&quot;sortby&quot; label=&quot;&amp;sortByAttachmentsCmd.label;&quot; accesskey=&quot;&amp;sortByAttachmentsCmd.accesskey;&quot; oncommand=&quot;MsgSortThreadPane('byAttachments')&quot;/&gt;</span>
<a href="#l6.42"></a><span id="l6.42">             &lt;menuseparator id=&quot;sortAfterAttachmentSeparator&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/base/content/messenger.css</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/base/content/messenger.css</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -243,20 +243,16 @@ tabmail {</span>
<a href="#l7.4"></a><span id="l7.4"> menupopup[type=&quot;folder&quot;] {</span>
<a href="#l7.5"></a><span id="l7.5">   -moz-binding: url(&quot;chrome://messenger/content/folderWidgets.xml#folder-menupopup&quot;);</span>
<a href="#l7.6"></a><span id="l7.6"> }</span>
<a href="#l7.7"></a><span id="l7.7"> </span>
<a href="#l7.8"></a><span id="l7.8"> .addrbooksPopup {</span>
<a href="#l7.9"></a><span id="l7.9">   -moz-binding: url(&quot;chrome://messenger/content/addressbook/addrbookWidgets.xml#addrbooks-menupopup&quot;);</span>
<a href="#l7.10"></a><span id="l7.10"> }</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-#threadCols &gt; treecolpicker {</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-  -moz-binding: url(&quot;chrome://messenger/content/threadPaneColumnPicker.xml#threadPaneColumnPicker&quot;);</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-}</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineminus">-</span>
<a href="#l7.16"></a><span id="l7.16"> /**</span>
<a href="#l7.17"></a><span id="l7.17">  * Toolboxes default to overflow: visible, and we need to override that to</span>
<a href="#l7.18"></a><span id="l7.18">  * prevent the toolbox from causing its containing box (the entire content</span>
<a href="#l7.19"></a><span id="l7.19">  * area) to become wider than the viewport, which has the bad side-effect of</span>
<a href="#l7.20"></a><span id="l7.20">  * causing the _other_ children (i.e. tabmail, which contains important widgetry</span>
<a href="#l7.21"></a><span id="l7.21">  * like the message scrollbar) to be rendered out of view.</span>
<a href="#l7.22"></a><span id="l7.22">  *</span>
<a href="#l7.23"></a><span id="l7.23">  * As it turns out, we only need to override the mail-bar3 (at least of</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/base/content/messenger.xul</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/base/content/messenger.xul</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -490,16 +490,19 @@</span>
<a href="#l8.4"></a><span id="l8.4">                         &lt;treecol id=&quot;senderCol&quot; persist=&quot;width&quot; flex=&quot;4&quot;</span>
<a href="#l8.5"></a><span id="l8.5">                                  hidden=&quot;false&quot; swappedhidden=&quot;true&quot;</span>
<a href="#l8.6"></a><span id="l8.6">                                  label=&quot;&amp;fromColumn.label;&quot; tooltiptext=&quot;&amp;fromColumn2.tooltip;&quot;/&gt;</span>
<a href="#l8.7"></a><span id="l8.7">                         &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l8.8"></a><span id="l8.8">                         &lt;treecol id=&quot;recipientCol&quot; persist=&quot;width&quot; flex=&quot;4&quot;</span>
<a href="#l8.9"></a><span id="l8.9">                                  hidden=&quot;true&quot; swappedhidden=&quot;false&quot;</span>
<a href="#l8.10"></a><span id="l8.10">                                  label=&quot;&amp;recipientColumn.label;&quot; tooltiptext=&quot;&amp;recipientColumn2.tooltip;&quot;/&gt;</span>
<a href="#l8.11"></a><span id="l8.11">                         &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+                        &lt;treecol id=&quot;correspondentCol&quot; persist=&quot;width&quot; flex=&quot;4&quot; hidden=&quot;true&quot;</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+                                 label=&quot;&amp;correspondentColumn.label;&quot; tooltiptext=&quot;&amp;correspondentColumn2.tooltip;&quot;/&gt;</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+                        &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l8.15"></a><span id="l8.15">                         &lt;treecol id=&quot;junkStatusCol&quot; persist=&quot;width&quot; fixed=&quot;true&quot; cycler=&quot;true&quot;</span>
<a href="#l8.16"></a><span id="l8.16">                                  class=&quot;treecol-image junkStatusHeader&quot;</span>
<a href="#l8.17"></a><span id="l8.17">                                  label=&quot;&amp;junkStatusColumn.label;&quot; tooltiptext=&quot;&amp;junkStatusColumn2.tooltip;&quot;/&gt;</span>
<a href="#l8.18"></a><span id="l8.18">                         &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l8.19"></a><span id="l8.19">                         &lt;treecol id=&quot;receivedCol&quot; persist=&quot;width temphidden&quot; flex=&quot;2&quot; hidden=&quot;true&quot;</span>
<a href="#l8.20"></a><span id="l8.20">                                  label=&quot;&amp;receivedColumn.label;&quot; tooltiptext=&quot;&amp;receivedColumn2.tooltip;&quot;/&gt;</span>
<a href="#l8.21"></a><span id="l8.21">                         &lt;splitter class=&quot;tree-splitter&quot;/&gt;</span>
<a href="#l8.22"></a><span id="l8.22">                         &lt;treecol id=&quot;dateCol&quot; persist=&quot;width&quot; flex=&quot;2&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mail/base/content/tabmail.css</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mail/base/content/tabmail.css</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -59,8 +59,17 @@</span>
<a href="#l9.4"></a><span id="l9.4"> .tab-throbber[thinking] + .tab-icon-image,</span>
<a href="#l9.5"></a><span id="l9.5"> .tab-throbber[busy][thinking] + .tab-icon-image {</span>
<a href="#l9.6"></a><span id="l9.6">   display: none;</span>
<a href="#l9.7"></a><span id="l9.7"> }</span>
<a href="#l9.8"></a><span id="l9.8"> </span>
<a href="#l9.9"></a><span id="l9.9"> #tabcontainer:not([overflow=&quot;true&quot;]) ~ #alltabs-button {</span>
<a href="#l9.10"></a><span id="l9.10">   visibility: collapse;</span>
<a href="#l9.11"></a><span id="l9.11"> }</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+/**</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+ * Override the thread pane column picker.</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+ * We do it here because we don't want it in the Search dialog.</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineplus">+ */</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineplus">+</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineplus">+#threadCols &gt; treecolpicker {</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+  -moz-binding: url(&quot;chrome://messenger/content/threadPaneColumnPicker.xml#threadPaneColumnPicker&quot;);</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mail/base/content/threadPane.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mail/base/content/threadPane.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -70,17 +70,18 @@ function HandleColumnClick(columnID)</span>
<a href="#l10.4"></a><span id="l10.4">                      statusCol: 'byStatus',</span>
<a href="#l10.5"></a><span id="l10.5">                      sizeCol: 'bySize',</span>
<a href="#l10.6"></a><span id="l10.6">                      priorityCol: 'byPriority',</span>
<a href="#l10.7"></a><span id="l10.7">                      flaggedCol: 'byFlagged',</span>
<a href="#l10.8"></a><span id="l10.8">                      threadCol: 'byThread',</span>
<a href="#l10.9"></a><span id="l10.9">                      tagsCol: 'byTags',</span>
<a href="#l10.10"></a><span id="l10.10">                      junkStatusCol: 'byJunkStatus',</span>
<a href="#l10.11"></a><span id="l10.11">                      idCol: 'byId',</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-                     attachmentCol: 'byAttachments'};</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+                     attachmentCol: 'byAttachments',</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+                     correspondentCol: 'byCorrespondent'};</span>
<a href="#l10.15"></a><span id="l10.15"> </span>
<a href="#l10.16"></a><span id="l10.16"> </span>
<a href="#l10.17"></a><span id="l10.17">   var sortType;</span>
<a href="#l10.18"></a><span id="l10.18">   if (columnID in columnMap) {</span>
<a href="#l10.19"></a><span id="l10.19">     sortType = columnMap[columnID];</span>
<a href="#l10.20"></a><span id="l10.20">   } else {</span>
<a href="#l10.21"></a><span id="l10.21">     // If the column isn't in the map, check and see if it's a custom column</span>
<a href="#l10.22"></a><span id="l10.22">     try {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mail/base/modules/dbViewWrapper.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mail/base/modules/dbViewWrapper.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -1357,16 +1357,21 @@ DBViewWrapper.prototype = {</span>
<a href="#l11.4"></a><span id="l11.4">                    (this.displayedFolder.flags &amp; nsMsgFolderFlags.Mail));</span>
<a href="#l11.5"></a><span id="l11.5">   },</span>
<a href="#l11.6"></a><span id="l11.6"> </span>
<a href="#l11.7"></a><span id="l11.7">   get isNewsFolder() {</span>
<a href="#l11.8"></a><span id="l11.8">     return Boolean(this.displayedFolder &amp;&amp;</span>
<a href="#l11.9"></a><span id="l11.9">                    (this.displayedFolder.flags &amp; nsMsgFolderFlags.Newsgroup));</span>
<a href="#l11.10"></a><span id="l11.10">   },</span>
<a href="#l11.11"></a><span id="l11.11"> </span>
<a href="#l11.12"></a><span id="l11.12" class="difflineplus">+  get isFeedFolder() {</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+    return Boolean(this.displayedFolder &amp;&amp;</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineplus">+                   this.displayedFolder.server.type == &quot;rss&quot;);</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineplus">+  },</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineplus">+</span>
<a href="#l11.17"></a><span id="l11.17">   OUTGOING_FOLDER_FLAGS: nsMsgFolderFlags.SentMail |</span>
<a href="#l11.18"></a><span id="l11.18">                          nsMsgFolderFlags.Drafts |</span>
<a href="#l11.19"></a><span id="l11.19">                          nsMsgFolderFlags.Queue |</span>
<a href="#l11.20"></a><span id="l11.20">                          nsMsgFolderFlags.Templates,</span>
<a href="#l11.21"></a><span id="l11.21">   /**</span>
<a href="#l11.22"></a><span id="l11.22">    * @return true if the folder is an outgoing folder by virtue of being a</span>
<a href="#l11.23"></a><span id="l11.23">    *     sent mail folder, drafts folder, queue folder, or template folder,</span>
<a href="#l11.24"></a><span id="l11.24">    *     or being a sub-folder of one of those types of folders.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/SearchDialog.dtd</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/SearchDialog.dtd</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -35,16 +35,17 @@</span>
<a href="#l12.4"></a><span id="l12.4"> &lt;!ENTITY deleteCardButton.label      &quot;Delete&quot;&gt;</span>
<a href="#l12.5"></a><span id="l12.5"> &lt;!ENTITY deleteCardButton.accesskey  &quot;D&quot;&gt;</span>
<a href="#l12.6"></a><span id="l12.6"> &lt;!ENTITY abSearchDialogTitle.label   &quot;Advanced Address Book Search&quot;&gt;</span>
<a href="#l12.7"></a><span id="l12.7"> </span>
<a href="#l12.8"></a><span id="l12.8"> &lt;!-- Thread Pane --&gt;</span>
<a href="#l12.9"></a><span id="l12.9"> &lt;!ENTITY threadColumn.label &quot;Thread&quot;&gt;</span>
<a href="#l12.10"></a><span id="l12.10"> &lt;!ENTITY fromColumn.label &quot;From&quot;&gt;</span>
<a href="#l12.11"></a><span id="l12.11"> &lt;!ENTITY recipientColumn.label &quot;Recipient&quot;&gt;</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineplus">+&lt;!ENTITY correspondentColumn.label &quot;Correspondents&quot;&gt;</span>
<a href="#l12.13"></a><span id="l12.13"> &lt;!ENTITY subjectColumn.label &quot;Subject&quot;&gt;</span>
<a href="#l12.14"></a><span id="l12.14"> &lt;!ENTITY dateColumn.label &quot;Date&quot;&gt;</span>
<a href="#l12.15"></a><span id="l12.15"> &lt;!ENTITY priorityColumn.label &quot;Priority&quot;&gt;</span>
<a href="#l12.16"></a><span id="l12.16"> &lt;!ENTITY tagsColumn.label &quot;Tags&quot;&gt;</span>
<a href="#l12.17"></a><span id="l12.17"> &lt;!ENTITY accountColumn.label &quot;Account&quot;&gt;</span>
<a href="#l12.18"></a><span id="l12.18"> &lt;!ENTITY statusColumn.label &quot;Status&quot;&gt;</span>
<a href="#l12.19"></a><span id="l12.19"> &lt;!ENTITY sizeColumn.label &quot;Size&quot;&gt;</span>
<a href="#l12.20"></a><span id="l12.20"> &lt;!ENTITY junkStatusColumn.label &quot;Junk Status&quot;&gt;</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineat">@@ -56,16 +57,17 @@</span>
<a href="#l12.22"></a><span id="l12.22"> &lt;!ENTITY locationColumn.label &quot;Location&quot;&gt;</span>
<a href="#l12.23"></a><span id="l12.23"> &lt;!ENTITY idColumn.label &quot;Order Received&quot;&gt;</span>
<a href="#l12.24"></a><span id="l12.24"> </span>
<a href="#l12.25"></a><span id="l12.25"> &lt;!-- Thread Pane Tooltips --&gt;</span>
<a href="#l12.26"></a><span id="l12.26"> &lt;!ENTITY columnChooser2.tooltip &quot;Select columns to display&quot;&gt;</span>
<a href="#l12.27"></a><span id="l12.27"> &lt;!ENTITY threadColumn2.tooltip &quot;Display message threads&quot;&gt;</span>
<a href="#l12.28"></a><span id="l12.28"> &lt;!ENTITY fromColumn2.tooltip &quot;Sort by from&quot;&gt;</span>
<a href="#l12.29"></a><span id="l12.29"> &lt;!ENTITY recipientColumn2.tooltip &quot;Sort by recipient&quot;&gt;</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineplus">+&lt;!ENTITY correspondentColumn2.tooltip &quot;Sort by correspondents&quot;&gt;</span>
<a href="#l12.31"></a><span id="l12.31"> &lt;!ENTITY subjectColumn2.tooltip &quot;Sort by subject&quot;&gt;</span>
<a href="#l12.32"></a><span id="l12.32"> &lt;!ENTITY dateColumn2.tooltip &quot;Sort by date&quot;&gt;</span>
<a href="#l12.33"></a><span id="l12.33"> &lt;!ENTITY priorityColumn2.tooltip &quot;Sort by priority&quot;&gt;</span>
<a href="#l12.34"></a><span id="l12.34"> &lt;!ENTITY tagsColumn2.tooltip &quot;Sort by tags&quot;&gt;</span>
<a href="#l12.35"></a><span id="l12.35"> &lt;!ENTITY accountColumn2.tooltip &quot;Sort by account&quot;&gt;</span>
<a href="#l12.36"></a><span id="l12.36"> &lt;!ENTITY statusColumn2.tooltip &quot;Sort by status&quot;&gt;</span>
<a href="#l12.37"></a><span id="l12.37"> &lt;!ENTITY sizeColumn2.tooltip &quot;Sort by size&quot;&gt;</span>
<a href="#l12.38"></a><span id="l12.38"> &lt;!ENTITY junkStatusColumn2.tooltip &quot;Sort by junk status&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -187,16 +187,18 @@</span>
<a href="#l13.4"></a><span id="l13.4"> &lt;!ENTITY sortByJunkStatusCmd.label &quot;Junk Status&quot;&gt;</span>
<a href="#l13.5"></a><span id="l13.5"> &lt;!ENTITY sortByJunkStatusCmd.accesskey &quot;J&quot;&gt;</span>
<a href="#l13.6"></a><span id="l13.6"> &lt;!ENTITY sortBySubjectCmd.label &quot;Subject&quot;&gt;</span>
<a href="#l13.7"></a><span id="l13.7"> &lt;!ENTITY sortBySubjectCmd.accesskey &quot;b&quot;&gt;</span>
<a href="#l13.8"></a><span id="l13.8"> &lt;!ENTITY sortByFromCmd.label &quot;From&quot;&gt;</span>
<a href="#l13.9"></a><span id="l13.9"> &lt;!ENTITY sortByFromCmd.accesskey &quot;F&quot;&gt;</span>
<a href="#l13.10"></a><span id="l13.10"> &lt;!ENTITY sortByRecipientCmd.label &quot;Recipient&quot;&gt;</span>
<a href="#l13.11"></a><span id="l13.11"> &lt;!ENTITY sortByRecipientCmd.accesskey &quot;c&quot;&gt;</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+&lt;!ENTITY sortByCorrespondentCmd.label &quot;Correspondents&quot;&gt;</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+&lt;!ENTITY sortByCorrespondentCmd.accesskey &quot;e&quot;&gt;</span>
<a href="#l13.14"></a><span id="l13.14"> &lt;!ENTITY sortByUnreadCmd.label &quot;Read&quot;&gt;</span>
<a href="#l13.15"></a><span id="l13.15"> &lt;!ENTITY sortByUnreadCmd.accesskey &quot;R&quot;&gt;</span>
<a href="#l13.16"></a><span id="l13.16"> &lt;!ENTITY sortByOrderReceivedCmd.label &quot;Order Received&quot;&gt;</span>
<a href="#l13.17"></a><span id="l13.17"> &lt;!ENTITY sortByOrderReceivedCmd.accesskey &quot;O&quot;&gt;</span>
<a href="#l13.18"></a><span id="l13.18"> &lt;!ENTITY sortAscending.label &quot;Ascending&quot;&gt;</span>
<a href="#l13.19"></a><span id="l13.19"> &lt;!ENTITY sortAscending.accesskey &quot;A&quot;&gt;</span>
<a href="#l13.20"></a><span id="l13.20"> &lt;!ENTITY sortDescending.label &quot;Descending&quot;&gt;</span>
<a href="#l13.21"></a><span id="l13.21"> &lt;!ENTITY sortDescending.accesskey &quot;D&quot;&gt;</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineat">@@ -653,16 +655,17 @@</span>
<a href="#l13.23"></a><span id="l13.23"> &lt;!ENTITY searchSubjectOrRecipientMenu.label &quot;Subject, To or Cc&quot;&gt;</span>
<a href="#l13.24"></a><span id="l13.24"> &lt;!ENTITY searchMessageBody.label &quot;Entire Message&quot;&gt;</span>
<a href="#l13.25"></a><span id="l13.25"> &lt;!ENTITY saveAsVirtualFolderMenu.label &quot;Save Search as a Folder&quot;&gt;</span>
<a href="#l13.26"></a><span id="l13.26"> </span>
<a href="#l13.27"></a><span id="l13.27"> &lt;!-- Thread Pane --&gt;</span>
<a href="#l13.28"></a><span id="l13.28"> &lt;!ENTITY threadColumn.label &quot;Thread&quot;&gt;</span>
<a href="#l13.29"></a><span id="l13.29"> &lt;!ENTITY fromColumn.label &quot;From&quot;&gt;</span>
<a href="#l13.30"></a><span id="l13.30"> &lt;!ENTITY recipientColumn.label &quot;Recipient&quot;&gt;</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineplus">+&lt;!ENTITY correspondentColumn.label &quot;Correspondents&quot;&gt;</span>
<a href="#l13.32"></a><span id="l13.32"> &lt;!ENTITY subjectColumn.label &quot;Subject&quot;&gt;</span>
<a href="#l13.33"></a><span id="l13.33"> &lt;!ENTITY dateColumn.label &quot;Date&quot;&gt;</span>
<a href="#l13.34"></a><span id="l13.34"> &lt;!ENTITY priorityColumn.label &quot;Priority&quot;&gt;</span>
<a href="#l13.35"></a><span id="l13.35"> &lt;!ENTITY tagsColumn.label &quot;Tag&quot;&gt;</span>
<a href="#l13.36"></a><span id="l13.36"> &lt;!ENTITY accountColumn.label &quot;Account&quot;&gt;</span>
<a href="#l13.37"></a><span id="l13.37"> &lt;!ENTITY statusColumn.label &quot;Status&quot;&gt;</span>
<a href="#l13.38"></a><span id="l13.38"> &lt;!ENTITY sizeColumn.label &quot;Size&quot;&gt;</span>
<a href="#l13.39"></a><span id="l13.39"> &lt;!ENTITY junkStatusColumn.label &quot;Junk Status&quot;&gt;</span>
<a href="#l13.40"></a><span id="l13.40" class="difflineat">@@ -675,16 +678,17 @@</span>
<a href="#l13.41"></a><span id="l13.41"> &lt;!ENTITY idColumn.label &quot;Order Received&quot;&gt;</span>
<a href="#l13.42"></a><span id="l13.42"> &lt;!ENTITY attachmentColumn.label &quot;Attachments&quot;&gt;</span>
<a href="#l13.43"></a><span id="l13.43"> </span>
<a href="#l13.44"></a><span id="l13.44"> &lt;!-- Thread Pane Tooltips --&gt;</span>
<a href="#l13.45"></a><span id="l13.45"> &lt;!ENTITY columnChooser2.tooltip &quot;Select columns to display&quot;&gt;</span>
<a href="#l13.46"></a><span id="l13.46"> &lt;!ENTITY threadColumn2.tooltip &quot;Display message threads&quot;&gt;</span>
<a href="#l13.47"></a><span id="l13.47"> &lt;!ENTITY fromColumn2.tooltip &quot;Sort by from&quot;&gt;</span>
<a href="#l13.48"></a><span id="l13.48"> &lt;!ENTITY recipientColumn2.tooltip &quot;Sort by recipient&quot;&gt;</span>
<a href="#l13.49"></a><span id="l13.49" class="difflineplus">+&lt;!ENTITY correspondentColumn2.tooltip &quot;Sort by correspondents&quot;&gt;</span>
<a href="#l13.50"></a><span id="l13.50"> &lt;!ENTITY subjectColumn2.tooltip &quot;Sort by subject&quot;&gt;</span>
<a href="#l13.51"></a><span id="l13.51"> &lt;!ENTITY dateColumn2.tooltip &quot;Sort by date&quot;&gt;</span>
<a href="#l13.52"></a><span id="l13.52"> &lt;!ENTITY priorityColumn2.tooltip &quot;Sort by priority&quot;&gt;</span>
<a href="#l13.53"></a><span id="l13.53"> &lt;!ENTITY tagsColumn2.tooltip &quot;Sort by tags&quot;&gt;</span>
<a href="#l13.54"></a><span id="l13.54"> &lt;!ENTITY accountColumn2.tooltip &quot;Sort by account&quot;&gt;</span>
<a href="#l13.55"></a><span id="l13.55"> &lt;!ENTITY statusColumn2.tooltip &quot;Sort by status&quot;&gt;</span>
<a href="#l13.56"></a><span id="l13.56"> &lt;!ENTITY sizeColumn2.tooltip &quot;Sort by size&quot;&gt;</span>
<a href="#l13.57"></a><span id="l13.57"> &lt;!ENTITY junkStatusColumn2.tooltip &quot;Sort by junk status&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-columns.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-columns.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -101,17 +101,17 @@ function reorder_column(aColumnId, aBefo</span>
<a href="#l14.4"></a><span id="l14.4"> }</span>
<a href="#l14.5"></a><span id="l14.5"> </span>
<a href="#l14.6"></a><span id="l14.6"> var INBOX_DEFAULTS = [</span>
<a href="#l14.7"></a><span id="l14.7">   &quot;threadCol&quot;,</span>
<a href="#l14.8"></a><span id="l14.8">   &quot;flaggedCol&quot;,</span>
<a href="#l14.9"></a><span id="l14.9">   &quot;attachmentCol&quot;,</span>
<a href="#l14.10"></a><span id="l14.10">   &quot;subjectCol&quot;,</span>
<a href="#l14.11"></a><span id="l14.11">   &quot;unreadButtonColHeader&quot;,</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-  &quot;senderCol&quot;,</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+  &quot;correspondentCol&quot;,</span>
<a href="#l14.14"></a><span id="l14.14">   &quot;junkStatusCol&quot;,</span>
<a href="#l14.15"></a><span id="l14.15">   &quot;dateCol&quot;</span>
<a href="#l14.16"></a><span id="l14.16"> ];</span>
<a href="#l14.17"></a><span id="l14.17"> </span>
<a href="#l14.18"></a><span id="l14.18"> /**</span>
<a href="#l14.19"></a><span id="l14.19">  * Make sure we set the proper defaults for an Inbox.</span>
<a href="#l14.20"></a><span id="l14.20">  */</span>
<a href="#l14.21"></a><span id="l14.21"> function test_column_defaults_inbox() {</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineat">@@ -144,17 +144,17 @@ function test_column_defaults_sent() {</span>
<a href="#l14.23"></a><span id="l14.23"> }</span>
<a href="#l14.24"></a><span id="l14.24"> </span>
<a href="#l14.25"></a><span id="l14.25"> var VIRTUAL_DEFAULTS = [</span>
<a href="#l14.26"></a><span id="l14.26">   &quot;threadCol&quot;,</span>
<a href="#l14.27"></a><span id="l14.27">   &quot;flaggedCol&quot;,</span>
<a href="#l14.28"></a><span id="l14.28">   &quot;attachmentCol&quot;,</span>
<a href="#l14.29"></a><span id="l14.29">   &quot;subjectCol&quot;,</span>
<a href="#l14.30"></a><span id="l14.30">   &quot;unreadButtonColHeader&quot;,</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineminus">-  &quot;senderCol&quot;,</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+  &quot;correspondentCol&quot;,</span>
<a href="#l14.33"></a><span id="l14.33">   &quot;junkStatusCol&quot;,</span>
<a href="#l14.34"></a><span id="l14.34">   &quot;dateCol&quot;,</span>
<a href="#l14.35"></a><span id="l14.35">   &quot;locationCol&quot;</span>
<a href="#l14.36"></a><span id="l14.36"> ];</span>
<a href="#l14.37"></a><span id="l14.37"> </span>
<a href="#l14.38"></a><span id="l14.38"> /**</span>
<a href="#l14.39"></a><span id="l14.39">  * Make sure we set the proper defaults for a multi-folder virtual folder.</span>
<a href="#l14.40"></a><span id="l14.40">  */</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineat">@@ -301,21 +301,21 @@ function test_column_visibility_persists</span>
<a href="#l14.42"></a><span id="l14.42"> </span>
<a href="#l14.43"></a><span id="l14.43"> /**</span>
<a href="#l14.44"></a><span id="l14.44">  * Test that reordering persists through tab changes and folder changes.</span>
<a href="#l14.45"></a><span id="l14.45">  */</span>
<a href="#l14.46"></a><span id="l14.46"> function test_column_reordering_persists() {</span>
<a href="#l14.47"></a><span id="l14.47">   let tabA = be_in_folder(folderA);</span>
<a href="#l14.48"></a><span id="l14.48">   let tabB = open_folder_in_new_tab(folderB);</span>
<a href="#l14.49"></a><span id="l14.49"> </span>
<a href="#l14.50"></a><span id="l14.50" class="difflineminus">-  // put sender before subject</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineminus">-  reorder_column(&quot;senderCol&quot;, &quot;subjectCol&quot;);</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineplus">+  // put correspondent before subject</span>
<a href="#l14.53"></a><span id="l14.53" class="difflineplus">+  reorder_column(&quot;correspondentCol&quot;, &quot;subjectCol&quot;);</span>
<a href="#l14.54"></a><span id="l14.54">   let reorderdB = columnsB.concat();</span>
<a href="#l14.55"></a><span id="l14.55">   reorderdB.splice(5, 1);</span>
<a href="#l14.56"></a><span id="l14.56" class="difflineminus">-  reorderdB.splice(3, 0, &quot;senderCol&quot;);</span>
<a href="#l14.57"></a><span id="l14.57" class="difflineplus">+  reorderdB.splice(3, 0, &quot;correspondentCol&quot;);</span>
<a href="#l14.58"></a><span id="l14.58">   assert_visible_columns(reorderdB);</span>
<a href="#l14.59"></a><span id="l14.59"> </span>
<a href="#l14.60"></a><span id="l14.60">   switch_tab(tabA);</span>
<a href="#l14.61"></a><span id="l14.61">   assert_visible_columns(INBOX_DEFAULTS);</span>
<a href="#l14.62"></a><span id="l14.62"> </span>
<a href="#l14.63"></a><span id="l14.63">   switch_tab(tabB);</span>
<a href="#l14.64"></a><span id="l14.64">   assert_visible_columns(reorderdB);</span>
<a href="#l14.65"></a><span id="l14.65"> </span>
<a href="#l14.66"></a><span id="l14.66" class="difflineat">@@ -450,17 +450,17 @@ function test_apply_to_folder_and_childr</span>
<a href="#l14.67"></a><span id="l14.67">   assert_visible_columns(conExtra);</span>
<a href="#l14.68"></a><span id="l14.68"> }</span>
<a href="#l14.69"></a><span id="l14.69"> test_apply_to_folder_and_children.EXCLUDED_PLATFORMS = [&quot;linux&quot;];</span>
<a href="#l14.70"></a><span id="l14.70"> </span>
<a href="#l14.71"></a><span id="l14.71"> var GLODA_DEFAULTS = [</span>
<a href="#l14.72"></a><span id="l14.72">   &quot;threadCol&quot;,</span>
<a href="#l14.73"></a><span id="l14.73">   &quot;flaggedCol&quot;,</span>
<a href="#l14.74"></a><span id="l14.74">   &quot;subjectCol&quot;,</span>
<a href="#l14.75"></a><span id="l14.75" class="difflineminus">-  &quot;senderCol&quot;,</span>
<a href="#l14.76"></a><span id="l14.76" class="difflineplus">+  &quot;correspondentCol&quot;,</span>
<a href="#l14.77"></a><span id="l14.77">   &quot;dateCol&quot;,</span>
<a href="#l14.78"></a><span id="l14.78">   &quot;locationCol&quot;</span>
<a href="#l14.79"></a><span id="l14.79"> ];</span>
<a href="#l14.80"></a><span id="l14.80"> </span>
<a href="#l14.81"></a><span id="l14.81"> /**</span>
<a href="#l14.82"></a><span id="l14.82">  * Create a fake gloda collection.</span>
<a href="#l14.83"></a><span id="l14.83">  */</span>
<a href="#l14.84"></a><span id="l14.84"> function FakeCollection() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mail/themes/linux/mail/mailWindow1.css</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mail/themes/linux/mail/mailWindow1.css</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -183,16 +183,30 @@ treechildren::-moz-tree-image(junkStatus</span>
<a href="#l15.4"></a><span id="l15.4">   -moz-image-region: rect(32px 16px 48px 0px); /* message-junk.png */</span>
<a href="#l15.5"></a><span id="l15.5"> }</span>
<a href="#l15.6"></a><span id="l15.6"> </span>
<a href="#l15.7"></a><span id="l15.7"> treechildren::-moz-tree-image(junkStatusCol, notjunk) {</span>
<a href="#l15.8"></a><span id="l15.8">   -moz-image-region: rect(0px 16px 16px 0px); /* message-read.png */</span>
<a href="#l15.9"></a><span id="l15.9">   -moz-padding-start: 0px;</span>
<a href="#l15.10"></a><span id="l15.10"> }</span>
<a href="#l15.11"></a><span id="l15.11"> </span>
<a href="#l15.12"></a><span id="l15.12" class="difflineplus">+/* ..... correspondent column ..... */</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineplus">+treechildren::-moz-tree-image(correspondentCol, incoming) {</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineplus">+  -moz-margin-end: 2px;</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineplus">+  list-style-image: url(&quot;chrome://messenger/skin/icons/message.png&quot;);</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineplus">+  -moz-image-region: rect(0 112px 16px 96px);</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineplus">+}</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineplus">+</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineplus">+treechildren::-moz-tree-image(correspondentCol, outgoing) {</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineplus">+  -moz-margin-end: 2px;</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineplus">+  list-style-image: url(&quot;chrome://messenger/skin/icons/message.png&quot;);</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineplus">+  -moz-image-region: rect(0 128px 16px 112px);</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineplus">+}</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineplus">+</span>
<a href="#l15.26"></a><span id="l15.26"> /* ..... subject column ..... */</span>
<a href="#l15.27"></a><span id="l15.27"> </span>
<a href="#l15.28"></a><span id="l15.28"> #subjectCol {</span>
<a href="#l15.29"></a><span id="l15.29">   -moz-padding-start: 16px;</span>
<a href="#l15.30"></a><span id="l15.30"> }</span>
<a href="#l15.31"></a><span id="l15.31"> </span>
<a href="#l15.32"></a><span id="l15.32"> #subjectCol[primary=&quot;true&quot;] {</span>
<a href="#l15.33"></a><span id="l15.33">   -moz-padding-start: 26px;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mail/themes/osx/mail/mailWindow1.css</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mail/themes/osx/mail/mailWindow1.css</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -275,16 +275,36 @@ treechildren::-moz-tree-image(junkStatus</span>
<a href="#l16.4"></a><span id="l16.4">   -moz-image-region: rect(0px 96px 16px 80px);</span>
<a href="#l16.5"></a><span id="l16.5">   -moz-margin-start: 0px;</span>
<a href="#l16.6"></a><span id="l16.6"> }</span>
<a href="#l16.7"></a><span id="l16.7"> </span>
<a href="#l16.8"></a><span id="l16.8"> treechildren::-moz-tree-image(junkStatusCol, junk, focus, selected) {</span>
<a href="#l16.9"></a><span id="l16.9">   -moz-image-region: rect(16px 96px 32px 80px);</span>
<a href="#l16.10"></a><span id="l16.10"> }</span>
<a href="#l16.11"></a><span id="l16.11"> </span>
<a href="#l16.12"></a><span id="l16.12" class="difflineplus">+/* ..... correspondent column ..... */</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineplus">+treechildren::-moz-tree-image(correspondentCol, incoming) {</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineplus">+  list-style-image: url(&quot;chrome://messenger/skin/icons/threadpane-col.png&quot;);</span>
<a href="#l16.16"></a><span id="l16.16" class="difflineplus">+  -moz-image-region: rect(0px 107px 16px 96px);</span>
<a href="#l16.17"></a><span id="l16.17" class="difflineplus">+}</span>
<a href="#l16.18"></a><span id="l16.18" class="difflineplus">+</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineplus">+treechildren::-moz-tree-image(correspondentCol, incoming, selected) {</span>
<a href="#l16.20"></a><span id="l16.20" class="difflineplus">+  -moz-image-region: rect(16px 107px 32px 96px);</span>
<a href="#l16.21"></a><span id="l16.21" class="difflineplus">+}</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineplus">+</span>
<a href="#l16.23"></a><span id="l16.23" class="difflineplus">+treechildren::-moz-tree-image(correspondentCol, outgoing) {</span>
<a href="#l16.24"></a><span id="l16.24" class="difflineplus">+  list-style-image: url(&quot;chrome://messenger/skin/icons/threadpane-col.png&quot;);</span>
<a href="#l16.25"></a><span id="l16.25" class="difflineplus">+  -moz-image-region: rect(0px 118px 16px 107px);</span>
<a href="#l16.26"></a><span id="l16.26" class="difflineplus">+}</span>
<a href="#l16.27"></a><span id="l16.27" class="difflineplus">+</span>
<a href="#l16.28"></a><span id="l16.28" class="difflineplus">+treechildren::-moz-tree-image(correspondentCol, outgoing, selected) {</span>
<a href="#l16.29"></a><span id="l16.29" class="difflineplus">+  -moz-image-region: rect(16px 118px 32px 107px);</span>
<a href="#l16.30"></a><span id="l16.30" class="difflineplus">+}</span>
<a href="#l16.31"></a><span id="l16.31" class="difflineplus">+</span>
<a href="#l16.32"></a><span id="l16.32"> /* ..... subject column ..... */</span>
<a href="#l16.33"></a><span id="l16.33"> </span>
<a href="#l16.34"></a><span id="l16.34"> #subjectCol {</span>
<a href="#l16.35"></a><span id="l16.35">   -moz-padding-start: 13px;</span>
<a href="#l16.36"></a><span id="l16.36"> }</span>
<a href="#l16.37"></a><span id="l16.37"> </span>
<a href="#l16.38"></a><span id="l16.38"> #subjectCol[primary=&quot;true&quot;] {</span>
<a href="#l16.39"></a><span id="l16.39">   -moz-padding-start: 30px;</span>
<a href="#l16.40"></a><span id="l16.40" class="difflineat">@@ -442,23 +462,42 @@ treechildren::-moz-tree-image(threadCol,</span>
<a href="#l16.41"></a><span id="l16.41">     -moz-image-region: rect(32px 192px 64px 160px);</span>
<a href="#l16.42"></a><span id="l16.42">   }</span>
<a href="#l16.43"></a><span id="l16.43"> </span>
<a href="#l16.44"></a><span id="l16.44">   .tree-columnpicker-icon {</span>
<a href="#l16.45"></a><span id="l16.45">     list-style-image: url(&quot;chrome://messenger/skin/icons/column-headers@2x.png&quot;);</span>
<a href="#l16.46"></a><span id="l16.46">     -moz-image-region: rect(0px 192px 32px 160px);</span>
<a href="#l16.47"></a><span id="l16.47">   }</span>
<a href="#l16.48"></a><span id="l16.48"> </span>
<a href="#l16.49"></a><span id="l16.49" class="difflineplus">+  treechildren::-moz-tree-image(correspondentCol, incoming) {</span>
<a href="#l16.50"></a><span id="l16.50" class="difflineplus">+    list-style-image: url(&quot;chrome://messenger/skin/icons/threadpane-col@2x.png&quot;);</span>
<a href="#l16.51"></a><span id="l16.51" class="difflineplus">+    -moz-image-region: rect(0px 214px 32px 192px);</span>
<a href="#l16.52"></a><span id="l16.52" class="difflineplus">+  }</span>
<a href="#l16.53"></a><span id="l16.53" class="difflineplus">+</span>
<a href="#l16.54"></a><span id="l16.54" class="difflineplus">+  treechildren::-moz-tree-image(correspondentCol, incoming, selected) {</span>
<a href="#l16.55"></a><span id="l16.55" class="difflineplus">+    -moz-image-region: rect(32px 214px 64px 192px);</span>
<a href="#l16.56"></a><span id="l16.56" class="difflineplus">+  }</span>
<a href="#l16.57"></a><span id="l16.57" class="difflineplus">+</span>
<a href="#l16.58"></a><span id="l16.58" class="difflineplus">+  treechildren::-moz-tree-image(correspondentCol, outgoing) {</span>
<a href="#l16.59"></a><span id="l16.59" class="difflineplus">+    list-style-image: url(&quot;chrome://messenger/skin/icons/threadpane-col@2x.png&quot;);</span>
<a href="#l16.60"></a><span id="l16.60" class="difflineplus">+    -moz-image-region: rect(0px 236px 32px 214px);</span>
<a href="#l16.61"></a><span id="l16.61" class="difflineplus">+  }</span>
<a href="#l16.62"></a><span id="l16.62" class="difflineplus">+</span>
<a href="#l16.63"></a><span id="l16.63" class="difflineplus">+  treechildren::-moz-tree-image(correspondentCol, outgoing, selected) {</span>
<a href="#l16.64"></a><span id="l16.64" class="difflineplus">+    -moz-image-region: rect(32px 236px 64px 214px);</span>
<a href="#l16.65"></a><span id="l16.65" class="difflineplus">+  }</span>
<a href="#l16.66"></a><span id="l16.66" class="difflineplus">+</span>
<a href="#l16.67"></a><span id="l16.67">   .tree-columnpicker-icon,</span>
<a href="#l16.68"></a><span id="l16.68">   #threadCols &gt; treecol &gt; .treecol-icon,</span>
<a href="#l16.69"></a><span id="l16.69">   treechildren::-moz-tree-image(threadCol, container),</span>
<a href="#l16.70"></a><span id="l16.70">   treechildren::-moz-tree-image(unreadButtonColHeader),</span>
<a href="#l16.71"></a><span id="l16.71">   treechildren::-moz-tree-image(attachmentCol),</span>
<a href="#l16.72"></a><span id="l16.72">   treechildren::-moz-tree-image(flaggedCol),</span>
<a href="#l16.73"></a><span id="l16.73" class="difflineminus">-  treechildren::-moz-tree-image(junkStatusCol) {</span>
<a href="#l16.74"></a><span id="l16.74" class="difflineplus">+  treechildren::-moz-tree-image(junkStatusCol),</span>
<a href="#l16.75"></a><span id="l16.75" class="difflineplus">+  treechildren::-moz-tree-image(correspondentCol) {</span>
<a href="#l16.76"></a><span id="l16.76">     width: 16px;</span>
<a href="#l16.77"></a><span id="l16.77">     height: 16px;</span>
<a href="#l16.78"></a><span id="l16.78">   }</span>
<a href="#l16.79"></a><span id="l16.79"> </span>
<a href="#l16.80"></a><span id="l16.80">   treechildren::-moz-tree-image(unreadButtonColHeader, unread) {</span>
<a href="#l16.81"></a><span id="l16.81">     width: 13px;</span>
<a href="#l16.82"></a><span id="l16.82">     height: 13px;</span>
<a href="#l16.83"></a><span id="l16.83">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mail/themes/windows/mail/mailWindow1.css</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mail/themes/windows/mail/mailWindow1.css</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -179,16 +179,30 @@ treechildren::-moz-tree-image(junkStatus</span>
<a href="#l17.4"></a><span id="l17.4">   -moz-image-region: rect(0 128px 16px 112px);</span>
<a href="#l17.5"></a><span id="l17.5"> }</span>
<a href="#l17.6"></a><span id="l17.6"> </span>
<a href="#l17.7"></a><span id="l17.7"> treechildren::-moz-tree-image(junkStatusCol, notjunk) {</span>
<a href="#l17.8"></a><span id="l17.8">   list-style-image: url(&quot;chrome://messenger/skin/icons/readmail.png&quot;);</span>
<a href="#l17.9"></a><span id="l17.9">   -moz-padding-start: 0px;</span>
<a href="#l17.10"></a><span id="l17.10"> }</span>
<a href="#l17.11"></a><span id="l17.11"> </span>
<a href="#l17.12"></a><span id="l17.12" class="difflineplus">+/* ..... correspondent column ..... */</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineplus">+treechildren::-moz-tree-image(correspondentCol, incoming) {</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineplus">+  -moz-margin-end: 2px;</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineplus">+  list-style-image: url(&quot;chrome://messenger/skin/icons/message.png&quot;);</span>
<a href="#l17.17"></a><span id="l17.17" class="difflineplus">+  -moz-image-region: rect(0 112px 16px 96px);</span>
<a href="#l17.18"></a><span id="l17.18" class="difflineplus">+}</span>
<a href="#l17.19"></a><span id="l17.19" class="difflineplus">+</span>
<a href="#l17.20"></a><span id="l17.20" class="difflineplus">+treechildren::-moz-tree-image(correspondentCol, outgoing) {</span>
<a href="#l17.21"></a><span id="l17.21" class="difflineplus">+  -moz-margin-end: 2px;</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineplus">+  list-style-image: url(&quot;chrome://messenger/skin/icons/message.png&quot;);</span>
<a href="#l17.23"></a><span id="l17.23" class="difflineplus">+  -moz-image-region: rect(0 128px 16px 112px);</span>
<a href="#l17.24"></a><span id="l17.24" class="difflineplus">+}</span>
<a href="#l17.25"></a><span id="l17.25" class="difflineplus">+</span>
<a href="#l17.26"></a><span id="l17.26"> /* ..... subject column ..... */</span>
<a href="#l17.27"></a><span id="l17.27"> </span>
<a href="#l17.28"></a><span id="l17.28"> %ifndef WINDOWS_AERO</span>
<a href="#l17.29"></a><span id="l17.29"> #subjectCol {</span>
<a href="#l17.30"></a><span id="l17.30">   -moz-padding-start: 17px;</span>
<a href="#l17.31"></a><span id="l17.31"> }</span>
<a href="#l17.32"></a><span id="l17.32"> </span>
<a href="#l17.33"></a><span id="l17.33"> #subjectCol[primary=&quot;true&quot;] {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mailnews/base/public/nsIMsgDBView.idl</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mailnews/base/public/nsIMsgDBView.idl</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -50,17 +50,17 @@ interface nsMsgViewFlagsType</span>
<a href="#l18.4"></a><span id="l18.4">   const nsMsgViewFlagsTypeValue kNone = 0x0;</span>
<a href="#l18.5"></a><span id="l18.5">   const nsMsgViewFlagsTypeValue kThreadedDisplay = 0x1;</span>
<a href="#l18.6"></a><span id="l18.6">   const nsMsgViewFlagsTypeValue kShowIgnored = 0x8;</span>
<a href="#l18.7"></a><span id="l18.7">   const nsMsgViewFlagsTypeValue kUnreadOnly = 0x10;</span>
<a href="#l18.8"></a><span id="l18.8">   const nsMsgViewFlagsTypeValue kExpandAll = 0x20;</span>
<a href="#l18.9"></a><span id="l18.9">   const nsMsgViewFlagsTypeValue kGroupBySort = 0x40;</span>
<a href="#l18.10"></a><span id="l18.10"> };</span>
<a href="#l18.11"></a><span id="l18.11"> </span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-[scriptable, uuid(e8fdf9ca-9425-49de-b231-8d8fb51b8ee2)]</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+[scriptable, uuid(b94fc200-3008-420a-85c7-67842f133ef8)]</span>
<a href="#l18.14"></a><span id="l18.14"> interface nsMsgViewSortType</span>
<a href="#l18.15"></a><span id="l18.15"> {</span>
<a href="#l18.16"></a><span id="l18.16">   const nsMsgViewSortTypeValue byNone = 0x11; /* not sorted */</span>
<a href="#l18.17"></a><span id="l18.17">   const nsMsgViewSortTypeValue byDate = 0x12;</span>
<a href="#l18.18"></a><span id="l18.18">   const nsMsgViewSortTypeValue bySubject = 0x13;</span>
<a href="#l18.19"></a><span id="l18.19">   const nsMsgViewSortTypeValue byAuthor = 0x14;</span>
<a href="#l18.20"></a><span id="l18.20">   const nsMsgViewSortTypeValue byId = 0x15;</span>
<a href="#l18.21"></a><span id="l18.21">   const nsMsgViewSortTypeValue byThread = 0x16;</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineat">@@ -72,16 +72,17 @@ interface nsMsgViewSortType</span>
<a href="#l18.23"></a><span id="l18.23">   const nsMsgViewSortTypeValue byRecipient = 0x1c;</span>
<a href="#l18.24"></a><span id="l18.24">   const nsMsgViewSortTypeValue byLocation = 0x1d;</span>
<a href="#l18.25"></a><span id="l18.25">   const nsMsgViewSortTypeValue byTags = 0x1e;</span>
<a href="#l18.26"></a><span id="l18.26">   const nsMsgViewSortTypeValue byJunkStatus = 0x1f;</span>
<a href="#l18.27"></a><span id="l18.27">   const nsMsgViewSortTypeValue byAttachments = 0x20;</span>
<a href="#l18.28"></a><span id="l18.28">   const nsMsgViewSortTypeValue byAccount = 0x21;</span>
<a href="#l18.29"></a><span id="l18.29">   const nsMsgViewSortTypeValue byCustom = 0x22;</span>
<a href="#l18.30"></a><span id="l18.30">   const nsMsgViewSortTypeValue byReceived = 0x23;</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineplus">+  const nsMsgViewSortTypeValue byCorrespondent = 0x24;</span>
<a href="#l18.32"></a><span id="l18.32"> };</span>
<a href="#l18.33"></a><span id="l18.33"> </span>
<a href="#l18.34"></a><span id="l18.34"> [scriptable, uuid(255d1c1e-fde7-11d4-a5be-0060b0fc04b7)]</span>
<a href="#l18.35"></a><span id="l18.35"> interface nsMsgViewNotificationCode</span>
<a href="#l18.36"></a><span id="l18.36"> {</span>
<a href="#l18.37"></a><span id="l18.37">   const nsMsgViewNotificationCodeValue none = 0;        </span>
<a href="#l18.38"></a><span id="l18.38">   /* No change; this call is just being used to potentially nest other sets of calls</span>
<a href="#l18.39"></a><span id="l18.39">      inside it.  The &quot;where&quot; and &quot;num&quot; parameters are unused. </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -835,16 +835,28 @@ nsresult nsMsgDBView::FetchLabel(nsIMsgD</span>
<a href="#l19.4"></a><span id="l19.4">     return NS_OK;</span>
<a href="#l19.5"></a><span id="l19.5">   }</span>
<a href="#l19.6"></a><span id="l19.6"> </span>
<a href="#l19.7"></a><span id="l19.7">   // We need to subtract 1 because mLabelPrefDescriptions is 0 based.</span>
<a href="#l19.8"></a><span id="l19.8">   aLabelString = mLabelPrefDescriptions[label - 1];</span>
<a href="#l19.9"></a><span id="l19.9">   return NS_OK;</span>
<a href="#l19.10"></a><span id="l19.10"> }</span>
<a href="#l19.11"></a><span id="l19.11"> </span>
<a href="#l19.12"></a><span id="l19.12" class="difflineplus">+bool nsMsgDBView::IsOutgoingMsg(nsIMsgDBHdr* aHdr)</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+{</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineplus">+  nsString author;</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineplus">+  aHdr-&gt;GetMime2DecodedAuthor(author);</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineplus">+</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineplus">+  nsCString emailAddress;</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineplus">+  nsString name;</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineplus">+  ExtractFirstAddress(DecodedHeader(author), name, emailAddress);</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineplus">+</span>
<a href="#l19.21"></a><span id="l19.21" class="difflineplus">+  return mEmails.Contains(emailAddress);</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineplus">+}</span>
<a href="#l19.23"></a><span id="l19.23" class="difflineplus">+</span>
<a href="#l19.24"></a><span id="l19.24"> </span>
<a href="#l19.25"></a><span id="l19.25"> /*if you call SaveAndClearSelection make sure to call RestoreSelection otherwise</span>
<a href="#l19.26"></a><span id="l19.26"> m_saveRestoreSelectionDepth will be incorrect and will lead to selection msg problems*/</span>
<a href="#l19.27"></a><span id="l19.27"> </span>
<a href="#l19.28"></a><span id="l19.28"> nsresult nsMsgDBView::SaveAndClearSelection(nsMsgKey *aCurrentMsgKey, nsTArray&lt;nsMsgKey&gt; &amp;aMsgKeyArray)</span>
<a href="#l19.29"></a><span id="l19.29"> {</span>
<a href="#l19.30"></a><span id="l19.30">   // we don't do anything on nested Save / Restore calls.</span>
<a href="#l19.31"></a><span id="l19.31">   m_saveRestoreSelectionDepth++;</span>
<a href="#l19.32"></a><span id="l19.32" class="difflineat">@@ -1336,16 +1348,23 @@ NS_IMETHODIMP nsMsgDBView::GetCellProper</span>
<a href="#l19.33"></a><span id="l19.33">     return NS_MSG_INVALID_DBVIEW_INDEX;</span>
<a href="#l19.34"></a><span id="l19.34">   }</span>
<a href="#l19.35"></a><span id="l19.35"> </span>
<a href="#l19.36"></a><span id="l19.36">   const char16_t* colID;</span>
<a href="#l19.37"></a><span id="l19.37">   col-&gt;GetIdConst(&amp;colID);</span>
<a href="#l19.38"></a><span id="l19.38">   nsIMsgCustomColumnHandler* colHandler = GetColumnHandler(colID);</span>
<a href="#l19.39"></a><span id="l19.39">   if (colHandler != nullptr)</span>
<a href="#l19.40"></a><span id="l19.40">     colHandler-&gt;GetCellProperties(aRow, col, properties);</span>
<a href="#l19.41"></a><span id="l19.41" class="difflineplus">+  else if (colID[0] == 'c') // correspondent</span>
<a href="#l19.42"></a><span id="l19.42" class="difflineplus">+  {</span>
<a href="#l19.43"></a><span id="l19.43" class="difflineplus">+    if (IsOutgoingMsg(msgHdr))</span>
<a href="#l19.44"></a><span id="l19.44" class="difflineplus">+      properties.AssignLiteral(&quot;outgoing&quot;);</span>
<a href="#l19.45"></a><span id="l19.45" class="difflineplus">+    else</span>
<a href="#l19.46"></a><span id="l19.46" class="difflineplus">+      properties.AssignLiteral(&quot;incoming&quot;);</span>
<a href="#l19.47"></a><span id="l19.47" class="difflineplus">+  }</span>
<a href="#l19.48"></a><span id="l19.48"> </span>
<a href="#l19.49"></a><span id="l19.49">   if (!properties.IsEmpty())</span>
<a href="#l19.50"></a><span id="l19.50">     properties.Append(' ');</span>
<a href="#l19.51"></a><span id="l19.51"> </span>
<a href="#l19.52"></a><span id="l19.52">   properties.Append(mMessageType);</span>
<a href="#l19.53"></a><span id="l19.53"> </span>
<a href="#l19.54"></a><span id="l19.54">   uint32_t flags;</span>
<a href="#l19.55"></a><span id="l19.55">   msgHdr-&gt;GetFlags(&amp;flags);</span>
<a href="#l19.56"></a><span id="l19.56" class="difflineat">@@ -1959,16 +1978,22 @@ NS_IMETHODIMP nsMsgDBView::CellTextForCo</span>
<a href="#l19.57"></a><span id="l19.57">     if (aColumnName[3] == 'i') // recipient</span>
<a href="#l19.58"></a><span id="l19.58">       rv = FetchRecipients(msgHdr, aValue);</span>
<a href="#l19.59"></a><span id="l19.59">     else if (aColumnName[3] == 'e') // received</span>
<a href="#l19.60"></a><span id="l19.60">       rv = FetchDate(msgHdr, aValue, true);</span>
<a href="#l19.61"></a><span id="l19.61">     break;</span>
<a href="#l19.62"></a><span id="l19.62">   case 'd':  // date</span>
<a href="#l19.63"></a><span id="l19.63">     rv = FetchDate(msgHdr, aValue);</span>
<a href="#l19.64"></a><span id="l19.64">     break;</span>
<a href="#l19.65"></a><span id="l19.65" class="difflineplus">+  case 'c': // correspondent</span>
<a href="#l19.66"></a><span id="l19.66" class="difflineplus">+    if (IsOutgoingMsg(msgHdr))</span>
<a href="#l19.67"></a><span id="l19.67" class="difflineplus">+      rv = FetchRecipients(msgHdr, aValue);</span>
<a href="#l19.68"></a><span id="l19.68" class="difflineplus">+    else</span>
<a href="#l19.69"></a><span id="l19.69" class="difflineplus">+      rv = FetchAuthor(msgHdr, aValue);</span>
<a href="#l19.70"></a><span id="l19.70" class="difflineplus">+    break;</span>
<a href="#l19.71"></a><span id="l19.71">   case 'p': // priority</span>
<a href="#l19.72"></a><span id="l19.72">     rv = FetchPriority(msgHdr, aValue);</span>
<a href="#l19.73"></a><span id="l19.73">     break;</span>
<a href="#l19.74"></a><span id="l19.74">   case 'a': // account</span>
<a href="#l19.75"></a><span id="l19.75">     if (aColumnName[1] == 'c') // account</span>
<a href="#l19.76"></a><span id="l19.76">       rv = FetchAccount(msgHdr, aValue);</span>
<a href="#l19.77"></a><span id="l19.77">     break;</span>
<a href="#l19.78"></a><span id="l19.78">   case 't':</span>
<a href="#l19.79"></a><span id="l19.79" class="difflineat">@@ -2215,16 +2240,39 @@ NS_IMETHODIMP nsMsgDBView::Open(nsIMsgFo</span>
<a href="#l19.80"></a><span id="l19.80">     if (prefs)</span>
<a href="#l19.81"></a><span id="l19.81">     {</span>
<a href="#l19.82"></a><span id="l19.82">       prefs-&gt;GetBoolPref(&quot;mailnews.sort_threads_by_root&quot;, &amp;mSortThreadsByRoot);</span>
<a href="#l19.83"></a><span id="l19.83"> </span>
<a href="#l19.84"></a><span id="l19.84">       if (mIsNews)</span>
<a href="#l19.85"></a><span id="l19.85">         prefs-&gt;GetBoolPref(&quot;news.show_size_in_lines&quot;, &amp;mShowSizeInLines);</span>
<a href="#l19.86"></a><span id="l19.86">     }</span>
<a href="#l19.87"></a><span id="l19.87">   }</span>
<a href="#l19.88"></a><span id="l19.88" class="difflineplus">+</span>
<a href="#l19.89"></a><span id="l19.89" class="difflineplus">+  nsCOMPtr&lt;nsIArray&gt; identities;</span>
<a href="#l19.90"></a><span id="l19.90" class="difflineplus">+  rv = accountManager-&gt;GetAllIdentities(getter_AddRefs(identities));</span>
<a href="#l19.91"></a><span id="l19.91" class="difflineplus">+  if (!identities)</span>
<a href="#l19.92"></a><span id="l19.92" class="difflineplus">+    return rv;</span>
<a href="#l19.93"></a><span id="l19.93" class="difflineplus">+</span>
<a href="#l19.94"></a><span id="l19.94" class="difflineplus">+  uint32_t count;</span>
<a href="#l19.95"></a><span id="l19.95" class="difflineplus">+  identities-&gt;GetLength(&amp;count);</span>
<a href="#l19.96"></a><span id="l19.96" class="difflineplus">+  for (uint32_t i = 0; i &lt; count; i++)</span>
<a href="#l19.97"></a><span id="l19.97" class="difflineplus">+  {</span>
<a href="#l19.98"></a><span id="l19.98" class="difflineplus">+    nsCOMPtr&lt;nsIMsgIdentity&gt; identity(do_QueryElementAt(identities, i));</span>
<a href="#l19.99"></a><span id="l19.99" class="difflineplus">+    if (!identity)</span>
<a href="#l19.100"></a><span id="l19.100" class="difflineplus">+      continue;</span>
<a href="#l19.101"></a><span id="l19.101" class="difflineplus">+</span>
<a href="#l19.102"></a><span id="l19.102" class="difflineplus">+    nsCString email;</span>
<a href="#l19.103"></a><span id="l19.103" class="difflineplus">+    identity-&gt;GetEmail(email);</span>
<a href="#l19.104"></a><span id="l19.104" class="difflineplus">+    if (!email.IsEmpty())</span>
<a href="#l19.105"></a><span id="l19.105" class="difflineplus">+      mEmails.PutEntry(email);</span>
<a href="#l19.106"></a><span id="l19.106" class="difflineplus">+</span>
<a href="#l19.107"></a><span id="l19.107" class="difflineplus">+    identity-&gt;GetReplyTo(email);</span>
<a href="#l19.108"></a><span id="l19.108" class="difflineplus">+    if (!email.IsEmpty())</span>
<a href="#l19.109"></a><span id="l19.109" class="difflineplus">+      mEmails.PutEntry(email);</span>
<a href="#l19.110"></a><span id="l19.110" class="difflineplus">+  }</span>
<a href="#l19.111"></a><span id="l19.111">   return NS_OK;</span>
<a href="#l19.112"></a><span id="l19.112"> }</span>
<a href="#l19.113"></a><span id="l19.113"> </span>
<a href="#l19.114"></a><span id="l19.114"> NS_IMETHODIMP nsMsgDBView::Close()</span>
<a href="#l19.115"></a><span id="l19.115"> {</span>
<a href="#l19.116"></a><span id="l19.116">   int32_t oldSize = GetSize();</span>
<a href="#l19.117"></a><span id="l19.117">   // this is important, because the tree will ask us for our</span>
<a href="#l19.118"></a><span id="l19.118">   // row count, which get determine from the number of keys.</span>
<a href="#l19.119"></a><span id="l19.119" class="difflineat">@@ -3806,16 +3854,17 @@ nsresult nsMsgDBView::GetFieldTypeAndLen</span>
<a href="#l19.120"></a><span id="l19.120">             break;</span>
<a href="#l19.121"></a><span id="l19.121">         case nsMsgViewSortType::byAccount:</span>
<a href="#l19.122"></a><span id="l19.122">         case nsMsgViewSortType::byTags:</span>
<a href="#l19.123"></a><span id="l19.123">         case nsMsgViewSortType::byLocation:</span>
<a href="#l19.124"></a><span id="l19.124">             *pFieldType = kCollationKey;</span>
<a href="#l19.125"></a><span id="l19.125">             *pMaxLen = kMaxLocationKey;</span>
<a href="#l19.126"></a><span id="l19.126">             break;</span>
<a href="#l19.127"></a><span id="l19.127">         case nsMsgViewSortType::byRecipient:</span>
<a href="#l19.128"></a><span id="l19.128" class="difflineplus">+        case nsMsgViewSortType::byCorrespondent:</span>
<a href="#l19.129"></a><span id="l19.129">             *pFieldType = kCollationKey;</span>
<a href="#l19.130"></a><span id="l19.130">             *pMaxLen = kMaxRecipientKey;</span>
<a href="#l19.131"></a><span id="l19.131">             break;</span>
<a href="#l19.132"></a><span id="l19.132">         case nsMsgViewSortType::byAuthor:</span>
<a href="#l19.133"></a><span id="l19.133">             *pFieldType = kCollationKey;</span>
<a href="#l19.134"></a><span id="l19.134">             *pMaxLen = kMaxAuthorKey;</span>
<a href="#l19.135"></a><span id="l19.135">             break;</span>
<a href="#l19.136"></a><span id="l19.136">         case nsMsgViewSortType::byDate:</span>
<a href="#l19.137"></a><span id="l19.137" class="difflineat">@@ -4191,16 +4240,35 @@ nsMsgDBView::GetCollationKey(nsIMsgDBHdr</span>
<a href="#l19.138"></a><span id="l19.138">         rv = dbToUse-&gt;CreateCollationKey(strKey, len, result);</span>
<a href="#l19.139"></a><span id="l19.139">       }</span>
<a href="#l19.140"></a><span id="l19.140">       else</span>
<a href="#l19.141"></a><span id="l19.141">       {</span>
<a href="#l19.142"></a><span id="l19.142">         NS_ERROR(&quot;should not be here (Sort Type: byCustom (String), but no custom handler)&quot;);</span>
<a href="#l19.143"></a><span id="l19.143">         rv = NS_ERROR_UNEXPECTED;</span>
<a href="#l19.144"></a><span id="l19.144">       }</span>
<a href="#l19.145"></a><span id="l19.145">       break;</span>
<a href="#l19.146"></a><span id="l19.146" class="difflineplus">+    case nsMsgViewSortType::byCorrespondent:</span>
<a href="#l19.147"></a><span id="l19.147" class="difflineplus">+      {</span>
<a href="#l19.148"></a><span id="l19.148" class="difflineplus">+        nsString value;</span>
<a href="#l19.149"></a><span id="l19.149" class="difflineplus">+        if (IsOutgoingMsg(msgHdr))</span>
<a href="#l19.150"></a><span id="l19.150" class="difflineplus">+          rv = FetchRecipients(msgHdr, value);</span>
<a href="#l19.151"></a><span id="l19.151" class="difflineplus">+        else</span>
<a href="#l19.152"></a><span id="l19.152" class="difflineplus">+          rv = FetchAuthor(msgHdr, value);</span>
<a href="#l19.153"></a><span id="l19.153" class="difflineplus">+        if (NS_SUCCEEDED(rv))</span>
<a href="#l19.154"></a><span id="l19.154" class="difflineplus">+        {</span>
<a href="#l19.155"></a><span id="l19.155" class="difflineplus">+          nsCOMPtr &lt;nsIMsgDatabase&gt; dbToUse = m_db;</span>
<a href="#l19.156"></a><span id="l19.156" class="difflineplus">+          if (!dbToUse) // probably search view</span>
<a href="#l19.157"></a><span id="l19.157" class="difflineplus">+          {</span>
<a href="#l19.158"></a><span id="l19.158" class="difflineplus">+            rv = GetDBForHeader(msgHdr, getter_AddRefs(dbToUse));</span>
<a href="#l19.159"></a><span id="l19.159" class="difflineplus">+            NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l19.160"></a><span id="l19.160" class="difflineplus">+          }</span>
<a href="#l19.161"></a><span id="l19.161" class="difflineplus">+          rv = dbToUse-&gt;CreateCollationKey(value, len, result);</span>
<a href="#l19.162"></a><span id="l19.162" class="difflineplus">+        }</span>
<a href="#l19.163"></a><span id="l19.163" class="difflineplus">+      }</span>
<a href="#l19.164"></a><span id="l19.164" class="difflineplus">+      break;</span>
<a href="#l19.165"></a><span id="l19.165">     default:</span>
<a href="#l19.166"></a><span id="l19.166">         rv = NS_ERROR_UNEXPECTED;</span>
<a href="#l19.167"></a><span id="l19.167">         break;</span>
<a href="#l19.168"></a><span id="l19.168">     }</span>
<a href="#l19.169"></a><span id="l19.169"> </span>
<a href="#l19.170"></a><span id="l19.170">     // bailing out with failure will stop the sort and leave us in</span>
<a href="#l19.171"></a><span id="l19.171">     // a bad state.  try to continue on, instead</span>
<a href="#l19.172"></a><span id="l19.172">     NS_ASSERTION(NS_SUCCEEDED(rv),&quot;failed to get the collation key&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mailnews/base/src/nsMsgDBView.h</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgDBView.h</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -24,16 +24,18 @@</span>
<a href="#l20.4"></a><span id="l20.4"> #include &quot;nsIAtom.h&quot;</span>
<a href="#l20.5"></a><span id="l20.5"> #include &quot;nsIImapIncomingServer.h&quot;</span>
<a href="#l20.6"></a><span id="l20.6"> #include &quot;nsIWeakReference.h&quot;</span>
<a href="#l20.7"></a><span id="l20.7"> #include &quot;nsIMsgFilterPlugin.h&quot;</span>
<a href="#l20.8"></a><span id="l20.8"> #include &quot;nsIStringBundle.h&quot;</span>
<a href="#l20.9"></a><span id="l20.9"> #include &quot;nsMsgTagService.h&quot;</span>
<a href="#l20.10"></a><span id="l20.10"> #include &quot;nsCOMArray.h&quot;</span>
<a href="#l20.11"></a><span id="l20.11"> #include &quot;nsTArray.h&quot;</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineplus">+#include &quot;nsTHashtable.h&quot;</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+#include &quot;nsHashKeys.h&quot;</span>
<a href="#l20.14"></a><span id="l20.14"> #include &quot;nsIMsgCustomColumnHandler.h&quot;</span>
<a href="#l20.15"></a><span id="l20.15"> #include &quot;nsAutoPtr.h&quot;</span>
<a href="#l20.16"></a><span id="l20.16"> #include &quot;nsIWeakReferenceUtils.h&quot;</span>
<a href="#l20.17"></a><span id="l20.17"> #define MESSENGER_STRING_URL       &quot;chrome://messenger/locale/messenger.properties&quot;</span>
<a href="#l20.18"></a><span id="l20.18"> </span>
<a href="#l20.19"></a><span id="l20.19"> class nsVoidArray;</span>
<a href="#l20.20"></a><span id="l20.20"> </span>
<a href="#l20.21"></a><span id="l20.21"> typedef nsAutoTArray&lt;nsMsgViewIndex, 1&gt; nsMsgViewIndexArray;</span>
<a href="#l20.22"></a><span id="l20.22" class="difflineat">@@ -59,16 +61,18 @@ public:</span>
<a href="#l20.23"></a><span id="l20.23">   nsCOMPtr &lt;nsIMsgCustomColumnHandler&gt; mColHandler;</span>
<a href="#l20.24"></a><span id="l20.24"> } ;</span>
<a href="#l20.25"></a><span id="l20.25"> </span>
<a href="#l20.26"></a><span id="l20.26"> // reserve the top 8 bits in the msg flags for the view-only flags.</span>
<a href="#l20.27"></a><span id="l20.27"> #define MSG_VIEW_FLAGS 0xEE000000</span>
<a href="#l20.28"></a><span id="l20.28"> #define MSG_VIEW_FLAG_HASCHILDREN 0x40000000</span>
<a href="#l20.29"></a><span id="l20.29"> #define MSG_VIEW_FLAG_DUMMY 0x20000000</span>
<a href="#l20.30"></a><span id="l20.30"> #define MSG_VIEW_FLAG_ISTHREAD 0x8000000</span>
<a href="#l20.31"></a><span id="l20.31" class="difflineplus">+#define MSG_VIEW_FLAG_OUTGOING 0x2000000</span>
<a href="#l20.32"></a><span id="l20.32" class="difflineplus">+#define MSG_VIEW_FLAG_INCOMING 0x1000000</span>
<a href="#l20.33"></a><span id="l20.33"> </span>
<a href="#l20.34"></a><span id="l20.34"> /* There currently only 5 labels defined */</span>
<a href="#l20.35"></a><span id="l20.35"> #define PREF_LABELS_MAX 5</span>
<a href="#l20.36"></a><span id="l20.36"> #define PREF_LABELS_DESCRIPTION  &quot;mailnews.labels.description.&quot;</span>
<a href="#l20.37"></a><span id="l20.37"> #define PREF_LABELS_COLOR  &quot;mailnews.labels.color.&quot;</span>
<a href="#l20.38"></a><span id="l20.38"> </span>
<a href="#l20.39"></a><span id="l20.39"> #define LABEL_COLOR_STRING &quot; lc-&quot;</span>
<a href="#l20.40"></a><span id="l20.40"> #define LABEL_COLOR_WHITE_STRING &quot;#FFFFFF&quot;</span>
<a href="#l20.41"></a><span id="l20.41" class="difflineat">@@ -155,16 +159,17 @@ protected:</span>
<a href="#l20.42"></a><span id="l20.42">   nsresult FetchSize(nsIMsgDBHdr * aHdr, nsAString &amp; aSizeString);</span>
<a href="#l20.43"></a><span id="l20.43">   nsresult FetchPriority(nsIMsgDBHdr *aHdr, nsAString &amp; aPriorityString);</span>
<a href="#l20.44"></a><span id="l20.44">   nsresult FetchLabel(nsIMsgDBHdr *aHdr, nsAString &amp; aLabelString);</span>
<a href="#l20.45"></a><span id="l20.45">   nsresult FetchTags(nsIMsgDBHdr *aHdr, nsAString &amp; aTagString);</span>
<a href="#l20.46"></a><span id="l20.46">   nsresult FetchKeywords(nsIMsgDBHdr *aHdr, nsACString &amp; keywordString);</span>
<a href="#l20.47"></a><span id="l20.47">   nsresult FetchRowKeywords(nsMsgViewIndex aRow, nsIMsgDBHdr *aHdr,</span>
<a href="#l20.48"></a><span id="l20.48">                             nsACString &amp; keywordString);</span>
<a href="#l20.49"></a><span id="l20.49">   nsresult FetchAccount(nsIMsgDBHdr * aHdr, nsAString&amp; aAccount);</span>
<a href="#l20.50"></a><span id="l20.50" class="difflineplus">+  bool IsOutgoingMsg(nsIMsgDBHdr * aHdr);</span>
<a href="#l20.51"></a><span id="l20.51">   nsresult CycleThreadedColumn(nsIDOMElement * aElement);</span>
<a href="#l20.52"></a><span id="l20.52"> </span>
<a href="#l20.53"></a><span id="l20.53">   // The default enumerator is over the db, but things like</span>
<a href="#l20.54"></a><span id="l20.54">   // quick search views will enumerate just the displayed messages.</span>
<a href="#l20.55"></a><span id="l20.55">   virtual nsresult GetMessageEnumerator(nsISimpleEnumerator **enumerator);</span>
<a href="#l20.56"></a><span id="l20.56">   // this is a message enumerator that enumerates based on the view contents</span>
<a href="#l20.57"></a><span id="l20.57">   virtual nsresult GetViewEnumerator(nsISimpleEnumerator **enumerator);</span>
<a href="#l20.58"></a><span id="l20.58"> </span>
<a href="#l20.59"></a><span id="l20.59" class="difflineat">@@ -429,16 +434,18 @@ protected:</span>
<a href="#l20.60"></a><span id="l20.60"> </span>
<a href="#l20.61"></a><span id="l20.61">   // these are the headers of the messages in the current</span>
<a href="#l20.62"></a><span id="l20.62">   // batch/series of batches of messages manually marked</span>
<a href="#l20.63"></a><span id="l20.63">   // as junk</span>
<a href="#l20.64"></a><span id="l20.64">   nsCOMPtr&lt;nsIMutableArray&gt; mJunkHdrs;</span>
<a href="#l20.65"></a><span id="l20.65">   </span>
<a href="#l20.66"></a><span id="l20.66">   nsTArray&lt;uint32_t&gt; mIndicesToNoteChange;</span>
<a href="#l20.67"></a><span id="l20.67"> </span>
<a href="#l20.68"></a><span id="l20.68" class="difflineplus">+  nsTHashtable&lt;nsCStringHashKey&gt; mEmails;</span>
<a href="#l20.69"></a><span id="l20.69" class="difflineplus">+</span>
<a href="#l20.70"></a><span id="l20.70">   // the saved search views keep track of the XX most recently deleted msg ids, so that if the </span>
<a href="#l20.71"></a><span id="l20.71">   // delete is undone, we can add the msg back to the search results, even if it no longer</span>
<a href="#l20.72"></a><span id="l20.72">   // matches the search criteria (e.g., a saved search over unread messages).</span>
<a href="#l20.73"></a><span id="l20.73">   // We use mRecentlyDeletedArrayIndex to treat the array as a list of the XX</span>
<a href="#l20.74"></a><span id="l20.74">   // most recently deleted msgs.</span>
<a href="#l20.75"></a><span id="l20.75">   nsTArray&lt;nsCString&gt; mRecentlyDeletedMsgIds;</span>
<a href="#l20.76"></a><span id="l20.76">   uint32_t mRecentlyDeletedArrayIndex;</span>
<a href="#l20.77"></a><span id="l20.77">   void RememberDeletedMsgHdr(nsIMsgDBHdr *msgHdr);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/mailnews/base/src/nsMsgGroupView.cpp</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgGroupView.cpp</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -233,16 +233,22 @@ nsresult nsMsgGroupView::HashHdr(nsIMsgD</span>
<a href="#l21.4"></a><span id="l21.4">     {</span>
<a href="#l21.5"></a><span id="l21.5">       nsIMsgCustomColumnHandler* colHandler = GetCurColumnHandlerFromDBInfo();</span>
<a href="#l21.6"></a><span id="l21.6">       if (colHandler)</span>
<a href="#l21.7"></a><span id="l21.7">       {</span>
<a href="#l21.8"></a><span id="l21.8">         rv = colHandler-&gt;GetSortStringForRow(msgHdr, aHashKey);</span>
<a href="#l21.9"></a><span id="l21.9">         break;</span>
<a href="#l21.10"></a><span id="l21.10">       }</span>
<a href="#l21.11"></a><span id="l21.11">     }</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineplus">+    case nsMsgViewSortType::byCorrespondent:</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+      if (IsOutgoingMsg(msgHdr))</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineplus">+        rv = FetchRecipients(msgHdr, aHashKey);</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineplus">+      else</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineplus">+        rv = FetchAuthor(msgHdr, aHashKey);</span>
<a href="#l21.17"></a><span id="l21.17" class="difflineplus">+      break;</span>
<a href="#l21.18"></a><span id="l21.18">     default:</span>
<a href="#l21.19"></a><span id="l21.19">       NS_ASSERTION(false, &quot;no hash key for this type&quot;);</span>
<a href="#l21.20"></a><span id="l21.20">       rv = NS_ERROR_FAILURE;</span>
<a href="#l21.21"></a><span id="l21.21">   }</span>
<a href="#l21.22"></a><span id="l21.22">   return rv;</span>
<a href="#l21.23"></a><span id="l21.23"> }</span>
<a href="#l21.24"></a><span id="l21.24"> </span>
<a href="#l21.25"></a><span id="l21.25"> nsMsgGroupThread *nsMsgGroupView::CreateGroupThread(nsIMsgDatabase *db)</span>
<a href="#l21.26"></a><span id="l21.26" class="difflineat">@@ -822,16 +828,17 @@ NS_IMETHODIMP nsMsgGroupView::CellTextFo</span>
<a href="#l21.27"></a><span id="l21.27">           tmp_str.Adopt(GetString(flags &amp; nsMsgMessageFlags::Marked ?</span>
<a href="#l21.28"></a><span id="l21.28">             MOZ_UTF16(&quot;groupFlagged&quot;) : MOZ_UTF16(&quot;notFlagged&quot;)));</span>
<a href="#l21.29"></a><span id="l21.29">           aValue.Assign(tmp_str);</span>
<a href="#l21.30"></a><span id="l21.30">           break;</span>
<a href="#l21.31"></a><span id="l21.31">         // byLocation is a special case; we don't want to have duplicate</span>
<a href="#l21.32"></a><span id="l21.32">         //  all this logic in nsMsgSearchDBView, and its hash key is what we</span>
<a href="#l21.33"></a><span id="l21.33">         //  want anyways, so just copy it across.</span>
<a href="#l21.34"></a><span id="l21.34">         case nsMsgViewSortType::byLocation:</span>
<a href="#l21.35"></a><span id="l21.35" class="difflineplus">+        case nsMsgViewSortType::byCorrespondent:</span>
<a href="#l21.36"></a><span id="l21.36">           aValue = hashKey;</span>
<a href="#l21.37"></a><span id="l21.37">           break;</span>
<a href="#l21.38"></a><span id="l21.38">         case nsMsgViewSortType::byCustom:</span>
<a href="#l21.39"></a><span id="l21.39">         {</span>
<a href="#l21.40"></a><span id="l21.40">           nsIMsgCustomColumnHandler* colHandler =</span>
<a href="#l21.41"></a><span id="l21.41">             GetCurColumnHandlerFromDBInfo();</span>
<a href="#l21.42"></a><span id="l21.42">           if (colHandler)</span>
<a href="#l21.43"></a><span id="l21.43">           {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mailnews/db/gloda/modules/dbview.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/dbview.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -117,17 +117,17 @@ GlodaSyntheticView.prototype = {</span>
<a href="#l22.4"></a><span id="l22.4">       visible: true,</span>
<a href="#l22.5"></a><span id="l22.5">     },</span>
<a href="#l22.6"></a><span id="l22.6">     flaggedCol: {</span>
<a href="#l22.7"></a><span id="l22.7">       visible: true,</span>
<a href="#l22.8"></a><span id="l22.8">     },</span>
<a href="#l22.9"></a><span id="l22.9">     subjectCol: {</span>
<a href="#l22.10"></a><span id="l22.10">       visible: true,</span>
<a href="#l22.11"></a><span id="l22.11">     },</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-    senderCol: {</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+    correspondentCol: {</span>
<a href="#l22.14"></a><span id="l22.14">       visible: true,</span>
<a href="#l22.15"></a><span id="l22.15">     },</span>
<a href="#l22.16"></a><span id="l22.16">     dateCol: {</span>
<a href="#l22.17"></a><span id="l22.17">       visible: true,</span>
<a href="#l22.18"></a><span id="l22.18">     },</span>
<a href="#l22.19"></a><span id="l22.19">     locationCol: {</span>
<a href="#l22.20"></a><span id="l22.20">       visible: true,</span>
<a href="#l22.21"></a><span id="l22.21">     },</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

