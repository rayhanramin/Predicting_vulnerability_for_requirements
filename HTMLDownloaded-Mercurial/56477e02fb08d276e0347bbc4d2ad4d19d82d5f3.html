<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 29090:56477e02fb08d276e0347bbc4d2ad4d19d82d5f3</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 56477e02fb08d276e0347bbc4d2ad4d19d82d5f3" />
<meta property="og:url" content="/comm-central/rev/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3" />
<meta property="og:description" content="Bug 1624939 - Initial changes to enable OpenPGP status display when reading messages. r=PatrickBrunschwig,r=mkmelin" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 56477e02fb08d276e0347bbc4d2ad4d19d82d5f3 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3">shortlog</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3">files</a> |
changeset |
<a href="/comm-central/raw-rev/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3">raw</a>  | <a href="/comm-central/archive/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1624939">Bug 1624939</a> - Initial changes to enable OpenPGP status display when reading messages. r=PatrickBrunschwig,r=mkmelin
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#75;&#97;&#105;&#32;&#69;&#110;&#103;&#101;&#114;&#116;&#32;&#60;&#107;&#97;&#105;&#101;&#64;&#107;&#117;&#105;&#120;&#46;&#100;&#101;&#62;</td></tr>
<tr><td></td><td class="date age">Sat, 14 Mar 2020 14:18:14 +0100</td></tr>

<tr>
 <td>changeset 29090</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3">56477e02fb08d276e0347bbc4d2ad4d19d82d5f3</a></td>
</tr>



<tr>
<td>parent 29089</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/ff8590f85d5e8bbf97d2bf14cf166911e48d581f">ff8590f85d5e8bbf97d2bf14cf166911e48d581f</a>
</td>
</tr>

<tr>
<td>child 29091</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/aa309221cbea6c1f00a33c77491bdc82a92b6fc9">aa309221cbea6c1f00a33c77491bdc82a92b6fc9</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=56477e02fb08d276e0347bbc4d2ad4d19d82d5f3">17201</a></td></tr>
<tr><td>push user</td><td>kaie@kuix.de</td></tr>
<tr><td>push date</td><td class="date age">Sat, 28 Mar 2020 19:06:50 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@9e8aed12d503 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=9e8aed12d503873433ce4b5ef9f3f013e7dd6636">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=9e8aed12d503873433ce4b5ef9f3f013e7dd6636&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=9e8aed12d503873433ce4b5ef9f3f013e7dd6636&newProject=comm-central&newRevision=56477e02fb08d276e0347bbc4d2ad4d19d82d5f3&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=9e8aed12d503873433ce4b5ef9f3f013e7dd6636&newProject=comm-central&newRevision=56477e02fb08d276e0347bbc4d2ad4d19d82d5f3&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=9e8aed12d503873433ce4b5ef9f3f013e7dd6636&newProject=comm-central&newRevision=56477e02fb08d276e0347bbc4d2ad4d19d82d5f3&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28PatrickBrunschwig%29&revcount=50">PatrickBrunschwig</a>, <a href="/comm-central/log?rev=reviewer%28mkmelin%29&revcount=50">mkmelin</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1624939">1624939</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1624939">Bug 1624939</a> - Initial changes to enable OpenPGP status display when reading messages. r=PatrickBrunschwig,r=mkmelin

Differential Revision: <a href="https://phabricator.services.mozilla.com/D68240">https://phabricator.services.mozilla.com/D68240</a></div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/messageWindow.js">mail/base/content/messageWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/messageWindow.js">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/messageWindow.js">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/messageWindow.js">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/messageWindow.js">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/messageWindow.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/msgHdrView.inc.xhtml">mail/base/content/msgHdrView.inc.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/msgHdrView.inc.xhtml">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/msgHdrView.inc.xhtml">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/msgHdrView.inc.xhtml">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/msgHdrView.inc.xhtml">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/msgHdrView.inc.xhtml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/msgMail3PaneWindow.js">mail/base/content/msgMail3PaneWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/msgMail3PaneWindow.js">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/msgMail3PaneWindow.js">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/msgMail3PaneWindow.js">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/msgMail3PaneWindow.js">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/base/content/msgMail3PaneWindow.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/am-e2e/prefs/e2e-prefs.js">mail/extensions/am-e2e/prefs/e2e-prefs.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/am-e2e/prefs/e2e-prefs.js">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/am-e2e/prefs/e2e-prefs.js">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/am-e2e/prefs/e2e-prefs.js">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/am-e2e/prefs/e2e-prefs.js">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/am-e2e/prefs/e2e-prefs.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/cryptoAPI/RNPCryptoAPI.jsm">mail/extensions/openpgp/content/modules/cryptoAPI/RNPCryptoAPI.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/cryptoAPI/RNPCryptoAPI.jsm">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/cryptoAPI/RNPCryptoAPI.jsm">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/cryptoAPI/RNPCryptoAPI.jsm">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/cryptoAPI/RNPCryptoAPI.jsm">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/cryptoAPI/RNPCryptoAPI.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/decryption.jsm">mail/extensions/openpgp/content/modules/decryption.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/decryption.jsm">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/decryption.jsm">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/decryption.jsm">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/decryption.jsm">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/decryption.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm">mail/extensions/openpgp/content/modules/mimeDecrypt.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeEncrypt.jsm">mail/extensions/openpgp/content/modules/mimeEncrypt.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeEncrypt.jsm">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeEncrypt.jsm">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeEncrypt.jsm">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeEncrypt.jsm">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeEncrypt.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeVerify.jsm">mail/extensions/openpgp/content/modules/mimeVerify.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeVerify.jsm">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeVerify.jsm">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeVerify.jsm">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeVerify.jsm">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/mimeVerify.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/msgRead.jsm">mail/extensions/openpgp/content/modules/msgRead.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/msgRead.jsm">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/msgRead.jsm">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/msgRead.jsm">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/msgRead.jsm">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/msgRead.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/rnp.jsm">mail/extensions/openpgp/content/modules/rnp.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/rnp.jsm">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/rnp.jsm">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/rnp.jsm">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/rnp.jsm">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/rnp.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/rnpLib.jsm">mail/extensions/openpgp/content/modules/rnpLib.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/rnpLib.jsm">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/rnpLib.jsm">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/rnpLib.jsm">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/rnpLib.jsm">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/modules/rnpLib.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/strings/enigmail.properties">mail/extensions/openpgp/content/strings/enigmail.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/strings/enigmail.properties">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/strings/enigmail.properties">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/strings/enigmail.properties">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/strings/enigmail.properties">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/strings/enigmail.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/ui/enigmailMessengerOverlay.js">mail/extensions/openpgp/content/ui/enigmailMessengerOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/ui/enigmailMessengerOverlay.js">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/ui/enigmailMessengerOverlay.js">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/ui/enigmailMessengerOverlay.js">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/ui/enigmailMessengerOverlay.js">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/ui/enigmailMessengerOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/ui/enigmailMsgHdrViewOverlay.js">mail/extensions/openpgp/content/ui/enigmailMsgHdrViewOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/ui/enigmailMsgHdrViewOverlay.js">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/ui/enigmailMsgHdrViewOverlay.js">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/ui/enigmailMsgHdrViewOverlay.js">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/ui/enigmailMsgHdrViewOverlay.js">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/content/ui/enigmailMsgHdrViewOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-linux/enigmail.css">mail/extensions/openpgp/skin/tb-linux/enigmail.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-linux/enigmail.css">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-linux/enigmail.css">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-linux/enigmail.css">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-linux/enigmail.css">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-linux/enigmail.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-mac/enigmail.css">mail/extensions/openpgp/skin/tb-mac/enigmail.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-mac/enigmail.css">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-mac/enigmail.css">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-mac/enigmail.css">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-mac/enigmail.css">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-mac/enigmail.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-win/enigmail.css">mail/extensions/openpgp/skin/tb-win/enigmail.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-win/enigmail.css">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-win/enigmail.css">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-win/enigmail.css">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-win/enigmail.css">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/extensions/openpgp/skin/tb-win/enigmail.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/jar.mn">mail/themes/linux/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/jar.mn">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/jar.mn">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/jar.mn">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/jar.mn">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/hdrSignOkUnverified.png">mail/themes/linux/mail/smime/hdrSignOkUnverified.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/hdrSignOkUnverified.png">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/hdrSignOkUnverified.png">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/hdrSignOkUnverified.png">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/hdrSignOkUnverified.png">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/hdrSignOkUnverified.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/hdrSignOkVerified.png">mail/themes/linux/mail/smime/hdrSignOkVerified.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/hdrSignOkVerified.png">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/hdrSignOkVerified.png">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/hdrSignOkVerified.png">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/hdrSignOkVerified.png">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/hdrSignOkVerified.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/msgHdrViewSMIMEOverlay.css">mail/themes/linux/mail/smime/msgHdrViewSMIMEOverlay.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/msgHdrViewSMIMEOverlay.css">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/msgHdrViewSMIMEOverlay.css">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/msgHdrViewSMIMEOverlay.css">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/msgHdrViewSMIMEOverlay.css">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/linux/mail/smime/msgHdrViewSMIMEOverlay.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/jar.mn">mail/themes/osx/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/jar.mn">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/jar.mn">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/jar.mn">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/jar.mn">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/hdrSignOkUnverified.png">mail/themes/osx/mail/smime/hdrSignOkUnverified.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/hdrSignOkUnverified.png">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/hdrSignOkUnverified.png">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/hdrSignOkUnverified.png">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/hdrSignOkUnverified.png">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/hdrSignOkUnverified.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/hdrSignOkVerified.png">mail/themes/osx/mail/smime/hdrSignOkVerified.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/hdrSignOkVerified.png">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/hdrSignOkVerified.png">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/hdrSignOkVerified.png">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/hdrSignOkVerified.png">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/hdrSignOkVerified.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/msgHdrViewSMIMEOverlay.css">mail/themes/osx/mail/smime/msgHdrViewSMIMEOverlay.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/msgHdrViewSMIMEOverlay.css">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/msgHdrViewSMIMEOverlay.css">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/msgHdrViewSMIMEOverlay.css">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/msgHdrViewSMIMEOverlay.css">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/osx/mail/smime/msgHdrViewSMIMEOverlay.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/jar.mn">mail/themes/windows/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/jar.mn">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/jar.mn">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/jar.mn">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/jar.mn">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/hdrSignOkUnverified.png">mail/themes/windows/mail/smime/hdrSignOkUnverified.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/hdrSignOkUnverified.png">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/hdrSignOkUnverified.png">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/hdrSignOkUnverified.png">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/hdrSignOkUnverified.png">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/hdrSignOkUnverified.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/hdrSignOkVerified.png">mail/themes/windows/mail/smime/hdrSignOkVerified.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/hdrSignOkVerified.png">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/hdrSignOkVerified.png">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/hdrSignOkVerified.png">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/hdrSignOkVerified.png">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/hdrSignOkVerified.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/msgHdrViewSMIMEOverlay.css">mail/themes/windows/mail/smime/msgHdrViewSMIMEOverlay.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/msgHdrViewSMIMEOverlay.css">file</a> |
<a href="/comm-central/annotate/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/msgHdrViewSMIMEOverlay.css">annotate</a> |
<a href="/comm-central/diff/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/msgHdrViewSMIMEOverlay.css">diff</a> |
<a href="/comm-central/comparison/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/msgHdrViewSMIMEOverlay.css">comparison</a> |
<a href="/comm-central/log/56477e02fb08d276e0347bbc4d2ad4d19d82d5f3/mail/themes/windows/mail/smime/msgHdrViewSMIMEOverlay.css">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/base/content/messageWindow.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/base/content/messageWindow.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -23,16 +23,19 @@</span>
<a href="#l1.4"></a><span id="l1.4"> /* import-globals-from toolbarIconColor.js */</span>
<a href="#l1.5"></a><span id="l1.5"> /* globals PanelUI */</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l1.8"></a><span id="l1.8"> var { MailUtils } = ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l1.9"></a><span id="l1.9"> var { AppConstants } = ChromeUtils.import(</span>
<a href="#l1.10"></a><span id="l1.10">   &quot;resource://gre/modules/AppConstants.jsm&quot;</span>
<a href="#l1.11"></a><span id="l1.11"> );</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+var { MailConstants } = ChromeUtils.import(</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+  &quot;resource:///modules/MailConstants.jsm&quot;</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+);</span>
<a href="#l1.15"></a><span id="l1.15"> var { XPCOMUtils } = ChromeUtils.import(</span>
<a href="#l1.16"></a><span id="l1.16">   &quot;resource://gre/modules/XPCOMUtils.jsm&quot;</span>
<a href="#l1.17"></a><span id="l1.17"> );</span>
<a href="#l1.18"></a><span id="l1.18"> var { MsgHdrSyntheticView } = ChromeUtils.import(</span>
<a href="#l1.19"></a><span id="l1.19">   &quot;resource:///modules/MsgHdrSyntheticView.jsm&quot;</span>
<a href="#l1.20"></a><span id="l1.20"> );</span>
<a href="#l1.21"></a><span id="l1.21"> </span>
<a href="#l1.22"></a><span id="l1.22"> XPCOMUtils.defineLazyModuleGetters(this, {</span>
<a href="#l1.23"></a><span id="l1.23" class="difflineat">@@ -387,16 +390,23 @@ function OnLoadMessageWindow() {</span>
<a href="#l1.24"></a><span id="l1.24"> </span>
<a href="#l1.25"></a><span id="l1.25">   // By reassigning this here, we fix the find bar (bug 1562677).</span>
<a href="#l1.26"></a><span id="l1.26">   document.getElementById(&quot;FindToolbar&quot;).browser = document.getElementById(</span>
<a href="#l1.27"></a><span id="l1.27">     &quot;messagepane&quot;</span>
<a href="#l1.28"></a><span id="l1.28">   );</span>
<a href="#l1.29"></a><span id="l1.29"> </span>
<a href="#l1.30"></a><span id="l1.30">   ToolbarIconColor.init();</span>
<a href="#l1.31"></a><span id="l1.31">   setTimeout(delayedOnLoadMessageWindow, 0); // when debugging, set this to 5000, so you can see what happens after the window comes up.</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineplus">+</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineplus">+  if (MailConstants.MOZ_OPENPGP) {</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineplus">+    Enigmail.msg.messengerStartup.bind(Enigmail.msg);</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineplus">+    Enigmail.msg.messengerStartup();</span>
<a href="#l1.36"></a><span id="l1.36" class="difflineplus">+    Enigmail.hdrView.hdrViewLoad.bind(Enigmail.hdrView);</span>
<a href="#l1.37"></a><span id="l1.37" class="difflineplus">+    Enigmail.hdrView.hdrViewLoad();</span>
<a href="#l1.38"></a><span id="l1.38" class="difflineplus">+  }</span>
<a href="#l1.39"></a><span id="l1.39"> }</span>
<a href="#l1.40"></a><span id="l1.40"> </span>
<a href="#l1.41"></a><span id="l1.41"> function delayedOnLoadMessageWindow() {</span>
<a href="#l1.42"></a><span id="l1.42">   HideMenus();</span>
<a href="#l1.43"></a><span id="l1.43">   ShowMenus();</span>
<a href="#l1.44"></a><span id="l1.44">   MailOfflineMgr.init();</span>
<a href="#l1.45"></a><span id="l1.45">   CreateMailWindowGlobals();</span>
<a href="#l1.46"></a><span id="l1.46">   verifyAccounts(null);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/msgHdrView.inc.xhtml</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/msgHdrView.inc.xhtml</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -3,16 +3,26 @@</span>
<a href="#l2.4"></a><span id="l2.4"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l2.5"></a><span id="l2.5"> </span>
<a href="#l2.6"></a><span id="l2.6">                         &lt;deck id=&quot;msgHeaderViewDeck&quot; selectedIndex=&quot;0&quot;</span>
<a href="#l2.7"></a><span id="l2.7">                               persist=&quot;selectedIndex&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9">                           &lt;!-- the message pane consists of 3 'boxes'. Box #2 is the expanded headers view (the default view) --&gt;</span>
<a href="#l2.10"></a><span id="l2.10">                           &lt;vbox id=&quot;expandedHeaderView&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+#ifdef MOZ_OPENPGP</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+                            &lt;vbox flex=&quot;1&quot; pack=&quot;start&quot;&gt;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+                              &lt;hbox flex=&quot;1&quot; align=&quot;center&quot;&gt;</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+                                &lt;label id=&quot;enigmailStatusText&quot; flex=&quot;1&quot;</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+                                       class=&quot;enigmailHeaderValue&quot;&gt;...</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+                                &lt;/label&gt;</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineplus">+                              &lt;/hbox&gt;</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+                            &lt;/vbox&gt;</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineplus">+#endif</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineplus">+</span>
<a href="#l2.22"></a><span id="l2.22">                             &lt;!-- a convenience box for ease of extension overlaying --&gt;</span>
<a href="#l2.23"></a><span id="l2.23">                             &lt;vbox id=&quot;expandedHeadersBox&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l2.24"></a><span id="l2.24"> </span>
<a href="#l2.25"></a><span id="l2.25">                               &lt;!-- This hbox has display:block set to imbue it with the HTML layout</span>
<a href="#l2.26"></a><span id="l2.26">                                    model. This lets us float the message header toolbar to the right</span>
<a href="#l2.27"></a><span id="l2.27">                                    so we don't waste space when the From field and the toolbar could</span>
<a href="#l2.28"></a><span id="l2.28">                                    fit alongside each other. --&gt;</span>
<a href="#l2.29"></a><span id="l2.29">                               &lt;hbox id=&quot;expandedHeadersTopBox&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/base/content/msgMail3PaneWindow.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/base/content/msgMail3PaneWindow.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -48,16 +48,19 @@ var { SessionStoreManager } = ChromeUtil</span>
<a href="#l3.4"></a><span id="l3.4"> var { SummaryFrameManager } = ChromeUtils.import(</span>
<a href="#l3.5"></a><span id="l3.5">   &quot;resource:///modules/SummaryFrameManager.jsm&quot;</span>
<a href="#l3.6"></a><span id="l3.6"> );</span>
<a href="#l3.7"></a><span id="l3.7"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l3.8"></a><span id="l3.8"> var { MailUtils } = ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l3.9"></a><span id="l3.9"> var { AppConstants } = ChromeUtils.import(</span>
<a href="#l3.10"></a><span id="l3.10">   &quot;resource://gre/modules/AppConstants.jsm&quot;</span>
<a href="#l3.11"></a><span id="l3.11"> );</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+var { MailConstants } = ChromeUtils.import(</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+  &quot;resource:///modules/MailConstants.jsm&quot;</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+);</span>
<a href="#l3.15"></a><span id="l3.15"> var { Color } = ChromeUtils.import(&quot;resource://gre/modules/Color.jsm&quot;);</span>
<a href="#l3.16"></a><span id="l3.16"> var { TagUtils } = ChromeUtils.import(&quot;resource:///modules/TagUtils.jsm&quot;);</span>
<a href="#l3.17"></a><span id="l3.17"> var { PeriodicFilterManager } = ChromeUtils.import(</span>
<a href="#l3.18"></a><span id="l3.18">   &quot;resource:///modules/PeriodicFilterManager.jsm&quot;</span>
<a href="#l3.19"></a><span id="l3.19"> );</span>
<a href="#l3.20"></a><span id="l3.20"> </span>
<a href="#l3.21"></a><span id="l3.21"> XPCOMUtils.defineLazyModuleGetters(this, {</span>
<a href="#l3.22"></a><span id="l3.22">   LightweightThemeManager: &quot;resource://gre/modules/LightweightThemeManager.jsm&quot;,</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineat">@@ -603,16 +606,23 @@ function OnLoadMessenger() {</span>
<a href="#l3.24"></a><span id="l3.24">     // Show on a timeout so the main window has time to open. Otherwise</span>
<a href="#l3.25"></a><span id="l3.25">     // the dialog would be confusingly showing out of context.</span>
<a href="#l3.26"></a><span id="l3.26">     setTimeout(() =&gt; _showNewInstallModal());</span>
<a href="#l3.27"></a><span id="l3.27">   } else if (verifyAccounts(LoadPostAccountWizard, false, AutoConfigWizard)) {</span>
<a href="#l3.28"></a><span id="l3.28">     // verifyAccounts returns true if the callback won't be called</span>
<a href="#l3.29"></a><span id="l3.29">     // We also don't want the account wizard to open if any sort of account exists</span>
<a href="#l3.30"></a><span id="l3.30">     LoadPostAccountWizard();</span>
<a href="#l3.31"></a><span id="l3.31">   }</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineplus">+  if (MailConstants.MOZ_OPENPGP) {</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineplus">+    Enigmail.msg.messengerStartup.bind(Enigmail.msg);</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineplus">+    Enigmail.msg.messengerStartup();</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineplus">+    Enigmail.hdrView.hdrViewLoad.bind(Enigmail.hdrView);</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineplus">+    Enigmail.hdrView.hdrViewLoad();</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineplus">+  }</span>
<a href="#l3.39"></a><span id="l3.39"> }</span>
<a href="#l3.40"></a><span id="l3.40"> </span>
<a href="#l3.41"></a><span id="l3.41"> function _showNewInstallModal() {</span>
<a href="#l3.42"></a><span id="l3.42">   Services.ww.openWindow(</span>
<a href="#l3.43"></a><span id="l3.43">     null,</span>
<a href="#l3.44"></a><span id="l3.44">     &quot;chrome://messenger/content/newInstall.xhtml&quot;,</span>
<a href="#l3.45"></a><span id="l3.45">     &quot;_blank&quot;,</span>
<a href="#l3.46"></a><span id="l3.46">     &quot;chrome,modal,resizable=no,centerscreen&quot;,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/extensions/am-e2e/prefs/e2e-prefs.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/extensions/am-e2e/prefs/e2e-prefs.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -52,19 +52,16 @@ pref(&quot;temp.openpgp.autoDecrypt&quot;, true);</span>
<a href="#l4.4"></a><span id="l4.4"> pref(&quot;temp.openpgp.addHeaders&quot;, false);</span>
<a href="#l4.5"></a><span id="l4.5"> </span>
<a href="#l4.6"></a><span id="l4.6"> // countdown for alerts when composing inline PGP HTML msgs</span>
<a href="#l4.7"></a><span id="l4.7"> pref(&quot;temp.openpgp.composeHtmlAlertCount&quot;, 3);</span>
<a href="#l4.8"></a><span id="l4.8"> </span>
<a href="#l4.9"></a><span id="l4.9"> // show warning message when clicking on sign icon</span>
<a href="#l4.10"></a><span id="l4.10"> pref(&quot;temp.openpgp.displaySignWarn&quot;, true);</span>
<a href="#l4.11"></a><span id="l4.11"> </span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-// display warning as info for partially signed message</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-pref(&quot;temp.openpgp.displayPartiallySigned&quot;, true);</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-</span>
<a href="#l4.15"></a><span id="l4.15"> // try to match secondary uid to from address</span>
<a href="#l4.16"></a><span id="l4.16"> pref(&quot;temp.openpgp.displaySecondaryUid&quot;, true);</span>
<a href="#l4.17"></a><span id="l4.17"> </span>
<a href="#l4.18"></a><span id="l4.18"> // treat '-- ' as signature separator</span>
<a href="#l4.19"></a><span id="l4.19"> pref(&quot;temp.openpgp.doubleDashSeparator&quot;, true);</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21"> // skip the attachments dialog</span>
<a href="#l4.22"></a><span id="l4.22"> pref(&quot;temp.openpgp.encryptAttachmentsSkipDlg&quot;, 0);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/cryptoAPI/RNPCryptoAPI.jsm</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/cryptoAPI/RNPCryptoAPI.jsm</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -177,18 +177,16 @@ class RNPCryptoAPI extends CryptoAPI {</span>
<a href="#l5.4"></a><span id="l5.4">    * status information</span>
<a href="#l5.5"></a><span id="l5.5">    *</span>
<a href="#l5.6"></a><span id="l5.6">    * Use Promise.catch to handle failed decryption.</span>
<a href="#l5.7"></a><span id="l5.7">    * retObj.errorMsg will be an error message in this case.</span>
<a href="#l5.8"></a><span id="l5.8">    */</span>
<a href="#l5.9"></a><span id="l5.9"> </span>
<a href="#l5.10"></a><span id="l5.10">   async decrypt(encrypted, options) {</span>
<a href="#l5.11"></a><span id="l5.11">     EnigmailLog.DEBUG(`rnp-cryptoAPI.js: decrypt()\n`);</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-    console.log(&quot;rnp decrypt() options:&quot;);</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-    console.log(options);</span>
<a href="#l5.14"></a><span id="l5.14"> </span>
<a href="#l5.15"></a><span id="l5.15">     let result = RNP.decrypt(encrypted, options);</span>
<a href="#l5.16"></a><span id="l5.16"> </span>
<a href="#l5.17"></a><span id="l5.17">     return result;</span>
<a href="#l5.18"></a><span id="l5.18">   }</span>
<a href="#l5.19"></a><span id="l5.19"> </span>
<a href="#l5.20"></a><span id="l5.20">   /**</span>
<a href="#l5.21"></a><span id="l5.21">    *</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineat">@@ -198,17 +196,16 @@ class RNPCryptoAPI extends CryptoAPI {</span>
<a href="#l5.23"></a><span id="l5.23">    * @return {Promise&lt;Object&gt;} - Return object with decryptedData and</span>
<a href="#l5.24"></a><span id="l5.24">    * status information</span>
<a href="#l5.25"></a><span id="l5.25">    *</span>
<a href="#l5.26"></a><span id="l5.26">    * Use Promise.catch to handle failed decryption.</span>
<a href="#l5.27"></a><span id="l5.27">    * retObj.errorMsg will be an error message in this case.</span>
<a href="#l5.28"></a><span id="l5.28">    */</span>
<a href="#l5.29"></a><span id="l5.29"> </span>
<a href="#l5.30"></a><span id="l5.30">   decryptMime(encrypted, options) {</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineminus">-    console.log(&quot;RNPCryptoAPI.jsm: decryptMime()&quot;);</span>
<a href="#l5.32"></a><span id="l5.32">     EnigmailLog.DEBUG(`rnp-cryptoAPI.js: decryptMime()\n`);</span>
<a href="#l5.33"></a><span id="l5.33"> </span>
<a href="#l5.34"></a><span id="l5.34">     // write something to gpg such that the process doesn't get stuck</span>
<a href="#l5.35"></a><span id="l5.35">     if (encrypted.length === 0) {</span>
<a href="#l5.36"></a><span id="l5.36">       encrypted = &quot;NO DATA\n&quot;;</span>
<a href="#l5.37"></a><span id="l5.37">     }</span>
<a href="#l5.38"></a><span id="l5.38"> </span>
<a href="#l5.39"></a><span id="l5.39">     options.noOutput = false;</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineat">@@ -226,24 +223,26 @@ class RNPCryptoAPI extends CryptoAPI {</span>
<a href="#l5.41"></a><span id="l5.41">    * @return {Promise&lt;Object&gt;} - Return object with decryptedData and</span>
<a href="#l5.42"></a><span id="l5.42">    * status information</span>
<a href="#l5.43"></a><span id="l5.43">    *</span>
<a href="#l5.44"></a><span id="l5.44">    * Use Promise.catch to handle failed decryption.</span>
<a href="#l5.45"></a><span id="l5.45">    * retObj.errorMsg will be an error message in this case.</span>
<a href="#l5.46"></a><span id="l5.46">    */</span>
<a href="#l5.47"></a><span id="l5.47"> </span>
<a href="#l5.48"></a><span id="l5.48">   async verifyMime(signed, options) {</span>
<a href="#l5.49"></a><span id="l5.49" class="difflineminus">-    console.log(&quot;RNPCryptoAPI.jsm: verifyMime()&quot;);</span>
<a href="#l5.50"></a><span id="l5.50">     EnigmailLog.DEBUG(`rnp-cryptoAPI.js: verifyMime()\n`);</span>
<a href="#l5.51"></a><span id="l5.51"> </span>
<a href="#l5.52"></a><span id="l5.52" class="difflineminus">-    options.noOutput = true;</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineminus">-    options.verifyOnly = true;</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineminus">-    options.uiFlags = EnigmailConstants.UI_PGP_MIME;</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineplus">+    //options.noOutput = true;</span>
<a href="#l5.56"></a><span id="l5.56" class="difflineplus">+    //options.verifyOnly = true;</span>
<a href="#l5.57"></a><span id="l5.57" class="difflineplus">+    //options.uiFlags = EnigmailConstants.UI_PGP_MIME;</span>
<a href="#l5.58"></a><span id="l5.58"> </span>
<a href="#l5.59"></a><span id="l5.59" class="difflineminus">-    return this.decrypt(signed, options);</span>
<a href="#l5.60"></a><span id="l5.60" class="difflineplus">+    if (!options.mimeSignatureFile) {</span>
<a href="#l5.61"></a><span id="l5.61" class="difflineplus">+      throw new Error(&quot;inline verify not yet implemented&quot;);</span>
<a href="#l5.62"></a><span id="l5.62" class="difflineplus">+    }</span>
<a href="#l5.63"></a><span id="l5.63" class="difflineplus">+    return RNP.verifyDetached(signed, options);</span>
<a href="#l5.64"></a><span id="l5.64">   }</span>
<a href="#l5.65"></a><span id="l5.65"> </span>
<a href="#l5.66"></a><span id="l5.66">   async getKeyListFromKeyBlock(keyBlockStr, pubkey, seckey) {</span>
<a href="#l5.67"></a><span id="l5.67">     return RNP.getKeyListFromKeyBlock(keyBlockStr, pubkey, seckey);</span>
<a href="#l5.68"></a><span id="l5.68">   }</span>
<a href="#l5.69"></a><span id="l5.69"> </span>
<a href="#l5.70"></a><span id="l5.70">   async genKey(userId, keyType, keySize, expiryTime, passphrase) {</span>
<a href="#l5.71"></a><span id="l5.71">     let id = RNP.genKey(userId, keyType, keySize, expiryTime, passphrase);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/decryption.jsm</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/decryption.jsm</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -155,18 +155,18 @@ var EnigmailDecryption = {</span>
<a href="#l6.4"></a><span id="l6.4">         uiFlags +</span>
<a href="#l6.5"></a><span id="l6.5">         &quot;)\n&quot;</span>
<a href="#l6.6"></a><span id="l6.6">     );</span>
<a href="#l6.7"></a><span id="l6.7"> </span>
<a href="#l6.8"></a><span id="l6.8">     if (!cipherText) {</span>
<a href="#l6.9"></a><span id="l6.9">       return &quot;&quot;;</span>
<a href="#l6.10"></a><span id="l6.10">     }</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-    var interactive = uiFlags &amp; EnigmailConstants.UI_INTERACTIVE;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-    var allowImport = uiFlags &amp; EnigmailConstants.UI_ALLOW_KEY_IMPORT;</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+    //var interactive = uiFlags &amp; EnigmailConstants.UI_INTERACTIVE;</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+    var allowImport = false; // uiFlags &amp; EnigmailConstants.UI_ALLOW_KEY_IMPORT;</span>
<a href="#l6.16"></a><span id="l6.16">     var unverifiedEncryptedOK =</span>
<a href="#l6.17"></a><span id="l6.17">       uiFlags &amp; EnigmailConstants.UI_UNVERIFIED_ENC_OK;</span>
<a href="#l6.18"></a><span id="l6.18">     var oldSignature = signatureObj.value;</span>
<a href="#l6.19"></a><span id="l6.19"> </span>
<a href="#l6.20"></a><span id="l6.20">     EnigmailLog.DEBUG(</span>
<a href="#l6.21"></a><span id="l6.21">       &quot;decryption.jsm: decryptMessage: oldSignature=&quot; + oldSignature + &quot;\n&quot;</span>
<a href="#l6.22"></a><span id="l6.22">     );</span>
<a href="#l6.23"></a><span id="l6.23"> </span>
<a href="#l6.24"></a><span id="l6.24" class="difflineat">@@ -191,16 +191,24 @@ var EnigmailDecryption = {</span>
<a href="#l6.25"></a><span id="l6.25">     if (!blockType || blockType == &quot;SIGNATURE&quot;) {</span>
<a href="#l6.26"></a><span id="l6.26">       // return without displaying a message</span>
<a href="#l6.27"></a><span id="l6.27">       return &quot;&quot;;</span>
<a href="#l6.28"></a><span id="l6.28">     }</span>
<a href="#l6.29"></a><span id="l6.29"> </span>
<a href="#l6.30"></a><span id="l6.30">     var publicKey = blockType == &quot;PUBLIC KEY BLOCK&quot;;</span>
<a href="#l6.31"></a><span id="l6.31"> </span>
<a href="#l6.32"></a><span id="l6.32">     var verifyOnly = blockType == &quot;SIGNED MESSAGE&quot;;</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineplus">+    var isEncrypted = blockType == &quot;MESSAGE&quot;;</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineplus">+</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineplus">+    if (verifyOnly) {</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineplus">+      statusFlagsObj.value |= EnigmailConstants.PGP_MIME_SIGNED;</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineplus">+    }</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineplus">+    if (isEncrypted) {</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineplus">+      statusFlagsObj.value |= EnigmailConstants.PGP_MIME_ENCRYPTED;</span>
<a href="#l6.40"></a><span id="l6.40" class="difflineplus">+    }</span>
<a href="#l6.41"></a><span id="l6.41"> </span>
<a href="#l6.42"></a><span id="l6.42">     var pgpBlock = cipherText.substr(</span>
<a href="#l6.43"></a><span id="l6.43">       beginIndexObj.value,</span>
<a href="#l6.44"></a><span id="l6.44">       endIndexObj.value - beginIndexObj.value + 1</span>
<a href="#l6.45"></a><span id="l6.45">     );</span>
<a href="#l6.46"></a><span id="l6.46"> </span>
<a href="#l6.47"></a><span id="l6.47">     if (indentStrObj.value) {</span>
<a href="#l6.48"></a><span id="l6.48">       var indentRegexp = new RegExp(&quot;^&quot; + indentStrObj.value, &quot;gm&quot;);</span>
<a href="#l6.49"></a><span id="l6.49" class="difflineat">@@ -221,16 +229,17 @@ var EnigmailDecryption = {</span>
<a href="#l6.50"></a><span id="l6.50">     }</span>
<a href="#l6.51"></a><span id="l6.51"> </span>
<a href="#l6.52"></a><span id="l6.52">     var tail = cipherText.substr(</span>
<a href="#l6.53"></a><span id="l6.53">       endIndexObj.value + 1,</span>
<a href="#l6.54"></a><span id="l6.54">       cipherText.length - endIndexObj.value - 1</span>
<a href="#l6.55"></a><span id="l6.55">     );</span>
<a href="#l6.56"></a><span id="l6.56"> </span>
<a href="#l6.57"></a><span id="l6.57">     if (publicKey) {</span>
<a href="#l6.58"></a><span id="l6.58" class="difflineplus">+      // TODO: import key into our scratch area for new, unknown keys</span>
<a href="#l6.59"></a><span id="l6.59">       if (!allowImport) {</span>
<a href="#l6.60"></a><span id="l6.60">         errorMsgObj.value = EnigmailLocale.getString(&quot;keyInMessageBody&quot;);</span>
<a href="#l6.61"></a><span id="l6.61">         statusFlagsObj.value |= EnigmailConstants.DISPLAY_MESSAGE;</span>
<a href="#l6.62"></a><span id="l6.62">         statusFlagsObj.value |= EnigmailConstants.INLINE_KEY;</span>
<a href="#l6.63"></a><span id="l6.63"> </span>
<a href="#l6.64"></a><span id="l6.64">         return &quot;&quot;;</span>
<a href="#l6.65"></a><span id="l6.65">       }</span>
<a href="#l6.66"></a><span id="l6.66"> </span>
<a href="#l6.67"></a><span id="l6.67" class="difflineat">@@ -272,21 +281,23 @@ var EnigmailDecryption = {</span>
<a href="#l6.68"></a><span id="l6.68">       EnigmailLog.ERROR(</span>
<a href="#l6.69"></a><span id="l6.69">         &quot;decryption.jsm: decryptMessage: not yet initialized\n&quot;</span>
<a href="#l6.70"></a><span id="l6.70">       );</span>
<a href="#l6.71"></a><span id="l6.71">       errorMsgObj.value = EnigmailLocale.getString(&quot;notInit&quot;);</span>
<a href="#l6.72"></a><span id="l6.72">       statusFlagsObj.value |= EnigmailConstants.DISPLAY_MESSAGE;</span>
<a href="#l6.73"></a><span id="l6.73">       return &quot;&quot;;</span>
<a href="#l6.74"></a><span id="l6.74">     }</span>
<a href="#l6.75"></a><span id="l6.75"> </span>
<a href="#l6.76"></a><span id="l6.76" class="difflineplus">+    /*</span>
<a href="#l6.77"></a><span id="l6.77">     if (EnigmailKeyRing.isGeneratingKey()) {</span>
<a href="#l6.78"></a><span id="l6.78">       errorMsgObj.value = EnigmailLocale.getString(&quot;notComplete&quot;);</span>
<a href="#l6.79"></a><span id="l6.79">       statusFlagsObj.value |= EnigmailConstants.DISPLAY_MESSAGE;</span>
<a href="#l6.80"></a><span id="l6.80">       return &quot;&quot;;</span>
<a href="#l6.81"></a><span id="l6.81">     }</span>
<a href="#l6.82"></a><span id="l6.82" class="difflineplus">+    */</span>
<a href="#l6.83"></a><span id="l6.83"> </span>
<a href="#l6.84"></a><span id="l6.84">     // limit output to 100 times message size to avoid DoS attack</span>
<a href="#l6.85"></a><span id="l6.85">     var maxOutput = pgpBlock.length * 100;</span>
<a href="#l6.86"></a><span id="l6.86">     let keyserver = EnigmailPrefs.getPref(&quot;autoKeyRetrieve&quot;);</span>
<a href="#l6.87"></a><span id="l6.87">     let options = {</span>
<a href="#l6.88"></a><span id="l6.88">       keyserver,</span>
<a href="#l6.89"></a><span id="l6.89">       keyserverProxy: EnigmailHttpProxy.getHttpProxy(keyserver),</span>
<a href="#l6.90"></a><span id="l6.90">       fromAddr: EnigmailDecryption.getFromAddr(parent),</span>
<a href="#l6.91"></a><span id="l6.91" class="difflineat">@@ -381,16 +392,18 @@ var EnigmailDecryption = {</span>
<a href="#l6.92"></a><span id="l6.92">       }</span>
<a href="#l6.93"></a><span id="l6.93"> </span>
<a href="#l6.94"></a><span id="l6.94">       // Return bad signature (for checking later)</span>
<a href="#l6.95"></a><span id="l6.95">       signatureObj.value = newSignature;</span>
<a href="#l6.96"></a><span id="l6.96">     } else if (</span>
<a href="#l6.97"></a><span id="l6.97">       pubKeyId &amp;&amp;</span>
<a href="#l6.98"></a><span id="l6.98">       statusFlagsObj.value &amp; EnigmailConstants.UNVERIFIED_SIGNATURE</span>
<a href="#l6.99"></a><span id="l6.99">     ) {</span>
<a href="#l6.100"></a><span id="l6.100" class="difflineplus">+      // TODO: import into scratch area</span>
<a href="#l6.101"></a><span id="l6.101" class="difflineplus">+      /*</span>
<a href="#l6.102"></a><span id="l6.102">       var innerKeyBlock;</span>
<a href="#l6.103"></a><span id="l6.103">       if (verifyOnly) {</span>
<a href="#l6.104"></a><span id="l6.104">         // Search for indented public key block in signed message</span>
<a href="#l6.105"></a><span id="l6.105">         var innerBlockType = EnigmailArmor.locateArmoredBlock(</span>
<a href="#l6.106"></a><span id="l6.106">           pgpBlock,</span>
<a href="#l6.107"></a><span id="l6.107">           0,</span>
<a href="#l6.108"></a><span id="l6.108">           &quot;- &quot;,</span>
<a href="#l6.109"></a><span id="l6.109">           beginIndexObj,</span>
<a href="#l6.110"></a><span id="l6.110" class="difflineat">@@ -407,59 +420,58 @@ var EnigmailDecryption = {</span>
<a href="#l6.111"></a><span id="l6.111"> </span>
<a href="#l6.112"></a><span id="l6.112">           statusFlagsObj.value |= EnigmailConstants.INLINE_KEY;</span>
<a href="#l6.113"></a><span id="l6.113">           EnigmailLog.DEBUG(</span>
<a href="#l6.114"></a><span id="l6.114">             &quot;decryption.jsm: decryptMessage: innerKeyBlock found\n&quot;</span>
<a href="#l6.115"></a><span id="l6.115">           );</span>
<a href="#l6.116"></a><span id="l6.116">         }</span>
<a href="#l6.117"></a><span id="l6.117">       }</span>
<a href="#l6.118"></a><span id="l6.118"> </span>
<a href="#l6.119"></a><span id="l6.119" class="difflineminus">-      if (allowImport) {</span>
<a href="#l6.120"></a><span id="l6.120" class="difflineminus">-        var importedKey = false;</span>
<a href="#l6.121"></a><span id="l6.121" class="difflineminus">-</span>
<a href="#l6.122"></a><span id="l6.122" class="difflineminus">-        if (innerKeyBlock) {</span>
<a href="#l6.123"></a><span id="l6.123" class="difflineminus">-          var importErrorMsgObj = {};</span>
<a href="#l6.124"></a><span id="l6.124" class="difflineminus">-          var exitStatus = EnigmailKeyRing.importKey(</span>
<a href="#l6.125"></a><span id="l6.125" class="difflineminus">-            parent,</span>
<a href="#l6.126"></a><span id="l6.126" class="difflineminus">-            true,</span>
<a href="#l6.127"></a><span id="l6.127" class="difflineminus">-            innerKeyBlock,</span>
<a href="#l6.128"></a><span id="l6.128" class="difflineminus">-            pubKeyId,</span>
<a href="#l6.129"></a><span id="l6.129" class="difflineminus">-            importErrorMsgObj</span>
<a href="#l6.130"></a><span id="l6.130" class="difflineminus">-          );</span>
<a href="#l6.131"></a><span id="l6.131" class="difflineminus">-</span>
<a href="#l6.132"></a><span id="l6.132" class="difflineminus">-          importedKey = exitStatus === 0;</span>
<a href="#l6.133"></a><span id="l6.133" class="difflineplus">+      var importedKey = false;</span>
<a href="#l6.134"></a><span id="l6.134"> </span>
<a href="#l6.135"></a><span id="l6.135" class="difflineminus">-          if (exitStatus &gt; 0) {</span>
<a href="#l6.136"></a><span id="l6.136" class="difflineminus">-            EnigmailDialog.alert(</span>
<a href="#l6.137"></a><span id="l6.137" class="difflineminus">-              parent,</span>
<a href="#l6.138"></a><span id="l6.138" class="difflineminus">-              EnigmailLocale.getString(&quot;cantImport&quot;) + importErrorMsgObj.value</span>
<a href="#l6.139"></a><span id="l6.139" class="difflineminus">-            );</span>
<a href="#l6.140"></a><span id="l6.140" class="difflineminus">-          }</span>
<a href="#l6.141"></a><span id="l6.141" class="difflineminus">-        }</span>
<a href="#l6.142"></a><span id="l6.142" class="difflineplus">+      if (innerKeyBlock) {</span>
<a href="#l6.143"></a><span id="l6.143" class="difflineplus">+        var importErrorMsgObj = {};</span>
<a href="#l6.144"></a><span id="l6.144" class="difflineplus">+        var exitStatus = EnigmailKeyRing.importKey(</span>
<a href="#l6.145"></a><span id="l6.145" class="difflineplus">+          parent,</span>
<a href="#l6.146"></a><span id="l6.146" class="difflineplus">+          true,</span>
<a href="#l6.147"></a><span id="l6.147" class="difflineplus">+          innerKeyBlock,</span>
<a href="#l6.148"></a><span id="l6.148" class="difflineplus">+          pubKeyId,</span>
<a href="#l6.149"></a><span id="l6.149" class="difflineplus">+          importErrorMsgObj</span>
<a href="#l6.150"></a><span id="l6.150" class="difflineplus">+        );</span>
<a href="#l6.151"></a><span id="l6.151"> </span>
<a href="#l6.152"></a><span id="l6.152" class="difflineminus">-        if (importedKey) {</span>
<a href="#l6.153"></a><span id="l6.153" class="difflineminus">-          // Recursive call; note that EnigmailConstants.UI_ALLOW_KEY_IMPORT is unset</span>
<a href="#l6.154"></a><span id="l6.154" class="difflineminus">-          // to break the recursion</span>
<a href="#l6.155"></a><span id="l6.155" class="difflineminus">-          var uiFlagsDeep = interactive ? EnigmailConstants.UI_INTERACTIVE : 0;</span>
<a href="#l6.156"></a><span id="l6.156" class="difflineminus">-          signatureObj.value = &quot;&quot;;</span>
<a href="#l6.157"></a><span id="l6.157" class="difflineminus">-          return EnigmailDecryption.decryptMessage(</span>
<a href="#l6.158"></a><span id="l6.158" class="difflineplus">+        importedKey = exitStatus === 0;</span>
<a href="#l6.159"></a><span id="l6.159" class="difflineplus">+</span>
<a href="#l6.160"></a><span id="l6.160" class="difflineplus">+        if (exitStatus &gt; 0) {</span>
<a href="#l6.161"></a><span id="l6.161" class="difflineplus">+          EnigmailDialog.alert(</span>
<a href="#l6.162"></a><span id="l6.162">             parent,</span>
<a href="#l6.163"></a><span id="l6.163" class="difflineminus">-            uiFlagsDeep,</span>
<a href="#l6.164"></a><span id="l6.164" class="difflineminus">-            pgpBlock,</span>
<a href="#l6.165"></a><span id="l6.165" class="difflineminus">-            signatureObj,</span>
<a href="#l6.166"></a><span id="l6.166" class="difflineminus">-            exitCodeObj,</span>
<a href="#l6.167"></a><span id="l6.167" class="difflineminus">-            statusFlagsObj,</span>
<a href="#l6.168"></a><span id="l6.168" class="difflineminus">-            keyIdObj,</span>
<a href="#l6.169"></a><span id="l6.169" class="difflineminus">-            userIdObj,</span>
<a href="#l6.170"></a><span id="l6.170" class="difflineminus">-            sigDetailsObj,</span>
<a href="#l6.171"></a><span id="l6.171" class="difflineminus">-            errorMsgObj</span>
<a href="#l6.172"></a><span id="l6.172" class="difflineplus">+            EnigmailLocale.getString(&quot;cantImport&quot;) + importErrorMsgObj.value</span>
<a href="#l6.173"></a><span id="l6.173">           );</span>
<a href="#l6.174"></a><span id="l6.174">         }</span>
<a href="#l6.175"></a><span id="l6.175">       }</span>
<a href="#l6.176"></a><span id="l6.176"> </span>
<a href="#l6.177"></a><span id="l6.177" class="difflineplus">+      if (importedKey) {</span>
<a href="#l6.178"></a><span id="l6.178" class="difflineplus">+        // Recursive call; note that EnigmailConstants.UI_ALLOW_KEY_IMPORT is unset</span>
<a href="#l6.179"></a><span id="l6.179" class="difflineplus">+        // to break the recursion</span>
<a href="#l6.180"></a><span id="l6.180" class="difflineplus">+        var uiFlagsDeep = interactive ? EnigmailConstants.UI_INTERACTIVE : 0;</span>
<a href="#l6.181"></a><span id="l6.181" class="difflineplus">+        signatureObj.value = &quot;&quot;;</span>
<a href="#l6.182"></a><span id="l6.182" class="difflineplus">+        return EnigmailDecryption.decryptMessage(</span>
<a href="#l6.183"></a><span id="l6.183" class="difflineplus">+          parent,</span>
<a href="#l6.184"></a><span id="l6.184" class="difflineplus">+          uiFlagsDeep,</span>
<a href="#l6.185"></a><span id="l6.185" class="difflineplus">+          pgpBlock,</span>
<a href="#l6.186"></a><span id="l6.186" class="difflineplus">+          signatureObj,</span>
<a href="#l6.187"></a><span id="l6.187" class="difflineplus">+          exitCodeObj,</span>
<a href="#l6.188"></a><span id="l6.188" class="difflineplus">+          statusFlagsObj,</span>
<a href="#l6.189"></a><span id="l6.189" class="difflineplus">+          keyIdObj,</span>
<a href="#l6.190"></a><span id="l6.190" class="difflineplus">+          userIdObj,</span>
<a href="#l6.191"></a><span id="l6.191" class="difflineplus">+          sigDetailsObj,</span>
<a href="#l6.192"></a><span id="l6.192" class="difflineplus">+          errorMsgObj</span>
<a href="#l6.193"></a><span id="l6.193" class="difflineplus">+        );</span>
<a href="#l6.194"></a><span id="l6.194" class="difflineplus">+      }</span>
<a href="#l6.195"></a><span id="l6.195" class="difflineplus">+      */</span>
<a href="#l6.196"></a><span id="l6.196" class="difflineplus">+</span>
<a href="#l6.197"></a><span id="l6.197">       if (plainText &amp;&amp; !unverifiedEncryptedOK) {</span>
<a href="#l6.198"></a><span id="l6.198">         // Append original PGP block to unverified message</span>
<a href="#l6.199"></a><span id="l6.199">         plainText =</span>
<a href="#l6.200"></a><span id="l6.200">           &quot;-----BEGIN PGP UNVERIFIED MESSAGE-----\r\n&quot; +</span>
<a href="#l6.201"></a><span id="l6.201">           plainText +</span>
<a href="#l6.202"></a><span id="l6.202">           &quot;-----END PGP UNVERIFIED MESSAGE-----\r\n\r\n&quot; +</span>
<a href="#l6.203"></a><span id="l6.203">           pgpBlock;</span>
<a href="#l6.204"></a><span id="l6.204">       }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -170,18 +170,16 @@ function MimeDecryptHandler() {</span>
<a href="#l7.4"></a><span id="l7.4">   this.proc = null;</span>
<a href="#l7.5"></a><span id="l7.5">   this.statusDisplayed = false;</span>
<a href="#l7.6"></a><span id="l7.6">   this.uri = null;</span>
<a href="#l7.7"></a><span id="l7.7">   this.backgroundJob = false;</span>
<a href="#l7.8"></a><span id="l7.8">   this.decryptedHeaders = {};</span>
<a href="#l7.9"></a><span id="l7.9">   this.mimePartNumber = &quot;&quot;;</span>
<a href="#l7.10"></a><span id="l7.10">   this.dataIsBase64 = null;</span>
<a href="#l7.11"></a><span id="l7.11">   this.base64Cache = &quot;&quot;;</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-  this.onDataAvailable = this.onDataAvailable68;</span>
<a href="#l7.14"></a><span id="l7.14"> }</span>
<a href="#l7.15"></a><span id="l7.15"> </span>
<a href="#l7.16"></a><span id="l7.16"> MimeDecryptHandler.prototype = {</span>
<a href="#l7.17"></a><span id="l7.17">   inStream: Cc[&quot;@mozilla.org/scriptableinputstream;1&quot;].createInstance(</span>
<a href="#l7.18"></a><span id="l7.18">     Ci.nsIScriptableInputStream</span>
<a href="#l7.19"></a><span id="l7.19">   ),</span>
<a href="#l7.20"></a><span id="l7.20"> </span>
<a href="#l7.21"></a><span id="l7.21">   onStartRequest(request, uri) {</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineat">@@ -282,20 +280,17 @@ MimeDecryptHandler.prototype = {</span>
<a href="#l7.23"></a><span id="l7.23">       } else if (this.xferEncoding == ENCODING_QP) {</span>
<a href="#l7.24"></a><span id="l7.24">         this.cacheData(EnigmailData.decodeQuotedPrintable(data));</span>
<a href="#l7.25"></a><span id="l7.25">       } else {</span>
<a href="#l7.26"></a><span id="l7.26">         this.cacheData(data);</span>
<a href="#l7.27"></a><span id="l7.27">       }</span>
<a href="#l7.28"></a><span id="l7.28">     }</span>
<a href="#l7.29"></a><span id="l7.29">   },</span>
<a href="#l7.30"></a><span id="l7.30"> </span>
<a href="#l7.31"></a><span id="l7.31" class="difflineminus">-  /**</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineminus">-   * onDataAvailable for TB &gt;= 68</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineminus">-   */</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineminus">-  onDataAvailable68(req, stream, offset, count) {</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineplus">+  onDataAvailable(req, stream, offset, count) {</span>
<a href="#l7.36"></a><span id="l7.36">     // get data from libmime</span>
<a href="#l7.37"></a><span id="l7.37">     if (!this.initOk) {</span>
<a href="#l7.38"></a><span id="l7.38">       return;</span>
<a href="#l7.39"></a><span id="l7.39">     }</span>
<a href="#l7.40"></a><span id="l7.40">     this.inStream.init(stream);</span>
<a href="#l7.41"></a><span id="l7.41"> </span>
<a href="#l7.42"></a><span id="l7.42">     if (count &gt; 0) {</span>
<a href="#l7.43"></a><span id="l7.43">       var data = this.inStream.read(count);</span>
<a href="#l7.44"></a><span id="l7.44" class="difflineat">@@ -555,27 +550,37 @@ MimeDecryptHandler.prototype = {</span>
<a href="#l7.45"></a><span id="l7.45">       this.returnStatus = cApi.sync(cApi.decryptMime(this.outQueue, options));</span>
<a href="#l7.46"></a><span id="l7.46">       if (!this.returnStatus) {</span>
<a href="#l7.47"></a><span id="l7.47">         this.returnStatus = {</span>
<a href="#l7.48"></a><span id="l7.48">           decryptedData: &quot;&quot;,</span>
<a href="#l7.49"></a><span id="l7.49">           exitCode: -1,</span>
<a href="#l7.50"></a><span id="l7.50">           statusFlags: EnigmailConstants.DECRYPTION_FAILED,</span>
<a href="#l7.51"></a><span id="l7.51">         };</span>
<a href="#l7.52"></a><span id="l7.52">       }</span>
<a href="#l7.53"></a><span id="l7.53" class="difflineplus">+</span>
<a href="#l7.54"></a><span id="l7.54" class="difflineplus">+      this.returnStatus.statusFlags |= EnigmailConstants.PGP_MIME_ENCRYPTED;</span>
<a href="#l7.55"></a><span id="l7.55" class="difflineplus">+</span>
<a href="#l7.56"></a><span id="l7.56" class="difflineplus">+      if (this.returnStatus.exitCode) {</span>
<a href="#l7.57"></a><span id="l7.57" class="difflineplus">+        this.returnStatus.statusFlags |= EnigmailConstants.DECRYPTION_FAILED;</span>
<a href="#l7.58"></a><span id="l7.58" class="difflineplus">+      } else if (</span>
<a href="#l7.59"></a><span id="l7.59" class="difflineplus">+        !(this.returnStatus.statusFlags &amp; EnigmailConstants.DECRYPTION_FAILED)</span>
<a href="#l7.60"></a><span id="l7.60" class="difflineplus">+      ) {</span>
<a href="#l7.61"></a><span id="l7.61" class="difflineplus">+        this.returnStatus.statusFlags |= EnigmailConstants.DECRYPTION_OKAY;</span>
<a href="#l7.62"></a><span id="l7.62" class="difflineplus">+      }</span>
<a href="#l7.63"></a><span id="l7.63" class="difflineplus">+</span>
<a href="#l7.64"></a><span id="l7.64">       this.decryptedData = this.returnStatus.decryptedData;</span>
<a href="#l7.65"></a><span id="l7.65">       this.handleResult(this.returnStatus.exitCode);</span>
<a href="#l7.66"></a><span id="l7.66"> </span>
<a href="#l7.67"></a><span id="l7.67" class="difflineminus">-      let mdcError =</span>
<a href="#l7.68"></a><span id="l7.68" class="difflineminus">-        this.returnStatus.statusFlags &amp; EnigmailConstants.DECRYPTION_FAILED ||</span>
<a href="#l7.69"></a><span id="l7.69" class="difflineminus">-        !(this.returnStatus.statusFlags &amp; EnigmailConstants.DECRYPTION_OKAY);</span>
<a href="#l7.70"></a><span id="l7.70" class="difflineplus">+      let decError =</span>
<a href="#l7.71"></a><span id="l7.71" class="difflineplus">+        this.returnStatus.statusFlags &amp; EnigmailConstants.DECRYPTION_FAILED;</span>
<a href="#l7.72"></a><span id="l7.72"> </span>
<a href="#l7.73"></a><span id="l7.73">       if (!this.isUrlEnigmailConvert()) {</span>
<a href="#l7.74"></a><span id="l7.74">         // don't return decrypted data if decryption failed (because it's likely an MDC error),</span>
<a href="#l7.75"></a><span id="l7.75">         // unless we are called for permanent decryption</span>
<a href="#l7.76"></a><span id="l7.76" class="difflineminus">-        if (mdcError) {</span>
<a href="#l7.77"></a><span id="l7.77" class="difflineplus">+        if (decError) {</span>
<a href="#l7.78"></a><span id="l7.78">           this.decryptedData = &quot;&quot;;</span>
<a href="#l7.79"></a><span id="l7.79">         }</span>
<a href="#l7.80"></a><span id="l7.80">       }</span>
<a href="#l7.81"></a><span id="l7.81"> </span>
<a href="#l7.82"></a><span id="l7.82">       this.displayStatus();</span>
<a href="#l7.83"></a><span id="l7.83"> </span>
<a href="#l7.84"></a><span id="l7.84">       // HACK: remove filename from 1st HTML and plaintext parts to make TB display message without attachment</span>
<a href="#l7.85"></a><span id="l7.85">       this.decryptedData = this.decryptedData.replace(</span>
<a href="#l7.86"></a><span id="l7.86" class="difflineat">@@ -595,17 +600,17 @@ MimeDecryptHandler.prototype = {</span>
<a href="#l7.87"></a><span id="l7.87"> </span>
<a href="#l7.88"></a><span id="l7.88">       // don't remember the last message if it contains an embedded PGP/MIME message</span>
<a href="#l7.89"></a><span id="l7.89">       // to avoid ending up in a loop</span>
<a href="#l7.90"></a><span id="l7.90">       if (</span>
<a href="#l7.91"></a><span id="l7.91">         this.mimePartNumber === &quot;1&quot; &amp;&amp;</span>
<a href="#l7.92"></a><span id="l7.92">         this.decryptedData.search(</span>
<a href="#l7.93"></a><span id="l7.93">           /^Content-Type:[\t ]+multipart\/encrypted/im</span>
<a href="#l7.94"></a><span id="l7.94">         ) &lt; 0 &amp;&amp;</span>
<a href="#l7.95"></a><span id="l7.95" class="difflineminus">-        !mdcError</span>
<a href="#l7.96"></a><span id="l7.96" class="difflineplus">+        !decError</span>
<a href="#l7.97"></a><span id="l7.97">       ) {</span>
<a href="#l7.98"></a><span id="l7.98">         LAST_MSG.lastMessageData = this.decryptedData;</span>
<a href="#l7.99"></a><span id="l7.99">         LAST_MSG.lastMessageURI = currMsg;</span>
<a href="#l7.100"></a><span id="l7.100">         LAST_MSG.lastStatus = this.returnStatus;</span>
<a href="#l7.101"></a><span id="l7.101">         LAST_MSG.lastStatus.decryptedHeaders = this.decryptedHeaders;</span>
<a href="#l7.102"></a><span id="l7.102">         LAST_MSG.lastStatus.mimePartNumber = this.mimePartNumber;</span>
<a href="#l7.103"></a><span id="l7.103">       } else {</span>
<a href="#l7.104"></a><span id="l7.104">         LAST_MSG.lastMessageURI = null;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/mimeEncrypt.jsm</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/mimeEncrypt.jsm</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -54,38 +54,30 @@ const MIME_ENCRYPTED = 2;</span>
<a href="#l8.4"></a><span id="l8.4"> </span>
<a href="#l8.5"></a><span id="l8.5"> var gDebugLogLevel = 0;</span>
<a href="#l8.6"></a><span id="l8.6"> </span>
<a href="#l8.7"></a><span id="l8.7"> function PgpMimeEncrypt(sMimeSecurityInfo) {</span>
<a href="#l8.8"></a><span id="l8.8">   this.wrappedJSObject = this;</span>
<a href="#l8.9"></a><span id="l8.9">   console.debug(`in PgpMimeEncrypt: wrappedJSObject:`);</span>
<a href="#l8.10"></a><span id="l8.10">   console.debug(this);</span>
<a href="#l8.11"></a><span id="l8.11"> </span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-  // nsIMsgSMIMECompFields</span>
<a href="#l8.13"></a><span id="l8.13">   this.signMessage = false;</span>
<a href="#l8.14"></a><span id="l8.14">   this.requireEncryptMessage = false;</span>
<a href="#l8.15"></a><span id="l8.15"> </span>
<a href="#l8.16"></a><span id="l8.16">   // &quot;securityInfo&quot; variables</span>
<a href="#l8.17"></a><span id="l8.17">   this.sendFlags = 0;</span>
<a href="#l8.18"></a><span id="l8.18">   this.UIFlags = 0;</span>
<a href="#l8.19"></a><span id="l8.19">   this.senderEmailAddr = &quot;&quot;;</span>
<a href="#l8.20"></a><span id="l8.20">   this.recipients = &quot;&quot;;</span>
<a href="#l8.21"></a><span id="l8.21">   this.bccRecipients = &quot;&quot;;</span>
<a href="#l8.22"></a><span id="l8.22">   this.originalSubject = null;</span>
<a href="#l8.23"></a><span id="l8.23">   this.keyMap = {};</span>
<a href="#l8.24"></a><span id="l8.24"> </span>
<a href="#l8.25"></a><span id="l8.25" class="difflineminus">-  this.onDataAvailable = this.onDataAvailable68;</span>
<a href="#l8.26"></a><span id="l8.26" class="difflineminus">-</span>
<a href="#l8.27"></a><span id="l8.27">   try {</span>
<a href="#l8.28"></a><span id="l8.28">     if (sMimeSecurityInfo) {</span>
<a href="#l8.29"></a><span id="l8.29" class="difflineminus">-      if (&quot;nsIMsgSMIMECompFields&quot; in Ci) {</span>
<a href="#l8.30"></a><span id="l8.30" class="difflineminus">-        sMimeSecurityInfo = sMimeSecurityInfo.QueryInterface(</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineminus">-          Ci.nsIMsgSMIMECompFields</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineminus">-        );</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineminus">-      }</span>
<a href="#l8.34"></a><span id="l8.34">       this.signMessage = sMimeSecurityInfo.signMessage;</span>
<a href="#l8.35"></a><span id="l8.35">       this.requireEncryptMessage = sMimeSecurityInfo.requireEncryptMessage;</span>
<a href="#l8.36"></a><span id="l8.36">     }</span>
<a href="#l8.37"></a><span id="l8.37">   } catch (ex) {}</span>
<a href="#l8.38"></a><span id="l8.38"> }</span>
<a href="#l8.39"></a><span id="l8.39"> </span>
<a href="#l8.40"></a><span id="l8.40"> PgpMimeEncrypt.prototype = {</span>
<a href="#l8.41"></a><span id="l8.41">   classDescription: &quot;Enigmail JS Encryption Handler&quot;,</span>
<a href="#l8.42"></a><span id="l8.42" class="difflineat">@@ -135,17 +127,17 @@ PgpMimeEncrypt.prototype = {</span>
<a href="#l8.43"></a><span id="l8.43">   checkSMime: true,</span>
<a href="#l8.44"></a><span id="l8.44"> </span>
<a href="#l8.45"></a><span id="l8.45">   // nsIStreamListener interface</span>
<a href="#l8.46"></a><span id="l8.46">   onStartRequest(request) {</span>
<a href="#l8.47"></a><span id="l8.47">     EnigmailLog.DEBUG(&quot;mimeEncrypt.js: onStartRequest\n&quot;);</span>
<a href="#l8.48"></a><span id="l8.48">     this.encHeader = null;</span>
<a href="#l8.49"></a><span id="l8.49">   },</span>
<a href="#l8.50"></a><span id="l8.50"> </span>
<a href="#l8.51"></a><span id="l8.51" class="difflineminus">-  onDataAvailable68(req, stream, offset, count) {</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineplus">+  onDataAvailable(req, stream, offset, count) {</span>
<a href="#l8.53"></a><span id="l8.53">     LOCAL_DEBUG(&quot;mimeEncrypt.js: onDataAvailable\n&quot;);</span>
<a href="#l8.54"></a><span id="l8.54">     this.inStream.init(stream);</span>
<a href="#l8.55"></a><span id="l8.55">     //var data = this.inStream.read(count);</span>
<a href="#l8.56"></a><span id="l8.56">     //LOCAL_DEBUG(&quot;mimeEncrypt.js: &gt;&quot;+data+&quot;&lt;\n&quot;);</span>
<a href="#l8.57"></a><span id="l8.57">   },</span>
<a href="#l8.58"></a><span id="l8.58"> </span>
<a href="#l8.59"></a><span id="l8.59">   onStopRequest(request, status) {</span>
<a href="#l8.60"></a><span id="l8.60">     EnigmailLog.DEBUG(&quot;mimeEncrypt.js: onStopRequest\n&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/mimeVerify.jsm</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/mimeVerify.jsm</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -62,18 +62,16 @@ function MimeVerify(protocol) {</span>
<a href="#l9.4"></a><span id="l9.4"> </span>
<a href="#l9.5"></a><span id="l9.5">   this.protocol = protocol;</span>
<a href="#l9.6"></a><span id="l9.6">   this.verifyEmbedded = false;</span>
<a href="#l9.7"></a><span id="l9.7">   this.partiallySigned = false;</span>
<a href="#l9.8"></a><span id="l9.8">   this.exitCode = null;</span>
<a href="#l9.9"></a><span id="l9.9">   this.inStream = Cc[&quot;@mozilla.org/scriptableinputstream;1&quot;].createInstance(</span>
<a href="#l9.10"></a><span id="l9.10">     Ci.nsIScriptableInputStream</span>
<a href="#l9.11"></a><span id="l9.11">   );</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-  this.onDataAvailable = this.onDataAvailable68;</span>
<a href="#l9.14"></a><span id="l9.14"> }</span>
<a href="#l9.15"></a><span id="l9.15"> </span>
<a href="#l9.16"></a><span id="l9.16"> var EnigmailVerify = {</span>
<a href="#l9.17"></a><span id="l9.17">   lastMsgWindow: null,</span>
<a href="#l9.18"></a><span id="l9.18">   lastMsgUri: null,</span>
<a href="#l9.19"></a><span id="l9.19">   manualMsgUri: null,</span>
<a href="#l9.20"></a><span id="l9.20"> </span>
<a href="#l9.21"></a><span id="l9.21">   currentCtHandler: EnigmailConstants.MIME_HANDLER_UNDEF,</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineat">@@ -246,33 +244,18 @@ MimeVerify.prototype = {</span>
<a href="#l9.23"></a><span id="l9.23">     this.signedData = &quot;&quot;;</span>
<a href="#l9.24"></a><span id="l9.24">     this.statusStr = &quot;&quot;;</span>
<a href="#l9.25"></a><span id="l9.25">     this.returnStatus = null;</span>
<a href="#l9.26"></a><span id="l9.26">     this.statusDisplayed = false;</span>
<a href="#l9.27"></a><span id="l9.27">     this.protectedHeaders = null;</span>
<a href="#l9.28"></a><span id="l9.28">     this.parseContentType();</span>
<a href="#l9.29"></a><span id="l9.29">   },</span>
<a href="#l9.30"></a><span id="l9.30"> </span>
<a href="#l9.31"></a><span id="l9.31" class="difflineminus">-  /**</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineminus">-   * onDataAvailable for TB &lt;= 66</span>
<a href="#l9.33"></a><span id="l9.33" class="difflineminus">-   */</span>
<a href="#l9.34"></a><span id="l9.34" class="difflineminus">-  onDataAvailable60(req, ctxt, stream, offset, count) {</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineminus">-    LOCAL_DEBUG(&quot;mimeVerify.jsm: onDataAvailable60: &quot; + count + &quot;\n&quot;);</span>
<a href="#l9.36"></a><span id="l9.36" class="difflineminus">-    if (count &gt; 0) {</span>
<a href="#l9.37"></a><span id="l9.37" class="difflineminus">-      this.inStream.init(stream);</span>
<a href="#l9.38"></a><span id="l9.38" class="difflineminus">-      var data = this.inStream.read(count);</span>
<a href="#l9.39"></a><span id="l9.39" class="difflineminus">-      this.onTextData(data);</span>
<a href="#l9.40"></a><span id="l9.40" class="difflineminus">-    }</span>
<a href="#l9.41"></a><span id="l9.41" class="difflineminus">-  },</span>
<a href="#l9.42"></a><span id="l9.42" class="difflineminus">-</span>
<a href="#l9.43"></a><span id="l9.43" class="difflineminus">-  /**</span>
<a href="#l9.44"></a><span id="l9.44" class="difflineminus">-   * onDataAvailable for TB &gt;= 67</span>
<a href="#l9.45"></a><span id="l9.45" class="difflineminus">-   */</span>
<a href="#l9.46"></a><span id="l9.46" class="difflineminus">-  onDataAvailable68(req, stream, offset, count) {</span>
<a href="#l9.47"></a><span id="l9.47" class="difflineminus">-    LOCAL_DEBUG(&quot;mimeVerify.jsm: onDataAvailable68: &quot; + count + &quot;\n&quot;);</span>
<a href="#l9.48"></a><span id="l9.48" class="difflineplus">+  onDataAvailable(req, stream, offset, count) {</span>
<a href="#l9.49"></a><span id="l9.49" class="difflineplus">+    LOCAL_DEBUG(&quot;mimeVerify.jsm: onDataAvailable: &quot; + count + &quot;\n&quot;);</span>
<a href="#l9.50"></a><span id="l9.50">     if (count &gt; 0) {</span>
<a href="#l9.51"></a><span id="l9.51">       this.inStream.init(stream);</span>
<a href="#l9.52"></a><span id="l9.52">       var data = this.inStream.read(count);</span>
<a href="#l9.53"></a><span id="l9.53">       this.onTextData(data);</span>
<a href="#l9.54"></a><span id="l9.54">     }</span>
<a href="#l9.55"></a><span id="l9.55">   },</span>
<a href="#l9.56"></a><span id="l9.56"> </span>
<a href="#l9.57"></a><span id="l9.57">   onTextData(data) {</span>
<a href="#l9.58"></a><span id="l9.58" class="difflineat">@@ -577,16 +560,18 @@ MimeVerify.prototype = {</span>
<a href="#l9.59"></a><span id="l9.59">         this.signedData = this.signedData</span>
<a href="#l9.60"></a><span id="l9.60">           .replace(/\r\n/g, &quot;\n&quot;)</span>
<a href="#l9.61"></a><span id="l9.61">           .replace(/\n/g, &quot;\r\n&quot;);</span>
<a href="#l9.62"></a><span id="l9.62">       }</span>
<a href="#l9.63"></a><span id="l9.63"> </span>
<a href="#l9.64"></a><span id="l9.64">       this.returnStatus = cApi.sync(cApi.verifyMime(this.signedData, options));</span>
<a href="#l9.65"></a><span id="l9.65">       this.exitCode = this.returnStatus.exitCode;</span>
<a href="#l9.66"></a><span id="l9.66"> </span>
<a href="#l9.67"></a><span id="l9.67" class="difflineplus">+      this.returnStatus.statusFlags |= EnigmailConstants.PGP_MIME_SIGNED;</span>
<a href="#l9.68"></a><span id="l9.68" class="difflineplus">+</span>
<a href="#l9.69"></a><span id="l9.69">       if (this.partiallySigned) {</span>
<a href="#l9.70"></a><span id="l9.70">         this.returnStatus.statusFlags |= EnigmailConstants.PARTIALLY_PGP;</span>
<a href="#l9.71"></a><span id="l9.71">       }</span>
<a href="#l9.72"></a><span id="l9.72"> </span>
<a href="#l9.73"></a><span id="l9.73">       this.displayStatus();</span>
<a href="#l9.74"></a><span id="l9.74"> </span>
<a href="#l9.75"></a><span id="l9.75">       if (this.sigFile) {</span>
<a href="#l9.76"></a><span id="l9.76">         this.sigFile.remove(false);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/msgRead.jsm</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/msgRead.jsm</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -250,43 +250,48 @@ var EnigmailMsgRead = {</span>
<a href="#l10.4"></a><span id="l10.4">    */</span>
<a href="#l10.5"></a><span id="l10.5">   matchUidToSender(keyId, fromAddr) {</span>
<a href="#l10.6"></a><span id="l10.6">     if (!fromAddr || !keyId) {</span>
<a href="#l10.7"></a><span id="l10.7">       return null;</span>
<a href="#l10.8"></a><span id="l10.8">     }</span>
<a href="#l10.9"></a><span id="l10.9"> </span>
<a href="#l10.10"></a><span id="l10.10">     try {</span>
<a href="#l10.11"></a><span id="l10.11">       fromAddr = EnigmailFuncs.stripEmail(fromAddr).toLowerCase();</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-    } catch (ex) {}</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+    } catch (ex) {</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+      console.debug(ex);</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+    }</span>
<a href="#l10.16"></a><span id="l10.16"> </span>
<a href="#l10.17"></a><span id="l10.17">     let keyObj = EnigmailKeyRing.getKeyById(keyId);</span>
<a href="#l10.18"></a><span id="l10.18">     if (!keyObj) {</span>
<a href="#l10.19"></a><span id="l10.19">       return null;</span>
<a href="#l10.20"></a><span id="l10.20">     }</span>
<a href="#l10.21"></a><span id="l10.21"> </span>
<a href="#l10.22"></a><span id="l10.22">     let userIdList = keyObj.userIds;</span>
<a href="#l10.23"></a><span id="l10.23"> </span>
<a href="#l10.24"></a><span id="l10.24">     try {</span>
<a href="#l10.25"></a><span id="l10.25">       for (let i = 0; i &lt; userIdList.length; i++) {</span>
<a href="#l10.26"></a><span id="l10.26">         if (</span>
<a href="#l10.27"></a><span id="l10.27">           fromAddr ==</span>
<a href="#l10.28"></a><span id="l10.28">           EnigmailFuncs.stripEmail(userIdList[i].userId).toLowerCase()</span>
<a href="#l10.29"></a><span id="l10.29">         ) {</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineminus">-          return EnigmailFuncs.stripEmail(userIdList[i].userId);</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineplus">+          let result = EnigmailFuncs.stripEmail(userIdList[i].userId);</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+          return result;</span>
<a href="#l10.33"></a><span id="l10.33">         }</span>
<a href="#l10.34"></a><span id="l10.34">       }</span>
<a href="#l10.35"></a><span id="l10.35"> </span>
<a href="#l10.36"></a><span id="l10.36">       // // uid not found, try Autocrypt keystore</span>
<a href="#l10.37"></a><span id="l10.37">       // let acList = await EnigmailAutocrypt.getOpenPGPKeyForEmail([fromAddr]);</span>
<a href="#l10.38"></a><span id="l10.38">       // for (let i = 0; i &lt; acList.length; i++) {</span>
<a href="#l10.39"></a><span id="l10.39">       //   if (acList[i].fpr == keyObj.fpr) {</span>
<a href="#l10.40"></a><span id="l10.40">       //     return fromAddr;</span>
<a href="#l10.41"></a><span id="l10.41">       //   }</span>
<a href="#l10.42"></a><span id="l10.42">       // }</span>
<a href="#l10.43"></a><span id="l10.43" class="difflineminus">-    } catch (ex) {}</span>
<a href="#l10.44"></a><span id="l10.44" class="difflineplus">+    } catch (ex) {</span>
<a href="#l10.45"></a><span id="l10.45" class="difflineplus">+      console.debug(ex);</span>
<a href="#l10.46"></a><span id="l10.46" class="difflineplus">+    }</span>
<a href="#l10.47"></a><span id="l10.47">     return null;</span>
<a href="#l10.48"></a><span id="l10.48">   },</span>
<a href="#l10.49"></a><span id="l10.49"> </span>
<a href="#l10.50"></a><span id="l10.50">   searchQuotedPgp(node) {</span>
<a href="#l10.51"></a><span id="l10.51">     if (</span>
<a href="#l10.52"></a><span id="l10.52">       node.nodeName.toLowerCase() === &quot;blockquote&quot; &amp;&amp;</span>
<a href="#l10.53"></a><span id="l10.53">       node.textContent.includes(&quot;-----BEGIN PGP &quot;)</span>
<a href="#l10.54"></a><span id="l10.54">     ) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/rnp.jsm</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/rnp.jsm</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -103,17 +103,17 @@ var RNP = {</span>
<a href="#l11.4"></a><span id="l11.4"> </span>
<a href="#l11.5"></a><span id="l11.5">     if (RNPLib.rnp_key_get_creation(handle, key_creation.address())) {</span>
<a href="#l11.6"></a><span id="l11.6">       throw new Error(&quot;rnp_key_get_creation failed&quot;);</span>
<a href="#l11.7"></a><span id="l11.7">     }</span>
<a href="#l11.8"></a><span id="l11.8">     keyObj.keyCreated = key_creation.value;</span>
<a href="#l11.9"></a><span id="l11.9">     keyObj.created = EnigmailTime.getDateTime(keyObj.keyCreated, true, false);</span>
<a href="#l11.10"></a><span id="l11.10"> </span>
<a href="#l11.11"></a><span id="l11.11">     if (RNPLib.rnp_key_get_expiration(handle, key_expiration.address())) {</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-      throw new Error(&quot;rnp_key_get_creation failed&quot;);</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+      throw new Error(&quot;rnp_key_get_expiration failed&quot;);</span>
<a href="#l11.14"></a><span id="l11.14">     }</span>
<a href="#l11.15"></a><span id="l11.15">     if (key_expiration.value &gt; 0) {</span>
<a href="#l11.16"></a><span id="l11.16">       keyObj.expiryTime = keyObj.keyCreated + key_expiration.value;</span>
<a href="#l11.17"></a><span id="l11.17">     } else {</span>
<a href="#l11.18"></a><span id="l11.18">       keyObj.expiryTime = 0;</span>
<a href="#l11.19"></a><span id="l11.19">     }</span>
<a href="#l11.20"></a><span id="l11.20">     keyObj.expiry = EnigmailTime.getDateTime(keyObj.expiryTime, true, false);</span>
<a href="#l11.21"></a><span id="l11.21"> </span>
<a href="#l11.22"></a><span id="l11.22" class="difflineat">@@ -360,26 +360,16 @@ var RNP = {</span>
<a href="#l11.23"></a><span id="l11.23">     }</span>
<a href="#l11.24"></a><span id="l11.24"> </span>
<a href="#l11.25"></a><span id="l11.25">     return true;</span>
<a href="#l11.26"></a><span id="l11.26">   },</span>
<a href="#l11.27"></a><span id="l11.27"> </span>
<a href="#l11.28"></a><span id="l11.28">   decrypt(encrypted, options) {</span>
<a href="#l11.29"></a><span id="l11.29">     let input_from_memory = new RNPLib.rnp_input_t();</span>
<a href="#l11.30"></a><span id="l11.30"> </span>
<a href="#l11.31"></a><span id="l11.31" class="difflineminus">-    /*</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineminus">-    let uint8_array_type = ctypes.ArrayType(ctypes.uint8_t);</span>
<a href="#l11.33"></a><span id="l11.33" class="difflineminus">-    let encrypted_array = uint8_array_type(encrypted.length + 1);</span>
<a href="#l11.34"></a><span id="l11.34" class="difflineminus">-    </span>
<a href="#l11.35"></a><span id="l11.35" class="difflineminus">-    for (let i = 0; i &lt; encrypted.length; i++) {</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineminus">-      encrypted_array[i] = encrypted.charCodeAt(i);</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineminus">-    }</span>
<a href="#l11.38"></a><span id="l11.38" class="difflineminus">-    encrypted_array[encrypted.length] = 0;</span>
<a href="#l11.39"></a><span id="l11.39" class="difflineminus">-    */</span>
<a href="#l11.40"></a><span id="l11.40" class="difflineminus">-</span>
<a href="#l11.41"></a><span id="l11.41">     var tmp_array = ctypes.char.array()(encrypted);</span>
<a href="#l11.42"></a><span id="l11.42">     var encrypted_array = ctypes.cast(</span>
<a href="#l11.43"></a><span id="l11.43">       tmp_array,</span>
<a href="#l11.44"></a><span id="l11.44">       ctypes.uint8_t.array(encrypted.length)</span>
<a href="#l11.45"></a><span id="l11.45">     );</span>
<a href="#l11.46"></a><span id="l11.46"> </span>
<a href="#l11.47"></a><span id="l11.47">     RNPLib.rnp_input_from_memory(</span>
<a href="#l11.48"></a><span id="l11.48">       input_from_memory.address(),</span>
<a href="#l11.49"></a><span id="l11.49" class="difflineat">@@ -392,56 +382,198 @@ var RNP = {</span>
<a href="#l11.50"></a><span id="l11.50"> </span>
<a href="#l11.51"></a><span id="l11.51">     let output_to_memory = new RNPLib.rnp_output_t();</span>
<a href="#l11.52"></a><span id="l11.52">     RNPLib.rnp_output_to_memory(output_to_memory.address(), max_out);</span>
<a href="#l11.53"></a><span id="l11.53"> </span>
<a href="#l11.54"></a><span id="l11.54">     let result = {};</span>
<a href="#l11.55"></a><span id="l11.55">     result.decryptedData = &quot;&quot;;</span>
<a href="#l11.56"></a><span id="l11.56">     result.statusFlags = 0;</span>
<a href="#l11.57"></a><span id="l11.57"> </span>
<a href="#l11.58"></a><span id="l11.58" class="difflineminus">-    result.exitCode = RNPLib.rnp_decrypt(</span>
<a href="#l11.59"></a><span id="l11.59" class="difflineplus">+    result.userId = &quot;&quot;;</span>
<a href="#l11.60"></a><span id="l11.60" class="difflineplus">+    result.keyId = &quot;&quot;;</span>
<a href="#l11.61"></a><span id="l11.61" class="difflineplus">+</span>
<a href="#l11.62"></a><span id="l11.62" class="difflineplus">+    let verify_op = new RNPLib.rnp_op_verify_t();</span>
<a href="#l11.63"></a><span id="l11.63" class="difflineplus">+    result.exitCode = RNPLib.rnp_op_verify_create(</span>
<a href="#l11.64"></a><span id="l11.64" class="difflineplus">+      verify_op.address(),</span>
<a href="#l11.65"></a><span id="l11.65">       RNPLib.ffi,</span>
<a href="#l11.66"></a><span id="l11.66">       input_from_memory,</span>
<a href="#l11.67"></a><span id="l11.67">       output_to_memory</span>
<a href="#l11.68"></a><span id="l11.68">     );</span>
<a href="#l11.69"></a><span id="l11.69" class="difflineminus">-    console.debug(&quot;decrypt exit code: &quot; + result.exitCode);</span>
<a href="#l11.70"></a><span id="l11.70" class="difflineplus">+</span>
<a href="#l11.71"></a><span id="l11.71" class="difflineplus">+    result.exitCode = RNPLib.rnp_op_verify_execute(verify_op);</span>
<a href="#l11.72"></a><span id="l11.72"> </span>
<a href="#l11.73"></a><span id="l11.73">     if (!result.exitCode) {</span>
<a href="#l11.74"></a><span id="l11.74">       let result_buf = new ctypes.uint8_t.ptr();</span>
<a href="#l11.75"></a><span id="l11.75">       let result_len = new ctypes.size_t();</span>
<a href="#l11.76"></a><span id="l11.76">       result.exitCode = RNPLib.rnp_output_memory_get_buf(</span>
<a href="#l11.77"></a><span id="l11.77">         output_to_memory,</span>
<a href="#l11.78"></a><span id="l11.78">         result_buf.address(),</span>
<a href="#l11.79"></a><span id="l11.79">         result_len.address(),</span>
<a href="#l11.80"></a><span id="l11.80">         false</span>
<a href="#l11.81"></a><span id="l11.81">       );</span>
<a href="#l11.82"></a><span id="l11.82" class="difflineminus">-      console.debug(&quot;decrypt get buffer result code: &quot; + result.exitCode);</span>
<a href="#l11.83"></a><span id="l11.83"> </span>
<a href="#l11.84"></a><span id="l11.84">       if (!result.exitCode) {</span>
<a href="#l11.85"></a><span id="l11.85" class="difflineminus">-        console.debug(&quot;decrypt result len: &quot; + result_len.value);</span>
<a href="#l11.86"></a><span id="l11.86" class="difflineminus">-        //let buf_array = ctypes.cast(result_buf, ctypes.uint8_t.array(result_len.value).ptr).contents;</span>
<a href="#l11.87"></a><span id="l11.87" class="difflineminus">-        //let char_array = ctypes.cast(buf_array, ctypes.char.array(result_len.value));</span>
<a href="#l11.88"></a><span id="l11.88" class="difflineminus">-</span>
<a href="#l11.89"></a><span id="l11.89">         let char_array = ctypes.cast(</span>
<a href="#l11.90"></a><span id="l11.90">           result_buf,</span>
<a href="#l11.91"></a><span id="l11.91">           ctypes.char.array(result_len.value).ptr</span>
<a href="#l11.92"></a><span id="l11.92">         ).contents;</span>
<a href="#l11.93"></a><span id="l11.93"> </span>
<a href="#l11.94"></a><span id="l11.94" class="difflineminus">-        result.statusFlags |= EnigmailConstants.DECRYPTION_OKAY;</span>
<a href="#l11.95"></a><span id="l11.95">         result.decryptedData = char_array.readString();</span>
<a href="#l11.96"></a><span id="l11.96">         console.debug(result.decryptedData);</span>
<a href="#l11.97"></a><span id="l11.97" class="difflineplus">+</span>
<a href="#l11.98"></a><span id="l11.98" class="difflineplus">+        // ignore &quot;no signature&quot; result, that's ok</span>
<a href="#l11.99"></a><span id="l11.99" class="difflineplus">+        this.getVerifyDetails(verify_op, result);</span>
<a href="#l11.100"></a><span id="l11.100">       }</span>
<a href="#l11.101"></a><span id="l11.101">     }</span>
<a href="#l11.102"></a><span id="l11.102"> </span>
<a href="#l11.103"></a><span id="l11.103" class="difflineminus">-    if (!(result.statusFlags &amp; EnigmailConstants.DECRYPTION_OKAY)) {</span>
<a href="#l11.104"></a><span id="l11.104" class="difflineminus">-      result.statusFlags |= EnigmailConstants.DECRYPTION_FAILED;</span>
<a href="#l11.105"></a><span id="l11.105" class="difflineminus">-    }</span>
<a href="#l11.106"></a><span id="l11.106" class="difflineminus">-</span>
<a href="#l11.107"></a><span id="l11.107">     RNPLib.rnp_input_destroy(input_from_memory);</span>
<a href="#l11.108"></a><span id="l11.108">     RNPLib.rnp_output_destroy(output_to_memory);</span>
<a href="#l11.109"></a><span id="l11.109" class="difflineplus">+    RNPLib.rnp_op_verify_destroy(verify_op);</span>
<a href="#l11.110"></a><span id="l11.110" class="difflineplus">+</span>
<a href="#l11.111"></a><span id="l11.111" class="difflineplus">+    return result;</span>
<a href="#l11.112"></a><span id="l11.112" class="difflineplus">+  },</span>
<a href="#l11.113"></a><span id="l11.113" class="difflineplus">+</span>
<a href="#l11.114"></a><span id="l11.114" class="difflineplus">+  getVerifyDetails(verify_op, result) {</span>
<a href="#l11.115"></a><span id="l11.115" class="difflineplus">+    let sig_count = new ctypes.size_t();</span>
<a href="#l11.116"></a><span id="l11.116" class="difflineplus">+    if (</span>
<a href="#l11.117"></a><span id="l11.117" class="difflineplus">+      RNPLib.rnp_op_verify_get_signature_count(verify_op, sig_count.address())</span>
<a href="#l11.118"></a><span id="l11.118" class="difflineplus">+    ) {</span>
<a href="#l11.119"></a><span id="l11.119" class="difflineplus">+      throw new Error(&quot;rnp_op_verify_get_signature_count failed&quot;);</span>
<a href="#l11.120"></a><span id="l11.120" class="difflineplus">+    }</span>
<a href="#l11.121"></a><span id="l11.121" class="difflineplus">+</span>
<a href="#l11.122"></a><span id="l11.122" class="difflineplus">+    // TODO: How should handle (sig_count.value &gt; 1) ?</span>
<a href="#l11.123"></a><span id="l11.123" class="difflineplus">+    if (sig_count.value == 0) {</span>
<a href="#l11.124"></a><span id="l11.124" class="difflineplus">+      // !sig_count.value didn't work, === also doesn't work</span>
<a href="#l11.125"></a><span id="l11.125" class="difflineplus">+      return false;</span>
<a href="#l11.126"></a><span id="l11.126" class="difflineplus">+    }</span>
<a href="#l11.127"></a><span id="l11.127" class="difflineplus">+</span>
<a href="#l11.128"></a><span id="l11.128" class="difflineplus">+    let sig = new RNPLib.rnp_op_verify_signature_t();</span>
<a href="#l11.129"></a><span id="l11.129" class="difflineplus">+    if (RNPLib.rnp_op_verify_get_signature_at(verify_op, 0, sig.address())) {</span>
<a href="#l11.130"></a><span id="l11.130" class="difflineplus">+      throw new Error(&quot;rnp_op_verify_get_signature_at failed&quot;);</span>
<a href="#l11.131"></a><span id="l11.131" class="difflineplus">+    }</span>
<a href="#l11.132"></a><span id="l11.132" class="difflineplus">+</span>
<a href="#l11.133"></a><span id="l11.133" class="difflineplus">+    let sig_status = RNPLib.rnp_op_verify_signature_get_status(sig);</span>
<a href="#l11.134"></a><span id="l11.134" class="difflineplus">+</span>
<a href="#l11.135"></a><span id="l11.135" class="difflineplus">+    if (sig_status != RNPLib.RNP_SUCCESS &amp;&amp; !result.exitCode) {</span>
<a href="#l11.136"></a><span id="l11.136" class="difflineplus">+      /* Don't allow a good exit code. Keep existing bad code. */</span>
<a href="#l11.137"></a><span id="l11.137" class="difflineplus">+      result.exitCode = -1;</span>
<a href="#l11.138"></a><span id="l11.138" class="difflineplus">+    }</span>
<a href="#l11.139"></a><span id="l11.139" class="difflineplus">+</span>
<a href="#l11.140"></a><span id="l11.140" class="difflineplus">+    let query_times = true;</span>
<a href="#l11.141"></a><span id="l11.141" class="difflineplus">+    let query_signer = true;</span>
<a href="#l11.142"></a><span id="l11.142" class="difflineplus">+</span>
<a href="#l11.143"></a><span id="l11.143" class="difflineplus">+    switch (sig_status) {</span>
<a href="#l11.144"></a><span id="l11.144" class="difflineplus">+      case RNPLib.RNP_SUCCESS:</span>
<a href="#l11.145"></a><span id="l11.145" class="difflineplus">+        // TODO: set EnigmailConstants.TRUSTED_IDENTITY based on key trust status</span>
<a href="#l11.146"></a><span id="l11.146" class="difflineplus">+        result.statusFlags |= EnigmailConstants.GOOD_SIGNATURE;</span>
<a href="#l11.147"></a><span id="l11.147" class="difflineplus">+        break;</span>
<a href="#l11.148"></a><span id="l11.148" class="difflineplus">+      case RNPLib.RNP_ERROR_KEY_NOT_FOUND:</span>
<a href="#l11.149"></a><span id="l11.149" class="difflineplus">+        result.statusFlags |= EnigmailConstants.UNVERIFIED_SIGNATURE;</span>
<a href="#l11.150"></a><span id="l11.150" class="difflineplus">+        query_signer = false;</span>
<a href="#l11.151"></a><span id="l11.151" class="difflineplus">+        break;</span>
<a href="#l11.152"></a><span id="l11.152" class="difflineplus">+      case RNPLib.RNP_ERROR_SIGNATURE_EXPIRED:</span>
<a href="#l11.153"></a><span id="l11.153" class="difflineplus">+        result.statusFlags |= EnigmailConstants.EXPIRED_SIGNATURE;</span>
<a href="#l11.154"></a><span id="l11.154" class="difflineplus">+        break;</span>
<a href="#l11.155"></a><span id="l11.155" class="difflineplus">+      case RNPLib.RNP_ERROR_SIGNATURE_INVALID:</span>
<a href="#l11.156"></a><span id="l11.156" class="difflineplus">+        result.statusFlags |= EnigmailConstants.BAD_SIGNATURE;</span>
<a href="#l11.157"></a><span id="l11.157" class="difflineplus">+        break;</span>
<a href="#l11.158"></a><span id="l11.158" class="difflineplus">+      default:</span>
<a href="#l11.159"></a><span id="l11.159" class="difflineplus">+        result.statusFlags |= EnigmailConstants.BAD_SIGNATURE;</span>
<a href="#l11.160"></a><span id="l11.160" class="difflineplus">+        query_times = false;</span>
<a href="#l11.161"></a><span id="l11.161" class="difflineplus">+        query_signer = false;</span>
<a href="#l11.162"></a><span id="l11.162" class="difflineplus">+        break;</span>
<a href="#l11.163"></a><span id="l11.163" class="difflineplus">+    }</span>
<a href="#l11.164"></a><span id="l11.164" class="difflineplus">+</span>
<a href="#l11.165"></a><span id="l11.165" class="difflineplus">+    if (query_times) {</span>
<a href="#l11.166"></a><span id="l11.166" class="difflineplus">+      let created = new ctypes.uint32_t();</span>
<a href="#l11.167"></a><span id="l11.167" class="difflineplus">+      let expires = new ctypes.uint32_t(); //relative</span>
<a href="#l11.168"></a><span id="l11.168" class="difflineplus">+</span>
<a href="#l11.169"></a><span id="l11.169" class="difflineplus">+      if (</span>
<a href="#l11.170"></a><span id="l11.170" class="difflineplus">+        RNPLib.rnp_op_verify_signature_get_times(</span>
<a href="#l11.171"></a><span id="l11.171" class="difflineplus">+          sig,</span>
<a href="#l11.172"></a><span id="l11.172" class="difflineplus">+          created.address(),</span>
<a href="#l11.173"></a><span id="l11.173" class="difflineplus">+          expires.address()</span>
<a href="#l11.174"></a><span id="l11.174" class="difflineplus">+        )</span>
<a href="#l11.175"></a><span id="l11.175" class="difflineplus">+      ) {</span>
<a href="#l11.176"></a><span id="l11.176" class="difflineplus">+        throw new Error(&quot;rnp_op_verify_signature_get_times failed&quot;);</span>
<a href="#l11.177"></a><span id="l11.177" class="difflineplus">+      }</span>
<a href="#l11.178"></a><span id="l11.178" class="difflineplus">+    }</span>
<a href="#l11.179"></a><span id="l11.179" class="difflineplus">+</span>
<a href="#l11.180"></a><span id="l11.180" class="difflineplus">+    if (query_signer) {</span>
<a href="#l11.181"></a><span id="l11.181" class="difflineplus">+      let key = new RNPLib.rnp_key_handle_t();</span>
<a href="#l11.182"></a><span id="l11.182" class="difflineplus">+      if (RNPLib.rnp_op_verify_signature_get_key(sig, key.address())) {</span>
<a href="#l11.183"></a><span id="l11.183" class="difflineplus">+        throw new Error(&quot;rnp_op_verify_signature_get_key&quot;);</span>
<a href="#l11.184"></a><span id="l11.184" class="difflineplus">+      }</span>
<a href="#l11.185"></a><span id="l11.185" class="difflineplus">+</span>
<a href="#l11.186"></a><span id="l11.186" class="difflineplus">+      let keyInfo = {};</span>
<a href="#l11.187"></a><span id="l11.187" class="difflineplus">+      let ok = this.getKeyInfoFromHandle(key, keyInfo, false);</span>
<a href="#l11.188"></a><span id="l11.188" class="difflineplus">+      if (!ok) {</span>
<a href="#l11.189"></a><span id="l11.189" class="difflineplus">+        console.debug(&quot;TODO: use primary key for signature made with a sub key!&quot;);</span>
<a href="#l11.190"></a><span id="l11.190" class="difflineplus">+      }</span>
<a href="#l11.191"></a><span id="l11.191" class="difflineplus">+</span>
<a href="#l11.192"></a><span id="l11.192" class="difflineplus">+      result.keyId = keyInfo.keyId;</span>
<a href="#l11.193"></a><span id="l11.193" class="difflineplus">+</span>
<a href="#l11.194"></a><span id="l11.194" class="difflineplus">+      RNPLib.rnp_key_handle_destroy(key);</span>
<a href="#l11.195"></a><span id="l11.195" class="difflineplus">+    }</span>
<a href="#l11.196"></a><span id="l11.196" class="difflineplus">+</span>
<a href="#l11.197"></a><span id="l11.197" class="difflineplus">+    return true;</span>
<a href="#l11.198"></a><span id="l11.198" class="difflineplus">+  },</span>
<a href="#l11.199"></a><span id="l11.199" class="difflineplus">+</span>
<a href="#l11.200"></a><span id="l11.200" class="difflineplus">+  verifyDetached(data, options) {</span>
<a href="#l11.201"></a><span id="l11.201" class="difflineplus">+    let input_from_memory = new RNPLib.rnp_input_t();</span>
<a href="#l11.202"></a><span id="l11.202" class="difflineplus">+</span>
<a href="#l11.203"></a><span id="l11.203" class="difflineplus">+    var tmp_array = ctypes.char.array()(data);</span>
<a href="#l11.204"></a><span id="l11.204" class="difflineplus">+    var data_array = ctypes.cast(tmp_array, ctypes.uint8_t.array(data.length));</span>
<a href="#l11.205"></a><span id="l11.205" class="difflineplus">+</span>
<a href="#l11.206"></a><span id="l11.206" class="difflineplus">+    RNPLib.rnp_input_from_memory(</span>
<a href="#l11.207"></a><span id="l11.207" class="difflineplus">+      input_from_memory.address(),</span>
<a href="#l11.208"></a><span id="l11.208" class="difflineplus">+      data_array,</span>
<a href="#l11.209"></a><span id="l11.209" class="difflineplus">+      data.length,</span>
<a href="#l11.210"></a><span id="l11.210" class="difflineplus">+      false</span>
<a href="#l11.211"></a><span id="l11.211" class="difflineplus">+    );</span>
<a href="#l11.212"></a><span id="l11.212" class="difflineplus">+</span>
<a href="#l11.213"></a><span id="l11.213" class="difflineplus">+    let input_from_file = new RNPLib.rnp_input_t();</span>
<a href="#l11.214"></a><span id="l11.214" class="difflineplus">+    RNPLib.rnp_input_from_path(</span>
<a href="#l11.215"></a><span id="l11.215" class="difflineplus">+      input_from_file.address(),</span>
<a href="#l11.216"></a><span id="l11.216" class="difflineplus">+      options.mimeSignatureFile</span>
<a href="#l11.217"></a><span id="l11.217" class="difflineplus">+    );</span>
<a href="#l11.218"></a><span id="l11.218" class="difflineplus">+</span>
<a href="#l11.219"></a><span id="l11.219" class="difflineplus">+    let result = {};</span>
<a href="#l11.220"></a><span id="l11.220" class="difflineplus">+    result.decryptedData = &quot;&quot;;</span>
<a href="#l11.221"></a><span id="l11.221" class="difflineplus">+    result.statusFlags = 0;</span>
<a href="#l11.222"></a><span id="l11.222" class="difflineplus">+</span>
<a href="#l11.223"></a><span id="l11.223" class="difflineplus">+    result.userId = &quot;&quot;;</span>
<a href="#l11.224"></a><span id="l11.224" class="difflineplus">+    result.keyId = &quot;&quot;;</span>
<a href="#l11.225"></a><span id="l11.225" class="difflineplus">+</span>
<a href="#l11.226"></a><span id="l11.226" class="difflineplus">+    let verify_op = new RNPLib.rnp_op_verify_t();</span>
<a href="#l11.227"></a><span id="l11.227" class="difflineplus">+    if (</span>
<a href="#l11.228"></a><span id="l11.228" class="difflineplus">+      RNPLib.rnp_op_verify_detached_create(</span>
<a href="#l11.229"></a><span id="l11.229" class="difflineplus">+        verify_op.address(),</span>
<a href="#l11.230"></a><span id="l11.230" class="difflineplus">+        RNPLib.ffi,</span>
<a href="#l11.231"></a><span id="l11.231" class="difflineplus">+        input_from_memory,</span>
<a href="#l11.232"></a><span id="l11.232" class="difflineplus">+        input_from_file</span>
<a href="#l11.233"></a><span id="l11.233" class="difflineplus">+      )</span>
<a href="#l11.234"></a><span id="l11.234" class="difflineplus">+    ) {</span>
<a href="#l11.235"></a><span id="l11.235" class="difflineplus">+      throw new Error(&quot;rnp_op_verify_detached_create failed&quot;);</span>
<a href="#l11.236"></a><span id="l11.236" class="difflineplus">+    }</span>
<a href="#l11.237"></a><span id="l11.237" class="difflineplus">+</span>
<a href="#l11.238"></a><span id="l11.238" class="difflineplus">+    result.exitCode = RNPLib.rnp_op_verify_execute(verify_op);</span>
<a href="#l11.239"></a><span id="l11.239" class="difflineplus">+</span>
<a href="#l11.240"></a><span id="l11.240" class="difflineplus">+    let haveSignature = this.getVerifyDetails(verify_op, result);</span>
<a href="#l11.241"></a><span id="l11.241" class="difflineplus">+    if (!haveSignature) {</span>
<a href="#l11.242"></a><span id="l11.242" class="difflineplus">+      if (!result.exitCode) {</span>
<a href="#l11.243"></a><span id="l11.243" class="difflineplus">+        /* Don't allow a good exit code. Keep existing bad code. */</span>
<a href="#l11.244"></a><span id="l11.244" class="difflineplus">+        result.exitCode = -1;</span>
<a href="#l11.245"></a><span id="l11.245" class="difflineplus">+      }</span>
<a href="#l11.246"></a><span id="l11.246" class="difflineplus">+      result.statusFlags |= EnigmailConstants.BAD_SIGNATURE;</span>
<a href="#l11.247"></a><span id="l11.247" class="difflineplus">+    }</span>
<a href="#l11.248"></a><span id="l11.248" class="difflineplus">+</span>
<a href="#l11.249"></a><span id="l11.249" class="difflineplus">+    RNPLib.rnp_input_destroy(input_from_memory);</span>
<a href="#l11.250"></a><span id="l11.250" class="difflineplus">+    RNPLib.rnp_input_destroy(input_from_file);</span>
<a href="#l11.251"></a><span id="l11.251" class="difflineplus">+    RNPLib.rnp_op_verify_destroy(verify_op);</span>
<a href="#l11.252"></a><span id="l11.252"> </span>
<a href="#l11.253"></a><span id="l11.253">     return result;</span>
<a href="#l11.254"></a><span id="l11.254">   },</span>
<a href="#l11.255"></a><span id="l11.255"> </span>
<a href="#l11.256"></a><span id="l11.256">   genKey(userId, keyType, keyBits, expiryDays, passphrase) {</span>
<a href="#l11.257"></a><span id="l11.257">     let newKeyId = &quot;&quot;;</span>
<a href="#l11.258"></a><span id="l11.258"> </span>
<a href="#l11.259"></a><span id="l11.259">     let primaryKeyType;</span>
<a href="#l11.260"></a><span id="l11.260" class="difflineat">@@ -930,39 +1062,17 @@ var RNP = {</span>
<a href="#l11.261"></a><span id="l11.261">     if (RNPLib.rnp_key_get_subkey_count(primary, sub_count.address())) {</span>
<a href="#l11.262"></a><span id="l11.262">       throw new Error(&quot;rnp_key_get_subkey_count failed&quot;);</span>
<a href="#l11.263"></a><span id="l11.263">     }</span>
<a href="#l11.264"></a><span id="l11.264">     for (let i = 0; i &lt; sub_count.value; i++) {</span>
<a href="#l11.265"></a><span id="l11.265">       let sub_handle = new RNPLib.rnp_key_handle_t();</span>
<a href="#l11.266"></a><span id="l11.266">       if (RNPLib.rnp_key_get_subkey_at(primary, i, sub_handle.address())) {</span>
<a href="#l11.267"></a><span id="l11.267">         throw new Error(&quot;rnp_key_get_subkey_at failed&quot;);</span>
<a href="#l11.268"></a><span id="l11.268">       }</span>
<a href="#l11.269"></a><span id="l11.269" class="difflineminus">-      let expiration = new ctypes.uint32_t();</span>
<a href="#l11.270"></a><span id="l11.270" class="difflineminus">-      if (RNPLib.rnp_key_get_expiration(sub_handle, expiration.address())) {</span>
<a href="#l11.271"></a><span id="l11.271" class="difflineminus">-        throw new Error(&quot;rnp_key_get_expiration failed&quot;);</span>
<a href="#l11.272"></a><span id="l11.272" class="difflineminus">-      }</span>
<a href="#l11.273"></a><span id="l11.273" class="difflineminus">-      let skip = false;</span>
<a href="#l11.274"></a><span id="l11.274" class="difflineminus">-      if (expiration.value != 0) {</span>
<a href="#l11.275"></a><span id="l11.275" class="difflineminus">-        let now_seconds = Math.floor(Date.now() / 1000);</span>
<a href="#l11.276"></a><span id="l11.276" class="difflineminus">-        let creation = new ctypes.uint32_t();</span>
<a href="#l11.277"></a><span id="l11.277" class="difflineminus">-        if (RNPLib.rnp_key_get_creation(sub_handle, creation.address())) {</span>
<a href="#l11.278"></a><span id="l11.278" class="difflineminus">-          throw new Error(&quot;rnp_key_get_expiration failed&quot;);</span>
<a href="#l11.279"></a><span id="l11.279" class="difflineminus">-        }</span>
<a href="#l11.280"></a><span id="l11.280" class="difflineminus">-        let expiration_seconds = creation.value + expiration.value;</span>
<a href="#l11.281"></a><span id="l11.281" class="difflineminus">-        console.debug(</span>
<a href="#l11.282"></a><span id="l11.282" class="difflineminus">-          &quot;now: &quot; +</span>
<a href="#l11.283"></a><span id="l11.283" class="difflineminus">-            now_seconds +</span>
<a href="#l11.284"></a><span id="l11.284" class="difflineminus">-            &quot; vs. subkey creation+expiration in seconds: &quot; +</span>
<a href="#l11.285"></a><span id="l11.285" class="difflineminus">-            expiration_seconds</span>
<a href="#l11.286"></a><span id="l11.286" class="difflineminus">-        );</span>
<a href="#l11.287"></a><span id="l11.287" class="difflineminus">-        if (now_seconds &gt; expiration_seconds) {</span>
<a href="#l11.288"></a><span id="l11.288" class="difflineminus">-          console.debug(&quot;skipping expired subkey&quot;);</span>
<a href="#l11.289"></a><span id="l11.289" class="difflineminus">-          skip = true;</span>
<a href="#l11.290"></a><span id="l11.290" class="difflineminus">-        }</span>
<a href="#l11.291"></a><span id="l11.291" class="difflineminus">-      }</span>
<a href="#l11.292"></a><span id="l11.292" class="difflineplus">+      let skip = this.isKeyExpired(sub_handle);</span>
<a href="#l11.293"></a><span id="l11.293">       if (!skip) {</span>
<a href="#l11.294"></a><span id="l11.294">         let key_revoked = new ctypes.bool();</span>
<a href="#l11.295"></a><span id="l11.295">         if (RNPLib.rnp_key_is_revoked(sub_handle, key_revoked.address())) {</span>
<a href="#l11.296"></a><span id="l11.296">           console.debug(&quot;skipping revoked subkey&quot;);</span>
<a href="#l11.297"></a><span id="l11.297">           skip = true;</span>
<a href="#l11.298"></a><span id="l11.298">         }</span>
<a href="#l11.299"></a><span id="l11.299">       }</span>
<a href="#l11.300"></a><span id="l11.300">       if (!skip) {</span>
<a href="#l11.301"></a><span id="l11.301" class="difflineat">@@ -1221,16 +1331,34 @@ var RNP = {</span>
<a href="#l11.302"></a><span id="l11.302"> </span>
<a href="#l11.303"></a><span id="l11.303">     if (args.sign) {</span>
<a href="#l11.304"></a><span id="l11.304">       resultStatus.statusFlags |= EnigmailConstants.SIG_CREATED;</span>
<a href="#l11.305"></a><span id="l11.305">     }</span>
<a href="#l11.306"></a><span id="l11.306"> </span>
<a href="#l11.307"></a><span id="l11.307">     return result;</span>
<a href="#l11.308"></a><span id="l11.308">   },</span>
<a href="#l11.309"></a><span id="l11.309"> </span>
<a href="#l11.310"></a><span id="l11.310" class="difflineplus">+  isKeyExpired(handle) {</span>
<a href="#l11.311"></a><span id="l11.311" class="difflineplus">+    let expiration = new ctypes.uint32_t();</span>
<a href="#l11.312"></a><span id="l11.312" class="difflineplus">+    if (RNPLib.rnp_key_get_expiration(handle, expiration.address())) {</span>
<a href="#l11.313"></a><span id="l11.313" class="difflineplus">+      throw new Error(&quot;rnp_key_get_expiration failed&quot;);</span>
<a href="#l11.314"></a><span id="l11.314" class="difflineplus">+    }</span>
<a href="#l11.315"></a><span id="l11.315" class="difflineplus">+    if (!expiration.value) {</span>
<a href="#l11.316"></a><span id="l11.316" class="difflineplus">+      return false;</span>
<a href="#l11.317"></a><span id="l11.317" class="difflineplus">+    }</span>
<a href="#l11.318"></a><span id="l11.318" class="difflineplus">+    let nowSeconds = Math.floor(Date.now() / 1000);</span>
<a href="#l11.319"></a><span id="l11.319" class="difflineplus">+    let creation = new ctypes.uint32_t();</span>
<a href="#l11.320"></a><span id="l11.320" class="difflineplus">+    if (RNPLib.rnp_key_get_creation(handle, creation.address())) {</span>
<a href="#l11.321"></a><span id="l11.321" class="difflineplus">+      throw new Error(&quot;rnp_key_get_creation failed&quot;);</span>
<a href="#l11.322"></a><span id="l11.322" class="difflineplus">+    }</span>
<a href="#l11.323"></a><span id="l11.323" class="difflineplus">+    let expirationSeconds = creation.value + expiration.value;</span>
<a href="#l11.324"></a><span id="l11.324" class="difflineplus">+    let isExpired = nowSeconds &gt; expirationSeconds;</span>
<a href="#l11.325"></a><span id="l11.325" class="difflineplus">+    return isExpired;</span>
<a href="#l11.326"></a><span id="l11.326" class="difflineplus">+  },</span>
<a href="#l11.327"></a><span id="l11.327" class="difflineplus">+</span>
<a href="#l11.328"></a><span id="l11.328">   findKeyByEmail(id) {</span>
<a href="#l11.329"></a><span id="l11.329">     if (!id.startsWith(&quot;&lt;&quot;) || !id.endsWith(&quot;&gt;&quot;)) {</span>
<a href="#l11.330"></a><span id="l11.330">       throw new Error(&quot;invalid parameter given to findKeyByEmail&quot;);</span>
<a href="#l11.331"></a><span id="l11.331">     }</span>
<a href="#l11.332"></a><span id="l11.332"> </span>
<a href="#l11.333"></a><span id="l11.333">     let rv;</span>
<a href="#l11.334"></a><span id="l11.334"> </span>
<a href="#l11.335"></a><span id="l11.335">     let iter = new RNPLib.rnp_identifier_iterator_t();</span>
<a href="#l11.336"></a><span id="l11.336" class="difflineat">@@ -1276,16 +1404,20 @@ var RNP = {</span>
<a href="#l11.337"></a><span id="l11.337">         if (RNPLib.rnp_key_is_revoked(handle, key_revoked.address())) {</span>
<a href="#l11.338"></a><span id="l11.338">           throw new Error(&quot;rnp_key_is_revoked failed&quot;);</span>
<a href="#l11.339"></a><span id="l11.339">         }</span>
<a href="#l11.340"></a><span id="l11.340"> </span>
<a href="#l11.341"></a><span id="l11.341">         if (key_revoked.value) {</span>
<a href="#l11.342"></a><span id="l11.342">           continue;</span>
<a href="#l11.343"></a><span id="l11.343">         }</span>
<a href="#l11.344"></a><span id="l11.344"> </span>
<a href="#l11.345"></a><span id="l11.345" class="difflineplus">+        if (this.isKeyExpired(handle)) {</span>
<a href="#l11.346"></a><span id="l11.346" class="difflineplus">+          continue;</span>
<a href="#l11.347"></a><span id="l11.347" class="difflineplus">+        }</span>
<a href="#l11.348"></a><span id="l11.348" class="difflineplus">+</span>
<a href="#l11.349"></a><span id="l11.349">         if (RNPLib.rnp_key_get_uid_count(handle, uid_count.address())) {</span>
<a href="#l11.350"></a><span id="l11.350">           throw new Error(&quot;rnp_key_get_uid_count failed&quot;);</span>
<a href="#l11.351"></a><span id="l11.351">         }</span>
<a href="#l11.352"></a><span id="l11.352">         for (let i = 0; i &lt; uid_count.value; i++) {</span>
<a href="#l11.353"></a><span id="l11.353">           let uid_handle = new RNPLib.rnp_uid_handle_t();</span>
<a href="#l11.354"></a><span id="l11.354">           let is_revoked = new ctypes.bool();</span>
<a href="#l11.355"></a><span id="l11.355"> </span>
<a href="#l11.356"></a><span id="l11.356">           if (</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/rnpLib.jsm</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/rnpLib.jsm</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -85,16 +85,18 @@ const rnp_input_t = ctypes.void_t.ptr;</span>
<a href="#l12.4"></a><span id="l12.4"> const rnp_output_t = ctypes.void_t.ptr;</span>
<a href="#l12.5"></a><span id="l12.5"> const rnp_key_handle_t = ctypes.void_t.ptr;</span>
<a href="#l12.6"></a><span id="l12.6"> const rnp_uid_handle_t = ctypes.void_t.ptr;</span>
<a href="#l12.7"></a><span id="l12.7"> const rnp_identifier_iterator_t = ctypes.void_t.ptr;</span>
<a href="#l12.8"></a><span id="l12.8"> const rnp_op_generate_t = ctypes.void_t.ptr;</span>
<a href="#l12.9"></a><span id="l12.9"> const rnp_op_encrypt_t = ctypes.void_t.ptr;</span>
<a href="#l12.10"></a><span id="l12.10"> const rnp_op_sign_t = ctypes.void_t.ptr;</span>
<a href="#l12.11"></a><span id="l12.11"> const rnp_op_sign_signature_t = ctypes.void_t.ptr;</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineplus">+const rnp_op_verify_t = ctypes.void_t.ptr;</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+const rnp_op_verify_signature_t = ctypes.void_t.ptr;</span>
<a href="#l12.14"></a><span id="l12.14"> </span>
<a href="#l12.15"></a><span id="l12.15"> const rnp_password_cb_t = ctypes.FunctionType(abi, ctypes.bool, [</span>
<a href="#l12.16"></a><span id="l12.16">   rnp_ffi_t,</span>
<a href="#l12.17"></a><span id="l12.17">   ctypes.void_t.ptr,</span>
<a href="#l12.18"></a><span id="l12.18">   rnp_key_handle_t,</span>
<a href="#l12.19"></a><span id="l12.19">   ctypes.char.ptr,</span>
<a href="#l12.20"></a><span id="l12.20">   ctypes.char.ptr,</span>
<a href="#l12.21"></a><span id="l12.21">   ctypes.size_t,</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineat">@@ -900,28 +902,105 @@ function enableRNPLibJS() {</span>
<a href="#l12.23"></a><span id="l12.23"> </span>
<a href="#l12.24"></a><span id="l12.24">     rnp_output_finish: librnp.declare(</span>
<a href="#l12.25"></a><span id="l12.25">       &quot;rnp_output_finish&quot;,</span>
<a href="#l12.26"></a><span id="l12.26">       abi,</span>
<a href="#l12.27"></a><span id="l12.27">       rnp_result_t,</span>
<a href="#l12.28"></a><span id="l12.28">       rnp_output_t</span>
<a href="#l12.29"></a><span id="l12.29">     ),</span>
<a href="#l12.30"></a><span id="l12.30"> </span>
<a href="#l12.31"></a><span id="l12.31" class="difflineplus">+    rnp_op_verify_create: librnp.declare(</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+      &quot;rnp_op_verify_create&quot;,</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineplus">+      abi,</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineplus">+      rnp_result_t,</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineplus">+      rnp_op_verify_t.ptr,</span>
<a href="#l12.36"></a><span id="l12.36" class="difflineplus">+      rnp_ffi_t,</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineplus">+      rnp_input_t,</span>
<a href="#l12.38"></a><span id="l12.38" class="difflineplus">+      rnp_output_t</span>
<a href="#l12.39"></a><span id="l12.39" class="difflineplus">+    ),</span>
<a href="#l12.40"></a><span id="l12.40" class="difflineplus">+</span>
<a href="#l12.41"></a><span id="l12.41" class="difflineplus">+    rnp_op_verify_detached_create: librnp.declare(</span>
<a href="#l12.42"></a><span id="l12.42" class="difflineplus">+      &quot;rnp_op_verify_detached_create&quot;,</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineplus">+      abi,</span>
<a href="#l12.44"></a><span id="l12.44" class="difflineplus">+      rnp_result_t,</span>
<a href="#l12.45"></a><span id="l12.45" class="difflineplus">+      rnp_op_verify_t.ptr,</span>
<a href="#l12.46"></a><span id="l12.46" class="difflineplus">+      rnp_ffi_t,</span>
<a href="#l12.47"></a><span id="l12.47" class="difflineplus">+      rnp_input_t,</span>
<a href="#l12.48"></a><span id="l12.48" class="difflineplus">+      rnp_input_t</span>
<a href="#l12.49"></a><span id="l12.49" class="difflineplus">+    ),</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineplus">+</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineplus">+    rnp_op_verify_execute: librnp.declare(</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineplus">+      &quot;rnp_op_verify_execute&quot;,</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineplus">+      abi,</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineplus">+      rnp_result_t,</span>
<a href="#l12.55"></a><span id="l12.55" class="difflineplus">+      rnp_op_verify_t</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineplus">+    ),</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineplus">+</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineplus">+    rnp_op_verify_destroy: librnp.declare(</span>
<a href="#l12.59"></a><span id="l12.59" class="difflineplus">+      &quot;rnp_op_verify_destroy&quot;,</span>
<a href="#l12.60"></a><span id="l12.60" class="difflineplus">+      abi,</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineplus">+      rnp_result_t,</span>
<a href="#l12.62"></a><span id="l12.62" class="difflineplus">+      rnp_op_verify_t</span>
<a href="#l12.63"></a><span id="l12.63" class="difflineplus">+    ),</span>
<a href="#l12.64"></a><span id="l12.64" class="difflineplus">+</span>
<a href="#l12.65"></a><span id="l12.65" class="difflineplus">+    rnp_op_verify_get_signature_count: librnp.declare(</span>
<a href="#l12.66"></a><span id="l12.66" class="difflineplus">+      &quot;rnp_op_verify_get_signature_count&quot;,</span>
<a href="#l12.67"></a><span id="l12.67" class="difflineplus">+      abi,</span>
<a href="#l12.68"></a><span id="l12.68" class="difflineplus">+      rnp_result_t,</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineplus">+      rnp_op_verify_t,</span>
<a href="#l12.70"></a><span id="l12.70" class="difflineplus">+      ctypes.size_t.ptr</span>
<a href="#l12.71"></a><span id="l12.71" class="difflineplus">+    ),</span>
<a href="#l12.72"></a><span id="l12.72" class="difflineplus">+</span>
<a href="#l12.73"></a><span id="l12.73" class="difflineplus">+    rnp_op_verify_get_signature_at: librnp.declare(</span>
<a href="#l12.74"></a><span id="l12.74" class="difflineplus">+      &quot;rnp_op_verify_get_signature_at&quot;,</span>
<a href="#l12.75"></a><span id="l12.75" class="difflineplus">+      abi,</span>
<a href="#l12.76"></a><span id="l12.76" class="difflineplus">+      rnp_result_t,</span>
<a href="#l12.77"></a><span id="l12.77" class="difflineplus">+      rnp_op_verify_t,</span>
<a href="#l12.78"></a><span id="l12.78" class="difflineplus">+      ctypes.size_t,</span>
<a href="#l12.79"></a><span id="l12.79" class="difflineplus">+      rnp_op_verify_signature_t.ptr</span>
<a href="#l12.80"></a><span id="l12.80" class="difflineplus">+    ),</span>
<a href="#l12.81"></a><span id="l12.81" class="difflineplus">+</span>
<a href="#l12.82"></a><span id="l12.82" class="difflineplus">+    rnp_op_verify_signature_get_status: librnp.declare(</span>
<a href="#l12.83"></a><span id="l12.83" class="difflineplus">+      &quot;rnp_op_verify_signature_get_status&quot;,</span>
<a href="#l12.84"></a><span id="l12.84" class="difflineplus">+      abi,</span>
<a href="#l12.85"></a><span id="l12.85" class="difflineplus">+      rnp_result_t,</span>
<a href="#l12.86"></a><span id="l12.86" class="difflineplus">+      rnp_op_verify_signature_t</span>
<a href="#l12.87"></a><span id="l12.87" class="difflineplus">+    ),</span>
<a href="#l12.88"></a><span id="l12.88" class="difflineplus">+</span>
<a href="#l12.89"></a><span id="l12.89" class="difflineplus">+    rnp_op_verify_signature_get_key: librnp.declare(</span>
<a href="#l12.90"></a><span id="l12.90" class="difflineplus">+      &quot;rnp_op_verify_signature_get_key&quot;,</span>
<a href="#l12.91"></a><span id="l12.91" class="difflineplus">+      abi,</span>
<a href="#l12.92"></a><span id="l12.92" class="difflineplus">+      rnp_result_t,</span>
<a href="#l12.93"></a><span id="l12.93" class="difflineplus">+      rnp_op_verify_signature_t,</span>
<a href="#l12.94"></a><span id="l12.94" class="difflineplus">+      rnp_key_handle_t.ptr</span>
<a href="#l12.95"></a><span id="l12.95" class="difflineplus">+    ),</span>
<a href="#l12.96"></a><span id="l12.96" class="difflineplus">+</span>
<a href="#l12.97"></a><span id="l12.97" class="difflineplus">+    rnp_op_verify_signature_get_times: librnp.declare(</span>
<a href="#l12.98"></a><span id="l12.98" class="difflineplus">+      &quot;rnp_op_verify_signature_get_times&quot;,</span>
<a href="#l12.99"></a><span id="l12.99" class="difflineplus">+      abi,</span>
<a href="#l12.100"></a><span id="l12.100" class="difflineplus">+      rnp_result_t,</span>
<a href="#l12.101"></a><span id="l12.101" class="difflineplus">+      rnp_op_verify_signature_t,</span>
<a href="#l12.102"></a><span id="l12.102" class="difflineplus">+      ctypes.uint32_t.ptr,</span>
<a href="#l12.103"></a><span id="l12.103" class="difflineplus">+      ctypes.uint32_t.ptr</span>
<a href="#l12.104"></a><span id="l12.104" class="difflineplus">+    ),</span>
<a href="#l12.105"></a><span id="l12.105" class="difflineplus">+</span>
<a href="#l12.106"></a><span id="l12.106">     rnp_result_t,</span>
<a href="#l12.107"></a><span id="l12.107">     rnp_ffi_t,</span>
<a href="#l12.108"></a><span id="l12.108">     rnp_password_cb_t,</span>
<a href="#l12.109"></a><span id="l12.109">     rnp_input_t,</span>
<a href="#l12.110"></a><span id="l12.110">     rnp_output_t,</span>
<a href="#l12.111"></a><span id="l12.111">     rnp_key_handle_t,</span>
<a href="#l12.112"></a><span id="l12.112">     rnp_uid_handle_t,</span>
<a href="#l12.113"></a><span id="l12.113">     rnp_identifier_iterator_t,</span>
<a href="#l12.114"></a><span id="l12.114">     rnp_op_generate_t,</span>
<a href="#l12.115"></a><span id="l12.115">     rnp_op_encrypt_t,</span>
<a href="#l12.116"></a><span id="l12.116">     rnp_op_sign_t,</span>
<a href="#l12.117"></a><span id="l12.117">     rnp_op_sign_signature_t,</span>
<a href="#l12.118"></a><span id="l12.118" class="difflineplus">+    rnp_op_verify_t,</span>
<a href="#l12.119"></a><span id="l12.119" class="difflineplus">+    rnp_op_verify_signature_t,</span>
<a href="#l12.120"></a><span id="l12.120"> </span>
<a href="#l12.121"></a><span id="l12.121">     RNP_LOAD_SAVE_PUBLIC_KEYS: 1,</span>
<a href="#l12.122"></a><span id="l12.122"> </span>
<a href="#l12.123"></a><span id="l12.123">     RNP_LOAD_SAVE_SECRET_KEYS: 2,</span>
<a href="#l12.124"></a><span id="l12.124"> </span>
<a href="#l12.125"></a><span id="l12.125">     RNP_KEY_REMOVE_PUBLIC: 1,</span>
<a href="#l12.126"></a><span id="l12.126"> </span>
<a href="#l12.127"></a><span id="l12.127">     RNP_KEY_REMOVE_SECRET: 2,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mail/extensions/openpgp/content/strings/enigmail.properties</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/strings/enigmail.properties</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -260,16 +260,17 @@ verifyManually=; click on the 'Verify' b</span>
<a href="#l13.4"></a><span id="l13.4"> headerView.button.verify=Verify</span>
<a href="#l13.5"></a><span id="l13.5"> headerView.button.decrypt=Decrypt</span>
<a href="#l13.6"></a><span id="l13.6"> msgPart=Part of the message %S</span>
<a href="#l13.7"></a><span id="l13.7"> msgSigned=signed</span>
<a href="#l13.8"></a><span id="l13.8"> msgSignedUnkownKey=signed with unknown key</span>
<a href="#l13.9"></a><span id="l13.9"> msgEncrypted=encrypted</span>
<a href="#l13.10"></a><span id="l13.10"> msgSignedAndEnc=signed and encrypted</span>
<a href="#l13.11"></a><span id="l13.11"> </span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+goodSig=Good signature</span>
<a href="#l13.13"></a><span id="l13.13"> unverifiedSig=Unverified signature</span>
<a href="#l13.14"></a><span id="l13.14"> incompleteDecrypt=Decryption incomplete</span>
<a href="#l13.15"></a><span id="l13.15"> needKey=Error - no matching secret key found to decrypt message</span>
<a href="#l13.16"></a><span id="l13.16"> failedDecrypt=Error - decryption failed</span>
<a href="#l13.17"></a><span id="l13.17"> badPhrase=Error - bad passphrase</span>
<a href="#l13.18"></a><span id="l13.18"> missingMdcError=Error - missing or broken integrity protection (MDC)</span>
<a href="#l13.19"></a><span id="l13.19"> failedDecryptVerify=Error - decryption/verification failed</span>
<a href="#l13.20"></a><span id="l13.20"> viewInfo=; View &gt; Message security info for details</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mail/extensions/openpgp/content/ui/enigmailMessengerOverlay.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/ui/enigmailMessengerOverlay.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -94,28 +94,32 @@ var EnigmailConstants = ChromeUtils.impo</span>
<a href="#l14.4"></a><span id="l14.4">   &quot;chrome://openpgp/content/modules/constants.jsm&quot;</span>
<a href="#l14.5"></a><span id="l14.5"> ).EnigmailConstants;</span>
<a href="#l14.6"></a><span id="l14.6"> var EnigmailURIs = ChromeUtils.import(</span>
<a href="#l14.7"></a><span id="l14.7">   &quot;chrome://openpgp/content/modules/uris.jsm&quot;</span>
<a href="#l14.8"></a><span id="l14.8"> ).EnigmailURIs;</span>
<a href="#l14.9"></a><span id="l14.9"> var EnigmailProtocolHandler = ChromeUtils.import(</span>
<a href="#l14.10"></a><span id="l14.10">   &quot;chrome://openpgp/content/modules/protocolHandler.jsm&quot;</span>
<a href="#l14.11"></a><span id="l14.11"> ).EnigmailProtocolHandler;</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineplus">+/*</span>
<a href="#l14.13"></a><span id="l14.13"> var EnigmailAutocrypt = ChromeUtils.import(</span>
<a href="#l14.14"></a><span id="l14.14">   &quot;chrome://openpgp/content/modules/autocrypt.jsm&quot;</span>
<a href="#l14.15"></a><span id="l14.15"> ).EnigmailAutocrypt;</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineplus">+*/</span>
<a href="#l14.17"></a><span id="l14.17"> var EnigmailMime = ChromeUtils.import(</span>
<a href="#l14.18"></a><span id="l14.18">   &quot;chrome://openpgp/content/modules/mime.jsm&quot;</span>
<a href="#l14.19"></a><span id="l14.19"> ).EnigmailMime;</span>
<a href="#l14.20"></a><span id="l14.20"> var EnigmailArmor = ChromeUtils.import(</span>
<a href="#l14.21"></a><span id="l14.21">   &quot;chrome://openpgp/content/modules/armor.jsm&quot;</span>
<a href="#l14.22"></a><span id="l14.22"> ).EnigmailArmor;</span>
<a href="#l14.23"></a><span id="l14.23" class="difflineplus">+/*</span>
<a href="#l14.24"></a><span id="l14.24"> var EnigmailWks = ChromeUtils.import(</span>
<a href="#l14.25"></a><span id="l14.25">   &quot;chrome://openpgp/content/modules/webKey.jsm&quot;</span>
<a href="#l14.26"></a><span id="l14.26"> ).EnigmailWks;</span>
<a href="#l14.27"></a><span id="l14.27" class="difflineplus">+*/</span>
<a href="#l14.28"></a><span id="l14.28"> var EnigmailStdlib = ChromeUtils.import(</span>
<a href="#l14.29"></a><span id="l14.29">   &quot;chrome://openpgp/content/modules/stdlib.jsm&quot;</span>
<a href="#l14.30"></a><span id="l14.30"> ).EnigmailStdlib;</span>
<a href="#l14.31"></a><span id="l14.31"> var EnigmailConfigure = ChromeUtils.import(</span>
<a href="#l14.32"></a><span id="l14.32">   &quot;chrome://openpgp/content/modules/configure.jsm&quot;</span>
<a href="#l14.33"></a><span id="l14.33"> ).EnigmailConfigure;</span>
<a href="#l14.34"></a><span id="l14.34"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l14.35"></a><span id="l14.35"> </span>
<a href="#l14.36"></a><span id="l14.36" class="difflineat">@@ -138,17 +142,17 @@ Enigmail.msg = {</span>
<a href="#l14.37"></a><span id="l14.37">   decryptButton: null,</span>
<a href="#l14.38"></a><span id="l14.38">   savedHeaders: null,</span>
<a href="#l14.39"></a><span id="l14.39">   removeListener: false,</span>
<a href="#l14.40"></a><span id="l14.40">   enableExperiments: false,</span>
<a href="#l14.41"></a><span id="l14.41">   headersList: [</span>
<a href="#l14.42"></a><span id="l14.42">     &quot;content-transfer-encoding&quot;,</span>
<a href="#l14.43"></a><span id="l14.43">     &quot;x-enigmail-version&quot;,</span>
<a href="#l14.44"></a><span id="l14.44">     &quot;x-pgp-encoding-format&quot;,</span>
<a href="#l14.45"></a><span id="l14.45" class="difflineminus">-    &quot;autocrypt-setup-message&quot;,</span>
<a href="#l14.46"></a><span id="l14.46" class="difflineplus">+    //&quot;autocrypt-setup-message&quot;,</span>
<a href="#l14.47"></a><span id="l14.47">   ],</span>
<a href="#l14.48"></a><span id="l14.48">   buggyExchangeEmailContent: null, // for HACK for MS-EXCHANGE-Server Problem</span>
<a href="#l14.49"></a><span id="l14.49">   buggyMailType: null,</span>
<a href="#l14.50"></a><span id="l14.50">   changedAttributes: [],</span>
<a href="#l14.51"></a><span id="l14.51">   lastSMimeReloadURI: &quot;&quot;,</span>
<a href="#l14.52"></a><span id="l14.52"> </span>
<a href="#l14.53"></a><span id="l14.53">   messengerStartup() {</span>
<a href="#l14.54"></a><span id="l14.54">     let self = this;</span>
<a href="#l14.55"></a><span id="l14.55" class="difflineat">@@ -212,18 +216,18 @@ Enigmail.msg = {</span>
<a href="#l14.56"></a><span id="l14.56">     overrideAttribute(</span>
<a href="#l14.57"></a><span id="l14.57">       printElementIds,</span>
<a href="#l14.58"></a><span id="l14.58">       &quot;oncommand&quot;,</span>
<a href="#l14.59"></a><span id="l14.59">       &quot;Enigmail.msg.msgPrint('&quot;,</span>
<a href="#l14.60"></a><span id="l14.60">       &quot;');&quot;</span>
<a href="#l14.61"></a><span id="l14.61">     );</span>
<a href="#l14.62"></a><span id="l14.62"> </span>
<a href="#l14.63"></a><span id="l14.63">     //Enigmail.msg.overrideLayoutChange();</span>
<a href="#l14.64"></a><span id="l14.64" class="difflineminus">-    Enigmail.msg.prepareAppMenu();</span>
<a href="#l14.65"></a><span id="l14.65" class="difflineminus">-    Enigmail.msg.setMainMenuLabel();</span>
<a href="#l14.66"></a><span id="l14.66" class="difflineplus">+    //Enigmail.msg.prepareAppMenu();</span>
<a href="#l14.67"></a><span id="l14.67" class="difflineplus">+    //Enigmail.msg.setMainMenuLabel();</span>
<a href="#l14.68"></a><span id="l14.68"> </span>
<a href="#l14.69"></a><span id="l14.69">     let statusCol = document.getElementById(&quot;enigmailStatusCol&quot;);</span>
<a href="#l14.70"></a><span id="l14.70">     if (statusCol) {</span>
<a href="#l14.71"></a><span id="l14.71">       statusCol.setAttribute(</span>
<a href="#l14.72"></a><span id="l14.72">         &quot;label&quot;,</span>
<a href="#l14.73"></a><span id="l14.73">         EnigmailLocale.getString(&quot;enigmail.msgViewColumn.label&quot;)</span>
<a href="#l14.74"></a><span id="l14.74">       );</span>
<a href="#l14.75"></a><span id="l14.75">     }</span>
<a href="#l14.76"></a><span id="l14.76" class="difflineat">@@ -289,19 +293,21 @@ Enigmail.msg = {</span>
<a href="#l14.77"></a><span id="l14.77">     EnigmailMsgRead.ensureExtraAddonHeaders();</span>
<a href="#l14.78"></a><span id="l14.78">     gMessageListeners.push(Enigmail.msg.messageListener);</span>
<a href="#l14.79"></a><span id="l14.79">     Enigmail.msg.messageListener.onEndHeaders();</span>
<a href="#l14.80"></a><span id="l14.80">   },</span>
<a href="#l14.81"></a><span id="l14.81"> </span>
<a href="#l14.82"></a><span id="l14.82">   messageListener: {</span>
<a href="#l14.83"></a><span id="l14.83">     onStartHeaders() {</span>
<a href="#l14.84"></a><span id="l14.84">       Enigmail.msg.mimeParts = null;</span>
<a href="#l14.85"></a><span id="l14.85" class="difflineplus">+      /*</span>
<a href="#l14.86"></a><span id="l14.86">       if (&quot;autocrypt&quot; in gExpandedHeaderView) {</span>
<a href="#l14.87"></a><span id="l14.87">         delete gExpandedHeaderView.autocrypt;</span>
<a href="#l14.88"></a><span id="l14.88">       }</span>
<a href="#l14.89"></a><span id="l14.89" class="difflineplus">+      */</span>
<a href="#l14.90"></a><span id="l14.90">       if (&quot;openpgp&quot; in gExpandedHeaderView) {</span>
<a href="#l14.91"></a><span id="l14.91">         delete gExpandedHeaderView.openpgp;</span>
<a href="#l14.92"></a><span id="l14.92">       }</span>
<a href="#l14.93"></a><span id="l14.93">     },</span>
<a href="#l14.94"></a><span id="l14.94">     onEndHeaders() {},</span>
<a href="#l14.95"></a><span id="l14.95">     onEndAttachments() {},</span>
<a href="#l14.96"></a><span id="l14.96">   },</span>
<a href="#l14.97"></a><span id="l14.97"> </span>
<a href="#l14.98"></a><span id="l14.98" class="difflineat">@@ -566,31 +572,33 @@ Enigmail.msg = {</span>
<a href="#l14.99"></a><span id="l14.99">     if (attrName == &quot;autoDecrypt&quot;) {</span>
<a href="#l14.100"></a><span id="l14.100">       this.messageReload(false);</span>
<a href="#l14.101"></a><span id="l14.101">     }</span>
<a href="#l14.102"></a><span id="l14.102">   },</span>
<a href="#l14.103"></a><span id="l14.103"> </span>
<a href="#l14.104"></a><span id="l14.104">   /**</span>
<a href="#l14.105"></a><span id="l14.105">    * Determine if Autocrypt is enabled for the currently selected message</span>
<a href="#l14.106"></a><span id="l14.106">    */</span>
<a href="#l14.107"></a><span id="l14.107" class="difflineplus">+  /*</span>
<a href="#l14.108"></a><span id="l14.108">   isAutocryptEnabled() {</span>
<a href="#l14.109"></a><span id="l14.109">     try {</span>
<a href="#l14.110"></a><span id="l14.110">       let email = EnigmailFuncs.stripEmail(</span>
<a href="#l14.111"></a><span id="l14.111">         gFolderDisplay.selectedMessage.recipients</span>
<a href="#l14.112"></a><span id="l14.112">       );</span>
<a href="#l14.113"></a><span id="l14.113">       let maybeIdent = EnigmailStdlib.getIdentityForEmail(email);</span>
<a href="#l14.114"></a><span id="l14.114"> </span>
<a href="#l14.115"></a><span id="l14.115">       if (maybeIdent &amp;&amp; maybeIdent.identity) {</span>
<a href="#l14.116"></a><span id="l14.116">         let acct = EnigmailFuncs.getAccountForIdentity(maybeIdent.identity);</span>
<a href="#l14.117"></a><span id="l14.117">         return acct.incomingServer.getBoolValue(&quot;enableAutocrypt&quot;);</span>
<a href="#l14.118"></a><span id="l14.118">       }</span>
<a href="#l14.119"></a><span id="l14.119">     } catch (ex) {}</span>
<a href="#l14.120"></a><span id="l14.120"> </span>
<a href="#l14.121"></a><span id="l14.121">     return false;</span>
<a href="#l14.122"></a><span id="l14.122">   },</span>
<a href="#l14.123"></a><span id="l14.123" class="difflineplus">+  */</span>
<a href="#l14.124"></a><span id="l14.124"> </span>
<a href="#l14.125"></a><span id="l14.125">   messageImport() {</span>
<a href="#l14.126"></a><span id="l14.126">     EnigmailLog.DEBUG(&quot;enigmailMessengerOverlay.js: messageImport:\n&quot;);</span>
<a href="#l14.127"></a><span id="l14.127"> </span>
<a href="#l14.128"></a><span id="l14.128">     return this.messageParse(</span>
<a href="#l14.129"></a><span id="l14.129">       true,</span>
<a href="#l14.130"></a><span id="l14.130">       true,</span>
<a href="#l14.131"></a><span id="l14.131">       &quot;&quot;,</span>
<a href="#l14.132"></a><span id="l14.132" class="difflineat">@@ -753,26 +761,28 @@ Enigmail.msg = {</span>
<a href="#l14.133"></a><span id="l14.133">           body: &quot;&quot;,</span>
<a href="#l14.134"></a><span id="l14.134">           parent: null,</span>
<a href="#l14.135"></a><span id="l14.135">           subParts: [],</span>
<a href="#l14.136"></a><span id="l14.136">         };</span>
<a href="#l14.137"></a><span id="l14.137">       }</span>
<a href="#l14.138"></a><span id="l14.138"> </span>
<a href="#l14.139"></a><span id="l14.139">       // Copy selected headers</span>
<a href="#l14.140"></a><span id="l14.140">       Enigmail.msg.savedHeaders = {</span>
<a href="#l14.141"></a><span id="l14.141" class="difflineminus">-        autocrypt: [],</span>
<a href="#l14.142"></a><span id="l14.142" class="difflineplus">+        //autocrypt: [],</span>
<a href="#l14.143"></a><span id="l14.143">       };</span>
<a href="#l14.144"></a><span id="l14.144"> </span>
<a href="#l14.145"></a><span id="l14.145" class="difflineplus">+      /*</span>
<a href="#l14.146"></a><span id="l14.146">       for (let h in currentHeaderData) {</span>
<a href="#l14.147"></a><span id="l14.147">         if (h.search(/^autocrypt\d*$/) === 0) {</span>
<a href="#l14.148"></a><span id="l14.148">           Enigmail.msg.savedHeaders.autocrypt.push(</span>
<a href="#l14.149"></a><span id="l14.149">             currentHeaderData[h].headerValue</span>
<a href="#l14.150"></a><span id="l14.150">           );</span>
<a href="#l14.151"></a><span id="l14.151">         }</span>
<a href="#l14.152"></a><span id="l14.152">       }</span>
<a href="#l14.153"></a><span id="l14.153" class="difflineplus">+      */</span>
<a href="#l14.154"></a><span id="l14.154"> </span>
<a href="#l14.155"></a><span id="l14.155">       if (!mimeMsg.fullContentType) {</span>
<a href="#l14.156"></a><span id="l14.156">         mimeMsg.fullContentType = &quot;text/plain&quot;;</span>
<a href="#l14.157"></a><span id="l14.157">       }</span>
<a href="#l14.158"></a><span id="l14.158"> </span>
<a href="#l14.159"></a><span id="l14.159">       Enigmail.msg.savedHeaders[&quot;content-type&quot;] = mimeMsg.fullContentType;</span>
<a href="#l14.160"></a><span id="l14.160">       this.mimeParts = mimeMsg;</span>
<a href="#l14.161"></a><span id="l14.161"> </span>
<a href="#l14.162"></a><span id="l14.162" class="difflineat">@@ -793,16 +803,17 @@ Enigmail.msg = {</span>
<a href="#l14.163"></a><span id="l14.163">           &quot;enigmailMessengerOverlay.js: header &quot; +</span>
<a href="#l14.164"></a><span id="l14.164">             headerName +</span>
<a href="#l14.165"></a><span id="l14.165">             &quot;: '&quot; +</span>
<a href="#l14.166"></a><span id="l14.166">             headerValue +</span>
<a href="#l14.167"></a><span id="l14.167">             &quot;'\n&quot;</span>
<a href="#l14.168"></a><span id="l14.168">         );</span>
<a href="#l14.169"></a><span id="l14.169">       }</span>
<a href="#l14.170"></a><span id="l14.170"> </span>
<a href="#l14.171"></a><span id="l14.171" class="difflineplus">+      /*</span>
<a href="#l14.172"></a><span id="l14.172">       if (</span>
<a href="#l14.173"></a><span id="l14.173">         &quot;autocrypt&quot; in Enigmail.msg.savedHeaders &amp;&amp;</span>
<a href="#l14.174"></a><span id="l14.174">         Enigmail.msg.savedHeaders.autocrypt.length &gt; 0 &amp;&amp;</span>
<a href="#l14.175"></a><span id="l14.175">         &quot;from&quot; in currentHeaderData</span>
<a href="#l14.176"></a><span id="l14.176">       ) {</span>
<a href="#l14.177"></a><span id="l14.177">         let dateValue = &quot;&quot;;</span>
<a href="#l14.178"></a><span id="l14.178">         if (&quot;date&quot; in currentHeaderData) {</span>
<a href="#l14.179"></a><span id="l14.179">           dateValue = currentHeaderData.date.headerValue;</span>
<a href="#l14.180"></a><span id="l14.180" class="difflineat">@@ -812,16 +823,17 @@ Enigmail.msg = {</span>
<a href="#l14.181"></a><span id="l14.181">           currentHeaderData.from.headerValue,</span>
<a href="#l14.182"></a><span id="l14.182">           Enigmail.msg.savedHeaders.autocrypt,</span>
<a href="#l14.183"></a><span id="l14.183">           dateValue,</span>
<a href="#l14.184"></a><span id="l14.184">           Enigmail.msg.isAutocryptEnabled()</span>
<a href="#l14.185"></a><span id="l14.185">         );</span>
<a href="#l14.186"></a><span id="l14.186">       } else {</span>
<a href="#l14.187"></a><span id="l14.187">         Enigmail.msg.createArtificialAutocryptHeader();</span>
<a href="#l14.188"></a><span id="l14.188">       }</span>
<a href="#l14.189"></a><span id="l14.189" class="difflineplus">+      */</span>
<a href="#l14.190"></a><span id="l14.190"> </span>
<a href="#l14.191"></a><span id="l14.191">       var msgSigned =</span>
<a href="#l14.192"></a><span id="l14.192">         mimeMsg.fullContentType.search(/^multipart\/signed/i) === 0 &amp;&amp;</span>
<a href="#l14.193"></a><span id="l14.193">         EnigmailMime.getProtocol(mimeMsg.fullContentType).search(</span>
<a href="#l14.194"></a><span id="l14.194">           /^application\/pgp-signature/i</span>
<a href="#l14.195"></a><span id="l14.195">         ) === 0;</span>
<a href="#l14.196"></a><span id="l14.196">       var msgEncrypted =</span>
<a href="#l14.197"></a><span id="l14.197">         mimeMsg.fullContentType.search(/^multipart\/encrypted/i) === 0 &amp;&amp;</span>
<a href="#l14.198"></a><span id="l14.198" class="difflineat">@@ -841,30 +853,32 @@ Enigmail.msg = {</span>
<a href="#l14.199"></a><span id="l14.199">             &quot; / &quot; +</span>
<a href="#l14.200"></a><span id="l14.200">             resultObj.signed.join(&quot;, &quot;) +</span>
<a href="#l14.201"></a><span id="l14.201">             &quot;\n&quot;</span>
<a href="#l14.202"></a><span id="l14.202">         );</span>
<a href="#l14.203"></a><span id="l14.203"> </span>
<a href="#l14.204"></a><span id="l14.204">         msgSigned = msgSigned || resultObj.signed.length &gt; 0;</span>
<a href="#l14.205"></a><span id="l14.205">         msgEncrypted = msgEncrypted || resultObj.encrypted.length &gt; 0;</span>
<a href="#l14.206"></a><span id="l14.206"> </span>
<a href="#l14.207"></a><span id="l14.207" class="difflineplus">+        /*</span>
<a href="#l14.208"></a><span id="l14.208">         if (</span>
<a href="#l14.209"></a><span id="l14.209">           &quot;autocrypt-setup-message&quot; in Enigmail.msg.savedHeaders &amp;&amp;</span>
<a href="#l14.210"></a><span id="l14.210">           Enigmail.msg.savedHeaders[&quot;autocrypt-setup-message&quot;].toLowerCase() ===</span>
<a href="#l14.211"></a><span id="l14.211">             &quot;v1&quot;</span>
<a href="#l14.212"></a><span id="l14.212">         ) {</span>
<a href="#l14.213"></a><span id="l14.213">           if (</span>
<a href="#l14.214"></a><span id="l14.214">             currentAttachments[0].contentType.search(</span>
<a href="#l14.215"></a><span id="l14.215">               /^application\/autocrypt-setup$/i</span>
<a href="#l14.216"></a><span id="l14.216">             ) === 0</span>
<a href="#l14.217"></a><span id="l14.217">           ) {</span>
<a href="#l14.218"></a><span id="l14.218">             Enigmail.hdrView.displayAutoCryptSetupMsgHeader();</span>
<a href="#l14.219"></a><span id="l14.219">             return;</span>
<a href="#l14.220"></a><span id="l14.220">           }</span>
<a href="#l14.221"></a><span id="l14.221">         }</span>
<a href="#l14.222"></a><span id="l14.222" class="difflineplus">+        */</span>
<a href="#l14.223"></a><span id="l14.223"> </span>
<a href="#l14.224"></a><span id="l14.224">         // HACK for Zimbra OpenPGP Zimlet</span>
<a href="#l14.225"></a><span id="l14.225">         // Zimbra illegally changes attachment content-type to application/pgp-encrypted which interfers with below</span>
<a href="#l14.226"></a><span id="l14.226">         // see https://sourceforge.net/p/enigmail/bugs/600/</span>
<a href="#l14.227"></a><span id="l14.227"> </span>
<a href="#l14.228"></a><span id="l14.228">         try {</span>
<a href="#l14.229"></a><span id="l14.229">           if (</span>
<a href="#l14.230"></a><span id="l14.230">             mimeMsg.subParts.length &gt; 1 &amp;&amp;</span>
<a href="#l14.231"></a><span id="l14.231" class="difflineat">@@ -880,17 +894,19 @@ Enigmail.msg = {</span>
<a href="#l14.232"></a><span id="l14.232">               event,</span>
<a href="#l14.233"></a><span id="l14.233">               false,</span>
<a href="#l14.234"></a><span id="l14.234">               Enigmail.msg.savedHeaders[&quot;content-transfer-encoding&quot;],</span>
<a href="#l14.235"></a><span id="l14.235">               this.getCurrentMsgUriSpec(),</span>
<a href="#l14.236"></a><span id="l14.236">               isAuto</span>
<a href="#l14.237"></a><span id="l14.237">             );</span>
<a href="#l14.238"></a><span id="l14.238">             return;</span>
<a href="#l14.239"></a><span id="l14.239">           }</span>
<a href="#l14.240"></a><span id="l14.240" class="difflineminus">-        } catch (ex) {}</span>
<a href="#l14.241"></a><span id="l14.241" class="difflineplus">+        } catch (ex) {</span>
<a href="#l14.242"></a><span id="l14.242" class="difflineplus">+          console.debug(ex);</span>
<a href="#l14.243"></a><span id="l14.243" class="difflineplus">+        }</span>
<a href="#l14.244"></a><span id="l14.244"> </span>
<a href="#l14.245"></a><span id="l14.245">         // HACK for MS-EXCHANGE-Server Problem:</span>
<a href="#l14.246"></a><span id="l14.246">         // check for possible bad mime structure due to buggy exchange server:</span>
<a href="#l14.247"></a><span id="l14.247">         // - multipart/mixed Container with</span>
<a href="#l14.248"></a><span id="l14.248">         //   - application/pgp-encrypted Attachment with name &quot;PGPMIME Versions Identification&quot;</span>
<a href="#l14.249"></a><span id="l14.249">         //   - application/octet-stream Attachment with name &quot;encrypted.asc&quot; having the encrypted content in base64</span>
<a href="#l14.250"></a><span id="l14.250">         // - see:</span>
<a href="#l14.251"></a><span id="l14.251">         //   - http://www.mozilla-enigmail.org/forum/viewtopic.php?f=4&amp;t=425</span>
<a href="#l14.252"></a><span id="l14.252" class="difflineat">@@ -1178,37 +1194,41 @@ Enigmail.msg = {</span>
<a href="#l14.253"></a><span id="l14.253">             ex</span>
<a href="#l14.254"></a><span id="l14.254">           );</span>
<a href="#l14.255"></a><span id="l14.255">         }</span>
<a href="#l14.256"></a><span id="l14.256">         //EnigmailLog.DEBUG(&quot;nach base64 decode: \n&quot; + msgText + &quot;\n&quot;);</span>
<a href="#l14.257"></a><span id="l14.257">       }</span>
<a href="#l14.258"></a><span id="l14.258">     }</span>
<a href="#l14.259"></a><span id="l14.259"> </span>
<a href="#l14.260"></a><span id="l14.260">     var charset = msgWindow ? msgWindow.mailCharacterSet : &quot;&quot;;</span>
<a href="#l14.261"></a><span id="l14.261" class="difflineminus">-</span>
<a href="#l14.262"></a><span id="l14.262" class="difflineminus">-    // Encode ciphertext to charset from unicode</span>
<a href="#l14.263"></a><span id="l14.263" class="difflineminus">-    msgText = EnigmailData.convertFromUnicode(msgText, charset);</span>
<a href="#l14.264"></a><span id="l14.264" class="difflineplus">+    if (charset != &quot;UTF-8&quot;) {</span>
<a href="#l14.265"></a><span id="l14.265" class="difflineplus">+      // Encode ciphertext to charset from unicode</span>
<a href="#l14.266"></a><span id="l14.266" class="difflineplus">+      msgText = EnigmailData.convertFromUnicode(msgText, charset);</span>
<a href="#l14.267"></a><span id="l14.267" class="difflineplus">+    }</span>
<a href="#l14.268"></a><span id="l14.268"> </span>
<a href="#l14.269"></a><span id="l14.269">     if (isAuto) {</span>
<a href="#l14.270"></a><span id="l14.270" class="difflineminus">-      let ht = this.determineHeadAndTail(msgText);</span>
<a href="#l14.271"></a><span id="l14.271" class="difflineplus">+      let ht = this.hasHeadOrTailBesidesInlinePGP(msgText);</span>
<a href="#l14.272"></a><span id="l14.272">       if (ht) {</span>
<a href="#l14.273"></a><span id="l14.273" class="difflineplus">+        /*</span>
<a href="#l14.274"></a><span id="l14.274">         Enigmail.hdrView.updateHdrIcons(</span>
<a href="#l14.275"></a><span id="l14.275">           0,</span>
<a href="#l14.276"></a><span id="l14.276">           ht,</span>
<a href="#l14.277"></a><span id="l14.277">           &quot;&quot;,</span>
<a href="#l14.278"></a><span id="l14.278">           &quot;&quot;,</span>
<a href="#l14.279"></a><span id="l14.279">           &quot;&quot;,</span>
<a href="#l14.280"></a><span id="l14.280">           &quot;&quot;,</span>
<a href="#l14.281"></a><span id="l14.281">           null,</span>
<a href="#l14.282"></a><span id="l14.282">           &quot;&quot;,</span>
<a href="#l14.283"></a><span id="l14.283">           &quot;process-manually&quot;</span>
<a href="#l14.284"></a><span id="l14.284">         );</span>
<a href="#l14.285"></a><span id="l14.285" class="difflineplus">+        */</span>
<a href="#l14.286"></a><span id="l14.286">         return;</span>
<a href="#l14.287"></a><span id="l14.287">       }</span>
<a href="#l14.288"></a><span id="l14.288">     }</span>
<a href="#l14.289"></a><span id="l14.289" class="difflineplus">+</span>
<a href="#l14.290"></a><span id="l14.290">     var mozPlainText = bodyElement.innerHTML.search(/class=&quot;moz-text-plain&quot;/);</span>
<a href="#l14.291"></a><span id="l14.291"> </span>
<a href="#l14.292"></a><span id="l14.292">     if (mozPlainText &gt;= 0 &amp;&amp; mozPlainText &lt; 40) {</span>
<a href="#l14.293"></a><span id="l14.293">       // workaround for too much expanded emoticons in plaintext msg</span>
<a href="#l14.294"></a><span id="l14.294">       var r = new RegExp(</span>
<a href="#l14.295"></a><span id="l14.295">         /( )(;-\)|:-\)|;\)|:\)|:-\(|:\(|:-\\|:-P|:-D|:-\[|:-\*|&gt;:o|8-\)|:-\$|:-X|=-O|:-!|O:-\)|:'\()( )/g</span>
<a href="#l14.296"></a><span id="l14.296">       );</span>
<a href="#l14.297"></a><span id="l14.297">       if (msgText.search(r) &gt;= 0) {</span>
<a href="#l14.298"></a><span id="l14.298" class="difflineat">@@ -1258,17 +1278,17 @@ Enigmail.msg = {</span>
<a href="#l14.299"></a><span id="l14.299">   hasInlineQuote(node) {</span>
<a href="#l14.300"></a><span id="l14.300">     if (node.innerHTML.search(/&lt;blockquote.*-----BEGIN PGP /i) &lt; 0) {</span>
<a href="#l14.301"></a><span id="l14.301">       return false;</span>
<a href="#l14.302"></a><span id="l14.302">     }</span>
<a href="#l14.303"></a><span id="l14.303"> </span>
<a href="#l14.304"></a><span id="l14.304">     return EnigmailMsgRead.searchQuotedPgp(node);</span>
<a href="#l14.305"></a><span id="l14.305">   },</span>
<a href="#l14.306"></a><span id="l14.306"> </span>
<a href="#l14.307"></a><span id="l14.307" class="difflineminus">-  determineHeadAndTail(msgText) {</span>
<a href="#l14.308"></a><span id="l14.308" class="difflineplus">+  hasHeadOrTailBesidesInlinePGP(msgText) {</span>
<a href="#l14.309"></a><span id="l14.309">     let startIndex = msgText.search(/-----BEGIN PGP (SIGNED )?MESSAGE-----/m);</span>
<a href="#l14.310"></a><span id="l14.310">     let endIndex = msgText.indexOf(&quot;-----END PGP&quot;);</span>
<a href="#l14.311"></a><span id="l14.311">     let hasHead = false;</span>
<a href="#l14.312"></a><span id="l14.312">     let hasTail = false;</span>
<a href="#l14.313"></a><span id="l14.313">     let crypto = 0;</span>
<a href="#l14.314"></a><span id="l14.314"> </span>
<a href="#l14.315"></a><span id="l14.315">     if (startIndex &gt; 0) {</span>
<a href="#l14.316"></a><span id="l14.316">       let pgpMsg = msgText.match(/(-----BEGIN PGP (SIGNED )?MESSAGE-----)/m)[0];</span>
<a href="#l14.317"></a><span id="l14.317" class="difflineat">@@ -1294,25 +1314,18 @@ Enigmail.msg = {</span>
<a href="#l14.318"></a><span id="l14.318"> </span>
<a href="#l14.319"></a><span id="l14.319">     return 0;</span>
<a href="#l14.320"></a><span id="l14.320">   },</span>
<a href="#l14.321"></a><span id="l14.321"> </span>
<a href="#l14.322"></a><span id="l14.322">   getBodyElement(pbMessageIndex = &quot;0&quot;) {</span>
<a href="#l14.323"></a><span id="l14.323">     let bodyElement = null;</span>
<a href="#l14.324"></a><span id="l14.324"> </span>
<a href="#l14.325"></a><span id="l14.325">     // Thunderbird</span>
<a href="#l14.326"></a><span id="l14.326" class="difflineminus">-    let msgFrame = EnigmailWindows.getFrame(window, &quot;messagepane&quot;);</span>
<a href="#l14.327"></a><span id="l14.327" class="difflineminus">-    if (msgFrame) {</span>
<a href="#l14.328"></a><span id="l14.328" class="difflineminus">-      // TB &lt; 69</span>
<a href="#l14.329"></a><span id="l14.329" class="difflineminus">-      bodyElement = msgFrame.document.getElementsByTagName(&quot;body&quot;)[0];</span>
<a href="#l14.330"></a><span id="l14.330" class="difflineminus">-    } else {</span>
<a href="#l14.331"></a><span id="l14.331" class="difflineminus">-      // TB &gt;= 69</span>
<a href="#l14.332"></a><span id="l14.332" class="difflineminus">-      msgFrame = document.getElementById(&quot;messagepane&quot;);</span>
<a href="#l14.333"></a><span id="l14.333" class="difflineminus">-      bodyElement = msgFrame.contentDocument.getElementsByTagName(&quot;body&quot;)[0];</span>
<a href="#l14.334"></a><span id="l14.334" class="difflineminus">-    }</span>
<a href="#l14.335"></a><span id="l14.335" class="difflineplus">+    let msgFrame = document.getElementById(&quot;messagepane&quot;);</span>
<a href="#l14.336"></a><span id="l14.336" class="difflineplus">+    bodyElement = msgFrame.contentDocument.getElementsByTagName(&quot;body&quot;)[0];</span>
<a href="#l14.337"></a><span id="l14.337">     return bodyElement;</span>
<a href="#l14.338"></a><span id="l14.338">   },</span>
<a href="#l14.339"></a><span id="l14.339"> </span>
<a href="#l14.340"></a><span id="l14.340">   messageParseCallback(</span>
<a href="#l14.341"></a><span id="l14.341">     msgText,</span>
<a href="#l14.342"></a><span id="l14.342">     contentEncoding,</span>
<a href="#l14.343"></a><span id="l14.343">     charset,</span>
<a href="#l14.344"></a><span id="l14.344">     interactive,</span>
<a href="#l14.345"></a><span id="l14.345" class="difflineat">@@ -1387,17 +1400,17 @@ Enigmail.msg = {</span>
<a href="#l14.346"></a><span id="l14.346"> </span>
<a href="#l14.347"></a><span id="l14.347">     var exitCodeObj = {};</span>
<a href="#l14.348"></a><span id="l14.348">     var statusFlagsObj = {};</span>
<a href="#l14.349"></a><span id="l14.349">     var signatureObj = {};</span>
<a href="#l14.350"></a><span id="l14.350">     signatureObj.value = signature;</span>
<a href="#l14.351"></a><span id="l14.351"> </span>
<a href="#l14.352"></a><span id="l14.352">     var uiFlags = interactive</span>
<a href="#l14.353"></a><span id="l14.353">       ? EnigmailConstants.UI_INTERACTIVE |</span>
<a href="#l14.354"></a><span id="l14.354" class="difflineminus">-        EnigmailConstants.UI_ALLOW_KEY_IMPORT |</span>
<a href="#l14.355"></a><span id="l14.355" class="difflineplus">+        // EnigmailConstants.UI_ALLOW_KEY_IMPORT |</span>
<a href="#l14.356"></a><span id="l14.356">         EnigmailConstants.UI_UNVERIFIED_ENC_OK</span>
<a href="#l14.357"></a><span id="l14.357">       : 0;</span>
<a href="#l14.358"></a><span id="l14.358"> </span>
<a href="#l14.359"></a><span id="l14.359">     plainText = EnigmailDecryption.decryptMessage(</span>
<a href="#l14.360"></a><span id="l14.360">       window,</span>
<a href="#l14.361"></a><span id="l14.361">       uiFlags,</span>
<a href="#l14.362"></a><span id="l14.362">       msgText,</span>
<a href="#l14.363"></a><span id="l14.363">       signatureObj,</span>
<a href="#l14.364"></a><span id="l14.364" class="difflineat">@@ -1542,29 +1555,32 @@ Enigmail.msg = {</span>
<a href="#l14.365"></a><span id="l14.365"> </span>
<a href="#l14.366"></a><span id="l14.366">     if (retry &gt;= 2) {</span>
<a href="#l14.367"></a><span id="l14.367">       plainText = EnigmailData.convertFromUnicode(</span>
<a href="#l14.368"></a><span id="l14.368">         EnigmailData.convertToUnicode(plainText, &quot;UTF-8&quot;),</span>
<a href="#l14.369"></a><span id="l14.369">         charset</span>
<a href="#l14.370"></a><span id="l14.370">       );</span>
<a href="#l14.371"></a><span id="l14.371">     }</span>
<a href="#l14.372"></a><span id="l14.372"> </span>
<a href="#l14.373"></a><span id="l14.373" class="difflineplus">+    // TODO: what is blockSeparation ? How to emulate with RNP?</span>
<a href="#l14.374"></a><span id="l14.374" class="difflineplus">+    /*</span>
<a href="#l14.375"></a><span id="l14.375">     if (blockSeparationObj.value.includes(&quot; &quot;)) {</span>
<a href="#l14.376"></a><span id="l14.376">       var blocks = blockSeparationObj.value.split(/ /);</span>
<a href="#l14.377"></a><span id="l14.377">       var blockInfo = blocks[0].split(/:/);</span>
<a href="#l14.378"></a><span id="l14.378">       plainText =</span>
<a href="#l14.379"></a><span id="l14.379">         EnigmailData.convertFromUnicode(</span>
<a href="#l14.380"></a><span id="l14.380">           EnigmailLocale.getString(&quot;notePartEncrypted&quot;),</span>
<a href="#l14.381"></a><span id="l14.381">           charset</span>
<a href="#l14.382"></a><span id="l14.382">         ) +</span>
<a href="#l14.383"></a><span id="l14.383">         &quot;\n\n&quot; +</span>
<a href="#l14.384"></a><span id="l14.384">         plainText.substr(0, blockInfo[1]) +</span>
<a href="#l14.385"></a><span id="l14.385">         &quot;\n\n&quot; +</span>
<a href="#l14.386"></a><span id="l14.386">         EnigmailLocale.getString(&quot;noteCutMessage&quot;);</span>
<a href="#l14.387"></a><span id="l14.387">     }</span>
<a href="#l14.388"></a><span id="l14.388" class="difflineplus">+    */</span>
<a href="#l14.389"></a><span id="l14.389"> </span>
<a href="#l14.390"></a><span id="l14.390">     // Save decrypted message status, headers, and content</span>
<a href="#l14.391"></a><span id="l14.391">     var headerList = {</span>
<a href="#l14.392"></a><span id="l14.392">       subject: &quot;&quot;,</span>
<a href="#l14.393"></a><span id="l14.393">       from: &quot;&quot;,</span>
<a href="#l14.394"></a><span id="l14.394">       date: &quot;&quot;,</span>
<a href="#l14.395"></a><span id="l14.395">       to: &quot;&quot;,</span>
<a href="#l14.396"></a><span id="l14.396">       cc: &quot;&quot;,</span>
<a href="#l14.397"></a><span id="l14.397" class="difflineat">@@ -3034,16 +3050,17 @@ Enigmail.msg = {</span>
<a href="#l14.398"></a><span id="l14.398"> </span>
<a href="#l14.399"></a><span id="l14.399">     return null;</span>
<a href="#l14.400"></a><span id="l14.400">   },</span>
<a href="#l14.401"></a><span id="l14.401"> </span>
<a href="#l14.402"></a><span id="l14.402">   /**</span>
<a href="#l14.403"></a><span id="l14.403">    * Create an artificial Autocrypt: header if there was no such header on the message</span>
<a href="#l14.404"></a><span id="l14.404">    * and the message was signed</span>
<a href="#l14.405"></a><span id="l14.405">    */</span>
<a href="#l14.406"></a><span id="l14.406" class="difflineplus">+  /*</span>
<a href="#l14.407"></a><span id="l14.407">   createArtificialAutocryptHeader() {</span>
<a href="#l14.408"></a><span id="l14.408">     EnigmailLog.DEBUG(</span>
<a href="#l14.409"></a><span id="l14.409">       &quot;enigmailMessengerOverlay.js: createArtificialAutocryptHeader\n&quot;</span>
<a href="#l14.410"></a><span id="l14.410">     );</span>
<a href="#l14.411"></a><span id="l14.411"> </span>
<a href="#l14.412"></a><span id="l14.412">     if (&quot;autocrypt&quot; in currentHeaderData) {</span>
<a href="#l14.413"></a><span id="l14.413">       return;</span>
<a href="#l14.414"></a><span id="l14.414">     }</span>
<a href="#l14.415"></a><span id="l14.415" class="difflineat">@@ -3096,31 +3113,35 @@ Enigmail.msg = {</span>
<a href="#l14.416"></a><span id="l14.416">       EnigmailAutocrypt.processAutocryptHeader(</span>
<a href="#l14.417"></a><span id="l14.417">         fromValue,</span>
<a href="#l14.418"></a><span id="l14.418">         [hdrData],</span>
<a href="#l14.419"></a><span id="l14.419">         dateValue,</span>
<a href="#l14.420"></a><span id="l14.420">         Enigmail.msg.isAutocryptEnabled()</span>
<a href="#l14.421"></a><span id="l14.421">       );</span>
<a href="#l14.422"></a><span id="l14.422">     }</span>
<a href="#l14.423"></a><span id="l14.423">   },</span>
<a href="#l14.424"></a><span id="l14.424" class="difflineminus">-</span>
<a href="#l14.425"></a><span id="l14.425" class="difflineplus">+  */</span>
<a href="#l14.426"></a><span id="l14.426" class="difflineplus">+</span>
<a href="#l14.427"></a><span id="l14.427" class="difflineplus">+  /*</span>
<a href="#l14.428"></a><span id="l14.428">   flexActionRequest() {</span>
<a href="#l14.429"></a><span id="l14.429">     switch (Enigmail.msg.securityInfo.xtraStatus) {</span>
<a href="#l14.430"></a><span id="l14.430">       case &quot;wks-request&quot;:</span>
<a href="#l14.431"></a><span id="l14.431">         this.confirmWksRequest();</span>
<a href="#l14.432"></a><span id="l14.432">         break;</span>
<a href="#l14.433"></a><span id="l14.433">       case &quot;autocrypt-setup&quot;:</span>
<a href="#l14.434"></a><span id="l14.434">         this.performAutocryptSetup();</span>
<a href="#l14.435"></a><span id="l14.435">         break;</span>
<a href="#l14.436"></a><span id="l14.436">       case &quot;process-manually&quot;:</span>
<a href="#l14.437"></a><span id="l14.437">         this.messageDecrypt(null, false);</span>
<a href="#l14.438"></a><span id="l14.438">         break;</span>
<a href="#l14.439"></a><span id="l14.439">     }</span>
<a href="#l14.440"></a><span id="l14.440">   },</span>
<a href="#l14.441"></a><span id="l14.441" class="difflineminus">-</span>
<a href="#l14.442"></a><span id="l14.442" class="difflineplus">+  */</span>
<a href="#l14.443"></a><span id="l14.443" class="difflineplus">+</span>
<a href="#l14.444"></a><span id="l14.444" class="difflineplus">+  /*</span>
<a href="#l14.445"></a><span id="l14.445">   confirmWksRequest() {</span>
<a href="#l14.446"></a><span id="l14.446">     EnigmailLog.DEBUG(&quot;enigmailMessengerOverlay.js: confirmWksRequest()\n&quot;);</span>
<a href="#l14.447"></a><span id="l14.447">     try {</span>
<a href="#l14.448"></a><span id="l14.448">       var msg = gFolderDisplay.selectedMessage;</span>
<a href="#l14.449"></a><span id="l14.449">       if (!(!msg || !msg.folder)) {</span>
<a href="#l14.450"></a><span id="l14.450">         var msgHdr = msg.folder.GetMessageHeader(msg.messageKey);</span>
<a href="#l14.451"></a><span id="l14.451">         let email = EnigmailFuncs.stripEmail(msgHdr.recipients);</span>
<a href="#l14.452"></a><span id="l14.452">         let maybeIdent = EnigmailStdlib.getIdentityForEmail(email);</span>
<a href="#l14.453"></a><span id="l14.453" class="difflineat">@@ -3150,16 +3171,17 @@ Enigmail.msg = {</span>
<a href="#l14.454"></a><span id="l14.454">             EnigmailLocale.getString(&quot;wksNoIdentity&quot;, [email])</span>
<a href="#l14.455"></a><span id="l14.455">           );</span>
<a href="#l14.456"></a><span id="l14.456">         }</span>
<a href="#l14.457"></a><span id="l14.457">       }</span>
<a href="#l14.458"></a><span id="l14.458">     } catch (e) {</span>
<a href="#l14.459"></a><span id="l14.459">       EnigmailLog.DEBUG(e + &quot;\n&quot;);</span>
<a href="#l14.460"></a><span id="l14.460">     }</span>
<a href="#l14.461"></a><span id="l14.461">   },</span>
<a href="#l14.462"></a><span id="l14.462" class="difflineplus">+  */</span>
<a href="#l14.463"></a><span id="l14.463"> </span>
<a href="#l14.464"></a><span id="l14.464">   performAutocryptSetup(passwd = null) {</span>
<a href="#l14.465"></a><span id="l14.465">     EnigmailLog.DEBUG(&quot;enigmailMessengerOverlay.js: performAutocryptSetup()\n&quot;);</span>
<a href="#l14.466"></a><span id="l14.466"> </span>
<a href="#l14.467"></a><span id="l14.467">     EnigmailDialog.alert(</span>
<a href="#l14.468"></a><span id="l14.468">       window,</span>
<a href="#l14.469"></a><span id="l14.469">       &quot;EnigmailAutocrypt.handleBackupMessage not implemented&quot;</span>
<a href="#l14.470"></a><span id="l14.470">     );</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mail/extensions/openpgp/content/ui/enigmailMsgHdrViewOverlay.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/ui/enigmailMsgHdrViewOverlay.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -58,45 +58,50 @@ var EnigmailData = ChromeUtils.import(</span>
<a href="#l15.4"></a><span id="l15.4">   &quot;chrome://openpgp/content/modules/data.jsm&quot;</span>
<a href="#l15.5"></a><span id="l15.5"> ).EnigmailData;</span>
<a href="#l15.6"></a><span id="l15.6"> var EnigmailClipboard = ChromeUtils.import(</span>
<a href="#l15.7"></a><span id="l15.7">   &quot;chrome://openpgp/content/modules/clipboard.jsm&quot;</span>
<a href="#l15.8"></a><span id="l15.8"> ).EnigmailClipboard;</span>
<a href="#l15.9"></a><span id="l15.9"> var EnigmailStdlib = ChromeUtils.import(</span>
<a href="#l15.10"></a><span id="l15.10">   &quot;chrome://openpgp/content/modules/stdlib.jsm&quot;</span>
<a href="#l15.11"></a><span id="l15.11"> ).EnigmailStdlib;</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineplus">+/*</span>
<a href="#l15.13"></a><span id="l15.13"> var EnigmailWks = ChromeUtils.import(</span>
<a href="#l15.14"></a><span id="l15.14">   &quot;chrome://openpgp/content/modules/webKey.jsm&quot;</span>
<a href="#l15.15"></a><span id="l15.15"> ).EnigmailWks;</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineplus">+*/</span>
<a href="#l15.17"></a><span id="l15.17"> var EnigmailMime = ChromeUtils.import(</span>
<a href="#l15.18"></a><span id="l15.18">   &quot;chrome://openpgp/content/modules/mime.jsm&quot;</span>
<a href="#l15.19"></a><span id="l15.19"> ).EnigmailMime;</span>
<a href="#l15.20"></a><span id="l15.20"> var EnigmailMsgRead = ChromeUtils.import(</span>
<a href="#l15.21"></a><span id="l15.21">   &quot;chrome://openpgp/content/modules/msgRead.jsm&quot;</span>
<a href="#l15.22"></a><span id="l15.22"> ).EnigmailMsgRead;</span>
<a href="#l15.23"></a><span id="l15.23"> var EnigmailSingletons = ChromeUtils.import(</span>
<a href="#l15.24"></a><span id="l15.24">   &quot;chrome://openpgp/content/modules/singletons.jsm&quot;</span>
<a href="#l15.25"></a><span id="l15.25"> ).EnigmailSingletons;</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineplus">+/*</span>
<a href="#l15.27"></a><span id="l15.27"> var EnigmailAutocrypt = ChromeUtils.import(</span>
<a href="#l15.28"></a><span id="l15.28">   &quot;chrome://openpgp/content/modules/autocrypt.jsm&quot;</span>
<a href="#l15.29"></a><span id="l15.29"> ).EnigmailAutocrypt;</span>
<a href="#l15.30"></a><span id="l15.30" class="difflineplus">+*/</span>
<a href="#l15.31"></a><span id="l15.31"> var EnigmailCompat = ChromeUtils.import(</span>
<a href="#l15.32"></a><span id="l15.32">   &quot;chrome://openpgp/content/modules/compat.jsm&quot;</span>
<a href="#l15.33"></a><span id="l15.33"> ).EnigmailCompat;</span>
<a href="#l15.34"></a><span id="l15.34"> </span>
<a href="#l15.35"></a><span id="l15.35"> if (!Enigmail) {</span>
<a href="#l15.36"></a><span id="l15.36">   var Enigmail = {};</span>
<a href="#l15.37"></a><span id="l15.37"> }</span>
<a href="#l15.38"></a><span id="l15.38"> </span>
<a href="#l15.39"></a><span id="l15.39"> Enigmail.hdrView = {</span>
<a href="#l15.40"></a><span id="l15.40" class="difflineminus">-  statusBar: null,</span>
<a href="#l15.41"></a><span id="l15.41" class="difflineminus">-  enigmailBox: null,</span>
<a href="#l15.42"></a><span id="l15.42" class="difflineplus">+  //enigmailBox: null,</span>
<a href="#l15.43"></a><span id="l15.43">   lastEncryptedMsgKey: null,</span>
<a href="#l15.44"></a><span id="l15.44">   lastEncryptedUri: null,</span>
<a href="#l15.45"></a><span id="l15.45">   flexbuttonAction: null,</span>
<a href="#l15.46"></a><span id="l15.46" class="difflineplus">+  isEncrypted: &quot;&quot;,</span>
<a href="#l15.47"></a><span id="l15.47" class="difflineplus">+  isSigned: &quot;&quot;,</span>
<a href="#l15.48"></a><span id="l15.48"> </span>
<a href="#l15.49"></a><span id="l15.49">   hdrViewLoad() {</span>
<a href="#l15.50"></a><span id="l15.50">     EnigmailLog.DEBUG(&quot;enigmailMsgHdrViewOverlay.js: this.hdrViewLoad\n&quot;);</span>
<a href="#l15.51"></a><span id="l15.51"> </span>
<a href="#l15.52"></a><span id="l15.52">     // THE FOLLOWING OVERRIDES CODE IN msgHdrViewOverlay.js</span>
<a href="#l15.53"></a><span id="l15.53">     // which wouldn't work otherwise</span>
<a href="#l15.54"></a><span id="l15.54"> </span>
<a href="#l15.55"></a><span id="l15.55">     this.origCanDetachAttachments = CanDetachAttachments;</span>
<a href="#l15.56"></a><span id="l15.56" class="difflineat">@@ -104,35 +109,36 @@ Enigmail.hdrView = {</span>
<a href="#l15.57"></a><span id="l15.57">       return (</span>
<a href="#l15.58"></a><span id="l15.58">         Enigmail.hdrView.origCanDetachAttachments() &amp;&amp;</span>
<a href="#l15.59"></a><span id="l15.59">         Enigmail.hdrView.enigCanDetachAttachments()</span>
<a href="#l15.60"></a><span id="l15.60">       );</span>
<a href="#l15.61"></a><span id="l15.61">     };</span>
<a href="#l15.62"></a><span id="l15.62"> </span>
<a href="#l15.63"></a><span id="l15.63">     this.msgHdrViewLoad();</span>
<a href="#l15.64"></a><span id="l15.64"> </span>
<a href="#l15.65"></a><span id="l15.65" class="difflineplus">+    /*</span>
<a href="#l15.66"></a><span id="l15.66">     // Override SMIME ui</span>
<a href="#l15.67"></a><span id="l15.67">     let signedHdrElement = document.getElementById(&quot;signedHdrIcon&quot;);</span>
<a href="#l15.68"></a><span id="l15.68">     if (signedHdrElement) {</span>
<a href="#l15.69"></a><span id="l15.69">       signedHdrElement.setAttribute(</span>
<a href="#l15.70"></a><span id="l15.70">         &quot;onclick&quot;,</span>
<a href="#l15.71"></a><span id="l15.71">         &quot;Enigmail.msg.viewSecurityInfo(event, true);&quot;</span>
<a href="#l15.72"></a><span id="l15.72">       );</span>
<a href="#l15.73"></a><span id="l15.73">     }</span>
<a href="#l15.74"></a><span id="l15.74"> </span>
<a href="#l15.75"></a><span id="l15.75">     let encryptedHdrElement = document.getElementById(&quot;encryptedHdrIcon&quot;);</span>
<a href="#l15.76"></a><span id="l15.76">     if (encryptedHdrElement) {</span>
<a href="#l15.77"></a><span id="l15.77">       encryptedHdrElement.setAttribute(</span>
<a href="#l15.78"></a><span id="l15.78">         &quot;onclick&quot;,</span>
<a href="#l15.79"></a><span id="l15.79">         &quot;Enigmail.msg.viewSecurityInfo(event, true);&quot;</span>
<a href="#l15.80"></a><span id="l15.80">       );</span>
<a href="#l15.81"></a><span id="l15.81">     }</span>
<a href="#l15.82"></a><span id="l15.82" class="difflineplus">+    */</span>
<a href="#l15.83"></a><span id="l15.83"> </span>
<a href="#l15.84"></a><span id="l15.84" class="difflineminus">-    this.statusBar = document.getElementById(&quot;enigmail-status-bar&quot;);</span>
<a href="#l15.85"></a><span id="l15.85" class="difflineminus">-    this.enigmailBox = document.getElementById(&quot;enigmailBox&quot;);</span>
<a href="#l15.86"></a><span id="l15.86" class="difflineplus">+    //this.enigmailBox = document.getElementById(&quot;enigmailBox&quot;);</span>
<a href="#l15.87"></a><span id="l15.87"> </span>
<a href="#l15.88"></a><span id="l15.88">     let addrPopup = document.getElementById(&quot;emailAddressPopup&quot;);</span>
<a href="#l15.89"></a><span id="l15.89">     if (addrPopup) {</span>
<a href="#l15.90"></a><span id="l15.90">       addrPopup.addEventListener(</span>
<a href="#l15.91"></a><span id="l15.91">         &quot;popupshowing&quot;,</span>
<a href="#l15.92"></a><span id="l15.92">         Enigmail.hdrView.displayAddressPopup.bind(addrPopup)</span>
<a href="#l15.93"></a><span id="l15.93">       );</span>
<a href="#l15.94"></a><span id="l15.94">     }</span>
<a href="#l15.95"></a><span id="l15.95" class="difflineat">@@ -148,33 +154,36 @@ Enigmail.hdrView = {</span>
<a href="#l15.96"></a><span id="l15.96">   },</span>
<a href="#l15.97"></a><span id="l15.97"> </span>
<a href="#l15.98"></a><span id="l15.98">   displayAddressPopup(event) {</span>
<a href="#l15.99"></a><span id="l15.99">     let target = event.target;</span>
<a href="#l15.100"></a><span id="l15.100">     EnigmailFuncs.collapseAdvanced(target, &quot;hidden&quot;);</span>
<a href="#l15.101"></a><span id="l15.101">   },</span>
<a href="#l15.102"></a><span id="l15.102"> </span>
<a href="#l15.103"></a><span id="l15.103">   statusBarHide() {</span>
<a href="#l15.104"></a><span id="l15.104" class="difflineplus">+    /* elements might not have been set yet, so we try and ignore */</span>
<a href="#l15.105"></a><span id="l15.105">     try {</span>
<a href="#l15.106"></a><span id="l15.106" class="difflineminus">-      this.statusBar.removeAttribute(&quot;signed&quot;);</span>
<a href="#l15.107"></a><span id="l15.107" class="difflineminus">-      this.statusBar.removeAttribute(&quot;encrypted&quot;);</span>
<a href="#l15.108"></a><span id="l15.108" class="difflineminus">-      this.enigmailBox.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l15.109"></a><span id="l15.109" class="difflineplus">+      this.isSigned = null;</span>
<a href="#l15.110"></a><span id="l15.110" class="difflineplus">+      this.isEncrypted = null;</span>
<a href="#l15.111"></a><span id="l15.111" class="difflineplus">+      //this.enigmailBox.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l15.112"></a><span id="l15.112"> </span>
<a href="#l15.113"></a><span id="l15.113">       Enigmail.msg.setAttachmentReveal(null);</span>
<a href="#l15.114"></a><span id="l15.114">       if (Enigmail.msg.securityInfo) {</span>
<a href="#l15.115"></a><span id="l15.115">         Enigmail.msg.securityInfo.statusFlags = 0;</span>
<a href="#l15.116"></a><span id="l15.116">         Enigmail.msg.securityInfo.msgSigned = 0;</span>
<a href="#l15.117"></a><span id="l15.117">         Enigmail.msg.securityInfo.msgEncrypted = 0;</span>
<a href="#l15.118"></a><span id="l15.118">       }</span>
<a href="#l15.119"></a><span id="l15.119"> </span>
<a href="#l15.120"></a><span id="l15.120" class="difflineminus">-      let enigMsgPane = document.getElementById(&quot;enigmailMsgDisplay&quot;);</span>
<a href="#l15.121"></a><span id="l15.121" class="difflineplus">+      //let enigMsgPane = document.getElementById(&quot;enigmailMsgDisplay&quot;);</span>
<a href="#l15.122"></a><span id="l15.122">       let bodyElement = document.getElementById(&quot;messagepane&quot;);</span>
<a href="#l15.123"></a><span id="l15.123" class="difflineminus">-      enigMsgPane.setAttribute(&quot;collapsed&quot;, true);</span>
<a href="#l15.124"></a><span id="l15.124" class="difflineplus">+      //enigMsgPane.setAttribute(&quot;collapsed&quot;, true);</span>
<a href="#l15.125"></a><span id="l15.125">       bodyElement.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l15.126"></a><span id="l15.126" class="difflineminus">-    } catch (ex) {}</span>
<a href="#l15.127"></a><span id="l15.127" class="difflineplus">+    } catch (ex) {</span>
<a href="#l15.128"></a><span id="l15.128" class="difflineplus">+      console.debug(ex);</span>
<a href="#l15.129"></a><span id="l15.129" class="difflineplus">+    }</span>
<a href="#l15.130"></a><span id="l15.130">   },</span>
<a href="#l15.131"></a><span id="l15.131"> </span>
<a href="#l15.132"></a><span id="l15.132">   setStatusText(txt) {</span>
<a href="#l15.133"></a><span id="l15.133">     let s = document.getElementById(&quot;enigmailStatusText&quot;);</span>
<a href="#l15.134"></a><span id="l15.134">     if (s) {</span>
<a href="#l15.135"></a><span id="l15.135">       s.firstChild.data = txt;</span>
<a href="#l15.136"></a><span id="l15.136">     }</span>
<a href="#l15.137"></a><span id="l15.137">   },</span>
<a href="#l15.138"></a><span id="l15.138" class="difflineat">@@ -200,43 +209,44 @@ Enigmail.hdrView = {</span>
<a href="#l15.139"></a><span id="l15.139">         keyId +</span>
<a href="#l15.140"></a><span id="l15.140">         &quot;, userId=&quot; +</span>
<a href="#l15.141"></a><span id="l15.141">         userId +</span>
<a href="#l15.142"></a><span id="l15.142">         &quot;, &quot; +</span>
<a href="#l15.143"></a><span id="l15.143">         errorMsg +</span>
<a href="#l15.144"></a><span id="l15.144">         &quot;\n&quot;</span>
<a href="#l15.145"></a><span id="l15.145">     );</span>
<a href="#l15.146"></a><span id="l15.146"> </span>
<a href="#l15.147"></a><span id="l15.147" class="difflineplus">+    /*</span>
<a href="#l15.148"></a><span id="l15.148">     if (</span>
<a href="#l15.149"></a><span id="l15.149">       Enigmail.msg.securityInfo &amp;&amp;</span>
<a href="#l15.150"></a><span id="l15.150">       Enigmail.msg.securityInfo.xtraStatus &amp;&amp;</span>
<a href="#l15.151"></a><span id="l15.151">       Enigmail.msg.securityInfo.xtraStatus === &quot;wks-request&quot;</span>
<a href="#l15.152"></a><span id="l15.152">     ) {</span>
<a href="#l15.153"></a><span id="l15.153">       return;</span>
<a href="#l15.154"></a><span id="l15.154">     }</span>
<a href="#l15.155"></a><span id="l15.155" class="difflineplus">+    */</span>
<a href="#l15.156"></a><span id="l15.156"> </span>
<a href="#l15.157"></a><span id="l15.157" class="difflineminus">-    this.statusBar = document.getElementById(&quot;enigmail-status-bar&quot;);</span>
<a href="#l15.158"></a><span id="l15.158" class="difflineminus">-    this.enigmailBox = document.getElementById(&quot;enigmailBox&quot;);</span>
<a href="#l15.159"></a><span id="l15.159" class="difflineplus">+    //this.enigmailBox = document.getElementById(&quot;enigmailBox&quot;);</span>
<a href="#l15.160"></a><span id="l15.160"> </span>
<a href="#l15.161"></a><span id="l15.161">     if (</span>
<a href="#l15.162"></a><span id="l15.162">       gFolderDisplay.selectedMessageUris &amp;&amp;</span>
<a href="#l15.163"></a><span id="l15.163">       gFolderDisplay.selectedMessageUris.length &gt; 0</span>
<a href="#l15.164"></a><span id="l15.164">     ) {</span>
<a href="#l15.165"></a><span id="l15.165">       this.lastEncryptedMsgKey = gFolderDisplay.selectedMessageUris[0];</span>
<a href="#l15.166"></a><span id="l15.166">     }</span>
<a href="#l15.167"></a><span id="l15.167"> </span>
<a href="#l15.168"></a><span id="l15.168">     if (!errorMsg) {</span>
<a href="#l15.169"></a><span id="l15.169">       errorMsg = &quot;&quot;;</span>
<a href="#l15.170"></a><span id="l15.170">     }</span>
<a href="#l15.171"></a><span id="l15.171"> </span>
<a href="#l15.172"></a><span id="l15.172">     var replaceUid = null;</span>
<a href="#l15.173"></a><span id="l15.173">     if (keyId &amp;&amp; gFolderDisplay.selectedMessage) {</span>
<a href="#l15.174"></a><span id="l15.174">       replaceUid = EnigmailMsgRead.matchUidToSender(</span>
<a href="#l15.175"></a><span id="l15.175">         keyId,</span>
<a href="#l15.176"></a><span id="l15.176" class="difflineminus">-        gFolderDisplay.selectedMessage</span>
<a href="#l15.177"></a><span id="l15.177" class="difflineplus">+        gFolderDisplay.selectedMessage.author</span>
<a href="#l15.178"></a><span id="l15.178">       );</span>
<a href="#l15.179"></a><span id="l15.179">     }</span>
<a href="#l15.180"></a><span id="l15.180"> </span>
<a href="#l15.181"></a><span id="l15.181">     if (!replaceUid) {</span>
<a href="#l15.182"></a><span id="l15.182">       replaceUid = userId.replace(/\n.*$/gm, &quot;&quot;);</span>
<a href="#l15.183"></a><span id="l15.183">     }</span>
<a href="#l15.184"></a><span id="l15.184"> </span>
<a href="#l15.185"></a><span id="l15.185">     if (</span>
<a href="#l15.186"></a><span id="l15.186" class="difflineat">@@ -279,258 +289,146 @@ Enigmail.hdrView = {</span>
<a href="#l15.187"></a><span id="l15.187">       while (errorLines.length &gt; 20) {</span>
<a href="#l15.188"></a><span id="l15.188">         errorLines.pop();</span>
<a href="#l15.189"></a><span id="l15.189">       }</span>
<a href="#l15.190"></a><span id="l15.190"> </span>
<a href="#l15.191"></a><span id="l15.191">       errorMsg = errorLines.join(&quot;\n&quot;) + &quot;\n...\n&quot; + lastLines;</span>
<a href="#l15.192"></a><span id="l15.192">     }</span>
<a href="#l15.193"></a><span id="l15.193"> </span>
<a href="#l15.194"></a><span id="l15.194">     var statusInfo = &quot;&quot;;</span>
<a href="#l15.195"></a><span id="l15.195" class="difflineminus">-    var statusLine = &quot;&quot;;</span>
<a href="#l15.196"></a><span id="l15.196" class="difflineminus">-    var statusArr = [];</span>
<a href="#l15.197"></a><span id="l15.197"> </span>
<a href="#l15.198"></a><span id="l15.198">     if (statusFlags &amp; EnigmailConstants.NODATA) {</span>
<a href="#l15.199"></a><span id="l15.199">       if (statusFlags &amp; EnigmailConstants.PGP_MIME_SIGNED) {</span>
<a href="#l15.200"></a><span id="l15.200">         statusFlags |= EnigmailConstants.UNVERIFIED_SIGNATURE;</span>
<a href="#l15.201"></a><span id="l15.201">       }</span>
<a href="#l15.202"></a><span id="l15.202"> </span>
<a href="#l15.203"></a><span id="l15.203">       if (statusFlags &amp; EnigmailConstants.PGP_MIME_ENCRYPTED) {</span>
<a href="#l15.204"></a><span id="l15.204">         statusFlags |= EnigmailConstants.DECRYPTION_INCOMPLETE;</span>
<a href="#l15.205"></a><span id="l15.205">       }</span>
<a href="#l15.206"></a><span id="l15.206">     }</span>
<a href="#l15.207"></a><span id="l15.207"> </span>
<a href="#l15.208"></a><span id="l15.208">     if (!(statusFlags &amp; EnigmailConstants.PGP_MIME_ENCRYPTED)) {</span>
<a href="#l15.209"></a><span id="l15.209">       encMimePartNumber = &quot;&quot;;</span>
<a href="#l15.210"></a><span id="l15.210">     }</span>
<a href="#l15.211"></a><span id="l15.211"> </span>
<a href="#l15.212"></a><span id="l15.212" class="difflineminus">-    if (!EnigmailPrefs.getPref(&quot;displayPartiallySigned&quot;)) {</span>
<a href="#l15.213"></a><span id="l15.213" class="difflineminus">-      if (</span>
<a href="#l15.214"></a><span id="l15.214" class="difflineminus">-        statusFlags &amp; EnigmailConstants.PARTIALLY_PGP &amp;&amp;</span>
<a href="#l15.215"></a><span id="l15.215" class="difflineminus">-        statusFlags &amp; EnigmailConstants.BAD_SIGNATURE</span>
<a href="#l15.216"></a><span id="l15.216" class="difflineminus">-      ) {</span>
<a href="#l15.217"></a><span id="l15.217" class="difflineminus">-        statusFlags &amp;= ~(</span>
<a href="#l15.218"></a><span id="l15.218" class="difflineminus">-          EnigmailConstants.BAD_SIGNATURE | EnigmailConstants.PARTIALLY_PGP</span>
<a href="#l15.219"></a><span id="l15.219" class="difflineminus">-        );</span>
<a href="#l15.220"></a><span id="l15.220" class="difflineminus">-        if (statusFlags === 0) {</span>
<a href="#l15.221"></a><span id="l15.221" class="difflineminus">-          errorMsg = &quot;&quot;;</span>
<a href="#l15.222"></a><span id="l15.222" class="difflineminus">-          fullStatusInfo = &quot;&quot;;</span>
<a href="#l15.223"></a><span id="l15.223" class="difflineminus">-        }</span>
<a href="#l15.224"></a><span id="l15.224" class="difflineplus">+    if (</span>
<a href="#l15.225"></a><span id="l15.225" class="difflineplus">+      statusFlags &amp; EnigmailConstants.PARTIALLY_PGP &amp;&amp;</span>
<a href="#l15.226"></a><span id="l15.226" class="difflineplus">+      statusFlags &amp; EnigmailConstants.BAD_SIGNATURE</span>
<a href="#l15.227"></a><span id="l15.227" class="difflineplus">+    ) {</span>
<a href="#l15.228"></a><span id="l15.228" class="difflineplus">+      statusFlags &amp;= ~(</span>
<a href="#l15.229"></a><span id="l15.229" class="difflineplus">+        EnigmailConstants.PARTIALLY_PGP | EnigmailConstants.BAD_SIGNATURE</span>
<a href="#l15.230"></a><span id="l15.230" class="difflineplus">+      );</span>
<a href="#l15.231"></a><span id="l15.231" class="difflineplus">+      if (statusFlags === 0) {</span>
<a href="#l15.232"></a><span id="l15.232" class="difflineplus">+        errorMsg = &quot;&quot;;</span>
<a href="#l15.233"></a><span id="l15.233" class="difflineplus">+        fullStatusInfo = &quot;&quot;;</span>
<a href="#l15.234"></a><span id="l15.234">       }</span>
<a href="#l15.235"></a><span id="l15.235">     }</span>
<a href="#l15.236"></a><span id="l15.236"> </span>
<a href="#l15.237"></a><span id="l15.237">     var msgSigned =</span>
<a href="#l15.238"></a><span id="l15.238">       statusFlags &amp;</span>
<a href="#l15.239"></a><span id="l15.239">       (EnigmailConstants.BAD_SIGNATURE |</span>
<a href="#l15.240"></a><span id="l15.240">         EnigmailConstants.GOOD_SIGNATURE |</span>
<a href="#l15.241"></a><span id="l15.241">         EnigmailConstants.EXPIRED_KEY_SIGNATURE |</span>
<a href="#l15.242"></a><span id="l15.242">         EnigmailConstants.EXPIRED_SIGNATURE |</span>
<a href="#l15.243"></a><span id="l15.243">         EnigmailConstants.UNVERIFIED_SIGNATURE |</span>
<a href="#l15.244"></a><span id="l15.244">         EnigmailConstants.REVOKED_KEY |</span>
<a href="#l15.245"></a><span id="l15.245">         EnigmailConstants.EXPIRED_KEY_SIGNATURE |</span>
<a href="#l15.246"></a><span id="l15.246">         EnigmailConstants.EXPIRED_SIGNATURE);</span>
<a href="#l15.247"></a><span id="l15.247" class="difflineplus">+    /*</span>
<a href="#l15.248"></a><span id="l15.248">     var msgEncrypted =</span>
<a href="#l15.249"></a><span id="l15.249">       statusFlags &amp;</span>
<a href="#l15.250"></a><span id="l15.250">       (EnigmailConstants.DECRYPTION_OKAY |</span>
<a href="#l15.251"></a><span id="l15.251">         EnigmailConstants.DECRYPTION_INCOMPLETE |</span>
<a href="#l15.252"></a><span id="l15.252">         EnigmailConstants.DECRYPTION_FAILED);</span>
<a href="#l15.253"></a><span id="l15.253" class="difflineplus">+    */</span>
<a href="#l15.254"></a><span id="l15.254"> </span>
<a href="#l15.255"></a><span id="l15.255" class="difflineplus">+    /*</span>
<a href="#l15.256"></a><span id="l15.256">     if (msgSigned &amp;&amp; statusFlags &amp; EnigmailConstants.IMPORTED_KEY) {</span>
<a href="#l15.257"></a><span id="l15.257">       statusFlags &amp;= ~EnigmailConstants.IMPORTED_KEY;</span>
<a href="#l15.258"></a><span id="l15.258">     }</span>
<a href="#l15.259"></a><span id="l15.259" class="difflineplus">+    */</span>
<a href="#l15.260"></a><span id="l15.260"> </span>
<a href="#l15.261"></a><span id="l15.261" class="difflineminus">-    if (</span>
<a href="#l15.262"></a><span id="l15.262" class="difflineminus">-      !(statusFlags &amp; EnigmailConstants.DECRYPTION_FAILED) &amp;&amp;</span>
<a href="#l15.263"></a><span id="l15.263" class="difflineminus">-      (!(</span>
<a href="#l15.264"></a><span id="l15.264" class="difflineminus">-        statusFlags &amp;</span>
<a href="#l15.265"></a><span id="l15.265" class="difflineminus">-        (EnigmailConstants.DECRYPTION_INCOMPLETE |</span>
<a href="#l15.266"></a><span id="l15.266" class="difflineminus">-          EnigmailConstants.UNVERIFIED_SIGNATURE |</span>
<a href="#l15.267"></a><span id="l15.267" class="difflineminus">-          EnigmailConstants.DECRYPTION_FAILED |</span>
<a href="#l15.268"></a><span id="l15.268" class="difflineminus">-          EnigmailConstants.BAD_SIGNATURE)</span>
<a href="#l15.269"></a><span id="l15.269" class="difflineminus">-      ) ||</span>
<a href="#l15.270"></a><span id="l15.270" class="difflineminus">-        (statusFlags &amp; EnigmailConstants.DISPLAY_MESSAGE &amp;&amp;</span>
<a href="#l15.271"></a><span id="l15.271" class="difflineminus">-          !(statusFlags &amp; EnigmailConstants.UNVERIFIED_SIGNATURE))) &amp;&amp;</span>
<a href="#l15.272"></a><span id="l15.272" class="difflineminus">-      !(statusFlags &amp; EnigmailConstants.IMPORTED_KEY)</span>
<a href="#l15.273"></a><span id="l15.273" class="difflineminus">-    ) {</span>
<a href="#l15.274"></a><span id="l15.274" class="difflineminus">-      // normal exit / display message</span>
<a href="#l15.275"></a><span id="l15.275" class="difflineminus">-      statusLine = errorMsg;</span>
<a href="#l15.276"></a><span id="l15.276" class="difflineminus">-      statusInfo = statusLine;</span>
<a href="#l15.277"></a><span id="l15.277" class="difflineminus">-</span>
<a href="#l15.278"></a><span id="l15.278" class="difflineminus">-      if (sigDetails) {</span>
<a href="#l15.279"></a><span id="l15.279" class="difflineminus">-        var detailArr = sigDetails.split(/ /);</span>
<a href="#l15.280"></a><span id="l15.280" class="difflineplus">+    // TODO: visualize the following signature attributes,</span>
<a href="#l15.281"></a><span id="l15.281" class="difflineplus">+    // cross-check with corresponding email attributes</span>
<a href="#l15.282"></a><span id="l15.282" class="difflineplus">+    // - date</span>
<a href="#l15.283"></a><span id="l15.283" class="difflineplus">+    // - signer uid</span>
<a href="#l15.284"></a><span id="l15.284" class="difflineplus">+    // - signer key</span>
<a href="#l15.285"></a><span id="l15.285" class="difflineplus">+    // - signing and hash alg</span>
<a href="#l15.286"></a><span id="l15.286"> </span>
<a href="#l15.287"></a><span id="l15.287" class="difflineminus">-        let dateTime = EnigmailTime.getDateTime(detailArr[2], true, true);</span>
<a href="#l15.288"></a><span id="l15.288" class="difflineminus">-        var txt = EnigmailLocale.getString(&quot;keyAndSigDate&quot;, [keyId, dateTime]);</span>
<a href="#l15.289"></a><span id="l15.289" class="difflineminus">-        statusArr.push(txt);</span>
<a href="#l15.290"></a><span id="l15.290" class="difflineminus">-        statusInfo += &quot;\n&quot; + txt;</span>
<a href="#l15.291"></a><span id="l15.291" class="difflineminus">-        var fpr = &quot;&quot;;</span>
<a href="#l15.292"></a><span id="l15.292" class="difflineminus">-        if (detailArr.length &gt;= 10) {</span>
<a href="#l15.293"></a><span id="l15.293" class="difflineminus">-          fpr = EnigmailKey.formatFpr(detailArr[9]);</span>
<a href="#l15.294"></a><span id="l15.294" class="difflineminus">-        } else {</span>
<a href="#l15.295"></a><span id="l15.295" class="difflineminus">-          fpr = EnigmailKey.formatFpr(detailArr[0]);</span>
<a href="#l15.296"></a><span id="l15.296" class="difflineminus">-        }</span>
<a href="#l15.297"></a><span id="l15.297" class="difflineminus">-        if (fpr) {</span>
<a href="#l15.298"></a><span id="l15.298" class="difflineminus">-          statusInfo += &quot;\n&quot; + EnigmailLocale.getString(&quot;keyFpr&quot;, [fpr]);</span>
<a href="#l15.299"></a><span id="l15.299" class="difflineminus">-        }</span>
<a href="#l15.300"></a><span id="l15.300" class="difflineminus">-        if (detailArr.length &gt; 7) {</span>
<a href="#l15.301"></a><span id="l15.301" class="difflineminus">-          var signingAlg = EnigmailGpg.signingAlgIdToString(detailArr[6]);</span>
<a href="#l15.302"></a><span id="l15.302" class="difflineminus">-          var hashAlg = EnigmailGpg.hashAlgIdToString(detailArr[7]);</span>
<a href="#l15.303"></a><span id="l15.303" class="difflineminus">-</span>
<a href="#l15.304"></a><span id="l15.304" class="difflineminus">-          statusInfo +=</span>
<a href="#l15.305"></a><span id="l15.305" class="difflineminus">-            &quot;\n\n&quot; +</span>
<a href="#l15.306"></a><span id="l15.306" class="difflineminus">-            EnigmailLocale.getString(&quot;usedAlgorithms&quot;, [signingAlg, hashAlg]);</span>
<a href="#l15.307"></a><span id="l15.307" class="difflineminus">-        }</span>
<a href="#l15.308"></a><span id="l15.308" class="difflineplus">+    // - process failed decryptions first because they imply bad signature handling</span>
<a href="#l15.309"></a><span id="l15.309" class="difflineplus">+    if (statusFlags &amp; EnigmailConstants.BAD_PASSPHRASE) {</span>
<a href="#l15.310"></a><span id="l15.310" class="difflineplus">+      statusInfo = EnigmailLocale.getString(&quot;badPhrase&quot;);</span>
<a href="#l15.311"></a><span id="l15.311" class="difflineplus">+    } else if (statusFlags &amp; EnigmailConstants.DECRYPTION_FAILED) {</span>
<a href="#l15.312"></a><span id="l15.312" class="difflineplus">+      if (statusFlags &amp; EnigmailConstants.MISSING_MDC) {</span>
<a href="#l15.313"></a><span id="l15.313" class="difflineplus">+        statusInfo = EnigmailLocale.getString(&quot;missingMdcError&quot;);</span>
<a href="#l15.314"></a><span id="l15.314" class="difflineplus">+      } else if (statusFlags &amp; EnigmailConstants.MISSING_PASSPHRASE) {</span>
<a href="#l15.315"></a><span id="l15.315" class="difflineplus">+        statusInfo = EnigmailLocale.getString(&quot;missingPassphrase&quot;);</span>
<a href="#l15.316"></a><span id="l15.316" class="difflineplus">+      } else if (statusFlags &amp; EnigmailConstants.NO_SECKEY) {</span>
<a href="#l15.317"></a><span id="l15.317" class="difflineplus">+        statusInfo = EnigmailLocale.getString(&quot;needKey&quot;);</span>
<a href="#l15.318"></a><span id="l15.318" class="difflineplus">+      } else {</span>
<a href="#l15.319"></a><span id="l15.319" class="difflineplus">+        statusInfo = EnigmailLocale.getString(&quot;failedDecrypt&quot;);</span>
<a href="#l15.320"></a><span id="l15.320">       }</span>
<a href="#l15.321"></a><span id="l15.321" class="difflineminus">-      fullStatusInfo = statusInfo;</span>
<a href="#l15.322"></a><span id="l15.322" class="difflineminus">-    } else {</span>
<a href="#l15.323"></a><span id="l15.323" class="difflineminus">-      // no normal exit / don't display message</span>
<a href="#l15.324"></a><span id="l15.324" class="difflineminus">-      // - process failed decryptions first because they imply bad signature handling</span>
<a href="#l15.325"></a><span id="l15.325" class="difflineminus">-      if (statusFlags &amp; EnigmailConstants.BAD_PASSPHRASE) {</span>
<a href="#l15.326"></a><span id="l15.326" class="difflineminus">-        statusInfo = EnigmailLocale.getString(&quot;badPhrase&quot;);</span>
<a href="#l15.327"></a><span id="l15.327" class="difflineminus">-        statusLine = statusInfo + EnigmailLocale.getString(&quot;clickDecryptRetry&quot;);</span>
<a href="#l15.328"></a><span id="l15.328" class="difflineminus">-      } else if (statusFlags &amp; EnigmailConstants.DECRYPTION_FAILED) {</span>
<a href="#l15.329"></a><span id="l15.329" class="difflineminus">-        if (statusFlags &amp; EnigmailConstants.MISSING_MDC) {</span>
<a href="#l15.330"></a><span id="l15.330" class="difflineminus">-          statusInfo = EnigmailLocale.getString(&quot;missingMdcError&quot;);</span>
<a href="#l15.331"></a><span id="l15.331" class="difflineminus">-          statusLine = statusInfo;</span>
<a href="#l15.332"></a><span id="l15.332" class="difflineminus">-        } else if (statusFlags &amp; EnigmailConstants.MISSING_PASSPHRASE) {</span>
<a href="#l15.333"></a><span id="l15.333" class="difflineminus">-          statusInfo = EnigmailLocale.getString(&quot;missingPassphrase&quot;);</span>
<a href="#l15.334"></a><span id="l15.334" class="difflineminus">-          statusLine =</span>
<a href="#l15.335"></a><span id="l15.335" class="difflineminus">-            statusInfo + EnigmailLocale.getString(&quot;clickDecryptRetry&quot;);</span>
<a href="#l15.336"></a><span id="l15.336" class="difflineminus">-        } else if (statusFlags &amp; EnigmailConstants.NO_SECKEY) {</span>
<a href="#l15.337"></a><span id="l15.337" class="difflineminus">-          statusInfo = EnigmailLocale.getString(&quot;needKey&quot;);</span>
<a href="#l15.338"></a><span id="l15.338" class="difflineminus">-        } else {</span>
<a href="#l15.339"></a><span id="l15.339" class="difflineminus">-          statusInfo = EnigmailLocale.getString(&quot;failedDecrypt&quot;);</span>
<a href="#l15.340"></a><span id="l15.340" class="difflineminus">-        }</span>
<a href="#l15.341"></a><span id="l15.341" class="difflineminus">-        statusLine =</span>
<a href="#l15.342"></a><span id="l15.342" class="difflineminus">-          statusInfo + EnigmailLocale.getString(&quot;clickDetailsButton&quot;);</span>
<a href="#l15.343"></a><span id="l15.343" class="difflineminus">-      } else if (statusFlags &amp; EnigmailConstants.UNVERIFIED_SIGNATURE) {</span>
<a href="#l15.344"></a><span id="l15.344" class="difflineminus">-        statusInfo = EnigmailLocale.getString(&quot;unverifiedSig&quot;);</span>
<a href="#l15.345"></a><span id="l15.345" class="difflineminus">-        if (keyId) {</span>
<a href="#l15.346"></a><span id="l15.346" class="difflineminus">-          statusLine =</span>
<a href="#l15.347"></a><span id="l15.347" class="difflineminus">-            statusInfo + EnigmailLocale.getString(&quot;clickImportButton&quot;);</span>
<a href="#l15.348"></a><span id="l15.348" class="difflineminus">-        } else {</span>
<a href="#l15.349"></a><span id="l15.349" class="difflineminus">-          statusLine =</span>
<a href="#l15.350"></a><span id="l15.350" class="difflineminus">-            statusInfo + EnigmailLocale.getString(&quot;keyTypeUnsupported&quot;);</span>
<a href="#l15.351"></a><span id="l15.351" class="difflineminus">-        }</span>
<a href="#l15.352"></a><span id="l15.352" class="difflineminus">-      } else if (</span>
<a href="#l15.353"></a><span id="l15.353" class="difflineminus">-        statusFlags &amp;</span>
<a href="#l15.354"></a><span id="l15.354" class="difflineminus">-        (EnigmailConstants.BAD_SIGNATURE |</span>
<a href="#l15.355"></a><span id="l15.355" class="difflineminus">-          EnigmailConstants.EXPIRED_SIGNATURE |</span>
<a href="#l15.356"></a><span id="l15.356" class="difflineminus">-          EnigmailConstants.EXPIRED_KEY_SIGNATURE)</span>
<a href="#l15.357"></a><span id="l15.357" class="difflineminus">-      ) {</span>
<a href="#l15.358"></a><span id="l15.358" class="difflineminus">-        statusInfo = EnigmailLocale.getString(&quot;unverifiedSig&quot;);</span>
<a href="#l15.359"></a><span id="l15.359" class="difflineminus">-        statusLine =</span>
<a href="#l15.360"></a><span id="l15.360" class="difflineminus">-          statusInfo + EnigmailLocale.getString(&quot;clickDetailsButton&quot;);</span>
<a href="#l15.361"></a><span id="l15.361" class="difflineminus">-      } else if (statusFlags &amp; EnigmailConstants.DECRYPTION_INCOMPLETE) {</span>
<a href="#l15.362"></a><span id="l15.362" class="difflineminus">-        statusInfo = EnigmailLocale.getString(&quot;incompleteDecrypt&quot;);</span>
<a href="#l15.363"></a><span id="l15.363" class="difflineminus">-        statusLine =</span>
<a href="#l15.364"></a><span id="l15.364" class="difflineminus">-          statusInfo + EnigmailLocale.getString(&quot;clickDetailsButton&quot;);</span>
<a href="#l15.365"></a><span id="l15.365" class="difflineminus">-      } else if (statusFlags &amp; EnigmailConstants.IMPORTED_KEY) {</span>
<a href="#l15.366"></a><span id="l15.366" class="difflineminus">-        statusLine = &quot;&quot;;</span>
<a href="#l15.367"></a><span id="l15.367" class="difflineminus">-        statusInfo = &quot;&quot;;</span>
<a href="#l15.368"></a><span id="l15.368" class="difflineminus">-        EnigmailDialog.info(window, errorMsg);</span>
<a href="#l15.369"></a><span id="l15.369" class="difflineplus">+    } else if (statusFlags &amp; EnigmailConstants.UNVERIFIED_SIGNATURE) {</span>
<a href="#l15.370"></a><span id="l15.370" class="difflineplus">+      statusInfo = EnigmailLocale.getString(&quot;unverifiedSig&quot;);</span>
<a href="#l15.371"></a><span id="l15.371" class="difflineplus">+    } else if (statusFlags &amp; EnigmailConstants.GOOD_SIGNATURE) {</span>
<a href="#l15.372"></a><span id="l15.372" class="difflineplus">+      statusInfo = EnigmailLocale.getString(&quot;goodSig&quot;, [keyId]);</span>
<a href="#l15.373"></a><span id="l15.373" class="difflineplus">+    } else if (</span>
<a href="#l15.374"></a><span id="l15.374" class="difflineplus">+      statusFlags &amp;</span>
<a href="#l15.375"></a><span id="l15.375" class="difflineplus">+      (EnigmailConstants.BAD_SIGNATURE |</span>
<a href="#l15.376"></a><span id="l15.376" class="difflineplus">+        EnigmailConstants.EXPIRED_SIGNATURE |</span>
<a href="#l15.377"></a><span id="l15.377" class="difflineplus">+        EnigmailConstants.EXPIRED_KEY_SIGNATURE)</span>
<a href="#l15.378"></a><span id="l15.378" class="difflineplus">+    ) {</span>
<a href="#l15.379"></a><span id="l15.379" class="difflineplus">+      statusInfo = EnigmailLocale.getString(&quot;unverifiedSig&quot;);</span>
<a href="#l15.380"></a><span id="l15.380" class="difflineplus">+    } else if (statusFlags &amp; EnigmailConstants.DECRYPTION_OKAY) {</span>
<a href="#l15.381"></a><span id="l15.381" class="difflineplus">+      statusInfo = EnigmailLocale.getString(&quot;decryptedMsg&quot;);</span>
<a href="#l15.382"></a><span id="l15.382" class="difflineplus">+    } else if (statusFlags &amp; EnigmailConstants.DECRYPTION_INCOMPLETE) {</span>
<a href="#l15.383"></a><span id="l15.383" class="difflineplus">+      statusInfo = EnigmailLocale.getString(&quot;incompleteDecrypt&quot;);</span>
<a href="#l15.384"></a><span id="l15.384" class="difflineplus">+    } else if (statusFlags &amp; EnigmailConstants.IMPORTED_KEY) {</span>
<a href="#l15.385"></a><span id="l15.385" class="difflineplus">+      statusInfo = &quot;&quot;;</span>
<a href="#l15.386"></a><span id="l15.386" class="difflineplus">+      EnigmailDialog.info(window, errorMsg);</span>
<a href="#l15.387"></a><span id="l15.387" class="difflineplus">+    }</span>
<a href="#l15.388"></a><span id="l15.388" class="difflineplus">+    // add key infos if available</span>
<a href="#l15.389"></a><span id="l15.389" class="difflineplus">+    if (keyId) {</span>
<a href="#l15.390"></a><span id="l15.390" class="difflineplus">+      var si = EnigmailLocale.getString(&quot;unverifiedSig&quot;); // &quot;Unverified signature&quot;</span>
<a href="#l15.391"></a><span id="l15.391" class="difflineplus">+      if (statusInfo === &quot;&quot;) {</span>
<a href="#l15.392"></a><span id="l15.392" class="difflineplus">+        statusInfo += si;</span>
<a href="#l15.393"></a><span id="l15.393" class="difflineplus">+      }</span>
<a href="#l15.394"></a><span id="l15.394" class="difflineplus">+      if (statusFlags &amp; EnigmailConstants.UNVERIFIED_SIGNATURE) {</span>
<a href="#l15.395"></a><span id="l15.395" class="difflineplus">+        statusInfo += &quot;\n&quot; + EnigmailLocale.getString(&quot;keyNeeded&quot;, [keyId]); // &quot;public key ... needed&quot;</span>
<a href="#l15.396"></a><span id="l15.396">       } else {</span>
<a href="#l15.397"></a><span id="l15.397" class="difflineminus">-        // TODO: can we ever get to this point anymore?</span>
<a href="#l15.398"></a><span id="l15.398" class="difflineminus">-        // FIXME: the viewInfo string is outdated</span>
<a href="#l15.399"></a><span id="l15.399" class="difflineminus">-        statusInfo = EnigmailLocale.getString(&quot;failedDecryptVerify&quot;);</span>
<a href="#l15.400"></a><span id="l15.400" class="difflineminus">-        statusLine = statusInfo + EnigmailLocale.getString(&quot;viewInfo&quot;);</span>
<a href="#l15.401"></a><span id="l15.401" class="difflineplus">+        statusInfo += &quot;\n&quot; + EnigmailLocale.getString(&quot;keyUsed&quot;, [keyId]); // &quot;public key ... used&quot;</span>
<a href="#l15.402"></a><span id="l15.402">       }</span>
<a href="#l15.403"></a><span id="l15.403" class="difflineminus">-      // add key infos if available</span>
<a href="#l15.404"></a><span id="l15.404" class="difflineminus">-      if (keyId) {</span>
<a href="#l15.405"></a><span id="l15.405" class="difflineminus">-        var si = EnigmailLocale.getString(&quot;unverifiedSig&quot;); // &quot;Unverified signature&quot;</span>
<a href="#l15.406"></a><span id="l15.406" class="difflineminus">-        if (statusInfo === &quot;&quot;) {</span>
<a href="#l15.407"></a><span id="l15.407" class="difflineminus">-          statusInfo += si;</span>
<a href="#l15.408"></a><span id="l15.408" class="difflineminus">-          statusLine = si + EnigmailLocale.getString(&quot;clickDetailsButton&quot;);</span>
<a href="#l15.409"></a><span id="l15.409" class="difflineminus">-        }</span>
<a href="#l15.410"></a><span id="l15.410" class="difflineminus">-        if (statusFlags &amp; EnigmailConstants.UNVERIFIED_SIGNATURE) {</span>
<a href="#l15.411"></a><span id="l15.411" class="difflineminus">-          statusInfo += &quot;\n&quot; + EnigmailLocale.getString(&quot;keyNeeded&quot;, [keyId]); // &quot;public key ... needed&quot;</span>
<a href="#l15.412"></a><span id="l15.412" class="difflineminus">-        } else {</span>
<a href="#l15.413"></a><span id="l15.413" class="difflineminus">-          statusInfo += &quot;\n&quot; + EnigmailLocale.getString(&quot;keyUsed&quot;, [keyId]); // &quot;public key ... used&quot;</span>
<a href="#l15.414"></a><span id="l15.414" class="difflineminus">-        }</span>
<a href="#l15.415"></a><span id="l15.415" class="difflineminus">-      }</span>
<a href="#l15.416"></a><span id="l15.416" class="difflineminus">-      statusInfo += &quot;\n\n&quot; + errorMsg;</span>
<a href="#l15.417"></a><span id="l15.417">     }</span>
<a href="#l15.418"></a><span id="l15.418" class="difflineplus">+    //statusInfo += &quot;\n\n&quot; + errorMsg;</span>
<a href="#l15.419"></a><span id="l15.419"> </span>
<a href="#l15.420"></a><span id="l15.420">     if (</span>
<a href="#l15.421"></a><span id="l15.421">       statusFlags &amp; EnigmailConstants.DECRYPTION_OKAY ||</span>
<a href="#l15.422"></a><span id="l15.422" class="difflineminus">-      this.statusBar.getAttribute(&quot;encrypted&quot;) == &quot;ok&quot;</span>
<a href="#l15.423"></a><span id="l15.423" class="difflineplus">+      this.isEncrypted === &quot;ok&quot;</span>
<a href="#l15.424"></a><span id="l15.424">     ) {</span>
<a href="#l15.425"></a><span id="l15.425">       var statusMsg;</span>
<a href="#l15.426"></a><span id="l15.426">       if (xtraStatus &amp;&amp; xtraStatus == &quot;buggyMailFormat&quot;) {</span>
<a href="#l15.427"></a><span id="l15.427">         statusMsg = EnigmailLocale.getString(&quot;decryptedMsgWithFormatError&quot;);</span>
<a href="#l15.428"></a><span id="l15.428">       } else {</span>
<a href="#l15.429"></a><span id="l15.429">         statusMsg = EnigmailLocale.getString(&quot;decryptedMsg&quot;);</span>
<a href="#l15.430"></a><span id="l15.430">       }</span>
<a href="#l15.431"></a><span id="l15.431">       if (!statusInfo) {</span>
<a href="#l15.432"></a><span id="l15.432">         statusInfo = statusMsg;</span>
<a href="#l15.433"></a><span id="l15.433">       } else {</span>
<a href="#l15.434"></a><span id="l15.434">         statusInfo = statusMsg + &quot;\n&quot; + statusInfo;</span>
<a href="#l15.435"></a><span id="l15.435">       }</span>
<a href="#l15.436"></a><span id="l15.436" class="difflineminus">-      if (!statusLine) {</span>
<a href="#l15.437"></a><span id="l15.437" class="difflineminus">-        statusLine = statusInfo;</span>
<a href="#l15.438"></a><span id="l15.438" class="difflineminus">-      } else {</span>
<a href="#l15.439"></a><span id="l15.439" class="difflineminus">-        statusLine = statusMsg + &quot;; &quot; + statusLine;</span>
<a href="#l15.440"></a><span id="l15.440" class="difflineminus">-      }</span>
<a href="#l15.441"></a><span id="l15.441">     }</span>
<a href="#l15.442"></a><span id="l15.442"> </span>
<a href="#l15.443"></a><span id="l15.443" class="difflineminus">-    if (EnigmailPrefs.getPref(&quot;displayPartiallySigned&quot;)) {</span>
<a href="#l15.444"></a><span id="l15.444" class="difflineminus">-      if (statusFlags &amp; EnigmailConstants.PARTIALLY_PGP) {</span>
<a href="#l15.445"></a><span id="l15.445" class="difflineminus">-        if (msgSigned &amp;&amp; msgEncrypted) {</span>
<a href="#l15.446"></a><span id="l15.446" class="difflineminus">-          statusLine = EnigmailLocale.getString(&quot;msgPart&quot;, [</span>
<a href="#l15.447"></a><span id="l15.447" class="difflineminus">-            EnigmailLocale.getString(&quot;msgSignedAndEnc&quot;),</span>
<a href="#l15.448"></a><span id="l15.448" class="difflineminus">-          ]);</span>
<a href="#l15.449"></a><span id="l15.449" class="difflineminus">-          statusLine += EnigmailLocale.getString(&quot;clickDetailsButton&quot;);</span>
<a href="#l15.450"></a><span id="l15.450" class="difflineminus">-          statusInfo =</span>
<a href="#l15.451"></a><span id="l15.451" class="difflineminus">-            EnigmailLocale.getString(&quot;msgPart&quot;, [</span>
<a href="#l15.452"></a><span id="l15.452" class="difflineminus">-              EnigmailLocale.getString(&quot;msgSigned&quot;),</span>
<a href="#l15.453"></a><span id="l15.453" class="difflineminus">-            ]) +</span>
<a href="#l15.454"></a><span id="l15.454" class="difflineminus">-            &quot;\n&quot; +</span>
<a href="#l15.455"></a><span id="l15.455" class="difflineminus">-            statusInfo;</span>
<a href="#l15.456"></a><span id="l15.456" class="difflineminus">-        } else if (msgEncrypted) {</span>
<a href="#l15.457"></a><span id="l15.457" class="difflineminus">-          statusLine = EnigmailLocale.getString(&quot;msgPart&quot;, [</span>
<a href="#l15.458"></a><span id="l15.458" class="difflineminus">-            EnigmailLocale.getString(&quot;msgEncrypted&quot;),</span>
<a href="#l15.459"></a><span id="l15.459" class="difflineminus">-          ]);</span>
<a href="#l15.460"></a><span id="l15.460" class="difflineminus">-          statusLine += EnigmailLocale.getString(&quot;clickDetailsButton&quot;);</span>
<a href="#l15.461"></a><span id="l15.461" class="difflineminus">-          statusInfo =</span>
<a href="#l15.462"></a><span id="l15.462" class="difflineminus">-            EnigmailLocale.getString(&quot;msgPart&quot;, [</span>
<a href="#l15.463"></a><span id="l15.463" class="difflineminus">-              EnigmailLocale.getString(&quot;msgEncrypted&quot;),</span>
<a href="#l15.464"></a><span id="l15.464" class="difflineminus">-            ]) +</span>
<a href="#l15.465"></a><span id="l15.465" class="difflineminus">-            &quot;\n&quot; +</span>
<a href="#l15.466"></a><span id="l15.466" class="difflineminus">-            statusInfo;</span>
<a href="#l15.467"></a><span id="l15.467" class="difflineminus">-        } else if (msgSigned) {</span>
<a href="#l15.468"></a><span id="l15.468" class="difflineminus">-          if (statusFlags &amp; EnigmailConstants.UNVERIFIED_SIGNATURE) {</span>
<a href="#l15.469"></a><span id="l15.469" class="difflineminus">-            statusLine = EnigmailLocale.getString(&quot;msgPart&quot;, [</span>
<a href="#l15.470"></a><span id="l15.470" class="difflineminus">-              EnigmailLocale.getString(&quot;msgSignedUnkownKey&quot;),</span>
<a href="#l15.471"></a><span id="l15.471" class="difflineminus">-            ]);</span>
<a href="#l15.472"></a><span id="l15.472" class="difflineminus">-            if (keyId) {</span>
<a href="#l15.473"></a><span id="l15.473" class="difflineminus">-              statusLine += EnigmailLocale.getString(&quot;clickImportButton&quot;);</span>
<a href="#l15.474"></a><span id="l15.474" class="difflineminus">-            } else {</span>
<a href="#l15.475"></a><span id="l15.475" class="difflineminus">-              statusLine += EnigmailLocale.getString(&quot;keyTypeUnsupported&quot;);</span>
<a href="#l15.476"></a><span id="l15.476" class="difflineminus">-            }</span>
<a href="#l15.477"></a><span id="l15.477" class="difflineminus">-          } else {</span>
<a href="#l15.478"></a><span id="l15.478" class="difflineminus">-            statusLine = EnigmailLocale.getString(&quot;msgPart&quot;, [</span>
<a href="#l15.479"></a><span id="l15.479" class="difflineminus">-              EnigmailLocale.getString(&quot;msgSigned&quot;),</span>
<a href="#l15.480"></a><span id="l15.480" class="difflineminus">-            ]);</span>
<a href="#l15.481"></a><span id="l15.481" class="difflineminus">-            statusLine += EnigmailLocale.getString(&quot;clickDetailsButton&quot;);</span>
<a href="#l15.482"></a><span id="l15.482" class="difflineminus">-          }</span>
<a href="#l15.483"></a><span id="l15.483" class="difflineminus">-          statusInfo =</span>
<a href="#l15.484"></a><span id="l15.484" class="difflineminus">-            EnigmailLocale.getString(&quot;msgPart&quot;, [</span>
<a href="#l15.485"></a><span id="l15.485" class="difflineminus">-              EnigmailLocale.getString(&quot;msgSigned&quot;),</span>
<a href="#l15.486"></a><span id="l15.486" class="difflineminus">-            ]) +</span>
<a href="#l15.487"></a><span id="l15.487" class="difflineminus">-            &quot;\n&quot; +</span>
<a href="#l15.488"></a><span id="l15.488" class="difflineminus">-            statusInfo;</span>
<a href="#l15.489"></a><span id="l15.489" class="difflineminus">-        }</span>
<a href="#l15.490"></a><span id="l15.490" class="difflineminus">-      }</span>
<a href="#l15.491"></a><span id="l15.491" class="difflineplus">+    if (statusFlags &amp; EnigmailConstants.PARTIALLY_PGP) {</span>
<a href="#l15.492"></a><span id="l15.492" class="difflineplus">+      statusInfo = &quot;&quot;;</span>
<a href="#l15.493"></a><span id="l15.493">     }</span>
<a href="#l15.494"></a><span id="l15.494"> </span>
<a href="#l15.495"></a><span id="l15.495" class="difflineminus">-    // if we have parsed ENC_TO entries, add them as status info</span>
<a href="#l15.496"></a><span id="l15.496" class="difflineminus">-    if (encToDetails &amp;&amp; encToDetails.length &gt; 0) {</span>
<a href="#l15.497"></a><span id="l15.497" class="difflineminus">-      statusInfo +=</span>
<a href="#l15.498"></a><span id="l15.498" class="difflineminus">-        &quot;\n\n&quot; + EnigmailLocale.getString(&quot;encryptKeysNote&quot;, [encToDetails]);</span>
<a href="#l15.499"></a><span id="l15.499" class="difflineminus">-    }</span>
<a href="#l15.500"></a><span id="l15.500" class="difflineplus">+    // TODO: if encToDetails.length then make it available in status</span>
<a href="#l15.501"></a><span id="l15.501" class="difflineplus">+    // EnigmailLocale.getString(&quot;encryptKeysNote&quot;, [encToDetails]);</span>
<a href="#l15.502"></a><span id="l15.502"> </span>
<a href="#l15.503"></a><span id="l15.503" class="difflineplus">+    /*</span>
<a href="#l15.504"></a><span id="l15.504">     if (xtraStatus === &quot;process-manually&quot;) {</span>
<a href="#l15.505"></a><span id="l15.505">       let buttonLabel = &quot;&quot;;</span>
<a href="#l15.506"></a><span id="l15.506">       if (statusFlags &amp; EnigmailConstants.UNVERIFIED_SIGNATURE) {</span>
<a href="#l15.507"></a><span id="l15.507">         statusLine = EnigmailLocale.getString(&quot;msgPart&quot;, [</span>
<a href="#l15.508"></a><span id="l15.508">           EnigmailLocale.getString(&quot;msgSigned&quot;),</span>
<a href="#l15.509"></a><span id="l15.509">         ]);</span>
<a href="#l15.510"></a><span id="l15.510">         statusLine += EnigmailLocale.getString(&quot;verifyManually&quot;);</span>
<a href="#l15.511"></a><span id="l15.511">         buttonLabel = EnigmailLocale.getString(&quot;headerView.button.verify&quot;);</span>
<a href="#l15.512"></a><span id="l15.512" class="difflineat">@@ -541,48 +439,47 @@ Enigmail.hdrView = {</span>
<a href="#l15.513"></a><span id="l15.513">         statusLine += EnigmailLocale.getString(&quot;decryptManually&quot;);</span>
<a href="#l15.514"></a><span id="l15.514">         buttonLabel = EnigmailLocale.getString(&quot;headerView.button.decrypt&quot;);</span>
<a href="#l15.515"></a><span id="l15.515">       }</span>
<a href="#l15.516"></a><span id="l15.516"> </span>
<a href="#l15.517"></a><span id="l15.517">       Enigmail.msg.securityInfo = {};</span>
<a href="#l15.518"></a><span id="l15.518">       this.displayFlexAction(statusLine, buttonLabel, xtraStatus);</span>
<a href="#l15.519"></a><span id="l15.519">       return;</span>
<a href="#l15.520"></a><span id="l15.520">     }</span>
<a href="#l15.521"></a><span id="l15.521" class="difflineplus">+    */</span>
<a href="#l15.522"></a><span id="l15.522"> </span>
<a href="#l15.523"></a><span id="l15.523" class="difflineminus">-    if (!statusLine) {</span>
<a href="#l15.524"></a><span id="l15.524" class="difflineminus">-      return;</span>
<a href="#l15.525"></a><span id="l15.525" class="difflineminus">-    }</span>
<a href="#l15.526"></a><span id="l15.526" class="difflineminus">-</span>
<a href="#l15.527"></a><span id="l15.527" class="difflineminus">-    Enigmail.msg.securityInfo = {</span>
<a href="#l15.528"></a><span id="l15.528" class="difflineplus">+    let tmp = {</span>
<a href="#l15.529"></a><span id="l15.529">       statusFlags,</span>
<a href="#l15.530"></a><span id="l15.530">       keyId,</span>
<a href="#l15.531"></a><span id="l15.531">       userId,</span>
<a href="#l15.532"></a><span id="l15.532" class="difflineminus">-      statusLine,</span>
<a href="#l15.533"></a><span id="l15.533">       msgSigned,</span>
<a href="#l15.534"></a><span id="l15.534" class="difflineminus">-      statusArr,</span>
<a href="#l15.535"></a><span id="l15.535">       statusInfo,</span>
<a href="#l15.536"></a><span id="l15.536">       fullStatusInfo,</span>
<a href="#l15.537"></a><span id="l15.537">       blockSeparation,</span>
<a href="#l15.538"></a><span id="l15.538">       xtraStatus,</span>
<a href="#l15.539"></a><span id="l15.539">       encryptedMimePart: encMimePartNumber,</span>
<a href="#l15.540"></a><span id="l15.540">     };</span>
<a href="#l15.541"></a><span id="l15.541" class="difflineplus">+    Enigmail.msg.securityInfo = tmp;</span>
<a href="#l15.542"></a><span id="l15.542"> </span>
<a href="#l15.543"></a><span id="l15.543" class="difflineminus">-    Enigmail.msg.createArtificialAutocryptHeader();</span>
<a href="#l15.544"></a><span id="l15.544" class="difflineplus">+    //Enigmail.msg.createArtificialAutocryptHeader();</span>
<a href="#l15.545"></a><span id="l15.545"> </span>
<a href="#l15.546"></a><span id="l15.546" class="difflineplus">+    /*</span>
<a href="#l15.547"></a><span id="l15.547">     if (statusFlags &amp; EnigmailConstants.UNVERIFIED_SIGNATURE) {</span>
<a href="#l15.548"></a><span id="l15.548">       this.tryImportAutocryptHeader();</span>
<a href="#l15.549"></a><span id="l15.549">     }</span>
<a href="#l15.550"></a><span id="l15.550" class="difflineplus">+    */</span>
<a href="#l15.551"></a><span id="l15.551"> </span>
<a href="#l15.552"></a><span id="l15.552">     this.displayStatusBar();</span>
<a href="#l15.553"></a><span id="l15.553">     this.updateMsgDb();</span>
<a href="#l15.554"></a><span id="l15.554">   },</span>
<a href="#l15.555"></a><span id="l15.555"> </span>
<a href="#l15.556"></a><span id="l15.556">   /**</span>
<a href="#l15.557"></a><span id="l15.557">    * Check whether we got a WKS request</span>
<a href="#l15.558"></a><span id="l15.558">    */</span>
<a href="#l15.559"></a><span id="l15.559" class="difflineplus">+  /*</span>
<a href="#l15.560"></a><span id="l15.560">   checkWksConfirmRequest(jsonStr) {</span>
<a href="#l15.561"></a><span id="l15.561">     let requestObj;</span>
<a href="#l15.562"></a><span id="l15.562">     try {</span>
<a href="#l15.563"></a><span id="l15.563">       requestObj = JSON.parse(jsonStr);</span>
<a href="#l15.564"></a><span id="l15.564">     } catch (ex) {</span>
<a href="#l15.565"></a><span id="l15.565">       EnigmailLog.DEBUG(</span>
<a href="#l15.566"></a><span id="l15.566">         &quot;enigmailMsgHdrViewOverlay.js: checkWksConfirmRequest parsing JSON failed\n&quot;</span>
<a href="#l15.567"></a><span id="l15.567">       );</span>
<a href="#l15.568"></a><span id="l15.568" class="difflineat">@@ -606,16 +503,17 @@ Enigmail.hdrView = {</span>
<a href="#l15.569"></a><span id="l15.569">         Enigmail.hdrView.displayWksMessage();</span>
<a href="#l15.570"></a><span id="l15.570">       });</span>
<a href="#l15.571"></a><span id="l15.571">     } else {</span>
<a href="#l15.572"></a><span id="l15.572">       EnigmailLog.DEBUG(</span>
<a href="#l15.573"></a><span id="l15.573">         &quot;enigmailMsgHdrViewOverlay.js: checkWksConfirmRequest failed condition\n&quot;</span>
<a href="#l15.574"></a><span id="l15.574">       );</span>
<a href="#l15.575"></a><span id="l15.575">     }</span>
<a href="#l15.576"></a><span id="l15.576">   },</span>
<a href="#l15.577"></a><span id="l15.577" class="difflineplus">+  */</span>
<a href="#l15.578"></a><span id="l15.578"> </span>
<a href="#l15.579"></a><span id="l15.579">   /**</span>
<a href="#l15.580"></a><span id="l15.580">    * Display Enigmail header with text and specific button</span>
<a href="#l15.581"></a><span id="l15.581">    *</span>
<a href="#l15.582"></a><span id="l15.582">    * @param {String} hdrMessage: Message to be displayed in header</span>
<a href="#l15.583"></a><span id="l15.583">    * @param {String} buttonLabel: Label of button</span>
<a href="#l15.584"></a><span id="l15.584">    * @param {String} requestType: action to be performed</span>
<a href="#l15.585"></a><span id="l15.585">    */</span>
<a href="#l15.586"></a><span id="l15.586" class="difflineat">@@ -623,51 +521,57 @@ Enigmail.hdrView = {</span>
<a href="#l15.587"></a><span id="l15.587">     if (!Enigmail.msg.securityInfo) {</span>
<a href="#l15.588"></a><span id="l15.588">       Enigmail.msg.securityInfo = {};</span>
<a href="#l15.589"></a><span id="l15.589">     }</span>
<a href="#l15.590"></a><span id="l15.590">     Enigmail.msg.securityInfo.xtraStatus = requestType;</span>
<a href="#l15.591"></a><span id="l15.591">     Enigmail.msg.securityInfo.statusInfo = hdrMessage;</span>
<a href="#l15.592"></a><span id="l15.592"> </span>
<a href="#l15.593"></a><span id="l15.593">     // Thunderbird</span>
<a href="#l15.594"></a><span id="l15.594">     this.setStatusText(hdrMessage);</span>
<a href="#l15.595"></a><span id="l15.595" class="difflineminus">-    this.enigmailBox.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l15.596"></a><span id="l15.596" class="difflineminus">-    let button = document.getElementById(&quot;enigmail_flexActionButton&quot;);</span>
<a href="#l15.597"></a><span id="l15.597" class="difflineminus">-    button.setAttribute(&quot;label&quot;, buttonLabel);</span>
<a href="#l15.598"></a><span id="l15.598" class="difflineminus">-    button.removeAttribute(&quot;hidden&quot;);</span>
<a href="#l15.599"></a><span id="l15.599" class="difflineplus">+    //this.enigmailBox.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l15.600"></a><span id="l15.600" class="difflineplus">+    //let button = document.getElementById(&quot;enigmail_flexActionButton&quot;);</span>
<a href="#l15.601"></a><span id="l15.601" class="difflineplus">+    //button.setAttribute(&quot;label&quot;, buttonLabel);</span>
<a href="#l15.602"></a><span id="l15.602" class="difflineplus">+    //button.removeAttribute(&quot;hidden&quot;);</span>
<a href="#l15.603"></a><span id="l15.603" class="difflineplus">+    /*</span>
<a href="#l15.604"></a><span id="l15.604">     document</span>
<a href="#l15.605"></a><span id="l15.605">       .getElementById(&quot;enigmail_importKey&quot;)</span>
<a href="#l15.606"></a><span id="l15.606">       .setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l15.607"></a><span id="l15.607" class="difflineminus">-</span>
<a href="#l15.608"></a><span id="l15.608" class="difflineplus">+    */</span>
<a href="#l15.609"></a><span id="l15.609" class="difflineplus">+    /*</span>
<a href="#l15.610"></a><span id="l15.610">     this.enigmailBox.setAttribute(</span>
<a href="#l15.611"></a><span id="l15.611">       &quot;class&quot;,</span>
<a href="#l15.612"></a><span id="l15.612">       &quot;expandedEnigmailBox enigmailHeaderBoxLabelSignatureUnknown&quot;</span>
<a href="#l15.613"></a><span id="l15.613">     );</span>
<a href="#l15.614"></a><span id="l15.614" class="difflineplus">+    */</span>
<a href="#l15.615"></a><span id="l15.615">   },</span>
<a href="#l15.616"></a><span id="l15.616"> </span>
<a href="#l15.617"></a><span id="l15.617">   /**</span>
<a href="#l15.618"></a><span id="l15.618">    * Display a localized message in lieu of the original message text</span>
<a href="#l15.619"></a><span id="l15.619">    */</span>
<a href="#l15.620"></a><span id="l15.620" class="difflineplus">+  /*</span>
<a href="#l15.621"></a><span id="l15.621">   displayWksMessage() {</span>
<a href="#l15.622"></a><span id="l15.622">     EnigmailLog.DEBUG(&quot;enigmailMsgHdrViewOverlay.js: displayWksMessage()\n&quot;);</span>
<a href="#l15.623"></a><span id="l15.623"> </span>
<a href="#l15.624"></a><span id="l15.624">     if (Enigmail.msg.securityInfo.xtraStatus === &quot;wks-request&quot;) {</span>
<a href="#l15.625"></a><span id="l15.625">       let enigMsgPane = document.getElementById(&quot;enigmailMsgDisplay&quot;);</span>
<a href="#l15.626"></a><span id="l15.626">       let bodyElement = document.getElementById(&quot;messagepane&quot;);</span>
<a href="#l15.627"></a><span id="l15.627">       bodyElement.setAttribute(&quot;collapsed&quot;, true);</span>
<a href="#l15.628"></a><span id="l15.628">       enigMsgPane.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l15.629"></a><span id="l15.629">       enigMsgPane.textContent = EnigmailLocale.getString(</span>
<a href="#l15.630"></a><span id="l15.630">         &quot;wksConfirmationReq.message&quot;</span>
<a href="#l15.631"></a><span id="l15.631">       );</span>
<a href="#l15.632"></a><span id="l15.632">     }</span>
<a href="#l15.633"></a><span id="l15.633">   },</span>
<a href="#l15.634"></a><span id="l15.634" class="difflineplus">+  */</span>
<a href="#l15.635"></a><span id="l15.635"> </span>
<a href="#l15.636"></a><span id="l15.636">   /**</span>
<a href="#l15.637"></a><span id="l15.637">    * Try to import an autocrypt header from an unverified signature</span>
<a href="#l15.638"></a><span id="l15.638">    * (i.e. the sender's key is not available)</span>
<a href="#l15.639"></a><span id="l15.639">    */</span>
<a href="#l15.640"></a><span id="l15.640" class="difflineplus">+  /*</span>
<a href="#l15.641"></a><span id="l15.641">   tryImportAutocryptHeader() {</span>
<a href="#l15.642"></a><span id="l15.642">     EnigmailLog.DEBUG(</span>
<a href="#l15.643"></a><span id="l15.643">       &quot;enigmailMsgHdrViewOverlay.js: tryImportAutocryptHeader()\n&quot;</span>
<a href="#l15.644"></a><span id="l15.644">     );</span>
<a href="#l15.645"></a><span id="l15.645"> </span>
<a href="#l15.646"></a><span id="l15.646">     if (!(&quot;autocrypt&quot; in currentHeaderData)) {</span>
<a href="#l15.647"></a><span id="l15.647">       return;</span>
<a href="#l15.648"></a><span id="l15.648">     }</span>
<a href="#l15.649"></a><span id="l15.649" class="difflineat">@@ -678,17 +582,19 @@ Enigmail.hdrView = {</span>
<a href="#l15.650"></a><span id="l15.650">       return;</span>
<a href="#l15.651"></a><span id="l15.651">     }</span>
<a href="#l15.652"></a><span id="l15.652"> </span>
<a href="#l15.653"></a><span id="l15.653">     let fromEmail = &quot;&quot;;</span>
<a href="#l15.654"></a><span id="l15.654">     try {</span>
<a href="#l15.655"></a><span id="l15.655">       fromEmail = EnigmailFuncs.stripEmail(</span>
<a href="#l15.656"></a><span id="l15.656">         currentHeaderData.from.headerValue</span>
<a href="#l15.657"></a><span id="l15.657">       ).toLowerCase();</span>
<a href="#l15.658"></a><span id="l15.658" class="difflineminus">-    } catch (ex) {}</span>
<a href="#l15.659"></a><span id="l15.659" class="difflineplus">+    } catch (ex) {</span>
<a href="#l15.660"></a><span id="l15.660" class="difflineplus">+      console.debug(ex);</span>
<a href="#l15.661"></a><span id="l15.661" class="difflineplus">+    }</span>
<a href="#l15.662"></a><span id="l15.662"> </span>
<a href="#l15.663"></a><span id="l15.663">     let keys = EnigmailKeyRing.getKeysByUserId(fromEmail, true);</span>
<a href="#l15.664"></a><span id="l15.664">     if (keys.length &gt; 0) {</span>
<a href="#l15.665"></a><span id="l15.665">       return;</span>
<a href="#l15.666"></a><span id="l15.666">     }</span>
<a href="#l15.667"></a><span id="l15.667"> </span>
<a href="#l15.668"></a><span id="l15.668">     EnigmailAutocrypt.importAutocryptKeys([fromEmail]).then(foundKeys =&gt; {</span>
<a href="#l15.669"></a><span id="l15.669">       EnigmailLog.DEBUG(</span>
<a href="#l15.670"></a><span id="l15.670" class="difflineat">@@ -699,79 +605,71 @@ Enigmail.hdrView = {</span>
<a href="#l15.671"></a><span id="l15.671">       if (foundKeys.length &gt; 0) {</span>
<a href="#l15.672"></a><span id="l15.672">         let k = EnigmailKeyRing.getKeyById(Enigmail.msg.securityInfo.keyId);</span>
<a href="#l15.673"></a><span id="l15.673">         if (k) {</span>
<a href="#l15.674"></a><span id="l15.674">           gDBView.reloadMessageWithAllParts();</span>
<a href="#l15.675"></a><span id="l15.675">         }</span>
<a href="#l15.676"></a><span id="l15.676">       }</span>
<a href="#l15.677"></a><span id="l15.677">     });</span>
<a href="#l15.678"></a><span id="l15.678">   },</span>
<a href="#l15.679"></a><span id="l15.679" class="difflineplus">+  */</span>
<a href="#l15.680"></a><span id="l15.680"> </span>
<a href="#l15.681"></a><span id="l15.681">   /**</span>
<a href="#l15.682"></a><span id="l15.682">    * Display the Enigmail status bar and ask for handling the Setup Message</span>
<a href="#l15.683"></a><span id="l15.683">    */</span>
<a href="#l15.684"></a><span id="l15.684" class="difflineplus">+  /*</span>
<a href="#l15.685"></a><span id="l15.685">   displayAutoCryptSetupMsgHeader() {</span>
<a href="#l15.686"></a><span id="l15.686">     Enigmail.hdrView.displayFlexAction(</span>
<a href="#l15.687"></a><span id="l15.687">       EnigmailLocale.getString(&quot;autocryptSetupReq&quot;),</span>
<a href="#l15.688"></a><span id="l15.688">       EnigmailLocale.getString(&quot;autocryptSetupReq.button.label&quot;),</span>
<a href="#l15.689"></a><span id="l15.689">       &quot;autocrypt-setup&quot;</span>
<a href="#l15.690"></a><span id="l15.690">     );</span>
<a href="#l15.691"></a><span id="l15.691">     //view.enigmailBox.setAttribute(&quot;class&quot;, &quot;expandedEnigmailBox enigmailHeaderBoxLabelSignatureUnknown&quot;);</span>
<a href="#l15.692"></a><span id="l15.692">     this.displayAutocryptMessage(true);</span>
<a href="#l15.693"></a><span id="l15.693">   },</span>
<a href="#l15.694"></a><span id="l15.694"> </span>
<a href="#l15.695"></a><span id="l15.695">   displayAutocryptMessage(allowImport) {</span>
<a href="#l15.696"></a><span id="l15.696">     EnigmailLog.DEBUG(</span>
<a href="#l15.697"></a><span id="l15.697">       &quot;enigmailMsgHdrViewOverlay.js: displayAutocryptMessage()\n&quot;</span>
<a href="#l15.698"></a><span id="l15.698">     );</span>
<a href="#l15.699"></a><span id="l15.699">   },</span>
<a href="#l15.700"></a><span id="l15.700" class="difflineplus">+  */</span>
<a href="#l15.701"></a><span id="l15.701"> </span>
<a href="#l15.702"></a><span id="l15.702">   displayStatusBar() {</span>
<a href="#l15.703"></a><span id="l15.703">     //let statusText = document.getElementById(&quot;enigmailStatusText&quot;);</span>
<a href="#l15.704"></a><span id="l15.704" class="difflineminus">-    let expStatusText = document.getElementById(&quot;expandedEnigmailStatusText&quot;);</span>
<a href="#l15.705"></a><span id="l15.705" class="difflineminus">-    let icon = document.getElementById(&quot;enigToggleHeaderView2&quot;);</span>
<a href="#l15.706"></a><span id="l15.706" class="difflineplus">+    //let icon = document.getElementById(&quot;enigToggleHeaderView2&quot;);</span>
<a href="#l15.707"></a><span id="l15.707">     let bodyElement = document.getElementById(&quot;messagepanebox&quot;);</span>
<a href="#l15.708"></a><span id="l15.708"> </span>
<a href="#l15.709"></a><span id="l15.709">     let secInfo = Enigmail.msg.securityInfo;</span>
<a href="#l15.710"></a><span id="l15.710">     let statusFlags = secInfo.statusFlags;</span>
<a href="#l15.711"></a><span id="l15.711">     let sMimeContainer, encryptedUINode, signedUINode;</span>
<a href="#l15.712"></a><span id="l15.712"> </span>
<a href="#l15.713"></a><span id="l15.713" class="difflineminus">-    if (secInfo.statusArr.length &gt; 0) {</span>
<a href="#l15.714"></a><span id="l15.714" class="difflineminus">-      expStatusText.value = secInfo.statusArr[0];</span>
<a href="#l15.715"></a><span id="l15.715" class="difflineminus">-      expStatusText.setAttribute(&quot;state&quot;, &quot;true&quot;);</span>
<a href="#l15.716"></a><span id="l15.716" class="difflineminus">-      icon.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l15.717"></a><span id="l15.717" class="difflineminus">-    } else {</span>
<a href="#l15.718"></a><span id="l15.718" class="difflineminus">-      expStatusText.value = &quot;&quot;;</span>
<a href="#l15.719"></a><span id="l15.719" class="difflineminus">-      expStatusText.setAttribute(&quot;state&quot;, &quot;false&quot;);</span>
<a href="#l15.720"></a><span id="l15.720" class="difflineminus">-      icon.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l15.721"></a><span id="l15.721" class="difflineminus">-    }</span>
<a href="#l15.722"></a><span id="l15.722" class="difflineplus">+    if (secInfo.statusInfo) {</span>
<a href="#l15.723"></a><span id="l15.723" class="difflineplus">+      this.setStatusText(secInfo.statusInfo + &quot; &quot;);</span>
<a href="#l15.724"></a><span id="l15.724" class="difflineplus">+      //this.enigmailBox.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l15.725"></a><span id="l15.725"> </span>
<a href="#l15.726"></a><span id="l15.726" class="difflineminus">-    if (secInfo.statusLine) {</span>
<a href="#l15.727"></a><span id="l15.727" class="difflineminus">-      this.setStatusText(secInfo.statusLine + &quot; &quot;);</span>
<a href="#l15.728"></a><span id="l15.728" class="difflineminus">-      this.enigmailBox.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l15.729"></a><span id="l15.729" class="difflineminus">-      this.displayExtendedStatus(true);</span>
<a href="#l15.730"></a><span id="l15.730" class="difflineminus">-</span>
<a href="#l15.731"></a><span id="l15.731" class="difflineplus">+      /*</span>
<a href="#l15.732"></a><span id="l15.732">       if (</span>
<a href="#l15.733"></a><span id="l15.733">         (secInfo.keyId &amp;&amp;</span>
<a href="#l15.734"></a><span id="l15.734">           statusFlags &amp; EnigmailConstants.UNVERIFIED_SIGNATURE) ||</span>
<a href="#l15.735"></a><span id="l15.735">         statusFlags &amp; EnigmailConstants.INLINE_KEY</span>
<a href="#l15.736"></a><span id="l15.736">       ) {</span>
<a href="#l15.737"></a><span id="l15.737">         document.getElementById(&quot;enigmail_importKey&quot;).removeAttribute(&quot;hidden&quot;);</span>
<a href="#l15.738"></a><span id="l15.738">       } else {</span>
<a href="#l15.739"></a><span id="l15.739">         document</span>
<a href="#l15.740"></a><span id="l15.740">           .getElementById(&quot;enigmail_importKey&quot;)</span>
<a href="#l15.741"></a><span id="l15.741">           .setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l15.742"></a><span id="l15.742">       }</span>
<a href="#l15.743"></a><span id="l15.743">       document</span>
<a href="#l15.744"></a><span id="l15.744">         .getElementById(&quot;enigmail_flexActionButton&quot;)</span>
<a href="#l15.745"></a><span id="l15.745">         .setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l15.746"></a><span id="l15.746" class="difflineplus">+      */</span>
<a href="#l15.747"></a><span id="l15.747">     } else {</span>
<a href="#l15.748"></a><span id="l15.748">       this.setStatusText(&quot;&quot;);</span>
<a href="#l15.749"></a><span id="l15.749" class="difflineminus">-      this.enigmailBox.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l15.750"></a><span id="l15.750" class="difflineminus">-      this.displayExtendedStatus(false);</span>
<a href="#l15.751"></a><span id="l15.751" class="difflineplus">+      //this.enigmailBox.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l15.752"></a><span id="l15.752">     }</span>
<a href="#l15.753"></a><span id="l15.753"> </span>
<a href="#l15.754"></a><span id="l15.754">     sMimeContainer = gSMIMEContainer;</span>
<a href="#l15.755"></a><span id="l15.755">     signedUINode = gSignedUINode;</span>
<a href="#l15.756"></a><span id="l15.756">     encryptedUINode = gEncryptedUINode;</span>
<a href="#l15.757"></a><span id="l15.757"> </span>
<a href="#l15.758"></a><span id="l15.758">     /* eslint block-scoped-var: 0*/</span>
<a href="#l15.759"></a><span id="l15.759">     if (typeof sMimeContainer !== &quot;object&quot;) {</span>
<a href="#l15.760"></a><span id="l15.760" class="difflineat">@@ -787,100 +685,119 @@ Enigmail.hdrView = {</span>
<a href="#l15.761"></a><span id="l15.761">       signedUINode.collapsed = false;</span>
<a href="#l15.762"></a><span id="l15.762">       encryptedUINode.collapsed = false;</span>
<a href="#l15.763"></a><span id="l15.763"> </span>
<a href="#l15.764"></a><span id="l15.764">       if (</span>
<a href="#l15.765"></a><span id="l15.765">         statusFlags &amp; EnigmailConstants.BAD_SIGNATURE &amp;&amp;</span>
<a href="#l15.766"></a><span id="l15.766">         !(statusFlags &amp; EnigmailConstants.GOOD_SIGNATURE)</span>
<a href="#l15.767"></a><span id="l15.767">       ) {</span>
<a href="#l15.768"></a><span id="l15.768">         // Display untrusted/bad signature icon</span>
<a href="#l15.769"></a><span id="l15.769" class="difflineminus">-        signedUINode.setAttribute(&quot;signed&quot;, &quot;unknown&quot;);</span>
<a href="#l15.770"></a><span id="l15.770" class="difflineplus">+        signedUINode.setAttribute(&quot;signed&quot;, &quot;notok&quot;);</span>
<a href="#l15.771"></a><span id="l15.771" class="difflineplus">+        /*</span>
<a href="#l15.772"></a><span id="l15.772">         this.enigmailBox.setAttribute(</span>
<a href="#l15.773"></a><span id="l15.773">           &quot;class&quot;,</span>
<a href="#l15.774"></a><span id="l15.774">           &quot;expandedEnigmailBox enigmailHeaderBoxLabelSignatureUnknown&quot;</span>
<a href="#l15.775"></a><span id="l15.775">         );</span>
<a href="#l15.776"></a><span id="l15.776" class="difflineminus">-        this.statusBar.setAttribute(&quot;signed&quot;, &quot;unknown&quot;);</span>
<a href="#l15.777"></a><span id="l15.777" class="difflineplus">+        */</span>
<a href="#l15.778"></a><span id="l15.778" class="difflineplus">+        this.isSigned = &quot;notok&quot;;</span>
<a href="#l15.779"></a><span id="l15.779">       } else if (</span>
<a href="#l15.780"></a><span id="l15.780">         statusFlags &amp; EnigmailConstants.GOOD_SIGNATURE &amp;&amp;</span>
<a href="#l15.781"></a><span id="l15.781" class="difflineminus">-        statusFlags &amp; EnigmailConstants.TRUSTED_IDENTITY &amp;&amp;</span>
<a href="#l15.782"></a><span id="l15.782">         !(</span>
<a href="#l15.783"></a><span id="l15.783">           statusFlags &amp;</span>
<a href="#l15.784"></a><span id="l15.784">           (EnigmailConstants.REVOKED_KEY |</span>
<a href="#l15.785"></a><span id="l15.785">             EnigmailConstants.EXPIRED_KEY_SIGNATURE |</span>
<a href="#l15.786"></a><span id="l15.786">             EnigmailConstants.EXPIRED_SIGNATURE)</span>
<a href="#l15.787"></a><span id="l15.787">         )</span>
<a href="#l15.788"></a><span id="l15.788">       ) {</span>
<a href="#l15.789"></a><span id="l15.789" class="difflineplus">+        let val =</span>
<a href="#l15.790"></a><span id="l15.790" class="difflineplus">+          statusFlags &amp; EnigmailConstants.TRUSTED_IDENTITY</span>
<a href="#l15.791"></a><span id="l15.791" class="difflineplus">+            ? &quot;verified&quot;</span>
<a href="#l15.792"></a><span id="l15.792" class="difflineplus">+            : &quot;unverified&quot;;</span>
<a href="#l15.793"></a><span id="l15.793" class="difflineplus">+</span>
<a href="#l15.794"></a><span id="l15.794">         // Display trusted good signature icon</span>
<a href="#l15.795"></a><span id="l15.795" class="difflineminus">-        signedUINode.setAttribute(&quot;signed&quot;, &quot;ok&quot;);</span>
<a href="#l15.796"></a><span id="l15.796" class="difflineplus">+        signedUINode.setAttribute(&quot;signed&quot;, val);</span>
<a href="#l15.797"></a><span id="l15.797" class="difflineplus">+        /*</span>
<a href="#l15.798"></a><span id="l15.798">         this.enigmailBox.setAttribute(</span>
<a href="#l15.799"></a><span id="l15.799">           &quot;class&quot;,</span>
<a href="#l15.800"></a><span id="l15.800">           &quot;expandedEnigmailBox enigmailHeaderBoxLabelSignatureOk&quot;</span>
<a href="#l15.801"></a><span id="l15.801">         );</span>
<a href="#l15.802"></a><span id="l15.802" class="difflineminus">-        this.statusBar.setAttribute(&quot;signed&quot;, &quot;ok&quot;);</span>
<a href="#l15.803"></a><span id="l15.803" class="difflineminus">-        bodyElement.setAttribute(&quot;enigSigned&quot;, &quot;ok&quot;);</span>
<a href="#l15.804"></a><span id="l15.804" class="difflineplus">+        */</span>
<a href="#l15.805"></a><span id="l15.805" class="difflineplus">+        this.isSigned = val;</span>
<a href="#l15.806"></a><span id="l15.806" class="difflineplus">+        bodyElement.setAttribute(&quot;enigSigned&quot;, val);</span>
<a href="#l15.807"></a><span id="l15.807">       } else if (statusFlags &amp; EnigmailConstants.UNVERIFIED_SIGNATURE) {</span>
<a href="#l15.808"></a><span id="l15.808">         // Display unverified signature icon</span>
<a href="#l15.809"></a><span id="l15.809">         signedUINode.setAttribute(&quot;signed&quot;, &quot;unknown&quot;);</span>
<a href="#l15.810"></a><span id="l15.810" class="difflineplus">+        /*</span>
<a href="#l15.811"></a><span id="l15.811">         this.enigmailBox.setAttribute(</span>
<a href="#l15.812"></a><span id="l15.812">           &quot;class&quot;,</span>
<a href="#l15.813"></a><span id="l15.813">           &quot;expandedEnigmailBox enigmailHeaderBoxLabelSignatureUnknown&quot;</span>
<a href="#l15.814"></a><span id="l15.814">         );</span>
<a href="#l15.815"></a><span id="l15.815" class="difflineminus">-        this.statusBar.setAttribute(&quot;signed&quot;, &quot;unknown&quot;);</span>
<a href="#l15.816"></a><span id="l15.816" class="difflineplus">+        */</span>
<a href="#l15.817"></a><span id="l15.817" class="difflineplus">+        this.isSigned = &quot;unknown&quot;;</span>
<a href="#l15.818"></a><span id="l15.818">       } else if (</span>
<a href="#l15.819"></a><span id="l15.819">         statusFlags &amp;</span>
<a href="#l15.820"></a><span id="l15.820">         (EnigmailConstants.REVOKED_KEY |</span>
<a href="#l15.821"></a><span id="l15.821">           EnigmailConstants.EXPIRED_KEY_SIGNATURE |</span>
<a href="#l15.822"></a><span id="l15.822" class="difflineminus">-          EnigmailConstants.EXPIRED_SIGNATURE |</span>
<a href="#l15.823"></a><span id="l15.823" class="difflineminus">-          EnigmailConstants.GOOD_SIGNATURE)</span>
<a href="#l15.824"></a><span id="l15.824" class="difflineplus">+          EnigmailConstants.EXPIRED_SIGNATURE)</span>
<a href="#l15.825"></a><span id="l15.825">       ) {</span>
<a href="#l15.826"></a><span id="l15.826">         // Display unverified signature icon</span>
<a href="#l15.827"></a><span id="l15.827" class="difflineminus">-        signedUINode.setAttribute(&quot;signed&quot;, &quot;unknown&quot;);</span>
<a href="#l15.828"></a><span id="l15.828" class="difflineplus">+        signedUINode.setAttribute(&quot;signed&quot;, &quot;notok&quot;);</span>
<a href="#l15.829"></a><span id="l15.829" class="difflineplus">+        /*</span>
<a href="#l15.830"></a><span id="l15.830">         this.enigmailBox.setAttribute(</span>
<a href="#l15.831"></a><span id="l15.831">           &quot;class&quot;,</span>
<a href="#l15.832"></a><span id="l15.832">           &quot;expandedEnigmailBox enigmailHeaderBoxLabelSignatureVerified&quot;</span>
<a href="#l15.833"></a><span id="l15.833">         );</span>
<a href="#l15.834"></a><span id="l15.834" class="difflineminus">-        this.statusBar.setAttribute(&quot;signed&quot;, &quot;unknown&quot;);</span>
<a href="#l15.835"></a><span id="l15.835" class="difflineplus">+        */</span>
<a href="#l15.836"></a><span id="l15.836" class="difflineplus">+        this.isSigned = &quot;notok&quot;;</span>
<a href="#l15.837"></a><span id="l15.837">       } else if (statusFlags &amp; EnigmailConstants.INLINE_KEY) {</span>
<a href="#l15.838"></a><span id="l15.838" class="difflineplus">+        /*</span>
<a href="#l15.839"></a><span id="l15.839">         this.enigmailBox.setAttribute(</span>
<a href="#l15.840"></a><span id="l15.840">           &quot;class&quot;,</span>
<a href="#l15.841"></a><span id="l15.841">           &quot;expandedEnigmailBox enigmailHeaderBoxLabelSignatureUnknown&quot;</span>
<a href="#l15.842"></a><span id="l15.842">         );</span>
<a href="#l15.843"></a><span id="l15.843" class="difflineplus">+        */</span>
<a href="#l15.844"></a><span id="l15.844">       } else {</span>
<a href="#l15.845"></a><span id="l15.845" class="difflineplus">+        /*</span>
<a href="#l15.846"></a><span id="l15.846">         this.enigmailBox.setAttribute(</span>
<a href="#l15.847"></a><span id="l15.847">           &quot;class&quot;,</span>
<a href="#l15.848"></a><span id="l15.848">           &quot;expandedEnigmailBox enigmailHeaderBoxLabelNoSignature&quot;</span>
<a href="#l15.849"></a><span id="l15.849">         );</span>
<a href="#l15.850"></a><span id="l15.850" class="difflineplus">+        */</span>
<a href="#l15.851"></a><span id="l15.851">       }</span>
<a href="#l15.852"></a><span id="l15.852"> </span>
<a href="#l15.853"></a><span id="l15.853">       if (statusFlags &amp; EnigmailConstants.DECRYPTION_OKAY) {</span>
<a href="#l15.854"></a><span id="l15.854">         EnigmailURIs.rememberEncryptedUri(this.lastEncryptedMsgKey);</span>
<a href="#l15.855"></a><span id="l15.855"> </span>
<a href="#l15.856"></a><span id="l15.856">         // Display encrypted icon</span>
<a href="#l15.857"></a><span id="l15.857">         encryptedUINode.setAttribute(&quot;encrypted&quot;, &quot;ok&quot;);</span>
<a href="#l15.858"></a><span id="l15.858" class="difflineminus">-        this.statusBar.setAttribute(&quot;encrypted&quot;, &quot;ok&quot;);</span>
<a href="#l15.859"></a><span id="l15.859" class="difflineplus">+        this.isEncrypted = &quot;ok&quot;;</span>
<a href="#l15.860"></a><span id="l15.860">       } else if (</span>
<a href="#l15.861"></a><span id="l15.861">         statusFlags &amp;</span>
<a href="#l15.862"></a><span id="l15.862">         (EnigmailConstants.DECRYPTION_INCOMPLETE |</span>
<a href="#l15.863"></a><span id="l15.863">           EnigmailConstants.DECRYPTION_FAILED)</span>
<a href="#l15.864"></a><span id="l15.864">       ) {</span>
<a href="#l15.865"></a><span id="l15.865">         // Display un-encrypted icon</span>
<a href="#l15.866"></a><span id="l15.866">         encryptedUINode.setAttribute(&quot;encrypted&quot;, &quot;notok&quot;);</span>
<a href="#l15.867"></a><span id="l15.867" class="difflineminus">-        this.statusBar.setAttribute(&quot;encrypted&quot;, &quot;notok&quot;);</span>
<a href="#l15.868"></a><span id="l15.868" class="difflineplus">+        this.isEncrypted = &quot;notok&quot;;</span>
<a href="#l15.869"></a><span id="l15.869" class="difflineplus">+        /*</span>
<a href="#l15.870"></a><span id="l15.870">         this.enigmailBox.setAttribute(</span>
<a href="#l15.871"></a><span id="l15.871">           &quot;class&quot;,</span>
<a href="#l15.872"></a><span id="l15.872">           &quot;expandedEnigmailBox enigmailHeaderBoxLabelSignatureNotOk&quot;</span>
<a href="#l15.873"></a><span id="l15.873">         );</span>
<a href="#l15.874"></a><span id="l15.874" class="difflineplus">+        */</span>
<a href="#l15.875"></a><span id="l15.875">       }</span>
<a href="#l15.876"></a><span id="l15.876"> </span>
<a href="#l15.877"></a><span id="l15.877">       // special handling after trying to fix buggy mail format (see buggyExchangeEmailContent in code)</span>
<a href="#l15.878"></a><span id="l15.878">       if (secInfo.xtraStatus &amp;&amp; secInfo.xtraStatus == &quot;buggyMailFormat&quot;) {</span>
<a href="#l15.879"></a><span id="l15.879" class="difflineplus">+        /*</span>
<a href="#l15.880"></a><span id="l15.880">         this.enigmailBox.setAttribute(</span>
<a href="#l15.881"></a><span id="l15.881">           &quot;class&quot;,</span>
<a href="#l15.882"></a><span id="l15.882">           &quot;expandedEnigmailBox enigmailHeaderBoxLabelBuggyMailFormat&quot;</span>
<a href="#l15.883"></a><span id="l15.883">         );</span>
<a href="#l15.884"></a><span id="l15.884" class="difflineplus">+        */</span>
<a href="#l15.885"></a><span id="l15.885">       }</span>
<a href="#l15.886"></a><span id="l15.886">     } catch (ex) {</span>
<a href="#l15.887"></a><span id="l15.887">       EnigmailLog.writeException(&quot;displayStatusBar&quot;, ex);</span>
<a href="#l15.888"></a><span id="l15.888">     }</span>
<a href="#l15.889"></a><span id="l15.889">   },</span>
<a href="#l15.890"></a><span id="l15.890"> </span>
<a href="#l15.891"></a><span id="l15.891">   dispSecurityContext() {</span>
<a href="#l15.892"></a><span id="l15.892">     try {</span>
<a href="#l15.893"></a><span id="l15.893" class="difflineat">@@ -1036,70 +953,71 @@ Enigmail.hdrView = {</span>
<a href="#l15.894"></a><span id="l15.894">     );</span>
<a href="#l15.895"></a><span id="l15.895">     gDBView.reloadMessageWithAllParts();</span>
<a href="#l15.896"></a><span id="l15.896">   },</span>
<a href="#l15.897"></a><span id="l15.897"> </span>
<a href="#l15.898"></a><span id="l15.898">   msgHdrViewLoad() {</span>
<a href="#l15.899"></a><span id="l15.899">     EnigmailLog.DEBUG(&quot;enigmailMsgHdrViewOverlay.js: this.msgHdrViewLoad\n&quot;);</span>
<a href="#l15.900"></a><span id="l15.900"> </span>
<a href="#l15.901"></a><span id="l15.901">     this.messageListener = {</span>
<a href="#l15.902"></a><span id="l15.902" class="difflineminus">-      enigmailBox: document.getElementById(&quot;enigmailBox&quot;),</span>
<a href="#l15.903"></a><span id="l15.903" class="difflineplus">+      //enigmailBox: document.getElementById(&quot;enigmailBox&quot;),</span>
<a href="#l15.904"></a><span id="l15.904">       onStartHeaders() {</span>
<a href="#l15.905"></a><span id="l15.905">         EnigmailLog.DEBUG(</span>
<a href="#l15.906"></a><span id="l15.906">           &quot;enigmailMsgHdrViewOverlay.js: _listener_onStartHeaders\n&quot;</span>
<a href="#l15.907"></a><span id="l15.907">         );</span>
<a href="#l15.908"></a><span id="l15.908"> </span>
<a href="#l15.909"></a><span id="l15.909">         try {</span>
<a href="#l15.910"></a><span id="l15.910">           Enigmail.hdrView.statusBarHide();</span>
<a href="#l15.911"></a><span id="l15.911">           EnigmailVerify.setMsgWindow(</span>
<a href="#l15.912"></a><span id="l15.912">             msgWindow,</span>
<a href="#l15.913"></a><span id="l15.913">             Enigmail.msg.getCurrentMsgUriSpec()</span>
<a href="#l15.914"></a><span id="l15.914">           );</span>
<a href="#l15.915"></a><span id="l15.915">           Enigmail.hdrView.setStatusText(&quot;&quot;);</span>
<a href="#l15.916"></a><span id="l15.916" class="difflineplus">+          /*</span>
<a href="#l15.917"></a><span id="l15.917">           this.enigmailBox.setAttribute(</span>
<a href="#l15.918"></a><span id="l15.918">             &quot;class&quot;,</span>
<a href="#l15.919"></a><span id="l15.919">             &quot;expandedEnigmailBox enigmailHeaderBoxLabelSignatureOk&quot;</span>
<a href="#l15.920"></a><span id="l15.920">           );</span>
<a href="#l15.921"></a><span id="l15.921" class="difflineplus">+          */</span>
<a href="#l15.922"></a><span id="l15.922"> </span>
<a href="#l15.923"></a><span id="l15.923" class="difflineminus">-          let msgFrame = EnigmailWindows.getFrame(window, &quot;messagepane&quot;);</span>
<a href="#l15.924"></a><span id="l15.924" class="difflineminus">-          if (!msgFrame) {</span>
<a href="#l15.925"></a><span id="l15.925" class="difflineminus">-            // TB &gt;= 69</span>
<a href="#l15.926"></a><span id="l15.926" class="difflineminus">-            msgFrame = document.getElementById(&quot;messagepane&quot;).contentDocument;</span>
<a href="#l15.927"></a><span id="l15.927" class="difflineminus">-          }</span>
<a href="#l15.928"></a><span id="l15.928" class="difflineplus">+          let msgFrame = document.getElementById(&quot;messagepane&quot;).contentDocument;</span>
<a href="#l15.929"></a><span id="l15.929"> </span>
<a href="#l15.930"></a><span id="l15.930">           if (msgFrame) {</span>
<a href="#l15.931"></a><span id="l15.931">             msgFrame.addEventListener(</span>
<a href="#l15.932"></a><span id="l15.932">               &quot;unload&quot;,</span>
<a href="#l15.933"></a><span id="l15.933">               Enigmail.hdrView.messageUnload.bind(Enigmail.hdrView),</span>
<a href="#l15.934"></a><span id="l15.934">               true</span>
<a href="#l15.935"></a><span id="l15.935">             );</span>
<a href="#l15.936"></a><span id="l15.936">             msgFrame.addEventListener(</span>
<a href="#l15.937"></a><span id="l15.937">               &quot;load&quot;,</span>
<a href="#l15.938"></a><span id="l15.938">               Enigmail.hdrView.messageLoad.bind(Enigmail.hdrView),</span>
<a href="#l15.939"></a><span id="l15.939">               true</span>
<a href="#l15.940"></a><span id="l15.940">             );</span>
<a href="#l15.941"></a><span id="l15.941">           }</span>
<a href="#l15.942"></a><span id="l15.942"> </span>
<a href="#l15.943"></a><span id="l15.943">           Enigmail.hdrView.forgetEncryptedMsgKey();</span>
<a href="#l15.944"></a><span id="l15.944">           Enigmail.hdrView.setWindowCallback();</span>
<a href="#l15.945"></a><span id="l15.945" class="difflineminus">-        } catch (ex) {}</span>
<a href="#l15.946"></a><span id="l15.946" class="difflineplus">+        } catch (ex) {</span>
<a href="#l15.947"></a><span id="l15.947" class="difflineplus">+          console.debug(ex);</span>
<a href="#l15.948"></a><span id="l15.948" class="difflineplus">+        }</span>
<a href="#l15.949"></a><span id="l15.949">       },</span>
<a href="#l15.950"></a><span id="l15.950"> </span>
<a href="#l15.951"></a><span id="l15.951">       onEndHeaders() {</span>
<a href="#l15.952"></a><span id="l15.952">         EnigmailLog.DEBUG(</span>
<a href="#l15.953"></a><span id="l15.953">           &quot;enigmailMsgHdrViewOverlay.js: _listener_onEndHeaders\n&quot;</span>
<a href="#l15.954"></a><span id="l15.954">         );</span>
<a href="#l15.955"></a><span id="l15.955"> </span>
<a href="#l15.956"></a><span id="l15.956">         try {</span>
<a href="#l15.957"></a><span id="l15.957">           Enigmail.hdrView.statusBarHide();</span>
<a href="#l15.958"></a><span id="l15.958" class="difflineminus">-</span>
<a href="#l15.959"></a><span id="l15.959" class="difflineplus">+          /*</span>
<a href="#l15.960"></a><span id="l15.960">           this.enigmailBox.setAttribute(</span>
<a href="#l15.961"></a><span id="l15.961">             &quot;class&quot;,</span>
<a href="#l15.962"></a><span id="l15.962">             &quot;expandedEnigmailBox enigmailHeaderBoxLabelSignatureOk&quot;</span>
<a href="#l15.963"></a><span id="l15.963">           );</span>
<a href="#l15.964"></a><span id="l15.964" class="difflineplus">+          */</span>
<a href="#l15.965"></a><span id="l15.965">         } catch (ex) {}</span>
<a href="#l15.966"></a><span id="l15.966">       },</span>
<a href="#l15.967"></a><span id="l15.967"> </span>
<a href="#l15.968"></a><span id="l15.968">       beforeStartHeaders() {</span>
<a href="#l15.969"></a><span id="l15.969">         return true;</span>
<a href="#l15.970"></a><span id="l15.970">       },</span>
<a href="#l15.971"></a><span id="l15.971">     };</span>
<a href="#l15.972"></a><span id="l15.972"> </span>
<a href="#l15.973"></a><span id="l15.973" class="difflineat">@@ -1166,47 +1084,16 @@ Enigmail.hdrView = {</span>
<a href="#l15.974"></a><span id="l15.974">     }</span>
<a href="#l15.975"></a><span id="l15.975"> </span>
<a href="#l15.976"></a><span id="l15.976">     if (Enigmail.hdrView.lastEncryptedUri &amp;&amp; gEncryptedURIService) {</span>
<a href="#l15.977"></a><span id="l15.977">       gEncryptedURIService.forgetEncrypted(Enigmail.hdrView.lastEncryptedUri);</span>
<a href="#l15.978"></a><span id="l15.978">       Enigmail.hdrView.lastEncryptedUri = null;</span>
<a href="#l15.979"></a><span id="l15.979">     }</span>
<a href="#l15.980"></a><span id="l15.980">   },</span>
<a href="#l15.981"></a><span id="l15.981"> </span>
<a href="#l15.982"></a><span id="l15.982" class="difflineminus">-  displayExtendedStatus(displayOn) {</span>
<a href="#l15.983"></a><span id="l15.983" class="difflineminus">-    var expStatusText = document.getElementById(&quot;expandedEnigmailStatusText&quot;);</span>
<a href="#l15.984"></a><span id="l15.984" class="difflineminus">-    if (displayOn &amp;&amp; expStatusText.getAttribute(&quot;state&quot;) == &quot;true&quot;) {</span>
<a href="#l15.985"></a><span id="l15.985" class="difflineminus">-      if (expStatusText.getAttribute(&quot;display&quot;) == &quot;true&quot;) {</span>
<a href="#l15.986"></a><span id="l15.986" class="difflineminus">-        expStatusText.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l15.987"></a><span id="l15.987" class="difflineminus">-      } else {</span>
<a href="#l15.988"></a><span id="l15.988" class="difflineminus">-        expStatusText.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l15.989"></a><span id="l15.989" class="difflineminus">-      }</span>
<a href="#l15.990"></a><span id="l15.990" class="difflineminus">-    } else {</span>
<a href="#l15.991"></a><span id="l15.991" class="difflineminus">-      expStatusText.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l15.992"></a><span id="l15.992" class="difflineminus">-    }</span>
<a href="#l15.993"></a><span id="l15.993" class="difflineminus">-  },</span>
<a href="#l15.994"></a><span id="l15.994" class="difflineminus">-</span>
<a href="#l15.995"></a><span id="l15.995" class="difflineminus">-  toggleHeaderView() {</span>
<a href="#l15.996"></a><span id="l15.996" class="difflineminus">-    var viewToggle = document.getElementById(&quot;enigToggleHeaderView2&quot;);</span>
<a href="#l15.997"></a><span id="l15.997" class="difflineminus">-    var expandedText = document.getElementById(&quot;expandedEnigmailStatusText&quot;);</span>
<a href="#l15.998"></a><span id="l15.998" class="difflineminus">-    var state = viewToggle.getAttribute(&quot;state&quot;);</span>
<a href="#l15.999"></a><span id="l15.999" class="difflineminus">-</span>
<a href="#l15.1000"></a><span id="l15.1000" class="difflineminus">-    if (state == &quot;true&quot;) {</span>
<a href="#l15.1001"></a><span id="l15.1001" class="difflineminus">-      viewToggle.setAttribute(&quot;state&quot;, &quot;false&quot;);</span>
<a href="#l15.1002"></a><span id="l15.1002" class="difflineminus">-      viewToggle.setAttribute(&quot;class&quot;, &quot;enigmailExpandViewButton&quot;);</span>
<a href="#l15.1003"></a><span id="l15.1003" class="difflineminus">-      expandedText.setAttribute(&quot;display&quot;, &quot;false&quot;);</span>
<a href="#l15.1004"></a><span id="l15.1004" class="difflineminus">-      this.displayExtendedStatus(false);</span>
<a href="#l15.1005"></a><span id="l15.1005" class="difflineminus">-    } else {</span>
<a href="#l15.1006"></a><span id="l15.1006" class="difflineminus">-      viewToggle.setAttribute(&quot;state&quot;, &quot;true&quot;);</span>
<a href="#l15.1007"></a><span id="l15.1007" class="difflineminus">-      viewToggle.setAttribute(&quot;class&quot;, &quot;enigmailCollapseViewButton&quot;);</span>
<a href="#l15.1008"></a><span id="l15.1008" class="difflineminus">-      expandedText.setAttribute(&quot;display&quot;, &quot;true&quot;);</span>
<a href="#l15.1009"></a><span id="l15.1009" class="difflineminus">-      this.displayExtendedStatus(true);</span>
<a href="#l15.1010"></a><span id="l15.1010" class="difflineminus">-    }</span>
<a href="#l15.1011"></a><span id="l15.1011" class="difflineminus">-  },</span>
<a href="#l15.1012"></a><span id="l15.1012" class="difflineminus">-</span>
<a href="#l15.1013"></a><span id="l15.1013">   onShowAttachmentContextMenu(event) {</span>
<a href="#l15.1014"></a><span id="l15.1014">     EnigmailLog.DEBUG(</span>
<a href="#l15.1015"></a><span id="l15.1015">       &quot;enigmailMsgHdrViewOverlay.js: this.onShowAttachmentContextMenu\n&quot;</span>
<a href="#l15.1016"></a><span id="l15.1016">     );</span>
<a href="#l15.1017"></a><span id="l15.1017"> </span>
<a href="#l15.1018"></a><span id="l15.1018">     let contextMenu, selectedAttachments;</span>
<a href="#l15.1019"></a><span id="l15.1019">     // Thunderbird</span>
<a href="#l15.1020"></a><span id="l15.1020">     contextMenu = document.getElementById(&quot;attachmentItemContext&quot;);</span>
<a href="#l15.1021"></a><span id="l15.1021" class="difflineat">@@ -1301,17 +1188,17 @@ Enigmail.hdrView = {</span>
<a href="#l15.1022"></a><span id="l15.1022">     EnigmailLog.DEBUG(&quot;enigmailMsgHdrViewOverlay.js: this.updateMsgDb\n&quot;);</span>
<a href="#l15.1023"></a><span id="l15.1023">     var msg = gFolderDisplay.selectedMessage;</span>
<a href="#l15.1024"></a><span id="l15.1024">     if (!msg || !msg.folder) {</span>
<a href="#l15.1025"></a><span id="l15.1025">       return;</span>
<a href="#l15.1026"></a><span id="l15.1026">     }</span>
<a href="#l15.1027"></a><span id="l15.1027"> </span>
<a href="#l15.1028"></a><span id="l15.1028">     var msgHdr = msg.folder.GetMessageHeader(msg.messageKey);</span>
<a href="#l15.1029"></a><span id="l15.1029"> </span>
<a href="#l15.1030"></a><span id="l15.1030" class="difflineminus">-    if (this.statusBar.getAttribute(&quot;encrypted&quot;) == &quot;ok&quot;) {</span>
<a href="#l15.1031"></a><span id="l15.1031" class="difflineplus">+    if (this.isEncrypted === &quot;ok&quot;) {</span>
<a href="#l15.1032"></a><span id="l15.1032">       Enigmail.msg.securityInfo.statusFlags |=</span>
<a href="#l15.1033"></a><span id="l15.1033">         EnigmailConstants.DECRYPTION_OKAY;</span>
<a href="#l15.1034"></a><span id="l15.1034">     }</span>
<a href="#l15.1035"></a><span id="l15.1035">     msgHdr.setUint32Property(&quot;enigmail&quot;, Enigmail.msg.securityInfo.statusFlags);</span>
<a href="#l15.1036"></a><span id="l15.1036">   },</span>
<a href="#l15.1037"></a><span id="l15.1037"> </span>
<a href="#l15.1038"></a><span id="l15.1038">   enigCanDetachAttachments() {</span>
<a href="#l15.1039"></a><span id="l15.1039">     EnigmailLog.DEBUG(</span>
<a href="#l15.1040"></a><span id="l15.1040" class="difflineat">@@ -1611,17 +1498,19 @@ Enigmail.hdrView = {</span>
<a href="#l15.1041"></a><span id="l15.1041"> </span>
<a href="#l15.1042"></a><span id="l15.1042">         let encToDetails = &quot;&quot;;</span>
<a href="#l15.1043"></a><span id="l15.1043">         if (extraDetails &amp;&amp; extraDetails.length &gt; 0) {</span>
<a href="#l15.1044"></a><span id="l15.1044">           try {</span>
<a href="#l15.1045"></a><span id="l15.1045">             let o = JSON.parse(extraDetails);</span>
<a href="#l15.1046"></a><span id="l15.1046">             if (&quot;encryptedTo&quot; in o) {</span>
<a href="#l15.1047"></a><span id="l15.1047">               encToDetails = o.encryptedTo;</span>
<a href="#l15.1048"></a><span id="l15.1048">             }</span>
<a href="#l15.1049"></a><span id="l15.1049" class="difflineminus">-          } catch (x) {}</span>
<a href="#l15.1050"></a><span id="l15.1050" class="difflineplus">+          } catch (x) {</span>
<a href="#l15.1051"></a><span id="l15.1051" class="difflineplus">+            console.debug(x);</span>
<a href="#l15.1052"></a><span id="l15.1052" class="difflineplus">+          }</span>
<a href="#l15.1053"></a><span id="l15.1053">         }</span>
<a href="#l15.1054"></a><span id="l15.1054"> </span>
<a href="#l15.1055"></a><span id="l15.1055">         Enigmail.hdrView.updateHdrIcons(</span>
<a href="#l15.1056"></a><span id="l15.1056">           exitCode,</span>
<a href="#l15.1057"></a><span id="l15.1057">           statusFlags,</span>
<a href="#l15.1058"></a><span id="l15.1058">           keyId,</span>
<a href="#l15.1059"></a><span id="l15.1059">           userId,</span>
<a href="#l15.1060"></a><span id="l15.1060">           sigDetails,</span>
<a href="#l15.1061"></a><span id="l15.1061" class="difflineat">@@ -1662,19 +1551,21 @@ Enigmail.hdrView = {</span>
<a href="#l15.1062"></a><span id="l15.1062">         gFolderDisplay.selectedMessages.length !== 1</span>
<a href="#l15.1063"></a><span id="l15.1063">       ) {</span>
<a href="#l15.1064"></a><span id="l15.1064">         return;</span>
<a href="#l15.1065"></a><span id="l15.1065">       }</span>
<a href="#l15.1066"></a><span id="l15.1066"> </span>
<a href="#l15.1067"></a><span id="l15.1067">       switch (actionType) {</span>
<a href="#l15.1068"></a><span id="l15.1068">         case &quot;modifyMessageHeaders&quot;:</span>
<a href="#l15.1069"></a><span id="l15.1069">           this.modifyMessageHeaders(uri, processData, mimePartNumber);</span>
<a href="#l15.1070"></a><span id="l15.1070" class="difflineminus">-          return;</span>
<a href="#l15.1071"></a><span id="l15.1071" class="difflineplus">+          break;</span>
<a href="#l15.1072"></a><span id="l15.1072" class="difflineplus">+        /*</span>
<a href="#l15.1073"></a><span id="l15.1073">         case &quot;wksConfirmRequest&quot;:</span>
<a href="#l15.1074"></a><span id="l15.1074">           Enigmail.hdrView.checkWksConfirmRequest(processData);</span>
<a href="#l15.1075"></a><span id="l15.1075" class="difflineplus">+        */</span>
<a href="#l15.1076"></a><span id="l15.1076">       }</span>
<a href="#l15.1077"></a><span id="l15.1077">     },</span>
<a href="#l15.1078"></a><span id="l15.1078"> </span>
<a href="#l15.1079"></a><span id="l15.1079">     modifyMessageHeaders(uri, headerData, mimePartNumber) {</span>
<a href="#l15.1080"></a><span id="l15.1080">       EnigmailLog.DEBUG(</span>
<a href="#l15.1081"></a><span id="l15.1081">         &quot;enigmailMsgHdrViewOverlay.js: EnigMimeHeaderSink.modifyMessageHeaders:\n&quot;</span>
<a href="#l15.1082"></a><span id="l15.1082">       );</span>
<a href="#l15.1083"></a><span id="l15.1083"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mail/extensions/openpgp/skin/tb-linux/enigmail.css</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mail/extensions/openpgp/skin/tb-linux/enigmail.css</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -122,167 +122,8 @@ toolbar:not([mode=&quot;text&quot;]) #button-enigm</span>
<a href="#l16.4"></a><span id="l16.4"> #enigmail-toolbar-encryptHdr-button[disabled] {</span>
<a href="#l16.5"></a><span id="l16.5">   list-style-image : url(&quot;chrome://openpgp/skin/headerUnprotected-18.svg&quot;);</span>
<a href="#l16.6"></a><span id="l16.6"> }</span>
<a href="#l16.7"></a><span id="l16.7"> </span>
<a href="#l16.8"></a><span id="l16.8"> #enigmail-toolbar-encryptHdr-button[checked=&quot;true&quot;]</span>
<a href="#l16.9"></a><span id="l16.9"> {</span>
<a href="#l16.10"></a><span id="l16.10">   list-style-image : url(&quot;chrome://openpgp/skin/headerProtected-18.svg&quot;);</span>
<a href="#l16.11"></a><span id="l16.11"> }</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineminus">-</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineminus">-/***************************************************</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineminus">- *  Icons for messenger status bar</span>
<a href="#l16.16"></a><span id="l16.16" class="difflineminus">- ***************************************************/</span>
<a href="#l16.17"></a><span id="l16.17" class="difflineminus">-</span>
<a href="#l16.18"></a><span id="l16.18" class="difflineminus">-#enigmail-status-bar #enigmail-signed-status {</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineminus">-  list-style-image: none;</span>
<a href="#l16.20"></a><span id="l16.20" class="difflineminus">-  visibility: collapse;</span>
<a href="#l16.21"></a><span id="l16.21" class="difflineminus">-}</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineminus">-</span>
<a href="#l16.23"></a><span id="l16.23" class="difflineminus">-#enigmail-status-bar[signed=&quot;ok&quot;] #enigmail-signed-status {</span>
<a href="#l16.24"></a><span id="l16.24" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignOk.png&quot;);</span>
<a href="#l16.25"></a><span id="l16.25" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.26"></a><span id="l16.26" class="difflineminus">-}</span>
<a href="#l16.27"></a><span id="l16.27" class="difflineminus">-</span>
<a href="#l16.28"></a><span id="l16.28" class="difflineminus">-#enigmail-status-bar[signed=&quot;notok&quot;] #enigmail-signed-status {</span>
<a href="#l16.29"></a><span id="l16.29" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignNotOk.png&quot;);</span>
<a href="#l16.30"></a><span id="l16.30" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.31"></a><span id="l16.31" class="difflineminus">-}</span>
<a href="#l16.32"></a><span id="l16.32" class="difflineminus">-</span>
<a href="#l16.33"></a><span id="l16.33" class="difflineminus">-#enigmail-status-bar[signed=&quot;unknown&quot;] #enigmail-signed-status {</span>
<a href="#l16.34"></a><span id="l16.34" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignUnkown.png&quot;);</span>
<a href="#l16.35"></a><span id="l16.35" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.36"></a><span id="l16.36" class="difflineminus">-}</span>
<a href="#l16.37"></a><span id="l16.37" class="difflineminus">-</span>
<a href="#l16.38"></a><span id="l16.38" class="difflineminus">-#enigmail-status-bar[signed=&quot;inactive&quot;] #enigmail-signed-status {</span>
<a href="#l16.39"></a><span id="l16.39" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignInactive.png&quot;);</span>
<a href="#l16.40"></a><span id="l16.40" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.41"></a><span id="l16.41" class="difflineminus">-}</span>
<a href="#l16.42"></a><span id="l16.42" class="difflineminus">-</span>
<a href="#l16.43"></a><span id="l16.43" class="difflineminus">-#enigmail-status-bar #enigmail-encrypted-status {</span>
<a href="#l16.44"></a><span id="l16.44" class="difflineminus">-  list-style-image: none;</span>
<a href="#l16.45"></a><span id="l16.45" class="difflineminus">-  visibility: collapse;</span>
<a href="#l16.46"></a><span id="l16.46" class="difflineminus">-}</span>
<a href="#l16.47"></a><span id="l16.47" class="difflineminus">-</span>
<a href="#l16.48"></a><span id="l16.48" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;ok&quot;] #enigmail-encrypted-status {</span>
<a href="#l16.49"></a><span id="l16.49" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncOk.png&quot;);</span>
<a href="#l16.50"></a><span id="l16.50" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.51"></a><span id="l16.51" class="difflineminus">-}</span>
<a href="#l16.52"></a><span id="l16.52" class="difflineminus">-</span>
<a href="#l16.53"></a><span id="l16.53" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;notok&quot;] #enigmail-encrypted-status {</span>
<a href="#l16.54"></a><span id="l16.54" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncNotOk.png&quot;);</span>
<a href="#l16.55"></a><span id="l16.55" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.56"></a><span id="l16.56" class="difflineminus">-}</span>
<a href="#l16.57"></a><span id="l16.57" class="difflineminus">-</span>
<a href="#l16.58"></a><span id="l16.58" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;inactive&quot;] #enigmail-encrypted-status {</span>
<a href="#l16.59"></a><span id="l16.59" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncInactive.png&quot;);</span>
<a href="#l16.60"></a><span id="l16.60" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.61"></a><span id="l16.61" class="difflineminus">-}</span>
<a href="#l16.62"></a><span id="l16.62" class="difflineminus">-</span>
<a href="#l16.63"></a><span id="l16.63" class="difflineminus">-</span>
<a href="#l16.64"></a><span id="l16.64" class="difflineminus">-/***************************************************</span>
<a href="#l16.65"></a><span id="l16.65" class="difflineminus">- *  Icons for compose status bar: signed states</span>
<a href="#l16.66"></a><span id="l16.66" class="difflineminus">- ***************************************************/</span>
<a href="#l16.67"></a><span id="l16.67" class="difflineminus">-</span>
<a href="#l16.68"></a><span id="l16.68" class="difflineminus">-#enigmail-status-bar[signed=&quot;forceYes&quot;] #enigmail-signed-status {</span>
<a href="#l16.69"></a><span id="l16.69" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignForceYes.png&quot;);</span>
<a href="#l16.70"></a><span id="l16.70" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.71"></a><span id="l16.71" class="difflineminus">-}</span>
<a href="#l16.72"></a><span id="l16.72" class="difflineminus">-</span>
<a href="#l16.73"></a><span id="l16.73" class="difflineminus">-#enigmail-status-bar[signed=&quot;forceNo&quot;] #enigmail-signed-status {</span>
<a href="#l16.74"></a><span id="l16.74" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignForceNo.png&quot;);</span>
<a href="#l16.75"></a><span id="l16.75" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.76"></a><span id="l16.76" class="difflineminus">-}</span>
<a href="#l16.77"></a><span id="l16.77" class="difflineminus">-</span>
<a href="#l16.78"></a><span id="l16.78" class="difflineminus">-#enigmail-status-bar[signed=&quot;inactiveNone&quot;] #enigmail-signed-status {</span>
<a href="#l16.79"></a><span id="l16.79" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignInactiveNone.png&quot;);</span>
<a href="#l16.80"></a><span id="l16.80" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.81"></a><span id="l16.81" class="difflineminus">-}</span>
<a href="#l16.82"></a><span id="l16.82" class="difflineminus">-</span>
<a href="#l16.83"></a><span id="l16.83" class="difflineminus">-#enigmail-status-bar[signed=&quot;inactivePlus&quot;] #enigmail-signed-status {</span>
<a href="#l16.84"></a><span id="l16.84" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignInactivePlus.png&quot;);</span>
<a href="#l16.85"></a><span id="l16.85" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.86"></a><span id="l16.86" class="difflineminus">-}</span>
<a href="#l16.87"></a><span id="l16.87" class="difflineminus">-</span>
<a href="#l16.88"></a><span id="l16.88" class="difflineminus">-#enigmail-status-bar[signed=&quot;inactiveMinus&quot;] #enigmail-signed-status {</span>
<a href="#l16.89"></a><span id="l16.89" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignInactiveMinus.png&quot;);</span>
<a href="#l16.90"></a><span id="l16.90" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.91"></a><span id="l16.91" class="difflineminus">-}</span>
<a href="#l16.92"></a><span id="l16.92" class="difflineminus">-</span>
<a href="#l16.93"></a><span id="l16.93" class="difflineminus">-#enigmail-status-bar[signed=&quot;inactiveConflict&quot;] #enigmail-signed-status {</span>
<a href="#l16.94"></a><span id="l16.94" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignInactiveConflict.png&quot;);</span>
<a href="#l16.95"></a><span id="l16.95" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.96"></a><span id="l16.96" class="difflineminus">-}</span>
<a href="#l16.97"></a><span id="l16.97" class="difflineminus">-</span>
<a href="#l16.98"></a><span id="l16.98" class="difflineminus">-#enigmail-status-bar[signed=&quot;activeNone&quot;] #enigmail-signed-status {</span>
<a href="#l16.99"></a><span id="l16.99" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignActiveNone.png&quot;);</span>
<a href="#l16.100"></a><span id="l16.100" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.101"></a><span id="l16.101" class="difflineminus">-}</span>
<a href="#l16.102"></a><span id="l16.102" class="difflineminus">-</span>
<a href="#l16.103"></a><span id="l16.103" class="difflineminus">-#enigmail-status-bar[signed=&quot;activePlus&quot;] #enigmail-signed-status {</span>
<a href="#l16.104"></a><span id="l16.104" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignActivePlus.png&quot;);</span>
<a href="#l16.105"></a><span id="l16.105" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.106"></a><span id="l16.106" class="difflineminus">-}</span>
<a href="#l16.107"></a><span id="l16.107" class="difflineminus">-</span>
<a href="#l16.108"></a><span id="l16.108" class="difflineminus">-#enigmail-status-bar[signed=&quot;activeMinus&quot;] #enigmail-signed-status {</span>
<a href="#l16.109"></a><span id="l16.109" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignActiveMinus.png&quot;);</span>
<a href="#l16.110"></a><span id="l16.110" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.111"></a><span id="l16.111" class="difflineminus">-}</span>
<a href="#l16.112"></a><span id="l16.112" class="difflineminus">-</span>
<a href="#l16.113"></a><span id="l16.113" class="difflineminus">-#enigmail-status-bar[signed=&quot;activeConflict&quot;] #enigmail-signed-status {</span>
<a href="#l16.114"></a><span id="l16.114" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignActiveConflict.png&quot;);</span>
<a href="#l16.115"></a><span id="l16.115" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.116"></a><span id="l16.116" class="difflineminus">-}</span>
<a href="#l16.117"></a><span id="l16.117" class="difflineminus">-</span>
<a href="#l16.118"></a><span id="l16.118" class="difflineminus">-/***************************************************</span>
<a href="#l16.119"></a><span id="l16.119" class="difflineminus">- *  Icons for compose status bar: encrypted states</span>
<a href="#l16.120"></a><span id="l16.120" class="difflineminus">- ***************************************************/</span>
<a href="#l16.121"></a><span id="l16.121" class="difflineminus">-</span>
<a href="#l16.122"></a><span id="l16.122" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;forceYes&quot;] #enigmail-encrypted-status {</span>
<a href="#l16.123"></a><span id="l16.123" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncForceYes.png&quot;);</span>
<a href="#l16.124"></a><span id="l16.124" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.125"></a><span id="l16.125" class="difflineminus">-}</span>
<a href="#l16.126"></a><span id="l16.126" class="difflineminus">-</span>
<a href="#l16.127"></a><span id="l16.127" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;forceNo&quot;] #enigmail-encrypted-status {</span>
<a href="#l16.128"></a><span id="l16.128" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncForceNo.png&quot;);</span>
<a href="#l16.129"></a><span id="l16.129" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.130"></a><span id="l16.130" class="difflineminus">-}</span>
<a href="#l16.131"></a><span id="l16.131" class="difflineminus">-</span>
<a href="#l16.132"></a><span id="l16.132" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;activeNone&quot;] #enigmail-encrypted-status {</span>
<a href="#l16.133"></a><span id="l16.133" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncActiveNone.png&quot;);</span>
<a href="#l16.134"></a><span id="l16.134" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.135"></a><span id="l16.135" class="difflineminus">-}</span>
<a href="#l16.136"></a><span id="l16.136" class="difflineminus">-</span>
<a href="#l16.137"></a><span id="l16.137" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;activePlus&quot;] #enigmail-encrypted-status {</span>
<a href="#l16.138"></a><span id="l16.138" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncActivePlus.png&quot;);</span>
<a href="#l16.139"></a><span id="l16.139" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.140"></a><span id="l16.140" class="difflineminus">-}</span>
<a href="#l16.141"></a><span id="l16.141" class="difflineminus">-</span>
<a href="#l16.142"></a><span id="l16.142" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;activeMinus&quot;] #enigmail-encrypted-status {</span>
<a href="#l16.143"></a><span id="l16.143" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncActiveMinus.png&quot;);</span>
<a href="#l16.144"></a><span id="l16.144" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.145"></a><span id="l16.145" class="difflineminus">-}</span>
<a href="#l16.146"></a><span id="l16.146" class="difflineminus">-</span>
<a href="#l16.147"></a><span id="l16.147" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;activeConflict&quot;] #enigmail-encrypted-status {</span>
<a href="#l16.148"></a><span id="l16.148" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncActiveConflict.png&quot;);</span>
<a href="#l16.149"></a><span id="l16.149" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.150"></a><span id="l16.150" class="difflineminus">-}</span>
<a href="#l16.151"></a><span id="l16.151" class="difflineminus">-</span>
<a href="#l16.152"></a><span id="l16.152" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;inactiveNone&quot;] #enigmail-encrypted-status {</span>
<a href="#l16.153"></a><span id="l16.153" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncInactiveNone.png&quot;);</span>
<a href="#l16.154"></a><span id="l16.154" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.155"></a><span id="l16.155" class="difflineminus">-}</span>
<a href="#l16.156"></a><span id="l16.156" class="difflineminus">-</span>
<a href="#l16.157"></a><span id="l16.157" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;inactivePlus&quot;] #enigmail-encrypted-status {</span>
<a href="#l16.158"></a><span id="l16.158" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncInactivePlus.png&quot;);</span>
<a href="#l16.159"></a><span id="l16.159" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.160"></a><span id="l16.160" class="difflineminus">-}</span>
<a href="#l16.161"></a><span id="l16.161" class="difflineminus">-</span>
<a href="#l16.162"></a><span id="l16.162" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;inactiveMinus&quot;] #enigmail-encrypted-status {</span>
<a href="#l16.163"></a><span id="l16.163" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncInactiveMinus.png&quot;);</span>
<a href="#l16.164"></a><span id="l16.164" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.165"></a><span id="l16.165" class="difflineminus">-}</span>
<a href="#l16.166"></a><span id="l16.166" class="difflineminus">-</span>
<a href="#l16.167"></a><span id="l16.167" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;inactiveConflict&quot;] #enigmail-encrypted-status {</span>
<a href="#l16.168"></a><span id="l16.168" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncInactiveConflict.png&quot;);</span>
<a href="#l16.169"></a><span id="l16.169" class="difflineminus">-  visibility: visible;</span>
<a href="#l16.170"></a><span id="l16.170" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mail/extensions/openpgp/skin/tb-mac/enigmail.css</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mail/extensions/openpgp/skin/tb-mac/enigmail.css</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -124,177 +124,8 @@ toolbar:not([mode=&quot;text&quot;]) #button-enigm</span>
<a href="#l17.4"></a><span id="l17.4"> #enigmail-toolbar-encryptHdr-button[disabled] {</span>
<a href="#l17.5"></a><span id="l17.5">   list-style-image : url(&quot;chrome://openpgp/skin/headerUnprotected-18.svg&quot;);</span>
<a href="#l17.6"></a><span id="l17.6"> }</span>
<a href="#l17.7"></a><span id="l17.7"> </span>
<a href="#l17.8"></a><span id="l17.8"> #enigmail-toolbar-encryptHdr-button[checked=&quot;true&quot;]</span>
<a href="#l17.9"></a><span id="l17.9"> {</span>
<a href="#l17.10"></a><span id="l17.10">   list-style-image : url(&quot;chrome://openpgp/skin/headerProtected-18.svg&quot;);</span>
<a href="#l17.11"></a><span id="l17.11"> }</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineminus">-</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineminus">-/***************************************************</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineminus">- *  Icons for messenger status bar</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineminus">- ***************************************************/</span>
<a href="#l17.17"></a><span id="l17.17" class="difflineminus">-</span>
<a href="#l17.18"></a><span id="l17.18" class="difflineminus">-#enigmail-status-bar #enigmail-signed-status {</span>
<a href="#l17.19"></a><span id="l17.19" class="difflineminus">-  list-style-image: none;</span>
<a href="#l17.20"></a><span id="l17.20" class="difflineminus">-  visibility: collapse;</span>
<a href="#l17.21"></a><span id="l17.21" class="difflineminus">-}</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineminus">-</span>
<a href="#l17.23"></a><span id="l17.23" class="difflineminus">-#enigmail-status-bar[signed=&quot;ok&quot;] #enigmail-signed-status {</span>
<a href="#l17.24"></a><span id="l17.24" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignOk.png&quot;);</span>
<a href="#l17.25"></a><span id="l17.25" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.26"></a><span id="l17.26" class="difflineminus">-}</span>
<a href="#l17.27"></a><span id="l17.27" class="difflineminus">-</span>
<a href="#l17.28"></a><span id="l17.28" class="difflineminus">-#enigmail-status-bar[signed=&quot;notok&quot;] #enigmail-signed-status {</span>
<a href="#l17.29"></a><span id="l17.29" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignNotOk.png&quot;);</span>
<a href="#l17.30"></a><span id="l17.30" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineminus">-}</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineminus">-</span>
<a href="#l17.33"></a><span id="l17.33" class="difflineminus">-#enigmail-status-bar[signed=&quot;unknown&quot;] #enigmail-signed-status {</span>
<a href="#l17.34"></a><span id="l17.34" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignUnkown.png&quot;);</span>
<a href="#l17.35"></a><span id="l17.35" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.36"></a><span id="l17.36" class="difflineminus">-}</span>
<a href="#l17.37"></a><span id="l17.37" class="difflineminus">-</span>
<a href="#l17.38"></a><span id="l17.38" class="difflineminus">-#enigmail-status-bar[signed=&quot;inactive&quot;] #enigmail-signed-status {</span>
<a href="#l17.39"></a><span id="l17.39" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignInactive.png&quot;);</span>
<a href="#l17.40"></a><span id="l17.40" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.41"></a><span id="l17.41" class="difflineminus">-}</span>
<a href="#l17.42"></a><span id="l17.42" class="difflineminus">-</span>
<a href="#l17.43"></a><span id="l17.43" class="difflineminus">-#enigmail-status-bar #enigmail-encrypted-status {</span>
<a href="#l17.44"></a><span id="l17.44" class="difflineminus">-  list-style-image: none;</span>
<a href="#l17.45"></a><span id="l17.45" class="difflineminus">-  visibility: collapse;</span>
<a href="#l17.46"></a><span id="l17.46" class="difflineminus">-}</span>
<a href="#l17.47"></a><span id="l17.47" class="difflineminus">-</span>
<a href="#l17.48"></a><span id="l17.48" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;ok&quot;] #enigmail-encrypted-status {</span>
<a href="#l17.49"></a><span id="l17.49" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncOk.png&quot;);</span>
<a href="#l17.50"></a><span id="l17.50" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.51"></a><span id="l17.51" class="difflineminus">-}</span>
<a href="#l17.52"></a><span id="l17.52" class="difflineminus">-</span>
<a href="#l17.53"></a><span id="l17.53" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;notok&quot;] #enigmail-encrypted-status {</span>
<a href="#l17.54"></a><span id="l17.54" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncNotOk.png&quot;);</span>
<a href="#l17.55"></a><span id="l17.55" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.56"></a><span id="l17.56" class="difflineminus">-}</span>
<a href="#l17.57"></a><span id="l17.57" class="difflineminus">-</span>
<a href="#l17.58"></a><span id="l17.58" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;inactive&quot;] #enigmail-encrypted-status {</span>
<a href="#l17.59"></a><span id="l17.59" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncInactive.png&quot;);</span>
<a href="#l17.60"></a><span id="l17.60" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.61"></a><span id="l17.61" class="difflineminus">-}</span>
<a href="#l17.62"></a><span id="l17.62" class="difflineminus">-</span>
<a href="#l17.63"></a><span id="l17.63" class="difflineminus">-</span>
<a href="#l17.64"></a><span id="l17.64" class="difflineminus">-/***************************************************</span>
<a href="#l17.65"></a><span id="l17.65" class="difflineminus">- *  Icons for compose status bar: signed states</span>
<a href="#l17.66"></a><span id="l17.66" class="difflineminus">- ***************************************************/</span>
<a href="#l17.67"></a><span id="l17.67" class="difflineminus">-</span>
<a href="#l17.68"></a><span id="l17.68" class="difflineminus">-#enigmail-signing-status[disabled] {</span>
<a href="#l17.69"></a><span id="l17.69" class="difflineminus">-  visibility: collapse;</span>
<a href="#l17.70"></a><span id="l17.70" class="difflineminus">-}</span>
<a href="#l17.71"></a><span id="l17.71" class="difflineminus">-</span>
<a href="#l17.72"></a><span id="l17.72" class="difflineminus">-#enigmail-signing-status[signed=&quot;forceYes&quot;] {</span>
<a href="#l17.73"></a><span id="l17.73" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignForceYes.png&quot;);</span>
<a href="#l17.74"></a><span id="l17.74" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.75"></a><span id="l17.75" class="difflineminus">-}</span>
<a href="#l17.76"></a><span id="l17.76" class="difflineminus">-</span>
<a href="#l17.77"></a><span id="l17.77" class="difflineminus">-#enigmail-signing-status[signed=&quot;forceNo&quot;] {</span>
<a href="#l17.78"></a><span id="l17.78" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignForceNo.png&quot;);</span>
<a href="#l17.79"></a><span id="l17.79" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.80"></a><span id="l17.80" class="difflineminus">-}</span>
<a href="#l17.81"></a><span id="l17.81" class="difflineminus">-</span>
<a href="#l17.82"></a><span id="l17.82" class="difflineminus">-#enigmail-signing-status[signed=&quot;inactiveNone&quot;] {</span>
<a href="#l17.83"></a><span id="l17.83" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignInactiveNone.png&quot;);</span>
<a href="#l17.84"></a><span id="l17.84" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.85"></a><span id="l17.85" class="difflineminus">-}</span>
<a href="#l17.86"></a><span id="l17.86" class="difflineminus">-</span>
<a href="#l17.87"></a><span id="l17.87" class="difflineminus">-#enigmail-signing-status[signed=&quot;inactivePlus&quot;]  {</span>
<a href="#l17.88"></a><span id="l17.88" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignInactivePlus.png&quot;);</span>
<a href="#l17.89"></a><span id="l17.89" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.90"></a><span id="l17.90" class="difflineminus">-}</span>
<a href="#l17.91"></a><span id="l17.91" class="difflineminus">-</span>
<a href="#l17.92"></a><span id="l17.92" class="difflineminus">-#enigmail-signing-status[signed=&quot;inactiveMinus&quot;]  {</span>
<a href="#l17.93"></a><span id="l17.93" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignInactiveMinus.png&quot;);</span>
<a href="#l17.94"></a><span id="l17.94" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.95"></a><span id="l17.95" class="difflineminus">-}</span>
<a href="#l17.96"></a><span id="l17.96" class="difflineminus">-</span>
<a href="#l17.97"></a><span id="l17.97" class="difflineminus">-#enigmail-signing-status[signed=&quot;inactiveConflict&quot;] {</span>
<a href="#l17.98"></a><span id="l17.98" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignInactiveConflict.png&quot;);</span>
<a href="#l17.99"></a><span id="l17.99" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.100"></a><span id="l17.100" class="difflineminus">-}</span>
<a href="#l17.101"></a><span id="l17.101" class="difflineminus">-</span>
<a href="#l17.102"></a><span id="l17.102" class="difflineminus">-#enigmail-signing-status[signed=&quot;activeNone&quot;]  {</span>
<a href="#l17.103"></a><span id="l17.103" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignActiveNone.png&quot;);</span>
<a href="#l17.104"></a><span id="l17.104" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.105"></a><span id="l17.105" class="difflineminus">-}</span>
<a href="#l17.106"></a><span id="l17.106" class="difflineminus">-</span>
<a href="#l17.107"></a><span id="l17.107" class="difflineminus">-#enigmail-signing-status[signed=&quot;activePlus&quot;]  {</span>
<a href="#l17.108"></a><span id="l17.108" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignActivePlus.png&quot;);</span>
<a href="#l17.109"></a><span id="l17.109" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.110"></a><span id="l17.110" class="difflineminus">-}</span>
<a href="#l17.111"></a><span id="l17.111" class="difflineminus">-</span>
<a href="#l17.112"></a><span id="l17.112" class="difflineminus">-#enigmail-signing-status[signed=&quot;activeMinus&quot;]  {</span>
<a href="#l17.113"></a><span id="l17.113" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignActiveMinus.png&quot;);</span>
<a href="#l17.114"></a><span id="l17.114" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.115"></a><span id="l17.115" class="difflineminus">-}</span>
<a href="#l17.116"></a><span id="l17.116" class="difflineminus">-</span>
<a href="#l17.117"></a><span id="l17.117" class="difflineminus">-#enigmail-signing-status[signed=&quot;activeConflict&quot;]  {</span>
<a href="#l17.118"></a><span id="l17.118" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignActiveConflict.png&quot;);</span>
<a href="#l17.119"></a><span id="l17.119" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.120"></a><span id="l17.120" class="difflineminus">-}</span>
<a href="#l17.121"></a><span id="l17.121" class="difflineminus">-</span>
<a href="#l17.122"></a><span id="l17.122" class="difflineminus">-/***************************************************</span>
<a href="#l17.123"></a><span id="l17.123" class="difflineminus">- *  Icons for compose status bar: encrypted states</span>
<a href="#l17.124"></a><span id="l17.124" class="difflineminus">- ***************************************************/</span>
<a href="#l17.125"></a><span id="l17.125" class="difflineminus">-</span>
<a href="#l17.126"></a><span id="l17.126" class="difflineminus">-</span>
<a href="#l17.127"></a><span id="l17.127" class="difflineminus">-#enigmail-encryption-status[disabled] {</span>
<a href="#l17.128"></a><span id="l17.128" class="difflineminus">-  visibility: collapse;</span>
<a href="#l17.129"></a><span id="l17.129" class="difflineminus">-}</span>
<a href="#l17.130"></a><span id="l17.130" class="difflineminus">-</span>
<a href="#l17.131"></a><span id="l17.131" class="difflineminus">-#enigmail-encryption-status[encrypted=&quot;inactiveNone&quot;] {</span>
<a href="#l17.132"></a><span id="l17.132" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncInactiveNone.png&quot;);</span>
<a href="#l17.133"></a><span id="l17.133" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.134"></a><span id="l17.134" class="difflineminus">-}</span>
<a href="#l17.135"></a><span id="l17.135" class="difflineminus">-</span>
<a href="#l17.136"></a><span id="l17.136" class="difflineminus">-#enigmail-encryption-status[encrypted=&quot;forceYes&quot;] {</span>
<a href="#l17.137"></a><span id="l17.137" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncForceYes.png&quot;);</span>
<a href="#l17.138"></a><span id="l17.138" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.139"></a><span id="l17.139" class="difflineminus">-}</span>
<a href="#l17.140"></a><span id="l17.140" class="difflineminus">-</span>
<a href="#l17.141"></a><span id="l17.141" class="difflineminus">- #enigmail-encryption-status[encrypted=&quot;forceNo&quot;] {</span>
<a href="#l17.142"></a><span id="l17.142" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncForceNo.png&quot;);</span>
<a href="#l17.143"></a><span id="l17.143" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.144"></a><span id="l17.144" class="difflineminus">-}</span>
<a href="#l17.145"></a><span id="l17.145" class="difflineminus">-</span>
<a href="#l17.146"></a><span id="l17.146" class="difflineminus">-#enigmail-encryption-status[encrypted=&quot;activeNone&quot;]  {</span>
<a href="#l17.147"></a><span id="l17.147" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncActiveNone.png&quot;);</span>
<a href="#l17.148"></a><span id="l17.148" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.149"></a><span id="l17.149" class="difflineminus">-}</span>
<a href="#l17.150"></a><span id="l17.150" class="difflineminus">-</span>
<a href="#l17.151"></a><span id="l17.151" class="difflineminus">-#enigmail-encryption-status[encrypted=&quot;activePlus&quot;] {</span>
<a href="#l17.152"></a><span id="l17.152" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncActivePlus.png&quot;);</span>
<a href="#l17.153"></a><span id="l17.153" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.154"></a><span id="l17.154" class="difflineminus">-}</span>
<a href="#l17.155"></a><span id="l17.155" class="difflineminus">-</span>
<a href="#l17.156"></a><span id="l17.156" class="difflineminus">- #enigmail-encryption-status[encrypted=&quot;activeMinus&quot;] {</span>
<a href="#l17.157"></a><span id="l17.157" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncActiveMinus.png&quot;);</span>
<a href="#l17.158"></a><span id="l17.158" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.159"></a><span id="l17.159" class="difflineminus">-}</span>
<a href="#l17.160"></a><span id="l17.160" class="difflineminus">-</span>
<a href="#l17.161"></a><span id="l17.161" class="difflineminus">-#enigmail-encryption-status[encrypted=&quot;activeConflict&quot;]  {</span>
<a href="#l17.162"></a><span id="l17.162" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncActiveConflict.png&quot;);</span>
<a href="#l17.163"></a><span id="l17.163" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.164"></a><span id="l17.164" class="difflineminus">-}</span>
<a href="#l17.165"></a><span id="l17.165" class="difflineminus">-</span>
<a href="#l17.166"></a><span id="l17.166" class="difflineminus">-</span>
<a href="#l17.167"></a><span id="l17.167" class="difflineminus">-#enigmail-encryption-status[encrypted=&quot;inactivePlus&quot;]  {</span>
<a href="#l17.168"></a><span id="l17.168" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncInactivePlus.png&quot;);</span>
<a href="#l17.169"></a><span id="l17.169" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.170"></a><span id="l17.170" class="difflineminus">-}</span>
<a href="#l17.171"></a><span id="l17.171" class="difflineminus">-</span>
<a href="#l17.172"></a><span id="l17.172" class="difflineminus">- #enigmail-encryption-status[encrypted=&quot;inactiveMinus&quot;] {</span>
<a href="#l17.173"></a><span id="l17.173" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncInactiveMinus.png&quot;);</span>
<a href="#l17.174"></a><span id="l17.174" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.175"></a><span id="l17.175" class="difflineminus">-}</span>
<a href="#l17.176"></a><span id="l17.176" class="difflineminus">-</span>
<a href="#l17.177"></a><span id="l17.177" class="difflineminus">-#enigmail-encryption-status[encrypted=&quot;inactiveConflict&quot;] {</span>
<a href="#l17.178"></a><span id="l17.178" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncInactiveConflict.png&quot;);</span>
<a href="#l17.179"></a><span id="l17.179" class="difflineminus">-  visibility: visible;</span>
<a href="#l17.180"></a><span id="l17.180" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mail/extensions/openpgp/skin/tb-win/enigmail.css</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mail/extensions/openpgp/skin/tb-win/enigmail.css</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -108,182 +108,24 @@ toolbar:not([mode=&quot;text&quot;]) #button-enigm</span>
<a href="#l18.4"></a><span id="l18.4"> </span>
<a href="#l18.5"></a><span id="l18.5"> #button-enigmail-attach[addPubkey=&quot;true&quot;]</span>
<a href="#l18.6"></a><span id="l18.6"> {</span>
<a href="#l18.7"></a><span id="l18.7">   list-style-image : url(&quot;chrome://openpgp/skin/attach-active-18.svg&quot;);</span>
<a href="#l18.8"></a><span id="l18.8"> }</span>
<a href="#l18.9"></a><span id="l18.9"> </span>
<a href="#l18.10"></a><span id="l18.10"> </span>
<a href="#l18.11"></a><span id="l18.11"> /***************************************************</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">- *  Icons for messenger status bar</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineminus">- ***************************************************/</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineminus">-</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineminus">-#enigmail-status-bar #enigmail-signed-status {</span>
<a href="#l18.16"></a><span id="l18.16" class="difflineminus">-  list-style-image: none;</span>
<a href="#l18.17"></a><span id="l18.17" class="difflineminus">-  visibility: collapse;</span>
<a href="#l18.18"></a><span id="l18.18" class="difflineminus">-}</span>
<a href="#l18.19"></a><span id="l18.19" class="difflineminus">-</span>
<a href="#l18.20"></a><span id="l18.20" class="difflineminus">-#enigmail-status-bar[signed=&quot;ok&quot;] #enigmail-signed-status {</span>
<a href="#l18.21"></a><span id="l18.21" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignOk.png&quot;);</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.23"></a><span id="l18.23" class="difflineminus">-}</span>
<a href="#l18.24"></a><span id="l18.24" class="difflineminus">-</span>
<a href="#l18.25"></a><span id="l18.25" class="difflineminus">-#enigmail-status-bar[signed=&quot;notok&quot;] #enigmail-signed-status {</span>
<a href="#l18.26"></a><span id="l18.26" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignNotOk.png&quot;);</span>
<a href="#l18.27"></a><span id="l18.27" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.28"></a><span id="l18.28" class="difflineminus">-}</span>
<a href="#l18.29"></a><span id="l18.29" class="difflineminus">-</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineminus">-#enigmail-status-bar[signed=&quot;unknown&quot;] #enigmail-signed-status {</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignUnkown.png&quot;);</span>
<a href="#l18.32"></a><span id="l18.32" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.33"></a><span id="l18.33" class="difflineminus">-}</span>
<a href="#l18.34"></a><span id="l18.34" class="difflineminus">-</span>
<a href="#l18.35"></a><span id="l18.35" class="difflineminus">-#enigmail-status-bar[signed=&quot;inactive&quot;] #enigmail-signed-status {</span>
<a href="#l18.36"></a><span id="l18.36" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignInactive.png&quot;);</span>
<a href="#l18.37"></a><span id="l18.37" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.38"></a><span id="l18.38" class="difflineminus">-}</span>
<a href="#l18.39"></a><span id="l18.39" class="difflineminus">-</span>
<a href="#l18.40"></a><span id="l18.40" class="difflineminus">-#enigmail-status-bar #enigmail-encrypted-status {</span>
<a href="#l18.41"></a><span id="l18.41" class="difflineminus">-  list-style-image: none;</span>
<a href="#l18.42"></a><span id="l18.42" class="difflineminus">-  visibility: collapse;</span>
<a href="#l18.43"></a><span id="l18.43" class="difflineminus">-}</span>
<a href="#l18.44"></a><span id="l18.44" class="difflineminus">-</span>
<a href="#l18.45"></a><span id="l18.45" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;ok&quot;] #enigmail-encrypted-status {</span>
<a href="#l18.46"></a><span id="l18.46" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncOk.png&quot;);</span>
<a href="#l18.47"></a><span id="l18.47" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.48"></a><span id="l18.48" class="difflineminus">-}</span>
<a href="#l18.49"></a><span id="l18.49" class="difflineminus">-</span>
<a href="#l18.50"></a><span id="l18.50" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;notok&quot;] #enigmail-encrypted-status {</span>
<a href="#l18.51"></a><span id="l18.51" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncNotOk.png&quot;);</span>
<a href="#l18.52"></a><span id="l18.52" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.53"></a><span id="l18.53" class="difflineminus">-}</span>
<a href="#l18.54"></a><span id="l18.54" class="difflineminus">-</span>
<a href="#l18.55"></a><span id="l18.55" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;inactive&quot;] #enigmail-encrypted-status {</span>
<a href="#l18.56"></a><span id="l18.56" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncInactive.png&quot;);</span>
<a href="#l18.57"></a><span id="l18.57" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.58"></a><span id="l18.58" class="difflineminus">-}</span>
<a href="#l18.59"></a><span id="l18.59" class="difflineminus">-</span>
<a href="#l18.60"></a><span id="l18.60" class="difflineminus">-</span>
<a href="#l18.61"></a><span id="l18.61" class="difflineminus">-/***************************************************</span>
<a href="#l18.62"></a><span id="l18.62">  *  Icons for compose toolbar: Protect header</span>
<a href="#l18.63"></a><span id="l18.63">  ***************************************************/</span>
<a href="#l18.64"></a><span id="l18.64"> </span>
<a href="#l18.65"></a><span id="l18.65"> #enigmail-toolbar-encryptHdr-button</span>
<a href="#l18.66"></a><span id="l18.66"> {</span>
<a href="#l18.67"></a><span id="l18.67">   list-style-image : url(&quot;chrome://openpgp/skin/headerUnprotected-18.svg&quot;);</span>
<a href="#l18.68"></a><span id="l18.68"> }</span>
<a href="#l18.69"></a><span id="l18.69"> </span>
<a href="#l18.70"></a><span id="l18.70"> #enigmail-toolbar-encryptHdr-button[disabled] {</span>
<a href="#l18.71"></a><span id="l18.71">   list-style-image : url(&quot;chrome://openpgp/skin/headerUnprotected-18.svg&quot;);</span>
<a href="#l18.72"></a><span id="l18.72"> }</span>
<a href="#l18.73"></a><span id="l18.73"> </span>
<a href="#l18.74"></a><span id="l18.74"> #enigmail-toolbar-encryptHdr-button[checked=&quot;true&quot;]</span>
<a href="#l18.75"></a><span id="l18.75"> {</span>
<a href="#l18.76"></a><span id="l18.76">   list-style-image : url(&quot;chrome://openpgp/skin/headerProtected-18.svg&quot;);</span>
<a href="#l18.77"></a><span id="l18.77"> }</span>
<a href="#l18.78"></a><span id="l18.78" class="difflineminus">-</span>
<a href="#l18.79"></a><span id="l18.79" class="difflineminus">-/***************************************************</span>
<a href="#l18.80"></a><span id="l18.80" class="difflineminus">- *  Icons for compose status bar: signed states</span>
<a href="#l18.81"></a><span id="l18.81" class="difflineminus">- ***************************************************/</span>
<a href="#l18.82"></a><span id="l18.82" class="difflineminus">-</span>
<a href="#l18.83"></a><span id="l18.83" class="difflineminus">-#enigmail-status-bar[signed=&quot;forceYes&quot;] #enigmail-signed-status {</span>
<a href="#l18.84"></a><span id="l18.84" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignForceYes.png&quot;);</span>
<a href="#l18.85"></a><span id="l18.85" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.86"></a><span id="l18.86" class="difflineminus">-}</span>
<a href="#l18.87"></a><span id="l18.87" class="difflineminus">-</span>
<a href="#l18.88"></a><span id="l18.88" class="difflineminus">-#enigmail-status-bar[signed=&quot;forceNo&quot;] #enigmail-signed-status {</span>
<a href="#l18.89"></a><span id="l18.89" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignForceNo.png&quot;);</span>
<a href="#l18.90"></a><span id="l18.90" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.91"></a><span id="l18.91" class="difflineminus">-}</span>
<a href="#l18.92"></a><span id="l18.92" class="difflineminus">-</span>
<a href="#l18.93"></a><span id="l18.93" class="difflineminus">-#enigmail-status-bar[signed=&quot;inactiveNone&quot;] #enigmail-signed-status {</span>
<a href="#l18.94"></a><span id="l18.94" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignInactiveNone.png&quot;);</span>
<a href="#l18.95"></a><span id="l18.95" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.96"></a><span id="l18.96" class="difflineminus">-}</span>
<a href="#l18.97"></a><span id="l18.97" class="difflineminus">-</span>
<a href="#l18.98"></a><span id="l18.98" class="difflineminus">-#enigmail-status-bar[signed=&quot;inactivePlus&quot;] #enigmail-signed-status {</span>
<a href="#l18.99"></a><span id="l18.99" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignInactivePlus.png&quot;);</span>
<a href="#l18.100"></a><span id="l18.100" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.101"></a><span id="l18.101" class="difflineminus">-}</span>
<a href="#l18.102"></a><span id="l18.102" class="difflineminus">-</span>
<a href="#l18.103"></a><span id="l18.103" class="difflineminus">-#enigmail-status-bar[signed=&quot;inactiveMinus&quot;] #enigmail-signed-status {</span>
<a href="#l18.104"></a><span id="l18.104" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignInactiveMinus.png&quot;);</span>
<a href="#l18.105"></a><span id="l18.105" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.106"></a><span id="l18.106" class="difflineminus">-}</span>
<a href="#l18.107"></a><span id="l18.107" class="difflineminus">-</span>
<a href="#l18.108"></a><span id="l18.108" class="difflineminus">-#enigmail-status-bar[signed=&quot;inactiveConflict&quot;] #enigmail-signed-status {</span>
<a href="#l18.109"></a><span id="l18.109" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignInactiveConflict.png&quot;);</span>
<a href="#l18.110"></a><span id="l18.110" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.111"></a><span id="l18.111" class="difflineminus">-}</span>
<a href="#l18.112"></a><span id="l18.112" class="difflineminus">-</span>
<a href="#l18.113"></a><span id="l18.113" class="difflineminus">-#enigmail-status-bar[signed=&quot;activeNone&quot;] #enigmail-signed-status {</span>
<a href="#l18.114"></a><span id="l18.114" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignActiveNone.png&quot;);</span>
<a href="#l18.115"></a><span id="l18.115" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.116"></a><span id="l18.116" class="difflineminus">-}</span>
<a href="#l18.117"></a><span id="l18.117" class="difflineminus">-</span>
<a href="#l18.118"></a><span id="l18.118" class="difflineminus">-#enigmail-status-bar[signed=&quot;activePlus&quot;] #enigmail-signed-status {</span>
<a href="#l18.119"></a><span id="l18.119" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignActivePlus.png&quot;);</span>
<a href="#l18.120"></a><span id="l18.120" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.121"></a><span id="l18.121" class="difflineminus">-}</span>
<a href="#l18.122"></a><span id="l18.122" class="difflineminus">-</span>
<a href="#l18.123"></a><span id="l18.123" class="difflineminus">-#enigmail-status-bar[signed=&quot;activeMinus&quot;] #enigmail-signed-status {</span>
<a href="#l18.124"></a><span id="l18.124" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignActiveMinus.png&quot;);</span>
<a href="#l18.125"></a><span id="l18.125" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.126"></a><span id="l18.126" class="difflineminus">-}</span>
<a href="#l18.127"></a><span id="l18.127" class="difflineminus">-</span>
<a href="#l18.128"></a><span id="l18.128" class="difflineminus">-#enigmail-status-bar[signed=&quot;activeConflict&quot;] #enigmail-signed-status {</span>
<a href="#l18.129"></a><span id="l18.129" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigSignActiveConflict.png&quot;);</span>
<a href="#l18.130"></a><span id="l18.130" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.131"></a><span id="l18.131" class="difflineminus">-}</span>
<a href="#l18.132"></a><span id="l18.132" class="difflineminus">-</span>
<a href="#l18.133"></a><span id="l18.133" class="difflineminus">-/***************************************************</span>
<a href="#l18.134"></a><span id="l18.134" class="difflineminus">- *  Icons for compose status bar: encrypted states</span>
<a href="#l18.135"></a><span id="l18.135" class="difflineminus">- ***************************************************/</span>
<a href="#l18.136"></a><span id="l18.136" class="difflineminus">-</span>
<a href="#l18.137"></a><span id="l18.137" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;forceYes&quot;] #enigmail-encrypted-status {</span>
<a href="#l18.138"></a><span id="l18.138" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncForceYes.png&quot;);</span>
<a href="#l18.139"></a><span id="l18.139" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.140"></a><span id="l18.140" class="difflineminus">-}</span>
<a href="#l18.141"></a><span id="l18.141" class="difflineminus">-</span>
<a href="#l18.142"></a><span id="l18.142" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;forceNo&quot;] #enigmail-encrypted-status {</span>
<a href="#l18.143"></a><span id="l18.143" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncForceNo.png&quot;);</span>
<a href="#l18.144"></a><span id="l18.144" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.145"></a><span id="l18.145" class="difflineminus">-}</span>
<a href="#l18.146"></a><span id="l18.146" class="difflineminus">-</span>
<a href="#l18.147"></a><span id="l18.147" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;activeNone&quot;] #enigmail-encrypted-status {</span>
<a href="#l18.148"></a><span id="l18.148" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncActiveNone.png&quot;);</span>
<a href="#l18.149"></a><span id="l18.149" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.150"></a><span id="l18.150" class="difflineminus">-}</span>
<a href="#l18.151"></a><span id="l18.151" class="difflineminus">-</span>
<a href="#l18.152"></a><span id="l18.152" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;activePlus&quot;] #enigmail-encrypted-status {</span>
<a href="#l18.153"></a><span id="l18.153" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncActivePlus.png&quot;);</span>
<a href="#l18.154"></a><span id="l18.154" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.155"></a><span id="l18.155" class="difflineminus">-}</span>
<a href="#l18.156"></a><span id="l18.156" class="difflineminus">-</span>
<a href="#l18.157"></a><span id="l18.157" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;activeMinus&quot;] #enigmail-encrypted-status {</span>
<a href="#l18.158"></a><span id="l18.158" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncActiveMinus.png&quot;);</span>
<a href="#l18.159"></a><span id="l18.159" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.160"></a><span id="l18.160" class="difflineminus">-}</span>
<a href="#l18.161"></a><span id="l18.161" class="difflineminus">-</span>
<a href="#l18.162"></a><span id="l18.162" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;activeConflict&quot;] #enigmail-encrypted-status {</span>
<a href="#l18.163"></a><span id="l18.163" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncActiveConflict.png&quot;);</span>
<a href="#l18.164"></a><span id="l18.164" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.165"></a><span id="l18.165" class="difflineminus">-}</span>
<a href="#l18.166"></a><span id="l18.166" class="difflineminus">-</span>
<a href="#l18.167"></a><span id="l18.167" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;inactiveNone&quot;] #enigmail-encrypted-status {</span>
<a href="#l18.168"></a><span id="l18.168" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncInactiveNone.png&quot;);</span>
<a href="#l18.169"></a><span id="l18.169" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.170"></a><span id="l18.170" class="difflineminus">-}</span>
<a href="#l18.171"></a><span id="l18.171" class="difflineminus">-</span>
<a href="#l18.172"></a><span id="l18.172" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;inactivePlus&quot;] #enigmail-encrypted-status {</span>
<a href="#l18.173"></a><span id="l18.173" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncInactivePlus.png&quot;);</span>
<a href="#l18.174"></a><span id="l18.174" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.175"></a><span id="l18.175" class="difflineminus">-}</span>
<a href="#l18.176"></a><span id="l18.176" class="difflineminus">-</span>
<a href="#l18.177"></a><span id="l18.177" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;inactiveMinus&quot;] #enigmail-encrypted-status {</span>
<a href="#l18.178"></a><span id="l18.178" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncInactiveMinus.png&quot;);</span>
<a href="#l18.179"></a><span id="l18.179" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.180"></a><span id="l18.180" class="difflineminus">-}</span>
<a href="#l18.181"></a><span id="l18.181" class="difflineminus">-</span>
<a href="#l18.182"></a><span id="l18.182" class="difflineminus">-#enigmail-status-bar[encrypted=&quot;inactiveConflict&quot;] #enigmail-encrypted-status {</span>
<a href="#l18.183"></a><span id="l18.183" class="difflineminus">-  list-style-image: url(&quot;chrome://openpgp/skin/enigEncInactiveConflict.png&quot;);</span>
<a href="#l18.184"></a><span id="l18.184" class="difflineminus">-  visibility: visible;</span>
<a href="#l18.185"></a><span id="l18.185" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mail/themes/linux/jar.mn</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mail/themes/linux/jar.mn</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -102,16 +102,18 @@ classic.jar:</span>
<a href="#l19.4"></a><span id="l19.4">   skin/classic/messenger/smime/msgHdrViewSMIMEOverlay.css     (mail/smime/msgHdrViewSMIMEOverlay.css)</span>
<a href="#l19.5"></a><span id="l19.5">   skin/classic/messenger/smime/msgReadSecurityInfo.css        (mail/smime/msgReadSecurityInfo.css)</span>
<a href="#l19.6"></a><span id="l19.6">   skin/classic/messenger/smime/msgCompSecurityInfo.css        (mail/smime/msgCompSecurityInfo.css)</span>
<a href="#l19.7"></a><span id="l19.7">   skin/classic/messenger/smime/certFetchingStatus.css         (mail/smime/certFetchingStatus.css)</span>
<a href="#l19.8"></a><span id="l19.8">   skin/classic/messenger/smime/icons/hdrCryptoNotOk.png       (mail/smime/hdrCryptoNotOk.png)</span>
<a href="#l19.9"></a><span id="l19.9">   skin/classic/messenger/smime/icons/hdrCryptoOk.png          (mail/smime/hdrCryptoOk.png)</span>
<a href="#l19.10"></a><span id="l19.10">   skin/classic/messenger/smime/icons/hdrSignNotOk.png         (mail/smime/hdrSignNotOk.png)</span>
<a href="#l19.11"></a><span id="l19.11">   skin/classic/messenger/smime/icons/hdrSignOk.png            (mail/smime/hdrSignOk.png)</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineplus">+  skin/classic/messenger/smime/icons/hdrSignOkVerified.png    (mail/smime/hdrSignOkVerified.png)</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+  skin/classic/messenger/smime/icons/hdrSignOkUnverified.png  (mail/smime/hdrSignOkUnverified.png)</span>
<a href="#l19.14"></a><span id="l19.14">   skin/classic/messenger/smime/icons/hdrSignUnknown.png       (mail/smime/hdrSignUnknown.png)</span>
<a href="#l19.15"></a><span id="l19.15">   skin/classic/messenger/smime/icons/sbCryptoOk.png           (mail/smime/sbCryptoOk.png)</span>
<a href="#l19.16"></a><span id="l19.16">   skin/classic/messenger/smime/icons/sbSignOk.png             (mail/smime/sbSignOk.png)</span>
<a href="#l19.17"></a><span id="l19.17">   skin/classic/messenger/icons/empty-search-results.png       (mail/icons/empty-search-results.png)</span>
<a href="#l19.18"></a><span id="l19.18">   skin/classic/messenger/icons/secure.png                     (mail/icons/secure.png)</span>
<a href="#l19.19"></a><span id="l19.19">   skin/classic/messenger/icons/spring.png                     (mail/icons/spring.png)</span>
<a href="#l19.20"></a><span id="l19.20">   skin/classic/messenger/icons/insecure.png                   (mail/icons/insecure.png)</span>
<a href="#l19.21"></a><span id="l19.21">   skin/classic/messenger/icons/identity.png                   (mail/icons/identity.png)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1">new file mode 100644</span>
<a href="#l20.2"></a><span id="l20.2">index e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..949b6a4ad60bb2997765991eaf73c7f3b7c718b5</span>
<a href="#l20.3"></a><span id="l20.3">GIT binary patch
literal 9618
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/span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1">new file mode 100644</span>
<a href="#l21.2"></a><span id="l21.2">index e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..ca4150ed26f6eb74740064ab8b553fc21e1e8d39</span>
<a href="#l21.3"></a><span id="l21.3">GIT binary patch
literal 9512
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/span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mail/themes/linux/mail/smime/msgHdrViewSMIMEOverlay.css</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mail/themes/linux/mail/smime/msgHdrViewSMIMEOverlay.css</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -5,16 +5,26 @@</span>
<a href="#l22.4"></a><span id="l22.4"> @namespace url(&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;);</span>
<a href="#l22.5"></a><span id="l22.5"> </span>
<a href="#l22.6"></a><span id="l22.6"> #signedHdrIcon {</span>
<a href="#l22.7"></a><span id="l22.7">   list-style-image: none;</span>
<a href="#l22.8"></a><span id="l22.8">   visibility: visible;</span>
<a href="#l22.9"></a><span id="l22.9">   margin-inline-end: 10px;</span>
<a href="#l22.10"></a><span id="l22.10"> }</span>
<a href="#l22.11"></a><span id="l22.11"> </span>
<a href="#l22.12"></a><span id="l22.12" class="difflineplus">+#signedHdrIcon[signed=&quot;verified&quot;] {</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+  list-style-image: url(&quot;chrome://messenger/skin/smime/icons/hdrSignOkVerified.png&quot;);</span>
<a href="#l22.14"></a><span id="l22.14" class="difflineplus">+  visibility: visible;</span>
<a href="#l22.15"></a><span id="l22.15" class="difflineplus">+}</span>
<a href="#l22.16"></a><span id="l22.16" class="difflineplus">+</span>
<a href="#l22.17"></a><span id="l22.17" class="difflineplus">+#signedHdrIcon[signed=&quot;unverified&quot;] {</span>
<a href="#l22.18"></a><span id="l22.18" class="difflineplus">+  list-style-image: url(&quot;chrome://messenger/skin/smime/icons/hdrSignOkUnverified.png&quot;);</span>
<a href="#l22.19"></a><span id="l22.19" class="difflineplus">+  visibility: visible;</span>
<a href="#l22.20"></a><span id="l22.20" class="difflineplus">+}</span>
<a href="#l22.21"></a><span id="l22.21" class="difflineplus">+</span>
<a href="#l22.22"></a><span id="l22.22"> #signedHdrIcon[signed=&quot;ok&quot;] {</span>
<a href="#l22.23"></a><span id="l22.23">   list-style-image: url(&quot;chrome://messenger/skin/smime/icons/hdrSignOk.png&quot;);</span>
<a href="#l22.24"></a><span id="l22.24">   visibility: visible;</span>
<a href="#l22.25"></a><span id="l22.25"> }</span>
<a href="#l22.26"></a><span id="l22.26"> </span>
<a href="#l22.27"></a><span id="l22.27"> #signedHdrIcon[signed=&quot;unknown&quot;] {</span>
<a href="#l22.28"></a><span id="l22.28">   list-style-image: url(&quot;chrome://messenger/skin/smime/icons/hdrSignUnknown.png&quot;);</span>
<a href="#l22.29"></a><span id="l22.29">   visibility: visible;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mail/themes/osx/jar.mn</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mail/themes/osx/jar.mn</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -121,16 +121,18 @@ classic.jar:</span>
<a href="#l23.4"></a><span id="l23.4">   skin/classic/messenger/smime/smime-compose.css                 (mail/smime/smime-compose.css)</span>
<a href="#l23.5"></a><span id="l23.5">   skin/classic/messenger/smime/msgHdrViewSMIMEOverlay.css        (mail/smime/msgHdrViewSMIMEOverlay.css)</span>
<a href="#l23.6"></a><span id="l23.6">   skin/classic/messenger/smime/msgReadSecurityInfo.css           (mail/smime/msgReadSecurityInfo.css)</span>
<a href="#l23.7"></a><span id="l23.7">   skin/classic/messenger/smime/msgCompSecurityInfo.css           (mail/smime/msgCompSecurityInfo.css)</span>
<a href="#l23.8"></a><span id="l23.8">   skin/classic/messenger/smime/certFetchingStatus.css            (mail/smime/certFetchingStatus.css)</span>
<a href="#l23.9"></a><span id="l23.9">   skin/classic/messenger/smime/icons/sbSignOk.png                (mail/smime/sbSignOk.png)</span>
<a href="#l23.10"></a><span id="l23.10">   skin/classic/messenger/smime/icons/sbCryptoOk.png              (mail/smime/sbCryptoOk.png)</span>
<a href="#l23.11"></a><span id="l23.11">   skin/classic/messenger/smime/icons/hdrSignOk.png               (mail/smime/hdrSignOk.png)</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineplus">+  skin/classic/messenger/smime/icons/hdrSignOkVerified.png       (mail/smime/hdrSignOkVerified.png)</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+  skin/classic/messenger/smime/icons/hdrSignOkUnverified.png     (mail/smime/hdrSignOkUnverified.png)</span>
<a href="#l23.14"></a><span id="l23.14">   skin/classic/messenger/smime/icons/hdrSignUnknown.png          (mail/smime/hdrSignUnknown.png)</span>
<a href="#l23.15"></a><span id="l23.15">   skin/classic/messenger/smime/icons/hdrSignNotOk.png            (mail/smime/hdrSignNotOk.png)</span>
<a href="#l23.16"></a><span id="l23.16">   skin/classic/messenger/smime/icons/hdrCryptoOk.png             (mail/smime/hdrCryptoOk.png)</span>
<a href="#l23.17"></a><span id="l23.17">   skin/classic/messenger/smime/icons/hdrCryptoNotOk.png          (mail/smime/hdrCryptoNotOk.png)</span>
<a href="#l23.18"></a><span id="l23.18">   skin/classic/messenger/icons/twisty-open.gif                   (mail/icons/twisty-open.gif)</span>
<a href="#l23.19"></a><span id="l23.19">   skin/classic/messenger/icons/attachment-deleted.png            (mail/icons/attachment-deleted.png)</span>
<a href="#l23.20"></a><span id="l23.20">   skin/classic/messenger/icons/attachment-deleted-large.png      (mail/icons/attachment-deleted-large.png)</span>
<a href="#l23.21"></a><span id="l23.21">   skin/classic/messenger/icons/check.png                         (mail/icons/check.png)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1">new file mode 100644</span>
<a href="#l24.2"></a><span id="l24.2">index e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..68c725c67568d78a5244ab89fad33f4225a1a632</span>
<a href="#l24.3"></a><span id="l24.3">GIT binary patch
literal 9370
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/span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1">new file mode 100644</span>
<a href="#l25.2"></a><span id="l25.2">index e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..c8dc0d2c87aa5c5c024fd93e44f2ad892ef5e615</span>
<a href="#l25.3"></a><span id="l25.3">GIT binary patch
literal 9197
zc%1E6XIN8Nw+_9C2m&amp;HV35ZlfLMNejLhm9L2uXkd34sKNqJT6}niLTb1yMkyOHrCs
z=|x2WsZyg-MT#`J0q2`&gt;zHjc_`{zE-{V^xcDQoR_y=(2Y*FO8~+^{e+ILyq;3;+NQ
z!wq$&lt;D0fZD31p&lt;FT(j;4h5-O9PcGZo6Ri;bK)jEa3&amp;s--BwoU!foKxO1ppuo6{KSP
z_@Jy|d*3(-Vbjzhs;mPWv-E_W&amp;HApl&amp;c^F6)Sf2iCACk7Fw#=L$L*5Ghj*hgQaWc6
z+}ah$Q5iPYhhvV+R0S&gt;i2W5X-+JyIle*7Sgh7ZKlXSW5^&gt;~+oYjK7dxI`T;_aVeun
zg}+yICiPS0*EGmbN5zm_p(@8KyyHgic%gc4`Rasn?@}PY&lt;&lt;fJ(Ju@Rn4#bf~I{(wu
ztGZWqH#WSclvcbV+v#N*3kTPZe;X(vcnJnEUfdM*I}@Pa-1`83CXjww(0TRz#)|K}
zS(y4_Tb+7DuaZ^m?Ali{a(?}EK+!f4gciO%N_ae%I(fy}$@M8optB~)aiaA8nHgK&lt;
zNk9ox+Pwk%%Pq~a=jMT1v(FvLSHCwLv$of|bOgcXU2T^Y!ApN_L*_&amp;0Qf5iZXJ@M0
zRPOPe6Ik$%{BymRo4D=n-;ZyQOC{gPxVV@XwKu({_-0K1!V)NDCYEcPxdl^!X!}qX
zP0d!9k&lt;xKv=~AVV{df?|AY+J6&lt;9TJL&gt;Mb=r?!BG@5&lt;WIMQL0kxUTu#nwRZDRqstZA
zYf{_d&gt;f6RT7E3pfR2eNjG3)%aHHIl;*y3v&amp;!PX%K-Ev=g2Z0kWqsstc&amp;3s&amp;L?w-N7
z6Y2#`=~xwRB&amp;0{8EG4Y6XHu+_(@S0Y9_Lsl-gL1AIh5bFw~9}QO15&amp;xD7=ddgLm6r
z0G0Rm+n34sPJM2P?7#e}Bv)F^e&lt;6EdjDD2|)7GYAz~fuS&lt;C6YpugiM$bZJk;PKc2d
z=&lt;KD&gt;l6i#{6GO2o*bkTHq^lR#BZfl1xW3yt(zeU1u$So)nJs5FZaMYriwCopk8lJ}
zWcak!`NLF&lt;{4Aw;-;+XwTvIM6+~Pc{*&amp;TIFu2zUX1hWYou0w3Zj)1)h2|pO0FZ28K
zWNrrm$t+b2l^NdK)a4({^lmT!JGG-eb15~pWFBMQd(gT!uO^(lSVSK5d&gt;FSd$@~di
z&amp;HrFYp?Xo_DNE7&amp;Z@GnO9|eiajWRqNew){+7J0so?v9%+Umn|Cpe&gt;48^ye@v&gt;Xa(i
zQlbL@sz*(|H)um-2$h}rqnL{xWPAS%MO&amp;81#1y&amp;jP5v8OA0I@;mi6LpiqD7)lh5ji
z34K|ATDnGM#927DHiA}a8l&gt;A%Gg@#ZOA$^&gt;&amp;$KTR-1GE5e}i2=&amp;Tuw|=Ce9^4B&gt;fH
zEV&lt;x^ZnjEf{)IDQDZbsKIsK{5d14~98wK8EpH{45NP}H}wzrF)9(~Mc_yseift1?(
z3$2Yz5xZ%&lt;8iyFel^(#oS!B^e&gt;G2?Ask~btuYpm2rNE$CyQ~zrB^Rodj&gt;em&lt;DCu+&lt;
znNfr&amp;f;rqGjh%nXXcK)*98Yd4hI~-g^+1W&lt;?_9GCzF4+)esTr9(U~*WmF&gt;~nlm@9%
z%Ov!^e-jIDDat!B6vCQbM%Y6JF4hdar8juZC+{B1A0VPL&lt;qq3&amp;pbg-7%L0_b+MDch
zW&lt;_sH&gt;!#}Jzqjk&amp;?Re(#=EilZATw3hh~@yB?)a-!9KqP~aAlbXR~NOM9E%MvZe_!Q
z6|4q__1uPIo4{76MI%PD9m{6ohqkjySI(!NTf&gt;jOs0Thi(#ILUSa2~g-*%lD;t}F7
zAF!niYutLR9`lN6o$7i1#o;b*JVJ3|r`p?4FJYjRmeXeGSSdX9tXaz~Uh=xxB?Eqf
zy-!n=Y?5`)`KXL@j}_Ejwg_&amp;D_uX4aWQzJCGZE$(%0N1*R9WTI?0qy9Rkn6!)TGD7
ziKQj6iq^703Z@;LbE`o%XF7K36RMTDtIx&lt;0&amp;YGxv^pxb8v%pf9GEzR!m+5^EfQ^Cf
zwD9Tkiag_Yiufmcu(hv-o=IEL^qjQyyVi43Lj8@q8&amp;qWcve}}i+Wojw99J&amp;KbTq!}
z;z=qP)EDj1VquthZ9H#p5jaS=ZwP4&gt;ZEl~TXPVI!9$7y89Y1B+$;6v}d$N&gt;wVx?w=
zwLCWJu~)QGRauk@L)I6+@uu_~?e?4Qx))B9rn#SVnHe_X_&amp;Nkw0h}GQW}00S&amp;a1;Q
ziFNOw$?u)gLwAlT)EGn%5Smjji3ZT-&lt;-5@**^kbyfxIz$BXdm~OS15q$TBvJ&amp;mDs6
zBk(PAqi5b4pB|54+CJPF0^F6-hTnv2@aEZP`M2#p_LYYq;-8&lt;_a*~&gt;iNOB%hjX*&lt;J
z=r-7o;bX-sy9e#j2_|em-0ClYRTtw{AWJKm{+AdZn9JHlR!fm2^o|4=p2R&amp;(&gt;)6ed
z&amp;iMAo2*mG6tQ!!|vzYb_IV0Qna;d8KdA8Yc_rd&amp;2Tu&amp;|Y$c{t9@JLCYclAkASS~5t
zEylv0dfiXlw5xP04|@l69XZuC1Em@cN!Yk&amp;&gt;T&gt;v&lt;drg*kLonWK5@+Wn3$e!0vyIw&gt;
zI%{R0cIj@j?Ra8YLA0X5S?fNaNeb6l#t-S}`e$5&amp;w3*7@`4WEWl$u@6vEql?5-s$S
z_srcSzlI&amp;xT6dSv7N024ye;5jAle&gt;tK5ykkYzMoG!N+`ifwtkc0pZ-+yi7Yt`VmN#
zuBgELu{Y9eUp^hJtk6rabzZ4==e*f=(!-u7s+qGSs~N1}B=2N&gt;s%&lt;P*^6VF)kEN#2
z%}!;9$v$g+rD9Q@L#!;1o-q_G(r}%WIk{P}I$foql^o$CpxJ72bxOZ0T5ir(79F8F
zC(3btnF&lt;UTe#WJg|HG&gt;zqx!X@$GAj?E&lt;d%ynr7tGo7&amp;5r0&amp;h}oDbumS1yUw5fpL*6
z2@9drcW?+D2&gt;F@Ki23Lx9}L$H+q#GLlF&lt;zO&amp;Cr%|nC*gLnLsvAI9+&amp;j;@j3$7Up?Z
z(oV=((p181?({pkYHep(TXzmQzTnb#BbuxQDk86pvu0;3U0Cocdc2Z{V^+_t6@I$R
zkkxB_?+K?yHNl@5;;V*r7gPt?W6vway;wmv%pR61iG8RbGdl_T;U?D27ss*SurAMi
zChi6eCV@#P=l(rZ+O3bTzs$n8*aF!`X7IP8Xgfz5v~&amp;GVZE0EsJBr4z-&amp;U6J;Kdzz
zC+`+3O3br+=pQ-!@sys^Cu?S0l;kS1%d~5E!Sraab(&amp;p)-PL)cuS2&lt;tHG+!D;|Tos
zV&amp;3jltt5L_pd-j|b+q7_Q;Fg;3%r`I#gx6Ee3(wJNLj)$5y^sArw`M8LGnl&amp;OBz*M
zV8{C(e^%rPt7K{&amp;8gOycE0#{bR(L!ETi*V~I5RazIP7L5uQWN;erc-PMFlr7)CCXz
zB-3r-tkQPQeV)#JSGLGEzmYDPEQ2D3%`s{4&gt;F5=6dCoV6XDQuIjQ&gt;)50xZE;e26Tl
zU-7zKw}L*`&lt;MV@v_km$%9b1Z513J^aCqeusxek`4x6Wnx@(A8w-8{0H+LYcjs!7^%
zZGI^KAXGq{UH|Oq00!(jeL3PvcEE?g!J{wmrVVCY)O-frwtP27W=CrL6gcLed&lt;j8S
zq_DBMnkL;CL=SihzKL{yBXe~iZum;2u9UX!RHmDlkP&amp;~YVr1{fK!xIxV@_HLNeXe5
zY#zX&amp;&lt;}GlEi!8V_JVBP9`$=H)GqMx|gK(}=L)Mg%b{6fTz$%Is&gt;dQBakh|&amp;9T(Ki2
zD{&lt;cL)0@Lv&amp;ku#pz7Ax0X)qyGywtaK)^=X39u%_M-jB^{21bUGXIOGeUI%}73&gt;&amp;M)
zurdSF#1MDuL~?yzW7l7$RVq{&amp;yB}9}ZWx@yCEM~x`TO1EJ0}jCtm`(;+CDU3Shl2{
zj&amp;rA%E1!L0tvs&amp;6V!Q@!eGw_QLyoJ{SopE{bwg!wNgya_Xm@mK$-KHQVCQP|wrZs4
zQy^w~7xa|Ilbzc5RiCF9Y^y0|ZeesN{UcXUQe0oH3QcK&amp;bLE5n&lt;BxaEqlYSvkhWr9
zoxj$DQhds8HtACH!Q~l8t9}vOSXa_w&lt;0O+-%ps91d2|1`6D?2IZ9&gt;aGD}U@8IIU({
z!v%dMma&gt;Iokl6M&lt;l&amp;c{VZd`Gw0|q)8!v6I2g%X|bYQ}s#wfAQkpS`z?PDuqa=XI{3
z+e}GYn_JCqOUIJ&amp;TRhT^ZmEV&gt;YPe4}dW+u+rA4Ho3RXILOkktJIVU_`Up8Y`37P1f
z{cICQx7hlgWjjIZtE;=(&amp;gWb=t%BDEtTXv^&lt;y&gt;xB*fKBWKnFn4_pdEO)rYTq%|_VY
zZ8EcvXP%pq42H%GyYb}Eer7P)TfG;!FdV?Jym_d;WB`nl&amp;npYXyV49)T~N#|0~l|8
zmW_GTKcLNilkIz~$AAL8`cnsq5A7LXea35{%g`e=jt_eL)6S%^tw!~~e@UD7yemys
zdfP9zp^NUwJMAB*vGGm)#T8fQoSNbtwykd1-G3RHEo7aom0SF}&amp;vQ`Z#TJTn`$&gt;E)
z(&amp;;V#p$#D?wnG;-!R@$(!VL2Ue#+kE;$LoBFnA(zf77A{uRI*A$ucKLcT%~8t`#=T
z3u9jAwxk_=w)5fAD8^U^!N&lt;IiX7Tm9xjF6go1t1|n#p+?`Q*p5OD`R|im2BC;CarD
z)olX}0N{uYhT_TI)C7j~!b&amp;4hUe0J~5*82GKU6hHcm&amp;b|O$0ilT`@Q{;ic+2VIT&amp;j
zCVWQ06k&gt;|kLAzlLFZ-aaFPqsQFMA-NC}9nCW&gt;pf5LV!gR5kL~w6GwoN)PxUsVU*{6
zHCPyU03mv)3EP`m0Cl{4&amp;_H=&lt;d1(kpkA(4)6;@{ks`{W@U{&lt;&gt;Nzfn*mHDNa*5f1}{
z{r&amp;x={pF;+d|bgYP$(1(kp;`jf+z?O;S!FBAc1g%llv4uIdstkqz@%;7%v=fUq(24
z`4ZKHg(&gt;a8-^ll~sz)OJ?qFX&amp;peGPfU^qpPrvys@fMp&gt;NWe`LbBnt)qYENl3HT~Th
zNBAv^lzf6o2s~Iu8Un^*|71ZR&gt;iH4&gt;-hyC58E~)_n&amp;9Q@gGB53p&gt;f2Mzf#~meF?uZ
z_!7|js)M*aQ7&amp;LgPzOA}+8Dr1E&amp;h~7R}2&lt;^V6l(&gt;6^TOrj&gt;G%&lt;cphL-NHE$Hjim%a
zpfJn)dkX%(I|tx{M8R~ukiPpYa9uUw{QzJnFC+#9J9w0ncR{-#kr0p~R9Oxr??SmC
zC?8xP2vSiAqO2$fafYIQp@QQGL&lt;A0r-lw8yq%jm82o$OWQGy~t%1AjGkUUfY3367F
zmj@w{@=8#YGfD|5gZhQS+y_G`ZG`8qQSDQqC{&amp;6{P_%*zS`ma+lywHlE6OT@lw~1u
zAgDZ4nL;Cjl9yFDpxRF?Ov?hUCM+ur`9ovji6FXo`C!$AO)xlL(jN^r7%bYFh}ch&gt;
zjDoTPL&gt;U5+qc~GgR8;;0WQX=4P^xyHQwAdavjK&amp;K=~D&lt;1l;Xi)5w2)39_RY6&amp;cJkh
z&amp;&lt;LWJkByg?r&lt;(9S1#sW;U@8Dre=BmBi5C*FKN$|dXw*UD&amp;zYi)a0UOwg8vTuA57M6
zUjDfM9nT-o-&amp;wSLi2hza9_Bvg&amp;hBU=@$Y&amp;53j8~h73Cd8Ao^T_{|}w|H=OFvIxwW@
zynHVGVrq@{{we(wJuyE8;KAgDA&amp;|s_!66|0&amp;_C&lt;x_a&gt;wp0_TdRyd}YZ)?@ynT9xIX
zP&lt;cv?QEC*e43dXHWkAl(5ND8!th|Dv0&gt;lO3f&lt;ph9h2Z5v^hfxhwOlFHN*QO$v^f}O
zp!h+NN&amp;Fe@?}nxXDFu;%K_J55-+BlBwR@`I|4e}D{;LEA-&gt;)!hUp(FugZBAzV*ZuW
z{|5Jq{clD2Kbiju`)RG?g{OS2ySfq0{c(Tm{x5((8B8!pG&gt;-7MzJG=MOv^9p#r`q`
z{%swiENkH3*R|iu;{W*g$H_lV{&amp;Dh;lYgB2&lt;K!PF|F4`d|FJVh&lt;0v0`{*-+$Y-=-s
zvS+4uHa5@&amp;?Ct+DYjYDR8YaBqSpooXcwqme(iXo&lt;q9_@Na8o^oX`17l0Fg2v&amp;u5B;
z1+J@Q&lt;2E*v8f0NJz}2d;u^`&gt;q8;;hJ_#P^#{UF;+DiY4i@h}Vpv+gS~WwYSuYcESx
zgy-I?P=pVgSewFla{J`_1V#IvP+^TsVXp+?EjdV{EH&gt;+Xl5=Jj^~yP|CNSE6y!Ls}
zJau((y`*joRL*s*=YxN5!1%Y98zY2XE(edoY(}BN&amp;)*8Js7{Ll+xM!EDa(1&gt;FYh0)
zX}YBlOk3vIOG`TyaYU2$^-(~e?(?2wfm5*DAIwf#jN7pK6*yykcj6!!kXo8dtEBb=
z)mW~%F`t|fq}&amp;bSvEI2uFW=KIi5HSq?7yneaD;_*XdlA~xf0G&amp;-os0C`dH|7fvqaF
z_L(ZlkE1xHbN6?{S1xyd#x0~w*7cmtr=h)l+xE1SgOOH4LLBFnGiSJ~H|F)i&amp;QS5E
zHmftHr&lt;IF{XHPf8oPfR=H1u7Qrl+S@Kf2r+Ticsgw0nDU(%HoNDI}tXX*Ilfz(meh
zJG#x^DlsT5?Mh&lt;Wj+kgyNmv-EKY6URaW%Z=d}Zj?R&gt;WDF#jm8nT32v+`CfKSO?1u3
zNU=3t@uhSu&lt;M$6-H7&amp;-P*Mc^$z;uP*Fbdh*l_f&gt;564w`pTidO3UzC!#;^X7bu)NI8
zy&lt;YczUK9k1xp`AI-!88%ndw{wHS0%2Cc}5d&lt;+{$Dt+`#UnaK2%`r!I3&amp;z^Kte^DM#
zR5U^ZSM;bd8$BsPbezuJ4r*T+AMIQ}S@foVKyBiFRn=6@3fVoGi_3fC!l}UJhF)eJ
z&amp;Sj*N^eu*+-Dmn&lt;ojr7cC!FHzX@q##lK2bk?8Zt$^7BnD2JM&lt;Y&lt;3@WAV&gt;?Ui^HnRz
z60GSvVik|XM=)vRxr)-Yd)Sd@nYYGAzR6pq)vWbvxOpsPmaVEMB(~gH?9;EO9;9N|
z$47|yem6|JCY8k;$yAJU@g1$pK?V2oW^?8wJ&lt;7?kvb5~^_*(B`Vg4k3*OFDC_WD;k
z2FcM_kowV7j6slent$5Z6w!mjR&gt;e&lt;te!bWaE5XFXlwy^Y#9OeN&gt;l6%7q#D(%)1WfT
z-u*E;!L4(-`c(&lt;tU2(=@K79uAk&amp;|p?Nz8poBvXzef0M&amp;aPVb-EPS0G8;2t9}v3u#*
zhj?&amp;Cy=Rs_5x20#R9Sh6lbicw7~{&amp;6f@w`ox;w`z&lt;1)*~l~N~IIrV0}I#8;uPtXT&lt;
zs$(V8yS+3d;0vnF-N=J~H9P68c)=T^iLWF#EVfCW%UA!&lt;7?eHJG$NZJyfNfjcQHcb
zEM^IMT_}HbZG(e@KZcDO!N`JeI!-ObX%v2*YAQIl5HbMUK@QL?8(oz5L#pV%=G+p&lt;
zo8uJ&amp;DcrU)l!&amp;)-PE%jITuUVSdGC&lt;a?DAstK1A88*Rf6Ix8JG&gt;8&lt;3P);C+5U7R91-
z=lV8xk&amp;v`{Yzv1N2B+RsJUq4GN-^Fu3P;u7p(3-`4J&amp;BoABhfRk2*ely7Il2-N0^O
zhr=*;F#GM*wY5Hran14TS0A~eJ{lQmOLjku64YF)iuZ#|(dG2zzAa&gt;@xp~)G!#w@u
z{jU7ekF4GWS@eEbB#?GLW~V1nNx9nNbZNqEW(tM+9n{^|zC@+3d8YX3JV*k6tsK2L
zG&amp;FqtlOXWasc_}%$RvIv3`_OBnQw=ntBZ9)A6ho~I1Cc6WsgqxZyLj6;W}wYo7lSU
zsc^f7Bo;23T@DCHRq_&amp;GH5frr*~?Geoa-698(DEh;{~(ziOv4@WDHGadCvAc6gH${
zXhKX#Or+6{o(W^OO&lt;Uqr?NWLh0DTt_cA&lt;6MIw`4l*Z+=lRJ68-g~K&amp;PHV0%}Sz&gt;%V
zJSa%8yW6z61=_Yt^n2_NPxl6NSPM2ww(Oiw2zrqJ5|*Ds8CrgUxI5|Te8ThW;xiAQ
zvI%Q8uu-#wrigI+R~m`8OK5$suGT(&amp;{KwpPZ?oLQFj_HkRW&lt;bT&gt;Q$De&lt;Go?^=&lt;NR9
zNH@UCG=S6vh&amp;bY$R64KeH1&gt;ys6IEPJu#~V$@YcPu&gt;N+03Gs;p@p^VjPj~&amp;V9=;YIa
z^ZMOP+p;}r^Vz7cfw$w%9}a@&gt;d8dkJD=)8KgAXUwFVqKSvIQ4C(yZCD4N79VYp#&lt;&gt;
zOJaS|#{UNVtdVOTVVL}Nw2$1x9L(0Zo#$8w)FddxGKB#O3{IpYSQtGcK1|#&amp;A&lt;dS&gt;
zF)4cH-(~0zzB}SBb%J+{wR6pv2(e&lt;g(l40Q45UwjPK&gt;&gt;Cx-}{=*uSEq_-M4J@e`O%
zq?VrbqJ87Hdv|c@06&gt;yh&lt;A6FBUzqVz{%XS}wv#F}iBtrcxf5T!k_wko=2eeW!!+ry
z6pJHSR5hDE{^+FI`^pTc?&gt;S^KO69`XUvao8XEs!6sIp#nvyYBcE|&lt;cDqZ&gt;Zw`tDer
z01CV;7{s~^@S^p@g`iq5;q4P8;1@&amp;K6j|2=W-s_FEjOUandVzxzwc4SBzKB8R*r4$
P{|yb-Gt({9b_)3~HWzeZ</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mail/themes/osx/mail/smime/msgHdrViewSMIMEOverlay.css</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mail/themes/osx/mail/smime/msgHdrViewSMIMEOverlay.css</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -4,16 +4,26 @@</span>
<a href="#l26.4"></a><span id="l26.4"> </span>
<a href="#l26.5"></a><span id="l26.5"> @namespace url(&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;);</span>
<a href="#l26.6"></a><span id="l26.6"> </span>
<a href="#l26.7"></a><span id="l26.7"> #signedHdrIcon {</span>
<a href="#l26.8"></a><span id="l26.8">   list-style-image: none;</span>
<a href="#l26.9"></a><span id="l26.9">   visibility: visible;</span>
<a href="#l26.10"></a><span id="l26.10"> }</span>
<a href="#l26.11"></a><span id="l26.11"> </span>
<a href="#l26.12"></a><span id="l26.12" class="difflineplus">+#signedHdrIcon[signed=&quot;verified&quot;] {</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+  list-style-image: url(&quot;chrome://messenger/skin/smime/icons/hdrSignOkVerified.png&quot;);</span>
<a href="#l26.14"></a><span id="l26.14" class="difflineplus">+  visibility: visible;</span>
<a href="#l26.15"></a><span id="l26.15" class="difflineplus">+}</span>
<a href="#l26.16"></a><span id="l26.16" class="difflineplus">+</span>
<a href="#l26.17"></a><span id="l26.17" class="difflineplus">+#signedHdrIcon[signed=&quot;unverified&quot;] {</span>
<a href="#l26.18"></a><span id="l26.18" class="difflineplus">+  list-style-image: url(&quot;chrome://messenger/skin/smime/icons/hdrSignOkUnverified.png&quot;);</span>
<a href="#l26.19"></a><span id="l26.19" class="difflineplus">+  visibility: visible;</span>
<a href="#l26.20"></a><span id="l26.20" class="difflineplus">+}</span>
<a href="#l26.21"></a><span id="l26.21" class="difflineplus">+</span>
<a href="#l26.22"></a><span id="l26.22"> #signedHdrIcon[signed=&quot;ok&quot;] {</span>
<a href="#l26.23"></a><span id="l26.23">   list-style-image: url(&quot;chrome://messenger/skin/smime/icons/hdrSignOk.png&quot;);</span>
<a href="#l26.24"></a><span id="l26.24">   visibility: visible;</span>
<a href="#l26.25"></a><span id="l26.25"> }</span>
<a href="#l26.26"></a><span id="l26.26"> </span>
<a href="#l26.27"></a><span id="l26.27"> #signedHdrIcon[signed=&quot;unknown&quot;] {</span>
<a href="#l26.28"></a><span id="l26.28">   list-style-image: url(&quot;chrome://messenger/skin/smime/icons/hdrSignUnknown.png&quot;);</span>
<a href="#l26.29"></a><span id="l26.29">   visibility: visible;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mail/themes/windows/jar.mn</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mail/themes/windows/jar.mn</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -95,16 +95,18 @@ classic.jar:</span>
<a href="#l27.4"></a><span id="l27.4">   skin/classic/messenger/smime/msgHdrViewSMIMEOverlay.css     (mail/smime/msgHdrViewSMIMEOverlay.css)</span>
<a href="#l27.5"></a><span id="l27.5">   skin/classic/messenger/smime/msgReadSecurityInfo.css        (mail/smime/msgReadSecurityInfo.css)</span>
<a href="#l27.6"></a><span id="l27.6">   skin/classic/messenger/smime/msgCompSecurityInfo.css        (mail/smime/msgCompSecurityInfo.css)</span>
<a href="#l27.7"></a><span id="l27.7">   skin/classic/messenger/smime/certFetchingStatus.css         (mail/smime/certFetchingStatus.css)</span>
<a href="#l27.8"></a><span id="l27.8">   skin/classic/messenger/smime/icons/hdrCryptoNotOk.png       (mail/smime/hdrCryptoNotOk.png)</span>
<a href="#l27.9"></a><span id="l27.9">   skin/classic/messenger/smime/icons/hdrCryptoOk.png          (mail/smime/hdrCryptoOk.png)</span>
<a href="#l27.10"></a><span id="l27.10">   skin/classic/messenger/smime/icons/hdrSignNotOk.png         (mail/smime/hdrSignNotOk.png)</span>
<a href="#l27.11"></a><span id="l27.11">   skin/classic/messenger/smime/icons/hdrSignOk.png            (mail/smime/hdrSignOk.png)</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineplus">+  skin/classic/messenger/smime/icons/hdrSignOkVerified.png    (mail/smime/hdrSignOkVerified.png)</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+  skin/classic/messenger/smime/icons/hdrSignOkUnverified.png  (mail/smime/hdrSignOkUnverified.png)</span>
<a href="#l27.14"></a><span id="l27.14">   skin/classic/messenger/smime/icons/hdrSignUnknown.png       (mail/smime/hdrSignUnknown.png)</span>
<a href="#l27.15"></a><span id="l27.15">   skin/classic/messenger/smime/icons/sbCryptoOk.png           (mail/smime/sbCryptoOk.png)</span>
<a href="#l27.16"></a><span id="l27.16">   skin/classic/messenger/smime/icons/sbSignOk.png             (mail/smime/sbSignOk.png)</span>
<a href="#l27.17"></a><span id="l27.17">   skin/classic/messenger/icons/zoomout.png                    (mail/icons/zoomout.png)</span>
<a href="#l27.18"></a><span id="l27.18">   skin/classic/messenger/icons/zoomout-hover.png              (mail/icons/zoomout-hover.png)</span>
<a href="#l27.19"></a><span id="l27.19">   skin/classic/messenger/icons/readmail.png                   (mail/icons/readmail.png)</span>
<a href="#l27.20"></a><span id="l27.20">   skin/classic/messenger/icons/folder.png                     (mail/icons/folder.png)</span>
<a href="#l27.21"></a><span id="l27.21">   skin/classic/messenger/icons/message.png                    (mail/icons/message.png)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1">new file mode 100644</span>
<a href="#l28.2"></a><span id="l28.2">index e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..59f5f8667ce3585b35e4029a11ebf43ba6c50fa5</span>
<a href="#l28.3"></a><span id="l28.3">GIT binary patch
literal 9008
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/span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1">new file mode 100644</span>
<a href="#l29.2"></a><span id="l29.2">index e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..c439f079549820d56c2d40aac435062237aee40a</span>
<a href="#l29.3"></a><span id="l29.3">GIT binary patch
literal 8886
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
F{{@&lt;!yG;N9</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/mail/themes/windows/mail/smime/msgHdrViewSMIMEOverlay.css</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/mail/themes/windows/mail/smime/msgHdrViewSMIMEOverlay.css</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -10,16 +10,24 @@</span>
<a href="#l30.4"></a><span id="l30.4">   margin-inline-end: 10px;</span>
<a href="#l30.5"></a><span id="l30.5"> }</span>
<a href="#l30.6"></a><span id="l30.6"> </span>
<a href="#l30.7"></a><span id="l30.7"> #encryptedHdrIcon {</span>
<a href="#l30.8"></a><span id="l30.8">   list-style-image: none;</span>
<a href="#l30.9"></a><span id="l30.9">   visibility: visible;</span>
<a href="#l30.10"></a><span id="l30.10"> }</span>
<a href="#l30.11"></a><span id="l30.11"> </span>
<a href="#l30.12"></a><span id="l30.12" class="difflineplus">+#signedHdrIcon[signed=&quot;verified&quot;] {</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineplus">+  list-style-image: url(&quot;chrome://messenger/skin/smime/icons/hdrSignOkVerified.png&quot;);</span>
<a href="#l30.14"></a><span id="l30.14" class="difflineplus">+}</span>
<a href="#l30.15"></a><span id="l30.15" class="difflineplus">+</span>
<a href="#l30.16"></a><span id="l30.16" class="difflineplus">+#signedHdrIcon[signed=&quot;unverified&quot;] {</span>
<a href="#l30.17"></a><span id="l30.17" class="difflineplus">+  list-style-image: url(&quot;chrome://messenger/skin/smime/icons/hdrSignOkUnverified.png&quot;);</span>
<a href="#l30.18"></a><span id="l30.18" class="difflineplus">+}</span>
<a href="#l30.19"></a><span id="l30.19" class="difflineplus">+</span>
<a href="#l30.20"></a><span id="l30.20"> #signedHdrIcon[signed=&quot;ok&quot;] {</span>
<a href="#l30.21"></a><span id="l30.21">   list-style-image: url(&quot;chrome://messenger/skin/smime/icons/hdrSignOk.png&quot;);</span>
<a href="#l30.22"></a><span id="l30.22"> }</span>
<a href="#l30.23"></a><span id="l30.23"> </span>
<a href="#l30.24"></a><span id="l30.24"> #signedHdrIcon[signed=&quot;unknown&quot;] {</span>
<a href="#l30.25"></a><span id="l30.25">   list-style-image: url(&quot;chrome://messenger/skin/smime/icons/hdrSignUnknown.png&quot;);</span>
<a href="#l30.26"></a><span id="l30.26"> }</span>
<a href="#l30.27"></a><span id="l30.27"> </span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:33Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

