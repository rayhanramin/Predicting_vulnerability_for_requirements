<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 22413:c38974cf236ed69bd7d45c938ec39a4f955233be</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ c38974cf236ed69bd7d45c938ec39a4f955233be" />
<meta property="og:url" content="/comm-central/rev/c38974cf236ed69bd7d45c938ec39a4f955233be" />
<meta property="og:description" content="Bug 1411069 - Port bug 1313150 to mailnews: Remove |weak| parameter from nsIMutableArray methods. rs=bustage-fix" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / c38974cf236ed69bd7d45c938ec39a4f955233be 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/c38974cf236ed69bd7d45c938ec39a4f955233be">shortlog</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/c38974cf236ed69bd7d45c938ec39a4f955233be">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be">files</a> |
changeset |
<a href="/comm-central/raw-rev/c38974cf236ed69bd7d45c938ec39a4f955233be">raw</a>  | <a href="/comm-central/archive/c38974cf236ed69bd7d45c938ec39a4f955233be.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1411069">Bug 1411069</a> - Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1313150">bug 1313150</a> to mailnews: Remove |weak| parameter from nsIMutableArray methods. rs=bustage-fix
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#74;&#111;&#114;&#103;&#32;&#75;&#32;&#60;&#106;&#111;&#114;&#103;&#107;&#64;&#106;&#111;&#114;&#103;&#107;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 24 Oct 2017 00:58:59 +0200</td></tr>

<tr>
 <td>changeset 22413</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/c38974cf236ed69bd7d45c938ec39a4f955233be">c38974cf236ed69bd7d45c938ec39a4f955233be</a></td>
</tr>



<tr>
<td>parent 22412</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/773c0fd4b6239864864e5f51bb3dff801843f2eb">773c0fd4b6239864864e5f51bb3dff801843f2eb</a>
</td>
</tr>

<tr>
<td>child 22414</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/dd1d559aeb262e3aac32d5da7d2ff5b31e7b3079">dd1d559aeb262e3aac32d5da7d2ff5b31e7b3079</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=c38974cf236ed69bd7d45c938ec39a4f955233be">13664</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Mon, 23 Oct 2017 23:40:33 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@dd1d559aeb26 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=dd1d559aeb262e3aac32d5da7d2ff5b31e7b3079">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=dd1d559aeb262e3aac32d5da7d2ff5b31e7b3079&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=dd1d559aeb262e3aac32d5da7d2ff5b31e7b3079&newProject=comm-central&newRevision=c38974cf236ed69bd7d45c938ec39a4f955233be&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=dd1d559aeb262e3aac32d5da7d2ff5b31e7b3079&newProject=comm-central&newRevision=c38974cf236ed69bd7d45c938ec39a4f955233be&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=dd1d559aeb262e3aac32d5da7d2ff5b31e7b3079&newProject=comm-central&newRevision=c38974cf236ed69bd7d45c938ec39a4f955233be&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28bustage-fix%29&revcount=50">bustage-fix</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1411069">1411069</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1313150">1313150</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1411069">Bug 1411069</a> - Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1313150">bug 1313150</a> to mailnews: Remove |weak| parameter from nsIMutableArray methods. rs=bustage-fix
Affected: AppendElement(), InsertElementAt(), ReplaceElementAt().</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mail/components/migration/src/nsNetscapeProfileMigratorBase.cpp">mail/components/migration/src/nsNetscapeProfileMigratorBase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mail/components/migration/src/nsNetscapeProfileMigratorBase.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mail/components/migration/src/nsNetscapeProfileMigratorBase.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mail/components/migration/src/nsNetscapeProfileMigratorBase.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mail/components/migration/src/nsNetscapeProfileMigratorBase.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mail/components/migration/src/nsNetscapeProfileMigratorBase.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mail/components/migration/src/nsProfileMigrator.cpp">mail/components/migration/src/nsProfileMigrator.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mail/components/migration/src/nsProfileMigrator.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mail/components/migration/src/nsProfileMigrator.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mail/components/migration/src/nsProfileMigrator.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mail/components/migration/src/nsProfileMigrator.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mail/components/migration/src/nsProfileMigrator.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbLDAPCard.cpp">mailnews/addrbook/src/nsAbLDAPCard.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbLDAPCard.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbLDAPCard.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbLDAPCard.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbLDAPCard.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbLDAPCard.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbMDBDirProperty.cpp">mailnews/addrbook/src/nsAbMDBDirProperty.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbMDBDirProperty.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbMDBDirProperty.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbMDBDirProperty.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbMDBDirProperty.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbMDBDirProperty.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbMDBDirectory.cpp">mailnews/addrbook/src/nsAbMDBDirectory.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbMDBDirectory.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbMDBDirectory.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbMDBDirectory.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbMDBDirectory.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbMDBDirectory.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOSXDirectory.mm">mailnews/addrbook/src/nsAbOSXDirectory.mm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOSXDirectory.mm">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOSXDirectory.mm">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOSXDirectory.mm">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOSXDirectory.mm">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOSXDirectory.mm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOutlookDirFactory.cpp">mailnews/addrbook/src/nsAbOutlookDirFactory.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOutlookDirFactory.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOutlookDirFactory.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOutlookDirFactory.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOutlookDirFactory.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOutlookDirFactory.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOutlookDirectory.cpp">mailnews/addrbook/src/nsAbOutlookDirectory.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOutlookDirectory.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOutlookDirectory.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOutlookDirectory.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOutlookDirectory.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbOutlookDirectory.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbQueryStringToExpression.cpp">mailnews/addrbook/src/nsAbQueryStringToExpression.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbQueryStringToExpression.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbQueryStringToExpression.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbQueryStringToExpression.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbQueryStringToExpression.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbQueryStringToExpression.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbView.cpp">mailnews/addrbook/src/nsAbView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbView.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbView.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbView.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbView.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAbView.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAddrDatabase.cpp">mailnews/addrbook/src/nsAddrDatabase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAddrDatabase.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAddrDatabase.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAddrDatabase.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAddrDatabase.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/addrbook/src/nsAddrDatabase.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgFilter.cpp">mailnews/base/search/src/nsMsgFilter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgFilter.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgFilter.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgFilter.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgFilter.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgFilter.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgFilterService.cpp">mailnews/base/search/src/nsMsgFilterService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgFilterService.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgFilterService.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgFilterService.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgFilterService.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgFilterService.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgSearchSession.cpp">mailnews/base/search/src/nsMsgSearchSession.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgSearchSession.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgSearchSession.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgSearchSession.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgSearchSession.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/search/src/nsMsgSearchSession.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessenger.cpp">mailnews/base/src/nsMessenger.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessenger.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessenger.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessenger.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessenger.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessenger.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerBootstrap.cpp">mailnews/base/src/nsMessengerBootstrap.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerBootstrap.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerBootstrap.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerBootstrap.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerBootstrap.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerBootstrap.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerUnixIntegration.cpp">mailnews/base/src/nsMessengerUnixIntegration.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerUnixIntegration.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerUnixIntegration.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerUnixIntegration.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerUnixIntegration.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerUnixIntegration.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerWinIntegration.cpp">mailnews/base/src/nsMessengerWinIntegration.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerWinIntegration.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerWinIntegration.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerWinIntegration.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerWinIntegration.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMessengerWinIntegration.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccount.cpp">mailnews/base/src/nsMsgAccount.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccount.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccount.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccount.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccount.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccount.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccountManager.cpp">mailnews/base/src/nsMsgAccountManager.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccountManager.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccountManager.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccountManager.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccountManager.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccountManager.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccountManagerDS.cpp">mailnews/base/src/nsMsgAccountManagerDS.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccountManagerDS.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccountManagerDS.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccountManagerDS.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccountManagerDS.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgAccountManagerDS.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgCopyService.cpp">mailnews/base/src/nsMsgCopyService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgCopyService.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgCopyService.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgCopyService.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgCopyService.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgCopyService.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgDBView.cpp">mailnews/base/src/nsMsgDBView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgDBView.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgDBView.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgDBView.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgDBView.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgDBView.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgFolderDataSource.cpp">mailnews/base/src/nsMsgFolderDataSource.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgFolderDataSource.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgFolderDataSource.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgFolderDataSource.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgFolderDataSource.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgFolderDataSource.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgProgress.cpp">mailnews/base/src/nsMsgProgress.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgProgress.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgProgress.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgProgress.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgProgress.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgProgress.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgPurgeService.cpp">mailnews/base/src/nsMsgPurgeService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgPurgeService.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgPurgeService.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgPurgeService.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgPurgeService.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgPurgeService.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgQuickSearchDBView.cpp">mailnews/base/src/nsMsgQuickSearchDBView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgQuickSearchDBView.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgQuickSearchDBView.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgQuickSearchDBView.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgQuickSearchDBView.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgQuickSearchDBView.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgSearchDBView.cpp">mailnews/base/src/nsMsgSearchDBView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgSearchDBView.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgSearchDBView.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgSearchDBView.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgSearchDBView.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/src/nsMsgSearchDBView.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsImapMoveCoalescer.cpp">mailnews/base/util/nsImapMoveCoalescer.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsImapMoveCoalescer.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsImapMoveCoalescer.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsImapMoveCoalescer.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsImapMoveCoalescer.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsImapMoveCoalescer.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgDBFolder.cpp">mailnews/base/util/nsMsgDBFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgDBFolder.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgDBFolder.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgDBFolder.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgDBFolder.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgDBFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgIncomingServer.cpp">mailnews/base/util/nsMsgIncomingServer.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgIncomingServer.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgIncomingServer.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgIncomingServer.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgIncomingServer.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgIncomingServer.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgReadStateTxn.cpp">mailnews/base/util/nsMsgReadStateTxn.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgReadStateTxn.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgReadStateTxn.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgReadStateTxn.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgReadStateTxn.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgReadStateTxn.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgUtils.cpp">mailnews/base/util/nsMsgUtils.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgUtils.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgUtils.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgUtils.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgUtils.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/base/util/nsMsgUtils.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgCompose.cpp">mailnews/compose/src/nsMsgCompose.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgCompose.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgCompose.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgCompose.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgCompose.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgCompose.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgSend.cpp">mailnews/compose/src/nsMsgSend.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgSend.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgSend.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgSend.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgSend.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgSend.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgSendLater.cpp">mailnews/compose/src/nsMsgSendLater.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgSendLater.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgSendLater.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgSendLater.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgSendLater.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/compose/src/nsMsgSendLater.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/db/msgdb/src/nsMsgDatabase.cpp">mailnews/db/msgdb/src/nsMsgDatabase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/db/msgdb/src/nsMsgDatabase.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/db/msgdb/src/nsMsgDatabase.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/db/msgdb/src/nsMsgDatabase.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/db/msgdb/src/nsMsgDatabase.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/db/msgdb/src/nsMsgDatabase.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">mailnews/extensions/smime/src/nsMsgComposeSecure.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsAutoSyncState.cpp">mailnews/imap/src/nsAutoSyncState.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsAutoSyncState.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsAutoSyncState.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsAutoSyncState.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsAutoSyncState.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsAutoSyncState.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsImapMailFolder.cpp">mailnews/imap/src/nsImapMailFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsImapMailFolder.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsImapMailFolder.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsImapMailFolder.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsImapMailFolder.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsImapMailFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsImapOfflineSync.cpp">mailnews/imap/src/nsImapOfflineSync.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsImapOfflineSync.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsImapOfflineSync.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsImapOfflineSync.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsImapOfflineSync.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/imap/src/nsImapOfflineSync.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/applemail/src/nsAppleMailImport.cpp">mailnews/import/applemail/src/nsAppleMailImport.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/applemail/src/nsAppleMailImport.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/applemail/src/nsAppleMailImport.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/applemail/src/nsAppleMailImport.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/applemail/src/nsAppleMailImport.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/applemail/src/nsAppleMailImport.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/becky/src/nsBeckyAddressBooks.cpp">mailnews/import/becky/src/nsBeckyAddressBooks.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/becky/src/nsBeckyAddressBooks.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/becky/src/nsBeckyAddressBooks.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/becky/src/nsBeckyAddressBooks.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/becky/src/nsBeckyAddressBooks.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/becky/src/nsBeckyAddressBooks.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/becky/src/nsBeckyMail.cpp">mailnews/import/becky/src/nsBeckyMail.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/becky/src/nsBeckyMail.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/becky/src/nsBeckyMail.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/becky/src/nsBeckyMail.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/becky/src/nsBeckyMail.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/becky/src/nsBeckyMail.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/MapiMessage.cpp">mailnews/import/outlook/src/MapiMessage.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/MapiMessage.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/MapiMessage.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/MapiMessage.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/MapiMessage.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/MapiMessage.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/nsOutlookCompose.cpp">mailnews/import/outlook/src/nsOutlookCompose.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/nsOutlookCompose.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/nsOutlookCompose.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/nsOutlookCompose.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/nsOutlookCompose.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/nsOutlookCompose.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/nsOutlookMail.cpp">mailnews/import/outlook/src/nsOutlookMail.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/nsOutlookMail.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/nsOutlookMail.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/nsOutlookMail.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/nsOutlookMail.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/outlook/src/nsOutlookMail.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/text/src/nsTextImport.cpp">mailnews/import/text/src/nsTextImport.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/text/src/nsTextImport.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/text/src/nsTextImport.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/text/src/nsTextImport.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/text/src/nsTextImport.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/text/src/nsTextImport.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/vcard/src/nsVCardImport.cpp">mailnews/import/vcard/src/nsVCardImport.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/vcard/src/nsVCardImport.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/vcard/src/nsVCardImport.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/vcard/src/nsVCardImport.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/vcard/src/nsVCardImport.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/import/vcard/src/nsVCardImport.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsLocalMailFolder.cpp">mailnews/local/src/nsLocalMailFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsLocalMailFolder.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsLocalMailFolder.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsLocalMailFolder.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsLocalMailFolder.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsLocalMailFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsLocalUndoTxn.cpp">mailnews/local/src/nsLocalUndoTxn.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsLocalUndoTxn.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsLocalUndoTxn.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsLocalUndoTxn.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsLocalUndoTxn.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsLocalUndoTxn.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsMsgMaildirStore.cpp">mailnews/local/src/nsMsgMaildirStore.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsMsgMaildirStore.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsMsgMaildirStore.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsMsgMaildirStore.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsMsgMaildirStore.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsMsgMaildirStore.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsParseMailbox.cpp">mailnews/local/src/nsParseMailbox.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsParseMailbox.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsParseMailbox.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsParseMailbox.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsParseMailbox.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/local/src/nsParseMailbox.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/news/src/nsNNTPNewsgroupList.cpp">mailnews/news/src/nsNNTPNewsgroupList.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/news/src/nsNNTPNewsgroupList.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/news/src/nsNNTPNewsgroupList.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/news/src/nsNNTPNewsgroupList.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/news/src/nsNNTPNewsgroupList.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/news/src/nsNNTPNewsgroupList.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/news/src/nsNewsFolder.cpp">mailnews/news/src/nsNewsFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/news/src/nsNewsFolder.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/news/src/nsNewsFolder.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/news/src/nsNewsFolder.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/news/src/nsNewsFolder.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/mailnews/news/src/nsNewsFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp">suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/c38974cf236ed69bd7d45c938ec39a4f955233be/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp">file</a> |
<a href="/comm-central/annotate/c38974cf236ed69bd7d45c938ec39a4f955233be/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp">annotate</a> |
<a href="/comm-central/diff/c38974cf236ed69bd7d45c938ec39a4f955233be/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp">diff</a> |
<a href="/comm-central/comparison/c38974cf236ed69bd7d45c938ec39a4f955233be/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp">comparison</a> |
<a href="/comm-central/log/c38974cf236ed69bd7d45c938ec39a4f955233be/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/components/migration/src/nsNetscapeProfileMigratorBase.cpp</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/components/migration/src/nsNetscapeProfileMigratorBase.cpp</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -98,23 +98,23 @@ nsNetscapeProfileMigratorBase::GetProfil</span>
<a href="#l1.4"></a><span id="l1.4">                       rootDir-&gt;SetPersistentDescriptor(filePath);</span>
<a href="#l1.5"></a><span id="l1.5">     if (NS_FAILED(rv))</span>
<a href="#l1.6"></a><span id="l1.6">       continue;</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8">     bool exists = false;</span>
<a href="#l1.9"></a><span id="l1.9">     rootDir-&gt;Exists(&amp;exists);</span>
<a href="#l1.10"></a><span id="l1.10"> </span>
<a href="#l1.11"></a><span id="l1.11">     if (exists) {</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-      aProfileLocations-&gt;AppendElement(rootDir, false);</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+      aProfileLocations-&gt;AppendElement(rootDir);</span>
<a href="#l1.14"></a><span id="l1.14"> </span>
<a href="#l1.15"></a><span id="l1.15">       nsCOMPtr&lt;nsISupportsString&gt; profileNameString(</span>
<a href="#l1.16"></a><span id="l1.16">         do_CreateInstance(&quot;@mozilla.org/supports-string;1&quot;));</span>
<a href="#l1.17"></a><span id="l1.17"> </span>
<a href="#l1.18"></a><span id="l1.18">       profileNameString-&gt;SetData(NS_ConvertUTF8toUTF16(buffer));</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineminus">-      aProfileNames-&gt;AppendElement(profileNameString, false);</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineplus">+      aProfileNames-&gt;AppendElement(profileNameString);</span>
<a href="#l1.21"></a><span id="l1.21">     }</span>
<a href="#l1.22"></a><span id="l1.22">   }</span>
<a href="#l1.23"></a><span id="l1.23">   return NS_OK;</span>
<a href="#l1.24"></a><span id="l1.24"> }</span>
<a href="#l1.25"></a><span id="l1.25"> </span>
<a href="#l1.26"></a><span id="l1.26"> #define GETPREF(xform, method, value) \</span>
<a href="#l1.27"></a><span id="l1.27">   nsresult rv = aBranch-&gt;method(xform-&gt;sourcePrefName, value); \</span>
<a href="#l1.28"></a><span id="l1.28">   if (NS_SUCCEEDED(rv)) \</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/components/migration/src/nsProfileMigrator.cpp</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/components/migration/src/nsProfileMigrator.cpp</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -44,19 +44,19 @@ nsProfileMigrator::Migrate(nsIProfileSta</span>
<a href="#l2.4"></a><span id="l2.4">   cstr-&gt;SetData(key);</span>
<a href="#l2.5"></a><span id="l2.5"> </span>
<a href="#l2.6"></a><span id="l2.6">   // By opening the Migration FE with a supplied mailMigrator, it will automatically</span>
<a href="#l2.7"></a><span id="l2.7">   // migrate from it.</span>
<a href="#l2.8"></a><span id="l2.8">   nsCOMPtr&lt;nsIWindowWatcher&gt; ww (do_GetService(NS_WINDOWWATCHER_CONTRACTID));</span>
<a href="#l2.9"></a><span id="l2.9">   nsCOMPtr&lt;nsIMutableArray&gt; params (do_CreateInstance(NS_ARRAY_CONTRACTID));</span>
<a href="#l2.10"></a><span id="l2.10">   if (!ww || !params) return NS_ERROR_FAILURE;</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-  params-&gt;AppendElement(cstr, false);</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-  params-&gt;AppendElement(mailMigrator, false);</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineminus">-  params-&gt;AppendElement(aStartup, false);</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+  params-&gt;AppendElement(cstr);</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+  params-&gt;AppendElement(mailMigrator);</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+  params-&gt;AppendElement(aStartup);</span>
<a href="#l2.18"></a><span id="l2.18"> </span>
<a href="#l2.19"></a><span id="l2.19">   nsCOMPtr&lt;mozIDOMWindowProxy&gt; migrateWizard;</span>
<a href="#l2.20"></a><span id="l2.20">   return ww-&gt;OpenWindow(nullptr,</span>
<a href="#l2.21"></a><span id="l2.21">                         MIGRATION_WIZARD_FE_URL,</span>
<a href="#l2.22"></a><span id="l2.22">                         &quot;_blank&quot;,</span>
<a href="#l2.23"></a><span id="l2.23">                         MIGRATION_WIZARD_FE_FEATURES,</span>
<a href="#l2.24"></a><span id="l2.24">                         params,</span>
<a href="#l2.25"></a><span id="l2.25">                         getter_AddRefs(migrateWizard));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbLDAPCard.cpp</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbLDAPCard.cpp</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -93,24 +93,24 @@ NS_IMETHODIMP nsAbLDAPCard::GetLDAPMessa</span>
<a href="#l3.4"></a><span id="l3.4">   {</span>
<a href="#l3.5"></a><span id="l3.5">     nsCOMPtr&lt;nsILDAPBERValue&gt; value =</span>
<a href="#l3.6"></a><span id="l3.6">       do_CreateInstance(&quot;@mozilla.org/network/ldap-ber-value;1&quot;, &amp;rv);</span>
<a href="#l3.7"></a><span id="l3.7">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l3.8"></a><span id="l3.8"> </span>
<a href="#l3.9"></a><span id="l3.9">     rv = value-&gt;SetFromUTF8(m_objectClass.ElementAt(i));</span>
<a href="#l3.10"></a><span id="l3.10">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-    rv = values-&gt;AppendElement(value, false);</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+    rv = values-&gt;AppendElement(value);</span>
<a href="#l3.14"></a><span id="l3.14">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l3.15"></a><span id="l3.15">   }</span>
<a href="#l3.16"></a><span id="l3.16"> </span>
<a href="#l3.17"></a><span id="l3.17">   rv = mod-&gt;SetUpModification(aType, NS_LITERAL_CSTRING(&quot;objectClass&quot;), values);</span>
<a href="#l3.18"></a><span id="l3.18">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l3.19"></a><span id="l3.19"> </span>
<a href="#l3.20"></a><span id="l3.20" class="difflineminus">-  modArray-&gt;AppendElement(mod, false);</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineplus">+  modArray-&gt;AppendElement(mod);</span>
<a href="#l3.22"></a><span id="l3.22"> </span>
<a href="#l3.23"></a><span id="l3.23">   // Add card properties</span>
<a href="#l3.24"></a><span id="l3.24">   CharPtrArrayGuard props;</span>
<a href="#l3.25"></a><span id="l3.25">   rv = aAttributeMap-&gt;GetAllCardProperties(props.GetSizeAddr(),</span>
<a href="#l3.26"></a><span id="l3.26">     props.GetArrayAddr());</span>
<a href="#l3.27"></a><span id="l3.27">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l3.28"></a><span id="l3.28"> </span>
<a href="#l3.29"></a><span id="l3.29">   nsAutoCString attr;</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineat">@@ -159,17 +159,17 @@ NS_IMETHODIMP nsAbLDAPCard::GetLDAPMessa</span>
<a href="#l3.31"></a><span id="l3.31">       rv = value-&gt;SetFromUTF8(propvalue);</span>
<a href="#l3.32"></a><span id="l3.32">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l3.33"></a><span id="l3.33"> </span>
<a href="#l3.34"></a><span id="l3.34">       rv = mod-&gt;SetUpModificationOneValue(aType, attr, value);</span>
<a href="#l3.35"></a><span id="l3.35">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l3.36"></a><span id="l3.36"> </span>
<a href="#l3.37"></a><span id="l3.37">       printf(&quot;LDAP : setting attribute %s (%s) to '%s'\n&quot;, attr.get(),</span>
<a href="#l3.38"></a><span id="l3.38">         props[i], propvalue.get());</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineminus">-      modArray-&gt;AppendElement(mod, false);</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineplus">+      modArray-&gt;AppendElement(mod);</span>
<a href="#l3.41"></a><span id="l3.41">       if (index != m_attributes.NoIndex)</span>
<a href="#l3.42"></a><span id="l3.42">         m_attributes.AppendElement(attr);</span>
<a href="#l3.43"></a><span id="l3.43"> </span>
<a href="#l3.44"></a><span id="l3.44">     }</span>
<a href="#l3.45"></a><span id="l3.45">     else if (aType == nsILDAPModification::MOD_REPLACE &amp;&amp;</span>
<a href="#l3.46"></a><span id="l3.46">              index != m_attributes.NoIndex)</span>
<a href="#l3.47"></a><span id="l3.47">     {</span>
<a href="#l3.48"></a><span id="l3.48">       // If the new value is empty, we are performing an update</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineat">@@ -177,17 +177,17 @@ NS_IMETHODIMP nsAbLDAPCard::GetLDAPMessa</span>
<a href="#l3.50"></a><span id="l3.50">       nsCOMPtr&lt;nsIMutableArray&gt; novalues =</span>
<a href="#l3.51"></a><span id="l3.51">         do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l3.52"></a><span id="l3.52">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l3.53"></a><span id="l3.53"> </span>
<a href="#l3.54"></a><span id="l3.54">       rv = mod-&gt;SetUpModification(aType, attr, novalues);</span>
<a href="#l3.55"></a><span id="l3.55">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l3.56"></a><span id="l3.56"> </span>
<a href="#l3.57"></a><span id="l3.57">       printf(&quot;LDAP : removing attribute %s (%s)\n&quot;, attr.get(), props[i]);</span>
<a href="#l3.58"></a><span id="l3.58" class="difflineminus">-      modArray-&gt;AppendElement(mod, false);</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineplus">+      modArray-&gt;AppendElement(mod);</span>
<a href="#l3.60"></a><span id="l3.60">       m_attributes.RemoveElementAt(index);</span>
<a href="#l3.61"></a><span id="l3.61">     }</span>
<a href="#l3.62"></a><span id="l3.62">   }</span>
<a href="#l3.63"></a><span id="l3.63"> </span>
<a href="#l3.64"></a><span id="l3.64">   modArray.forget(aLDAPAddMessageInfo);</span>
<a href="#l3.65"></a><span id="l3.65"> </span>
<a href="#l3.66"></a><span id="l3.66">   return NS_OK;</span>
<a href="#l3.67"></a><span id="l3.67"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbMDBDirProperty.cpp</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbMDBDirProperty.cpp</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -58,34 +58,34 @@ NS_IMETHODIMP nsAbMDBDirProperty::AddMai</span>
<a href="#l4.4"></a><span id="l4.4">   {</span>
<a href="#l4.5"></a><span id="l4.5">     nsresult rv;</span>
<a href="#l4.6"></a><span id="l4.6">     m_AddressList = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l4.7"></a><span id="l4.7">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l4.8"></a><span id="l4.8">   }</span>
<a href="#l4.9"></a><span id="l4.9"> </span>
<a href="#l4.10"></a><span id="l4.10">   uint32_t position;</span>
<a href="#l4.11"></a><span id="l4.11">   if (NS_FAILED(m_AddressList-&gt;IndexOf(0, mailList, &amp;position)))</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-    m_AddressList-&gt;AppendElement(mailList, false);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+    m_AddressList-&gt;AppendElement(mailList);</span>
<a href="#l4.14"></a><span id="l4.14"> </span>
<a href="#l4.15"></a><span id="l4.15">   return NS_OK;</span>
<a href="#l4.16"></a><span id="l4.16"> }</span>
<a href="#l4.17"></a><span id="l4.17"> </span>
<a href="#l4.18"></a><span id="l4.18"> /* add addresses to the mailing list */</span>
<a href="#l4.19"></a><span id="l4.19"> NS_IMETHODIMP nsAbMDBDirProperty::AddAddressToList(nsIAbCard *card)</span>
<a href="#l4.20"></a><span id="l4.20"> {</span>
<a href="#l4.21"></a><span id="l4.21">   if (!m_AddressList)</span>
<a href="#l4.22"></a><span id="l4.22">   {</span>
<a href="#l4.23"></a><span id="l4.23">     nsresult rv;</span>
<a href="#l4.24"></a><span id="l4.24">     m_AddressList = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l4.25"></a><span id="l4.25">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l4.26"></a><span id="l4.26">   }</span>
<a href="#l4.27"></a><span id="l4.27"> </span>
<a href="#l4.28"></a><span id="l4.28">   uint32_t position;</span>
<a href="#l4.29"></a><span id="l4.29">   if (NS_FAILED(m_AddressList-&gt;IndexOf(0, card, &amp;position)))</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineminus">-    m_AddressList-&gt;AppendElement(card, false);</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineplus">+    m_AddressList-&gt;AppendElement(card);</span>
<a href="#l4.32"></a><span id="l4.32"> </span>
<a href="#l4.33"></a><span id="l4.33">   return NS_OK;</span>
<a href="#l4.34"></a><span id="l4.34"> }</span>
<a href="#l4.35"></a><span id="l4.35"> </span>
<a href="#l4.36"></a><span id="l4.36"> NS_IMETHODIMP nsAbMDBDirProperty::CopyDBMailList(nsIAbMDBDirectory* srcListDB)</span>
<a href="#l4.37"></a><span id="l4.37"> {</span>
<a href="#l4.38"></a><span id="l4.38"> 	nsresult err = NS_OK;</span>
<a href="#l4.39"></a><span id="l4.39"> 	nsCOMPtr&lt;nsIAbDirectory&gt; srcList(do_QueryInterface(srcListDB));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbMDBDirectory.cpp</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbMDBDirectory.cpp</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -394,17 +394,17 @@ NS_IMETHODIMP nsAbMDBDirectory::GetChild</span>
<a href="#l5.4"></a><span id="l5.4">     rv = StartSearch();</span>
<a href="#l5.5"></a><span id="l5.5">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.6"></a><span id="l5.6"> </span>
<a href="#l5.7"></a><span id="l5.7">     // TODO</span>
<a href="#l5.8"></a><span id="l5.8">     // Search is synchronous so need to return</span>
<a href="#l5.9"></a><span id="l5.9">     // results after search is complete</span>
<a href="#l5.10"></a><span id="l5.10">     nsCOMPtr&lt;nsIMutableArray&gt; array(do_CreateInstance(NS_ARRAY_CONTRACTID));</span>
<a href="#l5.11"></a><span id="l5.11">     for (auto iter = mSearchCache.Iter(); !iter.Done(); iter.Next()) {</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-      array-&gt;AppendElement(iter.Data(), false);</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+      array-&gt;AppendElement(iter.Data());</span>
<a href="#l5.14"></a><span id="l5.14">     }</span>
<a href="#l5.15"></a><span id="l5.15">     return NS_NewArrayEnumerator(result, array);</span>
<a href="#l5.16"></a><span id="l5.16">   }</span>
<a href="#l5.17"></a><span id="l5.17"> </span>
<a href="#l5.18"></a><span id="l5.18">   rv = GetAbDatabase();</span>
<a href="#l5.19"></a><span id="l5.19"> </span>
<a href="#l5.20"></a><span id="l5.20">   if (NS_FAILED(rv) || !mDatabase)</span>
<a href="#l5.21"></a><span id="l5.21">     return rv;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbOSXDirectory.mm</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbOSXDirectory.mm</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -835,32 +835,32 @@ nsAbOSXDirectory::AssertDirectory(nsIAbM</span>
<a href="#l6.4"></a><span id="l6.4">     return NS_OK;</span>
<a href="#l6.5"></a><span id="l6.5"> </span>
<a href="#l6.6"></a><span id="l6.6">   nsresult rv;</span>
<a href="#l6.7"></a><span id="l6.7">   if (!m_AddressList) {</span>
<a href="#l6.8"></a><span id="l6.8">     m_AddressList = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l6.9"></a><span id="l6.9">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.10"></a><span id="l6.10">   }</span>
<a href="#l6.11"></a><span id="l6.11">   </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-  rv = m_AddressList-&gt;AppendElement(aDirectory, false);</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+  rv = m_AddressList-&gt;AppendElement(aDirectory);</span>
<a href="#l6.14"></a><span id="l6.14">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.15"></a><span id="l6.15"> </span>
<a href="#l6.16"></a><span id="l6.16">   return aManager-&gt;NotifyDirectoryItemAdded(this, aDirectory);</span>
<a href="#l6.17"></a><span id="l6.17"> }</span>
<a href="#l6.18"></a><span id="l6.18"> </span>
<a href="#l6.19"></a><span id="l6.19"> nsresult</span>
<a href="#l6.20"></a><span id="l6.20"> nsAbOSXDirectory::AssertCard(nsIAbManager *aManager,</span>
<a href="#l6.21"></a><span id="l6.21">                              nsIAbCard *aCard)</span>
<a href="#l6.22"></a><span id="l6.22"> {</span>
<a href="#l6.23"></a><span id="l6.23">   nsAutoCString ourUuid;</span>
<a href="#l6.24"></a><span id="l6.24">   GetUuid(ourUuid);</span>
<a href="#l6.25"></a><span id="l6.25">   aCard-&gt;SetDirectoryId(ourUuid);</span>
<a href="#l6.26"></a><span id="l6.26"> </span>
<a href="#l6.27"></a><span id="l6.27" class="difflineminus">-  nsresult rv = m_IsMailList ? m_AddressList-&gt;AppendElement(aCard, false) :</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineminus">-                               mCardList-&gt;AppendElement(aCard, false);</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineplus">+  nsresult rv = m_IsMailList ? m_AddressList-&gt;AppendElement(aCard) :</span>
<a href="#l6.30"></a><span id="l6.30" class="difflineplus">+                               mCardList-&gt;AppendElement(aCard);</span>
<a href="#l6.31"></a><span id="l6.31">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.32"></a><span id="l6.32"> </span>
<a href="#l6.33"></a><span id="l6.33">   // Get the card's URI and add it to our card store</span>
<a href="#l6.34"></a><span id="l6.34">   nsCOMPtr&lt;nsIAbOSXCard&gt; osxCard = do_QueryInterface(aCard, &amp;rv);</span>
<a href="#l6.35"></a><span id="l6.35">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.36"></a><span id="l6.36"> </span>
<a href="#l6.37"></a><span id="l6.37">   nsCString uri;</span>
<a href="#l6.38"></a><span id="l6.38">   rv = osxCard-&gt;GetURI(uri);</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineat">@@ -960,17 +960,17 @@ nsAbOSXDirectory::GetChildCards(nsISimpl</span>
<a href="#l6.40"></a><span id="l6.40"> </span>
<a href="#l6.41"></a><span id="l6.41">       if (NS_FAILED(rv))</span>
<a href="#l6.42"></a><span id="l6.42">         rv = CreateCard([cards objectAtIndex:i],</span>
<a href="#l6.43"></a><span id="l6.43">                         getter_AddRefs(card));</span>
<a href="#l6.44"></a><span id="l6.44"> </span>
<a href="#l6.45"></a><span id="l6.45">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.46"></a><span id="l6.46">       card-&gt;SetDirectoryId(ourUuid);</span>
<a href="#l6.47"></a><span id="l6.47"> </span>
<a href="#l6.48"></a><span id="l6.48" class="difflineminus">-      mCardList-&gt;AppendElement(card, false);</span>
<a href="#l6.49"></a><span id="l6.49" class="difflineplus">+      mCardList-&gt;AppendElement(card);</span>
<a href="#l6.50"></a><span id="l6.50">     }</span>
<a href="#l6.51"></a><span id="l6.51"> </span>
<a href="#l6.52"></a><span id="l6.52">     return NS_NewArrayEnumerator(aCards, mCardList);</span>
<a href="#l6.53"></a><span id="l6.53">   }</span>
<a href="#l6.54"></a><span id="l6.54"> </span>
<a href="#l6.55"></a><span id="l6.55">   // Not a search, so just return the appropriate list of items.</span>
<a href="#l6.56"></a><span id="l6.56">   return m_IsMailList ? NS_NewArrayEnumerator(aCards, m_AddressList) :</span>
<a href="#l6.57"></a><span id="l6.57">          NS_NewArrayEnumerator(aCards, mCardList);</span>
<a href="#l6.58"></a><span id="l6.58" class="difflineat">@@ -1204,20 +1204,20 @@ nsAbOSXDirectory::OnSearchFoundCard(nsIA</span>
<a href="#l6.59"></a><span id="l6.59">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.60"></a><span id="l6.60">   }</span>
<a href="#l6.61"></a><span id="l6.61">   </span>
<a href="#l6.62"></a><span id="l6.62">   if (!mCardList) {</span>
<a href="#l6.63"></a><span id="l6.63">     mCardList = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l6.64"></a><span id="l6.64">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.65"></a><span id="l6.65">   }</span>
<a href="#l6.66"></a><span id="l6.66"> </span>
<a href="#l6.67"></a><span id="l6.67" class="difflineminus">-  rv = m_AddressList-&gt;AppendElement(aCard, false);</span>
<a href="#l6.68"></a><span id="l6.68" class="difflineplus">+  rv = m_AddressList-&gt;AppendElement(aCard);</span>
<a href="#l6.69"></a><span id="l6.69">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.70"></a><span id="l6.70">   </span>
<a href="#l6.71"></a><span id="l6.71" class="difflineminus">-  rv = mCardList-&gt;AppendElement(aCard, false);</span>
<a href="#l6.72"></a><span id="l6.72" class="difflineplus">+  rv = mCardList-&gt;AppendElement(aCard);</span>
<a href="#l6.73"></a><span id="l6.73">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.74"></a><span id="l6.74"> </span>
<a href="#l6.75"></a><span id="l6.75">   nsAutoCString ourUuid;</span>
<a href="#l6.76"></a><span id="l6.76">   GetUuid(ourUuid);</span>
<a href="#l6.77"></a><span id="l6.77">   aCard-&gt;SetDirectoryId(ourUuid);</span>
<a href="#l6.78"></a><span id="l6.78">   </span>
<a href="#l6.79"></a><span id="l6.79">   return NS_OK;</span>
<a href="#l6.80"></a><span id="l6.80"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbOutlookDirFactory.cpp</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbOutlookDirFactory.cpp</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -66,17 +66,17 @@ nsAbOutlookDirFactory::GetDirectories(co</span>
<a href="#l7.4"></a><span id="l7.4">   for (ULONG i = 0; i &lt; folders.mNbEntries; ++i) {</span>
<a href="#l7.5"></a><span id="l7.5">     folders.mEntries[i].ToString(entryId);</span>
<a href="#l7.6"></a><span id="l7.6">     buildAbWinUri(kOutlookDirectoryScheme, abType, uri);</span>
<a href="#l7.7"></a><span id="l7.7">     uri.Append(entryId);</span>
<a href="#l7.8"></a><span id="l7.8"> </span>
<a href="#l7.9"></a><span id="l7.9"> 	nsCOMPtr&lt;nsIAbDirectory&gt; directory;</span>
<a href="#l7.10"></a><span id="l7.10"> 	rv = abManager-&gt;GetDirectory(uri, getter_AddRefs(directory));</span>
<a href="#l7.11"></a><span id="l7.11">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-    directories-&gt;AppendElement(directory, false);</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+    directories-&gt;AppendElement(directory);</span>
<a href="#l7.14"></a><span id="l7.14">   }</span>
<a href="#l7.15"></a><span id="l7.15">   return NS_NewArrayEnumerator(aDirectories, directories);</span>
<a href="#l7.16"></a><span id="l7.16"> }</span>
<a href="#l7.17"></a><span id="l7.17"> </span>
<a href="#l7.18"></a><span id="l7.18"> // No actual deletion, since you cannot create the address books from Mozilla.</span>
<a href="#l7.19"></a><span id="l7.19"> NS_IMETHODIMP nsAbOutlookDirFactory::DeleteDirectory(nsIAbDirectory *aDirectory)</span>
<a href="#l7.20"></a><span id="l7.20"> {</span>
<a href="#l7.21"></a><span id="l7.21">   return NS_OK;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbOutlookDirectory.cpp</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbOutlookDirectory.cpp</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -191,22 +191,22 @@ NS_IMETHODIMP nsAbOutlookDirectory::GetC</span>
<a href="#l8.4"></a><span id="l8.4">         // we must add the directory to m_AddressList</span>
<a href="#l8.5"></a><span id="l8.5">         nsCString mailListUri;</span>
<a href="#l8.6"></a><span id="l8.6">         rv = card-&gt;GetMailListURI(getter_Copies(mailListUri));</span>
<a href="#l8.7"></a><span id="l8.7">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.8"></a><span id="l8.8">         nsCOMPtr&lt;nsIAbDirectory&gt; mailList;</span>
<a href="#l8.9"></a><span id="l8.9">         rv = abManager-&gt;GetDirectory(mailListUri, getter_AddRefs(mailList));</span>
<a href="#l8.10"></a><span id="l8.10">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.11"></a><span id="l8.11"> </span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-        m_AddressList-&gt;AppendElement(mailList, false);</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+        m_AddressList-&gt;AppendElement(mailList);</span>
<a href="#l8.14"></a><span id="l8.14">         NotifyItemAddition(mailList);</span>
<a href="#l8.15"></a><span id="l8.15">       }</span>
<a href="#l8.16"></a><span id="l8.16">       else if (m_IsMailList)</span>
<a href="#l8.17"></a><span id="l8.17">       {</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineminus">-        m_AddressList-&gt;AppendElement(card, false);</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+        m_AddressList-&gt;AppendElement(card);</span>
<a href="#l8.20"></a><span id="l8.20">         NotifyItemAddition(card);</span>
<a href="#l8.21"></a><span id="l8.21">       }</span>
<a href="#l8.22"></a><span id="l8.22">     }</span>
<a href="#l8.23"></a><span id="l8.23">   }</span>
<a href="#l8.24"></a><span id="l8.24">   return rv;</span>
<a href="#l8.25"></a><span id="l8.25"> }</span>
<a href="#l8.26"></a><span id="l8.26"> </span>
<a href="#l8.27"></a><span id="l8.27"> NS_IMETHODIMP nsAbOutlookDirectory::GetIsQuery(bool *aResult)</span>
<a href="#l8.28"></a><span id="l8.28" class="difflineat">@@ -371,17 +371,17 @@ NS_IMETHODIMP nsAbOutlookDirectory::AddC</span>
<a href="#l8.29"></a><span id="l8.29"> </span>
<a href="#l8.30"></a><span id="l8.30">     if (!m_AddressList)</span>
<a href="#l8.31"></a><span id="l8.31">     {</span>
<a href="#l8.32"></a><span id="l8.32">         m_AddressList = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;retCode);</span>
<a href="#l8.33"></a><span id="l8.33">         NS_ENSURE_SUCCESS(retCode, retCode);</span>
<a href="#l8.34"></a><span id="l8.34">     }</span>
<a href="#l8.35"></a><span id="l8.35"> </span>
<a href="#l8.36"></a><span id="l8.36">     if (m_IsMailList)</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineminus">-        m_AddressList-&gt;AppendElement(*addedCard, false);</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineplus">+        m_AddressList-&gt;AppendElement(*addedCard);</span>
<a href="#l8.39"></a><span id="l8.39">     NotifyItemAddition(*addedCard) ;</span>
<a href="#l8.40"></a><span id="l8.40">     return retCode ;</span>
<a href="#l8.41"></a><span id="l8.41"> }</span>
<a href="#l8.42"></a><span id="l8.42"> </span>
<a href="#l8.43"></a><span id="l8.43"> NS_IMETHODIMP nsAbOutlookDirectory::DropCard(nsIAbCard *aData, bool needToCopyCard)</span>
<a href="#l8.44"></a><span id="l8.44"> {</span>
<a href="#l8.45"></a><span id="l8.45">     nsCOMPtr &lt;nsIAbCard&gt; addedCard;</span>
<a href="#l8.46"></a><span id="l8.46">     return AddCard(aData, getter_AddRefs(addedCard));</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineat">@@ -440,17 +440,17 @@ NS_IMETHODIMP nsAbOutlookDirectory::AddM</span>
<a href="#l8.48"></a><span id="l8.48">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.49"></a><span id="l8.49">   }</span>
<a href="#l8.50"></a><span id="l8.50"> </span>
<a href="#l8.51"></a><span id="l8.51">   if (!m_AddressList)</span>
<a href="#l8.52"></a><span id="l8.52">   {</span>
<a href="#l8.53"></a><span id="l8.53">     m_AddressList = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l8.54"></a><span id="l8.54">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.55"></a><span id="l8.55">   }</span>
<a href="#l8.56"></a><span id="l8.56" class="difflineminus">-  m_AddressList-&gt;AppendElement(newList, false);</span>
<a href="#l8.57"></a><span id="l8.57" class="difflineplus">+  m_AddressList-&gt;AppendElement(newList);</span>
<a href="#l8.58"></a><span id="l8.58">   NotifyItemAddition(newList);</span>
<a href="#l8.59"></a><span id="l8.59">   newList.forget(addedList);</span>
<a href="#l8.60"></a><span id="l8.60"> </span>
<a href="#l8.61"></a><span id="l8.61">   return rv;</span>
<a href="#l8.62"></a><span id="l8.62"> }</span>
<a href="#l8.63"></a><span id="l8.63"> </span>
<a href="#l8.64"></a><span id="l8.64"> NS_IMETHODIMP nsAbOutlookDirectory::EditMailListToDatabase(nsIAbCard *listCard)</span>
<a href="#l8.65"></a><span id="l8.65"> {</span>
<a href="#l8.66"></a><span id="l8.66" class="difflineat">@@ -1035,17 +1035,17 @@ nsresult nsAbOutlookDirectory::GetChildC</span>
<a href="#l8.67"></a><span id="l8.67">     cardEntries.mEntries[card].ToString(entryId);</span>
<a href="#l8.68"></a><span id="l8.68">     buildAbWinUri(kOutlookCardScheme, mAbWinType, uriName);</span>
<a href="#l8.69"></a><span id="l8.69">     uriName.Append(entryId);</span>
<a href="#l8.70"></a><span id="l8.70"> </span>
<a href="#l8.71"></a><span id="l8.71">     rv = OutlookCardForURI(uriName, getter_AddRefs(childCard));</span>
<a href="#l8.72"></a><span id="l8.72">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.73"></a><span id="l8.73">     childCard-&gt;SetDirectoryId(ourUuid);</span>
<a href="#l8.74"></a><span id="l8.74"> </span>
<a href="#l8.75"></a><span id="l8.75" class="difflineminus">-    aCards-&gt;AppendElement(childCard, false);</span>
<a href="#l8.76"></a><span id="l8.76" class="difflineplus">+    aCards-&gt;AppendElement(childCard);</span>
<a href="#l8.77"></a><span id="l8.77">   }</span>
<a href="#l8.78"></a><span id="l8.78">   return rv;</span>
<a href="#l8.79"></a><span id="l8.79"> }</span>
<a href="#l8.80"></a><span id="l8.80"> </span>
<a href="#l8.81"></a><span id="l8.81"> nsresult nsAbOutlookDirectory::GetChildNodes(nsIMutableArray* aNodes)</span>
<a href="#l8.82"></a><span id="l8.82"> {</span>
<a href="#l8.83"></a><span id="l8.83">   NS_ENSURE_ARG_POINTER(aNodes);</span>
<a href="#l8.84"></a><span id="l8.84"> </span>
<a href="#l8.85"></a><span id="l8.85" class="difflineat">@@ -1075,17 +1075,17 @@ nsresult nsAbOutlookDirectory::GetChildN</span>
<a href="#l8.86"></a><span id="l8.86">     nodeEntries.mEntries[node].ToString(entryId);</span>
<a href="#l8.87"></a><span id="l8.87">     buildAbWinUri(kOutlookDirectoryScheme, mAbWinType, uriName);</span>
<a href="#l8.88"></a><span id="l8.88">     uriName.Append(entryId);</span>
<a href="#l8.89"></a><span id="l8.89"> </span>
<a href="#l8.90"></a><span id="l8.90">     nsCOMPtr &lt;nsIAbDirectory&gt; directory;</span>
<a href="#l8.91"></a><span id="l8.91">     rv = abManager-&gt;GetDirectory(uriName, getter_AddRefs(directory));</span>
<a href="#l8.92"></a><span id="l8.92">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.93"></a><span id="l8.93"> </span>
<a href="#l8.94"></a><span id="l8.94" class="difflineminus">-    aNodes-&gt;AppendElement(directory, false);</span>
<a href="#l8.95"></a><span id="l8.95" class="difflineplus">+    aNodes-&gt;AppendElement(directory);</span>
<a href="#l8.96"></a><span id="l8.96">   }</span>
<a href="#l8.97"></a><span id="l8.97">   return rv;</span>
<a href="#l8.98"></a><span id="l8.98"> }</span>
<a href="#l8.99"></a><span id="l8.99"> </span>
<a href="#l8.100"></a><span id="l8.100"> nsresult nsAbOutlookDirectory::NotifyItemDeletion(nsISupports *aItem)</span>
<a href="#l8.101"></a><span id="l8.101"> {</span>
<a href="#l8.102"></a><span id="l8.102">   nsresult rv;</span>
<a href="#l8.103"></a><span id="l8.103">   nsCOMPtr&lt;nsIAbManager&gt; abManager(do_GetService(NS_ABMANAGER_CONTRACTID, &amp;rv));</span>
<a href="#l8.104"></a><span id="l8.104" class="difflineat">@@ -1144,17 +1144,17 @@ nsresult nsAbOutlookDirectory::CommitAdd</span>
<a href="#l8.105"></a><span id="l8.105">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.106"></a><span id="l8.106"> </span>
<a href="#l8.107"></a><span id="l8.107">         // The entry was not already there</span>
<a href="#l8.108"></a><span id="l8.108">         nsCOMPtr&lt;nsIAbCard&gt; card(do_QueryInterface(element, &amp;rv));</span>
<a href="#l8.109"></a><span id="l8.109">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.110"></a><span id="l8.110"> </span>
<a href="#l8.111"></a><span id="l8.111">         rv = CreateCard(card, getter_AddRefs(newCard));</span>
<a href="#l8.112"></a><span id="l8.112">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.113"></a><span id="l8.113" class="difflineminus">-        m_AddressList-&gt;ReplaceElementAt(newCard, i, false);</span>
<a href="#l8.114"></a><span id="l8.114" class="difflineplus">+        m_AddressList-&gt;ReplaceElementAt(newCard, i);</span>
<a href="#l8.115"></a><span id="l8.115">     }</span>
<a href="#l8.116"></a><span id="l8.116">   }</span>
<a href="#l8.117"></a><span id="l8.117">   return DeleteCards(oldList);</span>
<a href="#l8.118"></a><span id="l8.118"> }</span>
<a href="#l8.119"></a><span id="l8.119"> </span>
<a href="#l8.120"></a><span id="l8.120"> nsresult nsAbOutlookDirectory::UpdateAddressList(void)</span>
<a href="#l8.121"></a><span id="l8.121"> {</span>
<a href="#l8.122"></a><span id="l8.122">     if (!m_AddressList)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbQueryStringToExpression.cpp</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbQueryStringToExpression.cpp</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -135,17 +135,17 @@ nsresult nsAbQueryStringToExpression::Pa</span>
<a href="#l9.4"></a><span id="l9.4">     // Case: &quot;)(*)(*)....(*))&quot;</span>
<a href="#l9.5"></a><span id="l9.5">     // printf (&quot;Case: )(*)(*)....(*)): %s\n&quot;, *index);</span>
<a href="#l9.6"></a><span id="l9.6">     while (**index == '(')</span>
<a href="#l9.7"></a><span id="l9.7">     {</span>
<a href="#l9.8"></a><span id="l9.8">         nsCOMPtr&lt;nsISupports&gt; childExpression;</span>
<a href="#l9.9"></a><span id="l9.9">         rv = ParseExpression(index, getter_AddRefs (childExpression));</span>
<a href="#l9.10"></a><span id="l9.10">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l9.11"></a><span id="l9.11"> </span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-        expressions-&gt;AppendElement(childExpression, false);</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+        expressions-&gt;AppendElement(childExpression);</span>
<a href="#l9.14"></a><span id="l9.14">     }</span>
<a href="#l9.15"></a><span id="l9.15"> </span>
<a href="#l9.16"></a><span id="l9.16">     if (**index == 0)</span>
<a href="#l9.17"></a><span id="l9.17">         return NS_ERROR_FAILURE;</span>
<a href="#l9.18"></a><span id="l9.18"> </span>
<a href="#l9.19"></a><span id="l9.19">     // Case: &quot;))&quot;</span>
<a href="#l9.20"></a><span id="l9.20">     // printf (&quot;Case: )): %s\n&quot;, *index);</span>
<a href="#l9.21"></a><span id="l9.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbView.cpp</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbView.cpp</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -1219,17 +1219,17 @@ nsresult nsAbView::GetSelectedCards(nsCO</span>
<a href="#l10.4"></a><span id="l10.4">     int32_t totalCards = mCards.Length();</span>
<a href="#l10.5"></a><span id="l10.5">     if (startRange &gt;= 0 &amp;&amp; startRange &lt; totalCards)</span>
<a href="#l10.6"></a><span id="l10.6">     {</span>
<a href="#l10.7"></a><span id="l10.7">       for (int32_t rangeIndex = startRange; rangeIndex &lt;= endRange &amp;&amp; rangeIndex &lt; totalCards; rangeIndex++) {</span>
<a href="#l10.8"></a><span id="l10.8">         nsCOMPtr&lt;nsIAbCard&gt; abCard;</span>
<a href="#l10.9"></a><span id="l10.9">         rv = GetCardFromRow(rangeIndex, getter_AddRefs(abCard));</span>
<a href="#l10.10"></a><span id="l10.10">         NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.11"></a><span id="l10.11"> </span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-        rv = aSelectedCards-&gt;AppendElement(abCard, false);</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+        rv = aSelectedCards-&gt;AppendElement(abCard);</span>
<a href="#l10.14"></a><span id="l10.14">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l10.15"></a><span id="l10.15">       }</span>
<a href="#l10.16"></a><span id="l10.16">     }</span>
<a href="#l10.17"></a><span id="l10.17">   }</span>
<a href="#l10.18"></a><span id="l10.18"> </span>
<a href="#l10.19"></a><span id="l10.19">   return NS_OK;</span>
<a href="#l10.20"></a><span id="l10.20"> }</span>
<a href="#l10.21"></a><span id="l10.21"> </span>
<a href="#l10.22"></a><span id="l10.22" class="difflineat">@@ -1415,28 +1415,28 @@ NS_IMETHODIMP nsAbView::GetSelectedAddre</span>
<a href="#l10.23"></a><span id="l10.23">         NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.24"></a><span id="l10.24"> </span>
<a href="#l10.25"></a><span id="l10.25">         rv = mailListCard-&gt;GetPrimaryEmail(primaryEmail);</span>
<a href="#l10.26"></a><span id="l10.26">         NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.27"></a><span id="l10.27"> </span>
<a href="#l10.28"></a><span id="l10.28">         if (!primaryEmail.IsEmpty()) {</span>
<a href="#l10.29"></a><span id="l10.29">           nsCOMPtr&lt;nsISupportsString&gt; supportsEmail(do_CreateInstance(NS_SUPPORTS_STRING_CONTRACTID));</span>
<a href="#l10.30"></a><span id="l10.30">           supportsEmail-&gt;SetData(primaryEmail);</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineminus">-          addresses-&gt;AppendElement(supportsEmail, false);</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+          addresses-&gt;AppendElement(supportsEmail);</span>
<a href="#l10.33"></a><span id="l10.33">         }</span>
<a href="#l10.34"></a><span id="l10.34">       }</span>
<a href="#l10.35"></a><span id="l10.35">     }</span>
<a href="#l10.36"></a><span id="l10.36">     else {</span>
<a href="#l10.37"></a><span id="l10.37">       rv = card-&gt;GetPrimaryEmail(primaryEmail);</span>
<a href="#l10.38"></a><span id="l10.38">       NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.39"></a><span id="l10.39"> </span>
<a href="#l10.40"></a><span id="l10.40">       if (!primaryEmail.IsEmpty()) {</span>
<a href="#l10.41"></a><span id="l10.41">         nsCOMPtr&lt;nsISupportsString&gt; supportsEmail(do_CreateInstance(NS_SUPPORTS_STRING_CONTRACTID));</span>
<a href="#l10.42"></a><span id="l10.42">         supportsEmail-&gt;SetData(primaryEmail);</span>
<a href="#l10.43"></a><span id="l10.43" class="difflineminus">-        addresses-&gt;AppendElement(supportsEmail, false);</span>
<a href="#l10.44"></a><span id="l10.44" class="difflineplus">+        addresses-&gt;AppendElement(supportsEmail);</span>
<a href="#l10.45"></a><span id="l10.45">       }</span>
<a href="#l10.46"></a><span id="l10.46">     }</span>
<a href="#l10.47"></a><span id="l10.47">   }</span>
<a href="#l10.48"></a><span id="l10.48"> </span>
<a href="#l10.49"></a><span id="l10.49">   addresses.forget(_retval);</span>
<a href="#l10.50"></a><span id="l10.50"> </span>
<a href="#l10.51"></a><span id="l10.51">   return NS_OK;</span>
<a href="#l10.52"></a><span id="l10.52"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAddrDatabase.cpp</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAddrDatabase.cpp</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -1220,17 +1220,17 @@ NS_IMETHODIMP nsAddrDatabase::CreateNewL</span>
<a href="#l11.4"></a><span id="l11.4"> </span>
<a href="#l11.5"></a><span id="l11.5">   // start from 1</span>
<a href="#l11.6"></a><span id="l11.6">   uint32_t totalAddress = GetListAddressTotal(pListRow) + 1;</span>
<a href="#l11.7"></a><span id="l11.7">   SetListAddressTotal(pListRow, totalAddress);</span>
<a href="#l11.8"></a><span id="l11.8">   nsCOMPtr&lt;nsIAbCard&gt; pNewCard;</span>
<a href="#l11.9"></a><span id="l11.9">   rv = AddListCardColumnsToRow(newCard, pListRow, totalAddress, getter_AddRefs(pNewCard), true /* aInMailingList */, aList, nullptr);</span>
<a href="#l11.10"></a><span id="l11.10">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l11.11"></a><span id="l11.11"> </span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-  addressList-&gt;AppendElement(newCard, false);</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+  addressList-&gt;AppendElement(newCard);</span>
<a href="#l11.14"></a><span id="l11.14"> </span>
<a href="#l11.15"></a><span id="l11.15">   if (notify)</span>
<a href="#l11.16"></a><span id="l11.16">     NotifyCardEntryChange(AB_NotifyInserted, newCard, aList);</span>
<a href="#l11.17"></a><span id="l11.17"> </span>
<a href="#l11.18"></a><span id="l11.18">   return rv;</span>
<a href="#l11.19"></a><span id="l11.19"> }</span>
<a href="#l11.20"></a><span id="l11.20"> </span>
<a href="#l11.21"></a><span id="l11.21"> NS_IMETHODIMP nsAddrDatabase::AddListCardColumnsToRow</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineat">@@ -1383,17 +1383,17 @@ nsresult nsAddrDatabase::AddListAttribut</span>
<a href="#l11.23"></a><span id="l11.23">             // start from 1</span>
<a href="#l11.24"></a><span id="l11.24">             pos = i + 1;</span>
<a href="#l11.25"></a><span id="l11.25">             pCard-&gt;GetPrimaryEmail(email);</span>
<a href="#l11.26"></a><span id="l11.26">             if (!email.IsEmpty())</span>
<a href="#l11.27"></a><span id="l11.27">             {</span>
<a href="#l11.28"></a><span id="l11.28">                 nsCOMPtr&lt;nsIAbCard&gt; pNewCard;</span>
<a href="#l11.29"></a><span id="l11.29">                 err = AddListCardColumnsToRow(pCard, listRow, pos, getter_AddRefs(pNewCard), listHasCard, list, aParent);</span>
<a href="#l11.30"></a><span id="l11.30">                 if (pNewCard)</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineminus">-                    pAddressLists-&gt;ReplaceElementAt(pNewCard, i, false);</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+                    pAddressLists-&gt;ReplaceElementAt(pNewCard, i);</span>
<a href="#l11.33"></a><span id="l11.33">             }</span>
<a href="#l11.34"></a><span id="l11.34">         }</span>
<a href="#l11.35"></a><span id="l11.35">     }</span>
<a href="#l11.36"></a><span id="l11.36">     return NS_OK;</span>
<a href="#l11.37"></a><span id="l11.37"> }</span>
<a href="#l11.38"></a><span id="l11.38"> </span>
<a href="#l11.39"></a><span id="l11.39"> uint32_t nsAddrDatabase::GetListAddressTotal(nsIMdbRow* listRow)</span>
<a href="#l11.40"></a><span id="l11.40"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgFilter.cpp</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgFilter.cpp</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -240,17 +240,17 @@ NS_IMETHODIMP nsMsgFilter::AddTerm(</span>
<a href="#l12.4"></a><span id="l12.4"> }</span>
<a href="#l12.5"></a><span id="l12.5"> </span>
<a href="#l12.6"></a><span id="l12.6"> NS_IMETHODIMP nsMsgFilter::AppendTerm(nsIMsgSearchTerm * aTerm)</span>
<a href="#l12.7"></a><span id="l12.7"> {</span>
<a href="#l12.8"></a><span id="l12.8">     NS_ENSURE_TRUE(aTerm, NS_ERROR_NULL_POINTER);</span>
<a href="#l12.9"></a><span id="l12.9">     // invalidate expression tree if we're changing the terms</span>
<a href="#l12.10"></a><span id="l12.10">     delete m_expressionTree;</span>
<a href="#l12.11"></a><span id="l12.11">     m_expressionTree = nullptr;</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-    return m_termList-&gt;AppendElement(aTerm, /* weak = */ false);</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+    return m_termList-&gt;AppendElement(aTerm);</span>
<a href="#l12.14"></a><span id="l12.14"> }</span>
<a href="#l12.15"></a><span id="l12.15"> </span>
<a href="#l12.16"></a><span id="l12.16"> NS_IMETHODIMP</span>
<a href="#l12.17"></a><span id="l12.17"> nsMsgFilter::CreateTerm(nsIMsgSearchTerm **aResult)</span>
<a href="#l12.18"></a><span id="l12.18"> {</span>
<a href="#l12.19"></a><span id="l12.19">     NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l12.20"></a><span id="l12.20">     NS_ADDREF(*aResult = new nsMsgSearchTerm);</span>
<a href="#l12.21"></a><span id="l12.21">     return NS_OK;</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineat">@@ -304,56 +304,56 @@ nsMsgFilter::GetSortedActionList(nsIArra</span>
<a href="#l12.23"></a><span id="l12.23"> </span>
<a href="#l12.24"></a><span id="l12.24">     nsMsgRuleActionType actionType;</span>
<a href="#l12.25"></a><span id="l12.25">     action-&gt;GetType(&amp;actionType);</span>
<a href="#l12.26"></a><span id="l12.26">     switch (actionType)</span>
<a href="#l12.27"></a><span id="l12.27">     {</span>
<a href="#l12.28"></a><span id="l12.28">       case nsMsgFilterAction::FetchBodyFromPop3Server:</span>
<a href="#l12.29"></a><span id="l12.29">       {</span>
<a href="#l12.30"></a><span id="l12.30">         // always insert in front</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineminus">-        rv = orderedActions-&gt;InsertElementAt(action, 0, false);</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+        rv = orderedActions-&gt;InsertElementAt(action, 0);</span>
<a href="#l12.33"></a><span id="l12.33">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l12.34"></a><span id="l12.34">         ++nextIndexForNormal;</span>
<a href="#l12.35"></a><span id="l12.35">         ++nextIndexForCopy;</span>
<a href="#l12.36"></a><span id="l12.36">         ++nextIndexForMove;</span>
<a href="#l12.37"></a><span id="l12.37">         break;</span>
<a href="#l12.38"></a><span id="l12.38">       }</span>
<a href="#l12.39"></a><span id="l12.39"> </span>
<a href="#l12.40"></a><span id="l12.40">       case nsMsgFilterAction::CopyToFolder:</span>
<a href="#l12.41"></a><span id="l12.41">       {</span>
<a href="#l12.42"></a><span id="l12.42">         // insert into copy actions block, in order of appearance</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineminus">-        rv = orderedActions-&gt;InsertElementAt(action, nextIndexForCopy, false);</span>
<a href="#l12.44"></a><span id="l12.44" class="difflineplus">+        rv = orderedActions-&gt;InsertElementAt(action, nextIndexForCopy);</span>
<a href="#l12.45"></a><span id="l12.45">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l12.46"></a><span id="l12.46">         ++nextIndexForCopy;</span>
<a href="#l12.47"></a><span id="l12.47">         ++nextIndexForMove;</span>
<a href="#l12.48"></a><span id="l12.48">         break;</span>
<a href="#l12.49"></a><span id="l12.49">       }</span>
<a href="#l12.50"></a><span id="l12.50"> </span>
<a href="#l12.51"></a><span id="l12.51">       case nsMsgFilterAction::MoveToFolder:</span>
<a href="#l12.52"></a><span id="l12.52">       case nsMsgFilterAction::Delete:</span>
<a href="#l12.53"></a><span id="l12.53">       {</span>
<a href="#l12.54"></a><span id="l12.54">         // insert into move/delete action block</span>
<a href="#l12.55"></a><span id="l12.55" class="difflineminus">-        rv = orderedActions-&gt;InsertElementAt(action, nextIndexForMove, false);</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineplus">+        rv = orderedActions-&gt;InsertElementAt(action, nextIndexForMove);</span>
<a href="#l12.57"></a><span id="l12.57">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l12.58"></a><span id="l12.58">         ++nextIndexForMove;</span>
<a href="#l12.59"></a><span id="l12.59">         break;</span>
<a href="#l12.60"></a><span id="l12.60">       }</span>
<a href="#l12.61"></a><span id="l12.61"> </span>
<a href="#l12.62"></a><span id="l12.62">       case nsMsgFilterAction::StopExecution:</span>
<a href="#l12.63"></a><span id="l12.63">       {</span>
<a href="#l12.64"></a><span id="l12.64">         // insert into stop action block</span>
<a href="#l12.65"></a><span id="l12.65" class="difflineminus">-        rv = orderedActions-&gt;AppendElement(action, false);</span>
<a href="#l12.66"></a><span id="l12.66" class="difflineplus">+        rv = orderedActions-&gt;AppendElement(action);</span>
<a href="#l12.67"></a><span id="l12.67">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l12.68"></a><span id="l12.68">         break;</span>
<a href="#l12.69"></a><span id="l12.69">       }</span>
<a href="#l12.70"></a><span id="l12.70"> </span>
<a href="#l12.71"></a><span id="l12.71">       default:</span>
<a href="#l12.72"></a><span id="l12.72">       {</span>
<a href="#l12.73"></a><span id="l12.73">         // insert into normal action block, in order of appearance</span>
<a href="#l12.74"></a><span id="l12.74" class="difflineminus">-        rv = orderedActions-&gt;InsertElementAt(action, nextIndexForNormal, false);</span>
<a href="#l12.75"></a><span id="l12.75" class="difflineplus">+        rv = orderedActions-&gt;InsertElementAt(action, nextIndexForNormal);</span>
<a href="#l12.76"></a><span id="l12.76">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l12.77"></a><span id="l12.77">         ++nextIndexForNormal;</span>
<a href="#l12.78"></a><span id="l12.78">         ++nextIndexForCopy;</span>
<a href="#l12.79"></a><span id="l12.79">         ++nextIndexForMove;</span>
<a href="#l12.80"></a><span id="l12.80">         break;</span>
<a href="#l12.81"></a><span id="l12.81">       }</span>
<a href="#l12.82"></a><span id="l12.82">     }</span>
<a href="#l12.83"></a><span id="l12.83">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgFilterService.cpp</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgFilterService.cpp</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -487,17 +487,17 @@ NS_IMETHODIMP nsMsgFilterAfterTheFact::O</span>
<a href="#l13.4"></a><span id="l13.4">   header-&gt;GetMessageKey(&amp;msgKey);</span>
<a href="#l13.5"></a><span id="l13.5"> </span>
<a href="#l13.6"></a><span id="l13.6">   // Under various previous actions (a move, delete, or stopExecution)</span>
<a href="#l13.7"></a><span id="l13.7">   //  we do not want to process filters on a per-message basis.</span>
<a href="#l13.8"></a><span id="l13.8">   if (m_stopFiltering.Contains(msgKey))</span>
<a href="#l13.9"></a><span id="l13.9">     return NS_OK;</span>
<a href="#l13.10"></a><span id="l13.10"> </span>
<a href="#l13.11"></a><span id="l13.11">   m_searchHits.AppendElement(msgKey);</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-  m_searchHitHdrs-&gt;AppendElement(header, false);</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+  m_searchHitHdrs-&gt;AppendElement(header);</span>
<a href="#l13.14"></a><span id="l13.14">   return NS_OK;</span>
<a href="#l13.15"></a><span id="l13.15"> }</span>
<a href="#l13.16"></a><span id="l13.16"> </span>
<a href="#l13.17"></a><span id="l13.17"> // Continue after an async operation.</span>
<a href="#l13.18"></a><span id="l13.18"> NS_IMETHODIMP nsMsgFilterAfterTheFact::OnSearchDone(nsresult status)</span>
<a href="#l13.19"></a><span id="l13.19"> {</span>
<a href="#l13.20"></a><span id="l13.20">   if (NS_SUCCEEDED(status))</span>
<a href="#l13.21"></a><span id="l13.21">     return m_searchHits.IsEmpty() ? RunNextFilter() : ApplyFilter();</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineat">@@ -806,17 +806,17 @@ nsresult nsMsgFilterAfterTheFact::ApplyF</span>
<a href="#l13.23"></a><span id="l13.23">             CONTINUE_IF_FALSE(msgHdr, &quot;Could not get msgHdr&quot;);</span>
<a href="#l13.24"></a><span id="l13.24">             uint32_t flags;</span>
<a href="#l13.25"></a><span id="l13.25">             msgHdr-&gt;GetFlags(&amp;flags);</span>
<a href="#l13.26"></a><span id="l13.26">             if (flags &amp; nsMsgMessageFlags::Partial)</span>
<a href="#l13.27"></a><span id="l13.27">             {</span>
<a href="#l13.28"></a><span id="l13.28">               if (!partialMsgs)</span>
<a href="#l13.29"></a><span id="l13.29">                 partialMsgs = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l13.30"></a><span id="l13.30">               CONTINUE_IF_FALSE(partialMsgs, &quot;Could not create partialMsgs array&quot;);</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineminus">-              partialMsgs-&gt;AppendElement(msgHdr, false);</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+              partialMsgs-&gt;AppendElement(msgHdr);</span>
<a href="#l13.33"></a><span id="l13.33">               m_stopFiltering.AppendElement(m_searchHits[msgIndex]);</span>
<a href="#l13.34"></a><span id="l13.34">               m_curFolder-&gt;OrProcessingFlags(m_searchHits[msgIndex],</span>
<a href="#l13.35"></a><span id="l13.35">                                              nsMsgProcessingFlags::FilterToMove);</span>
<a href="#l13.36"></a><span id="l13.36">             }</span>
<a href="#l13.37"></a><span id="l13.37">           }</span>
<a href="#l13.38"></a><span id="l13.38">           if (partialMsgs)</span>
<a href="#l13.39"></a><span id="l13.39">           {</span>
<a href="#l13.40"></a><span id="l13.40">             m_curFolder-&gt;DeleteMessages(partialMsgs, m_msgWindow, true, false, nullptr, false);</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineat">@@ -832,17 +832,17 @@ nsresult nsMsgFilterAfterTheFact::ApplyF</span>
<a href="#l13.42"></a><span id="l13.42">           CONTINUE_IF_FAILURE(rv, &quot;Could not create messages array&quot;);</span>
<a href="#l13.43"></a><span id="l13.43">           for (uint32_t msgIndex = 0; msgIndex &lt; m_searchHits.Length(); msgIndex++)</span>
<a href="#l13.44"></a><span id="l13.44">           {</span>
<a href="#l13.45"></a><span id="l13.45">             nsCOMPtr&lt;nsIMsgDBHdr&gt; msgHdr = do_QueryElementAt(m_searchHitHdrs, msgIndex);</span>
<a href="#l13.46"></a><span id="l13.46">             CONTINUE_IF_FALSE(msgHdr, &quot;Could not get msgHdr&quot;);</span>
<a href="#l13.47"></a><span id="l13.47">             uint32_t flags = 0;</span>
<a href="#l13.48"></a><span id="l13.48">             msgHdr-&gt;GetFlags(&amp;flags);</span>
<a href="#l13.49"></a><span id="l13.49">             if (flags &amp; nsMsgMessageFlags::Partial)</span>
<a href="#l13.50"></a><span id="l13.50" class="difflineminus">-              messages-&gt;AppendElement(msgHdr, false);</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineplus">+              messages-&gt;AppendElement(msgHdr);</span>
<a href="#l13.52"></a><span id="l13.52">           }</span>
<a href="#l13.53"></a><span id="l13.53">           uint32_t msgsToFetch;</span>
<a href="#l13.54"></a><span id="l13.54">           messages-&gt;GetLength(&amp;msgsToFetch);</span>
<a href="#l13.55"></a><span id="l13.55">           if (msgsToFetch &gt; 0)</span>
<a href="#l13.56"></a><span id="l13.56">           {</span>
<a href="#l13.57"></a><span id="l13.57">             rv = m_curFolder-&gt;DownloadMessagesForOffline(messages, m_msgWindow);</span>
<a href="#l13.58"></a><span id="l13.58">             CONTINUE_IF_FAILURE(rv, &quot;DownloadMessagesForOffline failed&quot;);</span>
<a href="#l13.59"></a><span id="l13.59">           }</span>
<a href="#l13.60"></a><span id="l13.60" class="difflineat">@@ -1097,17 +1097,17 @@ NS_IMETHODIMP nsMsgFilterService::ApplyF</span>
<a href="#l13.61"></a><span id="l13.61"> </span>
<a href="#l13.62"></a><span id="l13.62">   nsCOMPtr&lt;nsIMsgFilterList&gt;    filterList;</span>
<a href="#l13.63"></a><span id="l13.63">   nsresult rv = aFolder-&gt;GetFilterList(aMsgWindow, getter_AddRefs(filterList));</span>
<a href="#l13.64"></a><span id="l13.64">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l13.65"></a><span id="l13.65"> </span>
<a href="#l13.66"></a><span id="l13.66">   nsCOMPtr&lt;nsIMutableArray&gt; folderList(do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l13.67"></a><span id="l13.67">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l13.68"></a><span id="l13.68"> </span>
<a href="#l13.69"></a><span id="l13.69" class="difflineminus">-  folderList-&gt;AppendElement(aFolder, false);</span>
<a href="#l13.70"></a><span id="l13.70" class="difflineplus">+  folderList-&gt;AppendElement(aFolder);</span>
<a href="#l13.71"></a><span id="l13.71"> </span>
<a href="#l13.72"></a><span id="l13.72">   // Create our nsMsgApplyFiltersToMessages object which will be called when ApplyFiltersToHdr</span>
<a href="#l13.73"></a><span id="l13.73">   // finds one or more filters that hit.</span>
<a href="#l13.74"></a><span id="l13.74">   RefPtr&lt;nsMsgApplyFiltersToMessages&gt; filterExecutor =</span>
<a href="#l13.75"></a><span id="l13.75">     new nsMsgApplyFiltersToMessages(aMsgWindow, filterList, folderList,</span>
<a href="#l13.76"></a><span id="l13.76">                                     aMsgHdrList, aFilterType, aCallback);</span>
<a href="#l13.77"></a><span id="l13.77"> </span>
<a href="#l13.78"></a><span id="l13.78">   if (filterExecutor)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgSearchSession.cpp</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgSearchSession.cpp</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -57,31 +57,31 @@ nsMsgSearchSession::AddSearchTerm(nsMsgS</span>
<a href="#l14.4"></a><span id="l14.4">   if (BooleanANDp)</span>
<a href="#l14.5"></a><span id="l14.5">     boolOp = (nsMsgSearchBooleanOperator)nsMsgSearchBooleanOp::BooleanAND;</span>
<a href="#l14.6"></a><span id="l14.6">   else</span>
<a href="#l14.7"></a><span id="l14.7">     boolOp = (nsMsgSearchBooleanOperator)nsMsgSearchBooleanOp::BooleanOR;</span>
<a href="#l14.8"></a><span id="l14.8">   nsMsgSearchTerm *pTerm = new nsMsgSearchTerm(attrib, op, value,</span>
<a href="#l14.9"></a><span id="l14.9">                                                boolOp, customString);</span>
<a href="#l14.10"></a><span id="l14.10">   NS_ENSURE_TRUE(pTerm, NS_ERROR_OUT_OF_MEMORY);</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-  m_termList-&gt;AppendElement(pTerm, /* weak = */ false);</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+  m_termList-&gt;AppendElement(pTerm);</span>
<a href="#l14.14"></a><span id="l14.14">   // force the expression tree to rebuild whenever we change the terms</span>
<a href="#l14.15"></a><span id="l14.15">   delete m_expressionTree;</span>
<a href="#l14.16"></a><span id="l14.16">   m_expressionTree = nullptr;</span>
<a href="#l14.17"></a><span id="l14.17">   return NS_OK;</span>
<a href="#l14.18"></a><span id="l14.18"> }</span>
<a href="#l14.19"></a><span id="l14.19"> </span>
<a href="#l14.20"></a><span id="l14.20"> NS_IMETHODIMP</span>
<a href="#l14.21"></a><span id="l14.21"> nsMsgSearchSession::AppendTerm(nsIMsgSearchTerm *aTerm)</span>
<a href="#l14.22"></a><span id="l14.22"> {</span>
<a href="#l14.23"></a><span id="l14.23">     NS_ENSURE_ARG_POINTER(aTerm);</span>
<a href="#l14.24"></a><span id="l14.24">     NS_ENSURE_TRUE(m_termList, NS_ERROR_NOT_INITIALIZED);</span>
<a href="#l14.25"></a><span id="l14.25">     delete m_expressionTree;</span>
<a href="#l14.26"></a><span id="l14.26">     m_expressionTree = nullptr;</span>
<a href="#l14.27"></a><span id="l14.27" class="difflineminus">-    return m_termList-&gt;AppendElement(aTerm, /* weak = */ false);</span>
<a href="#l14.28"></a><span id="l14.28" class="difflineplus">+    return m_termList-&gt;AppendElement(aTerm);</span>
<a href="#l14.29"></a><span id="l14.29"> }</span>
<a href="#l14.30"></a><span id="l14.30"> </span>
<a href="#l14.31"></a><span id="l14.31"> NS_IMETHODIMP</span>
<a href="#l14.32"></a><span id="l14.32"> nsMsgSearchSession::GetSearchTerms(nsIMutableArray **aResult)</span>
<a href="#l14.33"></a><span id="l14.33"> {</span>
<a href="#l14.34"></a><span id="l14.34">     NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l14.35"></a><span id="l14.35">     NS_ADDREF(*aResult = m_termList);</span>
<a href="#l14.36"></a><span id="l14.36">     return NS_OK;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/base/src/nsMessenger.cpp</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/base/src/nsMessenger.cpp</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -2682,17 +2682,17 @@ nsDelAttachListener::OnStartRunningUrl(n</span>
<a href="#l15.4"></a><span id="l15.4"> }</span>
<a href="#l15.5"></a><span id="l15.5"> </span>
<a href="#l15.6"></a><span id="l15.6"> nsresult nsDelAttachListener::DeleteOriginalMessage()</span>
<a href="#l15.7"></a><span id="l15.7"> {</span>
<a href="#l15.8"></a><span id="l15.8">   nsresult rv;</span>
<a href="#l15.9"></a><span id="l15.9">   nsCOMPtr&lt;nsIMutableArray&gt; messageArray(do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l15.10"></a><span id="l15.10">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l15.11"></a><span id="l15.11"> </span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-  rv = messageArray-&gt;AppendElement(mOriginalMessage, false);</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+  rv = messageArray-&gt;AppendElement(mOriginalMessage);</span>
<a href="#l15.14"></a><span id="l15.14">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l15.15"></a><span id="l15.15">   nsCOMPtr&lt;nsIMsgCopyServiceListener&gt; listenerCopyService;</span>
<a href="#l15.16"></a><span id="l15.16"> </span>
<a href="#l15.17"></a><span id="l15.17">   QueryInterface( NS_GET_IID(nsIMsgCopyServiceListener), getter_AddRefs(listenerCopyService) );</span>
<a href="#l15.18"></a><span id="l15.18"> </span>
<a href="#l15.19"></a><span id="l15.19">   mOriginalMessage = nullptr;</span>
<a href="#l15.20"></a><span id="l15.20">   m_state = eDeletingOldMessage;</span>
<a href="#l15.21"></a><span id="l15.21">   return mMessageFolder-&gt;DeleteMessages(</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/base/src/nsMessengerBootstrap.cpp</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/base/src/nsMessengerBootstrap.cpp</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -49,30 +49,30 @@ NS_IMETHODIMP nsMessengerBootstrap::Open</span>
<a href="#l16.4"></a><span id="l16.4">       nsAutoCString msgUri;</span>
<a href="#l16.5"></a><span id="l16.5">       folder-&gt;GetBaseMessageURI(msgUri);</span>
<a href="#l16.6"></a><span id="l16.6"> </span>
<a href="#l16.7"></a><span id="l16.7">       nsCOMPtr&lt;nsISupportsCString&gt; scriptableMsgURI (do_CreateInstance(NS_SUPPORTS_CSTRING_CONTRACTID));</span>
<a href="#l16.8"></a><span id="l16.8">       NS_ENSURE_TRUE(scriptableMsgURI, NS_ERROR_FAILURE);</span>
<a href="#l16.9"></a><span id="l16.9">       msgUri.Append('#');</span>
<a href="#l16.10"></a><span id="l16.10">       msgUri.AppendInt(aMessageKey, 10);</span>
<a href="#l16.11"></a><span id="l16.11">       scriptableMsgURI-&gt;SetData(msgUri);</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-      argsArray-&gt;AppendElement(scriptableMsgURI, false);</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+      argsArray-&gt;AppendElement(scriptableMsgURI);</span>
<a href="#l16.14"></a><span id="l16.14">     }</span>
<a href="#l16.15"></a><span id="l16.15">     nsCOMPtr&lt;nsISupportsCString&gt; scriptableFolderURI (do_CreateInstance(NS_SUPPORTS_CSTRING_CONTRACTID));</span>
<a href="#l16.16"></a><span id="l16.16">     NS_ENSURE_TRUE(scriptableFolderURI, NS_ERROR_FAILURE);</span>
<a href="#l16.17"></a><span id="l16.17"> </span>
<a href="#l16.18"></a><span id="l16.18">     scriptableFolderURI-&gt;SetData(nsDependentCString(aFolderURI));</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineminus">-    argsArray-&gt;AppendElement(scriptableFolderURI, false);</span>
<a href="#l16.20"></a><span id="l16.20" class="difflineplus">+    argsArray-&gt;AppendElement(scriptableFolderURI);</span>
<a href="#l16.21"></a><span id="l16.21"> </span>
<a href="#l16.22"></a><span id="l16.22">     if (!standAloneMsgWindow)</span>
<a href="#l16.23"></a><span id="l16.23">     {</span>
<a href="#l16.24"></a><span id="l16.24">       nsCOMPtr&lt;nsISupportsPRUint32&gt; scriptableMessageKey (do_CreateInstance(NS_SUPPORTS_PRUINT32_CONTRACTID));</span>
<a href="#l16.25"></a><span id="l16.25">       NS_ENSURE_TRUE(scriptableMessageKey, NS_ERROR_FAILURE);</span>
<a href="#l16.26"></a><span id="l16.26">       scriptableMessageKey-&gt;SetData(aMessageKey);</span>
<a href="#l16.27"></a><span id="l16.27" class="difflineminus">-      argsArray-&gt;AppendElement(scriptableMessageKey, false);</span>
<a href="#l16.28"></a><span id="l16.28" class="difflineplus">+      argsArray-&gt;AppendElement(scriptableMessageKey);</span>
<a href="#l16.29"></a><span id="l16.29">     }</span>
<a href="#l16.30"></a><span id="l16.30">   }</span>
<a href="#l16.31"></a><span id="l16.31"> </span>
<a href="#l16.32"></a><span id="l16.32">   nsCOMPtr&lt;nsIWindowWatcher&gt; wwatch(do_GetService(NS_WINDOWWATCHER_CONTRACTID, &amp;rv));</span>
<a href="#l16.33"></a><span id="l16.33">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l16.34"></a><span id="l16.34"> </span>
<a href="#l16.35"></a><span id="l16.35">   // we need to use the &quot;mailnews.reuse_thread_window2&quot; pref</span>
<a href="#l16.36"></a><span id="l16.36">   // to determine if we should open a new window, or use an existing one.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mailnews/base/src/nsMessengerUnixIntegration.cpp</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mailnews/base/src/nsMessengerUnixIntegration.cpp</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -379,31 +379,31 @@ nsresult nsMessengerUnixIntegration::Sho</span>
<a href="#l17.4"></a><span id="l17.4">   if (!argsArray)</span>
<a href="#l17.5"></a><span id="l17.5">     return NS_ERROR_FAILURE;</span>
<a href="#l17.6"></a><span id="l17.6"> </span>
<a href="#l17.7"></a><span id="l17.7">   // pass in the array of folders with unread messages</span>
<a href="#l17.8"></a><span id="l17.8">   nsCOMPtr&lt;nsISupportsInterfacePointer&gt; ifptr = do_CreateInstance(NS_SUPPORTS_INTERFACE_POINTER_CONTRACTID, &amp;rv);</span>
<a href="#l17.9"></a><span id="l17.9">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l17.10"></a><span id="l17.10">   ifptr-&gt;SetData(mFoldersWithNewMail);</span>
<a href="#l17.11"></a><span id="l17.11">   ifptr-&gt;SetDataIID(&amp;NS_GET_IID(nsIArray));</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-  argsArray-&gt;AppendElement(ifptr, false);</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+  argsArray-&gt;AppendElement(ifptr);</span>
<a href="#l17.14"></a><span id="l17.14"> </span>
<a href="#l17.15"></a><span id="l17.15">   // pass in the observer</span>
<a href="#l17.16"></a><span id="l17.16">   ifptr = do_CreateInstance(NS_SUPPORTS_INTERFACE_POINTER_CONTRACTID, &amp;rv);</span>
<a href="#l17.17"></a><span id="l17.17">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l17.18"></a><span id="l17.18">   nsCOMPtr &lt;nsISupports&gt; supports = do_QueryInterface(static_cast&lt;nsIMessengerOSIntegration*&gt;(this));</span>
<a href="#l17.19"></a><span id="l17.19">   ifptr-&gt;SetData(supports);</span>
<a href="#l17.20"></a><span id="l17.20">   ifptr-&gt;SetDataIID(&amp;NS_GET_IID(nsIObserver));</span>
<a href="#l17.21"></a><span id="l17.21" class="difflineminus">-  argsArray-&gt;AppendElement(ifptr, false);</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineplus">+  argsArray-&gt;AppendElement(ifptr);</span>
<a href="#l17.23"></a><span id="l17.23"> </span>
<a href="#l17.24"></a><span id="l17.24">   // pass in the animation flag</span>
<a href="#l17.25"></a><span id="l17.25">   nsCOMPtr&lt;nsISupportsPRBool&gt; scriptableUserInitiated (do_CreateInstance(NS_SUPPORTS_PRBOOL_CONTRACTID, &amp;rv));</span>
<a href="#l17.26"></a><span id="l17.26">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l17.27"></a><span id="l17.27">   scriptableUserInitiated-&gt;SetData(aUserInitiated);</span>
<a href="#l17.28"></a><span id="l17.28" class="difflineminus">-  argsArray-&gt;AppendElement(scriptableUserInitiated, false);</span>
<a href="#l17.29"></a><span id="l17.29" class="difflineplus">+  argsArray-&gt;AppendElement(scriptableUserInitiated);</span>
<a href="#l17.30"></a><span id="l17.30"> </span>
<a href="#l17.31"></a><span id="l17.31">   nsCOMPtr&lt;nsIWindowWatcher&gt; wwatch(do_GetService(NS_WINDOWWATCHER_CONTRACTID));</span>
<a href="#l17.32"></a><span id="l17.32">   nsCOMPtr&lt;mozIDOMWindowProxy&gt; newWindow;</span>
<a href="#l17.33"></a><span id="l17.33"> </span>
<a href="#l17.34"></a><span id="l17.34">   mAlertInProgress = true;</span>
<a href="#l17.35"></a><span id="l17.35">   rv = wwatch-&gt;OpenWindow(0, ALERT_CHROME_URL, &quot;_blank&quot;,</span>
<a href="#l17.36"></a><span id="l17.36">                           &quot;chrome,dialog=yes,titlebar=no,popup=yes&quot;, argsArray,</span>
<a href="#l17.37"></a><span id="l17.37">                           getter_AddRefs(newWindow));</span>
<a href="#l17.38"></a><span id="l17.38" class="difflineat">@@ -689,17 +689,17 @@ nsMessengerUnixIntegration::OnItemIntPro</span>
<a href="#l17.39"></a><span id="l17.39">       nsCOMPtr&lt;nsIMsgIncomingServer&gt; server;</span>
<a href="#l17.40"></a><span id="l17.40">       aItem-&gt;GetServer(getter_AddRefs(server));</span>
<a href="#l17.41"></a><span id="l17.41">       if (server)</span>
<a href="#l17.42"></a><span id="l17.42">         server-&gt;GetPerformingBiff(&amp;performingBiff);</span>
<a href="#l17.43"></a><span id="l17.43">       if (!performingBiff)</span>
<a href="#l17.44"></a><span id="l17.44">         return NS_OK; // kick out right now...</span>
<a href="#l17.45"></a><span id="l17.45"> </span>
<a href="#l17.46"></a><span id="l17.46">       if (!folderFound)</span>
<a href="#l17.47"></a><span id="l17.47" class="difflineminus">-        mFoldersWithNewMail-&gt;AppendElement(weakFolder, false);</span>
<a href="#l17.48"></a><span id="l17.48" class="difflineplus">+        mFoldersWithNewMail-&gt;AppendElement(weakFolder);</span>
<a href="#l17.49"></a><span id="l17.49">       // now regenerate the tooltip</span>
<a href="#l17.50"></a><span id="l17.50">       FillToolTipInfo();</span>
<a href="#l17.51"></a><span id="l17.51">     }</span>
<a href="#l17.52"></a><span id="l17.52">     else if (aNewValue == nsIMsgFolder::nsMsgBiffState_NoMail)</span>
<a href="#l17.53"></a><span id="l17.53">     {</span>
<a href="#l17.54"></a><span id="l17.54">       if (folderFound) {</span>
<a href="#l17.55"></a><span id="l17.55">         mFoldersWithNewMail-&gt;RemoveElementAt(indexInNewArray);</span>
<a href="#l17.56"></a><span id="l17.56">       }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mailnews/base/src/nsMessengerWinIntegration.cpp</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mailnews/base/src/nsMessengerWinIntegration.cpp</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -486,44 +486,44 @@ nsresult nsMessengerWinIntegration::Show</span>
<a href="#l18.4"></a><span id="l18.4">     nsCOMPtr&lt;nsIMutableArray&gt; argsArray(do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l18.5"></a><span id="l18.5">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l18.6"></a><span id="l18.6"> </span>
<a href="#l18.7"></a><span id="l18.7">     // pass in the array of folders with unread messages</span>
<a href="#l18.8"></a><span id="l18.8">     nsCOMPtr&lt;nsISupportsInterfacePointer&gt; ifptr = do_CreateInstance(NS_SUPPORTS_INTERFACE_POINTER_CONTRACTID, &amp;rv);</span>
<a href="#l18.9"></a><span id="l18.9">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l18.10"></a><span id="l18.10">     ifptr-&gt;SetData(mFoldersWithNewMail);</span>
<a href="#l18.11"></a><span id="l18.11">     ifptr-&gt;SetDataIID(&amp;NS_GET_IID(nsIArray));</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-    rv = argsArray-&gt;AppendElement(ifptr, false);</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+    rv = argsArray-&gt;AppendElement(ifptr);</span>
<a href="#l18.14"></a><span id="l18.14">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l18.15"></a><span id="l18.15"> </span>
<a href="#l18.16"></a><span id="l18.16">     // pass in the observer</span>
<a href="#l18.17"></a><span id="l18.17">     ifptr = do_CreateInstance(NS_SUPPORTS_INTERFACE_POINTER_CONTRACTID, &amp;rv);</span>
<a href="#l18.18"></a><span id="l18.18">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l18.19"></a><span id="l18.19">     nsCOMPtr &lt;nsISupports&gt; supports = do_QueryInterface(static_cast&lt;nsIMessengerOSIntegration*&gt;(this));</span>
<a href="#l18.20"></a><span id="l18.20">     ifptr-&gt;SetData(supports);</span>
<a href="#l18.21"></a><span id="l18.21">     ifptr-&gt;SetDataIID(&amp;NS_GET_IID(nsIObserver));</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineminus">-    rv = argsArray-&gt;AppendElement(ifptr, false);</span>
<a href="#l18.23"></a><span id="l18.23" class="difflineplus">+    rv = argsArray-&gt;AppendElement(ifptr);</span>
<a href="#l18.24"></a><span id="l18.24">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l18.25"></a><span id="l18.25"> </span>
<a href="#l18.26"></a><span id="l18.26">     // pass in the animation flag</span>
<a href="#l18.27"></a><span id="l18.27">     nsCOMPtr&lt;nsISupportsPRBool&gt; scriptableUserInitiated (do_CreateInstance(NS_SUPPORTS_PRBOOL_CONTRACTID, &amp;rv));</span>
<a href="#l18.28"></a><span id="l18.28">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l18.29"></a><span id="l18.29">     scriptableUserInitiated-&gt;SetData(aUserInitiated);</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineminus">-    rv = argsArray-&gt;AppendElement(scriptableUserInitiated, false);</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineplus">+    rv = argsArray-&gt;AppendElement(scriptableUserInitiated);</span>
<a href="#l18.32"></a><span id="l18.32">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l18.33"></a><span id="l18.33"> </span>
<a href="#l18.34"></a><span id="l18.34">     // pass in the alert origin</span>
<a href="#l18.35"></a><span id="l18.35">     nsCOMPtr&lt;nsISupportsPRUint8&gt; scriptableOrigin (do_CreateInstance(NS_SUPPORTS_PRUINT8_CONTRACTID));</span>
<a href="#l18.36"></a><span id="l18.36">     NS_ENSURE_TRUE(scriptableOrigin, NS_ERROR_FAILURE);</span>
<a href="#l18.37"></a><span id="l18.37">     scriptableOrigin-&gt;SetData(0);</span>
<a href="#l18.38"></a><span id="l18.38">     int32_t origin = 0;</span>
<a href="#l18.39"></a><span id="l18.39">     origin = LookAndFeel::GetInt(LookAndFeel::eIntID_AlertNotificationOrigin);</span>
<a href="#l18.40"></a><span id="l18.40">     scriptableOrigin-&gt;SetData(origin);</span>
<a href="#l18.41"></a><span id="l18.41"> </span>
<a href="#l18.42"></a><span id="l18.42" class="difflineminus">-    rv = argsArray-&gt;AppendElement(scriptableOrigin, false);</span>
<a href="#l18.43"></a><span id="l18.43" class="difflineplus">+    rv = argsArray-&gt;AppendElement(scriptableOrigin);</span>
<a href="#l18.44"></a><span id="l18.44">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l18.45"></a><span id="l18.45"> </span>
<a href="#l18.46"></a><span id="l18.46">     nsCOMPtr&lt;nsIWindowWatcher&gt; wwatch(do_GetService(NS_WINDOWWATCHER_CONTRACTID));</span>
<a href="#l18.47"></a><span id="l18.47">     nsCOMPtr&lt;mozIDOMWindowProxy&gt; newWindow;</span>
<a href="#l18.48"></a><span id="l18.48">     rv = wwatch-&gt;OpenWindow(0, ALERT_CHROME_URL, &quot;_blank&quot;,</span>
<a href="#l18.49"></a><span id="l18.49">                 &quot;chrome,dialog=yes,titlebar=no,popup=yes&quot;, argsArray,</span>
<a href="#l18.50"></a><span id="l18.50">                  getter_AddRefs(newWindow));</span>
<a href="#l18.51"></a><span id="l18.51"> </span>
<a href="#l18.52"></a><span id="l18.52" class="difflineat">@@ -863,17 +863,17 @@ nsMessengerWinIntegration::OnItemIntProp</span>
<a href="#l18.53"></a><span id="l18.53">         nsCOMPtr&lt;nsIMsgIncomingServer&gt; server;</span>
<a href="#l18.54"></a><span id="l18.54">         aItem-&gt;GetServer(getter_AddRefs(server));</span>
<a href="#l18.55"></a><span id="l18.55">         if (server)</span>
<a href="#l18.56"></a><span id="l18.56">           server-&gt;GetPerformingBiff(&amp;performingBiff);</span>
<a href="#l18.57"></a><span id="l18.57">         if (!performingBiff)</span>
<a href="#l18.58"></a><span id="l18.58">           return NS_OK; // kick out right now...</span>
<a href="#l18.59"></a><span id="l18.59">       }</span>
<a href="#l18.60"></a><span id="l18.60">       if (!folderFound)</span>
<a href="#l18.61"></a><span id="l18.61" class="difflineminus">-        mFoldersWithNewMail-&gt;InsertElementAt(weakFolder, 0, false);</span>
<a href="#l18.62"></a><span id="l18.62" class="difflineplus">+        mFoldersWithNewMail-&gt;InsertElementAt(weakFolder, 0);</span>
<a href="#l18.63"></a><span id="l18.63">       // now regenerate the tooltip</span>
<a href="#l18.64"></a><span id="l18.64">       FillToolTipInfo();</span>
<a href="#l18.65"></a><span id="l18.65">     }</span>
<a href="#l18.66"></a><span id="l18.66">     else if (aNewValue == nsIMsgFolder::nsMsgBiffState_NoMail)</span>
<a href="#l18.67"></a><span id="l18.67">     {</span>
<a href="#l18.68"></a><span id="l18.68">       // we are always going to remove the icon whenever we get our first no mail</span>
<a href="#l18.69"></a><span id="l18.69">       // notification.</span>
<a href="#l18.70"></a><span id="l18.70"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mailnews/base/src/nsMsgAccount.cpp</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgAccount.cpp</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -263,31 +263,31 @@ nsMsgAccount::SetDefaultIdentity(nsIMsgI</span>
<a href="#l19.4"></a><span id="l19.4">   uint32_t position = 0;</span>
<a href="#l19.5"></a><span id="l19.5">   nsresult rv = m_identities-&gt;IndexOf(0, aDefaultIdentity, &amp;position);</span>
<a href="#l19.6"></a><span id="l19.6">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l19.7"></a><span id="l19.7"> </span>
<a href="#l19.8"></a><span id="l19.8">   rv = m_identities-&gt;RemoveElementAt(position);</span>
<a href="#l19.9"></a><span id="l19.9">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l19.10"></a><span id="l19.10"> </span>
<a href="#l19.11"></a><span id="l19.11">   // The passed in identity is in the list, so we have at least one element.</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-  rv = m_identities-&gt;InsertElementAt(aDefaultIdentity, 0, false);</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+  rv = m_identities-&gt;InsertElementAt(aDefaultIdentity, 0);</span>
<a href="#l19.14"></a><span id="l19.14">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l19.15"></a><span id="l19.15"> </span>
<a href="#l19.16"></a><span id="l19.16">   return saveIdentitiesPref();</span>
<a href="#l19.17"></a><span id="l19.17"> }</span>
<a href="#l19.18"></a><span id="l19.18"> </span>
<a href="#l19.19"></a><span id="l19.19"> // add the identity to m_identities, but don't fiddle with the</span>
<a href="#l19.20"></a><span id="l19.20"> // prefs. The assumption here is that the pref for this identity is</span>
<a href="#l19.21"></a><span id="l19.21"> // already set.</span>
<a href="#l19.22"></a><span id="l19.22"> nsresult</span>
<a href="#l19.23"></a><span id="l19.23"> nsMsgAccount::addIdentityInternal(nsIMsgIdentity *identity)</span>
<a href="#l19.24"></a><span id="l19.24"> {</span>
<a href="#l19.25"></a><span id="l19.25">   NS_ENSURE_TRUE(m_identities, NS_ERROR_FAILURE);</span>
<a href="#l19.26"></a><span id="l19.26"> </span>
<a href="#l19.27"></a><span id="l19.27" class="difflineminus">-  return m_identities-&gt;AppendElement(identity, false);</span>
<a href="#l19.28"></a><span id="l19.28" class="difflineplus">+  return m_identities-&gt;AppendElement(identity);</span>
<a href="#l19.29"></a><span id="l19.29"> }</span>
<a href="#l19.30"></a><span id="l19.30"> </span>
<a href="#l19.31"></a><span id="l19.31"> /* void addIdentity (in nsIMsgIdentity identity); */</span>
<a href="#l19.32"></a><span id="l19.32"> NS_IMETHODIMP</span>
<a href="#l19.33"></a><span id="l19.33"> nsMsgAccount::AddIdentity(nsIMsgIdentity *identity)</span>
<a href="#l19.34"></a><span id="l19.34"> {</span>
<a href="#l19.35"></a><span id="l19.35">   NS_ENSURE_ARG_POINTER(identity);</span>
<a href="#l19.36"></a><span id="l19.36"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mailnews/base/src/nsMsgAccountManager.cpp</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgAccountManager.cpp</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -920,17 +920,17 @@ nsMsgAccountManager::GetAccounts(nsIArra</span>
<a href="#l20.4"></a><span id="l20.4">       continue;</span>
<a href="#l20.5"></a><span id="l20.5">     if (server)</span>
<a href="#l20.6"></a><span id="l20.6">     {</span>
<a href="#l20.7"></a><span id="l20.7">       bool hidden = false;</span>
<a href="#l20.8"></a><span id="l20.8">       server-&gt;GetHidden(&amp;hidden);</span>
<a href="#l20.9"></a><span id="l20.9">       if (hidden)</span>
<a href="#l20.10"></a><span id="l20.10">         continue;</span>
<a href="#l20.11"></a><span id="l20.11">     }</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-    accounts-&gt;AppendElement(existingAccount, false);</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+    accounts-&gt;AppendElement(existingAccount);</span>
<a href="#l20.14"></a><span id="l20.14">   }</span>
<a href="#l20.15"></a><span id="l20.15">   accounts.forget(_retval);</span>
<a href="#l20.16"></a><span id="l20.16">   return NS_OK;</span>
<a href="#l20.17"></a><span id="l20.17"> }</span>
<a href="#l20.18"></a><span id="l20.18"> </span>
<a href="#l20.19"></a><span id="l20.19"> NS_IMETHODIMP</span>
<a href="#l20.20"></a><span id="l20.20"> nsMsgAccountManager::GetAllIdentities(nsIArray **_retval)</span>
<a href="#l20.21"></a><span id="l20.21"> {</span>
<a href="#l20.22"></a><span id="l20.22" class="difflineat">@@ -978,17 +978,17 @@ nsMsgAccountManager::GetAllIdentities(ns</span>
<a href="#l20.23"></a><span id="l20.23">         if (NS_FAILED(rv))</span>
<a href="#l20.24"></a><span id="l20.24">           continue;</span>
<a href="#l20.25"></a><span id="l20.25"> </span>
<a href="#l20.26"></a><span id="l20.26">         if (key == thisKey)</span>
<a href="#l20.27"></a><span id="l20.27">           found = true;</span>
<a href="#l20.28"></a><span id="l20.28">       }</span>
<a href="#l20.29"></a><span id="l20.29"> </span>
<a href="#l20.30"></a><span id="l20.30">       if (!found)</span>
<a href="#l20.31"></a><span id="l20.31" class="difflineminus">-        result-&gt;AppendElement(identity, false);</span>
<a href="#l20.32"></a><span id="l20.32" class="difflineplus">+        result-&gt;AppendElement(identity);</span>
<a href="#l20.33"></a><span id="l20.33">     }</span>
<a href="#l20.34"></a><span id="l20.34">   }</span>
<a href="#l20.35"></a><span id="l20.35">   result.forget(_retval);</span>
<a href="#l20.36"></a><span id="l20.36">   return rv;</span>
<a href="#l20.37"></a><span id="l20.37"> }</span>
<a href="#l20.38"></a><span id="l20.38"> </span>
<a href="#l20.39"></a><span id="l20.39"> NS_IMETHODIMP</span>
<a href="#l20.40"></a><span id="l20.40"> nsMsgAccountManager::GetAllServers(nsIArray **_retval)</span>
<a href="#l20.41"></a><span id="l20.41" class="difflineat">@@ -1011,17 +1011,17 @@ nsMsgAccountManager::GetAllServers(nsIAr</span>
<a href="#l20.42"></a><span id="l20.42"> </span>
<a href="#l20.43"></a><span id="l20.43">     nsCString type;</span>
<a href="#l20.44"></a><span id="l20.44">     if (NS_FAILED(server-&gt;GetType(type))) {</span>
<a href="#l20.45"></a><span id="l20.45">       NS_WARNING(&quot;server-&gt;GetType() failed&quot;);</span>
<a href="#l20.46"></a><span id="l20.46">       continue;</span>
<a href="#l20.47"></a><span id="l20.47">     }</span>
<a href="#l20.48"></a><span id="l20.48"> </span>
<a href="#l20.49"></a><span id="l20.49">     if (!type.EqualsLiteral(&quot;im&quot;)) {</span>
<a href="#l20.50"></a><span id="l20.50" class="difflineminus">-      servers-&gt;AppendElement(server, false);</span>
<a href="#l20.51"></a><span id="l20.51" class="difflineplus">+      servers-&gt;AppendElement(server);</span>
<a href="#l20.52"></a><span id="l20.52">     }</span>
<a href="#l20.53"></a><span id="l20.53">   }</span>
<a href="#l20.54"></a><span id="l20.54"> </span>
<a href="#l20.55"></a><span id="l20.55">   servers.forget(_retval);</span>
<a href="#l20.56"></a><span id="l20.56">   return rv;</span>
<a href="#l20.57"></a><span id="l20.57"> }</span>
<a href="#l20.58"></a><span id="l20.58"> </span>
<a href="#l20.59"></a><span id="l20.59"> nsresult</span>
<a href="#l20.60"></a><span id="l20.60" class="difflineat">@@ -2125,17 +2125,17 @@ nsMsgAccountManager::GetIdentitiesForSer</span>
<a href="#l20.61"></a><span id="l20.61">         uint32_t theseLength;</span>
<a href="#l20.62"></a><span id="l20.62">         rv = theseIdentities-&gt;GetLength(&amp;theseLength);</span>
<a href="#l20.63"></a><span id="l20.63">         if (NS_SUCCEEDED(rv))</span>
<a href="#l20.64"></a><span id="l20.64">         {</span>
<a href="#l20.65"></a><span id="l20.65">           for (uint32_t j = 0; j &lt; theseLength; ++j)</span>
<a href="#l20.66"></a><span id="l20.66">           {</span>
<a href="#l20.67"></a><span id="l20.67">             nsCOMPtr&lt;nsISupports&gt; id(do_QueryElementAt(theseIdentities, j, &amp;rv));</span>
<a href="#l20.68"></a><span id="l20.68">             if (NS_SUCCEEDED(rv))</span>
<a href="#l20.69"></a><span id="l20.69" class="difflineminus">-              identities-&gt;AppendElement(id, false);</span>
<a href="#l20.70"></a><span id="l20.70" class="difflineplus">+              identities-&gt;AppendElement(id);</span>
<a href="#l20.71"></a><span id="l20.71">           }</span>
<a href="#l20.72"></a><span id="l20.72">         }</span>
<a href="#l20.73"></a><span id="l20.73">       }</span>
<a href="#l20.74"></a><span id="l20.74">     }</span>
<a href="#l20.75"></a><span id="l20.75">   }</span>
<a href="#l20.76"></a><span id="l20.76"> </span>
<a href="#l20.77"></a><span id="l20.77">   identities.forget(_retval);</span>
<a href="#l20.78"></a><span id="l20.78">   return NS_OK;</span>
<a href="#l20.79"></a><span id="l20.79" class="difflineat">@@ -2176,17 +2176,17 @@ nsMsgAccountManager::GetServersForIdenti</span>
<a href="#l20.80"></a><span id="l20.80">         rv = thisIdentity-&gt;GetKey(thisIdentityKey);</span>
<a href="#l20.81"></a><span id="l20.81"> </span>
<a href="#l20.82"></a><span id="l20.82">         if (NS_SUCCEEDED(rv) &amp;&amp; identityKey.Equals(thisIdentityKey))</span>
<a href="#l20.83"></a><span id="l20.83">         {</span>
<a href="#l20.84"></a><span id="l20.84">           nsCOMPtr&lt;nsIMsgIncomingServer&gt; thisServer;</span>
<a href="#l20.85"></a><span id="l20.85">           rv = m_accounts[i]-&gt;GetIncomingServer(getter_AddRefs(thisServer));</span>
<a href="#l20.86"></a><span id="l20.86">           if (thisServer &amp;&amp; NS_SUCCEEDED(rv))</span>
<a href="#l20.87"></a><span id="l20.87">           {</span>
<a href="#l20.88"></a><span id="l20.88" class="difflineminus">-            servers-&gt;AppendElement(thisServer, false);</span>
<a href="#l20.89"></a><span id="l20.89" class="difflineplus">+            servers-&gt;AppendElement(thisServer);</span>
<a href="#l20.90"></a><span id="l20.90">             break;</span>
<a href="#l20.91"></a><span id="l20.91">           }</span>
<a href="#l20.92"></a><span id="l20.92">         }</span>
<a href="#l20.93"></a><span id="l20.93">       }</span>
<a href="#l20.94"></a><span id="l20.94">     }</span>
<a href="#l20.95"></a><span id="l20.95">   }</span>
<a href="#l20.96"></a><span id="l20.96">   servers.forget(_retval);</span>
<a href="#l20.97"></a><span id="l20.97">   return NS_OK;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/mailnews/base/src/nsMsgAccountManagerDS.cpp</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgAccountManagerDS.cpp</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -752,47 +752,47 @@ nsMsgAccountManagerDataSource::serverHas</span>
<a href="#l21.4"></a><span id="l21.4"> nsresult</span>
<a href="#l21.5"></a><span id="l21.5"> nsMsgAccountManagerDataSource::getAccountArcs(nsIMutableArray **aResult)</span>
<a href="#l21.6"></a><span id="l21.6"> {</span>
<a href="#l21.7"></a><span id="l21.7">   nsresult rv;</span>
<a href="#l21.8"></a><span id="l21.8">   if (!mAccountArcsOut) {</span>
<a href="#l21.9"></a><span id="l21.9">     mAccountArcsOut = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l21.10"></a><span id="l21.10">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l21.11"></a><span id="l21.11"> </span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-    mAccountArcsOut-&gt;AppendElement(kNC_Settings, false);</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineminus">-    mAccountArcsOut-&gt;AppendElement(kNC_Name, false);</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineminus">-    mAccountArcsOut-&gt;AppendElement(kNC_FolderTreeName, false);</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineminus">-    mAccountArcsOut-&gt;AppendElement(kNC_FolderTreeSimpleName, false);</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineminus">-    mAccountArcsOut-&gt;AppendElement(kNC_NameSort, false);</span>
<a href="#l21.17"></a><span id="l21.17" class="difflineminus">-    mAccountArcsOut-&gt;AppendElement(kNC_FolderTreeNameSort, false);</span>
<a href="#l21.18"></a><span id="l21.18" class="difflineminus">-    mAccountArcsOut-&gt;AppendElement(kNC_PageTag, false);</span>
<a href="#l21.19"></a><span id="l21.19" class="difflineplus">+    mAccountArcsOut-&gt;AppendElement(kNC_Settings);</span>
<a href="#l21.20"></a><span id="l21.20" class="difflineplus">+    mAccountArcsOut-&gt;AppendElement(kNC_Name);</span>
<a href="#l21.21"></a><span id="l21.21" class="difflineplus">+    mAccountArcsOut-&gt;AppendElement(kNC_FolderTreeName);</span>
<a href="#l21.22"></a><span id="l21.22" class="difflineplus">+    mAccountArcsOut-&gt;AppendElement(kNC_FolderTreeSimpleName);</span>
<a href="#l21.23"></a><span id="l21.23" class="difflineplus">+    mAccountArcsOut-&gt;AppendElement(kNC_NameSort);</span>
<a href="#l21.24"></a><span id="l21.24" class="difflineplus">+    mAccountArcsOut-&gt;AppendElement(kNC_FolderTreeNameSort);</span>
<a href="#l21.25"></a><span id="l21.25" class="difflineplus">+    mAccountArcsOut-&gt;AppendElement(kNC_PageTag);</span>
<a href="#l21.26"></a><span id="l21.26">   }</span>
<a href="#l21.27"></a><span id="l21.27"> </span>
<a href="#l21.28"></a><span id="l21.28">   NS_IF_ADDREF(*aResult = mAccountArcsOut);</span>
<a href="#l21.29"></a><span id="l21.29">   return NS_OK;</span>
<a href="#l21.30"></a><span id="l21.30"> }</span>
<a href="#l21.31"></a><span id="l21.31"> </span>
<a href="#l21.32"></a><span id="l21.32"> nsresult</span>
<a href="#l21.33"></a><span id="l21.33"> nsMsgAccountManagerDataSource::getAccountRootArcs(nsIMutableArray **aResult)</span>
<a href="#l21.34"></a><span id="l21.34"> {</span>
<a href="#l21.35"></a><span id="l21.35">   nsresult rv;</span>
<a href="#l21.36"></a><span id="l21.36">   if (!mAccountRootArcsOut) {</span>
<a href="#l21.37"></a><span id="l21.37">     mAccountRootArcsOut = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l21.38"></a><span id="l21.38">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l21.39"></a><span id="l21.39"> </span>
<a href="#l21.40"></a><span id="l21.40" class="difflineminus">-    mAccountRootArcsOut-&gt;AppendElement(kNC_Server, false);</span>
<a href="#l21.41"></a><span id="l21.41" class="difflineminus">-    mAccountRootArcsOut-&gt;AppendElement(kNC_Child, false);</span>
<a href="#l21.42"></a><span id="l21.42" class="difflineplus">+    mAccountRootArcsOut-&gt;AppendElement(kNC_Server);</span>
<a href="#l21.43"></a><span id="l21.43" class="difflineplus">+    mAccountRootArcsOut-&gt;AppendElement(kNC_Child);</span>
<a href="#l21.44"></a><span id="l21.44"> </span>
<a href="#l21.45"></a><span id="l21.45" class="difflineminus">-    mAccountRootArcsOut-&gt;AppendElement(kNC_Settings, false);</span>
<a href="#l21.46"></a><span id="l21.46" class="difflineminus">-    mAccountRootArcsOut-&gt;AppendElement(kNC_Name, false);</span>
<a href="#l21.47"></a><span id="l21.47" class="difflineminus">-    mAccountRootArcsOut-&gt;AppendElement(kNC_FolderTreeName, false);</span>
<a href="#l21.48"></a><span id="l21.48" class="difflineminus">-    mAccountRootArcsOut-&gt;AppendElement(kNC_FolderTreeSimpleName, false);</span>
<a href="#l21.49"></a><span id="l21.49" class="difflineminus">-    mAccountRootArcsOut-&gt;AppendElement(kNC_NameSort, false);</span>
<a href="#l21.50"></a><span id="l21.50" class="difflineminus">-    mAccountRootArcsOut-&gt;AppendElement(kNC_FolderTreeNameSort, false);</span>
<a href="#l21.51"></a><span id="l21.51" class="difflineminus">-    mAccountRootArcsOut-&gt;AppendElement(kNC_PageTag, false);</span>
<a href="#l21.52"></a><span id="l21.52" class="difflineplus">+    mAccountRootArcsOut-&gt;AppendElement(kNC_Settings);</span>
<a href="#l21.53"></a><span id="l21.53" class="difflineplus">+    mAccountRootArcsOut-&gt;AppendElement(kNC_Name);</span>
<a href="#l21.54"></a><span id="l21.54" class="difflineplus">+    mAccountRootArcsOut-&gt;AppendElement(kNC_FolderTreeName);</span>
<a href="#l21.55"></a><span id="l21.55" class="difflineplus">+    mAccountRootArcsOut-&gt;AppendElement(kNC_FolderTreeSimpleName);</span>
<a href="#l21.56"></a><span id="l21.56" class="difflineplus">+    mAccountRootArcsOut-&gt;AppendElement(kNC_NameSort);</span>
<a href="#l21.57"></a><span id="l21.57" class="difflineplus">+    mAccountRootArcsOut-&gt;AppendElement(kNC_FolderTreeNameSort);</span>
<a href="#l21.58"></a><span id="l21.58" class="difflineplus">+    mAccountRootArcsOut-&gt;AppendElement(kNC_PageTag);</span>
<a href="#l21.59"></a><span id="l21.59">   }</span>
<a href="#l21.60"></a><span id="l21.60"> </span>
<a href="#l21.61"></a><span id="l21.61">   NS_IF_ADDREF(*aResult = mAccountRootArcsOut);</span>
<a href="#l21.62"></a><span id="l21.62">   return NS_OK;</span>
<a href="#l21.63"></a><span id="l21.63"> }</span>
<a href="#l21.64"></a><span id="l21.64"> </span>
<a href="#l21.65"></a><span id="l21.65"> NS_IMETHODIMP</span>
<a href="#l21.66"></a><span id="l21.66"> nsMsgAccountManagerDataSource::HasArcOut(nsIRDFResource *source, nsIRDFResource *aArc, bool *result)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mailnews/base/src/nsMsgCopyService.cpp</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgCopyService.cpp</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -37,17 +37,17 @@ nsCopySource::nsCopySource(nsIMsgFolder*</span>
<a href="#l22.4"></a><span id="l22.4"> </span>
<a href="#l22.5"></a><span id="l22.5"> nsCopySource::~nsCopySource()</span>
<a href="#l22.6"></a><span id="l22.6"> {</span>
<a href="#l22.7"></a><span id="l22.7">   MOZ_COUNT_DTOR(nsCopySource);</span>
<a href="#l22.8"></a><span id="l22.8"> }</span>
<a href="#l22.9"></a><span id="l22.9"> </span>
<a href="#l22.10"></a><span id="l22.10"> void nsCopySource::AddMessage(nsIMsgDBHdr* aMsg)</span>
<a href="#l22.11"></a><span id="l22.11"> {</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-  m_messageArray-&gt;AppendElement(aMsg, false);</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+  m_messageArray-&gt;AppendElement(aMsg);</span>
<a href="#l22.14"></a><span id="l22.14"> }</span>
<a href="#l22.15"></a><span id="l22.15"> </span>
<a href="#l22.16"></a><span id="l22.16"> // ************ nsCopyRequest *****************</span>
<a href="#l22.17"></a><span id="l22.17"> //</span>
<a href="#l22.18"></a><span id="l22.18"> </span>
<a href="#l22.19"></a><span id="l22.19"> nsCopyRequest::nsCopyRequest() :</span>
<a href="#l22.20"></a><span id="l22.20">     m_requestType(nsCopyMessagesType),</span>
<a href="#l22.21"></a><span id="l22.21">     m_isMoveOrDraftOrTemplate(false),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -3112,17 +3112,17 @@ nsMsgDBView::ListCollapsedChildren(nsMsg</span>
<a href="#l23.4"></a><span id="l23.4">   thread-&gt;GetNumChildren(&amp;numChildren);</span>
<a href="#l23.5"></a><span id="l23.5">   for (uint32_t i = 1; i &lt; numChildren &amp;&amp; NS_SUCCEEDED(rv); i++)</span>
<a href="#l23.6"></a><span id="l23.6">   {</span>
<a href="#l23.7"></a><span id="l23.7">     nsCOMPtr&lt;nsIMsgDBHdr&gt; msgHdr;</span>
<a href="#l23.8"></a><span id="l23.8">     rv = thread-&gt;GetChildHdrAt(i, getter_AddRefs(msgHdr));</span>
<a href="#l23.9"></a><span id="l23.9">     if (!msgHdr)</span>
<a href="#l23.10"></a><span id="l23.10">       continue;</span>
<a href="#l23.11"></a><span id="l23.11"> </span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-    rv = messageArray-&gt;AppendElement(msgHdr, false);</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+    rv = messageArray-&gt;AppendElement(msgHdr);</span>
<a href="#l23.14"></a><span id="l23.14">   }</span>
<a href="#l23.15"></a><span id="l23.15"> </span>
<a href="#l23.16"></a><span id="l23.16">   return rv;</span>
<a href="#l23.17"></a><span id="l23.17"> }</span>
<a href="#l23.18"></a><span id="l23.18"> </span>
<a href="#l23.19"></a><span id="l23.19"> bool</span>
<a href="#l23.20"></a><span id="l23.20"> nsMsgDBView::OperateOnMsgsInCollapsedThreads()</span>
<a href="#l23.21"></a><span id="l23.21"> {</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineat">@@ -3175,17 +3175,17 @@ nsMsgDBView::GetHeadersFromSelection(uin</span>
<a href="#l23.23"></a><span id="l23.23"> </span>
<a href="#l23.24"></a><span id="l23.24">       continue;</span>
<a href="#l23.25"></a><span id="l23.25">     }</span>
<a href="#l23.26"></a><span id="l23.26"> </span>
<a href="#l23.27"></a><span id="l23.27">     nsCOMPtr&lt;nsIMsgDBHdr&gt; msgHdr;</span>
<a href="#l23.28"></a><span id="l23.28">     rv = GetMsgHdrForViewIndex(viewIndex, getter_AddRefs(msgHdr));</span>
<a href="#l23.29"></a><span id="l23.29">     if (NS_SUCCEEDED(rv) &amp;&amp; msgHdr)</span>
<a href="#l23.30"></a><span id="l23.30">     {</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineminus">-      rv = messageArray-&gt;AppendElement(msgHdr, false);</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineplus">+      rv = messageArray-&gt;AppendElement(msgHdr);</span>
<a href="#l23.33"></a><span id="l23.33">       if (NS_SUCCEEDED(rv) &amp;&amp; includeCollapsedMsgs &amp;&amp;</span>
<a href="#l23.34"></a><span id="l23.34">           viewIndexFlags &amp; nsMsgMessageFlags::Elided &amp;&amp;</span>
<a href="#l23.35"></a><span id="l23.35">           viewIndexFlags &amp; MSG_VIEW_FLAG_HASCHILDREN &amp;&amp;</span>
<a href="#l23.36"></a><span id="l23.36">           m_viewFlags &amp; nsMsgViewFlagsType::kThreadedDisplay)</span>
<a href="#l23.37"></a><span id="l23.37">       {</span>
<a href="#l23.38"></a><span id="l23.38">         rv = ListCollapsedChildren(viewIndex, messageArray);</span>
<a href="#l23.39"></a><span id="l23.39">       }</span>
<a href="#l23.40"></a><span id="l23.40">     }</span>
<a href="#l23.41"></a><span id="l23.41" class="difflineat">@@ -3345,23 +3345,23 @@ nsMsgDBView::ApplyCommandToIndices(nsMsg</span>
<a href="#l23.42"></a><span id="l23.42">       msgHdr-&gt;GetMessageKey(&amp;msgKey);</span>
<a href="#l23.43"></a><span id="l23.43">       if (thisIsImapFolder)</span>
<a href="#l23.44"></a><span id="l23.44">         imapUids[i] = msgKey;</span>
<a href="#l23.45"></a><span id="l23.45"> </span>
<a href="#l23.46"></a><span id="l23.46">       switch (command)</span>
<a href="#l23.47"></a><span id="l23.47">       {</span>
<a href="#l23.48"></a><span id="l23.48">         case nsMsgViewCommandType::junk:</span>
<a href="#l23.49"></a><span id="l23.49">           mNumMessagesRemainingInBatch++;</span>
<a href="#l23.50"></a><span id="l23.50" class="difflineminus">-          mJunkHdrs-&gt;AppendElement(msgHdr, false);</span>
<a href="#l23.51"></a><span id="l23.51" class="difflineplus">+          mJunkHdrs-&gt;AppendElement(msgHdr);</span>
<a href="#l23.52"></a><span id="l23.52">           rv = SetMsgHdrJunkStatus(junkPlugin.get(), msgHdr,</span>
<a href="#l23.53"></a><span id="l23.53">                                    nsIJunkMailPlugin::JUNK);</span>
<a href="#l23.54"></a><span id="l23.54">           break;</span>
<a href="#l23.55"></a><span id="l23.55">         case nsMsgViewCommandType::unjunk:</span>
<a href="#l23.56"></a><span id="l23.56">           mNumMessagesRemainingInBatch++;</span>
<a href="#l23.57"></a><span id="l23.57" class="difflineminus">-          mJunkHdrs-&gt;AppendElement(msgHdr, false);</span>
<a href="#l23.58"></a><span id="l23.58" class="difflineplus">+          mJunkHdrs-&gt;AppendElement(msgHdr);</span>
<a href="#l23.59"></a><span id="l23.59">           rv = SetMsgHdrJunkStatus(junkPlugin.get(), msgHdr,</span>
<a href="#l23.60"></a><span id="l23.60">                                    nsIJunkMailPlugin::GOOD);</span>
<a href="#l23.61"></a><span id="l23.61">           break;</span>
<a href="#l23.62"></a><span id="l23.62">         case nsMsgViewCommandType::toggleMessageRead:</span>
<a href="#l23.63"></a><span id="l23.63">         case nsMsgViewCommandType::undeleteMsg:</span>
<a href="#l23.64"></a><span id="l23.64">         case nsMsgViewCommandType::markMessagesRead:</span>
<a href="#l23.65"></a><span id="l23.65">         case nsMsgViewCommandType::markMessagesUnread:</span>
<a href="#l23.66"></a><span id="l23.66">         case nsMsgViewCommandType::unflagMessages:</span>
<a href="#l23.67"></a><span id="l23.67" class="difflineat">@@ -3653,17 +3653,17 @@ nsMsgDBView::DownloadForOffline(nsIMsgWi</span>
<a href="#l23.68"></a><span id="l23.68">     nsCOMPtr &lt;nsIMsgDBHdr&gt; msgHdr;</span>
<a href="#l23.69"></a><span id="l23.69">     rv = m_db-&gt;GetMsgHdrForKey(key, getter_AddRefs(msgHdr));</span>
<a href="#l23.70"></a><span id="l23.70">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l23.71"></a><span id="l23.71">     if (msgHdr)</span>
<a href="#l23.72"></a><span id="l23.72">     {</span>
<a href="#l23.73"></a><span id="l23.73">       uint32_t flags;</span>
<a href="#l23.74"></a><span id="l23.74">       msgHdr-&gt;GetFlags(&amp;flags);</span>
<a href="#l23.75"></a><span id="l23.75">       if (!(flags &amp; nsMsgMessageFlags::Offline))</span>
<a href="#l23.76"></a><span id="l23.76" class="difflineminus">-        messageArray-&gt;AppendElement(msgHdr, false);</span>
<a href="#l23.77"></a><span id="l23.77" class="difflineplus">+        messageArray-&gt;AppendElement(msgHdr);</span>
<a href="#l23.78"></a><span id="l23.78">     }</span>
<a href="#l23.79"></a><span id="l23.79">   }</span>
<a href="#l23.80"></a><span id="l23.80"> </span>
<a href="#l23.81"></a><span id="l23.81">   m_folder-&gt;DownloadMessagesForOffline(messageArray, window);</span>
<a href="#l23.82"></a><span id="l23.82">   return rv;</span>
<a href="#l23.83"></a><span id="l23.83"> }</span>
<a href="#l23.84"></a><span id="l23.84"> </span>
<a href="#l23.85"></a><span id="l23.85"> nsresult</span>
<a href="#l23.86"></a><span id="l23.86" class="difflineat">@@ -3682,17 +3682,17 @@ nsMsgDBView::DownloadFlaggedForOffline(n</span>
<a href="#l23.87"></a><span id="l23.87">       rv = enumerator-&gt;GetNext(getter_AddRefs(supports));</span>
<a href="#l23.88"></a><span id="l23.88">       NS_ASSERTION(NS_SUCCEEDED(rv), &quot;nsMsgDBEnumerator broken&quot;);</span>
<a href="#l23.89"></a><span id="l23.89">       nsCOMPtr &lt;nsIMsgDBHdr&gt; pHeader = do_QueryInterface(supports);</span>
<a href="#l23.90"></a><span id="l23.90">       if (pHeader &amp;&amp; NS_SUCCEEDED(rv))</span>
<a href="#l23.91"></a><span id="l23.91">       {</span>
<a href="#l23.92"></a><span id="l23.92">         uint32_t flags;</span>
<a href="#l23.93"></a><span id="l23.93">         pHeader-&gt;GetFlags(&amp;flags);</span>
<a href="#l23.94"></a><span id="l23.94">         if ((flags &amp; nsMsgMessageFlags::Marked) &amp;&amp; !(flags &amp; nsMsgMessageFlags::Offline))</span>
<a href="#l23.95"></a><span id="l23.95" class="difflineminus">-          messageArray-&gt;AppendElement(pHeader, false);</span>
<a href="#l23.96"></a><span id="l23.96" class="difflineplus">+          messageArray-&gt;AppendElement(pHeader);</span>
<a href="#l23.97"></a><span id="l23.97">       }</span>
<a href="#l23.98"></a><span id="l23.98">     }</span>
<a href="#l23.99"></a><span id="l23.99">   }</span>
<a href="#l23.100"></a><span id="l23.100"> </span>
<a href="#l23.101"></a><span id="l23.101">   m_folder-&gt;DownloadMessagesForOffline(messageArray, window);</span>
<a href="#l23.102"></a><span id="l23.102">   return rv;</span>
<a href="#l23.103"></a><span id="l23.103"> }</span>
<a href="#l23.104"></a><span id="l23.104"> </span>
<a href="#l23.105"></a><span id="l23.105" class="difflineat">@@ -3994,17 +3994,17 @@ nsMsgDBView::PerformActionsOnJunkMsgs(bo</span>
<a href="#l23.106"></a><span id="l23.106">         for (uint32_t i = 0; i &lt; cnt; i++)</span>
<a href="#l23.107"></a><span id="l23.107">         {</span>
<a href="#l23.108"></a><span id="l23.108">           nsCOMPtr&lt;nsIMsgDBHdr&gt; msgHdr = do_QueryElementAt(mJunkHdrs, i);</span>
<a href="#l23.109"></a><span id="l23.109">           if (msgHdr)</span>
<a href="#l23.110"></a><span id="l23.110">           {</span>
<a href="#l23.111"></a><span id="l23.111">             uint32_t flags;</span>
<a href="#l23.112"></a><span id="l23.112">             msgHdr-&gt;GetFlags(&amp;flags);</span>
<a href="#l23.113"></a><span id="l23.113">             if (!(flags &amp; nsMsgMessageFlags::IMAPDeleted))</span>
<a href="#l23.114"></a><span id="l23.114" class="difflineminus">-              hdrsToDelete-&gt;AppendElement(msgHdr, false);</span>
<a href="#l23.115"></a><span id="l23.115" class="difflineplus">+              hdrsToDelete-&gt;AppendElement(msgHdr);</span>
<a href="#l23.116"></a><span id="l23.116">           }</span>
<a href="#l23.117"></a><span id="l23.117">         }</span>
<a href="#l23.118"></a><span id="l23.118"> </span>
<a href="#l23.119"></a><span id="l23.119">         hdrsToDelete-&gt;GetLength(&amp;cnt);</span>
<a href="#l23.120"></a><span id="l23.120">         if (cnt)</span>
<a href="#l23.121"></a><span id="l23.121">           rv = srcFolder-&gt;DeleteMessages(hdrsToDelete, msgWindow, false, false,</span>
<a href="#l23.122"></a><span id="l23.122">                                          nullptr, true);</span>
<a href="#l23.123"></a><span id="l23.123">       }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/mailnews/base/src/nsMsgFolderDataSource.cpp</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgFolderDataSource.cpp</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -561,29 +561,29 @@ nsMsgFolderDataSource::GetAllCmds(nsIRDF</span>
<a href="#l24.4"></a><span id="l24.4"> </span>
<a href="#l24.5"></a><span id="l24.5">   nsCOMPtr&lt;nsIMsgFolder&gt; folder(do_QueryInterface(source, &amp;rv));</span>
<a href="#l24.6"></a><span id="l24.6">   if (NS_FAILED(rv)) return rv;</span>
<a href="#l24.7"></a><span id="l24.7"> </span>
<a href="#l24.8"></a><span id="l24.8">   nsCOMPtr&lt;nsIMutableArray&gt; cmds =</span>
<a href="#l24.9"></a><span id="l24.9">     do_CreateInstance(NS_ARRAY_CONTRACTID);</span>
<a href="#l24.10"></a><span id="l24.10">   NS_ENSURE_STATE(cmds);</span>
<a href="#l24.11"></a><span id="l24.11"> </span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-  cmds-&gt;AppendElement(kNC_Delete, false);</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineminus">-  cmds-&gt;AppendElement(kNC_ReallyDelete, false);</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineminus">-  cmds-&gt;AppendElement(kNC_NewFolder, false);</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineminus">-  cmds-&gt;AppendElement(kNC_GetNewMessages, false);</span>
<a href="#l24.16"></a><span id="l24.16" class="difflineminus">-  cmds-&gt;AppendElement(kNC_Copy, false);</span>
<a href="#l24.17"></a><span id="l24.17" class="difflineminus">-  cmds-&gt;AppendElement(kNC_Move, false);</span>
<a href="#l24.18"></a><span id="l24.18" class="difflineminus">-  cmds-&gt;AppendElement(kNC_CopyFolder, false);</span>
<a href="#l24.19"></a><span id="l24.19" class="difflineminus">-  cmds-&gt;AppendElement(kNC_MoveFolder, false);</span>
<a href="#l24.20"></a><span id="l24.20" class="difflineminus">-  cmds-&gt;AppendElement(kNC_MarkAllMessagesRead, false);</span>
<a href="#l24.21"></a><span id="l24.21" class="difflineminus">-  cmds-&gt;AppendElement(kNC_Compact, false);</span>
<a href="#l24.22"></a><span id="l24.22" class="difflineminus">-  cmds-&gt;AppendElement(kNC_CompactAll, false);</span>
<a href="#l24.23"></a><span id="l24.23" class="difflineminus">-  cmds-&gt;AppendElement(kNC_Rename, false);</span>
<a href="#l24.24"></a><span id="l24.24" class="difflineminus">-  cmds-&gt;AppendElement(kNC_EmptyTrash, false);</span>
<a href="#l24.25"></a><span id="l24.25" class="difflineplus">+  cmds-&gt;AppendElement(kNC_Delete);</span>
<a href="#l24.26"></a><span id="l24.26" class="difflineplus">+  cmds-&gt;AppendElement(kNC_ReallyDelete);</span>
<a href="#l24.27"></a><span id="l24.27" class="difflineplus">+  cmds-&gt;AppendElement(kNC_NewFolder);</span>
<a href="#l24.28"></a><span id="l24.28" class="difflineplus">+  cmds-&gt;AppendElement(kNC_GetNewMessages);</span>
<a href="#l24.29"></a><span id="l24.29" class="difflineplus">+  cmds-&gt;AppendElement(kNC_Copy);</span>
<a href="#l24.30"></a><span id="l24.30" class="difflineplus">+  cmds-&gt;AppendElement(kNC_Move);</span>
<a href="#l24.31"></a><span id="l24.31" class="difflineplus">+  cmds-&gt;AppendElement(kNC_CopyFolder);</span>
<a href="#l24.32"></a><span id="l24.32" class="difflineplus">+  cmds-&gt;AppendElement(kNC_MoveFolder);</span>
<a href="#l24.33"></a><span id="l24.33" class="difflineplus">+  cmds-&gt;AppendElement(kNC_MarkAllMessagesRead);</span>
<a href="#l24.34"></a><span id="l24.34" class="difflineplus">+  cmds-&gt;AppendElement(kNC_Compact);</span>
<a href="#l24.35"></a><span id="l24.35" class="difflineplus">+  cmds-&gt;AppendElement(kNC_CompactAll);</span>
<a href="#l24.36"></a><span id="l24.36" class="difflineplus">+  cmds-&gt;AppendElement(kNC_Rename);</span>
<a href="#l24.37"></a><span id="l24.37" class="difflineplus">+  cmds-&gt;AppendElement(kNC_EmptyTrash);</span>
<a href="#l24.38"></a><span id="l24.38"> </span>
<a href="#l24.39"></a><span id="l24.39">   return cmds-&gt;Enumerate(commands);</span>
<a href="#l24.40"></a><span id="l24.40"> }</span>
<a href="#l24.41"></a><span id="l24.41"> </span>
<a href="#l24.42"></a><span id="l24.42"> NS_IMETHODIMP</span>
<a href="#l24.43"></a><span id="l24.43"> nsMsgFolderDataSource::IsCommandEnabled(nsISupports/*nsISupportsArray&lt;nsIRDFResource&gt;*/* aSources,</span>
<a href="#l24.44"></a><span id="l24.44">                                         nsIRDFResource*   aCommand,</span>
<a href="#l24.45"></a><span id="l24.45">                                         nsISupports/*nsISupportsArray&lt;nsIRDFResource&gt;*/* aArguments,</span>
<a href="#l24.46"></a><span id="l24.46" class="difflineat">@@ -1797,17 +1797,17 @@ nsresult nsMsgFolderDataSource::DoCopyTo</span>
<a href="#l24.47"></a><span id="l24.47">   nsCOMPtr&lt;nsIMutableArray&gt; messageArray(do_CreateInstance(NS_ARRAY_CONTRACTID));</span>
<a href="#l24.48"></a><span id="l24.48"> </span>
<a href="#l24.49"></a><span id="l24.49">   // Remove first element</span>
<a href="#l24.50"></a><span id="l24.50">   for(uint32_t i = 1; i &lt; itemCount; i++)</span>
<a href="#l24.51"></a><span id="l24.51">   {</span>
<a href="#l24.52"></a><span id="l24.52">     nsCOMPtr&lt;nsIMsgDBHdr&gt; message(do_QueryElementAt(arguments, i));</span>
<a href="#l24.53"></a><span id="l24.53">     if (message)</span>
<a href="#l24.54"></a><span id="l24.54">     {</span>
<a href="#l24.55"></a><span id="l24.55" class="difflineminus">-      messageArray-&gt;AppendElement(message, false);</span>
<a href="#l24.56"></a><span id="l24.56" class="difflineplus">+      messageArray-&gt;AppendElement(message);</span>
<a href="#l24.57"></a><span id="l24.57">     }</span>
<a href="#l24.58"></a><span id="l24.58">   }</span>
<a href="#l24.59"></a><span id="l24.59"> </span>
<a href="#l24.60"></a><span id="l24.60">   //Call copyservice with dstFolder, srcFolder, messages, isMove, and txnManager</span>
<a href="#l24.61"></a><span id="l24.61">   nsCOMPtr&lt;nsIMsgCopyService&gt; copyService =</span>
<a href="#l24.62"></a><span id="l24.62">     do_GetService(NS_MSGCOPYSERVICE_CONTRACTID, &amp;rv);</span>
<a href="#l24.63"></a><span id="l24.63">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l24.64"></a><span id="l24.64"> </span>
<a href="#l24.65"></a><span id="l24.65" class="difflineat">@@ -1830,17 +1830,17 @@ nsresult nsMsgFolderDataSource::DoFolder</span>
<a href="#l24.66"></a><span id="l24.66">   if (!isMoveFolder)   // copy folder not on the same server</span>
<a href="#l24.67"></a><span id="l24.67">   {</span>
<a href="#l24.68"></a><span id="l24.68">     // Create an nsIMutableArray from the nsISupportsArray</span>
<a href="#l24.69"></a><span id="l24.69">     nsCOMPtr&lt;nsIMutableArray&gt; folderArray(do_CreateInstance(NS_ARRAY_CONTRACTID));</span>
<a href="#l24.70"></a><span id="l24.70">     for (uint32_t i = 0; i &lt; itemCount; i++)</span>
<a href="#l24.71"></a><span id="l24.71">     {</span>
<a href="#l24.72"></a><span id="l24.72">       nsCOMPtr&lt;nsISupports&gt; element(do_QueryElementAt(arguments, i, &amp;rv));</span>
<a href="#l24.73"></a><span id="l24.73">       if (NS_SUCCEEDED(rv))</span>
<a href="#l24.74"></a><span id="l24.74" class="difflineminus">-        folderArray-&gt;AppendElement(element, false);</span>
<a href="#l24.75"></a><span id="l24.75" class="difflineplus">+        folderArray-&gt;AppendElement(element);</span>
<a href="#l24.76"></a><span id="l24.76">     }</span>
<a href="#l24.77"></a><span id="l24.77"> </span>
<a href="#l24.78"></a><span id="l24.78">     //Call copyservice with dstFolder, srcFolder, folders and isMoveFolder</span>
<a href="#l24.79"></a><span id="l24.79">     nsCOMPtr&lt;nsIMsgCopyService&gt; copyService = do_GetService(NS_MSGCOPYSERVICE_CONTRACTID, &amp;rv);</span>
<a href="#l24.80"></a><span id="l24.80">     if(NS_SUCCEEDED(rv))</span>
<a href="#l24.81"></a><span id="l24.81">     {</span>
<a href="#l24.82"></a><span id="l24.82">       rv = copyService-&gt;CopyFolders(folderArray, dstFolder, isMoveFolder,</span>
<a href="#l24.83"></a><span id="l24.83">         nullptr, msgWindow);</span>
<a href="#l24.84"></a><span id="l24.84" class="difflineat">@@ -1881,21 +1881,21 @@ nsresult nsMsgFolderDataSource::DoDelete</span>
<a href="#l24.85"></a><span id="l24.85">   //for deletion.</span>
<a href="#l24.86"></a><span id="l24.86">   for(uint32_t item = 0; item &lt; itemCount; item++)</span>
<a href="#l24.87"></a><span id="l24.87">   {</span>
<a href="#l24.88"></a><span id="l24.88">     nsCOMPtr&lt;nsISupports&gt; supports(do_QueryElementAt(arguments, item));</span>
<a href="#l24.89"></a><span id="l24.89">     nsCOMPtr&lt;nsIMsgDBHdr&gt; deletedMessage(do_QueryInterface(supports));</span>
<a href="#l24.90"></a><span id="l24.90">     nsCOMPtr&lt;nsIMsgFolder&gt; deletedFolder(do_QueryInterface(supports));</span>
<a href="#l24.91"></a><span id="l24.91">     if (deletedMessage)</span>
<a href="#l24.92"></a><span id="l24.92">     {</span>
<a href="#l24.93"></a><span id="l24.93" class="difflineminus">-      messageArray-&gt;AppendElement(supports, false);</span>
<a href="#l24.94"></a><span id="l24.94" class="difflineplus">+      messageArray-&gt;AppendElement(supports);</span>
<a href="#l24.95"></a><span id="l24.95">     }</span>
<a href="#l24.96"></a><span id="l24.96">     else if(deletedFolder)</span>
<a href="#l24.97"></a><span id="l24.97">     {</span>
<a href="#l24.98"></a><span id="l24.98" class="difflineminus">-      folderArray-&gt;AppendElement(supports, false);</span>
<a href="#l24.99"></a><span id="l24.99" class="difflineplus">+      folderArray-&gt;AppendElement(supports);</span>
<a href="#l24.100"></a><span id="l24.100">     }</span>
<a href="#l24.101"></a><span id="l24.101">   }</span>
<a href="#l24.102"></a><span id="l24.102">   uint32_t cnt;</span>
<a href="#l24.103"></a><span id="l24.103">   rv = messageArray-&gt;GetLength(&amp;cnt);</span>
<a href="#l24.104"></a><span id="l24.104">   if (NS_FAILED(rv)) return rv;</span>
<a href="#l24.105"></a><span id="l24.105">   if (cnt &gt; 0)</span>
<a href="#l24.106"></a><span id="l24.106">     rv = folder-&gt;DeleteMessages(messageArray, msgWindow, reallyDelete, false, nullptr, true /*allowUndo*/);</span>
<a href="#l24.107"></a><span id="l24.107"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/mailnews/base/src/nsMsgProgress.cpp</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgProgress.cpp</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -62,18 +62,18 @@ NS_IMETHODIMP nsMsgProgress::OpenProgres</span>
<a href="#l25.4"></a><span id="l25.4"> </span>
<a href="#l25.5"></a><span id="l25.5">   nsCOMPtr&lt;nsISupportsInterfacePointer&gt; ifptr =</span>
<a href="#l25.6"></a><span id="l25.6">     do_CreateInstance(NS_SUPPORTS_INTERFACE_POINTER_CONTRACTID, &amp;rv);</span>
<a href="#l25.7"></a><span id="l25.7">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l25.8"></a><span id="l25.8"> </span>
<a href="#l25.9"></a><span id="l25.9">   ifptr-&gt;SetData(static_cast&lt;nsIMsgProgress*&gt;(this));</span>
<a href="#l25.10"></a><span id="l25.10">   ifptr-&gt;SetDataIID(&amp;NS_GET_IID(nsIMsgProgress));</span>
<a href="#l25.11"></a><span id="l25.11"> </span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-  array-&gt;AppendElement(ifptr, false);</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineminus">-  array-&gt;AppendElement(parameters, false);</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineplus">+  array-&gt;AppendElement(ifptr);</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineplus">+  array-&gt;AppendElement(parameters);</span>
<a href="#l25.16"></a><span id="l25.16"> </span>
<a href="#l25.17"></a><span id="l25.17">   // Open the dialog.</span>
<a href="#l25.18"></a><span id="l25.18">   nsCOMPtr&lt;nsPIDOMWindowOuter&gt; newWindow;</span>
<a href="#l25.19"></a><span id="l25.19"> </span>
<a href="#l25.20"></a><span id="l25.20">   nsString chromeOptions(NS_LITERAL_STRING(&quot;chrome,dependent,centerscreen&quot;));</span>
<a href="#l25.21"></a><span id="l25.21">   if (inDisplayModal)</span>
<a href="#l25.22"></a><span id="l25.22">     chromeOptions.AppendLiteral(&quot;,modal&quot;);</span>
<a href="#l25.23"></a><span id="l25.23"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mailnews/base/src/nsMsgPurgeService.cpp</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgPurgeService.cpp</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -448,17 +448,17 @@ NS_IMETHODIMP nsMsgPurgeService::OnSearc</span>
<a href="#l26.4"></a><span id="l26.4">   MOZ_LOG(MsgPurgeLogModule, mozilla::LogLevel::Info, (&quot;junkScore=%s (if empty or != nsIJunkMailPlugin::IS_SPAM_SCORE, don't add to list delete)&quot;, junkScoreStr.get()));</span>
<a href="#l26.5"></a><span id="l26.5"> </span>
<a href="#l26.6"></a><span id="l26.6">   // if &quot;junkscore&quot; is not set, don't delete the message</span>
<a href="#l26.7"></a><span id="l26.7">   if (junkScoreStr.IsEmpty())</span>
<a href="#l26.8"></a><span id="l26.8">     return NS_OK;</span>
<a href="#l26.9"></a><span id="l26.9"> </span>
<a href="#l26.10"></a><span id="l26.10">   if (atoi(junkScoreStr.get()) == nsIJunkMailPlugin::IS_SPAM_SCORE) {</span>
<a href="#l26.11"></a><span id="l26.11">     MOZ_LOG(MsgPurgeLogModule, mozilla::LogLevel::Info, (&quot;added message to delete&quot;));</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-    return mHdrsToDelete-&gt;AppendElement(aMsgHdr, false);</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+    return mHdrsToDelete-&gt;AppendElement(aMsgHdr);</span>
<a href="#l26.14"></a><span id="l26.14">   }</span>
<a href="#l26.15"></a><span id="l26.15">   return NS_OK;</span>
<a href="#l26.16"></a><span id="l26.16"> }</span>
<a href="#l26.17"></a><span id="l26.17"> </span>
<a href="#l26.18"></a><span id="l26.18"> NS_IMETHODIMP nsMsgPurgeService::OnSearchDone(nsresult status)</span>
<a href="#l26.19"></a><span id="l26.19"> {</span>
<a href="#l26.20"></a><span id="l26.20">   if (NS_SUCCEEDED(status))</span>
<a href="#l26.21"></a><span id="l26.21">   {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mailnews/base/src/nsMsgQuickSearchDBView.cpp</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgQuickSearchDBView.cpp</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -594,17 +594,17 @@ nsMsgQuickSearchDBView::ListCollapsedChi</span>
<a href="#l27.4"></a><span id="l27.4">     if (msgHdr)</span>
<a href="#l27.5"></a><span id="l27.5">     {</span>
<a href="#l27.6"></a><span id="l27.6">       nsMsgKey msgKey;</span>
<a href="#l27.7"></a><span id="l27.7">       msgHdr-&gt;GetMessageKey(&amp;msgKey);</span>
<a href="#l27.8"></a><span id="l27.8">       if (msgKey != rootKey || (GroupViewUsesDummyRow() &amp;&amp; rootKeySkipped))</span>
<a href="#l27.9"></a><span id="l27.9">       {</span>
<a href="#l27.10"></a><span id="l27.10">         // if this hdr is in the original view, add it to new view.</span>
<a href="#l27.11"></a><span id="l27.11">         if (m_origKeys.BinaryIndexOf(msgKey) != m_origKeys.NoIndex)</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-          messageArray-&gt;AppendElement(msgHdr, false);</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+          messageArray-&gt;AppendElement(msgHdr);</span>
<a href="#l27.14"></a><span id="l27.14">       }</span>
<a href="#l27.15"></a><span id="l27.15">       else</span>
<a href="#l27.16"></a><span id="l27.16">       {</span>
<a href="#l27.17"></a><span id="l27.17">         rootKeySkipped = true;</span>
<a href="#l27.18"></a><span id="l27.18">       }</span>
<a href="#l27.19"></a><span id="l27.19">     }</span>
<a href="#l27.20"></a><span id="l27.20">   }</span>
<a href="#l27.21"></a><span id="l27.21">   return NS_OK;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/mailnews/base/src/nsMsgSearchDBView.cpp</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgSearchDBView.cpp</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -1054,17 +1054,17 @@ nsMsgSearchDBView::GetFoldersAndHdrsForS</span>
<a href="#l28.4"></a><span id="l28.4">       nsCOMPtr&lt;nsIMsgDBHdr&gt; hdr = do_QueryElementAt(messages, i, &amp;rv);</span>
<a href="#l28.5"></a><span id="l28.5">       if (hdr)</span>
<a href="#l28.6"></a><span id="l28.6">       {</span>
<a href="#l28.7"></a><span id="l28.7">         nsCOMPtr&lt;nsIMsgFolder&gt; msgFolder;</span>
<a href="#l28.8"></a><span id="l28.8">         hdr-&gt;GetFolder(getter_AddRefs(msgFolder));</span>
<a href="#l28.9"></a><span id="l28.9">         if (NS_SUCCEEDED(rv) &amp;&amp; msgFolder &amp;&amp; msgFolder == curFolder)</span>
<a href="#l28.10"></a><span id="l28.10">         {</span>
<a href="#l28.11"></a><span id="l28.11">           nsCOMPtr&lt;nsISupports&gt; hdrSupports = do_QueryInterface(hdr);</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-          msgHdrsForOneFolder-&gt;AppendElement(hdrSupports, false);</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+          msgHdrsForOneFolder-&gt;AppendElement(hdrSupports);</span>
<a href="#l28.14"></a><span id="l28.14">         }</span>
<a href="#l28.15"></a><span id="l28.15">       }</span>
<a href="#l28.16"></a><span id="l28.16">     }</span>
<a href="#l28.17"></a><span id="l28.17"> </span>
<a href="#l28.18"></a><span id="l28.18">     m_hdrsForEachFolder.AppendElement(msgHdrsForOneFolder);</span>
<a href="#l28.19"></a><span id="l28.19">   }</span>
<a href="#l28.20"></a><span id="l28.20"> </span>
<a href="#l28.21"></a><span id="l28.21">   return rv;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/mailnews/base/util/nsImapMoveCoalescer.cpp</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/mailnews/base/util/nsImapMoveCoalescer.cpp</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -82,17 +82,17 @@ nsresult nsImapMoveCoalescer::PlaybackMo</span>
<a href="#l29.4"></a><span id="l29.4"> </span>
<a href="#l29.5"></a><span id="l29.5">     nsCOMPtr&lt;nsIMutableArray&gt; messages(do_CreateInstance(NS_ARRAY_CONTRACTID));</span>
<a href="#l29.6"></a><span id="l29.6">     for (uint32_t keyIndex = 0; keyIndex &lt; keysToAdd.Length(); keyIndex++)</span>
<a href="#l29.7"></a><span id="l29.7">     {</span>
<a href="#l29.8"></a><span id="l29.8">       nsCOMPtr&lt;nsIMsgDBHdr&gt; mailHdr = nullptr;</span>
<a href="#l29.9"></a><span id="l29.9">       rv = m_sourceFolder-&gt;GetMessageHeader(keysToAdd.ElementAt(keyIndex), getter_AddRefs(mailHdr));</span>
<a href="#l29.10"></a><span id="l29.10">       if (NS_SUCCEEDED(rv) &amp;&amp; mailHdr)</span>
<a href="#l29.11"></a><span id="l29.11">       {</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-        messages-&gt;AppendElement(mailHdr, false);</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineplus">+        messages-&gt;AppendElement(mailHdr);</span>
<a href="#l29.14"></a><span id="l29.14">         bool isRead = false;</span>
<a href="#l29.15"></a><span id="l29.15">         mailHdr-&gt;GetIsRead(&amp;isRead);</span>
<a href="#l29.16"></a><span id="l29.16">         if (!isRead)</span>
<a href="#l29.17"></a><span id="l29.17">           numNewMessages++;</span>
<a href="#l29.18"></a><span id="l29.18">       }</span>
<a href="#l29.19"></a><span id="l29.19">     }</span>
<a href="#l29.20"></a><span id="l29.20">     uint32_t destFlags;</span>
<a href="#l29.21"></a><span id="l29.21">     destFolder-&gt;GetFlags(&amp;destFlags);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/mailnews/base/util/nsMsgDBFolder.cpp</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgDBFolder.cpp</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -1886,31 +1886,31 @@ nsresult nsMsgDBFolder::HandleAutoCompac</span>
<a href="#l30.4"></a><span id="l30.4">             {</span>
<a href="#l30.5"></a><span id="l30.5">               nsCOMPtr&lt;nsIMsgFolder&gt; folder = do_QueryElementAt(allDescendents, i);</span>
<a href="#l30.6"></a><span id="l30.6">               expungedBytes = 0;</span>
<a href="#l30.7"></a><span id="l30.7">               folder-&gt;GetFlags(&amp;flags);</span>
<a href="#l30.8"></a><span id="l30.8">               if (flags &amp; nsMsgFolderFlags::Offline)</span>
<a href="#l30.9"></a><span id="l30.9">                 folder-&gt;GetExpungedBytes(&amp;expungedBytes);</span>
<a href="#l30.10"></a><span id="l30.10">               if (expungedBytes &gt; 0 )</span>
<a href="#l30.11"></a><span id="l30.11">               {</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-                offlineFolderArray-&gt;AppendElement(folder, false);</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineplus">+                offlineFolderArray-&gt;AppendElement(folder);</span>
<a href="#l30.14"></a><span id="l30.14">                 offlineExpungedBytes += expungedBytes;</span>
<a href="#l30.15"></a><span id="l30.15">               }</span>
<a href="#l30.16"></a><span id="l30.16">             }</span>
<a href="#l30.17"></a><span id="l30.17">           }</span>
<a href="#l30.18"></a><span id="l30.18">           else  //pop or local</span>
<a href="#l30.19"></a><span id="l30.19">           {</span>
<a href="#l30.20"></a><span id="l30.20">             for (uint32_t i = 0; i &lt; cnt; i++)</span>
<a href="#l30.21"></a><span id="l30.21">             {</span>
<a href="#l30.22"></a><span id="l30.22">               nsCOMPtr&lt;nsIMsgFolder&gt; folder = do_QueryElementAt(allDescendents, i);</span>
<a href="#l30.23"></a><span id="l30.23">               expungedBytes = 0;</span>
<a href="#l30.24"></a><span id="l30.24">               folder-&gt;GetExpungedBytes(&amp;expungedBytes);</span>
<a href="#l30.25"></a><span id="l30.25">               if (expungedBytes &gt; 0 )</span>
<a href="#l30.26"></a><span id="l30.26">               {</span>
<a href="#l30.27"></a><span id="l30.27" class="difflineminus">-                folderArray-&gt;AppendElement(folder, false);</span>
<a href="#l30.28"></a><span id="l30.28" class="difflineplus">+                folderArray-&gt;AppendElement(folder);</span>
<a href="#l30.29"></a><span id="l30.29">                 localExpungedBytes += expungedBytes;</span>
<a href="#l30.30"></a><span id="l30.30">               }</span>
<a href="#l30.31"></a><span id="l30.31">             }</span>
<a href="#l30.32"></a><span id="l30.32">           }</span>
<a href="#l30.33"></a><span id="l30.33">         }</span>
<a href="#l30.34"></a><span id="l30.34">       }</span>
<a href="#l30.35"></a><span id="l30.35">       while (++serverIndex &lt; numServers);</span>
<a href="#l30.36"></a><span id="l30.36">       totalExpungedBytes = localExpungedBytes + offlineExpungedBytes;</span>
<a href="#l30.37"></a><span id="l30.37" class="difflineat">@@ -2372,17 +2372,17 @@ nsMsgDBFolder::OnMessageClassified(const</span>
<a href="#l30.38"></a><span id="l30.38">       // a filter moved it.</span>
<a href="#l30.39"></a><span id="l30.39">       rv = mDatabase-&gt;ContainsKey(msgKey, &amp;hasKey);</span>
<a href="#l30.40"></a><span id="l30.40">       if (!NS_SUCCEEDED(rv) || !hasKey)</span>
<a href="#l30.41"></a><span id="l30.41">         continue;</span>
<a href="#l30.42"></a><span id="l30.42">       nsCOMPtr &lt;nsIMsgDBHdr&gt; msgHdr;</span>
<a href="#l30.43"></a><span id="l30.43">       rv = mDatabase-&gt;GetMsgHdrForKey(msgKey, getter_AddRefs(msgHdr));</span>
<a href="#l30.44"></a><span id="l30.44">       if (!NS_SUCCEEDED(rv))</span>
<a href="#l30.45"></a><span id="l30.45">         continue;</span>
<a href="#l30.46"></a><span id="l30.46" class="difflineminus">-      classifiedMsgHdrs-&gt;AppendElement(msgHdr, false);</span>
<a href="#l30.47"></a><span id="l30.47" class="difflineplus">+      classifiedMsgHdrs-&gt;AppendElement(msgHdr);</span>
<a href="#l30.48"></a><span id="l30.48">     }</span>
<a href="#l30.49"></a><span id="l30.49"> </span>
<a href="#l30.50"></a><span id="l30.50">     // only generate the notification if there are some classified messages</span>
<a href="#l30.51"></a><span id="l30.51">     if (NS_SUCCEEDED(classifiedMsgHdrs-&gt;GetLength(&amp;length)) &amp;&amp; length)</span>
<a href="#l30.52"></a><span id="l30.52">       notifier-&gt;NotifyMsgsClassified(classifiedMsgHdrs,</span>
<a href="#l30.53"></a><span id="l30.53">                                      mBayesJunkClassifying,</span>
<a href="#l30.54"></a><span id="l30.54">                                      mBayesTraitClassifying);</span>
<a href="#l30.55"></a><span id="l30.55">     mClassifiedMsgKeys.Clear();</span>
<a href="#l30.56"></a><span id="l30.56" class="difflineat">@@ -2747,17 +2747,17 @@ nsMsgDBFolder::CallFilterPlugins(nsIMsgW</span>
<a href="#l30.57"></a><span id="l30.57">       {</span>
<a href="#l30.58"></a><span id="l30.58">         // Don't do filters on this message again.</span>
<a href="#l30.59"></a><span id="l30.59">         // (Only set this if we are actually filtering since this is</span>
<a href="#l30.60"></a><span id="l30.60">         // tantamount to a memory leak.)</span>
<a href="#l30.61"></a><span id="l30.61">         OrProcessingFlags(msgKey, nsMsgProcessingFlags::FiltersDone);</span>
<a href="#l30.62"></a><span id="l30.62">         // Lazily create the array.</span>
<a href="#l30.63"></a><span id="l30.63">         if (!mPostBayesMessagesToFilter)</span>
<a href="#l30.64"></a><span id="l30.64">           mPostBayesMessagesToFilter = do_CreateInstance(NS_ARRAY_CONTRACTID);</span>
<a href="#l30.65"></a><span id="l30.65" class="difflineminus">-        mPostBayesMessagesToFilter-&gt;AppendElement(msgHdr, false);</span>
<a href="#l30.66"></a><span id="l30.66" class="difflineplus">+        mPostBayesMessagesToFilter-&gt;AppendElement(msgHdr);</span>
<a href="#l30.67"></a><span id="l30.67">       }</span>
<a href="#l30.68"></a><span id="l30.68">     }</span>
<a href="#l30.69"></a><span id="l30.69">   }</span>
<a href="#l30.70"></a><span id="l30.70"> </span>
<a href="#l30.71"></a><span id="l30.71">   NotifyHdrsNotBeingClassified();</span>
<a href="#l30.72"></a><span id="l30.72">   // If there weren't any new messages, just return.</span>
<a href="#l30.73"></a><span id="l30.73">   if (newMessageKeys.IsEmpty())</span>
<a href="#l30.74"></a><span id="l30.74">     return NS_OK;</span>
<a href="#l30.75"></a><span id="l30.75" class="difflineat">@@ -4447,17 +4447,17 @@ NS_IMETHODIMP nsMsgDBFolder::GetFoldersW</span>
<a href="#l30.76"></a><span id="l30.76">   array.forget(aResult);</span>
<a href="#l30.77"></a><span id="l30.77">   return NS_OK;</span>
<a href="#l30.78"></a><span id="l30.78"> }</span>
<a href="#l30.79"></a><span id="l30.79"> </span>
<a href="#l30.80"></a><span id="l30.80"> NS_IMETHODIMP nsMsgDBFolder::ListFoldersWithFlags(uint32_t aFlags, nsIMutableArray* aFolders)</span>
<a href="#l30.81"></a><span id="l30.81"> {</span>
<a href="#l30.82"></a><span id="l30.82">   NS_ENSURE_ARG_POINTER(aFolders);</span>
<a href="#l30.83"></a><span id="l30.83">   if ((mFlags &amp; aFlags) == aFlags)</span>
<a href="#l30.84"></a><span id="l30.84" class="difflineminus">-    aFolders-&gt;AppendElement(static_cast&lt;nsRDFResource*&gt;(this), false);</span>
<a href="#l30.85"></a><span id="l30.85" class="difflineplus">+    aFolders-&gt;AppendElement(static_cast&lt;nsRDFResource*&gt;(this));</span>
<a href="#l30.86"></a><span id="l30.86"> </span>
<a href="#l30.87"></a><span id="l30.87">   nsCOMPtr&lt;nsISimpleEnumerator&gt; dummy;</span>
<a href="#l30.88"></a><span id="l30.88">   GetSubFolders(getter_AddRefs(dummy)); // initialize mSubFolders</span>
<a href="#l30.89"></a><span id="l30.89"> </span>
<a href="#l30.90"></a><span id="l30.90">   int32_t count = mSubFolders.Count();</span>
<a href="#l30.91"></a><span id="l30.91">   for (int32_t i = 0; i &lt; count; ++i)</span>
<a href="#l30.92"></a><span id="l30.92">     mSubFolders[i]-&gt;ListFoldersWithFlags(aFlags, aFolders);</span>
<a href="#l30.93"></a><span id="l30.93"> </span>
<a href="#l30.94"></a><span id="l30.94" class="difflineat">@@ -5139,17 +5139,17 @@ NS_IMETHODIMP nsMsgDBFolder::ListDescend</span>
<a href="#l30.95"></a><span id="l30.95">   NS_ENSURE_ARG_POINTER(aDescendants);</span>
<a href="#l30.96"></a><span id="l30.96"> </span>
<a href="#l30.97"></a><span id="l30.97">   nsCOMPtr&lt;nsISimpleEnumerator&gt; dummy;</span>
<a href="#l30.98"></a><span id="l30.98">   GetSubFolders(getter_AddRefs(dummy)); // initialize mSubFolders</span>
<a href="#l30.99"></a><span id="l30.99">   uint32_t count = mSubFolders.Count();</span>
<a href="#l30.100"></a><span id="l30.100">   for (uint32_t i = 0; i &lt; count; i++)</span>
<a href="#l30.101"></a><span id="l30.101">   {</span>
<a href="#l30.102"></a><span id="l30.102">     nsCOMPtr&lt;nsIMsgFolder&gt; child(mSubFolders[i]);</span>
<a href="#l30.103"></a><span id="l30.103" class="difflineminus">-    aDescendants-&gt;AppendElement(child, false);</span>
<a href="#l30.104"></a><span id="l30.104" class="difflineplus">+    aDescendants-&gt;AppendElement(child);</span>
<a href="#l30.105"></a><span id="l30.105">     child-&gt;ListDescendants(aDescendants);  // recurse</span>
<a href="#l30.106"></a><span id="l30.106">   }</span>
<a href="#l30.107"></a><span id="l30.107">   return NS_OK;</span>
<a href="#l30.108"></a><span id="l30.108"> }</span>
<a href="#l30.109"></a><span id="l30.109"> </span>
<a href="#l30.110"></a><span id="l30.110"> NS_IMETHODIMP nsMsgDBFolder::GetBaseMessageURI(nsACString&amp; baseMessageURI)</span>
<a href="#l30.111"></a><span id="l30.111"> {</span>
<a href="#l30.112"></a><span id="l30.112">   if (mBaseMessageURI.IsEmpty())</span>
<a href="#l30.113"></a><span id="l30.113" class="difflineat">@@ -5970,17 +5970,17 @@ nsresult nsMsgDBFolder::MessagesInKeyOrd</span>
<a href="#l30.114"></a><span id="l30.114">   rv = srcFolder-&gt;GetDBFolderInfoAndDB(getter_AddRefs(folderInfo), getter_AddRefs(db));</span>
<a href="#l30.115"></a><span id="l30.115">   if (NS_SUCCEEDED(rv) &amp;&amp; db)</span>
<a href="#l30.116"></a><span id="l30.116">   {</span>
<a href="#l30.117"></a><span id="l30.117">     for (uint32_t i = 0; i &lt; numMessages; i++)</span>
<a href="#l30.118"></a><span id="l30.118">     {</span>
<a href="#l30.119"></a><span id="l30.119">       rv = db-&gt;GetMsgHdrForKey(aKeyArray[i], getter_AddRefs(msgHdr));</span>
<a href="#l30.120"></a><span id="l30.120">       NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l30.121"></a><span id="l30.121">       if (msgHdr)</span>
<a href="#l30.122"></a><span id="l30.122" class="difflineminus">-        messages-&gt;AppendElement(msgHdr, false);</span>
<a href="#l30.123"></a><span id="l30.123" class="difflineplus">+        messages-&gt;AppendElement(msgHdr);</span>
<a href="#l30.124"></a><span id="l30.124">     }</span>
<a href="#l30.125"></a><span id="l30.125">   }</span>
<a href="#l30.126"></a><span id="l30.126">   return rv;</span>
<a href="#l30.127"></a><span id="l30.127"> }</span>
<a href="#l30.128"></a><span id="l30.128"> </span>
<a href="#l30.129"></a><span id="l30.129"> /* static */ nsMsgKeySetU* nsMsgKeySetU::Create()</span>
<a href="#l30.130"></a><span id="l30.130"> {</span>
<a href="#l30.131"></a><span id="l30.131">   nsMsgKeySetU* set = new nsMsgKeySetU;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/mailnews/base/util/nsMsgIncomingServer.cpp</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgIncomingServer.cpp</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -1913,17 +1913,17 @@ nsMsgIncomingServer::ConfigureTemporaryS</span>
<a href="#l31.4"></a><span id="l31.4"> </span>
<a href="#l31.5"></a><span id="l31.5">     nsCOMPtr&lt;nsIMsgSearchValue&gt; searchValue;</span>
<a href="#l31.6"></a><span id="l31.6">     searchTerm-&gt;GetValue(getter_AddRefs(searchValue));</span>
<a href="#l31.7"></a><span id="l31.7">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l31.8"></a><span id="l31.8">     searchValue-&gt;SetAttrib(nsMsgSearchAttrib::JunkScoreOrigin);</span>
<a href="#l31.9"></a><span id="l31.9">     searchValue-&gt;SetStr(NS_LITERAL_STRING(&quot;user&quot;));</span>
<a href="#l31.10"></a><span id="l31.10">     searchTerm-&gt;SetValue(searchValue);</span>
<a href="#l31.11"></a><span id="l31.11"> </span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-    searchTerms-&gt;InsertElementAt(searchTerm, count, /* weak = */ false);</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+    searchTerms-&gt;InsertElementAt(searchTerm, count);</span>
<a href="#l31.14"></a><span id="l31.14"> </span>
<a href="#l31.15"></a><span id="l31.15">     bool moveOnSpam, markAsReadOnSpam;</span>
<a href="#l31.16"></a><span id="l31.16">     spamSettings-&gt;GetMoveOnSpam(&amp;moveOnSpam);</span>
<a href="#l31.17"></a><span id="l31.17">     if (moveOnSpam)</span>
<a href="#l31.18"></a><span id="l31.18">     {</span>
<a href="#l31.19"></a><span id="l31.19">       nsCString spamFolderURI;</span>
<a href="#l31.20"></a><span id="l31.20">       rv = spamSettings-&gt;GetSpamFolderURI(getter_Copies(spamFolderURI));</span>
<a href="#l31.21"></a><span id="l31.21">       if (NS_SUCCEEDED(rv) &amp;&amp; (!spamFolderURI.IsEmpty()))</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/mailnews/base/util/nsMsgReadStateTxn.cpp</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgReadStateTxn.cpp</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -52,15 +52,15 @@ nsMsgReadStateTxn::MarkMessages(bool aAs</span>
<a href="#l32.4"></a><span id="l32.4">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l32.5"></a><span id="l32.5"> </span>
<a href="#l32.6"></a><span id="l32.6">   uint32_t length = mMarkedMessages.Length();</span>
<a href="#l32.7"></a><span id="l32.7">   for (uint32_t i = 0; i &lt; length; i++) {</span>
<a href="#l32.8"></a><span id="l32.8">     nsCOMPtr&lt;nsIMsgDBHdr&gt; curMsgHdr;</span>
<a href="#l32.9"></a><span id="l32.9">     rv = mParentFolder-&gt;GetMessageHeader(mMarkedMessages[i],</span>
<a href="#l32.10"></a><span id="l32.10">                                          getter_AddRefs(curMsgHdr));</span>
<a href="#l32.11"></a><span id="l32.11">     if (NS_SUCCEEDED(rv) &amp;&amp; curMsgHdr) {</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-      messageArray-&gt;AppendElement(curMsgHdr, false);</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+      messageArray-&gt;AppendElement(curMsgHdr);</span>
<a href="#l32.14"></a><span id="l32.14">     }</span>
<a href="#l32.15"></a><span id="l32.15">   }</span>
<a href="#l32.16"></a><span id="l32.16"> </span>
<a href="#l32.17"></a><span id="l32.17">   return mParentFolder-&gt;MarkMessagesRead(messageArray, aAsRead);</span>
<a href="#l32.18"></a><span id="l32.18"> }</span>
<a href="#l32.19"></a><span id="l32.19"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/mailnews/base/util/nsMsgUtils.cpp</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgUtils.cpp</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -1646,17 +1646,17 @@ NS_MSG_BASE nsresult MsgGetHeadersFromKe</span>
<a href="#l33.4"></a><span id="l33.4"> </span>
<a href="#l33.5"></a><span id="l33.5">     // This function silently skips when the key is not found. This is an expected case.</span>
<a href="#l33.6"></a><span id="l33.6">     if (hasKey)</span>
<a href="#l33.7"></a><span id="l33.7">     {</span>
<a href="#l33.8"></a><span id="l33.8">       nsCOMPtr&lt;nsIMsgDBHdr&gt; msgHdr;</span>
<a href="#l33.9"></a><span id="l33.9">       rv = aDB-&gt;GetMsgHdrForKey(key, getter_AddRefs(msgHdr));</span>
<a href="#l33.10"></a><span id="l33.10">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l33.11"></a><span id="l33.11"> </span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-      aHeaders-&gt;AppendElement(msgHdr, false);</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineplus">+      aHeaders-&gt;AppendElement(msgHdr);</span>
<a href="#l33.14"></a><span id="l33.14">     }</span>
<a href="#l33.15"></a><span id="l33.15">   }</span>
<a href="#l33.16"></a><span id="l33.16"> </span>
<a href="#l33.17"></a><span id="l33.17">   return rv;</span>
<a href="#l33.18"></a><span id="l33.18"> }</span>
<a href="#l33.19"></a><span id="l33.19"> </span>
<a href="#l33.20"></a><span id="l33.20"> NS_MSG_BASE nsresult MsgGetHdrsFromKeys(nsIMsgDatabase *aDB, nsMsgKey *aMsgKeys,</span>
<a href="#l33.21"></a><span id="l33.21">                                         uint32_t aNumKeys, nsIMutableArray **aHeaders)</span>
<a href="#l33.22"></a><span id="l33.22" class="difflineat">@@ -1674,17 +1674,17 @@ NS_MSG_BASE nsresult MsgGetHdrsFromKeys(</span>
<a href="#l33.23"></a><span id="l33.23">     bool hasKey;</span>
<a href="#l33.24"></a><span id="l33.24">     rv = aDB-&gt;ContainsKey(key, &amp;hasKey);</span>
<a href="#l33.25"></a><span id="l33.25">     // This function silently skips when the key is not found. This is an expected case.</span>
<a href="#l33.26"></a><span id="l33.26">     if (NS_SUCCEEDED(rv) &amp;&amp; hasKey)</span>
<a href="#l33.27"></a><span id="l33.27">     {</span>
<a href="#l33.28"></a><span id="l33.28">       nsCOMPtr&lt;nsIMsgDBHdr&gt; msgHdr;</span>
<a href="#l33.29"></a><span id="l33.29">       rv = aDB-&gt;GetMsgHdrForKey(key, getter_AddRefs(msgHdr));</span>
<a href="#l33.30"></a><span id="l33.30">       if (NS_SUCCEEDED(rv))</span>
<a href="#l33.31"></a><span id="l33.31" class="difflineminus">-        messages-&gt;AppendElement(msgHdr, false);</span>
<a href="#l33.32"></a><span id="l33.32" class="difflineplus">+        messages-&gt;AppendElement(msgHdr);</span>
<a href="#l33.33"></a><span id="l33.33">     }</span>
<a href="#l33.34"></a><span id="l33.34">   }</span>
<a href="#l33.35"></a><span id="l33.35"> </span>
<a href="#l33.36"></a><span id="l33.36">   messages.forget(aHeaders);</span>
<a href="#l33.37"></a><span id="l33.37">   return NS_OK;</span>
<a href="#l33.38"></a><span id="l33.38"> }</span>
<a href="#l33.39"></a><span id="l33.39"> </span>
<a href="#l33.40"></a><span id="l33.40"> bool MsgAdvanceToNextLine(const char *buffer, uint32_t &amp;bufferOffset, uint32_t maxBufferOffset)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgCompose.cpp</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgCompose.cpp</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -3903,17 +3903,17 @@ nsMsgComposeSendListener::RemoveCurrentD</span>
<a href="#l34.4"></a><span id="l34.4">         if (!containsKey)</span>
<a href="#l34.5"></a><span id="l34.5">           break;</span>
<a href="#l34.6"></a><span id="l34.6"> </span>
<a href="#l34.7"></a><span id="l34.7">         // Build the msg array.</span>
<a href="#l34.8"></a><span id="l34.8">         nsCOMPtr&lt;nsIMutableArray&gt; messageArray(do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l34.9"></a><span id="l34.9">         NS_ASSERTION(NS_SUCCEEDED(rv), &quot;RemoveCurrentDraftMessage can't allocate array.&quot;);</span>
<a href="#l34.10"></a><span id="l34.10">         if (NS_FAILED(rv) || !messageArray)</span>
<a href="#l34.11"></a><span id="l34.11">           break;</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-        rv = messageArray-&gt;AppendElement(msgDBHdr, false);</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+        rv = messageArray-&gt;AppendElement(msgDBHdr);</span>
<a href="#l34.14"></a><span id="l34.14">         NS_ASSERTION(NS_SUCCEEDED(rv), &quot;RemoveCurrentDraftMessage can't append msg header to array.&quot;);</span>
<a href="#l34.15"></a><span id="l34.15">         if (NS_FAILED(rv))</span>
<a href="#l34.16"></a><span id="l34.16">           break;</span>
<a href="#l34.17"></a><span id="l34.17"> </span>
<a href="#l34.18"></a><span id="l34.18">         // Ready to delete the msg.</span>
<a href="#l34.19"></a><span id="l34.19">         rv = msgFolder-&gt;DeleteMessages(messageArray, nullptr, true, false, nullptr, false /*allowUndo*/);</span>
<a href="#l34.20"></a><span id="l34.20">         NS_ASSERTION(NS_SUCCEEDED(rv), &quot;RemoveCurrentDraftMessage can't delete message.&quot;);</span>
<a href="#l34.21"></a><span id="l34.21">       } while(false);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgSend.cpp</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgSend.cpp</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -3980,17 +3980,17 @@ nsMsgComposeAndSend::FilterSentMessage()</span>
<a href="#l35.4"></a><span id="l35.4">   nsCOMPtr&lt;nsIMutableArray&gt; msgArray(do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l35.5"></a><span id="l35.5">   if (NS_FAILED(rv))</span>
<a href="#l35.6"></a><span id="l35.6">     return rv;</span>
<a href="#l35.7"></a><span id="l35.7"> </span>
<a href="#l35.8"></a><span id="l35.8">   nsCOMPtr&lt;nsIMsgFilterService&gt; filterSvc = do_GetService(NS_MSGFILTERSERVICE_CONTRACTID, &amp;rv);</span>
<a href="#l35.9"></a><span id="l35.9">   if (NS_FAILED(rv))</span>
<a href="#l35.10"></a><span id="l35.10">     return rv;</span>
<a href="#l35.11"></a><span id="l35.11"> </span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-  rv = msgArray-&gt;AppendElement(msgHdr, false);</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineplus">+  rv = msgArray-&gt;AppendElement(msgHdr);</span>
<a href="#l35.14"></a><span id="l35.14">   if (NS_FAILED(rv))</span>
<a href="#l35.15"></a><span id="l35.15">     return rv;</span>
<a href="#l35.16"></a><span id="l35.16"> </span>
<a href="#l35.17"></a><span id="l35.17">   nsCOMPtr&lt;nsIMsgWindow&gt; msgWindow;</span>
<a href="#l35.18"></a><span id="l35.18">   if (mSendProgress)</span>
<a href="#l35.19"></a><span id="l35.19">     mSendProgress-&gt;GetMsgWindow(getter_AddRefs(msgWindow));</span>
<a href="#l35.20"></a><span id="l35.20"> </span>
<a href="#l35.21"></a><span id="l35.21">   return filterSvc-&gt;ApplyFilters(nsMsgFilterType::PostOutgoing, msgArray, folder, msgWindow, this);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgSendLater.cpp</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgSendLater.cpp</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -879,17 +879,17 @@ nsMsgSendLater::DeleteCurrentMessage()</span>
<a href="#l36.4"></a><span id="l36.4">   // Get the composition fields interface</span>
<a href="#l36.5"></a><span id="l36.5">   nsCOMPtr&lt;nsIMutableArray&gt; msgArray(do_CreateInstance(NS_ARRAY_CONTRACTID));</span>
<a href="#l36.6"></a><span id="l36.6">   if (!msgArray)</span>
<a href="#l36.7"></a><span id="l36.7">     return NS_ERROR_FACTORY_NOT_LOADED;</span>
<a href="#l36.8"></a><span id="l36.8"> </span>
<a href="#l36.9"></a><span id="l36.9">   if (!mMessageFolder)</span>
<a href="#l36.10"></a><span id="l36.10">     return NS_ERROR_UNEXPECTED;</span>
<a href="#l36.11"></a><span id="l36.11"> </span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-  msgArray-&gt;InsertElementAt(mMessage, 0, false);</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineplus">+  msgArray-&gt;InsertElementAt(mMessage, 0);</span>
<a href="#l36.14"></a><span id="l36.14"> </span>
<a href="#l36.15"></a><span id="l36.15">   nsresult res = mMessageFolder-&gt;DeleteMessages(msgArray, nullptr, true, false, nullptr, false /*allowUndo*/);</span>
<a href="#l36.16"></a><span id="l36.16">   if (NS_FAILED(res))</span>
<a href="#l36.17"></a><span id="l36.17">     return NS_ERROR_FAILURE;</span>
<a href="#l36.18"></a><span id="l36.18"> </span>
<a href="#l36.19"></a><span id="l36.19">   // Null out the message so we don't try and delete it again.</span>
<a href="#l36.20"></a><span id="l36.20">   mMessage = nullptr;</span>
<a href="#l36.21"></a><span id="l36.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/mailnews/db/msgdb/src/nsMsgDatabase.cpp</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/mailnews/db/msgdb/src/nsMsgDatabase.cpp</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -465,17 +465,17 @@ NS_IMETHODIMP nsMsgDBService::ForceFolde</span>
<a href="#l37.4"></a><span id="l37.4"> </span>
<a href="#l37.5"></a><span id="l37.5"> NS_IMETHODIMP nsMsgDBService::GetOpenDBs(nsIArray **aOpenDBs)</span>
<a href="#l37.6"></a><span id="l37.6"> {</span>
<a href="#l37.7"></a><span id="l37.7">   NS_ENSURE_ARG_POINTER(aOpenDBs);</span>
<a href="#l37.8"></a><span id="l37.8">   nsresult rv;</span>
<a href="#l37.9"></a><span id="l37.9">   nsCOMPtr&lt;nsIMutableArray&gt; openDBs(do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l37.10"></a><span id="l37.10">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l37.11"></a><span id="l37.11">   for (uint32_t i = 0; i &lt; m_dbCache.Length(); i++)</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-    openDBs-&gt;AppendElement(m_dbCache[i], false);</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineplus">+    openDBs-&gt;AppendElement(m_dbCache[i]);</span>
<a href="#l37.14"></a><span id="l37.14"> </span>
<a href="#l37.15"></a><span id="l37.15">   openDBs.forget(aOpenDBs);</span>
<a href="#l37.16"></a><span id="l37.16">   return NS_OK;</span>
<a href="#l37.17"></a><span id="l37.17"> }</span>
<a href="#l37.18"></a><span id="l37.18"> </span>
<a href="#l37.19"></a><span id="l37.19"> static bool gGotGlobalPrefs = false;</span>
<a href="#l37.20"></a><span id="l37.20"> static bool gThreadWithoutRe = true;</span>
<a href="#l37.21"></a><span id="l37.21"> static bool gStrictThreading = false;</span>
<a href="#l37.22"></a><span id="l37.22" class="difflineat">@@ -2896,17 +2896,17 @@ nsMsgDatabase::NextMatchingHdrs(nsISimpl</span>
<a href="#l37.23"></a><span id="l37.23">   do</span>
<a href="#l37.24"></a><span id="l37.24">   {</span>
<a href="#l37.25"></a><span id="l37.25">     nsCOMPtr &lt;nsISupports&gt; supports;</span>
<a href="#l37.26"></a><span id="l37.26">     rv = enumerator-&gt;GetNext(getter_AddRefs(supports));</span>
<a href="#l37.27"></a><span id="l37.27">     nsCOMPtr &lt;nsIMsgDBHdr&gt; nextMessage = do_QueryInterface(supports);</span>
<a href="#l37.28"></a><span id="l37.28">     if (NS_SUCCEEDED(rv) &amp;&amp; nextMessage)</span>
<a href="#l37.29"></a><span id="l37.29">     {</span>
<a href="#l37.30"></a><span id="l37.30">       if (aMatchingHdrs)</span>
<a href="#l37.31"></a><span id="l37.31" class="difflineminus">-        aMatchingHdrs-&gt;AppendElement(nextMessage, false);</span>
<a href="#l37.32"></a><span id="l37.32" class="difflineplus">+        aMatchingHdrs-&gt;AppendElement(nextMessage);</span>
<a href="#l37.33"></a><span id="l37.33">       ++numMatches;</span>
<a href="#l37.34"></a><span id="l37.34">       if (aMaxResults &amp;&amp; numMatches == aMaxResults)</span>
<a href="#l37.35"></a><span id="l37.35">         break;</span>
<a href="#l37.36"></a><span id="l37.36">     }</span>
<a href="#l37.37"></a><span id="l37.37">     else</span>
<a href="#l37.38"></a><span id="l37.38">       break;</span>
<a href="#l37.39"></a><span id="l37.39">   }</span>
<a href="#l37.40"></a><span id="l37.40">   while (true);</span>
<a href="#l37.41"></a><span id="l37.41" class="difflineat">@@ -5016,17 +5016,17 @@ nsresult nsMsgDatabase::PurgeMessagesOld</span>
<a href="#l37.42"></a><span id="l37.42">         purgeHdr = true;</span>
<a href="#l37.43"></a><span id="l37.43">     }</span>
<a href="#l37.44"></a><span id="l37.44">     if (purgeHdr)</span>
<a href="#l37.45"></a><span id="l37.45">     {</span>
<a href="#l37.46"></a><span id="l37.46">       nsMsgKey msgKey;</span>
<a href="#l37.47"></a><span id="l37.47">       pHeader-&gt;GetMessageKey(&amp;msgKey);</span>
<a href="#l37.48"></a><span id="l37.48">       keysToDelete.AppendElement(msgKey);</span>
<a href="#l37.49"></a><span id="l37.49">       if (hdrsToDelete)</span>
<a href="#l37.50"></a><span id="l37.50" class="difflineminus">-        hdrsToDelete-&gt;AppendElement(pHeader, false);</span>
<a href="#l37.51"></a><span id="l37.51" class="difflineplus">+        hdrsToDelete-&gt;AppendElement(pHeader);</span>
<a href="#l37.52"></a><span id="l37.52">     }</span>
<a href="#l37.53"></a><span id="l37.53">     NS_RELEASE(pHeader);</span>
<a href="#l37.54"></a><span id="l37.54">   }</span>
<a href="#l37.55"></a><span id="l37.55"> </span>
<a href="#l37.56"></a><span id="l37.56">   if (!hdrsToDelete)</span>
<a href="#l37.57"></a><span id="l37.57">   {</span>
<a href="#l37.58"></a><span id="l37.58">     DeleteMessages(keysToDelete.Length(), keysToDelete.Elements(), nullptr);</span>
<a href="#l37.59"></a><span id="l37.59"> </span>
<a href="#l37.60"></a><span id="l37.60" class="difflineat">@@ -5079,17 +5079,17 @@ nsresult nsMsgDatabase::PurgeExcessMessa</span>
<a href="#l37.61"></a><span id="l37.61"> </span>
<a href="#l37.62"></a><span id="l37.62">     if (purgeHdr)</span>
<a href="#l37.63"></a><span id="l37.63">     {</span>
<a href="#l37.64"></a><span id="l37.64">       nsMsgKey msgKey;</span>
<a href="#l37.65"></a><span id="l37.65">       pHeader-&gt;GetMessageKey(&amp;msgKey);</span>
<a href="#l37.66"></a><span id="l37.66">       keysToDelete.AppendElement(msgKey);</span>
<a href="#l37.67"></a><span id="l37.67">       numHdrs--;</span>
<a href="#l37.68"></a><span id="l37.68">       if (hdrsToDelete)</span>
<a href="#l37.69"></a><span id="l37.69" class="difflineminus">-        hdrsToDelete-&gt;AppendElement(pHeader, false);</span>
<a href="#l37.70"></a><span id="l37.70" class="difflineplus">+        hdrsToDelete-&gt;AppendElement(pHeader);</span>
<a href="#l37.71"></a><span id="l37.71">     }</span>
<a href="#l37.72"></a><span id="l37.72">     NS_RELEASE(pHeader);</span>
<a href="#l37.73"></a><span id="l37.73">   }</span>
<a href="#l37.74"></a><span id="l37.74"> </span>
<a href="#l37.75"></a><span id="l37.75">   if (!hdrsToDelete)</span>
<a href="#l37.76"></a><span id="l37.76">   {</span>
<a href="#l37.77"></a><span id="l37.77">     int32_t numKeysToDelete = keysToDelete.Length();</span>
<a href="#l37.78"></a><span id="l37.78">     if (numKeysToDelete &gt; 0)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -108,17 +108,17 @@ NS_IMETHODIMP nsMsgMailView::SetSearchTe</span>
<a href="#l38.4"></a><span id="l38.4">     mViewSearchTerms = aSearchTerms;</span>
<a href="#l38.5"></a><span id="l38.5">     return NS_OK;</span>
<a href="#l38.6"></a><span id="l38.6"> }</span>
<a href="#l38.7"></a><span id="l38.7"> </span>
<a href="#l38.8"></a><span id="l38.8"> NS_IMETHODIMP nsMsgMailView::AppendTerm(nsIMsgSearchTerm *aTerm)</span>
<a href="#l38.9"></a><span id="l38.9"> {</span>
<a href="#l38.10"></a><span id="l38.10">     NS_ENSURE_TRUE(aTerm, NS_ERROR_NULL_POINTER);</span>
<a href="#l38.11"></a><span id="l38.11"> </span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-    return mViewSearchTerms-&gt;AppendElement(aTerm, /* weak */ false);</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineplus">+    return mViewSearchTerms-&gt;AppendElement(aTerm);</span>
<a href="#l38.14"></a><span id="l38.14"> }</span>
<a href="#l38.15"></a><span id="l38.15"> </span>
<a href="#l38.16"></a><span id="l38.16"> NS_IMETHODIMP nsMsgMailView::CreateTerm(nsIMsgSearchTerm **aResult)</span>
<a href="#l38.17"></a><span id="l38.17"> {</span>
<a href="#l38.18"></a><span id="l38.18">     NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l38.19"></a><span id="l38.19">     nsCOMPtr&lt;nsIMsgSearchTerm&gt; searchTerm = do_CreateInstance(&quot;@mozilla.org/messenger/searchTerm;1&quot;);</span>
<a href="#l38.20"></a><span id="l38.20">     searchTerm.forget(aResult);</span>
<a href="#l38.21"></a><span id="l38.21">     return NS_OK;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -983,21 +983,21 @@ nsresult nsMsgComposeSecure::MimeCryptoH</span>
<a href="#l39.4"></a><span id="l39.4">      */</span>
<a href="#l39.5"></a><span id="l39.5"> </span>
<a href="#l39.6"></a><span id="l39.6">       bool isSame;</span>
<a href="#l39.7"></a><span id="l39.7">       if (NS_SUCCEEDED(cert-&gt;Equals(mSelfEncryptionCert, &amp;isSame))</span>
<a href="#l39.8"></a><span id="l39.8">           &amp;&amp; isSame) {</span>
<a href="#l39.9"></a><span id="l39.9">         already_added_self_cert = true;</span>
<a href="#l39.10"></a><span id="l39.10">       }</span>
<a href="#l39.11"></a><span id="l39.11"> </span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-      mCerts-&gt;AppendElement(cert, false);</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+      mCerts-&gt;AppendElement(cert);</span>
<a href="#l39.14"></a><span id="l39.14">     }</span>
<a href="#l39.15"></a><span id="l39.15"> </span>
<a href="#l39.16"></a><span id="l39.16">     if (!already_added_self_cert) {</span>
<a href="#l39.17"></a><span id="l39.17" class="difflineminus">-      mCerts-&gt;AppendElement(mSelfEncryptionCert, false);</span>
<a href="#l39.18"></a><span id="l39.18" class="difflineplus">+      mCerts-&gt;AppendElement(mSelfEncryptionCert);</span>
<a href="#l39.19"></a><span id="l39.19">     }</span>
<a href="#l39.20"></a><span id="l39.20">   }</span>
<a href="#l39.21"></a><span id="l39.21">   return res;</span>
<a href="#l39.22"></a><span id="l39.22"> }</span>
<a href="#l39.23"></a><span id="l39.23"> </span>
<a href="#l39.24"></a><span id="l39.24"> NS_IMETHODIMP nsMsgComposeSecure::MimeCryptoWriteBlock (const char *buf, int32_t size)</span>
<a href="#l39.25"></a><span id="l39.25"> {</span>
<a href="#l39.26"></a><span id="l39.26">   int status = 0;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/mailnews/imap/src/nsAutoSyncState.cpp</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/mailnews/imap/src/nsAutoSyncState.cpp</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -293,24 +293,24 @@ NS_IMETHODIMP nsAutoSyncState::GetNextGr</span>
<a href="#l40.4"></a><span id="l40.4">         // ignore 0 byte messages; the imap parser asserts when we try </span>
<a href="#l40.5"></a><span id="l40.5">         // to download them, and there's no point anyway.</span>
<a href="#l40.6"></a><span id="l40.6">         if (!msgSize)</span>
<a href="#l40.7"></a><span id="l40.7">           continue;</span>
<a href="#l40.8"></a><span id="l40.8"> </span>
<a href="#l40.9"></a><span id="l40.9">         if (!*aActualGroupSize &amp;&amp; msgSize &gt;= aSuggestedGroupSizeLimit) </span>
<a href="#l40.10"></a><span id="l40.10">         {</span>
<a href="#l40.11"></a><span id="l40.11">           *aActualGroupSize = msgSize;</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-          group-&gt;AppendElement(qhdr, false);</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+          group-&gt;AppendElement(qhdr);</span>
<a href="#l40.14"></a><span id="l40.14">           idx++;</span>
<a href="#l40.15"></a><span id="l40.15">           break;</span>
<a href="#l40.16"></a><span id="l40.16">         }</span>
<a href="#l40.17"></a><span id="l40.17">         if ((*aActualGroupSize) + msgSize &gt; aSuggestedGroupSizeLimit)</span>
<a href="#l40.18"></a><span id="l40.18">           break;</span>
<a href="#l40.19"></a><span id="l40.19"> </span>
<a href="#l40.20"></a><span id="l40.20" class="difflineminus">-        group-&gt;AppendElement(qhdr, false);</span>
<a href="#l40.21"></a><span id="l40.21" class="difflineplus">+        group-&gt;AppendElement(qhdr);</span>
<a href="#l40.22"></a><span id="l40.22">         *aActualGroupSize += msgSize;</span>
<a href="#l40.23"></a><span id="l40.23">       }// endfor</span>
<a href="#l40.24"></a><span id="l40.24"> </span>
<a href="#l40.25"></a><span id="l40.25">       mLastOffset = mOffset;</span>
<a href="#l40.26"></a><span id="l40.26">       mOffset = idx;</span>
<a href="#l40.27"></a><span id="l40.27">     }</span>
<a href="#l40.28"></a><span id="l40.28"> </span>
<a href="#l40.29"></a><span id="l40.29">     LogOwnerFolderName(&quot;Next group of messages to be downloaded.&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/mailnews/imap/src/nsImapMailFolder.cpp</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapMailFolder.cpp</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -1030,17 +1030,17 @@ NS_IMETHODIMP nsImapMailFolder::List()</span>
<a href="#l41.4"></a><span id="l41.4"> </span>
<a href="#l41.5"></a><span id="l41.5"> NS_IMETHODIMP nsImapMailFolder::RemoveSubFolder (nsIMsgFolder *which)</span>
<a href="#l41.6"></a><span id="l41.6"> {</span>
<a href="#l41.7"></a><span id="l41.7">   nsresult rv;</span>
<a href="#l41.8"></a><span id="l41.8">   nsCOMPtr&lt;nsIMutableArray&gt; folders(do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l41.9"></a><span id="l41.9">   NS_ENSURE_TRUE(folders, rv);</span>
<a href="#l41.10"></a><span id="l41.10">   nsCOMPtr&lt;nsISupports&gt; folderSupport = do_QueryInterface(which, &amp;rv);</span>
<a href="#l41.11"></a><span id="l41.11">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-  folders-&gt;AppendElement(folderSupport, false);</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+  folders-&gt;AppendElement(folderSupport);</span>
<a href="#l41.14"></a><span id="l41.14">   rv = nsMsgDBFolder::DeleteSubFolders(folders, nullptr);</span>
<a href="#l41.15"></a><span id="l41.15">   which-&gt;Delete();</span>
<a href="#l41.16"></a><span id="l41.16">   return rv;</span>
<a href="#l41.17"></a><span id="l41.17"> }</span>
<a href="#l41.18"></a><span id="l41.18"> </span>
<a href="#l41.19"></a><span id="l41.19"> NS_IMETHODIMP nsImapMailFolder::CreateStorageIfMissing(nsIUrlListener* urlListener)</span>
<a href="#l41.20"></a><span id="l41.20"> {</span>
<a href="#l41.21"></a><span id="l41.21">   nsresult rv = NS_OK;</span>
<a href="#l41.22"></a><span id="l41.22" class="difflineat">@@ -1392,19 +1392,19 @@ NS_IMETHODIMP nsImapMailFolder::CompactA</span>
<a href="#l41.23"></a><span id="l41.23">     for (uint32_t i = 0; i &lt; cnt; i++)</span>
<a href="#l41.24"></a><span id="l41.24">     {</span>
<a href="#l41.25"></a><span id="l41.25">       nsCOMPtr&lt;nsIMsgFolder&gt; folder = do_QueryElementAt(allDescendents, i, &amp;rv);</span>
<a href="#l41.26"></a><span id="l41.26">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l41.27"></a><span id="l41.27">       uint32_t folderFlags;</span>
<a href="#l41.28"></a><span id="l41.28">       folder-&gt;GetFlags(&amp;folderFlags);</span>
<a href="#l41.29"></a><span id="l41.29">       if (! (folderFlags &amp; (nsMsgFolderFlags::Virtual | nsMsgFolderFlags::ImapNoselect)))</span>
<a href="#l41.30"></a><span id="l41.30">       {</span>
<a href="#l41.31"></a><span id="l41.31" class="difflineminus">-        rv = folderArray-&gt;AppendElement(folder, false);</span>
<a href="#l41.32"></a><span id="l41.32" class="difflineplus">+        rv = folderArray-&gt;AppendElement(folder);</span>
<a href="#l41.33"></a><span id="l41.33">         if (aCompactOfflineAlso)</span>
<a href="#l41.34"></a><span id="l41.34" class="difflineminus">-          offlineFolderArray-&gt;AppendElement(folder, false);</span>
<a href="#l41.35"></a><span id="l41.35" class="difflineplus">+          offlineFolderArray-&gt;AppendElement(folder);</span>
<a href="#l41.36"></a><span id="l41.36">       }</span>
<a href="#l41.37"></a><span id="l41.37">     }</span>
<a href="#l41.38"></a><span id="l41.38">     rv = folderArray-&gt;GetLength(&amp;cnt);</span>
<a href="#l41.39"></a><span id="l41.39">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l41.40"></a><span id="l41.40">     if (cnt == 0)</span>
<a href="#l41.41"></a><span id="l41.41">       return NotifyCompactCompleted();</span>
<a href="#l41.42"></a><span id="l41.42">   }</span>
<a href="#l41.43"></a><span id="l41.43">   nsCOMPtr &lt;nsIMsgFolderCompactor&gt; folderCompactor =</span>
<a href="#l41.44"></a><span id="l41.44" class="difflineat">@@ -2370,17 +2370,17 @@ nsImapMailFolder::DeleteSubFolders(nsIAr</span>
<a href="#l41.45"></a><span id="l41.45">       if (folderFlags &amp; nsMsgFolderFlags::Virtual)</span>
<a href="#l41.46"></a><span id="l41.46">       {</span>
<a href="#l41.47"></a><span id="l41.47">         RemoveSubFolder(curFolder);</span>
<a href="#l41.48"></a><span id="l41.48">         // since the folder pane only allows single selection, we can do this</span>
<a href="#l41.49"></a><span id="l41.49">         deleteNoTrash = confirmed = true;</span>
<a href="#l41.50"></a><span id="l41.50">         confirmDeletion = false;</span>
<a href="#l41.51"></a><span id="l41.51">       }</span>
<a href="#l41.52"></a><span id="l41.52">       else</span>
<a href="#l41.53"></a><span id="l41.53" class="difflineminus">-        foldersRemaining-&gt;InsertElementAt(curFolder, 0, false);</span>
<a href="#l41.54"></a><span id="l41.54" class="difflineplus">+        foldersRemaining-&gt;InsertElementAt(curFolder, 0);</span>
<a href="#l41.55"></a><span id="l41.55">     }</span>
<a href="#l41.56"></a><span id="l41.56">   }</span>
<a href="#l41.57"></a><span id="l41.57"> </span>
<a href="#l41.58"></a><span id="l41.58">   foldersRemaining-&gt;GetLength(&amp;folderCount);</span>
<a href="#l41.59"></a><span id="l41.59"> </span>
<a href="#l41.60"></a><span id="l41.60">   nsCOMPtr&lt;nsIImapService&gt; imapService = do_GetService(NS_IMAPSERVICE_CONTRACTID, &amp;rv);</span>
<a href="#l41.61"></a><span id="l41.61">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l41.62"></a><span id="l41.62">   if (!deleteNoTrash)</span>
<a href="#l41.63"></a><span id="l41.63" class="difflineat">@@ -3563,17 +3563,17 @@ NS_IMETHODIMP nsImapMailFolder::ApplyFil</span>
<a href="#l41.64"></a><span id="l41.64">             if (msgFlags &amp; nsMsgMessageFlags::MDNReportNeeded &amp;&amp; !isRead)</span>
<a href="#l41.65"></a><span id="l41.65">             {</span>
<a href="#l41.66"></a><span id="l41.66">                mDatabase-&gt;MarkMDNNeeded(msgKey, false, nullptr);</span>
<a href="#l41.67"></a><span id="l41.67">                mDatabase-&gt;MarkMDNSent(msgKey, true, nullptr);</span>
<a href="#l41.68"></a><span id="l41.68">             }</span>
<a href="#l41.69"></a><span id="l41.69"> </span>
<a href="#l41.70"></a><span id="l41.70">             nsCOMPtr&lt;nsIMutableArray&gt; messageArray(do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l41.71"></a><span id="l41.71">             NS_ENSURE_TRUE(messageArray, rv);</span>
<a href="#l41.72"></a><span id="l41.72" class="difflineminus">-            messageArray-&gt;AppendElement(msgHdr, false);</span>
<a href="#l41.73"></a><span id="l41.73" class="difflineplus">+            messageArray-&gt;AppendElement(msgHdr);</span>
<a href="#l41.74"></a><span id="l41.74"> </span>
<a href="#l41.75"></a><span id="l41.75">             nsCOMPtr&lt;nsIMsgFolder&gt; dstFolder;</span>
<a href="#l41.76"></a><span id="l41.76">             rv = GetExistingFolder(actionTargetFolderUri, getter_AddRefs(dstFolder));</span>
<a href="#l41.77"></a><span id="l41.77">             NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l41.78"></a><span id="l41.78"> </span>
<a href="#l41.79"></a><span id="l41.79">             nsCOMPtr&lt;nsIMsgCopyService&gt; copyService =</span>
<a href="#l41.80"></a><span id="l41.80">               do_GetService(NS_MSGCOPYSERVICE_CONTRACTID, &amp;rv);</span>
<a href="#l41.81"></a><span id="l41.81">             NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l41.82"></a><span id="l41.82" class="difflineat">@@ -3658,17 +3658,17 @@ NS_IMETHODIMP nsImapMailFolder::ApplyFil</span>
<a href="#l41.83"></a><span id="l41.83">         }</span>
<a href="#l41.84"></a><span id="l41.84">         break;</span>
<a href="#l41.85"></a><span id="l41.85">         case nsMsgFilterAction::AddTag:</span>
<a href="#l41.86"></a><span id="l41.86">         {</span>
<a href="#l41.87"></a><span id="l41.87">           nsCString keyword;</span>
<a href="#l41.88"></a><span id="l41.88">           filterAction-&gt;GetStrValue(keyword);</span>
<a href="#l41.89"></a><span id="l41.89">           nsCOMPtr&lt;nsIMutableArray&gt; messageArray(do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l41.90"></a><span id="l41.90">           NS_ENSURE_TRUE(messageArray, rv);</span>
<a href="#l41.91"></a><span id="l41.91" class="difflineminus">-          messageArray-&gt;AppendElement(msgHdr, false);</span>
<a href="#l41.92"></a><span id="l41.92" class="difflineplus">+          messageArray-&gt;AppendElement(msgHdr);</span>
<a href="#l41.93"></a><span id="l41.93">           AddKeywordsToMessages(messageArray, keyword);</span>
<a href="#l41.94"></a><span id="l41.94">           break;</span>
<a href="#l41.95"></a><span id="l41.95">         }</span>
<a href="#l41.96"></a><span id="l41.96">         case nsMsgFilterAction::JunkScore:</span>
<a href="#l41.97"></a><span id="l41.97">         {</span>
<a href="#l41.98"></a><span id="l41.98">           nsAutoCString junkScoreStr;</span>
<a href="#l41.99"></a><span id="l41.99">           int32_t junkScore;</span>
<a href="#l41.100"></a><span id="l41.100">           filterAction-&gt;GetJunkScore(&amp;junkScore);</span>
<a href="#l41.101"></a><span id="l41.101" class="difflineat">@@ -3768,17 +3768,17 @@ NS_IMETHODIMP nsImapMailFolder::ApplyFil</span>
<a href="#l41.102"></a><span id="l41.102">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l41.103"></a><span id="l41.103"> </span>
<a href="#l41.104"></a><span id="l41.104">           nsAutoCString value;</span>
<a href="#l41.105"></a><span id="l41.105">           filterAction-&gt;GetStrValue(value);</span>
<a href="#l41.106"></a><span id="l41.106"> </span>
<a href="#l41.107"></a><span id="l41.107">           nsCOMPtr&lt;nsIMutableArray&gt; messageArray(</span>
<a href="#l41.108"></a><span id="l41.108">               do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l41.109"></a><span id="l41.109">           NS_ENSURE_TRUE(messageArray, rv);</span>
<a href="#l41.110"></a><span id="l41.110" class="difflineminus">-          messageArray-&gt;AppendElement(msgHdr, false);</span>
<a href="#l41.111"></a><span id="l41.111" class="difflineplus">+          messageArray-&gt;AppendElement(msgHdr);</span>
<a href="#l41.112"></a><span id="l41.112"> </span>
<a href="#l41.113"></a><span id="l41.113">           customAction-&gt;Apply(messageArray, value, nullptr,</span>
<a href="#l41.114"></a><span id="l41.114">                               nsMsgFilterType::InboxRule, msgWindow);</span>
<a href="#l41.115"></a><span id="l41.115">           // allow custom action to affect new</span>
<a href="#l41.116"></a><span id="l41.116">           msgHdr-&gt;GetFlags(&amp;msgFlags);</span>
<a href="#l41.117"></a><span id="l41.117">           if (!(msgFlags &amp; nsMsgMessageFlags::New))</span>
<a href="#l41.118"></a><span id="l41.118">             msgIsNew = false;</span>
<a href="#l41.119"></a><span id="l41.119">         }</span>
<a href="#l41.120"></a><span id="l41.120" class="difflineat">@@ -3866,17 +3866,17 @@ nsImapMailFolder::ReplayOfflineMoveCopy(</span>
<a href="#l41.121"></a><span id="l41.121">               for (uint32_t msgIndex = 0; msgIndex &lt; aNumKeys; msgIndex++)</span>
<a href="#l41.122"></a><span id="l41.122">               {</span>
<a href="#l41.123"></a><span id="l41.123">                 if (srcMessageKey == aMsgKeys[msgIndex])</span>
<a href="#l41.124"></a><span id="l41.124">                 {</span>
<a href="#l41.125"></a><span id="l41.125">                   nsCOMPtr&lt;nsIMsgDBHdr&gt; fakeDestHdr;</span>
<a href="#l41.126"></a><span id="l41.126">                   dstFolderDB-&gt;GetMsgHdrForKey(offlineOps[opIndex],</span>
<a href="#l41.127"></a><span id="l41.127">                     getter_AddRefs(fakeDestHdr));</span>
<a href="#l41.128"></a><span id="l41.128">                   if (fakeDestHdr)</span>
<a href="#l41.129"></a><span id="l41.129" class="difflineminus">-                    messages-&gt;AppendElement(fakeDestHdr, false);</span>
<a href="#l41.130"></a><span id="l41.130" class="difflineplus">+                    messages-&gt;AppendElement(fakeDestHdr);</span>
<a href="#l41.131"></a><span id="l41.131">                   break;</span>
<a href="#l41.132"></a><span id="l41.132">                 }</span>
<a href="#l41.133"></a><span id="l41.133">               }</span>
<a href="#l41.134"></a><span id="l41.134">             }</span>
<a href="#l41.135"></a><span id="l41.135">           }</span>
<a href="#l41.136"></a><span id="l41.136">         }</span>
<a href="#l41.137"></a><span id="l41.137">         destImapFolder-&gt;SetPendingAttributes(messages, isMove);</span>
<a href="#l41.138"></a><span id="l41.138">       }</span>
<a href="#l41.139"></a><span id="l41.139" class="difflineat">@@ -7273,17 +7273,17 @@ nsresult nsImapMailFolder::CopyMessagesO</span>
<a href="#l41.140"></a><span id="l41.140">             NS_ASSERTION(false, &quot;failed to copy hdr&quot;);</span>
<a href="#l41.141"></a><span id="l41.141">             stopit = rv;</span>
<a href="#l41.142"></a><span id="l41.142">           }</span>
<a href="#l41.143"></a><span id="l41.143"> </span>
<a href="#l41.144"></a><span id="l41.144">           if (NS_SUCCEEDED(stopit))</span>
<a href="#l41.145"></a><span id="l41.145">           {</span>
<a href="#l41.146"></a><span id="l41.146">             bool hasMsgOffline = false;</span>
<a href="#l41.147"></a><span id="l41.147"> </span>
<a href="#l41.148"></a><span id="l41.148" class="difflineminus">-            destMsgHdrs-&gt;AppendElement(newMailHdr, false);</span>
<a href="#l41.149"></a><span id="l41.149" class="difflineplus">+            destMsgHdrs-&gt;AppendElement(newMailHdr);</span>
<a href="#l41.150"></a><span id="l41.150">             srcFolder-&gt;HasMsgOffline(originalKey, &amp;hasMsgOffline);</span>
<a href="#l41.151"></a><span id="l41.151">             newMailHdr-&gt;SetUint32Property(&quot;pseudoHdr&quot;, 1);</span>
<a href="#l41.152"></a><span id="l41.152">             if (!reusable)</span>
<a href="#l41.153"></a><span id="l41.153">               (void)srcFolder-&gt;GetMsgInputStream(newMailHdr, &amp;reusable,</span>
<a href="#l41.154"></a><span id="l41.154">                                                  getter_AddRefs(inputStream));</span>
<a href="#l41.155"></a><span id="l41.155"> </span>
<a href="#l41.156"></a><span id="l41.156">             if (inputStream &amp;&amp; hasMsgOffline &amp;&amp; !isLocked)</span>
<a href="#l41.157"></a><span id="l41.157">             {</span>
<a href="#l41.158"></a><span id="l41.158" class="difflineat">@@ -7328,17 +7328,17 @@ nsresult nsImapMailFolder::CopyMessagesO</span>
<a href="#l41.159"></a><span id="l41.159">           {</span>
<a href="#l41.160"></a><span id="l41.160">             if (deleteToTrash || deleteImmediately)</span>
<a href="#l41.161"></a><span id="l41.161">               keysToDelete.AppendElement(msgKey);</span>
<a href="#l41.162"></a><span id="l41.162">             else</span>
<a href="#l41.163"></a><span id="l41.163">               sourceMailDB-&gt;MarkImapDeleted(msgKey, true, nullptr); // offline delete</span>
<a href="#l41.164"></a><span id="l41.164">           }</span>
<a href="#l41.165"></a><span id="l41.165">           if (successfulCopy)</span>
<a href="#l41.166"></a><span id="l41.166">             // This is for both moves and copies</span>
<a href="#l41.167"></a><span id="l41.167" class="difflineminus">-            msgHdrsCopied-&gt;AppendElement(mailHdr, false);</span>
<a href="#l41.168"></a><span id="l41.168" class="difflineplus">+            msgHdrsCopied-&gt;AppendElement(mailHdr);</span>
<a href="#l41.169"></a><span id="l41.169">         }</span>
<a href="#l41.170"></a><span id="l41.170">       }</span>
<a href="#l41.171"></a><span id="l41.171">       EnableNotifications(nsIMsgFolder::allMessageCountNotifications, true);</span>
<a href="#l41.172"></a><span id="l41.172">       RefPtr&lt;nsImapOfflineTxn&gt; addHdrMsgTxn = new</span>
<a href="#l41.173"></a><span id="l41.173">         nsImapOfflineTxn(this, &amp;addedKeys, nullptr, this, isMove, nsIMsgOfflineImapOperation::kAddedHeader,</span>
<a href="#l41.174"></a><span id="l41.174">                          addedHdrs);</span>
<a href="#l41.175"></a><span id="l41.175">       if (addHdrMsgTxn &amp;&amp; txnMgr)</span>
<a href="#l41.176"></a><span id="l41.176">          txnMgr-&gt;DoTransaction(addHdrMsgTxn);</span>
<a href="#l41.177"></a><span id="l41.177" class="difflineat">@@ -7863,17 +7863,17 @@ nsImapFolderCopyState::OnStopRunningUrl(</span>
<a href="#l41.178"></a><span id="l41.178"> </span>
<a href="#l41.179"></a><span id="l41.179">           if (!hasMore)</span>
<a href="#l41.180"></a><span id="l41.180">             return AdvanceToNextFolder(NS_OK);</span>
<a href="#l41.181"></a><span id="l41.181"> </span>
<a href="#l41.182"></a><span id="l41.182">           while (NS_SUCCEEDED(rv) &amp;&amp; hasMore)</span>
<a href="#l41.183"></a><span id="l41.183">           {</span>
<a href="#l41.184"></a><span id="l41.184">             rv = enumerator-&gt;GetNext(getter_AddRefs(item));</span>
<a href="#l41.185"></a><span id="l41.185">             NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l41.186"></a><span id="l41.186" class="difflineminus">-            rv = msgArray-&gt;AppendElement(item, false);</span>
<a href="#l41.187"></a><span id="l41.187" class="difflineplus">+            rv = msgArray-&gt;AppendElement(item);</span>
<a href="#l41.188"></a><span id="l41.188">             NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l41.189"></a><span id="l41.189">             rv = enumerator-&gt;HasMoreElements(&amp;hasMore);</span>
<a href="#l41.190"></a><span id="l41.190">           }</span>
<a href="#l41.191"></a><span id="l41.191"> </span>
<a href="#l41.192"></a><span id="l41.192">           nsCOMPtr&lt;nsIMsgCopyService&gt; copyService = do_GetService(NS_MSGCOPYSERVICE_CONTRACTID, &amp;rv);</span>
<a href="#l41.193"></a><span id="l41.193">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l41.194"></a><span id="l41.194">           rv = copyService-&gt;CopyMessages(m_curSrcFolder,</span>
<a href="#l41.195"></a><span id="l41.195">                              msgArray, newMsgFolder,</span>
<a href="#l41.196"></a><span id="l41.196" class="difflineat">@@ -8089,17 +8089,17 @@ nsImapMailFolder::CopyFileMessage(nsIFil</span>
<a href="#l41.197"></a><span id="l41.197">         {</span>
<a href="#l41.198"></a><span id="l41.198">           messageId.AppendInt((int32_t) key);</span>
<a href="#l41.199"></a><span id="l41.199">           // Perhaps we have the message offline, but even if we do it is</span>
<a href="#l41.200"></a><span id="l41.200">           // not valid, since the only time we do a file copy for an</span>
<a href="#l41.201"></a><span id="l41.201">           // existing message is when we are changing the message.</span>
<a href="#l41.202"></a><span id="l41.202">           // So set the offline size to 0 to force SetPendingAttributes to</span>
<a href="#l41.203"></a><span id="l41.203">           // clear the offline message flag.</span>
<a href="#l41.204"></a><span id="l41.204">           msgToReplace-&gt;SetOfflineMessageSize(0);</span>
<a href="#l41.205"></a><span id="l41.205" class="difflineminus">-          messages-&gt;AppendElement(msgToReplace, false);</span>
<a href="#l41.206"></a><span id="l41.206" class="difflineplus">+          messages-&gt;AppendElement(msgToReplace);</span>
<a href="#l41.207"></a><span id="l41.207">           SetPendingAttributes(messages, false);</span>
<a href="#l41.208"></a><span id="l41.208">         }</span>
<a href="#l41.209"></a><span id="l41.209">     }</span>
<a href="#l41.210"></a><span id="l41.210"> </span>
<a href="#l41.211"></a><span id="l41.211">     bool isMove = (msgToReplace ? true : false);</span>
<a href="#l41.212"></a><span id="l41.212">     rv = InitCopyState(srcSupport, messages, isMove, isDraftOrTemplate,</span>
<a href="#l41.213"></a><span id="l41.213">                        false, aNewMsgFlags, aNewMsgKeywords, listener, </span>
<a href="#l41.214"></a><span id="l41.214">                        msgWindow, false);</span>
<a href="#l41.215"></a><span id="l41.215" class="difflineat">@@ -8428,17 +8428,17 @@ nsImapMailFolder::CopyFileToOfflineStore</span>
<a href="#l41.216"></a><span id="l41.216">       nsCOMPtr&lt;nsIMsgPluggableStore&gt; msgStore;</span>
<a href="#l41.217"></a><span id="l41.217">       GetMsgStore(getter_AddRefs(msgStore));</span>
<a href="#l41.218"></a><span id="l41.218">       if (msgStore)</span>
<a href="#l41.219"></a><span id="l41.219">         msgStore-&gt;FinishNewMessage(offlineStore, fakeHdr);</span>
<a href="#l41.220"></a><span id="l41.220">     }</span>
<a href="#l41.221"></a><span id="l41.221"> </span>
<a href="#l41.222"></a><span id="l41.222">     nsCOMPtr&lt;nsIMutableArray&gt; messages(do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l41.223"></a><span id="l41.223">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l41.224"></a><span id="l41.224" class="difflineminus">-    messages-&gt;AppendElement(fakeHdr, false);</span>
<a href="#l41.225"></a><span id="l41.225" class="difflineplus">+    messages-&gt;AppendElement(fakeHdr);</span>
<a href="#l41.226"></a><span id="l41.226"> </span>
<a href="#l41.227"></a><span id="l41.227">     SetPendingAttributes(messages, false);</span>
<a href="#l41.228"></a><span id="l41.228">     // Gloda needs this notification to index the fake message.</span>
<a href="#l41.229"></a><span id="l41.229">     nsCOMPtr&lt;nsIMsgFolderNotificationService&gt;</span>
<a href="#l41.230"></a><span id="l41.230">       notifier(do_GetService(NS_MSGNOTIFICATIONSERVICE_CONTRACTID));</span>
<a href="#l41.231"></a><span id="l41.231">     if (notifier)</span>
<a href="#l41.232"></a><span id="l41.232">       notifier-&gt;NotifyMsgsClassified(messages, false, false);</span>
<a href="#l41.233"></a><span id="l41.233">     inputStream-&gt;Close();</span>
<a href="#l41.234"></a><span id="l41.234" class="difflineat">@@ -9138,17 +9138,17 @@ nsImapMailFolder::OnMessageClassified(co</span>
<a href="#l41.235"></a><span id="l41.235">         (void)spamSettings-&gt;GetMarkAsReadOnSpam(&amp;markAsReadOnSpam);</span>
<a href="#l41.236"></a><span id="l41.236">         if (markAsReadOnSpam)</span>
<a href="#l41.237"></a><span id="l41.237">         {</span>
<a href="#l41.238"></a><span id="l41.238">           if (!m_junkMessagesToMarkAsRead)</span>
<a href="#l41.239"></a><span id="l41.239">           {</span>
<a href="#l41.240"></a><span id="l41.240">             m_junkMessagesToMarkAsRead = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l41.241"></a><span id="l41.241">             NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l41.242"></a><span id="l41.242">           }</span>
<a href="#l41.243"></a><span id="l41.243" class="difflineminus">-          m_junkMessagesToMarkAsRead-&gt;AppendElement(msgHdr, false);</span>
<a href="#l41.244"></a><span id="l41.244" class="difflineplus">+          m_junkMessagesToMarkAsRead-&gt;AppendElement(msgHdr);</span>
<a href="#l41.245"></a><span id="l41.245">         }</span>
<a href="#l41.246"></a><span id="l41.246"> </span>
<a href="#l41.247"></a><span id="l41.247">         bool willMoveMessage = false;</span>
<a href="#l41.248"></a><span id="l41.248"> </span>
<a href="#l41.249"></a><span id="l41.249">         // don't do the move when we are opening up</span>
<a href="#l41.250"></a><span id="l41.250">         // the junk mail folder or the trash folder</span>
<a href="#l41.251"></a><span id="l41.251">         // or when manually classifying messages in those folders</span>
<a href="#l41.252"></a><span id="l41.252">         if (!(mFlags &amp; nsMsgFolderFlags::Junk || mFlags &amp; nsMsgFolderFlags::Trash))</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/mailnews/imap/src/nsImapOfflineSync.cpp</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapOfflineSync.cpp</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -600,17 +600,17 @@ void nsImapOfflineSync::ProcessMoveOpera</span>
<a href="#l42.4"></a><span id="l42.4">             op-&gt;GetNewFlags(&amp;newImapFlags);</span>
<a href="#l42.5"></a><span id="l42.5">             // first three bits are the same</span>
<a href="#l42.6"></a><span id="l42.6">             msgFlags |= (newImapFlags &amp; 0x07);</span>
<a href="#l42.7"></a><span id="l42.7">             if (newImapFlags &amp; kImapMsgForwardedFlag)</span>
<a href="#l42.8"></a><span id="l42.8">               msgFlags |= nsMsgMessageFlags::Forwarded;</span>
<a href="#l42.9"></a><span id="l42.9">             mailHdr-&gt;SetFlags(msgFlags);</span>
<a href="#l42.10"></a><span id="l42.10">             mailHdr-&gt;SetMessageSize(msgSize);</span>
<a href="#l42.11"></a><span id="l42.11">           }</span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-          messages-&gt;AppendElement(mailHdr, false);</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineplus">+          messages-&gt;AppendElement(mailHdr);</span>
<a href="#l42.14"></a><span id="l42.14">         }</span>
<a href="#l42.15"></a><span id="l42.15">       }</span>
<a href="#l42.16"></a><span id="l42.16">       nsCOMPtr&lt;nsIMsgCopyService&gt; copyService = do_GetService(NS_MSGCOPYSERVICE_CONTRACTID, &amp;rv);</span>
<a href="#l42.17"></a><span id="l42.17">       if (copyService)</span>
<a href="#l42.18"></a><span id="l42.18">         copyService-&gt;CopyMessages(m_currentFolder, messages, destFolder, true, this, m_window, false);</span>
<a href="#l42.19"></a><span id="l42.19">     }</span>
<a href="#l42.20"></a><span id="l42.20">   }</span>
<a href="#l42.21"></a><span id="l42.21"> }</span>
<a href="#l42.22"></a><span id="l42.22" class="difflineat">@@ -695,17 +695,17 @@ void nsImapOfflineSync::ProcessCopyOpera</span>
<a href="#l42.23"></a><span id="l42.23">     nsCOMPtr&lt;nsIMutableArray&gt; messages(do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l42.24"></a><span id="l42.24">     if (messages &amp;&amp; NS_SUCCEEDED(rv))</span>
<a href="#l42.25"></a><span id="l42.25">     {</span>
<a href="#l42.26"></a><span id="l42.26">       for (uint32_t keyIndex = 0; keyIndex &lt; matchingFlagKeys.Length(); keyIndex++)</span>
<a href="#l42.27"></a><span id="l42.27">       {</span>
<a href="#l42.28"></a><span id="l42.28">         nsCOMPtr&lt;nsIMsgDBHdr&gt; mailHdr = nullptr;</span>
<a href="#l42.29"></a><span id="l42.29">         rv = m_currentFolder-&gt;GetMessageHeader(matchingFlagKeys.ElementAt(keyIndex), getter_AddRefs(mailHdr));</span>
<a href="#l42.30"></a><span id="l42.30">         if (NS_SUCCEEDED(rv) &amp;&amp; mailHdr)</span>
<a href="#l42.31"></a><span id="l42.31" class="difflineminus">-          messages-&gt;AppendElement(mailHdr, false);</span>
<a href="#l42.32"></a><span id="l42.32" class="difflineplus">+          messages-&gt;AppendElement(mailHdr);</span>
<a href="#l42.33"></a><span id="l42.33">       }</span>
<a href="#l42.34"></a><span id="l42.34">       nsCOMPtr&lt;nsIMsgCopyService&gt; copyService = do_GetService(NS_MSGCOPYSERVICE_CONTRACTID, &amp;rv);</span>
<a href="#l42.35"></a><span id="l42.35">       if (copyService)</span>
<a href="#l42.36"></a><span id="l42.36">         copyService-&gt;CopyMessages(m_currentFolder, messages, destFolder, false, this, m_window, false);</span>
<a href="#l42.37"></a><span id="l42.37">     }</span>
<a href="#l42.38"></a><span id="l42.38">   }</span>
<a href="#l42.39"></a><span id="l42.39"> }</span>
<a href="#l42.40"></a><span id="l42.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/mailnews/import/applemail/src/nsAppleMailImport.cpp</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/mailnews/import/applemail/src/nsAppleMailImport.cpp</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -283,17 +283,17 @@ void nsAppleMailImportMail::FindAccountM</span>
<a href="#l43.4"></a><span id="l43.4">         nsCOMPtr&lt;nsIFile&gt; mailboxDescFile;</span>
<a href="#l43.5"></a><span id="l43.5">         rv = desc-&gt;GetFile(getter_AddRefs(mailboxDescFile));</span>
<a href="#l43.6"></a><span id="l43.6">         if (!mailboxDescFile)</span>
<a href="#l43.7"></a><span id="l43.7">           continue;</span>
<a href="#l43.8"></a><span id="l43.8"> </span>
<a href="#l43.9"></a><span id="l43.9">         mailboxDescFile-&gt;InitWithFile(currentEntry);</span>
<a href="#l43.10"></a><span id="l43.10"> </span>
<a href="#l43.11"></a><span id="l43.11">         // add this mailbox descriptor to the list</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-        aMailboxDescs-&gt;AppendElement(desc, false);</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineplus">+        aMailboxDescs-&gt;AppendElement(desc);</span>
<a href="#l43.14"></a><span id="l43.14"> </span>
<a href="#l43.15"></a><span id="l43.15">         // now add all the children mailboxes</span>
<a href="#l43.16"></a><span id="l43.16">         mCurDepth++;</span>
<a href="#l43.17"></a><span id="l43.17">         FindMboxDirs(currentEntry, aMailboxDescs, aImportService);</span>
<a href="#l43.18"></a><span id="l43.18">         mCurDepth--;</span>
<a href="#l43.19"></a><span id="l43.19">       }</span>
<a href="#l43.20"></a><span id="l43.20">     }</span>
<a href="#l43.21"></a><span id="l43.21">   }</span>
<a href="#l43.22"></a><span id="l43.22" class="difflineat">@@ -360,17 +360,17 @@ nsresult nsAppleMailImportMail::AddMboxD</span>
<a href="#l43.23"></a><span id="l43.23">     nsCOMPtr&lt;nsIFile&gt; mailboxDescFile;</span>
<a href="#l43.24"></a><span id="l43.24">     rv = desc-&gt;GetFile(getter_AddRefs(mailboxDescFile));</span>
<a href="#l43.25"></a><span id="l43.25">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l43.26"></a><span id="l43.26"> </span>
<a href="#l43.27"></a><span id="l43.27">     if (mailboxDescFile)</span>
<a href="#l43.28"></a><span id="l43.28">       mailboxDescFile-&gt;InitWithFile(aFolder);</span>
<a href="#l43.29"></a><span id="l43.29"> </span>
<a href="#l43.30"></a><span id="l43.30">     // add this mailbox descriptor to the list</span>
<a href="#l43.31"></a><span id="l43.31" class="difflineminus">-    aMailboxDescs-&gt;AppendElement(desc, false);</span>
<a href="#l43.32"></a><span id="l43.32" class="difflineplus">+    aMailboxDescs-&gt;AppendElement(desc);</span>
<a href="#l43.33"></a><span id="l43.33">   }</span>
<a href="#l43.34"></a><span id="l43.34"> </span>
<a href="#l43.35"></a><span id="l43.35">   return NS_OK;</span>
<a href="#l43.36"></a><span id="l43.36"> }</span>
<a href="#l43.37"></a><span id="l43.37"> </span>
<a href="#l43.38"></a><span id="l43.38"> // Starts looking for .mbox dirs in the specified dir. The .mbox dirs contain messages and can be considered leafs in a tree of</span>
<a href="#l43.39"></a><span id="l43.39"> // nested mailboxes (subfolders).</span>
<a href="#l43.40"></a><span id="l43.40"> //</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/mailnews/import/becky/src/nsBeckyAddressBooks.cpp</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/mailnews/import/becky/src/nsBeckyAddressBooks.cpp</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -232,17 +232,17 @@ nsBeckyAddressBooks::AppendAddressBookDe</span>
<a href="#l44.4"></a><span id="l44.4">   uint32_t size = CountAddressBookSize(aEntry);</span>
<a href="#l44.5"></a><span id="l44.5">   descriptor-&gt;SetSize(size);</span>
<a href="#l44.6"></a><span id="l44.6">   descriptor-&gt;SetAbFile(aEntry);</span>
<a href="#l44.7"></a><span id="l44.7"> </span>
<a href="#l44.8"></a><span id="l44.8">   nsAutoString name;</span>
<a href="#l44.9"></a><span id="l44.9">   aEntry-&gt;GetLeafName(name);</span>
<a href="#l44.10"></a><span id="l44.10">   descriptor-&gt;SetPreferredName(name);</span>
<a href="#l44.11"></a><span id="l44.11"> </span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-  return aCollected-&gt;AppendElement(descriptor, false);</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineplus">+  return aCollected-&gt;AppendElement(descriptor);</span>
<a href="#l44.14"></a><span id="l44.14"> }</span>
<a href="#l44.15"></a><span id="l44.15"> </span>
<a href="#l44.16"></a><span id="l44.16"> nsresult</span>
<a href="#l44.17"></a><span id="l44.17"> nsBeckyAddressBooks::CollectAddressBooks(nsIFile *aTarget,</span>
<a href="#l44.18"></a><span id="l44.18">                                          nsIMutableArray *aCollected)</span>
<a href="#l44.19"></a><span id="l44.19"> {</span>
<a href="#l44.20"></a><span id="l44.20">   nsresult rv = AppendAddressBookDescriptor(aTarget, aCollected);</span>
<a href="#l44.21"></a><span id="l44.21">   NS_ENSURE_SUCCESS(rv, rv);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/mailnews/import/becky/src/nsBeckyMail.cpp</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/mailnews/import/becky/src/nsBeckyMail.cpp</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -136,17 +136,17 @@ nsBeckyMail::AppendMailboxDescriptor(nsI</span>
<a href="#l45.4"></a><span id="l45.4"> </span>
<a href="#l45.5"></a><span id="l45.5">   nsCOMPtr&lt;nsIFile&gt; mailboxFile;</span>
<a href="#l45.6"></a><span id="l45.6">   rv = descriptor-&gt;GetFile(getter_AddRefs(mailboxFile));</span>
<a href="#l45.7"></a><span id="l45.7">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l45.8"></a><span id="l45.8"> </span>
<a href="#l45.9"></a><span id="l45.9">   descriptor-&gt;SetDepth(aDepth);</span>
<a href="#l45.10"></a><span id="l45.10"> </span>
<a href="#l45.11"></a><span id="l45.11">   mailboxFile-&gt;InitWithFile(aEntry);</span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-  aCollected-&gt;AppendElement(descriptor, false);</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineplus">+  aCollected-&gt;AppendElement(descriptor);</span>
<a href="#l45.14"></a><span id="l45.14"> </span>
<a href="#l45.15"></a><span id="l45.15">   return NS_OK;</span>
<a href="#l45.16"></a><span id="l45.16"> }</span>
<a href="#l45.17"></a><span id="l45.17"> </span>
<a href="#l45.18"></a><span id="l45.18"> nsresult</span>
<a href="#l45.19"></a><span id="l45.19"> nsBeckyMail::CollectMailboxesInFolderListFile(nsIFile *aListFile,</span>
<a href="#l45.20"></a><span id="l45.20">                                               uint32_t aDepth,</span>
<a href="#l45.21"></a><span id="l45.21">                                               nsIMutableArray *aCollected)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/mailnews/import/outlook/src/MapiMessage.cpp</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/mailnews/import/outlook/src/MapiMessage.cpp</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -1175,17 +1175,17 @@ nsresult CMapiMessage::GetAttachments(ns</span>
<a href="#l46.4"></a><span id="l46.4">        it != m_stdattachments.end(); it++) {</span>
<a href="#l46.5"></a><span id="l46.5">     nsCOMPtr&lt;nsIMsgAttachedFile&gt; a(do_CreateInstance(NS_MSGATTACHEDFILE_CONTRACTID, &amp;rv));</span>
<a href="#l46.6"></a><span id="l46.6">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l46.7"></a><span id="l46.7">     a-&gt;SetOrigUrl((*it)-&gt;orig_url);</span>
<a href="#l46.8"></a><span id="l46.8">     a-&gt;SetTmpFile((*it)-&gt;tmp_file);</span>
<a href="#l46.9"></a><span id="l46.9">     a-&gt;SetEncoding(nsDependentCString((*it)-&gt;encoding));</span>
<a href="#l46.10"></a><span id="l46.10">     a-&gt;SetRealName(nsDependentCString((*it)-&gt;real_name));</span>
<a href="#l46.11"></a><span id="l46.11">     a-&gt;SetType(nsDependentCString((*it)-&gt;type));</span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-    attachments-&gt;AppendElement(a, false);</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineplus">+    attachments-&gt;AppendElement(a);</span>
<a href="#l46.14"></a><span id="l46.14">   }</span>
<a href="#l46.15"></a><span id="l46.15">   attachments.forget(aArray);</span>
<a href="#l46.16"></a><span id="l46.16">   return rv;</span>
<a href="#l46.17"></a><span id="l46.17"> }</span>
<a href="#l46.18"></a><span id="l46.18"> </span>
<a href="#l46.19"></a><span id="l46.19"> bool CMapiMessage::GetEmbeddedAttachmentInfo(unsigned int i, nsIURI **uri,</span>
<a href="#l46.20"></a><span id="l46.20">                                              const char **cid,</span>
<a href="#l46.21"></a><span id="l46.21">                                              const char **name) const</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/mailnews/import/outlook/src/nsOutlookCompose.cpp</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/mailnews/import/outlook/src/nsOutlookCompose.cpp</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -293,17 +293,17 @@ nsresult nsOutlookCompose::ComposeTheMes</span>
<a href="#l47.4"></a><span id="l47.4">       if (msg.GetEmbeddedAttachmentInfo(i, &amp;uri, &amp;cid, &amp;name)) {</span>
<a href="#l47.5"></a><span id="l47.5">         if (!embeddedObjects) {</span>
<a href="#l47.6"></a><span id="l47.6">           embeddedObjects = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l47.7"></a><span id="l47.7">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l47.8"></a><span id="l47.8">         }</span>
<a href="#l47.9"></a><span id="l47.9">         nsCOMPtr&lt;nsIMsgEmbeddedImageData&gt; imageData =</span>
<a href="#l47.10"></a><span id="l47.10">           new nsImportEmbeddedImageData(uri, nsDependentCString(cid),</span>
<a href="#l47.11"></a><span id="l47.11">                                      nsDependentCString(name));</span>
<a href="#l47.12"></a><span id="l47.12" class="difflineminus">-        embeddedObjects-&gt;AppendElement(imageData, false);</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineplus">+        embeddedObjects-&gt;AppendElement(imageData);</span>
<a href="#l47.14"></a><span id="l47.14">       }</span>
<a href="#l47.15"></a><span id="l47.15">     }</span>
<a href="#l47.16"></a><span id="l47.16">   }</span>
<a href="#l47.17"></a><span id="l47.17"> </span>
<a href="#l47.18"></a><span id="l47.18">   nsCString bodyA;</span>
<a href="#l47.19"></a><span id="l47.19">   nsMsgI18NConvertFromUnicode(msg.GetBodyCharset(), bodyW, bodyA);</span>
<a href="#l47.20"></a><span id="l47.20"> </span>
<a href="#l47.21"></a><span id="l47.21">   nsCOMPtr&lt;nsIImportService&gt; impService(do_GetService(NS_IMPORTSERVICE_CONTRACTID, &amp;rv));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1" class="difflineminus">--- a/mailnews/import/outlook/src/nsOutlookMail.cpp</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineplus">+++ b/mailnews/import/outlook/src/nsOutlookMail.cpp</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineat">@@ -169,17 +169,17 @@ nsresult nsOutlookMail::GetMailFolders(n</span>
<a href="#l48.4"></a><span id="l48.4">       pID-&gt;SetDepth(pFolder-&gt;GetDepth());</span>
<a href="#l48.5"></a><span id="l48.5">       pID-&gt;SetIdentifier(i);</span>
<a href="#l48.6"></a><span id="l48.6"> </span>
<a href="#l48.7"></a><span id="l48.7">       pFolder-&gt;GetDisplayName(name);</span>
<a href="#l48.8"></a><span id="l48.8">       pID-&gt;SetDisplayName(name.get());</span>
<a href="#l48.9"></a><span id="l48.9"> </span>
<a href="#l48.10"></a><span id="l48.10">       pID-&gt;SetSize(1000);</span>
<a href="#l48.11"></a><span id="l48.11">       nsCOMPtr&lt;nsISupports&gt; pInterface(do_QueryInterface(pID));</span>
<a href="#l48.12"></a><span id="l48.12" class="difflineminus">-      array-&gt;AppendElement(pInterface, false);</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineplus">+      array-&gt;AppendElement(pInterface);</span>
<a href="#l48.14"></a><span id="l48.14">     }</span>
<a href="#l48.15"></a><span id="l48.15">   }</span>
<a href="#l48.16"></a><span id="l48.16">   array.forget(pArray);</span>
<a href="#l48.17"></a><span id="l48.17">   return NS_OK;</span>
<a href="#l48.18"></a><span id="l48.18"> }</span>
<a href="#l48.19"></a><span id="l48.19"> </span>
<a href="#l48.20"></a><span id="l48.20"> bool nsOutlookMail::IsAddressBookNameUnique(nsString&amp; name, nsString&amp; list)</span>
<a href="#l48.21"></a><span id="l48.21"> {</span>
<a href="#l48.22"></a><span id="l48.22" class="difflineat">@@ -268,17 +268,17 @@ nsresult nsOutlookMail::GetAddressBooks(</span>
<a href="#l48.23"></a><span id="l48.23">       rv = impSvc-&gt;CreateNewABDescriptor(getter_AddRefs(pID));</span>
<a href="#l48.24"></a><span id="l48.24">       if (NS_SUCCEEDED(rv)) {</span>
<a href="#l48.25"></a><span id="l48.25">         pID-&gt;SetIdentifier(i);</span>
<a href="#l48.26"></a><span id="l48.26">         pFolder-&gt;GetDisplayName(name);</span>
<a href="#l48.27"></a><span id="l48.27">         MakeAddressBookNameUnique(name, list);</span>
<a href="#l48.28"></a><span id="l48.28">         pID-&gt;SetPreferredName(name);</span>
<a href="#l48.29"></a><span id="l48.29">         pID-&gt;SetSize(100);</span>
<a href="#l48.30"></a><span id="l48.30">         nsCOMPtr&lt;nsISupports&gt; pInterface(do_QueryInterface(pID));</span>
<a href="#l48.31"></a><span id="l48.31" class="difflineminus">-        array-&gt;AppendElement(pInterface, false);</span>
<a href="#l48.32"></a><span id="l48.32" class="difflineplus">+        array-&gt;AppendElement(pInterface);</span>
<a href="#l48.33"></a><span id="l48.33">       }</span>
<a href="#l48.34"></a><span id="l48.34">     }</span>
<a href="#l48.35"></a><span id="l48.35">   }</span>
<a href="#l48.36"></a><span id="l48.36">   array.forget(pArray);</span>
<a href="#l48.37"></a><span id="l48.37">   return NS_OK;</span>
<a href="#l48.38"></a><span id="l48.38"> }</span>
<a href="#l48.39"></a><span id="l48.39"> </span>
<a href="#l48.40"></a><span id="l48.40"> void nsOutlookMail::OpenMessageStore(CMapiFolder *pNextFolder)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1" class="difflineminus">--- a/mailnews/import/text/src/nsTextImport.cpp</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineplus">+++ b/mailnews/import/text/src/nsTextImport.cpp</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineat">@@ -303,17 +303,17 @@ NS_IMETHODIMP ImportAddressImpl::FindAdd</span>
<a href="#l49.4"></a><span id="l49.4">   rv = impSvc-&gt;CreateNewABDescriptor(getter_AddRefs(desc));</span>
<a href="#l49.5"></a><span id="l49.5">   if (NS_SUCCEEDED(rv)) {</span>
<a href="#l49.6"></a><span id="l49.6">     int64_t sz = 0;</span>
<a href="#l49.7"></a><span id="l49.7">     pLoc-&gt;GetFileSize(&amp;sz);</span>
<a href="#l49.8"></a><span id="l49.8">     desc-&gt;SetPreferredName(name);</span>
<a href="#l49.9"></a><span id="l49.9">     desc-&gt;SetSize((uint32_t) sz);</span>
<a href="#l49.10"></a><span id="l49.10">     desc-&gt;SetAbFile(m_fileLoc);</span>
<a href="#l49.11"></a><span id="l49.11">     nsCOMPtr&lt;nsISupports&gt; pInterface(do_QueryInterface(desc));</span>
<a href="#l49.12"></a><span id="l49.12" class="difflineminus">-    array-&gt;AppendElement(pInterface, false);</span>
<a href="#l49.13"></a><span id="l49.13" class="difflineplus">+    array-&gt;AppendElement(pInterface);</span>
<a href="#l49.14"></a><span id="l49.14">   }</span>
<a href="#l49.15"></a><span id="l49.15">   if (NS_FAILED(rv)) {</span>
<a href="#l49.16"></a><span id="l49.16">     IMPORT_LOG0(&quot;*** Error creating address book descriptor for text import\n&quot;);</span>
<a href="#l49.17"></a><span id="l49.17">     return rv;</span>
<a href="#l49.18"></a><span id="l49.18">   }</span>
<a href="#l49.19"></a><span id="l49.19">   array.forget(ppArray);</span>
<a href="#l49.20"></a><span id="l49.20">   return NS_OK;</span>
<a href="#l49.21"></a><span id="l49.21"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/mailnews/import/vcard/src/nsVCardImport.cpp</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/mailnews/import/vcard/src/nsVCardImport.cpp</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -261,17 +261,17 @@ NS_IMETHODIMP ImportVCardAddressImpl::Fi</span>
<a href="#l50.4"></a><span id="l50.4">   rv = impSvc-&gt;CreateNewABDescriptor(getter_AddRefs(desc));</span>
<a href="#l50.5"></a><span id="l50.5">   if (NS_SUCCEEDED(rv)) {</span>
<a href="#l50.6"></a><span id="l50.6">     int64_t sz = 0;</span>
<a href="#l50.7"></a><span id="l50.7">     pLoc-&gt;GetFileSize(&amp;sz);</span>
<a href="#l50.8"></a><span id="l50.8">     desc-&gt;SetPreferredName(name);</span>
<a href="#l50.9"></a><span id="l50.9">     desc-&gt;SetSize((uint32_t) sz);</span>
<a href="#l50.10"></a><span id="l50.10">     desc-&gt;SetAbFile(m_fileLoc);</span>
<a href="#l50.11"></a><span id="l50.11">     nsCOMPtr&lt;nsISupports&gt; pInterface(do_QueryInterface(desc, &amp;rv));</span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-    array-&gt;AppendElement(pInterface, false);</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineplus">+    array-&gt;AppendElement(pInterface);</span>
<a href="#l50.14"></a><span id="l50.14">   }</span>
<a href="#l50.15"></a><span id="l50.15">   if (NS_FAILED(rv)) {</span>
<a href="#l50.16"></a><span id="l50.16">     IMPORT_LOG0(</span>
<a href="#l50.17"></a><span id="l50.17">         &quot;*** Error creating address book descriptor for vCard import\n&quot;);</span>
<a href="#l50.18"></a><span id="l50.18">     return rv;</span>
<a href="#l50.19"></a><span id="l50.19">   }</span>
<a href="#l50.20"></a><span id="l50.20"> </span>
<a href="#l50.21"></a><span id="l50.21">   array.forget(ppArray);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1" class="difflineminus">--- a/mailnews/local/src/nsLocalMailFolder.cpp</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineplus">+++ b/mailnews/local/src/nsLocalMailFolder.cpp</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineat">@@ -611,17 +611,17 @@ NS_IMETHODIMP nsMsgLocalMailFolder::Comp</span>
<a href="#l51.4"></a><span id="l51.4"> </span>
<a href="#l51.5"></a><span id="l51.5">       expungedBytes = 0;</span>
<a href="#l51.6"></a><span id="l51.6">       if (folder)</span>
<a href="#l51.7"></a><span id="l51.7">         rv = folder-&gt;GetExpungedBytes(&amp;expungedBytes);</span>
<a href="#l51.8"></a><span id="l51.8"> </span>
<a href="#l51.9"></a><span id="l51.9">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l51.10"></a><span id="l51.10"> </span>
<a href="#l51.11"></a><span id="l51.11">       if (expungedBytes &gt; 0)</span>
<a href="#l51.12"></a><span id="l51.12" class="difflineminus">-        rv = folderArray-&gt;AppendElement(folder, false);</span>
<a href="#l51.13"></a><span id="l51.13" class="difflineplus">+        rv = folderArray-&gt;AppendElement(folder);</span>
<a href="#l51.14"></a><span id="l51.14">     }</span>
<a href="#l51.15"></a><span id="l51.15">     rv = folderArray-&gt;GetLength(&amp;cnt);</span>
<a href="#l51.16"></a><span id="l51.16">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l51.17"></a><span id="l51.17">     if (cnt == 0)</span>
<a href="#l51.18"></a><span id="l51.18">       return NotifyCompactCompleted();</span>
<a href="#l51.19"></a><span id="l51.19">   }</span>
<a href="#l51.20"></a><span id="l51.20">   nsCOMPtr &lt;nsIMsgFolderCompactor&gt; folderCompactor =  do_CreateInstance(NS_MSGLOCALFOLDERCOMPACTOR_CONTRACTID, &amp;rv);</span>
<a href="#l51.21"></a><span id="l51.21">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l51.22"></a><span id="l51.22" class="difflineat">@@ -1269,17 +1269,17 @@ nsMsgLocalMailFolder::AddMessageDisposit</span>
<a href="#l51.23"></a><span id="l51.23">   nsresult rv = nsMsgDBFolder::AddMessageDispositionState(aMessage, aDispositionFlag);</span>
<a href="#l51.24"></a><span id="l51.24">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l51.25"></a><span id="l51.25"> </span>
<a href="#l51.26"></a><span id="l51.26">   nsCOMPtr&lt;nsIMsgPluggableStore&gt; msgStore;</span>
<a href="#l51.27"></a><span id="l51.27">   rv = GetMsgStore(getter_AddRefs(msgStore));</span>
<a href="#l51.28"></a><span id="l51.28">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l51.29"></a><span id="l51.29">   nsCOMPtr&lt;nsIMutableArray&gt; messages(do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l51.30"></a><span id="l51.30">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l51.31"></a><span id="l51.31" class="difflineminus">-  messages-&gt;AppendElement(aMessage, false);</span>
<a href="#l51.32"></a><span id="l51.32" class="difflineplus">+  messages-&gt;AppendElement(aMessage);</span>
<a href="#l51.33"></a><span id="l51.33">   return msgStore-&gt;ChangeFlags(messages, msgFlag, true);</span>
<a href="#l51.34"></a><span id="l51.34"> }</span>
<a href="#l51.35"></a><span id="l51.35"> </span>
<a href="#l51.36"></a><span id="l51.36"> NS_IMETHODIMP</span>
<a href="#l51.37"></a><span id="l51.37"> nsMsgLocalMailFolder::MarkMessagesRead(nsIArray *aMessages, bool aMarkRead)</span>
<a href="#l51.38"></a><span id="l51.38"> {</span>
<a href="#l51.39"></a><span id="l51.39">   nsresult rv = nsMsgDBFolder::MarkMessagesRead(aMessages, aMarkRead);</span>
<a href="#l51.40"></a><span id="l51.40">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l51.41"></a><span id="l51.41" class="difflineat">@@ -1458,17 +1458,17 @@ nsMsgLocalMailFolder::OnCopyCompleted(ns</span>
<a href="#l51.42"></a><span id="l51.42">   if (NS_SUCCEEDED(rv) &amp;&amp; haveSemaphore)</span>
<a href="#l51.43"></a><span id="l51.43">     ReleaseSemaphore(static_cast&lt;nsIMsgLocalMailFolder*&gt;(this));</span>
<a href="#l51.44"></a><span id="l51.44"> </span>
<a href="#l51.45"></a><span id="l51.45">   if (mCopyState &amp;&amp; !mCopyState-&gt;m_newMsgKeywords.IsEmpty() &amp;&amp;</span>
<a href="#l51.46"></a><span id="l51.46">       mCopyState-&gt;m_newHdr)</span>
<a href="#l51.47"></a><span id="l51.47">   {</span>
<a href="#l51.48"></a><span id="l51.48">     nsCOMPtr&lt;nsIMutableArray&gt; messageArray(do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l51.49"></a><span id="l51.49">     NS_ENSURE_TRUE(messageArray, rv);</span>
<a href="#l51.50"></a><span id="l51.50" class="difflineminus">-    messageArray-&gt;AppendElement(mCopyState-&gt;m_newHdr, false);</span>
<a href="#l51.51"></a><span id="l51.51" class="difflineplus">+    messageArray-&gt;AppendElement(mCopyState-&gt;m_newHdr);</span>
<a href="#l51.52"></a><span id="l51.52">     AddKeywordsToMessages(messageArray, mCopyState-&gt;m_newMsgKeywords);</span>
<a href="#l51.53"></a><span id="l51.53">   }</span>
<a href="#l51.54"></a><span id="l51.54">   if (moveCopySucceeded &amp;&amp; mDatabase)</span>
<a href="#l51.55"></a><span id="l51.55">   {</span>
<a href="#l51.56"></a><span id="l51.56">     mDatabase-&gt;SetSummaryValid(true);</span>
<a href="#l51.57"></a><span id="l51.57">     (void) CloseDBIfFolderNotOpen();</span>
<a href="#l51.58"></a><span id="l51.58">   }</span>
<a href="#l51.59"></a><span id="l51.59"> </span>
<a href="#l51.60"></a><span id="l51.60" class="difflineat">@@ -1739,17 +1739,17 @@ nsMsgLocalMailFolder::CopyFolderAcrossSe</span>
<a href="#l51.61"></a><span id="l51.61"> </span>
<a href="#l51.62"></a><span id="l51.62">   if (messages)</span>
<a href="#l51.63"></a><span id="l51.63">     rv = messages-&gt;HasMoreElements(&amp;hasMoreElements);</span>
<a href="#l51.64"></a><span id="l51.64"> </span>
<a href="#l51.65"></a><span id="l51.65">   while (NS_SUCCEEDED(rv) &amp;&amp; hasMoreElements)</span>
<a href="#l51.66"></a><span id="l51.66">   {</span>
<a href="#l51.67"></a><span id="l51.67">     rv = messages-&gt;GetNext(getter_AddRefs(aSupport));</span>
<a href="#l51.68"></a><span id="l51.68">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l51.69"></a><span id="l51.69" class="difflineminus">-    rv = msgArray-&gt;AppendElement(aSupport, false);</span>
<a href="#l51.70"></a><span id="l51.70" class="difflineplus">+    rv = msgArray-&gt;AppendElement(aSupport);</span>
<a href="#l51.71"></a><span id="l51.71">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l51.72"></a><span id="l51.72">     rv = messages-&gt;HasMoreElements(&amp;hasMoreElements);</span>
<a href="#l51.73"></a><span id="l51.73">   }</span>
<a href="#l51.74"></a><span id="l51.74"> </span>
<a href="#l51.75"></a><span id="l51.75">   uint32_t numMsgs=0;</span>
<a href="#l51.76"></a><span id="l51.76">   msgArray-&gt;GetLength(&amp;numMsgs);</span>
<a href="#l51.77"></a><span id="l51.77"> </span>
<a href="#l51.78"></a><span id="l51.78">   if (numMsgs &gt; 0 )   //if only srcFolder has messages..</span>
<a href="#l51.79"></a><span id="l51.79" class="difflineat">@@ -1914,17 +1914,17 @@ nsMsgLocalMailFolder::CopyFileMessage(ns</span>
<a href="#l51.80"></a><span id="l51.80"> </span>
<a href="#l51.81"></a><span id="l51.81">   aFile-&gt;GetFileSize(&amp;fileSize);</span>
<a href="#l51.82"></a><span id="l51.82">   if (!CheckIfSpaceForCopy(msgWindow, nullptr, fileSupport, false, fileSize))</span>
<a href="#l51.83"></a><span id="l51.83">     return NS_OK;</span>
<a href="#l51.84"></a><span id="l51.84"> </span>
<a href="#l51.85"></a><span id="l51.85">   nsCOMPtr&lt;nsIMutableArray&gt; messages(do_CreateInstance(NS_ARRAY_CONTRACTID));</span>
<a href="#l51.86"></a><span id="l51.86"> </span>
<a href="#l51.87"></a><span id="l51.87">   if (msgToReplace)</span>
<a href="#l51.88"></a><span id="l51.88" class="difflineminus">-    messages-&gt;AppendElement(msgToReplace, false);</span>
<a href="#l51.89"></a><span id="l51.89" class="difflineplus">+    messages-&gt;AppendElement(msgToReplace);</span>
<a href="#l51.90"></a><span id="l51.90"> </span>
<a href="#l51.91"></a><span id="l51.91">   rv = InitCopyState(fileSupport, messages, msgToReplace ? true : false,</span>
<a href="#l51.92"></a><span id="l51.92">                      listener, msgWindow, false, false);</span>
<a href="#l51.93"></a><span id="l51.93">   if (NS_SUCCEEDED(rv))</span>
<a href="#l51.94"></a><span id="l51.94">   {</span>
<a href="#l51.95"></a><span id="l51.95">     if (mCopyState)</span>
<a href="#l51.96"></a><span id="l51.96">       mCopyState-&gt;m_newMsgKeywords = aNewMsgKeywords;</span>
<a href="#l51.97"></a><span id="l51.97"> </span>
<a href="#l51.98"></a><span id="l51.98" class="difflineat">@@ -2425,17 +2425,17 @@ NS_IMETHODIMP nsMsgLocalMailFolder::EndC</span>
<a href="#l51.99"></a><span id="l51.99">           mCopyState-&gt;m_message, true,</span>
<a href="#l51.100"></a><span id="l51.100">           getter_AddRefs(newHdr));</span>
<a href="#l51.101"></a><span id="l51.101">         }</span>
<a href="#l51.102"></a><span id="l51.102">         uint32_t newHdrFlags;</span>
<a href="#l51.103"></a><span id="l51.103">         if (newHdr)</span>
<a href="#l51.104"></a><span id="l51.104">         {</span>
<a href="#l51.105"></a><span id="l51.105">           // turn off offline flag - it's not valid for local mail folders.</span>
<a href="#l51.106"></a><span id="l51.106">           newHdr-&gt;AndFlags(~nsMsgMessageFlags::Offline, &amp;newHdrFlags);</span>
<a href="#l51.107"></a><span id="l51.107" class="difflineminus">-          mCopyState-&gt;m_destMessages-&gt;AppendElement(newHdr, false);</span>
<a href="#l51.108"></a><span id="l51.108" class="difflineplus">+          mCopyState-&gt;m_destMessages-&gt;AppendElement(newHdr);</span>
<a href="#l51.109"></a><span id="l51.109">         }</span>
<a href="#l51.110"></a><span id="l51.110">       }</span>
<a href="#l51.111"></a><span id="l51.111">       // we can do undo with the dest folder db, see bug #198909</span>
<a href="#l51.112"></a><span id="l51.112">       //else</span>
<a href="#l51.113"></a><span id="l51.113">       //  mCopyState-&gt;m_undoMsgTxn = nullptr; //null out the transaction because we can't undo w/o the msg db</span>
<a href="#l51.114"></a><span id="l51.114">     }</span>
<a href="#l51.115"></a><span id="l51.115"> </span>
<a href="#l51.116"></a><span id="l51.116">     // if we plan on allowing undo, (if we have a mCopyState-&gt;m_parseMsgState or not)</span>
<a href="#l51.117"></a><span id="l51.117" class="difflineat">@@ -2496,17 +2496,17 @@ NS_IMETHODIMP nsMsgLocalMailFolder::EndC</span>
<a href="#l51.118"></a><span id="l51.118">         {</span>
<a href="#l51.119"></a><span id="l51.119">           // ** jt - recording the message size for possible undo use; the</span>
<a href="#l51.120"></a><span id="l51.120">           // message size is different for pop3 and imap4 messages</span>
<a href="#l51.121"></a><span id="l51.121">           uint32_t msgSize;</span>
<a href="#l51.122"></a><span id="l51.122">           newHdr-&gt;GetMessageSize(&amp;msgSize);</span>
<a href="#l51.123"></a><span id="l51.123">           localUndoTxn-&gt;AddDstMsgSize(msgSize);</span>
<a href="#l51.124"></a><span id="l51.124">         }</span>
<a href="#l51.125"></a><span id="l51.125"> </span>
<a href="#l51.126"></a><span id="l51.126" class="difflineminus">-        mCopyState-&gt;m_destMessages-&gt;AppendElement(newHdr, false);</span>
<a href="#l51.127"></a><span id="l51.127" class="difflineplus">+        mCopyState-&gt;m_destMessages-&gt;AppendElement(newHdr);</span>
<a href="#l51.128"></a><span id="l51.128">       }</span>
<a href="#l51.129"></a><span id="l51.129">       // msgDb-&gt;SetSummaryValid(true);</span>
<a href="#l51.130"></a><span id="l51.130">       // msgDb-&gt;Commit(nsMsgDBCommitType::kLargeCommit);</span>
<a href="#l51.131"></a><span id="l51.131">     }</span>
<a href="#l51.132"></a><span id="l51.132">     else</span>
<a href="#l51.133"></a><span id="l51.133">       mCopyState-&gt;m_undoMsgTxn = nullptr; //null out the transaction because we can't undo w/o the msg db</span>
<a href="#l51.134"></a><span id="l51.134"> </span>
<a href="#l51.135"></a><span id="l51.135">     mCopyState-&gt;m_parseMsgState-&gt;Clear();</span>
<a href="#l51.136"></a><span id="l51.136" class="difflineat">@@ -2579,17 +2579,17 @@ NS_IMETHODIMP nsMsgLocalMailFolder::EndC</span>
<a href="#l51.137"></a><span id="l51.137">       nsCOMPtr&lt;nsIMsgFolderNotificationService&gt; notifier(do_GetService(NS_MSGNOTIFICATIONSERVICE_CONTRACTID));</span>
<a href="#l51.138"></a><span id="l51.138">       if (notifier)</span>
<a href="#l51.139"></a><span id="l51.139">       {</span>
<a href="#l51.140"></a><span id="l51.140">         notifier-&gt;NotifyMsgAdded(newHdr);</span>
<a href="#l51.141"></a><span id="l51.141">         // We do not appear to trigger classification in this case, so let's</span>
<a href="#l51.142"></a><span id="l51.142">         // paper over the abyss by just sending the classification notification.</span>
<a href="#l51.143"></a><span id="l51.143">         nsCOMPtr &lt;nsIMutableArray&gt; oneHeaderArray =</span>
<a href="#l51.144"></a><span id="l51.144">           do_CreateInstance(NS_ARRAY_CONTRACTID);</span>
<a href="#l51.145"></a><span id="l51.145" class="difflineminus">-        oneHeaderArray-&gt;AppendElement(newHdr, false);</span>
<a href="#l51.146"></a><span id="l51.146" class="difflineplus">+        oneHeaderArray-&gt;AppendElement(newHdr);</span>
<a href="#l51.147"></a><span id="l51.147">         notifier-&gt;NotifyMsgsClassified(oneHeaderArray, false, false);</span>
<a href="#l51.148"></a><span id="l51.148">         // (We do not add the NotReportedClassified processing flag since we</span>
<a href="#l51.149"></a><span id="l51.149">         // just reported it!)</span>
<a href="#l51.150"></a><span id="l51.150">       }</span>
<a href="#l51.151"></a><span id="l51.151">     }</span>
<a href="#l51.152"></a><span id="l51.152">   }</span>
<a href="#l51.153"></a><span id="l51.153">   return rv;</span>
<a href="#l51.154"></a><span id="l51.154"> }</span>
<a href="#l51.155"></a><span id="l51.155" class="difflineat">@@ -3543,17 +3543,17 @@ nsMsgLocalMailFolder::OnMessageClassifie</span>
<a href="#l51.156"></a><span id="l51.156">         nsMsgKey msgKey = mSpamKeysToMove.ElementAt(keyIndex);</span>
<a href="#l51.157"></a><span id="l51.157">         nsMsgProcessingFlagType processingFlags;</span>
<a href="#l51.158"></a><span id="l51.158">         GetProcessingFlags(msgKey, &amp;processingFlags);</span>
<a href="#l51.159"></a><span id="l51.159">         if (folder &amp;&amp; !(processingFlags &amp; nsMsgProcessingFlags::FilterToMove))</span>
<a href="#l51.160"></a><span id="l51.160">         {</span>
<a href="#l51.161"></a><span id="l51.161">           nsCOMPtr&lt;nsIMsgDBHdr&gt; mailHdr;</span>
<a href="#l51.162"></a><span id="l51.162">           rv = GetMessageHeader(msgKey, getter_AddRefs(mailHdr));</span>
<a href="#l51.163"></a><span id="l51.163">           if (NS_SUCCEEDED(rv) &amp;&amp; mailHdr)</span>
<a href="#l51.164"></a><span id="l51.164" class="difflineminus">-            messages-&gt;AppendElement(mailHdr, false);</span>
<a href="#l51.165"></a><span id="l51.165" class="difflineplus">+            messages-&gt;AppendElement(mailHdr);</span>
<a href="#l51.166"></a><span id="l51.166">         }</span>
<a href="#l51.167"></a><span id="l51.167">         else</span>
<a href="#l51.168"></a><span id="l51.168">         {</span>
<a href="#l51.169"></a><span id="l51.169">           // We don't need the processing flag any more.</span>
<a href="#l51.170"></a><span id="l51.170">           AndProcessingFlags(msgKey, ~nsMsgProcessingFlags::FilterToMove);</span>
<a href="#l51.171"></a><span id="l51.171">         }</span>
<a href="#l51.172"></a><span id="l51.172">       }</span>
<a href="#l51.173"></a><span id="l51.173"> </span>
<a href="#l51.174"></a><span id="l51.174" class="difflineat">@@ -3732,17 +3732,17 @@ nsMsgLocalMailFolder::AddMessageBatch(ui</span>
<a href="#l51.175"></a><span id="l51.175">       outFileStream-&gt;Write(aMessages[i], messageLen, &amp;bytesWritten);</span>
<a href="#l51.176"></a><span id="l51.176">       newMailParser-&gt;BufferInput(aMessages[i], messageLen);</span>
<a href="#l51.177"></a><span id="l51.177"> </span>
<a href="#l51.178"></a><span id="l51.178">       msgStore-&gt;FinishNewMessage(outFileStream, newHdr);</span>
<a href="#l51.179"></a><span id="l51.179">       outFileStream-&gt;Close();</span>
<a href="#l51.180"></a><span id="l51.180">       outFileStream = nullptr;</span>
<a href="#l51.181"></a><span id="l51.181">       newMailParser-&gt;OnStopRequest(nullptr, nullptr, NS_OK);</span>
<a href="#l51.182"></a><span id="l51.182">       newMailParser-&gt;EndMsgDownload();</span>
<a href="#l51.183"></a><span id="l51.183" class="difflineminus">-      hdrArray-&gt;AppendElement(newHdr, false);</span>
<a href="#l51.184"></a><span id="l51.184" class="difflineplus">+      hdrArray-&gt;AppendElement(newHdr);</span>
<a href="#l51.185"></a><span id="l51.185">     }</span>
<a href="#l51.186"></a><span id="l51.186">     hdrArray.forget(aHdrArray);</span>
<a href="#l51.187"></a><span id="l51.187">   }</span>
<a href="#l51.188"></a><span id="l51.188">   ReleaseSemaphore(static_cast&lt;nsIMsgLocalMailFolder*&gt;(this));</span>
<a href="#l51.189"></a><span id="l51.189">   return rv;</span>
<a href="#l51.190"></a><span id="l51.190"> }</span>
<a href="#l51.191"></a><span id="l51.191"> </span>
<a href="#l51.192"></a><span id="l51.192"> NS_IMETHODIMP</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1" class="difflineminus">--- a/mailnews/local/src/nsLocalUndoTxn.cpp</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineplus">+++ b/mailnews/local/src/nsLocalUndoTxn.cpp</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineat">@@ -257,19 +257,19 @@ nsLocalMoveCopyMsgTxn::UndoTransactionIn</span>
<a href="#l52.4"></a><span id="l52.4">                                              oldHdr, true,</span>
<a href="#l52.5"></a><span id="l52.5">                                              getter_AddRefs(newHdr));</span>
<a href="#l52.6"></a><span id="l52.6">           NS_ASSERTION(newHdr,</span>
<a href="#l52.7"></a><span id="l52.7">                        &quot;fatal ... cannot create new msg header\n&quot;);</span>
<a href="#l52.8"></a><span id="l52.8">           if (NS_SUCCEEDED(rv) &amp;&amp; newHdr)</span>
<a href="#l52.9"></a><span id="l52.9">           {</span>
<a href="#l52.10"></a><span id="l52.10">             newHdr-&gt;SetStatusOffset(m_srcStatusOffsetArray[i]);</span>
<a href="#l52.11"></a><span id="l52.11">             srcDB-&gt;UndoDelete(newHdr);</span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">-            srcMessages-&gt;AppendElement(newHdr, false);</span>
<a href="#l52.13"></a><span id="l52.13" class="difflineplus">+            srcMessages-&gt;AppendElement(newHdr);</span>
<a href="#l52.14"></a><span id="l52.14">             // (we want to keep these two lists in sync)</span>
<a href="#l52.15"></a><span id="l52.15" class="difflineminus">-            dstMessages-&gt;AppendElement(oldHdr, false);</span>
<a href="#l52.16"></a><span id="l52.16" class="difflineplus">+            dstMessages-&gt;AppendElement(oldHdr);</span>
<a href="#l52.17"></a><span id="l52.17">           }</span>
<a href="#l52.18"></a><span id="l52.18">         }</span>
<a href="#l52.19"></a><span id="l52.19">       }</span>
<a href="#l52.20"></a><span id="l52.20"> </span>
<a href="#l52.21"></a><span id="l52.21">       nsCOMPtr&lt;nsIMsgFolderNotificationService&gt;</span>
<a href="#l52.22"></a><span id="l52.22">         notifier(do_GetService(NS_MSGNOTIFICATIONSERVICE_CONTRACTID));</span>
<a href="#l52.23"></a><span id="l52.23">       if (notifier)</span>
<a href="#l52.24"></a><span id="l52.24">       {</span>
<a href="#l52.25"></a><span id="l52.25" class="difflineat">@@ -296,17 +296,17 @@ nsLocalMoveCopyMsgTxn::UndoTransactionIn</span>
<a href="#l52.26"></a><span id="l52.26">         dstDB-&gt;ContainsKey(m_dstKeyArray[i], &amp;hasKey);</span>
<a href="#l52.27"></a><span id="l52.27">         nsCOMPtr&lt;nsIMsgDBHdr&gt; dstHdr;</span>
<a href="#l52.28"></a><span id="l52.28">         if (hasKey)</span>
<a href="#l52.29"></a><span id="l52.29">           dstDB-&gt;GetMsgHdrForKey(m_dstKeyArray[i], getter_AddRefs(dstHdr));</span>
<a href="#l52.30"></a><span id="l52.30">         if (dstHdr)</span>
<a href="#l52.31"></a><span id="l52.31">         {</span>
<a href="#l52.32"></a><span id="l52.32">           nsCString messageId;</span>
<a href="#l52.33"></a><span id="l52.33">           dstHdr-&gt;GetMessageId(getter_Copies(messageId));</span>
<a href="#l52.34"></a><span id="l52.34" class="difflineminus">-          dstMessages-&gt;AppendElement(dstHdr, false);</span>
<a href="#l52.35"></a><span id="l52.35" class="difflineplus">+          dstMessages-&gt;AppendElement(dstHdr);</span>
<a href="#l52.36"></a><span id="l52.36">           m_copiedMsgIds.AppendElement(messageId);</span>
<a href="#l52.37"></a><span id="l52.37">         }</span>
<a href="#l52.38"></a><span id="l52.38">         else</span>
<a href="#l52.39"></a><span id="l52.39">         {</span>
<a href="#l52.40"></a><span id="l52.40">           NS_WARNING(&quot;Cannot get old msg header&quot;);</span>
<a href="#l52.41"></a><span id="l52.41">         }</span>
<a href="#l52.42"></a><span id="l52.42">       }</span>
<a href="#l52.43"></a><span id="l52.43">       if (m_copiedMsgIds.Length())</span>
<a href="#l52.44"></a><span id="l52.44" class="difflineat">@@ -362,17 +362,17 @@ nsLocalMoveCopyMsgTxn::RedoTransaction()</span>
<a href="#l52.45"></a><span id="l52.45">   {</span>
<a href="#l52.46"></a><span id="l52.46">     rv = srcDB-&gt;GetMsgHdrForKey(m_srcKeyArray[i],</span>
<a href="#l52.47"></a><span id="l52.47">                                 getter_AddRefs(oldHdr));</span>
<a href="#l52.48"></a><span id="l52.48">     NS_ASSERTION(oldHdr, &quot;fatal ... cannot get old msg header\n&quot;);</span>
<a href="#l52.49"></a><span id="l52.49"> </span>
<a href="#l52.50"></a><span id="l52.50">     if (NS_SUCCEEDED(rv) &amp;&amp; oldHdr)</span>
<a href="#l52.51"></a><span id="l52.51">     {</span>
<a href="#l52.52"></a><span id="l52.52">       msgSupports =do_QueryInterface(oldHdr);</span>
<a href="#l52.53"></a><span id="l52.53" class="difflineminus">-      srcMessages-&gt;AppendElement(msgSupports, false);</span>
<a href="#l52.54"></a><span id="l52.54" class="difflineplus">+      srcMessages-&gt;AppendElement(msgSupports);</span>
<a href="#l52.55"></a><span id="l52.55"> </span>
<a href="#l52.56"></a><span id="l52.56">       if (m_canUndelete)</span>
<a href="#l52.57"></a><span id="l52.57">       {</span>
<a href="#l52.58"></a><span id="l52.58">       rv = dstDB-&gt;CopyHdrFromExistingHdr(m_dstKeyArray[i],</span>
<a href="#l52.59"></a><span id="l52.59">                                          oldHdr, true,</span>
<a href="#l52.60"></a><span id="l52.60">                                          getter_AddRefs(newHdr));</span>
<a href="#l52.61"></a><span id="l52.61">       NS_ASSERTION(newHdr, &quot;fatal ... cannot get new msg header\n&quot;);</span>
<a href="#l52.62"></a><span id="l52.62">       if (NS_SUCCEEDED(rv) &amp;&amp; newHdr)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/mailnews/local/src/nsMsgMaildirStore.cpp</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/mailnews/local/src/nsMsgMaildirStore.cpp</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -1088,17 +1088,17 @@ nsMsgMaildirStore::CopyMessages(bool aIs</span>
<a href="#l53.4"></a><span id="l53.4">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l53.5"></a><span id="l53.5"> </span>
<a href="#l53.6"></a><span id="l53.6">     nsCOMPtr&lt;nsIMsgDBHdr&gt; destHdr;</span>
<a href="#l53.7"></a><span id="l53.7">     if (destDB)</span>
<a href="#l53.8"></a><span id="l53.8">     {</span>
<a href="#l53.9"></a><span id="l53.9">       rv = destDB-&gt;CopyHdrFromExistingHdr(nsMsgKey_None, srcHdr, true, getter_AddRefs(destHdr));</span>
<a href="#l53.10"></a><span id="l53.10">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l53.11"></a><span id="l53.11">       destHdr-&gt;SetStringProperty(&quot;storeToken&quot;, fileName.get());</span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-      dstHdrs-&gt;AppendElement(destHdr, false);</span>
<a href="#l53.13"></a><span id="l53.13" class="difflineplus">+      dstHdrs-&gt;AppendElement(destHdr);</span>
<a href="#l53.14"></a><span id="l53.14">       nsMsgKey dstKey;</span>
<a href="#l53.15"></a><span id="l53.15">       destHdr-&gt;GetMessageKey(&amp;dstKey);</span>
<a href="#l53.16"></a><span id="l53.16">       msgTxn-&gt;AddDstKey(dstKey);</span>
<a href="#l53.17"></a><span id="l53.17">       if (aListener)</span>
<a href="#l53.18"></a><span id="l53.18">         aListener-&gt;SetMessageKey(dstKey);</span>
<a href="#l53.19"></a><span id="l53.19">     }</span>
<a href="#l53.20"></a><span id="l53.20">   }</span>
<a href="#l53.21"></a><span id="l53.21">   nsCOMPtr&lt;nsIMsgFolderNotificationService&gt; notifier(do_GetService(NS_MSGNOTIFICATIONSERVICE_CONTRACTID));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1" class="difflineminus">--- a/mailnews/local/src/nsParseMailbox.cpp</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineplus">+++ b/mailnews/local/src/nsParseMailbox.cpp</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineat">@@ -2095,17 +2095,17 @@ NS_IMETHODIMP nsParseNewMailState::Apply</span>
<a href="#l54.4"></a><span id="l54.4">         case nsMsgFilterAction::CopyToFolder:</span>
<a href="#l54.5"></a><span id="l54.5">         {</span>
<a href="#l54.6"></a><span id="l54.6">           nsCString uri;</span>
<a href="#l54.7"></a><span id="l54.7">           rv = m_rootFolder-&gt;GetURI(uri);</span>
<a href="#l54.8"></a><span id="l54.8"> </span>
<a href="#l54.9"></a><span id="l54.9">           if (!actionTargetFolderUri.IsEmpty() &amp;&amp; !actionTargetFolderUri.Equals(uri))</span>
<a href="#l54.10"></a><span id="l54.10">           {</span>
<a href="#l54.11"></a><span id="l54.11">             nsCOMPtr&lt;nsIMutableArray&gt; messageArray(do_CreateInstance(NS_ARRAY_CONTRACTID));</span>
<a href="#l54.12"></a><span id="l54.12" class="difflineminus">-            messageArray-&gt;AppendElement(msgHdr, false);</span>
<a href="#l54.13"></a><span id="l54.13" class="difflineplus">+            messageArray-&gt;AppendElement(msgHdr);</span>
<a href="#l54.14"></a><span id="l54.14"> </span>
<a href="#l54.15"></a><span id="l54.15">             nsCOMPtr&lt;nsIMsgFolder&gt; dstFolder;</span>
<a href="#l54.16"></a><span id="l54.16">             nsCOMPtr&lt;nsIMsgCopyService&gt; copyService;</span>
<a href="#l54.17"></a><span id="l54.17">             rv = GetExistingFolder(actionTargetFolderUri,</span>
<a href="#l54.18"></a><span id="l54.18">                                    getter_AddRefs(dstFolder));</span>
<a href="#l54.19"></a><span id="l54.19">             if (NS_SUCCEEDED(rv)) {</span>
<a href="#l54.20"></a><span id="l54.20">               copyService = do_GetService(NS_MSGCOPYSERVICE_CONTRACTID, &amp;rv);</span>
<a href="#l54.21"></a><span id="l54.21">             }</span>
<a href="#l54.22"></a><span id="l54.22" class="difflineat">@@ -2143,31 +2143,31 @@ NS_IMETHODIMP nsParseNewMailState::Apply</span>
<a href="#l54.23"></a><span id="l54.23">         msgHdr-&gt;OrFlags(nsMsgMessageFlags::Ignored, &amp;newFlags);</span>
<a href="#l54.24"></a><span id="l54.24">         break;</span>
<a href="#l54.25"></a><span id="l54.25">       case nsMsgFilterAction::WatchThread:</span>
<a href="#l54.26"></a><span id="l54.26">         msgHdr-&gt;OrFlags(nsMsgMessageFlags::Watched, &amp;newFlags);</span>
<a href="#l54.27"></a><span id="l54.27">         break;</span>
<a href="#l54.28"></a><span id="l54.28">       case nsMsgFilterAction::MarkFlagged:</span>
<a href="#l54.29"></a><span id="l54.29">         {</span>
<a href="#l54.30"></a><span id="l54.30">           nsCOMPtr&lt;nsIMutableArray&gt; messageArray(do_CreateInstance(NS_ARRAY_CONTRACTID));</span>
<a href="#l54.31"></a><span id="l54.31" class="difflineminus">-          messageArray-&gt;AppendElement(msgHdr, false);</span>
<a href="#l54.32"></a><span id="l54.32" class="difflineplus">+          messageArray-&gt;AppendElement(msgHdr);</span>
<a href="#l54.33"></a><span id="l54.33">           m_downloadFolder-&gt;MarkMessagesFlagged(messageArray, true);</span>
<a href="#l54.34"></a><span id="l54.34">         }</span>
<a href="#l54.35"></a><span id="l54.35">         break;</span>
<a href="#l54.36"></a><span id="l54.36">       case nsMsgFilterAction::ChangePriority:</span>
<a href="#l54.37"></a><span id="l54.37">         nsMsgPriorityValue filterPriority;</span>
<a href="#l54.38"></a><span id="l54.38">         filterAction-&gt;GetPriority(&amp;filterPriority);</span>
<a href="#l54.39"></a><span id="l54.39">         msgHdr-&gt;SetPriority(filterPriority);</span>
<a href="#l54.40"></a><span id="l54.40">         break;</span>
<a href="#l54.41"></a><span id="l54.41">       case nsMsgFilterAction::AddTag:</span>
<a href="#l54.42"></a><span id="l54.42">       {</span>
<a href="#l54.43"></a><span id="l54.43">         nsCString keyword;</span>
<a href="#l54.44"></a><span id="l54.44">         filterAction-&gt;GetStrValue(keyword);</span>
<a href="#l54.45"></a><span id="l54.45">         nsCOMPtr&lt;nsIMutableArray&gt; messageArray(do_CreateInstance(NS_ARRAY_CONTRACTID));</span>
<a href="#l54.46"></a><span id="l54.46" class="difflineminus">-        messageArray-&gt;AppendElement(msgHdr, false);</span>
<a href="#l54.47"></a><span id="l54.47" class="difflineplus">+        messageArray-&gt;AppendElement(msgHdr);</span>
<a href="#l54.48"></a><span id="l54.48">         m_downloadFolder-&gt;AddKeywordsToMessages(messageArray, keyword);</span>
<a href="#l54.49"></a><span id="l54.49">         break;</span>
<a href="#l54.50"></a><span id="l54.50">       }</span>
<a href="#l54.51"></a><span id="l54.51">       case nsMsgFilterAction::Label:</span>
<a href="#l54.52"></a><span id="l54.52">         nsMsgLabelValue filterLabel;</span>
<a href="#l54.53"></a><span id="l54.53">         filterAction-&gt;GetLabel(&amp;filterLabel);</span>
<a href="#l54.54"></a><span id="l54.54">         nsMsgKey msgKey;</span>
<a href="#l54.55"></a><span id="l54.55">         msgHdr-&gt;GetMessageKey(&amp;msgKey);</span>
<a href="#l54.56"></a><span id="l54.56" class="difflineat">@@ -2211,17 +2211,17 @@ NS_IMETHODIMP nsParseNewMailState::Apply</span>
<a href="#l54.57"></a><span id="l54.57">           nsCOMPtr &lt;nsIMsgFolder&gt; downloadFolder;</span>
<a href="#l54.58"></a><span id="l54.58">           msgHdr-&gt;GetFolder(getter_AddRefs(downloadFolder));</span>
<a href="#l54.59"></a><span id="l54.59">           nsCOMPtr &lt;nsIMsgLocalMailFolder&gt; localFolder = do_QueryInterface(downloadFolder);</span>
<a href="#l54.60"></a><span id="l54.60">           msgHdr-&gt;GetFlags(&amp;flags);</span>
<a href="#l54.61"></a><span id="l54.61">           if (localFolder)</span>
<a href="#l54.62"></a><span id="l54.62">           {</span>
<a href="#l54.63"></a><span id="l54.63">             nsCOMPtr&lt;nsIMutableArray&gt; messages = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l54.64"></a><span id="l54.64">             NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l54.65"></a><span id="l54.65" class="difflineminus">-            messages-&gt;AppendElement(msgHdr, false);</span>
<a href="#l54.66"></a><span id="l54.66" class="difflineplus">+            messages-&gt;AppendElement(msgHdr);</span>
<a href="#l54.67"></a><span id="l54.67">             // This action ignores the deleteMailLeftOnServer preference</span>
<a href="#l54.68"></a><span id="l54.68">             localFolder-&gt;MarkMsgsOnPop3Server(messages, POP3_FORCE_DEL);</span>
<a href="#l54.69"></a><span id="l54.69"> </span>
<a href="#l54.70"></a><span id="l54.70">             // If this is just a header, throw it away. It's useless now</span>
<a href="#l54.71"></a><span id="l54.71">             // that the server copy is being deleted.</span>
<a href="#l54.72"></a><span id="l54.72">             if (flags &amp; nsMsgMessageFlags::Partial)</span>
<a href="#l54.73"></a><span id="l54.73">             {</span>
<a href="#l54.74"></a><span id="l54.74">               m_msgMovedByFilter = true;</span>
<a href="#l54.75"></a><span id="l54.75" class="difflineat">@@ -2236,17 +2236,17 @@ NS_IMETHODIMP nsParseNewMailState::Apply</span>
<a href="#l54.76"></a><span id="l54.76">           nsCOMPtr &lt;nsIMsgFolder&gt; downloadFolder;</span>
<a href="#l54.77"></a><span id="l54.77">           msgHdr-&gt;GetFolder(getter_AddRefs(downloadFolder));</span>
<a href="#l54.78"></a><span id="l54.78">           nsCOMPtr &lt;nsIMsgLocalMailFolder&gt; localFolder = do_QueryInterface(downloadFolder);</span>
<a href="#l54.79"></a><span id="l54.79">           msgHdr-&gt;GetFlags(&amp;flags);</span>
<a href="#l54.80"></a><span id="l54.80">           if (localFolder &amp;&amp; (flags &amp; nsMsgMessageFlags::Partial))</span>
<a href="#l54.81"></a><span id="l54.81">           {</span>
<a href="#l54.82"></a><span id="l54.82">             nsCOMPtr&lt;nsIMutableArray&gt; messages = do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv);</span>
<a href="#l54.83"></a><span id="l54.83">             NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l54.84"></a><span id="l54.84" class="difflineminus">-            messages-&gt;AppendElement(msgHdr, false);</span>
<a href="#l54.85"></a><span id="l54.85" class="difflineplus">+            messages-&gt;AppendElement(msgHdr);</span>
<a href="#l54.86"></a><span id="l54.86">             localFolder-&gt;MarkMsgsOnPop3Server(messages, POP3_FETCH_BODY);</span>
<a href="#l54.87"></a><span id="l54.87">             // Don't add this header to the DB, we're going to replace it</span>
<a href="#l54.88"></a><span id="l54.88">             // with the full message.</span>
<a href="#l54.89"></a><span id="l54.89">             m_msgMovedByFilter = true;</span>
<a href="#l54.90"></a><span id="l54.90">             msgIsNew = false;</span>
<a href="#l54.91"></a><span id="l54.91">             // Don't do anything else in this filter, wait until we</span>
<a href="#l54.92"></a><span id="l54.92">             // have the full message.</span>
<a href="#l54.93"></a><span id="l54.93">             *applyMore = false;</span>
<a href="#l54.94"></a><span id="l54.94" class="difflineat">@@ -2269,17 +2269,17 @@ NS_IMETHODIMP nsParseNewMailState::Apply</span>
<a href="#l54.95"></a><span id="l54.95"> </span>
<a href="#l54.96"></a><span id="l54.96">         nsAutoCString value;</span>
<a href="#l54.97"></a><span id="l54.97">         filterAction-&gt;GetStrValue(value);</span>
<a href="#l54.98"></a><span id="l54.98"> </span>
<a href="#l54.99"></a><span id="l54.99">         nsCOMPtr&lt;nsIMutableArray&gt; messageArray(</span>
<a href="#l54.100"></a><span id="l54.100">             do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l54.101"></a><span id="l54.101">         NS_ENSURE_TRUE(messageArray, rv);</span>
<a href="#l54.102"></a><span id="l54.102">         if (NS_SUCCEEDED(rv))</span>
<a href="#l54.103"></a><span id="l54.103" class="difflineminus">-          rv = messageArray-&gt;AppendElement(msgHdr, false);</span>
<a href="#l54.104"></a><span id="l54.104" class="difflineplus">+          rv = messageArray-&gt;AppendElement(msgHdr);</span>
<a href="#l54.105"></a><span id="l54.105"> </span>
<a href="#l54.106"></a><span id="l54.106"> </span>
<a href="#l54.107"></a><span id="l54.107">         if (NS_SUCCEEDED(rv))</span>
<a href="#l54.108"></a><span id="l54.108">           rv = customAction-&gt;Apply(messageArray, value, nullptr,</span>
<a href="#l54.109"></a><span id="l54.109">                                    nsMsgFilterType::InboxRule, msgWindow);</span>
<a href="#l54.110"></a><span id="l54.110">         if (NS_FAILED(rv)) {</span>
<a href="#l54.111"></a><span id="l54.111">             // XXX: Invoke MSG_LOG_TO_CONSOLE once bug 1135265 lands.</span>
<a href="#l54.112"></a><span id="l54.112">             if (loggingEnabled)</span>
<a href="#l54.113"></a><span id="l54.113" class="difflineat">@@ -2366,17 +2366,17 @@ nsresult nsParseNewMailState::ApplyForwa</span>
<a href="#l54.114"></a><span id="l54.114">   m_replyTemplateUri.Clear();</span>
<a href="#l54.115"></a><span id="l54.115">   m_msgToForwardOrReply = nullptr;</span>
<a href="#l54.116"></a><span id="l54.116">   return rv;</span>
<a href="#l54.117"></a><span id="l54.117"> }</span>
<a href="#l54.118"></a><span id="l54.118"> </span>
<a href="#l54.119"></a><span id="l54.119"> void nsParseNewMailState::MarkFilteredMessageRead(nsIMsgDBHdr *msgHdr)</span>
<a href="#l54.120"></a><span id="l54.120"> {</span>
<a href="#l54.121"></a><span id="l54.121">   nsCOMPtr&lt;nsIMutableArray&gt; messageArray(do_CreateInstance(NS_ARRAY_CONTRACTID));</span>
<a href="#l54.122"></a><span id="l54.122" class="difflineminus">-  messageArray-&gt;AppendElement(msgHdr, false);</span>
<a href="#l54.123"></a><span id="l54.123" class="difflineplus">+  messageArray-&gt;AppendElement(msgHdr);</span>
<a href="#l54.124"></a><span id="l54.124">   m_downloadFolder-&gt;MarkMessagesRead(messageArray, true);</span>
<a href="#l54.125"></a><span id="l54.125"> }</span>
<a href="#l54.126"></a><span id="l54.126"> </span>
<a href="#l54.127"></a><span id="l54.127"> void nsParseNewMailState::MarkFilteredMessageUnread(nsIMsgDBHdr *msgHdr)</span>
<a href="#l54.128"></a><span id="l54.128"> {</span>
<a href="#l54.129"></a><span id="l54.129">   uint32_t newFlags;</span>
<a href="#l54.130"></a><span id="l54.130">   if (m_mailDB)</span>
<a href="#l54.131"></a><span id="l54.131">   {</span>
<a href="#l54.132"></a><span id="l54.132" class="difflineat">@@ -2384,17 +2384,17 @@ void nsParseNewMailState::MarkFilteredMe</span>
<a href="#l54.133"></a><span id="l54.133">     msgHdr-&gt;GetMessageKey(&amp;msgKey);</span>
<a href="#l54.134"></a><span id="l54.134">     m_mailDB-&gt;AddToNewList(msgKey);</span>
<a href="#l54.135"></a><span id="l54.135">   }</span>
<a href="#l54.136"></a><span id="l54.136">   else</span>
<a href="#l54.137"></a><span id="l54.137">   {</span>
<a href="#l54.138"></a><span id="l54.138">     msgHdr-&gt;OrFlags(nsMsgMessageFlags::New, &amp;newFlags);</span>
<a href="#l54.139"></a><span id="l54.139">   }</span>
<a href="#l54.140"></a><span id="l54.140">   nsCOMPtr&lt;nsIMutableArray&gt; messageArray(do_CreateInstance(NS_ARRAY_CONTRACTID));</span>
<a href="#l54.141"></a><span id="l54.141" class="difflineminus">-  messageArray-&gt;AppendElement(msgHdr, false);</span>
<a href="#l54.142"></a><span id="l54.142" class="difflineplus">+  messageArray-&gt;AppendElement(msgHdr);</span>
<a href="#l54.143"></a><span id="l54.143">   m_downloadFolder-&gt;MarkMessagesRead(messageArray, false);</span>
<a href="#l54.144"></a><span id="l54.144"> }</span>
<a href="#l54.145"></a><span id="l54.145"> </span>
<a href="#l54.146"></a><span id="l54.146"> nsresult nsParseNewMailState::EndMsgDownload()</span>
<a href="#l54.147"></a><span id="l54.147"> {</span>
<a href="#l54.148"></a><span id="l54.148">   if (m_moveCoalescer)</span>
<a href="#l54.149"></a><span id="l54.149">     m_moveCoalescer-&gt;PlaybackMoves();</span>
<a href="#l54.150"></a><span id="l54.150"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1" class="difflineminus">--- a/mailnews/news/src/nsNNTPNewsgroupList.cpp</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineplus">+++ b/mailnews/news/src/nsNNTPNewsgroupList.cpp</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineat">@@ -689,17 +689,17 @@ NS_IMETHODIMP nsNNTPNewsgroupList::Apply</span>
<a href="#l55.4"></a><span id="l55.4">           m_newMsgHdr-&gt;SetPriority(filterPriority);</span>
<a href="#l55.5"></a><span id="l55.5">         }</span>
<a href="#l55.6"></a><span id="l55.6">         break;</span>
<a href="#l55.7"></a><span id="l55.7">       case nsMsgFilterAction::AddTag:</span>
<a href="#l55.8"></a><span id="l55.8">       {</span>
<a href="#l55.9"></a><span id="l55.9">         nsCString keyword;</span>
<a href="#l55.10"></a><span id="l55.10">         filterAction-&gt;GetStrValue(keyword);</span>
<a href="#l55.11"></a><span id="l55.11">         nsCOMPtr&lt;nsIMutableArray&gt; messageArray(do_CreateInstance(NS_ARRAY_CONTRACTID));</span>
<a href="#l55.12"></a><span id="l55.12" class="difflineminus">-        messageArray-&gt;AppendElement(m_newMsgHdr, false);</span>
<a href="#l55.13"></a><span id="l55.13" class="difflineplus">+        messageArray-&gt;AppendElement(m_newMsgHdr);</span>
<a href="#l55.14"></a><span id="l55.14">         nsCOMPtr &lt;nsIMsgFolder&gt; folder = do_QueryInterface(m_newsFolder, &amp;rv);</span>
<a href="#l55.15"></a><span id="l55.15">         if (folder)</span>
<a href="#l55.16"></a><span id="l55.16">           folder-&gt;AddKeywordsToMessages(messageArray, keyword);</span>
<a href="#l55.17"></a><span id="l55.17">         break;</span>
<a href="#l55.18"></a><span id="l55.18">       }</span>
<a href="#l55.19"></a><span id="l55.19">       case nsMsgFilterAction::Label:</span>
<a href="#l55.20"></a><span id="l55.20">         {</span>
<a href="#l55.21"></a><span id="l55.21">           nsMsgLabelValue filterLabel;</span>
<a href="#l55.22"></a><span id="l55.22" class="difflineat">@@ -724,17 +724,17 @@ NS_IMETHODIMP nsNNTPNewsgroupList::Apply</span>
<a href="#l55.23"></a><span id="l55.23">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l55.24"></a><span id="l55.24"> </span>
<a href="#l55.25"></a><span id="l55.25">         nsAutoCString value;</span>
<a href="#l55.26"></a><span id="l55.26">         filterAction-&gt;GetStrValue(value);</span>
<a href="#l55.27"></a><span id="l55.27"> </span>
<a href="#l55.28"></a><span id="l55.28">         nsCOMPtr&lt;nsIMutableArray&gt; messageArray(</span>
<a href="#l55.29"></a><span id="l55.29">             do_CreateInstance(NS_ARRAY_CONTRACTID, &amp;rv));</span>
<a href="#l55.30"></a><span id="l55.30">         NS_ENSURE_TRUE(messageArray, rv);</span>
<a href="#l55.31"></a><span id="l55.31" class="difflineminus">-        messageArray-&gt;AppendElement(m_newMsgHdr, false);</span>
<a href="#l55.32"></a><span id="l55.32" class="difflineplus">+        messageArray-&gt;AppendElement(m_newMsgHdr);</span>
<a href="#l55.33"></a><span id="l55.33"> </span>
<a href="#l55.34"></a><span id="l55.34">         customAction-&gt;Apply(messageArray, value, nullptr,</span>
<a href="#l55.35"></a><span id="l55.35">                             nsMsgFilterType::NewsRule, aMsgWindow);</span>
<a href="#l55.36"></a><span id="l55.36">       }</span>
<a href="#l55.37"></a><span id="l55.37">       break;</span>
<a href="#l55.38"></a><span id="l55.38"> </span>
<a href="#l55.39"></a><span id="l55.39">       default:</span>
<a href="#l55.40"></a><span id="l55.40">         NS_ERROR(&quot;unexpected action&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1" class="difflineminus">--- a/mailnews/news/src/nsNewsFolder.cpp</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineplus">+++ b/mailnews/news/src/nsNewsFolder.cpp</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineat">@@ -1532,17 +1532,17 @@ NS_IMETHODIMP nsMsgNewsFolder::RemoveMes</span>
<a href="#l56.4"></a><span id="l56.4">   nsCOMPtr&lt;nsIMsgFolderNotificationService&gt; notifier(do_GetService(NS_MSGNOTIFICATIONSERVICE_CONTRACTID));</span>
<a href="#l56.5"></a><span id="l56.5">   if (notifier)</span>
<a href="#l56.6"></a><span id="l56.6">   {</span>
<a href="#l56.7"></a><span id="l56.7">     nsCOMPtr&lt;nsIMsgDBHdr&gt; msgHdr;</span>
<a href="#l56.8"></a><span id="l56.8">     rv = mDatabase-&gt;GetMsgHdrForKey(key, getter_AddRefs(msgHdr));</span>
<a href="#l56.9"></a><span id="l56.9">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l56.10"></a><span id="l56.10"> </span>
<a href="#l56.11"></a><span id="l56.11">     nsCOMPtr&lt;nsIMutableArray&gt; msgHdrs(do_CreateInstance(NS_ARRAY_CONTRACTID));</span>
<a href="#l56.12"></a><span id="l56.12" class="difflineminus">-    msgHdrs-&gt;AppendElement(msgHdr, false);</span>
<a href="#l56.13"></a><span id="l56.13" class="difflineplus">+    msgHdrs-&gt;AppendElement(msgHdr);</span>
<a href="#l56.14"></a><span id="l56.14"> </span>
<a href="#l56.15"></a><span id="l56.15">     notifier-&gt;NotifyMsgsDeleted(msgHdrs);</span>
<a href="#l56.16"></a><span id="l56.16">   }</span>
<a href="#l56.17"></a><span id="l56.17">   return mDatabase-&gt;DeleteMessage(key, nullptr, false);</span>
<a href="#l56.18"></a><span id="l56.18"> }</span>
<a href="#l56.19"></a><span id="l56.19"> </span>
<a href="#l56.20"></a><span id="l56.20"> NS_IMETHODIMP nsMsgNewsFolder::RemoveMessages(nsTArray&lt;nsMsgKey&gt; &amp;aMsgKeys)</span>
<a href="#l56.21"></a><span id="l56.21"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l57.1"></a><span id="l57.1" class="difflineminus">--- a/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp</span>
<a href="#l57.2"></a><span id="l57.2" class="difflineplus">+++ b/suite/profile/migration/src/nsNetscapeProfileMigratorBase.cpp</span>
<a href="#l57.3"></a><span id="l57.3" class="difflineat">@@ -385,23 +385,23 @@ nsNetscapeProfileMigratorBase::GetProfil</span>
<a href="#l57.4"></a><span id="l57.4">       rv = rootDir-&gt;SetPersistentDescriptor(filePath);</span>
<a href="#l57.5"></a><span id="l57.5"> </span>
<a href="#l57.6"></a><span id="l57.6">     if (NS_FAILED(rv)) continue;</span>
<a href="#l57.7"></a><span id="l57.7"> </span>
<a href="#l57.8"></a><span id="l57.8">     bool exists;</span>
<a href="#l57.9"></a><span id="l57.9">     rootDir-&gt;Exists(&amp;exists);</span>
<a href="#l57.10"></a><span id="l57.10"> </span>
<a href="#l57.11"></a><span id="l57.11">     if (exists) {</span>
<a href="#l57.12"></a><span id="l57.12" class="difflineminus">-      aProfileLocations-&gt;AppendElement(rootDir, false);</span>
<a href="#l57.13"></a><span id="l57.13" class="difflineplus">+      aProfileLocations-&gt;AppendElement(rootDir);</span>
<a href="#l57.14"></a><span id="l57.14"> </span>
<a href="#l57.15"></a><span id="l57.15">       nsCOMPtr&lt;nsISupportsString&gt; profileNameString(</span>
<a href="#l57.16"></a><span id="l57.16">         do_CreateInstance(&quot;@mozilla.org/supports-string;1&quot;));</span>
<a href="#l57.17"></a><span id="l57.17"> </span>
<a href="#l57.18"></a><span id="l57.18">       profileNameString-&gt;SetData(NS_ConvertUTF8toUTF16(buffer));</span>
<a href="#l57.19"></a><span id="l57.19" class="difflineminus">-      aProfileNames-&gt;AppendElement(profileNameString, false);</span>
<a href="#l57.20"></a><span id="l57.20" class="difflineplus">+      aProfileNames-&gt;AppendElement(profileNameString);</span>
<a href="#l57.21"></a><span id="l57.21">     }</span>
<a href="#l57.22"></a><span id="l57.22">   }</span>
<a href="#l57.23"></a><span id="l57.23">   return NS_OK;</span>
<a href="#l57.24"></a><span id="l57.24"> }</span>
<a href="#l57.25"></a><span id="l57.25"> </span>
<a href="#l57.26"></a><span id="l57.26"> nsresult</span>
<a href="#l57.27"></a><span id="l57.27"> nsNetscapeProfileMigratorBase::CopyFile(const char* aSourceFileName,</span>
<a href="#l57.28"></a><span id="l57.28">                                         const char* aTargetFileName)</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

