<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 12578:05d059079026fc51aa98709381607b24b237497c</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 05d059079026fc51aa98709381607b24b237497c" />
<meta property="og:url" content="/comm-central/rev/05d059079026fc51aa98709381607b24b237497c" />
<meta property="og:description" content="Fix bug 855067 - Localized Lightning builds using Thunderbird Infrastructure. r=Standard8" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 05d059079026fc51aa98709381607b24b237497c 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/05d059079026fc51aa98709381607b24b237497c">shortlog</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/05d059079026fc51aa98709381607b24b237497c">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c">files</a> |
changeset |
<a href="/comm-central/raw-rev/05d059079026fc51aa98709381607b24b237497c">raw</a>  | <a href="/comm-central/archive/05d059079026fc51aa98709381607b24b237497c.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
Fix <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=855067">bug 855067</a> - Localized Lightning builds using Thunderbird Infrastructure. r=Standard8
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#80;&#104;&#105;&#108;&#105;&#112;&#112;&#32;&#75;&#101;&#119;&#105;&#115;&#99;&#104;&#32;&#60;&#109;&#111;&#122;&#105;&#108;&#108;&#97;&#64;&#107;&#101;&#119;&#105;&#115;&#46;&#99;&#104;&#62;</td></tr>
<tr><td></td><td class="date age">Sun, 16 Jun 2013 22:10:17 +0200</td></tr>

<tr>
 <td>changeset 12578</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/05d059079026fc51aa98709381607b24b237497c">05d059079026fc51aa98709381607b24b237497c</a></td>
</tr>



<tr>
<td>parent 12577</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/f2135de297c1fc7f84921abd2579cc5e1cd58efe">f2135de297c1fc7f84921abd2579cc5e1cd58efe</a>
</td>
</tr>

<tr>
<td>child 12579</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/a17d8582694a9c674bd0f6b3c1b4294f757075a4">a17d8582694a9c674bd0f6b3c1b4294f757075a4</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=05d059079026fc51aa98709381607b24b237497c">9251</a></td></tr>
<tr><td>push user</td><td>mozilla@kewis.ch</td></tr>
<tr><td>push date</td><td class="date age">Sun, 16 Jun 2013 20:10:54 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@05d059079026 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=05d059079026fc51aa98709381607b24b237497c">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=05d059079026fc51aa98709381607b24b237497c&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=05d059079026fc51aa98709381607b24b237497c&newProject=comm-central&newRevision=05d059079026fc51aa98709381607b24b237497c&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=05d059079026fc51aa98709381607b24b237497c&newProject=comm-central&newRevision=05d059079026fc51aa98709381607b24b237497c&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=05d059079026fc51aa98709381607b24b237497c&newProject=comm-central&newRevision=05d059079026fc51aa98709381607b24b237497c&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28Standard8%29&revcount=50">Standard8</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=855067">855067</a></td></tr>




</table></div>

<div class="page_body description">Fix <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=855067">bug 855067</a> - Localized Lightning builds using Thunderbird Infrastructure. r=Standard8</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/Makefile.in">calendar/lightning/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/Makefile.in">file</a> |
<a href="/comm-central/annotate/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/Makefile.in">annotate</a> |
<a href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/Makefile.in">diff</a> |
<a href="/comm-central/comparison/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/Makefile.in">comparison</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/lightning-packager.mk">calendar/lightning/lightning-packager.mk</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/lightning-packager.mk">file</a> |
<a href="/comm-central/annotate/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/lightning-packager.mk">annotate</a> |
<a href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/lightning-packager.mk">diff</a> |
<a href="/comm-central/comparison/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/lightning-packager.mk">comparison</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/lightning-packager.mk">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/lightning-symbols.mk">calendar/lightning/lightning-symbols.mk</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/lightning-symbols.mk">file</a> |
<a href="/comm-central/annotate/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/lightning-symbols.mk">annotate</a> |
<a href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/lightning-symbols.mk">diff</a> |
<a href="/comm-central/comparison/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/lightning-symbols.mk">comparison</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/lightning-symbols.mk">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/locales/moz.build">calendar/lightning/locales/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/locales/moz.build">file</a> |
<a href="/comm-central/annotate/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/locales/moz.build">annotate</a> |
<a href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/locales/moz.build">diff</a> |
<a href="/comm-central/comparison/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/locales/moz.build">comparison</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/locales/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/moz.build">calendar/lightning/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/moz.build">file</a> |
<a href="/comm-central/annotate/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/moz.build">annotate</a> |
<a href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/moz.build">diff</a> |
<a href="/comm-central/comparison/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/moz.build">comparison</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c/calendar/lightning/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/locales/moz.build">calendar/locales/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c/calendar/locales/moz.build">file</a> |
<a href="/comm-central/annotate/05d059079026fc51aa98709381607b24b237497c/calendar/locales/moz.build">annotate</a> |
<a href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/locales/moz.build">diff</a> |
<a href="/comm-central/comparison/05d059079026fc51aa98709381607b24b237497c/calendar/locales/moz.build">comparison</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c/calendar/locales/moz.build">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/locales/shipped-locales">calendar/locales/shipped-locales</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c/calendar/locales/shipped-locales">file</a> |
<a href="/comm-central/annotate/05d059079026fc51aa98709381607b24b237497c/calendar/locales/shipped-locales">annotate</a> |
<a href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/locales/shipped-locales">diff</a> |
<a href="/comm-central/comparison/05d059079026fc51aa98709381607b24b237497c/calendar/locales/shipped-locales">comparison</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c/calendar/locales/shipped-locales">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/providers/gdata/Makefile.in">calendar/providers/gdata/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c/calendar/providers/gdata/Makefile.in">file</a> |
<a href="/comm-central/annotate/05d059079026fc51aa98709381607b24b237497c/calendar/providers/gdata/Makefile.in">annotate</a> |
<a href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/calendar/providers/gdata/Makefile.in">diff</a> |
<a href="/comm-central/comparison/05d059079026fc51aa98709381607b24b237497c/calendar/providers/gdata/Makefile.in">comparison</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c/calendar/providers/gdata/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/mail/build.mk">mail/build.mk</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c/mail/build.mk">file</a> |
<a href="/comm-central/annotate/05d059079026fc51aa98709381607b24b237497c/mail/build.mk">annotate</a> |
<a href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/mail/build.mk">diff</a> |
<a href="/comm-central/comparison/05d059079026fc51aa98709381607b24b237497c/mail/build.mk">comparison</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c/mail/build.mk">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/linux32/l10n-mozconfig">mail/config/mozconfigs/linux32/l10n-mozconfig</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/linux32/l10n-mozconfig">file</a> |
<a href="/comm-central/annotate/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/linux32/l10n-mozconfig">annotate</a> |
<a href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/linux32/l10n-mozconfig">diff</a> |
<a href="/comm-central/comparison/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/linux32/l10n-mozconfig">comparison</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/linux32/l10n-mozconfig">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/linux64/l10n-mozconfig">mail/config/mozconfigs/linux64/l10n-mozconfig</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/linux64/l10n-mozconfig">file</a> |
<a href="/comm-central/annotate/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/linux64/l10n-mozconfig">annotate</a> |
<a href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/linux64/l10n-mozconfig">diff</a> |
<a href="/comm-central/comparison/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/linux64/l10n-mozconfig">comparison</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/linux64/l10n-mozconfig">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/macosx-universal/l10n-mozconfig">mail/config/mozconfigs/macosx-universal/l10n-mozconfig</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/macosx-universal/l10n-mozconfig">file</a> |
<a href="/comm-central/annotate/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/macosx-universal/l10n-mozconfig">annotate</a> |
<a href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/macosx-universal/l10n-mozconfig">diff</a> |
<a href="/comm-central/comparison/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/macosx-universal/l10n-mozconfig">comparison</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/macosx-universal/l10n-mozconfig">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/win32/l10n-mozconfig">mail/config/mozconfigs/win32/l10n-mozconfig</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/win32/l10n-mozconfig">file</a> |
<a href="/comm-central/annotate/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/win32/l10n-mozconfig">annotate</a> |
<a href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/win32/l10n-mozconfig">diff</a> |
<a href="/comm-central/comparison/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/win32/l10n-mozconfig">comparison</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/win32/l10n-mozconfig">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/win64/l10n-mozconfig">mail/config/mozconfigs/win64/l10n-mozconfig</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/win64/l10n-mozconfig">file</a> |
<a href="/comm-central/annotate/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/win64/l10n-mozconfig">annotate</a> |
<a href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/win64/l10n-mozconfig">diff</a> |
<a href="/comm-central/comparison/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/win64/l10n-mozconfig">comparison</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c/mail/config/mozconfigs/win64/l10n-mozconfig">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/mail/locales/Makefile.in">mail/locales/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/05d059079026fc51aa98709381607b24b237497c/mail/locales/Makefile.in">file</a> |
<a href="/comm-central/annotate/05d059079026fc51aa98709381607b24b237497c/mail/locales/Makefile.in">annotate</a> |
<a href="/comm-central/diff/05d059079026fc51aa98709381607b24b237497c/mail/locales/Makefile.in">diff</a> |
<a href="/comm-central/comparison/05d059079026fc51aa98709381607b24b237497c/mail/locales/Makefile.in">comparison</a> |
<a href="/comm-central/log/05d059079026fc51aa98709381607b24b237497c/mail/locales/Makefile.in">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/lightning/Makefile.in</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/lightning/Makefile.in</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -10,17 +10,17 @@ VPATH		= @srcdir@</span>
<a href="#l1.4"></a><span id="l1.4"> include $(DEPTH)/config/autoconf.mk</span>
<a href="#l1.5"></a><span id="l1.5"> </span>
<a href="#l1.6"></a><span id="l1.6"> # Calendar builders currently use STRIP_XPI to reduce the binary component in</span>
<a href="#l1.7"></a><span id="l1.7"> # Lightning.</span>
<a href="#l1.8"></a><span id="l1.8"> </span>
<a href="#l1.9"></a><span id="l1.9"> export XPI_NAME = lightning</span>
<a href="#l1.10"></a><span id="l1.10"> export USE_EXTENSION_MANIFEST = 1</span>
<a href="#l1.11"></a><span id="l1.11"> XPI_PKGNAME = lightning-$(LIGHTNING_VERSION).$(AB_CD).$(MOZ_PKG_PLATFORM)</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-GDATA_XPI_PKGNAME = gdata-provider-$(GDATA_VERSION).$(AB_CD).$(MOZ_PKG_PLATFORM)</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+XPI_VERSION = $(LIGHTNING_VERSION)</span>
<a href="#l1.14"></a><span id="l1.14"> </span>
<a href="#l1.15"></a><span id="l1.15"> XPI_EM_ID = {e2fda1a4-762b-4020-b5ad-a41df1933103}</span>
<a href="#l1.16"></a><span id="l1.16"> </span>
<a href="#l1.17"></a><span id="l1.17"> DIST_FILES = install.rdf application.ini</span>
<a href="#l1.18"></a><span id="l1.18"> PREF_JS_EXPORTS = $(srcdir)/content/lightning.js</span>
<a href="#l1.19"></a><span id="l1.19"> </span>
<a href="#l1.20"></a><span id="l1.20"> # Lighting version number</span>
<a href="#l1.21"></a><span id="l1.21"> LIGHTNING_VERSION := $(shell cat $(srcdir)/../sunbird/config/version.txt)</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineat">@@ -117,16 +117,21 @@ DEFINES += -DGRE_BUILDID=$(GRE_BUILDID)</span>
<a href="#l1.23"></a><span id="l1.23"> </span>
<a href="#l1.24"></a><span id="l1.24"> # xxx todo: unless our packaging story is revised (bug 406579) we package up timezones.sqlite</span>
<a href="#l1.25"></a><span id="l1.25"> libs::</span>
<a href="#l1.26"></a><span id="l1.26"> 	$(NSINSTALL) -m 0644 $(srcdir)/../timezones/timezones.sqlite $(FINAL_TARGET)</span>
<a href="#l1.27"></a><span id="l1.27"> </span>
<a href="#l1.28"></a><span id="l1.28"> include $(topsrcdir)/config/rules.mk</span>
<a href="#l1.29"></a><span id="l1.29"> include $(srcdir)/lightning-packager.mk</span>
<a href="#l1.30"></a><span id="l1.30"> </span>
<a href="#l1.31"></a><span id="l1.31" class="difflineplus">+# For Lightning, we also need to preprocess the l10n prefs</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineplus">+repack-process-extrafiles: lightning-extrafiles</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineplus">+lightning-extrafiles:</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineplus">+	$(PYTHON) $(MOZILLA_SRCDIR)/config/Preprocessor.py $(PREF_PPFLAGS) $(DEFINES) $(ACDEFINES) $(XULPPFLAGS) $(LOCALE_BASEDIR)/lightning-l10n.js  &gt; $(DIST)/$(UNIVERSAL_PATH)xpi-stage/$(L10N_XPI_NAME)/$(PREF_DIR)/lightning-l10n.js</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineplus">+</span>
<a href="#l1.36"></a><span id="l1.36"> ifeq (cocoa,$(MOZ_WIDGET_TOOLKIT))</span>
<a href="#l1.37"></a><span id="l1.37"> # If the macbundle dist dir was already created, sync lightning here to avoid</span>
<a href="#l1.38"></a><span id="l1.38"> # the need to make -C objdir/mail/app each time</span>
<a href="#l1.39"></a><span id="l1.39"> libs::</span>
<a href="#l1.40"></a><span id="l1.40"> 	[ -d $(DIST)/$(MOZ_MACBUNDLE_NAME) ] &amp;&amp; rsync -aL $(FINAL_TARGET)/ $(DIST)/$(MOZ_MACBUNDLE_NAME)/Contents/MacOS/extensions/$(XPI_EM_ID) || true</span>
<a href="#l1.41"></a><span id="l1.41"> endif</span>
<a href="#l1.42"></a><span id="l1.42"> </span>
<a href="#l1.43"></a><span id="l1.43"> ident:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/lightning/lightning-packager.mk</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/lightning/lightning-packager.mk</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1,142 +1,181 @@</span>
<a href="#l2.4"></a><span id="l2.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l2.5"></a><span id="l2.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l2.6"></a><span id="l2.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l2.7"></a><span id="l2.7"> </span>
<a href="#l2.8"></a><span id="l2.8" class="difflineminus">-ifdef UNIVERSAL_BINARY</span>
<a href="#l2.9"></a><span id="l2.9" class="difflineplus">+# NOTE: The packager is not only used in calendar/lightning but should be</span>
<a href="#l2.10"></a><span id="l2.10" class="difflineplus">+# general enough to be able to repackage other sub-extensions like</span>
<a href="#l2.11"></a><span id="l2.11" class="difflineplus">+# calendar/providers/gdata. This means no lightning-specific files, no version</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+# numbers directly from lightning and be careful with relative paths.</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+# This packager can be used to repackage extensions. To use it, set the</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+# following variables in your Makefile, then include this file.</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+#   XPI_NAME = lightning # The extension path name</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+#   XPI_PKGNAME = lightning-2.2.en-US.mac # The extension package name</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineplus">+#   XPI_VERSION = 2.2 # The extension version</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+#</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineplus">+# The following variables are optional:</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineplus">+#   XPI_NO_UNIVERSAL = 1  # If set, no universal path is used on mac</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineplus">+</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineplus">+include $(MOZILLA_SRCDIR)/toolkit/mozapps/installer/package-name.mk</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineplus">+</span>
<a href="#l2.25"></a><span id="l2.25" class="difflineplus">+# Set the univeral path only if we are building a univeral binary and it was</span>
<a href="#l2.26"></a><span id="l2.26" class="difflineplus">+# not restricted by the calling makefile</span>
<a href="#l2.27"></a><span id="l2.27" class="difflineplus">+ifeq ($(UNIVERSAL_BINARY)|$(XPI_NO_UNIVERSAL),1|)</span>
<a href="#l2.28"></a><span id="l2.28"> UNIVERSAL_PATH=universal/</span>
<a href="#l2.29"></a><span id="l2.29"> else</span>
<a href="#l2.30"></a><span id="l2.30"> UNIVERSAL_PATH=</span>
<a href="#l2.31"></a><span id="l2.31"> endif</span>
<a href="#l2.32"></a><span id="l2.32"> </span>
<a href="#l2.33"></a><span id="l2.33"> _ABS_DIST := $(call core_abspath,$(DIST))</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineminus">-ZIP_IN ?= $(_ABS_DIST)/$(UNIVERSAL_PATH)xpi-stage/$(XPI_NAME).xpi</span>
<a href="#l2.35"></a><span id="l2.35"> </span>
<a href="#l2.36"></a><span id="l2.36"> # This variable is to allow the wget-en-US target to know which ftp server to download from</span>
<a href="#l2.37"></a><span id="l2.37"> ifndef EN_US_BINARY_URL</span>
<a href="#l2.38"></a><span id="l2.38"> EN_US_BINARY_URL = $(error You must set EN_US_BINARY_URL)</span>
<a href="#l2.39"></a><span id="l2.39"> endif</span>
<a href="#l2.40"></a><span id="l2.40"> </span>
<a href="#l2.41"></a><span id="l2.41" class="difflineminus">-# Target Directory used for the l10n files</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineminus">-L10N_TARGET = $(DIST)/$(UNIVERSAL_PATH)xpi-stage/$(XPI_NAME)-$(AB_CD)</span>
<a href="#l2.43"></a><span id="l2.43" class="difflineminus">-</span>
<a href="#l2.44"></a><span id="l2.44" class="difflineminus">-$(DIST)/$(UNIVERSAL_PATH)xpi-stage:</span>
<a href="#l2.45"></a><span id="l2.45" class="difflineplus">+XPI_STAGE_PATH = $(DIST)/$(UNIVERSAL_PATH)xpi-stage</span>
<a href="#l2.46"></a><span id="l2.46" class="difflineplus">+_ABS_XPI_STAGE_PATH = $(ABS_DIST)/$(UNIVERSAL_PATH)xpi-stage</span>
<a href="#l2.47"></a><span id="l2.47" class="difflineplus">+$(XPI_STAGE_PATH):</span>
<a href="#l2.48"></a><span id="l2.48"> 	mkdir -p $@</span>
<a href="#l2.49"></a><span id="l2.49"> </span>
<a href="#l2.50"></a><span id="l2.50" class="difflineminus">-wget-en-US: $(DIST)/$(UNIVERSAL_PATH)xpi-stage</span>
<a href="#l2.51"></a><span id="l2.51" class="difflineminus">-ifndef WGET</span>
<a href="#l2.52"></a><span id="l2.52" class="difflineminus">-	$(error wget not installed)</span>
<a href="#l2.53"></a><span id="l2.53" class="difflineminus">-endif</span>
<a href="#l2.54"></a><span id="l2.54" class="difflineminus">-	(cd $(DIST)/xpi-stage &amp;&amp; $(WGET) -nv -N $(EN_US_BINARY_URL)/$(XPI_NAME).xpi)</span>
<a href="#l2.55"></a><span id="l2.55" class="difflineminus">-	@echo &quot;Downloaded $(EN_US_BINARY_URL)/$(PACKAGE) to	$(ZIP_IN)&quot;</span>
<a href="#l2.56"></a><span id="l2.56" class="difflineminus">-</span>
<a href="#l2.57"></a><span id="l2.57" class="difflineminus">-unpack: $(ZIP_IN)</span>
<a href="#l2.58"></a><span id="l2.58" class="difflineminus">-# We're unpacking directly into FINAL_TARGET, this keeps code to do manual</span>
<a href="#l2.59"></a><span id="l2.59" class="difflineminus">-# repacks cleaner.</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineminus">-	if test -d $(DIST)/$(UNIVERSAL_PATH)xpi-stage/$(XPI_NAME); then \</span>
<a href="#l2.61"></a><span id="l2.61" class="difflineminus">-	  $(RM) -r -v $(DIST)/$(UNIVERSAL_PATH)xpi-stage/$(XPI_NAME); \</span>
<a href="#l2.62"></a><span id="l2.62" class="difflineminus">-	fi</span>
<a href="#l2.63"></a><span id="l2.63" class="difflineminus">-	$(NSINSTALL) -D $(DIST)/$(UNIVERSAL_PATH)xpi-stage/$(XPI_NAME)</span>
<a href="#l2.64"></a><span id="l2.64" class="difflineminus">-	cd $(DIST)/$(UNIVERSAL_PATH)/xpi-stage/$(XPI_NAME) &amp;&amp; $(UNZIP) $(ZIP_IN)</span>
<a href="#l2.65"></a><span id="l2.65" class="difflineminus">-	@echo done unpacking</span>
<a href="#l2.66"></a><span id="l2.66" class="difflineminus">-</span>
<a href="#l2.67"></a><span id="l2.67" class="difflineminus">-# Call this target to upload the localized lightning package.</span>
<a href="#l2.68"></a><span id="l2.68" class="difflineminus">-l10n-upload-%: AB_CD=$*</span>
<a href="#l2.69"></a><span id="l2.69" class="difflineminus">-l10n-upload-%:</span>
<a href="#l2.70"></a><span id="l2.70" class="difflineminus">-	$(PYTHON) $(MOZILLA_SRCDIR)/build/upload.py --base-path $(DIST)/$(UNIVERSAL_PATH)xpi-stage/  &quot;$(L10N_TARGET).xpi&quot;</span>
<a href="#l2.71"></a><span id="l2.71" class="difflineplus">+# Target Directory used for the l10n files</span>
<a href="#l2.72"></a><span id="l2.72" class="difflineplus">+L10N_TARGET = $(XPI_STAGE_PATH)/$(XPI_NAME)-$(AB_CD)</span>
<a href="#l2.73"></a><span id="l2.73"> </span>
<a href="#l2.74"></a><span id="l2.74" class="difflineminus">-# Call this target to trigger repackaging lightning for a specific language</span>
<a href="#l2.75"></a><span id="l2.75" class="difflineminus">-# Usage: make AB_CD=&lt;language&gt; repack-l10n</span>
<a href="#l2.76"></a><span id="l2.76" class="difflineminus">-repack-l10n: L10N_XPI_NAME=$(subst -en-US,,$(XPI_NAME)-$(AB_CD))</span>
<a href="#l2.77"></a><span id="l2.77" class="difflineminus">-repack-l10n: recreate-platformini repack-clobber libs-$(AB_CD) repack-process-extrafiles</span>
<a href="#l2.78"></a><span id="l2.78" class="difflineminus">-	@echo &quot;Finished repackaging $(XPI_NAME) locale for Language $(AB_CD)&quot;</span>
<a href="#l2.79"></a><span id="l2.79" class="difflineminus">-</span>
<a href="#l2.80"></a><span id="l2.80" class="difflineminus">-# This target should not be called directly</span>
<a href="#l2.81"></a><span id="l2.81" class="difflineminus">-repack-clobber-all:</span>
<a href="#l2.82"></a><span id="l2.82" class="difflineminus">-	@echo &quot;Repackaging $(XPI_NAME) locale for Language $(AB_CD)&quot;</span>
<a href="#l2.83"></a><span id="l2.83" class="difflineminus">-	$(RM) -rf $(L10N_TARGET)</span>
<a href="#l2.84"></a><span id="l2.84" class="difflineminus">-	cp -R $(DIST)/$(UNIVERSAL_PATH)xpi-stage/$(XPI_NAME) $(L10N_TARGET)</span>
<a href="#l2.85"></a><span id="l2.85" class="difflineminus">-</span>
<a href="#l2.86"></a><span id="l2.86" class="difflineminus">-# This target should not be called directly</span>
<a href="#l2.87"></a><span id="l2.87" class="difflineminus">-repack-clobber: repack-clobber-all</span>
<a href="#l2.88"></a><span id="l2.88" class="difflineminus">-	grep -v 'locale \w\+ en-US' $(L10N_TARGET)/chrome.manifest &gt; $(L10N_TARGET)/chrome.manifest~ &amp;&amp; \</span>
<a href="#l2.89"></a><span id="l2.89" class="difflineminus">-	  mv $(L10N_TARGET)/chrome.manifest~ $(L10N_TARGET)/chrome.manifest</span>
<a href="#l2.90"></a><span id="l2.90" class="difflineminus">-ifeq ($(MOZ_CHROME_FILE_FORMAT),flat)</span>
<a href="#l2.91"></a><span id="l2.91" class="difflineminus">-	$(RM) -rf $(L10N_TARGET)/chrome/lightning-en-US/</span>
<a href="#l2.92"></a><span id="l2.92" class="difflineminus">-	$(RM) -rf $(L10N_TARGET)/chrome/calendar-en-US/</span>
<a href="#l2.93"></a><span id="l2.93" class="difflineminus">-else ifeq ($(MOZ_CHROME_FILE_FORMAT),jar)</span>
<a href="#l2.94"></a><span id="l2.94" class="difflineminus">-	$(RM) -rf $(L10N_TARGET)/chrome/lightning-en-US.jar</span>
<a href="#l2.95"></a><span id="l2.95" class="difflineminus">-	$(RM) -rf $(L10N_TARGET)/chrome/calendar-en-US.jar</span>
<a href="#l2.96"></a><span id="l2.96" class="difflineminus">-else</span>
<a href="#l2.97"></a><span id="l2.97" class="difflineminus">-	@echo &quot;ERROR: Unhandled chrome file format: $(MOZ_CHROME_FILE_FORMAT)&quot;</span>
<a href="#l2.98"></a><span id="l2.98" class="difflineminus">-	@exit 1</span>
<a href="#l2.99"></a><span id="l2.99" class="difflineminus">-endif</span>
<a href="#l2.100"></a><span id="l2.100" class="difflineminus">-</span>
<a href="#l2.101"></a><span id="l2.101" class="difflineplus">+# Short name of the OS used in shipped-locales file. For now osx is the only</span>
<a href="#l2.102"></a><span id="l2.102" class="difflineplus">+# special case, so assume linux for everything else.</span>
<a href="#l2.103"></a><span id="l2.103"> ifeq (cocoa,$(MOZ_WIDGET_TOOLKIT))</span>
<a href="#l2.104"></a><span id="l2.104"> SHORTOS = osx</span>
<a href="#l2.105"></a><span id="l2.105"> else</span>
<a href="#l2.106"></a><span id="l2.106" class="difflineminus">-# For now, osx is the only special case. Therefore, we can just fallback to</span>
<a href="#l2.107"></a><span id="l2.107" class="difflineminus">-# detecting linux which should be the second argument.</span>
<a href="#l2.108"></a><span id="l2.108"> SHORTOS = linux</span>
<a href="#l2.109"></a><span id="l2.109"> endif</span>
<a href="#l2.110"></a><span id="l2.110"> </span>
<a href="#l2.111"></a><span id="l2.111" class="difflineminus">-# Repack the existing lightning to contain all locales in lightning-all.xpi</span>
<a href="#l2.112"></a><span id="l2.112" class="difflineminus">-repack-l10n-all: AB_CD=all</span>
<a href="#l2.113"></a><span id="l2.113" class="difflineminus">-repack-l10n-all: L10N_XPI_NAME=lightning-all</span>
<a href="#l2.114"></a><span id="l2.114" class="difflineminus">-repack-l10n-all: repack-clobber-all $(addprefix libs-,$(shell awk '{ if ($$2 == &quot;&quot; || $$2 == &quot;$(SHORTOS)&quot;) { print $$1 } }' $(topsrcdir)/calendar/locales/shipped-locales))</span>
<a href="#l2.115"></a><span id="l2.115" class="difflineplus">+# function oslocales(filename)</span>
<a href="#l2.116"></a><span id="l2.116" class="difflineplus">+oslocales = $(shell awk '{ if ($$2 == &quot;&quot; || $$2 == &quot;$(SHORTOS)&quot;) { print $$1 } }' $1)</span>
<a href="#l2.117"></a><span id="l2.117" class="difflineplus">+</span>
<a href="#l2.118"></a><span id="l2.118" class="difflineplus">+# function apposlocales(app)</span>
<a href="#l2.119"></a><span id="l2.119" class="difflineplus">+apposlocales = $(call oslocales,$(topsrcdir)/$1/locales/$(if $(filter $(MOZ_UPDATE_CHANNEL),beta release),shipped-locales,all-locales))</span>
<a href="#l2.120"></a><span id="l2.120" class="difflineplus">+</span>
<a href="#l2.121"></a><span id="l2.121" class="difflineplus">+# function print_ltnconfig(section,configname)</span>
<a href="#l2.122"></a><span id="l2.122" class="difflineplus">+print_ltnconfig = $(shell $(PYTHON) $(MOZILLA_SRCDIR)/config/printconfigsetting.py $(XPI_STAGE_PATH)/$(XPI_NAME)/application.ini $1 $2)</span>
<a href="#l2.123"></a><span id="l2.123" class="difflineplus">+</span>
<a href="#l2.124"></a><span id="l2.124" class="difflineplus">+# Lightning uses Thunderbird's build machinery, so we need to hack the binary</span>
<a href="#l2.125"></a><span id="l2.125" class="difflineplus">+# url to use Lightning's directories.</span>
<a href="#l2.126"></a><span id="l2.126" class="difflineplus">+wget-en-US: FINAL_BINARY_URL = $(subst thunderbird,calendar/lightning,$(EN_US_BINARY_URL))</span>
<a href="#l2.127"></a><span id="l2.127" class="difflineplus">+wget-en-US: $(XPI_STAGE_PATH)</span>
<a href="#l2.128"></a><span id="l2.128" class="difflineplus">+wget-en-US: ZIP_IN ?= $(_ABS_XPI_STAGE_PATH)/$(XPI_PKGNAME).xpi</span>
<a href="#l2.129"></a><span id="l2.129" class="difflineplus">+wget-en-US:</span>
<a href="#l2.130"></a><span id="l2.130" class="difflineplus">+	(cd $(XPI_STAGE_PATH) &amp;&amp; $(WGET) -nv -N $(FINAL_BINARY_URL)/$(XPI_PKGNAME).xpi)</span>
<a href="#l2.131"></a><span id="l2.131" class="difflineplus">+	@echo &quot;Downloaded $(FINAL_BINARY_URL)/$(XPI_PKGNAME) to	$(ZIP_IN)&quot;</span>
<a href="#l2.132"></a><span id="l2.132" class="difflineplus">+</span>
<a href="#l2.133"></a><span id="l2.133" class="difflineplus">+# If this file is missing, its probably the release run where we can't</span>
<a href="#l2.134"></a><span id="l2.134" class="difflineplus">+# influence the download location. Fake it from the env vars we have</span>
<a href="#l2.135"></a><span id="l2.135" class="difflineplus">+ensure-stage-dir: $(if $(wildcard $(XPI_STAGE_PATH)/$(XPI_NAME)/),,wget-from-env)</span>
<a href="#l2.136"></a><span id="l2.136" class="difflineplus">+wget-from-env: BUILD_NR=$(shell echo $(POST_UPLOAD_CMD) | sed -n -e 's/.*-n \([0-9]*\).*/\1/p')</span>
<a href="#l2.137"></a><span id="l2.137" class="difflineplus">+wget-from-env: CANDIDATE_NR=$(XPI_VERSION)</span>
<a href="#l2.138"></a><span id="l2.138" class="difflineplus">+wget-from-env: EN_US_BINARY_URL=http://$(UPLOAD_HOST)/pub/mozilla.org/calendar/lightning/nightly/$(CANDIDATE_NR)-candidates/build$(BUILD_NR)/$(MOZ_PKG_PLATFORM)</span>
<a href="#l2.139"></a><span id="l2.139" class="difflineplus">+wget-from-env: XPI_PKGNAME:=$(subst .$(AB_CD).,.en-US.,$(XPI_PKGNAME))</span>
<a href="#l2.140"></a><span id="l2.140" class="difflineplus">+wget-from-env: ZIP_IN=$(_ABS_XPI_STAGE_PATH)/$(XPI_PKGNAME).xpi</span>
<a href="#l2.141"></a><span id="l2.141" class="difflineplus">+wget-from-env: wget-en-US unpack</span>
<a href="#l2.142"></a><span id="l2.142" class="difflineplus">+</span>
<a href="#l2.143"></a><span id="l2.143" class="difflineplus">+# We're unpacking directly into FINAL_TARGET, this keeps code to do manual</span>
<a href="#l2.144"></a><span id="l2.144" class="difflineplus">+# repacks cleaner.</span>
<a href="#l2.145"></a><span id="l2.145" class="difflineplus">+unpack: ZIP_IN ?= $(_ABS_XPI_STAGE_PATH)/$(XPI_PKGNAME).xpi</span>
<a href="#l2.146"></a><span id="l2.146" class="difflineplus">+unpack: $(ZIP_IN)</span>
<a href="#l2.147"></a><span id="l2.147" class="difflineplus">+	if test -d $(XPI_STAGE_PATH)/$(XPI_NAME); then \</span>
<a href="#l2.148"></a><span id="l2.148" class="difflineplus">+	  $(RM) -r -v $(XPI_STAGE_PATH)/$(XPI_NAME); \</span>
<a href="#l2.149"></a><span id="l2.149" class="difflineplus">+	fi</span>
<a href="#l2.150"></a><span id="l2.150" class="difflineplus">+	$(NSINSTALL) -D $(XPI_STAGE_PATH)/$(XPI_NAME)</span>
<a href="#l2.151"></a><span id="l2.151" class="difflineplus">+	cd $(XPI_STAGE_PATH)/$(XPI_NAME) &amp;&amp; $(UNZIP) $(ZIP_IN)</span>
<a href="#l2.152"></a><span id="l2.152" class="difflineplus">+	@echo done unpacking</span>
<a href="#l2.153"></a><span id="l2.153" class="difflineplus">+</span>
<a href="#l2.154"></a><span id="l2.154" class="difflineplus">+# Nothing to package for en-US, its just the usual english xpi</span>
<a href="#l2.155"></a><span id="l2.155" class="difflineplus">+langpack-en-US:</span>
<a href="#l2.156"></a><span id="l2.156" class="difflineplus">+	@echo &quot;Skipping $@ as en-US is the default&quot;</span>
<a href="#l2.157"></a><span id="l2.157"> </span>
<a href="#l2.158"></a><span id="l2.158" class="difflineminus">-.PHONY : repack-l10n-all</span>
<a href="#l2.159"></a><span id="l2.159" class="difflineplus">+# Skip those locales in Thunderbird but not in Lightning. Use either</span>
<a href="#l2.160"></a><span id="l2.160" class="difflineplus">+# all-locales or shipped-locales, depending on if we are doing a</span>
<a href="#l2.161"></a><span id="l2.161" class="difflineplus">+# regular repack or a release repack</span>
<a href="#l2.162"></a><span id="l2.162" class="difflineplus">+CAL_LOCALES = $(call apposlocales,calendar)</span>
<a href="#l2.163"></a><span id="l2.163" class="difflineplus">+TB_LOCALES = $(call apposlocales,mail)</span>
<a href="#l2.164"></a><span id="l2.164" class="difflineplus">+TB_SKIP_LOCALES = $(filter-out $(CAL_LOCALES) en-US,$(TB_LOCALES))</span>
<a href="#l2.165"></a><span id="l2.165" class="difflineplus">+$(addprefix langpack-,$(TB_SKIP_LOCALES)) $(addprefix upload-,$(TB_SKIP_LOCALES)):</span>
<a href="#l2.166"></a><span id="l2.166" class="difflineplus">+	@echo &quot;Skipping $@ as it is not in Lightning's $(LOCALES_FILENAME)&quot;</span>
<a href="#l2.167"></a><span id="l2.167" class="difflineplus">+</span>
<a href="#l2.168"></a><span id="l2.168" class="difflineplus">+# Calling these targets with prerequisites causes the libs and subsequent</span>
<a href="#l2.169"></a><span id="l2.169" class="difflineplus">+# targets to be switched in order due to some make voodoo. Therefore we call</span>
<a href="#l2.170"></a><span id="l2.170" class="difflineplus">+# the targets explicitly, which seems to work better.</span>
<a href="#l2.171"></a><span id="l2.171" class="difflineplus">+langpack-%: L10N_XPI_NAME=$(XPI_NAME)-$*</span>
<a href="#l2.172"></a><span id="l2.172" class="difflineplus">+langpack-%: L10N_XPI_PKGNAME=$(subst $(AB_CD),$*,$(XPI_PKGNAME))</span>
<a href="#l2.173"></a><span id="l2.173" class="difflineplus">+langpack-%: AB_CD=$*</span>
<a href="#l2.174"></a><span id="l2.174" class="difflineplus">+langpack-%: ensure-stage-dir</span>
<a href="#l2.175"></a><span id="l2.175" class="difflineplus">+	$(MAKE) L10N_XPI_NAME=$(L10N_XPI_NAME) L10N_XPI_PKGNAME=$(L10N_XPI_PKGNAME) AB_CD=$(AB_CD) \</span>
<a href="#l2.176"></a><span id="l2.176" class="difflineplus">+	  recreate-platformini repack-stage repack-process-extrafiles libs-$(AB_CD)</span>
<a href="#l2.177"></a><span id="l2.177" class="difflineplus">+	@echo &quot;Done packaging $(L10N_XPI_PKGNAME).xpi&quot;</span>
<a href="#l2.178"></a><span id="l2.178"> </span>
<a href="#l2.179"></a><span id="l2.179" class="difflineminus">-# Helper target to align names better to targets from other locale Makefiles</span>
<a href="#l2.180"></a><span id="l2.180" class="difflineminus">-repack-l10n-%:</span>
<a href="#l2.181"></a><span id="l2.181" class="difflineminus">-	$(MAKE) AB_CD=$* repack-l10n</span>
<a href="#l2.182"></a><span id="l2.182" class="difflineplus">+clobber-%: AB_CD=$*</span>
<a href="#l2.183"></a><span id="l2.183" class="difflineplus">+clobber-%:</span>
<a href="#l2.184"></a><span id="l2.184" class="difflineplus">+	$(RM) -r $(L10N_TARGET)</span>
<a href="#l2.185"></a><span id="l2.185" class="difflineplus">+</span>
<a href="#l2.186"></a><span id="l2.186" class="difflineplus">+repackage-zip-%:</span>
<a href="#l2.187"></a><span id="l2.187" class="difflineplus">+	@echo &quot;Already repackaged zip for $* in langpack step&quot;</span>
<a href="#l2.188"></a><span id="l2.188" class="difflineplus">+</span>
<a href="#l2.189"></a><span id="l2.189" class="difflineplus">+repack-stage: repack-stage-all</span>
<a href="#l2.190"></a><span id="l2.190" class="difflineplus">+	grep -v 'locale \w\+ en-US' $(L10N_TARGET)/chrome.manifest &gt; $(L10N_TARGET)/chrome.manifest~ &amp;&amp; \</span>
<a href="#l2.191"></a><span id="l2.191" class="difflineplus">+	  mv $(L10N_TARGET)/chrome.manifest~ $(L10N_TARGET)/chrome.manifest</span>
<a href="#l2.192"></a><span id="l2.192" class="difflineplus">+	find $(call core_abspath,$(L10N_TARGET)) -name '*en-US*' -print0 | xargs -0 rm -rf</span>
<a href="#l2.193"></a><span id="l2.193" class="difflineplus">+</span>
<a href="#l2.194"></a><span id="l2.194" class="difflineplus">+repack-stage-all: $(XPI_STAGE_PATH)/$(XPI_NAME)</span>
<a href="#l2.195"></a><span id="l2.195" class="difflineplus">+	@echo &quot;Repackaging $(XPI_PKGNAME) locale for Language $(AB_CD)&quot;</span>
<a href="#l2.196"></a><span id="l2.196" class="difflineplus">+	$(RM) -rf $(L10N_TARGET)</span>
<a href="#l2.197"></a><span id="l2.197" class="difflineplus">+	cp -R $(XPI_STAGE_PATH)/$(XPI_NAME) $(L10N_TARGET)</span>
<a href="#l2.198"></a><span id="l2.198" class="difflineplus">+</span>
<a href="#l2.199"></a><span id="l2.199" class="difflineplus">+# Repack the existing lightning to contain all locales in lightning-all.xpi</span>
<a href="#l2.200"></a><span id="l2.200" class="difflineplus">+langpack-all: AB_CD=all</span>
<a href="#l2.201"></a><span id="l2.201" class="difflineplus">+langpack-all: L10N_XPI_NAME=$(XPI_NAME)-all</span>
<a href="#l2.202"></a><span id="l2.202" class="difflineplus">+langpack-all: L10N_XPI_PKGNAME=$(subst .$(AB_CD),,$(XPI_PKGNAME))</span>
<a href="#l2.203"></a><span id="l2.203" class="difflineplus">+langpack-all: recreate-platformini repack-stage-all $(addprefix libs-,$(call apposlocales,calendar))</span>
<a href="#l2.204"></a><span id="l2.204" class="difflineplus">+	@echo &quot;Done packaging&quot;</span>
<a href="#l2.205"></a><span id="l2.205"> </span>
<a href="#l2.206"></a><span id="l2.206"> # Actual locale packaging targets. If L10N_XPI_NAME is set, then use it.</span>
<a href="#l2.207"></a><span id="l2.207"> # Otherwise keep the original XPI_NAME</span>
<a href="#l2.208"></a><span id="l2.208"> # Overriding the final target is a bit of a hack for universal builds</span>
<a href="#l2.209"></a><span id="l2.209"> # so that we can ensure we get the right xpi that gets repacked.</span>
<a href="#l2.210"></a><span id="l2.210" class="difflineminus">-# The ../ is added to dist because calendar/lightning/locales is at a different level</span>
<a href="#l2.211"></a><span id="l2.211" class="difflineminus">-# to this makefile.</span>
<a href="#l2.212"></a><span id="l2.212"> libs-%: FINAL_XPI_NAME=$(if $(L10N_XPI_NAME),$(L10N_XPI_NAME),$(XPI_NAME))</span>
<a href="#l2.213"></a><span id="l2.213" class="difflineplus">+libs-%: FINAL_XPI_PKGNAME=$(if $(L10N_XPI_PKGNAME),$(L10N_XPI_PKGNAME),$(XPI_PKGNAME))</span>
<a href="#l2.214"></a><span id="l2.214"> libs-%:</span>
<a href="#l2.215"></a><span id="l2.215" class="difflineminus">-	$(MAKE) -C locales libs AB_CD=$* FINAL_TARGET=$(_ABS_DIST)/$(UNIVERSAL_PATH)xpi-stage/$(FINAL_XPI_NAME) XPI_NAME=$(FINAL_XPI_NAME) XPI_PKGNAME=$(FINAL_XPI_NAME) USE_EXTENSION_MANIFEST=1</span>
<a href="#l2.216"></a><span id="l2.216" class="difflineminus">-	$(MAKE) -C ../locales libs AB_CD=$* FINAL_TARGET=$(_ABS_DIST)/$(UNIVERSAL_PATH)xpi-stage/$(FINAL_XPI_NAME) XPI_NAME=$(FINAL_XPI_NAME) XPI_PKGNAME=$(FINAL_XPI_NAME) USE_EXTENSION_MANIFEST=1</span>
<a href="#l2.217"></a><span id="l2.217" class="difflineplus">+	$(MAKE) -C locales libs AB_CD=$* FINAL_TARGET=$(_ABS_DIST)/$(UNIVERSAL_PATH)xpi-stage/$(FINAL_XPI_NAME) \</span>
<a href="#l2.218"></a><span id="l2.218" class="difflineplus">+	  XPI_NAME=$(FINAL_XPI_NAME) XPI_PKGNAME=$(FINAL_XPI_PKGNAME) USE_EXTENSION_MANIFEST=1</span>
<a href="#l2.219"></a><span id="l2.219"> </span>
<a href="#l2.220"></a><span id="l2.220" class="difflineminus">-# For localized xpis, the install.rdf and lightning-l10n.js need to be</span>
<a href="#l2.221"></a><span id="l2.221" class="difflineminus">-# reprocessed with some defines from the locale.</span>
<a href="#l2.222"></a><span id="l2.222" class="difflineplus">+# For localized xpis, the install.rdf need to be reprocessed with some defines</span>
<a href="#l2.223"></a><span id="l2.223" class="difflineplus">+# from the locale.</span>
<a href="#l2.224"></a><span id="l2.224"> repack-process-extrafiles: LOCALE_BASEDIR=$(call EXPAND_LOCALE_SRCDIR,calendar/locales)</span>
<a href="#l2.225"></a><span id="l2.225"> repack-process-extrafiles:</span>
<a href="#l2.226"></a><span id="l2.226" class="difflineminus">-	$(PYTHON) $(MOZILLA_SRCDIR)/config/Preprocessor.py $(XULAPP_DEFINES) $(DEFINES) $(ACDEFINES) $(XULPPFLAGS) -I $(LOCALE_BASEDIR)/defines.inc $(srcdir)/install.rdf &gt; $(DIST)/$(UNIVERSAL_PATH)xpi-stage/$(L10N_XPI_NAME)/install.rdf</span>
<a href="#l2.227"></a><span id="l2.227" class="difflineminus">-	$(PYTHON) $(MOZILLA_SRCDIR)/config/Preprocessor.py $(PREF_PPFLAGS) $(DEFINES) $(ACDEFINES) $(XULPPFLAGS) $(LOCALE_BASEDIR)/lightning-l10n.js  &gt; $(DIST)/$(UNIVERSAL_PATH)xpi-stage/$(L10N_XPI_NAME)/$(PREF_DIR)/lightning-l10n.js</span>
<a href="#l2.228"></a><span id="l2.228" class="difflineplus">+	$(PYTHON) $(MOZILLA_SRCDIR)/config/Preprocessor.py \</span>
<a href="#l2.229"></a><span id="l2.229" class="difflineplus">+	  $(XULAPP_DEFINES) $(DEFINES) $(ACDEFINES) $(XULPPFLAGS) \</span>
<a href="#l2.230"></a><span id="l2.230" class="difflineplus">+	  -I $(LOCALE_BASEDIR)/defines.inc \</span>
<a href="#l2.231"></a><span id="l2.231" class="difflineplus">+	  $(srcdir)/install.rdf &gt; $(XPI_STAGE_PATH)/$(L10N_XPI_NAME)/install.rdf</span>
<a href="#l2.232"></a><span id="l2.232"> </span>
<a href="#l2.233"></a><span id="l2.233" class="difflineminus">-# When repackaging lightning from the builder, platform.ini is not yet created.i</span>
<a href="#l2.234"></a><span id="l2.234" class="difflineplus">+# When repackaging Lightning from the builder, platform.ini is not yet created.</span>
<a href="#l2.235"></a><span id="l2.235"> # Recreate it from the application.ini bundled with the downloaded xpi.</span>
<a href="#l2.236"></a><span id="l2.236"> $(LIBXUL_DIST)/bin/platform.ini:</span>
<a href="#l2.237"></a><span id="l2.237"> 	 echo &quot;[Build]&quot; &gt;&gt; $(LIBXUL_DIST)/bin/platform.ini</span>
<a href="#l2.238"></a><span id="l2.238" class="difflineminus">-	 </span>
<a href="#l2.239"></a><span id="l2.239" class="difflineminus">-	 echo -n &quot;Milestone=&quot; &gt;&gt; $(LIBXUL_DIST)/bin/platform.ini</span>
<a href="#l2.240"></a><span id="l2.240" class="difflineminus">-	 $(PYTHON) $(MOZILLA_SRCDIR)/config/printconfigsetting.py $(DIST)/$(UNIVERSAL_PATH)xpi-stage/$(XPI_NAME)/application.ini Gecko MaxVersion &gt;&gt; $(LIBXUL_DIST)/bin/platform.ini</span>
<a href="#l2.241"></a><span id="l2.241" class="difflineminus">-	 </span>
<a href="#l2.242"></a><span id="l2.242" class="difflineminus">-	 echo -n &quot;SourceStamp=&quot; &gt;&gt; $(LIBXUL_DIST)/bin/platform.ini</span>
<a href="#l2.243"></a><span id="l2.243" class="difflineminus">-	 $(PYTHON) $(MOZILLA_SRCDIR)/config/printconfigsetting.py $(DIST)/$(UNIVERSAL_PATH)xpi-stage/$(XPI_NAME)/application.ini Build SourceStamp &gt;&gt; $(LIBXUL_DIST)/bin/platform.ini</span>
<a href="#l2.244"></a><span id="l2.244" class="difflineminus">-	 </span>
<a href="#l2.245"></a><span id="l2.245" class="difflineminus">-	 echo -n &quot;SourceRepository=&quot; &gt;&gt; $(LIBXUL_DIST)/bin/platform.ini</span>
<a href="#l2.246"></a><span id="l2.246" class="difflineminus">-	 $(PYTHON) $(MOZILLA_SRCDIR)/config/printconfigsetting.py $(DIST)/$(UNIVERSAL_PATH)xpi-stage/$(XPI_NAME)/application.ini Build SourceRepository &gt;&gt; $(LIBXUL_DIST)/bin/platform.ini</span>
<a href="#l2.247"></a><span id="l2.247" class="difflineminus">-	 </span>
<a href="#l2.248"></a><span id="l2.248" class="difflineminus">-	 echo -n &quot;BuildID=&quot; &gt;&gt; $(LIBXUL_DIST)/bin/platform.ini</span>
<a href="#l2.249"></a><span id="l2.249" class="difflineminus">-	 $(PYTHON) $(MOZILLA_SRCDIR)/config/printconfigsetting.py $(DIST)/$(UNIVERSAL_PATH)xpi-stage/$(XPI_NAME)/application.ini App BuildID &gt;&gt; $(LIBXUL_DIST)/bin/platform.ini</span>
<a href="#l2.250"></a><span id="l2.250" class="difflineplus">+	 echo &quot;Milestone=$(call print_ltnconfig,Gecko,MaxVersion)&quot; &gt;&gt; $(LIBXUL_DIST)/bin/platform.ini</span>
<a href="#l2.251"></a><span id="l2.251" class="difflineplus">+	 echo &quot;SourceStamp=$(call print_ltnconfig,Build,SourceStamp)&quot; &gt;&gt; $(LIBXUL_DIST)/bin/platform.ini</span>
<a href="#l2.252"></a><span id="l2.252" class="difflineplus">+	 echo &quot;SourceRepository=$(call print_ltnconfig,Build,SourceRepository)&quot; &gt;&gt; $(LIBXUL_DIST)/bin/platform.ini</span>
<a href="#l2.253"></a><span id="l2.253" class="difflineplus">+	 echo &quot;BuildID=$(call print_ltnconfig,App,BuildID)&quot; &gt;&gt; $(LIBXUL_DIST)/bin/platform.ini</span>
<a href="#l2.254"></a><span id="l2.254"> </span>
<a href="#l2.255"></a><span id="l2.255"> recreate-platformini: $(LIBXUL_DIST)/bin/platform.ini</span>
<a href="#l2.256"></a><span id="l2.256"> </span>
<a href="#l2.257"></a><span id="l2.257" class="difflineminus">-stage_upload:</span>
<a href="#l2.258"></a><span id="l2.258" class="difflineminus">-	$(NSINSTALL) -D $(DIST)/$(MOZ_PKG_PLATFORM)</span>
<a href="#l2.259"></a><span id="l2.259" class="difflineminus">-	$(INSTALL) $(IFLAGS1) $(DIST)/$(UNIVERSAL_PATH)/xpi-stage/$(XPI_PKGNAME).xpi $(DIST)/$(MOZ_PKG_PLATFORM)</span>
<a href="#l2.260"></a><span id="l2.260" class="difflineminus">-	$(INSTALL) $(IFLAGS1) $(DIST)/xpi-stage/$(GDATA_XPI_PKGNAME).xpi $(DIST)/$(MOZ_PKG_PLATFORM)</span>
<a href="#l2.261"></a><span id="l2.261"> </span>
<a href="#l2.262"></a><span id="l2.262"> # Lightning uses Thunderbird's build machinery, so we need to hack the post</span>
<a href="#l2.263"></a><span id="l2.263" class="difflineminus">-# upload command to use Lightning's directories.</span>
<a href="#l2.264"></a><span id="l2.264" class="difflineminus">-upload: POST_UPLOAD_CMD := $(subst thunderbird,calendar/lightning,$(POST_UPLOAD_CMD))</span>
<a href="#l2.265"></a><span id="l2.265" class="difflineminus">-upload: stage_upload</span>
<a href="#l2.266"></a><span id="l2.266" class="difflineminus">-	POST_UPLOAD_CMD=&quot;$(POST_UPLOAD_CMD)&quot; \</span>
<a href="#l2.267"></a><span id="l2.267" class="difflineplus">+# upload command to use Lightning's directories and version.</span>
<a href="#l2.268"></a><span id="l2.268" class="difflineplus">+upload: upload-$(AB_CD)</span>
<a href="#l2.269"></a><span id="l2.269" class="difflineplus">+upload-%: LTN_UPLOAD_CMD := $(patsubst $(THUNDERBIRD_VERSION)%,$(XPI_VERSION),$(subst thunderbird,calendar/lightning,$(POST_UPLOAD_CMD)))</span>
<a href="#l2.270"></a><span id="l2.270" class="difflineplus">+upload-%: stage_upload</span>
<a href="#l2.271"></a><span id="l2.271" class="difflineplus">+	POST_UPLOAD_CMD=&quot;$(LTN_UPLOAD_CMD)&quot; \</span>
<a href="#l2.272"></a><span id="l2.272"> 	  $(PYTHON) $(MOZILLA_DIR)/build/upload.py --base-path $(DIST) \</span>
<a href="#l2.273"></a><span id="l2.273" class="difflineminus">-	  $(DIST)/$(MOZ_PKG_PLATFORM)/$(XPI_PKGNAME).xpi \</span>
<a href="#l2.274"></a><span id="l2.274" class="difflineminus">-	  $(DIST)/$(MOZ_PKG_PLATFORM)/$(GDATA_XPI_PKGNAME).xpi</span>
<a href="#l2.275"></a><span id="l2.275" class="difflineplus">+	  &quot;$(DIST)/$(MOZ_PKG_PLATFORM)/$(XPI_PKGNAME).xpi&quot;</span>
<a href="#l2.276"></a><span id="l2.276" class="difflineplus">+</span>
<a href="#l2.277"></a><span id="l2.277" class="difflineplus">+stage_upload:</span>
<a href="#l2.278"></a><span id="l2.278" class="difflineplus">+	$(NSINSTALL) -D $(DIST)/$(MOZ_PKG_PLATFORM)</span>
<a href="#l2.279"></a><span id="l2.279" class="difflineplus">+	$(call install_cmd,$(IFLAGS1) $(XPI_STAGE_PATH)/$(XPI_PKGNAME).xpi $(DIST)/$(MOZ_PKG_PLATFORM))</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/lightning/lightning-symbols.mk</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/lightning/lightning-symbols.mk</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -5,18 +5,16 @@</span>
<a href="#l3.4"></a><span id="l3.4"> ###################################</span>
<a href="#l3.5"></a><span id="l3.5"> # Warning this code is copied</span>
<a href="#l3.6"></a><span id="l3.6"> # from mozilla-central/Makefile.in</span>
<a href="#l3.7"></a><span id="l3.7"> # and needs to be kept in sync.</span>
<a href="#l3.8"></a><span id="l3.8"> ###################################</span>
<a href="#l3.9"></a><span id="l3.9"> SYMBOL_INDEX_NAME = \</span>
<a href="#l3.10"></a><span id="l3.10">    $(MOZ_APP_NAME)-$(MOZ_APP_VERSION)-$(OS_TARGET)-$(BUILDID)$(EXTRA_BUILDID)-symbols.txt</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-include $(MOZILLA_SRCDIR)/toolkit/mozapps/installer/package-name.mk</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-</span>
<a href="#l3.14"></a><span id="l3.14"> ifeq ($(OS_ARCH),WINNT)</span>
<a href="#l3.15"></a><span id="l3.15"> # we want to copy PDB files on Windows</span>
<a href="#l3.16"></a><span id="l3.16"> MAKE_SYM_STORE_ARGS := -c --vcs-info</span>
<a href="#l3.17"></a><span id="l3.17"> ifdef PDBSTR_PATH</span>
<a href="#l3.18"></a><span id="l3.18"> MAKE_SYM_STORE_ARGS += -i</span>
<a href="#l3.19"></a><span id="l3.19"> endif</span>
<a href="#l3.20"></a><span id="l3.20"> DUMP_SYMS_BIN ?= $(MOZILLA_SRCDIR)/toolkit/crashreporter/tools/win32/dump_syms_vc$(_MSC_VER).exe</span>
<a href="#l3.21"></a><span id="l3.21"> # PDB files don't get moved to dist, so we need to scan the whole objdir</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/lightning/locales/moz.build</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/lightning/locales/moz.build</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -1,4 +1,6 @@</span>
<a href="#l4.4"></a><span id="l4.4"> # vim: set filetype=python:</span>
<a href="#l4.5"></a><span id="l4.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l4.6"></a><span id="l4.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l4.7"></a><span id="l4.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l4.8"></a><span id="l4.8" class="difflineplus">+</span>
<a href="#l4.9"></a><span id="l4.9" class="difflineplus">+DIRS += ['../../locales']</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/lightning/moz.build</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/lightning/moz.build</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -1,16 +1,15 @@</span>
<a href="#l5.4"></a><span id="l5.4"> # vim: set filetype=python:</span>
<a href="#l5.5"></a><span id="l5.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l5.6"></a><span id="l5.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l5.7"></a><span id="l5.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l5.8"></a><span id="l5.8"> </span>
<a href="#l5.9"></a><span id="l5.9"> DIRS += [</span>
<a href="#l5.10"></a><span id="l5.10">     '../libical',</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineminus">-    '../locales',</span>
<a href="#l5.12"></a><span id="l5.12">     '../base',</span>
<a href="#l5.13"></a><span id="l5.13">     '../providers',</span>
<a href="#l5.14"></a><span id="l5.14">     '../import-export',</span>
<a href="#l5.15"></a><span id="l5.15">     '../itip',</span>
<a href="#l5.16"></a><span id="l5.16">     'components',</span>
<a href="#l5.17"></a><span id="l5.17">     'locales',</span>
<a href="#l5.18"></a><span id="l5.18"> ]</span>
<a href="#l5.19"></a><span id="l5.19"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/locales/moz.build</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/locales/moz.build</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -1,8 +1,4 @@</span>
<a href="#l6.4"></a><span id="l6.4"> # vim: set filetype=python:</span>
<a href="#l6.5"></a><span id="l6.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.6"></a><span id="l6.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.7"></a><span id="l6.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l6.8"></a><span id="l6.8" class="difflineminus">-</span>
<a href="#l6.9"></a><span id="l6.9" class="difflineminus">-if not CONFIG['AB_CD']:</span>
<a href="#l6.10"></a><span id="l6.10" class="difflineminus">-    DIRS += ['../timezones']</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineminus">-</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/locales/shipped-locales</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/locales/shipped-locales</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -1,13 +1,14 @@</span>
<a href="#l7.4"></a><span id="l7.4"> ca</span>
<a href="#l7.5"></a><span id="l7.5"> cs</span>
<a href="#l7.6"></a><span id="l7.6"> da</span>
<a href="#l7.7"></a><span id="l7.7"> de</span>
<a href="#l7.8"></a><span id="l7.8"> en-GB</span>
<a href="#l7.9"></a><span id="l7.9" class="difflineplus">+en-US</span>
<a href="#l7.10"></a><span id="l7.10"> es-AR</span>
<a href="#l7.11"></a><span id="l7.11"> es-ES</span>
<a href="#l7.12"></a><span id="l7.12"> et</span>
<a href="#l7.13"></a><span id="l7.13"> eu</span>
<a href="#l7.14"></a><span id="l7.14"> fi</span>
<a href="#l7.15"></a><span id="l7.15"> fr</span>
<a href="#l7.16"></a><span id="l7.16"> fy-NL</span>
<a href="#l7.17"></a><span id="l7.17"> ga-IE</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/providers/gdata/Makefile.in</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/providers/gdata/Makefile.in</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -3,34 +3,33 @@</span>
<a href="#l8.4"></a><span id="l8.4"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l8.5"></a><span id="l8.5"> </span>
<a href="#l8.6"></a><span id="l8.6"> DEPTH = @DEPTH@</span>
<a href="#l8.7"></a><span id="l8.7"> topsrcdir = @top_srcdir@</span>
<a href="#l8.8"></a><span id="l8.8"> srcdir = @srcdir@</span>
<a href="#l8.9"></a><span id="l8.9"> VPATH = @srcdir@</span>
<a href="#l8.10"></a><span id="l8.10"> </span>
<a href="#l8.11"></a><span id="l8.11"> include $(DEPTH)/config/autoconf.mk</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-include $(MOZILLA_SRCDIR)/toolkit/mozapps/installer/package-name.mk</span>
<a href="#l8.13"></a><span id="l8.13"> </span>
<a href="#l8.14"></a><span id="l8.14"> export USE_EXTENSION_MANIFEST = 1</span>
<a href="#l8.15"></a><span id="l8.15"> export XPI_NAME = gdata-provider</span>
<a href="#l8.16"></a><span id="l8.16"> DIST_FILES = install.rdf</span>
<a href="#l8.17"></a><span id="l8.17"> XPI_PKGNAME = gdata-provider-$(GDATA_VERSION).$(AB_CD).$(MOZ_PKG_PLATFORM)</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineplus">+XPI_VERSION = $(GDATA_VERSION)</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+XPI_NO_UNIVERSAL = 1</span>
<a href="#l8.20"></a><span id="l8.20"> </span>
<a href="#l8.21"></a><span id="l8.21"> CALENDAR_VERSION := $(shell cat $(topsrcdir)/calendar/sunbird/config/version.txt)</span>
<a href="#l8.22"></a><span id="l8.22"> THUNDERBIRD_VERSION := $(shell cat $(topsrcdir)/mail/config/version.txt)</span>
<a href="#l8.23"></a><span id="l8.23"> SEAMONKEY_VERSION := $(shell cat $(topsrcdir)/suite/config/version.txt)</span>
<a href="#l8.24"></a><span id="l8.24"> GDATA_VERSION = $(shell $(PYTHON) $(srcdir)/makeversion.py $(CALENDAR_VERSION))</span>
<a href="#l8.25"></a><span id="l8.25"> </span>
<a href="#l8.26"></a><span id="l8.26"> DEFINES += -DAB_CD=$(AB_CD) \</span>
<a href="#l8.27"></a><span id="l8.27">            -DCALENDAR_VERSION=$(CALENDAR_VERSION) \</span>
<a href="#l8.28"></a><span id="l8.28">            -DSEAMONKEY_VERSION=$(SEAMONKEY_VERSION) \</span>
<a href="#l8.29"></a><span id="l8.29">            -DTHUNDERBIRD_VERSION=$(THUNDERBIRD_VERSION) \</span>
<a href="#l8.30"></a><span id="l8.30">            -DCOMM_BUILD=$(COMM_BUILD) \</span>
<a href="#l8.31"></a><span id="l8.31">            -DGDATA_VERSION=$(GDATA_VERSION) \</span>
<a href="#l8.32"></a><span id="l8.32">            $(NULL)</span>
<a href="#l8.33"></a><span id="l8.33"> </span>
<a href="#l8.34"></a><span id="l8.34"> PREF_JS_EXPORTS = $(srcdir)/defaults/preferences.js</span>
<a href="#l8.35"></a><span id="l8.35"> </span>
<a href="#l8.36"></a><span id="l8.36" class="difflineminus">-libs-%:</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineminus">-	$(MAKE) -C locales libs AB_CD=$* XPI_NAME=$(XPI_NAME) USE_EXTENSION_MANIFEST=1</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineminus">-</span>
<a href="#l8.39"></a><span id="l8.39"> include $(topsrcdir)/config/rules.mk</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineplus">+include $(topsrcdir)/calendar/lightning/lightning-packager.mk</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mail/build.mk</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mail/build.mk</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -25,16 +25,17 @@ install::</span>
<a href="#l9.4"></a><span id="l9.4"> </span>
<a href="#l9.5"></a><span id="l9.5"> source-package::</span>
<a href="#l9.6"></a><span id="l9.6"> 	@$(MAKE) -C mail/installer source-package</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8"> upload::</span>
<a href="#l9.9"></a><span id="l9.9"> 	@$(MAKE) -C mail/installer upload</span>
<a href="#l9.10"></a><span id="l9.10"> ifdef MOZ_CALENDAR</span>
<a href="#l9.11"></a><span id="l9.11"> 	@$(MAKE) -C calendar/lightning upload</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+	@$(MAKE) -C calendar/providers/gdata upload</span>
<a href="#l9.13"></a><span id="l9.13"> endif</span>
<a href="#l9.14"></a><span id="l9.14"> </span>
<a href="#l9.15"></a><span id="l9.15"> source-upload::</span>
<a href="#l9.16"></a><span id="l9.16"> 	@$(MAKE) -C mail/installer source-upload</span>
<a href="#l9.17"></a><span id="l9.17"> </span>
<a href="#l9.18"></a><span id="l9.18"> hg-bundle::</span>
<a href="#l9.19"></a><span id="l9.19"> 	@$(MAKE) -C mail/installer hg-bundle</span>
<a href="#l9.20"></a><span id="l9.20"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mail/config/mozconfigs/linux32/l10n-mozconfig</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mail/config/mozconfigs/linux32/l10n-mozconfig</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -1,15 +1,18 @@</span>
<a href="#l10.4"></a><span id="l10.4"> ac_add_options --enable-application=mail</span>
<a href="#l10.5"></a><span id="l10.5"> ac_add_options --enable-update-channel=${MOZ_UPDATE_CHANNEL}</span>
<a href="#l10.6"></a><span id="l10.6"> ac_add_options --enable-update-packaging</span>
<a href="#l10.7"></a><span id="l10.7"> ac_add_options --enable-codesighs</span>
<a href="#l10.8"></a><span id="l10.8"> ac_add_options --enable-profiling</span>
<a href="#l10.9"></a><span id="l10.9"> ac_add_options --with-l10n-base=../../l10n</span>
<a href="#l10.10"></a><span id="l10.10"> </span>
<a href="#l10.11"></a><span id="l10.11" class="difflineplus">+# Build lightning locales</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineplus">+ac_add_options --enable-calendar</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+</span>
<a href="#l10.14"></a><span id="l10.14"> # Temporary options until bug 794378 is fixed</span>
<a href="#l10.15"></a><span id="l10.15"> ac_add_options --enable-gnomevfs</span>
<a href="#l10.16"></a><span id="l10.16"> ac_add_options --disable-gio</span>
<a href="#l10.17"></a><span id="l10.17"> </span>
<a href="#l10.18"></a><span id="l10.18"> . $topsrcdir/build/unix/mozconfig.linux32</span>
<a href="#l10.19"></a><span id="l10.19"> </span>
<a href="#l10.20"></a><span id="l10.20"> # Avoid dependency on libstdc++ 4.5</span>
<a href="#l10.21"></a><span id="l10.21"> ac_add_options --enable-stdcxx-compat</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mail/config/mozconfigs/linux64/l10n-mozconfig</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mail/config/mozconfigs/linux64/l10n-mozconfig</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -1,15 +1,18 @@</span>
<a href="#l11.4"></a><span id="l11.4"> ac_add_options --enable-application=mail</span>
<a href="#l11.5"></a><span id="l11.5"> ac_add_options --enable-update-channel=${MOZ_UPDATE_CHANNEL}</span>
<a href="#l11.6"></a><span id="l11.6"> ac_add_options --enable-update-packaging</span>
<a href="#l11.7"></a><span id="l11.7"> ac_add_options --enable-codesighs</span>
<a href="#l11.8"></a><span id="l11.8"> ac_add_options --enable-profiling</span>
<a href="#l11.9"></a><span id="l11.9"> ac_add_options --with-l10n-base=../../l10n</span>
<a href="#l11.10"></a><span id="l11.10"> </span>
<a href="#l11.11"></a><span id="l11.11" class="difflineplus">+# Build lightning locales</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineplus">+ac_add_options --enable-calendar</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+</span>
<a href="#l11.14"></a><span id="l11.14"> # Temporary options until bug 794378 is fixed</span>
<a href="#l11.15"></a><span id="l11.15"> ac_add_options --enable-gnomevfs</span>
<a href="#l11.16"></a><span id="l11.16"> ac_add_options --disable-gio</span>
<a href="#l11.17"></a><span id="l11.17"> </span>
<a href="#l11.18"></a><span id="l11.18"> . $topsrcdir/build/unix/mozconfig.linux</span>
<a href="#l11.19"></a><span id="l11.19"> </span>
<a href="#l11.20"></a><span id="l11.20"> # Avoid dependency on libstdc++ 4.5</span>
<a href="#l11.21"></a><span id="l11.21"> ac_add_options --enable-stdcxx-compat</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mail/config/mozconfigs/macosx-universal/l10n-mozconfig</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mail/config/mozconfigs/macosx-universal/l10n-mozconfig</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -13,18 +13,19 @@ fi</span>
<a href="#l12.4"></a><span id="l12.4"> ac_add_options --enable-application=mail</span>
<a href="#l12.5"></a><span id="l12.5"> ac_add_options --enable-update-channel=${MOZ_UPDATE_CHANNEL}</span>
<a href="#l12.6"></a><span id="l12.6"> ac_add_options --enable-update-packaging</span>
<a href="#l12.7"></a><span id="l12.7"> ac_add_options --enable-codesighs</span>
<a href="#l12.8"></a><span id="l12.8"> ac_add_options --disable-install-strip</span>
<a href="#l12.9"></a><span id="l12.9"> ac_add_options --enable-profiling</span>
<a href="#l12.10"></a><span id="l12.10"> ac_add_options --with-l10n-base=../../../l10n</span>
<a href="#l12.11"></a><span id="l12.11"> </span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-# Make sure Lightning is also unified</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-#mk_add_options MOZ_POSTFLIGHT_ALL+=calendar/lightning/build/universal.mk</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+# Build lightning locales</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+ac_add_options --enable-calendar</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+mk_add_options MOZ_POSTFLIGHT_ALL+=calendar/lightning/build/universal.mk</span>
<a href="#l12.17"></a><span id="l12.17"> </span>
<a href="#l12.18"></a><span id="l12.18"> # For NSS symbols</span>
<a href="#l12.19"></a><span id="l12.19"> export MOZ_DEBUG_SYMBOLS=1</span>
<a href="#l12.20"></a><span id="l12.20"> </span>
<a href="#l12.21"></a><span id="l12.21"> # Needed to enable breakpad in application.ini</span>
<a href="#l12.22"></a><span id="l12.22"> export MOZILLA_OFFICIAL=1</span>
<a href="#l12.23"></a><span id="l12.23"> </span>
<a href="#l12.24"></a><span id="l12.24"> # Enable parallel compiling</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mail/config/mozconfigs/win32/l10n-mozconfig</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mail/config/mozconfigs/win32/l10n-mozconfig</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -2,16 +2,19 @@</span>
<a href="#l13.4"></a><span id="l13.4"> </span>
<a href="#l13.5"></a><span id="l13.5"> ac_add_options --enable-application=mail</span>
<a href="#l13.6"></a><span id="l13.6"> ac_add_options --enable-update-channel=${MOZ_UPDATE_CHANNEL}</span>
<a href="#l13.7"></a><span id="l13.7"> ac_add_options --enable-update-packaging</span>
<a href="#l13.8"></a><span id="l13.8"> ac_add_options --enable-jemalloc</span>
<a href="#l13.9"></a><span id="l13.9"> ac_add_options --enable-profiling</span>
<a href="#l13.10"></a><span id="l13.10"> ac_add_options --with-l10n-base=../../l10n</span>
<a href="#l13.11"></a><span id="l13.11"> </span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+# Build lightning locales</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+ac_add_options --enable-calendar</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineplus">+</span>
<a href="#l13.15"></a><span id="l13.15"> # For NSS symbols</span>
<a href="#l13.16"></a><span id="l13.16"> export MOZ_DEBUG_SYMBOLS=1</span>
<a href="#l13.17"></a><span id="l13.17"> </span>
<a href="#l13.18"></a><span id="l13.18"> # Needed to enable breakpad in application.ini</span>
<a href="#l13.19"></a><span id="l13.19"> export MOZILLA_OFFICIAL=1</span>
<a href="#l13.20"></a><span id="l13.20"> </span>
<a href="#l13.21"></a><span id="l13.21"> if test -n &quot;${_PYMAKE}&quot;; then</span>
<a href="#l13.22"></a><span id="l13.22">   mk_add_options MOZ_MAKE_FLAGS=-j4</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mail/config/mozconfigs/win64/l10n-mozconfig</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mail/config/mozconfigs/win64/l10n-mozconfig</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -4,16 +4,19 @@ ac_add_options --target=x86_64-pc-mingw3</span>
<a href="#l14.4"></a><span id="l14.4"> ac_add_options --host=x86_64-pc-mingw32</span>
<a href="#l14.5"></a><span id="l14.5"> </span>
<a href="#l14.6"></a><span id="l14.6"> ac_add_options --enable-application=mail</span>
<a href="#l14.7"></a><span id="l14.7"> ac_add_options --enable-update-channel=${MOZ_UPDATE_CHANNEL}</span>
<a href="#l14.8"></a><span id="l14.8"> ac_add_options --enable-update-packaging</span>
<a href="#l14.9"></a><span id="l14.9"> ac_add_options --enable-jemalloc</span>
<a href="#l14.10"></a><span id="l14.10"> ac_add_options --enable-profiling</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineplus">+# Build lightning locales</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+ac_add_options --enable-calendar</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineplus">+</span>
<a href="#l14.15"></a><span id="l14.15"> # Needed to enable breakpad in application.ini</span>
<a href="#l14.16"></a><span id="l14.16"> export MOZILLA_OFFICIAL=1</span>
<a href="#l14.17"></a><span id="l14.17"> </span>
<a href="#l14.18"></a><span id="l14.18"> if test -n &quot;${_PYMAKE}&quot;; then</span>
<a href="#l14.19"></a><span id="l14.19">   mk_add_options MOZ_MAKE_FLAGS=-j4</span>
<a href="#l14.20"></a><span id="l14.20"> else</span>
<a href="#l14.21"></a><span id="l14.21">   mk_add_options MOZ_MAKE_FLAGS=-j1</span>
<a href="#l14.22"></a><span id="l14.22"> fi</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mail/locales/Makefile.in</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mail/locales/Makefile.in</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -123,23 +123,16 @@ clobber-zip:</span>
<a href="#l15.4"></a><span id="l15.4"> 	$(RM) -rf $(STAGEDIST)/searchplugins \</span>
<a href="#l15.5"></a><span id="l15.5"> 	  $(STAGEDIST)/dictionaries \</span>
<a href="#l15.6"></a><span id="l15.6"> 	  $(STAGEDIST)/hyphenation/$(AB_CD) \</span>
<a href="#l15.7"></a><span id="l15.7"> 	  $(STAGEDIST)/isp/$(AB_CD) \</span>
<a href="#l15.8"></a><span id="l15.8"> 	  $(STAGEDIST)/chrome/$(AB_CD)</span>
<a href="#l15.9"></a><span id="l15.9"> </span>
<a href="#l15.10"></a><span id="l15.10"> langpack: langpack-$(AB_CD)</span>
<a href="#l15.11"></a><span id="l15.11"> </span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-# This is a generic target that will make a langpack, repack ZIP (+tarball)</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-# builds, and repack and installer if applicable. It is called from the</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineminus">-# tinderbox scripts. Alter it with caution.</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">-</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineminus">-installers-%: clobber-% langpack-% repackage-win32-installer-% repackage-zip-%</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineminus">-	@echo &quot;repackaging done&quot;</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineminus">-</span>
<a href="#l15.19"></a><span id="l15.19"> ifdef MOZ_UPDATER</span>
<a href="#l15.20"></a><span id="l15.20"> libs:: $(call MERGE_FILE,updater/updater.ini) $(call mkdir_deps,$(DIST)/bin)</span>
<a href="#l15.21"></a><span id="l15.21"> ifeq ($(OS_ARCH),WINNT)</span>
<a href="#l15.22"></a><span id="l15.22"> 	cat $&lt; $(srcdir)/../installer/windows/nsis/updater_append.ini | \</span>
<a href="#l15.23"></a><span id="l15.23"> 	  sed -e &quot;s/^InfoText=/Info=/&quot; -e &quot;s/^TitleText=/Title=/&quot; | \</span>
<a href="#l15.24"></a><span id="l15.24"> 	  sed -e &quot;s/%MOZ_APP_DISPLAYNAME%/$(MOZ_APP_DISPLAYNAME)/&quot; &gt; \</span>
<a href="#l15.25"></a><span id="l15.25"> 	  $(FINAL_TARGET)/updater.ini</span>
<a href="#l15.26"></a><span id="l15.26"> else</span>
<a href="#l15.27"></a><span id="l15.27" class="difflineat">@@ -196,8 +189,43 @@ endif</span>
<a href="#l15.28"></a><span id="l15.28"> 	chmod -vR 775 $(UPLOAD_DIR)</span>
<a href="#l15.29"></a><span id="l15.29"> </span>
<a href="#l15.30"></a><span id="l15.30"> merge-%:</span>
<a href="#l15.31"></a><span id="l15.31"> ifdef LOCALE_MERGEDIR</span>
<a href="#l15.32"></a><span id="l15.32"> 	$(RM) -rf $(LOCALE_MERGEDIR)</span>
<a href="#l15.33"></a><span id="l15.33"> 	MACOSX_DEPLOYMENT_TARGET= compare-locales -m $(LOCALE_MERGEDIR) $(srcdir)/l10n.ini $(L10NBASEDIR) $*</span>
<a href="#l15.34"></a><span id="l15.34"> endif</span>
<a href="#l15.35"></a><span id="l15.35"> 	@echo</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineplus">+</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineplus">+ifdef MOZ_CALENDAR</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineplus">+LIGHTNING_PATH=$(DEPTH)/calendar/lightning</span>
<a href="#l15.39"></a><span id="l15.39" class="difflineplus">+GDATA_PATH=$(DEPTH)/calendar/providers/gdata</span>
<a href="#l15.40"></a><span id="l15.40" class="difflineplus">+</span>
<a href="#l15.41"></a><span id="l15.41" class="difflineplus">+# Define hooks for forwarding targets</span>
<a href="#l15.42"></a><span id="l15.42" class="difflineplus">+INSTALLERS_TARGETS += calendar-clobber-% calendar-langpack-% calendar-repackage-zip-%</span>
<a href="#l15.43"></a><span id="l15.43" class="difflineplus">+FORWARD_TARGETS=wget-en-US unpack</span>
<a href="#l15.44"></a><span id="l15.44" class="difflineplus">+FORWARD_PATTERN_TARGETS=clobber-% langpack-% repackage-zip-%</span>
<a href="#l15.45"></a><span id="l15.45" class="difflineplus">+</span>
<a href="#l15.46"></a><span id="l15.46" class="difflineplus">+# Add calendar targets to the non-pattern rules</span>
<a href="#l15.47"></a><span id="l15.47" class="difflineplus">+wget-en-US: calendar-wget-en-US</span>
<a href="#l15.48"></a><span id="l15.48" class="difflineplus">+unpack: calendar-unpack</span>
<a href="#l15.49"></a><span id="l15.49" class="difflineplus">+upload: calendar-upload</span>
<a href="#l15.50"></a><span id="l15.50" class="difflineplus">+</span>
<a href="#l15.51"></a><span id="l15.51" class="difflineplus">+# And finally, define the calendar targets</span>
<a href="#l15.52"></a><span id="l15.52" class="difflineplus">+$(addprefix calendar-,$(FORWARD_TARGETS)):</span>
<a href="#l15.53"></a><span id="l15.53" class="difflineplus">+	$(MAKE) -C $(LIGHTNING_PATH) $(subst calendar-,,$@)</span>
<a href="#l15.54"></a><span id="l15.54" class="difflineplus">+	# TODO temporarily disable gdata since it wasn't built $(MAKE) -C $(GDATA_PATH) $(subst calendar-,,$@)</span>
<a href="#l15.55"></a><span id="l15.55" class="difflineplus">+</span>
<a href="#l15.56"></a><span id="l15.56" class="difflineplus">+$(addprefix calendar-,$(FORWARD_PATTERN_TARGETS)):</span>
<a href="#l15.57"></a><span id="l15.57" class="difflineplus">+	$(MAKE) -C $(LIGHTNING_PATH) $(subst calendar-,,$@)</span>
<a href="#l15.58"></a><span id="l15.58" class="difflineplus">+	# TODO temporarily disable gdata since it wasn't built $(MAKE) -C $(GDATA_PATH) $(subst calendar-,,$@)</span>
<a href="#l15.59"></a><span id="l15.59" class="difflineplus">+</span>
<a href="#l15.60"></a><span id="l15.60" class="difflineplus">+calendar-upload:</span>
<a href="#l15.61"></a><span id="l15.61" class="difflineplus">+	$(MAKE) -C $(LIGHTNING_PATH) upload AB_CD=$(AB_CD)</span>
<a href="#l15.62"></a><span id="l15.62" class="difflineplus">+	# TODO temporarily disable gdata since it wasn't built $(MAKE) -C $(GDATA_PATH) upload AB_CD=$(AB_CD)</span>
<a href="#l15.63"></a><span id="l15.63" class="difflineplus">+endif</span>
<a href="#l15.64"></a><span id="l15.64" class="difflineplus">+</span>
<a href="#l15.65"></a><span id="l15.65" class="difflineplus">+# This is a generic target that will make a langpack, repack ZIP (+tarball)</span>
<a href="#l15.66"></a><span id="l15.66" class="difflineplus">+# builds, and repack and installer if applicable. It is called from the</span>
<a href="#l15.67"></a><span id="l15.67" class="difflineplus">+# tinderbox scripts. Alter it with caution.</span>
<a href="#l15.68"></a><span id="l15.68" class="difflineplus">+INSTALLERS_TARGETS += clobber-% langpack-% repackage-win32-installer-% repackage-zip-%</span>
<a href="#l15.69"></a><span id="l15.69" class="difflineplus">+installers-%: $(INSTALLERS_TARGETS)</span>
<a href="#l15.70"></a><span id="l15.70" class="difflineplus">+	@echo &quot;repackaging done&quot;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

