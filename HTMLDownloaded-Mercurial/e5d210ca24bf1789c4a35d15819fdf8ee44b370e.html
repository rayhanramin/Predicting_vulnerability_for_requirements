<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 19474:e5d210ca24bf1789c4a35d15819fdf8ee44b370e</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ e5d210ca24bf1789c4a35d15819fdf8ee44b370e" />
<meta property="og:url" content="/comm-central/rev/e5d210ca24bf1789c4a35d15819fdf8ee44b370e" />
<meta property="og:description" content="Bug 1249536 - Set default height of folder tree correctly and do the resize correctly. r=Ratty a=Ratty" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / e5d210ca24bf1789c4a35d15819fdf8ee44b370e 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/e5d210ca24bf1789c4a35d15819fdf8ee44b370e">shortlog</a> |
<a href="/comm-central/log/e5d210ca24bf1789c4a35d15819fdf8ee44b370e">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/e5d210ca24bf1789c4a35d15819fdf8ee44b370e">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/e5d210ca24bf1789c4a35d15819fdf8ee44b370e">files</a> |
changeset |
<a href="/comm-central/raw-rev/e5d210ca24bf1789c4a35d15819fdf8ee44b370e">raw</a>  | <a href="/comm-central/archive/e5d210ca24bf1789c4a35d15819fdf8ee44b370e.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1249536">Bug 1249536</a> - Set default height of folder tree correctly and do the resize correctly. r=Ratty a=Ratty
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#70;&#114;&#97;&#110;&#107;&#45;&#82;&#97;&#105;&#110;&#101;&#114;&#32;&#71;&#114;&#97;&#104;&#108;&#32;&#60;&#102;&#114;&#103;&#114;&#97;&#104;&#108;&#64;&#103;&#109;&#120;&#46;&#110;&#101;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Thu, 16 Jun 2016 21:07:10 +0200</td></tr>

<tr>
 <td>changeset 19474</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/e5d210ca24bf1789c4a35d15819fdf8ee44b370e">e5d210ca24bf1789c4a35d15819fdf8ee44b370e</a></td>
</tr>



<tr>
<td>parent 19473</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/2c129758f4292626a348dad13685014a734b280f">2c129758f4292626a348dad13685014a734b280f</a>
</td>
</tr>

<tr>
<td>child 19475</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/807d3b55d02e91e6091cbe19df272a29aed0ce97">807d3b55d02e91e6091cbe19df272a29aed0ce97</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=e5d210ca24bf1789c4a35d15819fdf8ee44b370e">11993</a></td></tr>
<tr><td>push user</td><td>frgrahl@gmx.net</td></tr>
<tr><td>push date</td><td class="date age">Thu, 16 Jun 2016 19:07:52 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@e5d210ca24bf [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=e5d210ca24bf1789c4a35d15819fdf8ee44b370e">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=e5d210ca24bf1789c4a35d15819fdf8ee44b370e&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=e5d210ca24bf1789c4a35d15819fdf8ee44b370e&newProject=comm-central&newRevision=e5d210ca24bf1789c4a35d15819fdf8ee44b370e&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=e5d210ca24bf1789c4a35d15819fdf8ee44b370e&newProject=comm-central&newRevision=e5d210ca24bf1789c4a35d15819fdf8ee44b370e&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=e5d210ca24bf1789c4a35d15819fdf8ee44b370e&newProject=comm-central&newRevision=e5d210ca24bf1789c4a35d15819fdf8ee44b370e&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28Ratty%29&revcount=50">Ratty</a>, <a href="/comm-central/log?rev=reviewer%28Ratty%29&revcount=50">Ratty</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1249536">1249536</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1199496">1199496</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1249536">Bug 1249536</a> - Set default height of folder tree correctly and do the resize correctly. r=Ratty a=Ratty
See <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1199496">Bug 1199496</a>.</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/browser/browser-prefs.js">suite/browser/browser-prefs.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/browser/browser-prefs.js">file</a> |
<a href="/comm-central/annotate/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/browser/browser-prefs.js">annotate</a> |
<a href="/comm-central/diff/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/browser/browser-prefs.js">diff</a> |
<a href="/comm-central/comparison/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/browser/browser-prefs.js">comparison</a> |
<a href="/comm-central/log/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/browser/browser-prefs.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/bm-props.js">suite/common/bookmarks/bm-props.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/bm-props.js">file</a> |
<a href="/comm-central/annotate/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/bm-props.js">annotate</a> |
<a href="/comm-central/diff/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/bm-props.js">diff</a> |
<a href="/comm-central/comparison/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/bm-props.js">comparison</a> |
<a href="/comm-central/log/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/bm-props.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/bm-props.xul">suite/common/bookmarks/bm-props.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/bm-props.xul">file</a> |
<a href="/comm-central/annotate/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/bm-props.xul">annotate</a> |
<a href="/comm-central/diff/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/bm-props.xul">diff</a> |
<a href="/comm-central/comparison/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/bm-props.xul">comparison</a> |
<a href="/comm-central/log/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/bm-props.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/editBookmarkOverlay.xul">suite/common/bookmarks/editBookmarkOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/editBookmarkOverlay.xul">file</a> |
<a href="/comm-central/annotate/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/editBookmarkOverlay.xul">annotate</a> |
<a href="/comm-central/diff/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/editBookmarkOverlay.xul">diff</a> |
<a href="/comm-central/comparison/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/editBookmarkOverlay.xul">comparison</a> |
<a href="/comm-central/log/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/bookmarks/editBookmarkOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/jar.mn">suite/common/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/jar.mn">file</a> |
<a href="/comm-central/annotate/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/jar.mn">annotate</a> |
<a href="/comm-central/diff/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/jar.mn">diff</a> |
<a href="/comm-central/comparison/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/jar.mn">comparison</a> |
<a href="/comm-central/log/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/common/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/modules/PlacesUIUtils.jsm">suite/modules/PlacesUIUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/modules/PlacesUIUtils.jsm">file</a> |
<a href="/comm-central/annotate/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/modules/PlacesUIUtils.jsm">annotate</a> |
<a href="/comm-central/diff/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/modules/PlacesUIUtils.jsm">diff</a> |
<a href="/comm-central/comparison/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/modules/PlacesUIUtils.jsm">comparison</a> |
<a href="/comm-central/log/e5d210ca24bf1789c4a35d15819fdf8ee44b370e/suite/modules/PlacesUIUtils.jsm">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/suite/browser/browser-prefs.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/suite/browser/browser-prefs.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -219,21 +219,19 @@ pref(&quot;places.frecency.unvisitedTypedBonu</span>
<a href="#l1.4"></a><span id="l1.4"> pref(&quot;browser.bookmarks.autoExportHTML&quot;, false);</span>
<a href="#l1.5"></a><span id="l1.5"> </span>
<a href="#l1.6"></a><span id="l1.6"> // The maximum number of daily bookmark backups to</span>
<a href="#l1.7"></a><span id="l1.7"> // keep in {PROFILEDIR}/bookmarkbackups. Special values:</span>
<a href="#l1.8"></a><span id="l1.8"> // -1: unlimited</span>
<a href="#l1.9"></a><span id="l1.9"> //  0: no backups created (and deletes all existing backups)</span>
<a href="#l1.10"></a><span id="l1.10"> pref(&quot;browser.bookmarks.max_backups&quot;, 10);</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-// Don't try to alter these prefs, they'll be reset the next time you use the</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+// Don't try to alter this pref. It will be reset the next time you use the</span>
<a href="#l1.14"></a><span id="l1.14"> // bookmarking dialog.</span>
<a href="#l1.15"></a><span id="l1.15"> pref(&quot;browser.bookmarks.editDialog.firstEditField&quot;, &quot;namePicker&quot;);</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineminus">-pref(&quot;browser.bookmarks.editDialog.expandTags&quot;, false);</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineminus">-pref(&quot;browser.bookmarks.editDialog.expandFolders&quot;, false);</span>
<a href="#l1.18"></a><span id="l1.18"> </span>
<a href="#l1.19"></a><span id="l1.19"> // Tabbed browser</span>
<a href="#l1.20"></a><span id="l1.20"> pref(&quot;browser.tabs.loadDivertedInBackground&quot;, false);</span>
<a href="#l1.21"></a><span id="l1.21"> pref(&quot;browser.tabs.loadInBackground&quot;, true);</span>
<a href="#l1.22"></a><span id="l1.22"> pref(&quot;browser.tabs.opentabfor.doubleclick&quot;, false);</span>
<a href="#l1.23"></a><span id="l1.23"> pref(&quot;browser.tabs.opentabfor.middleclick&quot;, true);</span>
<a href="#l1.24"></a><span id="l1.24"> pref(&quot;browser.tabs.opentabfor.urlbar&quot;, true);</span>
<a href="#l1.25"></a><span id="l1.25"> pref(&quot;browser.tabs.tooltippreview.enable&quot;, true);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/suite/common/bookmarks/bm-props.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/suite/common/bookmarks/bm-props.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -60,16 +60,18 @@</span>
<a href="#l2.4"></a><span id="l2.4"> </span>
<a href="#l2.5"></a><span id="l2.5"> const BOOKMARK_ITEM = 0;</span>
<a href="#l2.6"></a><span id="l2.6"> const BOOKMARK_FOLDER = 1;</span>
<a href="#l2.7"></a><span id="l2.7"> const LIVEMARK_CONTAINER = 2;</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9"> const ACTION_EDIT = 0;</span>
<a href="#l2.10"></a><span id="l2.10"> const ACTION_ADD = 1;</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+var elementsHeight = new Map();</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+</span>
<a href="#l2.14"></a><span id="l2.14"> var BookmarkPropertiesPanel = {</span>
<a href="#l2.15"></a><span id="l2.15"> </span>
<a href="#l2.16"></a><span id="l2.16">   /** UI Text Strings */</span>
<a href="#l2.17"></a><span id="l2.17">   __strings: null,</span>
<a href="#l2.18"></a><span id="l2.18">   get _strings() {</span>
<a href="#l2.19"></a><span id="l2.19">     if (!this.__strings) {</span>
<a href="#l2.20"></a><span id="l2.20">       this.__strings = document.getElementById(&quot;stringBundle&quot;);</span>
<a href="#l2.21"></a><span id="l2.21">     }</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineat">@@ -248,17 +250,16 @@ var BookmarkPropertiesPanel = {</span>
<a href="#l2.23"></a><span id="l2.23">                                .then(aLivemark =&gt; {</span>
<a href="#l2.24"></a><span id="l2.24">             this._itemType = LIVEMARK_CONTAINER;</span>
<a href="#l2.25"></a><span id="l2.25">             this._feedURI = aLivemark.feedURI;</span>
<a href="#l2.26"></a><span id="l2.26">             this._siteURI = aLivemark.siteURI;</span>
<a href="#l2.27"></a><span id="l2.27">             this._fillEditProperties();</span>
<a href="#l2.28"></a><span id="l2.28"> </span>
<a href="#l2.29"></a><span id="l2.29">             document.documentElement</span>
<a href="#l2.30"></a><span id="l2.30">                     .getButton(&quot;accept&quot;).disabled = !this._inputIsValid();</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineminus">-            window.outerHeight += this._element(&quot;nameRow&quot;).boxObject.height * 2;</span>
<a href="#l2.32"></a><span id="l2.32">           }, () =&gt; undefined);</span>
<a href="#l2.33"></a><span id="l2.33">       }</span>
<a href="#l2.34"></a><span id="l2.34"> </span>
<a href="#l2.35"></a><span id="l2.35">       // Description</span>
<a href="#l2.36"></a><span id="l2.36">       if (PlacesUtils.annotations</span>
<a href="#l2.37"></a><span id="l2.37">                      .itemHasAnnotation(this._itemId, PlacesUIUtils.DESCRIPTION_ANNO)) {</span>
<a href="#l2.38"></a><span id="l2.38">         this._description = PlacesUtils.annotations</span>
<a href="#l2.39"></a><span id="l2.39">                                        .getItemAnnotation(this._itemId,</span>
<a href="#l2.40"></a><span id="l2.40" class="difflineat">@@ -291,53 +292,70 @@ var BookmarkPropertiesPanel = {</span>
<a href="#l2.41"></a><span id="l2.41">    */</span>
<a href="#l2.42"></a><span id="l2.42">   onDialogLoad: function BPP_onDialogLoad() {</span>
<a href="#l2.43"></a><span id="l2.43">     this._determineItemInfo();</span>
<a href="#l2.44"></a><span id="l2.44"> </span>
<a href="#l2.45"></a><span id="l2.45">     document.title = this._getDialogTitle();</span>
<a href="#l2.46"></a><span id="l2.46">     var acceptButton = document.documentElement.getButton(&quot;accept&quot;);</span>
<a href="#l2.47"></a><span id="l2.47">     acceptButton.label = this._getAcceptLabel();</span>
<a href="#l2.48"></a><span id="l2.48"> </span>
<a href="#l2.49"></a><span id="l2.49" class="difflineplus">+    // Do not use sizeToContent, otherwise, due to bug 90276, the dialog will</span>
<a href="#l2.50"></a><span id="l2.50" class="difflineplus">+    // grow at every opening.</span>
<a href="#l2.51"></a><span id="l2.51" class="difflineplus">+    // Since elements can be uncollapsed asynchronously, we must observe their</span>
<a href="#l2.52"></a><span id="l2.52" class="difflineplus">+    // mutations and resize the dialog using a cached element size.</span>
<a href="#l2.53"></a><span id="l2.53" class="difflineplus">+    this._height = window.outerHeight;</span>
<a href="#l2.54"></a><span id="l2.54" class="difflineplus">+    this._mutationObserver = new MutationObserver(mutations =&gt; {</span>
<a href="#l2.55"></a><span id="l2.55" class="difflineplus">+      for (let mutation of mutations) {</span>
<a href="#l2.56"></a><span id="l2.56" class="difflineplus">+        let target = mutation.target;</span>
<a href="#l2.57"></a><span id="l2.57" class="difflineplus">+        let id = target.id;</span>
<a href="#l2.58"></a><span id="l2.58" class="difflineplus">+        if (!/^editBMPanel_.*(Row|Checkbox)$/.test(id))</span>
<a href="#l2.59"></a><span id="l2.59" class="difflineplus">+          continue;</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineplus">+</span>
<a href="#l2.61"></a><span id="l2.61" class="difflineplus">+        let collapsed = target.getAttribute(&quot;collapsed&quot;) == &quot;true&quot;;</span>
<a href="#l2.62"></a><span id="l2.62" class="difflineplus">+        let wasCollapsed = mutation.oldValue == &quot;true&quot;;</span>
<a href="#l2.63"></a><span id="l2.63" class="difflineplus">+        if (collapsed == wasCollapsed)</span>
<a href="#l2.64"></a><span id="l2.64" class="difflineplus">+          continue;</span>
<a href="#l2.65"></a><span id="l2.65" class="difflineplus">+</span>
<a href="#l2.66"></a><span id="l2.66" class="difflineplus">+        if (collapsed) {</span>
<a href="#l2.67"></a><span id="l2.67" class="difflineplus">+          this._height -= elementsHeight.get(id);</span>
<a href="#l2.68"></a><span id="l2.68" class="difflineplus">+          elementsHeight.delete(id);</span>
<a href="#l2.69"></a><span id="l2.69" class="difflineplus">+        } else {</span>
<a href="#l2.70"></a><span id="l2.70" class="difflineplus">+          elementsHeight.set(id, target.boxObject.height);</span>
<a href="#l2.71"></a><span id="l2.71" class="difflineplus">+          this._height += elementsHeight.get(id);</span>
<a href="#l2.72"></a><span id="l2.72" class="difflineplus">+        }</span>
<a href="#l2.73"></a><span id="l2.73" class="difflineplus">+      }</span>
<a href="#l2.74"></a><span id="l2.74" class="difflineplus">+      window.resizeTo(window.outerWidth, this._height);</span>
<a href="#l2.75"></a><span id="l2.75" class="difflineplus">+    });</span>
<a href="#l2.76"></a><span id="l2.76" class="difflineplus">+</span>
<a href="#l2.77"></a><span id="l2.77" class="difflineplus">+    this._mutationObserver.observe(document,</span>
<a href="#l2.78"></a><span id="l2.78" class="difflineplus">+                                   { attributes: true,</span>
<a href="#l2.79"></a><span id="l2.79" class="difflineplus">+                                     subtree: true,</span>
<a href="#l2.80"></a><span id="l2.80" class="difflineplus">+                                     attributeOldValue: true,</span>
<a href="#l2.81"></a><span id="l2.81" class="difflineplus">+                                     attributeFilter: [&quot;collapsed&quot;] });</span>
<a href="#l2.82"></a><span id="l2.82" class="difflineplus">+</span>
<a href="#l2.83"></a><span id="l2.83" class="difflineplus">+    // Some controls are flexible and we want to update their cached size when</span>
<a href="#l2.84"></a><span id="l2.84" class="difflineplus">+    // the dialog is resized.</span>
<a href="#l2.85"></a><span id="l2.85" class="difflineplus">+    window.addEventListener(&quot;resize&quot;, this);</span>
<a href="#l2.86"></a><span id="l2.86" class="difflineplus">+</span>
<a href="#l2.87"></a><span id="l2.87">     this._beginBatch();</span>
<a href="#l2.88"></a><span id="l2.88"> </span>
<a href="#l2.89"></a><span id="l2.89">     switch (this._action) {</span>
<a href="#l2.90"></a><span id="l2.90">       case ACTION_EDIT:</span>
<a href="#l2.91"></a><span id="l2.91">         this._fillEditProperties();</span>
<a href="#l2.92"></a><span id="l2.92">         acceptButton.disabled = this._readOnly;</span>
<a href="#l2.93"></a><span id="l2.93">         break;</span>
<a href="#l2.94"></a><span id="l2.94">       case ACTION_ADD:</span>
<a href="#l2.95"></a><span id="l2.95">         this._createNewItem().then(() =&gt; this._fillAddProperties());</span>
<a href="#l2.96"></a><span id="l2.96">         // if this is an uri related dialog disable accept button until</span>
<a href="#l2.97"></a><span id="l2.97">         // the user fills an uri value.</span>
<a href="#l2.98"></a><span id="l2.98">         if (this._itemType == BOOKMARK_ITEM)</span>
<a href="#l2.99"></a><span id="l2.99">           acceptButton.disabled = !this._inputIsValid();</span>
<a href="#l2.100"></a><span id="l2.100">         break;</span>
<a href="#l2.101"></a><span id="l2.101">     }</span>
<a href="#l2.102"></a><span id="l2.102"> </span>
<a href="#l2.103"></a><span id="l2.103" class="difflineminus">-    // When collapsible elements change their collapsed attribute we must</span>
<a href="#l2.104"></a><span id="l2.104" class="difflineminus">-    // resize the dialog.</span>
<a href="#l2.105"></a><span id="l2.105" class="difflineminus">-    var observer = new MutationObserver(function(aRecords, aObserver) {</span>
<a href="#l2.106"></a><span id="l2.106" class="difflineminus">-      var el = document.getElementById(&quot;editBookmarkPanelContent&quot;);</span>
<a href="#l2.107"></a><span id="l2.107" class="difflineminus">-      var width = el.boxObject.width;</span>
<a href="#l2.108"></a><span id="l2.108" class="difflineminus">-      window.sizeToContent();</span>
<a href="#l2.109"></a><span id="l2.109" class="difflineminus">-      window.outerWidth -= el.boxObject.width - width;</span>
<a href="#l2.110"></a><span id="l2.110" class="difflineminus">-    });</span>
<a href="#l2.111"></a><span id="l2.111" class="difflineminus">-    if (!this._element(&quot;tagsRow&quot;).collapsed) {</span>
<a href="#l2.112"></a><span id="l2.112" class="difflineminus">-      if (Services.prefs.getBoolPref(&quot;browser.bookmarks.editDialog.expandTags&quot;))</span>
<a href="#l2.113"></a><span id="l2.113" class="difflineminus">-        gEditItemOverlay.toggleTagsSelector();</span>
<a href="#l2.114"></a><span id="l2.114" class="difflineminus">-      observer.observe(this._element(&quot;tagsSelectorRow&quot;),</span>
<a href="#l2.115"></a><span id="l2.115" class="difflineminus">-                       {attributes: true, attributeFilter: [&quot;collapsed&quot;]});</span>
<a href="#l2.116"></a><span id="l2.116" class="difflineminus">-    }</span>
<a href="#l2.117"></a><span id="l2.117" class="difflineminus">-    if (!this._element(&quot;folderRow&quot;).collapsed) {</span>
<a href="#l2.118"></a><span id="l2.118" class="difflineminus">-      if (Services.prefs.getBoolPref(&quot;browser.bookmarks.editDialog.expandFolders&quot;))</span>
<a href="#l2.119"></a><span id="l2.119" class="difflineminus">-        gEditItemOverlay.toggleFolderTreeVisibility();</span>
<a href="#l2.120"></a><span id="l2.120" class="difflineminus">-      observer.observe(this._element(&quot;folderTreeRow&quot;),</span>
<a href="#l2.121"></a><span id="l2.121" class="difflineminus">-                       {attributes: true, attributeFilter: [&quot;collapsed&quot;]});</span>
<a href="#l2.122"></a><span id="l2.122" class="difflineminus">-    }</span>
<a href="#l2.123"></a><span id="l2.123" class="difflineminus">-</span>
<a href="#l2.124"></a><span id="l2.124">     if (!this._readOnly) {</span>
<a href="#l2.125"></a><span id="l2.125">       // Listen on uri fields to enable accept button if input is valid</span>
<a href="#l2.126"></a><span id="l2.126">       if (this._itemType == BOOKMARK_ITEM) {</span>
<a href="#l2.127"></a><span id="l2.127">         this._element(&quot;locationField&quot;)</span>
<a href="#l2.128"></a><span id="l2.128">             .addEventListener(&quot;input&quot;, this, false);</span>
<a href="#l2.129"></a><span id="l2.129">         if (this._isAddKeywordDialog) {</span>
<a href="#l2.130"></a><span id="l2.130">           this._element(&quot;keywordField&quot;)</span>
<a href="#l2.131"></a><span id="l2.131">               .addEventListener(&quot;input&quot;, this, false);</span>
<a href="#l2.132"></a><span id="l2.132" class="difflineat">@@ -345,43 +363,40 @@ var BookmarkPropertiesPanel = {</span>
<a href="#l2.133"></a><span id="l2.133">       }</span>
<a href="#l2.134"></a><span id="l2.134">       else if (this._itemType == LIVEMARK_CONTAINER) {</span>
<a href="#l2.135"></a><span id="l2.135">         this._element(&quot;feedLocationField&quot;)</span>
<a href="#l2.136"></a><span id="l2.136">             .addEventListener(&quot;input&quot;, this, false);</span>
<a href="#l2.137"></a><span id="l2.137">         this._element(&quot;siteLocationField&quot;)</span>
<a href="#l2.138"></a><span id="l2.138">             .addEventListener(&quot;input&quot;, this, false);</span>
<a href="#l2.139"></a><span id="l2.139">       }</span>
<a href="#l2.140"></a><span id="l2.140">     }</span>
<a href="#l2.141"></a><span id="l2.141" class="difflineminus">-</span>
<a href="#l2.142"></a><span id="l2.142" class="difflineminus">-    window.sizeToContent();</span>
<a href="#l2.143"></a><span id="l2.143" class="difflineminus">-    window.addEventListener(&quot;resize&quot;, this, false);</span>
<a href="#l2.144"></a><span id="l2.144">   },</span>
<a href="#l2.145"></a><span id="l2.145"> </span>
<a href="#l2.146"></a><span id="l2.146">   // nsIDOMEventListener</span>
<a href="#l2.147"></a><span id="l2.147">   handleEvent: function BPP_handleEvent(aEvent) {</span>
<a href="#l2.148"></a><span id="l2.148">     var target = aEvent.target;</span>
<a href="#l2.149"></a><span id="l2.149">     switch (aEvent.type) {</span>
<a href="#l2.150"></a><span id="l2.150">       case &quot;input&quot;:</span>
<a href="#l2.151"></a><span id="l2.151">         if (target.id == &quot;editBMPanel_locationField&quot; ||</span>
<a href="#l2.152"></a><span id="l2.152">             target.id == &quot;editBMPanel_feedLocationField&quot; ||</span>
<a href="#l2.153"></a><span id="l2.153">             target.id == &quot;editBMPanel_siteLocationField&quot; ||</span>
<a href="#l2.154"></a><span id="l2.154">             target.id == &quot;editBMPanel_keywordField&quot;) {</span>
<a href="#l2.155"></a><span id="l2.155">           // Check uri fields to enable accept button if input is valid</span>
<a href="#l2.156"></a><span id="l2.156">           document.documentElement</span>
<a href="#l2.157"></a><span id="l2.157">                   .getButton(&quot;accept&quot;).disabled = !this._inputIsValid();</span>
<a href="#l2.158"></a><span id="l2.158">         }</span>
<a href="#l2.159"></a><span id="l2.159">         break;</span>
<a href="#l2.160"></a><span id="l2.160" class="difflineplus">+      case &quot;resize&quot;:</span>
<a href="#l2.161"></a><span id="l2.161" class="difflineplus">+        for (let [id, oldHeight] of elementsHeight) {</span>
<a href="#l2.162"></a><span id="l2.162" class="difflineplus">+          let newHeight = document.getElementById(id).boxObject.height;</span>
<a href="#l2.163"></a><span id="l2.163" class="difflineplus">+          this._height += - oldHeight + newHeight;</span>
<a href="#l2.164"></a><span id="l2.164" class="difflineplus">+          elementsHeight.set(id, newHeight);</span>
<a href="#l2.165"></a><span id="l2.165" class="difflineplus">+        break;</span>
<a href="#l2.166"></a><span id="l2.166" class="difflineplus">+    }</span>
<a href="#l2.167"></a><span id="l2.167"> </span>
<a href="#l2.168"></a><span id="l2.168" class="difflineminus">-      case &quot;resize&quot;:</span>
<a href="#l2.169"></a><span id="l2.169" class="difflineminus">-        [&quot;folderTree&quot;, &quot;tagsSelector&quot;, &quot;description&quot;].forEach(function(e) {</span>
<a href="#l2.170"></a><span id="l2.170" class="difflineminus">-          var el = document.getElementById(&quot;editBMPanel_&quot; + e + &quot;Row&quot;);</span>
<a href="#l2.171"></a><span id="l2.171" class="difflineminus">-          if (el.boxObject.height)</span>
<a href="#l2.172"></a><span id="l2.172" class="difflineminus">-            el.height = el.boxObject.height;</span>
<a href="#l2.173"></a><span id="l2.173" class="difflineminus">-        });</span>
<a href="#l2.174"></a><span id="l2.174" class="difflineminus">-        break;</span>
<a href="#l2.175"></a><span id="l2.175">     }</span>
<a href="#l2.176"></a><span id="l2.176">   },</span>
<a href="#l2.177"></a><span id="l2.177"> </span>
<a href="#l2.178"></a><span id="l2.178">   _beginBatch: function BPP__beginBatch() {</span>
<a href="#l2.179"></a><span id="l2.179">     if (this._batching)</span>
<a href="#l2.180"></a><span id="l2.180">       return;</span>
<a href="#l2.181"></a><span id="l2.181"> </span>
<a href="#l2.182"></a><span id="l2.182">     PlacesUtils.transactionManager.beginBatch(null);</span>
<a href="#l2.183"></a><span id="l2.183" class="difflineat">@@ -407,52 +422,47 @@ var BookmarkPropertiesPanel = {</span>
<a href="#l2.184"></a><span id="l2.184">     gEditItemOverlay.initPanel(this._itemId,</span>
<a href="#l2.185"></a><span id="l2.185">                                { hiddenRows: this._hiddenRows });</span>
<a href="#l2.186"></a><span id="l2.186">     // Empty location field if the uri is about:blank, this way inserting a new</span>
<a href="#l2.187"></a><span id="l2.187">     // url will be easier for the user, Accept button will be automatically</span>
<a href="#l2.188"></a><span id="l2.188">     // disabled by the input listener until the user fills the field.</span>
<a href="#l2.189"></a><span id="l2.189">     var locationField = this._element(&quot;locationField&quot;);</span>
<a href="#l2.190"></a><span id="l2.190">     if (locationField.value == &quot;about:blank&quot;)</span>
<a href="#l2.191"></a><span id="l2.191">       locationField.value = &quot;&quot;;</span>
<a href="#l2.192"></a><span id="l2.192" class="difflineminus">-    if (this._itemType == BOOKMARK_ITEM)</span>
<a href="#l2.193"></a><span id="l2.193" class="difflineminus">-      acceptButton.disabled = !this._inputIsValid();</span>
<a href="#l2.194"></a><span id="l2.194" class="difflineminus">-    window.sizeToContent();</span>
<a href="#l2.195"></a><span id="l2.195">   },</span>
<a href="#l2.196"></a><span id="l2.196"> </span>
<a href="#l2.197"></a><span id="l2.197">   // nsISupports</span>
<a href="#l2.198"></a><span id="l2.198">   QueryInterface: function BPP_QueryInterface(aIID) {</span>
<a href="#l2.199"></a><span id="l2.199">     if (aIID.equals(Components.interfaces.nsIDOMEventListener) ||</span>
<a href="#l2.200"></a><span id="l2.200">         aIID.equals(Components.interfaces.nsISupports))</span>
<a href="#l2.201"></a><span id="l2.201">       return this;</span>
<a href="#l2.202"></a><span id="l2.202"> </span>
<a href="#l2.203"></a><span id="l2.203">     throw Components.results.NS_NOINTERFACE;</span>
<a href="#l2.204"></a><span id="l2.204">   },</span>
<a href="#l2.205"></a><span id="l2.205"> </span>
<a href="#l2.206"></a><span id="l2.206">   _element: function BPP__element(aID) {</span>
<a href="#l2.207"></a><span id="l2.207">     return document.getElementById(&quot;editBMPanel_&quot; + aID);</span>
<a href="#l2.208"></a><span id="l2.208">   },</span>
<a href="#l2.209"></a><span id="l2.209"> </span>
<a href="#l2.210"></a><span id="l2.210">   onDialogUnload: function BPP_onDialogUnload() {</span>
<a href="#l2.211"></a><span id="l2.211" class="difflineplus">+</span>
<a href="#l2.212"></a><span id="l2.212" class="difflineplus">+  // gEditItemOverlay does not exist anymore here, so don't rely on it.</span>
<a href="#l2.213"></a><span id="l2.213" class="difflineplus">+    this._mutationObserver.disconnect();</span>
<a href="#l2.214"></a><span id="l2.214" class="difflineplus">+    delete this._mutationObserver;</span>
<a href="#l2.215"></a><span id="l2.215" class="difflineplus">+</span>
<a href="#l2.216"></a><span id="l2.216">     window.removeEventListener(&quot;resize&quot;, this, false);</span>
<a href="#l2.217"></a><span id="l2.217" class="difflineminus">-    // gEditItemOverlay does not exist anymore here, so don't rely on it.</span>
<a href="#l2.218"></a><span id="l2.218">     // Calling removeEventListener with arguments which do not identify any</span>
<a href="#l2.219"></a><span id="l2.219">     // currently registered EventListener on the EventTarget has no effect.</span>
<a href="#l2.220"></a><span id="l2.220">     this._element(&quot;locationField&quot;)</span>
<a href="#l2.221"></a><span id="l2.221">         .removeEventListener(&quot;input&quot;, this, false);</span>
<a href="#l2.222"></a><span id="l2.222">     this._element(&quot;feedLocationField&quot;)</span>
<a href="#l2.223"></a><span id="l2.223">         .removeEventListener(&quot;input&quot;, this, false);</span>
<a href="#l2.224"></a><span id="l2.224">     this._element(&quot;siteLocationField&quot;)</span>
<a href="#l2.225"></a><span id="l2.225">         .removeEventListener(&quot;input&quot;, this, false);</span>
<a href="#l2.226"></a><span id="l2.226"> </span>
<a href="#l2.227"></a><span id="l2.227" class="difflineminus">-    if (!this._element(&quot;tagsRow&quot;).collapsed)</span>
<a href="#l2.228"></a><span id="l2.228" class="difflineminus">-      Services.prefs.setBoolPref(&quot;browser.bookmarks.editDialog.expandTags&quot;,</span>
<a href="#l2.229"></a><span id="l2.229" class="difflineminus">-                                 !this._element(&quot;tagsSelectorRow&quot;).collapsed);</span>
<a href="#l2.230"></a><span id="l2.230" class="difflineminus">-    if (!this._element(&quot;folderRow&quot;).collapsed)</span>
<a href="#l2.231"></a><span id="l2.231" class="difflineminus">-      Services.prefs.setBoolPref(&quot;browser.bookmarks.editDialog.expandFolders&quot;,</span>
<a href="#l2.232"></a><span id="l2.232" class="difflineminus">-                                 !this._element(&quot;folderTreeRow&quot;).collapsed);</span>
<a href="#l2.233"></a><span id="l2.233">   },</span>
<a href="#l2.234"></a><span id="l2.234"> </span>
<a href="#l2.235"></a><span id="l2.235">   onDialogAccept: function BPP_onDialogAccept() {</span>
<a href="#l2.236"></a><span id="l2.236">     // We must blur current focused element to save its changes correctly</span>
<a href="#l2.237"></a><span id="l2.237">     document.commandDispatcher.focusedElement.blur();</span>
<a href="#l2.238"></a><span id="l2.238">     // The order here is important! We have to uninit the panel first, otherwise</span>
<a href="#l2.239"></a><span id="l2.239">     // late changes could force it to commit more transactions.</span>
<a href="#l2.240"></a><span id="l2.240">     gEditItemOverlay.uninitPanel(false);</span>
<a href="#l2.241"></a><span id="l2.241" class="difflineat">@@ -571,17 +581,17 @@ var BookmarkPropertiesPanel = {</span>
<a href="#l2.242"></a><span id="l2.242">     for (var i = 0; i &lt; this._URIs.length; ++i) {</span>
<a href="#l2.243"></a><span id="l2.243">       var uri = this._URIs[i];</span>
<a href="#l2.244"></a><span id="l2.244">       var title = this._titles[i] || this._getURITitleFromHistory(uri);</span>
<a href="#l2.245"></a><span id="l2.245">       var createTxn = new PlacesCreateBookmarkTransaction(uri, -1,</span>
<a href="#l2.246"></a><span id="l2.246">                                                           PlacesUtils.bookmarks.DEFAULT_INDEX,</span>
<a href="#l2.247"></a><span id="l2.247">                                                           title);</span>
<a href="#l2.248"></a><span id="l2.248">       transactions.push(createTxn);</span>
<a href="#l2.249"></a><span id="l2.249">     }</span>
<a href="#l2.250"></a><span id="l2.250" class="difflineminus">-    return transactions; </span>
<a href="#l2.251"></a><span id="l2.251" class="difflineplus">+    return transactions;</span>
<a href="#l2.252"></a><span id="l2.252">   },</span>
<a href="#l2.253"></a><span id="l2.253"> </span>
<a href="#l2.254"></a><span id="l2.254">   /**</span>
<a href="#l2.255"></a><span id="l2.255">    * Returns a transaction for creating a new folder item representing the</span>
<a href="#l2.256"></a><span id="l2.256">    * various fields and opening arguments of the dialog.</span>
<a href="#l2.257"></a><span id="l2.257">    */</span>
<a href="#l2.258"></a><span id="l2.258">   _getCreateNewFolderTransaction:</span>
<a href="#l2.259"></a><span id="l2.259">   function BPP__getCreateNewFolderTransaction(aContainer, aIndex) {</span>
<a href="#l2.260"></a><span id="l2.260" class="difflineat">@@ -617,17 +627,17 @@ var BookmarkPropertiesPanel = {</span>
<a href="#l2.261"></a><span id="l2.261">     var txn;</span>
<a href="#l2.262"></a><span id="l2.262"> </span>
<a href="#l2.263"></a><span id="l2.263">     switch (this._itemType) {</span>
<a href="#l2.264"></a><span id="l2.264">       case BOOKMARK_FOLDER:</span>
<a href="#l2.265"></a><span id="l2.265">         txn = this._getCreateNewFolderTransaction(container, index);</span>
<a href="#l2.266"></a><span id="l2.266">         break;</span>
<a href="#l2.267"></a><span id="l2.267">       case LIVEMARK_CONTAINER:</span>
<a href="#l2.268"></a><span id="l2.268">         txn = this._getCreateNewLivemarkTransaction(container, index);</span>
<a href="#l2.269"></a><span id="l2.269" class="difflineminus">-        break;      </span>
<a href="#l2.270"></a><span id="l2.270" class="difflineplus">+        break;</span>
<a href="#l2.271"></a><span id="l2.271">       default: // BOOKMARK_ITEM</span>
<a href="#l2.272"></a><span id="l2.272">         txn = this._getCreateNewBookmarkTransaction(container, index);</span>
<a href="#l2.273"></a><span id="l2.273">     }</span>
<a href="#l2.274"></a><span id="l2.274"> </span>
<a href="#l2.275"></a><span id="l2.275">     PlacesUtils.transactionManager.doTransaction(txn);</span>
<a href="#l2.276"></a><span id="l2.276">     var promise = txn._promise || {</span>
<a href="#l2.277"></a><span id="l2.277">       then: function(callback) {</span>
<a href="#l2.278"></a><span id="l2.278">         callback();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/suite/common/bookmarks/bm-props.xul</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/suite/common/bookmarks/bm-props.xul</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -21,23 +21,23 @@</span>
<a href="#l3.4"></a><span id="l3.4">         buttons=&quot;accept, cancel&quot;</span>
<a href="#l3.5"></a><span id="l3.5">         buttoniconaccept=&quot;save&quot;</span>
<a href="#l3.6"></a><span id="l3.6">         ondialogaccept=&quot;BookmarkPropertiesPanel.onDialogAccept();&quot;</span>
<a href="#l3.7"></a><span id="l3.7">         ondialogcancel=&quot;BookmarkPropertiesPanel.onDialogCancel();&quot;</span>
<a href="#l3.8"></a><span id="l3.8">         xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l3.9"></a><span id="l3.9">         onload=&quot;BookmarkPropertiesPanel.onDialogLoad();&quot;</span>
<a href="#l3.10"></a><span id="l3.10">         onunload=&quot;BookmarkPropertiesPanel.onDialogUnload();&quot;</span>
<a href="#l3.11"></a><span id="l3.11">         style=&quot;min-width: 30em;&quot;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-        persist=&quot;screenX screenY width&quot;&gt;</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+        persist=&quot;screenX screenY height width&quot;&gt;</span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15">   &lt;stringbundleset id=&quot;stringbundleset&quot;&gt;</span>
<a href="#l3.16"></a><span id="l3.16">     &lt;stringbundle id=&quot;stringBundle&quot;</span>
<a href="#l3.17"></a><span id="l3.17">                   src=&quot;chrome://communicator/locale/bookmarks/bm-props.properties&quot;/&gt;</span>
<a href="#l3.18"></a><span id="l3.18">   &lt;/stringbundleset&gt;</span>
<a href="#l3.19"></a><span id="l3.19"> </span>
<a href="#l3.20"></a><span id="l3.20">   &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l3.21"></a><span id="l3.21">           src=&quot;chrome://communicator/content/bookmarks/editBookmarkOverlay.js&quot;/&gt;</span>
<a href="#l3.22"></a><span id="l3.22">   &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l3.23"></a><span id="l3.23">           src=&quot;chrome://communicator/content/bookmarks/bm-props.js&quot;/&gt;</span>
<a href="#l3.24"></a><span id="l3.24"> </span>
<a href="#l3.25"></a><span id="l3.25" class="difflineminus">-&lt;vbox id=&quot;editBookmarkPanelContent&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineplus">+&lt;vbox id=&quot;editBookmarkPanelContent&quot;/&gt;</span>
<a href="#l3.27"></a><span id="l3.27"> </span>
<a href="#l3.28"></a><span id="l3.28"> &lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/suite/common/bookmarks/editBookmarkOverlay.xul</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/suite/common/bookmarks/editBookmarkOverlay.xul</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -23,62 +23,72 @@</span>
<a href="#l4.4"></a><span id="l4.4">     &lt;/hbox&gt;</span>
<a href="#l4.5"></a><span id="l4.5"> </span>
<a href="#l4.6"></a><span id="l4.6">     &lt;grid id=&quot;editBookmarkPanelGrid&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l4.7"></a><span id="l4.7">       &lt;columns id=&quot;editBMPanel_columns&quot;&gt;</span>
<a href="#l4.8"></a><span id="l4.8">         &lt;column id=&quot;editBMPanel_labelColumn&quot; /&gt;</span>
<a href="#l4.9"></a><span id="l4.9">         &lt;column flex=&quot;1&quot; id=&quot;editBMPanel_editColumn&quot; /&gt;</span>
<a href="#l4.10"></a><span id="l4.10">       &lt;/columns&gt;</span>
<a href="#l4.11"></a><span id="l4.11">       &lt;rows id=&quot;editBMPanel_rows&quot;&gt;</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-        &lt;row align=&quot;center&quot; id=&quot;editBMPanel_nameRow&quot;&gt;</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+        &lt;row id=&quot;editBMPanel_nameRow&quot;</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+             align=&quot;center&quot;</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+             collapsed=&quot;true&quot;&gt;</span>
<a href="#l4.16"></a><span id="l4.16">           &lt;label value=&quot;&amp;editBookmarkOverlay.name.label;&quot;</span>
<a href="#l4.17"></a><span id="l4.17">                  class=&quot;editBMPanel_rowLabel&quot;</span>
<a href="#l4.18"></a><span id="l4.18">                  accesskey=&quot;&amp;editBookmarkOverlay.name.accesskey;&quot;</span>
<a href="#l4.19"></a><span id="l4.19">                  control=&quot;editBMPanel_namePicker&quot;</span>
<a href="#l4.20"></a><span id="l4.20">                  observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.21"></a><span id="l4.21">           &lt;textbox id=&quot;editBMPanel_namePicker&quot;</span>
<a href="#l4.22"></a><span id="l4.22">                    onblur=&quot;gEditItemOverlay.onNamePickerChange();&quot;</span>
<a href="#l4.23"></a><span id="l4.23">                    observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.24"></a><span id="l4.24">         &lt;/row&gt;</span>
<a href="#l4.25"></a><span id="l4.25"> </span>
<a href="#l4.26"></a><span id="l4.26" class="difflineminus">-        &lt;row align=&quot;center&quot; id=&quot;editBMPanel_locationRow&quot;&gt;</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineplus">+        &lt;row id=&quot;editBMPanel_locationRow&quot;</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineplus">+             align=&quot;center&quot;</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineplus">+             collapsed=&quot;true&quot;&gt;</span>
<a href="#l4.30"></a><span id="l4.30">           &lt;label value=&quot;&amp;editBookmarkOverlay.location.label;&quot;</span>
<a href="#l4.31"></a><span id="l4.31">                  class=&quot;editBMPanel_rowLabel&quot;</span>
<a href="#l4.32"></a><span id="l4.32">                  accesskey=&quot;&amp;editBookmarkOverlay.location.accesskey;&quot;</span>
<a href="#l4.33"></a><span id="l4.33">                  control=&quot;editBMPanel_locationField&quot;</span>
<a href="#l4.34"></a><span id="l4.34">                  observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.35"></a><span id="l4.35">           &lt;textbox id=&quot;editBMPanel_locationField&quot;</span>
<a href="#l4.36"></a><span id="l4.36">                    class=&quot;uri-element&quot;</span>
<a href="#l4.37"></a><span id="l4.37">                    onblur=&quot;gEditItemOverlay.onLocationFieldBlur();&quot;</span>
<a href="#l4.38"></a><span id="l4.38">                    observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.39"></a><span id="l4.39">         &lt;/row&gt;</span>
<a href="#l4.40"></a><span id="l4.40"> </span>
<a href="#l4.41"></a><span id="l4.41" class="difflineminus">-        &lt;row align=&quot;center&quot; id=&quot;editBMPanel_feedLocationRow&quot;&gt;</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+        &lt;row id=&quot;editBMPanel_feedLocationRow&quot;</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+             align=&quot;center&quot;</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineplus">+             collapsed=&quot;true&quot;&gt;</span>
<a href="#l4.45"></a><span id="l4.45">           &lt;label value=&quot;&amp;editBookmarkOverlay.feedLocation.label;&quot;</span>
<a href="#l4.46"></a><span id="l4.46">                  class=&quot;editBMPanel_rowLabel&quot;</span>
<a href="#l4.47"></a><span id="l4.47">                  accesskey=&quot;&amp;editBookmarkOverlay.feedLocation.accesskey;&quot;</span>
<a href="#l4.48"></a><span id="l4.48">                  control=&quot;editBMPanel_feedLocationField&quot;</span>
<a href="#l4.49"></a><span id="l4.49">                  observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.50"></a><span id="l4.50">           &lt;textbox id=&quot;editBMPanel_feedLocationField&quot;</span>
<a href="#l4.51"></a><span id="l4.51">                    class=&quot;uri-element&quot;</span>
<a href="#l4.52"></a><span id="l4.52">                    observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.53"></a><span id="l4.53">         &lt;/row&gt;</span>
<a href="#l4.54"></a><span id="l4.54"> </span>
<a href="#l4.55"></a><span id="l4.55" class="difflineminus">-        &lt;row align=&quot;center&quot; id=&quot;editBMPanel_siteLocationRow&quot;&gt;</span>
<a href="#l4.56"></a><span id="l4.56" class="difflineplus">+        &lt;row id=&quot;editBMPanel_siteLocationRow&quot;</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineplus">+             align=&quot;center&quot;</span>
<a href="#l4.58"></a><span id="l4.58" class="difflineplus">+             collapsed=&quot;true&quot;&gt;</span>
<a href="#l4.59"></a><span id="l4.59">           &lt;label value=&quot;&amp;editBookmarkOverlay.siteLocation.label;&quot;</span>
<a href="#l4.60"></a><span id="l4.60">                  class=&quot;editBMPanel_rowLabel&quot;</span>
<a href="#l4.61"></a><span id="l4.61">                  accesskey=&quot;&amp;editBookmarkOverlay.siteLocation.accesskey;&quot;</span>
<a href="#l4.62"></a><span id="l4.62">                  control=&quot;editBMPanel_siteLocationField&quot;</span>
<a href="#l4.63"></a><span id="l4.63">                  observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.64"></a><span id="l4.64">           &lt;textbox id=&quot;editBMPanel_siteLocationField&quot;</span>
<a href="#l4.65"></a><span id="l4.65">                    class=&quot;uri-element&quot;</span>
<a href="#l4.66"></a><span id="l4.66">                    observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.67"></a><span id="l4.67">         &lt;/row&gt;</span>
<a href="#l4.68"></a><span id="l4.68"> </span>
<a href="#l4.69"></a><span id="l4.69" class="difflineminus">-        &lt;row align=&quot;center&quot; id=&quot;editBMPanel_folderRow&quot;&gt;</span>
<a href="#l4.70"></a><span id="l4.70" class="difflineplus">+        &lt;row id=&quot;editBMPanel_folderRow&quot;</span>
<a href="#l4.71"></a><span id="l4.71" class="difflineplus">+             align=&quot;center&quot;</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineplus">+             collapsed=&quot;true&quot;&gt;</span>
<a href="#l4.73"></a><span id="l4.73">           &lt;label value=&quot;&amp;editBookmarkOverlay.folder.label;&quot;</span>
<a href="#l4.74"></a><span id="l4.74">                  class=&quot;editBMPanel_rowLabel&quot;</span>
<a href="#l4.75"></a><span id="l4.75">                  accesskey=&quot;&amp;editBookmarkOverlay.folder.accesskey;&quot;</span>
<a href="#l4.76"></a><span id="l4.76">                  control=&quot;editBMPanel_folderMenuList&quot;</span>
<a href="#l4.77"></a><span id="l4.77">                  observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.78"></a><span id="l4.78">           &lt;hbox flex=&quot;1&quot; align=&quot;center&quot;&gt;</span>
<a href="#l4.79"></a><span id="l4.79">             &lt;menulist id=&quot;editBMPanel_folderMenuList&quot;</span>
<a href="#l4.80"></a><span id="l4.80">                       class=&quot;folder-icon&quot;</span>
<a href="#l4.81"></a><span id="l4.81" class="difflineat">@@ -107,25 +117,24 @@</span>
<a href="#l4.82"></a><span id="l4.82">                     tooltiptextup=&quot;&amp;editBookmarkOverlay.expanderUp.tooltip;&quot;</span>
<a href="#l4.83"></a><span id="l4.83">                     oncommand=&quot;gEditItemOverlay.toggleFolderTreeVisibility();&quot;</span>
<a href="#l4.84"></a><span id="l4.84">                     observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.85"></a><span id="l4.85">           &lt;/hbox&gt;</span>
<a href="#l4.86"></a><span id="l4.86">         &lt;/row&gt;</span>
<a href="#l4.87"></a><span id="l4.87"> </span>
<a href="#l4.88"></a><span id="l4.88">         &lt;row id=&quot;editBMPanel_folderTreeRow&quot;</span>
<a href="#l4.89"></a><span id="l4.89">              collapsed=&quot;true&quot;</span>
<a href="#l4.90"></a><span id="l4.90" class="difflineminus">-             persist=&quot;height&quot;</span>
<a href="#l4.91"></a><span id="l4.91" class="difflineminus">-             flex=&quot;2&quot;&gt;</span>
<a href="#l4.92"></a><span id="l4.92" class="difflineplus">+             flex=&quot;1&quot;&gt;</span>
<a href="#l4.93"></a><span id="l4.93">           &lt;spacer/&gt;</span>
<a href="#l4.94"></a><span id="l4.94">           &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l4.95"></a><span id="l4.95">             &lt;tree id=&quot;editBMPanel_folderTree&quot;</span>
<a href="#l4.96"></a><span id="l4.96">                   class=&quot;placesTree&quot;</span>
<a href="#l4.97"></a><span id="l4.97">                   type=&quot;places&quot;</span>
<a href="#l4.98"></a><span id="l4.98">                   treelines=&quot;true&quot;</span>
<a href="#l4.99"></a><span id="l4.99" class="difflineminus">-                  height=&quot;150&quot;</span>
<a href="#l4.100"></a><span id="l4.100" class="difflineplus">+                  minheight=&quot;150&quot;</span>
<a href="#l4.101"></a><span id="l4.101">                   flex=&quot;1&quot;</span>
<a href="#l4.102"></a><span id="l4.102">                   editable=&quot;true&quot;</span>
<a href="#l4.103"></a><span id="l4.103">                   onselect=&quot;gEditItemOverlay.onFolderTreeSelect();&quot;</span>
<a href="#l4.104"></a><span id="l4.104">                   hidecolumnpicker=&quot;true&quot;</span>
<a href="#l4.105"></a><span id="l4.105">                   observes=&quot;paneElementsBroadcaster&quot;&gt;</span>
<a href="#l4.106"></a><span id="l4.106">               &lt;treecols&gt;</span>
<a href="#l4.107"></a><span id="l4.107">                 &lt;treecol anonid=&quot;title&quot; flex=&quot;1&quot; primary=&quot;true&quot; hideheader=&quot;true&quot;/&gt;</span>
<a href="#l4.108"></a><span id="l4.108">               &lt;/treecols&gt;</span>
<a href="#l4.109"></a><span id="l4.109" class="difflineat">@@ -137,28 +146,30 @@</span>
<a href="#l4.110"></a><span id="l4.110">                       id=&quot;editBMPanel_newFolderButton&quot;</span>
<a href="#l4.111"></a><span id="l4.111">                       accesskey=&quot;&amp;editBookmarkOverlay.newFolderButton.accesskey;&quot;</span>
<a href="#l4.112"></a><span id="l4.112">                       tooltiptext=&quot;&amp;editBookmarkOverlay.newFolderButton.tooltip;&quot;</span>
<a href="#l4.113"></a><span id="l4.113">                       oncommand=&quot;gEditItemOverlay.newFolder();&quot;/&gt;</span>
<a href="#l4.114"></a><span id="l4.114">             &lt;/hbox&gt;</span>
<a href="#l4.115"></a><span id="l4.115">           &lt;/vbox&gt;</span>
<a href="#l4.116"></a><span id="l4.116">         &lt;/row&gt;</span>
<a href="#l4.117"></a><span id="l4.117"> </span>
<a href="#l4.118"></a><span id="l4.118" class="difflineminus">-        &lt;row align=&quot;center&quot; id=&quot;editBMPanel_tagsRow&quot;&gt;</span>
<a href="#l4.119"></a><span id="l4.119" class="difflineplus">+        &lt;row id=&quot;editBMPanel_tagsRow&quot;</span>
<a href="#l4.120"></a><span id="l4.120" class="difflineplus">+             align=&quot;center&quot;</span>
<a href="#l4.121"></a><span id="l4.121" class="difflineplus">+             collapsed=&quot;true&quot;&gt;</span>
<a href="#l4.122"></a><span id="l4.122">           &lt;label value=&quot;&amp;editBookmarkOverlay.tags.label;&quot;</span>
<a href="#l4.123"></a><span id="l4.123">                  class=&quot;editBMPanel_rowLabel&quot;</span>
<a href="#l4.124"></a><span id="l4.124">                  accesskey=&quot;&amp;editBookmarkOverlay.tags.accesskey;&quot;</span>
<a href="#l4.125"></a><span id="l4.125">                  control=&quot;editBMPanel_tagsField&quot;</span>
<a href="#l4.126"></a><span id="l4.126">                  observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.127"></a><span id="l4.127">           &lt;hbox flex=&quot;1&quot; align=&quot;center&quot;&gt;</span>
<a href="#l4.128"></a><span id="l4.128">             &lt;textbox id=&quot;editBMPanel_tagsField&quot;</span>
<a href="#l4.129"></a><span id="l4.129">                      type=&quot;autocomplete&quot;</span>
<a href="#l4.130"></a><span id="l4.130">                      class=&quot;padded&quot;</span>
<a href="#l4.131"></a><span id="l4.131">                      flex=&quot;1&quot;</span>
<a href="#l4.132"></a><span id="l4.132" class="difflineminus">-                     autocompletesearch=&quot;places-tag-autocomplete&quot; </span>
<a href="#l4.133"></a><span id="l4.133" class="difflineplus">+                     autocompletesearch=&quot;places-tag-autocomplete&quot;</span>
<a href="#l4.134"></a><span id="l4.134">                      completedefaultindex=&quot;true&quot;</span>
<a href="#l4.135"></a><span id="l4.135">                      tabscrolling=&quot;true&quot;</span>
<a href="#l4.136"></a><span id="l4.136">                      showcommentcolumn=&quot;true&quot;</span>
<a href="#l4.137"></a><span id="l4.137">                      onblur=&quot;gEditItemOverlay.onTagsFieldBlur();&quot;</span>
<a href="#l4.138"></a><span id="l4.138">                      observes=&quot;paneElementsBroadcaster&quot;</span>
<a href="#l4.139"></a><span id="l4.139">                      placeholder=&quot;&amp;editBookmarkOverlay.tagsEmptyDesc.label;&quot;/&gt;</span>
<a href="#l4.140"></a><span id="l4.140">             &lt;button id=&quot;editBMPanel_tagsSelectorExpander&quot;</span>
<a href="#l4.141"></a><span id="l4.141">                     class=&quot;expander-down&quot;</span>
<a href="#l4.142"></a><span id="l4.142" class="difflineat">@@ -166,39 +177,40 @@</span>
<a href="#l4.143"></a><span id="l4.143">                     tooltiptextdown=&quot;&amp;editBookmarkOverlay.tagsExpanderDown.tooltip;&quot;</span>
<a href="#l4.144"></a><span id="l4.144">                     tooltiptextup=&quot;&amp;editBookmarkOverlay.expanderUp.tooltip;&quot;</span>
<a href="#l4.145"></a><span id="l4.145">                     oncommand=&quot;gEditItemOverlay.toggleTagsSelector();&quot;</span>
<a href="#l4.146"></a><span id="l4.146">                     observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.147"></a><span id="l4.147">           &lt;/hbox&gt;</span>
<a href="#l4.148"></a><span id="l4.148">         &lt;/row&gt;</span>
<a href="#l4.149"></a><span id="l4.149"> </span>
<a href="#l4.150"></a><span id="l4.150">         &lt;row id=&quot;editBMPanel_tagsSelectorRow&quot;</span>
<a href="#l4.151"></a><span id="l4.151" class="difflineminus">-             persist=&quot;height&quot;</span>
<a href="#l4.152"></a><span id="l4.152" class="difflineminus">-             collapsed=&quot;true&quot;</span>
<a href="#l4.153"></a><span id="l4.153" class="difflineminus">-             flex=&quot;2&quot;&gt;</span>
<a href="#l4.154"></a><span id="l4.154" class="difflineplus">+             align=&quot;center&quot;</span>
<a href="#l4.155"></a><span id="l4.155" class="difflineplus">+             collapsed=&quot;true&quot;&gt;</span>
<a href="#l4.156"></a><span id="l4.156">           &lt;spacer/&gt;</span>
<a href="#l4.157"></a><span id="l4.157">           &lt;listbox id=&quot;editBMPanel_tagsSelector&quot;</span>
<a href="#l4.158"></a><span id="l4.158" class="difflineminus">-                   height=&quot;150&quot;</span>
<a href="#l4.159"></a><span id="l4.159" class="difflineminus">-                   flex=&quot;1&quot;</span>
<a href="#l4.160"></a><span id="l4.160" class="difflineplus">+                   minheight=&quot;150&quot;</span>
<a href="#l4.161"></a><span id="l4.161">                    observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.162"></a><span id="l4.162">         &lt;/row&gt;</span>
<a href="#l4.163"></a><span id="l4.163"> </span>
<a href="#l4.164"></a><span id="l4.164" class="difflineminus">-        &lt;row align=&quot;center&quot; id=&quot;editBMPanel_keywordRow&quot;&gt;</span>
<a href="#l4.165"></a><span id="l4.165" class="difflineplus">+        &lt;row id=&quot;editBMPanel_keywordRow&quot;</span>
<a href="#l4.166"></a><span id="l4.166" class="difflineplus">+             align=&quot;center&quot;</span>
<a href="#l4.167"></a><span id="l4.167" class="difflineplus">+             collapsed=&quot;true&quot;&gt;</span>
<a href="#l4.168"></a><span id="l4.168">           &lt;observes element=&quot;additionalInfoBroadcaster&quot; attribute=&quot;hidden&quot;/&gt;</span>
<a href="#l4.169"></a><span id="l4.169">           &lt;label value=&quot;&amp;editBookmarkOverlay.keyword.label;&quot;</span>
<a href="#l4.170"></a><span id="l4.170">                  class=&quot;editBMPanel_rowLabel&quot;</span>
<a href="#l4.171"></a><span id="l4.171">                  accesskey=&quot;&amp;editBookmarkOverlay.keyword.accesskey;&quot;</span>
<a href="#l4.172"></a><span id="l4.172">                  control=&quot;editBMPanel_keywordField&quot;</span>
<a href="#l4.173"></a><span id="l4.173">                  observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.174"></a><span id="l4.174">           &lt;textbox id=&quot;editBMPanel_keywordField&quot;</span>
<a href="#l4.175"></a><span id="l4.175">                    onblur=&quot;gEditItemOverlay.onKeywordFieldBlur();&quot;</span>
<a href="#l4.176"></a><span id="l4.176">                    observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.177"></a><span id="l4.177">         &lt;/row&gt;</span>
<a href="#l4.178"></a><span id="l4.178"> </span>
<a href="#l4.179"></a><span id="l4.179" class="difflineminus">-        &lt;row id=&quot;editBMPanel_descriptionRow&quot; persist=&quot;height&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l4.180"></a><span id="l4.180" class="difflineplus">+        &lt;row id=&quot;editBMPanel_descriptionRow&quot;</span>
<a href="#l4.181"></a><span id="l4.181" class="difflineplus">+             collapsed=&quot;true&quot;&gt;</span>
<a href="#l4.182"></a><span id="l4.182">           &lt;observes element=&quot;additionalInfoBroadcaster&quot; attribute=&quot;hidden&quot;/&gt;</span>
<a href="#l4.183"></a><span id="l4.183">           &lt;label value=&quot;&amp;editBookmarkOverlay.description.label;&quot;</span>
<a href="#l4.184"></a><span id="l4.184">                  class=&quot;editBMPanel_rowLabel&quot;</span>
<a href="#l4.185"></a><span id="l4.185">                  accesskey=&quot;&amp;editBookmarkOverlay.description.accesskey;&quot;</span>
<a href="#l4.186"></a><span id="l4.186">                  control=&quot;editBMPanel_descriptionField&quot;</span>
<a href="#l4.187"></a><span id="l4.187">                  observes=&quot;paneElementsBroadcaster&quot;/&gt;</span>
<a href="#l4.188"></a><span id="l4.188">           &lt;textbox id=&quot;editBMPanel_descriptionField&quot;</span>
<a href="#l4.189"></a><span id="l4.189">                    multiline=&quot;true&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/suite/common/jar.mn</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/suite/common/jar.mn</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -111,16 +111,18 @@ comm.jar:</span>
<a href="#l5.4"></a><span id="l5.4">    content/communicator/bindings/general.xml                        (bindings/general.xml)</span>
<a href="#l5.5"></a><span id="l5.5">    content/communicator/bindings/notification.xml                   (bindings/notification.xml)</span>
<a href="#l5.6"></a><span id="l5.6">    content/communicator/bindings/toolbar.xml                        (bindings/toolbar.xml)</span>
<a href="#l5.7"></a><span id="l5.7"> *  content/communicator/bindings/prefwindow.xml                     (bindings/prefwindow.xml)</span>
<a href="#l5.8"></a><span id="l5.8">    content/communicator/bookmarks/bm-panel.js                       (bookmarks/bm-panel.js)</span>
<a href="#l5.9"></a><span id="l5.9">    content/communicator/bookmarks/bm-panel.xul                      (bookmarks/bm-panel.xul)</span>
<a href="#l5.10"></a><span id="l5.10">    content/communicator/bookmarks/bm-props.js                       (bookmarks/bm-props.js)</span>
<a href="#l5.11"></a><span id="l5.11">    content/communicator/bookmarks/bm-props.xul                      (bookmarks/bm-props.xul)</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+# Provide another URI for the bookmark properties dialog so we can persist the attributes separately</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+% override chrome://communicator/content/bookmarks/bm-props2.xul chrome://communicator/content/bookmarks/bm-props.xul</span>
<a href="#l5.14"></a><span id="l5.14">    content/communicator/bookmarks/bookmarksManager.css              (bookmarks/bookmarksManager.css)</span>
<a href="#l5.15"></a><span id="l5.15">    content/communicator/bookmarks/bookmarksManager.js               (bookmarks/bookmarksManager.js)</span>
<a href="#l5.16"></a><span id="l5.16">    content/communicator/bookmarks/bookmarksManager.xul              (bookmarks/bookmarksManager.xul)</span>
<a href="#l5.17"></a><span id="l5.17">    content/communicator/bookmarks/browser-places.js                 (bookmarks/browser-places.js)</span>
<a href="#l5.18"></a><span id="l5.18">    content/communicator/bookmarks/editBookmarkOverlay.js            (bookmarks/editBookmarkOverlay.js)</span>
<a href="#l5.19"></a><span id="l5.19">    content/communicator/bookmarks/editBookmarkOverlay.xul           (bookmarks/editBookmarkOverlay.xul)</span>
<a href="#l5.20"></a><span id="l5.20">    content/communicator/bookmarks/moveBookmarks.js                  (bookmarks/moveBookmarks.js)</span>
<a href="#l5.21"></a><span id="l5.21">    content/communicator/bookmarks/moveBookmarks.xul                 (bookmarks/moveBookmarks.xul)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/suite/modules/PlacesUIUtils.jsm</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/suite/modules/PlacesUIUtils.jsm</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -632,18 +632,27 @@ var PlacesUIUtils = {</span>
<a href="#l6.4"></a><span id="l6.4">    *        See documentation at the top of bm-props.js</span>
<a href="#l6.5"></a><span id="l6.5">    * @param aMinimalUI</span>
<a href="#l6.6"></a><span id="l6.6">    *        [optional] if true, the dialog is opened by its alternative</span>
<a href="#l6.7"></a><span id="l6.7">    *        chrome: uri.</span>
<a href="#l6.8"></a><span id="l6.8">    *</span>
<a href="#l6.9"></a><span id="l6.9">    * @return true if any transaction has been performed, false otherwise.</span>
<a href="#l6.10"></a><span id="l6.10">    */</span>
<a href="#l6.11"></a><span id="l6.11">   _showBookmarkDialog: function PUIU__showBookmarkDialog(aInfo) {</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-    var dialogURL = &quot;chrome://communicator/content/bookmarks/bm-props.xul&quot;;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-    var features = &quot;centerscreen,chrome,modal,resizable=yes&quot;;</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+    // Preserve size attributes differently based on the fact the dialog has</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+    // a folder picker or not, since it needs more horizontal space than the</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+    // other controls.</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+    let hasFolderPicker = !(&quot;hiddenRows&quot; in aInfo) ||</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+                          !aInfo.hiddenRows.includes(&quot;folderPicker&quot;);</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineplus">+    // Use a different chrome url to persist different sizes.</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineplus">+    let dialogURL = hasFolderPicker ?</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineplus">+                    &quot;chrome://communicator/content/bookmarks/bm-props2.xul&quot; :</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineplus">+                    &quot;chrome://communicator/content/bookmarks/bm-props.xul&quot;;</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineplus">+</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineplus">+    let features = &quot;centerscreen,chrome,modal,resizable=yes&quot;;</span>
<a href="#l6.25"></a><span id="l6.25">     this._getCurrentActiveWin().openDialog(dialogURL, &quot;&quot;, features, aInfo);</span>
<a href="#l6.26"></a><span id="l6.26">     return (&quot;performed&quot; in aInfo &amp;&amp; aInfo.performed);</span>
<a href="#l6.27"></a><span id="l6.27">   },</span>
<a href="#l6.28"></a><span id="l6.28"> </span>
<a href="#l6.29"></a><span id="l6.29">   _getTopBrowserWin: function PUIU__getTopBrowserWin() {</span>
<a href="#l6.30"></a><span id="l6.30">     return this._getCurrentActiveWin().gPrivate ||</span>
<a href="#l6.31"></a><span id="l6.31">            Services.wm.getMostRecentWindow(&quot;navigator:browser&quot;);</span>
<a href="#l6.32"></a><span id="l6.32">   },</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

