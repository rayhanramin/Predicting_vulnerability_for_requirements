<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 9339:0312c7227484c3045ab5e71e5f2100af4ab480eb</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 0312c7227484c3045ab5e71e5f2100af4ab480eb" />
<meta property="og:url" content="/comm-central/rev/0312c7227484c3045ab5e71e5f2100af4ab480eb" />
<meta property="og:description" content="Bug 308175 - Visual indicator in day and week view to show current time (slot). r=philipp" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 0312c7227484c3045ab5e71e5f2100af4ab480eb 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/0312c7227484c3045ab5e71e5f2100af4ab480eb">shortlog</a> |
<a href="/comm-central/log/0312c7227484c3045ab5e71e5f2100af4ab480eb">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/0312c7227484c3045ab5e71e5f2100af4ab480eb">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/0312c7227484c3045ab5e71e5f2100af4ab480eb">files</a> |
changeset |
<a href="/comm-central/raw-rev/0312c7227484c3045ab5e71e5f2100af4ab480eb">raw</a>  | <a href="/comm-central/archive/0312c7227484c3045ab5e71e5f2100af4ab480eb.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=308175">Bug 308175</a> - Visual indicator in day and week view to show current time (slot). r=philipp
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#68;&#101;&#99;&#97;&#116;&#104;&#108;&#111;&#110;&#32;&#60;&#98;&#118;&#49;&#53;&#55;&#56;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Mon, 06 Feb 2012 22:21:56 +0100</td></tr>

<tr>
 <td>changeset 9339</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/0312c7227484c3045ab5e71e5f2100af4ab480eb">0312c7227484c3045ab5e71e5f2100af4ab480eb</a></td>
</tr>



<tr>
<td>parent 9338</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/a0026dd945ae4354f3e4c010aa6392b4ad40c765">a0026dd945ae4354f3e4c010aa6392b4ad40c765</a>
</td>
</tr>

<tr>
<td>child 9340</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/5ab177f7e555264bd5123dbafdda792335a86ee1">5ab177f7e555264bd5123dbafdda792335a86ee1</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=0312c7227484c3045ab5e71e5f2100af4ab480eb">7153</a></td></tr>
<tr><td>push user</td><td>richard.marti@gmail.com</td></tr>
<tr><td>push date</td><td class="date age">Mon, 06 Feb 2012 21:23:29 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@0312c7227484 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=0312c7227484c3045ab5e71e5f2100af4ab480eb">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=0312c7227484c3045ab5e71e5f2100af4ab480eb&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=0312c7227484c3045ab5e71e5f2100af4ab480eb&newProject=comm-central&newRevision=0312c7227484c3045ab5e71e5f2100af4ab480eb&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=0312c7227484c3045ab5e71e5f2100af4ab480eb&newProject=comm-central&newRevision=0312c7227484c3045ab5e71e5f2100af4ab480eb&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=0312c7227484c3045ab5e71e5f2100af4ab480eb&newProject=comm-central&newRevision=0312c7227484c3045ab5e71e5f2100af4ab480eb&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28philipp%29&revcount=50">philipp</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=308175">308175</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=308175">Bug 308175</a> - Visual indicator in day and week view to show current time (slot). r=philipp</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-month-view.xml">calendar/base/content/calendar-month-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-month-view.xml">file</a> |
<a href="/comm-central/annotate/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-month-view.xml">annotate</a> |
<a href="/comm-central/diff/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-month-view.xml">diff</a> |
<a href="/comm-central/comparison/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-month-view.xml">comparison</a> |
<a href="/comm-central/log/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-month-view.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-multiday-view.xml">calendar/base/content/calendar-multiday-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-multiday-view.xml">file</a> |
<a href="/comm-central/annotate/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-multiday-view.xml">annotate</a> |
<a href="/comm-central/diff/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-multiday-view.xml">diff</a> |
<a href="/comm-central/comparison/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-multiday-view.xml">comparison</a> |
<a href="/comm-central/log/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-multiday-view.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-views.js">calendar/base/content/calendar-views.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-views.js">file</a> |
<a href="/comm-central/annotate/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-views.js">annotate</a> |
<a href="/comm-central/diff/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-views.js">diff</a> |
<a href="/comm-central/comparison/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-views.js">comparison</a> |
<a href="/comm-central/log/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-views.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-views.xml">calendar/base/content/calendar-views.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-views.xml">file</a> |
<a href="/comm-central/annotate/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-views.xml">annotate</a> |
<a href="/comm-central/diff/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-views.xml">diff</a> |
<a href="/comm-central/comparison/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-views.xml">comparison</a> |
<a href="/comm-central/log/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/content/calendar-views.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/themes/common/calendar-views.css">calendar/base/themes/common/calendar-views.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/themes/common/calendar-views.css">file</a> |
<a href="/comm-central/annotate/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/themes/common/calendar-views.css">annotate</a> |
<a href="/comm-central/diff/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/themes/common/calendar-views.css">diff</a> |
<a href="/comm-central/comparison/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/themes/common/calendar-views.css">comparison</a> |
<a href="/comm-central/log/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/base/themes/common/calendar-views.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/lightning/content/lightning.js">calendar/lightning/content/lightning.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/lightning/content/lightning.js">file</a> |
<a href="/comm-central/annotate/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/lightning/content/lightning.js">annotate</a> |
<a href="/comm-central/diff/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/lightning/content/lightning.js">diff</a> |
<a href="/comm-central/comparison/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/lightning/content/lightning.js">comparison</a> |
<a href="/comm-central/log/0312c7227484c3045ab5e71e5f2100af4ab480eb/calendar/lightning/content/lightning.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/content/calendar-month-view.xml</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/content/calendar-month-view.xml</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -651,16 +651,18 @@</span>
<a href="#l1.4"></a><span id="l1.4">           this.selectedDay = aDate;</span>
<a href="#l1.5"></a><span id="l1.5">         ]]&gt;&lt;/body&gt;</span>
<a href="#l1.6"></a><span id="l1.6">       &lt;/method&gt;</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8">       &lt;method name=&quot;onResize&quot;&gt;</span>
<a href="#l1.9"></a><span id="l1.9">       &lt;parameter name=&quot;aBinding&quot;/&gt;</span>
<a href="#l1.10"></a><span id="l1.10">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l1.11"></a><span id="l1.11">           aBinding.adjustWeekdayLength();</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+          // Delete the timer for the time indicator in day/week view.</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+          timeIndicator.cancel();</span>
<a href="#l1.14"></a><span id="l1.14">         ]]&gt;&lt;/body&gt;</span>
<a href="#l1.15"></a><span id="l1.15">       &lt;/method&gt;</span>
<a href="#l1.16"></a><span id="l1.16"> </span>
<a href="#l1.17"></a><span id="l1.17">       &lt;method name=&quot;setDateRange&quot;&gt;</span>
<a href="#l1.18"></a><span id="l1.18">         &lt;parameter name=&quot;aStartDate&quot;/&gt;</span>
<a href="#l1.19"></a><span id="l1.19">         &lt;parameter name=&quot;aEndDate&quot;/&gt;</span>
<a href="#l1.20"></a><span id="l1.20">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l1.21"></a><span id="l1.21">           this.rangeStartDate = aStartDate;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -57,18 +57,20 @@</span>
<a href="#l2.4"></a><span id="l2.4">   xmlns:xbl=&quot;http://www.mozilla.org/xbl&quot;&gt;</span>
<a href="#l2.5"></a><span id="l2.5"> </span>
<a href="#l2.6"></a><span id="l2.6">   &lt;!--</span>
<a href="#l2.7"></a><span id="l2.7">      - This is the time bar that displays time divisions to the side</span>
<a href="#l2.8"></a><span id="l2.8">      - or top of a multiday view.</span>
<a href="#l2.9"></a><span id="l2.9">     --&gt;</span>
<a href="#l2.10"></a><span id="l2.10">   &lt;binding id=&quot;calendar-time-bar&quot;&gt;</span>
<a href="#l2.11"></a><span id="l2.11">     &lt;content&gt;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-      &lt;xul:box xbl:inherits=&quot;orient,width,height&quot; flex=&quot;1&quot; anonid=&quot;topbox&quot;&gt;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-      &lt;/xul:box&gt;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+      &lt;xul:stack anonid=&quot;timebarboxstack&quot; style=&quot;display: block; position: absolute&quot; xbl:inherits=&quot;orient,width,height&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+        &lt;xul:box anonid=&quot;topbox&quot; xbl:inherits=&quot;orient,width,height&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+        &lt;xul:box anonid=&quot;timeIndicatorBoxTimeBar&quot; class=&quot;timeIndicator-timeBar&quot; xbl:inherits=&quot;orient&quot; hidden=&quot;true&quot;/&gt;</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+      &lt;/xul:stack&gt;</span>
<a href="#l2.18"></a><span id="l2.18">     &lt;/content&gt;</span>
<a href="#l2.19"></a><span id="l2.19"> </span>
<a href="#l2.20"></a><span id="l2.20">     &lt;implementation&gt;</span>
<a href="#l2.21"></a><span id="l2.21">       &lt;field name=&quot;mPixPerMin&quot;&gt;0.6&lt;/field&gt;</span>
<a href="#l2.22"></a><span id="l2.22">       &lt;field name=&quot;mStartMin&quot;&gt;0*60&lt;/field&gt;</span>
<a href="#l2.23"></a><span id="l2.23">       &lt;field name=&quot;mEndMin&quot;&gt;24*60&lt;/field&gt;</span>
<a href="#l2.24"></a><span id="l2.24">       &lt;field name=&quot;mDayStartHour&quot;&gt;0&lt;/field&gt;</span>
<a href="#l2.25"></a><span id="l2.25">       &lt;field name=&quot;mDayEndHour&quot;&gt;24&lt;/field&gt;</span>
<a href="#l2.26"></a><span id="l2.26" class="difflineat">@@ -265,17 +267,19 @@</span>
<a href="#l2.27"></a><span id="l2.27">   &lt;!--</span>
<a href="#l2.28"></a><span id="l2.28">      - A column for displaying event boxes in.  One column per</span>
<a href="#l2.29"></a><span id="l2.29">      - day; it manages the layout of the events given via add/deleteEvent.</span>
<a href="#l2.30"></a><span id="l2.30">     --&gt;</span>
<a href="#l2.31"></a><span id="l2.31">   &lt;binding id=&quot;calendar-event-column&quot;&gt;</span>
<a href="#l2.32"></a><span id="l2.32">     &lt;content&gt;</span>
<a href="#l2.33"></a><span id="l2.33">       &lt;xul:stack anonid=&quot;boxstack&quot; flex=&quot;1&quot; class=&quot;multiday-column-box-stack&quot; style=&quot;min-width: 1px; min-height: 1px&quot;&gt;</span>
<a href="#l2.34"></a><span id="l2.34">         &lt;xul:box anonid=&quot;bgbox&quot; flex=&quot;1&quot; class=&quot;multiday-column-bg-box&quot; style=&quot;min-width: 1px; min-height: 1px&quot;/&gt;</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineminus">-        &lt;xul:box xbl:inherits=&quot;context&quot; anonid=&quot;topbox&quot; flex=&quot;1&quot; equalsize=&quot;always&quot; class=&quot;multiday-column-top-box&quot; style=&quot;min-width: 1px; min-height: 1px&quot; mousethrough=&quot;always&quot;/&gt;</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineplus">+        &lt;xul:box anonid=&quot;topbox&quot; class=&quot;multiday-column-top-box&quot; flex=&quot;1&quot; style=&quot;min-width: 1px; min-height: 1px&quot;</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineplus">+                 xbl:inherits=&quot;context&quot; equalsize=&quot;always&quot; mousethrough=&quot;always&quot;/&gt;</span>
<a href="#l2.38"></a><span id="l2.38" class="difflineplus">+        &lt;xul:box anonid=&quot;timeIndicatorBox&quot; xbl:inherits=&quot;orient&quot; class=&quot;timeIndicator&quot; mousethrough=&quot;always&quot; hidden=&quot;true&quot;/&gt;</span>
<a href="#l2.39"></a><span id="l2.39">         &lt;xul:box anonid=&quot;fgbox&quot; flex=&quot;1&quot; class=&quot;fgdragcontainer&quot; style=&quot;min-width: 1px; min-height: 1px; overflow:hidden;&quot;&gt;</span>
<a href="#l2.40"></a><span id="l2.40">           &lt;xul:box anonid=&quot;fgdragspacer&quot; style=&quot;display: inherit; overflow: hidden;&quot;&gt;</span>
<a href="#l2.41"></a><span id="l2.41">             &lt;xul:spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l2.42"></a><span id="l2.42">             &lt;xul:label anonid=&quot;fgdragbox-startlabel&quot; class=&quot;fgdragbox-label&quot;/&gt;</span>
<a href="#l2.43"></a><span id="l2.43">           &lt;/xul:box&gt;</span>
<a href="#l2.44"></a><span id="l2.44">           &lt;xul:box anonid=&quot;fgdragbox&quot; class=&quot;fgdragbox&quot; /&gt;</span>
<a href="#l2.45"></a><span id="l2.45">           &lt;xul:label anonid=&quot;fgdragbox-endlabel&quot; class=&quot;fgdragbox-label&quot;/&gt;</span>
<a href="#l2.46"></a><span id="l2.46">         &lt;/xul:box&gt;</span>
<a href="#l2.47"></a><span id="l2.47" class="difflineat">@@ -416,16 +420,23 @@</span>
<a href="#l2.48"></a><span id="l2.48">                   startlabel: document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;fgdragbox-startlabel&quot;),</span>
<a href="#l2.49"></a><span id="l2.49">                   endlabel: document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;fgdragbox-endlabel&quot;)</span>
<a href="#l2.50"></a><span id="l2.50">               };</span>
<a href="#l2.51"></a><span id="l2.51">           }</span>
<a href="#l2.52"></a><span id="l2.52">           return this.mFgboxes;</span>
<a href="#l2.53"></a><span id="l2.53">         ]]&gt;&lt;/getter&gt;</span>
<a href="#l2.54"></a><span id="l2.54">       &lt;/property&gt;</span>
<a href="#l2.55"></a><span id="l2.55"> </span>
<a href="#l2.56"></a><span id="l2.56" class="difflineplus">+      &lt;property name=&quot;timeIndicatorBox&quot;</span>
<a href="#l2.57"></a><span id="l2.57" class="difflineplus">+        readonly=&quot;true&quot;&gt;</span>
<a href="#l2.58"></a><span id="l2.58" class="difflineplus">+        &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l2.59"></a><span id="l2.59" class="difflineplus">+          return document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;timeIndicatorBox&quot;);</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineplus">+        ]]&gt;&lt;/getter&gt;</span>
<a href="#l2.61"></a><span id="l2.61" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l2.62"></a><span id="l2.62" class="difflineplus">+</span>
<a href="#l2.63"></a><span id="l2.63">       &lt;property</span>
<a href="#l2.64"></a><span id="l2.64">         name=&quot;events&quot;</span>
<a href="#l2.65"></a><span id="l2.65">         readonly=&quot;true&quot;</span>
<a href="#l2.66"></a><span id="l2.66">         onget=&quot;return this.methods&quot;/&gt;</span>
<a href="#l2.67"></a><span id="l2.67"> </span>
<a href="#l2.68"></a><span id="l2.68">       &lt;field name=&quot;mDayOff&quot;&gt;false&lt;/field&gt;</span>
<a href="#l2.69"></a><span id="l2.69">       &lt;property name=&quot;dayOff&quot;&gt;</span>
<a href="#l2.70"></a><span id="l2.70">         &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l2.71"></a><span id="l2.71" class="difflineat">@@ -2443,88 +2454,199 @@</span>
<a href="#l2.72"></a><span id="l2.72"> </span>
<a href="#l2.73"></a><span id="l2.73">         var self = this;</span>
<a href="#l2.74"></a><span id="l2.74">         // set the flex attribute at the scrollbox-innerbox</span>
<a href="#l2.75"></a><span id="l2.75">         // (this can be removed, after Bug 343555 is fixed)</span>
<a href="#l2.76"></a><span id="l2.76">         let scrollbox = document.getAnonymousElementByAttribute(</span>
<a href="#l2.77"></a><span id="l2.77">                        this, &quot;anonid&quot;, &quot;scrollbox&quot;);</span>
<a href="#l2.78"></a><span id="l2.78">         document.getAnonymousElementByAttribute(</span>
<a href="#l2.79"></a><span id="l2.79">             scrollbox, &quot;class&quot;, &quot;box-inherit scrollbox-innerbox&quot;).flex = &quot;1&quot;;</span>
<a href="#l2.80"></a><span id="l2.80" class="difflineplus">+</span>
<a href="#l2.81"></a><span id="l2.81" class="difflineplus">+        // set the time interval for the time indicator timer</span>
<a href="#l2.82"></a><span id="l2.82" class="difflineplus">+        this.setTimeIndicatorInterval(getPrefSafe(&quot;calendar.view.timeIndicatorInterval&quot;, 15));</span>
<a href="#l2.83"></a><span id="l2.83" class="difflineplus">+        this.enableTimeIndicator();</span>
<a href="#l2.84"></a><span id="l2.84" class="difflineplus">+</span>
<a href="#l2.85"></a><span id="l2.85">         this.reorient();</span>
<a href="#l2.86"></a><span id="l2.86">       ]]&gt;&lt;/constructor&gt;</span>
<a href="#l2.87"></a><span id="l2.87"> </span>
<a href="#l2.88"></a><span id="l2.88">       &lt;property name=&quot;daysInView&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l2.89"></a><span id="l2.89">         &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l2.90"></a><span id="l2.90">           return this.labeldaybox.childNodes &amp;&amp; this.labeldaybox.childNodes.length;</span>
<a href="#l2.91"></a><span id="l2.91">         ]]&gt;&lt;/getter&gt;</span>
<a href="#l2.92"></a><span id="l2.92">       &lt;/property&gt;</span>
<a href="#l2.93"></a><span id="l2.93"> </span>
<a href="#l2.94"></a><span id="l2.94">       &lt;property name=&quot;supportsZoom&quot; readonly=&quot;true&quot;</span>
<a href="#l2.95"></a><span id="l2.95">                 onget=&quot;return true;&quot;/&gt;</span>
<a href="#l2.96"></a><span id="l2.96">       &lt;property name=&quot;supportsRotation&quot; readonly=&quot;true&quot;</span>
<a href="#l2.97"></a><span id="l2.97">                 onget=&quot;return true&quot;/&gt;</span>
<a href="#l2.98"></a><span id="l2.98"> </span>
<a href="#l2.99"></a><span id="l2.99" class="difflineplus">+      &lt;method name=&quot;setTimeIndicatorInterval&quot;&gt;</span>
<a href="#l2.100"></a><span id="l2.100" class="difflineplus">+        &lt;parameter name=&quot;aPrefInterval&quot;/&gt;</span>
<a href="#l2.101"></a><span id="l2.101" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l2.102"></a><span id="l2.102" class="difflineplus">+          // If the preference just edited by the user is outside the valid</span>
<a href="#l2.103"></a><span id="l2.103" class="difflineplus">+          // range [0, 1440], we change it into the nearest limit (0 or 1440).</span>
<a href="#l2.104"></a><span id="l2.104" class="difflineplus">+          let newTimeInterval = Math.max(0, Math.min(1440, aPrefInterval));</span>
<a href="#l2.105"></a><span id="l2.105" class="difflineplus">+          if (newTimeInterval != aPrefInterval) {</span>
<a href="#l2.106"></a><span id="l2.106" class="difflineplus">+              cal.setPref(&quot;calendar.view.timeIndicatorInterval&quot;, newTimeInterval);</span>
<a href="#l2.107"></a><span id="l2.107" class="difflineplus">+          }</span>
<a href="#l2.108"></a><span id="l2.108" class="difflineplus">+</span>
<a href="#l2.109"></a><span id="l2.109" class="difflineplus">+          if (newTimeInterval != this.mTimeIndicatorInterval) {</span>
<a href="#l2.110"></a><span id="l2.110" class="difflineplus">+              this.mTimeIndicatorInterval = newTimeInterval;</span>
<a href="#l2.111"></a><span id="l2.111" class="difflineplus">+          }</span>
<a href="#l2.112"></a><span id="l2.112" class="difflineplus">+          if (this.mTimeIndicatorInterval == 0) {</span>
<a href="#l2.113"></a><span id="l2.113" class="difflineplus">+              timeIndicator.cancel();</span>
<a href="#l2.114"></a><span id="l2.114" class="difflineplus">+          }</span>
<a href="#l2.115"></a><span id="l2.115" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l2.116"></a><span id="l2.116" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l2.117"></a><span id="l2.117" class="difflineplus">+</span>
<a href="#l2.118"></a><span id="l2.118" class="difflineplus">+      &lt;method name=&quot;enableTimeIndicator&quot;&gt;</span>
<a href="#l2.119"></a><span id="l2.119" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l2.120"></a><span id="l2.120" class="difflineplus">+          // Hide or show the time indicator if the preference becomes 0 or greater than 0.</span>
<a href="#l2.121"></a><span id="l2.121" class="difflineplus">+          let hideIndicator = this.mTimeIndicatorInterval == 0;</span>
<a href="#l2.122"></a><span id="l2.122" class="difflineplus">+          setBooleanAttribute(this.timeBarTimeIndicator, &quot;hidden&quot;, hideIndicator)</span>
<a href="#l2.123"></a><span id="l2.123" class="difflineplus">+          let todayColumn = this.findColumnForDate(this.today());</span>
<a href="#l2.124"></a><span id="l2.124" class="difflineplus">+          if (todayColumn) {</span>
<a href="#l2.125"></a><span id="l2.125" class="difflineplus">+              setBooleanAttribute(todayColumn.column.timeIndicatorBox, &quot;hidden&quot;, hideIndicator)</span>
<a href="#l2.126"></a><span id="l2.126" class="difflineplus">+          }</span>
<a href="#l2.127"></a><span id="l2.127" class="difflineplus">+          // Update the timer but only under some circumstances, otherwise</span>
<a href="#l2.128"></a><span id="l2.128" class="difflineplus">+          // it will update the wrong view or it will start without need.</span>
<a href="#l2.129"></a><span id="l2.129" class="difflineplus">+          let currentMode = document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;);</span>
<a href="#l2.130"></a><span id="l2.130" class="difflineplus">+          let currView = currentView().type;</span>
<a href="#l2.131"></a><span id="l2.131" class="difflineplus">+          if (currentMode == &quot;calendar&quot; &amp;&amp; currView == this.type &amp;&amp; !hideIndicator</span>
<a href="#l2.132"></a><span id="l2.132" class="difflineplus">+              &amp;&amp; (currView == &quot;day&quot; || currView == &quot;week&quot;)) {</span>
<a href="#l2.133"></a><span id="l2.133" class="difflineplus">+              this.updateTimeIndicatorPosition(true);</span>
<a href="#l2.134"></a><span id="l2.134" class="difflineplus">+          }</span>
<a href="#l2.135"></a><span id="l2.135" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l2.136"></a><span id="l2.136" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l2.137"></a><span id="l2.137" class="difflineplus">+</span>
<a href="#l2.138"></a><span id="l2.138" class="difflineplus">+      &lt;method name=&quot;updateTimeIndicatorPosition&quot;&gt;</span>
<a href="#l2.139"></a><span id="l2.139" class="difflineplus">+        &lt;parameter name=&quot;aUpdateTheTimer&quot;/&gt;</span>
<a href="#l2.140"></a><span id="l2.140" class="difflineplus">+        &lt;parameter name=&quot;aPpmChanged&quot;/&gt;</span>
<a href="#l2.141"></a><span id="l2.141" class="difflineplus">+        &lt;parameter name=&quot;aViewChanged&quot;/&gt;</span>
<a href="#l2.142"></a><span id="l2.142" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l2.143"></a><span id="l2.143" class="difflineplus">+          let now = cal.now();</span>
<a href="#l2.144"></a><span id="l2.144" class="difflineplus">+          let nowMinutes = now.hour * 60 + now.minute;</span>
<a href="#l2.145"></a><span id="l2.145" class="difflineplus">+          if (aUpdateTheTimer) {</span>
<a href="#l2.146"></a><span id="l2.146" class="difflineplus">+              let prefInt = this.mTimeIndicatorInterval;</span>
<a href="#l2.147"></a><span id="l2.147" class="difflineplus">+              if (prefInt == 0) {</span>
<a href="#l2.148"></a><span id="l2.148" class="difflineplus">+                  timeIndicator.cancel()</span>
<a href="#l2.149"></a><span id="l2.149" class="difflineplus">+                  return;</span>
<a href="#l2.150"></a><span id="l2.150" class="difflineplus">+              }</span>
<a href="#l2.151"></a><span id="l2.151" class="difflineplus">+</span>
<a href="#l2.152"></a><span id="l2.152" class="difflineplus">+              // Increase the update interval if pixels per minute is small.</span>
<a href="#l2.153"></a><span id="l2.153" class="difflineplus">+              let oldPrefInt = prefInt;</span>
<a href="#l2.154"></a><span id="l2.154" class="difflineplus">+              if (aPpmChanged &amp;&amp; this.mPixPerMin &lt; 0.6) {</span>
<a href="#l2.155"></a><span id="l2.155" class="difflineplus">+                  prefInt = Math.round(prefInt / this.mPixPerMin);</span>
<a href="#l2.156"></a><span id="l2.156" class="difflineplus">+              }</span>
<a href="#l2.157"></a><span id="l2.157" class="difflineplus">+              if (!aPpmChanged || aViewChanged || oldPrefInt != prefInt) {</span>
<a href="#l2.158"></a><span id="l2.158" class="difflineplus">+                  // Synchronize the timer with a multiple of the interval.</span>
<a href="#l2.159"></a><span id="l2.159" class="difflineplus">+                  let firstInterval = (prefInt - nowMinutes % prefInt) * 60 - now.second;</span>
<a href="#l2.160"></a><span id="l2.160" class="difflineplus">+                  if (timeIndicator.timer) {</span>
<a href="#l2.161"></a><span id="l2.161" class="difflineplus">+                      timeIndicator.cancel();</span>
<a href="#l2.162"></a><span id="l2.162" class="difflineplus">+                  }</span>
<a href="#l2.163"></a><span id="l2.163" class="difflineplus">+                  timeIndicator.lastView = this.id;</span>
<a href="#l2.164"></a><span id="l2.164" class="difflineplus">+                  let self = this;</span>
<a href="#l2.165"></a><span id="l2.165" class="difflineplus">+                  timeIndicator.timer = setTimeout(function() {self.updateTimeIndicatorPosition(false);</span>
<a href="#l2.166"></a><span id="l2.166" class="difflineplus">+                                                               timeIndicator.start(prefInt * 60, self);},</span>
<a href="#l2.167"></a><span id="l2.167" class="difflineplus">+                                                   firstInterval * 1000);</span>
<a href="#l2.168"></a><span id="l2.168" class="difflineplus">+                  // Set the time for the first positioning of the indicator.</span>
<a href="#l2.169"></a><span id="l2.169" class="difflineplus">+                  let time = Math.floor(nowMinutes / prefInt) * prefInt;</span>
<a href="#l2.170"></a><span id="l2.170" class="difflineplus">+                  document.getElementById(&quot;day-view&quot;).mTimeIndicatorMinutes = time;</span>
<a href="#l2.171"></a><span id="l2.171" class="difflineplus">+                  document.getElementById(&quot;week-view&quot;).mTimeIndicatorMinutes = time;</span>
<a href="#l2.172"></a><span id="l2.172" class="difflineplus">+              }</span>
<a href="#l2.173"></a><span id="l2.173" class="difflineplus">+          } else if (aUpdateTheTimer === false) {</span>
<a href="#l2.174"></a><span id="l2.174" class="difflineplus">+              // Set the time for every positioning after the first</span>
<a href="#l2.175"></a><span id="l2.175" class="difflineplus">+              document.getElementById(&quot;day-view&quot;).mTimeIndicatorMinutes = nowMinutes;</span>
<a href="#l2.176"></a><span id="l2.176" class="difflineplus">+              document.getElementById(&quot;week-view&quot;).mTimeIndicatorMinutes = nowMinutes;</span>
<a href="#l2.177"></a><span id="l2.177" class="difflineplus">+          }</span>
<a href="#l2.178"></a><span id="l2.178" class="difflineplus">+          // Update the position of the indicator.</span>
<a href="#l2.179"></a><span id="l2.179" class="difflineplus">+          let position = Math.round(this.mPixPerMin * this.mTimeIndicatorMinutes) - 1;</span>
<a href="#l2.180"></a><span id="l2.180" class="difflineplus">+          let posAttr = (this.orient == &quot;vertical&quot; ? &quot;top: &quot; : &quot;left: &quot;);</span>
<a href="#l2.181"></a><span id="l2.181" class="difflineplus">+          this.timeBarTimeIndicator.setAttribute(&quot;style&quot;, posAttr + position + &quot;px;&quot;);</span>
<a href="#l2.182"></a><span id="l2.182" class="difflineplus">+          let todayColumn = this.findColumnForDate(this.today());</span>
<a href="#l2.183"></a><span id="l2.183" class="difflineplus">+          if (todayColumn) {</span>
<a href="#l2.184"></a><span id="l2.184" class="difflineplus">+              todayColumn.column.timeIndicatorBox.setAttribute(&quot;style&quot;, &quot;margin-&quot; + posAttr + position + &quot;px;&quot;);</span>
<a href="#l2.185"></a><span id="l2.185" class="difflineplus">+          }</span>
<a href="#l2.186"></a><span id="l2.186" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l2.187"></a><span id="l2.187" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l2.188"></a><span id="l2.188" class="difflineplus">+</span>
<a href="#l2.189"></a><span id="l2.189">       &lt;method name=&quot;handlePreference&quot;&gt;</span>
<a href="#l2.190"></a><span id="l2.190">         &lt;parameter name=&quot;aSubject&quot;/&gt;</span>
<a href="#l2.191"></a><span id="l2.191">         &lt;parameter name=&quot;aTopic&quot;/&gt;</span>
<a href="#l2.192"></a><span id="l2.192">         &lt;parameter name=&quot;aPreference&quot;/&gt;</span>
<a href="#l2.193"></a><span id="l2.193">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l2.194"></a><span id="l2.194">             aSubject.QueryInterface(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l2.195"></a><span id="l2.195">             switch (aPreference) {</span>
<a href="#l2.196"></a><span id="l2.196"> </span>
<a href="#l2.197"></a><span id="l2.197">                 case &quot;calendar.view.daystarthour&quot;:</span>
<a href="#l2.198"></a><span id="l2.198">                     this.setDayStartEndMinutes(aSubject.getIntPref(aPreference) * 60,</span>
<a href="#l2.199"></a><span id="l2.199">                                                this.mDayEndMin);</span>
<a href="#l2.200"></a><span id="l2.200" class="difflineminus">-</span>
<a href="#l2.201"></a><span id="l2.201">                     this.refreshView();</span>
<a href="#l2.202"></a><span id="l2.202">                     break;</span>
<a href="#l2.203"></a><span id="l2.203"> </span>
<a href="#l2.204"></a><span id="l2.204">                 case &quot;calendar.view.dayendhour&quot;:</span>
<a href="#l2.205"></a><span id="l2.205">                     this.setDayStartEndMinutes(this.mDayStartMin,</span>
<a href="#l2.206"></a><span id="l2.206">                                                aSubject.getIntPref(aPreference) * 60);</span>
<a href="#l2.207"></a><span id="l2.207">                     this.refreshView();</span>
<a href="#l2.208"></a><span id="l2.208">                     break;</span>
<a href="#l2.209"></a><span id="l2.209"> </span>
<a href="#l2.210"></a><span id="l2.210">                 case &quot;calendar.view.visiblehours&quot;:</span>
<a href="#l2.211"></a><span id="l2.211">                     this.setVisibleMinutes(aSubject.getIntPref(aPreference) * 60);</span>
<a href="#l2.212"></a><span id="l2.212">                     this.refreshView();</span>
<a href="#l2.213"></a><span id="l2.213">                     break;</span>
<a href="#l2.214"></a><span id="l2.214"> </span>
<a href="#l2.215"></a><span id="l2.215" class="difflineplus">+                case &quot;calendar.view.timeIndicatorInterval&quot;:</span>
<a href="#l2.216"></a><span id="l2.216" class="difflineplus">+                    this.setTimeIndicatorInterval(aSubject.getIntPref(aPreference));</span>
<a href="#l2.217"></a><span id="l2.217" class="difflineplus">+                    this.enableTimeIndicator();</span>
<a href="#l2.218"></a><span id="l2.218" class="difflineplus">+                    break;</span>
<a href="#l2.219"></a><span id="l2.219" class="difflineplus">+</span>
<a href="#l2.220"></a><span id="l2.220">                 default:</span>
<a href="#l2.221"></a><span id="l2.221">                     this.handleCommonPreference(aSubject, aTopic, aPreference);</span>
<a href="#l2.222"></a><span id="l2.222">                     break;</span>
<a href="#l2.223"></a><span id="l2.223">             }</span>
<a href="#l2.224"></a><span id="l2.224">             return;</span>
<a href="#l2.225"></a><span id="l2.225">         ]]&gt;&lt;/body&gt;</span>
<a href="#l2.226"></a><span id="l2.226">       &lt;/method&gt;</span>
<a href="#l2.227"></a><span id="l2.227"> </span>
<a href="#l2.228"></a><span id="l2.228">       &lt;method name=&quot;onResize&quot;&gt;</span>
<a href="#l2.229"></a><span id="l2.229">         &lt;parameter name=&quot;aRealSelf&quot;/&gt;</span>
<a href="#l2.230"></a><span id="l2.230">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l2.231"></a><span id="l2.231" class="difflineminus">-          var self = this;</span>
<a href="#l2.232"></a><span id="l2.232" class="difflineplus">+          let self = this;</span>
<a href="#l2.233"></a><span id="l2.233" class="difflineplus">+          let isARelayout = true;</span>
<a href="#l2.234"></a><span id="l2.234">           if (aRealSelf) {</span>
<a href="#l2.235"></a><span id="l2.235" class="difflineminus">-            self = aRealSelf;</span>
<a href="#l2.236"></a><span id="l2.236" class="difflineplus">+              self = aRealSelf;</span>
<a href="#l2.237"></a><span id="l2.237" class="difflineplus">+              isARelayout = false;</span>
<a href="#l2.238"></a><span id="l2.238">           }</span>
<a href="#l2.239"></a><span id="l2.239">           let scrollbox = document.getAnonymousElementByAttribute(self, &quot;anonid&quot;, &quot;scrollbox&quot;);</span>
<a href="#l2.240"></a><span id="l2.240" class="difflineminus">-          var size;</span>
<a href="#l2.241"></a><span id="l2.241" class="difflineplus">+          let size;</span>
<a href="#l2.242"></a><span id="l2.242">           if (self.orient == &quot;horizontal&quot;) {</span>
<a href="#l2.243"></a><span id="l2.243" class="difflineminus">-            size = scrollbox.boxObject.width;</span>
<a href="#l2.244"></a><span id="l2.244" class="difflineplus">+              size = scrollbox.boxObject.width;</span>
<a href="#l2.245"></a><span id="l2.245">           } else {</span>
<a href="#l2.246"></a><span id="l2.246" class="difflineminus">-            size = scrollbox.boxObject.height;</span>
<a href="#l2.247"></a><span id="l2.247" class="difflineplus">+              size = scrollbox.boxObject.height;</span>
<a href="#l2.248"></a><span id="l2.248">           }</span>
<a href="#l2.249"></a><span id="l2.249" class="difflineminus">-          var ppm = size / self.mVisibleMinutes;</span>
<a href="#l2.250"></a><span id="l2.250" class="difflineplus">+          let ppm = size / self.mVisibleMinutes;</span>
<a href="#l2.251"></a><span id="l2.251">           ppm = Math.floor(ppm * 1000) / 1000;</span>
<a href="#l2.252"></a><span id="l2.252">           if (ppm &lt; self.mMinPixelsPerMinute) {</span>
<a href="#l2.253"></a><span id="l2.253" class="difflineminus">-            ppm = self.mMinPixelsPerMinute;</span>
<a href="#l2.254"></a><span id="l2.254" class="difflineplus">+              ppm = self.mMinPixelsPerMinute;</span>
<a href="#l2.255"></a><span id="l2.255">           }</span>
<a href="#l2.256"></a><span id="l2.256" class="difflineplus">+          let ppmChanged = (self.pixelsPerMinute != ppm);</span>
<a href="#l2.257"></a><span id="l2.257">           self.pixelsPerMinute = ppm;</span>
<a href="#l2.258"></a><span id="l2.258">           setTimeout(function(){self.scrollToMinute(self.mFirstVisibleMinute)}, 0);</span>
<a href="#l2.259"></a><span id="l2.259"> </span>
<a href="#l2.260"></a><span id="l2.260">           // Fit the weekday labels while scrolling.</span>
<a href="#l2.261"></a><span id="l2.261">           self.adjustWeekdayLength(self.getAttribute(&quot;orient&quot;) == &quot;horizontal&quot;);</span>
<a href="#l2.262"></a><span id="l2.262" class="difflineplus">+</span>
<a href="#l2.263"></a><span id="l2.263" class="difflineplus">+          // Adjust the time indicator position and the related timer.</span>
<a href="#l2.264"></a><span id="l2.264" class="difflineplus">+          if (this.mTimeIndicatorInterval != 0) {</span>
<a href="#l2.265"></a><span id="l2.265" class="difflineplus">+              let viewChanged = isARelayout &amp;&amp; (timeIndicator.lastView != this.id);</span>
<a href="#l2.266"></a><span id="l2.266" class="difflineplus">+              let currentMode = document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;);</span>
<a href="#l2.267"></a><span id="l2.267" class="difflineplus">+              if (currentMode == &quot;calendar&quot; &amp;&amp; (!timeIndicator.timer || ppmChanged || viewChanged)) {</span>
<a href="#l2.268"></a><span id="l2.268" class="difflineplus">+                  self.updateTimeIndicatorPosition(true, ppmChanged, viewChanged);</span>
<a href="#l2.269"></a><span id="l2.269" class="difflineplus">+              }</span>
<a href="#l2.270"></a><span id="l2.270" class="difflineplus">+          }</span>
<a href="#l2.271"></a><span id="l2.271">         ]]&gt;&lt;/body&gt;</span>
<a href="#l2.272"></a><span id="l2.272">       &lt;/method&gt;</span>
<a href="#l2.273"></a><span id="l2.273"> </span>
<a href="#l2.274"></a><span id="l2.274">       &lt;!-- mDateList will always be sorted before being set --&gt;</span>
<a href="#l2.275"></a><span id="l2.275">       &lt;field name=&quot;mDateList&quot;&gt;null&lt;/field&gt;</span>
<a href="#l2.276"></a><span id="l2.276">       &lt;!-- array of { date: calIDatetime, column: colbox, header: hdrbox }  --&gt;</span>
<a href="#l2.277"></a><span id="l2.277">       &lt;field name=&quot;mDateColumns&quot;&gt;null&lt;/field&gt;</span>
<a href="#l2.278"></a><span id="l2.278">       &lt;field name=&quot;mPixPerMin&quot;&gt;0.6&lt;/field&gt;</span>
<a href="#l2.279"></a><span id="l2.279" class="difflineat">@@ -2532,16 +2654,19 @@</span>
<a href="#l2.280"></a><span id="l2.280">       &lt;field name=&quot;mSelectedDayCol&quot;&gt;null&lt;/field&gt;</span>
<a href="#l2.281"></a><span id="l2.281">       &lt;field name=&quot;mSelectedDay&quot;&gt;null&lt;/field&gt;</span>
<a href="#l2.282"></a><span id="l2.282">       &lt;field name=&quot;mStartMin&quot;&gt;0*60&lt;/field&gt;</span>
<a href="#l2.283"></a><span id="l2.283">       &lt;field name=&quot;mEndMin&quot;&gt;24*60&lt;/field&gt;</span>
<a href="#l2.284"></a><span id="l2.284">       &lt;field name=&quot;mDayStartMin&quot;&gt;0&lt;/field&gt;</span>
<a href="#l2.285"></a><span id="l2.285">       &lt;field name=&quot;mDayEndMin&quot;&gt;0&lt;/field&gt;</span>
<a href="#l2.286"></a><span id="l2.286">       &lt;field name=&quot;mVisibleMinutes&quot;&gt;9*60&lt;/field&gt;</span>
<a href="#l2.287"></a><span id="l2.287">       &lt;field name=&quot;mClickedTime&quot;&gt;null&lt;/field&gt;</span>
<a href="#l2.288"></a><span id="l2.288" class="difflineplus">+      &lt;field name=&quot;mTimeIndicatorInterval&quot;&gt;15&lt;/field&gt;</span>
<a href="#l2.289"></a><span id="l2.289" class="difflineplus">+      &lt;field name=&quot;mModeHandler&quot;&gt;null&lt;/field&gt;</span>
<a href="#l2.290"></a><span id="l2.290" class="difflineplus">+      &lt;field name=&quot;mTimeIndicatorMinutes&quot;&gt;0&lt;/field&gt;</span>
<a href="#l2.291"></a><span id="l2.291"> </span>
<a href="#l2.292"></a><span id="l2.292">       &lt;method name=&quot;flashAlarm&quot;&gt;</span>
<a href="#l2.293"></a><span id="l2.293">         &lt;parameter name=&quot;aAlarmItem&quot;/&gt;</span>
<a href="#l2.294"></a><span id="l2.294">         &lt;parameter name=&quot;aStop&quot;/&gt;</span>
<a href="#l2.295"></a><span id="l2.295">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l2.296"></a><span id="l2.296">           var showIndicator = cal.getPrefSafe(&quot;calendar.alarms.indicator.show&quot;, true);</span>
<a href="#l2.297"></a><span id="l2.297">           var totaltime = cal.getPrefSafe(&quot;calendar.alarms.indicator.totaltime&quot;, 3600);</span>
<a href="#l2.298"></a><span id="l2.298"> </span>
<a href="#l2.299"></a><span id="l2.299" class="difflineat">@@ -2993,16 +3118,23 @@</span>
<a href="#l2.300"></a><span id="l2.300">         ]]&gt;&lt;/getter&gt;</span>
<a href="#l2.301"></a><span id="l2.301">       &lt;/property&gt;</span>
<a href="#l2.302"></a><span id="l2.302"> </span>
<a href="#l2.303"></a><span id="l2.303">       &lt;property name=&quot;orient&quot;&gt;</span>
<a href="#l2.304"></a><span id="l2.304">         &lt;getter&gt;&lt;![CDATA[return (this.getAttribute(&quot;orient&quot;) || &quot;vertical&quot;);]]&gt;&lt;/getter&gt;</span>
<a href="#l2.305"></a><span id="l2.305">         &lt;setter&gt;&lt;![CDATA[this.setAttribute(&quot;orient&quot;, val); return val;]]&gt;&lt;/setter&gt;</span>
<a href="#l2.306"></a><span id="l2.306">       &lt;/property&gt;</span>
<a href="#l2.307"></a><span id="l2.307"> </span>
<a href="#l2.308"></a><span id="l2.308" class="difflineplus">+      &lt;property name=&quot;timeBarTimeIndicator&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l2.309"></a><span id="l2.309" class="difflineplus">+        &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l2.310"></a><span id="l2.310" class="difflineplus">+          let timebar = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;timebar&quot;);</span>
<a href="#l2.311"></a><span id="l2.311" class="difflineplus">+          return document.getAnonymousElementByAttribute(timebar, &quot;anonid&quot;, &quot;timeIndicatorBoxTimeBar&quot;);</span>
<a href="#l2.312"></a><span id="l2.312" class="difflineplus">+        ]]&gt;&lt;/getter&gt;</span>
<a href="#l2.313"></a><span id="l2.313" class="difflineplus">+      &lt;/property&gt;</span>
<a href="#l2.314"></a><span id="l2.314" class="difflineplus">+</span>
<a href="#l2.315"></a><span id="l2.315">       &lt;method name=&quot;setAttribute&quot;&gt;</span>
<a href="#l2.316"></a><span id="l2.316">         &lt;parameter name=&quot;aAttr&quot;/&gt;</span>
<a href="#l2.317"></a><span id="l2.317">         &lt;parameter name=&quot;aVal&quot;/&gt;</span>
<a href="#l2.318"></a><span id="l2.318">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l2.319"></a><span id="l2.319">           var needsreorient = false;</span>
<a href="#l2.320"></a><span id="l2.320">           var needsrelayout = false;</span>
<a href="#l2.321"></a><span id="l2.321">           if (aAttr == &quot;orient&quot;) {</span>
<a href="#l2.322"></a><span id="l2.322">               if (this.getAttribute(&quot;orient&quot;) != aVal)</span>
<a href="#l2.323"></a><span id="l2.323" class="difflineat">@@ -3132,16 +3264,17 @@</span>
<a href="#l2.324"></a><span id="l2.324"> </span>
<a href="#l2.325"></a><span id="l2.325"> </span>
<a href="#l2.326"></a><span id="l2.326">           // get today's date</span>
<a href="#l2.327"></a><span id="l2.327">           var today = this.today();</span>
<a href="#l2.328"></a><span id="l2.328">           var counter = 0;</span>
<a href="#l2.329"></a><span id="l2.329">           var dayboxkids = daybox.childNodes;</span>
<a href="#l2.330"></a><span id="l2.330">           var headerboxkids = headerdaybox.childNodes;</span>
<a href="#l2.331"></a><span id="l2.331">           let labelboxkids = this.labeldaybox.childNodes;</span>
<a href="#l2.332"></a><span id="l2.332" class="difflineplus">+          let updateTimeIndicator = false;</span>
<a href="#l2.333"></a><span id="l2.333"> </span>
<a href="#l2.334"></a><span id="l2.334">           for each (var d in computedDateList) {</span>
<a href="#l2.335"></a><span id="l2.335">               var dayEventsBox;</span>
<a href="#l2.336"></a><span id="l2.336">               if (counter &lt; dayboxkids.length) {</span>
<a href="#l2.337"></a><span id="l2.337">                   dayEventsBox = dayboxkids[counter];</span>
<a href="#l2.338"></a><span id="l2.338">                   dayEventsBox.removeAttribute(&quot;relation&quot;);</span>
<a href="#l2.339"></a><span id="l2.339">                   dayEventsBox.mEventInfos = new Array();</span>
<a href="#l2.340"></a><span id="l2.340">               } else {</span>
<a href="#l2.341"></a><span id="l2.341" class="difflineat">@@ -3180,31 +3313,34 @@</span>
<a href="#l2.342"></a><span id="l2.342">                   labelbox = labelboxkids[counter];</span>
<a href="#l2.343"></a><span id="l2.343">                   labelbox.date = d;</span>
<a href="#l2.344"></a><span id="l2.344">               } else {</span>
<a href="#l2.345"></a><span id="l2.345">                   labelbox = createXULElement(&quot;calendar-day-label&quot;);</span>
<a href="#l2.346"></a><span id="l2.346">                   labelbox.setAttribute(&quot;orient&quot;, otherorient);</span>
<a href="#l2.347"></a><span id="l2.347">                   this.labeldaybox.appendChild(labelbox);</span>
<a href="#l2.348"></a><span id="l2.348">                   labelbox.date = d;</span>
<a href="#l2.349"></a><span id="l2.349">               }</span>
<a href="#l2.350"></a><span id="l2.350" class="difflineminus">-              // Set attributes for date relations.</span>
<a href="#l2.351"></a><span id="l2.351" class="difflineplus">+              // Set attributes for date relations and for the time indicator.</span>
<a href="#l2.352"></a><span id="l2.352">               let headerDayBox = document.getAnonymousElementByAttribute(</span>
<a href="#l2.353"></a><span id="l2.353">                                      this, &quot;anonid&quot;, &quot;headerdaybox&quot;);</span>
<a href="#l2.354"></a><span id="l2.354">               headerDayBox.removeAttribute(&quot;todaylastinview&quot;);</span>
<a href="#l2.355"></a><span id="l2.355" class="difflineplus">+              dayEventsBox.timeIndicatorBox.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l2.356"></a><span id="l2.356">               switch (d.compare(today)) {</span>
<a href="#l2.357"></a><span id="l2.357">                   case -1:</span>
<a href="#l2.358"></a><span id="l2.358">                       dayHeaderBox.setAttribute(&quot;relation&quot;, &quot;past&quot;);</span>
<a href="#l2.359"></a><span id="l2.359">                       dayEventsBox.setAttribute(&quot;relation&quot;, &quot;past&quot;);</span>
<a href="#l2.360"></a><span id="l2.360">                       labelbox.setAttribute(&quot;relation&quot;, &quot;past&quot;);</span>
<a href="#l2.361"></a><span id="l2.361">                       break;</span>
<a href="#l2.362"></a><span id="l2.362">                   case 0:</span>
<a href="#l2.363"></a><span id="l2.363">                       let relation_ = this.numVisibleDates == 1 ? &quot;today1day&quot; : &quot;today&quot;;</span>
<a href="#l2.364"></a><span id="l2.364">                       dayHeaderBox.setAttribute(&quot;relation&quot;, relation_);</span>
<a href="#l2.365"></a><span id="l2.365">                       dayEventsBox.setAttribute(&quot;relation&quot;, relation_);</span>
<a href="#l2.366"></a><span id="l2.366">                       labelbox.setAttribute(&quot;relation&quot;, relation_);</span>
<a href="#l2.367"></a><span id="l2.367" class="difflineplus">+                      setBooleanAttribute(dayEventsBox.timeIndicatorBox, &quot;hidden&quot;, this.mTimeIndicatorInterval == 0)</span>
<a href="#l2.368"></a><span id="l2.368" class="difflineplus">+                      updateTimeIndicator = true;</span>
<a href="#l2.369"></a><span id="l2.369"> </span>
<a href="#l2.370"></a><span id="l2.370">                       // Due to equalsize=always being set on the dayboxes</span>
<a href="#l2.371"></a><span id="l2.371">                       // parent, there are a few issues showing the border of</span>
<a href="#l2.372"></a><span id="l2.372">                       // the last daybox correctly. To work around this, we're</span>
<a href="#l2.373"></a><span id="l2.373">                       // setting an attribute we can use in CSS. For more</span>
<a href="#l2.374"></a><span id="l2.374">                       // information about this hack, see bug 455045</span>
<a href="#l2.375"></a><span id="l2.375">                       if (dayHeaderBox == headerdaybox.childNodes[headerdaybox.childNodes.length - 1] &amp;&amp;</span>
<a href="#l2.376"></a><span id="l2.376">                           this.numVisibleDates &gt; 1) {</span>
<a href="#l2.377"></a><span id="l2.377" class="difflineat">@@ -3231,16 +3367,20 @@</span>
<a href="#l2.378"></a><span id="l2.378">               while (counter &lt; elem.childNodes.length) {</span>
<a href="#l2.379"></a><span id="l2.379">                   elem.removeChild(elem.childNodes[counter]);</span>
<a href="#l2.380"></a><span id="l2.380">               }</span>
<a href="#l2.381"></a><span id="l2.381">           }</span>
<a href="#l2.382"></a><span id="l2.382">           removeExtraKids(daybox);</span>
<a href="#l2.383"></a><span id="l2.383">           removeExtraKids(headerdaybox);</span>
<a href="#l2.384"></a><span id="l2.384">           removeExtraKids(this.labeldaybox);</span>
<a href="#l2.385"></a><span id="l2.385"> </span>
<a href="#l2.386"></a><span id="l2.386" class="difflineplus">+          if (updateTimeIndicator) {</span>
<a href="#l2.387"></a><span id="l2.387" class="difflineplus">+              this.updateTimeIndicatorPosition();</span>
<a href="#l2.388"></a><span id="l2.388" class="difflineplus">+          }</span>
<a href="#l2.389"></a><span id="l2.389" class="difflineplus">+</span>
<a href="#l2.390"></a><span id="l2.390">           // fix pixels-per-minute</span>
<a href="#l2.391"></a><span id="l2.391">           this.onResize();</span>
<a href="#l2.392"></a><span id="l2.392">           for each (let col in this.mDateColumns) {</span>
<a href="#l2.393"></a><span id="l2.393">                col.column.endLayoutBatchChange();</span>
<a href="#l2.394"></a><span id="l2.394">           }</span>
<a href="#l2.395"></a><span id="l2.395"> </span>
<a href="#l2.396"></a><span id="l2.396">           // Adjust scrollbar spacers</span>
<a href="#l2.397"></a><span id="l2.397">           this.adjustScrollBarSpacers();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/calendar-views.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/calendar-views.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -834,8 +834,26 @@ cal.navigationBar = {</span>
<a href="#l3.4"></a><span id="l3.4">         if (document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;) == &quot;calendar&quot;) {</span>
<a href="#l3.5"></a><span id="l3.5">             document.title = (docTitle ? docTitle + &quot; - &quot; : &quot;&quot;) +</span>
<a href="#l3.6"></a><span id="l3.6">                 calGetString(&quot;brand&quot;, &quot;brandFullName&quot;, null, &quot;branding&quot;);</span>
<a href="#l3.7"></a><span id="l3.7">         }</span>
<a href="#l3.8"></a><span id="l3.8">         let viewTabs = document.getElementById(&quot;view-tabs&quot;);</span>
<a href="#l3.9"></a><span id="l3.9">         viewTabs.selectedIndex = getViewDeck().selectedIndex;</span>
<a href="#l3.10"></a><span id="l3.10">     }</span>
<a href="#l3.11"></a><span id="l3.11"> };</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+/*</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+ * Timer for the time indicator in day and week view.</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineplus">+ */</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineplus">+var timeIndicator = {</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineplus">+    timer: null,</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineplus">+    start: function(aInterval, aThis) {</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineplus">+        timeIndicator.timer = setInterval(function() {aThis.updateTimeIndicatorPosition(false);},</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineplus">+                                          aInterval * 1000);</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineplus">+    },</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineplus">+    cancel: function() {</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineplus">+        if (timeIndicator.timer) {</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineplus">+            clearTimeout(timeIndicator.timer);</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineplus">+            timeIndicator.timer = null;</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineplus">+        }</span>
<a href="#l3.27"></a><span id="l3.27" class="difflineplus">+    },</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineplus">+    lastView: null</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/calendar-views.xml</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/calendar-views.xml</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -82,22 +82,46 @@</span>
<a href="#l4.4"></a><span id="l4.4">                 ]]&gt;&lt;/body&gt;</span>
<a href="#l4.5"></a><span id="l4.5">             &lt;/method&gt;</span>
<a href="#l4.6"></a><span id="l4.6">         &lt;/implementation&gt;</span>
<a href="#l4.7"></a><span id="l4.7">     &lt;/binding&gt;</span>
<a href="#l4.8"></a><span id="l4.8"> </span>
<a href="#l4.9"></a><span id="l4.9">     &lt;binding id=&quot;calendar-week-view&quot;</span>
<a href="#l4.10"></a><span id="l4.10">              extends=&quot;chrome://calendar/content/calendar-multiday-view.xml#calendar-multiday-view&quot;&gt;</span>
<a href="#l4.11"></a><span id="l4.11">         &lt;implementation implements=&quot;calICalendarView&quot;&gt;</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+            &lt;constructor&gt;&lt;![CDATA[</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+                // add a listener for the mode change</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+                let self = this;</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+                this.mModeHandler = function modeHandler(event) {</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+                    if (event.attrName == &quot;mode&quot;) {</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+                        self.onModeChanged(event);</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineplus">+                    }</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineplus">+                };</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineplus">+                document.getElementById(&quot;modeBroadcaster&quot;).addEventListener(&quot;DOMAttrModified&quot;, this.mModeHandler, true);</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineplus">+            ]]&gt;&lt;/constructor&gt;</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineplus">+            &lt;destructor&gt;&lt;![CDATA[</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineplus">+                document.getElementById(&quot;modeBroadcaster&quot;).removeEventListener(&quot;DOMAttrModified&quot;, this.mModeHandler, true);</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineplus">+            ]]&gt;&lt;/destructor&gt;</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineplus">+</span>
<a href="#l4.26"></a><span id="l4.26">             &lt;property name=&quot;observerID&quot;&gt;</span>
<a href="#l4.27"></a><span id="l4.27">                 &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l4.28"></a><span id="l4.28">                     return &quot;week-view-observer&quot;;</span>
<a href="#l4.29"></a><span id="l4.29">                 ]]&gt;&lt;/getter&gt;</span>
<a href="#l4.30"></a><span id="l4.30">             &lt;/property&gt;</span>
<a href="#l4.31"></a><span id="l4.31"> </span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+            &lt;method name=&quot;onModeChanged&quot;&gt;</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+              &lt;parameter name=&quot;aEvent&quot;/&gt;</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+              &lt;body&gt;&lt;![CDATA[</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+                let currentMode = document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;);</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+                if (currentMode != &quot;calendar&quot;) {</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+                    timeIndicator.cancel();</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineplus">+                }</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+              ]]&gt;&lt;/body&gt;</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+            &lt;/method&gt;</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineplus">+</span>
<a href="#l4.42"></a><span id="l4.42">             &lt;!--Public methods--&gt;</span>
<a href="#l4.43"></a><span id="l4.43">             &lt;method name=&quot;goToDay&quot;&gt;</span>
<a href="#l4.44"></a><span id="l4.44">                 &lt;parameter name=&quot;aDate&quot;/&gt;</span>
<a href="#l4.45"></a><span id="l4.45">                 &lt;body&gt;&lt;![CDATA[</span>
<a href="#l4.46"></a><span id="l4.46">                     this.displayDaysOff = !this.mWorkdaysOnly;</span>
<a href="#l4.47"></a><span id="l4.47"> </span>
<a href="#l4.48"></a><span id="l4.48">                     aDate = aDate.getInTimezone(this.timezone);</span>
<a href="#l4.49"></a><span id="l4.49">                     var d1 = getWeekInfoService().getStartOfWeek(aDate);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/themes/common/calendar-views.css</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/themes/common/calendar-views.css</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -378,16 +378,52 @@ window[systemcolors] .fgdragbox[dragging</span>
<a href="#l5.4"></a><span id="l5.4">     text-align: center;</span>
<a href="#l5.5"></a><span id="l5.5">     overflow: hidden;</span>
<a href="#l5.6"></a><span id="l5.6"> }</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8"> window[systemcolors] .fgdragbox-label {</span>
<a href="#l5.9"></a><span id="l5.9"> 	color: GrayText;</span>
<a href="#l5.10"></a><span id="l5.10"> }</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+.timeIndicator[orient=&quot;vertical&quot;] {</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+    min-width: 1px;</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+    -moz-margin-start: -1px;</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+    -moz-margin-end: -1px;</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+    border-top: 2px solid red;</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+    opacity: 0.7;</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineplus">+}</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineplus">+.timeIndicator[orient=&quot;horizontal&quot;] {</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineplus">+    min-height: 1px;</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineplus">+    margin-top: -1px;</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineplus">+    margin-bottom: -1px;</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineplus">+    border-left: 2px solid red;</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineplus">+    opacity: 0.7;</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineplus">+}</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineplus">+</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineplus">+.timeIndicator-timeBar {</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineplus">+    background-color: red;</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineplus">+    position: absolute;</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineplus">+    border-radius: 2px;</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+}</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineplus">+</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineplus">+.timeIndicator-timeBar[orient=&quot;vertical&quot;] {</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineplus">+    margin-top: -1px;</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineplus">+    height: 4px;</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+    width: 8px;</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineplus">+    right: 0px;</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineplus">+}</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineplus">+</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+.timeIndicator-timeBar[orient=&quot;horizontal&quot;] {</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+    margin-left: -1px;</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineplus">+    height: 8px;</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineplus">+    width: 4px;</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineplus">+    bottom: 0px;</span>
<a href="#l5.46"></a><span id="l5.46" class="difflineplus">+}</span>
<a href="#l5.47"></a><span id="l5.47" class="difflineplus">+</span>
<a href="#l5.48"></a><span id="l5.48"> .calendar-event-box-container {</span>
<a href="#l5.49"></a><span id="l5.49">     padding: 0;</span>
<a href="#l5.50"></a><span id="l5.50">     overflow: hidden;</span>
<a href="#l5.51"></a><span id="l5.51">     margin: 1px;</span>
<a href="#l5.52"></a><span id="l5.52"> }</span>
<a href="#l5.53"></a><span id="l5.53"> </span>
<a href="#l5.54"></a><span id="l5.54"> .calendar-event-box-container[categories] {</span>
<a href="#l5.55"></a><span id="l5.55">     -moz-margin-end: 0px;</span>
<a href="#l5.56"></a><span id="l5.56" class="difflineat">@@ -498,30 +534,32 @@ window[systemcolors] .calendar-time-bar-</span>
<a href="#l5.57"></a><span id="l5.57">     -moz-border-right-colors: -moz-Field ThreeDShadow;</span>
<a href="#l5.58"></a><span id="l5.58"> }</span>
<a href="#l5.59"></a><span id="l5.59"> </span>
<a href="#l5.60"></a><span id="l5.60"> .calendar-time-bar-box-odd[orient=&quot;horizontal&quot;],</span>
<a href="#l5.61"></a><span id="l5.61"> .calendar-time-bar-box-even[orient=&quot;horizontal&quot;] {</span>
<a href="#l5.62"></a><span id="l5.62">     border-right: 1px solid #D2D2D2;</span>
<a href="#l5.63"></a><span id="l5.63">     border-top: 1px solid #D2D2D2;</span>
<a href="#l5.64"></a><span id="l5.64">     -moz-border-right-colors: none;</span>
<a href="#l5.65"></a><span id="l5.65" class="difflineplus">+    height: 40px; /* the same as the calendar-time-bar element */</span>
<a href="#l5.66"></a><span id="l5.66"> }</span>
<a href="#l5.67"></a><span id="l5.67"> </span>
<a href="#l5.68"></a><span id="l5.68"> window[systemcolors] .calendar-time-bar-box-odd[orient=&quot;horizontal&quot;],</span>
<a href="#l5.69"></a><span id="l5.69"> window[systemcolors] .calendar-time-bar-box-even[orient=&quot;horizontal&quot;] {</span>
<a href="#l5.70"></a><span id="l5.70">     border-right: 1px solid ThreeDShadow;</span>
<a href="#l5.71"></a><span id="l5.71">     border-top: 1px solid ThreeDShadow;</span>
<a href="#l5.72"></a><span id="l5.72">     -moz-border-right-colors: none;</span>
<a href="#l5.73"></a><span id="l5.73"> }</span>
<a href="#l5.74"></a><span id="l5.74"> </span>
<a href="#l5.75"></a><span id="l5.75"> .calendar-time-bar-box-odd[orient=&quot;vertical&quot;],</span>
<a href="#l5.76"></a><span id="l5.76"> .calendar-time-bar-box-even[orient=&quot;vertical&quot;] {</span>
<a href="#l5.77"></a><span id="l5.77">     border-bottom: 1px  transparent !important;</span>
<a href="#l5.78"></a><span id="l5.78">     border-right: 2px solid #D2D2D2;</span>
<a href="#l5.79"></a><span id="l5.79">     -moz-border-right-colors:  #FFFFFF #D2D2D2;</span>
<a href="#l5.80"></a><span id="l5.80" class="difflineplus">+    width: 10ex; /* the same as the calendar-time-bar element */</span>
<a href="#l5.81"></a><span id="l5.81"> }</span>
<a href="#l5.82"></a><span id="l5.82"> </span>
<a href="#l5.83"></a><span id="l5.83"> window[systemcolors] .calendar-time-bar-box-odd[orient=&quot;vertical&quot;],</span>
<a href="#l5.84"></a><span id="l5.84"> window[systemcolors] .calendar-time-bar-box-even[orient=&quot;vertical&quot;] {</span>
<a href="#l5.85"></a><span id="l5.85">     border-right: 2px solid ThreeDShadow;</span>
<a href="#l5.86"></a><span id="l5.86">     -moz-border-right-colors: -moz-Field ThreeDShadow;</span>
<a href="#l5.87"></a><span id="l5.87"> }</span>
<a href="#l5.88"></a><span id="l5.88"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/lightning/content/lightning.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/lightning/content/lightning.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -117,16 +117,19 @@ pref(&quot;calendar.week.d6saturdaysoff&quot;, tru</span>
<a href="#l6.4"></a><span id="l6.4"> </span>
<a href="#l6.5"></a><span id="l6.5"> // start and end work hour for day and week views</span>
<a href="#l6.6"></a><span id="l6.6"> pref(&quot;calendar.view.daystarthour&quot;, 8);</span>
<a href="#l6.7"></a><span id="l6.7"> pref(&quot;calendar.view.dayendhour&quot;, 17);</span>
<a href="#l6.8"></a><span id="l6.8"> </span>
<a href="#l6.9"></a><span id="l6.9"> // number of visible hours for day and week views</span>
<a href="#l6.10"></a><span id="l6.10"> pref(&quot;calendar.view.visiblehours&quot;, 9);</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+// time indicator update interval in minutes (0 = no indicator)</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+pref(&quot;calendar.view.timeIndicatorInterval&quot;, 15);</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+</span>
<a href="#l6.15"></a><span id="l6.15"> // If true, mouse scrolling via shift+wheel will be enabled</span>
<a href="#l6.16"></a><span id="l6.16"> pref(&quot;calendar.view.mousescroll&quot;, true);</span>
<a href="#l6.17"></a><span id="l6.17"> </span>
<a href="#l6.18"></a><span id="l6.18"> // Do not set this!  If it's not there, then we guess the system timezone</span>
<a href="#l6.19"></a><span id="l6.19"> //pref(&quot;calendar.timezone.local&quot;, &quot;&quot;);</span>
<a href="#l6.20"></a><span id="l6.20"> </span>
<a href="#l6.21"></a><span id="l6.21"> // categories settings</span>
<a href="#l6.22"></a><span id="l6.22"> // XXX One day we might want to move this to a locale specific file</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

