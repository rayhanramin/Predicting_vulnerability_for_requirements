<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 21316:5c6b4b0d0451f43ba0ea0921f833c488fb3f4928</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 5c6b4b0d0451f43ba0ea0921f833c488fb3f4928" />
<meta property="og:url" content="/comm-central/rev/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928" />
<meta property="og:description" content="Bug 472448 - Add keyboard navigation and accessibility to minimonth. r=philipp" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 5c6b4b0d0451f43ba0ea0921f833c488fb3f4928 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928">shortlog</a> |
<a href="/comm-central/log/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928">files</a> |
changeset |
<a href="/comm-central/raw-rev/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928">raw</a>  | <a href="/comm-central/archive/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=472448">Bug 472448</a> - Add keyboard navigation and accessibility to minimonth. r=philipp
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#67;&#111;&#108;&#111;&#109;&#98;&#97;&#110;&#32;&#87;&#101;&#110;&#100;&#108;&#105;&#110;&#103;&#32;&#60;&#99;&#119;&#101;&#110;&#100;&#108;&#105;&#110;&#103;&#64;&#104;&#121;&#112;&#114;&#97;&#46;&#102;&#114;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 17 Mar 2017 04:21:00 +0100</td></tr>

<tr>
 <td>changeset 21316</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928">5c6b4b0d0451f43ba0ea0921f833c488fb3f4928</a></td>
</tr>



<tr>
<td>parent 21315</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/998197376939565dbbc14409cc330c4b65ade947">998197376939565dbbc14409cc330c4b65ade947</a>
</td>
</tr>

<tr>
<td>child 21317</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/1df067640ceebf58b01ab1705b0496c43f732d57">1df067640ceebf58b01ab1705b0496c43f732d57</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=5c6b4b0d0451f43ba0ea0921f833c488fb3f4928">12959</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Sun, 19 Mar 2017 21:46:53 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@1df067640cee [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1df067640ceebf58b01ab1705b0496c43f732d57">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=1df067640ceebf58b01ab1705b0496c43f732d57&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1df067640ceebf58b01ab1705b0496c43f732d57&newProject=comm-central&newRevision=7b1875cb7a3ae6529f986c418feb8e669f3e3d89&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1df067640ceebf58b01ab1705b0496c43f732d57&newProject=comm-central&newRevision=7b1875cb7a3ae6529f986c418feb8e669f3e3d89&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=1df067640ceebf58b01ab1705b0496c43f732d57&newProject=comm-central&newRevision=7b1875cb7a3ae6529f986c418feb8e669f3e3d89&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28philipp%29&revcount=50">philipp</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=472448">472448</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=472448">Bug 472448</a> - Add keyboard navigation and accessibility to minimonth. r=philipp</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/today-pane.xul">calendar/base/content/today-pane.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/today-pane.xul">file</a> |
<a href="/comm-central/annotate/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/today-pane.xul">annotate</a> |
<a href="/comm-central/diff/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/today-pane.xul">diff</a> |
<a href="/comm-central/comparison/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/today-pane.xul">comparison</a> |
<a href="/comm-central/log/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/today-pane.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/widgets/calendar-widget-bindings.css">calendar/base/content/widgets/calendar-widget-bindings.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/widgets/calendar-widget-bindings.css">file</a> |
<a href="/comm-central/annotate/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/widgets/calendar-widget-bindings.css">annotate</a> |
<a href="/comm-central/diff/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/widgets/calendar-widget-bindings.css">diff</a> |
<a href="/comm-central/comparison/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/widgets/calendar-widget-bindings.css">comparison</a> |
<a href="/comm-central/log/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/widgets/calendar-widget-bindings.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/widgets/minimonth.xml">calendar/base/content/widgets/minimonth.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/widgets/minimonth.xml">file</a> |
<a href="/comm-central/annotate/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/widgets/minimonth.xml">annotate</a> |
<a href="/comm-central/diff/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/widgets/minimonth.xml">diff</a> |
<a href="/comm-central/comparison/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/widgets/minimonth.xml">comparison</a> |
<a href="/comm-central/log/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/content/widgets/minimonth.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/themes/common/widgets/minimonth.css">calendar/base/themes/common/widgets/minimonth.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/themes/common/widgets/minimonth.css">file</a> |
<a href="/comm-central/annotate/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/themes/common/widgets/minimonth.css">annotate</a> |
<a href="/comm-central/diff/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/themes/common/widgets/minimonth.css">diff</a> |
<a href="/comm-central/comparison/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/themes/common/widgets/minimonth.css">comparison</a> |
<a href="/comm-central/log/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/base/themes/common/widgets/minimonth.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/locales/en-US/chrome/calendar/calendar.properties">calendar/locales/en-US/chrome/calendar/calendar.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/locales/en-US/chrome/calendar/calendar.properties">file</a> |
<a href="/comm-central/annotate/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/locales/en-US/chrome/calendar/calendar.properties">annotate</a> |
<a href="/comm-central/diff/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/locales/en-US/chrome/calendar/calendar.properties">diff</a> |
<a href="/comm-central/comparison/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/locales/en-US/chrome/calendar/calendar.properties">comparison</a> |
<a href="/comm-central/log/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/locales/en-US/chrome/calendar/calendar.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/resources/content/datetimepickers/datetimepickers.css">calendar/resources/content/datetimepickers/datetimepickers.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/resources/content/datetimepickers/datetimepickers.css">file</a> |
<a href="/comm-central/annotate/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/resources/content/datetimepickers/datetimepickers.css">annotate</a> |
<a href="/comm-central/diff/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/resources/content/datetimepickers/datetimepickers.css">diff</a> |
<a href="/comm-central/comparison/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/resources/content/datetimepickers/datetimepickers.css">comparison</a> |
<a href="/comm-central/log/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/resources/content/datetimepickers/datetimepickers.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/resources/content/datetimepickers/datetimepickers.xml">calendar/resources/content/datetimepickers/datetimepickers.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/resources/content/datetimepickers/datetimepickers.xml">file</a> |
<a href="/comm-central/annotate/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/resources/content/datetimepickers/datetimepickers.xml">annotate</a> |
<a href="/comm-central/diff/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/resources/content/datetimepickers/datetimepickers.xml">diff</a> |
<a href="/comm-central/comparison/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/resources/content/datetimepickers/datetimepickers.xml">comparison</a> |
<a href="/comm-central/log/5c6b4b0d0451f43ba0ea0921f833c488fb3f4928/calendar/resources/content/datetimepickers/datetimepickers.xml">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/content/today-pane.xul</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/content/today-pane.xul</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -142,17 +142,18 @@</span>
<a href="#l1.4"></a><span id="l1.4">                         &lt;label id=&quot;currentWeek-label&quot; class=&quot;monthlabel&quot;</span>
<a href="#l1.5"></a><span id="l1.5">                                ondblclick=&quot;TodayPane.onDoubleClick(event);&quot;/&gt;</span>
<a href="#l1.6"></a><span id="l1.6">                         &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l1.7"></a><span id="l1.7">                       &lt;/hbox&gt;</span>
<a href="#l1.8"></a><span id="l1.8">                     &lt;/vbox&gt;</span>
<a href="#l1.9"></a><span id="l1.9">                     &lt;toolbarbutton id=&quot;miniday-dropdown-button&quot;</span>
<a href="#l1.10"></a><span id="l1.10">                                    tooltiptext=&quot;&amp;showselectedday.tooltip;&quot;</span>
<a href="#l1.11"></a><span id="l1.11">                                    type=&quot;menu&quot;&gt;</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-                      &lt;panel id=&quot;miniday-month-panel&quot; position=&quot;after_end&quot;&gt;</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+                      &lt;panel id=&quot;miniday-month-panel&quot; position=&quot;after_end&quot;</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+                             onpopupshown=&quot;this.firstChild.focusCalendar();&quot;&gt;</span>
<a href="#l1.15"></a><span id="l1.15">                         &lt;minimonth id=&quot;todayMinimonth&quot;</span>
<a href="#l1.16"></a><span id="l1.16">                                    flex=&quot;1&quot;</span>
<a href="#l1.17"></a><span id="l1.17">                                    onchange=&quot;TodayPane.setDaywithjsDate(this.value);</span>
<a href="#l1.18"></a><span id="l1.18">                                              document.getElementById('miniday-month-panel').hidePopup();&quot;/&gt;</span>
<a href="#l1.19"></a><span id="l1.19">                       &lt;/panel&gt;</span>
<a href="#l1.20"></a><span id="l1.20">                    &lt;/toolbarbutton&gt;</span>
<a href="#l1.21"></a><span id="l1.21">                  &lt;/hbox&gt;</span>
<a href="#l1.22"></a><span id="l1.22">                 &lt;/stack&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/widgets/calendar-widget-bindings.css</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/widgets/calendar-widget-bindings.css</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -28,20 +28,16 @@ toolbarbutton[doubleimage=&quot;true&quot;] {</span>
<a href="#l2.4"></a><span id="l2.4"> toolbarbutton[todaypane=&quot;true&quot;] {</span>
<a href="#l2.5"></a><span id="l2.5">   -moz-binding: url(chrome://calendar/content/widgets/calendar-widgets.xml#todaypane-toolbarbutton);</span>
<a href="#l2.6"></a><span id="l2.6"> }</span>
<a href="#l2.7"></a><span id="l2.7"> </span>
<a href="#l2.8"></a><span id="l2.8"> minimonth {</span>
<a href="#l2.9"></a><span id="l2.9">   -moz-binding: url(&quot;chrome://calendar/content/widgets/minimonth.xml#minimonth&quot;);</span>
<a href="#l2.10"></a><span id="l2.10"> }</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-.minimonth-day {</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-  -moz-binding: url(&quot;chrome://calendar/content/widgets/minimonth.xml#minimonth-day&quot;);</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineminus">-}</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineminus">-</span>
<a href="#l2.16"></a><span id="l2.16"> minimonth-header {</span>
<a href="#l2.17"></a><span id="l2.17">   -moz-binding: url(&quot;chrome://calendar/content/widgets/minimonth.xml#active-minimonth-header&quot;);</span>
<a href="#l2.18"></a><span id="l2.18"> }</span>
<a href="#l2.19"></a><span id="l2.19"> </span>
<a href="#l2.20"></a><span id="l2.20"> minimonth-header[readonly=&quot;true&quot;] {</span>
<a href="#l2.21"></a><span id="l2.21">   -moz-binding: url(&quot;chrome://calendar/content/widgets/minimonth.xml#minimonth-header&quot;);</span>
<a href="#l2.22"></a><span id="l2.22"> }</span>
<a href="#l2.23"></a><span id="l2.23"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/widgets/minimonth.xml</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/widgets/minimonth.xml</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -30,16 +30,17 @@</span>
<a href="#l3.4"></a><span id="l3.4"> &lt;!DOCTYPE bindings</span>
<a href="#l3.5"></a><span id="l3.5"> [</span>
<a href="#l3.6"></a><span id="l3.6">     &lt;!ENTITY % dtd1 SYSTEM &quot;chrome://calendar/locale/global.dtd&quot; &gt; %dtd1;</span>
<a href="#l3.7"></a><span id="l3.7">     &lt;!ENTITY % dtd2 SYSTEM &quot;chrome://global/locale/global.dtd&quot; &gt; %dtd2;</span>
<a href="#l3.8"></a><span id="l3.8"> ]&gt;</span>
<a href="#l3.9"></a><span id="l3.9"> </span>
<a href="#l3.10"></a><span id="l3.10"> &lt;bindings id=&quot;xulMiniMonth&quot;</span>
<a href="#l3.11"></a><span id="l3.11">           xmlns=&quot;http://www.mozilla.org/xbl&quot;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+          xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l3.13"></a><span id="l3.13">           xmlns:xbl=&quot;http://www.mozilla.org/xbl&quot;</span>
<a href="#l3.14"></a><span id="l3.14">           xmlns:xul=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l3.15"></a><span id="l3.15"> </span>
<a href="#l3.16"></a><span id="l3.16">   &lt;binding id=&quot;minimonth-header&quot; extends=&quot;xul:box&quot;&gt;</span>
<a href="#l3.17"></a><span id="l3.17">     &lt;content class=&quot;minimonth-month-box&quot; align=&quot;center&quot;&gt;</span>
<a href="#l3.18"></a><span id="l3.18">       &lt;xul:deck anonid=&quot;monthheader&quot; xbl:inherits=&quot;selectedIndex=month&quot; class=&quot;minimonth-month-name-readonly&quot;&gt;</span>
<a href="#l3.19"></a><span id="l3.19">         &lt;xul:text value=&quot;&amp;month.1.name;&quot;/&gt;</span>
<a href="#l3.20"></a><span id="l3.20">         &lt;xul:text value=&quot;&amp;month.2.name;&quot;/&gt;</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineat">@@ -56,29 +57,29 @@</span>
<a href="#l3.22"></a><span id="l3.22">       &lt;/xul:deck&gt;</span>
<a href="#l3.23"></a><span id="l3.23">       &lt;xul:text anonid=&quot;yearcell&quot; class=&quot;minimonth-year-name-readonly&quot; xbl:inherits=&quot;value=year&quot;/&gt;</span>
<a href="#l3.24"></a><span id="l3.24">       &lt;xul:spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l3.25"></a><span id="l3.25">     &lt;/content&gt;</span>
<a href="#l3.26"></a><span id="l3.26">   &lt;/binding&gt;</span>
<a href="#l3.27"></a><span id="l3.27"> </span>
<a href="#l3.28"></a><span id="l3.28">   &lt;binding id=&quot;active-minimonth-header&quot; extends=&quot;chrome://calendar/content/widgets/minimonth.xml#minimonth-header&quot;&gt;</span>
<a href="#l3.29"></a><span id="l3.29">     &lt;content class=&quot;minimonth-month-box&quot; align=&quot;center&quot;&gt;</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineminus">-      &lt;xul:deck anonid=&quot;monthheader&quot; xbl:inherits=&quot;selectedIndex=month&quot;  class=&quot;minimonth-month-name&quot;&gt;</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-        &lt;xul:toolbarbutton label=&quot;&amp;month.1.name;&quot; oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineminus">-        &lt;xul:toolbarbutton label=&quot;&amp;month.2.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineminus">-        &lt;xul:toolbarbutton label=&quot;&amp;month.3.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineminus">-        &lt;xul:toolbarbutton label=&quot;&amp;month.4.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineminus">-        &lt;xul:toolbarbutton label=&quot;&amp;month.5.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineminus">-        &lt;xul:toolbarbutton label=&quot;&amp;month.6.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineminus">-        &lt;xul:toolbarbutton label=&quot;&amp;month.7.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineminus">-        &lt;xul:toolbarbutton label=&quot;&amp;month.8.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineminus">-        &lt;xul:toolbarbutton label=&quot;&amp;month.9.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineminus">-        &lt;xul:toolbarbutton label=&quot;&amp;month.10.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.41"></a><span id="l3.41" class="difflineminus">-        &lt;xul:toolbarbutton label=&quot;&amp;month.11.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.42"></a><span id="l3.42" class="difflineminus">-        &lt;xul:toolbarbutton label=&quot;&amp;month.12.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.43"></a><span id="l3.43" class="difflineplus">+      &lt;xul:deck anonid=&quot;monthheader&quot; xbl:inherits=&quot;selectedIndex=month&quot;&gt;</span>
<a href="#l3.44"></a><span id="l3.44" class="difflineplus">+        &lt;xul:toolbarbutton class=&quot;minimonth-month-name&quot; label=&quot;&amp;month.1.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.45"></a><span id="l3.45" class="difflineplus">+        &lt;xul:toolbarbutton class=&quot;minimonth-month-name&quot; label=&quot;&amp;month.2.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.46"></a><span id="l3.46" class="difflineplus">+        &lt;xul:toolbarbutton class=&quot;minimonth-month-name&quot; label=&quot;&amp;month.3.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.47"></a><span id="l3.47" class="difflineplus">+        &lt;xul:toolbarbutton class=&quot;minimonth-month-name&quot; label=&quot;&amp;month.4.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineplus">+        &lt;xul:toolbarbutton class=&quot;minimonth-month-name&quot; label=&quot;&amp;month.5.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineplus">+        &lt;xul:toolbarbutton class=&quot;minimonth-month-name&quot; label=&quot;&amp;month.6.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.50"></a><span id="l3.50" class="difflineplus">+        &lt;xul:toolbarbutton class=&quot;minimonth-month-name&quot; label=&quot;&amp;month.7.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineplus">+        &lt;xul:toolbarbutton class=&quot;minimonth-month-name&quot; label=&quot;&amp;month.8.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.52"></a><span id="l3.52" class="difflineplus">+        &lt;xul:toolbarbutton class=&quot;minimonth-month-name&quot; label=&quot;&amp;month.9.name;&quot;  oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.53"></a><span id="l3.53" class="difflineplus">+        &lt;xul:toolbarbutton class=&quot;minimonth-month-name&quot; label=&quot;&amp;month.10.name;&quot; oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.54"></a><span id="l3.54" class="difflineplus">+        &lt;xul:toolbarbutton class=&quot;minimonth-month-name&quot; label=&quot;&amp;month.11.name;&quot; oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.55"></a><span id="l3.55" class="difflineplus">+        &lt;xul:toolbarbutton class=&quot;minimonth-month-name&quot; label=&quot;&amp;month.12.name;&quot; oncommand=&quot;showPopupList(event, 'months-popup')&quot;/&gt;</span>
<a href="#l3.56"></a><span id="l3.56">       &lt;/xul:deck&gt;</span>
<a href="#l3.57"></a><span id="l3.57">       &lt;xul:toolbarbutton anonid=&quot;yearcell&quot;</span>
<a href="#l3.58"></a><span id="l3.58">                          class=&quot;minimonth-year-name&quot;</span>
<a href="#l3.59"></a><span id="l3.59">                          oncommand=&quot;showPopupList(event, 'years-popup')&quot;</span>
<a href="#l3.60"></a><span id="l3.60">                          xbl:inherits=&quot;label=year&quot;/&gt;</span>
<a href="#l3.61"></a><span id="l3.61">       &lt;xul:spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l3.62"></a><span id="l3.62">       &lt;xul:toolbarbutton anonid=&quot;back-button&quot; class=&quot;minimonth-nav-btns&quot; dir=&quot;-1&quot;</span>
<a href="#l3.63"></a><span id="l3.63">                          oncommand=&quot;this.kMinimonth.advanceMonth(parseInt(this.getAttribute('dir'), 10))&quot;</span>
<a href="#l3.64"></a><span id="l3.64" class="difflineat">@@ -88,51 +89,47 @@</span>
<a href="#l3.65"></a><span id="l3.65">                          tooltiptext=&quot;&amp;showToday.tooltip;&quot;/&gt;</span>
<a href="#l3.66"></a><span id="l3.66">       &lt;xul:toolbarbutton anonid=&quot;forward-button&quot; class=&quot;minimonth-nav-btns&quot; dir=&quot;1&quot;</span>
<a href="#l3.67"></a><span id="l3.67">                          oncommand=&quot;this.kMinimonth.advanceMonth(parseInt(this.getAttribute('dir'), 10))&quot;</span>
<a href="#l3.68"></a><span id="l3.68">                          tooltiptext=&quot;&amp;onemonthforward.tooltip;&quot;/&gt;</span>
<a href="#l3.69"></a><span id="l3.69">       &lt;xul:popupset anonid=&quot;minmonth-popupset&quot;&gt;</span>
<a href="#l3.70"></a><span id="l3.70">         &lt;xul:menupopup anonid=&quot;months-popup&quot; position=&quot;after_start&quot;</span>
<a href="#l3.71"></a><span id="l3.71">                        onpopupshowing=&quot;event.stopPropagation();&quot;</span>
<a href="#l3.72"></a><span id="l3.72">                        onpopuphidden=&quot;firePopupListHidden();&quot;&gt;</span>
<a href="#l3.73"></a><span id="l3.73" class="difflineminus">-          &lt;xul:vbox&gt;</span>
<a href="#l3.74"></a><span id="l3.74" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot; value=&quot;&amp;month.1.name;&quot; index=&quot;0&quot;/&gt;</span>
<a href="#l3.75"></a><span id="l3.75" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot; value=&quot;&amp;month.2.name;&quot; index=&quot;1&quot;/&gt;</span>
<a href="#l3.76"></a><span id="l3.76" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot; value=&quot;&amp;month.3.name;&quot; index=&quot;2&quot;/&gt;</span>
<a href="#l3.77"></a><span id="l3.77" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot; value=&quot;&amp;month.4.name;&quot; index=&quot;3&quot;/&gt;</span>
<a href="#l3.78"></a><span id="l3.78" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot; value=&quot;&amp;month.5.name;&quot; index=&quot;4&quot;/&gt;</span>
<a href="#l3.79"></a><span id="l3.79" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot; value=&quot;&amp;month.6.name;&quot; index=&quot;5&quot;/&gt;</span>
<a href="#l3.80"></a><span id="l3.80" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot; value=&quot;&amp;month.7.name;&quot; index=&quot;6&quot;/&gt;</span>
<a href="#l3.81"></a><span id="l3.81" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot; value=&quot;&amp;month.8.name;&quot; index=&quot;7&quot;/&gt;</span>
<a href="#l3.82"></a><span id="l3.82" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot; value=&quot;&amp;month.9.name;&quot; index=&quot;8&quot;/&gt;</span>
<a href="#l3.83"></a><span id="l3.83" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot; value=&quot;&amp;month.10.name;&quot; index=&quot;9&quot;/&gt;</span>
<a href="#l3.84"></a><span id="l3.84" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot; value=&quot;&amp;month.11.name;&quot; index=&quot;10&quot;/&gt;</span>
<a href="#l3.85"></a><span id="l3.85" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot; value=&quot;&amp;month.12.name;&quot; index=&quot;11&quot;/&gt;</span>
<a href="#l3.86"></a><span id="l3.86" class="difflineminus">-          &lt;/xul:vbox&gt;</span>
<a href="#l3.87"></a><span id="l3.87" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onMonthsPopupCommand(this)&quot; label=&quot;&amp;month.1.name;&quot;  index=&quot;0&quot;/&gt;</span>
<a href="#l3.88"></a><span id="l3.88" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onMonthsPopupCommand(this)&quot; label=&quot;&amp;month.2.name;&quot;  index=&quot;1&quot;/&gt;</span>
<a href="#l3.89"></a><span id="l3.89" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onMonthsPopupCommand(this)&quot; label=&quot;&amp;month.3.name;&quot;  index=&quot;2&quot;/&gt;</span>
<a href="#l3.90"></a><span id="l3.90" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onMonthsPopupCommand(this)&quot; label=&quot;&amp;month.4.name;&quot;  index=&quot;3&quot;/&gt;</span>
<a href="#l3.91"></a><span id="l3.91" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onMonthsPopupCommand(this)&quot; label=&quot;&amp;month.5.name;&quot;  index=&quot;4&quot;/&gt;</span>
<a href="#l3.92"></a><span id="l3.92" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onMonthsPopupCommand(this)&quot; label=&quot;&amp;month.6.name;&quot;  index=&quot;5&quot;/&gt;</span>
<a href="#l3.93"></a><span id="l3.93" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onMonthsPopupCommand(this)&quot; label=&quot;&amp;month.7.name;&quot;  index=&quot;6&quot;/&gt;</span>
<a href="#l3.94"></a><span id="l3.94" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onMonthsPopupCommand(this)&quot; label=&quot;&amp;month.8.name;&quot;  index=&quot;7&quot;/&gt;</span>
<a href="#l3.95"></a><span id="l3.95" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onMonthsPopupCommand(this)&quot; label=&quot;&amp;month.9.name;&quot;  index=&quot;8&quot;/&gt;</span>
<a href="#l3.96"></a><span id="l3.96" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onMonthsPopupCommand(this)&quot; label=&quot;&amp;month.10.name;&quot; index=&quot;9&quot;/&gt;</span>
<a href="#l3.97"></a><span id="l3.97" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onMonthsPopupCommand(this)&quot; label=&quot;&amp;month.11.name;&quot; index=&quot;10&quot;/&gt;</span>
<a href="#l3.98"></a><span id="l3.98" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onMonthsPopupCommand(this)&quot; label=&quot;&amp;month.12.name;&quot; index=&quot;11&quot;/&gt;</span>
<a href="#l3.99"></a><span id="l3.99">         &lt;/xul:menupopup&gt;</span>
<a href="#l3.100"></a><span id="l3.100">         &lt;xul:menupopup anonid=&quot;years-popup&quot; position=&quot;after_start&quot;</span>
<a href="#l3.101"></a><span id="l3.101">                        onpopupshowing=&quot;moveYears('reset', 0); event.stopPropagation();&quot;</span>
<a href="#l3.102"></a><span id="l3.102">                        onpopuphidden=&quot;firePopupListHidden();&quot;&gt;</span>
<a href="#l3.103"></a><span id="l3.103" class="difflineminus">-          &lt;xul:vbox&gt;</span>
<a href="#l3.104"></a><span id="l3.104" class="difflineminus">-            &lt;xul:autorepeatbutton class=&quot;autorepeatbutton-up&quot;</span>
<a href="#l3.105"></a><span id="l3.105" class="difflineminus">-                                  orient=&quot;vertical&quot;</span>
<a href="#l3.106"></a><span id="l3.106" class="difflineminus">-                                  oncommand=&quot;moveYears('up', 1);&quot;/&gt;</span>
<a href="#l3.107"></a><span id="l3.107" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot;/&gt;</span>
<a href="#l3.108"></a><span id="l3.108" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot;/&gt;</span>
<a href="#l3.109"></a><span id="l3.109" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot;/&gt;</span>
<a href="#l3.110"></a><span id="l3.110" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot;/&gt;</span>
<a href="#l3.111"></a><span id="l3.111" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot;/&gt;</span>
<a href="#l3.112"></a><span id="l3.112" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot;/&gt;</span>
<a href="#l3.113"></a><span id="l3.113" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot;/&gt;</span>
<a href="#l3.114"></a><span id="l3.114" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot;/&gt;</span>
<a href="#l3.115"></a><span id="l3.115" class="difflineminus">-            &lt;xul:text class=&quot;minimonth-list&quot;/&gt;</span>
<a href="#l3.116"></a><span id="l3.116" class="difflineminus">-            &lt;xul:autorepeatbutton class=&quot;autorepeatbutton-down&quot;</span>
<a href="#l3.117"></a><span id="l3.117" class="difflineminus">-                                  orient=&quot;vertical&quot;</span>
<a href="#l3.118"></a><span id="l3.118" class="difflineminus">-                                  oncommand=&quot;moveYears('down', 1);&quot;/&gt;</span>
<a href="#l3.119"></a><span id="l3.119" class="difflineminus">-          &lt;/xul:vbox&gt;</span>
<a href="#l3.120"></a><span id="l3.120" class="difflineplus">+          &lt;xul:autorepeatbutton class=&quot;autorepeatbutton-up&quot;</span>
<a href="#l3.121"></a><span id="l3.121" class="difflineplus">+                                orient=&quot;vertical&quot;</span>
<a href="#l3.122"></a><span id="l3.122" class="difflineplus">+                                oncommand=&quot;moveYears('up', 1);&quot;/&gt;</span>
<a href="#l3.123"></a><span id="l3.123" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onYearsPopupCommand(this)&quot;/&gt;</span>
<a href="#l3.124"></a><span id="l3.124" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onYearsPopupCommand(this)&quot;/&gt;</span>
<a href="#l3.125"></a><span id="l3.125" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onYearsPopupCommand(this)&quot;/&gt;</span>
<a href="#l3.126"></a><span id="l3.126" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onYearsPopupCommand(this)&quot;/&gt;</span>
<a href="#l3.127"></a><span id="l3.127" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onYearsPopupCommand(this)&quot;/&gt;</span>
<a href="#l3.128"></a><span id="l3.128" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onYearsPopupCommand(this)&quot;/&gt;</span>
<a href="#l3.129"></a><span id="l3.129" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onYearsPopupCommand(this)&quot;/&gt;</span>
<a href="#l3.130"></a><span id="l3.130" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onYearsPopupCommand(this)&quot;/&gt;</span>
<a href="#l3.131"></a><span id="l3.131" class="difflineplus">+          &lt;xul:menuitem class=&quot;minimonth-list&quot; oncommand=&quot;onYearsPopupCommand(this)&quot;/&gt;</span>
<a href="#l3.132"></a><span id="l3.132" class="difflineplus">+          &lt;xul:autorepeatbutton class=&quot;autorepeatbutton-down&quot;</span>
<a href="#l3.133"></a><span id="l3.133" class="difflineplus">+                                orient=&quot;vertical&quot;</span>
<a href="#l3.134"></a><span id="l3.134" class="difflineplus">+                                oncommand=&quot;moveYears('down', 1);&quot;/&gt;</span>
<a href="#l3.135"></a><span id="l3.135">         &lt;/xul:menupopup&gt;</span>
<a href="#l3.136"></a><span id="l3.136">       &lt;/xul:popupset&gt;</span>
<a href="#l3.137"></a><span id="l3.137">     &lt;/content&gt;</span>
<a href="#l3.138"></a><span id="l3.138">     &lt;implementation&gt;</span>
<a href="#l3.139"></a><span id="l3.139">       &lt;field name=&quot;kMinimonth&quot;&gt;null&lt;/field&gt;</span>
<a href="#l3.140"></a><span id="l3.140">       &lt;field name=&quot;mPopup&quot;&gt;null&lt;/field&gt;</span>
<a href="#l3.141"></a><span id="l3.141">       &lt;field name=&quot;mScrollYearsHandler&quot;&gt;null&lt;/field&gt;</span>
<a href="#l3.142"></a><span id="l3.142">       &lt;field name=&quot;mPixelScrollDelta&quot;&gt;0&lt;/field&gt;</span>
<a href="#l3.143"></a><span id="l3.143" class="difflineat">@@ -181,37 +178,62 @@</span>
<a href="#l3.144"></a><span id="l3.144">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.145"></a><span id="l3.145">           if (this.mPopup) {</span>
<a href="#l3.146"></a><span id="l3.146">               this.mPopup = null;</span>
<a href="#l3.147"></a><span id="l3.147">               this.kMinimonth.fireEvent(&quot;popuplisthidden&quot;);</span>
<a href="#l3.148"></a><span id="l3.148">           }</span>
<a href="#l3.149"></a><span id="l3.149">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.150"></a><span id="l3.150">       &lt;/method&gt;</span>
<a href="#l3.151"></a><span id="l3.151"> </span>
<a href="#l3.152"></a><span id="l3.152" class="difflineplus">+      &lt;method name=&quot;onMonthsPopupCommand&quot;&gt;</span>
<a href="#l3.153"></a><span id="l3.153" class="difflineplus">+        &lt;parameter name=&quot;aItem&quot;/&gt;</span>
<a href="#l3.154"></a><span id="l3.154" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.155"></a><span id="l3.155" class="difflineplus">+          let popup = getParentNodeOrThis(aItem, &quot;menupopup&quot;);</span>
<a href="#l3.156"></a><span id="l3.156" class="difflineplus">+          let triggerNode = popup.triggerNode || popup.anchorNode;</span>
<a href="#l3.157"></a><span id="l3.157" class="difflineplus">+          let deck = triggerNode.parentNode;</span>
<a href="#l3.158"></a><span id="l3.158" class="difflineplus">+</span>
<a href="#l3.159"></a><span id="l3.159" class="difflineplus">+          this.hidePopupList();</span>
<a href="#l3.160"></a><span id="l3.160" class="difflineplus">+          this.kMinimonth.switchMonth(aItem.getAttribute(&quot;index&quot;));</span>
<a href="#l3.161"></a><span id="l3.161" class="difflineplus">+</span>
<a href="#l3.162"></a><span id="l3.162" class="difflineplus">+          deck.childNodes[deck.selectedIndex].focus();</span>
<a href="#l3.163"></a><span id="l3.163" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l3.164"></a><span id="l3.164" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l3.165"></a><span id="l3.165" class="difflineplus">+</span>
<a href="#l3.166"></a><span id="l3.166" class="difflineplus">+      &lt;method name=&quot;onYearsPopupCommand&quot;&gt;</span>
<a href="#l3.167"></a><span id="l3.167" class="difflineplus">+        &lt;parameter name=&quot;aItem&quot;/&gt;</span>
<a href="#l3.168"></a><span id="l3.168" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.169"></a><span id="l3.169" class="difflineplus">+          this.hidePopupList();</span>
<a href="#l3.170"></a><span id="l3.170" class="difflineplus">+          let value = aItem.getAttribute(&quot;label&quot;);</span>
<a href="#l3.171"></a><span id="l3.171" class="difflineplus">+          if (value) {</span>
<a href="#l3.172"></a><span id="l3.172" class="difflineplus">+              this.kMinimonth.switchYear(value);</span>
<a href="#l3.173"></a><span id="l3.173" class="difflineplus">+          }</span>
<a href="#l3.174"></a><span id="l3.174" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l3.175"></a><span id="l3.175" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l3.176"></a><span id="l3.176" class="difflineplus">+</span>
<a href="#l3.177"></a><span id="l3.177">       &lt;method name=&quot;updateMonthPopup&quot;&gt;</span>
<a href="#l3.178"></a><span id="l3.178">         &lt;parameter name=&quot;aDate&quot;/&gt;</span>
<a href="#l3.179"></a><span id="l3.179">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.180"></a><span id="l3.180" class="difflineminus">-          let months = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;months-popup&quot;).firstChild.childNodes;</span>
<a href="#l3.181"></a><span id="l3.181" class="difflineplus">+          let months = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;months-popup&quot;).childNodes;</span>
<a href="#l3.182"></a><span id="l3.182">           let month = aDate.getMonth();</span>
<a href="#l3.183"></a><span id="l3.183">           for (let i = 0; i &lt; months.length; i++) {</span>
<a href="#l3.184"></a><span id="l3.184">               months[i].setAttribute(&quot;current&quot;, i == month ? &quot;true&quot; : &quot;false&quot;);</span>
<a href="#l3.185"></a><span id="l3.185">           }</span>
<a href="#l3.186"></a><span id="l3.186">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.187"></a><span id="l3.187">       &lt;/method&gt;</span>
<a href="#l3.188"></a><span id="l3.188"> </span>
<a href="#l3.189"></a><span id="l3.189">       &lt;method name=&quot;updateYearPopup&quot;&gt;</span>
<a href="#l3.190"></a><span id="l3.190">         &lt;parameter name=&quot;aDate&quot;/&gt;</span>
<a href="#l3.191"></a><span id="l3.191">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.192"></a><span id="l3.192" class="difflineminus">-          let years = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;years-popup&quot;).firstChild.childNodes;</span>
<a href="#l3.193"></a><span id="l3.193" class="difflineplus">+          let years = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;years-popup&quot;).childNodes;</span>
<a href="#l3.194"></a><span id="l3.194">           let year = new Date(aDate);</span>
<a href="#l3.195"></a><span id="l3.195">           let compFullYear = aDate.getFullYear();</span>
<a href="#l3.196"></a><span id="l3.196">           year.setFullYear(Math.max(1, compFullYear - Math.trunc(years.length / 2) + 1));</span>
<a href="#l3.197"></a><span id="l3.197">           for (let i = 1; i &lt; years.length - 1; i++) {</span>
<a href="#l3.198"></a><span id="l3.198">               let curfullYear = year.getFullYear();</span>
<a href="#l3.199"></a><span id="l3.199" class="difflineminus">-              years[i].setAttribute(&quot;value&quot;, curfullYear);</span>
<a href="#l3.200"></a><span id="l3.200" class="difflineplus">+              years[i].setAttribute(&quot;label&quot;, curfullYear);</span>
<a href="#l3.201"></a><span id="l3.201">               years[i].setAttribute(&quot;current&quot;, curfullYear == compFullYear ? &quot;true&quot; : &quot;false&quot;);</span>
<a href="#l3.202"></a><span id="l3.202">               year.setFullYear(curfullYear + 1);</span>
<a href="#l3.203"></a><span id="l3.203">           }</span>
<a href="#l3.204"></a><span id="l3.204">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.205"></a><span id="l3.205">       &lt;/method&gt;</span>
<a href="#l3.206"></a><span id="l3.206"> </span>
<a href="#l3.207"></a><span id="l3.207">       &lt;method name=&quot;scrollYears&quot;&gt;</span>
<a href="#l3.208"></a><span id="l3.208">         &lt;parameter name=&quot;event&quot;/&gt;</span>
<a href="#l3.209"></a><span id="l3.209" class="difflineat">@@ -245,191 +267,165 @@</span>
<a href="#l3.210"></a><span id="l3.210">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.211"></a><span id="l3.211">       &lt;/method&gt;</span>
<a href="#l3.212"></a><span id="l3.212"> </span>
<a href="#l3.213"></a><span id="l3.213">       &lt;method name=&quot;moveYears&quot;&gt;</span>
<a href="#l3.214"></a><span id="l3.214">         &lt;parameter name=&quot;direction&quot;/&gt;</span>
<a href="#l3.215"></a><span id="l3.215">         &lt;parameter name=&quot;scrollOffset&quot;/&gt;</span>
<a href="#l3.216"></a><span id="l3.216">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.217"></a><span id="l3.217">           // Update the year popup</span>
<a href="#l3.218"></a><span id="l3.218" class="difflineminus">-          let years = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;years-popup&quot;).firstChild.childNodes;</span>
<a href="#l3.219"></a><span id="l3.219" class="difflineplus">+          let years = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;years-popup&quot;).childNodes;</span>
<a href="#l3.220"></a><span id="l3.220">           let current = this.getAttribute(&quot;year&quot;);</span>
<a href="#l3.221"></a><span id="l3.221">           let offset;</span>
<a href="#l3.222"></a><span id="l3.222">           switch (direction) {</span>
<a href="#l3.223"></a><span id="l3.223">               case &quot;reset&quot;: {</span>
<a href="#l3.224"></a><span id="l3.224" class="difflineminus">-                  let middleyear = years[Math.floor(years.length / 2)].getAttribute(&quot;value&quot;);</span>
<a href="#l3.225"></a><span id="l3.225" class="difflineplus">+                  let middleyear = years[Math.floor(years.length / 2)].getAttribute(&quot;label&quot;);</span>
<a href="#l3.226"></a><span id="l3.226">                   if (current &lt;= (years.length / 2)) {</span>
<a href="#l3.227"></a><span id="l3.227" class="difflineminus">-                      offset = 1 - years[1].getAttribute(&quot;value&quot;);</span>
<a href="#l3.228"></a><span id="l3.228" class="difflineplus">+                      offset = 1 - years[1].getAttribute(&quot;label&quot;);</span>
<a href="#l3.229"></a><span id="l3.229">                   } else {</span>
<a href="#l3.230"></a><span id="l3.230">                       offset = current - middleyear;</span>
<a href="#l3.231"></a><span id="l3.231">                   }</span>
<a href="#l3.232"></a><span id="l3.232">                   break;</span>
<a href="#l3.233"></a><span id="l3.233">               }</span>
<a href="#l3.234"></a><span id="l3.234">               case &quot;up&quot;: {</span>
<a href="#l3.235"></a><span id="l3.235">                   offset = -Math.abs(scrollOffset) || -1;</span>
<a href="#l3.236"></a><span id="l3.236">                   break;</span>
<a href="#l3.237"></a><span id="l3.237">               }</span>
<a href="#l3.238"></a><span id="l3.238">               case &quot;down&quot;: {</span>
<a href="#l3.239"></a><span id="l3.239">                   offset = Math.abs(scrollOffset) || 1;</span>
<a href="#l3.240"></a><span id="l3.240">                   break;</span>
<a href="#l3.241"></a><span id="l3.241">               }</span>
<a href="#l3.242"></a><span id="l3.242">           }</span>
<a href="#l3.243"></a><span id="l3.243"> </span>
<a href="#l3.244"></a><span id="l3.244">           // Disable the up arrow when we get to the year 1.</span>
<a href="#l3.245"></a><span id="l3.245" class="difflineminus">-          years[0].disabled = parseInt(years[1].getAttribute(&quot;value&quot;), 10) + offset &lt; 2;</span>
<a href="#l3.246"></a><span id="l3.246" class="difflineplus">+          years[0].disabled = parseInt(years[1].getAttribute(&quot;label&quot;), 10) + offset &lt; 2;</span>
<a href="#l3.247"></a><span id="l3.247"> </span>
<a href="#l3.248"></a><span id="l3.248">           if (!offset) {</span>
<a href="#l3.249"></a><span id="l3.249">               // No need to loop through when the offset is zero.</span>
<a href="#l3.250"></a><span id="l3.250">               return;</span>
<a href="#l3.251"></a><span id="l3.251">           }</span>
<a href="#l3.252"></a><span id="l3.252"> </span>
<a href="#l3.253"></a><span id="l3.253">           // Go through all visible years and set the new value. Be sure to</span>
<a href="#l3.254"></a><span id="l3.254">           // skip the autorepeatbuttons.</span>
<a href="#l3.255"></a><span id="l3.255">           for (let i = 1; i &lt; years.length - 1; i++) {</span>
<a href="#l3.256"></a><span id="l3.256" class="difflineminus">-              let value = parseInt(years[i].getAttribute(&quot;value&quot;), 10) + offset;</span>
<a href="#l3.257"></a><span id="l3.257" class="difflineminus">-              years[i].setAttribute(&quot;value&quot;, value);</span>
<a href="#l3.258"></a><span id="l3.258" class="difflineplus">+              let value = parseInt(years[i].getAttribute(&quot;label&quot;), 10) + offset;</span>
<a href="#l3.259"></a><span id="l3.259" class="difflineplus">+              years[i].setAttribute(&quot;label&quot;, value);</span>
<a href="#l3.260"></a><span id="l3.260">               years[i].setAttribute(&quot;current&quot;, value == current ? &quot;true&quot; : &quot;false&quot;);</span>
<a href="#l3.261"></a><span id="l3.261">           }</span>
<a href="#l3.262"></a><span id="l3.262">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.263"></a><span id="l3.263">       &lt;/method&gt;</span>
<a href="#l3.264"></a><span id="l3.264">     &lt;/implementation&gt;</span>
<a href="#l3.265"></a><span id="l3.265"> </span>
<a href="#l3.266"></a><span id="l3.266">     &lt;handlers&gt;</span>
<a href="#l3.267"></a><span id="l3.267">       &lt;handler event=&quot;bindingattached&quot; action=&quot;this.initialize();&quot;/&gt;</span>
<a href="#l3.268"></a><span id="l3.268" class="difflineminus">-</span>
<a href="#l3.269"></a><span id="l3.269" class="difflineminus">-      &lt;!-- handle click from nested months popup and years popup --&gt;</span>
<a href="#l3.270"></a><span id="l3.270" class="difflineminus">-      &lt;handler event=&quot;click&quot;&gt;&lt;![CDATA[</span>
<a href="#l3.271"></a><span id="l3.271" class="difflineminus">-        let element = event.originalTarget;</span>
<a href="#l3.272"></a><span id="l3.272" class="difflineminus">-        let popup = getParentNodeOrThis(element, &quot;menupopup&quot;);</span>
<a href="#l3.273"></a><span id="l3.273" class="difflineminus">-        if (popup) {</span>
<a href="#l3.274"></a><span id="l3.274" class="difflineminus">-            let anonid = popup.getAttribute(&quot;anonid&quot;);</span>
<a href="#l3.275"></a><span id="l3.275" class="difflineminus">-            switch (anonid) {</span>
<a href="#l3.276"></a><span id="l3.276" class="difflineminus">-                case &quot;months-popup&quot;: {</span>
<a href="#l3.277"></a><span id="l3.277" class="difflineminus">-                    this.hidePopupList();</span>
<a href="#l3.278"></a><span id="l3.278" class="difflineminus">-                    this.kMinimonth.switchMonth(element.getAttribute(&quot;index&quot;));</span>
<a href="#l3.279"></a><span id="l3.279" class="difflineminus">-                    break;</span>
<a href="#l3.280"></a><span id="l3.280" class="difflineminus">-                }</span>
<a href="#l3.281"></a><span id="l3.281" class="difflineminus">-                case &quot;years-popup&quot;: {</span>
<a href="#l3.282"></a><span id="l3.282" class="difflineminus">-                    this.hidePopupList();</span>
<a href="#l3.283"></a><span id="l3.283" class="difflineminus">-                    let value = element.getAttribute(&quot;value&quot;);</span>
<a href="#l3.284"></a><span id="l3.284" class="difflineminus">-                    if (value) {</span>
<a href="#l3.285"></a><span id="l3.285" class="difflineminus">-                        this.kMinimonth.switchYear(value);</span>
<a href="#l3.286"></a><span id="l3.286" class="difflineminus">-                    }</span>
<a href="#l3.287"></a><span id="l3.287" class="difflineminus">-                    break;</span>
<a href="#l3.288"></a><span id="l3.288" class="difflineminus">-                }</span>
<a href="#l3.289"></a><span id="l3.289" class="difflineminus">-            }</span>
<a href="#l3.290"></a><span id="l3.290" class="difflineminus">-        }</span>
<a href="#l3.291"></a><span id="l3.291" class="difflineminus">-      ]]&gt;&lt;/handler&gt;</span>
<a href="#l3.292"></a><span id="l3.292">     &lt;/handlers&gt;</span>
<a href="#l3.293"></a><span id="l3.293">   &lt;/binding&gt;</span>
<a href="#l3.294"></a><span id="l3.294"> </span>
<a href="#l3.295"></a><span id="l3.295">   &lt;binding id=&quot;minimonth&quot; extends=&quot;xul:box&quot;&gt;</span>
<a href="#l3.296"></a><span id="l3.296">     &lt;resources&gt;</span>
<a href="#l3.297"></a><span id="l3.297">       &lt;stylesheet src=&quot;chrome://calendar-common/skin/widgets/minimonth.css&quot;/&gt;</span>
<a href="#l3.298"></a><span id="l3.298">     &lt;/resources&gt;</span>
<a href="#l3.299"></a><span id="l3.299"> </span>
<a href="#l3.300"></a><span id="l3.300" class="difflineminus">-    &lt;content orient=&quot;vertical&quot; xbl:inherits=&quot;onchange,onmonthchange,onpopuplisthidden,readonly&quot;&gt;</span>
<a href="#l3.301"></a><span id="l3.301" class="difflineplus">+    &lt;content orient=&quot;vertical&quot; xbl:inherits=&quot;onchange,onmonthchange,onpopuplisthidden,readonly&quot; role=&quot;group&quot;&gt;</span>
<a href="#l3.302"></a><span id="l3.302">       &lt;xul:minimonth-header anonid=&quot;minimonth-header&quot; xbl:inherits=&quot;readonly,month,year&quot;/&gt;</span>
<a href="#l3.303"></a><span id="l3.303" class="difflineminus">-      &lt;xul:vbox anonid=&quot;minimonth-calendar&quot; class=&quot;minimonth-cal-box&quot;&gt;</span>
<a href="#l3.304"></a><span id="l3.304" class="difflineminus">-        &lt;xul:hbox class=&quot;minimonth-row-head&quot; anonid=&quot;minimonth-row-header&quot; equalsize=&quot;always&quot;&gt;</span>
<a href="#l3.305"></a><span id="l3.305" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-row-header-week&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.306"></a><span id="l3.306" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-row-header&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.307"></a><span id="l3.307" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-row-header&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.308"></a><span id="l3.308" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-row-header&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.309"></a><span id="l3.309" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-row-header&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.310"></a><span id="l3.310" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-row-header&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.311"></a><span id="l3.311" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-row-header&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.312"></a><span id="l3.312" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-row-header&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.313"></a><span id="l3.313" class="difflineminus">-        &lt;/xul:hbox&gt;</span>
<a href="#l3.314"></a><span id="l3.314" class="difflineminus">-        &lt;xul:hbox class=&quot;minimonth-row-body&quot; equalsize=&quot;always&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l3.315"></a><span id="l3.315" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-week&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.316"></a><span id="l3.316" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.317"></a><span id="l3.317" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.318"></a><span id="l3.318" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.319"></a><span id="l3.319" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.320"></a><span id="l3.320" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.321"></a><span id="l3.321" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.322"></a><span id="l3.322" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.323"></a><span id="l3.323" class="difflineminus">-        &lt;/xul:hbox&gt;</span>
<a href="#l3.324"></a><span id="l3.324" class="difflineminus">-        &lt;xul:hbox class=&quot;minimonth-row-body&quot; equalsize=&quot;always&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l3.325"></a><span id="l3.325" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-week&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.326"></a><span id="l3.326" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.327"></a><span id="l3.327" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.328"></a><span id="l3.328" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.329"></a><span id="l3.329" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.330"></a><span id="l3.330" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.331"></a><span id="l3.331" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.332"></a><span id="l3.332" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.333"></a><span id="l3.333" class="difflineminus">-        &lt;/xul:hbox&gt;</span>
<a href="#l3.334"></a><span id="l3.334" class="difflineminus">-        &lt;xul:hbox class=&quot;minimonth-row-body&quot; equalsize=&quot;always&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l3.335"></a><span id="l3.335" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-week&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.336"></a><span id="l3.336" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.337"></a><span id="l3.337" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.338"></a><span id="l3.338" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.339"></a><span id="l3.339" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.340"></a><span id="l3.340" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.341"></a><span id="l3.341" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.342"></a><span id="l3.342" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.343"></a><span id="l3.343" class="difflineminus">-        &lt;/xul:hbox&gt;</span>
<a href="#l3.344"></a><span id="l3.344" class="difflineminus">-        &lt;xul:hbox class=&quot;minimonth-row-body&quot; equalsize=&quot;always&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l3.345"></a><span id="l3.345" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-week&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.346"></a><span id="l3.346" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.347"></a><span id="l3.347" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.348"></a><span id="l3.348" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.349"></a><span id="l3.349" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.350"></a><span id="l3.350" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.351"></a><span id="l3.351" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.352"></a><span id="l3.352" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.353"></a><span id="l3.353" class="difflineminus">-        &lt;/xul:hbox&gt;</span>
<a href="#l3.354"></a><span id="l3.354" class="difflineminus">-        &lt;xul:hbox class=&quot;minimonth-row-body&quot; equalsize=&quot;always&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l3.355"></a><span id="l3.355" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-week&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.356"></a><span id="l3.356" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.357"></a><span id="l3.357" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.358"></a><span id="l3.358" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.359"></a><span id="l3.359" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.360"></a><span id="l3.360" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.361"></a><span id="l3.361" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.362"></a><span id="l3.362" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.363"></a><span id="l3.363" class="difflineminus">-        &lt;/xul:hbox&gt;</span>
<a href="#l3.364"></a><span id="l3.364" class="difflineminus">-        &lt;xul:hbox class=&quot;minimonth-row-body&quot; equalsize=&quot;always&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l3.365"></a><span id="l3.365" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-week&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.366"></a><span id="l3.366" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.367"></a><span id="l3.367" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.368"></a><span id="l3.368" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.369"></a><span id="l3.369" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.370"></a><span id="l3.370" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.371"></a><span id="l3.371" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.372"></a><span id="l3.372" class="difflineminus">-          &lt;xul:text class=&quot;minimonth-day&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l3.373"></a><span id="l3.373" class="difflineminus">-        &lt;/xul:hbox&gt;</span>
<a href="#l3.374"></a><span id="l3.374" class="difflineminus">-      &lt;/xul:vbox&gt;</span>
<a href="#l3.375"></a><span id="l3.375" class="difflineplus">+      &lt;html:table anonid=&quot;minimonth-calendar&quot; class=&quot;minimonth-cal-box&quot;&gt;</span>
<a href="#l3.376"></a><span id="l3.376" class="difflineplus">+        &lt;html:tr class=&quot;minimonth-row-head&quot; anonid=&quot;minimonth-row-header&quot;&gt;</span>
<a href="#l3.377"></a><span id="l3.377" class="difflineplus">+          &lt;html:th class=&quot;minimonth-row-header-week&quot; scope=&quot;col&quot;/&gt;</span>
<a href="#l3.378"></a><span id="l3.378" class="difflineplus">+          &lt;html:th class=&quot;minimonth-row-header&quot; scope=&quot;col&quot;/&gt;</span>
<a href="#l3.379"></a><span id="l3.379" class="difflineplus">+          &lt;html:th class=&quot;minimonth-row-header&quot; scope=&quot;col&quot;/&gt;</span>
<a href="#l3.380"></a><span id="l3.380" class="difflineplus">+          &lt;html:th class=&quot;minimonth-row-header&quot; scope=&quot;col&quot;/&gt;</span>
<a href="#l3.381"></a><span id="l3.381" class="difflineplus">+          &lt;html:th class=&quot;minimonth-row-header&quot; scope=&quot;col&quot;/&gt;</span>
<a href="#l3.382"></a><span id="l3.382" class="difflineplus">+          &lt;html:th class=&quot;minimonth-row-header&quot; scope=&quot;col&quot;/&gt;</span>
<a href="#l3.383"></a><span id="l3.383" class="difflineplus">+          &lt;html:th class=&quot;minimonth-row-header&quot; scope=&quot;col&quot;/&gt;</span>
<a href="#l3.384"></a><span id="l3.384" class="difflineplus">+          &lt;html:th class=&quot;minimonth-row-header&quot; scope=&quot;col&quot;/&gt;</span>
<a href="#l3.385"></a><span id="l3.385" class="difflineplus">+        &lt;/html:tr&gt;</span>
<a href="#l3.386"></a><span id="l3.386" class="difflineplus">+        &lt;html:tr class=&quot;minimonth-row-body&quot;&gt;</span>
<a href="#l3.387"></a><span id="l3.387" class="difflineplus">+          &lt;html:th class=&quot;minimonth-week&quot; scope=&quot;row&quot;/&gt;</span>
<a href="#l3.388"></a><span id="l3.388" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.389"></a><span id="l3.389" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.390"></a><span id="l3.390" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.391"></a><span id="l3.391" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.392"></a><span id="l3.392" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.393"></a><span id="l3.393" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.394"></a><span id="l3.394" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.395"></a><span id="l3.395" class="difflineplus">+        &lt;/html:tr&gt;</span>
<a href="#l3.396"></a><span id="l3.396" class="difflineplus">+        &lt;html:tr class=&quot;minimonth-row-body&quot;&gt;</span>
<a href="#l3.397"></a><span id="l3.397" class="difflineplus">+          &lt;html:th class=&quot;minimonth-week&quot; scope=&quot;row&quot;/&gt;</span>
<a href="#l3.398"></a><span id="l3.398" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.399"></a><span id="l3.399" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.400"></a><span id="l3.400" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.401"></a><span id="l3.401" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.402"></a><span id="l3.402" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.403"></a><span id="l3.403" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.404"></a><span id="l3.404" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.405"></a><span id="l3.405" class="difflineplus">+        &lt;/html:tr&gt;</span>
<a href="#l3.406"></a><span id="l3.406" class="difflineplus">+        &lt;html:tr class=&quot;minimonth-row-body&quot;&gt;</span>
<a href="#l3.407"></a><span id="l3.407" class="difflineplus">+          &lt;html:th class=&quot;minimonth-week&quot; scope=&quot;row&quot;/&gt;</span>
<a href="#l3.408"></a><span id="l3.408" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.409"></a><span id="l3.409" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.410"></a><span id="l3.410" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.411"></a><span id="l3.411" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.412"></a><span id="l3.412" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.413"></a><span id="l3.413" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.414"></a><span id="l3.414" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.415"></a><span id="l3.415" class="difflineplus">+        &lt;/html:tr&gt;</span>
<a href="#l3.416"></a><span id="l3.416" class="difflineplus">+        &lt;html:tr class=&quot;minimonth-row-body&quot;&gt;</span>
<a href="#l3.417"></a><span id="l3.417" class="difflineplus">+          &lt;html:th class=&quot;minimonth-week&quot; scope=&quot;row&quot;/&gt;</span>
<a href="#l3.418"></a><span id="l3.418" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.419"></a><span id="l3.419" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.420"></a><span id="l3.420" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.421"></a><span id="l3.421" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.422"></a><span id="l3.422" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.423"></a><span id="l3.423" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.424"></a><span id="l3.424" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.425"></a><span id="l3.425" class="difflineplus">+        &lt;/html:tr&gt;</span>
<a href="#l3.426"></a><span id="l3.426" class="difflineplus">+        &lt;html:tr class=&quot;minimonth-row-body&quot;&gt;</span>
<a href="#l3.427"></a><span id="l3.427" class="difflineplus">+          &lt;html:th class=&quot;minimonth-week&quot; scope=&quot;row&quot;/&gt;</span>
<a href="#l3.428"></a><span id="l3.428" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.429"></a><span id="l3.429" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.430"></a><span id="l3.430" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.431"></a><span id="l3.431" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.432"></a><span id="l3.432" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.433"></a><span id="l3.433" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.434"></a><span id="l3.434" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.435"></a><span id="l3.435" class="difflineplus">+        &lt;/html:tr&gt;</span>
<a href="#l3.436"></a><span id="l3.436" class="difflineplus">+        &lt;html:tr class=&quot;minimonth-row-body&quot;&gt;</span>
<a href="#l3.437"></a><span id="l3.437" class="difflineplus">+          &lt;html:th class=&quot;minimonth-week&quot; scope=&quot;row&quot;/&gt;</span>
<a href="#l3.438"></a><span id="l3.438" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.439"></a><span id="l3.439" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.440"></a><span id="l3.440" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.441"></a><span id="l3.441" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.442"></a><span id="l3.442" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.443"></a><span id="l3.443" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.444"></a><span id="l3.444" class="difflineplus">+          &lt;html:td class=&quot;minimonth-day&quot; tabindex=&quot;-1&quot;/&gt;</span>
<a href="#l3.445"></a><span id="l3.445" class="difflineplus">+        &lt;/html:tr&gt;</span>
<a href="#l3.446"></a><span id="l3.446" class="difflineplus">+      &lt;/html:table&gt;</span>
<a href="#l3.447"></a><span id="l3.447">     &lt;/content&gt;</span>
<a href="#l3.448"></a><span id="l3.448"> </span>
<a href="#l3.449"></a><span id="l3.449">     &lt;implementation implements=&quot;calICompositeObserver calIOperationListener nsIObserver&quot; &gt;</span>
<a href="#l3.450"></a><span id="l3.450">       &lt;property name=&quot;value&quot;</span>
<a href="#l3.451"></a><span id="l3.451">                 onget=&quot;return this.mValue&quot;</span>
<a href="#l3.452"></a><span id="l3.452">                 onset=&quot;this.update(val)&quot;/&gt;</span>
<a href="#l3.453"></a><span id="l3.453"> </span>
<a href="#l3.454"></a><span id="l3.454">       &lt;property name=&quot;extra&quot;</span>
<a href="#l3.455"></a><span id="l3.455">                 onget=&quot;return this.mExtraDate&quot;</span>
<a href="#l3.456"></a><span id="l3.456">                 onset=&quot;this.mExtraDate = val&quot;/&gt;</span>
<a href="#l3.457"></a><span id="l3.457"> </span>
<a href="#l3.458"></a><span id="l3.458">        &lt;!--returns the first (inclusive) date of the minimonth as a calIDateTime object--&gt;</span>
<a href="#l3.459"></a><span id="l3.459">       &lt;property name=&quot;firstDate&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l3.460"></a><span id="l3.460">         &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l3.461"></a><span id="l3.461" class="difflineminus">-          let calbox = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;minimonth-calendar&quot;);</span>
<a href="#l3.462"></a><span id="l3.462" class="difflineminus">-          let date = calbox.childNodes[1].firstChild.nextSibling.date;</span>
<a href="#l3.463"></a><span id="l3.463" class="difflineplus">+          let date = this._getCalBoxNode(1, 1).date;</span>
<a href="#l3.464"></a><span id="l3.464">           return cal.jsDateToDateTime(date);</span>
<a href="#l3.465"></a><span id="l3.465">         ]]&gt;&lt;/getter&gt;</span>
<a href="#l3.466"></a><span id="l3.466">       &lt;/property&gt;</span>
<a href="#l3.467"></a><span id="l3.467"> </span>
<a href="#l3.468"></a><span id="l3.468">        &lt;!--returns the last (exclusive) date of the minimonth as a calIDateTime object--&gt;</span>
<a href="#l3.469"></a><span id="l3.469">       &lt;property name=&quot;lastDate&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l3.470"></a><span id="l3.470">         &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l3.471"></a><span id="l3.471" class="difflineminus">-          let calbox = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;minimonth-calendar&quot;);</span>
<a href="#l3.472"></a><span id="l3.472" class="difflineminus">-          let date = calbox.lastChild.lastChild.date;</span>
<a href="#l3.473"></a><span id="l3.473" class="difflineplus">+          let date = this._getCalBoxNode(6, 7).date;</span>
<a href="#l3.474"></a><span id="l3.474">           let lastDateTime = cal.jsDateToDateTime(date);</span>
<a href="#l3.475"></a><span id="l3.475">           lastDateTime.day = lastDateTime.day + 1;</span>
<a href="#l3.476"></a><span id="l3.476">           return lastDateTime;</span>
<a href="#l3.477"></a><span id="l3.477">         ]]&gt;&lt;/getter&gt;</span>
<a href="#l3.478"></a><span id="l3.478">       &lt;/property&gt;</span>
<a href="#l3.479"></a><span id="l3.479"> </span>
<a href="#l3.480"></a><span id="l3.480">       &lt;field name=&quot;mDaymap&quot;&gt;null&lt;/field&gt;</span>
<a href="#l3.481"></a><span id="l3.481">       &lt;field name=&quot;mValue&quot;&gt;null&lt;/field&gt;</span>
<a href="#l3.482"></a><span id="l3.482" class="difflineat">@@ -443,16 +439,17 @@</span>
<a href="#l3.483"></a><span id="l3.483">       &lt;constructor&gt;&lt;![CDATA[</span>
<a href="#l3.484"></a><span id="l3.484">         Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l3.485"></a><span id="l3.485">         Components.utils.import(&quot;resource://gre/modules/Preferences.jsm&quot;);</span>
<a href="#l3.486"></a><span id="l3.486"> </span>
<a href="#l3.487"></a><span id="l3.487">         this.mToday = false;</span>
<a href="#l3.488"></a><span id="l3.488">         this.mSelected = false;</span>
<a href="#l3.489"></a><span id="l3.489">         this.mExtra = false;</span>
<a href="#l3.490"></a><span id="l3.490">         this.mValue = new Date(); // Default to &quot;today&quot;</span>
<a href="#l3.491"></a><span id="l3.491" class="difflineplus">+        this.mFocused = null;</span>
<a href="#l3.492"></a><span id="l3.492">         // save references for convenience</span>
<a href="#l3.493"></a><span id="l3.493">         if (this.hasAttribute(&quot;readonly&quot;)) {</span>
<a href="#l3.494"></a><span id="l3.494">             this.mIsReadOnly = this.getAttribute(&quot;readonly&quot;) == &quot;true&quot;;</span>
<a href="#l3.495"></a><span id="l3.495">         }</span>
<a href="#l3.496"></a><span id="l3.496">         this.refreshDisplay();</span>
<a href="#l3.497"></a><span id="l3.497">         if (this.hasAttribute(&quot;freebusy&quot;)) {</span>
<a href="#l3.498"></a><span id="l3.498">             this._setFreeBusy(this.getAttribute(&quot;freebusy&quot;) == &quot;true&quot;);</span>
<a href="#l3.499"></a><span id="l3.499">         }</span>
<a href="#l3.500"></a><span id="l3.500" class="difflineat">@@ -726,37 +723,50 @@</span>
<a href="#l3.501"></a><span id="l3.501">           // Find out which should be the first day of the week</span>
<a href="#l3.502"></a><span id="l3.502">           this.weekStart = Preferences.get(&quot;calendar.week.start&quot;, 0);</span>
<a href="#l3.503"></a><span id="l3.503">           this.mShowWeekNumber = Preferences.get(&quot;calendar.view-minimonth.showWeekNumber&quot;, true);</span>
<a href="#l3.504"></a><span id="l3.504">           if (!this.mValue) {</span>
<a href="#l3.505"></a><span id="l3.505">               this.mValue = new Date();</span>
<a href="#l3.506"></a><span id="l3.506">           }</span>
<a href="#l3.507"></a><span id="l3.507">           this.setHeader();</span>
<a href="#l3.508"></a><span id="l3.508">           this.showMonth(this.mValue);</span>
<a href="#l3.509"></a><span id="l3.509" class="difflineplus">+          this.updateAccessibleLabel();</span>
<a href="#l3.510"></a><span id="l3.510" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l3.511"></a><span id="l3.511" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l3.512"></a><span id="l3.512" class="difflineplus">+</span>
<a href="#l3.513"></a><span id="l3.513" class="difflineplus">+      &lt;method name=&quot;_getCalBoxNode&quot;&gt;</span>
<a href="#l3.514"></a><span id="l3.514" class="difflineplus">+        &lt;parameter name=&quot;aRow&quot;/&gt;</span>
<a href="#l3.515"></a><span id="l3.515" class="difflineplus">+        &lt;parameter name=&quot;aCol&quot;/&gt;</span>
<a href="#l3.516"></a><span id="l3.516" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.517"></a><span id="l3.517" class="difflineplus">+          if (!this.mCalBox) {</span>
<a href="#l3.518"></a><span id="l3.518" class="difflineplus">+              this.mCalBox = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;minimonth-calendar&quot;);</span>
<a href="#l3.519"></a><span id="l3.519" class="difflineplus">+          }</span>
<a href="#l3.520"></a><span id="l3.520" class="difflineplus">+          return this.mCalBox.children[aRow].children[aCol];</span>
<a href="#l3.521"></a><span id="l3.521">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.522"></a><span id="l3.522">       &lt;/method&gt;</span>
<a href="#l3.523"></a><span id="l3.523"> </span>
<a href="#l3.524"></a><span id="l3.524">       &lt;method name=&quot;setHeader&quot;&gt;</span>
<a href="#l3.525"></a><span id="l3.525">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.526"></a><span id="l3.526">           // Reset the headers</span>
<a href="#l3.527"></a><span id="l3.527" class="difflineminus">-          let header = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;minimonth-row-header&quot;);</span>
<a href="#l3.528"></a><span id="l3.528">           let dayList = new Array(7);</span>
<a href="#l3.529"></a><span id="l3.529" class="difflineplus">+          let longDayList = new Array(7);</span>
<a href="#l3.530"></a><span id="l3.530">           let tempDate = new Date();</span>
<a href="#l3.531"></a><span id="l3.531">           let i, j;</span>
<a href="#l3.532"></a><span id="l3.532">           let useOSFormat;</span>
<a href="#l3.533"></a><span id="l3.533">           tempDate.setDate(tempDate.getDate() - (tempDate.getDay() - this.weekStart));</span>
<a href="#l3.534"></a><span id="l3.534" class="difflineminus">-          for (i = 0; i &lt; header.childNodes.length - 1; i++) {</span>
<a href="#l3.535"></a><span id="l3.535" class="difflineplus">+          for (i = 0; i &lt; 7; i++) {</span>
<a href="#l3.536"></a><span id="l3.536">               // if available, use UILocale days, else operating system format</span>
<a href="#l3.537"></a><span id="l3.537">               try {</span>
<a href="#l3.538"></a><span id="l3.538">                   dayList[i] = calGetString(&quot;dateFormat&quot;,</span>
<a href="#l3.539"></a><span id="l3.539">                                &quot;day.&quot; + (tempDate.getDay() + 1) + &quot;.short&quot;);</span>
<a href="#l3.540"></a><span id="l3.540">               } catch (e) {</span>
<a href="#l3.541"></a><span id="l3.541" class="difflineminus">-                  dayList[i] = tempDate.toLocaleFormat(&quot;%a&quot;);</span>
<a href="#l3.542"></a><span id="l3.542" class="difflineplus">+                  dayList[i] = tempDate.toLocaleDateString(undefined, { weekday: 'short' });</span>
<a href="#l3.543"></a><span id="l3.543">                   useOSFormat = true;</span>
<a href="#l3.544"></a><span id="l3.544">               }</span>
<a href="#l3.545"></a><span id="l3.545" class="difflineplus">+              longDayList[i] = tempDate.toLocaleDateString(undefined, { weekday: 'long' });</span>
<a href="#l3.546"></a><span id="l3.546">               tempDate.setDate(tempDate.getDate() + 1);</span>
<a href="#l3.547"></a><span id="l3.547">           }</span>
<a href="#l3.548"></a><span id="l3.548"> </span>
<a href="#l3.549"></a><span id="l3.549">           if (useOSFormat) {</span>
<a href="#l3.550"></a><span id="l3.550">               // To keep datepicker popup compact, shrink localized weekday</span>
<a href="#l3.551"></a><span id="l3.551">               // abbreviations down to 1 or 2 chars so each column of week can</span>
<a href="#l3.552"></a><span id="l3.552">               // be as narrow as 2 digits.</span>
<a href="#l3.553"></a><span id="l3.553">               //</span>
<a href="#l3.554"></a><span id="l3.554" class="difflineat">@@ -791,19 +801,21 @@</span>
<a href="#l3.555"></a><span id="l3.555">                               break;</span>
<a href="#l3.556"></a><span id="l3.556">                           }</span>
<a href="#l3.557"></a><span id="l3.557">                       }</span>
<a href="#l3.558"></a><span id="l3.558">                   }</span>
<a href="#l3.559"></a><span id="l3.559">                   dayList[i] = dayList[i].substring(0, foundMatch);</span>
<a href="#l3.560"></a><span id="l3.560">               }</span>
<a href="#l3.561"></a><span id="l3.561">           }</span>
<a href="#l3.562"></a><span id="l3.562"> </span>
<a href="#l3.563"></a><span id="l3.563" class="difflineminus">-          setBooleanAttribute(header.childNodes[0], &quot;hidden&quot;, !this.mShowWeekNumber);</span>
<a href="#l3.564"></a><span id="l3.564" class="difflineminus">-          for (let column = 1; column &lt; header.childNodes.length; column++) {</span>
<a href="#l3.565"></a><span id="l3.565" class="difflineminus">-              header.childNodes[column].setAttribute(&quot;value&quot;, dayList[column - 1]);</span>
<a href="#l3.566"></a><span id="l3.566" class="difflineplus">+          setBooleanAttribute(this._getCalBoxNode(0, 0), &quot;hidden&quot;, !this.mShowWeekNumber);</span>
<a href="#l3.567"></a><span id="l3.567" class="difflineplus">+          for (let column = 1; column &lt; 8; column++) {</span>
<a href="#l3.568"></a><span id="l3.568" class="difflineplus">+              let node = this._getCalBoxNode(0, column);</span>
<a href="#l3.569"></a><span id="l3.569" class="difflineplus">+              node.textContent = dayList[column - 1];</span>
<a href="#l3.570"></a><span id="l3.570" class="difflineplus">+              node.setAttribute(&quot;aria-label&quot;, longDayList[column - 1]);</span>
<a href="#l3.571"></a><span id="l3.571">           }</span>
<a href="#l3.572"></a><span id="l3.572">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.573"></a><span id="l3.573">       &lt;/method&gt;</span>
<a href="#l3.574"></a><span id="l3.574"> </span>
<a href="#l3.575"></a><span id="l3.575">       &lt;method name=&quot;showMonth&quot;&gt;</span>
<a href="#l3.576"></a><span id="l3.576">         &lt;parameter name=&quot;aDate&quot;/&gt;</span>
<a href="#l3.577"></a><span id="l3.577">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.578"></a><span id="l3.578">           // Use mExtraDate if aDate is null.</span>
<a href="#l3.579"></a><span id="l3.579" class="difflineat">@@ -847,32 +859,43 @@</span>
<a href="#l3.580"></a><span id="l3.580">           }</span>
<a href="#l3.581"></a><span id="l3.581">           // Update the calendar</span>
<a href="#l3.582"></a><span id="l3.582">           let calbox = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;minimonth-calendar&quot;);</span>
<a href="#l3.583"></a><span id="l3.583">           let date = this._getStartDate(aDate);</span>
<a href="#l3.584"></a><span id="l3.584"> </span>
<a href="#l3.585"></a><span id="l3.585">           // get today's date</span>
<a href="#l3.586"></a><span id="l3.586">           let today = new Date();</span>
<a href="#l3.587"></a><span id="l3.587"> </span>
<a href="#l3.588"></a><span id="l3.588" class="difflineplus">+          if (aDate.getFullYear() != (this.mValue || this.mExtraDate).getFullYear()) {</span>
<a href="#l3.589"></a><span id="l3.589" class="difflineplus">+              let monthName = cal.formatMonth(aDate.getMonth() + 1,</span>
<a href="#l3.590"></a><span id="l3.590" class="difflineplus">+                                              &quot;calendar&quot;, &quot;monthInYear&quot;);</span>
<a href="#l3.591"></a><span id="l3.591" class="difflineplus">+              let label = calGetString(&quot;calendar&quot;, &quot;monthInYear&quot;,</span>
<a href="#l3.592"></a><span id="l3.592" class="difflineplus">+                                       [monthName, aDate.getFullYear()]);</span>
<a href="#l3.593"></a><span id="l3.593" class="difflineplus">+              calbox.setAttribute(&quot;aria-label&quot;, label);</span>
<a href="#l3.594"></a><span id="l3.594" class="difflineplus">+          } else {</span>
<a href="#l3.595"></a><span id="l3.595" class="difflineplus">+              calbox.setAttribute(&quot;aria-label&quot;, calGetString(&quot;dateFormat&quot;,</span>
<a href="#l3.596"></a><span id="l3.596" class="difflineplus">+                                  &quot;month.&quot; + (aDate.getMonth() + 1) + &quot;.name&quot;));</span>
<a href="#l3.597"></a><span id="l3.597" class="difflineplus">+          }</span>
<a href="#l3.598"></a><span id="l3.598" class="difflineplus">+</span>
<a href="#l3.599"></a><span id="l3.599">           this.mDayMap = {};</span>
<a href="#l3.600"></a><span id="l3.600">           let defaultTz = cal.calendarDefaultTimezone();</span>
<a href="#l3.601"></a><span id="l3.601" class="difflineminus">-          for (let k = 1; k &lt; calbox.childNodes.length; k++) {</span>
<a href="#l3.602"></a><span id="l3.602" class="difflineminus">-              let row = calbox.childNodes[k];</span>
<a href="#l3.603"></a><span id="l3.603" class="difflineminus">-</span>
<a href="#l3.604"></a><span id="l3.604" class="difflineplus">+          for (let k = 1; k &lt; 7; k++) {</span>
<a href="#l3.605"></a><span id="l3.605">               // Set the week number.</span>
<a href="#l3.606"></a><span id="l3.606" class="difflineminus">-              let firstElement = row.childNodes[0];</span>
<a href="#l3.607"></a><span id="l3.607" class="difflineplus">+              let firstElement = this._getCalBoxNode(k, 0);</span>
<a href="#l3.608"></a><span id="l3.608">               setBooleanAttribute(firstElement, &quot;hidden&quot;, !this.mShowWeekNumber);</span>
<a href="#l3.609"></a><span id="l3.609">               if (this.mShowWeekNumber) {</span>
<a href="#l3.610"></a><span id="l3.610">                   let weekNumber = cal.getWeekInfoService()</span>
<a href="#l3.611"></a><span id="l3.611">                                       .getWeekTitle(cal.jsDateToDateTime(date, defaultTz));</span>
<a href="#l3.612"></a><span id="l3.612" class="difflineminus">-                  firstElement.setAttribute(&quot;value&quot;, weekNumber);</span>
<a href="#l3.613"></a><span id="l3.613" class="difflineplus">+                  let weekTitle = cal.calGetString(&quot;calendar&quot;, &quot;WeekTitle&quot;, [weekNumber]);</span>
<a href="#l3.614"></a><span id="l3.614" class="difflineplus">+                  firstElement.textContent = weekNumber;</span>
<a href="#l3.615"></a><span id="l3.615" class="difflineplus">+                  firstElement.setAttribute(&quot;aria-label&quot;, weekTitle);</span>
<a href="#l3.616"></a><span id="l3.616">               }</span>
<a href="#l3.617"></a><span id="l3.617"> </span>
<a href="#l3.618"></a><span id="l3.618">               for (let i = 1; i &lt; 8; i++) {</span>
<a href="#l3.619"></a><span id="l3.619" class="difflineminus">-                  let day = row.childNodes[i];</span>
<a href="#l3.620"></a><span id="l3.620" class="difflineplus">+                  let day = this._getCalBoxNode(k, i);</span>
<a href="#l3.621"></a><span id="l3.621">                   let ymd = date.getFullYear() + &quot;-&quot; +</span>
<a href="#l3.622"></a><span id="l3.622">                             date.getMonth() + &quot;-&quot; +</span>
<a href="#l3.623"></a><span id="l3.623">                             date.getDate();</span>
<a href="#l3.624"></a><span id="l3.624">                   this.mDayMap[ymd] = day;</span>
<a href="#l3.625"></a><span id="l3.625"> </span>
<a href="#l3.626"></a><span id="l3.626">                   if (!this.mIsReadOnly) {</span>
<a href="#l3.627"></a><span id="l3.627">                       day.setAttribute(&quot;interactive&quot;, &quot;true&quot;);</span>
<a href="#l3.628"></a><span id="l3.628">                   }</span>
<a href="#l3.629"></a><span id="l3.629" class="difflineat">@@ -897,27 +920,39 @@</span>
<a href="#l3.630"></a><span id="l3.630">                   }</span>
<a href="#l3.631"></a><span id="l3.631"> </span>
<a href="#l3.632"></a><span id="l3.632">                   // highlight the extra date</span>
<a href="#l3.633"></a><span id="l3.633">                   if (this._sameDay(this.mExtraDate, date)) {</span>
<a href="#l3.634"></a><span id="l3.634">                       this.mExtra = day;</span>
<a href="#l3.635"></a><span id="l3.635">                       day.setAttribute(&quot;extra&quot;, &quot;true&quot;);</span>
<a href="#l3.636"></a><span id="l3.636">                   }</span>
<a href="#l3.637"></a><span id="l3.637"> </span>
<a href="#l3.638"></a><span id="l3.638" class="difflineplus">+                  let labelDateOptions = { day: 'numeric' };</span>
<a href="#l3.639"></a><span id="l3.639" class="difflineplus">+                  if (aDate.getMonth() != date.getMonth()) {</span>
<a href="#l3.640"></a><span id="l3.640" class="difflineplus">+                      labelDateOptions.month = 'long';</span>
<a href="#l3.641"></a><span id="l3.641" class="difflineplus">+                  }</span>
<a href="#l3.642"></a><span id="l3.642" class="difflineplus">+                  if (aDate.getFullYear() != date.getFullYear()) {</span>
<a href="#l3.643"></a><span id="l3.643" class="difflineplus">+                      labelDateOptions.year = 'numeric';</span>
<a href="#l3.644"></a><span id="l3.644" class="difflineplus">+                  }</span>
<a href="#l3.645"></a><span id="l3.645" class="difflineplus">+                  day.setAttribute(&quot;aria-label&quot;, date.toLocaleDateString(undefined, labelDateOptions));</span>
<a href="#l3.646"></a><span id="l3.646" class="difflineplus">+</span>
<a href="#l3.647"></a><span id="l3.647">                   day.date = new Date(date);</span>
<a href="#l3.648"></a><span id="l3.648" class="difflineminus">-                  day.minimonthParent = this;</span>
<a href="#l3.649"></a><span id="l3.649" class="difflineminus">-                  day.setAttribute(&quot;value&quot;, date.getDate());</span>
<a href="#l3.650"></a><span id="l3.650" class="difflineplus">+                  day.textContent = date.getDate();</span>
<a href="#l3.651"></a><span id="l3.651">                   date.setDate(date.getDate() + 1);</span>
<a href="#l3.652"></a><span id="l3.652"> </span>
<a href="#l3.653"></a><span id="l3.653">                   if (monthChanged) {</span>
<a href="#l3.654"></a><span id="l3.654">                       this.resetAttributesForDate(day.date);</span>
<a href="#l3.655"></a><span id="l3.655">                   }</span>
<a href="#l3.656"></a><span id="l3.656">               }</span>
<a href="#l3.657"></a><span id="l3.657">           }</span>
<a href="#l3.658"></a><span id="l3.658"> </span>
<a href="#l3.659"></a><span id="l3.659" class="difflineplus">+          if (!this.mFocused) {</span>
<a href="#l3.660"></a><span id="l3.660" class="difflineplus">+              this.setFocusedDate(this.mValue || this.mExtraDate);</span>
<a href="#l3.661"></a><span id="l3.661" class="difflineplus">+          }</span>
<a href="#l3.662"></a><span id="l3.662" class="difflineplus">+</span>
<a href="#l3.663"></a><span id="l3.663">           if (monthChanged) {</span>
<a href="#l3.664"></a><span id="l3.664">               this.fireEvent(&quot;monthchange&quot;);</span>
<a href="#l3.665"></a><span id="l3.665">           }</span>
<a href="#l3.666"></a><span id="l3.666"> </span>
<a href="#l3.667"></a><span id="l3.667">           if (this.getAttribute(&quot;freebusy&quot;) == &quot;true&quot;) {</span>
<a href="#l3.668"></a><span id="l3.668">               this.getItems();</span>
<a href="#l3.669"></a><span id="l3.669">           }</span>
<a href="#l3.670"></a><span id="l3.670">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.671"></a><span id="l3.671" class="difflineat">@@ -949,38 +984,38 @@</span>
<a href="#l3.672"></a><span id="l3.672">               let allowedAttributes = 0;</span>
<a href="#l3.673"></a><span id="l3.673">               while (aBox.attributes.length &gt; allowedAttributes) {</span>
<a href="#l3.674"></a><span id="l3.674">                   switch (aBox.attributes[allowedAttributes].nodeName) {</span>
<a href="#l3.675"></a><span id="l3.675">                       case &quot;selected&quot;:</span>
<a href="#l3.676"></a><span id="l3.676">                       case &quot;othermonth&quot;:</span>
<a href="#l3.677"></a><span id="l3.677">                       case &quot;today&quot;:</span>
<a href="#l3.678"></a><span id="l3.678">                       case &quot;extra&quot;:</span>
<a href="#l3.679"></a><span id="l3.679">                       case &quot;interactive&quot;:</span>
<a href="#l3.680"></a><span id="l3.680" class="difflineminus">-                      case &quot;value&quot;:</span>
<a href="#l3.681"></a><span id="l3.681">                       case &quot;class&quot;:</span>
<a href="#l3.682"></a><span id="l3.682" class="difflineminus">-                      case &quot;flex&quot;:</span>
<a href="#l3.683"></a><span id="l3.683" class="difflineplus">+                      case &quot;tabindex&quot;:</span>
<a href="#l3.684"></a><span id="l3.684" class="difflineplus">+                      case &quot;role&quot;:</span>
<a href="#l3.685"></a><span id="l3.685" class="difflineplus">+                      case &quot;aria-label&quot;:</span>
<a href="#l3.686"></a><span id="l3.686">                           allowedAttributes++;</span>
<a href="#l3.687"></a><span id="l3.687">                           break;</span>
<a href="#l3.688"></a><span id="l3.688">                       default:</span>
<a href="#l3.689"></a><span id="l3.689">                           aBox.removeAttribute(aBox.attributes[allowedAttributes].nodeName);</span>
<a href="#l3.690"></a><span id="l3.690">                           break;</span>
<a href="#l3.691"></a><span id="l3.691">                   }</span>
<a href="#l3.692"></a><span id="l3.692">               }</span>
<a href="#l3.693"></a><span id="l3.693">           }</span>
<a href="#l3.694"></a><span id="l3.694"> </span>
<a href="#l3.695"></a><span id="l3.695">           if (aDate) {</span>
<a href="#l3.696"></a><span id="l3.696">               let box = this.getBoxForDate(cal.jsDateToDateTime(aDate, cal.calendarDefaultTimezone()));</span>
<a href="#l3.697"></a><span id="l3.697">               if (box) {</span>
<a href="#l3.698"></a><span id="l3.698">                   removeForBox(box);</span>
<a href="#l3.699"></a><span id="l3.699">               }</span>
<a href="#l3.700"></a><span id="l3.700">           } else {</span>
<a href="#l3.701"></a><span id="l3.701" class="difflineminus">-              let calbox = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;minimonth-calendar&quot;);</span>
<a href="#l3.702"></a><span id="l3.702" class="difflineminus">-              for (let k = 1; k &lt; calbox.childNodes.length; k++) {</span>
<a href="#l3.703"></a><span id="l3.703" class="difflineplus">+              for (let k = 1; k &lt; 7; k++) {</span>
<a href="#l3.704"></a><span id="l3.704">                   for (let i = 1; i &lt; 8; i++) {</span>
<a href="#l3.705"></a><span id="l3.705" class="difflineminus">-                      removeForBox(calbox.childNodes[k].childNodes[i]);</span>
<a href="#l3.706"></a><span id="l3.706" class="difflineplus">+                      removeForBox(this._getCalBoxNode(k, i));</span>
<a href="#l3.707"></a><span id="l3.707">                   }</span>
<a href="#l3.708"></a><span id="l3.708">               }</span>
<a href="#l3.709"></a><span id="l3.709">           }</span>
<a href="#l3.710"></a><span id="l3.710">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.711"></a><span id="l3.711">       &lt;/method&gt;</span>
<a href="#l3.712"></a><span id="l3.712"> </span>
<a href="#l3.713"></a><span id="l3.713">       &lt;method name=&quot;_setFreeBusy&quot;&gt;</span>
<a href="#l3.714"></a><span id="l3.714">         &lt;parameter name=&quot;aFreeBusy&quot;/&gt;</span>
<a href="#l3.715"></a><span id="l3.715" class="difflineat">@@ -1038,39 +1073,73 @@</span>
<a href="#l3.716"></a><span id="l3.716">           calendar.getItems(filter,</span>
<a href="#l3.717"></a><span id="l3.717">                             0,</span>
<a href="#l3.718"></a><span id="l3.718">                             this.firstDate,</span>
<a href="#l3.719"></a><span id="l3.719">                             this.lastDate,</span>
<a href="#l3.720"></a><span id="l3.720">                             this);</span>
<a href="#l3.721"></a><span id="l3.721">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.722"></a><span id="l3.722">       &lt;/method&gt;</span>
<a href="#l3.723"></a><span id="l3.723"> </span>
<a href="#l3.724"></a><span id="l3.724" class="difflineminus">-      &lt;method name=&quot;onSelectDay&quot;&gt;</span>
<a href="#l3.725"></a><span id="l3.725" class="difflineminus">-        &lt;parameter name=&quot;aDayBox&quot;/&gt;</span>
<a href="#l3.726"></a><span id="l3.726" class="difflineplus">+      &lt;method name=&quot;updateAccessibleLabel&quot;&gt;</span>
<a href="#l3.727"></a><span id="l3.727">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.728"></a><span id="l3.728" class="difflineminus">-          if (this.mIsReadOnly) {</span>
<a href="#l3.729"></a><span id="l3.729" class="difflineminus">-              return;</span>
<a href="#l3.730"></a><span id="l3.730" class="difflineplus">+          var label;</span>
<a href="#l3.731"></a><span id="l3.731" class="difflineplus">+          if (this.mValue) {</span>
<a href="#l3.732"></a><span id="l3.732" class="difflineplus">+              let labelDateOptions = { day: 'numeric', month: 'long', year: 'numeric' };</span>
<a href="#l3.733"></a><span id="l3.733" class="difflineplus">+              label = this.mValue.toLocaleDateString(undefined, labelDateOptions);</span>
<a href="#l3.734"></a><span id="l3.734" class="difflineplus">+          } else {</span>
<a href="#l3.735"></a><span id="l3.735" class="difflineplus">+              label = cal.calGetString(&quot;calendar&quot;, &quot;minimonthNoSelectedDate&quot;);</span>
<a href="#l3.736"></a><span id="l3.736">           }</span>
<a href="#l3.737"></a><span id="l3.737" class="difflineminus">-          if (this.mSelected) {</span>
<a href="#l3.738"></a><span id="l3.738" class="difflineminus">-              this.mSelected.removeAttribute(&quot;selected&quot;);</span>
<a href="#l3.739"></a><span id="l3.739" class="difflineminus">-          }</span>
<a href="#l3.740"></a><span id="l3.740" class="difflineminus">-          this.mSelected = aDayBox;</span>
<a href="#l3.741"></a><span id="l3.741" class="difflineminus">-          this.value = aDayBox.date;</span>
<a href="#l3.742"></a><span id="l3.742" class="difflineminus">-          this.fireEvent(&quot;select&quot;);</span>
<a href="#l3.743"></a><span id="l3.743" class="difflineplus">+          this.setAttribute(&quot;aria-label&quot;, label);</span>
<a href="#l3.744"></a><span id="l3.744">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.745"></a><span id="l3.745">       &lt;/method&gt;</span>
<a href="#l3.746"></a><span id="l3.746"> </span>
<a href="#l3.747"></a><span id="l3.747">       &lt;method name=&quot;update&quot;&gt;</span>
<a href="#l3.748"></a><span id="l3.748">         &lt;parameter name=&quot;aValue&quot;/&gt;</span>
<a href="#l3.749"></a><span id="l3.749">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.750"></a><span id="l3.750">           this.mValue = aValue;</span>
<a href="#l3.751"></a><span id="l3.751">           if (this.mValue) {</span>
<a href="#l3.752"></a><span id="l3.752">               this.fireEvent(&quot;change&quot;);</span>
<a href="#l3.753"></a><span id="l3.753">           }</span>
<a href="#l3.754"></a><span id="l3.754">           this.showMonth(aValue);</span>
<a href="#l3.755"></a><span id="l3.755" class="difflineplus">+          if (aValue) {</span>
<a href="#l3.756"></a><span id="l3.756" class="difflineplus">+              this.setFocusedDate(aValue);</span>
<a href="#l3.757"></a><span id="l3.757" class="difflineplus">+          }</span>
<a href="#l3.758"></a><span id="l3.758" class="difflineplus">+          this.updateAccessibleLabel();</span>
<a href="#l3.759"></a><span id="l3.759" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l3.760"></a><span id="l3.760" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l3.761"></a><span id="l3.761" class="difflineplus">+</span>
<a href="#l3.762"></a><span id="l3.762" class="difflineplus">+      &lt;method name=&quot;setFocusedDate&quot;&gt;</span>
<a href="#l3.763"></a><span id="l3.763" class="difflineplus">+        &lt;parameter name=&quot;aDate&quot;/&gt;</span>
<a href="#l3.764"></a><span id="l3.764" class="difflineplus">+        &lt;parameter name=&quot;aForceFocus&quot;/&gt;</span>
<a href="#l3.765"></a><span id="l3.765" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.766"></a><span id="l3.766" class="difflineplus">+          let newFocused = this.getBoxForDate(cal.jsDateToDateTime(aDate, cal.calendarDefaultTimezone()));</span>
<a href="#l3.767"></a><span id="l3.767" class="difflineplus">+          if (!newFocused) {</span>
<a href="#l3.768"></a><span id="l3.768" class="difflineplus">+              return;</span>
<a href="#l3.769"></a><span id="l3.769" class="difflineplus">+          }</span>
<a href="#l3.770"></a><span id="l3.770" class="difflineplus">+          if (this.mFocused) {</span>
<a href="#l3.771"></a><span id="l3.771" class="difflineplus">+              this.mFocused.setAttribute(&quot;tabindex&quot;, &quot;-1&quot;);</span>
<a href="#l3.772"></a><span id="l3.772" class="difflineplus">+          }</span>
<a href="#l3.773"></a><span id="l3.773" class="difflineplus">+          this.mFocused = newFocused;</span>
<a href="#l3.774"></a><span id="l3.774" class="difflineplus">+          this.mFocused.setAttribute(&quot;tabindex&quot;, &quot;0&quot;);</span>
<a href="#l3.775"></a><span id="l3.775" class="difflineplus">+          // only actually move the focus if it is already in the calendar box</span>
<a href="#l3.776"></a><span id="l3.776" class="difflineplus">+          if (!aForceFocus) {</span>
<a href="#l3.777"></a><span id="l3.777" class="difflineplus">+              let calbox = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;minimonth-calendar&quot;);</span>
<a href="#l3.778"></a><span id="l3.778" class="difflineplus">+              aForceFocus = calbox.contains(document.commandDispatcher.focusedElement);</span>
<a href="#l3.779"></a><span id="l3.779" class="difflineplus">+          }</span>
<a href="#l3.780"></a><span id="l3.780" class="difflineplus">+          if (aForceFocus) {</span>
<a href="#l3.781"></a><span id="l3.781" class="difflineplus">+              this.mFocused.focus();</span>
<a href="#l3.782"></a><span id="l3.782" class="difflineplus">+          }</span>
<a href="#l3.783"></a><span id="l3.783" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l3.784"></a><span id="l3.784" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l3.785"></a><span id="l3.785" class="difflineplus">+</span>
<a href="#l3.786"></a><span id="l3.786" class="difflineplus">+      &lt;method name=&quot;focusDate&quot;&gt;</span>
<a href="#l3.787"></a><span id="l3.787" class="difflineplus">+        &lt;parameter name=&quot;aDate&quot;/&gt;</span>
<a href="#l3.788"></a><span id="l3.788" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.789"></a><span id="l3.789" class="difflineplus">+          this.showMonth(aDate);</span>
<a href="#l3.790"></a><span id="l3.790" class="difflineplus">+          this.setFocusedDate(aDate);</span>
<a href="#l3.791"></a><span id="l3.791">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.792"></a><span id="l3.792">       &lt;/method&gt;</span>
<a href="#l3.793"></a><span id="l3.793"> </span>
<a href="#l3.794"></a><span id="l3.794">       &lt;method name=&quot;hidePopupList&quot;&gt;</span>
<a href="#l3.795"></a><span id="l3.795">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.796"></a><span id="l3.796">           if (!this.mIsReadOnly) {</span>
<a href="#l3.797"></a><span id="l3.797">               let header = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;minimonth-header&quot;);</span>
<a href="#l3.798"></a><span id="l3.798">               header.hidePopupList();</span>
<a href="#l3.799"></a><span id="l3.799" class="difflineat">@@ -1119,18 +1188,19 @@</span>
<a href="#l3.800"></a><span id="l3.800">               // select day only</span>
<a href="#l3.801"></a><span id="l3.801">               let day = this.getBoxForDate(cal.jsDateToDateTime(aDate, cal.calendarDefaultTimezone()));</span>
<a href="#l3.802"></a><span id="l3.802">               if (this.mSelected) {</span>
<a href="#l3.803"></a><span id="l3.803">                   this.mSelected.removeAttribute(&quot;selected&quot;);</span>
<a href="#l3.804"></a><span id="l3.804">               }</span>
<a href="#l3.805"></a><span id="l3.805">               this.mSelected = day;</span>
<a href="#l3.806"></a><span id="l3.806">               day.setAttribute(&quot;selected&quot;, &quot;true&quot;);</span>
<a href="#l3.807"></a><span id="l3.807">               this.mValue = aDate;</span>
<a href="#l3.808"></a><span id="l3.808" class="difflineplus">+              this.setFocusedDate(aDate);</span>
<a href="#l3.809"></a><span id="l3.809">           }</span>
<a href="#l3.810"></a><span id="l3.810" class="difflineminus">-         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.811"></a><span id="l3.811" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l3.812"></a><span id="l3.812">       &lt;/method&gt;</span>
<a href="#l3.813"></a><span id="l3.813"> </span>
<a href="#l3.814"></a><span id="l3.814">       &lt;method name=&quot;_getStartDate&quot;&gt;</span>
<a href="#l3.815"></a><span id="l3.815">         &lt;parameter name=&quot;aMainDate&quot;/&gt;</span>
<a href="#l3.816"></a><span id="l3.816">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.817"></a><span id="l3.817">           let date = new Date(aMainDate);</span>
<a href="#l3.818"></a><span id="l3.818">           let firstWeekday = (7 + aMainDate.getDay() - this.weekStart) % 7;</span>
<a href="#l3.819"></a><span id="l3.819">           date.setDate(date.getDate() - firstWeekday);</span>
<a href="#l3.820"></a><span id="l3.820" class="difflineat">@@ -1167,16 +1237,66 @@</span>
<a href="#l3.821"></a><span id="l3.821">         &lt;parameter name=&quot;aDir&quot;/&gt;</span>
<a href="#l3.822"></a><span id="l3.822">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.823"></a><span id="l3.823">           let advEditorDate = new Date(this.mEditorDate); // at 1st of month</span>
<a href="#l3.824"></a><span id="l3.824">           let advMonth = this.mEditorDate.getMonth() + aDir;</span>
<a href="#l3.825"></a><span id="l3.825">           advEditorDate.setMonth(advMonth);</span>
<a href="#l3.826"></a><span id="l3.826">           this.showMonth(advEditorDate);</span>
<a href="#l3.827"></a><span id="l3.827">         ]]&gt;&lt;/body&gt;</span>
<a href="#l3.828"></a><span id="l3.828">       &lt;/method&gt;</span>
<a href="#l3.829"></a><span id="l3.829" class="difflineplus">+</span>
<a href="#l3.830"></a><span id="l3.830" class="difflineplus">+      &lt;method name=&quot;moveByOffset&quot;&gt;</span>
<a href="#l3.831"></a><span id="l3.831" class="difflineplus">+        &lt;parameter name=&quot;aYears&quot;/&gt;</span>
<a href="#l3.832"></a><span id="l3.832" class="difflineplus">+        &lt;parameter name=&quot;aMonths&quot;/&gt;</span>
<a href="#l3.833"></a><span id="l3.833" class="difflineplus">+        &lt;parameter name=&quot;aDays&quot;/&gt;</span>
<a href="#l3.834"></a><span id="l3.834" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.835"></a><span id="l3.835" class="difflineplus">+          var day = new Date(this.mFocused.date.getFullYear() + aYears,</span>
<a href="#l3.836"></a><span id="l3.836" class="difflineplus">+                             this.mFocused.date.getMonth() + aMonths,</span>
<a href="#l3.837"></a><span id="l3.837" class="difflineplus">+                             this.mFocused.date.getDate() + aDays);</span>
<a href="#l3.838"></a><span id="l3.838" class="difflineplus">+          this.focusDate(day);</span>
<a href="#l3.839"></a><span id="l3.839" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l3.840"></a><span id="l3.840" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l3.841"></a><span id="l3.841" class="difflineplus">+</span>
<a href="#l3.842"></a><span id="l3.842" class="difflineplus">+      &lt;method name=&quot;focusCalendar&quot;&gt;</span>
<a href="#l3.843"></a><span id="l3.843" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.844"></a><span id="l3.844" class="difflineplus">+          this.mFocused.focus();</span>
<a href="#l3.845"></a><span id="l3.845" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l3.846"></a><span id="l3.846" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l3.847"></a><span id="l3.847" class="difflineplus">+</span>
<a href="#l3.848"></a><span id="l3.848" class="difflineplus">+      &lt;method name=&quot;onDayActivate&quot;&gt;</span>
<a href="#l3.849"></a><span id="l3.849" class="difflineplus">+        &lt;parameter name=&quot;aEvent&quot;/&gt;</span>
<a href="#l3.850"></a><span id="l3.850" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.851"></a><span id="l3.851" class="difflineplus">+          if (aEvent.originalTarget.className == 'minimonth-day') {</span>
<a href="#l3.852"></a><span id="l3.852" class="difflineplus">+              // the associated date might change when setting this.value if month changes</span>
<a href="#l3.853"></a><span id="l3.853" class="difflineplus">+              let date = aEvent.originalTarget.date;</span>
<a href="#l3.854"></a><span id="l3.854" class="difflineplus">+              if (!this.mIsReadOnly) {</span>
<a href="#l3.855"></a><span id="l3.855" class="difflineplus">+                  this.value = date;</span>
<a href="#l3.856"></a><span id="l3.856" class="difflineplus">+                  this.fireEvent(&quot;select&quot;);</span>
<a href="#l3.857"></a><span id="l3.857" class="difflineplus">+              }</span>
<a href="#l3.858"></a><span id="l3.858" class="difflineplus">+              this.setFocusedDate(date, true);</span>
<a href="#l3.859"></a><span id="l3.859" class="difflineplus">+</span>
<a href="#l3.860"></a><span id="l3.860" class="difflineplus">+              aEvent.stopPropagation();</span>
<a href="#l3.861"></a><span id="l3.861" class="difflineplus">+              aEvent.preventDefault();</span>
<a href="#l3.862"></a><span id="l3.862" class="difflineplus">+          }</span>
<a href="#l3.863"></a><span id="l3.863" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l3.864"></a><span id="l3.864" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l3.865"></a><span id="l3.865" class="difflineplus">+</span>
<a href="#l3.866"></a><span id="l3.866" class="difflineplus">+      &lt;method name=&quot;onDayMovement&quot;&gt;</span>
<a href="#l3.867"></a><span id="l3.867" class="difflineplus">+        &lt;parameter name=&quot;aEvent&quot;/&gt;</span>
<a href="#l3.868"></a><span id="l3.868" class="difflineplus">+        &lt;parameter name=&quot;aYears&quot;/&gt;</span>
<a href="#l3.869"></a><span id="l3.869" class="difflineplus">+        &lt;parameter name=&quot;aMonths&quot;/&gt;</span>
<a href="#l3.870"></a><span id="l3.870" class="difflineplus">+        &lt;parameter name=&quot;aDays&quot;/&gt;</span>
<a href="#l3.871"></a><span id="l3.871" class="difflineplus">+        &lt;body&gt;&lt;![CDATA[</span>
<a href="#l3.872"></a><span id="l3.872" class="difflineplus">+          if (aEvent.originalTarget.className == 'minimonth-day') {</span>
<a href="#l3.873"></a><span id="l3.873" class="difflineplus">+              this.moveByOffset(aYears, aMonths, aDays);</span>
<a href="#l3.874"></a><span id="l3.874" class="difflineplus">+              aEvent.stopPropagation();</span>
<a href="#l3.875"></a><span id="l3.875" class="difflineplus">+              aEvent.preventDefault();</span>
<a href="#l3.876"></a><span id="l3.876" class="difflineplus">+          }</span>
<a href="#l3.877"></a><span id="l3.877" class="difflineplus">+        ]]&gt;&lt;/body&gt;</span>
<a href="#l3.878"></a><span id="l3.878" class="difflineplus">+      &lt;/method&gt;</span>
<a href="#l3.879"></a><span id="l3.879">     &lt;/implementation&gt;</span>
<a href="#l3.880"></a><span id="l3.880"> </span>
<a href="#l3.881"></a><span id="l3.881">     &lt;handlers&gt;</span>
<a href="#l3.882"></a><span id="l3.882">       &lt;handler event=&quot;wheel&quot;&gt;&lt;![CDATA[</span>
<a href="#l3.883"></a><span id="l3.883">         const pixelThreshold = 150;</span>
<a href="#l3.884"></a><span id="l3.884">         let deltaView = 0;</span>
<a href="#l3.885"></a><span id="l3.885">         if (this.mIsReadOnly) {</span>
<a href="#l3.886"></a><span id="l3.886">             // No scrolling on readonly months</span>
<a href="#l3.887"></a><span id="l3.887" class="difflineat">@@ -1200,22 +1320,50 @@</span>
<a href="#l3.888"></a><span id="l3.888"> </span>
<a href="#l3.889"></a><span id="l3.889">         if (deltaView != 0) {</span>
<a href="#l3.890"></a><span id="l3.890">             this.advanceMonth(deltaView);</span>
<a href="#l3.891"></a><span id="l3.891">         }</span>
<a href="#l3.892"></a><span id="l3.892"> </span>
<a href="#l3.893"></a><span id="l3.893">         event.stopPropagation();</span>
<a href="#l3.894"></a><span id="l3.894">         event.preventDefault();</span>
<a href="#l3.895"></a><span id="l3.895">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l3.896"></a><span id="l3.896" class="difflineminus">-    &lt;/handlers&gt;</span>
<a href="#l3.897"></a><span id="l3.897" class="difflineminus">-  &lt;/binding&gt;</span>
<a href="#l3.898"></a><span id="l3.898" class="difflineminus">-</span>
<a href="#l3.899"></a><span id="l3.899" class="difflineminus">-  &lt;binding id=&quot;minimonth-day&quot; extends=&quot;xul:text&quot;&gt;</span>
<a href="#l3.900"></a><span id="l3.900" class="difflineminus">-    &lt;handlers&gt;</span>
<a href="#l3.901"></a><span id="l3.901" class="difflineminus">-      &lt;handler event=&quot;click&quot; button=&quot;0&quot;&gt;&lt;![CDATA[</span>
<a href="#l3.902"></a><span id="l3.902" class="difflineminus">-        if (this.minimonthParent.getAttribute(&quot;readonly&quot;) != &quot;true&quot;) {</span>
<a href="#l3.903"></a><span id="l3.903" class="difflineminus">-            this.setAttribute(&quot;selected&quot;, &quot;true&quot;);</span>
<a href="#l3.904"></a><span id="l3.904" class="difflineminus">-            this.minimonthParent.onSelectDay(this);</span>
<a href="#l3.905"></a><span id="l3.905" class="difflineplus">+      &lt;!-- day handlers --&gt;</span>
<a href="#l3.906"></a><span id="l3.906" class="difflineplus">+      &lt;handler event=&quot;keypress&quot; keycode=&quot;VK_LEFT&quot; modifiers=&quot;control shift any&quot;</span>
<a href="#l3.907"></a><span id="l3.907" class="difflineplus">+               action=&quot;this.onDayMovement(event, 0, 0, -1);&quot; phase=&quot;target&quot;/&gt;</span>
<a href="#l3.908"></a><span id="l3.908" class="difflineplus">+      &lt;handler event=&quot;keypress&quot; keycode=&quot;VK_RIGHT&quot; modifiers=&quot;control shift any&quot;</span>
<a href="#l3.909"></a><span id="l3.909" class="difflineplus">+               action=&quot;this.onDayMovement(event, 0, 0, 1);&quot; phase=&quot;target&quot;/&gt;</span>
<a href="#l3.910"></a><span id="l3.910" class="difflineplus">+      &lt;handler event=&quot;keypress&quot; keycode=&quot;VK_UP&quot; modifiers=&quot;control shift any&quot;</span>
<a href="#l3.911"></a><span id="l3.911" class="difflineplus">+               action=&quot;this.onDayMovement(event, 0, 0, -7);&quot; phase=&quot;target&quot;/&gt;</span>
<a href="#l3.912"></a><span id="l3.912" class="difflineplus">+      &lt;handler event=&quot;keypress&quot; keycode=&quot;VK_DOWN&quot; modifiers=&quot;control shift any&quot;</span>
<a href="#l3.913"></a><span id="l3.913" class="difflineplus">+               action=&quot;this.onDayMovement(event, 0, 0, 7);&quot; phase=&quot;target&quot;/&gt;</span>
<a href="#l3.914"></a><span id="l3.914" class="difflineplus">+      &lt;handler event=&quot;keypress&quot; keycode=&quot;VK_PAGE_UP&quot;</span>
<a href="#l3.915"></a><span id="l3.915" class="difflineplus">+               action=&quot;this.onDayMovement(event, 0, -1, 0);&quot; phase=&quot;target&quot;/&gt;</span>
<a href="#l3.916"></a><span id="l3.916" class="difflineplus">+      &lt;handler event=&quot;keypress&quot; keycode=&quot;VK_PAGE_DOWN&quot;</span>
<a href="#l3.917"></a><span id="l3.917" class="difflineplus">+               action=&quot;this.onDayMovement(event, 0, 1, 0);&quot; phase=&quot;target&quot;/&gt;</span>
<a href="#l3.918"></a><span id="l3.918" class="difflineplus">+      &lt;handler event=&quot;keypress&quot; keycode=&quot;VK_PAGE_UP&quot; modifiers=&quot;shift&quot;</span>
<a href="#l3.919"></a><span id="l3.919" class="difflineplus">+               action=&quot;this.onDayMovement(event, -1, 0, 0);&quot; phase=&quot;target&quot;/&gt;</span>
<a href="#l3.920"></a><span id="l3.920" class="difflineplus">+      &lt;handler event=&quot;keypress&quot; keycode=&quot;VK_PAGE_DOWN&quot; modifiers=&quot;shift&quot;</span>
<a href="#l3.921"></a><span id="l3.921" class="difflineplus">+               action=&quot;this.onDayMovement(event, 1, 0, 0);&quot; phase=&quot;target&quot;/&gt;</span>
<a href="#l3.922"></a><span id="l3.922" class="difflineplus">+      &lt;handler event=&quot;keypress&quot; keycode=&quot;VK_ESCAPE&quot;</span>
<a href="#l3.923"></a><span id="l3.923" class="difflineplus">+               phase=&quot;target&quot;&gt;&lt;![CDATA[</span>
<a href="#l3.924"></a><span id="l3.924" class="difflineplus">+        if (event.originalTarget.className == 'minimonth-day') {</span>
<a href="#l3.925"></a><span id="l3.925" class="difflineplus">+            this.focusDate(this.mValue || this.mExtraDate);</span>
<a href="#l3.926"></a><span id="l3.926" class="difflineplus">+            event.stopPropagation();</span>
<a href="#l3.927"></a><span id="l3.927" class="difflineplus">+            event.preventDefault();</span>
<a href="#l3.928"></a><span id="l3.928">         }</span>
<a href="#l3.929"></a><span id="l3.929">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l3.930"></a><span id="l3.930" class="difflineplus">+      &lt;handler event=&quot;keypress&quot; keycode=&quot;VK_HOME&quot;</span>
<a href="#l3.931"></a><span id="l3.931" class="difflineplus">+               phase=&quot;target&quot;&gt;&lt;![CDATA[</span>
<a href="#l3.932"></a><span id="l3.932" class="difflineplus">+        if (event.originalTarget.className == 'minimonth-day') {</span>
<a href="#l3.933"></a><span id="l3.933" class="difflineplus">+            let today = new Date();</span>
<a href="#l3.934"></a><span id="l3.934" class="difflineplus">+            this.update(today);</span>
<a href="#l3.935"></a><span id="l3.935" class="difflineplus">+            this.focusDate(today);</span>
<a href="#l3.936"></a><span id="l3.936" class="difflineplus">+</span>
<a href="#l3.937"></a><span id="l3.937" class="difflineplus">+            event.stopPropagation();</span>
<a href="#l3.938"></a><span id="l3.938" class="difflineplus">+            event.preventDefault();</span>
<a href="#l3.939"></a><span id="l3.939" class="difflineplus">+        }</span>
<a href="#l3.940"></a><span id="l3.940" class="difflineplus">+      ]]&gt;&lt;/handler&gt;</span>
<a href="#l3.941"></a><span id="l3.941" class="difflineplus">+      &lt;handler event=&quot;keypress&quot; keycode=&quot;VK_RETURN&quot;</span>
<a href="#l3.942"></a><span id="l3.942" class="difflineplus">+               action=&quot;onDayActivate(event);&quot; phase=&quot;target&quot;/&gt;</span>
<a href="#l3.943"></a><span id="l3.943" class="difflineplus">+      &lt;handler event=&quot;click&quot; button=&quot;0&quot; action=&quot;onDayActivate(event);&quot;/&gt;</span>
<a href="#l3.944"></a><span id="l3.944">     &lt;/handlers&gt;</span>
<a href="#l3.945"></a><span id="l3.945">   &lt;/binding&gt;</span>
<a href="#l3.946"></a><span id="l3.946"> &lt;/bindings&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/themes/common/widgets/minimonth.css</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/themes/common/widgets/minimonth.css</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -71,20 +71,16 @@ minimonth {</span>
<a href="#l4.4"></a><span id="l4.4"> }</span>
<a href="#l4.5"></a><span id="l4.5"> </span>
<a href="#l4.6"></a><span id="l4.6"> .minimonth-year-name-readonly {</span>
<a href="#l4.7"></a><span id="l4.7">   min-width: 4em;</span>
<a href="#l4.8"></a><span id="l4.8">   font-weight: bold;</span>
<a href="#l4.9"></a><span id="l4.9">   padding-inline-start: 4px;</span>
<a href="#l4.10"></a><span id="l4.10"> }</span>
<a href="#l4.11"></a><span id="l4.11"> </span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-.minimonth-month-name &gt; .toolbarbutton-text {</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-  text-align: right;</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-}</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">-</span>
<a href="#l4.16"></a><span id="l4.16"> .minimonth-month-name &gt; .toolbarbutton-icon,</span>
<a href="#l4.17"></a><span id="l4.17"> .minimonth-year-name &gt; .toolbarbutton-icon {</span>
<a href="#l4.18"></a><span id="l4.18">   display: none;</span>
<a href="#l4.19"></a><span id="l4.19"> }</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21"> .minimonth-nav-btns &gt; .toolbarbutton-icon {</span>
<a href="#l4.22"></a><span id="l4.22">   margin: 1px;</span>
<a href="#l4.23"></a><span id="l4.23"> }</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineat">@@ -108,16 +104,28 @@ minimonth {</span>
<a href="#l4.25"></a><span id="l4.25"> .minimonth-nav-btns:-moz-locale-dir(rtl)[dir=&quot;1&quot;] {</span>
<a href="#l4.26"></a><span id="l4.26">   transform: scaleX(-1);</span>
<a href="#l4.27"></a><span id="l4.27"> }</span>
<a href="#l4.28"></a><span id="l4.28"> </span>
<a href="#l4.29"></a><span id="l4.29"> .minimonth-nav-btns[dir=&quot;0&quot;] {</span>
<a href="#l4.30"></a><span id="l4.30">   list-style-image: url(&quot;chrome://calendar-common/skin/widgets/nav-today.svg&quot;);</span>
<a href="#l4.31"></a><span id="l4.31"> }</span>
<a href="#l4.32"></a><span id="l4.32"> </span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+.minimonth-cal-box {</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+  border-spacing: 0px;</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+}</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+.minimonth-cal-box th, .minimonth-cal-box td {</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineplus">+  width: 12.5%; /* 100% / 8 columns */</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+}</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineplus">+.minimonth-cal-box th {</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+  font-weight: normal;</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+}</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineplus">+</span>
<a href="#l4.45"></a><span id="l4.45"> .minimonth-row-header {</span>
<a href="#l4.46"></a><span id="l4.46">   text-align: center;</span>
<a href="#l4.47"></a><span id="l4.47"> }</span>
<a href="#l4.48"></a><span id="l4.48"> </span>
<a href="#l4.49"></a><span id="l4.49"> .minimonth-day {</span>
<a href="#l4.50"></a><span id="l4.50">   color: var(--mmDayColor);</span>
<a href="#l4.51"></a><span id="l4.51">   text-align: center;</span>
<a href="#l4.52"></a><span id="l4.52">   border: 1px solid var(--mmDayBorderColor);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/locales/en-US/chrome/calendar/calendar.properties</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/locales/en-US/chrome/calendar/calendar.properties</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -744,8 +744,11 @@ modifyConflictPromptButton2=Discard thes</span>
<a href="#l5.4"></a><span id="l5.4"> # invited attendee gets replaced</span>
<a href="#l5.5"></a><span id="l5.5"> dialog.attendee.append.delegatedFrom=(delegated from %1$S)</span>
<a href="#l5.6"></a><span id="l5.6"> # LOCALIZATION_NOTE(dialog.attendee.append.delegatedTo): this is appended behind an attendee name</span>
<a href="#l5.7"></a><span id="l5.7"> # in the tooltip for an attendee in the event summary dialog - don't add leading or trailing</span>
<a href="#l5.8"></a><span id="l5.8"> # whitespaces here</span>
<a href="#l5.9"></a><span id="l5.9"> # delegation is different from simple invitation forwarding - in case of delegation the orignal</span>
<a href="#l5.10"></a><span id="l5.10"> # invited attendee gets replaced</span>
<a href="#l5.11"></a><span id="l5.11"> dialog.attendee.append.delegatedTo=(delegated to %1$S)</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+# Accessible description of a grid calendar with no selected date</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+minimonthNoSelectedDate=No date selected</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/resources/content/datetimepickers/datetimepickers.css</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/resources/content/datetimepickers/datetimepickers.css</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -1,12 +1,16 @@</span>
<a href="#l6.4"></a><span id="l6.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.5"></a><span id="l6.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.6"></a><span id="l6.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l6.7"></a><span id="l6.7"> </span>
<a href="#l6.8"></a><span id="l6.8" class="difflineplus">+menulist[type=&quot;panel&quot;] {</span>
<a href="#l6.9"></a><span id="l6.9" class="difflineplus">+  -moz-binding: url(&quot;chrome://calendar/content/datetimepickers/datetimepickers.xml#panellist&quot;);</span>
<a href="#l6.10"></a><span id="l6.10" class="difflineplus">+}</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineplus">+</span>
<a href="#l6.12"></a><span id="l6.12"> datepicker {</span>
<a href="#l6.13"></a><span id="l6.13">   -moz-binding: url(&quot;chrome://calendar/content/datetimepickers/datetimepickers.xml#datepicker&quot;);</span>
<a href="#l6.14"></a><span id="l6.14"> }</span>
<a href="#l6.15"></a><span id="l6.15"> </span>
<a href="#l6.16"></a><span id="l6.16"> datepicker-forever {</span>
<a href="#l6.17"></a><span id="l6.17">   -moz-binding: url(&quot;chrome://calendar/content/datetimepickers/datetimepickers.xml#datepicker-forever&quot;);</span>
<a href="#l6.18"></a><span id="l6.18"> }</span>
<a href="#l6.19"></a><span id="l6.19"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/resources/content/datetimepickers/datetimepickers.xml</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/resources/content/datetimepickers/datetimepickers.xml</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -19,19 +19,32 @@</span>
<a href="#l7.4"></a><span id="l7.4">       document.getElementById(&quot;my-date-picker&quot;).disabled = true;</span>
<a href="#l7.5"></a><span id="l7.5">     May also disable/enable a datetimepicker's component</span>
<a href="#l7.6"></a><span id="l7.6">       datepicker or timepicker individually with</span>
<a href="#l7.7"></a><span id="l7.7">       document.getElementById(&quot;my-datetimepicker&quot;).datepickerdisabled = true;</span>
<a href="#l7.8"></a><span id="l7.8">       document.getElementById(&quot;my-datetimepicker&quot;).timepickerdisabled = true;</span>
<a href="#l7.9"></a><span id="l7.9"> --&gt;</span>
<a href="#l7.10"></a><span id="l7.10"> &lt;bindings id=&quot;xulDatePicker&quot;</span>
<a href="#l7.11"></a><span id="l7.11">           xmlns=&quot;http://www.mozilla.org/xbl&quot;</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+          xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l7.13"></a><span id="l7.13">           xmlns:xbl=&quot;http://www.mozilla.org/xbl&quot;</span>
<a href="#l7.14"></a><span id="l7.14">           xmlns:xul=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l7.15"></a><span id="l7.15"> </span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+  &lt;binding id=&quot;panellist&quot; extends=&quot;chrome://global/content/bindings/menulist.xml#menulist-editable&quot;&gt;</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+    &lt;content sizetopopup=&quot;pref&quot;&gt;</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+      &lt;xul:hbox class=&quot;menulist-editable-box textbox-input-box&quot; xbl:inherits=&quot;context,disabled,readonly,focused&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+        &lt;html:input class=&quot;menulist-editable-input&quot; flex=&quot;1&quot; anonid=&quot;input&quot; allowevents=&quot;true&quot;</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineplus">+                    xbl:inherits=&quot;value=label,value,disabled,tabindex,readonly,placeholder&quot;/&gt;</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineplus">+      &lt;/xul:hbox&gt;</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineplus">+      &lt;xul:dropmarker class=&quot;menulist-dropmarker&quot; type=&quot;menu&quot;</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineplus">+                      xbl:inherits=&quot;open,disabled,parentfocused=focused&quot;/&gt;</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineplus">+      &lt;children includes=&quot;panel&quot;/&gt;</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineplus">+    &lt;/content&gt;</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineplus">+  &lt;/binding&gt;</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineplus">+</span>
<a href="#l7.28"></a><span id="l7.28">   &lt;binding id=&quot;datetextpicker&quot;</span>
<a href="#l7.29"></a><span id="l7.29">            extends=&quot;chrome://calendar/content/datetimepickers/datetimepickers.xml#datetimepicker-base&quot;&gt;</span>
<a href="#l7.30"></a><span id="l7.30">     &lt;content&gt;</span>
<a href="#l7.31"></a><span id="l7.31">       &lt;xul:hbox flex=&quot;1&quot;&gt;</span>
<a href="#l7.32"></a><span id="l7.32">         &lt;xul:textbox anonid=&quot;date-textbox&quot; flex=&quot;1&quot;</span>
<a href="#l7.33"></a><span id="l7.33">                      onfocus=&quot;this.select();&quot;</span>
<a href="#l7.34"></a><span id="l7.34">                      onkeypress=&quot;if (event.keyCode == Components.interfaces.nsIDOMKeyEvent.DOM_VK_RETURN) fireGoEvent();&quot;/&gt;</span>
<a href="#l7.35"></a><span id="l7.35">         &lt;xul:button anonid=&quot;date-go-button&quot; oncommand=&quot;fireGoEvent()&quot;/&gt;</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineat">@@ -234,27 +247,28 @@</span>
<a href="#l7.37"></a><span id="l7.37">          So navigate parents to textbox in order to call parseTextBoxDate.</span>
<a href="#l7.38"></a><span id="l7.38">          [this comment is outside the &lt;content&gt; so it won't become a</span>
<a href="#l7.39"></a><span id="l7.39">          node that interferes with navigation to interior nodes.] --&gt;</span>
<a href="#l7.40"></a><span id="l7.40">     &lt;resources&gt;</span>
<a href="#l7.41"></a><span id="l7.41">       &lt;stylesheet src=&quot;chrome://calendar/content/widgets/calendar-widget-bindings.css&quot;/&gt;</span>
<a href="#l7.42"></a><span id="l7.42">     &lt;/resources&gt;</span>
<a href="#l7.43"></a><span id="l7.43">     &lt;content&gt;</span>
<a href="#l7.44"></a><span id="l7.44">       &lt;xul:hbox flex=&quot;1&quot; id=&quot;hbox&quot; class=&quot;datepicker-box-class&quot;&gt;</span>
<a href="#l7.45"></a><span id="l7.45" class="difflineminus">-        &lt;xul:menulist editable=&quot;true&quot; sizetopopup=&quot;false&quot;</span>
<a href="#l7.46"></a><span id="l7.46" class="difflineplus">+        &lt;xul:menulist editable=&quot;true&quot; type=&quot;panel&quot; sizetopopup=&quot;false&quot;</span>
<a href="#l7.47"></a><span id="l7.47">                       class=&quot;datepicker-text-class&quot;</span>
<a href="#l7.48"></a><span id="l7.48">                       onchange=&quot;this.kDatePicker.parseTextBoxDate(true, event);&quot;</span>
<a href="#l7.49"></a><span id="l7.49">                       onkeypress=&quot;if (event.keyCode == 13) this.kDatePicker.parseTextBoxDate(true);&quot;</span>
<a href="#l7.50"></a><span id="l7.50">                       xbl:inherits=&quot;disabled&quot;&gt;</span>
<a href="#l7.51"></a><span id="l7.51" class="difflineminus">-          &lt;xul:menupopup popupanchor=&quot;bottomright&quot; popupalign=&quot;topright&quot;</span>
<a href="#l7.52"></a><span id="l7.52" class="difflineminus">-                         anonid=&quot;datepopup&quot;</span>
<a href="#l7.53"></a><span id="l7.53" class="difflineminus">-                         onpopupshowing=&quot;this.parentNode.kDatePicker.onPopup();&quot;</span>
<a href="#l7.54"></a><span id="l7.54" class="difflineminus">-                         onpopuphiding=&quot;this.firstChild.hidePopupList();&quot;&gt;</span>
<a href="#l7.55"></a><span id="l7.55" class="difflineplus">+          &lt;xul:panel popupanchor=&quot;bottomright&quot; popupalign=&quot;topright&quot;</span>
<a href="#l7.56"></a><span id="l7.56" class="difflineplus">+                     anonid=&quot;datepopup&quot;</span>
<a href="#l7.57"></a><span id="l7.57" class="difflineplus">+                     onpopupshowing=&quot;this.kDatePicker.onPopup();&quot;</span>
<a href="#l7.58"></a><span id="l7.58" class="difflineplus">+                     onpopupshown=&quot;this.firstChild.focusCalendar();&quot;</span>
<a href="#l7.59"></a><span id="l7.59" class="difflineplus">+                     onpopuphiding=&quot;this.firstChild.hidePopupList();&quot;&gt;</span>
<a href="#l7.60"></a><span id="l7.60">             &lt;xul:minimonth/&gt;</span>
<a href="#l7.61"></a><span id="l7.61" class="difflineminus">-          &lt;/xul:menupopup&gt;</span>
<a href="#l7.62"></a><span id="l7.62" class="difflineplus">+          &lt;/xul:panel&gt;</span>
<a href="#l7.63"></a><span id="l7.63">         &lt;/xul:menulist&gt;</span>
<a href="#l7.64"></a><span id="l7.64">       &lt;/xul:hbox&gt;</span>
<a href="#l7.65"></a><span id="l7.65">     &lt;/content&gt;</span>
<a href="#l7.66"></a><span id="l7.66"> </span>
<a href="#l7.67"></a><span id="l7.67">     &lt;implementation&gt;</span>
<a href="#l7.68"></a><span id="l7.68">       &lt;constructor&gt;&lt;![CDATA[</span>
<a href="#l7.69"></a><span id="l7.69">         let hbox = document.getAnonymousNodes(this)[0];</span>
<a href="#l7.70"></a><span id="l7.70">         this.kTextBox = hbox.firstChild;</span>
<a href="#l7.71"></a><span id="l7.71" class="difflineat">@@ -262,18 +276,18 @@</span>
<a href="#l7.72"></a><span id="l7.72">         let val = this.getAttribute(&quot;value&quot;);</span>
<a href="#l7.73"></a><span id="l7.73">         if (val) {</span>
<a href="#l7.74"></a><span id="l7.74">             this.value = new Date(val); // setting value property calls update</span>
<a href="#l7.75"></a><span id="l7.75">         } else {</span>
<a href="#l7.76"></a><span id="l7.76">             this.value = new Date();</span>
<a href="#l7.77"></a><span id="l7.77">         }</span>
<a href="#l7.78"></a><span id="l7.78"> </span>
<a href="#l7.79"></a><span id="l7.79">         this.kTextBox.kDatePicker = this; // enable call back to method in Moz1.7</span>
<a href="#l7.80"></a><span id="l7.80" class="difflineminus">-        this.kTextBox.menupopup.kDatePicker = this;</span>
<a href="#l7.81"></a><span id="l7.81" class="difflineminus">-        this.kMinimonth = this.kTextBox.menupopup.firstChild;</span>
<a href="#l7.82"></a><span id="l7.82" class="difflineplus">+        this.kTextBox.firstChild.kDatePicker = this;</span>
<a href="#l7.83"></a><span id="l7.83" class="difflineplus">+        this.kMinimonth = this.kTextBox.firstChild.firstChild;</span>
<a href="#l7.84"></a><span id="l7.84">         this.mInPopup = false;</span>
<a href="#l7.85"></a><span id="l7.85">         this.kMinimonth.addEventListener(&quot;select&quot;, this.clickDate, false);</span>
<a href="#l7.86"></a><span id="l7.86">       ]]&gt;&lt;/constructor&gt;</span>
<a href="#l7.87"></a><span id="l7.87"> </span>
<a href="#l7.88"></a><span id="l7.88">       &lt;destructor&gt;&lt;![CDATA[</span>
<a href="#l7.89"></a><span id="l7.89">           this.kMinimonth.removeEventListener(&quot;select&quot;, this.clickDate, false);</span>
<a href="#l7.90"></a><span id="l7.90">       ]]&gt;&lt;/destructor&gt;</span>
<a href="#l7.91"></a><span id="l7.91"> </span>
<a href="#l7.92"></a><span id="l7.92" class="difflineat">@@ -323,18 +337,16 @@</span>
<a href="#l7.93"></a><span id="l7.93">         ]]&gt;&lt;/body&gt;</span>
<a href="#l7.94"></a><span id="l7.94">       &lt;/method&gt;</span>
<a href="#l7.95"></a><span id="l7.95"> </span>
<a href="#l7.96"></a><span id="l7.96">       &lt;method name=&quot;onPopup&quot;&gt;</span>
<a href="#l7.97"></a><span id="l7.97">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l7.98"></a><span id="l7.98">           this.mInPopup = true;</span>
<a href="#l7.99"></a><span id="l7.99">           this.kMinimonth.update(this.mValue);</span>
<a href="#l7.100"></a><span id="l7.100">           this.mInPopup = false;</span>
<a href="#l7.101"></a><span id="l7.101" class="difflineminus">-          // select all to remove cursor since can't type while popped-up</span>
<a href="#l7.102"></a><span id="l7.102" class="difflineminus">-          this.select();</span>
<a href="#l7.103"></a><span id="l7.103">         ]]&gt;&lt;/body&gt;</span>
<a href="#l7.104"></a><span id="l7.104">       &lt;/method&gt;</span>
<a href="#l7.105"></a><span id="l7.105"> </span>
<a href="#l7.106"></a><span id="l7.106">       &lt;method name=&quot;parseTextBoxDate&quot;&gt;</span>
<a href="#l7.107"></a><span id="l7.107">         &lt;parameter name=&quot;aRefresh&quot;/&gt;</span>
<a href="#l7.108"></a><span id="l7.108">         &lt;parameter name=&quot;aEvent&quot;/&gt;</span>
<a href="#l7.109"></a><span id="l7.109">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l7.110"></a><span id="l7.110">           // Stop the &quot;change&quot; event propagation. It will be properly</span>
<a href="#l7.111"></a><span id="l7.111" class="difflineat">@@ -378,31 +390,32 @@</span>
<a href="#l7.112"></a><span id="l7.112">           ]]&gt;&lt;/handler&gt;</span>
<a href="#l7.113"></a><span id="l7.113">       &lt;/handlers&gt;</span>
<a href="#l7.114"></a><span id="l7.114"> </span>
<a href="#l7.115"></a><span id="l7.115">   &lt;/binding&gt;</span>
<a href="#l7.116"></a><span id="l7.116"> </span>
<a href="#l7.117"></a><span id="l7.117">   &lt;binding id=&quot;datepicker-forever&quot; extends=&quot;chrome://calendar/content/datetimepickers/datetimepickers.xml#datepicker&quot;&gt;</span>
<a href="#l7.118"></a><span id="l7.118">     &lt;content&gt;</span>
<a href="#l7.119"></a><span id="l7.119">       &lt;xul:hbox flex=&quot;1&quot; id=&quot;hbox&quot; class=&quot;datepicker-box-class&quot;&gt;</span>
<a href="#l7.120"></a><span id="l7.120" class="difflineminus">-        &lt;xul:menulist anonid=&quot;foreverMenulist&quot; editable=&quot;true&quot; sizetopopup=&quot;false&quot;</span>
<a href="#l7.121"></a><span id="l7.121" class="difflineplus">+        &lt;xul:menulist anonid=&quot;foreverMenulist&quot; editable=&quot;true&quot; type=&quot;panel&quot; sizetopopup=&quot;false&quot;</span>
<a href="#l7.122"></a><span id="l7.122">                       class=&quot;datepicker-text-class&quot;</span>
<a href="#l7.123"></a><span id="l7.123">                       onchange=&quot;this.kDatePicker.parseTextBoxDate(true, event);&quot;</span>
<a href="#l7.124"></a><span id="l7.124">                       onkeypress=&quot;if (event.keyCode == 13) this.kDatePicker.parseTextBoxDate(true);&quot;</span>
<a href="#l7.125"></a><span id="l7.125">                       xbl:inherits=&quot;disabled&quot;&gt;</span>
<a href="#l7.126"></a><span id="l7.126" class="difflineminus">-          &lt;xul:menupopup popupanchor=&quot;bottomright&quot; popupalign=&quot;topright&quot;</span>
<a href="#l7.127"></a><span id="l7.127" class="difflineminus">-                         anonid=&quot;datepopup&quot;</span>
<a href="#l7.128"></a><span id="l7.128" class="difflineminus">-                         onpopupshowing=&quot;this.parentNode.kDatePicker.onPopup();&quot;</span>
<a href="#l7.129"></a><span id="l7.129" class="difflineminus">-                         onpopuphiding=&quot;this.firstChild.hidePopupList();&quot;&gt;</span>
<a href="#l7.130"></a><span id="l7.130" class="difflineplus">+          &lt;xul:panel popupanchor=&quot;bottomright&quot; popupalign=&quot;topright&quot;</span>
<a href="#l7.131"></a><span id="l7.131" class="difflineplus">+                     anonid=&quot;datepopup&quot;</span>
<a href="#l7.132"></a><span id="l7.132" class="difflineplus">+                     onpopupshowing=&quot;this.parentNode.kDatePicker.onPopup();&quot;</span>
<a href="#l7.133"></a><span id="l7.133" class="difflineplus">+                     onpopupshown=&quot;this.firstChild.focusCalendar();&quot;</span>
<a href="#l7.134"></a><span id="l7.134" class="difflineplus">+                     onpopuphiding=&quot;this.firstChild.hidePopupList();&quot;&gt;</span>
<a href="#l7.135"></a><span id="l7.135">             &lt;xul:minimonth/&gt;</span>
<a href="#l7.136"></a><span id="l7.136">             &lt;xul:menuseparator/&gt;</span>
<a href="#l7.137"></a><span id="l7.137" class="difflineminus">-            &lt;xul:menuitem anonid=&quot;menuitemForever&quot;</span>
<a href="#l7.138"></a><span id="l7.138" class="difflineminus">-                          class=&quot;datepicker-text-menuItem-class&quot;</span>
<a href="#l7.139"></a><span id="l7.139" class="difflineminus">-                          oncommand=&quot;onMenuitemForever();&quot;/&gt;</span>
<a href="#l7.140"></a><span id="l7.140" class="difflineminus">-          &lt;/xul:menupopup&gt;</span>
<a href="#l7.141"></a><span id="l7.141" class="difflineplus">+            &lt;xul:button anonid=&quot;menuitemForever&quot;</span>
<a href="#l7.142"></a><span id="l7.142" class="difflineplus">+                        class=&quot;datepicker-text-menuItem-class&quot;</span>
<a href="#l7.143"></a><span id="l7.143" class="difflineplus">+                        oncommand=&quot;onMenuitemForever(); this.parentNode.hidePopup();&quot;/&gt;</span>
<a href="#l7.144"></a><span id="l7.144" class="difflineplus">+          &lt;/xul:panel&gt;</span>
<a href="#l7.145"></a><span id="l7.145">         &lt;/xul:menulist&gt;</span>
<a href="#l7.146"></a><span id="l7.146">       &lt;/xul:hbox&gt;</span>
<a href="#l7.147"></a><span id="l7.147">     &lt;/content&gt;</span>
<a href="#l7.148"></a><span id="l7.148"> </span>
<a href="#l7.149"></a><span id="l7.149">     &lt;implementation&gt;</span>
<a href="#l7.150"></a><span id="l7.150">       &lt;field name=&quot;mForeverStr&quot;&gt;null&lt;/field&gt;</span>
<a href="#l7.151"></a><span id="l7.151"> </span>
<a href="#l7.152"></a><span id="l7.152">       &lt;constructor&gt;&lt;![CDATA[</span>
<a href="#l7.153"></a><span id="l7.153" class="difflineat">@@ -475,18 +488,16 @@</span>
<a href="#l7.154"></a><span id="l7.154">               if (this.mValue == &quot;forever&quot;) {</span>
<a href="#l7.155"></a><span id="l7.155">                   this.kMinimonth.update(null);</span>
<a href="#l7.156"></a><span id="l7.156">                   this.menuitemForever.setAttribute(&quot;highlight&quot;, &quot;true&quot;);</span>
<a href="#l7.157"></a><span id="l7.157">               } else {</span>
<a href="#l7.158"></a><span id="l7.158">                   this.kMinimonth.update(this.mValue);</span>
<a href="#l7.159"></a><span id="l7.159">                   this.menuitemForever.removeAttribute(&quot;highlight&quot;);</span>
<a href="#l7.160"></a><span id="l7.160">               }</span>
<a href="#l7.161"></a><span id="l7.161">               this.mInPopup = false;</span>
<a href="#l7.162"></a><span id="l7.162" class="difflineminus">-              // select all to remove cursor since can't type while popped-up</span>
<a href="#l7.163"></a><span id="l7.163" class="difflineminus">-              this.select();</span>
<a href="#l7.164"></a><span id="l7.164">           }</span>
<a href="#l7.165"></a><span id="l7.165">         ]]&gt;&lt;/body&gt;</span>
<a href="#l7.166"></a><span id="l7.166">       &lt;/method&gt;</span>
<a href="#l7.167"></a><span id="l7.167"> </span>
<a href="#l7.168"></a><span id="l7.168">       &lt;property name=&quot;valueValid&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l7.169"></a><span id="l7.169">         &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l7.170"></a><span id="l7.170">           return (this.mValue != null &amp;&amp; this.mValue != &quot;forever&quot;);</span>
<a href="#l7.171"></a><span id="l7.171">         ]]&gt;&lt;/getter&gt;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

