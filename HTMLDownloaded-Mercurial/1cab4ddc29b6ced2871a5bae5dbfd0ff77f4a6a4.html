<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 29846:1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4" />
<meta property="og:url" content="/comm-central/rev/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4" />
<meta property="og:description" content="Bug 1638822 - Bug 1638822 - convert openpgp strings to Fluent - jsm files. r=mkmelin" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4">shortlog</a> |
<a href="/comm-central/log/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4">files</a> |
changeset |
<a href="/comm-central/raw-rev/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4">raw</a>  | <a href="/comm-central/archive/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1638822">Bug 1638822</a> - <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1638822">Bug 1638822</a> - convert openpgp strings to Fluent - jsm files. r=mkmelin
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#75;&#104;&#117;&#115;&#104;&#105;&#108;&#32;&#77;&#105;&#115;&#116;&#114;&#121;&#32;&#60;&#107;&#104;&#117;&#115;&#104;&#105;&#108;&#51;&#50;&#52;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Thu, 11 Jun 2020 16:51:45 +0300</td></tr>

<tr>
 <td>changeset 29846</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4">1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4</a></td>
</tr>



<tr>
<td>parent 29845</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/637bcc4f812555829db44aad5ac8b574387c711f">637bcc4f812555829db44aad5ac8b574387c711f</a>
</td>
</tr>

<tr>
<td>child 29847</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/7db4a57f1718e07276b7dad99b335d67499f6d22">7db4a57f1718e07276b7dad99b335d67499f6d22</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4">17561</a></td></tr>
<tr><td>push user</td><td>mkmelin@iki.fi</td></tr>
<tr><td>push date</td><td class="date age">Thu, 11 Jun 2020 13:52:24 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@7db4a57f1718 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=7db4a57f1718e07276b7dad99b335d67499f6d22">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=7db4a57f1718e07276b7dad99b335d67499f6d22&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=7db4a57f1718e07276b7dad99b335d67499f6d22&newProject=comm-central&newRevision=637bcc4f812555829db44aad5ac8b574387c711f&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=7db4a57f1718e07276b7dad99b335d67499f6d22&newProject=comm-central&newRevision=637bcc4f812555829db44aad5ac8b574387c711f&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=7db4a57f1718e07276b7dad99b335d67499f6d22&newProject=comm-central&newRevision=637bcc4f812555829db44aad5ac8b574387c711f&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28mkmelin%29&revcount=50">mkmelin</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1638822">1638822</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1638822">Bug 1638822</a> - <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1638822">Bug 1638822</a> - convert openpgp strings to Fluent - jsm files. r=mkmelin</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/components/compose/content/messengercompose.xhtml">mail/components/compose/content/messengercompose.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/components/compose/content/messengercompose.xhtml">file</a> |
<a href="/comm-central/annotate/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/components/compose/content/messengercompose.xhtml">annotate</a> |
<a href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/components/compose/content/messengercompose.xhtml">diff</a> |
<a href="/comm-central/comparison/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/components/compose/content/messengercompose.xhtml">comparison</a> |
<a href="/comm-central/log/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/components/compose/content/messengercompose.xhtml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/gpg.jsm">mail/extensions/openpgp/content/modules/gpg.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/gpg.jsm">file</a> |
<a href="/comm-central/annotate/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/gpg.jsm">annotate</a> |
<a href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/gpg.jsm">diff</a> |
<a href="/comm-central/comparison/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/gpg.jsm">comparison</a> |
<a href="/comm-central/log/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/gpg.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/keyUsability.jsm">mail/extensions/openpgp/content/modules/keyUsability.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/keyUsability.jsm">file</a> |
<a href="/comm-central/annotate/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/keyUsability.jsm">annotate</a> |
<a href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/keyUsability.jsm">diff</a> |
<a href="/comm-central/comparison/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/keyUsability.jsm">comparison</a> |
<a href="/comm-central/log/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/keyUsability.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/keyserver.jsm">mail/extensions/openpgp/content/modules/keyserver.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/keyserver.jsm">file</a> |
<a href="/comm-central/annotate/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/keyserver.jsm">annotate</a> |
<a href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/keyserver.jsm">diff</a> |
<a href="/comm-central/comparison/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/keyserver.jsm">comparison</a> |
<a href="/comm-central/log/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/keyserver.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm">mail/extensions/openpgp/content/modules/mimeDecrypt.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm">file</a> |
<a href="/comm-central/annotate/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm">annotate</a> |
<a href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm">diff</a> |
<a href="/comm-central/comparison/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm">comparison</a> |
<a href="/comm-central/log/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/persistentCrypto.jsm">mail/extensions/openpgp/content/modules/persistentCrypto.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/persistentCrypto.jsm">file</a> |
<a href="/comm-central/annotate/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/persistentCrypto.jsm">annotate</a> |
<a href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/persistentCrypto.jsm">diff</a> |
<a href="/comm-central/comparison/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/persistentCrypto.jsm">comparison</a> |
<a href="/comm-central/log/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/persistentCrypto.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/wksMimeHandler.jsm">mail/extensions/openpgp/content/modules/wksMimeHandler.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/wksMimeHandler.jsm">file</a> |
<a href="/comm-central/annotate/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/wksMimeHandler.jsm">annotate</a> |
<a href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/wksMimeHandler.jsm">diff</a> |
<a href="/comm-central/comparison/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/wksMimeHandler.jsm">comparison</a> |
<a href="/comm-central/log/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/modules/wksMimeHandler.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/strings/enigmail.ftl">mail/extensions/openpgp/content/strings/enigmail.ftl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/strings/enigmail.ftl">file</a> |
<a href="/comm-central/annotate/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/strings/enigmail.ftl">annotate</a> |
<a href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/strings/enigmail.ftl">diff</a> |
<a href="/comm-central/comparison/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/strings/enigmail.ftl">comparison</a> |
<a href="/comm-central/log/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/strings/enigmail.ftl">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/strings/enigmail.properties">mail/extensions/openpgp/content/strings/enigmail.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/strings/enigmail.properties">file</a> |
<a href="/comm-central/annotate/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/strings/enigmail.properties">annotate</a> |
<a href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/strings/enigmail.properties">diff</a> |
<a href="/comm-central/comparison/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/strings/enigmail.properties">comparison</a> |
<a href="/comm-central/log/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/strings/enigmail.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/ui/enigmailMsgComposeOverlay.js">mail/extensions/openpgp/content/ui/enigmailMsgComposeOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/ui/enigmailMsgComposeOverlay.js">file</a> |
<a href="/comm-central/annotate/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/ui/enigmailMsgComposeOverlay.js">annotate</a> |
<a href="/comm-central/diff/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/ui/enigmailMsgComposeOverlay.js">diff</a> |
<a href="/comm-central/comparison/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/ui/enigmailMsgComposeOverlay.js">comparison</a> |
<a href="/comm-central/log/1cab4ddc29b6ced2871a5bae5dbfd0ff77f4a6a4/mail/extensions/openpgp/content/ui/enigmailMsgComposeOverlay.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/components/compose/content/messengercompose.xhtml</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/components/compose/content/messengercompose.xhtml</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -58,16 +58,17 @@</span>
<a href="#l1.4"></a><span id="l1.4">   &lt;stringbundle id=&quot;brandBundle&quot; src=&quot;chrome://branding/locale/brand.properties&quot;/&gt;</span>
<a href="#l1.5"></a><span id="l1.5">   &lt;stringbundle id=&quot;charsetBundle&quot; src=&quot;chrome://communicator/content/labelsencodings.properties&quot;/&gt;</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7"> &lt;linkset&gt;</span>
<a href="#l1.8"></a><span id="l1.8">   &lt;html:link rel=&quot;localization&quot; href=&quot;messenger/messengercompose/messengercompose.ftl&quot;/&gt;</span>
<a href="#l1.9"></a><span id="l1.9">   &lt;html:link rel=&quot;localization&quot; href=&quot;toolkit/main-window/findbar.ftl&quot;/&gt;</span>
<a href="#l1.10"></a><span id="l1.10">   &lt;html:link rel=&quot;localization&quot; href=&quot;toolkit/global/textActions.ftl&quot;/&gt;</span>
<a href="#l1.11"></a><span id="l1.11">   &lt;html:link rel=&quot;localization&quot; href=&quot;messenger/menubar.ftl&quot;/&gt;</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+  &lt;html:link rel=&quot;localization&quot; href=&quot;messenger/openpgp/enigmail.ftl&quot;/&gt;</span>
<a href="#l1.13"></a><span id="l1.13"> &lt;/linkset&gt;</span>
<a href="#l1.14"></a><span id="l1.14"> </span>
<a href="#l1.15"></a><span id="l1.15"> &lt;script src=&quot;chrome://global/content/globalOverlay.js&quot;/&gt;</span>
<a href="#l1.16"></a><span id="l1.16"> &lt;script src=&quot;chrome://global/content/editMenuOverlay.js&quot;/&gt;</span>
<a href="#l1.17"></a><span id="l1.17"> &lt;script src=&quot;chrome://global/content/printUtils.js&quot;/&gt;</span>
<a href="#l1.18"></a><span id="l1.18"> &lt;script src=&quot;chrome://messenger/content/accountUtils.js&quot;/&gt;</span>
<a href="#l1.19"></a><span id="l1.19"> &lt;script src=&quot;chrome://messenger/content/mailCore.js&quot;/&gt;</span>
<a href="#l1.20"></a><span id="l1.20"> &lt;script src=&quot;chrome://communicator/content/contentAreaClick.js&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/gpg.jsm</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/gpg.jsm</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -3,23 +3,22 @@</span>
<a href="#l2.4"></a><span id="l2.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l2.5"></a><span id="l2.5">  * file, You can obtain one at https://mozilla.org/MPL/2.0/.</span>
<a href="#l2.6"></a><span id="l2.6">  */</span>
<a href="#l2.7"></a><span id="l2.7"> </span>
<a href="#l2.8"></a><span id="l2.8"> &quot;use strict&quot;;</span>
<a href="#l2.9"></a><span id="l2.9"> </span>
<a href="#l2.10"></a><span id="l2.10"> const EXPORTED_SYMBOLS = [&quot;EnigmailGpg&quot;];</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-const { EnigmailLocale } = ChromeUtils.import(</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-  &quot;chrome://openpgp/content/modules/locale.jsm&quot;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineminus">-);</span>
<a href="#l2.15"></a><span id="l2.15"> const { EnigmailVersioning } = ChromeUtils.import(</span>
<a href="#l2.16"></a><span id="l2.16">   &quot;chrome://openpgp/content/modules/versioning.jsm&quot;</span>
<a href="#l2.17"></a><span id="l2.17"> );</span>
<a href="#l2.18"></a><span id="l2.18"> </span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+var l10n = new Localization([&quot;messenger/openpgp/enigmail.ftl&quot;], true);</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineplus">+</span>
<a href="#l2.21"></a><span id="l2.21"> const MINIMUM_GPG_VERSION = &quot;2.0.14&quot;;</span>
<a href="#l2.22"></a><span id="l2.22"> </span>
<a href="#l2.23"></a><span id="l2.23"> var EnigmailGpg = {</span>
<a href="#l2.24"></a><span id="l2.24">   agentVersion: &quot;&quot;,</span>
<a href="#l2.25"></a><span id="l2.25">   _agentPath: null,</span>
<a href="#l2.26"></a><span id="l2.26"> </span>
<a href="#l2.27"></a><span id="l2.27">   get agentPath() {</span>
<a href="#l2.28"></a><span id="l2.28">     return this._agentPath;</span>
<a href="#l2.29"></a><span id="l2.29" class="difflineat">@@ -138,19 +137,19 @@ var EnigmailGpg = {</span>
<a href="#l2.30"></a><span id="l2.30">         return &quot;ECDH&quot;;</span>
<a href="#l2.31"></a><span id="l2.31">       case 19:</span>
<a href="#l2.32"></a><span id="l2.32">         return &quot;ECDSA&quot;;</span>
<a href="#l2.33"></a><span id="l2.33">       case 20:</span>
<a href="#l2.34"></a><span id="l2.34">         return &quot;ELG&quot;;</span>
<a href="#l2.35"></a><span id="l2.35">       case 22:</span>
<a href="#l2.36"></a><span id="l2.36">         return &quot;EDDSA&quot;;</span>
<a href="#l2.37"></a><span id="l2.37">       default:</span>
<a href="#l2.38"></a><span id="l2.38" class="difflineminus">-        return EnigmailLocale.getString(&quot;unknownSigningAlg&quot;, [</span>
<a href="#l2.39"></a><span id="l2.39" class="difflineminus">-          parseInt(id, 10),</span>
<a href="#l2.40"></a><span id="l2.40" class="difflineminus">-        ]);</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineplus">+        return l10n.formatValueSync(&quot;unknown-signing-alg&quot;, {</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineplus">+          id: parseInt(id, 10),</span>
<a href="#l2.43"></a><span id="l2.43" class="difflineplus">+        });</span>
<a href="#l2.44"></a><span id="l2.44">     }</span>
<a href="#l2.45"></a><span id="l2.45">   },</span>
<a href="#l2.46"></a><span id="l2.46"> </span>
<a href="#l2.47"></a><span id="l2.47">   hashAlgIdToString(id) {</span>
<a href="#l2.48"></a><span id="l2.48">     // RFC 4880 Sec. 9.4</span>
<a href="#l2.49"></a><span id="l2.49">     switch (parseInt(id, 10)) {</span>
<a href="#l2.50"></a><span id="l2.50">       case 1:</span>
<a href="#l2.51"></a><span id="l2.51">         return &quot;MD5&quot;;</span>
<a href="#l2.52"></a><span id="l2.52" class="difflineat">@@ -162,12 +161,14 @@ var EnigmailGpg = {</span>
<a href="#l2.53"></a><span id="l2.53">         return &quot;SHA256&quot;;</span>
<a href="#l2.54"></a><span id="l2.54">       case 9:</span>
<a href="#l2.55"></a><span id="l2.55">         return &quot;SHA384&quot;;</span>
<a href="#l2.56"></a><span id="l2.56">       case 10:</span>
<a href="#l2.57"></a><span id="l2.57">         return &quot;SHA512&quot;;</span>
<a href="#l2.58"></a><span id="l2.58">       case 11:</span>
<a href="#l2.59"></a><span id="l2.59">         return &quot;SHA224&quot;;</span>
<a href="#l2.60"></a><span id="l2.60">       default:</span>
<a href="#l2.61"></a><span id="l2.61" class="difflineminus">-        return EnigmailLocale.getString(&quot;unknownHashAlg&quot;, [parseInt(id, 10)]);</span>
<a href="#l2.62"></a><span id="l2.62" class="difflineplus">+        return l10n.formatValueSync(&quot;unknown-hash-alg&quot;, {</span>
<a href="#l2.63"></a><span id="l2.63" class="difflineplus">+          id: parseInt(id, 10),</span>
<a href="#l2.64"></a><span id="l2.64" class="difflineplus">+        });</span>
<a href="#l2.65"></a><span id="l2.65">     }</span>
<a href="#l2.66"></a><span id="l2.66">   },</span>
<a href="#l2.67"></a><span id="l2.67"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/keyUsability.jsm</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/keyUsability.jsm</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -37,16 +37,18 @@ const getWindows = EnigmailLazy.loader(</span>
<a href="#l3.4"></a><span id="l3.4"> );</span>
<a href="#l3.5"></a><span id="l3.5"> const getKeyRing = EnigmailLazy.loader(</span>
<a href="#l3.6"></a><span id="l3.6">   &quot;enigmail/keyRing.jsm&quot;,</span>
<a href="#l3.7"></a><span id="l3.7">   &quot;EnigmailKeyRing&quot;</span>
<a href="#l3.8"></a><span id="l3.8"> );</span>
<a href="#l3.9"></a><span id="l3.9"> </span>
<a href="#l3.10"></a><span id="l3.10"> const DAY = 86400; // number of seconds of 1 day</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+var l10n = new Localization([&quot;messenger/openpgp/enigmail.ftl&quot;], true);</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+</span>
<a href="#l3.14"></a><span id="l3.14"> var EnigmailKeyUsability = {</span>
<a href="#l3.15"></a><span id="l3.15">   /**</span>
<a href="#l3.16"></a><span id="l3.16">    * Check whether some key pairs expire in less than N days from now.</span>
<a href="#l3.17"></a><span id="l3.17">    *</span>
<a href="#l3.18"></a><span id="l3.18">    * @param keySpecArr  - Array: list of key IDs or User IDs</span>
<a href="#l3.19"></a><span id="l3.19">    * @param numDay      - Number: number of days from now</span>
<a href="#l3.20"></a><span id="l3.20">    *</span>
<a href="#l3.21"></a><span id="l3.21">    * @return Array      - list of keys that will expire</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineat">@@ -187,30 +189,30 @@ var EnigmailKeyUsability = {</span>
<a href="#l3.23"></a><span id="l3.23">     let expiredKeys = this.getNewlyExpiredKeys();</span>
<a href="#l3.24"></a><span id="l3.24">     if (!expiredKeys || expiredKeys.length === 0) {</span>
<a href="#l3.25"></a><span id="l3.25">       return &quot;&quot;;</span>
<a href="#l3.26"></a><span id="l3.26">     }</span>
<a href="#l3.27"></a><span id="l3.27"> </span>
<a href="#l3.28"></a><span id="l3.28">     let numDays = EnigmailPrefs.getPref(&quot;warnKeyExpiryNumDays&quot;);</span>
<a href="#l3.29"></a><span id="l3.29"> </span>
<a href="#l3.30"></a><span id="l3.30">     if (expiredKeys.length === 1) {</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-      return EnigmailLocale.getString(&quot;expiry.keyExpiresSoon&quot;, [</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineminus">-        getKeyDesc(expiredKeys[0]),</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineminus">-        numDays,</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineminus">-      ]);</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineplus">+      return l10n.formatValueSync(&quot;expiry-key-expires-soon&quot;, {</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineplus">+        desc: getKeyDesc(expiredKeys[0]),</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineplus">+        days: numDays,</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineplus">+      });</span>
<a href="#l3.39"></a><span id="l3.39">     }</span>
<a href="#l3.40"></a><span id="l3.40"> </span>
<a href="#l3.41"></a><span id="l3.41">     let keyDesc = &quot;&quot;;</span>
<a href="#l3.42"></a><span id="l3.42">     for (let i = 0; i &lt; expiredKeys.length; i++) {</span>
<a href="#l3.43"></a><span id="l3.43">       keyDesc += &quot;- &quot; + getKeyDesc(expiredKeys[i]) + &quot;\n&quot;;</span>
<a href="#l3.44"></a><span id="l3.44">     }</span>
<a href="#l3.45"></a><span id="l3.45" class="difflineminus">-    return EnigmailLocale.getString(&quot;expiry.keysExpireSoon&quot;, [</span>
<a href="#l3.46"></a><span id="l3.46" class="difflineminus">-      numDays,</span>
<a href="#l3.47"></a><span id="l3.47" class="difflineminus">-      keyDesc,</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineminus">-    ]);</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineplus">+    return l10n.formatValueSync(&quot;expiry-keys-expire-soon&quot;, {</span>
<a href="#l3.50"></a><span id="l3.50" class="difflineplus">+      desc: keyDesc,</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineplus">+      days: numDays,</span>
<a href="#l3.52"></a><span id="l3.52" class="difflineplus">+    });</span>
<a href="#l3.53"></a><span id="l3.53">   },</span>
<a href="#l3.54"></a><span id="l3.54"> </span>
<a href="#l3.55"></a><span id="l3.55">   /**</span>
<a href="#l3.56"></a><span id="l3.56">    * Check whether some key pairs (i.e. key with a secret key) have an</span>
<a href="#l3.57"></a><span id="l3.57">    * ownertrust of less than &quot;ultimate&quot;.</span>
<a href="#l3.58"></a><span id="l3.58">    *</span>
<a href="#l3.59"></a><span id="l3.59">    * @param keySpecArr  - Array: list of key IDs or User IDs</span>
<a href="#l3.60"></a><span id="l3.60">    *</span>
<a href="#l3.61"></a><span id="l3.61" class="difflineat">@@ -275,49 +277,53 @@ var EnigmailKeyUsability = {</span>
<a href="#l3.62"></a><span id="l3.62">       return &quot;&quot;;</span>
<a href="#l3.63"></a><span id="l3.63">     }</span>
<a href="#l3.64"></a><span id="l3.64"> </span>
<a href="#l3.65"></a><span id="l3.65">     resultObj.Count = keysMissingOwnertrust.length;</span>
<a href="#l3.66"></a><span id="l3.66"> </span>
<a href="#l3.67"></a><span id="l3.67">     if (keysMissingOwnertrust.length === 1) {</span>
<a href="#l3.68"></a><span id="l3.68">       let keyDesc = getKeyDesc(keysMissingOwnertrust[0]);</span>
<a href="#l3.69"></a><span id="l3.69">       resultObj.keyId = keysMissingOwnertrust[0].keyId;</span>
<a href="#l3.70"></a><span id="l3.70" class="difflineminus">-      return EnigmailLocale.getString(&quot;expiry.keyMissingOwnerTrust&quot;, keyDesc);</span>
<a href="#l3.71"></a><span id="l3.71" class="difflineplus">+      return l10n.formatValueSync(&quot;expiry-key-missing-owner-trust&quot;, {</span>
<a href="#l3.72"></a><span id="l3.72" class="difflineplus">+        desc: keyDesc,</span>
<a href="#l3.73"></a><span id="l3.73" class="difflineplus">+      });</span>
<a href="#l3.74"></a><span id="l3.74">     }</span>
<a href="#l3.75"></a><span id="l3.75"> </span>
<a href="#l3.76"></a><span id="l3.76">     let keyDesc = &quot;&quot;;</span>
<a href="#l3.77"></a><span id="l3.77">     for (let i = 0; i &lt; keysMissingOwnertrust.length; i++) {</span>
<a href="#l3.78"></a><span id="l3.78">       keyDesc += &quot;- &quot; + getKeyDesc(keysMissingOwnertrust[i]) + &quot;\n&quot;;</span>
<a href="#l3.79"></a><span id="l3.79">     }</span>
<a href="#l3.80"></a><span id="l3.80" class="difflineminus">-    return EnigmailLocale.getString(&quot;expiry.keysMissingOwnerTrust&quot;, keyDesc);</span>
<a href="#l3.81"></a><span id="l3.81" class="difflineplus">+    return l10n.formatValueSync(&quot;expiry-keys-missing-owner-trust&quot;, {</span>
<a href="#l3.82"></a><span id="l3.82" class="difflineplus">+      desc: keyDesc,</span>
<a href="#l3.83"></a><span id="l3.83" class="difflineplus">+    });</span>
<a href="#l3.84"></a><span id="l3.84">   },</span>
<a href="#l3.85"></a><span id="l3.85"> </span>
<a href="#l3.86"></a><span id="l3.86">   /**</span>
<a href="#l3.87"></a><span id="l3.87">    * Run the check for Ownertrust (&quot;You rely on certifications&quot;) and</span>
<a href="#l3.88"></a><span id="l3.88">    * Display a message if something needs to be done</span>
<a href="#l3.89"></a><span id="l3.89">    */</span>
<a href="#l3.90"></a><span id="l3.90" class="difflineminus">-  checkOwnertrust() {</span>
<a href="#l3.91"></a><span id="l3.91" class="difflineplus">+  async checkOwnertrust() {</span>
<a href="#l3.92"></a><span id="l3.92">     EnigmailLog.DEBUG(&quot;keyUsability.jsm: checkOwnertrust\n&quot;);</span>
<a href="#l3.93"></a><span id="l3.93"> </span>
<a href="#l3.94"></a><span id="l3.94">     var resultObj = {};</span>
<a href="#l3.95"></a><span id="l3.95">     let msg = this.keyOwnerTrustCheck(resultObj);</span>
<a href="#l3.96"></a><span id="l3.96"> </span>
<a href="#l3.97"></a><span id="l3.97">     if (</span>
<a href="#l3.98"></a><span id="l3.98">       msg &amp;&amp;</span>
<a href="#l3.99"></a><span id="l3.99">       msg.length &gt; 0 &amp;&amp;</span>
<a href="#l3.100"></a><span id="l3.100">       EnigmailPrefs.getPref(&quot;warnOnMissingOwnerTrust&quot;)</span>
<a href="#l3.101"></a><span id="l3.101">     ) {</span>
<a href="#l3.102"></a><span id="l3.102">       let actionButtonText = &quot;&quot;;</span>
<a href="#l3.103"></a><span id="l3.103"> </span>
<a href="#l3.104"></a><span id="l3.104">       if (resultObj &amp;&amp; resultObj.Count === 1) {</span>
<a href="#l3.105"></a><span id="l3.105">         // single key is concerned</span>
<a href="#l3.106"></a><span id="l3.106" class="difflineminus">-        actionButtonText = EnigmailLocale.getString(&quot;expiry.OpenKeyProperties&quot;);</span>
<a href="#l3.107"></a><span id="l3.107" class="difflineplus">+        actionButtonText = await l10n.formatValue(&quot;expiry-open-key-properties&quot;);</span>
<a href="#l3.108"></a><span id="l3.108">       } else {</span>
<a href="#l3.109"></a><span id="l3.109">         // Multiple keys concerned</span>
<a href="#l3.110"></a><span id="l3.110" class="difflineminus">-        actionButtonText = EnigmailLocale.getString(&quot;expiry.OpenKeyManager2&quot;);</span>
<a href="#l3.111"></a><span id="l3.111" class="difflineplus">+        actionButtonText = await l10n.formatValue(&quot;expiry-open-key-manager&quot;);</span>
<a href="#l3.112"></a><span id="l3.112">       }</span>
<a href="#l3.113"></a><span id="l3.113"> </span>
<a href="#l3.114"></a><span id="l3.114">       let checkedObj = {};</span>
<a href="#l3.115"></a><span id="l3.115">       let r = getDialog().msgBox(</span>
<a href="#l3.116"></a><span id="l3.116">         null,</span>
<a href="#l3.117"></a><span id="l3.117">         {</span>
<a href="#l3.118"></a><span id="l3.118">           msgtext: msg,</span>
<a href="#l3.119"></a><span id="l3.119">           dialogTitle: EnigmailLocale.getString(&quot;enigInfo2&quot;),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/keyserver.jsm</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/keyserver.jsm</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -31,50 +31,53 @@ const { EnigmailXhrUtils } = ChromeUtils</span>
<a href="#l4.4"></a><span id="l4.4"> );</span>
<a href="#l4.5"></a><span id="l4.5"> const { EnigmailFuncs } = ChromeUtils.import(</span>
<a href="#l4.6"></a><span id="l4.6">   &quot;chrome://openpgp/content/modules/funcs.jsm&quot;</span>
<a href="#l4.7"></a><span id="l4.7"> );</span>
<a href="#l4.8"></a><span id="l4.8"> const { EnigmailCryptoAPI } = ChromeUtils.import(</span>
<a href="#l4.9"></a><span id="l4.9">   &quot;chrome://openpgp/content/modules/cryptoAPI.jsm&quot;</span>
<a href="#l4.10"></a><span id="l4.10"> );</span>
<a href="#l4.11"></a><span id="l4.11"> </span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+var l10n = new Localization([&quot;messenger/openpgp/enigmail.ftl&quot;], true);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+</span>
<a href="#l4.14"></a><span id="l4.14"> const ENIG_DEFAULT_HKP_PORT = &quot;11371&quot;;</span>
<a href="#l4.15"></a><span id="l4.15"> const ENIG_DEFAULT_HKPS_PORT = &quot;443&quot;;</span>
<a href="#l4.16"></a><span id="l4.16"> const ENIG_DEFAULT_LDAP_PORT = &quot;389&quot;;</span>
<a href="#l4.17"></a><span id="l4.17"> </span>
<a href="#l4.18"></a><span id="l4.18"> /**</span>
<a href="#l4.19"></a><span id="l4.19">  KeySrvListener API</span>
<a href="#l4.20"></a><span id="l4.20">  Object implementing:</span>
<a href="#l4.21"></a><span id="l4.21">   - onProgress: function(percentComplete) [only implemented for download()]</span>
<a href="#l4.22"></a><span id="l4.22">   - onCancel: function() - the body will be set by the callee</span>
<a href="#l4.23"></a><span id="l4.23"> */</span>
<a href="#l4.24"></a><span id="l4.24"> </span>
<a href="#l4.25"></a><span id="l4.25"> function createError(errId) {</span>
<a href="#l4.26"></a><span id="l4.26">   let msg = &quot;&quot;;</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineplus">+</span>
<a href="#l4.28"></a><span id="l4.28">   switch (errId) {</span>
<a href="#l4.29"></a><span id="l4.29">     case EnigmailConstants.KEYSERVER_ERR_ABORTED:</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineminus">-      msg = EnigmailLocale.getString(&quot;keyserver.error.aborted&quot;);</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineplus">+      msg = l10n.formatValueSync(&quot;keyserver-error-aborted&quot;);</span>
<a href="#l4.32"></a><span id="l4.32">       break;</span>
<a href="#l4.33"></a><span id="l4.33">     case EnigmailConstants.KEYSERVER_ERR_SERVER_ERROR:</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineminus">-      msg = EnigmailLocale.getString(&quot;keyserver.error.serverError&quot;);</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+      msg = l10n.formatValueSync(&quot;keyserver-error-server-error&quot;);</span>
<a href="#l4.36"></a><span id="l4.36">       break;</span>
<a href="#l4.37"></a><span id="l4.37">     case EnigmailConstants.KEYSERVER_ERR_SERVER_UNAVAILABLE:</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineminus">-      msg = EnigmailLocale.getString(&quot;keyserver.error.unavailable&quot;);</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+      msg = l10n.formatValueSync(&quot;keyserver-error-unavailable&quot;);</span>
<a href="#l4.40"></a><span id="l4.40">       break;</span>
<a href="#l4.41"></a><span id="l4.41">     case EnigmailConstants.KEYSERVER_ERR_SECURITY_ERROR:</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineminus">-      msg = EnigmailLocale.getString(&quot;keyserver.error.securityError&quot;);</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineplus">+      msg = l10n.formatValueSync(&quot;keyserver-error-security-error&quot;);</span>
<a href="#l4.44"></a><span id="l4.44">       break;</span>
<a href="#l4.45"></a><span id="l4.45">     case EnigmailConstants.KEYSERVER_ERR_CERTIFICATE_ERROR:</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineminus">-      msg = EnigmailLocale.getString(&quot;keyserver.error.certificateError&quot;);</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineplus">+      msg = l10n.formatValueSync(&quot;keyserver-error-certificate-error&quot;);</span>
<a href="#l4.48"></a><span id="l4.48">       break;</span>
<a href="#l4.49"></a><span id="l4.49">     case EnigmailConstants.KEYSERVER_ERR_IMPORT_ERROR:</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineminus">-      msg = EnigmailLocale.getString(&quot;keyserver.error.importError&quot;);</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineplus">+      msg = l10n.formatValueSync(&quot;keyserver-error-import-error&quot;);</span>
<a href="#l4.52"></a><span id="l4.52">       break;</span>
<a href="#l4.53"></a><span id="l4.53">     case EnigmailConstants.KEYSERVER_ERR_UNKNOWN:</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineminus">-      msg = EnigmailLocale.getString(&quot;keyserver.error.unknown&quot;);</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineplus">+      msg = l10n.formatValueSync(&quot;keyserver-error-unknown&quot;);</span>
<a href="#l4.56"></a><span id="l4.56">       break;</span>
<a href="#l4.57"></a><span id="l4.57">   }</span>
<a href="#l4.58"></a><span id="l4.58"> </span>
<a href="#l4.59"></a><span id="l4.59">   return {</span>
<a href="#l4.60"></a><span id="l4.60">     result: errId,</span>
<a href="#l4.61"></a><span id="l4.61">     errorDetails: msg,</span>
<a href="#l4.62"></a><span id="l4.62">   };</span>
<a href="#l4.63"></a><span id="l4.63"> }</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineat">@@ -517,18 +520,18 @@ const accessHkpInternal = {</span>
<a href="#l4.65"></a><span id="l4.65">           continue;</span>
<a href="#l4.66"></a><span id="l4.66">         }</span>
<a href="#l4.67"></a><span id="l4.67"> </span>
<a href="#l4.68"></a><span id="l4.68">         switch (line[0]) {</span>
<a href="#l4.69"></a><span id="l4.69">           case &quot;info&quot;:</span>
<a href="#l4.70"></a><span id="l4.70">             if (line[1] !== &quot;1&quot;) {</span>
<a href="#l4.71"></a><span id="l4.71">               // protocol version not supported</span>
<a href="#l4.72"></a><span id="l4.72">               retObj.result = 7;</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineminus">-              retObj.errorDetails = EnigmailLocale.getString(</span>
<a href="#l4.74"></a><span id="l4.74" class="difflineminus">-                &quot;keyserver.error.unsupported2&quot;</span>
<a href="#l4.75"></a><span id="l4.75" class="difflineplus">+              retObj.errorDetails = await l10n.formatValue(</span>
<a href="#l4.76"></a><span id="l4.76" class="difflineplus">+                &quot;keyserver-error-unsupported&quot;</span>
<a href="#l4.77"></a><span id="l4.77">               );</span>
<a href="#l4.78"></a><span id="l4.78">               retObj.pubKeys = [];</span>
<a href="#l4.79"></a><span id="l4.79">               return retObj;</span>
<a href="#l4.80"></a><span id="l4.80">             }</span>
<a href="#l4.81"></a><span id="l4.81">             break;</span>
<a href="#l4.82"></a><span id="l4.82">           case &quot;pub&quot;:</span>
<a href="#l4.83"></a><span id="l4.83">             if (line.length &gt;= 6) {</span>
<a href="#l4.84"></a><span id="l4.84">               if (key) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/mimeDecrypt.jsm</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -54,16 +54,18 @@ const { EnigmailCryptoAPI } = ChromeUtil</span>
<a href="#l5.4"></a><span id="l5.4"> );</span>
<a href="#l5.5"></a><span id="l5.5"> const { EnigmailAutocrypt } = ChromeUtils.import(</span>
<a href="#l5.6"></a><span id="l5.6">   &quot;chrome://openpgp/content/modules/autocrypt.jsm&quot;</span>
<a href="#l5.7"></a><span id="l5.7"> );</span>
<a href="#l5.8"></a><span id="l5.8"> const { EnigmailCompat } = ChromeUtils.import(</span>
<a href="#l5.9"></a><span id="l5.9">   &quot;chrome://openpgp/content/modules/compat.jsm&quot;</span>
<a href="#l5.10"></a><span id="l5.10"> );</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+var l10n = new Localization([&quot;messenger/openpgp/enigmail.ftl&quot;], true);</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+</span>
<a href="#l5.14"></a><span id="l5.14"> const ENCODING_DEFAULT = 0;</span>
<a href="#l5.15"></a><span id="l5.15"> const ENCODING_BASE64 = 1;</span>
<a href="#l5.16"></a><span id="l5.16"> const ENCODING_QP = 2;</span>
<a href="#l5.17"></a><span id="l5.17"> </span>
<a href="#l5.18"></a><span id="l5.18"> const LAST_MSG = EnigmailSingletons.lastDecryptedMessage;</span>
<a href="#l5.19"></a><span id="l5.19"> </span>
<a href="#l5.20"></a><span id="l5.20"> var gDebugLogLevel = 3;</span>
<a href="#l5.21"></a><span id="l5.21"> </span>
<a href="#l5.22"></a><span id="l5.22" class="difflineat">@@ -78,25 +80,23 @@ var EnigmailMimeDecrypt = {</span>
<a href="#l5.23"></a><span id="l5.23">   },</span>
<a href="#l5.24"></a><span id="l5.24"> </span>
<a href="#l5.25"></a><span id="l5.25">   /**</span>
<a href="#l5.26"></a><span id="l5.26">    * Return a fake empty attachment with information that the message</span>
<a href="#l5.27"></a><span id="l5.27">    * was not decrypted</span>
<a href="#l5.28"></a><span id="l5.28">    *</span>
<a href="#l5.29"></a><span id="l5.29">    * @return {String}: MIME string (HTML text)</span>
<a href="#l5.30"></a><span id="l5.30">    */</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineminus">-  emptyAttachment() {</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+  async emptyAttachment() {</span>
<a href="#l5.33"></a><span id="l5.33">     EnigmailLog.DEBUG(&quot;mimeDecrypt.jsm: emptyAttachment()\n&quot;);</span>
<a href="#l5.34"></a><span id="l5.34"> </span>
<a href="#l5.35"></a><span id="l5.35" class="difflineminus">-    let encPart = EnigmailLocale.getString(</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineminus">-      &quot;mimeDecrypt.encryptedPart.attachmentLabel&quot;</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineminus">-    );</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineminus">-    let concealed = EnigmailLocale.getString(</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineminus">-      &quot;mimeDecrypt.encryptedPart.concealedData&quot;</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineminus">-    );</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+    let [encPart, concealed] = await l10n.formatValues([</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+      { id: &quot;mime-decrypt-encrypted-part-attachment-label&quot; },</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineplus">+      { id: &quot;mime-decrypt-encrypted-part-concealed-data&quot; },</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineplus">+    ]);</span>
<a href="#l5.45"></a><span id="l5.45">     let retData = `Content-Type: message/rfc822; name=&quot;${encPart}.eml&quot;</span>
<a href="#l5.46"></a><span id="l5.46"> Content-Transfer-Encoding: 7bit</span>
<a href="#l5.47"></a><span id="l5.47"> Content-Disposition: attachment; filename=&quot;${encPart}.eml&quot;</span>
<a href="#l5.48"></a><span id="l5.48"> </span>
<a href="#l5.49"></a><span id="l5.49"> Content-Type: text/html</span>
<a href="#l5.50"></a><span id="l5.50"> </span>
<a href="#l5.51"></a><span id="l5.51"> &lt;p&gt;&lt;i&gt;${concealed}&lt;/i&gt;&lt;/p&gt;</span>
<a href="#l5.52"></a><span id="l5.52"> `;</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineat">@@ -519,17 +519,19 @@ MimeDecryptHandler.prototype = {</span>
<a href="#l5.54"></a><span id="l5.54">     EnigmailLog.DEBUG(</span>
<a href="#l5.55"></a><span id="l5.55">       `mimeDecrypt.jsm: checking MIME structure for ${this.mimePartNumber} / ${spec}\n`</span>
<a href="#l5.56"></a><span id="l5.56">     );</span>
<a href="#l5.57"></a><span id="l5.57"> </span>
<a href="#l5.58"></a><span id="l5.58">     if (</span>
<a href="#l5.59"></a><span id="l5.59">       !EnigmailMime.isRegularMimeStructure(this.mimePartNumber, spec, false)</span>
<a href="#l5.60"></a><span id="l5.60">     ) {</span>
<a href="#l5.61"></a><span id="l5.61">       if (!this.isUrlEnigmailConvert()) {</span>
<a href="#l5.62"></a><span id="l5.62" class="difflineminus">-        this.returnData(EnigmailMimeDecrypt.emptyAttachment());</span>
<a href="#l5.63"></a><span id="l5.63" class="difflineplus">+        EnigmailMimeDecrypt.emptyAttachment().then(value =&gt; {</span>
<a href="#l5.64"></a><span id="l5.64" class="difflineplus">+          this.returnData(value);</span>
<a href="#l5.65"></a><span id="l5.65" class="difflineplus">+        });</span>
<a href="#l5.66"></a><span id="l5.66">       } else {</span>
<a href="#l5.67"></a><span id="l5.67">         throw new Error(</span>
<a href="#l5.68"></a><span id="l5.68">           &quot;Cannot decrypt messages with mixed (encrypted/non-encrypted) content&quot;</span>
<a href="#l5.69"></a><span id="l5.69">         );</span>
<a href="#l5.70"></a><span id="l5.70">       }</span>
<a href="#l5.71"></a><span id="l5.71">       return;</span>
<a href="#l5.72"></a><span id="l5.72">     }</span>
<a href="#l5.73"></a><span id="l5.73"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/persistentCrypto.jsm</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/persistentCrypto.jsm</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -46,16 +46,18 @@ const { EnigmailConstants } = ChromeUtil</span>
<a href="#l6.4"></a><span id="l6.4"> const { jsmime } = ChromeUtils.import(&quot;resource:///modules/jsmime.jsm&quot;);</span>
<a href="#l6.5"></a><span id="l6.5"> const { EnigmailStdlib } = ChromeUtils.import(</span>
<a href="#l6.6"></a><span id="l6.6">   &quot;chrome://openpgp/content/modules/stdlib.jsm&quot;</span>
<a href="#l6.7"></a><span id="l6.7"> );</span>
<a href="#l6.8"></a><span id="l6.8"> const { EnigmailEncryption } = ChromeUtils.import(</span>
<a href="#l6.9"></a><span id="l6.9">   &quot;chrome://openpgp/content/modules/encryption.jsm&quot;</span>
<a href="#l6.10"></a><span id="l6.10"> );</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+var l10n = new Localization([&quot;messenger/openpgp/enigmail.ftl&quot;], true);</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+</span>
<a href="#l6.14"></a><span id="l6.14"> const getFixExchangeMsg = EnigmailLazy.loader(</span>
<a href="#l6.15"></a><span id="l6.15">   &quot;enigmail/fixExchangeMsg.jsm&quot;,</span>
<a href="#l6.16"></a><span id="l6.16">   &quot;EnigmailFixExchangeMsg&quot;</span>
<a href="#l6.17"></a><span id="l6.17"> );</span>
<a href="#l6.18"></a><span id="l6.18"> const getDecryption = EnigmailLazy.loader(</span>
<a href="#l6.19"></a><span id="l6.19">   &quot;enigmail/decryption.jsm&quot;,</span>
<a href="#l6.20"></a><span id="l6.20">   &quot;EnigmailDecryption&quot;</span>
<a href="#l6.21"></a><span id="l6.21"> );</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineat">@@ -548,17 +550,17 @@ CryptMessageIntoFolder.prototype = {</span>
<a href="#l6.23"></a><span id="l6.23">       }</span>
<a href="#l6.24"></a><span id="l6.24">       ct += `; ${i[0]}=&quot;${i[1]}&quot;`;</span>
<a href="#l6.25"></a><span id="l6.25">     }</span>
<a href="#l6.26"></a><span id="l6.26"> </span>
<a href="#l6.27"></a><span id="l6.27">     mimePart.headers._rawHeaders.set(&quot;content-type&quot;, [ct]);</span>
<a href="#l6.28"></a><span id="l6.28">     */</span>
<a href="#l6.29"></a><span id="l6.29">   },</span>
<a href="#l6.30"></a><span id="l6.30"> </span>
<a href="#l6.31"></a><span id="l6.31" class="difflineminus">-  decryptINLINE(mimePart) {</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineplus">+  async decryptINLINE(mimePart) {</span>
<a href="#l6.33"></a><span id="l6.33">     EnigmailLog.DEBUG(&quot;persistentCrypto.jsm: decryptINLINE()\n&quot;);</span>
<a href="#l6.34"></a><span id="l6.34"> </span>
<a href="#l6.35"></a><span id="l6.35">     if (&quot;decryptedPgpMime&quot; in mimePart &amp;&amp; mimePart.decryptedPgpMime) {</span>
<a href="#l6.36"></a><span id="l6.36">       return 0;</span>
<a href="#l6.37"></a><span id="l6.37">     }</span>
<a href="#l6.38"></a><span id="l6.38"> </span>
<a href="#l6.39"></a><span id="l6.39">     if (&quot;body&quot; in mimePart &amp;&amp; mimePart.body.length &gt; 0) {</span>
<a href="#l6.40"></a><span id="l6.40">       let ct = getContentType(mimePart);</span>
<a href="#l6.41"></a><span id="l6.41" class="difflineat">@@ -650,19 +652,21 @@ CryptMessageIntoFolder.prototype = {</span>
<a href="#l6.42"></a><span id="l6.42">             ) {</span>
<a href="#l6.43"></a><span id="l6.43">               EnigmailLog.DEBUG(</span>
<a href="#l6.44"></a><span id="l6.44">                 &quot;persistentCrypto.jsm: decryptINLINE: no MDC protection, decrypting anyway\n&quot;</span>
<a href="#l6.45"></a><span id="l6.45">               );</span>
<a href="#l6.46"></a><span id="l6.46">             }</span>
<a href="#l6.47"></a><span id="l6.47">             if (statusFlagsObj.value &amp; EnigmailConstants.DECRYPTION_FAILED) {</span>
<a href="#l6.48"></a><span id="l6.48">               // since we cannot find out if the user wants to cancel</span>
<a href="#l6.49"></a><span id="l6.49">               // we should ask</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineminus">-              let msg = EnigmailLocale.getString(</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineminus">-                &quot;converter.decryptBody.failed&quot;,</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineminus">-                this.subject</span>
<a href="#l6.53"></a><span id="l6.53" class="difflineplus">+              let msg = await l10n.formatValue(</span>
<a href="#l6.54"></a><span id="l6.54" class="difflineplus">+                &quot;converter-decrypt-body-failed&quot;,</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineplus">+                {</span>
<a href="#l6.56"></a><span id="l6.56" class="difflineplus">+                  subject: this.subject,</span>
<a href="#l6.57"></a><span id="l6.57" class="difflineplus">+                }</span>
<a href="#l6.58"></a><span id="l6.58">               );</span>
<a href="#l6.59"></a><span id="l6.59"> </span>
<a href="#l6.60"></a><span id="l6.60">               if (</span>
<a href="#l6.61"></a><span id="l6.61">                 !getDialog().confirmDlg(</span>
<a href="#l6.62"></a><span id="l6.62">                   null,</span>
<a href="#l6.63"></a><span id="l6.63">                   msg,</span>
<a href="#l6.64"></a><span id="l6.64">                   EnigmailLocale.getString(&quot;dlg.button.retry&quot;),</span>
<a href="#l6.65"></a><span id="l6.65">                   EnigmailLocale.getString(&quot;dlg.button.skip&quot;)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/wksMimeHandler.jsm</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/wksMimeHandler.jsm</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -16,29 +16,28 @@ const { EnigmailCompat } = ChromeUtils.i</span>
<a href="#l7.4"></a><span id="l7.4">   &quot;chrome://openpgp/content/modules/compat.jsm&quot;</span>
<a href="#l7.5"></a><span id="l7.5"> );</span>
<a href="#l7.6"></a><span id="l7.6"> const { EnigmailVerify } = ChromeUtils.import(</span>
<a href="#l7.7"></a><span id="l7.7">   &quot;chrome://openpgp/content/modules/mimeVerify.jsm&quot;</span>
<a href="#l7.8"></a><span id="l7.8"> );</span>
<a href="#l7.9"></a><span id="l7.9"> const { EnigmailLog } = ChromeUtils.import(</span>
<a href="#l7.10"></a><span id="l7.10">   &quot;chrome://openpgp/content/modules/log.jsm&quot;</span>
<a href="#l7.11"></a><span id="l7.11"> );</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-const { EnigmailLocale } = ChromeUtils.import(</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-  &quot;chrome://openpgp/content/modules/locale.jsm&quot;</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-);</span>
<a href="#l7.15"></a><span id="l7.15"> const { EnigmailDecryption } = ChromeUtils.import(</span>
<a href="#l7.16"></a><span id="l7.16">   &quot;chrome://openpgp/content/modules/decryption.jsm&quot;</span>
<a href="#l7.17"></a><span id="l7.17"> );</span>
<a href="#l7.18"></a><span id="l7.18"> const { EnigmailSingletons } = ChromeUtils.import(</span>
<a href="#l7.19"></a><span id="l7.19">   &quot;chrome://openpgp/content/modules/singletons.jsm&quot;</span>
<a href="#l7.20"></a><span id="l7.20"> );</span>
<a href="#l7.21"></a><span id="l7.21"> const { EnigmailConstants } = ChromeUtils.import(</span>
<a href="#l7.22"></a><span id="l7.22">   &quot;chrome://openpgp/content/modules/constants.jsm&quot;</span>
<a href="#l7.23"></a><span id="l7.23"> );</span>
<a href="#l7.24"></a><span id="l7.24"> </span>
<a href="#l7.25"></a><span id="l7.25" class="difflineplus">+var l10n = new Localization([&quot;messenger/openpgp/enigmail.ftl&quot;], true);</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineplus">+</span>
<a href="#l7.27"></a><span id="l7.27"> var gDebugLog = false;</span>
<a href="#l7.28"></a><span id="l7.28"> </span>
<a href="#l7.29"></a><span id="l7.29"> var EnigmailWksMimeHandler = {</span>
<a href="#l7.30"></a><span id="l7.30">   /***</span>
<a href="#l7.31"></a><span id="l7.31">    * register a PGP/MIME verify object the same way PGP/MIME encrypted mail is handled</span>
<a href="#l7.32"></a><span id="l7.32">    */</span>
<a href="#l7.33"></a><span id="l7.33">   registerContentTypeHandler() {</span>
<a href="#l7.34"></a><span id="l7.34">     EnigmailLog.DEBUG(&quot;wksMimeHandler.jsm: registerContentTypeHandler()\n&quot;);</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineat">@@ -122,25 +121,27 @@ PgpWkdHandler.prototype = {</span>
<a href="#l7.36"></a><span id="l7.36">   onStopRequest() {</span>
<a href="#l7.37"></a><span id="l7.37">     EnigmailLog.DEBUG(&quot;wksMimeHandler.jsm: onStopRequest\n&quot;);</span>
<a href="#l7.38"></a><span id="l7.38"> </span>
<a href="#l7.39"></a><span id="l7.39">     if (this.data.search(/-----BEGIN PGP MESSAGE-----/i) &gt;= 0) {</span>
<a href="#l7.40"></a><span id="l7.40">       this.decryptChallengeData();</span>
<a href="#l7.41"></a><span id="l7.41">     }</span>
<a href="#l7.42"></a><span id="l7.42"> </span>
<a href="#l7.43"></a><span id="l7.43">     let jsonStr = this.requestToJsonString(this.data);</span>
<a href="#l7.44"></a><span id="l7.44" class="difflineminus">-    let msg = &quot;&quot;;</span>
<a href="#l7.45"></a><span id="l7.45"> </span>
<a href="#l7.46"></a><span id="l7.46">     if (this.data.search(/^\s*type:\s+confirmation-request/im) &gt;= 0) {</span>
<a href="#l7.47"></a><span id="l7.47" class="difflineminus">-      msg = EnigmailLocale.getString(&quot;wkdMessage.body.req2&quot;);</span>
<a href="#l7.48"></a><span id="l7.48" class="difflineplus">+      l10n.formatValue(&quot;wkd-message-body-req&quot;).then(value =&gt; {</span>
<a href="#l7.49"></a><span id="l7.49" class="difflineplus">+        this.returnData(value);</span>
<a href="#l7.50"></a><span id="l7.50" class="difflineplus">+      });</span>
<a href="#l7.51"></a><span id="l7.51">     } else {</span>
<a href="#l7.52"></a><span id="l7.52" class="difflineminus">-      msg = EnigmailLocale.getString(&quot;wkdMessage.body.process&quot;);</span>
<a href="#l7.53"></a><span id="l7.53" class="difflineplus">+      l10n.formatValue(&quot;wkd-message-body-process&quot;).then(value =&gt; {</span>
<a href="#l7.54"></a><span id="l7.54" class="difflineplus">+        this.returnData(value);</span>
<a href="#l7.55"></a><span id="l7.55" class="difflineplus">+      });</span>
<a href="#l7.56"></a><span id="l7.56">     }</span>
<a href="#l7.57"></a><span id="l7.57"> </span>
<a href="#l7.58"></a><span id="l7.58" class="difflineminus">-    this.returnData(msg);</span>
<a href="#l7.59"></a><span id="l7.59">     this.displayStatus(jsonStr);</span>
<a href="#l7.60"></a><span id="l7.60">   },</span>
<a href="#l7.61"></a><span id="l7.61"> </span>
<a href="#l7.62"></a><span id="l7.62">   decryptChallengeData() {</span>
<a href="#l7.63"></a><span id="l7.63">     EnigmailLog.DEBUG(&quot;wksMimeHandler.jsm: decryptChallengeData()\n&quot;);</span>
<a href="#l7.64"></a><span id="l7.64">     let windowManager = Services.wm;</span>
<a href="#l7.65"></a><span id="l7.65">     let win = windowManager.getMostRecentWindow(null);</span>
<a href="#l7.66"></a><span id="l7.66">     let statusFlagsObj = {};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/extensions/openpgp/content/strings/enigmail.ftl</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/strings/enigmail.ftl</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -198,8 +198,45 @@ key-usage-sign = Sign</span>
<a href="#l8.4"></a><span id="l8.4"> key-usage-certify = Certify</span>
<a href="#l8.5"></a><span id="l8.5"> key-usage-authentication = Authentication</span>
<a href="#l8.6"></a><span id="l8.6"> key-does-not-expire = Key does not expire</span>
<a href="#l8.7"></a><span id="l8.7"> key-expired = Key expired on { $keyExpiry }</span>
<a href="#l8.8"></a><span id="l8.8"> key-revoked = Key was revoked</span>
<a href="#l8.9"></a><span id="l8.9"> key-auto-accept-personal = You accept this key for all uses, because it is one of your personal keys. You have the secret key.</span>
<a href="#l8.10"></a><span id="l8.10"> key-do-you-accept = Do you accept this key for verifying digital signatures and for encrypting messages?</span>
<a href="#l8.11"></a><span id="l8.11"> key-accept-warning = Avoid accepting a rogue key. Use a communication channel other than email to verify the fingerprint of your correspondent's key.</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+# Strings enigmailMsgComposeOverlay.js</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+cannot-use-own-key-because = Unable to send the message, because there is a problem with your personal key. { $problem }</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineplus">+cannot-encrypt-because-missing = Unable to send this message with end-to-end encryption, because there are problems with the keys of the following recipients: { $problem }</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineplus">+</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineplus">+# Strings in mimeDecrypt.jsm</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineplus">+mime-decrypt-encrypted-part-attachment-label = Encrypted message part</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+mime-decrypt-encrypted-part-concealed-data = This is an encrypted message part. You need to open it in a separate window by clicking on the attachment.</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineplus">+</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineplus">+# Strings in keyserver.jsm</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineplus">+keyserver-error-aborted = Aborted</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineplus">+keyserver-error-unknown = An unknown error occurred</span>
<a href="#l8.24"></a><span id="l8.24" class="difflineplus">+keyserver-error-server-error = The keyserver reported an error.</span>
<a href="#l8.25"></a><span id="l8.25" class="difflineplus">+keyserver-error-import-error = Failed to import the downloaded key.</span>
<a href="#l8.26"></a><span id="l8.26" class="difflineplus">+keyserver-error-unavailable = The keyserver is not available.</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineplus">+keyserver-error-security-error = The keyserver does not support encrypted access.</span>
<a href="#l8.28"></a><span id="l8.28" class="difflineplus">+keyserver-error-certificate-error = The keyserver’s certificate is not valid.</span>
<a href="#l8.29"></a><span id="l8.29" class="difflineplus">+keyserver-error-unsupported = The keyserver is not supported.</span>
<a href="#l8.30"></a><span id="l8.30" class="difflineplus">+</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineplus">+# Strings in mimeWkdHandler.jsm</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineplus">+wkd-message-body-req = Your email provider processed your request to upload your public key to the OpenPGP Web Key Directory.\n\nPlease confirm to complete the publishing of your public key.</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineplus">+wkd-message-body-process = This is an email related to the automatic processing to upload your public key to the OpenPGP Web Key Directory.\n\nYou do not need to take any manual action at this point.</span>
<a href="#l8.34"></a><span id="l8.34" class="difflineplus">+</span>
<a href="#l8.35"></a><span id="l8.35" class="difflineplus">+# Strings in persistentCrypto.jsm</span>
<a href="#l8.36"></a><span id="l8.36" class="difflineplus">+converter-decrypt-body-failed = Could not decrypt message with subject\n{ $subject }.\nDo you want to retry with a different passphrase or do you want to skip the message?</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineplus">+</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineplus">+# Strings in gpg.jsm</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineplus">+unknown-signing-alg = Unknown signing algorithm (ID: { $id })</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineplus">+unknown-hash-alg = Unknown cryptographic hash (ID: { $id })</span>
<a href="#l8.41"></a><span id="l8.41" class="difflineplus">+</span>
<a href="#l8.42"></a><span id="l8.42" class="difflineplus">+#strings in keyUsability.jsm</span>
<a href="#l8.43"></a><span id="l8.43" class="difflineplus">+expiry-key-expires-soon = Your key { $desc } will expire in less than { $days } days.\n\nWe recommend that you create a new key pair and configure the corresponding accounts to use it.</span>
<a href="#l8.44"></a><span id="l8.44" class="difflineplus">+expiry-keys-expire-soon = Your following keys will expire in less than { $days } days:\n{ $desc }. We recommend that you create new keys and configure the corresponding accounts to use them.</span>
<a href="#l8.45"></a><span id="l8.45" class="difflineplus">+expiry-key-missing-owner-trust = Your secret key { $desc } has missing trust.\n\nWe recommend that you set &quot;You rely on certifications&quot; to &quot;ultimate&quot; in key properties.</span>
<a href="#l8.46"></a><span id="l8.46" class="difflineplus">+expiry-keys-missing-owner-trust = The following of your secret keys have missing trust.\n{ $desc }.\nWe recommend that you set &quot;You rely on certifications&quot; to &quot;ultimate&quot; in key properties.</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineplus">+expiry-open-key-manager = Open OpenPGP Key Management</span>
<a href="#l8.48"></a><span id="l8.48" class="difflineplus">+expiry-open-key-properties = Open Key Properties</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mail/extensions/openpgp/content/strings/enigmail.properties</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/strings/enigmail.properties</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -464,17 +464,17 @@ importInfoNoKeys=No keys imported.</span>
<a href="#l9.4"></a><span id="l9.4"> ### keygen.passRequired=Please specify a passphrase if you want to create a backup copy of your key outside your SmartCard.</span>
<a href="#l9.5"></a><span id="l9.5"> </span>
<a href="#l9.6"></a><span id="l9.6"> # Strings in enigmailSetCardPin.xhtml</span>
<a href="#l9.7"></a><span id="l9.7"> ### cardPin.processFailed=Failed to change PIN</span>
<a href="#l9.8"></a><span id="l9.8"> </span>
<a href="#l9.9"></a><span id="l9.9"> # Strings in enigRetrieveProgres.js</span>
<a href="#l9.10"></a><span id="l9.10"> ### keyserverProgress.refreshing=Refreshing keys, please wait ...</span>
<a href="#l9.11"></a><span id="l9.11"> ### keyserverProgress.uploading=Uploading keys, please wait ...</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-keyserverProgress.wksUploadFailed=Could not upload your key to the Web Key Service</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+### keyserverProgress.wksUploadFailed=Could not upload your key to the Web Key Service</span>
<a href="#l9.14"></a><span id="l9.14"> ### keyserverProgress.wksUploadCompleted=Your public key was successfully submitted to your provider. You will receive an email to confirm that you initiated the upload.</span>
<a href="#l9.15"></a><span id="l9.15"> ### keyserverTitle.refreshing=Refresh Keys</span>
<a href="#l9.16"></a><span id="l9.16"> ### keyserverTitle.uploading=Key Upload</span>
<a href="#l9.17"></a><span id="l9.17"> ### keyserver.result.download.none=No key downloaded.</span>
<a href="#l9.18"></a><span id="l9.18"> ### keyserver.result.download.1of1=Key successfully downloaded.</span>
<a href="#l9.19"></a><span id="l9.19"> ### keyserver.result.download.1ofN=Successfully downloaded 1 of %S keys.</span>
<a href="#l9.20"></a><span id="l9.20"> ### keyserver.result.download.NofN=Successfully downloaded %1$S of %2$S keys.</span>
<a href="#l9.21"></a><span id="l9.21"> ### keyserver.result.uploadOne=Successfully uploaded 1 key.</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineat">@@ -487,43 +487,36 @@ keyserverProgress.wksUploadFailed=Could </span>
<a href="#l9.23"></a><span id="l9.23"> # Strings in enigmailAddUidDlg.xhtml</span>
<a href="#l9.24"></a><span id="l9.24"> ### addUidDlg.nameOrEmailError=You have to fill in a name and an email address</span>
<a href="#l9.25"></a><span id="l9.25"> ### addUidDlg.nameMinLengthError=The name must at least have 5 characters</span>
<a href="#l9.26"></a><span id="l9.26"> ### addUidDlg.invalidEmailError=You must specify a valid email address</span>
<a href="#l9.27"></a><span id="l9.27"> </span>
<a href="#l9.28"></a><span id="l9.28"> # Strings in enigmailCardDetails.js</span>
<a href="#l9.29"></a><span id="l9.29"> ### Carddetails.NoASCII=OpenPGP Smartcards only support ASCII characters in Firstname/Name.</span>
<a href="#l9.30"></a><span id="l9.30"> </span>
<a href="#l9.31"></a><span id="l9.31" class="difflineminus">-</span>
<a href="#l9.32"></a><span id="l9.32"> # network error types</span>
<a href="#l9.33"></a><span id="l9.33"> ### errorType.SecurityCertificate=The security certificate presented by the web service is not valid.</span>
<a href="#l9.34"></a><span id="l9.34"> ### errorType.SecurityProtocol=The security protocol used by the web service is unknown.</span>
<a href="#l9.35"></a><span id="l9.35"> ### errorType.Network=A network error has occurred.</span>
<a href="#l9.36"></a><span id="l9.36"> </span>
<a href="#l9.37"></a><span id="l9.37"> # filter stuff</span>
<a href="#l9.38"></a><span id="l9.38"> filter.folderRequired=You must select a target folder.</span>
<a href="#l9.39"></a><span id="l9.39"> filter.decryptMove2.label=Decrypt permanently (OpenPGP)</span>
<a href="#l9.40"></a><span id="l9.40"> filter.decryptCopy2.label=Create decrypted Copy (OpenPGP)</span>
<a href="#l9.41"></a><span id="l9.41"> filter.decryptMove.warnExperimental=Warning - the filter action &quot;Decrypt permanently&quot; may lead to destroyed messages.\n\nWe strongly recommend that you first try the &quot;Create decrypted Copy&quot; filter, test the result carefully, and only start using this filter once you are satisified with the result.</span>
<a href="#l9.42"></a><span id="l9.42"> filter.term.pgpencrypted.label=OpenPGP Encrypted</span>
<a href="#l9.43"></a><span id="l9.43"> filter.encrypt2.label=Encrypt to key (OpenPGP)</span>
<a href="#l9.44"></a><span id="l9.44"> filter.keyRequired=You must select a recipient key.</span>
<a href="#l9.45"></a><span id="l9.45"> filter.keyNotFound=Could not find an encryption key for '%S'.</span>
<a href="#l9.46"></a><span id="l9.46"> filter.warn.keyNotSecret=Warning - the filter action &quot;Encrypt to key&quot; replaces the recipients.\n\nIf you do not have the secret key for '%S' you will no longer be able to read the emails.</span>
<a href="#l9.47"></a><span id="l9.47"> </span>
<a href="#l9.48"></a><span id="l9.48" class="difflineminus">-# strings in enigmailConvert.jsm</span>
<a href="#l9.49"></a><span id="l9.49" class="difflineminus">-converter.decryptBody.failed=Could not decrypt message with subject\n'%S'.\nDo you want to retry with a different passphrase or do you want to skip the message?</span>
<a href="#l9.50"></a><span id="l9.50"> ### converter.decryptAtt.failed=Could not decrypt attachment '%1$S'\nof message with subject\n'%2$S'.\nDo you want to retry with a different passphrase or do you want to skip the message?</span>
<a href="#l9.51"></a><span id="l9.51"> </span>
<a href="#l9.52"></a><span id="l9.52"> ### saveLogFile.title=Save Log File</span>
<a href="#l9.53"></a><span id="l9.53"> </span>
<a href="#l9.54"></a><span id="l9.54" class="difflineminus">-# strings in gpg.jsm</span>
<a href="#l9.55"></a><span id="l9.55" class="difflineminus">-unknownSigningAlg=Unknown signing algorithm (ID: %S)</span>
<a href="#l9.56"></a><span id="l9.56" class="difflineminus">-unknownHashAlg=Unknown cryptographic hash (ID: %S)</span>
<a href="#l9.57"></a><span id="l9.57" class="difflineminus">-</span>
<a href="#l9.58"></a><span id="l9.58"> # strings in keyRing.jsm</span>
<a href="#l9.59"></a><span id="l9.59"> keyring.photo=Photo</span>
<a href="#l9.60"></a><span id="l9.60"> keyRing.pubKeyRevoked=The key %1$S (key ID %2$S) is revoked.</span>
<a href="#l9.61"></a><span id="l9.61"> keyRing.pubKeyExpired=The key %1$S (key ID %2$S) has expired.</span>
<a href="#l9.62"></a><span id="l9.62"> keyRing.pubKeyNotForSigning=The key %1$S (key ID %2$S) cannot be used for signing.</span>
<a href="#l9.63"></a><span id="l9.63"> keyRing.pubKeyNotForEncryption=The key %1$S (key ID %2$S) cannot be used for encryption.</span>
<a href="#l9.64"></a><span id="l9.64"> keyRing.keyDisabled=The key %1$S (key ID %2$S) is disabled; it cannot be used.</span>
<a href="#l9.65"></a><span id="l9.65"> keyRing.keyNotTrusted=The key %1$S (key ID %2$S) is not trusted enough. Please set the trust level of your key to &quot;ultimate&quot; to use it for signing.</span>
<a href="#l9.66"></a><span id="l9.66" class="difflineat">@@ -531,41 +524,28 @@ keyRing.keyInvalid2=The key %1$S (key ID</span>
<a href="#l9.67"></a><span id="l9.67"> keyRing.signSubKeysRevoked=All signing-subkeys of key %1$S (key ID %2$S) are revoked.</span>
<a href="#l9.68"></a><span id="l9.68"> keyRing.signSubKeysExpired=All signing-subkeys of key %1$S (key ID %2$S) have expired.</span>
<a href="#l9.69"></a><span id="l9.69"> keyRing.signSubKeysUnusable=All signing-subkeys of key %1$S (key ID %2$S) are revoked, expired or otherwise unusable.</span>
<a href="#l9.70"></a><span id="l9.70"> keyRing.encSubKeysRevoked=All encryption subkeys of key %1$S (key ID %2$S) are revoked.</span>
<a href="#l9.71"></a><span id="l9.71"> keyRing.encSubKeysExpired=All encryption subkeys of key %1$S (key ID %2$S) have expired.</span>
<a href="#l9.72"></a><span id="l9.72"> keyRing.noSecretKey=You do not seem to have the secret key for %1$S (key ID %2$S) on your keyring; you cannot use the key for signing.</span>
<a href="#l9.73"></a><span id="l9.73"> keyRing.encSubKeysUnusable=All encryption subkeys of key %1$S (key ID %2$S) are revoked, expired or otherwise unusable.</span>
<a href="#l9.74"></a><span id="l9.74"> </span>
<a href="#l9.75"></a><span id="l9.75" class="difflineminus">-</span>
<a href="#l9.76"></a><span id="l9.76"> #strings in exportSettingsWizard.js</span>
<a href="#l9.77"></a><span id="l9.77"> ### cannotWriteToFile=Cannot save to file '%S'. Please select a different file.</span>
<a href="#l9.78"></a><span id="l9.78"> ### dataExportError=An error occurred during exporting your data.</span>
<a href="#l9.79"></a><span id="l9.79"> ### specifyExportFile=Specify file name for exporting</span>
<a href="#l9.80"></a><span id="l9.80"> ### homedirParamNotSUpported=Additional parameters that configure paths such as --homedir and --keyring are not supported for exporting/restoring your settings. Please use alternative methods such as setting the environment variable GNUPGHOME.</span>
<a href="#l9.81"></a><span id="l9.81"> </span>
<a href="#l9.82"></a><span id="l9.82" class="difflineminus">-#strings in expiry.jsm</span>
<a href="#l9.83"></a><span id="l9.83" class="difflineminus">-expiry.keyExpiresSoon=Your key %1$S will expire in less than %2$S days.\n\nWe recommend that you create a new key pair and configure the corresponding accounts to use it.</span>
<a href="#l9.84"></a><span id="l9.84" class="difflineminus">-expiry.keysExpireSoon=Your following keys will expire in less than %1$S days:\n%2$S. We recommend that you create new keys and configure the corresponding accounts to use them.</span>
<a href="#l9.85"></a><span id="l9.85" class="difflineminus">-expiry.keyMissingOwnerTrust=Your secret key %S has missing trust.\n\nWe recommend that you set &quot;You rely on certifications&quot; to &quot;ultimate&quot; in key properties.</span>
<a href="#l9.86"></a><span id="l9.86" class="difflineminus">-expiry.keysMissingOwnerTrust=The following of your secret keys have missing trust.\n%S.\nWe recommend that you set &quot;You rely on certifications&quot; to &quot;ultimate&quot; in key properties.</span>
<a href="#l9.87"></a><span id="l9.87" class="difflineminus">-expiry.OpenKeyManager2=Open OpenPGP Key Management</span>
<a href="#l9.88"></a><span id="l9.88" class="difflineminus">-expiry.OpenKeyProperties=Open Key Properties</span>
<a href="#l9.89"></a><span id="l9.89" class="difflineminus">-</span>
<a href="#l9.90"></a><span id="l9.90"> #strings in gpgAgent.jsm</span>
<a href="#l9.91"></a><span id="l9.91"> ### gpghomedir.notexists=The directory '%S' containing your OpenPGP keys does not exist and cannot be created.</span>
<a href="#l9.92"></a><span id="l9.92"> ### gpghomedir.notwritable=The directory '%S' containing your OpenPGP keys is not writable.</span>
<a href="#l9.93"></a><span id="l9.93"> ### gpghomedir.notdirectory=The directory '%S' containing your OpenPGP keys is a file instead of a directory.</span>
<a href="#l9.94"></a><span id="l9.94"> ### gpghomedir.notusable=Please fix the directory permissions or change the location of your GnuPG &quot;home&quot; directory. GnuPG cannot work correctly otherwise.</span>
<a href="#l9.95"></a><span id="l9.95"> </span>
<a href="#l9.96"></a><span id="l9.96" class="difflineminus">-#strings in mimeWkdHandler.jsm</span>
<a href="#l9.97"></a><span id="l9.97" class="difflineminus">-wkdMessage.body.req2=Your email provider processed your request to upload your public key to the OpenPGP Web Key Directory.\n\nPlease confirm to complete the publishing of your public key.</span>
<a href="#l9.98"></a><span id="l9.98" class="difflineminus">-wkdMessage.body.process=This is an email related to the automatic processing to upload your public key to the OpenPGP Web Key Directory.\n\nYou do not need to take any manual action at this point.</span>
<a href="#l9.99"></a><span id="l9.99" class="difflineminus">-</span>
<a href="#l9.100"></a><span id="l9.100"> ### handshakeDlg.button.initHandshake=Handshake...</span>
<a href="#l9.101"></a><span id="l9.101"> ### handshakeDlg.button.stopTrust=Stop Trusting</span>
<a href="#l9.102"></a><span id="l9.102"> ### handshakeDlg.button.reTrust=Stop Mistrusting</span>
<a href="#l9.103"></a><span id="l9.103"> ### handshakeDlg.label.outgoingMessage=Outgoing message</span>
<a href="#l9.104"></a><span id="l9.104"> ### handshakeDlg.label.incomingMessage=Incoming message</span>
<a href="#l9.105"></a><span id="l9.105"> ### handshakeDlg.error.noPeers=Cannot handshake without any correspondents.</span>
<a href="#l9.106"></a><span id="l9.106"> ### handshakeDlg.error.noProtection=Please enable protection in order to use the &quot;Handshake&quot; function.</span>
<a href="#l9.107"></a><span id="l9.107"> </span>
<a href="#l9.108"></a><span id="l9.108" class="difflineat">@@ -573,41 +553,24 @@ wkdMessage.body.process=This is an email</span>
<a href="#l9.109"></a><span id="l9.109"> ### enigmail.acSetupPasswd.descCopyPasswd=Please enter the setup code below on your other device to proceed with the setup.</span>
<a href="#l9.110"></a><span id="l9.110"> </span>
<a href="#l9.111"></a><span id="l9.111"> #strings in autocrypt.jsm</span>
<a href="#l9.112"></a><span id="l9.112"> </span>
<a href="#l9.113"></a><span id="l9.113"> ### autocrypt.setupMsg.subject=Autocrypt Setup Message</span>
<a href="#l9.114"></a><span id="l9.114"> ### autocrypt.setupMsg.msgBody=To set up your new device for Autocrypt, please follow the instuctions that should be presented by your new device.</span>
<a href="#l9.115"></a><span id="l9.115"> ### autocrypt.setupMsg.fileTxt=This is the Autocrypt setup file used to transfer settings and keys between clients. You can decrypt it using the setup code displayed on your old device, then import the key to your keyring.</span>
<a href="#l9.116"></a><span id="l9.116"> </span>
<a href="#l9.117"></a><span id="l9.117" class="difflineminus">-#strings in keyserver.jsm</span>
<a href="#l9.118"></a><span id="l9.118" class="difflineminus">-keyserver.error.aborted=Aborted</span>
<a href="#l9.119"></a><span id="l9.119" class="difflineminus">-keyserver.error.unknown=An unknown error occurred</span>
<a href="#l9.120"></a><span id="l9.120" class="difflineminus">-keyserver.error.serverError=The keyserver reported an error.</span>
<a href="#l9.121"></a><span id="l9.121" class="difflineminus">-keyserver.error.importError=Failed to import the downloaded key.</span>
<a href="#l9.122"></a><span id="l9.122" class="difflineminus">-keyserver.error.unavailable=The keyserver is not available.</span>
<a href="#l9.123"></a><span id="l9.123" class="difflineminus">-keyserver.error.securityError=The keyserver does not support encrypted access.</span>
<a href="#l9.124"></a><span id="l9.124" class="difflineminus">-keyserver.error.certificateError=The keyserver’s certificate is not valid.</span>
<a href="#l9.125"></a><span id="l9.125" class="difflineminus">-keyserver.error.unsupported2=The keyserver is not supported.</span>
<a href="#l9.126"></a><span id="l9.126" class="difflineminus">-</span>
<a href="#l9.127"></a><span id="l9.127" class="difflineminus">-#strings in mimeDecrypt.jsm</span>
<a href="#l9.128"></a><span id="l9.128" class="difflineminus">-mimeDecrypt.encryptedPart.attachmentLabel=Encrypted message part</span>
<a href="#l9.129"></a><span id="l9.129" class="difflineminus">-mimeDecrypt.encryptedPart.concealedData=This is an encrypted message part. You need to open it in a separate window by clicking on the attachment.</span>
<a href="#l9.130"></a><span id="l9.130" class="difflineminus">-</span>
<a href="#l9.131"></a><span id="l9.131"> #strings in gnupg-key.jsm</span>
<a href="#l9.132"></a><span id="l9.132"> ### import.secretKeyImportError=An error has occurred in GnuPG while importing secret keys. The import was not successful.</span>
<a href="#l9.133"></a><span id="l9.133"> </span>
<a href="#l9.134"></a><span id="l9.134"> #strings in importSettings.js</span>
<a href="#l9.135"></a><span id="l9.135"> ### importSettings.errorNoFile=The file you specified is not a regular file!</span>
<a href="#l9.136"></a><span id="l9.136"> ### importSettings.cancelWhileInProgress=Restoring is in progress. Do you really want to abort the process?</span>
<a href="#l9.137"></a><span id="l9.137"> ### importSettings.button.abortImport=&amp;Abort process</span>
<a href="#l9.138"></a><span id="l9.138"> </span>
<a href="#l9.139"></a><span id="l9.139" class="difflineminus">-cannotUseOwnKeyBecause=Unable to send the message, because there is a problem with your personal key. %S</span>
<a href="#l9.140"></a><span id="l9.140" class="difflineminus">-cannotEncryptBecauseMissing=Unable to send this message with end-to-end encryption, because there are problems with the keys of the following recipients: %S</span>
<a href="#l9.141"></a><span id="l9.141" class="difflineminus">-</span>
<a href="#l9.142"></a><span id="l9.142"> </span>
<a href="#l9.143"></a><span id="l9.143"> </span>
<a href="#l9.144"></a><span id="l9.144"> </span>
<a href="#l9.145"></a><span id="l9.145"> fileToBigToImport=This file is too big. Please don't import a large set of keys at once.</span>
<a href="#l9.146"></a><span id="l9.146"> cannotSendSigBecauseNoOwnKey=Cannot digitally sign this message, because you haven't yet configured end-to-end encryption for &lt;%S&gt;</span>
<a href="#l9.147"></a><span id="l9.147"> cannotSendEncBecauseNoOwnKey=Cannot send this message encrypted, because you haven't yet configured end-to-end encryption for &lt;%S&gt;</span>
<a href="#l9.148"></a><span id="l9.148"> </span>
<a href="#l9.149"></a><span id="l9.149"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mail/extensions/openpgp/content/ui/enigmailMsgComposeOverlay.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/ui/enigmailMsgComposeOverlay.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -2231,20 +2231,22 @@ Enigmail.msg = {</span>
<a href="#l10.4"></a><span id="l10.4">     }</span>
<a href="#l10.5"></a><span id="l10.5"> </span>
<a href="#l10.6"></a><span id="l10.6">     if (senderKeyId) {</span>
<a href="#l10.7"></a><span id="l10.7">       let senderKeyUsable = EnigmailEncryption.determineOwnKeyUsability(</span>
<a href="#l10.8"></a><span id="l10.8">         sendFlags,</span>
<a href="#l10.9"></a><span id="l10.9">         senderKeyId</span>
<a href="#l10.10"></a><span id="l10.10">       );</span>
<a href="#l10.11"></a><span id="l10.11">       if (senderKeyUsable.errorMsg) {</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-        let fullAlert = EnigmailLocale.getString(&quot;cannotUseOwnKeyBecause&quot;, [</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-          senderKeyUsable.errorMsg,</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineminus">-        ]);</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineminus">-</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineplus">+        let fullAlert = await document.l10n.formatValue(</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineplus">+          &quot;cannot-use-own-key-because&quot;,</span>
<a href="#l10.18"></a><span id="l10.18" class="difflineplus">+          {</span>
<a href="#l10.19"></a><span id="l10.19" class="difflineplus">+            problem: senderKeyUsable.errorMsg,</span>
<a href="#l10.20"></a><span id="l10.20" class="difflineplus">+          }</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineplus">+        );</span>
<a href="#l10.22"></a><span id="l10.22">         EnigmailDialog.alert(window, fullAlert);</span>
<a href="#l10.23"></a><span id="l10.23">         return false;</span>
<a href="#l10.24"></a><span id="l10.24">       }</span>
<a href="#l10.25"></a><span id="l10.25">     }</span>
<a href="#l10.26"></a><span id="l10.26"> </span>
<a href="#l10.27"></a><span id="l10.27">     if (gSendEncrypted) {</span>
<a href="#l10.28"></a><span id="l10.28">       let canEncryptDetails = await this.determineSendFlags();</span>
<a href="#l10.29"></a><span id="l10.29">       if (canEncryptDetails.errArray.length != 0) {</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineat">@@ -2254,19 +2256,21 @@ Enigmail.msg = {</span>
<a href="#l10.31"></a><span id="l10.31">           if (isFirst) {</span>
<a href="#l10.32"></a><span id="l10.32">             isFirst = false;</span>
<a href="#l10.33"></a><span id="l10.33">           } else {</span>
<a href="#l10.34"></a><span id="l10.34">             allProblems += &quot;, &quot;;</span>
<a href="#l10.35"></a><span id="l10.35">           }</span>
<a href="#l10.36"></a><span id="l10.36">           allProblems += obj.addr;</span>
<a href="#l10.37"></a><span id="l10.37">         }</span>
<a href="#l10.38"></a><span id="l10.38"> </span>
<a href="#l10.39"></a><span id="l10.39" class="difflineminus">-        let fullAlert = EnigmailLocale.getString(</span>
<a href="#l10.40"></a><span id="l10.40" class="difflineminus">-          &quot;cannotEncryptBecauseMissing&quot;,</span>
<a href="#l10.41"></a><span id="l10.41" class="difflineminus">-          [allProblems]</span>
<a href="#l10.42"></a><span id="l10.42" class="difflineplus">+        let fullAlert = await document.l10n.formatValue(</span>
<a href="#l10.43"></a><span id="l10.43" class="difflineplus">+          &quot;cannot-encrypt-because-missing&quot;,</span>
<a href="#l10.44"></a><span id="l10.44" class="difflineplus">+          {</span>
<a href="#l10.45"></a><span id="l10.45" class="difflineplus">+            problem: allProblems,</span>
<a href="#l10.46"></a><span id="l10.46" class="difflineplus">+          }</span>
<a href="#l10.47"></a><span id="l10.47">         );</span>
<a href="#l10.48"></a><span id="l10.48"> </span>
<a href="#l10.49"></a><span id="l10.49">         EnigmailDialog.alert(window, fullAlert);</span>
<a href="#l10.50"></a><span id="l10.50">         showMessageComposeSecurityStatus();</span>
<a href="#l10.51"></a><span id="l10.51">         return false;</span>
<a href="#l10.52"></a><span id="l10.52">       }</span>
<a href="#l10.53"></a><span id="l10.53">     }</span>
<a href="#l10.54"></a><span id="l10.54"> </span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:33Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

