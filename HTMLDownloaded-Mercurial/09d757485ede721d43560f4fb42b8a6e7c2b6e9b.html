<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 26275:09d757485ede721d43560f4fb42b8a6e7c2b6e9b</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 09d757485ede721d43560f4fb42b8a6e7c2b6e9b" />
<meta property="og:url" content="/comm-central/rev/09d757485ede721d43560f4fb42b8a6e7c2b6e9b" />
<meta property="og:description" content="Bug 1542666 - Turn on ESLint in editor (manual changes); r=aceman" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 09d757485ede721d43560f4fb42b8a6e7c2b6e9b 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/09d757485ede721d43560f4fb42b8a6e7c2b6e9b">shortlog</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/09d757485ede721d43560f4fb42b8a6e7c2b6e9b">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b">files</a> |
changeset |
<a href="/comm-central/raw-rev/09d757485ede721d43560f4fb42b8a6e7c2b6e9b">raw</a>  | <a href="/comm-central/archive/09d757485ede721d43560f4fb42b8a6e7c2b6e9b.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1542666">Bug 1542666</a> - Turn on ESLint in editor (manual changes); r=aceman
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#71;&#101;&#111;&#102;&#102;&#32;&#76;&#97;&#110;&#107;&#111;&#119;&#32;&#60;&#103;&#101;&#111;&#102;&#102;&#64;&#100;&#97;&#114;&#107;&#116;&#114;&#111;&#106;&#97;&#110;&#46;&#110;&#101;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 09 Apr 2019 11:57:14 +1200</td></tr>

<tr>
 <td>changeset 26275</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/09d757485ede721d43560f4fb42b8a6e7c2b6e9b">09d757485ede721d43560f4fb42b8a6e7c2b6e9b</a></td>
</tr>



<tr>
<td>parent 26274</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/2f1b233c4f65d26b0dc3ff3236758b73759cc25a">2f1b233c4f65d26b0dc3ff3236758b73759cc25a</a>
</td>
</tr>

<tr>
<td>child 26276</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/f6f2323f61c7687a1de727497980baf3686a4e88">f6f2323f61c7687a1de727497980baf3686a4e88</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=09d757485ede721d43560f4fb42b8a6e7c2b6e9b">15765</a></td></tr>
<tr><td>push user</td><td>geoff@darktrojan.net</td></tr>
<tr><td>push date</td><td class="date age">Mon, 08 Apr 2019 23:57:59 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@09d757485ede [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=09d757485ede721d43560f4fb42b8a6e7c2b6e9b">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=09d757485ede721d43560f4fb42b8a6e7c2b6e9b&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=09d757485ede721d43560f4fb42b8a6e7c2b6e9b&newProject=comm-central&newRevision=2f1b233c4f65d26b0dc3ff3236758b73759cc25a&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=09d757485ede721d43560f4fb42b8a6e7c2b6e9b&newProject=comm-central&newRevision=2f1b233c4f65d26b0dc3ff3236758b73759cc25a&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=09d757485ede721d43560f4fb42b8a6e7c2b6e9b&newProject=comm-central&newRevision=2f1b233c4f65d26b0dc3ff3236758b73759cc25a&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28aceman%29&revcount=50">aceman</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1542666">1542666</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1542666">Bug 1542666</a> - Turn on ESLint in editor (manual changes); r=aceman</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/ComposerCommands.js">editor/ui/composer/content/ComposerCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/ComposerCommands.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/ComposerCommands.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/ComposerCommands.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/ComposerCommands.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/ComposerCommands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/editor.js">editor/ui/composer/content/editor.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/editor.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/editor.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/editor.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/editor.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/editor.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/editorUtilities.js">editor/ui/composer/content/editorUtilities.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/editorUtilities.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/editorUtilities.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/editorUtilities.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/editorUtilities.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/composer/content/editorUtilities.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEAttributes.js">editor/ui/dialogs/content/EdAEAttributes.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEAttributes.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEAttributes.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEAttributes.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEAttributes.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEAttributes.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAECSSAttributes.js">editor/ui/dialogs/content/EdAECSSAttributes.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAECSSAttributes.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAECSSAttributes.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAECSSAttributes.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAECSSAttributes.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAECSSAttributes.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEHTMLAttributes.js">editor/ui/dialogs/content/EdAEHTMLAttributes.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEHTMLAttributes.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEHTMLAttributes.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEHTMLAttributes.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEHTMLAttributes.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEHTMLAttributes.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEJSEAttributes.js">editor/ui/dialogs/content/EdAEJSEAttributes.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEJSEAttributes.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEJSEAttributes.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEJSEAttributes.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEJSEAttributes.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAEJSEAttributes.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAdvancedEdit.js">editor/ui/dialogs/content/EdAdvancedEdit.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAdvancedEdit.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAdvancedEdit.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAdvancedEdit.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAdvancedEdit.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdAdvancedEdit.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdButtonProps.js">editor/ui/dialogs/content/EdButtonProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdButtonProps.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdButtonProps.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdButtonProps.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdButtonProps.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdButtonProps.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdColorPicker.js">editor/ui/dialogs/content/EdColorPicker.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdColorPicker.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdColorPicker.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdColorPicker.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdColorPicker.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdColorPicker.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdColorProps.js">editor/ui/dialogs/content/EdColorProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdColorProps.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdColorProps.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdColorProps.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdColorProps.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdColorProps.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdConvertToTable.js">editor/ui/dialogs/content/EdConvertToTable.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdConvertToTable.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdConvertToTable.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdConvertToTable.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdConvertToTable.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdConvertToTable.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDialogCommon.js">editor/ui/dialogs/content/EdDialogCommon.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDialogCommon.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDialogCommon.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDialogCommon.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDialogCommon.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDialogCommon.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDialogTemplate.js">editor/ui/dialogs/content/EdDialogTemplate.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDialogTemplate.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDialogTemplate.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDialogTemplate.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDialogTemplate.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDialogTemplate.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDictionary.js">editor/ui/dialogs/content/EdDictionary.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDictionary.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDictionary.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDictionary.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDictionary.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdDictionary.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdFieldSetProps.js">editor/ui/dialogs/content/EdFieldSetProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdFieldSetProps.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdFieldSetProps.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdFieldSetProps.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdFieldSetProps.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdFieldSetProps.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdFormProps.js">editor/ui/dialogs/content/EdFormProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdFormProps.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdFormProps.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdFormProps.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdFormProps.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdFormProps.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdHLineProps.js">editor/ui/dialogs/content/EdHLineProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdHLineProps.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdHLineProps.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdHLineProps.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdHLineProps.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdHLineProps.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageDialog.js">editor/ui/dialogs/content/EdImageDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageDialog.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageDialog.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageDialog.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageDialog.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageDialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageLinkLoader.js">editor/ui/dialogs/content/EdImageLinkLoader.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageLinkLoader.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageLinkLoader.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageLinkLoader.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageLinkLoader.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageLinkLoader.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageProps.js">editor/ui/dialogs/content/EdImageProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageProps.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageProps.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageProps.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageProps.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdImageProps.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInputImage.js">editor/ui/dialogs/content/EdInputImage.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInputImage.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInputImage.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInputImage.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInputImage.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInputImage.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInputProps.js">editor/ui/dialogs/content/EdInputProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInputProps.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInputProps.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInputProps.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInputProps.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInputProps.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsSrc.js">editor/ui/dialogs/content/EdInsSrc.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsSrc.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsSrc.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsSrc.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsSrc.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsSrc.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertChars.js">editor/ui/dialogs/content/EdInsertChars.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertChars.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertChars.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertChars.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertChars.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertChars.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertMath.js">editor/ui/dialogs/content/EdInsertMath.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertMath.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertMath.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertMath.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertMath.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertMath.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertTOC.js">editor/ui/dialogs/content/EdInsertTOC.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertTOC.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertTOC.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertTOC.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertTOC.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertTOC.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertTable.js">editor/ui/dialogs/content/EdInsertTable.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertTable.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertTable.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertTable.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertTable.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdInsertTable.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdLabelProps.js">editor/ui/dialogs/content/EdLabelProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdLabelProps.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdLabelProps.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdLabelProps.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdLabelProps.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdLabelProps.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdLinkProps.js">editor/ui/dialogs/content/EdLinkProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdLinkProps.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdLinkProps.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdLinkProps.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdLinkProps.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdLinkProps.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdListProps.js">editor/ui/dialogs/content/EdListProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdListProps.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdListProps.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdListProps.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdListProps.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdListProps.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdNamedAnchorProps.js">editor/ui/dialogs/content/EdNamedAnchorProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdNamedAnchorProps.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdNamedAnchorProps.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdNamedAnchorProps.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdNamedAnchorProps.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdNamedAnchorProps.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdPageProps.js">editor/ui/dialogs/content/EdPageProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdPageProps.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdPageProps.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdPageProps.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdPageProps.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdPageProps.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdReplace.js">editor/ui/dialogs/content/EdReplace.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdReplace.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdReplace.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdReplace.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdReplace.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdReplace.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdSelectProps.js">editor/ui/dialogs/content/EdSelectProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdSelectProps.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdSelectProps.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdSelectProps.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdSelectProps.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdSelectProps.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdSpellCheck.js">editor/ui/dialogs/content/EdSpellCheck.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdSpellCheck.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdSpellCheck.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdSpellCheck.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdSpellCheck.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdSpellCheck.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTableProps.js">editor/ui/dialogs/content/EdTableProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTableProps.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTableProps.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTableProps.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTableProps.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTableProps.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTableProps.xul">editor/ui/dialogs/content/EdTableProps.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTableProps.xul">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTableProps.xul">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTableProps.xul">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTableProps.xul">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTableProps.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTextAreaProps.js">editor/ui/dialogs/content/EdTextAreaProps.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTextAreaProps.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTextAreaProps.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTextAreaProps.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTextAreaProps.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTextAreaProps.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTextAreaProps.xul">editor/ui/dialogs/content/EdTextAreaProps.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTextAreaProps.xul">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTextAreaProps.xul">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTextAreaProps.xul">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTextAreaProps.xul">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/dialogs/content/EdTextAreaProps.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/nsComposerCmdLineHandler.js">editor/ui/nsComposerCmdLineHandler.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/nsComposerCmdLineHandler.js">file</a> |
<a href="/comm-central/annotate/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/nsComposerCmdLineHandler.js">annotate</a> |
<a href="/comm-central/diff/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/nsComposerCmdLineHandler.js">diff</a> |
<a href="/comm-central/comparison/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/nsComposerCmdLineHandler.js">comparison</a> |
<a href="/comm-central/log/09d757485ede721d43560f4fb42b8a6e7c2b6e9b/editor/ui/nsComposerCmdLineHandler.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/editor/ui/composer/content/ComposerCommands.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/editor/ui/composer/content/ComposerCommands.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -1,19 +1,23 @@</span>
<a href="#l1.4"></a><span id="l1.4"> /* -*- Mode: Java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l1.5"></a><span id="l1.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l1.6"></a><span id="l1.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l1.7"></a><span id="l1.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l1.8"></a><span id="l1.8"> </span>
<a href="#l1.9"></a><span id="l1.9"> /* Implementations of nsIControllerCommand for composer commands */</span>
<a href="#l1.10"></a><span id="l1.10"> </span>
<a href="#l1.11"></a><span id="l1.11" class="difflineplus">+// Linting is disabled in chunks of this file because it contains code that never</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+// runs in Thunderbird, and references things that don't exist in Thunderbird.</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+/* import-globals-from editor.js */</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineplus">+/* import-globals-from editorUtilities.js */</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineplus">+</span>
<a href="#l1.17"></a><span id="l1.17"> var gComposerJSCommandControllerID = 0;</span>
<a href="#l1.18"></a><span id="l1.18"> </span>
<a href="#l1.19"></a><span id="l1.19" class="difflineminus">-</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.21"></a><span id="l1.21"> function SetupHTMLEditorCommands() {</span>
<a href="#l1.22"></a><span id="l1.22">   var commandTable = GetComposerCommandTable();</span>
<a href="#l1.23"></a><span id="l1.23">   if (!commandTable)</span>
<a href="#l1.24"></a><span id="l1.24">     return;</span>
<a href="#l1.25"></a><span id="l1.25"> </span>
<a href="#l1.26"></a><span id="l1.26">   // Include everything a text editor does</span>
<a href="#l1.27"></a><span id="l1.27">   SetupTextEditorCommands();</span>
<a href="#l1.28"></a><span id="l1.28"> </span>
<a href="#l1.29"></a><span id="l1.29" class="difflineat">@@ -166,17 +170,16 @@ function SetupComposerWindowCommands() {</span>
<a href="#l1.30"></a><span id="l1.30">   }</span>
<a href="#l1.31"></a><span id="l1.31"> </span>
<a href="#l1.32"></a><span id="l1.32">   windowControllers.insertControllerAt(0, editorController);</span>
<a href="#l1.33"></a><span id="l1.33"> </span>
<a href="#l1.34"></a><span id="l1.34">   // Store the controller ID so we can be sure to get the right one later</span>
<a href="#l1.35"></a><span id="l1.35">   gComposerWindowControllerID = windowControllers.getControllerId(editorController);</span>
<a href="#l1.36"></a><span id="l1.36"> }</span>
<a href="#l1.37"></a><span id="l1.37"> </span>
<a href="#l1.38"></a><span id="l1.38" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.39"></a><span id="l1.39"> function GetComposerCommandTable() {</span>
<a href="#l1.40"></a><span id="l1.40">   var controller;</span>
<a href="#l1.41"></a><span id="l1.41">   if (gComposerJSCommandControllerID) {</span>
<a href="#l1.42"></a><span id="l1.42">     try {</span>
<a href="#l1.43"></a><span id="l1.43">       controller = window.content.controllers.getControllerById(gComposerJSCommandControllerID);</span>
<a href="#l1.44"></a><span id="l1.44">     } catch (e) {}</span>
<a href="#l1.45"></a><span id="l1.45">   }</span>
<a href="#l1.46"></a><span id="l1.46">   if (!controller) {</span>
<a href="#l1.47"></a><span id="l1.47" class="difflineat">@@ -193,17 +196,17 @@ function GetComposerCommandTable() {</span>
<a href="#l1.48"></a><span id="l1.48"> </span>
<a href="#l1.49"></a><span id="l1.49">   if (controller) {</span>
<a href="#l1.50"></a><span id="l1.50">     var interfaceRequestor = controller.QueryInterface(Ci.nsIInterfaceRequestor);</span>
<a href="#l1.51"></a><span id="l1.51">     return interfaceRequestor.getInterface(Ci.nsIControllerCommandTable);</span>
<a href="#l1.52"></a><span id="l1.52">   }</span>
<a href="#l1.53"></a><span id="l1.53">   return null;</span>
<a href="#l1.54"></a><span id="l1.54"> }</span>
<a href="#l1.55"></a><span id="l1.55"> </span>
<a href="#l1.56"></a><span id="l1.56" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.57"></a><span id="l1.57" class="difflineplus">+/* eslint-disable complexity */</span>
<a href="#l1.58"></a><span id="l1.58"> function goUpdateCommandState(command) {</span>
<a href="#l1.59"></a><span id="l1.59">   try {</span>
<a href="#l1.60"></a><span id="l1.60">     var controller = top.document.commandDispatcher.getControllerForCommand(command);</span>
<a href="#l1.61"></a><span id="l1.61">     if (!(controller instanceof Ci.nsICommandController))</span>
<a href="#l1.62"></a><span id="l1.62">       return;</span>
<a href="#l1.63"></a><span id="l1.63"> </span>
<a href="#l1.64"></a><span id="l1.64">     var params = newCommandParams();</span>
<a href="#l1.65"></a><span id="l1.65">     if (!params) return;</span>
<a href="#l1.66"></a><span id="l1.66" class="difflineat">@@ -252,34 +255,36 @@ function goUpdateCommandState(command) {</span>
<a href="#l1.67"></a><span id="l1.67">       case &quot;cmd_increaseFontStep&quot;:</span>
<a href="#l1.68"></a><span id="l1.68">       case &quot;cmd_decreaseFontStep&quot;:</span>
<a href="#l1.69"></a><span id="l1.69">       case &quot;cmd_removeStyles&quot;:</span>
<a href="#l1.70"></a><span id="l1.70">       case &quot;cmd_smiley&quot;:</span>
<a href="#l1.71"></a><span id="l1.71">         break;</span>
<a href="#l1.72"></a><span id="l1.72"> </span>
<a href="#l1.73"></a><span id="l1.73">       default: dump(&quot;no update for command: &quot; + command + &quot;\n&quot;);</span>
<a href="#l1.74"></a><span id="l1.74">     }</span>
<a href="#l1.75"></a><span id="l1.75" class="difflineminus">-  } catch (e) { dump(&quot;An error occurred updating the &quot; + command + &quot; command: \n&quot; + e + &quot;\n&quot;); }</span>
<a href="#l1.76"></a><span id="l1.76" class="difflineplus">+  } catch (e) {</span>
<a href="#l1.77"></a><span id="l1.77" class="difflineplus">+    dump(&quot;An error occurred updating the &quot; + command + &quot; command: \n&quot; + e + &quot;\n&quot;);</span>
<a href="#l1.78"></a><span id="l1.78" class="difflineplus">+  }</span>
<a href="#l1.79"></a><span id="l1.79"> }</span>
<a href="#l1.80"></a><span id="l1.80" class="difflineplus">+/* eslint-enable complexity */</span>
<a href="#l1.81"></a><span id="l1.81"> </span>
<a href="#l1.82"></a><span id="l1.82"> function goUpdateComposerMenuItems(commandset) {</span>
<a href="#l1.83"></a><span id="l1.83">   // dump(&quot;Updating commands for &quot; + commandset.id + &quot;\n&quot;);</span>
<a href="#l1.84"></a><span id="l1.84"> </span>
<a href="#l1.85"></a><span id="l1.85">   for (var i = 0; i &lt; commandset.childNodes.length; i++) {</span>
<a href="#l1.86"></a><span id="l1.86">     var commandNode = commandset.childNodes[i];</span>
<a href="#l1.87"></a><span id="l1.87">     var commandID = commandNode.id;</span>
<a href="#l1.88"></a><span id="l1.88">     if (commandID) {</span>
<a href="#l1.89"></a><span id="l1.89">       goUpdateCommand(commandID);  // enable or disable</span>
<a href="#l1.90"></a><span id="l1.90">       if (commandNode.hasAttribute(&quot;state&quot;))</span>
<a href="#l1.91"></a><span id="l1.91">         goUpdateCommandState(commandID);</span>
<a href="#l1.92"></a><span id="l1.92">     }</span>
<a href="#l1.93"></a><span id="l1.93">   }</span>
<a href="#l1.94"></a><span id="l1.94"> }</span>
<a href="#l1.95"></a><span id="l1.95"> </span>
<a href="#l1.96"></a><span id="l1.96" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.97"></a><span id="l1.97"> function goDoCommandParams(command, params) {</span>
<a href="#l1.98"></a><span id="l1.98">   try {</span>
<a href="#l1.99"></a><span id="l1.99">     var controller = top.document.commandDispatcher.getControllerForCommand(command);</span>
<a href="#l1.100"></a><span id="l1.100">     if (controller &amp;&amp; controller.isCommandEnabled(command)) {</span>
<a href="#l1.101"></a><span id="l1.101">       if (controller instanceof Ci.nsICommandController) {</span>
<a href="#l1.102"></a><span id="l1.102">         controller.doCommandWithParams(command, params);</span>
<a href="#l1.103"></a><span id="l1.103"> </span>
<a href="#l1.104"></a><span id="l1.104">         // the following two lines should be removed when we implement observers</span>
<a href="#l1.105"></a><span id="l1.105" class="difflineat">@@ -291,26 +296,28 @@ function goDoCommandParams(command, para</span>
<a href="#l1.106"></a><span id="l1.106">       ResetStructToolbar();</span>
<a href="#l1.107"></a><span id="l1.107">     }</span>
<a href="#l1.108"></a><span id="l1.108">   } catch (e) {</span>
<a href="#l1.109"></a><span id="l1.109">     dump(&quot;An error occurred executing the &quot; + command + &quot; command\n&quot;);</span>
<a href="#l1.110"></a><span id="l1.110">   }</span>
<a href="#l1.111"></a><span id="l1.111"> }</span>
<a href="#l1.112"></a><span id="l1.112"> </span>
<a href="#l1.113"></a><span id="l1.113"> function pokeStyleUI(uiID, aDesiredState) {</span>
<a href="#l1.114"></a><span id="l1.114" class="difflineminus">- try {</span>
<a href="#l1.115"></a><span id="l1.115" class="difflineminus">-  var commandNode = top.document.getElementById(uiID);</span>
<a href="#l1.116"></a><span id="l1.116" class="difflineminus">-  if (!commandNode)</span>
<a href="#l1.117"></a><span id="l1.117" class="difflineminus">-    return;</span>
<a href="#l1.118"></a><span id="l1.118" class="difflineminus">-</span>
<a href="#l1.119"></a><span id="l1.119" class="difflineminus">-  var uiState = (&quot;true&quot; == commandNode.getAttribute(&quot;state&quot;));</span>
<a href="#l1.120"></a><span id="l1.120" class="difflineminus">-  if (aDesiredState != uiState) {</span>
<a href="#l1.121"></a><span id="l1.121" class="difflineminus">-    commandNode.setAttribute(&quot;state&quot;, aDesiredState ? &quot;true&quot; : &quot;false&quot;);</span>
<a href="#l1.122"></a><span id="l1.122" class="difflineplus">+  try {</span>
<a href="#l1.123"></a><span id="l1.123" class="difflineplus">+    var commandNode = top.document.getElementById(uiID);</span>
<a href="#l1.124"></a><span id="l1.124" class="difflineplus">+    if (!commandNode)</span>
<a href="#l1.125"></a><span id="l1.125" class="difflineplus">+      return;</span>
<a href="#l1.126"></a><span id="l1.126" class="difflineplus">+</span>
<a href="#l1.127"></a><span id="l1.127" class="difflineplus">+    var uiState = (&quot;true&quot; == commandNode.getAttribute(&quot;state&quot;));</span>
<a href="#l1.128"></a><span id="l1.128" class="difflineplus">+    if (aDesiredState != uiState) {</span>
<a href="#l1.129"></a><span id="l1.129" class="difflineplus">+      commandNode.setAttribute(&quot;state&quot;, aDesiredState ? &quot;true&quot; : &quot;false&quot;);</span>
<a href="#l1.130"></a><span id="l1.130" class="difflineplus">+    }</span>
<a href="#l1.131"></a><span id="l1.131" class="difflineplus">+  } catch (e) {</span>
<a href="#l1.132"></a><span id="l1.132" class="difflineplus">+    dump(&quot;poking UI for &quot; + uiID + &quot; failed: &quot; + e + &quot;\n&quot;);</span>
<a href="#l1.133"></a><span id="l1.133">   }</span>
<a href="#l1.134"></a><span id="l1.134" class="difflineminus">- } catch (e) { dump(&quot;poking UI for &quot; + uiID + &quot; failed: &quot; + e + &quot;\n&quot;); }</span>
<a href="#l1.135"></a><span id="l1.135"> }</span>
<a href="#l1.136"></a><span id="l1.136"> </span>
<a href="#l1.137"></a><span id="l1.137"> function doStyleUICommand(cmdStr) {</span>
<a href="#l1.138"></a><span id="l1.138">   try {</span>
<a href="#l1.139"></a><span id="l1.139">     var cmdParams = newCommandParams();</span>
<a href="#l1.140"></a><span id="l1.140">     goDoCommandParams(cmdStr, cmdParams);</span>
<a href="#l1.141"></a><span id="l1.141">     if (cmdParams)</span>
<a href="#l1.142"></a><span id="l1.142">       pokeStyleUI(cmdStr, cmdParams.getBooleanValue(&quot;state_all&quot;));</span>
<a href="#l1.143"></a><span id="l1.143" class="difflineat">@@ -331,19 +338,19 @@ function stringToTypedArray(buffer) {</span>
<a href="#l1.144"></a><span id="l1.144"> function pokeMultiStateUI(uiID, cmdParams) {</span>
<a href="#l1.145"></a><span id="l1.145">   try {</span>
<a href="#l1.146"></a><span id="l1.146">     var commandNode = document.getElementById(uiID);</span>
<a href="#l1.147"></a><span id="l1.147">     if (!commandNode)</span>
<a href="#l1.148"></a><span id="l1.148">       return;</span>
<a href="#l1.149"></a><span id="l1.149"> </span>
<a href="#l1.150"></a><span id="l1.150">     var isMixed = cmdParams.getBooleanValue(&quot;state_mixed&quot;);</span>
<a href="#l1.151"></a><span id="l1.151">     var desiredAttrib;</span>
<a href="#l1.152"></a><span id="l1.152" class="difflineminus">-    if (isMixed)</span>
<a href="#l1.153"></a><span id="l1.153" class="difflineplus">+    if (isMixed) {</span>
<a href="#l1.154"></a><span id="l1.154">       desiredAttrib = &quot;mixed&quot;;</span>
<a href="#l1.155"></a><span id="l1.155" class="difflineminus">-    else {</span>
<a href="#l1.156"></a><span id="l1.156" class="difflineplus">+    } else {</span>
<a href="#l1.157"></a><span id="l1.157">       var valuetype = cmdParams.getValueType(&quot;state_attribute&quot;);</span>
<a href="#l1.158"></a><span id="l1.158">       if (valuetype == Ci.nsICommandParams.eStringType) {</span>
<a href="#l1.159"></a><span id="l1.159">         desiredAttrib = cmdParams.getCStringValue(&quot;state_attribute&quot;);</span>
<a href="#l1.160"></a><span id="l1.160">         // Decode UTF-8, for example for font names in Japanese.</span>
<a href="#l1.161"></a><span id="l1.161">         desiredAttrib = new TextDecoder(&quot;UTF-8&quot;).decode(stringToTypedArray(desiredAttrib));</span>
<a href="#l1.162"></a><span id="l1.162">       } else {</span>
<a href="#l1.163"></a><span id="l1.163">         desiredAttrib = cmdParams.getStringValue(&quot;state_attribute&quot;);</span>
<a href="#l1.164"></a><span id="l1.164">       }</span>
<a href="#l1.165"></a><span id="l1.165" class="difflineat">@@ -367,60 +374,57 @@ function doStatefulCommand(commandID, ne</span>
<a href="#l1.166"></a><span id="l1.166">     if (!cmdParams) return;</span>
<a href="#l1.167"></a><span id="l1.167"> </span>
<a href="#l1.168"></a><span id="l1.168">     cmdParams.setStringValue(&quot;state_attribute&quot;, newState);</span>
<a href="#l1.169"></a><span id="l1.169">     goDoCommandParams(commandID, cmdParams);</span>
<a href="#l1.170"></a><span id="l1.170"> </span>
<a href="#l1.171"></a><span id="l1.171">     pokeMultiStateUI(commandID, cmdParams);</span>
<a href="#l1.172"></a><span id="l1.172"> </span>
<a href="#l1.173"></a><span id="l1.173">     ResetStructToolbar();</span>
<a href="#l1.174"></a><span id="l1.174" class="difflineminus">-  } catch (e) { dump(&quot;error thrown in doStatefulCommand: &quot; + e + &quot;\n&quot;); }</span>
<a href="#l1.175"></a><span id="l1.175" class="difflineplus">+  } catch (e) {</span>
<a href="#l1.176"></a><span id="l1.176" class="difflineplus">+    dump(&quot;error thrown in doStatefulCommand: &quot; + e + &quot;\n&quot;);</span>
<a href="#l1.177"></a><span id="l1.177" class="difflineplus">+  }</span>
<a href="#l1.178"></a><span id="l1.178"> }</span>
<a href="#l1.179"></a><span id="l1.179"> </span>
<a href="#l1.180"></a><span id="l1.180" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.181"></a><span id="l1.181"> function PrintObject(obj) {</span>
<a href="#l1.182"></a><span id="l1.182">   dump(&quot;-----&quot; + obj + &quot;------\n&quot;);</span>
<a href="#l1.183"></a><span id="l1.183">   var names = &quot;&quot;;</span>
<a href="#l1.184"></a><span id="l1.184">   for (var i in obj) {</span>
<a href="#l1.185"></a><span id="l1.185">     if (i == &quot;value&quot;)</span>
<a href="#l1.186"></a><span id="l1.186">       names += i + &quot;: &quot; + obj.value + &quot;\n&quot;;</span>
<a href="#l1.187"></a><span id="l1.187">     else if (i == &quot;id&quot;)</span>
<a href="#l1.188"></a><span id="l1.188">       names += i + &quot;: &quot; + obj.id + &quot;\n&quot;;</span>
<a href="#l1.189"></a><span id="l1.189">     else</span>
<a href="#l1.190"></a><span id="l1.190">       names += i + &quot;\n&quot;;</span>
<a href="#l1.191"></a><span id="l1.191">   }</span>
<a href="#l1.192"></a><span id="l1.192"> </span>
<a href="#l1.193"></a><span id="l1.193">   dump(names + &quot;-----------\n&quot;);</span>
<a href="#l1.194"></a><span id="l1.194"> }</span>
<a href="#l1.195"></a><span id="l1.195"> </span>
<a href="#l1.196"></a><span id="l1.196" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.197"></a><span id="l1.197"> function PrintNodeID(id) {</span>
<a href="#l1.198"></a><span id="l1.198">   PrintObject(document.getElementById(id));</span>
<a href="#l1.199"></a><span id="l1.199"> }</span>
<a href="#l1.200"></a><span id="l1.200"> </span>
<a href="#l1.201"></a><span id="l1.201" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.202"></a><span id="l1.202" class="difflineminus">-var nsDummyHTMLCommand =</span>
<a href="#l1.203"></a><span id="l1.203" class="difflineminus">-{</span>
<a href="#l1.204"></a><span id="l1.204" class="difflineplus">+var nsDummyHTMLCommand = {</span>
<a href="#l1.205"></a><span id="l1.205">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.206"></a><span id="l1.206">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.207"></a><span id="l1.207">   },</span>
<a href="#l1.208"></a><span id="l1.208"> </span>
<a href="#l1.209"></a><span id="l1.209">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.210"></a><span id="l1.210">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.211"></a><span id="l1.211"> </span>
<a href="#l1.212"></a><span id="l1.212">   doCommand(aCommand) {</span>
<a href="#l1.213"></a><span id="l1.213">     // do nothing</span>
<a href="#l1.214"></a><span id="l1.214">     dump(&quot;Hey, who's calling the dummy command?\n&quot;);</span>
<a href="#l1.215"></a><span id="l1.215">   },</span>
<a href="#l1.216"></a><span id="l1.216"> </span>
<a href="#l1.217"></a><span id="l1.217"> };</span>
<a href="#l1.218"></a><span id="l1.218"> </span>
<a href="#l1.219"></a><span id="l1.219" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.220"></a><span id="l1.220" class="difflineminus">-var nsOpenCommand =</span>
<a href="#l1.221"></a><span id="l1.221" class="difflineminus">-{</span>
<a href="#l1.222"></a><span id="l1.222" class="difflineplus">+/* eslint-disable */</span>
<a href="#l1.223"></a><span id="l1.223" class="difflineplus">+var nsOpenCommand = {</span>
<a href="#l1.224"></a><span id="l1.224">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.225"></a><span id="l1.225">     return true;    // we can always do this</span>
<a href="#l1.226"></a><span id="l1.226">   },</span>
<a href="#l1.227"></a><span id="l1.227"> </span>
<a href="#l1.228"></a><span id="l1.228">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.229"></a><span id="l1.229">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.230"></a><span id="l1.230"> </span>
<a href="#l1.231"></a><span id="l1.231">   doCommand(aCommand) {</span>
<a href="#l1.232"></a><span id="l1.232" class="difflineat">@@ -447,62 +451,61 @@ var nsOpenCommand =</span>
<a href="#l1.233"></a><span id="l1.233">       // editPage checks for already open window and activates it.</span>
<a href="#l1.234"></a><span id="l1.234">       if (fp.fileURL.spec) {</span>
<a href="#l1.235"></a><span id="l1.235">         SaveFilePickerDirectory(fp, fileType);</span>
<a href="#l1.236"></a><span id="l1.236">         editPage(fp.fileURL.spec, fileType);</span>
<a href="#l1.237"></a><span id="l1.237">       }</span>
<a href="#l1.238"></a><span id="l1.238">     });</span>
<a href="#l1.239"></a><span id="l1.239">   },</span>
<a href="#l1.240"></a><span id="l1.240"> };</span>
<a href="#l1.241"></a><span id="l1.241" class="difflineplus">+/* eslint-enable */</span>
<a href="#l1.242"></a><span id="l1.242"> </span>
<a href="#l1.243"></a><span id="l1.243"> // STRUCTURE TOOLBAR</span>
<a href="#l1.244"></a><span id="l1.244"> //</span>
<a href="#l1.245"></a><span id="l1.245" class="difflineminus">-var nsUpdateStructToolbarCommand =</span>
<a href="#l1.246"></a><span id="l1.246" class="difflineminus">-{</span>
<a href="#l1.247"></a><span id="l1.247" class="difflineplus">+var nsUpdateStructToolbarCommand = {</span>
<a href="#l1.248"></a><span id="l1.248">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.249"></a><span id="l1.249">     UpdateStructToolbar();</span>
<a href="#l1.250"></a><span id="l1.250">     return true;</span>
<a href="#l1.251"></a><span id="l1.251">   },</span>
<a href="#l1.252"></a><span id="l1.252"> </span>
<a href="#l1.253"></a><span id="l1.253">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.254"></a><span id="l1.254">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.255"></a><span id="l1.255">   doCommand(aCommand) {},</span>
<a href="#l1.256"></a><span id="l1.256"> };</span>
<a href="#l1.257"></a><span id="l1.257"> </span>
<a href="#l1.258"></a><span id="l1.258"> // ******* File output commands and utilities ******** //</span>
<a href="#l1.259"></a><span id="l1.259" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.260"></a><span id="l1.260" class="difflineminus">-var nsSaveCommand =</span>
<a href="#l1.261"></a><span id="l1.261" class="difflineminus">-{</span>
<a href="#l1.262"></a><span id="l1.262" class="difflineplus">+var nsSaveCommand = {</span>
<a href="#l1.263"></a><span id="l1.263">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.264"></a><span id="l1.264">     // Always allow saving when editing a remote document,</span>
<a href="#l1.265"></a><span id="l1.265">     //  otherwise the document modified state would prevent that</span>
<a href="#l1.266"></a><span id="l1.266">     //  when you first open a remote file.</span>
<a href="#l1.267"></a><span id="l1.267">     try {</span>
<a href="#l1.268"></a><span id="l1.268">       var docUrl = GetDocumentUrl();</span>
<a href="#l1.269"></a><span id="l1.269">       return IsDocumentEditable() &amp;&amp;</span>
<a href="#l1.270"></a><span id="l1.270">         (IsDocumentModified() || IsHTMLSourceChanged() ||</span>
<a href="#l1.271"></a><span id="l1.271">          IsUrlAboutBlank(docUrl) || GetScheme(docUrl) != &quot;file&quot;);</span>
<a href="#l1.272"></a><span id="l1.272" class="difflineminus">-    } catch (e) { return false; }</span>
<a href="#l1.273"></a><span id="l1.273" class="difflineplus">+    } catch (e) {</span>
<a href="#l1.274"></a><span id="l1.274" class="difflineplus">+      return false;</span>
<a href="#l1.275"></a><span id="l1.275" class="difflineplus">+    }</span>
<a href="#l1.276"></a><span id="l1.276">   },</span>
<a href="#l1.277"></a><span id="l1.277"> </span>
<a href="#l1.278"></a><span id="l1.278">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.279"></a><span id="l1.279">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.280"></a><span id="l1.280"> </span>
<a href="#l1.281"></a><span id="l1.281">   doCommand(aCommand) {</span>
<a href="#l1.282"></a><span id="l1.282">     var editor = GetCurrentEditor();</span>
<a href="#l1.283"></a><span id="l1.283">     if (editor) {</span>
<a href="#l1.284"></a><span id="l1.284">       if (IsHTMLEditor())</span>
<a href="#l1.285"></a><span id="l1.285">         SetEditMode(gPreviousNonSourceDisplayMode);</span>
<a href="#l1.286"></a><span id="l1.286">       SaveDocument(IsUrlAboutBlank(GetDocumentUrl()), false, editor.contentsMIMEType);</span>
<a href="#l1.287"></a><span id="l1.287">     }</span>
<a href="#l1.288"></a><span id="l1.288">   },</span>
<a href="#l1.289"></a><span id="l1.289"> };</span>
<a href="#l1.290"></a><span id="l1.290"> </span>
<a href="#l1.291"></a><span id="l1.291" class="difflineminus">-var nsSaveAsCommand =</span>
<a href="#l1.292"></a><span id="l1.292" class="difflineminus">-{</span>
<a href="#l1.293"></a><span id="l1.293" class="difflineplus">+var nsSaveAsCommand = {</span>
<a href="#l1.294"></a><span id="l1.294">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.295"></a><span id="l1.295">     return (IsDocumentEditable());</span>
<a href="#l1.296"></a><span id="l1.296">   },</span>
<a href="#l1.297"></a><span id="l1.297"> </span>
<a href="#l1.298"></a><span id="l1.298">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.299"></a><span id="l1.299">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.300"></a><span id="l1.300"> </span>
<a href="#l1.301"></a><span id="l1.301">   doCommand(aCommand) {</span>
<a href="#l1.302"></a><span id="l1.302" class="difflineat">@@ -510,35 +513,33 @@ var nsSaveAsCommand =</span>
<a href="#l1.303"></a><span id="l1.303">     if (editor) {</span>
<a href="#l1.304"></a><span id="l1.304">       if (IsHTMLEditor())</span>
<a href="#l1.305"></a><span id="l1.305">         SetEditMode(gPreviousNonSourceDisplayMode);</span>
<a href="#l1.306"></a><span id="l1.306">       SaveDocument(true, false, editor.contentsMIMEType);</span>
<a href="#l1.307"></a><span id="l1.307">     }</span>
<a href="#l1.308"></a><span id="l1.308">   },</span>
<a href="#l1.309"></a><span id="l1.309"> };</span>
<a href="#l1.310"></a><span id="l1.310"> </span>
<a href="#l1.311"></a><span id="l1.311" class="difflineminus">-var nsExportToTextCommand =</span>
<a href="#l1.312"></a><span id="l1.312" class="difflineminus">-{</span>
<a href="#l1.313"></a><span id="l1.313" class="difflineplus">+var nsExportToTextCommand = {</span>
<a href="#l1.314"></a><span id="l1.314">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.315"></a><span id="l1.315">     return (IsDocumentEditable());</span>
<a href="#l1.316"></a><span id="l1.316">   },</span>
<a href="#l1.317"></a><span id="l1.317"> </span>
<a href="#l1.318"></a><span id="l1.318">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.319"></a><span id="l1.319">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.320"></a><span id="l1.320"> </span>
<a href="#l1.321"></a><span id="l1.321">   doCommand(aCommand) {</span>
<a href="#l1.322"></a><span id="l1.322">     if (GetCurrentEditor()) {</span>
<a href="#l1.323"></a><span id="l1.323">       SetEditMode(gPreviousNonSourceDisplayMode);</span>
<a href="#l1.324"></a><span id="l1.324">       SaveDocument(true, true, &quot;text/plain&quot;);</span>
<a href="#l1.325"></a><span id="l1.325">     }</span>
<a href="#l1.326"></a><span id="l1.326">   },</span>
<a href="#l1.327"></a><span id="l1.327"> };</span>
<a href="#l1.328"></a><span id="l1.328"> </span>
<a href="#l1.329"></a><span id="l1.329" class="difflineminus">-var nsSaveAndChangeEncodingCommand =</span>
<a href="#l1.330"></a><span id="l1.330" class="difflineminus">-{</span>
<a href="#l1.331"></a><span id="l1.331" class="difflineplus">+var nsSaveAndChangeEncodingCommand = {</span>
<a href="#l1.332"></a><span id="l1.332">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.333"></a><span id="l1.333">     return (IsDocumentEditable());</span>
<a href="#l1.334"></a><span id="l1.334">   },</span>
<a href="#l1.335"></a><span id="l1.335"> </span>
<a href="#l1.336"></a><span id="l1.336">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.337"></a><span id="l1.337">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.338"></a><span id="l1.338"> </span>
<a href="#l1.339"></a><span id="l1.339">   doCommand(aCommand) {</span>
<a href="#l1.340"></a><span id="l1.340" class="difflineat">@@ -557,28 +558,30 @@ var nsSaveAndChangeEncodingCommand =</span>
<a href="#l1.341"></a><span id="l1.341">       } else {</span>
<a href="#l1.342"></a><span id="l1.342">         var editor = GetCurrentEditor();</span>
<a href="#l1.343"></a><span id="l1.343">         SaveDocument(true, false, editor ? editor.contentsMIMEType : null);</span>
<a href="#l1.344"></a><span id="l1.344">       }</span>
<a href="#l1.345"></a><span id="l1.345">     }</span>
<a href="#l1.346"></a><span id="l1.346">   },</span>
<a href="#l1.347"></a><span id="l1.347"> };</span>
<a href="#l1.348"></a><span id="l1.348"> </span>
<a href="#l1.349"></a><span id="l1.349" class="difflineminus">-var nsPublishCommand =</span>
<a href="#l1.350"></a><span id="l1.350" class="difflineminus">-{</span>
<a href="#l1.351"></a><span id="l1.351" class="difflineplus">+/* eslint-disable */</span>
<a href="#l1.352"></a><span id="l1.352" class="difflineplus">+var nsPublishCommand = {</span>
<a href="#l1.353"></a><span id="l1.353">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.354"></a><span id="l1.354">     if (IsDocumentEditable()) {</span>
<a href="#l1.355"></a><span id="l1.355">       // Always allow publishing when editing a local document,</span>
<a href="#l1.356"></a><span id="l1.356">       //  otherwise the document modified state would prevent that</span>
<a href="#l1.357"></a><span id="l1.357">       //  when you first open any local file.</span>
<a href="#l1.358"></a><span id="l1.358">       try {</span>
<a href="#l1.359"></a><span id="l1.359">         var docUrl = GetDocumentUrl();</span>
<a href="#l1.360"></a><span id="l1.360">         return IsDocumentModified() || IsHTMLSourceChanged()</span>
<a href="#l1.361"></a><span id="l1.361">                || IsUrlAboutBlank(docUrl) || GetScheme(docUrl) == &quot;file&quot;;</span>
<a href="#l1.362"></a><span id="l1.362" class="difflineminus">-      } catch (e) { return false; }</span>
<a href="#l1.363"></a><span id="l1.363" class="difflineplus">+      } catch (e) {</span>
<a href="#l1.364"></a><span id="l1.364" class="difflineplus">+        return false;</span>
<a href="#l1.365"></a><span id="l1.365" class="difflineplus">+      }</span>
<a href="#l1.366"></a><span id="l1.366">     }</span>
<a href="#l1.367"></a><span id="l1.367">     return false;</span>
<a href="#l1.368"></a><span id="l1.368">   },</span>
<a href="#l1.369"></a><span id="l1.369"> </span>
<a href="#l1.370"></a><span id="l1.370">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.371"></a><span id="l1.371">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.372"></a><span id="l1.372"> </span>
<a href="#l1.373"></a><span id="l1.373">   doCommand(aCommand) {</span>
<a href="#l1.374"></a><span id="l1.374" class="difflineat">@@ -615,19 +618,19 @@ var nsPublishCommand =</span>
<a href="#l1.375"></a><span id="l1.375">       if (publishData) {</span>
<a href="#l1.376"></a><span id="l1.376">         SetEditMode(gPreviousNonSourceDisplayMode);</span>
<a href="#l1.377"></a><span id="l1.377">         return Publish(publishData);</span>
<a href="#l1.378"></a><span id="l1.378">       }</span>
<a href="#l1.379"></a><span id="l1.379">     }</span>
<a href="#l1.380"></a><span id="l1.380">     return false;</span>
<a href="#l1.381"></a><span id="l1.381">   },</span>
<a href="#l1.382"></a><span id="l1.382"> };</span>
<a href="#l1.383"></a><span id="l1.383" class="difflineminus">-</span>
<a href="#l1.384"></a><span id="l1.384" class="difflineminus">-var nsPublishAsCommand =</span>
<a href="#l1.385"></a><span id="l1.385" class="difflineminus">-{</span>
<a href="#l1.386"></a><span id="l1.386" class="difflineplus">+/* eslint-enable */</span>
<a href="#l1.387"></a><span id="l1.387" class="difflineplus">+</span>
<a href="#l1.388"></a><span id="l1.388" class="difflineplus">+var nsPublishAsCommand = {</span>
<a href="#l1.389"></a><span id="l1.389">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.390"></a><span id="l1.390">     return (IsDocumentEditable());</span>
<a href="#l1.391"></a><span id="l1.391">   },</span>
<a href="#l1.392"></a><span id="l1.392"> </span>
<a href="#l1.393"></a><span id="l1.393">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.394"></a><span id="l1.394">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.395"></a><span id="l1.395"> </span>
<a href="#l1.396"></a><span id="l1.396">   doCommand(aCommand) {</span>
<a href="#l1.397"></a><span id="l1.397" class="difflineat">@@ -758,17 +761,17 @@ function PromptForSaveLocation(aDoSaveAs</span>
<a href="#l1.398"></a><span id="l1.398">       // Initialize to the last-used directory for the particular type (saved in prefs)</span>
<a href="#l1.399"></a><span id="l1.399">       SetFilePickerDirectory(fp, aEditorType);</span>
<a href="#l1.400"></a><span id="l1.400">     }</span>
<a href="#l1.401"></a><span id="l1.401">   } catch (e) {}</span>
<a href="#l1.402"></a><span id="l1.402"> </span>
<a href="#l1.403"></a><span id="l1.403">   return new Promise(resolve =&gt; {</span>
<a href="#l1.404"></a><span id="l1.404">     fp.open(rv =&gt; {</span>
<a href="#l1.405"></a><span id="l1.405">       dialogResult.filepickerClick = rv;</span>
<a href="#l1.406"></a><span id="l1.406" class="difflineminus">-      if (rv != nsIFilePicker.returnCancel &amp;&amp; fp.file) {  // Allow OK and replace.</span>
<a href="#l1.407"></a><span id="l1.407" class="difflineplus">+      if (rv != nsIFilePicker.returnCancel &amp;&amp; fp.file) { // Allow OK and replace.</span>
<a href="#l1.408"></a><span id="l1.408">         // reset urlstring to new save location</span>
<a href="#l1.409"></a><span id="l1.409">         dialogResult.resultingURIString = fileHandler.getURLSpecFromFile(fp.file);</span>
<a href="#l1.410"></a><span id="l1.410">         dialogResult.resultingLocalFile = fp.file;</span>
<a href="#l1.411"></a><span id="l1.411">         SaveFilePickerDirectory(fp, aEditorType);</span>
<a href="#l1.412"></a><span id="l1.412">         resolve(dialogResult);</span>
<a href="#l1.413"></a><span id="l1.413">       } else if (&quot;gFilePickerDirectory&quot; in window &amp;&amp; gFilePickerDirectory) {</span>
<a href="#l1.414"></a><span id="l1.414">         fp.displayDirectory = gFilePickerDirectory;</span>
<a href="#l1.415"></a><span id="l1.415">         resolve(null);</span>
<a href="#l1.416"></a><span id="l1.416" class="difflineat">@@ -813,17 +816,17 @@ function OutputFileWithPersistAPI(editor</span>
<a href="#l1.417"></a><span id="l1.417">   gPersistObj = null;</span>
<a href="#l1.418"></a><span id="l1.418">   var editor = GetCurrentEditor();</span>
<a href="#l1.419"></a><span id="l1.419">   try {</span>
<a href="#l1.420"></a><span id="l1.420">     editor.forceCompositionEnd();</span>
<a href="#l1.421"></a><span id="l1.421">   } catch (e) {}</span>
<a href="#l1.422"></a><span id="l1.422"> </span>
<a href="#l1.423"></a><span id="l1.423">   var isLocalFile = false;</span>
<a href="#l1.424"></a><span id="l1.424">   try {</span>
<a href="#l1.425"></a><span id="l1.425" class="difflineminus">-    var tmp1 = aDestinationLocation.QueryInterface(Ci.nsIFile);</span>
<a href="#l1.426"></a><span id="l1.426" class="difflineplus">+    aDestinationLocation.QueryInterface(Ci.nsIFile);</span>
<a href="#l1.427"></a><span id="l1.427">     isLocalFile = true;</span>
<a href="#l1.428"></a><span id="l1.428">   } catch (e) {</span>
<a href="#l1.429"></a><span id="l1.429">     try {</span>
<a href="#l1.430"></a><span id="l1.430">       var tmp = aDestinationLocation.QueryInterface(Ci.nsIURI);</span>
<a href="#l1.431"></a><span id="l1.431">       isLocalFile = tmp.schemeIs(&quot;file&quot;);</span>
<a href="#l1.432"></a><span id="l1.432">     } catch (e) {}</span>
<a href="#l1.433"></a><span id="l1.433">   }</span>
<a href="#l1.434"></a><span id="l1.434"> </span>
<a href="#l1.435"></a><span id="l1.435" class="difflineat">@@ -832,18 +835,17 @@ function OutputFileWithPersistAPI(editor</span>
<a href="#l1.436"></a><span id="l1.436">     var persistObj = Cc[&quot;@mozilla.org/embedding/browser/nsWebBrowserPersist;1&quot;].createInstance(webPersist);</span>
<a href="#l1.437"></a><span id="l1.437">     persistObj.progressListener = gEditorOutputProgressListener;</span>
<a href="#l1.438"></a><span id="l1.438"> </span>
<a href="#l1.439"></a><span id="l1.439">     var wrapColumn = GetWrapColumn();</span>
<a href="#l1.440"></a><span id="l1.440">     var outputFlags = GetOutputFlags(aMimeType, wrapColumn);</span>
<a href="#l1.441"></a><span id="l1.441"> </span>
<a href="#l1.442"></a><span id="l1.442">     // for 4.x parity as well as improving readability of file locally on server</span>
<a href="#l1.443"></a><span id="l1.443">     // this will always send crlf for upload (http/ftp)</span>
<a href="#l1.444"></a><span id="l1.444" class="difflineminus">-    if (!isLocalFile) // if we aren't saving locally then send both cr and lf</span>
<a href="#l1.445"></a><span id="l1.445" class="difflineminus">-    {</span>
<a href="#l1.446"></a><span id="l1.446" class="difflineplus">+    if (!isLocalFile) { // if we aren't saving locally then send both cr and lf</span>
<a href="#l1.447"></a><span id="l1.447">       outputFlags |= webPersist.ENCODE_FLAGS_CR_LINEBREAKS | webPersist.ENCODE_FLAGS_LF_LINEBREAKS;</span>
<a href="#l1.448"></a><span id="l1.448"> </span>
<a href="#l1.449"></a><span id="l1.449">       // we want to serialize the output for all remote publishing</span>
<a href="#l1.450"></a><span id="l1.450">       // some servers can handle only one connection at a time</span>
<a href="#l1.451"></a><span id="l1.451">       // some day perhaps we can make this user-configurable per site?</span>
<a href="#l1.452"></a><span id="l1.452">       persistObj.persistFlags = persistObj.persistFlags | webPersist.PERSIST_FLAGS_SERIALIZE_OUTPUT;</span>
<a href="#l1.453"></a><span id="l1.453">     }</span>
<a href="#l1.454"></a><span id="l1.454"> </span>
<a href="#l1.455"></a><span id="l1.455" class="difflineat">@@ -854,17 +856,20 @@ function OutputFileWithPersistAPI(editor</span>
<a href="#l1.456"></a><span id="l1.456">                             | webPersist.PERSIST_FLAGS_NO_BASE_TAG_MODIFICATIONS</span>
<a href="#l1.457"></a><span id="l1.457">                             | webPersist.PERSIST_FLAGS_REPLACE_EXISTING_FILES</span>
<a href="#l1.458"></a><span id="l1.458">                             | webPersist.PERSIST_FLAGS_DONT_FIXUP_LINKS</span>
<a href="#l1.459"></a><span id="l1.459">                             | webPersist.PERSIST_FLAGS_DONT_CHANGE_FILENAMES</span>
<a href="#l1.460"></a><span id="l1.460">                             | webPersist.PERSIST_FLAGS_FIXUP_ORIGINAL_DOM;</span>
<a href="#l1.461"></a><span id="l1.461">     persistObj.saveDocument(editorDoc, aDestinationLocation, aRelatedFilesParentDir,</span>
<a href="#l1.462"></a><span id="l1.462">                             aMimeType, outputFlags, wrapColumn);</span>
<a href="#l1.463"></a><span id="l1.463">     gPersistObj = persistObj;</span>
<a href="#l1.464"></a><span id="l1.464" class="difflineminus">-  } catch (e) { dump(&quot;caught an error, bail\n&quot;); return false; }</span>
<a href="#l1.465"></a><span id="l1.465" class="difflineplus">+  } catch (e) {</span>
<a href="#l1.466"></a><span id="l1.466" class="difflineplus">+    dump(&quot;caught an error, bail\n&quot;);</span>
<a href="#l1.467"></a><span id="l1.467" class="difflineplus">+    return false;</span>
<a href="#l1.468"></a><span id="l1.468" class="difflineplus">+  }</span>
<a href="#l1.469"></a><span id="l1.469"> </span>
<a href="#l1.470"></a><span id="l1.470">   return true;</span>
<a href="#l1.471"></a><span id="l1.471"> }</span>
<a href="#l1.472"></a><span id="l1.472"> </span>
<a href="#l1.473"></a><span id="l1.473"> // returns output flags based on mimetype, wrapCol and prefs</span>
<a href="#l1.474"></a><span id="l1.474"> function GetOutputFlags(aMimeType, aWrapColumn) {</span>
<a href="#l1.475"></a><span id="l1.475">   var outputFlags = 0;</span>
<a href="#l1.476"></a><span id="l1.476">   var editor = GetCurrentEditor();</span>
<a href="#l1.477"></a><span id="l1.477" class="difflineat">@@ -915,18 +920,19 @@ const gShowDebugOutputSecurityChange = f</span>
<a href="#l1.478"></a><span id="l1.478"> </span>
<a href="#l1.479"></a><span id="l1.479"> const nsIWebProgressListener = Ci.nsIWebProgressListener;</span>
<a href="#l1.480"></a><span id="l1.480"> const nsIChannel = Ci.nsIChannel;</span>
<a href="#l1.481"></a><span id="l1.481"> </span>
<a href="#l1.482"></a><span id="l1.482"> const kErrorBindingAborted = 2152398850;</span>
<a href="#l1.483"></a><span id="l1.483"> const kErrorBindingRedirected = 2152398851;</span>
<a href="#l1.484"></a><span id="l1.484"> const kFileNotFound = 2152857618;</span>
<a href="#l1.485"></a><span id="l1.485"> </span>
<a href="#l1.486"></a><span id="l1.486" class="difflineminus">-var gEditorOutputProgressListener =</span>
<a href="#l1.487"></a><span id="l1.487" class="difflineminus">-{</span>
<a href="#l1.488"></a><span id="l1.488" class="difflineplus">+/* eslint-disable */</span>
<a href="#l1.489"></a><span id="l1.489" class="difflineplus">+var gEditorOutputProgressListener = {</span>
<a href="#l1.490"></a><span id="l1.490" class="difflineplus">+  /* eslint-disable complexity */</span>
<a href="#l1.491"></a><span id="l1.491">   onStateChange(aWebProgress, aRequest, aStateFlags, aStatus) {</span>
<a href="#l1.492"></a><span id="l1.492">     var editor = GetCurrentEditor();</span>
<a href="#l1.493"></a><span id="l1.493"> </span>
<a href="#l1.494"></a><span id="l1.494">     // Use this to access onStateChange flags</span>
<a href="#l1.495"></a><span id="l1.495">     var requestSpec;</span>
<a href="#l1.496"></a><span id="l1.496">     try {</span>
<a href="#l1.497"></a><span id="l1.497">       var channel = aRequest.QueryInterface(nsIChannel);</span>
<a href="#l1.498"></a><span id="l1.498">       requestSpec = StripUsernamePasswordFromURI(channel.URI);</span>
<a href="#l1.499"></a><span id="l1.499" class="difflineat">@@ -1042,18 +1048,17 @@ var gEditorOutputProgressListener =</span>
<a href="#l1.500"></a><span id="l1.500">       // Case 2: If just HTML file is uploaded, we get STATE_START and STATE_STOP</span>
<a href="#l1.501"></a><span id="l1.501">       //    notification with a null &quot;requestSpec&quot;, and</span>
<a href="#l1.502"></a><span id="l1.502">       //    the gPersistObj is destroyed before we get here!</span>
<a href="#l1.503"></a><span id="l1.503">       //    So create an new object so we can flow through normal processing below</span>
<a href="#l1.504"></a><span id="l1.504">       if (!requestSpec &amp;&amp; GetScheme(gPublishData.publishUrl) == &quot;file&quot;</span>
<a href="#l1.505"></a><span id="l1.505">           &amp;&amp; (!gPersistObj || gPersistObj.currentState == nsIWebBrowserPersist.PERSIST_STATE_FINISHED)) {</span>
<a href="#l1.506"></a><span id="l1.506">         aStateFlags |= nsIWebProgressListener.STATE_IS_NETWORK;</span>
<a href="#l1.507"></a><span id="l1.507">         if (!gPersistObj) {</span>
<a href="#l1.508"></a><span id="l1.508" class="difflineminus">-          gPersistObj =</span>
<a href="#l1.509"></a><span id="l1.509" class="difflineminus">-          {</span>
<a href="#l1.510"></a><span id="l1.510" class="difflineplus">+          gPersistObj = {</span>
<a href="#l1.511"></a><span id="l1.511">             result: aStatus,</span>
<a href="#l1.512"></a><span id="l1.512">             currentState: nsIWebBrowserPersist.PERSIST_STATE_FINISHED,</span>
<a href="#l1.513"></a><span id="l1.513">           };</span>
<a href="#l1.514"></a><span id="l1.514">         }</span>
<a href="#l1.515"></a><span id="l1.515">       }</span>
<a href="#l1.516"></a><span id="l1.516"> </span>
<a href="#l1.517"></a><span id="l1.517">       // STATE_IS_NETWORK signals end of publishing, as does the gPersistObj.currentState</span>
<a href="#l1.518"></a><span id="l1.518">       if (aStateFlags &amp; nsIWebProgressListener.STATE_IS_NETWORK</span>
<a href="#l1.519"></a><span id="l1.519" class="difflineat">@@ -1083,32 +1088,34 @@ var gEditorOutputProgressListener =</span>
<a href="#l1.520"></a><span id="l1.520"> </span>
<a href="#l1.521"></a><span id="l1.521">           // Save publishData to prefs</span>
<a href="#l1.522"></a><span id="l1.522">           if (gPublishData) {</span>
<a href="#l1.523"></a><span id="l1.523">             if (gPublishData.savePublishData) {</span>
<a href="#l1.524"></a><span id="l1.524">               // We published successfully, so we can safely</span>
<a href="#l1.525"></a><span id="l1.525">               //  save docDir and otherDir to prefs</span>
<a href="#l1.526"></a><span id="l1.526">               gPublishData.saveDirs = true;</span>
<a href="#l1.527"></a><span id="l1.527">               SavePublishDataToPrefs(gPublishData);</span>
<a href="#l1.528"></a><span id="l1.528" class="difflineminus">-            } else</span>
<a href="#l1.529"></a><span id="l1.529" class="difflineplus">+            } else {</span>
<a href="#l1.530"></a><span id="l1.530">               SavePassword(gPublishData);</span>
<a href="#l1.531"></a><span id="l1.531" class="difflineplus">+            }</span>
<a href="#l1.532"></a><span id="l1.532">           }</span>
<a href="#l1.533"></a><span id="l1.533"> </span>
<a href="#l1.534"></a><span id="l1.534">           // Ask progress dialog to close, but it may not</span>
<a href="#l1.535"></a><span id="l1.535">           // if user checked checkbox to keep it open</span>
<a href="#l1.536"></a><span id="l1.536">           gProgressDialog.RequestCloseDialog();</span>
<a href="#l1.537"></a><span id="l1.537">         } else {</span>
<a href="#l1.538"></a><span id="l1.538">           // We previously aborted publishing because of error:</span>
<a href="#l1.539"></a><span id="l1.539">           //   Calling gPersistObj.cancelSave() resulted in a non-zero gPersistObj.result,</span>
<a href="#l1.540"></a><span id="l1.540">           //   so notify progress dialog we're finished</span>
<a href="#l1.541"></a><span id="l1.541">           gProgressDialog.SetProgressFinished(null, 0);</span>
<a href="#l1.542"></a><span id="l1.542">         }</span>
<a href="#l1.543"></a><span id="l1.543">       }</span>
<a href="#l1.544"></a><span id="l1.544">     }</span>
<a href="#l1.545"></a><span id="l1.545">   },</span>
<a href="#l1.546"></a><span id="l1.546" class="difflineplus">+  /* eslint-enable complexity */</span>
<a href="#l1.547"></a><span id="l1.547"> </span>
<a href="#l1.548"></a><span id="l1.548">   onProgressChange(aWebProgress, aRequest, aCurSelfProgress,</span>
<a href="#l1.549"></a><span id="l1.549">                               aMaxSelfProgress, aCurTotalProgress, aMaxTotalProgress) {</span>
<a href="#l1.550"></a><span id="l1.550">     if (!gPersistObj)</span>
<a href="#l1.551"></a><span id="l1.551">       return;</span>
<a href="#l1.552"></a><span id="l1.552"> </span>
<a href="#l1.553"></a><span id="l1.553">     if (gShowDebugOutputProgress) {</span>
<a href="#l1.554"></a><span id="l1.554">       dump(&quot;\n onProgressChange: gPersistObj.result=&quot; + gPersistObj.result + &quot;\n&quot;);</span>
<a href="#l1.555"></a><span id="l1.555" class="difflineat">@@ -1139,17 +1146,19 @@ var gEditorOutputProgressListener =</span>
<a href="#l1.556"></a><span id="l1.556">   },</span>
<a href="#l1.557"></a><span id="l1.557"> </span>
<a href="#l1.558"></a><span id="l1.558">   onStatusChange(aWebProgress, aRequest, aStatus, aMessage) {</span>
<a href="#l1.559"></a><span id="l1.559">     if (gShowDebugOutputStatusChange) {</span>
<a href="#l1.560"></a><span id="l1.560">       dump(&quot;***** onStatusChange: &quot; + aMessage + &quot;\n&quot;);</span>
<a href="#l1.561"></a><span id="l1.561">       try {</span>
<a href="#l1.562"></a><span id="l1.562">         var channel = aRequest.QueryInterface(nsIChannel);</span>
<a href="#l1.563"></a><span id="l1.563">         dump(&quot;*****        request: &quot; + channel.URI.spec + &quot;\n&quot;);</span>
<a href="#l1.564"></a><span id="l1.564" class="difflineminus">-      } catch (e) { dump(&quot;          couldn't get request\n&quot;); }</span>
<a href="#l1.565"></a><span id="l1.565" class="difflineplus">+      } catch (e) {</span>
<a href="#l1.566"></a><span id="l1.566" class="difflineplus">+        dump(&quot;          couldn't get request\n&quot;);</span>
<a href="#l1.567"></a><span id="l1.567" class="difflineplus">+      }</span>
<a href="#l1.568"></a><span id="l1.568"> </span>
<a href="#l1.569"></a><span id="l1.569">       DumpDebugStatus(aStatus);</span>
<a href="#l1.570"></a><span id="l1.570"> </span>
<a href="#l1.571"></a><span id="l1.571">       if (gPersistObj) {</span>
<a href="#l1.572"></a><span id="l1.572">         if (gPersistObj.currentState == gPersistObj.PERSIST_STATE_READY)</span>
<a href="#l1.573"></a><span id="l1.573">           dump(&quot; Persister is ready to save data\n\n&quot;);</span>
<a href="#l1.574"></a><span id="l1.574">         else if (gPersistObj.currentState == gPersistObj.PERSIST_STATE_SAVING)</span>
<a href="#l1.575"></a><span id="l1.575">           dump(&quot; Persister is saving data.\n\n&quot;);</span>
<a href="#l1.576"></a><span id="l1.576" class="difflineat">@@ -1171,17 +1180,17 @@ var gEditorOutputProgressListener =</span>
<a href="#l1.577"></a><span id="l1.577">   onContentBlockingEvent(aWebProgress, aRequest, aEvent) {</span>
<a href="#l1.578"></a><span id="l1.578">   },</span>
<a href="#l1.579"></a><span id="l1.579"> </span>
<a href="#l1.580"></a><span id="l1.580">   QueryInterface: ChromeUtils.generateQI([&quot;nsIWebProgressListener&quot;,</span>
<a href="#l1.581"></a><span id="l1.581">                                           &quot;nsISupportsWeakReference&quot;,</span>
<a href="#l1.582"></a><span id="l1.582">                                           &quot;nsIPrompt&quot;,</span>
<a href="#l1.583"></a><span id="l1.583">                                           &quot;nsIAuthPrompt&quot;]),</span>
<a href="#l1.584"></a><span id="l1.584"> </span>
<a href="#l1.585"></a><span id="l1.585" class="difflineminus">-// nsIPrompt</span>
<a href="#l1.586"></a><span id="l1.586" class="difflineplus">+  // nsIPrompt</span>
<a href="#l1.587"></a><span id="l1.587">   alert(dlgTitle, text) {</span>
<a href="#l1.588"></a><span id="l1.588">     Services.prompt.alert(gProgressDialog ? gProgressDialog : window, dlgTitle, text);</span>
<a href="#l1.589"></a><span id="l1.589">   },</span>
<a href="#l1.590"></a><span id="l1.590">   alertCheck(dialogTitle, text, checkBoxLabel, checkObj) {</span>
<a href="#l1.591"></a><span id="l1.591">     Services.prompt.alert(window, dialogTitle, text);</span>
<a href="#l1.592"></a><span id="l1.592">   },</span>
<a href="#l1.593"></a><span id="l1.593">   confirm(dlgTitle, text) {</span>
<a href="#l1.594"></a><span id="l1.594">     return ConfirmWithTitle(dlgTitle, text, null, null);</span>
<a href="#l1.595"></a><span id="l1.595" class="difflineat">@@ -1240,17 +1249,17 @@ var gEditorOutputProgressListener =</span>
<a href="#l1.596"></a><span id="l1.596">     return ret;</span>
<a href="#l1.597"></a><span id="l1.597">   },</span>
<a href="#l1.598"></a><span id="l1.598">    *************************************************************************/</span>
<a href="#l1.599"></a><span id="l1.599"> </span>
<a href="#l1.600"></a><span id="l1.600">   select(dlgTitle, text, count, selectList, outSelection) {</span>
<a href="#l1.601"></a><span id="l1.601">     return Services.prompt.select(window, dlgTitle, text, count, selectList, outSelection);</span>
<a href="#l1.602"></a><span id="l1.602">   },</span>
<a href="#l1.603"></a><span id="l1.603"> </span>
<a href="#l1.604"></a><span id="l1.604" class="difflineminus">-// nsIAuthPrompt</span>
<a href="#l1.605"></a><span id="l1.605" class="difflineplus">+  // nsIAuthPrompt</span>
<a href="#l1.606"></a><span id="l1.606">   prompt(dlgTitle, text, pwrealm, savePW, defaultText, result) {</span>
<a href="#l1.607"></a><span id="l1.607">     var ret = Services.prompt.prompt(gProgressDialog ? gProgressDialog : window,</span>
<a href="#l1.608"></a><span id="l1.608">                                      dlgTitle, text, defaultText, pwrealm, savePWObj);</span>
<a href="#l1.609"></a><span id="l1.609">     if (!ret)</span>
<a href="#l1.610"></a><span id="l1.610">       setTimeout(CancelPublishing, 0);</span>
<a href="#l1.611"></a><span id="l1.611">     return ret;</span>
<a href="#l1.612"></a><span id="l1.612">   },</span>
<a href="#l1.613"></a><span id="l1.613"> </span>
<a href="#l1.614"></a><span id="l1.614" class="difflineat">@@ -1281,16 +1290,17 @@ var gEditorOutputProgressListener =</span>
<a href="#l1.615"></a><span id="l1.615"> </span>
<a href="#l1.616"></a><span id="l1.616">       if (ret &amp;&amp; gPublishData)</span>
<a href="#l1.617"></a><span id="l1.617">         UpdateUsernamePasswordFromPrompt(gPublishData, gPublishData.username, pwObj.value, savePWObj.value);</span>
<a href="#l1.618"></a><span id="l1.618">     } catch (e) {}</span>
<a href="#l1.619"></a><span id="l1.619"> </span>
<a href="#l1.620"></a><span id="l1.620">     return ret;</span>
<a href="#l1.621"></a><span id="l1.621">   },</span>
<a href="#l1.622"></a><span id="l1.622"> };</span>
<a href="#l1.623"></a><span id="l1.623" class="difflineplus">+/* eslint-enable */</span>
<a href="#l1.624"></a><span id="l1.624"> </span>
<a href="#l1.625"></a><span id="l1.625"> function PromptUsernameAndPassword(dlgTitle, text, savePW, userObj, pwObj) {</span>
<a href="#l1.626"></a><span id="l1.626">   // HTTP prompts us twice even if user Cancels from 1st attempt!</span>
<a href="#l1.627"></a><span id="l1.627">   // So never put up dialog if there's no publish data</span>
<a href="#l1.628"></a><span id="l1.628">   if (!gPublishData)</span>
<a href="#l1.629"></a><span id="l1.629">     return false;</span>
<a href="#l1.630"></a><span id="l1.630"> </span>
<a href="#l1.631"></a><span id="l1.631">   var ret = false;</span>
<a href="#l1.632"></a><span id="l1.632" class="difflineat">@@ -1311,16 +1321,17 @@ function PromptUsernameAndPassword(dlgTi</span>
<a href="#l1.633"></a><span id="l1.633">                                                     GetString(&quot;SavePassword&quot;), savePWObj);</span>
<a href="#l1.634"></a><span id="l1.634">     if (ret &amp;&amp; gPublishData)</span>
<a href="#l1.635"></a><span id="l1.635">       UpdateUsernamePasswordFromPrompt(gPublishData, userObj.value, pwObj.value, savePWObj.value);</span>
<a href="#l1.636"></a><span id="l1.636">   } catch (e) {}</span>
<a href="#l1.637"></a><span id="l1.637"> </span>
<a href="#l1.638"></a><span id="l1.638">   return ret;</span>
<a href="#l1.639"></a><span id="l1.639"> }</span>
<a href="#l1.640"></a><span id="l1.640"> </span>
<a href="#l1.641"></a><span id="l1.641" class="difflineplus">+/* eslint-disable complexity */</span>
<a href="#l1.642"></a><span id="l1.642"> function DumpDebugStatus(aStatus) {</span>
<a href="#l1.643"></a><span id="l1.643">   // see nsError.h and netCore.h and ftpCore.h</span>
<a href="#l1.644"></a><span id="l1.644"> </span>
<a href="#l1.645"></a><span id="l1.645">   if (aStatus == kErrorBindingAborted)</span>
<a href="#l1.646"></a><span id="l1.646">     dump(&quot;***** status is NS_BINDING_ABORTED\n&quot;);</span>
<a href="#l1.647"></a><span id="l1.647">   else if (aStatus == kErrorBindingRedirected)</span>
<a href="#l1.648"></a><span id="l1.648">     dump(&quot;***** status is NS_BINDING_REDIRECTED\n&quot;);</span>
<a href="#l1.649"></a><span id="l1.649">   else if (aStatus == 2152398859) // in netCore.h 11</span>
<a href="#l1.650"></a><span id="l1.650" class="difflineat">@@ -1387,16 +1398,17 @@ function DumpDebugStatus(aStatus) {</span>
<a href="#l1.651"></a><span id="l1.651">     dump(&quot;***** status is DIR_NOT_EMPTY\n&quot;);</span>
<a href="#l1.652"></a><span id="l1.652">   else if (aStatus == 2152857621)</span>
<a href="#l1.653"></a><span id="l1.653">     dump(&quot;***** status is ACCESS_DENIED\n&quot;);</span>
<a href="#l1.654"></a><span id="l1.654">   else if (aStatus == 2152398878)</span>
<a href="#l1.655"></a><span id="l1.655">     dump(&quot;***** status is ? (No connection or time out?)\n&quot;);</span>
<a href="#l1.656"></a><span id="l1.656">   else</span>
<a href="#l1.657"></a><span id="l1.657">     dump(&quot;***** status is &quot; + aStatus + &quot;\n&quot;);</span>
<a href="#l1.658"></a><span id="l1.658"> }</span>
<a href="#l1.659"></a><span id="l1.659" class="difflineplus">+/* eslint-enable complexity */</span>
<a href="#l1.660"></a><span id="l1.660"> </span>
<a href="#l1.661"></a><span id="l1.661"> // Update any data that the user supplied in a prompt dialog</span>
<a href="#l1.662"></a><span id="l1.662"> function UpdateUsernamePasswordFromPrompt(publishData, username, password, savePassword) {</span>
<a href="#l1.663"></a><span id="l1.663">   if (!publishData)</span>
<a href="#l1.664"></a><span id="l1.664">     return;</span>
<a href="#l1.665"></a><span id="l1.665"> </span>
<a href="#l1.666"></a><span id="l1.666">   // Set flag to save publish data after publishing if it changed in dialog</span>
<a href="#l1.667"></a><span id="l1.667">   //  and the &quot;SavePassword&quot; checkbox was checked</span>
<a href="#l1.668"></a><span id="l1.668" class="difflineat">@@ -1405,18 +1417,17 @@ function UpdateUsernamePasswordFromPromp</span>
<a href="#l1.669"></a><span id="l1.669">   publishData.savePublishData = (gPublishData.username != username || gPublishData.password != password)</span>
<a href="#l1.670"></a><span id="l1.670">                                 &amp;&amp; (savePassword || !publishData.notInSiteData);</span>
<a href="#l1.671"></a><span id="l1.671"> </span>
<a href="#l1.672"></a><span id="l1.672">   publishData.username = username;</span>
<a href="#l1.673"></a><span id="l1.673">   publishData.password = password;</span>
<a href="#l1.674"></a><span id="l1.674">   publishData.savePassword = savePassword;</span>
<a href="#l1.675"></a><span id="l1.675"> }</span>
<a href="#l1.676"></a><span id="l1.676"> </span>
<a href="#l1.677"></a><span id="l1.677" class="difflineminus">-const kSupportedTextMimeTypes =</span>
<a href="#l1.678"></a><span id="l1.678" class="difflineminus">-[</span>
<a href="#l1.679"></a><span id="l1.679" class="difflineplus">+const kSupportedTextMimeTypes = [</span>
<a href="#l1.680"></a><span id="l1.680">   &quot;text/plain&quot;,</span>
<a href="#l1.681"></a><span id="l1.681">   &quot;text/css&quot;,</span>
<a href="#l1.682"></a><span id="l1.682">   &quot;text/rdf&quot;,</span>
<a href="#l1.683"></a><span id="l1.683">   &quot;text/xsl&quot;,</span>
<a href="#l1.684"></a><span id="l1.684">   &quot;text/javascript&quot;,</span>
<a href="#l1.685"></a><span id="l1.685">   &quot;text/ecmascript&quot;,</span>
<a href="#l1.686"></a><span id="l1.686">   &quot;application/javascript&quot;,</span>
<a href="#l1.687"></a><span id="l1.687">   &quot;application/ecmascript&quot;,</span>
<a href="#l1.688"></a><span id="l1.688" class="difflineat">@@ -1428,29 +1439,31 @@ const kSupportedTextMimeTypes =</span>
<a href="#l1.689"></a><span id="l1.689"> function IsSupportedTextMimeType(aMimeType) {</span>
<a href="#l1.690"></a><span id="l1.690">   for (var i = 0; i &lt; kSupportedTextMimeTypes.length; i++) {</span>
<a href="#l1.691"></a><span id="l1.691">     if (kSupportedTextMimeTypes[i] == aMimeType)</span>
<a href="#l1.692"></a><span id="l1.692">       return true;</span>
<a href="#l1.693"></a><span id="l1.693">   }</span>
<a href="#l1.694"></a><span id="l1.694">   return false;</span>
<a href="#l1.695"></a><span id="l1.695"> }</span>
<a href="#l1.696"></a><span id="l1.696"> </span>
<a href="#l1.697"></a><span id="l1.697" class="difflineplus">+/* eslint-disable */</span>
<a href="#l1.698"></a><span id="l1.698" class="difflineplus">+/* eslint-disable complexity */</span>
<a href="#l1.699"></a><span id="l1.699"> // throws an error or returns true if user attempted save; false if user canceled save</span>
<a href="#l1.700"></a><span id="l1.700"> async function SaveDocument(aSaveAs, aSaveCopy, aMimeType) {</span>
<a href="#l1.701"></a><span id="l1.701">   var editor = GetCurrentEditor();</span>
<a href="#l1.702"></a><span id="l1.702">   if (!aMimeType || !editor)</span>
<a href="#l1.703"></a><span id="l1.703">     throw Cr.NS_ERROR_NOT_INITIALIZED;</span>
<a href="#l1.704"></a><span id="l1.704"> </span>
<a href="#l1.705"></a><span id="l1.705">   var editorDoc = editor.document;</span>
<a href="#l1.706"></a><span id="l1.706">   if (!editorDoc)</span>
<a href="#l1.707"></a><span id="l1.707">     throw Cr.NS_ERROR_NOT_INITIALIZED;</span>
<a href="#l1.708"></a><span id="l1.708"> </span>
<a href="#l1.709"></a><span id="l1.709">   // if we don't have the right editor type bail (we handle text and html)</span>
<a href="#l1.710"></a><span id="l1.710">   var editorType = GetCurrentEditorType();</span>
<a href="#l1.711"></a><span id="l1.711" class="difflineminus">-  if ([&quot;text&quot;, &quot;html&quot;, &quot;htmlmail&quot;, &quot;textmail&quot;].indexOf(editorType) == -1)</span>
<a href="#l1.712"></a><span id="l1.712" class="difflineplus">+  if (![&quot;text&quot;, &quot;html&quot;, &quot;htmlmail&quot;, &quot;textmail&quot;].includes(editorType))</span>
<a href="#l1.713"></a><span id="l1.713">     throw Cr.NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l1.714"></a><span id="l1.714"> </span>
<a href="#l1.715"></a><span id="l1.715">   var saveAsTextFile = IsSupportedTextMimeType(aMimeType);</span>
<a href="#l1.716"></a><span id="l1.716"> </span>
<a href="#l1.717"></a><span id="l1.717">   // check if the file is to be saved is a format we don't understand; if so, bail</span>
<a href="#l1.718"></a><span id="l1.718">   if (aMimeType != kHTMLMimeType &amp;&amp; aMimeType != kXHTMLMimeType &amp;&amp; !saveAsTextFile)</span>
<a href="#l1.719"></a><span id="l1.719">     throw Cr.NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l1.720"></a><span id="l1.720"> </span>
<a href="#l1.721"></a><span id="l1.721" class="difflineat">@@ -1459,18 +1472,16 @@ async function SaveDocument(aSaveAs, aSa</span>
<a href="#l1.722"></a><span id="l1.722"> </span>
<a href="#l1.723"></a><span id="l1.723">   var urlstring = GetDocumentUrl();</span>
<a href="#l1.724"></a><span id="l1.724">   var mustShowFileDialog = (aSaveAs || IsUrlAboutBlank(urlstring) || (urlstring == &quot;&quot;));</span>
<a href="#l1.725"></a><span id="l1.725"> </span>
<a href="#l1.726"></a><span id="l1.726">   // If editing a remote URL, force SaveAs dialog</span>
<a href="#l1.727"></a><span id="l1.727">   if (!mustShowFileDialog &amp;&amp; GetScheme(urlstring) != &quot;file&quot;)</span>
<a href="#l1.728"></a><span id="l1.728">     mustShowFileDialog = true;</span>
<a href="#l1.729"></a><span id="l1.729"> </span>
<a href="#l1.730"></a><span id="l1.730" class="difflineminus">-  var replacing = !aSaveAs;</span>
<a href="#l1.731"></a><span id="l1.731" class="difflineminus">-  var titleChanged = false;</span>
<a href="#l1.732"></a><span id="l1.732">   var doUpdateURI = false;</span>
<a href="#l1.733"></a><span id="l1.733">   var tempLocalFile = null;</span>
<a href="#l1.734"></a><span id="l1.734"> </span>
<a href="#l1.735"></a><span id="l1.735">   if (mustShowFileDialog) {</span>
<a href="#l1.736"></a><span id="l1.736">     try {</span>
<a href="#l1.737"></a><span id="l1.737">       // Prompt for title if we are saving to HTML</span>
<a href="#l1.738"></a><span id="l1.738">       if (!saveAsTextFile &amp;&amp; (editorType == &quot;html&quot;)) {</span>
<a href="#l1.739"></a><span id="l1.739">         var userContinuing = PromptAndSetTitleIfNone(); // not cancel</span>
<a href="#l1.740"></a><span id="l1.740" class="difflineat">@@ -1535,17 +1546,19 @@ async function SaveDocument(aSaveAs, aSa</span>
<a href="#l1.741"></a><span id="l1.741">             relatedFilesDir = tempLocalFile.parent;</span>
<a href="#l1.742"></a><span id="l1.742">         } else {</span>
<a href="#l1.743"></a><span id="l1.743">           var lastSlash = urlstring.lastIndexOf(&quot;\/&quot;);</span>
<a href="#l1.744"></a><span id="l1.744">           if (lastSlash != -1) {</span>
<a href="#l1.745"></a><span id="l1.745">             var relatedFilesDirString = urlstring.slice(0, lastSlash + 1);  // include last slash</span>
<a href="#l1.746"></a><span id="l1.746">             relatedFilesDir = Services.io.newURI(relatedFilesDirString, editor.documentCharacterSet);</span>
<a href="#l1.747"></a><span id="l1.747">           }</span>
<a href="#l1.748"></a><span id="l1.748">         }</span>
<a href="#l1.749"></a><span id="l1.749" class="difflineminus">-      } catch (e) { relatedFilesDir = null; }</span>
<a href="#l1.750"></a><span id="l1.750" class="difflineplus">+      } catch (e) {</span>
<a href="#l1.751"></a><span id="l1.751" class="difflineplus">+        relatedFilesDir = null;</span>
<a href="#l1.752"></a><span id="l1.752" class="difflineplus">+      }</span>
<a href="#l1.753"></a><span id="l1.753">     }</span>
<a href="#l1.754"></a><span id="l1.754"> </span>
<a href="#l1.755"></a><span id="l1.755">     let destinationLocation = tempLocalFile ? tempLocalFile : docURI;</span>
<a href="#l1.756"></a><span id="l1.756"> </span>
<a href="#l1.757"></a><span id="l1.757">     success = OutputFileWithPersistAPI(editorDoc, destinationLocation, relatedFilesDir, aMimeType);</span>
<a href="#l1.758"></a><span id="l1.758">   } catch (e) {</span>
<a href="#l1.759"></a><span id="l1.759">     success = false;</span>
<a href="#l1.760"></a><span id="l1.760">   }</span>
<a href="#l1.761"></a><span id="l1.761" class="difflineat">@@ -1573,25 +1586,28 @@ async function SaveDocument(aSaveAs, aSa</span>
<a href="#l1.762"></a><span id="l1.762">       // Set UI based on whether we're editing a remote or local url</span>
<a href="#l1.763"></a><span id="l1.763">       SetSaveAndPublishUI(urlstring);</span>
<a href="#l1.764"></a><span id="l1.764">     } catch (e) {}</span>
<a href="#l1.765"></a><span id="l1.765">   } else {</span>
<a href="#l1.766"></a><span id="l1.766">     Services.prompt.alert(window, GetString(&quot;SaveDocument&quot;), GetString(&quot;SaveFileFailed&quot;));</span>
<a href="#l1.767"></a><span id="l1.767">   }</span>
<a href="#l1.768"></a><span id="l1.768">   return success;</span>
<a href="#l1.769"></a><span id="l1.769"> }</span>
<a href="#l1.770"></a><span id="l1.770" class="difflineplus">+/* eslint-enable complexity */</span>
<a href="#l1.771"></a><span id="l1.771" class="difflineplus">+/* eslint-enable */</span>
<a href="#l1.772"></a><span id="l1.772"> </span>
<a href="#l1.773"></a><span id="l1.773"> function SetDocumentURI(uri) {</span>
<a href="#l1.774"></a><span id="l1.774">   try {</span>
<a href="#l1.775"></a><span id="l1.775">     // XXX WE'LL NEED TO GET &quot;CURRENT&quot; CONTENT FRAME ONCE MULTIPLE EDITORS ARE ALLOWED</span>
<a href="#l1.776"></a><span id="l1.776">     GetCurrentEditorElement().docShell.setCurrentURI(uri);</span>
<a href="#l1.777"></a><span id="l1.777" class="difflineminus">-  } catch (e) { dump(&quot;SetDocumentURI:\n&quot; + e + &quot;\n&quot;); }</span>
<a href="#l1.778"></a><span id="l1.778" class="difflineplus">+  } catch (e) {</span>
<a href="#l1.779"></a><span id="l1.779" class="difflineplus">+    dump(&quot;SetDocumentURI:\n&quot; + e + &quot;\n&quot;);</span>
<a href="#l1.780"></a><span id="l1.780" class="difflineplus">+  }</span>
<a href="#l1.781"></a><span id="l1.781"> }</span>
<a href="#l1.782"></a><span id="l1.782"> </span>
<a href="#l1.783"></a><span id="l1.783" class="difflineminus">-</span>
<a href="#l1.784"></a><span id="l1.784"> // -------------------------------  Publishing</span>
<a href="#l1.785"></a><span id="l1.785"> var gPublishData;</span>
<a href="#l1.786"></a><span id="l1.786"> var gProgressDialog;</span>
<a href="#l1.787"></a><span id="l1.787"> var gCommandAfterPublishing = null;</span>
<a href="#l1.788"></a><span id="l1.788"> var gRestoreDocumentSource;</span>
<a href="#l1.789"></a><span id="l1.789"> </span>
<a href="#l1.790"></a><span id="l1.790"> function Publish(publishData) {</span>
<a href="#l1.791"></a><span id="l1.791">   if (!publishData)</span>
<a href="#l1.792"></a><span id="l1.792" class="difflineat">@@ -1690,34 +1706,36 @@ function CancelPublishing() {</span>
<a href="#l1.793"></a><span id="l1.793"> </span>
<a href="#l1.794"></a><span id="l1.794">   // If canceling publishing do not do any commands after this</span>
<a href="#l1.795"></a><span id="l1.795">   gCommandAfterPublishing = null;</span>
<a href="#l1.796"></a><span id="l1.796"> </span>
<a href="#l1.797"></a><span id="l1.797">   if (gProgressDialog) {</span>
<a href="#l1.798"></a><span id="l1.798">     // Close Progress dialog</span>
<a href="#l1.799"></a><span id="l1.799">     // (this will call FinishPublishing())</span>
<a href="#l1.800"></a><span id="l1.800">     gProgressDialog.CloseDialog();</span>
<a href="#l1.801"></a><span id="l1.801" class="difflineminus">-  } else</span>
<a href="#l1.802"></a><span id="l1.802" class="difflineplus">+  } else {</span>
<a href="#l1.803"></a><span id="l1.803">     FinishPublishing();</span>
<a href="#l1.804"></a><span id="l1.804" class="difflineplus">+  }</span>
<a href="#l1.805"></a><span id="l1.805"> }</span>
<a href="#l1.806"></a><span id="l1.806"> </span>
<a href="#l1.807"></a><span id="l1.807"> function FinishPublishing() {</span>
<a href="#l1.808"></a><span id="l1.808">   SetDocumentEditable(true);</span>
<a href="#l1.809"></a><span id="l1.809">   gProgressDialog = null;</span>
<a href="#l1.810"></a><span id="l1.810">   gPublishData = null;</span>
<a href="#l1.811"></a><span id="l1.811">   gRestoreDocumentSource = null;</span>
<a href="#l1.812"></a><span id="l1.812"> </span>
<a href="#l1.813"></a><span id="l1.813">   if (gCommandAfterPublishing) {</span>
<a href="#l1.814"></a><span id="l1.814">     // Be sure to null out the global now in case of trouble when executing command</span>
<a href="#l1.815"></a><span id="l1.815">     var command = gCommandAfterPublishing;</span>
<a href="#l1.816"></a><span id="l1.816">     gCommandAfterPublishing = null;</span>
<a href="#l1.817"></a><span id="l1.817">     goDoCommand(command);</span>
<a href="#l1.818"></a><span id="l1.818">   }</span>
<a href="#l1.819"></a><span id="l1.819"> }</span>
<a href="#l1.820"></a><span id="l1.820"> </span>
<a href="#l1.821"></a><span id="l1.821" class="difflineplus">+/* eslint-disable */</span>
<a href="#l1.822"></a><span id="l1.822"> // Create a nsIURI object filled in with all required publishing info</span>
<a href="#l1.823"></a><span id="l1.823"> function CreateURIFromPublishData(publishData, doDocUri) {</span>
<a href="#l1.824"></a><span id="l1.824">   if (!publishData || !publishData.publishUrl)</span>
<a href="#l1.825"></a><span id="l1.825">     return null;</span>
<a href="#l1.826"></a><span id="l1.826"> </span>
<a href="#l1.827"></a><span id="l1.827">   var URI;</span>
<a href="#l1.828"></a><span id="l1.828">   try {</span>
<a href="#l1.829"></a><span id="l1.829">     var spec = publishData.publishUrl;</span>
<a href="#l1.830"></a><span id="l1.830" class="difflineat">@@ -1739,33 +1757,33 @@ function CreateURIFromPublishData(publis</span>
<a href="#l1.831"></a><span id="l1.831"> </span>
<a href="#l1.832"></a><span id="l1.832"> // Resolve the correct &quot;http:&quot; document URL when publishing via ftp</span>
<a href="#l1.833"></a><span id="l1.833"> function GetDocUrlFromPublishData(publishData) {</span>
<a href="#l1.834"></a><span id="l1.834">   if (!publishData || !publishData.filename || !publishData.publishUrl)</span>
<a href="#l1.835"></a><span id="l1.835">     return &quot;&quot;;</span>
<a href="#l1.836"></a><span id="l1.836"> </span>
<a href="#l1.837"></a><span id="l1.837">   // If user was previously editing an &quot;ftp&quot; url, then keep that as the new scheme</span>
<a href="#l1.838"></a><span id="l1.838">   var url;</span>
<a href="#l1.839"></a><span id="l1.839" class="difflineminus">-  var docScheme = GetScheme(GetDocumentUrl());</span>
<a href="#l1.840"></a><span id="l1.840"> </span>
<a href="#l1.841"></a><span id="l1.841">   // Always use the &quot;HTTP&quot; address if available</span>
<a href="#l1.842"></a><span id="l1.842">   // XXX Should we do some more validation here for bad urls???</span>
<a href="#l1.843"></a><span id="l1.843">   // Let's at least check for a scheme!</span>
<a href="#l1.844"></a><span id="l1.844">   if (!GetScheme(publishData.browseUrl))</span>
<a href="#l1.845"></a><span id="l1.845">     url = publishData.publishUrl;</span>
<a href="#l1.846"></a><span id="l1.846">   else</span>
<a href="#l1.847"></a><span id="l1.847">     url = publishData.browseUrl;</span>
<a href="#l1.848"></a><span id="l1.848"> </span>
<a href="#l1.849"></a><span id="l1.849">   url += FormatDirForPublishing(publishData.docDir) + publishData.filename;</span>
<a href="#l1.850"></a><span id="l1.850"> </span>
<a href="#l1.851"></a><span id="l1.851">   if (GetScheme(url) == &quot;ftp&quot;)</span>
<a href="#l1.852"></a><span id="l1.852">     url = InsertUsernameIntoUrl(url, publishData.username);</span>
<a href="#l1.853"></a><span id="l1.853"> </span>
<a href="#l1.854"></a><span id="l1.854">   return url;</span>
<a href="#l1.855"></a><span id="l1.855"> }</span>
<a href="#l1.856"></a><span id="l1.856" class="difflineplus">+/* eslint-enable */</span>
<a href="#l1.857"></a><span id="l1.857"> </span>
<a href="#l1.858"></a><span id="l1.858"> function SetSaveAndPublishUI(urlstring) {</span>
<a href="#l1.859"></a><span id="l1.859">   // Be sure enabled state of toolbar buttons are correct</span>
<a href="#l1.860"></a><span id="l1.860">   goUpdateCommand(&quot;cmd_save&quot;);</span>
<a href="#l1.861"></a><span id="l1.861">   goUpdateCommand(&quot;cmd_publish&quot;);</span>
<a href="#l1.862"></a><span id="l1.862"> }</span>
<a href="#l1.863"></a><span id="l1.863"> </span>
<a href="#l1.864"></a><span id="l1.864"> function SetDocumentEditable(isDocEditable) {</span>
<a href="#l1.865"></a><span id="l1.865" class="difflineat">@@ -1780,19 +1798,17 @@ function SetDocumentEditable(isDocEditab</span>
<a href="#l1.866"></a><span id="l1.866"> </span>
<a href="#l1.867"></a><span id="l1.867">     // update all commands</span>
<a href="#l1.868"></a><span id="l1.868">     window.updateCommands(&quot;create&quot;);</span>
<a href="#l1.869"></a><span id="l1.869">   }</span>
<a href="#l1.870"></a><span id="l1.870"> }</span>
<a href="#l1.871"></a><span id="l1.871"> </span>
<a href="#l1.872"></a><span id="l1.872"> // ****** end of save / publish **********//</span>
<a href="#l1.873"></a><span id="l1.873"> </span>
<a href="#l1.874"></a><span id="l1.874" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.875"></a><span id="l1.875" class="difflineminus">-var nsPublishSettingsCommand =</span>
<a href="#l1.876"></a><span id="l1.876" class="difflineminus">-{</span>
<a href="#l1.877"></a><span id="l1.877" class="difflineplus">+var nsPublishSettingsCommand = {</span>
<a href="#l1.878"></a><span id="l1.878">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.879"></a><span id="l1.879">     return (IsDocumentEditable());</span>
<a href="#l1.880"></a><span id="l1.880">   },</span>
<a href="#l1.881"></a><span id="l1.881"> </span>
<a href="#l1.882"></a><span id="l1.882">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.883"></a><span id="l1.883">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.884"></a><span id="l1.884"> </span>
<a href="#l1.885"></a><span id="l1.885">   doCommand(aCommand) {</span>
<a href="#l1.886"></a><span id="l1.886" class="difflineat">@@ -1801,19 +1817,17 @@ var nsPublishSettingsCommand =</span>
<a href="#l1.887"></a><span id="l1.887"> </span>
<a href="#l1.888"></a><span id="l1.888">       window.ok = window.openDialog(&quot;chrome://editor/content/EditorPublishSettings.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;, &quot;&quot;);</span>
<a href="#l1.889"></a><span id="l1.889">       return window.ok;</span>
<a href="#l1.890"></a><span id="l1.890">     }</span>
<a href="#l1.891"></a><span id="l1.891">     return false;</span>
<a href="#l1.892"></a><span id="l1.892">   },</span>
<a href="#l1.893"></a><span id="l1.893"> };</span>
<a href="#l1.894"></a><span id="l1.894"> </span>
<a href="#l1.895"></a><span id="l1.895" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.896"></a><span id="l1.896" class="difflineminus">-var nsRevertCommand =</span>
<a href="#l1.897"></a><span id="l1.897" class="difflineminus">-{</span>
<a href="#l1.898"></a><span id="l1.898" class="difflineplus">+var nsRevertCommand = {</span>
<a href="#l1.899"></a><span id="l1.899">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.900"></a><span id="l1.900">     return (IsDocumentEditable() &amp;&amp;</span>
<a href="#l1.901"></a><span id="l1.901">             IsDocumentModified() &amp;&amp;</span>
<a href="#l1.902"></a><span id="l1.902">             !IsUrlAboutBlank(GetDocumentUrl()));</span>
<a href="#l1.903"></a><span id="l1.903">   },</span>
<a href="#l1.904"></a><span id="l1.904"> </span>
<a href="#l1.905"></a><span id="l1.905">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.906"></a><span id="l1.906">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.907"></a><span id="l1.907" class="difflineat">@@ -1832,19 +1846,17 @@ var nsRevertCommand =</span>
<a href="#l1.908"></a><span id="l1.908">     // Reload page if first button (Revert) was pressed</span>
<a href="#l1.909"></a><span id="l1.909">     if (result == 0) {</span>
<a href="#l1.910"></a><span id="l1.910">       CancelHTMLSource();</span>
<a href="#l1.911"></a><span id="l1.911">       EditorLoadUrl(GetDocumentUrl());</span>
<a href="#l1.912"></a><span id="l1.912">     }</span>
<a href="#l1.913"></a><span id="l1.913">   },</span>
<a href="#l1.914"></a><span id="l1.914"> };</span>
<a href="#l1.915"></a><span id="l1.915"> </span>
<a href="#l1.916"></a><span id="l1.916" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.917"></a><span id="l1.917" class="difflineminus">-var nsCloseCommand =</span>
<a href="#l1.918"></a><span id="l1.918" class="difflineminus">-{</span>
<a href="#l1.919"></a><span id="l1.919" class="difflineplus">+var nsCloseCommand = {</span>
<a href="#l1.920"></a><span id="l1.920">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.921"></a><span id="l1.921">     return GetCurrentEditor() != null;</span>
<a href="#l1.922"></a><span id="l1.922">   },</span>
<a href="#l1.923"></a><span id="l1.923"> </span>
<a href="#l1.924"></a><span id="l1.924">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.925"></a><span id="l1.925">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.926"></a><span id="l1.926"> </span>
<a href="#l1.927"></a><span id="l1.927">   doCommand(aCommand) {</span>
<a href="#l1.928"></a><span id="l1.928" class="difflineat">@@ -1866,19 +1878,18 @@ async function CloseWindow() {</span>
<a href="#l1.929"></a><span id="l1.929">                       .treeOwner</span>
<a href="#l1.930"></a><span id="l1.930">                       .QueryInterface(Ci.nsIInterfaceRequestor)</span>
<a href="#l1.931"></a><span id="l1.931">                       .getInterface(Ci.nsIBaseWindow);</span>
<a href="#l1.932"></a><span id="l1.932">       basewin.destroy();</span>
<a href="#l1.933"></a><span id="l1.933">     } catch (e) {}</span>
<a href="#l1.934"></a><span id="l1.934">   }</span>
<a href="#l1.935"></a><span id="l1.935"> }</span>
<a href="#l1.936"></a><span id="l1.936"> </span>
<a href="#l1.937"></a><span id="l1.937" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.938"></a><span id="l1.938" class="difflineminus">-var nsOpenRemoteCommand =</span>
<a href="#l1.939"></a><span id="l1.939" class="difflineminus">-{</span>
<a href="#l1.940"></a><span id="l1.940" class="difflineplus">+/* eslint-disable */</span>
<a href="#l1.941"></a><span id="l1.941" class="difflineplus">+var nsOpenRemoteCommand = {</span>
<a href="#l1.942"></a><span id="l1.942">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.943"></a><span id="l1.943">     return true;    // we can always do this</span>
<a href="#l1.944"></a><span id="l1.944">   },</span>
<a href="#l1.945"></a><span id="l1.945"> </span>
<a href="#l1.946"></a><span id="l1.946">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.947"></a><span id="l1.947">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.948"></a><span id="l1.948"> </span>
<a href="#l1.949"></a><span id="l1.949">   doCommand(aCommand) {</span>
<a href="#l1.950"></a><span id="l1.950" class="difflineat">@@ -1905,20 +1916,19 @@ var nsOpenRemoteCommand =</span>
<a href="#l1.951"></a><span id="l1.951">       case &quot;4&quot;: // private</span>
<a href="#l1.952"></a><span id="l1.952">         openNewPrivateWith(params.url);</span>
<a href="#l1.953"></a><span id="l1.953">         break;</span>
<a href="#l1.954"></a><span id="l1.954">       default:</span>
<a href="#l1.955"></a><span id="l1.955">         break;</span>
<a href="#l1.956"></a><span id="l1.956">     }</span>
<a href="#l1.957"></a><span id="l1.957">   },</span>
<a href="#l1.958"></a><span id="l1.958"> };</span>
<a href="#l1.959"></a><span id="l1.959" class="difflineminus">-</span>
<a href="#l1.960"></a><span id="l1.960" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.961"></a><span id="l1.961" class="difflineminus">-var nsPreviewCommand =</span>
<a href="#l1.962"></a><span id="l1.962" class="difflineminus">-{</span>
<a href="#l1.963"></a><span id="l1.963" class="difflineplus">+/* eslint-enable */</span>
<a href="#l1.964"></a><span id="l1.964" class="difflineplus">+</span>
<a href="#l1.965"></a><span id="l1.965" class="difflineplus">+var nsPreviewCommand = {</span>
<a href="#l1.966"></a><span id="l1.966">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.967"></a><span id="l1.967">     return (IsDocumentEditable() &amp;&amp;</span>
<a href="#l1.968"></a><span id="l1.968">             IsHTMLEditor() &amp;&amp;</span>
<a href="#l1.969"></a><span id="l1.969">             (DocumentHasBeenSaved() || IsDocumentModified()));</span>
<a href="#l1.970"></a><span id="l1.970">   },</span>
<a href="#l1.971"></a><span id="l1.971"> </span>
<a href="#l1.972"></a><span id="l1.972">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.973"></a><span id="l1.973">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.974"></a><span id="l1.974" class="difflineat">@@ -1954,19 +1964,18 @@ var nsPreviewCommand =</span>
<a href="#l1.975"></a><span id="l1.975">           browser.BrowserReloadSkipCache();</span>
<a href="#l1.976"></a><span id="l1.976">           browser.focus();</span>
<a href="#l1.977"></a><span id="l1.977">         } catch (ex) {}</span>
<a href="#l1.978"></a><span id="l1.978">       }</span>
<a href="#l1.979"></a><span id="l1.979">     }</span>
<a href="#l1.980"></a><span id="l1.980">   },</span>
<a href="#l1.981"></a><span id="l1.981"> };</span>
<a href="#l1.982"></a><span id="l1.982"> </span>
<a href="#l1.983"></a><span id="l1.983" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.984"></a><span id="l1.984" class="difflineminus">-var nsSendPageCommand =</span>
<a href="#l1.985"></a><span id="l1.985" class="difflineminus">-{</span>
<a href="#l1.986"></a><span id="l1.986" class="difflineplus">+/* eslint-disable */</span>
<a href="#l1.987"></a><span id="l1.987" class="difflineplus">+var nsSendPageCommand = {</span>
<a href="#l1.988"></a><span id="l1.988">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.989"></a><span id="l1.989">     return (IsDocumentEditable() &amp;&amp;</span>
<a href="#l1.990"></a><span id="l1.990">             (DocumentHasBeenSaved() || IsDocumentModified()));</span>
<a href="#l1.991"></a><span id="l1.991">   },</span>
<a href="#l1.992"></a><span id="l1.992"> </span>
<a href="#l1.993"></a><span id="l1.993">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.994"></a><span id="l1.994">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.995"></a><span id="l1.995"> </span>
<a href="#l1.996"></a><span id="l1.996" class="difflineat">@@ -1976,24 +1985,25 @@ var nsSendPageCommand =</span>
<a href="#l1.997"></a><span id="l1.997">     if (!(await CheckAndSaveDocument(&quot;cmd_editSendPage&quot;, DocumentHasBeenSaved())))</span>
<a href="#l1.998"></a><span id="l1.998">       return;</span>
<a href="#l1.999"></a><span id="l1.999"> </span>
<a href="#l1.1000"></a><span id="l1.1000">     // Check if we saved again just in case?</span>
<a href="#l1.1001"></a><span id="l1.1001">     if (DocumentHasBeenSaved()) {</span>
<a href="#l1.1002"></a><span id="l1.1002">       // Launch Messenger Composer window with current page as contents</span>
<a href="#l1.1003"></a><span id="l1.1003">       try {</span>
<a href="#l1.1004"></a><span id="l1.1004">         openComposeWindow(GetDocumentUrl(), GetDocumentTitle());</span>
<a href="#l1.1005"></a><span id="l1.1005" class="difflineminus">-      } catch (ex) { dump(&quot;Cannot Send Page: &quot; + ex + &quot;\n&quot;); }</span>
<a href="#l1.1006"></a><span id="l1.1006" class="difflineplus">+      } catch (ex) {</span>
<a href="#l1.1007"></a><span id="l1.1007" class="difflineplus">+        dump(&quot;Cannot Send Page: &quot; + ex + &quot;\n&quot;);</span>
<a href="#l1.1008"></a><span id="l1.1008" class="difflineplus">+      }</span>
<a href="#l1.1009"></a><span id="l1.1009">     }</span>
<a href="#l1.1010"></a><span id="l1.1010">   },</span>
<a href="#l1.1011"></a><span id="l1.1011"> };</span>
<a href="#l1.1012"></a><span id="l1.1012" class="difflineminus">-</span>
<a href="#l1.1013"></a><span id="l1.1013" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1014"></a><span id="l1.1014" class="difflineminus">-var nsPrintCommand =</span>
<a href="#l1.1015"></a><span id="l1.1015" class="difflineminus">-{</span>
<a href="#l1.1016"></a><span id="l1.1016" class="difflineplus">+/* eslint-enable */</span>
<a href="#l1.1017"></a><span id="l1.1017" class="difflineplus">+</span>
<a href="#l1.1018"></a><span id="l1.1018" class="difflineplus">+var nsPrintCommand = {</span>
<a href="#l1.1019"></a><span id="l1.1019">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1020"></a><span id="l1.1020">     return true;    // we can always do this</span>
<a href="#l1.1021"></a><span id="l1.1021">   },</span>
<a href="#l1.1022"></a><span id="l1.1022"> </span>
<a href="#l1.1023"></a><span id="l1.1023">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1024"></a><span id="l1.1024">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1025"></a><span id="l1.1025"> </span>
<a href="#l1.1026"></a><span id="l1.1026">   doCommand(aCommand) {</span>
<a href="#l1.1027"></a><span id="l1.1027" class="difflineat">@@ -2001,120 +2011,108 @@ var nsPrintCommand =</span>
<a href="#l1.1028"></a><span id="l1.1028">     SetEditMode(gPreviousNonSourceDisplayMode);</span>
<a href="#l1.1029"></a><span id="l1.1029">     try {</span>
<a href="#l1.1030"></a><span id="l1.1030">       let browser = GetCurrentEditorElement();</span>
<a href="#l1.1031"></a><span id="l1.1031">       PrintUtils.printWindow(browser.outerWindowID, browser);</span>
<a href="#l1.1032"></a><span id="l1.1032">     } catch (e) {}</span>
<a href="#l1.1033"></a><span id="l1.1033">   },</span>
<a href="#l1.1034"></a><span id="l1.1034"> };</span>
<a href="#l1.1035"></a><span id="l1.1035"> </span>
<a href="#l1.1036"></a><span id="l1.1036" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1037"></a><span id="l1.1037" class="difflineminus">-var nsPrintPreviewCommand =</span>
<a href="#l1.1038"></a><span id="l1.1038" class="difflineminus">-{</span>
<a href="#l1.1039"></a><span id="l1.1039" class="difflineplus">+/* eslint-disable */</span>
<a href="#l1.1040"></a><span id="l1.1040" class="difflineplus">+var nsPrintPreviewCommand = {</span>
<a href="#l1.1041"></a><span id="l1.1041">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1042"></a><span id="l1.1042">     return true;    // we can always do this</span>
<a href="#l1.1043"></a><span id="l1.1043">   },</span>
<a href="#l1.1044"></a><span id="l1.1044"> </span>
<a href="#l1.1045"></a><span id="l1.1045">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1046"></a><span id="l1.1046">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1047"></a><span id="l1.1047"> </span>
<a href="#l1.1048"></a><span id="l1.1048">   doCommand(aCommand) {</span>
<a href="#l1.1049"></a><span id="l1.1049">     // In editor.js</span>
<a href="#l1.1050"></a><span id="l1.1050">     SetEditMode(gPreviousNonSourceDisplayMode);</span>
<a href="#l1.1051"></a><span id="l1.1051">     try {</span>
<a href="#l1.1052"></a><span id="l1.1052">       PrintUtils.printPreview(PrintPreviewListener);</span>
<a href="#l1.1053"></a><span id="l1.1053">     } catch (e) {}</span>
<a href="#l1.1054"></a><span id="l1.1054">   },</span>
<a href="#l1.1055"></a><span id="l1.1055"> };</span>
<a href="#l1.1056"></a><span id="l1.1056" class="difflineminus">-</span>
<a href="#l1.1057"></a><span id="l1.1057" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1058"></a><span id="l1.1058" class="difflineminus">-var nsPrintSetupCommand =</span>
<a href="#l1.1059"></a><span id="l1.1059" class="difflineminus">-{</span>
<a href="#l1.1060"></a><span id="l1.1060" class="difflineplus">+/* eslint-enable */</span>
<a href="#l1.1061"></a><span id="l1.1061" class="difflineplus">+</span>
<a href="#l1.1062"></a><span id="l1.1062" class="difflineplus">+var nsPrintSetupCommand = {</span>
<a href="#l1.1063"></a><span id="l1.1063">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1064"></a><span id="l1.1064">     return true;    // we can always do this</span>
<a href="#l1.1065"></a><span id="l1.1065">   },</span>
<a href="#l1.1066"></a><span id="l1.1066"> </span>
<a href="#l1.1067"></a><span id="l1.1067">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1068"></a><span id="l1.1068">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1069"></a><span id="l1.1069"> </span>
<a href="#l1.1070"></a><span id="l1.1070">   doCommand(aCommand) {</span>
<a href="#l1.1071"></a><span id="l1.1071">     // In editor.js</span>
<a href="#l1.1072"></a><span id="l1.1072">     SetEditMode(gPreviousNonSourceDisplayMode);</span>
<a href="#l1.1073"></a><span id="l1.1073">     PrintUtils.showPageSetup();</span>
<a href="#l1.1074"></a><span id="l1.1074">   },</span>
<a href="#l1.1075"></a><span id="l1.1075"> };</span>
<a href="#l1.1076"></a><span id="l1.1076"> </span>
<a href="#l1.1077"></a><span id="l1.1077" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1078"></a><span id="l1.1078" class="difflineminus">-var nsFindReplaceCommand =</span>
<a href="#l1.1079"></a><span id="l1.1079" class="difflineminus">-{</span>
<a href="#l1.1080"></a><span id="l1.1080" class="difflineplus">+var nsFindReplaceCommand = {</span>
<a href="#l1.1081"></a><span id="l1.1081">   isCommandEnabled(aCommand, editorElement) {</span>
<a href="#l1.1082"></a><span id="l1.1082">     return editorElement.getEditor(editorElement.contentWindow) != null;</span>
<a href="#l1.1083"></a><span id="l1.1083">   },</span>
<a href="#l1.1084"></a><span id="l1.1084"> </span>
<a href="#l1.1085"></a><span id="l1.1085">   getCommandStateParams(aCommand, aParams, editorElement) {},</span>
<a href="#l1.1086"></a><span id="l1.1086">   doCommandParams(aCommand, aParams, editorElement) {},</span>
<a href="#l1.1087"></a><span id="l1.1087"> </span>
<a href="#l1.1088"></a><span id="l1.1088">   doCommand(aCommand, editorElement) {</span>
<a href="#l1.1089"></a><span id="l1.1089">     window.openDialog(&quot;chrome://editor/content/EdReplace.xul&quot;, &quot;_blank&quot;,</span>
<a href="#l1.1090"></a><span id="l1.1090">                       &quot;chrome,modal,titlebar&quot;, editorElement);</span>
<a href="#l1.1091"></a><span id="l1.1091">   },</span>
<a href="#l1.1092"></a><span id="l1.1092"> };</span>
<a href="#l1.1093"></a><span id="l1.1093"> </span>
<a href="#l1.1094"></a><span id="l1.1094" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1095"></a><span id="l1.1095" class="difflineminus">-var nsFindCommand =</span>
<a href="#l1.1096"></a><span id="l1.1096" class="difflineminus">-{</span>
<a href="#l1.1097"></a><span id="l1.1097" class="difflineplus">+var nsFindCommand = {</span>
<a href="#l1.1098"></a><span id="l1.1098">   isCommandEnabled(aCommand, editorElement) {</span>
<a href="#l1.1099"></a><span id="l1.1099">     return editorElement.getEditor(editorElement.contentWindow) != null;</span>
<a href="#l1.1100"></a><span id="l1.1100">   },</span>
<a href="#l1.1101"></a><span id="l1.1101"> </span>
<a href="#l1.1102"></a><span id="l1.1102">   getCommandStateParams(aCommand, aParams, editorElement) {},</span>
<a href="#l1.1103"></a><span id="l1.1103">   doCommandParams(aCommand, aParams, editorElement) {},</span>
<a href="#l1.1104"></a><span id="l1.1104"> </span>
<a href="#l1.1105"></a><span id="l1.1105">   doCommand(aCommand, editorElement) {</span>
<a href="#l1.1106"></a><span id="l1.1106">     document.getElementById(&quot;FindToolbar&quot;).onFindCommand();</span>
<a href="#l1.1107"></a><span id="l1.1107">   },</span>
<a href="#l1.1108"></a><span id="l1.1108"> };</span>
<a href="#l1.1109"></a><span id="l1.1109"> </span>
<a href="#l1.1110"></a><span id="l1.1110" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1111"></a><span id="l1.1111" class="difflineminus">-var nsFindAgainCommand =</span>
<a href="#l1.1112"></a><span id="l1.1112" class="difflineminus">-{</span>
<a href="#l1.1113"></a><span id="l1.1113" class="difflineplus">+var nsFindAgainCommand = {</span>
<a href="#l1.1114"></a><span id="l1.1114">   isCommandEnabled(aCommand, editorElement) {</span>
<a href="#l1.1115"></a><span id="l1.1115">     // we can only do this if the search pattern is non-empty. Not sure how</span>
<a href="#l1.1116"></a><span id="l1.1116">     // to get that from here</span>
<a href="#l1.1117"></a><span id="l1.1117">     return editorElement.getEditor(editorElement.contentWindow) != null;</span>
<a href="#l1.1118"></a><span id="l1.1118">   },</span>
<a href="#l1.1119"></a><span id="l1.1119"> </span>
<a href="#l1.1120"></a><span id="l1.1120">   getCommandStateParams(aCommand, aParams, editorElement) {},</span>
<a href="#l1.1121"></a><span id="l1.1121">   doCommandParams(aCommand, aParams, editorElement) {},</span>
<a href="#l1.1122"></a><span id="l1.1122"> </span>
<a href="#l1.1123"></a><span id="l1.1123">   doCommand(aCommand, editorElement) {</span>
<a href="#l1.1124"></a><span id="l1.1124">     let findPrev = (aCommand == &quot;cmd_findPrev&quot;);</span>
<a href="#l1.1125"></a><span id="l1.1125">     document.getElementById(&quot;FindToolbar&quot;).onFindAgainCommand(findPrev);</span>
<a href="#l1.1126"></a><span id="l1.1126">   },</span>
<a href="#l1.1127"></a><span id="l1.1127"> };</span>
<a href="#l1.1128"></a><span id="l1.1128"> </span>
<a href="#l1.1129"></a><span id="l1.1129" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1130"></a><span id="l1.1130" class="difflineminus">-var nsRewrapCommand =</span>
<a href="#l1.1131"></a><span id="l1.1131" class="difflineminus">-{</span>
<a href="#l1.1132"></a><span id="l1.1132" class="difflineplus">+var nsRewrapCommand = {</span>
<a href="#l1.1133"></a><span id="l1.1133">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1134"></a><span id="l1.1134">     return (IsDocumentEditable() &amp;&amp; !IsInHTMLSourceMode() &amp;&amp;</span>
<a href="#l1.1135"></a><span id="l1.1135">             GetCurrentEditor() instanceof Ci.nsIEditorMailSupport);</span>
<a href="#l1.1136"></a><span id="l1.1136">   },</span>
<a href="#l1.1137"></a><span id="l1.1137"> </span>
<a href="#l1.1138"></a><span id="l1.1138">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1139"></a><span id="l1.1139">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1140"></a><span id="l1.1140"> </span>
<a href="#l1.1141"></a><span id="l1.1141">   doCommand(aCommand) {</span>
<a href="#l1.1142"></a><span id="l1.1142">     GetCurrentEditor().QueryInterface(Ci.nsIEditorMailSupport).rewrap(false);</span>
<a href="#l1.1143"></a><span id="l1.1143">   },</span>
<a href="#l1.1144"></a><span id="l1.1144"> };</span>
<a href="#l1.1145"></a><span id="l1.1145"> </span>
<a href="#l1.1146"></a><span id="l1.1146" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1147"></a><span id="l1.1147" class="difflineminus">-var nsSpellingCommand =</span>
<a href="#l1.1148"></a><span id="l1.1148" class="difflineminus">-{</span>
<a href="#l1.1149"></a><span id="l1.1149" class="difflineplus">+var nsSpellingCommand = {</span>
<a href="#l1.1150"></a><span id="l1.1150">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1151"></a><span id="l1.1151">     return (IsDocumentEditable() &amp;&amp;</span>
<a href="#l1.1152"></a><span id="l1.1152">             !IsInHTMLSourceMode() &amp;&amp; IsSpellCheckerInstalled());</span>
<a href="#l1.1153"></a><span id="l1.1153">   },</span>
<a href="#l1.1154"></a><span id="l1.1154"> </span>
<a href="#l1.1155"></a><span id="l1.1155">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1156"></a><span id="l1.1156">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1157"></a><span id="l1.1157"> </span>
<a href="#l1.1158"></a><span id="l1.1158" class="difflineat">@@ -2125,18 +2123,17 @@ var nsSpellingCommand =</span>
<a href="#l1.1159"></a><span id="l1.1159">       window.openDialog(&quot;chrome://editor/content/EdSpellCheck.xul&quot;, &quot;_blank&quot;,</span>
<a href="#l1.1160"></a><span id="l1.1160">               &quot;dialog,close,titlebar,modal,resizable&quot;, false, skipBlockQuotes, true);</span>
<a href="#l1.1161"></a><span id="l1.1161">     } catch (ex) {}</span>
<a href="#l1.1162"></a><span id="l1.1162">   },</span>
<a href="#l1.1163"></a><span id="l1.1163"> };</span>
<a href="#l1.1164"></a><span id="l1.1164"> </span>
<a href="#l1.1165"></a><span id="l1.1165"> // Validate using http://validator.w3.org/file-upload.html</span>
<a href="#l1.1166"></a><span id="l1.1166"> var URL2Validate;</span>
<a href="#l1.1167"></a><span id="l1.1167" class="difflineminus">-var nsValidateCommand =</span>
<a href="#l1.1168"></a><span id="l1.1168" class="difflineminus">-{</span>
<a href="#l1.1169"></a><span id="l1.1169" class="difflineplus">+var nsValidateCommand = {</span>
<a href="#l1.1170"></a><span id="l1.1170">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1171"></a><span id="l1.1171">     return GetCurrentEditor() != null;</span>
<a href="#l1.1172"></a><span id="l1.1172">   },</span>
<a href="#l1.1173"></a><span id="l1.1173"> </span>
<a href="#l1.1174"></a><span id="l1.1174">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1175"></a><span id="l1.1175">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1176"></a><span id="l1.1176"> </span>
<a href="#l1.1177"></a><span id="l1.1177">   async doCommand(aCommand) {</span>
<a href="#l1.1178"></a><span id="l1.1178" class="difflineat">@@ -2153,143 +2150,128 @@ var nsValidateCommand =</span>
<a href="#l1.1179"></a><span id="l1.1179"> </span>
<a href="#l1.1180"></a><span id="l1.1180">     URL2Validate = GetDocumentUrl();</span>
<a href="#l1.1181"></a><span id="l1.1181">     // See if it's a file:</span>
<a href="#l1.1182"></a><span id="l1.1182">     var ifile;</span>
<a href="#l1.1183"></a><span id="l1.1183">     try {</span>
<a href="#l1.1184"></a><span id="l1.1184">       var fileHandler = GetFileProtocolHandler();</span>
<a href="#l1.1185"></a><span id="l1.1185">       ifile = fileHandler.getFileFromURLSpec(URL2Validate);</span>
<a href="#l1.1186"></a><span id="l1.1186">       // nsIFile throws an exception if it's not a file url</span>
<a href="#l1.1187"></a><span id="l1.1187" class="difflineminus">-    } catch (e) { ifile = null; }</span>
<a href="#l1.1188"></a><span id="l1.1188" class="difflineplus">+    } catch (e) {</span>
<a href="#l1.1189"></a><span id="l1.1189" class="difflineplus">+      ifile = null;</span>
<a href="#l1.1190"></a><span id="l1.1190" class="difflineplus">+    }</span>
<a href="#l1.1191"></a><span id="l1.1191">     if (ifile) {</span>
<a href="#l1.1192"></a><span id="l1.1192">       URL2Validate = ifile.path;</span>
<a href="#l1.1193"></a><span id="l1.1193">       var vwin = window.open(&quot;http://validator.w3.org/file-upload.html&quot;,</span>
<a href="#l1.1194"></a><span id="l1.1194">                              &quot;EditorValidate&quot;);</span>
<a href="#l1.1195"></a><span id="l1.1195">       // Window loads asynchronously, so pass control to the load listener:</span>
<a href="#l1.1196"></a><span id="l1.1196">       vwin.addEventListener(&quot;load&quot;, this.validateFilePageLoaded);</span>
<a href="#l1.1197"></a><span id="l1.1197">     } else {</span>
<a href="#l1.1198"></a><span id="l1.1198" class="difflineminus">-      var vwin2 = window.open(&quot;http://validator.w3.org/check?uri=&quot;</span>
<a href="#l1.1199"></a><span id="l1.1199" class="difflineminus">-                              + URL2Validate</span>
<a href="#l1.1200"></a><span id="l1.1200" class="difflineminus">-                              + &quot;&amp;doctype=Inline&quot;,</span>
<a href="#l1.1201"></a><span id="l1.1201" class="difflineminus">-                              &quot;EditorValidate&quot;);</span>
<a href="#l1.1202"></a><span id="l1.1202" class="difflineplus">+      window.open(`http://validator.w3.org/check?uri=${URL2Validate}&amp;doctype=Inline`,</span>
<a href="#l1.1203"></a><span id="l1.1203" class="difflineplus">+                  &quot;EditorValidate&quot;);</span>
<a href="#l1.1204"></a><span id="l1.1204">       // This does the validation, no need to wait for page loaded.</span>
<a href="#l1.1205"></a><span id="l1.1205">     }</span>
<a href="#l1.1206"></a><span id="l1.1206">   },</span>
<a href="#l1.1207"></a><span id="l1.1207">   validateFilePageLoaded(event) {</span>
<a href="#l1.1208"></a><span id="l1.1208">     event.target.forms[0].uploaded_file.value = URL2Validate;</span>
<a href="#l1.1209"></a><span id="l1.1209">   },</span>
<a href="#l1.1210"></a><span id="l1.1210"> };</span>
<a href="#l1.1211"></a><span id="l1.1211"> </span>
<a href="#l1.1212"></a><span id="l1.1212" class="difflineminus">-var nsCheckLinksCommand =</span>
<a href="#l1.1213"></a><span id="l1.1213" class="difflineminus">-{</span>
<a href="#l1.1214"></a><span id="l1.1214" class="difflineplus">+var nsCheckLinksCommand = {</span>
<a href="#l1.1215"></a><span id="l1.1215">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1216"></a><span id="l1.1216">     return (IsDocumentEditable());</span>
<a href="#l1.1217"></a><span id="l1.1217">   },</span>
<a href="#l1.1218"></a><span id="l1.1218"> </span>
<a href="#l1.1219"></a><span id="l1.1219">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1220"></a><span id="l1.1220">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1221"></a><span id="l1.1221"> </span>
<a href="#l1.1222"></a><span id="l1.1222">   doCommand(aCommand) {</span>
<a href="#l1.1223"></a><span id="l1.1223">     window.openDialog(&quot;chrome://editor/content/EdLinkChecker.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;);</span>
<a href="#l1.1224"></a><span id="l1.1224">   },</span>
<a href="#l1.1225"></a><span id="l1.1225"> };</span>
<a href="#l1.1226"></a><span id="l1.1226"> </span>
<a href="#l1.1227"></a><span id="l1.1227" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1228"></a><span id="l1.1228" class="difflineminus">-var nsFormCommand =</span>
<a href="#l1.1229"></a><span id="l1.1229" class="difflineminus">-{</span>
<a href="#l1.1230"></a><span id="l1.1230" class="difflineplus">+var nsFormCommand = {</span>
<a href="#l1.1231"></a><span id="l1.1231">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1232"></a><span id="l1.1232">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1233"></a><span id="l1.1233">   },</span>
<a href="#l1.1234"></a><span id="l1.1234"> </span>
<a href="#l1.1235"></a><span id="l1.1235">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1236"></a><span id="l1.1236">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1237"></a><span id="l1.1237"> </span>
<a href="#l1.1238"></a><span id="l1.1238">   doCommand(aCommand) {</span>
<a href="#l1.1239"></a><span id="l1.1239">     window.openDialog(&quot;chrome://editor/content/EdFormProps.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;);</span>
<a href="#l1.1240"></a><span id="l1.1240">   },</span>
<a href="#l1.1241"></a><span id="l1.1241"> };</span>
<a href="#l1.1242"></a><span id="l1.1242"> </span>
<a href="#l1.1243"></a><span id="l1.1243" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1244"></a><span id="l1.1244" class="difflineminus">-var nsInputTagCommand =</span>
<a href="#l1.1245"></a><span id="l1.1245" class="difflineminus">-{</span>
<a href="#l1.1246"></a><span id="l1.1246" class="difflineplus">+var nsInputTagCommand = {</span>
<a href="#l1.1247"></a><span id="l1.1247">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1248"></a><span id="l1.1248">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1249"></a><span id="l1.1249">   },</span>
<a href="#l1.1250"></a><span id="l1.1250"> </span>
<a href="#l1.1251"></a><span id="l1.1251">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1252"></a><span id="l1.1252">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1253"></a><span id="l1.1253"> </span>
<a href="#l1.1254"></a><span id="l1.1254">   doCommand(aCommand) {</span>
<a href="#l1.1255"></a><span id="l1.1255">     window.openDialog(&quot;chrome://editor/content/EdInputProps.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;);</span>
<a href="#l1.1256"></a><span id="l1.1256">   },</span>
<a href="#l1.1257"></a><span id="l1.1257"> };</span>
<a href="#l1.1258"></a><span id="l1.1258"> </span>
<a href="#l1.1259"></a><span id="l1.1259" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1260"></a><span id="l1.1260" class="difflineminus">-var nsInputImageCommand =</span>
<a href="#l1.1261"></a><span id="l1.1261" class="difflineminus">-{</span>
<a href="#l1.1262"></a><span id="l1.1262" class="difflineplus">+var nsInputImageCommand = {</span>
<a href="#l1.1263"></a><span id="l1.1263">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1264"></a><span id="l1.1264">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1265"></a><span id="l1.1265">   },</span>
<a href="#l1.1266"></a><span id="l1.1266"> </span>
<a href="#l1.1267"></a><span id="l1.1267">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1268"></a><span id="l1.1268">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1269"></a><span id="l1.1269"> </span>
<a href="#l1.1270"></a><span id="l1.1270">   doCommand(aCommand) {</span>
<a href="#l1.1271"></a><span id="l1.1271">     window.openDialog(&quot;chrome://editor/content/EdInputImage.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;);</span>
<a href="#l1.1272"></a><span id="l1.1272">   },</span>
<a href="#l1.1273"></a><span id="l1.1273"> };</span>
<a href="#l1.1274"></a><span id="l1.1274"> </span>
<a href="#l1.1275"></a><span id="l1.1275" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1276"></a><span id="l1.1276" class="difflineminus">-var nsTextAreaCommand =</span>
<a href="#l1.1277"></a><span id="l1.1277" class="difflineminus">-{</span>
<a href="#l1.1278"></a><span id="l1.1278" class="difflineplus">+var nsTextAreaCommand = {</span>
<a href="#l1.1279"></a><span id="l1.1279">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1280"></a><span id="l1.1280">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1281"></a><span id="l1.1281">   },</span>
<a href="#l1.1282"></a><span id="l1.1282"> </span>
<a href="#l1.1283"></a><span id="l1.1283">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1284"></a><span id="l1.1284">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1285"></a><span id="l1.1285"> </span>
<a href="#l1.1286"></a><span id="l1.1286">   doCommand(aCommand) {</span>
<a href="#l1.1287"></a><span id="l1.1287">     window.openDialog(&quot;chrome://editor/content/EdTextAreaProps.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;);</span>
<a href="#l1.1288"></a><span id="l1.1288">   },</span>
<a href="#l1.1289"></a><span id="l1.1289"> };</span>
<a href="#l1.1290"></a><span id="l1.1290"> </span>
<a href="#l1.1291"></a><span id="l1.1291" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1292"></a><span id="l1.1292" class="difflineminus">-var nsSelectCommand =</span>
<a href="#l1.1293"></a><span id="l1.1293" class="difflineminus">-{</span>
<a href="#l1.1294"></a><span id="l1.1294" class="difflineplus">+var nsSelectCommand = {</span>
<a href="#l1.1295"></a><span id="l1.1295">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1296"></a><span id="l1.1296">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1297"></a><span id="l1.1297">   },</span>
<a href="#l1.1298"></a><span id="l1.1298"> </span>
<a href="#l1.1299"></a><span id="l1.1299">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1300"></a><span id="l1.1300">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1301"></a><span id="l1.1301"> </span>
<a href="#l1.1302"></a><span id="l1.1302">   doCommand(aCommand) {</span>
<a href="#l1.1303"></a><span id="l1.1303">     window.openDialog(&quot;chrome://editor/content/EdSelectProps.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;);</span>
<a href="#l1.1304"></a><span id="l1.1304">   },</span>
<a href="#l1.1305"></a><span id="l1.1305"> };</span>
<a href="#l1.1306"></a><span id="l1.1306"> </span>
<a href="#l1.1307"></a><span id="l1.1307" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1308"></a><span id="l1.1308" class="difflineminus">-var nsButtonCommand =</span>
<a href="#l1.1309"></a><span id="l1.1309" class="difflineminus">-{</span>
<a href="#l1.1310"></a><span id="l1.1310" class="difflineplus">+var nsButtonCommand = {</span>
<a href="#l1.1311"></a><span id="l1.1311">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1312"></a><span id="l1.1312">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1313"></a><span id="l1.1313">   },</span>
<a href="#l1.1314"></a><span id="l1.1314"> </span>
<a href="#l1.1315"></a><span id="l1.1315">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1316"></a><span id="l1.1316">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1317"></a><span id="l1.1317"> </span>
<a href="#l1.1318"></a><span id="l1.1318">   doCommand(aCommand) {</span>
<a href="#l1.1319"></a><span id="l1.1319">     window.openDialog(&quot;chrome://editor/content/EdButtonProps.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;);</span>
<a href="#l1.1320"></a><span id="l1.1320">   },</span>
<a href="#l1.1321"></a><span id="l1.1321"> };</span>
<a href="#l1.1322"></a><span id="l1.1322"> </span>
<a href="#l1.1323"></a><span id="l1.1323" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1324"></a><span id="l1.1324" class="difflineminus">-var nsLabelCommand =</span>
<a href="#l1.1325"></a><span id="l1.1325" class="difflineminus">-{</span>
<a href="#l1.1326"></a><span id="l1.1326" class="difflineplus">+var nsLabelCommand = {</span>
<a href="#l1.1327"></a><span id="l1.1327">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1328"></a><span id="l1.1328">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1329"></a><span id="l1.1329">   },</span>
<a href="#l1.1330"></a><span id="l1.1330"> </span>
<a href="#l1.1331"></a><span id="l1.1331">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1332"></a><span id="l1.1332">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1333"></a><span id="l1.1333"> </span>
<a href="#l1.1334"></a><span id="l1.1334">   doCommand(aCommand) {</span>
<a href="#l1.1335"></a><span id="l1.1335" class="difflineat">@@ -2307,34 +2289,30 @@ var nsLabelCommand =</span>
<a href="#l1.1336"></a><span id="l1.1336">         window.openDialog(&quot;chrome://editor/content/EdLabelProps.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;, labelElement);</span>
<a href="#l1.1337"></a><span id="l1.1337">       } else {</span>
<a href="#l1.1338"></a><span id="l1.1338">         EditorSetTextProperty(tagName, &quot;&quot;, &quot;&quot;);</span>
<a href="#l1.1339"></a><span id="l1.1339">       }</span>
<a href="#l1.1340"></a><span id="l1.1340">     } catch (e) {}</span>
<a href="#l1.1341"></a><span id="l1.1341">   },</span>
<a href="#l1.1342"></a><span id="l1.1342"> };</span>
<a href="#l1.1343"></a><span id="l1.1343"> </span>
<a href="#l1.1344"></a><span id="l1.1344" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1345"></a><span id="l1.1345" class="difflineminus">-var nsFieldSetCommand =</span>
<a href="#l1.1346"></a><span id="l1.1346" class="difflineminus">-{</span>
<a href="#l1.1347"></a><span id="l1.1347" class="difflineplus">+var nsFieldSetCommand = {</span>
<a href="#l1.1348"></a><span id="l1.1348">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1349"></a><span id="l1.1349">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1350"></a><span id="l1.1350">   },</span>
<a href="#l1.1351"></a><span id="l1.1351"> </span>
<a href="#l1.1352"></a><span id="l1.1352">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1353"></a><span id="l1.1353">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1354"></a><span id="l1.1354"> </span>
<a href="#l1.1355"></a><span id="l1.1355">   doCommand(aCommand) {</span>
<a href="#l1.1356"></a><span id="l1.1356">     window.openDialog(&quot;chrome://editor/content/EdFieldSetProps.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;);</span>
<a href="#l1.1357"></a><span id="l1.1357">   },</span>
<a href="#l1.1358"></a><span id="l1.1358"> };</span>
<a href="#l1.1359"></a><span id="l1.1359"> </span>
<a href="#l1.1360"></a><span id="l1.1360" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1361"></a><span id="l1.1361" class="difflineminus">-var nsIsIndexCommand =</span>
<a href="#l1.1362"></a><span id="l1.1362" class="difflineminus">-{</span>
<a href="#l1.1363"></a><span id="l1.1363" class="difflineplus">+var nsIsIndexCommand = {</span>
<a href="#l1.1364"></a><span id="l1.1364">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1365"></a><span id="l1.1365">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1366"></a><span id="l1.1366">   },</span>
<a href="#l1.1367"></a><span id="l1.1367"> </span>
<a href="#l1.1368"></a><span id="l1.1368">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1369"></a><span id="l1.1369">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1370"></a><span id="l1.1370"> </span>
<a href="#l1.1371"></a><span id="l1.1371">   doCommand(aCommand) {</span>
<a href="#l1.1372"></a><span id="l1.1372" class="difflineat">@@ -2342,34 +2320,30 @@ var nsIsIndexCommand =</span>
<a href="#l1.1373"></a><span id="l1.1373">       var editor = GetCurrentEditor();</span>
<a href="#l1.1374"></a><span id="l1.1374">       var isindexElement = editor.createElementWithDefaults(&quot;isindex&quot;);</span>
<a href="#l1.1375"></a><span id="l1.1375">       isindexElement.setAttribute(&quot;prompt&quot;, editor.outputToString(&quot;text/plain&quot;, kOutputSelectionOnly));</span>
<a href="#l1.1376"></a><span id="l1.1376">       editor.insertElementAtSelection(isindexElement, true);</span>
<a href="#l1.1377"></a><span id="l1.1377">     } catch (e) {}</span>
<a href="#l1.1378"></a><span id="l1.1378">   },</span>
<a href="#l1.1379"></a><span id="l1.1379"> };</span>
<a href="#l1.1380"></a><span id="l1.1380"> </span>
<a href="#l1.1381"></a><span id="l1.1381" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1382"></a><span id="l1.1382" class="difflineminus">-var nsImageCommand =</span>
<a href="#l1.1383"></a><span id="l1.1383" class="difflineminus">-{</span>
<a href="#l1.1384"></a><span id="l1.1384" class="difflineplus">+var nsImageCommand = {</span>
<a href="#l1.1385"></a><span id="l1.1385">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1386"></a><span id="l1.1386">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1387"></a><span id="l1.1387">   },</span>
<a href="#l1.1388"></a><span id="l1.1388"> </span>
<a href="#l1.1389"></a><span id="l1.1389">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1390"></a><span id="l1.1390">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1391"></a><span id="l1.1391"> </span>
<a href="#l1.1392"></a><span id="l1.1392">   doCommand(aCommand) {</span>
<a href="#l1.1393"></a><span id="l1.1393">     window.openDialog(&quot;chrome://editor/content/EdImageProps.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;);</span>
<a href="#l1.1394"></a><span id="l1.1394">   },</span>
<a href="#l1.1395"></a><span id="l1.1395"> };</span>
<a href="#l1.1396"></a><span id="l1.1396"> </span>
<a href="#l1.1397"></a><span id="l1.1397" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1398"></a><span id="l1.1398" class="difflineminus">-var nsHLineCommand =</span>
<a href="#l1.1399"></a><span id="l1.1399" class="difflineminus">-{</span>
<a href="#l1.1400"></a><span id="l1.1400" class="difflineplus">+var nsHLineCommand = {</span>
<a href="#l1.1401"></a><span id="l1.1401">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1402"></a><span id="l1.1402">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1403"></a><span id="l1.1403">   },</span>
<a href="#l1.1404"></a><span id="l1.1404"> </span>
<a href="#l1.1405"></a><span id="l1.1405">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1406"></a><span id="l1.1406">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1407"></a><span id="l1.1407"> </span>
<a href="#l1.1408"></a><span id="l1.1408">   doCommand(aCommand) {</span>
<a href="#l1.1409"></a><span id="l1.1409" class="difflineat">@@ -2378,17 +2352,19 @@ var nsHLineCommand =</span>
<a href="#l1.1410"></a><span id="l1.1410">     //  We get the last-used attributes from the prefs and insert immediately</span>
<a href="#l1.1411"></a><span id="l1.1411"> </span>
<a href="#l1.1412"></a><span id="l1.1412">     var tagName = &quot;hr&quot;;</span>
<a href="#l1.1413"></a><span id="l1.1413">     var editor = GetCurrentEditor();</span>
<a href="#l1.1414"></a><span id="l1.1414"> </span>
<a href="#l1.1415"></a><span id="l1.1415">     var hLine;</span>
<a href="#l1.1416"></a><span id="l1.1416">     try {</span>
<a href="#l1.1417"></a><span id="l1.1417">       hLine = editor.getSelectedElement(tagName);</span>
<a href="#l1.1418"></a><span id="l1.1418" class="difflineminus">-    } catch (e) { return; }</span>
<a href="#l1.1419"></a><span id="l1.1419" class="difflineplus">+    } catch (e) {</span>
<a href="#l1.1420"></a><span id="l1.1420" class="difflineplus">+      return;</span>
<a href="#l1.1421"></a><span id="l1.1421" class="difflineplus">+    }</span>
<a href="#l1.1422"></a><span id="l1.1422"> </span>
<a href="#l1.1423"></a><span id="l1.1423">     if (hLine) {</span>
<a href="#l1.1424"></a><span id="l1.1424">       // We only open the dialog for an existing HRule</span>
<a href="#l1.1425"></a><span id="l1.1425">       window.openDialog(&quot;chrome://editor/content/EdHLineProps.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;);</span>
<a href="#l1.1426"></a><span id="l1.1426">     } else {</span>
<a href="#l1.1427"></a><span id="l1.1427">       try {</span>
<a href="#l1.1428"></a><span id="l1.1428">         hLine = editor.createElementWithDefaults(tagName);</span>
<a href="#l1.1429"></a><span id="l1.1429"> </span>
<a href="#l1.1430"></a><span id="l1.1430" class="difflineat">@@ -2416,19 +2392,17 @@ var nsHLineCommand =</span>
<a href="#l1.1431"></a><span id="l1.1431">           hLine.setAttribute(&quot;noshade&quot;, &quot;noshade&quot;);</span>
<a href="#l1.1432"></a><span id="l1.1432"> </span>
<a href="#l1.1433"></a><span id="l1.1433">         editor.insertElementAtSelection(hLine, true);</span>
<a href="#l1.1434"></a><span id="l1.1434">       } catch (e) {}</span>
<a href="#l1.1435"></a><span id="l1.1435">     }</span>
<a href="#l1.1436"></a><span id="l1.1436">   },</span>
<a href="#l1.1437"></a><span id="l1.1437"> };</span>
<a href="#l1.1438"></a><span id="l1.1438"> </span>
<a href="#l1.1439"></a><span id="l1.1439" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1440"></a><span id="l1.1440" class="difflineminus">-var nsLinkCommand =</span>
<a href="#l1.1441"></a><span id="l1.1441" class="difflineminus">-{</span>
<a href="#l1.1442"></a><span id="l1.1442" class="difflineplus">+var nsLinkCommand = {</span>
<a href="#l1.1443"></a><span id="l1.1443">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1444"></a><span id="l1.1444">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1445"></a><span id="l1.1445">   },</span>
<a href="#l1.1446"></a><span id="l1.1446"> </span>
<a href="#l1.1447"></a><span id="l1.1447">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1448"></a><span id="l1.1448">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1449"></a><span id="l1.1449"> </span>
<a href="#l1.1450"></a><span id="l1.1450">   doCommand(aCommand) {</span>
<a href="#l1.1451"></a><span id="l1.1451" class="difflineat">@@ -2437,145 +2411,125 @@ var nsLinkCommand =</span>
<a href="#l1.1452"></a><span id="l1.1452">     var element = GetObjectForProperties();</span>
<a href="#l1.1453"></a><span id="l1.1453">     if (element &amp;&amp; element.nodeName.toLowerCase() == &quot;img&quot;)</span>
<a href="#l1.1454"></a><span id="l1.1454">       window.openDialog(&quot;chrome://editor/content/EdImageProps.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;, null, true);</span>
<a href="#l1.1455"></a><span id="l1.1455">     else</span>
<a href="#l1.1456"></a><span id="l1.1456">       window.openDialog(&quot;chrome://editor/content/EdLinkProps.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;);</span>
<a href="#l1.1457"></a><span id="l1.1457">   },</span>
<a href="#l1.1458"></a><span id="l1.1458"> };</span>
<a href="#l1.1459"></a><span id="l1.1459"> </span>
<a href="#l1.1460"></a><span id="l1.1460" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1461"></a><span id="l1.1461" class="difflineminus">-var nsAnchorCommand =</span>
<a href="#l1.1462"></a><span id="l1.1462" class="difflineminus">-{</span>
<a href="#l1.1463"></a><span id="l1.1463" class="difflineplus">+var nsAnchorCommand = {</span>
<a href="#l1.1464"></a><span id="l1.1464">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1465"></a><span id="l1.1465">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1466"></a><span id="l1.1466">   },</span>
<a href="#l1.1467"></a><span id="l1.1467"> </span>
<a href="#l1.1468"></a><span id="l1.1468">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1469"></a><span id="l1.1469">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1470"></a><span id="l1.1470"> </span>
<a href="#l1.1471"></a><span id="l1.1471">   doCommand(aCommand) {</span>
<a href="#l1.1472"></a><span id="l1.1472">     window.openDialog(&quot;chrome://editor/content/EdNamedAnchorProps.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;, &quot;&quot;);</span>
<a href="#l1.1473"></a><span id="l1.1473">   },</span>
<a href="#l1.1474"></a><span id="l1.1474"> };</span>
<a href="#l1.1475"></a><span id="l1.1475"> </span>
<a href="#l1.1476"></a><span id="l1.1476" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1477"></a><span id="l1.1477" class="difflineminus">-var nsInsertHTMLWithDialogCommand =</span>
<a href="#l1.1478"></a><span id="l1.1478" class="difflineminus">-{</span>
<a href="#l1.1479"></a><span id="l1.1479" class="difflineplus">+var nsInsertHTMLWithDialogCommand = {</span>
<a href="#l1.1480"></a><span id="l1.1480">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1481"></a><span id="l1.1481">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1482"></a><span id="l1.1482">   },</span>
<a href="#l1.1483"></a><span id="l1.1483"> </span>
<a href="#l1.1484"></a><span id="l1.1484">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1485"></a><span id="l1.1485">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1486"></a><span id="l1.1486"> </span>
<a href="#l1.1487"></a><span id="l1.1487">   doCommand(aCommand) {</span>
<a href="#l1.1488"></a><span id="l1.1488">     window.openDialog(&quot;chrome://editor/content/EdInsSrc.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal,resizable&quot;, &quot;&quot;);</span>
<a href="#l1.1489"></a><span id="l1.1489">   },</span>
<a href="#l1.1490"></a><span id="l1.1490"> };</span>
<a href="#l1.1491"></a><span id="l1.1491"> </span>
<a href="#l1.1492"></a><span id="l1.1492" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1493"></a><span id="l1.1493" class="difflineminus">-var nsInsertMathWithDialogCommand =</span>
<a href="#l1.1494"></a><span id="l1.1494" class="difflineminus">-{</span>
<a href="#l1.1495"></a><span id="l1.1495" class="difflineplus">+var nsInsertMathWithDialogCommand = {</span>
<a href="#l1.1496"></a><span id="l1.1496">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1497"></a><span id="l1.1497">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1498"></a><span id="l1.1498">   },</span>
<a href="#l1.1499"></a><span id="l1.1499"> </span>
<a href="#l1.1500"></a><span id="l1.1500">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1501"></a><span id="l1.1501">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1502"></a><span id="l1.1502"> </span>
<a href="#l1.1503"></a><span id="l1.1503">   doCommand(aCommand) {</span>
<a href="#l1.1504"></a><span id="l1.1504">     window.openDialog(&quot;chrome://editor/content/EdInsertMath.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal,resizable&quot;, &quot;&quot;);</span>
<a href="#l1.1505"></a><span id="l1.1505">   },</span>
<a href="#l1.1506"></a><span id="l1.1506"> };</span>
<a href="#l1.1507"></a><span id="l1.1507"> </span>
<a href="#l1.1508"></a><span id="l1.1508" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1509"></a><span id="l1.1509" class="difflineminus">-var nsInsertCharsCommand =</span>
<a href="#l1.1510"></a><span id="l1.1510" class="difflineminus">-{</span>
<a href="#l1.1511"></a><span id="l1.1511" class="difflineplus">+var nsInsertCharsCommand = {</span>
<a href="#l1.1512"></a><span id="l1.1512">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1513"></a><span id="l1.1513">     return (IsDocumentEditable());</span>
<a href="#l1.1514"></a><span id="l1.1514">   },</span>
<a href="#l1.1515"></a><span id="l1.1515"> </span>
<a href="#l1.1516"></a><span id="l1.1516">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1517"></a><span id="l1.1517">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1518"></a><span id="l1.1518"> </span>
<a href="#l1.1519"></a><span id="l1.1519">   doCommand(aCommand) {</span>
<a href="#l1.1520"></a><span id="l1.1520">     EditorFindOrCreateInsertCharWindow();</span>
<a href="#l1.1521"></a><span id="l1.1521">   },</span>
<a href="#l1.1522"></a><span id="l1.1522"> };</span>
<a href="#l1.1523"></a><span id="l1.1523"> </span>
<a href="#l1.1524"></a><span id="l1.1524" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1525"></a><span id="l1.1525" class="difflineminus">-var nsInsertBreakCommand =</span>
<a href="#l1.1526"></a><span id="l1.1526" class="difflineminus">-{</span>
<a href="#l1.1527"></a><span id="l1.1527" class="difflineplus">+var nsInsertBreakCommand = {</span>
<a href="#l1.1528"></a><span id="l1.1528">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1529"></a><span id="l1.1529">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1530"></a><span id="l1.1530">   },</span>
<a href="#l1.1531"></a><span id="l1.1531"> </span>
<a href="#l1.1532"></a><span id="l1.1532">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1533"></a><span id="l1.1533">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1534"></a><span id="l1.1534"> </span>
<a href="#l1.1535"></a><span id="l1.1535">   doCommand(aCommand) {</span>
<a href="#l1.1536"></a><span id="l1.1536">     try {</span>
<a href="#l1.1537"></a><span id="l1.1537">       GetCurrentEditor().insertHTML(&quot;&lt;br&gt;&quot;);</span>
<a href="#l1.1538"></a><span id="l1.1538">     } catch (e) {}</span>
<a href="#l1.1539"></a><span id="l1.1539">   },</span>
<a href="#l1.1540"></a><span id="l1.1540"> };</span>
<a href="#l1.1541"></a><span id="l1.1541"> </span>
<a href="#l1.1542"></a><span id="l1.1542" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1543"></a><span id="l1.1543" class="difflineminus">-var nsInsertBreakAllCommand =</span>
<a href="#l1.1544"></a><span id="l1.1544" class="difflineminus">-{</span>
<a href="#l1.1545"></a><span id="l1.1545" class="difflineplus">+var nsInsertBreakAllCommand = {</span>
<a href="#l1.1546"></a><span id="l1.1546">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1547"></a><span id="l1.1547">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1548"></a><span id="l1.1548">   },</span>
<a href="#l1.1549"></a><span id="l1.1549"> </span>
<a href="#l1.1550"></a><span id="l1.1550">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1551"></a><span id="l1.1551">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1552"></a><span id="l1.1552"> </span>
<a href="#l1.1553"></a><span id="l1.1553">   doCommand(aCommand) {</span>
<a href="#l1.1554"></a><span id="l1.1554">     try {</span>
<a href="#l1.1555"></a><span id="l1.1555">       GetCurrentEditor().insertHTML(&quot;&lt;br clear='all'&gt;&quot;);</span>
<a href="#l1.1556"></a><span id="l1.1556">     } catch (e) {}</span>
<a href="#l1.1557"></a><span id="l1.1557">   },</span>
<a href="#l1.1558"></a><span id="l1.1558"> };</span>
<a href="#l1.1559"></a><span id="l1.1559"> </span>
<a href="#l1.1560"></a><span id="l1.1560" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1561"></a><span id="l1.1561" class="difflineminus">-var nsGridCommand =</span>
<a href="#l1.1562"></a><span id="l1.1562" class="difflineminus">-{</span>
<a href="#l1.1563"></a><span id="l1.1563" class="difflineplus">+var nsGridCommand = {</span>
<a href="#l1.1564"></a><span id="l1.1564">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1565"></a><span id="l1.1565">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1566"></a><span id="l1.1566">   },</span>
<a href="#l1.1567"></a><span id="l1.1567"> </span>
<a href="#l1.1568"></a><span id="l1.1568">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1569"></a><span id="l1.1569">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1570"></a><span id="l1.1570"> </span>
<a href="#l1.1571"></a><span id="l1.1571">   doCommand(aCommand) {</span>
<a href="#l1.1572"></a><span id="l1.1572">     window.openDialog(&quot;chrome://editor/content/EdSnapToGrid.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;);</span>
<a href="#l1.1573"></a><span id="l1.1573">   },</span>
<a href="#l1.1574"></a><span id="l1.1574"> };</span>
<a href="#l1.1575"></a><span id="l1.1575"> </span>
<a href="#l1.1576"></a><span id="l1.1576" class="difflineminus">-</span>
<a href="#l1.1577"></a><span id="l1.1577" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1578"></a><span id="l1.1578" class="difflineminus">-var nsListPropertiesCommand =</span>
<a href="#l1.1579"></a><span id="l1.1579" class="difflineminus">-{</span>
<a href="#l1.1580"></a><span id="l1.1580" class="difflineplus">+var nsListPropertiesCommand = {</span>
<a href="#l1.1581"></a><span id="l1.1581">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1582"></a><span id="l1.1582">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1583"></a><span id="l1.1583">   },</span>
<a href="#l1.1584"></a><span id="l1.1584"> </span>
<a href="#l1.1585"></a><span id="l1.1585">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1586"></a><span id="l1.1586">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1587"></a><span id="l1.1587"> </span>
<a href="#l1.1588"></a><span id="l1.1588">   doCommand(aCommand) {</span>
<a href="#l1.1589"></a><span id="l1.1589">     window.openDialog(&quot;chrome://editor/content/EdListProps.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;);</span>
<a href="#l1.1590"></a><span id="l1.1590">   },</span>
<a href="#l1.1591"></a><span id="l1.1591"> };</span>
<a href="#l1.1592"></a><span id="l1.1592"> </span>
<a href="#l1.1593"></a><span id="l1.1593" class="difflineminus">-</span>
<a href="#l1.1594"></a><span id="l1.1594" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1595"></a><span id="l1.1595" class="difflineminus">-var nsPagePropertiesCommand =</span>
<a href="#l1.1596"></a><span id="l1.1596" class="difflineminus">-{</span>
<a href="#l1.1597"></a><span id="l1.1597" class="difflineplus">+var nsPagePropertiesCommand = {</span>
<a href="#l1.1598"></a><span id="l1.1598">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1599"></a><span id="l1.1599">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1600"></a><span id="l1.1600">   },</span>
<a href="#l1.1601"></a><span id="l1.1601"> </span>
<a href="#l1.1602"></a><span id="l1.1602">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1603"></a><span id="l1.1603">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1604"></a><span id="l1.1604"> </span>
<a href="#l1.1605"></a><span id="l1.1605">   doCommand(aCommand) {</span>
<a href="#l1.1606"></a><span id="l1.1606" class="difflineat">@@ -2584,19 +2538,17 @@ var nsPagePropertiesCommand =</span>
<a href="#l1.1607"></a><span id="l1.1607"> </span>
<a href="#l1.1608"></a><span id="l1.1608">     // Update main window title and</span>
<a href="#l1.1609"></a><span id="l1.1609">     // recent menu data in prefs if doc title changed</span>
<a href="#l1.1610"></a><span id="l1.1610">     if (GetDocumentTitle() != oldTitle)</span>
<a href="#l1.1611"></a><span id="l1.1611">       UpdateWindowTitle();</span>
<a href="#l1.1612"></a><span id="l1.1612">   },</span>
<a href="#l1.1613"></a><span id="l1.1613"> };</span>
<a href="#l1.1614"></a><span id="l1.1614"> </span>
<a href="#l1.1615"></a><span id="l1.1615" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1616"></a><span id="l1.1616" class="difflineminus">-var nsObjectPropertiesCommand =</span>
<a href="#l1.1617"></a><span id="l1.1617" class="difflineminus">-{</span>
<a href="#l1.1618"></a><span id="l1.1618" class="difflineplus">+var nsObjectPropertiesCommand = {</span>
<a href="#l1.1619"></a><span id="l1.1619">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1620"></a><span id="l1.1620">     var isEnabled = false;</span>
<a href="#l1.1621"></a><span id="l1.1621">     if (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML()) {</span>
<a href="#l1.1622"></a><span id="l1.1622">       isEnabled = (GetObjectForProperties() != null ||</span>
<a href="#l1.1623"></a><span id="l1.1623">                    GetCurrentEditor().getSelectedElement(&quot;href&quot;) != null);</span>
<a href="#l1.1624"></a><span id="l1.1624">     }</span>
<a href="#l1.1625"></a><span id="l1.1625">     return isEnabled;</span>
<a href="#l1.1626"></a><span id="l1.1626">   },</span>
<a href="#l1.1627"></a><span id="l1.1627" class="difflineat">@@ -2674,20 +2626,17 @@ var nsObjectPropertiesCommand =</span>
<a href="#l1.1628"></a><span id="l1.1628">         element = GetCurrentEditor().getSelectedElement(&quot;href&quot;);</span>
<a href="#l1.1629"></a><span id="l1.1629">       } catch (e) {}</span>
<a href="#l1.1630"></a><span id="l1.1630">       if (element)</span>
<a href="#l1.1631"></a><span id="l1.1631">         goDoCommand(&quot;cmd_link&quot;);</span>
<a href="#l1.1632"></a><span id="l1.1632">     }</span>
<a href="#l1.1633"></a><span id="l1.1633">   },</span>
<a href="#l1.1634"></a><span id="l1.1634"> };</span>
<a href="#l1.1635"></a><span id="l1.1635"> </span>
<a href="#l1.1636"></a><span id="l1.1636" class="difflineminus">-</span>
<a href="#l1.1637"></a><span id="l1.1637" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1638"></a><span id="l1.1638" class="difflineminus">-var nsSetSmiley =</span>
<a href="#l1.1639"></a><span id="l1.1639" class="difflineminus">-{</span>
<a href="#l1.1640"></a><span id="l1.1640" class="difflineplus">+var nsSetSmiley = {</span>
<a href="#l1.1641"></a><span id="l1.1641">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1642"></a><span id="l1.1642">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1643"></a><span id="l1.1643">   },</span>
<a href="#l1.1644"></a><span id="l1.1644"> </span>
<a href="#l1.1645"></a><span id="l1.1645">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1646"></a><span id="l1.1646">   doCommandParams(aCommand, aParams, aRefCon) {</span>
<a href="#l1.1647"></a><span id="l1.1647">     var smileyCode = aParams.getStringValue(&quot;state_attribute&quot;);</span>
<a href="#l1.1648"></a><span id="l1.1648"> </span>
<a href="#l1.1649"></a><span id="l1.1649" class="difflineat">@@ -2735,17 +2684,16 @@ var nsSetSmiley =</span>
<a href="#l1.1650"></a><span id="l1.1650">         case &quot;:-x&quot;: strSml = &quot;s16&quot;;</span>
<a href="#l1.1651"></a><span id="l1.1651">         break;</span>
<a href="#l1.1652"></a><span id="l1.1652">         default: strSml = &quot;&quot;;</span>
<a href="#l1.1653"></a><span id="l1.1653">         break;</span>
<a href="#l1.1654"></a><span id="l1.1654">     }</span>
<a href="#l1.1655"></a><span id="l1.1655"> </span>
<a href="#l1.1656"></a><span id="l1.1656">     try {</span>
<a href="#l1.1657"></a><span id="l1.1657">       var editor = GetCurrentEditor();</span>
<a href="#l1.1658"></a><span id="l1.1658" class="difflineminus">-      var selection = editor.selection;</span>
<a href="#l1.1659"></a><span id="l1.1659">       var extElement = editor.createElementWithDefaults(&quot;span&quot;);</span>
<a href="#l1.1660"></a><span id="l1.1660">       extElement.setAttribute(&quot;class&quot;, &quot;moz-smiley-&quot; + strSml);</span>
<a href="#l1.1661"></a><span id="l1.1661"> </span>
<a href="#l1.1662"></a><span id="l1.1662">       var intElement = editor.createElementWithDefaults(&quot;span&quot;);</span>
<a href="#l1.1663"></a><span id="l1.1663">       if (!intElement)</span>
<a href="#l1.1664"></a><span id="l1.1664">         return;</span>
<a href="#l1.1665"></a><span id="l1.1665"> </span>
<a href="#l1.1666"></a><span id="l1.1666">       var txtElement =  editor.document.createTextNode(smileyCode);</span>
<a href="#l1.1667"></a><span id="l1.1667" class="difflineat">@@ -2761,60 +2709,54 @@ var nsSetSmiley =</span>
<a href="#l1.1668"></a><span id="l1.1668">     } catch (e) {</span>
<a href="#l1.1669"></a><span id="l1.1669">         dump(&quot;Exception occurred in smiley InsertElementAtSelection\n&quot;);</span>
<a href="#l1.1670"></a><span id="l1.1670">     }</span>
<a href="#l1.1671"></a><span id="l1.1671">   },</span>
<a href="#l1.1672"></a><span id="l1.1672">   // This is now deprecated in favor of &quot;doCommandParams&quot;</span>
<a href="#l1.1673"></a><span id="l1.1673">   doCommand(aCommand) {},</span>
<a href="#l1.1674"></a><span id="l1.1674"> };</span>
<a href="#l1.1675"></a><span id="l1.1675"> </span>
<a href="#l1.1676"></a><span id="l1.1676" class="difflineminus">-</span>
<a href="#l1.1677"></a><span id="l1.1677"> function doAdvancedProperties(element) {</span>
<a href="#l1.1678"></a><span id="l1.1678">   if (element) {</span>
<a href="#l1.1679"></a><span id="l1.1679">     window.openDialog(&quot;chrome://editor/content/EdAdvancedEdit.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal,resizable=yes&quot;, &quot;&quot;, element);</span>
<a href="#l1.1680"></a><span id="l1.1680">   }</span>
<a href="#l1.1681"></a><span id="l1.1681"> }</span>
<a href="#l1.1682"></a><span id="l1.1682"> </span>
<a href="#l1.1683"></a><span id="l1.1683" class="difflineminus">-var nsAdvancedPropertiesCommand =</span>
<a href="#l1.1684"></a><span id="l1.1684" class="difflineminus">-{</span>
<a href="#l1.1685"></a><span id="l1.1685" class="difflineplus">+var nsAdvancedPropertiesCommand = {</span>
<a href="#l1.1686"></a><span id="l1.1686">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1687"></a><span id="l1.1687">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1688"></a><span id="l1.1688">   },</span>
<a href="#l1.1689"></a><span id="l1.1689"> </span>
<a href="#l1.1690"></a><span id="l1.1690">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1691"></a><span id="l1.1691">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1692"></a><span id="l1.1692"> </span>
<a href="#l1.1693"></a><span id="l1.1693">   doCommand(aCommand) {</span>
<a href="#l1.1694"></a><span id="l1.1694">     // Launch AdvancedEdit dialog for the selected element</span>
<a href="#l1.1695"></a><span id="l1.1695">     try {</span>
<a href="#l1.1696"></a><span id="l1.1696">       var element = GetCurrentEditor().getSelectedElement(&quot;&quot;);</span>
<a href="#l1.1697"></a><span id="l1.1697">       doAdvancedProperties(element);</span>
<a href="#l1.1698"></a><span id="l1.1698">     } catch (e) {}</span>
<a href="#l1.1699"></a><span id="l1.1699">   },</span>
<a href="#l1.1700"></a><span id="l1.1700"> };</span>
<a href="#l1.1701"></a><span id="l1.1701"> </span>
<a href="#l1.1702"></a><span id="l1.1702" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1703"></a><span id="l1.1703" class="difflineminus">-var nsColorPropertiesCommand =</span>
<a href="#l1.1704"></a><span id="l1.1704" class="difflineminus">-{</span>
<a href="#l1.1705"></a><span id="l1.1705" class="difflineplus">+var nsColorPropertiesCommand = {</span>
<a href="#l1.1706"></a><span id="l1.1706">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1707"></a><span id="l1.1707">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1708"></a><span id="l1.1708">   },</span>
<a href="#l1.1709"></a><span id="l1.1709"> </span>
<a href="#l1.1710"></a><span id="l1.1710">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1711"></a><span id="l1.1711">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1712"></a><span id="l1.1712"> </span>
<a href="#l1.1713"></a><span id="l1.1713">   doCommand(aCommand) {</span>
<a href="#l1.1714"></a><span id="l1.1714">     window.openDialog(&quot;chrome://editor/content/EdColorProps.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar,modal&quot;, &quot;&quot;);</span>
<a href="#l1.1715"></a><span id="l1.1715">     UpdateDefaultColors();</span>
<a href="#l1.1716"></a><span id="l1.1716">   },</span>
<a href="#l1.1717"></a><span id="l1.1717"> };</span>
<a href="#l1.1718"></a><span id="l1.1718"> </span>
<a href="#l1.1719"></a><span id="l1.1719" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1720"></a><span id="l1.1720" class="difflineminus">-var nsIncreaseFontCommand =</span>
<a href="#l1.1721"></a><span id="l1.1721" class="difflineminus">-{</span>
<a href="#l1.1722"></a><span id="l1.1722" class="difflineplus">+var nsIncreaseFontCommand = {</span>
<a href="#l1.1723"></a><span id="l1.1723">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1724"></a><span id="l1.1724">     if (!(IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML()))</span>
<a href="#l1.1725"></a><span id="l1.1725">       return false;</span>
<a href="#l1.1726"></a><span id="l1.1726">     var setIndex = getFontSizeIndex();</span>
<a href="#l1.1727"></a><span id="l1.1727">     return (setIndex &gt;= 0 &amp;&amp; setIndex &lt; 5);</span>
<a href="#l1.1728"></a><span id="l1.1728">   },</span>
<a href="#l1.1729"></a><span id="l1.1729"> </span>
<a href="#l1.1730"></a><span id="l1.1730">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1731"></a><span id="l1.1731" class="difflineat">@@ -2824,19 +2766,17 @@ var nsIncreaseFontCommand =</span>
<a href="#l1.1732"></a><span id="l1.1732">     var setIndex = getFontSizeIndex();</span>
<a href="#l1.1733"></a><span id="l1.1733">     if (setIndex &lt; 0 || setIndex &gt;= 5)</span>
<a href="#l1.1734"></a><span id="l1.1734">       return;</span>
<a href="#l1.1735"></a><span id="l1.1735">     var sizes = [&quot;x-small&quot;, &quot;small&quot;, &quot;medium&quot;, &quot;large&quot;, &quot;x-large&quot;, &quot;xx-large&quot; ];</span>
<a href="#l1.1736"></a><span id="l1.1736">     EditorSetFontSize(sizes[setIndex + 1]);</span>
<a href="#l1.1737"></a><span id="l1.1737">   },</span>
<a href="#l1.1738"></a><span id="l1.1738"> };</span>
<a href="#l1.1739"></a><span id="l1.1739"> </span>
<a href="#l1.1740"></a><span id="l1.1740" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1741"></a><span id="l1.1741" class="difflineminus">-var nsDecreaseFontCommand =</span>
<a href="#l1.1742"></a><span id="l1.1742" class="difflineminus">-{</span>
<a href="#l1.1743"></a><span id="l1.1743" class="difflineplus">+var nsDecreaseFontCommand = {</span>
<a href="#l1.1744"></a><span id="l1.1744">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1745"></a><span id="l1.1745">     if (!(IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML()))</span>
<a href="#l1.1746"></a><span id="l1.1746">       return false;</span>
<a href="#l1.1747"></a><span id="l1.1747">     var setIndex = getFontSizeIndex();</span>
<a href="#l1.1748"></a><span id="l1.1748">     return (setIndex &gt; 0);</span>
<a href="#l1.1749"></a><span id="l1.1749">   },</span>
<a href="#l1.1750"></a><span id="l1.1750"> </span>
<a href="#l1.1751"></a><span id="l1.1751">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1752"></a><span id="l1.1752" class="difflineat">@@ -2846,37 +2786,33 @@ var nsDecreaseFontCommand =</span>
<a href="#l1.1753"></a><span id="l1.1753">     var setIndex = getFontSizeIndex();</span>
<a href="#l1.1754"></a><span id="l1.1754">     if (setIndex &lt;= 0)</span>
<a href="#l1.1755"></a><span id="l1.1755">       return;</span>
<a href="#l1.1756"></a><span id="l1.1756">     var sizes = [&quot;x-small&quot;, &quot;small&quot;, &quot;medium&quot;, &quot;large&quot;, &quot;x-large&quot;, &quot;xx-large&quot; ];</span>
<a href="#l1.1757"></a><span id="l1.1757">     EditorSetFontSize(sizes[setIndex - 1]);</span>
<a href="#l1.1758"></a><span id="l1.1758">   },</span>
<a href="#l1.1759"></a><span id="l1.1759"> };</span>
<a href="#l1.1760"></a><span id="l1.1760"> </span>
<a href="#l1.1761"></a><span id="l1.1761" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1762"></a><span id="l1.1762" class="difflineminus">-var nsRemoveNamedAnchorsCommand =</span>
<a href="#l1.1763"></a><span id="l1.1763" class="difflineminus">-{</span>
<a href="#l1.1764"></a><span id="l1.1764" class="difflineplus">+var nsRemoveNamedAnchorsCommand = {</span>
<a href="#l1.1765"></a><span id="l1.1765">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1766"></a><span id="l1.1766">     // We could see if there's any link in selection, but it doesn't seem worth the work!</span>
<a href="#l1.1767"></a><span id="l1.1767">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1768"></a><span id="l1.1768">   },</span>
<a href="#l1.1769"></a><span id="l1.1769"> </span>
<a href="#l1.1770"></a><span id="l1.1770">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1771"></a><span id="l1.1771">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1772"></a><span id="l1.1772"> </span>
<a href="#l1.1773"></a><span id="l1.1773">   doCommand(aCommand) {</span>
<a href="#l1.1774"></a><span id="l1.1774">     EditorRemoveTextProperty(&quot;name&quot;, &quot;&quot;);</span>
<a href="#l1.1775"></a><span id="l1.1775">     window.content.focus();</span>
<a href="#l1.1776"></a><span id="l1.1776">   },</span>
<a href="#l1.1777"></a><span id="l1.1777"> };</span>
<a href="#l1.1778"></a><span id="l1.1778"> </span>
<a href="#l1.1779"></a><span id="l1.1779" class="difflineminus">-</span>
<a href="#l1.1780"></a><span id="l1.1780" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1781"></a><span id="l1.1781" class="difflineminus">-var nsEditLinkCommand =</span>
<a href="#l1.1782"></a><span id="l1.1782" class="difflineminus">-{</span>
<a href="#l1.1783"></a><span id="l1.1783" class="difflineplus">+/* eslint-disable */</span>
<a href="#l1.1784"></a><span id="l1.1784" class="difflineplus">+var nsEditLinkCommand = {</span>
<a href="#l1.1785"></a><span id="l1.1785">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1786"></a><span id="l1.1786">     // Not really used -- this command is only in context menu, and we do enabling there</span>
<a href="#l1.1787"></a><span id="l1.1787">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1788"></a><span id="l1.1788">   },</span>
<a href="#l1.1789"></a><span id="l1.1789"> </span>
<a href="#l1.1790"></a><span id="l1.1790">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1791"></a><span id="l1.1791">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1792"></a><span id="l1.1792"> </span>
<a href="#l1.1793"></a><span id="l1.1793" class="difflineat">@@ -2884,331 +2820,305 @@ var nsEditLinkCommand =</span>
<a href="#l1.1794"></a><span id="l1.1794">     try {</span>
<a href="#l1.1795"></a><span id="l1.1795">       var element = GetCurrentEditor().getSelectedElement(&quot;href&quot;);</span>
<a href="#l1.1796"></a><span id="l1.1796">       if (element)</span>
<a href="#l1.1797"></a><span id="l1.1797">         editPage(element.href);</span>
<a href="#l1.1798"></a><span id="l1.1798">     } catch (e) {}</span>
<a href="#l1.1799"></a><span id="l1.1799">     window.content.focus();</span>
<a href="#l1.1800"></a><span id="l1.1800">   },</span>
<a href="#l1.1801"></a><span id="l1.1801"> };</span>
<a href="#l1.1802"></a><span id="l1.1802" class="difflineminus">-</span>
<a href="#l1.1803"></a><span id="l1.1803" class="difflineminus">-</span>
<a href="#l1.1804"></a><span id="l1.1804" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1805"></a><span id="l1.1805" class="difflineminus">-var nsNormalModeCommand =</span>
<a href="#l1.1806"></a><span id="l1.1806" class="difflineminus">-{</span>
<a href="#l1.1807"></a><span id="l1.1807" class="difflineplus">+/* eslint-enable */</span>
<a href="#l1.1808"></a><span id="l1.1808" class="difflineplus">+</span>
<a href="#l1.1809"></a><span id="l1.1809" class="difflineplus">+var nsNormalModeCommand = {</span>
<a href="#l1.1810"></a><span id="l1.1810">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1811"></a><span id="l1.1811">     return IsHTMLEditor() &amp;&amp; IsDocumentEditable();</span>
<a href="#l1.1812"></a><span id="l1.1812">   },</span>
<a href="#l1.1813"></a><span id="l1.1813"> </span>
<a href="#l1.1814"></a><span id="l1.1814">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1815"></a><span id="l1.1815">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1816"></a><span id="l1.1816"> </span>
<a href="#l1.1817"></a><span id="l1.1817">   doCommand(aCommand) {</span>
<a href="#l1.1818"></a><span id="l1.1818">     SetEditMode(kDisplayModeNormal);</span>
<a href="#l1.1819"></a><span id="l1.1819">   },</span>
<a href="#l1.1820"></a><span id="l1.1820"> };</span>
<a href="#l1.1821"></a><span id="l1.1821"> </span>
<a href="#l1.1822"></a><span id="l1.1822" class="difflineminus">-var nsAllTagsModeCommand =</span>
<a href="#l1.1823"></a><span id="l1.1823" class="difflineminus">-{</span>
<a href="#l1.1824"></a><span id="l1.1824" class="difflineplus">+var nsAllTagsModeCommand = {</span>
<a href="#l1.1825"></a><span id="l1.1825">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1826"></a><span id="l1.1826">     return (IsDocumentEditable() &amp;&amp; IsHTMLEditor());</span>
<a href="#l1.1827"></a><span id="l1.1827">   },</span>
<a href="#l1.1828"></a><span id="l1.1828"> </span>
<a href="#l1.1829"></a><span id="l1.1829">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1830"></a><span id="l1.1830">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1831"></a><span id="l1.1831"> </span>
<a href="#l1.1832"></a><span id="l1.1832">   doCommand(aCommand) {</span>
<a href="#l1.1833"></a><span id="l1.1833">     SetEditMode(kDisplayModeAllTags);</span>
<a href="#l1.1834"></a><span id="l1.1834">   },</span>
<a href="#l1.1835"></a><span id="l1.1835"> };</span>
<a href="#l1.1836"></a><span id="l1.1836"> </span>
<a href="#l1.1837"></a><span id="l1.1837" class="difflineminus">-var nsHTMLSourceModeCommand =</span>
<a href="#l1.1838"></a><span id="l1.1838" class="difflineminus">-{</span>
<a href="#l1.1839"></a><span id="l1.1839" class="difflineplus">+var nsHTMLSourceModeCommand = {</span>
<a href="#l1.1840"></a><span id="l1.1840">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1841"></a><span id="l1.1841">     return (IsDocumentEditable() &amp;&amp; IsHTMLEditor());</span>
<a href="#l1.1842"></a><span id="l1.1842">   },</span>
<a href="#l1.1843"></a><span id="l1.1843"> </span>
<a href="#l1.1844"></a><span id="l1.1844">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1845"></a><span id="l1.1845">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1846"></a><span id="l1.1846"> </span>
<a href="#l1.1847"></a><span id="l1.1847">   doCommand(aCommand) {</span>
<a href="#l1.1848"></a><span id="l1.1848">     SetEditMode(kDisplayModeSource);</span>
<a href="#l1.1849"></a><span id="l1.1849">   },</span>
<a href="#l1.1850"></a><span id="l1.1850"> };</span>
<a href="#l1.1851"></a><span id="l1.1851"> </span>
<a href="#l1.1852"></a><span id="l1.1852" class="difflineminus">-var nsPreviewModeCommand =</span>
<a href="#l1.1853"></a><span id="l1.1853" class="difflineminus">-{</span>
<a href="#l1.1854"></a><span id="l1.1854" class="difflineplus">+var nsPreviewModeCommand = {</span>
<a href="#l1.1855"></a><span id="l1.1855">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1856"></a><span id="l1.1856">     return (IsDocumentEditable() &amp;&amp; IsHTMLEditor());</span>
<a href="#l1.1857"></a><span id="l1.1857">   },</span>
<a href="#l1.1858"></a><span id="l1.1858"> </span>
<a href="#l1.1859"></a><span id="l1.1859">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1860"></a><span id="l1.1860">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1861"></a><span id="l1.1861"> </span>
<a href="#l1.1862"></a><span id="l1.1862">   doCommand(aCommand) {</span>
<a href="#l1.1863"></a><span id="l1.1863">     SetEditMode(kDisplayModePreview);</span>
<a href="#l1.1864"></a><span id="l1.1864">   },</span>
<a href="#l1.1865"></a><span id="l1.1865"> };</span>
<a href="#l1.1866"></a><span id="l1.1866"> </span>
<a href="#l1.1867"></a><span id="l1.1867" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1868"></a><span id="l1.1868" class="difflineminus">-var nsInsertOrEditTableCommand =</span>
<a href="#l1.1869"></a><span id="l1.1869" class="difflineminus">-{</span>
<a href="#l1.1870"></a><span id="l1.1870" class="difflineplus">+var nsInsertOrEditTableCommand = {</span>
<a href="#l1.1871"></a><span id="l1.1871">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1872"></a><span id="l1.1872">     return (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML());</span>
<a href="#l1.1873"></a><span id="l1.1873">   },</span>
<a href="#l1.1874"></a><span id="l1.1874"> </span>
<a href="#l1.1875"></a><span id="l1.1875">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1876"></a><span id="l1.1876">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1877"></a><span id="l1.1877"> </span>
<a href="#l1.1878"></a><span id="l1.1878">   doCommand(aCommand) {</span>
<a href="#l1.1879"></a><span id="l1.1879">     if (IsInTableCell())</span>
<a href="#l1.1880"></a><span id="l1.1880">       EditorTableCellProperties();</span>
<a href="#l1.1881"></a><span id="l1.1881">     else</span>
<a href="#l1.1882"></a><span id="l1.1882">       EditorInsertOrEditTable(true);</span>
<a href="#l1.1883"></a><span id="l1.1883">   },</span>
<a href="#l1.1884"></a><span id="l1.1884"> };</span>
<a href="#l1.1885"></a><span id="l1.1885"> </span>
<a href="#l1.1886"></a><span id="l1.1886" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1887"></a><span id="l1.1887" class="difflineminus">-var nsEditTableCommand =</span>
<a href="#l1.1888"></a><span id="l1.1888" class="difflineminus">-{</span>
<a href="#l1.1889"></a><span id="l1.1889" class="difflineplus">+var nsEditTableCommand = {</span>
<a href="#l1.1890"></a><span id="l1.1890">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1891"></a><span id="l1.1891">     return IsInTable();</span>
<a href="#l1.1892"></a><span id="l1.1892">   },</span>
<a href="#l1.1893"></a><span id="l1.1893"> </span>
<a href="#l1.1894"></a><span id="l1.1894">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1895"></a><span id="l1.1895">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1896"></a><span id="l1.1896"> </span>
<a href="#l1.1897"></a><span id="l1.1897">   doCommand(aCommand) {</span>
<a href="#l1.1898"></a><span id="l1.1898">     EditorInsertOrEditTable(false);</span>
<a href="#l1.1899"></a><span id="l1.1899">   },</span>
<a href="#l1.1900"></a><span id="l1.1900"> };</span>
<a href="#l1.1901"></a><span id="l1.1901"> </span>
<a href="#l1.1902"></a><span id="l1.1902" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1903"></a><span id="l1.1903" class="difflineminus">-var nsSelectTableCommand =</span>
<a href="#l1.1904"></a><span id="l1.1904" class="difflineminus">-{</span>
<a href="#l1.1905"></a><span id="l1.1905" class="difflineplus">+var nsSelectTableCommand = {</span>
<a href="#l1.1906"></a><span id="l1.1906">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1907"></a><span id="l1.1907">     return IsInTable();</span>
<a href="#l1.1908"></a><span id="l1.1908">   },</span>
<a href="#l1.1909"></a><span id="l1.1909"> </span>
<a href="#l1.1910"></a><span id="l1.1910">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1911"></a><span id="l1.1911">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1912"></a><span id="l1.1912"> </span>
<a href="#l1.1913"></a><span id="l1.1913">   doCommand(aCommand) {</span>
<a href="#l1.1914"></a><span id="l1.1914">     try {</span>
<a href="#l1.1915"></a><span id="l1.1915">       GetCurrentTableEditor().selectTable();</span>
<a href="#l1.1916"></a><span id="l1.1916">     } catch (e) {}</span>
<a href="#l1.1917"></a><span id="l1.1917">     window.content.focus();</span>
<a href="#l1.1918"></a><span id="l1.1918">   },</span>
<a href="#l1.1919"></a><span id="l1.1919"> };</span>
<a href="#l1.1920"></a><span id="l1.1920"> </span>
<a href="#l1.1921"></a><span id="l1.1921" class="difflineminus">-var nsSelectTableRowCommand =</span>
<a href="#l1.1922"></a><span id="l1.1922" class="difflineminus">-{</span>
<a href="#l1.1923"></a><span id="l1.1923" class="difflineplus">+var nsSelectTableRowCommand = {</span>
<a href="#l1.1924"></a><span id="l1.1924">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1925"></a><span id="l1.1925">     return IsInTableCell();</span>
<a href="#l1.1926"></a><span id="l1.1926">   },</span>
<a href="#l1.1927"></a><span id="l1.1927"> </span>
<a href="#l1.1928"></a><span id="l1.1928">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1929"></a><span id="l1.1929">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1930"></a><span id="l1.1930"> </span>
<a href="#l1.1931"></a><span id="l1.1931">   doCommand(aCommand) {</span>
<a href="#l1.1932"></a><span id="l1.1932">     try {</span>
<a href="#l1.1933"></a><span id="l1.1933">       GetCurrentTableEditor().selectTableRow();</span>
<a href="#l1.1934"></a><span id="l1.1934">     } catch (e) {}</span>
<a href="#l1.1935"></a><span id="l1.1935">     window.content.focus();</span>
<a href="#l1.1936"></a><span id="l1.1936">   },</span>
<a href="#l1.1937"></a><span id="l1.1937"> };</span>
<a href="#l1.1938"></a><span id="l1.1938"> </span>
<a href="#l1.1939"></a><span id="l1.1939" class="difflineminus">-var nsSelectTableColumnCommand =</span>
<a href="#l1.1940"></a><span id="l1.1940" class="difflineminus">-{</span>
<a href="#l1.1941"></a><span id="l1.1941" class="difflineplus">+var nsSelectTableColumnCommand = {</span>
<a href="#l1.1942"></a><span id="l1.1942">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1943"></a><span id="l1.1943">     return IsInTableCell();</span>
<a href="#l1.1944"></a><span id="l1.1944">   },</span>
<a href="#l1.1945"></a><span id="l1.1945"> </span>
<a href="#l1.1946"></a><span id="l1.1946">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1947"></a><span id="l1.1947">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1948"></a><span id="l1.1948"> </span>
<a href="#l1.1949"></a><span id="l1.1949">   doCommand(aCommand) {</span>
<a href="#l1.1950"></a><span id="l1.1950">     try {</span>
<a href="#l1.1951"></a><span id="l1.1951">       GetCurrentTableEditor().selectTableColumn();</span>
<a href="#l1.1952"></a><span id="l1.1952">     } catch (e) {}</span>
<a href="#l1.1953"></a><span id="l1.1953">     window.content.focus();</span>
<a href="#l1.1954"></a><span id="l1.1954">   },</span>
<a href="#l1.1955"></a><span id="l1.1955"> };</span>
<a href="#l1.1956"></a><span id="l1.1956"> </span>
<a href="#l1.1957"></a><span id="l1.1957" class="difflineminus">-var nsSelectTableCellCommand =</span>
<a href="#l1.1958"></a><span id="l1.1958" class="difflineminus">-{</span>
<a href="#l1.1959"></a><span id="l1.1959" class="difflineplus">+var nsSelectTableCellCommand = {</span>
<a href="#l1.1960"></a><span id="l1.1960">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1961"></a><span id="l1.1961">     return IsInTableCell();</span>
<a href="#l1.1962"></a><span id="l1.1962">   },</span>
<a href="#l1.1963"></a><span id="l1.1963"> </span>
<a href="#l1.1964"></a><span id="l1.1964">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1965"></a><span id="l1.1965">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1966"></a><span id="l1.1966"> </span>
<a href="#l1.1967"></a><span id="l1.1967">   doCommand(aCommand) {</span>
<a href="#l1.1968"></a><span id="l1.1968">     try {</span>
<a href="#l1.1969"></a><span id="l1.1969">       GetCurrentTableEditor().selectTableCell();</span>
<a href="#l1.1970"></a><span id="l1.1970">     } catch (e) {}</span>
<a href="#l1.1971"></a><span id="l1.1971">     window.content.focus();</span>
<a href="#l1.1972"></a><span id="l1.1972">   },</span>
<a href="#l1.1973"></a><span id="l1.1973"> };</span>
<a href="#l1.1974"></a><span id="l1.1974"> </span>
<a href="#l1.1975"></a><span id="l1.1975" class="difflineminus">-var nsSelectAllTableCellsCommand =</span>
<a href="#l1.1976"></a><span id="l1.1976" class="difflineminus">-{</span>
<a href="#l1.1977"></a><span id="l1.1977" class="difflineplus">+var nsSelectAllTableCellsCommand = {</span>
<a href="#l1.1978"></a><span id="l1.1978">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1979"></a><span id="l1.1979">     return IsInTable();</span>
<a href="#l1.1980"></a><span id="l1.1980">   },</span>
<a href="#l1.1981"></a><span id="l1.1981"> </span>
<a href="#l1.1982"></a><span id="l1.1982">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1983"></a><span id="l1.1983">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.1984"></a><span id="l1.1984"> </span>
<a href="#l1.1985"></a><span id="l1.1985">   doCommand(aCommand) {</span>
<a href="#l1.1986"></a><span id="l1.1986">     try {</span>
<a href="#l1.1987"></a><span id="l1.1987">       GetCurrentTableEditor().selectAllTableCells();</span>
<a href="#l1.1988"></a><span id="l1.1988">     } catch (e) {}</span>
<a href="#l1.1989"></a><span id="l1.1989">     window.content.focus();</span>
<a href="#l1.1990"></a><span id="l1.1990">   },</span>
<a href="#l1.1991"></a><span id="l1.1991"> };</span>
<a href="#l1.1992"></a><span id="l1.1992"> </span>
<a href="#l1.1993"></a><span id="l1.1993" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.1994"></a><span id="l1.1994" class="difflineminus">-var nsInsertTableCommand =</span>
<a href="#l1.1995"></a><span id="l1.1995" class="difflineminus">-{</span>
<a href="#l1.1996"></a><span id="l1.1996" class="difflineplus">+var nsInsertTableCommand = {</span>
<a href="#l1.1997"></a><span id="l1.1997">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.1998"></a><span id="l1.1998">     return IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML();</span>
<a href="#l1.1999"></a><span id="l1.1999">   },</span>
<a href="#l1.2000"></a><span id="l1.2000"> </span>
<a href="#l1.2001"></a><span id="l1.2001">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2002"></a><span id="l1.2002">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2003"></a><span id="l1.2003"> </span>
<a href="#l1.2004"></a><span id="l1.2004">   doCommand(aCommand) {</span>
<a href="#l1.2005"></a><span id="l1.2005">     EditorInsertTable();</span>
<a href="#l1.2006"></a><span id="l1.2006">   },</span>
<a href="#l1.2007"></a><span id="l1.2007"> };</span>
<a href="#l1.2008"></a><span id="l1.2008"> </span>
<a href="#l1.2009"></a><span id="l1.2009" class="difflineminus">-var nsInsertTableRowAboveCommand =</span>
<a href="#l1.2010"></a><span id="l1.2010" class="difflineminus">-{</span>
<a href="#l1.2011"></a><span id="l1.2011" class="difflineplus">+var nsInsertTableRowAboveCommand = {</span>
<a href="#l1.2012"></a><span id="l1.2012">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2013"></a><span id="l1.2013">     return IsInTableCell();</span>
<a href="#l1.2014"></a><span id="l1.2014">   },</span>
<a href="#l1.2015"></a><span id="l1.2015"> </span>
<a href="#l1.2016"></a><span id="l1.2016">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2017"></a><span id="l1.2017">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2018"></a><span id="l1.2018"> </span>
<a href="#l1.2019"></a><span id="l1.2019">   doCommand(aCommand) {</span>
<a href="#l1.2020"></a><span id="l1.2020">     try {</span>
<a href="#l1.2021"></a><span id="l1.2021">       GetCurrentTableEditor().insertTableRow(1, false);</span>
<a href="#l1.2022"></a><span id="l1.2022">     } catch (e) {}</span>
<a href="#l1.2023"></a><span id="l1.2023">     window.content.focus();</span>
<a href="#l1.2024"></a><span id="l1.2024">   },</span>
<a href="#l1.2025"></a><span id="l1.2025"> };</span>
<a href="#l1.2026"></a><span id="l1.2026"> </span>
<a href="#l1.2027"></a><span id="l1.2027" class="difflineminus">-var nsInsertTableRowBelowCommand =</span>
<a href="#l1.2028"></a><span id="l1.2028" class="difflineminus">-{</span>
<a href="#l1.2029"></a><span id="l1.2029" class="difflineplus">+var nsInsertTableRowBelowCommand = {</span>
<a href="#l1.2030"></a><span id="l1.2030">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2031"></a><span id="l1.2031">     return IsInTableCell();</span>
<a href="#l1.2032"></a><span id="l1.2032">   },</span>
<a href="#l1.2033"></a><span id="l1.2033"> </span>
<a href="#l1.2034"></a><span id="l1.2034">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2035"></a><span id="l1.2035">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2036"></a><span id="l1.2036"> </span>
<a href="#l1.2037"></a><span id="l1.2037">   doCommand(aCommand) {</span>
<a href="#l1.2038"></a><span id="l1.2038">     try {</span>
<a href="#l1.2039"></a><span id="l1.2039">       GetCurrentTableEditor().insertTableRow(1, true);</span>
<a href="#l1.2040"></a><span id="l1.2040">     } catch (e) {}</span>
<a href="#l1.2041"></a><span id="l1.2041">     window.content.focus();</span>
<a href="#l1.2042"></a><span id="l1.2042">   },</span>
<a href="#l1.2043"></a><span id="l1.2043"> };</span>
<a href="#l1.2044"></a><span id="l1.2044"> </span>
<a href="#l1.2045"></a><span id="l1.2045" class="difflineminus">-var nsInsertTableColumnBeforeCommand =</span>
<a href="#l1.2046"></a><span id="l1.2046" class="difflineminus">-{</span>
<a href="#l1.2047"></a><span id="l1.2047" class="difflineplus">+var nsInsertTableColumnBeforeCommand = {</span>
<a href="#l1.2048"></a><span id="l1.2048">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2049"></a><span id="l1.2049">     return IsInTableCell();</span>
<a href="#l1.2050"></a><span id="l1.2050">   },</span>
<a href="#l1.2051"></a><span id="l1.2051"> </span>
<a href="#l1.2052"></a><span id="l1.2052">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2053"></a><span id="l1.2053">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2054"></a><span id="l1.2054"> </span>
<a href="#l1.2055"></a><span id="l1.2055">   doCommand(aCommand) {</span>
<a href="#l1.2056"></a><span id="l1.2056">     try {</span>
<a href="#l1.2057"></a><span id="l1.2057">       GetCurrentTableEditor().insertTableColumn(1, false);</span>
<a href="#l1.2058"></a><span id="l1.2058">     } catch (e) {}</span>
<a href="#l1.2059"></a><span id="l1.2059">     window.content.focus();</span>
<a href="#l1.2060"></a><span id="l1.2060">   },</span>
<a href="#l1.2061"></a><span id="l1.2061"> };</span>
<a href="#l1.2062"></a><span id="l1.2062"> </span>
<a href="#l1.2063"></a><span id="l1.2063" class="difflineminus">-var nsInsertTableColumnAfterCommand =</span>
<a href="#l1.2064"></a><span id="l1.2064" class="difflineminus">-{</span>
<a href="#l1.2065"></a><span id="l1.2065" class="difflineplus">+var nsInsertTableColumnAfterCommand = {</span>
<a href="#l1.2066"></a><span id="l1.2066">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2067"></a><span id="l1.2067">     return IsInTableCell();</span>
<a href="#l1.2068"></a><span id="l1.2068">   },</span>
<a href="#l1.2069"></a><span id="l1.2069"> </span>
<a href="#l1.2070"></a><span id="l1.2070">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2071"></a><span id="l1.2071">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2072"></a><span id="l1.2072"> </span>
<a href="#l1.2073"></a><span id="l1.2073">   doCommand(aCommand) {</span>
<a href="#l1.2074"></a><span id="l1.2074">     try {</span>
<a href="#l1.2075"></a><span id="l1.2075">       GetCurrentTableEditor().insertTableColumn(1, true);</span>
<a href="#l1.2076"></a><span id="l1.2076">     } catch (e) {}</span>
<a href="#l1.2077"></a><span id="l1.2077">     window.content.focus();</span>
<a href="#l1.2078"></a><span id="l1.2078">   },</span>
<a href="#l1.2079"></a><span id="l1.2079"> };</span>
<a href="#l1.2080"></a><span id="l1.2080"> </span>
<a href="#l1.2081"></a><span id="l1.2081" class="difflineminus">-var nsInsertTableCellBeforeCommand =</span>
<a href="#l1.2082"></a><span id="l1.2082" class="difflineminus">-{</span>
<a href="#l1.2083"></a><span id="l1.2083" class="difflineplus">+var nsInsertTableCellBeforeCommand = {</span>
<a href="#l1.2084"></a><span id="l1.2084">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2085"></a><span id="l1.2085">     return IsInTableCell();</span>
<a href="#l1.2086"></a><span id="l1.2086">   },</span>
<a href="#l1.2087"></a><span id="l1.2087"> </span>
<a href="#l1.2088"></a><span id="l1.2088">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2089"></a><span id="l1.2089">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2090"></a><span id="l1.2090"> </span>
<a href="#l1.2091"></a><span id="l1.2091">   doCommand(aCommand) {</span>
<a href="#l1.2092"></a><span id="l1.2092">     try {</span>
<a href="#l1.2093"></a><span id="l1.2093">       GetCurrentTableEditor().insertTableCell(1, false);</span>
<a href="#l1.2094"></a><span id="l1.2094">     } catch (e) {}</span>
<a href="#l1.2095"></a><span id="l1.2095">     window.content.focus();</span>
<a href="#l1.2096"></a><span id="l1.2096">   },</span>
<a href="#l1.2097"></a><span id="l1.2097"> };</span>
<a href="#l1.2098"></a><span id="l1.2098"> </span>
<a href="#l1.2099"></a><span id="l1.2099" class="difflineminus">-var nsInsertTableCellAfterCommand =</span>
<a href="#l1.2100"></a><span id="l1.2100" class="difflineminus">-{</span>
<a href="#l1.2101"></a><span id="l1.2101" class="difflineplus">+var nsInsertTableCellAfterCommand = {</span>
<a href="#l1.2102"></a><span id="l1.2102">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2103"></a><span id="l1.2103">     return IsInTableCell();</span>
<a href="#l1.2104"></a><span id="l1.2104">   },</span>
<a href="#l1.2105"></a><span id="l1.2105"> </span>
<a href="#l1.2106"></a><span id="l1.2106">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2107"></a><span id="l1.2107">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2108"></a><span id="l1.2108"> </span>
<a href="#l1.2109"></a><span id="l1.2109">   doCommand(aCommand) {</span>
<a href="#l1.2110"></a><span id="l1.2110">     try {</span>
<a href="#l1.2111"></a><span id="l1.2111">       GetCurrentTableEditor().insertTableCell(1, true);</span>
<a href="#l1.2112"></a><span id="l1.2112">     } catch (e) {}</span>
<a href="#l1.2113"></a><span id="l1.2113">     window.content.focus();</span>
<a href="#l1.2114"></a><span id="l1.2114">   },</span>
<a href="#l1.2115"></a><span id="l1.2115"> };</span>
<a href="#l1.2116"></a><span id="l1.2116"> </span>
<a href="#l1.2117"></a><span id="l1.2117" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.2118"></a><span id="l1.2118" class="difflineminus">-var nsDeleteTableCommand =</span>
<a href="#l1.2119"></a><span id="l1.2119" class="difflineminus">-{</span>
<a href="#l1.2120"></a><span id="l1.2120" class="difflineplus">+var nsDeleteTableCommand = {</span>
<a href="#l1.2121"></a><span id="l1.2121">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2122"></a><span id="l1.2122">     return IsInTable();</span>
<a href="#l1.2123"></a><span id="l1.2123">   },</span>
<a href="#l1.2124"></a><span id="l1.2124"> </span>
<a href="#l1.2125"></a><span id="l1.2125">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2126"></a><span id="l1.2126">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2127"></a><span id="l1.2127"> </span>
<a href="#l1.2128"></a><span id="l1.2128">   doCommand(aCommand) {</span>
<a href="#l1.2129"></a><span id="l1.2129">     try {</span>
<a href="#l1.2130"></a><span id="l1.2130">       GetCurrentTableEditor().deleteTable();</span>
<a href="#l1.2131"></a><span id="l1.2131">     } catch (e) {}</span>
<a href="#l1.2132"></a><span id="l1.2132">     window.content.focus();</span>
<a href="#l1.2133"></a><span id="l1.2133">   },</span>
<a href="#l1.2134"></a><span id="l1.2134"> };</span>
<a href="#l1.2135"></a><span id="l1.2135"> </span>
<a href="#l1.2136"></a><span id="l1.2136" class="difflineminus">-var nsDeleteTableRowCommand =</span>
<a href="#l1.2137"></a><span id="l1.2137" class="difflineminus">-{</span>
<a href="#l1.2138"></a><span id="l1.2138" class="difflineplus">+var nsDeleteTableRowCommand = {</span>
<a href="#l1.2139"></a><span id="l1.2139">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2140"></a><span id="l1.2140">     return IsInTableCell();</span>
<a href="#l1.2141"></a><span id="l1.2141">   },</span>
<a href="#l1.2142"></a><span id="l1.2142"> </span>
<a href="#l1.2143"></a><span id="l1.2143">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2144"></a><span id="l1.2144">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2145"></a><span id="l1.2145"> </span>
<a href="#l1.2146"></a><span id="l1.2146">   doCommand(aCommand) {</span>
<a href="#l1.2147"></a><span id="l1.2147" class="difflineat">@@ -3221,23 +3131,24 @@ var nsDeleteTableRowCommand =</span>
<a href="#l1.2148"></a><span id="l1.2148">       var editor = GetCurrentTableEditor();</span>
<a href="#l1.2149"></a><span id="l1.2149">       editor.beginTransaction();</span>
<a href="#l1.2150"></a><span id="l1.2150"> </span>
<a href="#l1.2151"></a><span id="l1.2151">       // Loop to delete all blocks of contiguous, selected rows</span>
<a href="#l1.2152"></a><span id="l1.2152">       while (rows) {</span>
<a href="#l1.2153"></a><span id="l1.2153">         editor.deleteTableRow(rows);</span>
<a href="#l1.2154"></a><span id="l1.2154">         rows = GetNumberOfContiguousSelectedRows();</span>
<a href="#l1.2155"></a><span id="l1.2155">       }</span>
<a href="#l1.2156"></a><span id="l1.2156" class="difflineminus">-    } finally { editor.endTransaction(); }</span>
<a href="#l1.2157"></a><span id="l1.2157" class="difflineplus">+    } finally {</span>
<a href="#l1.2158"></a><span id="l1.2158" class="difflineplus">+      editor.endTransaction();</span>
<a href="#l1.2159"></a><span id="l1.2159" class="difflineplus">+    }</span>
<a href="#l1.2160"></a><span id="l1.2160">     window.content.focus();</span>
<a href="#l1.2161"></a><span id="l1.2161">   },</span>
<a href="#l1.2162"></a><span id="l1.2162"> };</span>
<a href="#l1.2163"></a><span id="l1.2163"> </span>
<a href="#l1.2164"></a><span id="l1.2164" class="difflineminus">-var nsDeleteTableColumnCommand =</span>
<a href="#l1.2165"></a><span id="l1.2165" class="difflineminus">-{</span>
<a href="#l1.2166"></a><span id="l1.2166" class="difflineplus">+var nsDeleteTableColumnCommand = {</span>
<a href="#l1.2167"></a><span id="l1.2167">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2168"></a><span id="l1.2168">     return IsInTableCell();</span>
<a href="#l1.2169"></a><span id="l1.2169">   },</span>
<a href="#l1.2170"></a><span id="l1.2170"> </span>
<a href="#l1.2171"></a><span id="l1.2171">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2172"></a><span id="l1.2172">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2173"></a><span id="l1.2173"> </span>
<a href="#l1.2174"></a><span id="l1.2174">   doCommand(aCommand) {</span>
<a href="#l1.2175"></a><span id="l1.2175" class="difflineat">@@ -3250,78 +3161,73 @@ var nsDeleteTableColumnCommand =</span>
<a href="#l1.2176"></a><span id="l1.2176">       var editor = GetCurrentTableEditor();</span>
<a href="#l1.2177"></a><span id="l1.2177">       editor.beginTransaction();</span>
<a href="#l1.2178"></a><span id="l1.2178"> </span>
<a href="#l1.2179"></a><span id="l1.2179">       // Loop to delete all blocks of contiguous, selected columns</span>
<a href="#l1.2180"></a><span id="l1.2180">       while (columns) {</span>
<a href="#l1.2181"></a><span id="l1.2181">         editor.deleteTableColumn(columns);</span>
<a href="#l1.2182"></a><span id="l1.2182">         columns = GetNumberOfContiguousSelectedColumns();</span>
<a href="#l1.2183"></a><span id="l1.2183">       }</span>
<a href="#l1.2184"></a><span id="l1.2184" class="difflineminus">-    } finally { editor.endTransaction(); }</span>
<a href="#l1.2185"></a><span id="l1.2185" class="difflineplus">+    } finally {</span>
<a href="#l1.2186"></a><span id="l1.2186" class="difflineplus">+      editor.endTransaction();</span>
<a href="#l1.2187"></a><span id="l1.2187" class="difflineplus">+    }</span>
<a href="#l1.2188"></a><span id="l1.2188">     window.content.focus();</span>
<a href="#l1.2189"></a><span id="l1.2189">   },</span>
<a href="#l1.2190"></a><span id="l1.2190"> };</span>
<a href="#l1.2191"></a><span id="l1.2191"> </span>
<a href="#l1.2192"></a><span id="l1.2192" class="difflineminus">-var nsDeleteTableCellCommand =</span>
<a href="#l1.2193"></a><span id="l1.2193" class="difflineminus">-{</span>
<a href="#l1.2194"></a><span id="l1.2194" class="difflineplus">+var nsDeleteTableCellCommand = {</span>
<a href="#l1.2195"></a><span id="l1.2195">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2196"></a><span id="l1.2196">     return IsInTableCell();</span>
<a href="#l1.2197"></a><span id="l1.2197">   },</span>
<a href="#l1.2198"></a><span id="l1.2198"> </span>
<a href="#l1.2199"></a><span id="l1.2199">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2200"></a><span id="l1.2200">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2201"></a><span id="l1.2201"> </span>
<a href="#l1.2202"></a><span id="l1.2202">   doCommand(aCommand) {</span>
<a href="#l1.2203"></a><span id="l1.2203">     try {</span>
<a href="#l1.2204"></a><span id="l1.2204">       GetCurrentTableEditor().deleteTableCell(1);</span>
<a href="#l1.2205"></a><span id="l1.2205">     } catch (e) {}</span>
<a href="#l1.2206"></a><span id="l1.2206">     window.content.focus();</span>
<a href="#l1.2207"></a><span id="l1.2207">   },</span>
<a href="#l1.2208"></a><span id="l1.2208"> };</span>
<a href="#l1.2209"></a><span id="l1.2209"> </span>
<a href="#l1.2210"></a><span id="l1.2210" class="difflineminus">-var nsDeleteTableCellContentsCommand =</span>
<a href="#l1.2211"></a><span id="l1.2211" class="difflineminus">-{</span>
<a href="#l1.2212"></a><span id="l1.2212" class="difflineplus">+var nsDeleteTableCellContentsCommand = {</span>
<a href="#l1.2213"></a><span id="l1.2213">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2214"></a><span id="l1.2214">     return IsInTableCell();</span>
<a href="#l1.2215"></a><span id="l1.2215">   },</span>
<a href="#l1.2216"></a><span id="l1.2216"> </span>
<a href="#l1.2217"></a><span id="l1.2217">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2218"></a><span id="l1.2218">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2219"></a><span id="l1.2219"> </span>
<a href="#l1.2220"></a><span id="l1.2220">   doCommand(aCommand) {</span>
<a href="#l1.2221"></a><span id="l1.2221">     try {</span>
<a href="#l1.2222"></a><span id="l1.2222">       GetCurrentTableEditor().deleteTableCellContents();</span>
<a href="#l1.2223"></a><span id="l1.2223">     } catch (e) {}</span>
<a href="#l1.2224"></a><span id="l1.2224">     window.content.focus();</span>
<a href="#l1.2225"></a><span id="l1.2225">   },</span>
<a href="#l1.2226"></a><span id="l1.2226"> };</span>
<a href="#l1.2227"></a><span id="l1.2227"> </span>
<a href="#l1.2228"></a><span id="l1.2228" class="difflineminus">-</span>
<a href="#l1.2229"></a><span id="l1.2229" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.2230"></a><span id="l1.2230" class="difflineminus">-var nsNormalizeTableCommand =</span>
<a href="#l1.2231"></a><span id="l1.2231" class="difflineminus">-{</span>
<a href="#l1.2232"></a><span id="l1.2232" class="difflineplus">+var nsNormalizeTableCommand = {</span>
<a href="#l1.2233"></a><span id="l1.2233">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2234"></a><span id="l1.2234">     return IsInTable();</span>
<a href="#l1.2235"></a><span id="l1.2235">   },</span>
<a href="#l1.2236"></a><span id="l1.2236"> </span>
<a href="#l1.2237"></a><span id="l1.2237">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2238"></a><span id="l1.2238">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2239"></a><span id="l1.2239"> </span>
<a href="#l1.2240"></a><span id="l1.2240">   doCommand(aCommand) {</span>
<a href="#l1.2241"></a><span id="l1.2241">     // Use nullptr to let editor find table enclosing current selection</span>
<a href="#l1.2242"></a><span id="l1.2242">     try {</span>
<a href="#l1.2243"></a><span id="l1.2243">       GetCurrentTableEditor().normalizeTable(null);</span>
<a href="#l1.2244"></a><span id="l1.2244">     } catch (e) {}</span>
<a href="#l1.2245"></a><span id="l1.2245">     window.content.focus();</span>
<a href="#l1.2246"></a><span id="l1.2246">   },</span>
<a href="#l1.2247"></a><span id="l1.2247"> };</span>
<a href="#l1.2248"></a><span id="l1.2248"> </span>
<a href="#l1.2249"></a><span id="l1.2249" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.2250"></a><span id="l1.2250" class="difflineminus">-var nsJoinTableCellsCommand =</span>
<a href="#l1.2251"></a><span id="l1.2251" class="difflineminus">-{</span>
<a href="#l1.2252"></a><span id="l1.2252" class="difflineplus">+var nsJoinTableCellsCommand = {</span>
<a href="#l1.2253"></a><span id="l1.2253">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2254"></a><span id="l1.2254">     if (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML()) {</span>
<a href="#l1.2255"></a><span id="l1.2255">       try {</span>
<a href="#l1.2256"></a><span id="l1.2256">         var editor = GetCurrentTableEditor();</span>
<a href="#l1.2257"></a><span id="l1.2257">         var tagNameObj = { value: &quot;&quot; };</span>
<a href="#l1.2258"></a><span id="l1.2258">         var countObj = { value: 0 };</span>
<a href="#l1.2259"></a><span id="l1.2259">         var cell = editor.getSelectedOrParentTableElement(tagNameObj, countObj);</span>
<a href="#l1.2260"></a><span id="l1.2260"> </span>
<a href="#l1.2261"></a><span id="l1.2261" class="difflineat">@@ -3364,19 +3270,17 @@ var nsJoinTableCellsCommand =</span>
<a href="#l1.2262"></a><span id="l1.2262">     // Param: Don't merge non-contiguous cells</span>
<a href="#l1.2263"></a><span id="l1.2263">     try {</span>
<a href="#l1.2264"></a><span id="l1.2264">       GetCurrentTableEditor().joinTableCells(false);</span>
<a href="#l1.2265"></a><span id="l1.2265">     } catch (e) {}</span>
<a href="#l1.2266"></a><span id="l1.2266">     window.content.focus();</span>
<a href="#l1.2267"></a><span id="l1.2267">   },</span>
<a href="#l1.2268"></a><span id="l1.2268"> };</span>
<a href="#l1.2269"></a><span id="l1.2269"> </span>
<a href="#l1.2270"></a><span id="l1.2270" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.2271"></a><span id="l1.2271" class="difflineminus">-var nsSplitTableCellCommand =</span>
<a href="#l1.2272"></a><span id="l1.2272" class="difflineminus">-{</span>
<a href="#l1.2273"></a><span id="l1.2273" class="difflineplus">+var nsSplitTableCellCommand = {</span>
<a href="#l1.2274"></a><span id="l1.2274">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2275"></a><span id="l1.2275">     if (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML()) {</span>
<a href="#l1.2276"></a><span id="l1.2276">       var tagNameObj = { value: &quot;&quot; };</span>
<a href="#l1.2277"></a><span id="l1.2277">       var countObj = { value: 0 };</span>
<a href="#l1.2278"></a><span id="l1.2278">       var cell;</span>
<a href="#l1.2279"></a><span id="l1.2279">       try {</span>
<a href="#l1.2280"></a><span id="l1.2280">         cell = GetCurrentTableEditor().getSelectedOrParentTableElement(tagNameObj, countObj);</span>
<a href="#l1.2281"></a><span id="l1.2281">       } catch (e) {}</span>
<a href="#l1.2282"></a><span id="l1.2282" class="difflineat">@@ -3403,79 +3307,73 @@ var nsSplitTableCellCommand =</span>
<a href="#l1.2283"></a><span id="l1.2283">   doCommand(aCommand) {</span>
<a href="#l1.2284"></a><span id="l1.2284">     try {</span>
<a href="#l1.2285"></a><span id="l1.2285">       GetCurrentTableEditor().splitTableCell();</span>
<a href="#l1.2286"></a><span id="l1.2286">     } catch (e) {}</span>
<a href="#l1.2287"></a><span id="l1.2287">     window.content.focus();</span>
<a href="#l1.2288"></a><span id="l1.2288">   },</span>
<a href="#l1.2289"></a><span id="l1.2289"> };</span>
<a href="#l1.2290"></a><span id="l1.2290"> </span>
<a href="#l1.2291"></a><span id="l1.2291" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.2292"></a><span id="l1.2292" class="difflineminus">-var nsTableOrCellColorCommand =</span>
<a href="#l1.2293"></a><span id="l1.2293" class="difflineminus">-{</span>
<a href="#l1.2294"></a><span id="l1.2294" class="difflineplus">+var nsTableOrCellColorCommand = {</span>
<a href="#l1.2295"></a><span id="l1.2295">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2296"></a><span id="l1.2296">     return IsInTable();</span>
<a href="#l1.2297"></a><span id="l1.2297">   },</span>
<a href="#l1.2298"></a><span id="l1.2298"> </span>
<a href="#l1.2299"></a><span id="l1.2299">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2300"></a><span id="l1.2300">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2301"></a><span id="l1.2301"> </span>
<a href="#l1.2302"></a><span id="l1.2302">   doCommand(aCommand) {</span>
<a href="#l1.2303"></a><span id="l1.2303">     EditorSelectColor(&quot;TableOrCell&quot;);</span>
<a href="#l1.2304"></a><span id="l1.2304">   },</span>
<a href="#l1.2305"></a><span id="l1.2305"> };</span>
<a href="#l1.2306"></a><span id="l1.2306"> </span>
<a href="#l1.2307"></a><span id="l1.2307" class="difflineminus">-// -----------------------------------------------------------------------------------</span>
<a href="#l1.2308"></a><span id="l1.2308" class="difflineminus">-var nsPreferencesCommand =</span>
<a href="#l1.2309"></a><span id="l1.2309" class="difflineminus">-{</span>
<a href="#l1.2310"></a><span id="l1.2310" class="difflineplus">+/* eslint-disable */</span>
<a href="#l1.2311"></a><span id="l1.2311" class="difflineplus">+var nsPreferencesCommand = {</span>
<a href="#l1.2312"></a><span id="l1.2312">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2313"></a><span id="l1.2313">     return true;</span>
<a href="#l1.2314"></a><span id="l1.2314">   },</span>
<a href="#l1.2315"></a><span id="l1.2315"> </span>
<a href="#l1.2316"></a><span id="l1.2316">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2317"></a><span id="l1.2317">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2318"></a><span id="l1.2318"> </span>
<a href="#l1.2319"></a><span id="l1.2319">   doCommand(aCommand) {</span>
<a href="#l1.2320"></a><span id="l1.2320">     goPreferences(&quot;composer_pane&quot;);</span>
<a href="#l1.2321"></a><span id="l1.2321">   },</span>
<a href="#l1.2322"></a><span id="l1.2322"> };</span>
<a href="#l1.2323"></a><span id="l1.2323" class="difflineminus">-</span>
<a href="#l1.2324"></a><span id="l1.2324" class="difflineminus">-</span>
<a href="#l1.2325"></a><span id="l1.2325" class="difflineminus">-var nsFinishHTMLSource =</span>
<a href="#l1.2326"></a><span id="l1.2326" class="difflineminus">-{</span>
<a href="#l1.2327"></a><span id="l1.2327" class="difflineplus">+/* eslint-enable */</span>
<a href="#l1.2328"></a><span id="l1.2328" class="difflineplus">+</span>
<a href="#l1.2329"></a><span id="l1.2329" class="difflineplus">+var nsFinishHTMLSource = {</span>
<a href="#l1.2330"></a><span id="l1.2330">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2331"></a><span id="l1.2331">     return true;</span>
<a href="#l1.2332"></a><span id="l1.2332">   },</span>
<a href="#l1.2333"></a><span id="l1.2333"> </span>
<a href="#l1.2334"></a><span id="l1.2334">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2335"></a><span id="l1.2335">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2336"></a><span id="l1.2336"> </span>
<a href="#l1.2337"></a><span id="l1.2337">   doCommand(aCommand) {</span>
<a href="#l1.2338"></a><span id="l1.2338">     // In editor.js</span>
<a href="#l1.2339"></a><span id="l1.2339">     SetEditMode(gPreviousNonSourceDisplayMode);</span>
<a href="#l1.2340"></a><span id="l1.2340">   },</span>
<a href="#l1.2341"></a><span id="l1.2341"> };</span>
<a href="#l1.2342"></a><span id="l1.2342"> </span>
<a href="#l1.2343"></a><span id="l1.2343" class="difflineminus">-var nsCancelHTMLSource =</span>
<a href="#l1.2344"></a><span id="l1.2344" class="difflineminus">-{</span>
<a href="#l1.2345"></a><span id="l1.2345" class="difflineplus">+var nsCancelHTMLSource = {</span>
<a href="#l1.2346"></a><span id="l1.2346">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2347"></a><span id="l1.2347">     return true;</span>
<a href="#l1.2348"></a><span id="l1.2348">   },</span>
<a href="#l1.2349"></a><span id="l1.2349"> </span>
<a href="#l1.2350"></a><span id="l1.2350">   getCommandStateParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2351"></a><span id="l1.2351">   doCommandParams(aCommand, aParams, aRefCon) {},</span>
<a href="#l1.2352"></a><span id="l1.2352"> </span>
<a href="#l1.2353"></a><span id="l1.2353">   doCommand(aCommand) {</span>
<a href="#l1.2354"></a><span id="l1.2354">     // In editor.js</span>
<a href="#l1.2355"></a><span id="l1.2355">     CancelHTMLSource();</span>
<a href="#l1.2356"></a><span id="l1.2356">   },</span>
<a href="#l1.2357"></a><span id="l1.2357"> };</span>
<a href="#l1.2358"></a><span id="l1.2358"> </span>
<a href="#l1.2359"></a><span id="l1.2359" class="difflineminus">-var nsConvertToTable =</span>
<a href="#l1.2360"></a><span id="l1.2360" class="difflineminus">-{</span>
<a href="#l1.2361"></a><span id="l1.2361" class="difflineplus">+var nsConvertToTable = {</span>
<a href="#l1.2362"></a><span id="l1.2362">   isCommandEnabled(aCommand, dummy) {</span>
<a href="#l1.2363"></a><span id="l1.2363">     if (IsDocumentEditable() &amp;&amp; IsEditingRenderedHTML()) {</span>
<a href="#l1.2364"></a><span id="l1.2364">       var selection;</span>
<a href="#l1.2365"></a><span id="l1.2365">       try {</span>
<a href="#l1.2366"></a><span id="l1.2366">         selection = GetCurrentEditor().selection;</span>
<a href="#l1.2367"></a><span id="l1.2367">       } catch (e) {}</span>
<a href="#l1.2368"></a><span id="l1.2368"> </span>
<a href="#l1.2369"></a><span id="l1.2369">       if (selection &amp;&amp; !selection.isCollapsed) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/editor/ui/composer/content/editor.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/editor/ui/composer/content/editor.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1,13 +1,18 @@</span>
<a href="#l2.4"></a><span id="l2.4"> /* -*- Mode: Java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l2.5"></a><span id="l2.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l2.6"></a><span id="l2.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l2.7"></a><span id="l2.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9" class="difflineplus">+/* import-globals-from ../../../../mail/base/content/utilityOverlay.js */</span>
<a href="#l2.10"></a><span id="l2.10" class="difflineplus">+/* import-globals-from ComposerCommands.js */</span>
<a href="#l2.11"></a><span id="l2.11" class="difflineplus">+/* import-globals-from editorUtilities.js */</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+/* globals InlineSpellCheckerUI */</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+</span>
<a href="#l2.14"></a><span id="l2.14"> var {GetNextUntitledValue} = ChromeUtils.import(&quot;resource:///modules/editorUtilities.jsm&quot;);</span>
<a href="#l2.15"></a><span id="l2.15"> var {Async} = ChromeUtils.import(&quot;resource://services-common/async.js&quot;);</span>
<a href="#l2.16"></a><span id="l2.16"> var {AppConstants} = ChromeUtils.import(&quot;resource://gre/modules/AppConstants.jsm&quot;);</span>
<a href="#l2.17"></a><span id="l2.17"> </span>
<a href="#l2.18"></a><span id="l2.18"> /* Main Composer window UI control */</span>
<a href="#l2.19"></a><span id="l2.19"> </span>
<a href="#l2.20"></a><span id="l2.20"> var gComposerWindowControllerID = 0;</span>
<a href="#l2.21"></a><span id="l2.21"> var prefAuthorString = &quot;&quot;;</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineat">@@ -97,18 +102,17 @@ function ShowHideToolbarButtons() {</span>
<a href="#l2.23"></a><span id="l2.23">   ShowHideToolbarSeparators(document.getElementById(&quot;FormatToolbar&quot;));</span>
<a href="#l2.24"></a><span id="l2.24"> }</span>
<a href="#l2.25"></a><span id="l2.25"> </span>
<a href="#l2.26"></a><span id="l2.26"> function nsPrefListener(prefName) {</span>
<a href="#l2.27"></a><span id="l2.27">   this.startup(prefName);</span>
<a href="#l2.28"></a><span id="l2.28"> }</span>
<a href="#l2.29"></a><span id="l2.29"> </span>
<a href="#l2.30"></a><span id="l2.30"> // implements nsIObserver</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineminus">-nsPrefListener.prototype =</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineminus">-{</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineplus">+nsPrefListener.prototype = {</span>
<a href="#l2.34"></a><span id="l2.34">   domain: &quot;&quot;,</span>
<a href="#l2.35"></a><span id="l2.35">   startup(prefName) {</span>
<a href="#l2.36"></a><span id="l2.36">     this.domain = prefName;</span>
<a href="#l2.37"></a><span id="l2.37">     try {</span>
<a href="#l2.38"></a><span id="l2.38">       Services.prefs.addObserver(this.domain, this);</span>
<a href="#l2.39"></a><span id="l2.39">     } catch (ex) {</span>
<a href="#l2.40"></a><span id="l2.40">       dump(&quot;Failed to observe prefs: &quot; + ex + &quot;\n&quot;);</span>
<a href="#l2.41"></a><span id="l2.41">     }</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineat">@@ -148,45 +152,43 @@ nsPrefListener.prototype =</span>
<a href="#l2.43"></a><span id="l2.43">       }</span>
<a href="#l2.44"></a><span id="l2.44">     } else if (prefName.startsWith(kEditorToolbarPrefs)) {</span>
<a href="#l2.45"></a><span id="l2.45">       let id = prefName.substr(kEditorToolbarPrefs.length) + &quot;Button&quot;;</span>
<a href="#l2.46"></a><span id="l2.46">       let button = document.getElementById(id);</span>
<a href="#l2.47"></a><span id="l2.47">       if (button) {</span>
<a href="#l2.48"></a><span id="l2.48">         button.hidden = !Services.prefs.getBoolPref(prefName);</span>
<a href="#l2.49"></a><span id="l2.49">         ShowHideToolbarSeparators(button.parentNode);</span>
<a href="#l2.50"></a><span id="l2.50">       }</span>
<a href="#l2.51"></a><span id="l2.51" class="difflineminus">-    } else if (editor &amp;&amp; (prefName == kCRInParagraphsPref))</span>
<a href="#l2.52"></a><span id="l2.52" class="difflineplus">+    } else if (editor &amp;&amp; (prefName == kCRInParagraphsPref)) {</span>
<a href="#l2.53"></a><span id="l2.53">       editor.returnInParagraphCreatesNewParagraph = Services.prefs.getBoolPref(prefName);</span>
<a href="#l2.54"></a><span id="l2.54" class="difflineplus">+    }</span>
<a href="#l2.55"></a><span id="l2.55">   },</span>
<a href="#l2.56"></a><span id="l2.56"> };</span>
<a href="#l2.57"></a><span id="l2.57"> </span>
<a href="#l2.58"></a><span id="l2.58" class="difflineminus">-const gSourceTextListener =</span>
<a href="#l2.59"></a><span id="l2.59" class="difflineminus">-{</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineminus">-  NotifyDocumentCreated: function NotifyDocumentCreated() {},</span>
<a href="#l2.61"></a><span id="l2.61" class="difflineminus">-  NotifyDocumentWillBeDestroyed: function NotifyDocumentWillBeDestroyed() {},</span>
<a href="#l2.62"></a><span id="l2.62" class="difflineminus">-  NotifyDocumentStateChanged: function NotifyDocumentStateChanged(isChanged) {</span>
<a href="#l2.63"></a><span id="l2.63" class="difflineplus">+const gSourceTextListener = {</span>
<a href="#l2.64"></a><span id="l2.64" class="difflineplus">+  NotifyDocumentCreated() {},</span>
<a href="#l2.65"></a><span id="l2.65" class="difflineplus">+  NotifyDocumentWillBeDestroyed() {},</span>
<a href="#l2.66"></a><span id="l2.66" class="difflineplus">+  NotifyDocumentStateChanged(isChanged) {</span>
<a href="#l2.67"></a><span id="l2.67">     window.updateCommands(&quot;save&quot;);</span>
<a href="#l2.68"></a><span id="l2.68">   },</span>
<a href="#l2.69"></a><span id="l2.69"> };</span>
<a href="#l2.70"></a><span id="l2.70"> </span>
<a href="#l2.71"></a><span id="l2.71" class="difflineminus">-const gSourceTextObserver =</span>
<a href="#l2.72"></a><span id="l2.72" class="difflineminus">-{</span>
<a href="#l2.73"></a><span id="l2.73" class="difflineminus">-  observe: function observe(aSubject, aTopic, aData) {</span>
<a href="#l2.74"></a><span id="l2.74" class="difflineplus">+const gSourceTextObserver = {</span>
<a href="#l2.75"></a><span id="l2.75" class="difflineplus">+  observe(aSubject, aTopic, aData) {</span>
<a href="#l2.76"></a><span id="l2.76">     // we currently only use this to update undo</span>
<a href="#l2.77"></a><span id="l2.77">     window.updateCommands(&quot;undo&quot;);</span>
<a href="#l2.78"></a><span id="l2.78">   },</span>
<a href="#l2.79"></a><span id="l2.79"> };</span>
<a href="#l2.80"></a><span id="l2.80"> </span>
<a href="#l2.81"></a><span id="l2.81"> // This should be called by all editor users when they close their window.</span>
<a href="#l2.82"></a><span id="l2.82"> function EditorCleanup() {</span>
<a href="#l2.83"></a><span id="l2.83">   SwitchInsertCharToAnotherEditorOrClose();</span>
<a href="#l2.84"></a><span id="l2.84"> }</span>
<a href="#l2.85"></a><span id="l2.85"> </span>
<a href="#l2.86"></a><span id="l2.86" class="difflineminus">-var DocumentReloadListener =</span>
<a href="#l2.87"></a><span id="l2.87" class="difflineminus">-{</span>
<a href="#l2.88"></a><span id="l2.88" class="difflineplus">+var DocumentReloadListener = {</span>
<a href="#l2.89"></a><span id="l2.89">   NotifyDocumentCreated() {},</span>
<a href="#l2.90"></a><span id="l2.90">   NotifyDocumentWillBeDestroyed() {},</span>
<a href="#l2.91"></a><span id="l2.91"> </span>
<a href="#l2.92"></a><span id="l2.92">   NotifyDocumentStateChanged(isNowDirty) {</span>
<a href="#l2.93"></a><span id="l2.93">     var editor = GetCurrentEditor();</span>
<a href="#l2.94"></a><span id="l2.94">     try {</span>
<a href="#l2.95"></a><span id="l2.95">       // unregister the listener to prevent multiple callbacks</span>
<a href="#l2.96"></a><span id="l2.96">       editor.removeDocumentStateListener(DocumentReloadListener);</span>
<a href="#l2.97"></a><span id="l2.97" class="difflineat">@@ -195,18 +197,17 @@ var DocumentReloadListener =</span>
<a href="#l2.98"></a><span id="l2.98"> </span>
<a href="#l2.99"></a><span id="l2.99">       // update the META charset with the current presentation charset</span>
<a href="#l2.100"></a><span id="l2.100">       editor.documentCharacterSet = charset;</span>
<a href="#l2.101"></a><span id="l2.101">     } catch (e) {}</span>
<a href="#l2.102"></a><span id="l2.102">   },</span>
<a href="#l2.103"></a><span id="l2.103"> };</span>
<a href="#l2.104"></a><span id="l2.104"> </span>
<a href="#l2.105"></a><span id="l2.105"> // implements nsIObserver</span>
<a href="#l2.106"></a><span id="l2.106" class="difflineminus">-var gEditorDocumentObserver =</span>
<a href="#l2.107"></a><span id="l2.107" class="difflineminus">-{</span>
<a href="#l2.108"></a><span id="l2.108" class="difflineplus">+var gEditorDocumentObserver = {</span>
<a href="#l2.109"></a><span id="l2.109">   observe(aSubject, aTopic, aData) {</span>
<a href="#l2.110"></a><span id="l2.110">     // Should we allow this even if NOT the focused editor?</span>
<a href="#l2.111"></a><span id="l2.111">     var commandManager = GetCurrentCommandManager();</span>
<a href="#l2.112"></a><span id="l2.112">     if (commandManager != aSubject)</span>
<a href="#l2.113"></a><span id="l2.113">       return;</span>
<a href="#l2.114"></a><span id="l2.114"> </span>
<a href="#l2.115"></a><span id="l2.115">     var editor = GetCurrentEditor();</span>
<a href="#l2.116"></a><span id="l2.116">     switch (aTopic) {</span>
<a href="#l2.117"></a><span id="l2.117" class="difflineat">@@ -238,17 +239,19 @@ var gEditorDocumentObserver =</span>
<a href="#l2.118"></a><span id="l2.118">             case nsIEditingSession.eEditorErrorUnknown:</span>
<a href="#l2.119"></a><span id="l2.119">               errorStringId = &quot;CantEditDocumentMsg&quot;;</span>
<a href="#l2.120"></a><span id="l2.120">               break;</span>
<a href="#l2.121"></a><span id="l2.121">             // Note that for &quot;eEditorErrorFileNotFound,</span>
<a href="#l2.122"></a><span id="l2.122">             // network code popped up an alert dialog, so we don't need to</span>
<a href="#l2.123"></a><span id="l2.123">           }</span>
<a href="#l2.124"></a><span id="l2.124">           if (errorStringId)</span>
<a href="#l2.125"></a><span id="l2.125">             Services.prompt.alert(window, &quot;&quot;, GetString(errorStringId));</span>
<a href="#l2.126"></a><span id="l2.126" class="difflineminus">-        } catch (e) { dump(&quot;EXCEPTION GETTING obs_documentCreated state &quot; + e + &quot;\n&quot;); }</span>
<a href="#l2.127"></a><span id="l2.127" class="difflineplus">+        } catch (e) {</span>
<a href="#l2.128"></a><span id="l2.128" class="difflineplus">+          dump(&quot;EXCEPTION GETTING obs_documentCreated state &quot; + e + &quot;\n&quot;);</span>
<a href="#l2.129"></a><span id="l2.129" class="difflineplus">+        }</span>
<a href="#l2.130"></a><span id="l2.130"> </span>
<a href="#l2.131"></a><span id="l2.131">         // We have a bad editor -- nsIEditingSession will rebuild an editor</span>
<a href="#l2.132"></a><span id="l2.132">         //   with a blank page, so simply abort here</span>
<a href="#l2.133"></a><span id="l2.133">         if (editorStatus)</span>
<a href="#l2.134"></a><span id="l2.134">           return;</span>
<a href="#l2.135"></a><span id="l2.135"> </span>
<a href="#l2.136"></a><span id="l2.136">         if (!(&quot;InsertCharWindow&quot; in window))</span>
<a href="#l2.137"></a><span id="l2.137">           window.InsertCharWindow = null;</span>
<a href="#l2.138"></a><span id="l2.138" class="difflineat">@@ -283,17 +286,19 @@ var gEditorDocumentObserver =</span>
<a href="#l2.139"></a><span id="l2.139">           editor.enableUndo(true);</span>
<a href="#l2.140"></a><span id="l2.140"> </span>
<a href="#l2.141"></a><span id="l2.141">           // We may load a text document into an html editor,</span>
<a href="#l2.142"></a><span id="l2.142">           //   so be sure editortype is set correctly</span>
<a href="#l2.143"></a><span id="l2.143">           // XXX We really should use the &quot;real&quot; plaintext editor for this!</span>
<a href="#l2.144"></a><span id="l2.144">           if (editor.contentsMIMEType == &quot;text/plain&quot;) {</span>
<a href="#l2.145"></a><span id="l2.145">             try {</span>
<a href="#l2.146"></a><span id="l2.146">               GetCurrentEditorElement().editortype = &quot;text&quot;;</span>
<a href="#l2.147"></a><span id="l2.147" class="difflineminus">-            } catch (e) { dump(e) + &quot;\n&quot;; }</span>
<a href="#l2.148"></a><span id="l2.148" class="difflineplus">+            } catch (e) {</span>
<a href="#l2.149"></a><span id="l2.149" class="difflineplus">+              dump(e) + &quot;\n&quot;;</span>
<a href="#l2.150"></a><span id="l2.150" class="difflineplus">+            }</span>
<a href="#l2.151"></a><span id="l2.151"> </span>
<a href="#l2.152"></a><span id="l2.152">             // Hide or disable UI not used for plaintext editing</span>
<a href="#l2.153"></a><span id="l2.153">             HideItem(&quot;FormatToolbar&quot;);</span>
<a href="#l2.154"></a><span id="l2.154">             HideItem(&quot;EditModeToolbar&quot;);</span>
<a href="#l2.155"></a><span id="l2.155">             HideItem(&quot;formatMenu&quot;);</span>
<a href="#l2.156"></a><span id="l2.156">             HideItem(&quot;tableMenu&quot;);</span>
<a href="#l2.157"></a><span id="l2.157">             HideItem(&quot;menu_validate&quot;);</span>
<a href="#l2.158"></a><span id="l2.158">             HideItem(&quot;sep_validate&quot;);</span>
<a href="#l2.159"></a><span id="l2.159" class="difflineat">@@ -357,17 +362,19 @@ var gEditorDocumentObserver =</span>
<a href="#l2.160"></a><span id="l2.160">         break;</span>
<a href="#l2.161"></a><span id="l2.161"> </span>
<a href="#l2.162"></a><span id="l2.162">       case &quot;obs_documentLocationChanged&quot;:</span>
<a href="#l2.163"></a><span id="l2.163">         // Ignore this when editor doesn't exist,</span>
<a href="#l2.164"></a><span id="l2.164">         //   which happens once when page load starts</span>
<a href="#l2.165"></a><span id="l2.165">         if (editor)</span>
<a href="#l2.166"></a><span id="l2.166">           try {</span>
<a href="#l2.167"></a><span id="l2.167">             editor.updateBaseURL();</span>
<a href="#l2.168"></a><span id="l2.168" class="difflineminus">-          } catch (e) { dump(e); }</span>
<a href="#l2.169"></a><span id="l2.169" class="difflineplus">+          } catch (e) {</span>
<a href="#l2.170"></a><span id="l2.170" class="difflineplus">+            dump(e);</span>
<a href="#l2.171"></a><span id="l2.171" class="difflineplus">+          }</span>
<a href="#l2.172"></a><span id="l2.172">         break;</span>
<a href="#l2.173"></a><span id="l2.173"> </span>
<a href="#l2.174"></a><span id="l2.174">       case &quot;cmd_bold&quot;:</span>
<a href="#l2.175"></a><span id="l2.175">         // Update all style items</span>
<a href="#l2.176"></a><span id="l2.176">         // cmd_bold is a proxy; see EditorSharedStartup (above) for details</span>
<a href="#l2.177"></a><span id="l2.177">         window.updateCommands(&quot;style&quot;);</span>
<a href="#l2.178"></a><span id="l2.178">         window.updateCommands(&quot;undo&quot;);</span>
<a href="#l2.179"></a><span id="l2.179">         break;</span>
<a href="#l2.180"></a><span id="l2.180" class="difflineat">@@ -383,17 +390,19 @@ function EditorLoadUrl(url) {</span>
<a href="#l2.181"></a><span id="l2.181">   try {</span>
<a href="#l2.182"></a><span id="l2.182">     if (url) {</span>
<a href="#l2.183"></a><span id="l2.183">       let loadURIOptions = {</span>
<a href="#l2.184"></a><span id="l2.184">         loadFlags: Ci.nsIWebNavigation.LOAD_FLAGS_BYPASS_CACHE,</span>
<a href="#l2.185"></a><span id="l2.185">         triggeringPrincipal: Services.scriptSecurityManager.getSystemPrincipal(),</span>
<a href="#l2.186"></a><span id="l2.186">       };</span>
<a href="#l2.187"></a><span id="l2.187">       GetCurrentEditorElement().webNavigation.loadURI(url, loadURIOptions);</span>
<a href="#l2.188"></a><span id="l2.188">     }</span>
<a href="#l2.189"></a><span id="l2.189" class="difflineminus">-  } catch (e) { dump(&quot; EditorLoadUrl failed: &quot; + e + &quot;\n&quot;); }</span>
<a href="#l2.190"></a><span id="l2.190" class="difflineplus">+  } catch (e) {</span>
<a href="#l2.191"></a><span id="l2.191" class="difflineplus">+    dump(&quot; EditorLoadUrl failed: &quot; + e + &quot;\n&quot;);</span>
<a href="#l2.192"></a><span id="l2.192" class="difflineplus">+  }</span>
<a href="#l2.193"></a><span id="l2.193"> }</span>
<a href="#l2.194"></a><span id="l2.194"> </span>
<a href="#l2.195"></a><span id="l2.195"> // This should be called by all Composer types</span>
<a href="#l2.196"></a><span id="l2.196"> function EditorSharedStartup() {</span>
<a href="#l2.197"></a><span id="l2.197">   // Just for convenience</span>
<a href="#l2.198"></a><span id="l2.198">   gContentWindow = window.content;</span>
<a href="#l2.199"></a><span id="l2.199"> </span>
<a href="#l2.200"></a><span id="l2.200">   // Disable DNS Prefetching on the docshell - we don't need it for composer</span>
<a href="#l2.201"></a><span id="l2.201" class="difflineat">@@ -415,17 +424,19 @@ function EditorSharedStartup() {</span>
<a href="#l2.202"></a><span id="l2.202">     commandManager.addCommandObserver(gEditorDocumentObserver, &quot;cmd_setDocumentModified&quot;);</span>
<a href="#l2.203"></a><span id="l2.203">     commandManager.addCommandObserver(gEditorDocumentObserver, &quot;obs_documentWillBeDestroyed&quot;);</span>
<a href="#l2.204"></a><span id="l2.204">     commandManager.addCommandObserver(gEditorDocumentObserver, &quot;obs_documentLocationChanged&quot;);</span>
<a href="#l2.205"></a><span id="l2.205"> </span>
<a href="#l2.206"></a><span id="l2.206">     // Until nsIControllerCommandGroup-based code is implemented,</span>
<a href="#l2.207"></a><span id="l2.207">     //  we will observe just the bold command to trigger update of</span>
<a href="#l2.208"></a><span id="l2.208">     //  all toolbar style items</span>
<a href="#l2.209"></a><span id="l2.209">     commandManager.addCommandObserver(gEditorDocumentObserver, &quot;cmd_bold&quot;);</span>
<a href="#l2.210"></a><span id="l2.210" class="difflineminus">-  } catch (e) { dump(e); }</span>
<a href="#l2.211"></a><span id="l2.211" class="difflineplus">+  } catch (e) {</span>
<a href="#l2.212"></a><span id="l2.212" class="difflineplus">+    dump(e);</span>
<a href="#l2.213"></a><span id="l2.213" class="difflineplus">+  }</span>
<a href="#l2.214"></a><span id="l2.214"> </span>
<a href="#l2.215"></a><span id="l2.215">   var isMac = AppConstants.platform == &quot;macosx&quot;;</span>
<a href="#l2.216"></a><span id="l2.216"> </span>
<a href="#l2.217"></a><span id="l2.217">   // Set platform-specific hints for how to select cells</span>
<a href="#l2.218"></a><span id="l2.218">   // Mac uses &quot;Cmd&quot;, all others use &quot;Ctrl&quot;</span>
<a href="#l2.219"></a><span id="l2.219">   var tableKey = GetString(isMac ? &quot;XulKeyMac&quot; : &quot;TableSelectKey&quot;);</span>
<a href="#l2.220"></a><span id="l2.220">   var dragStr = tableKey + GetString(&quot;Drag&quot;);</span>
<a href="#l2.221"></a><span id="l2.221">   var clickStr = tableKey + GetString(&quot;Click&quot;);</span>
<a href="#l2.222"></a><span id="l2.222" class="difflineat">@@ -481,17 +492,19 @@ function DocumentHasBeenSaved() {</span>
<a href="#l2.223"></a><span id="l2.223"> async function CheckAndSaveDocument(command, allowDontSave) {</span>
<a href="#l2.224"></a><span id="l2.224">   var document;</span>
<a href="#l2.225"></a><span id="l2.225">   try {</span>
<a href="#l2.226"></a><span id="l2.226">     // if we don't have an editor or an document, bail</span>
<a href="#l2.227"></a><span id="l2.227">     var editor = GetCurrentEditor();</span>
<a href="#l2.228"></a><span id="l2.228">     document = editor.document;</span>
<a href="#l2.229"></a><span id="l2.229">     if (!document)</span>
<a href="#l2.230"></a><span id="l2.230">       return true;</span>
<a href="#l2.231"></a><span id="l2.231" class="difflineminus">-  } catch (e) { return true; }</span>
<a href="#l2.232"></a><span id="l2.232" class="difflineplus">+  } catch (e) {</span>
<a href="#l2.233"></a><span id="l2.233" class="difflineplus">+    return true;</span>
<a href="#l2.234"></a><span id="l2.234" class="difflineplus">+  }</span>
<a href="#l2.235"></a><span id="l2.235"> </span>
<a href="#l2.236"></a><span id="l2.236">   if (!IsDocumentModified() &amp;&amp; !IsHTMLSourceChanged())</span>
<a href="#l2.237"></a><span id="l2.237">     return true;</span>
<a href="#l2.238"></a><span id="l2.238"> </span>
<a href="#l2.239"></a><span id="l2.239">   // call window.focus, since we need to pop up a dialog</span>
<a href="#l2.240"></a><span id="l2.240">   // and therefore need to be visible (to prevent user confusion)</span>
<a href="#l2.241"></a><span id="l2.241">   top.document.commandDispatcher.focusedWindow.focus();</span>
<a href="#l2.242"></a><span id="l2.242"> </span>
<a href="#l2.243"></a><span id="l2.243" class="difflineat">@@ -552,17 +565,17 @@ async function CheckAndSaveDocument(comm</span>
<a href="#l2.244"></a><span id="l2.244">       // and return as if user canceled because publishing is asynchronous</span>
<a href="#l2.245"></a><span id="l2.245">       // This command will be fired when publishing finishes</span>
<a href="#l2.246"></a><span id="l2.246">       gCommandAfterPublishing = command;</span>
<a href="#l2.247"></a><span id="l2.247">       goDoCommand(&quot;cmd_publish&quot;);</span>
<a href="#l2.248"></a><span id="l2.248">       return false;</span>
<a href="#l2.249"></a><span id="l2.249">     }</span>
<a href="#l2.250"></a><span id="l2.250"> </span>
<a href="#l2.251"></a><span id="l2.251">     // Save to local disk</span>
<a href="#l2.252"></a><span id="l2.252" class="difflineminus">-    return await SaveDocument(false, false, editor.contentsMIMEType);</span>
<a href="#l2.253"></a><span id="l2.253" class="difflineplus">+    return SaveDocument(false, false, editor.contentsMIMEType);</span>
<a href="#l2.254"></a><span id="l2.254">   }</span>
<a href="#l2.255"></a><span id="l2.255"> </span>
<a href="#l2.256"></a><span id="l2.256">   if (result == 2) // &quot;Don't Save&quot;</span>
<a href="#l2.257"></a><span id="l2.257">     return true;</span>
<a href="#l2.258"></a><span id="l2.258"> </span>
<a href="#l2.259"></a><span id="l2.259">   // Default or result == 1 (Cancel)</span>
<a href="#l2.260"></a><span id="l2.260">   return false;</span>
<a href="#l2.261"></a><span id="l2.261"> }</span>
<a href="#l2.262"></a><span id="l2.262" class="difflineat">@@ -708,22 +721,19 @@ function onFontFaceChange(fontFaceMenuLi</span>
<a href="#l2.263"></a><span id="l2.263">           matchedFontIndex = matchPos;</span>
<a href="#l2.264"></a><span id="l2.264">           foundFont = menuItem;</span>
<a href="#l2.265"></a><span id="l2.265">           // If we matched the first option, we don't need to look for</span>
<a href="#l2.266"></a><span id="l2.266">           // a better match.</span>
<a href="#l2.267"></a><span id="l2.267">           if (matchPos == 0)</span>
<a href="#l2.268"></a><span id="l2.268">             break;</span>
<a href="#l2.269"></a><span id="l2.269">         }</span>
<a href="#l2.270"></a><span id="l2.270">       }</span>
<a href="#l2.271"></a><span id="l2.271" class="difflineminus">-    } else {</span>
<a href="#l2.272"></a><span id="l2.272" class="difflineminus">-      // Some other element type.</span>
<a href="#l2.273"></a><span id="l2.273" class="difflineminus">-      if (menuItem == usedFontsSep) {</span>
<a href="#l2.274"></a><span id="l2.274" class="difflineminus">-        // We have now passed the section of used fonts and are now in the list of all.</span>
<a href="#l2.275"></a><span id="l2.275" class="difflineminus">-        afterUsedFontSection = true;</span>
<a href="#l2.276"></a><span id="l2.276" class="difflineminus">-      }</span>
<a href="#l2.277"></a><span id="l2.277" class="difflineplus">+    } else if (menuItem == usedFontsSep) { // Some other element type.</span>
<a href="#l2.278"></a><span id="l2.278" class="difflineplus">+      // We have now passed the section of used fonts and are now in the list of all.</span>
<a href="#l2.279"></a><span id="l2.279" class="difflineplus">+      afterUsedFontSection = true;</span>
<a href="#l2.280"></a><span id="l2.280">     }</span>
<a href="#l2.281"></a><span id="l2.281">   }</span>
<a href="#l2.282"></a><span id="l2.282"> </span>
<a href="#l2.283"></a><span id="l2.283">   if (foundFont) {</span>
<a href="#l2.284"></a><span id="l2.284">     let defaultFontsSep = menuPopup.querySelector(&quot;menuseparator.fontFaceMenuAfterDefaultFonts&quot;);</span>
<a href="#l2.285"></a><span id="l2.285">     if (exactMatch) {</span>
<a href="#l2.286"></a><span id="l2.286">       if (afterUsedFontSection) {</span>
<a href="#l2.287"></a><span id="l2.287">         // Copy the matched font into the section of used fonts.</span>
<a href="#l2.288"></a><span id="l2.288" class="difflineat">@@ -777,17 +787,16 @@ function onFontFaceChange(fontFaceMenuLi</span>
<a href="#l2.289"></a><span id="l2.289"> }</span>
<a href="#l2.290"></a><span id="l2.290"> </span>
<a href="#l2.291"></a><span id="l2.291"> /**</span>
<a href="#l2.292"></a><span id="l2.292">  * Clears the used fonts list from all the font face menulists.</span>
<a href="#l2.293"></a><span id="l2.293">  */</span>
<a href="#l2.294"></a><span id="l2.294"> function ClearUsedFonts() {</span>
<a href="#l2.295"></a><span id="l2.295">   let userFontSeps = document.querySelectorAll(&quot;menuseparator.fontFaceMenuAfterDefaultFonts&quot;);</span>
<a href="#l2.296"></a><span id="l2.296">   for (let userFontSep of userFontSeps) {</span>
<a href="#l2.297"></a><span id="l2.297" class="difflineminus">-    let parentList = userFontSep.parentNode;</span>
<a href="#l2.298"></a><span id="l2.298">     while (true) {</span>
<a href="#l2.299"></a><span id="l2.299">       let nextNode = userFontSep.nextSibling;</span>
<a href="#l2.300"></a><span id="l2.300">       if (nextNode.tagName != &quot;menuseparator&quot;) {</span>
<a href="#l2.301"></a><span id="l2.301">         nextNode.remove();</span>
<a href="#l2.302"></a><span id="l2.302">       } else if (nextNode.classList.contains(&quot;fontFaceMenuAfterUsedFonts&quot;)) {</span>
<a href="#l2.303"></a><span id="l2.303">           nextNode.hidden = true;</span>
<a href="#l2.304"></a><span id="l2.304">           break;</span>
<a href="#l2.305"></a><span id="l2.305">         }</span>
<a href="#l2.306"></a><span id="l2.306" class="difflineat">@@ -899,20 +908,17 @@ function initFontFaceMenu(menuPopup) {</span>
<a href="#l2.307"></a><span id="l2.307">         var matchFound = false;</span>
<a href="#l2.308"></a><span id="l2.308">         if (!mixed.value) {</span>
<a href="#l2.309"></a><span id="l2.309">           var menuFont = menuItem.getAttribute(&quot;value&quot;).toLowerCase().replace(/, /g, &quot;,&quot;);</span>
<a href="#l2.310"></a><span id="l2.310"> </span>
<a href="#l2.311"></a><span id="l2.311">           // First compare the entire font string to match items that contain commas.</span>
<a href="#l2.312"></a><span id="l2.312">           if (menuFont == editorFont) {</span>
<a href="#l2.313"></a><span id="l2.313">             menuItem.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l2.314"></a><span id="l2.314">             break;</span>
<a href="#l2.315"></a><span id="l2.315" class="difflineminus">-          }</span>
<a href="#l2.316"></a><span id="l2.316" class="difflineminus">-</span>
<a href="#l2.317"></a><span id="l2.317" class="difflineminus">-          // Next compare the individual options.</span>
<a href="#l2.318"></a><span id="l2.318" class="difflineminus">-          else if (editorFontOptions.length &gt; 1) {</span>
<a href="#l2.319"></a><span id="l2.319" class="difflineplus">+          } else if (editorFontOptions.length &gt; 1) { // Next compare the individual options.</span>
<a href="#l2.320"></a><span id="l2.320">             var matchPos = editorFontOptions.indexOf(menuFont);</span>
<a href="#l2.321"></a><span id="l2.321">             if (matchPos &gt;= 0 &amp;&amp; matchPos &lt; matchedOption) {</span>
<a href="#l2.322"></a><span id="l2.322">               // This menu font comes earlier in the list of options,</span>
<a href="#l2.323"></a><span id="l2.323">               // so prefer it.</span>
<a href="#l2.324"></a><span id="l2.324">               menuItem.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l2.325"></a><span id="l2.325"> </span>
<a href="#l2.326"></a><span id="l2.326">               // If we matched the first option, we don't need to look for</span>
<a href="#l2.327"></a><span id="l2.327">               // a better match.</span>
<a href="#l2.328"></a><span id="l2.328" class="difflineat">@@ -947,17 +953,17 @@ const kFixedFontFaceMenuItems = 8;</span>
<a href="#l2.329"></a><span id="l2.329"> function initLocalFontFaceMenu(menuPopup) {</span>
<a href="#l2.330"></a><span id="l2.330">   if (!gLocalFonts) {</span>
<a href="#l2.331"></a><span id="l2.331">     // Build list of all local fonts once per editor</span>
<a href="#l2.332"></a><span id="l2.332">     try {</span>
<a href="#l2.333"></a><span id="l2.333">       var enumerator = Cc[&quot;@mozilla.org/gfx/fontenumerator;1&quot;]</span>
<a href="#l2.334"></a><span id="l2.334">                          .getService(Ci.nsIFontEnumerator);</span>
<a href="#l2.335"></a><span id="l2.335">       var localFontCount = { value: 0 };</span>
<a href="#l2.336"></a><span id="l2.336">       gLocalFonts = enumerator.EnumerateAllFonts(localFontCount);</span>
<a href="#l2.337"></a><span id="l2.337" class="difflineminus">-    } catch (e) { }</span>
<a href="#l2.338"></a><span id="l2.338" class="difflineplus">+    } catch (e) {}</span>
<a href="#l2.339"></a><span id="l2.339">   }</span>
<a href="#l2.340"></a><span id="l2.340"> </span>
<a href="#l2.341"></a><span id="l2.341">   // Don't use radios for menulists.</span>
<a href="#l2.342"></a><span id="l2.342">   let useRadioMenuitems = (menuPopup.parentNode.localName == &quot;menu&quot;);</span>
<a href="#l2.343"></a><span id="l2.343">   menuPopup.setAttribute(&quot;useRadios&quot;, useRadioMenuitems);</span>
<a href="#l2.344"></a><span id="l2.344">   if (menuPopup.childNodes.length == kFixedFontFaceMenuItems) {</span>
<a href="#l2.345"></a><span id="l2.345">     if (gLocalFonts.length == 0) {</span>
<a href="#l2.346"></a><span id="l2.346">       menuPopup.querySelector(&quot;.fontFaceMenuAfterDefaultFonts&quot;).hidden = true;</span>
<a href="#l2.347"></a><span id="l2.347" class="difflineat">@@ -1237,16 +1243,17 @@ function GetBackgroundElementWithColor()</span>
<a href="#l2.348"></a><span id="l2.348"> </span>
<a href="#l2.349"></a><span id="l2.349"> function SetSmiley(smileyText) {</span>
<a href="#l2.350"></a><span id="l2.350">   try {</span>
<a href="#l2.351"></a><span id="l2.351">     GetCurrentEditor().insertText(smileyText);</span>
<a href="#l2.352"></a><span id="l2.352">     gContentWindow.focus();</span>
<a href="#l2.353"></a><span id="l2.353">   } catch (e) {}</span>
<a href="#l2.354"></a><span id="l2.354"> }</span>
<a href="#l2.355"></a><span id="l2.355"> </span>
<a href="#l2.356"></a><span id="l2.356" class="difflineplus">+/* eslint-disable complexity */</span>
<a href="#l2.357"></a><span id="l2.357"> function EditorSelectColor(colorType, mouseEvent) {</span>
<a href="#l2.358"></a><span id="l2.358">   var editor = GetCurrentEditor();</span>
<a href="#l2.359"></a><span id="l2.359">   if (!editor || !gColorObj)</span>
<a href="#l2.360"></a><span id="l2.360">     return;</span>
<a href="#l2.361"></a><span id="l2.361"> </span>
<a href="#l2.362"></a><span id="l2.362">   // Shift + mouse click automatically applies last color, if available</span>
<a href="#l2.363"></a><span id="l2.363">   var useLastColor = mouseEvent ? (mouseEvent.button == 0 &amp;&amp; mouseEvent.shiftKey) : false;</span>
<a href="#l2.364"></a><span id="l2.364">   var element;</span>
<a href="#l2.365"></a><span id="l2.365" class="difflineat">@@ -1297,18 +1304,19 @@ function EditorSelectColor(colorType, mo</span>
<a href="#l2.366"></a><span id="l2.366">     // Save to avoid resetting if not necessary</span>
<a href="#l2.367"></a><span id="l2.367">     currentColor = gColorObj.BackgroundColor;</span>
<a href="#l2.368"></a><span id="l2.368"> </span>
<a href="#l2.369"></a><span id="l2.369">     if (colorType == &quot;TableOrCell&quot; || colorType == &quot;Cell&quot;) {</span>
<a href="#l2.370"></a><span id="l2.370">       if (gColorObj.Type == &quot;Cell&quot;)</span>
<a href="#l2.371"></a><span id="l2.371">         gColorObj.Type = colorType;</span>
<a href="#l2.372"></a><span id="l2.372">       else if (gColorObj.Type != &quot;Table&quot;)</span>
<a href="#l2.373"></a><span id="l2.373">         return;</span>
<a href="#l2.374"></a><span id="l2.374" class="difflineminus">-    } else if (colorType == &quot;Table&quot; &amp;&amp; gColorObj.Type == &quot;Page&quot;)</span>
<a href="#l2.375"></a><span id="l2.375" class="difflineplus">+    } else if (colorType == &quot;Table&quot; &amp;&amp; gColorObj.Type == &quot;Page&quot;) {</span>
<a href="#l2.376"></a><span id="l2.376">       return;</span>
<a href="#l2.377"></a><span id="l2.377" class="difflineplus">+    }</span>
<a href="#l2.378"></a><span id="l2.378"> </span>
<a href="#l2.379"></a><span id="l2.379">     if (colorType == &quot;&quot; &amp;&amp; gColorObj.Type == &quot;Cell&quot;) {</span>
<a href="#l2.380"></a><span id="l2.380">       // Using empty string for requested type means</span>
<a href="#l2.381"></a><span id="l2.381">       //  we can let user select cell or table</span>
<a href="#l2.382"></a><span id="l2.382">       gColorObj.Type = &quot;TableOrCell&quot;;</span>
<a href="#l2.383"></a><span id="l2.383">     }</span>
<a href="#l2.384"></a><span id="l2.384"> </span>
<a href="#l2.385"></a><span id="l2.385">     if (useLastColor &amp;&amp; gColorObj.LastBackgroundColor)</span>
<a href="#l2.386"></a><span id="l2.386" class="difflineat">@@ -1397,16 +1405,17 @@ function EditorSelectColor(colorType, mo</span>
<a href="#l2.387"></a><span id="l2.387"> </span>
<a href="#l2.388"></a><span id="l2.388">       editor.endTransaction();</span>
<a href="#l2.389"></a><span id="l2.389">     }</span>
<a href="#l2.390"></a><span id="l2.390"> </span>
<a href="#l2.391"></a><span id="l2.391">     goUpdateCommandState(&quot;cmd_backgroundColor&quot;);</span>
<a href="#l2.392"></a><span id="l2.392">   }</span>
<a href="#l2.393"></a><span id="l2.393">   gContentWindow.focus();</span>
<a href="#l2.394"></a><span id="l2.394"> }</span>
<a href="#l2.395"></a><span id="l2.395" class="difflineplus">+/* eslint-enable complexity */</span>
<a href="#l2.396"></a><span id="l2.396"> </span>
<a href="#l2.397"></a><span id="l2.397"> function GetParentTable(element) {</span>
<a href="#l2.398"></a><span id="l2.398">   var node = element;</span>
<a href="#l2.399"></a><span id="l2.399">   while (node) {</span>
<a href="#l2.400"></a><span id="l2.400">     if (node.nodeName.toLowerCase() == &quot;table&quot;)</span>
<a href="#l2.401"></a><span id="l2.401">       return node;</span>
<a href="#l2.402"></a><span id="l2.402"> </span>
<a href="#l2.403"></a><span id="l2.403">     node = node.parentNode;</span>
<a href="#l2.404"></a><span id="l2.404" class="difflineat">@@ -1486,18 +1495,19 @@ function GetObjectForProperties() {</span>
<a href="#l2.405"></a><span id="l2.405">   try {</span>
<a href="#l2.406"></a><span id="l2.406">     element = editor.getSelectedElement(&quot;&quot;);</span>
<a href="#l2.407"></a><span id="l2.407">   } catch (e) {}</span>
<a href="#l2.408"></a><span id="l2.408">   if (element) {</span>
<a href="#l2.409"></a><span id="l2.409">     if (element.namespaceURI == &quot;http://www.w3.org/1998/Math/MathML&quot;) {</span>
<a href="#l2.410"></a><span id="l2.410">       // If the object is a MathML element, we collapse the selection on it and</span>
<a href="#l2.411"></a><span id="l2.411">       // we return its &lt;math&gt; ancestor. Hence the math dialog will be used.</span>
<a href="#l2.412"></a><span id="l2.412">       GetCurrentEditor().selection.collapse(element, 0);</span>
<a href="#l2.413"></a><span id="l2.413" class="difflineminus">-    } else</span>
<a href="#l2.414"></a><span id="l2.414" class="difflineplus">+    } else {</span>
<a href="#l2.415"></a><span id="l2.415">       return element;</span>
<a href="#l2.416"></a><span id="l2.416" class="difflineplus">+    }</span>
<a href="#l2.417"></a><span id="l2.417">   }</span>
<a href="#l2.418"></a><span id="l2.418"> </span>
<a href="#l2.419"></a><span id="l2.419">   // Find nearest parent of selection anchor node</span>
<a href="#l2.420"></a><span id="l2.420">   //   that is a link, list, table cell, or table</span>
<a href="#l2.421"></a><span id="l2.421"> </span>
<a href="#l2.422"></a><span id="l2.422">   var anchorNode;</span>
<a href="#l2.423"></a><span id="l2.423">   var node;</span>
<a href="#l2.424"></a><span id="l2.424">   try {</span>
<a href="#l2.425"></a><span id="l2.425" class="difflineat">@@ -1550,48 +1560,53 @@ function SetEditMode(mode) {</span>
<a href="#l2.426"></a><span id="l2.426">   //   so user can't type in source window while new window is being filled</span>
<a href="#l2.427"></a><span id="l2.427">   var previousMode = gEditorDisplayMode;</span>
<a href="#l2.428"></a><span id="l2.428">   if (!SetDisplayMode(mode))</span>
<a href="#l2.429"></a><span id="l2.429">     return;</span>
<a href="#l2.430"></a><span id="l2.430"> </span>
<a href="#l2.431"></a><span id="l2.431">   if (mode == kDisplayModeSource) {</span>
<a href="#l2.432"></a><span id="l2.432">     // Display the DOCTYPE as a non-editable string above edit area</span>
<a href="#l2.433"></a><span id="l2.433">     var domdoc;</span>
<a href="#l2.434"></a><span id="l2.434" class="difflineminus">-    try { domdoc = editor.document; } catch (e) { dump(e + &quot;\n&quot;); }</span>
<a href="#l2.435"></a><span id="l2.435" class="difflineplus">+    try {</span>
<a href="#l2.436"></a><span id="l2.436" class="difflineplus">+      domdoc = editor.document;</span>
<a href="#l2.437"></a><span id="l2.437" class="difflineplus">+    } catch (e) {</span>
<a href="#l2.438"></a><span id="l2.438" class="difflineplus">+      dump(e + &quot;\n&quot;);</span>
<a href="#l2.439"></a><span id="l2.439" class="difflineplus">+    }</span>
<a href="#l2.440"></a><span id="l2.440">     if (domdoc) {</span>
<a href="#l2.441"></a><span id="l2.441">       var doctypeNode = document.getElementById(&quot;doctype-text&quot;);</span>
<a href="#l2.442"></a><span id="l2.442">       var dt = domdoc.doctype;</span>
<a href="#l2.443"></a><span id="l2.443">       if (doctypeNode) {</span>
<a href="#l2.444"></a><span id="l2.444">         if (dt) {</span>
<a href="#l2.445"></a><span id="l2.445">           doctypeNode.collapsed = false;</span>
<a href="#l2.446"></a><span id="l2.446">           var doctypeText = &quot;&lt;!DOCTYPE &quot; + domdoc.doctype.name;</span>
<a href="#l2.447"></a><span id="l2.447">           if (dt.publicId)</span>
<a href="#l2.448"></a><span id="l2.448">             doctypeText += &quot; PUBLIC \&quot;&quot; + domdoc.doctype.publicId;</span>
<a href="#l2.449"></a><span id="l2.449">           if (dt.systemId)</span>
<a href="#l2.450"></a><span id="l2.450">             doctypeText += &quot; \&quot;&quot; + dt.systemId;</span>
<a href="#l2.451"></a><span id="l2.451">           doctypeText += &quot;\&quot;&gt;&quot;;</span>
<a href="#l2.452"></a><span id="l2.452">           doctypeNode.setAttribute(&quot;value&quot;, doctypeText);</span>
<a href="#l2.453"></a><span id="l2.453" class="difflineminus">-        } else</span>
<a href="#l2.454"></a><span id="l2.454" class="difflineplus">+        } else {</span>
<a href="#l2.455"></a><span id="l2.455">           doctypeNode.collapsed = true;</span>
<a href="#l2.456"></a><span id="l2.456" class="difflineplus">+        }</span>
<a href="#l2.457"></a><span id="l2.457">       }</span>
<a href="#l2.458"></a><span id="l2.458">     }</span>
<a href="#l2.459"></a><span id="l2.459">     // Get the entire document's source string</span>
<a href="#l2.460"></a><span id="l2.460"> </span>
<a href="#l2.461"></a><span id="l2.461">     var flags = (editor.documentCharacterSet == &quot;ISO-8859-1&quot;)</span>
<a href="#l2.462"></a><span id="l2.462">       ? kOutputEncodeLatin1Entities</span>
<a href="#l2.463"></a><span id="l2.463">       : kOutputEncodeBasicEntities;</span>
<a href="#l2.464"></a><span id="l2.464">     try {</span>
<a href="#l2.465"></a><span id="l2.465">       let encodeEntity = Services.prefs.getCharPref(&quot;editor.encode_entity&quot;);</span>
<a href="#l2.466"></a><span id="l2.466">       switch (encodeEntity) {</span>
<a href="#l2.467"></a><span id="l2.467">         case &quot;basic&quot; : flags = kOutputEncodeBasicEntities; break;</span>
<a href="#l2.468"></a><span id="l2.468">         case &quot;latin1&quot; : flags = kOutputEncodeLatin1Entities; break;</span>
<a href="#l2.469"></a><span id="l2.469">         case &quot;html&quot; : flags = kOutputEncodeHTMLEntities; break;</span>
<a href="#l2.470"></a><span id="l2.470">         case &quot;none&quot; : flags = 0; break;</span>
<a href="#l2.471"></a><span id="l2.471">       }</span>
<a href="#l2.472"></a><span id="l2.472" class="difflineminus">-    } catch (e) { }</span>
<a href="#l2.473"></a><span id="l2.473" class="difflineplus">+    } catch (e) {}</span>
<a href="#l2.474"></a><span id="l2.474"> </span>
<a href="#l2.475"></a><span id="l2.475">     if (Services.prefs.getBoolPref(&quot;editor.prettyprint&quot;))</span>
<a href="#l2.476"></a><span id="l2.476">       flags |= kOutputFormatted;</span>
<a href="#l2.477"></a><span id="l2.477"> </span>
<a href="#l2.478"></a><span id="l2.478">     flags |= kOutputLFLineBreak;</span>
<a href="#l2.479"></a><span id="l2.479">     var source = editor.outputToString(editor.contentsMIMEType, flags);</span>
<a href="#l2.480"></a><span id="l2.480">     var start = source.search(/&lt;html/i);</span>
<a href="#l2.481"></a><span id="l2.481">     if (start == -1) start = 0;</span>
<a href="#l2.482"></a><span id="l2.482" class="difflineat">@@ -1616,19 +1631,20 @@ function SetEditMode(mode) {</span>
<a href="#l2.483"></a><span id="l2.483">         editor.transactionManager.maxTransactionCount = 1;</span>
<a href="#l2.484"></a><span id="l2.484">       } catch (e) {}</span>
<a href="#l2.485"></a><span id="l2.485"> </span>
<a href="#l2.486"></a><span id="l2.486">       editor.beginTransaction();</span>
<a href="#l2.487"></a><span id="l2.487">       try {</span>
<a href="#l2.488"></a><span id="l2.488">         // We are coming from edit source mode,</span>
<a href="#l2.489"></a><span id="l2.489">         //   so transfer that back into the document</span>
<a href="#l2.490"></a><span id="l2.490">         source = gSourceTextEditor.outputToString(kTextMimeType, kOutputLFLineBreak).trim();</span>
<a href="#l2.491"></a><span id="l2.491" class="difflineminus">-        if (editor.contentsMIMEType != kXHTMLMimeType)</span>
<a href="#l2.492"></a><span id="l2.492" class="difflineplus">+        if (editor.contentsMIMEType != kXHTMLMimeType) {</span>
<a href="#l2.493"></a><span id="l2.493">           editor.rebuildDocumentFromSource(source);</span>
<a href="#l2.494"></a><span id="l2.494" class="difflineminus">-        else {</span>
<a href="#l2.495"></a><span id="l2.495" class="difflineplus">+        } else {</span>
<a href="#l2.496"></a><span id="l2.496" class="difflineplus">+          /* eslint-disable-next-line no-unsanitized/method */</span>
<a href="#l2.497"></a><span id="l2.497">           var fragment = editor.document.createRange().createContextualFragment(source);</span>
<a href="#l2.498"></a><span id="l2.498">           editor.enableUndo(false);</span>
<a href="#l2.499"></a><span id="l2.499">           GetBodyElement().remove();</span>
<a href="#l2.500"></a><span id="l2.500">           editor.document.replaceChild(fragment.firstChild, editor.document.documentElement);</span>
<a href="#l2.501"></a><span id="l2.501">           editor.enableUndo(true);</span>
<a href="#l2.502"></a><span id="l2.502">         }</span>
<a href="#l2.503"></a><span id="l2.503"> </span>
<a href="#l2.504"></a><span id="l2.504">         // Get the text for the &lt;title&gt; from the newly-parsed document</span>
<a href="#l2.505"></a><span id="l2.505" class="difflineat">@@ -1784,21 +1800,23 @@ function UpdateWindowTitle() {</span>
<a href="#l2.506"></a><span id="l2.506">       var fileType = IsHTMLEditor() ? &quot;html&quot; : &quot;text&quot;;</span>
<a href="#l2.507"></a><span id="l2.507">       // Save changed title in the recent pages data in prefs</span>
<a href="#l2.508"></a><span id="l2.508">       SaveRecentFilesPrefs(title, fileType);</span>
<a href="#l2.509"></a><span id="l2.509">     }</span>
<a href="#l2.510"></a><span id="l2.510"> </span>
<a href="#l2.511"></a><span id="l2.511">     // Set window title with &quot; - Composer&quot; or &quot; - Text Editor&quot; appended.</span>
<a href="#l2.512"></a><span id="l2.512">     var xulWin = document.documentElement;</span>
<a href="#l2.513"></a><span id="l2.513"> </span>
<a href="#l2.514"></a><span id="l2.514" class="difflineminus">-    document.title = (title || filename || gUntitledString) +</span>
<a href="#l2.515"></a><span id="l2.515" class="difflineplus">+    document.title = (title || filename || window.gUntitledString) +</span>
<a href="#l2.516"></a><span id="l2.516">                      windowTitle +</span>
<a href="#l2.517"></a><span id="l2.517">                      xulWin.getAttribute(&quot;titlemenuseparator&quot;) +</span>
<a href="#l2.518"></a><span id="l2.518">                      xulWin.getAttribute(&quot;titlemodifier&quot;);</span>
<a href="#l2.519"></a><span id="l2.519" class="difflineminus">-  } catch (e) { dump(e); }</span>
<a href="#l2.520"></a><span id="l2.520" class="difflineplus">+  } catch (e) {</span>
<a href="#l2.521"></a><span id="l2.521" class="difflineplus">+    dump(e);</span>
<a href="#l2.522"></a><span id="l2.522" class="difflineplus">+  }</span>
<a href="#l2.523"></a><span id="l2.523"> }</span>
<a href="#l2.524"></a><span id="l2.524"> </span>
<a href="#l2.525"></a><span id="l2.525"> function SaveRecentFilesPrefs(aTitle, aFileType) {</span>
<a href="#l2.526"></a><span id="l2.526">   var curUrl = StripPassword(GetDocumentUrl());</span>
<a href="#l2.527"></a><span id="l2.527">   var historyCount = Services.prefs.getIntPref(&quot;editor.history.url_maximum&quot;);</span>
<a href="#l2.528"></a><span id="l2.528"> </span>
<a href="#l2.529"></a><span id="l2.529">   var titleArray = [];</span>
<a href="#l2.530"></a><span id="l2.530">   var urlArray = [];</span>
<a href="#l2.531"></a><span id="l2.531" class="difflineat">@@ -2054,17 +2072,19 @@ function InitAlignMenu() {</span>
<a href="#l2.532"></a><span id="l2.532"> }</span>
<a href="#l2.533"></a><span id="l2.533"> </span>
<a href="#l2.534"></a><span id="l2.534"> function EditorSetDefaultPrefsAndDoctype() {</span>
<a href="#l2.535"></a><span id="l2.535">   var editor = GetCurrentEditor();</span>
<a href="#l2.536"></a><span id="l2.536"> </span>
<a href="#l2.537"></a><span id="l2.537">   var domdoc;</span>
<a href="#l2.538"></a><span id="l2.538">   try {</span>
<a href="#l2.539"></a><span id="l2.539">     domdoc = editor.document;</span>
<a href="#l2.540"></a><span id="l2.540" class="difflineminus">-  } catch (e) { dump(e + &quot;\n&quot;); }</span>
<a href="#l2.541"></a><span id="l2.541" class="difflineplus">+  } catch (e) {</span>
<a href="#l2.542"></a><span id="l2.542" class="difflineplus">+    dump(e + &quot;\n&quot;);</span>
<a href="#l2.543"></a><span id="l2.543" class="difflineplus">+  }</span>
<a href="#l2.544"></a><span id="l2.544">   if (!domdoc) {</span>
<a href="#l2.545"></a><span id="l2.545">     dump(&quot;EditorSetDefaultPrefsAndDoctype: EDITOR DOCUMENT NOT FOUND\n&quot;);</span>
<a href="#l2.546"></a><span id="l2.546">     return;</span>
<a href="#l2.547"></a><span id="l2.547">   }</span>
<a href="#l2.548"></a><span id="l2.548"> </span>
<a href="#l2.549"></a><span id="l2.549">   // Insert a doctype element</span>
<a href="#l2.550"></a><span id="l2.550">   // if it is missing from existing doc</span>
<a href="#l2.551"></a><span id="l2.551">   if (!domdoc.doctype) {</span>
<a href="#l2.552"></a><span id="l2.552" class="difflineat">@@ -2141,17 +2161,19 @@ function EditorSetDefaultPrefsAndDoctype</span>
<a href="#l2.553"></a><span id="l2.553">       bodyelement.setAttribute(&quot;alink&quot;, Services.prefs.getCharPref(&quot;editor.active_link_color&quot;));</span>
<a href="#l2.554"></a><span id="l2.554">       bodyelement.setAttribute(&quot;vlink&quot;, Services.prefs.getCharPref(&quot;editor.followed_link_color&quot;));</span>
<a href="#l2.555"></a><span id="l2.555">     }</span>
<a href="#l2.556"></a><span id="l2.556">     // Default image is independent of Custom colors???</span>
<a href="#l2.557"></a><span id="l2.557">     try {</span>
<a href="#l2.558"></a><span id="l2.558">       let background_image = Services.prefs.getCharPref(&quot;editor.default_background_image&quot;);</span>
<a href="#l2.559"></a><span id="l2.559">       if (background_image)</span>
<a href="#l2.560"></a><span id="l2.560">         editor.setAttributeOrEquivalent(bodyelement, &quot;background&quot;, background_image, true);</span>
<a href="#l2.561"></a><span id="l2.561" class="difflineminus">-    } catch (e) { dump(&quot;BACKGROUND EXCEPTION: &quot; + e + &quot;\n&quot;); }</span>
<a href="#l2.562"></a><span id="l2.562" class="difflineplus">+    } catch (e) {</span>
<a href="#l2.563"></a><span id="l2.563" class="difflineplus">+      dump(&quot;BACKGROUND EXCEPTION: &quot; + e + &quot;\n&quot;);</span>
<a href="#l2.564"></a><span id="l2.564" class="difflineplus">+    }</span>
<a href="#l2.565"></a><span id="l2.565">   }</span>
<a href="#l2.566"></a><span id="l2.566">   // auto-save???</span>
<a href="#l2.567"></a><span id="l2.567"> }</span>
<a href="#l2.568"></a><span id="l2.568"> </span>
<a href="#l2.569"></a><span id="l2.569"> function GetBodyElement() {</span>
<a href="#l2.570"></a><span id="l2.570">   try {</span>
<a href="#l2.571"></a><span id="l2.571">     return GetCurrentEditor().rootElement;</span>
<a href="#l2.572"></a><span id="l2.572">   } catch (ex) {</span>
<a href="#l2.573"></a><span id="l2.573" class="difflineat">@@ -2410,23 +2432,21 @@ function goUpdateTableMenuItems(commands</span>
<a href="#l2.574"></a><span id="l2.574">     var commandID = commandset.childNodes[i].getAttribute(&quot;id&quot;);</span>
<a href="#l2.575"></a><span id="l2.575">     if (commandID) {</span>
<a href="#l2.576"></a><span id="l2.576">       if (commandID == &quot;cmd_InsertTable&quot; ||</span>
<a href="#l2.577"></a><span id="l2.577">           commandID == &quot;cmd_JoinTableCells&quot; ||</span>
<a href="#l2.578"></a><span id="l2.578">           commandID == &quot;cmd_SplitTableCell&quot; ||</span>
<a href="#l2.579"></a><span id="l2.579">           commandID == &quot;cmd_ConvertToTable&quot;) {</span>
<a href="#l2.580"></a><span id="l2.580">         // Call the update method in the command class</span>
<a href="#l2.581"></a><span id="l2.581">         goUpdateCommand(commandID);</span>
<a href="#l2.582"></a><span id="l2.582" class="difflineminus">-      }</span>
<a href="#l2.583"></a><span id="l2.583" class="difflineminus">-      // Directly set with the values calculated here</span>
<a href="#l2.584"></a><span id="l2.584" class="difflineminus">-      else if (commandID == &quot;cmd_DeleteTable&quot; ||</span>
<a href="#l2.585"></a><span id="l2.585" class="difflineminus">-               commandID == &quot;cmd_NormalizeTable&quot; ||</span>
<a href="#l2.586"></a><span id="l2.586" class="difflineminus">-               commandID == &quot;cmd_editTable&quot; ||</span>
<a href="#l2.587"></a><span id="l2.587" class="difflineminus">-               commandID == &quot;cmd_TableOrCellColor&quot; ||</span>
<a href="#l2.588"></a><span id="l2.588" class="difflineminus">-               commandID == &quot;cmd_SelectTable&quot;) {</span>
<a href="#l2.589"></a><span id="l2.589" class="difflineplus">+      } else if (commandID == &quot;cmd_DeleteTable&quot; ||</span>
<a href="#l2.590"></a><span id="l2.590" class="difflineplus">+                 commandID == &quot;cmd_NormalizeTable&quot; ||</span>
<a href="#l2.591"></a><span id="l2.591" class="difflineplus">+                 commandID == &quot;cmd_editTable&quot; ||</span>
<a href="#l2.592"></a><span id="l2.592" class="difflineplus">+                 commandID == &quot;cmd_TableOrCellColor&quot; ||</span>
<a href="#l2.593"></a><span id="l2.593" class="difflineplus">+                 commandID == &quot;cmd_SelectTable&quot;) { // Directly set with the values calculated here</span>
<a href="#l2.594"></a><span id="l2.594">         goSetCommandEnabled(commandID, enabledIfTable);</span>
<a href="#l2.595"></a><span id="l2.595">       } else {</span>
<a href="#l2.596"></a><span id="l2.596">         goSetCommandEnabled(commandID, enabled);</span>
<a href="#l2.597"></a><span id="l2.597">       }</span>
<a href="#l2.598"></a><span id="l2.598">     }</span>
<a href="#l2.599"></a><span id="l2.599">   }</span>
<a href="#l2.600"></a><span id="l2.600"> }</span>
<a href="#l2.601"></a><span id="l2.601"> </span>
<a href="#l2.602"></a><span id="l2.602" class="difflineat">@@ -2629,19 +2649,19 @@ function FindEditorWithInsertCharDialog(</span>
<a href="#l2.603"></a><span id="l2.603">         return tempWindow;</span>
<a href="#l2.604"></a><span id="l2.604">       }</span>
<a href="#l2.605"></a><span id="l2.605">     }</span>
<a href="#l2.606"></a><span id="l2.606">   } catch (e) {}</span>
<a href="#l2.607"></a><span id="l2.607">   return null;</span>
<a href="#l2.608"></a><span id="l2.608"> }</span>
<a href="#l2.609"></a><span id="l2.609"> </span>
<a href="#l2.610"></a><span id="l2.610"> function EditorFindOrCreateInsertCharWindow() {</span>
<a href="#l2.611"></a><span id="l2.611" class="difflineminus">-  if (&quot;InsertCharWindow&quot; in window &amp;&amp; window.InsertCharWindow)</span>
<a href="#l2.612"></a><span id="l2.612" class="difflineplus">+  if (&quot;InsertCharWindow&quot; in window &amp;&amp; window.InsertCharWindow) {</span>
<a href="#l2.613"></a><span id="l2.613">     window.InsertCharWindow.focus();</span>
<a href="#l2.614"></a><span id="l2.614" class="difflineminus">-  else {</span>
<a href="#l2.615"></a><span id="l2.615" class="difflineplus">+  } else {</span>
<a href="#l2.616"></a><span id="l2.616">     // Since we switch the dialog during EditorOnFocus(),</span>
<a href="#l2.617"></a><span id="l2.617">     //   this should really never be found, but it's good to be sure</span>
<a href="#l2.618"></a><span id="l2.618">     var windowWithDialog = FindEditorWithInsertCharDialog();</span>
<a href="#l2.619"></a><span id="l2.619">     if (windowWithDialog) {</span>
<a href="#l2.620"></a><span id="l2.620">       SwitchInsertCharToThisWindow(windowWithDialog);</span>
<a href="#l2.621"></a><span id="l2.621">     } else {</span>
<a href="#l2.622"></a><span id="l2.622">       // The dialog will set window.InsertCharWindow to itself</span>
<a href="#l2.623"></a><span id="l2.623">       window.openDialog(&quot;chrome://editor/content/EdInsertChars.xul&quot;, &quot;_blank&quot;, &quot;chrome,close,titlebar&quot;, &quot;&quot;);</span>
<a href="#l2.624"></a><span id="l2.624" class="difflineat">@@ -2681,16 +2701,17 @@ function ResetStructToolbar() {</span>
<a href="#l2.625"></a><span id="l2.625">   UpdateStructToolbar();</span>
<a href="#l2.626"></a><span id="l2.626"> }</span>
<a href="#l2.627"></a><span id="l2.627"> </span>
<a href="#l2.628"></a><span id="l2.628"> function newCommandListener(element) {</span>
<a href="#l2.629"></a><span id="l2.629">   return function() { return SelectFocusNodeAncestor(element); };</span>
<a href="#l2.630"></a><span id="l2.630"> }</span>
<a href="#l2.631"></a><span id="l2.631"> </span>
<a href="#l2.632"></a><span id="l2.632"> function newContextmenuListener(button, element) {</span>
<a href="#l2.633"></a><span id="l2.633" class="difflineplus">+  /* globals InitStructBarContextMenu */// SeaMonkey only.</span>
<a href="#l2.634"></a><span id="l2.634">   return function() { return InitStructBarContextMenu(button, element); };</span>
<a href="#l2.635"></a><span id="l2.635"> }</span>
<a href="#l2.636"></a><span id="l2.636"> </span>
<a href="#l2.637"></a><span id="l2.637"> function UpdateStructToolbar() {</span>
<a href="#l2.638"></a><span id="l2.638">   var editor = GetCurrentEditor();</span>
<a href="#l2.639"></a><span id="l2.639">   if (!editor) return;</span>
<a href="#l2.640"></a><span id="l2.640"> </span>
<a href="#l2.641"></a><span id="l2.641">   var mixed = GetSelectionContainer();</span>
<a href="#l2.642"></a><span id="l2.642" class="difflineat">@@ -2762,20 +2783,23 @@ function SelectFocusNodeAncestor(element</span>
<a href="#l2.643"></a><span id="l2.643">   }</span>
<a href="#l2.644"></a><span id="l2.644">   ResetStructToolbar();</span>
<a href="#l2.645"></a><span id="l2.645"> }</span>
<a href="#l2.646"></a><span id="l2.646"> </span>
<a href="#l2.647"></a><span id="l2.647"> function GetSelectionContainer() {</span>
<a href="#l2.648"></a><span id="l2.648">   var editor = GetCurrentEditor();</span>
<a href="#l2.649"></a><span id="l2.649">   if (!editor) return null;</span>
<a href="#l2.650"></a><span id="l2.650"> </span>
<a href="#l2.651"></a><span id="l2.651" class="difflineplus">+  var selection;</span>
<a href="#l2.652"></a><span id="l2.652">   try {</span>
<a href="#l2.653"></a><span id="l2.653" class="difflineminus">-    var selection = editor.selection;</span>
<a href="#l2.654"></a><span id="l2.654" class="difflineplus">+    selection = editor.selection;</span>
<a href="#l2.655"></a><span id="l2.655">     if (!selection) return null;</span>
<a href="#l2.656"></a><span id="l2.656" class="difflineminus">-  } catch (e) { return null; }</span>
<a href="#l2.657"></a><span id="l2.657" class="difflineplus">+  } catch (e) {</span>
<a href="#l2.658"></a><span id="l2.658" class="difflineplus">+    return null;</span>
<a href="#l2.659"></a><span id="l2.659" class="difflineplus">+  }</span>
<a href="#l2.660"></a><span id="l2.660"> </span>
<a href="#l2.661"></a><span id="l2.661">   var result = { oneElementSelected: false };</span>
<a href="#l2.662"></a><span id="l2.662"> </span>
<a href="#l2.663"></a><span id="l2.663">   if (selection.isCollapsed) {</span>
<a href="#l2.664"></a><span id="l2.664">     result.node = selection.focusNode;</span>
<a href="#l2.665"></a><span id="l2.665">   } else {</span>
<a href="#l2.666"></a><span id="l2.666">     var rangeCount = selection.rangeCount;</span>
<a href="#l2.667"></a><span id="l2.667">     if (rangeCount == 1) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/editor/ui/composer/content/editorUtilities.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/editor/ui/composer/content/editorUtilities.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l3.4"></a><span id="l3.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l3.5"></a><span id="l3.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l3.6"></a><span id="l3.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8" class="difflineplus">+/* import-globals-from editor.js */</span>
<a href="#l3.9"></a><span id="l3.9" class="difflineplus">+</span>
<a href="#l3.10"></a><span id="l3.10"> var {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l3.11"></a><span id="l3.11"> var {AppConstants} = ChromeUtils.import(&quot;resource://gre/modules/AppConstants.jsm&quot;);</span>
<a href="#l3.12"></a><span id="l3.12"> </span>
<a href="#l3.13"></a><span id="l3.13"> /** ** NAMESPACES ****/</span>
<a href="#l3.14"></a><span id="l3.14"> const XUL_NS = &quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;;</span>
<a href="#l3.15"></a><span id="l3.15"> </span>
<a href="#l3.16"></a><span id="l3.16"> // Each editor window must include this file</span>
<a href="#l3.17"></a><span id="l3.17"> // Variables  shared by all dialogs:</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineat">@@ -151,17 +153,19 @@ function GetCurrentEditor() {</span>
<a href="#l3.19"></a><span id="l3.19">   try {</span>
<a href="#l3.20"></a><span id="l3.20">     var editorElement = GetCurrentEditorElement();</span>
<a href="#l3.21"></a><span id="l3.21">     editor = editorElement.getEditor(editorElement.contentWindow);</span>
<a href="#l3.22"></a><span id="l3.22"> </span>
<a href="#l3.23"></a><span id="l3.23">     // Do QIs now so editor users won't have to figure out which interface to use</span>
<a href="#l3.24"></a><span id="l3.24">     // Using &quot;instanceof&quot; does the QI for us.</span>
<a href="#l3.25"></a><span id="l3.25">     editor instanceof Ci.nsIPlaintextEditor;</span>
<a href="#l3.26"></a><span id="l3.26">     editor instanceof Ci.nsIHTMLEditor;</span>
<a href="#l3.27"></a><span id="l3.27" class="difflineminus">-  } catch (e) { dump(e) + &quot;\n&quot;; }</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineplus">+  } catch (e) {</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineplus">+    dump(e) + &quot;\n&quot;;</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineplus">+  }</span>
<a href="#l3.31"></a><span id="l3.31"> </span>
<a href="#l3.32"></a><span id="l3.32">   return editor;</span>
<a href="#l3.33"></a><span id="l3.33"> }</span>
<a href="#l3.34"></a><span id="l3.34"> </span>
<a href="#l3.35"></a><span id="l3.35"> function GetCurrentTableEditor() {</span>
<a href="#l3.36"></a><span id="l3.36">   var editor = GetCurrentEditor();</span>
<a href="#l3.37"></a><span id="l3.37">   return (editor &amp;&amp; (editor instanceof nsITableEditor)) ? editor : null;</span>
<a href="#l3.38"></a><span id="l3.38"> }</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineat">@@ -182,25 +186,29 @@ function GetCurrentEditorElement() {</span>
<a href="#l3.40"></a><span id="l3.40">   while (tmpWindow);</span>
<a href="#l3.41"></a><span id="l3.41"> </span>
<a href="#l3.42"></a><span id="l3.42">   return null;</span>
<a href="#l3.43"></a><span id="l3.43"> }</span>
<a href="#l3.44"></a><span id="l3.44"> </span>
<a href="#l3.45"></a><span id="l3.45"> function GetCurrentCommandManager() {</span>
<a href="#l3.46"></a><span id="l3.46">   try {</span>
<a href="#l3.47"></a><span id="l3.47">     return GetCurrentEditorElement().commandManager;</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineminus">-  } catch (e) { dump(e) + &quot;\n&quot;; }</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineplus">+  } catch (e) {</span>
<a href="#l3.50"></a><span id="l3.50" class="difflineplus">+    dump(e) + &quot;\n&quot;;</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineplus">+  }</span>
<a href="#l3.52"></a><span id="l3.52"> </span>
<a href="#l3.53"></a><span id="l3.53">   return null;</span>
<a href="#l3.54"></a><span id="l3.54"> }</span>
<a href="#l3.55"></a><span id="l3.55"> </span>
<a href="#l3.56"></a><span id="l3.56"> function GetCurrentEditorType() {</span>
<a href="#l3.57"></a><span id="l3.57">   try {</span>
<a href="#l3.58"></a><span id="l3.58">     return GetCurrentEditorElement().editortype;</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineminus">-  } catch (e) { dump(e) + &quot;\n&quot;; }</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineplus">+  } catch (e) {</span>
<a href="#l3.61"></a><span id="l3.61" class="difflineplus">+    dump(e) + &quot;\n&quot;;</span>
<a href="#l3.62"></a><span id="l3.62" class="difflineplus">+  }</span>
<a href="#l3.63"></a><span id="l3.63"> </span>
<a href="#l3.64"></a><span id="l3.64">   return &quot;&quot;;</span>
<a href="#l3.65"></a><span id="l3.65"> }</span>
<a href="#l3.66"></a><span id="l3.66"> </span>
<a href="#l3.67"></a><span id="l3.67"> function IsHTMLEditor() {</span>
<a href="#l3.68"></a><span id="l3.68">   // We don't have an editorElement, just return false</span>
<a href="#l3.69"></a><span id="l3.69">   if (!GetCurrentEditorElement())</span>
<a href="#l3.70"></a><span id="l3.70">     return false;</span>
<a href="#l3.71"></a><span id="l3.71" class="difflineat">@@ -267,25 +275,27 @@ function IsDocumentModified() {</span>
<a href="#l3.72"></a><span id="l3.72"> function IsHTMLSourceChanged() {</span>
<a href="#l3.73"></a><span id="l3.73">   // gSourceTextEditor will not be defined if we're just a text editor.</span>
<a href="#l3.74"></a><span id="l3.74">   return gSourceTextEditor ? gSourceTextEditor.documentModified : false;</span>
<a href="#l3.75"></a><span id="l3.75"> }</span>
<a href="#l3.76"></a><span id="l3.76"> </span>
<a href="#l3.77"></a><span id="l3.77"> function newCommandParams() {</span>
<a href="#l3.78"></a><span id="l3.78">   try {</span>
<a href="#l3.79"></a><span id="l3.79">     return Cu.createCommandParams();</span>
<a href="#l3.80"></a><span id="l3.80" class="difflineminus">-  } catch (e) { dump(&quot;error thrown in newCommandParams: &quot; + e + &quot;\n&quot;); }</span>
<a href="#l3.81"></a><span id="l3.81" class="difflineplus">+  } catch (e) {</span>
<a href="#l3.82"></a><span id="l3.82" class="difflineplus">+    dump(&quot;error thrown in newCommandParams: &quot; + e + &quot;\n&quot;);</span>
<a href="#l3.83"></a><span id="l3.83" class="difflineplus">+  }</span>
<a href="#l3.84"></a><span id="l3.84">   return null;</span>
<a href="#l3.85"></a><span id="l3.85"> }</span>
<a href="#l3.86"></a><span id="l3.86"> </span>
<a href="#l3.87"></a><span id="l3.87"> /** *********** General editing command utilities ***************/</span>
<a href="#l3.88"></a><span id="l3.88"> </span>
<a href="#l3.89"></a><span id="l3.89"> function GetDocumentTitle() {</span>
<a href="#l3.90"></a><span id="l3.90">   try {</span>
<a href="#l3.91"></a><span id="l3.91" class="difflineminus">-    return new XPCNativeWrapper(GetCurrentEditor().document, &quot;title&quot;).title;</span>
<a href="#l3.92"></a><span id="l3.92" class="difflineplus">+    return GetCurrentEditorElement().contentDocument.title;</span>
<a href="#l3.93"></a><span id="l3.93">   } catch (e) {}</span>
<a href="#l3.94"></a><span id="l3.94"> </span>
<a href="#l3.95"></a><span id="l3.95">   return &quot;&quot;;</span>
<a href="#l3.96"></a><span id="l3.96"> }</span>
<a href="#l3.97"></a><span id="l3.97"> </span>
<a href="#l3.98"></a><span id="l3.98"> function SetDocumentTitle(title) {</span>
<a href="#l3.99"></a><span id="l3.99">   try {</span>
<a href="#l3.100"></a><span id="l3.100">     GetCurrentEditorElement().contentDocument.title = title;</span>
<a href="#l3.101"></a><span id="l3.101" class="difflineat">@@ -387,23 +397,21 @@ function SaveFilePickerDirectory(filePic</span>
<a href="#l3.102"></a><span id="l3.102">   if (gFilePickerDirectory)</span>
<a href="#l3.103"></a><span id="l3.103">     filePicker.displayDirectory = gFilePickerDirectory;</span>
<a href="#l3.104"></a><span id="l3.104"> </span>
<a href="#l3.105"></a><span id="l3.105">   gFilePickerDirectory = null;</span>
<a href="#l3.106"></a><span id="l3.106"> }</span>
<a href="#l3.107"></a><span id="l3.107"> </span>
<a href="#l3.108"></a><span id="l3.108"> function GetDefaultBrowserColors() {</span>
<a href="#l3.109"></a><span id="l3.109">   var colors = { TextColor: 0, BackgroundColor: 0, LinkColor: 0, ActiveLinkColor: 0, VisitedLinkColor: 0 };</span>
<a href="#l3.110"></a><span id="l3.110" class="difflineminus">-  var useSysColors = false;</span>
<a href="#l3.111"></a><span id="l3.111" class="difflineminus">-  try { useSysColors = Services.prefs.getBoolPref(&quot;browser.display.use_system_colors&quot;); } catch (e) {}</span>
<a href="#l3.112"></a><span id="l3.112" class="difflineplus">+  var useSysColors = Services.prefs.getBoolPref(&quot;browser.display.use_system_colors&quot;, false);</span>
<a href="#l3.113"></a><span id="l3.113"> </span>
<a href="#l3.114"></a><span id="l3.114">   if (!useSysColors) {</span>
<a href="#l3.115"></a><span id="l3.115" class="difflineminus">-    try { colors.TextColor = Services.prefs.getCharPref(&quot;browser.display.foreground_color&quot;); } catch (e) {}</span>
<a href="#l3.116"></a><span id="l3.116" class="difflineminus">-</span>
<a href="#l3.117"></a><span id="l3.117" class="difflineminus">-    try { colors.BackgroundColor = Services.prefs.getCharPref(&quot;browser.display.background_color&quot;); } catch (e) {}</span>
<a href="#l3.118"></a><span id="l3.118" class="difflineplus">+    colors.TextColor = Services.prefs.getCharPref(&quot;browser.display.foreground_color&quot;, 0);</span>
<a href="#l3.119"></a><span id="l3.119" class="difflineplus">+    colors.BackgroundColor = Services.prefs.getCharPref(&quot;browser.display.background_color&quot;, 0);</span>
<a href="#l3.120"></a><span id="l3.120">   }</span>
<a href="#l3.121"></a><span id="l3.121">   // Use OS colors for text and background if explicitly asked or pref is not set</span>
<a href="#l3.122"></a><span id="l3.122">   if (!colors.TextColor)</span>
<a href="#l3.123"></a><span id="l3.123">     colors.TextColor = &quot;windowtext&quot;;</span>
<a href="#l3.124"></a><span id="l3.124"> </span>
<a href="#l3.125"></a><span id="l3.125">   if (!colors.BackgroundColor)</span>
<a href="#l3.126"></a><span id="l3.126">     colors.BackgroundColor = &quot;window&quot;;</span>
<a href="#l3.127"></a><span id="l3.127"> </span>
<a href="#l3.128"></a><span id="l3.128" class="difflineat">@@ -515,18 +523,19 @@ function MakeRelativeUrl(url) {</span>
<a href="#l3.129"></a><span id="l3.129">         //   (the first &quot;dir&quot; in the path) because we can't</span>
<a href="#l3.130"></a><span id="l3.130">         //   relativize to different drives/volumes.</span>
<a href="#l3.131"></a><span id="l3.131">         // UNIX doesn't have volumes, so we must not do this else</span>
<a href="#l3.132"></a><span id="l3.132">         // the first directory will be misinterpreted as a volume name.</span>
<a href="#l3.133"></a><span id="l3.133">         if (firstDirTest &amp;&amp; docScheme == &quot;file&quot; &amp;&amp;</span>
<a href="#l3.134"></a><span id="l3.134">             AppConstants.platform != &quot;unix&quot;)</span>
<a href="#l3.135"></a><span id="l3.135">           return inputUrl;</span>
<a href="#l3.136"></a><span id="l3.136">       }</span>
<a href="#l3.137"></a><span id="l3.137" class="difflineminus">-    } else  // No more doc dirs left, we're done</span>
<a href="#l3.138"></a><span id="l3.138" class="difflineplus">+    } else { // No more doc dirs left, we're done</span>
<a href="#l3.139"></a><span id="l3.139">       done = true;</span>
<a href="#l3.140"></a><span id="l3.140" class="difflineplus">+    }</span>
<a href="#l3.141"></a><span id="l3.141"> </span>
<a href="#l3.142"></a><span id="l3.142">     firstDirTest = false;</span>
<a href="#l3.143"></a><span id="l3.143">   }</span>
<a href="#l3.144"></a><span id="l3.144">   while (!done);</span>
<a href="#l3.145"></a><span id="l3.145"> </span>
<a href="#l3.146"></a><span id="l3.146">   // Add &quot;../&quot; for each dir left in docPath</span>
<a href="#l3.147"></a><span id="l3.147">   while (nextDocSlash &gt; 0) {</span>
<a href="#l3.148"></a><span id="l3.148">     urlPath = &quot;../&quot; + urlPath;</span>
<a href="#l3.149"></a><span id="l3.149" class="difflineat">@@ -718,17 +727,17 @@ function StripPassword(urlspec, password</span>
<a href="#l3.150"></a><span id="l3.150"> // Version to use when you have an nsIURI object</span>
<a href="#l3.151"></a><span id="l3.151"> function StripUsernamePasswordFromURI(uri) {</span>
<a href="#l3.152"></a><span id="l3.152">   var urlspec = &quot;&quot;;</span>
<a href="#l3.153"></a><span id="l3.153">   if (uri) {</span>
<a href="#l3.154"></a><span id="l3.154">     try {</span>
<a href="#l3.155"></a><span id="l3.155">       urlspec = uri.spec;</span>
<a href="#l3.156"></a><span id="l3.156">       var userPass = uri.userPass;</span>
<a href="#l3.157"></a><span id="l3.157">       if (userPass) {</span>
<a href="#l3.158"></a><span id="l3.158" class="difflineminus">-        start = urlspec.indexOf(userPass);</span>
<a href="#l3.159"></a><span id="l3.159" class="difflineplus">+        let start = urlspec.indexOf(userPass);</span>
<a href="#l3.160"></a><span id="l3.160">         urlspec = urlspec.slice(0, start) + urlspec.slice(start + userPass.length + 1);</span>
<a href="#l3.161"></a><span id="l3.161">       }</span>
<a href="#l3.162"></a><span id="l3.162">     } catch (e) {}</span>
<a href="#l3.163"></a><span id="l3.163">   }</span>
<a href="#l3.164"></a><span id="l3.164">   return urlspec;</span>
<a href="#l3.165"></a><span id="l3.165"> }</span>
<a href="#l3.166"></a><span id="l3.166"> </span>
<a href="#l3.167"></a><span id="l3.167"> function InsertUsernameIntoUrl(urlspec, username) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdAEAttributes.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdAEAttributes.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -6,47 +6,44 @@</span>
<a href="#l4.4"></a><span id="l4.4"> var gHTMLAttr = {};</span>
<a href="#l4.5"></a><span id="l4.5"> </span>
<a href="#l4.6"></a><span id="l4.6"> // JS Events Attributes object for &quot;Name&quot; menulist</span>
<a href="#l4.7"></a><span id="l4.7"> var gJSAttr = {};</span>
<a href="#l4.8"></a><span id="l4.8"> </span>
<a href="#l4.9"></a><span id="l4.9"> </span>
<a href="#l4.10"></a><span id="l4.10"> // Core HTML attribute values //</span>
<a href="#l4.11"></a><span id="l4.11"> // This is appended to Name menulist when &quot;_core&quot; is attribute name</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-var gCoreHTMLAttr =</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-[</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+var gCoreHTMLAttr = [</span>
<a href="#l4.15"></a><span id="l4.15">   &quot;^id&quot;,</span>
<a href="#l4.16"></a><span id="l4.16">   &quot;class&quot;,</span>
<a href="#l4.17"></a><span id="l4.17">   &quot;title&quot;,</span>
<a href="#l4.18"></a><span id="l4.18"> ];</span>
<a href="#l4.19"></a><span id="l4.19"> </span>
<a href="#l4.20"></a><span id="l4.20"> // Core event attribute values //</span>
<a href="#l4.21"></a><span id="l4.21"> // This is appended to all JS menulists</span>
<a href="#l4.22"></a><span id="l4.22"> //   except those elements having &quot;noJSEvents&quot;</span>
<a href="#l4.23"></a><span id="l4.23"> //   as a value in their gJSAttr array.</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineminus">-var gCoreJSEvents =</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineminus">-[</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineplus">+var gCoreJSEvents = [</span>
<a href="#l4.27"></a><span id="l4.27">   &quot;onclick&quot;,</span>
<a href="#l4.28"></a><span id="l4.28">   &quot;ondblclick&quot;,</span>
<a href="#l4.29"></a><span id="l4.29">   &quot;onmousedown&quot;,</span>
<a href="#l4.30"></a><span id="l4.30">   &quot;onmouseup&quot;,</span>
<a href="#l4.31"></a><span id="l4.31">   &quot;onmouseover&quot;,</span>
<a href="#l4.32"></a><span id="l4.32">   &quot;onmousemove&quot;,</span>
<a href="#l4.33"></a><span id="l4.33">   &quot;onmouseout&quot;,</span>
<a href="#l4.34"></a><span id="l4.34">   &quot;-&quot;,</span>
<a href="#l4.35"></a><span id="l4.35">   &quot;onkeypress&quot;,</span>
<a href="#l4.36"></a><span id="l4.36">   &quot;onkeydown&quot;,</span>
<a href="#l4.37"></a><span id="l4.37">   &quot;onkeyup&quot;,</span>
<a href="#l4.38"></a><span id="l4.38"> ];</span>
<a href="#l4.39"></a><span id="l4.39"> </span>
<a href="#l4.40"></a><span id="l4.40"> // Following are commonly-used strings</span>
<a href="#l4.41"></a><span id="l4.41"> </span>
<a href="#l4.42"></a><span id="l4.42"> // Also accept: sRGB: #RRGGBB //</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineminus">-var gHTMLColors =</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineminus">-[</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineplus">+var gHTMLColors = [</span>
<a href="#l4.46"></a><span id="l4.46">   &quot;Aqua&quot;,</span>
<a href="#l4.47"></a><span id="l4.47">   &quot;Black&quot;,</span>
<a href="#l4.48"></a><span id="l4.48">   &quot;Blue&quot;,</span>
<a href="#l4.49"></a><span id="l4.49">   &quot;Fuchsia&quot;,</span>
<a href="#l4.50"></a><span id="l4.50">   &quot;Gray&quot;,</span>
<a href="#l4.51"></a><span id="l4.51">   &quot;Green&quot;,</span>
<a href="#l4.52"></a><span id="l4.52">   &quot;Lime&quot;,</span>
<a href="#l4.53"></a><span id="l4.53">   &quot;Maroon&quot;,</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineat">@@ -55,50 +52,45 @@ var gHTMLColors =</span>
<a href="#l4.55"></a><span id="l4.55">   &quot;Purple&quot;,</span>
<a href="#l4.56"></a><span id="l4.56">   &quot;Red&quot;,</span>
<a href="#l4.57"></a><span id="l4.57">   &quot;Silver&quot;,</span>
<a href="#l4.58"></a><span id="l4.58">   &quot;Teal&quot;,</span>
<a href="#l4.59"></a><span id="l4.59">   &quot;White&quot;,</span>
<a href="#l4.60"></a><span id="l4.60">   &quot;Yellow&quot;,</span>
<a href="#l4.61"></a><span id="l4.61"> ];</span>
<a href="#l4.62"></a><span id="l4.62"> </span>
<a href="#l4.63"></a><span id="l4.63" class="difflineminus">-var gHAlign =</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineminus">-[</span>
<a href="#l4.65"></a><span id="l4.65" class="difflineplus">+var gHAlign = [</span>
<a href="#l4.66"></a><span id="l4.66">   &quot;left&quot;,</span>
<a href="#l4.67"></a><span id="l4.67">   &quot;center&quot;,</span>
<a href="#l4.68"></a><span id="l4.68">   &quot;right&quot;,</span>
<a href="#l4.69"></a><span id="l4.69"> ];</span>
<a href="#l4.70"></a><span id="l4.70"> </span>
<a href="#l4.71"></a><span id="l4.71" class="difflineminus">-var gHAlignJustify =</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineminus">-[</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineplus">+var gHAlignJustify = [</span>
<a href="#l4.74"></a><span id="l4.74">   &quot;left&quot;,</span>
<a href="#l4.75"></a><span id="l4.75">   &quot;center&quot;,</span>
<a href="#l4.76"></a><span id="l4.76">   &quot;right&quot;,</span>
<a href="#l4.77"></a><span id="l4.77">   &quot;justify&quot;,</span>
<a href="#l4.78"></a><span id="l4.78"> ];</span>
<a href="#l4.79"></a><span id="l4.79"> </span>
<a href="#l4.80"></a><span id="l4.80" class="difflineminus">-var gHAlignTableContent =</span>
<a href="#l4.81"></a><span id="l4.81" class="difflineminus">-[</span>
<a href="#l4.82"></a><span id="l4.82" class="difflineplus">+var gHAlignTableContent = [</span>
<a href="#l4.83"></a><span id="l4.83">   &quot;left&quot;,</span>
<a href="#l4.84"></a><span id="l4.84">   &quot;center&quot;,</span>
<a href="#l4.85"></a><span id="l4.85">   &quot;right&quot;,</span>
<a href="#l4.86"></a><span id="l4.86">   &quot;justify&quot;,</span>
<a href="#l4.87"></a><span id="l4.87">   &quot;char&quot;,</span>
<a href="#l4.88"></a><span id="l4.88"> ];</span>
<a href="#l4.89"></a><span id="l4.89"> </span>
<a href="#l4.90"></a><span id="l4.90" class="difflineminus">-var gVAlignTable =</span>
<a href="#l4.91"></a><span id="l4.91" class="difflineminus">-[</span>
<a href="#l4.92"></a><span id="l4.92" class="difflineplus">+var gVAlignTable = [</span>
<a href="#l4.93"></a><span id="l4.93">   &quot;top&quot;,</span>
<a href="#l4.94"></a><span id="l4.94">   &quot;middle&quot;,</span>
<a href="#l4.95"></a><span id="l4.95">   &quot;bottom&quot;,</span>
<a href="#l4.96"></a><span id="l4.96">   &quot;baseline&quot;,</span>
<a href="#l4.97"></a><span id="l4.97"> ];</span>
<a href="#l4.98"></a><span id="l4.98"> </span>
<a href="#l4.99"></a><span id="l4.99" class="difflineminus">-var gTarget =</span>
<a href="#l4.100"></a><span id="l4.100" class="difflineminus">-[</span>
<a href="#l4.101"></a><span id="l4.101" class="difflineplus">+var gTarget = [</span>
<a href="#l4.102"></a><span id="l4.102">   &quot;_blank&quot;,</span>
<a href="#l4.103"></a><span id="l4.103">   &quot;_self&quot;,</span>
<a href="#l4.104"></a><span id="l4.104">   &quot;_parent&quot;,</span>
<a href="#l4.105"></a><span id="l4.105">   &quot;_top&quot;,</span>
<a href="#l4.106"></a><span id="l4.106"> ];</span>
<a href="#l4.107"></a><span id="l4.107"> </span>
<a href="#l4.108"></a><span id="l4.108"> // ================ HTML Attributes ================ //</span>
<a href="#l4.109"></a><span id="l4.109"> /* For each element, there is an array of attributes,</span>
<a href="#l4.110"></a><span id="l4.110" class="difflineat">@@ -119,25 +111,23 @@ var gTarget =</span>
<a href="#l4.111"></a><span id="l4.111"> */</span>
<a href="#l4.112"></a><span id="l4.112"> </span>
<a href="#l4.113"></a><span id="l4.113"> /*</span>
<a href="#l4.114"></a><span id="l4.114">    Most elements have the &quot;dir&quot; attribute,</span>
<a href="#l4.115"></a><span id="l4.115">    so we use this value array</span>
<a href="#l4.116"></a><span id="l4.116">    for all elements instead of specifying</span>
<a href="#l4.117"></a><span id="l4.117">    separately for each element</span>
<a href="#l4.118"></a><span id="l4.118"> */</span>
<a href="#l4.119"></a><span id="l4.119" class="difflineminus">-gHTMLAttr.all_dir =</span>
<a href="#l4.120"></a><span id="l4.120" class="difflineminus">-[</span>
<a href="#l4.121"></a><span id="l4.121" class="difflineplus">+gHTMLAttr.all_dir = [</span>
<a href="#l4.122"></a><span id="l4.122">   &quot;ltr&quot;,</span>
<a href="#l4.123"></a><span id="l4.123">   &quot;rtl&quot;,</span>
<a href="#l4.124"></a><span id="l4.124"> ];</span>
<a href="#l4.125"></a><span id="l4.125"> </span>
<a href="#l4.126"></a><span id="l4.126"> </span>
<a href="#l4.127"></a><span id="l4.127" class="difflineminus">-gHTMLAttr.a =</span>
<a href="#l4.128"></a><span id="l4.128" class="difflineminus">-[</span>
<a href="#l4.129"></a><span id="l4.129" class="difflineplus">+gHTMLAttr.a = [</span>
<a href="#l4.130"></a><span id="l4.130">   &quot;charset&quot;,</span>
<a href="#l4.131"></a><span id="l4.131">   &quot;type&quot;,</span>
<a href="#l4.132"></a><span id="l4.132">   &quot;name&quot;,</span>
<a href="#l4.133"></a><span id="l4.133">   &quot;href&quot;,</span>
<a href="#l4.134"></a><span id="l4.134">   &quot;^hreflang&quot;,</span>
<a href="#l4.135"></a><span id="l4.135">   &quot;target&quot;,</span>
<a href="#l4.136"></a><span id="l4.136">   &quot;rel&quot;,</span>
<a href="#l4.137"></a><span id="l4.137">   &quot;rev&quot;,</span>
<a href="#l4.138"></a><span id="l4.138" class="difflineat">@@ -149,18 +139,17 @@ gHTMLAttr.a =</span>
<a href="#l4.139"></a><span id="l4.139">   &quot;_core&quot;,</span>
<a href="#l4.140"></a><span id="l4.140">   &quot;-&quot;,</span>
<a href="#l4.141"></a><span id="l4.141">   &quot;^lang&quot;,</span>
<a href="#l4.142"></a><span id="l4.142">   &quot;dir&quot;,</span>
<a href="#l4.143"></a><span id="l4.143"> ];</span>
<a href="#l4.144"></a><span id="l4.144"> </span>
<a href="#l4.145"></a><span id="l4.145"> gHTMLAttr.a_target = gTarget;</span>
<a href="#l4.146"></a><span id="l4.146"> </span>
<a href="#l4.147"></a><span id="l4.147" class="difflineminus">-gHTMLAttr.a_rel =</span>
<a href="#l4.148"></a><span id="l4.148" class="difflineminus">-[</span>
<a href="#l4.149"></a><span id="l4.149" class="difflineplus">+gHTMLAttr.a_rel = [</span>
<a href="#l4.150"></a><span id="l4.150">   &quot;alternate&quot;,</span>
<a href="#l4.151"></a><span id="l4.151">   &quot;stylesheet&quot;,</span>
<a href="#l4.152"></a><span id="l4.152">   &quot;start&quot;,</span>
<a href="#l4.153"></a><span id="l4.153">   &quot;next&quot;,</span>
<a href="#l4.154"></a><span id="l4.154">   &quot;prev&quot;,</span>
<a href="#l4.155"></a><span id="l4.155">   &quot;contents&quot;,</span>
<a href="#l4.156"></a><span id="l4.156">   &quot;index&quot;,</span>
<a href="#l4.157"></a><span id="l4.157">   &quot;glossary&quot;,</span>
<a href="#l4.158"></a><span id="l4.158" class="difflineat">@@ -168,18 +157,17 @@ gHTMLAttr.a_rel =</span>
<a href="#l4.159"></a><span id="l4.159">   &quot;chapter&quot;,</span>
<a href="#l4.160"></a><span id="l4.160">   &quot;section&quot;,</span>
<a href="#l4.161"></a><span id="l4.161">   &quot;subsection&quot;,</span>
<a href="#l4.162"></a><span id="l4.162">   &quot;appendix&quot;,</span>
<a href="#l4.163"></a><span id="l4.163">   &quot;help&quot;,</span>
<a href="#l4.164"></a><span id="l4.164">   &quot;bookmark&quot;,</span>
<a href="#l4.165"></a><span id="l4.165"> ];</span>
<a href="#l4.166"></a><span id="l4.166"> </span>
<a href="#l4.167"></a><span id="l4.167" class="difflineminus">-gHTMLAttr.a_rev =</span>
<a href="#l4.168"></a><span id="l4.168" class="difflineminus">-[</span>
<a href="#l4.169"></a><span id="l4.169" class="difflineplus">+gHTMLAttr.a_rev = [</span>
<a href="#l4.170"></a><span id="l4.170">   &quot;alternate&quot;,</span>
<a href="#l4.171"></a><span id="l4.171">   &quot;stylesheet&quot;,</span>
<a href="#l4.172"></a><span id="l4.172">   &quot;start&quot;,</span>
<a href="#l4.173"></a><span id="l4.173">   &quot;next&quot;,</span>
<a href="#l4.174"></a><span id="l4.174">   &quot;prev&quot;,</span>
<a href="#l4.175"></a><span id="l4.175">   &quot;contents&quot;,</span>
<a href="#l4.176"></a><span id="l4.176">   &quot;index&quot;,</span>
<a href="#l4.177"></a><span id="l4.177">   &quot;glossary&quot;,</span>
<a href="#l4.178"></a><span id="l4.178" class="difflineat">@@ -187,77 +175,70 @@ gHTMLAttr.a_rev =</span>
<a href="#l4.179"></a><span id="l4.179">   &quot;chapter&quot;,</span>
<a href="#l4.180"></a><span id="l4.180">   &quot;section&quot;,</span>
<a href="#l4.181"></a><span id="l4.181">   &quot;subsection&quot;,</span>
<a href="#l4.182"></a><span id="l4.182">   &quot;appendix&quot;,</span>
<a href="#l4.183"></a><span id="l4.183">   &quot;help&quot;,</span>
<a href="#l4.184"></a><span id="l4.184">   &quot;bookmark&quot;,</span>
<a href="#l4.185"></a><span id="l4.185"> ];</span>
<a href="#l4.186"></a><span id="l4.186"> </span>
<a href="#l4.187"></a><span id="l4.187" class="difflineminus">-gHTMLAttr.a_shape =</span>
<a href="#l4.188"></a><span id="l4.188" class="difflineminus">-[</span>
<a href="#l4.189"></a><span id="l4.189" class="difflineplus">+gHTMLAttr.a_shape = [</span>
<a href="#l4.190"></a><span id="l4.190">   &quot;rect&quot;,</span>
<a href="#l4.191"></a><span id="l4.191">   &quot;circle&quot;,</span>
<a href="#l4.192"></a><span id="l4.192">   &quot;poly&quot;,</span>
<a href="#l4.193"></a><span id="l4.193">   &quot;default&quot;,</span>
<a href="#l4.194"></a><span id="l4.194"> ];</span>
<a href="#l4.195"></a><span id="l4.195"> </span>
<a href="#l4.196"></a><span id="l4.196" class="difflineminus">-gHTMLAttr.abbr =</span>
<a href="#l4.197"></a><span id="l4.197" class="difflineminus">-[</span>
<a href="#l4.198"></a><span id="l4.198" class="difflineplus">+gHTMLAttr.abbr = [</span>
<a href="#l4.199"></a><span id="l4.199">   &quot;_core&quot;,</span>
<a href="#l4.200"></a><span id="l4.200">   &quot;-&quot;,</span>
<a href="#l4.201"></a><span id="l4.201">   &quot;^lang&quot;,</span>
<a href="#l4.202"></a><span id="l4.202">   &quot;dir&quot;,</span>
<a href="#l4.203"></a><span id="l4.203"> ];</span>
<a href="#l4.204"></a><span id="l4.204"> </span>
<a href="#l4.205"></a><span id="l4.205" class="difflineminus">-gHTMLAttr.acronym =</span>
<a href="#l4.206"></a><span id="l4.206" class="difflineminus">-[</span>
<a href="#l4.207"></a><span id="l4.207" class="difflineplus">+gHTMLAttr.acronym = [</span>
<a href="#l4.208"></a><span id="l4.208">   &quot;_core&quot;,</span>
<a href="#l4.209"></a><span id="l4.209">   &quot;-&quot;,</span>
<a href="#l4.210"></a><span id="l4.210">   &quot;^lang&quot;,</span>
<a href="#l4.211"></a><span id="l4.211">   &quot;dir&quot;,</span>
<a href="#l4.212"></a><span id="l4.212"> ];</span>
<a href="#l4.213"></a><span id="l4.213"> </span>
<a href="#l4.214"></a><span id="l4.214" class="difflineminus">-gHTMLAttr.address =</span>
<a href="#l4.215"></a><span id="l4.215" class="difflineminus">-[</span>
<a href="#l4.216"></a><span id="l4.216" class="difflineplus">+gHTMLAttr.address = [</span>
<a href="#l4.217"></a><span id="l4.217">   &quot;_core&quot;,</span>
<a href="#l4.218"></a><span id="l4.218">   &quot;-&quot;,</span>
<a href="#l4.219"></a><span id="l4.219">   &quot;^lang&quot;,</span>
<a href="#l4.220"></a><span id="l4.220">   &quot;dir&quot;,</span>
<a href="#l4.221"></a><span id="l4.221"> ];</span>
<a href="#l4.222"></a><span id="l4.222"> </span>
<a href="#l4.223"></a><span id="l4.223"> // this is deprecated //</span>
<a href="#l4.224"></a><span id="l4.224" class="difflineminus">-gHTMLAttr.applet =</span>
<a href="#l4.225"></a><span id="l4.225" class="difflineminus">-[</span>
<a href="#l4.226"></a><span id="l4.226" class="difflineplus">+gHTMLAttr.applet = [</span>
<a href="#l4.227"></a><span id="l4.227">   &quot;codebase&quot;,</span>
<a href="#l4.228"></a><span id="l4.228">   &quot;archive&quot;,</span>
<a href="#l4.229"></a><span id="l4.229">   &quot;code&quot;,</span>
<a href="#l4.230"></a><span id="l4.230">   &quot;object&quot;,</span>
<a href="#l4.231"></a><span id="l4.231">   &quot;alt&quot;,</span>
<a href="#l4.232"></a><span id="l4.232">   &quot;name&quot;,</span>
<a href="#l4.233"></a><span id="l4.233">   &quot;%$width&quot;,</span>
<a href="#l4.234"></a><span id="l4.234">   &quot;%$height&quot;,</span>
<a href="#l4.235"></a><span id="l4.235">   &quot;align&quot;,</span>
<a href="#l4.236"></a><span id="l4.236">   &quot;#hspace&quot;,</span>
<a href="#l4.237"></a><span id="l4.237">   &quot;#vspace&quot;,</span>
<a href="#l4.238"></a><span id="l4.238">   &quot;-&quot;,</span>
<a href="#l4.239"></a><span id="l4.239">   &quot;_core&quot;,</span>
<a href="#l4.240"></a><span id="l4.240"> ];</span>
<a href="#l4.241"></a><span id="l4.241"> </span>
<a href="#l4.242"></a><span id="l4.242" class="difflineminus">-gHTMLAttr.applet_align =</span>
<a href="#l4.243"></a><span id="l4.243" class="difflineminus">-[</span>
<a href="#l4.244"></a><span id="l4.244" class="difflineplus">+gHTMLAttr.applet_align = [</span>
<a href="#l4.245"></a><span id="l4.245">   &quot;top&quot;,</span>
<a href="#l4.246"></a><span id="l4.246">   &quot;middle&quot;,</span>
<a href="#l4.247"></a><span id="l4.247">   &quot;bottom&quot;,</span>
<a href="#l4.248"></a><span id="l4.248">   &quot;left&quot;,</span>
<a href="#l4.249"></a><span id="l4.249">   &quot;right&quot;,</span>
<a href="#l4.250"></a><span id="l4.250"> ];</span>
<a href="#l4.251"></a><span id="l4.251"> </span>
<a href="#l4.252"></a><span id="l4.252" class="difflineminus">-gHTMLAttr.area =</span>
<a href="#l4.253"></a><span id="l4.253" class="difflineminus">-[</span>
<a href="#l4.254"></a><span id="l4.254" class="difflineplus">+gHTMLAttr.area = [</span>
<a href="#l4.255"></a><span id="l4.255">   &quot;shape&quot;,</span>
<a href="#l4.256"></a><span id="l4.256">   &quot;coords&quot;,</span>
<a href="#l4.257"></a><span id="l4.257">   &quot;href&quot;,</span>
<a href="#l4.258"></a><span id="l4.258">   &quot;nohref&quot;,</span>
<a href="#l4.259"></a><span id="l4.259">   &quot;target&quot;,</span>
<a href="#l4.260"></a><span id="l4.260">   &quot;$alt&quot;,</span>
<a href="#l4.261"></a><span id="l4.261">   &quot;#tabindex&quot;,</span>
<a href="#l4.262"></a><span id="l4.262">   &quot;!accesskey&quot;,</span>
<a href="#l4.263"></a><span id="l4.263" class="difflineat">@@ -265,90 +246,80 @@ gHTMLAttr.area =</span>
<a href="#l4.264"></a><span id="l4.264">   &quot;_core&quot;,</span>
<a href="#l4.265"></a><span id="l4.265">   &quot;-&quot;,</span>
<a href="#l4.266"></a><span id="l4.266">   &quot;^lang&quot;,</span>
<a href="#l4.267"></a><span id="l4.267">   &quot;dir&quot;,</span>
<a href="#l4.268"></a><span id="l4.268"> ];</span>
<a href="#l4.269"></a><span id="l4.269"> </span>
<a href="#l4.270"></a><span id="l4.270"> gHTMLAttr.area_target = gTarget;</span>
<a href="#l4.271"></a><span id="l4.271"> </span>
<a href="#l4.272"></a><span id="l4.272" class="difflineminus">-gHTMLAttr.area_shape =</span>
<a href="#l4.273"></a><span id="l4.273" class="difflineminus">-[</span>
<a href="#l4.274"></a><span id="l4.274" class="difflineplus">+gHTMLAttr.area_shape = [</span>
<a href="#l4.275"></a><span id="l4.275">   &quot;rect&quot;,</span>
<a href="#l4.276"></a><span id="l4.276">   &quot;circle&quot;,</span>
<a href="#l4.277"></a><span id="l4.277">   &quot;poly&quot;,</span>
<a href="#l4.278"></a><span id="l4.278">   &quot;default&quot;,</span>
<a href="#l4.279"></a><span id="l4.279"> ];</span>
<a href="#l4.280"></a><span id="l4.280"> </span>
<a href="#l4.281"></a><span id="l4.281" class="difflineminus">-gHTMLAttr.area_nohref =</span>
<a href="#l4.282"></a><span id="l4.282" class="difflineminus">-[</span>
<a href="#l4.283"></a><span id="l4.283" class="difflineplus">+gHTMLAttr.area_nohref = [</span>
<a href="#l4.284"></a><span id="l4.284">   &quot;nohref&quot;,</span>
<a href="#l4.285"></a><span id="l4.285"> ];</span>
<a href="#l4.286"></a><span id="l4.286"> </span>
<a href="#l4.287"></a><span id="l4.287" class="difflineminus">-gHTMLAttr.b =</span>
<a href="#l4.288"></a><span id="l4.288" class="difflineminus">-[</span>
<a href="#l4.289"></a><span id="l4.289" class="difflineplus">+gHTMLAttr.b = [</span>
<a href="#l4.290"></a><span id="l4.290">   &quot;_core&quot;,</span>
<a href="#l4.291"></a><span id="l4.291">   &quot;-&quot;,</span>
<a href="#l4.292"></a><span id="l4.292">   &quot;^lang&quot;,</span>
<a href="#l4.293"></a><span id="l4.293">   &quot;dir&quot;,</span>
<a href="#l4.294"></a><span id="l4.294"> ];</span>
<a href="#l4.295"></a><span id="l4.295"> </span>
<a href="#l4.296"></a><span id="l4.296" class="difflineminus">-gHTMLAttr.base =</span>
<a href="#l4.297"></a><span id="l4.297" class="difflineminus">-[</span>
<a href="#l4.298"></a><span id="l4.298" class="difflineplus">+gHTMLAttr.base = [</span>
<a href="#l4.299"></a><span id="l4.299">   &quot;href&quot;,</span>
<a href="#l4.300"></a><span id="l4.300">   &quot;target&quot;,</span>
<a href="#l4.301"></a><span id="l4.301"> ];</span>
<a href="#l4.302"></a><span id="l4.302"> </span>
<a href="#l4.303"></a><span id="l4.303"> gHTMLAttr.base_target = gTarget;</span>
<a href="#l4.304"></a><span id="l4.304"> </span>
<a href="#l4.305"></a><span id="l4.305"> // this is deprecated //</span>
<a href="#l4.306"></a><span id="l4.306" class="difflineminus">-gHTMLAttr.basefont =</span>
<a href="#l4.307"></a><span id="l4.307" class="difflineminus">-[</span>
<a href="#l4.308"></a><span id="l4.308" class="difflineplus">+gHTMLAttr.basefont = [</span>
<a href="#l4.309"></a><span id="l4.309">   &quot;^id&quot;,</span>
<a href="#l4.310"></a><span id="l4.310">   &quot;$size&quot;,</span>
<a href="#l4.311"></a><span id="l4.311">   &quot;color&quot;,</span>
<a href="#l4.312"></a><span id="l4.312">   &quot;face&quot;,</span>
<a href="#l4.313"></a><span id="l4.313"> ];</span>
<a href="#l4.314"></a><span id="l4.314"> </span>
<a href="#l4.315"></a><span id="l4.315"> gHTMLAttr.basefont_color = gHTMLColors;</span>
<a href="#l4.316"></a><span id="l4.316"> </span>
<a href="#l4.317"></a><span id="l4.317" class="difflineminus">-gHTMLAttr.bdo =</span>
<a href="#l4.318"></a><span id="l4.318" class="difflineminus">-[</span>
<a href="#l4.319"></a><span id="l4.319" class="difflineplus">+gHTMLAttr.bdo = [</span>
<a href="#l4.320"></a><span id="l4.320">   &quot;_core&quot;,</span>
<a href="#l4.321"></a><span id="l4.321">   &quot;-&quot;,</span>
<a href="#l4.322"></a><span id="l4.322">   &quot;^lang&quot;,</span>
<a href="#l4.323"></a><span id="l4.323">   &quot;$dir&quot;,</span>
<a href="#l4.324"></a><span id="l4.324"> ];</span>
<a href="#l4.325"></a><span id="l4.325"> </span>
<a href="#l4.326"></a><span id="l4.326" class="difflineminus">-gHTMLAttr.bdo_dir =</span>
<a href="#l4.327"></a><span id="l4.327" class="difflineminus">-[</span>
<a href="#l4.328"></a><span id="l4.328" class="difflineplus">+gHTMLAttr.bdo_dir = [</span>
<a href="#l4.329"></a><span id="l4.329">   &quot;ltr&quot;,</span>
<a href="#l4.330"></a><span id="l4.330">   &quot;rtl&quot;,</span>
<a href="#l4.331"></a><span id="l4.331"> ];</span>
<a href="#l4.332"></a><span id="l4.332"> </span>
<a href="#l4.333"></a><span id="l4.333" class="difflineminus">-gHTMLAttr.big =</span>
<a href="#l4.334"></a><span id="l4.334" class="difflineminus">-[</span>
<a href="#l4.335"></a><span id="l4.335" class="difflineplus">+gHTMLAttr.big = [</span>
<a href="#l4.336"></a><span id="l4.336">   &quot;_core&quot;,</span>
<a href="#l4.337"></a><span id="l4.337">   &quot;-&quot;,</span>
<a href="#l4.338"></a><span id="l4.338">   &quot;^lang&quot;,</span>
<a href="#l4.339"></a><span id="l4.339">   &quot;dir&quot;,</span>
<a href="#l4.340"></a><span id="l4.340"> ];</span>
<a href="#l4.341"></a><span id="l4.341"> </span>
<a href="#l4.342"></a><span id="l4.342" class="difflineminus">-gHTMLAttr.blockquote =</span>
<a href="#l4.343"></a><span id="l4.343" class="difflineminus">-[</span>
<a href="#l4.344"></a><span id="l4.344" class="difflineplus">+gHTMLAttr.blockquote = [</span>
<a href="#l4.345"></a><span id="l4.345">   &quot;cite&quot;,</span>
<a href="#l4.346"></a><span id="l4.346">   &quot;-&quot;,</span>
<a href="#l4.347"></a><span id="l4.347">   &quot;_core&quot;,</span>
<a href="#l4.348"></a><span id="l4.348">   &quot;-&quot;,</span>
<a href="#l4.349"></a><span id="l4.349">   &quot;^lang&quot;,</span>
<a href="#l4.350"></a><span id="l4.350">   &quot;dir&quot;,</span>
<a href="#l4.351"></a><span id="l4.351"> ];</span>
<a href="#l4.352"></a><span id="l4.352"> </span>
<a href="#l4.353"></a><span id="l4.353" class="difflineminus">-gHTMLAttr.body =</span>
<a href="#l4.354"></a><span id="l4.354" class="difflineminus">-[</span>
<a href="#l4.355"></a><span id="l4.355" class="difflineplus">+gHTMLAttr.body = [</span>
<a href="#l4.356"></a><span id="l4.356">   &quot;background&quot;,</span>
<a href="#l4.357"></a><span id="l4.357">   &quot;bgcolor&quot;,</span>
<a href="#l4.358"></a><span id="l4.358">   &quot;text&quot;,</span>
<a href="#l4.359"></a><span id="l4.359">   &quot;link&quot;,</span>
<a href="#l4.360"></a><span id="l4.360">   &quot;vlink&quot;,</span>
<a href="#l4.361"></a><span id="l4.361">   &quot;alink&quot;,</span>
<a href="#l4.362"></a><span id="l4.362">   &quot;-&quot;,</span>
<a href="#l4.363"></a><span id="l4.363">   &quot;_core&quot;,</span>
<a href="#l4.364"></a><span id="l4.364" class="difflineat">@@ -362,499 +333,447 @@ gHTMLAttr.body_bgcolor = gHTMLColors;</span>
<a href="#l4.365"></a><span id="l4.365"> gHTMLAttr.body_text = gHTMLColors;</span>
<a href="#l4.366"></a><span id="l4.366"> </span>
<a href="#l4.367"></a><span id="l4.367"> gHTMLAttr.body_link = gHTMLColors;</span>
<a href="#l4.368"></a><span id="l4.368"> </span>
<a href="#l4.369"></a><span id="l4.369"> gHTMLAttr.body_vlink = gHTMLColors;</span>
<a href="#l4.370"></a><span id="l4.370"> </span>
<a href="#l4.371"></a><span id="l4.371"> gHTMLAttr.body_alink = gHTMLColors;</span>
<a href="#l4.372"></a><span id="l4.372"> </span>
<a href="#l4.373"></a><span id="l4.373" class="difflineminus">-gHTMLAttr.br =</span>
<a href="#l4.374"></a><span id="l4.374" class="difflineminus">-[</span>
<a href="#l4.375"></a><span id="l4.375" class="difflineplus">+gHTMLAttr.br = [</span>
<a href="#l4.376"></a><span id="l4.376">   &quot;clear&quot;,</span>
<a href="#l4.377"></a><span id="l4.377">   &quot;-&quot;,</span>
<a href="#l4.378"></a><span id="l4.378">   &quot;_core&quot;,</span>
<a href="#l4.379"></a><span id="l4.379"> ];</span>
<a href="#l4.380"></a><span id="l4.380"> </span>
<a href="#l4.381"></a><span id="l4.381" class="difflineminus">-gHTMLAttr.br_clear =</span>
<a href="#l4.382"></a><span id="l4.382" class="difflineminus">-[</span>
<a href="#l4.383"></a><span id="l4.383" class="difflineplus">+gHTMLAttr.br_clear = [</span>
<a href="#l4.384"></a><span id="l4.384">   &quot;none&quot;,</span>
<a href="#l4.385"></a><span id="l4.385">   &quot;left&quot;,</span>
<a href="#l4.386"></a><span id="l4.386">   &quot;all&quot;,</span>
<a href="#l4.387"></a><span id="l4.387">   &quot;right&quot;,</span>
<a href="#l4.388"></a><span id="l4.388"> ];</span>
<a href="#l4.389"></a><span id="l4.389"> </span>
<a href="#l4.390"></a><span id="l4.390" class="difflineminus">-gHTMLAttr.button =</span>
<a href="#l4.391"></a><span id="l4.391" class="difflineminus">-[</span>
<a href="#l4.392"></a><span id="l4.392" class="difflineplus">+gHTMLAttr.button = [</span>
<a href="#l4.393"></a><span id="l4.393">   &quot;name&quot;,</span>
<a href="#l4.394"></a><span id="l4.394">   &quot;value&quot;,</span>
<a href="#l4.395"></a><span id="l4.395">   &quot;$type&quot;,</span>
<a href="#l4.396"></a><span id="l4.396">   &quot;disabled&quot;,</span>
<a href="#l4.397"></a><span id="l4.397">   &quot;#tabindex&quot;,</span>
<a href="#l4.398"></a><span id="l4.398">   &quot;!accesskey&quot;,</span>
<a href="#l4.399"></a><span id="l4.399">   &quot;-&quot;,</span>
<a href="#l4.400"></a><span id="l4.400">   &quot;_core&quot;,</span>
<a href="#l4.401"></a><span id="l4.401">   &quot;-&quot;,</span>
<a href="#l4.402"></a><span id="l4.402">   &quot;^lang&quot;,</span>
<a href="#l4.403"></a><span id="l4.403">   &quot;dir&quot;,</span>
<a href="#l4.404"></a><span id="l4.404"> ];</span>
<a href="#l4.405"></a><span id="l4.405"> </span>
<a href="#l4.406"></a><span id="l4.406" class="difflineminus">-gHTMLAttr.button_type =</span>
<a href="#l4.407"></a><span id="l4.407" class="difflineminus">-[</span>
<a href="#l4.408"></a><span id="l4.408" class="difflineplus">+gHTMLAttr.button_type = [</span>
<a href="#l4.409"></a><span id="l4.409">   &quot;submit&quot;,</span>
<a href="#l4.410"></a><span id="l4.410">   &quot;button&quot;,</span>
<a href="#l4.411"></a><span id="l4.411">   &quot;reset&quot;,</span>
<a href="#l4.412"></a><span id="l4.412"> ];</span>
<a href="#l4.413"></a><span id="l4.413"> </span>
<a href="#l4.414"></a><span id="l4.414" class="difflineminus">-gHTMLAttr.button_disabled =</span>
<a href="#l4.415"></a><span id="l4.415" class="difflineminus">-[</span>
<a href="#l4.416"></a><span id="l4.416" class="difflineplus">+gHTMLAttr.button_disabled = [</span>
<a href="#l4.417"></a><span id="l4.417">   &quot;disabled&quot;,</span>
<a href="#l4.418"></a><span id="l4.418"> ];</span>
<a href="#l4.419"></a><span id="l4.419"> </span>
<a href="#l4.420"></a><span id="l4.420" class="difflineminus">-gHTMLAttr.caption =</span>
<a href="#l4.421"></a><span id="l4.421" class="difflineminus">-[</span>
<a href="#l4.422"></a><span id="l4.422" class="difflineplus">+gHTMLAttr.caption = [</span>
<a href="#l4.423"></a><span id="l4.423">   &quot;align&quot;,</span>
<a href="#l4.424"></a><span id="l4.424">   &quot;-&quot;,</span>
<a href="#l4.425"></a><span id="l4.425">   &quot;_core&quot;,</span>
<a href="#l4.426"></a><span id="l4.426">   &quot;-&quot;,</span>
<a href="#l4.427"></a><span id="l4.427">   &quot;^lang&quot;,</span>
<a href="#l4.428"></a><span id="l4.428">   &quot;dir&quot;,</span>
<a href="#l4.429"></a><span id="l4.429"> ];</span>
<a href="#l4.430"></a><span id="l4.430"> </span>
<a href="#l4.431"></a><span id="l4.431" class="difflineminus">-gHTMLAttr.caption_align =</span>
<a href="#l4.432"></a><span id="l4.432" class="difflineminus">-[</span>
<a href="#l4.433"></a><span id="l4.433" class="difflineplus">+gHTMLAttr.caption_align = [</span>
<a href="#l4.434"></a><span id="l4.434">   &quot;top&quot;,</span>
<a href="#l4.435"></a><span id="l4.435">   &quot;bottom&quot;,</span>
<a href="#l4.436"></a><span id="l4.436">   &quot;left&quot;,</span>
<a href="#l4.437"></a><span id="l4.437">   &quot;right&quot;,</span>
<a href="#l4.438"></a><span id="l4.438"> ];</span>
<a href="#l4.439"></a><span id="l4.439"> </span>
<a href="#l4.440"></a><span id="l4.440"> </span>
<a href="#l4.441"></a><span id="l4.441"> // this is deprecated //</span>
<a href="#l4.442"></a><span id="l4.442" class="difflineminus">-gHTMLAttr.center =</span>
<a href="#l4.443"></a><span id="l4.443" class="difflineminus">-[</span>
<a href="#l4.444"></a><span id="l4.444" class="difflineplus">+gHTMLAttr.center = [</span>
<a href="#l4.445"></a><span id="l4.445">   &quot;_core&quot;,</span>
<a href="#l4.446"></a><span id="l4.446">   &quot;-&quot;,</span>
<a href="#l4.447"></a><span id="l4.447">   &quot;^lang&quot;,</span>
<a href="#l4.448"></a><span id="l4.448">   &quot;dir&quot;,</span>
<a href="#l4.449"></a><span id="l4.449"> ];</span>
<a href="#l4.450"></a><span id="l4.450"> </span>
<a href="#l4.451"></a><span id="l4.451" class="difflineminus">-gHTMLAttr.cite =</span>
<a href="#l4.452"></a><span id="l4.452" class="difflineminus">-[</span>
<a href="#l4.453"></a><span id="l4.453" class="difflineplus">+gHTMLAttr.cite = [</span>
<a href="#l4.454"></a><span id="l4.454">   &quot;_core&quot;,</span>
<a href="#l4.455"></a><span id="l4.455">   &quot;-&quot;,</span>
<a href="#l4.456"></a><span id="l4.456">   &quot;^lang&quot;,</span>
<a href="#l4.457"></a><span id="l4.457">   &quot;dir&quot;,</span>
<a href="#l4.458"></a><span id="l4.458"> ];</span>
<a href="#l4.459"></a><span id="l4.459"> </span>
<a href="#l4.460"></a><span id="l4.460" class="difflineminus">-gHTMLAttr.code =</span>
<a href="#l4.461"></a><span id="l4.461" class="difflineminus">-[</span>
<a href="#l4.462"></a><span id="l4.462" class="difflineplus">+gHTMLAttr.code = [</span>
<a href="#l4.463"></a><span id="l4.463">   &quot;_core&quot;,</span>
<a href="#l4.464"></a><span id="l4.464">   &quot;-&quot;,</span>
<a href="#l4.465"></a><span id="l4.465">   &quot;^lang&quot;,</span>
<a href="#l4.466"></a><span id="l4.466">   &quot;dir&quot;,</span>
<a href="#l4.467"></a><span id="l4.467"> ];</span>
<a href="#l4.468"></a><span id="l4.468"> </span>
<a href="#l4.469"></a><span id="l4.469" class="difflineminus">-gHTMLAttr.col =</span>
<a href="#l4.470"></a><span id="l4.470" class="difflineminus">-[</span>
<a href="#l4.471"></a><span id="l4.471" class="difflineplus">+gHTMLAttr.col = [</span>
<a href="#l4.472"></a><span id="l4.472">   &quot;#$span&quot;,</span>
<a href="#l4.473"></a><span id="l4.473">   &quot;%width&quot;,</span>
<a href="#l4.474"></a><span id="l4.474">   &quot;align&quot;,</span>
<a href="#l4.475"></a><span id="l4.475">   &quot;!char&quot;,</span>
<a href="#l4.476"></a><span id="l4.476">   &quot;#charoff&quot;,</span>
<a href="#l4.477"></a><span id="l4.477">   &quot;valign&quot;,</span>
<a href="#l4.478"></a><span id="l4.478">   &quot;char&quot;,</span>
<a href="#l4.479"></a><span id="l4.479">   &quot;-&quot;,</span>
<a href="#l4.480"></a><span id="l4.480">   &quot;_core&quot;,</span>
<a href="#l4.481"></a><span id="l4.481">   &quot;-&quot;,</span>
<a href="#l4.482"></a><span id="l4.482">   &quot;^lang&quot;,</span>
<a href="#l4.483"></a><span id="l4.483">   &quot;dir&quot;,</span>
<a href="#l4.484"></a><span id="l4.484"> ];</span>
<a href="#l4.485"></a><span id="l4.485"> </span>
<a href="#l4.486"></a><span id="l4.486" class="difflineminus">-gHTMLAttr.col_span =</span>
<a href="#l4.487"></a><span id="l4.487" class="difflineminus">-[</span>
<a href="#l4.488"></a><span id="l4.488" class="difflineplus">+gHTMLAttr.col_span = [</span>
<a href="#l4.489"></a><span id="l4.489">   &quot;1&quot;,  // default</span>
<a href="#l4.490"></a><span id="l4.490"> ];</span>
<a href="#l4.491"></a><span id="l4.491"> </span>
<a href="#l4.492"></a><span id="l4.492"> gHTMLAttr.col_align = gHAlignTableContent;</span>
<a href="#l4.493"></a><span id="l4.493"> </span>
<a href="#l4.494"></a><span id="l4.494" class="difflineminus">-gHTMLAttr.col_valign =</span>
<a href="#l4.495"></a><span id="l4.495" class="difflineminus">-[</span>
<a href="#l4.496"></a><span id="l4.496" class="difflineplus">+gHTMLAttr.col_valign = [</span>
<a href="#l4.497"></a><span id="l4.497">   &quot;top&quot;,</span>
<a href="#l4.498"></a><span id="l4.498">   &quot;middle&quot;,</span>
<a href="#l4.499"></a><span id="l4.499">   &quot;bottom&quot;,</span>
<a href="#l4.500"></a><span id="l4.500">   &quot;baseline&quot;,</span>
<a href="#l4.501"></a><span id="l4.501"> ];</span>
<a href="#l4.502"></a><span id="l4.502"> </span>
<a href="#l4.503"></a><span id="l4.503"> </span>
<a href="#l4.504"></a><span id="l4.504" class="difflineminus">-gHTMLAttr.colgroup =</span>
<a href="#l4.505"></a><span id="l4.505" class="difflineminus">-[</span>
<a href="#l4.506"></a><span id="l4.506" class="difflineplus">+gHTMLAttr.colgroup = [</span>
<a href="#l4.507"></a><span id="l4.507">   &quot;#$span&quot;,</span>
<a href="#l4.508"></a><span id="l4.508">   &quot;%width&quot;,</span>
<a href="#l4.509"></a><span id="l4.509">   &quot;align&quot;,</span>
<a href="#l4.510"></a><span id="l4.510">   &quot;!char&quot;,</span>
<a href="#l4.511"></a><span id="l4.511">   &quot;#charoff&quot;,</span>
<a href="#l4.512"></a><span id="l4.512">   &quot;valign&quot;,</span>
<a href="#l4.513"></a><span id="l4.513">   &quot;-&quot;,</span>
<a href="#l4.514"></a><span id="l4.514">   &quot;_core&quot;,</span>
<a href="#l4.515"></a><span id="l4.515">   &quot;-&quot;,</span>
<a href="#l4.516"></a><span id="l4.516">   &quot;^lang&quot;,</span>
<a href="#l4.517"></a><span id="l4.517">   &quot;dir&quot;,</span>
<a href="#l4.518"></a><span id="l4.518"> ];</span>
<a href="#l4.519"></a><span id="l4.519"> </span>
<a href="#l4.520"></a><span id="l4.520" class="difflineminus">-gHTMLAttr.colgroup_span =</span>
<a href="#l4.521"></a><span id="l4.521" class="difflineminus">-[</span>
<a href="#l4.522"></a><span id="l4.522" class="difflineplus">+gHTMLAttr.colgroup_span = [</span>
<a href="#l4.523"></a><span id="l4.523">   &quot;1&quot;, // default</span>
<a href="#l4.524"></a><span id="l4.524"> ];</span>
<a href="#l4.525"></a><span id="l4.525"> </span>
<a href="#l4.526"></a><span id="l4.526"> gHTMLAttr.colgroup_align = gHAlignTableContent;</span>
<a href="#l4.527"></a><span id="l4.527"> </span>
<a href="#l4.528"></a><span id="l4.528" class="difflineminus">-gHTMLAttr.colgroup_valign =</span>
<a href="#l4.529"></a><span id="l4.529" class="difflineminus">-[</span>
<a href="#l4.530"></a><span id="l4.530" class="difflineplus">+gHTMLAttr.colgroup_valign = [</span>
<a href="#l4.531"></a><span id="l4.531">   &quot;top&quot;,</span>
<a href="#l4.532"></a><span id="l4.532">   &quot;middle&quot;,</span>
<a href="#l4.533"></a><span id="l4.533">   &quot;bottom&quot;,</span>
<a href="#l4.534"></a><span id="l4.534">   &quot;baseline&quot;,</span>
<a href="#l4.535"></a><span id="l4.535"> ];</span>
<a href="#l4.536"></a><span id="l4.536"> </span>
<a href="#l4.537"></a><span id="l4.537" class="difflineminus">-gHTMLAttr.dd =</span>
<a href="#l4.538"></a><span id="l4.538" class="difflineminus">-[</span>
<a href="#l4.539"></a><span id="l4.539" class="difflineplus">+gHTMLAttr.dd = [</span>
<a href="#l4.540"></a><span id="l4.540">   &quot;_core&quot;,</span>
<a href="#l4.541"></a><span id="l4.541">   &quot;-&quot;,</span>
<a href="#l4.542"></a><span id="l4.542">   &quot;^lang&quot;,</span>
<a href="#l4.543"></a><span id="l4.543">   &quot;dir&quot;,</span>
<a href="#l4.544"></a><span id="l4.544"> ];</span>
<a href="#l4.545"></a><span id="l4.545"> </span>
<a href="#l4.546"></a><span id="l4.546" class="difflineminus">-gHTMLAttr.del =</span>
<a href="#l4.547"></a><span id="l4.547" class="difflineminus">-[</span>
<a href="#l4.548"></a><span id="l4.548" class="difflineplus">+gHTMLAttr.del = [</span>
<a href="#l4.549"></a><span id="l4.549">   &quot;cite&quot;,</span>
<a href="#l4.550"></a><span id="l4.550">   &quot;datetime&quot;,</span>
<a href="#l4.551"></a><span id="l4.551">   &quot;_core&quot;,</span>
<a href="#l4.552"></a><span id="l4.552">   &quot;-&quot;,</span>
<a href="#l4.553"></a><span id="l4.553">   &quot;^lang&quot;,</span>
<a href="#l4.554"></a><span id="l4.554">   &quot;dir&quot;,</span>
<a href="#l4.555"></a><span id="l4.555"> ];</span>
<a href="#l4.556"></a><span id="l4.556"> </span>
<a href="#l4.557"></a><span id="l4.557" class="difflineminus">-gHTMLAttr.dfn =</span>
<a href="#l4.558"></a><span id="l4.558" class="difflineminus">-[</span>
<a href="#l4.559"></a><span id="l4.559" class="difflineplus">+gHTMLAttr.dfn = [</span>
<a href="#l4.560"></a><span id="l4.560">   &quot;_core&quot;,</span>
<a href="#l4.561"></a><span id="l4.561">   &quot;-&quot;,</span>
<a href="#l4.562"></a><span id="l4.562">   &quot;^lang&quot;,</span>
<a href="#l4.563"></a><span id="l4.563">   &quot;dir&quot;,</span>
<a href="#l4.564"></a><span id="l4.564"> ];</span>
<a href="#l4.565"></a><span id="l4.565"> </span>
<a href="#l4.566"></a><span id="l4.566"> // this is deprecated //</span>
<a href="#l4.567"></a><span id="l4.567" class="difflineminus">-gHTMLAttr.dir =</span>
<a href="#l4.568"></a><span id="l4.568" class="difflineminus">-[</span>
<a href="#l4.569"></a><span id="l4.569" class="difflineplus">+gHTMLAttr.dir = [</span>
<a href="#l4.570"></a><span id="l4.570">   &quot;compact&quot;,</span>
<a href="#l4.571"></a><span id="l4.571">   &quot;-&quot;,</span>
<a href="#l4.572"></a><span id="l4.572">   &quot;_core&quot;,</span>
<a href="#l4.573"></a><span id="l4.573">   &quot;-&quot;,</span>
<a href="#l4.574"></a><span id="l4.574">   &quot;^lang&quot;,</span>
<a href="#l4.575"></a><span id="l4.575">   &quot;dir&quot;,</span>
<a href="#l4.576"></a><span id="l4.576"> ];</span>
<a href="#l4.577"></a><span id="l4.577"> </span>
<a href="#l4.578"></a><span id="l4.578" class="difflineminus">-gHTMLAttr.dir_compact =</span>
<a href="#l4.579"></a><span id="l4.579" class="difflineminus">-[</span>
<a href="#l4.580"></a><span id="l4.580" class="difflineplus">+gHTMLAttr.dir_compact = [</span>
<a href="#l4.581"></a><span id="l4.581">   &quot;compact&quot;,</span>
<a href="#l4.582"></a><span id="l4.582"> ];</span>
<a href="#l4.583"></a><span id="l4.583"> </span>
<a href="#l4.584"></a><span id="l4.584" class="difflineminus">-gHTMLAttr.div =</span>
<a href="#l4.585"></a><span id="l4.585" class="difflineminus">-[</span>
<a href="#l4.586"></a><span id="l4.586" class="difflineplus">+gHTMLAttr.div = [</span>
<a href="#l4.587"></a><span id="l4.587">   &quot;align&quot;,</span>
<a href="#l4.588"></a><span id="l4.588">   &quot;-&quot;,</span>
<a href="#l4.589"></a><span id="l4.589">   &quot;_core&quot;,</span>
<a href="#l4.590"></a><span id="l4.590">   &quot;-&quot;,</span>
<a href="#l4.591"></a><span id="l4.591">   &quot;^lang&quot;,</span>
<a href="#l4.592"></a><span id="l4.592">   &quot;dir&quot;,</span>
<a href="#l4.593"></a><span id="l4.593"> ];</span>
<a href="#l4.594"></a><span id="l4.594"> </span>
<a href="#l4.595"></a><span id="l4.595"> gHTMLAttr.div_align = gHAlignJustify;</span>
<a href="#l4.596"></a><span id="l4.596"> </span>
<a href="#l4.597"></a><span id="l4.597" class="difflineminus">-gHTMLAttr.dl =</span>
<a href="#l4.598"></a><span id="l4.598" class="difflineminus">-[</span>
<a href="#l4.599"></a><span id="l4.599" class="difflineplus">+gHTMLAttr.dl = [</span>
<a href="#l4.600"></a><span id="l4.600">   &quot;compact&quot;,</span>
<a href="#l4.601"></a><span id="l4.601">   &quot;-&quot;,</span>
<a href="#l4.602"></a><span id="l4.602">   &quot;_core&quot;,</span>
<a href="#l4.603"></a><span id="l4.603">   &quot;-&quot;,</span>
<a href="#l4.604"></a><span id="l4.604">   &quot;^lang&quot;,</span>
<a href="#l4.605"></a><span id="l4.605">   &quot;dir&quot;,</span>
<a href="#l4.606"></a><span id="l4.606"> ];</span>
<a href="#l4.607"></a><span id="l4.607"> </span>
<a href="#l4.608"></a><span id="l4.608" class="difflineminus">-gHTMLAttr.dl_compact =</span>
<a href="#l4.609"></a><span id="l4.609" class="difflineminus">-[</span>
<a href="#l4.610"></a><span id="l4.610" class="difflineplus">+gHTMLAttr.dl_compact = [</span>
<a href="#l4.611"></a><span id="l4.611">   &quot;compact&quot;,</span>
<a href="#l4.612"></a><span id="l4.612"> ];</span>
<a href="#l4.613"></a><span id="l4.613"> </span>
<a href="#l4.614"></a><span id="l4.614"> </span>
<a href="#l4.615"></a><span id="l4.615" class="difflineminus">-gHTMLAttr.dt =</span>
<a href="#l4.616"></a><span id="l4.616" class="difflineminus">-[</span>
<a href="#l4.617"></a><span id="l4.617" class="difflineplus">+gHTMLAttr.dt = [</span>
<a href="#l4.618"></a><span id="l4.618">   &quot;_core&quot;,</span>
<a href="#l4.619"></a><span id="l4.619">   &quot;-&quot;,</span>
<a href="#l4.620"></a><span id="l4.620">   &quot;^lang&quot;,</span>
<a href="#l4.621"></a><span id="l4.621">   &quot;dir&quot;,</span>
<a href="#l4.622"></a><span id="l4.622"> ];</span>
<a href="#l4.623"></a><span id="l4.623"> </span>
<a href="#l4.624"></a><span id="l4.624" class="difflineminus">-gHTMLAttr.em =</span>
<a href="#l4.625"></a><span id="l4.625" class="difflineminus">-[</span>
<a href="#l4.626"></a><span id="l4.626" class="difflineplus">+gHTMLAttr.em = [</span>
<a href="#l4.627"></a><span id="l4.627">   &quot;_core&quot;,</span>
<a href="#l4.628"></a><span id="l4.628">   &quot;-&quot;,</span>
<a href="#l4.629"></a><span id="l4.629">   &quot;^lang&quot;,</span>
<a href="#l4.630"></a><span id="l4.630">   &quot;dir&quot;,</span>
<a href="#l4.631"></a><span id="l4.631"> ];</span>
<a href="#l4.632"></a><span id="l4.632"> </span>
<a href="#l4.633"></a><span id="l4.633" class="difflineminus">-gHTMLAttr.fieldset =</span>
<a href="#l4.634"></a><span id="l4.634" class="difflineminus">-[</span>
<a href="#l4.635"></a><span id="l4.635" class="difflineplus">+gHTMLAttr.fieldset = [</span>
<a href="#l4.636"></a><span id="l4.636">   &quot;_core&quot;,</span>
<a href="#l4.637"></a><span id="l4.637">   &quot;-&quot;,</span>
<a href="#l4.638"></a><span id="l4.638">   &quot;^lang&quot;,</span>
<a href="#l4.639"></a><span id="l4.639">   &quot;dir&quot;,</span>
<a href="#l4.640"></a><span id="l4.640"> ];</span>
<a href="#l4.641"></a><span id="l4.641"> </span>
<a href="#l4.642"></a><span id="l4.642"> // this is deprecated //</span>
<a href="#l4.643"></a><span id="l4.643" class="difflineminus">-gHTMLAttr.font =</span>
<a href="#l4.644"></a><span id="l4.644" class="difflineminus">-[</span>
<a href="#l4.645"></a><span id="l4.645" class="difflineplus">+gHTMLAttr.font = [</span>
<a href="#l4.646"></a><span id="l4.646">   &quot;+size&quot;,</span>
<a href="#l4.647"></a><span id="l4.647">   &quot;color&quot;,</span>
<a href="#l4.648"></a><span id="l4.648">   &quot;face&quot;,</span>
<a href="#l4.649"></a><span id="l4.649">   &quot;-&quot;,</span>
<a href="#l4.650"></a><span id="l4.650">   &quot;_core&quot;,</span>
<a href="#l4.651"></a><span id="l4.651">   &quot;-&quot;,</span>
<a href="#l4.652"></a><span id="l4.652">   &quot;^lang&quot;,</span>
<a href="#l4.653"></a><span id="l4.653">   &quot;dir&quot;,</span>
<a href="#l4.654"></a><span id="l4.654"> ];</span>
<a href="#l4.655"></a><span id="l4.655"> </span>
<a href="#l4.656"></a><span id="l4.656"> gHTMLAttr.font_color = gHTMLColors;</span>
<a href="#l4.657"></a><span id="l4.657"> </span>
<a href="#l4.658"></a><span id="l4.658" class="difflineminus">-gHTMLAttr.form =</span>
<a href="#l4.659"></a><span id="l4.659" class="difflineminus">-[</span>
<a href="#l4.660"></a><span id="l4.660" class="difflineplus">+gHTMLAttr.form = [</span>
<a href="#l4.661"></a><span id="l4.661">   &quot;$action&quot;,</span>
<a href="#l4.662"></a><span id="l4.662">   &quot;$method&quot;,</span>
<a href="#l4.663"></a><span id="l4.663">   &quot;enctype&quot;,</span>
<a href="#l4.664"></a><span id="l4.664">   &quot;accept&quot;,</span>
<a href="#l4.665"></a><span id="l4.665">   &quot;name&quot;,</span>
<a href="#l4.666"></a><span id="l4.666">   &quot;accept-charset&quot;,</span>
<a href="#l4.667"></a><span id="l4.667">   &quot;target&quot;,</span>
<a href="#l4.668"></a><span id="l4.668">   &quot;-&quot;,</span>
<a href="#l4.669"></a><span id="l4.669">   &quot;_core&quot;,</span>
<a href="#l4.670"></a><span id="l4.670">   &quot;-&quot;,</span>
<a href="#l4.671"></a><span id="l4.671">   &quot;^lang&quot;,</span>
<a href="#l4.672"></a><span id="l4.672">   &quot;dir&quot;,</span>
<a href="#l4.673"></a><span id="l4.673"> ];</span>
<a href="#l4.674"></a><span id="l4.674"> </span>
<a href="#l4.675"></a><span id="l4.675" class="difflineminus">-gHTMLAttr.form_method =</span>
<a href="#l4.676"></a><span id="l4.676" class="difflineminus">-[</span>
<a href="#l4.677"></a><span id="l4.677" class="difflineplus">+gHTMLAttr.form_method = [</span>
<a href="#l4.678"></a><span id="l4.678">   &quot;get&quot;,</span>
<a href="#l4.679"></a><span id="l4.679">   &quot;post&quot;,</span>
<a href="#l4.680"></a><span id="l4.680"> ];</span>
<a href="#l4.681"></a><span id="l4.681"> </span>
<a href="#l4.682"></a><span id="l4.682" class="difflineminus">-gHTMLAttr.form_enctype =</span>
<a href="#l4.683"></a><span id="l4.683" class="difflineminus">-[</span>
<a href="#l4.684"></a><span id="l4.684" class="difflineplus">+gHTMLAttr.form_enctype = [</span>
<a href="#l4.685"></a><span id="l4.685">   &quot;application/x-www-form-urlencoded&quot;,</span>
<a href="#l4.686"></a><span id="l4.686"> ];</span>
<a href="#l4.687"></a><span id="l4.687"> </span>
<a href="#l4.688"></a><span id="l4.688"> gHTMLAttr.form_target = gTarget;</span>
<a href="#l4.689"></a><span id="l4.689"> </span>
<a href="#l4.690"></a><span id="l4.690" class="difflineminus">-gHTMLAttr.frame =</span>
<a href="#l4.691"></a><span id="l4.691" class="difflineminus">-[</span>
<a href="#l4.692"></a><span id="l4.692" class="difflineplus">+gHTMLAttr.frame = [</span>
<a href="#l4.693"></a><span id="l4.693">   &quot;longdesc&quot;,</span>
<a href="#l4.694"></a><span id="l4.694">   &quot;name&quot;,</span>
<a href="#l4.695"></a><span id="l4.695">   &quot;src&quot;,</span>
<a href="#l4.696"></a><span id="l4.696">   &quot;#frameborder&quot;,</span>
<a href="#l4.697"></a><span id="l4.697">   &quot;#marginwidth&quot;,</span>
<a href="#l4.698"></a><span id="l4.698">   &quot;#marginheight&quot;,</span>
<a href="#l4.699"></a><span id="l4.699">   &quot;noresize&quot;,</span>
<a href="#l4.700"></a><span id="l4.700">   &quot;$scrolling&quot;,</span>
<a href="#l4.701"></a><span id="l4.701"> ];</span>
<a href="#l4.702"></a><span id="l4.702"> </span>
<a href="#l4.703"></a><span id="l4.703" class="difflineminus">-gHTMLAttr.frame_frameborder =</span>
<a href="#l4.704"></a><span id="l4.704" class="difflineminus">-[</span>
<a href="#l4.705"></a><span id="l4.705" class="difflineplus">+gHTMLAttr.frame_frameborder = [</span>
<a href="#l4.706"></a><span id="l4.706">   &quot;1&quot;,</span>
<a href="#l4.707"></a><span id="l4.707">   &quot;0&quot;,</span>
<a href="#l4.708"></a><span id="l4.708"> ];</span>
<a href="#l4.709"></a><span id="l4.709"> </span>
<a href="#l4.710"></a><span id="l4.710" class="difflineminus">-gHTMLAttr.frame_noresize =</span>
<a href="#l4.711"></a><span id="l4.711" class="difflineminus">-[</span>
<a href="#l4.712"></a><span id="l4.712" class="difflineplus">+gHTMLAttr.frame_noresize = [</span>
<a href="#l4.713"></a><span id="l4.713">   &quot;noresize&quot;,</span>
<a href="#l4.714"></a><span id="l4.714"> ];</span>
<a href="#l4.715"></a><span id="l4.715"> </span>
<a href="#l4.716"></a><span id="l4.716" class="difflineminus">-gHTMLAttr.frame_scrolling =</span>
<a href="#l4.717"></a><span id="l4.717" class="difflineminus">-[</span>
<a href="#l4.718"></a><span id="l4.718" class="difflineplus">+gHTMLAttr.frame_scrolling = [</span>
<a href="#l4.719"></a><span id="l4.719">   &quot;auto&quot;,</span>
<a href="#l4.720"></a><span id="l4.720">   &quot;yes&quot;,</span>
<a href="#l4.721"></a><span id="l4.721">   &quot;no&quot;,</span>
<a href="#l4.722"></a><span id="l4.722"> ];</span>
<a href="#l4.723"></a><span id="l4.723"> </span>
<a href="#l4.724"></a><span id="l4.724"> </span>
<a href="#l4.725"></a><span id="l4.725" class="difflineminus">-gHTMLAttr.frameset =</span>
<a href="#l4.726"></a><span id="l4.726" class="difflineminus">-[</span>
<a href="#l4.727"></a><span id="l4.727" class="difflineplus">+gHTMLAttr.frameset = [</span>
<a href="#l4.728"></a><span id="l4.728">   &quot;rows&quot;,</span>
<a href="#l4.729"></a><span id="l4.729">   &quot;cols&quot;,</span>
<a href="#l4.730"></a><span id="l4.730">   &quot;-&quot;,</span>
<a href="#l4.731"></a><span id="l4.731">   &quot;_core&quot;,</span>
<a href="#l4.732"></a><span id="l4.732"> ];</span>
<a href="#l4.733"></a><span id="l4.733"> </span>
<a href="#l4.734"></a><span id="l4.734" class="difflineminus">-gHTMLAttr.h1 =</span>
<a href="#l4.735"></a><span id="l4.735" class="difflineminus">-[</span>
<a href="#l4.736"></a><span id="l4.736" class="difflineplus">+gHTMLAttr.h1 = [</span>
<a href="#l4.737"></a><span id="l4.737">   &quot;align&quot;,</span>
<a href="#l4.738"></a><span id="l4.738">   &quot;-&quot;,</span>
<a href="#l4.739"></a><span id="l4.739">   &quot;_core&quot;,</span>
<a href="#l4.740"></a><span id="l4.740">   &quot;-&quot;,</span>
<a href="#l4.741"></a><span id="l4.741">   &quot;^lang&quot;,</span>
<a href="#l4.742"></a><span id="l4.742">   &quot;dir&quot;,</span>
<a href="#l4.743"></a><span id="l4.743"> ];</span>
<a href="#l4.744"></a><span id="l4.744"> </span>
<a href="#l4.745"></a><span id="l4.745"> gHTMLAttr.h1_align = gHAlignJustify;</span>
<a href="#l4.746"></a><span id="l4.746"> </span>
<a href="#l4.747"></a><span id="l4.747" class="difflineminus">-gHTMLAttr.h2 =</span>
<a href="#l4.748"></a><span id="l4.748" class="difflineminus">-[</span>
<a href="#l4.749"></a><span id="l4.749" class="difflineplus">+gHTMLAttr.h2 = [</span>
<a href="#l4.750"></a><span id="l4.750">   &quot;align&quot;,</span>
<a href="#l4.751"></a><span id="l4.751">   &quot;-&quot;,</span>
<a href="#l4.752"></a><span id="l4.752">   &quot;_core&quot;,</span>
<a href="#l4.753"></a><span id="l4.753">   &quot;-&quot;,</span>
<a href="#l4.754"></a><span id="l4.754">   &quot;^lang&quot;,</span>
<a href="#l4.755"></a><span id="l4.755">   &quot;dir&quot;,</span>
<a href="#l4.756"></a><span id="l4.756"> ];</span>
<a href="#l4.757"></a><span id="l4.757"> </span>
<a href="#l4.758"></a><span id="l4.758"> gHTMLAttr.h2_align = gHAlignJustify;</span>
<a href="#l4.759"></a><span id="l4.759"> </span>
<a href="#l4.760"></a><span id="l4.760" class="difflineminus">-gHTMLAttr.h3 =</span>
<a href="#l4.761"></a><span id="l4.761" class="difflineminus">-[</span>
<a href="#l4.762"></a><span id="l4.762" class="difflineplus">+gHTMLAttr.h3 = [</span>
<a href="#l4.763"></a><span id="l4.763">   &quot;align&quot;,</span>
<a href="#l4.764"></a><span id="l4.764">   &quot;-&quot;,</span>
<a href="#l4.765"></a><span id="l4.765">   &quot;_core&quot;,</span>
<a href="#l4.766"></a><span id="l4.766">   &quot;-&quot;,</span>
<a href="#l4.767"></a><span id="l4.767">   &quot;^lang&quot;,</span>
<a href="#l4.768"></a><span id="l4.768">   &quot;dir&quot;,</span>
<a href="#l4.769"></a><span id="l4.769"> ];</span>
<a href="#l4.770"></a><span id="l4.770"> </span>
<a href="#l4.771"></a><span id="l4.771"> gHTMLAttr.h3_align =  gHAlignJustify;</span>
<a href="#l4.772"></a><span id="l4.772"> </span>
<a href="#l4.773"></a><span id="l4.773" class="difflineminus">-gHTMLAttr.h4 =</span>
<a href="#l4.774"></a><span id="l4.774" class="difflineminus">-[</span>
<a href="#l4.775"></a><span id="l4.775" class="difflineplus">+gHTMLAttr.h4 = [</span>
<a href="#l4.776"></a><span id="l4.776">   &quot;align&quot;,</span>
<a href="#l4.777"></a><span id="l4.777">   &quot;-&quot;,</span>
<a href="#l4.778"></a><span id="l4.778">   &quot;_core&quot;,</span>
<a href="#l4.779"></a><span id="l4.779">   &quot;-&quot;,</span>
<a href="#l4.780"></a><span id="l4.780">   &quot;^lang&quot;,</span>
<a href="#l4.781"></a><span id="l4.781">   &quot;dir&quot;,</span>
<a href="#l4.782"></a><span id="l4.782"> ];</span>
<a href="#l4.783"></a><span id="l4.783"> </span>
<a href="#l4.784"></a><span id="l4.784"> gHTMLAttr.h4_align = gHAlignJustify;</span>
<a href="#l4.785"></a><span id="l4.785"> </span>
<a href="#l4.786"></a><span id="l4.786"> </span>
<a href="#l4.787"></a><span id="l4.787" class="difflineminus">-gHTMLAttr.h5 =</span>
<a href="#l4.788"></a><span id="l4.788" class="difflineminus">-[</span>
<a href="#l4.789"></a><span id="l4.789" class="difflineplus">+gHTMLAttr.h5 = [</span>
<a href="#l4.790"></a><span id="l4.790">   &quot;align&quot;,</span>
<a href="#l4.791"></a><span id="l4.791">   &quot;-&quot;,</span>
<a href="#l4.792"></a><span id="l4.792">   &quot;_core&quot;,</span>
<a href="#l4.793"></a><span id="l4.793">   &quot;-&quot;,</span>
<a href="#l4.794"></a><span id="l4.794">   &quot;^lang&quot;,</span>
<a href="#l4.795"></a><span id="l4.795">   &quot;dir&quot;,</span>
<a href="#l4.796"></a><span id="l4.796"> ];</span>
<a href="#l4.797"></a><span id="l4.797"> </span>
<a href="#l4.798"></a><span id="l4.798"> gHTMLAttr.h5_align = gHAlignJustify;</span>
<a href="#l4.799"></a><span id="l4.799"> </span>
<a href="#l4.800"></a><span id="l4.800" class="difflineminus">-gHTMLAttr.h6 =</span>
<a href="#l4.801"></a><span id="l4.801" class="difflineminus">-[</span>
<a href="#l4.802"></a><span id="l4.802" class="difflineplus">+gHTMLAttr.h6 = [</span>
<a href="#l4.803"></a><span id="l4.803">   &quot;align&quot;,</span>
<a href="#l4.804"></a><span id="l4.804">   &quot;-&quot;,</span>
<a href="#l4.805"></a><span id="l4.805">   &quot;_core&quot;,</span>
<a href="#l4.806"></a><span id="l4.806">   &quot;-&quot;,</span>
<a href="#l4.807"></a><span id="l4.807">   &quot;^lang&quot;,</span>
<a href="#l4.808"></a><span id="l4.808">   &quot;dir&quot;,</span>
<a href="#l4.809"></a><span id="l4.809"> ];</span>
<a href="#l4.810"></a><span id="l4.810"> </span>
<a href="#l4.811"></a><span id="l4.811"> gHTMLAttr.h6_align = gHAlignJustify;</span>
<a href="#l4.812"></a><span id="l4.812"> </span>
<a href="#l4.813"></a><span id="l4.813" class="difflineminus">-gHTMLAttr.head =</span>
<a href="#l4.814"></a><span id="l4.814" class="difflineminus">-[</span>
<a href="#l4.815"></a><span id="l4.815" class="difflineplus">+gHTMLAttr.head = [</span>
<a href="#l4.816"></a><span id="l4.816">   &quot;profile&quot;,</span>
<a href="#l4.817"></a><span id="l4.817">   &quot;-&quot;,</span>
<a href="#l4.818"></a><span id="l4.818">   &quot;^lang&quot;,</span>
<a href="#l4.819"></a><span id="l4.819">   &quot;dir&quot;,</span>
<a href="#l4.820"></a><span id="l4.820"> ];</span>
<a href="#l4.821"></a><span id="l4.821"> </span>
<a href="#l4.822"></a><span id="l4.822" class="difflineminus">-gHTMLAttr.hr =</span>
<a href="#l4.823"></a><span id="l4.823" class="difflineminus">-[</span>
<a href="#l4.824"></a><span id="l4.824" class="difflineplus">+gHTMLAttr.hr = [</span>
<a href="#l4.825"></a><span id="l4.825">   &quot;align&quot;,</span>
<a href="#l4.826"></a><span id="l4.826">   &quot;noshade&quot;,</span>
<a href="#l4.827"></a><span id="l4.827">   &quot;#size&quot;,</span>
<a href="#l4.828"></a><span id="l4.828">   &quot;%width&quot;,</span>
<a href="#l4.829"></a><span id="l4.829">   &quot;-&quot;,</span>
<a href="#l4.830"></a><span id="l4.830">   &quot;_core&quot;,</span>
<a href="#l4.831"></a><span id="l4.831">   &quot;-&quot;,</span>
<a href="#l4.832"></a><span id="l4.832">   &quot;^lang&quot;,</span>
<a href="#l4.833"></a><span id="l4.833">   &quot;dir&quot;,</span>
<a href="#l4.834"></a><span id="l4.834"> ];</span>
<a href="#l4.835"></a><span id="l4.835"> </span>
<a href="#l4.836"></a><span id="l4.836"> gHTMLAttr.hr_align = gHAlign;</span>
<a href="#l4.837"></a><span id="l4.837"> </span>
<a href="#l4.838"></a><span id="l4.838" class="difflineminus">-gHTMLAttr.hr_noshade =</span>
<a href="#l4.839"></a><span id="l4.839" class="difflineminus">-[</span>
<a href="#l4.840"></a><span id="l4.840" class="difflineplus">+gHTMLAttr.hr_noshade = [</span>
<a href="#l4.841"></a><span id="l4.841">   &quot;noshade&quot;,</span>
<a href="#l4.842"></a><span id="l4.842"> ];</span>
<a href="#l4.843"></a><span id="l4.843"> </span>
<a href="#l4.844"></a><span id="l4.844"> </span>
<a href="#l4.845"></a><span id="l4.845" class="difflineminus">-gHTMLAttr.html =</span>
<a href="#l4.846"></a><span id="l4.846" class="difflineminus">-[</span>
<a href="#l4.847"></a><span id="l4.847" class="difflineplus">+gHTMLAttr.html = [</span>
<a href="#l4.848"></a><span id="l4.848">   &quot;version&quot;,</span>
<a href="#l4.849"></a><span id="l4.849">   &quot;-&quot;,</span>
<a href="#l4.850"></a><span id="l4.850">   &quot;^lang&quot;,</span>
<a href="#l4.851"></a><span id="l4.851">   &quot;dir&quot;,</span>
<a href="#l4.852"></a><span id="l4.852"> ];</span>
<a href="#l4.853"></a><span id="l4.853"> </span>
<a href="#l4.854"></a><span id="l4.854" class="difflineminus">-gHTMLAttr.i =</span>
<a href="#l4.855"></a><span id="l4.855" class="difflineminus">-[</span>
<a href="#l4.856"></a><span id="l4.856" class="difflineplus">+gHTMLAttr.i = [</span>
<a href="#l4.857"></a><span id="l4.857">   &quot;_core&quot;,</span>
<a href="#l4.858"></a><span id="l4.858">   &quot;-&quot;,</span>
<a href="#l4.859"></a><span id="l4.859">   &quot;^lang&quot;,</span>
<a href="#l4.860"></a><span id="l4.860">   &quot;dir&quot;,</span>
<a href="#l4.861"></a><span id="l4.861"> ];</span>
<a href="#l4.862"></a><span id="l4.862"> </span>
<a href="#l4.863"></a><span id="l4.863" class="difflineminus">-gHTMLAttr.iframe =</span>
<a href="#l4.864"></a><span id="l4.864" class="difflineminus">-[</span>
<a href="#l4.865"></a><span id="l4.865" class="difflineplus">+gHTMLAttr.iframe = [</span>
<a href="#l4.866"></a><span id="l4.866">   &quot;longdesc&quot;,</span>
<a href="#l4.867"></a><span id="l4.867">   &quot;name&quot;,</span>
<a href="#l4.868"></a><span id="l4.868">   &quot;src&quot;,</span>
<a href="#l4.869"></a><span id="l4.869">   &quot;$frameborder&quot;,</span>
<a href="#l4.870"></a><span id="l4.870">   &quot;marginwidth&quot;,</span>
<a href="#l4.871"></a><span id="l4.871">   &quot;marginheight&quot;,</span>
<a href="#l4.872"></a><span id="l4.872">   &quot;$scrolling&quot;,</span>
<a href="#l4.873"></a><span id="l4.873">   &quot;align&quot;,</span>
<a href="#l4.874"></a><span id="l4.874">   &quot;%height&quot;,</span>
<a href="#l4.875"></a><span id="l4.875">   &quot;%width&quot;,</span>
<a href="#l4.876"></a><span id="l4.876">   &quot;-&quot;,</span>
<a href="#l4.877"></a><span id="l4.877">   &quot;_core&quot;,</span>
<a href="#l4.878"></a><span id="l4.878"> ];</span>
<a href="#l4.879"></a><span id="l4.879"> </span>
<a href="#l4.880"></a><span id="l4.880" class="difflineminus">-gHTMLAttr.iframe_frameborder =</span>
<a href="#l4.881"></a><span id="l4.881" class="difflineminus">-[</span>
<a href="#l4.882"></a><span id="l4.882" class="difflineplus">+gHTMLAttr.iframe_frameborder = [</span>
<a href="#l4.883"></a><span id="l4.883">   &quot;1&quot;,</span>
<a href="#l4.884"></a><span id="l4.884">   &quot;0&quot;,</span>
<a href="#l4.885"></a><span id="l4.885"> ];</span>
<a href="#l4.886"></a><span id="l4.886"> </span>
<a href="#l4.887"></a><span id="l4.887" class="difflineminus">-gHTMLAttr.iframe_scrolling =</span>
<a href="#l4.888"></a><span id="l4.888" class="difflineminus">-[</span>
<a href="#l4.889"></a><span id="l4.889" class="difflineplus">+gHTMLAttr.iframe_scrolling = [</span>
<a href="#l4.890"></a><span id="l4.890">   &quot;auto&quot;,</span>
<a href="#l4.891"></a><span id="l4.891">   &quot;yes&quot;,</span>
<a href="#l4.892"></a><span id="l4.892">   &quot;no&quot;,</span>
<a href="#l4.893"></a><span id="l4.893"> ];</span>
<a href="#l4.894"></a><span id="l4.894"> </span>
<a href="#l4.895"></a><span id="l4.895" class="difflineminus">-gHTMLAttr.iframe_align =</span>
<a href="#l4.896"></a><span id="l4.896" class="difflineminus">-[</span>
<a href="#l4.897"></a><span id="l4.897" class="difflineplus">+gHTMLAttr.iframe_align = [</span>
<a href="#l4.898"></a><span id="l4.898">   &quot;top&quot;,</span>
<a href="#l4.899"></a><span id="l4.899">   &quot;middle&quot;,</span>
<a href="#l4.900"></a><span id="l4.900">   &quot;bottom&quot;,</span>
<a href="#l4.901"></a><span id="l4.901">   &quot;left&quot;,</span>
<a href="#l4.902"></a><span id="l4.902">   &quot;right&quot;,</span>
<a href="#l4.903"></a><span id="l4.903"> ];</span>
<a href="#l4.904"></a><span id="l4.904"> </span>
<a href="#l4.905"></a><span id="l4.905" class="difflineminus">-gHTMLAttr.img =</span>
<a href="#l4.906"></a><span id="l4.906" class="difflineminus">-[</span>
<a href="#l4.907"></a><span id="l4.907" class="difflineplus">+gHTMLAttr.img = [</span>
<a href="#l4.908"></a><span id="l4.908">   &quot;$src&quot;,</span>
<a href="#l4.909"></a><span id="l4.909">   &quot;$alt&quot;,</span>
<a href="#l4.910"></a><span id="l4.910">   &quot;longdesc&quot;,</span>
<a href="#l4.911"></a><span id="l4.911">   &quot;name&quot;,</span>
<a href="#l4.912"></a><span id="l4.912">   &quot;%height&quot;,</span>
<a href="#l4.913"></a><span id="l4.913">   &quot;%width&quot;,</span>
<a href="#l4.914"></a><span id="l4.914">   &quot;usemap&quot;,</span>
<a href="#l4.915"></a><span id="l4.915">   &quot;ismap&quot;,</span>
<a href="#l4.916"></a><span id="l4.916" class="difflineat">@@ -864,32 +783,29 @@ gHTMLAttr.img =</span>
<a href="#l4.917"></a><span id="l4.917">   &quot;#vspace&quot;,</span>
<a href="#l4.918"></a><span id="l4.918">   &quot;-&quot;,</span>
<a href="#l4.919"></a><span id="l4.919">   &quot;_core&quot;,</span>
<a href="#l4.920"></a><span id="l4.920">   &quot;-&quot;,</span>
<a href="#l4.921"></a><span id="l4.921">   &quot;^lang&quot;,</span>
<a href="#l4.922"></a><span id="l4.922">   &quot;dir&quot;,</span>
<a href="#l4.923"></a><span id="l4.923"> ];</span>
<a href="#l4.924"></a><span id="l4.924"> </span>
<a href="#l4.925"></a><span id="l4.925" class="difflineminus">-gHTMLAttr.img_ismap =</span>
<a href="#l4.926"></a><span id="l4.926" class="difflineminus">-[</span>
<a href="#l4.927"></a><span id="l4.927" class="difflineplus">+gHTMLAttr.img_ismap = [</span>
<a href="#l4.928"></a><span id="l4.928">   &quot;ismap&quot;,</span>
<a href="#l4.929"></a><span id="l4.929"> ];</span>
<a href="#l4.930"></a><span id="l4.930"> </span>
<a href="#l4.931"></a><span id="l4.931" class="difflineminus">-gHTMLAttr.img_align =</span>
<a href="#l4.932"></a><span id="l4.932" class="difflineminus">-[</span>
<a href="#l4.933"></a><span id="l4.933" class="difflineplus">+gHTMLAttr.img_align = [</span>
<a href="#l4.934"></a><span id="l4.934">   &quot;top&quot;,</span>
<a href="#l4.935"></a><span id="l4.935">   &quot;middle&quot;,</span>
<a href="#l4.936"></a><span id="l4.936">   &quot;bottom&quot;,</span>
<a href="#l4.937"></a><span id="l4.937">   &quot;left&quot;,</span>
<a href="#l4.938"></a><span id="l4.938">   &quot;right&quot;,</span>
<a href="#l4.939"></a><span id="l4.939"> ];</span>
<a href="#l4.940"></a><span id="l4.940"> </span>
<a href="#l4.941"></a><span id="l4.941" class="difflineminus">-gHTMLAttr.input =</span>
<a href="#l4.942"></a><span id="l4.942" class="difflineminus">-[</span>
<a href="#l4.943"></a><span id="l4.943" class="difflineplus">+gHTMLAttr.input = [</span>
<a href="#l4.944"></a><span id="l4.944">   &quot;$type&quot;,</span>
<a href="#l4.945"></a><span id="l4.945">   &quot;name&quot;,</span>
<a href="#l4.946"></a><span id="l4.946">   &quot;value&quot;,</span>
<a href="#l4.947"></a><span id="l4.947">   &quot;checked&quot;,</span>
<a href="#l4.948"></a><span id="l4.948">   &quot;disabled&quot;,</span>
<a href="#l4.949"></a><span id="l4.949">   &quot;readonly&quot;,</span>
<a href="#l4.950"></a><span id="l4.950">   &quot;#size&quot;,</span>
<a href="#l4.951"></a><span id="l4.951">   &quot;#maxlength&quot;,</span>
<a href="#l4.952"></a><span id="l4.952" class="difflineat">@@ -903,146 +819,131 @@ gHTMLAttr.input =</span>
<a href="#l4.953"></a><span id="l4.953">   &quot;align&quot;,</span>
<a href="#l4.954"></a><span id="l4.954">   &quot;-&quot;,</span>
<a href="#l4.955"></a><span id="l4.955">   &quot;_core&quot;,</span>
<a href="#l4.956"></a><span id="l4.956">   &quot;-&quot;,</span>
<a href="#l4.957"></a><span id="l4.957">   &quot;^lang&quot;,</span>
<a href="#l4.958"></a><span id="l4.958">   &quot;dir&quot;,</span>
<a href="#l4.959"></a><span id="l4.959"> ];</span>
<a href="#l4.960"></a><span id="l4.960"> </span>
<a href="#l4.961"></a><span id="l4.961" class="difflineminus">-gHTMLAttr.input_type =</span>
<a href="#l4.962"></a><span id="l4.962" class="difflineminus">-[</span>
<a href="#l4.963"></a><span id="l4.963" class="difflineplus">+gHTMLAttr.input_type = [</span>
<a href="#l4.964"></a><span id="l4.964">   &quot;text&quot;,</span>
<a href="#l4.965"></a><span id="l4.965">   &quot;password&quot;,</span>
<a href="#l4.966"></a><span id="l4.966">   &quot;checkbox&quot;,</span>
<a href="#l4.967"></a><span id="l4.967">   &quot;radio&quot;,</span>
<a href="#l4.968"></a><span id="l4.968">   &quot;submit&quot;,</span>
<a href="#l4.969"></a><span id="l4.969">   &quot;reset&quot;,</span>
<a href="#l4.970"></a><span id="l4.970">   &quot;file&quot;,</span>
<a href="#l4.971"></a><span id="l4.971">   &quot;hidden&quot;,</span>
<a href="#l4.972"></a><span id="l4.972">   &quot;image&quot;,</span>
<a href="#l4.973"></a><span id="l4.973">   &quot;button&quot;,</span>
<a href="#l4.974"></a><span id="l4.974"> ];</span>
<a href="#l4.975"></a><span id="l4.975"> </span>
<a href="#l4.976"></a><span id="l4.976" class="difflineminus">-gHTMLAttr.input_checked =</span>
<a href="#l4.977"></a><span id="l4.977" class="difflineminus">-[</span>
<a href="#l4.978"></a><span id="l4.978" class="difflineplus">+gHTMLAttr.input_checked = [</span>
<a href="#l4.979"></a><span id="l4.979">   &quot;checked&quot;,</span>
<a href="#l4.980"></a><span id="l4.980"> ];</span>
<a href="#l4.981"></a><span id="l4.981"> </span>
<a href="#l4.982"></a><span id="l4.982" class="difflineminus">-gHTMLAttr.input_disabled =</span>
<a href="#l4.983"></a><span id="l4.983" class="difflineminus">-[</span>
<a href="#l4.984"></a><span id="l4.984" class="difflineplus">+gHTMLAttr.input_disabled = [</span>
<a href="#l4.985"></a><span id="l4.985">   &quot;disabled&quot;,</span>
<a href="#l4.986"></a><span id="l4.986"> ];</span>
<a href="#l4.987"></a><span id="l4.987"> </span>
<a href="#l4.988"></a><span id="l4.988" class="difflineminus">-gHTMLAttr.input_readonly =</span>
<a href="#l4.989"></a><span id="l4.989" class="difflineminus">-[</span>
<a href="#l4.990"></a><span id="l4.990" class="difflineplus">+gHTMLAttr.input_readonly = [</span>
<a href="#l4.991"></a><span id="l4.991">   &quot;readonly&quot;,</span>
<a href="#l4.992"></a><span id="l4.992"> ];</span>
<a href="#l4.993"></a><span id="l4.993"> </span>
<a href="#l4.994"></a><span id="l4.994"> </span>
<a href="#l4.995"></a><span id="l4.995" class="difflineminus">-gHTMLAttr.input_ismap =</span>
<a href="#l4.996"></a><span id="l4.996" class="difflineminus">-[</span>
<a href="#l4.997"></a><span id="l4.997" class="difflineplus">+gHTMLAttr.input_ismap = [</span>
<a href="#l4.998"></a><span id="l4.998">   &quot;ismap&quot;,</span>
<a href="#l4.999"></a><span id="l4.999"> ];</span>
<a href="#l4.1000"></a><span id="l4.1000"> </span>
<a href="#l4.1001"></a><span id="l4.1001"> </span>
<a href="#l4.1002"></a><span id="l4.1002" class="difflineminus">-gHTMLAttr.input_align =</span>
<a href="#l4.1003"></a><span id="l4.1003" class="difflineminus">-[</span>
<a href="#l4.1004"></a><span id="l4.1004" class="difflineplus">+gHTMLAttr.input_align = [</span>
<a href="#l4.1005"></a><span id="l4.1005">   &quot;top&quot;,</span>
<a href="#l4.1006"></a><span id="l4.1006">   &quot;middle&quot;,</span>
<a href="#l4.1007"></a><span id="l4.1007">   &quot;bottom&quot;,</span>
<a href="#l4.1008"></a><span id="l4.1008">   &quot;left&quot;,</span>
<a href="#l4.1009"></a><span id="l4.1009">   &quot;right&quot;,</span>
<a href="#l4.1010"></a><span id="l4.1010"> ];</span>
<a href="#l4.1011"></a><span id="l4.1011"> </span>
<a href="#l4.1012"></a><span id="l4.1012" class="difflineminus">-gHTMLAttr.ins =</span>
<a href="#l4.1013"></a><span id="l4.1013" class="difflineminus">-[</span>
<a href="#l4.1014"></a><span id="l4.1014" class="difflineplus">+gHTMLAttr.ins = [</span>
<a href="#l4.1015"></a><span id="l4.1015">   &quot;cite&quot;,</span>
<a href="#l4.1016"></a><span id="l4.1016">   &quot;datetime&quot;,</span>
<a href="#l4.1017"></a><span id="l4.1017">   &quot;-&quot;,</span>
<a href="#l4.1018"></a><span id="l4.1018">   &quot;_core&quot;,</span>
<a href="#l4.1019"></a><span id="l4.1019">   &quot;-&quot;,</span>
<a href="#l4.1020"></a><span id="l4.1020">   &quot;^lang&quot;,</span>
<a href="#l4.1021"></a><span id="l4.1021">   &quot;dir&quot;,</span>
<a href="#l4.1022"></a><span id="l4.1022"> ];</span>
<a href="#l4.1023"></a><span id="l4.1023"> </span>
<a href="#l4.1024"></a><span id="l4.1024" class="difflineminus">-gHTMLAttr.isindex =</span>
<a href="#l4.1025"></a><span id="l4.1025" class="difflineminus">-[</span>
<a href="#l4.1026"></a><span id="l4.1026" class="difflineplus">+gHTMLAttr.isindex = [</span>
<a href="#l4.1027"></a><span id="l4.1027">   &quot;prompt&quot;,</span>
<a href="#l4.1028"></a><span id="l4.1028">   &quot;-&quot;,</span>
<a href="#l4.1029"></a><span id="l4.1029">   &quot;_core&quot;,</span>
<a href="#l4.1030"></a><span id="l4.1030">   &quot;-&quot;,</span>
<a href="#l4.1031"></a><span id="l4.1031">   &quot;^lang&quot;,</span>
<a href="#l4.1032"></a><span id="l4.1032">   &quot;dir&quot;,</span>
<a href="#l4.1033"></a><span id="l4.1033"> ];</span>
<a href="#l4.1034"></a><span id="l4.1034"> </span>
<a href="#l4.1035"></a><span id="l4.1035" class="difflineminus">-gHTMLAttr.kbd =</span>
<a href="#l4.1036"></a><span id="l4.1036" class="difflineminus">-[</span>
<a href="#l4.1037"></a><span id="l4.1037" class="difflineplus">+gHTMLAttr.kbd = [</span>
<a href="#l4.1038"></a><span id="l4.1038">   &quot;_core&quot;,</span>
<a href="#l4.1039"></a><span id="l4.1039">   &quot;-&quot;,</span>
<a href="#l4.1040"></a><span id="l4.1040">   &quot;^lang&quot;,</span>
<a href="#l4.1041"></a><span id="l4.1041">   &quot;dir&quot;,</span>
<a href="#l4.1042"></a><span id="l4.1042"> ];</span>
<a href="#l4.1043"></a><span id="l4.1043"> </span>
<a href="#l4.1044"></a><span id="l4.1044" class="difflineminus">-gHTMLAttr.label =</span>
<a href="#l4.1045"></a><span id="l4.1045" class="difflineminus">-[</span>
<a href="#l4.1046"></a><span id="l4.1046" class="difflineplus">+gHTMLAttr.label = [</span>
<a href="#l4.1047"></a><span id="l4.1047">   &quot;for&quot;,</span>
<a href="#l4.1048"></a><span id="l4.1048">   &quot;!accesskey&quot;,</span>
<a href="#l4.1049"></a><span id="l4.1049">   &quot;-&quot;,</span>
<a href="#l4.1050"></a><span id="l4.1050">   &quot;_core&quot;,</span>
<a href="#l4.1051"></a><span id="l4.1051">   &quot;-&quot;,</span>
<a href="#l4.1052"></a><span id="l4.1052">   &quot;^lang&quot;,</span>
<a href="#l4.1053"></a><span id="l4.1053">   &quot;dir&quot;,</span>
<a href="#l4.1054"></a><span id="l4.1054"> ];</span>
<a href="#l4.1055"></a><span id="l4.1055"> </span>
<a href="#l4.1056"></a><span id="l4.1056" class="difflineminus">-gHTMLAttr.legend =</span>
<a href="#l4.1057"></a><span id="l4.1057" class="difflineminus">-[</span>
<a href="#l4.1058"></a><span id="l4.1058" class="difflineplus">+gHTMLAttr.legend = [</span>
<a href="#l4.1059"></a><span id="l4.1059">   &quot;!accesskey&quot;,</span>
<a href="#l4.1060"></a><span id="l4.1060">   &quot;align&quot;,</span>
<a href="#l4.1061"></a><span id="l4.1061">   &quot;-&quot;,</span>
<a href="#l4.1062"></a><span id="l4.1062">   &quot;_core&quot;,</span>
<a href="#l4.1063"></a><span id="l4.1063">   &quot;-&quot;,</span>
<a href="#l4.1064"></a><span id="l4.1064">   &quot;^lang&quot;,</span>
<a href="#l4.1065"></a><span id="l4.1065">   &quot;dir&quot;,</span>
<a href="#l4.1066"></a><span id="l4.1066"> ];</span>
<a href="#l4.1067"></a><span id="l4.1067"> </span>
<a href="#l4.1068"></a><span id="l4.1068" class="difflineminus">-gHTMLAttr.legend_align =</span>
<a href="#l4.1069"></a><span id="l4.1069" class="difflineminus">-[</span>
<a href="#l4.1070"></a><span id="l4.1070" class="difflineplus">+gHTMLAttr.legend_align = [</span>
<a href="#l4.1071"></a><span id="l4.1071">   &quot;top&quot;,</span>
<a href="#l4.1072"></a><span id="l4.1072">   &quot;bottom&quot;,</span>
<a href="#l4.1073"></a><span id="l4.1073">   &quot;left&quot;,</span>
<a href="#l4.1074"></a><span id="l4.1074">   &quot;right&quot;,</span>
<a href="#l4.1075"></a><span id="l4.1075"> ];</span>
<a href="#l4.1076"></a><span id="l4.1076"> </span>
<a href="#l4.1077"></a><span id="l4.1077" class="difflineminus">-gHTMLAttr.li =</span>
<a href="#l4.1078"></a><span id="l4.1078" class="difflineminus">-[</span>
<a href="#l4.1079"></a><span id="l4.1079" class="difflineplus">+gHTMLAttr.li = [</span>
<a href="#l4.1080"></a><span id="l4.1080">   &quot;type&quot;,</span>
<a href="#l4.1081"></a><span id="l4.1081">   &quot;#value&quot;,</span>
<a href="#l4.1082"></a><span id="l4.1082">   &quot;-&quot;,</span>
<a href="#l4.1083"></a><span id="l4.1083">   &quot;_core&quot;,</span>
<a href="#l4.1084"></a><span id="l4.1084">   &quot;-&quot;,</span>
<a href="#l4.1085"></a><span id="l4.1085">   &quot;^lang&quot;,</span>
<a href="#l4.1086"></a><span id="l4.1086">   &quot;dir&quot;,</span>
<a href="#l4.1087"></a><span id="l4.1087"> ];</span>
<a href="#l4.1088"></a><span id="l4.1088"> </span>
<a href="#l4.1089"></a><span id="l4.1089" class="difflineminus">-gHTMLAttr.li_type =</span>
<a href="#l4.1090"></a><span id="l4.1090" class="difflineminus">-[</span>
<a href="#l4.1091"></a><span id="l4.1091" class="difflineplus">+gHTMLAttr.li_type = [</span>
<a href="#l4.1092"></a><span id="l4.1092">   &quot;disc&quot;,</span>
<a href="#l4.1093"></a><span id="l4.1093">   &quot;square&quot;,</span>
<a href="#l4.1094"></a><span id="l4.1094">   &quot;circle&quot;,</span>
<a href="#l4.1095"></a><span id="l4.1095">   &quot;-&quot;,</span>
<a href="#l4.1096"></a><span id="l4.1096">   &quot;1&quot;,</span>
<a href="#l4.1097"></a><span id="l4.1097">   &quot;a&quot;,</span>
<a href="#l4.1098"></a><span id="l4.1098">   &quot;A&quot;,</span>
<a href="#l4.1099"></a><span id="l4.1099">   &quot;i&quot;,</span>
<a href="#l4.1100"></a><span id="l4.1100">   &quot;I&quot;,</span>
<a href="#l4.1101"></a><span id="l4.1101"> ];</span>
<a href="#l4.1102"></a><span id="l4.1102"> </span>
<a href="#l4.1103"></a><span id="l4.1103" class="difflineminus">-gHTMLAttr.link =</span>
<a href="#l4.1104"></a><span id="l4.1104" class="difflineminus">-[</span>
<a href="#l4.1105"></a><span id="l4.1105" class="difflineplus">+gHTMLAttr.link = [</span>
<a href="#l4.1106"></a><span id="l4.1106">   &quot;charset&quot;,</span>
<a href="#l4.1107"></a><span id="l4.1107">   &quot;href&quot;,</span>
<a href="#l4.1108"></a><span id="l4.1108">   &quot;^hreflang&quot;,</span>
<a href="#l4.1109"></a><span id="l4.1109">   &quot;type&quot;,</span>
<a href="#l4.1110"></a><span id="l4.1110">   &quot;rel&quot;,</span>
<a href="#l4.1111"></a><span id="l4.1111">   &quot;rev&quot;,</span>
<a href="#l4.1112"></a><span id="l4.1112">   &quot;media&quot;,</span>
<a href="#l4.1113"></a><span id="l4.1113">   &quot;target&quot;,</span>
<a href="#l4.1114"></a><span id="l4.1114" class="difflineat">@@ -1050,18 +951,17 @@ gHTMLAttr.link =</span>
<a href="#l4.1115"></a><span id="l4.1115">   &quot;_core&quot;,</span>
<a href="#l4.1116"></a><span id="l4.1116">   &quot;-&quot;,</span>
<a href="#l4.1117"></a><span id="l4.1117">   &quot;^lang&quot;,</span>
<a href="#l4.1118"></a><span id="l4.1118">   &quot;dir&quot;,</span>
<a href="#l4.1119"></a><span id="l4.1119"> ];</span>
<a href="#l4.1120"></a><span id="l4.1120"> </span>
<a href="#l4.1121"></a><span id="l4.1121"> gHTMLAttr.link_target = gTarget;</span>
<a href="#l4.1122"></a><span id="l4.1122"> </span>
<a href="#l4.1123"></a><span id="l4.1123" class="difflineminus">-gHTMLAttr.link_rel =</span>
<a href="#l4.1124"></a><span id="l4.1124" class="difflineminus">-[</span>
<a href="#l4.1125"></a><span id="l4.1125" class="difflineplus">+gHTMLAttr.link_rel = [</span>
<a href="#l4.1126"></a><span id="l4.1126">   &quot;alternate&quot;,</span>
<a href="#l4.1127"></a><span id="l4.1127">   &quot;stylesheet&quot;,</span>
<a href="#l4.1128"></a><span id="l4.1128">   &quot;start&quot;,</span>
<a href="#l4.1129"></a><span id="l4.1129">   &quot;next&quot;,</span>
<a href="#l4.1130"></a><span id="l4.1130">   &quot;prev&quot;,</span>
<a href="#l4.1131"></a><span id="l4.1131">   &quot;contents&quot;,</span>
<a href="#l4.1132"></a><span id="l4.1132">   &quot;index&quot;,</span>
<a href="#l4.1133"></a><span id="l4.1133">   &quot;glossary&quot;,</span>
<a href="#l4.1134"></a><span id="l4.1134" class="difflineat">@@ -1069,18 +969,17 @@ gHTMLAttr.link_rel =</span>
<a href="#l4.1135"></a><span id="l4.1135">   &quot;chapter&quot;,</span>
<a href="#l4.1136"></a><span id="l4.1136">   &quot;section&quot;,</span>
<a href="#l4.1137"></a><span id="l4.1137">   &quot;subsection&quot;,</span>
<a href="#l4.1138"></a><span id="l4.1138">   &quot;appendix&quot;,</span>
<a href="#l4.1139"></a><span id="l4.1139">   &quot;help&quot;,</span>
<a href="#l4.1140"></a><span id="l4.1140">   &quot;bookmark&quot;,</span>
<a href="#l4.1141"></a><span id="l4.1141"> ];</span>
<a href="#l4.1142"></a><span id="l4.1142"> </span>
<a href="#l4.1143"></a><span id="l4.1143" class="difflineminus">-gHTMLAttr.link_rev =</span>
<a href="#l4.1144"></a><span id="l4.1144" class="difflineminus">-[</span>
<a href="#l4.1145"></a><span id="l4.1145" class="difflineplus">+gHTMLAttr.link_rev = [</span>
<a href="#l4.1146"></a><span id="l4.1146">   &quot;alternate&quot;,</span>
<a href="#l4.1147"></a><span id="l4.1147">   &quot;stylesheet&quot;,</span>
<a href="#l4.1148"></a><span id="l4.1148">   &quot;start&quot;,</span>
<a href="#l4.1149"></a><span id="l4.1149">   &quot;next&quot;,</span>
<a href="#l4.1150"></a><span id="l4.1150">   &quot;prev&quot;,</span>
<a href="#l4.1151"></a><span id="l4.1151">   &quot;contents&quot;,</span>
<a href="#l4.1152"></a><span id="l4.1152">   &quot;index&quot;,</span>
<a href="#l4.1153"></a><span id="l4.1153">   &quot;glossary&quot;,</span>
<a href="#l4.1154"></a><span id="l4.1154" class="difflineat">@@ -1088,70 +987,63 @@ gHTMLAttr.link_rev =</span>
<a href="#l4.1155"></a><span id="l4.1155">   &quot;chapter&quot;,</span>
<a href="#l4.1156"></a><span id="l4.1156">   &quot;section&quot;,</span>
<a href="#l4.1157"></a><span id="l4.1157">   &quot;subsection&quot;,</span>
<a href="#l4.1158"></a><span id="l4.1158">   &quot;appendix&quot;,</span>
<a href="#l4.1159"></a><span id="l4.1159">   &quot;help&quot;,</span>
<a href="#l4.1160"></a><span id="l4.1160">   &quot;bookmark&quot;,</span>
<a href="#l4.1161"></a><span id="l4.1161"> ];</span>
<a href="#l4.1162"></a><span id="l4.1162"> </span>
<a href="#l4.1163"></a><span id="l4.1163" class="difflineminus">-gHTMLAttr.map =</span>
<a href="#l4.1164"></a><span id="l4.1164" class="difflineminus">-[</span>
<a href="#l4.1165"></a><span id="l4.1165" class="difflineplus">+gHTMLAttr.map = [</span>
<a href="#l4.1166"></a><span id="l4.1166">   &quot;$name&quot;,</span>
<a href="#l4.1167"></a><span id="l4.1167">   &quot;-&quot;,</span>
<a href="#l4.1168"></a><span id="l4.1168">   &quot;_core&quot;,</span>
<a href="#l4.1169"></a><span id="l4.1169">   &quot;-&quot;,</span>
<a href="#l4.1170"></a><span id="l4.1170">   &quot;^lang&quot;,</span>
<a href="#l4.1171"></a><span id="l4.1171">   &quot;dir&quot;,</span>
<a href="#l4.1172"></a><span id="l4.1172"> ];</span>
<a href="#l4.1173"></a><span id="l4.1173"> </span>
<a href="#l4.1174"></a><span id="l4.1174" class="difflineminus">-gHTMLAttr.menu =</span>
<a href="#l4.1175"></a><span id="l4.1175" class="difflineminus">-[</span>
<a href="#l4.1176"></a><span id="l4.1176" class="difflineplus">+gHTMLAttr.menu = [</span>
<a href="#l4.1177"></a><span id="l4.1177">   &quot;compact&quot;,</span>
<a href="#l4.1178"></a><span id="l4.1178">   &quot;-&quot;,</span>
<a href="#l4.1179"></a><span id="l4.1179">   &quot;_core&quot;,</span>
<a href="#l4.1180"></a><span id="l4.1180">   &quot;-&quot;,</span>
<a href="#l4.1181"></a><span id="l4.1181">   &quot;^lang&quot;,</span>
<a href="#l4.1182"></a><span id="l4.1182">   &quot;dir&quot;,</span>
<a href="#l4.1183"></a><span id="l4.1183"> ];</span>
<a href="#l4.1184"></a><span id="l4.1184"> </span>
<a href="#l4.1185"></a><span id="l4.1185" class="difflineminus">-gHTMLAttr.menu_compact =</span>
<a href="#l4.1186"></a><span id="l4.1186" class="difflineminus">-[</span>
<a href="#l4.1187"></a><span id="l4.1187" class="difflineplus">+gHTMLAttr.menu_compact = [</span>
<a href="#l4.1188"></a><span id="l4.1188">   &quot;compact&quot;,</span>
<a href="#l4.1189"></a><span id="l4.1189"> ];</span>
<a href="#l4.1190"></a><span id="l4.1190"> </span>
<a href="#l4.1191"></a><span id="l4.1191" class="difflineminus">-gHTMLAttr.meta =</span>
<a href="#l4.1192"></a><span id="l4.1192" class="difflineminus">-[</span>
<a href="#l4.1193"></a><span id="l4.1193" class="difflineplus">+gHTMLAttr.meta = [</span>
<a href="#l4.1194"></a><span id="l4.1194">   &quot;http-equiv&quot;,</span>
<a href="#l4.1195"></a><span id="l4.1195">   &quot;name&quot;,</span>
<a href="#l4.1196"></a><span id="l4.1196">   &quot;$content&quot;,</span>
<a href="#l4.1197"></a><span id="l4.1197">   &quot;scheme&quot;,</span>
<a href="#l4.1198"></a><span id="l4.1198">   &quot;-&quot;,</span>
<a href="#l4.1199"></a><span id="l4.1199">   &quot;^lang&quot;,</span>
<a href="#l4.1200"></a><span id="l4.1200">   &quot;dir&quot;,</span>
<a href="#l4.1201"></a><span id="l4.1201"> ];</span>
<a href="#l4.1202"></a><span id="l4.1202"> </span>
<a href="#l4.1203"></a><span id="l4.1203" class="difflineminus">-gHTMLAttr.noframes =</span>
<a href="#l4.1204"></a><span id="l4.1204" class="difflineminus">-[</span>
<a href="#l4.1205"></a><span id="l4.1205" class="difflineplus">+gHTMLAttr.noframes = [</span>
<a href="#l4.1206"></a><span id="l4.1206">   &quot;_core&quot;,</span>
<a href="#l4.1207"></a><span id="l4.1207">   &quot;-&quot;,</span>
<a href="#l4.1208"></a><span id="l4.1208">   &quot;^lang&quot;,</span>
<a href="#l4.1209"></a><span id="l4.1209">   &quot;dir&quot;,</span>
<a href="#l4.1210"></a><span id="l4.1210"> ];</span>
<a href="#l4.1211"></a><span id="l4.1211"> </span>
<a href="#l4.1212"></a><span id="l4.1212" class="difflineminus">-gHTMLAttr.noscript =</span>
<a href="#l4.1213"></a><span id="l4.1213" class="difflineminus">-[</span>
<a href="#l4.1214"></a><span id="l4.1214" class="difflineplus">+gHTMLAttr.noscript = [</span>
<a href="#l4.1215"></a><span id="l4.1215">   &quot;_core&quot;,</span>
<a href="#l4.1216"></a><span id="l4.1216">   &quot;-&quot;,</span>
<a href="#l4.1217"></a><span id="l4.1217">   &quot;^lang&quot;,</span>
<a href="#l4.1218"></a><span id="l4.1218">   &quot;dir&quot;,</span>
<a href="#l4.1219"></a><span id="l4.1219"> ];</span>
<a href="#l4.1220"></a><span id="l4.1220"> </span>
<a href="#l4.1221"></a><span id="l4.1221" class="difflineminus">-gHTMLAttr.object =</span>
<a href="#l4.1222"></a><span id="l4.1222" class="difflineminus">-[</span>
<a href="#l4.1223"></a><span id="l4.1223" class="difflineplus">+gHTMLAttr.object = [</span>
<a href="#l4.1224"></a><span id="l4.1224">   &quot;declare&quot;,</span>
<a href="#l4.1225"></a><span id="l4.1225">   &quot;classid&quot;,</span>
<a href="#l4.1226"></a><span id="l4.1226">   &quot;codebase&quot;,</span>
<a href="#l4.1227"></a><span id="l4.1227">   &quot;data&quot;,</span>
<a href="#l4.1228"></a><span id="l4.1228">   &quot;type&quot;,</span>
<a href="#l4.1229"></a><span id="l4.1229">   &quot;codetype&quot;,</span>
<a href="#l4.1230"></a><span id="l4.1230">   &quot;archive&quot;,</span>
<a href="#l4.1231"></a><span id="l4.1231">   &quot;standby&quot;,</span>
<a href="#l4.1232"></a><span id="l4.1232" class="difflineat">@@ -1166,325 +1058,291 @@ gHTMLAttr.object =</span>
<a href="#l4.1233"></a><span id="l4.1233">   &quot;#vspace&quot;,</span>
<a href="#l4.1234"></a><span id="l4.1234">   &quot;-&quot;,</span>
<a href="#l4.1235"></a><span id="l4.1235">   &quot;_core&quot;,</span>
<a href="#l4.1236"></a><span id="l4.1236">   &quot;-&quot;,</span>
<a href="#l4.1237"></a><span id="l4.1237">   &quot;^lang&quot;,</span>
<a href="#l4.1238"></a><span id="l4.1238">   &quot;dir&quot;,</span>
<a href="#l4.1239"></a><span id="l4.1239"> ];</span>
<a href="#l4.1240"></a><span id="l4.1240"> </span>
<a href="#l4.1241"></a><span id="l4.1241" class="difflineminus">-gHTMLAttr.object_declare =</span>
<a href="#l4.1242"></a><span id="l4.1242" class="difflineminus">-[</span>
<a href="#l4.1243"></a><span id="l4.1243" class="difflineplus">+gHTMLAttr.object_declare = [</span>
<a href="#l4.1244"></a><span id="l4.1244">   &quot;declare&quot;,</span>
<a href="#l4.1245"></a><span id="l4.1245"> ];</span>
<a href="#l4.1246"></a><span id="l4.1246"> </span>
<a href="#l4.1247"></a><span id="l4.1247" class="difflineminus">-gHTMLAttr.object_align =</span>
<a href="#l4.1248"></a><span id="l4.1248" class="difflineminus">-[</span>
<a href="#l4.1249"></a><span id="l4.1249" class="difflineplus">+gHTMLAttr.object_align = [</span>
<a href="#l4.1250"></a><span id="l4.1250">   &quot;top&quot;,</span>
<a href="#l4.1251"></a><span id="l4.1251">   &quot;middle&quot;,</span>
<a href="#l4.1252"></a><span id="l4.1252">   &quot;bottom&quot;,</span>
<a href="#l4.1253"></a><span id="l4.1253">   &quot;left&quot;,</span>
<a href="#l4.1254"></a><span id="l4.1254">   &quot;right&quot;,</span>
<a href="#l4.1255"></a><span id="l4.1255"> ];</span>
<a href="#l4.1256"></a><span id="l4.1256"> </span>
<a href="#l4.1257"></a><span id="l4.1257" class="difflineminus">-gHTMLAttr.ol =</span>
<a href="#l4.1258"></a><span id="l4.1258" class="difflineminus">-[</span>
<a href="#l4.1259"></a><span id="l4.1259" class="difflineplus">+gHTMLAttr.ol = [</span>
<a href="#l4.1260"></a><span id="l4.1260">   &quot;type&quot;,</span>
<a href="#l4.1261"></a><span id="l4.1261">   &quot;compact&quot;,</span>
<a href="#l4.1262"></a><span id="l4.1262">   &quot;#start&quot;,</span>
<a href="#l4.1263"></a><span id="l4.1263">   &quot;-&quot;,</span>
<a href="#l4.1264"></a><span id="l4.1264">   &quot;_core&quot;,</span>
<a href="#l4.1265"></a><span id="l4.1265">   &quot;-&quot;,</span>
<a href="#l4.1266"></a><span id="l4.1266">   &quot;^lang&quot;,</span>
<a href="#l4.1267"></a><span id="l4.1267">   &quot;dir&quot;,</span>
<a href="#l4.1268"></a><span id="l4.1268"> ];</span>
<a href="#l4.1269"></a><span id="l4.1269"> </span>
<a href="#l4.1270"></a><span id="l4.1270" class="difflineminus">-gHTMLAttr.ol_type =</span>
<a href="#l4.1271"></a><span id="l4.1271" class="difflineminus">-[</span>
<a href="#l4.1272"></a><span id="l4.1272" class="difflineplus">+gHTMLAttr.ol_type = [</span>
<a href="#l4.1273"></a><span id="l4.1273">   &quot;1&quot;,</span>
<a href="#l4.1274"></a><span id="l4.1274">   &quot;a&quot;,</span>
<a href="#l4.1275"></a><span id="l4.1275">   &quot;A&quot;,</span>
<a href="#l4.1276"></a><span id="l4.1276">   &quot;i&quot;,</span>
<a href="#l4.1277"></a><span id="l4.1277">   &quot;I&quot;,</span>
<a href="#l4.1278"></a><span id="l4.1278"> ];</span>
<a href="#l4.1279"></a><span id="l4.1279"> </span>
<a href="#l4.1280"></a><span id="l4.1280" class="difflineminus">-gHTMLAttr.ol_compact =</span>
<a href="#l4.1281"></a><span id="l4.1281" class="difflineminus">-[</span>
<a href="#l4.1282"></a><span id="l4.1282" class="difflineplus">+gHTMLAttr.ol_compact = [</span>
<a href="#l4.1283"></a><span id="l4.1283">   &quot;compact&quot;,</span>
<a href="#l4.1284"></a><span id="l4.1284"> ];</span>
<a href="#l4.1285"></a><span id="l4.1285"> </span>
<a href="#l4.1286"></a><span id="l4.1286"> </span>
<a href="#l4.1287"></a><span id="l4.1287" class="difflineminus">-gHTMLAttr.optgroup =</span>
<a href="#l4.1288"></a><span id="l4.1288" class="difflineminus">-[</span>
<a href="#l4.1289"></a><span id="l4.1289" class="difflineplus">+gHTMLAttr.optgroup = [</span>
<a href="#l4.1290"></a><span id="l4.1290">   &quot;disabled&quot;,</span>
<a href="#l4.1291"></a><span id="l4.1291">   &quot;$label&quot;,</span>
<a href="#l4.1292"></a><span id="l4.1292">   &quot;-&quot;,</span>
<a href="#l4.1293"></a><span id="l4.1293">   &quot;_core&quot;,</span>
<a href="#l4.1294"></a><span id="l4.1294">   &quot;-&quot;,</span>
<a href="#l4.1295"></a><span id="l4.1295">   &quot;^lang&quot;,</span>
<a href="#l4.1296"></a><span id="l4.1296">   &quot;dir&quot;,</span>
<a href="#l4.1297"></a><span id="l4.1297"> ];</span>
<a href="#l4.1298"></a><span id="l4.1298"> </span>
<a href="#l4.1299"></a><span id="l4.1299" class="difflineminus">-gHTMLAttr.optgroup_disabled =</span>
<a href="#l4.1300"></a><span id="l4.1300" class="difflineminus">-[</span>
<a href="#l4.1301"></a><span id="l4.1301" class="difflineplus">+gHTMLAttr.optgroup_disabled = [</span>
<a href="#l4.1302"></a><span id="l4.1302">   &quot;disabled&quot;,</span>
<a href="#l4.1303"></a><span id="l4.1303"> ];</span>
<a href="#l4.1304"></a><span id="l4.1304"> </span>
<a href="#l4.1305"></a><span id="l4.1305"> </span>
<a href="#l4.1306"></a><span id="l4.1306" class="difflineminus">-gHTMLAttr.option =</span>
<a href="#l4.1307"></a><span id="l4.1307" class="difflineminus">-[</span>
<a href="#l4.1308"></a><span id="l4.1308" class="difflineplus">+gHTMLAttr.option = [</span>
<a href="#l4.1309"></a><span id="l4.1309">   &quot;selected&quot;,</span>
<a href="#l4.1310"></a><span id="l4.1310">   &quot;disabled&quot;,</span>
<a href="#l4.1311"></a><span id="l4.1311">   &quot;label&quot;,</span>
<a href="#l4.1312"></a><span id="l4.1312">   &quot;value&quot;,</span>
<a href="#l4.1313"></a><span id="l4.1313">   &quot;-&quot;,</span>
<a href="#l4.1314"></a><span id="l4.1314">   &quot;_core&quot;,</span>
<a href="#l4.1315"></a><span id="l4.1315">   &quot;-&quot;,</span>
<a href="#l4.1316"></a><span id="l4.1316">   &quot;^lang&quot;,</span>
<a href="#l4.1317"></a><span id="l4.1317">   &quot;dir&quot;,</span>
<a href="#l4.1318"></a><span id="l4.1318"> ];</span>
<a href="#l4.1319"></a><span id="l4.1319"> </span>
<a href="#l4.1320"></a><span id="l4.1320" class="difflineminus">-gHTMLAttr.option_selected =</span>
<a href="#l4.1321"></a><span id="l4.1321" class="difflineminus">-[</span>
<a href="#l4.1322"></a><span id="l4.1322" class="difflineplus">+gHTMLAttr.option_selected = [</span>
<a href="#l4.1323"></a><span id="l4.1323">   &quot;selected&quot;,</span>
<a href="#l4.1324"></a><span id="l4.1324"> ];</span>
<a href="#l4.1325"></a><span id="l4.1325"> </span>
<a href="#l4.1326"></a><span id="l4.1326" class="difflineminus">-gHTMLAttr.option_disabled =</span>
<a href="#l4.1327"></a><span id="l4.1327" class="difflineminus">-[</span>
<a href="#l4.1328"></a><span id="l4.1328" class="difflineplus">+gHTMLAttr.option_disabled = [</span>
<a href="#l4.1329"></a><span id="l4.1329">   &quot;disabled&quot;,</span>
<a href="#l4.1330"></a><span id="l4.1330"> ];</span>
<a href="#l4.1331"></a><span id="l4.1331"> </span>
<a href="#l4.1332"></a><span id="l4.1332"> </span>
<a href="#l4.1333"></a><span id="l4.1333" class="difflineminus">-gHTMLAttr.p =</span>
<a href="#l4.1334"></a><span id="l4.1334" class="difflineminus">-[</span>
<a href="#l4.1335"></a><span id="l4.1335" class="difflineplus">+gHTMLAttr.p = [</span>
<a href="#l4.1336"></a><span id="l4.1336">   &quot;align&quot;,</span>
<a href="#l4.1337"></a><span id="l4.1337">   &quot;-&quot;,</span>
<a href="#l4.1338"></a><span id="l4.1338">   &quot;_core&quot;,</span>
<a href="#l4.1339"></a><span id="l4.1339">   &quot;-&quot;,</span>
<a href="#l4.1340"></a><span id="l4.1340">   &quot;^lang&quot;,</span>
<a href="#l4.1341"></a><span id="l4.1341">   &quot;dir&quot;,</span>
<a href="#l4.1342"></a><span id="l4.1342"> ];</span>
<a href="#l4.1343"></a><span id="l4.1343"> </span>
<a href="#l4.1344"></a><span id="l4.1344"> gHTMLAttr.p_align = gHAlignJustify;</span>
<a href="#l4.1345"></a><span id="l4.1345"> </span>
<a href="#l4.1346"></a><span id="l4.1346" class="difflineminus">-gHTMLAttr.param =</span>
<a href="#l4.1347"></a><span id="l4.1347" class="difflineminus">-[</span>
<a href="#l4.1348"></a><span id="l4.1348" class="difflineplus">+gHTMLAttr.param = [</span>
<a href="#l4.1349"></a><span id="l4.1349">   &quot;^id&quot;,</span>
<a href="#l4.1350"></a><span id="l4.1350">   &quot;$name&quot;,</span>
<a href="#l4.1351"></a><span id="l4.1351">   &quot;value&quot;,</span>
<a href="#l4.1352"></a><span id="l4.1352">   &quot;$valuetype&quot;,</span>
<a href="#l4.1353"></a><span id="l4.1353">   &quot;type&quot;,</span>
<a href="#l4.1354"></a><span id="l4.1354"> ];</span>
<a href="#l4.1355"></a><span id="l4.1355"> </span>
<a href="#l4.1356"></a><span id="l4.1356" class="difflineminus">-gHTMLAttr.param_valuetype =</span>
<a href="#l4.1357"></a><span id="l4.1357" class="difflineminus">-[</span>
<a href="#l4.1358"></a><span id="l4.1358" class="difflineplus">+gHTMLAttr.param_valuetype = [</span>
<a href="#l4.1359"></a><span id="l4.1359">   &quot;data&quot;,</span>
<a href="#l4.1360"></a><span id="l4.1360">   &quot;ref&quot;,</span>
<a href="#l4.1361"></a><span id="l4.1361">   &quot;object&quot;,</span>
<a href="#l4.1362"></a><span id="l4.1362"> ];</span>
<a href="#l4.1363"></a><span id="l4.1363"> </span>
<a href="#l4.1364"></a><span id="l4.1364"> </span>
<a href="#l4.1365"></a><span id="l4.1365" class="difflineminus">-gHTMLAttr.pre =</span>
<a href="#l4.1366"></a><span id="l4.1366" class="difflineminus">-[</span>
<a href="#l4.1367"></a><span id="l4.1367" class="difflineplus">+gHTMLAttr.pre = [</span>
<a href="#l4.1368"></a><span id="l4.1368">   &quot;%width&quot;,</span>
<a href="#l4.1369"></a><span id="l4.1369">   &quot;-&quot;,</span>
<a href="#l4.1370"></a><span id="l4.1370">   &quot;_core&quot;,</span>
<a href="#l4.1371"></a><span id="l4.1371">   &quot;-&quot;,</span>
<a href="#l4.1372"></a><span id="l4.1372">   &quot;^lang&quot;,</span>
<a href="#l4.1373"></a><span id="l4.1373">   &quot;dir&quot;,</span>
<a href="#l4.1374"></a><span id="l4.1374"> ];</span>
<a href="#l4.1375"></a><span id="l4.1375"> </span>
<a href="#l4.1376"></a><span id="l4.1376" class="difflineminus">-gHTMLAttr.q =</span>
<a href="#l4.1377"></a><span id="l4.1377" class="difflineminus">-[</span>
<a href="#l4.1378"></a><span id="l4.1378" class="difflineplus">+gHTMLAttr.q = [</span>
<a href="#l4.1379"></a><span id="l4.1379">   &quot;cite&quot;,</span>
<a href="#l4.1380"></a><span id="l4.1380">   &quot;-&quot;,</span>
<a href="#l4.1381"></a><span id="l4.1381">   &quot;_core&quot;,</span>
<a href="#l4.1382"></a><span id="l4.1382">   &quot;-&quot;,</span>
<a href="#l4.1383"></a><span id="l4.1383">   &quot;^lang&quot;,</span>
<a href="#l4.1384"></a><span id="l4.1384">   &quot;dir&quot;,</span>
<a href="#l4.1385"></a><span id="l4.1385"> ];</span>
<a href="#l4.1386"></a><span id="l4.1386"> </span>
<a href="#l4.1387"></a><span id="l4.1387" class="difflineminus">-gHTMLAttr.s =</span>
<a href="#l4.1388"></a><span id="l4.1388" class="difflineminus">-[</span>
<a href="#l4.1389"></a><span id="l4.1389" class="difflineplus">+gHTMLAttr.s = [</span>
<a href="#l4.1390"></a><span id="l4.1390">   &quot;_core&quot;,</span>
<a href="#l4.1391"></a><span id="l4.1391">   &quot;-&quot;,</span>
<a href="#l4.1392"></a><span id="l4.1392">   &quot;^lang&quot;,</span>
<a href="#l4.1393"></a><span id="l4.1393">   &quot;dir&quot;,</span>
<a href="#l4.1394"></a><span id="l4.1394"> ];</span>
<a href="#l4.1395"></a><span id="l4.1395"> </span>
<a href="#l4.1396"></a><span id="l4.1396" class="difflineminus">-gHTMLAttr.samp =</span>
<a href="#l4.1397"></a><span id="l4.1397" class="difflineminus">-[</span>
<a href="#l4.1398"></a><span id="l4.1398" class="difflineplus">+gHTMLAttr.samp = [</span>
<a href="#l4.1399"></a><span id="l4.1399">   &quot;_core&quot;,</span>
<a href="#l4.1400"></a><span id="l4.1400">   &quot;-&quot;,</span>
<a href="#l4.1401"></a><span id="l4.1401">   &quot;^lang&quot;,</span>
<a href="#l4.1402"></a><span id="l4.1402">   &quot;dir&quot;,</span>
<a href="#l4.1403"></a><span id="l4.1403"> ];</span>
<a href="#l4.1404"></a><span id="l4.1404"> </span>
<a href="#l4.1405"></a><span id="l4.1405" class="difflineminus">-gHTMLAttr.script =</span>
<a href="#l4.1406"></a><span id="l4.1406" class="difflineminus">-[</span>
<a href="#l4.1407"></a><span id="l4.1407" class="difflineplus">+gHTMLAttr.script = [</span>
<a href="#l4.1408"></a><span id="l4.1408">   &quot;charset&quot;,</span>
<a href="#l4.1409"></a><span id="l4.1409">   &quot;$type&quot;,</span>
<a href="#l4.1410"></a><span id="l4.1410">   &quot;language&quot;,</span>
<a href="#l4.1411"></a><span id="l4.1411">   &quot;src&quot;,</span>
<a href="#l4.1412"></a><span id="l4.1412">   &quot;defer&quot;,</span>
<a href="#l4.1413"></a><span id="l4.1413"> ];</span>
<a href="#l4.1414"></a><span id="l4.1414"> </span>
<a href="#l4.1415"></a><span id="l4.1415" class="difflineminus">-gHTMLAttr.script_defer =</span>
<a href="#l4.1416"></a><span id="l4.1416" class="difflineminus">-[</span>
<a href="#l4.1417"></a><span id="l4.1417" class="difflineplus">+gHTMLAttr.script_defer = [</span>
<a href="#l4.1418"></a><span id="l4.1418">   &quot;defer&quot;,</span>
<a href="#l4.1419"></a><span id="l4.1419"> ];</span>
<a href="#l4.1420"></a><span id="l4.1420"> </span>
<a href="#l4.1421"></a><span id="l4.1421"> </span>
<a href="#l4.1422"></a><span id="l4.1422" class="difflineminus">-gHTMLAttr.select =</span>
<a href="#l4.1423"></a><span id="l4.1423" class="difflineminus">-[</span>
<a href="#l4.1424"></a><span id="l4.1424" class="difflineplus">+gHTMLAttr.select = [</span>
<a href="#l4.1425"></a><span id="l4.1425">   &quot;name&quot;,</span>
<a href="#l4.1426"></a><span id="l4.1426">   &quot;#size&quot;,</span>
<a href="#l4.1427"></a><span id="l4.1427">   &quot;multiple&quot;,</span>
<a href="#l4.1428"></a><span id="l4.1428">   &quot;disabled&quot;,</span>
<a href="#l4.1429"></a><span id="l4.1429">   &quot;#tabindex&quot;,</span>
<a href="#l4.1430"></a><span id="l4.1430">   &quot;-&quot;,</span>
<a href="#l4.1431"></a><span id="l4.1431">   &quot;_core&quot;,</span>
<a href="#l4.1432"></a><span id="l4.1432">   &quot;-&quot;,</span>
<a href="#l4.1433"></a><span id="l4.1433">   &quot;^lang&quot;,</span>
<a href="#l4.1434"></a><span id="l4.1434">   &quot;dir&quot;,</span>
<a href="#l4.1435"></a><span id="l4.1435"> ];</span>
<a href="#l4.1436"></a><span id="l4.1436"> </span>
<a href="#l4.1437"></a><span id="l4.1437" class="difflineminus">-gHTMLAttr.select_multiple =</span>
<a href="#l4.1438"></a><span id="l4.1438" class="difflineminus">-[</span>
<a href="#l4.1439"></a><span id="l4.1439" class="difflineplus">+gHTMLAttr.select_multiple = [</span>
<a href="#l4.1440"></a><span id="l4.1440">   &quot;multiple&quot;,</span>
<a href="#l4.1441"></a><span id="l4.1441"> ];</span>
<a href="#l4.1442"></a><span id="l4.1442"> </span>
<a href="#l4.1443"></a><span id="l4.1443" class="difflineminus">-gHTMLAttr.select_disabled =</span>
<a href="#l4.1444"></a><span id="l4.1444" class="difflineminus">-[</span>
<a href="#l4.1445"></a><span id="l4.1445" class="difflineplus">+gHTMLAttr.select_disabled = [</span>
<a href="#l4.1446"></a><span id="l4.1446">   &quot;disabled&quot;,</span>
<a href="#l4.1447"></a><span id="l4.1447"> ];</span>
<a href="#l4.1448"></a><span id="l4.1448"> </span>
<a href="#l4.1449"></a><span id="l4.1449" class="difflineminus">-gHTMLAttr.small =</span>
<a href="#l4.1450"></a><span id="l4.1450" class="difflineminus">-[</span>
<a href="#l4.1451"></a><span id="l4.1451" class="difflineplus">+gHTMLAttr.small = [</span>
<a href="#l4.1452"></a><span id="l4.1452">   &quot;_core&quot;,</span>
<a href="#l4.1453"></a><span id="l4.1453">   &quot;-&quot;,</span>
<a href="#l4.1454"></a><span id="l4.1454">   &quot;^lang&quot;,</span>
<a href="#l4.1455"></a><span id="l4.1455">   &quot;dir&quot;,</span>
<a href="#l4.1456"></a><span id="l4.1456"> ];</span>
<a href="#l4.1457"></a><span id="l4.1457"> </span>
<a href="#l4.1458"></a><span id="l4.1458" class="difflineminus">-gHTMLAttr.span =</span>
<a href="#l4.1459"></a><span id="l4.1459" class="difflineminus">-[</span>
<a href="#l4.1460"></a><span id="l4.1460" class="difflineplus">+gHTMLAttr.span = [</span>
<a href="#l4.1461"></a><span id="l4.1461">   &quot;_core&quot;,</span>
<a href="#l4.1462"></a><span id="l4.1462">   &quot;-&quot;,</span>
<a href="#l4.1463"></a><span id="l4.1463">   &quot;^lang&quot;,</span>
<a href="#l4.1464"></a><span id="l4.1464">   &quot;dir&quot;,</span>
<a href="#l4.1465"></a><span id="l4.1465"> ];</span>
<a href="#l4.1466"></a><span id="l4.1466"> </span>
<a href="#l4.1467"></a><span id="l4.1467" class="difflineminus">-gHTMLAttr.strike =</span>
<a href="#l4.1468"></a><span id="l4.1468" class="difflineminus">-[</span>
<a href="#l4.1469"></a><span id="l4.1469" class="difflineplus">+gHTMLAttr.strike = [</span>
<a href="#l4.1470"></a><span id="l4.1470">   &quot;_core&quot;,</span>
<a href="#l4.1471"></a><span id="l4.1471">   &quot;-&quot;,</span>
<a href="#l4.1472"></a><span id="l4.1472">   &quot;^lang&quot;,</span>
<a href="#l4.1473"></a><span id="l4.1473">   &quot;dir&quot;,</span>
<a href="#l4.1474"></a><span id="l4.1474"> ];</span>
<a href="#l4.1475"></a><span id="l4.1475"> </span>
<a href="#l4.1476"></a><span id="l4.1476" class="difflineminus">-gHTMLAttr.strong =</span>
<a href="#l4.1477"></a><span id="l4.1477" class="difflineminus">-[</span>
<a href="#l4.1478"></a><span id="l4.1478" class="difflineplus">+gHTMLAttr.strong = [</span>
<a href="#l4.1479"></a><span id="l4.1479">   &quot;_core&quot;,</span>
<a href="#l4.1480"></a><span id="l4.1480">   &quot;-&quot;,</span>
<a href="#l4.1481"></a><span id="l4.1481">   &quot;^lang&quot;,</span>
<a href="#l4.1482"></a><span id="l4.1482">   &quot;dir&quot;,</span>
<a href="#l4.1483"></a><span id="l4.1483"> ];</span>
<a href="#l4.1484"></a><span id="l4.1484"> </span>
<a href="#l4.1485"></a><span id="l4.1485" class="difflineminus">-gHTMLAttr.style =</span>
<a href="#l4.1486"></a><span id="l4.1486" class="difflineminus">-[</span>
<a href="#l4.1487"></a><span id="l4.1487" class="difflineplus">+gHTMLAttr.style = [</span>
<a href="#l4.1488"></a><span id="l4.1488">   &quot;$type&quot;,</span>
<a href="#l4.1489"></a><span id="l4.1489">   &quot;media&quot;,</span>
<a href="#l4.1490"></a><span id="l4.1490">   &quot;title&quot;,</span>
<a href="#l4.1491"></a><span id="l4.1491">   &quot;-&quot;,</span>
<a href="#l4.1492"></a><span id="l4.1492">   &quot;^lang&quot;,</span>
<a href="#l4.1493"></a><span id="l4.1493">   &quot;dir&quot;,</span>
<a href="#l4.1494"></a><span id="l4.1494"> ];</span>
<a href="#l4.1495"></a><span id="l4.1495"> </span>
<a href="#l4.1496"></a><span id="l4.1496" class="difflineminus">-gHTMLAttr.sub =</span>
<a href="#l4.1497"></a><span id="l4.1497" class="difflineminus">-[</span>
<a href="#l4.1498"></a><span id="l4.1498" class="difflineplus">+gHTMLAttr.sub = [</span>
<a href="#l4.1499"></a><span id="l4.1499">   &quot;_core&quot;,</span>
<a href="#l4.1500"></a><span id="l4.1500">   &quot;-&quot;,</span>
<a href="#l4.1501"></a><span id="l4.1501">   &quot;^lang&quot;,</span>
<a href="#l4.1502"></a><span id="l4.1502">   &quot;dir&quot;,</span>
<a href="#l4.1503"></a><span id="l4.1503"> ];</span>
<a href="#l4.1504"></a><span id="l4.1504"> </span>
<a href="#l4.1505"></a><span id="l4.1505" class="difflineminus">-gHTMLAttr.sup =</span>
<a href="#l4.1506"></a><span id="l4.1506" class="difflineminus">-[</span>
<a href="#l4.1507"></a><span id="l4.1507" class="difflineplus">+gHTMLAttr.sup = [</span>
<a href="#l4.1508"></a><span id="l4.1508">   &quot;_core&quot;,</span>
<a href="#l4.1509"></a><span id="l4.1509">   &quot;-&quot;,</span>
<a href="#l4.1510"></a><span id="l4.1510">   &quot;^lang&quot;,</span>
<a href="#l4.1511"></a><span id="l4.1511">   &quot;dir&quot;,</span>
<a href="#l4.1512"></a><span id="l4.1512"> ];</span>
<a href="#l4.1513"></a><span id="l4.1513"> </span>
<a href="#l4.1514"></a><span id="l4.1514" class="difflineminus">-gHTMLAttr.table =</span>
<a href="#l4.1515"></a><span id="l4.1515" class="difflineminus">-[</span>
<a href="#l4.1516"></a><span id="l4.1516" class="difflineplus">+gHTMLAttr.table = [</span>
<a href="#l4.1517"></a><span id="l4.1517">   &quot;summary&quot;,</span>
<a href="#l4.1518"></a><span id="l4.1518">   &quot;%width&quot;,</span>
<a href="#l4.1519"></a><span id="l4.1519">   &quot;#border&quot;,</span>
<a href="#l4.1520"></a><span id="l4.1520">   &quot;frame&quot;,</span>
<a href="#l4.1521"></a><span id="l4.1521">   &quot;rules&quot;,</span>
<a href="#l4.1522"></a><span id="l4.1522">   &quot;#cellspacing&quot;,</span>
<a href="#l4.1523"></a><span id="l4.1523">   &quot;#cellpadding&quot;,</span>
<a href="#l4.1524"></a><span id="l4.1524">   &quot;align&quot;,</span>
<a href="#l4.1525"></a><span id="l4.1525">   &quot;bgcolor&quot;,</span>
<a href="#l4.1526"></a><span id="l4.1526">   &quot;-&quot;,</span>
<a href="#l4.1527"></a><span id="l4.1527">   &quot;_core&quot;,</span>
<a href="#l4.1528"></a><span id="l4.1528">   &quot;-&quot;,</span>
<a href="#l4.1529"></a><span id="l4.1529">   &quot;^lang&quot;,</span>
<a href="#l4.1530"></a><span id="l4.1530">   &quot;dir&quot;,</span>
<a href="#l4.1531"></a><span id="l4.1531"> ];</span>
<a href="#l4.1532"></a><span id="l4.1532"> </span>
<a href="#l4.1533"></a><span id="l4.1533" class="difflineminus">-gHTMLAttr.table_frame =</span>
<a href="#l4.1534"></a><span id="l4.1534" class="difflineminus">-[</span>
<a href="#l4.1535"></a><span id="l4.1535" class="difflineplus">+gHTMLAttr.table_frame = [</span>
<a href="#l4.1536"></a><span id="l4.1536">   &quot;void&quot;,</span>
<a href="#l4.1537"></a><span id="l4.1537">   &quot;above&quot;,</span>
<a href="#l4.1538"></a><span id="l4.1538">   &quot;below&quot;,</span>
<a href="#l4.1539"></a><span id="l4.1539">   &quot;hsides&quot;,</span>
<a href="#l4.1540"></a><span id="l4.1540">   &quot;lhs&quot;,</span>
<a href="#l4.1541"></a><span id="l4.1541">   &quot;rhs&quot;,</span>
<a href="#l4.1542"></a><span id="l4.1542">   &quot;vsides&quot;,</span>
<a href="#l4.1543"></a><span id="l4.1543">   &quot;box&quot;,</span>
<a href="#l4.1544"></a><span id="l4.1544">   &quot;border&quot;,</span>
<a href="#l4.1545"></a><span id="l4.1545"> ];</span>
<a href="#l4.1546"></a><span id="l4.1546"> </span>
<a href="#l4.1547"></a><span id="l4.1547" class="difflineminus">-gHTMLAttr.table_rules =</span>
<a href="#l4.1548"></a><span id="l4.1548" class="difflineminus">-[</span>
<a href="#l4.1549"></a><span id="l4.1549" class="difflineplus">+gHTMLAttr.table_rules = [</span>
<a href="#l4.1550"></a><span id="l4.1550">   &quot;none&quot;,</span>
<a href="#l4.1551"></a><span id="l4.1551">   &quot;groups&quot;,</span>
<a href="#l4.1552"></a><span id="l4.1552">   &quot;rows&quot;,</span>
<a href="#l4.1553"></a><span id="l4.1553">   &quot;cols&quot;,</span>
<a href="#l4.1554"></a><span id="l4.1554">   &quot;all&quot;,</span>
<a href="#l4.1555"></a><span id="l4.1555"> ];</span>
<a href="#l4.1556"></a><span id="l4.1556"> </span>
<a href="#l4.1557"></a><span id="l4.1557"> // Note; This is alignment of the table,</span>
<a href="#l4.1558"></a><span id="l4.1558"> //  not table contents, like all other table child elements</span>
<a href="#l4.1559"></a><span id="l4.1559"> gHTMLAttr.table_align = gHAlign;</span>
<a href="#l4.1560"></a><span id="l4.1560"> </span>
<a href="#l4.1561"></a><span id="l4.1561"> gHTMLAttr.table_bgcolor = gHTMLColors;</span>
<a href="#l4.1562"></a><span id="l4.1562"> </span>
<a href="#l4.1563"></a><span id="l4.1563" class="difflineminus">-gHTMLAttr.tbody =</span>
<a href="#l4.1564"></a><span id="l4.1564" class="difflineminus">-[</span>
<a href="#l4.1565"></a><span id="l4.1565" class="difflineplus">+gHTMLAttr.tbody = [</span>
<a href="#l4.1566"></a><span id="l4.1566">   &quot;align&quot;,</span>
<a href="#l4.1567"></a><span id="l4.1567">   &quot;!char&quot;,</span>
<a href="#l4.1568"></a><span id="l4.1568">   &quot;#charoff&quot;,</span>
<a href="#l4.1569"></a><span id="l4.1569">   &quot;valign&quot;,</span>
<a href="#l4.1570"></a><span id="l4.1570">   &quot;-&quot;,</span>
<a href="#l4.1571"></a><span id="l4.1571">   &quot;_core&quot;,</span>
<a href="#l4.1572"></a><span id="l4.1572">   &quot;-&quot;,</span>
<a href="#l4.1573"></a><span id="l4.1573">   &quot;^lang&quot;,</span>
<a href="#l4.1574"></a><span id="l4.1574">   &quot;dir&quot;,</span>
<a href="#l4.1575"></a><span id="l4.1575"> ];</span>
<a href="#l4.1576"></a><span id="l4.1576"> </span>
<a href="#l4.1577"></a><span id="l4.1577"> gHTMLAttr.tbody_align = gHAlignTableContent;</span>
<a href="#l4.1578"></a><span id="l4.1578"> </span>
<a href="#l4.1579"></a><span id="l4.1579"> gHTMLAttr.tbody_valign = gVAlignTable;</span>
<a href="#l4.1580"></a><span id="l4.1580"> </span>
<a href="#l4.1581"></a><span id="l4.1581" class="difflineminus">-gHTMLAttr.td =</span>
<a href="#l4.1582"></a><span id="l4.1582" class="difflineminus">-[</span>
<a href="#l4.1583"></a><span id="l4.1583" class="difflineplus">+gHTMLAttr.td = [</span>
<a href="#l4.1584"></a><span id="l4.1584">   &quot;abbr&quot;,</span>
<a href="#l4.1585"></a><span id="l4.1585">   &quot;axis&quot;,</span>
<a href="#l4.1586"></a><span id="l4.1586">   &quot;headers&quot;,</span>
<a href="#l4.1587"></a><span id="l4.1587">   &quot;scope&quot;,</span>
<a href="#l4.1588"></a><span id="l4.1588">   &quot;$#rowspan&quot;,</span>
<a href="#l4.1589"></a><span id="l4.1589">   &quot;$#colspan&quot;,</span>
<a href="#l4.1590"></a><span id="l4.1590">   &quot;align&quot;,</span>
<a href="#l4.1591"></a><span id="l4.1591">   &quot;!char&quot;,</span>
<a href="#l4.1592"></a><span id="l4.1592" class="difflineat">@@ -1496,91 +1354,82 @@ gHTMLAttr.td =</span>
<a href="#l4.1593"></a><span id="l4.1593">   &quot;%height&quot;,</span>
<a href="#l4.1594"></a><span id="l4.1594">   &quot;-&quot;,</span>
<a href="#l4.1595"></a><span id="l4.1595">   &quot;_core&quot;,</span>
<a href="#l4.1596"></a><span id="l4.1596">   &quot;-&quot;,</span>
<a href="#l4.1597"></a><span id="l4.1597">   &quot;^lang&quot;,</span>
<a href="#l4.1598"></a><span id="l4.1598">   &quot;dir&quot;,</span>
<a href="#l4.1599"></a><span id="l4.1599"> ];</span>
<a href="#l4.1600"></a><span id="l4.1600"> </span>
<a href="#l4.1601"></a><span id="l4.1601" class="difflineminus">-gHTMLAttr.td_scope =</span>
<a href="#l4.1602"></a><span id="l4.1602" class="difflineminus">-[</span>
<a href="#l4.1603"></a><span id="l4.1603" class="difflineplus">+gHTMLAttr.td_scope = [</span>
<a href="#l4.1604"></a><span id="l4.1604">   &quot;row&quot;,</span>
<a href="#l4.1605"></a><span id="l4.1605">   &quot;col&quot;,</span>
<a href="#l4.1606"></a><span id="l4.1606">   &quot;rowgroup&quot;,</span>
<a href="#l4.1607"></a><span id="l4.1607">   &quot;colgroup&quot;,</span>
<a href="#l4.1608"></a><span id="l4.1608"> ];</span>
<a href="#l4.1609"></a><span id="l4.1609"> </span>
<a href="#l4.1610"></a><span id="l4.1610" class="difflineminus">-gHTMLAttr.td_rowspan =</span>
<a href="#l4.1611"></a><span id="l4.1611" class="difflineminus">-[</span>
<a href="#l4.1612"></a><span id="l4.1612" class="difflineplus">+gHTMLAttr.td_rowspan = [</span>
<a href="#l4.1613"></a><span id="l4.1613">   &quot;1&quot;, // default</span>
<a href="#l4.1614"></a><span id="l4.1614"> ];</span>
<a href="#l4.1615"></a><span id="l4.1615"> </span>
<a href="#l4.1616"></a><span id="l4.1616" class="difflineminus">-gHTMLAttr.td_colspan =</span>
<a href="#l4.1617"></a><span id="l4.1617" class="difflineminus">-[</span>
<a href="#l4.1618"></a><span id="l4.1618" class="difflineplus">+gHTMLAttr.td_colspan = [</span>
<a href="#l4.1619"></a><span id="l4.1619">   &quot;1&quot;, // default</span>
<a href="#l4.1620"></a><span id="l4.1620"> ];</span>
<a href="#l4.1621"></a><span id="l4.1621"> </span>
<a href="#l4.1622"></a><span id="l4.1622"> gHTMLAttr.td_align = gHAlignTableContent;</span>
<a href="#l4.1623"></a><span id="l4.1623"> </span>
<a href="#l4.1624"></a><span id="l4.1624"> gHTMLAttr.td_valign = gVAlignTable;</span>
<a href="#l4.1625"></a><span id="l4.1625"> </span>
<a href="#l4.1626"></a><span id="l4.1626" class="difflineminus">-gHTMLAttr.td_nowrap =</span>
<a href="#l4.1627"></a><span id="l4.1627" class="difflineminus">-[</span>
<a href="#l4.1628"></a><span id="l4.1628" class="difflineplus">+gHTMLAttr.td_nowrap = [</span>
<a href="#l4.1629"></a><span id="l4.1629">   &quot;nowrap&quot;,</span>
<a href="#l4.1630"></a><span id="l4.1630"> ];</span>
<a href="#l4.1631"></a><span id="l4.1631"> </span>
<a href="#l4.1632"></a><span id="l4.1632"> gHTMLAttr.td_bgcolor = gHTMLColors;</span>
<a href="#l4.1633"></a><span id="l4.1633"> </span>
<a href="#l4.1634"></a><span id="l4.1634" class="difflineminus">-gHTMLAttr.textarea =</span>
<a href="#l4.1635"></a><span id="l4.1635" class="difflineminus">-[</span>
<a href="#l4.1636"></a><span id="l4.1636" class="difflineplus">+gHTMLAttr.textarea = [</span>
<a href="#l4.1637"></a><span id="l4.1637">   &quot;name&quot;,</span>
<a href="#l4.1638"></a><span id="l4.1638">   &quot;$#rows&quot;,</span>
<a href="#l4.1639"></a><span id="l4.1639">   &quot;$#cols&quot;,</span>
<a href="#l4.1640"></a><span id="l4.1640">   &quot;disabled&quot;,</span>
<a href="#l4.1641"></a><span id="l4.1641">   &quot;readonly&quot;,</span>
<a href="#l4.1642"></a><span id="l4.1642">   &quot;#tabindex&quot;,</span>
<a href="#l4.1643"></a><span id="l4.1643">   &quot;!accesskey&quot;,</span>
<a href="#l4.1644"></a><span id="l4.1644">   &quot;-&quot;,</span>
<a href="#l4.1645"></a><span id="l4.1645">   &quot;_core&quot;,</span>
<a href="#l4.1646"></a><span id="l4.1646">   &quot;-&quot;,</span>
<a href="#l4.1647"></a><span id="l4.1647">   &quot;^lang&quot;,</span>
<a href="#l4.1648"></a><span id="l4.1648">   &quot;dir&quot;,</span>
<a href="#l4.1649"></a><span id="l4.1649"> ];</span>
<a href="#l4.1650"></a><span id="l4.1650"> </span>
<a href="#l4.1651"></a><span id="l4.1651" class="difflineminus">-gHTMLAttr.textarea_disabled =</span>
<a href="#l4.1652"></a><span id="l4.1652" class="difflineminus">-[</span>
<a href="#l4.1653"></a><span id="l4.1653" class="difflineplus">+gHTMLAttr.textarea_disabled = [</span>
<a href="#l4.1654"></a><span id="l4.1654">   &quot;disabled&quot;,</span>
<a href="#l4.1655"></a><span id="l4.1655"> ];</span>
<a href="#l4.1656"></a><span id="l4.1656"> </span>
<a href="#l4.1657"></a><span id="l4.1657" class="difflineminus">-gHTMLAttr.textarea_readonly =</span>
<a href="#l4.1658"></a><span id="l4.1658" class="difflineminus">-[</span>
<a href="#l4.1659"></a><span id="l4.1659" class="difflineplus">+gHTMLAttr.textarea_readonly = [</span>
<a href="#l4.1660"></a><span id="l4.1660">   &quot;readonly&quot;,</span>
<a href="#l4.1661"></a><span id="l4.1661"> ];</span>
<a href="#l4.1662"></a><span id="l4.1662"> </span>
<a href="#l4.1663"></a><span id="l4.1663"> </span>
<a href="#l4.1664"></a><span id="l4.1664" class="difflineminus">-gHTMLAttr.tfoot =</span>
<a href="#l4.1665"></a><span id="l4.1665" class="difflineminus">-[</span>
<a href="#l4.1666"></a><span id="l4.1666" class="difflineplus">+gHTMLAttr.tfoot = [</span>
<a href="#l4.1667"></a><span id="l4.1667">   &quot;align&quot;,</span>
<a href="#l4.1668"></a><span id="l4.1668">   &quot;!char&quot;,</span>
<a href="#l4.1669"></a><span id="l4.1669">   &quot;#charoff&quot;,</span>
<a href="#l4.1670"></a><span id="l4.1670">   &quot;valign&quot;,</span>
<a href="#l4.1671"></a><span id="l4.1671">   &quot;-&quot;,</span>
<a href="#l4.1672"></a><span id="l4.1672">   &quot;_core&quot;,</span>
<a href="#l4.1673"></a><span id="l4.1673">   &quot;-&quot;,</span>
<a href="#l4.1674"></a><span id="l4.1674">   &quot;^lang&quot;,</span>
<a href="#l4.1675"></a><span id="l4.1675">   &quot;dir&quot;,</span>
<a href="#l4.1676"></a><span id="l4.1676"> ];</span>
<a href="#l4.1677"></a><span id="l4.1677"> </span>
<a href="#l4.1678"></a><span id="l4.1678"> gHTMLAttr.tfoot_align = gHAlignTableContent;</span>
<a href="#l4.1679"></a><span id="l4.1679"> </span>
<a href="#l4.1680"></a><span id="l4.1680"> gHTMLAttr.tfoot_valign = gVAlignTable;</span>
<a href="#l4.1681"></a><span id="l4.1681"> </span>
<a href="#l4.1682"></a><span id="l4.1682" class="difflineminus">-gHTMLAttr.th =</span>
<a href="#l4.1683"></a><span id="l4.1683" class="difflineminus">-[</span>
<a href="#l4.1684"></a><span id="l4.1684" class="difflineplus">+gHTMLAttr.th = [</span>
<a href="#l4.1685"></a><span id="l4.1685">   &quot;abbr&quot;,</span>
<a href="#l4.1686"></a><span id="l4.1686">   &quot;axis&quot;,</span>
<a href="#l4.1687"></a><span id="l4.1687">   &quot;headers&quot;,</span>
<a href="#l4.1688"></a><span id="l4.1688">   &quot;scope&quot;,</span>
<a href="#l4.1689"></a><span id="l4.1689">   &quot;$#rowspan&quot;,</span>
<a href="#l4.1690"></a><span id="l4.1690">   &quot;$#colspan&quot;,</span>
<a href="#l4.1691"></a><span id="l4.1691">   &quot;align&quot;,</span>
<a href="#l4.1692"></a><span id="l4.1692">   &quot;!char&quot;,</span>
<a href="#l4.1693"></a><span id="l4.1693" class="difflineat">@@ -1592,70 +1441,63 @@ gHTMLAttr.th =</span>
<a href="#l4.1694"></a><span id="l4.1694">   &quot;%height&quot;,</span>
<a href="#l4.1695"></a><span id="l4.1695">   &quot;-&quot;,</span>
<a href="#l4.1696"></a><span id="l4.1696">   &quot;_core&quot;,</span>
<a href="#l4.1697"></a><span id="l4.1697">   &quot;-&quot;,</span>
<a href="#l4.1698"></a><span id="l4.1698">   &quot;^lang&quot;,</span>
<a href="#l4.1699"></a><span id="l4.1699">   &quot;dir&quot;,</span>
<a href="#l4.1700"></a><span id="l4.1700"> ];</span>
<a href="#l4.1701"></a><span id="l4.1701"> </span>
<a href="#l4.1702"></a><span id="l4.1702" class="difflineminus">-gHTMLAttr.th_scope =</span>
<a href="#l4.1703"></a><span id="l4.1703" class="difflineminus">-[</span>
<a href="#l4.1704"></a><span id="l4.1704" class="difflineplus">+gHTMLAttr.th_scope = [</span>
<a href="#l4.1705"></a><span id="l4.1705">   &quot;row&quot;,</span>
<a href="#l4.1706"></a><span id="l4.1706">   &quot;col&quot;,</span>
<a href="#l4.1707"></a><span id="l4.1707">   &quot;rowgroup&quot;,</span>
<a href="#l4.1708"></a><span id="l4.1708">   &quot;colgroup&quot;,</span>
<a href="#l4.1709"></a><span id="l4.1709"> ];</span>
<a href="#l4.1710"></a><span id="l4.1710"> </span>
<a href="#l4.1711"></a><span id="l4.1711" class="difflineminus">-gHTMLAttr.th_rowspan =</span>
<a href="#l4.1712"></a><span id="l4.1712" class="difflineminus">-[</span>
<a href="#l4.1713"></a><span id="l4.1713" class="difflineplus">+gHTMLAttr.th_rowspan = [</span>
<a href="#l4.1714"></a><span id="l4.1714">   &quot;1&quot;, // default</span>
<a href="#l4.1715"></a><span id="l4.1715"> ];</span>
<a href="#l4.1716"></a><span id="l4.1716"> </span>
<a href="#l4.1717"></a><span id="l4.1717" class="difflineminus">-gHTMLAttr.th_colspan =</span>
<a href="#l4.1718"></a><span id="l4.1718" class="difflineminus">-[</span>
<a href="#l4.1719"></a><span id="l4.1719" class="difflineplus">+gHTMLAttr.th_colspan = [</span>
<a href="#l4.1720"></a><span id="l4.1720">   &quot;1&quot;, // default</span>
<a href="#l4.1721"></a><span id="l4.1721"> ];</span>
<a href="#l4.1722"></a><span id="l4.1722"> </span>
<a href="#l4.1723"></a><span id="l4.1723"> gHTMLAttr.th_align = gHAlignTableContent;</span>
<a href="#l4.1724"></a><span id="l4.1724"> </span>
<a href="#l4.1725"></a><span id="l4.1725"> gHTMLAttr.th_valign = gVAlignTable;</span>
<a href="#l4.1726"></a><span id="l4.1726"> </span>
<a href="#l4.1727"></a><span id="l4.1727" class="difflineminus">-gHTMLAttr.th_nowrap =</span>
<a href="#l4.1728"></a><span id="l4.1728" class="difflineminus">-[</span>
<a href="#l4.1729"></a><span id="l4.1729" class="difflineplus">+gHTMLAttr.th_nowrap = [</span>
<a href="#l4.1730"></a><span id="l4.1730">   &quot;nowrap&quot;,</span>
<a href="#l4.1731"></a><span id="l4.1731"> ];</span>
<a href="#l4.1732"></a><span id="l4.1732"> </span>
<a href="#l4.1733"></a><span id="l4.1733"> gHTMLAttr.th_bgcolor = gHTMLColors;</span>
<a href="#l4.1734"></a><span id="l4.1734"> </span>
<a href="#l4.1735"></a><span id="l4.1735" class="difflineminus">-gHTMLAttr.thead =</span>
<a href="#l4.1736"></a><span id="l4.1736" class="difflineminus">-[</span>
<a href="#l4.1737"></a><span id="l4.1737" class="difflineplus">+gHTMLAttr.thead = [</span>
<a href="#l4.1738"></a><span id="l4.1738">   &quot;align&quot;,</span>
<a href="#l4.1739"></a><span id="l4.1739">   &quot;!char&quot;,</span>
<a href="#l4.1740"></a><span id="l4.1740">   &quot;#charoff&quot;,</span>
<a href="#l4.1741"></a><span id="l4.1741">   &quot;valign&quot;,</span>
<a href="#l4.1742"></a><span id="l4.1742">   &quot;-&quot;,</span>
<a href="#l4.1743"></a><span id="l4.1743">   &quot;_core&quot;,</span>
<a href="#l4.1744"></a><span id="l4.1744">   &quot;-&quot;,</span>
<a href="#l4.1745"></a><span id="l4.1745">   &quot;^lang&quot;,</span>
<a href="#l4.1746"></a><span id="l4.1746">   &quot;dir&quot;,</span>
<a href="#l4.1747"></a><span id="l4.1747"> ];</span>
<a href="#l4.1748"></a><span id="l4.1748"> </span>
<a href="#l4.1749"></a><span id="l4.1749"> gHTMLAttr.thead_align = gHAlignTableContent;</span>
<a href="#l4.1750"></a><span id="l4.1750"> </span>
<a href="#l4.1751"></a><span id="l4.1751"> gHTMLAttr.thead_valign = gVAlignTable;</span>
<a href="#l4.1752"></a><span id="l4.1752"> </span>
<a href="#l4.1753"></a><span id="l4.1753" class="difflineminus">-gHTMLAttr.title =</span>
<a href="#l4.1754"></a><span id="l4.1754" class="difflineminus">-[</span>
<a href="#l4.1755"></a><span id="l4.1755" class="difflineplus">+gHTMLAttr.title = [</span>
<a href="#l4.1756"></a><span id="l4.1756">   &quot;^lang&quot;,</span>
<a href="#l4.1757"></a><span id="l4.1757">   &quot;dir&quot;,</span>
<a href="#l4.1758"></a><span id="l4.1758"> ];</span>
<a href="#l4.1759"></a><span id="l4.1759"> </span>
<a href="#l4.1760"></a><span id="l4.1760" class="difflineminus">-gHTMLAttr.tr =</span>
<a href="#l4.1761"></a><span id="l4.1761" class="difflineminus">-[</span>
<a href="#l4.1762"></a><span id="l4.1762" class="difflineplus">+gHTMLAttr.tr = [</span>
<a href="#l4.1763"></a><span id="l4.1763">   &quot;align&quot;,</span>
<a href="#l4.1764"></a><span id="l4.1764">   &quot;!char&quot;,</span>
<a href="#l4.1765"></a><span id="l4.1765">   &quot;#charoff&quot;,</span>
<a href="#l4.1766"></a><span id="l4.1766">   &quot;valign&quot;,</span>
<a href="#l4.1767"></a><span id="l4.1767">   &quot;bgcolor&quot;,</span>
<a href="#l4.1768"></a><span id="l4.1768">   &quot;-&quot;,</span>
<a href="#l4.1769"></a><span id="l4.1769">   &quot;_core&quot;,</span>
<a href="#l4.1770"></a><span id="l4.1770">   &quot;-&quot;,</span>
<a href="#l4.1771"></a><span id="l4.1771" class="difflineat">@@ -1664,148 +1506,128 @@ gHTMLAttr.tr =</span>
<a href="#l4.1772"></a><span id="l4.1772"> ];</span>
<a href="#l4.1773"></a><span id="l4.1773"> </span>
<a href="#l4.1774"></a><span id="l4.1774"> gHTMLAttr.tr_align = gHAlignTableContent;</span>
<a href="#l4.1775"></a><span id="l4.1775"> </span>
<a href="#l4.1776"></a><span id="l4.1776"> gHTMLAttr.tr_valign = gVAlignTable;</span>
<a href="#l4.1777"></a><span id="l4.1777"> </span>
<a href="#l4.1778"></a><span id="l4.1778"> gHTMLAttr.tr_bgcolor = gHTMLColors;</span>
<a href="#l4.1779"></a><span id="l4.1779"> </span>
<a href="#l4.1780"></a><span id="l4.1780" class="difflineminus">-gHTMLAttr.tt =</span>
<a href="#l4.1781"></a><span id="l4.1781" class="difflineminus">-[</span>
<a href="#l4.1782"></a><span id="l4.1782" class="difflineplus">+gHTMLAttr.tt = [</span>
<a href="#l4.1783"></a><span id="l4.1783">   &quot;_core&quot;,</span>
<a href="#l4.1784"></a><span id="l4.1784">   &quot;-&quot;,</span>
<a href="#l4.1785"></a><span id="l4.1785">   &quot;^lang&quot;,</span>
<a href="#l4.1786"></a><span id="l4.1786">   &quot;dir&quot;,</span>
<a href="#l4.1787"></a><span id="l4.1787"> ];</span>
<a href="#l4.1788"></a><span id="l4.1788"> </span>
<a href="#l4.1789"></a><span id="l4.1789" class="difflineminus">-gHTMLAttr.u =</span>
<a href="#l4.1790"></a><span id="l4.1790" class="difflineminus">-[</span>
<a href="#l4.1791"></a><span id="l4.1791" class="difflineplus">+gHTMLAttr.u = [</span>
<a href="#l4.1792"></a><span id="l4.1792">   &quot;_core&quot;,</span>
<a href="#l4.1793"></a><span id="l4.1793">   &quot;-&quot;,</span>
<a href="#l4.1794"></a><span id="l4.1794">   &quot;^lang&quot;,</span>
<a href="#l4.1795"></a><span id="l4.1795">   &quot;dir&quot;,</span>
<a href="#l4.1796"></a><span id="l4.1796"> ];</span>
<a href="#l4.1797"></a><span id="l4.1797" class="difflineminus">-gHTMLAttr.ul =</span>
<a href="#l4.1798"></a><span id="l4.1798" class="difflineminus">-[</span>
<a href="#l4.1799"></a><span id="l4.1799" class="difflineplus">+gHTMLAttr.ul = [</span>
<a href="#l4.1800"></a><span id="l4.1800">   &quot;type&quot;,</span>
<a href="#l4.1801"></a><span id="l4.1801">   &quot;compact&quot;,</span>
<a href="#l4.1802"></a><span id="l4.1802">   &quot;-&quot;,</span>
<a href="#l4.1803"></a><span id="l4.1803">   &quot;_core&quot;,</span>
<a href="#l4.1804"></a><span id="l4.1804">   &quot;-&quot;,</span>
<a href="#l4.1805"></a><span id="l4.1805">   &quot;^lang&quot;,</span>
<a href="#l4.1806"></a><span id="l4.1806">   &quot;dir&quot;,</span>
<a href="#l4.1807"></a><span id="l4.1807"> ];</span>
<a href="#l4.1808"></a><span id="l4.1808"> </span>
<a href="#l4.1809"></a><span id="l4.1809" class="difflineminus">-gHTMLAttr.ul_type =</span>
<a href="#l4.1810"></a><span id="l4.1810" class="difflineminus">-[</span>
<a href="#l4.1811"></a><span id="l4.1811" class="difflineplus">+gHTMLAttr.ul_type = [</span>
<a href="#l4.1812"></a><span id="l4.1812">   &quot;disc&quot;,</span>
<a href="#l4.1813"></a><span id="l4.1813">   &quot;square&quot;,</span>
<a href="#l4.1814"></a><span id="l4.1814">   &quot;circle&quot;,</span>
<a href="#l4.1815"></a><span id="l4.1815"> ];</span>
<a href="#l4.1816"></a><span id="l4.1816"> </span>
<a href="#l4.1817"></a><span id="l4.1817" class="difflineminus">-gHTMLAttr.ul_compact =</span>
<a href="#l4.1818"></a><span id="l4.1818" class="difflineminus">-[</span>
<a href="#l4.1819"></a><span id="l4.1819" class="difflineplus">+gHTMLAttr.ul_compact = [</span>
<a href="#l4.1820"></a><span id="l4.1820">   &quot;compact&quot;,</span>
<a href="#l4.1821"></a><span id="l4.1821"> ];</span>
<a href="#l4.1822"></a><span id="l4.1822"> </span>
<a href="#l4.1823"></a><span id="l4.1823"> </span>
<a href="#l4.1824"></a><span id="l4.1824"> // Prefix with &quot;_&quot; since this is reserved (it's stripped out)</span>
<a href="#l4.1825"></a><span id="l4.1825" class="difflineminus">-gHTMLAttr._var =</span>
<a href="#l4.1826"></a><span id="l4.1826" class="difflineminus">-[</span>
<a href="#l4.1827"></a><span id="l4.1827" class="difflineplus">+gHTMLAttr._var = [</span>
<a href="#l4.1828"></a><span id="l4.1828">   &quot;_core&quot;,</span>
<a href="#l4.1829"></a><span id="l4.1829">   &quot;-&quot;,</span>
<a href="#l4.1830"></a><span id="l4.1830">   &quot;^lang&quot;,</span>
<a href="#l4.1831"></a><span id="l4.1831">   &quot;dir&quot;,</span>
<a href="#l4.1832"></a><span id="l4.1832"> ];</span>
<a href="#l4.1833"></a><span id="l4.1833"> </span>
<a href="#l4.1834"></a><span id="l4.1834"> // ================ JS Attributes ================ //</span>
<a href="#l4.1835"></a><span id="l4.1835"> // These are element specific even handlers.</span>
<a href="#l4.1836"></a><span id="l4.1836"> /* Most all elements use gCoreJSEvents, so those</span>
<a href="#l4.1837"></a><span id="l4.1837">    are assumed except for those listed here with &quot;noEvents&quot;</span>
<a href="#l4.1838"></a><span id="l4.1838"> */</span>
<a href="#l4.1839"></a><span id="l4.1839"> </span>
<a href="#l4.1840"></a><span id="l4.1840" class="difflineminus">-gJSAttr.a =</span>
<a href="#l4.1841"></a><span id="l4.1841" class="difflineminus">-[</span>
<a href="#l4.1842"></a><span id="l4.1842" class="difflineplus">+gJSAttr.a = [</span>
<a href="#l4.1843"></a><span id="l4.1843">   &quot;onfocus&quot;,</span>
<a href="#l4.1844"></a><span id="l4.1844">   &quot;onblur&quot;,</span>
<a href="#l4.1845"></a><span id="l4.1845"> ];</span>
<a href="#l4.1846"></a><span id="l4.1846"> </span>
<a href="#l4.1847"></a><span id="l4.1847" class="difflineminus">-gJSAttr.area =</span>
<a href="#l4.1848"></a><span id="l4.1848" class="difflineminus">-[</span>
<a href="#l4.1849"></a><span id="l4.1849" class="difflineplus">+gJSAttr.area = [</span>
<a href="#l4.1850"></a><span id="l4.1850">   &quot;onfocus&quot;,</span>
<a href="#l4.1851"></a><span id="l4.1851">   &quot;onblur&quot;,</span>
<a href="#l4.1852"></a><span id="l4.1852"> ];</span>
<a href="#l4.1853"></a><span id="l4.1853"> </span>
<a href="#l4.1854"></a><span id="l4.1854" class="difflineminus">-gJSAttr.body =</span>
<a href="#l4.1855"></a><span id="l4.1855" class="difflineminus">-[</span>
<a href="#l4.1856"></a><span id="l4.1856" class="difflineplus">+gJSAttr.body = [</span>
<a href="#l4.1857"></a><span id="l4.1857">   &quot;onload&quot;,</span>
<a href="#l4.1858"></a><span id="l4.1858">   &quot;onupload&quot;,</span>
<a href="#l4.1859"></a><span id="l4.1859"> ];</span>
<a href="#l4.1860"></a><span id="l4.1860"> </span>
<a href="#l4.1861"></a><span id="l4.1861" class="difflineminus">-gJSAttr.button =</span>
<a href="#l4.1862"></a><span id="l4.1862" class="difflineminus">-[</span>
<a href="#l4.1863"></a><span id="l4.1863" class="difflineplus">+gJSAttr.button = [</span>
<a href="#l4.1864"></a><span id="l4.1864">   &quot;onfocus&quot;,</span>
<a href="#l4.1865"></a><span id="l4.1865">   &quot;onblur&quot;,</span>
<a href="#l4.1866"></a><span id="l4.1866"> ];</span>
<a href="#l4.1867"></a><span id="l4.1867"> </span>
<a href="#l4.1868"></a><span id="l4.1868" class="difflineminus">-gJSAttr.form =</span>
<a href="#l4.1869"></a><span id="l4.1869" class="difflineminus">-[</span>
<a href="#l4.1870"></a><span id="l4.1870" class="difflineplus">+gJSAttr.form = [</span>
<a href="#l4.1871"></a><span id="l4.1871">   &quot;onsubmit&quot;,</span>
<a href="#l4.1872"></a><span id="l4.1872">   &quot;onreset&quot;,</span>
<a href="#l4.1873"></a><span id="l4.1873"> ];</span>
<a href="#l4.1874"></a><span id="l4.1874"> </span>
<a href="#l4.1875"></a><span id="l4.1875" class="difflineminus">-gJSAttr.frameset =</span>
<a href="#l4.1876"></a><span id="l4.1876" class="difflineminus">-[</span>
<a href="#l4.1877"></a><span id="l4.1877" class="difflineplus">+gJSAttr.frameset = [</span>
<a href="#l4.1878"></a><span id="l4.1878">   &quot;onload&quot;,</span>
<a href="#l4.1879"></a><span id="l4.1879">   &quot;onunload&quot;,</span>
<a href="#l4.1880"></a><span id="l4.1880"> ];</span>
<a href="#l4.1881"></a><span id="l4.1881"> </span>
<a href="#l4.1882"></a><span id="l4.1882" class="difflineminus">-gJSAttr.input =</span>
<a href="#l4.1883"></a><span id="l4.1883" class="difflineminus">-[</span>
<a href="#l4.1884"></a><span id="l4.1884" class="difflineplus">+gJSAttr.input = [</span>
<a href="#l4.1885"></a><span id="l4.1885">   &quot;onfocus&quot;,</span>
<a href="#l4.1886"></a><span id="l4.1886">   &quot;onblur&quot;,</span>
<a href="#l4.1887"></a><span id="l4.1887">   &quot;onselect&quot;,</span>
<a href="#l4.1888"></a><span id="l4.1888">   &quot;onchange&quot;,</span>
<a href="#l4.1889"></a><span id="l4.1889"> ];</span>
<a href="#l4.1890"></a><span id="l4.1890"> </span>
<a href="#l4.1891"></a><span id="l4.1891" class="difflineminus">-gJSAttr.label =</span>
<a href="#l4.1892"></a><span id="l4.1892" class="difflineminus">-[</span>
<a href="#l4.1893"></a><span id="l4.1893" class="difflineplus">+gJSAttr.label = [</span>
<a href="#l4.1894"></a><span id="l4.1894">   &quot;onfocus&quot;,</span>
<a href="#l4.1895"></a><span id="l4.1895">   &quot;onblur&quot;,</span>
<a href="#l4.1896"></a><span id="l4.1896"> ];</span>
<a href="#l4.1897"></a><span id="l4.1897"> </span>
<a href="#l4.1898"></a><span id="l4.1898" class="difflineminus">-gJSAttr.select =</span>
<a href="#l4.1899"></a><span id="l4.1899" class="difflineminus">-[</span>
<a href="#l4.1900"></a><span id="l4.1900" class="difflineplus">+gJSAttr.select = [</span>
<a href="#l4.1901"></a><span id="l4.1901">   &quot;onfocus&quot;,</span>
<a href="#l4.1902"></a><span id="l4.1902">   &quot;onblur&quot;,</span>
<a href="#l4.1903"></a><span id="l4.1903">   &quot;onchange&quot;,</span>
<a href="#l4.1904"></a><span id="l4.1904"> ];</span>
<a href="#l4.1905"></a><span id="l4.1905"> </span>
<a href="#l4.1906"></a><span id="l4.1906" class="difflineminus">-gJSAttr.textarea =</span>
<a href="#l4.1907"></a><span id="l4.1907" class="difflineminus">-[</span>
<a href="#l4.1908"></a><span id="l4.1908" class="difflineplus">+gJSAttr.textarea = [</span>
<a href="#l4.1909"></a><span id="l4.1909">   &quot;onfocus&quot;,</span>
<a href="#l4.1910"></a><span id="l4.1910">   &quot;onblur&quot;,</span>
<a href="#l4.1911"></a><span id="l4.1911">   &quot;onselect&quot;,</span>
<a href="#l4.1912"></a><span id="l4.1912">   &quot;onchange&quot;,</span>
<a href="#l4.1913"></a><span id="l4.1913"> ];</span>
<a href="#l4.1914"></a><span id="l4.1914"> </span>
<a href="#l4.1915"></a><span id="l4.1915"> // Elements that don't have JSEvents:</span>
<a href="#l4.1916"></a><span id="l4.1916" class="difflineminus">-gJSAttr.font =</span>
<a href="#l4.1917"></a><span id="l4.1917" class="difflineminus">-[</span>
<a href="#l4.1918"></a><span id="l4.1918" class="difflineplus">+gJSAttr.font = [</span>
<a href="#l4.1919"></a><span id="l4.1919">   &quot;noJSEvents&quot;,</span>
<a href="#l4.1920"></a><span id="l4.1920"> ];</span>
<a href="#l4.1921"></a><span id="l4.1921"> </span>
<a href="#l4.1922"></a><span id="l4.1922" class="difflineminus">-gJSAttr.applet =</span>
<a href="#l4.1923"></a><span id="l4.1923" class="difflineminus">-[</span>
<a href="#l4.1924"></a><span id="l4.1924" class="difflineplus">+gJSAttr.applet = [</span>
<a href="#l4.1925"></a><span id="l4.1925">   &quot;noJSEvents&quot;,</span>
<a href="#l4.1926"></a><span id="l4.1926"> ];</span>
<a href="#l4.1927"></a><span id="l4.1927"> </span>
<a href="#l4.1928"></a><span id="l4.1928" class="difflineminus">-gJSAttr.isindex =</span>
<a href="#l4.1929"></a><span id="l4.1929" class="difflineminus">-[</span>
<a href="#l4.1930"></a><span id="l4.1930" class="difflineplus">+gJSAttr.isindex = [</span>
<a href="#l4.1931"></a><span id="l4.1931">   &quot;noJSEvents&quot;,</span>
<a href="#l4.1932"></a><span id="l4.1932"> ];</span>
<a href="#l4.1933"></a><span id="l4.1933"> </span>
<a href="#l4.1934"></a><span id="l4.1934" class="difflineminus">-gJSAttr.iframe =</span>
<a href="#l4.1935"></a><span id="l4.1935" class="difflineminus">-[</span>
<a href="#l4.1936"></a><span id="l4.1936" class="difflineplus">+gJSAttr.iframe = [</span>
<a href="#l4.1937"></a><span id="l4.1937">   &quot;noJSEvents&quot;,</span>
<a href="#l4.1938"></a><span id="l4.1938"> ];</span>
<a href="#l4.1939"></a><span id="l4.1939"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdAECSSAttributes.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdAECSSAttributes.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -1,12 +1,16 @@</span>
<a href="#l5.4"></a><span id="l5.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l5.5"></a><span id="l5.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l5.6"></a><span id="l5.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l5.9"></a><span id="l5.9" class="difflineplus">+/* import-globals-from EdAdvancedEdit.js */</span>
<a href="#l5.10"></a><span id="l5.10" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineplus">+</span>
<a href="#l5.12"></a><span id="l5.12"> // build attribute list in tree form from element attributes</span>
<a href="#l5.13"></a><span id="l5.13"> function BuildCSSAttributeTable() {</span>
<a href="#l5.14"></a><span id="l5.14">   var style = gElement.style;</span>
<a href="#l5.15"></a><span id="l5.15">   if (style == undefined) {</span>
<a href="#l5.16"></a><span id="l5.16">     dump(&quot;Inline styles undefined\n&quot;);</span>
<a href="#l5.17"></a><span id="l5.17">     return;</span>
<a href="#l5.18"></a><span id="l5.18">   }</span>
<a href="#l5.19"></a><span id="l5.19"> </span>
<a href="#l5.20"></a><span id="l5.20" class="difflineat">@@ -96,18 +100,19 @@ function UpdateCSSAttributes() {</span>
<a href="#l5.21"></a><span id="l5.21">       styleString += name + &quot;: &quot; + value + &quot;;&quot;;   // last property</span>
<a href="#l5.22"></a><span id="l5.22">     else</span>
<a href="#l5.23"></a><span id="l5.23">       styleString += name + &quot;: &quot; + value + &quot;; &quot;;</span>
<a href="#l5.24"></a><span id="l5.24">   }</span>
<a href="#l5.25"></a><span id="l5.25">   if (styleString) {</span>
<a href="#l5.26"></a><span id="l5.26">     // Use editor transactions if modifying the element directly in the document</span>
<a href="#l5.27"></a><span id="l5.27">     doRemoveAttribute(&quot;style&quot;);</span>
<a href="#l5.28"></a><span id="l5.28">     doSetAttribute(&quot;style&quot;, styleString);  // NOTE BUG 18894!!!</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineminus">-  } else if (gElement.getAttribute(&quot;style&quot;))</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineplus">+  } else if (gElement.getAttribute(&quot;style&quot;)) {</span>
<a href="#l5.31"></a><span id="l5.31">     doRemoveAttribute(&quot;style&quot;);</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+  }</span>
<a href="#l5.33"></a><span id="l5.33"> }</span>
<a href="#l5.34"></a><span id="l5.34"> </span>
<a href="#l5.35"></a><span id="l5.35"> function RemoveCSSAttribute() {</span>
<a href="#l5.36"></a><span id="l5.36">   // We only allow 1 selected item</span>
<a href="#l5.37"></a><span id="l5.37">   if (gDialog.AddCSSAttributeTree.view.selection.count) {</span>
<a href="#l5.38"></a><span id="l5.38">     // Remove the item from the tree</span>
<a href="#l5.39"></a><span id="l5.39">     // We always rebuild complete &quot;style&quot; string,</span>
<a href="#l5.40"></a><span id="l5.40">     //  so no list of &quot;removed&quot; items</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdAEHTMLAttributes.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdAEHTMLAttributes.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -1,12 +1,16 @@</span>
<a href="#l6.4"></a><span id="l6.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.5"></a><span id="l6.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.6"></a><span id="l6.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l6.7"></a><span id="l6.7"> </span>
<a href="#l6.8"></a><span id="l6.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l6.9"></a><span id="l6.9" class="difflineplus">+/* import-globals-from EdAdvancedEdit.js */</span>
<a href="#l6.10"></a><span id="l6.10" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineplus">+</span>
<a href="#l6.12"></a><span id="l6.12"> function BuildHTMLAttributeNameList() {</span>
<a href="#l6.13"></a><span id="l6.13">   gDialog.AddHTMLAttributeNameInput.removeAllItems();</span>
<a href="#l6.14"></a><span id="l6.14"> </span>
<a href="#l6.15"></a><span id="l6.15">   var elementName = gElement.localName;</span>
<a href="#l6.16"></a><span id="l6.16">   var attNames = gHTMLAttr[elementName];</span>
<a href="#l6.17"></a><span id="l6.17"> </span>
<a href="#l6.18"></a><span id="l6.18">   if (attNames &amp;&amp; attNames.length) {</span>
<a href="#l6.19"></a><span id="l6.19">     var menuitem;</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineat">@@ -20,18 +24,19 @@ function BuildHTMLAttributeNameList() {</span>
<a href="#l6.21"></a><span id="l6.21">           name = gCoreHTMLAttr[j];</span>
<a href="#l6.22"></a><span id="l6.22"> </span>
<a href="#l6.23"></a><span id="l6.23">           // only filtering rule used for core attributes as of 8-20-01</span>
<a href="#l6.24"></a><span id="l6.24">           // Add more rules if necessary.</span>
<a href="#l6.25"></a><span id="l6.25">           if (name.includes(&quot;^&quot;)) {</span>
<a href="#l6.26"></a><span id="l6.26">             name = name.replace(/\^/g, &quot;&quot;);</span>
<a href="#l6.27"></a><span id="l6.27">             menuitem = gDialog.AddHTMLAttributeNameInput.appendItem(name, name);</span>
<a href="#l6.28"></a><span id="l6.28">             menuitem.setAttribute(&quot;limitFirstChar&quot;, &quot;true&quot;);</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineminus">-          } else</span>
<a href="#l6.30"></a><span id="l6.30" class="difflineplus">+          } else {</span>
<a href="#l6.31"></a><span id="l6.31">             gDialog.AddHTMLAttributeNameInput.appendItem(name, name);</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineplus">+          }</span>
<a href="#l6.33"></a><span id="l6.33">         }</span>
<a href="#l6.34"></a><span id="l6.34">       } else if (name == &quot;-&quot;) {</span>
<a href="#l6.35"></a><span id="l6.35">         // Signal for separator</span>
<a href="#l6.36"></a><span id="l6.36">         var popup = gDialog.AddHTMLAttributeNameInput.menupopup;</span>
<a href="#l6.37"></a><span id="l6.37">         if (popup) {</span>
<a href="#l6.38"></a><span id="l6.38">           var sep = document.createElementNS(XUL_NS, &quot;menuseparator&quot;);</span>
<a href="#l6.39"></a><span id="l6.39">           if (sep)</span>
<a href="#l6.40"></a><span id="l6.40">             popup.appendChild(sep);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdAEJSEAttributes.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdAEJSEAttributes.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -1,12 +1,16 @@</span>
<a href="#l7.4"></a><span id="l7.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l7.5"></a><span id="l7.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l7.6"></a><span id="l7.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l7.7"></a><span id="l7.7"> </span>
<a href="#l7.8"></a><span id="l7.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l7.9"></a><span id="l7.9" class="difflineplus">+/* import-globals-from EdAdvancedEdit.js */</span>
<a href="#l7.10"></a><span id="l7.10" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l7.11"></a><span id="l7.11" class="difflineplus">+</span>
<a href="#l7.12"></a><span id="l7.12"> function BuildJSEAttributeNameList() {</span>
<a href="#l7.13"></a><span id="l7.13">   gDialog.AddJSEAttributeNameList.removeAllItems();</span>
<a href="#l7.14"></a><span id="l7.14"> </span>
<a href="#l7.15"></a><span id="l7.15">   // Get events specific to current element</span>
<a href="#l7.16"></a><span id="l7.16">   var elementName = gElement.localName;</span>
<a href="#l7.17"></a><span id="l7.17">   if (elementName in gJSAttr) {</span>
<a href="#l7.18"></a><span id="l7.18">     var attNames = gJSAttr[elementName];</span>
<a href="#l7.19"></a><span id="l7.19">     var i;</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineat">@@ -41,18 +45,19 @@ function BuildJSEAttributeNameList() {</span>
<a href="#l7.21"></a><span id="l7.21">     if (gCoreJSEvents[i] == &quot;-&quot;) {</span>
<a href="#l7.22"></a><span id="l7.22">       if (!popup)</span>
<a href="#l7.23"></a><span id="l7.23">         popup = gDialog.AddJSEAttributeNameList.firstChild;</span>
<a href="#l7.24"></a><span id="l7.24"> </span>
<a href="#l7.25"></a><span id="l7.25">       sep = document.createElementNS(XUL_NS, &quot;menuseparator&quot;);</span>
<a href="#l7.26"></a><span id="l7.26"> </span>
<a href="#l7.27"></a><span id="l7.27">       if (popup &amp;&amp; sep)</span>
<a href="#l7.28"></a><span id="l7.28">         popup.appendChild(sep);</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineminus">-    } else</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineplus">+    } else {</span>
<a href="#l7.31"></a><span id="l7.31">       gDialog.AddJSEAttributeNameList.appendItem(gCoreJSEvents[i], gCoreJSEvents[i]);</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+    }</span>
<a href="#l7.33"></a><span id="l7.33">   }</span>
<a href="#l7.34"></a><span id="l7.34"> </span>
<a href="#l7.35"></a><span id="l7.35">   gDialog.AddJSEAttributeNameList.selectedIndex = 0;</span>
<a href="#l7.36"></a><span id="l7.36"> </span>
<a href="#l7.37"></a><span id="l7.37">   // Use current name and value of first tree item if it exists</span>
<a href="#l7.38"></a><span id="l7.38">   onSelectJSETreeItem();</span>
<a href="#l7.39"></a><span id="l7.39"> }</span>
<a href="#l7.40"></a><span id="l7.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdAdvancedEdit.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdAdvancedEdit.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -1,12 +1,19 @@</span>
<a href="#l8.4"></a><span id="l8.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l8.5"></a><span id="l8.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l8.6"></a><span id="l8.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l8.7"></a><span id="l8.7"> </span>
<a href="#l8.8"></a><span id="l8.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l8.9"></a><span id="l8.9" class="difflineplus">+/* import-globals-from EdAEAttributes.js */</span>
<a href="#l8.10"></a><span id="l8.10" class="difflineplus">+/* import-globals-from EdAECSSAttributes.js */</span>
<a href="#l8.11"></a><span id="l8.11" class="difflineplus">+/* import-globals-from EdAEHTMLAttributes.js */</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+/* import-globals-from EdAEJSEAttributes.js */</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+</span>
<a href="#l8.15"></a><span id="l8.15"> /** ************         GLOBALS         **************/</span>
<a href="#l8.16"></a><span id="l8.16"> var gElement    = null; // handle to actual element edited</span>
<a href="#l8.17"></a><span id="l8.17"> </span>
<a href="#l8.18"></a><span id="l8.18"> var HTMLAttrs   = [];   // html attributes</span>
<a href="#l8.19"></a><span id="l8.19"> var CSSAttrs    = [];   // css attributes</span>
<a href="#l8.20"></a><span id="l8.20"> var JSEAttrs    = [];   // js events</span>
<a href="#l8.21"></a><span id="l8.21"> </span>
<a href="#l8.22"></a><span id="l8.22"> var HTMLRAttrs  = [];   // removed html attributes</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdButtonProps.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdButtonProps.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l9.4"></a><span id="l9.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l9.5"></a><span id="l9.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l9.6"></a><span id="l9.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l9.9"></a><span id="l9.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l9.10"></a><span id="l9.10" class="difflineplus">+</span>
<a href="#l9.11"></a><span id="l9.11"> var insertNew;</span>
<a href="#l9.12"></a><span id="l9.12"> var buttonElement;</span>
<a href="#l9.13"></a><span id="l9.13"> </span>
<a href="#l9.14"></a><span id="l9.14"> // dialog initialization code</span>
<a href="#l9.15"></a><span id="l9.15"> </span>
<a href="#l9.16"></a><span id="l9.16"> document.addEventListener(&quot;dialogaccept&quot;, onAccept);</span>
<a href="#l9.17"></a><span id="l9.17"> document.addEventListener(&quot;dialogcancel&quot;, onCancel);</span>
<a href="#l9.18"></a><span id="l9.18"> </span>
<a href="#l9.19"></a><span id="l9.19" class="difflineat">@@ -30,20 +33,20 @@ function Startup() {</span>
<a href="#l9.20"></a><span id="l9.20">   };</span>
<a href="#l9.21"></a><span id="l9.21"> </span>
<a href="#l9.22"></a><span id="l9.22">   // Get a single selected button element</span>
<a href="#l9.23"></a><span id="l9.23">   const kTagName = &quot;button&quot;;</span>
<a href="#l9.24"></a><span id="l9.24">   try {</span>
<a href="#l9.25"></a><span id="l9.25">     buttonElement = editor.getSelectedElement(kTagName);</span>
<a href="#l9.26"></a><span id="l9.26">   } catch (e) {}</span>
<a href="#l9.27"></a><span id="l9.27"> </span>
<a href="#l9.28"></a><span id="l9.28" class="difflineminus">-  if (buttonElement)</span>
<a href="#l9.29"></a><span id="l9.29" class="difflineplus">+  if (buttonElement) {</span>
<a href="#l9.30"></a><span id="l9.30">     // We found an element and don't need to insert one</span>
<a href="#l9.31"></a><span id="l9.31">     insertNew = false;</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineminus">-  else {</span>
<a href="#l9.33"></a><span id="l9.33" class="difflineplus">+  } else {</span>
<a href="#l9.34"></a><span id="l9.34">     insertNew = true;</span>
<a href="#l9.35"></a><span id="l9.35"> </span>
<a href="#l9.36"></a><span id="l9.36">     // We don't have an element selected,</span>
<a href="#l9.37"></a><span id="l9.37">     //  so create one with default attributes</span>
<a href="#l9.38"></a><span id="l9.38">     try {</span>
<a href="#l9.39"></a><span id="l9.39">       buttonElement = editor.createElementWithDefaults(kTagName);</span>
<a href="#l9.40"></a><span id="l9.40">     } catch (e) {}</span>
<a href="#l9.41"></a><span id="l9.41"> </span>
<a href="#l9.42"></a><span id="l9.42" class="difflineat">@@ -120,16 +123,17 @@ function onAccept() {</span>
<a href="#l9.43"></a><span id="l9.43">   ValidateData();</span>
<a href="#l9.44"></a><span id="l9.44"> </span>
<a href="#l9.45"></a><span id="l9.45">   var editor = GetCurrentEditor();</span>
<a href="#l9.46"></a><span id="l9.46"> </span>
<a href="#l9.47"></a><span id="l9.47">   editor.cloneAttributes(buttonElement, globalElement);</span>
<a href="#l9.48"></a><span id="l9.48"> </span>
<a href="#l9.49"></a><span id="l9.49">   if (insertNew) {</span>
<a href="#l9.50"></a><span id="l9.50">     if (!InsertElementAroundSelection(buttonElement)) {</span>
<a href="#l9.51"></a><span id="l9.51" class="difflineplus">+      /* eslint-disable-next-line no-unsanitized/property */</span>
<a href="#l9.52"></a><span id="l9.52">       buttonElement.innerHTML = editor.outputToString(&quot;text/html&quot;, kOutputSelectionOnly);</span>
<a href="#l9.53"></a><span id="l9.53">       editor.insertElementAtSelection(buttonElement, true);</span>
<a href="#l9.54"></a><span id="l9.54">     }</span>
<a href="#l9.55"></a><span id="l9.55">   }</span>
<a href="#l9.56"></a><span id="l9.56"> </span>
<a href="#l9.57"></a><span id="l9.57">   SaveWindowLocation();</span>
<a href="#l9.58"></a><span id="l9.58"> }</span>
<a href="#l9.59"></a><span id="l9.59"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdColorPicker.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdColorPicker.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l10.4"></a><span id="l10.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l10.5"></a><span id="l10.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l10.6"></a><span id="l10.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l10.7"></a><span id="l10.7"> </span>
<a href="#l10.8"></a><span id="l10.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l10.9"></a><span id="l10.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l10.10"></a><span id="l10.10"> </span>
<a href="#l10.11"></a><span id="l10.11"> // Cancel() is in EdDialogCommon.js</span>
<a href="#l10.12"></a><span id="l10.12"> </span>
<a href="#l10.13"></a><span id="l10.13"> var insertNew = true;</span>
<a href="#l10.14"></a><span id="l10.14"> var tagname = &quot;TAG NAME&quot;;</span>
<a href="#l10.15"></a><span id="l10.15"> var gColor = &quot;&quot;;</span>
<a href="#l10.16"></a><span id="l10.16"> var LastPickedColor = &quot;&quot;;</span>
<a href="#l10.17"></a><span id="l10.17"> var ColorType = &quot;Text&quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdColorProps.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdColorProps.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -7,16 +7,19 @@</span>
<a href="#l11.4"></a><span id="l11.4">  Radio buttons select &quot;UseDefaultColors&quot; vs. &quot;UseCustomColors&quot; modes.</span>
<a href="#l11.5"></a><span id="l11.5">  If any color attribute is set in the body, mode is &quot;Custom Colors&quot;,</span>
<a href="#l11.6"></a><span id="l11.6">   even if 1 or more (but not all) are actually null (= &quot;use default&quot;)</span>
<a href="#l11.7"></a><span id="l11.7">  When in &quot;Custom Colors&quot; mode, all colors will be set on body tag,</span>
<a href="#l11.8"></a><span id="l11.8">   even if they are just default colors, to assure compatible colors in page.</span>
<a href="#l11.9"></a><span id="l11.9">  User cannot select &quot;use default&quot; for individual colors</span>
<a href="#l11.10"></a><span id="l11.10"> */</span>
<a href="#l11.11"></a><span id="l11.11"> </span>
<a href="#l11.12"></a><span id="l11.12" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineplus">+</span>
<a href="#l11.15"></a><span id="l11.15"> // Cancel() is in EdDialogCommon.js</span>
<a href="#l11.16"></a><span id="l11.16"> </span>
<a href="#l11.17"></a><span id="l11.17"> document.addEventListener(&quot;dialogaccept&quot;, onAccept);</span>
<a href="#l11.18"></a><span id="l11.18"> document.addEventListener(&quot;dialogcancel&quot;, onCancel);</span>
<a href="#l11.19"></a><span id="l11.19"> </span>
<a href="#l11.20"></a><span id="l11.20"> var gBodyElement;</span>
<a href="#l11.21"></a><span id="l11.21"> var prefs;</span>
<a href="#l11.22"></a><span id="l11.22"> var gBackgroundImage;</span>
<a href="#l11.23"></a><span id="l11.23" class="difflineat">@@ -42,17 +45,16 @@ const backColorStyle = cssBackgroundColo</span>
<a href="#l11.24"></a><span id="l11.24"> const backImageStyle = &quot;; &quot; + cssBackgroundImageStr + &quot;: url(&quot;;</span>
<a href="#l11.25"></a><span id="l11.25"> </span>
<a href="#l11.26"></a><span id="l11.26"> var customTextColor;</span>
<a href="#l11.27"></a><span id="l11.27"> var customLinkColor;</span>
<a href="#l11.28"></a><span id="l11.28"> var customActiveColor;</span>
<a href="#l11.29"></a><span id="l11.29"> var customVisitedColor;</span>
<a href="#l11.30"></a><span id="l11.30"> var customBackgroundColor;</span>
<a href="#l11.31"></a><span id="l11.31"> var previewBGColor;</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineminus">-var gHaveDocumentUrl = false;</span>
<a href="#l11.33"></a><span id="l11.33"> </span>
<a href="#l11.34"></a><span id="l11.34"> // dialog initialization code</span>
<a href="#l11.35"></a><span id="l11.35"> function Startup() {</span>
<a href="#l11.36"></a><span id="l11.36">   var editor = GetCurrentEditor();</span>
<a href="#l11.37"></a><span id="l11.37">   if (!editor) {</span>
<a href="#l11.38"></a><span id="l11.38">     window.close();</span>
<a href="#l11.39"></a><span id="l11.39">     return;</span>
<a href="#l11.40"></a><span id="l11.40">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdConvertToTable.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdConvertToTable.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l12.4"></a><span id="l12.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l12.5"></a><span id="l12.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l12.6"></a><span id="l12.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l12.7"></a><span id="l12.7"> </span>
<a href="#l12.8"></a><span id="l12.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l12.9"></a><span id="l12.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l12.10"></a><span id="l12.10" class="difflineplus">+</span>
<a href="#l12.11"></a><span id="l12.11"> document.addEventListener(&quot;dialogaccept&quot;, onAccept);</span>
<a href="#l12.12"></a><span id="l12.12"> document.addEventListener(&quot;dialogcancel&quot;, onCancel);</span>
<a href="#l12.13"></a><span id="l12.13"> </span>
<a href="#l12.14"></a><span id="l12.14"> var gIndex;</span>
<a href="#l12.15"></a><span id="l12.15"> var gCommaIndex = &quot;0&quot;;</span>
<a href="#l12.16"></a><span id="l12.16"> var gSpaceIndex = &quot;1&quot;;</span>
<a href="#l12.17"></a><span id="l12.17"> var gOtherIndex = &quot;2&quot;;</span>
<a href="#l12.18"></a><span id="l12.18"> </span>
<a href="#l12.19"></a><span id="l12.19" class="difflineat">@@ -61,16 +64,17 @@ function InputSepCharacter() {</span>
<a href="#l12.20"></a><span id="l12.20"> }</span>
<a href="#l12.21"></a><span id="l12.21"> </span>
<a href="#l12.22"></a><span id="l12.22"> function SelectCharacter(radioGroupIndex) {</span>
<a href="#l12.23"></a><span id="l12.23">   gIndex = radioGroupIndex;</span>
<a href="#l12.24"></a><span id="l12.24">   SetElementEnabledById(&quot;SepCharacterInput&quot;, gIndex == gOtherIndex);</span>
<a href="#l12.25"></a><span id="l12.25">   SetElementEnabledById(&quot;CollapseSpaces&quot;, gIndex == gSpaceIndex);</span>
<a href="#l12.26"></a><span id="l12.26"> }</span>
<a href="#l12.27"></a><span id="l12.27"> </span>
<a href="#l12.28"></a><span id="l12.28" class="difflineplus">+/* eslint-disable complexity */</span>
<a href="#l12.29"></a><span id="l12.29"> function onAccept() {</span>
<a href="#l12.30"></a><span id="l12.30">   var sepCharacter = &quot;&quot;;</span>
<a href="#l12.31"></a><span id="l12.31">   switch (gIndex) {</span>
<a href="#l12.32"></a><span id="l12.32">     case gCommaIndex:</span>
<a href="#l12.33"></a><span id="l12.33">       sepCharacter = &quot;,&quot;;</span>
<a href="#l12.34"></a><span id="l12.34">       break;</span>
<a href="#l12.35"></a><span id="l12.35">     case gSpaceIndex:</span>
<a href="#l12.36"></a><span id="l12.36">       sepCharacter = &quot; &quot;;</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineat">@@ -278,22 +282,23 @@ function onAccept() {</span>
<a href="#l12.38"></a><span id="l12.38">       do {</span>
<a href="#l12.39"></a><span id="l12.39">         if (node2.nodeName.toLowerCase() == &quot;td&quot; ||</span>
<a href="#l12.40"></a><span id="l12.40">             node2.nodeName.toLowerCase() == &quot;th&quot;) {</span>
<a href="#l12.41"></a><span id="l12.41">           try {</span>
<a href="#l12.42"></a><span id="l12.42">             editor.selection.collapse(node2, 0);</span>
<a href="#l12.43"></a><span id="l12.43">           } catch (e) {}</span>
<a href="#l12.44"></a><span id="l12.44">           break;</span>
<a href="#l12.45"></a><span id="l12.45">         }</span>
<a href="#l12.46"></a><span id="l12.46" class="difflineminus">-        node2 = node.nextSibling;</span>
<a href="#l12.47"></a><span id="l12.47" class="difflineplus">+        node2 = node2.nextSibling;</span>
<a href="#l12.48"></a><span id="l12.48">       } while (node2);</span>
<a href="#l12.49"></a><span id="l12.49">     }</span>
<a href="#l12.50"></a><span id="l12.50">   }</span>
<a href="#l12.51"></a><span id="l12.51"> </span>
<a href="#l12.52"></a><span id="l12.52">   editor.endTransaction();</span>
<a href="#l12.53"></a><span id="l12.53"> </span>
<a href="#l12.54"></a><span id="l12.54">   // Save persisted attributes</span>
<a href="#l12.55"></a><span id="l12.55">   gDialog.sepRadioGroup.setAttribute(&quot;index&quot;, gIndex);</span>
<a href="#l12.56"></a><span id="l12.56">   if (gIndex == gOtherIndex)</span>
<a href="#l12.57"></a><span id="l12.57">     gDialog.sepRadioGroup.setAttribute(&quot;character&quot;, sepCharacter);</span>
<a href="#l12.58"></a><span id="l12.58"> </span>
<a href="#l12.59"></a><span id="l12.59">   SaveWindowLocation();</span>
<a href="#l12.60"></a><span id="l12.60"> }</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineplus">+/* eslint-enable complexity */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdDialogCommon.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdDialogCommon.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -1,17 +1,21 @@</span>
<a href="#l13.4"></a><span id="l13.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l13.5"></a><span id="l13.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l13.6"></a><span id="l13.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l13.7"></a><span id="l13.7"> </span>
<a href="#l13.8"></a><span id="l13.8"> // Each editor window must include this file</span>
<a href="#l13.9"></a><span id="l13.9"> </span>
<a href="#l13.10"></a><span id="l13.10" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l13.11"></a><span id="l13.11" class="difflineplus">+/* globals InitDialog, ChangeLinkLocation, ValidateData */</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+</span>
<a href="#l13.13"></a><span id="l13.13"> // Object to attach commonly-used widgets (all dialogs should use this)</span>
<a href="#l13.14"></a><span id="l13.14"> var gDialog = {};</span>
<a href="#l13.15"></a><span id="l13.15"> </span>
<a href="#l13.16"></a><span id="l13.16" class="difflineplus">+var gHaveDocumentUrl = false;</span>
<a href="#l13.17"></a><span id="l13.17"> var gValidationError = false;</span>
<a href="#l13.18"></a><span id="l13.18"> </span>
<a href="#l13.19"></a><span id="l13.19"> // Use for 'defaultIndex' param in InitPixelOrPercentMenulist</span>
<a href="#l13.20"></a><span id="l13.20"> const gPixel = 0;</span>
<a href="#l13.21"></a><span id="l13.21"> const gPercent = 1;</span>
<a href="#l13.22"></a><span id="l13.22"> </span>
<a href="#l13.23"></a><span id="l13.23"> const gMaxPixels  = 100000; // Used for image size, borders, spacing, and padding</span>
<a href="#l13.24"></a><span id="l13.24"> // Gecko code uses 1000 for maximum rowspan, colspan</span>
<a href="#l13.25"></a><span id="l13.25" class="difflineat">@@ -72,17 +76,17 @@ function ValidateNumber(inputWidget, lis</span>
<a href="#l13.26"></a><span id="l13.26"> </span>
<a href="#l13.27"></a><span id="l13.27">     // This method puts up the error message</span>
<a href="#l13.28"></a><span id="l13.28">     numString = ValidateNumberRange(numString, minVal, maxLimit, mustHaveValue);</span>
<a href="#l13.29"></a><span id="l13.29">     if (!numString) {</span>
<a href="#l13.30"></a><span id="l13.30">       // Switch to appropriate panel for error reporting</span>
<a href="#l13.31"></a><span id="l13.31">       SwitchToValidatePanel();</span>
<a href="#l13.32"></a><span id="l13.32"> </span>
<a href="#l13.33"></a><span id="l13.33">       // or expand dialog for users of &quot;More / Fewer&quot; button</span>
<a href="#l13.34"></a><span id="l13.34" class="difflineminus">-      if (&quot;dialog&quot; in window &amp;&amp; dialog &amp;&amp;</span>
<a href="#l13.35"></a><span id="l13.35" class="difflineplus">+      if (&quot;dialog&quot; in window &amp;&amp; window.dialog &amp;&amp;</span>
<a href="#l13.36"></a><span id="l13.36">            &quot;MoreSection&quot; in gDialog &amp;&amp; gDialog.MoreSection) {</span>
<a href="#l13.37"></a><span id="l13.37">         if (!SeeMore)</span>
<a href="#l13.38"></a><span id="l13.38">           onMoreFewer();</span>
<a href="#l13.39"></a><span id="l13.39">       }</span>
<a href="#l13.40"></a><span id="l13.40"> </span>
<a href="#l13.41"></a><span id="l13.41">       // Error - shift to offending input widget</span>
<a href="#l13.42"></a><span id="l13.42">       SetTextboxFocus(inputWidget);</span>
<a href="#l13.43"></a><span id="l13.43">       gValidationError = true;</span>
<a href="#l13.44"></a><span id="l13.44" class="difflineat">@@ -182,17 +186,19 @@ function GetAppropriatePercentString(ele</span>
<a href="#l13.45"></a><span id="l13.45">     var name = elementForAtt.nodeName.toLowerCase();</span>
<a href="#l13.46"></a><span id="l13.46">     if (name == &quot;td&quot; || name == &quot;th&quot;)</span>
<a href="#l13.47"></a><span id="l13.47">       return GetString(&quot;PercentOfTable&quot;);</span>
<a href="#l13.48"></a><span id="l13.48"> </span>
<a href="#l13.49"></a><span id="l13.49">     // Check if element is within a table cell</span>
<a href="#l13.50"></a><span id="l13.50">     if (editor.getElementOrParentByTagName(&quot;td&quot;, elementInDoc))</span>
<a href="#l13.51"></a><span id="l13.51">       return GetString(&quot;PercentOfCell&quot;);</span>
<a href="#l13.52"></a><span id="l13.52">     return GetString(&quot;PercentOfWindow&quot;);</span>
<a href="#l13.53"></a><span id="l13.53" class="difflineminus">-  } catch (e) { return &quot;&quot;; }</span>
<a href="#l13.54"></a><span id="l13.54" class="difflineplus">+  } catch (e) {</span>
<a href="#l13.55"></a><span id="l13.55" class="difflineplus">+    return &quot;&quot;;</span>
<a href="#l13.56"></a><span id="l13.56" class="difflineplus">+  }</span>
<a href="#l13.57"></a><span id="l13.57"> }</span>
<a href="#l13.58"></a><span id="l13.58"> </span>
<a href="#l13.59"></a><span id="l13.59"> function ClearListbox(listbox) {</span>
<a href="#l13.60"></a><span id="l13.60">   if (listbox) {</span>
<a href="#l13.61"></a><span id="l13.61">     listbox.clearSelection();</span>
<a href="#l13.62"></a><span id="l13.62">     while (listbox.hasChildNodes())</span>
<a href="#l13.63"></a><span id="l13.63">       listbox.lastChild.remove();</span>
<a href="#l13.64"></a><span id="l13.64">   }</span>
<a href="#l13.65"></a><span id="l13.65" class="difflineat">@@ -243,18 +249,19 @@ function InitPixelOrPercentMenulist(elem</span>
<a href="#l13.66"></a><span id="l13.66">       if (percentItem)</span>
<a href="#l13.67"></a><span id="l13.67">         menulist.selectedItem = percentItem;</span>
<a href="#l13.68"></a><span id="l13.68">     } else {</span>
<a href="#l13.69"></a><span id="l13.69">       if (size.includes(&quot;px&quot;))</span>
<a href="#l13.70"></a><span id="l13.70">         // Strip out the px</span>
<a href="#l13.71"></a><span id="l13.71">         size = size.substr(0, size.indexOf(&quot;px&quot;));</span>
<a href="#l13.72"></a><span id="l13.72">       menulist.selectedItem = pixelItem;</span>
<a href="#l13.73"></a><span id="l13.73">     }</span>
<a href="#l13.74"></a><span id="l13.74" class="difflineminus">-  } else</span>
<a href="#l13.75"></a><span id="l13.75" class="difflineplus">+  } else {</span>
<a href="#l13.76"></a><span id="l13.76">     menulist.selectedIndex = defaultIndex;</span>
<a href="#l13.77"></a><span id="l13.77" class="difflineplus">+  }</span>
<a href="#l13.78"></a><span id="l13.78"> </span>
<a href="#l13.79"></a><span id="l13.79">   return size;</span>
<a href="#l13.80"></a><span id="l13.80"> }</span>
<a href="#l13.81"></a><span id="l13.81"> </span>
<a href="#l13.82"></a><span id="l13.82"> function onAdvancedEdit() {</span>
<a href="#l13.83"></a><span id="l13.83">   // First validate data from widgets in the &quot;simpler&quot; property dialog</span>
<a href="#l13.84"></a><span id="l13.84">   if (ValidateData()) {</span>
<a href="#l13.85"></a><span id="l13.85">     // Set true if OK is clicked in the Advanced Edit dialog</span>
<a href="#l13.86"></a><span id="l13.86" class="difflineat">@@ -348,20 +355,19 @@ const nsIFilePicker = Ci.nsIFilePicker;</span>
<a href="#l13.87"></a><span id="l13.87"> function GetLocalFileURL(filterType) {</span>
<a href="#l13.88"></a><span id="l13.88">   var fp = Cc[&quot;@mozilla.org/filepicker;1&quot;].createInstance(nsIFilePicker);</span>
<a href="#l13.89"></a><span id="l13.89">   var fileType = &quot;html&quot;;</span>
<a href="#l13.90"></a><span id="l13.90"> </span>
<a href="#l13.91"></a><span id="l13.91">   if (filterType == &quot;img&quot;) {</span>
<a href="#l13.92"></a><span id="l13.92">     fp.init(window, GetString(&quot;SelectImageFile&quot;), nsIFilePicker.modeOpen);</span>
<a href="#l13.93"></a><span id="l13.93">     fp.appendFilters(nsIFilePicker.filterImages);</span>
<a href="#l13.94"></a><span id="l13.94">     fileType = &quot;image&quot;;</span>
<a href="#l13.95"></a><span id="l13.95" class="difflineminus">-  }</span>
<a href="#l13.96"></a><span id="l13.96" class="difflineminus">-  // Current usage of this is in Link dialog,</span>
<a href="#l13.97"></a><span id="l13.97" class="difflineminus">-  //  where we always want HTML first</span>
<a href="#l13.98"></a><span id="l13.98" class="difflineminus">-  else if (filterType.startsWith(&quot;html&quot;)) {</span>
<a href="#l13.99"></a><span id="l13.99" class="difflineplus">+  } else if (filterType.startsWith(&quot;html&quot;)) {</span>
<a href="#l13.100"></a><span id="l13.100" class="difflineplus">+    // Current usage of this is in Link dialog,</span>
<a href="#l13.101"></a><span id="l13.101" class="difflineplus">+    //  where we always want HTML first</span>
<a href="#l13.102"></a><span id="l13.102">     fp.init(window, GetString(&quot;OpenHTMLFile&quot;), nsIFilePicker.modeOpen);</span>
<a href="#l13.103"></a><span id="l13.103"> </span>
<a href="#l13.104"></a><span id="l13.104">     // When loading into Composer, direct user to prefer HTML files and text files,</span>
<a href="#l13.105"></a><span id="l13.105">     //   so we call separately to control the order of the filter list</span>
<a href="#l13.106"></a><span id="l13.106">     fp.appendFilters(nsIFilePicker.filterHTML);</span>
<a href="#l13.107"></a><span id="l13.107">     fp.appendFilters(nsIFilePicker.filterText);</span>
<a href="#l13.108"></a><span id="l13.108"> </span>
<a href="#l13.109"></a><span id="l13.109">     // Link dialog also allows linking to images</span>
<a href="#l13.110"></a><span id="l13.110" class="difflineat">@@ -415,23 +421,24 @@ function CreateMetaElementWithAttribute(</span>
<a href="#l13.111"></a><span id="l13.111"> function SetMetaElementContent(metaElement, content, insertNew, prepend) {</span>
<a href="#l13.112"></a><span id="l13.112">   if (metaElement) {</span>
<a href="#l13.113"></a><span id="l13.113">     var editor = GetCurrentEditor();</span>
<a href="#l13.114"></a><span id="l13.114">     try {</span>
<a href="#l13.115"></a><span id="l13.115">       if (!content || content == &quot;&quot;) {</span>
<a href="#l13.116"></a><span id="l13.116">         if (!insertNew)</span>
<a href="#l13.117"></a><span id="l13.117">           editor.deleteNode(metaElement);</span>
<a href="#l13.118"></a><span id="l13.118">       } else if (insertNew) {</span>
<a href="#l13.119"></a><span id="l13.119" class="difflineminus">-          metaElement.setAttribute(&quot;content&quot;, content);</span>
<a href="#l13.120"></a><span id="l13.120" class="difflineminus">-          if (prepend)</span>
<a href="#l13.121"></a><span id="l13.121" class="difflineminus">-            PrependHeadElement(metaElement);</span>
<a href="#l13.122"></a><span id="l13.122" class="difflineminus">-          else</span>
<a href="#l13.123"></a><span id="l13.123" class="difflineminus">-            AppendHeadElement(metaElement);</span>
<a href="#l13.124"></a><span id="l13.124" class="difflineminus">-        } else</span>
<a href="#l13.125"></a><span id="l13.125" class="difflineminus">-          editor.setAttribute(metaElement, &quot;content&quot;, content);</span>
<a href="#l13.126"></a><span id="l13.126" class="difflineplus">+        metaElement.setAttribute(&quot;content&quot;, content);</span>
<a href="#l13.127"></a><span id="l13.127" class="difflineplus">+        if (prepend)</span>
<a href="#l13.128"></a><span id="l13.128" class="difflineplus">+          PrependHeadElement(metaElement);</span>
<a href="#l13.129"></a><span id="l13.129" class="difflineplus">+        else</span>
<a href="#l13.130"></a><span id="l13.130" class="difflineplus">+          AppendHeadElement(metaElement);</span>
<a href="#l13.131"></a><span id="l13.131" class="difflineplus">+      } else {</span>
<a href="#l13.132"></a><span id="l13.132" class="difflineplus">+        editor.setAttribute(metaElement, &quot;content&quot;, content);</span>
<a href="#l13.133"></a><span id="l13.133" class="difflineplus">+      }</span>
<a href="#l13.134"></a><span id="l13.134">     } catch (e) {}</span>
<a href="#l13.135"></a><span id="l13.135">   }</span>
<a href="#l13.136"></a><span id="l13.136"> }</span>
<a href="#l13.137"></a><span id="l13.137"> </span>
<a href="#l13.138"></a><span id="l13.138"> function GetHeadElement() {</span>
<a href="#l13.139"></a><span id="l13.139">   var editor = GetCurrentEditor();</span>
<a href="#l13.140"></a><span id="l13.140">   try {</span>
<a href="#l13.141"></a><span id="l13.141">     return editor.document.querySelector(&quot;head&quot;);</span>
<a href="#l13.142"></a><span id="l13.142" class="difflineat">@@ -475,18 +482,16 @@ function SetWindowLocation() {</span>
<a href="#l13.143"></a><span id="l13.143">                                           screen.availWidth - window.outerWidth));</span>
<a href="#l13.144"></a><span id="l13.144">     window.screenY = Math.max(0, Math.min(window.opener.screenY + Number(gLocation.getAttribute(&quot;offsetY&quot;)),</span>
<a href="#l13.145"></a><span id="l13.145">                                           screen.availHeight - window.outerHeight));</span>
<a href="#l13.146"></a><span id="l13.146">   }</span>
<a href="#l13.147"></a><span id="l13.147"> }</span>
<a href="#l13.148"></a><span id="l13.148"> </span>
<a href="#l13.149"></a><span id="l13.149"> function SaveWindowLocation() {</span>
<a href="#l13.150"></a><span id="l13.150">   if (gLocation) {</span>
<a href="#l13.151"></a><span id="l13.151" class="difflineminus">-    var newOffsetX = window.screenX - window.opener.screenX;</span>
<a href="#l13.152"></a><span id="l13.152" class="difflineminus">-    var newOffsetY = window.screenY - window.opener.screenY;</span>
<a href="#l13.153"></a><span id="l13.153">     gLocation.setAttribute(&quot;offsetX&quot;, window.screenX - window.opener.screenX);</span>
<a href="#l13.154"></a><span id="l13.154">     gLocation.setAttribute(&quot;offsetY&quot;, window.screenY - window.opener.screenY);</span>
<a href="#l13.155"></a><span id="l13.155">   }</span>
<a href="#l13.156"></a><span id="l13.156"> }</span>
<a href="#l13.157"></a><span id="l13.157"> </span>
<a href="#l13.158"></a><span id="l13.158"> function onCancel() {</span>
<a href="#l13.159"></a><span id="l13.159">   SaveWindowLocation();</span>
<a href="#l13.160"></a><span id="l13.160"> }</span>
<a href="#l13.161"></a><span id="l13.161" class="difflineat">@@ -522,30 +527,27 @@ function SetRelativeCheckbox(checkbox) {</span>
<a href="#l13.162"></a><span id="l13.162">   var docScheme = GetScheme(docUrl);</span>
<a href="#l13.163"></a><span id="l13.163"> </span>
<a href="#l13.164"></a><span id="l13.164">   if (url &amp;&amp; docUrl &amp;&amp; docScheme) {</span>
<a href="#l13.165"></a><span id="l13.165">     if (urlScheme) {</span>
<a href="#l13.166"></a><span id="l13.166">       // Url is absolute</span>
<a href="#l13.167"></a><span id="l13.167">       // If we can make a relative URL, then enable must be true!</span>
<a href="#l13.168"></a><span id="l13.168">       // (this lets the smarts of MakeRelativeUrl do all the hard work)</span>
<a href="#l13.169"></a><span id="l13.169">       enable = (GetScheme(MakeRelativeUrl(url)).length == 0);</span>
<a href="#l13.170"></a><span id="l13.170" class="difflineminus">-    } else {</span>
<a href="#l13.171"></a><span id="l13.171" class="difflineminus">-      // Url is relative</span>
<a href="#l13.172"></a><span id="l13.172" class="difflineplus">+    } else if (url[0] == &quot;#&quot;) { // Url is relative</span>
<a href="#l13.173"></a><span id="l13.173">       // Check if url is a named anchor</span>
<a href="#l13.174"></a><span id="l13.174">       //  but document doesn't have a filename</span>
<a href="#l13.175"></a><span id="l13.175">       // (it's probably &quot;index.html&quot; or &quot;index.htm&quot;,</span>
<a href="#l13.176"></a><span id="l13.176">       //  but we don't want to allow a malformed URL)</span>
<a href="#l13.177"></a><span id="l13.177" class="difflineminus">-      if (url[0] == &quot;#&quot;) {</span>
<a href="#l13.178"></a><span id="l13.178" class="difflineminus">-        var docFilename = GetFilename(docUrl);</span>
<a href="#l13.179"></a><span id="l13.179" class="difflineminus">-        enable = docFilename.length &gt; 0;</span>
<a href="#l13.180"></a><span id="l13.180" class="difflineminus">-      } else {</span>
<a href="#l13.181"></a><span id="l13.181" class="difflineminus">-        // Any other url is assumed</span>
<a href="#l13.182"></a><span id="l13.182" class="difflineminus">-        //  to be ok to try to make absolute</span>
<a href="#l13.183"></a><span id="l13.183" class="difflineminus">-        enable = true;</span>
<a href="#l13.184"></a><span id="l13.184" class="difflineminus">-      }</span>
<a href="#l13.185"></a><span id="l13.185" class="difflineplus">+      var docFilename = GetFilename(docUrl);</span>
<a href="#l13.186"></a><span id="l13.186" class="difflineplus">+      enable = docFilename.length &gt; 0;</span>
<a href="#l13.187"></a><span id="l13.187" class="difflineplus">+    } else {</span>
<a href="#l13.188"></a><span id="l13.188" class="difflineplus">+      // Any other url is assumed</span>
<a href="#l13.189"></a><span id="l13.189" class="difflineplus">+      //  to be ok to try to make absolute</span>
<a href="#l13.190"></a><span id="l13.190" class="difflineplus">+      enable = true;</span>
<a href="#l13.191"></a><span id="l13.191">     }</span>
<a href="#l13.192"></a><span id="l13.192">   }</span>
<a href="#l13.193"></a><span id="l13.193"> </span>
<a href="#l13.194"></a><span id="l13.194">   SetElementEnabled(checkbox, enable);</span>
<a href="#l13.195"></a><span id="l13.195"> }</span>
<a href="#l13.196"></a><span id="l13.196"> </span>
<a href="#l13.197"></a><span id="l13.197"> // oncommand handler for the Relativize checkbox in EditorOverlay.xul</span>
<a href="#l13.198"></a><span id="l13.198"> function MakeInputValueRelativeOrAbsolute(checkbox) {</span>
<a href="#l13.199"></a><span id="l13.199" class="difflineat">@@ -610,51 +612,51 @@ function nodeIsBreak(editor, node) {</span>
<a href="#l13.200"></a><span id="l13.200"> function InsertElementAroundSelection(element) {</span>
<a href="#l13.201"></a><span id="l13.201">   var editor = GetCurrentEditor();</span>
<a href="#l13.202"></a><span id="l13.202">   editor.beginTransaction();</span>
<a href="#l13.203"></a><span id="l13.203"> </span>
<a href="#l13.204"></a><span id="l13.204">   try {</span>
<a href="#l13.205"></a><span id="l13.205">     // First get the selection as a single range</span>
<a href="#l13.206"></a><span id="l13.206">     var range, start, end, offset;</span>
<a href="#l13.207"></a><span id="l13.207">     var count = editor.selection.rangeCount;</span>
<a href="#l13.208"></a><span id="l13.208" class="difflineminus">-    if (count == 1)</span>
<a href="#l13.209"></a><span id="l13.209" class="difflineplus">+    if (count == 1) {</span>
<a href="#l13.210"></a><span id="l13.210">       range = editor.selection.getRangeAt(0).cloneRange();</span>
<a href="#l13.211"></a><span id="l13.211" class="difflineminus">-    else {</span>
<a href="#l13.212"></a><span id="l13.212" class="difflineplus">+    } else {</span>
<a href="#l13.213"></a><span id="l13.213">       range = editor.document.createRange();</span>
<a href="#l13.214"></a><span id="l13.214">       start = editor.selection.getRangeAt(0);</span>
<a href="#l13.215"></a><span id="l13.215">       range.setStart(start.startContainer, start.startOffset);</span>
<a href="#l13.216"></a><span id="l13.216">       end = editor.selection.getRangeAt(--count);</span>
<a href="#l13.217"></a><span id="l13.217">       range.setEnd(end.endContainer, end.endOffset);</span>
<a href="#l13.218"></a><span id="l13.218">     }</span>
<a href="#l13.219"></a><span id="l13.219"> </span>
<a href="#l13.220"></a><span id="l13.220">     // Flatten the selection to child nodes of the common ancestor</span>
<a href="#l13.221"></a><span id="l13.221">     while (range.startContainer != range.commonAncestorContainer)</span>
<a href="#l13.222"></a><span id="l13.222">       range.setStartBefore(range.startContainer);</span>
<a href="#l13.223"></a><span id="l13.223">     while (range.endContainer != range.commonAncestorContainer)</span>
<a href="#l13.224"></a><span id="l13.224">       range.setEndAfter(range.endContainer);</span>
<a href="#l13.225"></a><span id="l13.225"> </span>
<a href="#l13.226"></a><span id="l13.226" class="difflineminus">-    if (editor.nodeIsBlock(element))</span>
<a href="#l13.227"></a><span id="l13.227" class="difflineplus">+    if (editor.nodeIsBlock(element)) {</span>
<a href="#l13.228"></a><span id="l13.228">       // Block element parent must be a valid block</span>
<a href="#l13.229"></a><span id="l13.229">       while (!IsBlockParent.includes(range.commonAncestorContainer.localName))</span>
<a href="#l13.230"></a><span id="l13.230">         range.selectNode(range.commonAncestorContainer);</span>
<a href="#l13.231"></a><span id="l13.231" class="difflineminus">-    else {</span>
<a href="#l13.232"></a><span id="l13.232" class="difflineplus">+    } else if (!nodeIsBreak(editor, range.commonAncestorContainer)) {</span>
<a href="#l13.233"></a><span id="l13.233">       // Fail if we're not inserting a block (use setInlineProperty instead)</span>
<a href="#l13.234"></a><span id="l13.234" class="difflineminus">-      if (!nodeIsBreak(editor, range.commonAncestorContainer))</span>
<a href="#l13.235"></a><span id="l13.235" class="difflineminus">-        return false;</span>
<a href="#l13.236"></a><span id="l13.236" class="difflineminus">-      else if (NotAnInlineParent.includes(range.commonAncestorContainer.localName))</span>
<a href="#l13.237"></a><span id="l13.237" class="difflineminus">-        // Inline element parent must not be an invalid block</span>
<a href="#l13.238"></a><span id="l13.238" class="difflineminus">-        do range.selectNode(range.commonAncestorContainer);</span>
<a href="#l13.239"></a><span id="l13.239" class="difflineminus">-        while (NotAnInlineParent.includes(range.commonAncestorContainer.localName));</span>
<a href="#l13.240"></a><span id="l13.240" class="difflineminus">-      else</span>
<a href="#l13.241"></a><span id="l13.241" class="difflineminus">-        // Further insert block check</span>
<a href="#l13.242"></a><span id="l13.242" class="difflineminus">-        for (var i = range.startOffset; ; i++)</span>
<a href="#l13.243"></a><span id="l13.243" class="difflineminus">-          if (i == range.endOffset)</span>
<a href="#l13.244"></a><span id="l13.244" class="difflineminus">-            return false;</span>
<a href="#l13.245"></a><span id="l13.245" class="difflineminus">-          else if (nodeIsBreak(editor, range.commonAncestorContainer.childNodes[i]))</span>
<a href="#l13.246"></a><span id="l13.246" class="difflineminus">-            break;</span>
<a href="#l13.247"></a><span id="l13.247" class="difflineplus">+      return false;</span>
<a href="#l13.248"></a><span id="l13.248" class="difflineplus">+    } else if (NotAnInlineParent.includes(range.commonAncestorContainer.localName)) {</span>
<a href="#l13.249"></a><span id="l13.249" class="difflineplus">+      // Inline element parent must not be an invalid block</span>
<a href="#l13.250"></a><span id="l13.250" class="difflineplus">+      do range.selectNode(range.commonAncestorContainer);</span>
<a href="#l13.251"></a><span id="l13.251" class="difflineplus">+      while (NotAnInlineParent.includes(range.commonAncestorContainer.localName));</span>
<a href="#l13.252"></a><span id="l13.252" class="difflineplus">+    } else {</span>
<a href="#l13.253"></a><span id="l13.253" class="difflineplus">+      // Further insert block check</span>
<a href="#l13.254"></a><span id="l13.254" class="difflineplus">+      for (var i = range.startOffset; ; i++) {</span>
<a href="#l13.255"></a><span id="l13.255" class="difflineplus">+        if (i == range.endOffset)</span>
<a href="#l13.256"></a><span id="l13.256" class="difflineplus">+          return false;</span>
<a href="#l13.257"></a><span id="l13.257" class="difflineplus">+        else if (nodeIsBreak(editor, range.commonAncestorContainer.childNodes[i]))</span>
<a href="#l13.258"></a><span id="l13.258" class="difflineplus">+          break;</span>
<a href="#l13.259"></a><span id="l13.259" class="difflineplus">+      }</span>
<a href="#l13.260"></a><span id="l13.260">     }</span>
<a href="#l13.261"></a><span id="l13.261"> </span>
<a href="#l13.262"></a><span id="l13.262">     // The range may be contained by body text, which should all be selected.</span>
<a href="#l13.263"></a><span id="l13.263">     offset = range.startOffset;</span>
<a href="#l13.264"></a><span id="l13.264">     start = range.startContainer.childNodes[offset];</span>
<a href="#l13.265"></a><span id="l13.265">     if (!nodeIsBreak(editor, start)) {</span>
<a href="#l13.266"></a><span id="l13.266">       while (!nodeIsBreak(editor, start.previousSibling)) {</span>
<a href="#l13.267"></a><span id="l13.267">         start = start.previousSibling;</span>
<a href="#l13.268"></a><span id="l13.268" class="difflineat">@@ -677,19 +679,19 @@ function InsertElementAroundSelection(el</span>
<a href="#l13.269"></a><span id="l13.269">     var empty = true;</span>
<a href="#l13.270"></a><span id="l13.270">     while (start != end) {</span>
<a href="#l13.271"></a><span id="l13.271">       var next = start.nextSibling;</span>
<a href="#l13.272"></a><span id="l13.272">       editor.deleteNode(start);</span>
<a href="#l13.273"></a><span id="l13.273">       editor.insertNode(start, element, element.childNodes.length);</span>
<a href="#l13.274"></a><span id="l13.274">       empty = false;</span>
<a href="#l13.275"></a><span id="l13.275">       start = next;</span>
<a href="#l13.276"></a><span id="l13.276">     }</span>
<a href="#l13.277"></a><span id="l13.277" class="difflineminus">-    if (!editor.nodeIsBlock(element))</span>
<a href="#l13.278"></a><span id="l13.278" class="difflineplus">+    if (!editor.nodeIsBlock(element)) {</span>
<a href="#l13.279"></a><span id="l13.279">       editor.setShouldTxnSetSelection(true);</span>
<a href="#l13.280"></a><span id="l13.280" class="difflineminus">-    else {</span>
<a href="#l13.281"></a><span id="l13.281" class="difflineplus">+    } else {</span>
<a href="#l13.282"></a><span id="l13.282">       // Also move a trailing &lt;br&gt;</span>
<a href="#l13.283"></a><span id="l13.283">       // XXX This doesn't work because .localName is lowercase (see bug 1306060).</span>
<a href="#l13.284"></a><span id="l13.284">       if (start &amp;&amp; start.localName == &quot;BR&quot;) {</span>
<a href="#l13.285"></a><span id="l13.285">         editor.deleteNode(start);</span>
<a href="#l13.286"></a><span id="l13.286">         editor.insertNode(start, element, element.childNodes.length);</span>
<a href="#l13.287"></a><span id="l13.287">         empty = false;</span>
<a href="#l13.288"></a><span id="l13.288">       }</span>
<a href="#l13.289"></a><span id="l13.289">       // Still nothing? Insert a &lt;br&gt; so the node is not empty</span>
<a href="#l13.290"></a><span id="l13.290" class="difflineat">@@ -827,17 +829,17 @@ function FillLinkMenulist(linkMenulist, </span>
<a href="#l13.291"></a><span id="l13.291">       anchorList.push({anchor, sortkey: anchor.toLowerCase()});</span>
<a href="#l13.292"></a><span id="l13.292">       anchorMap[anchor] = true;</span>
<a href="#l13.293"></a><span id="l13.293"> </span>
<a href="#l13.294"></a><span id="l13.294">       // Save nodes in an array so we can create anchor node under it later</span>
<a href="#l13.295"></a><span id="l13.295">       headingsArray[anchor] = heading;</span>
<a href="#l13.296"></a><span id="l13.296">     }</span>
<a href="#l13.297"></a><span id="l13.297">     if (anchorList.length) {</span>
<a href="#l13.298"></a><span id="l13.298">       // case insensitive sort</span>
<a href="#l13.299"></a><span id="l13.299" class="difflineminus">-      anchorList.sort(function compare(a, b) {</span>
<a href="#l13.300"></a><span id="l13.300" class="difflineplus">+      anchorList.sort((a, b) =&gt; {</span>
<a href="#l13.301"></a><span id="l13.301">         if (a.sortkey &lt; b.sortkey) return -1;</span>
<a href="#l13.302"></a><span id="l13.302">         if (a.sortkey &gt; b.sortkey) return 1;</span>
<a href="#l13.303"></a><span id="l13.303">         return 0;</span>
<a href="#l13.304"></a><span id="l13.304">       });</span>
<a href="#l13.305"></a><span id="l13.305"> </span>
<a href="#l13.306"></a><span id="l13.306">       for (i = 0; i &lt; anchorList.length; i++)</span>
<a href="#l13.307"></a><span id="l13.307">         createMenuItem(menupopup, anchorList[i].anchor);</span>
<a href="#l13.308"></a><span id="l13.308">     } else {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdDialogTemplate.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdDialogTemplate.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -1,12 +1,14 @@</span>
<a href="#l14.4"></a><span id="l14.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l14.5"></a><span id="l14.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l14.6"></a><span id="l14.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l14.7"></a><span id="l14.7"> </span>
<a href="#l14.8"></a><span id="l14.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l14.9"></a><span id="l14.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l14.10"></a><span id="l14.10"> </span>
<a href="#l14.11"></a><span id="l14.11"> // Cancel() is in EdDialogCommon.js</span>
<a href="#l14.12"></a><span id="l14.12"> var insertNew = true;</span>
<a href="#l14.13"></a><span id="l14.13"> var tagname = &quot;TAG NAME&quot;;</span>
<a href="#l14.14"></a><span id="l14.14"> </span>
<a href="#l14.15"></a><span id="l14.15"> // dialog initialization code</span>
<a href="#l14.16"></a><span id="l14.16"> </span>
<a href="#l14.17"></a><span id="l14.17"> document.addEventListener(&quot;dialogaccept&quot;, onAccept);</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineat">@@ -16,17 +18,17 @@ function Startup() {</span>
<a href="#l14.19"></a><span id="l14.19">   if (!GetCurrentEditor()) {</span>
<a href="#l14.20"></a><span id="l14.20">     window.close();</span>
<a href="#l14.21"></a><span id="l14.21">     return;</span>
<a href="#l14.22"></a><span id="l14.22">   }</span>
<a href="#l14.23"></a><span id="l14.23">   // gDialog is declared in EdDialogCommon.js</span>
<a href="#l14.24"></a><span id="l14.24">   // Set commonly-used widgets like this:</span>
<a href="#l14.25"></a><span id="l14.25">   gDialog.fooButton = document.getElementById(&quot;fooButton&quot;);</span>
<a href="#l14.26"></a><span id="l14.26"> </span>
<a href="#l14.27"></a><span id="l14.27" class="difflineminus">-  initDialog();</span>
<a href="#l14.28"></a><span id="l14.28" class="difflineplus">+  InitDialog();</span>
<a href="#l14.29"></a><span id="l14.29"> </span>
<a href="#l14.30"></a><span id="l14.30">   // Set window location relative to parent window (based on persisted attributes)</span>
<a href="#l14.31"></a><span id="l14.31">   SetWindowLocation();</span>
<a href="#l14.32"></a><span id="l14.32"> </span>
<a href="#l14.33"></a><span id="l14.33">   // Set focus to first widget in dialog, e.g.:</span>
<a href="#l14.34"></a><span id="l14.34">   SetTextboxFocus(gDialog.fooButton);</span>
<a href="#l14.35"></a><span id="l14.35"> }</span>
<a href="#l14.36"></a><span id="l14.36"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdDictionary.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdDictionary.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -1,13 +1,16 @@</span>
<a href="#l15.4"></a><span id="l15.4"> /* -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l15.5"></a><span id="l15.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l15.6"></a><span id="l15.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l15.7"></a><span id="l15.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l15.8"></a><span id="l15.8"> </span>
<a href="#l15.9"></a><span id="l15.9" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l15.10"></a><span id="l15.10" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l15.11"></a><span id="l15.11" class="difflineplus">+</span>
<a href="#l15.12"></a><span id="l15.12"> var gSpellChecker;</span>
<a href="#l15.13"></a><span id="l15.13"> var gWordToAdd;</span>
<a href="#l15.14"></a><span id="l15.14"> </span>
<a href="#l15.15"></a><span id="l15.15"> function Startup() {</span>
<a href="#l15.16"></a><span id="l15.16">   if (!GetCurrentEditor()) {</span>
<a href="#l15.17"></a><span id="l15.17">     window.close();</span>
<a href="#l15.18"></a><span id="l15.18">     return;</span>
<a href="#l15.19"></a><span id="l15.19">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdFieldSetProps.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdFieldSetProps.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l16.4"></a><span id="l16.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l16.5"></a><span id="l16.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l16.6"></a><span id="l16.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l16.7"></a><span id="l16.7"> </span>
<a href="#l16.8"></a><span id="l16.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l16.9"></a><span id="l16.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l16.10"></a><span id="l16.10" class="difflineplus">+</span>
<a href="#l16.11"></a><span id="l16.11"> var insertNew;</span>
<a href="#l16.12"></a><span id="l16.12"> var fieldsetElement;</span>
<a href="#l16.13"></a><span id="l16.13"> var newLegend;</span>
<a href="#l16.14"></a><span id="l16.14"> var legendElement;</span>
<a href="#l16.15"></a><span id="l16.15"> </span>
<a href="#l16.16"></a><span id="l16.16"> // dialog initialization code</span>
<a href="#l16.17"></a><span id="l16.17"> </span>
<a href="#l16.18"></a><span id="l16.18"> document.addEventListener(&quot;dialogaccept&quot;, onAccept);</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineat">@@ -31,20 +34,20 @@ function Startup() {</span>
<a href="#l16.20"></a><span id="l16.20">     // Find a selected fieldset, or if one is at start or end of selection.</span>
<a href="#l16.21"></a><span id="l16.21">     fieldsetElement = editor.getSelectedElement(kTagName);</span>
<a href="#l16.22"></a><span id="l16.22">     if (!fieldsetElement)</span>
<a href="#l16.23"></a><span id="l16.23">       fieldsetElement = editor.getElementOrParentByTagName(kTagName, editor.selection.anchorNode);</span>
<a href="#l16.24"></a><span id="l16.24">     if (!fieldsetElement)</span>
<a href="#l16.25"></a><span id="l16.25">       fieldsetElement = editor.getElementOrParentByTagName(kTagName, editor.selection.focusNode);</span>
<a href="#l16.26"></a><span id="l16.26">   } catch (e) {}</span>
<a href="#l16.27"></a><span id="l16.27"> </span>
<a href="#l16.28"></a><span id="l16.28" class="difflineminus">-  if (fieldsetElement)</span>
<a href="#l16.29"></a><span id="l16.29" class="difflineplus">+  if (fieldsetElement) {</span>
<a href="#l16.30"></a><span id="l16.30">     // We found an element and don't need to insert one</span>
<a href="#l16.31"></a><span id="l16.31">     insertNew = false;</span>
<a href="#l16.32"></a><span id="l16.32" class="difflineminus">-  else {</span>
<a href="#l16.33"></a><span id="l16.33" class="difflineplus">+  } else {</span>
<a href="#l16.34"></a><span id="l16.34">     insertNew = true;</span>
<a href="#l16.35"></a><span id="l16.35"> </span>
<a href="#l16.36"></a><span id="l16.36">     // We don't have an element selected,</span>
<a href="#l16.37"></a><span id="l16.37">     //  so create one with default attributes</span>
<a href="#l16.38"></a><span id="l16.38">     try {</span>
<a href="#l16.39"></a><span id="l16.39">       fieldsetElement = editor.createElementWithDefaults(kTagName);</span>
<a href="#l16.40"></a><span id="l16.40">     } catch (e) {}</span>
<a href="#l16.41"></a><span id="l16.41"> </span>
<a href="#l16.42"></a><span id="l16.42" class="difflineat">@@ -66,18 +69,19 @@ function Startup() {</span>
<a href="#l16.43"></a><span id="l16.43">     if (legendElement.innerHTML.includes(&quot;&lt;&quot;)) {</span>
<a href="#l16.44"></a><span id="l16.44">       gDialog.editText.checked = false;</span>
<a href="#l16.45"></a><span id="l16.45">       gDialog.editText.disabled = false;</span>
<a href="#l16.46"></a><span id="l16.46">       gDialog.legendText.disabled = true;</span>
<a href="#l16.47"></a><span id="l16.47">       gDialog.editText.addEventListener(&quot;command&quot;,</span>
<a href="#l16.48"></a><span id="l16.48">         () =&gt; Services.prompt.alert(window, GetString(&quot;Alert&quot;), GetString(&quot;EditTextWarning&quot;)),</span>
<a href="#l16.49"></a><span id="l16.49">         {capture: false, once: true});</span>
<a href="#l16.50"></a><span id="l16.50">       gDialog.RemoveFieldSet.focus();</span>
<a href="#l16.51"></a><span id="l16.51" class="difflineminus">-    } else</span>
<a href="#l16.52"></a><span id="l16.52" class="difflineplus">+    } else {</span>
<a href="#l16.53"></a><span id="l16.53">       SetTextboxFocus(gDialog.legendText);</span>
<a href="#l16.54"></a><span id="l16.54" class="difflineplus">+    }</span>
<a href="#l16.55"></a><span id="l16.55">   } else {</span>
<a href="#l16.56"></a><span id="l16.56">     newLegend = true;</span>
<a href="#l16.57"></a><span id="l16.57"> </span>
<a href="#l16.58"></a><span id="l16.58">     // We don't have an element selected,</span>
<a href="#l16.59"></a><span id="l16.59">     //  so create one with default attributes</span>
<a href="#l16.60"></a><span id="l16.60"> </span>
<a href="#l16.61"></a><span id="l16.61">     legendElement = editor.createElementWithDefaults(&quot;legend&quot;);</span>
<a href="#l16.62"></a><span id="l16.62">     if (!legendElement) {</span>
<a href="#l16.63"></a><span id="l16.63" class="difflineat">@@ -143,18 +147,19 @@ function onAccept() {</span>
<a href="#l16.64"></a><span id="l16.64">       editor.setShouldTxnSetSelection(false);</span>
<a href="#l16.65"></a><span id="l16.65"> </span>
<a href="#l16.66"></a><span id="l16.66">       if (gDialog.legendText.value) {</span>
<a href="#l16.67"></a><span id="l16.67">         if (newLegend)</span>
<a href="#l16.68"></a><span id="l16.68">           editor.insertNode(legendElement, fieldsetElement, 0, true);</span>
<a href="#l16.69"></a><span id="l16.69">         else while (legendElement.firstChild)</span>
<a href="#l16.70"></a><span id="l16.70">           editor.deleteNode(legendElement.lastChild);</span>
<a href="#l16.71"></a><span id="l16.71">         editor.insertNode(editor.document.createTextNode(gDialog.legendText.value), legendElement, 0);</span>
<a href="#l16.72"></a><span id="l16.72" class="difflineminus">-      } else if (!newLegend)</span>
<a href="#l16.73"></a><span id="l16.73" class="difflineplus">+      } else if (!newLegend) {</span>
<a href="#l16.74"></a><span id="l16.74">         editor.deleteNode(legendElement);</span>
<a href="#l16.75"></a><span id="l16.75" class="difflineplus">+      }</span>
<a href="#l16.76"></a><span id="l16.76"> </span>
<a href="#l16.77"></a><span id="l16.77">       editor.setShouldTxnSetSelection(true);</span>
<a href="#l16.78"></a><span id="l16.78">     }</span>
<a href="#l16.79"></a><span id="l16.79">   } finally {</span>
<a href="#l16.80"></a><span id="l16.80">     editor.endTransaction();</span>
<a href="#l16.81"></a><span id="l16.81">   }</span>
<a href="#l16.82"></a><span id="l16.82"> </span>
<a href="#l16.83"></a><span id="l16.83">   SaveWindowLocation();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdFormProps.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdFormProps.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l17.4"></a><span id="l17.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l17.5"></a><span id="l17.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l17.6"></a><span id="l17.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l17.7"></a><span id="l17.7"> </span>
<a href="#l17.8"></a><span id="l17.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l17.9"></a><span id="l17.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l17.10"></a><span id="l17.10" class="difflineplus">+</span>
<a href="#l17.11"></a><span id="l17.11"> var gForm;</span>
<a href="#l17.12"></a><span id="l17.12"> var insertNew;</span>
<a href="#l17.13"></a><span id="l17.13"> var formElement;</span>
<a href="#l17.14"></a><span id="l17.14"> var formActionWarning;</span>
<a href="#l17.15"></a><span id="l17.15"> </span>
<a href="#l17.16"></a><span id="l17.16"> document.addEventListener(&quot;dialogaccept&quot;, onAccept);</span>
<a href="#l17.17"></a><span id="l17.17"> document.addEventListener(&quot;dialogcancel&quot;, onCancel);</span>
<a href="#l17.18"></a><span id="l17.18"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdHLineProps.js</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdHLineProps.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l18.4"></a><span id="l18.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l18.5"></a><span id="l18.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l18.6"></a><span id="l18.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l18.7"></a><span id="l18.7"> </span>
<a href="#l18.8"></a><span id="l18.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l18.9"></a><span id="l18.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l18.10"></a><span id="l18.10" class="difflineplus">+</span>
<a href="#l18.11"></a><span id="l18.11"> var tagName = &quot;hr&quot;;</span>
<a href="#l18.12"></a><span id="l18.12"> var gHLineElement;</span>
<a href="#l18.13"></a><span id="l18.13"> var width;</span>
<a href="#l18.14"></a><span id="l18.14"> var height;</span>
<a href="#l18.15"></a><span id="l18.15"> var align;</span>
<a href="#l18.16"></a><span id="l18.16"> var shading;</span>
<a href="#l18.17"></a><span id="l18.17"> const gMaxHRSize = 1000; // This is hard-coded in nsHTMLHRElement::StringToAttribute()</span>
<a href="#l18.18"></a><span id="l18.18"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdImageDialog.js</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdImageDialog.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -7,34 +7,37 @@</span>
<a href="#l19.4"></a><span id="l19.4">  When there's no alt text, we always write 'alt=&quot;&quot;' as the attribute, since &quot;alt&quot; is a required attribute.</span>
<a href="#l19.5"></a><span id="l19.5">  We allow users to not have alt text by checking a &quot;Don't use alterate text&quot; radio button,</span>
<a href="#l19.6"></a><span id="l19.6">  and we don't accept spaces as valid alt text. A space used to be required to avoid the error message</span>
<a href="#l19.7"></a><span id="l19.7">  if user didn't enter alt text, but is unnecessary now that we no longer annoy the user</span>
<a href="#l19.8"></a><span id="l19.8">  with the error dialog if alt=&quot;&quot; is present on an img element.</span>
<a href="#l19.9"></a><span id="l19.9">  We trim all spaces at the beginning and end of user's alt text</span>
<a href="#l19.10"></a><span id="l19.10"> */</span>
<a href="#l19.11"></a><span id="l19.11"> </span>
<a href="#l19.12"></a><span id="l19.12" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineplus">+</span>
<a href="#l19.15"></a><span id="l19.15"> var gInsertNewImage = true;</span>
<a href="#l19.16"></a><span id="l19.16"> var gDoAltTextError = false;</span>
<a href="#l19.17"></a><span id="l19.17"> var gConstrainOn = false;</span>
<a href="#l19.18"></a><span id="l19.18"> // Note used in current version, but these are set correctly</span>
<a href="#l19.19"></a><span id="l19.19"> //  and could be used to reset width and height used for constrain ratio</span>
<a href="#l19.20"></a><span id="l19.20"> var gConstrainWidth  = 0;</span>
<a href="#l19.21"></a><span id="l19.21"> var gConstrainHeight = 0;</span>
<a href="#l19.22"></a><span id="l19.22"> var imageElement;</span>
<a href="#l19.23"></a><span id="l19.23"> var gImageMap = 0;</span>
<a href="#l19.24"></a><span id="l19.24"> var gCanRemoveImageMap = false;</span>
<a href="#l19.25"></a><span id="l19.25"> var gRemoveImageMap = false;</span>
<a href="#l19.26"></a><span id="l19.26"> var gImageMapDisabled = false;</span>
<a href="#l19.27"></a><span id="l19.27"> var gActualWidth = &quot;&quot;;</span>
<a href="#l19.28"></a><span id="l19.28"> var gActualHeight = &quot;&quot;;</span>
<a href="#l19.29"></a><span id="l19.29"> var gOriginalSrc = &quot;&quot;;</span>
<a href="#l19.30"></a><span id="l19.30" class="difflineminus">-var gHaveDocumentUrl = false;</span>
<a href="#l19.31"></a><span id="l19.31"> var gTimerID;</span>
<a href="#l19.32"></a><span id="l19.32"> var gValidateTab;</span>
<a href="#l19.33"></a><span id="l19.33" class="difflineplus">+var gInsertNewIMap;</span>
<a href="#l19.34"></a><span id="l19.34"> </span>
<a href="#l19.35"></a><span id="l19.35"> // These must correspond to values in EditorDialog.css for each theme</span>
<a href="#l19.36"></a><span id="l19.36"> // (unfortunately, setting &quot;style&quot; attribute here doesn't work!)</span>
<a href="#l19.37"></a><span id="l19.37"> var gPreviewImageWidth = 80;</span>
<a href="#l19.38"></a><span id="l19.38"> var gPreviewImageHeight = 50;</span>
<a href="#l19.39"></a><span id="l19.39"> </span>
<a href="#l19.40"></a><span id="l19.40"> // dialog initialization code</span>
<a href="#l19.41"></a><span id="l19.41"> </span>
<a href="#l19.42"></a><span id="l19.42" class="difflineat">@@ -104,18 +107,18 @@ function InitImage() {</span>
<a href="#l19.43"></a><span id="l19.43">                     &quot;width&quot;, &quot;widthUnitsMenulist&quot;, gPixel);</span>
<a href="#l19.44"></a><span id="l19.44">   var height = InitPixelOrPercentMenulist(globalElement,</span>
<a href="#l19.45"></a><span id="l19.45">                     gInsertNewImage ? null : imageElement,</span>
<a href="#l19.46"></a><span id="l19.46">                     &quot;height&quot;, &quot;heightUnitsMenulist&quot;, gPixel);</span>
<a href="#l19.47"></a><span id="l19.47"> </span>
<a href="#l19.48"></a><span id="l19.48">   // Set actual radio button if both set values are the same as actual</span>
<a href="#l19.49"></a><span id="l19.49">   SetSizeWidgets(width, height);</span>
<a href="#l19.50"></a><span id="l19.50"> </span>
<a href="#l19.51"></a><span id="l19.51" class="difflineminus">-  gDialog.widthInput.value  = gConstrainWidth = width ? width : (gActualWidth ? gActualWidth : &quot;&quot;);</span>
<a href="#l19.52"></a><span id="l19.52" class="difflineminus">-  gDialog.heightInput.value = gConstrainHeight = height ? height : (gActualHeight ? gActualHeight : &quot;&quot;);</span>
<a href="#l19.53"></a><span id="l19.53" class="difflineplus">+  gDialog.widthInput.value  = gConstrainWidth = (width || gActualWidth || &quot;&quot;);</span>
<a href="#l19.54"></a><span id="l19.54" class="difflineplus">+  gDialog.heightInput.value = gConstrainHeight = (height || gActualHeight || &quot;&quot;);</span>
<a href="#l19.55"></a><span id="l19.55"> </span>
<a href="#l19.56"></a><span id="l19.56">   // set spacing editfields</span>
<a href="#l19.57"></a><span id="l19.57">   gDialog.imagelrInput.value = globalElement.getAttribute(&quot;hspace&quot;);</span>
<a href="#l19.58"></a><span id="l19.58">   gDialog.imagetbInput.value = globalElement.getAttribute(&quot;vspace&quot;);</span>
<a href="#l19.59"></a><span id="l19.59"> </span>
<a href="#l19.60"></a><span id="l19.60">   // dialog.border.value       = globalElement.getAttribute(&quot;border&quot;);</span>
<a href="#l19.61"></a><span id="l19.61">   var bv = GetHTMLOrCSSStyleValue(globalElement, &quot;border&quot;, &quot;border-top-width&quot;);</span>
<a href="#l19.62"></a><span id="l19.62">   if (bv.includes(&quot;px&quot;)) {</span>
<a href="#l19.63"></a><span id="l19.63" class="difflineat">@@ -130,19 +133,16 @@ function InitImage() {</span>
<a href="#l19.64"></a><span id="l19.64">   }</span>
<a href="#l19.65"></a><span id="l19.65">   gDialog.border.value = bv;</span>
<a href="#l19.66"></a><span id="l19.66"> </span>
<a href="#l19.67"></a><span id="l19.67">   // Get alignment setting</span>
<a href="#l19.68"></a><span id="l19.68">   var align = globalElement.getAttribute(&quot;align&quot;);</span>
<a href="#l19.69"></a><span id="l19.69">   if (align)</span>
<a href="#l19.70"></a><span id="l19.70">     align = align.toLowerCase();</span>
<a href="#l19.71"></a><span id="l19.71"> </span>
<a href="#l19.72"></a><span id="l19.72" class="difflineminus">-  var imgClass;</span>
<a href="#l19.73"></a><span id="l19.73" class="difflineminus">-  var textID;</span>
<a href="#l19.74"></a><span id="l19.74" class="difflineminus">-</span>
<a href="#l19.75"></a><span id="l19.75">   switch (align) {</span>
<a href="#l19.76"></a><span id="l19.76">     case &quot;top&quot;:</span>
<a href="#l19.77"></a><span id="l19.77">     case &quot;middle&quot;:</span>
<a href="#l19.78"></a><span id="l19.78">     case &quot;right&quot;:</span>
<a href="#l19.79"></a><span id="l19.79">     case &quot;left&quot;:</span>
<a href="#l19.80"></a><span id="l19.80">       gDialog.alignTypeSelect.value = align;</span>
<a href="#l19.81"></a><span id="l19.81">       break;</span>
<a href="#l19.82"></a><span id="l19.82">     default:  // Default or &quot;bottom&quot;</span>
<a href="#l19.83"></a><span id="l19.83" class="difflineat">@@ -427,17 +427,17 @@ function ValidateImage() {</span>
<a href="#l19.84"></a><span id="l19.84">   if (isImageDataShortened(src)) {</span>
<a href="#l19.85"></a><span id="l19.85">     src = restoredImageData(gDialog.srcInput);</span>
<a href="#l19.86"></a><span id="l19.86">   } else {</span>
<a href="#l19.87"></a><span id="l19.87">     var checkbox = document.getElementById(&quot;MakeRelativeCheckbox&quot;);</span>
<a href="#l19.88"></a><span id="l19.88">     try {</span>
<a href="#l19.89"></a><span id="l19.89">       if (checkbox &amp;&amp; !checkbox.checked) {</span>
<a href="#l19.90"></a><span id="l19.90">         src = Services.uriFixup.createFixupURI(src, Ci.nsIURIFixup.FIXUP_FLAG_NONE).spec;</span>
<a href="#l19.91"></a><span id="l19.91">       }</span>
<a href="#l19.92"></a><span id="l19.92" class="difflineminus">-    } catch (e) { }</span>
<a href="#l19.93"></a><span id="l19.93" class="difflineplus">+    } catch (e) {}</span>
<a href="#l19.94"></a><span id="l19.94"> </span>
<a href="#l19.95"></a><span id="l19.95">     globalElement.setAttribute(&quot;src&quot;, src);</span>
<a href="#l19.96"></a><span id="l19.96">   }</span>
<a href="#l19.97"></a><span id="l19.97"> </span>
<a href="#l19.98"></a><span id="l19.98">   let title = gDialog.titleInput.value.trim();</span>
<a href="#l19.99"></a><span id="l19.99">   if (title)</span>
<a href="#l19.100"></a><span id="l19.100">     globalElement.setAttribute(&quot;title&quot;, title);</span>
<a href="#l19.101"></a><span id="l19.101">   else</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdImageLinkLoader.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdImageLinkLoader.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l20.4"></a><span id="l20.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l20.5"></a><span id="l20.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l20.6"></a><span id="l20.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l20.7"></a><span id="l20.7"> </span>
<a href="#l20.8"></a><span id="l20.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l20.9"></a><span id="l20.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l20.10"></a><span id="l20.10" class="difflineplus">+</span>
<a href="#l20.11"></a><span id="l20.11"> var {Services} = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l20.12"></a><span id="l20.12"> </span>
<a href="#l20.13"></a><span id="l20.13"> var gMsgCompProcessLink = false;</span>
<a href="#l20.14"></a><span id="l20.14"> var gMsgCompInputElement = null;</span>
<a href="#l20.15"></a><span id="l20.15"> var gMsgCompPrevInputValue = null;</span>
<a href="#l20.16"></a><span id="l20.16"> var gMsgCompPrevMozDoNotSendAttribute;</span>
<a href="#l20.17"></a><span id="l20.17"> var gMsgCompAttachSourceElement = null;</span>
<a href="#l20.18"></a><span id="l20.18"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdImageProps.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdImageProps.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -1,12 +1,16 @@</span>
<a href="#l21.4"></a><span id="l21.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l21.5"></a><span id="l21.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l21.6"></a><span id="l21.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l21.7"></a><span id="l21.7"> </span>
<a href="#l21.8"></a><span id="l21.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l21.9"></a><span id="l21.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l21.10"></a><span id="l21.10" class="difflineplus">+/* import-globals-from EdImageDialog.js */</span>
<a href="#l21.11"></a><span id="l21.11" class="difflineplus">+</span>
<a href="#l21.12"></a><span id="l21.12"> var gAnchorElement = null;</span>
<a href="#l21.13"></a><span id="l21.13"> var gLinkElement = null;</span>
<a href="#l21.14"></a><span id="l21.14"> var gOriginalHref = &quot;&quot;;</span>
<a href="#l21.15"></a><span id="l21.15"> var gHNodeArray = {};</span>
<a href="#l21.16"></a><span id="l21.16"> </span>
<a href="#l21.17"></a><span id="l21.17"> // dialog initialization code</span>
<a href="#l21.18"></a><span id="l21.18"> </span>
<a href="#l21.19"></a><span id="l21.19"> document.addEventListener(&quot;dialogaccept&quot;, onAccept);</span>
<a href="#l21.20"></a><span id="l21.20" class="difflineat">@@ -99,18 +103,19 @@ function Startup() {</span>
<a href="#l21.21"></a><span id="l21.21">   gDialog.constrainCheckbox.checked =</span>
<a href="#l21.22"></a><span id="l21.22">     gDialog.widthUnitsMenulist.selectedIndex == 0 &amp;&amp;</span>
<a href="#l21.23"></a><span id="l21.23">     gDialog.heightUnitsMenulist.selectedIndex == 0;</span>
<a href="#l21.24"></a><span id="l21.24"> </span>
<a href="#l21.25"></a><span id="l21.25">   // Start in &quot;Link&quot; tab if 2nd argument is true</span>
<a href="#l21.26"></a><span id="l21.26">   if (gDialog.linkTab &amp;&amp; &quot;arguments&quot; in window &amp;&amp; window.arguments[1]) {</span>
<a href="#l21.27"></a><span id="l21.27">     document.getElementById(&quot;TabBox&quot;).selectedTab = gDialog.linkTab;</span>
<a href="#l21.28"></a><span id="l21.28">     SetTextboxFocus(gDialog.hrefInput);</span>
<a href="#l21.29"></a><span id="l21.29" class="difflineminus">-  } else</span>
<a href="#l21.30"></a><span id="l21.30" class="difflineplus">+  } else {</span>
<a href="#l21.31"></a><span id="l21.31">     SetTextboxFocus(gDialog.srcInput);</span>
<a href="#l21.32"></a><span id="l21.32" class="difflineplus">+  }</span>
<a href="#l21.33"></a><span id="l21.33"> </span>
<a href="#l21.34"></a><span id="l21.34">   SetWindowLocation();</span>
<a href="#l21.35"></a><span id="l21.35"> }</span>
<a href="#l21.36"></a><span id="l21.36"> </span>
<a href="#l21.37"></a><span id="l21.37"> // Set dialog widgets with attribute data</span>
<a href="#l21.38"></a><span id="l21.38"> // We get them from globalElement copy so this can be used</span>
<a href="#l21.39"></a><span id="l21.39"> //   by AdvancedEdit(), which is shared by all property dialogs</span>
<a href="#l21.40"></a><span id="l21.40"> function InitDialog() {</span>
<a href="#l21.41"></a><span id="l21.41" class="difflineat">@@ -200,27 +205,29 @@ function onAccept(event) {</span>
<a href="#l21.42"></a><span id="l21.42">       }</span>
<a href="#l21.43"></a><span id="l21.43"> </span>
<a href="#l21.44"></a><span id="l21.44">       // If inside a link, always write the 'border' attribute</span>
<a href="#l21.45"></a><span id="l21.45">       if (href) {</span>
<a href="#l21.46"></a><span id="l21.46">         if (gDialog.showLinkBorder.checked) {</span>
<a href="#l21.47"></a><span id="l21.47">           // Use default = 2 if border attribute is empty</span>
<a href="#l21.48"></a><span id="l21.48">           if (!globalElement.hasAttribute(&quot;border&quot;))</span>
<a href="#l21.49"></a><span id="l21.49">             globalElement.setAttribute(&quot;border&quot;, &quot;2&quot;);</span>
<a href="#l21.50"></a><span id="l21.50" class="difflineminus">-        } else</span>
<a href="#l21.51"></a><span id="l21.51" class="difflineplus">+        } else {</span>
<a href="#l21.52"></a><span id="l21.52">           globalElement.setAttribute(&quot;border&quot;, &quot;0&quot;);</span>
<a href="#l21.53"></a><span id="l21.53" class="difflineplus">+        }</span>
<a href="#l21.54"></a><span id="l21.54">       }</span>
<a href="#l21.55"></a><span id="l21.55"> </span>
<a href="#l21.56"></a><span id="l21.56">       if (gInsertNewImage) {</span>
<a href="#l21.57"></a><span id="l21.57">         if (href) {</span>
<a href="#l21.58"></a><span id="l21.58">           gLinkElement.appendChild(imageElement);</span>
<a href="#l21.59"></a><span id="l21.59">           editor.insertElementAtSelection(gLinkElement, true);</span>
<a href="#l21.60"></a><span id="l21.60" class="difflineminus">-        } else</span>
<a href="#l21.61"></a><span id="l21.61" class="difflineplus">+        } else {</span>
<a href="#l21.62"></a><span id="l21.62">           // 'true' means delete the selection before inserting</span>
<a href="#l21.63"></a><span id="l21.63">           editor.insertElementAtSelection(imageElement, true);</span>
<a href="#l21.64"></a><span id="l21.64" class="difflineplus">+        }</span>
<a href="#l21.65"></a><span id="l21.65">       }</span>
<a href="#l21.66"></a><span id="l21.66"> </span>
<a href="#l21.67"></a><span id="l21.67">       // Check to see if the link was to a heading</span>
<a href="#l21.68"></a><span id="l21.68">       // Do this last because it moves the caret (BAD!)</span>
<a href="#l21.69"></a><span id="l21.69">       if (href in gHNodeArray) {</span>
<a href="#l21.70"></a><span id="l21.70">         var anchorNode = editor.createElementWithDefaults(&quot;a&quot;);</span>
<a href="#l21.71"></a><span id="l21.71">         if (anchorNode) {</span>
<a href="#l21.72"></a><span id="l21.72">           anchorNode.name = href.substr(1);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdInputImage.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdInputImage.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -1,12 +1,16 @@</span>
<a href="#l22.4"></a><span id="l22.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l22.5"></a><span id="l22.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l22.6"></a><span id="l22.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l22.7"></a><span id="l22.7"> </span>
<a href="#l22.8"></a><span id="l22.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l22.9"></a><span id="l22.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l22.10"></a><span id="l22.10" class="difflineplus">+/* import-globals-from EdImageDialog.js */</span>
<a href="#l22.11"></a><span id="l22.11" class="difflineplus">+</span>
<a href="#l22.12"></a><span id="l22.12"> // dialog initialization code</span>
<a href="#l22.13"></a><span id="l22.13"> </span>
<a href="#l22.14"></a><span id="l22.14"> document.addEventListener(&quot;dialogaccept&quot;, onAccept);</span>
<a href="#l22.15"></a><span id="l22.15"> document.addEventListener(&quot;dialogcancel&quot;, onCancel);</span>
<a href="#l22.16"></a><span id="l22.16"> </span>
<a href="#l22.17"></a><span id="l22.17"> function Startup() {</span>
<a href="#l22.18"></a><span id="l22.18">   var editor = GetCurrentEditor();</span>
<a href="#l22.19"></a><span id="l22.19">   if (!editor) {</span>
<a href="#l22.20"></a><span id="l22.20" class="difflineat">@@ -48,17 +52,17 @@ function Startup() {</span>
<a href="#l22.21"></a><span id="l22.21">     var imgElement;</span>
<a href="#l22.22"></a><span id="l22.22">     try {</span>
<a href="#l22.23"></a><span id="l22.23">       imgElement = editor.getSelectedElement(&quot;img&quot;);</span>
<a href="#l22.24"></a><span id="l22.24">     } catch (e) {}</span>
<a href="#l22.25"></a><span id="l22.25"> </span>
<a href="#l22.26"></a><span id="l22.26">     if (imgElement) {</span>
<a href="#l22.27"></a><span id="l22.27">       // We found an image element, convert it to an input type=&quot;image&quot;</span>
<a href="#l22.28"></a><span id="l22.28">       var attributes = [&quot;src&quot;, &quot;alt&quot;, &quot;width&quot;, &quot;height&quot;, &quot;hspace&quot;, &quot;vspace&quot;, &quot;border&quot;, &quot;align&quot;, &quot;usemap&quot;, &quot;ismap&quot;];</span>
<a href="#l22.29"></a><span id="l22.29" class="difflineminus">-      for (i in attributes)</span>
<a href="#l22.30"></a><span id="l22.30" class="difflineplus">+      for (let i in attributes)</span>
<a href="#l22.31"></a><span id="l22.31">         imageElement.setAttribute(attributes[i], imgElement.getAttribute(attributes[i]));</span>
<a href="#l22.32"></a><span id="l22.32">     }</span>
<a href="#l22.33"></a><span id="l22.33">   }</span>
<a href="#l22.34"></a><span id="l22.34"> </span>
<a href="#l22.35"></a><span id="l22.35">   // Make a copy to use for AdvancedEdit</span>
<a href="#l22.36"></a><span id="l22.36">   globalElement = imageElement.cloneNode(false);</span>
<a href="#l22.37"></a><span id="l22.37"> </span>
<a href="#l22.38"></a><span id="l22.38">   // We only need to test for this once per dialog load</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdInputProps.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdInputProps.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l23.4"></a><span id="l23.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l23.5"></a><span id="l23.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l23.6"></a><span id="l23.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l23.7"></a><span id="l23.7"> </span>
<a href="#l23.8"></a><span id="l23.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l23.9"></a><span id="l23.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l23.10"></a><span id="l23.10" class="difflineplus">+</span>
<a href="#l23.11"></a><span id="l23.11"> var insertNew;</span>
<a href="#l23.12"></a><span id="l23.12"> var inputElement;</span>
<a href="#l23.13"></a><span id="l23.13"> </span>
<a href="#l23.14"></a><span id="l23.14"> // dialog initialization code</span>
<a href="#l23.15"></a><span id="l23.15"> </span>
<a href="#l23.16"></a><span id="l23.16"> document.addEventListener(&quot;dialogaccept&quot;, onAccept);</span>
<a href="#l23.17"></a><span id="l23.17"> document.addEventListener(&quot;dialogcancel&quot;, onCancel);</span>
<a href="#l23.18"></a><span id="l23.18"> </span>
<a href="#l23.19"></a><span id="l23.19" class="difflineat">@@ -42,20 +45,20 @@ function Startup() {</span>
<a href="#l23.20"></a><span id="l23.20">   };</span>
<a href="#l23.21"></a><span id="l23.21"> </span>
<a href="#l23.22"></a><span id="l23.22">   // Get a single selected input element</span>
<a href="#l23.23"></a><span id="l23.23">   const kTagName = &quot;input&quot;;</span>
<a href="#l23.24"></a><span id="l23.24">   try {</span>
<a href="#l23.25"></a><span id="l23.25">     inputElement = editor.getSelectedElement(kTagName);</span>
<a href="#l23.26"></a><span id="l23.26">   } catch (e) {}</span>
<a href="#l23.27"></a><span id="l23.27"> </span>
<a href="#l23.28"></a><span id="l23.28" class="difflineminus">-  if (inputElement)</span>
<a href="#l23.29"></a><span id="l23.29" class="difflineplus">+  if (inputElement) {</span>
<a href="#l23.30"></a><span id="l23.30">     // We found an element and don't need to insert one</span>
<a href="#l23.31"></a><span id="l23.31">     insertNew = false;</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineminus">-  else {</span>
<a href="#l23.33"></a><span id="l23.33" class="difflineplus">+  } else {</span>
<a href="#l23.34"></a><span id="l23.34">     insertNew = true;</span>
<a href="#l23.35"></a><span id="l23.35"> </span>
<a href="#l23.36"></a><span id="l23.36">     // We don't have an element selected,</span>
<a href="#l23.37"></a><span id="l23.37">     //  so create one with default attributes</span>
<a href="#l23.38"></a><span id="l23.38">     try {</span>
<a href="#l23.39"></a><span id="l23.39">       inputElement = editor.createElementWithDefaults(kTagName);</span>
<a href="#l23.40"></a><span id="l23.40">     } catch (e) {}</span>
<a href="#l23.41"></a><span id="l23.41"> </span>
<a href="#l23.42"></a><span id="l23.42" class="difflineat">@@ -66,20 +69,21 @@ function Startup() {</span>
<a href="#l23.43"></a><span id="l23.43">     }</span>
<a href="#l23.44"></a><span id="l23.44"> </span>
<a href="#l23.45"></a><span id="l23.45">     var imgElement = editor.getSelectedElement(&quot;img&quot;);</span>
<a href="#l23.46"></a><span id="l23.46">     if (imgElement) {</span>
<a href="#l23.47"></a><span id="l23.47">       // We found an image element, convert it to an input type=&quot;image&quot;</span>
<a href="#l23.48"></a><span id="l23.48">       inputElement.setAttribute(&quot;type&quot;, &quot;image&quot;);</span>
<a href="#l23.49"></a><span id="l23.49"> </span>
<a href="#l23.50"></a><span id="l23.50">       var attributes = [&quot;src&quot;, &quot;alt&quot;, &quot;width&quot;, &quot;height&quot;, &quot;hspace&quot;, &quot;vspace&quot;, &quot;border&quot;, &quot;align&quot;];</span>
<a href="#l23.51"></a><span id="l23.51" class="difflineminus">-      for (i in attributes)</span>
<a href="#l23.52"></a><span id="l23.52" class="difflineplus">+      for (let i in attributes)</span>
<a href="#l23.53"></a><span id="l23.53">         inputElement.setAttribute(attributes[i], imgElement.getAttribute(attributes[i]));</span>
<a href="#l23.54"></a><span id="l23.54" class="difflineminus">-    } else</span>
<a href="#l23.55"></a><span id="l23.55" class="difflineplus">+    } else {</span>
<a href="#l23.56"></a><span id="l23.56">       inputElement.setAttribute(&quot;value&quot;, GetSelectionAsText());</span>
<a href="#l23.57"></a><span id="l23.57" class="difflineplus">+    }</span>
<a href="#l23.58"></a><span id="l23.58">   }</span>
<a href="#l23.59"></a><span id="l23.59"> </span>
<a href="#l23.60"></a><span id="l23.60">   // Make a copy to use for AdvancedEdit</span>
<a href="#l23.61"></a><span id="l23.61">   globalElement = inputElement.cloneNode(false);</span>
<a href="#l23.62"></a><span id="l23.62"> </span>
<a href="#l23.63"></a><span id="l23.63">   InitDialog();</span>
<a href="#l23.64"></a><span id="l23.64"> </span>
<a href="#l23.65"></a><span id="l23.65">   InitMoreFewer();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdInsSrc.js</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdInsSrc.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -1,15 +1,18 @@</span>
<a href="#l24.4"></a><span id="l24.4"> /* -*- Mode: Java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l24.5"></a><span id="l24.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l24.6"></a><span id="l24.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l24.7"></a><span id="l24.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l24.8"></a><span id="l24.8"> </span>
<a href="#l24.9"></a><span id="l24.9"> /* Insert Source HTML dialog */</span>
<a href="#l24.10"></a><span id="l24.10"> </span>
<a href="#l24.11"></a><span id="l24.11" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+</span>
<a href="#l24.14"></a><span id="l24.14"> var gFullDataStrings = new Map();</span>
<a href="#l24.15"></a><span id="l24.15"> var gShortDataStrings = new Map();</span>
<a href="#l24.16"></a><span id="l24.16"> var gListenerAttached = false;</span>
<a href="#l24.17"></a><span id="l24.17"> </span>
<a href="#l24.18"></a><span id="l24.18"> document.addEventListener(&quot;dialogaccept&quot;, onAccept);</span>
<a href="#l24.19"></a><span id="l24.19"> document.addEventListener(&quot;dialogcancel&quot;, onCancel);</span>
<a href="#l24.20"></a><span id="l24.20"> </span>
<a href="#l24.21"></a><span id="l24.21"> function Startup() {</span>
<a href="#l24.22"></a><span id="l24.22" class="difflineat">@@ -49,16 +52,17 @@ function replaceDataURIs(input) {</span>
<a href="#l24.23"></a><span id="l24.23">   return input.replace(/(data:.+;base64,)([^&quot;' &gt;]+)/gi,</span>
<a href="#l24.24"></a><span id="l24.24">     function(match, nonDataPart, dataPart) {</span>
<a href="#l24.25"></a><span id="l24.25">       if (gShortDataStrings.has(dataPart)) {</span>
<a href="#l24.26"></a><span id="l24.26">           // We found the exact same data URI, just return the shortened URI.</span>
<a href="#l24.27"></a><span id="l24.27">           return nonDataPart + gShortDataStrings.get(dataPart);</span>
<a href="#l24.28"></a><span id="l24.28">       }</span>
<a href="#l24.29"></a><span id="l24.29"> </span>
<a href="#l24.30"></a><span id="l24.30">       let l = 5;</span>
<a href="#l24.31"></a><span id="l24.31" class="difflineplus">+      let key;</span>
<a href="#l24.32"></a><span id="l24.32">       // Normally we insert the ellipsis after five characters but if it's not unique</span>
<a href="#l24.33"></a><span id="l24.33">       // we include more data.</span>
<a href="#l24.34"></a><span id="l24.34">       do {</span>
<a href="#l24.35"></a><span id="l24.35">         key = dataPart.substr(0, l) + &quot;&quot; + dataPart.substr(dataPart.length - 10);</span>
<a href="#l24.36"></a><span id="l24.36">         l++;</span>
<a href="#l24.37"></a><span id="l24.37">       } while (gFullDataStrings.has(key) &amp;&amp; l &lt; dataPart.length - 10);</span>
<a href="#l24.38"></a><span id="l24.38">       gFullDataStrings.set(key, dataPart);</span>
<a href="#l24.39"></a><span id="l24.39">       gShortDataStrings.set(dataPart, key);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdInsertChars.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdInsertChars.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l25.4"></a><span id="l25.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l25.5"></a><span id="l25.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l25.6"></a><span id="l25.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l25.7"></a><span id="l25.7"> </span>
<a href="#l25.8"></a><span id="l25.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l25.9"></a><span id="l25.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l25.10"></a><span id="l25.10" class="difflineplus">+</span>
<a href="#l25.11"></a><span id="l25.11"> // ------------------------------------------------------------------</span>
<a href="#l25.12"></a><span id="l25.12"> // From Unicode 3.0 Page 54. 3.11 Conjoining Jamo Behavior</span>
<a href="#l25.13"></a><span id="l25.13"> var SBase = 0xac00;</span>
<a href="#l25.14"></a><span id="l25.14"> var LBase = 0x1100;</span>
<a href="#l25.15"></a><span id="l25.15"> var VBase = 0x1161;</span>
<a href="#l25.16"></a><span id="l25.16"> var TBase = 0x11A7;</span>
<a href="#l25.17"></a><span id="l25.17"> var LCount = 19;</span>
<a href="#l25.18"></a><span id="l25.18"> var VCount = 21;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdInsertMath.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdInsertMath.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -1,15 +1,18 @@</span>
<a href="#l26.4"></a><span id="l26.4"> /* -*- Mode: Java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l26.5"></a><span id="l26.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l26.6"></a><span id="l26.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l26.7"></a><span id="l26.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l26.8"></a><span id="l26.8"> </span>
<a href="#l26.9"></a><span id="l26.9"> /* Insert MathML dialog */</span>
<a href="#l26.10"></a><span id="l26.10"> </span>
<a href="#l26.11"></a><span id="l26.11" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+</span>
<a href="#l26.14"></a><span id="l26.14"> var XULNS = &quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;;</span>
<a href="#l26.15"></a><span id="l26.15"> </span>
<a href="#l26.16"></a><span id="l26.16"> document.addEventListener(&quot;dialogaccept&quot;, onAccept);</span>
<a href="#l26.17"></a><span id="l26.17"> document.addEventListener(&quot;dialogcancel&quot;, onCancel);</span>
<a href="#l26.18"></a><span id="l26.18"> </span>
<a href="#l26.19"></a><span id="l26.19"> function Startup() {</span>
<a href="#l26.20"></a><span id="l26.20">   var editor = GetCurrentEditor();</span>
<a href="#l26.21"></a><span id="l26.21">   if (!editor) {</span>
<a href="#l26.22"></a><span id="l26.22" class="difflineat">@@ -27,19 +30,18 @@ function Startup() {</span>
<a href="#l26.23"></a><span id="l26.23"> </span>
<a href="#l26.24"></a><span id="l26.24">   // Set initial focus</span>
<a href="#l26.25"></a><span id="l26.25">   gDialog.input.focus();</span>
<a href="#l26.26"></a><span id="l26.26"> </span>
<a href="#l26.27"></a><span id="l26.27">   // Load TeXZilla</span>
<a href="#l26.28"></a><span id="l26.28">   // TeXZilla.js contains non-ASCII characters and explicitly sets</span>
<a href="#l26.29"></a><span id="l26.29">   // window.TeXZilla, so we have to specify the charset parameter but don't</span>
<a href="#l26.30"></a><span id="l26.30">   // need to worry about the targetObj parameter.</span>
<a href="#l26.31"></a><span id="l26.31" class="difflineminus">-  Cc[&quot;@mozilla.org/moz/jssubscript-loader;1&quot;]</span>
<a href="#l26.32"></a><span id="l26.32" class="difflineminus">-    .getService(Ci.mozIJSSubScriptLoader)</span>
<a href="#l26.33"></a><span id="l26.33" class="difflineminus">-    .loadSubScript(&quot;chrome://editor/content/TeXZilla.js&quot;, {}, &quot;UTF-8&quot;);</span>
<a href="#l26.34"></a><span id="l26.34" class="difflineplus">+  /* globals TeXZilla */</span>
<a href="#l26.35"></a><span id="l26.35" class="difflineplus">+  Services.scriptloader.loadSubScript(&quot;chrome://editor/content/TeXZilla.js&quot;, {}, &quot;UTF-8&quot;);</span>
<a href="#l26.36"></a><span id="l26.36"> </span>
<a href="#l26.37"></a><span id="l26.37">   // Verify if the selection is on a &lt;math&gt; and initialize the dialog.</span>
<a href="#l26.38"></a><span id="l26.38">   gDialog.oldMath = editor.getElementOrParentByTagName(&quot;math&quot;, null);</span>
<a href="#l26.39"></a><span id="l26.39">   if (gDialog.oldMath) {</span>
<a href="#l26.40"></a><span id="l26.40">     // When these attributes are absent or invalid, they default to &quot;inline&quot; and &quot;ltr&quot; respectively.</span>
<a href="#l26.41"></a><span id="l26.41">     gDialog.mode.selectedIndex = gDialog.oldMath.getAttribute(&quot;display&quot;) == &quot;block&quot; ? 1 : 0;</span>
<a href="#l26.42"></a><span id="l26.42">     gDialog.direction.selectedIndex = gDialog.oldMath.getAttribute(&quot;dir&quot;) == &quot;rtl&quot; ? 1 : 0;</span>
<a href="#l26.43"></a><span id="l26.43">     gDialog.input.value = TeXZilla.getTeXSource(gDialog.oldMath);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdInsertTOC.js</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdInsertTOC.js</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l27.4"></a><span id="l27.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l27.5"></a><span id="l27.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l27.6"></a><span id="l27.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l27.7"></a><span id="l27.7"> </span>
<a href="#l27.8"></a><span id="l27.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l27.9"></a><span id="l27.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l27.10"></a><span id="l27.10" class="difflineplus">+</span>
<a href="#l27.11"></a><span id="l27.11"> // tocHeadersArray is the array containing the pairs tag/class</span>
<a href="#l27.12"></a><span id="l27.12"> // defining TOC entries</span>
<a href="#l27.13"></a><span id="l27.13"> var tocHeadersArray = new Array(6);</span>
<a href="#l27.14"></a><span id="l27.14"> </span>
<a href="#l27.15"></a><span id="l27.15"> // a global used when building the TOC</span>
<a href="#l27.16"></a><span id="l27.16"> var currentHeaderLevel = 0;</span>
<a href="#l27.17"></a><span id="l27.17"> </span>
<a href="#l27.18"></a><span id="l27.18"> // a global set to true if the TOC is to be readonly</span>
<a href="#l27.19"></a><span id="l27.19" class="difflineat">@@ -28,17 +31,17 @@ document.addEventListener(&quot;dialogaccept&quot;</span>
<a href="#l27.20"></a><span id="l27.20"> // Startup() is called when EdInsertTOC.xul is opened</span>
<a href="#l27.21"></a><span id="l27.21"> function Startup() {</span>
<a href="#l27.22"></a><span id="l27.22">   // early way out if if we have no editor</span>
<a href="#l27.23"></a><span id="l27.23">   if (!GetCurrentEditor()) {</span>
<a href="#l27.24"></a><span id="l27.24">     window.close();</span>
<a href="#l27.25"></a><span id="l27.25">     return;</span>
<a href="#l27.26"></a><span id="l27.26">   }</span>
<a href="#l27.27"></a><span id="l27.27"> </span>
<a href="#l27.28"></a><span id="l27.28" class="difflineminus">-  var i, j;</span>
<a href="#l27.29"></a><span id="l27.29" class="difflineplus">+  var i;</span>
<a href="#l27.30"></a><span id="l27.30">   // clean the table of tag/class pairs we look for</span>
<a href="#l27.31"></a><span id="l27.31">   for (i = 0; i &lt; 6; ++i)</span>
<a href="#l27.32"></a><span id="l27.32">     tocHeadersArray[i] = [ &quot;&quot;, &quot;&quot; ];</span>
<a href="#l27.33"></a><span id="l27.33"> </span>
<a href="#l27.34"></a><span id="l27.34">   // reset all settings</span>
<a href="#l27.35"></a><span id="l27.35">   for (i = 1; i &lt; 7; ++i) {</span>
<a href="#l27.36"></a><span id="l27.36">     var menulist = document.getElementById(&quot;header&quot; + i + &quot;Menulist&quot;);</span>
<a href="#l27.37"></a><span id="l27.37">     var menuitem = document.getElementById(&quot;header&quot; + i + &quot;none&quot;);</span>
<a href="#l27.38"></a><span id="l27.38" class="difflineat">@@ -146,48 +149,40 @@ function BuildTOC(update) {</span>
<a href="#l27.39"></a><span id="l27.39"> </span>
<a href="#l27.40"></a><span id="l27.40">   // the main node filter for our node iterator</span>
<a href="#l27.41"></a><span id="l27.41">   // it selects the tag names as specified in the dialog</span>
<a href="#l27.42"></a><span id="l27.42">   // then calls the controlClass filter above</span>
<a href="#l27.43"></a><span id="l27.43">   function acceptNode(node) {</span>
<a href="#l27.44"></a><span id="l27.44">     switch (node.nodeName.toLowerCase()) {</span>
<a href="#l27.45"></a><span id="l27.45">       case tocHeadersArray[0][0]:</span>
<a href="#l27.46"></a><span id="l27.46">         return controlClass(node, 0);</span>
<a href="#l27.47"></a><span id="l27.47" class="difflineminus">-        break;</span>
<a href="#l27.48"></a><span id="l27.48">       case tocHeadersArray[1][0]:</span>
<a href="#l27.49"></a><span id="l27.49">         return controlClass(node, 1);</span>
<a href="#l27.50"></a><span id="l27.50" class="difflineminus">-        break;</span>
<a href="#l27.51"></a><span id="l27.51">       case tocHeadersArray[2][0]:</span>
<a href="#l27.52"></a><span id="l27.52">         return controlClass(node, 2);</span>
<a href="#l27.53"></a><span id="l27.53" class="difflineminus">-        break;</span>
<a href="#l27.54"></a><span id="l27.54">       case tocHeadersArray[3][0]:</span>
<a href="#l27.55"></a><span id="l27.55">         return controlClass(node, 3);</span>
<a href="#l27.56"></a><span id="l27.56" class="difflineminus">-        break;</span>
<a href="#l27.57"></a><span id="l27.57">       case tocHeadersArray[4][0]:</span>
<a href="#l27.58"></a><span id="l27.58">         return controlClass(node, 4);</span>
<a href="#l27.59"></a><span id="l27.59" class="difflineminus">-        break;</span>
<a href="#l27.60"></a><span id="l27.60">       case tocHeadersArray[5][0]:</span>
<a href="#l27.61"></a><span id="l27.61">         return controlClass(node, 5);</span>
<a href="#l27.62"></a><span id="l27.62" class="difflineminus">-        break;</span>
<a href="#l27.63"></a><span id="l27.63">       default:</span>
<a href="#l27.64"></a><span id="l27.64">         return NodeFilter.FILTER_SKIP;</span>
<a href="#l27.65"></a><span id="l27.65" class="difflineminus">-        break;</span>
<a href="#l27.66"></a><span id="l27.66">     }</span>
<a href="#l27.67"></a><span id="l27.67" class="difflineminus">-    return NodeFilter.FILTER_SKIP;   // placate the js compiler</span>
<a href="#l27.68"></a><span id="l27.68">   }</span>
<a href="#l27.69"></a><span id="l27.69"> </span>
<a href="#l27.70"></a><span id="l27.70">   var editor = GetCurrentEditor();</span>
<a href="#l27.71"></a><span id="l27.71">   var theDocument = editor.document;</span>
<a href="#l27.72"></a><span id="l27.72">   // let's create a TreeWalker to look for our nodes</span>
<a href="#l27.73"></a><span id="l27.73">   var treeWalker = theDocument.createTreeWalker(theDocument.documentElement,</span>
<a href="#l27.74"></a><span id="l27.74">                                                 NodeFilter.SHOW_ELEMENT,</span>
<a href="#l27.75"></a><span id="l27.75">                                                 acceptNode,</span>
<a href="#l27.76"></a><span id="l27.76">                                                 true);</span>
<a href="#l27.77"></a><span id="l27.77">   // we need an array to store all TOC entries we find in the document</span>
<a href="#l27.78"></a><span id="l27.78" class="difflineminus">-  var tocArray = new Array();</span>
<a href="#l27.79"></a><span id="l27.79" class="difflineplus">+  var tocArray = [];</span>
<a href="#l27.80"></a><span id="l27.80">   if (treeWalker) {</span>
<a href="#l27.81"></a><span id="l27.81">     var tocSourceNode = treeWalker.nextNode();</span>
<a href="#l27.82"></a><span id="l27.82">     while (tocSourceNode) {</span>
<a href="#l27.83"></a><span id="l27.83">       var headerIndex = currentHeaderLevel;</span>
<a href="#l27.84"></a><span id="l27.84"> </span>
<a href="#l27.85"></a><span id="l27.85">       // we have a node, we need to get all its textual contents</span>
<a href="#l27.86"></a><span id="l27.86">       var textTreeWalker = theDocument.createTreeWalker(tocSourceNode,</span>
<a href="#l27.87"></a><span id="l27.87">                                                         NodeFilter.SHOW_TEXT,</span>
<a href="#l27.88"></a><span id="l27.88" class="difflineat">@@ -238,33 +233,33 @@ function BuildTOC(update) {</span>
<a href="#l27.89"></a><span id="l27.89">         // Composer will refuse an empty list and will remove it !</span>
<a href="#l27.90"></a><span id="l27.90">         var pit = theDocument.createElement(&quot;li&quot;);</span>
<a href="#l27.91"></a><span id="l27.91">         toc.appendChild(pit);</span>
<a href="#l27.92"></a><span id="l27.92">         GetCurrentEditor().insertElementAtSelection(toc, true);</span>
<a href="#l27.93"></a><span id="l27.93">         // ah, now it's inserted so let's remove the useless list item...</span>
<a href="#l27.94"></a><span id="l27.94">         toc.removeChild(pit);</span>
<a href="#l27.95"></a><span id="l27.95">         // we need to recognize later that this list is our TOC</span>
<a href="#l27.96"></a><span id="l27.96">         toc.setAttribute(&quot;id&quot;, kMozToc);</span>
<a href="#l27.97"></a><span id="l27.97" class="difflineminus">-      } else {</span>
<a href="#l27.98"></a><span id="l27.98" class="difflineplus">+      } else if (orderedList != (toc.nodeName.toLowerCase() == &quot;ol&quot;)) {</span>
<a href="#l27.99"></a><span id="l27.99">         // we have to update an existing TOC, is the existing TOC of the</span>
<a href="#l27.100"></a><span id="l27.100">         // desired type (ordered or not) ?</span>
<a href="#l27.101"></a><span id="l27.101" class="difflineminus">-        if (orderedList != (toc.nodeName.toLowerCase() == &quot;ol&quot;)) {</span>
<a href="#l27.102"></a><span id="l27.102" class="difflineminus">-          // nope, we have to recreate the list</span>
<a href="#l27.103"></a><span id="l27.103" class="difflineminus">-          var newToc = GetCurrentEditor().createElementWithDefaults(orderedList ? &quot;ol&quot; : &quot;ul&quot;);</span>
<a href="#l27.104"></a><span id="l27.104" class="difflineminus">-          toc.parentNode.insertBefore(newToc, toc);</span>
<a href="#l27.105"></a><span id="l27.105" class="difflineminus">-          // and remove the old one</span>
<a href="#l27.106"></a><span id="l27.106" class="difflineminus">-          toc.remove();</span>
<a href="#l27.107"></a><span id="l27.107" class="difflineminus">-          toc = newToc;</span>
<a href="#l27.108"></a><span id="l27.108" class="difflineminus">-          toc.setAttribute(&quot;id&quot;, kMozToc);</span>
<a href="#l27.109"></a><span id="l27.109" class="difflineminus">-        } else {</span>
<a href="#l27.110"></a><span id="l27.110" class="difflineminus">-          // we can keep the list itself but let's get rid of the TOC entries</span>
<a href="#l27.111"></a><span id="l27.111" class="difflineminus">-          while (toc.hasChildNodes())</span>
<a href="#l27.112"></a><span id="l27.112" class="difflineminus">-            toc.lastChild.remove();</span>
<a href="#l27.113"></a><span id="l27.113" class="difflineminus">-        }</span>
<a href="#l27.114"></a><span id="l27.114" class="difflineplus">+</span>
<a href="#l27.115"></a><span id="l27.115" class="difflineplus">+        // nope, we have to recreate the list</span>
<a href="#l27.116"></a><span id="l27.116" class="difflineplus">+        var newToc = GetCurrentEditor().createElementWithDefaults(orderedList ? &quot;ol&quot; : &quot;ul&quot;);</span>
<a href="#l27.117"></a><span id="l27.117" class="difflineplus">+        toc.parentNode.insertBefore(newToc, toc);</span>
<a href="#l27.118"></a><span id="l27.118" class="difflineplus">+        // and remove the old one</span>
<a href="#l27.119"></a><span id="l27.119" class="difflineplus">+        toc.remove();</span>
<a href="#l27.120"></a><span id="l27.120" class="difflineplus">+        toc = newToc;</span>
<a href="#l27.121"></a><span id="l27.121" class="difflineplus">+        toc.setAttribute(&quot;id&quot;, kMozToc);</span>
<a href="#l27.122"></a><span id="l27.122" class="difflineplus">+      } else {</span>
<a href="#l27.123"></a><span id="l27.123" class="difflineplus">+        // we can keep the list itself but let's get rid of the TOC entries</span>
<a href="#l27.124"></a><span id="l27.124" class="difflineplus">+        while (toc.hasChildNodes())</span>
<a href="#l27.125"></a><span id="l27.125" class="difflineplus">+          toc.lastChild.remove();</span>
<a href="#l27.126"></a><span id="l27.126">       }</span>
<a href="#l27.127"></a><span id="l27.127" class="difflineplus">+</span>
<a href="#l27.128"></a><span id="l27.128">       var commentText = &quot;mozToc &quot;;</span>
<a href="#l27.129"></a><span id="l27.129">       for (var j = 0; j &lt; 6; j++) {</span>
<a href="#l27.130"></a><span id="l27.130">         if (tocHeadersArray[j][0] != &quot;&quot;) {</span>
<a href="#l27.131"></a><span id="l27.131">           commentText += tocHeadersArray[j][0];</span>
<a href="#l27.132"></a><span id="l27.132">           if (tocHeadersArray[j][1] != &quot;&quot;) {</span>
<a href="#l27.133"></a><span id="l27.133">             commentText += &quot;.&quot; + tocHeadersArray[j][1];</span>
<a href="#l27.134"></a><span id="l27.134">           }</span>
<a href="#l27.135"></a><span id="l27.135">           commentText += &quot; &quot; + (j + 1) + &quot; &quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdInsertTable.js</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdInsertTable.js</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l28.4"></a><span id="l28.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l28.5"></a><span id="l28.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l28.6"></a><span id="l28.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l28.7"></a><span id="l28.7"> </span>
<a href="#l28.8"></a><span id="l28.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l28.9"></a><span id="l28.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l28.10"></a><span id="l28.10" class="difflineplus">+</span>
<a href="#l28.11"></a><span id="l28.11"> // Cancel() is in EdDialogCommon.js</span>
<a href="#l28.12"></a><span id="l28.12"> </span>
<a href="#l28.13"></a><span id="l28.13"> var gTableElement = null;</span>
<a href="#l28.14"></a><span id="l28.14"> var gRows;</span>
<a href="#l28.15"></a><span id="l28.15"> var gColumns;</span>
<a href="#l28.16"></a><span id="l28.16"> var gActiveEditor;</span>
<a href="#l28.17"></a><span id="l28.17"> </span>
<a href="#l28.18"></a><span id="l28.18"> // dialog initialization code</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdLabelProps.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdLabelProps.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l29.4"></a><span id="l29.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l29.5"></a><span id="l29.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l29.6"></a><span id="l29.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l29.7"></a><span id="l29.7"> </span>
<a href="#l29.8"></a><span id="l29.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l29.9"></a><span id="l29.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l29.10"></a><span id="l29.10" class="difflineplus">+</span>
<a href="#l29.11"></a><span id="l29.11"> var labelElement;</span>
<a href="#l29.12"></a><span id="l29.12"> </span>
<a href="#l29.13"></a><span id="l29.13"> // dialog initialization code</span>
<a href="#l29.14"></a><span id="l29.14"> </span>
<a href="#l29.15"></a><span id="l29.15"> document.addEventListener(&quot;dialogaccept&quot;, onAccept);</span>
<a href="#l29.16"></a><span id="l29.16"> document.addEventListener(&quot;dialogcancel&quot;, onCancel);</span>
<a href="#l29.17"></a><span id="l29.17"> </span>
<a href="#l29.18"></a><span id="l29.18"> function Startup() {</span>
<a href="#l29.19"></a><span id="l29.19" class="difflineat">@@ -36,18 +39,19 @@ function Startup() {</span>
<a href="#l29.20"></a><span id="l29.20">   if (labelElement.innerHTML.includes(&quot;&lt;&quot;)) {</span>
<a href="#l29.21"></a><span id="l29.21">     gDialog.editText.checked = false;</span>
<a href="#l29.22"></a><span id="l29.22">     gDialog.editText.disabled = false;</span>
<a href="#l29.23"></a><span id="l29.23">     gDialog.labelText.disabled = true;</span>
<a href="#l29.24"></a><span id="l29.24">     gDialog.editText.addEventListener(&quot;command&quot;,</span>
<a href="#l29.25"></a><span id="l29.25">       () =&gt; Services.prompt.alert(window, GetString(&quot;Alert&quot;), GetString(&quot;EditTextWarning&quot;)),</span>
<a href="#l29.26"></a><span id="l29.26">       {capture: false, once: true});</span>
<a href="#l29.27"></a><span id="l29.27">     SetTextboxFocus(gDialog.labelFor);</span>
<a href="#l29.28"></a><span id="l29.28" class="difflineminus">-  } else</span>
<a href="#l29.29"></a><span id="l29.29" class="difflineplus">+  } else {</span>
<a href="#l29.30"></a><span id="l29.30">     SetTextboxFocus(gDialog.labelText);</span>
<a href="#l29.31"></a><span id="l29.31" class="difflineplus">+  }</span>
<a href="#l29.32"></a><span id="l29.32"> </span>
<a href="#l29.33"></a><span id="l29.33">   SetWindowLocation();</span>
<a href="#l29.34"></a><span id="l29.34"> }</span>
<a href="#l29.35"></a><span id="l29.35"> </span>
<a href="#l29.36"></a><span id="l29.36"> function InitDialog() {</span>
<a href="#l29.37"></a><span id="l29.37">   gDialog.labelFor.value = globalElement.getAttribute(&quot;for&quot;);</span>
<a href="#l29.38"></a><span id="l29.38">   gDialog.labelAccessKey.value = globalElement.getAttribute(&quot;accesskey&quot;);</span>
<a href="#l29.39"></a><span id="l29.39"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdLinkProps.js</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdLinkProps.js</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -1,27 +1,29 @@</span>
<a href="#l30.4"></a><span id="l30.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l30.5"></a><span id="l30.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l30.6"></a><span id="l30.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l30.7"></a><span id="l30.7"> </span>
<a href="#l30.8"></a><span id="l30.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l30.9"></a><span id="l30.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l30.10"></a><span id="l30.10" class="difflineplus">+</span>
<a href="#l30.11"></a><span id="l30.11"> var gActiveEditor;</span>
<a href="#l30.12"></a><span id="l30.12"> var anchorElement = null;</span>
<a href="#l30.13"></a><span id="l30.13"> var imageElement = null;</span>
<a href="#l30.14"></a><span id="l30.14"> var insertNew = false;</span>
<a href="#l30.15"></a><span id="l30.15"> var replaceExistingLink = false;</span>
<a href="#l30.16"></a><span id="l30.16"> var insertLinkAtCaret;</span>
<a href="#l30.17"></a><span id="l30.17"> var needLinkText = false;</span>
<a href="#l30.18"></a><span id="l30.18"> var href;</span>
<a href="#l30.19"></a><span id="l30.19"> var newLinkText;</span>
<a href="#l30.20"></a><span id="l30.20"> var gHNodeArray = {};</span>
<a href="#l30.21"></a><span id="l30.21"> var gHaveNamedAnchors = false;</span>
<a href="#l30.22"></a><span id="l30.22"> var gHaveHeadings = false;</span>
<a href="#l30.23"></a><span id="l30.23"> var gCanChangeHeadingSelected = true;</span>
<a href="#l30.24"></a><span id="l30.24"> var gCanChangeAnchorSelected = true;</span>
<a href="#l30.25"></a><span id="l30.25" class="difflineminus">-var gHaveDocumentUrl = false;</span>
<a href="#l30.26"></a><span id="l30.26"> </span>
<a href="#l30.27"></a><span id="l30.27"> // NOTE: Use &quot;href&quot; instead of &quot;a&quot; to distinguish from Named Anchor</span>
<a href="#l30.28"></a><span id="l30.28"> // The returned node is has an &quot;a&quot; tagName</span>
<a href="#l30.29"></a><span id="l30.29"> var tagName = &quot;href&quot;;</span>
<a href="#l30.30"></a><span id="l30.30"> </span>
<a href="#l30.31"></a><span id="l30.31"> // dialog initialization code</span>
<a href="#l30.32"></a><span id="l30.32"> </span>
<a href="#l30.33"></a><span id="l30.33"> document.addEventListener(&quot;dialogaccept&quot;, onAccept);</span>
<a href="#l30.34"></a><span id="l30.34" class="difflineat">@@ -227,19 +229,19 @@ function ValidateData() {</span>
<a href="#l30.35"></a><span id="l30.35">     ShowInputErrorMessage(GetString(&quot;EmptyHREFError&quot;));</span>
<a href="#l30.36"></a><span id="l30.36">     return false;</span>
<a href="#l30.37"></a><span id="l30.37">   }</span>
<a href="#l30.38"></a><span id="l30.38">   if (gDialog.linkTextInput) {</span>
<a href="#l30.39"></a><span id="l30.39">     // The text we will insert isn't really an attribute,</span>
<a href="#l30.40"></a><span id="l30.40">     //  but it makes sense to validate it</span>
<a href="#l30.41"></a><span id="l30.41">     newLinkText = TrimString(gDialog.linkTextInput.value);</span>
<a href="#l30.42"></a><span id="l30.42">     if (!newLinkText) {</span>
<a href="#l30.43"></a><span id="l30.43" class="difflineminus">-      if (href)</span>
<a href="#l30.44"></a><span id="l30.44" class="difflineplus">+      if (href) {</span>
<a href="#l30.45"></a><span id="l30.45">         newLinkText = href;</span>
<a href="#l30.46"></a><span id="l30.46" class="difflineminus">-      else {</span>
<a href="#l30.47"></a><span id="l30.47" class="difflineplus">+      } else {</span>
<a href="#l30.48"></a><span id="l30.48">         ShowInputErrorMessage(GetString(&quot;EmptyLinkTextError&quot;));</span>
<a href="#l30.49"></a><span id="l30.49">         SetTextboxFocus(gDialog.linkTextInput);</span>
<a href="#l30.50"></a><span id="l30.50">         return false;</span>
<a href="#l30.51"></a><span id="l30.51">       }</span>
<a href="#l30.52"></a><span id="l30.52">     }</span>
<a href="#l30.53"></a><span id="l30.53">   }</span>
<a href="#l30.54"></a><span id="l30.54">   return true;</span>
<a href="#l30.55"></a><span id="l30.55"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdListProps.js</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdListProps.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l31.4"></a><span id="l31.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l31.5"></a><span id="l31.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l31.6"></a><span id="l31.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l31.7"></a><span id="l31.7"> </span>
<a href="#l31.8"></a><span id="l31.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l31.9"></a><span id="l31.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l31.10"></a><span id="l31.10" class="difflineplus">+</span>
<a href="#l31.11"></a><span id="l31.11"> // Cancel() is in EdDialogCommon.js</span>
<a href="#l31.12"></a><span id="l31.12"> var gBulletStyleType = &quot;&quot;;</span>
<a href="#l31.13"></a><span id="l31.13"> var gNumberStyleType = &quot;&quot;;</span>
<a href="#l31.14"></a><span id="l31.14"> var gListElement;</span>
<a href="#l31.15"></a><span id="l31.15"> var gOriginalListType = &quot;&quot;;</span>
<a href="#l31.16"></a><span id="l31.16"> var gListType = &quot;&quot;;</span>
<a href="#l31.17"></a><span id="l31.17"> var gMixedListSelection = false;</span>
<a href="#l31.18"></a><span id="l31.18"> var gStyleType = &quot;&quot;;</span>
<a href="#l31.19"></a><span id="l31.19" class="difflineat">@@ -94,17 +97,16 @@ function InitDialog() {</span>
<a href="#l31.20"></a><span id="l31.20">     gListType = &quot;&quot;;</span>
<a href="#l31.21"></a><span id="l31.21"> </span>
<a href="#l31.22"></a><span id="l31.22">   gDialog.ListTypeList.value = gListType;</span>
<a href="#l31.23"></a><span id="l31.23">   gDialog.StartingNumberInput.value = &quot;&quot;;</span>
<a href="#l31.24"></a><span id="l31.24"> </span>
<a href="#l31.25"></a><span id="l31.25">   // Last param = true means attribute value is case-sensitive</span>
<a href="#l31.26"></a><span id="l31.26">   var type = globalElement ? GetHTMLOrCSSStyleValue(globalElement, &quot;type&quot;, &quot;list-style-type&quot;) : null;</span>
<a href="#l31.27"></a><span id="l31.27"> </span>
<a href="#l31.28"></a><span id="l31.28" class="difflineminus">-  var index = 0;</span>
<a href="#l31.29"></a><span id="l31.29">   if (gListType == &quot;ul&quot;) {</span>
<a href="#l31.30"></a><span id="l31.30">     if (type) {</span>
<a href="#l31.31"></a><span id="l31.31">       type = type.toLowerCase();</span>
<a href="#l31.32"></a><span id="l31.32">       gBulletStyleType = type;</span>
<a href="#l31.33"></a><span id="l31.33">       gOriginalStyleType = type;</span>
<a href="#l31.34"></a><span id="l31.34">     }</span>
<a href="#l31.35"></a><span id="l31.35">   } else if (gListType == &quot;ol&quot;) {</span>
<a href="#l31.36"></a><span id="l31.36">     // Translate CSS property strings</span>
<a href="#l31.37"></a><span id="l31.37" class="difflineat">@@ -225,19 +227,19 @@ function SelectListType() {</span>
<a href="#l31.38"></a><span id="l31.38">     BuildBulletStyleList();</span>
<a href="#l31.39"></a><span id="l31.39">   }</span>
<a href="#l31.40"></a><span id="l31.40"> }</span>
<a href="#l31.41"></a><span id="l31.41"> </span>
<a href="#l31.42"></a><span id="l31.42"> function SelectBulletStyle() {</span>
<a href="#l31.43"></a><span id="l31.43">   // Save the selected index so when user changes</span>
<a href="#l31.44"></a><span id="l31.44">   //   list style, restore index to associated list</span>
<a href="#l31.45"></a><span id="l31.45">   // Each bullet or number type is stored in the &quot;value&quot; of each menuitem</span>
<a href="#l31.46"></a><span id="l31.46" class="difflineminus">-  if (gListType == &quot;ul&quot;)</span>
<a href="#l31.47"></a><span id="l31.47" class="difflineplus">+  if (gListType == &quot;ul&quot;) {</span>
<a href="#l31.48"></a><span id="l31.48">     gBulletStyleType = gDialog.BulletStyleList.value;</span>
<a href="#l31.49"></a><span id="l31.49" class="difflineminus">-  else if (gListType == &quot;ol&quot;) {</span>
<a href="#l31.50"></a><span id="l31.50" class="difflineplus">+  } else if (gListType == &quot;ol&quot;) {</span>
<a href="#l31.51"></a><span id="l31.51">     var type = gDialog.BulletStyleList.value;</span>
<a href="#l31.52"></a><span id="l31.52">     if (gNumberStyleType != type) {</span>
<a href="#l31.53"></a><span id="l31.53">       // Convert existing input value to attr number first,</span>
<a href="#l31.54"></a><span id="l31.54">       //   then convert to the appropriate format for the newly-selected</span>
<a href="#l31.55"></a><span id="l31.55">       gDialog.StartingNumberInput.value =</span>
<a href="#l31.56"></a><span id="l31.56">         ConvertStartAttrToUserString(ConvertUserStringToStartAttr(gNumberStyleType), type);</span>
<a href="#l31.57"></a><span id="l31.57"> </span>
<a href="#l31.58"></a><span id="l31.58">       gNumberStyleType = type;</span>
<a href="#l31.59"></a><span id="l31.59" class="difflineat">@@ -359,19 +361,20 @@ function onAccept(event) {</span>
<a href="#l31.60"></a><span id="l31.60"> </span>
<a href="#l31.61"></a><span id="l31.61">     // Remember which radio button was selected</span>
<a href="#l31.62"></a><span id="l31.62">     if (gListElement)</span>
<a href="#l31.63"></a><span id="l31.63">       gDialog.RadioGroup.setAttribute(&quot;index&quot;, changeEntireList ? &quot;0&quot; : &quot;1&quot;);</span>
<a href="#l31.64"></a><span id="l31.64"> </span>
<a href="#l31.65"></a><span id="l31.65">     var changeList;</span>
<a href="#l31.66"></a><span id="l31.66">     if (gListElement &amp;&amp; gDialog.ChangeAllRadio.selected) {</span>
<a href="#l31.67"></a><span id="l31.67">       changeList = true;</span>
<a href="#l31.68"></a><span id="l31.68" class="difflineminus">-    } else</span>
<a href="#l31.69"></a><span id="l31.69" class="difflineplus">+    } else {</span>
<a href="#l31.70"></a><span id="l31.70">       changeList = gMixedListSelection || gListType != gOriginalListType ||</span>
<a href="#l31.71"></a><span id="l31.71">                    gBulletStyleType != gOriginalStyleType;</span>
<a href="#l31.72"></a><span id="l31.72" class="difflineplus">+    }</span>
<a href="#l31.73"></a><span id="l31.73">     if (changeList) {</span>
<a href="#l31.74"></a><span id="l31.74">       try {</span>
<a href="#l31.75"></a><span id="l31.75">         if (gListType) {</span>
<a href="#l31.76"></a><span id="l31.76">           editor.makeOrChangeList(gListType, changeEntireList,</span>
<a href="#l31.77"></a><span id="l31.77">                      (gBulletStyleType != gOriginalStyleType) ? gBulletStyleType : null);</span>
<a href="#l31.78"></a><span id="l31.78"> </span>
<a href="#l31.79"></a><span id="l31.79">           // Get the new list created:</span>
<a href="#l31.80"></a><span id="l31.80">           gListElement = editor.getElementOrParentByTagName(gListType, null);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdNamedAnchorProps.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdNamedAnchorProps.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l32.4"></a><span id="l32.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l32.5"></a><span id="l32.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l32.6"></a><span id="l32.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l32.7"></a><span id="l32.7"> </span>
<a href="#l32.8"></a><span id="l32.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l32.9"></a><span id="l32.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l32.10"></a><span id="l32.10" class="difflineplus">+</span>
<a href="#l32.11"></a><span id="l32.11"> var gInsertNew = true;</span>
<a href="#l32.12"></a><span id="l32.12"> var gAnchorElement = null;</span>
<a href="#l32.13"></a><span id="l32.13"> var gOriginalName = &quot;&quot;;</span>
<a href="#l32.14"></a><span id="l32.14"> const kTagName = &quot;anchor&quot;;</span>
<a href="#l32.15"></a><span id="l32.15"> </span>
<a href="#l32.16"></a><span id="l32.16"> // dialog initialization code</span>
<a href="#l32.17"></a><span id="l32.17"> </span>
<a href="#l32.18"></a><span id="l32.18"> document.addEventListener(&quot;dialogaccept&quot;, onAccept);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdPageProps.js</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdPageProps.js</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l33.4"></a><span id="l33.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l33.5"></a><span id="l33.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l33.6"></a><span id="l33.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l33.7"></a><span id="l33.7"> </span>
<a href="#l33.8"></a><span id="l33.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l33.9"></a><span id="l33.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l33.10"></a><span id="l33.10" class="difflineplus">+</span>
<a href="#l33.11"></a><span id="l33.11"> var gNewTitle = &quot;&quot;;</span>
<a href="#l33.12"></a><span id="l33.12"> var gAuthor = &quot;&quot;;</span>
<a href="#l33.13"></a><span id="l33.13"> var gDescription = &quot;&quot;;</span>
<a href="#l33.14"></a><span id="l33.14"> var gAuthorElement;</span>
<a href="#l33.15"></a><span id="l33.15"> var gDescriptionElement;</span>
<a href="#l33.16"></a><span id="l33.16"> var gInsertNewAuthor = false;</span>
<a href="#l33.17"></a><span id="l33.17"> var gInsertNewDescription = false;</span>
<a href="#l33.18"></a><span id="l33.18"> var gTitleWasEdited = false;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdReplace.js</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdReplace.js</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -1,14 +1,17 @@</span>
<a href="#l34.4"></a><span id="l34.4"> /* -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l34.5"></a><span id="l34.5">  *</span>
<a href="#l34.6"></a><span id="l34.6">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l34.7"></a><span id="l34.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l34.8"></a><span id="l34.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l34.9"></a><span id="l34.9"> </span>
<a href="#l34.10"></a><span id="l34.10" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l34.11"></a><span id="l34.11" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineplus">+</span>
<a href="#l34.13"></a><span id="l34.13"> var gReplaceDialog;      // Quick access to document/form elements.</span>
<a href="#l34.14"></a><span id="l34.14"> var gFindInst;           // nsIWebBrowserFind that we're going to use</span>
<a href="#l34.15"></a><span id="l34.15"> var gFindService;        // Global service which remembers find params</span>
<a href="#l34.16"></a><span id="l34.16"> var gEditor;             // the editor we're using</span>
<a href="#l34.17"></a><span id="l34.17"> </span>
<a href="#l34.18"></a><span id="l34.18"> document.addEventListener(&quot;dialogaccept&quot;, (event) =&gt; {</span>
<a href="#l34.19"></a><span id="l34.19">   onFindNext();</span>
<a href="#l34.20"></a><span id="l34.20">   event.preventDefault();</span>
<a href="#l34.21"></a><span id="l34.21" class="difflineat">@@ -62,38 +65,36 @@ function onLoad() {</span>
<a href="#l34.22"></a><span id="l34.22"> </span>
<a href="#l34.23"></a><span id="l34.23">   // Get the nsIWebBrowserFind service:</span>
<a href="#l34.24"></a><span id="l34.24">   gFindInst = editorElement.webBrowserFind;</span>
<a href="#l34.25"></a><span id="l34.25"> </span>
<a href="#l34.26"></a><span id="l34.26">   try {</span>
<a href="#l34.27"></a><span id="l34.27">   // get the find service, which stores global find state</span>
<a href="#l34.28"></a><span id="l34.28">     gFindService = Cc[&quot;@mozilla.org/find/find_service;1&quot;]</span>
<a href="#l34.29"></a><span id="l34.29">                          .getService(Ci.nsIFindService);</span>
<a href="#l34.30"></a><span id="l34.30" class="difflineminus">-  } catch (e) { dump(&quot;No find service!\n&quot;); gFindService = 0; }</span>
<a href="#l34.31"></a><span id="l34.31" class="difflineplus">+  } catch (e) {</span>
<a href="#l34.32"></a><span id="l34.32" class="difflineplus">+    dump(&quot;No find service!\n&quot;);</span>
<a href="#l34.33"></a><span id="l34.33" class="difflineplus">+    gFindService = 0;</span>
<a href="#l34.34"></a><span id="l34.34" class="difflineplus">+  }</span>
<a href="#l34.35"></a><span id="l34.35"> </span>
<a href="#l34.36"></a><span id="l34.36">   // Init gReplaceDialog.</span>
<a href="#l34.37"></a><span id="l34.37">   initDialogObject();</span>
<a href="#l34.38"></a><span id="l34.38"> </span>
<a href="#l34.39"></a><span id="l34.39">   // Change &quot;OK&quot; to &quot;Find&quot;.</span>
<a href="#l34.40"></a><span id="l34.40">   // dialog.find.label = document.getElementById(&quot;fBLT&quot;).getAttribute(&quot;label&quot;);</span>
<a href="#l34.41"></a><span id="l34.41"> </span>
<a href="#l34.42"></a><span id="l34.42">   // Fill dialog.</span>
<a href="#l34.43"></a><span id="l34.43">   loadDialog();</span>
<a href="#l34.44"></a><span id="l34.44"> </span>
<a href="#l34.45"></a><span id="l34.45">   if (gReplaceDialog.findInput.value)</span>
<a href="#l34.46"></a><span id="l34.46">     gReplaceDialog.findInput.select();</span>
<a href="#l34.47"></a><span id="l34.47">   else</span>
<a href="#l34.48"></a><span id="l34.48">     gReplaceDialog.findInput.focus();</span>
<a href="#l34.49"></a><span id="l34.49"> }</span>
<a href="#l34.50"></a><span id="l34.50"> </span>
<a href="#l34.51"></a><span id="l34.51" class="difflineminus">-function onUnload() {</span>
<a href="#l34.52"></a><span id="l34.52" class="difflineminus">-  // Disconnect context from this dialog.</span>
<a href="#l34.53"></a><span id="l34.53" class="difflineminus">-  gFindReplaceData.replaceDialog = null;</span>
<a href="#l34.54"></a><span id="l34.54" class="difflineminus">-}</span>
<a href="#l34.55"></a><span id="l34.55" class="difflineminus">-</span>
<a href="#l34.56"></a><span id="l34.56"> function saveFindData() {</span>
<a href="#l34.57"></a><span id="l34.57">   // Set data attributes per user input.</span>
<a href="#l34.58"></a><span id="l34.58">   if (gFindService) {</span>
<a href="#l34.59"></a><span id="l34.59">     gFindService.searchString  = gReplaceDialog.findInput.value;</span>
<a href="#l34.60"></a><span id="l34.60">     gFindService.matchCase     = gReplaceDialog.caseSensitive.checked;</span>
<a href="#l34.61"></a><span id="l34.61">     gFindService.wrapFind      = gReplaceDialog.wrap.checked;</span>
<a href="#l34.62"></a><span id="l34.62">     gFindService.findBackwards = gReplaceDialog.searchBackwards.checked;</span>
<a href="#l34.63"></a><span id="l34.63">   }</span>
<a href="#l34.64"></a><span id="l34.64" class="difflineat">@@ -140,24 +141,24 @@ function onReplace() {</span>
<a href="#l34.65"></a><span id="l34.65">     specStr = specStr.toLowerCase();</span>
<a href="#l34.66"></a><span id="l34.66">   }</span>
<a href="#l34.67"></a><span id="l34.67">   // Unfortunately, because of whitespace we can't just check</span>
<a href="#l34.68"></a><span id="l34.68">   // whether (selStr == specStr), but have to loop ourselves.</span>
<a href="#l34.69"></a><span id="l34.69">   // N chars of whitespace in specStr can match any M &gt;= N in selStr.</span>
<a href="#l34.70"></a><span id="l34.70">   var matches = true;</span>
<a href="#l34.71"></a><span id="l34.71">   var specLen = specStr.length;</span>
<a href="#l34.72"></a><span id="l34.72">   var selLen = selStr.length;</span>
<a href="#l34.73"></a><span id="l34.73" class="difflineminus">-  if (selLen &lt; specLen)</span>
<a href="#l34.74"></a><span id="l34.74" class="difflineplus">+  if (selLen &lt; specLen) {</span>
<a href="#l34.75"></a><span id="l34.75">     matches = false;</span>
<a href="#l34.76"></a><span id="l34.76" class="difflineminus">-  else {</span>
<a href="#l34.77"></a><span id="l34.77" class="difflineplus">+  } else {</span>
<a href="#l34.78"></a><span id="l34.78">     var specArray = specStr.match(/\S+|\s+/g);</span>
<a href="#l34.79"></a><span id="l34.79">     var selArray = selStr.match(/\S+|\s+/g);</span>
<a href="#l34.80"></a><span id="l34.80" class="difflineminus">-    if (specArray.length != selArray.length)</span>
<a href="#l34.81"></a><span id="l34.81" class="difflineplus">+    if (specArray.length != selArray.length) {</span>
<a href="#l34.82"></a><span id="l34.82">       matches = false;</span>
<a href="#l34.83"></a><span id="l34.83" class="difflineminus">-    else {</span>
<a href="#l34.84"></a><span id="l34.84" class="difflineplus">+    } else {</span>
<a href="#l34.85"></a><span id="l34.85">       for (var i = 0; i &lt; selArray.length; i++) {</span>
<a href="#l34.86"></a><span id="l34.86">         if (selArray[i] != specArray[i]) {</span>
<a href="#l34.87"></a><span id="l34.87">           if (/\S/.test(selArray[i][0]) || /\S/.test(specArray[i][0])) {</span>
<a href="#l34.88"></a><span id="l34.88">             // not a space chunk -- match fails</span>
<a href="#l34.89"></a><span id="l34.89">             matches = false;</span>
<a href="#l34.90"></a><span id="l34.90">             break;</span>
<a href="#l34.91"></a><span id="l34.91">           } else if (selArray[i].length &lt; specArray[i].length) {</span>
<a href="#l34.92"></a><span id="l34.92">             // if it's a space chunk then we only care that sel be</span>
<a href="#l34.93"></a><span id="l34.93" class="difflineat">@@ -329,23 +330,21 @@ function onReplaceAll() {</span>
<a href="#l34.94"></a><span id="l34.94">         selection = gEditor.selection;</span>
<a href="#l34.95"></a><span id="l34.95">         if (selection.rangeCount &lt;= 0) {</span>
<a href="#l34.96"></a><span id="l34.96">           gEditor.endTransaction();</span>
<a href="#l34.97"></a><span id="l34.97">           return;</span>
<a href="#l34.98"></a><span id="l34.98">         }</span>
<a href="#l34.99"></a><span id="l34.99">         selecRange = selection.getRangeAt(0);</span>
<a href="#l34.100"></a><span id="l34.100">       }</span>
<a href="#l34.101"></a><span id="l34.101">     }</span>
<a href="#l34.102"></a><span id="l34.102" class="difflineminus">-  } // end try</span>
<a href="#l34.103"></a><span id="l34.103" class="difflineminus">-  catch (e) { }</span>
<a href="#l34.104"></a><span id="l34.104" class="difflineplus">+  } catch (e) {}</span>
<a href="#l34.105"></a><span id="l34.105"> </span>
<a href="#l34.106"></a><span id="l34.106">   gEditor.endTransaction();</span>
<a href="#l34.107"></a><span id="l34.107"> }</span>
<a href="#l34.108"></a><span id="l34.108"> </span>
<a href="#l34.109"></a><span id="l34.109"> function doEnabling() {</span>
<a href="#l34.110"></a><span id="l34.110">   var findStr = gReplaceDialog.findInput.value;</span>
<a href="#l34.111"></a><span id="l34.111" class="difflineminus">-  var repStr = gReplaceDialog.replaceInput.value;</span>
<a href="#l34.112"></a><span id="l34.112">   gReplaceDialog.enabled = findStr;</span>
<a href="#l34.113"></a><span id="l34.113">   gReplaceDialog.findNext.disabled = !findStr;</span>
<a href="#l34.114"></a><span id="l34.114">   gReplaceDialog.replace.disabled = !findStr;</span>
<a href="#l34.115"></a><span id="l34.115">   gReplaceDialog.replaceAndFind.disabled = !findStr;</span>
<a href="#l34.116"></a><span id="l34.116">   gReplaceDialog.replaceAll.disabled = !findStr;</span>
<a href="#l34.117"></a><span id="l34.117"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdSelectProps.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdSelectProps.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l35.4"></a><span id="l35.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l35.5"></a><span id="l35.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l35.6"></a><span id="l35.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l35.7"></a><span id="l35.7"> </span>
<a href="#l35.8"></a><span id="l35.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l35.9"></a><span id="l35.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l35.10"></a><span id="l35.10" class="difflineplus">+</span>
<a href="#l35.11"></a><span id="l35.11"> // Global variables</span>
<a href="#l35.12"></a><span id="l35.12"> </span>
<a href="#l35.13"></a><span id="l35.13"> var hasValue;</span>
<a href="#l35.14"></a><span id="l35.14"> var oldValue;</span>
<a href="#l35.15"></a><span id="l35.15"> var insertNew;</span>
<a href="#l35.16"></a><span id="l35.16"> var itemArray;</span>
<a href="#l35.17"></a><span id="l35.17"> var theTree;</span>
<a href="#l35.18"></a><span id="l35.18"> var treeSelection;</span>
<a href="#l35.19"></a><span id="l35.19" class="difflineat">@@ -28,18 +31,19 @@ function getParentIndex(index) {</span>
<a href="#l35.20"></a><span id="l35.20">   while (itemArray[--index].level &gt; 1);</span>
<a href="#l35.21"></a><span id="l35.21">   return index;</span>
<a href="#l35.22"></a><span id="l35.22"> }</span>
<a href="#l35.23"></a><span id="l35.23"> </span>
<a href="#l35.24"></a><span id="l35.24"> function UpdateSelectMultiple() {</span>
<a href="#l35.25"></a><span id="l35.25">   if (selectedOptionCount &gt; 1) {</span>
<a href="#l35.26"></a><span id="l35.26">     gDialog.selectMultiple.checked = true;</span>
<a href="#l35.27"></a><span id="l35.27">     gDialog.selectMultiple.disabled = true;</span>
<a href="#l35.28"></a><span id="l35.28" class="difflineminus">-  } else</span>
<a href="#l35.29"></a><span id="l35.29" class="difflineplus">+  } else {</span>
<a href="#l35.30"></a><span id="l35.30">     gDialog.selectMultiple.disabled = false;</span>
<a href="#l35.31"></a><span id="l35.31" class="difflineplus">+  }</span>
<a href="#l35.32"></a><span id="l35.32"> }</span>
<a href="#l35.33"></a><span id="l35.33"> </span>
<a href="#l35.34"></a><span id="l35.34"> /* wrapper objects:</span>
<a href="#l35.35"></a><span id="l35.35">  * readonly attribute Node element; // DOM node (select/optgroup/option)</span>
<a href="#l35.36"></a><span id="l35.36">  * readonly attribute int level; // tree depth</span>
<a href="#l35.37"></a><span id="l35.37">  * readonly attribute boolean container; // can contain options</span>
<a href="#l35.38"></a><span id="l35.38">  * string getCellText(string col); // tree view helper</span>
<a href="#l35.39"></a><span id="l35.39">  * string cycleCell(int currentIndex); // tree view helper</span>
<a href="#l35.40"></a><span id="l35.40" class="difflineat">@@ -61,86 +65,86 @@ function optionObject(option, level) {</span>
<a href="#l35.41"></a><span id="l35.41">   if (option.hasAttribute(&quot;selected&quot;))</span>
<a href="#l35.42"></a><span id="l35.42">     selectedOptionCount++;</span>
<a href="#l35.43"></a><span id="l35.43">   this.level = level;</span>
<a href="#l35.44"></a><span id="l35.44">   this.element = option;</span>
<a href="#l35.45"></a><span id="l35.45"> }</span>
<a href="#l35.46"></a><span id="l35.46"> </span>
<a href="#l35.47"></a><span id="l35.47"> optionObject.prototype.container = false;</span>
<a href="#l35.48"></a><span id="l35.48"> </span>
<a href="#l35.49"></a><span id="l35.49" class="difflineminus">-optionObject.prototype.getCellText = function getCellText(column) {</span>
<a href="#l35.50"></a><span id="l35.50" class="difflineplus">+optionObject.prototype.getCellText = function(column) {</span>
<a href="#l35.51"></a><span id="l35.51">   if (column.id == &quot;SelectSelCol&quot;)</span>
<a href="#l35.52"></a><span id="l35.52">     return &quot;&quot;;</span>
<a href="#l35.53"></a><span id="l35.53">   if (column.id == &quot;SelectValCol&quot; &amp;&amp; this.element.hasAttribute(&quot;value&quot;))</span>
<a href="#l35.54"></a><span id="l35.54">     return this.element.getAttribute(&quot;value&quot;);</span>
<a href="#l35.55"></a><span id="l35.55">   return this.element.text;</span>
<a href="#l35.56"></a><span id="l35.56"> };</span>
<a href="#l35.57"></a><span id="l35.57"> </span>
<a href="#l35.58"></a><span id="l35.58" class="difflineminus">-optionObject.prototype.cycleCell = function cycleCell(index) {</span>
<a href="#l35.59"></a><span id="l35.59" class="difflineplus">+optionObject.prototype.cycleCell = function(index) {</span>
<a href="#l35.60"></a><span id="l35.60">   if (this.element.hasAttribute(&quot;selected&quot;)) {</span>
<a href="#l35.61"></a><span id="l35.61">     this.element.removeAttribute(&quot;selected&quot;);</span>
<a href="#l35.62"></a><span id="l35.62">     selectedOptionCount--;</span>
<a href="#l35.63"></a><span id="l35.63">     selectedOption = null;</span>
<a href="#l35.64"></a><span id="l35.64">   } else {</span>
<a href="#l35.65"></a><span id="l35.65">     // Different handling for multiselect lists</span>
<a href="#l35.66"></a><span id="l35.66" class="difflineminus">-    if (gDialog.selectMultiple.checked || !selectedOption)</span>
<a href="#l35.67"></a><span id="l35.67" class="difflineplus">+    if (gDialog.selectMultiple.checked || !selectedOption) {</span>
<a href="#l35.68"></a><span id="l35.68">       selectedOptionCount++;</span>
<a href="#l35.69"></a><span id="l35.69" class="difflineminus">-    else if (selectedOption) {</span>
<a href="#l35.70"></a><span id="l35.70" class="difflineplus">+    } else if (selectedOption) {</span>
<a href="#l35.71"></a><span id="l35.71">       selectedOption.removeAttribute(&quot;selected&quot;);</span>
<a href="#l35.72"></a><span id="l35.72" class="difflineminus">-      var column = theTree.columns.SelectSelCol;</span>
<a href="#l35.73"></a><span id="l35.73" class="difflineplus">+      let column = theTree.columns.SelectSelCol;</span>
<a href="#l35.74"></a><span id="l35.74">       theTree.invalidateColumn(column);</span>
<a href="#l35.75"></a><span id="l35.75">       selectedOption = null;</span>
<a href="#l35.76"></a><span id="l35.76">     }</span>
<a href="#l35.77"></a><span id="l35.77">     this.element.setAttribute(&quot;selected&quot;, &quot;&quot;);</span>
<a href="#l35.78"></a><span id="l35.78">     selectedOption = this.element;</span>
<a href="#l35.79"></a><span id="l35.79" class="difflineminus">-    var column = theTree.columns.SelectSelCol;</span>
<a href="#l35.80"></a><span id="l35.80" class="difflineplus">+    let column = theTree.columns.SelectSelCol;</span>
<a href="#l35.81"></a><span id="l35.81">     theTree.invalidateCell(index, column);</span>
<a href="#l35.82"></a><span id="l35.82">   }</span>
<a href="#l35.83"></a><span id="l35.83">   if (currentItem == this)</span>
<a href="#l35.84"></a><span id="l35.84">     // Also update the deck</span>
<a href="#l35.85"></a><span id="l35.85">     gDialog.optionSelected.setAttribute(&quot;checked&quot;, this.element.hasAttribute(&quot;selected&quot;));</span>
<a href="#l35.86"></a><span id="l35.86">   UpdateSelectMultiple();</span>
<a href="#l35.87"></a><span id="l35.87"> };</span>
<a href="#l35.88"></a><span id="l35.88"> </span>
<a href="#l35.89"></a><span id="l35.89" class="difflineminus">-optionObject.prototype.onFocus = function onFocus() {</span>
<a href="#l35.90"></a><span id="l35.90" class="difflineplus">+optionObject.prototype.onFocus = function() {</span>
<a href="#l35.91"></a><span id="l35.91">   gDialog.optionText.value = this.element.text;</span>
<a href="#l35.92"></a><span id="l35.92">   hasValue = this.element.hasAttribute(&quot;value&quot;);</span>
<a href="#l35.93"></a><span id="l35.93">   oldValue = this.element.value;</span>
<a href="#l35.94"></a><span id="l35.94">   gDialog.optionHasValue.checked = hasValue;</span>
<a href="#l35.95"></a><span id="l35.95">   gDialog.optionValue.value = hasValue ? this.element.value : this.element.text;</span>
<a href="#l35.96"></a><span id="l35.96">   gDialog.optionSelected.checked = this.element.hasAttribute(&quot;selected&quot;);</span>
<a href="#l35.97"></a><span id="l35.97">   gDialog.optionDisabled.checked = this.element.hasAttribute(&quot;disabled&quot;);</span>
<a href="#l35.98"></a><span id="l35.98">   gDialog.selectDeck.setAttribute(&quot;selectedIndex&quot;, &quot;2&quot;);</span>
<a href="#l35.99"></a><span id="l35.99"> };</span>
<a href="#l35.100"></a><span id="l35.100"> </span>
<a href="#l35.101"></a><span id="l35.101" class="difflineminus">-optionObject.prototype.onBlur = function onBlur() {</span>
<a href="#l35.102"></a><span id="l35.102" class="difflineplus">+optionObject.prototype.onBlur = function() {</span>
<a href="#l35.103"></a><span id="l35.103">   this.element.text = gDialog.optionText.value;</span>
<a href="#l35.104"></a><span id="l35.104">   if (gDialog.optionHasValue.checked)</span>
<a href="#l35.105"></a><span id="l35.105">     this.element.value = gDialog.optionValue.value;</span>
<a href="#l35.106"></a><span id="l35.106">   else</span>
<a href="#l35.107"></a><span id="l35.107">     this.element.removeAttribute(&quot;value&quot;);</span>
<a href="#l35.108"></a><span id="l35.108">   if (gDialog.optionSelected.checked)</span>
<a href="#l35.109"></a><span id="l35.109">     this.element.setAttribute(&quot;selected&quot;, &quot;&quot;);</span>
<a href="#l35.110"></a><span id="l35.110">   else</span>
<a href="#l35.111"></a><span id="l35.111">     this.element.removeAttribute(&quot;selected&quot;);</span>
<a href="#l35.112"></a><span id="l35.112">   if (gDialog.optionDisabled.checked)</span>
<a href="#l35.113"></a><span id="l35.113">     this.element.setAttribute(&quot;disabled&quot;, &quot;&quot;);</span>
<a href="#l35.114"></a><span id="l35.114">   else</span>
<a href="#l35.115"></a><span id="l35.115">     this.element.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l35.116"></a><span id="l35.116"> };</span>
<a href="#l35.117"></a><span id="l35.117"> </span>
<a href="#l35.118"></a><span id="l35.118" class="difflineminus">-optionObject.prototype.canDestroy = function canDestroy(prompt) {</span>
<a href="#l35.119"></a><span id="l35.119" class="difflineplus">+optionObject.prototype.canDestroy = function(prompt) {</span>
<a href="#l35.120"></a><span id="l35.120">   return true;</span>
<a href="#l35.121"></a><span id="l35.121"> /* return !prompt ||</span>
<a href="#l35.122"></a><span id="l35.122">     ConfirmWithTitle(GetString(&quot;DeleteOption&quot;),</span>
<a href="#l35.123"></a><span id="l35.123">                      GetString(&quot;DeleteOptionMsg&quot;),</span>
<a href="#l35.124"></a><span id="l35.124">                      GetString(&quot;DeleteOption&quot;));*/</span>
<a href="#l35.125"></a><span id="l35.125"> };</span>
<a href="#l35.126"></a><span id="l35.126"> </span>
<a href="#l35.127"></a><span id="l35.127" class="difflineminus">-optionObject.prototype.destroy = function destroy() {</span>
<a href="#l35.128"></a><span id="l35.128" class="difflineplus">+optionObject.prototype.destroy = function() {</span>
<a href="#l35.129"></a><span id="l35.129">   // Deselect a removed option</span>
<a href="#l35.130"></a><span id="l35.130">   if (this.element.hasAttribute(&quot;selected&quot;)) {</span>
<a href="#l35.131"></a><span id="l35.131">     selectedOptionCount--;</span>
<a href="#l35.132"></a><span id="l35.132">     selectedOption = null;</span>
<a href="#l35.133"></a><span id="l35.133">     UpdateSelectMultiple();</span>
<a href="#l35.134"></a><span id="l35.134">   }</span>
<a href="#l35.135"></a><span id="l35.135"> };</span>
<a href="#l35.136"></a><span id="l35.136"> </span>
<a href="#l35.137"></a><span id="l35.137" class="difflineat">@@ -152,58 +156,56 @@ optionObject.prototype.destroy = functio</span>
<a href="#l35.138"></a><span id="l35.138">  *      option    optgroup</span>
<a href="#l35.139"></a><span id="l35.139">  *      ...         ...</span>
<a href="#l35.140"></a><span id="l35.140">  * c) option</span>
<a href="#l35.141"></a><span id="l35.141">  *    option</span>
<a href="#l35.142"></a><span id="l35.142">  * d)   option</span>
<a href="#l35.143"></a><span id="l35.143">  *      option</span>
<a href="#l35.144"></a><span id="l35.144">  */</span>
<a href="#l35.145"></a><span id="l35.145"> </span>
<a href="#l35.146"></a><span id="l35.146" class="difflineminus">-optionObject.prototype.moveUp = function moveUp() {</span>
<a href="#l35.147"></a><span id="l35.147" class="difflineminus">-  var i;</span>
<a href="#l35.148"></a><span id="l35.148" class="difflineplus">+optionObject.prototype.moveUp = function() {</span>
<a href="#l35.149"></a><span id="l35.149">   var index = treeSelection.currentIndex;</span>
<a href="#l35.150"></a><span id="l35.150">   if (itemArray[index].level &lt; itemArray[index - 1].level + itemArray[index - 1].container) {</span>
<a href="#l35.151"></a><span id="l35.151">     // we need to repaint the tree's lines</span>
<a href="#l35.152"></a><span id="l35.152">     theTree.invalidateRange(getParentIndex(index), index);</span>
<a href="#l35.153"></a><span id="l35.153">     // a) option is just after an optgroup, so it becomes the last child</span>
<a href="#l35.154"></a><span id="l35.154">     itemArray[index].level = 2;</span>
<a href="#l35.155"></a><span id="l35.155">     theTree.view.selectionChanged();</span>
<a href="#l35.156"></a><span id="l35.156">   } else {</span>
<a href="#l35.157"></a><span id="l35.157">     // otherwise new option level is now the same as the previous item</span>
<a href="#l35.158"></a><span id="l35.158">     itemArray[index].level = itemArray[index - 1].level;</span>
<a href="#l35.159"></a><span id="l35.159">     // swap the option with the previous item</span>
<a href="#l35.160"></a><span id="l35.160">     itemArray.splice(index, 0, itemArray.splice(--index, 1)[0]);</span>
<a href="#l35.161"></a><span id="l35.161">   }</span>
<a href="#l35.162"></a><span id="l35.162">   selectTreeIndex(index, true);</span>
<a href="#l35.163"></a><span id="l35.163"> };</span>
<a href="#l35.164"></a><span id="l35.164"> </span>
<a href="#l35.165"></a><span id="l35.165" class="difflineminus">-optionObject.prototype.canMoveDown = function canMoveDown() {</span>
<a href="#l35.166"></a><span id="l35.166" class="difflineplus">+optionObject.prototype.canMoveDown = function() {</span>
<a href="#l35.167"></a><span id="l35.167">   // move down is not allowed on the last option if its level is 1</span>
<a href="#l35.168"></a><span id="l35.168">   return this.level &gt; 1 || itemArray.length - treeSelection.currentIndex &gt; 1;</span>
<a href="#l35.169"></a><span id="l35.169"> };</span>
<a href="#l35.170"></a><span id="l35.170"> </span>
<a href="#l35.171"></a><span id="l35.171" class="difflineminus">-optionObject.prototype.moveDown = function moveDown() {</span>
<a href="#l35.172"></a><span id="l35.172" class="difflineminus">-  var i;</span>
<a href="#l35.173"></a><span id="l35.173" class="difflineplus">+optionObject.prototype.moveDown = function() {</span>
<a href="#l35.174"></a><span id="l35.174">   var index = treeSelection.currentIndex;</span>
<a href="#l35.175"></a><span id="l35.175">   if (index + 1 == itemArray.length || itemArray[index].level &gt; itemArray[index + 1].level) {</span>
<a href="#l35.176"></a><span id="l35.176">     // we need to repaint the tree's lines</span>
<a href="#l35.177"></a><span id="l35.177">     theTree.invalidateRange(getParentIndex(index), index);</span>
<a href="#l35.178"></a><span id="l35.178">     // a) option is last child of an optgroup, so it moves just after</span>
<a href="#l35.179"></a><span id="l35.179">     itemArray[index].level = 1;</span>
<a href="#l35.180"></a><span id="l35.180">     theTree.view.selectionChanged();</span>
<a href="#l35.181"></a><span id="l35.181">   } else {</span>
<a href="#l35.182"></a><span id="l35.182">     // level increases if the option was preceding an optgroup</span>
<a href="#l35.183"></a><span id="l35.183">     itemArray[index].level += itemArray[index + 1].container;</span>
<a href="#l35.184"></a><span id="l35.184">     // swap the option with the next item</span>
<a href="#l35.185"></a><span id="l35.185">     itemArray.splice(index, 0, itemArray.splice(++index, 1)[0]);</span>
<a href="#l35.186"></a><span id="l35.186">   }</span>
<a href="#l35.187"></a><span id="l35.187">   selectTreeIndex(index, true);</span>
<a href="#l35.188"></a><span id="l35.188"> };</span>
<a href="#l35.189"></a><span id="l35.189"> </span>
<a href="#l35.190"></a><span id="l35.190" class="difflineminus">-optionObject.prototype.appendOption = function appendOption(child, parent) {</span>
<a href="#l35.191"></a><span id="l35.191" class="difflineplus">+optionObject.prototype.appendOption = function(child, parent) {</span>
<a href="#l35.192"></a><span id="l35.192">   // special case quick check</span>
<a href="#l35.193"></a><span id="l35.193">   if (this.level == 1)</span>
<a href="#l35.194"></a><span id="l35.194">     return gDialog.appendOption(child, 0);</span>
<a href="#l35.195"></a><span id="l35.195"> </span>
<a href="#l35.196"></a><span id="l35.196">   // append the option to the parent element</span>
<a href="#l35.197"></a><span id="l35.197">   parent = getParentIndex(parent);</span>
<a href="#l35.198"></a><span id="l35.198">   return itemArray[parent].appendOption(child, parent);</span>
<a href="#l35.199"></a><span id="l35.199"> };</span>
<a href="#l35.200"></a><span id="l35.200" class="difflineat">@@ -213,82 +215,82 @@ optionObject.prototype.appendOption = fu</span>
<a href="#l35.201"></a><span id="l35.201"> function optgroupObject(optgroup) {</span>
<a href="#l35.202"></a><span id="l35.202">   this.element = optgroup;</span>
<a href="#l35.203"></a><span id="l35.203"> }</span>
<a href="#l35.204"></a><span id="l35.204"> </span>
<a href="#l35.205"></a><span id="l35.205"> optgroupObject.prototype.level = 1;</span>
<a href="#l35.206"></a><span id="l35.206"> </span>
<a href="#l35.207"></a><span id="l35.207"> optgroupObject.prototype.container = true;</span>
<a href="#l35.208"></a><span id="l35.208"> </span>
<a href="#l35.209"></a><span id="l35.209" class="difflineminus">-optgroupObject.prototype.getCellText = function getCellText(column) {</span>
<a href="#l35.210"></a><span id="l35.210" class="difflineplus">+optgroupObject.prototype.getCellText = function(column) {</span>
<a href="#l35.211"></a><span id="l35.211">   return column.id == &quot;SelectTextCol&quot; ? this.element.label : &quot;&quot;;</span>
<a href="#l35.212"></a><span id="l35.212"> };</span>
<a href="#l35.213"></a><span id="l35.213"> </span>
<a href="#l35.214"></a><span id="l35.214" class="difflineminus">-optgroupObject.prototype.cycleCell = function cycleCell(index) {</span>
<a href="#l35.215"></a><span id="l35.215" class="difflineplus">+optgroupObject.prototype.cycleCell = function(index) {</span>
<a href="#l35.216"></a><span id="l35.216"> };</span>
<a href="#l35.217"></a><span id="l35.217"> </span>
<a href="#l35.218"></a><span id="l35.218" class="difflineminus">-optgroupObject.prototype.onFocus = function onFocus() {</span>
<a href="#l35.219"></a><span id="l35.219" class="difflineplus">+optgroupObject.prototype.onFocus = function() {</span>
<a href="#l35.220"></a><span id="l35.220">   gDialog.optgroupLabel.value = this.element.label;</span>
<a href="#l35.221"></a><span id="l35.221">   gDialog.optgroupDisabled.checked = this.element.disabled;</span>
<a href="#l35.222"></a><span id="l35.222">   gDialog.selectDeck.setAttribute(&quot;selectedIndex&quot;, &quot;1&quot;);</span>
<a href="#l35.223"></a><span id="l35.223"> };</span>
<a href="#l35.224"></a><span id="l35.224"> </span>
<a href="#l35.225"></a><span id="l35.225" class="difflineminus">-optgroupObject.prototype.onBlur = function onBlur() {</span>
<a href="#l35.226"></a><span id="l35.226" class="difflineplus">+optgroupObject.prototype.onBlur = function() {</span>
<a href="#l35.227"></a><span id="l35.227">   this.element.label = gDialog.optgroupLabel.value;</span>
<a href="#l35.228"></a><span id="l35.228">   this.element.disabled = gDialog.optgroupDisabled.checked;</span>
<a href="#l35.229"></a><span id="l35.229"> };</span>
<a href="#l35.230"></a><span id="l35.230"> </span>
<a href="#l35.231"></a><span id="l35.231" class="difflineminus">-optgroupObject.prototype.canDestroy = function canDestroy(prompt) {</span>
<a href="#l35.232"></a><span id="l35.232" class="difflineplus">+optgroupObject.prototype.canDestroy = function(prompt) {</span>
<a href="#l35.233"></a><span id="l35.233">   // Only removing empty option groups for now</span>
<a href="#l35.234"></a><span id="l35.234">   return gDialog.nextChild(treeSelection.currentIndex) - treeSelection.currentIndex == 1;</span>
<a href="#l35.235"></a><span id="l35.235"> /* &amp;&amp; (!prompt ||</span>
<a href="#l35.236"></a><span id="l35.236">     ConfirmWithTitle(GetString(&quot;DeleteOptGroup&quot;),</span>
<a href="#l35.237"></a><span id="l35.237">                      GetString(&quot;DeleteOptGroupMsg&quot;),</span>
<a href="#l35.238"></a><span id="l35.238">                      GetString(&quot;DeleteOptGroup&quot;)));</span>
<a href="#l35.239"></a><span id="l35.239"> */</span>
<a href="#l35.240"></a><span id="l35.240"> };</span>
<a href="#l35.241"></a><span id="l35.241"> </span>
<a href="#l35.242"></a><span id="l35.242" class="difflineminus">-optgroupObject.prototype.destroy = function destroy() {</span>
<a href="#l35.243"></a><span id="l35.243" class="difflineplus">+optgroupObject.prototype.destroy = function() {</span>
<a href="#l35.244"></a><span id="l35.244"> };</span>
<a href="#l35.245"></a><span id="l35.245"> </span>
<a href="#l35.246"></a><span id="l35.246" class="difflineminus">-optgroupObject.prototype.moveUp = function moveUp() {</span>
<a href="#l35.247"></a><span id="l35.247" class="difflineplus">+optgroupObject.prototype.moveUp = function() {</span>
<a href="#l35.248"></a><span id="l35.248">   // Find the index of the previous and next elements at the same level</span>
<a href="#l35.249"></a><span id="l35.249">   var index = treeSelection.currentIndex;</span>
<a href="#l35.250"></a><span id="l35.250">   var i = index;</span>
<a href="#l35.251"></a><span id="l35.251">   while (itemArray[--index].level &gt; 1);</span>
<a href="#l35.252"></a><span id="l35.252">   var j = gDialog.nextChild(i);</span>
<a href="#l35.253"></a><span id="l35.253">   // Cut out the element, cut the array in two, then join together</span>
<a href="#l35.254"></a><span id="l35.254">   var movedItems = itemArray.splice(i, j - i);</span>
<a href="#l35.255"></a><span id="l35.255">   var endItems = itemArray.splice(index);</span>
<a href="#l35.256"></a><span id="l35.256">   itemArray = itemArray.concat(movedItems).concat(endItems);</span>
<a href="#l35.257"></a><span id="l35.257">   // Repaint the lot</span>
<a href="#l35.258"></a><span id="l35.258">   theTree.invalidateRange(index, j);</span>
<a href="#l35.259"></a><span id="l35.259">   selectTreeIndex(index, true);</span>
<a href="#l35.260"></a><span id="l35.260"> };</span>
<a href="#l35.261"></a><span id="l35.261"> </span>
<a href="#l35.262"></a><span id="l35.262" class="difflineminus">-optgroupObject.prototype.canMoveDown = function canMoveDown() {</span>
<a href="#l35.263"></a><span id="l35.263" class="difflineplus">+optgroupObject.prototype.canMoveDown = function() {</span>
<a href="#l35.264"></a><span id="l35.264">   return gDialog.lastChild() &gt; treeSelection.currentIndex;</span>
<a href="#l35.265"></a><span id="l35.265"> };</span>
<a href="#l35.266"></a><span id="l35.266"> </span>
<a href="#l35.267"></a><span id="l35.267" class="difflineminus">-optgroupObject.prototype.moveDown = function moveDown() {</span>
<a href="#l35.268"></a><span id="l35.268" class="difflineplus">+optgroupObject.prototype.moveDown = function() {</span>
<a href="#l35.269"></a><span id="l35.269">   // Find the index of the next two elements at the same level</span>
<a href="#l35.270"></a><span id="l35.270">   var index = treeSelection.currentIndex;</span>
<a href="#l35.271"></a><span id="l35.271">   var i = gDialog.nextChild(index);</span>
<a href="#l35.272"></a><span id="l35.272">   var j = gDialog.nextChild(i);</span>
<a href="#l35.273"></a><span id="l35.273">   // Cut out the element, cut the array in two, then join together</span>
<a href="#l35.274"></a><span id="l35.274">   var movedItems = itemArray.splice(i, j - 1);</span>
<a href="#l35.275"></a><span id="l35.275">   var endItems = itemArray.splice(index);</span>
<a href="#l35.276"></a><span id="l35.276">   itemArray = itemArray.concat(movedItems).concat(endItems);</span>
<a href="#l35.277"></a><span id="l35.277">   // Repaint the lot</span>
<a href="#l35.278"></a><span id="l35.278">   theTree.invalidateRange(index, j);</span>
<a href="#l35.279"></a><span id="l35.279">   index += j - i;</span>
<a href="#l35.280"></a><span id="l35.280">   selectTreeIndex(index, true);</span>
<a href="#l35.281"></a><span id="l35.281"> };</span>
<a href="#l35.282"></a><span id="l35.282"> </span>
<a href="#l35.283"></a><span id="l35.283" class="difflineminus">-optgroupObject.prototype.appendOption = function appendOption(child, parent) {</span>
<a href="#l35.284"></a><span id="l35.284" class="difflineplus">+optgroupObject.prototype.appendOption = function(child, parent) {</span>
<a href="#l35.285"></a><span id="l35.285">   var index = gDialog.nextChild(parent);</span>
<a href="#l35.286"></a><span id="l35.286">   // XXX need to repaint the lines, tree won't do this</span>
<a href="#l35.287"></a><span id="l35.287">   var primaryCol = theTree.columns.getPrimaryColumn();</span>
<a href="#l35.288"></a><span id="l35.288">   theTree.invalidateCell(index - 1, primaryCol);</span>
<a href="#l35.289"></a><span id="l35.289">   // insert the wrapped object as the last child</span>
<a href="#l35.290"></a><span id="l35.290">   itemArray.splice(index, 0, new optionObject(child, 2));</span>
<a href="#l35.291"></a><span id="l35.291">   theTree.rowCountChanged(index, 1);</span>
<a href="#l35.292"></a><span id="l35.292">   selectTreeIndex(index, false);</span>
<a href="#l35.293"></a><span id="l35.293" class="difflineat">@@ -305,20 +307,20 @@ function Startup() {</span>
<a href="#l35.294"></a><span id="l35.294">   }</span>
<a href="#l35.295"></a><span id="l35.295"> </span>
<a href="#l35.296"></a><span id="l35.296">   // Get a single selected select element</span>
<a href="#l35.297"></a><span id="l35.297">   const kTagName = &quot;select&quot;;</span>
<a href="#l35.298"></a><span id="l35.298">   try {</span>
<a href="#l35.299"></a><span id="l35.299">     selectElement = editor.getSelectedElement(kTagName);</span>
<a href="#l35.300"></a><span id="l35.300">   } catch (e) {}</span>
<a href="#l35.301"></a><span id="l35.301"> </span>
<a href="#l35.302"></a><span id="l35.302" class="difflineminus">-  if (selectElement)</span>
<a href="#l35.303"></a><span id="l35.303" class="difflineplus">+  if (selectElement) {</span>
<a href="#l35.304"></a><span id="l35.304">     // We found an element and don't need to insert one</span>
<a href="#l35.305"></a><span id="l35.305">     insertNew = false;</span>
<a href="#l35.306"></a><span id="l35.306" class="difflineminus">-  else {</span>
<a href="#l35.307"></a><span id="l35.307" class="difflineplus">+  } else {</span>
<a href="#l35.308"></a><span id="l35.308">     insertNew = true;</span>
<a href="#l35.309"></a><span id="l35.309"> </span>
<a href="#l35.310"></a><span id="l35.310">     // We don't have an element selected,</span>
<a href="#l35.311"></a><span id="l35.311">     //  so create one with default attributes</span>
<a href="#l35.312"></a><span id="l35.312">     try {</span>
<a href="#l35.313"></a><span id="l35.313">       selectElement = editor.createElementWithDefaults(kTagName);</span>
<a href="#l35.314"></a><span id="l35.314">     } catch (e) {}</span>
<a href="#l35.315"></a><span id="l35.315"> </span>
<a href="#l35.316"></a><span id="l35.316" class="difflineat">@@ -349,30 +351,30 @@ function Startup() {</span>
<a href="#l35.317"></a><span id="l35.317">     removeButton:     document.getElementById(&quot;RemoveButton&quot;),</span>
<a href="#l35.318"></a><span id="l35.318">     previousButton:   document.getElementById(&quot;PreviousButton&quot;),</span>
<a href="#l35.319"></a><span id="l35.319">     nextButton:       document.getElementById(&quot;NextButton&quot;),</span>
<a href="#l35.320"></a><span id="l35.320">     tree:             document.getElementById(&quot;SelectTree&quot;),</span>
<a href="#l35.321"></a><span id="l35.321">     // wrapper methods (except MoveUp and MoveDown)</span>
<a href="#l35.322"></a><span id="l35.322">     element:          selectElement.cloneNode(false),</span>
<a href="#l35.323"></a><span id="l35.323">     level:            0,</span>
<a href="#l35.324"></a><span id="l35.324">     container:        true,</span>
<a href="#l35.325"></a><span id="l35.325" class="difflineminus">-    getCellText:      function getCellText(column) {</span>
<a href="#l35.326"></a><span id="l35.326" class="difflineplus">+    getCellText(column) {</span>
<a href="#l35.327"></a><span id="l35.327">       return column.id == &quot;SelectTextCol&quot; ? this.element.getAttribute(&quot;name&quot;) : &quot;&quot;;</span>
<a href="#l35.328"></a><span id="l35.328">     },</span>
<a href="#l35.329"></a><span id="l35.329" class="difflineminus">-    cycleCell:        function cycleCell(index) {},</span>
<a href="#l35.330"></a><span id="l35.330" class="difflineminus">-    onFocus:          function onFocus() {</span>
<a href="#l35.331"></a><span id="l35.331" class="difflineplus">+    cycleCell(index) {},</span>
<a href="#l35.332"></a><span id="l35.332" class="difflineplus">+    onFocus() {</span>
<a href="#l35.333"></a><span id="l35.333">       gDialog.selectName.value = this.element.getAttribute(&quot;name&quot;);</span>
<a href="#l35.334"></a><span id="l35.334">       gDialog.selectSize.value = this.element.getAttribute(&quot;size&quot;);</span>
<a href="#l35.335"></a><span id="l35.335">       gDialog.selectMultiple.checked = this.element.hasAttribute(&quot;multiple&quot;);</span>
<a href="#l35.336"></a><span id="l35.336">       gDialog.selectDisabled.checked = this.element.hasAttribute(&quot;disabled&quot;);</span>
<a href="#l35.337"></a><span id="l35.337">       gDialog.selectTabIndex.value = this.element.getAttribute(&quot;tabindex&quot;);</span>
<a href="#l35.338"></a><span id="l35.338">       this.selectDeck.setAttribute(&quot;selectedIndex&quot;, &quot;0&quot;);</span>
<a href="#l35.339"></a><span id="l35.339">       onNameInput();</span>
<a href="#l35.340"></a><span id="l35.340">     },</span>
<a href="#l35.341"></a><span id="l35.341" class="difflineminus">-    onBlur:           function onBlur() {</span>
<a href="#l35.342"></a><span id="l35.342" class="difflineplus">+    onBlur() {</span>
<a href="#l35.343"></a><span id="l35.343">       this.element.setAttribute(&quot;name&quot;, gDialog.selectName.value);</span>
<a href="#l35.344"></a><span id="l35.344">       if (gDialog.selectSize.value)</span>
<a href="#l35.345"></a><span id="l35.345">         this.element.setAttribute(&quot;size&quot;, gDialog.selectSize.value);</span>
<a href="#l35.346"></a><span id="l35.346">       else</span>
<a href="#l35.347"></a><span id="l35.347">         this.element.removeAttribute(&quot;size&quot;);</span>
<a href="#l35.348"></a><span id="l35.348">       if (gDialog.selectMultiple.checked)</span>
<a href="#l35.349"></a><span id="l35.349">         this.element.setAttribute(&quot;multiple&quot;, &quot;&quot;);</span>
<a href="#l35.350"></a><span id="l35.350">       else</span>
<a href="#l35.351"></a><span id="l35.351" class="difflineat">@@ -381,52 +383,52 @@ function Startup() {</span>
<a href="#l35.352"></a><span id="l35.352">         this.element.setAttribute(&quot;disabled&quot;, &quot;&quot;);</span>
<a href="#l35.353"></a><span id="l35.353">       else</span>
<a href="#l35.354"></a><span id="l35.354">         this.element.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l35.355"></a><span id="l35.355">       if (gDialog.selectTabIndex.value)</span>
<a href="#l35.356"></a><span id="l35.356">         this.element.setAttribute(&quot;tabindex&quot;, gDialog.selectTabIndex.value);</span>
<a href="#l35.357"></a><span id="l35.357">       else</span>
<a href="#l35.358"></a><span id="l35.358">         this.element.removeAttribute(&quot;tabindex&quot;);</span>
<a href="#l35.359"></a><span id="l35.359">     },</span>
<a href="#l35.360"></a><span id="l35.360" class="difflineminus">-    appendOption:     function appendOption(child, parent) {</span>
<a href="#l35.361"></a><span id="l35.361" class="difflineplus">+    appendOption(child, parent) {</span>
<a href="#l35.362"></a><span id="l35.362">       var index = itemArray.length;</span>
<a href="#l35.363"></a><span id="l35.363">       // XXX need to repaint the lines, tree won't do this</span>
<a href="#l35.364"></a><span id="l35.364">       theTree.invalidateRange(this.lastChild(), index);</span>
<a href="#l35.365"></a><span id="l35.365">       // append the wrapped object</span>
<a href="#l35.366"></a><span id="l35.366">       itemArray.push(new optionObject(child, 1));</span>
<a href="#l35.367"></a><span id="l35.367">       theTree.rowCountChanged(index, 1);</span>
<a href="#l35.368"></a><span id="l35.368">       selectTreeIndex(index, false);</span>
<a href="#l35.369"></a><span id="l35.369">     },</span>
<a href="#l35.370"></a><span id="l35.370" class="difflineminus">-    canDestroy:       function canDestroy(prompt) {</span>
<a href="#l35.371"></a><span id="l35.371" class="difflineplus">+    canDestroy(prompt) {</span>
<a href="#l35.372"></a><span id="l35.372">       return false;</span>
<a href="#l35.373"></a><span id="l35.373">     },</span>
<a href="#l35.374"></a><span id="l35.374" class="difflineminus">-    canMoveDown:      function canMoveDown() {</span>
<a href="#l35.375"></a><span id="l35.375" class="difflineplus">+    canMoveDown() {</span>
<a href="#l35.376"></a><span id="l35.376">       return false;</span>
<a href="#l35.377"></a><span id="l35.377">     },</span>
<a href="#l35.378"></a><span id="l35.378">     // helper methods</span>
<a href="#l35.379"></a><span id="l35.379">     // Find the index of the next immediate child of the select</span>
<a href="#l35.380"></a><span id="l35.380" class="difflineminus">-    nextChild:        function nextChild(index) {</span>
<a href="#l35.381"></a><span id="l35.381" class="difflineplus">+    nextChild(index) {</span>
<a href="#l35.382"></a><span id="l35.382">       while (++index &lt; itemArray.length &amp;&amp; itemArray[index].level &gt; 1);</span>
<a href="#l35.383"></a><span id="l35.383">       return index;</span>
<a href="#l35.384"></a><span id="l35.384">     },</span>
<a href="#l35.385"></a><span id="l35.385">     // Find the index of the last immediate child of the select</span>
<a href="#l35.386"></a><span id="l35.386" class="difflineminus">-    lastChild:        function lastChild() {</span>
<a href="#l35.387"></a><span id="l35.387" class="difflineplus">+    lastChild() {</span>
<a href="#l35.388"></a><span id="l35.388">       var index = itemArray.length;</span>
<a href="#l35.389"></a><span id="l35.389">       while (itemArray[--index].level &gt; 1);</span>
<a href="#l35.390"></a><span id="l35.390">       return index;</span>
<a href="#l35.391"></a><span id="l35.391">     },</span>
<a href="#l35.392"></a><span id="l35.392">   };</span>
<a href="#l35.393"></a><span id="l35.393">   // Start with the &lt;select&gt; wrapper</span>
<a href="#l35.394"></a><span id="l35.394">   itemArray = [gDialog];</span>
<a href="#l35.395"></a><span id="l35.395"> </span>
<a href="#l35.396"></a><span id="l35.396">   // We modify the actual option and optgroup elements so clone them first</span>
<a href="#l35.397"></a><span id="l35.397">   for (var child = selectElement.firstChild; child; child = child.nextSibling) {</span>
<a href="#l35.398"></a><span id="l35.398" class="difflineminus">-    if (child.tagName == &quot;OPTION&quot;)</span>
<a href="#l35.399"></a><span id="l35.399" class="difflineplus">+    if (child.tagName == &quot;OPTION&quot;) {</span>
<a href="#l35.400"></a><span id="l35.400">       itemArray.push(new optionObject(child.cloneNode(true), 1));</span>
<a href="#l35.401"></a><span id="l35.401" class="difflineminus">-    else if (child.tagName == &quot;OPTGROUP&quot;) {</span>
<a href="#l35.402"></a><span id="l35.402" class="difflineplus">+    } else if (child.tagName == &quot;OPTGROUP&quot;) {</span>
<a href="#l35.403"></a><span id="l35.403">       itemArray.push(new optgroupObject(child.cloneNode(false)));</span>
<a href="#l35.404"></a><span id="l35.404">       for (var grandchild = child.firstChild; grandchild; grandchild = grandchild.nextSibling)</span>
<a href="#l35.405"></a><span id="l35.405">         if (grandchild.tagName == &quot;OPTION&quot;)</span>
<a href="#l35.406"></a><span id="l35.406">           itemArray.push(new optionObject(grandchild.cloneNode(true), 2));</span>
<a href="#l35.407"></a><span id="l35.407">     }</span>
<a href="#l35.408"></a><span id="l35.408">   }</span>
<a href="#l35.409"></a><span id="l35.409"> </span>
<a href="#l35.410"></a><span id="l35.410">   UpdateSelectMultiple();</span>
<a href="#l35.411"></a><span id="l35.411" class="difflineat">@@ -436,72 +438,72 @@ function Startup() {</span>
<a href="#l35.412"></a><span id="l35.412">   theTree.view = {</span>
<a href="#l35.413"></a><span id="l35.413">     QueryInterface: ChromeUtils.generateQI([&quot;nsITreeView&quot;,</span>
<a href="#l35.414"></a><span id="l35.414">                                             &quot;nsISupportsWeakReference&quot;]),</span>
<a href="#l35.415"></a><span id="l35.415">     // useful for debugging</span>
<a href="#l35.416"></a><span id="l35.416">     get wrappedJSObject() { return this; },</span>
<a href="#l35.417"></a><span id="l35.417">     get rowCount() { return itemArray.length; },</span>
<a href="#l35.418"></a><span id="l35.418">     get selection() { return treeSelection; },</span>
<a href="#l35.419"></a><span id="l35.419">     set selection(selection) { return treeSelection = selection; },</span>
<a href="#l35.420"></a><span id="l35.420" class="difflineminus">-    getRowProperties: function getRowProperties(index) { return &quot;&quot;; },</span>
<a href="#l35.421"></a><span id="l35.421" class="difflineplus">+    getRowProperties(index) { return &quot;&quot;; },</span>
<a href="#l35.422"></a><span id="l35.422">     // could have used a wrapper for this</span>
<a href="#l35.423"></a><span id="l35.423" class="difflineminus">-    getCellProperties: function getCellProperties(index, column) {</span>
<a href="#l35.424"></a><span id="l35.424" class="difflineplus">+    getCellProperties(index, column) {</span>
<a href="#l35.425"></a><span id="l35.425">       if (column.id == &quot;SelectSelCol&quot; &amp;&amp; !itemArray[index].container)</span>
<a href="#l35.426"></a><span id="l35.426">         return &quot;checked-&quot; + itemArray[index].element.hasAttribute(&quot;selected&quot;);</span>
<a href="#l35.427"></a><span id="l35.427">       return &quot;&quot;;</span>
<a href="#l35.428"></a><span id="l35.428">     },</span>
<a href="#l35.429"></a><span id="l35.429" class="difflineminus">-    getColumnProperties: function getColumnProperties(column) { return &quot;&quot;; },</span>
<a href="#l35.430"></a><span id="l35.430" class="difflineplus">+    getColumnProperties(column) { return &quot;&quot;; },</span>
<a href="#l35.431"></a><span id="l35.431">     // get info from wrapper</span>
<a href="#l35.432"></a><span id="l35.432" class="difflineminus">-    isContainer: function isContainer(index) { return itemArray[index].container; },</span>
<a href="#l35.433"></a><span id="l35.433" class="difflineminus">-    isContainerOpen: function isContainerOpen(index) { return true; },</span>
<a href="#l35.434"></a><span id="l35.434" class="difflineminus">-    isContainerEmpty: function isContainerEmpty(index) { return true; },</span>
<a href="#l35.435"></a><span id="l35.435" class="difflineminus">-    isSeparator: function isSeparator(index) { return false; },</span>
<a href="#l35.436"></a><span id="l35.436" class="difflineminus">-    isSorted: function isSorted() { return false; },</span>
<a href="#l35.437"></a><span id="l35.437" class="difflineplus">+    isContainer(index) { return itemArray[index].container; },</span>
<a href="#l35.438"></a><span id="l35.438" class="difflineplus">+    isContainerOpen(index) { return true; },</span>
<a href="#l35.439"></a><span id="l35.439" class="difflineplus">+    isContainerEmpty(index) { return true; },</span>
<a href="#l35.440"></a><span id="l35.440" class="difflineplus">+    isSeparator(index) { return false; },</span>
<a href="#l35.441"></a><span id="l35.441" class="difflineplus">+    isSorted() { return false; },</span>
<a href="#l35.442"></a><span id="l35.442">     // d&amp;d not implemented yet!</span>
<a href="#l35.443"></a><span id="l35.443" class="difflineminus">-    canDrop: function canDrop(index, orientation) { return false; },</span>
<a href="#l35.444"></a><span id="l35.444" class="difflineminus">-    drop: function drop(index, orientation) { alert(&quot;drop:&quot; + index + &quot;,&quot; + orientation); },</span>
<a href="#l35.445"></a><span id="l35.445" class="difflineplus">+    canDrop(index, orientation) { return false; },</span>
<a href="#l35.446"></a><span id="l35.446" class="difflineplus">+    drop(index, orientation) { alert(&quot;drop:&quot; + index + &quot;,&quot; + orientation); },</span>
<a href="#l35.447"></a><span id="l35.447">     // same as the global helper</span>
<a href="#l35.448"></a><span id="l35.448">     getParentIndex,</span>
<a href="#l35.449"></a><span id="l35.449">     // tree needs to know when to paint lines</span>
<a href="#l35.450"></a><span id="l35.450" class="difflineminus">-    hasNextSibling: function hasNextSibling(index, after) {</span>
<a href="#l35.451"></a><span id="l35.451" class="difflineplus">+    hasNextSibling(index, after) {</span>
<a href="#l35.452"></a><span id="l35.452">       if (!index)</span>
<a href="#l35.453"></a><span id="l35.453">         return false;</span>
<a href="#l35.454"></a><span id="l35.454">       var level = itemArray[index].level;</span>
<a href="#l35.455"></a><span id="l35.455">       while (++after &lt; itemArray.length)</span>
<a href="#l35.456"></a><span id="l35.456">         switch (level - itemArray[after].level) {</span>
<a href="#l35.457"></a><span id="l35.457">         case 1: return false;</span>
<a href="#l35.458"></a><span id="l35.458">         case 0: return true;</span>
<a href="#l35.459"></a><span id="l35.459">         }</span>
<a href="#l35.460"></a><span id="l35.460">       return false;</span>
<a href="#l35.461"></a><span id="l35.461">     },</span>
<a href="#l35.462"></a><span id="l35.462" class="difflineminus">-    getLevel: function getLevel(index) { return itemArray[index].level; },</span>
<a href="#l35.463"></a><span id="l35.463" class="difflineminus">-    getImageSrc: function getImageSrc(index, column) { },</span>
<a href="#l35.464"></a><span id="l35.464" class="difflineminus">-    getProgressMode: function getProgressMode(index, column) { },</span>
<a href="#l35.465"></a><span id="l35.465" class="difflineminus">-    getCellValue: function getCellValue(index, column) { },</span>
<a href="#l35.466"></a><span id="l35.466" class="difflineminus">-    getCellText: function getCellText(index, column) { return itemArray[index].getCellText(column); },</span>
<a href="#l35.467"></a><span id="l35.467" class="difflineminus">-    setTree: function setTree(tree) { this.tree = tree; },</span>
<a href="#l35.468"></a><span id="l35.468" class="difflineminus">-    toggleOpenState: function toggleOpenState(index) { },</span>
<a href="#l35.469"></a><span id="l35.469" class="difflineminus">-    cycleHeader: function cycleHeader(col) { },</span>
<a href="#l35.470"></a><span id="l35.470" class="difflineminus">-    selectionChanged: function selectionChanged() {</span>
<a href="#l35.471"></a><span id="l35.471" class="difflineplus">+    getLevel(index) { return itemArray[index].level; },</span>
<a href="#l35.472"></a><span id="l35.472" class="difflineplus">+    getImageSrc(index, column) { },</span>
<a href="#l35.473"></a><span id="l35.473" class="difflineplus">+    getProgressMode(index, column) { },</span>
<a href="#l35.474"></a><span id="l35.474" class="difflineplus">+    getCellValue(index, column) { },</span>
<a href="#l35.475"></a><span id="l35.475" class="difflineplus">+    getCellText(index, column) { return itemArray[index].getCellText(column); },</span>
<a href="#l35.476"></a><span id="l35.476" class="difflineplus">+    setTree(tree) { this.tree = tree; },</span>
<a href="#l35.477"></a><span id="l35.477" class="difflineplus">+    toggleOpenState(index) { },</span>
<a href="#l35.478"></a><span id="l35.478" class="difflineplus">+    cycleHeader(col) { },</span>
<a href="#l35.479"></a><span id="l35.479" class="difflineplus">+    selectionChanged() {</span>
<a href="#l35.480"></a><span id="l35.480">       // Save current values and update buttons and deck</span>
<a href="#l35.481"></a><span id="l35.481">       if (currentItem)</span>
<a href="#l35.482"></a><span id="l35.482">         currentItem.onBlur();</span>
<a href="#l35.483"></a><span id="l35.483">       var currentIndex = treeSelection.currentIndex;</span>
<a href="#l35.484"></a><span id="l35.484">       currentItem = itemArray[currentIndex];</span>
<a href="#l35.485"></a><span id="l35.485">       gDialog.removeButton.disabled = !currentItem.canDestroy();</span>
<a href="#l35.486"></a><span id="l35.486">       gDialog.previousButton.disabled = currentIndex &lt; 2;</span>
<a href="#l35.487"></a><span id="l35.487">       gDialog.nextButton.disabled = !currentItem.canMoveDown();</span>
<a href="#l35.488"></a><span id="l35.488">       // For Advanced Edit</span>
<a href="#l35.489"></a><span id="l35.489">       globalElement = currentItem.element;</span>
<a href="#l35.490"></a><span id="l35.490">       currentItem.onFocus();</span>
<a href="#l35.491"></a><span id="l35.491">     },</span>
<a href="#l35.492"></a><span id="l35.492" class="difflineminus">-    cycleCell: function cycleCell(index, column) { itemArray[index].cycleCell(index); },</span>
<a href="#l35.493"></a><span id="l35.493" class="difflineminus">-    isEditable: function isEditable(index, column) { return false; },</span>
<a href="#l35.494"></a><span id="l35.494" class="difflineminus">-    performAction: function performAction(action) { },</span>
<a href="#l35.495"></a><span id="l35.495" class="difflineminus">-    performActionOnCell: function performActionOnCell(action, index, column) { },</span>
<a href="#l35.496"></a><span id="l35.496" class="difflineplus">+    cycleCell(index, column) { itemArray[index].cycleCell(index); },</span>
<a href="#l35.497"></a><span id="l35.497" class="difflineplus">+    isEditable(index, column) { return false; },</span>
<a href="#l35.498"></a><span id="l35.498" class="difflineplus">+    performAction(action) { },</span>
<a href="#l35.499"></a><span id="l35.499" class="difflineplus">+    performActionOnCell(action, index, column) { },</span>
<a href="#l35.500"></a><span id="l35.500">   };</span>
<a href="#l35.501"></a><span id="l35.501">   treeSelection.select(0);</span>
<a href="#l35.502"></a><span id="l35.502">   currentItem = gDialog;</span>
<a href="#l35.503"></a><span id="l35.503">   // onNameInput();</span>
<a href="#l35.504"></a><span id="l35.504"> </span>
<a href="#l35.505"></a><span id="l35.505">   SetTextboxFocus(gDialog.selectName);</span>
<a href="#l35.506"></a><span id="l35.506"> </span>
<a href="#l35.507"></a><span id="l35.507">   SetWindowLocation();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdSpellCheck.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdSpellCheck.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -1,13 +1,17 @@</span>
<a href="#l36.4"></a><span id="l36.4"> /* -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l36.5"></a><span id="l36.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l36.6"></a><span id="l36.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l36.7"></a><span id="l36.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l36.8"></a><span id="l36.8"> </span>
<a href="#l36.9"></a><span id="l36.9" class="difflineplus">+/* import-globals-from ../../../../mail/base/content/utilityOverlay.js */</span>
<a href="#l36.10"></a><span id="l36.10" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l36.11"></a><span id="l36.11" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineplus">+</span>
<a href="#l36.13"></a><span id="l36.13"> var {InlineSpellChecker} = ChromeUtils.import(&quot;resource://gre/modules/InlineSpellChecker.jsm&quot;);</span>
<a href="#l36.14"></a><span id="l36.14"> </span>
<a href="#l36.15"></a><span id="l36.15"> var gMisspelledWord;</span>
<a href="#l36.16"></a><span id="l36.16"> var gSpellChecker = null;</span>
<a href="#l36.17"></a><span id="l36.17"> var gAllowSelectWord = true;</span>
<a href="#l36.18"></a><span id="l36.18"> var gPreviousReplaceWord = &quot;&quot;;</span>
<a href="#l36.19"></a><span id="l36.19"> var gFirstTime = true;</span>
<a href="#l36.20"></a><span id="l36.20"> var gLastSelectedLang = null;</span>
<a href="#l36.21"></a><span id="l36.21" class="difflineat">@@ -228,17 +232,16 @@ function CheckWord() {</span>
<a href="#l36.22"></a><span id="l36.22">       // Suppress being able to select the message text</span>
<a href="#l36.23"></a><span id="l36.23">       gAllowSelectWord = false;</span>
<a href="#l36.24"></a><span id="l36.24">     }</span>
<a href="#l36.25"></a><span id="l36.25">   }</span>
<a href="#l36.26"></a><span id="l36.26"> }</span>
<a href="#l36.27"></a><span id="l36.27"> </span>
<a href="#l36.28"></a><span id="l36.28"> function SelectSuggestedWord() {</span>
<a href="#l36.29"></a><span id="l36.29">   if (gAllowSelectWord) {</span>
<a href="#l36.30"></a><span id="l36.30" class="difflineminus">-    var selectedItem;</span>
<a href="#l36.31"></a><span id="l36.31">     if (gDialog.SuggestedList.selectedItem) {</span>
<a href="#l36.32"></a><span id="l36.32">       var selValue = gDialog.SuggestedList.selectedItem.label;</span>
<a href="#l36.33"></a><span id="l36.33">       gDialog.ReplaceWordInput.value = selValue;</span>
<a href="#l36.34"></a><span id="l36.34">       gPreviousReplaceWord = selValue;</span>
<a href="#l36.35"></a><span id="l36.35">     } else {</span>
<a href="#l36.36"></a><span id="l36.36">       gDialog.ReplaceWordInput.value = gPreviousReplaceWord;</span>
<a href="#l36.37"></a><span id="l36.37">     }</span>
<a href="#l36.38"></a><span id="l36.38">     SetReplaceEnable();</span>
<a href="#l36.39"></a><span id="l36.39" class="difflineat">@@ -247,17 +250,16 @@ function SelectSuggestedWord() {</span>
<a href="#l36.40"></a><span id="l36.40"> </span>
<a href="#l36.41"></a><span id="l36.41"> function ChangeReplaceWord() {</span>
<a href="#l36.42"></a><span id="l36.42">   // Calling this triggers SelectSuggestedWord(),</span>
<a href="#l36.43"></a><span id="l36.43">   //  so temporarily suppress the effect of that</span>
<a href="#l36.44"></a><span id="l36.44">   var saveAllow = gAllowSelectWord;</span>
<a href="#l36.45"></a><span id="l36.45">   gAllowSelectWord = false;</span>
<a href="#l36.46"></a><span id="l36.46"> </span>
<a href="#l36.47"></a><span id="l36.47">   // Select matching word in list</span>
<a href="#l36.48"></a><span id="l36.48" class="difflineminus">-  var newIndex = -1;</span>
<a href="#l36.49"></a><span id="l36.49">   var newSelectedItem;</span>
<a href="#l36.50"></a><span id="l36.50">   var replaceWord = TrimString(gDialog.ReplaceWordInput.value);</span>
<a href="#l36.51"></a><span id="l36.51">   if (replaceWord) {</span>
<a href="#l36.52"></a><span id="l36.52">     for (var i = 0; i &lt; gDialog.SuggestedList.getRowCount(); i++) {</span>
<a href="#l36.53"></a><span id="l36.53">       var item = gDialog.SuggestedList.getItemAtIndex(i);</span>
<a href="#l36.54"></a><span id="l36.54">       if (item.label == replaceWord) {</span>
<a href="#l36.55"></a><span id="l36.55">         newSelectedItem = item;</span>
<a href="#l36.56"></a><span id="l36.56">         break;</span>
<a href="#l36.57"></a><span id="l36.57" class="difflineat">@@ -376,21 +378,18 @@ function FillSuggestedList(misspelledWor</span>
<a href="#l36.58"></a><span id="l36.58">   // Clear the current contents of the list</span>
<a href="#l36.59"></a><span id="l36.59">   gAllowSelectWord = false;</span>
<a href="#l36.60"></a><span id="l36.60">   ClearListbox(list);</span>
<a href="#l36.61"></a><span id="l36.61">   var item;</span>
<a href="#l36.62"></a><span id="l36.62"> </span>
<a href="#l36.63"></a><span id="l36.63">   if (misspelledWord.length &gt; 0) {</span>
<a href="#l36.64"></a><span id="l36.64">     // Get suggested words until an empty string is returned</span>
<a href="#l36.65"></a><span id="l36.65">     var count = 0;</span>
<a href="#l36.66"></a><span id="l36.66" class="difflineminus">-    var firstWord = 0;</span>
<a href="#l36.67"></a><span id="l36.67">     do {</span>
<a href="#l36.68"></a><span id="l36.68">       var word = gSpellChecker.GetSuggestedWord();</span>
<a href="#l36.69"></a><span id="l36.69" class="difflineminus">-      if (count == 0)</span>
<a href="#l36.70"></a><span id="l36.70" class="difflineminus">-        firstWord = word;</span>
<a href="#l36.71"></a><span id="l36.71">       if (word.length &gt; 0) {</span>
<a href="#l36.72"></a><span id="l36.72">         list.appendItem(word, &quot;&quot;);</span>
<a href="#l36.73"></a><span id="l36.73">         count++;</span>
<a href="#l36.74"></a><span id="l36.74">       }</span>
<a href="#l36.75"></a><span id="l36.75">     } while (word.length &gt; 0);</span>
<a href="#l36.76"></a><span id="l36.76"> </span>
<a href="#l36.77"></a><span id="l36.77">     if (count == 0) {</span>
<a href="#l36.78"></a><span id="l36.78">       // No suggestions - show a message but don't let user select it</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdTableProps.js</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdTableProps.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l37.4"></a><span id="l37.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l37.5"></a><span id="l37.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l37.6"></a><span id="l37.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l37.7"></a><span id="l37.7"> </span>
<a href="#l37.8"></a><span id="l37.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l37.9"></a><span id="l37.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l37.10"></a><span id="l37.10" class="difflineplus">+</span>
<a href="#l37.11"></a><span id="l37.11"> // Cancel() is in EdDialogCommon.js</span>
<a href="#l37.12"></a><span id="l37.12"> </span>
<a href="#l37.13"></a><span id="l37.13"> var gTableElement;</span>
<a href="#l37.14"></a><span id="l37.14"> var gCellElement;</span>
<a href="#l37.15"></a><span id="l37.15"> var gTableCaptionElement;</span>
<a href="#l37.16"></a><span id="l37.16"> var globalCellElement;</span>
<a href="#l37.17"></a><span id="l37.17"> var globalTableElement;</span>
<a href="#l37.18"></a><span id="l37.18"> var gValidateTab;</span>
<a href="#l37.19"></a><span id="l37.19" class="difflineat">@@ -498,17 +501,16 @@ function ChangeSelection(newType) {</span>
<a href="#l37.20"></a><span id="l37.20">   SetSelectionButtons();</span>
<a href="#l37.21"></a><span id="l37.21"> </span>
<a href="#l37.22"></a><span id="l37.22">   // Note: globalCellElement should still be a clone of gCellElement</span>
<a href="#l37.23"></a><span id="l37.23"> }</span>
<a href="#l37.24"></a><span id="l37.24"> </span>
<a href="#l37.25"></a><span id="l37.25"> function MoveSelection(forward) {</span>
<a href="#l37.26"></a><span id="l37.26">   var newRowIndex = gCurRowIndex;</span>
<a href="#l37.27"></a><span id="l37.27">   var newColIndex = gCurColIndex;</span>
<a href="#l37.28"></a><span id="l37.28" class="difflineminus">-  var focusCell;</span>
<a href="#l37.29"></a><span id="l37.29">   var inRow = false;</span>
<a href="#l37.30"></a><span id="l37.30"> </span>
<a href="#l37.31"></a><span id="l37.31">   if (gSelectedCellsType == SELECT_ROW) {</span>
<a href="#l37.32"></a><span id="l37.32">     newRowIndex += (forward ? 1 : -1);</span>
<a href="#l37.33"></a><span id="l37.33"> </span>
<a href="#l37.34"></a><span id="l37.34">     // Wrap around if before first or after last row</span>
<a href="#l37.35"></a><span id="l37.35">     if (newRowIndex &lt; 0)</span>
<a href="#l37.36"></a><span id="l37.36">       newRowIndex = gLastRowIndex;</span>
<a href="#l37.37"></a><span id="l37.37" class="difflineat">@@ -522,18 +524,17 @@ function MoveSelection(forward) {</span>
<a href="#l37.38"></a><span id="l37.38">     // Cell or column:</span>
<a href="#l37.39"></a><span id="l37.39">     if (!forward)</span>
<a href="#l37.40"></a><span id="l37.40">       newColIndex--;</span>
<a href="#l37.41"></a><span id="l37.41"> </span>
<a href="#l37.42"></a><span id="l37.42">     if (gSelectedCellsType == SELECT_CELL) {</span>
<a href="#l37.43"></a><span id="l37.43">       // Skip to next cell</span>
<a href="#l37.44"></a><span id="l37.44">       if (forward)</span>
<a href="#l37.45"></a><span id="l37.45">         newColIndex += gCurColSpan;</span>
<a href="#l37.46"></a><span id="l37.46" class="difflineminus">-    } else  // SELECT_COLUMN</span>
<a href="#l37.47"></a><span id="l37.47" class="difflineminus">-    {</span>
<a href="#l37.48"></a><span id="l37.48" class="difflineplus">+    } else { // SELECT_COLUMN</span>
<a href="#l37.49"></a><span id="l37.49">       // Use first cell in column for focus cell</span>
<a href="#l37.50"></a><span id="l37.50">       newRowIndex = 0;</span>
<a href="#l37.51"></a><span id="l37.51"> </span>
<a href="#l37.52"></a><span id="l37.52">       // Don't skip by colspan,</span>
<a href="#l37.53"></a><span id="l37.53">       //  but find first cell in next cellmap column</span>
<a href="#l37.54"></a><span id="l37.54">       if (forward)</span>
<a href="#l37.55"></a><span id="l37.55">         newColIndex++;</span>
<a href="#l37.56"></a><span id="l37.56">     }</span>
<a href="#l37.57"></a><span id="l37.57" class="difflineat">@@ -580,27 +581,27 @@ function MoveSelection(forward) {</span>
<a href="#l37.58"></a><span id="l37.58">       return;</span>
<a href="#l37.59"></a><span id="l37.59">     }</span>
<a href="#l37.60"></a><span id="l37.60">     if (inRow) {</span>
<a href="#l37.61"></a><span id="l37.61">       if (gCellData.startRowIndex == newRowIndex)</span>
<a href="#l37.62"></a><span id="l37.62">         break;</span>
<a href="#l37.63"></a><span id="l37.63">       else</span>
<a href="#l37.64"></a><span id="l37.64">         // Cell spans from a row above, look for the next cell in row</span>
<a href="#l37.65"></a><span id="l37.65">         newRowIndex += gCellData.actualRowSpan;</span>
<a href="#l37.66"></a><span id="l37.66" class="difflineminus">-    } else if (gCellData.startColIndex == newColIndex)</span>
<a href="#l37.67"></a><span id="l37.67" class="difflineminus">-        break;</span>
<a href="#l37.68"></a><span id="l37.68" class="difflineminus">-      else</span>
<a href="#l37.69"></a><span id="l37.69" class="difflineminus">-        // Cell spans from a Col above, look for the next cell in column</span>
<a href="#l37.70"></a><span id="l37.70" class="difflineminus">-        newColIndex += gCellData.actualColSpan;</span>
<a href="#l37.71"></a><span id="l37.71" class="difflineplus">+    } else if (gCellData.startColIndex == newColIndex) {</span>
<a href="#l37.72"></a><span id="l37.72" class="difflineplus">+      break;</span>
<a href="#l37.73"></a><span id="l37.73" class="difflineplus">+    } else {</span>
<a href="#l37.74"></a><span id="l37.74" class="difflineplus">+      // Cell spans from a Col above, look for the next cell in column</span>
<a href="#l37.75"></a><span id="l37.75" class="difflineplus">+      newColIndex += gCellData.actualColSpan;</span>
<a href="#l37.76"></a><span id="l37.76" class="difflineplus">+    }</span>
<a href="#l37.77"></a><span id="l37.77">   }</span>
<a href="#l37.78"></a><span id="l37.78">   while (true);</span>
<a href="#l37.79"></a><span id="l37.79"> </span>
<a href="#l37.80"></a><span id="l37.80">   // Save data for current selection before changing</span>
<a href="#l37.81"></a><span id="l37.81" class="difflineminus">-  if (gCellDataChanged) // &amp;&amp; gDialog.ApplyBeforeMove.checked)</span>
<a href="#l37.82"></a><span id="l37.82" class="difflineminus">-  {</span>
<a href="#l37.83"></a><span id="l37.83" class="difflineplus">+  if (gCellDataChanged) { // &amp;&amp; gDialog.ApplyBeforeMove.checked)</span>
<a href="#l37.84"></a><span id="l37.84">     if (!ValidateCellData())</span>
<a href="#l37.85"></a><span id="l37.85">       return;</span>
<a href="#l37.86"></a><span id="l37.86"> </span>
<a href="#l37.87"></a><span id="l37.87">     gActiveEditor.beginTransaction();</span>
<a href="#l37.88"></a><span id="l37.88">     // Apply changes to all selected cells</span>
<a href="#l37.89"></a><span id="l37.89">     ApplyCellAttributes();</span>
<a href="#l37.90"></a><span id="l37.90">     gActiveEditor.endTransaction();</span>
<a href="#l37.91"></a><span id="l37.91"> </span>
<a href="#l37.92"></a><span id="l37.92" class="difflineat">@@ -653,17 +654,17 @@ function DoCellSelection() {</span>
<a href="#l37.93"></a><span id="l37.93">       case SELECT_ROW:</span>
<a href="#l37.94"></a><span id="l37.94">         gActiveEditor.selectTableRow();</span>
<a href="#l37.95"></a><span id="l37.95">         break;</span>
<a href="#l37.96"></a><span id="l37.96">       default:</span>
<a href="#l37.97"></a><span id="l37.97">         gActiveEditor.selectTableColumn();</span>
<a href="#l37.98"></a><span id="l37.98">         break;</span>
<a href="#l37.99"></a><span id="l37.99">     }</span>
<a href="#l37.100"></a><span id="l37.100">     // Get number of cells selected</span>
<a href="#l37.101"></a><span id="l37.101" class="difflineminus">-    var tableOrCellElement = gActiveEditor.getSelectedOrParentTableElement(tagNameObj, countObj);</span>
<a href="#l37.102"></a><span id="l37.102" class="difflineplus">+    gActiveEditor.getSelectedOrParentTableElement(tagNameObj, countObj);</span>
<a href="#l37.103"></a><span id="l37.103">   } catch (e) {}</span>
<a href="#l37.104"></a><span id="l37.104"> </span>
<a href="#l37.105"></a><span id="l37.105">   if (tagNameObj.value == &quot;td&quot;)</span>
<a href="#l37.106"></a><span id="l37.106">     gSelectedCellCount = countObj.value;</span>
<a href="#l37.107"></a><span id="l37.107">   else</span>
<a href="#l37.108"></a><span id="l37.108">     gSelectedCellCount = 0;</span>
<a href="#l37.109"></a><span id="l37.109"> </span>
<a href="#l37.110"></a><span id="l37.110">   // Currently, we can only allow advanced editing on ONE cell element at a time</span>
<a href="#l37.111"></a><span id="l37.111" class="difflineat">@@ -741,17 +742,17 @@ function ValidateTableData() {</span>
<a href="#l37.112"></a><span id="l37.112">   if (gValidationError) return false;</span>
<a href="#l37.113"></a><span id="l37.113"> </span>
<a href="#l37.114"></a><span id="l37.114">   if (gUseCSS) {</span>
<a href="#l37.115"></a><span id="l37.115">     ValidateNumber(gDialog.TableHeightInput, gDialog.TableHeightUnits,</span>
<a href="#l37.116"></a><span id="l37.116">                    1, gMaxTableSize, globalTableElement, &quot;height&quot;);</span>
<a href="#l37.117"></a><span id="l37.117">     if (gValidationError) return false;</span>
<a href="#l37.118"></a><span id="l37.118">   }</span>
<a href="#l37.119"></a><span id="l37.119"> </span>
<a href="#l37.120"></a><span id="l37.120" class="difflineminus">-  var border = ValidateNumber(gDialog.BorderWidthInput, null, 0, gMaxPixels, globalTableElement, &quot;border&quot;);</span>
<a href="#l37.121"></a><span id="l37.121" class="difflineplus">+  ValidateNumber(gDialog.BorderWidthInput, null, 0, gMaxPixels, globalTableElement, &quot;border&quot;);</span>
<a href="#l37.122"></a><span id="l37.122">   // TODO: Deal with &quot;BORDER&quot; without value issue</span>
<a href="#l37.123"></a><span id="l37.123">   if (gValidationError) return false;</span>
<a href="#l37.124"></a><span id="l37.124"> </span>
<a href="#l37.125"></a><span id="l37.125">   ValidateNumber(gDialog.SpacingInput, null, 0, gMaxPixels, globalTableElement, &quot;cellspacing&quot;);</span>
<a href="#l37.126"></a><span id="l37.126">   if (gValidationError) return false;</span>
<a href="#l37.127"></a><span id="l37.127"> </span>
<a href="#l37.128"></a><span id="l37.128">   ValidateNumber(gDialog.PaddingInput, null, 0, gMaxPixels, globalTableElement, &quot;cellpadding&quot;);</span>
<a href="#l37.129"></a><span id="l37.129">   if (gValidationError) return false;</span>
<a href="#l37.130"></a><span id="l37.130" class="difflineat">@@ -872,16 +873,17 @@ function CloneAttribute(destElement, src</span>
<a href="#l37.131"></a><span id="l37.131">   try {</span>
<a href="#l37.132"></a><span id="l37.132">     if (!value || value.length == 0)</span>
<a href="#l37.133"></a><span id="l37.133">       gActiveEditor.removeAttributeOrEquivalent(destElement, attr, false);</span>
<a href="#l37.134"></a><span id="l37.134">     else</span>
<a href="#l37.135"></a><span id="l37.135">       gActiveEditor.setAttributeOrEquivalent(destElement, attr, value, false);</span>
<a href="#l37.136"></a><span id="l37.136">   } catch (e) {}</span>
<a href="#l37.137"></a><span id="l37.137"> }</span>
<a href="#l37.138"></a><span id="l37.138"> </span>
<a href="#l37.139"></a><span id="l37.139" class="difflineplus">+/* eslint-disable complexity */</span>
<a href="#l37.140"></a><span id="l37.140"> function ApplyTableAttributes() {</span>
<a href="#l37.141"></a><span id="l37.141">   var newAlign = gDialog.TableCaptionList.value;</span>
<a href="#l37.142"></a><span id="l37.142">   if (!newAlign) newAlign = &quot;&quot;;</span>
<a href="#l37.143"></a><span id="l37.143"> </span>
<a href="#l37.144"></a><span id="l37.144">   if (gTableCaptionElement) {</span>
<a href="#l37.145"></a><span id="l37.145">     // Get current alignment</span>
<a href="#l37.146"></a><span id="l37.146">     var align = GetHTMLOrCSSStyleValue(gTableCaptionElement, &quot;align&quot;, &quot;caption-side&quot;).toLowerCase();</span>
<a href="#l37.147"></a><span id="l37.147">     // This is the default</span>
<a href="#l37.148"></a><span id="l37.148" class="difflineat">@@ -938,48 +940,45 @@ function ApplyTableAttributes() {</span>
<a href="#l37.149"></a><span id="l37.149">           gRowCount = gNewRowCount;</span>
<a href="#l37.150"></a><span id="l37.150">           gLastRowIndex = gRowCount - 1;</span>
<a href="#l37.151"></a><span id="l37.151">           // Put selection back where it was</span>
<a href="#l37.152"></a><span id="l37.152">           ChangeSelection(RESET_SELECTION);</span>
<a href="#l37.153"></a><span id="l37.153">         } catch (ex) {</span>
<a href="#l37.154"></a><span id="l37.154">           dump(&quot;FAILED TO FIND FIRST CELL IN LAST ROW\n&quot;);</span>
<a href="#l37.155"></a><span id="l37.155">         }</span>
<a href="#l37.156"></a><span id="l37.156">       }</span>
<a href="#l37.157"></a><span id="l37.157" class="difflineminus">-    } else {</span>
<a href="#l37.158"></a><span id="l37.158" class="difflineminus">-      // Delete rows</span>
<a href="#l37.159"></a><span id="l37.159" class="difflineminus">-      if (gCanDelete) {</span>
<a href="#l37.160"></a><span id="l37.160" class="difflineminus">-        // Find first cell starting in first row we delete</span>
<a href="#l37.161"></a><span id="l37.161" class="difflineminus">-        var firstDeleteRow = gRowCount + countDelta;</span>
<a href="#l37.162"></a><span id="l37.162" class="difflineminus">-        foundCell = false;</span>
<a href="#l37.163"></a><span id="l37.163" class="difflineminus">-        for (i = 0; i &lt;= gLastColIndex; i++) {</span>
<a href="#l37.164"></a><span id="l37.164" class="difflineminus">-          if (!GetCellData(firstDeleteRow, i))</span>
<a href="#l37.165"></a><span id="l37.165" class="difflineminus">-            break; // We failed to find a cell</span>
<a href="#l37.166"></a><span id="l37.166" class="difflineplus">+    } else if (gCanDelete) { // Delete rows</span>
<a href="#l37.167"></a><span id="l37.167" class="difflineplus">+      // Find first cell starting in first row we delete</span>
<a href="#l37.168"></a><span id="l37.168" class="difflineplus">+      var firstDeleteRow = gRowCount + countDelta;</span>
<a href="#l37.169"></a><span id="l37.169" class="difflineplus">+      foundCell = false;</span>
<a href="#l37.170"></a><span id="l37.170" class="difflineplus">+      for (i = 0; i &lt;= gLastColIndex; i++) {</span>
<a href="#l37.171"></a><span id="l37.171" class="difflineplus">+        if (!GetCellData(firstDeleteRow, i))</span>
<a href="#l37.172"></a><span id="l37.172" class="difflineplus">+          break; // We failed to find a cell</span>
<a href="#l37.173"></a><span id="l37.173"> </span>
<a href="#l37.174"></a><span id="l37.174" class="difflineminus">-          if (gCellData.startRowIndex == firstDeleteRow) {</span>
<a href="#l37.175"></a><span id="l37.175" class="difflineminus">-            foundCell = true;</span>
<a href="#l37.176"></a><span id="l37.176" class="difflineminus">-            break;</span>
<a href="#l37.177"></a><span id="l37.177" class="difflineminus">-          }</span>
<a href="#l37.178"></a><span id="l37.178" class="difflineplus">+        if (gCellData.startRowIndex == firstDeleteRow) {</span>
<a href="#l37.179"></a><span id="l37.179" class="difflineplus">+          foundCell = true;</span>
<a href="#l37.180"></a><span id="l37.180" class="difflineplus">+          break;</span>
<a href="#l37.181"></a><span id="l37.181">         }</span>
<a href="#l37.182"></a><span id="l37.182" class="difflineminus">-        if (foundCell) {</span>
<a href="#l37.183"></a><span id="l37.183" class="difflineminus">-          try {</span>
<a href="#l37.184"></a><span id="l37.184" class="difflineminus">-            // Move selection to the cell we found</span>
<a href="#l37.185"></a><span id="l37.185" class="difflineminus">-            gSelection.collapse(gCellData.value, 0);</span>
<a href="#l37.186"></a><span id="l37.186" class="difflineminus">-            gActiveEditor.deleteTableRow(-countDelta);</span>
<a href="#l37.187"></a><span id="l37.187" class="difflineminus">-            gRowCount = gNewRowCount;</span>
<a href="#l37.188"></a><span id="l37.188" class="difflineminus">-            gLastRowIndex = gRowCount - 1;</span>
<a href="#l37.189"></a><span id="l37.189" class="difflineminus">-            if (gCurRowIndex &gt; gLastRowIndex)</span>
<a href="#l37.190"></a><span id="l37.190" class="difflineminus">-              // We are deleting our selection</span>
<a href="#l37.191"></a><span id="l37.191" class="difflineminus">-              // move it to start of table</span>
<a href="#l37.192"></a><span id="l37.192" class="difflineminus">-              ChangeSelectionToFirstCell();</span>
<a href="#l37.193"></a><span id="l37.193" class="difflineminus">-            else</span>
<a href="#l37.194"></a><span id="l37.194" class="difflineminus">-              // Put selection back where it was</span>
<a href="#l37.195"></a><span id="l37.195" class="difflineminus">-              ChangeSelection(RESET_SELECTION);</span>
<a href="#l37.196"></a><span id="l37.196" class="difflineminus">-          } catch (ex) {</span>
<a href="#l37.197"></a><span id="l37.197" class="difflineminus">-            dump(&quot;FAILED TO FIND FIRST CELL IN LAST ROW\n&quot;);</span>
<a href="#l37.198"></a><span id="l37.198" class="difflineminus">-          }</span>
<a href="#l37.199"></a><span id="l37.199" class="difflineplus">+      }</span>
<a href="#l37.200"></a><span id="l37.200" class="difflineplus">+      if (foundCell) {</span>
<a href="#l37.201"></a><span id="l37.201" class="difflineplus">+        try {</span>
<a href="#l37.202"></a><span id="l37.202" class="difflineplus">+          // Move selection to the cell we found</span>
<a href="#l37.203"></a><span id="l37.203" class="difflineplus">+          gSelection.collapse(gCellData.value, 0);</span>
<a href="#l37.204"></a><span id="l37.204" class="difflineplus">+          gActiveEditor.deleteTableRow(-countDelta);</span>
<a href="#l37.205"></a><span id="l37.205" class="difflineplus">+          gRowCount = gNewRowCount;</span>
<a href="#l37.206"></a><span id="l37.206" class="difflineplus">+          gLastRowIndex = gRowCount - 1;</span>
<a href="#l37.207"></a><span id="l37.207" class="difflineplus">+          if (gCurRowIndex &gt; gLastRowIndex)</span>
<a href="#l37.208"></a><span id="l37.208" class="difflineplus">+            // We are deleting our selection</span>
<a href="#l37.209"></a><span id="l37.209" class="difflineplus">+            // move it to start of table</span>
<a href="#l37.210"></a><span id="l37.210" class="difflineplus">+            ChangeSelectionToFirstCell();</span>
<a href="#l37.211"></a><span id="l37.211" class="difflineplus">+          else</span>
<a href="#l37.212"></a><span id="l37.212" class="difflineplus">+            // Put selection back where it was</span>
<a href="#l37.213"></a><span id="l37.213" class="difflineplus">+            ChangeSelection(RESET_SELECTION);</span>
<a href="#l37.214"></a><span id="l37.214" class="difflineplus">+        } catch (ex) {</span>
<a href="#l37.215"></a><span id="l37.215" class="difflineplus">+          dump(&quot;FAILED TO FIND FIRST CELL IN LAST ROW\n&quot;);</span>
<a href="#l37.216"></a><span id="l37.216">         }</span>
<a href="#l37.217"></a><span id="l37.217">       }</span>
<a href="#l37.218"></a><span id="l37.218">     }</span>
<a href="#l37.219"></a><span id="l37.219">   }</span>
<a href="#l37.220"></a><span id="l37.220"> </span>
<a href="#l37.221"></a><span id="l37.221">   if (gNewColCount != gColCount) {</span>
<a href="#l37.222"></a><span id="l37.222">     countDelta = gNewColCount - gColCount;</span>
<a href="#l37.223"></a><span id="l37.223"> </span>
<a href="#l37.224"></a><span id="l37.224" class="difflineat">@@ -994,56 +993,54 @@ function ApplyTableAttributes() {</span>
<a href="#l37.225"></a><span id="l37.225">           gColCount = gNewColCount;</span>
<a href="#l37.226"></a><span id="l37.226">           gLastColIndex = gColCount - 1;</span>
<a href="#l37.227"></a><span id="l37.227">           // Restore selection</span>
<a href="#l37.228"></a><span id="l37.228">           ChangeSelection(RESET_SELECTION);</span>
<a href="#l37.229"></a><span id="l37.229">         } catch (ex) {</span>
<a href="#l37.230"></a><span id="l37.230">           dump(&quot;FAILED TO FIND FIRST CELL IN LAST COLUMN\n&quot;);</span>
<a href="#l37.231"></a><span id="l37.231">         }</span>
<a href="#l37.232"></a><span id="l37.232">       }</span>
<a href="#l37.233"></a><span id="l37.233" class="difflineminus">-    } else {</span>
<a href="#l37.234"></a><span id="l37.234" class="difflineminus">-      // Delete columns</span>
<a href="#l37.235"></a><span id="l37.235" class="difflineminus">-      if (gCanDelete) {</span>
<a href="#l37.236"></a><span id="l37.236" class="difflineminus">-        var firstDeleteCol = gColCount + countDelta;</span>
<a href="#l37.237"></a><span id="l37.237" class="difflineminus">-        foundCell = false;</span>
<a href="#l37.238"></a><span id="l37.238" class="difflineminus">-        for (i = 0; i &lt;= gLastRowIndex; i++) {</span>
<a href="#l37.239"></a><span id="l37.239" class="difflineminus">-          // Find first cell starting in first column we delete</span>
<a href="#l37.240"></a><span id="l37.240" class="difflineminus">-          if (!GetCellData(i, firstDeleteCol))</span>
<a href="#l37.241"></a><span id="l37.241" class="difflineminus">-            break; // We failed to find a cell</span>
<a href="#l37.242"></a><span id="l37.242" class="difflineplus">+    } else if (gCanDelete) { // Delete columns</span>
<a href="#l37.243"></a><span id="l37.243" class="difflineplus">+      var firstDeleteCol = gColCount + countDelta;</span>
<a href="#l37.244"></a><span id="l37.244" class="difflineplus">+      foundCell = false;</span>
<a href="#l37.245"></a><span id="l37.245" class="difflineplus">+      for (i = 0; i &lt;= gLastRowIndex; i++) {</span>
<a href="#l37.246"></a><span id="l37.246" class="difflineplus">+        // Find first cell starting in first column we delete</span>
<a href="#l37.247"></a><span id="l37.247" class="difflineplus">+        if (!GetCellData(i, firstDeleteCol))</span>
<a href="#l37.248"></a><span id="l37.248" class="difflineplus">+          break; // We failed to find a cell</span>
<a href="#l37.249"></a><span id="l37.249"> </span>
<a href="#l37.250"></a><span id="l37.250" class="difflineminus">-          if (gCellData.startColIndex == firstDeleteCol) {</span>
<a href="#l37.251"></a><span id="l37.251" class="difflineminus">-            foundCell = true;</span>
<a href="#l37.252"></a><span id="l37.252" class="difflineminus">-            break;</span>
<a href="#l37.253"></a><span id="l37.253" class="difflineminus">-          }</span>
<a href="#l37.254"></a><span id="l37.254" class="difflineplus">+        if (gCellData.startColIndex == firstDeleteCol) {</span>
<a href="#l37.255"></a><span id="l37.255" class="difflineplus">+          foundCell = true;</span>
<a href="#l37.256"></a><span id="l37.256" class="difflineplus">+          break;</span>
<a href="#l37.257"></a><span id="l37.257">         }</span>
<a href="#l37.258"></a><span id="l37.258" class="difflineminus">-        if (foundCell) {</span>
<a href="#l37.259"></a><span id="l37.259" class="difflineminus">-          try {</span>
<a href="#l37.260"></a><span id="l37.260" class="difflineminus">-            // Move selection to the cell we found</span>
<a href="#l37.261"></a><span id="l37.261" class="difflineminus">-            gSelection.collapse(gCellData.value, 0);</span>
<a href="#l37.262"></a><span id="l37.262" class="difflineminus">-            gActiveEditor.deleteTableColumn(-countDelta);</span>
<a href="#l37.263"></a><span id="l37.263" class="difflineminus">-            gColCount = gNewColCount;</span>
<a href="#l37.264"></a><span id="l37.264" class="difflineminus">-            gLastColIndex = gColCount - 1;</span>
<a href="#l37.265"></a><span id="l37.265" class="difflineminus">-            if (gCurColIndex &gt; gLastColIndex)</span>
<a href="#l37.266"></a><span id="l37.266" class="difflineminus">-              ChangeSelectionToFirstCell();</span>
<a href="#l37.267"></a><span id="l37.267" class="difflineminus">-            else</span>
<a href="#l37.268"></a><span id="l37.268" class="difflineminus">-              ChangeSelection(RESET_SELECTION);</span>
<a href="#l37.269"></a><span id="l37.269" class="difflineminus">-          } catch (ex) {</span>
<a href="#l37.270"></a><span id="l37.270" class="difflineminus">-            dump(&quot;FAILED TO FIND FIRST CELL IN LAST ROW\n&quot;);</span>
<a href="#l37.271"></a><span id="l37.271" class="difflineminus">-          }</span>
<a href="#l37.272"></a><span id="l37.272" class="difflineplus">+      }</span>
<a href="#l37.273"></a><span id="l37.273" class="difflineplus">+      if (foundCell) {</span>
<a href="#l37.274"></a><span id="l37.274" class="difflineplus">+        try {</span>
<a href="#l37.275"></a><span id="l37.275" class="difflineplus">+          // Move selection to the cell we found</span>
<a href="#l37.276"></a><span id="l37.276" class="difflineplus">+          gSelection.collapse(gCellData.value, 0);</span>
<a href="#l37.277"></a><span id="l37.277" class="difflineplus">+          gActiveEditor.deleteTableColumn(-countDelta);</span>
<a href="#l37.278"></a><span id="l37.278" class="difflineplus">+          gColCount = gNewColCount;</span>
<a href="#l37.279"></a><span id="l37.279" class="difflineplus">+          gLastColIndex = gColCount - 1;</span>
<a href="#l37.280"></a><span id="l37.280" class="difflineplus">+          if (gCurColIndex &gt; gLastColIndex)</span>
<a href="#l37.281"></a><span id="l37.281" class="difflineplus">+            ChangeSelectionToFirstCell();</span>
<a href="#l37.282"></a><span id="l37.282" class="difflineplus">+          else</span>
<a href="#l37.283"></a><span id="l37.283" class="difflineplus">+            ChangeSelection(RESET_SELECTION);</span>
<a href="#l37.284"></a><span id="l37.284" class="difflineplus">+        } catch (ex) {</span>
<a href="#l37.285"></a><span id="l37.285" class="difflineplus">+          dump(&quot;FAILED TO FIND FIRST CELL IN LAST ROW\n&quot;);</span>
<a href="#l37.286"></a><span id="l37.286">         }</span>
<a href="#l37.287"></a><span id="l37.287">       }</span>
<a href="#l37.288"></a><span id="l37.288">     }</span>
<a href="#l37.289"></a><span id="l37.289">   }</span>
<a href="#l37.290"></a><span id="l37.290"> </span>
<a href="#l37.291"></a><span id="l37.291">   // Clone all remaining attributes to pick up</span>
<a href="#l37.292"></a><span id="l37.292">   //  anything changed by Advanced Edit Dialog</span>
<a href="#l37.293"></a><span id="l37.293">   try {</span>
<a href="#l37.294"></a><span id="l37.294">     gActiveEditor.cloneAttributes(gTableElement, globalTableElement);</span>
<a href="#l37.295"></a><span id="l37.295">   } catch (e) {}</span>
<a href="#l37.296"></a><span id="l37.296"> }</span>
<a href="#l37.297"></a><span id="l37.297" class="difflineplus">+/* eslint-enable complexity */</span>
<a href="#l37.298"></a><span id="l37.298"> </span>
<a href="#l37.299"></a><span id="l37.299"> function ApplyCellAttributes() {</span>
<a href="#l37.300"></a><span id="l37.300">   var rangeObj = { value: null };</span>
<a href="#l37.301"></a><span id="l37.301">   var selectedCell;</span>
<a href="#l37.302"></a><span id="l37.302">   try {</span>
<a href="#l37.303"></a><span id="l37.303">     selectedCell = gActiveEditor.getFirstSelectedCell(rangeObj);</span>
<a href="#l37.304"></a><span id="l37.304">   } catch (e) {}</span>
<a href="#l37.305"></a><span id="l37.305"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdTableProps.xul</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdTableProps.xul</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -181,23 +181,23 @@</span>
<a href="#l38.4"></a><span id="l38.4">           &lt;!-- cell size groupbox --&gt;</span>
<a href="#l38.5"></a><span id="l38.5">           &lt;groupbox&gt;&lt;label class=&quot;header&quot;&gt;&amp;size.label;&lt;/label&gt;</span>
<a href="#l38.6"></a><span id="l38.6">             &lt;grid&gt;</span>
<a href="#l38.7"></a><span id="l38.7">               &lt;columns&gt;&lt;column/&gt;&lt;column/&gt;&lt;column flex=&quot;1&quot;/&gt;&lt;/columns&gt;</span>
<a href="#l38.8"></a><span id="l38.8">               &lt;rows&gt;</span>
<a href="#l38.9"></a><span id="l38.9">                 &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l38.10"></a><span id="l38.10">                   &lt;checkbox id=&quot;CellHeightCheckbox&quot; label=&quot;&amp;tableHeight.label;&quot; accesskey=&quot;&amp;tableHeight.accessKey;&quot;/&gt;</span>
<a href="#l38.11"></a><span id="l38.11">                   &lt;textbox class=&quot;narrow&quot; id=&quot;CellHeightInput&quot;</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-                           oninput=&quot;ChangeIntTextbox(this.id,'CellHeightCheckbox');&quot;/&gt;</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineplus">+                           oninput=&quot;ChangeIntTextbox(this.id, 'CellHeightCheckbox');&quot;/&gt;</span>
<a href="#l38.14"></a><span id="l38.14">                   &lt;menulist id=&quot;CellHeightUnits&quot; oncommand=&quot;SetCheckbox('CellHeightCheckbox');&quot;/&gt;</span>
<a href="#l38.15"></a><span id="l38.15">                 &lt;/row&gt;</span>
<a href="#l38.16"></a><span id="l38.16">                 &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l38.17"></a><span id="l38.17">                   &lt;checkbox id=&quot;CellWidthCheckbox&quot; label=&quot;&amp;tableWidth.label;&quot; accesskey=&quot;&amp;tableWidth.accessKey;&quot;/&gt;</span>
<a href="#l38.18"></a><span id="l38.18">                   &lt;textbox class=&quot;narrow&quot; id=&quot;CellWidthInput&quot;</span>
<a href="#l38.19"></a><span id="l38.19" class="difflineminus">-                           oninput=&quot;ChangeIntTextbox(this.id,'CellWidthCheckbox');&quot;/&gt;</span>
<a href="#l38.20"></a><span id="l38.20" class="difflineplus">+                           oninput=&quot;ChangeIntTextbox(this.id, 'CellWidthCheckbox');&quot;/&gt;</span>
<a href="#l38.21"></a><span id="l38.21">                   &lt;menulist id=&quot;CellWidthUnits&quot; oncommand=&quot;SetCheckbox('CellWidthCheckbox');&quot;/&gt;</span>
<a href="#l38.22"></a><span id="l38.22">                 &lt;/row&gt;</span>
<a href="#l38.23"></a><span id="l38.23">               &lt;/rows&gt;</span>
<a href="#l38.24"></a><span id="l38.24">             &lt;/grid&gt;</span>
<a href="#l38.25"></a><span id="l38.25">             &lt;spacer class=&quot;bigspacer&quot;/&gt;</span>
<a href="#l38.26"></a><span id="l38.26">           &lt;/groupbox&gt;</span>
<a href="#l38.27"></a><span id="l38.27">           &lt;!-- Alignment --&gt;</span>
<a href="#l38.28"></a><span id="l38.28">           &lt;groupbox&gt;&lt;label class=&quot;header&quot;&gt;&amp;cellContentAlignment.label;&lt;/label&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdTextAreaProps.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdTextAreaProps.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -1,12 +1,15 @@</span>
<a href="#l39.4"></a><span id="l39.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l39.5"></a><span id="l39.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l39.6"></a><span id="l39.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l39.7"></a><span id="l39.7"> </span>
<a href="#l39.8"></a><span id="l39.8" class="difflineplus">+/* import-globals-from ../../composer/content/editorUtilities.js */</span>
<a href="#l39.9"></a><span id="l39.9" class="difflineplus">+/* import-globals-from EdDialogCommon.js */</span>
<a href="#l39.10"></a><span id="l39.10" class="difflineplus">+</span>
<a href="#l39.11"></a><span id="l39.11"> var insertNew;</span>
<a href="#l39.12"></a><span id="l39.12"> var textareaElement;</span>
<a href="#l39.13"></a><span id="l39.13"> </span>
<a href="#l39.14"></a><span id="l39.14"> // dialog initialization code</span>
<a href="#l39.15"></a><span id="l39.15"> </span>
<a href="#l39.16"></a><span id="l39.16"> document.addEventListener(&quot;dialogaccept&quot;, onAccept);</span>
<a href="#l39.17"></a><span id="l39.17"> document.addEventListener(&quot;dialogcancel&quot;, onCancel);</span>
<a href="#l39.18"></a><span id="l39.18"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/editor/ui/dialogs/content/EdTextAreaProps.xul</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/editor/ui/dialogs/content/EdTextAreaProps.xul</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -31,23 +31,23 @@</span>
<a href="#l40.4"></a><span id="l40.4">       &lt;rows&gt;</span>
<a href="#l40.5"></a><span id="l40.5">         &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l40.6"></a><span id="l40.6">           &lt;label control=&quot;TextAreaName&quot; value=&quot;&amp;TextAreaName.label;&quot; accesskey=&quot;&amp;TextAreaName.accessKey;&quot;/&gt;</span>
<a href="#l40.7"></a><span id="l40.7">           &lt;textbox id=&quot;TextAreaName&quot; oninput=&quot;onInput();&quot;/&gt;</span>
<a href="#l40.8"></a><span id="l40.8">         &lt;/row&gt;</span>
<a href="#l40.9"></a><span id="l40.9">         &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l40.10"></a><span id="l40.10">           &lt;label control=&quot;TextAreaRows&quot; value=&quot;&amp;TextAreaRows.label;&quot; accesskey=&quot;&amp;TextAreaRows.accessKey;&quot;/&gt;</span>
<a href="#l40.11"></a><span id="l40.11">           &lt;hbox&gt;</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-            &lt;textbox id=&quot;TextAreaRows&quot; class=&quot;narrow&quot; oninput=&quot;forceInteger(this.id);onInput();&quot;/&gt;</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+            &lt;textbox id=&quot;TextAreaRows&quot; class=&quot;narrow&quot; oninput=&quot;forceInteger(this.id); onInput();&quot;/&gt;</span>
<a href="#l40.14"></a><span id="l40.14">           &lt;/hbox&gt;</span>
<a href="#l40.15"></a><span id="l40.15">         &lt;/row&gt;</span>
<a href="#l40.16"></a><span id="l40.16">         &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l40.17"></a><span id="l40.17">           &lt;label control=&quot;TextAreaCols&quot; value=&quot;&amp;TextAreaCols.label;&quot; accesskey=&quot;&amp;TextAreaCols.accessKey;&quot;/&gt;</span>
<a href="#l40.18"></a><span id="l40.18">           &lt;hbox&gt;</span>
<a href="#l40.19"></a><span id="l40.19" class="difflineminus">-            &lt;textbox id=&quot;TextAreaCols&quot; class=&quot;narrow&quot; oninput=&quot;forceInteger(this.id);onInput();&quot;/&gt;</span>
<a href="#l40.20"></a><span id="l40.20" class="difflineplus">+            &lt;textbox id=&quot;TextAreaCols&quot; class=&quot;narrow&quot; oninput=&quot;forceInteger(this.id); onInput();&quot;/&gt;</span>
<a href="#l40.21"></a><span id="l40.21">           &lt;/hbox&gt;</span>
<a href="#l40.22"></a><span id="l40.22">         &lt;/row&gt;</span>
<a href="#l40.23"></a><span id="l40.23">       &lt;/rows&gt;</span>
<a href="#l40.24"></a><span id="l40.24">     &lt;/grid&gt;</span>
<a href="#l40.25"></a><span id="l40.25">     &lt;hbox&gt;</span>
<a href="#l40.26"></a><span id="l40.26">       &lt;button id=&quot;MoreFewerButton&quot; oncommand=&quot;onMoreFewer();&quot; persist=&quot;more&quot;/&gt;</span>
<a href="#l40.27"></a><span id="l40.27">     &lt;/hbox&gt;</span>
<a href="#l40.28"></a><span id="l40.28">     &lt;grid id=&quot;MoreSection&quot;&gt;&lt;columns&gt;&lt;column/&gt;&lt;column/&gt;&lt;/columns&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/editor/ui/nsComposerCmdLineHandler.js</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/editor/ui/nsComposerCmdLineHandler.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -14,17 +14,17 @@ nsComposerCmdLineHandler.prototype = {</span>
<a href="#l41.4"></a><span id="l41.4">   get wrappedJSObject() {</span>
<a href="#l41.5"></a><span id="l41.5">     return this;</span>
<a href="#l41.6"></a><span id="l41.6">   },</span>
<a href="#l41.7"></a><span id="l41.7"> </span>
<a href="#l41.8"></a><span id="l41.8">   /* nsISupports */</span>
<a href="#l41.9"></a><span id="l41.9">   QueryInterface: ChromeUtils.generateQI([nsICommandLineHandler]),</span>
<a href="#l41.10"></a><span id="l41.10"> </span>
<a href="#l41.11"></a><span id="l41.11">   /* nsICommandLineHandler */</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-  handle: function handle(cmdLine) {</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+  handle(cmdLine) {</span>
<a href="#l41.14"></a><span id="l41.14">     var args = Cc[&quot;@mozilla.org/supports-string;1&quot;]</span>
<a href="#l41.15"></a><span id="l41.15">                  .createInstance(nsISupportsString);</span>
<a href="#l41.16"></a><span id="l41.16">     try {</span>
<a href="#l41.17"></a><span id="l41.17">       var uristr = cmdLine.handleFlagWithParam(&quot;edit&quot;, false);</span>
<a href="#l41.18"></a><span id="l41.18">       if (uristr == null) {</span>
<a href="#l41.19"></a><span id="l41.19">         // Try the editor flag (used for general.startup.* prefs)</span>
<a href="#l41.20"></a><span id="l41.20">         uristr = cmdLine.handleFlagWithParam(&quot;editor&quot;, false);</span>
<a href="#l41.21"></a><span id="l41.21">         if (uristr == null)</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:31Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

