<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 21711:f3926c01ebe5f4796bfbe696101c7b13e4b44e88</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ f3926c01ebe5f4796bfbe696101c7b13e4b44e88" />
<meta property="og:url" content="/comm-central/rev/f3926c01ebe5f4796bfbe696101c7b13e4b44e88" />
<meta property="og:description" content="Bug 492329 - Polish the error message for an expired newsgroup article. r=Neil,jorgk" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / f3926c01ebe5f4796bfbe696101c7b13e4b44e88 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/f3926c01ebe5f4796bfbe696101c7b13e4b44e88">shortlog</a> |
<a href="/comm-central/log/f3926c01ebe5f4796bfbe696101c7b13e4b44e88">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/f3926c01ebe5f4796bfbe696101c7b13e4b44e88">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/f3926c01ebe5f4796bfbe696101c7b13e4b44e88">files</a> |
changeset |
<a href="/comm-central/raw-rev/f3926c01ebe5f4796bfbe696101c7b13e4b44e88">raw</a>  | <a href="/comm-central/archive/f3926c01ebe5f4796bfbe696101c7b13e4b44e88.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=492329">Bug 492329</a> - Polish the error message for an expired newsgroup article. r=Neil,jorgk
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#74;&#105;&#109;&#32;&#80;&#111;&#114;&#116;&#101;&#114;&#32;&#60;&#115;&#113;&#117;&#105;&#98;&#98;&#108;&#121;&#102;&#108;&#97;&#98;&#98;&#101;&#116;&#121;&#100;&#111;&#111;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Sat, 24 Jun 2017 22:24:56 +0200</td></tr>

<tr>
 <td>changeset 21711</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/f3926c01ebe5f4796bfbe696101c7b13e4b44e88">f3926c01ebe5f4796bfbe696101c7b13e4b44e88</a></td>
</tr>



<tr>
<td>parent 21710</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/e1006156a46a9f3a0f88c718b8d59dc0bf697145">e1006156a46a9f3a0f88c718b8d59dc0bf697145</a>
</td>
</tr>

<tr>
<td>child 21712</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/dd97865d7a80a00490e1cf1226b05ca6d2fe18bc">dd97865d7a80a00490e1cf1226b05ca6d2fe18bc</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=f3926c01ebe5f4796bfbe696101c7b13e4b44e88">13240</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Sat, 24 Jun 2017 20:57:25 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@064ea09a484d [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=064ea09a484db674bea276f4f634dd9b7bf85d24">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=064ea09a484db674bea276f4f634dd9b7bf85d24&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=064ea09a484db674bea276f4f634dd9b7bf85d24&newProject=comm-central&newRevision=f3926c01ebe5f4796bfbe696101c7b13e4b44e88&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=064ea09a484db674bea276f4f634dd9b7bf85d24&newProject=comm-central&newRevision=f3926c01ebe5f4796bfbe696101c7b13e4b44e88&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=064ea09a484db674bea276f4f634dd9b7bf85d24&newProject=comm-central&newRevision=f3926c01ebe5f4796bfbe696101c7b13e4b44e88&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28Neil%29&revcount=50">Neil</a>, <a href="/comm-central/log?rev=reviewer%28jorgk%29&revcount=50">jorgk</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=492329">492329</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=492329">Bug 492329</a> - Polish the error message for an expired newsgroup article. r=Neil,jorgk</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/components/aboutRedirector.js">mail/components/aboutRedirector.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/components/aboutRedirector.js">file</a> |
<a href="/comm-central/annotate/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/components/aboutRedirector.js">annotate</a> |
<a href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/components/aboutRedirector.js">diff</a> |
<a href="/comm-central/comparison/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/components/aboutRedirector.js">comparison</a> |
<a href="/comm-central/log/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/components/aboutRedirector.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/components/mailComponents.manifest">mail/components/mailComponents.manifest</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/components/mailComponents.manifest">file</a> |
<a href="/comm-central/annotate/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/components/mailComponents.manifest">annotate</a> |
<a href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/components/mailComponents.manifest">diff</a> |
<a href="/comm-central/comparison/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/components/mailComponents.manifest">comparison</a> |
<a href="/comm-central/log/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/components/mailComponents.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/en-US/chrome/messenger/news.properties">mail/locales/en-US/chrome/messenger/news.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/en-US/chrome/messenger/news.properties">file</a> |
<a href="/comm-central/annotate/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/en-US/chrome/messenger/news.properties">annotate</a> |
<a href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/en-US/chrome/messenger/news.properties">diff</a> |
<a href="/comm-central/comparison/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/en-US/chrome/messenger/news.properties">comparison</a> |
<a href="/comm-central/log/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/en-US/chrome/messenger/news.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/en-US/chrome/messenger/newsError.dtd">mail/locales/en-US/chrome/messenger/newsError.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/en-US/chrome/messenger/newsError.dtd">file</a> |
<a href="/comm-central/annotate/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/en-US/chrome/messenger/newsError.dtd">annotate</a> |
<a href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/en-US/chrome/messenger/newsError.dtd">diff</a> |
<a href="/comm-central/comparison/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/en-US/chrome/messenger/newsError.dtd">comparison</a> |
<a href="/comm-central/log/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/en-US/chrome/messenger/newsError.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/jar.mn">mail/locales/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/jar.mn">file</a> |
<a href="/comm-central/annotate/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/jar.mn">annotate</a> |
<a href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/jar.mn">diff</a> |
<a href="/comm-central/comparison/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/jar.mn">comparison</a> |
<a href="/comm-central/log/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mail/locales/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/content/newsError.xhtml">mailnews/base/content/newsError.xhtml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/content/newsError.xhtml">file</a> |
<a href="/comm-central/annotate/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/content/newsError.xhtml">annotate</a> |
<a href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/content/newsError.xhtml">diff</a> |
<a href="/comm-central/comparison/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/content/newsError.xhtml">comparison</a> |
<a href="/comm-central/log/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/content/newsError.xhtml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/public/nsIMsgWindow.idl">mailnews/base/public/nsIMsgWindow.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/public/nsIMsgWindow.idl">file</a> |
<a href="/comm-central/annotate/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/public/nsIMsgWindow.idl">annotate</a> |
<a href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/public/nsIMsgWindow.idl">diff</a> |
<a href="/comm-central/comparison/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/public/nsIMsgWindow.idl">comparison</a> |
<a href="/comm-central/log/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/public/nsIMsgWindow.idl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/src/nsMsgWindow.cpp">mailnews/base/src/nsMsgWindow.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/src/nsMsgWindow.cpp">file</a> |
<a href="/comm-central/annotate/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/src/nsMsgWindow.cpp">annotate</a> |
<a href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/src/nsMsgWindow.cpp">diff</a> |
<a href="/comm-central/comparison/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/src/nsMsgWindow.cpp">comparison</a> |
<a href="/comm-central/log/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/base/src/nsMsgWindow.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/jar.mn">mailnews/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/jar.mn">file</a> |
<a href="/comm-central/annotate/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/jar.mn">annotate</a> |
<a href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/jar.mn">diff</a> |
<a href="/comm-central/comparison/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/jar.mn">comparison</a> |
<a href="/comm-central/log/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/news/src/nsNNTPProtocol.cpp">mailnews/news/src/nsNNTPProtocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/news/src/nsNNTPProtocol.cpp">file</a> |
<a href="/comm-central/annotate/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/news/src/nsNNTPProtocol.cpp">annotate</a> |
<a href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/news/src/nsNNTPProtocol.cpp">diff</a> |
<a href="/comm-central/comparison/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/news/src/nsNNTPProtocol.cpp">comparison</a> |
<a href="/comm-central/log/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/mailnews/news/src/nsNNTPProtocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/en-US/chrome/mailnews/news.properties">suite/locales/en-US/chrome/mailnews/news.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/en-US/chrome/mailnews/news.properties">file</a> |
<a href="/comm-central/annotate/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/en-US/chrome/mailnews/news.properties">annotate</a> |
<a href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/en-US/chrome/mailnews/news.properties">diff</a> |
<a href="/comm-central/comparison/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/en-US/chrome/mailnews/news.properties">comparison</a> |
<a href="/comm-central/log/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/en-US/chrome/mailnews/news.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/en-US/chrome/mailnews/newsError.dtd">suite/locales/en-US/chrome/mailnews/newsError.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/en-US/chrome/mailnews/newsError.dtd">file</a> |
<a href="/comm-central/annotate/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/en-US/chrome/mailnews/newsError.dtd">annotate</a> |
<a href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/en-US/chrome/mailnews/newsError.dtd">diff</a> |
<a href="/comm-central/comparison/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/en-US/chrome/mailnews/newsError.dtd">comparison</a> |
<a href="/comm-central/log/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/en-US/chrome/mailnews/newsError.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/jar.mn">suite/locales/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/jar.mn">file</a> |
<a href="/comm-central/annotate/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/jar.mn">annotate</a> |
<a href="/comm-central/diff/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/jar.mn">diff</a> |
<a href="/comm-central/comparison/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/jar.mn">comparison</a> |
<a href="/comm-central/log/f3926c01ebe5f4796bfbe696101c7b13e4b44e88/suite/locales/jar.mn">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/components/aboutRedirector.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/components/aboutRedirector.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -12,16 +12,18 @@ AboutRedirector.prototype = {</span>
<a href="#l1.4"></a><span id="l1.4">   classDescription: &quot;Mail about: Redirector&quot;,</span>
<a href="#l1.5"></a><span id="l1.5">   classID: Components.ID(&quot;{8cc51368-6aa0-43e8-b762-bde9b9fd828c}&quot;),</span>
<a href="#l1.6"></a><span id="l1.6">   QueryInterface: XPCOMUtils.generateQI([Ci.nsIAboutModule]),</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8">   // Each entry in the map has the key as the part after the &quot;about:&quot; and the</span>
<a href="#l1.9"></a><span id="l1.9">   // value as a record with url and flags entries. Note that each addition here</span>
<a href="#l1.10"></a><span id="l1.10">   // should be coupled with a corresponding addition in mailComponents.manifest.</span>
<a href="#l1.11"></a><span id="l1.11">   _redirMap: {</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+    &quot;newserror&quot;: {url: &quot;chrome://messenger/content/newsError.xhtml&quot;,</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+                  flags: Ci.nsIAboutModule.ALLOW_SCRIPT},</span>
<a href="#l1.14"></a><span id="l1.14">     &quot;rights&quot;: {url: &quot;chrome://messenger/content/aboutRights.xhtml&quot;,</span>
<a href="#l1.15"></a><span id="l1.15">                flags: (Ci.nsIAboutModule.ALLOW_SCRIPT |</span>
<a href="#l1.16"></a><span id="l1.16">                        Ci.nsIAboutModule.URI_SAFE_FOR_UNTRUSTED_CONTENT)},</span>
<a href="#l1.17"></a><span id="l1.17">     &quot;support&quot;: {url: &quot;chrome://messenger/content/about-support/aboutSupport.xhtml&quot;,</span>
<a href="#l1.18"></a><span id="l1.18">                 flags: Ci.nsIAboutModule.ALLOW_SCRIPT},</span>
<a href="#l1.19"></a><span id="l1.19">     &quot;preferences&quot;: {url: &quot;chrome://messenger/content/preferences/aboutPreferences.xul&quot;,</span>
<a href="#l1.20"></a><span id="l1.20">                     flags: Ci.nsIAboutModule.ALLOW_SCRIPT},</span>
<a href="#l1.21"></a><span id="l1.21">     &quot;downloads&quot;: {url: &quot;chrome://messenger/content/downloads/aboutDownloads.xul&quot;,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/components/mailComponents.manifest</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/components/mailComponents.manifest</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1,11 +1,12 @@</span>
<a href="#l2.4"></a><span id="l2.4"> component {8cc51368-6aa0-43e8-b762-bde9b9fd828c} aboutRedirector.js</span>
<a href="#l2.5"></a><span id="l2.5"> # Each addition here should be coupled with a corresponding addition in</span>
<a href="#l2.6"></a><span id="l2.6"> # aboutRedirector.js.</span>
<a href="#l2.7"></a><span id="l2.7" class="difflineplus">+contract @mozilla.org/network/protocol/about;1?what=newserror {8cc51368-6aa0-43e8-b762-bde9b9fd828c}</span>
<a href="#l2.8"></a><span id="l2.8"> contract @mozilla.org/network/protocol/about;1?what=rights {8cc51368-6aa0-43e8-b762-bde9b9fd828c}</span>
<a href="#l2.9"></a><span id="l2.9"> contract @mozilla.org/network/protocol/about;1?what=support {8cc51368-6aa0-43e8-b762-bde9b9fd828c}</span>
<a href="#l2.10"></a><span id="l2.10"> contract @mozilla.org/network/protocol/about;1?what=preferences {8cc51368-6aa0-43e8-b762-bde9b9fd828c}</span>
<a href="#l2.11"></a><span id="l2.11"> contract @mozilla.org/network/protocol/about;1?what=downloads {8cc51368-6aa0-43e8-b762-bde9b9fd828c}</span>
<a href="#l2.12"></a><span id="l2.12"> </span>
<a href="#l2.13"></a><span id="l2.13"> component {44346520-c5d2-44e5-a1ec-034e04d7fac4} nsMailDefaultHandler.js</span>
<a href="#l2.14"></a><span id="l2.14"> contract @mozilla.org/mail/clh;1 {44346520-c5d2-44e5-a1ec-034e04d7fac4}</span>
<a href="#l2.15"></a><span id="l2.15"> category command-line-handler x-default @mozilla.org/mail/clh;1</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/news.properties</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/news.properties</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1,19 +1,13 @@</span>
<a href="#l3.4"></a><span id="l3.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l3.5"></a><span id="l3.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l3.6"></a><span id="l3.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l3.7"></a><span id="l3.7"> downloadHeadersTitlePrefix=Download Headers</span>
<a href="#l3.8"></a><span id="l3.8"> downloadHeadersInfoText=There are %S new message headers to download for this newsgroup.</span>
<a href="#l3.9"></a><span id="l3.9" class="difflineminus">-htmlNewsErrorTitle=Error!</span>
<a href="#l3.10"></a><span id="l3.10" class="difflineminus">-# LOCALIZATION NOTE ( htmlNewsError ): In the following item, translate only &quot;Error!&quot; and &quot;newsgroup server responded:&quot;</span>
<a href="#l3.11"></a><span id="l3.11" class="difflineminus">-htmlNewsError=&lt;H1&gt;Error!&lt;/H1&gt;newsgroup server responded: </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-# LOCALIZATION NOTE ( articleExpired ): In the following item, translate only &quot;Perhaps the article has expired&quot;</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-articleExpired=&lt;B&gt;&lt;P&gt;Perhaps the article has expired&lt;/P&gt;&lt;/B&gt;</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineminus">-removeExpiredArtLinkText=Click here to remove all expired articles</span>
<a href="#l3.15"></a><span id="l3.15"> cancelDisallowed=This message does not appear to be from you.  You may only cancel your own posts, not those made by others.</span>
<a href="#l3.16"></a><span id="l3.16"> cancelConfirm=Are you sure you want to cancel this message?</span>
<a href="#l3.17"></a><span id="l3.17"> messageCancelled=Message cancelled.</span>
<a href="#l3.18"></a><span id="l3.18"> enterUserPassTitle=News Server Username and Password Required</span>
<a href="#l3.19"></a><span id="l3.19"> # LOCALIZATION NOTE (enterUserPassServer): %S is the server being accessed</span>
<a href="#l3.20"></a><span id="l3.20"> enterUserPassServer=Please enter a username and password for %S:</span>
<a href="#l3.21"></a><span id="l3.21"> # LOCALIZATION NOTE (enterUserPassGroup): %1$S is a specific newsgroup to set</span>
<a href="#l3.22"></a><span id="l3.22"> # the password for; %2$S is the server from which the newsgroup is accessed</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1">new file mode 100644</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineminus">--- /dev/null</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/newsError.dtd</span>
<a href="#l4.4"></a><span id="l4.4" class="difflineat">@@ -0,0 +1,31 @@</span>
<a href="#l4.5"></a><span id="l4.5" class="difflineplus">+&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l4.6"></a><span id="l4.6" class="difflineplus">+   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l4.7"></a><span id="l4.7" class="difflineplus">+   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l4.8"></a><span id="l4.8" class="difflineplus">+</span>
<a href="#l4.9"></a><span id="l4.9" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (newsError.title): The title of the news error page.</span>
<a href="#l4.10"></a><span id="l4.10" class="difflineplus">+     Not generally visible. --&gt;</span>
<a href="#l4.11"></a><span id="l4.11" class="difflineplus">+&lt;!ENTITY newsError.title &quot;Problem Loading Article&quot;&gt;</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (articleNotFound.title): The main heading for the news</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+     error page. --&gt;</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+&lt;!ENTITY articleNotFound.title &quot;Article not found&quot;&gt;</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (articleNotFound.desc): A longer description for the news</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineplus">+     error page. --&gt;</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineplus">+&lt;!ENTITY articleNotFound.desc &quot;The newsgroup server reports that it can't find the article.&quot;&gt;</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineplus">+</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (serverResponded.title): A string preceding the text</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineplus">+     response from the newsgroup server describing the error. --&gt;</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineplus">+&lt;!ENTITY serverResponded.title &quot;Newsgroup server responded:&quot;&gt;</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineplus">+</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (articleExpired.title): A string explaining that the</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineplus">+     article may have expired. --&gt;</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineplus">+&lt;!ENTITY articleExpired.title &quot;Perhaps the article has expired?&quot;&gt;</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineplus">+</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (trySearching.title): A string preceding the message's</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineplus">+     ID. --&gt;</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineplus">+&lt;!ENTITY trySearching.title &quot;Try searching for article:&quot;&gt;</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (removeExpiredArticles.title): The label for the button</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+     to remove all expired articles from the newsgroup. --&gt;</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+&lt;!ENTITY removeExpiredArticles.title &quot;Remove All Expired Articles&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/locales/jar.mn</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/locales/jar.mn</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -184,16 +184,17 @@</span>
<a href="#l5.4"></a><span id="l5.4">   locale/@AB_CD@/messenger/newmailaccount/accountProvisioner.dtd        (%chrome/messenger/newmailaccount/accountProvisioner.dtd)</span>
<a href="#l5.5"></a><span id="l5.5">   locale/@AB_CD@/messenger/searchIntegrationWin.dtd                     (%chrome/messenger/searchIntegrationWin.dtd)</span>
<a href="#l5.6"></a><span id="l5.6">   locale/@AB_CD@/messenger/searchIntegrationMac.dtd                     (%chrome/messenger/searchIntegrationMac.dtd)</span>
<a href="#l5.7"></a><span id="l5.7">   locale/@AB_CD@/messenger/searchIntegrationDefault.dtd                 (%chrome/messenger/searchIntegrationDefault.dtd)</span>
<a href="#l5.8"></a><span id="l5.8">   locale/@AB_CD@/messenger/activity.dtd                                 (%chrome/messenger/activity.dtd)</span>
<a href="#l5.9"></a><span id="l5.9">   locale/@AB_CD@/messenger/activity.properties                          (%chrome/messenger/activity.properties)</span>
<a href="#l5.10"></a><span id="l5.10">   locale/@AB_CD@/messenger/downloads/settingsChange.dtd                 (%chrome/overrides/settingsChange.dtd)</span>
<a href="#l5.11"></a><span id="l5.11">   locale/@AB_CD@/messenger/netError.dtd                                 (%chrome/overrides/netError.dtd)</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+  locale/@AB_CD@/messenger/newsError.dtd                                (%chrome/messenger/newsError.dtd)</span>
<a href="#l5.13"></a><span id="l5.13">   locale/@AB_CD@/messenger/downloadsOverlay.dtd                         (%chrome/messenger/downloadsOverlay.dtd)</span>
<a href="#l5.14"></a><span id="l5.14">   locale/@AB_CD@/messenger/chat.dtd                                     (%chrome/messenger/chat.dtd)</span>
<a href="#l5.15"></a><span id="l5.15">   locale/@AB_CD@/messenger/chat.properties                              (%chrome/messenger/chat.properties)</span>
<a href="#l5.16"></a><span id="l5.16">   locale/@AB_CD@/messenger/addbuddy.dtd                                 (%chrome/messenger/addbuddy.dtd)</span>
<a href="#l5.17"></a><span id="l5.17">   locale/@AB_CD@/messenger/joinChat.dtd                                 (%chrome/messenger/joinChat.dtd)</span>
<a href="#l5.18"></a><span id="l5.18">   locale/@AB_CD@/messenger/imAccounts.properties                        (%chrome/messenger/imAccounts.properties)</span>
<a href="#l5.19"></a><span id="l5.19">   locale/@AB_CD@/messenger/imAccountWizard.dtd                          (%chrome/messenger/imAccountWizard.dtd)</span>
<a href="#l5.20"></a><span id="l5.20">   locale/@AB_CD@/messenger/sanitize.dtd									(%chrome/messenger/sanitize.dtd)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1">new file mode 100644</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineminus">--- /dev/null</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineplus">+++ b/mailnews/base/content/newsError.xhtml</span>
<a href="#l6.4"></a><span id="l6.4" class="difflineat">@@ -0,0 +1,88 @@</span>
<a href="#l6.5"></a><span id="l6.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<a href="#l6.6"></a><span id="l6.6" class="difflineplus">+&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.7"></a><span id="l6.7" class="difflineplus">+   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.8"></a><span id="l6.8" class="difflineplus">+   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l6.9"></a><span id="l6.9" class="difflineplus">+</span>
<a href="#l6.10"></a><span id="l6.10" class="difflineplus">+&lt;!DOCTYPE html [</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineplus">+  &lt;!ENTITY % htmlDTD</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+    PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+    &quot;DTD/xhtml1-strict.dtd&quot;&gt;</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+  %htmlDTD;</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+  &lt;!ENTITY % netErrorDTD</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+    SYSTEM &quot;chrome://messenger/locale/newsError.dtd&quot;&gt;</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+  %netErrorDTD;</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+  &lt;!ENTITY % globalDTD</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineplus">+    SYSTEM &quot;chrome://global/locale/global.dtd&quot;&gt;</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineplus">+  %globalDTD;</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineplus">+]&gt;</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineplus">+</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineplus">+&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineplus">+  &lt;head&gt;</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineplus">+    &lt;title&gt;&amp;newsError.title;&lt;/title&gt;</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineplus">+    &lt;link rel=&quot;stylesheet&quot; href=&quot;chrome://global/skin/netError.css&quot; type=&quot;text/css&quot; media=&quot;all&quot; /&gt;</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineplus">+    &lt;!-- If the location of the favicon is changed here, the FAVICON_ERRORPAGE_URL symbol in</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineplus">+         toolkit/components/places/src/nsFaviconService.h should be updated. --&gt;</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineplus">+    &lt;link rel=&quot;icon&quot; type=&quot;image/png&quot; id=&quot;favicon&quot; href=&quot;chrome://global/skin/icons/warning-16.png&quot;/&gt;</span>
<a href="#l6.30"></a><span id="l6.30" class="difflineplus">+    &lt;script type=&quot;application/javascript;version=1.8&quot;&gt;&lt;![CDATA[</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineplus">+      // Error url must be formatted like this:</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineplus">+      //   about:newserror?r=response&amp;m=messageid&amp;k=messagekey&amp;f=folderuri</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineplus">+      // &quot;r&quot; is required; &quot;m&quot; and &quot;f&quot; are optional, but &quot;k&quot; always comes with &quot;m&quot;.</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineplus">+</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineplus">+      var folderUri;</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineplus">+</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineplus">+      function removeExpired() {</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineplus">+        document.location.href = folderUri + &quot;?list-ids&quot;;</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineplus">+      }</span>
<a href="#l6.40"></a><span id="l6.40" class="difflineplus">+</span>
<a href="#l6.41"></a><span id="l6.41" class="difflineplus">+      function initPage() {</span>
<a href="#l6.42"></a><span id="l6.42" class="difflineplus">+        let uri = document.documentURI;</span>
<a href="#l6.43"></a><span id="l6.43" class="difflineplus">+        let query = uri.slice(uri.indexOf(&quot;?&quot;)+1);</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineplus">+        let params = {};</span>
<a href="#l6.45"></a><span id="l6.45" class="difflineplus">+        for (let [,piece] in Iterator(query.split(&quot;&amp;&quot;))) {</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineplus">+          let [key, value] = piece.split(&quot;=&quot;);</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineplus">+          params[key] = decodeURIComponent(value);</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineplus">+        }</span>
<a href="#l6.49"></a><span id="l6.49" class="difflineplus">+</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineplus">+        document.getElementById(&quot;ngResp&quot;).textContent = params.r;</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineplus">+</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineplus">+        if (&quot;m&quot; in params) {</span>
<a href="#l6.53"></a><span id="l6.53" class="difflineplus">+          document.getElementById(&quot;msgId&quot;).textContent = params.m;</span>
<a href="#l6.54"></a><span id="l6.54" class="difflineplus">+          document.getElementById(&quot;msgKey&quot;).textContent = params.k;</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineplus">+        } else {</span>
<a href="#l6.56"></a><span id="l6.56" class="difflineplus">+          document.getElementById(&quot;messageIdDesc&quot;).hidden = true;</span>
<a href="#l6.57"></a><span id="l6.57" class="difflineplus">+        }</span>
<a href="#l6.58"></a><span id="l6.58" class="difflineplus">+</span>
<a href="#l6.59"></a><span id="l6.59" class="difflineplus">+        if (&quot;f&quot; in params) {</span>
<a href="#l6.60"></a><span id="l6.60" class="difflineplus">+          folderUri = params.f;</span>
<a href="#l6.61"></a><span id="l6.61" class="difflineplus">+        } else {</span>
<a href="#l6.62"></a><span id="l6.62" class="difflineplus">+          document.getElementById(&quot;errorTryAgain&quot;).hidden = true;</span>
<a href="#l6.63"></a><span id="l6.63" class="difflineplus">+        }</span>
<a href="#l6.64"></a><span id="l6.64" class="difflineplus">+      }</span>
<a href="#l6.65"></a><span id="l6.65" class="difflineplus">+    ]]&gt;&lt;/script&gt;</span>
<a href="#l6.66"></a><span id="l6.66" class="difflineplus">+  &lt;/head&gt;</span>
<a href="#l6.67"></a><span id="l6.67" class="difflineplus">+</span>
<a href="#l6.68"></a><span id="l6.68" class="difflineplus">+  &lt;body dir=&quot;&amp;locale.dir;&quot;&gt;</span>
<a href="#l6.69"></a><span id="l6.69" class="difflineplus">+    &lt;div id=&quot;errorPageContainer&quot;&gt;</span>
<a href="#l6.70"></a><span id="l6.70" class="difflineplus">+      &lt;div id=&quot;errorTitle&quot;&gt;</span>
<a href="#l6.71"></a><span id="l6.71" class="difflineplus">+        &lt;h1 id=&quot;errorTitleText&quot;&gt;&amp;articleNotFound.title;&lt;/h1&gt;</span>
<a href="#l6.72"></a><span id="l6.72" class="difflineplus">+      &lt;/div&gt;</span>
<a href="#l6.73"></a><span id="l6.73" class="difflineplus">+      &lt;div id=&quot;errorLongContent&quot;&gt;</span>
<a href="#l6.74"></a><span id="l6.74" class="difflineplus">+        &lt;div id=&quot;errorShortDesc&quot;&gt;</span>
<a href="#l6.75"></a><span id="l6.75" class="difflineplus">+          &lt;p id=&quot;errorShortDescText&quot;&gt;&lt;b&gt;&amp;articleNotFound.desc;&lt;/b&gt;&lt;/p&gt;</span>
<a href="#l6.76"></a><span id="l6.76" class="difflineplus">+        &lt;/div&gt;</span>
<a href="#l6.77"></a><span id="l6.77" class="difflineplus">+        &lt;div id=&quot;errorLongDesc&quot;&gt;</span>
<a href="#l6.78"></a><span id="l6.78" class="difflineplus">+          &lt;ul&gt;</span>
<a href="#l6.79"></a><span id="l6.79" class="difflineplus">+            &lt;li&gt;&amp;serverResponded.title; &lt;span id=&quot;ngResp&quot;/&gt;&lt;/li&gt;</span>
<a href="#l6.80"></a><span id="l6.80" class="difflineplus">+            &lt;li&gt;&amp;articleExpired.title;&lt;/li&gt;</span>
<a href="#l6.81"></a><span id="l6.81" class="difflineplus">+            &lt;li id=&quot;messageIdDesc&quot;&gt;&amp;trySearching.title; &amp;lt;&lt;span id=&quot;msgId&quot;/&gt;&amp;gt; (&lt;span id=&quot;msgKey&quot;/&gt;)&lt;/li&gt;</span>
<a href="#l6.82"></a><span id="l6.82" class="difflineplus">+          &lt;/ul&gt;</span>
<a href="#l6.83"></a><span id="l6.83" class="difflineplus">+        &lt;/div&gt;</span>
<a href="#l6.84"></a><span id="l6.84" class="difflineplus">+      &lt;/div&gt;</span>
<a href="#l6.85"></a><span id="l6.85" class="difflineplus">+      &lt;!-- This button really means &quot;remove all expired articles&quot;, but we use</span>
<a href="#l6.86"></a><span id="l6.86" class="difflineplus">+           the &quot;errorTryAgain&quot; id to piggyback on toolkit's CSS. --&gt;</span>
<a href="#l6.87"></a><span id="l6.87" class="difflineplus">+      &lt;button id=&quot;errorTryAgain&quot;</span>
<a href="#l6.88"></a><span id="l6.88" class="difflineplus">+              onclick=&quot;removeExpired();&quot;&gt;&amp;removeExpiredArticles.title;&lt;/button&gt;</span>
<a href="#l6.89"></a><span id="l6.89" class="difflineplus">+    &lt;/div&gt;</span>
<a href="#l6.90"></a><span id="l6.90" class="difflineplus">+    &lt;script type=&quot;application/javascript&quot;&gt;initPage();&lt;/script&gt;</span>
<a href="#l6.91"></a><span id="l6.91" class="difflineplus">+  &lt;/body&gt;</span>
<a href="#l6.92"></a><span id="l6.92" class="difflineplus">+&lt;/html&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/base/public/nsIMsgWindow.idl</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/base/public/nsIMsgWindow.idl</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -9,16 +9,17 @@ interface nsIMsgStatusFeedback;</span>
<a href="#l7.4"></a><span id="l7.4"> interface nsIMsgFolder;</span>
<a href="#l7.5"></a><span id="l7.5"> interface nsITransactionManager;</span>
<a href="#l7.6"></a><span id="l7.6"> interface nsIDocShell;</span>
<a href="#l7.7"></a><span id="l7.7"> interface mozIDOMWindowProxy;</span>
<a href="#l7.8"></a><span id="l7.8"> interface nsIMsgHeaderSink;</span>
<a href="#l7.9"></a><span id="l7.9"> interface nsIPrompt;</span>
<a href="#l7.10"></a><span id="l7.10"> interface nsIInterfaceRequestor;</span>
<a href="#l7.11"></a><span id="l7.11"> interface nsIAuthPrompt;</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+interface nsIPrincipal;</span>
<a href="#l7.13"></a><span id="l7.13"> </span>
<a href="#l7.14"></a><span id="l7.14"> [scriptable, uuid(7B8F4A65-CFC4-4b3f-BF5C-152AA8D5CD10)]</span>
<a href="#l7.15"></a><span id="l7.15"> interface nsIMsgWindowCommands : nsISupports {</span>
<a href="#l7.16"></a><span id="l7.16">   void selectFolder(in ACString folderUri);</span>
<a href="#l7.17"></a><span id="l7.17">   void selectMessage(in ACString messageUri);</span>
<a href="#l7.18"></a><span id="l7.18">   void clearMsgPane();</span>
<a href="#l7.19"></a><span id="l7.19"> };</span>
<a href="#l7.20"></a><span id="l7.20"> </span>
<a href="#l7.21"></a><span id="l7.21" class="difflineat">@@ -51,17 +52,19 @@ interface nsIMsgWindow : nsISupports {</span>
<a href="#l7.22"></a><span id="l7.22">    */</span>
<a href="#l7.23"></a><span id="l7.23">   readonly attribute nsIAuthPrompt authPrompt;</span>
<a href="#l7.24"></a><span id="l7.24"> </span>
<a href="#l7.25"></a><span id="l7.25">   /**</span>
<a href="#l7.26"></a><span id="l7.26">    * These are currently used to set notification callbacks on</span>
<a href="#l7.27"></a><span id="l7.27">    * protocol channels to handle things like bad cert exceptions.</span>
<a href="#l7.28"></a><span id="l7.28">    */</span>
<a href="#l7.29"></a><span id="l7.29">   attribute nsIInterfaceRequestor notificationCallbacks;</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineminus">-  </span>
<a href="#l7.31"></a><span id="l7.31" class="difflineplus">+</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+  void displayURIInMessagePane(in wstring uri, in boolean clearMsgHdr, in nsIPrincipal principal);</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineplus">+</span>
<a href="#l7.34"></a><span id="l7.34">   void displayHTMLInMessagePane(in AString title, in AString body, in boolean clearMsgHdr);</span>
<a href="#l7.35"></a><span id="l7.35"> </span>
<a href="#l7.36"></a><span id="l7.36">   readonly attribute nsIPrompt promptDialog;</span>
<a href="#l7.37"></a><span id="l7.37">   attribute ACString mailCharacterSet;</span>
<a href="#l7.38"></a><span id="l7.38"> </span>
<a href="#l7.39"></a><span id="l7.39">   /**</span>
<a href="#l7.40"></a><span id="l7.40">     Remember the message's charaset was overridden, so it can be inherited (e.g for quoting).</span>
<a href="#l7.41"></a><span id="l7.41">    */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/base/src/nsMsgWindow.cpp</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgWindow.cpp</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -245,47 +245,47 @@ NS_IMETHODIMP nsMsgWindow::SetAuthPrompt</span>
<a href="#l8.4"></a><span id="l8.4"> }</span>
<a href="#l8.5"></a><span id="l8.5"> </span>
<a href="#l8.6"></a><span id="l8.6"> NS_IMETHODIMP nsMsgWindow::SetRootDocShell(nsIDocShell * aDocShell)</span>
<a href="#l8.7"></a><span id="l8.7"> {</span>
<a href="#l8.8"></a><span id="l8.8">   nsresult rv;</span>
<a href="#l8.9"></a><span id="l8.9">   nsCOMPtr&lt;nsIWebProgressListener&gt; contentPolicyListener =</span>
<a href="#l8.10"></a><span id="l8.10">     do_GetService(NS_MSGCONTENTPOLICY_CONTRACTID, &amp;rv);</span>
<a href="#l8.11"></a><span id="l8.11">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-  </span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+</span>
<a href="#l8.14"></a><span id="l8.14">   // remove the content policy webProgressListener from the root doc shell</span>
<a href="#l8.15"></a><span id="l8.15">   // we're currently holding, so we don't keep listening for loads that</span>
<a href="#l8.16"></a><span id="l8.16">   // we don't care about</span>
<a href="#l8.17"></a><span id="l8.17">   if (mRootDocShellWeak) {</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineminus">-    nsCOMPtr&lt;nsIWebProgress&gt; oldWebProgress = </span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+    nsCOMPtr&lt;nsIWebProgress&gt; oldWebProgress =</span>
<a href="#l8.20"></a><span id="l8.20">       do_QueryReferent(mRootDocShellWeak, &amp;rv);</span>
<a href="#l8.21"></a><span id="l8.21">     if (NS_SUCCEEDED(rv)) {</span>
<a href="#l8.22"></a><span id="l8.22">       rv = oldWebProgress-&gt;RemoveProgressListener(contentPolicyListener);</span>
<a href="#l8.23"></a><span id="l8.23">       NS_ASSERTION(NS_SUCCEEDED(rv), &quot;failed to remove old progress listener&quot;);</span>
<a href="#l8.24"></a><span id="l8.24" class="difflineminus">-    } </span>
<a href="#l8.25"></a><span id="l8.25" class="difflineplus">+    }</span>
<a href="#l8.26"></a><span id="l8.26">   }</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineminus">-  </span>
<a href="#l8.28"></a><span id="l8.28" class="difflineplus">+</span>
<a href="#l8.29"></a><span id="l8.29">   // Query for the doc shell and release it</span>
<a href="#l8.30"></a><span id="l8.30">   mRootDocShellWeak = nullptr;</span>
<a href="#l8.31"></a><span id="l8.31">   if (aDocShell)</span>
<a href="#l8.32"></a><span id="l8.32">   {</span>
<a href="#l8.33"></a><span id="l8.33">     mRootDocShellWeak = do_GetWeakReference(aDocShell);</span>
<a href="#l8.34"></a><span id="l8.34"> </span>
<a href="#l8.35"></a><span id="l8.35">     nsCOMPtr&lt;nsIDocShell&gt; messagePaneDocShell;</span>
<a href="#l8.36"></a><span id="l8.36">     GetMessageWindowDocShell(getter_AddRefs(messagePaneDocShell));</span>
<a href="#l8.37"></a><span id="l8.37">     nsCOMPtr&lt;nsIURIContentListener&gt; listener(do_GetInterface(messagePaneDocShell));</span>
<a href="#l8.38"></a><span id="l8.38">     if (listener)</span>
<a href="#l8.39"></a><span id="l8.39">       listener-&gt;SetParentContentListener(this);</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineminus">-  </span>
<a href="#l8.41"></a><span id="l8.41" class="difflineplus">+</span>
<a href="#l8.42"></a><span id="l8.42">     // set the contentPolicy webProgressListener on the root docshell for this</span>
<a href="#l8.43"></a><span id="l8.43">     // window so that it can allow JavaScript for non-message content</span>
<a href="#l8.44"></a><span id="l8.44" class="difflineminus">-    nsCOMPtr&lt;nsIWebProgress&gt; docShellProgress = </span>
<a href="#l8.45"></a><span id="l8.45" class="difflineplus">+    nsCOMPtr&lt;nsIWebProgress&gt; docShellProgress =</span>
<a href="#l8.46"></a><span id="l8.46">       do_QueryInterface(aDocShell, &amp;rv);</span>
<a href="#l8.47"></a><span id="l8.47">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.48"></a><span id="l8.48" class="difflineminus">-    </span>
<a href="#l8.49"></a><span id="l8.49" class="difflineplus">+</span>
<a href="#l8.50"></a><span id="l8.50">     rv = docShellProgress-&gt;AddProgressListener(contentPolicyListener,</span>
<a href="#l8.51"></a><span id="l8.51">                                                nsIWebProgress::NOTIFY_LOCATION);</span>
<a href="#l8.52"></a><span id="l8.52">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.53"></a><span id="l8.53">   }</span>
<a href="#l8.54"></a><span id="l8.54">   return NS_OK;</span>
<a href="#l8.55"></a><span id="l8.55"> }</span>
<a href="#l8.56"></a><span id="l8.56"> </span>
<a href="#l8.57"></a><span id="l8.57"> NS_IMETHODIMP nsMsgWindow::GetMailCharacterSet(nsACString&amp; aMailCharacterSet)</span>
<a href="#l8.58"></a><span id="l8.58" class="difflineat">@@ -495,47 +495,53 @@ NS_IMETHODIMP nsMsgWindow::GetPromptDial</span>
<a href="#l8.59"></a><span id="l8.59"> </span>
<a href="#l8.60"></a><span id="l8.60"> NS_IMETHODIMP nsMsgWindow::SetPromptDialog(nsIPrompt* aPromptDialog)</span>
<a href="#l8.61"></a><span id="l8.61"> {</span>
<a href="#l8.62"></a><span id="l8.62">   mPromptDialog = aPromptDialog;</span>
<a href="#l8.63"></a><span id="l8.63">   return NS_OK;</span>
<a href="#l8.64"></a><span id="l8.64"> }</span>
<a href="#l8.65"></a><span id="l8.65"> </span>
<a href="#l8.66"></a><span id="l8.66"> NS_IMETHODIMP</span>
<a href="#l8.67"></a><span id="l8.67" class="difflineminus">-nsMsgWindow::DisplayHTMLInMessagePane(const nsAString&amp; title, const nsAString&amp; body, bool clearMsgHdr)</span>
<a href="#l8.68"></a><span id="l8.68" class="difflineplus">+nsMsgWindow::DisplayURIInMessagePane(const char16_t *uri, bool clearMsgHdr, nsIPrincipal *principal)</span>
<a href="#l8.69"></a><span id="l8.69"> {</span>
<a href="#l8.70"></a><span id="l8.70">   if (clearMsgHdr &amp;&amp; mMsgWindowCommands)</span>
<a href="#l8.71"></a><span id="l8.71">     mMsgWindowCommands-&gt;ClearMsgPane();</span>
<a href="#l8.72"></a><span id="l8.72"> </span>
<a href="#l8.73"></a><span id="l8.73" class="difflineplus">+  nsCOMPtr &lt;nsIDocShell&gt; docShell;</span>
<a href="#l8.74"></a><span id="l8.74" class="difflineplus">+  GetMessageWindowDocShell(getter_AddRefs(docShell));</span>
<a href="#l8.75"></a><span id="l8.75" class="difflineplus">+  NS_ENSURE_TRUE(docShell, NS_ERROR_FAILURE);</span>
<a href="#l8.76"></a><span id="l8.76" class="difflineplus">+</span>
<a href="#l8.77"></a><span id="l8.77" class="difflineplus">+  nsCOMPtr&lt;nsIWebNavigation&gt; webNav(do_QueryInterface(docShell));</span>
<a href="#l8.78"></a><span id="l8.78" class="difflineplus">+  NS_ENSURE_TRUE(webNav, NS_ERROR_FAILURE);</span>
<a href="#l8.79"></a><span id="l8.79" class="difflineplus">+</span>
<a href="#l8.80"></a><span id="l8.80" class="difflineplus">+  return webNav-&gt;LoadURI(uri, nsIWebNavigation::LOAD_FLAGS_NONE,</span>
<a href="#l8.81"></a><span id="l8.81" class="difflineplus">+                         nullptr, nullptr, nullptr,</span>
<a href="#l8.82"></a><span id="l8.82" class="difflineplus">+                         principal);</span>
<a href="#l8.83"></a><span id="l8.83" class="difflineplus">+}</span>
<a href="#l8.84"></a><span id="l8.84" class="difflineplus">+</span>
<a href="#l8.85"></a><span id="l8.85" class="difflineplus">+NS_IMETHODIMP</span>
<a href="#l8.86"></a><span id="l8.86" class="difflineplus">+nsMsgWindow::DisplayHTMLInMessagePane(const nsAString&amp; title, const nsAString&amp; body, bool clearMsgHdr)</span>
<a href="#l8.87"></a><span id="l8.87" class="difflineplus">+{</span>
<a href="#l8.88"></a><span id="l8.88">   nsString htmlStr;</span>
<a href="#l8.89"></a><span id="l8.89">   htmlStr.Append(NS_LITERAL_STRING(&quot;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html; charset=UTF-8\&quot;&gt;&lt;/head&gt;&lt;body&gt;&quot;));</span>
<a href="#l8.90"></a><span id="l8.90">   htmlStr.Append(body);</span>
<a href="#l8.91"></a><span id="l8.91">   htmlStr.Append(NS_LITERAL_STRING(&quot;&lt;/body&gt;&lt;/html&gt;&quot;));</span>
<a href="#l8.92"></a><span id="l8.92"> </span>
<a href="#l8.93"></a><span id="l8.93">   char *encodedHtml = PL_Base64Encode(NS_ConvertUTF16toUTF8(htmlStr).get(), 0, nullptr);</span>
<a href="#l8.94"></a><span id="l8.94">   if (!encodedHtml)</span>
<a href="#l8.95"></a><span id="l8.95">     return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l8.96"></a><span id="l8.96"> </span>
<a href="#l8.97"></a><span id="l8.97">   nsCString dataSpec;</span>
<a href="#l8.98"></a><span id="l8.98">   dataSpec = &quot;data:text/html;base64,&quot;;</span>
<a href="#l8.99"></a><span id="l8.99">   dataSpec += encodedHtml;</span>
<a href="#l8.100"></a><span id="l8.100"> </span>
<a href="#l8.101"></a><span id="l8.101">   PR_FREEIF(encodedHtml);</span>
<a href="#l8.102"></a><span id="l8.102"> </span>
<a href="#l8.103"></a><span id="l8.103" class="difflineminus">-  nsCOMPtr &lt;nsIDocShell&gt; docShell;</span>
<a href="#l8.104"></a><span id="l8.104" class="difflineminus">-  GetMessageWindowDocShell(getter_AddRefs(docShell));</span>
<a href="#l8.105"></a><span id="l8.105" class="difflineminus">-  NS_ENSURE_TRUE(docShell, NS_ERROR_FAILURE);</span>
<a href="#l8.106"></a><span id="l8.106" class="difflineminus">-</span>
<a href="#l8.107"></a><span id="l8.107" class="difflineminus">-  nsCOMPtr&lt;nsIWebNavigation&gt; webNav(do_QueryInterface(docShell));</span>
<a href="#l8.108"></a><span id="l8.108" class="difflineminus">-  NS_ENSURE_TRUE(webNav, NS_ERROR_FAILURE);</span>
<a href="#l8.109"></a><span id="l8.109" class="difflineminus">-</span>
<a href="#l8.110"></a><span id="l8.110">   nsresult rv;</span>
<a href="#l8.111"></a><span id="l8.111">   nsCOMPtr&lt;nsIPrincipal&gt; nullPrincipal =</span>
<a href="#l8.112"></a><span id="l8.112">     do_CreateInstance(&quot;@mozilla.org/nullprincipal;1&quot;, &amp;rv);</span>
<a href="#l8.113"></a><span id="l8.113">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.114"></a><span id="l8.114"> </span>
<a href="#l8.115"></a><span id="l8.115" class="difflineminus">-  return webNav-&gt;LoadURI(NS_ConvertASCIItoUTF16(dataSpec).get(),</span>
<a href="#l8.116"></a><span id="l8.116" class="difflineminus">-                         nsIWebNavigation::LOAD_FLAGS_NONE,</span>
<a href="#l8.117"></a><span id="l8.117" class="difflineminus">-                         nullptr, nullptr, nullptr,</span>
<a href="#l8.118"></a><span id="l8.118" class="difflineminus">-                         nullPrincipal);</span>
<a href="#l8.119"></a><span id="l8.119" class="difflineplus">+  return DisplayURIInMessagePane(NS_ConvertASCIItoUTF16(dataSpec).get(),</span>
<a href="#l8.120"></a><span id="l8.120" class="difflineplus">+                                 clearMsgHdr, nullPrincipal);</span>
<a href="#l8.121"></a><span id="l8.121"> }</span>
<a href="#l8.122"></a><span id="l8.122"> </span>
<a href="#l8.123"></a><span id="l8.123"> NS_IMPL_GETSET(nsMsgWindow, Stopped, bool, m_stopped)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/jar.mn</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/jar.mn</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -112,13 +112,14 @@ messenger.jar:</span>
<a href="#l9.4"></a><span id="l9.4">     content/messenger/fieldMapImport.js                                        (import/content/fieldMapImport.js)</span>
<a href="#l9.5"></a><span id="l9.5">     content/messenger/downloadheaders.js                                       (news/content/downloadheaders.js)</span>
<a href="#l9.6"></a><span id="l9.6">     content/messenger/downloadheaders.xul                                      (news/content/downloadheaders.xul)</span>
<a href="#l9.7"></a><span id="l9.7">     content/messenger/markByDate.js                                            (base/content/markByDate.js)</span>
<a href="#l9.8"></a><span id="l9.8">     content/messenger/markByDate.xul                                           (base/content/markByDate.xul)</span>
<a href="#l9.9"></a><span id="l9.9">     content/messenger/dateFormat.js                                            (base/content/dateFormat.js)</span>
<a href="#l9.10"></a><span id="l9.10">     content/messenger/shutdownWindow.xul                                       (base/content/shutdownWindow.xul)</span>
<a href="#l9.11"></a><span id="l9.11">     content/messenger/shutdownWindow.js                                        (base/content/shutdownWindow.js)</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+    content/messenger/newsError.xhtml                                          (base/content/newsError.xhtml)</span>
<a href="#l9.13"></a><span id="l9.13"> #ifndef XP_MACOSX</span>
<a href="#l9.14"></a><span id="l9.14">     content/messenger/newmailalert.css                                         (base/content/newmailalert.css)</span>
<a href="#l9.15"></a><span id="l9.15">     content/messenger/newmailalert.js                                          (base/content/newmailalert.js)</span>
<a href="#l9.16"></a><span id="l9.16">     content/messenger/newmailalert.xul                                         (base/content/newmailalert.xul)</span>
<a href="#l9.17"></a><span id="l9.17"> #endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/news/src/nsNNTPProtocol.cpp</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/news/src/nsNNTPProtocol.cpp</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -24,16 +24,17 @@</span>
<a href="#l10.4"></a><span id="l10.4"> #include &quot;prmem.h&quot;</span>
<a href="#l10.5"></a><span id="l10.5"> #include &quot;prtime.h&quot;</span>
<a href="#l10.6"></a><span id="l10.6"> #include &quot;mozilla/Logging.h&quot;</span>
<a href="#l10.7"></a><span id="l10.7"> #include &quot;prerror.h&quot;</span>
<a href="#l10.8"></a><span id="l10.8"> #include &quot;nsString.h&quot;</span>
<a href="#l10.9"></a><span id="l10.9"> #include &quot;mozilla/Attributes.h&quot;</span>
<a href="#l10.10"></a><span id="l10.10"> #include &quot;mozilla/Services.h&quot;</span>
<a href="#l10.11"></a><span id="l10.11"> #include &quot;mozilla/mailnews/MimeHeaderParser.h&quot;</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineplus">+#include &quot;nsContentUtils.h&quot;</span>
<a href="#l10.13"></a><span id="l10.13"> </span>
<a href="#l10.14"></a><span id="l10.14"> #include &quot;prprf.h&quot;</span>
<a href="#l10.15"></a><span id="l10.15"> #include &lt;algorithm&gt;</span>
<a href="#l10.16"></a><span id="l10.16"> </span>
<a href="#l10.17"></a><span id="l10.17"> /* include event sink interfaces for news */</span>
<a href="#l10.18"></a><span id="l10.18"> </span>
<a href="#l10.19"></a><span id="l10.19"> #include &quot;nsIMsgSearchSession.h&quot;</span>
<a href="#l10.20"></a><span id="l10.20"> #include &quot;nsIMsgSearchAdapter.h&quot;</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineat">@@ -446,17 +447,17 @@ NS_IMETHODIMP nsNNTPProtocol::GetIsBusy(</span>
<a href="#l10.22"></a><span id="l10.22">   *aIsBusy = m_connectionBusy;</span>
<a href="#l10.23"></a><span id="l10.23">   return NS_OK;</span>
<a href="#l10.24"></a><span id="l10.24"> }</span>
<a href="#l10.25"></a><span id="l10.25"> </span>
<a href="#l10.26"></a><span id="l10.26"> NS_IMETHODIMP nsNNTPProtocol::SetIsBusy(bool aIsBusy)</span>
<a href="#l10.27"></a><span id="l10.27"> {</span>
<a href="#l10.28"></a><span id="l10.28">   MOZ_LOG(NNTP, LogLevel::Info,(&quot;(%p) setting busy to %d&quot;,this, aIsBusy));</span>
<a href="#l10.29"></a><span id="l10.29">   m_connectionBusy = aIsBusy;</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineminus">-  </span>
<a href="#l10.31"></a><span id="l10.31" class="difflineplus">+</span>
<a href="#l10.32"></a><span id="l10.32">   // Maybe we could load another URI.</span>
<a href="#l10.33"></a><span id="l10.33">   if (!aIsBusy &amp;&amp; m_nntpServer)</span>
<a href="#l10.34"></a><span id="l10.34">     m_nntpServer-&gt;PrepareForNextUrl(this);</span>
<a href="#l10.35"></a><span id="l10.35"> </span>
<a href="#l10.36"></a><span id="l10.36">   return NS_OK;</span>
<a href="#l10.37"></a><span id="l10.37"> }</span>
<a href="#l10.38"></a><span id="l10.38"> </span>
<a href="#l10.39"></a><span id="l10.39"> NS_IMETHODIMP nsNNTPProtocol::GetIsCachedConnection(bool *aIsCachedConnection)</span>
<a href="#l10.40"></a><span id="l10.40" class="difflineat">@@ -1955,91 +1956,76 @@ nsresult nsNNTPProtocol::SendFirstNNTPCo</span>
<a href="#l10.41"></a><span id="l10.41">     // if we have no channel listener, then we're likely downloading</span>
<a href="#l10.42"></a><span id="l10.42">     // the message for offline use (or at least not displaying it)</span>
<a href="#l10.43"></a><span id="l10.43">     bool savingArticleOffline = (m_channelListener == nullptr);</span>
<a href="#l10.44"></a><span id="l10.44"> </span>
<a href="#l10.45"></a><span id="l10.45">     if (m_runningURL)</span>
<a href="#l10.46"></a><span id="l10.46">       FinishMemCacheEntry(false);  // cleanup mem cache entry</span>
<a href="#l10.47"></a><span id="l10.47"> </span>
<a href="#l10.48"></a><span id="l10.48">     if (NS_SUCCEEDED(rv) &amp;&amp; !group_name.IsEmpty() &amp;&amp; !savingArticleOffline) {</span>
<a href="#l10.49"></a><span id="l10.49" class="difflineminus">-      nsString titleStr;</span>
<a href="#l10.50"></a><span id="l10.50" class="difflineminus">-      rv = GetNewsStringByName(&quot;htmlNewsErrorTitle&quot;, getter_Copies(titleStr));</span>
<a href="#l10.51"></a><span id="l10.51" class="difflineminus">-      NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.52"></a><span id="l10.52" class="difflineminus">-</span>
<a href="#l10.53"></a><span id="l10.53" class="difflineminus">-      nsString newsErrorStr;</span>
<a href="#l10.54"></a><span id="l10.54" class="difflineminus">-      rv = GetNewsStringByName(&quot;htmlNewsError&quot;, getter_Copies(newsErrorStr));</span>
<a href="#l10.55"></a><span id="l10.55" class="difflineminus">-      NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.56"></a><span id="l10.56" class="difflineminus">-      nsAutoString errorHtml;</span>
<a href="#l10.57"></a><span id="l10.57" class="difflineminus">-      errorHtml.Append(newsErrorStr);</span>
<a href="#l10.58"></a><span id="l10.58" class="difflineminus">-</span>
<a href="#l10.59"></a><span id="l10.59" class="difflineminus">-      errorHtml.AppendLiteral(&quot;&lt;b&gt;&quot;);</span>
<a href="#l10.60"></a><span id="l10.60" class="difflineminus">-      errorHtml.Append(NS_ConvertASCIItoUTF16(m_responseText));</span>
<a href="#l10.61"></a><span id="l10.61" class="difflineminus">-      errorHtml.AppendLiteral(&quot;&lt;/b&gt;&lt;p&gt;&quot;);</span>
<a href="#l10.62"></a><span id="l10.62" class="difflineminus">-</span>
<a href="#l10.63"></a><span id="l10.63" class="difflineminus">-      rv = GetNewsStringByName(&quot;articleExpired&quot;, getter_Copies(newsErrorStr));</span>
<a href="#l10.64"></a><span id="l10.64" class="difflineminus">-      NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.65"></a><span id="l10.65" class="difflineminus">-      errorHtml.Append(newsErrorStr);</span>
<a href="#l10.66"></a><span id="l10.66" class="difflineminus">-</span>
<a href="#l10.67"></a><span id="l10.67" class="difflineminus">-      char outputBuffer[OUTPUT_BUFFER_SIZE];</span>
<a href="#l10.68"></a><span id="l10.68" class="difflineplus">+      nsCString uri(NS_LITERAL_CSTRING(&quot;about:newserror?r=&quot;));</span>
<a href="#l10.69"></a><span id="l10.69" class="difflineplus">+      nsCString escapedResponse;</span>
<a href="#l10.70"></a><span id="l10.70" class="difflineplus">+      MsgEscapeURL(nsDependentCString(m_responseText), nsINetUtil::ESCAPE_URL_QUERY, escapedResponse);</span>
<a href="#l10.71"></a><span id="l10.71" class="difflineplus">+      uri.Append(escapedResponse);</span>
<a href="#l10.72"></a><span id="l10.72"> </span>
<a href="#l10.73"></a><span id="l10.73">       if ((m_key != nsMsgKey_None) &amp;&amp; m_newsFolder) {</span>
<a href="#l10.74"></a><span id="l10.74">         nsCString messageID;</span>
<a href="#l10.75"></a><span id="l10.75" class="difflineplus">+        nsCString escapedMessageID;</span>
<a href="#l10.76"></a><span id="l10.76">         rv = m_newsFolder-&gt;GetMessageIdForKey(m_key, messageID);</span>
<a href="#l10.77"></a><span id="l10.77">         if (NS_SUCCEEDED(rv)) {</span>
<a href="#l10.78"></a><span id="l10.78" class="difflineminus">-          PR_snprintf(outputBuffer, OUTPUT_BUFFER_SIZE,&quot;&lt;P&gt;&amp;lt;%.512s&amp;gt; (%lu)&quot;, messageID.get(), m_key);</span>
<a href="#l10.79"></a><span id="l10.79" class="difflineminus">-          errorHtml.Append(NS_ConvertASCIItoUTF16(outputBuffer));</span>
<a href="#l10.80"></a><span id="l10.80" class="difflineplus">+          uri.AppendLiteral(&quot;&amp;m=&quot;);</span>
<a href="#l10.81"></a><span id="l10.81" class="difflineplus">+          MsgEscapeURL(messageID, nsINetUtil::ESCAPE_URL_QUERY, escapedMessageID);</span>
<a href="#l10.82"></a><span id="l10.82" class="difflineplus">+          uri.Append(escapedMessageID);</span>
<a href="#l10.83"></a><span id="l10.83" class="difflineplus">+          uri.AppendLiteral(&quot;&amp;k=&quot;);</span>
<a href="#l10.84"></a><span id="l10.84" class="difflineplus">+          uri.AppendInt(m_key);</span>
<a href="#l10.85"></a><span id="l10.85">         }</span>
<a href="#l10.86"></a><span id="l10.86">       }</span>
<a href="#l10.87"></a><span id="l10.87"> </span>
<a href="#l10.88"></a><span id="l10.88">       if (m_newsFolder) {</span>
<a href="#l10.89"></a><span id="l10.89">         nsCOMPtr &lt;nsIMsgFolder&gt; folder = do_QueryInterface(m_newsFolder, &amp;rv);</span>
<a href="#l10.90"></a><span id="l10.90">         if (NS_SUCCEEDED(rv) &amp;&amp; folder) {</span>
<a href="#l10.91"></a><span id="l10.91">           nsCString folderURI;</span>
<a href="#l10.92"></a><span id="l10.92" class="difflineplus">+          nsCString escapedFolderURI;</span>
<a href="#l10.93"></a><span id="l10.93">           rv = folder-&gt;GetURI(folderURI);</span>
<a href="#l10.94"></a><span id="l10.94">           if (NS_SUCCEEDED(rv)) {</span>
<a href="#l10.95"></a><span id="l10.95" class="difflineminus">-            PR_snprintf(outputBuffer,OUTPUT_BUFFER_SIZE,&quot;&lt;P&gt; &lt;A HREF=\&quot;%s?list-ids\&quot;&gt;&quot;, folderURI.get());</span>
<a href="#l10.96"></a><span id="l10.96" class="difflineplus">+            uri.AppendLiteral(&quot;&amp;f=&quot;);</span>
<a href="#l10.97"></a><span id="l10.97" class="difflineplus">+            MsgEscapeURL(folderURI, nsINetUtil::ESCAPE_URL_QUERY, escapedFolderURI);</span>
<a href="#l10.98"></a><span id="l10.98" class="difflineplus">+            uri.Append(escapedFolderURI);</span>
<a href="#l10.99"></a><span id="l10.99">           }</span>
<a href="#l10.100"></a><span id="l10.100">         }</span>
<a href="#l10.101"></a><span id="l10.101">       }</span>
<a href="#l10.102"></a><span id="l10.102"> </span>
<a href="#l10.103"></a><span id="l10.103" class="difflineminus">-      errorHtml.Append(NS_ConvertASCIItoUTF16(outputBuffer));</span>
<a href="#l10.104"></a><span id="l10.104" class="difflineminus">-</span>
<a href="#l10.105"></a><span id="l10.105" class="difflineminus">-      rv = GetNewsStringByName(&quot;removeExpiredArtLinkText&quot;, getter_Copies(newsErrorStr));</span>
<a href="#l10.106"></a><span id="l10.106" class="difflineminus">-      NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.107"></a><span id="l10.107" class="difflineminus">-      errorHtml.Append(newsErrorStr);</span>
<a href="#l10.108"></a><span id="l10.108" class="difflineminus">-      errorHtml.AppendLiteral(&quot;&lt;/A&gt; &lt;/P&gt;&quot;);</span>
<a href="#l10.109"></a><span id="l10.109" class="difflineminus">-</span>
<a href="#l10.110"></a><span id="l10.110">       if (!m_msgWindow) {</span>
<a href="#l10.111"></a><span id="l10.111">         nsCOMPtr&lt;nsIMsgMailNewsUrl&gt; mailnewsurl = do_QueryInterface(m_runningURL);</span>
<a href="#l10.112"></a><span id="l10.112">         if (mailnewsurl) {</span>
<a href="#l10.113"></a><span id="l10.113">           rv = mailnewsurl-&gt;GetMsgWindow(getter_AddRefs(m_msgWindow));</span>
<a href="#l10.114"></a><span id="l10.114">           NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.115"></a><span id="l10.115">         }</span>
<a href="#l10.116"></a><span id="l10.116">       }</span>
<a href="#l10.117"></a><span id="l10.117">       if (!m_msgWindow) return NS_ERROR_FAILURE;</span>
<a href="#l10.118"></a><span id="l10.118"> </span>
<a href="#l10.119"></a><span id="l10.119">       // note, this will cause us to close the connection.</span>
<a href="#l10.120"></a><span id="l10.120">       // this will call nsDocShell::LoadURI(), which will</span>
<a href="#l10.121"></a><span id="l10.121">       // call nsDocShell::Stop(STOP_NETWORK), which will eventually</span>
<a href="#l10.122"></a><span id="l10.122">       // call nsNNTPProtocol::Cancel(), which will close the socket.</span>
<a href="#l10.123"></a><span id="l10.123">       // we need to fix this, since the connection is still valid.</span>
<a href="#l10.124"></a><span id="l10.124" class="difflineminus">-      rv = m_msgWindow-&gt;DisplayHTMLInMessagePane(titleStr, errorHtml, true);</span>
<a href="#l10.125"></a><span id="l10.125" class="difflineplus">+      rv = m_msgWindow-&gt;DisplayURIInMessagePane(NS_ConvertASCIItoUTF16(uri).get(), true,</span>
<a href="#l10.126"></a><span id="l10.126" class="difflineplus">+                                                nsContentUtils::GetSystemPrincipal());</span>
<a href="#l10.127"></a><span id="l10.127">       NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l10.128"></a><span id="l10.128">     }</span>
<a href="#l10.129"></a><span id="l10.129">     // let's take the opportunity of removing the hdr from the db so we don't try to download</span>
<a href="#l10.130"></a><span id="l10.130">     // it again.</span>
<a href="#l10.131"></a><span id="l10.131">     else if (savingArticleOffline)</span>
<a href="#l10.132"></a><span id="l10.132">     {</span>
<a href="#l10.133"></a><span id="l10.133">       if ((m_key != nsMsgKey_None) &amp;&amp; (m_newsFolder)) {</span>
<a href="#l10.134"></a><span id="l10.134">          rv = m_newsFolder-&gt;RemoveMessage(m_key);</span>
<a href="#l10.135"></a><span id="l10.135">       }</span>
<a href="#l10.136"></a><span id="l10.136">     }</span>
<a href="#l10.137"></a><span id="l10.137">     return NS_ERROR_FAILURE;</span>
<a href="#l10.138"></a><span id="l10.138">   }</span>
<a href="#l10.139"></a><span id="l10.139" class="difflineminus">-</span>
<a href="#l10.140"></a><span id="l10.140"> }</span>
<a href="#l10.141"></a><span id="l10.141"> </span>
<a href="#l10.142"></a><span id="l10.142"> nsresult nsNNTPProtocol::SendGroupForArticle()</span>
<a href="#l10.143"></a><span id="l10.143"> {</span>
<a href="#l10.144"></a><span id="l10.144">   nsresult rv;</span>
<a href="#l10.145"></a><span id="l10.145"> </span>
<a href="#l10.146"></a><span id="l10.146">   nsCString groupname;</span>
<a href="#l10.147"></a><span id="l10.147">   rv = m_newsFolder-&gt;GetRawName(groupname);</span>
<a href="#l10.148"></a><span id="l10.148" class="difflineat">@@ -2350,17 +2336,17 @@ nsresult nsNNTPProtocol::BeginAuthorizat</span>
<a href="#l10.149"></a><span id="l10.149">   {</span>
<a href="#l10.150"></a><span id="l10.150">     nsCOMPtr&lt;nsIMsgAsyncPrompter&gt; asyncPrompter =</span>
<a href="#l10.151"></a><span id="l10.151">       do_GetService(NS_MSGASYNCPROMPTER_CONTRACTID, &amp;rv);</span>
<a href="#l10.152"></a><span id="l10.152">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l10.153"></a><span id="l10.153"> </span>
<a href="#l10.154"></a><span id="l10.154">     // Get the key to coalesce auth prompts.</span>
<a href="#l10.155"></a><span id="l10.155">     bool singleSignon = false;</span>
<a href="#l10.156"></a><span id="l10.156">     m_nntpServer-&gt;GetSingleSignon(&amp;singleSignon);</span>
<a href="#l10.157"></a><span id="l10.157" class="difflineminus">-    </span>
<a href="#l10.158"></a><span id="l10.158" class="difflineplus">+</span>
<a href="#l10.159"></a><span id="l10.159">     nsCString queueKey;</span>
<a href="#l10.160"></a><span id="l10.160">     nsCOMPtr&lt;nsIMsgIncomingServer&gt; server = do_QueryInterface(m_nntpServer);</span>
<a href="#l10.161"></a><span id="l10.161">     server-&gt;GetKey(queueKey);</span>
<a href="#l10.162"></a><span id="l10.162">     if (!singleSignon)</span>
<a href="#l10.163"></a><span id="l10.163">     {</span>
<a href="#l10.164"></a><span id="l10.164">       nsCString groupName;</span>
<a href="#l10.165"></a><span id="l10.165">       m_newsFolder-&gt;GetRawName(groupName);</span>
<a href="#l10.166"></a><span id="l10.166">       queueKey += groupName;</span>
<a href="#l10.167"></a><span id="l10.167" class="difflineat">@@ -2516,17 +2502,17 @@ NS_IMETHODIMP nsNNTPProtocol::OnPromptSt</span>
<a href="#l10.168"></a><span id="l10.168">   OnPromptStart(&amp;result);</span>
<a href="#l10.169"></a><span id="l10.169">   return aCallback-&gt;OnAuthResult(result);</span>
<a href="#l10.170"></a><span id="l10.170"> }</span>
<a href="#l10.171"></a><span id="l10.171"> </span>
<a href="#l10.172"></a><span id="l10.172"> NS_IMETHODIMP nsNNTPProtocol::OnPromptStart(bool *authAvailable)</span>
<a href="#l10.173"></a><span id="l10.173"> {</span>
<a href="#l10.174"></a><span id="l10.174">   NS_ENSURE_ARG_POINTER(authAvailable);</span>
<a href="#l10.175"></a><span id="l10.175">   NS_ENSURE_STATE(m_nextState == NNTP_SUSPENDED);</span>
<a href="#l10.176"></a><span id="l10.176" class="difflineminus">-  </span>
<a href="#l10.177"></a><span id="l10.177" class="difflineplus">+</span>
<a href="#l10.178"></a><span id="l10.178">   if (!m_newsFolder)</span>
<a href="#l10.179"></a><span id="l10.179">   {</span>
<a href="#l10.180"></a><span id="l10.180">     // If we don't have a news folder, we may have been closed already.</span>
<a href="#l10.181"></a><span id="l10.181">     NNTP_LOG_NOTE(&quot;Canceling queued authentication prompt&quot;);</span>
<a href="#l10.182"></a><span id="l10.182">     *authAvailable = false;</span>
<a href="#l10.183"></a><span id="l10.183">     return NS_OK;</span>
<a href="#l10.184"></a><span id="l10.184">   }</span>
<a href="#l10.185"></a><span id="l10.185"> </span>
<a href="#l10.186"></a><span id="l10.186" class="difflineat">@@ -2552,17 +2538,17 @@ NS_IMETHODIMP nsNNTPProtocol::OnPromptAu</span>
<a href="#l10.187"></a><span id="l10.187">   // into the state machine to start the process going again.</span>
<a href="#l10.188"></a><span id="l10.188">   m_nextState = NNTP_BEGIN_AUTHORIZE;</span>
<a href="#l10.189"></a><span id="l10.189">   return ProcessProtocolState(nullptr, nullptr, 0, 0);</span>
<a href="#l10.190"></a><span id="l10.190"> }</span>
<a href="#l10.191"></a><span id="l10.191"> </span>
<a href="#l10.192"></a><span id="l10.192"> NS_IMETHODIMP nsNNTPProtocol::OnPromptCanceled()</span>
<a href="#l10.193"></a><span id="l10.193"> {</span>
<a href="#l10.194"></a><span id="l10.194">   NS_ENSURE_STATE(m_nextState == NNTP_SUSPENDED);</span>
<a href="#l10.195"></a><span id="l10.195" class="difflineminus">- </span>
<a href="#l10.196"></a><span id="l10.196" class="difflineplus">+</span>
<a href="#l10.197"></a><span id="l10.197">   // We previously suspended the request; now resume it to read input</span>
<a href="#l10.198"></a><span id="l10.198">   if (m_request)</span>
<a href="#l10.199"></a><span id="l10.199">     m_request-&gt;Resume();</span>
<a href="#l10.200"></a><span id="l10.200"> </span>
<a href="#l10.201"></a><span id="l10.201">   // Since the prompt was canceled, we can no longer continue the connection.</span>
<a href="#l10.202"></a><span id="l10.202">   // Thus, we need to go to the NNTP_ERROR state.</span>
<a href="#l10.203"></a><span id="l10.203">   m_nextState = NNTP_ERROR;</span>
<a href="#l10.204"></a><span id="l10.204">   return ProcessProtocolState(nullptr, nullptr, 0, 0);</span>
<a href="#l10.205"></a><span id="l10.205" class="difflineat">@@ -3222,17 +3208,17 @@ nsresult nsNNTPProtocol::XhdrSend()</span>
<a href="#l10.206"></a><span id="l10.206"> {</span>
<a href="#l10.207"></a><span id="l10.207">   nsCString header;</span>
<a href="#l10.208"></a><span id="l10.208">   m_newsgroupList-&gt;InitXHDR(header);</span>
<a href="#l10.209"></a><span id="l10.209">   if (header.IsEmpty())</span>
<a href="#l10.210"></a><span id="l10.210">   {</span>
<a href="#l10.211"></a><span id="l10.211">     m_nextState = NNTP_FIGURE_NEXT_CHUNK;</span>
<a href="#l10.212"></a><span id="l10.212">     return NS_OK;</span>
<a href="#l10.213"></a><span id="l10.213">   }</span>
<a href="#l10.214"></a><span id="l10.214" class="difflineminus">-  </span>
<a href="#l10.215"></a><span id="l10.215" class="difflineplus">+</span>
<a href="#l10.216"></a><span id="l10.216">   char outputBuffer[OUTPUT_BUFFER_SIZE];</span>
<a href="#l10.217"></a><span id="l10.217">   PR_snprintf(outputBuffer, OUTPUT_BUFFER_SIZE, &quot;XHDR %s %d-%d&quot; CRLF,</span>
<a href="#l10.218"></a><span id="l10.218">               header.get(), m_firstArticle, m_lastArticle);</span>
<a href="#l10.219"></a><span id="l10.219"> </span>
<a href="#l10.220"></a><span id="l10.220">   m_nextState = NNTP_RESPONSE;</span>
<a href="#l10.221"></a><span id="l10.221">   m_nextStateAfterResponse = NNTP_XHDR_RESPONSE;</span>
<a href="#l10.222"></a><span id="l10.222">   SetFlag(NNTP_PAUSE_FOR_READ);</span>
<a href="#l10.223"></a><span id="l10.223"> </span>
<a href="#l10.224"></a><span id="l10.224" class="difflineat">@@ -3245,17 +3231,17 @@ nsresult nsNNTPProtocol::XhdrResponse(ns</span>
<a href="#l10.225"></a><span id="l10.225">   {</span>
<a href="#l10.226"></a><span id="l10.226">     m_nextState = NNTP_READ_GROUP;</span>
<a href="#l10.227"></a><span id="l10.227">     // The reasoning behind setting this flag and not an XHDR flag is that we</span>
<a href="#l10.228"></a><span id="l10.228">     // are going to have to use HEAD instead. At that point, using XOVER as</span>
<a href="#l10.229"></a><span id="l10.229">     // well is just wasting bandwidth.</span>
<a href="#l10.230"></a><span id="l10.230">     SetFlag(NNTP_NO_XOVER_SUPPORT);</span>
<a href="#l10.231"></a><span id="l10.231">     return NS_OK;</span>
<a href="#l10.232"></a><span id="l10.232">   }</span>
<a href="#l10.233"></a><span id="l10.233" class="difflineminus">-  </span>
<a href="#l10.234"></a><span id="l10.234" class="difflineplus">+</span>
<a href="#l10.235"></a><span id="l10.235">   char *line, *lineToFree;</span>
<a href="#l10.236"></a><span id="l10.236">   nsresult rv;</span>
<a href="#l10.237"></a><span id="l10.237">   uint32_t status = 1;</span>
<a href="#l10.238"></a><span id="l10.238"> </span>
<a href="#l10.239"></a><span id="l10.239">   bool pauseForMoreData = false;</span>
<a href="#l10.240"></a><span id="l10.240">   line = lineToFree = m_lineStreamBuffer-&gt;ReadNextLine(inputStream, status, pauseForMoreData, &amp;rv);</span>
<a href="#l10.241"></a><span id="l10.241"> </span>
<a href="#l10.242"></a><span id="l10.242">   if (pauseForMoreData)</span>
<a href="#l10.243"></a><span id="l10.243" class="difflineat">@@ -3704,17 +3690,17 @@ nsresult nsNNTPProtocol::DoCancel()</span>
<a href="#l10.244"></a><span id="l10.244">     bool dummyValue = false;</span>
<a href="#l10.245"></a><span id="l10.245">     rv = dialog-&gt;ConfirmEx(nullptr, confirmText.get(), nsIPrompt::STD_YES_NO_BUTTONS,</span>
<a href="#l10.246"></a><span id="l10.246">                            nullptr, nullptr, nullptr, nullptr, &amp;dummyValue, &amp;confirmCancelResult);</span>
<a href="#l10.247"></a><span id="l10.247">     if (NS_FAILED(rv))</span>
<a href="#l10.248"></a><span id="l10.248">     	confirmCancelResult = 1; // Default to No.</span>
<a href="#l10.249"></a><span id="l10.249">   }</span>
<a href="#l10.250"></a><span id="l10.250">   else</span>
<a href="#l10.251"></a><span id="l10.251">     confirmCancelResult = 0; // Default to Yes.</span>
<a href="#l10.252"></a><span id="l10.252" class="difflineminus">-    </span>
<a href="#l10.253"></a><span id="l10.253" class="difflineplus">+</span>
<a href="#l10.254"></a><span id="l10.254">   if (confirmCancelResult != 0) {</span>
<a href="#l10.255"></a><span id="l10.255">       // they cancelled the cancel</span>
<a href="#l10.256"></a><span id="l10.256">       status = MK_NNTP_NOT_CANCELLED;</span>
<a href="#l10.257"></a><span id="l10.257">       failure = true;</span>
<a href="#l10.258"></a><span id="l10.258">       goto FAIL;</span>
<a href="#l10.259"></a><span id="l10.259">   }</span>
<a href="#l10.260"></a><span id="l10.260"> </span>
<a href="#l10.261"></a><span id="l10.261">   if (!subject || !body)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/suite/locales/en-US/chrome/mailnews/news.properties</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/mailnews/news.properties</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -1,19 +1,13 @@</span>
<a href="#l11.4"></a><span id="l11.4"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l11.5"></a><span id="l11.5"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l11.6"></a><span id="l11.6"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l11.7"></a><span id="l11.7"> downloadHeadersTitlePrefix=Download Headers</span>
<a href="#l11.8"></a><span id="l11.8"> downloadHeadersInfoText=There are %S new message headers to download for this newsgroup.</span>
<a href="#l11.9"></a><span id="l11.9" class="difflineminus">-htmlNewsErrorTitle=Error!</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineminus">-# LOCALIZATION NOTE ( htmlNewsError ): In the following item, translate only &quot;Error!&quot; and &quot;newsgroup server responded:&quot;</span>
<a href="#l11.11"></a><span id="l11.11" class="difflineminus">-htmlNewsError=&lt;H1&gt;Error!&lt;/H1&gt;newsgroup server responded: </span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-# LOCALIZATION NOTE ( articleExpired ): In the following item, translate only &quot;Perhaps the article has expired&quot;</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-articleExpired=&lt;B&gt;&lt;P&gt;Perhaps the article has expired&lt;/P&gt;&lt;/B&gt;</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineminus">-removeExpiredArtLinkText=Click here to remove all expired articles</span>
<a href="#l11.15"></a><span id="l11.15"> cancelDisallowed=This message does not appear to be from you.  You may only cancel your own posts, not those made by others.</span>
<a href="#l11.16"></a><span id="l11.16"> cancelConfirm=Are you sure you want to cancel this message?</span>
<a href="#l11.17"></a><span id="l11.17"> messageCancelled=Message cancelled.</span>
<a href="#l11.18"></a><span id="l11.18"> enterUserPassTitle=News Server Username and Password Required</span>
<a href="#l11.19"></a><span id="l11.19"> # LOCALIZATION NOTE (enterUserPassServer): %S is the server being accessed</span>
<a href="#l11.20"></a><span id="l11.20"> enterUserPassServer=Please enter a username and password for %S:</span>
<a href="#l11.21"></a><span id="l11.21"> # LOCALIZATION NOTE (enterUserPassGroup): %1$S is a specific newsgroup to set</span>
<a href="#l11.22"></a><span id="l11.22"> # the password for; %2$S is the server from which the newsgroup is accessed</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1">new file mode 100644</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineminus">--- /dev/null</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineplus">+++ b/suite/locales/en-US/chrome/mailnews/newsError.dtd</span>
<a href="#l12.4"></a><span id="l12.4" class="difflineat">@@ -0,0 +1,31 @@</span>
<a href="#l12.5"></a><span id="l12.5" class="difflineplus">+&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l12.6"></a><span id="l12.6" class="difflineplus">+   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l12.7"></a><span id="l12.7" class="difflineplus">+   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l12.8"></a><span id="l12.8" class="difflineplus">+</span>
<a href="#l12.9"></a><span id="l12.9" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (newsError.title): The title of the news error page.</span>
<a href="#l12.10"></a><span id="l12.10" class="difflineplus">+     Not generally visible. --&gt;</span>
<a href="#l12.11"></a><span id="l12.11" class="difflineplus">+&lt;!ENTITY newsError.title &quot;Problem Loading Article&quot;&gt;</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineplus">+</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (articleNotFound.title): The main heading for the news</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+     error page. --&gt;</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+&lt;!ENTITY articleNotFound.title &quot;Article not found&quot;&gt;</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (articleNotFound.desc): A longer description for the news</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+     error page. --&gt;</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+&lt;!ENTITY articleNotFound.desc &quot;The newsgroup server reports that it can't find the article.&quot;&gt;</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineplus">+</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (serverResponded.title): A string preceding the text</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineplus">+     response from the newsgroup server describing the error. --&gt;</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineplus">+&lt;!ENTITY serverResponded.title &quot;Newsgroup server responded:&quot;&gt;</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineplus">+</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (articleExpired.title): A string explaining that the</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineplus">+     article may have expired. --&gt;</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineplus">+&lt;!ENTITY articleExpired.title &quot;Perhaps the article has expired?&quot;&gt;</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineplus">+</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (trySearching.title): A string preceding the message's</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineplus">+     ID. --&gt;</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineplus">+&lt;!ENTITY trySearching.title &quot;Try searching for article:&quot;&gt;</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (removeExpiredArticles.title): The label for the button</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineplus">+     to remove all expired articles from the newsgroup. --&gt;</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineplus">+&lt;!ENTITY removeExpiredArticles.title &quot;Remove All Expired Articles&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/suite/locales/jar.mn</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/suite/locales/jar.mn</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -304,16 +304,17 @@</span>
<a href="#l13.4"></a><span id="l13.4">   locale/@AB_CD@/messenger/msgFolderPickerOverlay.dtd                       (%chrome/mailnews/msgFolderPickerOverlay.dtd)</span>
<a href="#l13.5"></a><span id="l13.5">   locale/@AB_CD@/messenger/msgHdrViewOverlay.dtd                            (%chrome/mailnews/msgHdrViewOverlay.dtd)</span>
<a href="#l13.6"></a><span id="l13.6">   locale/@AB_CD@/messenger/msgHdrViewPopup.dtd                              (%chrome/mailnews/msgHdrViewPopup.dtd)</span>
<a href="#l13.7"></a><span id="l13.7">   locale/@AB_CD@/messenger/msgmdn.properties                                (%chrome/mailnews/msgmdn.properties)</span>
<a href="#l13.8"></a><span id="l13.8">   locale/@AB_CD@/messenger/msgSynchronize.dtd                               (%chrome/mailnews/msgSynchronize.dtd)</span>
<a href="#l13.9"></a><span id="l13.9">   locale/@AB_CD@/messenger/msgViewPickerOverlay.dtd                         (%chrome/mailnews/msgViewPickerOverlay.dtd)</span>
<a href="#l13.10"></a><span id="l13.10">   locale/@AB_CD@/messenger/newFolderDialog.dtd                              (%chrome/mailnews/newFolderDialog.dtd)</span>
<a href="#l13.11"></a><span id="l13.11">   locale/@AB_CD@/messenger/news.properties                                  (%chrome/mailnews/news.properties)</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+  locale/@AB_CD@/messenger/newsError.dtd                                    (%chrome/mailnews/newsError.dtd)</span>
<a href="#l13.13"></a><span id="l13.13">   locale/@AB_CD@/messenger/oeImportMsgs.properties                          (%chrome/mailnews/oeImportMsgs.properties)</span>
<a href="#l13.14"></a><span id="l13.14">   locale/@AB_CD@/messenger/offline.properties                               (%chrome/mailnews/offline.properties)</span>
<a href="#l13.15"></a><span id="l13.15">   locale/@AB_CD@/messenger/offlineStartup.properties                        (%chrome/mailnews/offlineStartup.properties)</span>
<a href="#l13.16"></a><span id="l13.16">   locale/@AB_CD@/messenger/outlookImportMsgs.properties                     (%chrome/mailnews/outlookImportMsgs.properties)</span>
<a href="#l13.17"></a><span id="l13.17">   locale/@AB_CD@/messenger/prefs.properties                                 (%chrome/mailnews/pref/prefs.properties)</span>
<a href="#l13.18"></a><span id="l13.18">   locale/@AB_CD@/messenger/pref-character_encoding.dtd                      (%chrome/mailnews/pref/pref-character_encoding.dtd)</span>
<a href="#l13.19"></a><span id="l13.19">   locale/@AB_CD@/messenger/pref-junk.dtd                                    (%chrome/mailnews/pref/pref-junk.dtd)</span>
<a href="#l13.20"></a><span id="l13.20">   locale/@AB_CD@/messenger/pref-tags.dtd                                    (%chrome/mailnews/pref/pref-tags.dtd)</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

