<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 10722:16bca5fa8f0889bec716fccefeb847d2cae56ba7</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 16bca5fa8f0889bec716fccefeb847d2cae56ba7" />
<meta property="og:url" content="/comm-central/rev/16bca5fa8f0889bec716fccefeb847d2cae56ba7" />
<meta property="og:description" content="Bug 776316 - Update to Mozmill 1.5.16. r=mozmill." />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 16bca5fa8f0889bec716fccefeb847d2cae56ba7 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/16bca5fa8f0889bec716fccefeb847d2cae56ba7">shortlog</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/16bca5fa8f0889bec716fccefeb847d2cae56ba7">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7">files</a> |
changeset |
<a href="/comm-central/raw-rev/16bca5fa8f0889bec716fccefeb847d2cae56ba7">raw</a>  | <a href="/comm-central/archive/16bca5fa8f0889bec716fccefeb847d2cae56ba7.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=776316">Bug 776316</a> - Update to Mozmill 1.5.16. r=mozmill.
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#77;&#105;&#107;&#101;&#32;&#67;&#111;&#110;&#108;&#101;&#121;&#32;&#60;&#109;&#99;&#111;&#110;&#108;&#101;&#121;&#64;&#109;&#111;&#122;&#105;&#108;&#108;&#97;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 24 Jul 2012 16:47:15 -0400</td></tr>

<tr>
 <td>changeset 10722</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/16bca5fa8f0889bec716fccefeb847d2cae56ba7">16bca5fa8f0889bec716fccefeb847d2cae56ba7</a></td>
</tr>



<tr>
<td>parent 10721</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/927b4c1ae37690e20557f9407554e53171ef10dd">927b4c1ae37690e20557f9407554e53171ef10dd</a>
</td>
</tr>

<tr>
<td>child 10723</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/c2c87f2fd5347f965872fd6986788c8a2b6e5fec">c2c87f2fd5347f965872fd6986788c8a2b6e5fec</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=16bca5fa8f0889bec716fccefeb847d2cae56ba7">8082</a></td></tr>
<tr><td>push user</td><td>mconley@mozilla.com</td></tr>
<tr><td>push date</td><td class="date age">Tue, 24 Jul 2012 20:48:45 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@c2c87f2fd534 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=c2c87f2fd5347f965872fd6986788c8a2b6e5fec">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=c2c87f2fd5347f965872fd6986788c8a2b6e5fec&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=c2c87f2fd5347f965872fd6986788c8a2b6e5fec&newProject=comm-central&newRevision=927b4c1ae37690e20557f9407554e53171ef10dd&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=c2c87f2fd5347f965872fd6986788c8a2b6e5fec&newProject=comm-central&newRevision=927b4c1ae37690e20557f9407554e53171ef10dd&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=c2c87f2fd5347f965872fd6986788c8a2b6e5fec&newProject=comm-central&newRevision=927b4c1ae37690e20557f9407554e53171ef10dd&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28mozmill%29&revcount=50">mozmill</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=776316">776316</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=776316">Bug 776316</a> - Update to Mozmill 1.5.16. r=mozmill.</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/__init__.py">mail/test/resources/jsbridge/jsbridge/__init__.py</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/__init__.py">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/__init__.py">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/__init__.py">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/__init__.py">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/__init__.py">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/extension/install.rdf">mail/test/resources/jsbridge/jsbridge/extension/install.rdf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/extension/install.rdf">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/extension/install.rdf">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/extension/install.rdf">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/extension/install.rdf">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/extension/install.rdf">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/jsobjects.py">mail/test/resources/jsbridge/jsbridge/jsobjects.py</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/jsobjects.py">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/jsobjects.py">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/jsobjects.py">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/jsobjects.py">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/jsobjects.py">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/network.py">mail/test/resources/jsbridge/jsbridge/network.py</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/network.py">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/network.py">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/network.py">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/network.py">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/jsbridge/network.py">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/setup.py">mail/test/resources/jsbridge/setup.py</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/setup.py">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/setup.py">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/setup.py">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/setup.py">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/jsbridge/setup.py">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/__init__.py">mail/test/resources/mozmill/mozmill/__init__.py</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/__init__.py">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/__init__.py">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/__init__.py">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/__init__.py">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/__init__.py">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/chrome.manifest">mail/test/resources/mozmill/mozmill/extension/chrome.manifest</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/chrome.manifest">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/chrome.manifest">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/chrome.manifest">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/chrome.manifest">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/chrome.manifest">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_flat_0_aaaaaa_40x100.png">mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_flat_0_aaaaaa_40x100.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_flat_0_aaaaaa_40x100.png">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_flat_0_aaaaaa_40x100.png">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_flat_0_aaaaaa_40x100.png">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_flat_0_aaaaaa_40x100.png">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_flat_0_aaaaaa_40x100.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_flat_75_ffffff_40x100.png">mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_flat_75_ffffff_40x100.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_flat_75_ffffff_40x100.png">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_flat_75_ffffff_40x100.png">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_flat_75_ffffff_40x100.png">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_flat_75_ffffff_40x100.png">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_flat_75_ffffff_40x100.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_55_fbf9ee_1x400.png">mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_55_fbf9ee_1x400.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_55_fbf9ee_1x400.png">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_55_fbf9ee_1x400.png">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_55_fbf9ee_1x400.png">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_55_fbf9ee_1x400.png">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_55_fbf9ee_1x400.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_65_ffffff_1x400.png">mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_65_ffffff_1x400.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_65_ffffff_1x400.png">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_65_ffffff_1x400.png">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_65_ffffff_1x400.png">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_65_ffffff_1x400.png">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_65_ffffff_1x400.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_75_dadada_1x400.png">mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_75_dadada_1x400.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_75_dadada_1x400.png">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_75_dadada_1x400.png">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_75_dadada_1x400.png">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_75_dadada_1x400.png">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_75_dadada_1x400.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_75_e6e6e6_1x400.png">mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_75_e6e6e6_1x400.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_75_e6e6e6_1x400.png">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_75_e6e6e6_1x400.png">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_75_e6e6e6_1x400.png">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_75_e6e6e6_1x400.png">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_75_e6e6e6_1x400.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_95_fef1ec_1x400.png">mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_95_fef1ec_1x400.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_95_fef1ec_1x400.png">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_95_fef1ec_1x400.png">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_95_fef1ec_1x400.png">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_95_fef1ec_1x400.png">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_glass_95_fef1ec_1x400.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_highlight-soft_75_cccccc_1x100.png">mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_highlight-soft_75_cccccc_1x100.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_highlight-soft_75_cccccc_1x100.png">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_highlight-soft_75_cccccc_1x100.png">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_highlight-soft_75_cccccc_1x100.png">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_highlight-soft_75_cccccc_1x100.png">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-bg_highlight-soft_75_cccccc_1x100.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_222222_256x240.png">mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_222222_256x240.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_222222_256x240.png">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_222222_256x240.png">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_222222_256x240.png">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_222222_256x240.png">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_222222_256x240.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_2e83ff_256x240.png">mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_2e83ff_256x240.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_2e83ff_256x240.png">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_2e83ff_256x240.png">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_2e83ff_256x240.png">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_2e83ff_256x240.png">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_2e83ff_256x240.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_454545_256x240.png">mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_454545_256x240.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_454545_256x240.png">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_454545_256x240.png">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_454545_256x240.png">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_454545_256x240.png">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_454545_256x240.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_888888_256x240.png">mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_888888_256x240.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_888888_256x240.png">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_888888_256x240.png">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_888888_256x240.png">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_888888_256x240.png">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_888888_256x240.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_cd0a0a_256x240.png">mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_cd0a0a_256x240.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_cd0a0a_256x240.png">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_cd0a0a_256x240.png">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_cd0a0a_256x240.png">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_cd0a0a_256x240.png">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/images/ui-icons_cd0a0a_256x240.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/jquery-ui-1.7.1.custom.css">mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/jquery-ui-1.7.1.custom.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/jquery-ui-1.7.1.custom.css">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/jquery-ui-1.7.1.custom.css">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/jquery-ui-1.7.1.custom.css">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/jquery-ui-1.7.1.custom.css">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/css/smoothness/jquery-ui-1.7.1.custom.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/jquery/jquery-1.3.2.min.js">mail/test/resources/mozmill/mozmill/extension/content/jquery/jquery-1.3.2.min.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/jquery/jquery-1.3.2.min.js">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/jquery/jquery-1.3.2.min.js">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/jquery/jquery-1.3.2.min.js">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/jquery/jquery-1.3.2.min.js">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/jquery/jquery-1.3.2.min.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/jquery/jquery-ui-1.7.1.custom.min.js">mail/test/resources/mozmill/mozmill/extension/content/jquery/jquery-ui-1.7.1.custom.min.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/jquery/jquery-ui-1.7.1.custom.min.js">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/jquery/jquery-ui-1.7.1.custom.min.js">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/jquery/jquery-ui-1.7.1.custom.min.js">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/jquery/jquery-ui-1.7.1.custom.min.js">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/jquery/jquery-ui-1.7.1.custom.min.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/mozmill.xul">mail/test/resources/mozmill/mozmill/extension/content/mozmill.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/mozmill.xul">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/mozmill.xul">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/mozmill.xul">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/mozmill.xul">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/mozmill.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/overlay.js">mail/test/resources/mozmill/mozmill/extension/content/overlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/overlay.js">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/overlay.js">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/overlay.js">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/overlay.js">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/overlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/overlay.xul">mail/test/resources/mozmill/mozmill/extension/content/overlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/overlay.xul">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/overlay.xul">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/overlay.xul">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/overlay.xul">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/content/overlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/install.rdf">mail/test/resources/mozmill/mozmill/extension/install.rdf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/install.rdf">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/install.rdf">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/install.rdf">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/install.rdf">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/install.rdf">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/locale/en-US/mozmill.dtd">mail/test/resources/mozmill/mozmill/extension/locale/en-US/mozmill.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/locale/en-US/mozmill.dtd">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/locale/en-US/mozmill.dtd">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/locale/en-US/mozmill.dtd">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/locale/en-US/mozmill.dtd">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/locale/en-US/mozmill.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/locale/en-US/overlay.dtd">mail/test/resources/mozmill/mozmill/extension/locale/en-US/overlay.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/locale/en-US/overlay.dtd">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/locale/en-US/overlay.dtd">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/locale/en-US/overlay.dtd">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/locale/en-US/overlay.dtd">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/locale/en-US/overlay.dtd">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/readme.txt">mail/test/resources/mozmill/mozmill/extension/readme.txt</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/readme.txt">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/readme.txt">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/readme.txt">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/readme.txt">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/readme.txt">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/modules/frame.js">mail/test/resources/mozmill/mozmill/extension/resource/modules/frame.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/modules/frame.js">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/modules/frame.js">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/modules/frame.js">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/modules/frame.js">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/modules/frame.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/modules/init.js">mail/test/resources/mozmill/mozmill/extension/resource/modules/init.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/modules/init.js">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/modules/init.js">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/modules/init.js">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/modules/init.js">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/modules/init.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/EventUtils.js">mail/test/resources/mozmill/mozmill/extension/resource/stdlib/EventUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/EventUtils.js">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/EventUtils.js">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/EventUtils.js">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/EventUtils.js">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/EventUtils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js">mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js">mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/skin/overlay.css">mail/test/resources/mozmill/mozmill/extension/skin/overlay.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/skin/overlay.css">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/skin/overlay.css">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/skin/overlay.css">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/skin/overlay.css">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/mozmill/extension/skin/overlay.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/patches/httpd.patch">mail/test/resources/mozmill/patches/httpd.patch</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/patches/httpd.patch">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/patches/httpd.patch">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/patches/httpd.patch">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/scripts/sync_dependencies.py">mail/test/resources/mozmill/scripts/sync_dependencies.py</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/scripts/sync_dependencies.py">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/scripts/sync_dependencies.py">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/scripts/sync_dependencies.py">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/scripts/sync_dependencies.py">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/scripts/sync_dependencies.py">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/setup.py">mail/test/resources/mozmill/setup.py</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/setup.py">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/setup.py">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/setup.py">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/setup.py">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/setup.py">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/test/restart/test_user_restart/test5.js">mail/test/resources/mozmill/test/restart/test_user_restart/test5.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/test/restart/test_user_restart/test5.js">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/test/restart/test_user_restart/test5.js">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/test/restart/test_user_restart/test5.js">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/test/restart/test_user_restart/test5.js">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozmill/test/restart/test_user_restart/test5.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/__init__.py">mail/test/resources/mozrunner/mozrunner/__init__.py</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/__init__.py">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/__init__.py">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/__init__.py">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/__init__.py">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/__init__.py">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/killableprocess.py">mail/test/resources/mozrunner/mozrunner/killableprocess.py</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/killableprocess.py">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/killableprocess.py">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/killableprocess.py">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/killableprocess.py">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/killableprocess.py">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/winprocess.py">mail/test/resources/mozrunner/mozrunner/winprocess.py</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/winprocess.py">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/winprocess.py">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/winprocess.py">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/winprocess.py">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/mozrunner/winprocess.py">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/setup.py">mail/test/resources/mozrunner/setup.py</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/setup.py">file</a> |
<a href="/comm-central/annotate/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/setup.py">annotate</a> |
<a href="/comm-central/diff/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/setup.py">diff</a> |
<a href="/comm-central/comparison/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/setup.py">comparison</a> |
<a href="/comm-central/log/16bca5fa8f0889bec716fccefeb847d2cae56ba7/mail/test/resources/mozrunner/setup.py">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/test/resources/jsbridge/jsbridge/__init__.py</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/test/resources/jsbridge/jsbridge/__init__.py</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -1,11 +1,45 @@</span>
<a href="#l1.4"></a><span id="l1.4" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l1.5"></a><span id="l1.5" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l1.6"></a><span id="l1.6" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l1.7"></a><span id="l1.7" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l1.8"></a><span id="l1.8" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l1.9"></a><span id="l1.9" class="difflineplus">+# </span>
<a href="#l1.10"></a><span id="l1.10" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l1.11"></a><span id="l1.11" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+# </span>
<a href="#l1.15"></a><span id="l1.15" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineplus">+# License.</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineplus">+# </span>
<a href="#l1.20"></a><span id="l1.20" class="difflineplus">+# The Original Code is Mozilla Corporation Code.</span>
<a href="#l1.21"></a><span id="l1.21" class="difflineplus">+# </span>
<a href="#l1.22"></a><span id="l1.22" class="difflineplus">+# The Initial Developer of the Original Code is</span>
<a href="#l1.23"></a><span id="l1.23" class="difflineplus">+# Mikeal Rogers.</span>
<a href="#l1.24"></a><span id="l1.24" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2008 -2009</span>
<a href="#l1.25"></a><span id="l1.25" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l1.26"></a><span id="l1.26" class="difflineplus">+# </span>
<a href="#l1.27"></a><span id="l1.27" class="difflineplus">+# Contributor(s):</span>
<a href="#l1.28"></a><span id="l1.28" class="difflineplus">+#  Mikeal Rogers &lt;mikeal.rogers@gmail.com&gt;</span>
<a href="#l1.29"></a><span id="l1.29" class="difflineplus">+#  Henrik Skupin &lt;hskupin@mozilla.com&gt;</span>
<a href="#l1.30"></a><span id="l1.30" class="difflineplus">+# </span>
<a href="#l1.31"></a><span id="l1.31" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l1.36"></a><span id="l1.36" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l1.37"></a><span id="l1.37" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l1.38"></a><span id="l1.38" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l1.39"></a><span id="l1.39" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l1.40"></a><span id="l1.40" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l1.41"></a><span id="l1.41" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l1.42"></a><span id="l1.42" class="difflineplus">+# </span>
<a href="#l1.43"></a><span id="l1.43" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l1.44"></a><span id="l1.44"> </span>
<a href="#l1.45"></a><span id="l1.45"> import socket</span>
<a href="#l1.46"></a><span id="l1.46"> import os</span>
<a href="#l1.47"></a><span id="l1.47"> import copy</span>
<a href="#l1.48"></a><span id="l1.48"> import asyncore</span>
<a href="#l1.49"></a><span id="l1.49"> </span>
<a href="#l1.50"></a><span id="l1.50"> from time import sleep</span>
<a href="#l1.51"></a><span id="l1.51"> from network import Bridge, BackChannel, create_network</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/test/resources/jsbridge/jsbridge/extension/install.rdf</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/test/resources/jsbridge/jsbridge/extension/install.rdf</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1,61 +1,51 @@</span>
<a href="#l2.4"></a><span id="l2.4"> &lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l2.5"></a><span id="l2.5"> &lt;RDF xmlns=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span>
<a href="#l2.6"></a><span id="l2.6">      xmlns:em=&quot;http://www.mozilla.org/2004/em-rdf#&quot;&gt;</span>
<a href="#l2.7"></a><span id="l2.7">    &lt;Description about=&quot;urn:mozilla:install-manifest&quot;&gt;</span>
<a href="#l2.8"></a><span id="l2.8">      &lt;em:id&gt;jsbridge@mozilla.com&lt;/em:id&gt;</span>
<a href="#l2.9"></a><span id="l2.9">      &lt;em:name&gt;jsbridge&lt;/em:name&gt;</span>
<a href="#l2.10"></a><span id="l2.10" class="difflineminus">-     &lt;em:version&gt;2.4.6&lt;/em:version&gt;</span>
<a href="#l2.11"></a><span id="l2.11" class="difflineplus">+     &lt;em:version&gt;2.4.14&lt;/em:version&gt;</span>
<a href="#l2.12"></a><span id="l2.12">      &lt;em:creator&gt;Mikeal Rogers&lt;/em:creator&gt;</span>
<a href="#l2.13"></a><span id="l2.13">      &lt;em:description&gt;Python to JavaScript bridge&lt;/em:description&gt;</span>
<a href="#l2.14"></a><span id="l2.14">      &lt;em:unpack&gt;true&lt;/em:unpack&gt;</span>
<a href="#l2.15"></a><span id="l2.15">      &lt;em:targetApplication&gt;</span>
<a href="#l2.16"></a><span id="l2.16">        &lt;!-- Firefox --&gt;</span>
<a href="#l2.17"></a><span id="l2.17">        &lt;Description&gt;</span>
<a href="#l2.18"></a><span id="l2.18">          &lt;em:id&gt;{ec8030f7-c20a-464f-9b0e-13a3a9e97384}&lt;/em:id&gt;</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineminus">-         &lt;em:minVersion&gt;3.5&lt;/em:minVersion&gt;</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineminus">-         &lt;em:maxVersion&gt;15.*&lt;/em:maxVersion&gt;</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineplus">+         &lt;em:minVersion&gt;4.0&lt;/em:minVersion&gt;</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineplus">+         &lt;em:maxVersion&gt;20.*&lt;/em:maxVersion&gt;</span>
<a href="#l2.23"></a><span id="l2.23">        &lt;/Description&gt;</span>
<a href="#l2.24"></a><span id="l2.24">      &lt;/em:targetApplication&gt;</span>
<a href="#l2.25"></a><span id="l2.25">      &lt;em:targetApplication&gt;</span>
<a href="#l2.26"></a><span id="l2.26">        &lt;!-- Thunderbird --&gt;</span>
<a href="#l2.27"></a><span id="l2.27">        &lt;Description&gt;</span>
<a href="#l2.28"></a><span id="l2.28">          &lt;em:id&gt;{3550f703-e582-4d05-9a08-453d09bdfdc6}&lt;/em:id&gt;</span>
<a href="#l2.29"></a><span id="l2.29" class="difflineminus">-         &lt;em:minVersion&gt;3.0a1pre&lt;/em:minVersion&gt;</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineminus">-         &lt;em:maxVersion&gt;15.*&lt;/em:maxVersion&gt;</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineplus">+         &lt;em:minVersion&gt;5.0&lt;/em:minVersion&gt;</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+         &lt;em:maxVersion&gt;20.*&lt;/em:maxVersion&gt;</span>
<a href="#l2.33"></a><span id="l2.33">        &lt;/Description&gt;</span>
<a href="#l2.34"></a><span id="l2.34">      &lt;/em:targetApplication&gt;</span>
<a href="#l2.35"></a><span id="l2.35">      &lt;em:targetApplication&gt;</span>
<a href="#l2.36"></a><span id="l2.36">        &lt;!-- Sunbird --&gt;</span>
<a href="#l2.37"></a><span id="l2.37">        &lt;Description&gt;</span>
<a href="#l2.38"></a><span id="l2.38">          &lt;em:id&gt;{718e30fb-e89b-41dd-9da7-e25a45638b28}&lt;/em:id&gt;</span>
<a href="#l2.39"></a><span id="l2.39" class="difflineminus">-         &lt;em:minVersion&gt;1.0b1pre&lt;/em:minVersion&gt;</span>
<a href="#l2.40"></a><span id="l2.40" class="difflineminus">-         &lt;em:maxVersion&gt;1.0pre&lt;/em:maxVersion&gt;</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineplus">+         &lt;em:minVersion&gt;1.0b5&lt;/em:minVersion&gt;</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineplus">+         &lt;em:maxVersion&gt;1.6b1&lt;/em:maxVersion&gt;</span>
<a href="#l2.43"></a><span id="l2.43">        &lt;/Description&gt;</span>
<a href="#l2.44"></a><span id="l2.44">      &lt;/em:targetApplication&gt;</span>
<a href="#l2.45"></a><span id="l2.45">      &lt;em:targetApplication&gt;</span>
<a href="#l2.46"></a><span id="l2.46">        &lt;!-- SeaMonkey --&gt;</span>
<a href="#l2.47"></a><span id="l2.47">        &lt;Description&gt;</span>
<a href="#l2.48"></a><span id="l2.48">          &lt;em:id&gt;{92650c4d-4b8e-4d2a-b7eb-24ecf4f6b63a}&lt;/em:id&gt;</span>
<a href="#l2.49"></a><span id="l2.49" class="difflineminus">-         &lt;em:minVersion&gt;2.0a1&lt;/em:minVersion&gt;</span>
<a href="#l2.50"></a><span id="l2.50" class="difflineminus">-         &lt;em:maxVersion&gt;15.*&lt;/em:maxVersion&gt;</span>
<a href="#l2.51"></a><span id="l2.51" class="difflineplus">+         &lt;em:minVersion&gt;2.1&lt;/em:minVersion&gt;</span>
<a href="#l2.52"></a><span id="l2.52" class="difflineplus">+         &lt;em:maxVersion&gt;2.16&lt;/em:maxVersion&gt;</span>
<a href="#l2.53"></a><span id="l2.53">        &lt;/Description&gt;</span>
<a href="#l2.54"></a><span id="l2.54">      &lt;/em:targetApplication&gt;</span>
<a href="#l2.55"></a><span id="l2.55" class="difflineminus">-	   &lt;em:targetApplication&gt;</span>
<a href="#l2.56"></a><span id="l2.56" class="difflineminus">-	      &lt;!-- Songbird --&gt;</span>
<a href="#l2.57"></a><span id="l2.57" class="difflineminus">-	      &lt;Description&gt;</span>
<a href="#l2.58"></a><span id="l2.58" class="difflineminus">-	        &lt;em:id&gt;songbird@songbirdnest.com&lt;/em:id&gt;</span>
<a href="#l2.59"></a><span id="l2.59" class="difflineminus">-	        &lt;em:minVersion&gt;0.3pre&lt;/em:minVersion&gt;</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineminus">-	        &lt;em:maxVersion&gt;2.*&lt;/em:maxVersion&gt;</span>
<a href="#l2.61"></a><span id="l2.61" class="difflineminus">-	      &lt;/Description&gt;</span>
<a href="#l2.62"></a><span id="l2.62" class="difflineminus">-	   &lt;/em:targetApplication&gt;</span>
<a href="#l2.63"></a><span id="l2.63" class="difflineminus">-	   &lt;em:targetApplication&gt;</span>
<a href="#l2.64"></a><span id="l2.64" class="difflineplus">+     &lt;em:targetApplication&gt;</span>
<a href="#l2.65"></a><span id="l2.65">          &lt;Description&gt;</span>
<a href="#l2.66"></a><span id="l2.66">           &lt;em:id&gt;toolkit@mozilla.org&lt;/em:id&gt;</span>
<a href="#l2.67"></a><span id="l2.67" class="difflineminus">-          &lt;em:minVersion&gt;1.9.1&lt;/em:minVersion&gt;</span>
<a href="#l2.68"></a><span id="l2.68" class="difflineminus">-          &lt;em:maxVersion&gt;15.*&lt;/em:maxVersion&gt;</span>
<a href="#l2.69"></a><span id="l2.69" class="difflineplus">+          &lt;em:minVersion&gt;2.0&lt;/em:minVersion&gt;</span>
<a href="#l2.70"></a><span id="l2.70" class="difflineplus">+          &lt;em:maxVersion&gt;20.*&lt;/em:maxVersion&gt;</span>
<a href="#l2.71"></a><span id="l2.71">          &lt;/Description&gt;</span>
<a href="#l2.72"></a><span id="l2.72">      &lt;/em:targetApplication&gt;</span>
<a href="#l2.73"></a><span id="l2.73">    &lt;/Description&gt;</span>
<a href="#l2.74"></a><span id="l2.74" class="difflineminus">-</span>
<a href="#l2.75"></a><span id="l2.75" class="difflineminus">-</span>
<a href="#l2.76"></a><span id="l2.76"> &lt;/RDF&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/test/resources/jsbridge/jsbridge/jsobjects.py</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/test/resources/jsbridge/jsbridge/jsobjects.py</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1,11 +1,44 @@</span>
<a href="#l3.4"></a><span id="l3.4" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l3.5"></a><span id="l3.5" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l3.6"></a><span id="l3.6" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l3.7"></a><span id="l3.7" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l3.8"></a><span id="l3.8" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l3.9"></a><span id="l3.9" class="difflineplus">+#</span>
<a href="#l3.10"></a><span id="l3.10" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l3.11"></a><span id="l3.11" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+#</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineplus">+# License.</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineplus">+#</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineplus">+# The Original Code is Mozilla Corporation Code.</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineplus">+#</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineplus">+# The Initial Developer of the Original Code is</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineplus">+# Mikeal Rogers.</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2008</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineplus">+#</span>
<a href="#l3.27"></a><span id="l3.27" class="difflineplus">+# Contributor(s):</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineplus">+#  Mikeal Rogers &lt;mikeal.rogers@gmail.com&gt;</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineplus">+#</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l3.41"></a><span id="l3.41" class="difflineplus">+#</span>
<a href="#l3.42"></a><span id="l3.42" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l3.43"></a><span id="l3.43"> </span>
<a href="#l3.44"></a><span id="l3.44"> def init_jsobject(cls, bridge, name, value, description=None):</span>
<a href="#l3.45"></a><span id="l3.45">     &quot;&quot;&quot;Initialize a js object that is a subclassed base type; int, str, unicode, float.&quot;&quot;&quot;</span>
<a href="#l3.46"></a><span id="l3.46">     obj = cls(value)</span>
<a href="#l3.47"></a><span id="l3.47">     obj._bridge_ = bridge</span>
<a href="#l3.48"></a><span id="l3.48">     obj._name_ = name</span>
<a href="#l3.49"></a><span id="l3.49">     obj._description_ = description</span>
<a href="#l3.50"></a><span id="l3.50">     return obj</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/test/resources/jsbridge/jsbridge/network.py</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/test/resources/jsbridge/jsbridge/network.py</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -1,11 +1,44 @@</span>
<a href="#l4.4"></a><span id="l4.4" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l4.5"></a><span id="l4.5" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l4.6"></a><span id="l4.6" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l4.7"></a><span id="l4.7" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l4.8"></a><span id="l4.8" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l4.9"></a><span id="l4.9" class="difflineplus">+#</span>
<a href="#l4.10"></a><span id="l4.10" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l4.11"></a><span id="l4.11" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+#</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineplus">+# License.</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineplus">+#</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineplus">+# The Original Code is Mozilla Corporation Code.</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineplus">+#</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineplus">+# The Initial Developer of the Original Code is</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineplus">+# Mikeal Rogers.</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2008</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineplus">+#</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineplus">+# Contributor(s):</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineplus">+#  Mikeal Rogers &lt;mikeal.rogers@gmail.com&gt;</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineplus">+#</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineplus">+#</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l4.43"></a><span id="l4.43"> </span>
<a href="#l4.44"></a><span id="l4.44"> import asyncore</span>
<a href="#l4.45"></a><span id="l4.45"> import socket</span>
<a href="#l4.46"></a><span id="l4.46"> import select</span>
<a href="#l4.47"></a><span id="l4.47"> import logging</span>
<a href="#l4.48"></a><span id="l4.48"> import uuid</span>
<a href="#l4.49"></a><span id="l4.49"> from time import sleep</span>
<a href="#l4.50"></a><span id="l4.50"> from threading import Thread</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineat">@@ -45,21 +78,22 @@ class Telnet(asyncore.dispatcher):</span>
<a href="#l4.52"></a><span id="l4.52"> </span>
<a href="#l4.53"></a><span id="l4.53">     def handle_write(self):</span>
<a href="#l4.54"></a><span id="l4.54">         sent = self.send(self.buffer)</span>
<a href="#l4.55"></a><span id="l4.55">         self.buffer = self.buffer[sent:]</span>
<a href="#l4.56"></a><span id="l4.56">         </span>
<a href="#l4.57"></a><span id="l4.57">     def read_all(self):</span>
<a href="#l4.58"></a><span id="l4.58">         import socket</span>
<a href="#l4.59"></a><span id="l4.59">         data = ''</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineminus">-        while 1:</span>
<a href="#l4.61"></a><span id="l4.61" class="difflineplus">+        while self.connected:</span>
<a href="#l4.62"></a><span id="l4.62">             try:</span>
<a href="#l4.63"></a><span id="l4.63">                 data += self.recv(4096)</span>
<a href="#l4.64"></a><span id="l4.64">             except socket.error:</span>
<a href="#l4.65"></a><span id="l4.65" class="difflineminus">-                return data</span>
<a href="#l4.66"></a><span id="l4.66" class="difflineplus">+                break</span>
<a href="#l4.67"></a><span id="l4.67" class="difflineplus">+        return data</span>
<a href="#l4.68"></a><span id="l4.68"> </span>
<a href="#l4.69"></a><span id="l4.69">     def handle_read(self):</span>
<a href="#l4.70"></a><span id="l4.70">         self.data = self.read_all()</span>
<a href="#l4.71"></a><span id="l4.71">         self.process_read(self.data)</span>
<a href="#l4.72"></a><span id="l4.72"> </span>
<a href="#l4.73"></a><span id="l4.73">         </span>
<a href="#l4.74"></a><span id="l4.74">     read_callback = lambda self, data: None</span>
<a href="#l4.75"></a><span id="l4.75"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/test/resources/jsbridge/setup.py</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/test/resources/jsbridge/setup.py</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -1,22 +1,55 @@</span>
<a href="#l5.4"></a><span id="l5.4" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l5.5"></a><span id="l5.5" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l5.6"></a><span id="l5.6" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l5.7"></a><span id="l5.7" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l5.8"></a><span id="l5.8" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l5.9"></a><span id="l5.9" class="difflineplus">+#</span>
<a href="#l5.10"></a><span id="l5.10" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+#</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineplus">+# License.</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+#</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineplus">+# The Original Code is Mozilla Corporation Code.</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineplus">+#</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineplus">+# The Initial Developer of the Original Code is</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineplus">+# Mikeal Rogers.</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2008</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineplus">+#</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineplus">+# Contributor(s):</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineplus">+#  Mikeal Rogers &lt;mikeal.rogers@gmail.com&gt;</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineplus">+#</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+#</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l5.43"></a><span id="l5.43"> </span>
<a href="#l5.44"></a><span id="l5.44"> import sys</span>
<a href="#l5.45"></a><span id="l5.45"> from setuptools import setup, find_packages</span>
<a href="#l5.46"></a><span id="l5.46"> </span>
<a href="#l5.47"></a><span id="l5.47"> desc = &quot;&quot;&quot;Python to JavaScript bridge interface.&quot;&quot;&quot;</span>
<a href="#l5.48"></a><span id="l5.48"> summ = &quot;&quot;&quot;A powerful and extensible Python to JavaScript bridge interface.&quot;&quot;&quot;</span>
<a href="#l5.49"></a><span id="l5.49"> </span>
<a href="#l5.50"></a><span id="l5.50"> PACKAGE_NAME = &quot;jsbridge&quot;</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineminus">-PACKAGE_VERSION = &quot;2.4.6&quot;</span>
<a href="#l5.52"></a><span id="l5.52" class="difflineplus">+PACKAGE_VERSION = &quot;2.4.14&quot;</span>
<a href="#l5.53"></a><span id="l5.53"> </span>
<a href="#l5.54"></a><span id="l5.54" class="difflineminus">-requires = ['mozrunner == 2.5.7']</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineplus">+requires = ['mozrunner == 2.5.13']</span>
<a href="#l5.56"></a><span id="l5.56"> </span>
<a href="#l5.57"></a><span id="l5.57"> if not sys.version.startswith('2.6'):</span>
<a href="#l5.58"></a><span id="l5.58">     requires.append('simplejson')</span>
<a href="#l5.59"></a><span id="l5.59"> </span>
<a href="#l5.60"></a><span id="l5.60"> setup(name=PACKAGE_NAME,</span>
<a href="#l5.61"></a><span id="l5.61">       version=PACKAGE_VERSION,</span>
<a href="#l5.62"></a><span id="l5.62">       description=desc,</span>
<a href="#l5.63"></a><span id="l5.63">       long_description=summ,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/test/resources/mozmill/mozmill/__init__.py</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/test/resources/mozmill/mozmill/__init__.py</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -1,21 +1,54 @@</span>
<a href="#l6.4"></a><span id="l6.4" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.5"></a><span id="l6.5" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.6"></a><span id="l6.6" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l6.7"></a><span id="l6.7" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l6.8"></a><span id="l6.8" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l6.9"></a><span id="l6.9" class="difflineplus">+#</span>
<a href="#l6.10"></a><span id="l6.10" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+#</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+# License.</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineplus">+#</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineplus">+# The Original Code is Mozilla Corporation Code.</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineplus">+#</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineplus">+# The Initial Developer of the Original Code is</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineplus">+# Mikeal Rogers.</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2008</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineplus">+#</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineplus">+# Contributor(s):</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineplus">+#  Mikeal Rogers &lt;mikeal.rogers@gmail.com&gt;</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineplus">+#  Henrik Skupin &lt;hskupin@mozilla.com&gt;</span>
<a href="#l6.30"></a><span id="l6.30" class="difflineplus">+#  Clint Talbert &lt;ctalbert@mozilla.com&gt;</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineplus">+#</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l6.40"></a><span id="l6.40" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l6.41"></a><span id="l6.41" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l6.42"></a><span id="l6.42" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l6.43"></a><span id="l6.43" class="difflineplus">+#</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l6.45"></a><span id="l6.45"> </span>
<a href="#l6.46"></a><span id="l6.46"> import copy</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineminus">-import httplib</span>
<a href="#l6.48"></a><span id="l6.48"> import imp</span>
<a href="#l6.49"></a><span id="l6.49"> import os</span>
<a href="#l6.50"></a><span id="l6.50"> import socket</span>
<a href="#l6.51"></a><span id="l6.51"> import sys</span>
<a href="#l6.52"></a><span id="l6.52"> import traceback</span>
<a href="#l6.53"></a><span id="l6.53" class="difflineminus">-import urllib</span>
<a href="#l6.54"></a><span id="l6.54" class="difflineminus">-import urlparse</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineplus">+import urllib2</span>
<a href="#l6.56"></a><span id="l6.56"> </span>
<a href="#l6.57"></a><span id="l6.57"> from datetime import datetime, timedelta</span>
<a href="#l6.58"></a><span id="l6.58"> import manifestparser</span>
<a href="#l6.59"></a><span id="l6.59"> </span>
<a href="#l6.60"></a><span id="l6.60"> try:</span>
<a href="#l6.61"></a><span id="l6.61">     import json</span>
<a href="#l6.62"></a><span id="l6.62"> except:</span>
<a href="#l6.63"></a><span id="l6.63">     import simplejson as json</span>
<a href="#l6.64"></a><span id="l6.64" class="difflineat">@@ -412,37 +445,32 @@ class MozMill(object):</span>
<a href="#l6.65"></a><span id="l6.65">             return</span>
<a href="#l6.66"></a><span id="l6.66"> </span>
<a href="#l6.67"></a><span id="l6.67">         # report to CouchDB</span>
<a href="#l6.68"></a><span id="l6.68">         try:</span>
<a href="#l6.69"></a><span id="l6.69">             # Set the upload time of the report</span>
<a href="#l6.70"></a><span id="l6.70">             now = datetime.utcnow()</span>
<a href="#l6.71"></a><span id="l6.71">             results['time_upload'] = now.strftime(&quot;%Y-%m-%dT%H:%M:%SZ&quot;)</span>
<a href="#l6.72"></a><span id="l6.72"> </span>
<a href="#l6.73"></a><span id="l6.73" class="difflineminus">-            # Parse URL fragments and send data</span>
<a href="#l6.74"></a><span id="l6.74" class="difflineminus">-            url_fragments = urlparse.urlparse(report_url)</span>
<a href="#l6.75"></a><span id="l6.75" class="difflineminus">-            connection = httplib.HTTPConnection(url_fragments.netloc)</span>
<a href="#l6.76"></a><span id="l6.76" class="difflineminus">-            connection.request(&quot;POST&quot;, url_fragments.path, json.dumps(results),</span>
<a href="#l6.77"></a><span id="l6.77" class="difflineminus">-                               {&quot;Content-type&quot;: &quot;application/json&quot;})</span>
<a href="#l6.78"></a><span id="l6.78" class="difflineminus">-        </span>
<a href="#l6.79"></a><span id="l6.79" class="difflineplus">+            # Send a POST request to the DB; the POST is implied by the body data</span>
<a href="#l6.80"></a><span id="l6.80" class="difflineplus">+            body = json.dumps(results)</span>
<a href="#l6.81"></a><span id="l6.81" class="difflineplus">+            request = urllib2.Request(report_url, body, {&quot;Content-Type&quot;: &quot;application/json&quot;})</span>
<a href="#l6.82"></a><span id="l6.82" class="difflineplus">+</span>
<a href="#l6.83"></a><span id="l6.83">             # Get response which contains the id of the new document</span>
<a href="#l6.84"></a><span id="l6.84" class="difflineminus">-            response = connection.getresponse()</span>
<a href="#l6.85"></a><span id="l6.85" class="difflineplus">+            response = urllib2.urlopen(request)</span>
<a href="#l6.86"></a><span id="l6.86">             data = json.loads(response.read())</span>
<a href="#l6.87"></a><span id="l6.87" class="difflineminus">-            connection.close()</span>
<a href="#l6.88"></a><span id="l6.88" class="difflineminus">-</span>
<a href="#l6.89"></a><span id="l6.89" class="difflineminus">-            # Check if the report has been created</span>
<a href="#l6.90"></a><span id="l6.90" class="difflineminus">-            if not data['ok']:</span>
<a href="#l6.91"></a><span id="l6.91" class="difflineminus">-                print &quot;Creating report document failed (%s)&quot; % data</span>
<a href="#l6.92"></a><span id="l6.92" class="difflineminus">-                return data</span>
<a href="#l6.93"></a><span id="l6.93"> </span>
<a href="#l6.94"></a><span id="l6.94">             # Print document location to the console and return</span>
<a href="#l6.95"></a><span id="l6.95">             print &quot;Report document created at '%s%s'&quot; % (report_url, data['id'])</span>
<a href="#l6.96"></a><span id="l6.96">             return data</span>
<a href="#l6.97"></a><span id="l6.97" class="difflineminus">-        except Exception, e:</span>
<a href="#l6.98"></a><span id="l6.98" class="difflineminus">-            print &quot;Sending results to '%s' failed (%s).&quot; % (report_url, e)</span>
<a href="#l6.99"></a><span id="l6.99" class="difflineplus">+        except urllib2.HTTPError, e:</span>
<a href="#l6.100"></a><span id="l6.100" class="difflineplus">+            data = json.loads(e.read())</span>
<a href="#l6.101"></a><span id="l6.101" class="difflineplus">+            print &quot;Sending results to '%s' failed (%s).&quot; % (report_url, data['reason'])</span>
<a href="#l6.102"></a><span id="l6.102" class="difflineplus">+        except urllib2.URLError, e:</span>
<a href="#l6.103"></a><span id="l6.103" class="difflineplus">+            print &quot;Sending results to '%s' failed (%s).&quot; % (report_url, e.reason)</span>
<a href="#l6.104"></a><span id="l6.104"> </span>
<a href="#l6.105"></a><span id="l6.105">     def report(self, report_url):</span>
<a href="#l6.106"></a><span id="l6.106">         &quot;&quot;&quot;print statistics and send the JSON report&quot;&quot;&quot;</span>
<a href="#l6.107"></a><span id="l6.107">         self.printStats()</span>
<a href="#l6.108"></a><span id="l6.108"> </span>
<a href="#l6.109"></a><span id="l6.109">         if report_url:</span>
<a href="#l6.110"></a><span id="l6.110">             results = self.get_report()</span>
<a href="#l6.111"></a><span id="l6.111">             return self.send_report(results, report_url)</span>
<a href="#l6.112"></a><span id="l6.112" class="difflineat">@@ -701,34 +729,16 @@ class CLI(jsbridge.CLI):</span>
<a href="#l6.113"></a><span id="l6.113">         self.mozmill = self.mozmill_class(runner_class=mozrunner.FirefoxRunner,</span>
<a href="#l6.114"></a><span id="l6.114">                                           profile_class=mozrunner.FirefoxProfile,</span>
<a href="#l6.115"></a><span id="l6.115">                                           jsbridge_port=int(self.options.port),</span>
<a href="#l6.116"></a><span id="l6.116">                                           jsbridge_timeout=self.options.timeout,</span>
<a href="#l6.117"></a><span id="l6.117">                                           )</span>
<a href="#l6.118"></a><span id="l6.118"> </span>
<a href="#l6.119"></a><span id="l6.119">         self.tests = []</span>
<a href="#l6.120"></a><span id="l6.120"> </span>
<a href="#l6.121"></a><span id="l6.121" class="difflineminus">-        # read tests from manifests</span>
<a href="#l6.122"></a><span id="l6.122" class="difflineminus">-        if self.options.manifests:</span>
<a href="#l6.123"></a><span id="l6.123" class="difflineminus">-            manifest_parser = manifestparser.TestManifest(manifests=self.options.manifests)</span>
<a href="#l6.124"></a><span id="l6.124" class="difflineminus">-</span>
<a href="#l6.125"></a><span id="l6.125" class="difflineminus">-            self.tests.extend(manifest_parser.test_paths())</span>
<a href="#l6.126"></a><span id="l6.126" class="difflineminus">-</span>
<a href="#l6.127"></a><span id="l6.127" class="difflineminus">-        # expand user directory for individual tests</span>
<a href="#l6.128"></a><span id="l6.128" class="difflineminus">-        for test in self.options.test:</span>
<a href="#l6.129"></a><span id="l6.129" class="difflineminus">-            test = os.path.expanduser(test)</span>
<a href="#l6.130"></a><span id="l6.130" class="difflineminus">-            self.tests.append(test)</span>
<a href="#l6.131"></a><span id="l6.131" class="difflineminus">-                </span>
<a href="#l6.132"></a><span id="l6.132" class="difflineminus">-        # check existence for the tests</span>
<a href="#l6.133"></a><span id="l6.133" class="difflineminus">-        missing = [ test for test in self.tests</span>
<a href="#l6.134"></a><span id="l6.134" class="difflineminus">-                    if not os.path.exists(test) ]</span>
<a href="#l6.135"></a><span id="l6.135" class="difflineminus">-        if missing:</span>
<a href="#l6.136"></a><span id="l6.136" class="difflineminus">-            raise IOError(&quot;Not a valid test file/directory: %s&quot; % ', '.join([&quot;'%s'&quot; % test for test in missing]))</span>
<a href="#l6.137"></a><span id="l6.137" class="difflineminus">-</span>
<a href="#l6.138"></a><span id="l6.138" class="difflineminus">-</span>
<a href="#l6.139"></a><span id="l6.139">         # setup log formatting</span>
<a href="#l6.140"></a><span id="l6.140">         self.mozmill.add_global_listener(LoggerListener())</span>
<a href="#l6.141"></a><span id="l6.141">         log_options = { 'format': &quot;%(levelname)s | %(message)s&quot;,</span>
<a href="#l6.142"></a><span id="l6.142">                         'level': logging.CRITICAL }</span>
<a href="#l6.143"></a><span id="l6.143">         if self.options.showerrors:</span>
<a href="#l6.144"></a><span id="l6.144">             log_options['level'] = logging.ERROR</span>
<a href="#l6.145"></a><span id="l6.145">         if self.options.logfile:</span>
<a href="#l6.146"></a><span id="l6.146">             log_options['filename'] = self.options.logfile</span>
<a href="#l6.147"></a><span id="l6.147" class="difflineat">@@ -740,16 +750,33 @@ class CLI(jsbridge.CLI):</span>
<a href="#l6.148"></a><span id="l6.148"> </span>
<a href="#l6.149"></a><span id="l6.149">     def get_profile(self, *args, **kwargs):</span>
<a href="#l6.150"></a><span id="l6.150">         profile = jsbridge.CLI.get_profile(self, *args, **kwargs)</span>
<a href="#l6.151"></a><span id="l6.151">         profile.install_addon(extension_path)</span>
<a href="#l6.152"></a><span id="l6.152">         return profile</span>
<a href="#l6.153"></a><span id="l6.153"> </span>
<a href="#l6.154"></a><span id="l6.154">     def run(self):</span>
<a href="#l6.155"></a><span id="l6.155"> </span>
<a href="#l6.156"></a><span id="l6.156" class="difflineplus">+        # read tests from manifests</span>
<a href="#l6.157"></a><span id="l6.157" class="difflineplus">+        if self.options.manifests:</span>
<a href="#l6.158"></a><span id="l6.158" class="difflineplus">+            manifest_parser = manifestparser.TestManifest(manifests=self.options.manifests)</span>
<a href="#l6.159"></a><span id="l6.159" class="difflineplus">+</span>
<a href="#l6.160"></a><span id="l6.160" class="difflineplus">+            self.tests.extend(manifest_parser.test_paths())</span>
<a href="#l6.161"></a><span id="l6.161" class="difflineplus">+</span>
<a href="#l6.162"></a><span id="l6.162" class="difflineplus">+        # expand user directory for individual tests</span>
<a href="#l6.163"></a><span id="l6.163" class="difflineplus">+        for test in self.options.test:</span>
<a href="#l6.164"></a><span id="l6.164" class="difflineplus">+            test = os.path.expanduser(test)</span>
<a href="#l6.165"></a><span id="l6.165" class="difflineplus">+            self.tests.append(test)</span>
<a href="#l6.166"></a><span id="l6.166" class="difflineplus">+                </span>
<a href="#l6.167"></a><span id="l6.167" class="difflineplus">+        # check existence for the tests</span>
<a href="#l6.168"></a><span id="l6.168" class="difflineplus">+        missing = [ test for test in self.tests</span>
<a href="#l6.169"></a><span id="l6.169" class="difflineplus">+                    if not os.path.exists(test) ]</span>
<a href="#l6.170"></a><span id="l6.170" class="difflineplus">+        if missing:</span>
<a href="#l6.171"></a><span id="l6.171" class="difflineplus">+            raise IOError(&quot;Not a valid test file/directory: %s&quot; % ', '.join([&quot;'%s'&quot; % test for test in missing]))</span>
<a href="#l6.172"></a><span id="l6.172" class="difflineplus">+</span>
<a href="#l6.173"></a><span id="l6.173">         # create a Mozrunner</span>
<a href="#l6.174"></a><span id="l6.174">         runner = self.create_runner()</span>
<a href="#l6.175"></a><span id="l6.175"> </span>
<a href="#l6.176"></a><span id="l6.176">         runner.cmdargs.extend(self.options.appArgs)</span>
<a href="#l6.177"></a><span id="l6.177"> </span>
<a href="#l6.178"></a><span id="l6.178">         # make sure the application starts in the foreground</span>
<a href="#l6.179"></a><span id="l6.179">         if '-foreground' not in runner.cmdargs:</span>
<a href="#l6.180"></a><span id="l6.180">             runner.cmdargs.append('-foreground')</span>
<a href="#l6.181"></a><span id="l6.181" class="difflineat">@@ -802,21 +829,27 @@ class CLI(jsbridge.CLI):</span>
<a href="#l6.182"></a><span id="l6.182"> class RestartCLI(CLI):</span>
<a href="#l6.183"></a><span id="l6.183">     mozmill_class = MozMillRestart</span>
<a href="#l6.184"></a><span id="l6.184"> </span>
<a href="#l6.185"></a><span id="l6.185"> </span>
<a href="#l6.186"></a><span id="l6.186"> class ThunderbirdCLI(CLI):</span>
<a href="#l6.187"></a><span id="l6.187">     profile_class = mozrunner.ThunderbirdProfile</span>
<a href="#l6.188"></a><span id="l6.188">     runner_class = mozrunner.ThunderbirdRunner</span>
<a href="#l6.189"></a><span id="l6.189"> </span>
<a href="#l6.190"></a><span id="l6.190" class="difflineplus">+class ThunderbirdRestartCLI(RestartCLI):</span>
<a href="#l6.191"></a><span id="l6.191" class="difflineplus">+    profile_class = mozrunner.ThunderbirdProfile</span>
<a href="#l6.192"></a><span id="l6.192" class="difflineplus">+    runner_class = mozrunner.ThunderbirdRunner</span>
<a href="#l6.193"></a><span id="l6.193"> </span>
<a href="#l6.194"></a><span id="l6.194"> def enum(*sequential, **named):</span>
<a href="#l6.195"></a><span id="l6.195">     enums = dict(zip(sequential, range(len(sequential))), **named)</span>
<a href="#l6.196"></a><span id="l6.196">     return type('Enum', (), enums)</span>
<a href="#l6.197"></a><span id="l6.197"> </span>
<a href="#l6.198"></a><span id="l6.198"> def cli():</span>
<a href="#l6.199"></a><span id="l6.199">     CLI().run()</span>
<a href="#l6.200"></a><span id="l6.200"> </span>
<a href="#l6.201"></a><span id="l6.201"> def tbird_cli():</span>
<a href="#l6.202"></a><span id="l6.202">     ThunderbirdCLI().run()</span>
<a href="#l6.203"></a><span id="l6.203"> </span>
<a href="#l6.204"></a><span id="l6.204"> def restart_cli():</span>
<a href="#l6.205"></a><span id="l6.205">     RestartCLI().run()</span>
<a href="#l6.206"></a><span id="l6.206" class="difflineplus">+</span>
<a href="#l6.207"></a><span id="l6.207" class="difflineplus">+def tbird_restart_cli():</span>
<a href="#l6.208"></a><span id="l6.208" class="difflineplus">+    ThunderbirdRestartCLI().run()</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1">old mode 100644</span>
<a href="#l7.2"></a><span id="l7.2">new mode 100755</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1">old mode 100644</span>
<a href="#l8.2"></a><span id="l8.2">new mode 100755</span>
<a href="#l8.3"></a><span id="l8.3"></span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1">old mode 100644</span>
<a href="#l9.2"></a><span id="l9.2">new mode 100755</span>
<a href="#l9.3"></a><span id="l9.3"></span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1">old mode 100644</span>
<a href="#l10.2"></a><span id="l10.2">new mode 100755</span>
<a href="#l10.3"></a><span id="l10.3"></span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1">old mode 100644</span>
<a href="#l11.2"></a><span id="l11.2">new mode 100755</span>
<a href="#l11.3"></a><span id="l11.3"></span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1">old mode 100644</span>
<a href="#l12.2"></a><span id="l12.2">new mode 100755</span>
<a href="#l12.3"></a><span id="l12.3"></span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1">old mode 100644</span>
<a href="#l13.2"></a><span id="l13.2">new mode 100755</span>
<a href="#l13.3"></a><span id="l13.3"></span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1">old mode 100644</span>
<a href="#l14.2"></a><span id="l14.2">new mode 100755</span>
<a href="#l14.3"></a><span id="l14.3"></span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1">old mode 100644</span>
<a href="#l15.2"></a><span id="l15.2">new mode 100755</span>
<a href="#l15.3"></a><span id="l15.3"></span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1">old mode 100644</span>
<a href="#l16.2"></a><span id="l16.2">new mode 100755</span>
<a href="#l16.3"></a><span id="l16.3"></span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1">old mode 100644</span>
<a href="#l17.2"></a><span id="l17.2">new mode 100755</span>
<a href="#l17.3"></a><span id="l17.3"></span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1">old mode 100644</span>
<a href="#l18.2"></a><span id="l18.2">new mode 100755</span>
<a href="#l18.3"></a><span id="l18.3"></span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1">old mode 100644</span>
<a href="#l19.2"></a><span id="l19.2">new mode 100755</span>
<a href="#l19.3"></a><span id="l19.3"></span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1">old mode 100644</span>
<a href="#l20.2"></a><span id="l20.2">new mode 100755</span>
<a href="#l20.3"></a><span id="l20.3"></span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1">old mode 100644</span>
<a href="#l21.2"></a><span id="l21.2">new mode 100755</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1">old mode 100644</span>
<a href="#l22.2"></a><span id="l22.2">new mode 100755</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1">old mode 100644</span>
<a href="#l23.2"></a><span id="l23.2">new mode 100755</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1">old mode 100644</span>
<a href="#l24.2"></a><span id="l24.2">new mode 100755</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1">old mode 100644</span>
<a href="#l25.2"></a><span id="l25.2">new mode 100755</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineminus">--- a/mail/test/resources/mozmill/mozmill/extension/content/overlay.js</span>
<a href="#l25.4"></a><span id="l25.4" class="difflineplus">+++ b/mail/test/resources/mozmill/mozmill/extension/content/overlay.js</span>
<a href="#l25.5"></a><span id="l25.5" class="difflineat">@@ -1,11 +1,45 @@</span>
<a href="#l25.6"></a><span id="l25.6" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l25.7"></a><span id="l25.7" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l25.8"></a><span id="l25.8" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l25.9"></a><span id="l25.9" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l25.10"></a><span id="l25.10" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l25.11"></a><span id="l25.11" class="difflineplus">+ *</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l25.16"></a><span id="l25.16" class="difflineplus">+ *</span>
<a href="#l25.17"></a><span id="l25.17" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l25.18"></a><span id="l25.18" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l25.19"></a><span id="l25.19" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l25.20"></a><span id="l25.20" class="difflineplus">+ * License.</span>
<a href="#l25.21"></a><span id="l25.21" class="difflineplus">+ *</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineplus">+ * The Original Code is Mozilla Corporation Code.</span>
<a href="#l25.23"></a><span id="l25.23" class="difflineplus">+ *</span>
<a href="#l25.24"></a><span id="l25.24" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l25.25"></a><span id="l25.25" class="difflineplus">+ * Adam Christian.</span>
<a href="#l25.26"></a><span id="l25.26" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2008</span>
<a href="#l25.27"></a><span id="l25.27" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l25.28"></a><span id="l25.28" class="difflineplus">+ *</span>
<a href="#l25.29"></a><span id="l25.29" class="difflineplus">+ * Contributor(s):</span>
<a href="#l25.30"></a><span id="l25.30" class="difflineplus">+ *  Adam Christian &lt;adam.christian@gmail.com&gt;</span>
<a href="#l25.31"></a><span id="l25.31" class="difflineplus">+ *  Mikeal Rogers &lt;mikeal.rogers@gmail.com&gt;</span>
<a href="#l25.32"></a><span id="l25.32" class="difflineplus">+ *</span>
<a href="#l25.33"></a><span id="l25.33" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l25.34"></a><span id="l25.34" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l25.35"></a><span id="l25.35" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l25.36"></a><span id="l25.36" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l25.37"></a><span id="l25.37" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l25.38"></a><span id="l25.38" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l25.39"></a><span id="l25.39" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l25.40"></a><span id="l25.40" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l25.41"></a><span id="l25.41" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l25.42"></a><span id="l25.42" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l25.43"></a><span id="l25.43" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l25.44"></a><span id="l25.44" class="difflineplus">+ *</span>
<a href="#l25.45"></a><span id="l25.45" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l25.46"></a><span id="l25.46"> </span>
<a href="#l25.47"></a><span id="l25.47"> var mozmillInit = {}; Components.utils.import('resource://mozmill/modules/init.js', mozmillInit);</span>
<a href="#l25.48"></a><span id="l25.48"> </span>
<a href="#l25.49"></a><span id="l25.49"> var MozMill = {</span>
<a href="#l25.50"></a><span id="l25.50">   onLoad: function() {</span>
<a href="#l25.51"></a><span id="l25.51">     // initialization code</span>
<a href="#l25.52"></a><span id="l25.52">     this.initialized = true;</span>
<a href="#l25.53"></a><span id="l25.53">   },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1">old mode 100644</span>
<a href="#l26.2"></a><span id="l26.2">new mode 100755</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1">old mode 100644</span>
<a href="#l27.2"></a><span id="l27.2">new mode 100755</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineminus">--- a/mail/test/resources/mozmill/mozmill/extension/install.rdf</span>
<a href="#l27.4"></a><span id="l27.4" class="difflineplus">+++ b/mail/test/resources/mozmill/mozmill/extension/install.rdf</span>
<a href="#l27.5"></a><span id="l27.5" class="difflineat">@@ -1,59 +1,51 @@</span>
<a href="#l27.6"></a><span id="l27.6"> &lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l27.7"></a><span id="l27.7"> &lt;RDF xmlns=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span>
<a href="#l27.8"></a><span id="l27.8">      xmlns:em=&quot;http://www.mozilla.org/2004/em-rdf#&quot;&gt;</span>
<a href="#l27.9"></a><span id="l27.9">    &lt;Description about=&quot;urn:mozilla:install-manifest&quot;&gt;</span>
<a href="#l27.10"></a><span id="l27.10">      &lt;em:id&gt;mozmill@mozilla.com&lt;/em:id&gt;</span>
<a href="#l27.11"></a><span id="l27.11">      &lt;em:name&gt;MozMill&lt;/em:name&gt;</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-     &lt;em:version&gt;1.5.6&lt;/em:version&gt;</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+     &lt;em:version&gt;1.5.16&lt;/em:version&gt;</span>
<a href="#l27.14"></a><span id="l27.14">      &lt;em:creator&gt;Adam Christian&lt;/em:creator&gt;</span>
<a href="#l27.15"></a><span id="l27.15">      &lt;em:description&gt;A testing extension based on the Windmill Testing Framework client source&lt;/em:description&gt;</span>
<a href="#l27.16"></a><span id="l27.16">      &lt;em:unpack&gt;true&lt;/em:unpack&gt;</span>
<a href="#l27.17"></a><span id="l27.17">      &lt;em:targetApplication&gt;</span>
<a href="#l27.18"></a><span id="l27.18">        &lt;!-- Firefox --&gt;</span>
<a href="#l27.19"></a><span id="l27.19">        &lt;Description&gt;</span>
<a href="#l27.20"></a><span id="l27.20">          &lt;em:id&gt;{ec8030f7-c20a-464f-9b0e-13a3a9e97384}&lt;/em:id&gt;</span>
<a href="#l27.21"></a><span id="l27.21" class="difflineminus">-         &lt;em:minVersion&gt;3.5&lt;/em:minVersion&gt;</span>
<a href="#l27.22"></a><span id="l27.22" class="difflineminus">-         &lt;em:maxVersion&gt;15.*&lt;/em:maxVersion&gt;</span>
<a href="#l27.23"></a><span id="l27.23" class="difflineplus">+         &lt;em:minVersion&gt;4.0&lt;/em:minVersion&gt;</span>
<a href="#l27.24"></a><span id="l27.24" class="difflineplus">+         &lt;em:maxVersion&gt;20.*&lt;/em:maxVersion&gt;</span>
<a href="#l27.25"></a><span id="l27.25">        &lt;/Description&gt;</span>
<a href="#l27.26"></a><span id="l27.26">      &lt;/em:targetApplication&gt;</span>
<a href="#l27.27"></a><span id="l27.27">      &lt;em:targetApplication&gt;</span>
<a href="#l27.28"></a><span id="l27.28">        &lt;!-- Thunderbird --&gt;</span>
<a href="#l27.29"></a><span id="l27.29">        &lt;Description&gt;</span>
<a href="#l27.30"></a><span id="l27.30">          &lt;em:id&gt;{3550f703-e582-4d05-9a08-453d09bdfdc6}&lt;/em:id&gt;</span>
<a href="#l27.31"></a><span id="l27.31" class="difflineminus">-         &lt;em:minVersion&gt;3.0a1pre&lt;/em:minVersion&gt;</span>
<a href="#l27.32"></a><span id="l27.32" class="difflineminus">-         &lt;em:maxVersion&gt;15.*&lt;/em:maxVersion&gt;</span>
<a href="#l27.33"></a><span id="l27.33" class="difflineplus">+         &lt;em:minVersion&gt;5.0&lt;/em:minVersion&gt;</span>
<a href="#l27.34"></a><span id="l27.34" class="difflineplus">+         &lt;em:maxVersion&gt;20.*&lt;/em:maxVersion&gt;</span>
<a href="#l27.35"></a><span id="l27.35">        &lt;/Description&gt;</span>
<a href="#l27.36"></a><span id="l27.36">      &lt;/em:targetApplication&gt;</span>
<a href="#l27.37"></a><span id="l27.37">      &lt;em:targetApplication&gt;</span>
<a href="#l27.38"></a><span id="l27.38">        &lt;!-- Sunbird --&gt;</span>
<a href="#l27.39"></a><span id="l27.39">        &lt;Description&gt;</span>
<a href="#l27.40"></a><span id="l27.40">          &lt;em:id&gt;{718e30fb-e89b-41dd-9da7-e25a45638b28}&lt;/em:id&gt;</span>
<a href="#l27.41"></a><span id="l27.41" class="difflineminus">-         &lt;em:minVersion&gt;0.6a1&lt;/em:minVersion&gt;</span>
<a href="#l27.42"></a><span id="l27.42" class="difflineminus">-         &lt;em:maxVersion&gt;1.0pre&lt;/em:maxVersion&gt;</span>
<a href="#l27.43"></a><span id="l27.43" class="difflineplus">+         &lt;em:minVersion&gt;1.0b5&lt;/em:minVersion&gt;</span>
<a href="#l27.44"></a><span id="l27.44" class="difflineplus">+         &lt;em:maxVersion&gt;1.6b1&lt;/em:maxVersion&gt;</span>
<a href="#l27.45"></a><span id="l27.45">        &lt;/Description&gt;</span>
<a href="#l27.46"></a><span id="l27.46">      &lt;/em:targetApplication&gt;</span>
<a href="#l27.47"></a><span id="l27.47">      &lt;em:targetApplication&gt;</span>
<a href="#l27.48"></a><span id="l27.48">        &lt;!-- SeaMonkey --&gt;</span>
<a href="#l27.49"></a><span id="l27.49">        &lt;Description&gt;</span>
<a href="#l27.50"></a><span id="l27.50">          &lt;em:id&gt;{92650c4d-4b8e-4d2a-b7eb-24ecf4f6b63a}&lt;/em:id&gt;</span>
<a href="#l27.51"></a><span id="l27.51" class="difflineminus">-         &lt;em:minVersion&gt;2.0a1&lt;/em:minVersion&gt;</span>
<a href="#l27.52"></a><span id="l27.52" class="difflineminus">-         &lt;em:maxVersion&gt;15.*&lt;/em:maxVersion&gt;</span>
<a href="#l27.53"></a><span id="l27.53" class="difflineplus">+         &lt;em:minVersion&gt;2.1&lt;/em:minVersion&gt;</span>
<a href="#l27.54"></a><span id="l27.54" class="difflineplus">+         &lt;em:maxVersion&gt;2.16&lt;/em:maxVersion&gt;</span>
<a href="#l27.55"></a><span id="l27.55">        &lt;/Description&gt;</span>
<a href="#l27.56"></a><span id="l27.56">      &lt;/em:targetApplication&gt;</span>
<a href="#l27.57"></a><span id="l27.57" class="difflineminus">-	   &lt;em:targetApplication&gt;</span>
<a href="#l27.58"></a><span id="l27.58" class="difflineminus">-	      &lt;!-- Songbird --&gt;</span>
<a href="#l27.59"></a><span id="l27.59" class="difflineminus">-	      &lt;Description&gt;</span>
<a href="#l27.60"></a><span id="l27.60" class="difflineminus">-	        &lt;em:id&gt;songbird@songbirdnest.com&lt;/em:id&gt;</span>
<a href="#l27.61"></a><span id="l27.61" class="difflineminus">-	        &lt;em:minVersion&gt;0.3pre&lt;/em:minVersion&gt;</span>
<a href="#l27.62"></a><span id="l27.62" class="difflineminus">-	        &lt;em:maxVersion&gt;2.*&lt;/em:maxVersion&gt;</span>
<a href="#l27.63"></a><span id="l27.63" class="difflineminus">-	      &lt;/Description&gt;</span>
<a href="#l27.64"></a><span id="l27.64" class="difflineminus">-	   &lt;/em:targetApplication&gt;</span>
<a href="#l27.65"></a><span id="l27.65" class="difflineminus">-	   &lt;em:targetApplication&gt;</span>
<a href="#l27.66"></a><span id="l27.66" class="difflineplus">+     &lt;em:targetApplication&gt;</span>
<a href="#l27.67"></a><span id="l27.67">          &lt;Description&gt;</span>
<a href="#l27.68"></a><span id="l27.68">           &lt;em:id&gt;toolkit@mozilla.org&lt;/em:id&gt;</span>
<a href="#l27.69"></a><span id="l27.69" class="difflineminus">-          &lt;em:minVersion&gt;1.9.1&lt;/em:minVersion&gt;</span>
<a href="#l27.70"></a><span id="l27.70" class="difflineminus">-          &lt;em:maxVersion&gt;15.*&lt;/em:maxVersion&gt;</span>
<a href="#l27.71"></a><span id="l27.71" class="difflineplus">+          &lt;em:minVersion&gt;2.0&lt;/em:minVersion&gt;</span>
<a href="#l27.72"></a><span id="l27.72" class="difflineplus">+          &lt;em:maxVersion&gt;20.*&lt;/em:maxVersion&gt;</span>
<a href="#l27.73"></a><span id="l27.73">          &lt;/Description&gt;</span>
<a href="#l27.74"></a><span id="l27.74">      &lt;/em:targetApplication&gt;</span>
<a href="#l27.75"></a><span id="l27.75">    &lt;/Description&gt;</span>
<a href="#l27.76"></a><span id="l27.76"> &lt;/RDF&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1">old mode 100644</span>
<a href="#l28.2"></a><span id="l28.2">new mode 100755</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1">old mode 100644</span>
<a href="#l29.2"></a><span id="l29.2">new mode 100755</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1">old mode 100644</span>
<a href="#l30.2"></a><span id="l30.2">new mode 100755</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/mail/test/resources/mozmill/mozmill/extension/resource/modules/frame.js</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/mail/test/resources/mozmill/mozmill/extension/resource/modules/frame.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -34,17 +34,18 @@</span>
<a href="#l31.4"></a><span id="l31.4"> // the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l31.5"></a><span id="l31.5"> // </span>
<a href="#l31.6"></a><span id="l31.6"> // ***** END LICENSE BLOCK *****</span>
<a href="#l31.7"></a><span id="l31.7"> </span>
<a href="#l31.8"></a><span id="l31.8"> var EXPORTED_SYMBOLS = ['loadFile','register_function','Collector','Runner','events', </span>
<a href="#l31.9"></a><span id="l31.9">                         'jsbridge', 'runTestDirectory', 'runTestFile', 'log', 'getThread',</span>
<a href="#l31.10"></a><span id="l31.10">                         'timers', 'persisted'];</span>
<a href="#l31.11"></a><span id="l31.11"> </span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-var httpd = {};   Components.utils.import('resource://mozmill/stdlib/httpd.js', httpd);</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+Components.utils.import('resource://mozmill/stdlib/httpd.js');</span>
<a href="#l31.14"></a><span id="l31.14" class="difflineplus">+</span>
<a href="#l31.15"></a><span id="l31.15"> var os = {};      Components.utils.import('resource://mozmill/stdlib/os.js', os);</span>
<a href="#l31.16"></a><span id="l31.16"> var strings = {}; Components.utils.import('resource://mozmill/stdlib/strings.js', strings);</span>
<a href="#l31.17"></a><span id="l31.17"> var arrays = {};  Components.utils.import('resource://mozmill/stdlib/arrays.js', arrays);</span>
<a href="#l31.18"></a><span id="l31.18"> var withs = {};   Components.utils.import('resource://mozmill/stdlib/withs.js', withs);</span>
<a href="#l31.19"></a><span id="l31.19"> var utils = {};   Components.utils.import('resource://mozmill/modules/utils.js', utils);</span>
<a href="#l31.20"></a><span id="l31.20"> var securableModule = {};</span>
<a href="#l31.21"></a><span id="l31.21">   Components.utils.import('resource://mozmill/stdlib/securable-module.js', securableModule);</span>
<a href="#l31.22"></a><span id="l31.22"> </span>
<a href="#l31.23"></a><span id="l31.23" class="difflineat">@@ -64,17 +65,18 @@ var registeredFunctions = {};</span>
<a href="#l31.24"></a><span id="l31.24"> var persisted = {};</span>
<a href="#l31.25"></a><span id="l31.25"> </span>
<a href="#l31.26"></a><span id="l31.26"> arrayRemove = function(array, from, to) {</span>
<a href="#l31.27"></a><span id="l31.27">   var rest = array.slice((to || from) + 1 || array.length);</span>
<a href="#l31.28"></a><span id="l31.28">   array.length = from &lt; 0 ? array.length + from : from;</span>
<a href="#l31.29"></a><span id="l31.29">   return array.push.apply(array, rest);</span>
<a href="#l31.30"></a><span id="l31.30"> };</span>
<a href="#l31.31"></a><span id="l31.31"> </span>
<a href="#l31.32"></a><span id="l31.32" class="difflineminus">-mozmill = undefined; elementslib = undefined;</span>
<a href="#l31.33"></a><span id="l31.33" class="difflineplus">+mozmill = undefined; elementslib = undefined; modules = undefined;</span>
<a href="#l31.34"></a><span id="l31.34" class="difflineplus">+</span>
<a href="#l31.35"></a><span id="l31.35"> var loadTestResources = function () {</span>
<a href="#l31.36"></a><span id="l31.36">   if (mozmill == undefined) {</span>
<a href="#l31.37"></a><span id="l31.37">     mozmill = {};</span>
<a href="#l31.38"></a><span id="l31.38">     Components.utils.import(&quot;resource://mozmill/modules/mozmill.js&quot;, mozmill);</span>
<a href="#l31.39"></a><span id="l31.39">   }</span>
<a href="#l31.40"></a><span id="l31.40">   if (elementslib == undefined) {</span>
<a href="#l31.41"></a><span id="l31.41">     elementslib = {};</span>
<a href="#l31.42"></a><span id="l31.42">     Components.utils.import(&quot;resource://mozmill/modules/elementslib.js&quot;, elementslib);</span>
<a href="#l31.43"></a><span id="l31.43" class="difflineat">@@ -103,17 +105,22 @@ var loadFile = function(path, collector)</span>
<a href="#l31.44"></a><span id="l31.44">       defaultPrincipal: &quot;system&quot;,</span>
<a href="#l31.45"></a><span id="l31.45">       globals : { mozmill: mozmill,</span>
<a href="#l31.46"></a><span id="l31.46">                   elementslib: elementslib,</span>
<a href="#l31.47"></a><span id="l31.47">                   persisted: persisted,</span>
<a href="#l31.48"></a><span id="l31.48">                   Cc: Components.classes,</span>
<a href="#l31.49"></a><span id="l31.49">                   Ci: Components.interfaces,</span>
<a href="#l31.50"></a><span id="l31.50">                   Cu: Components.utils }</span>
<a href="#l31.51"></a><span id="l31.51">     });</span>
<a href="#l31.52"></a><span id="l31.52" class="difflineminus">-    return loader.require(mod);</span>
<a href="#l31.53"></a><span id="l31.53" class="difflineplus">+    if (modules != undefined) {</span>
<a href="#l31.54"></a><span id="l31.54" class="difflineplus">+        loader.modules = modules;</span>
<a href="#l31.55"></a><span id="l31.55" class="difflineplus">+    }</span>
<a href="#l31.56"></a><span id="l31.56" class="difflineplus">+    var retval = loader.require(mod);</span>
<a href="#l31.57"></a><span id="l31.57" class="difflineplus">+    modules = loader.modules;</span>
<a href="#l31.58"></a><span id="l31.58" class="difflineplus">+    return retval;</span>
<a href="#l31.59"></a><span id="l31.59">   }</span>
<a href="#l31.60"></a><span id="l31.60">   </span>
<a href="#l31.61"></a><span id="l31.61">   if (collector != undefined) {</span>
<a href="#l31.62"></a><span id="l31.62">     collector.current_file = file;</span>
<a href="#l31.63"></a><span id="l31.63">     collector.current_path = path;</span>
<a href="#l31.64"></a><span id="l31.64">   }</span>
<a href="#l31.65"></a><span id="l31.65">   try {</span>
<a href="#l31.66"></a><span id="l31.66">     loader.loadSubScript(uri, module, &quot;UTF-8&quot;);</span>
<a href="#l31.67"></a><span id="l31.67" class="difflineat">@@ -318,18 +325,16 @@ try {</span>
<a href="#l31.68"></a><span id="l31.68"> </span>
<a href="#l31.69"></a><span id="l31.69">   aConsoleService.logStringMessage(&quot;jsbridge not available.&quot;);</span>
<a href="#l31.70"></a><span id="l31.70"> }</span>
<a href="#l31.71"></a><span id="l31.71"> </span>
<a href="#l31.72"></a><span id="l31.72"> if (jsbridge) {</span>
<a href="#l31.73"></a><span id="l31.73">   events.addListener('', function (name, obj) {jsbridge.fireEvent('mozmill.'+name, obj)} );</span>
<a href="#l31.74"></a><span id="l31.74"> }</span>
<a href="#l31.75"></a><span id="l31.75"> </span>
<a href="#l31.76"></a><span id="l31.76" class="difflineminus">-var http_server = httpd.getServer(43336);</span>
<a href="#l31.77"></a><span id="l31.77" class="difflineminus">-</span>
<a href="#l31.78"></a><span id="l31.78"> function Collector () {</span>
<a href="#l31.79"></a><span id="l31.79">   this.test_modules_by_filename = {};</span>
<a href="#l31.80"></a><span id="l31.80">   this.test_modules_by_name = {};</span>
<a href="#l31.81"></a><span id="l31.81">   this.requirements_run = {};</span>
<a href="#l31.82"></a><span id="l31.82">   this.all_requirements = [];</span>
<a href="#l31.83"></a><span id="l31.83">   this.loaded_directories = [];</span>
<a href="#l31.84"></a><span id="l31.84">   this.testing = [];</span>
<a href="#l31.85"></a><span id="l31.85">   this.httpd_started = false;</span>
<a href="#l31.86"></a><span id="l31.86" class="difflineat">@@ -337,35 +342,55 @@ function Collector () {</span>
<a href="#l31.87"></a><span id="l31.87">   // var logging = {}; Components.utils.import('resource://mozmill/stdlib/logging.js', logging);</span>
<a href="#l31.88"></a><span id="l31.88">   // this.logger = new logging.Logger('Collector');</span>
<a href="#l31.89"></a><span id="l31.89"> }</span>
<a href="#l31.90"></a><span id="l31.90"> </span>
<a href="#l31.91"></a><span id="l31.91"> Collector.prototype.getModule = function (name) {</span>
<a href="#l31.92"></a><span id="l31.92">   return this.test_modules_by_name[name];</span>
<a href="#l31.93"></a><span id="l31.93"> }</span>
<a href="#l31.94"></a><span id="l31.94"> </span>
<a href="#l31.95"></a><span id="l31.95" class="difflineplus">+Collector.prototype.getServer = function (port, basePath) {</span>
<a href="#l31.96"></a><span id="l31.96" class="difflineplus">+  if (basePath) {</span>
<a href="#l31.97"></a><span id="l31.97" class="difflineplus">+    var lp = Cc[&quot;@mozilla.org/file/local;1&quot;]</span>
<a href="#l31.98"></a><span id="l31.98" class="difflineplus">+             .createInstance(Ci.nsILocalFile);</span>
<a href="#l31.99"></a><span id="l31.99" class="difflineplus">+    lp.initWithPath(basePath);</span>
<a href="#l31.100"></a><span id="l31.100" class="difflineplus">+  }</span>
<a href="#l31.101"></a><span id="l31.101" class="difflineplus">+</span>
<a href="#l31.102"></a><span id="l31.102" class="difflineplus">+  var srv = new HttpServer();</span>
<a href="#l31.103"></a><span id="l31.103" class="difflineplus">+  if (lp) {</span>
<a href="#l31.104"></a><span id="l31.104" class="difflineplus">+    srv.registerDirectory(&quot;/&quot;, lp);</span>
<a href="#l31.105"></a><span id="l31.105" class="difflineplus">+  }</span>
<a href="#l31.106"></a><span id="l31.106" class="difflineplus">+</span>
<a href="#l31.107"></a><span id="l31.107" class="difflineplus">+  srv.registerContentType(&quot;sjs&quot;, &quot;sjs&quot;);</span>
<a href="#l31.108"></a><span id="l31.108" class="difflineplus">+  srv.identity.setPrimary(&quot;http&quot;, &quot;localhost&quot;, port);</span>
<a href="#l31.109"></a><span id="l31.109" class="difflineplus">+  srv._port = port;</span>
<a href="#l31.110"></a><span id="l31.110" class="difflineplus">+</span>
<a href="#l31.111"></a><span id="l31.111" class="difflineplus">+  return srv;</span>
<a href="#l31.112"></a><span id="l31.112" class="difflineplus">+}</span>
<a href="#l31.113"></a><span id="l31.113" class="difflineplus">+</span>
<a href="#l31.114"></a><span id="l31.114"> Collector.prototype.startHttpd = function () {</span>
<a href="#l31.115"></a><span id="l31.115">   while (this.httpd == undefined) {</span>
<a href="#l31.116"></a><span id="l31.116">     try {</span>
<a href="#l31.117"></a><span id="l31.117" class="difflineplus">+      var http_server = this.getServer(this.http_port);</span>
<a href="#l31.118"></a><span id="l31.118">       http_server.start(this.http_port);</span>
<a href="#l31.119"></a><span id="l31.119">       this.httpd = http_server;</span>
<a href="#l31.120"></a><span id="l31.120" class="difflineminus">-    } catch(e) { // Failure most likely due to port conflict</span>
<a href="#l31.121"></a><span id="l31.121" class="difflineplus">+    } catch (e) {</span>
<a href="#l31.122"></a><span id="l31.122" class="difflineplus">+      // Failure most likely due to port conflict</span>
<a href="#l31.123"></a><span id="l31.123">       this.http_port++;</span>
<a href="#l31.124"></a><span id="l31.124" class="difflineminus">-      http_server = httpd.getServer(this.http_port);</span>
<a href="#l31.125"></a><span id="l31.125" class="difflineminus">-    }; </span>
<a href="#l31.126"></a><span id="l31.126" class="difflineminus">-    </span>
<a href="#l31.127"></a><span id="l31.127" class="difflineminus">-    </span>
<a href="#l31.128"></a><span id="l31.128" class="difflineplus">+    }</span>
<a href="#l31.129"></a><span id="l31.129">   }</span>
<a href="#l31.130"></a><span id="l31.130"> }</span>
<a href="#l31.131"></a><span id="l31.131" class="difflineplus">+</span>
<a href="#l31.132"></a><span id="l31.132"> Collector.prototype.stopHttpd = function () {</span>
<a href="#l31.133"></a><span id="l31.133">   if (this.httpd) {</span>
<a href="#l31.134"></a><span id="l31.134">     this.httpd.stop(function(){});  // Callback needed to pause execution until the server has been properly shutdown</span>
<a href="#l31.135"></a><span id="l31.135">     this.httpd = null;</span>
<a href="#l31.136"></a><span id="l31.136">   }</span>
<a href="#l31.137"></a><span id="l31.137"> }</span>
<a href="#l31.138"></a><span id="l31.138" class="difflineplus">+</span>
<a href="#l31.139"></a><span id="l31.139"> Collector.prototype.addHttpResource = function (directory, ns) {</span>
<a href="#l31.140"></a><span id="l31.140">   if (!this.httpd) {</span>
<a href="#l31.141"></a><span id="l31.141">     this.startHttpd();</span>
<a href="#l31.142"></a><span id="l31.142">   }</span>
<a href="#l31.143"></a><span id="l31.143"> </span>
<a href="#l31.144"></a><span id="l31.144">   if (!ns) {</span>
<a href="#l31.145"></a><span id="l31.145">     ns = '/';</span>
<a href="#l31.146"></a><span id="l31.146">   } else {</span>
<a href="#l31.147"></a><span id="l31.147" class="difflineat">@@ -585,30 +610,31 @@ Runner.prototype._runTestModule = functi</span>
<a href="#l31.148"></a><span id="l31.148">       module[req] = this.collector.getModule(req);</span>
<a href="#l31.149"></a><span id="l31.149">     }</span>
<a href="#l31.150"></a><span id="l31.150">   }</span>
<a href="#l31.151"></a><span id="l31.151"> </span>
<a href="#l31.152"></a><span id="l31.152">   var attrs = [];</span>
<a href="#l31.153"></a><span id="l31.153">   for (var i in module) {</span>
<a href="#l31.154"></a><span id="l31.154">     attrs.push(i);</span>
<a href="#l31.155"></a><span id="l31.155">   }</span>
<a href="#l31.156"></a><span id="l31.156" class="difflineminus">-  </span>
<a href="#l31.157"></a><span id="l31.157" class="difflineplus">+</span>
<a href="#l31.158"></a><span id="l31.158">   events.setModule(module);</span>
<a href="#l31.159"></a><span id="l31.159" class="difflineplus">+  var observer = new AppQuitObserver();</span>
<a href="#l31.160"></a><span id="l31.160" class="difflineplus">+</span>
<a href="#l31.161"></a><span id="l31.161">   module.__status__ = 'running';</span>
<a href="#l31.162"></a><span id="l31.162">   if (module.__setupModule__) { </span>
<a href="#l31.163"></a><span id="l31.163">     events.setState('setupModule');</span>
<a href="#l31.164"></a><span id="l31.164">     events.setTest(module.__setupModule__);</span>
<a href="#l31.165"></a><span id="l31.165">     this.wrapper(module.__setupModule__, module); </span>
<a href="#l31.166"></a><span id="l31.166">     var setupModulePassed = (events.currentTest.__fails__.length == 0 &amp;&amp; !events.currentTest.skipped);</span>
<a href="#l31.167"></a><span id="l31.167">     events.endTest(module.__setupModule__);</span>
<a href="#l31.168"></a><span id="l31.168">   } else {</span>
<a href="#l31.169"></a><span id="l31.169">     var setupModulePassed = true;</span>
<a href="#l31.170"></a><span id="l31.170">   }</span>
<a href="#l31.171"></a><span id="l31.171">   if (setupModulePassed) {</span>
<a href="#l31.172"></a><span id="l31.172" class="difflineminus">-    var observer = new AppQuitObserver();</span>
<a href="#l31.173"></a><span id="l31.173">     for (var i in module.__tests__) {</span>
<a href="#l31.174"></a><span id="l31.174">       events.appQuit = false;</span>
<a href="#l31.175"></a><span id="l31.175">       var test = module.__tests__[i];</span>
<a href="#l31.176"></a><span id="l31.176">       </span>
<a href="#l31.177"></a><span id="l31.177">       // TODO: introduce per-test timeout:</span>
<a href="#l31.178"></a><span id="l31.178">       // https://bugzilla.mozilla.org/show_bug.cgi?id=574871</span>
<a href="#l31.179"></a><span id="l31.179"> </span>
<a href="#l31.180"></a><span id="l31.180">       if (module.__setupTest__) { </span>
<a href="#l31.181"></a><span id="l31.181" class="difflineat">@@ -630,32 +656,35 @@ Runner.prototype._runTestModule = functi</span>
<a href="#l31.182"></a><span id="l31.182">       if (module.__teardownTest__) {</span>
<a href="#l31.183"></a><span id="l31.183">         events.setState('teardownTest'); </span>
<a href="#l31.184"></a><span id="l31.184">         events.setTest(module.__teardownTest__);</span>
<a href="#l31.185"></a><span id="l31.185">         this.wrapper(module.__teardownTest__, test); </span>
<a href="#l31.186"></a><span id="l31.186">         events.endTest(module.__teardownTest__);</span>
<a href="#l31.187"></a><span id="l31.187">       }</span>
<a href="#l31.188"></a><span id="l31.188">       events.endTest(test)</span>
<a href="#l31.189"></a><span id="l31.189">     }</span>
<a href="#l31.190"></a><span id="l31.190" class="difflineminus">-    observer.unregister();</span>
<a href="#l31.191"></a><span id="l31.191">   } else {</span>
<a href="#l31.192"></a><span id="l31.192">     for each(var test in module.__tests__) {</span>
<a href="#l31.193"></a><span id="l31.193">       events.setTest(test);</span>
<a href="#l31.194"></a><span id="l31.194">       events.skip(&quot;setupModule failed.&quot;);</span>
<a href="#l31.195"></a><span id="l31.195">       events.endTest(test);</span>
<a href="#l31.196"></a><span id="l31.196">     }</span>
<a href="#l31.197"></a><span id="l31.197">   }</span>
<a href="#l31.198"></a><span id="l31.198">   if (module.__teardownModule__) {</span>
<a href="#l31.199"></a><span id="l31.199">     events.setState('teardownModule');</span>
<a href="#l31.200"></a><span id="l31.200">     events.setTest(module.__teardownModule__);</span>
<a href="#l31.201"></a><span id="l31.201">     this.wrapper(module.__teardownModule__, module);</span>
<a href="#l31.202"></a><span id="l31.202">     events.endTest(module.__teardownModule__);</span>
<a href="#l31.203"></a><span id="l31.203">   }</span>
<a href="#l31.204"></a><span id="l31.204" class="difflineplus">+</span>
<a href="#l31.205"></a><span id="l31.205" class="difflineplus">+  observer.unregister();</span>
<a href="#l31.206"></a><span id="l31.206" class="difflineplus">+</span>
<a href="#l31.207"></a><span id="l31.207">   module.__status__ = 'done';</span>
<a href="#l31.208"></a><span id="l31.208"> }</span>
<a href="#l31.209"></a><span id="l31.209" class="difflineplus">+</span>
<a href="#l31.210"></a><span id="l31.210"> Runner.prototype.runTestModule = function (module) {</span>
<a href="#l31.211"></a><span id="l31.211">   if (module.__requirements__ != undefined &amp;&amp; module.__force_skip__ == undefined) {</span>
<a href="#l31.212"></a><span id="l31.212">     if (!arrays.inArray(this.collector.loaded_directories, module.__root_path__)) {</span>
<a href="#l31.213"></a><span id="l31.213">       if (module.__root_path__ != undefined) {</span>
<a href="#l31.214"></a><span id="l31.214">         this.collector.initTestDirectory(module.__root_path__);</span>
<a href="#l31.215"></a><span id="l31.215">       }</span>
<a href="#l31.216"></a><span id="l31.216">     }</span>
<a href="#l31.217"></a><span id="l31.217">     var deps = this.getDependencies(module);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/mail/test/resources/mozmill/mozmill/extension/resource/modules/init.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/mail/test/resources/mozmill/mozmill/extension/resource/modules/init.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -1,11 +1,46 @@</span>
<a href="#l32.4"></a><span id="l32.4" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l32.5"></a><span id="l32.5" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l32.6"></a><span id="l32.6" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l32.7"></a><span id="l32.7" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l32.8"></a><span id="l32.8" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l32.9"></a><span id="l32.9" class="difflineplus">+ * </span>
<a href="#l32.10"></a><span id="l32.10" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l32.11"></a><span id="l32.11" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l32.14"></a><span id="l32.14" class="difflineplus">+ * </span>
<a href="#l32.15"></a><span id="l32.15" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l32.16"></a><span id="l32.16" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l32.17"></a><span id="l32.17" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l32.18"></a><span id="l32.18" class="difflineplus">+ * License.</span>
<a href="#l32.19"></a><span id="l32.19" class="difflineplus">+ * </span>
<a href="#l32.20"></a><span id="l32.20" class="difflineplus">+ * The Original Code is Mozilla Corporation Code.</span>
<a href="#l32.21"></a><span id="l32.21" class="difflineplus">+ * </span>
<a href="#l32.22"></a><span id="l32.22" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l32.23"></a><span id="l32.23" class="difflineplus">+ * Adam Christian.</span>
<a href="#l32.24"></a><span id="l32.24" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2008</span>
<a href="#l32.25"></a><span id="l32.25" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l32.26"></a><span id="l32.26" class="difflineplus">+ * </span>
<a href="#l32.27"></a><span id="l32.27" class="difflineplus">+ * Contributor(s):</span>
<a href="#l32.28"></a><span id="l32.28" class="difflineplus">+ *  Adam Christian &lt;adam.christian@gmail.com&gt;</span>
<a href="#l32.29"></a><span id="l32.29" class="difflineplus">+ *  Mikeal Rogers &lt;mikeal.rogers@gmail.com&gt;</span>
<a href="#l32.30"></a><span id="l32.30" class="difflineplus">+ *  Henrik Skupin &lt;hskupin@mozilla.com&gt;</span>
<a href="#l32.31"></a><span id="l32.31" class="difflineplus">+ * </span>
<a href="#l32.32"></a><span id="l32.32" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l32.33"></a><span id="l32.33" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l32.34"></a><span id="l32.34" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l32.35"></a><span id="l32.35" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l32.36"></a><span id="l32.36" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l32.37"></a><span id="l32.37" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l32.38"></a><span id="l32.38" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l32.39"></a><span id="l32.39" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l32.40"></a><span id="l32.40" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l32.41"></a><span id="l32.41" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l32.42"></a><span id="l32.42" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l32.43"></a><span id="l32.43" class="difflineplus">+ * </span>
<a href="#l32.44"></a><span id="l32.44" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l32.45"></a><span id="l32.45"> </span>
<a href="#l32.46"></a><span id="l32.46"> var EXPORTED_SYMBOLS = [&quot;mozmill&quot;];</span>
<a href="#l32.47"></a><span id="l32.47">   </span>
<a href="#l32.48"></a><span id="l32.48"> const Cc = Components.classes;</span>
<a href="#l32.49"></a><span id="l32.49"> const Ci = Components.interfaces;</span>
<a href="#l32.50"></a><span id="l32.50"> const Cu = Components.utils;</span>
<a href="#l32.51"></a><span id="l32.51"> </span>
<a href="#l32.52"></a><span id="l32.52"> var controller = Cu.import('resource://mozmill/modules/controller.js');</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/EventUtils.js</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/EventUtils.js</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -1,14 +1,14 @@</span>
<a href="#l33.4"></a><span id="l33.4"> // Export all available functions for Mozmill</span>
<a href="#l33.5"></a><span id="l33.5"> var EXPORTED_SYMBOLS = [&quot;sendMouseEvent&quot;, &quot;sendChar&quot;, &quot;sendString&quot;, &quot;sendKey&quot;,</span>
<a href="#l33.6"></a><span id="l33.6">                         &quot;synthesizeMouse&quot;, &quot;synthesizeMouseScroll&quot;, &quot;synthesizeKey&quot;,</span>
<a href="#l33.7"></a><span id="l33.7">                         &quot;synthesizeMouseExpectEvent&quot;, &quot;synthesizeKeyExpectEvent&quot;,</span>
<a href="#l33.8"></a><span id="l33.8">                         &quot;synthesizeDragStart&quot;, &quot;synthesizeDrop&quot;, &quot;synthesizeText&quot;,</span>
<a href="#l33.9"></a><span id="l33.9" class="difflineminus">-                        &quot;disableNonTestMouseEvents&quot;, &quot;synthesizeComposition&quot;, </span>
<a href="#l33.10"></a><span id="l33.10" class="difflineplus">+                        &quot;disableNonTestMouseEvents&quot;, &quot;synthesizeComposition&quot;,</span>
<a href="#l33.11"></a><span id="l33.11">                         &quot;synthesizeQuerySelectedText&quot;, &quot;synthesizeQueryTextContent&quot;,</span>
<a href="#l33.12"></a><span id="l33.12">                         &quot;synthesizeQueryCaretRect&quot;, &quot;synthesizeQueryTextRect&quot;,</span>
<a href="#l33.13"></a><span id="l33.13">                         &quot;synthesizeQueryEditorRect&quot;, &quot;synthesizeCharAtPoint&quot;,</span>
<a href="#l33.14"></a><span id="l33.14">                         &quot;synthesizeSelectionSet&quot;];</span>
<a href="#l33.15"></a><span id="l33.15"> </span>
<a href="#l33.16"></a><span id="l33.16"> /**</span>
<a href="#l33.17"></a><span id="l33.17">  * Get the array with available key events</span>
<a href="#l33.18"></a><span id="l33.18">  */</span>
<a href="#l33.19"></a><span id="l33.19" class="difflineat">@@ -32,17 +32,17 @@ function getKeyEvent(aWindow) {</span>
<a href="#l33.20"></a><span id="l33.20">  * object with the properties set that the real mouse event object should</span>
<a href="#l33.21"></a><span id="l33.21">  * have. This includes the type of the mouse event.</span>
<a href="#l33.22"></a><span id="l33.22">  * E.g. to send an click event to the node with id 'node' you might do this:</span>
<a href="#l33.23"></a><span id="l33.23">  *</span>
<a href="#l33.24"></a><span id="l33.24">  * sendMouseEvent({type:'click'}, 'node');</span>
<a href="#l33.25"></a><span id="l33.25">  */</span>
<a href="#l33.26"></a><span id="l33.26"> function sendMouseEvent(aEvent, aTarget, aWindow) {</span>
<a href="#l33.27"></a><span id="l33.27">   if (['click', 'mousedown', 'mouseup', 'mouseover', 'mouseout'].indexOf(aEvent.type) == -1) {</span>
<a href="#l33.28"></a><span id="l33.28" class="difflineminus">-    throw new Error(&quot;sendMouseEvent doesn't know about event type '&quot;+aEvent.type+&quot;'&quot;);</span>
<a href="#l33.29"></a><span id="l33.29" class="difflineplus">+    throw new Error(&quot;sendMouseEvent doesn't know about event type '&quot; + aEvent.type + &quot;'&quot;);</span>
<a href="#l33.30"></a><span id="l33.30">   }</span>
<a href="#l33.31"></a><span id="l33.31"> </span>
<a href="#l33.32"></a><span id="l33.32">   if (!aWindow) {</span>
<a href="#l33.33"></a><span id="l33.33">     aWindow = window;</span>
<a href="#l33.34"></a><span id="l33.34">   }</span>
<a href="#l33.35"></a><span id="l33.35"> </span>
<a href="#l33.36"></a><span id="l33.36">   if (!(aTarget instanceof Element)) {</span>
<a href="#l33.37"></a><span id="l33.37">     aTarget = aWindow.document.getElementById(aTarget);</span>
<a href="#l33.38"></a><span id="l33.38" class="difflineat">@@ -111,28 +111,29 @@ function sendChar(aChar, aTarget) {</span>
<a href="#l33.39"></a><span id="l33.39"> function sendString(aStr, aTarget) {</span>
<a href="#l33.40"></a><span id="l33.40">   for (var i = 0; i &lt; aStr.length; ++i) {</span>
<a href="#l33.41"></a><span id="l33.41">     sendChar(aStr.charAt(i), aTarget);</span>
<a href="#l33.42"></a><span id="l33.42">   }</span>
<a href="#l33.43"></a><span id="l33.43"> }</span>
<a href="#l33.44"></a><span id="l33.44"> </span>
<a href="#l33.45"></a><span id="l33.45"> /**</span>
<a href="#l33.46"></a><span id="l33.46">  * Send the non-character key aKey to the node with id aTarget. If aTarget is</span>
<a href="#l33.47"></a><span id="l33.47" class="difflineminus">- * not provided, use &quot;target&quot;.  The name of the key should be a lowercase</span>
<a href="#l33.48"></a><span id="l33.48" class="difflineminus">- * version of the part that comes after &quot;DOM_VK_&quot; in the KeyEvent constant</span>
<a href="#l33.49"></a><span id="l33.49" class="difflineminus">- * name for this key.  No modifiers are handled at this point.</span>
<a href="#l33.50"></a><span id="l33.50" class="difflineplus">+ * not provided, use &quot;target&quot;.</span>
<a href="#l33.51"></a><span id="l33.51" class="difflineplus">+ * The name of the key should be the part that comes after &quot;DOM_VK_&quot; in the</span>
<a href="#l33.52"></a><span id="l33.52" class="difflineplus">+ *   KeyEvent constant name for this key.</span>
<a href="#l33.53"></a><span id="l33.53" class="difflineplus">+ * No modifiers are handled at this point.</span>
<a href="#l33.54"></a><span id="l33.54">  *</span>
<a href="#l33.55"></a><span id="l33.55">  * Returns true if the keypress event was accepted (no calls to preventDefault</span>
<a href="#l33.56"></a><span id="l33.56">  * or anything like that), false otherwise.</span>
<a href="#l33.57"></a><span id="l33.57">  */</span>
<a href="#l33.58"></a><span id="l33.58"> function sendKey(aKey, aTarget, aWindow) {</span>
<a href="#l33.59"></a><span id="l33.59">   if (!aWindow)</span>
<a href="#l33.60"></a><span id="l33.60">     aWindow = window;</span>
<a href="#l33.61"></a><span id="l33.61"> </span>
<a href="#l33.62"></a><span id="l33.62" class="difflineminus">-  keyName = &quot;DOM_VK_&quot; + aKey.toUpperCase();</span>
<a href="#l33.63"></a><span id="l33.63" class="difflineplus">+  var keyName = &quot;DOM_VK_&quot; + aKey.toUpperCase();</span>
<a href="#l33.64"></a><span id="l33.64"> </span>
<a href="#l33.65"></a><span id="l33.65">   if (!getKeyEvent(aWindow)[keyName]) {</span>
<a href="#l33.66"></a><span id="l33.66">     throw &quot;Unknown key: &quot; + keyName;</span>
<a href="#l33.67"></a><span id="l33.67">   }</span>
<a href="#l33.68"></a><span id="l33.68"> </span>
<a href="#l33.69"></a><span id="l33.69">   return __doEventDispatch(aTarget, 0, getKeyEvent(aWindow)[keyName], false);</span>
<a href="#l33.70"></a><span id="l33.70"> }</span>
<a href="#l33.71"></a><span id="l33.71"> </span>
<a href="#l33.72"></a><span id="l33.72" class="difflineat">@@ -233,17 +234,17 @@ function synthesizeMouse(aTarget, aOffse</span>
<a href="#l33.73"></a><span id="l33.73">     var clickCount = aEvent.clickCount || 1;</span>
<a href="#l33.74"></a><span id="l33.74">     var modifiers = _parseModifiers(aEvent);</span>
<a href="#l33.75"></a><span id="l33.75"> </span>
<a href="#l33.76"></a><span id="l33.76">     var rect = aTarget.getBoundingClientRect();</span>
<a href="#l33.77"></a><span id="l33.77"> </span>
<a href="#l33.78"></a><span id="l33.78">     var left = rect.left + aOffsetX;</span>
<a href="#l33.79"></a><span id="l33.79">     var top = rect.top + aOffsetY;</span>
<a href="#l33.80"></a><span id="l33.80"> </span>
<a href="#l33.81"></a><span id="l33.81" class="difflineminus">-    if (aEvent.type) {</span>
<a href="#l33.82"></a><span id="l33.82" class="difflineplus">+    if ((&quot;type&quot; in aEvent) &amp;&amp; aEvent.type) {</span>
<a href="#l33.83"></a><span id="l33.83">       utils.sendMouseEvent(aEvent.type, left, top, button, clickCount, modifiers);</span>
<a href="#l33.84"></a><span id="l33.84">     }</span>
<a href="#l33.85"></a><span id="l33.85">     else {</span>
<a href="#l33.86"></a><span id="l33.86">       utils.sendMouseEvent(&quot;mousedown&quot;, left, top, button, clickCount, modifiers);</span>
<a href="#l33.87"></a><span id="l33.87">       utils.sendMouseEvent(&quot;mouseup&quot;, left, top, button, clickCount, modifiers);</span>
<a href="#l33.88"></a><span id="l33.88">     }</span>
<a href="#l33.89"></a><span id="l33.89">   }</span>
<a href="#l33.90"></a><span id="l33.90"> }</span>
<a href="#l33.91"></a><span id="l33.91" class="difflineat">@@ -285,17 +286,17 @@ function synthesizeMouseScroll(aTarget, </span>
<a href="#l33.92"></a><span id="l33.92">     var button = aEvent.button || 0;</span>
<a href="#l33.93"></a><span id="l33.93">     var modifiers = _parseModifiers(aEvent);</span>
<a href="#l33.94"></a><span id="l33.94"> </span>
<a href="#l33.95"></a><span id="l33.95">     var rect = aTarget.getBoundingClientRect();</span>
<a href="#l33.96"></a><span id="l33.96"> </span>
<a href="#l33.97"></a><span id="l33.97">     var left = rect.left;</span>
<a href="#l33.98"></a><span id="l33.98">     var top = rect.top;</span>
<a href="#l33.99"></a><span id="l33.99"> </span>
<a href="#l33.100"></a><span id="l33.100" class="difflineminus">-    var type = aEvent.type || &quot;DOMMouseScroll&quot;;</span>
<a href="#l33.101"></a><span id="l33.101" class="difflineplus">+    var type = ((&quot;type&quot; in aEvent) &amp;&amp; aEvent.type) || &quot;DOMMouseScroll&quot;;</span>
<a href="#l33.102"></a><span id="l33.102">     var axis = aEvent.axis || &quot;vertical&quot;;</span>
<a href="#l33.103"></a><span id="l33.103">     var scrollFlags = (axis == &quot;horizontal&quot;) ? kIsHorizontal : kIsVertical;</span>
<a href="#l33.104"></a><span id="l33.104">     if (aEvent.hasPixels) {</span>
<a href="#l33.105"></a><span id="l33.105">       scrollFlags |= kHasPixels;</span>
<a href="#l33.106"></a><span id="l33.106">     }</span>
<a href="#l33.107"></a><span id="l33.107">     utils.sendMouseScrollEvent(type, left + aOffsetX, top + aOffsetY, button,</span>
<a href="#l33.108"></a><span id="l33.108">                                scrollFlags, aEvent.delta, modifiers);</span>
<a href="#l33.109"></a><span id="l33.109">   }</span>
<a href="#l33.110"></a><span id="l33.110" class="difflineat">@@ -327,25 +328,26 @@ function synthesizeKey(aKey, aEvent, aWi</span>
<a href="#l33.111"></a><span id="l33.111">     var keyCode = 0, charCode = 0;</span>
<a href="#l33.112"></a><span id="l33.112">     if (aKey.indexOf(&quot;VK_&quot;) == 0)</span>
<a href="#l33.113"></a><span id="l33.113">       keyCode = getKeyEvent(aWindow)[&quot;DOM_&quot; + aKey];</span>
<a href="#l33.114"></a><span id="l33.114">     else</span>
<a href="#l33.115"></a><span id="l33.115">       charCode = aKey.charCodeAt(0);</span>
<a href="#l33.116"></a><span id="l33.116"> </span>
<a href="#l33.117"></a><span id="l33.117">     var modifiers = _parseModifiers(aEvent);</span>
<a href="#l33.118"></a><span id="l33.118"> </span>
<a href="#l33.119"></a><span id="l33.119" class="difflineminus">-    if (aEvent.type) {</span>
<a href="#l33.120"></a><span id="l33.120" class="difflineminus">-      utils.sendKeyEvent(aEvent.type, keyCode, charCode, modifiers);</span>
<a href="#l33.121"></a><span id="l33.121" class="difflineminus">-    }</span>
<a href="#l33.122"></a><span id="l33.122" class="difflineminus">-    else {</span>
<a href="#l33.123"></a><span id="l33.123" class="difflineplus">+    if (!(&quot;type&quot; in aEvent) || !aEvent.type) {</span>
<a href="#l33.124"></a><span id="l33.124" class="difflineplus">+      // Send keydown + keypress + keyup events.</span>
<a href="#l33.125"></a><span id="l33.125">       var keyDownDefaultHappened =</span>
<a href="#l33.126"></a><span id="l33.126">           utils.sendKeyEvent(&quot;keydown&quot;, keyCode, charCode, modifiers);</span>
<a href="#l33.127"></a><span id="l33.127">       utils.sendKeyEvent(&quot;keypress&quot;, keyCode, charCode, modifiers,</span>
<a href="#l33.128"></a><span id="l33.128">                          !keyDownDefaultHappened);</span>
<a href="#l33.129"></a><span id="l33.129">       utils.sendKeyEvent(&quot;keyup&quot;, keyCode, charCode, modifiers);</span>
<a href="#l33.130"></a><span id="l33.130" class="difflineplus">+    } else {</span>
<a href="#l33.131"></a><span id="l33.131" class="difflineplus">+      // Send standalone event.</span>
<a href="#l33.132"></a><span id="l33.132" class="difflineplus">+      utils.sendKeyEvent(aEvent.type, keyCode, charCode, modifiers);</span>
<a href="#l33.133"></a><span id="l33.133">     }</span>
<a href="#l33.134"></a><span id="l33.134">   }</span>
<a href="#l33.135"></a><span id="l33.135"> }</span>
<a href="#l33.136"></a><span id="l33.136"> </span>
<a href="#l33.137"></a><span id="l33.137"> var _gSeenEvent = false;</span>
<a href="#l33.138"></a><span id="l33.138"> </span>
<a href="#l33.139"></a><span id="l33.139"> /**</span>
<a href="#l33.140"></a><span id="l33.140">  * Indicate that an event with an original target of aExpectedTarget and</span>
<a href="#l33.141"></a><span id="l33.141" class="difflineat">@@ -693,18 +695,19 @@ function synthesizeText(aEvent, aWindow)</span>
<a href="#l33.142"></a><span id="l33.142">  * @param aWindow  Optional (If null, current |window| will be used)</span>
<a href="#l33.143"></a><span id="l33.143">  * @return         An nsIQueryContentEventResult object.  If this failed,</span>
<a href="#l33.144"></a><span id="l33.144">  *                 the result might be null.</span>
<a href="#l33.145"></a><span id="l33.145">  */</span>
<a href="#l33.146"></a><span id="l33.146"> function synthesizeQuerySelectedText(aWindow)</span>
<a href="#l33.147"></a><span id="l33.147"> {</span>
<a href="#l33.148"></a><span id="l33.148">   var utils = _getDOMWindowUtils(aWindow);</span>
<a href="#l33.149"></a><span id="l33.149">   if (!utils) {</span>
<a href="#l33.150"></a><span id="l33.150" class="difflineminus">-    return nsnull;</span>
<a href="#l33.151"></a><span id="l33.151" class="difflineplus">+    return null;</span>
<a href="#l33.152"></a><span id="l33.152">   }</span>
<a href="#l33.153"></a><span id="l33.153" class="difflineplus">+</span>
<a href="#l33.154"></a><span id="l33.154">   return utils.sendQueryContentEvent(utils.QUERY_SELECTED_TEXT, 0, 0, 0, 0);</span>
<a href="#l33.155"></a><span id="l33.155"> }</span>
<a href="#l33.156"></a><span id="l33.156"> </span>
<a href="#l33.157"></a><span id="l33.157"> /**</span>
<a href="#l33.158"></a><span id="l33.158">  * Synthesize a query text content event.</span>
<a href="#l33.159"></a><span id="l33.159">  *</span>
<a href="#l33.160"></a><span id="l33.160">  * @param aOffset  The character offset.  0 means the first character in the</span>
<a href="#l33.161"></a><span id="l33.161">  *                 selection root.</span>
<a href="#l33.162"></a><span id="l33.162" class="difflineat">@@ -713,18 +716,19 @@ function synthesizeQuerySelectedText(aWi</span>
<a href="#l33.163"></a><span id="l33.163">  * @param aWindow  Optional (If null, current |window| will be used)</span>
<a href="#l33.164"></a><span id="l33.164">  * @return         An nsIQueryContentEventResult object.  If this failed,</span>
<a href="#l33.165"></a><span id="l33.165">  *                 the result might be null.</span>
<a href="#l33.166"></a><span id="l33.166">  */</span>
<a href="#l33.167"></a><span id="l33.167"> function synthesizeQueryTextContent(aOffset, aLength, aWindow)</span>
<a href="#l33.168"></a><span id="l33.168"> {</span>
<a href="#l33.169"></a><span id="l33.169">   var utils = _getDOMWindowUtils(aWindow);</span>
<a href="#l33.170"></a><span id="l33.170">   if (!utils) {</span>
<a href="#l33.171"></a><span id="l33.171" class="difflineminus">-    return nsnull;</span>
<a href="#l33.172"></a><span id="l33.172" class="difflineplus">+    return null;</span>
<a href="#l33.173"></a><span id="l33.173">   }</span>
<a href="#l33.174"></a><span id="l33.174" class="difflineplus">+</span>
<a href="#l33.175"></a><span id="l33.175">   return utils.sendQueryContentEvent(utils.QUERY_TEXT_CONTENT,</span>
<a href="#l33.176"></a><span id="l33.176">                                      aOffset, aLength, 0, 0);</span>
<a href="#l33.177"></a><span id="l33.177"> }</span>
<a href="#l33.178"></a><span id="l33.178"> </span>
<a href="#l33.179"></a><span id="l33.179"> /**</span>
<a href="#l33.180"></a><span id="l33.180">  * Synthesize a query caret rect event.</span>
<a href="#l33.181"></a><span id="l33.181">  *</span>
<a href="#l33.182"></a><span id="l33.182">  * @param aOffset  The caret offset.  0 means left side of the first character</span>
<a href="#l33.183"></a><span id="l33.183" class="difflineat">@@ -732,18 +736,19 @@ function synthesizeQueryTextContent(aOff</span>
<a href="#l33.184"></a><span id="l33.184">  * @param aWindow  Optional (If null, current |window| will be used)</span>
<a href="#l33.185"></a><span id="l33.185">  * @return         An nsIQueryContentEventResult object.  If this failed,</span>
<a href="#l33.186"></a><span id="l33.186">  *                 the result might be null.</span>
<a href="#l33.187"></a><span id="l33.187">  */</span>
<a href="#l33.188"></a><span id="l33.188"> function synthesizeQueryCaretRect(aOffset, aWindow)</span>
<a href="#l33.189"></a><span id="l33.189"> {</span>
<a href="#l33.190"></a><span id="l33.190">   var utils = _getDOMWindowUtils(aWindow);</span>
<a href="#l33.191"></a><span id="l33.191">   if (!utils) {</span>
<a href="#l33.192"></a><span id="l33.192" class="difflineminus">-    return nsnull;</span>
<a href="#l33.193"></a><span id="l33.193" class="difflineplus">+    return null;</span>
<a href="#l33.194"></a><span id="l33.194">   }</span>
<a href="#l33.195"></a><span id="l33.195" class="difflineplus">+</span>
<a href="#l33.196"></a><span id="l33.196">   return utils.sendQueryContentEvent(utils.QUERY_CARET_RECT,</span>
<a href="#l33.197"></a><span id="l33.197">                                      aOffset, 0, 0, 0);</span>
<a href="#l33.198"></a><span id="l33.198"> }</span>
<a href="#l33.199"></a><span id="l33.199"> </span>
<a href="#l33.200"></a><span id="l33.200"> /**</span>
<a href="#l33.201"></a><span id="l33.201">  * Synthesize a query text rect event.</span>
<a href="#l33.202"></a><span id="l33.202">  *</span>
<a href="#l33.203"></a><span id="l33.203">  * @param aOffset  The character offset.  0 means the first character in the</span>
<a href="#l33.204"></a><span id="l33.204" class="difflineat">@@ -753,52 +758,55 @@ function synthesizeQueryCaretRect(aOffse</span>
<a href="#l33.205"></a><span id="l33.205">  * @param aWindow  Optional (If null, current |window| will be used)</span>
<a href="#l33.206"></a><span id="l33.206">  * @return         An nsIQueryContentEventResult object.  If this failed,</span>
<a href="#l33.207"></a><span id="l33.207">  *                 the result might be null.</span>
<a href="#l33.208"></a><span id="l33.208">  */</span>
<a href="#l33.209"></a><span id="l33.209"> function synthesizeQueryTextRect(aOffset, aLength, aWindow)</span>
<a href="#l33.210"></a><span id="l33.210"> {</span>
<a href="#l33.211"></a><span id="l33.211">   var utils = _getDOMWindowUtils(aWindow);</span>
<a href="#l33.212"></a><span id="l33.212">   if (!utils) {</span>
<a href="#l33.213"></a><span id="l33.213" class="difflineminus">-    return nsnull;</span>
<a href="#l33.214"></a><span id="l33.214" class="difflineplus">+    return null;</span>
<a href="#l33.215"></a><span id="l33.215">   }</span>
<a href="#l33.216"></a><span id="l33.216" class="difflineplus">+</span>
<a href="#l33.217"></a><span id="l33.217">   return utils.sendQueryContentEvent(utils.QUERY_TEXT_RECT,</span>
<a href="#l33.218"></a><span id="l33.218">                                      aOffset, aLength, 0, 0);</span>
<a href="#l33.219"></a><span id="l33.219"> }</span>
<a href="#l33.220"></a><span id="l33.220"> </span>
<a href="#l33.221"></a><span id="l33.221"> /**</span>
<a href="#l33.222"></a><span id="l33.222">  * Synthesize a query editor rect event.</span>
<a href="#l33.223"></a><span id="l33.223">  *</span>
<a href="#l33.224"></a><span id="l33.224">  * @param aWindow  Optional (If null, current |window| will be used)</span>
<a href="#l33.225"></a><span id="l33.225">  * @return         An nsIQueryContentEventResult object.  If this failed,</span>
<a href="#l33.226"></a><span id="l33.226">  *                 the result might be null.</span>
<a href="#l33.227"></a><span id="l33.227">  */</span>
<a href="#l33.228"></a><span id="l33.228"> function synthesizeQueryEditorRect(aWindow)</span>
<a href="#l33.229"></a><span id="l33.229"> {</span>
<a href="#l33.230"></a><span id="l33.230">   var utils = _getDOMWindowUtils(aWindow);</span>
<a href="#l33.231"></a><span id="l33.231">   if (!utils) {</span>
<a href="#l33.232"></a><span id="l33.232" class="difflineminus">-    return nsnull;</span>
<a href="#l33.233"></a><span id="l33.233" class="difflineplus">+    return null;</span>
<a href="#l33.234"></a><span id="l33.234">   }</span>
<a href="#l33.235"></a><span id="l33.235" class="difflineplus">+</span>
<a href="#l33.236"></a><span id="l33.236">   return utils.sendQueryContentEvent(utils.QUERY_EDITOR_RECT, 0, 0, 0, 0);</span>
<a href="#l33.237"></a><span id="l33.237"> }</span>
<a href="#l33.238"></a><span id="l33.238"> </span>
<a href="#l33.239"></a><span id="l33.239"> /**</span>
<a href="#l33.240"></a><span id="l33.240">  * Synthesize a character at point event.</span>
<a href="#l33.241"></a><span id="l33.241">  *</span>
<a href="#l33.242"></a><span id="l33.242">  * @param aX, aY   The offset in the client area of the DOM window.</span>
<a href="#l33.243"></a><span id="l33.243">  * @param aWindow  Optional (If null, current |window| will be used)</span>
<a href="#l33.244"></a><span id="l33.244">  * @return         An nsIQueryContentEventResult object.  If this failed,</span>
<a href="#l33.245"></a><span id="l33.245">  *                 the result might be null.</span>
<a href="#l33.246"></a><span id="l33.246">  */</span>
<a href="#l33.247"></a><span id="l33.247"> function synthesizeCharAtPoint(aX, aY, aWindow)</span>
<a href="#l33.248"></a><span id="l33.248"> {</span>
<a href="#l33.249"></a><span id="l33.249">   var utils = _getDOMWindowUtils(aWindow);</span>
<a href="#l33.250"></a><span id="l33.250">   if (!utils) {</span>
<a href="#l33.251"></a><span id="l33.251" class="difflineminus">-    return nsnull;</span>
<a href="#l33.252"></a><span id="l33.252" class="difflineplus">+    return null;</span>
<a href="#l33.253"></a><span id="l33.253">   }</span>
<a href="#l33.254"></a><span id="l33.254" class="difflineplus">+</span>
<a href="#l33.255"></a><span id="l33.255">   return utils.sendQueryContentEvent(utils.QUERY_CHARACTER_AT_POINT,</span>
<a href="#l33.256"></a><span id="l33.256">                                      0, 0, aX, aY);</span>
<a href="#l33.257"></a><span id="l33.257"> }</span>
<a href="#l33.258"></a><span id="l33.258"> </span>
<a href="#l33.259"></a><span id="l33.259"> /**</span>
<a href="#l33.260"></a><span id="l33.260">  * Synthesize a selection set event.</span>
<a href="#l33.261"></a><span id="l33.261">  *</span>
<a href="#l33.262"></a><span id="l33.262">  * @param aOffset  The character offset.  0 means the first character in the</span>
<a href="#l33.263"></a><span id="l33.263" class="difflineat">@@ -811,10 +819,11 @@ function synthesizeCharAtPoint(aX, aY, a</span>
<a href="#l33.264"></a><span id="l33.264">  * @return         True, if succeeded.  Otherwise false.</span>
<a href="#l33.265"></a><span id="l33.265">  */</span>
<a href="#l33.266"></a><span id="l33.266"> function synthesizeSelectionSet(aOffset, aLength, aReverse, aWindow)</span>
<a href="#l33.267"></a><span id="l33.267"> {</span>
<a href="#l33.268"></a><span id="l33.268">   var utils = _getDOMWindowUtils(aWindow);</span>
<a href="#l33.269"></a><span id="l33.269">   if (!utils) {</span>
<a href="#l33.270"></a><span id="l33.270">     return false;</span>
<a href="#l33.271"></a><span id="l33.271">   }</span>
<a href="#l33.272"></a><span id="l33.272" class="difflineplus">+</span>
<a href="#l33.273"></a><span id="l33.273">   return utils.sendSelectionSetEvent(aOffset, aLength, aReverse);</span>
<a href="#l33.274"></a><span id="l33.274"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -5,26 +5,46 @@</span>
<a href="#l34.4"></a><span id="l34.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l34.5"></a><span id="l34.5"> </span>
<a href="#l34.6"></a><span id="l34.6"> /*</span>
<a href="#l34.7"></a><span id="l34.7">  * An implementation of an HTTP server both as a loadable script and as an XPCOM</span>
<a href="#l34.8"></a><span id="l34.8">  * component.  See the accompanying README file for user documentation on</span>
<a href="#l34.9"></a><span id="l34.9">  * httpd.js.</span>
<a href="#l34.10"></a><span id="l34.10">  */</span>
<a href="#l34.11"></a><span id="l34.11"> </span>
<a href="#l34.12"></a><span id="l34.12" class="difflineplus">+const EXPORTED_SYMBOLS = [</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+  &quot;HTTP_400&quot;,</span>
<a href="#l34.14"></a><span id="l34.14" class="difflineplus">+  &quot;HTTP_401&quot;,</span>
<a href="#l34.15"></a><span id="l34.15" class="difflineplus">+  &quot;HTTP_402&quot;,</span>
<a href="#l34.16"></a><span id="l34.16" class="difflineplus">+  &quot;HTTP_403&quot;,</span>
<a href="#l34.17"></a><span id="l34.17" class="difflineplus">+  &quot;HTTP_404&quot;,</span>
<a href="#l34.18"></a><span id="l34.18" class="difflineplus">+  &quot;HTTP_405&quot;,</span>
<a href="#l34.19"></a><span id="l34.19" class="difflineplus">+  &quot;HTTP_406&quot;,</span>
<a href="#l34.20"></a><span id="l34.20" class="difflineplus">+  &quot;HTTP_407&quot;,</span>
<a href="#l34.21"></a><span id="l34.21" class="difflineplus">+  &quot;HTTP_408&quot;,</span>
<a href="#l34.22"></a><span id="l34.22" class="difflineplus">+  &quot;HTTP_409&quot;,</span>
<a href="#l34.23"></a><span id="l34.23" class="difflineplus">+  &quot;HTTP_410&quot;,</span>
<a href="#l34.24"></a><span id="l34.24" class="difflineplus">+  &quot;HTTP_411&quot;,</span>
<a href="#l34.25"></a><span id="l34.25" class="difflineplus">+  &quot;HTTP_412&quot;,</span>
<a href="#l34.26"></a><span id="l34.26" class="difflineplus">+  &quot;HTTP_413&quot;,</span>
<a href="#l34.27"></a><span id="l34.27" class="difflineplus">+  &quot;HTTP_414&quot;,</span>
<a href="#l34.28"></a><span id="l34.28" class="difflineplus">+  &quot;HTTP_415&quot;,</span>
<a href="#l34.29"></a><span id="l34.29" class="difflineplus">+  &quot;HTTP_417&quot;,</span>
<a href="#l34.30"></a><span id="l34.30" class="difflineplus">+  &quot;HTTP_500&quot;,</span>
<a href="#l34.31"></a><span id="l34.31" class="difflineplus">+  &quot;HTTP_501&quot;,</span>
<a href="#l34.32"></a><span id="l34.32" class="difflineplus">+  &quot;HTTP_502&quot;,</span>
<a href="#l34.33"></a><span id="l34.33" class="difflineplus">+  &quot;HTTP_503&quot;,</span>
<a href="#l34.34"></a><span id="l34.34" class="difflineplus">+  &quot;HTTP_504&quot;,</span>
<a href="#l34.35"></a><span id="l34.35" class="difflineplus">+  &quot;HTTP_505&quot;,</span>
<a href="#l34.36"></a><span id="l34.36" class="difflineplus">+  &quot;HttpError&quot;,</span>
<a href="#l34.37"></a><span id="l34.37" class="difflineplus">+  &quot;HttpServer&quot;,</span>
<a href="#l34.38"></a><span id="l34.38" class="difflineplus">+];</span>
<a href="#l34.39"></a><span id="l34.39" class="difflineplus">+</span>
<a href="#l34.40"></a><span id="l34.40"> Components.utils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l34.41"></a><span id="l34.41"> </span>
<a href="#l34.42"></a><span id="l34.42" class="difflineminus">-var EXPORTED_SYMBOLS = ['getServer'];</span>
<a href="#l34.43"></a><span id="l34.43" class="difflineminus">-</span>
<a href="#l34.44"></a><span id="l34.44" class="difflineminus">-/**</span>
<a href="#l34.45"></a><span id="l34.45" class="difflineminus">- * Overwrite both dump functions because we do not wanna have this output for Mozmill</span>
<a href="#l34.46"></a><span id="l34.46" class="difflineminus">- */</span>
<a href="#l34.47"></a><span id="l34.47" class="difflineminus">-function dump() {}</span>
<a href="#l34.48"></a><span id="l34.48" class="difflineminus">-function dumpn() {}</span>
<a href="#l34.49"></a><span id="l34.49" class="difflineminus">-</span>
<a href="#l34.50"></a><span id="l34.50"> const Cc = Components.classes;</span>
<a href="#l34.51"></a><span id="l34.51"> const Ci = Components.interfaces;</span>
<a href="#l34.52"></a><span id="l34.52"> const Cr = Components.results;</span>
<a href="#l34.53"></a><span id="l34.53"> const Cu = Components.utils;</span>
<a href="#l34.54"></a><span id="l34.54"> const CC = Components.Constructor;</span>
<a href="#l34.55"></a><span id="l34.55"> </span>
<a href="#l34.56"></a><span id="l34.56"> const PR_UINT32_MAX = Math.pow(2, 32) - 1;</span>
<a href="#l34.57"></a><span id="l34.57"> </span>
<a href="#l34.58"></a><span id="l34.58" class="difflineat">@@ -488,22 +508,22 @@ nsHttpServer.prototype =</span>
<a href="#l34.59"></a><span id="l34.59">       throw Cr.NS_ERROR_ALREADY_INITIALIZED;</span>
<a href="#l34.60"></a><span id="l34.60"> </span>
<a href="#l34.61"></a><span id="l34.61">     this._port = port;</span>
<a href="#l34.62"></a><span id="l34.62">     this._doQuit = this._socketClosed = false;</span>
<a href="#l34.63"></a><span id="l34.63"> </span>
<a href="#l34.64"></a><span id="l34.64">     this._host = host;</span>
<a href="#l34.65"></a><span id="l34.65"> </span>
<a href="#l34.66"></a><span id="l34.66">     // The listen queue needs to be long enough to handle</span>
<a href="#l34.67"></a><span id="l34.67" class="difflineminus">-    // network.http.max-connections-per-server concurrent connections,</span>
<a href="#l34.68"></a><span id="l34.68" class="difflineplus">+    // network.http.max-persistent-connections-per-server concurrent connections,</span>
<a href="#l34.69"></a><span id="l34.69">     // plus a safety margin in case some other process is talking to</span>
<a href="#l34.70"></a><span id="l34.70">     // the server as well.</span>
<a href="#l34.71"></a><span id="l34.71">     var prefs = getRootPrefBranch();</span>
<a href="#l34.72"></a><span id="l34.72">     var maxConnections =</span>
<a href="#l34.73"></a><span id="l34.73" class="difflineminus">-      prefs.getIntPref(&quot;network.http.max-connections-per-server&quot;) + 5;</span>
<a href="#l34.74"></a><span id="l34.74" class="difflineplus">+      prefs.getIntPref(&quot;network.http.max-persistent-connections-per-server&quot;) + 5;</span>
<a href="#l34.75"></a><span id="l34.75"> </span>
<a href="#l34.76"></a><span id="l34.76">     try</span>
<a href="#l34.77"></a><span id="l34.77">     {</span>
<a href="#l34.78"></a><span id="l34.78">       var loopback = true;</span>
<a href="#l34.79"></a><span id="l34.79">       if (this._host != &quot;127.0.0.1&quot; &amp;&amp; this._host != &quot;localhost&quot;) {</span>
<a href="#l34.80"></a><span id="l34.80">         var loopback = false;</span>
<a href="#l34.81"></a><span id="l34.81">       }</span>
<a href="#l34.82"></a><span id="l34.82"> </span>
<a href="#l34.83"></a><span id="l34.83" class="difflineat">@@ -583,16 +603,24 @@ nsHttpServer.prototype =</span>
<a href="#l34.84"></a><span id="l34.84">   // see nsIHttpServer.registerPathHandler</span>
<a href="#l34.85"></a><span id="l34.85">   //</span>
<a href="#l34.86"></a><span id="l34.86">   registerPathHandler: function(path, handler)</span>
<a href="#l34.87"></a><span id="l34.87">   {</span>
<a href="#l34.88"></a><span id="l34.88">     this._handler.registerPathHandler(path, handler);</span>
<a href="#l34.89"></a><span id="l34.89">   },</span>
<a href="#l34.90"></a><span id="l34.90"> </span>
<a href="#l34.91"></a><span id="l34.91">   //</span>
<a href="#l34.92"></a><span id="l34.92" class="difflineplus">+  // see nsIHttpServer.registerPrefixHandler</span>
<a href="#l34.93"></a><span id="l34.93" class="difflineplus">+  //</span>
<a href="#l34.94"></a><span id="l34.94" class="difflineplus">+  registerPrefixHandler: function(prefix, handler)</span>
<a href="#l34.95"></a><span id="l34.95" class="difflineplus">+  {</span>
<a href="#l34.96"></a><span id="l34.96" class="difflineplus">+    this._handler.registerPrefixHandler(prefix, handler);</span>
<a href="#l34.97"></a><span id="l34.97" class="difflineplus">+  },</span>
<a href="#l34.98"></a><span id="l34.98" class="difflineplus">+</span>
<a href="#l34.99"></a><span id="l34.99" class="difflineplus">+  //</span>
<a href="#l34.100"></a><span id="l34.100">   // see nsIHttpServer.registerErrorHandler</span>
<a href="#l34.101"></a><span id="l34.101">   //</span>
<a href="#l34.102"></a><span id="l34.102">   registerErrorHandler: function(code, handler)</span>
<a href="#l34.103"></a><span id="l34.103">   {</span>
<a href="#l34.104"></a><span id="l34.104">     this._handler.registerErrorHandler(code, handler);</span>
<a href="#l34.105"></a><span id="l34.105">   },</span>
<a href="#l34.106"></a><span id="l34.106"> </span>
<a href="#l34.107"></a><span id="l34.107">   //</span>
<a href="#l34.108"></a><span id="l34.108" class="difflineat">@@ -754,29 +782,34 @@ nsHttpServer.prototype =</span>
<a href="#l34.109"></a><span id="l34.109">     NS_ASSERT(this._connections[connection.number] === connection,</span>
<a href="#l34.110"></a><span id="l34.110">               &quot;connection number mismatch?  &quot; +</span>
<a href="#l34.111"></a><span id="l34.111">               this._connections[connection.number]);</span>
<a href="#l34.112"></a><span id="l34.112">     delete this._connections[connection.number];</span>
<a href="#l34.113"></a><span id="l34.113"> </span>
<a href="#l34.114"></a><span id="l34.114">     // Fire a pending server-stopped notification if it's our responsibility.</span>
<a href="#l34.115"></a><span id="l34.115">     if (!this._hasOpenConnections() &amp;&amp; this._socketClosed)</span>
<a href="#l34.116"></a><span id="l34.116">       this._notifyStopped();</span>
<a href="#l34.117"></a><span id="l34.117" class="difflineplus">+    // Bug 508125: Add a GC here else we'll use gigabytes of memory running</span>
<a href="#l34.118"></a><span id="l34.118" class="difflineplus">+    // mochitests. We can't rely on xpcshell doing an automated GC, as that</span>
<a href="#l34.119"></a><span id="l34.119" class="difflineplus">+    // would interfere with testing GC stuff...</span>
<a href="#l34.120"></a><span id="l34.120" class="difflineplus">+    Components.utils.forceGC();</span>
<a href="#l34.121"></a><span id="l34.121">   },</span>
<a href="#l34.122"></a><span id="l34.122"> </span>
<a href="#l34.123"></a><span id="l34.123">   /**</span>
<a href="#l34.124"></a><span id="l34.124">    * Requests that the server be shut down when possible.</span>
<a href="#l34.125"></a><span id="l34.125">    */</span>
<a href="#l34.126"></a><span id="l34.126">   _requestQuit: function()</span>
<a href="#l34.127"></a><span id="l34.127">   {</span>
<a href="#l34.128"></a><span id="l34.128">     dumpn(&quot;&gt;&gt;&gt; requesting a quit&quot;);</span>
<a href="#l34.129"></a><span id="l34.129">     dumpStack();</span>
<a href="#l34.130"></a><span id="l34.130">     this._doQuit = true;</span>
<a href="#l34.131"></a><span id="l34.131">   }</span>
<a href="#l34.132"></a><span id="l34.132"> };</span>
<a href="#l34.133"></a><span id="l34.133"> </span>
<a href="#l34.134"></a><span id="l34.134" class="difflineplus">+var HttpServer = nsHttpServer;</span>
<a href="#l34.135"></a><span id="l34.135"> </span>
<a href="#l34.136"></a><span id="l34.136"> //</span>
<a href="#l34.137"></a><span id="l34.137"> // RFC 2396 section 3.2.2:</span>
<a href="#l34.138"></a><span id="l34.138"> //</span>
<a href="#l34.139"></a><span id="l34.139"> // host        = hostname | IPv4address</span>
<a href="#l34.140"></a><span id="l34.140"> // hostname    = *( domainlabel &quot;.&quot; ) toplabel [ &quot;.&quot; ]</span>
<a href="#l34.141"></a><span id="l34.141"> // domainlabel = alphanum | alphanum *( alphanum | &quot;-&quot; ) alphanum</span>
<a href="#l34.142"></a><span id="l34.142"> // toplabel    = alpha | alpha *( alphanum | &quot;-&quot; ) alphanum</span>
<a href="#l34.143"></a><span id="l34.143" class="difflineat">@@ -1601,25 +1634,31 @@ RequestReader.prototype =</span>
<a href="#l34.144"></a><span id="l34.144">     dumpn(&quot;*** _parseRequestLine('&quot; + line + &quot;')&quot;);</span>
<a href="#l34.145"></a><span id="l34.145"> </span>
<a href="#l34.146"></a><span id="l34.146">     var metadata = this._metadata;</span>
<a href="#l34.147"></a><span id="l34.147"> </span>
<a href="#l34.148"></a><span id="l34.148">     // clients and servers SHOULD accept any amount of SP or HT characters</span>
<a href="#l34.149"></a><span id="l34.149">     // between fields, even though only a single SP is required (section 19.3)</span>
<a href="#l34.150"></a><span id="l34.150">     var request = line.split(/[ \t]+/);</span>
<a href="#l34.151"></a><span id="l34.151">     if (!request || request.length != 3)</span>
<a href="#l34.152"></a><span id="l34.152" class="difflineplus">+    {</span>
<a href="#l34.153"></a><span id="l34.153" class="difflineplus">+      dumpn(&quot;*** No request in line&quot;);</span>
<a href="#l34.154"></a><span id="l34.154">       throw HTTP_400;</span>
<a href="#l34.155"></a><span id="l34.155" class="difflineplus">+    }</span>
<a href="#l34.156"></a><span id="l34.156"> </span>
<a href="#l34.157"></a><span id="l34.157">     metadata._method = request[0];</span>
<a href="#l34.158"></a><span id="l34.158"> </span>
<a href="#l34.159"></a><span id="l34.159">     // get the HTTP version</span>
<a href="#l34.160"></a><span id="l34.160">     var ver = request[2];</span>
<a href="#l34.161"></a><span id="l34.161">     var match = ver.match(/^HTTP\/(\d+\.\d+)$/);</span>
<a href="#l34.162"></a><span id="l34.162">     if (!match)</span>
<a href="#l34.163"></a><span id="l34.163" class="difflineplus">+    {</span>
<a href="#l34.164"></a><span id="l34.164" class="difflineplus">+      dumpn(&quot;*** No HTTP version in line&quot;);</span>
<a href="#l34.165"></a><span id="l34.165">       throw HTTP_400;</span>
<a href="#l34.166"></a><span id="l34.166" class="difflineplus">+    }</span>
<a href="#l34.167"></a><span id="l34.167"> </span>
<a href="#l34.168"></a><span id="l34.168">     // determine HTTP version</span>
<a href="#l34.169"></a><span id="l34.169">     try</span>
<a href="#l34.170"></a><span id="l34.170">     {</span>
<a href="#l34.171"></a><span id="l34.171">       metadata._httpVersion = new nsHttpVersion(match[1]);</span>
<a href="#l34.172"></a><span id="l34.172">       if (!metadata._httpVersion.atLeast(nsHttpVersion.HTTP_1_0))</span>
<a href="#l34.173"></a><span id="l34.173">         throw &quot;unsupported HTTP version&quot;;</span>
<a href="#l34.174"></a><span id="l34.174">     }</span>
<a href="#l34.175"></a><span id="l34.175" class="difflineat">@@ -1634,47 +1673,61 @@ RequestReader.prototype =</span>
<a href="#l34.176"></a><span id="l34.176">     var serverIdentity = this._connection.server.identity;</span>
<a href="#l34.177"></a><span id="l34.177"> </span>
<a href="#l34.178"></a><span id="l34.178">     var scheme, host, port;</span>
<a href="#l34.179"></a><span id="l34.179"> </span>
<a href="#l34.180"></a><span id="l34.180">     if (fullPath.charAt(0) != &quot;/&quot;)</span>
<a href="#l34.181"></a><span id="l34.181">     {</span>
<a href="#l34.182"></a><span id="l34.182">       // No absolute paths in the request line in HTTP prior to 1.1</span>
<a href="#l34.183"></a><span id="l34.183">       if (!metadata._httpVersion.atLeast(nsHttpVersion.HTTP_1_1))</span>
<a href="#l34.184"></a><span id="l34.184" class="difflineplus">+      {</span>
<a href="#l34.185"></a><span id="l34.185" class="difflineplus">+        dumpn(&quot;*** Metadata version too low&quot;);</span>
<a href="#l34.186"></a><span id="l34.186">         throw HTTP_400;</span>
<a href="#l34.187"></a><span id="l34.187" class="difflineplus">+      }</span>
<a href="#l34.188"></a><span id="l34.188"> </span>
<a href="#l34.189"></a><span id="l34.189">       try</span>
<a href="#l34.190"></a><span id="l34.190">       {</span>
<a href="#l34.191"></a><span id="l34.191">         var uri = Cc[&quot;@mozilla.org/network/io-service;1&quot;]</span>
<a href="#l34.192"></a><span id="l34.192">                     .getService(Ci.nsIIOService)</span>
<a href="#l34.193"></a><span id="l34.193">                     .newURI(fullPath, null, null);</span>
<a href="#l34.194"></a><span id="l34.194">         fullPath = uri.path;</span>
<a href="#l34.195"></a><span id="l34.195">         scheme = uri.scheme;</span>
<a href="#l34.196"></a><span id="l34.196">         host = metadata._host = uri.asciiHost;</span>
<a href="#l34.197"></a><span id="l34.197">         port = uri.port;</span>
<a href="#l34.198"></a><span id="l34.198">         if (port === -1)</span>
<a href="#l34.199"></a><span id="l34.199">         {</span>
<a href="#l34.200"></a><span id="l34.200">           if (scheme === &quot;http&quot;)</span>
<a href="#l34.201"></a><span id="l34.201" class="difflineplus">+          {</span>
<a href="#l34.202"></a><span id="l34.202">             port = 80;</span>
<a href="#l34.203"></a><span id="l34.203" class="difflineplus">+          }</span>
<a href="#l34.204"></a><span id="l34.204">           else if (scheme === &quot;https&quot;)</span>
<a href="#l34.205"></a><span id="l34.205" class="difflineplus">+          {</span>
<a href="#l34.206"></a><span id="l34.206">             port = 443;</span>
<a href="#l34.207"></a><span id="l34.207" class="difflineplus">+          }</span>
<a href="#l34.208"></a><span id="l34.208">           else</span>
<a href="#l34.209"></a><span id="l34.209" class="difflineplus">+          {</span>
<a href="#l34.210"></a><span id="l34.210" class="difflineplus">+            dumpn(&quot;*** Unknown scheme: &quot; + scheme);</span>
<a href="#l34.211"></a><span id="l34.211">             throw HTTP_400;</span>
<a href="#l34.212"></a><span id="l34.212" class="difflineplus">+          }</span>
<a href="#l34.213"></a><span id="l34.213">         }</span>
<a href="#l34.214"></a><span id="l34.214">       }</span>
<a href="#l34.215"></a><span id="l34.215">       catch (e)</span>
<a href="#l34.216"></a><span id="l34.216">       {</span>
<a href="#l34.217"></a><span id="l34.217">         // If the host is not a valid host on the server, the response MUST be a</span>
<a href="#l34.218"></a><span id="l34.218">         // 400 (Bad Request) error message (section 5.2).  Alternately, the URI</span>
<a href="#l34.219"></a><span id="l34.219">         // is malformed.</span>
<a href="#l34.220"></a><span id="l34.220" class="difflineplus">+        dumpn(&quot;*** Threw when dealing with URI: &quot; + e);</span>
<a href="#l34.221"></a><span id="l34.221">         throw HTTP_400;</span>
<a href="#l34.222"></a><span id="l34.222">       }</span>
<a href="#l34.223"></a><span id="l34.223"> </span>
<a href="#l34.224"></a><span id="l34.224">       if (!serverIdentity.has(scheme, host, port) || fullPath.charAt(0) != &quot;/&quot;)</span>
<a href="#l34.225"></a><span id="l34.225" class="difflineplus">+      {</span>
<a href="#l34.226"></a><span id="l34.226" class="difflineplus">+        dumpn(&quot;*** serverIdentity unknown or path does not start with '/'&quot;);</span>
<a href="#l34.227"></a><span id="l34.227">         throw HTTP_400;</span>
<a href="#l34.228"></a><span id="l34.228" class="difflineplus">+      }</span>
<a href="#l34.229"></a><span id="l34.229">     }</span>
<a href="#l34.230"></a><span id="l34.230"> </span>
<a href="#l34.231"></a><span id="l34.231">     var splitter = fullPath.indexOf(&quot;?&quot;);</span>
<a href="#l34.232"></a><span id="l34.232">     if (splitter &lt; 0)</span>
<a href="#l34.233"></a><span id="l34.233">     {</span>
<a href="#l34.234"></a><span id="l34.234">       // _queryString already set in ctor</span>
<a href="#l34.235"></a><span id="l34.235">       metadata._path = fullPath;</span>
<a href="#l34.236"></a><span id="l34.236">     }</span>
<a href="#l34.237"></a><span id="l34.237" class="difflineat">@@ -1708,45 +1761,48 @@ RequestReader.prototype =</span>
<a href="#l34.238"></a><span id="l34.238"> </span>
<a href="#l34.239"></a><span id="l34.239">     var headers = this._metadata._headers;</span>
<a href="#l34.240"></a><span id="l34.240">     var lastName = this._lastHeaderName;</span>
<a href="#l34.241"></a><span id="l34.241">     var lastVal = this._lastHeaderValue;</span>
<a href="#l34.242"></a><span id="l34.242"> </span>
<a href="#l34.243"></a><span id="l34.243">     var line = {};</span>
<a href="#l34.244"></a><span id="l34.244">     while (true)</span>
<a href="#l34.245"></a><span id="l34.245">     {</span>
<a href="#l34.246"></a><span id="l34.246" class="difflineplus">+      dumpn(&quot;*** Last name: '&quot; + lastName + &quot;'&quot;);</span>
<a href="#l34.247"></a><span id="l34.247" class="difflineplus">+      dumpn(&quot;*** Last val: '&quot; + lastVal + &quot;'&quot;);</span>
<a href="#l34.248"></a><span id="l34.248">       NS_ASSERT(!((lastVal === undefined) ^ (lastName === undefined)),</span>
<a href="#l34.249"></a><span id="l34.249">                 lastName === undefined ?</span>
<a href="#l34.250"></a><span id="l34.250">                   &quot;lastVal without lastName?  lastVal: '&quot; + lastVal + &quot;'&quot; :</span>
<a href="#l34.251"></a><span id="l34.251">                   &quot;lastName without lastVal?  lastName: '&quot; + lastName + &quot;'&quot;);</span>
<a href="#l34.252"></a><span id="l34.252"> </span>
<a href="#l34.253"></a><span id="l34.253">       if (!data.readLine(line))</span>
<a href="#l34.254"></a><span id="l34.254">       {</span>
<a href="#l34.255"></a><span id="l34.255">         // save any data we have from the header we might still be processing</span>
<a href="#l34.256"></a><span id="l34.256">         this._lastHeaderName = lastName;</span>
<a href="#l34.257"></a><span id="l34.257">         this._lastHeaderValue = lastVal;</span>
<a href="#l34.258"></a><span id="l34.258">         return false;</span>
<a href="#l34.259"></a><span id="l34.259">       }</span>
<a href="#l34.260"></a><span id="l34.260"> </span>
<a href="#l34.261"></a><span id="l34.261">       var lineText = line.value;</span>
<a href="#l34.262"></a><span id="l34.262" class="difflineplus">+      dumpn(&quot;*** Line text: '&quot; + lineText + &quot;'&quot;);</span>
<a href="#l34.263"></a><span id="l34.263">       var firstChar = lineText.charAt(0);</span>
<a href="#l34.264"></a><span id="l34.264"> </span>
<a href="#l34.265"></a><span id="l34.265">       // blank line means end of headers</span>
<a href="#l34.266"></a><span id="l34.266">       if (lineText == &quot;&quot;)</span>
<a href="#l34.267"></a><span id="l34.267">       {</span>
<a href="#l34.268"></a><span id="l34.268">         // we're finished with the previous header</span>
<a href="#l34.269"></a><span id="l34.269">         if (lastName)</span>
<a href="#l34.270"></a><span id="l34.270">         {</span>
<a href="#l34.271"></a><span id="l34.271">           try</span>
<a href="#l34.272"></a><span id="l34.272">           {</span>
<a href="#l34.273"></a><span id="l34.273">             headers.setHeader(lastName, lastVal, true);</span>
<a href="#l34.274"></a><span id="l34.274">           }</span>
<a href="#l34.275"></a><span id="l34.275">           catch (e)</span>
<a href="#l34.276"></a><span id="l34.276">           {</span>
<a href="#l34.277"></a><span id="l34.277" class="difflineminus">-            dumpn(&quot;*** e == &quot; + e);</span>
<a href="#l34.278"></a><span id="l34.278" class="difflineplus">+            dumpn(&quot;*** setHeader threw on last header, e == &quot; + e);</span>
<a href="#l34.279"></a><span id="l34.279">             throw HTTP_400;</span>
<a href="#l34.280"></a><span id="l34.280">           }</span>
<a href="#l34.281"></a><span id="l34.281">         }</span>
<a href="#l34.282"></a><span id="l34.282">         else</span>
<a href="#l34.283"></a><span id="l34.283">         {</span>
<a href="#l34.284"></a><span id="l34.284">           // no headers in request -- valid for HTTP/1.0 requests</span>
<a href="#l34.285"></a><span id="l34.285">         }</span>
<a href="#l34.286"></a><span id="l34.286"> </span>
<a href="#l34.287"></a><span id="l34.287" class="difflineat">@@ -1754,17 +1810,17 @@ RequestReader.prototype =</span>
<a href="#l34.288"></a><span id="l34.288">         this._state = READER_IN_BODY;</span>
<a href="#l34.289"></a><span id="l34.289">         return true;</span>
<a href="#l34.290"></a><span id="l34.290">       }</span>
<a href="#l34.291"></a><span id="l34.291">       else if (firstChar == &quot; &quot; || firstChar == &quot;\t&quot;)</span>
<a href="#l34.292"></a><span id="l34.292">       {</span>
<a href="#l34.293"></a><span id="l34.293">         // multi-line header if we've already seen a header line</span>
<a href="#l34.294"></a><span id="l34.294">         if (!lastName)</span>
<a href="#l34.295"></a><span id="l34.295">         {</span>
<a href="#l34.296"></a><span id="l34.296" class="difflineminus">-          // we don't have a header to continue!</span>
<a href="#l34.297"></a><span id="l34.297" class="difflineplus">+          dumpn(&quot;We don't have a header to continue!&quot;);</span>
<a href="#l34.298"></a><span id="l34.298">           throw HTTP_400;</span>
<a href="#l34.299"></a><span id="l34.299">         }</span>
<a href="#l34.300"></a><span id="l34.300"> </span>
<a href="#l34.301"></a><span id="l34.301">         // append this line's text to the value; starts with SP/HT, so no need</span>
<a href="#l34.302"></a><span id="l34.302">         // for separating whitespace</span>
<a href="#l34.303"></a><span id="l34.303">         lastVal += lineText;</span>
<a href="#l34.304"></a><span id="l34.304">       }</span>
<a href="#l34.305"></a><span id="l34.305">       else</span>
<a href="#l34.306"></a><span id="l34.306" class="difflineat">@@ -1773,25 +1829,25 @@ RequestReader.prototype =</span>
<a href="#l34.307"></a><span id="l34.307">         if (lastName)</span>
<a href="#l34.308"></a><span id="l34.308">         {</span>
<a href="#l34.309"></a><span id="l34.309">           try</span>
<a href="#l34.310"></a><span id="l34.310">           {</span>
<a href="#l34.311"></a><span id="l34.311">             headers.setHeader(lastName, lastVal, true);</span>
<a href="#l34.312"></a><span id="l34.312">           }</span>
<a href="#l34.313"></a><span id="l34.313">           catch (e)</span>
<a href="#l34.314"></a><span id="l34.314">           {</span>
<a href="#l34.315"></a><span id="l34.315" class="difflineminus">-            dumpn(&quot;*** e == &quot; + e);</span>
<a href="#l34.316"></a><span id="l34.316" class="difflineplus">+            dumpn(&quot;*** setHeader threw on a header, e == &quot; + e);</span>
<a href="#l34.317"></a><span id="l34.317">             throw HTTP_400;</span>
<a href="#l34.318"></a><span id="l34.318">           }</span>
<a href="#l34.319"></a><span id="l34.319">         }</span>
<a href="#l34.320"></a><span id="l34.320"> </span>
<a href="#l34.321"></a><span id="l34.321">         var colon = lineText.indexOf(&quot;:&quot;); // first colon must be splitter</span>
<a href="#l34.322"></a><span id="l34.322">         if (colon &lt; 1)</span>
<a href="#l34.323"></a><span id="l34.323">         {</span>
<a href="#l34.324"></a><span id="l34.324" class="difflineminus">-          // no colon or missing header field-name</span>
<a href="#l34.325"></a><span id="l34.325" class="difflineplus">+          dumpn(&quot;*** No colon or missing header field-name&quot;);</span>
<a href="#l34.326"></a><span id="l34.326">           throw HTTP_400;</span>
<a href="#l34.327"></a><span id="l34.327">         }</span>
<a href="#l34.328"></a><span id="l34.328"> </span>
<a href="#l34.329"></a><span id="l34.329">         // set header name, value (to be set in the next loop, usually)</span>
<a href="#l34.330"></a><span id="l34.330">         lastName = lineText.substring(0, colon);</span>
<a href="#l34.331"></a><span id="l34.331">         lastVal = lineText.substring(colon + 1);</span>
<a href="#l34.332"></a><span id="l34.332">       } // empty, continuation, start of header</span>
<a href="#l34.333"></a><span id="l34.333">     } // while (true)</span>
<a href="#l34.334"></a><span id="l34.334" class="difflineat">@@ -1806,48 +1862,68 @@ const CR = 0x0D, LF = 0x0A;</span>
<a href="#l34.335"></a><span id="l34.335">  * Calculates the number of characters before the first CRLF pair in array, or</span>
<a href="#l34.336"></a><span id="l34.336">  * -1 if the array contains no CRLF pair.</span>
<a href="#l34.337"></a><span id="l34.337">  *</span>
<a href="#l34.338"></a><span id="l34.338">  * @param array : Array</span>
<a href="#l34.339"></a><span id="l34.339">  *   an array of numbers in the range [0, 256), each representing a single</span>
<a href="#l34.340"></a><span id="l34.340">  *   character; the first CRLF is the lowest index i where</span>
<a href="#l34.341"></a><span id="l34.341">  *   |array[i] == &quot;\r&quot;.charCodeAt(0)| and |array[i+1] == &quot;\n&quot;.charCodeAt(0)|,</span>
<a href="#l34.342"></a><span id="l34.342">  *   if such an |i| exists, and -1 otherwise</span>
<a href="#l34.343"></a><span id="l34.343" class="difflineplus">+ * @param start : uint</span>
<a href="#l34.344"></a><span id="l34.344" class="difflineplus">+ *   start index from which to begin searching in array</span>
<a href="#l34.345"></a><span id="l34.345">  * @returns int</span>
<a href="#l34.346"></a><span id="l34.346">  *   the index of the first CRLF if any were present, -1 otherwise</span>
<a href="#l34.347"></a><span id="l34.347">  */</span>
<a href="#l34.348"></a><span id="l34.348" class="difflineminus">-function findCRLF(array)</span>
<a href="#l34.349"></a><span id="l34.349" class="difflineplus">+function findCRLF(array, start)</span>
<a href="#l34.350"></a><span id="l34.350"> {</span>
<a href="#l34.351"></a><span id="l34.351" class="difflineminus">-  for (var i = array.indexOf(CR); i &gt;= 0; i = array.indexOf(CR, i + 1))</span>
<a href="#l34.352"></a><span id="l34.352" class="difflineplus">+  for (var i = array.indexOf(CR, start); i &gt;= 0; i = array.indexOf(CR, i + 1))</span>
<a href="#l34.353"></a><span id="l34.353">   {</span>
<a href="#l34.354"></a><span id="l34.354">     if (array[i + 1] == LF)</span>
<a href="#l34.355"></a><span id="l34.355">       return i;</span>
<a href="#l34.356"></a><span id="l34.356">   }</span>
<a href="#l34.357"></a><span id="l34.357">   return -1;</span>
<a href="#l34.358"></a><span id="l34.358"> }</span>
<a href="#l34.359"></a><span id="l34.359"> </span>
<a href="#l34.360"></a><span id="l34.360"> </span>
<a href="#l34.361"></a><span id="l34.361"> /**</span>
<a href="#l34.362"></a><span id="l34.362">  * A container which provides line-by-line access to the arrays of bytes with</span>
<a href="#l34.363"></a><span id="l34.363">  * which it is seeded.</span>
<a href="#l34.364"></a><span id="l34.364">  */</span>
<a href="#l34.365"></a><span id="l34.365"> function LineData()</span>
<a href="#l34.366"></a><span id="l34.366"> {</span>
<a href="#l34.367"></a><span id="l34.367">   /** An array of queued bytes from which to get line-based characters. */</span>
<a href="#l34.368"></a><span id="l34.368">   this._data = [];</span>
<a href="#l34.369"></a><span id="l34.369" class="difflineplus">+</span>
<a href="#l34.370"></a><span id="l34.370" class="difflineplus">+  /** Start index from which to search for CRLF. */</span>
<a href="#l34.371"></a><span id="l34.371" class="difflineplus">+  this._start = 0;</span>
<a href="#l34.372"></a><span id="l34.372"> }</span>
<a href="#l34.373"></a><span id="l34.373"> LineData.prototype =</span>
<a href="#l34.374"></a><span id="l34.374"> {</span>
<a href="#l34.375"></a><span id="l34.375">   /**</span>
<a href="#l34.376"></a><span id="l34.376">    * Appends the bytes in the given array to the internal data cache maintained</span>
<a href="#l34.377"></a><span id="l34.377">    * by this.</span>
<a href="#l34.378"></a><span id="l34.378">    */</span>
<a href="#l34.379"></a><span id="l34.379">   appendBytes: function(bytes)</span>
<a href="#l34.380"></a><span id="l34.380">   {</span>
<a href="#l34.381"></a><span id="l34.381" class="difflineminus">-    Array.prototype.push.apply(this._data, bytes);</span>
<a href="#l34.382"></a><span id="l34.382" class="difflineplus">+    var count = bytes.length;</span>
<a href="#l34.383"></a><span id="l34.383" class="difflineplus">+    var quantum = 262144; // just above half SpiderMonkey's argument-count limit</span>
<a href="#l34.384"></a><span id="l34.384" class="difflineplus">+    if (count &lt; quantum)</span>
<a href="#l34.385"></a><span id="l34.385" class="difflineplus">+    {</span>
<a href="#l34.386"></a><span id="l34.386" class="difflineplus">+      Array.prototype.push.apply(this._data, bytes);</span>
<a href="#l34.387"></a><span id="l34.387" class="difflineplus">+      return;</span>
<a href="#l34.388"></a><span id="l34.388" class="difflineplus">+    }</span>
<a href="#l34.389"></a><span id="l34.389" class="difflineplus">+</span>
<a href="#l34.390"></a><span id="l34.390" class="difflineplus">+    // Large numbers of bytes may cause Array.prototype.push to be called with</span>
<a href="#l34.391"></a><span id="l34.391" class="difflineplus">+    // more arguments than the JavaScript engine supports.  In that case append</span>
<a href="#l34.392"></a><span id="l34.392" class="difflineplus">+    // bytes in fixed-size amounts until all bytes are appended.</span>
<a href="#l34.393"></a><span id="l34.393" class="difflineplus">+    for (var start = 0; start &lt; count; start += quantum)</span>
<a href="#l34.394"></a><span id="l34.394" class="difflineplus">+    {</span>
<a href="#l34.395"></a><span id="l34.395" class="difflineplus">+      var slice = bytes.slice(start, Math.min(start + quantum, count));</span>
<a href="#l34.396"></a><span id="l34.396" class="difflineplus">+      Array.prototype.push.apply(this._data, slice);</span>
<a href="#l34.397"></a><span id="l34.397" class="difflineplus">+    }</span>
<a href="#l34.398"></a><span id="l34.398">   },</span>
<a href="#l34.399"></a><span id="l34.399"> </span>
<a href="#l34.400"></a><span id="l34.400">   /**</span>
<a href="#l34.401"></a><span id="l34.401">    * Removes and returns a line of data, delimited by CRLF, from this.</span>
<a href="#l34.402"></a><span id="l34.402">    *</span>
<a href="#l34.403"></a><span id="l34.403">    * @param out</span>
<a href="#l34.404"></a><span id="l34.404">    *   an object whose &quot;value&quot; property will be set to the first line of text</span>
<a href="#l34.405"></a><span id="l34.405">    *   present in this, sans CRLF, if this contains a full CRLF-delimited line</span>
<a href="#l34.406"></a><span id="l34.406" class="difflineat">@@ -1855,33 +1931,48 @@ LineData.prototype =</span>
<a href="#l34.407"></a><span id="l34.407">    *   is undefined</span>
<a href="#l34.408"></a><span id="l34.408">    * @returns boolean</span>
<a href="#l34.409"></a><span id="l34.409">    *   true if a full line of data could be read from the data in this, false</span>
<a href="#l34.410"></a><span id="l34.410">    *   otherwise</span>
<a href="#l34.411"></a><span id="l34.411">    */</span>
<a href="#l34.412"></a><span id="l34.412">   readLine: function(out)</span>
<a href="#l34.413"></a><span id="l34.413">   {</span>
<a href="#l34.414"></a><span id="l34.414">     var data = this._data;</span>
<a href="#l34.415"></a><span id="l34.415" class="difflineminus">-    var length = findCRLF(data);</span>
<a href="#l34.416"></a><span id="l34.416" class="difflineplus">+    var length = findCRLF(data, this._start);</span>
<a href="#l34.417"></a><span id="l34.417">     if (length &lt; 0)</span>
<a href="#l34.418"></a><span id="l34.418" class="difflineplus">+    {</span>
<a href="#l34.419"></a><span id="l34.419" class="difflineplus">+      this._start = data.length;</span>
<a href="#l34.420"></a><span id="l34.420" class="difflineplus">+</span>
<a href="#l34.421"></a><span id="l34.421" class="difflineplus">+      // But if our data ends in a CR, we have to back up one, because</span>
<a href="#l34.422"></a><span id="l34.422" class="difflineplus">+      // the first byte in the next packet might be an LF and if we</span>
<a href="#l34.423"></a><span id="l34.423" class="difflineplus">+      // start looking at data.length we won't find it.</span>
<a href="#l34.424"></a><span id="l34.424" class="difflineplus">+      if (data.length &gt; 0 &amp;&amp; data[data.length - 1] === CR)</span>
<a href="#l34.425"></a><span id="l34.425" class="difflineplus">+        --this._start;</span>
<a href="#l34.426"></a><span id="l34.426" class="difflineplus">+</span>
<a href="#l34.427"></a><span id="l34.427">       return false;</span>
<a href="#l34.428"></a><span id="l34.428" class="difflineplus">+    }</span>
<a href="#l34.429"></a><span id="l34.429" class="difflineplus">+</span>
<a href="#l34.430"></a><span id="l34.430" class="difflineplus">+    // Reset for future lines.</span>
<a href="#l34.431"></a><span id="l34.431" class="difflineplus">+    this._start = 0;</span>
<a href="#l34.432"></a><span id="l34.432"> </span>
<a href="#l34.433"></a><span id="l34.433">     //</span>
<a href="#l34.434"></a><span id="l34.434">     // We have the index of the CR, so remove all the characters, including</span>
<a href="#l34.435"></a><span id="l34.435" class="difflineminus">-    // CRLF, from the array with splice, and convert the removed array into the</span>
<a href="#l34.436"></a><span id="l34.436" class="difflineminus">-    // corresponding string, from which we then strip the trailing CRLF.</span>
<a href="#l34.437"></a><span id="l34.437" class="difflineplus">+    // CRLF, from the array with splice, and convert the removed array</span>
<a href="#l34.438"></a><span id="l34.438" class="difflineplus">+    // (excluding the trailing CRLF characters) into the corresponding string.</span>
<a href="#l34.439"></a><span id="l34.439">     //</span>
<a href="#l34.440"></a><span id="l34.440" class="difflineminus">-    // Getting the line in this matter acknowledges that substring is an O(1)</span>
<a href="#l34.441"></a><span id="l34.441" class="difflineminus">-    // operation in SpiderMonkey because strings are immutable, whereas two</span>
<a href="#l34.442"></a><span id="l34.442" class="difflineminus">-    // splices, both from the beginning of the data, are less likely to be as</span>
<a href="#l34.443"></a><span id="l34.443" class="difflineminus">-    // cheap as a single splice plus two extra character conversions.</span>
<a href="#l34.444"></a><span id="l34.444" class="difflineminus">-    //</span>
<a href="#l34.445"></a><span id="l34.445" class="difflineminus">-    var line = String.fromCharCode.apply(null, data.splice(0, length + 2));</span>
<a href="#l34.446"></a><span id="l34.446" class="difflineminus">-    out.value = line.substring(0, length);</span>
<a href="#l34.447"></a><span id="l34.447" class="difflineminus">-</span>
<a href="#l34.448"></a><span id="l34.448" class="difflineplus">+    var leading = data.splice(0, length + 2);</span>
<a href="#l34.449"></a><span id="l34.449" class="difflineplus">+    var quantum = 262144;</span>
<a href="#l34.450"></a><span id="l34.450" class="difflineplus">+    var line = &quot;&quot;;</span>
<a href="#l34.451"></a><span id="l34.451" class="difflineplus">+    for (var start = 0; start &lt; length; start += quantum)</span>
<a href="#l34.452"></a><span id="l34.452" class="difflineplus">+    {</span>
<a href="#l34.453"></a><span id="l34.453" class="difflineplus">+      var slice = leading.slice(start, Math.min(start + quantum, length));</span>
<a href="#l34.454"></a><span id="l34.454" class="difflineplus">+      line += String.fromCharCode.apply(null, slice);</span>
<a href="#l34.455"></a><span id="l34.455" class="difflineplus">+    }</span>
<a href="#l34.456"></a><span id="l34.456" class="difflineplus">+</span>
<a href="#l34.457"></a><span id="l34.457" class="difflineplus">+    out.value = line;</span>
<a href="#l34.458"></a><span id="l34.458">     return true;</span>
<a href="#l34.459"></a><span id="l34.459">   },</span>
<a href="#l34.460"></a><span id="l34.460"> </span>
<a href="#l34.461"></a><span id="l34.461">   /**</span>
<a href="#l34.462"></a><span id="l34.462">    * Removes the bytes currently within this and returns them in an array.</span>
<a href="#l34.463"></a><span id="l34.463">    *</span>
<a href="#l34.464"></a><span id="l34.464">    * @returns Array</span>
<a href="#l34.465"></a><span id="l34.465">    *   the bytes within this when this method is called</span>
<a href="#l34.466"></a><span id="l34.466" class="difflineat">@@ -2143,17 +2234,26 @@ function ServerHandler(server)</span>
<a href="#l34.467"></a><span id="l34.467"> </span>
<a href="#l34.468"></a><span id="l34.468">   /**</span>
<a href="#l34.469"></a><span id="l34.469">    * Custom request handlers for the server in which this resides.  Path-handler</span>
<a href="#l34.470"></a><span id="l34.470">    * pairs are stored as property-value pairs in this property.</span>
<a href="#l34.471"></a><span id="l34.471">    *</span>
<a href="#l34.472"></a><span id="l34.472">    * @see ServerHandler.prototype._defaultPaths</span>
<a href="#l34.473"></a><span id="l34.473">    */</span>
<a href="#l34.474"></a><span id="l34.474">   this._overridePaths = {};</span>
<a href="#l34.475"></a><span id="l34.475" class="difflineminus">-  </span>
<a href="#l34.476"></a><span id="l34.476" class="difflineplus">+</span>
<a href="#l34.477"></a><span id="l34.477" class="difflineplus">+  /**</span>
<a href="#l34.478"></a><span id="l34.478" class="difflineplus">+   * Custom request handlers for the path prefixes on the server in which this</span>
<a href="#l34.479"></a><span id="l34.479" class="difflineplus">+   * resides.  Path-handler pairs are stored as property-value pairs in this</span>
<a href="#l34.480"></a><span id="l34.480" class="difflineplus">+   * property.</span>
<a href="#l34.481"></a><span id="l34.481" class="difflineplus">+   *</span>
<a href="#l34.482"></a><span id="l34.482" class="difflineplus">+   * @see ServerHandler.prototype._defaultPaths</span>
<a href="#l34.483"></a><span id="l34.483" class="difflineplus">+   */</span>
<a href="#l34.484"></a><span id="l34.484" class="difflineplus">+  this._overridePrefixes = {};</span>
<a href="#l34.485"></a><span id="l34.485" class="difflineplus">+</span>
<a href="#l34.486"></a><span id="l34.486">   /**</span>
<a href="#l34.487"></a><span id="l34.487">    * Custom request handlers for the error handlers in the server in which this</span>
<a href="#l34.488"></a><span id="l34.488">    * resides.  Path-handler pairs are stored as property-value pairs in this</span>
<a href="#l34.489"></a><span id="l34.489">    * property.</span>
<a href="#l34.490"></a><span id="l34.490">    *</span>
<a href="#l34.491"></a><span id="l34.491">    * @see ServerHandler.prototype._defaultErrors</span>
<a href="#l34.492"></a><span id="l34.492">    */</span>
<a href="#l34.493"></a><span id="l34.493">   this._overrideErrors = {};</span>
<a href="#l34.494"></a><span id="l34.494" class="difflineat">@@ -2208,17 +2308,33 @@ ServerHandler.prototype =</span>
<a href="#l34.495"></a><span id="l34.495">         {</span>
<a href="#l34.496"></a><span id="l34.496">           // explicit paths first, then files based on existing directory mappings,</span>
<a href="#l34.497"></a><span id="l34.497">           // then (if the file doesn't exist) built-in server default paths</span>
<a href="#l34.498"></a><span id="l34.498">           dumpn(&quot;calling override for &quot; + path);</span>
<a href="#l34.499"></a><span id="l34.499">           this._overridePaths[path](request, response);</span>
<a href="#l34.500"></a><span id="l34.500">         }</span>
<a href="#l34.501"></a><span id="l34.501">         else</span>
<a href="#l34.502"></a><span id="l34.502">         {</span>
<a href="#l34.503"></a><span id="l34.503" class="difflineminus">-          this._handleDefault(request, response);</span>
<a href="#l34.504"></a><span id="l34.504" class="difflineplus">+          var longestPrefix = &quot;&quot;;</span>
<a href="#l34.505"></a><span id="l34.505" class="difflineplus">+          for (let prefix in this._overridePrefixes) {</span>
<a href="#l34.506"></a><span id="l34.506" class="difflineplus">+            if (prefix.length &gt; longestPrefix.length &amp;&amp;</span>
<a href="#l34.507"></a><span id="l34.507" class="difflineplus">+                path.substr(0, prefix.length) == prefix)</span>
<a href="#l34.508"></a><span id="l34.508" class="difflineplus">+            {</span>
<a href="#l34.509"></a><span id="l34.509" class="difflineplus">+              longestPrefix = prefix;</span>
<a href="#l34.510"></a><span id="l34.510" class="difflineplus">+            }</span>
<a href="#l34.511"></a><span id="l34.511" class="difflineplus">+          }</span>
<a href="#l34.512"></a><span id="l34.512" class="difflineplus">+          if (longestPrefix.length &gt; 0)</span>
<a href="#l34.513"></a><span id="l34.513" class="difflineplus">+          {</span>
<a href="#l34.514"></a><span id="l34.514" class="difflineplus">+            dumpn(&quot;calling prefix override for &quot; + longestPrefix);</span>
<a href="#l34.515"></a><span id="l34.515" class="difflineplus">+            this._overridePrefixes[longestPrefix](request, response);</span>
<a href="#l34.516"></a><span id="l34.516" class="difflineplus">+          }</span>
<a href="#l34.517"></a><span id="l34.517" class="difflineplus">+          else</span>
<a href="#l34.518"></a><span id="l34.518" class="difflineplus">+          {</span>
<a href="#l34.519"></a><span id="l34.519" class="difflineplus">+            this._handleDefault(request, response);</span>
<a href="#l34.520"></a><span id="l34.520" class="difflineplus">+          }</span>
<a href="#l34.521"></a><span id="l34.521">         }</span>
<a href="#l34.522"></a><span id="l34.522">       }</span>
<a href="#l34.523"></a><span id="l34.523">       catch (e)</span>
<a href="#l34.524"></a><span id="l34.524">       {</span>
<a href="#l34.525"></a><span id="l34.525">         if (response.partiallySent())</span>
<a href="#l34.526"></a><span id="l34.526">         {</span>
<a href="#l34.527"></a><span id="l34.527">           response.abort(e);</span>
<a href="#l34.528"></a><span id="l34.528">           return;</span>
<a href="#l34.529"></a><span id="l34.529" class="difflineat">@@ -2314,16 +2430,28 @@ ServerHandler.prototype =</span>
<a href="#l34.530"></a><span id="l34.530">     // XXX true path validation!</span>
<a href="#l34.531"></a><span id="l34.531">     if (path.charAt(0) != &quot;/&quot;)</span>
<a href="#l34.532"></a><span id="l34.532">       throw Cr.NS_ERROR_INVALID_ARG;</span>
<a href="#l34.533"></a><span id="l34.533"> </span>
<a href="#l34.534"></a><span id="l34.534">     this._handlerToField(handler, this._overridePaths, path);</span>
<a href="#l34.535"></a><span id="l34.535">   },</span>
<a href="#l34.536"></a><span id="l34.536"> </span>
<a href="#l34.537"></a><span id="l34.537">   //</span>
<a href="#l34.538"></a><span id="l34.538" class="difflineplus">+  // see nsIHttpServer.registerPrefixHandler</span>
<a href="#l34.539"></a><span id="l34.539" class="difflineplus">+  //</span>
<a href="#l34.540"></a><span id="l34.540" class="difflineplus">+  registerPrefixHandler: function(path, handler)</span>
<a href="#l34.541"></a><span id="l34.541" class="difflineplus">+  {</span>
<a href="#l34.542"></a><span id="l34.542" class="difflineplus">+    // XXX true path validation!</span>
<a href="#l34.543"></a><span id="l34.543" class="difflineplus">+    if (path.charAt(0) != &quot;/&quot; || path.charAt(path.length - 1) != &quot;/&quot;)</span>
<a href="#l34.544"></a><span id="l34.544" class="difflineplus">+      throw Cr.NS_ERROR_INVALID_ARG;</span>
<a href="#l34.545"></a><span id="l34.545" class="difflineplus">+</span>
<a href="#l34.546"></a><span id="l34.546" class="difflineplus">+    this._handlerToField(handler, this._overridePrefixes, path);</span>
<a href="#l34.547"></a><span id="l34.547" class="difflineplus">+  },</span>
<a href="#l34.548"></a><span id="l34.548" class="difflineplus">+</span>
<a href="#l34.549"></a><span id="l34.549" class="difflineplus">+  //</span>
<a href="#l34.550"></a><span id="l34.550">   // see nsIHttpServer.registerDirectory</span>
<a href="#l34.551"></a><span id="l34.551">   //</span>
<a href="#l34.552"></a><span id="l34.552">   registerDirectory: function(path, directory)</span>
<a href="#l34.553"></a><span id="l34.553">   {</span>
<a href="#l34.554"></a><span id="l34.554">     // strip off leading and trailing '/' so that we can use lastIndexOf when</span>
<a href="#l34.555"></a><span id="l34.555">     // determining exactly how a path maps onto a mapped directory --</span>
<a href="#l34.556"></a><span id="l34.556">     // conditional is required here to deal with &quot;/&quot;.substring(1, 0) being</span>
<a href="#l34.557"></a><span id="l34.557">     // converted to &quot;/&quot;.substring(0, 1) per the JS specification</span>
<a href="#l34.558"></a><span id="l34.558" class="difflineat">@@ -2453,26 +2581,32 @@ ServerHandler.prototype =</span>
<a href="#l34.559"></a><span id="l34.559"> </span>
<a href="#l34.560"></a><span id="l34.560">     var start, end;</span>
<a href="#l34.561"></a><span id="l34.561">     if (metadata._httpVersion.atLeast(nsHttpVersion.HTTP_1_1) &amp;&amp;</span>
<a href="#l34.562"></a><span id="l34.562">         metadata.hasHeader(&quot;Range&quot;) &amp;&amp;</span>
<a href="#l34.563"></a><span id="l34.563">         this._getTypeFromFile(file) !== SJS_TYPE)</span>
<a href="#l34.564"></a><span id="l34.564">     {</span>
<a href="#l34.565"></a><span id="l34.565">       var rangeMatch = metadata.getHeader(&quot;Range&quot;).match(/^bytes=(\d+)?-(\d+)?$/);</span>
<a href="#l34.566"></a><span id="l34.566">       if (!rangeMatch)</span>
<a href="#l34.567"></a><span id="l34.567" class="difflineplus">+      {</span>
<a href="#l34.568"></a><span id="l34.568" class="difflineplus">+        dumpn(&quot;*** Range header bogosity: '&quot; + metadata.getHeader(&quot;Range&quot;) + &quot;'&quot;);</span>
<a href="#l34.569"></a><span id="l34.569">         throw HTTP_400;</span>
<a href="#l34.570"></a><span id="l34.570" class="difflineplus">+      }</span>
<a href="#l34.571"></a><span id="l34.571"> </span>
<a href="#l34.572"></a><span id="l34.572">       if (rangeMatch[1] !== undefined)</span>
<a href="#l34.573"></a><span id="l34.573">         start = parseInt(rangeMatch[1], 10);</span>
<a href="#l34.574"></a><span id="l34.574"> </span>
<a href="#l34.575"></a><span id="l34.575">       if (rangeMatch[2] !== undefined)</span>
<a href="#l34.576"></a><span id="l34.576">         end = parseInt(rangeMatch[2], 10);</span>
<a href="#l34.577"></a><span id="l34.577"> </span>
<a href="#l34.578"></a><span id="l34.578">       if (start === undefined &amp;&amp; end === undefined)</span>
<a href="#l34.579"></a><span id="l34.579" class="difflineplus">+      {</span>
<a href="#l34.580"></a><span id="l34.580" class="difflineplus">+        dumpn(&quot;*** More Range header bogosity: '&quot; + metadata.getHeader(&quot;Range&quot;) + &quot;'&quot;);</span>
<a href="#l34.581"></a><span id="l34.581">         throw HTTP_400;</span>
<a href="#l34.582"></a><span id="l34.582" class="difflineplus">+      }</span>
<a href="#l34.583"></a><span id="l34.583"> </span>
<a href="#l34.584"></a><span id="l34.584">       // No start given, so the end is really the count of bytes from the</span>
<a href="#l34.585"></a><span id="l34.585">       // end of the file.</span>
<a href="#l34.586"></a><span id="l34.586">       if (start === undefined)</span>
<a href="#l34.587"></a><span id="l34.587">       {</span>
<a href="#l34.588"></a><span id="l34.588">         start = Math.max(0, file.fileSize - end);</span>
<a href="#l34.589"></a><span id="l34.589">         end   = file.fileSize - 1;</span>
<a href="#l34.590"></a><span id="l34.590">       }</span>
<a href="#l34.591"></a><span id="l34.591" class="difflineat">@@ -2569,16 +2703,20 @@ ServerHandler.prototype =</span>
<a href="#l34.592"></a><span id="l34.592">         s.importFunction(function getObjectState(k, callback)</span>
<a href="#l34.593"></a><span id="l34.593">         {</span>
<a href="#l34.594"></a><span id="l34.594">           callback(self._getObjectState(k));</span>
<a href="#l34.595"></a><span id="l34.595">         });</span>
<a href="#l34.596"></a><span id="l34.596">         s.importFunction(function setObjectState(k, v)</span>
<a href="#l34.597"></a><span id="l34.597">         {</span>
<a href="#l34.598"></a><span id="l34.598">           self._setObjectState(k, v);</span>
<a href="#l34.599"></a><span id="l34.599">         });</span>
<a href="#l34.600"></a><span id="l34.600" class="difflineplus">+        s.importFunction(function registerPathHandler(p, h)</span>
<a href="#l34.601"></a><span id="l34.601" class="difflineplus">+        {</span>
<a href="#l34.602"></a><span id="l34.602" class="difflineplus">+          self.registerPathHandler(p, h);</span>
<a href="#l34.603"></a><span id="l34.603" class="difflineplus">+        });</span>
<a href="#l34.604"></a><span id="l34.604"> </span>
<a href="#l34.605"></a><span id="l34.605">         // Make it possible for sjs files to access their location</span>
<a href="#l34.606"></a><span id="l34.606">         this._setState(path, &quot;__LOCATION__&quot;, file.path);</span>
<a href="#l34.607"></a><span id="l34.607"> </span>
<a href="#l34.608"></a><span id="l34.608">         try</span>
<a href="#l34.609"></a><span id="l34.609">         {</span>
<a href="#l34.610"></a><span id="l34.610">           // Alas, the line number in errors dumped to console when calling the</span>
<a href="#l34.611"></a><span id="l34.611">           // request handler is simply an offset from where we load the SJS file.</span>
<a href="#l34.612"></a><span id="l34.612" class="difflineat">@@ -2873,16 +3011,17 @@ ServerHandler.prototype =</span>
<a href="#l34.613"></a><span id="l34.613">   {</span>
<a href="#l34.614"></a><span id="l34.614">     // decode and add underscores as necessary</span>
<a href="#l34.615"></a><span id="l34.615">     try</span>
<a href="#l34.616"></a><span id="l34.616">     {</span>
<a href="#l34.617"></a><span id="l34.617">       path = toInternalPath(path, true);</span>
<a href="#l34.618"></a><span id="l34.618">     }</span>
<a href="#l34.619"></a><span id="l34.619">     catch (e)</span>
<a href="#l34.620"></a><span id="l34.620">     {</span>
<a href="#l34.621"></a><span id="l34.621" class="difflineplus">+      dumpn(&quot;*** toInternalPath threw &quot; + e);</span>
<a href="#l34.622"></a><span id="l34.622">       throw HTTP_400; // malformed path</span>
<a href="#l34.623"></a><span id="l34.623">     }</span>
<a href="#l34.624"></a><span id="l34.624"> </span>
<a href="#l34.625"></a><span id="l34.625">     // next, get the directory which contains this path</span>
<a href="#l34.626"></a><span id="l34.626">     var pathMap = this._pathDirectoryMap;</span>
<a href="#l34.627"></a><span id="l34.627"> </span>
<a href="#l34.628"></a><span id="l34.628">     // An example progression of tmp for a path &quot;/foo/bar/baz/&quot; might be:</span>
<a href="#l34.629"></a><span id="l34.629">     // &quot;foo/bar/baz/&quot;, &quot;foo/bar/baz&quot;, &quot;foo/bar&quot;, &quot;foo&quot;, &quot;&quot;</span>
<a href="#l34.630"></a><span id="l34.630" class="difflineat">@@ -4564,17 +4703,20 @@ const headerUtils =</span>
<a href="#l34.631"></a><span id="l34.631">    *   if fieldName does not match the field-name production in RFC 2616</span>
<a href="#l34.632"></a><span id="l34.632">    * @returns string</span>
<a href="#l34.633"></a><span id="l34.633">    *   fieldName converted to lowercase if it is a valid header, for characters</span>
<a href="#l34.634"></a><span id="l34.634">    *   where case conversion is possible</span>
<a href="#l34.635"></a><span id="l34.635">    */</span>
<a href="#l34.636"></a><span id="l34.636">   normalizeFieldName: function(fieldName)</span>
<a href="#l34.637"></a><span id="l34.637">   {</span>
<a href="#l34.638"></a><span id="l34.638">     if (fieldName == &quot;&quot;)</span>
<a href="#l34.639"></a><span id="l34.639" class="difflineplus">+    {</span>
<a href="#l34.640"></a><span id="l34.640" class="difflineplus">+      dumpn(&quot;*** Empty fieldName&quot;);</span>
<a href="#l34.641"></a><span id="l34.641">       throw Cr.NS_ERROR_INVALID_ARG;</span>
<a href="#l34.642"></a><span id="l34.642" class="difflineplus">+    }</span>
<a href="#l34.643"></a><span id="l34.643"> </span>
<a href="#l34.644"></a><span id="l34.644">     for (var i = 0, sz = fieldName.length; i &lt; sz; i++)</span>
<a href="#l34.645"></a><span id="l34.645">     {</span>
<a href="#l34.646"></a><span id="l34.646">       if (!IS_TOKEN_ARRAY[fieldName.charCodeAt(i)])</span>
<a href="#l34.647"></a><span id="l34.647">       {</span>
<a href="#l34.648"></a><span id="l34.648">         dumpn(fieldName + &quot; is not a valid header field name!&quot;);</span>
<a href="#l34.649"></a><span id="l34.649">         throw Cr.NS_ERROR_INVALID_ARG;</span>
<a href="#l34.650"></a><span id="l34.650">       }</span>
<a href="#l34.651"></a><span id="l34.651" class="difflineat">@@ -4615,19 +4757,23 @@ const headerUtils =</span>
<a href="#l34.652"></a><span id="l34.652">     // SP before interpreting the field value or forwarding the message</span>
<a href="#l34.653"></a><span id="l34.653">     // downstream (section 4.2); we replace 1*LWS with a single SP</span>
<a href="#l34.654"></a><span id="l34.654">     var val = fieldValue.replace(/(?:(?:\r\n)?[ \t]+)+/g, &quot; &quot;);</span>
<a href="#l34.655"></a><span id="l34.655"> </span>
<a href="#l34.656"></a><span id="l34.656">     // remove leading/trailing LWS (which has been converted to SP)</span>
<a href="#l34.657"></a><span id="l34.657">     val = val.replace(/^ +/, &quot;&quot;).replace(/ +$/, &quot;&quot;);</span>
<a href="#l34.658"></a><span id="l34.658"> </span>
<a href="#l34.659"></a><span id="l34.659">     // that should have taken care of all CTLs, so val should contain no CTLs</span>
<a href="#l34.660"></a><span id="l34.660" class="difflineplus">+    dumpn(&quot;*** Normalized value: '&quot; + val + &quot;'&quot;);</span>
<a href="#l34.661"></a><span id="l34.661">     for (var i = 0, len = val.length; i &lt; len; i++)</span>
<a href="#l34.662"></a><span id="l34.662">       if (isCTL(val.charCodeAt(i)))</span>
<a href="#l34.663"></a><span id="l34.663" class="difflineplus">+      {</span>
<a href="#l34.664"></a><span id="l34.664" class="difflineplus">+        dump(&quot;*** Char &quot; + i + &quot; has charcode &quot; + val.charCodeAt(i));</span>
<a href="#l34.665"></a><span id="l34.665">         throw Cr.NS_ERROR_INVALID_ARG;</span>
<a href="#l34.666"></a><span id="l34.666" class="difflineplus">+      }</span>
<a href="#l34.667"></a><span id="l34.667"> </span>
<a href="#l34.668"></a><span id="l34.668">     // XXX disallows quoted-pair where CHAR is a CTL -- will not invalidly</span>
<a href="#l34.669"></a><span id="l34.669">     //     normalize, however, so this can be construed as a tightening of the</span>
<a href="#l34.670"></a><span id="l34.670">     //     spec and not entirely as a bug</span>
<a href="#l34.671"></a><span id="l34.671">     return val;</span>
<a href="#l34.672"></a><span id="l34.672">   }</span>
<a href="#l34.673"></a><span id="l34.673"> };</span>
<a href="#l34.674"></a><span id="l34.674"> </span>
<a href="#l34.675"></a><span id="l34.675" class="difflineat">@@ -5081,20 +5227,18 @@ Request.prototype =</span>
<a href="#l34.676"></a><span id="l34.676">   {</span>
<a href="#l34.677"></a><span id="l34.677">     if (!this._bag)</span>
<a href="#l34.678"></a><span id="l34.678">       this._bag = new WritablePropertyBag();</span>
<a href="#l34.679"></a><span id="l34.679">   }</span>
<a href="#l34.680"></a><span id="l34.680"> };</span>
<a href="#l34.681"></a><span id="l34.681"> </span>
<a href="#l34.682"></a><span id="l34.682"> </span>
<a href="#l34.683"></a><span id="l34.683"> // XPCOM trappings</span>
<a href="#l34.684"></a><span id="l34.684" class="difflineminus">-if (XPCOMUtils.generateNSGetFactory)</span>
<a href="#l34.685"></a><span id="l34.685" class="difflineminus">-  var NSGetFactory = XPCOMUtils.generateNSGetFactory([nsHttpServer]);</span>
<a href="#l34.686"></a><span id="l34.686" class="difflineminus">-else</span>
<a href="#l34.687"></a><span id="l34.687" class="difflineminus">-  var NSGetModule = XPCOMUtils.generateNSGetModule([nsHttpServer]);</span>
<a href="#l34.688"></a><span id="l34.688" class="difflineplus">+</span>
<a href="#l34.689"></a><span id="l34.689" class="difflineplus">+var NSGetFactory = XPCOMUtils.generateNSGetFactory([nsHttpServer]);</span>
<a href="#l34.690"></a><span id="l34.690"> </span>
<a href="#l34.691"></a><span id="l34.691"> /**</span>
<a href="#l34.692"></a><span id="l34.692">  * Creates a new HTTP server listening for loopback traffic on the given port,</span>
<a href="#l34.693"></a><span id="l34.693">  * starts it, and runs the server until the server processes a shutdown request,</span>
<a href="#l34.694"></a><span id="l34.694">  * spinning an event loop so that events posted by the server's socket are</span>
<a href="#l34.695"></a><span id="l34.695">  * processed.</span>
<a href="#l34.696"></a><span id="l34.696">  *</span>
<a href="#l34.697"></a><span id="l34.697">  * This method is primarily intended for use in running this script from within</span>
<a href="#l34.698"></a><span id="l34.698" class="difflineat">@@ -5142,25 +5286,8 @@ function server(port, basePath)</span>
<a href="#l34.699"></a><span id="l34.699">     thread.processNextEvent(true);</span>
<a href="#l34.700"></a><span id="l34.700"> </span>
<a href="#l34.701"></a><span id="l34.701">   // get rid of any pending requests</span>
<a href="#l34.702"></a><span id="l34.702">   while (thread.hasPendingEvents())</span>
<a href="#l34.703"></a><span id="l34.703">     thread.processNextEvent(true);</span>
<a href="#l34.704"></a><span id="l34.704"> </span>
<a href="#l34.705"></a><span id="l34.705">   DEBUG = false;</span>
<a href="#l34.706"></a><span id="l34.706"> }</span>
<a href="#l34.707"></a><span id="l34.707" class="difflineminus">-</span>
<a href="#l34.708"></a><span id="l34.708" class="difflineminus">-function getServer (port, basePath) {</span>
<a href="#l34.709"></a><span id="l34.709" class="difflineminus">-  if (basePath) {</span>
<a href="#l34.710"></a><span id="l34.710" class="difflineminus">-    var lp = Cc[&quot;@mozilla.org/file/local;1&quot;]</span>
<a href="#l34.711"></a><span id="l34.711" class="difflineminus">-               .createInstance(Ci.nsILocalFile);</span>
<a href="#l34.712"></a><span id="l34.712" class="difflineminus">-    lp.initWithPath(basePath);</span>
<a href="#l34.713"></a><span id="l34.713" class="difflineminus">-   }</span>
<a href="#l34.714"></a><span id="l34.714" class="difflineminus">-</span>
<a href="#l34.715"></a><span id="l34.715" class="difflineminus">-   var srv = new nsHttpServer();</span>
<a href="#l34.716"></a><span id="l34.716" class="difflineminus">-   if (lp)</span>
<a href="#l34.717"></a><span id="l34.717" class="difflineminus">-     srv.registerDirectory(&quot;/&quot;, lp);</span>
<a href="#l34.718"></a><span id="l34.718" class="difflineminus">-   srv.registerContentType(&quot;sjs&quot;, SJS_TYPE);</span>
<a href="#l34.719"></a><span id="l34.719" class="difflineminus">-   srv.identity.setPrimary(&quot;http&quot;, &quot;localhost&quot;, port);</span>
<a href="#l34.720"></a><span id="l34.720" class="difflineminus">-   srv._port = port;</span>
<a href="#l34.721"></a><span id="l34.721" class="difflineminus">-</span>
<a href="#l34.722"></a><span id="l34.722" class="difflineminus">-   return srv;</span>
<a href="#l34.723"></a><span id="l34.723" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -1,11 +1,43 @@</span>
<a href="#l35.4"></a><span id="l35.4" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l35.5"></a><span id="l35.5" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l35.6"></a><span id="l35.6" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l35.7"></a><span id="l35.7" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l35.8"></a><span id="l35.8" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l35.9"></a><span id="l35.9" class="difflineplus">+ *</span>
<a href="#l35.10"></a><span id="l35.10" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l35.11"></a><span id="l35.11" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l35.14"></a><span id="l35.14" class="difflineplus">+ *</span>
<a href="#l35.15"></a><span id="l35.15" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l35.16"></a><span id="l35.16" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l35.17"></a><span id="l35.17" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l35.18"></a><span id="l35.18" class="difflineplus">+ * License.</span>
<a href="#l35.19"></a><span id="l35.19" class="difflineplus">+ *</span>
<a href="#l35.20"></a><span id="l35.20" class="difflineplus">+ * The Original Code is Jetpack.</span>
<a href="#l35.21"></a><span id="l35.21" class="difflineplus">+ *</span>
<a href="#l35.22"></a><span id="l35.22" class="difflineplus">+ * The Initial Developer of the Original Code is Mozilla.</span>
<a href="#l35.23"></a><span id="l35.23" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2007</span>
<a href="#l35.24"></a><span id="l35.24" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l35.25"></a><span id="l35.25" class="difflineplus">+ *</span>
<a href="#l35.26"></a><span id="l35.26" class="difflineplus">+ * Contributor(s):</span>
<a href="#l35.27"></a><span id="l35.27" class="difflineplus">+ *   Atul Varma &lt;atul@mozilla.com&gt;</span>
<a href="#l35.28"></a><span id="l35.28" class="difflineplus">+ *</span>
<a href="#l35.29"></a><span id="l35.29" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l35.30"></a><span id="l35.30" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l35.31"></a><span id="l35.31" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l35.32"></a><span id="l35.32" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l35.33"></a><span id="l35.33" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l35.34"></a><span id="l35.34" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l35.35"></a><span id="l35.35" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l35.36"></a><span id="l35.36" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l35.37"></a><span id="l35.37" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l35.38"></a><span id="l35.38" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l35.39"></a><span id="l35.39" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l35.40"></a><span id="l35.40" class="difflineplus">+ *</span>
<a href="#l35.41"></a><span id="l35.41" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l35.42"></a><span id="l35.42"> </span>
<a href="#l35.43"></a><span id="l35.43"> (function(global) {</span>
<a href="#l35.44"></a><span id="l35.44">    const Cc = Components.classes;</span>
<a href="#l35.45"></a><span id="l35.45">    const Ci = Components.interfaces;</span>
<a href="#l35.46"></a><span id="l35.46">    const Cu = Components.utils;</span>
<a href="#l35.47"></a><span id="l35.47">    const Cr = Components.results;</span>
<a href="#l35.48"></a><span id="l35.48"> </span>
<a href="#l35.49"></a><span id="l35.49">    var exports = {};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1">old mode 100644</span>
<a href="#l36.2"></a><span id="l36.2">new mode 100755</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1">deleted file mode 100644</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineminus">--- a/mail/test/resources/mozmill/patches/httpd.patch</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineplus">+++ /dev/null</span>
<a href="#l37.4"></a><span id="l37.4" class="difflineat">@@ -1,40 +0,0 @@</span>
<a href="#l37.5"></a><span id="l37.5" class="difflineminus">-diff --git a/mozmill/mozmill/extension/resource/stdlib/httpd.js b/mozmill/mozmill/extension/resource/stdlib/httpd.js</span>
<a href="#l37.6"></a><span id="l37.6" class="difflineminus">-index cf974b3..35a8d36 100644</span>
<a href="#l37.7"></a><span id="l37.7" class="difflineminus">---- a/mozmill/mozmill/extension/resource/stdlib/httpd.js</span>
<a href="#l37.8"></a><span id="l37.8" class="difflineminus">-+++ b/mozmill/mozmill/extension/resource/stdlib/httpd.js</span>
<a href="#l37.9"></a><span id="l37.9" class="difflineminus">-@@ -48,6 +48,14 @@</span>
<a href="#l37.10"></a><span id="l37.10" class="difflineminus">- </span>
<a href="#l37.11"></a><span id="l37.11" class="difflineminus">- Components.utils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">- </span>
<a href="#l37.13"></a><span id="l37.13" class="difflineminus">-+var EXPORTED_SYMBOLS = ['getServer'];</span>
<a href="#l37.14"></a><span id="l37.14" class="difflineminus">-+</span>
<a href="#l37.15"></a><span id="l37.15" class="difflineminus">-+/**</span>
<a href="#l37.16"></a><span id="l37.16" class="difflineminus">-+ * Overwrite both dump functions because we do not wanna have this output for Mozmill</span>
<a href="#l37.17"></a><span id="l37.17" class="difflineminus">-+ */</span>
<a href="#l37.18"></a><span id="l37.18" class="difflineminus">-+function dump() {}</span>
<a href="#l37.19"></a><span id="l37.19" class="difflineminus">-+function dumpn() {}</span>
<a href="#l37.20"></a><span id="l37.20" class="difflineminus">-+</span>
<a href="#l37.21"></a><span id="l37.21" class="difflineminus">- const Cc = Components.classes;</span>
<a href="#l37.22"></a><span id="l37.22" class="difflineminus">- const Ci = Components.interfaces;</span>
<a href="#l37.23"></a><span id="l37.23" class="difflineminus">- const Cr = Components.results;</span>
<a href="#l37.24"></a><span id="l37.24" class="difflineminus">-@@ -5173,3 +5181,20 @@ function server(port, basePath)</span>
<a href="#l37.25"></a><span id="l37.25" class="difflineminus">- </span>
<a href="#l37.26"></a><span id="l37.26" class="difflineminus">-   DEBUG = false;</span>
<a href="#l37.27"></a><span id="l37.27" class="difflineminus">- }</span>
<a href="#l37.28"></a><span id="l37.28" class="difflineminus">-+</span>
<a href="#l37.29"></a><span id="l37.29" class="difflineminus">-+function getServer (port, basePath) {</span>
<a href="#l37.30"></a><span id="l37.30" class="difflineminus">-+  if (basePath) {</span>
<a href="#l37.31"></a><span id="l37.31" class="difflineminus">-+    var lp = Cc[&quot;@mozilla.org/file/local;1&quot;]</span>
<a href="#l37.32"></a><span id="l37.32" class="difflineminus">-+               .createInstance(Ci.nsILocalFile);</span>
<a href="#l37.33"></a><span id="l37.33" class="difflineminus">-+    lp.initWithPath(basePath);</span>
<a href="#l37.34"></a><span id="l37.34" class="difflineminus">-+   }</span>
<a href="#l37.35"></a><span id="l37.35" class="difflineminus">-+</span>
<a href="#l37.36"></a><span id="l37.36" class="difflineminus">-+   var srv = new nsHttpServer();</span>
<a href="#l37.37"></a><span id="l37.37" class="difflineminus">-+   if (lp)</span>
<a href="#l37.38"></a><span id="l37.38" class="difflineminus">-+     srv.registerDirectory(&quot;/&quot;, lp);</span>
<a href="#l37.39"></a><span id="l37.39" class="difflineminus">-+   srv.registerContentType(&quot;sjs&quot;, SJS_TYPE);</span>
<a href="#l37.40"></a><span id="l37.40" class="difflineminus">-+   srv.identity.setPrimary(&quot;http&quot;, &quot;localhost&quot;, port);</span>
<a href="#l37.41"></a><span id="l37.41" class="difflineminus">-+   srv._port = port;</span>
<a href="#l37.42"></a><span id="l37.42" class="difflineminus">-+</span>
<a href="#l37.43"></a><span id="l37.43" class="difflineminus">-+   return srv;</span>
<a href="#l37.44"></a><span id="l37.44" class="difflineminus">-+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/mail/test/resources/mozmill/scripts/sync_dependencies.py</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/mail/test/resources/mozmill/scripts/sync_dependencies.py</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -1,30 +1,57 @@</span>
<a href="#l38.4"></a><span id="l38.4" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l38.5"></a><span id="l38.5" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l38.6"></a><span id="l38.6" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l38.7"></a><span id="l38.7" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l38.8"></a><span id="l38.8" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l38.9"></a><span id="l38.9" class="difflineplus">+#</span>
<a href="#l38.10"></a><span id="l38.10" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l38.11"></a><span id="l38.11" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l38.14"></a><span id="l38.14" class="difflineplus">+#</span>
<a href="#l38.15"></a><span id="l38.15" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l38.16"></a><span id="l38.16" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l38.17"></a><span id="l38.17" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l38.18"></a><span id="l38.18" class="difflineplus">+# License.</span>
<a href="#l38.19"></a><span id="l38.19" class="difflineplus">+#</span>
<a href="#l38.20"></a><span id="l38.20" class="difflineplus">+# The Original Code is Mozilla Corporation Code.</span>
<a href="#l38.21"></a><span id="l38.21" class="difflineplus">+#</span>
<a href="#l38.22"></a><span id="l38.22" class="difflineplus">+# The Initial Developer of the Original Code is the Mozilla Foundation.</span>
<a href="#l38.23"></a><span id="l38.23" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2010</span>
<a href="#l38.24"></a><span id="l38.24" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l38.25"></a><span id="l38.25" class="difflineplus">+#</span>
<a href="#l38.26"></a><span id="l38.26" class="difflineplus">+# Contributor(s):</span>
<a href="#l38.27"></a><span id="l38.27" class="difflineplus">+#   Henrik Skupin &lt;hskupin@gmail.com&gt;</span>
<a href="#l38.28"></a><span id="l38.28" class="difflineplus">+#</span>
<a href="#l38.29"></a><span id="l38.29" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l38.30"></a><span id="l38.30" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l38.31"></a><span id="l38.31" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l38.32"></a><span id="l38.32" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l38.33"></a><span id="l38.33" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l38.34"></a><span id="l38.34" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l38.35"></a><span id="l38.35" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l38.36"></a><span id="l38.36" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l38.37"></a><span id="l38.37" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l38.38"></a><span id="l38.38" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l38.39"></a><span id="l38.39" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l38.40"></a><span id="l38.40" class="difflineplus">+#</span>
<a href="#l38.41"></a><span id="l38.41" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l38.42"></a><span id="l38.42"> </span>
<a href="#l38.43"></a><span id="l38.43"> import os</span>
<a href="#l38.44"></a><span id="l38.44"> import subprocess</span>
<a href="#l38.45"></a><span id="l38.45"> import urllib</span>
<a href="#l38.46"></a><span id="l38.46"> </span>
<a href="#l38.47"></a><span id="l38.47"> abs_path = os.path.dirname(os.path.abspath(__file__))</span>
<a href="#l38.48"></a><span id="l38.48"> root_path = os.path.dirname(abs_path)</span>
<a href="#l38.49"></a><span id="l38.49"> </span>
<a href="#l38.50"></a><span id="l38.50"> # We need the latest version of Event Utils</span>
<a href="#l38.51"></a><span id="l38.51"> externalModules = [</span>
<a href="#l38.52"></a><span id="l38.52">     {   # EventUtils.js</span>
<a href="#l38.53"></a><span id="l38.53">         &quot;url&quot;: &quot;http://hg.mozilla.org/mozilla-central/raw-file/default/testing/mochitest/tests/SimpleTest/EventUtils.js&quot;,</span>
<a href="#l38.54"></a><span id="l38.54">         &quot;path&quot;: &quot;mozmill/extension/resource/stdlib/EventUtils.js&quot;,</span>
<a href="#l38.55"></a><span id="l38.55">         &quot;patch&quot;: &quot;patches/eventUtils.patch&quot;</span>
<a href="#l38.56"></a><span id="l38.56" class="difflineminus">-    },</span>
<a href="#l38.57"></a><span id="l38.57" class="difflineminus">-    {   # httpd.js</span>
<a href="#l38.58"></a><span id="l38.58" class="difflineminus">-        &quot;url&quot;: &quot;http://hg.mozilla.org/mozilla-central/raw-file/default/netwerk/test/httpserver/httpd.js&quot;,</span>
<a href="#l38.59"></a><span id="l38.59" class="difflineminus">-        &quot;path&quot;: &quot;mozmill/extension/resource/stdlib/httpd.js&quot;,</span>
<a href="#l38.60"></a><span id="l38.60" class="difflineminus">-        &quot;patch&quot;: &quot;patches/httpd.patch&quot;</span>
<a href="#l38.61"></a><span id="l38.61">     }</span>
<a href="#l38.62"></a><span id="l38.62"> ]</span>
<a href="#l38.63"></a><span id="l38.63"> </span>
<a href="#l38.64"></a><span id="l38.64"> </span>
<a href="#l38.65"></a><span id="l38.65"> # Change into the root folder to update and patch external modules correctly</span>
<a href="#l38.66"></a><span id="l38.66"> os.chdir(root_path)</span>
<a href="#l38.67"></a><span id="l38.67"> </span>
<a href="#l38.68"></a><span id="l38.68"> for module in externalModules:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/mail/test/resources/mozmill/setup.py</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/mail/test/resources/mozmill/setup.py</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -1,19 +1,52 @@</span>
<a href="#l39.4"></a><span id="l39.4" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l39.5"></a><span id="l39.5" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l39.6"></a><span id="l39.6" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l39.7"></a><span id="l39.7" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l39.8"></a><span id="l39.8" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l39.9"></a><span id="l39.9" class="difflineplus">+#</span>
<a href="#l39.10"></a><span id="l39.10" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l39.11"></a><span id="l39.11" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l39.14"></a><span id="l39.14" class="difflineplus">+#</span>
<a href="#l39.15"></a><span id="l39.15" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l39.16"></a><span id="l39.16" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l39.17"></a><span id="l39.17" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l39.18"></a><span id="l39.18" class="difflineplus">+# License.</span>
<a href="#l39.19"></a><span id="l39.19" class="difflineplus">+#</span>
<a href="#l39.20"></a><span id="l39.20" class="difflineplus">+# The Original Code is Mozilla Corporation Code.</span>
<a href="#l39.21"></a><span id="l39.21" class="difflineplus">+#</span>
<a href="#l39.22"></a><span id="l39.22" class="difflineplus">+# The Initial Developer of the Original Code is</span>
<a href="#l39.23"></a><span id="l39.23" class="difflineplus">+# Mikeal Rogers.</span>
<a href="#l39.24"></a><span id="l39.24" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2008</span>
<a href="#l39.25"></a><span id="l39.25" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l39.26"></a><span id="l39.26" class="difflineplus">+#</span>
<a href="#l39.27"></a><span id="l39.27" class="difflineplus">+# Contributor(s):</span>
<a href="#l39.28"></a><span id="l39.28" class="difflineplus">+#  Mikeal Rogers &lt;mikeal.rogers@gmail.com&gt;</span>
<a href="#l39.29"></a><span id="l39.29" class="difflineplus">+#</span>
<a href="#l39.30"></a><span id="l39.30" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l39.31"></a><span id="l39.31" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l39.32"></a><span id="l39.32" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l39.33"></a><span id="l39.33" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l39.34"></a><span id="l39.34" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l39.35"></a><span id="l39.35" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l39.36"></a><span id="l39.36" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l39.37"></a><span id="l39.37" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l39.38"></a><span id="l39.38" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l39.39"></a><span id="l39.39" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l39.40"></a><span id="l39.40" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l39.41"></a><span id="l39.41" class="difflineplus">+#</span>
<a href="#l39.42"></a><span id="l39.42" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l39.43"></a><span id="l39.43"> </span>
<a href="#l39.44"></a><span id="l39.44"> from setuptools import setup, find_packages</span>
<a href="#l39.45"></a><span id="l39.45"> </span>
<a href="#l39.46"></a><span id="l39.46"> desc = &quot;&quot;&quot;UI Automation tool for Mozilla applications.&quot;&quot;&quot;</span>
<a href="#l39.47"></a><span id="l39.47"> summ = &quot;&quot;&quot;A tool for full UI automation of Mozilla applications.&quot;&quot;&quot;</span>
<a href="#l39.48"></a><span id="l39.48"> </span>
<a href="#l39.49"></a><span id="l39.49"> PACKAGE_NAME = &quot;mozmill&quot;</span>
<a href="#l39.50"></a><span id="l39.50" class="difflineminus">-PACKAGE_VERSION = &quot;1.5.6&quot;</span>
<a href="#l39.51"></a><span id="l39.51" class="difflineplus">+PACKAGE_VERSION = &quot;1.5.16&quot;</span>
<a href="#l39.52"></a><span id="l39.52"> </span>
<a href="#l39.53"></a><span id="l39.53"> setup(name=PACKAGE_NAME,</span>
<a href="#l39.54"></a><span id="l39.54">       version=PACKAGE_VERSION,</span>
<a href="#l39.55"></a><span id="l39.55">       description=desc,</span>
<a href="#l39.56"></a><span id="l39.56">       long_description=summ,</span>
<a href="#l39.57"></a><span id="l39.57">       author='Mozilla, Mikeal Rogers',</span>
<a href="#l39.58"></a><span id="l39.58">       author_email='mikeal.rogers@gmail.com',</span>
<a href="#l39.59"></a><span id="l39.59">       url='http://github.com/mozautomation/mozmill',</span>
<a href="#l39.60"></a><span id="l39.60" class="difflineat">@@ -24,18 +57,18 @@ setup(name=PACKAGE_NAME,</span>
<a href="#l39.61"></a><span id="l39.61">       zip_safe=False,</span>
<a href="#l39.62"></a><span id="l39.62">       entry_points=&quot;&quot;&quot;</span>
<a href="#l39.63"></a><span id="l39.63">           [console_scripts]</span>
<a href="#l39.64"></a><span id="l39.64">           mozmill = mozmill:cli</span>
<a href="#l39.65"></a><span id="l39.65">           mozmill-thunderbird = mozmill:tbird_cli</span>
<a href="#l39.66"></a><span id="l39.66">           mozmill-restart = mozmill:restart_cli</span>
<a href="#l39.67"></a><span id="l39.67">         &quot;&quot;&quot;,</span>
<a href="#l39.68"></a><span id="l39.68">       platforms =['Any'],</span>
<a href="#l39.69"></a><span id="l39.69" class="difflineminus">-      install_requires = ['jsbridge == 2.4.6',</span>
<a href="#l39.70"></a><span id="l39.70" class="difflineminus">-                          'mozrunner == 2.5.7',</span>
<a href="#l39.71"></a><span id="l39.71" class="difflineplus">+      install_requires = ['jsbridge == 2.4.14',</span>
<a href="#l39.72"></a><span id="l39.72" class="difflineplus">+                          'mozrunner == 2.5.13',</span>
<a href="#l39.73"></a><span id="l39.73">                           'ManifestDestiny == 0.2.2'],</span>
<a href="#l39.74"></a><span id="l39.74">       classifiers=['Development Status :: 4 - Beta',</span>
<a href="#l39.75"></a><span id="l39.75">                    'Environment :: Console',</span>
<a href="#l39.76"></a><span id="l39.76">                    'Intended Audience :: Developers',</span>
<a href="#l39.77"></a><span id="l39.77">                    'License :: OSI Approved :: Apache Software License',</span>
<a href="#l39.78"></a><span id="l39.78">                    'Operating System :: OS Independent',</span>
<a href="#l39.79"></a><span id="l39.79">                    'Topic :: Software Development :: Libraries :: Python Modules',</span>
<a href="#l39.80"></a><span id="l39.80">                   ]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/mail/test/resources/mozmill/test/restart/test_user_restart/test5.js</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/mail/test/resources/mozmill/test/restart/test_user_restart/test5.js</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -1,12 +1,8 @@</span>
<a href="#l40.4"></a><span id="l40.4" class="difflineminus">-var setupModule = function(module) {</span>
<a href="#l40.5"></a><span id="l40.5" class="difflineplus">+var setupModule = function () {</span>
<a href="#l40.6"></a><span id="l40.6">   controller = mozmill.getBrowserController();</span>
<a href="#l40.7"></a><span id="l40.7"> }</span>
<a href="#l40.8"></a><span id="l40.8"> </span>
<a href="#l40.9"></a><span id="l40.9" class="difflineminus">-/**</span>
<a href="#l40.10"></a><span id="l40.10" class="difflineminus">- * This test should fail and then exit with a 'Disconnect Error: Application Unexpectedly Closed'</span>
<a href="#l40.11"></a><span id="l40.11" class="difflineminus">- */</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-var testRestartAfterTimeout = function(){</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+var teardownModule = function () {</span>
<a href="#l40.14"></a><span id="l40.14">   controller.startUserShutdown(1000, true);</span>
<a href="#l40.15"></a><span id="l40.15" class="difflineminus">-  controller.sleep(2000);</span>
<a href="#l40.16"></a><span id="l40.16">   controller.window.Application.restart();</span>
<a href="#l40.17"></a><span id="l40.17"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/mail/test/resources/mozrunner/mozrunner/__init__.py</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/mail/test/resources/mozrunner/mozrunner/__init__.py</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -1,11 +1,46 @@</span>
<a href="#l41.4"></a><span id="l41.4" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l41.5"></a><span id="l41.5" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l41.6"></a><span id="l41.6" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l41.7"></a><span id="l41.7" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l41.8"></a><span id="l41.8" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l41.9"></a><span id="l41.9" class="difflineplus">+#</span>
<a href="#l41.10"></a><span id="l41.10" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l41.11"></a><span id="l41.11" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l41.14"></a><span id="l41.14" class="difflineplus">+#</span>
<a href="#l41.15"></a><span id="l41.15" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l41.16"></a><span id="l41.16" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l41.17"></a><span id="l41.17" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l41.18"></a><span id="l41.18" class="difflineplus">+# License.</span>
<a href="#l41.19"></a><span id="l41.19" class="difflineplus">+#</span>
<a href="#l41.20"></a><span id="l41.20" class="difflineplus">+# The Original Code is Mozilla Corporation Code.</span>
<a href="#l41.21"></a><span id="l41.21" class="difflineplus">+#</span>
<a href="#l41.22"></a><span id="l41.22" class="difflineplus">+# The Initial Developer of the Original Code is</span>
<a href="#l41.23"></a><span id="l41.23" class="difflineplus">+# Mikeal Rogers.</span>
<a href="#l41.24"></a><span id="l41.24" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2008-2009</span>
<a href="#l41.25"></a><span id="l41.25" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l41.26"></a><span id="l41.26" class="difflineplus">+#</span>
<a href="#l41.27"></a><span id="l41.27" class="difflineplus">+# Contributor(s):</span>
<a href="#l41.28"></a><span id="l41.28" class="difflineplus">+#  Mikeal Rogers &lt;mikeal.rogers@gmail.com&gt;</span>
<a href="#l41.29"></a><span id="l41.29" class="difflineplus">+#  Clint Talbert &lt;ctalbert@mozilla.com&gt;</span>
<a href="#l41.30"></a><span id="l41.30" class="difflineplus">+#  Henrik Skupin &lt;hskupin@mozilla.com&gt;</span>
<a href="#l41.31"></a><span id="l41.31" class="difflineplus">+#</span>
<a href="#l41.32"></a><span id="l41.32" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l41.33"></a><span id="l41.33" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l41.34"></a><span id="l41.34" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l41.35"></a><span id="l41.35" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l41.36"></a><span id="l41.36" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l41.37"></a><span id="l41.37" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l41.38"></a><span id="l41.38" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l41.39"></a><span id="l41.39" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l41.40"></a><span id="l41.40" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l41.41"></a><span id="l41.41" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l41.42"></a><span id="l41.42" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l41.43"></a><span id="l41.43" class="difflineplus">+#</span>
<a href="#l41.44"></a><span id="l41.44" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l41.45"></a><span id="l41.45"> </span>
<a href="#l41.46"></a><span id="l41.46"> import os</span>
<a href="#l41.47"></a><span id="l41.47"> import sys</span>
<a href="#l41.48"></a><span id="l41.48"> import copy</span>
<a href="#l41.49"></a><span id="l41.49"> import tempfile</span>
<a href="#l41.50"></a><span id="l41.50"> import commands</span>
<a href="#l41.51"></a><span id="l41.51"> import zipfile</span>
<a href="#l41.52"></a><span id="l41.52"> import optparse</span>
<a href="#l41.53"></a><span id="l41.53" class="difflineat">@@ -288,16 +323,18 @@ class FirefoxProfile(Profile):</span>
<a href="#l41.54"></a><span id="l41.54">                    # Don't install distribution add-ons from the app folder</span>
<a href="#l41.55"></a><span id="l41.55">                    'extensions.installDistroAddons' : False,</span>
<a href="#l41.56"></a><span id="l41.56">                    # Dont' run the add-on compatibility check during start-up</span>
<a href="#l41.57"></a><span id="l41.57">                    'extensions.showMismatchUI' : False,</span>
<a href="#l41.58"></a><span id="l41.58">                    # Don't automatically update add-ons</span>
<a href="#l41.59"></a><span id="l41.59">                    'extensions.update.enabled' : False,</span>
<a href="#l41.60"></a><span id="l41.60">                    # Don't open a dialog to show available add-on updates</span>
<a href="#l41.61"></a><span id="l41.61">                    'extensions.update.notifyUser' : False,</span>
<a href="#l41.62"></a><span id="l41.62" class="difflineplus">+                   # Enable test mode to run multiple tests in parallel</span>
<a href="#l41.63"></a><span id="l41.63" class="difflineplus">+                   'focusmanager.testmode' : True,</span>
<a href="#l41.64"></a><span id="l41.64"> </span>
<a href="#l41.65"></a><span id="l41.65">                    # Disable addon compatibility checks</span>
<a href="#l41.66"></a><span id="l41.66">                    'extensions.checkCompatibility' : False,</span>
<a href="#l41.67"></a><span id="l41.67">                    'extensions.checkCompatibility.4.0' : False,</span>
<a href="#l41.68"></a><span id="l41.68">                    'extensions.checkCompatibility.4.0b' : False,</span>
<a href="#l41.69"></a><span id="l41.69">                    'extensions.checkCompatibility.4.2' : False,</span>
<a href="#l41.70"></a><span id="l41.70">                    'extensions.checkCompatibility.4.2a' : False,</span>
<a href="#l41.71"></a><span id="l41.71">                    'extensions.checkCompatibility.4.2b' : False,</span>
<a href="#l41.72"></a><span id="l41.72" class="difflineat">@@ -337,41 +374,40 @@ class ThunderbirdProfile(Profile):</span>
<a href="#l41.73"></a><span id="l41.73">                    'browser.sessionstore.resume_from_crash': False,</span>
<a href="#l41.74"></a><span id="l41.74">                    }</span>
<a href="#l41.75"></a><span id="l41.75">     names = [&quot;thunderbird&quot;, &quot;shredder&quot;]</span>
<a href="#l41.76"></a><span id="l41.76"> </span>
<a href="#l41.77"></a><span id="l41.77"> </span>
<a href="#l41.78"></a><span id="l41.78"> class Runner(object):</span>
<a href="#l41.79"></a><span id="l41.79">     &quot;&quot;&quot;Handles all running operations. Finds bins, runs and kills the process.&quot;&quot;&quot;</span>
<a href="#l41.80"></a><span id="l41.80"> </span>
<a href="#l41.81"></a><span id="l41.81" class="difflineminus">-    def __init__(self, binary=None, profile=None, cmdargs=[], env=None, kp_kwargs={}):</span>
<a href="#l41.82"></a><span id="l41.82" class="difflineplus">+    def __init__(self, binary=None, profile=None, cmdargs=None, env=None, kp_kwargs={}):</span>
<a href="#l41.83"></a><span id="l41.83"> </span>
<a href="#l41.84"></a><span id="l41.84">         self.process_handler = None</span>
<a href="#l41.85"></a><span id="l41.85"> </span>
<a href="#l41.86"></a><span id="l41.86">         # find the binary</span>
<a href="#l41.87"></a><span id="l41.87">         if binary is None:</span>
<a href="#l41.88"></a><span id="l41.88">             self.binary = self.find_binary()</span>
<a href="#l41.89"></a><span id="l41.89">         elif sys.platform == 'darwin' and binary.find('Contents/MacOS/') == -1:</span>
<a href="#l41.90"></a><span id="l41.90">             self.binary = os.path.join(binary, 'Contents/MacOS/%s-bin' % self.names[0])</span>
<a href="#l41.91"></a><span id="l41.91">         else:</span>
<a href="#l41.92"></a><span id="l41.92">             self.binary = binary</span>
<a href="#l41.93"></a><span id="l41.93">         if not os.path.exists(self.binary):</span>
<a href="#l41.94"></a><span id="l41.94">             raise Exception(&quot;Binary path does not exist &quot;+self.binary)</span>
<a href="#l41.95"></a><span id="l41.95"> </span>
<a href="#l41.96"></a><span id="l41.96" class="difflineminus">-        </span>
<a href="#l41.97"></a><span id="l41.97">         if sys.platform.startswith('linux') and self.binary.endswith('-bin'):</span>
<a href="#l41.98"></a><span id="l41.98">             dirname = os.path.dirname(self.binary)</span>
<a href="#l41.99"></a><span id="l41.99">             if os.environ.get('LD_LIBRARY_PATH', None):</span>
<a href="#l41.100"></a><span id="l41.100">                 os.environ['LD_LIBRARY_PATH'] = '%s:%s' % (os.environ['LD_LIBRARY_PATH'], dirname)</span>
<a href="#l41.101"></a><span id="l41.101">             else:</span>
<a href="#l41.102"></a><span id="l41.102">                 os.environ['LD_LIBRARY_PATH'] = dirname</span>
<a href="#l41.103"></a><span id="l41.103"> </span>
<a href="#l41.104"></a><span id="l41.104">         self.profile = profile</span>
<a href="#l41.105"></a><span id="l41.105"> </span>
<a href="#l41.106"></a><span id="l41.106" class="difflineminus">-        self.cmdargs = cmdargs</span>
<a href="#l41.107"></a><span id="l41.107" class="difflineplus">+        self.cmdargs = cmdargs or []</span>
<a href="#l41.108"></a><span id="l41.108">         if env is None:</span>
<a href="#l41.109"></a><span id="l41.109">             self.env = copy.copy(os.environ)</span>
<a href="#l41.110"></a><span id="l41.110">             self.env.update({'MOZ_NO_REMOTE':&quot;1&quot;,})</span>
<a href="#l41.111"></a><span id="l41.111">         else:</span>
<a href="#l41.112"></a><span id="l41.112">             self.env = env</span>
<a href="#l41.113"></a><span id="l41.113">         self.kp_kwargs = kp_kwargs</span>
<a href="#l41.114"></a><span id="l41.114"> </span>
<a href="#l41.115"></a><span id="l41.115">     def find_binary(self):</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/mail/test/resources/mozrunner/mozrunner/killableprocess.py</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/mail/test/resources/mozrunner/mozrunner/killableprocess.py</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -67,17 +67,20 @@ except ImportError:</span>
<a href="#l42.4"></a><span id="l42.4">             self.returncode = returncode</span>
<a href="#l42.5"></a><span id="l42.5">             self.cmd = cmd</span>
<a href="#l42.6"></a><span id="l42.6">         def __str__(self):</span>
<a href="#l42.7"></a><span id="l42.7">             return &quot;Command '%s' returned non-zero exit status %d&quot; % (self.cmd, self.returncode)</span>
<a href="#l42.8"></a><span id="l42.8"> </span>
<a href="#l42.9"></a><span id="l42.9"> mswindows = (sys.platform == &quot;win32&quot;)</span>
<a href="#l42.10"></a><span id="l42.10"> </span>
<a href="#l42.11"></a><span id="l42.11"> if mswindows:</span>
<a href="#l42.12"></a><span id="l42.12" class="difflineplus">+    from ctypes import sizeof, addressof, c_ulong, byref, POINTER, WinError, c_longlong</span>
<a href="#l42.13"></a><span id="l42.13">     import winprocess</span>
<a href="#l42.14"></a><span id="l42.14" class="difflineplus">+    from qijo import JobObjectExtendedLimitInformation, JOBOBJECT_BASIC_LIMIT_INFORMATION,\</span>
<a href="#l42.15"></a><span id="l42.15" class="difflineplus">+    JOBOBJECT_EXTENDED_LIMIT_INFORMATION, IO_COUNTERS</span>
<a href="#l42.16"></a><span id="l42.16"> else:</span>
<a href="#l42.17"></a><span id="l42.17">     import signal</span>
<a href="#l42.18"></a><span id="l42.18"> </span>
<a href="#l42.19"></a><span id="l42.19"> def call(*args, **kwargs):</span>
<a href="#l42.20"></a><span id="l42.20">     waitargs = {}</span>
<a href="#l42.21"></a><span id="l42.21">     if &quot;timeout&quot; in kwargs:</span>
<a href="#l42.22"></a><span id="l42.22">         waitargs[&quot;timeout&quot;] = kwargs.pop(&quot;timeout&quot;)</span>
<a href="#l42.23"></a><span id="l42.23"> </span>
<a href="#l42.24"></a><span id="l42.24" class="difflineat">@@ -152,16 +155,44 @@ class Popen(subprocess.Popen):</span>
<a href="#l42.25"></a><span id="l42.25">             self._thread = ht</span>
<a href="#l42.26"></a><span id="l42.26">             self.pid = pid</span>
<a href="#l42.27"></a><span id="l42.27">             self.tid = tid</span>
<a href="#l42.28"></a><span id="l42.28"> </span>
<a href="#l42.29"></a><span id="l42.29">             if canCreateJob:</span>
<a href="#l42.30"></a><span id="l42.30">                 # We create a new job for this process, so that we can kill</span>
<a href="#l42.31"></a><span id="l42.31">                 # the process and any sub-processes </span>
<a href="#l42.32"></a><span id="l42.32">                 self._job = winprocess.CreateJobObject()</span>
<a href="#l42.33"></a><span id="l42.33" class="difflineplus">+                # Allow subprocesses to break away from us - necessary for</span>
<a href="#l42.34"></a><span id="l42.34" class="difflineplus">+                # flash with protected mode</span>
<a href="#l42.35"></a><span id="l42.35" class="difflineplus">+                jbli = JOBOBJECT_BASIC_LIMIT_INFORMATION(</span>
<a href="#l42.36"></a><span id="l42.36" class="difflineplus">+                                c_longlong(0), # per process time limit (ignored)</span>
<a href="#l42.37"></a><span id="l42.37" class="difflineplus">+                                c_longlong(0), # per job user time limit (ignored)</span>
<a href="#l42.38"></a><span id="l42.38" class="difflineplus">+                                winprocess.JOB_OBJECT_LIMIT_BREAKAWAY_OK,</span>
<a href="#l42.39"></a><span id="l42.39" class="difflineplus">+                                0, # min working set (ignored)</span>
<a href="#l42.40"></a><span id="l42.40" class="difflineplus">+                                0, # max working set (ignored)</span>
<a href="#l42.41"></a><span id="l42.41" class="difflineplus">+                                0, # active process limit (ignored)</span>
<a href="#l42.42"></a><span id="l42.42" class="difflineplus">+                                None, # affinity (ignored)</span>
<a href="#l42.43"></a><span id="l42.43" class="difflineplus">+                                0, # Priority class (ignored)</span>
<a href="#l42.44"></a><span id="l42.44" class="difflineplus">+                                0, # Scheduling class (ignored)</span>
<a href="#l42.45"></a><span id="l42.45" class="difflineplus">+                                )</span>
<a href="#l42.46"></a><span id="l42.46" class="difflineplus">+</span>
<a href="#l42.47"></a><span id="l42.47" class="difflineplus">+                iocntr = IO_COUNTERS()</span>
<a href="#l42.48"></a><span id="l42.48" class="difflineplus">+                jeli = JOBOBJECT_EXTENDED_LIMIT_INFORMATION(</span>
<a href="#l42.49"></a><span id="l42.49" class="difflineplus">+                                jbli, # basic limit info struct</span>
<a href="#l42.50"></a><span id="l42.50" class="difflineplus">+                                iocntr,    # io_counters (ignored)</span>
<a href="#l42.51"></a><span id="l42.51" class="difflineplus">+                                0,    # process mem limit (ignored)</span>
<a href="#l42.52"></a><span id="l42.52" class="difflineplus">+                                0,    # job mem limit (ignored)</span>
<a href="#l42.53"></a><span id="l42.53" class="difflineplus">+                                0,    # peak process limit (ignored)</span>
<a href="#l42.54"></a><span id="l42.54" class="difflineplus">+                                0)    # peak job limit (ignored)</span>
<a href="#l42.55"></a><span id="l42.55" class="difflineplus">+</span>
<a href="#l42.56"></a><span id="l42.56" class="difflineplus">+                winprocess.SetInformationJobObject(self._job,</span>
<a href="#l42.57"></a><span id="l42.57" class="difflineplus">+                                JobObjectExtendedLimitInformation,</span>
<a href="#l42.58"></a><span id="l42.58" class="difflineplus">+                                addressof(jeli),</span>
<a href="#l42.59"></a><span id="l42.59" class="difflineplus">+                                sizeof(jeli)</span>
<a href="#l42.60"></a><span id="l42.60" class="difflineplus">+                                )</span>
<a href="#l42.61"></a><span id="l42.61">                 winprocess.AssignProcessToJobObject(self._job, int(hp))</span>
<a href="#l42.62"></a><span id="l42.62">             else:</span>
<a href="#l42.63"></a><span id="l42.63">                 self._job = None</span>
<a href="#l42.64"></a><span id="l42.64"> </span>
<a href="#l42.65"></a><span id="l42.65">             winprocess.ResumeThread(int(ht))</span>
<a href="#l42.66"></a><span id="l42.66">             ht.Close()</span>
<a href="#l42.67"></a><span id="l42.67"> </span>
<a href="#l42.68"></a><span id="l42.68">             if p2cread is not None:</span>
<a href="#l42.69"></a><span id="l42.69" class="difflineat">@@ -184,16 +215,26 @@ class Popen(subprocess.Popen):</span>
<a href="#l42.70"></a><span id="l42.70">             self.returncode = 127    </span>
<a href="#l42.71"></a><span id="l42.71">         else:</span>
<a href="#l42.72"></a><span id="l42.72">             if group:</span>
<a href="#l42.73"></a><span id="l42.73">                 try:</span>
<a href="#l42.74"></a><span id="l42.74">                     os.killpg(self.pid, signal.SIGKILL)</span>
<a href="#l42.75"></a><span id="l42.75">                 except: pass</span>
<a href="#l42.76"></a><span id="l42.76">             else:</span>
<a href="#l42.77"></a><span id="l42.77">                 os.kill(self.pid, signal.SIGKILL)</span>
<a href="#l42.78"></a><span id="l42.78" class="difflineplus">+</span>
<a href="#l42.79"></a><span id="l42.79" class="difflineplus">+            # If we don't call os.wait() we end up with zombie processes</span>
<a href="#l42.80"></a><span id="l42.80" class="difflineplus">+            # see bug 658509, but it seems to traceback on linux</span>
<a href="#l42.81"></a><span id="l42.81" class="difflineplus">+            if sys.platform == &quot;darwin&quot;:</span>
<a href="#l42.82"></a><span id="l42.82" class="difflineplus">+                try:</span>
<a href="#l42.83"></a><span id="l42.83" class="difflineplus">+                    os.wait()</span>
<a href="#l42.84"></a><span id="l42.84" class="difflineplus">+                except OSError, e:</span>
<a href="#l42.85"></a><span id="l42.85" class="difflineplus">+                    # The process doesn't exist anymore so we can ignore it</span>
<a href="#l42.86"></a><span id="l42.86" class="difflineplus">+                    pass</span>
<a href="#l42.87"></a><span id="l42.87" class="difflineplus">+</span>
<a href="#l42.88"></a><span id="l42.88">             self.returncode = -9</span>
<a href="#l42.89"></a><span id="l42.89"> </span>
<a href="#l42.90"></a><span id="l42.90">     def wait(self, timeout=None, group=True):</span>
<a href="#l42.91"></a><span id="l42.91">         &quot;&quot;&quot;Wait for the process to terminate. Returns returncode attribute.</span>
<a href="#l42.92"></a><span id="l42.92">         If timeout seconds are reached and the process has not terminated,</span>
<a href="#l42.93"></a><span id="l42.93">         it will be forcefully killed. If timeout is -1, wait will not</span>
<a href="#l42.94"></a><span id="l42.94">         time out.&quot;&quot;&quot;</span>
<a href="#l42.95"></a><span id="l42.95">         if timeout is not None:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/mail/test/resources/mozrunner/mozrunner/winprocess.py</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/mail/test/resources/mozrunner/mozrunner/winprocess.py</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -198,16 +198,32 @@ CREATE_UNICODE_ENVIRONMENT = 0x00000400</span>
<a href="#l43.4"></a><span id="l43.4"> JOB_OBJECT_LIMIT_BREAKAWAY_OK = 0x00000800</span>
<a href="#l43.5"></a><span id="l43.5"> JOB_OBJECT_LIMIT_SILENT_BREAKAWAY_OK = 0x00001000</span>
<a href="#l43.6"></a><span id="l43.6"> </span>
<a href="#l43.7"></a><span id="l43.7"> # XXX these flags should be documented</span>
<a href="#l43.8"></a><span id="l43.8"> DEBUG_ONLY_THIS_PROCESS = 0x00000002</span>
<a href="#l43.9"></a><span id="l43.9"> DEBUG_PROCESS = 0x00000001</span>
<a href="#l43.10"></a><span id="l43.10"> DETACHED_PROCESS = 0x00000008</span>
<a href="#l43.11"></a><span id="l43.11"> </span>
<a href="#l43.12"></a><span id="l43.12" class="difflineplus">+# SetInformationJobObject</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineplus">+SetInformationJobObjectProto = WINFUNCTYPE(BOOL, # Return Type</span>
<a href="#l43.14"></a><span id="l43.14" class="difflineplus">+                                           HANDLE, # Job Handle</span>
<a href="#l43.15"></a><span id="l43.15" class="difflineplus">+                                           DWORD, # Type of Class next param is</span>
<a href="#l43.16"></a><span id="l43.16" class="difflineplus">+                                           LPVOID, # Job Object Class</span>
<a href="#l43.17"></a><span id="l43.17" class="difflineplus">+                                           DWORD # Job Object Class Length</span>
<a href="#l43.18"></a><span id="l43.18" class="difflineplus">+                                          )</span>
<a href="#l43.19"></a><span id="l43.19" class="difflineplus">+SetInformationJobObjectProtoFlags = ((1, &quot;hJob&quot;, None),</span>
<a href="#l43.20"></a><span id="l43.20" class="difflineplus">+                                     (1, &quot;JobObjectInfoClass&quot;, None),</span>
<a href="#l43.21"></a><span id="l43.21" class="difflineplus">+                                     (1, &quot;lpJobObjectInfo&quot;, None),</span>
<a href="#l43.22"></a><span id="l43.22" class="difflineplus">+                                     (1, &quot;cbJobObjectInfoLength&quot;, 0))</span>
<a href="#l43.23"></a><span id="l43.23" class="difflineplus">+SetInformationJobObject = SetInformationJobObjectProto((&quot;SetInformationJobObject&quot;,</span>
<a href="#l43.24"></a><span id="l43.24" class="difflineplus">+                                                        windll.kernel32),</span>
<a href="#l43.25"></a><span id="l43.25" class="difflineplus">+                                                        SetInformationJobObjectProtoFlags)</span>
<a href="#l43.26"></a><span id="l43.26" class="difflineplus">+SetInformationJobObject.errcheck = ErrCheckBool</span>
<a href="#l43.27"></a><span id="l43.27" class="difflineplus">+</span>
<a href="#l43.28"></a><span id="l43.28"> # CreateJobObject()</span>
<a href="#l43.29"></a><span id="l43.29"> </span>
<a href="#l43.30"></a><span id="l43.30"> CreateJobObjectProto = WINFUNCTYPE(HANDLE,             # Return type</span>
<a href="#l43.31"></a><span id="l43.31">                                    LPVOID,             # lpJobAttributes</span>
<a href="#l43.32"></a><span id="l43.32">                                    LPCWSTR             # lpName</span>
<a href="#l43.33"></a><span id="l43.33">                                    )</span>
<a href="#l43.34"></a><span id="l43.34"> </span>
<a href="#l43.35"></a><span id="l43.35"> CreateJobObjectFlags = ((1, &quot;lpJobAttributes&quot;, None),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/mail/test/resources/mozrunner/setup.py</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/mail/test/resources/mozrunner/setup.py</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -1,19 +1,52 @@</span>
<a href="#l44.4"></a><span id="l44.4" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l44.5"></a><span id="l44.5" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l44.6"></a><span id="l44.6" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l44.7"></a><span id="l44.7" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l44.8"></a><span id="l44.8" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l44.9"></a><span id="l44.9" class="difflineplus">+#</span>
<a href="#l44.10"></a><span id="l44.10" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l44.11"></a><span id="l44.11" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l44.14"></a><span id="l44.14" class="difflineplus">+#</span>
<a href="#l44.15"></a><span id="l44.15" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l44.16"></a><span id="l44.16" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l44.17"></a><span id="l44.17" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l44.18"></a><span id="l44.18" class="difflineplus">+# License.</span>
<a href="#l44.19"></a><span id="l44.19" class="difflineplus">+#</span>
<a href="#l44.20"></a><span id="l44.20" class="difflineplus">+# The Original Code is Mozilla Corporation Code.</span>
<a href="#l44.21"></a><span id="l44.21" class="difflineplus">+#</span>
<a href="#l44.22"></a><span id="l44.22" class="difflineplus">+# The Initial Developer of the Original Code is</span>
<a href="#l44.23"></a><span id="l44.23" class="difflineplus">+# Mikeal Rogers.</span>
<a href="#l44.24"></a><span id="l44.24" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2008</span>
<a href="#l44.25"></a><span id="l44.25" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l44.26"></a><span id="l44.26" class="difflineplus">+#</span>
<a href="#l44.27"></a><span id="l44.27" class="difflineplus">+# Contributor(s):</span>
<a href="#l44.28"></a><span id="l44.28" class="difflineplus">+#  Mikeal Rogers &lt;mikeal.rogers@gmail.com&gt;</span>
<a href="#l44.29"></a><span id="l44.29" class="difflineplus">+#</span>
<a href="#l44.30"></a><span id="l44.30" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l44.31"></a><span id="l44.31" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l44.32"></a><span id="l44.32" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l44.33"></a><span id="l44.33" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l44.34"></a><span id="l44.34" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l44.35"></a><span id="l44.35" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l44.36"></a><span id="l44.36" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l44.37"></a><span id="l44.37" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l44.38"></a><span id="l44.38" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l44.39"></a><span id="l44.39" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l44.40"></a><span id="l44.40" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l44.41"></a><span id="l44.41" class="difflineplus">+#</span>
<a href="#l44.42"></a><span id="l44.42" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l44.43"></a><span id="l44.43"> </span>
<a href="#l44.44"></a><span id="l44.44"> from setuptools import setup, find_packages</span>
<a href="#l44.45"></a><span id="l44.45"> import sys</span>
<a href="#l44.46"></a><span id="l44.46"> </span>
<a href="#l44.47"></a><span id="l44.47"> desc = &quot;&quot;&quot;Reliable start/stop/configuration of Mozilla Applications (Firefox, Thunderbird, etc.)&quot;&quot;&quot;</span>
<a href="#l44.48"></a><span id="l44.48"> </span>
<a href="#l44.49"></a><span id="l44.49"> PACKAGE_NAME = &quot;mozrunner&quot;</span>
<a href="#l44.50"></a><span id="l44.50" class="difflineminus">-PACKAGE_VERSION = &quot;2.5.7&quot;</span>
<a href="#l44.51"></a><span id="l44.51" class="difflineplus">+PACKAGE_VERSION = &quot;2.5.13&quot;</span>
<a href="#l44.52"></a><span id="l44.52"> </span>
<a href="#l44.53"></a><span id="l44.53"> deps = []</span>
<a href="#l44.54"></a><span id="l44.54"> </span>
<a href="#l44.55"></a><span id="l44.55"> # we only support python 2 right now</span>
<a href="#l44.56"></a><span id="l44.56"> assert sys.version_info[0] == 2</span>
<a href="#l44.57"></a><span id="l44.57"> </span>
<a href="#l44.58"></a><span id="l44.58"> # version-dependent dependencies</span>
<a href="#l44.59"></a><span id="l44.59"> if sys.version_info[1] &lt; 6:</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

