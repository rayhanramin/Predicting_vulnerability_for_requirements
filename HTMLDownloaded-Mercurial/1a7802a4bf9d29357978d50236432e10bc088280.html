<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 21909:1a7802a4bf9d29357978d50236432e10bc088280</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 1a7802a4bf9d29357978d50236432e10bc088280" />
<meta property="og:url" content="/comm-central/rev/1a7802a4bf9d29357978d50236432e10bc088280" />
<meta property="og:description" content="Bug 1386600 - Update nsIStringBundle method uses to account for them returning |AString| instead of |wstring|. r=jorgk." />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 1a7802a4bf9d29357978d50236432e10bc088280 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/1a7802a4bf9d29357978d50236432e10bc088280">shortlog</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/1a7802a4bf9d29357978d50236432e10bc088280">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280">files</a> |
changeset |
<a href="/comm-central/raw-rev/1a7802a4bf9d29357978d50236432e10bc088280">raw</a>  | <a href="/comm-central/archive/1a7802a4bf9d29357978d50236432e10bc088280.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1386600">Bug 1386600</a> - Update nsIStringBundle method uses to account for them returning |AString| instead of |wstring|. r=jorgk.
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#78;&#105;&#99;&#104;&#111;&#108;&#97;&#115;&#32;&#78;&#101;&#116;&#104;&#101;&#114;&#99;&#111;&#116;&#101;&#32;&#60;&#110;&#110;&#101;&#116;&#104;&#101;&#114;&#99;&#111;&#116;&#101;&#64;&#109;&#111;&#122;&#105;&#108;&#108;&#97;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 04 Aug 2017 10:32:30 +1000</td></tr>

<tr>
 <td>changeset 21909</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/1a7802a4bf9d29357978d50236432e10bc088280">1a7802a4bf9d29357978d50236432e10bc088280</a></td>
</tr>



<tr>
<td>parent 21908</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/eeb9fb0aac793072b54e7dec4b75988b6611133b">eeb9fb0aac793072b54e7dec4b75988b6611133b</a>
</td>
</tr>

<tr>
<td>child 21910</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/6b0c4e39b0d680dee1cfa688bbf92b1ab8907566">6b0c4e39b0d680dee1cfa688bbf92b1ab8907566</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=1a7802a4bf9d29357978d50236432e10bc088280">13380</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Mon, 07 Aug 2017 12:33:39 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@6b0c4e39b0d6 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=6b0c4e39b0d680dee1cfa688bbf92b1ab8907566">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=6b0c4e39b0d680dee1cfa688bbf92b1ab8907566&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=6b0c4e39b0d680dee1cfa688bbf92b1ab8907566&newProject=comm-central&newRevision=1a7802a4bf9d29357978d50236432e10bc088280&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=6b0c4e39b0d680dee1cfa688bbf92b1ab8907566&newProject=comm-central&newRevision=1a7802a4bf9d29357978d50236432e10bc088280&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=6b0c4e39b0d680dee1cfa688bbf92b1ab8907566&newProject=comm-central&newRevision=1a7802a4bf9d29357978d50236432e10bc088280&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28jorgk%29&revcount=50">jorgk</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1386600">1386600</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1386600">Bug 1386600</a> - Update nsIStringBundle method uses to account for them returning |AString| instead of |wstring|. r=jorgk.</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mail/components/shell/nsMailGNOMEIntegration.cpp">mail/components/shell/nsMailGNOMEIntegration.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mail/components/shell/nsMailGNOMEIntegration.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mail/components/shell/nsMailGNOMEIntegration.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mail/components/shell/nsMailGNOMEIntegration.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mail/components/shell/nsMailGNOMEIntegration.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mail/components/shell/nsMailGNOMEIntegration.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbCardProperty.cpp">mailnews/addrbook/src/nsAbCardProperty.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbCardProperty.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbCardProperty.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbCardProperty.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbCardProperty.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbCardProperty.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp">mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp">mailnews/addrbook/src/nsAbLDAPListenerBase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbManager.cpp">mailnews/addrbook/src/nsAbManager.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbManager.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbManager.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbManager.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbManager.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbManager.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbView.cpp">mailnews/addrbook/src/nsAbView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbView.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbView.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbView.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbView.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAbView.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp">mailnews/addrbook/src/nsAddbookProtocolHandler.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAddrDatabase.cpp">mailnews/addrbook/src/nsAddrDatabase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAddrDatabase.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAddrDatabase.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAddrDatabase.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAddrDatabase.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/addrbook/src/nsAddrDatabase.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilter.cpp">mailnews/base/search/src/nsMsgFilter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilter.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilter.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilter.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilter.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilter.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilterService.cpp">mailnews/base/search/src/nsMsgFilterService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilterService.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilterService.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilterService.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilterService.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilterService.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilterService.h">mailnews/base/search/src/nsMsgFilterService.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilterService.h">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilterService.h">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilterService.h">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilterService.h">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/search/src/nsMsgFilterService.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessenger.cpp">mailnews/base/src/nsMessenger.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessenger.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessenger.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessenger.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessenger.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessenger.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerOSXIntegration.mm">mailnews/base/src/nsMessengerOSXIntegration.mm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerOSXIntegration.mm">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerOSXIntegration.mm">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerOSXIntegration.mm">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerOSXIntegration.mm">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerOSXIntegration.mm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerUnixIntegration.cpp">mailnews/base/src/nsMessengerUnixIntegration.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerUnixIntegration.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerUnixIntegration.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerUnixIntegration.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerUnixIntegration.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerUnixIntegration.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerWinIntegration.cpp">mailnews/base/src/nsMessengerWinIntegration.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerWinIntegration.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerWinIntegration.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerWinIntegration.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerWinIntegration.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMessengerWinIntegration.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgAccountManager.cpp">mailnews/base/src/nsMsgAccountManager.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgAccountManager.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgAccountManager.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgAccountManager.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgAccountManager.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgAccountManager.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgAccountManagerDS.cpp">mailnews/base/src/nsMsgAccountManagerDS.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgAccountManagerDS.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgAccountManagerDS.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgAccountManagerDS.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgAccountManagerDS.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgAccountManagerDS.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgDBView.cpp">mailnews/base/src/nsMsgDBView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgDBView.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgDBView.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgDBView.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgDBView.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgDBView.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgFolderCompactor.cpp">mailnews/base/src/nsMsgFolderCompactor.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgFolderCompactor.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgFolderCompactor.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgFolderCompactor.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgFolderCompactor.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgFolderCompactor.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgFolderDataSource.cpp">mailnews/base/src/nsMsgFolderDataSource.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgFolderDataSource.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgFolderDataSource.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgFolderDataSource.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgFolderDataSource.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgFolderDataSource.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgOfflineManager.cpp">mailnews/base/src/nsMsgOfflineManager.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgOfflineManager.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgOfflineManager.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgOfflineManager.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgOfflineManager.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgOfflineManager.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgPrintEngine.cpp">mailnews/base/src/nsMsgPrintEngine.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgPrintEngine.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgPrintEngine.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgPrintEngine.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgPrintEngine.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgPrintEngine.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgProgress.cpp">mailnews/base/src/nsMsgProgress.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgProgress.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgProgress.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgProgress.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgProgress.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgProgress.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgStatusFeedback.cpp">mailnews/base/src/nsMsgStatusFeedback.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgStatusFeedback.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgStatusFeedback.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgStatusFeedback.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgStatusFeedback.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsMsgStatusFeedback.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsSpamSettings.cpp">mailnews/base/src/nsSpamSettings.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsSpamSettings.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsSpamSettings.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsSpamSettings.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsSpamSettings.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/src/nsSpamSettings.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgDBFolder.cpp">mailnews/base/util/nsMsgDBFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgDBFolder.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgDBFolder.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgDBFolder.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgDBFolder.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgDBFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgDBFolder.h">mailnews/base/util/nsMsgDBFolder.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgDBFolder.h">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgDBFolder.h">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgDBFolder.h">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgDBFolder.h">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgDBFolder.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgIncomingServer.cpp">mailnews/base/util/nsMsgIncomingServer.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgIncomingServer.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgIncomingServer.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgIncomingServer.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgIncomingServer.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgIncomingServer.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgProtocol.cpp">mailnews/base/util/nsMsgProtocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgProtocol.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgProtocol.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgProtocol.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgProtocol.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgProtocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgUtils.cpp">mailnews/base/util/nsMsgUtils.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgUtils.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgUtils.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgUtils.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgUtils.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/base/util/nsMsgUtils.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgAttachmentHandler.cpp">mailnews/compose/src/nsMsgAttachmentHandler.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgAttachmentHandler.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgAttachmentHandler.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgAttachmentHandler.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgAttachmentHandler.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgAttachmentHandler.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgCompUtils.cpp">mailnews/compose/src/nsMsgCompUtils.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgCompUtils.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgCompUtils.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgCompUtils.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgCompUtils.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgCompUtils.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgCompose.cpp">mailnews/compose/src/nsMsgCompose.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgCompose.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgCompose.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgCompose.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgCompose.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgCompose.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgPrompts.cpp">mailnews/compose/src/nsMsgPrompts.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgPrompts.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgPrompts.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgPrompts.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgPrompts.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgPrompts.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSend.cpp">mailnews/compose/src/nsMsgSend.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSend.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSend.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSend.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSend.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSend.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSend.h">mailnews/compose/src/nsMsgSend.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSend.h">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSend.h">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSend.h">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSend.h">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSend.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSendReport.cpp">mailnews/compose/src/nsMsgSendReport.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSendReport.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSendReport.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSendReport.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSendReport.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsMsgSendReport.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsSmtpProtocol.cpp">mailnews/compose/src/nsSmtpProtocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsSmtpProtocol.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsSmtpProtocol.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsSmtpProtocol.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsSmtpProtocol.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/compose/src/nsSmtpProtocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp">mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mdn/src/nsMsgMdnGenerator.h">mailnews/extensions/mdn/src/nsMsgMdnGenerator.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mdn/src/nsMsgMdnGenerator.h">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mdn/src/nsMsgMdnGenerator.h">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mdn/src/nsMsgMdnGenerator.h">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mdn/src/nsMsgMdnGenerator.h">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/mdn/src/nsMsgMdnGenerator.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">mailnews/extensions/smime/src/nsMsgComposeSecure.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/smime/src/nsMsgComposeSecure.h">mailnews/extensions/smime/src/nsMsgComposeSecure.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/smime/src/nsMsgComposeSecure.h">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/smime/src/nsMsgComposeSecure.h">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/smime/src/nsMsgComposeSecure.h">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/smime/src/nsMsgComposeSecure.h">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/extensions/smime/src/nsMsgComposeSecure.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapIncomingServer.cpp">mailnews/imap/src/nsImapIncomingServer.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapIncomingServer.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapIncomingServer.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapIncomingServer.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapIncomingServer.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapIncomingServer.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapMailFolder.cpp">mailnews/imap/src/nsImapMailFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapMailFolder.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapMailFolder.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapMailFolder.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapMailFolder.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapMailFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapProtocol.cpp">mailnews/imap/src/nsImapProtocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapProtocol.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapProtocol.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapProtocol.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapProtocol.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapProtocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapService.cpp">mailnews/imap/src/nsImapService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapService.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapService.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapService.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapService.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapService.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapStringBundle.cpp">mailnews/imap/src/nsImapStringBundle.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapStringBundle.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapStringBundle.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapStringBundle.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapStringBundle.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/imap/src/nsImapStringBundle.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/applemail/src/nsAppleMailImport.cpp">mailnews/import/applemail/src/nsAppleMailImport.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/applemail/src/nsAppleMailImport.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/applemail/src/nsAppleMailImport.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/applemail/src/nsAppleMailImport.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/applemail/src/nsAppleMailImport.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/applemail/src/nsAppleMailImport.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyMail.cpp">mailnews/import/becky/src/nsBeckyMail.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyMail.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyMail.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyMail.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyMail.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyMail.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyStringBundle.cpp">mailnews/import/becky/src/nsBeckyStringBundle.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyStringBundle.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyStringBundle.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyStringBundle.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyStringBundle.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyStringBundle.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyStringBundle.h">mailnews/import/becky/src/nsBeckyStringBundle.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyStringBundle.h">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyStringBundle.h">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyStringBundle.h">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyStringBundle.h">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/becky/src/nsBeckyStringBundle.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/src/nsImportMail.cpp">mailnews/import/src/nsImportMail.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/src/nsImportMail.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/src/nsImportMail.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/src/nsImportMail.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/src/nsImportMail.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/src/nsImportMail.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/src/nsImportStringBundle.cpp">mailnews/import/src/nsImportStringBundle.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/src/nsImportStringBundle.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/src/nsImportStringBundle.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/src/nsImportStringBundle.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/src/nsImportStringBundle.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/import/src/nsImportStringBundle.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/intl/nsCharsetConverterManager.cpp">mailnews/intl/nsCharsetConverterManager.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/intl/nsCharsetConverterManager.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/intl/nsCharsetConverterManager.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/intl/nsCharsetConverterManager.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/intl/nsCharsetConverterManager.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/intl/nsCharsetConverterManager.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsLocalMailFolder.cpp">mailnews/local/src/nsLocalMailFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsLocalMailFolder.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsLocalMailFolder.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsLocalMailFolder.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsLocalMailFolder.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsLocalMailFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsMovemailService.cpp">mailnews/local/src/nsMovemailService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsMovemailService.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsMovemailService.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsMovemailService.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsMovemailService.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsMovemailService.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsParseMailbox.cpp">mailnews/local/src/nsParseMailbox.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsParseMailbox.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsParseMailbox.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsParseMailbox.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsParseMailbox.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsParseMailbox.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Protocol.cpp">mailnews/local/src/nsPop3Protocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Protocol.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Protocol.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Protocol.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Protocol.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Protocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Service.cpp">mailnews/local/src/nsPop3Service.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Service.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Service.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Service.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Service.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Service.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Sink.cpp">mailnews/local/src/nsPop3Sink.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Sink.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Sink.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Sink.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Sink.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/local/src/nsPop3Sink.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mapi/mapihook/src/msgMapiHook.cpp">mailnews/mapi/mapihook/src/msgMapiHook.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mapi/mapihook/src/msgMapiHook.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mapi/mapihook/src/msgMapiHook.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mapi/mapihook/src/msgMapiHook.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mapi/mapihook/src/msgMapiHook.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mapi/mapihook/src/msgMapiHook.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp">mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">mailnews/mime/emitters/nsMimeBaseEmitter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/emitters/nsMimeBaseEmitter.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp">mailnews/mime/emitters/nsMimeHtmlEmitter.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/src/mimemoz2.cpp">mailnews/mime/src/mimemoz2.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/src/mimemoz2.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/src/mimemoz2.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/src/mimemoz2.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/src/mimemoz2.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/mime/src/mimemoz2.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNNTPNewsgroupList.cpp">mailnews/news/src/nsNNTPNewsgroupList.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNNTPNewsgroupList.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNNTPNewsgroupList.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNNTPNewsgroupList.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNNTPNewsgroupList.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNNTPNewsgroupList.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNNTPProtocol.cpp">mailnews/news/src/nsNNTPProtocol.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNNTPProtocol.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNNTPProtocol.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNNTPProtocol.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNNTPProtocol.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNNTPProtocol.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNewsDownloader.cpp">mailnews/news/src/nsNewsDownloader.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNewsDownloader.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNewsDownloader.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNewsDownloader.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNewsDownloader.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNewsDownloader.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNewsFolder.cpp">mailnews/news/src/nsNewsFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNewsFolder.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNewsFolder.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNewsFolder.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNewsFolder.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNewsFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNntpIncomingServer.cpp">mailnews/news/src/nsNntpIncomingServer.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNntpIncomingServer.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNntpIncomingServer.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNntpIncomingServer.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNntpIncomingServer.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/mailnews/news/src/nsNntpIncomingServer.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/suite/shell/src/nsGNOMEShellService.cpp">suite/shell/src/nsGNOMEShellService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/suite/shell/src/nsGNOMEShellService.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/suite/shell/src/nsGNOMEShellService.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/suite/shell/src/nsGNOMEShellService.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/suite/shell/src/nsGNOMEShellService.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/suite/shell/src/nsGNOMEShellService.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/suite/shell/src/nsWindowsShellService.cpp">suite/shell/src/nsWindowsShellService.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/1a7802a4bf9d29357978d50236432e10bc088280/suite/shell/src/nsWindowsShellService.cpp">file</a> |
<a href="/comm-central/annotate/1a7802a4bf9d29357978d50236432e10bc088280/suite/shell/src/nsWindowsShellService.cpp">annotate</a> |
<a href="/comm-central/diff/1a7802a4bf9d29357978d50236432e10bc088280/suite/shell/src/nsWindowsShellService.cpp">diff</a> |
<a href="/comm-central/comparison/1a7802a4bf9d29357978d50236432e10bc088280/suite/shell/src/nsWindowsShellService.cpp">comparison</a> |
<a href="/comm-central/log/1a7802a4bf9d29357978d50236432e10bc088280/suite/shell/src/nsWindowsShellService.cpp">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/components/shell/nsMailGNOMEIntegration.cpp</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/components/shell/nsMailGNOMEIntegration.cpp</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -304,18 +304,17 @@ nsMailGNOMEIntegration::MakeDefault(cons</span>
<a href="#l1.4"></a><span id="l1.4">       mozilla::services::GetStringBundleService();</span>
<a href="#l1.5"></a><span id="l1.5">     NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7">     nsCOMPtr&lt;nsIStringBundle&gt; brandBundle;</span>
<a href="#l1.8"></a><span id="l1.8">     rv = bundleService-&gt;CreateBundle(BRAND_PROPERTIES, getter_AddRefs(brandBundle));</span>
<a href="#l1.9"></a><span id="l1.9">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l1.10"></a><span id="l1.10"> </span>
<a href="#l1.11"></a><span id="l1.11">     nsString brandShortName;</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-    brandBundle-&gt;GetStringFromName(&quot;brandShortName&quot;,</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-                                   getter_Copies(brandShortName));</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+    brandBundle-&gt;GetStringFromName(&quot;brandShortName&quot;, brandShortName);</span>
<a href="#l1.15"></a><span id="l1.15"> </span>
<a href="#l1.16"></a><span id="l1.16">     // use brandShortName as the application id.</span>
<a href="#l1.17"></a><span id="l1.17">     NS_ConvertUTF16toUTF8 id(brandShortName);</span>
<a href="#l1.18"></a><span id="l1.18"> </span>
<a href="#l1.19"></a><span id="l1.19">     nsCOMPtr&lt;nsIGIOMimeApp&gt; app;</span>
<a href="#l1.20"></a><span id="l1.20">     rv = giovfs-&gt;CreateAppFromCommand(mAppPath, id, getter_AddRefs(app));</span>
<a href="#l1.21"></a><span id="l1.21">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l1.22"></a><span id="l1.22"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbCardProperty.cpp</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbCardProperty.cpp</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -728,17 +728,17 @@ nsresult nsAbCardProperty::ConvertToBase</span>
<a href="#l2.4"></a><span id="l2.4">   // Get Address Book string and set it as title of XML document</span>
<a href="#l2.5"></a><span id="l2.5">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l2.6"></a><span id="l2.6">   nsCOMPtr&lt;nsIStringBundleService&gt; stringBundleService =</span>
<a href="#l2.7"></a><span id="l2.7">     mozilla::services::GetStringBundleService();</span>
<a href="#l2.8"></a><span id="l2.8">   if (stringBundleService) {</span>
<a href="#l2.9"></a><span id="l2.9">     rv = stringBundleService-&gt;CreateBundle(sAddrbookProperties, getter_AddRefs(bundle));</span>
<a href="#l2.10"></a><span id="l2.10">     if (NS_SUCCEEDED(rv)) {</span>
<a href="#l2.11"></a><span id="l2.11">       nsString addrBook;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-      rv = bundle-&gt;GetStringFromName(&quot;addressBook&quot;, getter_Copies(addrBook));</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+      rv = bundle-&gt;GetStringFromName(&quot;addressBook&quot;, addrBook);</span>
<a href="#l2.14"></a><span id="l2.14">       if (NS_SUCCEEDED(rv)) {</span>
<a href="#l2.15"></a><span id="l2.15">         xmlStr.AppendLiteral(&quot;&lt;title xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;&quot;);</span>
<a href="#l2.16"></a><span id="l2.16">         xmlStr.Append(addrBook);</span>
<a href="#l2.17"></a><span id="l2.17">         xmlStr.AppendLiteral(&quot;&lt;/title&gt;\n&quot;);</span>
<a href="#l2.18"></a><span id="l2.18">       }</span>
<a href="#l2.19"></a><span id="l2.19">     }</span>
<a href="#l2.20"></a><span id="l2.20">   }</span>
<a href="#l2.21"></a><span id="l2.21"> </span>
<a href="#l2.22"></a><span id="l2.22" class="difflineat">@@ -820,17 +820,17 @@ nsresult nsAbCardProperty::ConvertToXMLP</span>
<a href="#l2.23"></a><span id="l2.23">   }</span>
<a href="#l2.24"></a><span id="l2.24">   else {</span>
<a href="#l2.25"></a><span id="l2.25">     rv = AppendSection(CUSTOM_ATTRS_ARRAY, sizeof(CUSTOM_ATTRS_ARRAY)/sizeof(AppendItem), NS_LITERAL_STRING(&quot;headingDescription&quot;),</span>
<a href="#l2.26"></a><span id="l2.26">          bundle, conv, xmlStr);</span>
<a href="#l2.27"></a><span id="l2.27"> </span>
<a href="#l2.28"></a><span id="l2.28">     xmlStr.AppendLiteral(&quot;&lt;section&gt;&lt;sectiontitle&gt;&quot;);</span>
<a href="#l2.29"></a><span id="l2.29"> </span>
<a href="#l2.30"></a><span id="l2.30">     nsString headingAddresses;</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineminus">-    rv = bundle-&gt;GetStringFromName(&quot;headingAddresses&quot;, getter_Copies(headingAddresses));</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+    rv = bundle-&gt;GetStringFromName(&quot;headingAddresses&quot;, headingAddresses);</span>
<a href="#l2.33"></a><span id="l2.33">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l2.34"></a><span id="l2.34"> </span>
<a href="#l2.35"></a><span id="l2.35">     xmlStr.Append(headingAddresses);</span>
<a href="#l2.36"></a><span id="l2.36">     xmlStr.AppendLiteral(&quot;&lt;/sectiontitle&gt;&quot;);</span>
<a href="#l2.37"></a><span id="l2.37"> </span>
<a href="#l2.38"></a><span id="l2.38">     nsCOMPtr&lt;nsIAbManager&gt; abManager = do_GetService(NS_ABMANAGER_CONTRACTID, &amp;rv);</span>
<a href="#l2.39"></a><span id="l2.39">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l2.40"></a><span id="l2.40"> </span>
<a href="#l2.41"></a><span id="l2.41" class="difflineat">@@ -908,17 +908,17 @@ nsresult nsAbCardProperty::AppendSection</span>
<a href="#l2.42"></a><span id="l2.42">   for (i=0;i&lt;aCount;i++) {</span>
<a href="#l2.43"></a><span id="l2.43">     rv = GetPropertyAsAString(aArray[i].mColumn, attrValue);</span>
<a href="#l2.44"></a><span id="l2.44">     if (NS_SUCCEEDED(rv) &amp;&amp; !attrValue.IsEmpty())</span>
<a href="#l2.45"></a><span id="l2.45">       sectionIsEmpty = false;</span>
<a href="#l2.46"></a><span id="l2.46">   }</span>
<a href="#l2.47"></a><span id="l2.47"> </span>
<a href="#l2.48"></a><span id="l2.48">   if (!sectionIsEmpty &amp;&amp; !aHeading.IsEmpty()) {</span>
<a href="#l2.49"></a><span id="l2.49">     nsString heading;</span>
<a href="#l2.50"></a><span id="l2.50" class="difflineminus">-    rv = aBundle-&gt;GetStringFromName(NS_ConvertUTF16toUTF8(aHeading).get(), getter_Copies(heading));</span>
<a href="#l2.51"></a><span id="l2.51" class="difflineplus">+    rv = aBundle-&gt;GetStringFromName(NS_ConvertUTF16toUTF8(aHeading).get(), heading);</span>
<a href="#l2.52"></a><span id="l2.52">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l2.53"></a><span id="l2.53"> </span>
<a href="#l2.54"></a><span id="l2.54">     aResult.AppendLiteral(&quot;&lt;sectiontitle&gt;&quot;);</span>
<a href="#l2.55"></a><span id="l2.55">     aResult.Append(heading);</span>
<a href="#l2.56"></a><span id="l2.56">     aResult.AppendLiteral(&quot;&lt;/sectiontitle&gt;&quot;);</span>
<a href="#l2.57"></a><span id="l2.57">   }</span>
<a href="#l2.58"></a><span id="l2.58"> </span>
<a href="#l2.59"></a><span id="l2.59">   for (i=0;i&lt;aCount;i++) {</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineat">@@ -986,17 +986,17 @@ nsresult nsAbCardProperty::AppendLabel(c</span>
<a href="#l2.61"></a><span id="l2.61">   nsresult rv;</span>
<a href="#l2.62"></a><span id="l2.62">   nsString label, attrValue;</span>
<a href="#l2.63"></a><span id="l2.63"> </span>
<a href="#l2.64"></a><span id="l2.64">   rv = GetPropertyAsAString(aItem.mColumn, attrValue);</span>
<a href="#l2.65"></a><span id="l2.65"> </span>
<a href="#l2.66"></a><span id="l2.66">   if (NS_FAILED(rv) || attrValue.IsEmpty())</span>
<a href="#l2.67"></a><span id="l2.67">     return NS_OK;</span>
<a href="#l2.68"></a><span id="l2.68"> </span>
<a href="#l2.69"></a><span id="l2.69" class="difflineminus">-  rv = aBundle-&gt;GetStringFromName(aItem.mLabel, getter_Copies(label));</span>
<a href="#l2.70"></a><span id="l2.70" class="difflineplus">+  rv = aBundle-&gt;GetStringFromName(aItem.mLabel, label);</span>
<a href="#l2.71"></a><span id="l2.71">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l2.72"></a><span id="l2.72"> </span>
<a href="#l2.73"></a><span id="l2.73">   aResult.AppendLiteral(&quot;&lt;labelrow&gt;&lt;label&gt;&quot;);</span>
<a href="#l2.74"></a><span id="l2.74"> </span>
<a href="#l2.75"></a><span id="l2.75">   aResult.Append(label);</span>
<a href="#l2.76"></a><span id="l2.76">   aResult.AppendLiteral(&quot;: &lt;/label&gt;&quot;);</span>
<a href="#l2.77"></a><span id="l2.77"> </span>
<a href="#l2.78"></a><span id="l2.78">   rv = AppendLine(aItem, aConv, aResult);</span>
<a href="#l2.79"></a><span id="l2.79" class="difflineat">@@ -1043,28 +1043,28 @@ nsresult nsAbCardProperty::AppendCitySta</span>
<a href="#l2.80"></a><span id="l2.80"> </span>
<a href="#l2.81"></a><span id="l2.81">   rv = AppendLine(item, aConv, zipResult);</span>
<a href="#l2.82"></a><span id="l2.82">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l2.83"></a><span id="l2.83"> </span>
<a href="#l2.84"></a><span id="l2.84">   nsString formattedString;</span>
<a href="#l2.85"></a><span id="l2.85"> </span>
<a href="#l2.86"></a><span id="l2.86">   if (!cityResult.IsEmpty() &amp;&amp; !stateResult.IsEmpty() &amp;&amp; !zipResult.IsEmpty()) {</span>
<a href="#l2.87"></a><span id="l2.87">     const char16_t *formatStrings[] = { cityResult.get(), stateResult.get(), zipResult.get() };</span>
<a href="#l2.88"></a><span id="l2.88" class="difflineminus">-    rv = aBundle-&gt;FormatStringFromName(&quot;cityAndStateAndZip&quot;, formatStrings, ArrayLength(formatStrings), getter_Copies(formattedString));</span>
<a href="#l2.89"></a><span id="l2.89" class="difflineplus">+    rv = aBundle-&gt;FormatStringFromName(&quot;cityAndStateAndZip&quot;, formatStrings, ArrayLength(formatStrings), formattedString);</span>
<a href="#l2.90"></a><span id="l2.90">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l2.91"></a><span id="l2.91">   }</span>
<a href="#l2.92"></a><span id="l2.92">   else if (!cityResult.IsEmpty() &amp;&amp; !stateResult.IsEmpty() &amp;&amp; zipResult.IsEmpty()) {</span>
<a href="#l2.93"></a><span id="l2.93">     const char16_t *formatStrings[] = { cityResult.get(), stateResult.get() };</span>
<a href="#l2.94"></a><span id="l2.94" class="difflineminus">-    rv = aBundle-&gt;FormatStringFromName(&quot;cityAndStateNoZip&quot;, formatStrings, ArrayLength(formatStrings), getter_Copies(formattedString));</span>
<a href="#l2.95"></a><span id="l2.95" class="difflineplus">+    rv = aBundle-&gt;FormatStringFromName(&quot;cityAndStateNoZip&quot;, formatStrings, ArrayLength(formatStrings), formattedString);</span>
<a href="#l2.96"></a><span id="l2.96">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l2.97"></a><span id="l2.97">   }</span>
<a href="#l2.98"></a><span id="l2.98">   else if ((!cityResult.IsEmpty() &amp;&amp; stateResult.IsEmpty() &amp;&amp; !zipResult.IsEmpty()) ||</span>
<a href="#l2.99"></a><span id="l2.99">           (cityResult.IsEmpty() &amp;&amp; !stateResult.IsEmpty() &amp;&amp; !zipResult.IsEmpty())) {</span>
<a href="#l2.100"></a><span id="l2.100">     const char16_t *formatStrings[] = { cityResult.IsEmpty() ? stateResult.get() : cityResult.get(), zipResult.get() };</span>
<a href="#l2.101"></a><span id="l2.101" class="difflineminus">-    rv = aBundle-&gt;FormatStringFromName(&quot;cityOrStateAndZip&quot;, formatStrings, ArrayLength(formatStrings), getter_Copies(formattedString));</span>
<a href="#l2.102"></a><span id="l2.102" class="difflineplus">+    rv = aBundle-&gt;FormatStringFromName(&quot;cityOrStateAndZip&quot;, formatStrings, ArrayLength(formatStrings), formattedString);</span>
<a href="#l2.103"></a><span id="l2.103">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l2.104"></a><span id="l2.104">   }</span>
<a href="#l2.105"></a><span id="l2.105">   else {</span>
<a href="#l2.106"></a><span id="l2.106">     if (!cityResult.IsEmpty())</span>
<a href="#l2.107"></a><span id="l2.107">       formattedString = cityResult;</span>
<a href="#l2.108"></a><span id="l2.108">     else if (!stateResult.IsEmpty())</span>
<a href="#l2.109"></a><span id="l2.109">       formattedString = stateResult;</span>
<a href="#l2.110"></a><span id="l2.110">     else</span>
<a href="#l2.111"></a><span id="l2.111" class="difflineat">@@ -1109,23 +1109,23 @@ NS_IMETHODIMP nsAbCardProperty::Generate</span>
<a href="#l2.112"></a><span id="l2.112">     }</span>
<a href="#l2.113"></a><span id="l2.113"> </span>
<a href="#l2.114"></a><span id="l2.114">     nsString result;</span>
<a href="#l2.115"></a><span id="l2.115"> </span>
<a href="#l2.116"></a><span id="l2.116">     if (aGenerateFormat == GENERATE_LAST_FIRST_ORDER) {</span>
<a href="#l2.117"></a><span id="l2.117">       const char16_t *stringParams[2] = {lastName.get(), firstName.get()};</span>
<a href="#l2.118"></a><span id="l2.118"> </span>
<a href="#l2.119"></a><span id="l2.119">       rv = bundle-&gt;FormatStringFromName(&quot;lastFirstFormat&quot;,</span>
<a href="#l2.120"></a><span id="l2.120" class="difflineminus">-                                        stringParams, 2, getter_Copies(result));</span>
<a href="#l2.121"></a><span id="l2.121" class="difflineplus">+                                        stringParams, 2, result);</span>
<a href="#l2.122"></a><span id="l2.122">     }</span>
<a href="#l2.123"></a><span id="l2.123">     else {</span>
<a href="#l2.124"></a><span id="l2.124">       const char16_t *stringParams[2] = {firstName.get(), lastName.get()};</span>
<a href="#l2.125"></a><span id="l2.125"> </span>
<a href="#l2.126"></a><span id="l2.126">       rv = bundle-&gt;FormatStringFromName(&quot;firstLastFormat&quot;,</span>
<a href="#l2.127"></a><span id="l2.127" class="difflineminus">-                                        stringParams, 2, getter_Copies(result));</span>
<a href="#l2.128"></a><span id="l2.128" class="difflineplus">+                                        stringParams, 2, result);</span>
<a href="#l2.129"></a><span id="l2.129">     }</span>
<a href="#l2.130"></a><span id="l2.130">     NS_ENSURE_SUCCESS(rv, rv); </span>
<a href="#l2.131"></a><span id="l2.131"> </span>
<a href="#l2.132"></a><span id="l2.132">     aResult.Assign(result);</span>
<a href="#l2.133"></a><span id="l2.133">   }</span>
<a href="#l2.134"></a><span id="l2.134"> </span>
<a href="#l2.135"></a><span id="l2.135">   if (aResult.IsEmpty())</span>
<a href="#l2.136"></a><span id="l2.136">   {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbLDAPChangeLogData.cpp</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -256,22 +256,22 @@ nsresult nsAbLDAPProcessChangeLogData::G</span>
<a href="#l3.4"></a><span id="l3.4">       mozilla::services::GetStringBundleService();</span>
<a href="#l3.5"></a><span id="l3.5">     NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l3.6"></a><span id="l3.6">     nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l3.7"></a><span id="l3.7">     rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/addressbook/addressBook.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l3.8"></a><span id="l3.8">     if (NS_FAILED (rv)) </span>
<a href="#l3.9"></a><span id="l3.9">         return rv ;</span>
<a href="#l3.10"></a><span id="l3.10"> </span>
<a href="#l3.11"></a><span id="l3.11">     nsString title;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-    rv = bundle-&gt;GetStringFromName(&quot;AuthDlgTitle&quot;, getter_Copies(title));</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+    rv = bundle-&gt;GetStringFromName(&quot;AuthDlgTitle&quot;, title);</span>
<a href="#l3.14"></a><span id="l3.14">     if (NS_FAILED (rv)) </span>
<a href="#l3.15"></a><span id="l3.15">         return rv ;</span>
<a href="#l3.16"></a><span id="l3.16"> </span>
<a href="#l3.17"></a><span id="l3.17">     nsString desc;</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineminus">-    rv = bundle-&gt;GetStringFromName(&quot;AuthDlgDesc&quot;, getter_Copies(desc));</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineplus">+    rv = bundle-&gt;GetStringFromName(&quot;AuthDlgDesc&quot;, desc);</span>
<a href="#l3.20"></a><span id="l3.20">     if (NS_FAILED (rv)) </span>
<a href="#l3.21"></a><span id="l3.21">         return rv ;</span>
<a href="#l3.22"></a><span id="l3.22"> </span>
<a href="#l3.23"></a><span id="l3.23">     nsString username;</span>
<a href="#l3.24"></a><span id="l3.24">     nsString password;</span>
<a href="#l3.25"></a><span id="l3.25">     bool btnResult = false;</span>
<a href="#l3.26"></a><span id="l3.26"> 	rv = dialog-&gt;PromptUsernameAndPassword(title, desc, </span>
<a href="#l3.27"></a><span id="l3.27">                                             NS_ConvertUTF8toUTF16(serverUri).get(), </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbLDAPListenerBase.cpp</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -95,18 +95,17 @@ NS_IMETHODIMP nsAbLDAPListenerBase::OnLD</span>
<a href="#l4.4"></a><span id="l4.4">                &quot;bundle chrome://mozldap/locale/ldap.properties&quot;);</span>
<a href="#l4.5"></a><span id="l4.5">       InitFailed();</span>
<a href="#l4.6"></a><span id="l4.6">       return rv;</span>
<a href="#l4.7"></a><span id="l4.7">     }</span>
<a href="#l4.8"></a><span id="l4.8"> </span>
<a href="#l4.9"></a><span id="l4.9">     // get the title for the authentication prompt</span>
<a href="#l4.10"></a><span id="l4.10">     //</span>
<a href="#l4.11"></a><span id="l4.11">     nsString authPromptTitle;</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-    rv = ldapBundle-&gt;GetStringFromName(&quot;authPromptTitle&quot;,</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-                                       getter_Copies(authPromptTitle));</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+    rv = ldapBundle-&gt;GetStringFromName(&quot;authPromptTitle&quot;, authPromptTitle);</span>
<a href="#l4.15"></a><span id="l4.15">     if (NS_FAILED(rv))</span>
<a href="#l4.16"></a><span id="l4.16">     {</span>
<a href="#l4.17"></a><span id="l4.17">       NS_ERROR(&quot;nsAbLDAPListenerBase::OnLDAPInit(): error getting&quot;</span>
<a href="#l4.18"></a><span id="l4.18">                &quot;'authPromptTitle' string from bundle &quot;</span>
<a href="#l4.19"></a><span id="l4.19">                &quot;chrome://mozldap/locale/ldap.properties&quot;);</span>
<a href="#l4.20"></a><span id="l4.20">       InitFailed();</span>
<a href="#l4.21"></a><span id="l4.21">       return rv;</span>
<a href="#l4.22"></a><span id="l4.22">     }</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineat">@@ -131,17 +130,17 @@ NS_IMETHODIMP nsAbLDAPListenerBase::OnLD</span>
<a href="#l4.24"></a><span id="l4.24">     const char16_t *hostArray[1] = { hostTemp.get() };</span>
<a href="#l4.25"></a><span id="l4.25"> </span>
<a href="#l4.26"></a><span id="l4.26">     // format the hostname into the authprompt text string</span>
<a href="#l4.27"></a><span id="l4.27">     //</span>
<a href="#l4.28"></a><span id="l4.28">     nsString authPromptText;</span>
<a href="#l4.29"></a><span id="l4.29">     rv = ldapBundle-&gt;FormatStringFromName(&quot;authPromptText&quot;,</span>
<a href="#l4.30"></a><span id="l4.30">                                           hostArray,</span>
<a href="#l4.31"></a><span id="l4.31">                                           sizeof(hostArray) / sizeof(const char16_t *),</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineminus">-                                          getter_Copies(authPromptText));</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+                                          authPromptText);</span>
<a href="#l4.34"></a><span id="l4.34">     if (NS_FAILED(rv))</span>
<a href="#l4.35"></a><span id="l4.35">     {</span>
<a href="#l4.36"></a><span id="l4.36">       NS_ERROR(&quot;nsAbLDAPListenerBase::OnLDAPInit():&quot;</span>
<a href="#l4.37"></a><span id="l4.37">                &quot;error getting 'authPromptText' string from bundle &quot;</span>
<a href="#l4.38"></a><span id="l4.38">                &quot;chrome://mozldap/locale/ldap.properties&quot;);</span>
<a href="#l4.39"></a><span id="l4.39">       InitFailed();</span>
<a href="#l4.40"></a><span id="l4.40">       return rv;</span>
<a href="#l4.41"></a><span id="l4.41">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbManager.cpp</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbManager.cpp</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -540,52 +540,52 @@ NS_IMETHODIMP nsAbManager::ExportAddress</span>
<a href="#l5.4"></a><span id="l5.4">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.5"></a><span id="l5.5"> </span>
<a href="#l5.6"></a><span id="l5.6">   nsString dirName;</span>
<a href="#l5.7"></a><span id="l5.7">   aDirectory-&gt;GetDirName(dirName);</span>
<a href="#l5.8"></a><span id="l5.8">   const char16_t *formatStrings[] = { dirName.get() };</span>
<a href="#l5.9"></a><span id="l5.9"> </span>
<a href="#l5.10"></a><span id="l5.10">   nsString title;</span>
<a href="#l5.11"></a><span id="l5.11">   rv = bundle-&gt;FormatStringFromName(&quot;ExportAddressBookNameTitle&quot;, formatStrings,</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-                                    ArrayLength(formatStrings), getter_Copies(title));</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+                                    ArrayLength(formatStrings), title);</span>
<a href="#l5.14"></a><span id="l5.14">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.15"></a><span id="l5.15"> </span>
<a href="#l5.16"></a><span id="l5.16">   rv = filePicker-&gt;Init(aParentWin, title, nsIFilePicker::modeSave);</span>
<a href="#l5.17"></a><span id="l5.17">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.18"></a><span id="l5.18"> </span>
<a href="#l5.19"></a><span id="l5.19">   filePicker-&gt;SetDefaultString(dirName);</span>
<a href="#l5.20"></a><span id="l5.20"> </span>
<a href="#l5.21"></a><span id="l5.21">   nsString filterString;</span>
<a href="#l5.22"></a><span id="l5.22"> </span>
<a href="#l5.23"></a><span id="l5.23">   // CSV: System charset and UTF-8.</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(&quot;CSVFilesSysCharset&quot;, getter_Copies(filterString));</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(&quot;CSVFilesSysCharset&quot;, filterString);</span>
<a href="#l5.26"></a><span id="l5.26">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.27"></a><span id="l5.27">   rv = filePicker-&gt;AppendFilter(filterString, NS_LITERAL_STRING(&quot;*.csv&quot;));</span>
<a href="#l5.28"></a><span id="l5.28">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(&quot;CSVFilesUTF8&quot;, getter_Copies(filterString));</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(&quot;CSVFilesUTF8&quot;, filterString);</span>
<a href="#l5.31"></a><span id="l5.31">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.32"></a><span id="l5.32">   rv = filePicker-&gt;AppendFilter(filterString, NS_LITERAL_STRING(&quot;*.csv&quot;));</span>
<a href="#l5.33"></a><span id="l5.33">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.34"></a><span id="l5.34"> </span>
<a href="#l5.35"></a><span id="l5.35">   // Tab separated: System charset and UTF-8.</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(&quot;TABFilesSysCharset&quot;, getter_Copies(filterString));</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(&quot;TABFilesSysCharset&quot;, filterString);</span>
<a href="#l5.38"></a><span id="l5.38">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.39"></a><span id="l5.39">   rv = filePicker-&gt;AppendFilter(filterString, NS_LITERAL_STRING(&quot;*.tab; *.txt&quot;));</span>
<a href="#l5.40"></a><span id="l5.40">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(&quot;TABFilesUTF8&quot;, getter_Copies(filterString));</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(&quot;TABFilesUTF8&quot;, filterString);</span>
<a href="#l5.43"></a><span id="l5.43">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.44"></a><span id="l5.44">   rv = filePicker-&gt;AppendFilter(filterString, NS_LITERAL_STRING(&quot;*.tab; *.txt&quot;));</span>
<a href="#l5.45"></a><span id="l5.45">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.46"></a><span id="l5.46"> </span>
<a href="#l5.47"></a><span id="l5.47" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(&quot;VCFFiles&quot;, getter_Copies(filterString));</span>
<a href="#l5.48"></a><span id="l5.48" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(&quot;VCFFiles&quot;, filterString);</span>
<a href="#l5.49"></a><span id="l5.49">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.50"></a><span id="l5.50">   rv = filePicker-&gt;AppendFilter(filterString, NS_LITERAL_STRING(&quot;*.vcf&quot;));</span>
<a href="#l5.51"></a><span id="l5.51">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.52"></a><span id="l5.52"> </span>
<a href="#l5.53"></a><span id="l5.53" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(&quot;LDIFFiles&quot;, getter_Copies(filterString));</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(&quot;LDIFFiles&quot;, filterString);</span>
<a href="#l5.55"></a><span id="l5.55">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.56"></a><span id="l5.56">   rv = filePicker-&gt;AppendFilter(filterString, NS_LITERAL_STRING(&quot;*.ldi; *.ldif&quot;));</span>
<a href="#l5.57"></a><span id="l5.57">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l5.58"></a><span id="l5.58"> </span>
<a href="#l5.59"></a><span id="l5.59">   int16_t dialogResult;</span>
<a href="#l5.60"></a><span id="l5.60">   filePicker-&gt;Show(&amp;dialogResult);</span>
<a href="#l5.61"></a><span id="l5.61"> </span>
<a href="#l5.62"></a><span id="l5.62">   if (dialogResult == nsIFilePicker::returnCancel)</span>
<a href="#l5.63"></a><span id="l5.63" class="difflineat">@@ -709,17 +709,17 @@ nsAbManager::ExportDirectoryToDelimitedT</span>
<a href="#l5.64"></a><span id="l5.64">   nsCString revisedName;</span>
<a href="#l5.65"></a><span id="l5.65">   nsString columnName;</span>
<a href="#l5.66"></a><span id="l5.66"> </span>
<a href="#l5.67"></a><span id="l5.67">   for (i = 0; i &lt; ArrayLength(EXPORT_ATTRIBUTES_TABLE); i++) {</span>
<a href="#l5.68"></a><span id="l5.68">     if (EXPORT_ATTRIBUTES_TABLE[i].plainTextStringID != 0) {</span>
<a href="#l5.69"></a><span id="l5.69"> </span>
<a href="#l5.70"></a><span id="l5.70">       // We don't need to truncate the string here as getter_Copies will</span>
<a href="#l5.71"></a><span id="l5.71">       // do that for us.</span>
<a href="#l5.72"></a><span id="l5.72" class="difflineminus">-      if (NS_FAILED(bundle-&gt;GetStringFromID(EXPORT_ATTRIBUTES_TABLE[i].plainTextStringID, getter_Copies(columnName))))</span>
<a href="#l5.73"></a><span id="l5.73" class="difflineplus">+      if (NS_FAILED(bundle-&gt;GetStringFromID(EXPORT_ATTRIBUTES_TABLE[i].plainTextStringID, columnName)))</span>
<a href="#l5.74"></a><span id="l5.74">         columnName.AppendInt(EXPORT_ATTRIBUTES_TABLE[i].plainTextStringID);</span>
<a href="#l5.75"></a><span id="l5.75"> </span>
<a href="#l5.76"></a><span id="l5.76">       rv = nsMsgI18NConvertFromUnicode(useUTF8 ? &quot;UTF-8&quot; : nsMsgI18NFileSystemCharset(),</span>
<a href="#l5.77"></a><span id="l5.77">                                        columnName, revisedName);</span>
<a href="#l5.78"></a><span id="l5.78">       NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l5.79"></a><span id="l5.79"> </span>
<a href="#l5.80"></a><span id="l5.80">       rv = outputStream-&gt;Write(revisedName.get(),</span>
<a href="#l5.81"></a><span id="l5.81">                                revisedName.Length(),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbView.cpp</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbView.cpp</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -1314,22 +1314,22 @@ NS_IMETHODIMP nsAbView::SwapFirstNameLas</span>
<a href="#l6.4"></a><span id="l6.4">                               &quot;firstLastFormat&quot;;</span>
<a href="#l6.5"></a><span id="l6.5"> </span>
<a href="#l6.6"></a><span id="l6.6">             // Generate both ln/fn and fn/ln combination since we need both later</span>
<a href="#l6.7"></a><span id="l6.7">             // to check to see if the current display name was edited</span>
<a href="#l6.8"></a><span id="l6.8">             // note that fn/ln still hold the values before the swap</span>
<a href="#l6.9"></a><span id="l6.9">             nameString[0] = ln.get();</span>
<a href="#l6.10"></a><span id="l6.10">             nameString[1] = fn.get();</span>
<a href="#l6.11"></a><span id="l6.11">             rv = bundle-&gt;FormatStringFromName(formatString,</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-                                              nameString, 2, getter_Copies(dnLnFn));</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+                                              nameString, 2, dnLnFn);</span>
<a href="#l6.14"></a><span id="l6.14">             NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.15"></a><span id="l6.15">             nameString[0] = fn.get();</span>
<a href="#l6.16"></a><span id="l6.16">             nameString[1] = ln.get();</span>
<a href="#l6.17"></a><span id="l6.17">             rv = bundle-&gt;FormatStringFromName(formatString,</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineminus">-                                              nameString, 2, getter_Copies(dnFnLn));</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineplus">+                                              nameString, 2, dnFnLn);</span>
<a href="#l6.20"></a><span id="l6.20">             NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.21"></a><span id="l6.21"> </span>
<a href="#l6.22"></a><span id="l6.22">             // Get the current display name</span>
<a href="#l6.23"></a><span id="l6.23">             nsAutoString dn;</span>
<a href="#l6.24"></a><span id="l6.24">             rv = abCard-&gt;GetDisplayName(dn);</span>
<a href="#l6.25"></a><span id="l6.25">             NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l6.26"></a><span id="l6.26"> </span>
<a href="#l6.27"></a><span id="l6.27">             // Swap the display name if not edited</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAddbookProtocolHandler.cpp</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -282,17 +282,17 @@ nsAddbookProtocolHandler::BuildDirectory</span>
<a href="#l7.4"></a><span id="l7.4">   // Get Address Book string and set it as title of XML document</span>
<a href="#l7.5"></a><span id="l7.5">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l7.6"></a><span id="l7.6">   nsCOMPtr&lt;nsIStringBundleService&gt; stringBundleService =</span>
<a href="#l7.7"></a><span id="l7.7">     mozilla::services::GetStringBundleService();</span>
<a href="#l7.8"></a><span id="l7.8">   if (stringBundleService) {</span>
<a href="#l7.9"></a><span id="l7.9">     rv = stringBundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/addressbook/addressBook.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l7.10"></a><span id="l7.10">     if (NS_SUCCEEDED(rv)) {</span>
<a href="#l7.11"></a><span id="l7.11">       nsString addrBook;</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-      rv = bundle-&gt;GetStringFromName(&quot;addressBook&quot;, getter_Copies(addrBook));</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+      rv = bundle-&gt;GetStringFromName(&quot;addressBook&quot;, addrBook);</span>
<a href="#l7.14"></a><span id="l7.14">       if (NS_SUCCEEDED(rv)) {</span>
<a href="#l7.15"></a><span id="l7.15">         aOutput.AppendLiteral(&quot;&lt;title xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;&quot;);</span>
<a href="#l7.16"></a><span id="l7.16">         aOutput.Append(addrBook);</span>
<a href="#l7.17"></a><span id="l7.17">         aOutput.AppendLiteral(&quot;&lt;/title&gt;\n&quot;);</span>
<a href="#l7.18"></a><span id="l7.18">       }</span>
<a href="#l7.19"></a><span id="l7.19">     }</span>
<a href="#l7.20"></a><span id="l7.20">   }</span>
<a href="#l7.21"></a><span id="l7.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAddrDatabase.cpp</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAddrDatabase.cpp</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -407,21 +407,21 @@ nsresult nsAddrDatabase::DisplayAlert(co</span>
<a href="#l8.4"></a><span id="l8.4">   NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l8.5"></a><span id="l8.5"> </span>
<a href="#l8.6"></a><span id="l8.6">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l8.7"></a><span id="l8.7">   rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/addressbook/addressBook.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l8.8"></a><span id="l8.8">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.9"></a><span id="l8.9"> </span>
<a href="#l8.10"></a><span id="l8.10">   nsString alertMessage;</span>
<a href="#l8.11"></a><span id="l8.11">   rv = bundle-&gt;FormatStringFromName(NS_ConvertUTF16toUTF8(alertStringName).get(), formatStrings, numFormatStrings,</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-    getter_Copies(alertMessage));</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+    alertMessage);</span>
<a href="#l8.14"></a><span id="l8.14">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.15"></a><span id="l8.15"> </span>
<a href="#l8.16"></a><span id="l8.16">   nsString alertTitle;</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(NS_ConvertUTF16toUTF8(titleName).get(), getter_Copies(alertTitle));</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(NS_ConvertUTF16toUTF8(titleName).get(), alertTitle);</span>
<a href="#l8.19"></a><span id="l8.19">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.20"></a><span id="l8.20"> </span>
<a href="#l8.21"></a><span id="l8.21">   nsCOMPtr&lt;nsIPromptService&gt; prompter =</span>
<a href="#l8.22"></a><span id="l8.22">       do_GetService(NS_PROMPTSERVICE_CONTRACTID, &amp;rv);</span>
<a href="#l8.23"></a><span id="l8.23">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l8.24"></a><span id="l8.24"> </span>
<a href="#l8.25"></a><span id="l8.25">   return prompter-&gt;Alert(nullptr /* we don't know the parent window */, alertTitle.get(), alertMessage.get());</span>
<a href="#l8.26"></a><span id="l8.26"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgFilter.cpp</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgFilter.cpp</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -574,28 +574,28 @@ nsMsgFilter::LogRuleHitGeneric(nsIMsgRul</span>
<a href="#l9.4"></a><span id="l9.4">       NS_ConvertASCIItoUTF16 tcode16(tcode) ;</span>
<a href="#l9.5"></a><span id="l9.5">       NS_ConvertASCIItoUTF16 tErrmsg16(aErrmsg) ;</span>
<a href="#l9.6"></a><span id="l9.6"> </span>
<a href="#l9.7"></a><span id="l9.7">       const char16_t *logErrorFormatStrings[2] = { tErrmsg16.get(),  tcode16.get()};</span>
<a href="#l9.8"></a><span id="l9.8">       nsString filterFailureWarningPrefix;</span>
<a href="#l9.9"></a><span id="l9.9">       rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l9.10"></a><span id="l9.10">                       &quot;filterFailureWarningPrefix&quot;,</span>
<a href="#l9.11"></a><span id="l9.11">                       logErrorFormatStrings, 2,</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-                      getter_Copies(filterFailureWarningPrefix));</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+                      filterFailureWarningPrefix);</span>
<a href="#l9.14"></a><span id="l9.14">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l9.15"></a><span id="l9.15">       buffer += NS_ConvertUTF16toUTF8(filterFailureWarningPrefix);</span>
<a href="#l9.16"></a><span id="l9.16">       buffer += &quot;\n&quot;;</span>
<a href="#l9.17"></a><span id="l9.17">     }</span>
<a href="#l9.18"></a><span id="l9.18"> </span>
<a href="#l9.19"></a><span id="l9.19">     const char16_t *filterLogDetectFormatStrings[4] = { filterName.get(), authorValue.get(), subjectValue.get(), dateValue.get() };</span>
<a href="#l9.20"></a><span id="l9.20">     nsString filterLogDetectStr;</span>
<a href="#l9.21"></a><span id="l9.21">     rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l9.22"></a><span id="l9.22">       &quot;filterLogDetectStr&quot;,</span>
<a href="#l9.23"></a><span id="l9.23">       filterLogDetectFormatStrings, 4,</span>
<a href="#l9.24"></a><span id="l9.24" class="difflineminus">-      getter_Copies(filterLogDetectStr));</span>
<a href="#l9.25"></a><span id="l9.25" class="difflineplus">+      filterLogDetectStr);</span>
<a href="#l9.26"></a><span id="l9.26">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l9.27"></a><span id="l9.27"> </span>
<a href="#l9.28"></a><span id="l9.28">     buffer += NS_ConvertUTF16toUTF8(filterLogDetectStr);</span>
<a href="#l9.29"></a><span id="l9.29">     buffer +=  &quot;\n&quot;;</span>
<a href="#l9.30"></a><span id="l9.30"> </span>
<a href="#l9.31"></a><span id="l9.31">     if (actionType == nsMsgFilterAction::MoveToFolder ||</span>
<a href="#l9.32"></a><span id="l9.32">         actionType == nsMsgFilterAction::CopyToFolder)</span>
<a href="#l9.33"></a><span id="l9.33">     {</span>
<a href="#l9.34"></a><span id="l9.34" class="difflineat">@@ -608,41 +608,41 @@ nsMsgFilter::LogRuleHitGeneric(nsIMsgRul</span>
<a href="#l9.35"></a><span id="l9.35">       NS_ConvertASCIItoUTF16 msgIdValue(msgId);</span>
<a href="#l9.36"></a><span id="l9.36"> </span>
<a href="#l9.37"></a><span id="l9.37">       const char16_t *logMoveFormatStrings[2] = { msgIdValue.get(), actionFolderUriValue.get() };</span>
<a href="#l9.38"></a><span id="l9.38">       nsString logMoveStr;</span>
<a href="#l9.39"></a><span id="l9.39">       rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l9.40"></a><span id="l9.40">         (actionType == nsMsgFilterAction::MoveToFolder) ?</span>
<a href="#l9.41"></a><span id="l9.41">           &quot;logMoveStr&quot; : &quot;logCopyStr&quot;,</span>
<a href="#l9.42"></a><span id="l9.42">         logMoveFormatStrings, 2,</span>
<a href="#l9.43"></a><span id="l9.43" class="difflineminus">-        getter_Copies(logMoveStr));</span>
<a href="#l9.44"></a><span id="l9.44" class="difflineplus">+        logMoveStr);</span>
<a href="#l9.45"></a><span id="l9.45">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l9.46"></a><span id="l9.46"> </span>
<a href="#l9.47"></a><span id="l9.47">       buffer += NS_ConvertUTF16toUTF8(logMoveStr);</span>
<a href="#l9.48"></a><span id="l9.48">     }</span>
<a href="#l9.49"></a><span id="l9.49">     else if (actionType == nsMsgFilterAction::Custom)</span>
<a href="#l9.50"></a><span id="l9.50">     {</span>
<a href="#l9.51"></a><span id="l9.51">       nsCOMPtr&lt;nsIMsgFilterCustomAction&gt; customAction;</span>
<a href="#l9.52"></a><span id="l9.52">       nsAutoString filterActionName;</span>
<a href="#l9.53"></a><span id="l9.53">       rv = aFilterAction-&gt;GetCustomAction(getter_AddRefs(customAction));</span>
<a href="#l9.54"></a><span id="l9.54">       if (NS_SUCCEEDED(rv) &amp;&amp; customAction)</span>
<a href="#l9.55"></a><span id="l9.55">         customAction-&gt;GetName(filterActionName);</span>
<a href="#l9.56"></a><span id="l9.56">       if (filterActionName.IsEmpty())</span>
<a href="#l9.57"></a><span id="l9.57">         bundle-&gt;GetStringFromName(</span>
<a href="#l9.58"></a><span id="l9.58">                   &quot;filterMissingCustomAction&quot;,</span>
<a href="#l9.59"></a><span id="l9.59" class="difflineminus">-                  getter_Copies(filterActionName));</span>
<a href="#l9.60"></a><span id="l9.60" class="difflineplus">+                  filterActionName);</span>
<a href="#l9.61"></a><span id="l9.61">       buffer += NS_ConvertUTF16toUTF8(filterActionName);</span>
<a href="#l9.62"></a><span id="l9.62">     }</span>
<a href="#l9.63"></a><span id="l9.63">     else</span>
<a href="#l9.64"></a><span id="l9.64">     {</span>
<a href="#l9.65"></a><span id="l9.65">       nsString actionValue;</span>
<a href="#l9.66"></a><span id="l9.66">       nsAutoCString filterActionID;</span>
<a href="#l9.67"></a><span id="l9.67">       filterActionID = NS_LITERAL_CSTRING(&quot;filterAction&quot;);</span>
<a href="#l9.68"></a><span id="l9.68">       filterActionID.AppendInt(actionType);</span>
<a href="#l9.69"></a><span id="l9.69" class="difflineminus">-      rv = bundle-&gt;GetStringFromName(filterActionID.get(), getter_Copies(actionValue));</span>
<a href="#l9.70"></a><span id="l9.70" class="difflineplus">+      rv = bundle-&gt;GetStringFromName(filterActionID.get(), actionValue);</span>
<a href="#l9.71"></a><span id="l9.71">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l9.72"></a><span id="l9.72"> </span>
<a href="#l9.73"></a><span id="l9.73">       buffer += NS_ConvertUTF16toUTF8(actionValue);</span>
<a href="#l9.74"></a><span id="l9.74">     }</span>
<a href="#l9.75"></a><span id="l9.75">     buffer += &quot;\n&quot;;</span>
<a href="#l9.76"></a><span id="l9.76"> </span>
<a href="#l9.77"></a><span id="l9.77">     // Prepare timestamp</span>
<a href="#l9.78"></a><span id="l9.78">     PR_ExplodeTime(PR_Now(), PR_LocalTimeParameters, &amp;exploded);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgFilterService.cpp</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgFilterService.cpp</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -204,26 +204,23 @@ nsresult nsMsgFilterService::BackUpFilte</span>
<a href="#l10.4"></a><span id="l10.4"> }</span>
<a href="#l10.5"></a><span id="l10.5"> </span>
<a href="#l10.6"></a><span id="l10.6"> nsresult nsMsgFilterService::AlertBackingUpFilterFile(nsIMsgWindow *aMsgWindow)</span>
<a href="#l10.7"></a><span id="l10.7"> {</span>
<a href="#l10.8"></a><span id="l10.8">   return ThrowAlertMsg(&quot;filterListBackUpMsg&quot;, aMsgWindow);</span>
<a href="#l10.9"></a><span id="l10.9"> }</span>
<a href="#l10.10"></a><span id="l10.10"> </span>
<a href="#l10.11"></a><span id="l10.11"> nsresult //Do not use this routine if you have to call it very often because it creates a new bundle each time</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-nsMsgFilterService::GetStringFromBundle(const char *aMsgName, char16_t **aResult)</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+nsMsgFilterService::GetStringFromBundle(const char *aMsgName, nsAString&amp; aResult)</span>
<a href="#l10.14"></a><span id="l10.14"> {</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineminus">-  NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineminus">-</span>
<a href="#l10.17"></a><span id="l10.17">   nsCOMPtr &lt;nsIStringBundle&gt; bundle;</span>
<a href="#l10.18"></a><span id="l10.18">   nsresult rv = GetFilterStringBundle(getter_AddRefs(bundle));</span>
<a href="#l10.19"></a><span id="l10.19">   if (NS_SUCCEEDED(rv) &amp;&amp; bundle)</span>
<a href="#l10.20"></a><span id="l10.20">     rv = bundle-&gt;GetStringFromName(aMsgName, aResult);</span>
<a href="#l10.21"></a><span id="l10.21">   return rv;</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineminus">-</span>
<a href="#l10.23"></a><span id="l10.23"> }</span>
<a href="#l10.24"></a><span id="l10.24"> </span>
<a href="#l10.25"></a><span id="l10.25"> nsresult</span>
<a href="#l10.26"></a><span id="l10.26"> nsMsgFilterService::GetFilterStringBundle(nsIStringBundle **aBundle)</span>
<a href="#l10.27"></a><span id="l10.27"> {</span>
<a href="#l10.28"></a><span id="l10.28">   NS_ENSURE_ARG_POINTER(aBundle);</span>
<a href="#l10.29"></a><span id="l10.29"> </span>
<a href="#l10.30"></a><span id="l10.30">   nsCOMPtr&lt;nsIStringBundleService&gt; bundleService =</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineat">@@ -236,17 +233,17 @@ nsMsgFilterService::GetFilterStringBundl</span>
<a href="#l10.32"></a><span id="l10.32">   NS_IF_ADDREF(*aBundle = bundle);</span>
<a href="#l10.33"></a><span id="l10.33">   return NS_OK;</span>
<a href="#l10.34"></a><span id="l10.34"> }</span>
<a href="#l10.35"></a><span id="l10.35"> </span>
<a href="#l10.36"></a><span id="l10.36"> nsresult</span>
<a href="#l10.37"></a><span id="l10.37"> nsMsgFilterService::ThrowAlertMsg(const char*aMsgName, nsIMsgWindow *aMsgWindow)</span>
<a href="#l10.38"></a><span id="l10.38"> {</span>
<a href="#l10.39"></a><span id="l10.39">   nsString alertString;</span>
<a href="#l10.40"></a><span id="l10.40" class="difflineminus">-  nsresult rv = GetStringFromBundle(aMsgName, getter_Copies(alertString));</span>
<a href="#l10.41"></a><span id="l10.41" class="difflineplus">+  nsresult rv = GetStringFromBundle(aMsgName, alertString);</span>
<a href="#l10.42"></a><span id="l10.42">   nsCOMPtr&lt;nsIMsgWindow&gt; msgWindow(do_QueryInterface(aMsgWindow));</span>
<a href="#l10.43"></a><span id="l10.43">   if (!msgWindow) {</span>
<a href="#l10.44"></a><span id="l10.44">     nsCOMPtr&lt;nsIMsgMailSession&gt; mailSession ( do_GetService(NS_MSGMAILSESSION_CONTRACTID, &amp;rv));</span>
<a href="#l10.45"></a><span id="l10.45">     if (NS_SUCCEEDED(rv))</span>
<a href="#l10.46"></a><span id="l10.46">       rv = mailSession-&gt;GetTopmostMsgWindow(getter_AddRefs(msgWindow));</span>
<a href="#l10.47"></a><span id="l10.47">   }</span>
<a href="#l10.48"></a><span id="l10.48"> </span>
<a href="#l10.49"></a><span id="l10.49">   if (NS_SUCCEEDED(rv) &amp;&amp; !alertString.IsEmpty() &amp;&amp; msgWindow)</span>
<a href="#l10.50"></a><span id="l10.50" class="difflineat">@@ -1177,17 +1174,17 @@ bool nsMsgFilterAfterTheFact::ContinueEx</span>
<a href="#l10.51"></a><span id="l10.51">   m_curFilter-&gt;GetFilterName(filterName);</span>
<a href="#l10.52"></a><span id="l10.52">   nsString formatString;</span>
<a href="#l10.53"></a><span id="l10.53">   nsString confirmText;</span>
<a href="#l10.54"></a><span id="l10.54">   const char16_t *formatStrings[] =</span>
<a href="#l10.55"></a><span id="l10.55">   {</span>
<a href="#l10.56"></a><span id="l10.56">     filterName.get()</span>
<a href="#l10.57"></a><span id="l10.57">   };</span>
<a href="#l10.58"></a><span id="l10.58">   nsresult rv = bundle-&gt;FormatStringFromName(&quot;continueFilterExecution&quot;,</span>
<a href="#l10.59"></a><span id="l10.59" class="difflineminus">-                                             formatStrings, 1, getter_Copies(confirmText));</span>
<a href="#l10.60"></a><span id="l10.60" class="difflineplus">+                                             formatStrings, 1, confirmText);</span>
<a href="#l10.61"></a><span id="l10.61">   if (NS_FAILED(rv))</span>
<a href="#l10.62"></a><span id="l10.62">     return false;</span>
<a href="#l10.63"></a><span id="l10.63">   bool returnVal = false;</span>
<a href="#l10.64"></a><span id="l10.64">   (void) DisplayConfirmationPrompt(m_msgWindow, confirmText.get(), &amp;returnVal);</span>
<a href="#l10.65"></a><span id="l10.65">   return returnVal;</span>
<a href="#l10.66"></a><span id="l10.66"> }</span>
<a href="#l10.67"></a><span id="l10.67"> </span>
<a href="#l10.68"></a><span id="l10.68"> nsresult</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/base/search/src/nsMsgFilterService.h</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/base/search/src/nsMsgFilterService.h</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -26,17 +26,17 @@ public:</span>
<a href="#l11.4"></a><span id="l11.4">   NS_DECL_NSIMSGFILTERSERVICE</span>
<a href="#l11.5"></a><span id="l11.5"> /* clients call OpenFilterList to get a handle to a FilterList, of existing nsMsgFilter *.</span>
<a href="#l11.6"></a><span id="l11.6">   These are manipulated by the front end as a result of user interaction</span>
<a href="#l11.7"></a><span id="l11.7">    with dialog boxes. To apply the new list call MSG_CloseFilterList.</span>
<a href="#l11.8"></a><span id="l11.8"> */</span>
<a href="#l11.9"></a><span id="l11.9">   nsresult BackUpFilterFile(nsIFile *aFilterFile, nsIMsgWindow *aMsgWindow);</span>
<a href="#l11.10"></a><span id="l11.10">   nsresult AlertBackingUpFilterFile(nsIMsgWindow *aMsgWindow);</span>
<a href="#l11.11"></a><span id="l11.11">   nsresult ThrowAlertMsg(const char*aMsgName, nsIMsgWindow *aMsgWindow);</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-  nsresult GetStringFromBundle(const char *aMsgName, char16_t **aResult);</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+  nsresult GetStringFromBundle(const char *aMsgName, nsAString&amp; aResult);</span>
<a href="#l11.14"></a><span id="l11.14">   nsresult GetFilterStringBundle(nsIStringBundle **aBundle);</span>
<a href="#l11.15"></a><span id="l11.15"> </span>
<a href="#l11.16"></a><span id="l11.16"> protected:</span>
<a href="#l11.17"></a><span id="l11.17">   virtual ~nsMsgFilterService();</span>
<a href="#l11.18"></a><span id="l11.18"> </span>
<a href="#l11.19"></a><span id="l11.19">   nsCOMArray&lt;nsIMsgFilterCustomAction&gt; mCustomActions; // defined custom action list</span>
<a href="#l11.20"></a><span id="l11.20">   nsCOMArray&lt;nsIMsgSearchCustomTerm&gt; mCustomTerms; // defined custom term list</span>
<a href="#l11.21"></a><span id="l11.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/base/src/nsMessenger.cpp</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/base/src/nsMessenger.cpp</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -323,17 +323,17 @@ nsMessenger::PromptIfFileExists(nsIFile </span>
<a href="#l12.4"></a><span id="l12.4"> </span>
<a href="#l12.5"></a><span id="l12.5">     if (!mStringBundle)</span>
<a href="#l12.6"></a><span id="l12.6">     {</span>
<a href="#l12.7"></a><span id="l12.7">       rv = InitStringBundle();</span>
<a href="#l12.8"></a><span id="l12.8">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l12.9"></a><span id="l12.9">     }</span>
<a href="#l12.10"></a><span id="l12.10">     rv = mStringBundle-&gt;FormatStringFromName(&quot;fileExists&quot;,</span>
<a href="#l12.11"></a><span id="l12.11">                                              pathFormatStrings, 1,</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-                                             getter_Copies(errorMessage));</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+                                             errorMessage);</span>
<a href="#l12.14"></a><span id="l12.14">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l12.15"></a><span id="l12.15">     rv = dialog-&gt;Confirm(nullptr, errorMessage.get(), &amp;dialogResult);</span>
<a href="#l12.16"></a><span id="l12.16">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l12.17"></a><span id="l12.17"> </span>
<a href="#l12.18"></a><span id="l12.18">     if (dialogResult)</span>
<a href="#l12.19"></a><span id="l12.19">     {</span>
<a href="#l12.20"></a><span id="l12.20">       return NS_OK; // user says okay to replace</span>
<a href="#l12.21"></a><span id="l12.21">     }</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineat">@@ -839,17 +839,17 @@ nsMessenger::SaveOneAttachment(const cha</span>
<a href="#l12.23"></a><span id="l12.23">     {</span>
<a href="#l12.24"></a><span id="l12.24">       rv = InitStringBundle();</span>
<a href="#l12.25"></a><span id="l12.25">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l12.26"></a><span id="l12.26">     }</span>
<a href="#l12.27"></a><span id="l12.27"> </span>
<a href="#l12.28"></a><span id="l12.28">     nsString filterName;</span>
<a href="#l12.29"></a><span id="l12.29">     const char16_t *extensionParam[] = { extension.get() };</span>
<a href="#l12.30"></a><span id="l12.30">     rv = mStringBundle-&gt;FormatStringFromName(</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineminus">-      &quot;saveAsType&quot;, extensionParam, 1, getter_Copies(filterName));</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+      &quot;saveAsType&quot;, extensionParam, 1, filterName);</span>
<a href="#l12.33"></a><span id="l12.33">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l12.34"></a><span id="l12.34"> </span>
<a href="#l12.35"></a><span id="l12.35">     extension.Insert(NS_LITERAL_STRING(&quot;*.&quot;), 0);</span>
<a href="#l12.36"></a><span id="l12.36">     filePicker-&gt;AppendFilter(filterName, extension);</span>
<a href="#l12.37"></a><span id="l12.37">   }</span>
<a href="#l12.38"></a><span id="l12.38"> </span>
<a href="#l12.39"></a><span id="l12.39">   filePicker-&gt;AppendFilters(nsIFilePicker::filterAll);</span>
<a href="#l12.40"></a><span id="l12.40"> </span>
<a href="#l12.41"></a><span id="l12.41" class="difflineat">@@ -2040,17 +2040,17 @@ nsMessenger::GetString(const nsString&amp; a</span>
<a href="#l12.42"></a><span id="l12.42"> {</span>
<a href="#l12.43"></a><span id="l12.43">   nsresult rv;</span>
<a href="#l12.44"></a><span id="l12.44">   aValue.Truncate();</span>
<a href="#l12.45"></a><span id="l12.45"> </span>
<a href="#l12.46"></a><span id="l12.46">   if (!mStringBundle)</span>
<a href="#l12.47"></a><span id="l12.47">     rv = InitStringBundle();</span>
<a href="#l12.48"></a><span id="l12.48"> </span>
<a href="#l12.49"></a><span id="l12.49">   if (mStringBundle)</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineminus">-    rv = mStringBundle-&gt;GetStringFromName(NS_ConvertUTF16toUTF8(aStringName).get(), getter_Copies(aValue));</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineplus">+    rv = mStringBundle-&gt;GetStringFromName(NS_ConvertUTF16toUTF8(aStringName).get(), aValue);</span>
<a href="#l12.52"></a><span id="l12.52">   else</span>
<a href="#l12.53"></a><span id="l12.53">     rv = NS_ERROR_FAILURE;</span>
<a href="#l12.54"></a><span id="l12.54"> </span>
<a href="#l12.55"></a><span id="l12.55">   if (NS_FAILED(rv) || aValue.IsEmpty())</span>
<a href="#l12.56"></a><span id="l12.56">     aValue = aStringName;</span>
<a href="#l12.57"></a><span id="l12.57">   return;</span>
<a href="#l12.58"></a><span id="l12.58"> }</span>
<a href="#l12.59"></a><span id="l12.59"> </span>
<a href="#l12.60"></a><span id="l12.60" class="difflineat">@@ -3067,17 +3067,17 @@ nsMessenger::PromptIfDeleteAttachments(b</span>
<a href="#l12.61"></a><span id="l12.61">     attachmentList.Append(char16_t('\n'));</span>
<a href="#l12.62"></a><span id="l12.62">   }</span>
<a href="#l12.63"></a><span id="l12.63">   const char16_t *formatStrings[] = { attachmentList.get() };</span>
<a href="#l12.64"></a><span id="l12.64"> </span>
<a href="#l12.65"></a><span id="l12.65">   // format the message and display</span>
<a href="#l12.66"></a><span id="l12.66">   nsString promptMessage;</span>
<a href="#l12.67"></a><span id="l12.67">   const char * propertyName = aSaveFirst ?</span>
<a href="#l12.68"></a><span id="l12.68">     &quot;detachAttachments&quot; : &quot;deleteAttachments&quot;;</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineminus">-  rv = mStringBundle-&gt;FormatStringFromName(propertyName, formatStrings, 1,getter_Copies(promptMessage));</span>
<a href="#l12.70"></a><span id="l12.70" class="difflineplus">+  rv = mStringBundle-&gt;FormatStringFromName(propertyName, formatStrings, 1,promptMessage);</span>
<a href="#l12.71"></a><span id="l12.71">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l12.72"></a><span id="l12.72"> </span>
<a href="#l12.73"></a><span id="l12.73">   bool dialogResult = false;</span>
<a href="#l12.74"></a><span id="l12.74">   rv = dialog-&gt;Confirm(nullptr, promptMessage.get(), &amp;dialogResult);</span>
<a href="#l12.75"></a><span id="l12.75">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l12.76"></a><span id="l12.76"> </span>
<a href="#l12.77"></a><span id="l12.77">   return dialogResult ? NS_OK : NS_ERROR_FAILURE;</span>
<a href="#l12.78"></a><span id="l12.78"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/base/src/nsMessengerOSXIntegration.mm</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/base/src/nsMessengerOSXIntegration.mm</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -331,28 +331,28 @@ nsMessengerOSXIntegration::FillToolTipIn</span>
<a href="#l13.4"></a><span id="l13.4">       if (numNotDisplayed &gt; 0)</span>
<a href="#l13.5"></a><span id="l13.5">       {</span>
<a href="#l13.6"></a><span id="l13.6">         nsAutoString numNotDisplayedText;</span>
<a href="#l13.7"></a><span id="l13.7">         numNotDisplayedText.AppendInt(numNotDisplayed);</span>
<a href="#l13.8"></a><span id="l13.8">         const char16_t *formatStrings[3] = { numNewMsgsText.get(), authors.get(), numNotDisplayedText.get() };</span>
<a href="#l13.9"></a><span id="l13.9">         bundle-&gt;FormatStringFromName(&quot;macBiffNotification_messages_extra&quot;,</span>
<a href="#l13.10"></a><span id="l13.10">                                      formatStrings,</span>
<a href="#l13.11"></a><span id="l13.11">                                      3,</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-                                     getter_Copies(finalText));</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+                                     finalText);</span>
<a href="#l13.14"></a><span id="l13.14">       }</span>
<a href="#l13.15"></a><span id="l13.15">       else</span>
<a href="#l13.16"></a><span id="l13.16">       {</span>
<a href="#l13.17"></a><span id="l13.17">         const char16_t *formatStrings[2] = { numNewMsgsText.get(), authors.get() };</span>
<a href="#l13.18"></a><span id="l13.18"> </span>
<a href="#l13.19"></a><span id="l13.19">         if (aNewCount == 1)</span>
<a href="#l13.20"></a><span id="l13.20">         {</span>
<a href="#l13.21"></a><span id="l13.21">           bundle-&gt;FormatStringFromName(&quot;macBiffNotification_message&quot;,</span>
<a href="#l13.22"></a><span id="l13.22">                                        formatStrings,</span>
<a href="#l13.23"></a><span id="l13.23">                                        2,</span>
<a href="#l13.24"></a><span id="l13.24" class="difflineminus">-                                       getter_Copies(finalText));</span>
<a href="#l13.25"></a><span id="l13.25" class="difflineplus">+                                       finalText);</span>
<a href="#l13.26"></a><span id="l13.26">           // Since there is only 1 message, use the most recent mail's URI instead of the folder's</span>
<a href="#l13.27"></a><span id="l13.27">           nsCOMPtr&lt;nsIMsgDatabase&gt; db;</span>
<a href="#l13.28"></a><span id="l13.28">           rv = aFolder-&gt;GetMsgDatabase(getter_AddRefs(db));</span>
<a href="#l13.29"></a><span id="l13.29">           if (NS_SUCCEEDED(rv) &amp;&amp; db)</span>
<a href="#l13.30"></a><span id="l13.30">           {</span>
<a href="#l13.31"></a><span id="l13.31">             uint32_t numNewKeys;</span>
<a href="#l13.32"></a><span id="l13.32">             uint32_t *newMessageKeys;</span>
<a href="#l13.33"></a><span id="l13.33">             rv = db-&gt;GetNewList(&amp;numNewKeys, &amp;newMessageKeys);</span>
<a href="#l13.34"></a><span id="l13.34" class="difflineat">@@ -366,17 +366,17 @@ nsMessengerOSXIntegration::FillToolTipIn</span>
<a href="#l13.35"></a><span id="l13.35">             }</span>
<a href="#l13.36"></a><span id="l13.36">             NS_Free(newMessageKeys);</span>
<a href="#l13.37"></a><span id="l13.37">           }</span>
<a href="#l13.38"></a><span id="l13.38">         }</span>
<a href="#l13.39"></a><span id="l13.39">         else</span>
<a href="#l13.40"></a><span id="l13.40">           bundle-&gt;FormatStringFromName(&quot;macBiffNotification_messages&quot;,</span>
<a href="#l13.41"></a><span id="l13.41">                                        formatStrings,</span>
<a href="#l13.42"></a><span id="l13.42">                                        2,</span>
<a href="#l13.43"></a><span id="l13.43" class="difflineminus">-                                       getter_Copies(finalText));</span>
<a href="#l13.44"></a><span id="l13.44" class="difflineplus">+                                       finalText);</span>
<a href="#l13.45"></a><span id="l13.45">       }</span>
<a href="#l13.46"></a><span id="l13.46">       ShowAlertMessage(accountName, finalText, uri);</span>
<a href="#l13.47"></a><span id="l13.47">     } // if we got a bundle</span>
<a href="#l13.48"></a><span id="l13.48">   } // if we got a folder</span>
<a href="#l13.49"></a><span id="l13.49"> }</span>
<a href="#l13.50"></a><span id="l13.50"> </span>
<a href="#l13.51"></a><span id="l13.51"> nsresult</span>
<a href="#l13.52"></a><span id="l13.52"> nsMessengerOSXIntegration::ShowAlertMessage(const nsAString&amp; aAlertTitle,</span>
<a href="#l13.53"></a><span id="l13.53" class="difflineat">@@ -621,17 +621,17 @@ nsMessengerOSXIntegration::GetNewMailAut</span>
<a href="#l13.54"></a><span id="l13.54">     if (!bundle)</span>
<a href="#l13.55"></a><span id="l13.55">       return NS_ERROR_FAILURE;</span>
<a href="#l13.56"></a><span id="l13.56"> </span>
<a href="#l13.57"></a><span id="l13.57">     uint32_t *newMessageKeys;</span>
<a href="#l13.58"></a><span id="l13.58">     rv = db-&gt;GetNewList(&amp;numNewKeys, &amp;newMessageKeys);</span>
<a href="#l13.59"></a><span id="l13.59">     if (NS_SUCCEEDED(rv))</span>
<a href="#l13.60"></a><span id="l13.60">     {</span>
<a href="#l13.61"></a><span id="l13.61">       nsString listSeparator;</span>
<a href="#l13.62"></a><span id="l13.62" class="difflineminus">-      bundle-&gt;GetStringFromName(&quot;macBiffNotification_separator&quot;, getter_Copies(listSeparator));</span>
<a href="#l13.63"></a><span id="l13.63" class="difflineplus">+      bundle-&gt;GetStringFromName(&quot;macBiffNotification_separator&quot;, listSeparator);</span>
<a href="#l13.64"></a><span id="l13.64"> </span>
<a href="#l13.65"></a><span id="l13.65">       int32_t displayed = 0;</span>
<a href="#l13.66"></a><span id="l13.66">       for (int32_t i = numNewKeys - 1; i &gt;= 0; i--, aNewCount--)</span>
<a href="#l13.67"></a><span id="l13.67">       {</span>
<a href="#l13.68"></a><span id="l13.68">         if (0 == aNewCount || displayed == kMaxDisplayCount)</span>
<a href="#l13.69"></a><span id="l13.69">           break;</span>
<a href="#l13.70"></a><span id="l13.70"> </span>
<a href="#l13.71"></a><span id="l13.71">         nsCOMPtr&lt;nsIMsgDBHdr&gt; hdr;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/base/src/nsMessengerUnixIntegration.cpp</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/base/src/nsMessengerUnixIntegration.cpp</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -173,17 +173,17 @@ nsMessengerUnixIntegration::BuildNotific</span>
<a href="#l14.4"></a><span id="l14.4">   const char16_t *formatStrings[] =</span>
<a href="#l14.5"></a><span id="l14.5">   {</span>
<a href="#l14.6"></a><span id="l14.6">     accountName.get(), numNewMsgsText.get()</span>
<a href="#l14.7"></a><span id="l14.7">   };</span>
<a href="#l14.8"></a><span id="l14.8"> </span>
<a href="#l14.9"></a><span id="l14.9">   aBundle-&gt;FormatStringFromName(numNewMessages == 1 ?</span>
<a href="#l14.10"></a><span id="l14.10">                                   &quot;newMailNotification_message&quot; :</span>
<a href="#l14.11"></a><span id="l14.11">                                   &quot;newMailNotification_messages&quot;,</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-                                formatStrings, 2, getter_Copies(aTitle));</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+                                formatStrings, 2, aTitle);</span>
<a href="#l14.14"></a><span id="l14.14">   return true;</span>
<a href="#l14.15"></a><span id="l14.15"> }</span>
<a href="#l14.16"></a><span id="l14.16"> </span>
<a href="#l14.17"></a><span id="l14.17"> /* This comparator lets us sort an nsCOMArray of nsIMsgDBHdr's by</span>
<a href="#l14.18"></a><span id="l14.18">  * their dateInSeconds attributes in ascending order.</span>
<a href="#l14.19"></a><span id="l14.19">  */</span>
<a href="#l14.20"></a><span id="l14.20"> static int</span>
<a href="#l14.21"></a><span id="l14.21"> nsMsgDbHdrTimestampComparator(nsIMsgDBHdr *aElement1,</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineat">@@ -291,17 +291,17 @@ nsMessengerUnixIntegration::BuildNotific</span>
<a href="#l14.23"></a><span id="l14.23">   if (showSubject &amp;&amp; showSender)</span>
<a href="#l14.24"></a><span id="l14.24">   {</span>
<a href="#l14.25"></a><span id="l14.25">     nsString msgTitle;</span>
<a href="#l14.26"></a><span id="l14.26">     const char16_t *formatStrings[] =</span>
<a href="#l14.27"></a><span id="l14.27">     {</span>
<a href="#l14.28"></a><span id="l14.28">       subject.get(), author.get()</span>
<a href="#l14.29"></a><span id="l14.29">     };</span>
<a href="#l14.30"></a><span id="l14.30">     aBundle-&gt;FormatStringFromName(&quot;newMailNotification_messagetitle&quot;,</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineminus">-        formatStrings, 2, getter_Copies(msgTitle));</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+        formatStrings, 2, msgTitle);</span>
<a href="#l14.33"></a><span id="l14.33">     alertBody.Append(msgTitle);</span>
<a href="#l14.34"></a><span id="l14.34">   }</span>
<a href="#l14.35"></a><span id="l14.35">   else if (showSubject)</span>
<a href="#l14.36"></a><span id="l14.36">     alertBody.Append(subject);</span>
<a href="#l14.37"></a><span id="l14.37">   else if (showSender)</span>
<a href="#l14.38"></a><span id="l14.38">     alertBody.Append(author);</span>
<a href="#l14.39"></a><span id="l14.39"> </span>
<a href="#l14.40"></a><span id="l14.40">   if (showPreview &amp;&amp; (showSubject || showSender))</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/base/src/nsMessengerWinIntegration.cpp</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/base/src/nsMessengerWinIntegration.cpp</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -676,19 +676,19 @@ void nsMessengerWinIntegration::FillTool</span>
<a href="#l15.4"></a><span id="l15.4"> </span>
<a href="#l15.5"></a><span id="l15.5">         const char16_t *formatStrings[] =</span>
<a href="#l15.6"></a><span id="l15.6">         {</span>
<a href="#l15.7"></a><span id="l15.7">           numNewMsgsText.get(),</span>
<a href="#l15.8"></a><span id="l15.8">         };</span>
<a href="#l15.9"></a><span id="l15.9"> </span>
<a href="#l15.10"></a><span id="l15.10">         nsString finalText;</span>
<a href="#l15.11"></a><span id="l15.11">         if (numNewMessages == 1)</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-          bundle-&gt;FormatStringFromName(&quot;biffNotification_message&quot;, formatStrings, 1, getter_Copies(finalText));</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+          bundle-&gt;FormatStringFromName(&quot;biffNotification_message&quot;, formatStrings, 1, finalText);</span>
<a href="#l15.14"></a><span id="l15.14">         else</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">-          bundle-&gt;FormatStringFromName(&quot;biffNotification_messages&quot;, formatStrings, 1, getter_Copies(finalText));</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineplus">+          bundle-&gt;FormatStringFromName(&quot;biffNotification_messages&quot;, formatStrings, 1, finalText);</span>
<a href="#l15.17"></a><span id="l15.17"> </span>
<a href="#l15.18"></a><span id="l15.18">         // the alert message is special...we actually only want to show the first account with</span>
<a href="#l15.19"></a><span id="l15.19">         // new mail in the alert.</span>
<a href="#l15.20"></a><span id="l15.20">         if (animatedAlertText.IsEmpty()) // if we haven't filled in the animated alert text yet</span>
<a href="#l15.21"></a><span id="l15.21">           animatedAlertText = finalText;</span>
<a href="#l15.22"></a><span id="l15.22"> </span>
<a href="#l15.23"></a><span id="l15.23">         toolTipLine.Append(accountName);</span>
<a href="#l15.24"></a><span id="l15.24">         toolTipLine.Append(' ');</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/base/src/nsMsgAccountManager.cpp</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgAccountManager.cpp</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -2295,17 +2295,17 @@ nsresult nsMsgAccountManager::GetLocalFo</span>
<a href="#l16.4"></a><span id="l16.4">   nsCOMPtr&lt;nsIStringBundleService&gt; sBundleService =</span>
<a href="#l16.5"></a><span id="l16.5">     mozilla::services::GetStringBundleService();</span>
<a href="#l16.6"></a><span id="l16.6">   NS_ENSURE_TRUE(sBundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l16.7"></a><span id="l16.7"> </span>
<a href="#l16.8"></a><span id="l16.8">   rv = sBundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/messenger.properties&quot;,</span>
<a href="#l16.9"></a><span id="l16.9">                                     getter_AddRefs(bundle));</span>
<a href="#l16.10"></a><span id="l16.10">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l16.11"></a><span id="l16.11"> </span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-  return bundle-&gt;GetStringFromName(&quot;localFolders&quot;, getter_Copies(localFoldersName));</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+  return bundle-&gt;GetStringFromName(&quot;localFolders&quot;, localFoldersName);</span>
<a href="#l16.14"></a><span id="l16.14"> }</span>
<a href="#l16.15"></a><span id="l16.15"> </span>
<a href="#l16.16"></a><span id="l16.16"> NS_IMETHODIMP</span>
<a href="#l16.17"></a><span id="l16.17"> nsMsgAccountManager::CreateLocalMailAccount()</span>
<a href="#l16.18"></a><span id="l16.18"> {</span>
<a href="#l16.19"></a><span id="l16.19">   // create the server</span>
<a href="#l16.20"></a><span id="l16.20">   nsCOMPtr&lt;nsIMsgIncomingServer&gt; server;</span>
<a href="#l16.21"></a><span id="l16.21">   nsresult rv = CreateIncomingServer(NS_LITERAL_CSTRING(&quot;nobody&quot;),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mailnews/base/src/nsMsgAccountManagerDS.cpp</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgAccountManagerDS.cpp</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -276,37 +276,30 @@ nsMsgAccountManagerDataSource::GetTarget</span>
<a href="#l17.4"></a><span id="l17.4">   if (property == kNC_Name || property == kNC_FolderTreeName ||</span>
<a href="#l17.5"></a><span id="l17.5">       property == kNC_FolderTreeSimpleName) </span>
<a href="#l17.6"></a><span id="l17.6">   {</span>
<a href="#l17.7"></a><span id="l17.7">     rv = getStringBundle();</span>
<a href="#l17.8"></a><span id="l17.8">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l17.9"></a><span id="l17.9"> </span>
<a href="#l17.10"></a><span id="l17.10">     nsString pageTitle;</span>
<a href="#l17.11"></a><span id="l17.11">     if (source == kNC_PageTitleServer)</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-      mStringBundle-&gt;GetStringFromName(&quot;prefPanel-server&quot;,</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineminus">-                                       getter_Copies(pageTitle));</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineplus">+      mStringBundle-&gt;GetStringFromName(&quot;prefPanel-server&quot;, pageTitle);</span>
<a href="#l17.15"></a><span id="l17.15"> </span>
<a href="#l17.16"></a><span id="l17.16">     else if (source == kNC_PageTitleCopies)</span>
<a href="#l17.17"></a><span id="l17.17" class="difflineminus">-      mStringBundle-&gt;GetStringFromName(&quot;prefPanel-copies&quot;,</span>
<a href="#l17.18"></a><span id="l17.18" class="difflineminus">-                                       getter_Copies(pageTitle));</span>
<a href="#l17.19"></a><span id="l17.19" class="difflineplus">+      mStringBundle-&gt;GetStringFromName(&quot;prefPanel-copies&quot;, pageTitle);</span>
<a href="#l17.20"></a><span id="l17.20">     else if (source == kNC_PageTitleSynchronization)</span>
<a href="#l17.21"></a><span id="l17.21" class="difflineminus">-      mStringBundle-&gt;GetStringFromName(&quot;prefPanel-synchronization&quot;,</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineminus">-                                       getter_Copies(pageTitle));</span>
<a href="#l17.23"></a><span id="l17.23" class="difflineplus">+      mStringBundle-&gt;GetStringFromName(&quot;prefPanel-synchronization&quot;, pageTitle);</span>
<a href="#l17.24"></a><span id="l17.24">     else if (source == kNC_PageTitleDiskSpace)</span>
<a href="#l17.25"></a><span id="l17.25" class="difflineminus">-      mStringBundle-&gt;GetStringFromName(&quot;prefPanel-diskspace&quot;,</span>
<a href="#l17.26"></a><span id="l17.26" class="difflineminus">-                                       getter_Copies(pageTitle));</span>
<a href="#l17.27"></a><span id="l17.27" class="difflineplus">+      mStringBundle-&gt;GetStringFromName(&quot;prefPanel-diskspace&quot;, pageTitle);</span>
<a href="#l17.28"></a><span id="l17.28">     else if (source == kNC_PageTitleAddressing)</span>
<a href="#l17.29"></a><span id="l17.29" class="difflineminus">-      mStringBundle-&gt;GetStringFromName(&quot;prefPanel-addressing&quot;,</span>
<a href="#l17.30"></a><span id="l17.30" class="difflineminus">-                                       getter_Copies(pageTitle));</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineplus">+      mStringBundle-&gt;GetStringFromName(&quot;prefPanel-addressing&quot;, pageTitle);</span>
<a href="#l17.32"></a><span id="l17.32">     else if (source == kNC_PageTitleSMTP)</span>
<a href="#l17.33"></a><span id="l17.33" class="difflineminus">-      mStringBundle-&gt;GetStringFromName(&quot;prefPanel-smtp&quot;,</span>
<a href="#l17.34"></a><span id="l17.34" class="difflineminus">-                                       getter_Copies(pageTitle));</span>
<a href="#l17.35"></a><span id="l17.35" class="difflineplus">+      mStringBundle-&gt;GetStringFromName(&quot;prefPanel-smtp&quot;, pageTitle);</span>
<a href="#l17.36"></a><span id="l17.36">     else if (source == kNC_PageTitleJunk)</span>
<a href="#l17.37"></a><span id="l17.37" class="difflineminus">-      mStringBundle-&gt;GetStringFromName(&quot;prefPanel-junk&quot;,</span>
<a href="#l17.38"></a><span id="l17.38" class="difflineminus">-                                       getter_Copies(pageTitle));</span>
<a href="#l17.39"></a><span id="l17.39" class="difflineplus">+      mStringBundle-&gt;GetStringFromName(&quot;prefPanel-junk&quot;, pageTitle);</span>
<a href="#l17.40"></a><span id="l17.40"> </span>
<a href="#l17.41"></a><span id="l17.41">     else {</span>
<a href="#l17.42"></a><span id="l17.42">       // if it's a server, use the pretty name</span>
<a href="#l17.43"></a><span id="l17.43">       nsCOMPtr&lt;nsIMsgFolder&gt; folder = do_QueryInterface(source, &amp;rv);</span>
<a href="#l17.44"></a><span id="l17.44">       if (NS_SUCCEEDED(rv) &amp;&amp; folder) {</span>
<a href="#l17.45"></a><span id="l17.45">         bool isServer;</span>
<a href="#l17.46"></a><span id="l17.46">         rv = folder-&gt;GetIsServer(&amp;isServer);</span>
<a href="#l17.47"></a><span id="l17.47">         if (NS_SUCCEEDED(rv) &amp;&amp; isServer)</span>
<a href="#l17.48"></a><span id="l17.48" class="difflineat">@@ -344,17 +337,17 @@ nsMsgAccountManagerDataSource::GetTarget</span>
<a href="#l17.49"></a><span id="l17.49">         nsCOMPtr &lt;nsIStringBundle&gt; bundle;</span>
<a href="#l17.50"></a><span id="l17.50">         rv = strBundleService-&gt;CreateBundle(bundleURL.get(), getter_AddRefs(bundle));</span>
<a href="#l17.51"></a><span id="l17.51"> </span>
<a href="#l17.52"></a><span id="l17.52">         NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l17.53"></a><span id="l17.53"> </span>
<a href="#l17.54"></a><span id="l17.54">         nsAutoCString panelTitleName;</span>
<a href="#l17.55"></a><span id="l17.55">         panelTitleName.AssignLiteral(&quot;prefPanel-&quot;);</span>
<a href="#l17.56"></a><span id="l17.56">         panelTitleName.Append(sourceValue + strlen(NC_RDF_PAGETITLE_PREFIX));</span>
<a href="#l17.57"></a><span id="l17.57" class="difflineminus">-        bundle-&gt;GetStringFromName(panelTitleName.get(), getter_Copies(pageTitle));</span>
<a href="#l17.58"></a><span id="l17.58" class="difflineplus">+        bundle-&gt;GetStringFromName(panelTitleName.get(), pageTitle);</span>
<a href="#l17.59"></a><span id="l17.59">       }</span>
<a href="#l17.60"></a><span id="l17.60">     }</span>
<a href="#l17.61"></a><span id="l17.61">     str = pageTitle.get();</span>
<a href="#l17.62"></a><span id="l17.62">   }</span>
<a href="#l17.63"></a><span id="l17.63">   else if (property == kNC_PageTag) {</span>
<a href="#l17.64"></a><span id="l17.64">     // do NOT localize these strings. these are the urls of the XUL files</span>
<a href="#l17.65"></a><span id="l17.65">     if (source == kNC_PageTitleServer)</span>
<a href="#l17.66"></a><span id="l17.66">       str.AssignLiteral(&quot;am-server.xul&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgDBView.cpp</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -206,32 +206,32 @@ nsresult nsMsgDBView::InitLabelStrings()</span>
<a href="#l18.4"></a><span id="l18.4">   }</span>
<a href="#l18.5"></a><span id="l18.5">   return rv;</span>
<a href="#l18.6"></a><span id="l18.6"> }</span>
<a href="#l18.7"></a><span id="l18.7"> </span>
<a href="#l18.8"></a><span id="l18.8"> // helper function used to fetch strings from the messenger string bundle</span>
<a href="#l18.9"></a><span id="l18.9"> char16_t * nsMsgDBView::GetString(const char16_t *aStringName)</span>
<a href="#l18.10"></a><span id="l18.10"> {</span>
<a href="#l18.11"></a><span id="l18.11">   nsresult    res = NS_ERROR_UNEXPECTED;</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-  char16_t   *ptrv = nullptr;</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+  nsAutoString str;</span>
<a href="#l18.14"></a><span id="l18.14"> </span>
<a href="#l18.15"></a><span id="l18.15">   if (!mMessengerStringBundle)</span>
<a href="#l18.16"></a><span id="l18.16">   {</span>
<a href="#l18.17"></a><span id="l18.17">     static const char propertyURL[] = MESSENGER_STRING_URL;</span>
<a href="#l18.18"></a><span id="l18.18">     nsCOMPtr&lt;nsIStringBundleService&gt; sBundleService =</span>
<a href="#l18.19"></a><span id="l18.19">       mozilla::services::GetStringBundleService();</span>
<a href="#l18.20"></a><span id="l18.20">     if (sBundleService)</span>
<a href="#l18.21"></a><span id="l18.21">       res = sBundleService-&gt;CreateBundle(propertyURL, getter_AddRefs(mMessengerStringBundle));</span>
<a href="#l18.22"></a><span id="l18.22">   }</span>
<a href="#l18.23"></a><span id="l18.23"> </span>
<a href="#l18.24"></a><span id="l18.24">   if (mMessengerStringBundle)</span>
<a href="#l18.25"></a><span id="l18.25" class="difflineminus">-    res = mMessengerStringBundle-&gt;GetStringFromName(NS_ConvertUTF16toUTF8(aStringName).get(), &amp;ptrv);</span>
<a href="#l18.26"></a><span id="l18.26" class="difflineminus">-</span>
<a href="#l18.27"></a><span id="l18.27" class="difflineminus">-  if ( NS_SUCCEEDED(res) &amp;&amp; (ptrv) )</span>
<a href="#l18.28"></a><span id="l18.28" class="difflineminus">-    return ptrv;</span>
<a href="#l18.29"></a><span id="l18.29" class="difflineplus">+    res = mMessengerStringBundle-&gt;GetStringFromName(NS_ConvertUTF16toUTF8(aStringName).get(), str);</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineplus">+</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineplus">+  if (NS_SUCCEEDED(res))</span>
<a href="#l18.32"></a><span id="l18.32" class="difflineplus">+    return ToNewUnicode(str);</span>
<a href="#l18.33"></a><span id="l18.33">   else</span>
<a href="#l18.34"></a><span id="l18.34">     return NS_strdup(aStringName);</span>
<a href="#l18.35"></a><span id="l18.35"> }</span>
<a href="#l18.36"></a><span id="l18.36"> </span>
<a href="#l18.37"></a><span id="l18.37"> // helper function used to fetch localized strings from the prefs</span>
<a href="#l18.38"></a><span id="l18.38"> nsresult nsMsgDBView::GetPrefLocalizedString(const char *aPrefName, nsString&amp; aResult)</span>
<a href="#l18.39"></a><span id="l18.39"> {</span>
<a href="#l18.40"></a><span id="l18.40">   nsresult rv = NS_OK;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/mailnews/base/src/nsMsgFolderCompactor.cpp</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgFolderCompactor.cpp</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -339,17 +339,17 @@ nsresult nsFolderCompactState::ShowStatu</span>
<a href="#l19.4"></a><span id="l19.4">     if (NS_FAILED(rv))</span>
<a href="#l19.5"></a><span id="l19.5">       break;</span>
<a href="#l19.6"></a><span id="l19.6">     nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l19.7"></a><span id="l19.7">     rv = GetBaseStringBundle(getter_AddRefs(bundle));</span>
<a href="#l19.8"></a><span id="l19.8">     if (NS_FAILED(rv))</span>
<a href="#l19.9"></a><span id="l19.9">       break;</span>
<a href="#l19.10"></a><span id="l19.10">     const char16_t *params[] = { accountName.get(), aMsg.get() };</span>
<a href="#l19.11"></a><span id="l19.11">     rv = bundle-&gt;FormatStringFromName(&quot;statusMessage&quot;,</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-                                      params, 2, getter_Copies(statusMessage));</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+                                      params, 2, statusMessage);</span>
<a href="#l19.14"></a><span id="l19.14">   } while (false);</span>
<a href="#l19.15"></a><span id="l19.15"> </span>
<a href="#l19.16"></a><span id="l19.16">   // If fetching any of the needed info failed, just show the original message.</span>
<a href="#l19.17"></a><span id="l19.17">   if (NS_FAILED(rv))</span>
<a href="#l19.18"></a><span id="l19.18">     statusMessage.Assign(aMsg);</span>
<a href="#l19.19"></a><span id="l19.19">   return statusFeedback-&gt;SetStatusString(statusMessage);</span>
<a href="#l19.20"></a><span id="l19.20"> }</span>
<a href="#l19.21"></a><span id="l19.21"> </span>
<a href="#l19.22"></a><span id="l19.22" class="difflineat">@@ -683,17 +683,17 @@ void nsFolderCompactState::ShowDoneStatu</span>
<a href="#l19.23"></a><span id="l19.23">     nsString statusString;</span>
<a href="#l19.24"></a><span id="l19.24">     nsCOMPtr &lt;nsIStringBundle&gt; bundle;</span>
<a href="#l19.25"></a><span id="l19.25">     nsresult rv = GetBaseStringBundle(getter_AddRefs(bundle));</span>
<a href="#l19.26"></a><span id="l19.26">     NS_ENSURE_SUCCESS_VOID(rv);</span>
<a href="#l19.27"></a><span id="l19.27">     nsAutoString expungedAmount;</span>
<a href="#l19.28"></a><span id="l19.28">     FormatFileSize(m_totalExpungedBytes, true, expungedAmount);</span>
<a href="#l19.29"></a><span id="l19.29">     const char16_t* params[] = { expungedAmount.get() };</span>
<a href="#l19.30"></a><span id="l19.30">     rv = bundle-&gt;FormatStringFromName(&quot;compactingDone&quot;,</span>
<a href="#l19.31"></a><span id="l19.31" class="difflineminus">-                                      params, 1, getter_Copies(statusString));</span>
<a href="#l19.32"></a><span id="l19.32" class="difflineplus">+                                      params, 1, statusString);</span>
<a href="#l19.33"></a><span id="l19.33"> </span>
<a href="#l19.34"></a><span id="l19.34">     if (!statusString.IsEmpty() &amp;&amp; NS_SUCCEEDED(rv))</span>
<a href="#l19.35"></a><span id="l19.35">       ShowStatusMsg(statusString);</span>
<a href="#l19.36"></a><span id="l19.36">   }</span>
<a href="#l19.37"></a><span id="l19.37"> }</span>
<a href="#l19.38"></a><span id="l19.38"> </span>
<a href="#l19.39"></a><span id="l19.39"> nsresult</span>
<a href="#l19.40"></a><span id="l19.40"> nsFolderCompactState::CompactNextFolder()</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/mailnews/base/src/nsMsgFolderDataSource.cpp</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgFolderDataSource.cpp</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -1982,17 +1982,17 @@ nsresult nsMsgFolderDataSource::DoDelete</span>
<a href="#l20.4"></a><span id="l20.4">         NS_ENSURE_ARG_POINTER(msgWindow);</span>
<a href="#l20.5"></a><span id="l20.5">         nsCOMPtr&lt;nsIStringBundleService&gt; sBundleService =</span>
<a href="#l20.6"></a><span id="l20.6">           mozilla::services::GetStringBundleService();</span>
<a href="#l20.7"></a><span id="l20.7">         NS_ENSURE_TRUE(sBundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l20.8"></a><span id="l20.8">         nsCOMPtr&lt;nsIStringBundle&gt; sMessengerStringBundle;</span>
<a href="#l20.9"></a><span id="l20.9">         nsString confirmMsg;</span>
<a href="#l20.10"></a><span id="l20.10">         rv = sBundleService-&gt;CreateBundle(MESSENGER_STRING_URL, getter_AddRefs(sMessengerStringBundle));</span>
<a href="#l20.11"></a><span id="l20.11">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-        sMessengerStringBundle-&gt;GetStringFromName(&quot;confirmSavedSearchDeleteMessage&quot;, getter_Copies(confirmMsg));</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+        sMessengerStringBundle-&gt;GetStringFromName(&quot;confirmSavedSearchDeleteMessage&quot;, confirmMsg);</span>
<a href="#l20.14"></a><span id="l20.14"> </span>
<a href="#l20.15"></a><span id="l20.15">         nsCOMPtr&lt;nsIPrompt&gt; dialog;</span>
<a href="#l20.16"></a><span id="l20.16">         rv = msgWindow-&gt;GetPromptDialog(getter_AddRefs(dialog));</span>
<a href="#l20.17"></a><span id="l20.17">         if (NS_SUCCEEDED(rv))</span>
<a href="#l20.18"></a><span id="l20.18">         {</span>
<a href="#l20.19"></a><span id="l20.19">           bool dialogResult;</span>
<a href="#l20.20"></a><span id="l20.20">           rv = dialog-&gt;Confirm(nullptr, confirmMsg.get(), &amp;dialogResult);</span>
<a href="#l20.21"></a><span id="l20.21">           if (!dialogResult)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/mailnews/base/src/nsMsgOfflineManager.cpp</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgOfflineManager.cpp</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -244,18 +244,17 @@ nsresult nsMsgOfflineManager::ShowStatus</span>
<a href="#l21.4"></a><span id="l21.4">     nsCOMPtr&lt;nsIStringBundleService&gt; sBundleService = </span>
<a href="#l21.5"></a><span id="l21.5">       mozilla::services::GetStringBundleService();</span>
<a href="#l21.6"></a><span id="l21.6">     NS_ENSURE_TRUE(sBundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l21.7"></a><span id="l21.7">     sBundleService-&gt;CreateBundle(MESSENGER_STRING_URL, getter_AddRefs(mStringBundle));</span>
<a href="#l21.8"></a><span id="l21.8">     return NS_OK;</span>
<a href="#l21.9"></a><span id="l21.9">   }</span>
<a href="#l21.10"></a><span id="l21.10"> </span>
<a href="#l21.11"></a><span id="l21.11">   nsString statusString;</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-  nsresult res = mStringBundle-&gt;GetStringFromName(statusMsgName,</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineminus">-						  getter_Copies(statusString));</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineplus">+  nsresult res = mStringBundle-&gt;GetStringFromName(statusMsgName, statusString);</span>
<a href="#l21.15"></a><span id="l21.15"> </span>
<a href="#l21.16"></a><span id="l21.16">   if (NS_SUCCEEDED(res) &amp;&amp; m_statusFeedback)</span>
<a href="#l21.17"></a><span id="l21.17">     m_statusFeedback-&gt;ShowStatusString(statusString);</span>
<a href="#l21.18"></a><span id="l21.18"> </span>
<a href="#l21.19"></a><span id="l21.19">   return res;</span>
<a href="#l21.20"></a><span id="l21.20"> }</span>
<a href="#l21.21"></a><span id="l21.21"> </span>
<a href="#l21.22"></a><span id="l21.22"> nsresult nsMsgOfflineManager::DownloadOfflineNewsgroups()</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/mailnews/base/src/nsMsgPrintEngine.cpp</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgPrintEngine.cpp</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -568,17 +568,17 @@ nsMsgPrintEngine::GetString(const char16</span>
<a href="#l22.4"></a><span id="l22.4"> </span>
<a href="#l22.5"></a><span id="l22.5">     nsCOMPtr&lt;nsIStringBundleService&gt; sBundleService = </span>
<a href="#l22.6"></a><span id="l22.6">       mozilla::services::GetStringBundleService();</span>
<a href="#l22.7"></a><span id="l22.7">     if (sBundleService)</span>
<a href="#l22.8"></a><span id="l22.8">       sBundleService-&gt;CreateBundle(propertyURL, getter_AddRefs(mStringBundle));</span>
<a href="#l22.9"></a><span id="l22.9">   }</span>
<a href="#l22.10"></a><span id="l22.10"> </span>
<a href="#l22.11"></a><span id="l22.11">   if (mStringBundle)</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-    mStringBundle-&gt;GetStringFromName(NS_ConvertUTF16toUTF8(aStringName).get(), getter_Copies(outStr));</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+    mStringBundle-&gt;GetStringFromName(NS_ConvertUTF16toUTF8(aStringName).get(), outStr);</span>
<a href="#l22.14"></a><span id="l22.14">   return;</span>
<a href="#l22.15"></a><span id="l22.15"> }</span>
<a href="#l22.16"></a><span id="l22.16"> </span>
<a href="#l22.17"></a><span id="l22.17"> //-----------------------------------------------------------</span>
<a href="#l22.18"></a><span id="l22.18"> void</span>
<a href="#l22.19"></a><span id="l22.19"> nsMsgPrintEngine::PrintMsgWindow()</span>
<a href="#l22.20"></a><span id="l22.20"> {</span>
<a href="#l22.21"></a><span id="l22.21">   const char* kMsgKeys[] = {&quot;PrintingMessage&quot;,  &quot;PrintPreviewMessage&quot;,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mailnews/base/src/nsMsgProgress.cpp</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgProgress.cpp</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -251,12 +251,12 @@ NS_IMETHODIMP nsMsgProgress::OnProgress(</span>
<a href="#l23.4"></a><span id="l23.4"> NS_IMETHODIMP nsMsgProgress::OnStatus(nsIRequest *request, nsISupports* ctxt,</span>
<a href="#l23.5"></a><span id="l23.5">                                       nsresult aStatus, const char16_t* aStatusArg)</span>
<a href="#l23.6"></a><span id="l23.6"> {</span>
<a href="#l23.7"></a><span id="l23.7">   nsresult rv;</span>
<a href="#l23.8"></a><span id="l23.8">   nsCOMPtr&lt;nsIStringBundleService&gt; sbs =</span>
<a href="#l23.9"></a><span id="l23.9">     mozilla::services::GetStringBundleService();</span>
<a href="#l23.10"></a><span id="l23.10">   NS_ENSURE_TRUE(sbs, NS_ERROR_UNEXPECTED);</span>
<a href="#l23.11"></a><span id="l23.11">   nsString str;</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-  rv = sbs-&gt;FormatStatusMessage(aStatus, aStatusArg, getter_Copies(str));</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+  rv = sbs-&gt;FormatStatusMessage(aStatus, aStatusArg, str);</span>
<a href="#l23.14"></a><span id="l23.14">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l23.15"></a><span id="l23.15">   return ShowStatusString(str);</span>
<a href="#l23.16"></a><span id="l23.16"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/mailnews/base/src/nsMsgStatusFeedback.cpp</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgStatusFeedback.cpp</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -82,18 +82,17 @@ nsMsgStatusFeedback::OnStateChange(nsIWe</span>
<a href="#l24.4"></a><span id="l24.4">   NS_ENSURE_TRUE(mBundle, NS_ERROR_NULL_POINTER);</span>
<a href="#l24.5"></a><span id="l24.5">   if (aProgressStateFlags &amp; STATE_IS_NETWORK)</span>
<a href="#l24.6"></a><span id="l24.6">   {</span>
<a href="#l24.7"></a><span id="l24.7">     if (aProgressStateFlags &amp; STATE_START)</span>
<a href="#l24.8"></a><span id="l24.8">     {</span>
<a href="#l24.9"></a><span id="l24.9">       m_lastPercent = 0;</span>
<a href="#l24.10"></a><span id="l24.10">       StartMeteors();</span>
<a href="#l24.11"></a><span id="l24.11">       nsString loadingDocument;</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-      rv = mBundle-&gt;GetStringFromName(&quot;documentLoading&quot;,</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineminus">-                                      getter_Copies(loadingDocument));</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineplus">+      rv = mBundle-&gt;GetStringFromName(&quot;documentLoading&quot;, loadingDocument);</span>
<a href="#l24.15"></a><span id="l24.15">       if (NS_SUCCEEDED(rv))</span>
<a href="#l24.16"></a><span id="l24.16">         ShowStatusString(loadingDocument);</span>
<a href="#l24.17"></a><span id="l24.17">     }</span>
<a href="#l24.18"></a><span id="l24.18">     else if (aProgressStateFlags &amp; STATE_STOP)</span>
<a href="#l24.19"></a><span id="l24.19">     {</span>
<a href="#l24.20"></a><span id="l24.20">       // if we are loading message for display purposes, this STATE_STOP notification is </span>
<a href="#l24.21"></a><span id="l24.21">       // the only notification we get when layout is actually done rendering the message. We need</span>
<a href="#l24.22"></a><span id="l24.22">       // to fire the appropriate msgHdrSink notification in this particular case.</span>
<a href="#l24.23"></a><span id="l24.23" class="difflineat">@@ -136,18 +135,17 @@ nsMsgStatusFeedback::OnStateChange(nsIWe</span>
<a href="#l24.24"></a><span id="l24.24">               if (msgFolder &amp;&amp; msgHdr)</span>
<a href="#l24.25"></a><span id="l24.25">                 msgFolder-&gt;NotifyPropertyFlagChanged(msgHdr, m_msgLoadedAtom, 0, 1);</span>
<a href="#l24.26"></a><span id="l24.26">             }</span>
<a href="#l24.27"></a><span id="l24.27">           }</span>
<a href="#l24.28"></a><span id="l24.28">         }</span>
<a href="#l24.29"></a><span id="l24.29">       }</span>
<a href="#l24.30"></a><span id="l24.30">       StopMeteors();</span>
<a href="#l24.31"></a><span id="l24.31">       nsString documentDone;</span>
<a href="#l24.32"></a><span id="l24.32" class="difflineminus">-      rv = mBundle-&gt;GetStringFromName(&quot;documentDone&quot;,</span>
<a href="#l24.33"></a><span id="l24.33" class="difflineminus">-                                      getter_Copies(documentDone));</span>
<a href="#l24.34"></a><span id="l24.34" class="difflineplus">+      rv = mBundle-&gt;GetStringFromName(&quot;documentDone&quot;, documentDone);</span>
<a href="#l24.35"></a><span id="l24.35">       if (NS_SUCCEEDED(rv))</span>
<a href="#l24.36"></a><span id="l24.36">         ShowStatusString(documentDone);</span>
<a href="#l24.37"></a><span id="l24.37">     }</span>
<a href="#l24.38"></a><span id="l24.38">   }</span>
<a href="#l24.39"></a><span id="l24.39">   return NS_OK;</span>
<a href="#l24.40"></a><span id="l24.40"> }</span>
<a href="#l24.41"></a><span id="l24.41"> </span>
<a href="#l24.42"></a><span id="l24.42"> NS_IMETHODIMP nsMsgStatusFeedback::OnLocationChange(nsIWebProgress* aWebProgress,</span>
<a href="#l24.43"></a><span id="l24.43" class="difflineat">@@ -273,31 +271,31 @@ NS_IMETHODIMP nsMsgStatusFeedback::OnSta</span>
<a href="#l24.44"></a><span id="l24.44">       server-&gt;GetPrettyName(accountName);</span>
<a href="#l24.45"></a><span id="l24.45">   }</span>
<a href="#l24.46"></a><span id="l24.46"> </span>
<a href="#l24.47"></a><span id="l24.47">   // forming the status message</span>
<a href="#l24.48"></a><span id="l24.48">   nsCOMPtr&lt;nsIStringBundleService&gt; sbs =</span>
<a href="#l24.49"></a><span id="l24.49">     mozilla::services::GetStringBundleService();</span>
<a href="#l24.50"></a><span id="l24.50">   NS_ENSURE_TRUE(sbs, NS_ERROR_UNEXPECTED);</span>
<a href="#l24.51"></a><span id="l24.51">   nsString str;</span>
<a href="#l24.52"></a><span id="l24.52" class="difflineminus">-  rv = sbs-&gt;FormatStatusMessage(aStatus, aStatusArg, getter_Copies(str));</span>
<a href="#l24.53"></a><span id="l24.53" class="difflineplus">+  rv = sbs-&gt;FormatStatusMessage(aStatus, aStatusArg, str);</span>
<a href="#l24.54"></a><span id="l24.54">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l24.55"></a><span id="l24.55"> </span>
<a href="#l24.56"></a><span id="l24.56">   // prefixing the account name to the status message if status message isn't blank</span>
<a href="#l24.57"></a><span id="l24.57">   // and doesn't already contain the account name.</span>
<a href="#l24.58"></a><span id="l24.58">   nsString statusMessage;</span>
<a href="#l24.59"></a><span id="l24.59">   if (!str.IsEmpty() &amp;&amp; str.Find(accountName) == kNotFound)</span>
<a href="#l24.60"></a><span id="l24.60">   {</span>
<a href="#l24.61"></a><span id="l24.61">     nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l24.62"></a><span id="l24.62">     rv = sbs-&gt;CreateBundle(MSGS_URL, getter_AddRefs(bundle));</span>
<a href="#l24.63"></a><span id="l24.63">     const char16_t *params[] = { accountName.get(),</span>
<a href="#l24.64"></a><span id="l24.64">                                   str.get() };</span>
<a href="#l24.65"></a><span id="l24.65">     rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l24.66"></a><span id="l24.66">       &quot;statusMessage&quot;,</span>
<a href="#l24.67"></a><span id="l24.67" class="difflineminus">-      params, 2, getter_Copies(statusMessage));</span>
<a href="#l24.68"></a><span id="l24.68" class="difflineplus">+      params, 2, statusMessage);</span>
<a href="#l24.69"></a><span id="l24.69">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l24.70"></a><span id="l24.70">   }</span>
<a href="#l24.71"></a><span id="l24.71">   else</span>
<a href="#l24.72"></a><span id="l24.72">   {</span>
<a href="#l24.73"></a><span id="l24.73">     statusMessage.Assign(str);</span>
<a href="#l24.74"></a><span id="l24.74">   }</span>
<a href="#l24.75"></a><span id="l24.75">   return ShowStatusString(statusMessage);</span>
<a href="#l24.76"></a><span id="l24.76"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/mailnews/base/src/nsSpamSettings.cpp</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/mailnews/base/src/nsSpamSettings.cpp</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -671,17 +671,17 @@ NS_IMETHODIMP nsSpamSettings::LogJunkHit</span>
<a href="#l25.4"></a><span id="l25.4">     getter_AddRefs(bundle));</span>
<a href="#l25.5"></a><span id="l25.5">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l25.6"></a><span id="l25.6"> </span>
<a href="#l25.7"></a><span id="l25.7">   const char16_t *junkLogDetectFormatStrings[3] = { authorValue.get(), subjectValue.get(), dateValue.get() };</span>
<a href="#l25.8"></a><span id="l25.8">   nsString junkLogDetectStr;</span>
<a href="#l25.9"></a><span id="l25.9">   rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l25.10"></a><span id="l25.10">     &quot;junkLogDetectStr&quot;,</span>
<a href="#l25.11"></a><span id="l25.11">     junkLogDetectFormatStrings, 3,</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-    getter_Copies(junkLogDetectStr));</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+    junkLogDetectStr);</span>
<a href="#l25.14"></a><span id="l25.14">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l25.15"></a><span id="l25.15"> </span>
<a href="#l25.16"></a><span id="l25.16">   buffer += NS_ConvertUTF16toUTF8(junkLogDetectStr);</span>
<a href="#l25.17"></a><span id="l25.17">   buffer +=  &quot;\n&quot;;</span>
<a href="#l25.18"></a><span id="l25.18"> </span>
<a href="#l25.19"></a><span id="l25.19">   if (aMoveMessage) {</span>
<a href="#l25.20"></a><span id="l25.20">     nsCString msgId;</span>
<a href="#l25.21"></a><span id="l25.21">     aMsgHdr-&gt;GetMessageId(getter_Copies(msgId));</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineat">@@ -693,17 +693,17 @@ NS_IMETHODIMP nsSpamSettings::LogJunkHit</span>
<a href="#l25.23"></a><span id="l25.23">     NS_ConvertASCIItoUTF16 msgIdValue(msgId);</span>
<a href="#l25.24"></a><span id="l25.24">     NS_ConvertASCIItoUTF16 junkFolderURIValue(junkFolderURI);</span>
<a href="#l25.25"></a><span id="l25.25"> </span>
<a href="#l25.26"></a><span id="l25.26">     const char16_t *logMoveFormatStrings[2] = { msgIdValue.get(), junkFolderURIValue.get() };</span>
<a href="#l25.27"></a><span id="l25.27">     nsString logMoveStr;</span>
<a href="#l25.28"></a><span id="l25.28">     rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l25.29"></a><span id="l25.29">       &quot;logMoveStr&quot;,</span>
<a href="#l25.30"></a><span id="l25.30">       logMoveFormatStrings, 2,</span>
<a href="#l25.31"></a><span id="l25.31" class="difflineminus">-      getter_Copies(logMoveStr));</span>
<a href="#l25.32"></a><span id="l25.32" class="difflineplus">+      logMoveStr);</span>
<a href="#l25.33"></a><span id="l25.33">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l25.34"></a><span id="l25.34"> </span>
<a href="#l25.35"></a><span id="l25.35">     buffer += NS_ConvertUTF16toUTF8(logMoveStr);</span>
<a href="#l25.36"></a><span id="l25.36">     buffer += &quot;\n&quot;;</span>
<a href="#l25.37"></a><span id="l25.37">   }</span>
<a href="#l25.38"></a><span id="l25.38"> </span>
<a href="#l25.39"></a><span id="l25.39">   return LogJunkString(buffer.get());</span>
<a href="#l25.40"></a><span id="l25.40"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/mailnews/base/util/nsMsgDBFolder.cpp</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgDBFolder.cpp</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -82,26 +82,26 @@ static PRTime gtimeOfLastPurgeCheck;    </span>
<a href="#l26.4"></a><span id="l26.4"> #define PREF_MAIL_WARN_FILTER_CHANGED &quot;mail.warn_filter_changed&quot;</span>
<a href="#l26.5"></a><span id="l26.5"> </span>
<a href="#l26.6"></a><span id="l26.6"> const char *kUseServerRetentionProp = &quot;useServerRetention&quot;;</span>
<a href="#l26.7"></a><span id="l26.7"> </span>
<a href="#l26.8"></a><span id="l26.8"> static NS_DEFINE_CID(kRDFServiceCID, NS_RDFSERVICE_CID);</span>
<a href="#l26.9"></a><span id="l26.9"> </span>
<a href="#l26.10"></a><span id="l26.10"> nsICollation * nsMsgDBFolder::gCollationKeyGenerator = nullptr;</span>
<a href="#l26.11"></a><span id="l26.11"> </span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-char16_t *nsMsgDBFolder::kLocalizedInboxName;</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineminus">-char16_t *nsMsgDBFolder::kLocalizedTrashName;</span>
<a href="#l26.14"></a><span id="l26.14" class="difflineminus">-char16_t *nsMsgDBFolder::kLocalizedSentName;</span>
<a href="#l26.15"></a><span id="l26.15" class="difflineminus">-char16_t *nsMsgDBFolder::kLocalizedDraftsName;</span>
<a href="#l26.16"></a><span id="l26.16" class="difflineminus">-char16_t *nsMsgDBFolder::kLocalizedTemplatesName;</span>
<a href="#l26.17"></a><span id="l26.17" class="difflineminus">-char16_t *nsMsgDBFolder::kLocalizedUnsentName;</span>
<a href="#l26.18"></a><span id="l26.18" class="difflineminus">-char16_t *nsMsgDBFolder::kLocalizedJunkName;</span>
<a href="#l26.19"></a><span id="l26.19" class="difflineminus">-char16_t *nsMsgDBFolder::kLocalizedArchivesName;</span>
<a href="#l26.20"></a><span id="l26.20" class="difflineminus">-</span>
<a href="#l26.21"></a><span id="l26.21" class="difflineminus">-char16_t *nsMsgDBFolder::kLocalizedBrandShortName;</span>
<a href="#l26.22"></a><span id="l26.22" class="difflineplus">+nsString nsMsgDBFolder::kLocalizedInboxName;</span>
<a href="#l26.23"></a><span id="l26.23" class="difflineplus">+nsString nsMsgDBFolder::kLocalizedTrashName;</span>
<a href="#l26.24"></a><span id="l26.24" class="difflineplus">+nsString nsMsgDBFolder::kLocalizedSentName;</span>
<a href="#l26.25"></a><span id="l26.25" class="difflineplus">+nsString nsMsgDBFolder::kLocalizedDraftsName;</span>
<a href="#l26.26"></a><span id="l26.26" class="difflineplus">+nsString nsMsgDBFolder::kLocalizedTemplatesName;</span>
<a href="#l26.27"></a><span id="l26.27" class="difflineplus">+nsString nsMsgDBFolder::kLocalizedUnsentName;</span>
<a href="#l26.28"></a><span id="l26.28" class="difflineplus">+nsString nsMsgDBFolder::kLocalizedJunkName;</span>
<a href="#l26.29"></a><span id="l26.29" class="difflineplus">+nsString nsMsgDBFolder::kLocalizedArchivesName;</span>
<a href="#l26.30"></a><span id="l26.30" class="difflineplus">+</span>
<a href="#l26.31"></a><span id="l26.31" class="difflineplus">+nsString nsMsgDBFolder::kLocalizedBrandShortName;</span>
<a href="#l26.32"></a><span id="l26.32"> </span>
<a href="#l26.33"></a><span id="l26.33"> nsrefcnt nsMsgDBFolder::mInstanceCount=0;</span>
<a href="#l26.34"></a><span id="l26.34"> </span>
<a href="#l26.35"></a><span id="l26.35"> NS_IMPL_ISUPPORTS_INHERITED(nsMsgDBFolder, nsRDFResource, </span>
<a href="#l26.36"></a><span id="l26.36">                              nsISupportsWeakReference, nsIMsgFolder,</span>
<a href="#l26.37"></a><span id="l26.37">                              nsIDBChangeListener, nsIUrlListener,</span>
<a href="#l26.38"></a><span id="l26.38">                              nsIJunkMailClassificationListener,</span>
<a href="#l26.39"></a><span id="l26.39">                              nsIMsgTraitClassificationListener)</span>
<a href="#l26.40"></a><span id="l26.40" class="difflineat">@@ -152,25 +152,16 @@ nsMsgDBFolder::nsMsgDBFolder(void)</span>
<a href="#l26.41"></a><span id="l26.41"> </span>
<a href="#l26.42"></a><span id="l26.42"> nsMsgDBFolder::~nsMsgDBFolder(void)</span>
<a href="#l26.43"></a><span id="l26.43"> {</span>
<a href="#l26.44"></a><span id="l26.44">   for (uint32_t i = 0; i &lt; nsMsgProcessingFlags::NumberOfFlags; i++)</span>
<a href="#l26.45"></a><span id="l26.45">     delete mProcessingFlag[i].keys;</span>
<a href="#l26.46"></a><span id="l26.46"> </span>
<a href="#l26.47"></a><span id="l26.47">   if (--mInstanceCount == 0) {</span>
<a href="#l26.48"></a><span id="l26.48">     NS_IF_RELEASE(gCollationKeyGenerator);</span>
<a href="#l26.49"></a><span id="l26.49" class="difflineminus">-    NS_Free(kLocalizedInboxName);</span>
<a href="#l26.50"></a><span id="l26.50" class="difflineminus">-    NS_Free(kLocalizedTrashName);</span>
<a href="#l26.51"></a><span id="l26.51" class="difflineminus">-    NS_Free(kLocalizedSentName);</span>
<a href="#l26.52"></a><span id="l26.52" class="difflineminus">-    NS_Free(kLocalizedDraftsName);</span>
<a href="#l26.53"></a><span id="l26.53" class="difflineminus">-    NS_Free(kLocalizedTemplatesName);</span>
<a href="#l26.54"></a><span id="l26.54" class="difflineminus">-    NS_Free(kLocalizedUnsentName);</span>
<a href="#l26.55"></a><span id="l26.55" class="difflineminus">-    NS_Free(kLocalizedJunkName);</span>
<a href="#l26.56"></a><span id="l26.56" class="difflineminus">-    NS_Free(kLocalizedArchivesName);</span>
<a href="#l26.57"></a><span id="l26.57" class="difflineminus">-    NS_Free(kLocalizedBrandShortName);</span>
<a href="#l26.58"></a><span id="l26.58"> </span>
<a href="#l26.59"></a><span id="l26.59"> #define MSGDBFOLDER_ATOM(name_, value_) NS_RELEASE(name_);</span>
<a href="#l26.60"></a><span id="l26.60"> #include &quot;nsMsgDBFolderAtomList.h&quot;</span>
<a href="#l26.61"></a><span id="l26.61"> #undef MSGDBFOLDER_ATOM</span>
<a href="#l26.62"></a><span id="l26.62">   }</span>
<a href="#l26.63"></a><span id="l26.63">   //shutdown but don't shutdown children.</span>
<a href="#l26.64"></a><span id="l26.64">   Shutdown(false);</span>
<a href="#l26.65"></a><span id="l26.65"> }</span>
<a href="#l26.66"></a><span id="l26.66" class="difflineat">@@ -1916,26 +1907,26 @@ nsresult nsMsgDBFolder::HandleAutoCompac</span>
<a href="#l26.67"></a><span id="l26.67">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l26.68"></a><span id="l26.68">           nsString dialogTitle;</span>
<a href="#l26.69"></a><span id="l26.69">           nsString confirmString;</span>
<a href="#l26.70"></a><span id="l26.70">           nsString checkboxText;</span>
<a href="#l26.71"></a><span id="l26.71">           nsString buttonCompactNowText;</span>
<a href="#l26.72"></a><span id="l26.72">           nsAutoString compactSize;</span>
<a href="#l26.73"></a><span id="l26.73">           FormatFileSize(totalExpungedBytes, true, compactSize);</span>
<a href="#l26.74"></a><span id="l26.74">           const char16_t* params[] = { compactSize.get() };</span>
<a href="#l26.75"></a><span id="l26.75" class="difflineminus">-          rv = bundle-&gt;GetStringFromName(&quot;autoCompactAllFoldersTitle&quot;, getter_Copies(dialogTitle));</span>
<a href="#l26.76"></a><span id="l26.76" class="difflineplus">+          rv = bundle-&gt;GetStringFromName(&quot;autoCompactAllFoldersTitle&quot;, dialogTitle);</span>
<a href="#l26.77"></a><span id="l26.77">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l26.78"></a><span id="l26.78">           rv = bundle-&gt;FormatStringFromName(&quot;autoCompactAllFoldersText&quot;,</span>
<a href="#l26.79"></a><span id="l26.79" class="difflineminus">-                                            params, 1, getter_Copies(confirmString));</span>
<a href="#l26.80"></a><span id="l26.80" class="difflineplus">+                                            params, 1, confirmString);</span>
<a href="#l26.81"></a><span id="l26.81">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l26.82"></a><span id="l26.82">           rv = bundle-&gt;GetStringFromName(&quot;autoCompactAlwaysAskCheckbox&quot;,</span>
<a href="#l26.83"></a><span id="l26.83" class="difflineminus">-                                         getter_Copies(checkboxText));</span>
<a href="#l26.84"></a><span id="l26.84" class="difflineplus">+                                         checkboxText);</span>
<a href="#l26.85"></a><span id="l26.85">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l26.86"></a><span id="l26.86">           rv = bundle-&gt;GetStringFromName(&quot;compactNowButton&quot;,</span>
<a href="#l26.87"></a><span id="l26.87" class="difflineminus">-                                         getter_Copies(buttonCompactNowText));</span>
<a href="#l26.88"></a><span id="l26.88" class="difflineplus">+                                         buttonCompactNowText);</span>
<a href="#l26.89"></a><span id="l26.89">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l26.90"></a><span id="l26.90">           bool alwaysAsk = true; // &quot;Always ask...&quot; - checked by default.</span>
<a href="#l26.91"></a><span id="l26.91">           int32_t buttonPressed = 0;</span>
<a href="#l26.92"></a><span id="l26.92"> </span>
<a href="#l26.93"></a><span id="l26.93">           nsCOMPtr&lt;nsIPrompt&gt; dialog;</span>
<a href="#l26.94"></a><span id="l26.94">           rv = aWindow-&gt;GetPromptDialog(getter_AddRefs(dialog));</span>
<a href="#l26.95"></a><span id="l26.95">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l26.96"></a><span id="l26.96"> </span>
<a href="#l26.97"></a><span id="l26.97" class="difflineat">@@ -2920,38 +2911,29 @@ nsMsgDBFolder::initializeStrings()</span>
<a href="#l26.98"></a><span id="l26.98">   nsCOMPtr&lt;nsIStringBundleService&gt; bundleService =</span>
<a href="#l26.99"></a><span id="l26.99">     mozilla::services::GetStringBundleService();</span>
<a href="#l26.100"></a><span id="l26.100">   NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l26.101"></a><span id="l26.101">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l26.102"></a><span id="l26.102">   rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/messenger.properties&quot;,</span>
<a href="#l26.103"></a><span id="l26.103">                                    getter_AddRefs(bundle));</span>
<a href="#l26.104"></a><span id="l26.104">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l26.105"></a><span id="l26.105"> </span>
<a href="#l26.106"></a><span id="l26.106" class="difflineminus">-  bundle-&gt;GetStringFromName(&quot;inboxFolderName&quot;,</span>
<a href="#l26.107"></a><span id="l26.107" class="difflineminus">-                            &amp;kLocalizedInboxName);</span>
<a href="#l26.108"></a><span id="l26.108" class="difflineminus">-  bundle-&gt;GetStringFromName(&quot;trashFolderName&quot;,</span>
<a href="#l26.109"></a><span id="l26.109" class="difflineminus">-                            &amp;kLocalizedTrashName);</span>
<a href="#l26.110"></a><span id="l26.110" class="difflineminus">-  bundle-&gt;GetStringFromName(&quot;sentFolderName&quot;,</span>
<a href="#l26.111"></a><span id="l26.111" class="difflineminus">-                            &amp;kLocalizedSentName);</span>
<a href="#l26.112"></a><span id="l26.112" class="difflineminus">-  bundle-&gt;GetStringFromName(&quot;draftsFolderName&quot;,</span>
<a href="#l26.113"></a><span id="l26.113" class="difflineminus">-                            &amp;kLocalizedDraftsName);</span>
<a href="#l26.114"></a><span id="l26.114" class="difflineminus">-  bundle-&gt;GetStringFromName(&quot;templatesFolderName&quot;,</span>
<a href="#l26.115"></a><span id="l26.115" class="difflineminus">-                            &amp;kLocalizedTemplatesName);</span>
<a href="#l26.116"></a><span id="l26.116" class="difflineminus">-  bundle-&gt;GetStringFromName(&quot;junkFolderName&quot;,</span>
<a href="#l26.117"></a><span id="l26.117" class="difflineminus">-                            &amp;kLocalizedJunkName);</span>
<a href="#l26.118"></a><span id="l26.118" class="difflineminus">-  bundle-&gt;GetStringFromName(&quot;outboxFolderName&quot;,</span>
<a href="#l26.119"></a><span id="l26.119" class="difflineminus">-                            &amp;kLocalizedUnsentName);</span>
<a href="#l26.120"></a><span id="l26.120" class="difflineminus">-  bundle-&gt;GetStringFromName(&quot;archivesFolderName&quot;,</span>
<a href="#l26.121"></a><span id="l26.121" class="difflineminus">-                            &amp;kLocalizedArchivesName);</span>
<a href="#l26.122"></a><span id="l26.122" class="difflineplus">+  bundle-&gt;GetStringFromName(&quot;inboxFolderName&quot;, kLocalizedInboxName);</span>
<a href="#l26.123"></a><span id="l26.123" class="difflineplus">+  bundle-&gt;GetStringFromName(&quot;trashFolderName&quot;, kLocalizedTrashName);</span>
<a href="#l26.124"></a><span id="l26.124" class="difflineplus">+  bundle-&gt;GetStringFromName(&quot;sentFolderName&quot;, kLocalizedSentName);</span>
<a href="#l26.125"></a><span id="l26.125" class="difflineplus">+  bundle-&gt;GetStringFromName(&quot;draftsFolderName&quot;, kLocalizedDraftsName);</span>
<a href="#l26.126"></a><span id="l26.126" class="difflineplus">+  bundle-&gt;GetStringFromName(&quot;templatesFolderName&quot;, kLocalizedTemplatesName);</span>
<a href="#l26.127"></a><span id="l26.127" class="difflineplus">+  bundle-&gt;GetStringFromName(&quot;junkFolderName&quot;, kLocalizedJunkName);</span>
<a href="#l26.128"></a><span id="l26.128" class="difflineplus">+  bundle-&gt;GetStringFromName(&quot;outboxFolderName&quot;, kLocalizedUnsentName);</span>
<a href="#l26.129"></a><span id="l26.129" class="difflineplus">+  bundle-&gt;GetStringFromName(&quot;archivesFolderName&quot;, kLocalizedArchivesName);</span>
<a href="#l26.130"></a><span id="l26.130"> </span>
<a href="#l26.131"></a><span id="l26.131">   nsCOMPtr&lt;nsIStringBundle&gt; brandBundle;</span>
<a href="#l26.132"></a><span id="l26.132">   rv = bundleService-&gt;CreateBundle(&quot;chrome://branding/locale/brand.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l26.133"></a><span id="l26.133">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l26.134"></a><span id="l26.134" class="difflineminus">-  bundle-&gt;GetStringFromName(&quot;brandShortName&quot;,</span>
<a href="#l26.135"></a><span id="l26.135" class="difflineminus">-                            &amp;kLocalizedBrandShortName);</span>
<a href="#l26.136"></a><span id="l26.136" class="difflineplus">+  bundle-&gt;GetStringFromName(&quot;brandShortName&quot;, kLocalizedBrandShortName);</span>
<a href="#l26.137"></a><span id="l26.137">   return NS_OK;</span>
<a href="#l26.138"></a><span id="l26.138"> }</span>
<a href="#l26.139"></a><span id="l26.139"> </span>
<a href="#l26.140"></a><span id="l26.140"> nsresult</span>
<a href="#l26.141"></a><span id="l26.141"> nsMsgDBFolder::createCollationKeyGenerator()</span>
<a href="#l26.142"></a><span id="l26.142"> {</span>
<a href="#l26.143"></a><span id="l26.143">   nsresult rv = NS_OK;</span>
<a href="#l26.144"></a><span id="l26.144"> </span>
<a href="#l26.145"></a><span id="l26.145" class="difflineat">@@ -3399,31 +3381,31 @@ NS_IMETHODIMP nsMsgDBFolder::GetPrettyNa</span>
<a href="#l26.146"></a><span id="l26.146"> }</span>
<a href="#l26.147"></a><span id="l26.147"> </span>
<a href="#l26.148"></a><span id="l26.148"> NS_IMETHODIMP nsMsgDBFolder::SetPrettyName(const nsAString&amp; name)</span>
<a href="#l26.149"></a><span id="l26.149"> {</span>
<a href="#l26.150"></a><span id="l26.150">   nsresult rv;</span>
<a href="#l26.151"></a><span id="l26.151"> </span>
<a href="#l26.152"></a><span id="l26.152">   //Set pretty name only if special flag is set and if it the default folder name</span>
<a href="#l26.153"></a><span id="l26.153">   if (mFlags &amp; nsMsgFolderFlags::Inbox &amp;&amp; name.LowerCaseEqualsLiteral(&quot;inbox&quot;))</span>
<a href="#l26.154"></a><span id="l26.154" class="difflineminus">-    rv = SetName(nsDependentString(kLocalizedInboxName));</span>
<a href="#l26.155"></a><span id="l26.155" class="difflineplus">+    rv = SetName(kLocalizedInboxName);</span>
<a href="#l26.156"></a><span id="l26.156">   else if (mFlags &amp; nsMsgFolderFlags::SentMail &amp;&amp; name.LowerCaseEqualsLiteral(&quot;sent&quot;))</span>
<a href="#l26.157"></a><span id="l26.157" class="difflineminus">-    rv = SetName(nsDependentString(kLocalizedSentName));</span>
<a href="#l26.158"></a><span id="l26.158" class="difflineplus">+    rv = SetName(kLocalizedSentName);</span>
<a href="#l26.159"></a><span id="l26.159">   else if (mFlags &amp; nsMsgFolderFlags::Drafts &amp;&amp; name.LowerCaseEqualsLiteral(&quot;drafts&quot;))</span>
<a href="#l26.160"></a><span id="l26.160" class="difflineminus">-    rv = SetName(nsDependentString(kLocalizedDraftsName));</span>
<a href="#l26.161"></a><span id="l26.161" class="difflineplus">+    rv = SetName(kLocalizedDraftsName);</span>
<a href="#l26.162"></a><span id="l26.162">   else if (mFlags &amp; nsMsgFolderFlags::Templates &amp;&amp; name.LowerCaseEqualsLiteral(&quot;templates&quot;))</span>
<a href="#l26.163"></a><span id="l26.163" class="difflineminus">-    rv = SetName(nsDependentString(kLocalizedTemplatesName));</span>
<a href="#l26.164"></a><span id="l26.164" class="difflineplus">+    rv = SetName(kLocalizedTemplatesName);</span>
<a href="#l26.165"></a><span id="l26.165">   else if (mFlags &amp; nsMsgFolderFlags::Trash &amp;&amp; name.LowerCaseEqualsLiteral(&quot;trash&quot;))</span>
<a href="#l26.166"></a><span id="l26.166" class="difflineminus">-    rv = SetName(nsDependentString(kLocalizedTrashName));</span>
<a href="#l26.167"></a><span id="l26.167" class="difflineplus">+    rv = SetName(kLocalizedTrashName);</span>
<a href="#l26.168"></a><span id="l26.168">   else if (mFlags &amp; nsMsgFolderFlags::Queue &amp;&amp; name.LowerCaseEqualsLiteral(&quot;unsent messages&quot;))</span>
<a href="#l26.169"></a><span id="l26.169" class="difflineminus">-    rv = SetName(nsDependentString(kLocalizedUnsentName));</span>
<a href="#l26.170"></a><span id="l26.170" class="difflineplus">+    rv = SetName(kLocalizedUnsentName);</span>
<a href="#l26.171"></a><span id="l26.171">   else if (mFlags &amp; nsMsgFolderFlags::Junk &amp;&amp; name.LowerCaseEqualsLiteral(&quot;junk&quot;))</span>
<a href="#l26.172"></a><span id="l26.172" class="difflineminus">-    rv = SetName(nsDependentString(kLocalizedJunkName));</span>
<a href="#l26.173"></a><span id="l26.173" class="difflineplus">+    rv = SetName(kLocalizedJunkName);</span>
<a href="#l26.174"></a><span id="l26.174">   else if (mFlags &amp; nsMsgFolderFlags::Archive &amp;&amp; name.LowerCaseEqualsLiteral(&quot;archives&quot;))</span>
<a href="#l26.175"></a><span id="l26.175" class="difflineminus">-    rv = SetName(nsDependentString(kLocalizedArchivesName));</span>
<a href="#l26.176"></a><span id="l26.176" class="difflineplus">+    rv = SetName(kLocalizedArchivesName);</span>
<a href="#l26.177"></a><span id="l26.177">   else</span>
<a href="#l26.178"></a><span id="l26.178">     rv = SetName(name);</span>
<a href="#l26.179"></a><span id="l26.179">   return rv;</span>
<a href="#l26.180"></a><span id="l26.180"> }</span>
<a href="#l26.181"></a><span id="l26.181"> </span>
<a href="#l26.182"></a><span id="l26.182"> NS_IMETHODIMP nsMsgDBFolder::GetName(nsAString&amp; name)</span>
<a href="#l26.183"></a><span id="l26.183"> {</span>
<a href="#l26.184"></a><span id="l26.184">   nsresult rv;</span>
<a href="#l26.185"></a><span id="l26.185" class="difflineat">@@ -3851,17 +3833,17 @@ nsMsgDBFolder::ConfirmAutoFolderRename(n</span>
<a href="#l26.186"></a><span id="l26.186">   {</span>
<a href="#l26.187"></a><span id="l26.187">     aOldName.get(),</span>
<a href="#l26.188"></a><span id="l26.188">     folderName.get(),</span>
<a href="#l26.189"></a><span id="l26.189">     aNewName.get()</span>
<a href="#l26.190"></a><span id="l26.190">   };</span>
<a href="#l26.191"></a><span id="l26.191"> </span>
<a href="#l26.192"></a><span id="l26.192">   nsString confirmString;</span>
<a href="#l26.193"></a><span id="l26.193">   rv = bundle-&gt;FormatStringFromName(&quot;confirmDuplicateFolderRename&quot;,</span>
<a href="#l26.194"></a><span id="l26.194" class="difflineminus">-                                    formatStrings, 3, getter_Copies(confirmString));</span>
<a href="#l26.195"></a><span id="l26.195" class="difflineplus">+                                    formatStrings, 3, confirmString);</span>
<a href="#l26.196"></a><span id="l26.196">   if (NS_WARN_IF(NS_FAILED(rv))) {</span>
<a href="#l26.197"></a><span id="l26.197">     return false;</span>
<a href="#l26.198"></a><span id="l26.198">   }</span>
<a href="#l26.199"></a><span id="l26.199"> </span>
<a href="#l26.200"></a><span id="l26.200">   bool confirmed = false;</span>
<a href="#l26.201"></a><span id="l26.201">   rv = ThrowConfirmationPrompt(msgWindow, confirmString, &amp;confirmed);</span>
<a href="#l26.202"></a><span id="l26.202">   if (NS_WARN_IF(NS_FAILED(rv))) {</span>
<a href="#l26.203"></a><span id="l26.203">     return false;</span>
<a href="#l26.204"></a><span id="l26.204" class="difflineat">@@ -5198,17 +5180,17 @@ nsMsgDBFolder::GetBaseStringBundle(nsISt</span>
<a href="#l26.205"></a><span id="l26.205"> </span>
<a href="#l26.206"></a><span id="l26.206"> nsresult //Do not use this routine if you have to call it very often because it creates a new bundle each time</span>
<a href="#l26.207"></a><span id="l26.207"> nsMsgDBFolder::GetStringFromBundle(const char *msgName, nsString&amp; aResult)</span>
<a href="#l26.208"></a><span id="l26.208"> {</span>
<a href="#l26.209"></a><span id="l26.209">   nsresult rv;</span>
<a href="#l26.210"></a><span id="l26.210">   nsCOMPtr &lt;nsIStringBundle&gt; bundle;</span>
<a href="#l26.211"></a><span id="l26.211">   rv = GetBaseStringBundle(getter_AddRefs(bundle));</span>
<a href="#l26.212"></a><span id="l26.212">   if (NS_SUCCEEDED(rv) &amp;&amp; bundle)</span>
<a href="#l26.213"></a><span id="l26.213" class="difflineminus">-    rv = bundle-&gt;GetStringFromName(msgName, getter_Copies(aResult));</span>
<a href="#l26.214"></a><span id="l26.214" class="difflineplus">+    rv = bundle-&gt;GetStringFromName(msgName, aResult);</span>
<a href="#l26.215"></a><span id="l26.215">   return rv;</span>
<a href="#l26.216"></a><span id="l26.216"> }</span>
<a href="#l26.217"></a><span id="l26.217"> </span>
<a href="#l26.218"></a><span id="l26.218"> nsresult</span>
<a href="#l26.219"></a><span id="l26.219"> nsMsgDBFolder::ThrowConfirmationPrompt(nsIMsgWindow *msgWindow, const nsAString&amp; confirmString, bool *confirmed)</span>
<a href="#l26.220"></a><span id="l26.220"> {</span>
<a href="#l26.221"></a><span id="l26.221">   if (msgWindow)</span>
<a href="#l26.222"></a><span id="l26.222">   {</span>
<a href="#l26.223"></a><span id="l26.223" class="difflineat">@@ -5231,22 +5213,22 @@ nsMsgDBFolder::GetStringWithFolderNameFr</span>
<a href="#l26.224"></a><span id="l26.224">   nsresult rv = GetBaseStringBundle(getter_AddRefs(bundle));</span>
<a href="#l26.225"></a><span id="l26.225">   if (NS_SUCCEEDED(rv) &amp;&amp; bundle)</span>
<a href="#l26.226"></a><span id="l26.226">   {</span>
<a href="#l26.227"></a><span id="l26.227">     nsString folderName;</span>
<a href="#l26.228"></a><span id="l26.228">     GetName(folderName);</span>
<a href="#l26.229"></a><span id="l26.229">     const char16_t *formatStrings[] =</span>
<a href="#l26.230"></a><span id="l26.230">     {</span>
<a href="#l26.231"></a><span id="l26.231">       folderName.get(),</span>
<a href="#l26.232"></a><span id="l26.232" class="difflineminus">-      kLocalizedBrandShortName</span>
<a href="#l26.233"></a><span id="l26.233" class="difflineplus">+      kLocalizedBrandShortName.get()</span>
<a href="#l26.234"></a><span id="l26.234">     };</span>
<a href="#l26.235"></a><span id="l26.235"> </span>
<a href="#l26.236"></a><span id="l26.236">     nsString resultStr;</span>
<a href="#l26.237"></a><span id="l26.237">     rv = bundle-&gt;FormatStringFromName(msgName,</span>
<a href="#l26.238"></a><span id="l26.238" class="difflineminus">-                                      formatStrings, 2, getter_Copies(resultStr));</span>
<a href="#l26.239"></a><span id="l26.239" class="difflineplus">+                                      formatStrings, 2, resultStr);</span>
<a href="#l26.240"></a><span id="l26.240">     if (NS_SUCCEEDED(rv))</span>
<a href="#l26.241"></a><span id="l26.241">       aResult.Assign(resultStr);</span>
<a href="#l26.242"></a><span id="l26.242">   }</span>
<a href="#l26.243"></a><span id="l26.243">   return rv;</span>
<a href="#l26.244"></a><span id="l26.244"> }</span>
<a href="#l26.245"></a><span id="l26.245"> </span>
<a href="#l26.246"></a><span id="l26.246"> NS_IMETHODIMP nsMsgDBFolder::ConfirmFolderDeletionForFilter(nsIMsgWindow *msgWindow, bool *confirmed)</span>
<a href="#l26.247"></a><span id="l26.247"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/mailnews/base/util/nsMsgDBFolder.h</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgDBFolder.h</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -222,26 +222,26 @@ protected:</span>
<a href="#l27.4"></a><span id="l27.4">   bool mInVFEditSearchScope ; // non persistant state used by the virtual folder UI</span>
<a href="#l27.5"></a><span id="l27.5"> </span>
<a href="#l27.6"></a><span id="l27.6">   // static stuff for cross-instance objects like atoms</span>
<a href="#l27.7"></a><span id="l27.7">   static NS_MSG_BASE_STATIC_MEMBER_(nsrefcnt) gInstanceCount;</span>
<a href="#l27.8"></a><span id="l27.8"> </span>
<a href="#l27.9"></a><span id="l27.9">   static nsresult initializeStrings();</span>
<a href="#l27.10"></a><span id="l27.10">   static nsresult createCollationKeyGenerator();</span>
<a href="#l27.11"></a><span id="l27.11"> </span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-  static NS_MSG_BASE_STATIC_MEMBER_(char16_t*) kLocalizedInboxName;</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineminus">-  static NS_MSG_BASE_STATIC_MEMBER_(char16_t*) kLocalizedTrashName;</span>
<a href="#l27.14"></a><span id="l27.14" class="difflineminus">-  static NS_MSG_BASE_STATIC_MEMBER_(char16_t*) kLocalizedSentName;</span>
<a href="#l27.15"></a><span id="l27.15" class="difflineminus">-  static NS_MSG_BASE_STATIC_MEMBER_(char16_t*) kLocalizedDraftsName;</span>
<a href="#l27.16"></a><span id="l27.16" class="difflineminus">-  static NS_MSG_BASE_STATIC_MEMBER_(char16_t*) kLocalizedTemplatesName;</span>
<a href="#l27.17"></a><span id="l27.17" class="difflineminus">-  static NS_MSG_BASE_STATIC_MEMBER_(char16_t*) kLocalizedUnsentName;</span>
<a href="#l27.18"></a><span id="l27.18" class="difflineminus">-  static NS_MSG_BASE_STATIC_MEMBER_(char16_t*) kLocalizedJunkName;</span>
<a href="#l27.19"></a><span id="l27.19" class="difflineminus">-  static NS_MSG_BASE_STATIC_MEMBER_(char16_t*) kLocalizedArchivesName;</span>
<a href="#l27.20"></a><span id="l27.20" class="difflineplus">+  static NS_MSG_BASE_STATIC_MEMBER_(nsString) kLocalizedInboxName;</span>
<a href="#l27.21"></a><span id="l27.21" class="difflineplus">+  static NS_MSG_BASE_STATIC_MEMBER_(nsString) kLocalizedTrashName;</span>
<a href="#l27.22"></a><span id="l27.22" class="difflineplus">+  static NS_MSG_BASE_STATIC_MEMBER_(nsString) kLocalizedSentName;</span>
<a href="#l27.23"></a><span id="l27.23" class="difflineplus">+  static NS_MSG_BASE_STATIC_MEMBER_(nsString) kLocalizedDraftsName;</span>
<a href="#l27.24"></a><span id="l27.24" class="difflineplus">+  static NS_MSG_BASE_STATIC_MEMBER_(nsString) kLocalizedTemplatesName;</span>
<a href="#l27.25"></a><span id="l27.25" class="difflineplus">+  static NS_MSG_BASE_STATIC_MEMBER_(nsString) kLocalizedUnsentName;</span>
<a href="#l27.26"></a><span id="l27.26" class="difflineplus">+  static NS_MSG_BASE_STATIC_MEMBER_(nsString) kLocalizedJunkName;</span>
<a href="#l27.27"></a><span id="l27.27" class="difflineplus">+  static NS_MSG_BASE_STATIC_MEMBER_(nsString) kLocalizedArchivesName;</span>
<a href="#l27.28"></a><span id="l27.28"> </span>
<a href="#l27.29"></a><span id="l27.29" class="difflineminus">-  static NS_MSG_BASE_STATIC_MEMBER_(char16_t*) kLocalizedBrandShortName;</span>
<a href="#l27.30"></a><span id="l27.30" class="difflineplus">+  static NS_MSG_BASE_STATIC_MEMBER_(nsString) kLocalizedBrandShortName;</span>
<a href="#l27.31"></a><span id="l27.31">   </span>
<a href="#l27.32"></a><span id="l27.32"> #define MSGDBFOLDER_ATOM(name_, value) static NS_MSG_BASE_STATIC_MEMBER_(nsIAtom*) name_;</span>
<a href="#l27.33"></a><span id="l27.33"> #include &quot;nsMsgDBFolderAtomList.h&quot;</span>
<a href="#l27.34"></a><span id="l27.34"> #undef MSGDBFOLDER_ATOM</span>
<a href="#l27.35"></a><span id="l27.35"> </span>
<a href="#l27.36"></a><span id="l27.36">   static NS_MSG_BASE_STATIC_MEMBER_(nsICollation*) gCollationKeyGenerator;</span>
<a href="#l27.37"></a><span id="l27.37"> </span>
<a href="#l27.38"></a><span id="l27.38">   // store of keys that have a processing flag set</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/mailnews/base/util/nsMsgIncomingServer.cpp</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgIncomingServer.cpp</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -1637,18 +1637,18 @@ NS_IMETHODIMP nsMsgIncomingServer::Displ</span>
<a href="#l28.4"></a><span id="l28.4"> </span>
<a href="#l28.5"></a><span id="l28.5">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l28.6"></a><span id="l28.6">   nsresult rv = bundleService-&gt;CreateBundle(BASE_MSGS_URL, getter_AddRefs(bundle));</span>
<a href="#l28.7"></a><span id="l28.7">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l28.8"></a><span id="l28.8">   if (bundle)</span>
<a href="#l28.9"></a><span id="l28.9">   {</span>
<a href="#l28.10"></a><span id="l28.10">     nsString errorMsgTitle;</span>
<a href="#l28.11"></a><span id="l28.11">     nsString errorMsgBody;</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;nocachedbodybody2&quot;, getter_Copies(errorMsgBody));</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;nocachedbodytitle&quot;, getter_Copies(errorMsgTitle));</span>
<a href="#l28.14"></a><span id="l28.14" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;nocachedbodybody2&quot;, errorMsgBody);</span>
<a href="#l28.15"></a><span id="l28.15" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;nocachedbodytitle&quot;, errorMsgTitle);</span>
<a href="#l28.16"></a><span id="l28.16">     aMsgWindow-&gt;DisplayHTMLInMessagePane(errorMsgTitle, errorMsgBody, true);</span>
<a href="#l28.17"></a><span id="l28.17">   }</span>
<a href="#l28.18"></a><span id="l28.18"> </span>
<a href="#l28.19"></a><span id="l28.19">   return NS_OK;</span>
<a href="#l28.20"></a><span id="l28.20"> }</span>
<a href="#l28.21"></a><span id="l28.21"> </span>
<a href="#l28.22"></a><span id="l28.22"> // Called only during the migration process. A unique name is generated for the</span>
<a href="#l28.23"></a><span id="l28.23"> // migrated account.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/mailnews/base/util/nsMsgProtocol.cpp</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgProtocol.cpp</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -1535,26 +1535,26 @@ char16_t *FormatStringWithHostNameByName</span>
<a href="#l29.4"></a><span id="l29.4">   nsCOMPtr&lt;nsIStringBundleService&gt; sBundleService =</span>
<a href="#l29.5"></a><span id="l29.5">     mozilla::services::GetStringBundleService();</span>
<a href="#l29.6"></a><span id="l29.6">   NS_ENSURE_TRUE(sBundleService, nullptr);</span>
<a href="#l29.7"></a><span id="l29.7"> </span>
<a href="#l29.8"></a><span id="l29.8">   nsCOMPtr&lt;nsIStringBundle&gt; sBundle;</span>
<a href="#l29.9"></a><span id="l29.9">   rv = sBundleService-&gt;CreateBundle(MSGS_URL, getter_AddRefs(sBundle));</span>
<a href="#l29.10"></a><span id="l29.10">   NS_ENSURE_SUCCESS(rv, nullptr);</span>
<a href="#l29.11"></a><span id="l29.11"> </span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-  char16_t *ptrv = nullptr;</span>
<a href="#l29.13"></a><span id="l29.13">   nsCOMPtr&lt;nsIMsgIncomingServer&gt; server;</span>
<a href="#l29.14"></a><span id="l29.14">   rv = msgUri-&gt;GetServer(getter_AddRefs(server));</span>
<a href="#l29.15"></a><span id="l29.15">   NS_ENSURE_SUCCESS(rv, nullptr);</span>
<a href="#l29.16"></a><span id="l29.16"> </span>
<a href="#l29.17"></a><span id="l29.17">   nsCString hostName;</span>
<a href="#l29.18"></a><span id="l29.18">   rv = server-&gt;GetRealHostName(hostName);</span>
<a href="#l29.19"></a><span id="l29.19">   NS_ENSURE_SUCCESS(rv, nullptr);</span>
<a href="#l29.20"></a><span id="l29.20"> </span>
<a href="#l29.21"></a><span id="l29.21">   NS_ConvertASCIItoUTF16 hostStr(hostName);</span>
<a href="#l29.22"></a><span id="l29.22">   const char16_t *params[] = { hostStr.get() };</span>
<a href="#l29.23"></a><span id="l29.23" class="difflineminus">-  rv = sBundle-&gt;FormatStringFromName(NS_ConvertUTF16toUTF8(stringName).get(), params, 1, &amp;ptrv);</span>
<a href="#l29.24"></a><span id="l29.24" class="difflineplus">+  nsAutoString str;</span>
<a href="#l29.25"></a><span id="l29.25" class="difflineplus">+  rv = sBundle-&gt;FormatStringFromName(NS_ConvertUTF16toUTF8(stringName).get(), params, 1, str);</span>
<a href="#l29.26"></a><span id="l29.26">   NS_ENSURE_SUCCESS(rv, nullptr);</span>
<a href="#l29.27"></a><span id="l29.27"> </span>
<a href="#l29.28"></a><span id="l29.28" class="difflineminus">-  return ptrv;</span>
<a href="#l29.29"></a><span id="l29.29" class="difflineplus">+  return ToNewUnicode(str);</span>
<a href="#l29.30"></a><span id="l29.30"> }</span>
<a href="#l29.31"></a><span id="l29.31"> </span>
<a href="#l29.32"></a><span id="l29.32"> // vim: ts=2 sw=2</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/mailnews/base/util/nsMsgUtils.cpp</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgUtils.cpp</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -512,18 +512,17 @@ nsresult FormatFileSize(int64_t size, bo</span>
<a href="#l30.4"></a><span id="l30.4">   while ((unitSize &gt;= 999.5) &amp;&amp; (unitIndex &lt; ArrayLength(sizeAbbrNames) - 1))</span>
<a href="#l30.5"></a><span id="l30.5">   {</span>
<a href="#l30.6"></a><span id="l30.6">       unitSize /= 1024;</span>
<a href="#l30.7"></a><span id="l30.7">       unitIndex++;</span>
<a href="#l30.8"></a><span id="l30.8">   }</span>
<a href="#l30.9"></a><span id="l30.9"> </span>
<a href="#l30.10"></a><span id="l30.10">   // Grab the string for the appropriate unit</span>
<a href="#l30.11"></a><span id="l30.11">   nsString sizeAbbr;</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(sizeAbbrNames[unitIndex],</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineminus">-                                 getter_Copies(sizeAbbr));</span>
<a href="#l30.14"></a><span id="l30.14" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(sizeAbbrNames[unitIndex], sizeAbbr);</span>
<a href="#l30.15"></a><span id="l30.15">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l30.16"></a><span id="l30.16"> </span>
<a href="#l30.17"></a><span id="l30.17">   // Get rid of insignificant bits by truncating to 1 or 0 decimal points</span>
<a href="#l30.18"></a><span id="l30.18">   // 0.1 -&gt; 0.1; 1.2 -&gt; 1.2; 12.3 -&gt; 12.3; 123.4 -&gt; 123; 234.5 -&gt; 235</span>
<a href="#l30.19"></a><span id="l30.19">   nsTextFormatter::ssprintf(</span>
<a href="#l30.20"></a><span id="l30.20">     formattedSize, sizeAbbr.get(),</span>
<a href="#l30.21"></a><span id="l30.21">     (unitIndex != 0) &amp;&amp; (unitSize &lt; 99.95 &amp;&amp; unitSize != 0) ? 1 : 0, unitSize);</span>
<a href="#l30.22"></a><span id="l30.22"> </span>
<a href="#l30.23"></a><span id="l30.23" class="difflineat">@@ -1760,42 +1759,42 @@ NS_MSG_BASE nsresult MsgPromptLoginFaile</span>
<a href="#l30.24"></a><span id="l30.24"> </span>
<a href="#l30.25"></a><span id="l30.25">   nsString message;</span>
<a href="#l30.26"></a><span id="l30.26">   NS_ConvertUTF8toUTF16 hostNameUTF16(aHostname);</span>
<a href="#l30.27"></a><span id="l30.27">   NS_ConvertUTF8toUTF16 userNameUTF16(aUsername);</span>
<a href="#l30.28"></a><span id="l30.28">   const char16_t *formatStrings[] = { hostNameUTF16.get(), userNameUTF16.get() };</span>
<a href="#l30.29"></a><span id="l30.29"> </span>
<a href="#l30.30"></a><span id="l30.30">   rv = bundle-&gt;FormatStringFromName(&quot;mailServerLoginFailed2&quot;,</span>
<a href="#l30.31"></a><span id="l30.31">                                     formatStrings, 2,</span>
<a href="#l30.32"></a><span id="l30.32" class="difflineminus">-                                    getter_Copies(message));</span>
<a href="#l30.33"></a><span id="l30.33" class="difflineplus">+                                    message);</span>
<a href="#l30.34"></a><span id="l30.34">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l30.35"></a><span id="l30.35"> </span>
<a href="#l30.36"></a><span id="l30.36">   nsString title;</span>
<a href="#l30.37"></a><span id="l30.37">   if (aAccountname.IsEmpty()) {</span>
<a href="#l30.38"></a><span id="l30.38">     // Account name may be empty e.g. on a SMTP server.</span>
<a href="#l30.39"></a><span id="l30.39">     rv = bundle-&gt;GetStringFromName(</span>
<a href="#l30.40"></a><span id="l30.40" class="difflineminus">-      &quot;mailServerLoginFailedTitle&quot;, getter_Copies(title));</span>
<a href="#l30.41"></a><span id="l30.41" class="difflineplus">+      &quot;mailServerLoginFailedTitle&quot;, title);</span>
<a href="#l30.42"></a><span id="l30.42">   } else {</span>
<a href="#l30.43"></a><span id="l30.43">     const char16_t *formatStrings[] = { aAccountname.BeginReading() };</span>
<a href="#l30.44"></a><span id="l30.44">     rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l30.45"></a><span id="l30.45">       &quot;mailServerLoginFailedTitleWithAccount&quot;,</span>
<a href="#l30.46"></a><span id="l30.46" class="difflineminus">-      formatStrings, 1, getter_Copies(title));</span>
<a href="#l30.47"></a><span id="l30.47" class="difflineplus">+      formatStrings, 1, title);</span>
<a href="#l30.48"></a><span id="l30.48">   }</span>
<a href="#l30.49"></a><span id="l30.49">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l30.50"></a><span id="l30.50"> </span>
<a href="#l30.51"></a><span id="l30.51">   nsString button0;</span>
<a href="#l30.52"></a><span id="l30.52">   rv = bundle-&gt;GetStringFromName(</span>
<a href="#l30.53"></a><span id="l30.53">     &quot;mailServerLoginFailedRetryButton&quot;,</span>
<a href="#l30.54"></a><span id="l30.54" class="difflineminus">-    getter_Copies(button0));</span>
<a href="#l30.55"></a><span id="l30.55" class="difflineplus">+    button0);</span>
<a href="#l30.56"></a><span id="l30.56">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l30.57"></a><span id="l30.57"> </span>
<a href="#l30.58"></a><span id="l30.58">   nsString button2;</span>
<a href="#l30.59"></a><span id="l30.59">   rv = bundle-&gt;GetStringFromName(</span>
<a href="#l30.60"></a><span id="l30.60">     &quot;mailServerLoginFailedEnterNewPasswordButton&quot;,</span>
<a href="#l30.61"></a><span id="l30.61" class="difflineminus">-    getter_Copies(button2));</span>
<a href="#l30.62"></a><span id="l30.62" class="difflineplus">+    button2);</span>
<a href="#l30.63"></a><span id="l30.63">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l30.64"></a><span id="l30.64"> </span>
<a href="#l30.65"></a><span id="l30.65">   bool dummyValue = false;</span>
<a href="#l30.66"></a><span id="l30.66">   return dialog-&gt;ConfirmEx(</span>
<a href="#l30.67"></a><span id="l30.67">     title.get(), message.get(),</span>
<a href="#l30.68"></a><span id="l30.68">     (nsIPrompt::BUTTON_TITLE_IS_STRING * nsIPrompt::BUTTON_POS_0) +</span>
<a href="#l30.69"></a><span id="l30.69">     (nsIPrompt::BUTTON_TITLE_CANCEL * nsIPrompt::BUTTON_POS_1) +</span>
<a href="#l30.70"></a><span id="l30.70">     (nsIPrompt::BUTTON_TITLE_IS_STRING * nsIPrompt::BUTTON_POS_2),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgAttachmentHandler.cpp</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgAttachmentHandler.cpp</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -1161,20 +1161,20 @@ nsMsgAttachmentHandler::UrlExit(nsresult</span>
<a href="#l31.4"></a><span id="l31.4">     }</span>
<a href="#l31.5"></a><span id="l31.5">     else</span>
<a href="#l31.6"></a><span id="l31.6">       params.AssignLiteral(&quot;?&quot;);</span>
<a href="#l31.7"></a><span id="l31.7"> </span>
<a href="#l31.8"></a><span id="l31.8">     NS_ConvertUTF8toUTF16 UTF16params(params);</span>
<a href="#l31.9"></a><span id="l31.9">     const char16_t* formatParams[] = { UTF16params.get() };</span>
<a href="#l31.10"></a><span id="l31.10">     if (mode == nsIMsgSend::nsMsgSaveAsDraft || mode == nsIMsgSend::nsMsgSaveAsTemplate)</span>
<a href="#l31.11"></a><span id="l31.11">       bundle-&gt;FormatStringFromName(&quot;failureOnObjectEmbeddingWhileSaving&quot;,</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-                                   formatParams, 1, getter_Copies(msg));</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+                                   formatParams, 1, msg);</span>
<a href="#l31.14"></a><span id="l31.14">     else</span>
<a href="#l31.15"></a><span id="l31.15">       bundle-&gt;FormatStringFromName(&quot;failureOnObjectEmbeddingWhileSending&quot;,</span>
<a href="#l31.16"></a><span id="l31.16" class="difflineminus">-                                   formatParams, 1, getter_Copies(msg));</span>
<a href="#l31.17"></a><span id="l31.17" class="difflineplus">+                                   formatParams, 1, msg);</span>
<a href="#l31.18"></a><span id="l31.18"> </span>
<a href="#l31.19"></a><span id="l31.19">     nsCOMPtr&lt;nsIPrompt&gt; aPrompt;</span>
<a href="#l31.20"></a><span id="l31.20">     if (m_mime_delivery_state)</span>
<a href="#l31.21"></a><span id="l31.21">       m_mime_delivery_state-&gt;GetDefaultPrompt(getter_AddRefs(aPrompt));</span>
<a href="#l31.22"></a><span id="l31.22">     nsMsgAskBooleanQuestionByString(aPrompt, msg.get(), &amp;keepOnGoing);</span>
<a href="#l31.23"></a><span id="l31.23"> </span>
<a href="#l31.24"></a><span id="l31.24">     if (keepOnGoing)</span>
<a href="#l31.25"></a><span id="l31.25">     {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgCompUtils.cpp</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgCompUtils.cpp</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -435,17 +435,17 @@ nsresult mime_generate_headers(nsIMsgCom</span>
<a href="#l32.4"></a><span id="l32.4">         if (stringService)</span>
<a href="#l32.5"></a><span id="l32.5">         {</span>
<a href="#l32.6"></a><span id="l32.6">           nsCOMPtr&lt;nsIStringBundle&gt; composeStringBundle;</span>
<a href="#l32.7"></a><span id="l32.7">           rv = stringService-&gt;CreateBundle(&quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;, getter_AddRefs(composeStringBundle));</span>
<a href="#l32.8"></a><span id="l32.8">           if (NS_SUCCEEDED(rv))</span>
<a href="#l32.9"></a><span id="l32.9">           {</span>
<a href="#l32.10"></a><span id="l32.10">             nsString undisclosedRecipients;</span>
<a href="#l32.11"></a><span id="l32.11">             rv = composeStringBundle-&gt;GetStringFromName(&quot;undisclosedRecipients&quot;,</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-                                                        getter_Copies(undisclosedRecipients));</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+                                                        undisclosedRecipients);</span>
<a href="#l32.14"></a><span id="l32.14">             if (NS_SUCCEEDED(rv) &amp;&amp; !undisclosedRecipients.IsEmpty())</span>
<a href="#l32.15"></a><span id="l32.15">             {</span>
<a href="#l32.16"></a><span id="l32.16">               nsCOMPtr&lt;nsIMsgHeaderParser&gt; headerParser(</span>
<a href="#l32.17"></a><span id="l32.17">                 mozilla::services::GetHeaderParser());</span>
<a href="#l32.18"></a><span id="l32.18">               nsCOMPtr&lt;msgIAddressObject&gt; group;</span>
<a href="#l32.19"></a><span id="l32.19">               headerParser-&gt;MakeGroupObject(undisclosedRecipients,</span>
<a href="#l32.20"></a><span id="l32.20">                 nullptr, 0, getter_AddRefs(group));</span>
<a href="#l32.21"></a><span id="l32.21">               recipients.AppendElement(group);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgCompose.cpp</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgCompose.cpp</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -2184,17 +2184,17 @@ nsresult nsMsgCompose::CreateMessage(con</span>
<a href="#l33.4"></a><span id="l33.4">                 nsCOMPtr&lt;nsIStringBundleService&gt; bundleService =</span>
<a href="#l33.5"></a><span id="l33.5">                   mozilla::services::GetStringBundleService();</span>
<a href="#l33.6"></a><span id="l33.6">                 NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l33.7"></a><span id="l33.7">                 nsCOMPtr&lt;nsIStringBundle&gt; composeBundle;</span>
<a href="#l33.8"></a><span id="l33.8">                 rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;,</span>
<a href="#l33.9"></a><span id="l33.9">                                                  getter_AddRefs(composeBundle));</span>
<a href="#l33.10"></a><span id="l33.10">                 NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l33.11"></a><span id="l33.11">                 composeBundle-&gt;GetStringFromName(&quot;messageAttachmentSafeName&quot;,</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-                                                 getter_Copies(sanitizedSubj));</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineplus">+                                                 sanitizedSubj);</span>
<a href="#l33.14"></a><span id="l33.14">               }</span>
<a href="#l33.15"></a><span id="l33.15">               else</span>
<a href="#l33.16"></a><span id="l33.16">                 sanitizedSubj.Assign(subject);</span>
<a href="#l33.17"></a><span id="l33.17"> </span>
<a href="#l33.18"></a><span id="l33.18">               // set the file size</span>
<a href="#l33.19"></a><span id="l33.19">               uint32_t messageSize;</span>
<a href="#l33.20"></a><span id="l33.20">               msgHdr-&gt;GetMessageSize(&amp;messageSize);</span>
<a href="#l33.21"></a><span id="l33.21">               attachment-&gt;SetSize(messageSize);</span>
<a href="#l33.22"></a><span id="l33.22" class="difflineat">@@ -4057,17 +4057,17 @@ NS_IMETHODIMP nsMsgComposeSendListener::</span>
<a href="#l33.23"></a><span id="l33.23">             mozilla::services::GetStringBundleService();</span>
<a href="#l33.24"></a><span id="l33.24">           NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l33.25"></a><span id="l33.25">           nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l33.26"></a><span id="l33.26">           rv = bundleService-&gt;CreateBundle(</span>
<a href="#l33.27"></a><span id="l33.27">             &quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;,</span>
<a href="#l33.28"></a><span id="l33.28">             getter_AddRefs(bundle));</span>
<a href="#l33.29"></a><span id="l33.29">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l33.30"></a><span id="l33.30">           nsString msg;</span>
<a href="#l33.31"></a><span id="l33.31" class="difflineminus">-          bundle-&gt;GetStringFromName(&quot;msgCancelling&quot;, getter_Copies(msg));</span>
<a href="#l33.32"></a><span id="l33.32" class="difflineplus">+          bundle-&gt;GetStringFromName(&quot;msgCancelling&quot;, msg);</span>
<a href="#l33.33"></a><span id="l33.33">           progress-&gt;OnStatusChange(nullptr, nullptr, NS_OK, msg.get());</span>
<a href="#l33.34"></a><span id="l33.34">         }</span>
<a href="#l33.35"></a><span id="l33.35">       }</span>
<a href="#l33.36"></a><span id="l33.36"> </span>
<a href="#l33.37"></a><span id="l33.37">       nsCOMPtr&lt;nsIMsgSend&gt; msgSend;</span>
<a href="#l33.38"></a><span id="l33.38">       msgCompose-&gt;GetMessageSend(getter_AddRefs(msgSend));</span>
<a href="#l33.39"></a><span id="l33.39">       if (msgSend)</span>
<a href="#l33.40"></a><span id="l33.40">         msgSend-&gt;Abort();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgPrompts.cpp</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgPrompts.cpp</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -23,17 +23,17 @@ nsMsgGetMessageByName(const char* aName,</span>
<a href="#l34.4"></a><span id="l34.4">   NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l34.5"></a><span id="l34.5"> </span>
<a href="#l34.6"></a><span id="l34.6">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l34.7"></a><span id="l34.7">   rv = bundleService-&gt;CreateBundle(</span>
<a href="#l34.8"></a><span id="l34.8">     &quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;,</span>
<a href="#l34.9"></a><span id="l34.9">     getter_AddRefs(bundle));</span>
<a href="#l34.10"></a><span id="l34.10">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l34.11"></a><span id="l34.11"> </span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-  return bundle-&gt;GetStringFromName(aName, getter_Copies(aResult));</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+  return bundle-&gt;GetStringFromName(aName, aResult);</span>
<a href="#l34.14"></a><span id="l34.14"> }</span>
<a href="#l34.15"></a><span id="l34.15"> </span>
<a href="#l34.16"></a><span id="l34.16"> static nsresult</span>
<a href="#l34.17"></a><span id="l34.17"> nsMsgBuildMessageByName(const char *aName, nsIFile *aFile, nsString&amp; aResult)</span>
<a href="#l34.18"></a><span id="l34.18"> {</span>
<a href="#l34.19"></a><span id="l34.19">   NS_ENSURE_ARG_POINTER(aFile);</span>
<a href="#l34.20"></a><span id="l34.20">   nsresult rv;</span>
<a href="#l34.21"></a><span id="l34.21">   nsCOMPtr&lt;nsIStringBundleService&gt; bundleService =</span>
<a href="#l34.22"></a><span id="l34.22" class="difflineat">@@ -43,17 +43,17 @@ nsMsgBuildMessageByName(const char *aNam</span>
<a href="#l34.23"></a><span id="l34.23">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l34.24"></a><span id="l34.24">   rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l34.25"></a><span id="l34.25">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l34.26"></a><span id="l34.26"> </span>
<a href="#l34.27"></a><span id="l34.27">   nsString path;</span>
<a href="#l34.28"></a><span id="l34.28">   aFile-&gt;GetPath(path);</span>
<a href="#l34.29"></a><span id="l34.29"> </span>
<a href="#l34.30"></a><span id="l34.30">   const char16_t *params[1] = {path.get()};</span>
<a href="#l34.31"></a><span id="l34.31" class="difflineminus">-  return bundle-&gt;FormatStringFromName(aName, params, 1, getter_Copies(aResult));</span>
<a href="#l34.32"></a><span id="l34.32" class="difflineplus">+  return bundle-&gt;FormatStringFromName(aName, params, 1, aResult);</span>
<a href="#l34.33"></a><span id="l34.33"> }</span>
<a href="#l34.34"></a><span id="l34.34"> </span>
<a href="#l34.35"></a><span id="l34.35"> nsresult</span>
<a href="#l34.36"></a><span id="l34.36"> nsMsgBuildMessageWithFile(nsIFile *aFile, nsString&amp; aResult)</span>
<a href="#l34.37"></a><span id="l34.37"> {</span>
<a href="#l34.38"></a><span id="l34.38">   return nsMsgBuildMessageByName(&quot;unableToOpenFile&quot;, aFile, aResult);</span>
<a href="#l34.39"></a><span id="l34.39"> }</span>
<a href="#l34.40"></a><span id="l34.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgSend.cpp</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgSend.cpp</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -559,18 +559,17 @@ nsMsgComposeAndSend::GatherMimeAttachmen</span>
<a href="#l35.4"></a><span id="l35.4"> </span>
<a href="#l35.5"></a><span id="l35.5">   /* Kludge to avoid having to allocate memory on the toy computers... */</span>
<a href="#l35.6"></a><span id="l35.6">   buffer = mime_get_stream_write_buffer();</span>
<a href="#l35.7"></a><span id="l35.7">   if (! buffer)</span>
<a href="#l35.8"></a><span id="l35.8">     goto FAILMEM;</span>
<a href="#l35.9"></a><span id="l35.9"> </span>
<a href="#l35.10"></a><span id="l35.10">   NS_ASSERTION (m_attachment_pending_count == 0, &quot;m_attachment_pending_count != 0&quot;);</span>
<a href="#l35.11"></a><span id="l35.11"> </span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-  mComposeBundle-&gt;GetStringFromName(&quot;assemblingMessage&quot;,</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineminus">-                                    getter_Copies(msg));</span>
<a href="#l35.14"></a><span id="l35.14" class="difflineplus">+  mComposeBundle-&gt;GetStringFromName(&quot;assemblingMessage&quot;, msg);</span>
<a href="#l35.15"></a><span id="l35.15">   SetStatusMessage( msg );</span>
<a href="#l35.16"></a><span id="l35.16"> </span>
<a href="#l35.17"></a><span id="l35.17">   /* First, open the message file.</span>
<a href="#l35.18"></a><span id="l35.18">   */</span>
<a href="#l35.19"></a><span id="l35.19">   rv = nsMsgCreateTempFile(&quot;nsemail.eml&quot;, getter_AddRefs(mTempFile));</span>
<a href="#l35.20"></a><span id="l35.20">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l35.21"></a><span id="l35.21"> </span>
<a href="#l35.22"></a><span id="l35.22">   rv = MsgNewBufferedFileOutputStream(getter_AddRefs(mOutputFile), mTempFile, -1, 00600);</span>
<a href="#l35.23"></a><span id="l35.23" class="difflineat">@@ -926,18 +925,17 @@ nsMsgComposeAndSend::GatherMimeAttachmen</span>
<a href="#l35.24"></a><span id="l35.24">         if (m_attachments[i]-&gt;mMHTMLPart)</span>
<a href="#l35.25"></a><span id="l35.25">           PreProcessPart(m_attachments[i], m_related_part);</span>
<a href="#l35.26"></a><span id="l35.26">       }</span>
<a href="#l35.27"></a><span id="l35.27">     }</span>
<a href="#l35.28"></a><span id="l35.28"> </span>
<a href="#l35.29"></a><span id="l35.29">   }</span>
<a href="#l35.30"></a><span id="l35.30"> </span>
<a href="#l35.31"></a><span id="l35.31">   // Tell the user we are creating the message...</span>
<a href="#l35.32"></a><span id="l35.32" class="difflineminus">-  mComposeBundle-&gt;GetStringFromName(&quot;creatingMailMessage&quot;,</span>
<a href="#l35.33"></a><span id="l35.33" class="difflineminus">-                                    getter_Copies(msg));</span>
<a href="#l35.34"></a><span id="l35.34" class="difflineplus">+  mComposeBundle-&gt;GetStringFromName(&quot;creatingMailMessage&quot;, msg);</span>
<a href="#l35.35"></a><span id="l35.35">   SetStatusMessage( msg );</span>
<a href="#l35.36"></a><span id="l35.36"> </span>
<a href="#l35.37"></a><span id="l35.37">   // OK, now actually write the structure we've carefully built up.</span>
<a href="#l35.38"></a><span id="l35.38">   status = toppart-&gt;Write();</span>
<a href="#l35.39"></a><span id="l35.39">   if (NS_FAILED(status))</span>
<a href="#l35.40"></a><span id="l35.40">     goto FAIL;</span>
<a href="#l35.41"></a><span id="l35.41"> </span>
<a href="#l35.42"></a><span id="l35.42">   /* Close down encryption stream */</span>
<a href="#l35.43"></a><span id="l35.43" class="difflineat">@@ -969,18 +967,17 @@ nsMsgComposeAndSend::GatherMimeAttachmen</span>
<a href="#l35.44"></a><span id="l35.44">     rv = mTempFile-&gt;GetFileSize(&amp;fileSize);</span>
<a href="#l35.45"></a><span id="l35.45">     if (NS_FAILED(rv) || fileSize == 0)</span>
<a href="#l35.46"></a><span id="l35.46">     {</span>
<a href="#l35.47"></a><span id="l35.47">       status = NS_MSG_ERROR_WRITING_FILE;</span>
<a href="#l35.48"></a><span id="l35.48">       goto FAIL;</span>
<a href="#l35.49"></a><span id="l35.49">     }</span>
<a href="#l35.50"></a><span id="l35.50">   }</span>
<a href="#l35.51"></a><span id="l35.51"> </span>
<a href="#l35.52"></a><span id="l35.52" class="difflineminus">-  mComposeBundle-&gt;GetStringFromName(&quot;assemblingMessageDone&quot;,</span>
<a href="#l35.53"></a><span id="l35.53" class="difflineminus">-                                    getter_Copies(msg));</span>
<a href="#l35.54"></a><span id="l35.54" class="difflineplus">+  mComposeBundle-&gt;GetStringFromName(&quot;assemblingMessageDone&quot;, msg);</span>
<a href="#l35.55"></a><span id="l35.55">   SetStatusMessage(msg);</span>
<a href="#l35.56"></a><span id="l35.56"> </span>
<a href="#l35.57"></a><span id="l35.57">   if (m_dont_deliver_p &amp;&amp; mListener)</span>
<a href="#l35.58"></a><span id="l35.58">   {</span>
<a href="#l35.59"></a><span id="l35.59">     //</span>
<a href="#l35.60"></a><span id="l35.60">     // Need to ditch the file spec here so that we don't delete the</span>
<a href="#l35.61"></a><span id="l35.61">     // file, since in this case, the caller wants the file</span>
<a href="#l35.62"></a><span id="l35.62">     //</span>
<a href="#l35.63"></a><span id="l35.63" class="difflineat">@@ -2518,17 +2515,17 @@ nsMsgComposeAndSend::HackAttachments(nsI</span>
<a href="#l35.64"></a><span id="l35.64">         formatParams[0] = params.get();</span>
<a href="#l35.65"></a><span id="l35.65">       } else if (m_attachments[i]-&gt;mURL) {</span>
<a href="#l35.66"></a><span id="l35.66">         nsCString asciiSpec;</span>
<a href="#l35.67"></a><span id="l35.67">         m_attachments[i]-&gt;mURL-&gt;GetAsciiSpec(asciiSpec);</span>
<a href="#l35.68"></a><span id="l35.68">         attachmentFileName.AssignASCII(asciiSpec.get());</span>
<a href="#l35.69"></a><span id="l35.69">         formatParams[0] = attachmentFileName.get();</span>
<a href="#l35.70"></a><span id="l35.70">       }</span>
<a href="#l35.71"></a><span id="l35.71">       mComposeBundle-&gt;FormatStringFromName(&quot;gatheringAttachment&quot;,</span>
<a href="#l35.72"></a><span id="l35.72" class="difflineminus">-                                           formatParams, 1, getter_Copies(msg));</span>
<a href="#l35.73"></a><span id="l35.73" class="difflineplus">+                                           formatParams, 1, msg);</span>
<a href="#l35.74"></a><span id="l35.74"> </span>
<a href="#l35.75"></a><span id="l35.75">       if (!msg.IsEmpty())</span>
<a href="#l35.76"></a><span id="l35.76">       {</span>
<a href="#l35.77"></a><span id="l35.77">         SetStatusMessage(msg);</span>
<a href="#l35.78"></a><span id="l35.78">       }</span>
<a href="#l35.79"></a><span id="l35.79"> </span>
<a href="#l35.80"></a><span id="l35.80">       /* As SnarfAttachment will call GatherMimeAttachments when it will be done (this is an async process),</span>
<a href="#l35.81"></a><span id="l35.81">          we need to avoid to call it ourself.</span>
<a href="#l35.82"></a><span id="l35.82" class="difflineat">@@ -2547,17 +2544,17 @@ nsMsgComposeAndSend::HackAttachments(nsI</span>
<a href="#l35.83"></a><span id="l35.83">           rv = NS_OK;</span>
<a href="#l35.84"></a><span id="l35.84">         }</span>
<a href="#l35.85"></a><span id="l35.85">         if (NS_SUCCEEDED(rv))</span>
<a href="#l35.86"></a><span id="l35.86">         {</span>
<a href="#l35.87"></a><span id="l35.87">           nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l35.88"></a><span id="l35.88">           const char16_t *params[] = { attachmentFileName.get() };</span>
<a href="#l35.89"></a><span id="l35.89">           mComposeBundle-&gt;FormatStringFromName(&quot;errorAttachingFile&quot;,</span>
<a href="#l35.90"></a><span id="l35.90">                                                params, 1,</span>
<a href="#l35.91"></a><span id="l35.91" class="difflineminus">-                                               getter_Copies(errorMsg));</span>
<a href="#l35.92"></a><span id="l35.92" class="difflineplus">+                                               errorMsg);</span>
<a href="#l35.93"></a><span id="l35.93">           mSendReport-&gt;SetMessage(nsIMsgSendReport::process_Current, errorMsg.get(), false);</span>
<a href="#l35.94"></a><span id="l35.94">           mSendReport-&gt;SetError(nsIMsgSendReport::process_Current,</span>
<a href="#l35.95"></a><span id="l35.95">                                 NS_MSG_ERROR_ATTACHING_FILE,</span>
<a href="#l35.96"></a><span id="l35.96">                                 false);</span>
<a href="#l35.97"></a><span id="l35.97">         }</span>
<a href="#l35.98"></a><span id="l35.98">         return NS_MSG_ERROR_ATTACHING_FILE;</span>
<a href="#l35.99"></a><span id="l35.99">       }</span>
<a href="#l35.100"></a><span id="l35.100">       if (m_be_synchronous_p)</span>
<a href="#l35.101"></a><span id="l35.101" class="difflineat">@@ -3037,17 +3034,17 @@ nsMsgComposeAndSend::Init(</span>
<a href="#l35.102"></a><span id="l35.102">       mozilla::services::GetStringBundleService();</span>
<a href="#l35.103"></a><span id="l35.103">     NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l35.104"></a><span id="l35.104">     nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l35.105"></a><span id="l35.105">     rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;, getter_AddRefs(mComposeBundle));</span>
<a href="#l35.106"></a><span id="l35.106">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l35.107"></a><span id="l35.107">   }</span>
<a href="#l35.108"></a><span id="l35.108"> </span>
<a href="#l35.109"></a><span id="l35.109">   // Tell the user we are assembling the message...</span>
<a href="#l35.110"></a><span id="l35.110" class="difflineminus">-  mComposeBundle-&gt;GetStringFromName(&quot;assemblingMailInformation&quot;, getter_Copies(msg));</span>
<a href="#l35.111"></a><span id="l35.111" class="difflineplus">+  mComposeBundle-&gt;GetStringFromName(&quot;assemblingMailInformation&quot;, msg);</span>
<a href="#l35.112"></a><span id="l35.112">   SetStatusMessage(msg);</span>
<a href="#l35.113"></a><span id="l35.113">   if (mSendReport)</span>
<a href="#l35.114"></a><span id="l35.114">     mSendReport-&gt;SetCurrentProcess(nsIMsgSendReport::process_BuildMessage);</span>
<a href="#l35.115"></a><span id="l35.115"> </span>
<a href="#l35.116"></a><span id="l35.116">   //</span>
<a href="#l35.117"></a><span id="l35.117">   // The Init() method should initialize a send operation for full</span>
<a href="#l35.118"></a><span id="l35.118">   // blown create and send operations as well as just the &quot;send a file&quot;</span>
<a href="#l35.119"></a><span id="l35.119">   // operations.</span>
<a href="#l35.120"></a><span id="l35.120" class="difflineat">@@ -3241,17 +3238,17 @@ nsMsgComposeAndSend::DeliverMessage()</span>
<a href="#l35.121"></a><span id="l35.121">   if ((mMessageWarningSize &gt; 0) &amp;&amp; (fileSize &gt; mMessageWarningSize) &amp;&amp; (mGUINotificationEnabled))</span>
<a href="#l35.122"></a><span id="l35.122">   {</span>
<a href="#l35.123"></a><span id="l35.123">     bool abortTheSend = false;</span>
<a href="#l35.124"></a><span id="l35.124">     nsString msg;</span>
<a href="#l35.125"></a><span id="l35.125">     nsAutoString formattedFileSize;</span>
<a href="#l35.126"></a><span id="l35.126">     FormatFileSize(fileSize, true, formattedFileSize);</span>
<a href="#l35.127"></a><span id="l35.127">     const char16_t* params[] = { formattedFileSize.get() };</span>
<a href="#l35.128"></a><span id="l35.128">     mComposeBundle-&gt;FormatStringFromName(&quot;largeMessageSendWarning&quot;,</span>
<a href="#l35.129"></a><span id="l35.129" class="difflineminus">-                                         params, 1, getter_Copies(msg));</span>
<a href="#l35.130"></a><span id="l35.130" class="difflineplus">+                                         params, 1, msg);</span>
<a href="#l35.131"></a><span id="l35.131"> </span>
<a href="#l35.132"></a><span id="l35.132">     if (!msg.IsEmpty())</span>
<a href="#l35.133"></a><span id="l35.133">     {</span>
<a href="#l35.134"></a><span id="l35.134">       nsCOMPtr&lt;nsIPrompt&gt; prompt;</span>
<a href="#l35.135"></a><span id="l35.135">       GetDefaultPrompt(getter_AddRefs(prompt));</span>
<a href="#l35.136"></a><span id="l35.136">       nsMsgAskBooleanQuestionByString(prompt, msg.get(), &amp;abortTheSend);</span>
<a href="#l35.137"></a><span id="l35.137">       if (!abortTheSend)</span>
<a href="#l35.138"></a><span id="l35.138">       {</span>
<a href="#l35.139"></a><span id="l35.139" class="difflineat">@@ -3399,17 +3396,17 @@ nsMsgComposeAndSend::DeliverFileAsMail()</span>
<a href="#l35.140"></a><span id="l35.140">     // to the top most mail window...after all, that's where we are going to be sending status</span>
<a href="#l35.141"></a><span id="l35.141">     // update information too....</span>
<a href="#l35.142"></a><span id="l35.142"> </span>
<a href="#l35.143"></a><span id="l35.143">     nsCOMPtr&lt;nsIInterfaceRequestor&gt; callbacks;</span>
<a href="#l35.144"></a><span id="l35.144">     GetNotificationCallbacks(getter_AddRefs(callbacks));</span>
<a href="#l35.145"></a><span id="l35.145"> </span>
<a href="#l35.146"></a><span id="l35.146">     // Tell the user we are sending the message!</span>
<a href="#l35.147"></a><span id="l35.147">     nsString msg;</span>
<a href="#l35.148"></a><span id="l35.148" class="difflineminus">-    mComposeBundle-&gt;GetStringFromName(&quot;sendingMessage&quot;, getter_Copies(msg));</span>
<a href="#l35.149"></a><span id="l35.149" class="difflineplus">+    mComposeBundle-&gt;GetStringFromName(&quot;sendingMessage&quot;, msg);</span>
<a href="#l35.150"></a><span id="l35.150">     SetStatusMessage(msg);</span>
<a href="#l35.151"></a><span id="l35.151">     nsCOMPtr&lt;nsIMsgStatusFeedback&gt; msgStatus (do_QueryInterface(mSendProgress));</span>
<a href="#l35.152"></a><span id="l35.152">     // if the sendProgress isn't set, let's use the member variable.</span>
<a href="#l35.153"></a><span id="l35.153">     if (!msgStatus)</span>
<a href="#l35.154"></a><span id="l35.154">       msgStatus = do_QueryInterface(mStatusFeedback);</span>
<a href="#l35.155"></a><span id="l35.155"> </span>
<a href="#l35.156"></a><span id="l35.156">     nsCOMPtr&lt;nsIURI&gt; runningUrl;</span>
<a href="#l35.157"></a><span id="l35.157">     rv = smtpService-&gt;SendMailMessage(mTempFile, buf, mUserIdentity,</span>
<a href="#l35.158"></a><span id="l35.158" class="difflineat">@@ -3448,18 +3445,17 @@ nsMsgComposeAndSend::DeliverFileAsNews()</span>
<a href="#l35.159"></a><span id="l35.159">   if (NS_SUCCEEDED(rv) &amp;&amp; nntpService)</span>
<a href="#l35.160"></a><span id="l35.160">   {</span>
<a href="#l35.161"></a><span id="l35.161">     MsgDeliveryListener *deliveryListener = new MsgDeliveryListener(this, true);</span>
<a href="#l35.162"></a><span id="l35.162">     if (!deliveryListener)</span>
<a href="#l35.163"></a><span id="l35.163">       return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l35.164"></a><span id="l35.164"> </span>
<a href="#l35.165"></a><span id="l35.165">     // Tell the user we are posting the message!</span>
<a href="#l35.166"></a><span id="l35.166">     nsString msg;</span>
<a href="#l35.167"></a><span id="l35.167" class="difflineminus">-    mComposeBundle-&gt;GetStringFromName(&quot;postingMessage&quot;,</span>
<a href="#l35.168"></a><span id="l35.168" class="difflineminus">-                                      getter_Copies(msg));</span>
<a href="#l35.169"></a><span id="l35.169" class="difflineplus">+    mComposeBundle-&gt;GetStringFromName(&quot;postingMessage&quot;, msg);</span>
<a href="#l35.170"></a><span id="l35.170">     SetStatusMessage(msg);</span>
<a href="#l35.171"></a><span id="l35.171"> </span>
<a href="#l35.172"></a><span id="l35.172">     nsCOMPtr &lt;nsIMsgMailSession&gt; mailSession = do_GetService(NS_MSGMAILSESSION_CONTRACTID, &amp;rv);</span>
<a href="#l35.173"></a><span id="l35.173">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l35.174"></a><span id="l35.174"> </span>
<a href="#l35.175"></a><span id="l35.175">     // JFD TODO: we should use GetDefaultPrompt instead</span>
<a href="#l35.176"></a><span id="l35.176">     nsCOMPtr&lt;nsIMsgWindow&gt; msgWindow;</span>
<a href="#l35.177"></a><span id="l35.177">     rv = mailSession-&gt;GetTopmostMsgWindow(getter_AddRefs(msgWindow));</span>
<a href="#l35.178"></a><span id="l35.178" class="difflineat">@@ -3512,20 +3508,18 @@ nsMsgComposeAndSend::Fail(nsresult aFail</span>
<a href="#l35.179"></a><span id="l35.179"> </span>
<a href="#l35.180"></a><span id="l35.180">   //Stop any pending process...</span>
<a href="#l35.181"></a><span id="l35.181">   Abort();</span>
<a href="#l35.182"></a><span id="l35.182"> </span>
<a href="#l35.183"></a><span id="l35.183">   return NS_OK;</span>
<a href="#l35.184"></a><span id="l35.184"> }</span>
<a href="#l35.185"></a><span id="l35.185"> </span>
<a href="#l35.186"></a><span id="l35.186"> nsresult</span>
<a href="#l35.187"></a><span id="l35.187" class="difflineminus">-nsMsgComposeAndSend::FormatStringWithSMTPHostNameByName(const char* aMsgName, char16_t **aString)</span>
<a href="#l35.188"></a><span id="l35.188" class="difflineplus">+nsMsgComposeAndSend::FormatStringWithSMTPHostNameByName(const char* aMsgName, nsAString&amp; aString)</span>
<a href="#l35.189"></a><span id="l35.189"> {</span>
<a href="#l35.190"></a><span id="l35.190" class="difflineminus">-  NS_ENSURE_ARG(aString);</span>
<a href="#l35.191"></a><span id="l35.191" class="difflineminus">-</span>
<a href="#l35.192"></a><span id="l35.192">   nsresult rv;</span>
<a href="#l35.193"></a><span id="l35.193">   nsCOMPtr&lt;nsISmtpService&gt; smtpService(do_GetService(NS_SMTPSERVICE_CONTRACTID, &amp;rv));</span>
<a href="#l35.194"></a><span id="l35.194">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l35.195"></a><span id="l35.195"> </span>
<a href="#l35.196"></a><span id="l35.196">   // Get the smtp hostname and format the string.</span>
<a href="#l35.197"></a><span id="l35.197">   nsCString smtpHostName;</span>
<a href="#l35.198"></a><span id="l35.198">   nsCOMPtr&lt;nsISmtpServer&gt; smtpServer;</span>
<a href="#l35.199"></a><span id="l35.199">   rv = smtpService-&gt;GetServerByIdentity(mUserIdentity, getter_AddRefs(smtpServer));</span>
<a href="#l35.200"></a><span id="l35.200" class="difflineat">@@ -3558,19 +3552,19 @@ nsMsgComposeAndSend::DoDeliveryExitProce</span>
<a href="#l35.201"></a><span id="l35.201">         aExitCode == NS_ERROR_SMTP_AUTH_FAILURE ||</span>
<a href="#l35.202"></a><span id="l35.202">         aExitCode == NS_ERROR_SMTP_AUTH_GSSAPI ||</span>
<a href="#l35.203"></a><span id="l35.203">         aExitCode == NS_ERROR_SMTP_AUTH_MECH_NOT_SUPPORTED ||</span>
<a href="#l35.204"></a><span id="l35.204">         aExitCode == NS_ERROR_SMTP_AUTH_NOT_SUPPORTED ||</span>
<a href="#l35.205"></a><span id="l35.205">         aExitCode == NS_ERROR_SMTP_AUTH_CHANGE_ENCRYPT_TO_PLAIN_NO_SSL ||</span>
<a href="#l35.206"></a><span id="l35.206">         aExitCode == NS_ERROR_SMTP_AUTH_CHANGE_ENCRYPT_TO_PLAIN_SSL ||</span>
<a href="#l35.207"></a><span id="l35.207">         aExitCode == NS_ERROR_SMTP_AUTH_CHANGE_PLAIN_TO_ENCRYPT ||</span>
<a href="#l35.208"></a><span id="l35.208">         aExitCode == NS_ERROR_STARTTLS_FAILED_EHLO_STARTTLS) {</span>
<a href="#l35.209"></a><span id="l35.209" class="difflineminus">-      FormatStringWithSMTPHostNameByName(exitString, getter_Copies(eMsg));</span>
<a href="#l35.210"></a><span id="l35.210" class="difflineplus">+      FormatStringWithSMTPHostNameByName(exitString, eMsg);</span>
<a href="#l35.211"></a><span id="l35.211">     } else {</span>
<a href="#l35.212"></a><span id="l35.212" class="difflineminus">-      mComposeBundle-&gt;GetStringFromName(exitString, getter_Copies(eMsg));</span>
<a href="#l35.213"></a><span id="l35.213" class="difflineplus">+      mComposeBundle-&gt;GetStringFromName(exitString, eMsg);</span>
<a href="#l35.214"></a><span id="l35.214">     }</span>
<a href="#l35.215"></a><span id="l35.215"> </span>
<a href="#l35.216"></a><span id="l35.216">     Fail(aExitCode, eMsg.get(), &amp;aExitCode);</span>
<a href="#l35.217"></a><span id="l35.217">     NotifyListenerOnStopSending(nullptr, aExitCode, nullptr, nullptr);</span>
<a href="#l35.218"></a><span id="l35.218">     return;</span>
<a href="#l35.219"></a><span id="l35.219">   }</span>
<a href="#l35.220"></a><span id="l35.220"> </span>
<a href="#l35.221"></a><span id="l35.221">   if (aCheckForMail)</span>
<a href="#l35.222"></a><span id="l35.222" class="difflineat">@@ -3827,19 +3821,19 @@ NS_IMETHODIMP</span>
<a href="#l35.223"></a><span id="l35.223"> nsMsgComposeAndSend::NotifyListenerOnStopCopy(nsresult aStatus)</span>
<a href="#l35.224"></a><span id="l35.224"> {</span>
<a href="#l35.225"></a><span id="l35.225">   // This is one per copy so make sure we clean this up first.</span>
<a href="#l35.226"></a><span id="l35.226">   mCopyObj = nullptr;</span>
<a href="#l35.227"></a><span id="l35.227"> </span>
<a href="#l35.228"></a><span id="l35.228">   // Set a status message...</span>
<a href="#l35.229"></a><span id="l35.229">   nsString msg;</span>
<a href="#l35.230"></a><span id="l35.230">   if (NS_SUCCEEDED(aStatus))</span>
<a href="#l35.231"></a><span id="l35.231" class="difflineminus">-    mComposeBundle-&gt;GetStringFromName(&quot;copyMessageComplete&quot;, getter_Copies(msg));</span>
<a href="#l35.232"></a><span id="l35.232" class="difflineplus">+    mComposeBundle-&gt;GetStringFromName(&quot;copyMessageComplete&quot;, msg);</span>
<a href="#l35.233"></a><span id="l35.233">   else</span>
<a href="#l35.234"></a><span id="l35.234" class="difflineminus">-    mComposeBundle-&gt;GetStringFromName(&quot;copyMessageFailed&quot;, getter_Copies(msg));</span>
<a href="#l35.235"></a><span id="l35.235" class="difflineplus">+    mComposeBundle-&gt;GetStringFromName(&quot;copyMessageFailed&quot;, msg);</span>
<a href="#l35.236"></a><span id="l35.236"> </span>
<a href="#l35.237"></a><span id="l35.237">   SetStatusMessage(msg);</span>
<a href="#l35.238"></a><span id="l35.238">   nsCOMPtr&lt;nsIPrompt&gt; prompt;</span>
<a href="#l35.239"></a><span id="l35.239">   GetDefaultPrompt(getter_AddRefs(prompt));</span>
<a href="#l35.240"></a><span id="l35.240"> </span>
<a href="#l35.241"></a><span id="l35.241">   if (NS_FAILED(aStatus))</span>
<a href="#l35.242"></a><span id="l35.242">   {</span>
<a href="#l35.243"></a><span id="l35.243">     nsresult rv;</span>
<a href="#l35.244"></a><span id="l35.244" class="difflineat">@@ -3892,40 +3886,40 @@ nsMsgComposeAndSend::NotifyListenerOnSto</span>
<a href="#l35.245"></a><span id="l35.245"> </span>
<a href="#l35.246"></a><span id="l35.246">     nsString msg;</span>
<a href="#l35.247"></a><span id="l35.247">     switch (m_deliver_mode)</span>
<a href="#l35.248"></a><span id="l35.248">     {</span>
<a href="#l35.249"></a><span id="l35.249">       case nsMsgDeliverNow:</span>
<a href="#l35.250"></a><span id="l35.250">       case nsMsgSendUnsent:</span>
<a href="#l35.251"></a><span id="l35.251">         rv = bundle-&gt;FormatStringFromName(&quot;promptToSaveSentLocally&quot;,</span>
<a href="#l35.252"></a><span id="l35.252">                                           formatStrings, 3,</span>
<a href="#l35.253"></a><span id="l35.253" class="difflineminus">-                                          getter_Copies(msg));</span>
<a href="#l35.254"></a><span id="l35.254" class="difflineplus">+                                          msg);</span>
<a href="#l35.255"></a><span id="l35.255">         break;</span>
<a href="#l35.256"></a><span id="l35.256">       case nsMsgSaveAsDraft:</span>
<a href="#l35.257"></a><span id="l35.257">         rv = bundle-&gt;FormatStringFromName(&quot;promptToSaveDraftLocally&quot;,</span>
<a href="#l35.258"></a><span id="l35.258">                                           formatStrings, 3,</span>
<a href="#l35.259"></a><span id="l35.259" class="difflineminus">-                                          getter_Copies(msg));</span>
<a href="#l35.260"></a><span id="l35.260" class="difflineplus">+                                          msg);</span>
<a href="#l35.261"></a><span id="l35.261">         break;</span>
<a href="#l35.262"></a><span id="l35.262">       case nsMsgSaveAsTemplate:</span>
<a href="#l35.263"></a><span id="l35.263">         rv = bundle-&gt;FormatStringFromName(&quot;promptToSaveTemplateLocally&quot;,</span>
<a href="#l35.264"></a><span id="l35.264">                                           formatStrings, 3,</span>
<a href="#l35.265"></a><span id="l35.265" class="difflineminus">-                                          getter_Copies(msg));</span>
<a href="#l35.266"></a><span id="l35.266" class="difflineplus">+                                          msg);</span>
<a href="#l35.267"></a><span id="l35.267">         break;</span>
<a href="#l35.268"></a><span id="l35.268">       default:</span>
<a href="#l35.269"></a><span id="l35.269">         rv = NS_ERROR_UNEXPECTED;</span>
<a href="#l35.270"></a><span id="l35.270">     }</span>
<a href="#l35.271"></a><span id="l35.271">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l35.272"></a><span id="l35.272">     int32_t buttonPressed = 0;</span>
<a href="#l35.273"></a><span id="l35.273">     bool showCheckBox = false;</span>
<a href="#l35.274"></a><span id="l35.274">     uint32_t buttonFlags = (nsIPrompt::BUTTON_POS_0 * nsIPrompt::BUTTON_TITLE_IS_STRING) +</span>
<a href="#l35.275"></a><span id="l35.275">                            (nsIPrompt::BUTTON_POS_1 * nsIPrompt::BUTTON_TITLE_CANCEL) +</span>
<a href="#l35.276"></a><span id="l35.276">                            (nsIPrompt::BUTTON_POS_2 * nsIPrompt::BUTTON_TITLE_SAVE);</span>
<a href="#l35.277"></a><span id="l35.277">     nsString dialogTitle, buttonLabelRetry;</span>
<a href="#l35.278"></a><span id="l35.278" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;SaveDialogTitle&quot;, getter_Copies(dialogTitle));</span>
<a href="#l35.279"></a><span id="l35.279" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;buttonLabelRetry&quot;, getter_Copies(buttonLabelRetry));</span>
<a href="#l35.280"></a><span id="l35.280" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;SaveDialogTitle&quot;, dialogTitle);</span>
<a href="#l35.281"></a><span id="l35.281" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;buttonLabelRetry&quot;, buttonLabelRetry);</span>
<a href="#l35.282"></a><span id="l35.282">     prompt-&gt;ConfirmEx(dialogTitle.get(), msg.get(), buttonFlags, buttonLabelRetry.get(),</span>
<a href="#l35.283"></a><span id="l35.283">                       nullptr, nullptr, nullptr, &amp;showCheckBox, &amp;buttonPressed);</span>
<a href="#l35.284"></a><span id="l35.284">     if (buttonPressed == 0)</span>
<a href="#l35.285"></a><span id="l35.285">     {</span>
<a href="#l35.286"></a><span id="l35.286">       // retry button clicked</span>
<a href="#l35.287"></a><span id="l35.287">       mSendProgress = nullptr; // this was canceled, so we need to clear it.</span>
<a href="#l35.288"></a><span id="l35.288">       return SendToMagicFolder(m_deliver_mode);</span>
<a href="#l35.289"></a><span id="l35.289">     }</span>
<a href="#l35.290"></a><span id="l35.290" class="difflineat">@@ -4009,25 +4003,25 @@ nsMsgComposeAndSend::FilterSentMessage()</span>
<a href="#l35.291"></a><span id="l35.291"> }</span>
<a href="#l35.292"></a><span id="l35.292"> </span>
<a href="#l35.293"></a><span id="l35.293"> NS_IMETHODIMP</span>
<a href="#l35.294"></a><span id="l35.294"> nsMsgComposeAndSend::OnStopOperation(nsresult aStatus)</span>
<a href="#l35.295"></a><span id="l35.295"> {</span>
<a href="#l35.296"></a><span id="l35.296">   // Set a status message...</span>
<a href="#l35.297"></a><span id="l35.297">   nsString msg;</span>
<a href="#l35.298"></a><span id="l35.298">   if (NS_SUCCEEDED(aStatus))</span>
<a href="#l35.299"></a><span id="l35.299" class="difflineminus">-    mComposeBundle-&gt;GetStringFromName(&quot;filterMessageComplete&quot;, getter_Copies(msg));</span>
<a href="#l35.300"></a><span id="l35.300" class="difflineplus">+    mComposeBundle-&gt;GetStringFromName(&quot;filterMessageComplete&quot;, msg);</span>
<a href="#l35.301"></a><span id="l35.301">   else</span>
<a href="#l35.302"></a><span id="l35.302" class="difflineminus">-    mComposeBundle-&gt;GetStringFromName(&quot;filterMessageFailed&quot;, getter_Copies(msg));</span>
<a href="#l35.303"></a><span id="l35.303" class="difflineplus">+    mComposeBundle-&gt;GetStringFromName(&quot;filterMessageFailed&quot;, msg);</span>
<a href="#l35.304"></a><span id="l35.304"> </span>
<a href="#l35.305"></a><span id="l35.305">   SetStatusMessage(msg);</span>
<a href="#l35.306"></a><span id="l35.306"> </span>
<a href="#l35.307"></a><span id="l35.307">   if (NS_FAILED(aStatus))</span>
<a href="#l35.308"></a><span id="l35.308">   {</span>
<a href="#l35.309"></a><span id="l35.309" class="difflineminus">-    nsresult rv = mComposeBundle-&gt;GetStringFromName(&quot;errorFilteringMsg&quot;, getter_Copies(msg));</span>
<a href="#l35.310"></a><span id="l35.310" class="difflineplus">+    nsresult rv = mComposeBundle-&gt;GetStringFromName(&quot;errorFilteringMsg&quot;, msg);</span>
<a href="#l35.311"></a><span id="l35.311">     if (NS_SUCCEEDED(rv))</span>
<a href="#l35.312"></a><span id="l35.312">     {</span>
<a href="#l35.313"></a><span id="l35.313">       nsCOMPtr&lt;nsIPrompt&gt; prompt;</span>
<a href="#l35.314"></a><span id="l35.314">       GetDefaultPrompt(getter_AddRefs(prompt));</span>
<a href="#l35.315"></a><span id="l35.315">       nsMsgDisplayMessageByString(prompt, msg.get(), nullptr);</span>
<a href="#l35.316"></a><span id="l35.316">     }</span>
<a href="#l35.317"></a><span id="l35.317"> </span>
<a href="#l35.318"></a><span id="l35.318">     // We failed, however, give Fail a success code so that it doesn't prompt</span>
<a href="#l35.319"></a><span id="l35.319" class="difflineat">@@ -4476,18 +4470,17 @@ nsMsgComposeAndSend::MimeDoFCC(nsIFile  </span>
<a href="#l35.320"></a><span id="l35.320">   {</span>
<a href="#l35.321"></a><span id="l35.321">     GetFolderURIFromUserPrefs(mode, mUserIdentity, tmpUri);</span>
<a href="#l35.322"></a><span id="l35.322">   }</span>
<a href="#l35.323"></a><span id="l35.323">   status = MessageFolderIsLocal(mUserIdentity, mode, tmpUri.get(), &amp;folderIsLocal);</span>
<a href="#l35.324"></a><span id="l35.324">   if (NS_FAILED(status))</span>
<a href="#l35.325"></a><span id="l35.325">     goto FAIL;</span>
<a href="#l35.326"></a><span id="l35.326"> </span>
<a href="#l35.327"></a><span id="l35.327">   // Tell the user we are copying the message...</span>
<a href="#l35.328"></a><span id="l35.328" class="difflineminus">-  mComposeBundle-&gt;GetStringFromName(&quot;copyMessageStart&quot;,</span>
<a href="#l35.329"></a><span id="l35.329" class="difflineminus">-                                    getter_Copies(msg));</span>
<a href="#l35.330"></a><span id="l35.330" class="difflineplus">+  mComposeBundle-&gt;GetStringFromName(&quot;copyMessageStart&quot;, msg);</span>
<a href="#l35.331"></a><span id="l35.331">   if (!msg.IsEmpty())</span>
<a href="#l35.332"></a><span id="l35.332">   {</span>
<a href="#l35.333"></a><span id="l35.333">     nsCOMPtr&lt;nsIRDFService&gt; rdfService = do_GetService(kRDFServiceCID);</span>
<a href="#l35.334"></a><span id="l35.334">     if (rdfService)</span>
<a href="#l35.335"></a><span id="l35.335">     {</span>
<a href="#l35.336"></a><span id="l35.336">       nsCOMPtr&lt;nsIRDFResource&gt; res;</span>
<a href="#l35.337"></a><span id="l35.337">       rdfService-&gt;GetResource(tmpUri, getter_AddRefs(res));</span>
<a href="#l35.338"></a><span id="l35.338">       nsCOMPtr&lt;nsIMsgFolder&gt; folder = do_QueryInterface(res);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgSend.h</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgSend.h</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -184,17 +184,17 @@ public:</span>
<a href="#l36.4"></a><span id="l36.4">   nsMsgComposeAndSend();</span>
<a href="#l36.5"></a><span id="l36.5"> </span>
<a href="#l36.6"></a><span id="l36.6"> </span>
<a href="#l36.7"></a><span id="l36.7">   // Delivery and completion callback routines...</span>
<a href="#l36.8"></a><span id="l36.8">   NS_IMETHOD  DeliverMessage();</span>
<a href="#l36.9"></a><span id="l36.9">   NS_IMETHOD  DeliverFileAsMail();</span>
<a href="#l36.10"></a><span id="l36.10">   NS_IMETHOD  DeliverFileAsNews();</span>
<a href="#l36.11"></a><span id="l36.11">   void        DoDeliveryExitProcessing(nsIURI * aUrl, nsresult aExitCode, bool aCheckForMail);</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-  nsresult    FormatStringWithSMTPHostNameByName(const char* aMsgName, char16_t **aString);</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineplus">+  nsresult    FormatStringWithSMTPHostNameByName(const char* aMsgName, nsAString&amp; aString);</span>
<a href="#l36.14"></a><span id="l36.14"> </span>
<a href="#l36.15"></a><span id="l36.15">   nsresult    DoFcc();</span>
<a href="#l36.16"></a><span id="l36.16">   nsresult    StartMessageCopyOperation(nsIFile          *aFileSpec,</span>
<a href="#l36.17"></a><span id="l36.17">                                         nsMsgDeliverMode mode,</span>
<a href="#l36.18"></a><span id="l36.18">                                         const nsCString&amp; dest_uri);</span>
<a href="#l36.19"></a><span id="l36.19"> </span>
<a href="#l36.20"></a><span id="l36.20"> </span>
<a href="#l36.21"></a><span id="l36.21">   nsresult SendToMagicFolder(nsMsgDeliverMode flag);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/mailnews/compose/src/nsMsgSendReport.cpp</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/mailnews/compose/src/nsMsgSendReport.cpp</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -305,18 +305,17 @@ NS_IMETHODIMP nsMsgSendReport::DisplayRe</span>
<a href="#l37.4"></a><span id="l37.4">     // SMTP is taking care of it's own error message and will return NS_ERROR_BUT_DONT_SHOW_ALERT as error code.</span>
<a href="#l37.5"></a><span id="l37.5">     // In that case, we must not show an alert ourself.</span>
<a href="#l37.6"></a><span id="l37.6">     if (currError == NS_ERROR_BUT_DONT_SHOW_ALERT)</span>
<a href="#l37.7"></a><span id="l37.7">     {</span>
<a href="#l37.8"></a><span id="l37.8">       mAlreadyDisplayReport = true;</span>
<a href="#l37.9"></a><span id="l37.9">       return NS_OK;</span>
<a href="#l37.10"></a><span id="l37.10">     }</span>
<a href="#l37.11"></a><span id="l37.11"> </span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;sendMessageErrorTitle&quot;,</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineminus">-                              getter_Copies(dialogTitle));</span>
<a href="#l37.14"></a><span id="l37.14" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;sendMessageErrorTitle&quot;, dialogTitle);</span>
<a href="#l37.15"></a><span id="l37.15"> </span>
<a href="#l37.16"></a><span id="l37.16">     const char* preStrName = &quot;sendFailed&quot;;</span>
<a href="#l37.17"></a><span id="l37.17">     bool askToGoBackToCompose = false;</span>
<a href="#l37.18"></a><span id="l37.18">     switch (mCurrentProcess)</span>
<a href="#l37.19"></a><span id="l37.19">     {</span>
<a href="#l37.20"></a><span id="l37.20">       case process_BuildMessage :</span>
<a href="#l37.21"></a><span id="l37.21">         preStrName = &quot;sendFailed&quot;;</span>
<a href="#l37.22"></a><span id="l37.22">         askToGoBackToCompose = false;</span>
<a href="#l37.23"></a><span id="l37.23" class="difflineat">@@ -338,24 +337,23 @@ NS_IMETHODIMP nsMsgSendReport::DisplayRe</span>
<a href="#l37.24"></a><span id="l37.24">         preStrName = &quot;failedCopyOperation&quot;;</span>
<a href="#l37.25"></a><span id="l37.25">         askToGoBackToCompose = (mDeliveryMode == nsIMsgCompDeliverMode::Now);</span>
<a href="#l37.26"></a><span id="l37.26">         break;</span>
<a href="#l37.27"></a><span id="l37.27">       case process_FCC:</span>
<a href="#l37.28"></a><span id="l37.28">         preStrName = &quot;failedCopyOperation&quot;;</span>
<a href="#l37.29"></a><span id="l37.29">         askToGoBackToCompose = (mDeliveryMode == nsIMsgCompDeliverMode::Now);</span>
<a href="#l37.30"></a><span id="l37.30">         break;</span>
<a href="#l37.31"></a><span id="l37.31">     }</span>
<a href="#l37.32"></a><span id="l37.32" class="difflineminus">-    bundle-&gt;GetStringFromName(preStrName, getter_Copies(dialogMessage));</span>
<a href="#l37.33"></a><span id="l37.33" class="difflineplus">+    bundle-&gt;GetStringFromName(preStrName, dialogMessage);</span>
<a href="#l37.34"></a><span id="l37.34"> </span>
<a href="#l37.35"></a><span id="l37.35">     //Do we already have an error message?</span>
<a href="#l37.36"></a><span id="l37.36">     if (!askToGoBackToCompose &amp;&amp; currMessage.IsEmpty())</span>
<a href="#l37.37"></a><span id="l37.37">     {</span>
<a href="#l37.38"></a><span id="l37.38">       //we don't have an error description but we can put a generic explanation</span>
<a href="#l37.39"></a><span id="l37.39" class="difflineminus">-      bundle-&gt;GetStringFromName(&quot;genericFailureExplanation&quot;,</span>
<a href="#l37.40"></a><span id="l37.40" class="difflineminus">-                                getter_Copies(currMessage));</span>
<a href="#l37.41"></a><span id="l37.41" class="difflineplus">+      bundle-&gt;GetStringFromName(&quot;genericFailureExplanation&quot;, currMessage);</span>
<a href="#l37.42"></a><span id="l37.42">     }</span>
<a href="#l37.43"></a><span id="l37.43"> </span>
<a href="#l37.44"></a><span id="l37.44">     if (!currMessage.IsEmpty())</span>
<a href="#l37.45"></a><span id="l37.45">     {</span>
<a href="#l37.46"></a><span id="l37.46">       //Don't need to repeat ourself!</span>
<a href="#l37.47"></a><span id="l37.47">       if (!currMessage.Equals(dialogMessage))</span>
<a href="#l37.48"></a><span id="l37.48">       {</span>
<a href="#l37.49"></a><span id="l37.49">         if (!dialogMessage.IsEmpty())</span>
<a href="#l37.50"></a><span id="l37.50" class="difflineat">@@ -363,18 +361,17 @@ NS_IMETHODIMP nsMsgSendReport::DisplayRe</span>
<a href="#l37.51"></a><span id="l37.51">         dialogMessage.Append(currMessage);</span>
<a href="#l37.52"></a><span id="l37.52">       }</span>
<a href="#l37.53"></a><span id="l37.53">     }</span>
<a href="#l37.54"></a><span id="l37.54"> </span>
<a href="#l37.55"></a><span id="l37.55">     if (askToGoBackToCompose)</span>
<a href="#l37.56"></a><span id="l37.56">     {</span>
<a href="#l37.57"></a><span id="l37.57">       bool oopsGiveMeBackTheComposeWindow = true;</span>
<a href="#l37.58"></a><span id="l37.58">       nsString text1;</span>
<a href="#l37.59"></a><span id="l37.59" class="difflineminus">-      bundle-&gt;GetStringFromName(&quot;returnToComposeWindowQuestion&quot;,</span>
<a href="#l37.60"></a><span id="l37.60" class="difflineminus">-                                getter_Copies(text1));</span>
<a href="#l37.61"></a><span id="l37.61" class="difflineplus">+      bundle-&gt;GetStringFromName(&quot;returnToComposeWindowQuestion&quot;, text1);</span>
<a href="#l37.62"></a><span id="l37.62">       if (!dialogMessage.IsEmpty())</span>
<a href="#l37.63"></a><span id="l37.63">         dialogMessage.AppendLiteral(&quot;\n&quot;);</span>
<a href="#l37.64"></a><span id="l37.64">       dialogMessage.Append(text1);</span>
<a href="#l37.65"></a><span id="l37.65">       nsMsgAskBooleanQuestionByString(prompt, dialogMessage.get(), &amp;oopsGiveMeBackTheComposeWindow, dialogTitle.get());</span>
<a href="#l37.66"></a><span id="l37.66">       if (!oopsGiveMeBackTheComposeWindow)</span>
<a href="#l37.67"></a><span id="l37.67">         *_retval = NS_OK;</span>
<a href="#l37.68"></a><span id="l37.68">     }</span>
<a href="#l37.69"></a><span id="l37.69">     else</span>
<a href="#l37.70"></a><span id="l37.70" class="difflineat">@@ -405,26 +402,24 @@ NS_IMETHODIMP nsMsgSendReport::DisplayRe</span>
<a href="#l37.71"></a><span id="l37.71"> </span>
<a href="#l37.72"></a><span id="l37.72">       default:</span>
<a href="#l37.73"></a><span id="l37.73">         /* This should never happen! */</span>
<a href="#l37.74"></a><span id="l37.74">         title = &quot;sendMessageErrorTitle&quot;;</span>
<a href="#l37.75"></a><span id="l37.75">         messageName = &quot;sendFailed&quot;;</span>
<a href="#l37.76"></a><span id="l37.76">         break;</span>
<a href="#l37.77"></a><span id="l37.77">     }</span>
<a href="#l37.78"></a><span id="l37.78"> </span>
<a href="#l37.79"></a><span id="l37.79" class="difflineminus">-    bundle-&gt;GetStringFromName(title, getter_Copies(dialogTitle));</span>
<a href="#l37.80"></a><span id="l37.80" class="difflineminus">-    bundle-&gt;GetStringFromName(messageName,</span>
<a href="#l37.81"></a><span id="l37.81" class="difflineminus">-                              getter_Copies(dialogMessage));</span>
<a href="#l37.82"></a><span id="l37.82" class="difflineplus">+    bundle-&gt;GetStringFromName(title, dialogTitle);</span>
<a href="#l37.83"></a><span id="l37.83" class="difflineplus">+    bundle-&gt;GetStringFromName(messageName, dialogMessage);</span>
<a href="#l37.84"></a><span id="l37.84"> </span>
<a href="#l37.85"></a><span id="l37.85">     //Do we have an error message...</span>
<a href="#l37.86"></a><span id="l37.86">     if (currMessage.IsEmpty())</span>
<a href="#l37.87"></a><span id="l37.87">     {</span>
<a href="#l37.88"></a><span id="l37.88">       //we don't have an error description but we can put a generic explanation</span>
<a href="#l37.89"></a><span id="l37.89" class="difflineminus">-      bundle-&gt;GetStringFromName(&quot;genericFailureExplanation&quot;,</span>
<a href="#l37.90"></a><span id="l37.90" class="difflineminus">-                                getter_Copies(currMessage));</span>
<a href="#l37.91"></a><span id="l37.91" class="difflineplus">+      bundle-&gt;GetStringFromName(&quot;genericFailureExplanation&quot;, currMessage);</span>
<a href="#l37.92"></a><span id="l37.92">     }</span>
<a href="#l37.93"></a><span id="l37.93"> </span>
<a href="#l37.94"></a><span id="l37.94">     if (!currMessage.IsEmpty())</span>
<a href="#l37.95"></a><span id="l37.95">     {</span>
<a href="#l37.96"></a><span id="l37.96">       if (!dialogMessage.IsEmpty())</span>
<a href="#l37.97"></a><span id="l37.97">         dialogMessage.Append(char16_t('\n'));</span>
<a href="#l37.98"></a><span id="l37.98">       dialogMessage.Append(currMessage);</span>
<a href="#l37.99"></a><span id="l37.99">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/mailnews/compose/src/nsSmtpProtocol.cpp</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/mailnews/compose/src/nsSmtpProtocol.cpp</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -98,37 +98,36 @@ nsresult nsExplainErrorDetails(nsISmtpUr</span>
<a href="#l38.4"></a><span id="l38.4"> #ifdef __GNUC__</span>
<a href="#l38.5"></a><span id="l38.5"> // Temporary workaroung until bug 783526 is fixed.</span>
<a href="#l38.6"></a><span id="l38.6"> #pragma GCC diagnostic push</span>
<a href="#l38.7"></a><span id="l38.7"> #pragma GCC diagnostic ignored &quot;-Wswitch&quot;</span>
<a href="#l38.8"></a><span id="l38.8"> #endif</span>
<a href="#l38.9"></a><span id="l38.9">   switch (aCode)</span>
<a href="#l38.10"></a><span id="l38.10">   {</span>
<a href="#l38.11"></a><span id="l38.11">     case NS_ERROR_ILLEGAL_LOCALPART:</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-      bundle-&gt;GetStringFromName(&quot;errorIllegalLocalPart&quot;,</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineminus">-                                getter_Copies(eMsg));</span>
<a href="#l38.14"></a><span id="l38.14" class="difflineplus">+      bundle-&gt;GetStringFromName(&quot;errorIllegalLocalPart&quot;, eMsg);</span>
<a href="#l38.15"></a><span id="l38.15">       msg = nsTextFormatter::vsmprintf(eMsg.get(), args);</span>
<a href="#l38.16"></a><span id="l38.16">       break;</span>
<a href="#l38.17"></a><span id="l38.17">     case NS_ERROR_SMTP_SERVER_ERROR:</span>
<a href="#l38.18"></a><span id="l38.18">     case NS_ERROR_TCP_READ_ERROR:</span>
<a href="#l38.19"></a><span id="l38.19">     case NS_ERROR_SMTP_TEMP_SIZE_EXCEEDED:</span>
<a href="#l38.20"></a><span id="l38.20">     case NS_ERROR_SMTP_PERM_SIZE_EXCEEDED_1:</span>
<a href="#l38.21"></a><span id="l38.21">     case NS_ERROR_SMTP_PERM_SIZE_EXCEEDED_2:</span>
<a href="#l38.22"></a><span id="l38.22">     case NS_ERROR_SENDING_FROM_COMMAND:</span>
<a href="#l38.23"></a><span id="l38.23">     case NS_ERROR_SENDING_RCPT_COMMAND:</span>
<a href="#l38.24"></a><span id="l38.24">     case NS_ERROR_SENDING_DATA_COMMAND:</span>
<a href="#l38.25"></a><span id="l38.25">     case NS_ERROR_SENDING_MESSAGE:</span>
<a href="#l38.26"></a><span id="l38.26">     case NS_ERROR_SMTP_GREETING:</span>
<a href="#l38.27"></a><span id="l38.27">       exitString = errorStringNameForErrorCode(aCode);</span>
<a href="#l38.28"></a><span id="l38.28" class="difflineminus">-      bundle-&gt;GetStringFromName(exitString, getter_Copies(eMsg));</span>
<a href="#l38.29"></a><span id="l38.29" class="difflineplus">+      bundle-&gt;GetStringFromName(exitString, eMsg);</span>
<a href="#l38.30"></a><span id="l38.30">       msg = nsTextFormatter::vsmprintf(eMsg.get(), args);</span>
<a href="#l38.31"></a><span id="l38.31">       break;</span>
<a href="#l38.32"></a><span id="l38.32">     default:</span>
<a href="#l38.33"></a><span id="l38.33">       NS_WARNING(&quot;falling to default error code&quot;);</span>
<a href="#l38.34"></a><span id="l38.34" class="difflineminus">-      bundle-&gt;GetStringFromName(&quot;communicationsError&quot;, getter_Copies(eMsg));</span>
<a href="#l38.35"></a><span id="l38.35" class="difflineplus">+      bundle-&gt;GetStringFromName(&quot;communicationsError&quot;, eMsg);</span>
<a href="#l38.36"></a><span id="l38.36">       msg = nsTextFormatter::smprintf(eMsg.get(), aCode);</span>
<a href="#l38.37"></a><span id="l38.37">       break;</span>
<a href="#l38.38"></a><span id="l38.38">   }</span>
<a href="#l38.39"></a><span id="l38.39"> #ifdef __GNUC__</span>
<a href="#l38.40"></a><span id="l38.40"> #pragma GCC diagnostic pop</span>
<a href="#l38.41"></a><span id="l38.41"> #endif</span>
<a href="#l38.42"></a><span id="l38.42"> </span>
<a href="#l38.43"></a><span id="l38.43">   if (msg)</span>
<a href="#l38.44"></a><span id="l38.44" class="difflineat">@@ -578,17 +577,17 @@ void nsSmtpProtocol::UpdateStatus(const </span>
<a href="#l38.45"></a><span id="l38.45">   {</span>
<a href="#l38.46"></a><span id="l38.46">     nsCOMPtr&lt;nsIStringBundleService&gt; bundleService =</span>
<a href="#l38.47"></a><span id="l38.47">       mozilla::services::GetStringBundleService();</span>
<a href="#l38.48"></a><span id="l38.48">     if (!bundleService) return;</span>
<a href="#l38.49"></a><span id="l38.49">     nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l38.50"></a><span id="l38.50">     nsresult rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l38.51"></a><span id="l38.51">     if (NS_FAILED(rv)) return;</span>
<a href="#l38.52"></a><span id="l38.52">     nsString msg;</span>
<a href="#l38.53"></a><span id="l38.53" class="difflineminus">-    bundle-&gt;GetStringFromName(aStatusName, getter_Copies(msg));</span>
<a href="#l38.54"></a><span id="l38.54" class="difflineplus">+    bundle-&gt;GetStringFromName(aStatusName, msg);</span>
<a href="#l38.55"></a><span id="l38.55">     UpdateStatusWithString(msg.get());</span>
<a href="#l38.56"></a><span id="l38.56">   }</span>
<a href="#l38.57"></a><span id="l38.57"> }</span>
<a href="#l38.58"></a><span id="l38.58"> </span>
<a href="#l38.59"></a><span id="l38.59"> void nsSmtpProtocol::UpdateStatusWithString(const char16_t * aStatusString)</span>
<a href="#l38.60"></a><span id="l38.60"> {</span>
<a href="#l38.61"></a><span id="l38.61">   if (m_statusFeedback &amp;&amp; aStatusString)</span>
<a href="#l38.62"></a><span id="l38.62">     m_statusFeedback-&gt;ShowStatusString(nsDependentString(aStatusString));</span>
<a href="#l38.63"></a><span id="l38.63" class="difflineat">@@ -2215,31 +2214,31 @@ nsSmtpProtocol::PromptForPassword(nsISmt</span>
<a href="#l38.64"></a><span id="l38.64">   nsCOMPtr&lt;nsIStringBundle&gt; composeStringBundle;</span>
<a href="#l38.65"></a><span id="l38.65">   nsresult rv = stringService-&gt;CreateBundle(&quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;, getter_AddRefs(composeStringBundle));</span>
<a href="#l38.66"></a><span id="l38.66">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l38.67"></a><span id="l38.67"> </span>
<a href="#l38.68"></a><span id="l38.68">   nsString passwordPromptString;</span>
<a href="#l38.69"></a><span id="l38.69">   if(formatStrings[1])</span>
<a href="#l38.70"></a><span id="l38.70">     rv = composeStringBundle-&gt;FormatStringFromName(</span>
<a href="#l38.71"></a><span id="l38.71">       &quot;smtpEnterPasswordPromptWithUsername&quot;,</span>
<a href="#l38.72"></a><span id="l38.72" class="difflineminus">-      formatStrings, 2, getter_Copies(passwordPromptString));</span>
<a href="#l38.73"></a><span id="l38.73" class="difflineplus">+      formatStrings, 2, passwordPromptString);</span>
<a href="#l38.74"></a><span id="l38.74">   else</span>
<a href="#l38.75"></a><span id="l38.75">     rv = composeStringBundle-&gt;FormatStringFromName(</span>
<a href="#l38.76"></a><span id="l38.76">       &quot;smtpEnterPasswordPrompt&quot;,</span>
<a href="#l38.77"></a><span id="l38.77" class="difflineminus">-      formatStrings, 1, getter_Copies(passwordPromptString));</span>
<a href="#l38.78"></a><span id="l38.78" class="difflineplus">+      formatStrings, 1, passwordPromptString);</span>
<a href="#l38.79"></a><span id="l38.79">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l38.80"></a><span id="l38.80"> </span>
<a href="#l38.81"></a><span id="l38.81">   nsCOMPtr&lt;nsIAuthPrompt&gt; netPrompt;</span>
<a href="#l38.82"></a><span id="l38.82">   rv = aSmtpUrl-&gt;GetAuthPrompt(getter_AddRefs(netPrompt));</span>
<a href="#l38.83"></a><span id="l38.83">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l38.84"></a><span id="l38.84"> </span>
<a href="#l38.85"></a><span id="l38.85">   nsString passwordTitle;</span>
<a href="#l38.86"></a><span id="l38.86">   rv = composeStringBundle-&gt;GetStringFromName(</span>
<a href="#l38.87"></a><span id="l38.87">     &quot;smtpEnterPasswordPromptTitle&quot;,</span>
<a href="#l38.88"></a><span id="l38.88" class="difflineminus">-    getter_Copies(passwordTitle));</span>
<a href="#l38.89"></a><span id="l38.89" class="difflineplus">+    passwordTitle);</span>
<a href="#l38.90"></a><span id="l38.90">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l38.91"></a><span id="l38.91"> </span>
<a href="#l38.92"></a><span id="l38.92">   rv = aSmtpServer-&gt;GetPasswordWithUI(passwordPromptString.get(), passwordTitle.get(),</span>
<a href="#l38.93"></a><span id="l38.93">     netPrompt, aPassword);</span>
<a href="#l38.94"></a><span id="l38.94">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l38.95"></a><span id="l38.95">   return rv;</span>
<a href="#l38.96"></a><span id="l38.96"> }</span>
<a href="#l38.97"></a><span id="l38.97"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/mailnews/extensions/mailviews/src/nsMsgMailViewList.cpp</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -68,28 +68,35 @@ NS_IMETHODIMP nsMsgMailView::GetPrettyNa</span>
<a href="#l39.4"></a><span id="l39.4">         bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/mailviews.properties&quot;,</span>
<a href="#l39.5"></a><span id="l39.5">                                     getter_AddRefs(mBundle));</span>
<a href="#l39.6"></a><span id="l39.6">     }</span>
<a href="#l39.7"></a><span id="l39.7"> </span>
<a href="#l39.8"></a><span id="l39.8">     NS_ENSURE_TRUE(mBundle, NS_ERROR_FAILURE);</span>
<a href="#l39.9"></a><span id="l39.9"> </span>
<a href="#l39.10"></a><span id="l39.10">     // see if mName has an associated pretty name inside our string bundle and if so, use that as the pretty name</span>
<a href="#l39.11"></a><span id="l39.11">     // otherwise just return mName</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-    if (mName.EqualsLiteral(kDefaultViewPeopleIKnow))</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineminus">-        rv = mBundle-&gt;GetStringFromName(&quot;mailViewPeopleIKnow&quot;, aMailViewName);</span>
<a href="#l39.14"></a><span id="l39.14" class="difflineminus">-    else if (mName.EqualsLiteral(kDefaultViewRecent))</span>
<a href="#l39.15"></a><span id="l39.15" class="difflineminus">-        rv = mBundle-&gt;GetStringFromName(&quot;mailViewRecentMail&quot;, aMailViewName);</span>
<a href="#l39.16"></a><span id="l39.16" class="difflineminus">-    else if (mName.EqualsLiteral(kDefaultViewFiveDays))</span>
<a href="#l39.17"></a><span id="l39.17" class="difflineminus">-        rv = mBundle-&gt;GetStringFromName(&quot;mailViewLastFiveDays&quot;, aMailViewName);</span>
<a href="#l39.18"></a><span id="l39.18" class="difflineminus">-    else if (mName.EqualsLiteral(kDefaultViewNotJunk))</span>
<a href="#l39.19"></a><span id="l39.19" class="difflineminus">-        rv = mBundle-&gt;GetStringFromName(&quot;mailViewNotJunk&quot;, aMailViewName);</span>
<a href="#l39.20"></a><span id="l39.20" class="difflineminus">-    else if (mName.EqualsLiteral(kDefaultViewHasAttachments))</span>
<a href="#l39.21"></a><span id="l39.21" class="difflineminus">-        rv = mBundle-&gt;GetStringFromName(&quot;mailViewHasAttachments&quot;, aMailViewName);</span>
<a href="#l39.22"></a><span id="l39.22" class="difflineminus">-    else</span>
<a href="#l39.23"></a><span id="l39.23" class="difflineplus">+    nsAutoString mailViewName;</span>
<a href="#l39.24"></a><span id="l39.24" class="difflineplus">+    if (mName.EqualsLiteral(kDefaultViewPeopleIKnow)) {</span>
<a href="#l39.25"></a><span id="l39.25" class="difflineplus">+        rv = mBundle-&gt;GetStringFromName(&quot;mailViewPeopleIKnow&quot;, mailViewName);</span>
<a href="#l39.26"></a><span id="l39.26" class="difflineplus">+        *aMailViewName = ToNewUnicode(mailViewName);</span>
<a href="#l39.27"></a><span id="l39.27" class="difflineplus">+    } else if (mName.EqualsLiteral(kDefaultViewRecent)) {</span>
<a href="#l39.28"></a><span id="l39.28" class="difflineplus">+        rv = mBundle-&gt;GetStringFromName(&quot;mailViewRecentMail&quot;, mailViewName);</span>
<a href="#l39.29"></a><span id="l39.29" class="difflineplus">+        *aMailViewName = ToNewUnicode(mailViewName);</span>
<a href="#l39.30"></a><span id="l39.30" class="difflineplus">+    } else if (mName.EqualsLiteral(kDefaultViewFiveDays)) {</span>
<a href="#l39.31"></a><span id="l39.31" class="difflineplus">+        rv = mBundle-&gt;GetStringFromName(&quot;mailViewLastFiveDays&quot;, mailViewName);</span>
<a href="#l39.32"></a><span id="l39.32" class="difflineplus">+        *aMailViewName = ToNewUnicode(mailViewName);</span>
<a href="#l39.33"></a><span id="l39.33" class="difflineplus">+    } else if (mName.EqualsLiteral(kDefaultViewNotJunk)) {</span>
<a href="#l39.34"></a><span id="l39.34" class="difflineplus">+        rv = mBundle-&gt;GetStringFromName(&quot;mailViewNotJunk&quot;, mailViewName);</span>
<a href="#l39.35"></a><span id="l39.35" class="difflineplus">+        *aMailViewName = ToNewUnicode(mailViewName);</span>
<a href="#l39.36"></a><span id="l39.36" class="difflineplus">+    } else if (mName.EqualsLiteral(kDefaultViewHasAttachments)) {</span>
<a href="#l39.37"></a><span id="l39.37" class="difflineplus">+        rv = mBundle-&gt;GetStringFromName(&quot;mailViewHasAttachments&quot;, mailViewName);</span>
<a href="#l39.38"></a><span id="l39.38" class="difflineplus">+        *aMailViewName = ToNewUnicode(mailViewName);</span>
<a href="#l39.39"></a><span id="l39.39" class="difflineplus">+    } else {</span>
<a href="#l39.40"></a><span id="l39.40">         *aMailViewName = ToNewUnicode(mName);</span>
<a href="#l39.41"></a><span id="l39.41" class="difflineplus">+    }</span>
<a href="#l39.42"></a><span id="l39.42"> </span>
<a href="#l39.43"></a><span id="l39.43">     return rv;</span>
<a href="#l39.44"></a><span id="l39.44"> }</span>
<a href="#l39.45"></a><span id="l39.45"> </span>
<a href="#l39.46"></a><span id="l39.46"> NS_IMETHODIMP nsMsgMailView::GetSearchTerms(nsIMutableArray **aSearchTerms)</span>
<a href="#l39.47"></a><span id="l39.47"> {</span>
<a href="#l39.48"></a><span id="l39.48">     NS_ENSURE_ARG_POINTER(aSearchTerms);</span>
<a href="#l39.49"></a><span id="l39.49">     NS_IF_ADDREF(*aSearchTerms = mViewSearchTerms);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/mailnews/extensions/mdn/src/nsMsgMdnGenerator.cpp</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -96,17 +96,17 @@ nsMsgMdnGenerator::nsMsgMdnGenerator()</span>
<a href="#l40.4"></a><span id="l40.4"> }</span>
<a href="#l40.5"></a><span id="l40.5"> </span>
<a href="#l40.6"></a><span id="l40.6"> nsMsgMdnGenerator::~nsMsgMdnGenerator()</span>
<a href="#l40.7"></a><span id="l40.7"> {</span>
<a href="#l40.8"></a><span id="l40.8"> }</span>
<a href="#l40.9"></a><span id="l40.9"> </span>
<a href="#l40.10"></a><span id="l40.10"> nsresult nsMsgMdnGenerator::FormatStringFromName(const char *aName,</span>
<a href="#l40.11"></a><span id="l40.11">                                                  const char16_t *aString,</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-                                                 char16_t **aResultString)</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+                                                 nsAString&amp; aResultString)</span>
<a href="#l40.14"></a><span id="l40.14"> {</span>
<a href="#l40.15"></a><span id="l40.15">     DEBUG_MDN(&quot;nsMsgMdnGenerator::FormatStringFromName&quot;);</span>
<a href="#l40.16"></a><span id="l40.16"> </span>
<a href="#l40.17"></a><span id="l40.17">     nsCOMPtr&lt;nsIStringBundleService&gt; bundleService =</span>
<a href="#l40.18"></a><span id="l40.18">       mozilla::services::GetStringBundleService();</span>
<a href="#l40.19"></a><span id="l40.19">     NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l40.20"></a><span id="l40.20"> </span>
<a href="#l40.21"></a><span id="l40.21">     nsCOMPtr &lt;nsIStringBundle&gt; bundle;</span>
<a href="#l40.22"></a><span id="l40.22" class="difflineat">@@ -117,17 +117,17 @@ nsresult nsMsgMdnGenerator::FormatString</span>
<a href="#l40.23"></a><span id="l40.23">     const char16_t *formatStrings[1] = { aString };</span>
<a href="#l40.24"></a><span id="l40.24">     rv = bundle-&gt;FormatStringFromName(aName,</span>
<a href="#l40.25"></a><span id="l40.25">                     formatStrings, 1, aResultString);</span>
<a href="#l40.26"></a><span id="l40.26">     NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l40.27"></a><span id="l40.27">     return rv;</span>
<a href="#l40.28"></a><span id="l40.28"> }</span>
<a href="#l40.29"></a><span id="l40.29"> </span>
<a href="#l40.30"></a><span id="l40.30"> nsresult nsMsgMdnGenerator::GetStringFromName(const char *aName,</span>
<a href="#l40.31"></a><span id="l40.31" class="difflineminus">-                                               char16_t **aResultString)</span>
<a href="#l40.32"></a><span id="l40.32" class="difflineplus">+                                              nsAString&amp; aResultString)</span>
<a href="#l40.33"></a><span id="l40.33"> {</span>
<a href="#l40.34"></a><span id="l40.34">     DEBUG_MDN(&quot;nsMsgMdnGenerator::GetStringFromName&quot;);</span>
<a href="#l40.35"></a><span id="l40.35"> </span>
<a href="#l40.36"></a><span id="l40.36">     nsCOMPtr&lt;nsIStringBundleService&gt; bundleService =</span>
<a href="#l40.37"></a><span id="l40.37">       mozilla::services::GetStringBundleService();</span>
<a href="#l40.38"></a><span id="l40.38">     NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l40.39"></a><span id="l40.39"> </span>
<a href="#l40.40"></a><span id="l40.40">     nsCOMPtr &lt;nsIStringBundle&gt; bundle;</span>
<a href="#l40.41"></a><span id="l40.41" class="difflineat">@@ -468,17 +468,17 @@ nsresult nsMsgMdnGenerator::CreateFirstP</span>
<a href="#l40.42"></a><span id="l40.42">     MakeMimeAddress(NS_ConvertUTF16toUTF8(fullName), m_email, fullAddress);</span>
<a href="#l40.43"></a><span id="l40.43"> </span>
<a href="#l40.44"></a><span id="l40.44">     convbuf = nsMsgI18NEncodeMimePartIIStr(fullAddress.get(),</span>
<a href="#l40.45"></a><span id="l40.45">         true, m_charset.get(), 0, conformToStandard);</span>
<a href="#l40.46"></a><span id="l40.46"> </span>
<a href="#l40.47"></a><span id="l40.47">     parm = PR_smprintf(&quot;From: %s&quot; CRLF, convbuf ? convbuf : m_email.get());</span>
<a href="#l40.48"></a><span id="l40.48"> </span>
<a href="#l40.49"></a><span id="l40.49">     rv = FormatStringFromName(&quot;MsgMdnMsgSentTo&quot;, NS_ConvertASCIItoUTF16(m_email).get(),</span>
<a href="#l40.50"></a><span id="l40.50" class="difflineminus">-                            getter_Copies(firstPart1));</span>
<a href="#l40.51"></a><span id="l40.51" class="difflineplus">+                            firstPart1);</span>
<a href="#l40.52"></a><span id="l40.52">     if (NS_FAILED(rv))</span>
<a href="#l40.53"></a><span id="l40.53">         return rv;</span>
<a href="#l40.54"></a><span id="l40.54"> </span>
<a href="#l40.55"></a><span id="l40.55">     PUSH_N_FREE_STRING (parm);</span>
<a href="#l40.56"></a><span id="l40.56"> </span>
<a href="#l40.57"></a><span id="l40.57">     PR_Free(convbuf);</span>
<a href="#l40.58"></a><span id="l40.58"> </span>
<a href="#l40.59"></a><span id="l40.59">     if (compUtils)</span>
<a href="#l40.60"></a><span id="l40.60" class="difflineat">@@ -490,42 +490,42 @@ nsresult nsMsgMdnGenerator::CreateFirstP</span>
<a href="#l40.61"></a><span id="l40.61">     }</span>
<a href="#l40.62"></a><span id="l40.62"> </span>
<a href="#l40.63"></a><span id="l40.63">     nsString receipt_string;</span>
<a href="#l40.64"></a><span id="l40.64">     switch (m_disposeType)</span>
<a href="#l40.65"></a><span id="l40.65">     {</span>
<a href="#l40.66"></a><span id="l40.66">     case nsIMsgMdnGenerator::eDisplayed:</span>
<a href="#l40.67"></a><span id="l40.67">         rv = GetStringFromName(</span>
<a href="#l40.68"></a><span id="l40.68">             &quot;MdnDisplayedReceipt&quot;,</span>
<a href="#l40.69"></a><span id="l40.69" class="difflineminus">-            getter_Copies(receipt_string));</span>
<a href="#l40.70"></a><span id="l40.70" class="difflineplus">+            receipt_string);</span>
<a href="#l40.71"></a><span id="l40.71">         break;</span>
<a href="#l40.72"></a><span id="l40.72">     case nsIMsgMdnGenerator::eDispatched:</span>
<a href="#l40.73"></a><span id="l40.73">         rv = GetStringFromName(</span>
<a href="#l40.74"></a><span id="l40.74">             &quot;MdnDispatchedReceipt&quot;,</span>
<a href="#l40.75"></a><span id="l40.75" class="difflineminus">-            getter_Copies(receipt_string));</span>
<a href="#l40.76"></a><span id="l40.76" class="difflineplus">+            receipt_string);</span>
<a href="#l40.77"></a><span id="l40.77">         break;</span>
<a href="#l40.78"></a><span id="l40.78">     case nsIMsgMdnGenerator::eProcessed:</span>
<a href="#l40.79"></a><span id="l40.79">         rv = GetStringFromName(</span>
<a href="#l40.80"></a><span id="l40.80">             &quot;MdnProcessedReceipt&quot;,</span>
<a href="#l40.81"></a><span id="l40.81" class="difflineminus">-            getter_Copies(receipt_string));</span>
<a href="#l40.82"></a><span id="l40.82" class="difflineplus">+            receipt_string);</span>
<a href="#l40.83"></a><span id="l40.83">         break;</span>
<a href="#l40.84"></a><span id="l40.84">     case nsIMsgMdnGenerator::eDeleted:</span>
<a href="#l40.85"></a><span id="l40.85">         rv = GetStringFromName(</span>
<a href="#l40.86"></a><span id="l40.86">             &quot;MdnDeletedReceipt&quot;,</span>
<a href="#l40.87"></a><span id="l40.87" class="difflineminus">-            getter_Copies(receipt_string));</span>
<a href="#l40.88"></a><span id="l40.88" class="difflineplus">+            receipt_string);</span>
<a href="#l40.89"></a><span id="l40.89">         break;</span>
<a href="#l40.90"></a><span id="l40.90">     case nsIMsgMdnGenerator::eDenied:</span>
<a href="#l40.91"></a><span id="l40.91">         rv = GetStringFromName(</span>
<a href="#l40.92"></a><span id="l40.92">             &quot;MdnDeniedReceipt&quot;,</span>
<a href="#l40.93"></a><span id="l40.93" class="difflineminus">-            getter_Copies(receipt_string));</span>
<a href="#l40.94"></a><span id="l40.94" class="difflineplus">+            receipt_string);</span>
<a href="#l40.95"></a><span id="l40.95">         break;</span>
<a href="#l40.96"></a><span id="l40.96">     case nsIMsgMdnGenerator::eFailed:</span>
<a href="#l40.97"></a><span id="l40.97">         rv = GetStringFromName(</span>
<a href="#l40.98"></a><span id="l40.98">             &quot;MdnFailedReceipt&quot;,</span>
<a href="#l40.99"></a><span id="l40.99" class="difflineminus">-            getter_Copies(receipt_string));</span>
<a href="#l40.100"></a><span id="l40.100" class="difflineplus">+            receipt_string);</span>
<a href="#l40.101"></a><span id="l40.101">         break;</span>
<a href="#l40.102"></a><span id="l40.102">     default:</span>
<a href="#l40.103"></a><span id="l40.103">         rv = NS_ERROR_INVALID_ARG;</span>
<a href="#l40.104"></a><span id="l40.104">         break;</span>
<a href="#l40.105"></a><span id="l40.105">     }</span>
<a href="#l40.106"></a><span id="l40.106"> </span>
<a href="#l40.107"></a><span id="l40.107">     if (NS_FAILED(rv))</span>
<a href="#l40.108"></a><span id="l40.108">         return rv;</span>
<a href="#l40.109"></a><span id="l40.109" class="difflineat">@@ -591,42 +591,42 @@ report-type=disposition-notification;\r\</span>
<a href="#l40.110"></a><span id="l40.110">         PUSH_N_FREE_STRING(tmpBuffer);</span>
<a href="#l40.111"></a><span id="l40.111">     }</span>
<a href="#l40.112"></a><span id="l40.112"> </span>
<a href="#l40.113"></a><span id="l40.113">     switch (m_disposeType)</span>
<a href="#l40.114"></a><span id="l40.114">     {</span>
<a href="#l40.115"></a><span id="l40.115">     case nsIMsgMdnGenerator::eDisplayed:</span>
<a href="#l40.116"></a><span id="l40.116">         rv = GetStringFromName(</span>
<a href="#l40.117"></a><span id="l40.117">             &quot;MsgMdnDisplayed&quot;,</span>
<a href="#l40.118"></a><span id="l40.118" class="difflineminus">-            getter_Copies(firstPart2));</span>
<a href="#l40.119"></a><span id="l40.119" class="difflineplus">+            firstPart2);</span>
<a href="#l40.120"></a><span id="l40.120">         break;</span>
<a href="#l40.121"></a><span id="l40.121">     case nsIMsgMdnGenerator::eDispatched:</span>
<a href="#l40.122"></a><span id="l40.122">         rv = GetStringFromName(</span>
<a href="#l40.123"></a><span id="l40.123">             &quot;MsgMdnDispatched&quot;,</span>
<a href="#l40.124"></a><span id="l40.124" class="difflineminus">-            getter_Copies(firstPart2));</span>
<a href="#l40.125"></a><span id="l40.125" class="difflineplus">+            firstPart2);</span>
<a href="#l40.126"></a><span id="l40.126">         break;</span>
<a href="#l40.127"></a><span id="l40.127">     case nsIMsgMdnGenerator::eProcessed:</span>
<a href="#l40.128"></a><span id="l40.128">         rv = GetStringFromName(</span>
<a href="#l40.129"></a><span id="l40.129">             &quot;MsgMdnProcessed&quot;,</span>
<a href="#l40.130"></a><span id="l40.130" class="difflineminus">-            getter_Copies(firstPart2));</span>
<a href="#l40.131"></a><span id="l40.131" class="difflineplus">+            firstPart2);</span>
<a href="#l40.132"></a><span id="l40.132">         break;</span>
<a href="#l40.133"></a><span id="l40.133">     case nsIMsgMdnGenerator::eDeleted:</span>
<a href="#l40.134"></a><span id="l40.134">         rv = GetStringFromName(</span>
<a href="#l40.135"></a><span id="l40.135">             &quot;MsgMdnDeleted&quot;,</span>
<a href="#l40.136"></a><span id="l40.136" class="difflineminus">-            getter_Copies(firstPart2));</span>
<a href="#l40.137"></a><span id="l40.137" class="difflineplus">+            firstPart2);</span>
<a href="#l40.138"></a><span id="l40.138">         break;</span>
<a href="#l40.139"></a><span id="l40.139">     case nsIMsgMdnGenerator::eDenied:</span>
<a href="#l40.140"></a><span id="l40.140">         rv = GetStringFromName(</span>
<a href="#l40.141"></a><span id="l40.141">             &quot;MsgMdnDenied&quot;,</span>
<a href="#l40.142"></a><span id="l40.142" class="difflineminus">-            getter_Copies(firstPart2));</span>
<a href="#l40.143"></a><span id="l40.143" class="difflineplus">+            firstPart2);</span>
<a href="#l40.144"></a><span id="l40.144">         break;</span>
<a href="#l40.145"></a><span id="l40.145">     case nsIMsgMdnGenerator::eFailed:</span>
<a href="#l40.146"></a><span id="l40.146">         rv = GetStringFromName(</span>
<a href="#l40.147"></a><span id="l40.147">             &quot;MsgMdnFailed&quot;,</span>
<a href="#l40.148"></a><span id="l40.148" class="difflineminus">-            getter_Copies(firstPart2));</span>
<a href="#l40.149"></a><span id="l40.149" class="difflineplus">+            firstPart2);</span>
<a href="#l40.150"></a><span id="l40.150">         break;</span>
<a href="#l40.151"></a><span id="l40.151">     default:</span>
<a href="#l40.152"></a><span id="l40.152">         rv = NS_ERROR_INVALID_ARG;</span>
<a href="#l40.153"></a><span id="l40.153">         break;</span>
<a href="#l40.154"></a><span id="l40.154">     }</span>
<a href="#l40.155"></a><span id="l40.155"> </span>
<a href="#l40.156"></a><span id="l40.156">     if (NS_FAILED(rv))</span>
<a href="#l40.157"></a><span id="l40.157">         return rv;</span>
<a href="#l40.158"></a><span id="l40.158" class="difflineat">@@ -1124,18 +1124,18 @@ NS_IMETHODIMP nsMsgMdnGenerator::OnStopR</span>
<a href="#l40.159"></a><span id="l40.159"> </span>
<a href="#l40.160"></a><span id="l40.160">     rv = bundleService-&gt;CreateBundle(</span>
<a href="#l40.161"></a><span id="l40.161">       &quot;chrome://messenger/locale/messengercompose/composeMsgs.properties&quot;,</span>
<a href="#l40.162"></a><span id="l40.162">       getter_AddRefs(bundle));</span>
<a href="#l40.163"></a><span id="l40.163">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l40.164"></a><span id="l40.164"> </span>
<a href="#l40.165"></a><span id="l40.165">     nsString failed_msg, dialogTitle;</span>
<a href="#l40.166"></a><span id="l40.166"> </span>
<a href="#l40.167"></a><span id="l40.167" class="difflineminus">-    bundle-&gt;FormatStringFromName(exitString, params, 1, getter_Copies(failed_msg));</span>
<a href="#l40.168"></a><span id="l40.168" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;sendMessageErrorTitle&quot;, getter_Copies(dialogTitle));</span>
<a href="#l40.169"></a><span id="l40.169" class="difflineplus">+    bundle-&gt;FormatStringFromName(exitString, params, 1, failed_msg);</span>
<a href="#l40.170"></a><span id="l40.170" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;sendMessageErrorTitle&quot;, dialogTitle);</span>
<a href="#l40.171"></a><span id="l40.171"> </span>
<a href="#l40.172"></a><span id="l40.172">     nsCOMPtr&lt;nsIPrompt&gt; dialog;</span>
<a href="#l40.173"></a><span id="l40.173">     rv = m_window-&gt;GetPromptDialog(getter_AddRefs(dialog));</span>
<a href="#l40.174"></a><span id="l40.174">     if (NS_SUCCEEDED(rv))</span>
<a href="#l40.175"></a><span id="l40.175">       dialog-&gt;Alert(dialogTitle.get(),failed_msg.get());</span>
<a href="#l40.176"></a><span id="l40.176"> </span>
<a href="#l40.177"></a><span id="l40.177">     return NS_OK;</span>
<a href="#l40.178"></a><span id="l40.178"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/mailnews/extensions/mdn/src/nsMsgMdnGenerator.h</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/mailnews/extensions/mdn/src/nsMsgMdnGenerator.h</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -47,20 +47,20 @@ private:</span>
<a href="#l41.4"></a><span id="l41.4"> </span>
<a href="#l41.5"></a><span id="l41.5">   nsresult CreateMdnMsg();</span>
<a href="#l41.6"></a><span id="l41.6">   nsresult CreateFirstPart();</span>
<a href="#l41.7"></a><span id="l41.7">   nsresult CreateSecondPart();</span>
<a href="#l41.8"></a><span id="l41.8">   nsresult CreateThirdPart();</span>
<a href="#l41.9"></a><span id="l41.9">   nsresult SendMdnMsg();</span>
<a href="#l41.10"></a><span id="l41.10"> </span>
<a href="#l41.11"></a><span id="l41.11">   // string bundle helper methods</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-  nsresult GetStringFromName(const char *aName, char16_t **aResultString);</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+  nsresult GetStringFromName(const char *aName, nsAString&amp; aResultString);</span>
<a href="#l41.14"></a><span id="l41.14">   nsresult FormatStringFromName(const char *aName,</span>
<a href="#l41.15"></a><span id="l41.15">                                 const char16_t *aString,</span>
<a href="#l41.16"></a><span id="l41.16" class="difflineminus">-                                char16_t **aResultString);</span>
<a href="#l41.17"></a><span id="l41.17" class="difflineplus">+                                nsAString&amp; aResultString);</span>
<a href="#l41.18"></a><span id="l41.18"> </span>
<a href="#l41.19"></a><span id="l41.19">   // other helper methods</span>
<a href="#l41.20"></a><span id="l41.20">   nsresult InitAndProcess(bool *needToAskUser);</span>
<a href="#l41.21"></a><span id="l41.21">   nsresult OutputAllHeaders();</span>
<a href="#l41.22"></a><span id="l41.22">   nsresult WriteString(const char *str);</span>
<a href="#l41.23"></a><span id="l41.23"> </span>
<a href="#l41.24"></a><span id="l41.24"> private:</span>
<a href="#l41.25"></a><span id="l41.25">   EDisposeType m_disposeType;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/mailnews/extensions/smime/src/nsMsgComposeSecure.cpp</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -185,33 +185,32 @@ nsresult nsMsgComposeSecure::GetSMIMEBun</span>
<a href="#l42.4"></a><span id="l42.4">                                                   nsString &amp;outString)</span>
<a href="#l42.5"></a><span id="l42.5"> {</span>
<a href="#l42.6"></a><span id="l42.6">   outString.Truncate();</span>
<a href="#l42.7"></a><span id="l42.7"> </span>
<a href="#l42.8"></a><span id="l42.8">   NS_ENSURE_ARG_POINTER(name);</span>
<a href="#l42.9"></a><span id="l42.9"> </span>
<a href="#l42.10"></a><span id="l42.10">   NS_ENSURE_TRUE(InitializeSMIMEBundle(), NS_ERROR_FAILURE);</span>
<a href="#l42.11"></a><span id="l42.11"> </span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-  return mSMIMEBundle-&gt;GetStringFromName(NS_ConvertUTF16toUTF8(name).get(), getter_Copies(outString));</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineplus">+  return mSMIMEBundle-&gt;GetStringFromName(NS_ConvertUTF16toUTF8(name).get(), outString);</span>
<a href="#l42.14"></a><span id="l42.14"> }</span>
<a href="#l42.15"></a><span id="l42.15"> </span>
<a href="#l42.16"></a><span id="l42.16"> nsresult</span>
<a href="#l42.17"></a><span id="l42.17"> nsMsgComposeSecure::</span>
<a href="#l42.18"></a><span id="l42.18"> SMIMEBundleFormatStringFromName(const char *name,</span>
<a href="#l42.19"></a><span id="l42.19">                                 const char16_t **params,</span>
<a href="#l42.20"></a><span id="l42.20">                                 uint32_t numParams,</span>
<a href="#l42.21"></a><span id="l42.21" class="difflineminus">-                                char16_t **outString)</span>
<a href="#l42.22"></a><span id="l42.22" class="difflineplus">+                                nsAString&amp; outString)</span>
<a href="#l42.23"></a><span id="l42.23"> {</span>
<a href="#l42.24"></a><span id="l42.24">   NS_ENSURE_ARG_POINTER(name);</span>
<a href="#l42.25"></a><span id="l42.25"> </span>
<a href="#l42.26"></a><span id="l42.26">   if (!InitializeSMIMEBundle())</span>
<a href="#l42.27"></a><span id="l42.27">     return NS_ERROR_FAILURE;</span>
<a href="#l42.28"></a><span id="l42.28"> </span>
<a href="#l42.29"></a><span id="l42.29" class="difflineminus">-  return mSMIMEBundle-&gt;FormatStringFromName(name, params,</span>
<a href="#l42.30"></a><span id="l42.30" class="difflineminus">-                                            numParams, outString);</span>
<a href="#l42.31"></a><span id="l42.31" class="difflineplus">+  return mSMIMEBundle-&gt;FormatStringFromName(name, params, numParams, outString);</span>
<a href="#l42.32"></a><span id="l42.32"> }</span>
<a href="#l42.33"></a><span id="l42.33"> </span>
<a href="#l42.34"></a><span id="l42.34"> bool nsMsgComposeSecure::InitializeSMIMEBundle()</span>
<a href="#l42.35"></a><span id="l42.35"> {</span>
<a href="#l42.36"></a><span id="l42.36">   if (mSMIMEBundle)</span>
<a href="#l42.37"></a><span id="l42.37">     return true;</span>
<a href="#l42.38"></a><span id="l42.38"> </span>
<a href="#l42.39"></a><span id="l42.39">   nsCOMPtr&lt;nsIStringBundleService&gt; bundleService =</span>
<a href="#l42.40"></a><span id="l42.40" class="difflineat">@@ -258,17 +257,17 @@ void nsMsgComposeSecure::SetErrorWithPar</span>
<a href="#l42.41"></a><span id="l42.41">   const char16_t *params[1];</span>
<a href="#l42.42"></a><span id="l42.42"> </span>
<a href="#l42.43"></a><span id="l42.43">   NS_ConvertASCIItoUTF16 ucs2(param);</span>
<a href="#l42.44"></a><span id="l42.44">   params[0]= ucs2.get();</span>
<a href="#l42.45"></a><span id="l42.45"> </span>
<a href="#l42.46"></a><span id="l42.46">   res = SMIMEBundleFormatStringFromName(bundle_string,</span>
<a href="#l42.47"></a><span id="l42.47">                                         params,</span>
<a href="#l42.48"></a><span id="l42.48">                                         1,</span>
<a href="#l42.49"></a><span id="l42.49" class="difflineminus">-                                        getter_Copies(errorString));</span>
<a href="#l42.50"></a><span id="l42.50" class="difflineplus">+                                        errorString);</span>
<a href="#l42.51"></a><span id="l42.51"> </span>
<a href="#l42.52"></a><span id="l42.52">   if (NS_SUCCEEDED(res) &amp;&amp; !errorString.IsEmpty())</span>
<a href="#l42.53"></a><span id="l42.53">   {</span>
<a href="#l42.54"></a><span id="l42.54">     sendReport-&gt;SetMessage(nsIMsgSendReport::process_Current,</span>
<a href="#l42.55"></a><span id="l42.55">                            errorString.get(),</span>
<a href="#l42.56"></a><span id="l42.56">                            true);</span>
<a href="#l42.57"></a><span id="l42.57">   }</span>
<a href="#l42.58"></a><span id="l42.58"> }</span>
<a href="#l42.59"></a><span id="l42.59" class="difflineat">@@ -555,17 +554,17 @@ nsresult nsMsgComposeSecure::MimeInitEnc</span>
<a href="#l42.60"></a><span id="l42.60">   nsString mime_smime_enc_content_desc;</span>
<a href="#l42.61"></a><span id="l42.61"> </span>
<a href="#l42.62"></a><span id="l42.62">   bundleSvc-&gt;CreateBundle(SMIME_STRBUNDLE_URL, getter_AddRefs(sMIMEBundle));</span>
<a href="#l42.63"></a><span id="l42.63"> </span>
<a href="#l42.64"></a><span id="l42.64">   if (!sMIMEBundle)</span>
<a href="#l42.65"></a><span id="l42.65">     return NS_ERROR_FAILURE;</span>
<a href="#l42.66"></a><span id="l42.66"> </span>
<a href="#l42.67"></a><span id="l42.67">   sMIMEBundle-&gt;GetStringFromName(&quot;mime_smimeEncryptedContentDesc&quot;,</span>
<a href="#l42.68"></a><span id="l42.68" class="difflineminus">-                                 getter_Copies(mime_smime_enc_content_desc));</span>
<a href="#l42.69"></a><span id="l42.69" class="difflineplus">+                                 mime_smime_enc_content_desc);</span>
<a href="#l42.70"></a><span id="l42.70">   NS_ConvertUTF16toUTF8 enc_content_desc_utf8(mime_smime_enc_content_desc);</span>
<a href="#l42.71"></a><span id="l42.71"> </span>
<a href="#l42.72"></a><span id="l42.72">   nsCOMPtr&lt;nsIMimeConverter&gt; mimeConverter =</span>
<a href="#l42.73"></a><span id="l42.73">      do_GetService(NS_MIME_CONVERTER_CONTRACTID, &amp;rv);</span>
<a href="#l42.74"></a><span id="l42.74">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l42.75"></a><span id="l42.75">   nsCString encodedContentDescription;</span>
<a href="#l42.76"></a><span id="l42.76">   mimeConverter-&gt;EncodeMimePartIIStr_UTF8(enc_content_desc_utf8, false, &quot;UTF-8&quot;,</span>
<a href="#l42.77"></a><span id="l42.77">       sizeof(&quot;Content-Description: &quot;),</span>
<a href="#l42.78"></a><span id="l42.78" class="difflineat">@@ -671,17 +670,17 @@ nsresult nsMsgComposeSecure::MimeFinishM</span>
<a href="#l42.79"></a><span id="l42.79">   nsString mime_smime_sig_content_desc;</span>
<a href="#l42.80"></a><span id="l42.80"> </span>
<a href="#l42.81"></a><span id="l42.81">   bundleSvc-&gt;CreateBundle(SMIME_STRBUNDLE_URL, getter_AddRefs(sMIMEBundle));</span>
<a href="#l42.82"></a><span id="l42.82"> </span>
<a href="#l42.83"></a><span id="l42.83">   if (!sMIMEBundle)</span>
<a href="#l42.84"></a><span id="l42.84">     return NS_ERROR_FAILURE;</span>
<a href="#l42.85"></a><span id="l42.85"> </span>
<a href="#l42.86"></a><span id="l42.86">   sMIMEBundle-&gt;GetStringFromName(&quot;mime_smimeSignatureContentDesc&quot;,</span>
<a href="#l42.87"></a><span id="l42.87" class="difflineminus">-                                 getter_Copies(mime_smime_sig_content_desc));</span>
<a href="#l42.88"></a><span id="l42.88" class="difflineplus">+                                 mime_smime_sig_content_desc);</span>
<a href="#l42.89"></a><span id="l42.89"> </span>
<a href="#l42.90"></a><span id="l42.90">   NS_ConvertUTF16toUTF8 sig_content_desc_utf8(mime_smime_sig_content_desc);</span>
<a href="#l42.91"></a><span id="l42.91"> </span>
<a href="#l42.92"></a><span id="l42.92">   /* Compute the hash...</span>
<a href="#l42.93"></a><span id="l42.93">    */</span>
<a href="#l42.94"></a><span id="l42.94"> </span>
<a href="#l42.95"></a><span id="l42.95">   nsAutoCString hashString;</span>
<a href="#l42.96"></a><span id="l42.96">   mDataHash-&gt;Finish(false, hashString);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/mailnews/extensions/smime/src/nsMsgComposeSecure.h</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/mailnews/extensions/smime/src/nsMsgComposeSecure.h</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -66,17 +66,17 @@ private:</span>
<a href="#l43.4"></a><span id="l43.4">   nsresult MimeInitEncryption(bool aSign, nsIMsgSendReport *sendReport);</span>
<a href="#l43.5"></a><span id="l43.5">   nsresult MimeFinishMultipartSigned (bool aOuter, nsIMsgSendReport *sendReport);</span>
<a href="#l43.6"></a><span id="l43.6">   nsresult MimeFinishEncryption (bool aSign, nsIMsgSendReport *sendReport);</span>
<a href="#l43.7"></a><span id="l43.7">   nsresult MimeCryptoHackCerts(const char *aRecipients, nsIMsgSendReport *sendReport, bool aEncrypt, bool aSign, nsIMsgIdentity *aIdentity);</span>
<a href="#l43.8"></a><span id="l43.8">   bool InitializeSMIMEBundle();</span>
<a href="#l43.9"></a><span id="l43.9">   nsresult SMIMEBundleFormatStringFromName(const char *name,</span>
<a href="#l43.10"></a><span id="l43.10"> 					   const char16_t **params,</span>
<a href="#l43.11"></a><span id="l43.11"> 					   uint32_t numParams,</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-					   char16_t **outString);</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineplus">+					   nsAString&amp; outString);</span>
<a href="#l43.14"></a><span id="l43.14">   nsresult ExtractEncryptionState(nsIMsgIdentity * aIdentity, nsIMsgCompFields * aComposeFields, bool * aSignMessage, bool * aEncrypt);</span>
<a href="#l43.15"></a><span id="l43.15"> </span>
<a href="#l43.16"></a><span id="l43.16">   mimeDeliveryCryptoState mCryptoState;</span>
<a href="#l43.17"></a><span id="l43.17">   nsCOMPtr&lt;nsIOutputStream&gt; mStream;</span>
<a href="#l43.18"></a><span id="l43.18">   int16_t mHashType;</span>
<a href="#l43.19"></a><span id="l43.19">   nsCOMPtr&lt;nsICryptoHash&gt; mDataHash;</span>
<a href="#l43.20"></a><span id="l43.20">   nsAutoPtr&lt;MimeEncoder&gt; mSigEncoder;</span>
<a href="#l43.21"></a><span id="l43.21">   char *mMultipartSignedBoundary;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/mailnews/imap/src/nsImapIncomingServer.cpp</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapIncomingServer.cpp</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -1862,17 +1862,17 @@ nsImapIncomingServer::FEAlert(const nsAS</span>
<a href="#l44.4"></a><span id="l44.4">     if (NS_SUCCEEDED(rv))</span>
<a href="#l44.5"></a><span id="l44.5">     {</span>
<a href="#l44.6"></a><span id="l44.6">       nsString message;</span>
<a href="#l44.7"></a><span id="l44.7">       nsString tempString(aAlertString);</span>
<a href="#l44.8"></a><span id="l44.8">       const char16_t *params[] = { hostName.get(), tempString.get() };</span>
<a href="#l44.9"></a><span id="l44.9"> </span>
<a href="#l44.10"></a><span id="l44.10">       rv = m_stringBundle-&gt;FormatStringFromName(</span>
<a href="#l44.11"></a><span id="l44.11">         &quot;imapServerAlert&quot;,</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-        params, 2, getter_Copies(message));</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineplus">+        params, 2, message);</span>
<a href="#l44.14"></a><span id="l44.14">       if (NS_SUCCEEDED(rv))</span>
<a href="#l44.15"></a><span id="l44.15">         return AlertUser(message, aUrl);</span>
<a href="#l44.16"></a><span id="l44.16">     }</span>
<a href="#l44.17"></a><span id="l44.17">   }</span>
<a href="#l44.18"></a><span id="l44.18">   return AlertUser(aAlertString, aUrl);</span>
<a href="#l44.19"></a><span id="l44.19"> }</span>
<a href="#l44.20"></a><span id="l44.20"> </span>
<a href="#l44.21"></a><span id="l44.21"> nsresult nsImapIncomingServer::AlertUser(const nsAString&amp; aString,</span>
<a href="#l44.22"></a><span id="l44.22" class="difflineat">@@ -1901,17 +1901,17 @@ nsImapIncomingServer::FEAlertWithName(co</span>
<a href="#l44.23"></a><span id="l44.23">   {</span>
<a href="#l44.24"></a><span id="l44.24">     nsAutoString hostName;</span>
<a href="#l44.25"></a><span id="l44.25">     nsresult rv = GetPrettyName(hostName);</span>
<a href="#l44.26"></a><span id="l44.26">     if (NS_SUCCEEDED(rv))</span>
<a href="#l44.27"></a><span id="l44.27">     {</span>
<a href="#l44.28"></a><span id="l44.28">       const char16_t *params[] = { hostName.get() };</span>
<a href="#l44.29"></a><span id="l44.29">       rv = m_stringBundle-&gt;FormatStringFromName(</span>
<a href="#l44.30"></a><span id="l44.30">         aMsgName,</span>
<a href="#l44.31"></a><span id="l44.31" class="difflineminus">-        params, 1,getter_Copies(message));</span>
<a href="#l44.32"></a><span id="l44.32" class="difflineplus">+        params, 1,message);</span>
<a href="#l44.33"></a><span id="l44.33">       if (NS_SUCCEEDED(rv))</span>
<a href="#l44.34"></a><span id="l44.34">         return AlertUser(message, aUrl);</span>
<a href="#l44.35"></a><span id="l44.35">     }</span>
<a href="#l44.36"></a><span id="l44.36">   }</span>
<a href="#l44.37"></a><span id="l44.37"> </span>
<a href="#l44.38"></a><span id="l44.38">   // Error condition</span>
<a href="#l44.39"></a><span id="l44.39">   message.AssignLiteral(&quot;String Name &quot;);</span>
<a href="#l44.40"></a><span id="l44.40">   message.AppendASCII(aMsgName);</span>
<a href="#l44.41"></a><span id="l44.41" class="difflineat">@@ -1985,17 +1985,17 @@ NS_IMETHODIMP  nsImapIncomingServer::FEA</span>
<a href="#l44.42"></a><span id="l44.42"> </span>
<a href="#l44.43"></a><span id="l44.43">   formatStrings[numStrings -1] = unicodeMsg.get();</span>
<a href="#l44.44"></a><span id="l44.44"> </span>
<a href="#l44.45"></a><span id="l44.45">   nsresult rv = GetStringBundle();</span>
<a href="#l44.46"></a><span id="l44.46">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l44.47"></a><span id="l44.47">   if (m_stringBundle)</span>
<a href="#l44.48"></a><span id="l44.48">   {</span>
<a href="#l44.49"></a><span id="l44.49">     rv = m_stringBundle-&gt;FormatStringFromName(msgName,</span>
<a href="#l44.50"></a><span id="l44.50" class="difflineminus">-      formatStrings, numStrings, getter_Copies(fullMessage));</span>
<a href="#l44.51"></a><span id="l44.51" class="difflineplus">+      formatStrings, numStrings, fullMessage);</span>
<a href="#l44.52"></a><span id="l44.52">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l44.53"></a><span id="l44.53">   }</span>
<a href="#l44.54"></a><span id="l44.54"> </span>
<a href="#l44.55"></a><span id="l44.55">   return AlertUser(fullMessage, aUrl);</span>
<a href="#l44.56"></a><span id="l44.56"> }</span>
<a href="#l44.57"></a><span id="l44.57"> </span>
<a href="#l44.58"></a><span id="l44.58"> #define IMAP_MSGS_URL       &quot;chrome://messenger/locale/imapMsgs.properties&quot;</span>
<a href="#l44.59"></a><span id="l44.59"> </span>
<a href="#l44.60"></a><span id="l44.60" class="difflineat">@@ -2013,17 +2013,17 @@ nsresult nsImapIncomingServer::GetString</span>
<a href="#l44.61"></a><span id="l44.61"> NS_IMETHODIMP</span>
<a href="#l44.62"></a><span id="l44.62"> nsImapIncomingServer::GetImapStringByName(const char* msgName, nsAString&amp; aString)</span>
<a href="#l44.63"></a><span id="l44.63"> {</span>
<a href="#l44.64"></a><span id="l44.64">   nsresult rv = NS_OK;</span>
<a href="#l44.65"></a><span id="l44.65">   GetStringBundle();</span>
<a href="#l44.66"></a><span id="l44.66">   if (m_stringBundle)</span>
<a href="#l44.67"></a><span id="l44.67">   {</span>
<a href="#l44.68"></a><span id="l44.68">     nsString res_str;</span>
<a href="#l44.69"></a><span id="l44.69" class="difflineminus">-    rv = m_stringBundle-&gt;GetStringFromName(msgName, getter_Copies(res_str));</span>
<a href="#l44.70"></a><span id="l44.70" class="difflineplus">+    rv = m_stringBundle-&gt;GetStringFromName(msgName, res_str);</span>
<a href="#l44.71"></a><span id="l44.71">     aString.Assign(res_str);</span>
<a href="#l44.72"></a><span id="l44.72">     if (NS_SUCCEEDED(rv))</span>
<a href="#l44.73"></a><span id="l44.73">       return rv;</span>
<a href="#l44.74"></a><span id="l44.74">   }</span>
<a href="#l44.75"></a><span id="l44.75">   aString.AssignLiteral(&quot;String Name &quot;);</span>
<a href="#l44.76"></a><span id="l44.76">   // mscott: FIX ME</span>
<a href="#l44.77"></a><span id="l44.77">   aString.AppendASCII(msgName);</span>
<a href="#l44.78"></a><span id="l44.78">   return NS_OK;</span>
<a href="#l44.79"></a><span id="l44.79" class="difflineat">@@ -2200,17 +2200,17 @@ nsImapIncomingServer::PromptPassword(nsI</span>
<a href="#l44.80"></a><span id="l44.80">   NS_ConvertASCIItoUTF16 finalUserName(userName);</span>
<a href="#l44.81"></a><span id="l44.81">   NS_ConvertASCIItoUTF16 finalHostName(hostName);</span>
<a href="#l44.82"></a><span id="l44.82"> </span>
<a href="#l44.83"></a><span id="l44.83">   const char16_t *formatStrings[] = { finalUserName.get(), finalHostName.get() };</span>
<a href="#l44.84"></a><span id="l44.84"> </span>
<a href="#l44.85"></a><span id="l44.85">   nsString passwordText;</span>
<a href="#l44.86"></a><span id="l44.86">   rv = m_stringBundle-&gt;FormatStringFromName(</span>
<a href="#l44.87"></a><span id="l44.87">     &quot;imapEnterServerPasswordPrompt&quot;,</span>
<a href="#l44.88"></a><span id="l44.88" class="difflineminus">-    formatStrings, 2, getter_Copies(passwordText));</span>
<a href="#l44.89"></a><span id="l44.89" class="difflineplus">+    formatStrings, 2, passwordText);</span>
<a href="#l44.90"></a><span id="l44.90">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l44.91"></a><span id="l44.91"> </span>
<a href="#l44.92"></a><span id="l44.92">   rv = GetPasswordWithUI(passwordText, passwordTitle, aMsgWindow, aPassword);</span>
<a href="#l44.93"></a><span id="l44.93">   if (NS_SUCCEEDED(rv))</span>
<a href="#l44.94"></a><span id="l44.94">     m_password = aPassword;</span>
<a href="#l44.95"></a><span id="l44.95">   return rv;</span>
<a href="#l44.96"></a><span id="l44.96"> }</span>
<a href="#l44.97"></a><span id="l44.97"> </span>
<a href="#l44.98"></a><span id="l44.98" class="difflineat">@@ -2939,17 +2939,17 @@ nsImapIncomingServer::GetFormattedString</span>
<a href="#l44.99"></a><span id="l44.99">   if (m_stringBundle)</span>
<a href="#l44.100"></a><span id="l44.100">   {</span>
<a href="#l44.101"></a><span id="l44.101">     nsString tmpVal (aValue);</span>
<a href="#l44.102"></a><span id="l44.102">     const char16_t *formatStrings[] = { tmpVal.get() };</span>
<a href="#l44.103"></a><span id="l44.103"> </span>
<a href="#l44.104"></a><span id="l44.104">     nsString result;</span>
<a href="#l44.105"></a><span id="l44.105">     rv = m_stringBundle-&gt;FormatStringFromName(</span>
<a href="#l44.106"></a><span id="l44.106">       aName,</span>
<a href="#l44.107"></a><span id="l44.107" class="difflineminus">-      formatStrings, 1, getter_Copies(result));</span>
<a href="#l44.108"></a><span id="l44.108" class="difflineplus">+      formatStrings, 1, result);</span>
<a href="#l44.109"></a><span id="l44.109">     aResult.Assign(result);</span>
<a href="#l44.110"></a><span id="l44.110">   }</span>
<a href="#l44.111"></a><span id="l44.111">   return rv;</span>
<a href="#l44.112"></a><span id="l44.112"> }</span>
<a href="#l44.113"></a><span id="l44.113"> </span>
<a href="#l44.114"></a><span id="l44.114"> nsresult</span>
<a href="#l44.115"></a><span id="l44.115"> nsImapIncomingServer::GetPrefForServerAttribute(const char *prefSuffix, bool *prefValue)</span>
<a href="#l44.116"></a><span id="l44.116"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/mailnews/imap/src/nsImapMailFolder.cpp</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapMailFolder.cpp</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -1601,30 +1601,30 @@ NS_IMETHODIMP nsImapMailFolder::Rename (</span>
<a href="#l45.4"></a><span id="l45.4">       {</span>
<a href="#l45.5"></a><span id="l45.5">         const char16_t *formatStrings[] =</span>
<a href="#l45.6"></a><span id="l45.6">         {</span>
<a href="#l45.7"></a><span id="l45.7">           (const char16_t*)(intptr_t)m_hierarchyDelimiter</span>
<a href="#l45.8"></a><span id="l45.8">         };</span>
<a href="#l45.9"></a><span id="l45.9">         nsString alertString;</span>
<a href="#l45.10"></a><span id="l45.10">         rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l45.11"></a><span id="l45.11">           &quot;imapSpecialChar&quot;,</span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-          formatStrings, 1, getter_Copies(alertString));</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineplus">+          formatStrings, 1, alertString);</span>
<a href="#l45.14"></a><span id="l45.14">         nsCOMPtr&lt;nsIPrompt&gt; dialog(do_GetInterface(docShell));</span>
<a href="#l45.15"></a><span id="l45.15">         // setting up the dialog title</span>
<a href="#l45.16"></a><span id="l45.16">         nsCOMPtr&lt;nsIMsgIncomingServer&gt; server;</span>
<a href="#l45.17"></a><span id="l45.17">         rv = GetServer(getter_AddRefs(server));</span>
<a href="#l45.18"></a><span id="l45.18">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l45.19"></a><span id="l45.19">         nsString dialogTitle;</span>
<a href="#l45.20"></a><span id="l45.20">         nsString accountName;</span>
<a href="#l45.21"></a><span id="l45.21">         rv = server-&gt;GetPrettyName(accountName);</span>
<a href="#l45.22"></a><span id="l45.22">         NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l45.23"></a><span id="l45.23">         const char16_t *titleParams[] = { accountName.get() };</span>
<a href="#l45.24"></a><span id="l45.24">         rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l45.25"></a><span id="l45.25">           &quot;imapAlertDialogTitle&quot;,</span>
<a href="#l45.26"></a><span id="l45.26" class="difflineminus">-          titleParams, 1, getter_Copies(dialogTitle));</span>
<a href="#l45.27"></a><span id="l45.27" class="difflineplus">+          titleParams, 1, dialogTitle);</span>
<a href="#l45.28"></a><span id="l45.28"> </span>
<a href="#l45.29"></a><span id="l45.29">         if (dialog &amp;&amp; !alertString.IsEmpty())</span>
<a href="#l45.30"></a><span id="l45.30">           dialog-&gt;Alert(dialogTitle.get(), alertString.get());</span>
<a href="#l45.31"></a><span id="l45.31">       }</span>
<a href="#l45.32"></a><span id="l45.32">     }</span>
<a href="#l45.33"></a><span id="l45.33">     return NS_ERROR_FAILURE;</span>
<a href="#l45.34"></a><span id="l45.34">   }</span>
<a href="#l45.35"></a><span id="l45.35">   nsCOMPtr &lt;nsIImapIncomingServer&gt; incomingImapServer;</span>
<a href="#l45.36"></a><span id="l45.36" class="difflineat">@@ -2423,30 +2423,30 @@ nsImapMailFolder::DeleteSubFolders(nsIAr</span>
<a href="#l45.37"></a><span id="l45.37">     nsAutoString folderName;</span>
<a href="#l45.38"></a><span id="l45.38">     rv = curFolder-&gt;GetName(folderName);</span>
<a href="#l45.39"></a><span id="l45.39">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l45.40"></a><span id="l45.40">     const char16_t *formatStrings[1] = { folderName.get() };</span>
<a href="#l45.41"></a><span id="l45.41"> </span>
<a href="#l45.42"></a><span id="l45.42">     nsAutoString deleteFolderDialogTitle;</span>
<a href="#l45.43"></a><span id="l45.43">     rv = bundle-&gt;GetStringFromName(</span>
<a href="#l45.44"></a><span id="l45.44">       &quot;imapDeleteFolderDialogTitle&quot;,</span>
<a href="#l45.45"></a><span id="l45.45" class="difflineminus">-      getter_Copies(deleteFolderDialogTitle));</span>
<a href="#l45.46"></a><span id="l45.46" class="difflineplus">+      deleteFolderDialogTitle);</span>
<a href="#l45.47"></a><span id="l45.47">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l45.48"></a><span id="l45.48"> </span>
<a href="#l45.49"></a><span id="l45.49">     nsAutoString deleteFolderButtonLabel;</span>
<a href="#l45.50"></a><span id="l45.50">     rv = bundle-&gt;GetStringFromName(</span>
<a href="#l45.51"></a><span id="l45.51">       &quot;imapDeleteFolderButtonLabel&quot;,</span>
<a href="#l45.52"></a><span id="l45.52" class="difflineminus">-      getter_Copies(deleteFolderButtonLabel));</span>
<a href="#l45.53"></a><span id="l45.53" class="difflineplus">+      deleteFolderButtonLabel);</span>
<a href="#l45.54"></a><span id="l45.54">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l45.55"></a><span id="l45.55"> </span>
<a href="#l45.56"></a><span id="l45.56">     nsAutoString confirmationStr;</span>
<a href="#l45.57"></a><span id="l45.57">     rv = bundle-&gt;FormatStringFromName((deleteNoTrash) ?</span>
<a href="#l45.58"></a><span id="l45.58">         &quot;imapDeleteNoTrash&quot; :</span>
<a href="#l45.59"></a><span id="l45.59">         &quot;imapMoveFolderToTrash&quot;,</span>
<a href="#l45.60"></a><span id="l45.60" class="difflineminus">-      formatStrings, 1, getter_Copies(confirmationStr));</span>
<a href="#l45.61"></a><span id="l45.61" class="difflineplus">+      formatStrings, 1, confirmationStr);</span>
<a href="#l45.62"></a><span id="l45.62">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l45.63"></a><span id="l45.63">     if (!msgWindow)</span>
<a href="#l45.64"></a><span id="l45.64">       return NS_ERROR_NULL_POINTER;</span>
<a href="#l45.65"></a><span id="l45.65">     nsCOMPtr&lt;nsIDocShell&gt; docShell;</span>
<a href="#l45.66"></a><span id="l45.66">     msgWindow-&gt;GetRootDocShell(getter_AddRefs(docShell));</span>
<a href="#l45.67"></a><span id="l45.67">     nsCOMPtr&lt;nsIPrompt&gt; dialog;</span>
<a href="#l45.68"></a><span id="l45.68">     if (docShell)</span>
<a href="#l45.69"></a><span id="l45.69">       dialog = do_GetInterface(docShell);</span>
<a href="#l45.70"></a><span id="l45.70" class="difflineat">@@ -6057,17 +6057,17 @@ nsImapMailFolder::FillInFolderProps(nsIM</span>
<a href="#l45.71"></a><span id="l45.71">     else</span>
<a href="#l45.72"></a><span id="l45.72">     {</span>
<a href="#l45.73"></a><span id="l45.73">       // is this right? It doesn't leak, does it?</span>
<a href="#l45.74"></a><span id="l45.74">       CopyASCIItoUTF16(owner, uniOwner);</span>
<a href="#l45.75"></a><span id="l45.75">     }</span>
<a href="#l45.76"></a><span id="l45.76">     const char16_t *params[] = { uniOwner.get() };</span>
<a href="#l45.77"></a><span id="l45.77">     rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l45.78"></a><span id="l45.78">       &quot;imapOtherUsersFolderTypeDescription&quot;,</span>
<a href="#l45.79"></a><span id="l45.79" class="difflineminus">-      params, 1, getter_Copies(folderTypeDesc));</span>
<a href="#l45.80"></a><span id="l45.80" class="difflineplus">+      params, 1, folderTypeDesc);</span>
<a href="#l45.81"></a><span id="l45.81">   }</span>
<a href="#l45.82"></a><span id="l45.82">   else if (GetFolderACL()-&gt;GetIsFolderShared())</span>
<a href="#l45.83"></a><span id="l45.83">   {</span>
<a href="#l45.84"></a><span id="l45.84">     folderTypeStringID = &quot;imapPersonalSharedFolderTypeName&quot;;</span>
<a href="#l45.85"></a><span id="l45.85">     folderTypeDescStringID = &quot;imapPersonalSharedFolderTypeDescription&quot;;</span>
<a href="#l45.86"></a><span id="l45.86">   }</span>
<a href="#l45.87"></a><span id="l45.87">   else</span>
<a href="#l45.88"></a><span id="l45.88">   {</span>
<a href="#l45.89"></a><span id="l45.89" class="difflineat">@@ -6585,90 +6585,79 @@ nsresult nsMsgIMAPFolderACL::CreateACLRi</span>
<a href="#l45.90"></a><span id="l45.90"> {</span>
<a href="#l45.91"></a><span id="l45.91">   nsString curRight;</span>
<a href="#l45.92"></a><span id="l45.92">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l45.93"></a><span id="l45.93">   nsresult rv = IMAPGetStringBundle(getter_AddRefs(bundle));</span>
<a href="#l45.94"></a><span id="l45.94">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l45.95"></a><span id="l45.95"> </span>
<a href="#l45.96"></a><span id="l45.96">   if (GetDoIHaveFullRightsForFolder()) {</span>
<a href="#l45.97"></a><span id="l45.97">     nsAutoString result;</span>
<a href="#l45.98"></a><span id="l45.98" class="difflineminus">-    rv = bundle-&gt;GetStringFromName(&quot;imapAclFullRights&quot;,</span>
<a href="#l45.99"></a><span id="l45.99" class="difflineminus">-                                   getter_Copies(result));</span>
<a href="#l45.100"></a><span id="l45.100" class="difflineplus">+    rv = bundle-&gt;GetStringFromName(&quot;imapAclFullRights&quot;, result);</span>
<a href="#l45.101"></a><span id="l45.101">     aRightsString.Assign(result);</span>
<a href="#l45.102"></a><span id="l45.102">     return rv;</span>
<a href="#l45.103"></a><span id="l45.103">   }</span>
<a href="#l45.104"></a><span id="l45.104"> </span>
<a href="#l45.105"></a><span id="l45.105">   if (GetCanIReadFolder())</span>
<a href="#l45.106"></a><span id="l45.106">   {</span>
<a href="#l45.107"></a><span id="l45.107" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;imapAclReadRight&quot;,</span>
<a href="#l45.108"></a><span id="l45.108" class="difflineminus">-                              getter_Copies(curRight));</span>
<a href="#l45.109"></a><span id="l45.109" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;imapAclReadRight&quot;, curRight);</span>
<a href="#l45.110"></a><span id="l45.110">     aRightsString.Append(curRight);</span>
<a href="#l45.111"></a><span id="l45.111">   }</span>
<a href="#l45.112"></a><span id="l45.112">   if (GetCanIWriteFolder())</span>
<a href="#l45.113"></a><span id="l45.113">   {</span>
<a href="#l45.114"></a><span id="l45.114">     if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l45.115"></a><span id="l45.115" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;imapAclWriteRight&quot;,</span>
<a href="#l45.116"></a><span id="l45.116" class="difflineminus">-                              getter_Copies(curRight));</span>
<a href="#l45.117"></a><span id="l45.117" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;imapAclWriteRight&quot;, curRight);</span>
<a href="#l45.118"></a><span id="l45.118">     aRightsString.Append(curRight);</span>
<a href="#l45.119"></a><span id="l45.119">   }</span>
<a href="#l45.120"></a><span id="l45.120">   if (GetCanIInsertInFolder())</span>
<a href="#l45.121"></a><span id="l45.121">   {</span>
<a href="#l45.122"></a><span id="l45.122">     if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l45.123"></a><span id="l45.123" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;imapAclInsertRight&quot;,</span>
<a href="#l45.124"></a><span id="l45.124" class="difflineminus">-                              getter_Copies(curRight));</span>
<a href="#l45.125"></a><span id="l45.125" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;imapAclInsertRight&quot;, curRight);</span>
<a href="#l45.126"></a><span id="l45.126">     aRightsString.Append(curRight);</span>
<a href="#l45.127"></a><span id="l45.127">   }</span>
<a href="#l45.128"></a><span id="l45.128">   if (GetCanILookupFolder())</span>
<a href="#l45.129"></a><span id="l45.129">   {</span>
<a href="#l45.130"></a><span id="l45.130">     if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l45.131"></a><span id="l45.131" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;imapAclLookupRight&quot;,</span>
<a href="#l45.132"></a><span id="l45.132" class="difflineminus">-                              getter_Copies(curRight));</span>
<a href="#l45.133"></a><span id="l45.133" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;imapAclLookupRight&quot;, curRight);</span>
<a href="#l45.134"></a><span id="l45.134">     aRightsString.Append(curRight);</span>
<a href="#l45.135"></a><span id="l45.135">   }</span>
<a href="#l45.136"></a><span id="l45.136">   if (GetCanIStoreSeenInFolder())</span>
<a href="#l45.137"></a><span id="l45.137">   {</span>
<a href="#l45.138"></a><span id="l45.138">     if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l45.139"></a><span id="l45.139" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;imapAclSeenRight&quot;,</span>
<a href="#l45.140"></a><span id="l45.140" class="difflineminus">-                              getter_Copies(curRight));</span>
<a href="#l45.141"></a><span id="l45.141" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;imapAclSeenRight&quot;, curRight);</span>
<a href="#l45.142"></a><span id="l45.142">     aRightsString.Append(curRight);</span>
<a href="#l45.143"></a><span id="l45.143">   }</span>
<a href="#l45.144"></a><span id="l45.144">   if (GetCanIDeleteInFolder())</span>
<a href="#l45.145"></a><span id="l45.145">   {</span>
<a href="#l45.146"></a><span id="l45.146">     if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l45.147"></a><span id="l45.147" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;imapAclDeleteRight&quot;,</span>
<a href="#l45.148"></a><span id="l45.148" class="difflineminus">-                              getter_Copies(curRight));</span>
<a href="#l45.149"></a><span id="l45.149" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;imapAclDeleteRight&quot;, curRight);</span>
<a href="#l45.150"></a><span id="l45.150">     aRightsString.Append(curRight);</span>
<a href="#l45.151"></a><span id="l45.151">   }</span>
<a href="#l45.152"></a><span id="l45.152">   if (GetCanIExpungeFolder())</span>
<a href="#l45.153"></a><span id="l45.153">   {</span>
<a href="#l45.154"></a><span id="l45.154">     if (!aRightsString.IsEmpty())</span>
<a href="#l45.155"></a><span id="l45.155">       aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l45.156"></a><span id="l45.156" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;imapAclExpungeRight&quot;,</span>
<a href="#l45.157"></a><span id="l45.157" class="difflineminus">-                              getter_Copies(curRight));</span>
<a href="#l45.158"></a><span id="l45.158" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;imapAclExpungeRight&quot;, curRight);</span>
<a href="#l45.159"></a><span id="l45.159">     aRightsString.Append(curRight);</span>
<a href="#l45.160"></a><span id="l45.160">   }</span>
<a href="#l45.161"></a><span id="l45.161">   if (GetCanICreateSubfolder())</span>
<a href="#l45.162"></a><span id="l45.162">   {</span>
<a href="#l45.163"></a><span id="l45.163">     if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l45.164"></a><span id="l45.164" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;imapAclCreateRight&quot;,</span>
<a href="#l45.165"></a><span id="l45.165" class="difflineminus">-                              getter_Copies(curRight));</span>
<a href="#l45.166"></a><span id="l45.166" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;imapAclCreateRight&quot;, curRight);</span>
<a href="#l45.167"></a><span id="l45.167">     aRightsString.Append(curRight);</span>
<a href="#l45.168"></a><span id="l45.168">   }</span>
<a href="#l45.169"></a><span id="l45.169">   if (GetCanIPostToFolder())</span>
<a href="#l45.170"></a><span id="l45.170">   {</span>
<a href="#l45.171"></a><span id="l45.171">     if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l45.172"></a><span id="l45.172" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;imapAclPostRight&quot;,</span>
<a href="#l45.173"></a><span id="l45.173" class="difflineminus">-                              getter_Copies(curRight));</span>
<a href="#l45.174"></a><span id="l45.174" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;imapAclPostRight&quot;, curRight);</span>
<a href="#l45.175"></a><span id="l45.175">     aRightsString.Append(curRight);</span>
<a href="#l45.176"></a><span id="l45.176">   }</span>
<a href="#l45.177"></a><span id="l45.177">   if (GetCanIAdministerFolder())</span>
<a href="#l45.178"></a><span id="l45.178">   {</span>
<a href="#l45.179"></a><span id="l45.179">     if (!aRightsString.IsEmpty()) aRightsString.AppendLiteral(&quot;, &quot;);</span>
<a href="#l45.180"></a><span id="l45.180" class="difflineminus">-    bundle-&gt;GetStringFromName(&quot;imapAclAdministerRight&quot;,</span>
<a href="#l45.181"></a><span id="l45.181" class="difflineminus">-                              getter_Copies(curRight));</span>
<a href="#l45.182"></a><span id="l45.182" class="difflineplus">+    bundle-&gt;GetStringFromName(&quot;imapAclAdministerRight&quot;, curRight);</span>
<a href="#l45.183"></a><span id="l45.183">     aRightsString.Append(curRight);</span>
<a href="#l45.184"></a><span id="l45.184">   }</span>
<a href="#l45.185"></a><span id="l45.185">   return rv;</span>
<a href="#l45.186"></a><span id="l45.186"> }</span>
<a href="#l45.187"></a><span id="l45.187"> </span>
<a href="#l45.188"></a><span id="l45.188"> NS_IMETHODIMP nsImapMailFolder::GetFilePath(nsIFile ** aPathName)</span>
<a href="#l45.189"></a><span id="l45.189"> {</span>
<a href="#l45.190"></a><span id="l45.190">   // this will return a copy of mPath, which is what we want.</span>
<a href="#l45.191"></a><span id="l45.191" class="difflineat">@@ -8201,17 +8190,17 @@ nsImapMailFolder::CopyStreamMessage(nsIM</span>
<a href="#l45.192"></a><span id="l45.192">                                             dstFolderName.get()</span>
<a href="#l45.193"></a><span id="l45.193">                                             };</span>
<a href="#l45.194"></a><span id="l45.194"> </span>
<a href="#l45.195"></a><span id="l45.195">       nsCOMPtr &lt;nsIStringBundle&gt; bundle;</span>
<a href="#l45.196"></a><span id="l45.196">       rv = IMAPGetStringBundle(getter_AddRefs(bundle));</span>
<a href="#l45.197"></a><span id="l45.197">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l45.198"></a><span id="l45.198">       rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l45.199"></a><span id="l45.199">         &quot;imapCopyingMessageOf2&quot;,</span>
<a href="#l45.200"></a><span id="l45.200" class="difflineminus">-        formatStrings, 3, getter_Copies(progressText));</span>
<a href="#l45.201"></a><span id="l45.201" class="difflineplus">+        formatStrings, 3, progressText);</span>
<a href="#l45.202"></a><span id="l45.202">       nsCOMPtr &lt;nsIMsgStatusFeedback&gt; statusFeedback;</span>
<a href="#l45.203"></a><span id="l45.203">       if (m_copyState-&gt;m_msgWindow)</span>
<a href="#l45.204"></a><span id="l45.204">         m_copyState-&gt;m_msgWindow-&gt;GetStatusFeedback(getter_AddRefs(statusFeedback));</span>
<a href="#l45.205"></a><span id="l45.205">       if (statusFeedback)</span>
<a href="#l45.206"></a><span id="l45.206">       {</span>
<a href="#l45.207"></a><span id="l45.207">         statusFeedback-&gt;ShowStatusString(progressText);</span>
<a href="#l45.208"></a><span id="l45.208">         int32_t percent;</span>
<a href="#l45.209"></a><span id="l45.209">         percent = (100 * m_copyState-&gt;m_curIndex) / (int32_t) m_copyState-&gt;m_totalCount;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/mailnews/imap/src/nsImapProtocol.cpp</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapProtocol.cpp</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -555,18 +555,17 @@ nsImapProtocol::Initialize(nsIImapHostSe</span>
<a href="#l46.4"></a><span id="l46.4">   m_hostSessionList = aHostSessionList; // no ref count...host session list has life time &gt; connection</span>
<a href="#l46.5"></a><span id="l46.5">   m_parser.SetHostSessionList(aHostSessionList);</span>
<a href="#l46.6"></a><span id="l46.6">   m_parser.SetFlagState(m_flagState);</span>
<a href="#l46.7"></a><span id="l46.7"> </span>
<a href="#l46.8"></a><span id="l46.8">   // Initialize the empty mime part string on the main thread.</span>
<a href="#l46.9"></a><span id="l46.9">   rv = IMAPGetStringBundle(getter_AddRefs(m_bundle));</span>
<a href="#l46.10"></a><span id="l46.10">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l46.11"></a><span id="l46.11"> </span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-  rv = m_bundle-&gt;GetStringFromName(&quot;imapEmptyMimePart&quot;,</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineminus">-    getter_Copies(m_emptyMimePartString));</span>
<a href="#l46.14"></a><span id="l46.14" class="difflineplus">+  rv = m_bundle-&gt;GetStringFromName(&quot;imapEmptyMimePart&quot;, m_emptyMimePartString);</span>
<a href="#l46.15"></a><span id="l46.15">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l46.16"></a><span id="l46.16"> </span>
<a href="#l46.17"></a><span id="l46.17">   // Now initialize the thread for the connection</span>
<a href="#l46.18"></a><span id="l46.18">   if (m_thread == nullptr)</span>
<a href="#l46.19"></a><span id="l46.19">   {</span>
<a href="#l46.20"></a><span id="l46.20">     nsresult rv = NS_NewThread(getter_AddRefs(m_iThread), this);</span>
<a href="#l46.21"></a><span id="l46.21">     if (NS_FAILED(rv))</span>
<a href="#l46.22"></a><span id="l46.22">     {</span>
<a href="#l46.23"></a><span id="l46.23" class="difflineat">@@ -5231,17 +5230,17 @@ nsImapProtocol::ShowProgress()</span>
<a href="#l46.24"></a><span id="l46.24">     const char16_t *formatStrings[] = {</span>
<a href="#l46.25"></a><span id="l46.25">       progressCurrentNumberString.get(),</span>
<a href="#l46.26"></a><span id="l46.26">       progressExpectedNumberString.get(),</span>
<a href="#l46.27"></a><span id="l46.27">       unicodeMailboxName.get()</span>
<a href="#l46.28"></a><span id="l46.28">     };</span>
<a href="#l46.29"></a><span id="l46.29"> </span>
<a href="#l46.30"></a><span id="l46.30">     rv = m_bundle-&gt;FormatStringFromName(</span>
<a href="#l46.31"></a><span id="l46.31">                     m_progressStringName.get(),</span>
<a href="#l46.32"></a><span id="l46.32" class="difflineminus">-                    formatStrings, 3, getter_Copies(progressString));</span>
<a href="#l46.33"></a><span id="l46.33" class="difflineplus">+                    formatStrings, 3, progressString);</span>
<a href="#l46.34"></a><span id="l46.34"> </span>
<a href="#l46.35"></a><span id="l46.35">     if (NS_SUCCEEDED(rv) &amp;&amp; !progressString.IsEmpty())</span>
<a href="#l46.36"></a><span id="l46.36">     {</span>
<a href="#l46.37"></a><span id="l46.37">       PercentProgressUpdateEvent(progressString.get(), progressCurrentNumber,</span>
<a href="#l46.38"></a><span id="l46.38">                                 m_progressExpectedNumber);</span>
<a href="#l46.39"></a><span id="l46.39">     }</span>
<a href="#l46.40"></a><span id="l46.40">   }</span>
<a href="#l46.41"></a><span id="l46.41"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/mailnews/imap/src/nsImapService.cpp</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapService.cpp</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -2762,17 +2762,17 @@ NS_IMETHODIMP nsImapService::NewChannel2</span>
<a href="#l47.4"></a><span id="l47.4">         // need to convert folder name from mod-utf7 to unicode</span>
<a href="#l47.5"></a><span id="l47.5">       nsAutoString unescapedName;</span>
<a href="#l47.6"></a><span id="l47.6">       if (NS_FAILED(CopyMUTF7toUTF16(fullFolderName, unescapedName)))</span>
<a href="#l47.7"></a><span id="l47.7">         CopyASCIItoUTF16(fullFolderName, unescapedName);</span>
<a href="#l47.8"></a><span id="l47.8">       const char16_t *formatStrings[1] = { unescapedName.get() };</span>
<a href="#l47.9"></a><span id="l47.9"> </span>
<a href="#l47.10"></a><span id="l47.10">       rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l47.11"></a><span id="l47.11">         &quot;imapSubscribePrompt&quot;,</span>
<a href="#l47.12"></a><span id="l47.12" class="difflineminus">-        formatStrings, 1, getter_Copies(confirmText));</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineplus">+        formatStrings, 1, confirmText);</span>
<a href="#l47.14"></a><span id="l47.14">       NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l47.15"></a><span id="l47.15"> </span>
<a href="#l47.16"></a><span id="l47.16">       bool confirmResult = false;</span>
<a href="#l47.17"></a><span id="l47.17">       rv = dialog-&gt;Confirm(nullptr, confirmText.get(), &amp;confirmResult);</span>
<a href="#l47.18"></a><span id="l47.18">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l47.19"></a><span id="l47.19"> </span>
<a href="#l47.20"></a><span id="l47.20">       if (confirmResult)</span>
<a href="#l47.21"></a><span id="l47.21">       {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1" class="difflineminus">--- a/mailnews/imap/src/nsImapStringBundle.cpp</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapStringBundle.cpp</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineat">@@ -16,18 +16,21 @@</span>
<a href="#l48.4"></a><span id="l48.4"> #define IMAP_MSGS_URL       &quot;chrome://messenger/locale/imapMsgs.properties&quot;</span>
<a href="#l48.5"></a><span id="l48.5"> </span>
<a href="#l48.6"></a><span id="l48.6"> extern &quot;C&quot; </span>
<a href="#l48.7"></a><span id="l48.7"> nsresult</span>
<a href="#l48.8"></a><span id="l48.8"> IMAPGetStringByName(const char* stringName, char16_t **aString)</span>
<a href="#l48.9"></a><span id="l48.9"> {</span>
<a href="#l48.10"></a><span id="l48.10">   nsCOMPtr &lt;nsIStringBundle&gt; sBundle;</span>
<a href="#l48.11"></a><span id="l48.11">   nsresult rv = IMAPGetStringBundle(getter_AddRefs(sBundle));</span>
<a href="#l48.12"></a><span id="l48.12" class="difflineminus">-  if (NS_SUCCEEDED(rv) &amp;&amp; sBundle)</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineminus">-    rv = sBundle-&gt;GetStringFromName(stringName, aString);</span>
<a href="#l48.14"></a><span id="l48.14" class="difflineplus">+  if (NS_SUCCEEDED(rv) &amp;&amp; sBundle) {</span>
<a href="#l48.15"></a><span id="l48.15" class="difflineplus">+    nsAutoString string;</span>
<a href="#l48.16"></a><span id="l48.16" class="difflineplus">+    rv = sBundle-&gt;GetStringFromName(stringName, string);</span>
<a href="#l48.17"></a><span id="l48.17" class="difflineplus">+    *aString = ToNewUnicode(string);</span>
<a href="#l48.18"></a><span id="l48.18" class="difflineplus">+  }</span>
<a href="#l48.19"></a><span id="l48.19">   return rv;</span>
<a href="#l48.20"></a><span id="l48.20"> }</span>
<a href="#l48.21"></a><span id="l48.21"> </span>
<a href="#l48.22"></a><span id="l48.22"> nsresult</span>
<a href="#l48.23"></a><span id="l48.23"> IMAPGetStringBundle(nsIStringBundle **aBundle)</span>
<a href="#l48.24"></a><span id="l48.24"> {</span>
<a href="#l48.25"></a><span id="l48.25">   nsresult rv=NS_OK;</span>
<a href="#l48.26"></a><span id="l48.26">   nsCOMPtr&lt;nsIStringBundleService&gt; stringService =</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1" class="difflineminus">--- a/mailnews/import/applemail/src/nsAppleMailImport.cpp</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineplus">+++ b/mailnews/import/applemail/src/nsAppleMailImport.cpp</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineat">@@ -51,24 +51,36 @@ nsAppleMailImportModule::~nsAppleMailImp</span>
<a href="#l49.4"></a><span id="l49.4"> }</span>
<a href="#l49.5"></a><span id="l49.5"> </span>
<a href="#l49.6"></a><span id="l49.6"> </span>
<a href="#l49.7"></a><span id="l49.7"> NS_IMPL_ISUPPORTS(nsAppleMailImportModule, nsIImportModule)</span>
<a href="#l49.8"></a><span id="l49.8"> </span>
<a href="#l49.9"></a><span id="l49.9"> </span>
<a href="#l49.10"></a><span id="l49.10"> NS_IMETHODIMP nsAppleMailImportModule::GetName(char16_t **aName)</span>
<a href="#l49.11"></a><span id="l49.11"> {</span>
<a href="#l49.12"></a><span id="l49.12" class="difflineminus">-  return mBundle ?</span>
<a href="#l49.13"></a><span id="l49.13" class="difflineminus">-    mBundle-&gt;GetStringFromName(&quot;ApplemailImportName&quot;, aName) : NS_ERROR_FAILURE;</span>
<a href="#l49.14"></a><span id="l49.14" class="difflineplus">+  if (!mBundle) {</span>
<a href="#l49.15"></a><span id="l49.15" class="difflineplus">+    return NS_ERROR_FAILURE;</span>
<a href="#l49.16"></a><span id="l49.16" class="difflineplus">+  }</span>
<a href="#l49.17"></a><span id="l49.17" class="difflineplus">+  nsAutoString name;</span>
<a href="#l49.18"></a><span id="l49.18" class="difflineplus">+  nsresult rv = mBundle-&gt;GetStringFromName(&quot;ApplemailImportName&quot;, name);</span>
<a href="#l49.19"></a><span id="l49.19" class="difflineplus">+  NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l49.20"></a><span id="l49.20" class="difflineplus">+  *aName = ToNewUnicode(name);</span>
<a href="#l49.21"></a><span id="l49.21" class="difflineplus">+  return rv;</span>
<a href="#l49.22"></a><span id="l49.22"> }</span>
<a href="#l49.23"></a><span id="l49.23"> </span>
<a href="#l49.24"></a><span id="l49.24"> NS_IMETHODIMP nsAppleMailImportModule::GetDescription(char16_t **aName)</span>
<a href="#l49.25"></a><span id="l49.25"> {</span>
<a href="#l49.26"></a><span id="l49.26" class="difflineminus">-  return mBundle ?</span>
<a href="#l49.27"></a><span id="l49.27" class="difflineminus">-    mBundle-&gt;GetStringFromName(&quot;ApplemailImportDescription&quot;, aName) : NS_ERROR_FAILURE;</span>
<a href="#l49.28"></a><span id="l49.28" class="difflineplus">+  if (!mBundle) {</span>
<a href="#l49.29"></a><span id="l49.29" class="difflineplus">+    return NS_ERROR_FAILURE;</span>
<a href="#l49.30"></a><span id="l49.30" class="difflineplus">+  }</span>
<a href="#l49.31"></a><span id="l49.31" class="difflineplus">+  nsAutoString name;</span>
<a href="#l49.32"></a><span id="l49.32" class="difflineplus">+  nsresult rv = mBundle-&gt;GetStringFromName(&quot;ApplemailImportDescription&quot;, name);</span>
<a href="#l49.33"></a><span id="l49.33" class="difflineplus">+  NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l49.34"></a><span id="l49.34" class="difflineplus">+  *aName = ToNewUnicode(name);</span>
<a href="#l49.35"></a><span id="l49.35" class="difflineplus">+  return rv;</span>
<a href="#l49.36"></a><span id="l49.36"> }</span>
<a href="#l49.37"></a><span id="l49.37"> </span>
<a href="#l49.38"></a><span id="l49.38"> NS_IMETHODIMP nsAppleMailImportModule::GetSupports(char **aSupports)</span>
<a href="#l49.39"></a><span id="l49.39"> {</span>
<a href="#l49.40"></a><span id="l49.40">   NS_ENSURE_ARG_POINTER(aSupports);</span>
<a href="#l49.41"></a><span id="l49.41">   *aSupports = strdup(NS_IMPORT_MAIL_STR);</span>
<a href="#l49.42"></a><span id="l49.42">   return NS_OK;</span>
<a href="#l49.43"></a><span id="l49.43"> }</span>
<a href="#l49.44"></a><span id="l49.44" class="difflineat">@@ -91,17 +103,17 @@ NS_IMETHODIMP nsAppleMailImportModule::G</span>
<a href="#l49.45"></a><span id="l49.45">     nsCOMPtr&lt;nsIImportMail&gt; mail(do_CreateInstance(NS_APPLEMAILIMPL_CONTRACTID, &amp;rv));</span>
<a href="#l49.46"></a><span id="l49.46">     if (NS_SUCCEEDED(rv)) {</span>
<a href="#l49.47"></a><span id="l49.47">       nsCOMPtr&lt;nsIImportService&gt; impSvc(do_GetService(NS_IMPORTSERVICE_CONTRACTID, &amp;rv));</span>
<a href="#l49.48"></a><span id="l49.48">       if (NS_SUCCEEDED(rv)) {</span>
<a href="#l49.49"></a><span id="l49.49">         nsCOMPtr&lt;nsIImportGeneric&gt; generic;</span>
<a href="#l49.50"></a><span id="l49.50">         rv = impSvc-&gt;CreateNewGenericMail(getter_AddRefs(generic));</span>
<a href="#l49.51"></a><span id="l49.51">         if (NS_SUCCEEDED(rv)) {</span>
<a href="#l49.52"></a><span id="l49.52">           nsAutoString name;</span>
<a href="#l49.53"></a><span id="l49.53" class="difflineminus">-          rv = mBundle-&gt;GetStringFromName(&quot;ApplemailImportName&quot;, getter_Copies(name));</span>
<a href="#l49.54"></a><span id="l49.54" class="difflineplus">+          rv = mBundle-&gt;GetStringFromName(&quot;ApplemailImportName&quot;, name);</span>
<a href="#l49.55"></a><span id="l49.55">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l49.56"></a><span id="l49.56"> </span>
<a href="#l49.57"></a><span id="l49.57">           nsCOMPtr&lt;nsISupportsString&gt; nameString(do_CreateInstance(NS_SUPPORTS_STRING_CONTRACTID, &amp;rv));</span>
<a href="#l49.58"></a><span id="l49.58">           NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l49.59"></a><span id="l49.59">           nameString-&gt;SetData(name);</span>
<a href="#l49.60"></a><span id="l49.60"> </span>
<a href="#l49.61"></a><span id="l49.61">           generic-&gt;SetData(&quot;name&quot;, nameString);</span>
<a href="#l49.62"></a><span id="l49.62">           generic-&gt;SetData(&quot;mailInterface&quot;, mail);</span>
<a href="#l49.63"></a><span id="l49.63" class="difflineat">@@ -582,17 +594,17 @@ nsAppleMailImportMail::ImportMailbox(nsI</span>
<a href="#l49.64"></a><span id="l49.64"> }</span>
<a href="#l49.65"></a><span id="l49.65"> </span>
<a href="#l49.66"></a><span id="l49.66"> void nsAppleMailImportMail::ReportStatus(const char16_t* aErrorName, nsString &amp;aName,</span>
<a href="#l49.67"></a><span id="l49.67">                                          nsAString &amp;aStream)</span>
<a href="#l49.68"></a><span id="l49.68"> {</span>
<a href="#l49.69"></a><span id="l49.69">   // get (and format, if needed) the error string from the bundle</span>
<a href="#l49.70"></a><span id="l49.70">   nsAutoString outString;</span>
<a href="#l49.71"></a><span id="l49.71">   const char16_t *fmt = { aName.get() };</span>
<a href="#l49.72"></a><span id="l49.72" class="difflineminus">-  nsresult rv = mBundle-&gt;FormatStringFromName(NS_ConvertUTF16toUTF8(aErrorName).get(), &amp;fmt, 1, getter_Copies(outString));</span>
<a href="#l49.73"></a><span id="l49.73" class="difflineplus">+  nsresult rv = mBundle-&gt;FormatStringFromName(NS_ConvertUTF16toUTF8(aErrorName).get(), &amp;fmt, 1, outString);</span>
<a href="#l49.74"></a><span id="l49.74">   // write it out the stream</span>
<a href="#l49.75"></a><span id="l49.75">   if (NS_SUCCEEDED(rv)) {</span>
<a href="#l49.76"></a><span id="l49.76">     aStream.Append(outString);</span>
<a href="#l49.77"></a><span id="l49.77">     aStream.Append(char16_t('\n'));</span>
<a href="#l49.78"></a><span id="l49.78">   }</span>
<a href="#l49.79"></a><span id="l49.79"> }</span>
<a href="#l49.80"></a><span id="l49.80"> </span>
<a href="#l49.81"></a><span id="l49.81"> void nsAppleMailImportMail::SetLogs(const nsAString &amp;aSuccess, const nsAString &amp;aError, char16_t **aOutSuccess, char16_t **aOutError)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/mailnews/import/becky/src/nsBeckyMail.cpp</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/mailnews/import/becky/src/nsBeckyMail.cpp</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -613,17 +613,17 @@ nsBeckyMail::ImportMailbox(nsIImportMail</span>
<a href="#l50.4"></a><span id="l50.4">   aSource-&gt;GetDisplayName(getter_Copies(name));</span>
<a href="#l50.5"></a><span id="l50.5"> </span>
<a href="#l50.6"></a><span id="l50.6">   nsAutoString successMessage;</span>
<a href="#l50.7"></a><span id="l50.7">   const char16_t *format = { name.get() };</span>
<a href="#l50.8"></a><span id="l50.8">   rv =</span>
<a href="#l50.9"></a><span id="l50.9">       nsBeckyStringBundle::FormatStringFromName(&quot;BeckyImportMailboxSuccess&quot;,</span>
<a href="#l50.10"></a><span id="l50.10">                                                 &amp;format,</span>
<a href="#l50.11"></a><span id="l50.11">                                                 1,</span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-                                                getter_Copies(successMessage));</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineplus">+                                                successMessage);</span>
<a href="#l50.14"></a><span id="l50.14">   successMessage.AppendLiteral(&quot;\n&quot;);</span>
<a href="#l50.15"></a><span id="l50.15">   *aSuccessLog = ToNewUnicode(successMessage);</span>
<a href="#l50.16"></a><span id="l50.16"> </span>
<a href="#l50.17"></a><span id="l50.17">   return rv;</span>
<a href="#l50.18"></a><span id="l50.18"> }</span>
<a href="#l50.19"></a><span id="l50.19"> </span>
<a href="#l50.20"></a><span id="l50.20"> NS_IMETHODIMP</span>
<a href="#l50.21"></a><span id="l50.21"> nsBeckyMail::GetImportProgress(uint32_t *_retval)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1" class="difflineminus">--- a/mailnews/import/becky/src/nsBeckyStringBundle.cpp</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineplus">+++ b/mailnews/import/becky/src/nsBeckyStringBundle.cpp</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineat">@@ -39,28 +39,30 @@ nsBeckyStringBundle::EnsureStringBundle(</span>
<a href="#l51.4"></a><span id="l51.4">     (void) GetStringBundle();</span>
<a href="#l51.5"></a><span id="l51.5"> }</span>
<a href="#l51.6"></a><span id="l51.6"> </span>
<a href="#l51.7"></a><span id="l51.7"> char16_t *</span>
<a href="#l51.8"></a><span id="l51.8"> nsBeckyStringBundle::GetStringByName(const char *aName)</span>
<a href="#l51.9"></a><span id="l51.9"> {</span>
<a href="#l51.10"></a><span id="l51.10">   EnsureStringBundle();</span>
<a href="#l51.11"></a><span id="l51.11"> </span>
<a href="#l51.12"></a><span id="l51.12" class="difflineminus">-  char16_t *string = nullptr;</span>
<a href="#l51.13"></a><span id="l51.13" class="difflineminus">-  if (mBundle)</span>
<a href="#l51.14"></a><span id="l51.14" class="difflineminus">-    mBundle-&gt;GetStringFromName(aName, &amp;string);</span>
<a href="#l51.15"></a><span id="l51.15" class="difflineplus">+  if (mBundle) {</span>
<a href="#l51.16"></a><span id="l51.16" class="difflineplus">+    nsAutoString string;</span>
<a href="#l51.17"></a><span id="l51.17" class="difflineplus">+    mBundle-&gt;GetStringFromName(aName, string);</span>
<a href="#l51.18"></a><span id="l51.18" class="difflineplus">+    return ToNewUnicode(string);</span>
<a href="#l51.19"></a><span id="l51.19" class="difflineplus">+  }</span>
<a href="#l51.20"></a><span id="l51.20"> </span>
<a href="#l51.21"></a><span id="l51.21" class="difflineminus">-  return string;</span>
<a href="#l51.22"></a><span id="l51.22" class="difflineplus">+  return nullptr;</span>
<a href="#l51.23"></a><span id="l51.23"> }</span>
<a href="#l51.24"></a><span id="l51.24"> </span>
<a href="#l51.25"></a><span id="l51.25"> nsresult</span>
<a href="#l51.26"></a><span id="l51.26"> nsBeckyStringBundle::FormatStringFromName(const char *name,</span>
<a href="#l51.27"></a><span id="l51.27">                                           const char16_t **params,</span>
<a href="#l51.28"></a><span id="l51.28">                                           uint32_t length,</span>
<a href="#l51.29"></a><span id="l51.29" class="difflineminus">-                                          char16_t **_retval)</span>
<a href="#l51.30"></a><span id="l51.30" class="difflineplus">+                                          nsAString&amp; _retval)</span>
<a href="#l51.31"></a><span id="l51.31"> {</span>
<a href="#l51.32"></a><span id="l51.32">   EnsureStringBundle();</span>
<a href="#l51.33"></a><span id="l51.33"> </span>
<a href="#l51.34"></a><span id="l51.34">   return mBundle-&gt;FormatStringFromName(name,</span>
<a href="#l51.35"></a><span id="l51.35">                                        params,</span>
<a href="#l51.36"></a><span id="l51.36">                                        length,</span>
<a href="#l51.37"></a><span id="l51.37">                                        _retval);</span>
<a href="#l51.38"></a><span id="l51.38"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1" class="difflineminus">--- a/mailnews/import/becky/src/nsBeckyStringBundle.h</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineplus">+++ b/mailnews/import/becky/src/nsBeckyStringBundle.h</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineat">@@ -9,17 +9,17 @@</span>
<a href="#l52.4"></a><span id="l52.4"> class nsIStringBundle;</span>
<a href="#l52.5"></a><span id="l52.5"> </span>
<a href="#l52.6"></a><span id="l52.6"> class nsBeckyStringBundle final {</span>
<a href="#l52.7"></a><span id="l52.7"> public:</span>
<a href="#l52.8"></a><span id="l52.8">   static char16_t *GetStringByName(const char *name);</span>
<a href="#l52.9"></a><span id="l52.9">   static nsresult FormatStringFromName(const char *name,</span>
<a href="#l52.10"></a><span id="l52.10">                                        const char16_t **params,</span>
<a href="#l52.11"></a><span id="l52.11">                                        uint32_t length,</span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">-                                       char16_t **_retval);</span>
<a href="#l52.13"></a><span id="l52.13" class="difflineplus">+                                       nsAString&amp; _retval);</span>
<a href="#l52.14"></a><span id="l52.14">   static nsIStringBundle * GetStringBundle(void); // don't release</span>
<a href="#l52.15"></a><span id="l52.15">   static void EnsureStringBundle(void);</span>
<a href="#l52.16"></a><span id="l52.16">   static void Cleanup(void);</span>
<a href="#l52.17"></a><span id="l52.17"> private:</span>
<a href="#l52.18"></a><span id="l52.18">   static nsIStringBundle *mBundle;</span>
<a href="#l52.19"></a><span id="l52.19"> };</span>
<a href="#l52.20"></a><span id="l52.20"> </span>
<a href="#l52.21"></a><span id="l52.21"> #define BECKYIMPORT_NAME                     2000</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/mailnews/import/src/nsImportMail.cpp</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/mailnews/import/src/nsImportMail.cpp</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -900,21 +900,20 @@ bool nsImportGenericMail::CreateFolder(n</span>
<a href="#l53.4"></a><span id="l53.4">   rv = bundleService-&gt;CreateBundle(IMPORT_MSGS_URL, getter_AddRefs(bundle));</span>
<a href="#l53.5"></a><span id="l53.5">   if (NS_FAILED(rv))</span>
<a href="#l53.6"></a><span id="l53.6">       return false;</span>
<a href="#l53.7"></a><span id="l53.7">   nsString folderName;</span>
<a href="#l53.8"></a><span id="l53.8">   if (!m_pName.IsEmpty()) {</span>
<a href="#l53.9"></a><span id="l53.9">     const char16_t *moduleName[] = { m_pName.get() };</span>
<a href="#l53.10"></a><span id="l53.10">     rv = bundle-&gt;FormatStringFromName(&quot;ImportModuleFolderName&quot;,</span>
<a href="#l53.11"></a><span id="l53.11">                                       moduleName, 1,</span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-                                      getter_Copies(folderName));</span>
<a href="#l53.13"></a><span id="l53.13" class="difflineplus">+                                      folderName);</span>
<a href="#l53.14"></a><span id="l53.14">   }</span>
<a href="#l53.15"></a><span id="l53.15">   else {</span>
<a href="#l53.16"></a><span id="l53.16" class="difflineminus">-    rv = bundle-&gt;GetStringFromName(&quot;DefaultFolderName&quot;,</span>
<a href="#l53.17"></a><span id="l53.17" class="difflineminus">-                                   getter_Copies(folderName));</span>
<a href="#l53.18"></a><span id="l53.18" class="difflineplus">+    rv = bundle-&gt;GetStringFromName(&quot;DefaultFolderName&quot;, folderName);</span>
<a href="#l53.19"></a><span id="l53.19">   }</span>
<a href="#l53.20"></a><span id="l53.20">   if (NS_FAILED(rv)) {</span>
<a href="#l53.21"></a><span id="l53.21">       IMPORT_LOG0(&quot;*** Failed to get Folder Name!\n&quot;);</span>
<a href="#l53.22"></a><span id="l53.22">       return false;</span>
<a href="#l53.23"></a><span id="l53.23">   }</span>
<a href="#l53.24"></a><span id="l53.24">   nsCOMPtr &lt;nsIMsgAccountManager&gt; accMgr = do_GetService(NS_MSGACCOUNTMANAGER_CONTRACTID, &amp;rv);</span>
<a href="#l53.25"></a><span id="l53.25">   if (NS_FAILED(rv)) {</span>
<a href="#l53.26"></a><span id="l53.26">     IMPORT_LOG0(&quot;*** Failed to create account manager!\n&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1" class="difflineminus">--- a/mailnews/import/src/nsImportStringBundle.cpp</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineplus">+++ b/mailnews/import/src/nsImportStringBundle.cpp</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineat">@@ -33,21 +33,20 @@ void nsImportStringBundle::GetStringByID</span>
<a href="#l54.4"></a><span id="l54.4">   aResult.Adopt(GetStringByID(aStringID, aBundle));</span>
<a href="#l54.5"></a><span id="l54.5"> }</span>
<a href="#l54.6"></a><span id="l54.6"> </span>
<a href="#l54.7"></a><span id="l54.7"> char16_t *nsImportStringBundle::GetStringByID(int32_t aStringID,</span>
<a href="#l54.8"></a><span id="l54.8">                                                nsIStringBundle *aBundle)</span>
<a href="#l54.9"></a><span id="l54.9"> {</span>
<a href="#l54.10"></a><span id="l54.10">   if (aBundle)</span>
<a href="#l54.11"></a><span id="l54.11">   {</span>
<a href="#l54.12"></a><span id="l54.12" class="difflineminus">-    char16_t *ptrv = nullptr;</span>
<a href="#l54.13"></a><span id="l54.13" class="difflineminus">-    nsresult rv = aBundle-&gt;GetStringFromID(aStringID, &amp;ptrv);</span>
<a href="#l54.14"></a><span id="l54.14" class="difflineminus">-</span>
<a href="#l54.15"></a><span id="l54.15" class="difflineminus">-    if (NS_SUCCEEDED(rv) &amp;&amp; ptrv)</span>
<a href="#l54.16"></a><span id="l54.16" class="difflineminus">-      return ptrv;</span>
<a href="#l54.17"></a><span id="l54.17" class="difflineplus">+    nsAutoString str;</span>
<a href="#l54.18"></a><span id="l54.18" class="difflineplus">+    nsresult rv = aBundle-&gt;GetStringFromID(aStringID, str);</span>
<a href="#l54.19"></a><span id="l54.19" class="difflineplus">+    if (NS_SUCCEEDED(rv))</span>
<a href="#l54.20"></a><span id="l54.20" class="difflineplus">+      return ToNewUnicode(str);</span>
<a href="#l54.21"></a><span id="l54.21">   }</span>
<a href="#l54.22"></a><span id="l54.22"> </span>
<a href="#l54.23"></a><span id="l54.23">   nsString resultString(NS_LITERAL_STRING(&quot;[StringID &quot;));</span>
<a href="#l54.24"></a><span id="l54.24">   resultString.AppendInt(aStringID);</span>
<a href="#l54.25"></a><span id="l54.25">   resultString.AppendLiteral(&quot;?]&quot;);</span>
<a href="#l54.26"></a><span id="l54.26"> </span>
<a href="#l54.27"></a><span id="l54.27">   return ToNewUnicode(resultString);</span>
<a href="#l54.28"></a><span id="l54.28"> }</span>
<a href="#l54.29"></a><span id="l54.29" class="difflineat">@@ -59,21 +58,20 @@ void nsImportStringBundle::GetStringByNa</span>
<a href="#l54.30"></a><span id="l54.30">   aResult.Adopt(GetStringByName(aName, aBundle));</span>
<a href="#l54.31"></a><span id="l54.31"> }</span>
<a href="#l54.32"></a><span id="l54.32"> </span>
<a href="#l54.33"></a><span id="l54.33"> char16_t *nsImportStringBundle::GetStringByName(const char *aName,</span>
<a href="#l54.34"></a><span id="l54.34">                                                  nsIStringBundle *aBundle)</span>
<a href="#l54.35"></a><span id="l54.35"> {</span>
<a href="#l54.36"></a><span id="l54.36">   if (aBundle)</span>
<a href="#l54.37"></a><span id="l54.37">   {</span>
<a href="#l54.38"></a><span id="l54.38" class="difflineminus">-    char16_t *ptrv = nullptr;</span>
<a href="#l54.39"></a><span id="l54.39" class="difflineminus">-    nsresult rv = aBundle-&gt;GetStringFromName(aName, &amp;ptrv);</span>
<a href="#l54.40"></a><span id="l54.40" class="difflineminus">-</span>
<a href="#l54.41"></a><span id="l54.41" class="difflineminus">-    if (NS_SUCCEEDED(rv) &amp;&amp; ptrv)</span>
<a href="#l54.42"></a><span id="l54.42" class="difflineminus">-      return ptrv;</span>
<a href="#l54.43"></a><span id="l54.43" class="difflineplus">+    nsAutoString str;</span>
<a href="#l54.44"></a><span id="l54.44" class="difflineplus">+    nsresult rv = aBundle-&gt;GetStringFromName(aName, str);</span>
<a href="#l54.45"></a><span id="l54.45" class="difflineplus">+    if (NS_SUCCEEDED(rv))</span>
<a href="#l54.46"></a><span id="l54.46" class="difflineplus">+      return ToNewUnicode(str);</span>
<a href="#l54.47"></a><span id="l54.47">   }</span>
<a href="#l54.48"></a><span id="l54.48"> </span>
<a href="#l54.49"></a><span id="l54.49">   nsString resultString(NS_LITERAL_STRING(&quot;[StringName &quot;));</span>
<a href="#l54.50"></a><span id="l54.50">   resultString.Append(NS_ConvertUTF8toUTF16(aName).get());</span>
<a href="#l54.51"></a><span id="l54.51">   resultString.AppendLiteral(&quot;?]&quot;);</span>
<a href="#l54.52"></a><span id="l54.52"> </span>
<a href="#l54.53"></a><span id="l54.53">   return ToNewUnicode(resultString);</span>
<a href="#l54.54"></a><span id="l54.54"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1" class="difflineminus">--- a/mailnews/intl/nsCharsetConverterManager.cpp</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineplus">+++ b/mailnews/intl/nsCharsetConverterManager.cpp</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineat">@@ -52,20 +52,20 @@ nsresult LoadExtensibleBundle(const char</span>
<a href="#l55.4"></a><span id="l55.4">     mozilla::services::GetStringBundleService();</span>
<a href="#l55.5"></a><span id="l55.5">   if (!sbServ)</span>
<a href="#l55.6"></a><span id="l55.6">     return NS_ERROR_FAILURE;</span>
<a href="#l55.7"></a><span id="l55.7"> </span>
<a href="#l55.8"></a><span id="l55.8">   return sbServ-&gt;CreateExtensibleBundle(aCategory, aResult);</span>
<a href="#l55.9"></a><span id="l55.9"> }</span>
<a href="#l55.10"></a><span id="l55.10"> </span>
<a href="#l55.11"></a><span id="l55.11"> static</span>
<a href="#l55.12"></a><span id="l55.12" class="difflineminus">-nsresult GetBundleValue(nsIStringBundle * aBundle,</span>
<a href="#l55.13"></a><span id="l55.13" class="difflineplus">+nsresult GetBundleValueInner(nsIStringBundle * aBundle,</span>
<a href="#l55.14"></a><span id="l55.14">                         const char * aName,</span>
<a href="#l55.15"></a><span id="l55.15">                         const nsString&amp; aProp,</span>
<a href="#l55.16"></a><span id="l55.16" class="difflineminus">-                        char16_t ** aResult)</span>
<a href="#l55.17"></a><span id="l55.17" class="difflineplus">+                        nsAString&amp; aResult)</span>
<a href="#l55.18"></a><span id="l55.18"> {</span>
<a href="#l55.19"></a><span id="l55.19">   nsAutoString key;</span>
<a href="#l55.20"></a><span id="l55.20"> </span>
<a href="#l55.21"></a><span id="l55.21">   CopyASCIItoUTF16(aName, key);</span>
<a href="#l55.22"></a><span id="l55.22">   ToLowerCase(key); // we lowercase the main comparison key</span>
<a href="#l55.23"></a><span id="l55.23">   key.Append(aProp);</span>
<a href="#l55.24"></a><span id="l55.24"> </span>
<a href="#l55.25"></a><span id="l55.25">   return aBundle-&gt;GetStringFromName(NS_ConvertUTF16toUTF8(key).get(), aResult);</span>
<a href="#l55.26"></a><span id="l55.26" class="difflineat">@@ -74,18 +74,18 @@ nsresult GetBundleValue(nsIStringBundle </span>
<a href="#l55.27"></a><span id="l55.27"> static</span>
<a href="#l55.28"></a><span id="l55.28"> nsresult GetBundleValue(nsIStringBundle * aBundle,</span>
<a href="#l55.29"></a><span id="l55.29">                         const char * aName,</span>
<a href="#l55.30"></a><span id="l55.30">                         const nsString&amp; aProp,</span>
<a href="#l55.31"></a><span id="l55.31">                         nsAString&amp; aResult)</span>
<a href="#l55.32"></a><span id="l55.32"> {</span>
<a href="#l55.33"></a><span id="l55.33">   nsresult rv = NS_OK;</span>
<a href="#l55.34"></a><span id="l55.34"> </span>
<a href="#l55.35"></a><span id="l55.35" class="difflineminus">-  nsXPIDLString value;</span>
<a href="#l55.36"></a><span id="l55.36" class="difflineminus">-  rv = GetBundleValue(aBundle, aName, aProp, getter_Copies(value));</span>
<a href="#l55.37"></a><span id="l55.37" class="difflineplus">+  nsAutoString value;</span>
<a href="#l55.38"></a><span id="l55.38" class="difflineplus">+  rv = GetBundleValueInner(aBundle, aName, aProp, value);</span>
<a href="#l55.39"></a><span id="l55.39">   if (NS_FAILED(rv))</span>
<a href="#l55.40"></a><span id="l55.40">     return rv;</span>
<a href="#l55.41"></a><span id="l55.41"> </span>
<a href="#l55.42"></a><span id="l55.42">   aResult = value;</span>
<a href="#l55.43"></a><span id="l55.43"> </span>
<a href="#l55.44"></a><span id="l55.44">   return NS_OK;</span>
<a href="#l55.45"></a><span id="l55.45"> }</span>
<a href="#l55.46"></a><span id="l55.46"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1" class="difflineminus">--- a/mailnews/local/src/nsLocalMailFolder.cpp</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineplus">+++ b/mailnews/local/src/nsLocalMailFolder.cpp</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineat">@@ -843,29 +843,29 @@ nsresult nsMsgLocalMailFolder::ConfirmFo</span>
<a href="#l56.4"></a><span id="l56.4">       nsAutoString folderName;</span>
<a href="#l56.5"></a><span id="l56.5">       rv = aFolder-&gt;GetName(folderName);</span>
<a href="#l56.6"></a><span id="l56.6">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l56.7"></a><span id="l56.7">       const char16_t *formatStrings[1] = { folderName.get() };</span>
<a href="#l56.8"></a><span id="l56.8"> </span>
<a href="#l56.9"></a><span id="l56.9">       nsAutoString deleteFolderDialogTitle;</span>
<a href="#l56.10"></a><span id="l56.10">       rv = bundle-&gt;GetStringFromName(</span>
<a href="#l56.11"></a><span id="l56.11">         &quot;pop3DeleteFolderDialogTitle&quot;,</span>
<a href="#l56.12"></a><span id="l56.12" class="difflineminus">-        getter_Copies(deleteFolderDialogTitle));</span>
<a href="#l56.13"></a><span id="l56.13" class="difflineplus">+        deleteFolderDialogTitle);</span>
<a href="#l56.14"></a><span id="l56.14">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l56.15"></a><span id="l56.15"> </span>
<a href="#l56.16"></a><span id="l56.16">       nsAutoString deleteFolderButtonLabel;</span>
<a href="#l56.17"></a><span id="l56.17">       rv = bundle-&gt;GetStringFromName(</span>
<a href="#l56.18"></a><span id="l56.18">         &quot;pop3DeleteFolderButtonLabel&quot;,</span>
<a href="#l56.19"></a><span id="l56.19" class="difflineminus">-        getter_Copies(deleteFolderButtonLabel));</span>
<a href="#l56.20"></a><span id="l56.20" class="difflineplus">+        deleteFolderButtonLabel);</span>
<a href="#l56.21"></a><span id="l56.21">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l56.22"></a><span id="l56.22"> </span>
<a href="#l56.23"></a><span id="l56.23">       nsAutoString confirmationStr;</span>
<a href="#l56.24"></a><span id="l56.24">       rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l56.25"></a><span id="l56.25">         &quot;pop3MoveFolderToTrash&quot;, formatStrings, 1,</span>
<a href="#l56.26"></a><span id="l56.26" class="difflineminus">-        getter_Copies(confirmationStr));</span>
<a href="#l56.27"></a><span id="l56.27" class="difflineplus">+        confirmationStr);</span>
<a href="#l56.28"></a><span id="l56.28">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l56.29"></a><span id="l56.29"> </span>
<a href="#l56.30"></a><span id="l56.30">       nsCOMPtr&lt;nsIPrompt&gt; dialog(do_GetInterface(docShell));</span>
<a href="#l56.31"></a><span id="l56.31">       if (dialog)</span>
<a href="#l56.32"></a><span id="l56.32">       {</span>
<a href="#l56.33"></a><span id="l56.33">         int32_t buttonPressed = 0;</span>
<a href="#l56.34"></a><span id="l56.34">         // Default the dialog to &quot;cancel&quot;.</span>
<a href="#l56.35"></a><span id="l56.35">         const uint32_t buttonFlags =</span>
<a href="#l56.36"></a><span id="l56.36" class="difflineat">@@ -3342,17 +3342,17 @@ nsresult nsMsgLocalMailFolder::DisplayMo</span>
<a href="#l56.37"></a><span id="l56.37">       nsAutoString totalMessagesString;</span>
<a href="#l56.38"></a><span id="l56.38">       totalMessagesString.AppendInt(mCopyState-&gt;m_totalMsgCount);</span>
<a href="#l56.39"></a><span id="l56.39">       nsString finalString;</span>
<a href="#l56.40"></a><span id="l56.40">       const char16_t * stringArray[] = { numMsgSoFarString.get(), totalMessagesString.get(), folderName.get() };</span>
<a href="#l56.41"></a><span id="l56.41">       rv = mCopyState-&gt;m_stringBundle-&gt;FormatStringFromName(</span>
<a href="#l56.42"></a><span id="l56.42">         (mCopyState-&gt;m_isMove) ?</span>
<a href="#l56.43"></a><span id="l56.43">         &quot;movingMessagesStatus&quot; :</span>
<a href="#l56.44"></a><span id="l56.44">         &quot;copyingMessagesStatus&quot;,</span>
<a href="#l56.45"></a><span id="l56.45" class="difflineminus">-        stringArray, 3, getter_Copies(finalString));</span>
<a href="#l56.46"></a><span id="l56.46" class="difflineplus">+        stringArray, 3, finalString);</span>
<a href="#l56.47"></a><span id="l56.47">       int64_t nowMS = PR_IntervalToMilliseconds(PR_IntervalNow());</span>
<a href="#l56.48"></a><span id="l56.48"> </span>
<a href="#l56.49"></a><span id="l56.49">       // only update status/progress every half second</span>
<a href="#l56.50"></a><span id="l56.50">       if (nowMS - mCopyState-&gt;m_lastProgressTime &lt; 500 &amp;&amp;</span>
<a href="#l56.51"></a><span id="l56.51">           mCopyState-&gt;m_curCopyIndex &lt; mCopyState-&gt;m_totalMsgCount)</span>
<a href="#l56.52"></a><span id="l56.52">         return NS_OK;</span>
<a href="#l56.53"></a><span id="l56.53"> </span>
<a href="#l56.54"></a><span id="l56.54">       mCopyState-&gt;m_lastProgressTime = nowMS;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l57.1"></a><span id="l57.1" class="difflineminus">--- a/mailnews/local/src/nsMovemailService.cpp</span>
<a href="#l57.2"></a><span id="l57.2" class="difflineplus">+++ b/mailnews/local/src/nsMovemailService.cpp</span>
<a href="#l57.3"></a><span id="l57.3" class="difflineat">@@ -133,20 +133,19 @@ nsMovemailService::Error(const char* err</span>
<a href="#l57.4"></a><span id="l57.4">   rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/localMsgs.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l57.5"></a><span id="l57.5">   if (NS_FAILED(rv))</span>
<a href="#l57.6"></a><span id="l57.6">     return;</span>
<a href="#l57.7"></a><span id="l57.7"> </span>
<a href="#l57.8"></a><span id="l57.8">   nsString errStr;</span>
<a href="#l57.9"></a><span id="l57.9">   // Format the error string if necessary</span>
<a href="#l57.10"></a><span id="l57.10">   if (params)</span>
<a href="#l57.11"></a><span id="l57.11">     bundle-&gt;FormatStringFromName(errorCode,</span>
<a href="#l57.12"></a><span id="l57.12" class="difflineminus">-                                 params, length, getter_Copies(errStr));</span>
<a href="#l57.13"></a><span id="l57.13" class="difflineplus">+                                 params, length, errStr);</span>
<a href="#l57.14"></a><span id="l57.14">   else</span>
<a href="#l57.15"></a><span id="l57.15" class="difflineminus">-    bundle-&gt;GetStringFromName(errorCode,</span>
<a href="#l57.16"></a><span id="l57.16" class="difflineminus">-                              getter_Copies(errStr));</span>
<a href="#l57.17"></a><span id="l57.17" class="difflineplus">+    bundle-&gt;GetStringFromName(errorCode, errStr);</span>
<a href="#l57.18"></a><span id="l57.18"> </span>
<a href="#l57.19"></a><span id="l57.19">   if (!errStr.IsEmpty()) {</span>
<a href="#l57.20"></a><span id="l57.20">     dialog-&gt;Alert(nullptr, errStr.get());</span>
<a href="#l57.21"></a><span id="l57.21">   }</span>
<a href="#l57.22"></a><span id="l57.22"> }</span>
<a href="#l57.23"></a><span id="l57.23"> </span>
<a href="#l57.24"></a><span id="l57.24"> SpoolLock::SpoolLock(nsACString *aSpoolName, int aSeconds,</span>
<a href="#l57.25"></a><span id="l57.25">                      nsMovemailService &amp;aMovemail,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l58.1"></a><span id="l58.1" class="difflineminus">--- a/mailnews/local/src/nsParseMailbox.cpp</span>
<a href="#l58.2"></a><span id="l58.2" class="difflineplus">+++ b/mailnews/local/src/nsParseMailbox.cpp</span>
<a href="#l58.3"></a><span id="l58.3" class="difflineat">@@ -290,17 +290,17 @@ void nsMsgMailboxParser::UpdateStatusTex</span>
<a href="#l58.4"></a><span id="l58.4">       return;</span>
<a href="#l58.5"></a><span id="l58.5">     nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l58.6"></a><span id="l58.6">     rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/localMsgs.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l58.7"></a><span id="l58.7">     if (NS_FAILED(rv))</span>
<a href="#l58.8"></a><span id="l58.8">       return;</span>
<a href="#l58.9"></a><span id="l58.9">     nsString finalString;</span>
<a href="#l58.10"></a><span id="l58.10">     const char16_t * stringArray[] = { m_folderName.get() };</span>
<a href="#l58.11"></a><span id="l58.11">     rv = bundle-&gt;FormatStringFromName(stringName,</span>
<a href="#l58.12"></a><span id="l58.12" class="difflineminus">-                                      stringArray, 1, getter_Copies(finalString));</span>
<a href="#l58.13"></a><span id="l58.13" class="difflineplus">+                                      stringArray, 1, finalString);</span>
<a href="#l58.14"></a><span id="l58.14">     m_statusFeedback-&gt;ShowStatusString(finalString);</span>
<a href="#l58.15"></a><span id="l58.15">   }</span>
<a href="#l58.16"></a><span id="l58.16"> }</span>
<a href="#l58.17"></a><span id="l58.17"> </span>
<a href="#l58.18"></a><span id="l58.18"> void nsMsgMailboxParser::UpdateProgressPercent ()</span>
<a href="#l58.19"></a><span id="l58.19"> {</span>
<a href="#l58.20"></a><span id="l58.20">   if (m_statusFeedback &amp;&amp; m_graph_progress_total != 0)</span>
<a href="#l58.21"></a><span id="l58.21">   {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l59.1"></a><span id="l59.1" class="difflineminus">--- a/mailnews/local/src/nsPop3Protocol.cpp</span>
<a href="#l59.2"></a><span id="l59.2" class="difflineplus">+++ b/mailnews/local/src/nsPop3Protocol.cpp</span>
<a href="#l59.3"></a><span id="l59.3" class="difflineat">@@ -650,23 +650,23 @@ nsresult nsPop3Protocol::FormatCounterSt</span>
<a href="#l59.4"></a><span id="l59.4"> </span>
<a href="#l59.5"></a><span id="l59.5">   const char16_t *formatStrings[] = {</span>
<a href="#l59.6"></a><span id="l59.6">     count1String.get(),</span>
<a href="#l59.7"></a><span id="l59.7">     count2String.get()</span>
<a href="#l59.8"></a><span id="l59.8">   };</span>
<a href="#l59.9"></a><span id="l59.9"> </span>
<a href="#l59.10"></a><span id="l59.10">   return mLocalBundle-&gt;FormatStringFromName(NS_ConvertUTF16toUTF8(stringName).get(),</span>
<a href="#l59.11"></a><span id="l59.11">                                             formatStrings, 2,</span>
<a href="#l59.12"></a><span id="l59.12" class="difflineminus">-                                            getter_Copies(resultString));</span>
<a href="#l59.13"></a><span id="l59.13" class="difflineplus">+                                            resultString);</span>
<a href="#l59.14"></a><span id="l59.14"> }</span>
<a href="#l59.15"></a><span id="l59.15"> </span>
<a href="#l59.16"></a><span id="l59.16"> void nsPop3Protocol::UpdateStatus(const char *aStatusName)</span>
<a href="#l59.17"></a><span id="l59.17"> {</span>
<a href="#l59.18"></a><span id="l59.18">   nsString statusMessage;</span>
<a href="#l59.19"></a><span id="l59.19" class="difflineminus">-  mLocalBundle-&gt;GetStringFromName(aStatusName, getter_Copies(statusMessage));</span>
<a href="#l59.20"></a><span id="l59.20" class="difflineplus">+  mLocalBundle-&gt;GetStringFromName(aStatusName, statusMessage);</span>
<a href="#l59.21"></a><span id="l59.21">   UpdateStatusWithString(statusMessage.get());</span>
<a href="#l59.22"></a><span id="l59.22"> }</span>
<a href="#l59.23"></a><span id="l59.23"> </span>
<a href="#l59.24"></a><span id="l59.24"> void nsPop3Protocol::UpdateStatusWithString(const char16_t *aStatusString)</span>
<a href="#l59.25"></a><span id="l59.25"> {</span>
<a href="#l59.26"></a><span id="l59.26">     if (mProgressEventSink)</span>
<a href="#l59.27"></a><span id="l59.27">     {</span>
<a href="#l59.28"></a><span id="l59.28">       mozilla::DebugOnly&lt;nsresult&gt; rv =</span>
<a href="#l59.29"></a><span id="l59.29" class="difflineat">@@ -881,29 +881,29 @@ NS_IMETHODIMP nsPop3Protocol::OnPromptSt</span>
<a href="#l59.30"></a><span id="l59.30">           // again.</span>
<a href="#l59.31"></a><span id="l59.31">           ProcessProtocolState(nullptr, nullptr, 0, 0);</span>
<a href="#l59.32"></a><span id="l59.32">           return NS_OK;</span>
<a href="#l59.33"></a><span id="l59.33">         }</span>
<a href="#l59.34"></a><span id="l59.34">       }</span>
<a href="#l59.35"></a><span id="l59.35">     }</span>
<a href="#l59.36"></a><span id="l59.36">     mLocalBundle-&gt;FormatStringFromName(</span>
<a href="#l59.37"></a><span id="l59.37">       &quot;pop3PreviouslyEnteredPasswordIsInvalidPrompt&quot;,</span>
<a href="#l59.38"></a><span id="l59.38" class="difflineminus">-      passwordParams, 2, getter_Copies(passwordPrompt));</span>
<a href="#l59.39"></a><span id="l59.39" class="difflineplus">+      passwordParams, 2, passwordPrompt);</span>
<a href="#l59.40"></a><span id="l59.40">   }</span>
<a href="#l59.41"></a><span id="l59.41">   else</span>
<a href="#l59.42"></a><span id="l59.42">     // Otherwise this is the first time we've asked about the server's</span>
<a href="#l59.43"></a><span id="l59.43">     // password so show a first time prompt.</span>
<a href="#l59.44"></a><span id="l59.44">     mLocalBundle-&gt;FormatStringFromName(</span>
<a href="#l59.45"></a><span id="l59.45">       &quot;pop3EnterPasswordPrompt&quot;,</span>
<a href="#l59.46"></a><span id="l59.46" class="difflineminus">-      passwordParams, 2, getter_Copies(passwordPrompt));</span>
<a href="#l59.47"></a><span id="l59.47" class="difflineplus">+      passwordParams, 2, passwordPrompt);</span>
<a href="#l59.48"></a><span id="l59.48"> </span>
<a href="#l59.49"></a><span id="l59.49">   nsString passwordTitle;</span>
<a href="#l59.50"></a><span id="l59.50">   mLocalBundle-&gt;GetStringFromName(</span>
<a href="#l59.51"></a><span id="l59.51">     &quot;pop3EnterPasswordPromptTitle&quot;,</span>
<a href="#l59.52"></a><span id="l59.52" class="difflineminus">-    getter_Copies(passwordTitle));</span>
<a href="#l59.53"></a><span id="l59.53" class="difflineplus">+    passwordTitle);</span>
<a href="#l59.54"></a><span id="l59.54"> </span>
<a href="#l59.55"></a><span id="l59.55">   // Now go and get the password.</span>
<a href="#l59.56"></a><span id="l59.56">   if (!passwordPrompt.IsEmpty() &amp;&amp; !passwordTitle.IsEmpty())</span>
<a href="#l59.57"></a><span id="l59.57">     rv = server-&gt;GetPasswordWithUI(passwordPrompt, passwordTitle,</span>
<a href="#l59.58"></a><span id="l59.58">                                     msgWindow, passwordResult);</span>
<a href="#l59.59"></a><span id="l59.59">   ClearFlag(POP3_PASSWORD_FAILED|POP3_AUTH_FAILURE);</span>
<a href="#l59.60"></a><span id="l59.60"> </span>
<a href="#l59.61"></a><span id="l59.61">   // If it failed or the user cancelled the prompt, just abort the</span>
<a href="#l59.62"></a><span id="l59.62" class="difflineat">@@ -1317,37 +1317,36 @@ nsPop3Protocol::Error(const char* err_co</span>
<a href="#l59.63"></a><span id="l59.63">     nsCOMPtr&lt;nsIMsgIncomingServer&gt; server = do_QueryInterface(m_pop3Server);</span>
<a href="#l59.64"></a><span id="l59.64">     nsString accountName;</span>
<a href="#l59.65"></a><span id="l59.65">     nsresult rv = server-&gt;GetPrettyName(accountName);</span>
<a href="#l59.66"></a><span id="l59.66">     NS_ENSURE_SUCCESS(rv, -1);</span>
<a href="#l59.67"></a><span id="l59.67">     const char16_t *titleParams[] = { accountName.get() };</span>
<a href="#l59.68"></a><span id="l59.68">     nsString dialogTitle;</span>
<a href="#l59.69"></a><span id="l59.69">     mLocalBundle-&gt;FormatStringFromName(</span>
<a href="#l59.70"></a><span id="l59.70">       &quot;pop3ErrorDialogTitle&quot;,</span>
<a href="#l59.71"></a><span id="l59.71" class="difflineminus">-      titleParams, 1, getter_Copies(dialogTitle));</span>
<a href="#l59.72"></a><span id="l59.72" class="difflineplus">+      titleParams, 1, dialogTitle);</span>
<a href="#l59.73"></a><span id="l59.73">     nsCOMPtr&lt;nsIMsgMailNewsUrl&gt; mailnewsUrl = do_QueryInterface(m_url, &amp;rv);</span>
<a href="#l59.74"></a><span id="l59.74">     // we handle &quot;pop3TmpDownloadError&quot; earlier...</span>
<a href="#l59.75"></a><span id="l59.75">     if (strcmp(err_code, &quot;pop3TmpDownloadError&quot;) &amp;&amp; NS_SUCCEEDED(rv))</span>
<a href="#l59.76"></a><span id="l59.76">     {</span>
<a href="#l59.77"></a><span id="l59.77">         nsCOMPtr&lt;nsIMsgWindow&gt; msgWindow;</span>
<a href="#l59.78"></a><span id="l59.78">         nsCOMPtr&lt;nsIPrompt&gt; dialog;</span>
<a href="#l59.79"></a><span id="l59.79">         rv = mailnewsUrl-&gt;GetMsgWindow(getter_AddRefs(msgWindow)); //it is ok to have null msgWindow, for example when biffing</span>
<a href="#l59.80"></a><span id="l59.80">         if (NS_SUCCEEDED(rv) &amp;&amp; msgWindow)</span>
<a href="#l59.81"></a><span id="l59.81">         {</span>
<a href="#l59.82"></a><span id="l59.82">             rv = msgWindow-&gt;GetPromptDialog(getter_AddRefs(dialog));</span>
<a href="#l59.83"></a><span id="l59.83">             if (NS_SUCCEEDED(rv))</span>
<a href="#l59.84"></a><span id="l59.84">             {</span>
<a href="#l59.85"></a><span id="l59.85">               nsString alertString;</span>
<a href="#l59.86"></a><span id="l59.86">               // Format the alert string if parameter list isn't empty</span>
<a href="#l59.87"></a><span id="l59.87">               if (params)</span>
<a href="#l59.88"></a><span id="l59.88">                 mLocalBundle-&gt;FormatStringFromName(err_code,</span>
<a href="#l59.89"></a><span id="l59.89" class="difflineminus">-                                                   params, length, getter_Copies(alertString));</span>
<a href="#l59.90"></a><span id="l59.90" class="difflineplus">+                                                   params, length, alertString);</span>
<a href="#l59.91"></a><span id="l59.91">               else</span>
<a href="#l59.92"></a><span id="l59.92" class="difflineminus">-                mLocalBundle-&gt;GetStringFromName(err_code,</span>
<a href="#l59.93"></a><span id="l59.93" class="difflineminus">-                                                getter_Copies(alertString));</span>
<a href="#l59.94"></a><span id="l59.94" class="difflineplus">+                mLocalBundle-&gt;GetStringFromName(err_code, alertString);</span>
<a href="#l59.95"></a><span id="l59.95">               if (m_pop3ConData-&gt;command_succeeded)  //not a server error message</span>
<a href="#l59.96"></a><span id="l59.96">                 dialog-&gt;Alert(dialogTitle.get(), alertString.get());</span>
<a href="#l59.97"></a><span id="l59.97">               else</span>
<a href="#l59.98"></a><span id="l59.98">               {</span>
<a href="#l59.99"></a><span id="l59.99">                 nsString serverSaidPrefix;</span>
<a href="#l59.100"></a><span id="l59.100">                 nsCOMPtr&lt;nsIMsgIncomingServer&gt; server = do_QueryInterface(m_pop3Server);</span>
<a href="#l59.101"></a><span id="l59.101">                 nsCString hostName;</span>
<a href="#l59.102"></a><span id="l59.102">                 // Fomat string with hostname.</span>
<a href="#l59.103"></a><span id="l59.103" class="difflineat">@@ -1355,17 +1354,17 @@ nsPop3Protocol::Error(const char* err_co</span>
<a href="#l59.104"></a><span id="l59.104">                   rv = server-&gt;GetRealHostName(hostName);</span>
<a href="#l59.105"></a><span id="l59.105">                 if (NS_SUCCEEDED(rv))</span>
<a href="#l59.106"></a><span id="l59.106">                 {</span>
<a href="#l59.107"></a><span id="l59.107">                   nsAutoString hostStr;</span>
<a href="#l59.108"></a><span id="l59.108">                   CopyASCIItoUTF16(hostName, hostStr);</span>
<a href="#l59.109"></a><span id="l59.109">                   const char16_t *params[] = { hostStr.get() };</span>
<a href="#l59.110"></a><span id="l59.110">                   mLocalBundle-&gt;FormatStringFromName(</span>
<a href="#l59.111"></a><span id="l59.111">                     &quot;pop3ServerSaid&quot;,</span>
<a href="#l59.112"></a><span id="l59.112" class="difflineminus">-                    params, 1, getter_Copies(serverSaidPrefix));</span>
<a href="#l59.113"></a><span id="l59.113" class="difflineplus">+                    params, 1, serverSaidPrefix);</span>
<a href="#l59.114"></a><span id="l59.114">                 }</span>
<a href="#l59.115"></a><span id="l59.115"> </span>
<a href="#l59.116"></a><span id="l59.116">                 nsAutoString message(alertString);</span>
<a href="#l59.117"></a><span id="l59.117">                 message.AppendLiteral(&quot; &quot;);</span>
<a href="#l59.118"></a><span id="l59.118">                 message.Append(serverSaidPrefix);</span>
<a href="#l59.119"></a><span id="l59.119">                 message.AppendLiteral(&quot; &quot;);</span>
<a href="#l59.120"></a><span id="l59.120">                 message.Append(NS_ConvertASCIItoUTF16(m_commandResponse));</span>
<a href="#l59.121"></a><span id="l59.121">                 dialog-&gt;Alert(dialogTitle.get(), message.get());</span>
<a href="#l59.122"></a><span id="l59.122" class="difflineat">@@ -3504,17 +3503,17 @@ nsPop3Protocol::TopResponse(nsIInputStre</span>
<a href="#l59.123"></a><span id="l59.123"> </span>
<a href="#l59.124"></a><span id="l59.124">     Note that the progress bar will not be accurate in this case.</span>
<a href="#l59.125"></a><span id="l59.125">     Oops. #### */</span>
<a href="#l59.126"></a><span id="l59.126">     m_pop3ConData-&gt;truncating_cur_msg = false;</span>
<a href="#l59.127"></a><span id="l59.127"> </span>
<a href="#l59.128"></a><span id="l59.128">     nsString statusTemplate;</span>
<a href="#l59.129"></a><span id="l59.129">     mLocalBundle-&gt;GetStringFromName(</span>
<a href="#l59.130"></a><span id="l59.130">       &quot;pop3ServerDoesNotSupportTopCommand&quot;,</span>
<a href="#l59.131"></a><span id="l59.131" class="difflineminus">-      getter_Copies(statusTemplate));</span>
<a href="#l59.132"></a><span id="l59.132" class="difflineplus">+      statusTemplate);</span>
<a href="#l59.133"></a><span id="l59.133">     if (!statusTemplate.IsEmpty())</span>
<a href="#l59.134"></a><span id="l59.134">     {</span>
<a href="#l59.135"></a><span id="l59.135">       nsAutoCString hostName;</span>
<a href="#l59.136"></a><span id="l59.136">       char16_t * statusString = nullptr;</span>
<a href="#l59.137"></a><span id="l59.137">       m_url-&gt;GetHost(hostName);</span>
<a href="#l59.138"></a><span id="l59.138"> </span>
<a href="#l59.139"></a><span id="l59.139">       statusString = nsTextFormatter::smprintf(statusTemplate.get(), hostName.get());</span>
<a href="#l59.140"></a><span id="l59.140">       UpdateStatusWithString(statusString);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l60.1"></a><span id="l60.1" class="difflineminus">--- a/mailnews/local/src/nsPop3Service.cpp</span>
<a href="#l60.2"></a><span id="l60.2" class="difflineplus">+++ b/mailnews/local/src/nsPop3Service.cpp</span>
<a href="#l60.3"></a><span id="l60.3" class="difflineat">@@ -462,20 +462,20 @@ void nsPop3Service::AlertServerBusy(nsIM</span>
<a href="#l60.4"></a><span id="l60.4">   rv = server-&gt;GetPrettyName(accountName);</span>
<a href="#l60.5"></a><span id="l60.5">   NS_ENSURE_SUCCESS_VOID(rv);</span>
<a href="#l60.6"></a><span id="l60.6"> </span>
<a href="#l60.7"></a><span id="l60.7">   const char16_t *params[] = { accountName.get() };</span>
<a href="#l60.8"></a><span id="l60.8">   nsString alertString;</span>
<a href="#l60.9"></a><span id="l60.9">   nsString dialogTitle;</span>
<a href="#l60.10"></a><span id="l60.10">   bundle-&gt;FormatStringFromName(</span>
<a href="#l60.11"></a><span id="l60.11">     &quot;pop3ServerBusy&quot;,</span>
<a href="#l60.12"></a><span id="l60.12" class="difflineminus">-    params, 1, getter_Copies(alertString));</span>
<a href="#l60.13"></a><span id="l60.13" class="difflineplus">+    params, 1, alertString);</span>
<a href="#l60.14"></a><span id="l60.14">   bundle-&gt;FormatStringFromName(</span>
<a href="#l60.15"></a><span id="l60.15">     &quot;pop3ErrorDialogTitle&quot;,</span>
<a href="#l60.16"></a><span id="l60.16" class="difflineminus">-    params, 1, getter_Copies(dialogTitle));</span>
<a href="#l60.17"></a><span id="l60.17" class="difflineplus">+    params, 1, dialogTitle);</span>
<a href="#l60.18"></a><span id="l60.18">   if (!alertString.IsEmpty())</span>
<a href="#l60.19"></a><span id="l60.19">     dialog-&gt;Alert(dialogTitle.get(), alertString.get());</span>
<a href="#l60.20"></a><span id="l60.20"> }</span>
<a href="#l60.21"></a><span id="l60.21"> </span>
<a href="#l60.22"></a><span id="l60.22"> NS_IMETHODIMP nsPop3Service::NewChannel(nsIURI *aURI, nsIChannel **_retval)</span>
<a href="#l60.23"></a><span id="l60.23"> {</span>
<a href="#l60.24"></a><span id="l60.24">   return NewChannel2(aURI, nullptr, _retval);</span>
<a href="#l60.25"></a><span id="l60.25"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l61.1"></a><span id="l61.1" class="difflineminus">--- a/mailnews/local/src/nsPop3Sink.cpp</span>
<a href="#l61.2"></a><span id="l61.2" class="difflineplus">+++ b/mailnews/local/src/nsPop3Sink.cpp</span>
<a href="#l61.3"></a><span id="l61.3" class="difflineat">@@ -764,17 +764,17 @@ nsresult nsPop3Sink::HandleTempDownloadF</span>
<a href="#l61.4"></a><span id="l61.4">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l61.5"></a><span id="l61.5">   nsString fromStr, subjectStr, confirmString;</span>
<a href="#l61.6"></a><span id="l61.6"> </span>
<a href="#l61.7"></a><span id="l61.7">   m_newMailParser-&gt;m_newMsgHdr-&gt;GetMime2DecodedSubject(subjectStr);</span>
<a href="#l61.8"></a><span id="l61.8">   m_newMailParser-&gt;m_newMsgHdr-&gt;GetMime2DecodedAuthor(fromStr);</span>
<a href="#l61.9"></a><span id="l61.9">   const char16_t *params[] = { fromStr.get(), subjectStr.get() };</span>
<a href="#l61.10"></a><span id="l61.10">   bundle-&gt;FormatStringFromName(</span>
<a href="#l61.11"></a><span id="l61.11">     &quot;pop3TmpDownloadError&quot;,</span>
<a href="#l61.12"></a><span id="l61.12" class="difflineminus">-    params, 2, getter_Copies(confirmString));</span>
<a href="#l61.13"></a><span id="l61.13" class="difflineplus">+    params, 2, confirmString);</span>
<a href="#l61.14"></a><span id="l61.14">   nsCOMPtr&lt;mozIDOMWindowProxy&gt; parentWindow;</span>
<a href="#l61.15"></a><span id="l61.15">   nsCOMPtr&lt;nsIPromptService&gt; promptService = do_GetService(NS_PROMPTSERVICE_CONTRACTID);</span>
<a href="#l61.16"></a><span id="l61.16">   nsCOMPtr&lt;nsIDocShell&gt; docShell;</span>
<a href="#l61.17"></a><span id="l61.17">   if (msgWindow)</span>
<a href="#l61.18"></a><span id="l61.18">   {</span>
<a href="#l61.19"></a><span id="l61.19">     (void) msgWindow-&gt;GetRootDocShell(getter_AddRefs(docShell));</span>
<a href="#l61.20"></a><span id="l61.20">     parentWindow = do_QueryInterface(docShell);</span>
<a href="#l61.21"></a><span id="l61.21">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l62.1"></a><span id="l62.1" class="difflineminus">--- a/mailnews/mapi/mapihook/src/msgMapiHook.cpp</span>
<a href="#l62.2"></a><span id="l62.2" class="difflineplus">+++ b/mailnews/mapi/mapihook/src/msgMapiHook.cpp</span>
<a href="#l62.3"></a><span id="l62.3" class="difflineat">@@ -141,46 +141,43 @@ bool nsMapiHook::DisplayLoginDialog(bool</span>
<a href="#l62.4"></a><span id="l62.4"> </span>
<a href="#l62.5"></a><span id="l62.5">     nsCOMPtr&lt;nsIStringBundle&gt; brandBundle;</span>
<a href="#l62.6"></a><span id="l62.6">     rv = bundleService-&gt;CreateBundle(</span>
<a href="#l62.7"></a><span id="l62.7">                     &quot;chrome://branding/locale/brand.properties&quot;,</span>
<a href="#l62.8"></a><span id="l62.8">                     getter_AddRefs(brandBundle));</span>
<a href="#l62.9"></a><span id="l62.9">     if (NS_FAILED(rv)) return false;</span>
<a href="#l62.10"></a><span id="l62.10"> </span>
<a href="#l62.11"></a><span id="l62.11">     nsString brandName;</span>
<a href="#l62.12"></a><span id="l62.12" class="difflineminus">-    rv = brandBundle-&gt;GetStringFromName(</span>
<a href="#l62.13"></a><span id="l62.13" class="difflineminus">-                       &quot;brandFullName&quot;,</span>
<a href="#l62.14"></a><span id="l62.14" class="difflineminus">-                       getter_Copies(brandName));</span>
<a href="#l62.15"></a><span id="l62.15" class="difflineplus">+    rv = brandBundle-&gt;GetStringFromName(&quot;brandFullName&quot;, brandName);</span>
<a href="#l62.16"></a><span id="l62.16">     if (NS_FAILED(rv)) return false;</span>
<a href="#l62.17"></a><span id="l62.17"> </span>
<a href="#l62.18"></a><span id="l62.18">     nsString loginTitle;</span>
<a href="#l62.19"></a><span id="l62.19">     const char16_t *brandStrings[] = { brandName.get() };</span>
<a href="#l62.20"></a><span id="l62.20">     rv = bundle-&gt;FormatStringFromName(&quot;loginTitle&quot;, brandStrings, 1,</span>
<a href="#l62.21"></a><span id="l62.21" class="difflineminus">-                                      getter_Copies(loginTitle));</span>
<a href="#l62.22"></a><span id="l62.22" class="difflineplus">+                                      loginTitle);</span>
<a href="#l62.23"></a><span id="l62.23">     if (NS_FAILED(rv)) return false;</span>
<a href="#l62.24"></a><span id="l62.24"> </span>
<a href="#l62.25"></a><span id="l62.25">     if (aLogin)</span>
<a href="#l62.26"></a><span id="l62.26">     {</span>
<a href="#l62.27"></a><span id="l62.27">       nsString loginText;</span>
<a href="#l62.28"></a><span id="l62.28" class="difflineminus">-      rv = bundle-&gt;GetStringFromName(&quot;loginTextwithName&quot;,</span>
<a href="#l62.29"></a><span id="l62.29" class="difflineminus">-                                     getter_Copies(loginText));</span>
<a href="#l62.30"></a><span id="l62.30" class="difflineplus">+      rv = bundle-&gt;GetStringFromName(&quot;loginTextwithName&quot;, loginText);</span>
<a href="#l62.31"></a><span id="l62.31">       if (NS_FAILED(rv) || loginText.IsEmpty()) return false;</span>
<a href="#l62.32"></a><span id="l62.32"> </span>
<a href="#l62.33"></a><span id="l62.33">       bool dummyValue = false;</span>
<a href="#l62.34"></a><span id="l62.34">       rv = dlgService-&gt;PromptUsernameAndPassword(nullptr, loginTitle.get(),</span>
<a href="#l62.35"></a><span id="l62.35">                                                  loginText.get(), aUsername, aPassword,</span>
<a href="#l62.36"></a><span id="l62.36">                                                  nullptr, &amp;dummyValue, &amp;btnResult);</span>
<a href="#l62.37"></a><span id="l62.37">     }</span>
<a href="#l62.38"></a><span id="l62.38">     else</span>
<a href="#l62.39"></a><span id="l62.39">     {</span>
<a href="#l62.40"></a><span id="l62.40">       //nsString loginString;</span>
<a href="#l62.41"></a><span id="l62.41">       nsString loginText;</span>
<a href="#l62.42"></a><span id="l62.42">       const char16_t *userNameStrings[] = { *aUsername };</span>
<a href="#l62.43"></a><span id="l62.43">       rv = bundle-&gt;FormatStringFromName(&quot;loginText&quot;, userNameStrings, 1,</span>
<a href="#l62.44"></a><span id="l62.44" class="difflineminus">-                                        getter_Copies(loginText));</span>
<a href="#l62.45"></a><span id="l62.45" class="difflineplus">+                                        loginText);</span>
<a href="#l62.46"></a><span id="l62.46">       if (NS_FAILED(rv)) return false;</span>
<a href="#l62.47"></a><span id="l62.47"> </span>
<a href="#l62.48"></a><span id="l62.48">       bool dummyValue = false;</span>
<a href="#l62.49"></a><span id="l62.49">       rv = dlgService-&gt;PromptPassword(nullptr, loginTitle.get(), loginText.get(),</span>
<a href="#l62.50"></a><span id="l62.50">                                       aPassword, nullptr, &amp;dummyValue, &amp;btnResult);</span>
<a href="#l62.51"></a><span id="l62.51">     }</span>
<a href="#l62.52"></a><span id="l62.52">   }</span>
<a href="#l62.53"></a><span id="l62.53"> </span>
<a href="#l62.54"></a><span id="l62.54" class="difflineat">@@ -246,23 +243,22 @@ nsMapiHook::IsBlindSendAllowed()</span>
<a href="#l62.55"></a><span id="l62.55">     mozilla::services::GetStringBundleService();</span>
<a href="#l62.56"></a><span id="l62.56">   if (!bundleService) return false;</span>
<a href="#l62.57"></a><span id="l62.57"> </span>
<a href="#l62.58"></a><span id="l62.58">   nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l62.59"></a><span id="l62.59">   rv = bundleService-&gt;CreateBundle(MAPI_PROPERTIES_CHROME, getter_AddRefs(bundle));</span>
<a href="#l62.60"></a><span id="l62.60">   if (NS_FAILED(rv) || !bundle) return false;</span>
<a href="#l62.61"></a><span id="l62.61"> </span>
<a href="#l62.62"></a><span id="l62.62">   nsString warningMsg;</span>
<a href="#l62.63"></a><span id="l62.63" class="difflineminus">-  rv = bundle-&gt;GetStringFromName(&quot;mapiBlindSendWarning&quot;,</span>
<a href="#l62.64"></a><span id="l62.64" class="difflineminus">-                                 getter_Copies(warningMsg));</span>
<a href="#l62.65"></a><span id="l62.65" class="difflineplus">+  rv = bundle-&gt;GetStringFromName(&quot;mapiBlindSendWarning&quot;, warningMsg);</span>
<a href="#l62.66"></a><span id="l62.66">   if (NS_FAILED(rv)) return false;</span>
<a href="#l62.67"></a><span id="l62.67"> </span>
<a href="#l62.68"></a><span id="l62.68">   nsString dontShowAgainMessage;</span>
<a href="#l62.69"></a><span id="l62.69">   rv = bundle-&gt;GetStringFromName(&quot;mapiBlindSendDontShowAgain&quot;,</span>
<a href="#l62.70"></a><span id="l62.70" class="difflineminus">-                                 getter_Copies(dontShowAgainMessage));</span>
<a href="#l62.71"></a><span id="l62.71" class="difflineplus">+                                 dontShowAgainMessage);</span>
<a href="#l62.72"></a><span id="l62.72">   if (NS_FAILED(rv)) return false;</span>
<a href="#l62.73"></a><span id="l62.73"> </span>
<a href="#l62.74"></a><span id="l62.74">   nsCOMPtr&lt;nsIPromptService&gt; dlgService(do_GetService(NS_PROMPTSERVICE_CONTRACTID, &amp;rv));</span>
<a href="#l62.75"></a><span id="l62.75">   if (NS_FAILED(rv) || !dlgService) return false;</span>
<a href="#l62.76"></a><span id="l62.76"> </span>
<a href="#l62.77"></a><span id="l62.77">   bool continueToWarn = true;</span>
<a href="#l62.78"></a><span id="l62.78">   bool okayToContinue = false;</span>
<a href="#l62.79"></a><span id="l62.79">   dlgService-&gt;ConfirmCheck(nullptr, nullptr, warningMsg.get(), dontShowAgainMessage.get(), &amp;continueToWarn, &amp;okayToContinue);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l63.1"></a><span id="l63.1" class="difflineminus">--- a/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp</span>
<a href="#l63.2"></a><span id="l63.2" class="difflineplus">+++ b/mailnews/mime/cthandlers/pgpmime/nsPgpMimeProxy.cpp</span>
<a href="#l63.3"></a><span id="l63.3" class="difflineat">@@ -83,17 +83,17 @@ static void PgpMimeGetNeedsAddonString(n</span>
<a href="#l63.4"></a><span id="l63.4">                                    getter_Copies(url))))</span>
<a href="#l63.5"></a><span id="l63.5">     return;</span>
<a href="#l63.6"></a><span id="l63.6"> </span>
<a href="#l63.7"></a><span id="l63.7">   NS_ConvertUTF8toUTF16 url16(url);</span>
<a href="#l63.8"></a><span id="l63.8">   const char16_t *formatStrings[] = { url16.get() };</span>
<a href="#l63.9"></a><span id="l63.9"> </span>
<a href="#l63.10"></a><span id="l63.10">   nsString result;</span>
<a href="#l63.11"></a><span id="l63.11">   rv = stringBundle-&gt;FormatStringFromName(PGPMIME_STR_NOT_SUPPORTED_ID,</span>
<a href="#l63.12"></a><span id="l63.12" class="difflineminus">-                                          formatStrings, 1, getter_Copies(result));</span>
<a href="#l63.13"></a><span id="l63.13" class="difflineplus">+                                          formatStrings, 1, result);</span>
<a href="#l63.14"></a><span id="l63.14">   if (NS_FAILED(rv))</span>
<a href="#l63.15"></a><span id="l63.15">     return;</span>
<a href="#l63.16"></a><span id="l63.16">   aResult = NS_ConvertUTF16toUTF8(result);</span>
<a href="#l63.17"></a><span id="l63.17"> }</span>
<a href="#l63.18"></a><span id="l63.18"> </span>
<a href="#l63.19"></a><span id="l63.19"> static int</span>
<a href="#l63.20"></a><span id="l63.20"> MimeEncryptedPgpClassInitialize(MimeEncryptedPgpClass *clazz)</span>
<a href="#l63.21"></a><span id="l63.21"> {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l64.1"></a><span id="l64.1" class="difflineminus">--- a/mailnews/mime/emitters/nsMimeBaseEmitter.cpp</span>
<a href="#l64.2"></a><span id="l64.2" class="difflineplus">+++ b/mailnews/mime/emitters/nsMimeBaseEmitter.cpp</span>
<a href="#l64.3"></a><span id="l64.3" class="difflineat">@@ -203,18 +203,17 @@ nsMimeBaseEmitter::MimeGetStringByName(c</span>
<a href="#l64.4"></a><span id="l64.4">       res = sBundleService-&gt;CreateBundle(propertyURL, getter_AddRefs(m_headerStringBundle));</span>
<a href="#l64.5"></a><span id="l64.5">     }</span>
<a href="#l64.6"></a><span id="l64.6">   }</span>
<a href="#l64.7"></a><span id="l64.7"> </span>
<a href="#l64.8"></a><span id="l64.8">   if (m_headerStringBundle)</span>
<a href="#l64.9"></a><span id="l64.9">   {</span>
<a href="#l64.10"></a><span id="l64.10">     nsString val;</span>
<a href="#l64.11"></a><span id="l64.11"> </span>
<a href="#l64.12"></a><span id="l64.12" class="difflineminus">-    res = m_headerStringBundle-&gt;GetStringFromName(aHeaderName,</span>
<a href="#l64.13"></a><span id="l64.13" class="difflineminus">-                                                  getter_Copies(val));</span>
<a href="#l64.14"></a><span id="l64.14" class="difflineplus">+    res = m_headerStringBundle-&gt;GetStringFromName(aHeaderName, val);</span>
<a href="#l64.15"></a><span id="l64.15"> </span>
<a href="#l64.16"></a><span id="l64.16">     if (NS_FAILED(res))</span>
<a href="#l64.17"></a><span id="l64.17">       return nullptr;</span>
<a href="#l64.18"></a><span id="l64.18"> </span>
<a href="#l64.19"></a><span id="l64.19">     // Here we need to return a new copy of the string</span>
<a href="#l64.20"></a><span id="l64.20">     // This returns a UTF-8 string so the caller needs to perform a conversion</span>
<a href="#l64.21"></a><span id="l64.21">     // if this is used as UCS-2 (e.g. cannot do nsString(utfStr);</span>
<a href="#l64.22"></a><span id="l64.22">     //</span>
<a href="#l64.23"></a><span id="l64.23" class="difflineat">@@ -239,18 +238,17 @@ nsMimeBaseEmitter::MimeGetStringByID(int</span>
<a href="#l64.24"></a><span id="l64.24">       mozilla::services::GetStringBundleService();</span>
<a href="#l64.25"></a><span id="l64.25">     if (sBundleService)</span>
<a href="#l64.26"></a><span id="l64.26">       res = sBundleService-&gt;CreateBundle(propertyURL, getter_AddRefs(m_stringBundle));</span>
<a href="#l64.27"></a><span id="l64.27">   }</span>
<a href="#l64.28"></a><span id="l64.28"> </span>
<a href="#l64.29"></a><span id="l64.29">   if (m_stringBundle)</span>
<a href="#l64.30"></a><span id="l64.30">   {</span>
<a href="#l64.31"></a><span id="l64.31">     nsString val;</span>
<a href="#l64.32"></a><span id="l64.32" class="difflineminus">-</span>
<a href="#l64.33"></a><span id="l64.33" class="difflineminus">-    res = m_stringBundle-&gt;GetStringFromID(aID, getter_Copies(val));</span>
<a href="#l64.34"></a><span id="l64.34" class="difflineplus">+    res = m_stringBundle-&gt;GetStringFromID(aID, val);</span>
<a href="#l64.35"></a><span id="l64.35"> </span>
<a href="#l64.36"></a><span id="l64.36">     if (NS_FAILED(res))</span>
<a href="#l64.37"></a><span id="l64.37">       return nullptr;</span>
<a href="#l64.38"></a><span id="l64.38"> </span>
<a href="#l64.39"></a><span id="l64.39">     return ToNewUTF8String(val);</span>
<a href="#l64.40"></a><span id="l64.40">   }</span>
<a href="#l64.41"></a><span id="l64.41">   else</span>
<a href="#l64.42"></a><span id="l64.42">     return nullptr;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l65.1"></a><span id="l65.1" class="difflineminus">--- a/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp</span>
<a href="#l65.2"></a><span id="l65.2" class="difflineplus">+++ b/mailnews/mime/emitters/nsMimeHtmlEmitter.cpp</span>
<a href="#l65.3"></a><span id="l65.3" class="difflineat">@@ -433,18 +433,17 @@ nsMimeHtmlDisplayEmitter::StartAttachmen</span>
<a href="#l65.4"></a><span id="l65.4">       NS_ENSURE_TRUE(bundleSvc, NS_ERROR_UNEXPECTED);</span>
<a href="#l65.5"></a><span id="l65.5"> </span>
<a href="#l65.6"></a><span id="l65.6">       nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l65.7"></a><span id="l65.7">       rv = bundleSvc-&gt;CreateBundle(&quot;chrome://messenger/locale/messenger.properties&quot;,</span>
<a href="#l65.8"></a><span id="l65.8">                                    getter_AddRefs(bundle));</span>
<a href="#l65.9"></a><span id="l65.9">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l65.10"></a><span id="l65.10"> </span>
<a href="#l65.11"></a><span id="l65.11">       nsString attachmentsHeader;</span>
<a href="#l65.12"></a><span id="l65.12" class="difflineminus">-      bundle-&gt;GetStringFromName(&quot;attachmentsPrintHeader&quot;,</span>
<a href="#l65.13"></a><span id="l65.13" class="difflineminus">-                                getter_Copies(attachmentsHeader)); </span>
<a href="#l65.14"></a><span id="l65.14" class="difflineplus">+      bundle-&gt;GetStringFromName(&quot;attachmentsPrintHeader&quot;, attachmentsHeader);</span>
<a href="#l65.15"></a><span id="l65.15"> </span>
<a href="#l65.16"></a><span id="l65.16">       UtilityWrite(&quot;&lt;legend class=\&quot;mimeAttachmentHeaderName\&quot;&gt;&quot;);</span>
<a href="#l65.17"></a><span id="l65.17">       nsCString escapedName;</span>
<a href="#l65.18"></a><span id="l65.18">       escapedName.Adopt(MsgEscapeHTML(NS_ConvertUTF16toUTF8(attachmentsHeader).get()));</span>
<a href="#l65.19"></a><span id="l65.19">       UtilityWrite(escapedName.get());</span>
<a href="#l65.20"></a><span id="l65.20">       UtilityWrite(&quot;&lt;/legend&gt;&quot;);</span>
<a href="#l65.21"></a><span id="l65.21">     }</span>
<a href="#l65.22"></a><span id="l65.22">     UtilityWrite(&quot;&lt;/fieldset&gt;&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l66.1"></a><span id="l66.1" class="difflineminus">--- a/mailnews/mime/src/mimemoz2.cpp</span>
<a href="#l66.2"></a><span id="l66.2" class="difflineplus">+++ b/mailnews/mime/src/mimemoz2.cpp</span>
<a href="#l66.3"></a><span id="l66.3" class="difflineat">@@ -1906,17 +1906,17 @@ MimeGetStringByID(int32_t stringID)</span>
<a href="#l66.4"></a><span id="l66.4">   nsCOMPtr&lt;nsIStringBundleService&gt; stringBundleService =</span>
<a href="#l66.5"></a><span id="l66.5">     mozilla::services::GetStringBundleService();</span>
<a href="#l66.6"></a><span id="l66.6"> </span>
<a href="#l66.7"></a><span id="l66.7">   nsCOMPtr&lt;nsIStringBundle&gt; stringBundle;</span>
<a href="#l66.8"></a><span id="l66.8">   stringBundleService-&gt;CreateBundle(MIME_URL, getter_AddRefs(stringBundle));</span>
<a href="#l66.9"></a><span id="l66.9">   if (stringBundle)</span>
<a href="#l66.10"></a><span id="l66.10">   {</span>
<a href="#l66.11"></a><span id="l66.11">     nsString v;</span>
<a href="#l66.12"></a><span id="l66.12" class="difflineminus">-    if (NS_SUCCEEDED(stringBundle-&gt;GetStringFromID(stringID, getter_Copies(v))))</span>
<a href="#l66.13"></a><span id="l66.13" class="difflineplus">+    if (NS_SUCCEEDED(stringBundle-&gt;GetStringFromID(stringID, v)))</span>
<a href="#l66.14"></a><span id="l66.14">       return ToNewUTF8String(v);</span>
<a href="#l66.15"></a><span id="l66.15">   }</span>
<a href="#l66.16"></a><span id="l66.16"> </span>
<a href="#l66.17"></a><span id="l66.17">   return strdup(&quot;???&quot;);</span>
<a href="#l66.18"></a><span id="l66.18"> }</span>
<a href="#l66.19"></a><span id="l66.19"> </span>
<a href="#l66.20"></a><span id="l66.20"> extern &quot;C&quot;</span>
<a href="#l66.21"></a><span id="l66.21"> char *</span>
<a href="#l66.22"></a><span id="l66.22" class="difflineat">@@ -1925,17 +1925,17 @@ MimeGetStringByName(const char16_t *stri</span>
<a href="#l66.23"></a><span id="l66.23">   nsCOMPtr&lt;nsIStringBundleService&gt; stringBundleService =</span>
<a href="#l66.24"></a><span id="l66.24">     do_GetService(NS_STRINGBUNDLE_CONTRACTID);</span>
<a href="#l66.25"></a><span id="l66.25"> </span>
<a href="#l66.26"></a><span id="l66.26">   nsCOMPtr&lt;nsIStringBundle&gt; stringBundle;</span>
<a href="#l66.27"></a><span id="l66.27">   stringBundleService-&gt;CreateBundle(MIME_URL, getter_AddRefs(stringBundle));</span>
<a href="#l66.28"></a><span id="l66.28">   if (stringBundle)</span>
<a href="#l66.29"></a><span id="l66.29">   {</span>
<a href="#l66.30"></a><span id="l66.30">     nsString v;</span>
<a href="#l66.31"></a><span id="l66.31" class="difflineminus">-    if (NS_SUCCEEDED(stringBundle-&gt;GetStringFromName(NS_ConvertUTF16toUTF8(stringName).get(), getter_Copies(v))))</span>
<a href="#l66.32"></a><span id="l66.32" class="difflineplus">+    if (NS_SUCCEEDED(stringBundle-&gt;GetStringFromName(NS_ConvertUTF16toUTF8(stringName).get(), v)))</span>
<a href="#l66.33"></a><span id="l66.33">       return ToNewUTF8String(v);</span>
<a href="#l66.34"></a><span id="l66.34">   }</span>
<a href="#l66.35"></a><span id="l66.35"> </span>
<a href="#l66.36"></a><span id="l66.36">   return strdup(&quot;???&quot;);</span>
<a href="#l66.37"></a><span id="l66.37"> }</span>
<a href="#l66.38"></a><span id="l66.38"> </span>
<a href="#l66.39"></a><span id="l66.39"> void</span>
<a href="#l66.40"></a><span id="l66.40"> ResetChannelCharset(MimeObject *obj)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l67.1"></a><span id="l67.1" class="difflineminus">--- a/mailnews/news/src/nsNNTPNewsgroupList.cpp</span>
<a href="#l67.2"></a><span id="l67.2" class="difflineplus">+++ b/mailnews/news/src/nsNNTPNewsgroupList.cpp</span>
<a href="#l67.3"></a><span id="l67.3" class="difflineat">@@ -312,17 +312,17 @@ nsNNTPNewsgroupList::GetRangeOfArtsToDow</span>
<a href="#l67.4"></a><span id="l67.4">     nsCOMPtr&lt;nsIStringBundleService&gt; bundleService =</span>
<a href="#l67.5"></a><span id="l67.5">       mozilla::services::GetStringBundleService();</span>
<a href="#l67.6"></a><span id="l67.6">     NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l67.7"></a><span id="l67.7"> </span>
<a href="#l67.8"></a><span id="l67.8">     nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l67.9"></a><span id="l67.9">     rv = bundleService-&gt;CreateBundle(NEWS_MSGS_URL, getter_AddRefs(bundle));</span>
<a href="#l67.10"></a><span id="l67.10">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l67.11"></a><span id="l67.11"> </span>
<a href="#l67.12"></a><span id="l67.12" class="difflineminus">-    rv = bundle-&gt;GetStringFromName(&quot;noNewMessages&quot;, getter_Copies(statusString));</span>
<a href="#l67.13"></a><span id="l67.13" class="difflineplus">+    rv = bundle-&gt;GetStringFromName(&quot;noNewMessages&quot;, statusString);</span>
<a href="#l67.14"></a><span id="l67.14">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l67.15"></a><span id="l67.15"> </span>
<a href="#l67.16"></a><span id="l67.16">     SetProgressStatus(statusString.get());</span>
<a href="#l67.17"></a><span id="l67.17">   }</span>
<a href="#l67.18"></a><span id="l67.18"> </span>
<a href="#l67.19"></a><span id="l67.19">   if (maxextra &lt;= 0 || last_possible &lt; first_possible || last_possible &lt; 1)</span>
<a href="#l67.20"></a><span id="l67.20">   {</span>
<a href="#l67.21"></a><span id="l67.21">     *status=0;</span>
<a href="#l67.22"></a><span id="l67.22" class="difflineat">@@ -881,17 +881,17 @@ nsNNTPNewsgroupList::FinishXOVERLINE(int</span>
<a href="#l67.23"></a><span id="l67.23">         mozilla::services::GetStringBundleService();</span>
<a href="#l67.24"></a><span id="l67.24">       NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l67.25"></a><span id="l67.25"> </span>
<a href="#l67.26"></a><span id="l67.26">       nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l67.27"></a><span id="l67.27">       rv = bundleService-&gt;CreateBundle(NEWS_MSGS_URL, getter_AddRefs(bundle));</span>
<a href="#l67.28"></a><span id="l67.28">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l67.29"></a><span id="l67.29"> </span>
<a href="#l67.30"></a><span id="l67.30">       const char16_t *formatStrings[2] = { firstStr.get(), lastStr.get() };</span>
<a href="#l67.31"></a><span id="l67.31" class="difflineminus">-      rv = bundle-&gt;FormatStringFromName(&quot;downloadingArticles&quot;, formatStrings, 2, getter_Copies(statusString));</span>
<a href="#l67.32"></a><span id="l67.32" class="difflineplus">+      rv = bundle-&gt;FormatStringFromName(&quot;downloadingArticles&quot;, formatStrings, 2, statusString);</span>
<a href="#l67.33"></a><span id="l67.33">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l67.34"></a><span id="l67.34"> </span>
<a href="#l67.35"></a><span id="l67.35">       SetProgressStatus(statusString.get());</span>
<a href="#l67.36"></a><span id="l67.36">     }</span>
<a href="#l67.37"></a><span id="l67.37">   }</span>
<a href="#l67.38"></a><span id="l67.38"> </span>
<a href="#l67.39"></a><span id="l67.39">   if (newstatus)</span>
<a href="#l67.40"></a><span id="l67.40">     *newstatus=0;</span>
<a href="#l67.41"></a><span id="l67.41" class="difflineat">@@ -1249,17 +1249,17 @@ nsNNTPNewsgroupList::SetProgressStatus(c</span>
<a href="#l67.42"></a><span id="l67.42">       nsCOMPtr&lt;nsIStringBundleService&gt; sbs =</span>
<a href="#l67.43"></a><span id="l67.43">         mozilla::services::GetStringBundleService();</span>
<a href="#l67.44"></a><span id="l67.44">       nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l67.45"></a><span id="l67.45">       rv = sbs-&gt;CreateBundle(MSGS_URL,</span>
<a href="#l67.46"></a><span id="l67.46">                              getter_AddRefs(bundle));</span>
<a href="#l67.47"></a><span id="l67.47">       NS_ENSURE_SUCCESS_VOID(rv);</span>
<a href="#l67.48"></a><span id="l67.48">       const char16_t *params[] = { accountName.get(), aMessage };</span>
<a href="#l67.49"></a><span id="l67.49">       bundle-&gt;FormatStringFromName(&quot;statusMessage&quot;,</span>
<a href="#l67.50"></a><span id="l67.50" class="difflineminus">-                                   params, 2, getter_Copies(statusMessage));</span>
<a href="#l67.51"></a><span id="l67.51" class="difflineplus">+                                   params, 2, statusMessage);</span>
<a href="#l67.52"></a><span id="l67.52"> </span>
<a href="#l67.53"></a><span id="l67.53">       feedback-&gt;ShowStatusString(statusMessage);</span>
<a href="#l67.54"></a><span id="l67.54">     }</span>
<a href="#l67.55"></a><span id="l67.55">   }</span>
<a href="#l67.56"></a><span id="l67.56"> }</span>
<a href="#l67.57"></a><span id="l67.57"> </span>
<a href="#l67.58"></a><span id="l67.58"> void</span>
<a href="#l67.59"></a><span id="l67.59"> nsNNTPNewsgroupList::UpdateStatus(bool filtering, int32_t numDLed, int32_t totToDL)</span>
<a href="#l67.60"></a><span id="l67.60" class="difflineat">@@ -1291,24 +1291,24 @@ nsNNTPNewsgroupList::UpdateStatus(bool f</span>
<a href="#l67.61"></a><span id="l67.61">     return;</span>
<a href="#l67.62"></a><span id="l67.62"> </span>
<a href="#l67.63"></a><span id="l67.63">   if (filtering)</span>
<a href="#l67.64"></a><span id="l67.64">   {</span>
<a href="#l67.65"></a><span id="l67.65">     NS_ConvertUTF8toUTF16 header(m_filterHeaders[m_currentXHDRIndex]);</span>
<a href="#l67.66"></a><span id="l67.66">     const char16_t *formatStrings[4] = { header.get(),</span>
<a href="#l67.67"></a><span id="l67.67">       numDownloadedStr.get(), totalToDownloadStr.get(), newsgroupName.get() };</span>
<a href="#l67.68"></a><span id="l67.68">     rv = bundle-&gt;FormatStringFromName(&quot;newNewsgroupFilteringHeaders&quot;,</span>
<a href="#l67.69"></a><span id="l67.69" class="difflineminus">-      formatStrings, 4, getter_Copies(statusString));</span>
<a href="#l67.70"></a><span id="l67.70" class="difflineplus">+      formatStrings, 4, statusString);</span>
<a href="#l67.71"></a><span id="l67.71">   }</span>
<a href="#l67.72"></a><span id="l67.72">   else</span>
<a href="#l67.73"></a><span id="l67.73">   {</span>
<a href="#l67.74"></a><span id="l67.74">     const char16_t *formatStrings[3] = { numDownloadedStr.get(),</span>
<a href="#l67.75"></a><span id="l67.75">       totalToDownloadStr.get(), newsgroupName.get() };</span>
<a href="#l67.76"></a><span id="l67.76">     rv = bundle-&gt;FormatStringFromName(&quot;newNewsgroupHeaders&quot;,</span>
<a href="#l67.77"></a><span id="l67.77" class="difflineminus">-      formatStrings, 3, getter_Copies(statusString));</span>
<a href="#l67.78"></a><span id="l67.78" class="difflineplus">+      formatStrings, 3, statusString);</span>
<a href="#l67.79"></a><span id="l67.79">   }</span>
<a href="#l67.80"></a><span id="l67.80">   if (!NS_SUCCEEDED(rv))</span>
<a href="#l67.81"></a><span id="l67.81">     return;</span>
<a href="#l67.82"></a><span id="l67.82"> </span>
<a href="#l67.83"></a><span id="l67.83">   SetProgressStatus(statusString.get());</span>
<a href="#l67.84"></a><span id="l67.84">   m_lastStatusUpdate = PR_Now();</span>
<a href="#l67.85"></a><span id="l67.85"> </span>
<a href="#l67.86"></a><span id="l67.86">   // only update the progress meter if it has changed</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l68.1"></a><span id="l68.1" class="difflineminus">--- a/mailnews/news/src/nsNNTPProtocol.cpp</span>
<a href="#l68.2"></a><span id="l68.2" class="difflineplus">+++ b/mailnews/news/src/nsNNTPProtocol.cpp</span>
<a href="#l68.3"></a><span id="l68.3" class="difflineat">@@ -1015,17 +1015,17 @@ nsresult nsNNTPProtocol::LoadUrl(nsIURI </span>
<a href="#l68.4"></a><span id="l68.4">       rv = NS_MsgDecodeUnescapeURLPath(group, unescapedName);</span>
<a href="#l68.5"></a><span id="l68.5">       NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l68.6"></a><span id="l68.6"> </span>
<a href="#l68.7"></a><span id="l68.7">       bundleService-&gt;CreateBundle(NEWS_MSGS_URL, getter_AddRefs(bundle));</span>
<a href="#l68.8"></a><span id="l68.8">       const char16_t *formatStrings[1] = { unescapedName.get() };</span>
<a href="#l68.9"></a><span id="l68.9"> </span>
<a href="#l68.10"></a><span id="l68.10">       rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l68.11"></a><span id="l68.11">         &quot;autoSubscribeText&quot;, formatStrings, 1,</span>
<a href="#l68.12"></a><span id="l68.12" class="difflineminus">-        getter_Copies(confirmText));</span>
<a href="#l68.13"></a><span id="l68.13" class="difflineplus">+        confirmText);</span>
<a href="#l68.14"></a><span id="l68.14">       NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l68.15"></a><span id="l68.15"> </span>
<a href="#l68.16"></a><span id="l68.16">       bool confirmResult = false;</span>
<a href="#l68.17"></a><span id="l68.17">       rv = dialog-&gt;Confirm(nullptr, confirmText.get(), &amp;confirmResult);</span>
<a href="#l68.18"></a><span id="l68.18">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l68.19"></a><span id="l68.19"> </span>
<a href="#l68.20"></a><span id="l68.20">       if (confirmResult)</span>
<a href="#l68.21"></a><span id="l68.21">       {</span>
<a href="#l68.22"></a><span id="l68.22" class="difflineat">@@ -2801,17 +2801,17 @@ nsresult nsNNTPProtocol::ReadNewsList(ns</span>
<a href="#l68.23"></a><span id="l68.23"> </span>
<a href="#l68.24"></a><span id="l68.24">       nsAutoString numGroupsStr;</span>
<a href="#l68.25"></a><span id="l68.25">       numGroupsStr.AppendInt(mNumGroupsListed);</span>
<a href="#l68.26"></a><span id="l68.26">       NS_ConvertASCIItoUTF16 rateStr(rate_buf);</span>
<a href="#l68.27"></a><span id="l68.27"> </span>
<a href="#l68.28"></a><span id="l68.28">       const char16_t *formatStrings[3] = { numGroupsStr.get(), bytesStr.get(), rateStr.get()};</span>
<a href="#l68.29"></a><span id="l68.29">       rv = bundle-&gt;FormatStringFromName(&quot;bytesReceived&quot;,</span>
<a href="#l68.30"></a><span id="l68.30">         formatStrings, 3,</span>
<a href="#l68.31"></a><span id="l68.31" class="difflineminus">-        getter_Copies(statusString));</span>
<a href="#l68.32"></a><span id="l68.32" class="difflineplus">+        statusString);</span>
<a href="#l68.33"></a><span id="l68.33"> </span>
<a href="#l68.34"></a><span id="l68.34">       rv = msgStatusFeedback-&gt;ShowStatusString(statusString);</span>
<a href="#l68.35"></a><span id="l68.35">       if (NS_FAILED(rv)) {</span>
<a href="#l68.36"></a><span id="l68.36">         PR_Free(lineToFree);</span>
<a href="#l68.37"></a><span id="l68.37">         return rv;</span>
<a href="#l68.38"></a><span id="l68.38">       }</span>
<a href="#l68.39"></a><span id="l68.39">     }</span>
<a href="#l68.40"></a><span id="l68.40">   }</span>
<a href="#l68.41"></a><span id="l68.41" class="difflineat">@@ -3367,27 +3367,27 @@ nsresult nsNNTPProtocol::GetNewsStringBy</span>
<a href="#l68.42"></a><span id="l68.42">       mozilla::services::GetStringBundleService();</span>
<a href="#l68.43"></a><span id="l68.43">     NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l68.44"></a><span id="l68.44"> </span>
<a href="#l68.45"></a><span id="l68.45">     rv = bundleService-&gt;CreateBundle(NEWS_MSGS_URL, getter_AddRefs(m_stringBundle));</span>
<a href="#l68.46"></a><span id="l68.46">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l68.47"></a><span id="l68.47">   }</span>
<a href="#l68.48"></a><span id="l68.48"> </span>
<a href="#l68.49"></a><span id="l68.49">   if (m_stringBundle) {</span>
<a href="#l68.50"></a><span id="l68.50" class="difflineminus">-    char16_t *ptrv = nullptr;</span>
<a href="#l68.51"></a><span id="l68.51" class="difflineminus">-    rv = m_stringBundle-&gt;GetStringFromID(stringID, &amp;ptrv);</span>
<a href="#l68.52"></a><span id="l68.52" class="difflineplus">+    nsAutoString str;</span>
<a href="#l68.53"></a><span id="l68.53" class="difflineplus">+    rv = m_stringBundle-&gt;GetStringFromID(stringID, str);</span>
<a href="#l68.54"></a><span id="l68.54"> </span>
<a href="#l68.55"></a><span id="l68.55">     if (NS_FAILED(rv)) {</span>
<a href="#l68.56"></a><span id="l68.56">       resultString.AssignLiteral(&quot;[StringID&quot;);</span>
<a href="#l68.57"></a><span id="l68.57">       resultString.AppendInt(stringID);</span>
<a href="#l68.58"></a><span id="l68.58">       resultString.AppendLiteral(&quot;?]&quot;);</span>
<a href="#l68.59"></a><span id="l68.59">       *aString = ToNewUnicode(resultString);</span>
<a href="#l68.60"></a><span id="l68.60">     }</span>
<a href="#l68.61"></a><span id="l68.61">     else {</span>
<a href="#l68.62"></a><span id="l68.62" class="difflineminus">-      *aString = ptrv;</span>
<a href="#l68.63"></a><span id="l68.63" class="difflineplus">+      *aString = ToNewUnicode(str);</span>
<a href="#l68.64"></a><span id="l68.64">     }</span>
<a href="#l68.65"></a><span id="l68.65">   }</span>
<a href="#l68.66"></a><span id="l68.66">   else {</span>
<a href="#l68.67"></a><span id="l68.67">     rv = NS_OK;</span>
<a href="#l68.68"></a><span id="l68.68">     *aString = ToNewUnicode(resultString);</span>
<a href="#l68.69"></a><span id="l68.69">   }</span>
<a href="#l68.70"></a><span id="l68.70">   return rv;</span>
<a href="#l68.71"></a><span id="l68.71"> }</span>
<a href="#l68.72"></a><span id="l68.72" class="difflineat">@@ -3403,29 +3403,29 @@ nsresult nsNNTPProtocol::GetNewsStringBy</span>
<a href="#l68.73"></a><span id="l68.73">     NS_ENSURE_TRUE(bundleService, NS_ERROR_UNEXPECTED);</span>
<a href="#l68.74"></a><span id="l68.74"> </span>
<a href="#l68.75"></a><span id="l68.75">     rv = bundleService-&gt;CreateBundle(NEWS_MSGS_URL, getter_AddRefs(m_stringBundle));</span>
<a href="#l68.76"></a><span id="l68.76">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l68.77"></a><span id="l68.77">   }</span>
<a href="#l68.78"></a><span id="l68.78"> </span>
<a href="#l68.79"></a><span id="l68.79">   if (m_stringBundle)</span>
<a href="#l68.80"></a><span id="l68.80">   {</span>
<a href="#l68.81"></a><span id="l68.81" class="difflineminus">-    char16_t *ptrv = nullptr;</span>
<a href="#l68.82"></a><span id="l68.82" class="difflineminus">-    rv = m_stringBundle-&gt;GetStringFromName(aName, &amp;ptrv);</span>
<a href="#l68.83"></a><span id="l68.83" class="difflineplus">+    nsAutoString str;</span>
<a href="#l68.84"></a><span id="l68.84" class="difflineplus">+    rv = m_stringBundle-&gt;GetStringFromName(aName, str);</span>
<a href="#l68.85"></a><span id="l68.85"> </span>
<a href="#l68.86"></a><span id="l68.86">     if (NS_FAILED(rv))</span>
<a href="#l68.87"></a><span id="l68.87">     {</span>
<a href="#l68.88"></a><span id="l68.88">       resultString.AssignLiteral(&quot;[StringName&quot;);</span>
<a href="#l68.89"></a><span id="l68.89">       resultString.Append(NS_ConvertASCIItoUTF16(aName));</span>
<a href="#l68.90"></a><span id="l68.90">       resultString.AppendLiteral(&quot;?]&quot;);</span>
<a href="#l68.91"></a><span id="l68.91">       *aString = ToNewUnicode(resultString);</span>
<a href="#l68.92"></a><span id="l68.92">     }</span>
<a href="#l68.93"></a><span id="l68.93">     else</span>
<a href="#l68.94"></a><span id="l68.94">     {</span>
<a href="#l68.95"></a><span id="l68.95" class="difflineminus">-      *aString = ptrv;</span>
<a href="#l68.96"></a><span id="l68.96" class="difflineplus">+      *aString = ToNewUnicode(str);</span>
<a href="#l68.97"></a><span id="l68.97">     }</span>
<a href="#l68.98"></a><span id="l68.98">   }</span>
<a href="#l68.99"></a><span id="l68.99">   else</span>
<a href="#l68.100"></a><span id="l68.100">   {</span>
<a href="#l68.101"></a><span id="l68.101">     rv = NS_OK;</span>
<a href="#l68.102"></a><span id="l68.102">     *aString = ToNewUnicode(resultString);</span>
<a href="#l68.103"></a><span id="l68.103">   }</span>
<a href="#l68.104"></a><span id="l68.104">   return rv;</span>
<a href="#l68.105"></a><span id="l68.105" class="difflineat">@@ -3568,18 +3568,17 @@ nsresult nsNNTPProtocol::DoCancel()</span>
<a href="#l68.106"></a><span id="l68.106">   NS_ENSURE_TRUE(bundleService, NS_ERROR_OUT_OF_MEMORY);</span>
<a href="#l68.107"></a><span id="l68.107"> </span>
<a href="#l68.108"></a><span id="l68.108">   nsCOMPtr&lt;nsIStringBundle&gt; brandBundle;</span>
<a href="#l68.109"></a><span id="l68.109">   bundleService-&gt;CreateBundle(&quot;chrome://branding/locale/brand.properties&quot;,</span>
<a href="#l68.110"></a><span id="l68.110">                               getter_AddRefs(brandBundle));</span>
<a href="#l68.111"></a><span id="l68.111">   NS_ENSURE_TRUE(brandBundle, NS_ERROR_FAILURE);</span>
<a href="#l68.112"></a><span id="l68.112"> </span>
<a href="#l68.113"></a><span id="l68.113">   nsString brandFullName;</span>
<a href="#l68.114"></a><span id="l68.114" class="difflineminus">-  rv = brandBundle-&gt;GetStringFromName(&quot;brandFullName&quot;,</span>
<a href="#l68.115"></a><span id="l68.115" class="difflineminus">-                                      getter_Copies(brandFullName));</span>
<a href="#l68.116"></a><span id="l68.116" class="difflineplus">+  rv = brandBundle-&gt;GetStringFromName(&quot;brandFullName&quot;, brandFullName);</span>
<a href="#l68.117"></a><span id="l68.117">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l68.118"></a><span id="l68.118">   NS_ConvertUTF16toUTF8 appName(brandFullName);</span>
<a href="#l68.119"></a><span id="l68.119"> </span>
<a href="#l68.120"></a><span id="l68.120">   newsgroups = m_cancelNewsgroups;</span>
<a href="#l68.121"></a><span id="l68.121">   distribution = m_cancelDistribution;</span>
<a href="#l68.122"></a><span id="l68.122">   id = m_cancelID;</span>
<a href="#l68.123"></a><span id="l68.123">   nsCString oldFrom(m_cancelFromHdr);</span>
<a href="#l68.124"></a><span id="l68.124"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l69.1"></a><span id="l69.1" class="difflineminus">--- a/mailnews/news/src/nsNewsDownloader.cpp</span>
<a href="#l69.2"></a><span id="l69.2" class="difflineplus">+++ b/mailnews/news/src/nsNewsDownloader.cpp</span>
<a href="#l69.3"></a><span id="l69.3" class="difflineat">@@ -193,17 +193,17 @@ bool nsNewsDownloader::GetNextHdrToRetri</span>
<a href="#l69.4"></a><span id="l69.4">     totalStr.AppendInt(int(m_keysToDownload.Length()));</span>
<a href="#l69.5"></a><span id="l69.5">     nsString prettyName;</span>
<a href="#l69.6"></a><span id="l69.6">     nsString statusString;</span>
<a href="#l69.7"></a><span id="l69.7"> </span>
<a href="#l69.8"></a><span id="l69.8">     m_folder-&gt;GetPrettyName(prettyName);</span>
<a href="#l69.9"></a><span id="l69.9"> </span>
<a href="#l69.10"></a><span id="l69.10">     const char16_t *formatStrings[3] = { firstStr.get(), totalStr.get(), prettyName.get() };</span>
<a href="#l69.11"></a><span id="l69.11">     rv = bundle-&gt;FormatStringFromName(&quot;downloadingArticlesForOffline&quot;,</span>
<a href="#l69.12"></a><span id="l69.12" class="difflineminus">-                                      formatStrings, 3, getter_Copies(statusString));</span>
<a href="#l69.13"></a><span id="l69.13" class="difflineplus">+                                      formatStrings, 3, statusString);</span>
<a href="#l69.14"></a><span id="l69.14">     NS_ENSURE_SUCCESS(rv, false);</span>
<a href="#l69.15"></a><span id="l69.15">     ShowProgress(statusString.get(), percent);</span>
<a href="#l69.16"></a><span id="l69.16">     return true;</span>
<a href="#l69.17"></a><span id="l69.17">   }</span>
<a href="#l69.18"></a><span id="l69.18">   NS_ASSERTION(false, &quot;shouldn't get here if we're not downloading from keys.&quot;);</span>
<a href="#l69.19"></a><span id="l69.19">   return false;  // shouldn't get here if we're not downloading from keys.</span>
<a href="#l69.20"></a><span id="l69.20"> }</span>
<a href="#l69.21"></a><span id="l69.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l70.1"></a><span id="l70.1" class="difflineminus">--- a/mailnews/news/src/nsNewsFolder.cpp</span>
<a href="#l70.2"></a><span id="l70.2" class="difflineplus">+++ b/mailnews/news/src/nsNewsFolder.cpp</span>
<a href="#l70.3"></a><span id="l70.3" class="difflineat">@@ -1231,18 +1231,17 @@ nsMsgNewsFolder::GetAuthenticationCreden</span>
<a href="#l70.4"></a><span id="l70.4">       if (!dialog) return NS_ERROR_FAILURE;</span>
<a href="#l70.5"></a><span id="l70.5">     }</span>
<a href="#l70.6"></a><span id="l70.6"> </span>
<a href="#l70.7"></a><span id="l70.7">     NS_ASSERTION(dialog, &quot;We didn't get a net prompt&quot;);</span>
<a href="#l70.8"></a><span id="l70.8">     if (dialog)</span>
<a href="#l70.9"></a><span id="l70.9">     {</span>
<a href="#l70.10"></a><span id="l70.10">       // Format the prompt text strings</span>
<a href="#l70.11"></a><span id="l70.11">       nsString promptTitle, promptText;</span>
<a href="#l70.12"></a><span id="l70.12" class="difflineminus">-      bundle-&gt;GetStringFromName(&quot;enterUserPassTitle&quot;,</span>
<a href="#l70.13"></a><span id="l70.13" class="difflineminus">-        getter_Copies(promptTitle));</span>
<a href="#l70.14"></a><span id="l70.14" class="difflineplus">+      bundle-&gt;GetStringFromName(&quot;enterUserPassTitle&quot;, promptTitle);</span>
<a href="#l70.15"></a><span id="l70.15"> </span>
<a href="#l70.16"></a><span id="l70.16">       nsString serverName;</span>
<a href="#l70.17"></a><span id="l70.17">       nsCOMPtr&lt;nsIMsgIncomingServer&gt; server;</span>
<a href="#l70.18"></a><span id="l70.18">       rv = GetServer(getter_AddRefs(server));</span>
<a href="#l70.19"></a><span id="l70.19">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l70.20"></a><span id="l70.20"> </span>
<a href="#l70.21"></a><span id="l70.21">       server-&gt;GetPrettyName(serverName);</span>
<a href="#l70.22"></a><span id="l70.22"> </span>
<a href="#l70.23"></a><span id="l70.23" class="difflineat">@@ -1254,21 +1253,21 @@ nsMsgNewsFolder::GetAuthenticationCreden</span>
<a href="#l70.24"></a><span id="l70.24">       nntpServer-&gt;GetSingleSignon(&amp;singleSignon);</span>
<a href="#l70.25"></a><span id="l70.25"> </span>
<a href="#l70.26"></a><span id="l70.26">       const char16_t *params[2];</span>
<a href="#l70.27"></a><span id="l70.27">       params[0] = mName.get();</span>
<a href="#l70.28"></a><span id="l70.28">       params[1] = serverName.get();</span>
<a href="#l70.29"></a><span id="l70.29">       if (singleSignon)</span>
<a href="#l70.30"></a><span id="l70.30">         bundle-&gt;FormatStringFromName(</span>
<a href="#l70.31"></a><span id="l70.31">           &quot;enterUserPassServer&quot;,</span>
<a href="#l70.32"></a><span id="l70.32" class="difflineminus">-          &amp;params[1], 1, getter_Copies(promptText));</span>
<a href="#l70.33"></a><span id="l70.33" class="difflineplus">+          &amp;params[1], 1, promptText);</span>
<a href="#l70.34"></a><span id="l70.34">       else</span>
<a href="#l70.35"></a><span id="l70.35">         bundle-&gt;FormatStringFromName(</span>
<a href="#l70.36"></a><span id="l70.36">           &quot;enterUserPassGroup&quot;,</span>
<a href="#l70.37"></a><span id="l70.37" class="difflineminus">-          params, 2, getter_Copies(promptText));</span>
<a href="#l70.38"></a><span id="l70.38" class="difflineplus">+          params, 2, promptText);</span>
<a href="#l70.39"></a><span id="l70.39"> </span>
<a href="#l70.40"></a><span id="l70.40">       // Fill the signon url for the dialog</span>
<a href="#l70.41"></a><span id="l70.41">       nsString signonURL;</span>
<a href="#l70.42"></a><span id="l70.42">       rv = CreateNewsgroupUrlForSignon(nullptr, signonURL);</span>
<a href="#l70.43"></a><span id="l70.43">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l70.44"></a><span id="l70.44"> </span>
<a href="#l70.45"></a><span id="l70.45">       // Prefill saved username/password</span>
<a href="#l70.46"></a><span id="l70.46">       char16_t *uniGroupUsername = ToNewUnicode(</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l71.1"></a><span id="l71.1" class="difflineminus">--- a/mailnews/news/src/nsNntpIncomingServer.cpp</span>
<a href="#l71.2"></a><span id="l71.2" class="difflineplus">+++ b/mailnews/news/src/nsNntpIncomingServer.cpp</span>
<a href="#l71.3"></a><span id="l71.3" class="difflineat">@@ -1577,17 +1577,17 @@ nsNntpIncomingServer::GroupNotFound(nsIM</span>
<a href="#l71.4"></a><span id="l71.4">   NS_ConvertUTF8toUTF16 hostStr(hostname);</span>
<a href="#l71.5"></a><span id="l71.5"> </span>
<a href="#l71.6"></a><span id="l71.6">   nsString groupName(aName);</span>
<a href="#l71.7"></a><span id="l71.7">   const char16_t *formatStrings[2] = { groupName.get(), hostStr.get() };</span>
<a href="#l71.8"></a><span id="l71.8">   nsString confirmText;</span>
<a href="#l71.9"></a><span id="l71.9">   rv = bundle-&gt;FormatStringFromName(</span>
<a href="#l71.10"></a><span id="l71.10">                     &quot;autoUnsubscribeText&quot;,</span>
<a href="#l71.11"></a><span id="l71.11">                     formatStrings, 2,</span>
<a href="#l71.12"></a><span id="l71.12" class="difflineminus">-                    getter_Copies(confirmText));</span>
<a href="#l71.13"></a><span id="l71.13" class="difflineplus">+                    confirmText);</span>
<a href="#l71.14"></a><span id="l71.14">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l71.15"></a><span id="l71.15"> </span>
<a href="#l71.16"></a><span id="l71.16">   bool confirmResult = false;</span>
<a href="#l71.17"></a><span id="l71.17">   rv = prompt-&gt;Confirm(nullptr, confirmText.get(), &amp;confirmResult);</span>
<a href="#l71.18"></a><span id="l71.18">   NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l71.19"></a><span id="l71.19"> </span>
<a href="#l71.20"></a><span id="l71.20">   if (confirmResult) {</span>
<a href="#l71.21"></a><span id="l71.21">     rv = Unsubscribe(groupName.get());</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l72.1"></a><span id="l72.1" class="difflineminus">--- a/suite/shell/src/nsGNOMEShellService.cpp</span>
<a href="#l72.2"></a><span id="l72.2" class="difflineplus">+++ b/suite/shell/src/nsGNOMEShellService.cpp</span>
<a href="#l72.3"></a><span id="l72.3" class="difflineat">@@ -89,18 +89,17 @@ GetBrandName(nsACString&amp; aBrandName)</span>
<a href="#l72.4"></a><span id="l72.4">   nsCOMPtr&lt;nsIStringBundleService&gt; bundleService(do_GetService(&quot;@mozilla.org/intl/stringbundle;1&quot;, &amp;rv));</span>
<a href="#l72.5"></a><span id="l72.5">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l72.6"></a><span id="l72.6"> </span>
<a href="#l72.7"></a><span id="l72.7">   nsCOMPtr&lt;nsIStringBundle&gt; brandBundle;</span>
<a href="#l72.8"></a><span id="l72.8">   rv = bundleService-&gt;CreateBundle(BRAND_PROPERTIES, getter_AddRefs(brandBundle));</span>
<a href="#l72.9"></a><span id="l72.9">   NS_ENSURE_TRUE(brandBundle, rv);</span>
<a href="#l72.10"></a><span id="l72.10"> </span>
<a href="#l72.11"></a><span id="l72.11">   nsString brandName;</span>
<a href="#l72.12"></a><span id="l72.12" class="difflineminus">-  rv = brandBundle-&gt;GetStringFromName(&quot;brandShortName&quot;,</span>
<a href="#l72.13"></a><span id="l72.13" class="difflineminus">-                                      getter_Copies(brandName));</span>
<a href="#l72.14"></a><span id="l72.14" class="difflineplus">+  rv = brandBundle-&gt;GetStringFromName(&quot;brandShortName&quot;, brandName);</span>
<a href="#l72.15"></a><span id="l72.15">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l72.16"></a><span id="l72.16"> </span>
<a href="#l72.17"></a><span id="l72.17">   CopyUTF16toUTF8(brandName, aBrandName);</span>
<a href="#l72.18"></a><span id="l72.18">   return rv;</span>
<a href="#l72.19"></a><span id="l72.19"> }</span>
<a href="#l72.20"></a><span id="l72.20"> </span>
<a href="#l72.21"></a><span id="l72.21"> nsresult</span>
<a href="#l72.22"></a><span id="l72.22"> nsGNOMEShellService::Init()</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l73.1"></a><span id="l73.1" class="difflineminus">--- a/suite/shell/src/nsWindowsShellService.cpp</span>
<a href="#l73.2"></a><span id="l73.2" class="difflineplus">+++ b/suite/shell/src/nsWindowsShellService.cpp</span>
<a href="#l73.3"></a><span id="l73.3" class="difflineat">@@ -776,18 +776,17 @@ nsWindowsShellService::SetDesktopBackgro</span>
<a href="#l73.4"></a><span id="l73.4">   nsCOMPtr&lt;nsIStringBundle&gt; shellBundle;</span>
<a href="#l73.5"></a><span id="l73.5">   rv = bundleService-&gt;CreateBundle(SHELLSERVICE_PROPERTIES,</span>
<a href="#l73.6"></a><span id="l73.6">                                    getter_AddRefs(shellBundle));</span>
<a href="#l73.7"></a><span id="l73.7">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l73.8"></a><span id="l73.8"> </span>
<a href="#l73.9"></a><span id="l73.9">   // e.g. &quot;Desktop Background.bmp&quot;</span>
<a href="#l73.10"></a><span id="l73.10">   nsString fileLeafName;</span>
<a href="#l73.11"></a><span id="l73.11">   rv = shellBundle-&gt;GetStringFromName</span>
<a href="#l73.12"></a><span id="l73.12" class="difflineminus">-                      (&quot;desktopBackgroundLeafNameWin&quot;,</span>
<a href="#l73.13"></a><span id="l73.13" class="difflineminus">-                       getter_Copies(fileLeafName));</span>
<a href="#l73.14"></a><span id="l73.14" class="difflineplus">+                      (&quot;desktopBackgroundLeafNameWin&quot;, fileLeafName);</span>
<a href="#l73.15"></a><span id="l73.15">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l73.16"></a><span id="l73.16"> </span>
<a href="#l73.17"></a><span id="l73.17">   // get the profile root directory</span>
<a href="#l73.18"></a><span id="l73.18">   nsCOMPtr&lt;nsIFile&gt; file;</span>
<a href="#l73.19"></a><span id="l73.19">   rv = NS_GetSpecialDirectory(NS_APP_APPLICATION_REGISTRY_DIR,</span>
<a href="#l73.20"></a><span id="l73.20">                               getter_AddRefs(file));</span>
<a href="#l73.21"></a><span id="l73.21">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l73.22"></a><span id="l73.22"> </span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

