<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 27520:3358ca95426cc108feb4416d31e0f6f436650593</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 3358ca95426cc108feb4416d31e0f6f436650593" />
<meta property="og:url" content="/comm-central/rev/3358ca95426cc108feb4416d31e0f6f436650593" />
<meta property="og:description" content="Bug 1575046 - Allow users to edit existing mailing lists. r=mkmelin" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 3358ca95426cc108feb4416d31e0f6f436650593 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/3358ca95426cc108feb4416d31e0f6f436650593">shortlog</a> |
<a href="/comm-central/log/3358ca95426cc108feb4416d31e0f6f436650593">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/3358ca95426cc108feb4416d31e0f6f436650593">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/3358ca95426cc108feb4416d31e0f6f436650593">files</a> |
changeset |
<a href="/comm-central/raw-rev/3358ca95426cc108feb4416d31e0f6f436650593">raw</a>  | <a href="/comm-central/archive/3358ca95426cc108feb4416d31e0f6f436650593.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1575046">Bug 1575046</a> - Allow users to edit existing mailing lists. r=mkmelin
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#80;&#97;&#117;&#108;&#32;&#77;&#111;&#114;&#114;&#105;&#115;&#32;&#60;&#112;&#97;&#117;&#108;&#64;&#116;&#104;&#117;&#110;&#100;&#101;&#114;&#98;&#105;&#114;&#100;&#46;&#110;&#101;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 06 Sep 2019 12:14:51 -0400</td></tr>

<tr>
 <td>changeset 27520</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/3358ca95426cc108feb4416d31e0f6f436650593">3358ca95426cc108feb4416d31e0f6f436650593</a></td>
</tr>



<tr>
<td>parent 27519</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/1bffbb9820b34158dc96d3c468211cf6d823c71d">1bffbb9820b34158dc96d3c468211cf6d823c71d</a>
</td>
</tr>

<tr>
<td>child 27521</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/a904da1f13fe22ae563124444197ccb2c826ba34">a904da1f13fe22ae563124444197ccb2c826ba34</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=3358ca95426cc108feb4416d31e0f6f436650593">16373</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Fri, 06 Sep 2019 21:57:47 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@2609bc8cf72b [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=2609bc8cf72ba8ff2fd7530e553f577b8261bed2">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=2609bc8cf72ba8ff2fd7530e553f577b8261bed2&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=2609bc8cf72ba8ff2fd7530e553f577b8261bed2&newProject=comm-central&newRevision=c42051e85e3a85ec156195bf1f20246df46f6c70&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=2609bc8cf72ba8ff2fd7530e553f577b8261bed2&newProject=comm-central&newRevision=c42051e85e3a85ec156195bf1f20246df46f6c70&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=2609bc8cf72ba8ff2fd7530e553f577b8261bed2&newProject=comm-central&newRevision=c42051e85e3a85ec156195bf1f20246df46f6c70&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28mkmelin%29&revcount=50">mkmelin</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1575046">1575046</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=37435">37435</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1575046">Bug 1575046</a> - Allow users to edit existing mailing lists. r=mkmelin

If a user opened a saved mailing list (from the address book
dialog) and tried to edit or delete one of the addresses,
then clicked the OK button, the changes were not saved.

Perhaps this was caused by de-XBL changes? The fix was to
not set the 'textbox.value' property (as introduced by
the fix for <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=37435">bug 37435</a>), since that was preventing that
property from updating to what the user typed in.

I tested to see if the problem from <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=37435">bug 37435</a> returned
after this change and was not able to reproduce it.
All message recipients were sent the message as expected.</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/3358ca95426cc108feb4416d31e0f6f436650593/mailnews/addrbook/content/abMailListDialog.js">mailnews/addrbook/content/abMailListDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/3358ca95426cc108feb4416d31e0f6f436650593/mailnews/addrbook/content/abMailListDialog.js">file</a> |
<a href="/comm-central/annotate/3358ca95426cc108feb4416d31e0f6f436650593/mailnews/addrbook/content/abMailListDialog.js">annotate</a> |
<a href="/comm-central/diff/3358ca95426cc108feb4416d31e0f6f436650593/mailnews/addrbook/content/abMailListDialog.js">diff</a> |
<a href="/comm-central/comparison/3358ca95426cc108feb4416d31e0f6f436650593/mailnews/addrbook/content/abMailListDialog.js">comparison</a> |
<a href="/comm-central/log/3358ca95426cc108feb4416d31e0f6f436650593/mailnews/addrbook/content/abMailListDialog.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mailnews/addrbook/content/abMailListDialog.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mailnews/addrbook/content/abMailListDialog.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -329,20 +329,17 @@ function AppendNewRowAndSetFocus() {</span>
<a href="#l1.4"></a><span id="l1.4"> function SetInputValue(inputValue, parentNode, templateNode) {</span>
<a href="#l1.5"></a><span id="l1.5">   top.MAX_RECIPIENTS++;</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7">   var newNode = templateNode.cloneNode(true);</span>
<a href="#l1.8"></a><span id="l1.8">   parentNode.appendChild(newNode); // we need to insert the new node before we set the value of the select element!</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10">   var input = newNode.getElementsByTagName(awInputElementName());</span>
<a href="#l1.11"></a><span id="l1.11">   if (input &amp;&amp; input.length == 1) {</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-    // We need to set the value using both setAttribute and .value else we will</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-    // lose the content when the field is not visible. See bug 37435</span>
<a href="#l1.14"></a><span id="l1.14">     input[0].setAttribute(&quot;value&quot;, inputValue);</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineminus">-    input[0].value = inputValue;</span>
<a href="#l1.16"></a><span id="l1.16">     input[0].setAttribute(&quot;id&quot;, &quot;addressCol1#&quot; + top.MAX_RECIPIENTS);</span>
<a href="#l1.17"></a><span id="l1.17">   }</span>
<a href="#l1.18"></a><span id="l1.18"> }</span>
<a href="#l1.19"></a><span id="l1.19"> </span>
<a href="#l1.20"></a><span id="l1.20"> function awNotAnEmptyArea(event) {</span>
<a href="#l1.21"></a><span id="l1.21">   // This is temporary until i figure out how to ensure to always having an empty space after the last row</span>
<a href="#l1.22"></a><span id="l1.22"> </span>
<a href="#l1.23"></a><span id="l1.23">   var lastInput = awGetInputElement(top.MAX_RECIPIENTS);</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:32Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

