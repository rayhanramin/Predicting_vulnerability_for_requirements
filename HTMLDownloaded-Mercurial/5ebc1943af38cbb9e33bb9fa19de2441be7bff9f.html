<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 24092:5ebc1943af38cbb9e33bb9fa19de2441be7bff9f</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 5ebc1943af38cbb9e33bb9fa19de2441be7bff9f" />
<meta property="og:url" content="/comm-central/rev/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f" />
<meta property="og:description" content="Bug 1463266 - replace tabs with spaces in ldap/. rs=white-space-only" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 5ebc1943af38cbb9e33bb9fa19de2441be7bff9f 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f">shortlog</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f">files</a> |
changeset |
<a href="/comm-central/raw-rev/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f">raw</a>  | <a href="/comm-central/archive/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1463266">Bug 1463266</a> - replace tabs with spaces in ldap/. rs=white-space-only
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#74;&#111;&#114;&#103;&#32;&#75;&#32;&#60;&#106;&#111;&#114;&#103;&#107;&#64;&#106;&#111;&#114;&#103;&#107;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 15 Jun 2018 23:21:47 +0200</td></tr>

<tr>
 <td>changeset 24092</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f">5ebc1943af38cbb9e33bb9fa19de2441be7bff9f</a></td>
</tr>



<tr>
<td>parent 24091</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/f41fe8a63f2b280c03c69a1ea4945b77a182bcbb">f41fe8a63f2b280c03c69a1ea4945b77a182bcbb</a>
</td>
</tr>

<tr>
<td>child 24093</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/829b7ff18e5b385deec7bc1fc72ed1dc305f539e">829b7ff18e5b385deec7bc1fc72ed1dc305f539e</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=5ebc1943af38cbb9e33bb9fa19de2441be7bff9f">14526</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Fri, 15 Jun 2018 21:55:56 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@5ebc1943af38 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=5ebc1943af38cbb9e33bb9fa19de2441be7bff9f">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=5ebc1943af38cbb9e33bb9fa19de2441be7bff9f&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=5ebc1943af38cbb9e33bb9fa19de2441be7bff9f&newProject=comm-central&newRevision=5ebc1943af38cbb9e33bb9fa19de2441be7bff9f&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=5ebc1943af38cbb9e33bb9fa19de2441be7bff9f&newProject=comm-central&newRevision=5ebc1943af38cbb9e33bb9fa19de2441be7bff9f&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=5ebc1943af38cbb9e33bb9fa19de2441be7bff9f&newProject=comm-central&newRevision=5ebc1943af38cbb9e33bb9fa19de2441be7bff9f&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28white-space-only%29&revcount=50">white-space-only</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1463266">1463266</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1463266">Bug 1463266</a> - replace tabs with spaces in ldap/. rs=white-space-only
[skip-blame]</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/disptmpl.h">ldap/c-sdk/include/disptmpl.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/disptmpl.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/disptmpl.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/disptmpl.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/disptmpl.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/disptmpl.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/iutil.h">ldap/c-sdk/include/iutil.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/iutil.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/iutil.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/iutil.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/iutil.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/iutil.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/lber.h">ldap/c-sdk/include/lber.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/lber.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/lber.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/lber.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/lber.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/lber.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/lcache.h">ldap/c-sdk/include/lcache.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/lcache.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/lcache.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/lcache.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/lcache.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/lcache.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-extension.h">ldap/c-sdk/include/ldap-extension.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-extension.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-extension.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-extension.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-extension.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-extension.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-platform.h">ldap/c-sdk/include/ldap-platform.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-platform.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-platform.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-platform.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-platform.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-platform.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-standard.h">ldap/c-sdk/include/ldap-standard.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-standard.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-standard.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-standard.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-standard.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-standard.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-to-be-deprecated.h">ldap/c-sdk/include/ldap-to-be-deprecated.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-to-be-deprecated.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-to-be-deprecated.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-to-be-deprecated.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-to-be-deprecated.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap-to-be-deprecated.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap_ssl.h">ldap/c-sdk/include/ldap_ssl.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap_ssl.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap_ssl.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap_ssl.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap_ssl.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldap_ssl.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldaplog.h">ldap/c-sdk/include/ldaplog.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldaplog.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldaplog.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldaplog.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldaplog.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldaplog.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldappr.h">ldap/c-sdk/include/ldappr.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldappr.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldappr.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldappr.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldappr.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldappr.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldaprot.h">ldap/c-sdk/include/ldaprot.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldaprot.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldaprot.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldaprot.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldaprot.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldaprot.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldif.h">ldap/c-sdk/include/ldif.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldif.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldif.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldif.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldif.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/ldif.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/portable.h">ldap/c-sdk/include/portable.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/portable.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/portable.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/portable.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/portable.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/portable.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/proto-ntutil.h">ldap/c-sdk/include/proto-ntutil.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/proto-ntutil.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/proto-ntutil.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/proto-ntutil.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/proto-ntutil.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/proto-ntutil.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/regex.h">ldap/c-sdk/include/regex.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/regex.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/regex.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/regex.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/regex.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/regex.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/srchpref.h">ldap/c-sdk/include/srchpref.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/srchpref.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/srchpref.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/srchpref.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/srchpref.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/include/srchpref.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/liblber/lber-int.h">ldap/c-sdk/libraries/liblber/lber-int.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/liblber/lber-int.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/liblber/lber-int.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/liblber/lber-int.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/liblber/lber-int.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/liblber/lber-int.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/libldap/ldap-int.h">ldap/c-sdk/libraries/libldap/ldap-int.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/libldap/ldap-int.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/libldap/ldap-int.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/libldap/ldap-int.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/libldap/ldap-int.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/libldap/ldap-int.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/libprldap/ldappr-int.h">ldap/c-sdk/libraries/libprldap/ldappr-int.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/libprldap/ldappr-int.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/libprldap/ldappr-int.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/libprldap/ldappr-int.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/libprldap/ldappr-int.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/c-sdk/libraries/libprldap/ldappr-int.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPBERValue.h">ldap/xpcom/src/nsLDAPBERValue.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPBERValue.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPBERValue.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPBERValue.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPBERValue.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPBERValue.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPConnection.cpp">ldap/xpcom/src/nsLDAPConnection.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPConnection.cpp">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPConnection.cpp">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPConnection.cpp">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPConnection.cpp">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPConnection.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPControl.h">ldap/xpcom/src/nsLDAPControl.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPControl.h">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPControl.h">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPControl.h">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPControl.h">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPControl.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPProtocolHandler.js">ldap/xpcom/src/nsLDAPProtocolHandler.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPProtocolHandler.js">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPProtocolHandler.js">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPProtocolHandler.js">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPProtocolHandler.js">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPProtocolHandler.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPSecurityGlue.cpp">ldap/xpcom/src/nsLDAPSecurityGlue.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPSecurityGlue.cpp">file</a> |
<a href="/comm-central/annotate/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPSecurityGlue.cpp">annotate</a> |
<a href="/comm-central/diff/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPSecurityGlue.cpp">diff</a> |
<a href="/comm-central/comparison/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPSecurityGlue.cpp">comparison</a> |
<a href="/comm-central/log/5ebc1943af38cbb9e33bb9fa19de2441be7bff9f/ldap/xpcom/src/nsLDAPSecurityGlue.cpp">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/ldap/c-sdk/include/disptmpl.h</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/ldap/c-sdk/include/disptmpl.h</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -71,308 +71,308 @@ extern &quot;C&quot; {</span>
<a href="#l1.4"></a><span id="l1.4"> #else /* _WINDOWS */</span>
<a href="#l1.5"></a><span id="l1.5"> #define LDAP_C</span>
<a href="#l1.6"></a><span id="l1.6"> #define LDAP_CALLBACK</span>
<a href="#l1.7"></a><span id="l1.7"> #define LDAP_PASCAL</span>
<a href="#l1.8"></a><span id="l1.8"> #define LDAP_CALL</span>
<a href="#l1.9"></a><span id="l1.9"> #endif /* _WINDOWS */</span>
<a href="#l1.10"></a><span id="l1.10"> #endif /* LDAP_CALL */</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-#define LDAP_TEMPLATE_VERSION	1</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+#define LDAP_TEMPLATE_VERSION 1</span>
<a href="#l1.14"></a><span id="l1.14"> </span>
<a href="#l1.15"></a><span id="l1.15"> /*</span>
<a href="#l1.16"></a><span id="l1.16">  * general types of items (confined to most significant byte)</span>
<a href="#l1.17"></a><span id="l1.17">  */</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineminus">-#define LDAP_SYN_TYPE_TEXT		0x01000000L</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineminus">-#define LDAP_SYN_TYPE_IMAGE		0x02000000L</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineminus">-#define LDAP_SYN_TYPE_BOOLEAN		0x04000000L</span>
<a href="#l1.21"></a><span id="l1.21" class="difflineminus">-#define LDAP_SYN_TYPE_BUTTON		0x08000000L</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineminus">-#define LDAP_SYN_TYPE_ACTION		0x10000000L</span>
<a href="#l1.23"></a><span id="l1.23" class="difflineplus">+#define LDAP_SYN_TYPE_TEXT    0x01000000L</span>
<a href="#l1.24"></a><span id="l1.24" class="difflineplus">+#define LDAP_SYN_TYPE_IMAGE   0x02000000L</span>
<a href="#l1.25"></a><span id="l1.25" class="difflineplus">+#define LDAP_SYN_TYPE_BOOLEAN 0x04000000L</span>
<a href="#l1.26"></a><span id="l1.26" class="difflineplus">+#define LDAP_SYN_TYPE_BUTTON  0x08000000L</span>
<a href="#l1.27"></a><span id="l1.27" class="difflineplus">+#define LDAP_SYN_TYPE_ACTION  0x10000000L</span>
<a href="#l1.28"></a><span id="l1.28"> </span>
<a href="#l1.29"></a><span id="l1.29"> </span>
<a href="#l1.30"></a><span id="l1.30"> /*</span>
<a href="#l1.31"></a><span id="l1.31">  * syntax options (confined to second most significant byte)</span>
<a href="#l1.32"></a><span id="l1.32">  */</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineminus">-#define LDAP_SYN_OPT_DEFER		0x00010000L</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineplus">+#define LDAP_SYN_OPT_DEFER 0x00010000L</span>
<a href="#l1.35"></a><span id="l1.35"> </span>
<a href="#l1.36"></a><span id="l1.36"> </span>
<a href="#l1.37"></a><span id="l1.37"> /*</span>
<a href="#l1.38"></a><span id="l1.38">  * display template item syntax ids (defined by common agreement)</span>
<a href="#l1.39"></a><span id="l1.39">  * these are the valid values for the ti_syntaxid of the tmplitem</span>
<a href="#l1.40"></a><span id="l1.40">  * struct (defined below).  A general type is encoded in the</span>
<a href="#l1.41"></a><span id="l1.41">  * most-significant 8 bits, and some options are encoded in the next</span>
<a href="#l1.42"></a><span id="l1.42">  * 8 bits.  The lower 16 bits are reserved for the distinct types.</span>
<a href="#l1.43"></a><span id="l1.43">  */</span>
<a href="#l1.44"></a><span id="l1.44" class="difflineminus">-#define LDAP_SYN_CASEIGNORESTR	( 1 | LDAP_SYN_TYPE_TEXT )</span>
<a href="#l1.45"></a><span id="l1.45" class="difflineminus">-#define LDAP_SYN_MULTILINESTR	( 2 | LDAP_SYN_TYPE_TEXT )</span>
<a href="#l1.46"></a><span id="l1.46" class="difflineminus">-#define LDAP_SYN_DN		( 3 | LDAP_SYN_TYPE_TEXT )</span>
<a href="#l1.47"></a><span id="l1.47" class="difflineminus">-#define LDAP_SYN_BOOLEAN	( 4 | LDAP_SYN_TYPE_BOOLEAN )</span>
<a href="#l1.48"></a><span id="l1.48" class="difflineminus">-#define LDAP_SYN_JPEGIMAGE	( 5 | LDAP_SYN_TYPE_IMAGE )</span>
<a href="#l1.49"></a><span id="l1.49" class="difflineminus">-#define LDAP_SYN_JPEGBUTTON	( 6 | LDAP_SYN_TYPE_BUTTON | LDAP_SYN_OPT_DEFER )</span>
<a href="#l1.50"></a><span id="l1.50" class="difflineminus">-#define LDAP_SYN_FAXIMAGE	( 7 | LDAP_SYN_TYPE_IMAGE )</span>
<a href="#l1.51"></a><span id="l1.51" class="difflineminus">-#define LDAP_SYN_FAXBUTTON	( 8 | LDAP_SYN_TYPE_BUTTON | LDAP_SYN_OPT_DEFER )</span>
<a href="#l1.52"></a><span id="l1.52" class="difflineminus">-#define LDAP_SYN_AUDIOBUTTON	( 9 | LDAP_SYN_TYPE_BUTTON | LDAP_SYN_OPT_DEFER )</span>
<a href="#l1.53"></a><span id="l1.53" class="difflineminus">-#define LDAP_SYN_TIME		( 10 | LDAP_SYN_TYPE_TEXT )</span>
<a href="#l1.54"></a><span id="l1.54" class="difflineminus">-#define LDAP_SYN_DATE		( 11 | LDAP_SYN_TYPE_TEXT )</span>
<a href="#l1.55"></a><span id="l1.55" class="difflineminus">-#define LDAP_SYN_LABELEDURL	( 12 | LDAP_SYN_TYPE_TEXT )</span>
<a href="#l1.56"></a><span id="l1.56" class="difflineminus">-#define LDAP_SYN_SEARCHACTION	( 13 | LDAP_SYN_TYPE_ACTION )</span>
<a href="#l1.57"></a><span id="l1.57" class="difflineminus">-#define LDAP_SYN_LINKACTION	( 14 | LDAP_SYN_TYPE_ACTION )</span>
<a href="#l1.58"></a><span id="l1.58" class="difflineminus">-#define LDAP_SYN_ADDDNACTION	( 15 | LDAP_SYN_TYPE_ACTION )</span>
<a href="#l1.59"></a><span id="l1.59" class="difflineplus">+#define LDAP_SYN_CASEIGNORESTR  ( 1 | LDAP_SYN_TYPE_TEXT )</span>
<a href="#l1.60"></a><span id="l1.60" class="difflineplus">+#define LDAP_SYN_MULTILINESTR   ( 2 | LDAP_SYN_TYPE_TEXT )</span>
<a href="#l1.61"></a><span id="l1.61" class="difflineplus">+#define LDAP_SYN_DN             ( 3 | LDAP_SYN_TYPE_TEXT )</span>
<a href="#l1.62"></a><span id="l1.62" class="difflineplus">+#define LDAP_SYN_BOOLEAN        ( 4 | LDAP_SYN_TYPE_BOOLEAN )</span>
<a href="#l1.63"></a><span id="l1.63" class="difflineplus">+#define LDAP_SYN_JPEGIMAGE      ( 5 | LDAP_SYN_TYPE_IMAGE )</span>
<a href="#l1.64"></a><span id="l1.64" class="difflineplus">+#define LDAP_SYN_JPEGBUTTON     ( 6 | LDAP_SYN_TYPE_BUTTON | LDAP_SYN_OPT_DEFER )</span>
<a href="#l1.65"></a><span id="l1.65" class="difflineplus">+#define LDAP_SYN_FAXIMAGE       ( 7 | LDAP_SYN_TYPE_IMAGE )</span>
<a href="#l1.66"></a><span id="l1.66" class="difflineplus">+#define LDAP_SYN_FAXBUTTON      ( 8 | LDAP_SYN_TYPE_BUTTON | LDAP_SYN_OPT_DEFER )</span>
<a href="#l1.67"></a><span id="l1.67" class="difflineplus">+#define LDAP_SYN_AUDIOBUTTON    ( 9 | LDAP_SYN_TYPE_BUTTON | LDAP_SYN_OPT_DEFER )</span>
<a href="#l1.68"></a><span id="l1.68" class="difflineplus">+#define LDAP_SYN_TIME           ( 10 | LDAP_SYN_TYPE_TEXT )</span>
<a href="#l1.69"></a><span id="l1.69" class="difflineplus">+#define LDAP_SYN_DATE           ( 11 | LDAP_SYN_TYPE_TEXT )</span>
<a href="#l1.70"></a><span id="l1.70" class="difflineplus">+#define LDAP_SYN_LABELEDURL     ( 12 | LDAP_SYN_TYPE_TEXT )</span>
<a href="#l1.71"></a><span id="l1.71" class="difflineplus">+#define LDAP_SYN_SEARCHACTION   ( 13 | LDAP_SYN_TYPE_ACTION )</span>
<a href="#l1.72"></a><span id="l1.72" class="difflineplus">+#define LDAP_SYN_LINKACTION     ( 14 | LDAP_SYN_TYPE_ACTION )</span>
<a href="#l1.73"></a><span id="l1.73" class="difflineplus">+#define LDAP_SYN_ADDDNACTION    ( 15 | LDAP_SYN_TYPE_ACTION )</span>
<a href="#l1.74"></a><span id="l1.74"> #define LDAP_SYN_VERIFYDNACTION ( 16 | LDAP_SYN_TYPE_ACTION )</span>
<a href="#l1.75"></a><span id="l1.75" class="difflineminus">-#define LDAP_SYN_RFC822ADDR	( 17 | LDAP_SYN_TYPE_TEXT )</span>
<a href="#l1.76"></a><span id="l1.76" class="difflineplus">+#define LDAP_SYN_RFC822ADDR     ( 17 | LDAP_SYN_TYPE_TEXT )</span>
<a href="#l1.77"></a><span id="l1.77"> </span>
<a href="#l1.78"></a><span id="l1.78"> </span>
<a href="#l1.79"></a><span id="l1.79"> /*</span>
<a href="#l1.80"></a><span id="l1.80">  * handy macros</span>
<a href="#l1.81"></a><span id="l1.81">  */</span>
<a href="#l1.82"></a><span id="l1.82" class="difflineminus">-#define LDAP_GET_SYN_TYPE( syid )	((syid) &amp; 0xFF000000UL )</span>
<a href="#l1.83"></a><span id="l1.83" class="difflineminus">-#define LDAP_GET_SYN_OPTIONS( syid )	((syid) &amp; 0x00FF0000UL )</span>
<a href="#l1.84"></a><span id="l1.84" class="difflineplus">+#define LDAP_GET_SYN_TYPE( syid )    ((syid) &amp; 0xFF000000UL )</span>
<a href="#l1.85"></a><span id="l1.85" class="difflineplus">+#define LDAP_GET_SYN_OPTIONS( syid ) ((syid) &amp; 0x00FF0000UL )</span>
<a href="#l1.86"></a><span id="l1.86"> </span>
<a href="#l1.87"></a><span id="l1.87"> </span>
<a href="#l1.88"></a><span id="l1.88"> /*</span>
<a href="#l1.89"></a><span id="l1.89">  * display options for output routines (used by entry2text and friends)</span>
<a href="#l1.90"></a><span id="l1.90">  */</span>
<a href="#l1.91"></a><span id="l1.91"> /*</span>
<a href="#l1.92"></a><span id="l1.92">  * use calculated label width (based on length of longest label in</span>
<a href="#l1.93"></a><span id="l1.93">  * template) instead of contant width</span>
<a href="#l1.94"></a><span id="l1.94">  */</span>
<a href="#l1.95"></a><span id="l1.95" class="difflineminus">-#define LDAP_DISP_OPT_AUTOLABELWIDTH	0x00000001L</span>
<a href="#l1.96"></a><span id="l1.96" class="difflineminus">-#define LDAP_DISP_OPT_HTMLBODYONLY	0x00000002L</span>
<a href="#l1.97"></a><span id="l1.97" class="difflineplus">+#define LDAP_DISP_OPT_AUTOLABELWIDTH 0x00000001L</span>
<a href="#l1.98"></a><span id="l1.98" class="difflineplus">+#define LDAP_DISP_OPT_HTMLBODYONLY   0x00000002L</span>
<a href="#l1.99"></a><span id="l1.99"> </span>
<a href="#l1.100"></a><span id="l1.100"> /*</span>
<a href="#l1.101"></a><span id="l1.101">  * perform search actions (applies to ldap_entry2text_search only)</span>
<a href="#l1.102"></a><span id="l1.102">  */</span>
<a href="#l1.103"></a><span id="l1.103" class="difflineminus">-#define LDAP_DISP_OPT_DOSEARCHACTIONS	0x00000002L</span>
<a href="#l1.104"></a><span id="l1.104" class="difflineplus">+#define LDAP_DISP_OPT_DOSEARCHACTIONS 0x00000002L</span>
<a href="#l1.105"></a><span id="l1.105"> </span>
<a href="#l1.106"></a><span id="l1.106"> /*</span>
<a href="#l1.107"></a><span id="l1.107">  * include additional info. relevant to &quot;non leaf&quot; entries only</span>
<a href="#l1.108"></a><span id="l1.108">  * used by ldap_entry2html and ldap_entry2html_search to include &quot;Browse&quot;</span>
<a href="#l1.109"></a><span id="l1.109">  * and &quot;Move Up&quot; HREFs</span>
<a href="#l1.110"></a><span id="l1.110">  */</span>
<a href="#l1.111"></a><span id="l1.111" class="difflineminus">-#define LDAP_DISP_OPT_NONLEAF		0x00000004L</span>
<a href="#l1.112"></a><span id="l1.112" class="difflineplus">+#define LDAP_DISP_OPT_NONLEAF 0x00000004L</span>
<a href="#l1.113"></a><span id="l1.113"> </span>
<a href="#l1.114"></a><span id="l1.114"> </span>
<a href="#l1.115"></a><span id="l1.115"> /*</span>
<a href="#l1.116"></a><span id="l1.116">  * display template item options (may not apply to all types)</span>
<a href="#l1.117"></a><span id="l1.117">  * if this bit is set in ti_options, it applies.</span>
<a href="#l1.118"></a><span id="l1.118">  */</span>
<a href="#l1.119"></a><span id="l1.119" class="difflineminus">-#define LDAP_DITEM_OPT_READONLY		0x00000001L</span>
<a href="#l1.120"></a><span id="l1.120" class="difflineminus">-#define LDAP_DITEM_OPT_SORTVALUES	0x00000002L</span>
<a href="#l1.121"></a><span id="l1.121" class="difflineminus">-#define LDAP_DITEM_OPT_SINGLEVALUED	0x00000004L</span>
<a href="#l1.122"></a><span id="l1.122" class="difflineminus">-#define LDAP_DITEM_OPT_HIDEIFEMPTY	0x00000008L</span>
<a href="#l1.123"></a><span id="l1.123" class="difflineminus">-#define LDAP_DITEM_OPT_VALUEREQUIRED	0x00000010L</span>
<a href="#l1.124"></a><span id="l1.124" class="difflineminus">-#define LDAP_DITEM_OPT_HIDEIFFALSE	0x00000020L	/* booleans only */</span>
<a href="#l1.125"></a><span id="l1.125" class="difflineplus">+#define LDAP_DITEM_OPT_READONLY      0x00000001L</span>
<a href="#l1.126"></a><span id="l1.126" class="difflineplus">+#define LDAP_DITEM_OPT_SORTVALUES    0x00000002L</span>
<a href="#l1.127"></a><span id="l1.127" class="difflineplus">+#define LDAP_DITEM_OPT_SINGLEVALUED  0x00000004L</span>
<a href="#l1.128"></a><span id="l1.128" class="difflineplus">+#define LDAP_DITEM_OPT_HIDEIFEMPTY   0x00000008L</span>
<a href="#l1.129"></a><span id="l1.129" class="difflineplus">+#define LDAP_DITEM_OPT_VALUEREQUIRED 0x00000010L</span>
<a href="#l1.130"></a><span id="l1.130" class="difflineplus">+#define LDAP_DITEM_OPT_HIDEIFFALSE   0x00000020L  /* booleans only */</span>
<a href="#l1.131"></a><span id="l1.131"> </span>
<a href="#l1.132"></a><span id="l1.132"> </span>
<a href="#l1.133"></a><span id="l1.133"> </span>
<a href="#l1.134"></a><span id="l1.134"> /*</span>
<a href="#l1.135"></a><span id="l1.135">  * display template item structure</span>
<a href="#l1.136"></a><span id="l1.136">  */</span>
<a href="#l1.137"></a><span id="l1.137"> struct ldap_tmplitem {</span>
<a href="#l1.138"></a><span id="l1.138" class="difflineminus">-    unsigned long		ti_syntaxid;</span>
<a href="#l1.139"></a><span id="l1.139" class="difflineminus">-    unsigned long		ti_options;</span>
<a href="#l1.140"></a><span id="l1.140" class="difflineminus">-    char  			*ti_attrname;</span>
<a href="#l1.141"></a><span id="l1.141" class="difflineminus">-    char			*ti_label;</span>
<a href="#l1.142"></a><span id="l1.142" class="difflineminus">-    char			**ti_args;</span>
<a href="#l1.143"></a><span id="l1.143" class="difflineminus">-    struct ldap_tmplitem	*ti_next_in_row;</span>
<a href="#l1.144"></a><span id="l1.144" class="difflineminus">-    struct ldap_tmplitem	*ti_next_in_col;</span>
<a href="#l1.145"></a><span id="l1.145" class="difflineminus">-    void			*ti_appdata;</span>
<a href="#l1.146"></a><span id="l1.146" class="difflineplus">+    unsigned long ti_syntaxid;</span>
<a href="#l1.147"></a><span id="l1.147" class="difflineplus">+    unsigned long ti_options;</span>
<a href="#l1.148"></a><span id="l1.148" class="difflineplus">+    char *ti_attrname;</span>
<a href="#l1.149"></a><span id="l1.149" class="difflineplus">+    char *ti_label;</span>
<a href="#l1.150"></a><span id="l1.150" class="difflineplus">+    char **ti_args;</span>
<a href="#l1.151"></a><span id="l1.151" class="difflineplus">+    struct ldap_tmplitem *ti_next_in_row;</span>
<a href="#l1.152"></a><span id="l1.152" class="difflineplus">+    struct ldap_tmplitem *ti_next_in_col;</span>
<a href="#l1.153"></a><span id="l1.153" class="difflineplus">+    void *ti_appdata;</span>
<a href="#l1.154"></a><span id="l1.154"> };</span>
<a href="#l1.155"></a><span id="l1.155"> </span>
<a href="#l1.156"></a><span id="l1.156"> </span>
<a href="#l1.157"></a><span id="l1.157" class="difflineminus">-#define NULLTMPLITEM	((struct ldap_tmplitem *)0)</span>
<a href="#l1.158"></a><span id="l1.158" class="difflineplus">+#define NULLTMPLITEM ((struct ldap_tmplitem *)0)</span>
<a href="#l1.159"></a><span id="l1.159"> </span>
<a href="#l1.160"></a><span id="l1.160" class="difflineminus">-#define LDAP_SET_TMPLITEM_APPDATA( ti, datap )	\</span>
<a href="#l1.161"></a><span id="l1.161" class="difflineminus">-	(ti)-&gt;ti_appdata = (void *)(datap)</span>
<a href="#l1.162"></a><span id="l1.162" class="difflineplus">+#define LDAP_SET_TMPLITEM_APPDATA( ti, datap ) \</span>
<a href="#l1.163"></a><span id="l1.163" class="difflineplus">+  (ti)-&gt;ti_appdata = (void *)(datap)</span>
<a href="#l1.164"></a><span id="l1.164"> </span>
<a href="#l1.165"></a><span id="l1.165" class="difflineminus">-#define LDAP_GET_TMPLITEM_APPDATA( ti, type )	\</span>
<a href="#l1.166"></a><span id="l1.166" class="difflineminus">-	(type)((ti)-&gt;ti_appdata)</span>
<a href="#l1.167"></a><span id="l1.167" class="difflineplus">+#define LDAP_GET_TMPLITEM_APPDATA( ti, type ) \</span>
<a href="#l1.168"></a><span id="l1.168" class="difflineplus">+  (type)((ti)-&gt;ti_appdata)</span>
<a href="#l1.169"></a><span id="l1.169"> </span>
<a href="#l1.170"></a><span id="l1.170" class="difflineminus">-#define LDAP_IS_TMPLITEM_OPTION_SET( ti, option )	\</span>
<a href="#l1.171"></a><span id="l1.171" class="difflineminus">-	(((ti)-&gt;ti_options &amp; option ) != 0 )</span>
<a href="#l1.172"></a><span id="l1.172" class="difflineplus">+#define LDAP_IS_TMPLITEM_OPTION_SET( ti, option ) \</span>
<a href="#l1.173"></a><span id="l1.173" class="difflineplus">+  (((ti)-&gt;ti_options &amp; option ) != 0 )</span>
<a href="#l1.174"></a><span id="l1.174"> </span>
<a href="#l1.175"></a><span id="l1.175"> </span>
<a href="#l1.176"></a><span id="l1.176"> /*</span>
<a href="#l1.177"></a><span id="l1.177">  * object class array structure</span>
<a href="#l1.178"></a><span id="l1.178">  */</span>
<a href="#l1.179"></a><span id="l1.179"> struct ldap_oclist {</span>
<a href="#l1.180"></a><span id="l1.180" class="difflineminus">-    char		**oc_objclasses;</span>
<a href="#l1.181"></a><span id="l1.181" class="difflineminus">-    struct ldap_oclist	*oc_next;</span>
<a href="#l1.182"></a><span id="l1.182" class="difflineplus">+    char **oc_objclasses;</span>
<a href="#l1.183"></a><span id="l1.183" class="difflineplus">+    struct ldap_oclist *oc_next;</span>
<a href="#l1.184"></a><span id="l1.184"> };</span>
<a href="#l1.185"></a><span id="l1.185"> </span>
<a href="#l1.186"></a><span id="l1.186" class="difflineminus">-#define NULLOCLIST	((struct ldap_oclist *)0)</span>
<a href="#l1.187"></a><span id="l1.187" class="difflineplus">+#define NULLOCLIST ((struct ldap_oclist *)0)</span>
<a href="#l1.188"></a><span id="l1.188"> </span>
<a href="#l1.189"></a><span id="l1.189"> </span>
<a href="#l1.190"></a><span id="l1.190"> /*</span>
<a href="#l1.191"></a><span id="l1.191">  * add defaults list</span>
<a href="#l1.192"></a><span id="l1.192">  */</span>
<a href="#l1.193"></a><span id="l1.193"> struct ldap_adddeflist {</span>
<a href="#l1.194"></a><span id="l1.194" class="difflineminus">-    int			ad_source;</span>
<a href="#l1.195"></a><span id="l1.195" class="difflineminus">-#define LDAP_ADSRC_CONSTANTVALUE	1</span>
<a href="#l1.196"></a><span id="l1.196" class="difflineminus">-#define LDAP_ADSRC_ADDERSDN		2</span>
<a href="#l1.197"></a><span id="l1.197" class="difflineminus">-    char		*ad_attrname;</span>
<a href="#l1.198"></a><span id="l1.198" class="difflineminus">-    char		*ad_value;</span>
<a href="#l1.199"></a><span id="l1.199" class="difflineminus">-    struct ldap_adddeflist	*ad_next;</span>
<a href="#l1.200"></a><span id="l1.200" class="difflineplus">+    int ad_source;</span>
<a href="#l1.201"></a><span id="l1.201" class="difflineplus">+#define LDAP_ADSRC_CONSTANTVALUE 1</span>
<a href="#l1.202"></a><span id="l1.202" class="difflineplus">+#define LDAP_ADSRC_ADDERSDN 2</span>
<a href="#l1.203"></a><span id="l1.203" class="difflineplus">+    char *ad_attrname;</span>
<a href="#l1.204"></a><span id="l1.204" class="difflineplus">+    char *ad_value;</span>
<a href="#l1.205"></a><span id="l1.205" class="difflineplus">+    struct ldap_adddeflist *ad_next;</span>
<a href="#l1.206"></a><span id="l1.206"> };</span>
<a href="#l1.207"></a><span id="l1.207"> </span>
<a href="#l1.208"></a><span id="l1.208" class="difflineminus">-#define NULLADLIST	((struct ldap_adddeflist *)0)</span>
<a href="#l1.209"></a><span id="l1.209" class="difflineplus">+#define NULLADLIST ((struct ldap_adddeflist *)0)</span>
<a href="#l1.210"></a><span id="l1.210"> </span>
<a href="#l1.211"></a><span id="l1.211"> </span>
<a href="#l1.212"></a><span id="l1.212"> /*</span>
<a href="#l1.213"></a><span id="l1.213">  * display template global options</span>
<a href="#l1.214"></a><span id="l1.214">  * if this bit is set in dt_options, it applies.</span>
<a href="#l1.215"></a><span id="l1.215">  */</span>
<a href="#l1.216"></a><span id="l1.216"> /*</span>
<a href="#l1.217"></a><span id="l1.217">  * users should be allowed to try to add objects of these entries</span>
<a href="#l1.218"></a><span id="l1.218">  */</span>
<a href="#l1.219"></a><span id="l1.219" class="difflineminus">-#define LDAP_DTMPL_OPT_ADDABLE		0x00000001L</span>
<a href="#l1.220"></a><span id="l1.220" class="difflineplus">+#define LDAP_DTMPL_OPT_ADDABLE 0x00000001L</span>
<a href="#l1.221"></a><span id="l1.221"> </span>
<a href="#l1.222"></a><span id="l1.222"> /*</span>
<a href="#l1.223"></a><span id="l1.223">  * users should be allowed to do &quot;modify RDN&quot; operation of these entries</span>
<a href="#l1.224"></a><span id="l1.224">  */</span>
<a href="#l1.225"></a><span id="l1.225" class="difflineminus">-#define LDAP_DTMPL_OPT_ALLOWMODRDN	0x00000002L</span>
<a href="#l1.226"></a><span id="l1.226" class="difflineplus">+#define LDAP_DTMPL_OPT_ALLOWMODRDN 0x00000002L</span>
<a href="#l1.227"></a><span id="l1.227"> </span>
<a href="#l1.228"></a><span id="l1.228"> /*</span>
<a href="#l1.229"></a><span id="l1.229">  * this template is an alternate view, not a primary view</span>
<a href="#l1.230"></a><span id="l1.230">  */</span>
<a href="#l1.231"></a><span id="l1.231" class="difflineminus">-#define LDAP_DTMPL_OPT_ALTVIEW		0x00000004L</span>
<a href="#l1.232"></a><span id="l1.232" class="difflineplus">+#define LDAP_DTMPL_OPT_ALTVIEW 0x00000004L</span>
<a href="#l1.233"></a><span id="l1.233"> </span>
<a href="#l1.234"></a><span id="l1.234"> </span>
<a href="#l1.235"></a><span id="l1.235"> /*</span>
<a href="#l1.236"></a><span id="l1.236">  * display template structure</span>
<a href="#l1.237"></a><span id="l1.237">  */</span>
<a href="#l1.238"></a><span id="l1.238"> struct ldap_disptmpl {</span>
<a href="#l1.239"></a><span id="l1.239" class="difflineminus">-    char			*dt_name;</span>
<a href="#l1.240"></a><span id="l1.240" class="difflineminus">-    char			*dt_pluralname;</span>
<a href="#l1.241"></a><span id="l1.241" class="difflineminus">-    char			*dt_iconname;</span>
<a href="#l1.242"></a><span id="l1.242" class="difflineminus">-    unsigned long		dt_options;</span>
<a href="#l1.243"></a><span id="l1.243" class="difflineminus">-    char			*dt_authattrname;</span>
<a href="#l1.244"></a><span id="l1.244" class="difflineminus">-    char			*dt_defrdnattrname;</span>
<a href="#l1.245"></a><span id="l1.245" class="difflineminus">-    char			*dt_defaddlocation;</span>
<a href="#l1.246"></a><span id="l1.246" class="difflineminus">-    struct ldap_oclist		*dt_oclist;</span>
<a href="#l1.247"></a><span id="l1.247" class="difflineminus">-    struct ldap_adddeflist	*dt_adddeflist;</span>
<a href="#l1.248"></a><span id="l1.248" class="difflineminus">-    struct ldap_tmplitem	*dt_items;</span>
<a href="#l1.249"></a><span id="l1.249" class="difflineminus">-    void			*dt_appdata;</span>
<a href="#l1.250"></a><span id="l1.250" class="difflineminus">-    struct ldap_disptmpl	*dt_next;</span>
<a href="#l1.251"></a><span id="l1.251" class="difflineplus">+    char *dt_name;</span>
<a href="#l1.252"></a><span id="l1.252" class="difflineplus">+    char *dt_pluralname;</span>
<a href="#l1.253"></a><span id="l1.253" class="difflineplus">+    char *dt_iconname;</span>
<a href="#l1.254"></a><span id="l1.254" class="difflineplus">+    unsigned long dt_options;</span>
<a href="#l1.255"></a><span id="l1.255" class="difflineplus">+    char *dt_authattrname;</span>
<a href="#l1.256"></a><span id="l1.256" class="difflineplus">+    char *dt_defrdnattrname;</span>
<a href="#l1.257"></a><span id="l1.257" class="difflineplus">+    char *dt_defaddlocation;</span>
<a href="#l1.258"></a><span id="l1.258" class="difflineplus">+    struct ldap_oclist *dt_oclist;</span>
<a href="#l1.259"></a><span id="l1.259" class="difflineplus">+    struct ldap_adddeflist *dt_adddeflist;</span>
<a href="#l1.260"></a><span id="l1.260" class="difflineplus">+    struct ldap_tmplitem *dt_items;</span>
<a href="#l1.261"></a><span id="l1.261" class="difflineplus">+    void *dt_appdata;</span>
<a href="#l1.262"></a><span id="l1.262" class="difflineplus">+    struct ldap_disptmpl *dt_next;</span>
<a href="#l1.263"></a><span id="l1.263"> };</span>
<a href="#l1.264"></a><span id="l1.264"> </span>
<a href="#l1.265"></a><span id="l1.265" class="difflineminus">-#define NULLDISPTMPL	((struct ldap_disptmpl *)0)</span>
<a href="#l1.266"></a><span id="l1.266" class="difflineplus">+#define NULLDISPTMPL ((struct ldap_disptmpl *)0)</span>
<a href="#l1.267"></a><span id="l1.267"> </span>
<a href="#l1.268"></a><span id="l1.268" class="difflineminus">-#define LDAP_SET_DISPTMPL_APPDATA( dt, datap )	\</span>
<a href="#l1.269"></a><span id="l1.269" class="difflineminus">-	(dt)-&gt;dt_appdata = (void *)(datap)</span>
<a href="#l1.270"></a><span id="l1.270" class="difflineplus">+#define LDAP_SET_DISPTMPL_APPDATA( dt, datap ) \</span>
<a href="#l1.271"></a><span id="l1.271" class="difflineplus">+  (dt)-&gt;dt_appdata = (void *)(datap)</span>
<a href="#l1.272"></a><span id="l1.272"> </span>
<a href="#l1.273"></a><span id="l1.273" class="difflineminus">-#define LDAP_GET_DISPTMPL_APPDATA( dt, type )	\</span>
<a href="#l1.274"></a><span id="l1.274" class="difflineminus">-	(type)((dt)-&gt;dt_appdata)</span>
<a href="#l1.275"></a><span id="l1.275" class="difflineplus">+#define LDAP_GET_DISPTMPL_APPDATA( dt, type ) \</span>
<a href="#l1.276"></a><span id="l1.276" class="difflineplus">+  (type)((dt)-&gt;dt_appdata)</span>
<a href="#l1.277"></a><span id="l1.277"> </span>
<a href="#l1.278"></a><span id="l1.278" class="difflineminus">-#define LDAP_IS_DISPTMPL_OPTION_SET( dt, option )	\</span>
<a href="#l1.279"></a><span id="l1.279" class="difflineminus">-	(((dt)-&gt;dt_options &amp; option ) != 0 )</span>
<a href="#l1.280"></a><span id="l1.280" class="difflineplus">+#define LDAP_IS_DISPTMPL_OPTION_SET( dt, option ) \</span>
<a href="#l1.281"></a><span id="l1.281" class="difflineplus">+  (((dt)-&gt;dt_options &amp; option ) != 0 )</span>
<a href="#l1.282"></a><span id="l1.282"> </span>
<a href="#l1.283"></a><span id="l1.283" class="difflineminus">-#define LDAP_TMPL_ERR_VERSION	1</span>
<a href="#l1.284"></a><span id="l1.284" class="difflineminus">-#define LDAP_TMPL_ERR_MEM	2</span>
<a href="#l1.285"></a><span id="l1.285" class="difflineminus">-#define LDAP_TMPL_ERR_SYNTAX	3</span>
<a href="#l1.286"></a><span id="l1.286" class="difflineminus">-#define LDAP_TMPL_ERR_FILE	4</span>
<a href="#l1.287"></a><span id="l1.287" class="difflineplus">+#define LDAP_TMPL_ERR_VERSION 1</span>
<a href="#l1.288"></a><span id="l1.288" class="difflineplus">+#define LDAP_TMPL_ERR_MEM 2</span>
<a href="#l1.289"></a><span id="l1.289" class="difflineplus">+#define LDAP_TMPL_ERR_SYNTAX 3</span>
<a href="#l1.290"></a><span id="l1.290" class="difflineplus">+#define LDAP_TMPL_ERR_FILE 4</span>
<a href="#l1.291"></a><span id="l1.291"> </span>
<a href="#l1.292"></a><span id="l1.292"> /*</span>
<a href="#l1.293"></a><span id="l1.293">  * buffer size needed for entry2text and vals2text</span>
<a href="#l1.294"></a><span id="l1.294">  */</span>
<a href="#l1.295"></a><span id="l1.295" class="difflineminus">-#define LDAP_DTMPL_BUFSIZ	8192</span>
<a href="#l1.296"></a><span id="l1.296" class="difflineplus">+#define LDAP_DTMPL_BUFSIZ 8192</span>
<a href="#l1.297"></a><span id="l1.297"> </span>
<a href="#l1.298"></a><span id="l1.298"> typedef int (*writeptype)( void *writeparm, char *p, int len );</span>
<a href="#l1.299"></a><span id="l1.299"> </span>
<a href="#l1.300"></a><span id="l1.300"> LDAP_API(int)</span>
<a href="#l1.301"></a><span id="l1.301"> LDAP_CALL</span>
<a href="#l1.302"></a><span id="l1.302"> ldap_init_templates( char *file, struct ldap_disptmpl **tmpllistp );</span>
<a href="#l1.303"></a><span id="l1.303"> </span>
<a href="#l1.304"></a><span id="l1.304"> LDAP_API(int)</span>
<a href="#l1.305"></a><span id="l1.305"> LDAP_CALL</span>
<a href="#l1.306"></a><span id="l1.306"> ldap_init_templates_buf( char *buf, long buflen,</span>
<a href="#l1.307"></a><span id="l1.307" class="difflineminus">-	struct ldap_disptmpl **tmpllistp );</span>
<a href="#l1.308"></a><span id="l1.308" class="difflineplus">+  struct ldap_disptmpl **tmpllistp );</span>
<a href="#l1.309"></a><span id="l1.309"> </span>
<a href="#l1.310"></a><span id="l1.310"> LDAP_API(void)</span>
<a href="#l1.311"></a><span id="l1.311"> LDAP_CALL</span>
<a href="#l1.312"></a><span id="l1.312"> ldap_free_templates( struct ldap_disptmpl *tmpllist );</span>
<a href="#l1.313"></a><span id="l1.313"> </span>
<a href="#l1.314"></a><span id="l1.314"> LDAP_API(struct ldap_disptmpl *)</span>
<a href="#l1.315"></a><span id="l1.315"> LDAP_CALL</span>
<a href="#l1.316"></a><span id="l1.316"> ldap_first_disptmpl( struct ldap_disptmpl *tmpllist );</span>
<a href="#l1.317"></a><span id="l1.317"> </span>
<a href="#l1.318"></a><span id="l1.318"> LDAP_API(struct ldap_disptmpl *)</span>
<a href="#l1.319"></a><span id="l1.319"> LDAP_CALL</span>
<a href="#l1.320"></a><span id="l1.320"> ldap_next_disptmpl( struct ldap_disptmpl *tmpllist,</span>
<a href="#l1.321"></a><span id="l1.321" class="difflineminus">-	struct ldap_disptmpl *tmpl );</span>
<a href="#l1.322"></a><span id="l1.322" class="difflineplus">+  struct ldap_disptmpl *tmpl );</span>
<a href="#l1.323"></a><span id="l1.323"> </span>
<a href="#l1.324"></a><span id="l1.324"> LDAP_API(struct ldap_disptmpl *)</span>
<a href="#l1.325"></a><span id="l1.325"> LDAP_CALL</span>
<a href="#l1.326"></a><span id="l1.326"> ldap_name2template( char *name, struct ldap_disptmpl *tmpllist );</span>
<a href="#l1.327"></a><span id="l1.327"> </span>
<a href="#l1.328"></a><span id="l1.328"> LDAP_API(struct ldap_disptmpl *)</span>
<a href="#l1.329"></a><span id="l1.329"> LDAP_CALL</span>
<a href="#l1.330"></a><span id="l1.330"> ldap_oc2template( char **oclist, struct ldap_disptmpl *tmpllist );</span>
<a href="#l1.331"></a><span id="l1.331"> </span>
<a href="#l1.332"></a><span id="l1.332"> LDAP_API(char **)</span>
<a href="#l1.333"></a><span id="l1.333"> LDAP_CALL</span>
<a href="#l1.334"></a><span id="l1.334"> ldap_tmplattrs( struct ldap_disptmpl *tmpl, char **includeattrs, int exclude,</span>
<a href="#l1.335"></a><span id="l1.335" class="difflineminus">-	 unsigned long syntaxmask );</span>
<a href="#l1.336"></a><span id="l1.336" class="difflineplus">+   unsigned long syntaxmask );</span>
<a href="#l1.337"></a><span id="l1.337"> </span>
<a href="#l1.338"></a><span id="l1.338"> LDAP_API(struct ldap_tmplitem *)</span>
<a href="#l1.339"></a><span id="l1.339"> LDAP_CALL</span>
<a href="#l1.340"></a><span id="l1.340"> ldap_first_tmplrow( struct ldap_disptmpl *tmpl );</span>
<a href="#l1.341"></a><span id="l1.341"> </span>
<a href="#l1.342"></a><span id="l1.342"> LDAP_API(struct ldap_tmplitem *)</span>
<a href="#l1.343"></a><span id="l1.343"> LDAP_CALL</span>
<a href="#l1.344"></a><span id="l1.344"> ldap_next_tmplrow( struct ldap_disptmpl *tmpl, struct ldap_tmplitem *row );</span>
<a href="#l1.345"></a><span id="l1.345"> </span>
<a href="#l1.346"></a><span id="l1.346"> LDAP_API(struct ldap_tmplitem *)</span>
<a href="#l1.347"></a><span id="l1.347"> LDAP_CALL</span>
<a href="#l1.348"></a><span id="l1.348"> ldap_first_tmplcol( struct ldap_disptmpl *tmpl, struct ldap_tmplitem *row );</span>
<a href="#l1.349"></a><span id="l1.349"> </span>
<a href="#l1.350"></a><span id="l1.350"> LDAP_API(struct ldap_tmplitem *)</span>
<a href="#l1.351"></a><span id="l1.351"> LDAP_CALL</span>
<a href="#l1.352"></a><span id="l1.352"> ldap_next_tmplcol( struct ldap_disptmpl *tmpl, struct ldap_tmplitem *row,</span>
<a href="#l1.353"></a><span id="l1.353" class="difflineminus">-	struct ldap_tmplitem *col );</span>
<a href="#l1.354"></a><span id="l1.354" class="difflineplus">+  struct ldap_tmplitem *col );</span>
<a href="#l1.355"></a><span id="l1.355"> </span>
<a href="#l1.356"></a><span id="l1.356"> LDAP_API(int)</span>
<a href="#l1.357"></a><span id="l1.357"> LDAP_CALL</span>
<a href="#l1.358"></a><span id="l1.358"> ldap_entry2text( LDAP *ld, char *buf, LDAPMessage *entry,</span>
<a href="#l1.359"></a><span id="l1.359" class="difflineminus">-	struct ldap_disptmpl *tmpl, char **defattrs, char ***defvals,</span>
<a href="#l1.360"></a><span id="l1.360" class="difflineminus">-	writeptype writeproc, void *writeparm, char *eol, int rdncount,</span>
<a href="#l1.361"></a><span id="l1.361" class="difflineminus">-	unsigned long opts );</span>
<a href="#l1.362"></a><span id="l1.362" class="difflineplus">+  struct ldap_disptmpl *tmpl, char **defattrs, char ***defvals,</span>
<a href="#l1.363"></a><span id="l1.363" class="difflineplus">+  writeptype writeproc, void *writeparm, char *eol, int rdncount,</span>
<a href="#l1.364"></a><span id="l1.364" class="difflineplus">+  unsigned long opts );</span>
<a href="#l1.365"></a><span id="l1.365"> </span>
<a href="#l1.366"></a><span id="l1.366"> LDAP_API(int)</span>
<a href="#l1.367"></a><span id="l1.367"> LDAP_CALL</span>
<a href="#l1.368"></a><span id="l1.368"> ldap_vals2text( LDAP *ld, char *buf, char **vals, char *label, int labelwidth,</span>
<a href="#l1.369"></a><span id="l1.369" class="difflineminus">-	unsigned long syntaxid, writeptype writeproc, void *writeparm,</span>
<a href="#l1.370"></a><span id="l1.370" class="difflineminus">-	char *eol, int rdncount );</span>
<a href="#l1.371"></a><span id="l1.371" class="difflineplus">+  unsigned long syntaxid, writeptype writeproc, void *writeparm,</span>
<a href="#l1.372"></a><span id="l1.372" class="difflineplus">+  char *eol, int rdncount );</span>
<a href="#l1.373"></a><span id="l1.373"> </span>
<a href="#l1.374"></a><span id="l1.374"> LDAP_API(int)</span>
<a href="#l1.375"></a><span id="l1.375"> LDAP_CALL</span>
<a href="#l1.376"></a><span id="l1.376"> ldap_entry2text_search( LDAP *ld, char *dn, char *base, LDAPMessage *entry,</span>
<a href="#l1.377"></a><span id="l1.377" class="difflineminus">-	struct ldap_disptmpl *tmpllist, char **defattrs, char ***defvals,</span>
<a href="#l1.378"></a><span id="l1.378" class="difflineminus">-	writeptype writeproc, void *writeparm, char *eol, int rdncount,</span>
<a href="#l1.379"></a><span id="l1.379" class="difflineminus">-	unsigned long opts );</span>
<a href="#l1.380"></a><span id="l1.380" class="difflineplus">+  struct ldap_disptmpl *tmpllist, char **defattrs, char ***defvals,</span>
<a href="#l1.381"></a><span id="l1.381" class="difflineplus">+  writeptype writeproc, void *writeparm, char *eol, int rdncount,</span>
<a href="#l1.382"></a><span id="l1.382" class="difflineplus">+  unsigned long opts );</span>
<a href="#l1.383"></a><span id="l1.383"> </span>
<a href="#l1.384"></a><span id="l1.384"> LDAP_API(int)</span>
<a href="#l1.385"></a><span id="l1.385"> LDAP_CALL</span>
<a href="#l1.386"></a><span id="l1.386"> ldap_entry2html( LDAP *ld, char *buf, LDAPMessage *entry,</span>
<a href="#l1.387"></a><span id="l1.387" class="difflineminus">-	struct ldap_disptmpl *tmpl, char **defattrs, char ***defvals,</span>
<a href="#l1.388"></a><span id="l1.388" class="difflineminus">-	writeptype writeproc, void *writeparm, char *eol, int rdncount,</span>
<a href="#l1.389"></a><span id="l1.389" class="difflineminus">-	unsigned long opts, char *urlprefix, char *base );</span>
<a href="#l1.390"></a><span id="l1.390" class="difflineplus">+  struct ldap_disptmpl *tmpl, char **defattrs, char ***defvals,</span>
<a href="#l1.391"></a><span id="l1.391" class="difflineplus">+  writeptype writeproc, void *writeparm, char *eol, int rdncount,</span>
<a href="#l1.392"></a><span id="l1.392" class="difflineplus">+  unsigned long opts, char *urlprefix, char *base );</span>
<a href="#l1.393"></a><span id="l1.393"> </span>
<a href="#l1.394"></a><span id="l1.394"> LDAP_API(int)</span>
<a href="#l1.395"></a><span id="l1.395"> LDAP_CALL</span>
<a href="#l1.396"></a><span id="l1.396"> ldap_vals2html( LDAP *ld, char *buf, char **vals, char *label, int labelwidth,</span>
<a href="#l1.397"></a><span id="l1.397" class="difflineminus">-	unsigned long syntaxid, writeptype writeproc, void *writeparm,</span>
<a href="#l1.398"></a><span id="l1.398" class="difflineminus">-	char *eol, int rdncount, char *urlprefix );</span>
<a href="#l1.399"></a><span id="l1.399" class="difflineplus">+  unsigned long syntaxid, writeptype writeproc, void *writeparm,</span>
<a href="#l1.400"></a><span id="l1.400" class="difflineplus">+  char *eol, int rdncount, char *urlprefix );</span>
<a href="#l1.401"></a><span id="l1.401"> </span>
<a href="#l1.402"></a><span id="l1.402"> LDAP_API(int)</span>
<a href="#l1.403"></a><span id="l1.403"> LDAP_CALL</span>
<a href="#l1.404"></a><span id="l1.404"> ldap_entry2html_search( LDAP *ld, char *dn, char *base, LDAPMessage *entry,</span>
<a href="#l1.405"></a><span id="l1.405" class="difflineminus">-	struct ldap_disptmpl *tmpllist, char **defattrs, char ***defvals,</span>
<a href="#l1.406"></a><span id="l1.406" class="difflineminus">-	writeptype writeproc, void *writeparm, char *eol, int rdncount,</span>
<a href="#l1.407"></a><span id="l1.407" class="difflineminus">-	unsigned long opts, char *urlprefix );</span>
<a href="#l1.408"></a><span id="l1.408" class="difflineplus">+  struct ldap_disptmpl *tmpllist, char **defattrs, char ***defvals,</span>
<a href="#l1.409"></a><span id="l1.409" class="difflineplus">+  writeptype writeproc, void *writeparm, char *eol, int rdncount,</span>
<a href="#l1.410"></a><span id="l1.410" class="difflineplus">+  unsigned long opts, char *urlprefix );</span>
<a href="#l1.411"></a><span id="l1.411"> </span>
<a href="#l1.412"></a><span id="l1.412"> LDAP_API(char *)</span>
<a href="#l1.413"></a><span id="l1.413"> LDAP_CALL</span>
<a href="#l1.414"></a><span id="l1.414"> ldap_tmplerr2string( int err );</span>
<a href="#l1.415"></a><span id="l1.415"> </span>
<a href="#l1.416"></a><span id="l1.416"> #ifdef __cplusplus</span>
<a href="#l1.417"></a><span id="l1.417"> }</span>
<a href="#l1.418"></a><span id="l1.418"> #endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/ldap/c-sdk/include/iutil.h</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/ldap/c-sdk/include/iutil.h</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -47,26 +47,26 @@</span>
<a href="#l2.4"></a><span id="l2.4"> extern &quot;C&quot; {</span>
<a href="#l2.5"></a><span id="l2.5"> #endif /* __cplusplus */</span>
<a href="#l2.6"></a><span id="l2.6"> </span>
<a href="#l2.7"></a><span id="l2.7"> /* from iutil-lock.c */</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9"> #ifdef _WINDOWS</span>
<a href="#l2.10"></a><span id="l2.10"> #define LDAP_MUTEX_T HANDLE</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-extern		char *ldap_strdup();</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-extern		unsigned char *ldap_utf8_nextchar();</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineminus">-extern		char **ldap_explode_ava();</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineminus">-extern		int ldap_utf8_toupper();</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+extern char *ldap_strdup();</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+extern unsigned char *ldap_utf8_nextchar();</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineplus">+extern char **ldap_explode_ava();</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+extern int ldap_utf8_toupper();</span>
<a href="#l2.20"></a><span id="l2.20"> </span>
<a href="#l2.21"></a><span id="l2.21" class="difflineminus">-int		pthread_mutex_init( LDAP_MUTEX_T *mp, void *attr);</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineminus">-static void  *	pthread_mutex_alloc( void );</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineminus">-int		pthread_mutex_destroy( LDAP_MUTEX_T *mp );</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineminus">-static void	pthread_mutex_free( void *mutexp );</span>
<a href="#l2.25"></a><span id="l2.25" class="difflineminus">-int		pthread_mutex_lock( LDAP_MUTEX_T *mp );</span>
<a href="#l2.26"></a><span id="l2.26" class="difflineminus">-int		pthread_mutex_unlock( LDAP_MUTEX_T *mp );</span>
<a href="#l2.27"></a><span id="l2.27" class="difflineplus">+int pthread_mutex_init( LDAP_MUTEX_T *mp, void *attr);</span>
<a href="#l2.28"></a><span id="l2.28" class="difflineplus">+static void  * pthread_mutex_alloc( void );</span>
<a href="#l2.29"></a><span id="l2.29" class="difflineplus">+int pthread_mutex_destroy( LDAP_MUTEX_T *mp );</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineplus">+static void pthread_mutex_free( void *mutexp );</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineplus">+int pthread_mutex_lock( LDAP_MUTEX_T *mp );</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+int pthread_mutex_unlock( LDAP_MUTEX_T *mp );</span>
<a href="#l2.33"></a><span id="l2.33"> </span>
<a href="#l2.34"></a><span id="l2.34"> #endif /* _WINDOWS */</span>
<a href="#l2.35"></a><span id="l2.35"> </span>
<a href="#l2.36"></a><span id="l2.36"> #ifdef __cplusplus</span>
<a href="#l2.37"></a><span id="l2.37"> }</span>
<a href="#l2.38"></a><span id="l2.38"> #endif /* __cplusplus */</span>
<a href="#l2.39"></a><span id="l2.39"> #endif /* _IUTIL_H */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/ldap/c-sdk/include/lber.h</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/ldap/c-sdk/include/lber.h</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -37,26 +37,26 @@</span>
<a href="#l3.4"></a><span id="l3.4"> /* lber.h - header file for ber_* functions */</span>
<a href="#l3.5"></a><span id="l3.5"> #ifndef _LBER_H</span>
<a href="#l3.6"></a><span id="l3.6"> #define _LBER_H</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8"> #ifdef __cplusplus</span>
<a href="#l3.9"></a><span id="l3.9"> extern &quot;C&quot; {</span>
<a href="#l3.10"></a><span id="l3.10"> #endif</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-#include &lt;stdlib.h&gt;	/* to pick up size_t typedef */</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+#include &lt;stdlib.h&gt;  /* to pick up size_t typedef */</span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15"> /*</span>
<a href="#l3.16"></a><span id="l3.16">  * Note that LBER_ERROR and LBER_DEFAULT are values that can never appear</span>
<a href="#l3.17"></a><span id="l3.17">  * as valid BER tags, and so it is safe to use them to report errors.  In</span>
<a href="#l3.18"></a><span id="l3.18">  * fact, any tag for which the following is true is invalid:</span>
<a href="#l3.19"></a><span id="l3.19">  *     (( tag &amp; 0x00000080 ) != 0 ) &amp;&amp; (( tag &amp; 0xFFFFFF00 ) != 0 )</span>
<a href="#l3.20"></a><span id="l3.20">  */</span>
<a href="#l3.21"></a><span id="l3.21"> #define LBER_ERROR              ((ber_tag_t) -1) /* 0xffffffffU */</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineminus">-#define LBER_DEFAULT            ((ber_tag_t) -1) /* 0xffffffffU */	</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineplus">+#define LBER_DEFAULT            ((ber_tag_t) -1) /* 0xffffffffU */</span>
<a href="#l3.24"></a><span id="l3.24"> #define LBER_END_OF_SEQORSET    ((ber_tag_t) -2) /* 0xfffffffeU */</span>
<a href="#l3.25"></a><span id="l3.25"> #define LBER_OVERFLOW           ((ber_tag_t) -3) /* 0xfffffffdU */</span>
<a href="#l3.26"></a><span id="l3.26"> </span>
<a href="#l3.27"></a><span id="l3.27"> /* BER classes and mask */</span>
<a href="#l3.28"></a><span id="l3.28"> #define LBER_CLASS_UNIVERSAL    0x00</span>
<a href="#l3.29"></a><span id="l3.29"> #define LBER_CLASS_APPLICATION  0x40</span>
<a href="#l3.30"></a><span id="l3.30"> #define LBER_CLASS_CONTEXT      0x80</span>
<a href="#l3.31"></a><span id="l3.31"> #define LBER_CLASS_PRIVATE      0xc0</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineat">@@ -66,75 +66,75 @@ extern &quot;C&quot; {</span>
<a href="#l3.33"></a><span id="l3.33"> #define LBER_PRIMITIVE          0x00</span>
<a href="#l3.34"></a><span id="l3.34"> #define LBER_CONSTRUCTED        0x20</span>
<a href="#l3.35"></a><span id="l3.35"> #define LBER_ENCODING_MASK      0x20</span>
<a href="#l3.36"></a><span id="l3.36"> </span>
<a href="#l3.37"></a><span id="l3.37"> #define LBER_BIG_TAG_MASK       0x1f</span>
<a href="#l3.38"></a><span id="l3.38"> #define LBER_MORE_TAG_MASK      0x80</span>
<a href="#l3.39"></a><span id="l3.39"> </span>
<a href="#l3.40"></a><span id="l3.40"> /* general BER types we know about */</span>
<a href="#l3.41"></a><span id="l3.41" class="difflineminus">-#define LBER_BOOLEAN		0x01</span>
<a href="#l3.42"></a><span id="l3.42" class="difflineminus">-#define LBER_INTEGER		0x02</span>
<a href="#l3.43"></a><span id="l3.43" class="difflineminus">-#define LBER_BITSTRING		0x03</span>
<a href="#l3.44"></a><span id="l3.44" class="difflineminus">-#define LBER_OCTETSTRING	0x04</span>
<a href="#l3.45"></a><span id="l3.45" class="difflineminus">-#define LBER_NULL			0x05</span>
<a href="#l3.46"></a><span id="l3.46" class="difflineminus">-#define LBER_ENUMERATED		0x0a</span>
<a href="#l3.47"></a><span id="l3.47" class="difflineminus">-#define LBER_SEQUENCE		0x30</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineminus">-#define LBER_SET			0x31</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineplus">+#define LBER_BOOLEAN     0x01</span>
<a href="#l3.50"></a><span id="l3.50" class="difflineplus">+#define LBER_INTEGER     0x02</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineplus">+#define LBER_BITSTRING   0x03</span>
<a href="#l3.52"></a><span id="l3.52" class="difflineplus">+#define LBER_OCTETSTRING 0x04</span>
<a href="#l3.53"></a><span id="l3.53" class="difflineplus">+#define LBER_NULL        0x05</span>
<a href="#l3.54"></a><span id="l3.54" class="difflineplus">+#define LBER_ENUMERATED  0x0a</span>
<a href="#l3.55"></a><span id="l3.55" class="difflineplus">+#define LBER_SEQUENCE    0x30</span>
<a href="#l3.56"></a><span id="l3.56" class="difflineplus">+#define LBER_SET         0x31</span>
<a href="#l3.57"></a><span id="l3.57"> </span>
<a href="#l3.58"></a><span id="l3.58"> /* BerElement set/get options */</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineminus">-#define LBER_OPT_REMAINING_BYTES	0x01</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineminus">-#define LBER_OPT_TOTAL_BYTES		0x02</span>
<a href="#l3.61"></a><span id="l3.61" class="difflineminus">-#define LBER_OPT_USE_DER			0x04</span>
<a href="#l3.62"></a><span id="l3.62" class="difflineminus">-#define LBER_OPT_TRANSLATE_STRINGS	0x08</span>
<a href="#l3.63"></a><span id="l3.63" class="difflineminus">-#define LBER_OPT_BYTES_TO_WRITE		0x10</span>
<a href="#l3.64"></a><span id="l3.64" class="difflineminus">-#define LBER_OPT_MEMALLOC_FN_PTRS	0x20</span>
<a href="#l3.65"></a><span id="l3.65" class="difflineminus">-#define LBER_OPT_DEBUG_LEVEL		0x40</span>
<a href="#l3.66"></a><span id="l3.66" class="difflineminus">-#define LBER_OPT_BUFSIZE			0x80</span>
<a href="#l3.67"></a><span id="l3.67" class="difflineplus">+#define LBER_OPT_REMAINING_BYTES   0x01</span>
<a href="#l3.68"></a><span id="l3.68" class="difflineplus">+#define LBER_OPT_TOTAL_BYTES       0x02</span>
<a href="#l3.69"></a><span id="l3.69" class="difflineplus">+#define LBER_OPT_USE_DER           0x04</span>
<a href="#l3.70"></a><span id="l3.70" class="difflineplus">+#define LBER_OPT_TRANSLATE_STRINGS 0x08</span>
<a href="#l3.71"></a><span id="l3.71" class="difflineplus">+#define LBER_OPT_BYTES_TO_WRITE    0x10</span>
<a href="#l3.72"></a><span id="l3.72" class="difflineplus">+#define LBER_OPT_MEMALLOC_FN_PTRS  0x20</span>
<a href="#l3.73"></a><span id="l3.73" class="difflineplus">+#define LBER_OPT_DEBUG_LEVEL       0x40</span>
<a href="#l3.74"></a><span id="l3.74" class="difflineplus">+#define LBER_OPT_BUFSIZE           0x80</span>
<a href="#l3.75"></a><span id="l3.75"> </span>
<a href="#l3.76"></a><span id="l3.76"> /*</span>
<a href="#l3.77"></a><span id="l3.77">  * LBER_USE_DER is defined for compatibility with the C LDAP API RFC.</span>
<a href="#l3.78"></a><span id="l3.78">  * In our implementation, we recognize it (instead of the numerically</span>
<a href="#l3.79"></a><span id="l3.79">  * identical LBER_OPT_REMAINING_BYTES) in calls to ber_alloc_t() and</span>
<a href="#l3.80"></a><span id="l3.80">  * ber_init_w_nullchar() only.  Callers of ber_set_option() or</span>
<a href="#l3.81"></a><span id="l3.81">  * ber_get_option() must use LBER_OPT_USE_DER instead.  Sorry!</span>
<a href="#l3.82"></a><span id="l3.82">  */</span>
<a href="#l3.83"></a><span id="l3.83" class="difflineminus">-#define LBER_USE_DER			0x01</span>
<a href="#l3.84"></a><span id="l3.84" class="difflineplus">+#define LBER_USE_DER 0x01</span>
<a href="#l3.85"></a><span id="l3.85"> </span>
<a href="#l3.86"></a><span id="l3.86"> /* Sockbuf set/get options */</span>
<a href="#l3.87"></a><span id="l3.87" class="difflineminus">-#define LBER_SOCKBUF_OPT_TO_FILE			0x001</span>
<a href="#l3.88"></a><span id="l3.88" class="difflineminus">-#define LBER_SOCKBUF_OPT_TO_FILE_ONLY		0x002</span>
<a href="#l3.89"></a><span id="l3.89" class="difflineminus">-#define LBER_SOCKBUF_OPT_MAX_INCOMING_SIZE	0x004</span>
<a href="#l3.90"></a><span id="l3.90" class="difflineminus">-#define LBER_SOCKBUF_OPT_NO_READ_AHEAD		0x008</span>
<a href="#l3.91"></a><span id="l3.91" class="difflineminus">-#define LBER_SOCKBUF_OPT_DESC				0x010</span>
<a href="#l3.92"></a><span id="l3.92" class="difflineminus">-#define LBER_SOCKBUF_OPT_COPYDESC			0x020</span>
<a href="#l3.93"></a><span id="l3.93" class="difflineminus">-#define LBER_SOCKBUF_OPT_READ_FN			0x040</span>
<a href="#l3.94"></a><span id="l3.94" class="difflineminus">-#define LBER_SOCKBUF_OPT_WRITE_FN			0x080</span>
<a href="#l3.95"></a><span id="l3.95" class="difflineminus">-#define LBER_SOCKBUF_OPT_EXT_IO_FNS			0x100</span>
<a href="#l3.96"></a><span id="l3.96" class="difflineminus">-#define	LBER_SOCKBUF_OPT_VALID_TAG			0x200</span>
<a href="#l3.97"></a><span id="l3.97" class="difflineminus">-#define LBER_SOCKBUF_OPT_SOCK_ARG			0x400</span>
<a href="#l3.98"></a><span id="l3.98" class="difflineplus">+#define LBER_SOCKBUF_OPT_TO_FILE           0x001</span>
<a href="#l3.99"></a><span id="l3.99" class="difflineplus">+#define LBER_SOCKBUF_OPT_TO_FILE_ONLY      0x002</span>
<a href="#l3.100"></a><span id="l3.100" class="difflineplus">+#define LBER_SOCKBUF_OPT_MAX_INCOMING_SIZE 0x004</span>
<a href="#l3.101"></a><span id="l3.101" class="difflineplus">+#define LBER_SOCKBUF_OPT_NO_READ_AHEAD     0x008</span>
<a href="#l3.102"></a><span id="l3.102" class="difflineplus">+#define LBER_SOCKBUF_OPT_DESC              0x010</span>
<a href="#l3.103"></a><span id="l3.103" class="difflineplus">+#define LBER_SOCKBUF_OPT_COPYDESC          0x020</span>
<a href="#l3.104"></a><span id="l3.104" class="difflineplus">+#define LBER_SOCKBUF_OPT_READ_FN           0x040</span>
<a href="#l3.105"></a><span id="l3.105" class="difflineplus">+#define LBER_SOCKBUF_OPT_WRITE_FN          0x080</span>
<a href="#l3.106"></a><span id="l3.106" class="difflineplus">+#define LBER_SOCKBUF_OPT_EXT_IO_FNS        0x100</span>
<a href="#l3.107"></a><span id="l3.107" class="difflineplus">+#define LBER_SOCKBUF_OPT_VALID_TAG         0x200</span>
<a href="#l3.108"></a><span id="l3.108" class="difflineplus">+#define LBER_SOCKBUF_OPT_SOCK_ARG          0x400</span>
<a href="#l3.109"></a><span id="l3.109"> </span>
<a href="#l3.110"></a><span id="l3.110" class="difflineminus">-#define LBER_OPT_ON	((void *) 1)</span>
<a href="#l3.111"></a><span id="l3.111" class="difflineminus">-#define LBER_OPT_OFF	((void *) 0)</span>
<a href="#l3.112"></a><span id="l3.112" class="difflineplus">+#define LBER_OPT_ON ((void *) 1)</span>
<a href="#l3.113"></a><span id="l3.113" class="difflineplus">+#define LBER_OPT_OFF ((void *) 0)</span>
<a href="#l3.114"></a><span id="l3.114"> </span>
<a href="#l3.115"></a><span id="l3.115" class="difflineminus">-typedef unsigned int	ber_len_t;   /* for BER len */</span>
<a href="#l3.116"></a><span id="l3.116" class="difflineminus">-typedef unsigned int	ber_tag_t;   /* for BER tags */</span>
<a href="#l3.117"></a><span id="l3.117" class="difflineminus">-typedef int				ber_int_t;   /* for BER ints, enums, and Booleans */</span>
<a href="#l3.118"></a><span id="l3.118" class="difflineminus">-typedef unsigned int	ber_uint_t; /* unsigned equivalent of ber_int_t */</span>
<a href="#l3.119"></a><span id="l3.119" class="difflineminus">-typedef int				ber_slen_t; /* signed equivalent of ber_len_t */</span>
<a href="#l3.120"></a><span id="l3.120" class="difflineplus">+typedef unsigned int ber_len_t;   /* for BER len */</span>
<a href="#l3.121"></a><span id="l3.121" class="difflineplus">+typedef unsigned int ber_tag_t;   /* for BER tags */</span>
<a href="#l3.122"></a><span id="l3.122" class="difflineplus">+typedef int ber_int_t;            /* for BER ints, enums, and Booleans */</span>
<a href="#l3.123"></a><span id="l3.123" class="difflineplus">+typedef unsigned int ber_uint_t;  /* unsigned equivalent of ber_int_t */</span>
<a href="#l3.124"></a><span id="l3.124" class="difflineplus">+typedef int ber_slen_t;           /* signed equivalent of ber_len_t */</span>
<a href="#l3.125"></a><span id="l3.125"> </span>
<a href="#l3.126"></a><span id="l3.126"> typedef struct berval {</span>
<a href="#l3.127"></a><span id="l3.127" class="difflineminus">-	ber_len_t	bv_len;</span>
<a href="#l3.128"></a><span id="l3.128" class="difflineminus">-	char		*bv_val;</span>
<a href="#l3.129"></a><span id="l3.129" class="difflineplus">+  ber_len_t bv_len;</span>
<a href="#l3.130"></a><span id="l3.130" class="difflineplus">+  char *bv_val;</span>
<a href="#l3.131"></a><span id="l3.131"> } BerValue;</span>
<a href="#l3.132"></a><span id="l3.132"> </span>
<a href="#l3.133"></a><span id="l3.133"> typedef struct berelement BerElement;</span>
<a href="#l3.134"></a><span id="l3.134"> typedef struct sockbuf Sockbuf;</span>
<a href="#l3.135"></a><span id="l3.135"> typedef int (*BERTranslateProc)( char **bufp, ber_uint_t *buflenp,</span>
<a href="#l3.136"></a><span id="l3.136" class="difflineminus">-	int free_input );</span>
<a href="#l3.137"></a><span id="l3.137" class="difflineplus">+  int free_input );</span>
<a href="#l3.138"></a><span id="l3.138"> #ifndef macintosh</span>
<a href="#l3.139"></a><span id="l3.139"> #if defined( _WINDOWS ) || defined( _WIN32) || defined( _CONSOLE )</span>
<a href="#l3.140"></a><span id="l3.140"> #include &lt;winsock.h&gt; /* for SOCKET */</span>
<a href="#l3.141"></a><span id="l3.141"> typedef SOCKET LBER_SOCKET;</span>
<a href="#l3.142"></a><span id="l3.142"> #else</span>
<a href="#l3.143"></a><span id="l3.143"> typedef long LBER_SOCKET;</span>
<a href="#l3.144"></a><span id="l3.144"> #endif /* _WINDOWS */</span>
<a href="#l3.145"></a><span id="l3.145"> #else /* macintosh */</span>
<a href="#l3.146"></a><span id="l3.146" class="difflineat">@@ -176,164 +176,164 @@ typedef void *LBER_SOCKET;</span>
<a href="#l3.147"></a><span id="l3.147"> struct lextiof_socket_private;          /* Defined by the extended I/O */</span>
<a href="#l3.148"></a><span id="l3.148">                                         /* callback functions */</span>
<a href="#l3.149"></a><span id="l3.149"> struct lextiof_session_private;         /* Defined by the extended I/O */</span>
<a href="#l3.150"></a><span id="l3.150">                                         /* callback functions */</span>
<a href="#l3.151"></a><span id="l3.151"> </span>
<a href="#l3.152"></a><span id="l3.152"> /* This is modeled after the PRIOVec that is passed to the NSPR</span>
<a href="#l3.153"></a><span id="l3.153">    writev function! The void* is a char* in that struct */</span>
<a href="#l3.154"></a><span id="l3.154"> typedef struct ldap_x_iovec {</span>
<a href="#l3.155"></a><span id="l3.155" class="difflineminus">-        char    *ldapiov_base;</span>
<a href="#l3.156"></a><span id="l3.156" class="difflineminus">-        int     ldapiov_len;</span>
<a href="#l3.157"></a><span id="l3.157" class="difflineplus">+  char *ldapiov_base;</span>
<a href="#l3.158"></a><span id="l3.158" class="difflineplus">+  int  ldapiov_len;</span>
<a href="#l3.159"></a><span id="l3.159"> } ldap_x_iovec;</span>
<a href="#l3.160"></a><span id="l3.160"> </span>
<a href="#l3.161"></a><span id="l3.161"> /*</span>
<a href="#l3.162"></a><span id="l3.162">  * libldap read and write I/O function callbacks.  The rest of the I/O callback</span>
<a href="#l3.163"></a><span id="l3.163">  * types are defined in ldap.h</span>
<a href="#l3.164"></a><span id="l3.164">  */</span>
<a href="#l3.165"></a><span id="l3.165"> typedef int (LDAP_C LDAP_CALLBACK LDAP_IOF_READ_CALLBACK)( LBER_SOCKET s,</span>
<a href="#l3.166"></a><span id="l3.166" class="difflineminus">-	void *buf, int bufsize );</span>
<a href="#l3.167"></a><span id="l3.167" class="difflineplus">+  void *buf, int bufsize );</span>
<a href="#l3.168"></a><span id="l3.168"> typedef int (LDAP_C LDAP_CALLBACK LDAP_IOF_WRITE_CALLBACK)( LBER_SOCKET s,</span>
<a href="#l3.169"></a><span id="l3.169" class="difflineminus">-	const void *buf, int len );</span>
<a href="#l3.170"></a><span id="l3.170" class="difflineplus">+  const void *buf, int len );</span>
<a href="#l3.171"></a><span id="l3.171"> typedef int (LDAP_C LDAP_CALLBACK LDAP_X_EXTIOF_READ_CALLBACK)( int s,</span>
<a href="#l3.172"></a><span id="l3.172" class="difflineminus">-	void *buf, int bufsize, struct lextiof_socket_private *socketarg );</span>
<a href="#l3.173"></a><span id="l3.173" class="difflineplus">+  void *buf, int bufsize, struct lextiof_socket_private *socketarg );</span>
<a href="#l3.174"></a><span id="l3.174"> typedef int (LDAP_C LDAP_CALLBACK LDAP_X_EXTIOF_WRITE_CALLBACK)( int s,</span>
<a href="#l3.175"></a><span id="l3.175" class="difflineminus">-	const void *buf, int len, struct lextiof_socket_private *socketarg );</span>
<a href="#l3.176"></a><span id="l3.176" class="difflineplus">+  const void *buf, int len, struct lextiof_socket_private *socketarg );</span>
<a href="#l3.177"></a><span id="l3.177"> typedef int (LDAP_C LDAP_CALLBACK LDAP_X_EXTIOF_WRITEV_CALLBACK)(int s,</span>
<a href="#l3.178"></a><span id="l3.178" class="difflineminus">-	const ldap_x_iovec iov[], int iovcnt, struct lextiof_socket_private *socketarg);</span>
<a href="#l3.179"></a><span id="l3.179" class="difflineminus">-						</span>
<a href="#l3.180"></a><span id="l3.180" class="difflineplus">+  const ldap_x_iovec iov[], int iovcnt, struct lextiof_socket_private *socketarg);</span>
<a href="#l3.181"></a><span id="l3.181" class="difflineplus">+</span>
<a href="#l3.182"></a><span id="l3.182"> </span>
<a href="#l3.183"></a><span id="l3.183"> /*</span>
<a href="#l3.184"></a><span id="l3.184">  * Structure for use with LBER_SOCKBUF_OPT_EXT_IO_FNS:</span>
<a href="#l3.185"></a><span id="l3.185">  */</span>
<a href="#l3.186"></a><span id="l3.186"> struct lber_x_ext_io_fns {</span>
<a href="#l3.187"></a><span id="l3.187" class="difflineminus">-	    /* lbextiofn_size should always be set to LBER_X_EXTIO_FNS_SIZE */</span>
<a href="#l3.188"></a><span id="l3.188" class="difflineminus">-	int				lbextiofn_size;</span>
<a href="#l3.189"></a><span id="l3.189" class="difflineminus">-	LDAP_X_EXTIOF_READ_CALLBACK	*lbextiofn_read;</span>
<a href="#l3.190"></a><span id="l3.190" class="difflineminus">-	LDAP_X_EXTIOF_WRITE_CALLBACK	*lbextiofn_write;</span>
<a href="#l3.191"></a><span id="l3.191" class="difflineminus">-	struct lextiof_socket_private	*lbextiofn_socket_arg;</span>
<a href="#l3.192"></a><span id="l3.192" class="difflineminus">-        LDAP_X_EXTIOF_WRITEV_CALLBACK   *lbextiofn_writev;</span>
<a href="#l3.193"></a><span id="l3.193" class="difflineplus">+  /* lbextiofn_size should always be set to LBER_X_EXTIO_FNS_SIZE */</span>
<a href="#l3.194"></a><span id="l3.194" class="difflineplus">+  int lbextiofn_size;</span>
<a href="#l3.195"></a><span id="l3.195" class="difflineplus">+  LDAP_X_EXTIOF_READ_CALLBACK *lbextiofn_read;</span>
<a href="#l3.196"></a><span id="l3.196" class="difflineplus">+  LDAP_X_EXTIOF_WRITE_CALLBACK *lbextiofn_write;</span>
<a href="#l3.197"></a><span id="l3.197" class="difflineplus">+  struct lextiof_socket_private *lbextiofn_socket_arg;</span>
<a href="#l3.198"></a><span id="l3.198" class="difflineplus">+  LDAP_X_EXTIOF_WRITEV_CALLBACK *lbextiofn_writev;</span>
<a href="#l3.199"></a><span id="l3.199"> };</span>
<a href="#l3.200"></a><span id="l3.200"> #define LBER_X_EXTIO_FNS_SIZE sizeof(struct lber_x_ext_io_fns)</span>
<a href="#l3.201"></a><span id="l3.201"> </span>
<a href="#l3.202"></a><span id="l3.202"> /*</span>
<a href="#l3.203"></a><span id="l3.203">  * liblber memory allocation callback functions.  These are global to all</span>
<a href="#l3.204"></a><span id="l3.204">  *  Sockbufs and BerElements.  Install your own functions by using a call</span>
<a href="#l3.205"></a><span id="l3.205">  *  like this: ber_set_option( NULL, LBER_OPT_MEMALLOC_FN_PTRS, &amp;memalloc_fns );</span>
<a href="#l3.206"></a><span id="l3.206">  */</span>
<a href="#l3.207"></a><span id="l3.207"> typedef void * (LDAP_C LDAP_CALLBACK LDAP_MALLOC_CALLBACK)( size_t size );</span>
<a href="#l3.208"></a><span id="l3.208"> typedef void * (LDAP_C LDAP_CALLBACK LDAP_CALLOC_CALLBACK)( size_t nelem,</span>
<a href="#l3.209"></a><span id="l3.209" class="difflineminus">-	size_t elsize );</span>
<a href="#l3.210"></a><span id="l3.210" class="difflineplus">+  size_t elsize );</span>
<a href="#l3.211"></a><span id="l3.211"> typedef void * (LDAP_C LDAP_CALLBACK LDAP_REALLOC_CALLBACK)( void *ptr,</span>
<a href="#l3.212"></a><span id="l3.212" class="difflineminus">-	size_t size );</span>
<a href="#l3.213"></a><span id="l3.213" class="difflineplus">+  size_t size );</span>
<a href="#l3.214"></a><span id="l3.214"> typedef void (LDAP_C LDAP_CALLBACK LDAP_FREE_CALLBACK)( void *ptr );</span>
<a href="#l3.215"></a><span id="l3.215"> </span>
<a href="#l3.216"></a><span id="l3.216"> struct lber_memalloc_fns {</span>
<a href="#l3.217"></a><span id="l3.217" class="difflineminus">-	LDAP_MALLOC_CALLBACK	*lbermem_malloc;</span>
<a href="#l3.218"></a><span id="l3.218" class="difflineminus">-	LDAP_CALLOC_CALLBACK	*lbermem_calloc;</span>
<a href="#l3.219"></a><span id="l3.219" class="difflineminus">-	LDAP_REALLOC_CALLBACK	*lbermem_realloc;</span>
<a href="#l3.220"></a><span id="l3.220" class="difflineminus">-	LDAP_FREE_CALLBACK	*lbermem_free;</span>
<a href="#l3.221"></a><span id="l3.221" class="difflineplus">+  LDAP_MALLOC_CALLBACK *lbermem_malloc;</span>
<a href="#l3.222"></a><span id="l3.222" class="difflineplus">+  LDAP_CALLOC_CALLBACK *lbermem_calloc;</span>
<a href="#l3.223"></a><span id="l3.223" class="difflineplus">+  LDAP_REALLOC_CALLBACK *lbermem_realloc;</span>
<a href="#l3.224"></a><span id="l3.224" class="difflineplus">+  LDAP_FREE_CALLBACK *lbermem_free;</span>
<a href="#l3.225"></a><span id="l3.225"> };</span>
<a href="#l3.226"></a><span id="l3.226"> </span>
<a href="#l3.227"></a><span id="l3.227"> /*</span>
<a href="#l3.228"></a><span id="l3.228">  * decode routines</span>
<a href="#l3.229"></a><span id="l3.229">  */</span>
<a href="#l3.230"></a><span id="l3.230"> LDAP_API(ber_tag_t) LDAP_CALL ber_get_tag( BerElement *ber );</span>
<a href="#l3.231"></a><span id="l3.231"> LDAP_API(ber_tag_t) LDAP_CALL ber_skip_tag( BerElement *ber,</span>
<a href="#l3.232"></a><span id="l3.232" class="difflineminus">-	ber_len_t *len );</span>
<a href="#l3.233"></a><span id="l3.233" class="difflineplus">+  ber_len_t *len );</span>
<a href="#l3.234"></a><span id="l3.234"> LDAP_API(ber_tag_t) LDAP_CALL ber_peek_tag( BerElement *ber,</span>
<a href="#l3.235"></a><span id="l3.235" class="difflineminus">-	ber_len_t *len );</span>
<a href="#l3.236"></a><span id="l3.236" class="difflineplus">+  ber_len_t *len );</span>
<a href="#l3.237"></a><span id="l3.237"> LDAP_API(ber_tag_t) LDAP_CALL ber_get_int( BerElement *ber, ber_int_t *num );</span>
<a href="#l3.238"></a><span id="l3.238"> LDAP_API(ber_tag_t) LDAP_CALL ber_get_stringb( BerElement *ber, char *buf,</span>
<a href="#l3.239"></a><span id="l3.239" class="difflineminus">-	ber_len_t *len );</span>
<a href="#l3.240"></a><span id="l3.240" class="difflineplus">+  ber_len_t *len );</span>
<a href="#l3.241"></a><span id="l3.241"> LDAP_API(ber_tag_t) LDAP_CALL ber_get_stringa( BerElement *ber,</span>
<a href="#l3.242"></a><span id="l3.242" class="difflineminus">-	char **buf );</span>
<a href="#l3.243"></a><span id="l3.243" class="difflineplus">+  char **buf );</span>
<a href="#l3.244"></a><span id="l3.244"> LDAP_API(ber_tag_t) LDAP_CALL ber_get_stringal( BerElement *ber,</span>
<a href="#l3.245"></a><span id="l3.245" class="difflineminus">-	struct berval **bv );</span>
<a href="#l3.246"></a><span id="l3.246" class="difflineplus">+  struct berval **bv );</span>
<a href="#l3.247"></a><span id="l3.247"> LDAP_API(ber_tag_t) LDAP_CALL ber_get_bitstringa( BerElement *ber,</span>
<a href="#l3.248"></a><span id="l3.248" class="difflineminus">-	char **buf, ber_len_t *len );</span>
<a href="#l3.249"></a><span id="l3.249" class="difflineplus">+  char **buf, ber_len_t *len );</span>
<a href="#l3.250"></a><span id="l3.250"> LDAP_API(ber_tag_t) LDAP_CALL ber_get_null( BerElement *ber );</span>
<a href="#l3.251"></a><span id="l3.251"> LDAP_API(ber_tag_t) LDAP_CALL ber_get_boolean( BerElement *ber,</span>
<a href="#l3.252"></a><span id="l3.252" class="difflineminus">-	ber_int_t *boolval );</span>
<a href="#l3.253"></a><span id="l3.253" class="difflineplus">+  ber_int_t *boolval );</span>
<a href="#l3.254"></a><span id="l3.254"> LDAP_API(ber_tag_t) LDAP_CALL ber_first_element( BerElement *ber,</span>
<a href="#l3.255"></a><span id="l3.255" class="difflineminus">-	ber_len_t *len, char **last );</span>
<a href="#l3.256"></a><span id="l3.256" class="difflineplus">+  ber_len_t *len, char **last );</span>
<a href="#l3.257"></a><span id="l3.257"> LDAP_API(ber_tag_t) LDAP_CALL ber_next_element( BerElement *ber,</span>
<a href="#l3.258"></a><span id="l3.258" class="difflineminus">-	ber_len_t *len, char *last );</span>
<a href="#l3.259"></a><span id="l3.259" class="difflineplus">+  ber_len_t *len, char *last );</span>
<a href="#l3.260"></a><span id="l3.260"> LDAP_API(ber_tag_t) LDAP_C ber_scanf( BerElement *ber, const char *fmt,</span>
<a href="#l3.261"></a><span id="l3.261" class="difflineminus">-	... );</span>
<a href="#l3.262"></a><span id="l3.262" class="difflineplus">+  ... );</span>
<a href="#l3.263"></a><span id="l3.263"> LDAP_API(void) LDAP_CALL ber_bvfree( struct berval *bv );</span>
<a href="#l3.264"></a><span id="l3.264"> LDAP_API(void) LDAP_CALL ber_bvecfree( struct berval **bv );</span>
<a href="#l3.265"></a><span id="l3.265"> LDAP_API(void) LDAP_CALL ber_svecfree( char **vals );</span>
<a href="#l3.266"></a><span id="l3.266"> LDAP_API(struct berval *) LDAP_CALL ber_bvdup( const struct berval *bv );</span>
<a href="#l3.267"></a><span id="l3.267"> LDAP_API(void) LDAP_CALL ber_set_string_translators( BerElement *ber,</span>
<a href="#l3.268"></a><span id="l3.268" class="difflineminus">-	BERTranslateProc encode_proc, BERTranslateProc decode_proc );</span>
<a href="#l3.269"></a><span id="l3.269" class="difflineplus">+  BERTranslateProc encode_proc, BERTranslateProc decode_proc );</span>
<a href="#l3.270"></a><span id="l3.270"> LDAP_API(BerElement *) LDAP_CALL ber_init( const struct berval *bv );</span>
<a href="#l3.271"></a><span id="l3.271"> </span>
<a href="#l3.272"></a><span id="l3.272"> /*</span>
<a href="#l3.273"></a><span id="l3.273">  * encoding routines</span>
<a href="#l3.274"></a><span id="l3.274">  */</span>
<a href="#l3.275"></a><span id="l3.275"> LDAP_API(int) LDAP_CALL ber_put_enum( BerElement *ber, ber_int_t num,</span>
<a href="#l3.276"></a><span id="l3.276" class="difflineminus">-	ber_tag_t tag );</span>
<a href="#l3.277"></a><span id="l3.277" class="difflineplus">+  ber_tag_t tag );</span>
<a href="#l3.278"></a><span id="l3.278"> LDAP_API(int) LDAP_CALL ber_put_int( BerElement *ber, ber_int_t num,</span>
<a href="#l3.279"></a><span id="l3.279" class="difflineminus">-	ber_tag_t tag );</span>
<a href="#l3.280"></a><span id="l3.280" class="difflineplus">+  ber_tag_t tag );</span>
<a href="#l3.281"></a><span id="l3.281"> LDAP_API(int) LDAP_CALL ber_put_ostring( BerElement *ber, char *str,</span>
<a href="#l3.282"></a><span id="l3.282" class="difflineminus">-	ber_len_t len, ber_tag_t tag );</span>
<a href="#l3.283"></a><span id="l3.283" class="difflineplus">+  ber_len_t len, ber_tag_t tag );</span>
<a href="#l3.284"></a><span id="l3.284"> LDAP_API(int) LDAP_CALL ber_put_string( BerElement *ber, char *str,</span>
<a href="#l3.285"></a><span id="l3.285" class="difflineminus">-	ber_tag_t tag );</span>
<a href="#l3.286"></a><span id="l3.286" class="difflineplus">+  ber_tag_t tag );</span>
<a href="#l3.287"></a><span id="l3.287"> LDAP_API(int) LDAP_CALL ber_put_bitstring( BerElement *ber, char *str,</span>
<a href="#l3.288"></a><span id="l3.288" class="difflineminus">-	ber_len_t bitlen, ber_tag_t tag );</span>
<a href="#l3.289"></a><span id="l3.289" class="difflineplus">+  ber_len_t bitlen, ber_tag_t tag );</span>
<a href="#l3.290"></a><span id="l3.290"> LDAP_API(int) LDAP_CALL ber_put_null( BerElement *ber, ber_tag_t tag );</span>
<a href="#l3.291"></a><span id="l3.291"> LDAP_API(int) LDAP_CALL ber_put_boolean( BerElement *ber,</span>
<a href="#l3.292"></a><span id="l3.292" class="difflineminus">-	ber_int_t boolval, ber_tag_t tag );</span>
<a href="#l3.293"></a><span id="l3.293" class="difflineplus">+  ber_int_t boolval, ber_tag_t tag );</span>
<a href="#l3.294"></a><span id="l3.294"> LDAP_API(int) LDAP_CALL ber_start_seq( BerElement *ber, ber_tag_t tag );</span>
<a href="#l3.295"></a><span id="l3.295"> LDAP_API(int) LDAP_CALL ber_start_set( BerElement *ber, ber_tag_t tag );</span>
<a href="#l3.296"></a><span id="l3.296"> LDAP_API(int) LDAP_CALL ber_put_seq( BerElement *ber );</span>
<a href="#l3.297"></a><span id="l3.297"> LDAP_API(int) LDAP_CALL ber_put_set( BerElement *ber );</span>
<a href="#l3.298"></a><span id="l3.298"> LDAP_API(int) LDAP_C ber_printf( BerElement *ber, const char *fmt, ... );</span>
<a href="#l3.299"></a><span id="l3.299"> LDAP_API(int) LDAP_CALL ber_flatten( BerElement *ber,</span>
<a href="#l3.300"></a><span id="l3.300" class="difflineminus">-	struct berval **bvPtr );</span>
<a href="#l3.301"></a><span id="l3.301" class="difflineplus">+  struct berval **bvPtr );</span>
<a href="#l3.302"></a><span id="l3.302"> </span>
<a href="#l3.303"></a><span id="l3.303"> /*</span>
<a href="#l3.304"></a><span id="l3.304">  * miscellaneous routines</span>
<a href="#l3.305"></a><span id="l3.305">  */</span>
<a href="#l3.306"></a><span id="l3.306"> LDAP_API(void) LDAP_CALL ber_free( BerElement *ber, int freebuf );</span>
<a href="#l3.307"></a><span id="l3.307"> LDAP_API(void) LDAP_CALL ber_special_free(void* buf, BerElement *ber);</span>
<a href="#l3.308"></a><span id="l3.308"> LDAP_API(int) LDAP_CALL ber_flush( Sockbuf *sb, BerElement *ber, int freeit );</span>
<a href="#l3.309"></a><span id="l3.309"> LDAP_API(BerElement*) LDAP_CALL ber_alloc( void );</span>
<a href="#l3.310"></a><span id="l3.310"> LDAP_API(BerElement*) LDAP_CALL der_alloc( void );</span>
<a href="#l3.311"></a><span id="l3.311"> LDAP_API(BerElement*) LDAP_CALL ber_alloc_t( int options );</span>
<a href="#l3.312"></a><span id="l3.312"> LDAP_API(void*) LDAP_CALL ber_special_alloc(size_t size, BerElement **ppBer);</span>
<a href="#l3.313"></a><span id="l3.313"> LDAP_API(BerElement*) LDAP_CALL ber_dup( BerElement *ber );</span>
<a href="#l3.314"></a><span id="l3.314"> LDAP_API(ber_tag_t) LDAP_CALL ber_get_next( Sockbuf *sb, ber_len_t *len,</span>
<a href="#l3.315"></a><span id="l3.315" class="difflineminus">-	BerElement *ber );</span>
<a href="#l3.316"></a><span id="l3.316" class="difflineplus">+  BerElement *ber );</span>
<a href="#l3.317"></a><span id="l3.317"> LDAP_API(ber_tag_t) LDAP_CALL ber_get_next_buffer( void *buffer,</span>
<a href="#l3.318"></a><span id="l3.318" class="difflineminus">-	size_t buffer_size, ber_len_t *len, BerElement *ber,</span>
<a href="#l3.319"></a><span id="l3.319" class="difflineminus">-	ber_len_t *Bytes_Scanned );</span>
<a href="#l3.320"></a><span id="l3.320" class="difflineplus">+  size_t buffer_size, ber_len_t *len, BerElement *ber,</span>
<a href="#l3.321"></a><span id="l3.321" class="difflineplus">+  ber_len_t *Bytes_Scanned );</span>
<a href="#l3.322"></a><span id="l3.322"> LDAP_API(ber_tag_t) LDAP_CALL ber_get_next_buffer_ext( void *buffer,</span>
<a href="#l3.323"></a><span id="l3.323" class="difflineminus">-	size_t buffer_size, ber_len_t *len, BerElement *ber,</span>
<a href="#l3.324"></a><span id="l3.324" class="difflineminus">-	ber_len_t *Bytes_Scanned, Sockbuf *sb );</span>
<a href="#l3.325"></a><span id="l3.325" class="difflineplus">+  size_t buffer_size, ber_len_t *len, BerElement *ber,</span>
<a href="#l3.326"></a><span id="l3.326" class="difflineplus">+  ber_len_t *Bytes_Scanned, Sockbuf *sb );</span>
<a href="#l3.327"></a><span id="l3.327"> LDAP_API(ber_int_t) LDAP_CALL ber_read( BerElement *ber, char *buf,</span>
<a href="#l3.328"></a><span id="l3.328" class="difflineminus">-	ber_len_t len );</span>
<a href="#l3.329"></a><span id="l3.329" class="difflineplus">+  ber_len_t len );</span>
<a href="#l3.330"></a><span id="l3.330"> LDAP_API(ber_int_t) LDAP_CALL ber_write( BerElement *ber, char *buf,</span>
<a href="#l3.331"></a><span id="l3.331" class="difflineminus">-	ber_len_t len, int nosos );</span>
<a href="#l3.332"></a><span id="l3.332" class="difflineplus">+  ber_len_t len, int nosos );</span>
<a href="#l3.333"></a><span id="l3.333"> LDAP_API(void) LDAP_CALL ber_init_w_nullchar( BerElement *ber, int options );</span>
<a href="#l3.334"></a><span id="l3.334"> LDAP_API(void) LDAP_CALL ber_reset( BerElement *ber, int was_writing );</span>
<a href="#l3.335"></a><span id="l3.335"> LDAP_API(size_t) LDAP_CALL ber_get_buf_datalen( BerElement *ber );</span>
<a href="#l3.336"></a><span id="l3.336"> LDAP_API(int) LDAP_CALL ber_stack_init(BerElement *ber, int options,</span>
<a href="#l3.337"></a><span id="l3.337" class="difflineminus">-	char * buf, size_t size);</span>
<a href="#l3.338"></a><span id="l3.338" class="difflineplus">+  char * buf, size_t size);</span>
<a href="#l3.339"></a><span id="l3.339"> LDAP_API(char*) LDAP_CALL ber_get_buf_databegin (BerElement * ber);</span>
<a href="#l3.340"></a><span id="l3.340"> LDAP_API(void) LDAP_CALL ber_sockbuf_free_data(Sockbuf *p);</span>
<a href="#l3.341"></a><span id="l3.341"> LDAP_API(int) LDAP_CALL ber_set_option( BerElement *ber, int option,</span>
<a href="#l3.342"></a><span id="l3.342" class="difflineminus">-	void *value );</span>
<a href="#l3.343"></a><span id="l3.343" class="difflineplus">+  void *value );</span>
<a href="#l3.344"></a><span id="l3.344"> LDAP_API(int) LDAP_CALL ber_get_option( BerElement *ber, int option,</span>
<a href="#l3.345"></a><span id="l3.345" class="difflineminus">-	void *value );</span>
<a href="#l3.346"></a><span id="l3.346" class="difflineplus">+  void *value );</span>
<a href="#l3.347"></a><span id="l3.347"> LDAP_API(Sockbuf*) LDAP_CALL ber_sockbuf_alloc( void );</span>
<a href="#l3.348"></a><span id="l3.348"> LDAP_API(void) LDAP_CALL ber_sockbuf_free( Sockbuf* p );</span>
<a href="#l3.349"></a><span id="l3.349"> LDAP_API(int) LDAP_CALL ber_sockbuf_set_option( Sockbuf *sb, int option,</span>
<a href="#l3.350"></a><span id="l3.350" class="difflineminus">-	void *value );</span>
<a href="#l3.351"></a><span id="l3.351" class="difflineplus">+  void *value );</span>
<a href="#l3.352"></a><span id="l3.352"> LDAP_API(int) LDAP_CALL ber_sockbuf_get_option( Sockbuf *sb, int option,</span>
<a href="#l3.353"></a><span id="l3.353" class="difflineminus">-	void *value );</span>
<a href="#l3.354"></a><span id="l3.354" class="difflineplus">+  void *value );</span>
<a href="#l3.355"></a><span id="l3.355"> </span>
<a href="#l3.356"></a><span id="l3.356"> #ifdef __cplusplus</span>
<a href="#l3.357"></a><span id="l3.357"> }</span>
<a href="#l3.358"></a><span id="l3.358"> #endif</span>
<a href="#l3.359"></a><span id="l3.359"> #endif /* _LBER_H */</span>
<a href="#l3.360"></a><span id="l3.360"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/ldap/c-sdk/include/lcache.h</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/ldap/c-sdk/include/lcache.h</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -60,35 +60,35 @@ extern &quot;C&quot; {</span>
<a href="#l4.4"></a><span id="l4.4"> #define LDAP_CALLBACK</span>
<a href="#l4.5"></a><span id="l4.5"> #define LDAP_PASCAL</span>
<a href="#l4.6"></a><span id="l4.6"> #define LDAP_CALL</span>
<a href="#l4.7"></a><span id="l4.7"> #endif /* _WINDOWS */</span>
<a href="#l4.8"></a><span id="l4.8"> #endif /* LDAP_CALL */</span>
<a href="#l4.9"></a><span id="l4.9"> </span>
<a href="#l4.10"></a><span id="l4.10"> LDAP_API(int) LDAP_C lcache_init( LDAP *ld, void *arg );</span>
<a href="#l4.11"></a><span id="l4.11"> LDAP_API(int) LDAP_C lcache_bind( LDAP *ld, int msgid, unsigned long tag,</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-	const char *dn, struct berval *cred, int method );</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+  const char *dn, struct berval *cred, int method );</span>
<a href="#l4.14"></a><span id="l4.14"> LDAP_API(int) LDAP_C lcache_unbind( LDAP *ld, int msgid, unsigned long tag );</span>
<a href="#l4.15"></a><span id="l4.15"> LDAP_API(int) LDAP_C lcache_search( LDAP *ld, int msgid, unsigned long tag,</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineminus">-	const char *dn, int scope, const char *filter, char **attrs,</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineminus">-	int attrsonly );</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineplus">+  const char *dn, int scope, const char *filter, char **attrs,</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineplus">+  int attrsonly );</span>
<a href="#l4.20"></a><span id="l4.20"> LDAP_API(int) LDAP_C lcache_compare( LDAP *ld, int msgid, unsigned long tag,</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineminus">-	const char *dn, const char *attr, struct berval *val );</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineplus">+  const char *dn, const char *attr, struct berval *val );</span>
<a href="#l4.23"></a><span id="l4.23"> LDAP_API(int) LDAP_C lcache_add( LDAP *ld, int msgid, unsigned long tag,</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineminus">-	const char *dn, LDAPMod **entry );</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineplus">+  const char *dn, LDAPMod **entry );</span>
<a href="#l4.26"></a><span id="l4.26"> LDAP_API(int) LDAP_C lcache_delete( LDAP *ld, int msgid, unsigned long tag,</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineminus">-	const char *dn );</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineplus">+  const char *dn );</span>
<a href="#l4.29"></a><span id="l4.29"> LDAP_API(int) LDAP_C lcache_rename( LDAP *ld, int msgid, unsigned long tag,</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineminus">-	const char *dn, const char *newrdn, const char *newparent,</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineminus">-	int deleteoldrdn );</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+  const char *dn, const char *newrdn, const char *newparent,</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+  int deleteoldrdn );</span>
<a href="#l4.34"></a><span id="l4.34"> LDAP_API(int) LDAP_C lcache_modify( LDAP *ld, int msgid, unsigned long tag,</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineminus">-	const char *dn, LDAPMod **mods );</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+  const char *dn, LDAPMod **mods );</span>
<a href="#l4.37"></a><span id="l4.37"> LDAP_API(int) LDAP_C lcache_modrdn( LDAP *ld, int msgid, unsigned long tag,</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineminus">-	const char *dn, const char *newrdn, int deleteoldrdn );</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+  const char *dn, const char *newrdn, int deleteoldrdn );</span>
<a href="#l4.40"></a><span id="l4.40"> LDAP_API(int) LDAP_C lcache_result( LDAP *ld, int msgid, int all,</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineminus">-	struct timeval *timeout, LDAPMessage **result );</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineplus">+  struct timeval *timeout, LDAPMessage **result );</span>
<a href="#l4.43"></a><span id="l4.43"> LDAP_API(int) LDAP_C lcache_flush( LDAP *ld, char *dn, char *filter );</span>
<a href="#l4.44"></a><span id="l4.44"> </span>
<a href="#l4.45"></a><span id="l4.45"> #ifdef __cplusplus</span>
<a href="#l4.46"></a><span id="l4.46"> }</span>
<a href="#l4.47"></a><span id="l4.47"> #endif</span>
<a href="#l4.48"></a><span id="l4.48"> </span>
<a href="#l4.49"></a><span id="l4.49"> #endif /* _LCACHE_H */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/ldap/c-sdk/include/ldap-extension.h</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/ldap/c-sdk/include/ldap-extension.h</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -115,43 +115,43 @@ extern &quot;C&quot; {</span>
<a href="#l5.4"></a><span id="l5.4"> /* Password information sent back to client */</span>
<a href="#l5.5"></a><span id="l5.5"> #define LDAP_CONTROL_PWEXPIRED          &quot;2.16.840.1.113730.3.4.4&quot;</span>
<a href="#l5.6"></a><span id="l5.6"> #define LDAP_CONTROL_PWEXPIRING         &quot;2.16.840.1.113730.3.4.5&quot;</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8"> /* Password Policy Control */</span>
<a href="#l5.9"></a><span id="l5.9"> #define LDAP_CONTROL_PASSWD_POLICY      &quot;1.3.6.1.4.1.42.2.27.8.5.1&quot;</span>
<a href="#l5.10"></a><span id="l5.10"> </span>
<a href="#l5.11"></a><span id="l5.11"> /* Password Policy Control compatibility macros */</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-#define LDAP_X_CONTROL_PWPOLICY_REQUEST		LDAP_CONTROL_PASSWD_POLICY</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-#define LDAP_X_CONTROL_PWPOLICY_RESPONSE	LDAP_CONTROL_PASSWD_POLICY</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineminus">-#define LDAP_CONTROL_PASSWORDPOLICYREQUEST	LDAP_CONTROL_PASSWD_POLICY</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineminus">-#define LDAP_CONTROL_PASSWORDPOLICYRESPONSE	LDAP_CONTROL_PASSWD_POLICY</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+#define LDAP_X_CONTROL_PWPOLICY_REQUEST LDAP_CONTROL_PASSWD_POLICY</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+#define LDAP_X_CONTROL_PWPOLICY_RESPONSE LDAP_CONTROL_PASSWD_POLICY</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineplus">+#define LDAP_CONTROL_PASSWORDPOLICYREQUEST LDAP_CONTROL_PASSWD_POLICY</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+#define LDAP_CONTROL_PASSWORDPOLICYRESPONSE LDAP_CONTROL_PASSWD_POLICY</span>
<a href="#l5.20"></a><span id="l5.20"> </span>
<a href="#l5.21"></a><span id="l5.21"> /* Password Modify Extended Operation */</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineminus">-#define LDAP_EXOP_MODIFY_PASSWD			&quot;1.3.6.1.4.1.4203.1.11.1&quot;</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineplus">+#define LDAP_EXOP_MODIFY_PASSWD &quot;1.3.6.1.4.1.4203.1.11.1&quot;</span>
<a href="#l5.24"></a><span id="l5.24"> </span>
<a href="#l5.25"></a><span id="l5.25"> /* Suppress virtual/inherited attribute values */</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineminus">-#define LDAP_CONTROL_REAL_ATTRS_ONLY	&quot;2.16.840.1.113730.3.4.17&quot;</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineplus">+#define LDAP_CONTROL_REAL_ATTRS_ONLY &quot;2.16.840.1.113730.3.4.17&quot;</span>
<a href="#l5.28"></a><span id="l5.28"> </span>
<a href="#l5.29"></a><span id="l5.29"> /* Only return virtual/inherited attribute values */</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineminus">-#define LDAP_CONTROL_VIRTUAL_ATTRS_ONLY	&quot;2.16.840.1.113730.3.4.19&quot;</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineplus">+#define LDAP_CONTROL_VIRTUAL_ATTRS_ONLY &quot;2.16.840.1.113730.3.4.19&quot;</span>
<a href="#l5.32"></a><span id="l5.32"> </span>
<a href="#l5.33"></a><span id="l5.33"> /* getEffectiveRights request */</span>
<a href="#l5.34"></a><span id="l5.34"> #define LDAP_CONTROL_GETEFFECTIVERIGHTS_REQUEST &quot;1.3.6.1.4.1.42.2.27.9.5.2&quot;</span>
<a href="#l5.35"></a><span id="l5.35"> </span>
<a href="#l5.36"></a><span id="l5.36" class="difflineminus">-/* Password Policy Control to get account availability */	</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+/* Password Policy Control to get account availability */</span>
<a href="#l5.38"></a><span id="l5.38"> #define LDAP_CONTROL_ACCOUNT_USABLE     &quot;1.3.6.1.4.1.42.2.27.9.5.8&quot;</span>
<a href="#l5.39"></a><span id="l5.39"> </span>
<a href="#l5.40"></a><span id="l5.40" class="difflineminus">-/* &quot;Who am I?&quot; Extended Operation */	</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineminus">-#define LDAP_EXOP_WHO_AM_I				&quot;1.3.6.1.4.1.4203.1.11.3&quot;</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+/* &quot;Who am I?&quot; Extended Operation */</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineplus">+#define LDAP_EXOP_WHO_AM_I &quot;1.3.6.1.4.1.4203.1.11.3&quot;</span>
<a href="#l5.44"></a><span id="l5.44"> </span>
<a href="#l5.45"></a><span id="l5.45"> LDAP_API(void) LDAP_CALL ldap_ber_free( BerElement *ber, int freebuf );</span>
<a href="#l5.46"></a><span id="l5.46"> </span>
<a href="#l5.47"></a><span id="l5.47"> LDAP_API(LDAPControl *) LDAP_CALL ldap_find_control( const char *oid,</span>
<a href="#l5.48"></a><span id="l5.48" class="difflineminus">-		LDAPControl **ctrls );</span>
<a href="#l5.49"></a><span id="l5.49" class="difflineplus">+    LDAPControl **ctrls );</span>
<a href="#l5.50"></a><span id="l5.50"> </span>
<a href="#l5.51"></a><span id="l5.51"> /*</span>
<a href="#l5.52"></a><span id="l5.52">  * Server side sorting of search results (an LDAPv3 extension --</span>
<a href="#l5.53"></a><span id="l5.53">  * LDAP_API_FEATURE_SERVER_SIDE_SORT)</span>
<a href="#l5.54"></a><span id="l5.54">  */</span>
<a href="#l5.55"></a><span id="l5.55"> typedef struct LDAPsortkey {    /* structure for a sort-key */</span>
<a href="#l5.56"></a><span id="l5.56">         char *  sk_attrtype;</span>
<a href="#l5.57"></a><span id="l5.57">         char *  sk_matchruleoid;</span>
<a href="#l5.58"></a><span id="l5.58" class="difflineat">@@ -197,48 +197,48 @@ LDAP_API(int) LDAP_CALL ldap_create_sort</span>
<a href="#l5.59"></a><span id="l5.59"> LDAP_API(int) LDAP_CALL ldap_parse_sort_control( LDAP *ld,</span>
<a href="#l5.60"></a><span id="l5.60">         LDAPControl **ctrls, ber_int_t *result, char **attribute );</span>
<a href="#l5.61"></a><span id="l5.61"> </span>
<a href="#l5.62"></a><span id="l5.62"> LDAP_API(void) LDAP_CALL ldap_free_sort_keylist( LDAPsortkey **sortKeyList );</span>
<a href="#l5.63"></a><span id="l5.63"> LDAP_API(int) LDAP_CALL ldap_create_sort_keylist( LDAPsortkey ***sortKeyList,</span>
<a href="#l5.64"></a><span id="l5.64">         const char *string_rep );</span>
<a href="#l5.65"></a><span id="l5.65"> </span>
<a href="#l5.66"></a><span id="l5.66"> LDAP_API(int) LDAP_CALL ldap_create_userstatus_control(</span>
<a href="#l5.67"></a><span id="l5.67" class="difflineminus">-		LDAP *ld, const char ctl_iscritical, LDAPControl **ctrlp );</span>
<a href="#l5.68"></a><span id="l5.68" class="difflineplus">+    LDAP *ld, const char ctl_iscritical, LDAPControl **ctrlp );</span>
<a href="#l5.69"></a><span id="l5.69"> LDAP_API(int) LDAP_CALL ldap_parse_userstatus_control( LDAP *ld,</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineminus">-		LDAPControl **ctrlp, LDAPuserstatus *us );</span>
<a href="#l5.71"></a><span id="l5.71" class="difflineplus">+    LDAPControl **ctrlp, LDAPuserstatus *us );</span>
<a href="#l5.72"></a><span id="l5.72"> </span>
<a href="#l5.73"></a><span id="l5.73"> LDAP_API(int) LDAP_CALL ldap_create_passwordpolicy_control( LDAP *ld,</span>
<a href="#l5.74"></a><span id="l5.74" class="difflineminus">-		LDAPControl **ctrlp );</span>
<a href="#l5.75"></a><span id="l5.75" class="difflineplus">+    LDAPControl **ctrlp );</span>
<a href="#l5.76"></a><span id="l5.76"> LDAP_API(int) LDAP_CALL ldap_create_passwordpolicy_control_ext( LDAP *ld,</span>
<a href="#l5.77"></a><span id="l5.77" class="difflineminus">-		const char ctl_iscritical, LDAPControl **ctrlp );</span>
<a href="#l5.78"></a><span id="l5.78" class="difflineplus">+    const char ctl_iscritical, LDAPControl **ctrlp );</span>
<a href="#l5.79"></a><span id="l5.79"> LDAP_API(int) LDAP_CALL ldap_parse_passwordpolicy_control( LDAP *ld,</span>
<a href="#l5.80"></a><span id="l5.80" class="difflineminus">-		LDAPControl *ctrlp, ber_int_t *expirep, ber_int_t *gracep,</span>
<a href="#l5.81"></a><span id="l5.81" class="difflineminus">-		LDAPPasswordPolicyError *errorp );</span>
<a href="#l5.82"></a><span id="l5.82" class="difflineplus">+    LDAPControl *ctrlp, ber_int_t *expirep, ber_int_t *gracep,</span>
<a href="#l5.83"></a><span id="l5.83" class="difflineplus">+    LDAPPasswordPolicyError *errorp );</span>
<a href="#l5.84"></a><span id="l5.84"> LDAP_API(int) LDAP_CALL ldap_parse_passwordpolicy_control_ext ( LDAP *ld,</span>
<a href="#l5.85"></a><span id="l5.85" class="difflineminus">-		LDAPControl **ctrlp, ber_int_t *expirep, ber_int_t *gracep,</span>
<a href="#l5.86"></a><span id="l5.86" class="difflineminus">-		LDAPPasswordPolicyError *errorp );</span>
<a href="#l5.87"></a><span id="l5.87" class="difflineplus">+    LDAPControl **ctrlp, ber_int_t *expirep, ber_int_t *gracep,</span>
<a href="#l5.88"></a><span id="l5.88" class="difflineplus">+    LDAPPasswordPolicyError *errorp );</span>
<a href="#l5.89"></a><span id="l5.89"> LDAP_API(const char *) LDAP_CALL ldap_passwordpolicy_err2txt(</span>
<a href="#l5.90"></a><span id="l5.90" class="difflineminus">-		LDAPPasswordPolicyError err );</span>
<a href="#l5.91"></a><span id="l5.91" class="difflineplus">+    LDAPPasswordPolicyError err );</span>
<a href="#l5.92"></a><span id="l5.92"> </span>
<a href="#l5.93"></a><span id="l5.93"> LDAP_API(int) LDAP_CALL ldap_create_authzid_control( LDAP *ld,</span>
<a href="#l5.94"></a><span id="l5.94" class="difflineminus">-		const char ctl_iscritical, LDAPControl **ctrlp );</span>
<a href="#l5.95"></a><span id="l5.95" class="difflineplus">+    const char ctl_iscritical, LDAPControl **ctrlp );</span>
<a href="#l5.96"></a><span id="l5.96"> LDAP_API(int) LDAP_CALL ldap_parse_authzid_control( LDAP *ld,</span>
<a href="#l5.97"></a><span id="l5.97" class="difflineminus">-		LDAPControl **ctrlp, char **authzid );</span>
<a href="#l5.98"></a><span id="l5.98" class="difflineplus">+    LDAPControl **ctrlp, char **authzid );</span>
<a href="#l5.99"></a><span id="l5.99"> </span>
<a href="#l5.100"></a><span id="l5.100"> LDAP_API(int) LDAP_CALL ldap_whoami( LDAP *ld, LDAPControl **serverctrls,</span>
<a href="#l5.101"></a><span id="l5.101" class="difflineminus">-		LDAPControl **clientctrls, int *msgidp );</span>
<a href="#l5.102"></a><span id="l5.102" class="difflineplus">+    LDAPControl **clientctrls, int *msgidp );</span>
<a href="#l5.103"></a><span id="l5.103"> LDAP_API(int) LDAP_CALL ldap_whoami_s( LDAP *ld, struct berval **authzid,</span>
<a href="#l5.104"></a><span id="l5.104" class="difflineminus">-		LDAPControl **serverctrls, LDAPControl **clientctrls );</span>
<a href="#l5.105"></a><span id="l5.105" class="difflineplus">+    LDAPControl **serverctrls, LDAPControl **clientctrls );</span>
<a href="#l5.106"></a><span id="l5.106"> LDAP_API(int) LDAP_CALL ldap_parse_whoami( LDAP *ld, LDAPMessage *result,</span>
<a href="#l5.107"></a><span id="l5.107" class="difflineminus">-		struct berval **authzid );</span>
<a href="#l5.108"></a><span id="l5.108" class="difflineplus">+    struct berval **authzid );</span>
<a href="#l5.109"></a><span id="l5.109"> </span>
<a href="#l5.110"></a><span id="l5.110"> LDAP_API(int) LDAP_CALL ldap_create_geteffectiveRights_control( LDAP *ld,</span>
<a href="#l5.111"></a><span id="l5.111">         const char *authzid, const char **attrlist,  const char ctl_iscritical,</span>
<a href="#l5.112"></a><span id="l5.112" class="difflineminus">-		LDAPControl **ctrlp );</span>
<a href="#l5.113"></a><span id="l5.113" class="difflineplus">+    LDAPControl **ctrlp );</span>
<a href="#l5.114"></a><span id="l5.114"> </span>
<a href="#l5.115"></a><span id="l5.115"> /*</span>
<a href="#l5.116"></a><span id="l5.116">  * Virtual list view (an LDAPv3 extension -- LDAP_API_FEATURE_VIRTUAL_LIST_VIEW)</span>
<a href="#l5.117"></a><span id="l5.117">  */</span>
<a href="#l5.118"></a><span id="l5.118"> /*</span>
<a href="#l5.119"></a><span id="l5.119">  * structure that describes a VirtualListViewRequest control.</span>
<a href="#l5.120"></a><span id="l5.120">  * note that ldvlist_index and ldvlist_size are only relevant to</span>
<a href="#l5.121"></a><span id="l5.121">  * ldap_create_virtuallist_control() if ldvlist_attrvalue is NULL.</span>
<a href="#l5.122"></a><span id="l5.122" class="difflineat">@@ -325,17 +325,17 @@ typedef struct ldap_url_desc {</span>
<a href="#l5.123"></a><span id="l5.123"> /*</span>
<a href="#l5.124"></a><span id="l5.124">  * possible errors returned by ldap_url_parse()</span>
<a href="#l5.125"></a><span id="l5.125">  */</span>
<a href="#l5.126"></a><span id="l5.126"> #define LDAP_URL_ERR_NOTLDAP    1       /* URL doesn't begin with &quot;ldap://&quot; */</span>
<a href="#l5.127"></a><span id="l5.127"> #define LDAP_URL_ERR_NODN       2       /* URL has no DN (required) */</span>
<a href="#l5.128"></a><span id="l5.128"> #define LDAP_URL_ERR_BADSCOPE   3       /* URL scope string is invalid */</span>
<a href="#l5.129"></a><span id="l5.129"> #define LDAP_URL_ERR_MEM        4       /* can't allocate memory space */</span>
<a href="#l5.130"></a><span id="l5.130"> #define LDAP_URL_ERR_PARAM      5       /* bad parameter to an URL function */</span>
<a href="#l5.131"></a><span id="l5.131" class="difflineminus">-#define LDAP_URL_UNRECOGNIZED_CRITICAL_EXTENSION	6</span>
<a href="#l5.132"></a><span id="l5.132" class="difflineplus">+#define LDAP_URL_UNRECOGNIZED_CRITICAL_EXTENSION 6</span>
<a href="#l5.133"></a><span id="l5.133"> </span>
<a href="#l5.134"></a><span id="l5.134"> /*</span>
<a href="#l5.135"></a><span id="l5.135">  * URL functions:</span>
<a href="#l5.136"></a><span id="l5.136">  */</span>
<a href="#l5.137"></a><span id="l5.137"> LDAP_API(int) LDAP_CALL ldap_is_ldap_url( const char *url );</span>
<a href="#l5.138"></a><span id="l5.138"> LDAP_API(int) LDAP_CALL ldap_url_parse( const char *url, LDAPURLDesc **ludpp );</span>
<a href="#l5.139"></a><span id="l5.139"> LDAP_API(int) LDAP_CALL ldap_url_parse_no_defaults( const char *url,</span>
<a href="#l5.140"></a><span id="l5.140">         LDAPURLDesc **ludpp, int dn_required);</span>
<a href="#l5.141"></a><span id="l5.141" class="difflineat">@@ -413,19 +413,19 @@ struct ldap_thread_fns {</span>
<a href="#l5.142"></a><span id="l5.142"> /*</span>
<a href="#l5.143"></a><span id="l5.143">  * Extended I/O function callbacks option (an API extension --</span>
<a href="#l5.144"></a><span id="l5.144">  * LDAP_API_FEATURE_X_EXTIO_FUNCTIONS).</span>
<a href="#l5.145"></a><span id="l5.145">  */</span>
<a href="#l5.146"></a><span id="l5.146"> #define LDAP_X_OPT_EXTIO_FN_PTRS   (LDAP_OPT_PRIVATE_EXTENSION_BASE + 0x0F00)</span>
<a href="#l5.147"></a><span id="l5.147">         /* 0x4000 + 0x0F00 = 0x4F00 = 20224 - API extension */</span>
<a href="#l5.148"></a><span id="l5.148"> </span>
<a href="#l5.149"></a><span id="l5.149"> /* Additional Extended I/O function callback option (for Extended Socket Arg callback) */</span>
<a href="#l5.150"></a><span id="l5.150" class="difflineminus">-#define LDAP_X_OPT_SOCKETARG	(LDAP_OPT_PRIVATE_EXTENSION_BASE + 0x0F02)</span>
<a href="#l5.151"></a><span id="l5.151" class="difflineplus">+#define LDAP_X_OPT_SOCKETARG (LDAP_OPT_PRIVATE_EXTENSION_BASE + 0x0F02)</span>
<a href="#l5.152"></a><span id="l5.152">         /* 0x4000 + 0x0F02 = 0x4F02 = 20226 - API extension */</span>
<a href="#l5.153"></a><span id="l5.153" class="difflineminus">-	</span>
<a href="#l5.154"></a><span id="l5.154" class="difflineplus">+</span>
<a href="#l5.155"></a><span id="l5.155"> /*</span>
<a href="#l5.156"></a><span id="l5.156">  * These extended I/O function callbacks echo the BSD socket API but accept</span>
<a href="#l5.157"></a><span id="l5.157">  * an extra pointer parameter at the end of their argument list that can</span>
<a href="#l5.158"></a><span id="l5.158">  * be used by client applications for their own needs.  For some of the calls,</span>
<a href="#l5.159"></a><span id="l5.159">  * the pointer is a session argument of type struct lextiof_session_private *</span>
<a href="#l5.160"></a><span id="l5.160">  * that is associated with the LDAP session handle (LDAP *).  For others, the</span>
<a href="#l5.161"></a><span id="l5.161">  * pointer is a socket specific struct lextiof_socket_private * argument that</span>
<a href="#l5.162"></a><span id="l5.162">  * is associated with a particular socket (a TCP connection).</span>
<a href="#l5.163"></a><span id="l5.163" class="difflineat">@@ -648,17 +648,17 @@ LDAP_API(void) LDAP_CALL ldap_memcache_u</span>
<a href="#l5.164"></a><span id="l5.164">  */</span>
<a href="#l5.165"></a><span id="l5.165"> #define LDAP_X_OPT_CONNECT_TIMEOUT    (LDAP_OPT_PRIVATE_EXTENSION_BASE + 0x0F01)</span>
<a href="#l5.166"></a><span id="l5.166">         /* 0x4000 + 0x0F01 = 0x4F01 = 20225 - API extension */</span>
<a href="#l5.167"></a><span id="l5.167"> </span>
<a href="#l5.168"></a><span id="l5.168"> /*</span>
<a href="#l5.169"></a><span id="l5.169">  * Socket buffer structure associated to the LDAP connection</span>
<a href="#l5.170"></a><span id="l5.170">  */</span>
<a href="#l5.171"></a><span id="l5.171"> #define LDAP_X_OPT_SOCKBUF            (LDAP_OPT_PRIVATE_EXTENSION_BASE + 0x0F03)</span>
<a href="#l5.172"></a><span id="l5.172" class="difflineminus">-	/* 0x4000 + 0x0F03 = 0x4F03 = 20227 - API extension */</span>
<a href="#l5.173"></a><span id="l5.173" class="difflineplus">+  /* 0x4000 + 0x0F03 = 0x4F03 = 20227 - API extension */</span>
<a href="#l5.174"></a><span id="l5.174"> </span>
<a href="#l5.175"></a><span id="l5.175"> /*</span>
<a href="#l5.176"></a><span id="l5.176">  * Memory allocation callback functions (an API extension --</span>
<a href="#l5.177"></a><span id="l5.177">  * LDAP_API_FEATURE_X_MEMALLOC_FUNCTIONS).  These are global and can</span>
<a href="#l5.178"></a><span id="l5.178">  * not be set on a per-LDAP session handle basis.  Install your own</span>
<a href="#l5.179"></a><span id="l5.179">  * functions by making a call like this:</span>
<a href="#l5.180"></a><span id="l5.180">  *    ldap_set_option( NULL, LDAP_OPT_MEMALLOC_FN_PTRS, &amp;memalloc_fns );</span>
<a href="#l5.181"></a><span id="l5.181">  *</span>
<a href="#l5.182"></a><span id="l5.182" class="difflineat">@@ -823,27 +823,27 @@ LDAP_API(int) LDAP_CALL ldap_sasl_intera</span>
<a href="#l5.183"></a><span id="l5.183">         LDAP_SASL_INTERACT_PROC *proc,</span>
<a href="#l5.184"></a><span id="l5.184">         void *defaults,</span>
<a href="#l5.185"></a><span id="l5.185">         LDAPControl ***responseControls );</span>
<a href="#l5.186"></a><span id="l5.186"> </span>
<a href="#l5.187"></a><span id="l5.187"> /*</span>
<a href="#l5.188"></a><span id="l5.188">  * Password modify functions</span>
<a href="#l5.189"></a><span id="l5.189">  */</span>
<a href="#l5.190"></a><span id="l5.190"> LDAP_API(int) LDAP_CALL ldap_passwd( LDAP *ld, struct berval *userid,</span>
<a href="#l5.191"></a><span id="l5.191" class="difflineminus">-	struct berval *oldpasswd, struct berval *newpasswd,</span>
<a href="#l5.192"></a><span id="l5.192" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l5.193"></a><span id="l5.193" class="difflineminus">-	int *msgidp );</span>
<a href="#l5.194"></a><span id="l5.194" class="difflineplus">+  struct berval *oldpasswd, struct berval *newpasswd,</span>
<a href="#l5.195"></a><span id="l5.195" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l5.196"></a><span id="l5.196" class="difflineplus">+  int *msgidp );</span>
<a href="#l5.197"></a><span id="l5.197"> </span>
<a href="#l5.198"></a><span id="l5.198"> LDAP_API(int) LDAP_CALL ldap_passwd_s( LDAP *ld, struct berval *userid,</span>
<a href="#l5.199"></a><span id="l5.199" class="difflineminus">-	struct berval *oldpasswd, struct berval *newpasswd,</span>
<a href="#l5.200"></a><span id="l5.200" class="difflineminus">-	struct berval *genpasswd, LDAPControl **serverctrls,</span>
<a href="#l5.201"></a><span id="l5.201" class="difflineminus">-	LDAPControl **clientctrls );</span>
<a href="#l5.202"></a><span id="l5.202" class="difflineplus">+  struct berval *oldpasswd, struct berval *newpasswd,</span>
<a href="#l5.203"></a><span id="l5.203" class="difflineplus">+  struct berval *genpasswd, LDAPControl **serverctrls,</span>
<a href="#l5.204"></a><span id="l5.204" class="difflineplus">+  LDAPControl **clientctrls );</span>
<a href="#l5.205"></a><span id="l5.205"> </span>
<a href="#l5.206"></a><span id="l5.206"> LDAP_API(int) LDAP_CALL ldap_parse_passwd( LDAP *ld, LDAPMessage *result,</span>
<a href="#l5.207"></a><span id="l5.207" class="difflineminus">-	struct berval *genpasswd );</span>
<a href="#l5.208"></a><span id="l5.208" class="difflineplus">+  struct berval *genpasswd );</span>
<a href="#l5.209"></a><span id="l5.209"> </span>
<a href="#l5.210"></a><span id="l5.210"> /*</span>
<a href="#l5.211"></a><span id="l5.211">  * in reslist.c</span>
<a href="#l5.212"></a><span id="l5.212">  */</span>
<a href="#l5.213"></a><span id="l5.213"> LDAP_API(LDAPMessage *) LDAP_CALL ldap_delete_result_entry( LDAPMessage **list, LDAPMessage *e );</span>
<a href="#l5.214"></a><span id="l5.214"> LDAP_API(void) LDAP_CALL ldap_add_result_entry( LDAPMessage **list, LDAPMessage *e );</span>
<a href="#l5.215"></a><span id="l5.215"> </span>
<a href="#l5.216"></a><span id="l5.216"> #ifdef __cplusplus</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/ldap/c-sdk/include/ldap-platform.h</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/ldap/c-sdk/include/ldap-platform.h</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -48,24 +48,24 @@ extern &quot;C&quot; {</span>
<a href="#l6.4"></a><span id="l6.4"> #include &lt;windows.h&gt;</span>
<a href="#l6.5"></a><span id="l6.5"> #  if defined( _WINDOWS )</span>
<a href="#l6.6"></a><span id="l6.6"> #  include &lt;winsock.h&gt;</span>
<a href="#l6.7"></a><span id="l6.7"> #  endif</span>
<a href="#l6.8"></a><span id="l6.8"> #elif defined(macintosh)</span>
<a href="#l6.9"></a><span id="l6.9"> #ifndef LDAP_TYPE_TIMEVAL_DEFINED</span>
<a href="#l6.10"></a><span id="l6.10"> #include &lt;utime.h&gt;</span>
<a href="#l6.11"></a><span id="l6.11"> #endif</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-#ifndef LDAP_TYPE_SOCKET_DEFINED	/* API extension */</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+#ifndef LDAP_TYPE_SOCKET_DEFINED  /* API extension */</span>
<a href="#l6.14"></a><span id="l6.14"> #include &quot;macsocket.h&quot;</span>
<a href="#l6.15"></a><span id="l6.15"> #endif</span>
<a href="#l6.16"></a><span id="l6.16"> #else /* everything else, e.g., Unix */</span>
<a href="#l6.17"></a><span id="l6.17"> #ifndef LDAP_TYPE_TIMEVAL_DEFINED</span>
<a href="#l6.18"></a><span id="l6.18"> #include &lt;sys/time.h&gt;</span>
<a href="#l6.19"></a><span id="l6.19"> #endif</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineminus">-#ifndef LDAP_TYPE_SOCKET_DEFINED	/* API extension */</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineplus">+#ifndef LDAP_TYPE_SOCKET_DEFINED  /* API extension */</span>
<a href="#l6.22"></a><span id="l6.22"> #include &lt;sys/types.h&gt;</span>
<a href="#l6.23"></a><span id="l6.23"> #include &lt;sys/socket.h&gt;</span>
<a href="#l6.24"></a><span id="l6.24"> #endif</span>
<a href="#l6.25"></a><span id="l6.25"> #endif</span>
<a href="#l6.26"></a><span id="l6.26"> </span>
<a href="#l6.27"></a><span id="l6.27"> #ifdef _AIX</span>
<a href="#l6.28"></a><span id="l6.28"> #include &lt;sys/select.h&gt;</span>
<a href="#l6.29"></a><span id="l6.29"> #endif /* _AIX */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/ldap/c-sdk/include/ldap-standard.h</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/ldap/c-sdk/include/ldap-standard.h</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -45,83 +45,83 @@</span>
<a href="#l7.4"></a><span id="l7.4"> #ifdef __cplusplus</span>
<a href="#l7.5"></a><span id="l7.5"> extern &quot;C&quot; {</span>
<a href="#l7.6"></a><span id="l7.6"> #endif</span>
<a href="#l7.7"></a><span id="l7.7"> </span>
<a href="#l7.8"></a><span id="l7.8"> #include &quot;ldap-platform.h&quot;</span>
<a href="#l7.9"></a><span id="l7.9"> </span>
<a href="#l7.10"></a><span id="l7.10"> #include &quot;lber.h&quot;</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-#define LDAP_PORT       	389</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-#define LDAPS_PORT      	636</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-#define LDAP_VERSION2   	2</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineminus">-#define LDAP_VERSION3   	3</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineminus">-#define LDAP_VERSION_MIN	LDAP_VERSION1</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineminus">-#define LDAP_VERSION_MAX	LDAP_VERSION3</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+#define LDAP_PORT 389</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+#define LDAPS_PORT 636</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineplus">+#define LDAP_VERSION2 2</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineplus">+#define LDAP_VERSION3 3</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineplus">+#define LDAP_VERSION_MIN LDAP_VERSION1</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineplus">+#define LDAP_VERSION_MAX LDAP_VERSION3</span>
<a href="#l7.24"></a><span id="l7.24"> </span>
<a href="#l7.25"></a><span id="l7.25" class="difflineminus">-#define LDAP_VENDOR_VERSION	607	/* version # * 100 */</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineminus">-#define LDAP_VENDOR_NAME	&quot;mozilla.org&quot;</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineplus">+#define LDAP_VENDOR_VERSION 607  /* version # * 100 */</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineplus">+#define LDAP_VENDOR_NAME &quot;mozilla.org&quot;</span>
<a href="#l7.29"></a><span id="l7.29"> /*</span>
<a href="#l7.30"></a><span id="l7.30">  * The following will be an RFC number once the LDAP C API Internet Draft</span>
<a href="#l7.31"></a><span id="l7.31">  * is published as a Proposed Standard RFC.  For now we use 2000 + the</span>
<a href="#l7.32"></a><span id="l7.32">  * draft revision number (currently 5) since we are close to compliance</span>
<a href="#l7.33"></a><span id="l7.33">  * with revision 5 of the draft.</span>
<a href="#l7.34"></a><span id="l7.34">  */</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineminus">-#define LDAP_API_VERSION	2005</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineplus">+#define LDAP_API_VERSION 2005</span>
<a href="#l7.37"></a><span id="l7.37"> </span>
<a href="#l7.38"></a><span id="l7.38"> /* special values that may appear in the attributes field of a SearchRequest.</span>
<a href="#l7.39"></a><span id="l7.39">  */</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineminus">-#define LDAP_NO_ATTRS		&quot;1.1&quot;</span>
<a href="#l7.41"></a><span id="l7.41" class="difflineminus">-#define LDAP_ALL_USER_ATTRS	&quot;*&quot;</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineplus">+#define LDAP_NO_ATTRS &quot;1.1&quot;</span>
<a href="#l7.43"></a><span id="l7.43" class="difflineplus">+#define LDAP_ALL_USER_ATTRS &quot;*&quot;</span>
<a href="#l7.44"></a><span id="l7.44"> </span>
<a href="#l7.45"></a><span id="l7.45"> /*</span>
<a href="#l7.46"></a><span id="l7.46">  * Standard options (used with ldap_set_option() and ldap_get_option):</span>
<a href="#l7.47"></a><span id="l7.47">  */</span>
<a href="#l7.48"></a><span id="l7.48" class="difflineminus">-#define LDAP_OPT_API_INFO               0x00	/*  0 */</span>
<a href="#l7.49"></a><span id="l7.49" class="difflineminus">-#define LDAP_OPT_DEREF                  0x02	/*  2 */</span>
<a href="#l7.50"></a><span id="l7.50" class="difflineminus">-#define LDAP_OPT_SIZELIMIT              0x03	/*  3 */</span>
<a href="#l7.51"></a><span id="l7.51" class="difflineminus">-#define LDAP_OPT_TIMELIMIT              0x04	/*  4 */</span>
<a href="#l7.52"></a><span id="l7.52" class="difflineminus">-#define LDAP_OPT_REFERRALS              0x08	/*  8 */</span>
<a href="#l7.53"></a><span id="l7.53" class="difflineminus">-#define LDAP_OPT_RESTART                0x09	/*  9 */</span>
<a href="#l7.54"></a><span id="l7.54" class="difflineminus">-#define LDAP_OPT_PROTOCOL_VERSION	0x11	/* 17 */</span>
<a href="#l7.55"></a><span id="l7.55" class="difflineminus">-#define LDAP_OPT_SERVER_CONTROLS	0x12	/* 18 */</span>
<a href="#l7.56"></a><span id="l7.56" class="difflineminus">-#define LDAP_OPT_CLIENT_CONTROLS	0x13	/* 19 */</span>
<a href="#l7.57"></a><span id="l7.57" class="difflineminus">-#define LDAP_OPT_API_FEATURE_INFO	0x15	/* 21 */</span>
<a href="#l7.58"></a><span id="l7.58" class="difflineminus">-#define LDAP_OPT_HOST_NAME		0x30	/* 48 */</span>
<a href="#l7.59"></a><span id="l7.59" class="difflineminus">-#define LDAP_OPT_ERROR_NUMBER		0x31	/* 49 */</span>
<a href="#l7.60"></a><span id="l7.60" class="difflineminus">-#define LDAP_OPT_ERROR_STRING		0x32	/* 50 */</span>
<a href="#l7.61"></a><span id="l7.61" class="difflineminus">-#define LDAP_OPT_MATCHED_DN		0x33	/* 51 */</span>
<a href="#l7.62"></a><span id="l7.62" class="difflineplus">+#define LDAP_OPT_API_INFO         0x00  /*  0 */</span>
<a href="#l7.63"></a><span id="l7.63" class="difflineplus">+#define LDAP_OPT_DEREF            0x02  /*  2 */</span>
<a href="#l7.64"></a><span id="l7.64" class="difflineplus">+#define LDAP_OPT_SIZELIMIT        0x03  /*  3 */</span>
<a href="#l7.65"></a><span id="l7.65" class="difflineplus">+#define LDAP_OPT_TIMELIMIT        0x04  /*  4 */</span>
<a href="#l7.66"></a><span id="l7.66" class="difflineplus">+#define LDAP_OPT_REFERRALS        0x08  /*  8 */</span>
<a href="#l7.67"></a><span id="l7.67" class="difflineplus">+#define LDAP_OPT_RESTART          0x09  /*  9 */</span>
<a href="#l7.68"></a><span id="l7.68" class="difflineplus">+#define LDAP_OPT_PROTOCOL_VERSION 0x11  /* 17 */</span>
<a href="#l7.69"></a><span id="l7.69" class="difflineplus">+#define LDAP_OPT_SERVER_CONTROLS  0x12  /* 18 */</span>
<a href="#l7.70"></a><span id="l7.70" class="difflineplus">+#define LDAP_OPT_CLIENT_CONTROLS  0x13  /* 19 */</span>
<a href="#l7.71"></a><span id="l7.71" class="difflineplus">+#define LDAP_OPT_API_FEATURE_INFO 0x15  /* 21 */</span>
<a href="#l7.72"></a><span id="l7.72" class="difflineplus">+#define LDAP_OPT_HOST_NAME        0x30  /* 48 */</span>
<a href="#l7.73"></a><span id="l7.73" class="difflineplus">+#define LDAP_OPT_ERROR_NUMBER     0x31  /* 49 */</span>
<a href="#l7.74"></a><span id="l7.74" class="difflineplus">+#define LDAP_OPT_ERROR_STRING     0x32  /* 50 */</span>
<a href="#l7.75"></a><span id="l7.75" class="difflineplus">+#define LDAP_OPT_MATCHED_DN       0x33  /* 51 */</span>
<a href="#l7.76"></a><span id="l7.76"> </span>
<a href="#l7.77"></a><span id="l7.77"> /*</span>
<a href="#l7.78"></a><span id="l7.78">  * Well-behaved private and experimental extensions will use option values</span>
<a href="#l7.79"></a><span id="l7.79">  * between 0x4000 (16384) and 0x7FFF (32767) inclusive.</span>
<a href="#l7.80"></a><span id="l7.80">  */</span>
<a href="#l7.81"></a><span id="l7.81" class="difflineminus">-#define LDAP_OPT_PRIVATE_EXTENSION_BASE	0x4000	/* to 0x7FFF inclusive */</span>
<a href="#l7.82"></a><span id="l7.82" class="difflineplus">+#define LDAP_OPT_PRIVATE_EXTENSION_BASE 0x4000  /* to 0x7FFF inclusive */</span>
<a href="#l7.83"></a><span id="l7.83"> </span>
<a href="#l7.84"></a><span id="l7.84"> /* for on/off options */</span>
<a href="#l7.85"></a><span id="l7.85" class="difflineminus">-#define LDAP_OPT_ON     ((void *)1)</span>
<a href="#l7.86"></a><span id="l7.86" class="difflineminus">-#define LDAP_OPT_OFF    ((void *)0)</span>
<a href="#l7.87"></a><span id="l7.87" class="difflineplus">+#define LDAP_OPT_ON  ((void *)1)</span>
<a href="#l7.88"></a><span id="l7.88" class="difflineplus">+#define LDAP_OPT_OFF ((void *)0)</span>
<a href="#l7.89"></a><span id="l7.89"> </span>
<a href="#l7.90"></a><span id="l7.90" class="difflineminus">-typedef struct ldap     LDAP;           /* opaque connection handle */</span>
<a href="#l7.91"></a><span id="l7.91" class="difflineminus">-typedef struct ldapmsg  LDAPMessage;    /* opaque result/entry handle */</span>
<a href="#l7.92"></a><span id="l7.92" class="difflineplus">+typedef struct ldap     LDAP;         /* opaque connection handle */</span>
<a href="#l7.93"></a><span id="l7.93" class="difflineplus">+typedef struct ldapmsg  LDAPMessage;  /* opaque result/entry handle */</span>
<a href="#l7.94"></a><span id="l7.94"> </span>
<a href="#l7.95"></a><span id="l7.95"> /* structure representing an LDAP modification */</span>
<a href="#l7.96"></a><span id="l7.96"> typedef struct ldapmod {</span>
<a href="#l7.97"></a><span id="l7.97" class="difflineminus">-	int             mod_op;         /* kind of mod + form of values*/</span>
<a href="#l7.98"></a><span id="l7.98" class="difflineminus">-#define LDAP_MOD_ADD            0x00</span>
<a href="#l7.99"></a><span id="l7.99" class="difflineminus">-#define LDAP_MOD_DELETE         0x01</span>
<a href="#l7.100"></a><span id="l7.100" class="difflineminus">-#define LDAP_MOD_REPLACE        0x02</span>
<a href="#l7.101"></a><span id="l7.101" class="difflineminus">-#define LDAP_MOD_BVALUES        0x80</span>
<a href="#l7.102"></a><span id="l7.102" class="difflineminus">-	char            *mod_type;      /* attribute name to modify */</span>
<a href="#l7.103"></a><span id="l7.103" class="difflineminus">-	union mod_vals_u {</span>
<a href="#l7.104"></a><span id="l7.104" class="difflineminus">-		char            **modv_strvals;</span>
<a href="#l7.105"></a><span id="l7.105" class="difflineminus">-		struct berval   **modv_bvals;</span>
<a href="#l7.106"></a><span id="l7.106" class="difflineminus">-	} mod_vals;                     /* values to add/delete/replace */</span>
<a href="#l7.107"></a><span id="l7.107" class="difflineminus">-#define mod_values      mod_vals.modv_strvals</span>
<a href="#l7.108"></a><span id="l7.108" class="difflineminus">-#define mod_bvalues     mod_vals.modv_bvals</span>
<a href="#l7.109"></a><span id="l7.109" class="difflineplus">+  int mod_op;  /* kind of mod + form of values*/</span>
<a href="#l7.110"></a><span id="l7.110" class="difflineplus">+#define LDAP_MOD_ADD     0x00</span>
<a href="#l7.111"></a><span id="l7.111" class="difflineplus">+#define LDAP_MOD_DELETE  0x01</span>
<a href="#l7.112"></a><span id="l7.112" class="difflineplus">+#define LDAP_MOD_REPLACE 0x02</span>
<a href="#l7.113"></a><span id="l7.113" class="difflineplus">+#define LDAP_MOD_BVALUES 0x80</span>
<a href="#l7.114"></a><span id="l7.114" class="difflineplus">+  char *mod_type;  /* attribute name to modify */</span>
<a href="#l7.115"></a><span id="l7.115" class="difflineplus">+  union mod_vals_u {</span>
<a href="#l7.116"></a><span id="l7.116" class="difflineplus">+    char            **modv_strvals;</span>
<a href="#l7.117"></a><span id="l7.117" class="difflineplus">+    struct berval   **modv_bvals;</span>
<a href="#l7.118"></a><span id="l7.118" class="difflineplus">+  } mod_vals;  /* values to add/delete/replace */</span>
<a href="#l7.119"></a><span id="l7.119" class="difflineplus">+#define mod_values  mod_vals.modv_strvals</span>
<a href="#l7.120"></a><span id="l7.120" class="difflineplus">+#define mod_bvalues mod_vals.modv_bvals</span>
<a href="#l7.121"></a><span id="l7.121"> } LDAPMod;</span>
<a href="#l7.122"></a><span id="l7.122"> </span>
<a href="#l7.123"></a><span id="l7.123"> </span>
<a href="#l7.124"></a><span id="l7.124"> /*</span>
<a href="#l7.125"></a><span id="l7.125">  * structure for holding ldapv3 controls</span>
<a href="#l7.126"></a><span id="l7.126">  */</span>
<a href="#l7.127"></a><span id="l7.127"> typedef struct ldapcontrol {</span>
<a href="#l7.128"></a><span id="l7.128">     char            *ldctl_oid;</span>
<a href="#l7.129"></a><span id="l7.129" class="difflineat">@@ -132,17 +132,17 @@ typedef struct ldapcontrol {</span>
<a href="#l7.130"></a><span id="l7.130"> </span>
<a href="#l7.131"></a><span id="l7.131"> /*</span>
<a href="#l7.132"></a><span id="l7.132">  * LDAP API information.  Can be retrieved by using a sequence like:</span>
<a href="#l7.133"></a><span id="l7.133">  *</span>
<a href="#l7.134"></a><span id="l7.134">  *    LDAPAPIInfo ldai;</span>
<a href="#l7.135"></a><span id="l7.135">  *    ldai.ldapai_info_version = LDAP_API_INFO_VERSION;</span>
<a href="#l7.136"></a><span id="l7.136">  *    if ( ldap_get_option( NULL, LDAP_OPT_API_INFO, &amp;ldia ) == 0 ) ...</span>
<a href="#l7.137"></a><span id="l7.137">  */</span>
<a href="#l7.138"></a><span id="l7.138" class="difflineminus">-#define LDAP_API_INFO_VERSION		1</span>
<a href="#l7.139"></a><span id="l7.139" class="difflineplus">+#define LDAP_API_INFO_VERSION 1</span>
<a href="#l7.140"></a><span id="l7.140"> typedef struct ldapapiinfo {</span>
<a href="#l7.141"></a><span id="l7.141">     int  ldapai_info_version;     /* version of this struct (1) */</span>
<a href="#l7.142"></a><span id="l7.142">     int  ldapai_api_version;      /* revision of API supported */</span>
<a href="#l7.143"></a><span id="l7.143">     int  ldapai_protocol_version; /* highest LDAP version supported */</span>
<a href="#l7.144"></a><span id="l7.144">     char **ldapai_extensions;     /* names of API extensions */</span>
<a href="#l7.145"></a><span id="l7.145">     char *ldapai_vendor_name;     /* name of supplier */</span>
<a href="#l7.146"></a><span id="l7.146">     int  ldapai_vendor_version;   /* supplier-specific version times 100 */</span>
<a href="#l7.147"></a><span id="l7.147"> } LDAPAPIInfo;</span>
<a href="#l7.148"></a><span id="l7.148" class="difflineat">@@ -151,307 +151,307 @@ typedef struct ldapapiinfo {</span>
<a href="#l7.149"></a><span id="l7.149"> /*</span>
<a href="#l7.150"></a><span id="l7.150">  * LDAP API extended features info.  Can be retrieved by using a sequence like:</span>
<a href="#l7.151"></a><span id="l7.151">  *</span>
<a href="#l7.152"></a><span id="l7.152">  *    LDAPAPIFeatureInfo ldfi;</span>
<a href="#l7.153"></a><span id="l7.153">  *    ldfi.ldapaif_info_version = LDAP_FEATURE_INFO_VERSION;</span>
<a href="#l7.154"></a><span id="l7.154">  *    ldfi.ldapaif_name = &quot;VIRTUAL_LIST_VIEW&quot;;</span>
<a href="#l7.155"></a><span id="l7.155">  *    if ( ldap_get_option( NULL, LDAP_OPT_API_FEATURE_INFO, &amp;ldfi ) == 0 ) ...</span>
<a href="#l7.156"></a><span id="l7.156">  */</span>
<a href="#l7.157"></a><span id="l7.157" class="difflineminus">-#define LDAP_FEATURE_INFO_VERSION	1</span>
<a href="#l7.158"></a><span id="l7.158" class="difflineplus">+#define LDAP_FEATURE_INFO_VERSION 1</span>
<a href="#l7.159"></a><span id="l7.159"> typedef struct ldap_apifeature_info {</span>
<a href="#l7.160"></a><span id="l7.160" class="difflineminus">-    int   ldapaif_info_version;	/* version of this struct (1) */</span>
<a href="#l7.161"></a><span id="l7.161" class="difflineminus">-    char  *ldapaif_name;	/* name of supported feature */</span>
<a href="#l7.162"></a><span id="l7.162" class="difflineminus">-    int   ldapaif_version;	/* revision of supported feature */</span>
<a href="#l7.163"></a><span id="l7.163" class="difflineplus">+    int   ldapaif_info_version;  /* version of this struct (1) */</span>
<a href="#l7.164"></a><span id="l7.164" class="difflineplus">+    char  *ldapaif_name;  /* name of supported feature */</span>
<a href="#l7.165"></a><span id="l7.165" class="difflineplus">+    int   ldapaif_version;  /* revision of supported feature */</span>
<a href="#l7.166"></a><span id="l7.166"> } LDAPAPIFeatureInfo;</span>
<a href="#l7.167"></a><span id="l7.167"> </span>
<a href="#l7.168"></a><span id="l7.168"> </span>
<a href="#l7.169"></a><span id="l7.169"> /* possible result types a server can return */</span>
<a href="#l7.170"></a><span id="l7.170" class="difflineminus">-#define LDAP_RES_BIND                   0x61L	/* 97 */</span>
<a href="#l7.171"></a><span id="l7.171" class="difflineminus">-#define LDAP_RES_SEARCH_ENTRY           0x64L	/* 100 */</span>
<a href="#l7.172"></a><span id="l7.172" class="difflineminus">-#define LDAP_RES_SEARCH_RESULT          0x65L	/* 101 */</span>
<a href="#l7.173"></a><span id="l7.173" class="difflineminus">-#define LDAP_RES_MODIFY                 0x67L	/* 103 */</span>
<a href="#l7.174"></a><span id="l7.174" class="difflineminus">-#define LDAP_RES_ADD                    0x69L	/* 105 */</span>
<a href="#l7.175"></a><span id="l7.175" class="difflineminus">-#define LDAP_RES_DELETE                 0x6BL	/* 107 */</span>
<a href="#l7.176"></a><span id="l7.176" class="difflineminus">-#define LDAP_RES_MODDN			0x6DL	/* 109 */</span>
<a href="#l7.177"></a><span id="l7.177" class="difflineminus">-#define LDAP_RES_COMPARE                0x6FL	/* 111 */</span>
<a href="#l7.178"></a><span id="l7.178" class="difflineminus">-#define LDAP_RES_SEARCH_REFERENCE       0x73L	/* 115 */</span>
<a href="#l7.179"></a><span id="l7.179" class="difflineminus">-#define LDAP_RES_EXTENDED               0x78L	/* 120 */</span>
<a href="#l7.180"></a><span id="l7.180" class="difflineplus">+#define LDAP_RES_BIND             0x61L  /* 97 */</span>
<a href="#l7.181"></a><span id="l7.181" class="difflineplus">+#define LDAP_RES_SEARCH_ENTRY     0x64L  /* 100 */</span>
<a href="#l7.182"></a><span id="l7.182" class="difflineplus">+#define LDAP_RES_SEARCH_RESULT    0x65L  /* 101 */</span>
<a href="#l7.183"></a><span id="l7.183" class="difflineplus">+#define LDAP_RES_MODIFY           0x67L  /* 103 */</span>
<a href="#l7.184"></a><span id="l7.184" class="difflineplus">+#define LDAP_RES_ADD              0x69L  /* 105 */</span>
<a href="#l7.185"></a><span id="l7.185" class="difflineplus">+#define LDAP_RES_DELETE           0x6BL  /* 107 */</span>
<a href="#l7.186"></a><span id="l7.186" class="difflineplus">+#define LDAP_RES_MODDN            0x6DL  /* 109 */</span>
<a href="#l7.187"></a><span id="l7.187" class="difflineplus">+#define LDAP_RES_COMPARE          0x6FL  /* 111 */</span>
<a href="#l7.188"></a><span id="l7.188" class="difflineplus">+#define LDAP_RES_SEARCH_REFERENCE 0x73L  /* 115 */</span>
<a href="#l7.189"></a><span id="l7.189" class="difflineplus">+#define LDAP_RES_EXTENDED         0x78L  /* 120 */</span>
<a href="#l7.190"></a><span id="l7.190"> </span>
<a href="#l7.191"></a><span id="l7.191"> /* Special values for ldap_result() &quot;msgid&quot; parameter */</span>
<a href="#l7.192"></a><span id="l7.192"> #define LDAP_RES_ANY                (-1)</span>
<a href="#l7.193"></a><span id="l7.193" class="difflineminus">-#define LDAP_RES_UNSOLICITED		0</span>
<a href="#l7.194"></a><span id="l7.194" class="difflineplus">+#define LDAP_RES_UNSOLICITED 0</span>
<a href="#l7.195"></a><span id="l7.195"> </span>
<a href="#l7.196"></a><span id="l7.196"> /* built-in SASL methods */</span>
<a href="#l7.197"></a><span id="l7.197" class="difflineminus">-#define LDAP_SASL_SIMPLE	0	/* special value used for simple bind */</span>
<a href="#l7.198"></a><span id="l7.198" class="difflineplus">+#define LDAP_SASL_SIMPLE 0  /* special value used for simple bind */</span>
<a href="#l7.199"></a><span id="l7.199"> </span>
<a href="#l7.200"></a><span id="l7.200"> /* search scopes */</span>
<a href="#l7.201"></a><span id="l7.201" class="difflineminus">-#define LDAP_SCOPE_BASE         0x00</span>
<a href="#l7.202"></a><span id="l7.202" class="difflineminus">-#define LDAP_SCOPE_ONELEVEL     0x01</span>
<a href="#l7.203"></a><span id="l7.203" class="difflineminus">-#define LDAP_SCOPE_SUBTREE      0x02</span>
<a href="#l7.204"></a><span id="l7.204" class="difflineplus">+#define LDAP_SCOPE_BASE      0x00</span>
<a href="#l7.205"></a><span id="l7.205" class="difflineplus">+#define LDAP_SCOPE_ONELEVEL  0x01</span>
<a href="#l7.206"></a><span id="l7.206" class="difflineplus">+#define LDAP_SCOPE_SUBTREE   0x02</span>
<a href="#l7.207"></a><span id="l7.207"> </span>
<a href="#l7.208"></a><span id="l7.208"> /* alias dereferencing */</span>
<a href="#l7.209"></a><span id="l7.209" class="difflineminus">-#define LDAP_DEREF_NEVER        0x00</span>
<a href="#l7.210"></a><span id="l7.210" class="difflineminus">-#define LDAP_DEREF_SEARCHING    0x01</span>
<a href="#l7.211"></a><span id="l7.211" class="difflineminus">-#define LDAP_DEREF_FINDING      0x02</span>
<a href="#l7.212"></a><span id="l7.212" class="difflineminus">-#define LDAP_DEREF_ALWAYS       0x03</span>
<a href="#l7.213"></a><span id="l7.213" class="difflineplus">+#define LDAP_DEREF_NEVER     0x00</span>
<a href="#l7.214"></a><span id="l7.214" class="difflineplus">+#define LDAP_DEREF_SEARCHING 0x01</span>
<a href="#l7.215"></a><span id="l7.215" class="difflineplus">+#define LDAP_DEREF_FINDING   0x02</span>
<a href="#l7.216"></a><span id="l7.216" class="difflineplus">+#define LDAP_DEREF_ALWAYS    0x03</span>
<a href="#l7.217"></a><span id="l7.217"> </span>
<a href="#l7.218"></a><span id="l7.218"> /* predefined size/time limits */</span>
<a href="#l7.219"></a><span id="l7.219"> #define LDAP_NO_LIMIT           0</span>
<a href="#l7.220"></a><span id="l7.220"> </span>
<a href="#l7.221"></a><span id="l7.221"> /* allowed values for &quot;all&quot; ldap_result() parameter */</span>
<a href="#l7.222"></a><span id="l7.222" class="difflineminus">-#define LDAP_MSG_ONE		0x00</span>
<a href="#l7.223"></a><span id="l7.223" class="difflineminus">-#define LDAP_MSG_ALL		0x01</span>
<a href="#l7.224"></a><span id="l7.224" class="difflineminus">-#define LDAP_MSG_RECEIVED	0x02</span>
<a href="#l7.225"></a><span id="l7.225" class="difflineplus">+#define LDAP_MSG_ONE 0x00</span>
<a href="#l7.226"></a><span id="l7.226" class="difflineplus">+#define LDAP_MSG_ALL 0x01</span>
<a href="#l7.227"></a><span id="l7.227" class="difflineplus">+#define LDAP_MSG_RECEIVED 0x02</span>
<a href="#l7.228"></a><span id="l7.228"> </span>
<a href="#l7.229"></a><span id="l7.229"> /* possible error codes we can be returned */</span>
<a href="#l7.230"></a><span id="l7.230" class="difflineminus">-#define LDAP_SUCCESS                    0x00	/* 0 */</span>
<a href="#l7.231"></a><span id="l7.231" class="difflineminus">-#define LDAP_OPERATIONS_ERROR           0x01	/* 1 */</span>
<a href="#l7.232"></a><span id="l7.232" class="difflineminus">-#define LDAP_PROTOCOL_ERROR             0x02	/* 2 */</span>
<a href="#l7.233"></a><span id="l7.233" class="difflineminus">-#define LDAP_TIMELIMIT_EXCEEDED         0x03	/* 3 */</span>
<a href="#l7.234"></a><span id="l7.234" class="difflineminus">-#define LDAP_SIZELIMIT_EXCEEDED         0x04	/* 4 */</span>
<a href="#l7.235"></a><span id="l7.235" class="difflineminus">-#define LDAP_COMPARE_FALSE              0x05	/* 5 */</span>
<a href="#l7.236"></a><span id="l7.236" class="difflineminus">-#define LDAP_COMPARE_TRUE               0x06	/* 6 */</span>
<a href="#l7.237"></a><span id="l7.237" class="difflineminus">-#define LDAP_STRONG_AUTH_NOT_SUPPORTED  0x07	/* 7 */</span>
<a href="#l7.238"></a><span id="l7.238" class="difflineminus">-#define LDAP_STRONG_AUTH_REQUIRED       0x08	/* 8 */</span>
<a href="#l7.239"></a><span id="l7.239" class="difflineminus">-#define LDAP_REFERRAL                   0x0a	/* 10 - LDAPv3 */</span>
<a href="#l7.240"></a><span id="l7.240" class="difflineminus">-#define LDAP_ADMINLIMIT_EXCEEDED	0x0b	/* 11 - LDAPv3 */</span>
<a href="#l7.241"></a><span id="l7.241" class="difflineplus">+#define LDAP_SUCCESS                    0x00  /* 0 */</span>
<a href="#l7.242"></a><span id="l7.242" class="difflineplus">+#define LDAP_OPERATIONS_ERROR           0x01  /* 1 */</span>
<a href="#l7.243"></a><span id="l7.243" class="difflineplus">+#define LDAP_PROTOCOL_ERROR             0x02  /* 2 */</span>
<a href="#l7.244"></a><span id="l7.244" class="difflineplus">+#define LDAP_TIMELIMIT_EXCEEDED         0x03  /* 3 */</span>
<a href="#l7.245"></a><span id="l7.245" class="difflineplus">+#define LDAP_SIZELIMIT_EXCEEDED         0x04  /* 4 */</span>
<a href="#l7.246"></a><span id="l7.246" class="difflineplus">+#define LDAP_COMPARE_FALSE              0x05  /* 5 */</span>
<a href="#l7.247"></a><span id="l7.247" class="difflineplus">+#define LDAP_COMPARE_TRUE               0x06  /* 6 */</span>
<a href="#l7.248"></a><span id="l7.248" class="difflineplus">+#define LDAP_STRONG_AUTH_NOT_SUPPORTED  0x07  /* 7 */</span>
<a href="#l7.249"></a><span id="l7.249" class="difflineplus">+#define LDAP_STRONG_AUTH_REQUIRED       0x08  /* 8 */</span>
<a href="#l7.250"></a><span id="l7.250" class="difflineplus">+#define LDAP_REFERRAL                   0x0a  /* 10 - LDAPv3 */</span>
<a href="#l7.251"></a><span id="l7.251" class="difflineplus">+#define LDAP_ADMINLIMIT_EXCEEDED        0x0b  /* 11 - LDAPv3 */</span>
<a href="#l7.252"></a><span id="l7.252"> #define LDAP_UNAVAILABLE_CRITICAL_EXTENSION  0x0c /* 12 - LDAPv3 */</span>
<a href="#l7.253"></a><span id="l7.253" class="difflineminus">-#define LDAP_CONFIDENTIALITY_REQUIRED	0x0d	/* 13 */</span>
<a href="#l7.254"></a><span id="l7.254" class="difflineminus">-#define LDAP_SASL_BIND_IN_PROGRESS	0x0e	/* 14 - LDAPv3 */</span>
<a href="#l7.255"></a><span id="l7.255" class="difflineplus">+#define LDAP_CONFIDENTIALITY_REQUIRED   0x0d  /* 13 */</span>
<a href="#l7.256"></a><span id="l7.256" class="difflineplus">+#define LDAP_SASL_BIND_IN_PROGRESS      0x0e  /* 14 - LDAPv3 */</span>
<a href="#l7.257"></a><span id="l7.257"> </span>
<a href="#l7.258"></a><span id="l7.258" class="difflineminus">-#define LDAP_NO_SUCH_ATTRIBUTE          0x10	/* 16 */</span>
<a href="#l7.259"></a><span id="l7.259" class="difflineminus">-#define LDAP_UNDEFINED_TYPE             0x11	/* 17 */</span>
<a href="#l7.260"></a><span id="l7.260" class="difflineminus">-#define LDAP_INAPPROPRIATE_MATCHING     0x12	/* 18 */</span>
<a href="#l7.261"></a><span id="l7.261" class="difflineminus">-#define LDAP_CONSTRAINT_VIOLATION       0x13	/* 19 */</span>
<a href="#l7.262"></a><span id="l7.262" class="difflineminus">-#define LDAP_TYPE_OR_VALUE_EXISTS       0x14	/* 20 */</span>
<a href="#l7.263"></a><span id="l7.263" class="difflineminus">-#define LDAP_INVALID_SYNTAX             0x15	/* 21 */</span>
<a href="#l7.264"></a><span id="l7.264" class="difflineplus">+#define LDAP_NO_SUCH_ATTRIBUTE          0x10  /* 16 */</span>
<a href="#l7.265"></a><span id="l7.265" class="difflineplus">+#define LDAP_UNDEFINED_TYPE             0x11  /* 17 */</span>
<a href="#l7.266"></a><span id="l7.266" class="difflineplus">+#define LDAP_INAPPROPRIATE_MATCHING     0x12  /* 18 */</span>
<a href="#l7.267"></a><span id="l7.267" class="difflineplus">+#define LDAP_CONSTRAINT_VIOLATION       0x13  /* 19 */</span>
<a href="#l7.268"></a><span id="l7.268" class="difflineplus">+#define LDAP_TYPE_OR_VALUE_EXISTS       0x14  /* 20 */</span>
<a href="#l7.269"></a><span id="l7.269" class="difflineplus">+#define LDAP_INVALID_SYNTAX             0x15  /* 21 */</span>
<a href="#l7.270"></a><span id="l7.270"> </span>
<a href="#l7.271"></a><span id="l7.271" class="difflineminus">-#define LDAP_NO_SUCH_OBJECT             0x20	/* 32 */</span>
<a href="#l7.272"></a><span id="l7.272" class="difflineminus">-#define LDAP_ALIAS_PROBLEM              0x21	/* 33 */</span>
<a href="#l7.273"></a><span id="l7.273" class="difflineminus">-#define LDAP_INVALID_DN_SYNTAX          0x22	/* 34 */</span>
<a href="#l7.274"></a><span id="l7.274" class="difflineminus">-#define LDAP_IS_LEAF                    0x23	/* 35 (not used in LDAPv3) */</span>
<a href="#l7.275"></a><span id="l7.275" class="difflineminus">-#define LDAP_ALIAS_DEREF_PROBLEM        0x24	/* 36 */</span>
<a href="#l7.276"></a><span id="l7.276" class="difflineplus">+#define LDAP_NO_SUCH_OBJECT             0x20  /* 32 */</span>
<a href="#l7.277"></a><span id="l7.277" class="difflineplus">+#define LDAP_ALIAS_PROBLEM              0x21  /* 33 */</span>
<a href="#l7.278"></a><span id="l7.278" class="difflineplus">+#define LDAP_INVALID_DN_SYNTAX          0x22  /* 34 */</span>
<a href="#l7.279"></a><span id="l7.279" class="difflineplus">+#define LDAP_IS_LEAF                    0x23  /* 35 (not used in LDAPv3) */</span>
<a href="#l7.280"></a><span id="l7.280" class="difflineplus">+#define LDAP_ALIAS_DEREF_PROBLEM        0x24  /* 36 */</span>
<a href="#l7.281"></a><span id="l7.281"> </span>
<a href="#l7.282"></a><span id="l7.282" class="difflineminus">-#define LDAP_INAPPROPRIATE_AUTH         0x30	/* 48 */</span>
<a href="#l7.283"></a><span id="l7.283" class="difflineminus">-#define LDAP_INVALID_CREDENTIALS        0x31	/* 49 */</span>
<a href="#l7.284"></a><span id="l7.284" class="difflineminus">-#define LDAP_INSUFFICIENT_ACCESS        0x32	/* 50 */</span>
<a href="#l7.285"></a><span id="l7.285" class="difflineminus">-#define LDAP_BUSY                       0x33	/* 51 */</span>
<a href="#l7.286"></a><span id="l7.286" class="difflineminus">-#define LDAP_UNAVAILABLE                0x34	/* 52 */</span>
<a href="#l7.287"></a><span id="l7.287" class="difflineminus">-#define LDAP_UNWILLING_TO_PERFORM       0x35	/* 53 */</span>
<a href="#l7.288"></a><span id="l7.288" class="difflineminus">-#define LDAP_LOOP_DETECT                0x36	/* 54 */</span>
<a href="#l7.289"></a><span id="l7.289" class="difflineplus">+#define LDAP_INAPPROPRIATE_AUTH         0x30  /* 48 */</span>
<a href="#l7.290"></a><span id="l7.290" class="difflineplus">+#define LDAP_INVALID_CREDENTIALS        0x31  /* 49 */</span>
<a href="#l7.291"></a><span id="l7.291" class="difflineplus">+#define LDAP_INSUFFICIENT_ACCESS        0x32  /* 50 */</span>
<a href="#l7.292"></a><span id="l7.292" class="difflineplus">+#define LDAP_BUSY                       0x33  /* 51 */</span>
<a href="#l7.293"></a><span id="l7.293" class="difflineplus">+#define LDAP_UNAVAILABLE                0x34  /* 52 */</span>
<a href="#l7.294"></a><span id="l7.294" class="difflineplus">+#define LDAP_UNWILLING_TO_PERFORM       0x35  /* 53 */</span>
<a href="#l7.295"></a><span id="l7.295" class="difflineplus">+#define LDAP_LOOP_DETECT                0x36  /* 54 */</span>
<a href="#l7.296"></a><span id="l7.296"> </span>
<a href="#l7.297"></a><span id="l7.297" class="difflineminus">-#define LDAP_NAMING_VIOLATION           0x40	/* 64 */</span>
<a href="#l7.298"></a><span id="l7.298" class="difflineminus">-#define LDAP_OBJECT_CLASS_VIOLATION     0x41	/* 65 */</span>
<a href="#l7.299"></a><span id="l7.299" class="difflineminus">-#define LDAP_NOT_ALLOWED_ON_NONLEAF     0x42	/* 66 */</span>
<a href="#l7.300"></a><span id="l7.300" class="difflineminus">-#define LDAP_NOT_ALLOWED_ON_RDN         0x43	/* 67 */</span>
<a href="#l7.301"></a><span id="l7.301" class="difflineminus">-#define LDAP_ALREADY_EXISTS             0x44	/* 68 */</span>
<a href="#l7.302"></a><span id="l7.302" class="difflineminus">-#define LDAP_NO_OBJECT_CLASS_MODS       0x45	/* 69 */</span>
<a href="#l7.303"></a><span id="l7.303" class="difflineminus">-#define LDAP_RESULTS_TOO_LARGE          0x46	/* 70 - CLDAP */</span>
<a href="#l7.304"></a><span id="l7.304" class="difflineminus">-#define LDAP_AFFECTS_MULTIPLE_DSAS      0x47	/* 71 */</span>
<a href="#l7.305"></a><span id="l7.305" class="difflineplus">+#define LDAP_NAMING_VIOLATION           0x40  /* 64 */</span>
<a href="#l7.306"></a><span id="l7.306" class="difflineplus">+#define LDAP_OBJECT_CLASS_VIOLATION     0x41  /* 65 */</span>
<a href="#l7.307"></a><span id="l7.307" class="difflineplus">+#define LDAP_NOT_ALLOWED_ON_NONLEAF     0x42  /* 66 */</span>
<a href="#l7.308"></a><span id="l7.308" class="difflineplus">+#define LDAP_NOT_ALLOWED_ON_RDN         0x43  /* 67 */</span>
<a href="#l7.309"></a><span id="l7.309" class="difflineplus">+#define LDAP_ALREADY_EXISTS             0x44  /* 68 */</span>
<a href="#l7.310"></a><span id="l7.310" class="difflineplus">+#define LDAP_NO_OBJECT_CLASS_MODS       0x45  /* 69 */</span>
<a href="#l7.311"></a><span id="l7.311" class="difflineplus">+#define LDAP_RESULTS_TOO_LARGE          0x46  /* 70 - CLDAP */</span>
<a href="#l7.312"></a><span id="l7.312" class="difflineplus">+#define LDAP_AFFECTS_MULTIPLE_DSAS      0x47  /* 71 */</span>
<a href="#l7.313"></a><span id="l7.313"> </span>
<a href="#l7.314"></a><span id="l7.314" class="difflineminus">-#define LDAP_OTHER                      0x50	/* 80 */</span>
<a href="#l7.315"></a><span id="l7.315" class="difflineminus">-#define LDAP_SERVER_DOWN                0x51	/* 81 */</span>
<a href="#l7.316"></a><span id="l7.316" class="difflineminus">-#define LDAP_LOCAL_ERROR                0x52	/* 82 */</span>
<a href="#l7.317"></a><span id="l7.317" class="difflineminus">-#define LDAP_ENCODING_ERROR             0x53	/* 83 */</span>
<a href="#l7.318"></a><span id="l7.318" class="difflineminus">-#define LDAP_DECODING_ERROR             0x54	/* 84 */</span>
<a href="#l7.319"></a><span id="l7.319" class="difflineminus">-#define LDAP_TIMEOUT                    0x55	/* 85 */</span>
<a href="#l7.320"></a><span id="l7.320" class="difflineminus">-#define LDAP_AUTH_UNKNOWN               0x56	/* 86 */</span>
<a href="#l7.321"></a><span id="l7.321" class="difflineminus">-#define LDAP_FILTER_ERROR               0x57	/* 87 */</span>
<a href="#l7.322"></a><span id="l7.322" class="difflineminus">-#define LDAP_USER_CANCELLED             0x58	/* 88 */</span>
<a href="#l7.323"></a><span id="l7.323" class="difflineminus">-#define LDAP_PARAM_ERROR                0x59	/* 89 */</span>
<a href="#l7.324"></a><span id="l7.324" class="difflineminus">-#define LDAP_NO_MEMORY                  0x5a	/* 90 */</span>
<a href="#l7.325"></a><span id="l7.325" class="difflineminus">-#define LDAP_CONNECT_ERROR              0x5b	/* 91 */</span>
<a href="#l7.326"></a><span id="l7.326" class="difflineminus">-#define LDAP_NOT_SUPPORTED              0x5c	/* 92 - LDAPv3 */</span>
<a href="#l7.327"></a><span id="l7.327" class="difflineminus">-#define LDAP_CONTROL_NOT_FOUND		0x5d	/* 93 - LDAPv3 */</span>
<a href="#l7.328"></a><span id="l7.328" class="difflineminus">-#define LDAP_NO_RESULTS_RETURNED	0x5e	/* 94 - LDAPv3 */</span>
<a href="#l7.329"></a><span id="l7.329" class="difflineminus">-#define LDAP_MORE_RESULTS_TO_RETURN	0x5f	/* 95 - LDAPv3 */</span>
<a href="#l7.330"></a><span id="l7.330" class="difflineminus">-#define LDAP_CLIENT_LOOP		0x60	/* 96 - LDAPv3 */</span>
<a href="#l7.331"></a><span id="l7.331" class="difflineminus">-#define LDAP_REFERRAL_LIMIT_EXCEEDED	0x61	/* 97 - LDAPv3 */</span>
<a href="#l7.332"></a><span id="l7.332" class="difflineplus">+#define LDAP_OTHER                      0x50  /* 80 */</span>
<a href="#l7.333"></a><span id="l7.333" class="difflineplus">+#define LDAP_SERVER_DOWN                0x51  /* 81 */</span>
<a href="#l7.334"></a><span id="l7.334" class="difflineplus">+#define LDAP_LOCAL_ERROR                0x52  /* 82 */</span>
<a href="#l7.335"></a><span id="l7.335" class="difflineplus">+#define LDAP_ENCODING_ERROR             0x53  /* 83 */</span>
<a href="#l7.336"></a><span id="l7.336" class="difflineplus">+#define LDAP_DECODING_ERROR             0x54  /* 84 */</span>
<a href="#l7.337"></a><span id="l7.337" class="difflineplus">+#define LDAP_TIMEOUT                    0x55  /* 85 */</span>
<a href="#l7.338"></a><span id="l7.338" class="difflineplus">+#define LDAP_AUTH_UNKNOWN               0x56  /* 86 */</span>
<a href="#l7.339"></a><span id="l7.339" class="difflineplus">+#define LDAP_FILTER_ERROR               0x57  /* 87 */</span>
<a href="#l7.340"></a><span id="l7.340" class="difflineplus">+#define LDAP_USER_CANCELLED             0x58  /* 88 */</span>
<a href="#l7.341"></a><span id="l7.341" class="difflineplus">+#define LDAP_PARAM_ERROR                0x59  /* 89 */</span>
<a href="#l7.342"></a><span id="l7.342" class="difflineplus">+#define LDAP_NO_MEMORY                  0x5a  /* 90 */</span>
<a href="#l7.343"></a><span id="l7.343" class="difflineplus">+#define LDAP_CONNECT_ERROR              0x5b  /* 91 */</span>
<a href="#l7.344"></a><span id="l7.344" class="difflineplus">+#define LDAP_NOT_SUPPORTED              0x5c  /* 92 - LDAPv3 */</span>
<a href="#l7.345"></a><span id="l7.345" class="difflineplus">+#define LDAP_CONTROL_NOT_FOUND          0x5d  /* 93 - LDAPv3 */</span>
<a href="#l7.346"></a><span id="l7.346" class="difflineplus">+#define LDAP_NO_RESULTS_RETURNED        0x5e  /* 94 - LDAPv3 */</span>
<a href="#l7.347"></a><span id="l7.347" class="difflineplus">+#define LDAP_MORE_RESULTS_TO_RETURN     0x5f  /* 95 - LDAPv3 */</span>
<a href="#l7.348"></a><span id="l7.348" class="difflineplus">+#define LDAP_CLIENT_LOOP                0x60  /* 96 - LDAPv3 */</span>
<a href="#l7.349"></a><span id="l7.349" class="difflineplus">+#define LDAP_REFERRAL_LIMIT_EXCEEDED    0x61  /* 97 - LDAPv3 */</span>
<a href="#l7.350"></a><span id="l7.350"> </span>
<a href="#l7.351"></a><span id="l7.351"> /*</span>
<a href="#l7.352"></a><span id="l7.352">  * LDAPv3 unsolicited notification messages we know about</span>
<a href="#l7.353"></a><span id="l7.353">  */</span>
<a href="#l7.354"></a><span id="l7.354" class="difflineminus">-#define LDAP_NOTICE_OF_DISCONNECTION	&quot;1.3.6.1.4.1.1466.20036&quot;</span>
<a href="#l7.355"></a><span id="l7.355" class="difflineplus">+#define LDAP_NOTICE_OF_DISCONNECTION &quot;1.3.6.1.4.1.1466.20036&quot;</span>
<a href="#l7.356"></a><span id="l7.356"> </span>
<a href="#l7.357"></a><span id="l7.357"> /*</span>
<a href="#l7.358"></a><span id="l7.358">  * Client controls we know about</span>
<a href="#l7.359"></a><span id="l7.359">  */</span>
<a href="#l7.360"></a><span id="l7.360" class="difflineminus">-#define LDAP_CONTROL_REFERRALS		&quot;1.2.840.113556.1.4.616&quot;</span>
<a href="#l7.361"></a><span id="l7.361" class="difflineplus">+#define LDAP_CONTROL_REFERRALS &quot;1.2.840.113556.1.4.616&quot;</span>
<a href="#l7.362"></a><span id="l7.362"> </span>
<a href="#l7.363"></a><span id="l7.363"> /*</span>
<a href="#l7.364"></a><span id="l7.364">  * Initializing an ldap sesssion, set session handle options, and</span>
<a href="#l7.365"></a><span id="l7.365">  * closing an ldap session functions</span>
<a href="#l7.366"></a><span id="l7.366">  *</span>
<a href="#l7.367"></a><span id="l7.367">  * NOTE: If you want to use IPv6, you must use prldap creating a LDAP handle</span>
<a href="#l7.368"></a><span id="l7.368">  * with prldap_init instead of ldap_init. Or install the NSPR functions</span>
<a href="#l7.369"></a><span id="l7.369">  * by calling prldap_install_routines. (See the nspr samples in examples)</span>
<a href="#l7.370"></a><span id="l7.370">  */</span>
<a href="#l7.371"></a><span id="l7.371"> LDAP_API(LDAP *) LDAP_CALL ldap_init( const char *defhost, int defport );</span>
<a href="#l7.372"></a><span id="l7.372"> LDAP_API(int) LDAP_CALL ldap_set_option( LDAP *ld, int option,</span>
<a href="#l7.373"></a><span id="l7.373" class="difflineminus">-	const void *optdata );</span>
<a href="#l7.374"></a><span id="l7.374" class="difflineplus">+  const void *optdata );</span>
<a href="#l7.375"></a><span id="l7.375"> LDAP_API(int) LDAP_CALL ldap_get_option( LDAP *ld, int option, void *optdata );</span>
<a href="#l7.376"></a><span id="l7.376"> LDAP_API(int) LDAP_CALL ldap_unbind( LDAP *ld );</span>
<a href="#l7.377"></a><span id="l7.377"> LDAP_API(int) LDAP_CALL ldap_unbind_s( LDAP *ld );</span>
<a href="#l7.378"></a><span id="l7.378"> </span>
<a href="#l7.379"></a><span id="l7.379"> /*</span>
<a href="#l7.380"></a><span id="l7.380">  * perform ldap operations</span>
<a href="#l7.381"></a><span id="l7.381">  */</span>
<a href="#l7.382"></a><span id="l7.382"> LDAP_API(int) LDAP_CALL ldap_abandon( LDAP *ld, int msgid );</span>
<a href="#l7.383"></a><span id="l7.383"> LDAP_API(int) LDAP_CALL ldap_add( LDAP *ld, const char *dn, LDAPMod **attrs );</span>
<a href="#l7.384"></a><span id="l7.384"> LDAP_API(int) LDAP_CALL ldap_add_s( LDAP *ld, const char *dn, LDAPMod **attrs );</span>
<a href="#l7.385"></a><span id="l7.385"> LDAP_API(int) LDAP_CALL ldap_simple_bind( LDAP *ld, const char *who,</span>
<a href="#l7.386"></a><span id="l7.386" class="difflineminus">-	const char *passwd );</span>
<a href="#l7.387"></a><span id="l7.387" class="difflineplus">+  const char *passwd );</span>
<a href="#l7.388"></a><span id="l7.388"> LDAP_API(int) LDAP_CALL ldap_simple_bind_s( LDAP *ld, const char *who,</span>
<a href="#l7.389"></a><span id="l7.389" class="difflineminus">-	const char *passwd );</span>
<a href="#l7.390"></a><span id="l7.390" class="difflineplus">+  const char *passwd );</span>
<a href="#l7.391"></a><span id="l7.391"> LDAP_API(int) LDAP_CALL ldap_modify( LDAP *ld, const char *dn, LDAPMod **mods );</span>
<a href="#l7.392"></a><span id="l7.392"> LDAP_API(int) LDAP_CALL ldap_modify_s( LDAP *ld, const char *dn,</span>
<a href="#l7.393"></a><span id="l7.393" class="difflineminus">-	LDAPMod **mods );</span>
<a href="#l7.394"></a><span id="l7.394" class="difflineplus">+  LDAPMod **mods );</span>
<a href="#l7.395"></a><span id="l7.395"> LDAP_API(int) LDAP_CALL ldap_compare( LDAP *ld, const char *dn,</span>
<a href="#l7.396"></a><span id="l7.396" class="difflineminus">-	const char *attr, const char *value );</span>
<a href="#l7.397"></a><span id="l7.397" class="difflineplus">+  const char *attr, const char *value );</span>
<a href="#l7.398"></a><span id="l7.398"> LDAP_API(int) LDAP_CALL ldap_compare_s( LDAP *ld, const char *dn,</span>
<a href="#l7.399"></a><span id="l7.399" class="difflineminus">-	const char *attr, const char *value );</span>
<a href="#l7.400"></a><span id="l7.400" class="difflineplus">+  const char *attr, const char *value );</span>
<a href="#l7.401"></a><span id="l7.401"> LDAP_API(int) LDAP_CALL ldap_delete( LDAP *ld, const char *dn );</span>
<a href="#l7.402"></a><span id="l7.402"> LDAP_API(int) LDAP_CALL ldap_delete_s( LDAP *ld, const char *dn );</span>
<a href="#l7.403"></a><span id="l7.403"> LDAP_API(int) LDAP_CALL ldap_search( LDAP *ld, const char *base, int scope,</span>
<a href="#l7.404"></a><span id="l7.404" class="difflineminus">-	const char *filter, char **attrs, int attrsonly );</span>
<a href="#l7.405"></a><span id="l7.405" class="difflineplus">+  const char *filter, char **attrs, int attrsonly );</span>
<a href="#l7.406"></a><span id="l7.406"> LDAP_API(int) LDAP_CALL ldap_search_s( LDAP *ld, const char *base, int scope,</span>
<a href="#l7.407"></a><span id="l7.407" class="difflineminus">-	const char *filter, char **attrs, int attrsonly, LDAPMessage **res );</span>
<a href="#l7.408"></a><span id="l7.408" class="difflineplus">+  const char *filter, char **attrs, int attrsonly, LDAPMessage **res );</span>
<a href="#l7.409"></a><span id="l7.409"> LDAP_API(int) LDAP_CALL ldap_search_st( LDAP *ld, const char *base, int scope,</span>
<a href="#l7.410"></a><span id="l7.410" class="difflineminus">-	const char *filter, char **attrs, int attrsonly,</span>
<a href="#l7.411"></a><span id="l7.411" class="difflineminus">-	struct timeval *timeout, LDAPMessage **res );</span>
<a href="#l7.412"></a><span id="l7.412" class="difflineplus">+  const char *filter, char **attrs, int attrsonly,</span>
<a href="#l7.413"></a><span id="l7.413" class="difflineplus">+  struct timeval *timeout, LDAPMessage **res );</span>
<a href="#l7.414"></a><span id="l7.414"> </span>
<a href="#l7.415"></a><span id="l7.415"> /*</span>
<a href="#l7.416"></a><span id="l7.416">  * obtain result from ldap operation</span>
<a href="#l7.417"></a><span id="l7.417">  */</span>
<a href="#l7.418"></a><span id="l7.418"> LDAP_API(int) LDAP_CALL ldap_result( LDAP *ld, int msgid, int all,</span>
<a href="#l7.419"></a><span id="l7.419" class="difflineminus">-	struct timeval *timeout, LDAPMessage **result );</span>
<a href="#l7.420"></a><span id="l7.420" class="difflineplus">+  struct timeval *timeout, LDAPMessage **result );</span>
<a href="#l7.421"></a><span id="l7.421"> </span>
<a href="#l7.422"></a><span id="l7.422"> /*</span>
<a href="#l7.423"></a><span id="l7.423">  * peeking inside LDAP Messages and deallocating LDAP Messages</span>
<a href="#l7.424"></a><span id="l7.424">  */</span>
<a href="#l7.425"></a><span id="l7.425"> LDAP_API(int) LDAP_CALL ldap_msgfree( LDAPMessage *lm );</span>
<a href="#l7.426"></a><span id="l7.426"> LDAP_API(int) LDAP_CALL ldap_msgid( LDAPMessage *lm );</span>
<a href="#l7.427"></a><span id="l7.427"> LDAP_API(int) LDAP_CALL ldap_msgtype( LDAPMessage *lm );</span>
<a href="#l7.428"></a><span id="l7.428"> </span>
<a href="#l7.429"></a><span id="l7.429"> </span>
<a href="#l7.430"></a><span id="l7.430"> /*</span>
<a href="#l7.431"></a><span id="l7.431">  * Routines to parse/deal with results and errors returned</span>
<a href="#l7.432"></a><span id="l7.432">  */</span>
<a href="#l7.433"></a><span id="l7.433"> LDAP_API(char *) LDAP_CALL ldap_err2string( int err );</span>
<a href="#l7.434"></a><span id="l7.434"> LDAP_API(LDAPMessage *) LDAP_CALL ldap_first_entry( LDAP *ld,</span>
<a href="#l7.435"></a><span id="l7.435" class="difflineminus">-	LDAPMessage *chain );</span>
<a href="#l7.436"></a><span id="l7.436" class="difflineplus">+  LDAPMessage *chain );</span>
<a href="#l7.437"></a><span id="l7.437"> LDAP_API(LDAPMessage *) LDAP_CALL ldap_next_entry( LDAP *ld,</span>
<a href="#l7.438"></a><span id="l7.438" class="difflineminus">-	LDAPMessage *entry );</span>
<a href="#l7.439"></a><span id="l7.439" class="difflineplus">+  LDAPMessage *entry );</span>
<a href="#l7.440"></a><span id="l7.440"> LDAP_API(int) LDAP_CALL ldap_count_entries( LDAP *ld, LDAPMessage *chain );</span>
<a href="#l7.441"></a><span id="l7.441"> LDAP_API(char *) LDAP_CALL ldap_get_dn( LDAP *ld, LDAPMessage *entry );</span>
<a href="#l7.442"></a><span id="l7.442"> LDAP_API(char *) LDAP_CALL ldap_dn2ufn( const char *dn );</span>
<a href="#l7.443"></a><span id="l7.443"> LDAP_API(char **) LDAP_CALL ldap_explode_dn( const char *dn,</span>
<a href="#l7.444"></a><span id="l7.444" class="difflineminus">-	const int notypes );</span>
<a href="#l7.445"></a><span id="l7.445" class="difflineplus">+  const int notypes );</span>
<a href="#l7.446"></a><span id="l7.446"> LDAP_API(char **) LDAP_CALL ldap_explode_rdn( const char *rdn,</span>
<a href="#l7.447"></a><span id="l7.447" class="difflineminus">-	const int notypes );</span>
<a href="#l7.448"></a><span id="l7.448" class="difflineplus">+  const int notypes );</span>
<a href="#l7.449"></a><span id="l7.449"> LDAP_API(char *) LDAP_CALL ldap_first_attribute( LDAP *ld, LDAPMessage *entry,</span>
<a href="#l7.450"></a><span id="l7.450" class="difflineminus">-	BerElement **ber );</span>
<a href="#l7.451"></a><span id="l7.451" class="difflineplus">+  BerElement **ber );</span>
<a href="#l7.452"></a><span id="l7.452"> LDAP_API(char *) LDAP_CALL ldap_next_attribute( LDAP *ld, LDAPMessage *entry,</span>
<a href="#l7.453"></a><span id="l7.453" class="difflineminus">-	BerElement *ber );</span>
<a href="#l7.454"></a><span id="l7.454" class="difflineplus">+  BerElement *ber );</span>
<a href="#l7.455"></a><span id="l7.455"> LDAP_API(char **) LDAP_CALL ldap_get_values( LDAP *ld, LDAPMessage *entry,</span>
<a href="#l7.456"></a><span id="l7.456" class="difflineminus">-	const char *target );</span>
<a href="#l7.457"></a><span id="l7.457" class="difflineplus">+  const char *target );</span>
<a href="#l7.458"></a><span id="l7.458"> LDAP_API(struct berval **) LDAP_CALL ldap_get_values_len( LDAP *ld,</span>
<a href="#l7.459"></a><span id="l7.459" class="difflineminus">-	LDAPMessage *entry, const char *target );</span>
<a href="#l7.460"></a><span id="l7.460" class="difflineplus">+  LDAPMessage *entry, const char *target );</span>
<a href="#l7.461"></a><span id="l7.461"> LDAP_API(int) LDAP_CALL ldap_count_values( char **vals );</span>
<a href="#l7.462"></a><span id="l7.462"> LDAP_API(int) LDAP_CALL ldap_count_values_len( struct berval **vals );</span>
<a href="#l7.463"></a><span id="l7.463"> LDAP_API(void) LDAP_CALL ldap_value_free( char **vals );</span>
<a href="#l7.464"></a><span id="l7.464"> LDAP_API(void) LDAP_CALL ldap_value_free_len( struct berval **vals );</span>
<a href="#l7.465"></a><span id="l7.465"> LDAP_API(void) LDAP_CALL ldap_memfree( void *p );</span>
<a href="#l7.466"></a><span id="l7.466"> </span>
<a href="#l7.467"></a><span id="l7.467"> </span>
<a href="#l7.468"></a><span id="l7.468"> /*</span>
<a href="#l7.469"></a><span id="l7.469">  * LDAPv3 extended operation calls</span>
<a href="#l7.470"></a><span id="l7.470">  */</span>
<a href="#l7.471"></a><span id="l7.471"> /*</span>
<a href="#l7.472"></a><span id="l7.472">  * Note: all of the new asynchronous calls return an LDAP error code,</span>
<a href="#l7.473"></a><span id="l7.473">  * not a message id.  A message id is returned via the int *msgidp</span>
<a href="#l7.474"></a><span id="l7.474">  * parameter (usually the last parameter) if appropriate.</span>
<a href="#l7.475"></a><span id="l7.475">  */</span>
<a href="#l7.476"></a><span id="l7.476"> LDAP_API(int) LDAP_CALL ldap_abandon_ext( LDAP *ld, int msgid,</span>
<a href="#l7.477"></a><span id="l7.477" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls );</span>
<a href="#l7.478"></a><span id="l7.478" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls );</span>
<a href="#l7.479"></a><span id="l7.479"> LDAP_API(int) LDAP_CALL ldap_add_ext( LDAP *ld, const char *dn, LDAPMod **attrs,</span>
<a href="#l7.480"></a><span id="l7.480" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls, int *msgidp );</span>
<a href="#l7.481"></a><span id="l7.481" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls, int *msgidp );</span>
<a href="#l7.482"></a><span id="l7.482"> LDAP_API(int) LDAP_CALL ldap_add_ext_s( LDAP *ld, const char *dn,</span>
<a href="#l7.483"></a><span id="l7.483" class="difflineminus">-	LDAPMod **attrs, LDAPControl **serverctrls, LDAPControl **clientctrls );</span>
<a href="#l7.484"></a><span id="l7.484" class="difflineplus">+  LDAPMod **attrs, LDAPControl **serverctrls, LDAPControl **clientctrls );</span>
<a href="#l7.485"></a><span id="l7.485"> LDAP_API(int) LDAP_CALL ldap_sasl_bind( LDAP *ld, const char *dn,</span>
<a href="#l7.486"></a><span id="l7.486" class="difflineminus">-	const char *mechanism, const struct berval *cred,</span>
<a href="#l7.487"></a><span id="l7.487" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls, int *msgidp );</span>
<a href="#l7.488"></a><span id="l7.488" class="difflineplus">+  const char *mechanism, const struct berval *cred,</span>
<a href="#l7.489"></a><span id="l7.489" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls, int *msgidp );</span>
<a href="#l7.490"></a><span id="l7.490"> LDAP_API(int) LDAP_CALL ldap_sasl_bind_s( LDAP *ld, const char *dn,</span>
<a href="#l7.491"></a><span id="l7.491" class="difflineminus">-	const char *mechanism, const struct berval *cred,</span>
<a href="#l7.492"></a><span id="l7.492" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l7.493"></a><span id="l7.493" class="difflineminus">-	struct berval **servercredp );</span>
<a href="#l7.494"></a><span id="l7.494" class="difflineplus">+  const char *mechanism, const struct berval *cred,</span>
<a href="#l7.495"></a><span id="l7.495" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l7.496"></a><span id="l7.496" class="difflineplus">+  struct berval **servercredp );</span>
<a href="#l7.497"></a><span id="l7.497"> LDAP_API(int) LDAP_CALL ldap_modify_ext( LDAP *ld, const char *dn,</span>
<a href="#l7.498"></a><span id="l7.498" class="difflineminus">-	LDAPMod **mods, LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l7.499"></a><span id="l7.499" class="difflineminus">-	int *msgidp );</span>
<a href="#l7.500"></a><span id="l7.500" class="difflineplus">+  LDAPMod **mods, LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l7.501"></a><span id="l7.501" class="difflineplus">+  int *msgidp );</span>
<a href="#l7.502"></a><span id="l7.502"> LDAP_API(int) LDAP_CALL ldap_modify_ext_s( LDAP *ld, const char *dn,</span>
<a href="#l7.503"></a><span id="l7.503" class="difflineminus">-	LDAPMod **mods, LDAPControl **serverctrls, LDAPControl **clientctrls );</span>
<a href="#l7.504"></a><span id="l7.504" class="difflineplus">+  LDAPMod **mods, LDAPControl **serverctrls, LDAPControl **clientctrls );</span>
<a href="#l7.505"></a><span id="l7.505"> LDAP_API(int) LDAP_CALL ldap_rename( LDAP *ld, const char *dn,</span>
<a href="#l7.506"></a><span id="l7.506" class="difflineminus">-	const char *newrdn, const char *newparent, int deleteoldrdn,</span>
<a href="#l7.507"></a><span id="l7.507" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls, int *msgidp );</span>
<a href="#l7.508"></a><span id="l7.508" class="difflineplus">+  const char *newrdn, const char *newparent, int deleteoldrdn,</span>
<a href="#l7.509"></a><span id="l7.509" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls, int *msgidp );</span>
<a href="#l7.510"></a><span id="l7.510"> LDAP_API(int) LDAP_CALL ldap_rename_s( LDAP *ld, const char *dn,</span>
<a href="#l7.511"></a><span id="l7.511" class="difflineminus">-	const char *newrdn, const char *newparent, int deleteoldrdn,</span>
<a href="#l7.512"></a><span id="l7.512" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls );</span>
<a href="#l7.513"></a><span id="l7.513" class="difflineplus">+  const char *newrdn, const char *newparent, int deleteoldrdn,</span>
<a href="#l7.514"></a><span id="l7.514" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls );</span>
<a href="#l7.515"></a><span id="l7.515"> LDAP_API(int) LDAP_CALL ldap_compare_ext( LDAP *ld, const char *dn,</span>
<a href="#l7.516"></a><span id="l7.516" class="difflineminus">-	const char *attr, const struct berval *bvalue,</span>
<a href="#l7.517"></a><span id="l7.517" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls, int *msgidp );</span>
<a href="#l7.518"></a><span id="l7.518" class="difflineplus">+  const char *attr, const struct berval *bvalue,</span>
<a href="#l7.519"></a><span id="l7.519" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls, int *msgidp );</span>
<a href="#l7.520"></a><span id="l7.520"> LDAP_API(int) LDAP_CALL ldap_compare_ext_s( LDAP *ld, const char *dn,</span>
<a href="#l7.521"></a><span id="l7.521" class="difflineminus">-	const char *attr, const struct berval *bvalue,</span>
<a href="#l7.522"></a><span id="l7.522" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls );</span>
<a href="#l7.523"></a><span id="l7.523" class="difflineplus">+  const char *attr, const struct berval *bvalue,</span>
<a href="#l7.524"></a><span id="l7.524" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls );</span>
<a href="#l7.525"></a><span id="l7.525"> LDAP_API(int) LDAP_CALL ldap_delete_ext( LDAP *ld, const char *dn,</span>
<a href="#l7.526"></a><span id="l7.526" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls, int *msgidp );</span>
<a href="#l7.527"></a><span id="l7.527" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls, int *msgidp );</span>
<a href="#l7.528"></a><span id="l7.528"> LDAP_API(int) LDAP_CALL ldap_delete_ext_s( LDAP *ld, const char *dn,</span>
<a href="#l7.529"></a><span id="l7.529" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls );</span>
<a href="#l7.530"></a><span id="l7.530" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls );</span>
<a href="#l7.531"></a><span id="l7.531"> LDAP_API(int) LDAP_CALL ldap_search_ext( LDAP *ld, const char *base,</span>
<a href="#l7.532"></a><span id="l7.532" class="difflineminus">-	int scope, const char *filter, char **attrs, int attrsonly,</span>
<a href="#l7.533"></a><span id="l7.533" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l7.534"></a><span id="l7.534" class="difflineminus">-	struct timeval *timeoutp, int sizelimit, int *msgidp );</span>
<a href="#l7.535"></a><span id="l7.535" class="difflineplus">+  int scope, const char *filter, char **attrs, int attrsonly,</span>
<a href="#l7.536"></a><span id="l7.536" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l7.537"></a><span id="l7.537" class="difflineplus">+  struct timeval *timeoutp, int sizelimit, int *msgidp );</span>
<a href="#l7.538"></a><span id="l7.538"> LDAP_API(int) LDAP_CALL ldap_search_ext_s( LDAP *ld, const char *base,</span>
<a href="#l7.539"></a><span id="l7.539" class="difflineminus">-	int scope, const char *filter, char **attrs, int attrsonly,</span>
<a href="#l7.540"></a><span id="l7.540" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l7.541"></a><span id="l7.541" class="difflineminus">-	struct timeval *timeoutp, int sizelimit, LDAPMessage **res );</span>
<a href="#l7.542"></a><span id="l7.542" class="difflineplus">+  int scope, const char *filter, char **attrs, int attrsonly,</span>
<a href="#l7.543"></a><span id="l7.543" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l7.544"></a><span id="l7.544" class="difflineplus">+  struct timeval *timeoutp, int sizelimit, LDAPMessage **res );</span>
<a href="#l7.545"></a><span id="l7.545"> LDAP_API(int) LDAP_CALL ldap_extended_operation( LDAP *ld,</span>
<a href="#l7.546"></a><span id="l7.546" class="difflineminus">-	const char *requestoid, const struct berval *requestdata,</span>
<a href="#l7.547"></a><span id="l7.547" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls, int *msgidp );</span>
<a href="#l7.548"></a><span id="l7.548" class="difflineplus">+  const char *requestoid, const struct berval *requestdata,</span>
<a href="#l7.549"></a><span id="l7.549" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls, int *msgidp );</span>
<a href="#l7.550"></a><span id="l7.550"> LDAP_API(int) LDAP_CALL ldap_extended_operation_s( LDAP *ld,</span>
<a href="#l7.551"></a><span id="l7.551" class="difflineminus">-	const char *requestoid, const struct berval *requestdata,</span>
<a href="#l7.552"></a><span id="l7.552" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l7.553"></a><span id="l7.553" class="difflineminus">-	char **retoidp, struct berval **retdatap );</span>
<a href="#l7.554"></a><span id="l7.554" class="difflineplus">+  const char *requestoid, const struct berval *requestdata,</span>
<a href="#l7.555"></a><span id="l7.555" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l7.556"></a><span id="l7.556" class="difflineplus">+  char **retoidp, struct berval **retdatap );</span>
<a href="#l7.557"></a><span id="l7.557"> LDAP_API(int) LDAP_CALL ldap_unbind_ext( LDAP *ld, LDAPControl **serverctrls,</span>
<a href="#l7.558"></a><span id="l7.558" class="difflineminus">-	LDAPControl **clientctrls );</span>
<a href="#l7.559"></a><span id="l7.559" class="difflineplus">+  LDAPControl **clientctrls );</span>
<a href="#l7.560"></a><span id="l7.560"> </span>
<a href="#l7.561"></a><span id="l7.561"> </span>
<a href="#l7.562"></a><span id="l7.562"> /*</span>
<a href="#l7.563"></a><span id="l7.563">  * LDAPv3 extended parsing / result handling calls</span>
<a href="#l7.564"></a><span id="l7.564">  */</span>
<a href="#l7.565"></a><span id="l7.565"> LDAP_API(int) LDAP_CALL ldap_parse_sasl_bind_result( LDAP *ld,</span>
<a href="#l7.566"></a><span id="l7.566" class="difflineminus">-	LDAPMessage *res, struct berval **servercredp, int freeit );</span>
<a href="#l7.567"></a><span id="l7.567" class="difflineplus">+  LDAPMessage *res, struct berval **servercredp, int freeit );</span>
<a href="#l7.568"></a><span id="l7.568"> LDAP_API(int) LDAP_CALL ldap_parse_result( LDAP *ld, LDAPMessage *res,</span>
<a href="#l7.569"></a><span id="l7.569" class="difflineminus">-	int *errcodep, char **matcheddnp, char **errmsgp, char ***referralsp,</span>
<a href="#l7.570"></a><span id="l7.570" class="difflineminus">-	LDAPControl ***serverctrlsp, int freeit );</span>
<a href="#l7.571"></a><span id="l7.571" class="difflineplus">+  int *errcodep, char **matcheddnp, char **errmsgp, char ***referralsp,</span>
<a href="#l7.572"></a><span id="l7.572" class="difflineplus">+  LDAPControl ***serverctrlsp, int freeit );</span>
<a href="#l7.573"></a><span id="l7.573"> LDAP_API(int) LDAP_CALL ldap_parse_extended_result( LDAP *ld, LDAPMessage *res,</span>
<a href="#l7.574"></a><span id="l7.574" class="difflineminus">-	char **retoidp, struct berval **retdatap, int freeit );</span>
<a href="#l7.575"></a><span id="l7.575" class="difflineplus">+  char **retoidp, struct berval **retdatap, int freeit );</span>
<a href="#l7.576"></a><span id="l7.576"> LDAP_API(LDAPMessage *) LDAP_CALL ldap_first_message( LDAP *ld,</span>
<a href="#l7.577"></a><span id="l7.577" class="difflineminus">-	LDAPMessage *res );</span>
<a href="#l7.578"></a><span id="l7.578" class="difflineminus">-LDAP_API(LDAPMessage *) LDAP_CALL ldap_next_message( LDAP *ld,	</span>
<a href="#l7.579"></a><span id="l7.579" class="difflineminus">-	LDAPMessage *msg );</span>
<a href="#l7.580"></a><span id="l7.580" class="difflineplus">+  LDAPMessage *res );</span>
<a href="#l7.581"></a><span id="l7.581" class="difflineplus">+LDAP_API(LDAPMessage *) LDAP_CALL ldap_next_message( LDAP *ld,</span>
<a href="#l7.582"></a><span id="l7.582" class="difflineplus">+  LDAPMessage *msg );</span>
<a href="#l7.583"></a><span id="l7.583"> LDAP_API(int) LDAP_CALL ldap_count_messages( LDAP *ld, LDAPMessage *res );</span>
<a href="#l7.584"></a><span id="l7.584"> LDAP_API(LDAPMessage *) LDAP_CALL ldap_first_reference( LDAP *ld,</span>
<a href="#l7.585"></a><span id="l7.585" class="difflineminus">-	LDAPMessage *res );</span>
<a href="#l7.586"></a><span id="l7.586" class="difflineplus">+  LDAPMessage *res );</span>
<a href="#l7.587"></a><span id="l7.587"> LDAP_API(LDAPMessage *) LDAP_CALL ldap_next_reference( LDAP *ld,</span>
<a href="#l7.588"></a><span id="l7.588" class="difflineminus">-	LDAPMessage *ref );</span>
<a href="#l7.589"></a><span id="l7.589" class="difflineplus">+  LDAPMessage *ref );</span>
<a href="#l7.590"></a><span id="l7.590"> LDAP_API(int) LDAP_CALL ldap_count_references( LDAP *ld, LDAPMessage *res );</span>
<a href="#l7.591"></a><span id="l7.591"> LDAP_API(int) LDAP_CALL ldap_parse_reference( LDAP *ld, LDAPMessage *ref,</span>
<a href="#l7.592"></a><span id="l7.592" class="difflineminus">-	char ***referralsp, LDAPControl ***serverctrlsp, int freeit );</span>
<a href="#l7.593"></a><span id="l7.593" class="difflineplus">+  char ***referralsp, LDAPControl ***serverctrlsp, int freeit );</span>
<a href="#l7.594"></a><span id="l7.594"> LDAP_API(int) LDAP_CALL ldap_get_entry_controls( LDAP *ld, LDAPMessage *entry,</span>
<a href="#l7.595"></a><span id="l7.595" class="difflineminus">-	LDAPControl ***serverctrlsp );</span>
<a href="#l7.596"></a><span id="l7.596" class="difflineplus">+  LDAPControl ***serverctrlsp );</span>
<a href="#l7.597"></a><span id="l7.597"> LDAP_API(void) LDAP_CALL ldap_control_free( LDAPControl *ctrl );</span>
<a href="#l7.598"></a><span id="l7.598"> LDAP_API(void) LDAP_CALL ldap_controls_free( LDAPControl **ctrls );</span>
<a href="#l7.599"></a><span id="l7.599"> </span>
<a href="#l7.600"></a><span id="l7.600"> #ifdef __cplusplus</span>
<a href="#l7.601"></a><span id="l7.601"> }</span>
<a href="#l7.602"></a><span id="l7.602"> #endif</span>
<a href="#l7.603"></a><span id="l7.603"> #endif /* _LDAP_STANDARD_H */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/ldap/c-sdk/include/ldap-to-be-deprecated.h</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/ldap/c-sdk/include/ldap-to-be-deprecated.h</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -57,48 +57,48 @@</span>
<a href="#l8.4"></a><span id="l8.4"> extern &quot;C&quot; {</span>
<a href="#l8.5"></a><span id="l8.5"> #endif</span>
<a href="#l8.6"></a><span id="l8.6"> </span>
<a href="#l8.7"></a><span id="l8.7"> /*</span>
<a href="#l8.8"></a><span id="l8.8">  * I/O function callbacks option (an API extension --</span>
<a href="#l8.9"></a><span id="l8.9">  * LDAP_API_FEATURE_X_IO_FUNCTIONS).</span>
<a href="#l8.10"></a><span id="l8.10">  * Use of the extended I/O functions instead is recommended</span>
<a href="#l8.11"></a><span id="l8.11">  */</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-#define LDAP_OPT_IO_FN_PTRS		0x0B	/* 11 - API extension */</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+#define LDAP_OPT_IO_FN_PTRS 0x0B  /* 11 - API extension */</span>
<a href="#l8.14"></a><span id="l8.14"> </span>
<a href="#l8.15"></a><span id="l8.15"> /*</span>
<a href="#l8.16"></a><span id="l8.16">  * I/O callback functions (note that types for the read and write callbacks</span>
<a href="#l8.17"></a><span id="l8.17">  * are actually in lber.h):</span>
<a href="#l8.18"></a><span id="l8.18">  */</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineminus">-typedef int	(LDAP_C LDAP_CALLBACK LDAP_IOF_SELECT_CALLBACK)( int nfds,</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineminus">-	fd_set *readfds, fd_set *writefds, fd_set *errorfds,</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineminus">-	struct timeval *timeout );</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineplus">+typedef int (LDAP_C LDAP_CALLBACK LDAP_IOF_SELECT_CALLBACK)( int nfds,</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineplus">+  fd_set *readfds, fd_set *writefds, fd_set *errorfds,</span>
<a href="#l8.24"></a><span id="l8.24" class="difflineplus">+  struct timeval *timeout );</span>
<a href="#l8.25"></a><span id="l8.25"> typedef LBER_SOCKET (LDAP_C LDAP_CALLBACK LDAP_IOF_SOCKET_CALLBACK)(</span>
<a href="#l8.26"></a><span id="l8.26" class="difflineminus">-	int domain, int type, int protocol );</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineminus">-typedef int	(LDAP_C LDAP_CALLBACK LDAP_IOF_IOCTL_CALLBACK)( LBER_SOCKET s,</span>
<a href="#l8.28"></a><span id="l8.28" class="difflineminus">-	int option, ... );</span>
<a href="#l8.29"></a><span id="l8.29" class="difflineminus">-typedef int	(LDAP_C LDAP_CALLBACK LDAP_IOF_CONNECT_CALLBACK )(</span>
<a href="#l8.30"></a><span id="l8.30" class="difflineminus">-	LBER_SOCKET s, struct sockaddr *name, int namelen );</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineminus">-typedef int	(LDAP_C LDAP_CALLBACK LDAP_IOF_CLOSE_CALLBACK )(</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineminus">-	LBER_SOCKET s );</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineminus">-typedef int	(LDAP_C LDAP_CALLBACK LDAP_IOF_SSL_ENABLE_CALLBACK )(</span>
<a href="#l8.34"></a><span id="l8.34" class="difflineminus">-	LBER_SOCKET s );</span>
<a href="#l8.35"></a><span id="l8.35" class="difflineplus">+  int domain, int type, int protocol );</span>
<a href="#l8.36"></a><span id="l8.36" class="difflineplus">+typedef int (LDAP_C LDAP_CALLBACK LDAP_IOF_IOCTL_CALLBACK)( LBER_SOCKET s,</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineplus">+  int option, ... );</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineplus">+typedef int (LDAP_C LDAP_CALLBACK LDAP_IOF_CONNECT_CALLBACK )(</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineplus">+  LBER_SOCKET s, struct sockaddr *name, int namelen );</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineplus">+typedef int (LDAP_C LDAP_CALLBACK LDAP_IOF_CLOSE_CALLBACK )(</span>
<a href="#l8.41"></a><span id="l8.41" class="difflineplus">+  LBER_SOCKET s );</span>
<a href="#l8.42"></a><span id="l8.42" class="difflineplus">+typedef int (LDAP_C LDAP_CALLBACK LDAP_IOF_SSL_ENABLE_CALLBACK )(</span>
<a href="#l8.43"></a><span id="l8.43" class="difflineplus">+  LBER_SOCKET s );</span>
<a href="#l8.44"></a><span id="l8.44"> </span>
<a href="#l8.45"></a><span id="l8.45"> /*</span>
<a href="#l8.46"></a><span id="l8.46">  * Structure to hold I/O function pointers:</span>
<a href="#l8.47"></a><span id="l8.47">  */</span>
<a href="#l8.48"></a><span id="l8.48"> struct ldap_io_fns {</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineminus">-	LDAP_IOF_READ_CALLBACK *liof_read;</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineminus">-	LDAP_IOF_WRITE_CALLBACK *liof_write;</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineminus">-	LDAP_IOF_SELECT_CALLBACK *liof_select;</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineminus">-	LDAP_IOF_SOCKET_CALLBACK *liof_socket;</span>
<a href="#l8.53"></a><span id="l8.53" class="difflineminus">-	LDAP_IOF_IOCTL_CALLBACK *liof_ioctl;</span>
<a href="#l8.54"></a><span id="l8.54" class="difflineminus">-	LDAP_IOF_CONNECT_CALLBACK *liof_connect;</span>
<a href="#l8.55"></a><span id="l8.55" class="difflineminus">-	LDAP_IOF_CLOSE_CALLBACK *liof_close;</span>
<a href="#l8.56"></a><span id="l8.56" class="difflineminus">-	LDAP_IOF_SSL_ENABLE_CALLBACK *liof_ssl_enable;</span>
<a href="#l8.57"></a><span id="l8.57" class="difflineplus">+  LDAP_IOF_READ_CALLBACK *liof_read;</span>
<a href="#l8.58"></a><span id="l8.58" class="difflineplus">+  LDAP_IOF_WRITE_CALLBACK *liof_write;</span>
<a href="#l8.59"></a><span id="l8.59" class="difflineplus">+  LDAP_IOF_SELECT_CALLBACK *liof_select;</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineplus">+  LDAP_IOF_SOCKET_CALLBACK *liof_socket;</span>
<a href="#l8.61"></a><span id="l8.61" class="difflineplus">+  LDAP_IOF_IOCTL_CALLBACK *liof_ioctl;</span>
<a href="#l8.62"></a><span id="l8.62" class="difflineplus">+  LDAP_IOF_CONNECT_CALLBACK *liof_connect;</span>
<a href="#l8.63"></a><span id="l8.63" class="difflineplus">+  LDAP_IOF_CLOSE_CALLBACK *liof_close;</span>
<a href="#l8.64"></a><span id="l8.64" class="difflineplus">+  LDAP_IOF_SSL_ENABLE_CALLBACK *liof_ssl_enable;</span>
<a href="#l8.65"></a><span id="l8.65"> };</span>
<a href="#l8.66"></a><span id="l8.66"> </span>
<a href="#l8.67"></a><span id="l8.67"> /*</span>
<a href="#l8.68"></a><span id="l8.68">  * DNS resolver callbacks (an API extension --LDAP_API_FEATURE_X_DNS_FUNCTIONS).</span>
<a href="#l8.69"></a><span id="l8.69">  * Note that gethostbyaddr() is not currently used.</span>
<a href="#l8.70"></a><span id="l8.70">  */</span>
<a href="#l8.71"></a><span id="l8.71"> #define LDAP_OPT_DNS_FN_PTRS            0x60    /* 96 - API extension */</span>
<a href="#l8.72"></a><span id="l8.72"> </span>
<a href="#l8.73"></a><span id="l8.73" class="difflineat">@@ -119,17 +119,17 @@ typedef LDAPHostEnt * (LDAP_C LDAP_CALLB</span>
<a href="#l8.74"></a><span id="l8.74"> typedef int (LDAP_C LDAP_CALLBACK LDAP_DNSFN_GETPEERNAME)(</span>
<a href="#l8.75"></a><span id="l8.75">         LDAP *ld, struct sockaddr *netaddr, char *buffer, int buflen);</span>
<a href="#l8.76"></a><span id="l8.76"> </span>
<a href="#l8.77"></a><span id="l8.77"> struct ldap_dns_fns {</span>
<a href="#l8.78"></a><span id="l8.78">         void                            *lddnsfn_extradata;</span>
<a href="#l8.79"></a><span id="l8.79">         int                             lddnsfn_bufsize;</span>
<a href="#l8.80"></a><span id="l8.80">         LDAP_DNSFN_GETHOSTBYNAME        *lddnsfn_gethostbyname;</span>
<a href="#l8.81"></a><span id="l8.81">         LDAP_DNSFN_GETHOSTBYADDR        *lddnsfn_gethostbyaddr;</span>
<a href="#l8.82"></a><span id="l8.82" class="difflineminus">-	LDAP_DNSFN_GETPEERNAME          *lddnsfn_getpeername;</span>
<a href="#l8.83"></a><span id="l8.83" class="difflineplus">+        LDAP_DNSFN_GETPEERNAME          *lddnsfn_getpeername;</span>
<a href="#l8.84"></a><span id="l8.84"> };</span>
<a href="#l8.85"></a><span id="l8.85"> </span>
<a href="#l8.86"></a><span id="l8.86"> /*</span>
<a href="#l8.87"></a><span id="l8.87">  * experimental DN format support</span>
<a href="#l8.88"></a><span id="l8.88">  */</span>
<a href="#l8.89"></a><span id="l8.89"> LDAP_API(char **) LDAP_CALL ldap_explode_dns( const char *dn );</span>
<a href="#l8.90"></a><span id="l8.90"> LDAP_API(int) LDAP_CALL ldap_is_dns_dn( const char *dn );</span>
<a href="#l8.91"></a><span id="l8.91"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/ldap/c-sdk/include/ldap_ssl.h</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/ldap/c-sdk/include/ldap_ssl.h</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -52,37 +52,37 @@ extern &quot;C&quot; {</span>
<a href="#l9.4"></a><span id="l9.4"> #define LDAPSSL_AUTH_WEAK       0</span>
<a href="#l9.5"></a><span id="l9.5"> #define LDAPSSL_AUTH_CERT       1</span>
<a href="#l9.6"></a><span id="l9.6"> #define LDAPSSL_AUTH_CNCHECK    2</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8"> /*</span>
<a href="#l9.9"></a><span id="l9.9">  * an ExtendedRequest [LDAPv3] specifying the OID for the</span>
<a href="#l9.10"></a><span id="l9.10">  * Start TLS operation: RFC 2830</span>
<a href="#l9.11"></a><span id="l9.11">  */</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-#define LDAP_EXOP_START_TLS			&quot;1.3.6.1.4.1.1466.20037&quot;</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+#define LDAP_EXOP_START_TLS &quot;1.3.6.1.4.1.1466.20037&quot;</span>
<a href="#l9.14"></a><span id="l9.14"> </span>
<a href="#l9.15"></a><span id="l9.15"> /*</span>
<a href="#l9.16"></a><span id="l9.16">  * Initialize LDAP library for SSL</span>
<a href="#l9.17"></a><span id="l9.17">  */</span>
<a href="#l9.18"></a><span id="l9.18"> LDAP * LDAP_CALL ldapssl_init( const char *defhost, int defport,</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineminus">-	int defsecure );</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineplus">+  int defsecure );</span>
<a href="#l9.21"></a><span id="l9.21"> </span>
<a href="#l9.22"></a><span id="l9.22"> /*</span>
<a href="#l9.23"></a><span id="l9.23">  * Shutdown LDAP library for SSL :</span>
<a href="#l9.24"></a><span id="l9.24">  * Perform necessary cleanup and attempt to shutdown NSS. All existing</span>
<a href="#l9.25"></a><span id="l9.25">  * ld session handles should be ldap_unbind(ld) prior to calling this.</span>
<a href="#l9.26"></a><span id="l9.26" class="difflineminus">- */	</span>
<a href="#l9.27"></a><span id="l9.27" class="difflineplus">+ */</span>
<a href="#l9.28"></a><span id="l9.28"> int LDAP_CALL ldapssl_shutdown();</span>
<a href="#l9.29"></a><span id="l9.29"> </span>
<a href="#l9.30"></a><span id="l9.30"> /* Initialize LDAP library for TLS(SSL) and sends StartTLS extended</span>
<a href="#l9.31"></a><span id="l9.31">  * operation to the Directory Server.</span>
<a href="#l9.32"></a><span id="l9.32">  * Returns LDAP_SUCCESS if all goes well.</span>
<a href="#l9.33"></a><span id="l9.33">  */</span>
<a href="#l9.34"></a><span id="l9.34"> int LDAP_CALL ldap_start_tls_s( LDAP *ld, LDAPControl **serverctrls,</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineminus">- 					  LDAPControl **clientctrls );</span>
<a href="#l9.36"></a><span id="l9.36" class="difflineplus">+                                LDAPControl **clientctrls );</span>
<a href="#l9.37"></a><span id="l9.37"> /*</span>
<a href="#l9.38"></a><span id="l9.38">  * Install I/O routines to make SSL over LDAP possible.</span>
<a href="#l9.39"></a><span id="l9.39">  * Use this after ldap_init() or just use ldapssl_init() instead.</span>
<a href="#l9.40"></a><span id="l9.40">  * Returns 0 if all goes well.</span>
<a href="#l9.41"></a><span id="l9.41">  */</span>
<a href="#l9.42"></a><span id="l9.42"> int LDAP_CALL ldapssl_install_routines( LDAP *ld );</span>
<a href="#l9.43"></a><span id="l9.43"> </span>
<a href="#l9.44"></a><span id="l9.44"> </span>
<a href="#l9.45"></a><span id="l9.45" class="difflineat">@@ -143,22 +143,22 @@ int LDAP_CALL ldapssl_client_init(</span>
<a href="#l9.46"></a><span id="l9.46">  *                         certificate only if you trust the CA who</span>
<a href="#l9.47"></a><span id="l9.47">  *                         issued the certificate</span>
<a href="#l9.48"></a><span id="l9.48">  *      LDAPSSL_AUTH_CNCHECK:</span>
<a href="#l9.49"></a><span id="l9.49">  *                         indicates that you accept the server's</span>
<a href="#l9.50"></a><span id="l9.50">  *                         certificate only if you trust the CA who</span>
<a href="#l9.51"></a><span id="l9.51">  *                         issued the certificate and if the value</span>
<a href="#l9.52"></a><span id="l9.52">  *                         of the cn attribute is the DNS hostname</span>
<a href="#l9.53"></a><span id="l9.53">  *                         of the server.  If this option is selected,</span>
<a href="#l9.54"></a><span id="l9.54" class="difflineminus">- *			   please ensure that the &quot;defhost&quot; parameter</span>
<a href="#l9.55"></a><span id="l9.55" class="difflineminus">- *			   passed to ldapssl_init() consist of only</span>
<a href="#l9.56"></a><span id="l9.56" class="difflineminus">- *			   one hostname and not a list of hosts.</span>
<a href="#l9.57"></a><span id="l9.57" class="difflineminus">- *			   Furthermore, the port number must be passed</span>
<a href="#l9.58"></a><span id="l9.58" class="difflineminus">- *			   via the &quot;defport&quot; parameter, and cannot</span>
<a href="#l9.59"></a><span id="l9.59" class="difflineminus">- *			   be passed via a host:port option.</span>
<a href="#l9.60"></a><span id="l9.60" class="difflineplus">+ *                         please ensure that the &quot;defhost&quot; parameter</span>
<a href="#l9.61"></a><span id="l9.61" class="difflineplus">+ *                         passed to ldapssl_init() consist of only</span>
<a href="#l9.62"></a><span id="l9.62" class="difflineplus">+ *                         one hostname and not a list of hosts.</span>
<a href="#l9.63"></a><span id="l9.63" class="difflineplus">+ *                         Furthermore, the port number must be passed</span>
<a href="#l9.64"></a><span id="l9.64" class="difflineplus">+ *                         via the &quot;defport&quot; parameter, and cannot</span>
<a href="#l9.65"></a><span id="l9.65" class="difflineplus">+ *                         be passed via a host:port option.</span>
<a href="#l9.66"></a><span id="l9.66">  *</span>
<a href="#l9.67"></a><span id="l9.67">  * Returns 0 if all goes well.</span>
<a href="#l9.68"></a><span id="l9.68">  */</span>
<a href="#l9.69"></a><span id="l9.69"> </span>
<a href="#l9.70"></a><span id="l9.70"> int LDAP_CALL ldapssl_serverauth_init(</span>
<a href="#l9.71"></a><span id="l9.71">     const char *certdbpath, void *certdbhandle, const int sslstrength );</span>
<a href="#l9.72"></a><span id="l9.72"> </span>
<a href="#l9.73"></a><span id="l9.73"> /*</span>
<a href="#l9.74"></a><span id="l9.74" class="difflineat">@@ -200,17 +200,17 @@ int LDAP_CALL ldapssl_advclientauth_init</span>
<a href="#l9.75"></a><span id="l9.75"> const char * LDAP_CALL ldapssl_err2string( const int prerrno );</span>
<a href="#l9.76"></a><span id="l9.76"> </span>
<a href="#l9.77"></a><span id="l9.77"> </span>
<a href="#l9.78"></a><span id="l9.78"> /*</span>
<a href="#l9.79"></a><span id="l9.79">  * Enable SSL client authentication on the given ld.</span>
<a href="#l9.80"></a><span id="l9.80">  * Returns 0 if all goes well.</span>
<a href="#l9.81"></a><span id="l9.81">  */</span>
<a href="#l9.82"></a><span id="l9.82"> int LDAP_CALL ldapssl_enable_clientauth( LDAP *ld, char *keynickname,</span>
<a href="#l9.83"></a><span id="l9.83" class="difflineminus">-	char *keypasswd, char *certnickname );</span>
<a href="#l9.84"></a><span id="l9.84" class="difflineplus">+  char *keypasswd, char *certnickname );</span>
<a href="#l9.85"></a><span id="l9.85"> </span>
<a href="#l9.86"></a><span id="l9.86"> /*</span>
<a href="#l9.87"></a><span id="l9.87">  * Set the SSL strength for an existing SSL-enabled LDAP session handle.</span>
<a href="#l9.88"></a><span id="l9.88">  *</span>
<a href="#l9.89"></a><span id="l9.89">  * See the description of ldapssl_serverauth_init() above for valid</span>
<a href="#l9.90"></a><span id="l9.90">  * sslstrength values. If ld is NULL, the default for new LDAP session</span>
<a href="#l9.91"></a><span id="l9.91">  * handles is set.</span>
<a href="#l9.92"></a><span id="l9.92">  *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/ldap/c-sdk/include/ldaplog.h</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/ldap/c-sdk/include/ldaplog.h</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -37,70 +37,70 @@</span>
<a href="#l10.4"></a><span id="l10.4"> </span>
<a href="#l10.5"></a><span id="l10.5"> #ifndef _LDAPLOG_H</span>
<a href="#l10.6"></a><span id="l10.6"> #define _LDAPLOG_H</span>
<a href="#l10.7"></a><span id="l10.7"> </span>
<a href="#l10.8"></a><span id="l10.8"> #ifdef __cplusplus</span>
<a href="#l10.9"></a><span id="l10.9"> extern &quot;C&quot; {</span>
<a href="#l10.10"></a><span id="l10.10"> #endif</span>
<a href="#l10.11"></a><span id="l10.11"> </span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-#define LDAP_DEBUG_TRACE	0x00001</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-#define LDAP_DEBUG_PACKETS	0x00002</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineminus">-#define LDAP_DEBUG_ARGS		0x00004</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineminus">-#define LDAP_DEBUG_CONNS	0x00008</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineminus">-#define LDAP_DEBUG_BER		0x00010</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineminus">-#define LDAP_DEBUG_FILTER	0x00020</span>
<a href="#l10.18"></a><span id="l10.18" class="difflineminus">-#define LDAP_DEBUG_CONFIG	0x00040</span>
<a href="#l10.19"></a><span id="l10.19" class="difflineminus">-#define LDAP_DEBUG_ACL		0x00080</span>
<a href="#l10.20"></a><span id="l10.20" class="difflineminus">-#define LDAP_DEBUG_STATS	0x00100</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineminus">-#define LDAP_DEBUG_STATS2	0x00200</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineminus">-#define LDAP_DEBUG_SHELL	0x00400</span>
<a href="#l10.23"></a><span id="l10.23" class="difflineminus">-#define LDAP_DEBUG_PARSE	0x00800</span>
<a href="#l10.24"></a><span id="l10.24" class="difflineplus">+#define LDAP_DEBUG_TRACE 0x00001</span>
<a href="#l10.25"></a><span id="l10.25" class="difflineplus">+#define LDAP_DEBUG_PACKETS 0x00002</span>
<a href="#l10.26"></a><span id="l10.26" class="difflineplus">+#define LDAP_DEBUG_ARGS 0x00004</span>
<a href="#l10.27"></a><span id="l10.27" class="difflineplus">+#define LDAP_DEBUG_CONNS 0x00008</span>
<a href="#l10.28"></a><span id="l10.28" class="difflineplus">+#define LDAP_DEBUG_BER 0x00010</span>
<a href="#l10.29"></a><span id="l10.29" class="difflineplus">+#define LDAP_DEBUG_FILTER 0x00020</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineplus">+#define LDAP_DEBUG_CONFIG 0x00040</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineplus">+#define LDAP_DEBUG_ACL 0x00080</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+#define LDAP_DEBUG_STATS 0x00100</span>
<a href="#l10.33"></a><span id="l10.33" class="difflineplus">+#define LDAP_DEBUG_STATS2 0x00200</span>
<a href="#l10.34"></a><span id="l10.34" class="difflineplus">+#define LDAP_DEBUG_SHELL 0x00400</span>
<a href="#l10.35"></a><span id="l10.35" class="difflineplus">+#define LDAP_DEBUG_PARSE 0x00800</span>
<a href="#l10.36"></a><span id="l10.36"> #define LDAP_DEBUG_HOUSE        0x01000</span>
<a href="#l10.37"></a><span id="l10.37"> #define LDAP_DEBUG_REPL         0x02000</span>
<a href="#l10.38"></a><span id="l10.38"> #define LDAP_DEBUG_ANY          0x04000</span>
<a href="#l10.39"></a><span id="l10.39"> #define LDAP_DEBUG_CACHE        0x08000</span>
<a href="#l10.40"></a><span id="l10.40" class="difflineminus">-#define LDAP_DEBUG_PLUGIN	0x10000</span>
<a href="#l10.41"></a><span id="l10.41" class="difflineplus">+#define LDAP_DEBUG_PLUGIN 0x10000</span>
<a href="#l10.42"></a><span id="l10.42"> </span>
<a href="#l10.43"></a><span id="l10.43"> /* debugging stuff */</span>
<a href="#l10.44"></a><span id="l10.44"> /* Disable by default */</span>
<a href="#l10.45"></a><span id="l10.45"> #define LDAPDebug( level, fmt, arg1, arg2, arg3 )</span>
<a href="#l10.46"></a><span id="l10.46"> </span>
<a href="#l10.47"></a><span id="l10.47"> #ifdef LDAP_DEBUG</span>
<a href="#l10.48"></a><span id="l10.48"> #  undef LDAPDebug</span>
<a href="#l10.49"></a><span id="l10.49"> </span>
<a href="#l10.50"></a><span id="l10.50"> /* SLAPD_LOGGING should not be on for WINSOCK (16-bit Windows) */</span>
<a href="#l10.51"></a><span id="l10.51"> #  if defined(SLAPD_LOGGING)</span>
<a href="#l10.52"></a><span id="l10.52"> #    ifdef _WIN32</span>
<a href="#l10.53"></a><span id="l10.53" class="difflineminus">-       extern int	*module_ldap_debug;</span>
<a href="#l10.54"></a><span id="l10.54" class="difflineminus">-#      define LDAPDebug( level, fmt, arg1, arg2, arg3 )	\</span>
<a href="#l10.55"></a><span id="l10.55" class="difflineplus">+       extern int *module_ldap_debug;</span>
<a href="#l10.56"></a><span id="l10.56" class="difflineplus">+#      define LDAPDebug( level, fmt, arg1, arg2, arg3 ) \</span>
<a href="#l10.57"></a><span id="l10.57">        { \</span>
<a href="#l10.58"></a><span id="l10.58" class="difflineminus">-		if ( *module_ldap_debug &amp; level ) { \</span>
<a href="#l10.59"></a><span id="l10.59" class="difflineminus">-		        slapd_log_error_proc( NULL, fmt, arg1, arg2, arg3 ); \</span>
<a href="#l10.60"></a><span id="l10.60" class="difflineminus">-	    } \</span>
<a href="#l10.61"></a><span id="l10.61" class="difflineplus">+    if ( *module_ldap_debug &amp; level ) { \</span>
<a href="#l10.62"></a><span id="l10.62" class="difflineplus">+            slapd_log_error_proc( NULL, fmt, arg1, arg2, arg3 ); \</span>
<a href="#l10.63"></a><span id="l10.63" class="difflineplus">+      } \</span>
<a href="#l10.64"></a><span id="l10.64">        }</span>
<a href="#l10.65"></a><span id="l10.65"> #    else /* _WIN32 */</span>
<a href="#l10.66"></a><span id="l10.66" class="difflineminus">-       extern int	ldap_debug;</span>
<a href="#l10.67"></a><span id="l10.67" class="difflineminus">-#      define LDAPDebug( level, fmt, arg1, arg2, arg3 )	\</span>
<a href="#l10.68"></a><span id="l10.68" class="difflineplus">+       extern int ldap_debug;</span>
<a href="#l10.69"></a><span id="l10.69" class="difflineplus">+#      define LDAPDebug( level, fmt, arg1, arg2, arg3 ) \</span>
<a href="#l10.70"></a><span id="l10.70">        { \</span>
<a href="#l10.71"></a><span id="l10.71" class="difflineminus">-		if ( ldap_debug &amp; level ) { \</span>
<a href="#l10.72"></a><span id="l10.72" class="difflineminus">-		        slapd_log_error_proc( NULL, fmt, arg1, arg2, arg3 ); \</span>
<a href="#l10.73"></a><span id="l10.73" class="difflineminus">-	    } \</span>
<a href="#l10.74"></a><span id="l10.74" class="difflineplus">+    if ( ldap_debug &amp; level ) { \</span>
<a href="#l10.75"></a><span id="l10.75" class="difflineplus">+            slapd_log_error_proc( NULL, fmt, arg1, arg2, arg3 ); \</span>
<a href="#l10.76"></a><span id="l10.76" class="difflineplus">+      } \</span>
<a href="#l10.77"></a><span id="l10.77">        }</span>
<a href="#l10.78"></a><span id="l10.78"> #    endif /* Win32 */</span>
<a href="#l10.79"></a><span id="l10.79"> #  else /* no SLAPD_LOGGING */</span>
<a href="#l10.80"></a><span id="l10.80">      extern void ber_err_print( char * );</span>
<a href="#l10.81"></a><span id="l10.81" class="difflineminus">-     extern int	ldap_debug;</span>
<a href="#l10.82"></a><span id="l10.82" class="difflineplus">+     extern int ldap_debug;</span>
<a href="#l10.83"></a><span id="l10.83"> #    define LDAPDebug( level, fmt, arg1, arg2, arg3 ) \</span>
<a href="#l10.84"></a><span id="l10.84" class="difflineminus">-		if ( ldap_debug &amp; level ) { \</span>
<a href="#l10.85"></a><span id="l10.85" class="difflineminus">-			char msg[1024]; \</span>
<a href="#l10.86"></a><span id="l10.86" class="difflineminus">-			snprintf( msg, sizeof(msg), fmt, arg1, arg2, arg3 ); \</span>
<a href="#l10.87"></a><span id="l10.87" class="difflineminus">-			msg[sizeof(msg)-1] = '\0'; \</span>
<a href="#l10.88"></a><span id="l10.88" class="difflineminus">-			ber_err_print( msg ); \</span>
<a href="#l10.89"></a><span id="l10.89" class="difflineminus">-		}</span>
<a href="#l10.90"></a><span id="l10.90" class="difflineplus">+    if ( ldap_debug &amp; level ) { \</span>
<a href="#l10.91"></a><span id="l10.91" class="difflineplus">+      char msg[1024]; \</span>
<a href="#l10.92"></a><span id="l10.92" class="difflineplus">+      snprintf( msg, sizeof(msg), fmt, arg1, arg2, arg3 ); \</span>
<a href="#l10.93"></a><span id="l10.93" class="difflineplus">+      msg[sizeof(msg)-1] = '\0'; \</span>
<a href="#l10.94"></a><span id="l10.94" class="difflineplus">+      ber_err_print( msg ); \</span>
<a href="#l10.95"></a><span id="l10.95" class="difflineplus">+    }</span>
<a href="#l10.96"></a><span id="l10.96"> #  endif /* SLAPD_LOGGING */</span>
<a href="#l10.97"></a><span id="l10.97"> #endif /* LDAP_DEBUG */</span>
<a href="#l10.98"></a><span id="l10.98"> </span>
<a href="#l10.99"></a><span id="l10.99"> #ifdef __cplusplus</span>
<a href="#l10.100"></a><span id="l10.100"> }</span>
<a href="#l10.101"></a><span id="l10.101"> #endif</span>
<a href="#l10.102"></a><span id="l10.102"> </span>
<a href="#l10.103"></a><span id="l10.103"> #endif /* _LDAP_H */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/ldap/c-sdk/include/ldappr.h</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/ldap/c-sdk/include/ldappr.h</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -37,17 +37,17 @@</span>
<a href="#l11.4"></a><span id="l11.4"> </span>
<a href="#l11.5"></a><span id="l11.5"> #ifndef LDAP_PR_H</span>
<a href="#l11.6"></a><span id="l11.6"> #define LDAP_PR_H</span>
<a href="#l11.7"></a><span id="l11.7"> </span>
<a href="#l11.8"></a><span id="l11.8"> #include &quot;nspr.h&quot;</span>
<a href="#l11.9"></a><span id="l11.9"> </span>
<a href="#l11.10"></a><span id="l11.10"> /*</span>
<a href="#l11.11"></a><span id="l11.11">  * ldappr.h - prototypes for functions that tie libldap into NSPR (Netscape</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">- *	Portable Runtime).</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+ * Portable Runtime).</span>
<a href="#l11.14"></a><span id="l11.14">  */</span>
<a href="#l11.15"></a><span id="l11.15"> </span>
<a href="#l11.16"></a><span id="l11.16"> #ifdef __cplusplus</span>
<a href="#l11.17"></a><span id="l11.17"> extern &quot;C&quot; {</span>
<a href="#l11.18"></a><span id="l11.18"> #endif</span>
<a href="#l11.19"></a><span id="l11.19"> </span>
<a href="#l11.20"></a><span id="l11.20"> /*</span>
<a href="#l11.21"></a><span id="l11.21">  * Function: prldap_init().</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineat">@@ -92,150 +92,150 @@ int LDAP_CALL prldap_install_routines( L</span>
<a href="#l11.23"></a><span id="l11.23">  * an option that affects the prldap layer.</span>
<a href="#l11.24"></a><span id="l11.24">  *</span>
<a href="#l11.25"></a><span id="l11.25">  * If 'ld' and 'session&quot; are both NULL, the option is set as the default</span>
<a href="#l11.26"></a><span id="l11.26">  * for all new prldap sessions.</span>
<a href="#l11.27"></a><span id="l11.27">  *</span>
<a href="#l11.28"></a><span id="l11.28">  * Returns an LDAP API error code (LDAP_SUCCESS if all goes well).</span>
<a href="#l11.29"></a><span id="l11.29">  */</span>
<a href="#l11.30"></a><span id="l11.30"> int LDAP_CALL prldap_set_session_option( LDAP *ld, void *sessionarg,</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineminus">-	int option, ... );</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+  int option, ... );</span>
<a href="#l11.33"></a><span id="l11.33"> </span>
<a href="#l11.34"></a><span id="l11.34"> </span>
<a href="#l11.35"></a><span id="l11.35"> /*</span>
<a href="#l11.36"></a><span id="l11.36">  * Function: prldap_get_session_option().</span>
<a href="#l11.37"></a><span id="l11.37">  *</span>
<a href="#l11.38"></a><span id="l11.38">  * Given an LDAP session handle or a session argument such is passed to</span>
<a href="#l11.39"></a><span id="l11.39">  * CONNECT, POLL, NEWHANDLE, or DISPOSEHANDLE extended I/O callbacks, retrieve</span>
<a href="#l11.40"></a><span id="l11.40">  * the setting for an option that affects the prldap layer.</span>
<a href="#l11.41"></a><span id="l11.41">  *</span>
<a href="#l11.42"></a><span id="l11.42">  * If 'ld' and 'session&quot; are both NULL, the default option value for all new</span>
<a href="#l11.43"></a><span id="l11.43">  * new prldap sessions is retrieved.</span>
<a href="#l11.44"></a><span id="l11.44">  *</span>
<a href="#l11.45"></a><span id="l11.45">  * Returns an LDAP API error code (LDAP_SUCCESS if all goes well).</span>
<a href="#l11.46"></a><span id="l11.46">  */</span>
<a href="#l11.47"></a><span id="l11.47"> int LDAP_CALL prldap_get_session_option( LDAP *ld, void *sessionarg,</span>
<a href="#l11.48"></a><span id="l11.48" class="difflineminus">-	int option, ... );</span>
<a href="#l11.49"></a><span id="l11.49" class="difflineplus">+  int option, ... );</span>
<a href="#l11.50"></a><span id="l11.50"> </span>
<a href="#l11.51"></a><span id="l11.51"> </span>
<a href="#l11.52"></a><span id="l11.52"> /*</span>
<a href="#l11.53"></a><span id="l11.53">  * Available options.</span>
<a href="#l11.54"></a><span id="l11.54">  */</span>
<a href="#l11.55"></a><span id="l11.55"> /*</span>
<a href="#l11.56"></a><span id="l11.56">  * PRLDAP_OPT_IO_MAX_TIMEOUT: the maximum time in milliseconds to</span>
<a href="#l11.57"></a><span id="l11.57">  * block waiting for a network I/O operation to complete.</span>
<a href="#l11.58"></a><span id="l11.58">  *</span>
<a href="#l11.59"></a><span id="l11.59">  * Data type: int.</span>
<a href="#l11.60"></a><span id="l11.60">  *</span>
<a href="#l11.61"></a><span id="l11.61">  * These two special values from ldap-extension.h can also be used;</span>
<a href="#l11.62"></a><span id="l11.62">  *</span>
<a href="#l11.63"></a><span id="l11.63">  *    LDAP_X_IO_TIMEOUT_NO_TIMEOUT</span>
<a href="#l11.64"></a><span id="l11.64">  *    LDAP_X_IO_TIMEOUT_NO_WAIT</span>
<a href="#l11.65"></a><span id="l11.65">  */</span>
<a href="#l11.66"></a><span id="l11.66" class="difflineminus">-#define PRLDAP_OPT_IO_MAX_TIMEOUT		1</span>
<a href="#l11.67"></a><span id="l11.67" class="difflineplus">+#define PRLDAP_OPT_IO_MAX_TIMEOUT 1</span>
<a href="#l11.68"></a><span id="l11.68"> </span>
<a href="#l11.69"></a><span id="l11.69"> </span>
<a href="#l11.70"></a><span id="l11.70"> /**</span>
<a href="#l11.71"></a><span id="l11.71">  ** Note: the types and functions below are only useful for developers</span>
<a href="#l11.72"></a><span id="l11.72">  ** who need to layer one or more custom extended I/O functions on top of</span>
<a href="#l11.73"></a><span id="l11.73">  ** the standard NSPR I/O functions installed by a call to prldap_init()</span>
<a href="#l11.74"></a><span id="l11.74">  ** or prldap_install_routines().  Layering can be accomplished after</span>
<a href="#l11.75"></a><span id="l11.75">  ** prldap_init() or prldap_install_routines() has completed successfully</span>
<a href="#l11.76"></a><span id="l11.76">  ** by:</span>
<a href="#l11.77"></a><span id="l11.77">  **</span>
<a href="#l11.78"></a><span id="l11.78">  **   1) Calling ldap_get_option( ..., LDAP_X_OPT_EXTIO_FN_PTRS, ... ).</span>
<a href="#l11.79"></a><span id="l11.79">  **</span>
<a href="#l11.80"></a><span id="l11.80">  **   2) Saving the function pointer of one or more of the standard functions.</span>
<a href="#l11.81"></a><span id="l11.81">  **</span>
<a href="#l11.82"></a><span id="l11.82">  **   3) Replacing one or more standard functions in the ldap_x_ext_io_fns</span>
<a href="#l11.83"></a><span id="l11.83" class="difflineminus">- **      struct	with new functions that optionally do some preliminary work,</span>
<a href="#l11.84"></a><span id="l11.84" class="difflineplus">+ **      struct with new functions that optionally do some preliminary work,</span>
<a href="#l11.85"></a><span id="l11.85">  **      call the standard function (via the function pointer saved in step 2),</span>
<a href="#l11.86"></a><span id="l11.86">  **      and optionally do some followup work.</span>
<a href="#l11.87"></a><span id="l11.87">  */</span>
<a href="#l11.88"></a><span id="l11.88"> </span>
<a href="#l11.89"></a><span id="l11.89"> /*</span>
<a href="#l11.90"></a><span id="l11.90">  * Data structure for session information.</span>
<a href="#l11.91"></a><span id="l11.91">  * seinfo_size should be set to PRLDAP_SESSIONINFO_SIZE before use.</span>
<a href="#l11.92"></a><span id="l11.92">  */</span>
<a href="#l11.93"></a><span id="l11.93"> struct prldap_session_private;</span>
<a href="#l11.94"></a><span id="l11.94"> </span>
<a href="#l11.95"></a><span id="l11.95"> typedef struct prldap_session_info {</span>
<a href="#l11.96"></a><span id="l11.96" class="difflineminus">-	int				seinfo_size;</span>
<a href="#l11.97"></a><span id="l11.97" class="difflineminus">-	struct prldap_session_private	*seinfo_appdata;</span>
<a href="#l11.98"></a><span id="l11.98" class="difflineplus">+  int seinfo_size;</span>
<a href="#l11.99"></a><span id="l11.99" class="difflineplus">+  struct prldap_session_private *seinfo_appdata;</span>
<a href="#l11.100"></a><span id="l11.100"> } PRLDAPSessionInfo;</span>
<a href="#l11.101"></a><span id="l11.101" class="difflineminus">-#define PRLDAP_SESSIONINFO_SIZE	sizeof( PRLDAPSessionInfo )</span>
<a href="#l11.102"></a><span id="l11.102" class="difflineplus">+#define PRLDAP_SESSIONINFO_SIZE sizeof( PRLDAPSessionInfo )</span>
<a href="#l11.103"></a><span id="l11.103"> </span>
<a href="#l11.104"></a><span id="l11.104"> </span>
<a href="#l11.105"></a><span id="l11.105"> /*</span>
<a href="#l11.106"></a><span id="l11.106">  * Function: prldap_set_session_info().</span>
<a href="#l11.107"></a><span id="l11.107">  *</span>
<a href="#l11.108"></a><span id="l11.108">  * Given an LDAP session handle or a session argument such is passed to</span>
<a href="#l11.109"></a><span id="l11.109">  * CONNECT, POLL, NEWHANDLE, or DISPOSEHANDLE extended I/O callbacks,</span>
<a href="#l11.110"></a><span id="l11.110">  * set some application-specific data.  If ld is NULL, arg is used.  If</span>
<a href="#l11.111"></a><span id="l11.111">  * both ld and arg are NULL, LDAP_PARAM_ERROR is returned.</span>
<a href="#l11.112"></a><span id="l11.112">  *</span>
<a href="#l11.113"></a><span id="l11.113">  * Returns an LDAP API error code (LDAP_SUCCESS if all goes well).</span>
<a href="#l11.114"></a><span id="l11.114">  */</span>
<a href="#l11.115"></a><span id="l11.115"> int LDAP_CALL prldap_set_session_info( LDAP *ld, void *sessionarg,</span>
<a href="#l11.116"></a><span id="l11.116" class="difflineminus">-	PRLDAPSessionInfo *seip );</span>
<a href="#l11.117"></a><span id="l11.117" class="difflineplus">+  PRLDAPSessionInfo *seip );</span>
<a href="#l11.118"></a><span id="l11.118"> </span>
<a href="#l11.119"></a><span id="l11.119"> </span>
<a href="#l11.120"></a><span id="l11.120"> /*</span>
<a href="#l11.121"></a><span id="l11.121">  * Function: prldap_get_session_info().</span>
<a href="#l11.122"></a><span id="l11.122">  *</span>
<a href="#l11.123"></a><span id="l11.123">  * Given an LDAP session handle or a session argument such is passed to</span>
<a href="#l11.124"></a><span id="l11.124">  * CONNECT, POLL, NEWHANDLE, or DISPOSEHANDLE extended I/O callbacks,</span>
<a href="#l11.125"></a><span id="l11.125">  * retrieve some application-specific data.  If ld is NULL, arg is used.  If</span>
<a href="#l11.126"></a><span id="l11.126">  * both ld and arg are NULL, LDAP_PARAM_ERROR is returned.</span>
<a href="#l11.127"></a><span id="l11.127">  *</span>
<a href="#l11.128"></a><span id="l11.128">  * Returns an LDAP API error code (LDAP_SUCCESS if all goes well, in</span>
<a href="#l11.129"></a><span id="l11.129">  * which case the fields in the structure that seip points to are filled in).</span>
<a href="#l11.130"></a><span id="l11.130">  */</span>
<a href="#l11.131"></a><span id="l11.131"> int LDAP_CALL prldap_get_session_info( LDAP *ld, void *sessionarg,</span>
<a href="#l11.132"></a><span id="l11.132" class="difflineminus">-	PRLDAPSessionInfo *seip );</span>
<a href="#l11.133"></a><span id="l11.133" class="difflineplus">+  PRLDAPSessionInfo *seip );</span>
<a href="#l11.134"></a><span id="l11.134"> </span>
<a href="#l11.135"></a><span id="l11.135"> </span>
<a href="#l11.136"></a><span id="l11.136"> /*</span>
<a href="#l11.137"></a><span id="l11.137">  * Data structure for socket specific information.</span>
<a href="#l11.138"></a><span id="l11.138">  * Note: soinfo_size should be set to PRLDAP_SOCKETINFO_SIZE before use.</span>
<a href="#l11.139"></a><span id="l11.139">  */</span>
<a href="#l11.140"></a><span id="l11.140"> struct prldap_socket_private;</span>
<a href="#l11.141"></a><span id="l11.141"> typedef struct prldap_socket_info {</span>
<a href="#l11.142"></a><span id="l11.142" class="difflineminus">-	int				soinfo_size;</span>
<a href="#l11.143"></a><span id="l11.143" class="difflineminus">-	PRFileDesc			*soinfo_prfd;</span>
<a href="#l11.144"></a><span id="l11.144" class="difflineminus">-	struct prldap_socket_private	*soinfo_appdata;</span>
<a href="#l11.145"></a><span id="l11.145" class="difflineplus">+  int soinfo_size;</span>
<a href="#l11.146"></a><span id="l11.146" class="difflineplus">+  PRFileDesc *soinfo_prfd;</span>
<a href="#l11.147"></a><span id="l11.147" class="difflineplus">+  struct prldap_socket_private *soinfo_appdata;</span>
<a href="#l11.148"></a><span id="l11.148"> } PRLDAPSocketInfo;</span>
<a href="#l11.149"></a><span id="l11.149" class="difflineminus">-#define PRLDAP_SOCKETINFO_SIZE	sizeof( PRLDAPSocketInfo )</span>
<a href="#l11.150"></a><span id="l11.150" class="difflineplus">+#define PRLDAP_SOCKETINFO_SIZE sizeof( PRLDAPSocketInfo )</span>
<a href="#l11.151"></a><span id="l11.151"> </span>
<a href="#l11.152"></a><span id="l11.152"> </span>
<a href="#l11.153"></a><span id="l11.153"> /*</span>
<a href="#l11.154"></a><span id="l11.154">  * Function: prldap_set_socket_info().</span>
<a href="#l11.155"></a><span id="l11.155">  *</span>
<a href="#l11.156"></a><span id="l11.156">  * Given an integer fd and a socket argument such as those passed to the</span>
<a href="#l11.157"></a><span id="l11.157">  * extended I/O callback functions, set socket specific information.</span>
<a href="#l11.158"></a><span id="l11.158">  *</span>
<a href="#l11.159"></a><span id="l11.159">  * Returns an LDAP API error code (LDAP_SUCCESS if all goes well).</span>
<a href="#l11.160"></a><span id="l11.160">  *</span>
<a href="#l11.161"></a><span id="l11.161">  * Note: it is only safe to change soinfo_prfd from within the CONNECT</span>
<a href="#l11.162"></a><span id="l11.162">  * extended I/O callback function.</span>
<a href="#l11.163"></a><span id="l11.163">  */</span>
<a href="#l11.164"></a><span id="l11.164"> int LDAP_CALL prldap_set_socket_info( int fd, void *socketarg,</span>
<a href="#l11.165"></a><span id="l11.165" class="difflineminus">-					PRLDAPSocketInfo *soip );</span>
<a href="#l11.166"></a><span id="l11.166" class="difflineplus">+                                      PRLDAPSocketInfo *soip );</span>
<a href="#l11.167"></a><span id="l11.167"> </span>
<a href="#l11.168"></a><span id="l11.168"> /*</span>
<a href="#l11.169"></a><span id="l11.169">  * Function: prldap_get_socket_info().</span>
<a href="#l11.170"></a><span id="l11.170">  *</span>
<a href="#l11.171"></a><span id="l11.171">  * Given an integer fd and a socket argument such as those passed to the</span>
<a href="#l11.172"></a><span id="l11.172">  * extended I/O callback functions, retrieve socket specific information.</span>
<a href="#l11.173"></a><span id="l11.173">  *</span>
<a href="#l11.174"></a><span id="l11.174">  * Returns an LDAP API error code (LDAP_SUCCESS if all goes well, in</span>
<a href="#l11.175"></a><span id="l11.175">  * which case the fields in the structure that soip points to are filled in).</span>
<a href="#l11.176"></a><span id="l11.176">  */</span>
<a href="#l11.177"></a><span id="l11.177"> int LDAP_CALL prldap_get_socket_info( int fd, void *socketarg,</span>
<a href="#l11.178"></a><span id="l11.178" class="difflineminus">-					PRLDAPSocketInfo *soip );</span>
<a href="#l11.179"></a><span id="l11.179" class="difflineplus">+                                      PRLDAPSocketInfo *soip );</span>
<a href="#l11.180"></a><span id="l11.180"> </span>
<a href="#l11.181"></a><span id="l11.181"> /*</span>
<a href="#l11.182"></a><span id="l11.182">  * Function: prldap_get_default_socket_info().</span>
<a href="#l11.183"></a><span id="l11.183">  *</span>
<a href="#l11.184"></a><span id="l11.184">  * Given an LDAP session handle, retrieve socket specific information.</span>
<a href="#l11.185"></a><span id="l11.185">  * If ld is NULL, LDAP_PARAM_ERROR is returned.</span>
<a href="#l11.186"></a><span id="l11.186">  *</span>
<a href="#l11.187"></a><span id="l11.187">  * Returns an LDAP API error code (LDAP_SUCCESS if all goes well, in</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/ldap/c-sdk/include/ldaprot.h</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/ldap/c-sdk/include/ldaprot.h</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -37,167 +37,167 @@</span>
<a href="#l12.4"></a><span id="l12.4"> </span>
<a href="#l12.5"></a><span id="l12.5"> #ifndef _LDAPROT_H</span>
<a href="#l12.6"></a><span id="l12.6"> #define _LDAPROT_H</span>
<a href="#l12.7"></a><span id="l12.7"> </span>
<a href="#l12.8"></a><span id="l12.8"> #ifdef __cplusplus</span>
<a href="#l12.9"></a><span id="l12.9"> extern &quot;C&quot; {</span>
<a href="#l12.10"></a><span id="l12.10"> #endif</span>
<a href="#l12.11"></a><span id="l12.11"> </span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-#define LDAP_VERSION1	1</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-#define LDAP_VERSION2	2</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-#define LDAP_VERSION3	3</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineminus">-#define LDAP_VERSION	LDAP_VERSION3</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+#define LDAP_VERSION1 1</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineplus">+#define LDAP_VERSION2 2</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+#define LDAP_VERSION3 3</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+#define LDAP_VERSION LDAP_VERSION3</span>
<a href="#l12.20"></a><span id="l12.20"> </span>
<a href="#l12.21"></a><span id="l12.21"> #define COMPAT20</span>
<a href="#l12.22"></a><span id="l12.22"> #define COMPAT30</span>
<a href="#l12.23"></a><span id="l12.23"> #if defined(COMPAT20) || defined(COMPAT30)</span>
<a href="#l12.24"></a><span id="l12.24"> #define COMPAT</span>
<a href="#l12.25"></a><span id="l12.25"> #endif</span>
<a href="#l12.26"></a><span id="l12.26"> </span>
<a href="#l12.27"></a><span id="l12.27" class="difflineminus">-#define LDAP_URL_PREFIX		&quot;ldap://&quot;</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineminus">-#define LDAP_URL_PREFIX_LEN	7</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineminus">-#define LDAPS_URL_PREFIX	&quot;ldaps://&quot;</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineminus">-#define LDAPS_URL_PREFIX_LEN	8</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineminus">-#define LDAP_REF_STR		&quot;Referral:\n&quot;</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineminus">-#define LDAP_REF_STR_LEN	10</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineplus">+#define LDAP_URL_PREFIX &quot;ldap://&quot;</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineplus">+#define LDAP_URL_PREFIX_LEN 7</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineplus">+#define LDAPS_URL_PREFIX &quot;ldaps://&quot;</span>
<a href="#l12.36"></a><span id="l12.36" class="difflineplus">+#define LDAPS_URL_PREFIX_LEN 8</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineplus">+#define LDAP_REF_STR &quot;Referral:\n&quot;</span>
<a href="#l12.38"></a><span id="l12.38" class="difflineplus">+#define LDAP_REF_STR_LEN 10</span>
<a href="#l12.39"></a><span id="l12.39"> </span>
<a href="#l12.40"></a><span id="l12.40"> /*</span>
<a href="#l12.41"></a><span id="l12.41">  * specific LDAP instantiations of BER types we know about</span>
<a href="#l12.42"></a><span id="l12.42">  */</span>
<a href="#l12.43"></a><span id="l12.43"> </span>
<a href="#l12.44"></a><span id="l12.44"> /* general stuff */</span>
<a href="#l12.45"></a><span id="l12.45" class="difflineminus">-#define LDAP_TAG_MESSAGE	0x30L	/* tag is 16 + constructed bit */</span>
<a href="#l12.46"></a><span id="l12.46" class="difflineminus">-#define OLD_LDAP_TAG_MESSAGE	0x10L	/* forgot the constructed bit  */</span>
<a href="#l12.47"></a><span id="l12.47" class="difflineminus">-#define LDAP_TAG_MSGID		0x02L   /* INTEGER */</span>
<a href="#l12.48"></a><span id="l12.48" class="difflineminus">-#define LDAP_TAG_LDAPDN		0x04L	/* OCTET STRING */</span>
<a href="#l12.49"></a><span id="l12.49" class="difflineminus">-#define LDAP_TAG_CONTROLS	0xa0L	/* context specific + constructed + 0 */</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineminus">-#define LDAP_TAG_REFERRAL	0xa3L	/* context specific + constructed + 3 */</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineminus">-#define LDAP_TAG_NEWSUPERIOR	0x80L	/* context specific + primitive + 0 */</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineminus">-#define LDAP_TAG_MRA_OID	0x81L	/* context specific + primitive + 1 */</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineminus">-#define LDAP_TAG_MRA_TYPE	0x82L	/* context specific + primitive + 2 */</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineminus">-#define LDAP_TAG_MRA_VALUE	0x83L	/* context specific + primitive + 3 */</span>
<a href="#l12.55"></a><span id="l12.55" class="difflineminus">-#define LDAP_TAG_MRA_DNATTRS	0x84L	/* context specific + primitive + 4 */</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineminus">-#define LDAP_TAG_EXOP_REQ_OID	0x80L	/* context specific + primitive + 0 */</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineminus">-#define LDAP_TAG_EXOP_REQ_VALUE	0x81L	/* context specific + primitive + 1 */</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineminus">-#define LDAP_TAG_EXOP_RES_OID	0x8aL	/* context specific + primitive + 10 */</span>
<a href="#l12.59"></a><span id="l12.59" class="difflineminus">-#define LDAP_TAG_EXOP_RES_VALUE	0x8bL	/* context specific + primitive + 11 */</span>
<a href="#l12.60"></a><span id="l12.60" class="difflineplus">+#define LDAP_TAG_MESSAGE 0x30L  /* tag is 16 + constructed bit */</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineplus">+#define OLD_LDAP_TAG_MESSAGE 0x10L  /* forgot the constructed bit  */</span>
<a href="#l12.62"></a><span id="l12.62" class="difflineplus">+#define LDAP_TAG_MSGID 0x02L   /* INTEGER */</span>
<a href="#l12.63"></a><span id="l12.63" class="difflineplus">+#define LDAP_TAG_LDAPDN 0x04L  /* OCTET STRING */</span>
<a href="#l12.64"></a><span id="l12.64" class="difflineplus">+#define LDAP_TAG_CONTROLS 0xa0L  /* context specific + constructed + 0 */</span>
<a href="#l12.65"></a><span id="l12.65" class="difflineplus">+#define LDAP_TAG_REFERRAL 0xa3L  /* context specific + constructed + 3 */</span>
<a href="#l12.66"></a><span id="l12.66" class="difflineplus">+#define LDAP_TAG_NEWSUPERIOR 0x80L  /* context specific + primitive + 0 */</span>
<a href="#l12.67"></a><span id="l12.67" class="difflineplus">+#define LDAP_TAG_MRA_OID 0x81L  /* context specific + primitive + 1 */</span>
<a href="#l12.68"></a><span id="l12.68" class="difflineplus">+#define LDAP_TAG_MRA_TYPE 0x82L  /* context specific + primitive + 2 */</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineplus">+#define LDAP_TAG_MRA_VALUE 0x83L  /* context specific + primitive + 3 */</span>
<a href="#l12.70"></a><span id="l12.70" class="difflineplus">+#define LDAP_TAG_MRA_DNATTRS 0x84L  /* context specific + primitive + 4 */</span>
<a href="#l12.71"></a><span id="l12.71" class="difflineplus">+#define LDAP_TAG_EXOP_REQ_OID 0x80L  /* context specific + primitive + 0 */</span>
<a href="#l12.72"></a><span id="l12.72" class="difflineplus">+#define LDAP_TAG_EXOP_REQ_VALUE 0x81L  /* context specific + primitive + 1 */</span>
<a href="#l12.73"></a><span id="l12.73" class="difflineplus">+#define LDAP_TAG_EXOP_RES_OID 0x8aL  /* context specific + primitive + 10 */</span>
<a href="#l12.74"></a><span id="l12.74" class="difflineplus">+#define LDAP_TAG_EXOP_RES_VALUE 0x8bL  /* context specific + primitive + 11 */</span>
<a href="#l12.75"></a><span id="l12.75"> #define LDAP_TAG_SK_MATCHRULE   0x80L   /* context specific + primitive + 0 */</span>
<a href="#l12.76"></a><span id="l12.76" class="difflineminus">-#define LDAP_TAG_SK_REVERSE 	0x81L	/* context specific + primitive + 1 */</span>
<a href="#l12.77"></a><span id="l12.77" class="difflineplus">+#define LDAP_TAG_SK_REVERSE 0x81L  /* context specific + primitive + 1 */</span>
<a href="#l12.78"></a><span id="l12.78"> #define LDAP_TAG_SR_ATTRTYPE    0x80L   /* context specific + primitive + 0 */</span>
<a href="#l12.79"></a><span id="l12.79" class="difflineminus">-#define LDAP_TAG_SASL_RES_CREDS	0x87L	/* context specific + primitive + 7 */</span>
<a href="#l12.80"></a><span id="l12.80" class="difflineminus">-#define LDAP_TAG_VLV_BY_INDEX	0xa0L	/* context specific + constructed + 0 */</span>
<a href="#l12.81"></a><span id="l12.81" class="difflineminus">-#define LDAP_TAG_VLV_BY_VALUE	0x81L	/* context specific + primitive + 1 */</span>
<a href="#l12.82"></a><span id="l12.82" class="difflineminus">-#define LDAP_TAG_PWP_WARNING	0xA0L   /* context specific + constructed */</span>
<a href="#l12.83"></a><span id="l12.83" class="difflineminus">-#define LDAP_TAG_PWP_SECSLEFT	0x80L   /* context specific + primitive */</span>
<a href="#l12.84"></a><span id="l12.84" class="difflineminus">-#define LDAP_TAG_PWP_GRCLOGINS	0x81L   /* context specific + primitive + 1 */</span>
<a href="#l12.85"></a><span id="l12.85" class="difflineminus">-#define LDAP_TAG_PWP_ERROR	0x81L   /* context specific + primitive + 1 */</span>
<a href="#l12.86"></a><span id="l12.86" class="difflineplus">+#define LDAP_TAG_SASL_RES_CREDS 0x87L  /* context specific + primitive + 7 */</span>
<a href="#l12.87"></a><span id="l12.87" class="difflineplus">+#define LDAP_TAG_VLV_BY_INDEX 0xa0L  /* context specific + constructed + 0 */</span>
<a href="#l12.88"></a><span id="l12.88" class="difflineplus">+#define LDAP_TAG_VLV_BY_VALUE 0x81L  /* context specific + primitive + 1 */</span>
<a href="#l12.89"></a><span id="l12.89" class="difflineplus">+#define LDAP_TAG_PWP_WARNING 0xA0L   /* context specific + constructed */</span>
<a href="#l12.90"></a><span id="l12.90" class="difflineplus">+#define LDAP_TAG_PWP_SECSLEFT 0x80L   /* context specific + primitive */</span>
<a href="#l12.91"></a><span id="l12.91" class="difflineplus">+#define LDAP_TAG_PWP_GRCLOGINS 0x81L   /* context specific + primitive + 1 */</span>
<a href="#l12.92"></a><span id="l12.92" class="difflineplus">+#define LDAP_TAG_PWP_ERROR 0x81L   /* context specific + primitive + 1 */</span>
<a href="#l12.93"></a><span id="l12.93"> #define LDAP_TAG_PWDMOD_REQ_ID  0x80L   /* context specific + primitive + 0 */</span>
<a href="#l12.94"></a><span id="l12.94"> #define LDAP_TAG_PWDMOD_REQ_OLD 0x81L   /* context specific + primitive + 1 */</span>
<a href="#l12.95"></a><span id="l12.95"> #define LDAP_TAG_PWDMOD_REQ_NEW 0x82L   /* context specific + primitive + 2 */</span>
<a href="#l12.96"></a><span id="l12.96"> #define LDAP_TAG_PWDMOD_RES_GEN 0x80L   /* context specific + primitive + 0 */</span>
<a href="#l12.97"></a><span id="l12.97"> </span>
<a href="#l12.98"></a><span id="l12.98"> /* possible operations a client can invoke */</span>
<a href="#l12.99"></a><span id="l12.99" class="difflineminus">-#define LDAP_REQ_BIND		0x60L	/* application + constructed + 0 */</span>
<a href="#l12.100"></a><span id="l12.100" class="difflineminus">-#define LDAP_REQ_UNBIND		0x42L	/* application + primitive   + 2 */</span>
<a href="#l12.101"></a><span id="l12.101" class="difflineminus">-#define LDAP_REQ_SEARCH		0x63L	/* application + constructed + 3 */</span>
<a href="#l12.102"></a><span id="l12.102" class="difflineminus">-#define LDAP_REQ_MODIFY		0x66L	/* application + constructed + 6 */</span>
<a href="#l12.103"></a><span id="l12.103" class="difflineminus">-#define LDAP_REQ_ADD		0x68L	/* application + constructed + 8 */</span>
<a href="#l12.104"></a><span id="l12.104" class="difflineminus">-#define LDAP_REQ_DELETE		0x4aL	/* application + primitive   + 10 */</span>
<a href="#l12.105"></a><span id="l12.105" class="difflineminus">-#define LDAP_REQ_MODRDN		0x6cL	/* application + constructed + 12 */</span>
<a href="#l12.106"></a><span id="l12.106" class="difflineminus">-#define LDAP_REQ_MODDN		0x6cL	/* application + constructed + 12 */</span>
<a href="#l12.107"></a><span id="l12.107" class="difflineminus">-#define LDAP_REQ_RENAME		0x6cL	/* application + constructed + 12 */</span>
<a href="#l12.108"></a><span id="l12.108" class="difflineminus">-#define LDAP_REQ_COMPARE	0x6eL	/* application + constructed + 14 */</span>
<a href="#l12.109"></a><span id="l12.109" class="difflineminus">-#define LDAP_REQ_ABANDON	0x50L	/* application + primitive   + 16 */</span>
<a href="#l12.110"></a><span id="l12.110" class="difflineminus">-#define LDAP_REQ_EXTENDED	0x77L	/* application + constructed + 23 */</span>
<a href="#l12.111"></a><span id="l12.111" class="difflineplus">+#define LDAP_REQ_BIND 0x60L  /* application + constructed + 0 */</span>
<a href="#l12.112"></a><span id="l12.112" class="difflineplus">+#define LDAP_REQ_UNBIND 0x42L  /* application + primitive   + 2 */</span>
<a href="#l12.113"></a><span id="l12.113" class="difflineplus">+#define LDAP_REQ_SEARCH 0x63L  /* application + constructed + 3 */</span>
<a href="#l12.114"></a><span id="l12.114" class="difflineplus">+#define LDAP_REQ_MODIFY 0x66L  /* application + constructed + 6 */</span>
<a href="#l12.115"></a><span id="l12.115" class="difflineplus">+#define LDAP_REQ_ADD 0x68L  /* application + constructed + 8 */</span>
<a href="#l12.116"></a><span id="l12.116" class="difflineplus">+#define LDAP_REQ_DELETE 0x4aL  /* application + primitive   + 10 */</span>
<a href="#l12.117"></a><span id="l12.117" class="difflineplus">+#define LDAP_REQ_MODRDN 0x6cL  /* application + constructed + 12 */</span>
<a href="#l12.118"></a><span id="l12.118" class="difflineplus">+#define LDAP_REQ_MODDN 0x6cL  /* application + constructed + 12 */</span>
<a href="#l12.119"></a><span id="l12.119" class="difflineplus">+#define LDAP_REQ_RENAME 0x6cL  /* application + constructed + 12 */</span>
<a href="#l12.120"></a><span id="l12.120" class="difflineplus">+#define LDAP_REQ_COMPARE 0x6eL  /* application + constructed + 14 */</span>
<a href="#l12.121"></a><span id="l12.121" class="difflineplus">+#define LDAP_REQ_ABANDON 0x50L  /* application + primitive   + 16 */</span>
<a href="#l12.122"></a><span id="l12.122" class="difflineplus">+#define LDAP_REQ_EXTENDED 0x77L  /* application + constructed + 23 */</span>
<a href="#l12.123"></a><span id="l12.123"> </span>
<a href="#l12.124"></a><span id="l12.124"> /* U-M LDAP release 3.0 compatibility stuff */</span>
<a href="#l12.125"></a><span id="l12.125" class="difflineminus">-#define LDAP_REQ_UNBIND_30	0x62L</span>
<a href="#l12.126"></a><span id="l12.126" class="difflineminus">-#define LDAP_REQ_DELETE_30	0x6aL</span>
<a href="#l12.127"></a><span id="l12.127" class="difflineminus">-#define LDAP_REQ_ABANDON_30	0x70L</span>
<a href="#l12.128"></a><span id="l12.128" class="difflineplus">+#define LDAP_REQ_UNBIND_30 0x62L</span>
<a href="#l12.129"></a><span id="l12.129" class="difflineplus">+#define LDAP_REQ_DELETE_30 0x6aL</span>
<a href="#l12.130"></a><span id="l12.130" class="difflineplus">+#define LDAP_REQ_ABANDON_30 0x70L</span>
<a href="#l12.131"></a><span id="l12.131"> </span>
<a href="#l12.132"></a><span id="l12.132"> /*</span>
<a href="#l12.133"></a><span id="l12.133">  * old broken stuff for backwards compatibility - forgot application tag</span>
<a href="#l12.134"></a><span id="l12.134">  * and constructed/primitive bit</span>
<a href="#l12.135"></a><span id="l12.135">  */</span>
<a href="#l12.136"></a><span id="l12.136" class="difflineminus">-#define OLD_LDAP_REQ_BIND	0x00L</span>
<a href="#l12.137"></a><span id="l12.137" class="difflineminus">-#define OLD_LDAP_REQ_UNBIND	0x02L</span>
<a href="#l12.138"></a><span id="l12.138" class="difflineminus">-#define OLD_LDAP_REQ_SEARCH	0x03L</span>
<a href="#l12.139"></a><span id="l12.139" class="difflineminus">-#define OLD_LDAP_REQ_MODIFY	0x06L</span>
<a href="#l12.140"></a><span id="l12.140" class="difflineminus">-#define OLD_LDAP_REQ_ADD	0x08L</span>
<a href="#l12.141"></a><span id="l12.141" class="difflineminus">-#define OLD_LDAP_REQ_DELETE	0x0aL</span>
<a href="#l12.142"></a><span id="l12.142" class="difflineminus">-#define OLD_LDAP_REQ_MODRDN	0x0cL</span>
<a href="#l12.143"></a><span id="l12.143" class="difflineminus">-#define OLD_LDAP_REQ_MODDN	0x0cL</span>
<a href="#l12.144"></a><span id="l12.144" class="difflineminus">-#define OLD_LDAP_REQ_COMPARE	0x0eL</span>
<a href="#l12.145"></a><span id="l12.145" class="difflineminus">-#define OLD_LDAP_REQ_ABANDON	0x10L</span>
<a href="#l12.146"></a><span id="l12.146" class="difflineplus">+#define OLD_LDAP_REQ_BIND 0x00L</span>
<a href="#l12.147"></a><span id="l12.147" class="difflineplus">+#define OLD_LDAP_REQ_UNBIND 0x02L</span>
<a href="#l12.148"></a><span id="l12.148" class="difflineplus">+#define OLD_LDAP_REQ_SEARCH 0x03L</span>
<a href="#l12.149"></a><span id="l12.149" class="difflineplus">+#define OLD_LDAP_REQ_MODIFY 0x06L</span>
<a href="#l12.150"></a><span id="l12.150" class="difflineplus">+#define OLD_LDAP_REQ_ADD 0x08L</span>
<a href="#l12.151"></a><span id="l12.151" class="difflineplus">+#define OLD_LDAP_REQ_DELETE 0x0aL</span>
<a href="#l12.152"></a><span id="l12.152" class="difflineplus">+#define OLD_LDAP_REQ_MODRDN 0x0cL</span>
<a href="#l12.153"></a><span id="l12.153" class="difflineplus">+#define OLD_LDAP_REQ_MODDN 0x0cL</span>
<a href="#l12.154"></a><span id="l12.154" class="difflineplus">+#define OLD_LDAP_REQ_COMPARE 0x0eL</span>
<a href="#l12.155"></a><span id="l12.155" class="difflineplus">+#define OLD_LDAP_REQ_ABANDON 0x10L</span>
<a href="#l12.156"></a><span id="l12.156"> </span>
<a href="#l12.157"></a><span id="l12.157"> /* old broken stuff for backwards compatibility */</span>
<a href="#l12.158"></a><span id="l12.158" class="difflineminus">-#define OLD_LDAP_RES_BIND		0x01L</span>
<a href="#l12.159"></a><span id="l12.159" class="difflineminus">-#define OLD_LDAP_RES_SEARCH_ENTRY	0x04L</span>
<a href="#l12.160"></a><span id="l12.160" class="difflineminus">-#define OLD_LDAP_RES_SEARCH_RESULT	0x05L</span>
<a href="#l12.161"></a><span id="l12.161" class="difflineminus">-#define OLD_LDAP_RES_MODIFY		0x07L</span>
<a href="#l12.162"></a><span id="l12.162" class="difflineminus">-#define OLD_LDAP_RES_ADD		0x09L</span>
<a href="#l12.163"></a><span id="l12.163" class="difflineminus">-#define OLD_LDAP_RES_DELETE		0x0bL</span>
<a href="#l12.164"></a><span id="l12.164" class="difflineminus">-#define OLD_LDAP_RES_MODRDN		0x0dL</span>
<a href="#l12.165"></a><span id="l12.165" class="difflineminus">-#define OLD_LDAP_RES_MODDN		0x0dL</span>
<a href="#l12.166"></a><span id="l12.166" class="difflineminus">-#define OLD_LDAP_RES_COMPARE		0x0fL</span>
<a href="#l12.167"></a><span id="l12.167" class="difflineplus">+#define OLD_LDAP_RES_BIND 0x01L</span>
<a href="#l12.168"></a><span id="l12.168" class="difflineplus">+#define OLD_LDAP_RES_SEARCH_ENTRY 0x04L</span>
<a href="#l12.169"></a><span id="l12.169" class="difflineplus">+#define OLD_LDAP_RES_SEARCH_RESULT 0x05L</span>
<a href="#l12.170"></a><span id="l12.170" class="difflineplus">+#define OLD_LDAP_RES_MODIFY 0x07L</span>
<a href="#l12.171"></a><span id="l12.171" class="difflineplus">+#define OLD_LDAP_RES_ADD 0x09L</span>
<a href="#l12.172"></a><span id="l12.172" class="difflineplus">+#define OLD_LDAP_RES_DELETE 0x0bL</span>
<a href="#l12.173"></a><span id="l12.173" class="difflineplus">+#define OLD_LDAP_RES_MODRDN 0x0dL</span>
<a href="#l12.174"></a><span id="l12.174" class="difflineplus">+#define OLD_LDAP_RES_MODDN 0x0dL</span>
<a href="#l12.175"></a><span id="l12.175" class="difflineplus">+#define OLD_LDAP_RES_COMPARE 0x0fL</span>
<a href="#l12.176"></a><span id="l12.176"> </span>
<a href="#l12.177"></a><span id="l12.177"> /* U-M LDAP 3.0 compatibility auth methods */</span>
<a href="#l12.178"></a><span id="l12.178" class="difflineminus">-#define LDAP_AUTH_SIMPLE_30	0xa0L	/* context specific + constructed */</span>
<a href="#l12.179"></a><span id="l12.179" class="difflineminus">-#define LDAP_AUTH_KRBV41_30	0xa1L	/* context specific + constructed */</span>
<a href="#l12.180"></a><span id="l12.180" class="difflineminus">-#define LDAP_AUTH_KRBV42_30	0xa2L	/* context specific + constructed */</span>
<a href="#l12.181"></a><span id="l12.181" class="difflineplus">+#define LDAP_AUTH_SIMPLE_30 0xa0L  /* context specific + constructed */</span>
<a href="#l12.182"></a><span id="l12.182" class="difflineplus">+#define LDAP_AUTH_KRBV41_30 0xa1L  /* context specific + constructed */</span>
<a href="#l12.183"></a><span id="l12.183" class="difflineplus">+#define LDAP_AUTH_KRBV42_30 0xa2L  /* context specific + constructed */</span>
<a href="#l12.184"></a><span id="l12.184"> </span>
<a href="#l12.185"></a><span id="l12.185"> /* old broken stuff */</span>
<a href="#l12.186"></a><span id="l12.186" class="difflineminus">-#define OLD_LDAP_AUTH_SIMPLE	0x00L</span>
<a href="#l12.187"></a><span id="l12.187" class="difflineminus">-#define OLD_LDAP_AUTH_KRBV4	0x01L</span>
<a href="#l12.188"></a><span id="l12.188" class="difflineminus">-#define OLD_LDAP_AUTH_KRBV42	0x02L</span>
<a href="#l12.189"></a><span id="l12.189" class="difflineplus">+#define OLD_LDAP_AUTH_SIMPLE 0x00L</span>
<a href="#l12.190"></a><span id="l12.190" class="difflineplus">+#define OLD_LDAP_AUTH_KRBV4 0x01L</span>
<a href="#l12.191"></a><span id="l12.191" class="difflineplus">+#define OLD_LDAP_AUTH_KRBV42 0x02L</span>
<a href="#l12.192"></a><span id="l12.192"> </span>
<a href="#l12.193"></a><span id="l12.193"> /* U-M LDAP 3.0 compatibility filter types */</span>
<a href="#l12.194"></a><span id="l12.194" class="difflineminus">-#define LDAP_FILTER_PRESENT_30	0xa7L	/* context specific + constructed */</span>
<a href="#l12.195"></a><span id="l12.195" class="difflineplus">+#define LDAP_FILTER_PRESENT_30 0xa7L  /* context specific + constructed */</span>
<a href="#l12.196"></a><span id="l12.196"> </span>
<a href="#l12.197"></a><span id="l12.197"> /* filter types */</span>
<a href="#l12.198"></a><span id="l12.198" class="difflineminus">-#define LDAP_FILTER_AND		0xa0L	/* context specific + constructed + 0 */</span>
<a href="#l12.199"></a><span id="l12.199" class="difflineminus">-#define LDAP_FILTER_OR		0xa1L	/* context specific + constructed + 1 */</span>
<a href="#l12.200"></a><span id="l12.200" class="difflineminus">-#define LDAP_FILTER_NOT		0xa2L	/* context specific + constructed + 2 */</span>
<a href="#l12.201"></a><span id="l12.201" class="difflineminus">-#define LDAP_FILTER_EQUALITY	0xa3L	/* context specific + constructed + 3 */</span>
<a href="#l12.202"></a><span id="l12.202" class="difflineminus">-#define LDAP_FILTER_SUBSTRINGS	0xa4L	/* context specific + constructed + 4 */</span>
<a href="#l12.203"></a><span id="l12.203" class="difflineminus">-#define LDAP_FILTER_GE		0xa5L	/* context specific + constructed + 5 */</span>
<a href="#l12.204"></a><span id="l12.204" class="difflineminus">-#define LDAP_FILTER_LE		0xa6L	/* context specific + constructed + 6 */</span>
<a href="#l12.205"></a><span id="l12.205" class="difflineminus">-#define LDAP_FILTER_PRESENT	0x87L	/* context specific + primitive   + 7 */</span>
<a href="#l12.206"></a><span id="l12.206" class="difflineminus">-#define LDAP_FILTER_APPROX	0xa8L	/* context specific + constructed + 8 */</span>
<a href="#l12.207"></a><span id="l12.207" class="difflineminus">-#define LDAP_FILTER_EXTENDED	0xa9L	/* context specific + constructed + 0 */</span>
<a href="#l12.208"></a><span id="l12.208" class="difflineplus">+#define LDAP_FILTER_AND 0xa0L  /* context specific + constructed + 0 */</span>
<a href="#l12.209"></a><span id="l12.209" class="difflineplus">+#define LDAP_FILTER_OR 0xa1L  /* context specific + constructed + 1 */</span>
<a href="#l12.210"></a><span id="l12.210" class="difflineplus">+#define LDAP_FILTER_NOT 0xa2L  /* context specific + constructed + 2 */</span>
<a href="#l12.211"></a><span id="l12.211" class="difflineplus">+#define LDAP_FILTER_EQUALITY 0xa3L  /* context specific + constructed + 3 */</span>
<a href="#l12.212"></a><span id="l12.212" class="difflineplus">+#define LDAP_FILTER_SUBSTRINGS 0xa4L  /* context specific + constructed + 4 */</span>
<a href="#l12.213"></a><span id="l12.213" class="difflineplus">+#define LDAP_FILTER_GE 0xa5L  /* context specific + constructed + 5 */</span>
<a href="#l12.214"></a><span id="l12.214" class="difflineplus">+#define LDAP_FILTER_LE 0xa6L  /* context specific + constructed + 6 */</span>
<a href="#l12.215"></a><span id="l12.215" class="difflineplus">+#define LDAP_FILTER_PRESENT 0x87L  /* context specific + primitive   + 7 */</span>
<a href="#l12.216"></a><span id="l12.216" class="difflineplus">+#define LDAP_FILTER_APPROX 0xa8L  /* context specific + constructed + 8 */</span>
<a href="#l12.217"></a><span id="l12.217" class="difflineplus">+#define LDAP_FILTER_EXTENDED 0xa9L  /* context specific + constructed + 0 */</span>
<a href="#l12.218"></a><span id="l12.218"> </span>
<a href="#l12.219"></a><span id="l12.219"> /* old broken stuff */</span>
<a href="#l12.220"></a><span id="l12.220" class="difflineminus">-#define OLD_LDAP_FILTER_AND		0x00L</span>
<a href="#l12.221"></a><span id="l12.221" class="difflineminus">-#define OLD_LDAP_FILTER_OR		0x01L</span>
<a href="#l12.222"></a><span id="l12.222" class="difflineminus">-#define OLD_LDAP_FILTER_NOT		0x02L</span>
<a href="#l12.223"></a><span id="l12.223" class="difflineminus">-#define OLD_LDAP_FILTER_EQUALITY	0x03L</span>
<a href="#l12.224"></a><span id="l12.224" class="difflineminus">-#define OLD_LDAP_FILTER_SUBSTRINGS	0x04L</span>
<a href="#l12.225"></a><span id="l12.225" class="difflineminus">-#define OLD_LDAP_FILTER_GE		0x05L</span>
<a href="#l12.226"></a><span id="l12.226" class="difflineminus">-#define OLD_LDAP_FILTER_LE		0x06L</span>
<a href="#l12.227"></a><span id="l12.227" class="difflineminus">-#define OLD_LDAP_FILTER_PRESENT		0x07L</span>
<a href="#l12.228"></a><span id="l12.228" class="difflineminus">-#define OLD_LDAP_FILTER_APPROX		0x08L</span>
<a href="#l12.229"></a><span id="l12.229" class="difflineplus">+#define OLD_LDAP_FILTER_AND 0x00L</span>
<a href="#l12.230"></a><span id="l12.230" class="difflineplus">+#define OLD_LDAP_FILTER_OR 0x01L</span>
<a href="#l12.231"></a><span id="l12.231" class="difflineplus">+#define OLD_LDAP_FILTER_NOT 0x02L</span>
<a href="#l12.232"></a><span id="l12.232" class="difflineplus">+#define OLD_LDAP_FILTER_EQUALITY 0x03L</span>
<a href="#l12.233"></a><span id="l12.233" class="difflineplus">+#define OLD_LDAP_FILTER_SUBSTRINGS 0x04L</span>
<a href="#l12.234"></a><span id="l12.234" class="difflineplus">+#define OLD_LDAP_FILTER_GE 0x05L</span>
<a href="#l12.235"></a><span id="l12.235" class="difflineplus">+#define OLD_LDAP_FILTER_LE 0x06L</span>
<a href="#l12.236"></a><span id="l12.236" class="difflineplus">+#define OLD_LDAP_FILTER_PRESENT 0x07L</span>
<a href="#l12.237"></a><span id="l12.237" class="difflineplus">+#define OLD_LDAP_FILTER_APPROX 0x08L</span>
<a href="#l12.238"></a><span id="l12.238"> </span>
<a href="#l12.239"></a><span id="l12.239"> /* substring filter component types */</span>
<a href="#l12.240"></a><span id="l12.240" class="difflineminus">-#define LDAP_SUBSTRING_INITIAL	0x80L	/* context specific + primitive + 0 */</span>
<a href="#l12.241"></a><span id="l12.241" class="difflineminus">-#define LDAP_SUBSTRING_ANY	0x81L	/* context specific + primitive + 1 */</span>
<a href="#l12.242"></a><span id="l12.242" class="difflineminus">-#define LDAP_SUBSTRING_FINAL	0x82L	/* context specific + primitive + 2 */</span>
<a href="#l12.243"></a><span id="l12.243" class="difflineplus">+#define LDAP_SUBSTRING_INITIAL 0x80L  /* context specific + primitive + 0 */</span>
<a href="#l12.244"></a><span id="l12.244" class="difflineplus">+#define LDAP_SUBSTRING_ANY 0x81L  /* context specific + primitive + 1 */</span>
<a href="#l12.245"></a><span id="l12.245" class="difflineplus">+#define LDAP_SUBSTRING_FINAL 0x82L  /* context specific + primitive + 2 */</span>
<a href="#l12.246"></a><span id="l12.246"> </span>
<a href="#l12.247"></a><span id="l12.247"> /* extended filter component types */</span>
<a href="#l12.248"></a><span id="l12.248" class="difflineminus">-#define LDAP_FILTER_EXTENDED_OID	0x81L	/* context spec. + prim. + 1 */</span>
<a href="#l12.249"></a><span id="l12.249" class="difflineminus">-#define LDAP_FILTER_EXTENDED_TYPE	0x82L	/* context spec. + prim. + 2 */</span>
<a href="#l12.250"></a><span id="l12.250" class="difflineminus">-#define LDAP_FILTER_EXTENDED_VALUE	0x83L	/* context spec. + prim. + 3 */</span>
<a href="#l12.251"></a><span id="l12.251" class="difflineminus">-#define LDAP_FILTER_EXTENDED_DNATTRS	0x84L	/* context spec. + prim. + 4 */</span>
<a href="#l12.252"></a><span id="l12.252" class="difflineplus">+#define LDAP_FILTER_EXTENDED_OID 0x81L  /* context spec. + prim. + 1 */</span>
<a href="#l12.253"></a><span id="l12.253" class="difflineplus">+#define LDAP_FILTER_EXTENDED_TYPE 0x82L  /* context spec. + prim. + 2 */</span>
<a href="#l12.254"></a><span id="l12.254" class="difflineplus">+#define LDAP_FILTER_EXTENDED_VALUE 0x83L  /* context spec. + prim. + 3 */</span>
<a href="#l12.255"></a><span id="l12.255" class="difflineplus">+#define LDAP_FILTER_EXTENDED_DNATTRS 0x84L  /* context spec. + prim. + 4 */</span>
<a href="#l12.256"></a><span id="l12.256"> </span>
<a href="#l12.257"></a><span id="l12.257"> /* U-M LDAP 3.0 compatibility substring filter component types */</span>
<a href="#l12.258"></a><span id="l12.258" class="difflineminus">-#define LDAP_SUBSTRING_INITIAL_30	0xa0L	/* context specific */</span>
<a href="#l12.259"></a><span id="l12.259" class="difflineminus">-#define LDAP_SUBSTRING_ANY_30		0xa1L	/* context specific */</span>
<a href="#l12.260"></a><span id="l12.260" class="difflineminus">-#define LDAP_SUBSTRING_FINAL_30		0xa2L	/* context specific */</span>
<a href="#l12.261"></a><span id="l12.261" class="difflineplus">+#define LDAP_SUBSTRING_INITIAL_30 0xa0L  /* context specific */</span>
<a href="#l12.262"></a><span id="l12.262" class="difflineplus">+#define LDAP_SUBSTRING_ANY_30 0xa1L  /* context specific */</span>
<a href="#l12.263"></a><span id="l12.263" class="difflineplus">+#define LDAP_SUBSTRING_FINAL_30 0xa2L  /* context specific */</span>
<a href="#l12.264"></a><span id="l12.264"> </span>
<a href="#l12.265"></a><span id="l12.265"> /* old broken stuff */</span>
<a href="#l12.266"></a><span id="l12.266" class="difflineminus">-#define OLD_LDAP_SUBSTRING_INITIAL	0x00L</span>
<a href="#l12.267"></a><span id="l12.267" class="difflineminus">-#define OLD_LDAP_SUBSTRING_ANY		0x01L</span>
<a href="#l12.268"></a><span id="l12.268" class="difflineminus">-#define OLD_LDAP_SUBSTRING_FINAL	0x02L</span>
<a href="#l12.269"></a><span id="l12.269" class="difflineplus">+#define OLD_LDAP_SUBSTRING_INITIAL 0x00L</span>
<a href="#l12.270"></a><span id="l12.270" class="difflineplus">+#define OLD_LDAP_SUBSTRING_ANY 0x01L</span>
<a href="#l12.271"></a><span id="l12.271" class="difflineplus">+#define OLD_LDAP_SUBSTRING_FINAL 0x02L</span>
<a href="#l12.272"></a><span id="l12.272"> </span>
<a href="#l12.273"></a><span id="l12.273"> #ifdef __cplusplus</span>
<a href="#l12.274"></a><span id="l12.274"> }</span>
<a href="#l12.275"></a><span id="l12.275"> #endif</span>
<a href="#l12.276"></a><span id="l12.276"> #endif /* _LDAPROT_H */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/ldap/c-sdk/include/ldif.h</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/ldap/c-sdk/include/ldif.h</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -56,59 +56,59 @@</span>
<a href="#l13.4"></a><span id="l13.4"> </span>
<a href="#l13.5"></a><span id="l13.5"> #ifndef _LDIF_H</span>
<a href="#l13.6"></a><span id="l13.6"> #define _LDIF_H</span>
<a href="#l13.7"></a><span id="l13.7"> </span>
<a href="#l13.8"></a><span id="l13.8"> #ifdef __cplusplus</span>
<a href="#l13.9"></a><span id="l13.9"> extern &quot;C&quot; {</span>
<a href="#l13.10"></a><span id="l13.10"> #endif</span>
<a href="#l13.11"></a><span id="l13.11"> </span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-#define LDIF_VERSION_ONE        1	/* LDIF standard version */</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+#define LDIF_VERSION_ONE        1  /* LDIF standard version */</span>
<a href="#l13.14"></a><span id="l13.14"> </span>
<a href="#l13.15"></a><span id="l13.15"> #define LDIF_MAX_LINE_WIDTH      76      /* maximum length of LDIF lines */</span>
<a href="#l13.16"></a><span id="l13.16"> </span>
<a href="#l13.17"></a><span id="l13.17"> /*</span>
<a href="#l13.18"></a><span id="l13.18">  * Macro to calculate maximum number of bytes that the base64 equivalent</span>
<a href="#l13.19"></a><span id="l13.19">  * of an item that is &quot;vlen&quot; bytes long will take up.  Base64 encoding</span>
<a href="#l13.20"></a><span id="l13.20">  * uses one byte for every six bits in the value plus up to two pad bytes.</span>
<a href="#l13.21"></a><span id="l13.21">  */</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineminus">-#define LDIF_BASE64_LEN(vlen)	(((vlen) * 4 / 3 ) + 3)</span>
<a href="#l13.23"></a><span id="l13.23" class="difflineplus">+#define LDIF_BASE64_LEN(vlen) (((vlen) * 4 / 3 ) + 3)</span>
<a href="#l13.24"></a><span id="l13.24"> </span>
<a href="#l13.25"></a><span id="l13.25"> /*</span>
<a href="#l13.26"></a><span id="l13.26">  * Macro to calculate maximum size that an LDIF-encoded type (length</span>
<a href="#l13.27"></a><span id="l13.27">  * tlen) and value (length vlen) will take up:  room for type + &quot;:: &quot; +</span>
<a href="#l13.28"></a><span id="l13.28">  * first newline + base64 value + continued lines.  Each continued line</span>
<a href="#l13.29"></a><span id="l13.29">  * needs room for a newline and a leading space character.</span>
<a href="#l13.30"></a><span id="l13.30">  */</span>
<a href="#l13.31"></a><span id="l13.31"> #define LDIF_SIZE_NEEDED(tlen,vlen) \</span>
<a href="#l13.32"></a><span id="l13.32">     ((tlen) + 4 + LDIF_BASE64_LEN(vlen) \</span>
<a href="#l13.33"></a><span id="l13.33">     + ((LDIF_BASE64_LEN(vlen) + tlen + 3) / LDIF_MAX_LINE_WIDTH * 2 ))</span>
<a href="#l13.34"></a><span id="l13.34"> </span>
<a href="#l13.35"></a><span id="l13.35"> /*</span>
<a href="#l13.36"></a><span id="l13.36">  * Options for ldif_put_type_and_value_with_options() and</span>
<a href="#l13.37"></a><span id="l13.37">  * ldif_type_and_value_with_options().</span>
<a href="#l13.38"></a><span id="l13.38">  */</span>
<a href="#l13.39"></a><span id="l13.39" class="difflineminus">-#define LDIF_OPT_NOWRAP			0x01UL</span>
<a href="#l13.40"></a><span id="l13.40" class="difflineminus">-#define LDIF_OPT_VALUE_IS_URL		0x02UL</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineminus">-#define LDIF_OPT_MINIMAL_ENCODING	0x04UL</span>
<a href="#l13.42"></a><span id="l13.42" class="difflineplus">+#define LDIF_OPT_NOWRAP 0x01UL</span>
<a href="#l13.43"></a><span id="l13.43" class="difflineplus">+#define LDIF_OPT_VALUE_IS_URL 0x02UL</span>
<a href="#l13.44"></a><span id="l13.44" class="difflineplus">+#define LDIF_OPT_MINIMAL_ENCODING 0x04UL</span>
<a href="#l13.45"></a><span id="l13.45"> </span>
<a href="#l13.46"></a><span id="l13.46"> int ldif_parse_line( char *line, char **type, char **value, int *vlen);</span>
<a href="#l13.47"></a><span id="l13.47"> char * ldif_getline( char **next );</span>
<a href="#l13.48"></a><span id="l13.48"> void ldif_put_type_and_value( char **out, char *t, char *val, int vlen );</span>
<a href="#l13.49"></a><span id="l13.49"> void ldif_put_type_and_value_nowrap( char **out, char *t, char *val, int vlen );</span>
<a href="#l13.50"></a><span id="l13.50"> void ldif_put_type_and_value_with_options( char **out, char *t, char *val,</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineminus">-	int vlen, unsigned long options );</span>
<a href="#l13.52"></a><span id="l13.52" class="difflineplus">+  int vlen, unsigned long options );</span>
<a href="#l13.53"></a><span id="l13.53"> char *ldif_type_and_value( char *type, char *val, int vlen );</span>
<a href="#l13.54"></a><span id="l13.54"> char *ldif_type_and_value_nowrap( char *type, char *val, int vlen );</span>
<a href="#l13.55"></a><span id="l13.55"> char *ldif_type_and_value_with_options( char *type, char *val, int vlen,</span>
<a href="#l13.56"></a><span id="l13.56" class="difflineminus">-	unsigned long options );</span>
<a href="#l13.57"></a><span id="l13.57" class="difflineplus">+  unsigned long options );</span>
<a href="#l13.58"></a><span id="l13.58"> int ldif_base64_decode( char *src, unsigned char *dst );</span>
<a href="#l13.59"></a><span id="l13.59"> int ldif_base64_encode( unsigned char *src, char *dst, int srclen,</span>
<a href="#l13.60"></a><span id="l13.60" class="difflineminus">-	int lenused );</span>
<a href="#l13.61"></a><span id="l13.61" class="difflineplus">+  int lenused );</span>
<a href="#l13.62"></a><span id="l13.62"> int ldif_base64_encode_nowrap( unsigned char *src, char *dst, int srclen,</span>
<a href="#l13.63"></a><span id="l13.63" class="difflineminus">-	int lenused );</span>
<a href="#l13.64"></a><span id="l13.64" class="difflineplus">+  int lenused );</span>
<a href="#l13.65"></a><span id="l13.65"> char *ldif_get_entry( FILE *fp, int *lineno );</span>
<a href="#l13.66"></a><span id="l13.66"> </span>
<a href="#l13.67"></a><span id="l13.67"> #ifdef __cplusplus</span>
<a href="#l13.68"></a><span id="l13.68"> }</span>
<a href="#l13.69"></a><span id="l13.69"> #endif</span>
<a href="#l13.70"></a><span id="l13.70"> </span>
<a href="#l13.71"></a><span id="l13.71"> #endif /* _LDIF_H */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/ldap/c-sdk/include/portable.h</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/ldap/c-sdk/include/portable.h</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -99,28 +99,28 @@</span>
<a href="#l14.4"></a><span id="l14.4"> #if !defined( USE_WAITPID ) &amp;&amp; ( defined( SYSV ) || defined( sunos4 ) || defined( ultrix ) || defined( aix ))</span>
<a href="#l14.5"></a><span id="l14.5"> #define USE_WAITPID</span>
<a href="#l14.6"></a><span id="l14.6"> #endif</span>
<a href="#l14.7"></a><span id="l14.7"> </span>
<a href="#l14.8"></a><span id="l14.8"> /*</span>
<a href="#l14.9"></a><span id="l14.9">  * define the wait status argument type</span>
<a href="#l14.10"></a><span id="l14.10">  */</span>
<a href="#l14.11"></a><span id="l14.11"> #if ( defined( SunOS ) &amp;&amp; SunOS &lt; 40 ) || defined( nextstep )</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-#define WAITSTATUSTYPE	union wait</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+#define WAITSTATUSTYPE union wait</span>
<a href="#l14.14"></a><span id="l14.14"> #else</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineminus">-#define WAITSTATUSTYPE	int</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineplus">+#define WAITSTATUSTYPE int</span>
<a href="#l14.17"></a><span id="l14.17"> #endif</span>
<a href="#l14.18"></a><span id="l14.18"> </span>
<a href="#l14.19"></a><span id="l14.19"> /*</span>
<a href="#l14.20"></a><span id="l14.20">  * defined the options for openlog (syslog)</span>
<a href="#l14.21"></a><span id="l14.21">  */</span>
<a href="#l14.22"></a><span id="l14.22"> #ifdef ultrix</span>
<a href="#l14.23"></a><span id="l14.23" class="difflineminus">-#define OPENLOG_OPTIONS		LOG_PID</span>
<a href="#l14.24"></a><span id="l14.24" class="difflineplus">+#define OPENLOG_OPTIONS LOG_PID</span>
<a href="#l14.25"></a><span id="l14.25"> #else</span>
<a href="#l14.26"></a><span id="l14.26" class="difflineminus">-#define OPENLOG_OPTIONS		( LOG_PID | LOG_NOWAIT )</span>
<a href="#l14.27"></a><span id="l14.27" class="difflineplus">+#define OPENLOG_OPTIONS ( LOG_PID | LOG_NOWAIT )</span>
<a href="#l14.28"></a><span id="l14.28"> #endif</span>
<a href="#l14.29"></a><span id="l14.29"> </span>
<a href="#l14.30"></a><span id="l14.30"> /*</span>
<a href="#l14.31"></a><span id="l14.31">  * some systems don't have the BSD re_comp and re_exec routines</span>
<a href="#l14.32"></a><span id="l14.32">  */</span>
<a href="#l14.33"></a><span id="l14.33"> #ifndef NEED_BSDREGEX</span>
<a href="#l14.34"></a><span id="l14.34"> #if ( defined( SYSV ) || defined( NETBSD ) || defined( FREEBSD ) || defined(__OpenBSD__) || defined( linux ) || defined( DARWIN )) &amp;&amp; !defined(sgi)</span>
<a href="#l14.35"></a><span id="l14.35"> #define NEED_BSDREGEX</span>
<a href="#l14.36"></a><span id="l14.36" class="difflineat">@@ -185,91 +185,91 @@</span>
<a href="#l14.37"></a><span id="l14.37"> #endif /* !WINSOCK &amp;&amp; !_WINDOWS &amp;&amp; !macintosh */</span>
<a href="#l14.38"></a><span id="l14.38"> </span>
<a href="#l14.39"></a><span id="l14.39"> </span>
<a href="#l14.40"></a><span id="l14.40"> /*</span>
<a href="#l14.41"></a><span id="l14.41">  * for connect() -- must we block signals when calling connect()?  This</span>
<a href="#l14.42"></a><span id="l14.42">  * is necessary on some buggy UNIXes.</span>
<a href="#l14.43"></a><span id="l14.43">  */</span>
<a href="#l14.44"></a><span id="l14.44"> #if !defined(NSLDAPI_CONNECT_MUST_NOT_BE_INTERRUPTED) &amp;&amp; \</span>
<a href="#l14.45"></a><span id="l14.45" class="difflineminus">-	( defined(AIX) || defined(IRIX) || defined(HPUX) || defined(SUNOS4) \</span>
<a href="#l14.46"></a><span id="l14.46" class="difflineminus">-	|| defined(SOLARIS) || defined(OSF1) ||defined(freebsd))</span>
<a href="#l14.47"></a><span id="l14.47" class="difflineplus">+  ( defined(AIX) || defined(IRIX) || defined(HPUX) || defined(SUNOS4) \</span>
<a href="#l14.48"></a><span id="l14.48" class="difflineplus">+  || defined(SOLARIS) || defined(OSF1) ||defined(freebsd))</span>
<a href="#l14.49"></a><span id="l14.49"> #define NSLDAPI_CONNECT_MUST_NOT_BE_INTERRUPTED</span>
<a href="#l14.50"></a><span id="l14.50"> #endif</span>
<a href="#l14.51"></a><span id="l14.51"> </span>
<a href="#l14.52"></a><span id="l14.52"> /*</span>
<a href="#l14.53"></a><span id="l14.53">  * On most platforms, sigprocmask() works fine even in multithreaded code.</span>
<a href="#l14.54"></a><span id="l14.54">  * But not everywhere.</span>
<a href="#l14.55"></a><span id="l14.55">  */</span>
<a href="#l14.56"></a><span id="l14.56"> #ifdef AIX</span>
<a href="#l14.57"></a><span id="l14.57" class="difflineminus">-#define NSLDAPI_MT_SAFE_SIGPROCMASK(h,s,o)	sigthreadmask(h,s,o)</span>
<a href="#l14.58"></a><span id="l14.58" class="difflineplus">+#define NSLDAPI_MT_SAFE_SIGPROCMASK(h,s,o) sigthreadmask(h,s,o)</span>
<a href="#l14.59"></a><span id="l14.59"> #else</span>
<a href="#l14.60"></a><span id="l14.60" class="difflineminus">-#define NSLDAPI_MT_SAFE_SIGPROCMASK(h,s,o)	sigprocmask(h,s,o)</span>
<a href="#l14.61"></a><span id="l14.61" class="difflineplus">+#define NSLDAPI_MT_SAFE_SIGPROCMASK(h,s,o) sigprocmask(h,s,o)</span>
<a href="#l14.62"></a><span id="l14.62"> #endif</span>
<a href="#l14.63"></a><span id="l14.63"> </span>
<a href="#l14.64"></a><span id="l14.64"> /*</span>
<a href="#l14.65"></a><span id="l14.65">  * toupper and tolower macros are different under bsd and sys v</span>
<a href="#l14.66"></a><span id="l14.66">  */</span>
<a href="#l14.67"></a><span id="l14.67"> #if defined( SYSV ) &amp;&amp; !defined( hpux )</span>
<a href="#l14.68"></a><span id="l14.68" class="difflineminus">-#define TOUPPER(c)	(isascii(c) &amp;&amp; islower(c) ? _toupper(c) : c)</span>
<a href="#l14.69"></a><span id="l14.69" class="difflineminus">-#define TOLOWER(c)	(isascii(c) &amp;&amp; isupper(c) ? _tolower(c) : c)</span>
<a href="#l14.70"></a><span id="l14.70" class="difflineplus">+#define TOUPPER(c) (isascii(c) &amp;&amp; islower(c) ? _toupper(c) : c)</span>
<a href="#l14.71"></a><span id="l14.71" class="difflineplus">+#define TOLOWER(c) (isascii(c) &amp;&amp; isupper(c) ? _tolower(c) : c)</span>
<a href="#l14.72"></a><span id="l14.72"> #else</span>
<a href="#l14.73"></a><span id="l14.73" class="difflineminus">-#define TOUPPER(c)	(isascii(c) &amp;&amp; islower(c) ? toupper(c) : c)</span>
<a href="#l14.74"></a><span id="l14.74" class="difflineminus">-#define TOLOWER(c)	(isascii(c) &amp;&amp; isupper(c) ? tolower(c) : c)</span>
<a href="#l14.75"></a><span id="l14.75" class="difflineplus">+#define TOUPPER(c) (isascii(c) &amp;&amp; islower(c) ? toupper(c) : c)</span>
<a href="#l14.76"></a><span id="l14.76" class="difflineplus">+#define TOLOWER(c) (isascii(c) &amp;&amp; isupper(c) ? tolower(c) : c)</span>
<a href="#l14.77"></a><span id="l14.77"> #endif</span>
<a href="#l14.78"></a><span id="l14.78"> </span>
<a href="#l14.79"></a><span id="l14.79"> /*</span>
<a href="#l14.80"></a><span id="l14.80">  * put a cover on the tty-related ioctl calls we need to use</span>
<a href="#l14.81"></a><span id="l14.81">  */</span>
<a href="#l14.82"></a><span id="l14.82"> #if defined( NeXT ) || (defined(SunOS) &amp;&amp; SunOS &lt; 40)</span>
<a href="#l14.83"></a><span id="l14.83"> #define TERMIO_TYPE struct sgttyb</span>
<a href="#l14.84"></a><span id="l14.84"> #define TERMFLAG_TYPE int</span>
<a href="#l14.85"></a><span id="l14.85" class="difflineminus">-#define GETATTR( fd, tiop )	ioctl((fd), TIOCGETP, (caddr_t)(tiop))</span>
<a href="#l14.86"></a><span id="l14.86" class="difflineminus">-#define SETATTR( fd, tiop )	ioctl((fd), TIOCSETP, (caddr_t)(tiop))</span>
<a href="#l14.87"></a><span id="l14.87" class="difflineminus">-#define GETFLAGS( tio )		(tio).sg_flags</span>
<a href="#l14.88"></a><span id="l14.88" class="difflineminus">-#define SETFLAGS( tio, flags )	(tio).sg_flags = (flags)</span>
<a href="#l14.89"></a><span id="l14.89" class="difflineplus">+#define GETATTR( fd, tiop ) ioctl((fd), TIOCGETP, (caddr_t)(tiop))</span>
<a href="#l14.90"></a><span id="l14.90" class="difflineplus">+#define SETATTR( fd, tiop ) ioctl((fd), TIOCSETP, (caddr_t)(tiop))</span>
<a href="#l14.91"></a><span id="l14.91" class="difflineplus">+#define GETFLAGS( tio ) (tio).sg_flags</span>
<a href="#l14.92"></a><span id="l14.92" class="difflineplus">+#define SETFLAGS( tio, flags ) (tio).sg_flags = (flags)</span>
<a href="#l14.93"></a><span id="l14.93"> #else</span>
<a href="#l14.94"></a><span id="l14.94"> #define USE_TERMIOS</span>
<a href="#l14.95"></a><span id="l14.95"> #define TERMIO_TYPE struct termios</span>
<a href="#l14.96"></a><span id="l14.96"> #define TERMFLAG_TYPE tcflag_t</span>
<a href="#l14.97"></a><span id="l14.97" class="difflineminus">-#define GETATTR( fd, tiop )	tcgetattr((fd), (tiop))</span>
<a href="#l14.98"></a><span id="l14.98" class="difflineminus">-#define SETATTR( fd, tiop )	tcsetattr((fd), TCSANOW /* 0 */, (tiop))</span>
<a href="#l14.99"></a><span id="l14.99" class="difflineminus">-#define GETFLAGS( tio )		(tio).c_lflag</span>
<a href="#l14.100"></a><span id="l14.100" class="difflineminus">-#define SETFLAGS( tio, flags )	(tio).c_lflag = (flags)</span>
<a href="#l14.101"></a><span id="l14.101" class="difflineplus">+#define GETATTR( fd, tiop ) tcgetattr((fd), (tiop))</span>
<a href="#l14.102"></a><span id="l14.102" class="difflineplus">+#define SETATTR( fd, tiop ) tcsetattr((fd), TCSANOW /* 0 */, (tiop))</span>
<a href="#l14.103"></a><span id="l14.103" class="difflineplus">+#define GETFLAGS( tio ) (tio).c_lflag</span>
<a href="#l14.104"></a><span id="l14.104" class="difflineplus">+#define SETFLAGS( tio, flags ) (tio).c_lflag = (flags)</span>
<a href="#l14.105"></a><span id="l14.105"> #endif</span>
<a href="#l14.106"></a><span id="l14.106"> </span>
<a href="#l14.107"></a><span id="l14.107"> #if ( !defined( HPUX9 )) &amp;&amp; ( !defined( sunos4 )) &amp;&amp; ( !defined( SNI )) &amp;&amp; \</span>
<a href="#l14.108"></a><span id="l14.108" class="difflineminus">-	( !defined( HAVE_TIME_R ))</span>
<a href="#l14.109"></a><span id="l14.109" class="difflineplus">+  ( !defined( HAVE_TIME_R ))</span>
<a href="#l14.110"></a><span id="l14.110"> #define HAVE_TIME_R</span>
<a href="#l14.111"></a><span id="l14.111"> #endif</span>
<a href="#l14.112"></a><span id="l14.112"> </span>
<a href="#l14.113"></a><span id="l14.113"> #if defined(SNI) || defined(LINUX1_2)</span>
<a href="#l14.114"></a><span id="l14.114"> int strcasecmp(const char *, const char *);</span>
<a href="#l14.115"></a><span id="l14.115"> #ifdef SNI</span>
<a href="#l14.116"></a><span id="l14.116"> int strncasecmp(const char *, const char *, int);</span>
<a href="#l14.117"></a><span id="l14.117"> #endif /* SNI */</span>
<a href="#l14.118"></a><span id="l14.118"> #ifdef LINUX1_2</span>
<a href="#l14.119"></a><span id="l14.119"> int strncasecmp(const char *, const char *, size_t);</span>
<a href="#l14.120"></a><span id="l14.120"> #endif /* LINUX1_2 */</span>
<a href="#l14.121"></a><span id="l14.121"> #endif /* SNI || LINUX1_2 */</span>
<a href="#l14.122"></a><span id="l14.122"> </span>
<a href="#l14.123"></a><span id="l14.123"> #if defined(_WINDOWS) || defined(macintosh) || defined(XP_OS2) || defined(DARWIN)</span>
<a href="#l14.124"></a><span id="l14.124"> #define GETHOSTBYNAME( n, r, b, l, e )  gethostbyname( n )</span>
<a href="#l14.125"></a><span id="l14.125" class="difflineminus">-#define NSLDAPI_CTIME( c, b, l )	ctime( c )</span>
<a href="#l14.126"></a><span id="l14.126" class="difflineminus">-#define STRTOK( s1, s2, l )		strtok( s1, s2 )</span>
<a href="#l14.127"></a><span id="l14.127" class="difflineplus">+#define NSLDAPI_CTIME( c, b, l ) ctime( c )</span>
<a href="#l14.128"></a><span id="l14.128" class="difflineplus">+#define STRTOK( s1, s2, l ) strtok( s1, s2 )</span>
<a href="#l14.129"></a><span id="l14.129"> #elif defined(XP_BEOS)</span>
<a href="#l14.130"></a><span id="l14.130"> #define GETHOSTBYNAME( n, r, b, l, e )  gethostbyname( n )</span>
<a href="#l14.131"></a><span id="l14.131"> #define NSLDAPI_CTIME( c, b, l )                ctime_r( c, b )</span>
<a href="#l14.132"></a><span id="l14.132" class="difflineminus">-#define STRTOK( s1, s2, l )		strtok_r( s1, s2, l )</span>
<a href="#l14.133"></a><span id="l14.133" class="difflineplus">+#define STRTOK( s1, s2, l ) strtok_r( s1, s2, l )</span>
<a href="#l14.134"></a><span id="l14.134"> #define HAVE_STRTOK_R</span>
<a href="#l14.135"></a><span id="l14.135"> #else /* UNIX */</span>
<a href="#l14.136"></a><span id="l14.136"> #if (defined(AIX) &amp;&amp; defined(_THREAD_SAFE)) || defined(OSF1)</span>
<a href="#l14.137"></a><span id="l14.137" class="difflineminus">-#define NSLDAPI_NETDB_BUF_SIZE	 sizeof(struct protoent_data)</span>
<a href="#l14.138"></a><span id="l14.138" class="difflineplus">+#define NSLDAPI_NETDB_BUF_SIZE sizeof(struct protoent_data)</span>
<a href="#l14.139"></a><span id="l14.139"> #else</span>
<a href="#l14.140"></a><span id="l14.140" class="difflineminus">-#define NSLDAPI_NETDB_BUF_SIZE	1024</span>
<a href="#l14.141"></a><span id="l14.141" class="difflineplus">+#define NSLDAPI_NETDB_BUF_SIZE 1024</span>
<a href="#l14.142"></a><span id="l14.142"> #endif</span>
<a href="#l14.143"></a><span id="l14.143"> </span>
<a href="#l14.144"></a><span id="l14.144"> #if defined(sgi) || defined(HPUX9) || defined(SCOOS) || \</span>
<a href="#l14.145"></a><span id="l14.145">     defined(UNIXWARE) || defined(SUNOS4) || defined(SNI) || defined(BSDI) || \</span>
<a href="#l14.146"></a><span id="l14.146">     defined(NCR) || defined(OSF1) || defined(NEC) || defined(VMS) || \</span>
<a href="#l14.147"></a><span id="l14.147">     ( defined(HPUX10) &amp;&amp; !defined(_REENTRANT)) || defined(HPUX11) || \</span>
<a href="#l14.148"></a><span id="l14.148">     defined(UnixWare) || defined(NETBSD) || \</span>
<a href="#l14.149"></a><span id="l14.149">     defined(FREEBSD) || defined(OPENBSD) || \</span>
<a href="#l14.150"></a><span id="l14.150" class="difflineat">@@ -280,105 +280,105 @@ int strncasecmp(const char *, const char</span>
<a href="#l14.151"></a><span id="l14.151"> /* Maybe this is for another version of AIX?</span>
<a href="#l14.152"></a><span id="l14.152">    Commenting out for AIX 4.1 for Nova</span>
<a href="#l14.153"></a><span id="l14.153">    Replaced with following to lines, stolen from the #else below</span>
<a href="#l14.154"></a><span id="l14.154"> #define GETHOSTBYNAME_BUF_T struct hostent_data</span>
<a href="#l14.155"></a><span id="l14.155"> */</span>
<a href="#l14.156"></a><span id="l14.156"> typedef char GETHOSTBYNAME_buf_t [NSLDAPI_NETDB_BUF_SIZE];</span>
<a href="#l14.157"></a><span id="l14.157"> #define GETHOSTBYNAME_BUF_T GETHOSTBYNAME_buf_t</span>
<a href="#l14.158"></a><span id="l14.158"> #define GETHOSTBYNAME( n, r, b, l, e ) \</span>
<a href="#l14.159"></a><span id="l14.159" class="difflineminus">-	(memset (&amp;b, 0, l), gethostbyname_r (n, r, &amp;b) ? NULL : r)</span>
<a href="#l14.160"></a><span id="l14.160" class="difflineplus">+  (memset (&amp;b, 0, l), gethostbyname_r (n, r, &amp;b) ? NULL : r)</span>
<a href="#l14.161"></a><span id="l14.161"> #elif defined(HPUX10)</span>
<a href="#l14.162"></a><span id="l14.162"> #define GETHOSTBYNAME_BUF_T struct hostent_data</span>
<a href="#l14.163"></a><span id="l14.163" class="difflineminus">-#define GETHOSTBYNAME( n, r, b, l, e )	nsldapi_compat_gethostbyname_r( n, r, (char *)&amp;b, l, e )</span>
<a href="#l14.164"></a><span id="l14.164" class="difflineplus">+#define GETHOSTBYNAME( n, r, b, l, e ) nsldapi_compat_gethostbyname_r( n, r, (char *)&amp;b, l, e )</span>
<a href="#l14.165"></a><span id="l14.165"> #elif defined(LINUX) || defined(DRAGONFLY)</span>
<a href="#l14.166"></a><span id="l14.166"> typedef char GETHOSTBYNAME_buf_t [NSLDAPI_NETDB_BUF_SIZE];</span>
<a href="#l14.167"></a><span id="l14.167"> #define GETHOSTBYNAME_BUF_T GETHOSTBYNAME_buf_t</span>
<a href="#l14.168"></a><span id="l14.168"> #define GETHOSTBYNAME( n, r, b, l, rp, e )  gethostbyname_r( n, r, b, l, rp, e )</span>
<a href="#l14.169"></a><span id="l14.169"> #define GETHOSTBYNAME_R_RETURNS_INT</span>
<a href="#l14.170"></a><span id="l14.170"> #else</span>
<a href="#l14.171"></a><span id="l14.171"> typedef char GETHOSTBYNAME_buf_t [NSLDAPI_NETDB_BUF_SIZE];</span>
<a href="#l14.172"></a><span id="l14.172"> #define GETHOSTBYNAME_BUF_T GETHOSTBYNAME_buf_t</span>
<a href="#l14.173"></a><span id="l14.173"> #define GETHOSTBYNAME( n, r, b, l, e )  gethostbyname_r( n, r, b, l, e )</span>
<a href="#l14.174"></a><span id="l14.174"> #endif</span>
<a href="#l14.175"></a><span id="l14.175"> #if defined(HPUX9) || defined(LINUX1_2) || defined(LINUX2_0) || \</span>
<a href="#l14.176"></a><span id="l14.176">     defined(LINUX2_1) || defined(SUNOS4) || defined(SNI) || \</span>
<a href="#l14.177"></a><span id="l14.177">     defined(SCOOS) || defined(BSDI) || defined(NCR) || \</span>
<a href="#l14.178"></a><span id="l14.178">     defined(NEC) || ( defined(HPUX10) &amp;&amp; !defined(_REENTRANT)) || \</span>
<a href="#l14.179"></a><span id="l14.179">     (defined(AIX) &amp;&amp; !defined(USE_REENTRANT_LIBC))</span>
<a href="#l14.180"></a><span id="l14.180" class="difflineminus">-#define NSLDAPI_CTIME( c, b, l )	ctime( c )</span>
<a href="#l14.181"></a><span id="l14.181" class="difflineplus">+#define NSLDAPI_CTIME( c, b, l ) ctime( c )</span>
<a href="#l14.182"></a><span id="l14.182"> #elif defined(HPUX10) &amp;&amp; defined(_REENTRANT) &amp;&amp; !defined(HPUX11)</span>
<a href="#l14.183"></a><span id="l14.183" class="difflineminus">-#define NSLDAPI_CTIME( c, b, l )	nsldapi_compat_ctime_r( c, b, l )</span>
<a href="#l14.184"></a><span id="l14.184" class="difflineplus">+#define NSLDAPI_CTIME( c, b, l ) nsldapi_compat_ctime_r( c, b, l )</span>
<a href="#l14.185"></a><span id="l14.185"> #elif defined( IRIX6_2 ) || defined( IRIX6_3 ) || defined(UNIXWARE) \</span>
<a href="#l14.186"></a><span id="l14.186" class="difflineminus">-	|| defined(OSF1V4) || defined(AIX) || defined(UnixWare) \</span>
<a href="#l14.187"></a><span id="l14.187" class="difflineplus">+  || defined(OSF1V4) || defined(AIX) || defined(UnixWare) \</span>
<a href="#l14.188"></a><span id="l14.188">         || defined(hpux) || defined(HPUX11) || defined(NETBSD) \</span>
<a href="#l14.189"></a><span id="l14.189">         || defined(IRIX6) || defined(FREEBSD) || defined(VMS) \</span>
<a href="#l14.190"></a><span id="l14.190">         || defined(NTO) || defined(OPENBSD) || defined(DRAGONFLY)</span>
<a href="#l14.191"></a><span id="l14.191"> #define NSLDAPI_CTIME( c, b, l )        ctime_r( c, b )</span>
<a href="#l14.192"></a><span id="l14.192"> #elif defined( OSF1V3 )</span>
<a href="#l14.193"></a><span id="l14.193" class="difflineminus">-#define NSLDAPI_CTIME( c, b, l )	(ctime_r( c, b, l ) ? NULL : b)</span>
<a href="#l14.194"></a><span id="l14.194" class="difflineplus">+#define NSLDAPI_CTIME( c, b, l ) (ctime_r( c, b, l ) ? NULL : b)</span>
<a href="#l14.195"></a><span id="l14.195"> #else</span>
<a href="#l14.196"></a><span id="l14.196" class="difflineminus">-#define NSLDAPI_CTIME( c, b, l )	ctime_r( c, b, l )</span>
<a href="#l14.197"></a><span id="l14.197" class="difflineplus">+#define NSLDAPI_CTIME( c, b, l ) ctime_r( c, b, l )</span>
<a href="#l14.198"></a><span id="l14.198"> #endif</span>
<a href="#l14.199"></a><span id="l14.199"> #if defined(hpux9) || defined(SUNOS4) || defined(SNI) || \</span>
<a href="#l14.200"></a><span id="l14.200">     defined(SCOOS) || defined(BSDI) || defined(NCR) || defined(VMS) || \</span>
<a href="#l14.201"></a><span id="l14.201">     defined(NEC) || (defined(LINUX) &amp;&amp; __GNU_LIBRARY__ != 6) || \</span>
<a href="#l14.202"></a><span id="l14.202">     (defined(AIX) &amp;&amp; !defined(USE_REENTRANT_LIBC))</span>
<a href="#l14.203"></a><span id="l14.203" class="difflineminus">-#define STRTOK( s1, s2, l )		strtok( s1, s2 )</span>
<a href="#l14.204"></a><span id="l14.204" class="difflineplus">+#define STRTOK( s1, s2, l ) strtok( s1, s2 )</span>
<a href="#l14.205"></a><span id="l14.205"> #else</span>
<a href="#l14.206"></a><span id="l14.206"> #define HAVE_STRTOK_R</span>
<a href="#l14.207"></a><span id="l14.207"> #ifndef strtok_r</span>
<a href="#l14.208"></a><span id="l14.208"> char *strtok_r(char *, const char *, char **);</span>
<a href="#l14.209"></a><span id="l14.209"> #endif</span>
<a href="#l14.210"></a><span id="l14.210" class="difflineminus">-#define STRTOK( s1, s2, l )		(char *)strtok_r( s1, s2, l )</span>
<a href="#l14.211"></a><span id="l14.211" class="difflineplus">+#define STRTOK( s1, s2, l ) (char *)strtok_r( s1, s2, l )</span>
<a href="#l14.212"></a><span id="l14.212"> #endif /* STRTOK */</span>
<a href="#l14.213"></a><span id="l14.213"> #endif /* UNIX */</span>
<a href="#l14.214"></a><span id="l14.214"> </span>
<a href="#l14.215"></a><span id="l14.215"> #if defined( ultrix ) || defined( nextstep )</span>
<a href="#l14.216"></a><span id="l14.216"> extern char *strdup();</span>
<a href="#l14.217"></a><span id="l14.217"> #endif /* ultrix || nextstep */</span>
<a href="#l14.218"></a><span id="l14.218"> </span>
<a href="#l14.219"></a><span id="l14.219"> #if defined( sunos4 ) || defined( OSF1 )</span>
<a href="#l14.220"></a><span id="l14.220" class="difflineminus">-#define	BSD_TIME	1	/* for servers/slapd/log.h */</span>
<a href="#l14.221"></a><span id="l14.221" class="difflineplus">+#define BSD_TIME 1  /* for servers/slapd/log.h */</span>
<a href="#l14.222"></a><span id="l14.222"> #endif /* sunos4 || osf */</span>
<a href="#l14.223"></a><span id="l14.223"> </span>
<a href="#l14.224"></a><span id="l14.224"> #if defined(XP_OS2)</span>
<a href="#l14.225"></a><span id="l14.225"> #include &lt;machine/endian.h&gt;   /* for htonl, et.al. */</span>
<a href="#l14.226"></a><span id="l14.226" class="difflineminus">-#include &lt;arpa/inet.h&gt;	      /* for inet_addr() */</span>
<a href="#l14.227"></a><span id="l14.227" class="difflineplus">+#include &lt;arpa/inet.h&gt;  /* for inet_addr() */</span>
<a href="#l14.228"></a><span id="l14.228"> #elif !defined(_WINDOWS) &amp;&amp; !defined(macintosh)</span>
<a href="#l14.229"></a><span id="l14.229"> #include &lt;netinet/in.h&gt;</span>
<a href="#l14.230"></a><span id="l14.230"> #if !defined(XP_BEOS)</span>
<a href="#l14.231"></a><span id="l14.231" class="difflineminus">-#include &lt;arpa/inet.h&gt;	/* for inet_addr() */</span>
<a href="#l14.232"></a><span id="l14.232" class="difflineplus">+#include &lt;arpa/inet.h&gt;  /* for inet_addr() */</span>
<a href="#l14.233"></a><span id="l14.233"> #endif</span>
<a href="#l14.234"></a><span id="l14.234"> #endif</span>
<a href="#l14.235"></a><span id="l14.235"> </span>
<a href="#l14.236"></a><span id="l14.236"> </span>
<a href="#l14.237"></a><span id="l14.237"> /*</span>
<a href="#l14.238"></a><span id="l14.238">  * Define portable 32-bit integral types.</span>
<a href="#l14.239"></a><span id="l14.239">  */</span>
<a href="#l14.240"></a><span id="l14.240"> #include &lt;limits.h&gt;</span>
<a href="#l14.241"></a><span id="l14.241" class="difflineminus">-#if UINT_MAX &gt;= 0xffffffffU	/* an int holds at least 32 bits */</span>
<a href="#l14.242"></a><span id="l14.242" class="difflineplus">+#if UINT_MAX &gt;= 0xffffffffU  /* an int holds at least 32 bits */</span>
<a href="#l14.243"></a><span id="l14.243">     typedef signed int nsldapi_int_32;</span>
<a href="#l14.244"></a><span id="l14.244">     typedef unsigned int nsldapi_uint_32;</span>
<a href="#l14.245"></a><span id="l14.245" class="difflineminus">-#else				/* ints are &lt; 32 bits; use long instead */</span>
<a href="#l14.246"></a><span id="l14.246" class="difflineplus">+#else  /* ints are &lt; 32 bits; use long instead */</span>
<a href="#l14.247"></a><span id="l14.247">     typedef signed long nsldapi_int_32;</span>
<a href="#l14.248"></a><span id="l14.248">     typedef unsigned long nsldapi_uint_32;</span>
<a href="#l14.249"></a><span id="l14.249"> #endif</span>
<a href="#l14.250"></a><span id="l14.250"> </span>
<a href="#l14.251"></a><span id="l14.251"> /*</span>
<a href="#l14.252"></a><span id="l14.252">  * Define a portable type for IPv4 style Internet addresses (32 bits):</span>
<a href="#l14.253"></a><span id="l14.253">  */</span>
<a href="#l14.254"></a><span id="l14.254"> #if defined(_IN_ADDR_T) || defined(aix) || defined(HPUX11) || defined(OSF1)</span>
<a href="#l14.255"></a><span id="l14.255" class="difflineminus">-typedef in_addr_t	nsldapi_in_addr_t;</span>
<a href="#l14.256"></a><span id="l14.256" class="difflineplus">+typedef in_addr_t nsldapi_in_addr_t;</span>
<a href="#l14.257"></a><span id="l14.257"> #else</span>
<a href="#l14.258"></a><span id="l14.258" class="difflineminus">-typedef nsldapi_uint_32	nsldapi_in_addr_t;</span>
<a href="#l14.259"></a><span id="l14.259" class="difflineplus">+typedef nsldapi_uint_32 nsldapi_in_addr_t;</span>
<a href="#l14.260"></a><span id="l14.260"> #endif</span>
<a href="#l14.261"></a><span id="l14.261"> </span>
<a href="#l14.262"></a><span id="l14.262"> #ifdef SUNOS4</span>
<a href="#l14.263"></a><span id="l14.263" class="difflineminus">-#include &lt;pcfs/pc_dir.h&gt;	/* for toupper() */</span>
<a href="#l14.264"></a><span id="l14.264" class="difflineplus">+#include &lt;pcfs/pc_dir.h&gt;  /* for toupper() */</span>
<a href="#l14.265"></a><span id="l14.265"> int fprintf(FILE *, char *, ...);</span>
<a href="#l14.266"></a><span id="l14.266"> int fseek(FILE *, long, int);</span>
<a href="#l14.267"></a><span id="l14.267"> int fread(char *, int, int, FILE *);</span>
<a href="#l14.268"></a><span id="l14.268"> int fclose(FILE *);</span>
<a href="#l14.269"></a><span id="l14.269"> int fflush(FILE *);</span>
<a href="#l14.270"></a><span id="l14.270"> int rewind(FILE *);</span>
<a href="#l14.271"></a><span id="l14.271"> void *memmove(void *, const void *, size_t);</span>
<a href="#l14.272"></a><span id="l14.272"> int strcasecmp(char *, char *);</span>
<a href="#l14.273"></a><span id="l14.273" class="difflineat">@@ -400,22 +400,22 @@ int connect(int, struct sockaddr *, int)</span>
<a href="#l14.274"></a><span id="l14.274"> #if defined(SUNOS4)</span>
<a href="#l14.275"></a><span id="l14.275"> int select(int, fd_set *, fd_set *, fd_set *, struct timeval *);</span>
<a href="#l14.276"></a><span id="l14.276"> #endif /* SUNOS4 || SNI */</span>
<a href="#l14.277"></a><span id="l14.277"> </span>
<a href="#l14.278"></a><span id="l14.278"> /*</span>
<a href="#l14.279"></a><span id="l14.279">  * SAFEMEMCPY is an overlap-safe copy from s to d of n bytes</span>
<a href="#l14.280"></a><span id="l14.280">  */</span>
<a href="#l14.281"></a><span id="l14.281"> #ifdef macintosh</span>
<a href="#l14.282"></a><span id="l14.282" class="difflineminus">-#define SAFEMEMCPY( d, s, n )	BlockMoveData( (Ptr)s, (Ptr)d, n )</span>
<a href="#l14.283"></a><span id="l14.283" class="difflineplus">+#define SAFEMEMCPY( d, s, n ) BlockMoveData( (Ptr)s, (Ptr)d, n )</span>
<a href="#l14.284"></a><span id="l14.284"> #else /* macintosh */</span>
<a href="#l14.285"></a><span id="l14.285"> #ifdef sunos4</span>
<a href="#l14.286"></a><span id="l14.286" class="difflineminus">-#define SAFEMEMCPY( d, s, n )	bcopy( s, d, n )</span>
<a href="#l14.287"></a><span id="l14.287" class="difflineplus">+#define SAFEMEMCPY( d, s, n ) bcopy( s, d, n )</span>
<a href="#l14.288"></a><span id="l14.288"> #else /* sunos4 */</span>
<a href="#l14.289"></a><span id="l14.289" class="difflineminus">-#define SAFEMEMCPY( d, s, n )	memmove( d, s, n )</span>
<a href="#l14.290"></a><span id="l14.290" class="difflineplus">+#define SAFEMEMCPY( d, s, n ) memmove( d, s, n )</span>
<a href="#l14.291"></a><span id="l14.291"> #endif /* sunos4 */</span>
<a href="#l14.292"></a><span id="l14.292"> #endif /* macintosh */</span>
<a href="#l14.293"></a><span id="l14.293"> </span>
<a href="#l14.294"></a><span id="l14.294"> #ifdef _WINDOWS</span>
<a href="#l14.295"></a><span id="l14.295"> </span>
<a href="#l14.296"></a><span id="l14.296"> #define strcasecmp strcmpi</span>
<a href="#l14.297"></a><span id="l14.297"> #define strncasecmp _strnicmp</span>
<a href="#l14.298"></a><span id="l14.298"> #define bzero(a, b) memset( a, 0, b )</span>
<a href="#l14.299"></a><span id="l14.299" class="difflineat">@@ -438,19 +438,19 @@ int select(int, fd_set *, fd_set *, fd_s</span>
<a href="#l14.300"></a><span id="l14.300"> #define bzero(a, b) memset( a, 0, b )</span>
<a href="#l14.301"></a><span id="l14.301"> #include &lt;string.h&gt; /*for strcmpi()*/</span>
<a href="#l14.302"></a><span id="l14.302"> #include &lt;time.h&gt;   /*for ctime()*/</span>
<a href="#l14.303"></a><span id="l14.303"> </span>
<a href="#l14.304"></a><span id="l14.304"> #endif /* XP_OS2 */</span>
<a href="#l14.305"></a><span id="l14.305"> </span>
<a href="#l14.306"></a><span id="l14.306"> /* Define a macro to support large files */</span>
<a href="#l14.307"></a><span id="l14.307"> #ifdef _LARGEFILE64_SOURCE</span>
<a href="#l14.308"></a><span id="l14.308" class="difflineminus">-#define NSLDAPI_FOPEN( filename, mode )	fopen64( filename, mode )</span>
<a href="#l14.309"></a><span id="l14.309" class="difflineplus">+#define NSLDAPI_FOPEN( filename, mode ) fopen64( filename, mode )</span>
<a href="#l14.310"></a><span id="l14.310"> #else</span>
<a href="#l14.311"></a><span id="l14.311" class="difflineminus">-#define NSLDAPI_FOPEN( filename, mode )	fopen( filename, mode )</span>
<a href="#l14.312"></a><span id="l14.312" class="difflineplus">+#define NSLDAPI_FOPEN( filename, mode ) fopen( filename, mode )</span>
<a href="#l14.313"></a><span id="l14.313"> #endif</span>
<a href="#l14.314"></a><span id="l14.314"> </span>
<a href="#l14.315"></a><span id="l14.315"> #if defined(LINUX) || defined(AIX) || defined(HPUX) || defined(_WINDOWS)</span>
<a href="#l14.316"></a><span id="l14.316"> size_t nsldapi_compat_strlcpy(char *dst, const char *src, size_t len);</span>
<a href="#l14.317"></a><span id="l14.317"> #define STRLCPY nsldapi_compat_strlcpy</span>
<a href="#l14.318"></a><span id="l14.318"> #else</span>
<a href="#l14.319"></a><span id="l14.319"> #define STRLCPY strlcpy</span>
<a href="#l14.320"></a><span id="l14.320"> #endif</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/ldap/c-sdk/include/proto-ntutil.h</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/ldap/c-sdk/include/proto-ntutil.h</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -64,22 +64,22 @@ extern int getopt (int argc, char *const</span>
<a href="#l15.4"></a><span id="l15.4">  *</span>
<a href="#l15.5"></a><span id="l15.5">  * ntevent.c</span>
<a href="#l15.6"></a><span id="l15.6">  *</span>
<a href="#l15.7"></a><span id="l15.7">  */</span>
<a href="#l15.8"></a><span id="l15.8"> extern BOOL MultipleInstances();</span>
<a href="#l15.9"></a><span id="l15.9"> extern BOOL SlapdIsAService();</span>
<a href="#l15.10"></a><span id="l15.10"> extern void InitializeSlapdLogging( LPTSTR lpszRegLocation, LPTSTR lpszEventLogName, LPTSTR lpszMessageFile );</span>
<a href="#l15.11"></a><span id="l15.11"> extern void ReportSlapdEvent(WORD wEventType, DWORD dwIdEvent, WORD wNumInsertStrings,</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-						char *pszStrings);</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+                             char *pszStrings);</span>
<a href="#l15.14"></a><span id="l15.14"> extern BOOL ReportSlapdStatusToSCMgr(</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">-					SERVICE_STATUS *serviceStatus,</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineminus">-					SERVICE_STATUS_HANDLE serviceStatusHandle,</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineminus">-					HANDLE Event,</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineminus">-					DWORD dwCurrentState,</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineplus">+                    SERVICE_STATUS *serviceStatus,</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineplus">+                    SERVICE_STATUS_HANDLE serviceStatusHandle,</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineplus">+                    HANDLE Event,</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineplus">+                    DWORD dwCurrentState,</span>
<a href="#l15.23"></a><span id="l15.23">                     DWORD dwWin32ExitCode,</span>
<a href="#l15.24"></a><span id="l15.24">                     DWORD dwCheckPoint,</span>
<a href="#l15.25"></a><span id="l15.25">                     DWORD dwWaitHint);</span>
<a href="#l15.26"></a><span id="l15.26"> extern void WINAPI SlapdServiceCtrlHandler(DWORD dwOpcode);</span>
<a href="#l15.27"></a><span id="l15.27"> extern BOOL SlapdGetServerNameFromCmdline(char *szServerName, char *szCmdLine);</span>
<a href="#l15.28"></a><span id="l15.28"> </span>
<a href="#l15.29"></a><span id="l15.29"> /*</span>
<a href="#l15.30"></a><span id="l15.30">  *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/ldap/c-sdk/include/regex.h</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/ldap/c-sdk/include/regex.h</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -57,17 +57,17 @@ extern &quot;C&quot; {</span>
<a href="#l16.4"></a><span id="l16.4"> #endif</span>
<a href="#l16.5"></a><span id="l16.5"> </span>
<a href="#l16.6"></a><span id="l16.6"> #include &quot;ldap.h&quot;</span>
<a href="#l16.7"></a><span id="l16.7"> </span>
<a href="#l16.8"></a><span id="l16.8"> #if !defined( NEEDPROTOS ) &amp;&amp; defined( __STDC__ )</span>
<a href="#l16.9"></a><span id="l16.9"> #define NEEDPROTOS</span>
<a href="#l16.10"></a><span id="l16.10"> #endif</span>
<a href="#l16.11"></a><span id="l16.11"> </span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-#ifdef _SLDAPD_H_	/* server build: no need to use LDAP_CALL stuff */</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+#ifdef _SLDAPD_H_  /* server build: no need to use LDAP_CALL stuff */</span>
<a href="#l16.14"></a><span id="l16.14"> #ifdef LDAP_CALL</span>
<a href="#l16.15"></a><span id="l16.15"> #undef LDAP_CALL</span>
<a href="#l16.16"></a><span id="l16.16"> #define LDAP_CALL</span>
<a href="#l16.17"></a><span id="l16.17"> #endif</span>
<a href="#l16.18"></a><span id="l16.18"> #endif</span>
<a href="#l16.19"></a><span id="l16.19"> </span>
<a href="#l16.20"></a><span id="l16.20"> #ifdef NEEDPROTOS</span>
<a href="#l16.21"></a><span id="l16.21"> int re_init( void );</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/ldap/c-sdk/include/srchpref.h</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/ldap/c-sdk/include/srchpref.h</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -73,82 +73,82 @@ extern &quot;C&quot; {</span>
<a href="#l17.4"></a><span id="l17.4"> #define LDAP_C</span>
<a href="#l17.5"></a><span id="l17.5"> #define LDAP_CALLBACK</span>
<a href="#l17.6"></a><span id="l17.6"> #define LDAP_PASCAL</span>
<a href="#l17.7"></a><span id="l17.7"> #define LDAP_CALL</span>
<a href="#l17.8"></a><span id="l17.8"> #endif /* _WINDOWS */</span>
<a href="#l17.9"></a><span id="l17.9"> #endif /* LDAP_CALL */</span>
<a href="#l17.10"></a><span id="l17.10"> </span>
<a href="#l17.11"></a><span id="l17.11"> struct ldap_searchattr {</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-	char				*sa_attrlabel;</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineminus">-	char				*sa_attr;</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineminus">-					/* max 32 matchtypes for now */</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineminus">-	unsigned long			sa_matchtypebitmap;</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineminus">-	char				*sa_selectattr;</span>
<a href="#l17.17"></a><span id="l17.17" class="difflineminus">-	char				*sa_selecttext;</span>
<a href="#l17.18"></a><span id="l17.18" class="difflineminus">-	struct ldap_searchattr		*sa_next;</span>
<a href="#l17.19"></a><span id="l17.19" class="difflineplus">+  char *sa_attrlabel;</span>
<a href="#l17.20"></a><span id="l17.20" class="difflineplus">+  char *sa_attr;</span>
<a href="#l17.21"></a><span id="l17.21" class="difflineplus">+  /* max 32 matchtypes for now */</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineplus">+  unsigned long sa_matchtypebitmap;</span>
<a href="#l17.23"></a><span id="l17.23" class="difflineplus">+  char *sa_selectattr;</span>
<a href="#l17.24"></a><span id="l17.24" class="difflineplus">+  char *sa_selecttext;</span>
<a href="#l17.25"></a><span id="l17.25" class="difflineplus">+  struct ldap_searchattr *sa_next;</span>
<a href="#l17.26"></a><span id="l17.26"> };</span>
<a href="#l17.27"></a><span id="l17.27"> </span>
<a href="#l17.28"></a><span id="l17.28"> struct ldap_searchmatch {</span>
<a href="#l17.29"></a><span id="l17.29" class="difflineminus">-	char				*sm_matchprompt;</span>
<a href="#l17.30"></a><span id="l17.30" class="difflineminus">-	char				*sm_filter;</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineminus">-	struct ldap_searchmatch		*sm_next;</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineplus">+  char *sm_matchprompt;</span>
<a href="#l17.33"></a><span id="l17.33" class="difflineplus">+  char *sm_filter;</span>
<a href="#l17.34"></a><span id="l17.34" class="difflineplus">+  struct ldap_searchmatch *sm_next;</span>
<a href="#l17.35"></a><span id="l17.35"> };</span>
<a href="#l17.36"></a><span id="l17.36"> </span>
<a href="#l17.37"></a><span id="l17.37"> struct ldap_searchobj {</span>
<a href="#l17.38"></a><span id="l17.38" class="difflineminus">-	char				*so_objtypeprompt;</span>
<a href="#l17.39"></a><span id="l17.39" class="difflineminus">-	unsigned long			so_options;</span>
<a href="#l17.40"></a><span id="l17.40" class="difflineminus">-	char				*so_prompt;</span>
<a href="#l17.41"></a><span id="l17.41" class="difflineminus">-	short				so_defaultscope;</span>
<a href="#l17.42"></a><span id="l17.42" class="difflineminus">-	char				*so_filterprefix;</span>
<a href="#l17.43"></a><span id="l17.43" class="difflineminus">-	char				*so_filtertag;</span>
<a href="#l17.44"></a><span id="l17.44" class="difflineminus">-	char				*so_defaultselectattr;</span>
<a href="#l17.45"></a><span id="l17.45" class="difflineminus">-	char				*so_defaultselecttext;</span>
<a href="#l17.46"></a><span id="l17.46" class="difflineminus">-	struct ldap_searchattr		*so_salist;</span>
<a href="#l17.47"></a><span id="l17.47" class="difflineminus">-	struct ldap_searchmatch		*so_smlist;</span>
<a href="#l17.48"></a><span id="l17.48" class="difflineminus">-	struct ldap_searchobj		*so_next;</span>
<a href="#l17.49"></a><span id="l17.49" class="difflineplus">+  char *so_objtypeprompt;</span>
<a href="#l17.50"></a><span id="l17.50" class="difflineplus">+  unsigned long so_options;</span>
<a href="#l17.51"></a><span id="l17.51" class="difflineplus">+  char *so_prompt;</span>
<a href="#l17.52"></a><span id="l17.52" class="difflineplus">+  short so_defaultscope;</span>
<a href="#l17.53"></a><span id="l17.53" class="difflineplus">+  char *so_filterprefix;</span>
<a href="#l17.54"></a><span id="l17.54" class="difflineplus">+  char *so_filtertag;</span>
<a href="#l17.55"></a><span id="l17.55" class="difflineplus">+  char *so_defaultselectattr;</span>
<a href="#l17.56"></a><span id="l17.56" class="difflineplus">+  char *so_defaultselecttext;</span>
<a href="#l17.57"></a><span id="l17.57" class="difflineplus">+  struct ldap_searchattr *so_salist;</span>
<a href="#l17.58"></a><span id="l17.58" class="difflineplus">+  struct ldap_searchmatch *so_smlist;</span>
<a href="#l17.59"></a><span id="l17.59" class="difflineplus">+  struct ldap_searchobj *so_next;</span>
<a href="#l17.60"></a><span id="l17.60"> };</span>
<a href="#l17.61"></a><span id="l17.61"> </span>
<a href="#l17.62"></a><span id="l17.62" class="difflineminus">-#define NULLSEARCHOBJ			((struct ldap_searchobj *)0)</span>
<a href="#l17.63"></a><span id="l17.63" class="difflineplus">+#define NULLSEARCHOBJ ((struct ldap_searchobj *)0)</span>
<a href="#l17.64"></a><span id="l17.64"> </span>
<a href="#l17.65"></a><span id="l17.65"> /*</span>
<a href="#l17.66"></a><span id="l17.66">  * global search object options</span>
<a href="#l17.67"></a><span id="l17.67">  */</span>
<a href="#l17.68"></a><span id="l17.68" class="difflineminus">-#define LDAP_SEARCHOBJ_OPT_INTERNAL	0x00000001</span>
<a href="#l17.69"></a><span id="l17.69" class="difflineplus">+#define LDAP_SEARCHOBJ_OPT_INTERNAL 0x00000001</span>
<a href="#l17.70"></a><span id="l17.70"> </span>
<a href="#l17.71"></a><span id="l17.71" class="difflineminus">-#define LDAP_IS_SEARCHOBJ_OPTION_SET( so, option )	\</span>
<a href="#l17.72"></a><span id="l17.72" class="difflineminus">-	(((so)-&gt;so_options &amp; option ) != 0 )</span>
<a href="#l17.73"></a><span id="l17.73" class="difflineplus">+#define LDAP_IS_SEARCHOBJ_OPTION_SET( so, option ) \</span>
<a href="#l17.74"></a><span id="l17.74" class="difflineplus">+  (((so)-&gt;so_options &amp; option ) != 0 )</span>
<a href="#l17.75"></a><span id="l17.75"> </span>
<a href="#l17.76"></a><span id="l17.76" class="difflineminus">-#define LDAP_SEARCHPREF_VERSION_ZERO	0</span>
<a href="#l17.77"></a><span id="l17.77" class="difflineminus">-#define LDAP_SEARCHPREF_VERSION		1</span>
<a href="#l17.78"></a><span id="l17.78" class="difflineplus">+#define LDAP_SEARCHPREF_VERSION_ZERO 0</span>
<a href="#l17.79"></a><span id="l17.79" class="difflineplus">+#define LDAP_SEARCHPREF_VERSION 1</span>
<a href="#l17.80"></a><span id="l17.80"> </span>
<a href="#l17.81"></a><span id="l17.81" class="difflineminus">-#define LDAP_SEARCHPREF_ERR_VERSION	1</span>
<a href="#l17.82"></a><span id="l17.82" class="difflineminus">-#define LDAP_SEARCHPREF_ERR_MEM		2</span>
<a href="#l17.83"></a><span id="l17.83" class="difflineminus">-#define LDAP_SEARCHPREF_ERR_SYNTAX	3</span>
<a href="#l17.84"></a><span id="l17.84" class="difflineminus">-#define LDAP_SEARCHPREF_ERR_FILE	4</span>
<a href="#l17.85"></a><span id="l17.85" class="difflineplus">+#define LDAP_SEARCHPREF_ERR_VERSION 1</span>
<a href="#l17.86"></a><span id="l17.86" class="difflineplus">+#define LDAP_SEARCHPREF_ERR_MEM 2</span>
<a href="#l17.87"></a><span id="l17.87" class="difflineplus">+#define LDAP_SEARCHPREF_ERR_SYNTAX 3</span>
<a href="#l17.88"></a><span id="l17.88" class="difflineplus">+#define LDAP_SEARCHPREF_ERR_FILE 4</span>
<a href="#l17.89"></a><span id="l17.89"> </span>
<a href="#l17.90"></a><span id="l17.90"> </span>
<a href="#l17.91"></a><span id="l17.91"> LDAP_API(int)</span>
<a href="#l17.92"></a><span id="l17.92"> LDAP_CALL</span>
<a href="#l17.93"></a><span id="l17.93"> ldap_init_searchprefs( char *file, struct ldap_searchobj **solistp );</span>
<a href="#l17.94"></a><span id="l17.94"> </span>
<a href="#l17.95"></a><span id="l17.95"> LDAP_API(int)</span>
<a href="#l17.96"></a><span id="l17.96"> LDAP_CALL</span>
<a href="#l17.97"></a><span id="l17.97"> ldap_init_searchprefs_buf( char *buf, long buflen,</span>
<a href="#l17.98"></a><span id="l17.98" class="difflineminus">-	struct ldap_searchobj **solistp );</span>
<a href="#l17.99"></a><span id="l17.99" class="difflineplus">+  struct ldap_searchobj **solistp );</span>
<a href="#l17.100"></a><span id="l17.100"> </span>
<a href="#l17.101"></a><span id="l17.101"> LDAP_API(void)</span>
<a href="#l17.102"></a><span id="l17.102"> LDAP_CALL</span>
<a href="#l17.103"></a><span id="l17.103"> ldap_free_searchprefs( struct ldap_searchobj *solist );</span>
<a href="#l17.104"></a><span id="l17.104"> </span>
<a href="#l17.105"></a><span id="l17.105"> LDAP_API(struct ldap_searchobj *)</span>
<a href="#l17.106"></a><span id="l17.106"> LDAP_CALL</span>
<a href="#l17.107"></a><span id="l17.107"> ldap_first_searchobj( struct ldap_searchobj *solist );</span>
<a href="#l17.108"></a><span id="l17.108"> </span>
<a href="#l17.109"></a><span id="l17.109"> LDAP_API(struct ldap_searchobj *)</span>
<a href="#l17.110"></a><span id="l17.110"> LDAP_CALL</span>
<a href="#l17.111"></a><span id="l17.111"> ldap_next_searchobj( struct ldap_searchobj *sollist,</span>
<a href="#l17.112"></a><span id="l17.112" class="difflineminus">-	struct ldap_searchobj *so );</span>
<a href="#l17.113"></a><span id="l17.113" class="difflineplus">+  struct ldap_searchobj *so );</span>
<a href="#l17.114"></a><span id="l17.114"> </span>
<a href="#l17.115"></a><span id="l17.115"> #ifdef __cplusplus</span>
<a href="#l17.116"></a><span id="l17.116"> }</span>
<a href="#l17.117"></a><span id="l17.117"> #endif</span>
<a href="#l17.118"></a><span id="l17.118"> #endif /* _SRCHPREF_H */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/ldap/c-sdk/libraries/liblber/lber-int.h</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/ldap/c-sdk/libraries/liblber/lber-int.h</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -114,32 +114,32 @@ extern &quot;C&quot; {</span>
<a href="#l18.4"></a><span id="l18.4"> #endif</span>
<a href="#l18.5"></a><span id="l18.5"> </span>
<a href="#l18.6"></a><span id="l18.6"> #include &quot;lber.h&quot;</span>
<a href="#l18.7"></a><span id="l18.7"> </span>
<a href="#l18.8"></a><span id="l18.8"> #ifdef macintosh</span>
<a href="#l18.9"></a><span id="l18.9"> #define NSLDAPI_LBER_SOCKET_IS_PTR</span>
<a href="#l18.10"></a><span id="l18.10"> #endif</span>
<a href="#l18.11"></a><span id="l18.11"> </span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-#define OLD_LBER_SEQUENCE	0x10	/* w/o constructed bit - broken */</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineminus">-#define OLD_LBER_SET		0x11	/* w/o constructed bit - broken */</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineplus">+#define OLD_LBER_SEQUENCE 0x10  /* w/o constructed bit - broken */</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineplus">+#define OLD_LBER_SET 0x11  /* w/o constructed bit - broken */</span>
<a href="#l18.16"></a><span id="l18.16"> </span>
<a href="#l18.17"></a><span id="l18.17"> #ifndef _IFP</span>
<a href="#l18.18"></a><span id="l18.18"> #define _IFP</span>
<a href="#l18.19"></a><span id="l18.19"> typedef int (LDAP_C LDAP_CALLBACK *IFP)();</span>
<a href="#l18.20"></a><span id="l18.20"> #endif</span>
<a href="#l18.21"></a><span id="l18.21"> </span>
<a href="#l18.22"></a><span id="l18.22"> typedef struct seqorset {</span>
<a href="#l18.23"></a><span id="l18.23" class="difflineminus">-  ber_len_t	sos_clen;</span>
<a href="#l18.24"></a><span id="l18.24" class="difflineminus">-  ber_tag_t	sos_tag;</span>
<a href="#l18.25"></a><span id="l18.25" class="difflineminus">-  char		*sos_first;</span>
<a href="#l18.26"></a><span id="l18.26" class="difflineminus">-  char		*sos_ptr;</span>
<a href="#l18.27"></a><span id="l18.27" class="difflineminus">-  struct seqorset	*sos_next;</span>
<a href="#l18.28"></a><span id="l18.28" class="difflineplus">+  ber_len_t sos_clen;</span>
<a href="#l18.29"></a><span id="l18.29" class="difflineplus">+  ber_tag_t sos_tag;</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineplus">+  char *sos_first;</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineplus">+  char *sos_ptr;</span>
<a href="#l18.32"></a><span id="l18.32" class="difflineplus">+  struct seqorset *sos_next;</span>
<a href="#l18.33"></a><span id="l18.33"> } Seqorset;</span>
<a href="#l18.34"></a><span id="l18.34" class="difflineminus">-#define NULLSEQORSET	((Seqorset *) 0)</span>
<a href="#l18.35"></a><span id="l18.35" class="difflineplus">+#define NULLSEQORSET ((Seqorset *) 0)</span>
<a href="#l18.36"></a><span id="l18.36"> </span>
<a href="#l18.37"></a><span id="l18.37"> #define SOS_STACK_SIZE 8 /* depth of the pre-allocated sos structure stack */</span>
<a href="#l18.38"></a><span id="l18.38"> </span>
<a href="#l18.39"></a><span id="l18.39"> #define MAX_TAG_SIZE (1 + sizeof(ber_int_t)) /* One byte for the length of the tag */</span>
<a href="#l18.40"></a><span id="l18.40"> #define MAX_LEN_SIZE (1 + sizeof(ber_int_t)) /* One byte for the length of the length */</span>
<a href="#l18.41"></a><span id="l18.41"> #define MAX_VALUE_PREFIX_SIZE (2 + sizeof(ber_int_t)) /* 1 byte for the tag and 1 for the len (msgid) */</span>
<a href="#l18.42"></a><span id="l18.42"> #define BER_ARRAY_QUANTITY 7 /* 0:Tag   1:Length   2:Value-prefix   3:Value   4:Value-suffix  */</span>
<a href="#l18.43"></a><span id="l18.43"> #define BER_STRUCT_TAG 0     /* 5:ControlA   6:ControlB */</span>
<a href="#l18.44"></a><span id="l18.44" class="difflineat">@@ -154,110 +154,110 @@ struct berelement {</span>
<a href="#l18.45"></a><span id="l18.45">   ldap_x_iovec  ber_struct[BER_ARRAY_QUANTITY];   /* See above */</span>
<a href="#l18.46"></a><span id="l18.46"> </span>
<a href="#l18.47"></a><span id="l18.47">   char          ber_tag_contents[MAX_TAG_SIZE];</span>
<a href="#l18.48"></a><span id="l18.48">   char          ber_len_contents[MAX_LEN_SIZE];</span>
<a href="#l18.49"></a><span id="l18.49">   char          ber_pre_contents[MAX_VALUE_PREFIX_SIZE];</span>
<a href="#l18.50"></a><span id="l18.50">   char          ber_suf_contents[MAX_LEN_SIZE+1];</span>
<a href="#l18.51"></a><span id="l18.51"> </span>
<a href="#l18.52"></a><span id="l18.52">   char      *ber_buf; /* update the value value when writing in case realloc is called */</span>
<a href="#l18.53"></a><span id="l18.53" class="difflineminus">-  char		*ber_ptr;</span>
<a href="#l18.54"></a><span id="l18.54" class="difflineminus">-  char		*ber_end;</span>
<a href="#l18.55"></a><span id="l18.55" class="difflineminus">-  struct seqorset	*ber_sos;</span>
<a href="#l18.56"></a><span id="l18.56" class="difflineplus">+  char *ber_ptr;</span>
<a href="#l18.57"></a><span id="l18.57" class="difflineplus">+  char *ber_end;</span>
<a href="#l18.58"></a><span id="l18.58" class="difflineplus">+  struct seqorset *ber_sos;</span>
<a href="#l18.59"></a><span id="l18.59">   ber_len_t ber_tag_len_read;</span>
<a href="#l18.60"></a><span id="l18.60" class="difflineminus">-  ber_tag_t	ber_tag; /* Remove me someday */</span>
<a href="#l18.61"></a><span id="l18.61" class="difflineminus">-  ber_len_t	ber_len; /* Remove me someday */</span>
<a href="#l18.62"></a><span id="l18.62" class="difflineminus">-  int		ber_usertag;</span>
<a href="#l18.63"></a><span id="l18.63" class="difflineminus">-  char		ber_options;</span>
<a href="#l18.64"></a><span id="l18.64" class="difflineminus">-  char		*ber_rwptr;</span>
<a href="#l18.65"></a><span id="l18.65" class="difflineplus">+  ber_tag_t ber_tag; /* Remove me someday */</span>
<a href="#l18.66"></a><span id="l18.66" class="difflineplus">+  ber_len_t ber_len; /* Remove me someday */</span>
<a href="#l18.67"></a><span id="l18.67" class="difflineplus">+  int ber_usertag;</span>
<a href="#l18.68"></a><span id="l18.68" class="difflineplus">+  char ber_options;</span>
<a href="#l18.69"></a><span id="l18.69" class="difflineplus">+  char *ber_rwptr;</span>
<a href="#l18.70"></a><span id="l18.70">   BERTranslateProc ber_encode_translate_proc;</span>
<a href="#l18.71"></a><span id="l18.71">   BERTranslateProc ber_decode_translate_proc;</span>
<a href="#l18.72"></a><span id="l18.72" class="difflineminus">-  int		ber_flags;</span>
<a href="#l18.73"></a><span id="l18.73" class="difflineminus">-#define LBER_FLAG_NO_FREE_BUFFER	1	/* don't free ber_buf */</span>
<a href="#l18.74"></a><span id="l18.74" class="difflineminus">-  unsigned  int ber_buf_reallocs;		/* realloc counter */</span>
<a href="#l18.75"></a><span id="l18.75" class="difflineminus">-  int		ber_sos_stack_posn;</span>
<a href="#l18.76"></a><span id="l18.76" class="difflineminus">-  Seqorset	ber_sos_stack[SOS_STACK_SIZE];</span>
<a href="#l18.77"></a><span id="l18.77" class="difflineplus">+  int ber_flags;</span>
<a href="#l18.78"></a><span id="l18.78" class="difflineplus">+#define LBER_FLAG_NO_FREE_BUFFER 1  /* don't free ber_buf */</span>
<a href="#l18.79"></a><span id="l18.79" class="difflineplus">+  unsigned  int ber_buf_reallocs;  /* realloc counter */</span>
<a href="#l18.80"></a><span id="l18.80" class="difflineplus">+  int ber_sos_stack_posn;</span>
<a href="#l18.81"></a><span id="l18.81" class="difflineplus">+  Seqorset ber_sos_stack[SOS_STACK_SIZE];</span>
<a href="#l18.82"></a><span id="l18.82"> };</span>
<a href="#l18.83"></a><span id="l18.83"> </span>
<a href="#l18.84"></a><span id="l18.84"> #define BER_CONTENTS_STRUCT_SIZE (sizeof(ldap_x_iovec) * BER_ARRAY_QUANTITY)</span>
<a href="#l18.85"></a><span id="l18.85"> </span>
<a href="#l18.86"></a><span id="l18.86" class="difflineminus">-#define NULLBER	((BerElement *)NULL)</span>
<a href="#l18.87"></a><span id="l18.87" class="difflineplus">+#define NULLBER ((BerElement *)NULL)</span>
<a href="#l18.88"></a><span id="l18.88"> </span>
<a href="#l18.89"></a><span id="l18.89"> #ifdef LDAP_DEBUG</span>
<a href="#l18.90"></a><span id="l18.90"> void ber_dump( BerElement *ber, int inout );</span>
<a href="#l18.91"></a><span id="l18.91"> #endif</span>
<a href="#l18.92"></a><span id="l18.92"> </span>
<a href="#l18.93"></a><span id="l18.93"> </span>
<a href="#l18.94"></a><span id="l18.94"> </span>
<a href="#l18.95"></a><span id="l18.95"> /*</span>
<a href="#l18.96"></a><span id="l18.96">  * structure for read/write I/O callback functions.</span>
<a href="#l18.97"></a><span id="l18.97">  */</span>
<a href="#l18.98"></a><span id="l18.98"> struct nslberi_io_fns {</span>
<a href="#l18.99"></a><span id="l18.99" class="difflineminus">-    LDAP_IOF_READ_CALLBACK	*lbiof_read;</span>
<a href="#l18.100"></a><span id="l18.100" class="difflineminus">-    LDAP_IOF_WRITE_CALLBACK	*lbiof_write;</span>
<a href="#l18.101"></a><span id="l18.101" class="difflineplus">+    LDAP_IOF_READ_CALLBACK *lbiof_read;</span>
<a href="#l18.102"></a><span id="l18.102" class="difflineplus">+    LDAP_IOF_WRITE_CALLBACK *lbiof_write;</span>
<a href="#l18.103"></a><span id="l18.103"> };</span>
<a href="#l18.104"></a><span id="l18.104"> </span>
<a href="#l18.105"></a><span id="l18.105"> </span>
<a href="#l18.106"></a><span id="l18.106"> /*</span>
<a href="#l18.107"></a><span id="l18.107">  * Old  structure for use with LBER_SOCKBUF_OPT_EXT_IO_FNS:</span>
<a href="#l18.108"></a><span id="l18.108">  */</span>
<a href="#l18.109"></a><span id="l18.109"> struct lber_x_ext_io_fns_rev0 {</span>
<a href="#l18.110"></a><span id="l18.110" class="difflineminus">-	    /* lbextiofn_size should always be set to LBER_X_EXTIO_FNS_SIZE */</span>
<a href="#l18.111"></a><span id="l18.111" class="difflineminus">-	int				lbextiofn_size;</span>
<a href="#l18.112"></a><span id="l18.112" class="difflineminus">-	LDAP_X_EXTIOF_READ_CALLBACK	*lbextiofn_read;</span>
<a href="#l18.113"></a><span id="l18.113" class="difflineminus">-	LDAP_X_EXTIOF_WRITE_CALLBACK	*lbextiofn_write;</span>
<a href="#l18.114"></a><span id="l18.114" class="difflineminus">-	struct lextiof_socket_private	*lbextiofn_socket_arg;</span>
<a href="#l18.115"></a><span id="l18.115" class="difflineplus">+      /* lbextiofn_size should always be set to LBER_X_EXTIO_FNS_SIZE */</span>
<a href="#l18.116"></a><span id="l18.116" class="difflineplus">+  int lbextiofn_size;</span>
<a href="#l18.117"></a><span id="l18.117" class="difflineplus">+  LDAP_X_EXTIOF_READ_CALLBACK *lbextiofn_read;</span>
<a href="#l18.118"></a><span id="l18.118" class="difflineplus">+  LDAP_X_EXTIOF_WRITE_CALLBACK *lbextiofn_write;</span>
<a href="#l18.119"></a><span id="l18.119" class="difflineplus">+  struct lextiof_socket_private *lbextiofn_socket_arg;</span>
<a href="#l18.120"></a><span id="l18.120"> };</span>
<a href="#l18.121"></a><span id="l18.121"> #define LBER_X_EXTIO_FNS_SIZE_REV0    sizeof(struct lber_x_ext_io_fns_rev0)</span>
<a href="#l18.122"></a><span id="l18.122"> </span>
<a href="#l18.123"></a><span id="l18.123"> </span>
<a href="#l18.124"></a><span id="l18.124"> </span>
<a href="#l18.125"></a><span id="l18.125"> struct sockbuf {</span>
<a href="#l18.126"></a><span id="l18.126" class="difflineminus">-	LBER_SOCKET	sb_sd;</span>
<a href="#l18.127"></a><span id="l18.127" class="difflineminus">-	BerElement	sb_ber;</span>
<a href="#l18.128"></a><span id="l18.128" class="difflineminus">-	int		sb_naddr;	/* &gt; 0 implies using CLDAP (UDP) */</span>
<a href="#l18.129"></a><span id="l18.129" class="difflineminus">-	void		*sb_useaddr;	/* pointer to sockaddr to use next */</span>
<a href="#l18.130"></a><span id="l18.130" class="difflineminus">-	void		*sb_fromaddr;	/* pointer to message source sockaddr */</span>
<a href="#l18.131"></a><span id="l18.131" class="difflineminus">-	void		**sb_addrs;	/* actually an array of pointers to</span>
<a href="#l18.132"></a><span id="l18.132" class="difflineminus">-					   sockaddrs */</span>
<a href="#l18.133"></a><span id="l18.133" class="difflineplus">+  LBER_SOCKET sb_sd;</span>
<a href="#l18.134"></a><span id="l18.134" class="difflineplus">+  BerElement sb_ber;</span>
<a href="#l18.135"></a><span id="l18.135" class="difflineplus">+  int sb_naddr;  /* &gt; 0 implies using CLDAP (UDP) */</span>
<a href="#l18.136"></a><span id="l18.136" class="difflineplus">+  void *sb_useaddr;  /* pointer to sockaddr to use next */</span>
<a href="#l18.137"></a><span id="l18.137" class="difflineplus">+  void *sb_fromaddr;  /* pointer to message source sockaddr */</span>
<a href="#l18.138"></a><span id="l18.138" class="difflineplus">+  void **sb_addrs;  /* actually an array of pointers to</span>
<a href="#l18.139"></a><span id="l18.139" class="difflineplus">+                       sockaddrs */</span>
<a href="#l18.140"></a><span id="l18.140"> </span>
<a href="#l18.141"></a><span id="l18.141" class="difflineminus">-	int		sb_options;	/* to support copying ber elements */</span>
<a href="#l18.142"></a><span id="l18.142" class="difflineminus">-	LBER_SOCKET	sb_copyfd;	/* for LBER_SOCKBUF_OPT_TO_FILE* opts */</span>
<a href="#l18.143"></a><span id="l18.143" class="difflineminus">-	ber_len_t	sb_max_incoming;</span>
<a href="#l18.144"></a><span id="l18.144" class="difflineminus">-	ber_tag_t   sb_valid_tag;	/* valid tag to accept */</span>
<a href="#l18.145"></a><span id="l18.145" class="difflineminus">-	struct nslberi_io_fns</span>
<a href="#l18.146"></a><span id="l18.146" class="difflineminus">-			sb_io_fns;	/* classic I/O callback functions */</span>
<a href="#l18.147"></a><span id="l18.147" class="difflineplus">+  int sb_options;  /* to support copying ber elements */</span>
<a href="#l18.148"></a><span id="l18.148" class="difflineplus">+  LBER_SOCKET sb_copyfd;  /* for LBER_SOCKBUF_OPT_TO_FILE* opts */</span>
<a href="#l18.149"></a><span id="l18.149" class="difflineplus">+  ber_len_t sb_max_incoming;</span>
<a href="#l18.150"></a><span id="l18.150" class="difflineplus">+  ber_tag_t   sb_valid_tag;  /* valid tag to accept */</span>
<a href="#l18.151"></a><span id="l18.151" class="difflineplus">+  struct nslberi_io_fns</span>
<a href="#l18.152"></a><span id="l18.152" class="difflineplus">+      sb_io_fns;  /* classic I/O callback functions */</span>
<a href="#l18.153"></a><span id="l18.153"> </span>
<a href="#l18.154"></a><span id="l18.154" class="difflineminus">-	struct lber_x_ext_io_fns</span>
<a href="#l18.155"></a><span id="l18.155" class="difflineminus">-			sb_ext_io_fns;	/* extended I/O callback functions */</span>
<a href="#l18.156"></a><span id="l18.156" class="difflineplus">+  struct lber_x_ext_io_fns</span>
<a href="#l18.157"></a><span id="l18.157" class="difflineplus">+      sb_ext_io_fns;  /* extended I/O callback functions */</span>
<a href="#l18.158"></a><span id="l18.158"> };</span>
<a href="#l18.159"></a><span id="l18.159" class="difflineminus">-#define NULLSOCKBUF	((Sockbuf *)NULL)</span>
<a href="#l18.160"></a><span id="l18.160" class="difflineplus">+#define NULLSOCKBUF ((Sockbuf *)NULL)</span>
<a href="#l18.161"></a><span id="l18.161"> </span>
<a href="#l18.162"></a><span id="l18.162"> /* needed by libldap, even in non-DEBUG builds */</span>
<a href="#l18.163"></a><span id="l18.163"> void ber_err_print( char *data );</span>
<a href="#l18.164"></a><span id="l18.164"> </span>
<a href="#l18.165"></a><span id="l18.165"> #ifndef NSLBERI_LBER_INT_FRIEND</span>
<a href="#l18.166"></a><span id="l18.166"> /*</span>
<a href="#l18.167"></a><span id="l18.167">  * Everything from this point on is excluded if NSLBERI_LBER_INT_FRIEND is</span>
<a href="#l18.168"></a><span id="l18.168">  * defined.  The code under ../libraries/libldap defines this.</span>
<a href="#l18.169"></a><span id="l18.169">  */</span>
<a href="#l18.170"></a><span id="l18.170"> </span>
<a href="#l18.171"></a><span id="l18.171" class="difflineminus">-#define READBUFSIZ	8192</span>
<a href="#l18.172"></a><span id="l18.172" class="difflineplus">+#define READBUFSIZ 8192</span>
<a href="#l18.173"></a><span id="l18.173"> </span>
<a href="#l18.174"></a><span id="l18.174"> /*</span>
<a href="#l18.175"></a><span id="l18.175">  * macros used to check validity of data structures and parameters</span>
<a href="#l18.176"></a><span id="l18.176">  */</span>
<a href="#l18.177"></a><span id="l18.177"> #define NSLBERI_VALID_BERELEMENT_POINTER( ber ) \</span>
<a href="#l18.178"></a><span id="l18.178" class="difflineminus">-	( (ber) != NULLBER )</span>
<a href="#l18.179"></a><span id="l18.179" class="difflineplus">+  ( (ber) != NULLBER )</span>
<a href="#l18.180"></a><span id="l18.180"> </span>
<a href="#l18.181"></a><span id="l18.181"> #define NSLBERI_VALID_SOCKBUF_POINTER( sb ) \</span>
<a href="#l18.182"></a><span id="l18.182" class="difflineminus">-	( (sb) != NULLSOCKBUF )</span>
<a href="#l18.183"></a><span id="l18.183" class="difflineplus">+  ( (sb) != NULLSOCKBUF )</span>
<a href="#l18.184"></a><span id="l18.184"> </span>
<a href="#l18.185"></a><span id="l18.185" class="difflineminus">-#define LBER_HTONL( l )	htonl( l )</span>
<a href="#l18.186"></a><span id="l18.186" class="difflineminus">-#define LBER_NTOHL( l )	ntohl( l )</span>
<a href="#l18.187"></a><span id="l18.187" class="difflineplus">+#define LBER_HTONL( l ) htonl( l )</span>
<a href="#l18.188"></a><span id="l18.188" class="difflineplus">+#define LBER_NTOHL( l ) ntohl( l )</span>
<a href="#l18.189"></a><span id="l18.189"> </span>
<a href="#l18.190"></a><span id="l18.190"> /* function prototypes */</span>
<a href="#l18.191"></a><span id="l18.191"> #ifdef LDAP_DEBUG</span>
<a href="#l18.192"></a><span id="l18.192"> void lber_bprint( char *data, int len );</span>
<a href="#l18.193"></a><span id="l18.193"> #endif</span>
<a href="#l18.194"></a><span id="l18.194"> void ber_err_print( char *data );</span>
<a href="#l18.195"></a><span id="l18.195"> void *nslberi_malloc( size_t size );</span>
<a href="#l18.196"></a><span id="l18.196"> void *nslberi_calloc( size_t nelem, size_t elsize );</span>
<a href="#l18.197"></a><span id="l18.197" class="difflineat">@@ -267,35 +267,35 @@ int nslberi_ber_realloc( BerElement *ber</span>
<a href="#l18.198"></a><span id="l18.198"> </span>
<a href="#l18.199"></a><span id="l18.199"> /* blame: dboreham</span>
<a href="#l18.200"></a><span id="l18.200">  * slapd spends much of its time doing memcpy's for the ber code.</span>
<a href="#l18.201"></a><span id="l18.201">  * Most of these are single-byte, so we special-case those and speed</span>
<a href="#l18.202"></a><span id="l18.202">  * things up considerably.</span>
<a href="#l18.203"></a><span id="l18.203">  */</span>
<a href="#l18.204"></a><span id="l18.204"> </span>
<a href="#l18.205"></a><span id="l18.205"> #ifdef sunos4</span>
<a href="#l18.206"></a><span id="l18.206" class="difflineminus">-#define THEMEMCPY( d, s, n )	bcopy( s, d, n )</span>
<a href="#l18.207"></a><span id="l18.207" class="difflineplus">+#define THEMEMCPY( d, s, n ) bcopy( s, d, n )</span>
<a href="#l18.208"></a><span id="l18.208"> #else /* sunos4 */</span>
<a href="#l18.209"></a><span id="l18.209" class="difflineminus">-#define THEMEMCPY( d, s, n )	memmove( d, s, n )</span>
<a href="#l18.210"></a><span id="l18.210" class="difflineplus">+#define THEMEMCPY( d, s, n ) memmove( d, s, n )</span>
<a href="#l18.211"></a><span id="l18.211"> #endif /* sunos4 */</span>
<a href="#l18.212"></a><span id="l18.212"> </span>
<a href="#l18.213"></a><span id="l18.213"> #ifdef SAFEMEMCPY</span>
<a href="#l18.214"></a><span id="l18.214"> #undef SAFEMEMCPY</span>
<a href="#l18.215"></a><span id="l18.215"> #define SAFEMEMCPY(d,s,n) if (1 == n) *((char*)d) = *((char*)s); else THEMEMCPY(d,s,n);</span>
<a href="#l18.216"></a><span id="l18.216"> #endif</span>
<a href="#l18.217"></a><span id="l18.217"> </span>
<a href="#l18.218"></a><span id="l18.218"> /*</span>
<a href="#l18.219"></a><span id="l18.219">  * Memory allocation done in liblber should all go through one of the</span>
<a href="#l18.220"></a><span id="l18.220">  * following macros. This is so we can plug-in alternative memory</span>
<a href="#l18.221"></a><span id="l18.221">  * allocators, etc. as the need arises.</span>
<a href="#l18.222"></a><span id="l18.222">  */</span>
<a href="#l18.223"></a><span id="l18.223" class="difflineminus">-#define NSLBERI_MALLOC( size )		nslberi_malloc( size )</span>
<a href="#l18.224"></a><span id="l18.224" class="difflineminus">-#define NSLBERI_CALLOC( nelem, elsize )	nslberi_calloc( nelem, elsize )</span>
<a href="#l18.225"></a><span id="l18.225" class="difflineminus">-#define NSLBERI_REALLOC( ptr, size )	nslberi_realloc( ptr, size )</span>
<a href="#l18.226"></a><span id="l18.226" class="difflineminus">-#define NSLBERI_FREE( ptr )		nslberi_free( ptr )</span>
<a href="#l18.227"></a><span id="l18.227" class="difflineplus">+#define NSLBERI_MALLOC( size ) nslberi_malloc( size )</span>
<a href="#l18.228"></a><span id="l18.228" class="difflineplus">+#define NSLBERI_CALLOC( nelem, elsize ) nslberi_calloc( nelem, elsize )</span>
<a href="#l18.229"></a><span id="l18.229" class="difflineplus">+#define NSLBERI_REALLOC( ptr, size ) nslberi_realloc( ptr, size )</span>
<a href="#l18.230"></a><span id="l18.230" class="difflineplus">+#define NSLBERI_FREE( ptr ) nslberi_free( ptr )</span>
<a href="#l18.231"></a><span id="l18.231"> </span>
<a href="#l18.232"></a><span id="l18.232"> /* allow the library to access the debug variable */</span>
<a href="#l18.233"></a><span id="l18.233"> </span>
<a href="#l18.234"></a><span id="l18.234"> extern int lber_debug;</span>
<a href="#l18.235"></a><span id="l18.235"> </span>
<a href="#l18.236"></a><span id="l18.236"> #endif /* !NSLBERI_LBER_INT_FRIEND */</span>
<a href="#l18.237"></a><span id="l18.237"> </span>
<a href="#l18.238"></a><span id="l18.238"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/ldap/c-sdk/libraries/libldap/ldap-int.h</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/ldap/c-sdk/libraries/libldap/ldap-int.h</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -43,17 +43,17 @@</span>
<a href="#l19.4"></a><span id="l19.4"> #include &lt;errno.h&gt;</span>
<a href="#l19.5"></a><span id="l19.5"> #include &lt;time.h&gt;</span>
<a href="#l19.6"></a><span id="l19.6"> #include &lt;fcntl.h&gt;</span>
<a href="#l19.7"></a><span id="l19.7"> #ifdef hpux</span>
<a href="#l19.8"></a><span id="l19.8"> #include &lt;strings.h&gt;</span>
<a href="#l19.9"></a><span id="l19.9"> #endif /* hpux */</span>
<a href="#l19.10"></a><span id="l19.10"> </span>
<a href="#l19.11"></a><span id="l19.11"> #ifdef _WINDOWS</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-#  define FD_SETSIZE		256	/* number of connections we support */</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+#  define FD_SETSIZE 256  /* number of connections we support */</span>
<a href="#l19.14"></a><span id="l19.14"> #  define WIN32_LEAN_AND_MEAN</span>
<a href="#l19.15"></a><span id="l19.15"> # include &lt;windows.h&gt;</span>
<a href="#l19.16"></a><span id="l19.16"> #elif defined(macintosh)</span>
<a href="#l19.17"></a><span id="l19.17"> #include &quot;ldap-macos.h&quot;</span>
<a href="#l19.18"></a><span id="l19.18"> #else /* _WINDOWS */</span>
<a href="#l19.19"></a><span id="l19.19"> # include &lt;sys/time.h&gt;</span>
<a href="#l19.20"></a><span id="l19.20"> # include &lt;sys/types.h&gt;</span>
<a href="#l19.21"></a><span id="l19.21"> # include &lt;sys/socket.h&gt;</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineat">@@ -84,20 +84,20 @@</span>
<a href="#l19.23"></a><span id="l19.23"> </span>
<a href="#l19.24"></a><span id="l19.24"> #include &quot;ldap.h&quot;</span>
<a href="#l19.25"></a><span id="l19.25"> #include &quot;ldaprot.h&quot;</span>
<a href="#l19.26"></a><span id="l19.26"> #include &quot;ldaplog.h&quot;</span>
<a href="#l19.27"></a><span id="l19.27"> #include &quot;portable.h&quot;</span>
<a href="#l19.28"></a><span id="l19.28"> </span>
<a href="#l19.29"></a><span id="l19.29"> #ifdef LDAP_ASYNC_IO</span>
<a href="#l19.30"></a><span id="l19.30"> #ifdef NEED_FILIO</span>
<a href="#l19.31"></a><span id="l19.31" class="difflineminus">-#include &lt;sys/filio.h&gt;		/* to get FIONBIO for ioctl() call */</span>
<a href="#l19.32"></a><span id="l19.32" class="difflineplus">+#include &lt;sys/filio.h&gt;  /* to get FIONBIO for ioctl() call */</span>
<a href="#l19.33"></a><span id="l19.33"> #else /* NEED_FILIO */</span>
<a href="#l19.34"></a><span id="l19.34"> #if !defined( _WINDOWS) &amp;&amp; !defined (macintosh)</span>
<a href="#l19.35"></a><span id="l19.35" class="difflineminus">-#include &lt;sys/ioctl.h&gt;		/* to get FIONBIO for ioctl() call */</span>
<a href="#l19.36"></a><span id="l19.36" class="difflineplus">+#include &lt;sys/ioctl.h&gt;  /* to get FIONBIO for ioctl() call */</span>
<a href="#l19.37"></a><span id="l19.37"> #endif /* _WINDOWS &amp;&amp; macintosh */</span>
<a href="#l19.38"></a><span id="l19.38"> #endif /* NEED_FILIO */</span>
<a href="#l19.39"></a><span id="l19.39"> #endif /* LDAP_ASYNC_IO */</span>
<a href="#l19.40"></a><span id="l19.40"> </span>
<a href="#l19.41"></a><span id="l19.41"> #ifdef USE_SYSCONF</span>
<a href="#l19.42"></a><span id="l19.42"> #  include &lt;unistd.h&gt;</span>
<a href="#l19.43"></a><span id="l19.43"> #endif /* USE_SYSCONF */</span>
<a href="#l19.44"></a><span id="l19.44"> </span>
<a href="#l19.45"></a><span id="l19.45" class="difflineat">@@ -105,150 +105,150 @@</span>
<a href="#l19.46"></a><span id="l19.46"> #include &lt;sasl.h&gt;</span>
<a href="#l19.47"></a><span id="l19.47"> #define SASL_MAX_BUFF_SIZE      65536</span>
<a href="#l19.48"></a><span id="l19.48"> #define SASL_MIN_BUFF_SIZE      4096</span>
<a href="#l19.49"></a><span id="l19.49"> #endif</span>
<a href="#l19.50"></a><span id="l19.50"> </span>
<a href="#l19.51"></a><span id="l19.51"> #if !defined(_WINDOWS) &amp;&amp; !defined(macintosh) &amp;&amp; !defined(BSDI) &amp;&amp; \</span>
<a href="#l19.52"></a><span id="l19.52">     !defined(XP_OS2) &amp;&amp; !defined(XP_BEOS) &amp;&amp; !defined(NTO) &amp;&amp; \</span>
<a href="#l19.53"></a><span id="l19.53">     !defined(DARWIN)</span>
<a href="#l19.54"></a><span id="l19.54" class="difflineminus">-#define NSLDAPI_HAVE_POLL	1</span>
<a href="#l19.55"></a><span id="l19.55" class="difflineplus">+#define NSLDAPI_HAVE_POLL 1</span>
<a href="#l19.56"></a><span id="l19.56"> #endif</span>
<a href="#l19.57"></a><span id="l19.57"> </span>
<a href="#l19.58"></a><span id="l19.58"> /* SSL version, or 0 if not built with SSL */</span>
<a href="#l19.59"></a><span id="l19.59"> #if defined(NET_SSL)</span>
<a href="#l19.60"></a><span id="l19.60"> #  define SSL_VERSION 3</span>
<a href="#l19.61"></a><span id="l19.61"> #else</span>
<a href="#l19.62"></a><span id="l19.62"> #  define SSL_VERSION 0</span>
<a href="#l19.63"></a><span id="l19.63"> #endif</span>
<a href="#l19.64"></a><span id="l19.64"> </span>
<a href="#l19.65"></a><span id="l19.65"> </span>
<a href="#l19.66"></a><span id="l19.66" class="difflineminus">-#define LDAP_URL_URLCOLON	&quot;URL:&quot;</span>
<a href="#l19.67"></a><span id="l19.67" class="difflineminus">-#define LDAP_URL_URLCOLON_LEN	4</span>
<a href="#l19.68"></a><span id="l19.68" class="difflineplus">+#define LDAP_URL_URLCOLON &quot;URL:&quot;</span>
<a href="#l19.69"></a><span id="l19.69" class="difflineplus">+#define LDAP_URL_URLCOLON_LEN 4</span>
<a href="#l19.70"></a><span id="l19.70"> </span>
<a href="#l19.71"></a><span id="l19.71" class="difflineminus">-#define LDAP_LDAP_REF_STR	LDAP_URL_PREFIX</span>
<a href="#l19.72"></a><span id="l19.72" class="difflineminus">-#define LDAP_LDAP_REF_STR_LEN	LDAP_URL_PREFIX_LEN</span>
<a href="#l19.73"></a><span id="l19.73" class="difflineminus">-#define LDAP_LDAPS_REF_STR	LDAPS_URL_PREFIX</span>
<a href="#l19.74"></a><span id="l19.74" class="difflineminus">-#define LDAP_LDAPS_REF_STR_LEN	LDAPS_URL_PREFIX_LEN</span>
<a href="#l19.75"></a><span id="l19.75" class="difflineplus">+#define LDAP_LDAP_REF_STR LDAP_URL_PREFIX</span>
<a href="#l19.76"></a><span id="l19.76" class="difflineplus">+#define LDAP_LDAP_REF_STR_LEN LDAP_URL_PREFIX_LEN</span>
<a href="#l19.77"></a><span id="l19.77" class="difflineplus">+#define LDAP_LDAPS_REF_STR LDAPS_URL_PREFIX</span>
<a href="#l19.78"></a><span id="l19.78" class="difflineplus">+#define LDAP_LDAPS_REF_STR_LEN LDAPS_URL_PREFIX_LEN</span>
<a href="#l19.79"></a><span id="l19.79"> </span>
<a href="#l19.80"></a><span id="l19.80"> /* default limit on nesting of referrals */</span>
<a href="#l19.81"></a><span id="l19.81" class="difflineminus">-#define LDAP_DEFAULT_REFHOPLIMIT	5</span>
<a href="#l19.82"></a><span id="l19.82" class="difflineplus">+#define LDAP_DEFAULT_REFHOPLIMIT 5</span>
<a href="#l19.83"></a><span id="l19.83"> #ifdef LDAP_DNS</span>
<a href="#l19.84"></a><span id="l19.84" class="difflineminus">-#define LDAP_DX_REF_STR		&quot;dx://&quot;</span>
<a href="#l19.85"></a><span id="l19.85" class="difflineminus">-#define LDAP_DX_REF_STR_LEN	5</span>
<a href="#l19.86"></a><span id="l19.86" class="difflineplus">+#define LDAP_DX_REF_STR &quot;dx://&quot;</span>
<a href="#l19.87"></a><span id="l19.87" class="difflineplus">+#define LDAP_DX_REF_STR_LEN 5</span>
<a href="#l19.88"></a><span id="l19.88"> #endif /* LDAP_DNS */</span>
<a href="#l19.89"></a><span id="l19.89"> </span>
<a href="#l19.90"></a><span id="l19.90"> typedef enum {</span>
<a href="#l19.91"></a><span id="l19.91">     LDAP_CACHE_LOCK,</span>
<a href="#l19.92"></a><span id="l19.92">     LDAP_MEMCACHE_LOCK,</span>
<a href="#l19.93"></a><span id="l19.93">     LDAP_MSGID_LOCK,</span>
<a href="#l19.94"></a><span id="l19.94">     LDAP_REQ_LOCK,</span>
<a href="#l19.95"></a><span id="l19.95">     LDAP_RESP_LOCK,</span>
<a href="#l19.96"></a><span id="l19.96">     LDAP_ABANDON_LOCK,</span>
<a href="#l19.97"></a><span id="l19.97">     LDAP_CTRL_LOCK,</span>
<a href="#l19.98"></a><span id="l19.98">     LDAP_OPTION_LOCK,</span>
<a href="#l19.99"></a><span id="l19.99">     LDAP_ERR_LOCK,</span>
<a href="#l19.100"></a><span id="l19.100">     LDAP_CONN_LOCK,</span>
<a href="#l19.101"></a><span id="l19.101" class="difflineminus">-    LDAP_IOSTATUS_LOCK,		/* serializes access to ld-&gt;ld_iostatus */</span>
<a href="#l19.102"></a><span id="l19.102" class="difflineplus">+    LDAP_IOSTATUS_LOCK,  /* serializes access to ld-&gt;ld_iostatus */</span>
<a href="#l19.103"></a><span id="l19.103">     LDAP_RESULT_LOCK,</span>
<a href="#l19.104"></a><span id="l19.104">     LDAP_PEND_LOCK,</span>
<a href="#l19.105"></a><span id="l19.105">     LDAP_THREADID_LOCK,</span>
<a href="#l19.106"></a><span id="l19.106"> #ifdef LDAP_SASLIO_HOOKS</span>
<a href="#l19.107"></a><span id="l19.107">     LDAP_SASL_LOCK,</span>
<a href="#l19.108"></a><span id="l19.108"> #endif</span>
<a href="#l19.109"></a><span id="l19.109">     LDAP_MAX_LOCK</span>
<a href="#l19.110"></a><span id="l19.110"> } LDAPLock;</span>
<a href="#l19.111"></a><span id="l19.111"> </span>
<a href="#l19.112"></a><span id="l19.112"> /*</span>
<a href="#l19.113"></a><span id="l19.113">  * This structure represents both ldap messages and ldap responses.</span>
<a href="#l19.114"></a><span id="l19.114">  * These are really the same, except in the case of search responses,</span>
<a href="#l19.115"></a><span id="l19.115">  * where a response has multiple messages.</span>
<a href="#l19.116"></a><span id="l19.116">  */</span>
<a href="#l19.117"></a><span id="l19.117"> </span>
<a href="#l19.118"></a><span id="l19.118"> struct ldapmsg {</span>
<a href="#l19.119"></a><span id="l19.119" class="difflineminus">-	int		lm_msgid;	/* the message id */</span>
<a href="#l19.120"></a><span id="l19.120" class="difflineminus">-	ber_tag_t	lm_msgtype;	/* the message type */</span>
<a href="#l19.121"></a><span id="l19.121" class="difflineminus">-	BerElement	*lm_ber;	/* the ber encoded message contents */</span>
<a href="#l19.122"></a><span id="l19.122" class="difflineminus">-	struct ldapmsg	*lm_chain;	/* for search - next msg in the resp */</span>
<a href="#l19.123"></a><span id="l19.123" class="difflineminus">-	struct ldapmsg	*lm_next;	/* next response */</span>
<a href="#l19.124"></a><span id="l19.124" class="difflineminus">-	int		lm_fromcache;	/* memcache: origin of message */</span>
<a href="#l19.125"></a><span id="l19.125" class="difflineplus">+  int lm_msgid;  /* the message id */</span>
<a href="#l19.126"></a><span id="l19.126" class="difflineplus">+  ber_tag_t lm_msgtype;  /* the message type */</span>
<a href="#l19.127"></a><span id="l19.127" class="difflineplus">+  BerElement *lm_ber;  /* the ber encoded message contents */</span>
<a href="#l19.128"></a><span id="l19.128" class="difflineplus">+  struct ldapmsg *lm_chain;  /* for search - next msg in the resp */</span>
<a href="#l19.129"></a><span id="l19.129" class="difflineplus">+  struct ldapmsg *lm_next;  /* next response */</span>
<a href="#l19.130"></a><span id="l19.130" class="difflineplus">+  int lm_fromcache;  /* memcache: origin of message */</span>
<a href="#l19.131"></a><span id="l19.131"> };</span>
<a href="#l19.132"></a><span id="l19.132"> </span>
<a href="#l19.133"></a><span id="l19.133"> /*</span>
<a href="#l19.134"></a><span id="l19.134">  * structure for tracking LDAP server host, ports, DNs, etc.</span>
<a href="#l19.135"></a><span id="l19.135">  */</span>
<a href="#l19.136"></a><span id="l19.136"> typedef struct ldap_server {</span>
<a href="#l19.137"></a><span id="l19.137" class="difflineminus">-	char			*lsrv_host;</span>
<a href="#l19.138"></a><span id="l19.138" class="difflineminus">-	char			*lsrv_dn;	/* if NULL, use default */</span>
<a href="#l19.139"></a><span id="l19.139" class="difflineminus">-	int			lsrv_port;</span>
<a href="#l19.140"></a><span id="l19.140" class="difflineminus">-	unsigned long		lsrv_options;	/* boolean options */</span>
<a href="#l19.141"></a><span id="l19.141" class="difflineminus">-#define LDAP_SRV_OPT_SECURE	0x01</span>
<a href="#l19.142"></a><span id="l19.142" class="difflineminus">-	struct ldap_server	*lsrv_next;</span>
<a href="#l19.143"></a><span id="l19.143" class="difflineplus">+  char *lsrv_host;</span>
<a href="#l19.144"></a><span id="l19.144" class="difflineplus">+  char *lsrv_dn;  /* if NULL, use default */</span>
<a href="#l19.145"></a><span id="l19.145" class="difflineplus">+  int lsrv_port;</span>
<a href="#l19.146"></a><span id="l19.146" class="difflineplus">+  unsigned long lsrv_options;  /* boolean options */</span>
<a href="#l19.147"></a><span id="l19.147" class="difflineplus">+#define LDAP_SRV_OPT_SECURE 0x01</span>
<a href="#l19.148"></a><span id="l19.148" class="difflineplus">+  struct ldap_server *lsrv_next;</span>
<a href="#l19.149"></a><span id="l19.149"> } LDAPServer;</span>
<a href="#l19.150"></a><span id="l19.150"> </span>
<a href="#l19.151"></a><span id="l19.151"> /*</span>
<a href="#l19.152"></a><span id="l19.152">  * structure for representing an LDAP server connection</span>
<a href="#l19.153"></a><span id="l19.153">  */</span>
<a href="#l19.154"></a><span id="l19.154"> typedef struct ldap_conn {</span>
<a href="#l19.155"></a><span id="l19.155" class="difflineminus">-	Sockbuf			*lconn_sb;</span>
<a href="#l19.156"></a><span id="l19.156" class="difflineminus">-	BerElement		*lconn_ber;  /* non-NULL if in midst of msg. */</span>
<a href="#l19.157"></a><span id="l19.157" class="difflineminus">-	int			lconn_version;	/* LDAP protocol version */</span>
<a href="#l19.158"></a><span id="l19.158" class="difflineminus">-	int			lconn_refcnt;</span>
<a href="#l19.159"></a><span id="l19.159" class="difflineminus">-	unsigned long		lconn_lastused;	/* time */</span>
<a href="#l19.160"></a><span id="l19.160" class="difflineminus">-	int			lconn_status;</span>
<a href="#l19.161"></a><span id="l19.161" class="difflineminus">-#define LDAP_CONNST_CONNECTING		2</span>
<a href="#l19.162"></a><span id="l19.162" class="difflineminus">-#define LDAP_CONNST_CONNECTED		3</span>
<a href="#l19.163"></a><span id="l19.163" class="difflineminus">-#define LDAP_CONNST_DEAD		4</span>
<a href="#l19.164"></a><span id="l19.164" class="difflineminus">-	LDAPServer		*lconn_server;</span>
<a href="#l19.165"></a><span id="l19.165" class="difflineminus">-	char			*lconn_binddn;	/* DN of last successful bind */</span>
<a href="#l19.166"></a><span id="l19.166" class="difflineminus">-	int			lconn_bound;	/* has a bind been done? */</span>
<a href="#l19.167"></a><span id="l19.167" class="difflineminus">-	int			lconn_pending_requests; /* count of unsent req*/</span>
<a href="#l19.168"></a><span id="l19.168" class="difflineminus">-	char			*lconn_krbinstance;</span>
<a href="#l19.169"></a><span id="l19.169" class="difflineplus">+  Sockbuf *lconn_sb;</span>
<a href="#l19.170"></a><span id="l19.170" class="difflineplus">+  BerElement *lconn_ber;  /* non-NULL if in midst of msg. */</span>
<a href="#l19.171"></a><span id="l19.171" class="difflineplus">+  int lconn_version;  /* LDAP protocol version */</span>
<a href="#l19.172"></a><span id="l19.172" class="difflineplus">+  int lconn_refcnt;</span>
<a href="#l19.173"></a><span id="l19.173" class="difflineplus">+  unsigned long lconn_lastused;  /* time */</span>
<a href="#l19.174"></a><span id="l19.174" class="difflineplus">+  int lconn_status;</span>
<a href="#l19.175"></a><span id="l19.175" class="difflineplus">+#define LDAP_CONNST_CONNECTING 2</span>
<a href="#l19.176"></a><span id="l19.176" class="difflineplus">+#define LDAP_CONNST_CONNECTED 3</span>
<a href="#l19.177"></a><span id="l19.177" class="difflineplus">+#define LDAP_CONNST_DEAD 4</span>
<a href="#l19.178"></a><span id="l19.178" class="difflineplus">+  LDAPServer *lconn_server;</span>
<a href="#l19.179"></a><span id="l19.179" class="difflineplus">+  char *lconn_binddn;  /* DN of last successful bind */</span>
<a href="#l19.180"></a><span id="l19.180" class="difflineplus">+  int lconn_bound;  /* has a bind been done? */</span>
<a href="#l19.181"></a><span id="l19.181" class="difflineplus">+  int lconn_pending_requests; /* count of unsent req*/</span>
<a href="#l19.182"></a><span id="l19.182" class="difflineplus">+  char *lconn_krbinstance;</span>
<a href="#l19.183"></a><span id="l19.183"> #ifdef LDAP_SASLIO_HOOKS</span>
<a href="#l19.184"></a><span id="l19.184">     sasl_conn_t     *lconn_sasl_ctx; /* the sasl connection context */</span>
<a href="#l19.185"></a><span id="l19.185"> #endif /* LDAP_SASLIO_HOOKS */</span>
<a href="#l19.186"></a><span id="l19.186" class="difflineminus">-	struct ldap_conn	*lconn_next;</span>
<a href="#l19.187"></a><span id="l19.187" class="difflineplus">+  struct ldap_conn *lconn_next;</span>
<a href="#l19.188"></a><span id="l19.188"> } LDAPConn;</span>
<a href="#l19.189"></a><span id="l19.189"> </span>
<a href="#l19.190"></a><span id="l19.190"> </span>
<a href="#l19.191"></a><span id="l19.191"> /*</span>
<a href="#l19.192"></a><span id="l19.192">  * structure used to track outstanding requests</span>
<a href="#l19.193"></a><span id="l19.193">  */</span>
<a href="#l19.194"></a><span id="l19.194"> typedef struct ldapreq {</span>
<a href="#l19.195"></a><span id="l19.195" class="difflineminus">-	int		lr_msgid;	/* the message id */</span>
<a href="#l19.196"></a><span id="l19.196" class="difflineminus">-	int		lr_status;	/* status of request */</span>
<a href="#l19.197"></a><span id="l19.197" class="difflineminus">-#define LDAP_REQST_INPROGRESS	1</span>
<a href="#l19.198"></a><span id="l19.198" class="difflineminus">-#define LDAP_REQST_CHASINGREFS	2</span>
<a href="#l19.199"></a><span id="l19.199" class="difflineminus">-#define LDAP_REQST_WRITING	4</span>
<a href="#l19.200"></a><span id="l19.200" class="difflineminus">-#define LDAP_REQST_CONNDEAD	5	/* associated conn. has failed */</span>
<a href="#l19.201"></a><span id="l19.201" class="difflineminus">-	int		lr_outrefcnt;	/* count of outstanding referrals */</span>
<a href="#l19.202"></a><span id="l19.202" class="difflineminus">-	int		lr_origid;	/* original request's message id */</span>
<a href="#l19.203"></a><span id="l19.203" class="difflineminus">-	int		lr_parentcnt;	/* count of parent requests */</span>
<a href="#l19.204"></a><span id="l19.204" class="difflineminus">-	ber_tag_t	lr_res_msgtype;	/* result message type */</span>
<a href="#l19.205"></a><span id="l19.205" class="difflineminus">-	int		lr_expect_resp;	/* if non-zero, expect a response */</span>
<a href="#l19.206"></a><span id="l19.206" class="difflineminus">-	int		lr_res_errno;	/* result LDAP errno */</span>
<a href="#l19.207"></a><span id="l19.207" class="difflineminus">-	char		*lr_res_error;	/* result error string */</span>
<a href="#l19.208"></a><span id="l19.208" class="difflineminus">-	char		*lr_res_matched;/* result matched DN string */</span>
<a href="#l19.209"></a><span id="l19.209" class="difflineminus">-	BerElement	*lr_ber;	/* ber encoded request contents */</span>
<a href="#l19.210"></a><span id="l19.210" class="difflineminus">-	LDAPConn	*lr_conn;	/* connection used to send request */</span>
<a href="#l19.211"></a><span id="l19.211" class="difflineminus">-	char		*lr_binddn;	/* request is a bind for this DN */</span>
<a href="#l19.212"></a><span id="l19.212" class="difflineminus">-	struct ldapreq	*lr_parent;	/* request that spawned this referral */</span>
<a href="#l19.213"></a><span id="l19.213" class="difflineminus">-	struct ldapreq	*lr_child;	/* list of requests we spawned */</span>
<a href="#l19.214"></a><span id="l19.214" class="difflineminus">-	struct ldapreq	*lr_sibling;	/* next referral spawned */</span>
<a href="#l19.215"></a><span id="l19.215" class="difflineminus">-	struct ldapreq	*lr_prev;	/* ld-&gt;ld_requests previous request */</span>
<a href="#l19.216"></a><span id="l19.216" class="difflineminus">-	struct ldapreq	*lr_next;	/* ld-&gt;ld_requests next request */</span>
<a href="#l19.217"></a><span id="l19.217" class="difflineminus">-	LDAPControl	**lr_res_ctrls; /* result controls */</span>
<a href="#l19.218"></a><span id="l19.218" class="difflineplus">+  int lr_msgid;  /* the message id */</span>
<a href="#l19.219"></a><span id="l19.219" class="difflineplus">+  int lr_status;  /* status of request */</span>
<a href="#l19.220"></a><span id="l19.220" class="difflineplus">+#define LDAP_REQST_INPROGRESS 1</span>
<a href="#l19.221"></a><span id="l19.221" class="difflineplus">+#define LDAP_REQST_CHASINGREFS 2</span>
<a href="#l19.222"></a><span id="l19.222" class="difflineplus">+#define LDAP_REQST_WRITING 4</span>
<a href="#l19.223"></a><span id="l19.223" class="difflineplus">+#define LDAP_REQST_CONNDEAD 5  /* associated conn. has failed */</span>
<a href="#l19.224"></a><span id="l19.224" class="difflineplus">+  int lr_outrefcnt;  /* count of outstanding referrals */</span>
<a href="#l19.225"></a><span id="l19.225" class="difflineplus">+  int lr_origid;  /* original request's message id */</span>
<a href="#l19.226"></a><span id="l19.226" class="difflineplus">+  int lr_parentcnt;  /* count of parent requests */</span>
<a href="#l19.227"></a><span id="l19.227" class="difflineplus">+  ber_tag_t lr_res_msgtype;  /* result message type */</span>
<a href="#l19.228"></a><span id="l19.228" class="difflineplus">+  int lr_expect_resp;  /* if non-zero, expect a response */</span>
<a href="#l19.229"></a><span id="l19.229" class="difflineplus">+  int lr_res_errno;  /* result LDAP errno */</span>
<a href="#l19.230"></a><span id="l19.230" class="difflineplus">+  char *lr_res_error;  /* result error string */</span>
<a href="#l19.231"></a><span id="l19.231" class="difflineplus">+  char *lr_res_matched;/* result matched DN string */</span>
<a href="#l19.232"></a><span id="l19.232" class="difflineplus">+  BerElement *lr_ber;  /* ber encoded request contents */</span>
<a href="#l19.233"></a><span id="l19.233" class="difflineplus">+  LDAPConn *lr_conn;  /* connection used to send request */</span>
<a href="#l19.234"></a><span id="l19.234" class="difflineplus">+  char *lr_binddn;  /* request is a bind for this DN */</span>
<a href="#l19.235"></a><span id="l19.235" class="difflineplus">+  struct ldapreq *lr_parent;  /* request that spawned this referral */</span>
<a href="#l19.236"></a><span id="l19.236" class="difflineplus">+  struct ldapreq *lr_child;  /* list of requests we spawned */</span>
<a href="#l19.237"></a><span id="l19.237" class="difflineplus">+  struct ldapreq *lr_sibling;  /* next referral spawned */</span>
<a href="#l19.238"></a><span id="l19.238" class="difflineplus">+  struct ldapreq *lr_prev;  /* ld-&gt;ld_requests previous request */</span>
<a href="#l19.239"></a><span id="l19.239" class="difflineplus">+  struct ldapreq *lr_next;  /* ld-&gt;ld_requests next request */</span>
<a href="#l19.240"></a><span id="l19.240" class="difflineplus">+  LDAPControl **lr_res_ctrls; /* result controls */</span>
<a href="#l19.241"></a><span id="l19.241"> } LDAPRequest;</span>
<a href="#l19.242"></a><span id="l19.242"> </span>
<a href="#l19.243"></a><span id="l19.243"> typedef struct ldappend {</span>
<a href="#l19.244"></a><span id="l19.244" class="difflineminus">-	void		*lp_sema;	/* semaphore to post */</span>
<a href="#l19.245"></a><span id="l19.245" class="difflineminus">-	int		lp_msgid;	/* message id */</span>
<a href="#l19.246"></a><span id="l19.246" class="difflineminus">-	LDAPMessage	*lp_result;	/* result storage */</span>
<a href="#l19.247"></a><span id="l19.247" class="difflineminus">-	struct ldappend	*lp_prev;	/* previous pending */</span>
<a href="#l19.248"></a><span id="l19.248" class="difflineminus">-	struct ldappend	*lp_next;	/* next pending */</span>
<a href="#l19.249"></a><span id="l19.249" class="difflineplus">+  void *lp_sema;  /* semaphore to post */</span>
<a href="#l19.250"></a><span id="l19.250" class="difflineplus">+  int lp_msgid;  /* message id */</span>
<a href="#l19.251"></a><span id="l19.251" class="difflineplus">+  LDAPMessage *lp_result;  /* result storage */</span>
<a href="#l19.252"></a><span id="l19.252" class="difflineplus">+  struct ldappend *lp_prev;  /* previous pending */</span>
<a href="#l19.253"></a><span id="l19.253" class="difflineplus">+  struct ldappend *lp_next;  /* next pending */</span>
<a href="#l19.254"></a><span id="l19.254"> } LDAPPend;</span>
<a href="#l19.255"></a><span id="l19.255"> </span>
<a href="#l19.256"></a><span id="l19.256"> /*</span>
<a href="#l19.257"></a><span id="l19.257">  * forward declaration for I/O status structure (defined in os-ip.c)</span>
<a href="#l19.258"></a><span id="l19.258">  */</span>
<a href="#l19.259"></a><span id="l19.259"> typedef struct nsldapi_iostatus_info NSLDAPIIOStatus;</span>
<a href="#l19.260"></a><span id="l19.260"> </span>
<a href="#l19.261"></a><span id="l19.261"> /*</span>
<a href="#l19.262"></a><span id="l19.262" class="difflineat">@@ -270,176 +270,176 @@ struct ldap_x_ext_io_fns_rev0 {</span>
<a href="#l19.263"></a><span id="l19.263"> </span>
<a href="#l19.264"></a><span id="l19.264"> /*</span>
<a href="#l19.265"></a><span id="l19.265">  * Structure representing an ldap connection.</span>
<a href="#l19.266"></a><span id="l19.266">  *</span>
<a href="#l19.267"></a><span id="l19.267">  * This is an opaque struct; the fields are not visible to</span>
<a href="#l19.268"></a><span id="l19.268">  * applications that use the LDAP API.</span>
<a href="#l19.269"></a><span id="l19.269">  */</span>
<a href="#l19.270"></a><span id="l19.270"> struct ldap {</span>
<a href="#l19.271"></a><span id="l19.271" class="difflineminus">-	struct sockbuf	*ld_sbp;	/* pointer to socket desc. &amp; buffer */</span>
<a href="#l19.272"></a><span id="l19.272" class="difflineminus">-	char		*ld_host;</span>
<a href="#l19.273"></a><span id="l19.273" class="difflineminus">-	int		ld_version;	/* LDAP protocol version */</span>
<a href="#l19.274"></a><span id="l19.274" class="difflineminus">-	char		ld_lberoptions;</span>
<a href="#l19.275"></a><span id="l19.275" class="difflineminus">-	int		ld_deref;</span>
<a href="#l19.276"></a><span id="l19.276" class="difflineplus">+  struct sockbuf *ld_sbp;  /* pointer to socket desc. &amp; buffer */</span>
<a href="#l19.277"></a><span id="l19.277" class="difflineplus">+  char *ld_host;</span>
<a href="#l19.278"></a><span id="l19.278" class="difflineplus">+  int ld_version;  /* LDAP protocol version */</span>
<a href="#l19.279"></a><span id="l19.279" class="difflineplus">+  char ld_lberoptions;</span>
<a href="#l19.280"></a><span id="l19.280" class="difflineplus">+  int ld_deref;</span>
<a href="#l19.281"></a><span id="l19.281"> </span>
<a href="#l19.282"></a><span id="l19.282" class="difflineminus">-	int		ld_timelimit;</span>
<a href="#l19.283"></a><span id="l19.283" class="difflineminus">-	int		ld_sizelimit;</span>
<a href="#l19.284"></a><span id="l19.284" class="difflineplus">+  int ld_timelimit;</span>
<a href="#l19.285"></a><span id="l19.285" class="difflineplus">+  int ld_sizelimit;</span>
<a href="#l19.286"></a><span id="l19.286"> </span>
<a href="#l19.287"></a><span id="l19.287" class="difflineminus">-	struct ldap_filt_desc	*ld_filtd;	/* from getfilter for ufn searches */</span>
<a href="#l19.288"></a><span id="l19.288" class="difflineminus">-	char		*ld_ufnprefix;	/* for incomplete ufn's */</span>
<a href="#l19.289"></a><span id="l19.289" class="difflineplus">+  struct ldap_filt_desc *ld_filtd;  /* from getfilter for ufn searches */</span>
<a href="#l19.290"></a><span id="l19.290" class="difflineplus">+  char *ld_ufnprefix;  /* for incomplete ufn's */</span>
<a href="#l19.291"></a><span id="l19.291"> </span>
<a href="#l19.292"></a><span id="l19.292" class="difflineminus">-	int		ld_errno;</span>
<a href="#l19.293"></a><span id="l19.293" class="difflineminus">-	char		*ld_error;</span>
<a href="#l19.294"></a><span id="l19.294" class="difflineminus">-	char		*ld_matched;</span>
<a href="#l19.295"></a><span id="l19.295" class="difflineminus">-	int		ld_msgid;</span>
<a href="#l19.296"></a><span id="l19.296" class="difflineplus">+  int ld_errno;</span>
<a href="#l19.297"></a><span id="l19.297" class="difflineplus">+  char *ld_error;</span>
<a href="#l19.298"></a><span id="l19.298" class="difflineplus">+  char *ld_matched;</span>
<a href="#l19.299"></a><span id="l19.299" class="difflineplus">+  int ld_msgid;</span>
<a href="#l19.300"></a><span id="l19.300"> </span>
<a href="#l19.301"></a><span id="l19.301" class="difflineminus">-	/* Note: the ld_requests list is ordered old to new */</span>
<a href="#l19.302"></a><span id="l19.302" class="difflineminus">-	LDAPRequest	*ld_requests;	/* list of outstanding requests */</span>
<a href="#l19.303"></a><span id="l19.303" class="difflineminus">-	LDAPMessage	*ld_responses;	/* list of outstanding responses */</span>
<a href="#l19.304"></a><span id="l19.304" class="difflineminus">-	int		*ld_abandoned;	/* array of abandoned requests */</span>
<a href="#l19.305"></a><span id="l19.305" class="difflineminus">-	char		*ld_cldapdn;	/* DN used in connectionless search */</span>
<a href="#l19.306"></a><span id="l19.306" class="difflineplus">+  /* Note: the ld_requests list is ordered old to new */</span>
<a href="#l19.307"></a><span id="l19.307" class="difflineplus">+  LDAPRequest *ld_requests;  /* list of outstanding requests */</span>
<a href="#l19.308"></a><span id="l19.308" class="difflineplus">+  LDAPMessage *ld_responses;  /* list of outstanding responses */</span>
<a href="#l19.309"></a><span id="l19.309" class="difflineplus">+  int *ld_abandoned;  /* array of abandoned requests */</span>
<a href="#l19.310"></a><span id="l19.310" class="difflineplus">+  char *ld_cldapdn;  /* DN used in connectionless search */</span>
<a href="#l19.311"></a><span id="l19.311"> </span>
<a href="#l19.312"></a><span id="l19.312" class="difflineminus">-	int		ld_cldaptries;	/* connectionless search retry count */</span>
<a href="#l19.313"></a><span id="l19.313" class="difflineminus">-	int		ld_cldaptimeout;/* time between retries */</span>
<a href="#l19.314"></a><span id="l19.314" class="difflineminus">-	int		ld_refhoplimit;	/* limit on referral nesting */</span>
<a href="#l19.315"></a><span id="l19.315" class="difflineminus">-	unsigned long	ld_options;	/* boolean options */</span>
<a href="#l19.316"></a><span id="l19.316" class="difflineplus">+  int ld_cldaptries;  /* connectionless search retry count */</span>
<a href="#l19.317"></a><span id="l19.317" class="difflineplus">+  int ld_cldaptimeout;/* time between retries */</span>
<a href="#l19.318"></a><span id="l19.318" class="difflineplus">+  int ld_refhoplimit;  /* limit on referral nesting */</span>
<a href="#l19.319"></a><span id="l19.319" class="difflineplus">+  unsigned long ld_options;  /* boolean options */</span>
<a href="#l19.320"></a><span id="l19.320"> </span>
<a href="#l19.321"></a><span id="l19.321" class="difflineminus">-#define LDAP_BITOPT_REFERRALS	0x80000000</span>
<a href="#l19.322"></a><span id="l19.322" class="difflineminus">-#define LDAP_BITOPT_SSL		0x40000000</span>
<a href="#l19.323"></a><span id="l19.323" class="difflineminus">-#define LDAP_BITOPT_DNS		0x20000000</span>
<a href="#l19.324"></a><span id="l19.324" class="difflineminus">-#define LDAP_BITOPT_RESTART	0x10000000</span>
<a href="#l19.325"></a><span id="l19.325" class="difflineminus">-#define LDAP_BITOPT_RECONNECT	0x08000000</span>
<a href="#l19.326"></a><span id="l19.326" class="difflineplus">+#define LDAP_BITOPT_REFERRALS 0x80000000</span>
<a href="#l19.327"></a><span id="l19.327" class="difflineplus">+#define LDAP_BITOPT_SSL 0x40000000</span>
<a href="#l19.328"></a><span id="l19.328" class="difflineplus">+#define LDAP_BITOPT_DNS 0x20000000</span>
<a href="#l19.329"></a><span id="l19.329" class="difflineplus">+#define LDAP_BITOPT_RESTART 0x10000000</span>
<a href="#l19.330"></a><span id="l19.330" class="difflineplus">+#define LDAP_BITOPT_RECONNECT 0x08000000</span>
<a href="#l19.331"></a><span id="l19.331"> #define LDAP_BITOPT_ASYNC       0x04000000</span>
<a href="#l19.332"></a><span id="l19.332"> #define LDAP_BITOPT_NOREBIND    0x02000000</span>
<a href="#l19.333"></a><span id="l19.333"> </span>
<a href="#l19.334"></a><span id="l19.334" class="difflineminus">-	char		*ld_defhost;	/* full name of default server */</span>
<a href="#l19.335"></a><span id="l19.335" class="difflineminus">-	int		ld_defport;	/* port of default server */</span>
<a href="#l19.336"></a><span id="l19.336" class="difflineminus">-	BERTranslateProc ld_lber_encode_translate_proc;</span>
<a href="#l19.337"></a><span id="l19.337" class="difflineminus">-	BERTranslateProc ld_lber_decode_translate_proc;</span>
<a href="#l19.338"></a><span id="l19.338" class="difflineminus">-	LDAPConn	*ld_defconn;	/* default connection */</span>
<a href="#l19.339"></a><span id="l19.339" class="difflineminus">-	LDAPConn	*ld_conns;	/* list of all server connections */</span>
<a href="#l19.340"></a><span id="l19.340" class="difflineminus">-	NSLDAPIIOStatus	*ld_iostatus;	/* status info. about network sockets */</span>
<a href="#l19.341"></a><span id="l19.341" class="difflineminus">-	LDAP_REBINDPROC_CALLBACK *ld_rebind_fn;</span>
<a href="#l19.342"></a><span id="l19.342" class="difflineminus">-	void		*ld_rebind_arg;</span>
<a href="#l19.343"></a><span id="l19.343" class="difflineplus">+  char *ld_defhost;  /* full name of default server */</span>
<a href="#l19.344"></a><span id="l19.344" class="difflineplus">+  int ld_defport;  /* port of default server */</span>
<a href="#l19.345"></a><span id="l19.345" class="difflineplus">+  BERTranslateProc ld_lber_encode_translate_proc;</span>
<a href="#l19.346"></a><span id="l19.346" class="difflineplus">+  BERTranslateProc ld_lber_decode_translate_proc;</span>
<a href="#l19.347"></a><span id="l19.347" class="difflineplus">+  LDAPConn *ld_defconn;  /* default connection */</span>
<a href="#l19.348"></a><span id="l19.348" class="difflineplus">+  LDAPConn *ld_conns;  /* list of all server connections */</span>
<a href="#l19.349"></a><span id="l19.349" class="difflineplus">+  NSLDAPIIOStatus *ld_iostatus;  /* status info. about network sockets */</span>
<a href="#l19.350"></a><span id="l19.350" class="difflineplus">+  LDAP_REBINDPROC_CALLBACK *ld_rebind_fn;</span>
<a href="#l19.351"></a><span id="l19.351" class="difflineplus">+  void *ld_rebind_arg;</span>
<a href="#l19.352"></a><span id="l19.352"> </span>
<a href="#l19.353"></a><span id="l19.353" class="difflineminus">-	/* function pointers, etc. for extended I/O */</span>
<a href="#l19.354"></a><span id="l19.354" class="difflineminus">-	struct ldap_x_ext_io_fns ld_ext_io_fns;</span>
<a href="#l19.355"></a><span id="l19.355" class="difflineminus">-#define ld_extio_size		ld_ext_io_fns.lextiof_size</span>
<a href="#l19.356"></a><span id="l19.356" class="difflineminus">-#define ld_extclose_fn		ld_ext_io_fns.lextiof_close</span>
<a href="#l19.357"></a><span id="l19.357" class="difflineminus">-#define ld_extconnect_fn	ld_ext_io_fns.lextiof_connect</span>
<a href="#l19.358"></a><span id="l19.358" class="difflineminus">-#define ld_extread_fn		ld_ext_io_fns.lextiof_read</span>
<a href="#l19.359"></a><span id="l19.359" class="difflineminus">-#define ld_extwrite_fn		ld_ext_io_fns.lextiof_write</span>
<a href="#l19.360"></a><span id="l19.360" class="difflineplus">+  /* function pointers, etc. for extended I/O */</span>
<a href="#l19.361"></a><span id="l19.361" class="difflineplus">+  struct ldap_x_ext_io_fns ld_ext_io_fns;</span>
<a href="#l19.362"></a><span id="l19.362" class="difflineplus">+#define ld_extio_size ld_ext_io_fns.lextiof_size</span>
<a href="#l19.363"></a><span id="l19.363" class="difflineplus">+#define ld_extclose_fn ld_ext_io_fns.lextiof_close</span>
<a href="#l19.364"></a><span id="l19.364" class="difflineplus">+#define ld_extconnect_fn ld_ext_io_fns.lextiof_connect</span>
<a href="#l19.365"></a><span id="l19.365" class="difflineplus">+#define ld_extread_fn ld_ext_io_fns.lextiof_read</span>
<a href="#l19.366"></a><span id="l19.366" class="difflineplus">+#define ld_extwrite_fn ld_ext_io_fns.lextiof_write</span>
<a href="#l19.367"></a><span id="l19.367"> #define ld_extwritev_fn         ld_ext_io_fns.lextiof_writev</span>
<a href="#l19.368"></a><span id="l19.368" class="difflineminus">-#define ld_extpoll_fn		ld_ext_io_fns.lextiof_poll</span>
<a href="#l19.369"></a><span id="l19.369" class="difflineminus">-#define ld_extnewhandle_fn	ld_ext_io_fns.lextiof_newhandle</span>
<a href="#l19.370"></a><span id="l19.370" class="difflineminus">-#define ld_extdisposehandle_fn	ld_ext_io_fns.lextiof_disposehandle</span>
<a href="#l19.371"></a><span id="l19.371" class="difflineminus">-#define ld_ext_session_arg	ld_ext_io_fns.lextiof_session_arg</span>
<a href="#l19.372"></a><span id="l19.372" class="difflineplus">+#define ld_extpoll_fn ld_ext_io_fns.lextiof_poll</span>
<a href="#l19.373"></a><span id="l19.373" class="difflineplus">+#define ld_extnewhandle_fn ld_ext_io_fns.lextiof_newhandle</span>
<a href="#l19.374"></a><span id="l19.374" class="difflineplus">+#define ld_extdisposehandle_fn ld_ext_io_fns.lextiof_disposehandle</span>
<a href="#l19.375"></a><span id="l19.375" class="difflineplus">+#define ld_ext_session_arg ld_ext_io_fns.lextiof_session_arg</span>
<a href="#l19.376"></a><span id="l19.376"> </span>
<a href="#l19.377"></a><span id="l19.377" class="difflineminus">-	/* allocated pointer for older I/O functions */</span>
<a href="#l19.378"></a><span id="l19.378" class="difflineminus">-	struct ldap_io_fns	*ld_io_fns_ptr;</span>
<a href="#l19.379"></a><span id="l19.379" class="difflineplus">+  /* allocated pointer for older I/O functions */</span>
<a href="#l19.380"></a><span id="l19.380" class="difflineplus">+  struct ldap_io_fns *ld_io_fns_ptr;</span>
<a href="#l19.381"></a><span id="l19.381"> #define NSLDAPI_USING_CLASSIC_IO_FUNCTIONS( ld ) ((ld)-&gt;ld_io_fns_ptr != NULL)</span>
<a href="#l19.382"></a><span id="l19.382"> </span>
<a href="#l19.383"></a><span id="l19.383" class="difflineminus">-	/* function pointers, etc. for DNS */</span>
<a href="#l19.384"></a><span id="l19.384" class="difflineminus">-	struct ldap_dns_fns	ld_dnsfn;</span>
<a href="#l19.385"></a><span id="l19.385" class="difflineminus">-#define ld_dns_extradata	ld_dnsfn.lddnsfn_extradata</span>
<a href="#l19.386"></a><span id="l19.386" class="difflineminus">-#define ld_dns_bufsize		ld_dnsfn.lddnsfn_bufsize</span>
<a href="#l19.387"></a><span id="l19.387" class="difflineminus">-#define ld_dns_gethostbyname_fn	ld_dnsfn.lddnsfn_gethostbyname</span>
<a href="#l19.388"></a><span id="l19.388" class="difflineminus">-#define ld_dns_gethostbyaddr_fn	ld_dnsfn.lddnsfn_gethostbyaddr</span>
<a href="#l19.389"></a><span id="l19.389" class="difflineplus">+  /* function pointers, etc. for DNS */</span>
<a href="#l19.390"></a><span id="l19.390" class="difflineplus">+  struct ldap_dns_fns ld_dnsfn;</span>
<a href="#l19.391"></a><span id="l19.391" class="difflineplus">+#define ld_dns_extradata ld_dnsfn.lddnsfn_extradata</span>
<a href="#l19.392"></a><span id="l19.392" class="difflineplus">+#define ld_dns_bufsize ld_dnsfn.lddnsfn_bufsize</span>
<a href="#l19.393"></a><span id="l19.393" class="difflineplus">+#define ld_dns_gethostbyname_fn ld_dnsfn.lddnsfn_gethostbyname</span>
<a href="#l19.394"></a><span id="l19.394" class="difflineplus">+#define ld_dns_gethostbyaddr_fn ld_dnsfn.lddnsfn_gethostbyaddr</span>
<a href="#l19.395"></a><span id="l19.395"> #define ld_dns_getpeername_fn   ld_dnsfn.lddnsfn_getpeername</span>
<a href="#l19.396"></a><span id="l19.396"> </span>
<a href="#l19.397"></a><span id="l19.397" class="difflineminus">-	/* function pointers, etc. for threading */</span>
<a href="#l19.398"></a><span id="l19.398" class="difflineminus">-	struct ldap_thread_fns	ld_thread;</span>
<a href="#l19.399"></a><span id="l19.399" class="difflineminus">-#define ld_mutex_alloc_fn	ld_thread.ltf_mutex_alloc</span>
<a href="#l19.400"></a><span id="l19.400" class="difflineminus">-#define ld_mutex_free_fn	ld_thread.ltf_mutex_free</span>
<a href="#l19.401"></a><span id="l19.401" class="difflineminus">-#define ld_mutex_lock_fn	ld_thread.ltf_mutex_lock</span>
<a href="#l19.402"></a><span id="l19.402" class="difflineminus">-#define ld_mutex_unlock_fn	ld_thread.ltf_mutex_unlock</span>
<a href="#l19.403"></a><span id="l19.403" class="difflineminus">-#define ld_get_errno_fn		ld_thread.ltf_get_errno</span>
<a href="#l19.404"></a><span id="l19.404" class="difflineminus">-#define ld_set_errno_fn		ld_thread.ltf_set_errno</span>
<a href="#l19.405"></a><span id="l19.405" class="difflineminus">-#define ld_get_lderrno_fn	ld_thread.ltf_get_lderrno</span>
<a href="#l19.406"></a><span id="l19.406" class="difflineminus">-#define ld_set_lderrno_fn	ld_thread.ltf_set_lderrno</span>
<a href="#l19.407"></a><span id="l19.407" class="difflineminus">-#define ld_lderrno_arg		ld_thread.ltf_lderrno_arg</span>
<a href="#l19.408"></a><span id="l19.408" class="difflineminus">-	void			**ld_mutex;</span>
<a href="#l19.409"></a><span id="l19.409" class="difflineplus">+  /* function pointers, etc. for threading */</span>
<a href="#l19.410"></a><span id="l19.410" class="difflineplus">+  struct ldap_thread_fns ld_thread;</span>
<a href="#l19.411"></a><span id="l19.411" class="difflineplus">+#define ld_mutex_alloc_fn ld_thread.ltf_mutex_alloc</span>
<a href="#l19.412"></a><span id="l19.412" class="difflineplus">+#define ld_mutex_free_fn ld_thread.ltf_mutex_free</span>
<a href="#l19.413"></a><span id="l19.413" class="difflineplus">+#define ld_mutex_lock_fn ld_thread.ltf_mutex_lock</span>
<a href="#l19.414"></a><span id="l19.414" class="difflineplus">+#define ld_mutex_unlock_fn ld_thread.ltf_mutex_unlock</span>
<a href="#l19.415"></a><span id="l19.415" class="difflineplus">+#define ld_get_errno_fn ld_thread.ltf_get_errno</span>
<a href="#l19.416"></a><span id="l19.416" class="difflineplus">+#define ld_set_errno_fn ld_thread.ltf_set_errno</span>
<a href="#l19.417"></a><span id="l19.417" class="difflineplus">+#define ld_get_lderrno_fn ld_thread.ltf_get_lderrno</span>
<a href="#l19.418"></a><span id="l19.418" class="difflineplus">+#define ld_set_lderrno_fn ld_thread.ltf_set_lderrno</span>
<a href="#l19.419"></a><span id="l19.419" class="difflineplus">+#define ld_lderrno_arg ld_thread.ltf_lderrno_arg</span>
<a href="#l19.420"></a><span id="l19.420" class="difflineplus">+  void **ld_mutex;</span>
<a href="#l19.421"></a><span id="l19.421"> </span>
<a href="#l19.422"></a><span id="l19.422" class="difflineminus">-	/* function pointers, etc. for caching */</span>
<a href="#l19.423"></a><span id="l19.423" class="difflineminus">-	int			ld_cache_on;</span>
<a href="#l19.424"></a><span id="l19.424" class="difflineminus">-	int			ld_cache_strategy;</span>
<a href="#l19.425"></a><span id="l19.425" class="difflineminus">-	struct ldap_cache_fns	ld_cache;</span>
<a href="#l19.426"></a><span id="l19.426" class="difflineminus">-#define ld_cache_config		ld_cache.lcf_config</span>
<a href="#l19.427"></a><span id="l19.427" class="difflineminus">-#define ld_cache_bind		ld_cache.lcf_bind</span>
<a href="#l19.428"></a><span id="l19.428" class="difflineminus">-#define ld_cache_unbind		ld_cache.lcf_unbind</span>
<a href="#l19.429"></a><span id="l19.429" class="difflineminus">-#define ld_cache_search		ld_cache.lcf_search</span>
<a href="#l19.430"></a><span id="l19.430" class="difflineminus">-#define ld_cache_compare	ld_cache.lcf_compare</span>
<a href="#l19.431"></a><span id="l19.431" class="difflineminus">-#define ld_cache_add		ld_cache.lcf_add</span>
<a href="#l19.432"></a><span id="l19.432" class="difflineminus">-#define ld_cache_delete		ld_cache.lcf_delete</span>
<a href="#l19.433"></a><span id="l19.433" class="difflineplus">+  /* function pointers, etc. for caching */</span>
<a href="#l19.434"></a><span id="l19.434" class="difflineplus">+  int ld_cache_on;</span>
<a href="#l19.435"></a><span id="l19.435" class="difflineplus">+  int ld_cache_strategy;</span>
<a href="#l19.436"></a><span id="l19.436" class="difflineplus">+  struct ldap_cache_fns ld_cache;</span>
<a href="#l19.437"></a><span id="l19.437" class="difflineplus">+#define ld_cache_config ld_cache.lcf_config</span>
<a href="#l19.438"></a><span id="l19.438" class="difflineplus">+#define ld_cache_bind ld_cache.lcf_bind</span>
<a href="#l19.439"></a><span id="l19.439" class="difflineplus">+#define ld_cache_unbind ld_cache.lcf_unbind</span>
<a href="#l19.440"></a><span id="l19.440" class="difflineplus">+#define ld_cache_search ld_cache.lcf_search</span>
<a href="#l19.441"></a><span id="l19.441" class="difflineplus">+#define ld_cache_compare ld_cache.lcf_compare</span>
<a href="#l19.442"></a><span id="l19.442" class="difflineplus">+#define ld_cache_add ld_cache.lcf_add</span>
<a href="#l19.443"></a><span id="l19.443" class="difflineplus">+#define ld_cache_delete ld_cache.lcf_delete</span>
<a href="#l19.444"></a><span id="l19.444"> #if 0</span>
<a href="#l19.445"></a><span id="l19.445" class="difflineminus">-#define ld_cache_rename		ld_cache.lcf_rename</span>
<a href="#l19.446"></a><span id="l19.446" class="difflineplus">+#define ld_cache_rename ld_cache.lcf_rename</span>
<a href="#l19.447"></a><span id="l19.447"> #endif</span>
<a href="#l19.448"></a><span id="l19.448" class="difflineminus">-#define ld_cache_modify		ld_cache.lcf_modify</span>
<a href="#l19.449"></a><span id="l19.449" class="difflineminus">-#define ld_cache_modrdn		ld_cache.lcf_modrdn</span>
<a href="#l19.450"></a><span id="l19.450" class="difflineminus">-#define ld_cache_abandon	ld_cache.lcf_abandon</span>
<a href="#l19.451"></a><span id="l19.451" class="difflineminus">-#define ld_cache_result		ld_cache.lcf_result</span>
<a href="#l19.452"></a><span id="l19.452" class="difflineminus">-#define ld_cache_flush		ld_cache.lcf_flush</span>
<a href="#l19.453"></a><span id="l19.453" class="difflineminus">-#define ld_cache_arg		ld_cache.lcf_arg</span>
<a href="#l19.454"></a><span id="l19.454" class="difflineplus">+#define ld_cache_modify ld_cache.lcf_modify</span>
<a href="#l19.455"></a><span id="l19.455" class="difflineplus">+#define ld_cache_modrdn ld_cache.lcf_modrdn</span>
<a href="#l19.456"></a><span id="l19.456" class="difflineplus">+#define ld_cache_abandon ld_cache.lcf_abandon</span>
<a href="#l19.457"></a><span id="l19.457" class="difflineplus">+#define ld_cache_result ld_cache.lcf_result</span>
<a href="#l19.458"></a><span id="l19.458" class="difflineplus">+#define ld_cache_flush ld_cache.lcf_flush</span>
<a href="#l19.459"></a><span id="l19.459" class="difflineplus">+#define ld_cache_arg ld_cache.lcf_arg</span>
<a href="#l19.460"></a><span id="l19.460"> </span>
<a href="#l19.461"></a><span id="l19.461" class="difflineminus">-	/* ldapv3 controls */</span>
<a href="#l19.462"></a><span id="l19.462" class="difflineminus">-	LDAPControl		**ld_servercontrols;</span>
<a href="#l19.463"></a><span id="l19.463" class="difflineminus">-	LDAPControl		**ld_clientcontrols;</span>
<a href="#l19.464"></a><span id="l19.464" class="difflineplus">+  /* ldapv3 controls */</span>
<a href="#l19.465"></a><span id="l19.465" class="difflineplus">+  LDAPControl **ld_servercontrols;</span>
<a href="#l19.466"></a><span id="l19.466" class="difflineplus">+  LDAPControl **ld_clientcontrols;</span>
<a href="#l19.467"></a><span id="l19.467"> </span>
<a href="#l19.468"></a><span id="l19.468" class="difflineminus">-	/* Preferred language */</span>
<a href="#l19.469"></a><span id="l19.469" class="difflineminus">-	char            *ld_preferred_language;</span>
<a href="#l19.470"></a><span id="l19.470" class="difflineplus">+  /* Preferred language */</span>
<a href="#l19.471"></a><span id="l19.471" class="difflineplus">+  char            *ld_preferred_language;</span>
<a href="#l19.472"></a><span id="l19.472"> </span>
<a href="#l19.473"></a><span id="l19.473" class="difflineminus">-	/* MemCache */</span>
<a href="#l19.474"></a><span id="l19.474" class="difflineminus">-	LDAPMemCache	*ld_memcache;</span>
<a href="#l19.475"></a><span id="l19.475" class="difflineplus">+  /* MemCache */</span>
<a href="#l19.476"></a><span id="l19.476" class="difflineplus">+  LDAPMemCache *ld_memcache;</span>
<a href="#l19.477"></a><span id="l19.477"> </span>
<a href="#l19.478"></a><span id="l19.478" class="difflineminus">-	/* Pending results */</span>
<a href="#l19.479"></a><span id="l19.479" class="difflineminus">-	LDAPPend	*ld_pend;	/* list of pending results */</span>
<a href="#l19.480"></a><span id="l19.480" class="difflineplus">+  /* Pending results */</span>
<a href="#l19.481"></a><span id="l19.481" class="difflineplus">+  LDAPPend *ld_pend;  /* list of pending results */</span>
<a href="#l19.482"></a><span id="l19.482"> </span>
<a href="#l19.483"></a><span id="l19.483" class="difflineminus">-	/* extra thread function pointers */</span>
<a href="#l19.484"></a><span id="l19.484" class="difflineminus">-	struct ldap_extra_thread_fns	ld_thread2;</span>
<a href="#l19.485"></a><span id="l19.485" class="difflineplus">+  /* extra thread function pointers */</span>
<a href="#l19.486"></a><span id="l19.486" class="difflineplus">+  struct ldap_extra_thread_fns ld_thread2;</span>
<a href="#l19.487"></a><span id="l19.487"> </span>
<a href="#l19.488"></a><span id="l19.488" class="difflineminus">-	/*</span>
<a href="#l19.489"></a><span id="l19.489" class="difflineminus">-	 * With the 4.0 and later versions of the LDAP SDK, the extra thread</span>
<a href="#l19.490"></a><span id="l19.490" class="difflineminus">-	 * functions except for the ld_threadid_fn have been disabled.</span>
<a href="#l19.491"></a><span id="l19.491" class="difflineminus">-	 * Look at the release notes for the full explanation.</span>
<a href="#l19.492"></a><span id="l19.492" class="difflineminus">-	 */</span>
<a href="#l19.493"></a><span id="l19.493" class="difflineminus">-#define ld_mutex_trylock_fn		ld_thread2.ltf_mutex_trylock</span>
<a href="#l19.494"></a><span id="l19.494" class="difflineminus">-#define ld_sema_alloc_fn		ld_thread2.ltf_sema_alloc</span>
<a href="#l19.495"></a><span id="l19.495" class="difflineminus">-#define ld_sema_free_fn			ld_thread2.ltf_sema_free</span>
<a href="#l19.496"></a><span id="l19.496" class="difflineminus">-#define ld_sema_wait_fn			ld_thread2.ltf_sema_wait</span>
<a href="#l19.497"></a><span id="l19.497" class="difflineminus">-#define ld_sema_post_fn			ld_thread2.ltf_sema_post</span>
<a href="#l19.498"></a><span id="l19.498" class="difflineminus">-#define ld_threadid_fn			ld_thread2.ltf_threadid_fn</span>
<a href="#l19.499"></a><span id="l19.499" class="difflineplus">+  /*</span>
<a href="#l19.500"></a><span id="l19.500" class="difflineplus">+   * With the 4.0 and later versions of the LDAP SDK, the extra thread</span>
<a href="#l19.501"></a><span id="l19.501" class="difflineplus">+   * functions except for the ld_threadid_fn have been disabled.</span>
<a href="#l19.502"></a><span id="l19.502" class="difflineplus">+   * Look at the release notes for the full explanation.</span>
<a href="#l19.503"></a><span id="l19.503" class="difflineplus">+   */</span>
<a href="#l19.504"></a><span id="l19.504" class="difflineplus">+#define ld_mutex_trylock_fn ld_thread2.ltf_mutex_trylock</span>
<a href="#l19.505"></a><span id="l19.505" class="difflineplus">+#define ld_sema_alloc_fn ld_thread2.ltf_sema_alloc</span>
<a href="#l19.506"></a><span id="l19.506" class="difflineplus">+#define ld_sema_free_fn ld_thread2.ltf_sema_free</span>
<a href="#l19.507"></a><span id="l19.507" class="difflineplus">+#define ld_sema_wait_fn ld_thread2.ltf_sema_wait</span>
<a href="#l19.508"></a><span id="l19.508" class="difflineplus">+#define ld_sema_post_fn ld_thread2.ltf_sema_post</span>
<a href="#l19.509"></a><span id="l19.509" class="difflineplus">+#define ld_threadid_fn ld_thread2.ltf_threadid_fn</span>
<a href="#l19.510"></a><span id="l19.510"> </span>
<a href="#l19.511"></a><span id="l19.511" class="difflineminus">-	/* extra data for mutex handling in referrals */</span>
<a href="#l19.512"></a><span id="l19.512" class="difflineminus">-	void 			*ld_mutex_threadid[LDAP_MAX_LOCK];</span>
<a href="#l19.513"></a><span id="l19.513" class="difflineminus">-	unsigned long		ld_mutex_refcnt[LDAP_MAX_LOCK];</span>
<a href="#l19.514"></a><span id="l19.514" class="difflineplus">+  /* extra data for mutex handling in referrals */</span>
<a href="#l19.515"></a><span id="l19.515" class="difflineplus">+  void  *ld_mutex_threadid[LDAP_MAX_LOCK];</span>
<a href="#l19.516"></a><span id="l19.516" class="difflineplus">+  unsigned long ld_mutex_refcnt[LDAP_MAX_LOCK];</span>
<a href="#l19.517"></a><span id="l19.517"> </span>
<a href="#l19.518"></a><span id="l19.518" class="difflineminus">-	/* connect timeout value (milliseconds) */</span>
<a href="#l19.519"></a><span id="l19.519" class="difflineminus">-	int				ld_connect_timeout;</span>
<a href="#l19.520"></a><span id="l19.520" class="difflineplus">+  /* connect timeout value (milliseconds) */</span>
<a href="#l19.521"></a><span id="l19.521" class="difflineplus">+  int ld_connect_timeout;</span>
<a href="#l19.522"></a><span id="l19.522"> </span>
<a href="#l19.523"></a><span id="l19.523"> #ifdef LDAP_SASLIO_HOOKS</span>
<a href="#l19.524"></a><span id="l19.524" class="difflineminus">-	/* SASL default option settings */</span>
<a href="#l19.525"></a><span id="l19.525" class="difflineminus">-	char                    *ld_def_sasl_mech;</span>
<a href="#l19.526"></a><span id="l19.526" class="difflineminus">-	char                    *ld_def_sasl_realm;</span>
<a href="#l19.527"></a><span id="l19.527" class="difflineminus">-	char                    *ld_def_sasl_authcid;</span>
<a href="#l19.528"></a><span id="l19.528" class="difflineminus">-	char                    *ld_def_sasl_authzid;</span>
<a href="#l19.529"></a><span id="l19.529" class="difflineminus">-	/* SASL Security properties */</span>
<a href="#l19.530"></a><span id="l19.530" class="difflineminus">-	struct sasl_security_properties ld_sasl_secprops;</span>
<a href="#l19.531"></a><span id="l19.531" class="difflineplus">+  /* SASL default option settings */</span>
<a href="#l19.532"></a><span id="l19.532" class="difflineplus">+  char                    *ld_def_sasl_mech;</span>
<a href="#l19.533"></a><span id="l19.533" class="difflineplus">+  char                    *ld_def_sasl_realm;</span>
<a href="#l19.534"></a><span id="l19.534" class="difflineplus">+  char                    *ld_def_sasl_authcid;</span>
<a href="#l19.535"></a><span id="l19.535" class="difflineplus">+  char                    *ld_def_sasl_authzid;</span>
<a href="#l19.536"></a><span id="l19.536" class="difflineplus">+  /* SASL Security properties */</span>
<a href="#l19.537"></a><span id="l19.537" class="difflineplus">+  struct sasl_security_properties ld_sasl_secprops;</span>
<a href="#l19.538"></a><span id="l19.538"> #endif</span>
<a href="#l19.539"></a><span id="l19.539"> };</span>
<a href="#l19.540"></a><span id="l19.540"> </span>
<a href="#l19.541"></a><span id="l19.541"> /* allocate/free mutex */</span>
<a href="#l19.542"></a><span id="l19.542"> #define LDAP_MUTEX_ALLOC( ld ) \</span>
<a href="#l19.543"></a><span id="l19.543" class="difflineminus">-	(((ld)-&gt;ld_mutex_alloc_fn != NULL) ? (ld)-&gt;ld_mutex_alloc_fn() : NULL)</span>
<a href="#l19.544"></a><span id="l19.544" class="difflineplus">+  (((ld)-&gt;ld_mutex_alloc_fn != NULL) ? (ld)-&gt;ld_mutex_alloc_fn() : NULL)</span>
<a href="#l19.545"></a><span id="l19.545"> </span>
<a href="#l19.546"></a><span id="l19.546"> /* allocate/free mutex */</span>
<a href="#l19.547"></a><span id="l19.547"> #define LDAP_MUTEX_FREE( ld, m ) \</span>
<a href="#l19.548"></a><span id="l19.548" class="difflineminus">-	if ( (ld)-&gt;ld_mutex_free_fn != NULL &amp;&amp; m != NULL ) { \</span>
<a href="#l19.549"></a><span id="l19.549" class="difflineminus">-		(ld)-&gt;ld_mutex_free_fn( m ); \</span>
<a href="#l19.550"></a><span id="l19.550" class="difflineminus">-	}</span>
<a href="#l19.551"></a><span id="l19.551" class="difflineplus">+  if ( (ld)-&gt;ld_mutex_free_fn != NULL &amp;&amp; m != NULL ) { \</span>
<a href="#l19.552"></a><span id="l19.552" class="difflineplus">+    (ld)-&gt;ld_mutex_free_fn( m ); \</span>
<a href="#l19.553"></a><span id="l19.553" class="difflineplus">+  }</span>
<a href="#l19.554"></a><span id="l19.554"> </span>
<a href="#l19.555"></a><span id="l19.555"> /* enter/exit critical sections */</span>
<a href="#l19.556"></a><span id="l19.556"> /*</span>
<a href="#l19.557"></a><span id="l19.557">  * The locks assume that the locks are thread safe.  XXXmcs: which means???</span>
<a href="#l19.558"></a><span id="l19.558">  *</span>
<a href="#l19.559"></a><span id="l19.559">  * Note that we test for both ld_mutex_lock_fn != NULL AND ld_mutex != NULL.</span>
<a href="#l19.560"></a><span id="l19.560">  * This is necessary because there is a window in ldap_init() between the</span>
<a href="#l19.561"></a><span id="l19.561">  * time we set the ld_mutex_lock_fn pointer and the time we allocate the</span>
<a href="#l19.562"></a><span id="l19.562" class="difflineat">@@ -476,93 +476,93 @@ struct ldap {</span>
<a href="#l19.563"></a><span id="l19.563">             } \</span>
<a href="#l19.564"></a><span id="l19.564">         } else { \</span>
<a href="#l19.565"></a><span id="l19.565">             ld-&gt;ld_mutex_unlock_fn(ld-&gt;ld_mutex[lock]); \</span>
<a href="#l19.566"></a><span id="l19.566">         } \</span>
<a href="#l19.567"></a><span id="l19.567">     }</span>
<a href="#l19.568"></a><span id="l19.568"> </span>
<a href="#l19.569"></a><span id="l19.569"> /* Backward compatibility locks */</span>
<a href="#l19.570"></a><span id="l19.570"> #define LDAP_MUTEX_BC_LOCK( ld, i ) \</span>
<a href="#l19.571"></a><span id="l19.571" class="difflineminus">-	/* the ld_mutex_trylock_fn is always set to NULL */ \</span>
<a href="#l19.572"></a><span id="l19.572" class="difflineminus">-	/* in setoption.c as the extra thread functions were */ \</span>
<a href="#l19.573"></a><span id="l19.573" class="difflineminus">-	/* turned off in the 4.0 SDK.  This check will  */ \</span>
<a href="#l19.574"></a><span id="l19.574" class="difflineminus">-	/* always be true */ \</span>
<a href="#l19.575"></a><span id="l19.575" class="difflineminus">-	if( (ld)-&gt;ld_mutex_trylock_fn == NULL ) { \</span>
<a href="#l19.576"></a><span id="l19.576" class="difflineminus">-		LDAP_MUTEX_LOCK( ld, i ) ; \</span>
<a href="#l19.577"></a><span id="l19.577" class="difflineminus">-	}</span>
<a href="#l19.578"></a><span id="l19.578" class="difflineplus">+  /* the ld_mutex_trylock_fn is always set to NULL */ \</span>
<a href="#l19.579"></a><span id="l19.579" class="difflineplus">+  /* in setoption.c as the extra thread functions were */ \</span>
<a href="#l19.580"></a><span id="l19.580" class="difflineplus">+  /* turned off in the 4.0 SDK.  This check will  */ \</span>
<a href="#l19.581"></a><span id="l19.581" class="difflineplus">+  /* always be true */ \</span>
<a href="#l19.582"></a><span id="l19.582" class="difflineplus">+  if( (ld)-&gt;ld_mutex_trylock_fn == NULL ) { \</span>
<a href="#l19.583"></a><span id="l19.583" class="difflineplus">+    LDAP_MUTEX_LOCK( ld, i ) ; \</span>
<a href="#l19.584"></a><span id="l19.584" class="difflineplus">+  }</span>
<a href="#l19.585"></a><span id="l19.585"> #define LDAP_MUTEX_BC_UNLOCK( ld, i ) \</span>
<a href="#l19.586"></a><span id="l19.586" class="difflineminus">-	/* the ld_mutex_trylock_fn is always set to NULL */ \</span>
<a href="#l19.587"></a><span id="l19.587" class="difflineminus">-	/* in setoption.c as the extra thread functions were */ \</span>
<a href="#l19.588"></a><span id="l19.588" class="difflineminus">-	/* turned off in the 4.0 SDK.  This check will  */ \</span>
<a href="#l19.589"></a><span id="l19.589" class="difflineminus">-	/* always be true */ \</span>
<a href="#l19.590"></a><span id="l19.590" class="difflineminus">-	if( (ld)-&gt;ld_mutex_trylock_fn == NULL ) { \</span>
<a href="#l19.591"></a><span id="l19.591" class="difflineminus">-		LDAP_MUTEX_UNLOCK( ld, i ) ; \</span>
<a href="#l19.592"></a><span id="l19.592" class="difflineminus">-	}</span>
<a href="#l19.593"></a><span id="l19.593" class="difflineplus">+  /* the ld_mutex_trylock_fn is always set to NULL */ \</span>
<a href="#l19.594"></a><span id="l19.594" class="difflineplus">+  /* in setoption.c as the extra thread functions were */ \</span>
<a href="#l19.595"></a><span id="l19.595" class="difflineplus">+  /* turned off in the 4.0 SDK.  This check will  */ \</span>
<a href="#l19.596"></a><span id="l19.596" class="difflineplus">+  /* always be true */ \</span>
<a href="#l19.597"></a><span id="l19.597" class="difflineplus">+  if( (ld)-&gt;ld_mutex_trylock_fn == NULL ) { \</span>
<a href="#l19.598"></a><span id="l19.598" class="difflineplus">+    LDAP_MUTEX_UNLOCK( ld, i ) ; \</span>
<a href="#l19.599"></a><span id="l19.599" class="difflineplus">+  }</span>
<a href="#l19.600"></a><span id="l19.600"> </span>
<a href="#l19.601"></a><span id="l19.601"> /* allocate/free semaphore */</span>
<a href="#l19.602"></a><span id="l19.602"> #define LDAP_SEMA_ALLOC( ld ) \</span>
<a href="#l19.603"></a><span id="l19.603" class="difflineminus">-	(((ld)-&gt;ld_sema_alloc_fn != NULL) ? (ld)-&gt;ld_sema_alloc_fn() : NULL)</span>
<a href="#l19.604"></a><span id="l19.604" class="difflineplus">+  (((ld)-&gt;ld_sema_alloc_fn != NULL) ? (ld)-&gt;ld_sema_alloc_fn() : NULL)</span>
<a href="#l19.605"></a><span id="l19.605"> #define LDAP_SEMA_FREE( ld, m ) \</span>
<a href="#l19.606"></a><span id="l19.606" class="difflineminus">-	if ( (ld)-&gt;ld_sema_free_fn != NULL &amp;&amp; m != NULL ) { \</span>
<a href="#l19.607"></a><span id="l19.607" class="difflineminus">-		(ld)-&gt;ld_sema_free_fn( m ); \</span>
<a href="#l19.608"></a><span id="l19.608" class="difflineminus">-	}</span>
<a href="#l19.609"></a><span id="l19.609" class="difflineplus">+  if ( (ld)-&gt;ld_sema_free_fn != NULL &amp;&amp; m != NULL ) { \</span>
<a href="#l19.610"></a><span id="l19.610" class="difflineplus">+    (ld)-&gt;ld_sema_free_fn( m ); \</span>
<a href="#l19.611"></a><span id="l19.611" class="difflineplus">+  }</span>
<a href="#l19.612"></a><span id="l19.612"> </span>
<a href="#l19.613"></a><span id="l19.613"> /* wait/post binary semaphore */</span>
<a href="#l19.614"></a><span id="l19.614"> #define LDAP_SEMA_WAIT( ld, lp ) \</span>
<a href="#l19.615"></a><span id="l19.615" class="difflineminus">-	if ( (ld)-&gt;ld_sema_wait_fn != NULL ) { \</span>
<a href="#l19.616"></a><span id="l19.616" class="difflineminus">-		(ld)-&gt;ld_sema_wait_fn( lp-&gt;lp_sema ); \</span>
<a href="#l19.617"></a><span id="l19.617" class="difflineminus">-	}</span>
<a href="#l19.618"></a><span id="l19.618" class="difflineplus">+  if ( (ld)-&gt;ld_sema_wait_fn != NULL ) { \</span>
<a href="#l19.619"></a><span id="l19.619" class="difflineplus">+    (ld)-&gt;ld_sema_wait_fn( lp-&gt;lp_sema ); \</span>
<a href="#l19.620"></a><span id="l19.620" class="difflineplus">+  }</span>
<a href="#l19.621"></a><span id="l19.621"> #define LDAP_SEMA_POST( ld, lp ) \</span>
<a href="#l19.622"></a><span id="l19.622" class="difflineminus">-	if ( (ld)-&gt;ld_sema_post_fn != NULL ) { \</span>
<a href="#l19.623"></a><span id="l19.623" class="difflineminus">-		(ld)-&gt;ld_sema_post_fn( lp-&gt;lp_sema ); \</span>
<a href="#l19.624"></a><span id="l19.624" class="difflineminus">-	}</span>
<a href="#l19.625"></a><span id="l19.625" class="difflineplus">+  if ( (ld)-&gt;ld_sema_post_fn != NULL ) { \</span>
<a href="#l19.626"></a><span id="l19.626" class="difflineplus">+    (ld)-&gt;ld_sema_post_fn( lp-&gt;lp_sema ); \</span>
<a href="#l19.627"></a><span id="l19.627" class="difflineplus">+  }</span>
<a href="#l19.628"></a><span id="l19.628"> #define POST( ld, y, z ) \</span>
<a href="#l19.629"></a><span id="l19.629" class="difflineminus">-	/* the ld_mutex_trylock_fn is always set to NULL */ \</span>
<a href="#l19.630"></a><span id="l19.630" class="difflineminus">-	/* in setoption.c as the extra thread functions were */ \</span>
<a href="#l19.631"></a><span id="l19.631" class="difflineminus">-	/* turned off in the 4.0 SDK.  This check will  */ \</span>
<a href="#l19.632"></a><span id="l19.632" class="difflineminus">-	/* always be false */ \</span>
<a href="#l19.633"></a><span id="l19.633" class="difflineminus">-	if( (ld)-&gt;ld_mutex_trylock_fn != NULL ) { \</span>
<a href="#l19.634"></a><span id="l19.634" class="difflineminus">-		nsldapi_post_result( ld, y, z ); \</span>
<a href="#l19.635"></a><span id="l19.635" class="difflineminus">-	}</span>
<a href="#l19.636"></a><span id="l19.636" class="difflineplus">+  /* the ld_mutex_trylock_fn is always set to NULL */ \</span>
<a href="#l19.637"></a><span id="l19.637" class="difflineplus">+  /* in setoption.c as the extra thread functions were */ \</span>
<a href="#l19.638"></a><span id="l19.638" class="difflineplus">+  /* turned off in the 4.0 SDK.  This check will  */ \</span>
<a href="#l19.639"></a><span id="l19.639" class="difflineplus">+  /* always be false */ \</span>
<a href="#l19.640"></a><span id="l19.640" class="difflineplus">+  if( (ld)-&gt;ld_mutex_trylock_fn != NULL ) { \</span>
<a href="#l19.641"></a><span id="l19.641" class="difflineplus">+    nsldapi_post_result( ld, y, z ); \</span>
<a href="#l19.642"></a><span id="l19.642" class="difflineplus">+  }</span>
<a href="#l19.643"></a><span id="l19.643"> </span>
<a href="#l19.644"></a><span id="l19.644"> /* get/set errno */</span>
<a href="#l19.645"></a><span id="l19.645"> #ifndef macintosh</span>
<a href="#l19.646"></a><span id="l19.646"> #define LDAP_SET_ERRNO( ld, e ) \</span>
<a href="#l19.647"></a><span id="l19.647" class="difflineminus">-	if ( (ld)-&gt;ld_set_errno_fn != NULL ) { \</span>
<a href="#l19.648"></a><span id="l19.648" class="difflineminus">-		(ld)-&gt;ld_set_errno_fn( e ); \</span>
<a href="#l19.649"></a><span id="l19.649" class="difflineminus">-	} else { \</span>
<a href="#l19.650"></a><span id="l19.650" class="difflineminus">-		errno = e; \</span>
<a href="#l19.651"></a><span id="l19.651" class="difflineminus">-	}</span>
<a href="#l19.652"></a><span id="l19.652" class="difflineplus">+  if ( (ld)-&gt;ld_set_errno_fn != NULL ) { \</span>
<a href="#l19.653"></a><span id="l19.653" class="difflineplus">+    (ld)-&gt;ld_set_errno_fn( e ); \</span>
<a href="#l19.654"></a><span id="l19.654" class="difflineplus">+  } else { \</span>
<a href="#l19.655"></a><span id="l19.655" class="difflineplus">+    errno = e; \</span>
<a href="#l19.656"></a><span id="l19.656" class="difflineplus">+  }</span>
<a href="#l19.657"></a><span id="l19.657"> #define LDAP_GET_ERRNO( ld ) \</span>
<a href="#l19.658"></a><span id="l19.658" class="difflineminus">-	(((ld)-&gt;ld_get_errno_fn != NULL) ? \</span>
<a href="#l19.659"></a><span id="l19.659" class="difflineminus">-		(ld)-&gt;ld_get_errno_fn() : errno)</span>
<a href="#l19.660"></a><span id="l19.660" class="difflineplus">+  (((ld)-&gt;ld_get_errno_fn != NULL) ? \</span>
<a href="#l19.661"></a><span id="l19.661" class="difflineplus">+    (ld)-&gt;ld_get_errno_fn() : errno)</span>
<a href="#l19.662"></a><span id="l19.662"> #else /* macintosh */</span>
<a href="#l19.663"></a><span id="l19.663"> #define LDAP_SET_ERRNO( ld, e ) \</span>
<a href="#l19.664"></a><span id="l19.664" class="difflineminus">-	if ( (ld)-&gt;ld_set_errno_fn != NULL ) { \</span>
<a href="#l19.665"></a><span id="l19.665" class="difflineminus">-		(ld)-&gt;ld_set_errno_fn( e ); \</span>
<a href="#l19.666"></a><span id="l19.666" class="difflineminus">-	}</span>
<a href="#l19.667"></a><span id="l19.667" class="difflineplus">+  if ( (ld)-&gt;ld_set_errno_fn != NULL ) { \</span>
<a href="#l19.668"></a><span id="l19.668" class="difflineplus">+    (ld)-&gt;ld_set_errno_fn( e ); \</span>
<a href="#l19.669"></a><span id="l19.669" class="difflineplus">+  }</span>
<a href="#l19.670"></a><span id="l19.670"> #define LDAP_GET_ERRNO( ld ) \</span>
<a href="#l19.671"></a><span id="l19.671" class="difflineminus">-	(((ld)-&gt;ld_get_errno_fn != NULL) ? \</span>
<a href="#l19.672"></a><span id="l19.672" class="difflineminus">-		(ld)-&gt;ld_get_errno_fn() : 0)</span>
<a href="#l19.673"></a><span id="l19.673" class="difflineplus">+  (((ld)-&gt;ld_get_errno_fn != NULL) ? \</span>
<a href="#l19.674"></a><span id="l19.674" class="difflineplus">+    (ld)-&gt;ld_get_errno_fn() : 0)</span>
<a href="#l19.675"></a><span id="l19.675"> #endif</span>
<a href="#l19.676"></a><span id="l19.676"> </span>
<a href="#l19.677"></a><span id="l19.677"> </span>
<a href="#l19.678"></a><span id="l19.678"> /* get/set ldap-specific errno */</span>
<a href="#l19.679"></a><span id="l19.679" class="difflineminus">-#define LDAP_SET_LDERRNO( ld, e, m, s )	ldap_set_lderrno( ld, e, m, s )</span>
<a href="#l19.680"></a><span id="l19.680" class="difflineplus">+#define LDAP_SET_LDERRNO( ld, e, m, s ) ldap_set_lderrno( ld, e, m, s )</span>
<a href="#l19.681"></a><span id="l19.681"> #define LDAP_GET_LDERRNO( ld, m, s ) ldap_get_lderrno( ld, m, s )</span>
<a href="#l19.682"></a><span id="l19.682"> </span>
<a href="#l19.683"></a><span id="l19.683"> /*</span>
<a href="#l19.684"></a><span id="l19.684">  * your standard &quot;mimimum of two values&quot; macro</span>
<a href="#l19.685"></a><span id="l19.685">  */</span>
<a href="#l19.686"></a><span id="l19.686" class="difflineminus">-#define NSLDAPI_MIN(a, b)	(((a) &lt; (b)) ? (a) : (b))</span>
<a href="#l19.687"></a><span id="l19.687" class="difflineplus">+#define NSLDAPI_MIN(a, b) (((a) &lt; (b)) ? (a) : (b))</span>
<a href="#l19.688"></a><span id="l19.688"> </span>
<a href="#l19.689"></a><span id="l19.689"> /*</span>
<a href="#l19.690"></a><span id="l19.690">  * handy macro to check whether LDAP struct is set up for CLDAP or not</span>
<a href="#l19.691"></a><span id="l19.691">  */</span>
<a href="#l19.692"></a><span id="l19.692" class="difflineminus">-#define LDAP_IS_CLDAP( ld )	( ld-&gt;ld_sbp-&gt;sb_naddr &gt; 0 )</span>
<a href="#l19.693"></a><span id="l19.693" class="difflineplus">+#define LDAP_IS_CLDAP( ld ) ( ld-&gt;ld_sbp-&gt;sb_naddr &gt; 0 )</span>
<a href="#l19.694"></a><span id="l19.694"> </span>
<a href="#l19.695"></a><span id="l19.695"> /*</span>
<a href="#l19.696"></a><span id="l19.696">  * Some Unix error defs. Under CW 7, we can't define OTUNIXERRORS because</span>
<a href="#l19.697"></a><span id="l19.697">  * it generates many conflicts with errno.h. Define what we need here.</span>
<a href="#l19.698"></a><span id="l19.698">  * These need to be in sync with OpenTransport.h</span>
<a href="#l19.699"></a><span id="l19.699">  */</span>
<a href="#l19.700"></a><span id="l19.700"> </span>
<a href="#l19.701"></a><span id="l19.701"> #if defined(macintosh)</span>
<a href="#l19.702"></a><span id="l19.702" class="difflineat">@@ -581,100 +581,100 @@ struct ldap {</span>
<a href="#l19.703"></a><span id="l19.703"> #else /* EAGAIN */</span>
<a href="#l19.704"></a><span id="l19.704"> #define NSLDAPI_ERRNO_IO_INPROGRESS( e )  ((e) == EWOULDBLOCK || (e) == EINPROGRESS)</span>
<a href="#l19.705"></a><span id="l19.705"> #endif /* EAGAIN */</span>
<a href="#l19.706"></a><span id="l19.706"> #endif /* macintosh || _WINDOWS*/</span>
<a href="#l19.707"></a><span id="l19.707"> </span>
<a href="#l19.708"></a><span id="l19.708"> /*</span>
<a href="#l19.709"></a><span id="l19.709">  * macro to return the LDAP protocol version we are using</span>
<a href="#l19.710"></a><span id="l19.710">  */</span>
<a href="#l19.711"></a><span id="l19.711" class="difflineminus">-#define NSLDAPI_LDAP_VERSION( ld )	( (ld)-&gt;ld_defconn == NULL ? \</span>
<a href="#l19.712"></a><span id="l19.712" class="difflineminus">-					(ld)-&gt;ld_version : \</span>
<a href="#l19.713"></a><span id="l19.713" class="difflineminus">-					(ld)-&gt;ld_defconn-&gt;lconn_version )</span>
<a href="#l19.714"></a><span id="l19.714" class="difflineplus">+#define NSLDAPI_LDAP_VERSION( ld ) ( (ld)-&gt;ld_defconn == NULL ? \</span>
<a href="#l19.715"></a><span id="l19.715" class="difflineplus">+                    (ld)-&gt;ld_version : \</span>
<a href="#l19.716"></a><span id="l19.716" class="difflineplus">+                    (ld)-&gt;ld_defconn-&gt;lconn_version )</span>
<a href="#l19.717"></a><span id="l19.717"> </span>
<a href="#l19.718"></a><span id="l19.718"> /*</span>
<a href="#l19.719"></a><span id="l19.719">  * Structures used for handling client filter lists.</span>
<a href="#l19.720"></a><span id="l19.720">  */</span>
<a href="#l19.721"></a><span id="l19.721" class="difflineminus">-#define LDAP_FILT_MAXSIZ	1024</span>
<a href="#l19.722"></a><span id="l19.722" class="difflineplus">+#define LDAP_FILT_MAXSIZ 1024</span>
<a href="#l19.723"></a><span id="l19.723"> </span>
<a href="#l19.724"></a><span id="l19.724"> struct ldap_filt_list {</span>
<a href="#l19.725"></a><span id="l19.725" class="difflineminus">-    char			*lfl_tag;</span>
<a href="#l19.726"></a><span id="l19.726" class="difflineminus">-    char			*lfl_pattern;</span>
<a href="#l19.727"></a><span id="l19.727" class="difflineminus">-    char			*lfl_delims;</span>
<a href="#l19.728"></a><span id="l19.728" class="difflineminus">-    struct ldap_filt_info	*lfl_ilist;</span>
<a href="#l19.729"></a><span id="l19.729" class="difflineminus">-    struct ldap_filt_list	*lfl_next;</span>
<a href="#l19.730"></a><span id="l19.730" class="difflineplus">+    char *lfl_tag;</span>
<a href="#l19.731"></a><span id="l19.731" class="difflineplus">+    char *lfl_pattern;</span>
<a href="#l19.732"></a><span id="l19.732" class="difflineplus">+    char *lfl_delims;</span>
<a href="#l19.733"></a><span id="l19.733" class="difflineplus">+    struct ldap_filt_info *lfl_ilist;</span>
<a href="#l19.734"></a><span id="l19.734" class="difflineplus">+    struct ldap_filt_list *lfl_next;</span>
<a href="#l19.735"></a><span id="l19.735"> };</span>
<a href="#l19.736"></a><span id="l19.736"> </span>
<a href="#l19.737"></a><span id="l19.737"> struct ldap_filt_desc {</span>
<a href="#l19.738"></a><span id="l19.738" class="difflineminus">-	LDAPFiltList		*lfd_filtlist;</span>
<a href="#l19.739"></a><span id="l19.739" class="difflineminus">-	LDAPFiltInfo		*lfd_curfip;</span>
<a href="#l19.740"></a><span id="l19.740" class="difflineminus">-	LDAPFiltInfo		lfd_retfi;</span>
<a href="#l19.741"></a><span id="l19.741" class="difflineminus">-	char			lfd_filter[ LDAP_FILT_MAXSIZ ];</span>
<a href="#l19.742"></a><span id="l19.742" class="difflineminus">-	char			*lfd_curval;</span>
<a href="#l19.743"></a><span id="l19.743" class="difflineminus">-	char			*lfd_curvalcopy;</span>
<a href="#l19.744"></a><span id="l19.744" class="difflineminus">-	char			**lfd_curvalwords;</span>
<a href="#l19.745"></a><span id="l19.745" class="difflineminus">-	char			*lfd_filtprefix;</span>
<a href="#l19.746"></a><span id="l19.746" class="difflineminus">-	char			*lfd_filtsuffix;</span>
<a href="#l19.747"></a><span id="l19.747" class="difflineplus">+  LDAPFiltList *lfd_filtlist;</span>
<a href="#l19.748"></a><span id="l19.748" class="difflineplus">+  LDAPFiltInfo *lfd_curfip;</span>
<a href="#l19.749"></a><span id="l19.749" class="difflineplus">+  LDAPFiltInfo lfd_retfi;</span>
<a href="#l19.750"></a><span id="l19.750" class="difflineplus">+  char lfd_filter[ LDAP_FILT_MAXSIZ ];</span>
<a href="#l19.751"></a><span id="l19.751" class="difflineplus">+  char *lfd_curval;</span>
<a href="#l19.752"></a><span id="l19.752" class="difflineplus">+  char *lfd_curvalcopy;</span>
<a href="#l19.753"></a><span id="l19.753" class="difflineplus">+  char **lfd_curvalwords;</span>
<a href="#l19.754"></a><span id="l19.754" class="difflineplus">+  char *lfd_filtprefix;</span>
<a href="#l19.755"></a><span id="l19.755" class="difflineplus">+  char *lfd_filtsuffix;</span>
<a href="#l19.756"></a><span id="l19.756"> };</span>
<a href="#l19.757"></a><span id="l19.757"> </span>
<a href="#l19.758"></a><span id="l19.758"> /*</span>
<a href="#l19.759"></a><span id="l19.759">  * &quot;internal&quot; globals used to track defaults and memory allocation callbacks:</span>
<a href="#l19.760"></a><span id="l19.760">  *    (the actual definitions are in open.c)</span>
<a href="#l19.761"></a><span id="l19.761">  */</span>
<a href="#l19.762"></a><span id="l19.762" class="difflineminus">-extern struct ldap			nsldapi_ld_defaults;</span>
<a href="#l19.763"></a><span id="l19.763" class="difflineminus">-extern struct ldap_memalloc_fns		nsldapi_memalloc_fns;</span>
<a href="#l19.764"></a><span id="l19.764" class="difflineminus">-extern int				nsldapi_initialized;</span>
<a href="#l19.765"></a><span id="l19.765" class="difflineplus">+extern struct ldap nsldapi_ld_defaults;</span>
<a href="#l19.766"></a><span id="l19.766" class="difflineplus">+extern struct ldap_memalloc_fns nsldapi_memalloc_fns;</span>
<a href="#l19.767"></a><span id="l19.767" class="difflineplus">+extern int nsldapi_initialized;</span>
<a href="#l19.768"></a><span id="l19.768"> </span>
<a href="#l19.769"></a><span id="l19.769"> </span>
<a href="#l19.770"></a><span id="l19.770"> /*</span>
<a href="#l19.771"></a><span id="l19.771">  * Memory allocation done in liblber should all go through one of the</span>
<a href="#l19.772"></a><span id="l19.772">  * following macros. This is so we can plug-in alternative memory</span>
<a href="#l19.773"></a><span id="l19.773">  * allocators, etc. as the need arises.</span>
<a href="#l19.774"></a><span id="l19.774">  */</span>
<a href="#l19.775"></a><span id="l19.775" class="difflineminus">-#define NSLDAPI_MALLOC( size )		ldap_x_malloc( size )</span>
<a href="#l19.776"></a><span id="l19.776" class="difflineminus">-#define NSLDAPI_CALLOC( nelem, elsize )	ldap_x_calloc( nelem, elsize )</span>
<a href="#l19.777"></a><span id="l19.777" class="difflineminus">-#define NSLDAPI_REALLOC( ptr, size )	ldap_x_realloc( ptr, size )</span>
<a href="#l19.778"></a><span id="l19.778" class="difflineminus">-#define NSLDAPI_FREE( ptr )		ldap_x_free( ptr )</span>
<a href="#l19.779"></a><span id="l19.779" class="difflineplus">+#define NSLDAPI_MALLOC( size ) ldap_x_malloc( size )</span>
<a href="#l19.780"></a><span id="l19.780" class="difflineplus">+#define NSLDAPI_CALLOC( nelem, elsize ) ldap_x_calloc( nelem, elsize )</span>
<a href="#l19.781"></a><span id="l19.781" class="difflineplus">+#define NSLDAPI_REALLOC( ptr, size ) ldap_x_realloc( ptr, size )</span>
<a href="#l19.782"></a><span id="l19.782" class="difflineplus">+#define NSLDAPI_FREE( ptr ) ldap_x_free( ptr )</span>
<a href="#l19.783"></a><span id="l19.783"> </span>
<a href="#l19.784"></a><span id="l19.784"> </span>
<a href="#l19.785"></a><span id="l19.785"> /*</span>
<a href="#l19.786"></a><span id="l19.786">  * macros used to check validity of data structures and parameters</span>
<a href="#l19.787"></a><span id="l19.787">  */</span>
<a href="#l19.788"></a><span id="l19.788"> #define NSLDAPI_VALID_LDAP_POINTER( ld ) \</span>
<a href="#l19.789"></a><span id="l19.789" class="difflineminus">-	( (ld) != NULL )</span>
<a href="#l19.790"></a><span id="l19.790" class="difflineplus">+  ( (ld) != NULL )</span>
<a href="#l19.791"></a><span id="l19.791"> </span>
<a href="#l19.792"></a><span id="l19.792"> #define NSLDAPI_VALID_LDAPMESSAGE_POINTER( lm ) \</span>
<a href="#l19.793"></a><span id="l19.793" class="difflineminus">-	( (lm) != NULL )</span>
<a href="#l19.794"></a><span id="l19.794" class="difflineplus">+  ( (lm) != NULL )</span>
<a href="#l19.795"></a><span id="l19.795"> </span>
<a href="#l19.796"></a><span id="l19.796"> #define NSLDAPI_VALID_LDAPMESSAGE_ENTRY_POINTER( lm ) \</span>
<a href="#l19.797"></a><span id="l19.797" class="difflineminus">-	( (lm) != NULL &amp;&amp; (lm)-&gt;lm_msgtype == LDAP_RES_SEARCH_ENTRY )</span>
<a href="#l19.798"></a><span id="l19.798" class="difflineplus">+  ( (lm) != NULL &amp;&amp; (lm)-&gt;lm_msgtype == LDAP_RES_SEARCH_ENTRY )</span>
<a href="#l19.799"></a><span id="l19.799"> </span>
<a href="#l19.800"></a><span id="l19.800"> #define NSLDAPI_VALID_LDAPMESSAGE_REFERENCE_POINTER( lm ) \</span>
<a href="#l19.801"></a><span id="l19.801" class="difflineminus">-	( (lm) != NULL &amp;&amp; (lm)-&gt;lm_msgtype == LDAP_RES_SEARCH_REFERENCE )</span>
<a href="#l19.802"></a><span id="l19.802" class="difflineplus">+  ( (lm) != NULL &amp;&amp; (lm)-&gt;lm_msgtype == LDAP_RES_SEARCH_REFERENCE )</span>
<a href="#l19.803"></a><span id="l19.803"> </span>
<a href="#l19.804"></a><span id="l19.804"> #define NSLDAPI_VALID_LDAPMESSAGE_BINDRESULT_POINTER( lm ) \</span>
<a href="#l19.805"></a><span id="l19.805" class="difflineminus">-	( (lm) != NULL &amp;&amp; (lm)-&gt;lm_msgtype == LDAP_RES_BIND )</span>
<a href="#l19.806"></a><span id="l19.806" class="difflineplus">+  ( (lm) != NULL &amp;&amp; (lm)-&gt;lm_msgtype == LDAP_RES_BIND )</span>
<a href="#l19.807"></a><span id="l19.807"> </span>
<a href="#l19.808"></a><span id="l19.808"> #define NSLDAPI_VALID_LDAPMESSAGE_EXRESULT_POINTER( lm ) \</span>
<a href="#l19.809"></a><span id="l19.809" class="difflineminus">-	( (lm) != NULL &amp;&amp; (lm)-&gt;lm_msgtype == LDAP_RES_EXTENDED )</span>
<a href="#l19.810"></a><span id="l19.810" class="difflineplus">+  ( (lm) != NULL &amp;&amp; (lm)-&gt;lm_msgtype == LDAP_RES_EXTENDED )</span>
<a href="#l19.811"></a><span id="l19.811"> </span>
<a href="#l19.812"></a><span id="l19.812"> #define NSLDAPI_VALID_LDAPMOD_ARRAY( mods ) \</span>
<a href="#l19.813"></a><span id="l19.813" class="difflineminus">-	( (mods) != NULL )</span>
<a href="#l19.814"></a><span id="l19.814" class="difflineplus">+  ( (mods) != NULL )</span>
<a href="#l19.815"></a><span id="l19.815"> </span>
<a href="#l19.816"></a><span id="l19.816"> #define NSLDAPI_VALID_NONEMPTY_LDAPMOD_ARRAY( mods ) \</span>
<a href="#l19.817"></a><span id="l19.817" class="difflineminus">-	( (mods) != NULL &amp;&amp; (mods)[0] != NULL )</span>
<a href="#l19.818"></a><span id="l19.818" class="difflineplus">+  ( (mods) != NULL &amp;&amp; (mods)[0] != NULL )</span>
<a href="#l19.819"></a><span id="l19.819"> </span>
<a href="#l19.820"></a><span id="l19.820"> #define NSLDAPI_IS_SEARCH_ENTRY( code ) \</span>
<a href="#l19.821"></a><span id="l19.821" class="difflineminus">-	((code) == LDAP_RES_SEARCH_ENTRY)</span>
<a href="#l19.822"></a><span id="l19.822" class="difflineplus">+  ((code) == LDAP_RES_SEARCH_ENTRY)</span>
<a href="#l19.823"></a><span id="l19.823"> </span>
<a href="#l19.824"></a><span id="l19.824"> #define NSLDAPI_IS_SEARCH_RESULT( code ) \</span>
<a href="#l19.825"></a><span id="l19.825" class="difflineminus">-	((code) == LDAP_RES_SEARCH_RESULT)</span>
<a href="#l19.826"></a><span id="l19.826" class="difflineplus">+  ((code) == LDAP_RES_SEARCH_RESULT)</span>
<a href="#l19.827"></a><span id="l19.827"> </span>
<a href="#l19.828"></a><span id="l19.828"> #define NSLDAPI_SEARCH_RELATED_RESULT( code ) \</span>
<a href="#l19.829"></a><span id="l19.829" class="difflineminus">-	(NSLDAPI_IS_SEARCH_RESULT( code ) || NSLDAPI_IS_SEARCH_ENTRY( code ))</span>
<a href="#l19.830"></a><span id="l19.830" class="difflineplus">+  (NSLDAPI_IS_SEARCH_RESULT( code ) || NSLDAPI_IS_SEARCH_ENTRY( code ))</span>
<a href="#l19.831"></a><span id="l19.831"> </span>
<a href="#l19.832"></a><span id="l19.832"> /*</span>
<a href="#l19.833"></a><span id="l19.833">  * in bind.c</span>
<a href="#l19.834"></a><span id="l19.834">  */</span>
<a href="#l19.835"></a><span id="l19.835"> char *nsldapi_get_binddn( LDAP *ld );</span>
<a href="#l19.836"></a><span id="l19.836"> </span>
<a href="#l19.837"></a><span id="l19.837"> /*</span>
<a href="#l19.838"></a><span id="l19.838">  * in cache.c</span>
<a href="#l19.839"></a><span id="l19.839" class="difflineat">@@ -702,75 +702,75 @@ void nsldapi_mutex_alloc_all( LDAP *ld )</span>
<a href="#l19.840"></a><span id="l19.840"> void nsldapi_mutex_free_all( LDAP *ld );</span>
<a href="#l19.841"></a><span id="l19.841"> int nsldapi_open_ldap_defconn( LDAP *ld );</span>
<a href="#l19.842"></a><span id="l19.842"> char *nsldapi_strdup( const char *s );  /* if s is NULL, returns NULL */</span>
<a href="#l19.843"></a><span id="l19.843"> </span>
<a href="#l19.844"></a><span id="l19.844"> /*</span>
<a href="#l19.845"></a><span id="l19.845">  * in os-ip.c</span>
<a href="#l19.846"></a><span id="l19.846">  */</span>
<a href="#l19.847"></a><span id="l19.847"> int nsldapi_connect_to_host( LDAP *ld, Sockbuf *sb, const char *host,</span>
<a href="#l19.848"></a><span id="l19.848" class="difflineminus">-	int port, int secure, char **krbinstancep );</span>
<a href="#l19.849"></a><span id="l19.849" class="difflineplus">+  int port, int secure, char **krbinstancep );</span>
<a href="#l19.850"></a><span id="l19.850"> void nsldapi_close_connection( LDAP *ld, Sockbuf *sb );</span>
<a href="#l19.851"></a><span id="l19.851"> </span>
<a href="#l19.852"></a><span id="l19.852"> int nsldapi_iostatus_poll( LDAP *ld, struct timeval *timeout );</span>
<a href="#l19.853"></a><span id="l19.853"> void nsldapi_iostatus_free( LDAP *ld );</span>
<a href="#l19.854"></a><span id="l19.854"> int nsldapi_iostatus_interest_write( LDAP *ld, Sockbuf *sb );</span>
<a href="#l19.855"></a><span id="l19.855"> int nsldapi_iostatus_interest_read( LDAP *ld, Sockbuf *sb );</span>
<a href="#l19.856"></a><span id="l19.856"> int nsldapi_iostatus_interest_clear( LDAP *ld, Sockbuf *sb );</span>
<a href="#l19.857"></a><span id="l19.857"> int nsldapi_iostatus_is_read_ready( LDAP *ld, Sockbuf *sb );</span>
<a href="#l19.858"></a><span id="l19.858"> int nsldapi_iostatus_is_write_ready( LDAP *ld, Sockbuf *sb );</span>
<a href="#l19.859"></a><span id="l19.859"> int nsldapi_install_lber_extiofns( LDAP *ld, Sockbuf *sb );</span>
<a href="#l19.860"></a><span id="l19.860"> int nsldapi_install_compat_io_fns( LDAP *ld, struct ldap_io_fns *iofns );</span>
<a href="#l19.861"></a><span id="l19.861"> </span>
<a href="#l19.862"></a><span id="l19.862"> /*</span>
<a href="#l19.863"></a><span id="l19.863">  * if referral.c</span>
<a href="#l19.864"></a><span id="l19.864">  */</span>
<a href="#l19.865"></a><span id="l19.865"> int nsldapi_parse_reference( LDAP *ld, BerElement *rber, char ***referralsp,</span>
<a href="#l19.866"></a><span id="l19.866" class="difflineminus">-	LDAPControl ***serverctrlsp );</span>
<a href="#l19.867"></a><span id="l19.867" class="difflineplus">+  LDAPControl ***serverctrlsp );</span>
<a href="#l19.868"></a><span id="l19.868"> </span>
<a href="#l19.869"></a><span id="l19.869"> </span>
<a href="#l19.870"></a><span id="l19.870"> /*</span>
<a href="#l19.871"></a><span id="l19.871">  * in result.c</span>
<a href="#l19.872"></a><span id="l19.872">  */</span>
<a href="#l19.873"></a><span id="l19.873"> int ldap_msgdelete( LDAP *ld, int msgid );</span>
<a href="#l19.874"></a><span id="l19.874"> int nsldapi_result_nolock( LDAP *ld, int msgid, int all, int unlock_permitted,</span>
<a href="#l19.875"></a><span id="l19.875">     struct timeval *timeout, LDAPMessage **result );</span>
<a href="#l19.876"></a><span id="l19.876"> int nsldapi_wait_result( LDAP *ld, int msgid, int all, struct timeval *timeout,</span>
<a href="#l19.877"></a><span id="l19.877">     LDAPMessage **result );</span>
<a href="#l19.878"></a><span id="l19.878"> int nsldapi_post_result( LDAP *ld, int msgid, LDAPMessage *result );</span>
<a href="#l19.879"></a><span id="l19.879"> </span>
<a href="#l19.880"></a><span id="l19.880"> /*</span>
<a href="#l19.881"></a><span id="l19.881">  * in request.c</span>
<a href="#l19.882"></a><span id="l19.882">  */</span>
<a href="#l19.883"></a><span id="l19.883"> int nsldapi_send_initial_request( LDAP *ld, int msgid, unsigned long msgtype,</span>
<a href="#l19.884"></a><span id="l19.884" class="difflineminus">-	char *dn, BerElement *ber );</span>
<a href="#l19.885"></a><span id="l19.885" class="difflineplus">+  char *dn, BerElement *ber );</span>
<a href="#l19.886"></a><span id="l19.886"> int nsldapi_send_pending_requests_nolock( LDAP *ld, LDAPConn *lc );</span>
<a href="#l19.887"></a><span id="l19.887"> int nsldapi_alloc_ber_with_options( LDAP *ld, BerElement **berp );</span>
<a href="#l19.888"></a><span id="l19.888"> void nsldapi_set_ber_options( LDAP *ld, BerElement *ber );</span>
<a href="#l19.889"></a><span id="l19.889"> int nsldapi_send_ber_message( LDAP *ld, Sockbuf *sb, BerElement *ber,</span>
<a href="#l19.890"></a><span id="l19.890" class="difflineminus">-	int freeit, int epipe_handler );</span>
<a href="#l19.891"></a><span id="l19.891" class="difflineplus">+  int freeit, int epipe_handler );</span>
<a href="#l19.892"></a><span id="l19.892"> int nsldapi_send_server_request( LDAP *ld, BerElement *ber, int msgid,</span>
<a href="#l19.893"></a><span id="l19.893" class="difflineminus">-	LDAPRequest *parentreq, LDAPServer *srvlist, LDAPConn *lc,</span>
<a href="#l19.894"></a><span id="l19.894" class="difflineminus">-	char *bindreqdn, int bind );</span>
<a href="#l19.895"></a><span id="l19.895" class="difflineplus">+  LDAPRequest *parentreq, LDAPServer *srvlist, LDAPConn *lc,</span>
<a href="#l19.896"></a><span id="l19.896" class="difflineplus">+  char *bindreqdn, int bind );</span>
<a href="#l19.897"></a><span id="l19.897"> LDAPConn *nsldapi_new_connection( LDAP *ld, LDAPServer **srvlistp, int use_ldsb,</span>
<a href="#l19.898"></a><span id="l19.898" class="difflineminus">-	int connect, int bind );</span>
<a href="#l19.899"></a><span id="l19.899" class="difflineplus">+  int connect, int bind );</span>
<a href="#l19.900"></a><span id="l19.900"> LDAPRequest *nsldapi_find_request_by_msgid( LDAP *ld, int msgid );</span>
<a href="#l19.901"></a><span id="l19.901"> LDAPRequest *nsldapi_new_request( LDAPConn *lc, BerElement *ber, int msgid,</span>
<a href="#l19.902"></a><span id="l19.902">    int expect_resp );</span>
<a href="#l19.903"></a><span id="l19.903"> void nsldapi_free_request( LDAP *ld, LDAPRequest *lr, int free_conn );</span>
<a href="#l19.904"></a><span id="l19.904"> void nsldapi_queue_request_nolock( LDAP *ld, LDAPRequest *lr );</span>
<a href="#l19.905"></a><span id="l19.905"> void nsldapi_free_connection( LDAP *ld, LDAPConn *lc,</span>
<a href="#l19.906"></a><span id="l19.906" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l19.907"></a><span id="l19.907" class="difflineminus">-	int force, int unbind );</span>
<a href="#l19.908"></a><span id="l19.908" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l19.909"></a><span id="l19.909" class="difflineplus">+  int force, int unbind );</span>
<a href="#l19.910"></a><span id="l19.910"> void nsldapi_dump_connection( LDAP *ld, LDAPConn *lconns, int all );</span>
<a href="#l19.911"></a><span id="l19.911"> void nsldapi_dump_requests_and_responses( LDAP *ld );</span>
<a href="#l19.912"></a><span id="l19.912"> int nsldapi_chase_v2_referrals( LDAP *ld, LDAPRequest *lr, char **errstrp,</span>
<a href="#l19.913"></a><span id="l19.913" class="difflineminus">-	int *totalcountp, int *chasingcountp );</span>
<a href="#l19.914"></a><span id="l19.914" class="difflineplus">+  int *totalcountp, int *chasingcountp );</span>
<a href="#l19.915"></a><span id="l19.915"> int nsldapi_chase_v3_refs( LDAP *ld, LDAPRequest *lr, char **refs,</span>
<a href="#l19.916"></a><span id="l19.916" class="difflineminus">-	int is_reference, int *totalcountp, int *chasingcountp );</span>
<a href="#l19.917"></a><span id="l19.917" class="difflineplus">+  int is_reference, int *totalcountp, int *chasingcountp );</span>
<a href="#l19.918"></a><span id="l19.918"> int nsldapi_append_referral( LDAP *ld, char **referralsp, char *s );</span>
<a href="#l19.919"></a><span id="l19.919"> void nsldapi_connection_lost_nolock( LDAP *ld, Sockbuf *sb );</span>
<a href="#l19.920"></a><span id="l19.920"> </span>
<a href="#l19.921"></a><span id="l19.921"> #ifdef LDAP_SASLIO_HOOKS</span>
<a href="#l19.922"></a><span id="l19.922"> /*</span>
<a href="#l19.923"></a><span id="l19.923">  * in saslbind.c</span>
<a href="#l19.924"></a><span id="l19.924">  */</span>
<a href="#l19.925"></a><span id="l19.925"> int nsldapi_sasl_is_inited();</span>
<a href="#l19.926"></a><span id="l19.926" class="difflineat">@@ -785,27 +785,27 @@ int nsldapi_sasl_install( LDAP *ld, LDAP</span>
<a href="#l19.927"></a><span id="l19.927"> int nsldapi_sasl_open( LDAP *ld, LDAPConn *lconn, sasl_conn_t **ctx, sasl_ssf_t ssf );</span>
<a href="#l19.928"></a><span id="l19.928"> </span>
<a href="#l19.929"></a><span id="l19.929"> #endif /* LDAP_SASLIO_HOOKS */</span>
<a href="#l19.930"></a><span id="l19.930"> </span>
<a href="#l19.931"></a><span id="l19.931"> /*</span>
<a href="#l19.932"></a><span id="l19.932">  * in search.c</span>
<a href="#l19.933"></a><span id="l19.933">  */</span>
<a href="#l19.934"></a><span id="l19.934"> int nsldapi_build_search_req( LDAP *ld, const char *base, int scope,</span>
<a href="#l19.935"></a><span id="l19.935" class="difflineminus">-	const char *filter, char **attrs, int attrsonly,</span>
<a href="#l19.936"></a><span id="l19.936" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l19.937"></a><span id="l19.937" class="difflineminus">-	int timelimit, int sizelimit, int msgid, BerElement **berp );</span>
<a href="#l19.938"></a><span id="l19.938" class="difflineplus">+  const char *filter, char **attrs, int attrsonly,</span>
<a href="#l19.939"></a><span id="l19.939" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l19.940"></a><span id="l19.940" class="difflineplus">+  int timelimit, int sizelimit, int msgid, BerElement **berp );</span>
<a href="#l19.941"></a><span id="l19.941"> </span>
<a href="#l19.942"></a><span id="l19.942"> /*</span>
<a href="#l19.943"></a><span id="l19.943">  * in unbind.c</span>
<a href="#l19.944"></a><span id="l19.944">  */</span>
<a href="#l19.945"></a><span id="l19.945"> int ldap_ld_free( LDAP *ld, LDAPControl **serverctrls,</span>
<a href="#l19.946"></a><span id="l19.946" class="difflineminus">-	LDAPControl **clientctrls, int close );</span>
<a href="#l19.947"></a><span id="l19.947" class="difflineplus">+  LDAPControl **clientctrls, int close );</span>
<a href="#l19.948"></a><span id="l19.948"> int nsldapi_send_unbind( LDAP *ld, Sockbuf *sb, LDAPControl **serverctrls,</span>
<a href="#l19.949"></a><span id="l19.949" class="difflineminus">-	LDAPControl **clientctrls );</span>
<a href="#l19.950"></a><span id="l19.950" class="difflineplus">+  LDAPControl **clientctrls );</span>
<a href="#l19.951"></a><span id="l19.951"> </span>
<a href="#l19.952"></a><span id="l19.952"> #ifdef LDAP_DNS</span>
<a href="#l19.953"></a><span id="l19.953"> /*</span>
<a href="#l19.954"></a><span id="l19.954">  * in getdxbyname.c</span>
<a href="#l19.955"></a><span id="l19.955">  */</span>
<a href="#l19.956"></a><span id="l19.956"> char **nsldapi_getdxbyname( char *domain );</span>
<a href="#l19.957"></a><span id="l19.957"> </span>
<a href="#l19.958"></a><span id="l19.958"> #endif /* LDAP_DNS */</span>
<a href="#l19.959"></a><span id="l19.959" class="difflineat">@@ -816,37 +816,37 @@ char **nsldapi_getdxbyname( char *domain</span>
<a href="#l19.960"></a><span id="l19.960"> void nsldapi_hex_unescape( char *s );</span>
<a href="#l19.961"></a><span id="l19.961"> </span>
<a href="#l19.962"></a><span id="l19.962"> /*</span>
<a href="#l19.963"></a><span id="l19.963">  * in compat.c</span>
<a href="#l19.964"></a><span id="l19.964">  */</span>
<a href="#l19.965"></a><span id="l19.965"> #ifdef hpux</span>
<a href="#l19.966"></a><span id="l19.966"> char *nsldapi_compat_ctime_r( const time_t *clock, char *buf, int buflen );</span>
<a href="#l19.967"></a><span id="l19.967"> struct hostent *nsldapi_compat_gethostbyname_r( const char *name,</span>
<a href="#l19.968"></a><span id="l19.968" class="difflineminus">-	struct hostent *result, char *buffer, int buflen, int *h_errnop );</span>
<a href="#l19.969"></a><span id="l19.969" class="difflineplus">+  struct hostent *result, char *buffer, int buflen, int *h_errnop );</span>
<a href="#l19.970"></a><span id="l19.970"> #endif /* hpux */</span>
<a href="#l19.971"></a><span id="l19.971"> </span>
<a href="#l19.972"></a><span id="l19.972"> /*</span>
<a href="#l19.973"></a><span id="l19.973">  * in control.c</span>
<a href="#l19.974"></a><span id="l19.974">  */</span>
<a href="#l19.975"></a><span id="l19.975"> int nsldapi_put_controls( LDAP *ld, LDAPControl **ctrls, int closeseq,</span>
<a href="#l19.976"></a><span id="l19.976" class="difflineminus">-	BerElement *ber );</span>
<a href="#l19.977"></a><span id="l19.977" class="difflineplus">+  BerElement *ber );</span>
<a href="#l19.978"></a><span id="l19.978"> int nsldapi_get_controls( BerElement *ber, LDAPControl ***controlsp );</span>
<a href="#l19.979"></a><span id="l19.979"> int nsldapi_find_controls( BerElement *ber, LDAPControl ***controlsp );</span>
<a href="#l19.980"></a><span id="l19.980"> int nsldapi_dup_controls( LDAP *ld, LDAPControl ***ldctrls,</span>
<a href="#l19.981"></a><span id="l19.981" class="difflineminus">-	LDAPControl **newctrls );</span>
<a href="#l19.982"></a><span id="l19.982" class="difflineplus">+  LDAPControl **newctrls );</span>
<a href="#l19.983"></a><span id="l19.983"> int nsldapi_build_control( char *oid, BerElement *ber, int freeber,</span>
<a href="#l19.984"></a><span id="l19.984">     char iscritical, LDAPControl **ctrlp );</span>
<a href="#l19.985"></a><span id="l19.985"> </span>
<a href="#l19.986"></a><span id="l19.986"> </span>
<a href="#l19.987"></a><span id="l19.987"> /*</span>
<a href="#l19.988"></a><span id="l19.988">  * in url.c</span>
<a href="#l19.989"></a><span id="l19.989">  */</span>
<a href="#l19.990"></a><span id="l19.990"> int nsldapi_url_parse( const char *inurl, LDAPURLDesc **ludpp,</span>
<a href="#l19.991"></a><span id="l19.991" class="difflineminus">-	int dn_required );</span>
<a href="#l19.992"></a><span id="l19.992" class="difflineplus">+  int dn_required );</span>
<a href="#l19.993"></a><span id="l19.993"> </span>
<a href="#l19.994"></a><span id="l19.994"> </span>
<a href="#l19.995"></a><span id="l19.995"> /*</span>
<a href="#l19.996"></a><span id="l19.996">  * in charset.c</span>
<a href="#l19.997"></a><span id="l19.997">  *</span>
<a href="#l19.998"></a><span id="l19.998">  * If we ever want to expose character set translation functionality to</span>
<a href="#l19.999"></a><span id="l19.999">  * users of libldap, all of these prototypes will need to be moved to ldap.h</span>
<a href="#l19.1000"></a><span id="l19.1000">  */</span>
<a href="#l19.1001"></a><span id="l19.1001" class="difflineat">@@ -866,22 +866,22 @@ int ldap_8859_to_t61( char **bufp, unsig</span>
<a href="#l19.1002"></a><span id="l19.1002">         int free_input );</span>
<a href="#l19.1003"></a><span id="l19.1003"> #endif /* LDAP_CHARSET_8859 */</span>
<a href="#l19.1004"></a><span id="l19.1004"> #endif /* STR_TRANSLATION */</span>
<a href="#l19.1005"></a><span id="l19.1005"> </span>
<a href="#l19.1006"></a><span id="l19.1006"> /*</span>
<a href="#l19.1007"></a><span id="l19.1007">  * in memcache.h</span>
<a href="#l19.1008"></a><span id="l19.1008">  */</span>
<a href="#l19.1009"></a><span id="l19.1009"> int ldap_memcache_createkey( LDAP *ld, const char *base, int scope,</span>
<a href="#l19.1010"></a><span id="l19.1010" class="difflineminus">-	const char *filter, char **attrs, int attrsonly,</span>
<a href="#l19.1011"></a><span id="l19.1011" class="difflineminus">-	LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l19.1012"></a><span id="l19.1012" class="difflineminus">-	unsigned long *keyp );</span>
<a href="#l19.1013"></a><span id="l19.1013" class="difflineplus">+  const char *filter, char **attrs, int attrsonly,</span>
<a href="#l19.1014"></a><span id="l19.1014" class="difflineplus">+  LDAPControl **serverctrls, LDAPControl **clientctrls,</span>
<a href="#l19.1015"></a><span id="l19.1015" class="difflineplus">+  unsigned long *keyp );</span>
<a href="#l19.1016"></a><span id="l19.1016"> int ldap_memcache_result( LDAP *ld, int msgid, unsigned long key );</span>
<a href="#l19.1017"></a><span id="l19.1017"> int ldap_memcache_new( LDAP *ld, int msgid, unsigned long key,</span>
<a href="#l19.1018"></a><span id="l19.1018" class="difflineminus">-	const char *basedn );</span>
<a href="#l19.1019"></a><span id="l19.1019" class="difflineplus">+  const char *basedn );</span>
<a href="#l19.1020"></a><span id="l19.1020"> int ldap_memcache_append( LDAP *ld, int msgid, int bLast, LDAPMessage *result );</span>
<a href="#l19.1021"></a><span id="l19.1021"> int ldap_memcache_abandon( LDAP *ld, int msgid );</span>
<a href="#l19.1022"></a><span id="l19.1022"> </span>
<a href="#l19.1023"></a><span id="l19.1023"> /*</span>
<a href="#l19.1024"></a><span id="l19.1024">  * in sbind.c</span>
<a href="#l19.1025"></a><span id="l19.1025">  */</span>
<a href="#l19.1026"></a><span id="l19.1026"> void nsldapi_handle_reconnect( LDAP *ld );</span>
<a href="#l19.1027"></a><span id="l19.1027"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/ldap/c-sdk/libraries/libprldap/ldappr-int.h</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/ldap/c-sdk/libraries/libprldap/ldappr-int.h</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -48,23 +48,23 @@</span>
<a href="#l20.4"></a><span id="l20.4"> #include &lt;errno.h&gt;</span>
<a href="#l20.5"></a><span id="l20.5"> #include &lt;string.h&gt;</span>
<a href="#l20.6"></a><span id="l20.6"> #include &lt;stdarg.h&gt;</span>
<a href="#l20.7"></a><span id="l20.7"> </span>
<a href="#l20.8"></a><span id="l20.8"> /*</span>
<a href="#l20.9"></a><span id="l20.9">  * Macros:</span>
<a href="#l20.10"></a><span id="l20.10">  */</span>
<a href="#l20.11"></a><span id="l20.11"> </span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-/* #define PRLDAP_DEBUG	1	*/ 	/* uncomment to enable debugging printfs */</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+/* #define PRLDAP_DEBUG 1 */   /* uncomment to enable debugging printfs */</span>
<a href="#l20.14"></a><span id="l20.14"> </span>
<a href="#l20.15"></a><span id="l20.15"> /*</span>
<a href="#l20.16"></a><span id="l20.16">  * All of the sockets we use are IPv6 capable.</span>
<a href="#l20.17"></a><span id="l20.17">  * Change the following #define to PR_AF_INET to support IPv4 only.</span>
<a href="#l20.18"></a><span id="l20.18">  */</span>
<a href="#l20.19"></a><span id="l20.19" class="difflineminus">-#define PRLDAP_DEFAULT_ADDRESS_FAMILY	PR_AF_INET6</span>
<a href="#l20.20"></a><span id="l20.20" class="difflineplus">+#define PRLDAP_DEFAULT_ADDRESS_FAMILY PR_AF_INET6</span>
<a href="#l20.21"></a><span id="l20.21"> </span>
<a href="#l20.22"></a><span id="l20.22"> /*</span>
<a href="#l20.23"></a><span id="l20.23">  * Max length for sending message with one PR_Send.</span>
<a href="#l20.24"></a><span id="l20.24">  * If a single message is larger than this size, the message is divided</span>
<a href="#l20.25"></a><span id="l20.25">  * into multiple pieces up to this length and sent out.  This is necessary</span>
<a href="#l20.26"></a><span id="l20.26">  * on Microsoft Windows at least where attempts to send really large</span>
<a href="#l20.27"></a><span id="l20.27">  * messages in one PR_Send() call result in an error.</span>
<a href="#l20.28"></a><span id="l20.28">  */</span>
<a href="#l20.29"></a><span id="l20.29" class="difflineat">@@ -81,43 +81,43 @@</span>
<a href="#l20.30"></a><span id="l20.30">     ((myaddr)-&gt;raw.family == PR_AF_INET6 ? ((myaddr)-&gt;ipv6.port = PR_htons(myport)) : ((myaddr)-&gt;inet.port = PR_htons(myport)))</span>
<a href="#l20.31"></a><span id="l20.31"> </span>
<a href="#l20.32"></a><span id="l20.32"> /*</span>
<a href="#l20.33"></a><span id="l20.33">  * Data structures:</span>
<a href="#l20.34"></a><span id="l20.34">  */</span>
<a href="#l20.35"></a><span id="l20.35"> </span>
<a href="#l20.36"></a><span id="l20.36"> /* data structure that populates the I/O callback session arg. */</span>
<a href="#l20.37"></a><span id="l20.37"> typedef struct lextiof_session_private {</span>
<a href="#l20.38"></a><span id="l20.38" class="difflineminus">-	PRPollDesc	*prsess_pollds;		/* for poll callback */</span>
<a href="#l20.39"></a><span id="l20.39" class="difflineminus">-	int		prsess_pollds_count;	/* # of elements in pollds */</span>
<a href="#l20.40"></a><span id="l20.40" class="difflineminus">-	int		prsess_io_max_timeout;	/* in milliseconds */</span>
<a href="#l20.41"></a><span id="l20.41" class="difflineminus">-	void		*prsess_appdata;	/* application specific data */</span>
<a href="#l20.42"></a><span id="l20.42" class="difflineplus">+  PRPollDesc *prsess_pollds;  /* for poll callback */</span>
<a href="#l20.43"></a><span id="l20.43" class="difflineplus">+  int prsess_pollds_count;  /* # of elements in pollds */</span>
<a href="#l20.44"></a><span id="l20.44" class="difflineplus">+  int prsess_io_max_timeout;  /* in milliseconds */</span>
<a href="#l20.45"></a><span id="l20.45" class="difflineplus">+  void *prsess_appdata;  /* application specific data */</span>
<a href="#l20.46"></a><span id="l20.46"> } PRLDAPIOSessionArg;</span>
<a href="#l20.47"></a><span id="l20.47"> </span>
<a href="#l20.48"></a><span id="l20.48"> /* data structure that populates the I/O callback socket-specific arg. */</span>
<a href="#l20.49"></a><span id="l20.49"> typedef struct lextiof_socket_private {</span>
<a href="#l20.50"></a><span id="l20.50" class="difflineminus">-	PRFileDesc	*prsock_prfd;		/* associated NSPR file desc. */</span>
<a href="#l20.51"></a><span id="l20.51" class="difflineminus">-	int		prsock_io_max_timeout;	/* in milliseconds */</span>
<a href="#l20.52"></a><span id="l20.52" class="difflineminus">-	void		*prsock_appdata;	/* application specific data */</span>
<a href="#l20.53"></a><span id="l20.53" class="difflineplus">+  PRFileDesc *prsock_prfd;  /* associated NSPR file desc. */</span>
<a href="#l20.54"></a><span id="l20.54" class="difflineplus">+  int prsock_io_max_timeout;  /* in milliseconds */</span>
<a href="#l20.55"></a><span id="l20.55" class="difflineplus">+  void *prsock_appdata;  /* application specific data */</span>
<a href="#l20.56"></a><span id="l20.56"> } PRLDAPIOSocketArg;</span>
<a href="#l20.57"></a><span id="l20.57"> </span>
<a href="#l20.58"></a><span id="l20.58"> </span>
<a href="#l20.59"></a><span id="l20.59"> /*</span>
<a href="#l20.60"></a><span id="l20.60">  * Function prototypes:</span>
<a href="#l20.61"></a><span id="l20.61">  */</span>
<a href="#l20.62"></a><span id="l20.62"> </span>
<a href="#l20.63"></a><span id="l20.63"> /*</span>
<a href="#l20.64"></a><span id="l20.64">  * From ldapprio.c:</span>
<a href="#l20.65"></a><span id="l20.65">  */</span>
<a href="#l20.66"></a><span id="l20.66"> int prldap_install_io_functions( LDAP *ld, int shared );</span>
<a href="#l20.67"></a><span id="l20.67"> int prldap_session_arg_from_ld( LDAP *ld, PRLDAPIOSessionArg **sessargpp );</span>
<a href="#l20.68"></a><span id="l20.68"> int prldap_set_io_max_timeout( PRLDAPIOSessionArg *prsessp,</span>
<a href="#l20.69"></a><span id="l20.69" class="difflineminus">-	int io_max_timeout );</span>
<a href="#l20.70"></a><span id="l20.70" class="difflineplus">+  int io_max_timeout );</span>
<a href="#l20.71"></a><span id="l20.71"> int prldap_get_io_max_timeout( PRLDAPIOSessionArg *prsessp,</span>
<a href="#l20.72"></a><span id="l20.72" class="difflineminus">-	int *io_max_timeoutp );</span>
<a href="#l20.73"></a><span id="l20.73" class="difflineplus">+  int *io_max_timeoutp );</span>
<a href="#l20.74"></a><span id="l20.74"> int prldap_socket_arg_from_ld( LDAP *ld, PRLDAPIOSocketArg **sockargpp );</span>
<a href="#l20.75"></a><span id="l20.75"> PRLDAPIOSocketArg *prldap_socket_arg_alloc( PRLDAPIOSessionArg *sessionarg );</span>
<a href="#l20.76"></a><span id="l20.76"> </span>
<a href="#l20.77"></a><span id="l20.77"> </span>
<a href="#l20.78"></a><span id="l20.78"> /*</span>
<a href="#l20.79"></a><span id="l20.79">  * From ldapprthreads.c:</span>
<a href="#l20.80"></a><span id="l20.80">  */</span>
<a href="#l20.81"></a><span id="l20.81"> int prldap_install_thread_functions( LDAP *ld, int shared );</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/ldap/xpcom/src/nsLDAPBERValue.h</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/ldap/xpcom/src/nsLDAPBERValue.h</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -29,12 +29,12 @@ protected:</span>
<a href="#l21.4"></a><span id="l21.4"> </span>
<a href="#l21.5"></a><span id="l21.5">     /**</span>
<a href="#l21.6"></a><span id="l21.6">      * nsLDAPControl needs to be able to grovel through this without an</span>
<a href="#l21.7"></a><span id="l21.7">      * an extra copy</span>
<a href="#l21.8"></a><span id="l21.8">      */</span>
<a href="#l21.9"></a><span id="l21.9">     friend class nsLDAPControl;</span>
<a href="#l21.10"></a><span id="l21.10"> </span>
<a href="#l21.11"></a><span id="l21.11">     uint8_t *mValue;    // pointer to an array</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-    uint32_t mSize;	    // size of the value, in bytes</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+    uint32_t mSize;     // size of the value, in bytes</span>
<a href="#l21.14"></a><span id="l21.14"> };</span>
<a href="#l21.15"></a><span id="l21.15"> </span>
<a href="#l21.16"></a><span id="l21.16"> #endif // _nsLDAPBERValue_h_</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/ldap/xpcom/src/nsLDAPConnection.cpp</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/ldap/xpcom/src/nsLDAPConnection.cpp</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -550,17 +550,17 @@ nsLDAPConnection::OnLookupComplete(nsICa</span>
<a href="#l22.4"></a><span id="l22.4">             int version;</span>
<a href="#l22.5"></a><span id="l22.5">             switch (mVersion) {</span>
<a href="#l22.6"></a><span id="l22.6">             case 2:</span>
<a href="#l22.7"></a><span id="l22.7">                 break;</span>
<a href="#l22.8"></a><span id="l22.8">             case 3:</span>
<a href="#l22.9"></a><span id="l22.9">                 version = LDAP_VERSION3;</span>
<a href="#l22.10"></a><span id="l22.10">                 ldap_set_option(mConnectionHandle, LDAP_OPT_PROTOCOL_VERSION,</span>
<a href="#l22.11"></a><span id="l22.11">                                 &amp;version);</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-		break;</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+                break;</span>
<a href="#l22.14"></a><span id="l22.14">             default:</span>
<a href="#l22.15"></a><span id="l22.15">                 NS_ERROR(&quot;nsLDAPConnection::OnLookupComplete(): mVersion&quot;</span>
<a href="#l22.16"></a><span id="l22.16">                          &quot; invalid&quot;);</span>
<a href="#l22.17"></a><span id="l22.17">             }</span>
<a href="#l22.18"></a><span id="l22.18"> </span>
<a href="#l22.19"></a><span id="l22.19">             // This code sets up the current connection to use PSM for SSL</span>
<a href="#l22.20"></a><span id="l22.20">             // functionality.  Making this use libssldap instead for</span>
<a href="#l22.21"></a><span id="l22.21">             // non-browser user shouldn't be hard.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/ldap/xpcom/src/nsLDAPControl.h</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/ldap/xpcom/src/nsLDAPControl.h</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -31,12 +31,12 @@ public:</span>
<a href="#l23.4"></a><span id="l23.4">    * @exception null pointer return if allocation failed</span>
<a href="#l23.5"></a><span id="l23.5">    */</span>
<a href="#l23.6"></a><span id="l23.6">   nsresult ToLDAPControl(LDAPControl **aControl);</span>
<a href="#l23.7"></a><span id="l23.7"> </span>
<a href="#l23.8"></a><span id="l23.8"> private:</span>
<a href="#l23.9"></a><span id="l23.9">   ~nsLDAPControl();</span>
<a href="#l23.10"></a><span id="l23.10"> </span>
<a href="#l23.11"></a><span id="l23.11"> protected:</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-  nsCOMPtr&lt;nsILDAPBERValue&gt; mValue;	// the value portion of this control</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+  nsCOMPtr&lt;nsILDAPBERValue&gt; mValue;  // the value portion of this control</span>
<a href="#l23.14"></a><span id="l23.14">   bool mIsCritical;      // should server abort if control not understood?</span>
<a href="#l23.15"></a><span id="l23.15">   nsCString mOid;          // Object ID for this control</span>
<a href="#l23.16"></a><span id="l23.16"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/ldap/xpcom/src/nsLDAPProtocolHandler.js</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/ldap/xpcom/src/nsLDAPProtocolHandler.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -18,18 +18,18 @@ function makeProtocolHandler(aCID, aProt</span>
<a href="#l24.4"></a><span id="l24.4">                    nsIProtocolHandler.URI_DANGEROUS_TO_LOAD |</span>
<a href="#l24.5"></a><span id="l24.5">                    nsIProtocolHandler.ALLOWS_PROXY,</span>
<a href="#l24.6"></a><span id="l24.6"> </span>
<a href="#l24.7"></a><span id="l24.7">     newURI: function (aSpec, aOriginCharset, aBaseURI) {</span>
<a href="#l24.8"></a><span id="l24.8">       var url = Cc[&quot;@mozilla.org/network/ldap-url;1&quot;]</span>
<a href="#l24.9"></a><span id="l24.9">                   .createInstance(Ci.nsIURI);</span>
<a href="#l24.10"></a><span id="l24.10"> </span>
<a href="#l24.11"></a><span id="l24.11">       if (url instanceof Ci.nsILDAPURL)</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-	url.init(Ci.nsIStandardURL.URLTYPE_STANDARD,</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineminus">-		 aDefaultPort, aSpec, aOriginCharset, aBaseURI);</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineplus">+        url.init(Ci.nsIStandardURL.URLTYPE_STANDARD,</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineplus">+          aDefaultPort, aSpec, aOriginCharset, aBaseURI);</span>
<a href="#l24.16"></a><span id="l24.16"> </span>
<a href="#l24.17"></a><span id="l24.17">       return url;</span>
<a href="#l24.18"></a><span id="l24.18">     },</span>
<a href="#l24.19"></a><span id="l24.19"> </span>
<a href="#l24.20"></a><span id="l24.20">     newChannel: function (aURI) {</span>
<a href="#l24.21"></a><span id="l24.21">       return this.newChannel2(aURI, null);</span>
<a href="#l24.22"></a><span id="l24.22">     },</span>
<a href="#l24.23"></a><span id="l24.23"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/ldap/xpcom/src/nsLDAPSecurityGlue.cpp</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/ldap/xpcom/src/nsLDAPSecurityGlue.cpp</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -35,18 +35,18 @@ typedef struct {</span>
<a href="#l25.4"></a><span id="l25.4"> } nsLDAPSSLSocketClosure;</span>
<a href="#l25.5"></a><span id="l25.5"> </span>
<a href="#l25.6"></a><span id="l25.6"> // free the per-socket data structure as necessary</span>
<a href="#l25.7"></a><span id="l25.7"> //</span>
<a href="#l25.8"></a><span id="l25.8"> static void</span>
<a href="#l25.9"></a><span id="l25.9"> nsLDAPSSLFreeSocketClosure(nsLDAPSSLSocketClosure **aClosure)</span>
<a href="#l25.10"></a><span id="l25.10"> {</span>
<a href="#l25.11"></a><span id="l25.11">     if (aClosure &amp;&amp; *aClosure) {</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-	free(*aClosure);</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineminus">-	*aClosure = nullptr;</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineplus">+      free(*aClosure);</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineplus">+      *aClosure = nullptr;</span>
<a href="#l25.16"></a><span id="l25.16">     }</span>
<a href="#l25.17"></a><span id="l25.17"> }</span>
<a href="#l25.18"></a><span id="l25.18"> </span>
<a href="#l25.19"></a><span id="l25.19"> // Replacement close() function, which cleans up local stuff associated</span>
<a href="#l25.20"></a><span id="l25.20"> // with this socket, and then calls the real close function.</span>
<a href="#l25.21"></a><span id="l25.21"> //</span>
<a href="#l25.22"></a><span id="l25.22"> extern &quot;C&quot; int LDAP_CALLBACK</span>
<a href="#l25.23"></a><span id="l25.23"> nsLDAPSSLClose(int s, struct lextiof_socket_private *socketarg)</span>
<a href="#l25.24"></a><span id="l25.24" class="difflineat">@@ -55,117 +55,113 @@ nsLDAPSSLClose(int s, struct lextiof_soc</span>
<a href="#l25.25"></a><span id="l25.25">     nsLDAPSSLSocketClosure *socketClosure;</span>
<a href="#l25.26"></a><span id="l25.26">     nsLDAPSSLSessionClosure *sessionClosure;</span>
<a href="#l25.27"></a><span id="l25.27"> </span>
<a href="#l25.28"></a><span id="l25.28">     // get the socketInfo associated with this socket</span>
<a href="#l25.29"></a><span id="l25.29">     //</span>
<a href="#l25.30"></a><span id="l25.30">     memset(&amp;socketInfo, 0, sizeof(socketInfo));</span>
<a href="#l25.31"></a><span id="l25.31">     socketInfo.soinfo_size = PRLDAP_SOCKETINFO_SIZE;</span>
<a href="#l25.32"></a><span id="l25.32">     if (prldap_get_socket_info(s, socketarg, &amp;socketInfo) != LDAP_SUCCESS) {</span>
<a href="#l25.33"></a><span id="l25.33" class="difflineminus">-	NS_ERROR(&quot;nsLDAPSSLClose(): prldap_get_socket_info() failed\n&quot;);</span>
<a href="#l25.34"></a><span id="l25.34" class="difflineminus">-	return -1;</span>
<a href="#l25.35"></a><span id="l25.35" class="difflineplus">+      NS_ERROR(&quot;nsLDAPSSLClose(): prldap_get_socket_info() failed\n&quot;);</span>
<a href="#l25.36"></a><span id="l25.36" class="difflineplus">+      return -1;</span>
<a href="#l25.37"></a><span id="l25.37">     }</span>
<a href="#l25.38"></a><span id="l25.38"> </span>
<a href="#l25.39"></a><span id="l25.39">     // save off the session closure data in an automatic, since we're going to</span>
<a href="#l25.40"></a><span id="l25.40">     // need to call through it</span>
<a href="#l25.41"></a><span id="l25.41">     //</span>
<a href="#l25.42"></a><span id="l25.42">     socketClosure = reinterpret_cast&lt;nsLDAPSSLSocketClosure *&gt;</span>
<a href="#l25.43"></a><span id="l25.43">                                     (socketInfo.soinfo_appdata);</span>
<a href="#l25.44"></a><span id="l25.44">     sessionClosure = socketClosure-&gt;sessionClosure;</span>
<a href="#l25.45"></a><span id="l25.45"> </span>
<a href="#l25.46"></a><span id="l25.46">     // free the socket closure data</span>
<a href="#l25.47"></a><span id="l25.47">     //</span>
<a href="#l25.48"></a><span id="l25.48">     nsLDAPSSLFreeSocketClosure(</span>
<a href="#l25.49"></a><span id="l25.49" class="difflineminus">-	reinterpret_cast&lt;nsLDAPSSLSocketClosure **&gt;</span>
<a href="#l25.50"></a><span id="l25.50" class="difflineplus">+                 reinterpret_cast&lt;nsLDAPSSLSocketClosure **&gt;</span>
<a href="#l25.51"></a><span id="l25.51">                  (&amp;socketInfo.soinfo_appdata));</span>
<a href="#l25.52"></a><span id="l25.52"> </span>
<a href="#l25.53"></a><span id="l25.53">     // call the real close function</span>
<a href="#l25.54"></a><span id="l25.54">     //</span>
<a href="#l25.55"></a><span id="l25.55">     return (*(sessionClosure-&gt;realClose))(s, socketarg);</span>
<a href="#l25.56"></a><span id="l25.56"> }</span>
<a href="#l25.57"></a><span id="l25.57"> </span>
<a href="#l25.58"></a><span id="l25.58"> // Replacement connection function.  Calls the real connect function,</span>
<a href="#l25.59"></a><span id="l25.59"> //</span>
<a href="#l25.60"></a><span id="l25.60"> extern &quot;C&quot; int LDAP_CALLBACK</span>
<a href="#l25.61"></a><span id="l25.61"> nsLDAPSSLConnect(const char *hostlist, int defport, int timeout,</span>
<a href="#l25.62"></a><span id="l25.62" class="difflineminus">-		 unsigned long options,</span>
<a href="#l25.63"></a><span id="l25.63" class="difflineminus">-		 struct lextiof_session_private *sessionarg,</span>
<a href="#l25.64"></a><span id="l25.64" class="difflineminus">-		 struct lextiof_socket_private **socketargp )</span>
<a href="#l25.65"></a><span id="l25.65" class="difflineplus">+                 unsigned long options,</span>
<a href="#l25.66"></a><span id="l25.66" class="difflineplus">+                 struct lextiof_session_private *sessionarg,</span>
<a href="#l25.67"></a><span id="l25.67" class="difflineplus">+                 struct lextiof_socket_private **socketargp)</span>
<a href="#l25.68"></a><span id="l25.68"> {</span>
<a href="#l25.69"></a><span id="l25.69">     PRLDAPSocketInfo socketInfo;</span>
<a href="#l25.70"></a><span id="l25.70">     PRLDAPSessionInfo sessionInfo;</span>
<a href="#l25.71"></a><span id="l25.71">     nsLDAPSSLSocketClosure *socketClosure = nullptr;</span>
<a href="#l25.72"></a><span id="l25.72">     nsLDAPSSLSessionClosure *sessionClosure;</span>
<a href="#l25.73"></a><span id="l25.73" class="difflineminus">-    int	intfd = -1;</span>
<a href="#l25.74"></a><span id="l25.74" class="difflineplus">+    int intfd = -1;</span>
<a href="#l25.75"></a><span id="l25.75">     nsCOMPtr &lt;nsISupports&gt; securityInfo;</span>
<a href="#l25.76"></a><span id="l25.76">     nsCOMPtr &lt;nsISocketProvider&gt; tlsSocketProvider;</span>
<a href="#l25.77"></a><span id="l25.77">     nsCOMPtr &lt;nsISSLSocketControl&gt; sslSocketControl;</span>
<a href="#l25.78"></a><span id="l25.78">     nsresult rv;</span>
<a href="#l25.79"></a><span id="l25.79"> </span>
<a href="#l25.80"></a><span id="l25.80">     // Ensure secure option is set.  Also, clear secure bit in options</span>
<a href="#l25.81"></a><span id="l25.81">     // the we pass to the standard connect() function (since it doesn't know</span>
<a href="#l25.82"></a><span id="l25.82">     // how to handle the secure option).</span>
<a href="#l25.83"></a><span id="l25.83">     //</span>
<a href="#l25.84"></a><span id="l25.84">     NS_ASSERTION(options &amp; LDAP_X_EXTIOF_OPT_SECURE,</span>
<a href="#l25.85"></a><span id="l25.85" class="difflineminus">-		 &quot;nsLDAPSSLConnect(): called for non-secure connection&quot;);</span>
<a href="#l25.86"></a><span id="l25.86" class="difflineplus">+                 &quot;nsLDAPSSLConnect(): called for non-secure connection&quot;);</span>
<a href="#l25.87"></a><span id="l25.87">     options &amp;= ~LDAP_X_EXTIOF_OPT_SECURE;</span>
<a href="#l25.88"></a><span id="l25.88"> </span>
<a href="#l25.89"></a><span id="l25.89">     // Retrieve session info. so we can store a pointer to our session info.</span>
<a href="#l25.90"></a><span id="l25.90">     // in our socket info. later.</span>
<a href="#l25.91"></a><span id="l25.91">     //</span>
<a href="#l25.92"></a><span id="l25.92">     memset(&amp;sessionInfo, 0, sizeof(sessionInfo));</span>
<a href="#l25.93"></a><span id="l25.93">     sessionInfo.seinfo_size = PRLDAP_SESSIONINFO_SIZE;</span>
<a href="#l25.94"></a><span id="l25.94" class="difflineminus">-    if (prldap_get_session_info(nullptr, sessionarg, &amp;sessionInfo)</span>
<a href="#l25.95"></a><span id="l25.95" class="difflineminus">-	!= LDAP_SUCCESS) {</span>
<a href="#l25.96"></a><span id="l25.96" class="difflineminus">-	NS_ERROR(&quot;nsLDAPSSLConnect(): unable to get session info&quot;);</span>
<a href="#l25.97"></a><span id="l25.97" class="difflineplus">+    if (prldap_get_session_info(nullptr, sessionarg, &amp;sessionInfo) != LDAP_SUCCESS) {</span>
<a href="#l25.98"></a><span id="l25.98" class="difflineplus">+        NS_ERROR(&quot;nsLDAPSSLConnect(): unable to get session info&quot;);</span>
<a href="#l25.99"></a><span id="l25.99">         return -1;</span>
<a href="#l25.100"></a><span id="l25.100">     }</span>
<a href="#l25.101"></a><span id="l25.101">     sessionClosure = reinterpret_cast&lt;nsLDAPSSLSessionClosure *&gt;</span>
<a href="#l25.102"></a><span id="l25.102">                                      (sessionInfo.seinfo_appdata);</span>
<a href="#l25.103"></a><span id="l25.103"> </span>
<a href="#l25.104"></a><span id="l25.104">     // Call the real connect() callback to make the TCP connection.  If it</span>
<a href="#l25.105"></a><span id="l25.105">     // succeeds, *socketargp is set.</span>
<a href="#l25.106"></a><span id="l25.106">     //</span>
<a href="#l25.107"></a><span id="l25.107">     intfd = (*(sessionClosure-&gt;realConnect))(hostlist, defport, timeout,</span>
<a href="#l25.108"></a><span id="l25.108" class="difflineminus">-					     options, sessionarg, socketargp);</span>
<a href="#l25.109"></a><span id="l25.109" class="difflineplus">+                                             options, sessionarg, socketargp);</span>
<a href="#l25.110"></a><span id="l25.110">     if ( intfd &lt; 0 ) {</span>
<a href="#l25.111"></a><span id="l25.111" class="difflineminus">-	MOZ_LOG(gLDAPLogModule, mozilla::LogLevel::Debug,</span>
<a href="#l25.112"></a><span id="l25.112" class="difflineminus">-	       (&quot;nsLDAPSSLConnect(): standard connect() function returned %d&quot;,</span>
<a href="#l25.113"></a><span id="l25.113" class="difflineminus">-		intfd));</span>
<a href="#l25.114"></a><span id="l25.114" class="difflineplus">+        MOZ_LOG(gLDAPLogModule, mozilla::LogLevel::Debug,</span>
<a href="#l25.115"></a><span id="l25.115" class="difflineplus">+                (&quot;nsLDAPSSLConnect(): standard connect() function returned %d&quot;, intfd));</span>
<a href="#l25.116"></a><span id="l25.116">         return intfd;</span>
<a href="#l25.117"></a><span id="l25.117">     }</span>
<a href="#l25.118"></a><span id="l25.118"> </span>
<a href="#l25.119"></a><span id="l25.119">     // Retrieve socket info from the newly created socket so that we</span>
<a href="#l25.120"></a><span id="l25.120">     // have the PRFileDesc onto which we will be layering SSL.</span>
<a href="#l25.121"></a><span id="l25.121">     //</span>
<a href="#l25.122"></a><span id="l25.122">     memset(&amp;socketInfo, 0, sizeof(socketInfo));</span>
<a href="#l25.123"></a><span id="l25.123">     socketInfo.soinfo_size = PRLDAP_SOCKETINFO_SIZE;</span>
<a href="#l25.124"></a><span id="l25.124" class="difflineminus">-    if (prldap_get_socket_info(intfd, *socketargp, &amp;socketInfo)</span>
<a href="#l25.125"></a><span id="l25.125" class="difflineminus">-	!= LDAP_SUCCESS)  {</span>
<a href="#l25.126"></a><span id="l25.126" class="difflineminus">-	NS_ERROR(&quot;nsLDAPSSLConnect(): unable to get socket info&quot;);</span>
<a href="#l25.127"></a><span id="l25.127" class="difflineplus">+    if (prldap_get_socket_info(intfd, *socketargp, &amp;socketInfo) != LDAP_SUCCESS)  {</span>
<a href="#l25.128"></a><span id="l25.128" class="difflineplus">+        NS_ERROR(&quot;nsLDAPSSLConnect(): unable to get socket info&quot;);</span>
<a href="#l25.129"></a><span id="l25.129">         goto close_socket_and_exit_with_error;</span>
<a href="#l25.130"></a><span id="l25.130">     }</span>
<a href="#l25.131"></a><span id="l25.131"> </span>
<a href="#l25.132"></a><span id="l25.132">     // Allocate a structure to hold our socket-specific data.</span>
<a href="#l25.133"></a><span id="l25.133">     //</span>
<a href="#l25.134"></a><span id="l25.134" class="difflineminus">-    socketClosure = static_cast&lt;nsLDAPSSLSocketClosure *&gt;(moz_xmalloc(</span>
<a href="#l25.135"></a><span id="l25.135" class="difflineminus">-				       sizeof(nsLDAPSSLSocketClosure)));</span>
<a href="#l25.136"></a><span id="l25.136" class="difflineplus">+    socketClosure = static_cast&lt;nsLDAPSSLSocketClosure *&gt;</span>
<a href="#l25.137"></a><span id="l25.137" class="difflineplus">+                      (moz_xmalloc(sizeof(nsLDAPSSLSocketClosure)));</span>
<a href="#l25.138"></a><span id="l25.138">     if (!socketClosure) {</span>
<a href="#l25.139"></a><span id="l25.139" class="difflineminus">-	NS_WARNING(&quot;nsLDAPSSLConnect(): unable to allocate socket closure&quot;);</span>
<a href="#l25.140"></a><span id="l25.140" class="difflineminus">-	goto close_socket_and_exit_with_error;</span>
<a href="#l25.141"></a><span id="l25.141" class="difflineplus">+        NS_WARNING(&quot;nsLDAPSSLConnect(): unable to allocate socket closure&quot;);</span>
<a href="#l25.142"></a><span id="l25.142" class="difflineplus">+        goto close_socket_and_exit_with_error;</span>
<a href="#l25.143"></a><span id="l25.143">     }</span>
<a href="#l25.144"></a><span id="l25.144">     memset(socketClosure, 0, sizeof(nsLDAPSSLSocketClosure));</span>
<a href="#l25.145"></a><span id="l25.145">     socketClosure-&gt;sessionClosure = sessionClosure;</span>
<a href="#l25.146"></a><span id="l25.146"> </span>
<a href="#l25.147"></a><span id="l25.147">     // Add the NSPR layer for SSL provided by PSM to this socket.</span>
<a href="#l25.148"></a><span id="l25.148">     //</span>
<a href="#l25.149"></a><span id="l25.149" class="difflineminus">-    tlsSocketProvider = do_GetService(NS_STARTTLSSOCKETPROVIDER_CONTRACTID,</span>
<a href="#l25.150"></a><span id="l25.150" class="difflineminus">-				      &amp;rv);</span>
<a href="#l25.151"></a><span id="l25.151" class="difflineplus">+    tlsSocketProvider = do_GetService(NS_STARTTLSSOCKETPROVIDER_CONTRACTID, &amp;rv);</span>
<a href="#l25.152"></a><span id="l25.152">     if (NS_FAILED(rv)) {</span>
<a href="#l25.153"></a><span id="l25.153" class="difflineminus">-	NS_ERROR(&quot;nsLDAPSSLConnect(): unable to get socket provider service&quot;);</span>
<a href="#l25.154"></a><span id="l25.154" class="difflineplus">+        NS_ERROR(&quot;nsLDAPSSLConnect(): unable to get socket provider service&quot;);</span>
<a href="#l25.155"></a><span id="l25.155">         goto close_socket_and_exit_with_error;</span>
<a href="#l25.156"></a><span id="l25.156">     }</span>
<a href="#l25.157"></a><span id="l25.157">     // XXXdmose: Note that hostlist can be a list of hosts (in the</span>
<a href="#l25.158"></a><span id="l25.158">     // current XPCOM SDK code, it will always be a list of IP</span>
<a href="#l25.159"></a><span id="l25.159">     // addresses).  Because of this, we need to use</span>
<a href="#l25.160"></a><span id="l25.160">     // sessionClosure-&gt;hostname which was passed in separately to tell</span>
<a href="#l25.161"></a><span id="l25.161">     // AddToSocket what to match the name in the certificate against.</span>
<a href="#l25.162"></a><span id="l25.162">     // What exactly happen will happen when this is used with some IP</span>
<a href="#l25.163"></a><span id="l25.163" class="difflineat">@@ -177,50 +173,49 @@ nsLDAPSSLConnect(const char *hostlist, i</span>
<a href="#l25.164"></a><span id="l25.164">                                         sessionClosure-&gt;hostname,</span>
<a href="#l25.165"></a><span id="l25.165">                                         defport,</span>
<a href="#l25.166"></a><span id="l25.166">                                         nullptr,</span>
<a href="#l25.167"></a><span id="l25.167">                                         mozilla::OriginAttributes(),</span>
<a href="#l25.168"></a><span id="l25.168">                                         0, 0,</span>
<a href="#l25.169"></a><span id="l25.169">                                         socketInfo.soinfo_prfd,</span>
<a href="#l25.170"></a><span id="l25.170">                                         getter_AddRefs(securityInfo));</span>
<a href="#l25.171"></a><span id="l25.171">     if (NS_FAILED(rv)) {</span>
<a href="#l25.172"></a><span id="l25.172" class="difflineminus">-	NS_ERROR(&quot;nsLDAPSSLConnect(): unable to add SSL layer to socket&quot;);</span>
<a href="#l25.173"></a><span id="l25.173" class="difflineplus">+        NS_ERROR(&quot;nsLDAPSSLConnect(): unable to add SSL layer to socket&quot;);</span>
<a href="#l25.174"></a><span id="l25.174">         goto close_socket_and_exit_with_error;</span>
<a href="#l25.175"></a><span id="l25.175">     }</span>
<a href="#l25.176"></a><span id="l25.176"> </span>
<a href="#l25.177"></a><span id="l25.177">     // If possible we want to avoid using SSLv2, as this can confuse</span>
<a href="#l25.178"></a><span id="l25.178">     // some directory servers (notably the netscape 4.1 ds).  The only</span>
<a href="#l25.179"></a><span id="l25.179">     // way that PSM provides for us to do this is to use a socket that can</span>
<a href="#l25.180"></a><span id="l25.180">     // be used for the STARTTLS protocol, because the STARTTLS protocol disallows</span>
<a href="#l25.181"></a><span id="l25.181">     // the use of SSLv2.</span>
<a href="#l25.182"></a><span id="l25.182">     // (Thanks to Brian Ryner for helping figure this out).</span>
<a href="#l25.183"></a><span id="l25.183">     //</span>
<a href="#l25.184"></a><span id="l25.184">     sslSocketControl = do_QueryInterface(securityInfo, &amp;rv);</span>
<a href="#l25.185"></a><span id="l25.185">     if (NS_FAILED(rv)) {</span>
<a href="#l25.186"></a><span id="l25.186">         NS_WARNING(&quot;nsLDAPSSLConnect(): unable to QI to nsISSLSocketControl&quot;);</span>
<a href="#l25.187"></a><span id="l25.187">     } else {</span>
<a href="#l25.188"></a><span id="l25.188" class="difflineminus">-	rv = sslSocketControl-&gt;StartTLS();</span>
<a href="#l25.189"></a><span id="l25.189" class="difflineminus">-	if (NS_FAILED(rv)) {</span>
<a href="#l25.190"></a><span id="l25.190" class="difflineminus">-	    NS_WARNING(&quot;nsLDAPSSLConnect(): StartTLS failed&quot;);</span>
<a href="#l25.191"></a><span id="l25.191" class="difflineminus">-	}</span>
<a href="#l25.192"></a><span id="l25.192" class="difflineplus">+        rv = sslSocketControl-&gt;StartTLS();</span>
<a href="#l25.193"></a><span id="l25.193" class="difflineplus">+        if (NS_FAILED(rv)) {</span>
<a href="#l25.194"></a><span id="l25.194" class="difflineplus">+            NS_WARNING(&quot;nsLDAPSSLConnect(): StartTLS failed&quot;);</span>
<a href="#l25.195"></a><span id="l25.195" class="difflineplus">+        }</span>
<a href="#l25.196"></a><span id="l25.196">     }</span>
<a href="#l25.197"></a><span id="l25.197"> </span>
<a href="#l25.198"></a><span id="l25.198">     // Attach our closure to the socketInfo.</span>
<a href="#l25.199"></a><span id="l25.199">     //</span>
<a href="#l25.200"></a><span id="l25.200">     socketInfo.soinfo_appdata = reinterpret_cast&lt;prldap_socket_private *&gt;</span>
<a href="#l25.201"></a><span id="l25.201">                                                 (socketClosure);</span>
<a href="#l25.202"></a><span id="l25.202" class="difflineminus">-    if (prldap_set_socket_info(intfd, *socketargp, &amp;socketInfo)</span>
<a href="#l25.203"></a><span id="l25.203" class="difflineminus">-	!= LDAP_SUCCESS ) {</span>
<a href="#l25.204"></a><span id="l25.204" class="difflineminus">-	NS_ERROR(&quot;nsLDAPSSLConnect(): unable to set socket info&quot;);</span>
<a href="#l25.205"></a><span id="l25.205" class="difflineplus">+    if (prldap_set_socket_info(intfd, *socketargp, &amp;socketInfo) != LDAP_SUCCESS ) {</span>
<a href="#l25.206"></a><span id="l25.206" class="difflineplus">+        NS_ERROR(&quot;nsLDAPSSLConnect(): unable to set socket info&quot;);</span>
<a href="#l25.207"></a><span id="l25.207">     }</span>
<a href="#l25.208"></a><span id="l25.208" class="difflineminus">-    return intfd;	// success</span>
<a href="#l25.209"></a><span id="l25.209" class="difflineplus">+    return intfd;  // success</span>
<a href="#l25.210"></a><span id="l25.210"> </span>
<a href="#l25.211"></a><span id="l25.211"> close_socket_and_exit_with_error:</span>
<a href="#l25.212"></a><span id="l25.212">     if (socketInfo.soinfo_prfd) {</span>
<a href="#l25.213"></a><span id="l25.213" class="difflineminus">-	PR_Close(socketInfo.soinfo_prfd);</span>
<a href="#l25.214"></a><span id="l25.214" class="difflineplus">+        PR_Close(socketInfo.soinfo_prfd);</span>
<a href="#l25.215"></a><span id="l25.215">     }</span>
<a href="#l25.216"></a><span id="l25.216">     if (socketClosure) {</span>
<a href="#l25.217"></a><span id="l25.217">         nsLDAPSSLFreeSocketClosure(&amp;socketClosure);</span>
<a href="#l25.218"></a><span id="l25.218">     }</span>
<a href="#l25.219"></a><span id="l25.219">     if ( intfd &gt;= 0 &amp;&amp; *socketargp ) {</span>
<a href="#l25.220"></a><span id="l25.220">         (*(sessionClosure-&gt;realClose))(intfd, *socketargp);</span>
<a href="#l25.221"></a><span id="l25.221">     }</span>
<a href="#l25.222"></a><span id="l25.222">     return -1;</span>
<a href="#l25.223"></a><span id="l25.223" class="difflineat">@@ -229,114 +224,114 @@ close_socket_and_exit_with_error:</span>
<a href="#l25.224"></a><span id="l25.224"> </span>
<a href="#l25.225"></a><span id="l25.225"> // Free data associated with this session (LDAP *) as necessary.</span>
<a href="#l25.226"></a><span id="l25.226"> //</span>
<a href="#l25.227"></a><span id="l25.227"> static void</span>
<a href="#l25.228"></a><span id="l25.228"> nsLDAPSSLFreeSessionClosure(nsLDAPSSLSessionClosure **aSessionClosure)</span>
<a href="#l25.229"></a><span id="l25.229"> {</span>
<a href="#l25.230"></a><span id="l25.230">     if (aSessionClosure &amp;&amp; *aSessionClosure) {</span>
<a href="#l25.231"></a><span id="l25.231"> </span>
<a href="#l25.232"></a><span id="l25.232" class="difflineminus">-	// free the hostname</span>
<a href="#l25.233"></a><span id="l25.233" class="difflineminus">-	//</span>
<a href="#l25.234"></a><span id="l25.234" class="difflineminus">-	if ( (*aSessionClosure)-&gt;hostname ) {</span>
<a href="#l25.235"></a><span id="l25.235" class="difflineminus">-	    PL_strfree((*aSessionClosure)-&gt;hostname);</span>
<a href="#l25.236"></a><span id="l25.236" class="difflineminus">-	    (*aSessionClosure)-&gt;hostname = nullptr;</span>
<a href="#l25.237"></a><span id="l25.237" class="difflineminus">-	}</span>
<a href="#l25.238"></a><span id="l25.238" class="difflineplus">+        // free the hostname</span>
<a href="#l25.239"></a><span id="l25.239" class="difflineplus">+        //</span>
<a href="#l25.240"></a><span id="l25.240" class="difflineplus">+        if ( (*aSessionClosure)-&gt;hostname ) {</span>
<a href="#l25.241"></a><span id="l25.241" class="difflineplus">+            PL_strfree((*aSessionClosure)-&gt;hostname);</span>
<a href="#l25.242"></a><span id="l25.242" class="difflineplus">+            (*aSessionClosure)-&gt;hostname = nullptr;</span>
<a href="#l25.243"></a><span id="l25.243" class="difflineplus">+        }</span>
<a href="#l25.244"></a><span id="l25.244"> </span>
<a href="#l25.245"></a><span id="l25.245" class="difflineminus">-	// free the structure itself</span>
<a href="#l25.246"></a><span id="l25.246" class="difflineminus">-	//</span>
<a href="#l25.247"></a><span id="l25.247" class="difflineminus">-	free(*aSessionClosure);</span>
<a href="#l25.248"></a><span id="l25.248" class="difflineminus">-	*aSessionClosure = nullptr;</span>
<a href="#l25.249"></a><span id="l25.249" class="difflineplus">+        // free the structure itself</span>
<a href="#l25.250"></a><span id="l25.250" class="difflineplus">+        //</span>
<a href="#l25.251"></a><span id="l25.251" class="difflineplus">+        free(*aSessionClosure);</span>
<a href="#l25.252"></a><span id="l25.252" class="difflineplus">+        *aSessionClosure = nullptr;</span>
<a href="#l25.253"></a><span id="l25.253">     }</span>
<a href="#l25.254"></a><span id="l25.254"> }</span>
<a href="#l25.255"></a><span id="l25.255"> </span>
<a href="#l25.256"></a><span id="l25.256"> // Replacement session handle disposal code.  First cleans up our local</span>
<a href="#l25.257"></a><span id="l25.257"> // stuff, then calls the original session handle disposal function.</span>
<a href="#l25.258"></a><span id="l25.258"> //</span>
<a href="#l25.259"></a><span id="l25.259"> extern &quot;C&quot; void LDAP_CALLBACK</span>
<a href="#l25.260"></a><span id="l25.260"> nsLDAPSSLDisposeHandle(LDAP *ld, struct lextiof_session_private *sessionarg)</span>
<a href="#l25.261"></a><span id="l25.261"> {</span>
<a href="#l25.262"></a><span id="l25.262">     PRLDAPSessionInfo sessionInfo;</span>
<a href="#l25.263"></a><span id="l25.263">     nsLDAPSSLSessionClosure *sessionClosure;</span>
<a href="#l25.264"></a><span id="l25.264">     LDAP_X_EXTIOF_DISPOSEHANDLE_CALLBACK *disposehdl_fn;</span>
<a href="#l25.265"></a><span id="l25.265"> </span>
<a href="#l25.266"></a><span id="l25.266">     memset(&amp;sessionInfo, 0, sizeof(sessionInfo));</span>
<a href="#l25.267"></a><span id="l25.267">     sessionInfo.seinfo_size = PRLDAP_SESSIONINFO_SIZE;</span>
<a href="#l25.268"></a><span id="l25.268">     if (prldap_get_session_info(ld, nullptr, &amp;sessionInfo) == LDAP_SUCCESS) {</span>
<a href="#l25.269"></a><span id="l25.269" class="difflineminus">-	sessionClosure = reinterpret_cast&lt;nsLDAPSSLSessionClosure *&gt;</span>
<a href="#l25.270"></a><span id="l25.270" class="difflineplus">+        sessionClosure = reinterpret_cast&lt;nsLDAPSSLSessionClosure *&gt;</span>
<a href="#l25.271"></a><span id="l25.271">                                   (sessionInfo.seinfo_appdata);</span>
<a href="#l25.272"></a><span id="l25.272" class="difflineminus">-	disposehdl_fn = sessionClosure-&gt;realDisposeHandle;</span>
<a href="#l25.273"></a><span id="l25.273" class="difflineminus">-	nsLDAPSSLFreeSessionClosure(&amp;sessionClosure);</span>
<a href="#l25.274"></a><span id="l25.274" class="difflineminus">-	(*disposehdl_fn)(ld, sessionarg);</span>
<a href="#l25.275"></a><span id="l25.275" class="difflineplus">+        disposehdl_fn = sessionClosure-&gt;realDisposeHandle;</span>
<a href="#l25.276"></a><span id="l25.276" class="difflineplus">+        nsLDAPSSLFreeSessionClosure(&amp;sessionClosure);</span>
<a href="#l25.277"></a><span id="l25.277" class="difflineplus">+        (*disposehdl_fn)(ld, sessionarg);</span>
<a href="#l25.278"></a><span id="l25.278">     }</span>
<a href="#l25.279"></a><span id="l25.279"> }</span>
<a href="#l25.280"></a><span id="l25.280"> </span>
<a href="#l25.281"></a><span id="l25.281"> // Installs appropriate routines and data for making this connection</span>
<a href="#l25.282"></a><span id="l25.282"> // handle SSL.  The aHostName is ultimately passed to PSM and is used to</span>
<a href="#l25.283"></a><span id="l25.283"> // validate certificates.</span>
<a href="#l25.284"></a><span id="l25.284"> //</span>
<a href="#l25.285"></a><span id="l25.285"> nsresult</span>
<a href="#l25.286"></a><span id="l25.286"> nsLDAPInstallSSL( LDAP *ld, const char *aHostName)</span>
<a href="#l25.287"></a><span id="l25.287"> {</span>
<a href="#l25.288"></a><span id="l25.288">     struct ldap_x_ext_io_fns iofns;</span>
<a href="#l25.289"></a><span id="l25.289">     nsLDAPSSLSessionClosure *sessionClosure;</span>
<a href="#l25.290"></a><span id="l25.290">     PRLDAPSessionInfo sessionInfo;</span>
<a href="#l25.291"></a><span id="l25.291"> </span>
<a href="#l25.292"></a><span id="l25.292">     // Allocate our own session information.</span>
<a href="#l25.293"></a><span id="l25.293">     //</span>
<a href="#l25.294"></a><span id="l25.294" class="difflineminus">-    sessionClosure = static_cast&lt;nsLDAPSSLSessionClosure *&gt;(moz_xmalloc(</span>
<a href="#l25.295"></a><span id="l25.295" class="difflineminus">-					sizeof(nsLDAPSSLSessionClosure)));</span>
<a href="#l25.296"></a><span id="l25.296" class="difflineplus">+    sessionClosure = static_cast&lt;nsLDAPSSLSessionClosure *&gt;</span>
<a href="#l25.297"></a><span id="l25.297" class="difflineplus">+                       (moz_xmalloc(sizeof(nsLDAPSSLSessionClosure)));</span>
<a href="#l25.298"></a><span id="l25.298">     if (!sessionClosure) {</span>
<a href="#l25.299"></a><span id="l25.299" class="difflineminus">-	return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l25.300"></a><span id="l25.300" class="difflineplus">+        return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l25.301"></a><span id="l25.301">     }</span>
<a href="#l25.302"></a><span id="l25.302">     memset(sessionClosure, 0, sizeof(nsLDAPSSLSessionClosure));</span>
<a href="#l25.303"></a><span id="l25.303"> </span>
<a href="#l25.304"></a><span id="l25.304">     // Override a few functions, saving a pointer to the original function</span>
<a href="#l25.305"></a><span id="l25.305">     // in each case so we can call it from our SSL savvy functions.</span>
<a href="#l25.306"></a><span id="l25.306">     //</span>
<a href="#l25.307"></a><span id="l25.307">     memset(&amp;iofns, 0, sizeof(iofns));</span>
<a href="#l25.308"></a><span id="l25.308">     iofns.lextiof_size = LDAP_X_EXTIO_FNS_SIZE;</span>
<a href="#l25.309"></a><span id="l25.309">     if (ldap_get_option(ld, LDAP_X_OPT_EXTIO_FN_PTRS,</span>
<a href="#l25.310"></a><span id="l25.310" class="difflineminus">-			static_cast&lt;void *&gt;(&amp;iofns)) != LDAP_SUCCESS) {</span>
<a href="#l25.311"></a><span id="l25.311" class="difflineminus">-	NS_ERROR(&quot;nsLDAPInstallSSL(): unexpected error getting&quot;</span>
<a href="#l25.312"></a><span id="l25.312" class="difflineminus">-		 &quot; LDAP_X_OPT_EXTIO_FN_PTRS&quot;);</span>
<a href="#l25.313"></a><span id="l25.313" class="difflineminus">-	nsLDAPSSLFreeSessionClosure(&amp;sessionClosure);</span>
<a href="#l25.314"></a><span id="l25.314" class="difflineplus">+                        static_cast&lt;void *&gt;(&amp;iofns)) != LDAP_SUCCESS) {</span>
<a href="#l25.315"></a><span id="l25.315" class="difflineplus">+        NS_ERROR(&quot;nsLDAPInstallSSL(): unexpected error getting&quot;</span>
<a href="#l25.316"></a><span id="l25.316" class="difflineplus">+                 &quot; LDAP_X_OPT_EXTIO_FN_PTRS&quot;);</span>
<a href="#l25.317"></a><span id="l25.317" class="difflineplus">+        nsLDAPSSLFreeSessionClosure(&amp;sessionClosure);</span>
<a href="#l25.318"></a><span id="l25.318">         return NS_ERROR_UNEXPECTED;</span>
<a href="#l25.319"></a><span id="l25.319">     }</span>
<a href="#l25.320"></a><span id="l25.320"> </span>
<a href="#l25.321"></a><span id="l25.321">     // Make a copy of the hostname to pass to AddToSocket later</span>
<a href="#l25.322"></a><span id="l25.322">     //</span>
<a href="#l25.323"></a><span id="l25.323">     sessionClosure-&gt;hostname = PL_strdup(aHostName);</span>
<a href="#l25.324"></a><span id="l25.324">     if (!sessionClosure-&gt;hostname) {</span>
<a href="#l25.325"></a><span id="l25.325" class="difflineminus">-	NS_ERROR(&quot;nsLDAPInstallSSL(): PL_strdup failed\n&quot;);</span>
<a href="#l25.326"></a><span id="l25.326" class="difflineminus">-	nsLDAPSSLFreeSessionClosure(&amp;sessionClosure);</span>
<a href="#l25.327"></a><span id="l25.327" class="difflineminus">-	return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l25.328"></a><span id="l25.328" class="difflineplus">+        NS_ERROR(&quot;nsLDAPInstallSSL(): PL_strdup failed\n&quot;);</span>
<a href="#l25.329"></a><span id="l25.329" class="difflineplus">+        nsLDAPSSLFreeSessionClosure(&amp;sessionClosure);</span>
<a href="#l25.330"></a><span id="l25.330" class="difflineplus">+        return NS_ERROR_OUT_OF_MEMORY;</span>
<a href="#l25.331"></a><span id="l25.331">     }</span>
<a href="#l25.332"></a><span id="l25.332"> </span>
<a href="#l25.333"></a><span id="l25.333">     // Override functions</span>
<a href="#l25.334"></a><span id="l25.334">     //</span>
<a href="#l25.335"></a><span id="l25.335">     sessionClosure-&gt;realClose = iofns.lextiof_close;</span>
<a href="#l25.336"></a><span id="l25.336">     iofns.lextiof_close = nsLDAPSSLClose;</span>
<a href="#l25.337"></a><span id="l25.337">     sessionClosure-&gt;realConnect = iofns.lextiof_connect;</span>
<a href="#l25.338"></a><span id="l25.338">     iofns.lextiof_connect = nsLDAPSSLConnect;</span>
<a href="#l25.339"></a><span id="l25.339">     sessionClosure-&gt;realDisposeHandle = iofns.lextiof_disposehandle;</span>
<a href="#l25.340"></a><span id="l25.340">     iofns.lextiof_disposehandle = nsLDAPSSLDisposeHandle;</span>
<a href="#l25.341"></a><span id="l25.341"> </span>
<a href="#l25.342"></a><span id="l25.342">     if (ldap_set_option(ld, LDAP_X_OPT_EXTIO_FN_PTRS,</span>
<a href="#l25.343"></a><span id="l25.343" class="difflineminus">-			static_cast&lt;void *&gt;(&amp;iofns)) != LDAP_SUCCESS) {</span>
<a href="#l25.344"></a><span id="l25.344" class="difflineminus">-	NS_ERROR(&quot;nsLDAPInstallSSL(): error setting LDAP_X_OPT_EXTIO_FN_PTRS&quot;);</span>
<a href="#l25.345"></a><span id="l25.345" class="difflineminus">-	nsLDAPSSLFreeSessionClosure(&amp;sessionClosure);</span>
<a href="#l25.346"></a><span id="l25.346" class="difflineplus">+                        static_cast&lt;void *&gt;(&amp;iofns)) != LDAP_SUCCESS) {</span>
<a href="#l25.347"></a><span id="l25.347" class="difflineplus">+        NS_ERROR(&quot;nsLDAPInstallSSL(): error setting LDAP_X_OPT_EXTIO_FN_PTRS&quot;);</span>
<a href="#l25.348"></a><span id="l25.348" class="difflineplus">+        nsLDAPSSLFreeSessionClosure(&amp;sessionClosure);</span>
<a href="#l25.349"></a><span id="l25.349">         return NS_ERROR_FAILURE;</span>
<a href="#l25.350"></a><span id="l25.350">     }</span>
<a href="#l25.351"></a><span id="l25.351"> </span>
<a href="#l25.352"></a><span id="l25.352">     // Store session info. for later retrieval.</span>
<a href="#l25.353"></a><span id="l25.353">     //</span>
<a href="#l25.354"></a><span id="l25.354">     sessionInfo.seinfo_size = PRLDAP_SESSIONINFO_SIZE;</span>
<a href="#l25.355"></a><span id="l25.355">     sessionInfo.seinfo_appdata = reinterpret_cast&lt;prldap_session_private *&gt;</span>
<a href="#l25.356"></a><span id="l25.356">                                                  (sessionClosure);</span>
<a href="#l25.357"></a><span id="l25.357">     if (prldap_set_session_info(ld, nullptr, &amp;sessionInfo) != LDAP_SUCCESS) {</span>
<a href="#l25.358"></a><span id="l25.358" class="difflineminus">-	NS_ERROR(&quot;nsLDAPInstallSSL(): error setting prldap session info&quot;);</span>
<a href="#l25.359"></a><span id="l25.359" class="difflineminus">-	free(sessionClosure);</span>
<a href="#l25.360"></a><span id="l25.360" class="difflineminus">-	return NS_ERROR_UNEXPECTED;</span>
<a href="#l25.361"></a><span id="l25.361" class="difflineplus">+        NS_ERROR(&quot;nsLDAPInstallSSL(): error setting prldap session info&quot;);</span>
<a href="#l25.362"></a><span id="l25.362" class="difflineplus">+        free(sessionClosure);</span>
<a href="#l25.363"></a><span id="l25.363" class="difflineplus">+        return NS_ERROR_UNEXPECTED;</span>
<a href="#l25.364"></a><span id="l25.364">     }</span>
<a href="#l25.365"></a><span id="l25.365"> </span>
<a href="#l25.366"></a><span id="l25.366">     return NS_OK;</span>
<a href="#l25.367"></a><span id="l25.367"> }</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:32Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

