<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 1609:20af028c35beabaa3cc50e948144f7404278faff</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 20af028c35beabaa3cc50e948144f7404278faff" />
<meta property="og:url" content="/comm-central/rev/20af028c35beabaa3cc50e948144f7404278faff" />
<meta property="og:description" content="add archive folder command, 451995, r=standard8, sr=neil" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 20af028c35beabaa3cc50e948144f7404278faff 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/20af028c35beabaa3cc50e948144f7404278faff">shortlog</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/20af028c35beabaa3cc50e948144f7404278faff">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff">files</a> |
changeset |
<a href="/comm-central/raw-rev/20af028c35beabaa3cc50e948144f7404278faff">raw</a>  | <a href="/comm-central/archive/20af028c35beabaa3cc50e948144f7404278faff.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
add archive folder command, 451995, r=standard8, sr=neil
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#68;&#97;&#118;&#105;&#100;&#32;&#66;&#105;&#101;&#110;&#118;&#101;&#110;&#117;&#32;&#60;&#98;&#105;&#101;&#110;&#118;&#101;&#110;&#117;&#64;&#110;&#118;&#101;&#110;&#116;&#117;&#114;&#101;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Mon, 12 Jan 2009 12:25:06 -0800</td></tr>

<tr>
 <td>changeset 1609</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/20af028c35beabaa3cc50e948144f7404278faff">20af028c35beabaa3cc50e948144f7404278faff</a></td>
</tr>



<tr>
<td>parent 1608</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/e1e2aaca0863da0780a9fe7f63c2047e2fa68487">e1e2aaca0863da0780a9fe7f63c2047e2fa68487</a>
</td>
</tr>

<tr>
<td>child 1610</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/3e6578d421dea4bac7c823a93f41102782a8ef06">3e6578d421dea4bac7c823a93f41102782a8ef06</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=20af028c35beabaa3cc50e948144f7404278faff">1290</a></td></tr>
<tr><td>push user</td><td>bienvenu@nventure.com</td></tr>
<tr><td>push date</td><td class="date age">Mon, 12 Jan 2009 20:25:16 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@20af028c35be [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=20af028c35beabaa3cc50e948144f7404278faff">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=20af028c35beabaa3cc50e948144f7404278faff&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=20af028c35beabaa3cc50e948144f7404278faff&newProject=comm-central&newRevision=20af028c35beabaa3cc50e948144f7404278faff&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=20af028c35beabaa3cc50e948144f7404278faff&newProject=comm-central&newRevision=20af028c35beabaa3cc50e948144f7404278faff&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=20af028c35beabaa3cc50e948144f7404278faff&newProject=comm-central&newRevision=20af028c35beabaa3cc50e948144f7404278faff&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28standard8%29&revcount=50">standard8</a>, <a href="/comm-central/log?rev=reviewer%28neil%29&revcount=50">neil</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=451995">451995</a></td></tr>




</table></div>

<div class="page_body description">add archive folder command, 451995, r=standard8, sr=neil</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/am-copies.dtd">mail/locales/en-US/chrome/messenger/am-copies.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/am-copies.dtd">file</a> |
<a href="/comm-central/annotate/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/am-copies.dtd">annotate</a> |
<a href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/am-copies.dtd">diff</a> |
<a href="/comm-central/comparison/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/am-copies.dtd">comparison</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/am-copies.dtd">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/messenger.dtd">mail/locales/en-US/chrome/messenger/messenger.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/messenger.dtd">file</a> |
<a href="/comm-central/annotate/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/messenger.dtd">annotate</a> |
<a href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/messenger.dtd">diff</a> |
<a href="/comm-central/comparison/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/messenger.dtd">comparison</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/messenger.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/messenger.properties">mail/locales/en-US/chrome/messenger/messenger.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/messenger.properties">file</a> |
<a href="/comm-central/annotate/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/messenger.properties">annotate</a> |
<a href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/messenger.properties">diff</a> |
<a href="/comm-central/comparison/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/messenger.properties">comparison</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/messenger.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/msgHdrViewOverlay.dtd">mail/locales/en-US/chrome/messenger/msgHdrViewOverlay.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/msgHdrViewOverlay.dtd">file</a> |
<a href="/comm-central/annotate/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/msgHdrViewOverlay.dtd">annotate</a> |
<a href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/msgHdrViewOverlay.dtd">diff</a> |
<a href="/comm-central/comparison/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/msgHdrViewOverlay.dtd">comparison</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff/mail/locales/en-US/chrome/messenger/msgHdrViewOverlay.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/prefs/resources/content/am-copies.js">mailnews/base/prefs/resources/content/am-copies.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/prefs/resources/content/am-copies.js">file</a> |
<a href="/comm-central/annotate/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/prefs/resources/content/am-copies.js">annotate</a> |
<a href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/prefs/resources/content/am-copies.js">diff</a> |
<a href="/comm-central/comparison/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/prefs/resources/content/am-copies.js">comparison</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/prefs/resources/content/am-copies.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/prefs/resources/content/am-copiesOverlay.xul">mailnews/base/prefs/resources/content/am-copiesOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/prefs/resources/content/am-copiesOverlay.xul">file</a> |
<a href="/comm-central/annotate/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/prefs/resources/content/am-copiesOverlay.xul">annotate</a> |
<a href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/prefs/resources/content/am-copiesOverlay.xul">diff</a> |
<a href="/comm-central/comparison/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/prefs/resources/content/am-copiesOverlay.xul">comparison</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/prefs/resources/content/am-copiesOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/public/nsIMsgIdentity.idl">mailnews/base/public/nsIMsgIdentity.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/public/nsIMsgIdentity.idl">file</a> |
<a href="/comm-central/annotate/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/public/nsIMsgIdentity.idl">annotate</a> |
<a href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/public/nsIMsgIdentity.idl">diff</a> |
<a href="/comm-central/comparison/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/public/nsIMsgIdentity.idl">comparison</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/public/nsIMsgIdentity.idl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/public/nsMsgFolderFlags.idl">mailnews/base/public/nsMsgFolderFlags.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/public/nsMsgFolderFlags.idl">file</a> |
<a href="/comm-central/annotate/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/public/nsMsgFolderFlags.idl">annotate</a> |
<a href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/public/nsMsgFolderFlags.idl">diff</a> |
<a href="/comm-central/comparison/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/public/nsMsgFolderFlags.idl">comparison</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/public/nsMsgFolderFlags.idl">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgDBFolder.cpp">mailnews/base/util/nsMsgDBFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgDBFolder.cpp">file</a> |
<a href="/comm-central/annotate/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgDBFolder.cpp">annotate</a> |
<a href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgDBFolder.cpp">diff</a> |
<a href="/comm-central/comparison/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgDBFolder.cpp">comparison</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgDBFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgDBFolder.h">mailnews/base/util/nsMsgDBFolder.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgDBFolder.h">file</a> |
<a href="/comm-central/annotate/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgDBFolder.h">annotate</a> |
<a href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgDBFolder.h">diff</a> |
<a href="/comm-central/comparison/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgDBFolder.h">comparison</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgDBFolder.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgIdentity.cpp">mailnews/base/util/nsMsgIdentity.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgIdentity.cpp">file</a> |
<a href="/comm-central/annotate/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgIdentity.cpp">annotate</a> |
<a href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgIdentity.cpp">diff</a> |
<a href="/comm-central/comparison/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgIdentity.cpp">comparison</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgIdentity.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgIdentity.h">mailnews/base/util/nsMsgIdentity.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgIdentity.h">file</a> |
<a href="/comm-central/annotate/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgIdentity.h">annotate</a> |
<a href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgIdentity.h">diff</a> |
<a href="/comm-central/comparison/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgIdentity.h">comparison</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff/mailnews/base/util/nsMsgIdentity.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/mailnews.js">mailnews/mailnews.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff/mailnews/mailnews.js">file</a> |
<a href="/comm-central/annotate/20af028c35beabaa3cc50e948144f7404278faff/mailnews/mailnews.js">annotate</a> |
<a href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/mailnews/mailnews.js">diff</a> |
<a href="/comm-central/comparison/20af028c35beabaa3cc50e948144f7404278faff/mailnews/mailnews.js">comparison</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff/mailnews/mailnews.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/suite/locales/en-US/chrome/mailnews/messenger.properties">suite/locales/en-US/chrome/mailnews/messenger.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff/suite/locales/en-US/chrome/mailnews/messenger.properties">file</a> |
<a href="/comm-central/annotate/20af028c35beabaa3cc50e948144f7404278faff/suite/locales/en-US/chrome/mailnews/messenger.properties">annotate</a> |
<a href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/suite/locales/en-US/chrome/mailnews/messenger.properties">diff</a> |
<a href="/comm-central/comparison/20af028c35beabaa3cc50e948144f7404278faff/suite/locales/en-US/chrome/mailnews/messenger.properties">comparison</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff/suite/locales/en-US/chrome/mailnews/messenger.properties">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/suite/locales/en-US/chrome/mailnews/pref/am-copies.dtd">suite/locales/en-US/chrome/mailnews/pref/am-copies.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/20af028c35beabaa3cc50e948144f7404278faff/suite/locales/en-US/chrome/mailnews/pref/am-copies.dtd">file</a> |
<a href="/comm-central/annotate/20af028c35beabaa3cc50e948144f7404278faff/suite/locales/en-US/chrome/mailnews/pref/am-copies.dtd">annotate</a> |
<a href="/comm-central/diff/20af028c35beabaa3cc50e948144f7404278faff/suite/locales/en-US/chrome/mailnews/pref/am-copies.dtd">diff</a> |
<a href="/comm-central/comparison/20af028c35beabaa3cc50e948144f7404278faff/suite/locales/en-US/chrome/mailnews/pref/am-copies.dtd">comparison</a> |
<a href="/comm-central/log/20af028c35beabaa3cc50e948144f7404278faff/suite/locales/en-US/chrome/mailnews/pref/am-copies.dtd">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/am-copies.dtd</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/am-copies.dtd</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -16,16 +16,22 @@</span>
<a href="#l1.4"></a><span id="l1.4"> &lt;!ENTITY sentFolderOn.accesskey &quot;S&quot;&gt;</span>
<a href="#l1.5"></a><span id="l1.5"> &lt;!ENTITY sentInOtherFolder.label &quot;Other:&quot;&gt;</span>
<a href="#l1.6"></a><span id="l1.6"> &lt;!ENTITY sentInOtherFolder.accesskey &quot;O&quot;&gt;</span>
<a href="#l1.7"></a><span id="l1.7"> &lt;!-- LOCALIZATION NOTE (draftsFolderOn.label): OK to translate this, bug #57440 --&gt;</span>
<a href="#l1.8"></a><span id="l1.8"> &lt;!ENTITY draftsFolderOn.label &quot;&amp;quot;Drafts&amp;quot; Folder on:&quot;&gt;</span>
<a href="#l1.9"></a><span id="l1.9"> &lt;!ENTITY draftsFolderOn.accesskey &quot;D&quot;&gt;</span>
<a href="#l1.10"></a><span id="l1.10"> &lt;!ENTITY draftInOtherFolder.label &quot;Other:&quot;&gt;</span>
<a href="#l1.11"></a><span id="l1.11"> &lt;!ENTITY draftInOtherFolder.accesskey &quot;t&quot;&gt;</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (archivesFolderOn.label): OK to translate this, bug #57440 --&gt;</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+&lt;!ENTITY archivesFolderOn.label &quot;&amp;quot;Archives&amp;quot; Folder on:&quot;&gt;</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+&lt;!ENTITY archivesFolderOn.accesskey &quot;D&quot;&gt;</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineplus">+&lt;!ENTITY archiveInOtherFolder.label &quot;Other:&quot;&gt;</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineplus">+&lt;!ENTITY archiveInOtherFolder.accesskey &quot;t&quot;&gt;</span>
<a href="#l1.17"></a><span id="l1.17"> &lt;!-- LOCALIZATION NOTE (templatesFolderOn.label): OK to translate this, bug #57440 --&gt;</span>
<a href="#l1.18"></a><span id="l1.18"> &lt;!ENTITY templatesFolderOn.label &quot;&amp;quot;Templates&amp;quot; Folder on:&quot;&gt;</span>
<a href="#l1.19"></a><span id="l1.19"> &lt;!ENTITY templatesFolderOn.accesskey &quot;m&quot;&gt;</span>
<a href="#l1.20"></a><span id="l1.20"> &lt;!ENTITY templateInOtherFolder.label &quot;Other:&quot;&gt;</span>
<a href="#l1.21"></a><span id="l1.21"> &lt;!ENTITY templateInOtherFolder.accesskey &quot;e&quot;&gt;</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineminus">-&lt;!ENTITY specialFoldersTitle.label &quot;Drafts and Templates&quot;&gt;</span>
<a href="#l1.23"></a><span id="l1.23" class="difflineplus">+&lt;!ENTITY specialFoldersTitle.label &quot;Drafts, Archives, and Templates&quot;&gt;</span>
<a href="#l1.24"></a><span id="l1.24"> &lt;!ENTITY keepDrafts.label &quot;Keep message drafts in:&quot;&gt;</span>
<a href="#l1.25"></a><span id="l1.25" class="difflineplus">+&lt;!ENTITY keepArchives.label &quot;Keep message archives in:&quot;&gt;</span>
<a href="#l1.26"></a><span id="l1.26"> &lt;!ENTITY keepTempltes.label &quot;Keep message templates in:&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -304,16 +304,19 @@ you can use these alternative items. Oth</span>
<a href="#l2.4"></a><span id="l2.4"> &lt;!ENTITY startPageCmd.label &quot;Mail Start Page&quot;&gt;</span>
<a href="#l2.5"></a><span id="l2.5"> &lt;!ENTITY startPageCmd.accesskey &quot;S&quot;&gt;</span>
<a href="#l2.6"></a><span id="l2.6"> &lt;!ENTITY msgMenu.label &quot;Message&quot;&gt;</span>
<a href="#l2.7"></a><span id="l2.7"> &lt;!ENTITY msgMenu.accesskey &quot;M&quot;&gt;</span>
<a href="#l2.8"></a><span id="l2.8"> &lt;!ENTITY newMsgCmd.label &quot;New Message&quot;&gt;</span>
<a href="#l2.9"></a><span id="l2.9"> &lt;!ENTITY newMsgCmd.accesskey &quot;N&quot;&gt;</span>
<a href="#l2.10"></a><span id="l2.10"> &lt;!ENTITY newNewMsgCmd.label &quot;Message&quot;&gt;</span>
<a href="#l2.11"></a><span id="l2.11"> &lt;!ENTITY newNewMsgCmd.accesskey &quot;M&quot;&gt;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+&lt;!ENTITY archiveMsgCmd.label &quot;Archive&quot;&gt;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+&lt;!ENTITY archiveMsgCmd.accesskey &quot;A&quot;&gt;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+&lt;!ENTITY archiveMsgCmd.key  &quot;a&quot;&gt;</span>
<a href="#l2.15"></a><span id="l2.15"> &lt;!ENTITY replyMsgCmd.label &quot;Reply&quot;&gt;</span>
<a href="#l2.16"></a><span id="l2.16"> &lt;!ENTITY replyMsgCmd.accesskey &quot;R&quot;&gt;</span>
<a href="#l2.17"></a><span id="l2.17"> &lt;!ENTITY replyMsgCmd.key  &quot;r&quot;&gt;</span>
<a href="#l2.18"></a><span id="l2.18"> &lt;!ENTITY replySenderCmd.label &quot;Reply to Sender Only&quot;&gt;</span>
<a href="#l2.19"></a><span id="l2.19"> &lt;!ENTITY replySenderCmd.accesskey &quot;R&quot;&gt;</span>
<a href="#l2.20"></a><span id="l2.20"> &lt;!ENTITY replyNewsgroupCmd.label &quot;Reply to Newsgroup&quot;&gt;</span>
<a href="#l2.21"></a><span id="l2.21"> &lt;!ENTITY replyNewsgroupCmd.accesskey  &quot;y&quot;&gt;</span>
<a href="#l2.22"></a><span id="l2.22"> &lt;!ENTITY replyToAllMsgCmd.label &quot;Reply to All&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/messenger.properties</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/messenger.properties</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -164,16 +164,18 @@ localFolders=Local Folders</span>
<a href="#l3.4"></a><span id="l3.4"> # LOCALIZATION NOTE (inboxFolderName): OK to translate all foldernames, bugzilla #57440 &amp; bugzilla #23625 fixed</span>
<a href="#l3.5"></a><span id="l3.5"> inboxFolderName=Inbox</span>
<a href="#l3.6"></a><span id="l3.6"> trashFolderName=Trash</span>
<a href="#l3.7"></a><span id="l3.7"> sentFolderName=Sent</span>
<a href="#l3.8"></a><span id="l3.8"> draftsFolderName=Drafts</span>
<a href="#l3.9"></a><span id="l3.9"> templatesFolderName=Templates</span>
<a href="#l3.10"></a><span id="l3.10"> outboxFolderName=Outbox</span>
<a href="#l3.11"></a><span id="l3.11"> junkFolderName=Junk</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+archivesFolderName=Archives</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+</span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15"> # Error message for special folder deletion on imap accounts</span>
<a href="#l3.16"></a><span id="l3.16"> # LOCALIZATION NOTE (specialFolderDeletionErr): Do not translate &quot;IMAP&quot; in the line below</span>
<a href="#l3.17"></a><span id="l3.17"> specialFolderDeletionErr=Deletion of special folder %S is not allowed for IMAP accounts.</span>
<a href="#l3.18"></a><span id="l3.18"> specialFolderDeletionErrTitle=Special Folder Deletion</span>
<a href="#l3.19"></a><span id="l3.19"> </span>
<a href="#l3.20"></a><span id="l3.20"> # &quot;Normal&quot; priority is often blank,</span>
<a href="#l3.21"></a><span id="l3.21"> # depending on the consumers of these strings</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/msgHdrViewOverlay.dtd</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/msgHdrViewOverlay.dtd</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -52,18 +52,19 @@</span>
<a href="#l4.4"></a><span id="l4.4"> &lt;!ENTITY userAgentField2.label &quot;user-agent &quot;&gt;</span>
<a href="#l4.5"></a><span id="l4.5"> &lt;!ENTITY referencesField2.label &quot;references &quot;&gt;</span>
<a href="#l4.6"></a><span id="l4.6"> &lt;!ENTITY messageIdField2.label &quot;message-id &quot;&gt;</span>
<a href="#l4.7"></a><span id="l4.7"> &lt;!ENTITY inReplyToField2.label &quot;in-reply-to &quot;&gt;</span>
<a href="#l4.8"></a><span id="l4.8"> &lt;!ENTITY originalWebsite2.label &quot;website &quot;&gt;</span>
<a href="#l4.9"></a><span id="l4.9"> </span>
<a href="#l4.10"></a><span id="l4.10"> &lt;!ENTITY editMessageDescription.label &quot;This is a draft message&quot;&gt;</span>
<a href="#l4.11"></a><span id="l4.11"> &lt;!ENTITY editMessageButton.label &quot;Edit…&quot;&gt;</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-&lt;!ENTITY replyButton.label &quot;reply…&quot;&gt;</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-&lt;!ENTITY forwardButton.label &quot;forward…&quot;&gt;</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+&lt;!ENTITY archiveButton.label &quot;archive&quot;&gt;</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+&lt;!ENTITY replyButton.label &quot;reply&quot;&gt;</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+&lt;!ENTITY forwardButton.label &quot;forward&quot;&gt;</span>
<a href="#l4.17"></a><span id="l4.17"> &lt;!ENTITY junkButton.label &quot;mark as junk&quot;&gt;</span>
<a href="#l4.18"></a><span id="l4.18"> &lt;!ENTITY trashButton.tooltiptext &quot;delete&quot;&gt;</span>
<a href="#l4.19"></a><span id="l4.19"> </span>
<a href="#l4.20"></a><span id="l4.20"> &lt;!ENTITY otherActionsButton.label &quot;other actions&quot;&gt;</span>
<a href="#l4.21"></a><span id="l4.21"> &lt;!ENTITY saveAsMenuItem.label &quot;save as…&quot;&gt;</span>
<a href="#l4.22"></a><span id="l4.22"> &lt;!ENTITY saveAsMenuItem.accesskey &quot;S&quot;&gt;</span>
<a href="#l4.23"></a><span id="l4.23"> &lt;!ENTITY viewSourceMenuItem.label &quot;view source…&quot;&gt;</span>
<a href="#l4.24"></a><span id="l4.24"> &lt;!ENTITY viewSourceMenuItem.accesskey &quot;V&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mailnews/base/prefs/resources/content/am-copies.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mailnews/base/prefs/resources/content/am-copies.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -31,21 +31,21 @@</span>
<a href="#l5.4"></a><span id="l5.4">  * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l5.5"></a><span id="l5.5">  * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l5.6"></a><span id="l5.6">  * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l5.7"></a><span id="l5.7">  * the provisions above, a recipient may use your version of this file under</span>
<a href="#l5.8"></a><span id="l5.8">  * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l5.9"></a><span id="l5.9">  *</span>
<a href="#l5.10"></a><span id="l5.10">  * ***** END LICENSE BLOCK ***** */</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-var gFccRadioElemChoice, gDraftsRadioElemChoice, gTmplRadioElemChoice;</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-var gFccRadioElemChoiceLocked, gDraftsRadioElemChoiceLocked, gTmplRadioElemChoiceLocked;</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+var gFccRadioElemChoice, gDraftsRadioElemChoice, gArchiveRadioElemChoice, gTmplRadioElemChoice;</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+var gFccRadioElemChoiceLocked, gDraftsRadioElemChoiceLocked, gArchivesRadioElemChoiceLocked, gTmplRadioElemChoiceLocked;</span>
<a href="#l5.16"></a><span id="l5.16"> var gDefaultPickerMode = &quot;1&quot;;</span>
<a href="#l5.17"></a><span id="l5.17"> </span>
<a href="#l5.18"></a><span id="l5.18" class="difflineminus">-var gFccFolderWithDelim, gDraftsFolderWithDelim, gTemplatesFolderWithDelim;</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+var gFccFolderWithDelim, gDraftsFolderWithDelim, gArchivesFolderWithDelim, gTemplatesFolderWithDelim;</span>
<a href="#l5.20"></a><span id="l5.20"> var gCurrentServerId;</span>
<a href="#l5.21"></a><span id="l5.21"> var gPrefBranch = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;].getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l5.22"></a><span id="l5.22"> </span>
<a href="#l5.23"></a><span id="l5.23"> function onPreInit(account, accountValues)</span>
<a href="#l5.24"></a><span id="l5.24"> {</span>
<a href="#l5.25"></a><span id="l5.25">   var type = parent.getAccountValue(account, accountValues, &quot;server&quot;, &quot;type&quot;, null, false);</span>
<a href="#l5.26"></a><span id="l5.26">   hideShowControls(type);</span>
<a href="#l5.27"></a><span id="l5.27"> }</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineat">@@ -66,25 +66,31 @@ function onInitCopiesAndFolders()</span>
<a href="#l5.29"></a><span id="l5.29">                      </span>
<a href="#l5.30"></a><span id="l5.30">     SetFolderDisplay(gFccRadioElemChoice, gFccRadioElemChoiceLocked, </span>
<a href="#l5.31"></a><span id="l5.31">                      &quot;fcc&quot;, </span>
<a href="#l5.32"></a><span id="l5.32">                      &quot;msgFccAccountPicker&quot;, </span>
<a href="#l5.33"></a><span id="l5.33">                      &quot;identity.fccFolder&quot;, </span>
<a href="#l5.34"></a><span id="l5.34">                      &quot;msgFccFolderPicker&quot;);</span>
<a href="#l5.35"></a><span id="l5.35"> </span>
<a href="#l5.36"></a><span id="l5.36">     SetFolderDisplay(gDraftsRadioElemChoice, gDraftsRadioElemChoiceLocked, </span>
<a href="#l5.37"></a><span id="l5.37" class="difflineminus">-                     &quot;draft&quot;, </span>
<a href="#l5.38"></a><span id="l5.38" class="difflineminus">-                     &quot;msgDraftsAccountPicker&quot;, </span>
<a href="#l5.39"></a><span id="l5.39" class="difflineminus">-                     &quot;identity.draftFolder&quot;, </span>
<a href="#l5.40"></a><span id="l5.40" class="difflineplus">+                     &quot;draft&quot;,</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+                     &quot;msgDraftsAccountPicker&quot;,</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+                     &quot;identity.draftFolder&quot;,</span>
<a href="#l5.43"></a><span id="l5.43">                      &quot;msgDraftsFolderPicker&quot;);</span>
<a href="#l5.44"></a><span id="l5.44"> </span>
<a href="#l5.45"></a><span id="l5.45" class="difflineminus">-    SetFolderDisplay(gTmplRadioElemChoice, gTmplRadioElemChoiceLocked, </span>
<a href="#l5.46"></a><span id="l5.46" class="difflineminus">-                     &quot;tmpl&quot;, </span>
<a href="#l5.47"></a><span id="l5.47" class="difflineminus">-                     &quot;msgStationeryAccountPicker&quot;, </span>
<a href="#l5.48"></a><span id="l5.48" class="difflineminus">-                     &quot;identity.stationeryFolder&quot;, </span>
<a href="#l5.49"></a><span id="l5.49" class="difflineplus">+    SetFolderDisplay(gArchivesRadioElemChoice, gArchivesRadioElemChoiceLocked,</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineplus">+                     &quot;archive&quot;,</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineplus">+                     &quot;msgArchivesAccountPicker&quot;,</span>
<a href="#l5.52"></a><span id="l5.52" class="difflineplus">+                     &quot;identity.archiveFolder&quot;,</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineplus">+                     &quot;msgArchivesFolderPicker&quot;);</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineplus">+</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineplus">+    SetFolderDisplay(gTmplRadioElemChoice, gTmplRadioElemChoiceLocked,</span>
<a href="#l5.56"></a><span id="l5.56" class="difflineplus">+                     &quot;tmpl&quot;,</span>
<a href="#l5.57"></a><span id="l5.57" class="difflineplus">+                     &quot;msgStationeryAccountPicker&quot;,</span>
<a href="#l5.58"></a><span id="l5.58" class="difflineplus">+                     &quot;identity.stationeryFolder&quot;,</span>
<a href="#l5.59"></a><span id="l5.59">                      &quot;msgStationeryFolderPicker&quot;);</span>
<a href="#l5.60"></a><span id="l5.60">     </span>
<a href="#l5.61"></a><span id="l5.61">     setupBccTextbox();</span>
<a href="#l5.62"></a><span id="l5.62">     setupFccItems();</span>
<a href="#l5.63"></a><span id="l5.63"> </span>
<a href="#l5.64"></a><span id="l5.64">     SetSpecialFolderNamesWithDelims();</span>
<a href="#l5.65"></a><span id="l5.65"> }</span>
<a href="#l5.66"></a><span id="l5.66"> </span>
<a href="#l5.67"></a><span id="l5.67" class="difflineat">@@ -96,16 +102,21 @@ function SetGlobalRadioElemChoices()</span>
<a href="#l5.68"></a><span id="l5.68">     gFccRadioElemChoiceLocked = pickerModeElement.getAttribute(&quot;disabled&quot;);</span>
<a href="#l5.69"></a><span id="l5.69">     if (!gFccRadioElemChoice) gFccRadioElemChoice = gDefaultPickerMode;</span>
<a href="#l5.70"></a><span id="l5.70"> </span>
<a href="#l5.71"></a><span id="l5.71">     pickerModeElement = document.getElementById(&quot;identity.draftsFolderPickerMode&quot;);</span>
<a href="#l5.72"></a><span id="l5.72">     gDraftsRadioElemChoice = pickerModeElement.getAttribute(&quot;value&quot;);</span>
<a href="#l5.73"></a><span id="l5.73">     gDraftsRadioElemChoiceLocked = pickerModeElement.getAttribute(&quot;disabled&quot;);</span>
<a href="#l5.74"></a><span id="l5.74">     if (!gDraftsRadioElemChoice) gDraftsRadioElemChoice = gDefaultPickerMode;</span>
<a href="#l5.75"></a><span id="l5.75"> </span>
<a href="#l5.76"></a><span id="l5.76" class="difflineplus">+    pickerModeElement = document.getElementById(&quot;identity.archivesFolderPickerMode&quot;);</span>
<a href="#l5.77"></a><span id="l5.77" class="difflineplus">+    gArchivesRadioElemChoice = pickerModeElement.getAttribute(&quot;value&quot;);</span>
<a href="#l5.78"></a><span id="l5.78" class="difflineplus">+    gArchivesRadioElemChoiceLocked = pickerModeElement.getAttribute(&quot;disabled&quot;);</span>
<a href="#l5.79"></a><span id="l5.79" class="difflineplus">+    if (!gArchivesRadioElemChoice) gArchivesRadioElemChoice = gDefaultPickerMode;</span>
<a href="#l5.80"></a><span id="l5.80" class="difflineplus">+    </span>
<a href="#l5.81"></a><span id="l5.81">     pickerModeElement = document.getElementById(&quot;identity.tmplFolderPickerMode&quot;);</span>
<a href="#l5.82"></a><span id="l5.82">     gTmplRadioElemChoice = pickerModeElement.getAttribute(&quot;value&quot;);</span>
<a href="#l5.83"></a><span id="l5.83">     gTmplRadioElemChoiceLocked = pickerModeElement.getAttribute(&quot;disabled&quot;);</span>
<a href="#l5.84"></a><span id="l5.84">     if (!gTmplRadioElemChoice) gTmplRadioElemChoice = gDefaultPickerMode;</span>
<a href="#l5.85"></a><span id="l5.85"> }</span>
<a href="#l5.86"></a><span id="l5.86"> </span>
<a href="#l5.87"></a><span id="l5.87"> /* </span>
<a href="#l5.88"></a><span id="l5.88">  * Set Account and Folder elements based on the values read from </span>
<a href="#l5.89"></a><span id="l5.89" class="difflineat">@@ -191,16 +202,21 @@ function noteSelectionChange(radioItemId</span>
<a href="#l5.90"></a><span id="l5.90">             picker = document.getElementById(&quot;msgFccFolderPicker&quot;);</span>
<a href="#l5.91"></a><span id="l5.91">             break;</span>
<a href="#l5.92"></a><span id="l5.92">     </span>
<a href="#l5.93"></a><span id="l5.93">         case &quot;messageDrafts&quot; :</span>
<a href="#l5.94"></a><span id="l5.94">             gDraftsRadioElemChoice = modeValue;</span>
<a href="#l5.95"></a><span id="l5.95">             picker = document.getElementById(&quot;msgDraftsFolderPicker&quot;);</span>
<a href="#l5.96"></a><span id="l5.96">             break;</span>
<a href="#l5.97"></a><span id="l5.97"> </span>
<a href="#l5.98"></a><span id="l5.98" class="difflineplus">+        case &quot;messageArchives&quot; :</span>
<a href="#l5.99"></a><span id="l5.99" class="difflineplus">+            gArchivesRadioElemChoice = modeValue;</span>
<a href="#l5.100"></a><span id="l5.100" class="difflineplus">+            picker = document.getElementById(&quot;msgArchivesFolderPicker&quot;);</span>
<a href="#l5.101"></a><span id="l5.101" class="difflineplus">+            break;</span>
<a href="#l5.102"></a><span id="l5.102" class="difflineplus">+</span>
<a href="#l5.103"></a><span id="l5.103">         case &quot;messageTemplates&quot; :</span>
<a href="#l5.104"></a><span id="l5.104">             gTmplRadioElemChoice = modeValue;</span>
<a href="#l5.105"></a><span id="l5.105">             picker = document.getElementById(&quot;msgStationeryFolderPicker&quot;);</span>
<a href="#l5.106"></a><span id="l5.106">             break;</span>
<a href="#l5.107"></a><span id="l5.107">     }</span>
<a href="#l5.108"></a><span id="l5.108">     picker.folder = folder;</span>
<a href="#l5.109"></a><span id="l5.109">     picker.setAttribute(&quot;label&quot;, folder.prettyName);</span>
<a href="#l5.110"></a><span id="l5.110"> }</span>
<a href="#l5.111"></a><span id="l5.111" class="difflineat">@@ -210,16 +226,17 @@ function noteSelectionChange(radioItemId</span>
<a href="#l5.112"></a><span id="l5.112"> // server URI of the selected account.</span>
<a href="#l5.113"></a><span id="l5.113"> function SetSpecialFolderNamesWithDelims()</span>
<a href="#l5.114"></a><span id="l5.114"> {</span>
<a href="#l5.115"></a><span id="l5.115">     var folderDelim = &quot;/&quot;;</span>
<a href="#l5.116"></a><span id="l5.116">     /* we use internal names known to everyone like &quot;Sent&quot;, &quot;Templates&quot; and &quot;Drafts&quot; */</span>
<a href="#l5.117"></a><span id="l5.117"> </span>
<a href="#l5.118"></a><span id="l5.118">     gFccFolderWithDelim = folderDelim + &quot;Sent&quot;;</span>
<a href="#l5.119"></a><span id="l5.119">     gDraftsFolderWithDelim = folderDelim + &quot;Drafts&quot;;</span>
<a href="#l5.120"></a><span id="l5.120" class="difflineplus">+    gArchivesFolderWithDelim = folderDelim + &quot;Archives&quot;;</span>
<a href="#l5.121"></a><span id="l5.121">     gTemplatesFolderWithDelim = folderDelim + &quot;Templates&quot;;</span>
<a href="#l5.122"></a><span id="l5.122"> }</span>
<a href="#l5.123"></a><span id="l5.123"> </span>
<a href="#l5.124"></a><span id="l5.124"> // Save all changes on this page</span>
<a href="#l5.125"></a><span id="l5.125"> function onSave()</span>
<a href="#l5.126"></a><span id="l5.126"> {</span>
<a href="#l5.127"></a><span id="l5.127">     onSaveCopiesAndFolders();</span>
<a href="#l5.128"></a><span id="l5.128"> }</span>
<a href="#l5.129"></a><span id="l5.129" class="difflineat">@@ -237,16 +254,24 @@ function onSaveCopiesAndFolders()</span>
<a href="#l5.130"></a><span id="l5.130">     SaveFolderSettings( gDraftsRadioElemChoice, </span>
<a href="#l5.131"></a><span id="l5.131">                         &quot;messageDrafts&quot;,</span>
<a href="#l5.132"></a><span id="l5.132">                         gDraftsFolderWithDelim, </span>
<a href="#l5.133"></a><span id="l5.133">                         &quot;msgDraftsAccountPicker&quot;, </span>
<a href="#l5.134"></a><span id="l5.134">                         &quot;msgDraftsFolderPicker&quot;,</span>
<a href="#l5.135"></a><span id="l5.135">                         &quot;identity.draftFolder&quot;,</span>
<a href="#l5.136"></a><span id="l5.136">                         &quot;identity.draftsFolderPickerMode&quot; );</span>
<a href="#l5.137"></a><span id="l5.137"> </span>
<a href="#l5.138"></a><span id="l5.138" class="difflineplus">+    SaveFolderSettings(gArchivesRadioElemChoice,</span>
<a href="#l5.139"></a><span id="l5.139" class="difflineplus">+                        &quot;messageArchives&quot;,</span>
<a href="#l5.140"></a><span id="l5.140" class="difflineplus">+                        gArchivesFolderWithDelim,</span>
<a href="#l5.141"></a><span id="l5.141" class="difflineplus">+                        &quot;msgArchivesAccountPicker&quot;,</span>
<a href="#l5.142"></a><span id="l5.142" class="difflineplus">+                        &quot;msgArchivesFolderPicker&quot;,</span>
<a href="#l5.143"></a><span id="l5.143" class="difflineplus">+                        &quot;identity.archiveFolder&quot;,</span>
<a href="#l5.144"></a><span id="l5.144" class="difflineplus">+                        &quot;identity.archivesFolderPickerMode&quot;);</span>
<a href="#l5.145"></a><span id="l5.145" class="difflineplus">+                        </span>
<a href="#l5.146"></a><span id="l5.146">     SaveFolderSettings( gTmplRadioElemChoice,</span>
<a href="#l5.147"></a><span id="l5.147">                         &quot;messageTemplates&quot;,</span>
<a href="#l5.148"></a><span id="l5.148">                         gTemplatesFolderWithDelim, </span>
<a href="#l5.149"></a><span id="l5.149">                         &quot;msgStationeryAccountPicker&quot;, </span>
<a href="#l5.150"></a><span id="l5.150">                         &quot;msgStationeryFolderPicker&quot;,</span>
<a href="#l5.151"></a><span id="l5.151">                         &quot;identity.stationeryFolder&quot;,</span>
<a href="#l5.152"></a><span id="l5.152">                         &quot;identity.tmplFolderPickerMode&quot; );</span>
<a href="#l5.153"></a><span id="l5.153"> }</span>
<a href="#l5.154"></a><span id="l5.154" class="difflineat">@@ -363,27 +388,34 @@ function setPickersState(enablePickerId,</span>
<a href="#l5.155"></a><span id="l5.155">     </span>
<a href="#l5.156"></a><span id="l5.156">     switch (event.target.id) {</span>
<a href="#l5.157"></a><span id="l5.157">         case &quot;fcc_selectAccount&quot; :</span>
<a href="#l5.158"></a><span id="l5.158">             gFccRadioElemChoice = radioElemValue;   </span>
<a href="#l5.159"></a><span id="l5.159">             break;</span>
<a href="#l5.160"></a><span id="l5.160">         case &quot;draft_selectAccount&quot; :</span>
<a href="#l5.161"></a><span id="l5.161">             gDraftsRadioElemChoice = radioElemValue;   </span>
<a href="#l5.162"></a><span id="l5.162">             break;</span>
<a href="#l5.163"></a><span id="l5.163" class="difflineplus">+        case &quot;archive_selectAccount&quot; :</span>
<a href="#l5.164"></a><span id="l5.164" class="difflineplus">+            gArchivesRadioElemChoice = radioElemValue;</span>
<a href="#l5.165"></a><span id="l5.165" class="difflineplus">+            break;</span>
<a href="#l5.166"></a><span id="l5.166">         case &quot;tmpl_selectAccount&quot; :</span>
<a href="#l5.167"></a><span id="l5.167">             gTmplRadioElemChoice = radioElemValue;   </span>
<a href="#l5.168"></a><span id="l5.168">             break;</span>
<a href="#l5.169"></a><span id="l5.169">         case &quot;fcc_selectFolder&quot; :</span>
<a href="#l5.170"></a><span id="l5.170">             gFccRadioElemChoice = radioElemValue;   </span>
<a href="#l5.171"></a><span id="l5.171">             selectedElementUri += gFccFolderWithDelim;</span>
<a href="#l5.172"></a><span id="l5.172">             break;</span>
<a href="#l5.173"></a><span id="l5.173">         case &quot;draft_selectFolder&quot; :</span>
<a href="#l5.174"></a><span id="l5.174">             gDraftsRadioElemChoice = radioElemValue;   </span>
<a href="#l5.175"></a><span id="l5.175">             selectedElementUri += gDraftsFolderWithDelim;</span>
<a href="#l5.176"></a><span id="l5.176">             break;</span>
<a href="#l5.177"></a><span id="l5.177" class="difflineplus">+        case &quot;archive_selectFolder&quot; :</span>
<a href="#l5.178"></a><span id="l5.178" class="difflineplus">+            gArchivesRadioElemChoice = radioElemValue;</span>
<a href="#l5.179"></a><span id="l5.179" class="difflineplus">+            selectedElementUri += gArchivesFolderWithDelim;</span>
<a href="#l5.180"></a><span id="l5.180" class="difflineplus">+            break;</span>
<a href="#l5.181"></a><span id="l5.181">         case &quot;tmpl_selectFolder&quot; :</span>
<a href="#l5.182"></a><span id="l5.182">             gTmplRadioElemChoice = radioElemValue;   </span>
<a href="#l5.183"></a><span id="l5.183">             selectedElementUri += gTemplatesFolderWithDelim;</span>
<a href="#l5.184"></a><span id="l5.184">             break;</span>
<a href="#l5.185"></a><span id="l5.185">         default :</span>
<a href="#l5.186"></a><span id="l5.186">             dump(&quot;Error in setting picker state.\n&quot;);</span>
<a href="#l5.187"></a><span id="l5.187">             return;</span>
<a href="#l5.188"></a><span id="l5.188">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mailnews/base/prefs/resources/content/am-copiesOverlay.xul</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mailnews/base/prefs/resources/content/am-copiesOverlay.xul</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -61,26 +61,32 @@</span>
<a href="#l6.4"></a><span id="l6.4">     &lt;broadcaster id=&quot;broadcaster_doFcc&quot;/&gt;</span>
<a href="#l6.5"></a><span id="l6.5"> </span>
<a href="#l6.6"></a><span id="l6.6">     &lt;label hidden=&quot;true&quot; wsm_persist=&quot;true&quot; id=&quot;identity.fccFolder&quot;</span>
<a href="#l6.7"></a><span id="l6.7">                   pref=&quot;true&quot; preftype=&quot;string&quot; prefattribute=&quot;value&quot;</span>
<a href="#l6.8"></a><span id="l6.8">                   prefstring=&quot;mail.identity.%identitykey%.fcc_folder&quot;/&gt;</span>
<a href="#l6.9"></a><span id="l6.9">     &lt;label hidden=&quot;true&quot; wsm_persist=&quot;true&quot; id=&quot;identity.draftFolder&quot;</span>
<a href="#l6.10"></a><span id="l6.10">                   pref=&quot;true&quot; preftype=&quot;string&quot; prefattribute=&quot;value&quot;</span>
<a href="#l6.11"></a><span id="l6.11">                   prefstring=&quot;mail.identity.%identitykey%.draft_folder&quot;/&gt;</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+    &lt;label hidden=&quot;true&quot; wsm_persist=&quot;true&quot; id=&quot;identity.archiveFolder&quot;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+                  pref=&quot;true&quot; preftype=&quot;string&quot; prefattribute=&quot;value&quot;</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+                  prefstring=&quot;mail.identity.%identitykey%.archive_folder&quot;/&gt;</span>
<a href="#l6.15"></a><span id="l6.15">     &lt;label hidden=&quot;true&quot; wsm_persist=&quot;true&quot; id=&quot;identity.stationeryFolder&quot;</span>
<a href="#l6.16"></a><span id="l6.16">                   pref=&quot;true&quot; preftype=&quot;string&quot; prefattribute=&quot;value&quot;</span>
<a href="#l6.17"></a><span id="l6.17">                   prefstring=&quot;mail.identity.%identitykey%.stationary_folder&quot;/&gt;</span>
<a href="#l6.18"></a><span id="l6.18">     &lt;label hidden=&quot;true&quot; wsm_persist=&quot;true&quot; id=&quot;identity.email&quot;/&gt;</span>
<a href="#l6.19"></a><span id="l6.19">     &lt;label hidden=&quot;true&quot; wsm_persist=&quot;true&quot; id=&quot;identity.fccFolderPickerMode&quot;</span>
<a href="#l6.20"></a><span id="l6.20">                   pref=&quot;true&quot; preftype=&quot;int&quot; prefattribute=&quot;value&quot;</span>
<a href="#l6.21"></a><span id="l6.21">                   prefstring=&quot;mail.identity.%identitykey%.fcc_folder_picker_mode&quot;/&gt;</span>
<a href="#l6.22"></a><span id="l6.22">     &lt;label hidden=&quot;true&quot; wsm_persist=&quot;true&quot; id=&quot;identity.draftsFolderPickerMode&quot;</span>
<a href="#l6.23"></a><span id="l6.23">                   pref=&quot;true&quot; preftype=&quot;int&quot; prefattribute=&quot;value&quot;</span>
<a href="#l6.24"></a><span id="l6.24">                   prefstring=&quot;mail.identity.%identitykey%.drafts_folder_picker_mode&quot;/&gt;</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineplus">+    &lt;label hidden=&quot;true&quot; wsm_persist=&quot;true&quot; id=&quot;identity.archivesFolderPickerMode&quot;</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineplus">+                  pref=&quot;true&quot; preftype=&quot;int&quot; prefattribute=&quot;value&quot;</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineplus">+                  prefstring=&quot;mail.identity.%identitykey%.archives_folder_picker_mode&quot;/&gt;</span>
<a href="#l6.28"></a><span id="l6.28">     &lt;label hidden=&quot;true&quot; wsm_persist=&quot;true&quot; id=&quot;identity.tmplFolderPickerMode&quot;</span>
<a href="#l6.29"></a><span id="l6.29">                   pref=&quot;true&quot; preftype=&quot;int&quot; prefattribute=&quot;value&quot;</span>
<a href="#l6.30"></a><span id="l6.30">                   prefstring=&quot;mail.identity.%identitykey%.tmpl_folder_picker_mode&quot;/&gt; </span>
<a href="#l6.31"></a><span id="l6.31">     &lt;groupbox&gt;</span>
<a href="#l6.32"></a><span id="l6.32">       &lt;caption label=&quot;&amp;sendingPrefix.label;&quot;/&gt;</span>
<a href="#l6.33"></a><span id="l6.33"> </span>
<a href="#l6.34"></a><span id="l6.34">       &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l6.35"></a><span id="l6.35">         &lt;checkbox wsm_persist=&quot;true&quot; id=&quot;identity.doFcc&quot; label=&quot;&amp;fccMailFolder.label;&quot; </span>
<a href="#l6.36"></a><span id="l6.36" class="difflineat">@@ -188,16 +194,56 @@</span>
<a href="#l6.37"></a><span id="l6.37">                 &lt;menupopup id=&quot;msgDraftFolderPopup&quot; type=&quot;folder&quot; mode=&quot;filing&quot;</span>
<a href="#l6.38"></a><span id="l6.38">                            showFileHereLabel=&quot;true&quot;</span>
<a href="#l6.39"></a><span id="l6.39">                            fileHereLabel=&quot;&amp;filemessageschoosethis.label;&quot;/&gt;</span>
<a href="#l6.40"></a><span id="l6.40">               &lt;/menulist&gt;</span>
<a href="#l6.41"></a><span id="l6.41">             &lt;/row&gt;</span>
<a href="#l6.42"></a><span id="l6.42">           &lt;/rows&gt;</span>
<a href="#l6.43"></a><span id="l6.43">         &lt;/grid&gt;</span>
<a href="#l6.44"></a><span id="l6.44">       &lt;/radiogroup&gt;</span>
<a href="#l6.45"></a><span id="l6.45" class="difflineplus">+</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineplus">+      &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineplus">+        &lt;label value=&quot;&amp;keepArchives.label;&quot; control=&quot;messageArchives&quot;/&gt;</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineplus">+      &lt;/hbox&gt;</span>
<a href="#l6.49"></a><span id="l6.49" class="difflineplus">+    </span>
<a href="#l6.50"></a><span id="l6.50" class="difflineplus">+      &lt;radiogroup id=&quot;messageArchives&quot;&gt;</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineplus">+        &lt;grid class=&quot;specialFolderPickerGrid&quot;&gt;</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineplus">+          &lt;columns&gt;</span>
<a href="#l6.53"></a><span id="l6.53" class="difflineplus">+            &lt;column/&gt;</span>
<a href="#l6.54"></a><span id="l6.54" class="difflineplus">+            &lt;column flex=&quot;1&quot;/&gt;</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineplus">+          &lt;/columns&gt;</span>
<a href="#l6.56"></a><span id="l6.56" class="difflineplus">+          &lt;rows&gt;</span>
<a href="#l6.57"></a><span id="l6.57" class="difflineplus">+            &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l6.58"></a><span id="l6.58" class="difflineplus">+              &lt;radio id=&quot;archive_selectAccount&quot;</span>
<a href="#l6.59"></a><span id="l6.59" class="difflineplus">+                     oncommand=&quot;setPickersState('msgArchivesAccountPicker', 'msgArchivesFolderPicker', event)&quot;</span>
<a href="#l6.60"></a><span id="l6.60" class="difflineplus">+                     value=&quot;0&quot; label=&quot;&amp;archivesFolderOn.label;&quot;</span>
<a href="#l6.61"></a><span id="l6.61" class="difflineplus">+                     accesskey=&quot;&amp;archivesFolderOn.accesskey;&quot;/&gt;</span>
<a href="#l6.62"></a><span id="l6.62" class="difflineplus">+                &lt;menulist id=&quot;msgArchivesAccountPicker&quot;</span>
<a href="#l6.63"></a><span id="l6.63" class="difflineplus">+	                aria-labelledby=&quot;archive_selectAccount&quot;&gt;</span>
<a href="#l6.64"></a><span id="l6.64" class="difflineplus">+                &lt;menupopup id=&quot;msgArchivesAccountPopup&quot; type=&quot;folder&quot; mode=&quot;filing&quot;</span>
<a href="#l6.65"></a><span id="l6.65" class="difflineplus">+                           expandFolders=&quot;false&quot;/&gt;</span>
<a href="#l6.66"></a><span id="l6.66" class="difflineplus">+              &lt;/menulist&gt;</span>
<a href="#l6.67"></a><span id="l6.67" class="difflineplus">+            &lt;/row&gt;</span>
<a href="#l6.68"></a><span id="l6.68" class="difflineplus">+            &lt;row align=&quot;center&quot;&gt;</span>
<a href="#l6.69"></a><span id="l6.69" class="difflineplus">+              &lt;radio id=&quot;archive_selectFolder&quot;</span>
<a href="#l6.70"></a><span id="l6.70" class="difflineplus">+                     oncommand=&quot;setPickersState('msgArchivesFolderPicker', 'msgArchivesAccountPicker', event)&quot;</span>
<a href="#l6.71"></a><span id="l6.71" class="difflineplus">+                     value=&quot;1&quot; label=&quot;&amp;archiveInOtherFolder.label;&quot;</span>
<a href="#l6.72"></a><span id="l6.72" class="difflineplus">+                     accesskey=&quot;&amp;archiveInOtherFolder.accesskey;&quot;/&gt;</span>
<a href="#l6.73"></a><span id="l6.73" class="difflineplus">+                &lt;menulist id=&quot;msgArchivesFolderPicker&quot;</span>
<a href="#l6.74"></a><span id="l6.74" class="difflineplus">+                        aria-labelledby=&quot;archive_selectFolder&quot;</span>
<a href="#l6.75"></a><span id="l6.75" class="difflineplus">+                        oncommand=&quot;noteSelectionChange('archive_selectFolder', event)&quot;&gt;</span>
<a href="#l6.76"></a><span id="l6.76" class="difflineplus">+                &lt;menupopup id=&quot;msgArchivesFolderPopup&quot; type=&quot;folder&quot; mode=&quot;filing&quot;</span>
<a href="#l6.77"></a><span id="l6.77" class="difflineplus">+                           showFileHereLabel=&quot;true&quot;</span>
<a href="#l6.78"></a><span id="l6.78" class="difflineplus">+                           fileHereLabel=&quot;&amp;filemessageschoosethis.label;&quot;/&gt;</span>
<a href="#l6.79"></a><span id="l6.79" class="difflineplus">+              &lt;/menulist&gt;</span>
<a href="#l6.80"></a><span id="l6.80" class="difflineplus">+            &lt;/row&gt;</span>
<a href="#l6.81"></a><span id="l6.81" class="difflineplus">+          &lt;/rows&gt;</span>
<a href="#l6.82"></a><span id="l6.82" class="difflineplus">+        &lt;/grid&gt;</span>
<a href="#l6.83"></a><span id="l6.83" class="difflineplus">+      &lt;/radiogroup&gt;</span>
<a href="#l6.84"></a><span id="l6.84" class="difflineplus">+      </span>
<a href="#l6.85"></a><span id="l6.85">       &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l6.86"></a><span id="l6.86">         &lt;label value=&quot;&amp;keepTempltes.label;&quot; control=&quot;messageTemplates&quot;/&gt;</span>
<a href="#l6.87"></a><span id="l6.87">       &lt;/hbox&gt;</span>
<a href="#l6.88"></a><span id="l6.88"> 	  </span>
<a href="#l6.89"></a><span id="l6.89">       &lt;radiogroup id=&quot;messageTemplates&quot;&gt;</span>
<a href="#l6.90"></a><span id="l6.90">         &lt;grid class=&quot;specialFolderPickerGrid&quot;&gt;</span>
<a href="#l6.91"></a><span id="l6.91">           &lt;columns&gt;</span>
<a href="#l6.92"></a><span id="l6.92">             &lt;column/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/base/public/nsIMsgIdentity.idl</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/base/public/nsIMsgIdentity.idl</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -44,17 +44,17 @@</span>
<a href="#l7.4"></a><span id="l7.4">  * for a given person.</span>
<a href="#l7.5"></a><span id="l7.5">  * each identity is identified by a key, which is the &lt;id&gt; string in</span>
<a href="#l7.6"></a><span id="l7.6">  * the identity preferences, such as in</span>
<a href="#l7.7"></a><span id="l7.7">  * mail.identity.&lt;id&gt;.replyTo</span>
<a href="#l7.8"></a><span id="l7.8">  *</span>
<a href="#l7.9"></a><span id="l7.9">  */</span>
<a href="#l7.10"></a><span id="l7.10"> </span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-[scriptable, uuid(3038bec6-2a5f-4eba-977d-4e037ae5aba3)]</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+[scriptable, uuid(ca17fc07-f842-4ea1-936c-3a2756f99531)]</span>
<a href="#l7.14"></a><span id="l7.14"> interface nsIMsgIdentity : nsISupports {</span>
<a href="#l7.15"></a><span id="l7.15">   /* internal preferences ID */</span>
<a href="#l7.16"></a><span id="l7.16">   attribute ACString key;</span>
<a href="#l7.17"></a><span id="l7.17"> </span>
<a href="#l7.18"></a><span id="l7.18">   /*</span>
<a href="#l7.19"></a><span id="l7.19">    *overriding display name for this identity. if this pref is not set</span>
<a href="#l7.20"></a><span id="l7.20">    * then this will return some composed string from the fullname and email</span>
<a href="#l7.21"></a><span id="l7.21">    */</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineat">@@ -92,35 +92,52 @@ interface nsIMsgIdentity : nsISupports {</span>
<a href="#l7.23"></a><span id="l7.23"> </span>
<a href="#l7.24"></a><span id="l7.24">   /* the current signature */</span>
<a href="#l7.25"></a><span id="l7.25">   attribute nsILocalFile signature;</span>
<a href="#l7.26"></a><span id="l7.26">   attribute long signatureDate;</span>
<a href="#l7.27"></a><span id="l7.27"> </span>
<a href="#l7.28"></a><span id="l7.28">   attribute ACString escapedVCard;</span>
<a href="#l7.29"></a><span id="l7.29"> </span>
<a href="#l7.30"></a><span id="l7.30">   attribute boolean doFcc;</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineplus">+  /// URI for the fcc (Sent) folder</span>
<a href="#l7.32"></a><span id="l7.32">   attribute ACString fccFolder;</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineminus">-</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineplus">+  attribute boolean fccReplyFollowsParent;</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineplus">+  </span>
<a href="#l7.36"></a><span id="l7.36" class="difflineplus">+  /**</span>
<a href="#l7.37"></a><span id="l7.37" class="difflineplus">+   * @{</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineplus">+   * these attributes control whether the special folder pickers for</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineplus">+   * fcc, drafts,archives, and templates are set to pick between servers</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineplus">+   * (e.g., Sent on accountName) or to pick any folder on any account.</span>
<a href="#l7.41"></a><span id="l7.41" class="difflineplus">+   * &quot;0&quot; means choose between servers; &quot;1&quot; means use the full folder picker.</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineplus">+   */</span>
<a href="#l7.43"></a><span id="l7.43">   attribute ACString fccFolderPickerMode;</span>
<a href="#l7.44"></a><span id="l7.44" class="difflineminus">-  attribute boolean fccReplyFollowsParent;</span>
<a href="#l7.45"></a><span id="l7.45">   attribute ACString draftsFolderPickerMode;</span>
<a href="#l7.46"></a><span id="l7.46" class="difflineminus">-  attribute ACString tmplFolderPickerMode;  </span>
<a href="#l7.47"></a><span id="l7.47" class="difflineplus">+  attribute ACString archivesFolderPickerMode;</span>
<a href="#l7.48"></a><span id="l7.48" class="difflineplus">+  attribute ACString tmplFolderPickerMode;</span>
<a href="#l7.49"></a><span id="l7.49" class="difflineplus">+  /** @} */</span>
<a href="#l7.50"></a><span id="l7.50"> </span>
<a href="#l7.51"></a><span id="l7.51">   // Don't call bccSelf, bccOthers, and bccList directly, they are </span>
<a href="#l7.52"></a><span id="l7.52">   // only used for migration and backward compatability. Use doBcc</span>
<a href="#l7.53"></a><span id="l7.53">   // and doBccList instead.</span>
<a href="#l7.54"></a><span id="l7.54">   attribute boolean bccSelf;</span>
<a href="#l7.55"></a><span id="l7.55">   attribute boolean bccOthers;</span>
<a href="#l7.56"></a><span id="l7.56">   attribute ACString bccList;</span>
<a href="#l7.57"></a><span id="l7.57"> </span>
<a href="#l7.58"></a><span id="l7.58">   attribute boolean doBcc;</span>
<a href="#l7.59"></a><span id="l7.59">   attribute ACString doBccList;</span>
<a href="#l7.60"></a><span id="l7.60"> </span>
<a href="#l7.61"></a><span id="l7.61" class="difflineplus">+  /**</span>
<a href="#l7.62"></a><span id="l7.62" class="difflineplus">+   * @{</span>
<a href="#l7.63"></a><span id="l7.63" class="difflineplus">+   * URIs for the special folders (drafts, templates, archive)</span>
<a href="#l7.64"></a><span id="l7.64" class="difflineplus">+   */</span>
<a href="#l7.65"></a><span id="l7.65">   attribute ACString draftFolder;</span>
<a href="#l7.66"></a><span id="l7.66" class="difflineplus">+  attribute ACString archiveFolder;</span>
<a href="#l7.67"></a><span id="l7.67">   attribute ACString stationeryFolder;</span>
<a href="#l7.68"></a><span id="l7.68" class="difflineplus">+  /** @} */</span>
<a href="#l7.69"></a><span id="l7.69" class="difflineplus">+  </span>
<a href="#l7.70"></a><span id="l7.70">   attribute boolean showSaveMsgDlg;</span>
<a href="#l7.71"></a><span id="l7.71">   attribute ACString directoryServer;</span>
<a href="#l7.72"></a><span id="l7.72">   attribute boolean overrideGlobalPref;</span>
<a href="#l7.73"></a><span id="l7.73">   /**</span>
<a href="#l7.74"></a><span id="l7.74">    * If this is false, don't append the user's domain</span>
<a href="#l7.75"></a><span id="l7.75">    * to an autocomplete address with no matches</span>
<a href="#l7.76"></a><span id="l7.76">    */</span>
<a href="#l7.77"></a><span id="l7.77">    attribute boolean autocompleteToMyDomain;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/base/public/nsMsgFolderFlags.idl</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/base/public/nsMsgFolderFlags.idl</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -93,18 +93,18 @@ interface nsMsgFolderFlags {</span>
<a href="#l8.4"></a><span id="l8.4">   /// Whether this is the folder in which unfinised, unsent messages are saved for later editing.</span>
<a href="#l8.5"></a><span id="l8.5">   const nsMsgFolderFlagType Drafts          = 0x00000400;</span>
<a href="#l8.6"></a><span id="l8.6">   /// Whether this is the folder in which messages are queued for later delivery.</span>
<a href="#l8.7"></a><span id="l8.7">   const nsMsgFolderFlagType Queue           = 0x00000800;</span>
<a href="#l8.8"></a><span id="l8.8">   /// Whether this is the primary inbox folder.</span>
<a href="#l8.9"></a><span id="l8.9">   const nsMsgFolderFlagType Inbox           = 0x00001000;</span>
<a href="#l8.10"></a><span id="l8.10">   /// Whether this folder on online IMAP</span>
<a href="#l8.11"></a><span id="l8.11">   const nsMsgFolderFlagType ImapBox         = 0x00002000;</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-  /// Used to be for category container</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineminus">-  const nsMsgFolderFlagType Unused3         = 0x00004000;</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+  /// Whether this is an archive folder</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineplus">+  const nsMsgFolderFlagType Archive         = 0x00004000;</span>
<a href="#l8.16"></a><span id="l8.16">   /// This is a virtual newsgroup</span>
<a href="#l8.17"></a><span id="l8.17">   const nsMsgFolderFlagType ProfileGroup    = 0x00008000;</span>
<a href="#l8.18"></a><span id="l8.18">   /// Used to be for categories</span>
<a href="#l8.19"></a><span id="l8.19">   const nsMsgFolderFlagType Unused4         = 0x00010000;</span>
<a href="#l8.20"></a><span id="l8.20">   /// This folder got new msgs</span>
<a href="#l8.21"></a><span id="l8.21">   const nsMsgFolderFlagType GotNew          = 0x00020000;</span>
<a href="#l8.22"></a><span id="l8.22">   /// This folder is an IMAP server</span>
<a href="#l8.23"></a><span id="l8.23">   const nsMsgFolderFlagType ImapServer      = 0x00040000;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/base/util/nsMsgDBFolder.cpp</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgDBFolder.cpp</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -136,16 +136,18 @@ nsICollation * nsMsgDBFolder::gCollation</span>
<a href="#l9.4"></a><span id="l9.4"> </span>
<a href="#l9.5"></a><span id="l9.5"> PRUnichar *nsMsgDBFolder::kLocalizedInboxName;</span>
<a href="#l9.6"></a><span id="l9.6"> PRUnichar *nsMsgDBFolder::kLocalizedTrashName;</span>
<a href="#l9.7"></a><span id="l9.7"> PRUnichar *nsMsgDBFolder::kLocalizedSentName;</span>
<a href="#l9.8"></a><span id="l9.8"> PRUnichar *nsMsgDBFolder::kLocalizedDraftsName;</span>
<a href="#l9.9"></a><span id="l9.9"> PRUnichar *nsMsgDBFolder::kLocalizedTemplatesName;</span>
<a href="#l9.10"></a><span id="l9.10"> PRUnichar *nsMsgDBFolder::kLocalizedUnsentName;</span>
<a href="#l9.11"></a><span id="l9.11"> PRUnichar *nsMsgDBFolder::kLocalizedJunkName;</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+PRUnichar *nsMsgDBFolder::kLocalizedArchivesName;</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+</span>
<a href="#l9.14"></a><span id="l9.14"> PRUnichar *nsMsgDBFolder::kLocalizedBrandShortName;</span>
<a href="#l9.15"></a><span id="l9.15"> </span>
<a href="#l9.16"></a><span id="l9.16"> nsrefcnt nsMsgDBFolder::mInstanceCount=0;</span>
<a href="#l9.17"></a><span id="l9.17"> </span>
<a href="#l9.18"></a><span id="l9.18"> NS_IMPL_ISUPPORTS_INHERITED4(nsMsgDBFolder, nsRDFResource, </span>
<a href="#l9.19"></a><span id="l9.19">                              nsISupportsWeakReference, nsIMsgFolder,</span>
<a href="#l9.20"></a><span id="l9.20">                              nsIDBChangeListener, nsIUrlListener)</span>
<a href="#l9.21"></a><span id="l9.21"> </span>
<a href="#l9.22"></a><span id="l9.22" class="difflineat">@@ -218,16 +220,17 @@ nsMsgDBFolder::~nsMsgDBFolder(void)</span>
<a href="#l9.23"></a><span id="l9.23">     NS_IF_RELEASE(gCollationKeyGenerator);</span>
<a href="#l9.24"></a><span id="l9.24">     NS_Free(kLocalizedInboxName);</span>
<a href="#l9.25"></a><span id="l9.25">     NS_Free(kLocalizedTrashName);</span>
<a href="#l9.26"></a><span id="l9.26">     NS_Free(kLocalizedSentName);</span>
<a href="#l9.27"></a><span id="l9.27">     NS_Free(kLocalizedDraftsName);</span>
<a href="#l9.28"></a><span id="l9.28">     NS_Free(kLocalizedTemplatesName);</span>
<a href="#l9.29"></a><span id="l9.29">     NS_Free(kLocalizedUnsentName);</span>
<a href="#l9.30"></a><span id="l9.30">     NS_Free(kLocalizedJunkName);</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineplus">+    NS_Free(kLocalizedArchivesName);</span>
<a href="#l9.32"></a><span id="l9.32">     NS_Free(kLocalizedBrandShortName);</span>
<a href="#l9.33"></a><span id="l9.33"> #ifdef MSG_FASTER_URI_PARSING</span>
<a href="#l9.34"></a><span id="l9.34">     mParsingURL = nsnull;</span>
<a href="#l9.35"></a><span id="l9.35"> #endif</span>
<a href="#l9.36"></a><span id="l9.36">   }</span>
<a href="#l9.37"></a><span id="l9.37">   //shutdown but don't shutdown children.</span>
<a href="#l9.38"></a><span id="l9.38">   Shutdown(PR_FALSE);</span>
<a href="#l9.39"></a><span id="l9.39"> }</span>
<a href="#l9.40"></a><span id="l9.40" class="difflineat">@@ -2333,16 +2336,18 @@ nsMsgDBFolder::initializeStrings()</span>
<a href="#l9.41"></a><span id="l9.41">   bundle-&gt;GetStringFromName(NS_LITERAL_STRING(&quot;draftsFolderName&quot;).get(),</span>
<a href="#l9.42"></a><span id="l9.42">                             &amp;kLocalizedDraftsName);</span>
<a href="#l9.43"></a><span id="l9.43">   bundle-&gt;GetStringFromName(NS_LITERAL_STRING(&quot;templatesFolderName&quot;).get(),</span>
<a href="#l9.44"></a><span id="l9.44">                             &amp;kLocalizedTemplatesName);</span>
<a href="#l9.45"></a><span id="l9.45">   bundle-&gt;GetStringFromName(NS_LITERAL_STRING(&quot;junkFolderName&quot;).get(),</span>
<a href="#l9.46"></a><span id="l9.46">                             &amp;kLocalizedJunkName);</span>
<a href="#l9.47"></a><span id="l9.47">   bundle-&gt;GetStringFromName(NS_LITERAL_STRING(&quot;outboxFolderName&quot;).get(),</span>
<a href="#l9.48"></a><span id="l9.48">                             &amp;kLocalizedUnsentName);</span>
<a href="#l9.49"></a><span id="l9.49" class="difflineplus">+  bundle-&gt;GetStringFromName(NS_LITERAL_STRING(&quot;archivesFolderName&quot;).get(),</span>
<a href="#l9.50"></a><span id="l9.50" class="difflineplus">+                            &amp;kLocalizedArchivesName);</span>
<a href="#l9.51"></a><span id="l9.51"> </span>
<a href="#l9.52"></a><span id="l9.52">   nsCOMPtr&lt;nsIStringBundle&gt; brandBundle;</span>
<a href="#l9.53"></a><span id="l9.53">   rv = bundleService-&gt;CreateBundle(&quot;chrome://branding/locale/brand.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l9.54"></a><span id="l9.54">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l9.55"></a><span id="l9.55">   bundle-&gt;GetStringFromName(NS_LITERAL_STRING(&quot;brandShortName&quot;).get(),</span>
<a href="#l9.56"></a><span id="l9.56">                             &amp;kLocalizedBrandShortName);</span>
<a href="#l9.57"></a><span id="l9.57">   return NS_OK;</span>
<a href="#l9.58"></a><span id="l9.58"> }</span>
<a href="#l9.59"></a><span id="l9.59" class="difflineat">@@ -2782,31 +2787,32 @@ nsMsgDBFolder::GetCanRename(PRBool *aRes</span>
<a href="#l9.60"></a><span id="l9.60"> </span>
<a href="#l9.61"></a><span id="l9.61">   PRBool isServer = PR_FALSE;</span>
<a href="#l9.62"></a><span id="l9.62">   nsresult rv = GetIsServer(&amp;isServer);</span>
<a href="#l9.63"></a><span id="l9.63">   if (NS_FAILED(rv)) return rv;</span>
<a href="#l9.64"></a><span id="l9.64">   // by default, you can't rename servers, only folders</span>
<a href="#l9.65"></a><span id="l9.65">   // if otherwise, override it.</span>
<a href="#l9.66"></a><span id="l9.66">   //</span>
<a href="#l9.67"></a><span id="l9.67">   // check if the folder is a special folder</span>
<a href="#l9.68"></a><span id="l9.68" class="difflineminus">-  // (Trash, Drafts, Unsent Messages, Inbox, Sent, Templates, Junk)</span>
<a href="#l9.69"></a><span id="l9.69" class="difflineplus">+  // (Trash, Drafts, Unsent Messages, Inbox, Sent, Templates, Junk, Archives)</span>
<a href="#l9.70"></a><span id="l9.70">   // if it is, don't allow the user to rename it</span>
<a href="#l9.71"></a><span id="l9.71">   // (which includes dnd moving it with in the same server)</span>
<a href="#l9.72"></a><span id="l9.72">   //</span>
<a href="#l9.73"></a><span id="l9.73">   // this errors on the side of caution.  we'll return false a lot</span>
<a href="#l9.74"></a><span id="l9.74">   // more often if we use flags,</span>
<a href="#l9.75"></a><span id="l9.75">   // instead of checking if the folder really is being used as a</span>
<a href="#l9.76"></a><span id="l9.76">   // special folder by looking at the &quot;copies and folders&quot; prefs on the</span>
<a href="#l9.77"></a><span id="l9.77">   // identities.</span>
<a href="#l9.78"></a><span id="l9.78">   *aResult = !(isServer || (mFlags &amp; nsMsgFolderFlags::Trash ||</span>
<a href="#l9.79"></a><span id="l9.79">            mFlags &amp; nsMsgFolderFlags::Drafts ||</span>
<a href="#l9.80"></a><span id="l9.80">            mFlags &amp; nsMsgFolderFlags::Queue ||</span>
<a href="#l9.81"></a><span id="l9.81">            mFlags &amp; nsMsgFolderFlags::Inbox ||</span>
<a href="#l9.82"></a><span id="l9.82">            mFlags &amp; nsMsgFolderFlags::SentMail ||</span>
<a href="#l9.83"></a><span id="l9.83">            mFlags &amp; nsMsgFolderFlags::Templates ||</span>
<a href="#l9.84"></a><span id="l9.84" class="difflineplus">+           mFlags &amp; nsMsgFolderFlags::Archive ||</span>
<a href="#l9.85"></a><span id="l9.85">            mFlags &amp; nsMsgFolderFlags::Junk));</span>
<a href="#l9.86"></a><span id="l9.86">   return NS_OK;</span>
<a href="#l9.87"></a><span id="l9.87"> }</span>
<a href="#l9.88"></a><span id="l9.88"> </span>
<a href="#l9.89"></a><span id="l9.89"> NS_IMETHODIMP</span>
<a href="#l9.90"></a><span id="l9.90"> nsMsgDBFolder::GetCanCompact(PRBool *aResult)</span>
<a href="#l9.91"></a><span id="l9.91"> {</span>
<a href="#l9.92"></a><span id="l9.92">   NS_ENSURE_ARG_POINTER(aResult);</span>
<a href="#l9.93"></a><span id="l9.93" class="difflineat">@@ -2839,16 +2845,18 @@ NS_IMETHODIMP nsMsgDBFolder::SetPrettyNa</span>
<a href="#l9.94"></a><span id="l9.94">   else if (mFlags &amp; nsMsgFolderFlags::Templates &amp;&amp; name.LowerCaseEqualsLiteral(&quot;templates&quot;))</span>
<a href="#l9.95"></a><span id="l9.95">     rv = SetName(nsDependentString(kLocalizedTemplatesName));</span>
<a href="#l9.96"></a><span id="l9.96">   else if (mFlags &amp; nsMsgFolderFlags::Trash &amp;&amp; name.LowerCaseEqualsLiteral(&quot;trash&quot;))</span>
<a href="#l9.97"></a><span id="l9.97">     rv = SetName(nsDependentString(kLocalizedTrashName));</span>
<a href="#l9.98"></a><span id="l9.98">   else if (mFlags &amp; nsMsgFolderFlags::Queue &amp;&amp; name.LowerCaseEqualsLiteral(&quot;unsent messages&quot;))</span>
<a href="#l9.99"></a><span id="l9.99">     rv = SetName(nsDependentString(kLocalizedUnsentName));</span>
<a href="#l9.100"></a><span id="l9.100">   else if (mFlags &amp; nsMsgFolderFlags::Junk &amp;&amp; name.LowerCaseEqualsLiteral(&quot;junk&quot;))</span>
<a href="#l9.101"></a><span id="l9.101">     rv = SetName(nsDependentString(kLocalizedJunkName));</span>
<a href="#l9.102"></a><span id="l9.102" class="difflineplus">+  else if (mFlags &amp; nsMsgFolderFlags::Archive &amp;&amp; name.LowerCaseEqualsLiteral(&quot;archives&quot;))</span>
<a href="#l9.103"></a><span id="l9.103" class="difflineplus">+    rv = SetName(nsDependentString(kLocalizedArchivesName));</span>
<a href="#l9.104"></a><span id="l9.104">   else</span>
<a href="#l9.105"></a><span id="l9.105">     rv = SetName(name);</span>
<a href="#l9.106"></a><span id="l9.106">   return rv;</span>
<a href="#l9.107"></a><span id="l9.107"> }</span>
<a href="#l9.108"></a><span id="l9.108"> </span>
<a href="#l9.109"></a><span id="l9.109"> NS_IMETHODIMP nsMsgDBFolder::GetName(nsAString&amp; name)</span>
<a href="#l9.110"></a><span id="l9.110"> {</span>
<a href="#l9.111"></a><span id="l9.111">   nsresult rv;</span>
<a href="#l9.112"></a><span id="l9.112" class="difflineat">@@ -3144,31 +3152,35 @@ NS_IMETHODIMP nsMsgDBFolder::AddSubfolde</span>
<a href="#l9.113"></a><span id="l9.113">     else if (escapedName.LowerCaseEqualsLiteral(&quot;drafts&quot;))</span>
<a href="#l9.114"></a><span id="l9.114">       uri += &quot;Drafts&quot;;</span>
<a href="#l9.115"></a><span id="l9.115">     else if (escapedName.LowerCaseEqualsLiteral(&quot;trash&quot;))</span>
<a href="#l9.116"></a><span id="l9.116">       uri += &quot;Trash&quot;;</span>
<a href="#l9.117"></a><span id="l9.117">     else if (escapedName.LowerCaseEqualsLiteral(&quot;sent&quot;))</span>
<a href="#l9.118"></a><span id="l9.118">       uri += &quot;Sent&quot;;</span>
<a href="#l9.119"></a><span id="l9.119">     else if (escapedName.LowerCaseEqualsLiteral(&quot;templates&quot;))</span>
<a href="#l9.120"></a><span id="l9.120">       uri +=&quot;Templates&quot;;</span>
<a href="#l9.121"></a><span id="l9.121" class="difflineplus">+    else if (escapedName.LowerCaseEqualsLiteral(&quot;archives&quot;))</span>
<a href="#l9.122"></a><span id="l9.122" class="difflineplus">+      uri += &quot;Archives&quot;;</span>
<a href="#l9.123"></a><span id="l9.123">     else</span>
<a href="#l9.124"></a><span id="l9.124">       uri += escapedName.get();</span>
<a href="#l9.125"></a><span id="l9.125"> #else</span>
<a href="#l9.126"></a><span id="l9.126">     if (escapedName.Equals(&quot;inbox&quot;, CaseInsensitiveCompare))</span>
<a href="#l9.127"></a><span id="l9.127">       uri += &quot;Inbox&quot;;</span>
<a href="#l9.128"></a><span id="l9.128">     else if (escapedName.Equals(&quot;unsent%20messages&quot;, CaseInsensitiveCompare))</span>
<a href="#l9.129"></a><span id="l9.129">       uri += &quot;Unsent%20Messages&quot;;</span>
<a href="#l9.130"></a><span id="l9.130">     else if (escapedName.Equals(&quot;drafts&quot;, CaseInsensitiveCompare))</span>
<a href="#l9.131"></a><span id="l9.131">       uri += &quot;Drafts&quot;;</span>
<a href="#l9.132"></a><span id="l9.132">     else if (escapedName.Equals(&quot;trash&quot;, CaseInsensitiveCompare))</span>
<a href="#l9.133"></a><span id="l9.133">       uri += &quot;Trash&quot;;</span>
<a href="#l9.134"></a><span id="l9.134">     else if (escapedName.Equals(&quot;sent&quot;, CaseInsensitiveCompare))</span>
<a href="#l9.135"></a><span id="l9.135">       uri += &quot;Sent&quot;;</span>
<a href="#l9.136"></a><span id="l9.136">     else if (escapedName.Equals(&quot;templates&quot;, CaseInsensitiveCompare))</span>
<a href="#l9.137"></a><span id="l9.137">       uri +=&quot;Templates&quot;;</span>
<a href="#l9.138"></a><span id="l9.138" class="difflineplus">+    else if (escapedName.Equals(&quot;archives&quot;, CaseInsensitiveCompare))</span>
<a href="#l9.139"></a><span id="l9.139" class="difflineplus">+      uri +=&quot;Archives&quot;;</span>
<a href="#l9.140"></a><span id="l9.140">     else</span>
<a href="#l9.141"></a><span id="l9.141">       uri += escapedName.get();</span>
<a href="#l9.142"></a><span id="l9.142"> #endif</span>
<a href="#l9.143"></a><span id="l9.143">   }</span>
<a href="#l9.144"></a><span id="l9.144">   else</span>
<a href="#l9.145"></a><span id="l9.145">     uri += escapedName.get();</span>
<a href="#l9.146"></a><span id="l9.146"> </span>
<a href="#l9.147"></a><span id="l9.147">   nsCOMPtr &lt;nsIMsgFolder&gt; msgFolder;</span>
<a href="#l9.148"></a><span id="l9.148" class="difflineat">@@ -3737,16 +3749,23 @@ NS_IMETHODIMP nsMsgDBFolder::SetPrefFlag</span>
<a href="#l9.149"></a><span id="l9.149">     }</span>
<a href="#l9.150"></a><span id="l9.150">     identity-&gt;GetDraftFolder(folderUri);</span>
<a href="#l9.151"></a><span id="l9.151">     if (!folderUri.IsEmpty() &amp;&amp; NS_SUCCEEDED(rdf-&gt;GetResource(folderUri, getter_AddRefs(res))))</span>
<a href="#l9.152"></a><span id="l9.152">     {</span>
<a href="#l9.153"></a><span id="l9.153">       folder = do_QueryInterface(res, &amp;rv);</span>
<a href="#l9.154"></a><span id="l9.154">       if (NS_SUCCEEDED(rv))</span>
<a href="#l9.155"></a><span id="l9.155">         rv = folder-&gt;SetFlag(nsMsgFolderFlags::Drafts);</span>
<a href="#l9.156"></a><span id="l9.156">     }</span>
<a href="#l9.157"></a><span id="l9.157" class="difflineplus">+    identity-&gt;GetArchiveFolder(folderUri);</span>
<a href="#l9.158"></a><span id="l9.158" class="difflineplus">+    if (!folderUri.IsEmpty() &amp;&amp; NS_SUCCEEDED(rdf-&gt;GetResource(folderUri, getter_AddRefs(res))))</span>
<a href="#l9.159"></a><span id="l9.159" class="difflineplus">+    {</span>
<a href="#l9.160"></a><span id="l9.160" class="difflineplus">+      folder = do_QueryInterface(res, &amp;rv);</span>
<a href="#l9.161"></a><span id="l9.161" class="difflineplus">+      if (NS_SUCCEEDED(rv))</span>
<a href="#l9.162"></a><span id="l9.162" class="difflineplus">+        rv = folder-&gt;SetFlag(nsMsgFolderFlags::Archive);</span>
<a href="#l9.163"></a><span id="l9.163" class="difflineplus">+    }</span>
<a href="#l9.164"></a><span id="l9.164">     identity-&gt;GetStationeryFolder(folderUri);</span>
<a href="#l9.165"></a><span id="l9.165">     if (!folderUri.IsEmpty() &amp;&amp; NS_SUCCEEDED(rdf-&gt;GetResource(folderUri, getter_AddRefs(res))))</span>
<a href="#l9.166"></a><span id="l9.166">     {</span>
<a href="#l9.167"></a><span id="l9.167">       folder = do_QueryInterface(res, &amp;rv);</span>
<a href="#l9.168"></a><span id="l9.168">       if (NS_SUCCEEDED(rv))</span>
<a href="#l9.169"></a><span id="l9.169">         rv = folder-&gt;SetFlag(nsMsgFolderFlags::Templates);</span>
<a href="#l9.170"></a><span id="l9.170">     }</span>
<a href="#l9.171"></a><span id="l9.171">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/base/util/nsMsgDBFolder.h</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgDBFolder.h</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -249,16 +249,18 @@ protected:</span>
<a href="#l10.4"></a><span id="l10.4"> </span>
<a href="#l10.5"></a><span id="l10.5">   static NS_MSG_BASE_STATIC_MEMBER_(PRUnichar*) kLocalizedInboxName;</span>
<a href="#l10.6"></a><span id="l10.6">   static NS_MSG_BASE_STATIC_MEMBER_(PRUnichar*) kLocalizedTrashName;</span>
<a href="#l10.7"></a><span id="l10.7">   static NS_MSG_BASE_STATIC_MEMBER_(PRUnichar*) kLocalizedSentName;</span>
<a href="#l10.8"></a><span id="l10.8">   static NS_MSG_BASE_STATIC_MEMBER_(PRUnichar*) kLocalizedDraftsName;</span>
<a href="#l10.9"></a><span id="l10.9">   static NS_MSG_BASE_STATIC_MEMBER_(PRUnichar*) kLocalizedTemplatesName;</span>
<a href="#l10.10"></a><span id="l10.10">   static NS_MSG_BASE_STATIC_MEMBER_(PRUnichar*) kLocalizedUnsentName;</span>
<a href="#l10.11"></a><span id="l10.11">   static NS_MSG_BASE_STATIC_MEMBER_(PRUnichar*) kLocalizedJunkName;</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineplus">+  static NS_MSG_BASE_STATIC_MEMBER_(PRUnichar*) kLocalizedArchivesName;</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+</span>
<a href="#l10.14"></a><span id="l10.14">   static NS_MSG_BASE_STATIC_MEMBER_(PRUnichar*) kLocalizedBrandShortName;</span>
<a href="#l10.15"></a><span id="l10.15">   </span>
<a href="#l10.16"></a><span id="l10.16">   static NS_MSG_BASE_STATIC_MEMBER_(nsIAtom*) kTotalUnreadMessagesAtom;</span>
<a href="#l10.17"></a><span id="l10.17">   static NS_MSG_BASE_STATIC_MEMBER_(nsIAtom*) kBiffStateAtom;</span>
<a href="#l10.18"></a><span id="l10.18">   static NS_MSG_BASE_STATIC_MEMBER_(nsIAtom*) kNewMailReceivedAtom;</span>
<a href="#l10.19"></a><span id="l10.19">   static NS_MSG_BASE_STATIC_MEMBER_(nsIAtom*) kNewMessagesAtom;</span>
<a href="#l10.20"></a><span id="l10.20">   static NS_MSG_BASE_STATIC_MEMBER_(nsIAtom*) kInVFEditSearchScopeAtom;</span>
<a href="#l10.21"></a><span id="l10.21">   static NS_MSG_BASE_STATIC_MEMBER_(nsIAtom*) kNumNewBiffMessagesAtom;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/base/util/nsMsgIdentity.cpp</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgIdentity.cpp</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -178,20 +178,21 @@ NS_IMPL_IDPREF_BOOL(AttachSignature, &quot;at</span>
<a href="#l11.4"></a><span id="l11.4"> NS_IMPL_IDPREF_BOOL(AutoQuote, &quot;auto_quote&quot;)</span>
<a href="#l11.5"></a><span id="l11.5"> NS_IMPL_IDPREF_INT(ReplyOnTop, &quot;reply_on_top&quot;)</span>
<a href="#l11.6"></a><span id="l11.6"> NS_IMPL_IDPREF_BOOL(SigBottom, &quot;sig_bottom&quot;)</span>
<a href="#l11.7"></a><span id="l11.7"> </span>
<a href="#l11.8"></a><span id="l11.8"> NS_IMPL_IDPREF_INT(SignatureDate,&quot;sig_date&quot;)</span>
<a href="#l11.9"></a><span id="l11.9"> </span>
<a href="#l11.10"></a><span id="l11.10"> NS_IMPL_IDPREF_BOOL(DoFcc, &quot;fcc&quot;)</span>
<a href="#l11.11"></a><span id="l11.11"> </span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-NS_IMPL_FOLDERPREF_STR(FccFolder, &quot;fcc_folder&quot;, nsMsgFolderFlags::SentMail)</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+NS_IMPL_FOLDERPREF_STR(FccFolder, &quot;fcc_folder&quot;, &quot;Sent&quot;, nsMsgFolderFlags::SentMail)</span>
<a href="#l11.14"></a><span id="l11.14"> NS_IMPL_IDPREF_STR(FccFolderPickerMode, &quot;fcc_folder_picker_mode&quot;)</span>
<a href="#l11.15"></a><span id="l11.15"> NS_IMPL_IDPREF_BOOL(FccReplyFollowsParent, &quot;fcc_reply_follows_parent&quot;)</span>
<a href="#l11.16"></a><span id="l11.16"> NS_IMPL_IDPREF_STR(DraftsFolderPickerMode, &quot;drafts_folder_picker_mode&quot;)</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineplus">+NS_IMPL_IDPREF_STR(ArchivesFolderPickerMode, &quot;archives_folder_picker_mode&quot;)</span>
<a href="#l11.18"></a><span id="l11.18"> NS_IMPL_IDPREF_STR(TmplFolderPickerMode, &quot;tmpl_folder_picker_mode&quot;)</span>
<a href="#l11.19"></a><span id="l11.19"> </span>
<a href="#l11.20"></a><span id="l11.20"> NS_IMPL_IDPREF_BOOL(BccSelf, &quot;bcc_self&quot;)</span>
<a href="#l11.21"></a><span id="l11.21"> NS_IMPL_IDPREF_BOOL(BccOthers, &quot;bcc_other&quot;)</span>
<a href="#l11.22"></a><span id="l11.22"> NS_IMPL_IDPREF_STR (BccList, &quot;bcc_other_list&quot;)</span>
<a href="#l11.23"></a><span id="l11.23"> </span>
<a href="#l11.24"></a><span id="l11.24"> NS_IMETHODIMP</span>
<a href="#l11.25"></a><span id="l11.25"> nsMsgIdentity::GetDoBcc(PRBool *aValue)</span>
<a href="#l11.26"></a><span id="l11.26" class="difflineat">@@ -254,28 +255,30 @@ nsMsgIdentity::GetDoBccList(nsACString&amp; </span>
<a href="#l11.27"></a><span id="l11.27"> }</span>
<a href="#l11.28"></a><span id="l11.28"> </span>
<a href="#l11.29"></a><span id="l11.29"> NS_IMETHODIMP</span>
<a href="#l11.30"></a><span id="l11.30"> nsMsgIdentity::SetDoBccList(const nsACString&amp; aValue)</span>
<a href="#l11.31"></a><span id="l11.31"> {</span>
<a href="#l11.32"></a><span id="l11.32">   return SetCharAttribute(&quot;doBccList&quot;, aValue);</span>
<a href="#l11.33"></a><span id="l11.33"> }</span>
<a href="#l11.34"></a><span id="l11.34"> </span>
<a href="#l11.35"></a><span id="l11.35" class="difflineminus">-NS_IMPL_FOLDERPREF_STR(DraftFolder, &quot;draft_folder&quot;, nsMsgFolderFlags::Drafts)</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineminus">-NS_IMPL_FOLDERPREF_STR(StationeryFolder, &quot;stationery_folder&quot;, nsMsgFolderFlags::Templates)</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineplus">+NS_IMPL_FOLDERPREF_STR(DraftFolder, &quot;draft_folder&quot;, &quot;Drafts&quot;, nsMsgFolderFlags::Drafts)</span>
<a href="#l11.38"></a><span id="l11.38" class="difflineplus">+NS_IMPL_FOLDERPREF_STR(ArchiveFolder, &quot;archive_folder&quot;, &quot;Archives&quot;, nsMsgFolderFlags::Archive)</span>
<a href="#l11.39"></a><span id="l11.39" class="difflineplus">+NS_IMPL_FOLDERPREF_STR(StationeryFolder, &quot;stationery_folder&quot;, &quot;Templates&quot;, nsMsgFolderFlags::Templates)</span>
<a href="#l11.40"></a><span id="l11.40"> </span>
<a href="#l11.41"></a><span id="l11.41"> NS_IMPL_IDPREF_BOOL(ShowSaveMsgDlg, &quot;showSaveMsgDlg&quot;)</span>
<a href="#l11.42"></a><span id="l11.42"> NS_IMPL_IDPREF_STR (DirectoryServer, &quot;directoryServer&quot;)</span>
<a href="#l11.43"></a><span id="l11.43"> NS_IMPL_IDPREF_BOOL(OverrideGlobalPref, &quot;overrideGlobal_Pref&quot;)</span>
<a href="#l11.44"></a><span id="l11.44"> NS_IMPL_IDPREF_BOOL(AutocompleteToMyDomain, &quot;autocompleteToMyDomain&quot;)</span>
<a href="#l11.45"></a><span id="l11.45"> </span>
<a href="#l11.46"></a><span id="l11.46"> NS_IMPL_IDPREF_BOOL(Valid, &quot;valid&quot;)</span>
<a href="#l11.47"></a><span id="l11.47"> </span>
<a href="#l11.48"></a><span id="l11.48"> nsresult</span>
<a href="#l11.49"></a><span id="l11.49" class="difflineminus">-nsMsgIdentity::getFolderPref(const char *prefname, nsCString&amp; retval, PRUint32 folderflag)</span>
<a href="#l11.50"></a><span id="l11.50" class="difflineplus">+nsMsgIdentity::getFolderPref(const char *prefname, nsCString&amp; retval,</span>
<a href="#l11.51"></a><span id="l11.51" class="difflineplus">+                             const char *folderName, PRUint32 folderflag)</span>
<a href="#l11.52"></a><span id="l11.52"> {</span>
<a href="#l11.53"></a><span id="l11.53">   nsresult rv = mPrefBranch-&gt;GetCharPref(prefname, getter_Copies(retval));</span>
<a href="#l11.54"></a><span id="l11.54">   if (NS_SUCCEEDED(rv) &amp;&amp; !retval.IsEmpty()) {</span>
<a href="#l11.55"></a><span id="l11.55">     // get the corresponding RDF resource</span>
<a href="#l11.56"></a><span id="l11.56">     // RDF will create the folder resource if it doesn't already exist</span>
<a href="#l11.57"></a><span id="l11.57">     nsCOMPtr&lt;nsIRDFService&gt; rdf(do_GetService(kRDFServiceCID, &amp;rv));</span>
<a href="#l11.58"></a><span id="l11.58">     if (NS_FAILED(rv)) return rv;</span>
<a href="#l11.59"></a><span id="l11.59">     nsCOMPtr&lt;nsIRDFResource&gt; resource;</span>
<a href="#l11.60"></a><span id="l11.60" class="difflineat">@@ -295,18 +298,47 @@ nsMsgIdentity::getFolderPref(const char </span>
<a href="#l11.61"></a><span id="l11.61">         return NS_SUCCEEDED(rv) ? msgFolder-&gt;GetURI(retval) : rv;</span>
<a href="#l11.62"></a><span id="l11.62">       }</span>
<a href="#l11.63"></a><span id="l11.63">     }</span>
<a href="#l11.64"></a><span id="l11.64">   }</span>
<a href="#l11.65"></a><span id="l11.65"> </span>
<a href="#l11.66"></a><span id="l11.66">   // if the server doesn't exist, fall back to the default pref.</span>
<a href="#l11.67"></a><span id="l11.67">   rv = mDefPrefBranch-&gt;GetCharPref(prefname, getter_Copies(retval));</span>
<a href="#l11.68"></a><span id="l11.68">   if (NS_SUCCEEDED(rv) &amp;&amp; !retval.IsEmpty())</span>
<a href="#l11.69"></a><span id="l11.69" class="difflineminus">-    rv = setFolderPref(prefname, retval, folderflag);</span>
<a href="#l11.70"></a><span id="l11.70" class="difflineminus">-  return rv;</span>
<a href="#l11.71"></a><span id="l11.71" class="difflineplus">+    return setFolderPref(prefname, retval, folderflag);</span>
<a href="#l11.72"></a><span id="l11.72" class="difflineplus">+</span>
<a href="#l11.73"></a><span id="l11.73" class="difflineplus">+  // here I think we need to create a uri for the folder on the</span>
<a href="#l11.74"></a><span id="l11.74" class="difflineplus">+  // default server for this identity.</span>
<a href="#l11.75"></a><span id="l11.75" class="difflineplus">+  nsCOMPtr&lt;nsIMsgAccountManager&gt; accountManager =</span>
<a href="#l11.76"></a><span id="l11.76" class="difflineplus">+  do_GetService(NS_MSGACCOUNTMANAGER_CONTRACTID, &amp;rv);</span>
<a href="#l11.77"></a><span id="l11.77" class="difflineplus">+  NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l11.78"></a><span id="l11.78" class="difflineplus">+  </span>
<a href="#l11.79"></a><span id="l11.79" class="difflineplus">+  nsCOMPtr&lt;nsISupportsArray&gt; servers;</span>
<a href="#l11.80"></a><span id="l11.80" class="difflineplus">+  rv = accountManager-&gt;GetServersForIdentity(this, getter_AddRefs(servers));</span>
<a href="#l11.81"></a><span id="l11.81" class="difflineplus">+  NS_ENSURE_SUCCESS(rv,rv);</span>
<a href="#l11.82"></a><span id="l11.82" class="difflineplus">+  nsCOMPtr&lt;nsIMsgIncomingServer&gt; server(do_QueryElementAt(servers, 0, &amp;rv));</span>
<a href="#l11.83"></a><span id="l11.83" class="difflineplus">+  if (NS_SUCCEEDED(rv))</span>
<a href="#l11.84"></a><span id="l11.84" class="difflineplus">+  {</span>
<a href="#l11.85"></a><span id="l11.85" class="difflineplus">+    PRBool defaultToServer;</span>
<a href="#l11.86"></a><span id="l11.86" class="difflineplus">+    server-&gt;GetDefaultCopiesAndFoldersPrefsToServer(&amp;defaultToServer);</span>
<a href="#l11.87"></a><span id="l11.87" class="difflineplus">+    // if we should default to special folders on the server,</span>
<a href="#l11.88"></a><span id="l11.88" class="difflineplus">+    // use the local folders server</span>
<a href="#l11.89"></a><span id="l11.89" class="difflineplus">+    if (!defaultToServer)</span>
<a href="#l11.90"></a><span id="l11.90" class="difflineplus">+    {</span>
<a href="#l11.91"></a><span id="l11.91" class="difflineplus">+      rv = accountManager-&gt;GetLocalFoldersServer(getter_AddRefs(server));</span>
<a href="#l11.92"></a><span id="l11.92" class="difflineplus">+      NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l11.93"></a><span id="l11.93" class="difflineplus">+    }</span>
<a href="#l11.94"></a><span id="l11.94" class="difflineplus">+    rv = server-&gt;GetServerURI(retval);</span>
<a href="#l11.95"></a><span id="l11.95" class="difflineplus">+    NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l11.96"></a><span id="l11.96" class="difflineplus">+    retval.Append('/');</span>
<a href="#l11.97"></a><span id="l11.97" class="difflineplus">+    retval.Append(folderName);</span>
<a href="#l11.98"></a><span id="l11.98" class="difflineplus">+    return setFolderPref(prefname, retval, folderflag);</span>
<a href="#l11.99"></a><span id="l11.99" class="difflineplus">+  }</span>
<a href="#l11.100"></a><span id="l11.100" class="difflineplus">+  // if there are no servers for this identity, return generic failure.</span>
<a href="#l11.101"></a><span id="l11.101" class="difflineplus">+  return NS_ERROR_FAILURE;</span>
<a href="#l11.102"></a><span id="l11.102"> }</span>
<a href="#l11.103"></a><span id="l11.103"> </span>
<a href="#l11.104"></a><span id="l11.104"> nsresult</span>
<a href="#l11.105"></a><span id="l11.105"> nsMsgIdentity::setFolderPref(const char *prefname, const nsACString&amp; value, PRUint32 folderflag)</span>
<a href="#l11.106"></a><span id="l11.106"> {</span>
<a href="#l11.107"></a><span id="l11.107">   nsCString oldpref;</span>
<a href="#l11.108"></a><span id="l11.108">   nsresult rv;</span>
<a href="#l11.109"></a><span id="l11.109">   nsCOMPtr&lt;nsIRDFResource&gt; res;</span>
<a href="#l11.110"></a><span id="l11.110" class="difflineat">@@ -500,16 +532,17 @@ NS_IMETHODIMP</span>
<a href="#l11.111"></a><span id="l11.111"> nsMsgIdentity::Copy(nsIMsgIdentity *identity)</span>
<a href="#l11.112"></a><span id="l11.112"> {</span>
<a href="#l11.113"></a><span id="l11.113">     COPY_IDENTITY_BOOL_VALUE(identity,GetComposeHtml,SetComposeHtml)</span>
<a href="#l11.114"></a><span id="l11.114">     COPY_IDENTITY_STR_VALUE(identity,GetEmail,SetEmail)</span>
<a href="#l11.115"></a><span id="l11.115">     COPY_IDENTITY_STR_VALUE(identity,GetReplyTo,SetReplyTo)</span>
<a href="#l11.116"></a><span id="l11.116">     COPY_IDENTITY_WSTR_VALUE(identity,GetFullName,SetFullName)</span>
<a href="#l11.117"></a><span id="l11.117">     COPY_IDENTITY_WSTR_VALUE(identity,GetOrganization,SetOrganization)</span>
<a href="#l11.118"></a><span id="l11.118">     COPY_IDENTITY_STR_VALUE(identity,GetDraftFolder,SetDraftFolder)</span>
<a href="#l11.119"></a><span id="l11.119" class="difflineplus">+    COPY_IDENTITY_STR_VALUE(identity,GetArchiveFolder,SetArchiveFolder)</span>
<a href="#l11.120"></a><span id="l11.120">     COPY_IDENTITY_STR_VALUE(identity,GetFccFolder,SetFccFolder)</span>
<a href="#l11.121"></a><span id="l11.121">     COPY_IDENTITY_BOOL_VALUE(identity,GetFccReplyFollowsParent,</span>
<a href="#l11.122"></a><span id="l11.122">                              SetFccReplyFollowsParent)</span>
<a href="#l11.123"></a><span id="l11.123">     COPY_IDENTITY_STR_VALUE(identity,GetStationeryFolder,SetStationeryFolder)</span>
<a href="#l11.124"></a><span id="l11.124">     COPY_IDENTITY_BOOL_VALUE(identity,GetAttachSignature,SetAttachSignature)</span>
<a href="#l11.125"></a><span id="l11.125">     COPY_IDENTITY_FILE_VALUE(identity,GetSignature,SetSignature)</span>
<a href="#l11.126"></a><span id="l11.126">     COPY_IDENTITY_BOOL_VALUE(identity,GetAutoQuote,SetAutoQuote)</span>
<a href="#l11.127"></a><span id="l11.127">     COPY_IDENTITY_INT_VALUE(identity,GetReplyOnTop,SetReplyOnTop)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/base/util/nsMsgIdentity.h</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgIdentity.h</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -52,17 +52,17 @@ public:</span>
<a href="#l12.4"></a><span id="l12.4">   NS_DECL_NSIMSGIDENTITY</span>
<a href="#l12.5"></a><span id="l12.5">   </span>
<a href="#l12.6"></a><span id="l12.6"> private:</span>
<a href="#l12.7"></a><span id="l12.7">   nsCString mKey;</span>
<a href="#l12.8"></a><span id="l12.8">   nsCOMPtr&lt;nsIPrefBranch&gt; mPrefBranch;</span>
<a href="#l12.9"></a><span id="l12.9">   nsCOMPtr&lt;nsIPrefBranch&gt; mDefPrefBranch;</span>
<a href="#l12.10"></a><span id="l12.10"> </span>
<a href="#l12.11"></a><span id="l12.11"> protected:</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  nsresult getFolderPref(const char *pref, nsCString&amp;, PRUint32);</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+  nsresult getFolderPref(const char *pref, nsCString&amp;, const char *, PRUint32);</span>
<a href="#l12.14"></a><span id="l12.14">   nsresult setFolderPref(const char *pref, const nsACString&amp;, PRUint32);</span>
<a href="#l12.15"></a><span id="l12.15"> };</span>
<a href="#l12.16"></a><span id="l12.16"> </span>
<a href="#l12.17"></a><span id="l12.17"> </span>
<a href="#l12.18"></a><span id="l12.18"> #define NS_IMPL_IDPREF_STR(_postfix, _prefname)       \</span>
<a href="#l12.19"></a><span id="l12.19"> NS_IMETHODIMP                                         \</span>
<a href="#l12.20"></a><span id="l12.20"> nsMsgIdentity::Get##_postfix(nsACString&amp; retval)      \</span>
<a href="#l12.21"></a><span id="l12.21"> {                                                     \</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineat">@@ -105,23 +105,23 @@ nsMsgIdentity::Get##_postfix(PRInt32 *re</span>
<a href="#l12.23"></a><span id="l12.23">   return GetIntAttribute(_prefname, retval);        \</span>
<a href="#l12.24"></a><span id="l12.24"> }                                                   \</span>
<a href="#l12.25"></a><span id="l12.25"> NS_IMETHODIMP                                       \</span>
<a href="#l12.26"></a><span id="l12.26"> nsMsgIdentity::Set##_postfix(PRInt32 value)         \</span>
<a href="#l12.27"></a><span id="l12.27"> {                                                   \</span>
<a href="#l12.28"></a><span id="l12.28">   return mPrefBranch-&gt;SetIntPref(_prefname, value); \</span>
<a href="#l12.29"></a><span id="l12.29"> }</span>
<a href="#l12.30"></a><span id="l12.30"> </span>
<a href="#l12.31"></a><span id="l12.31" class="difflineminus">-#define NS_IMPL_FOLDERPREF_STR(_postfix, _prefname, _flag)  \</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+#define NS_IMPL_FOLDERPREF_STR(_postfix, _prefname, _foldername, _flag)  \</span>
<a href="#l12.33"></a><span id="l12.33"> NS_IMETHODIMP                                               \</span>
<a href="#l12.34"></a><span id="l12.34"> nsMsgIdentity::Get##_postfix(nsACString&amp; retval)            \</span>
<a href="#l12.35"></a><span id="l12.35"> {                                                           \</span>
<a href="#l12.36"></a><span id="l12.36">   nsresult rv;                                              \</span>
<a href="#l12.37"></a><span id="l12.37">   nsCString folderPref;                                     \</span>
<a href="#l12.38"></a><span id="l12.38" class="difflineminus">-  rv = getFolderPref(_prefname, folderPref, _flag);         \</span>
<a href="#l12.39"></a><span id="l12.39" class="difflineplus">+  rv = getFolderPref(_prefname, folderPref, _foldername, _flag); \</span>
<a href="#l12.40"></a><span id="l12.40">   retval = folderPref;                                      \</span>
<a href="#l12.41"></a><span id="l12.41">   return rv;                                                \</span>
<a href="#l12.42"></a><span id="l12.42"> }                                                           \</span>
<a href="#l12.43"></a><span id="l12.43"> NS_IMETHODIMP                                               \</span>
<a href="#l12.44"></a><span id="l12.44"> nsMsgIdentity::Set##_postfix(const nsACString&amp; value)       \</span>
<a href="#l12.45"></a><span id="l12.45"> {                                                           \</span>
<a href="#l12.46"></a><span id="l12.46">   return setFolderPref(_prefname, value, _flag); \</span>
<a href="#l12.47"></a><span id="l12.47"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/mailnews.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/mailnews.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -160,17 +160,17 @@ pref(&quot;mail.imap.use_literal_plus&quot;,      </span>
<a href="#l13.4"></a><span id="l13.4"> pref(&quot;mail.imap.expunge_after_delete&quot;,      false);</span>
<a href="#l13.5"></a><span id="l13.5"> pref(&quot;mail.imap.check_deleted_before_expunge&quot;, false);</span>
<a href="#l13.6"></a><span id="l13.6"> pref(&quot;mail.imap.expunge_option&quot;,            0);</span>
<a href="#l13.7"></a><span id="l13.7"> pref(&quot;mail.imap.expunge_threshold_number&quot;,  20);</span>
<a href="#l13.8"></a><span id="l13.8"> // if true, we assume that a user access a folder in the other users namespace</span>
<a href="#l13.9"></a><span id="l13.9"> // is acting as a delegate for that folder, and wishes to use the other users</span>
<a href="#l13.10"></a><span id="l13.10"> // identity when acting on messages in other users folders.</span>
<a href="#l13.11"></a><span id="l13.11"> pref(&quot;mail.imap.delegateOtherUsersFolders&quot;, false);</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-pref(&quot;mail.thread_without_re&quot;,              true); // if false, only thread by subject if Re:</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+pref(&quot;mail.thread_without_re&quot;,              false); // if false, only thread by subject if Re:</span>
<a href="#l13.14"></a><span id="l13.14"> pref(&quot;mail.strict_threading&quot;,               false); // if true, don't thread by subject at all</span>
<a href="#l13.15"></a><span id="l13.15"> pref(&quot;mail.correct_threading&quot;,              false); // if true, makes sure threading works correctly always (see bug 181446)</span>
<a href="#l13.16"></a><span id="l13.16"> pref(&quot;mail.leave_on_server&quot;,                false);</span>
<a href="#l13.17"></a><span id="l13.17"> pref(&quot;mail.default_cc&quot;,                     &quot;&quot;);</span>
<a href="#l13.18"></a><span id="l13.18"> pref(&quot;mail.default_fcc&quot;,                    &quot;&quot;); // maibox:URL or Imap://Host/OnLineFolderName</span>
<a href="#l13.19"></a><span id="l13.19"> pref(&quot;mail.check_new_mail&quot;,                 false);</span>
<a href="#l13.20"></a><span id="l13.20"> pref(&quot;mail.pop3_gets_new_mail&quot;,             false);</span>
<a href="#l13.21"></a><span id="l13.21"> pref(&quot;mail.check_time&quot;,                     10);</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineat">@@ -424,16 +424,20 @@ pref(&quot;mail.identity.default.bcc_list&quot;, &quot;</span>
<a href="#l13.23"></a><span id="l13.23"> </span>
<a href="#l13.24"></a><span id="l13.24"> pref(&quot;mail.identity.default.draft_folder&quot;, &quot;mailbox://nobody@Local%20Folders/Drafts&quot;);</span>
<a href="#l13.25"></a><span id="l13.25"> pref(&quot;mail.identity.default.stationery_folder&quot;, &quot;mailbox://nobody@Local%20Folders/Templates&quot;);</span>
<a href="#l13.26"></a><span id="l13.26"> pref(&quot;mail.identity.default.directoryServer&quot;, &quot;&quot;);</span>
<a href="#l13.27"></a><span id="l13.27"> pref(&quot;mail.identity.default.overrideGlobal_Pref&quot;, false);</span>
<a href="#l13.28"></a><span id="l13.28"> pref(&quot;mail.identity.default.auto_quote&quot;, true);</span>
<a href="#l13.29"></a><span id="l13.29"> pref(&quot;mail.identity.default.reply_on_top&quot;, 0); // 0=bottom 1=top 2=select</span>
<a href="#l13.30"></a><span id="l13.30"> pref(&quot;mail.identity.default.sig_bottom&quot;, true); // true=below quoted false=above quoted</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineplus">+</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+// default to archives folder on same server.</span>
<a href="#l13.33"></a><span id="l13.33" class="difflineplus">+pref(&quot;mail.identity.default.archives_folder_picker_mode&quot;, &quot;0&quot;);</span>
<a href="#l13.34"></a><span id="l13.34" class="difflineplus">+</span>
<a href="#l13.35"></a><span id="l13.35"> // Headers to always add to outgoing mail</span>
<a href="#l13.36"></a><span id="l13.36"> // examples: &quot;header1,header2&quot;</span>
<a href="#l13.37"></a><span id="l13.37"> // pref(&quot;mail.identity.id1.headers&quot;, &quot;header1&quot;);</span>
<a href="#l13.38"></a><span id="l13.38"> // user_pref(&quot;mail.identity.id1.header.header1&quot;, &quot;X-Mozilla-Rocks: True&quot;)</span>
<a href="#l13.39"></a><span id="l13.39"> pref(&quot;mail.identity.default.headers&quot;, &quot;&quot;);</span>
<a href="#l13.40"></a><span id="l13.40"> </span>
<a href="#l13.41"></a><span id="l13.41"> // by default, only collect addresses the user sends to (outgoing)</span>
<a href="#l13.42"></a><span id="l13.42"> // incoming is all spam anyways</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/suite/locales/en-US/chrome/mailnews/messenger.properties</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/mailnews/messenger.properties</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -165,16 +165,17 @@ localFolders=Local Folders</span>
<a href="#l14.4"></a><span id="l14.4"> # LOCALIZATION NOTE (inboxFolderName): OK to translate all foldernames, bugzilla #57440 &amp; bugzilla #23625 fixed</span>
<a href="#l14.5"></a><span id="l14.5"> inboxFolderName=Inbox</span>
<a href="#l14.6"></a><span id="l14.6"> trashFolderName=Trash</span>
<a href="#l14.7"></a><span id="l14.7"> sentFolderName=Sent</span>
<a href="#l14.8"></a><span id="l14.8"> draftsFolderName=Drafts</span>
<a href="#l14.9"></a><span id="l14.9"> templatesFolderName=Templates</span>
<a href="#l14.10"></a><span id="l14.10"> outboxFolderName=Outbox</span>
<a href="#l14.11"></a><span id="l14.11"> junkFolderName=Junk</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineplus">+archivesFolderName=Archives</span>
<a href="#l14.13"></a><span id="l14.13"> </span>
<a href="#l14.14"></a><span id="l14.14"> # Error message for special folder deletion on imap accounts</span>
<a href="#l14.15"></a><span id="l14.15"> # LOCALIZATION NOTE (specialFolderDeletionErr): Do not translate &quot;IMAP&quot; in the line below</span>
<a href="#l14.16"></a><span id="l14.16"> specialFolderDeletionErr=Deletion of special folder %S is not allowed for IMAP accounts.</span>
<a href="#l14.17"></a><span id="l14.17"> specialFolderDeletionErrTitle=Special Folder Deletion</span>
<a href="#l14.18"></a><span id="l14.18"> </span>
<a href="#l14.19"></a><span id="l14.19"> # &quot;Normal&quot; priority is often blank,</span>
<a href="#l14.20"></a><span id="l14.20"> # depending on the consumers of these strings</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/suite/locales/en-US/chrome/mailnews/pref/am-copies.dtd</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/mailnews/pref/am-copies.dtd</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -16,16 +16,22 @@</span>
<a href="#l15.4"></a><span id="l15.4"> &lt;!ENTITY sentFolderOn.accesskey &quot;S&quot;&gt;</span>
<a href="#l15.5"></a><span id="l15.5"> &lt;!ENTITY sentInOtherFolder.label &quot;Other:&quot;&gt;</span>
<a href="#l15.6"></a><span id="l15.6"> &lt;!ENTITY sentInOtherFolder.accesskey &quot;O&quot;&gt;</span>
<a href="#l15.7"></a><span id="l15.7"> &lt;!-- LOCALIZATION NOTE (draftsFolderOn.label): OK to translate this, bug #57440 --&gt;</span>
<a href="#l15.8"></a><span id="l15.8"> &lt;!ENTITY draftsFolderOn.label &quot;&amp;quot;Drafts&amp;quot; Folder on:&quot;&gt;</span>
<a href="#l15.9"></a><span id="l15.9"> &lt;!ENTITY draftsFolderOn.accesskey &quot;D&quot;&gt;</span>
<a href="#l15.10"></a><span id="l15.10"> &lt;!ENTITY draftInOtherFolder.label &quot;Other:&quot;&gt;</span>
<a href="#l15.11"></a><span id="l15.11"> &lt;!ENTITY draftInOtherFolder.accesskey &quot;t&quot;&gt;</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineplus">+&lt;!-- LOCALIZATION NOTE (archivesFolderOn.label): OK to translate this, bug #57440 --&gt;</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+&lt;!ENTITY archivesFolderOn.label &quot;&amp;quot;Archives&amp;quot; Folder on:&quot;&gt;</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineplus">+&lt;!ENTITY archivesFolderOn.accesskey &quot;D&quot;&gt;</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineplus">+&lt;!ENTITY archiveInOtherFolder.label &quot;Other:&quot;&gt;</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineplus">+&lt;!ENTITY archiveInOtherFolder.accesskey &quot;t&quot;&gt;</span>
<a href="#l15.17"></a><span id="l15.17"> &lt;!-- LOCALIZATION NOTE (templatesFolderOn.label): OK to translate this, bug #57440 --&gt;</span>
<a href="#l15.18"></a><span id="l15.18"> &lt;!ENTITY templatesFolderOn.label &quot;&amp;quot;Templates&amp;quot; Folder on:&quot;&gt;</span>
<a href="#l15.19"></a><span id="l15.19"> &lt;!ENTITY templatesFolderOn.accesskey &quot;m&quot;&gt;</span>
<a href="#l15.20"></a><span id="l15.20"> &lt;!ENTITY templateInOtherFolder.label &quot;Other:&quot;&gt;</span>
<a href="#l15.21"></a><span id="l15.21"> &lt;!ENTITY templateInOtherFolder.accesskey &quot;e&quot;&gt;</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineminus">-&lt;!ENTITY specialFoldersTitle.label &quot;Drafts and Templates&quot;&gt;</span>
<a href="#l15.23"></a><span id="l15.23" class="difflineplus">+&lt;!ENTITY specialFoldersTitle.label &quot;Drafts, Archives, and Templates&quot;&gt;</span>
<a href="#l15.24"></a><span id="l15.24"> &lt;!ENTITY keepDrafts.label &quot;Keep message drafts in:&quot;&gt;</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineplus">+&lt;!ENTITY keepArchives.label &quot;Keep message archives in:&quot;&gt;</span>
<a href="#l15.26"></a><span id="l15.26"> &lt;!ENTITY keepTempltes.label &quot;Keep message templates in:&quot;&gt;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

