<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 9460:8b3d55adf7a63521592c9ebc34dd99e43ecc1e88</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 8b3d55adf7a63521592c9ebc34dd99e43ecc1e88" />
<meta property="og:url" content="/comm-central/rev/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88" />
<meta property="og:description" content="Bug 727408 - Remove nsIPrefBranch2 uses from comm-central, Part D - mail/ ; r=Standard8" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 8b3d55adf7a63521592c9ebc34dd99e43ecc1e88 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88">shortlog</a> |
<a href="/comm-central/log/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88">files</a> |
changeset |
<a href="/comm-central/raw-rev/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88">raw</a>  | <a href="/comm-central/archive/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=727408">Bug 727408</a> - Remove nsIPrefBranch2 uses from comm-central, Part D - mail/ ; r=Standard8
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#71;&#101;&#111;&#102;&#102;&#32;&#76;&#97;&#110;&#107;&#111;&#119;&#32;&#60;&#103;&#101;&#111;&#102;&#102;&#64;&#100;&#97;&#114;&#107;&#116;&#114;&#111;&#106;&#97;&#110;&#46;&#110;&#101;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Wed, 22 Feb 2012 11:46:59 +1300</td></tr>

<tr>
 <td>changeset 9460</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88">8b3d55adf7a63521592c9ebc34dd99e43ecc1e88</a></td>
</tr>



<tr>
<td>parent 9459</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/b55594e9215d5909421b6c9aee198f44b8d3553d">b55594e9215d5909421b6c9aee198f44b8d3553d</a>
</td>
</tr>

<tr>
<td>child 9461</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/38d22eafca6770250bd83ed420b81d52fea00e6d">38d22eafca6770250bd83ed420b81d52fea00e6d</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=8b3d55adf7a63521592c9ebc34dd99e43ecc1e88">7231</a></td></tr>
<tr><td>push user</td><td>geoff@darktrojan.net</td></tr>
<tr><td>push date</td><td class="date age">Tue, 21 Feb 2012 22:49:08 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@38d22eafca67 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=38d22eafca6770250bd83ed420b81d52fea00e6d">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=38d22eafca6770250bd83ed420b81d52fea00e6d&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=38d22eafca6770250bd83ed420b81d52fea00e6d&newProject=comm-central&newRevision=f148c7fda60f3d7b7a29943c18d88f3fde78a33b&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=38d22eafca6770250bd83ed420b81d52fea00e6d&newProject=comm-central&newRevision=f148c7fda60f3d7b7a29943c18d88f3fde78a33b&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=38d22eafca6770250bd83ed420b81d52fea00e6d&newProject=comm-central&newRevision=f148c7fda60f3d7b7a29943c18d88f3fde78a33b&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28Standard8%29&revcount=50">Standard8</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=727408">727408</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=727408">Bug 727408</a> - Remove nsIPrefBranch2 uses from comm-central, Part D - mail/ ; r=Standard8</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/test_data_store.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/tests/test_data_store.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/test_data_store.js">file</a> |
<a href="/comm-central/annotate/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/test_data_store.js">annotate</a> |
<a href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/test_data_store.js">diff</a> |
<a href="/comm-central/comparison/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/test_data_store.js">comparison</a> |
<a href="/comm-central/log/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/test_data_store.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/ABSearchDialog.js">mail/base/content/ABSearchDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/ABSearchDialog.js">file</a> |
<a href="/comm-central/annotate/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/ABSearchDialog.js">annotate</a> |
<a href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/ABSearchDialog.js">diff</a> |
<a href="/comm-central/comparison/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/ABSearchDialog.js">comparison</a> |
<a href="/comm-central/log/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/ABSearchDialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/mailWindow.js">mail/base/content/mailWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/mailWindow.js">file</a> |
<a href="/comm-central/annotate/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/mailWindow.js">annotate</a> |
<a href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/mailWindow.js">diff</a> |
<a href="/comm-central/comparison/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/mailWindow.js">comparison</a> |
<a href="/comm-central/log/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/mailWindow.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/msgHdrViewOverlay.js">mail/base/content/msgHdrViewOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/msgHdrViewOverlay.js">file</a> |
<a href="/comm-central/annotate/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/msgHdrViewOverlay.js">annotate</a> |
<a href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/msgHdrViewOverlay.js">diff</a> |
<a href="/comm-central/comparison/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/msgHdrViewOverlay.js">comparison</a> |
<a href="/comm-central/log/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/msgHdrViewOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/msgMail3PaneWindow.js">mail/base/content/msgMail3PaneWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/msgMail3PaneWindow.js">file</a> |
<a href="/comm-central/annotate/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/msgMail3PaneWindow.js">annotate</a> |
<a href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/msgMail3PaneWindow.js">diff</a> |
<a href="/comm-central/comparison/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/msgMail3PaneWindow.js">comparison</a> |
<a href="/comm-central/log/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/msgMail3PaneWindow.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/search.xml">mail/base/content/search.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/search.xml">file</a> |
<a href="/comm-central/annotate/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/search.xml">annotate</a> |
<a href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/search.xml">diff</a> |
<a href="/comm-central/comparison/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/search.xml">comparison</a> |
<a href="/comm-central/log/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/search.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/tabmail.xml">mail/base/content/tabmail.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/tabmail.xml">file</a> |
<a href="/comm-central/annotate/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/tabmail.xml">annotate</a> |
<a href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/tabmail.xml">diff</a> |
<a href="/comm-central/comparison/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/tabmail.xml">comparison</a> |
<a href="/comm-central/log/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/base/content/tabmail.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/compose/content/MsgComposeCommands.js">mail/components/compose/content/MsgComposeCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/compose/content/MsgComposeCommands.js">file</a> |
<a href="/comm-central/annotate/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/compose/content/MsgComposeCommands.js">annotate</a> |
<a href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/compose/content/MsgComposeCommands.js">diff</a> |
<a href="/comm-central/comparison/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/compose/content/MsgComposeCommands.js">comparison</a> |
<a href="/comm-central/log/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/compose/content/MsgComposeCommands.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/preferences/applications.js">mail/components/preferences/applications.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/preferences/applications.js">file</a> |
<a href="/comm-central/annotate/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/preferences/applications.js">annotate</a> |
<a href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/preferences/applications.js">diff</a> |
<a href="/comm-central/comparison/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/preferences/applications.js">comparison</a> |
<a href="/comm-central/log/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/preferences/applications.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/search/content/searchCommon.js">mail/components/search/content/searchCommon.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/search/content/searchCommon.js">file</a> |
<a href="/comm-central/annotate/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/search/content/searchCommon.js">annotate</a> |
<a href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/search/content/searchCommon.js">diff</a> |
<a href="/comm-central/comparison/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/search/content/searchCommon.js">comparison</a> |
<a href="/comm-central/log/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/search/content/searchCommon.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/wintaskbar/windowsJumpLists.js">mail/components/wintaskbar/windowsJumpLists.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/wintaskbar/windowsJumpLists.js">file</a> |
<a href="/comm-central/annotate/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/wintaskbar/windowsJumpLists.js">annotate</a> |
<a href="/comm-central/diff/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/wintaskbar/windowsJumpLists.js">diff</a> |
<a href="/comm-central/comparison/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/wintaskbar/windowsJumpLists.js">comparison</a> |
<a href="/comm-central/log/8b3d55adf7a63521592c9ebc34dd99e43ecc1e88/mail/components/wintaskbar/windowsJumpLists.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/tests/test_data_store.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/tests/test_data_store.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -91,17 +91,17 @@ function cheapAssertFail(errorMsg) {</span>
<a href="#l1.4"></a><span id="l1.4"> }</span>
<a href="#l1.5"></a><span id="l1.5"> </span>
<a href="#l1.6"></a><span id="l1.6"> // Utility functions for cleanup:</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8"> function clearAllPrefsForStudy(studyId) {</span>
<a href="#l1.9"></a><span id="l1.9">   output(&quot;Looking for prefs to delete...\n&quot;);</span>
<a href="#l1.10"></a><span id="l1.10">   let prefService = Cc[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l1.11"></a><span id="l1.11">                      .getService(Ci.nsIPrefService)</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-                     .QueryInterface(Ci.nsIPrefBranch2);</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+                     .QueryInterface(Ci.nsIPrefBranch);</span>
<a href="#l1.14"></a><span id="l1.14">   let prefStem = &quot;extensions.testpilot&quot;;</span>
<a href="#l1.15"></a><span id="l1.15">   let prefNames = prefService.getChildList(prefStem);</span>
<a href="#l1.16"></a><span id="l1.16">   for each (let prefName in prefNames) {</span>
<a href="#l1.17"></a><span id="l1.17">     if (prefName.indexOf(studyId) != -1) {</span>
<a href="#l1.18"></a><span id="l1.18">       output(&quot;Clearing pref &quot; + prefName + &quot;\n&quot;);</span>
<a href="#l1.19"></a><span id="l1.19">       prefService.clearUserPref(prefName);</span>
<a href="#l1.20"></a><span id="l1.20">     }</span>
<a href="#l1.21"></a><span id="l1.21">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/ABSearchDialog.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/ABSearchDialog.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -84,17 +84,17 @@ function searchOnLoad()</span>
<a href="#l2.4"></a><span id="l2.4">   gSearchStopButton.setAttribute(&quot;label&quot;, gSearchBundle.getString(&quot;labelForSearchButton&quot;));</span>
<a href="#l2.5"></a><span id="l2.5">   gSearchStopButton.setAttribute(&quot;accesskey&quot;, gSearchBundle.getString(&quot;labelForSearchButton.accesskey&quot;));</span>
<a href="#l2.6"></a><span id="l2.6">   gAddressBookBundle = document.getElementById(&quot;bundle_addressBook&quot;);</span>
<a href="#l2.7"></a><span id="l2.7">   gSearchSession = Components.classes[searchSessionContractID].createInstance(Components.interfaces.nsIMsgSearchSession);</span>
<a href="#l2.8"></a><span id="l2.8"> </span>
<a href="#l2.9"></a><span id="l2.9">   // initialize a flag for phonetic name search</span>
<a href="#l2.10"></a><span id="l2.10">   var prefService = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l2.11"></a><span id="l2.11">                               .getService(Components.interfaces.nsIPrefService);</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-  var prefBranch = prefService.getBranch(null).QueryInterface(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+  var prefBranch = prefService.getBranch(null);</span>
<a href="#l2.14"></a><span id="l2.14">   gSearchPhoneticName =</span>
<a href="#l2.15"></a><span id="l2.15">         prefBranch.getComplexValue(&quot;mail.addr_book.show_phonetic_fields&quot;, </span>
<a href="#l2.16"></a><span id="l2.16">                                    Components.interfaces.nsIPrefLocalizedString).data;</span>
<a href="#l2.17"></a><span id="l2.17"> </span>
<a href="#l2.18"></a><span id="l2.18">   if (window.arguments &amp;&amp; window.arguments[0])</span>
<a href="#l2.19"></a><span id="l2.19">     SelectDirectory(window.arguments[0].directory);</span>
<a href="#l2.20"></a><span id="l2.20">   else</span>
<a href="#l2.21"></a><span id="l2.21">     SelectDirectory(document.getElementById(&quot;abPopup-menupopup&quot;)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/base/content/mailWindow.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/base/content/mailWindow.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -88,17 +88,17 @@ function OnMailWindowUnload()</span>
<a href="#l3.4"></a><span id="l3.4"> </span>
<a href="#l3.5"></a><span id="l3.5"> function CreateMailWindowGlobals()</span>
<a href="#l3.6"></a><span id="l3.6"> {</span>
<a href="#l3.7"></a><span id="l3.7">   // get the messenger instance</span>
<a href="#l3.8"></a><span id="l3.8">   messenger = Components.classes[&quot;@mozilla.org/messenger;1&quot;]</span>
<a href="#l3.9"></a><span id="l3.9">                         .createInstance(Components.interfaces.nsIMessenger);</span>
<a href="#l3.10"></a><span id="l3.10"> </span>
<a href="#l3.11"></a><span id="l3.11">   pref = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-          .getService(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+          .getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15">   window.addEventListener(&quot;blur&quot;, appIdleManager.onBlur, false);</span>
<a href="#l3.16"></a><span id="l3.16">   window.addEventListener(&quot;focus&quot;, appIdleManager.onFocus, false);</span>
<a href="#l3.17"></a><span id="l3.17"> </span>
<a href="#l3.18"></a><span id="l3.18">   //Create windows status feedback</span>
<a href="#l3.19"></a><span id="l3.19">   // set the JS implementation of status feedback before creating the c++ one..</span>
<a href="#l3.20"></a><span id="l3.20">   window.MsgStatusFeedback = new nsMsgStatusFeedback();</span>
<a href="#l3.21"></a><span id="l3.21">   // double register the status feedback object as the xul browser window implementation</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/base/content/msgHdrViewOverlay.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/base/content/msgHdrViewOverlay.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -172,17 +172,17 @@ function createHeaderEntry(prefix, heade</span>
<a href="#l4.4"></a><span id="l4.4">   // extraction and use by UpdateEmailNodeDetails.</span>
<a href="#l4.5"></a><span id="l4.5">   this.enclosingBox.headerName = headerListInfo.name;</span>
<a href="#l4.6"></a><span id="l4.6"> </span>
<a href="#l4.7"></a><span id="l4.7"> }</span>
<a href="#l4.8"></a><span id="l4.8"> </span>
<a href="#l4.9"></a><span id="l4.9"> function initializeHeaderViewTables()</span>
<a href="#l4.10"></a><span id="l4.10"> {</span>
<a href="#l4.11"></a><span id="l4.11">   var prefBranch = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-                             .getService(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+                             .getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l4.14"></a><span id="l4.14">   // iterate over each header in our header list arrays and create header entries</span>
<a href="#l4.15"></a><span id="l4.15">   // for each one. These header entries are then stored in the appropriate header table</span>
<a href="#l4.16"></a><span id="l4.16">   var index;</span>
<a href="#l4.17"></a><span id="l4.17">   for (index = 0; index &lt; gExpandedHeaderList.length; index++)</span>
<a href="#l4.18"></a><span id="l4.18">   {</span>
<a href="#l4.19"></a><span id="l4.19">     var headerName = gExpandedHeaderList[index].name;</span>
<a href="#l4.20"></a><span id="l4.20">     gExpandedHeaderView[headerName] = new createHeaderEntry('expanded', gExpandedHeaderList[index]);</span>
<a href="#l4.21"></a><span id="l4.21">   }</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineat">@@ -2007,17 +2007,17 @@ function displayAttachmentsForExpandedVi</span>
<a href="#l4.23"></a><span id="l4.23">     attachmentSplitter.collapsed = true;</span>
<a href="#l4.24"></a><span id="l4.24">   }</span>
<a href="#l4.25"></a><span id="l4.25">   else if (!gBuildAttachmentsForCurrentMsg) {</span>
<a href="#l4.26"></a><span id="l4.26">     attachmentView.collapsed = false;</span>
<a href="#l4.27"></a><span id="l4.27"> </span>
<a href="#l4.28"></a><span id="l4.28">     var attachmentList = document.getElementById(&quot;attachmentList&quot;);</span>
<a href="#l4.29"></a><span id="l4.29"> </span>
<a href="#l4.30"></a><span id="l4.30">     var viewMode = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineminus">-                             .getService(Components.interfaces.nsIPrefBranch2)</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+                             .getService(Components.interfaces.nsIPrefBranch)</span>
<a href="#l4.33"></a><span id="l4.33">                              .getIntPref(&quot;mailnews.attachments.display.view&quot;);</span>
<a href="#l4.34"></a><span id="l4.34">     var views = [&quot;small&quot;, &quot;large&quot;, &quot;tile&quot;];</span>
<a href="#l4.35"></a><span id="l4.35">     attachmentList.view = views[viewMode];</span>
<a href="#l4.36"></a><span id="l4.36">     attachmentList.controllers.appendController(AttachmentListController);</span>
<a href="#l4.37"></a><span id="l4.37"> </span>
<a href="#l4.38"></a><span id="l4.38">     toggleAttachmentList(false);</span>
<a href="#l4.39"></a><span id="l4.39"> </span>
<a href="#l4.40"></a><span id="l4.40">     var unknownSize = false;</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineat">@@ -2554,17 +2554,17 @@ nsDummyMsgHeader.prototype =</span>
<a href="#l4.42"></a><span id="l4.42">   // folderDisplay.js's FolderDisplayWidget's selectedMessageIsExternal getter.</span>
<a href="#l4.43"></a><span id="l4.43">   folder : null</span>
<a href="#l4.44"></a><span id="l4.44"> };</span>
<a href="#l4.45"></a><span id="l4.45"> </span>
<a href="#l4.46"></a><span id="l4.46"> function onShowOtherActionsPopup()</span>
<a href="#l4.47"></a><span id="l4.47"> {</span>
<a href="#l4.48"></a><span id="l4.48">   // Enable/disable the Open Conversation button.</span>
<a href="#l4.49"></a><span id="l4.49">   let prefBranch = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineminus">-                             .getService(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineplus">+                             .getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l4.52"></a><span id="l4.52">   let glodaEnabled = prefBranch.getBoolPref(&quot;mailnews.database.global.indexer.enabled&quot;);</span>
<a href="#l4.53"></a><span id="l4.53"> </span>
<a href="#l4.54"></a><span id="l4.54">   let openConversation = document.getElementById(&quot;otherActionsOpenConversation&quot;);</span>
<a href="#l4.55"></a><span id="l4.55">   openConversation.disabled = !glodaEnabled;</span>
<a href="#l4.56"></a><span id="l4.56">   if (glodaEnabled &amp;&amp; gFolderDisplay.selectedMessages.length &gt; 0) {</span>
<a href="#l4.57"></a><span id="l4.57">     let message = gFolderDisplay.selectedMessages[0];</span>
<a href="#l4.58"></a><span id="l4.58">     let isMessageIndexed = Gloda.isMessageIndexed(message);</span>
<a href="#l4.59"></a><span id="l4.59">     openConversation.disabled = !isMessageIndexed;</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineat">@@ -2591,17 +2591,17 @@ ConversationOpener.prototype = {</span>
<a href="#l4.61"></a><span id="l4.61">       this._msgHdr = messages[0];</span>
<a href="#l4.62"></a><span id="l4.62">       this._queries = [Gloda.getMessageCollectionForHeaders(messages, this)];</span>
<a href="#l4.63"></a><span id="l4.63">     } catch (e) {</span>
<a href="#l4.64"></a><span id="l4.64">       logException(e);</span>
<a href="#l4.65"></a><span id="l4.65">     }</span>
<a href="#l4.66"></a><span id="l4.66">   },</span>
<a href="#l4.67"></a><span id="l4.67">   isSelectedMessageIndexed: function() {</span>
<a href="#l4.68"></a><span id="l4.68">     let prefBranch = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l4.69"></a><span id="l4.69" class="difflineminus">-                               .getService(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l4.70"></a><span id="l4.70" class="difflineplus">+                               .getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l4.71"></a><span id="l4.71">     let glodaEnabled = prefBranch.getBoolPref(&quot;mailnews.database.global.indexer.enabled&quot;);</span>
<a href="#l4.72"></a><span id="l4.72"> </span>
<a href="#l4.73"></a><span id="l4.73">     if (glodaEnabled &amp;&amp; gFolderDisplay.selectedMessages.length &gt; 0) {</span>
<a href="#l4.74"></a><span id="l4.74">       let message = gFolderDisplay.selectedMessages[0];</span>
<a href="#l4.75"></a><span id="l4.75">       return Gloda.isMessageIndexed(message);</span>
<a href="#l4.76"></a><span id="l4.76">     }</span>
<a href="#l4.77"></a><span id="l4.77">     return false;</span>
<a href="#l4.78"></a><span id="l4.78">   },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/base/content/msgMail3PaneWindow.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/base/content/msgMail3PaneWindow.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -362,17 +362,16 @@ function OnLoadMessenger()</span>
<a href="#l5.4"></a><span id="l5.4"> </span>
<a href="#l5.5"></a><span id="l5.5">     document.documentElement.setAttribute(&quot;width&quot;, defaultWidth);</span>
<a href="#l5.6"></a><span id="l5.6">     document.documentElement.setAttribute(&quot;height&quot;, defaultHeight);</span>
<a href="#l5.7"></a><span id="l5.7">     // Make sure we're safe at the left/top edge of screen</span>
<a href="#l5.8"></a><span id="l5.8">     document.documentElement.setAttribute(&quot;screenX&quot;, screen.availLeft);</span>
<a href="#l5.9"></a><span id="l5.9">     document.documentElement.setAttribute(&quot;screenY&quot;, screen.availTop);</span>
<a href="#l5.10"></a><span id="l5.10">   }</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-  gPrefBranch.QueryInterface(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l5.13"></a><span id="l5.13">   gPrefBranch.addObserver(&quot;mail.pane_config.dynamic&quot;, MailPrefObserver, false);</span>
<a href="#l5.14"></a><span id="l5.14">   gPrefBranch.addObserver(&quot;mail.showCondensedAddresses&quot;, MailPrefObserver,</span>
<a href="#l5.15"></a><span id="l5.15">                           false);</span>
<a href="#l5.16"></a><span id="l5.16"> </span>
<a href="#l5.17"></a><span id="l5.17">   MailOfflineMgr.init();</span>
<a href="#l5.18"></a><span id="l5.18">   CreateMailWindowGlobals();</span>
<a href="#l5.19"></a><span id="l5.19">   GetMessagePaneWrapper().collapsed = true;</span>
<a href="#l5.20"></a><span id="l5.20"> </span>
<a href="#l5.21"></a><span id="l5.21" class="difflineat">@@ -601,17 +600,16 @@ function FindOther3PaneWindow()</span>
<a href="#l5.22"></a><span id="l5.22"> </span>
<a href="#l5.23"></a><span id="l5.23"> /**</span>
<a href="#l5.24"></a><span id="l5.24">  * Called by messenger.xul:onunload, the 3-pane window inside of tabs window.</span>
<a href="#l5.25"></a><span id="l5.25">  *  It's being unloaded!  Right now!</span>
<a href="#l5.26"></a><span id="l5.26">  */</span>
<a href="#l5.27"></a><span id="l5.27"> function OnUnloadMessenger()</span>
<a href="#l5.28"></a><span id="l5.28"> {</span>
<a href="#l5.29"></a><span id="l5.29">   accountManager.removeIncomingServerListener(gThreePaneIncomingServerListener);</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineminus">-  gPrefBranch.QueryInterface(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l5.31"></a><span id="l5.31">   gPrefBranch.removeObserver(&quot;mail.pane_config.dynamic&quot;, MailPrefObserver);</span>
<a href="#l5.32"></a><span id="l5.32">   gPrefBranch.removeObserver(&quot;mail.showCondensedAddresses&quot;, MailPrefObserver);</span>
<a href="#l5.33"></a><span id="l5.33"> </span>
<a href="#l5.34"></a><span id="l5.34">   sessionStoreManager.unloadingWindow(window);</span>
<a href="#l5.35"></a><span id="l5.35"> </span>
<a href="#l5.36"></a><span id="l5.36">   let tabmail = document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l5.37"></a><span id="l5.37">   tabmail._teardown();</span>
<a href="#l5.38"></a><span id="l5.38"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/base/content/search.xml</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/base/content/search.xml</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -99,17 +99,17 @@</span>
<a href="#l6.4"></a><span id="l6.4">             &quot;placeholder&quot;,</span>
<a href="#l6.5"></a><span id="l6.5">             this.getAttribute(&quot;emptytextbase&quot;)</span>
<a href="#l6.6"></a><span id="l6.6">                  .replace(&quot;#1&quot;, this.getAttribute(</span>
<a href="#l6.7"></a><span id="l6.7">                                   Application.platformIsMac ?</span>
<a href="#l6.8"></a><span id="l6.8">                                   &quot;keyLabelMac&quot; : &quot;keyLabelNonMac&quot;)));</span>
<a href="#l6.9"></a><span id="l6.9"> </span>
<a href="#l6.10"></a><span id="l6.10">           var prefBranch =</span>
<a href="#l6.11"></a><span id="l6.11">               Components.classes['@mozilla.org/preferences-service;1'].</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-              getService(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+              getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l6.14"></a><span id="l6.14">           this.glodaCompleter =</span>
<a href="#l6.15"></a><span id="l6.15">             Components.classes[&quot;@mozilla.org/autocomplete/search;1?name=gloda&quot;]</span>
<a href="#l6.16"></a><span id="l6.16">                       .getService()</span>
<a href="#l6.17"></a><span id="l6.17">                       .wrappedJSObject;</span>
<a href="#l6.18"></a><span id="l6.18">           var observerSvc = Cc[&quot;@mozilla.org/observer-service;1&quot;]</span>
<a href="#l6.19"></a><span id="l6.19">                             .getService(Ci.nsIObserverService);</span>
<a href="#l6.20"></a><span id="l6.20"> </span>
<a href="#l6.21"></a><span id="l6.21">           if ((typeof gSearchInputObserversRegistered != &quot;undefined&quot; &amp;&amp;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/base/content/tabmail.xml</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/base/content/tabmail.xml</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -1616,17 +1616,17 @@</span>
<a href="#l7.4"></a><span id="l7.4">       &lt;/xul:stack&gt;</span>
<a href="#l7.5"></a><span id="l7.5">     &lt;/content&gt;</span>
<a href="#l7.6"></a><span id="l7.6"> </span>
<a href="#l7.7"></a><span id="l7.7">     &lt;implementation implements=&quot;nsITimerCallback, nsIDOMEventListener&quot;&gt;</span>
<a href="#l7.8"></a><span id="l7.8">       &lt;constructor&gt;</span>
<a href="#l7.9"></a><span id="l7.9">         &lt;![CDATA[</span>
<a href="#l7.10"></a><span id="l7.10">           var pb2 =</span>
<a href="#l7.11"></a><span id="l7.11">               Components.classes['@mozilla.org/preferences-service;1'].</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-              getService(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+              getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l7.14"></a><span id="l7.14"> </span>
<a href="#l7.15"></a><span id="l7.15">           try {</span>
<a href="#l7.16"></a><span id="l7.16">             this.mTabMinWidth = pb2.getIntPref(&quot;mail.tabs.tabMinWidth&quot;);</span>
<a href="#l7.17"></a><span id="l7.17">           } catch (e) {</span>
<a href="#l7.18"></a><span id="l7.18">           }</span>
<a href="#l7.19"></a><span id="l7.19">           try {</span>
<a href="#l7.20"></a><span id="l7.20">             this.mTabMaxWidth = pb2.getIntPref(&quot;mail.tabs.tabMaxWidth&quot;);</span>
<a href="#l7.21"></a><span id="l7.21">           } catch (e) {</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineat">@@ -1664,17 +1664,17 @@</span>
<a href="#l7.23"></a><span id="l7.23">           this.mTabstrip.addEventListener(&quot;underflow&quot;, this, false);</span>
<a href="#l7.24"></a><span id="l7.24">         ]]&gt;</span>
<a href="#l7.25"></a><span id="l7.25">       &lt;/constructor&gt;</span>
<a href="#l7.26"></a><span id="l7.26"> </span>
<a href="#l7.27"></a><span id="l7.27">       &lt;destructor&gt;</span>
<a href="#l7.28"></a><span id="l7.28">         &lt;![CDATA[</span>
<a href="#l7.29"></a><span id="l7.29">           var pb2 =</span>
<a href="#l7.30"></a><span id="l7.30">               Components.classes['@mozilla.org/preferences-service;1'].</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineminus">-              getService(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+              getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l7.33"></a><span id="l7.33">           pb2.removeObserver(&quot;mail.tabs.&quot;, this._prefObserver);</span>
<a href="#l7.34"></a><span id="l7.34"> </span>
<a href="#l7.35"></a><span id="l7.35">           // Release timer to avoid reference cycles.</span>
<a href="#l7.36"></a><span id="l7.36">           if (this._animateTimer) {</span>
<a href="#l7.37"></a><span id="l7.37">             this._animateTimer.cancel();</span>
<a href="#l7.38"></a><span id="l7.38">             this._animateTimer = null;</span>
<a href="#l7.39"></a><span id="l7.39">           }</span>
<a href="#l7.40"></a><span id="l7.40"> </span>
<a href="#l7.41"></a><span id="l7.41" class="difflineat">@@ -1795,17 +1795,17 @@</span>
<a href="#l7.42"></a><span id="l7.42">         </span>
<a href="#l7.43"></a><span id="l7.43">       &lt;field name=&quot;_mPrefs&quot;&gt;null&lt;/field&gt;</span>
<a href="#l7.44"></a><span id="l7.44">       &lt;property name=&quot;mPrefs&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l7.45"></a><span id="l7.45">         &lt;getter&gt;</span>
<a href="#l7.46"></a><span id="l7.46">         &lt;![CDATA[</span>
<a href="#l7.47"></a><span id="l7.47">           if (!this._mPrefs) {</span>
<a href="#l7.48"></a><span id="l7.48">             this._mPrefs =</span>
<a href="#l7.49"></a><span id="l7.49">               Components.classes['@mozilla.org/preferences-service;1'].</span>
<a href="#l7.50"></a><span id="l7.50" class="difflineminus">-              getService(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l7.51"></a><span id="l7.51" class="difflineplus">+              getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l7.52"></a><span id="l7.52">           }</span>
<a href="#l7.53"></a><span id="l7.53">           return this._mPrefs;</span>
<a href="#l7.54"></a><span id="l7.54">         ]]&gt;</span>
<a href="#l7.55"></a><span id="l7.55">         &lt;/getter&gt;</span>
<a href="#l7.56"></a><span id="l7.56">       &lt;/property&gt;</span>
<a href="#l7.57"></a><span id="l7.57">         </span>
<a href="#l7.58"></a><span id="l7.58">       &lt;method name=&quot;_handleTabSelect&quot;&gt;</span>
<a href="#l7.59"></a><span id="l7.59">         &lt;body&gt;&lt;![CDATA[</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -921,17 +921,17 @@ var directoryServerObserver = {</span>
<a href="#l8.4"></a><span id="l8.4">           // catch the exception and ignore it, so that if LDAP setup</span>
<a href="#l8.5"></a><span id="l8.5">           // fails, the entire compose window doesn't get horked</span>
<a href="#l8.6"></a><span id="l8.6">       }</span>
<a href="#l8.7"></a><span id="l8.7">   }</span>
<a href="#l8.8"></a><span id="l8.8"> }</span>
<a href="#l8.9"></a><span id="l8.9"> </span>
<a href="#l8.10"></a><span id="l8.10"> function AddDirectoryServerObserver(flag) {</span>
<a href="#l8.11"></a><span id="l8.11">   var branch = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-                         .getService(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+                         .getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l8.14"></a><span id="l8.14">   if (flag) {</span>
<a href="#l8.15"></a><span id="l8.15">     branch.addObserver(&quot;ldap_2.autoComplete.useDirectory&quot;,</span>
<a href="#l8.16"></a><span id="l8.16">                        directoryServerObserver, false);</span>
<a href="#l8.17"></a><span id="l8.17">     branch.addObserver(&quot;ldap_2.autoComplete.directoryServer&quot;,</span>
<a href="#l8.18"></a><span id="l8.18">                        directoryServerObserver, false);</span>
<a href="#l8.19"></a><span id="l8.19">   }</span>
<a href="#l8.20"></a><span id="l8.20">   else</span>
<a href="#l8.21"></a><span id="l8.21">   {</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineat">@@ -940,17 +940,17 @@ function AddDirectoryServerObserver(flag</span>
<a href="#l8.23"></a><span id="l8.23">     prefstring = &quot;mail.identity.&quot; + gCurrentIdentity.key + &quot;.directoryServer&quot;;</span>
<a href="#l8.24"></a><span id="l8.24">     branch.addObserver(prefstring, directoryServerObserver, false);</span>
<a href="#l8.25"></a><span id="l8.25">   }</span>
<a href="#l8.26"></a><span id="l8.26"> }</span>
<a href="#l8.27"></a><span id="l8.27"> </span>
<a href="#l8.28"></a><span id="l8.28"> function RemoveDirectoryServerObserver(prefstring)</span>
<a href="#l8.29"></a><span id="l8.29"> {</span>
<a href="#l8.30"></a><span id="l8.30">   var branch = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineminus">-                         .getService(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineplus">+                         .getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l8.33"></a><span id="l8.33">   if (!prefstring) {</span>
<a href="#l8.34"></a><span id="l8.34">     branch.removeObserver(&quot;ldap_2.autoComplete.useDirectory&quot;,</span>
<a href="#l8.35"></a><span id="l8.35">                           directoryServerObserver);</span>
<a href="#l8.36"></a><span id="l8.36">     branch.removeObserver(&quot;ldap_2.autoComplete.directoryServer&quot;,</span>
<a href="#l8.37"></a><span id="l8.37">                           directoryServerObserver);</span>
<a href="#l8.38"></a><span id="l8.38">   }</span>
<a href="#l8.39"></a><span id="l8.39">   else</span>
<a href="#l8.40"></a><span id="l8.40">   {</span>
<a href="#l8.41"></a><span id="l8.41" class="difflineat">@@ -959,25 +959,25 @@ function RemoveDirectoryServerObserver(p</span>
<a href="#l8.42"></a><span id="l8.42">     str = prefstring + &quot;.directoryServer&quot;;</span>
<a href="#l8.43"></a><span id="l8.43">     branch.removeObserver(str, directoryServerObserver);</span>
<a href="#l8.44"></a><span id="l8.44">   }</span>
<a href="#l8.45"></a><span id="l8.45"> }</span>
<a href="#l8.46"></a><span id="l8.46"> </span>
<a href="#l8.47"></a><span id="l8.47"> function AddDirectorySettingsObserver()</span>
<a href="#l8.48"></a><span id="l8.48"> {</span>
<a href="#l8.49"></a><span id="l8.49">   var branch = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineminus">-                         .getService(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineplus">+                         .getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l8.52"></a><span id="l8.52">   branch.addObserver(gCurrentAutocompleteDirectory, directoryServerObserver,</span>
<a href="#l8.53"></a><span id="l8.53">                      false);</span>
<a href="#l8.54"></a><span id="l8.54"> }</span>
<a href="#l8.55"></a><span id="l8.55"> </span>
<a href="#l8.56"></a><span id="l8.56"> function RemoveDirectorySettingsObserver(prefstring)</span>
<a href="#l8.57"></a><span id="l8.57"> {</span>
<a href="#l8.58"></a><span id="l8.58">   var branch = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l8.59"></a><span id="l8.59" class="difflineminus">-                         .getService(Components.interfaces.nsIPrefBranch2);</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineplus">+                         .getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l8.61"></a><span id="l8.61">   branch.removeObserver(prefstring, directoryServerObserver);</span>
<a href="#l8.62"></a><span id="l8.62"> }</span>
<a href="#l8.63"></a><span id="l8.63"> </span>
<a href="#l8.64"></a><span id="l8.64"> function setupLdapAutocompleteSession()</span>
<a href="#l8.65"></a><span id="l8.65"> {</span>
<a href="#l8.66"></a><span id="l8.66">     var autocompleteLdap = false;</span>
<a href="#l8.67"></a><span id="l8.67">     var autocompleteDirectory = null;</span>
<a href="#l8.68"></a><span id="l8.68">     var prevAutocompleteDirectory = gCurrentAutocompleteDirectory;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mail/components/preferences/applications.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mail/components/preferences/applications.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -173,17 +173,17 @@ HandlerInfoWrapper.prototype = {</span>
<a href="#l9.4"></a><span id="l9.4"> </span>
<a href="#l9.5"></a><span id="l9.5">   //**************************************************************************//</span>
<a href="#l9.6"></a><span id="l9.6">   // Convenience Utils</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8">   _handlerSvc: Components.classes[&quot;@mozilla.org/uriloader/handler-service;1&quot;]</span>
<a href="#l9.9"></a><span id="l9.9">                          .getService(Components.interfaces.nsIHandlerService),</span>
<a href="#l9.10"></a><span id="l9.10"> </span>
<a href="#l9.11"></a><span id="l9.11">   _prefSvc: Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-                      .getService(Components.interfaces.nsIPrefBranch2),</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+                      .getService(Components.interfaces.nsIPrefBranch),</span>
<a href="#l9.14"></a><span id="l9.14"> </span>
<a href="#l9.15"></a><span id="l9.15">   _categoryMgr: Components.classes[&quot;@mozilla.org/categorymanager;1&quot;]</span>
<a href="#l9.16"></a><span id="l9.16">                           .getService(Components.interfaces.nsICategoryManager),</span>
<a href="#l9.17"></a><span id="l9.17"> </span>
<a href="#l9.18"></a><span id="l9.18">   //**************************************************************************//</span>
<a href="#l9.19"></a><span id="l9.19">   // nsIHandlerInfo</span>
<a href="#l9.20"></a><span id="l9.20"> </span>
<a href="#l9.21"></a><span id="l9.21">   // The MIME type or protocol scheme.</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineat">@@ -469,17 +469,17 @@ var gApplicationsPane = {</span>
<a href="#l9.23"></a><span id="l9.23"> </span>
<a href="#l9.24"></a><span id="l9.24">   // These get defined by init().</span>
<a href="#l9.25"></a><span id="l9.25">   _brandShortName : null,</span>
<a href="#l9.26"></a><span id="l9.26">   _prefsBundle    : null,</span>
<a href="#l9.27"></a><span id="l9.27">   _list           : null,</span>
<a href="#l9.28"></a><span id="l9.28">   _filter         : null,</span>
<a href="#l9.29"></a><span id="l9.29"> </span>
<a href="#l9.30"></a><span id="l9.30">   _prefSvc      : Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineminus">-                            .getService(Components.interfaces.nsIPrefBranch2),</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineplus">+                            .getService(Components.interfaces.nsIPrefBranch),</span>
<a href="#l9.33"></a><span id="l9.33"> </span>
<a href="#l9.34"></a><span id="l9.34">   _mimeSvc      : Components.classes[&quot;@mozilla.org/mime;1&quot;]</span>
<a href="#l9.35"></a><span id="l9.35">                             .getService(Components.interfaces.nsIMIMEService),</span>
<a href="#l9.36"></a><span id="l9.36"> </span>
<a href="#l9.37"></a><span id="l9.37">   _helperAppSvc : Components.classes[&quot;@mozilla.org/uriloader/external-helper-app-service;1&quot;]</span>
<a href="#l9.38"></a><span id="l9.38">                             .getService(Components.interfaces.nsIExternalHelperAppService),</span>
<a href="#l9.39"></a><span id="l9.39"> </span>
<a href="#l9.40"></a><span id="l9.40">   _handlerSvc   : Components.classes[&quot;@mozilla.org/uriloader/handler-service;1&quot;]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mail/components/search/content/searchCommon.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mail/components/search/content/searchCommon.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -101,18 +101,17 @@ let SearchSupport =</span>
<a href="#l10.4"></a><span id="l10.4"> </span>
<a href="#l10.5"></a><span id="l10.5">   /// The preferences branch to use</span>
<a href="#l10.6"></a><span id="l10.6">   __prefBranch: null,</span>
<a href="#l10.7"></a><span id="l10.7">   get _prefBranch()</span>
<a href="#l10.8"></a><span id="l10.8">   {</span>
<a href="#l10.9"></a><span id="l10.9">     if (!this.__prefBranch)</span>
<a href="#l10.10"></a><span id="l10.10">       this.__prefBranch = Cc[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l10.11"></a><span id="l10.11">                             .getService(Ci.nsIPrefService)</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-                            .getBranch(this._prefBase)</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-                            .QueryInterface(Ci.nsIPrefBranch2);</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+                            .getBranch(this._prefBase);</span>
<a href="#l10.15"></a><span id="l10.15">     return this.__prefBranch;</span>
<a href="#l10.16"></a><span id="l10.16">   },</span>
<a href="#l10.17"></a><span id="l10.17"> </span>
<a href="#l10.18"></a><span id="l10.18">   /**</span>
<a href="#l10.19"></a><span id="l10.19">    * If this is true, we won't show any UI because the OS doesn't have the</span>
<a href="#l10.20"></a><span id="l10.20">    * support we need</span>
<a href="#l10.21"></a><span id="l10.21">    */</span>
<a href="#l10.22"></a><span id="l10.22">   osVersionTooLow: false,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mail/components/wintaskbar/windowsJumpLists.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mail/components/wintaskbar/windowsJumpLists.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -61,18 +61,17 @@ XPCOMUtils.defineLazyServiceGetter(this,</span>
<a href="#l11.4"></a><span id="l11.4">                                    &quot;@mozilla.org/windows-taskbar;1&quot;,</span>
<a href="#l11.5"></a><span id="l11.5">                                    &quot;nsIWinTaskbar&quot;);</span>
<a href="#l11.6"></a><span id="l11.6"> </span>
<a href="#l11.7"></a><span id="l11.7"> XPCOMUtils.defineLazyServiceGetter(this, &quot;_winShellService&quot;,</span>
<a href="#l11.8"></a><span id="l11.8">                                    &quot;@mozilla.org/mail/shell-service;1&quot;,</span>
<a href="#l11.9"></a><span id="l11.9">                                    &quot;nsIWindowsShellService&quot;);</span>
<a href="#l11.10"></a><span id="l11.10"> </span>
<a href="#l11.11"></a><span id="l11.11"> XPCOMUtils.defineLazyGetter(this, &quot;_prefs&quot;, function() {</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-  return Services.prefs.getBranch(PREF_TASKBAR_BRANCH)</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-                       .QueryInterface(Ci.nsIPrefBranch2);</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineplus">+  return Services.prefs.getBranch(PREF_TASKBAR_BRANCH);</span>
<a href="#l11.15"></a><span id="l11.15"> });</span>
<a href="#l11.16"></a><span id="l11.16"> </span>
<a href="#l11.17"></a><span id="l11.17"> function _getString(aName) {</span>
<a href="#l11.18"></a><span id="l11.18">   return _stringBundle.GetStringFromName(aName);</span>
<a href="#l11.19"></a><span id="l11.19"> }</span>
<a href="#l11.20"></a><span id="l11.20"> </span>
<a href="#l11.21"></a><span id="l11.21"> /**</span>
<a href="#l11.22"></a><span id="l11.22">  * Task list</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

