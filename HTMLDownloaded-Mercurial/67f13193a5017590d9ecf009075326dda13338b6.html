<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 781:67f13193a5017590d9ecf009075326dda13338b6</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 67f13193a5017590d9ecf009075326dda13338b6" />
<meta property="og:url" content="/comm-central/rev/67f13193a5017590d9ecf009075326dda13338b6" />
<meta property="og:description" content="Bug 461136 - &lt;video&gt; context menu for SeaMonkey; r+sr=neil" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 67f13193a5017590d9ecf009075326dda13338b6 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/67f13193a5017590d9ecf009075326dda13338b6">shortlog</a> |
<a href="/comm-central/log/67f13193a5017590d9ecf009075326dda13338b6">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/67f13193a5017590d9ecf009075326dda13338b6">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/67f13193a5017590d9ecf009075326dda13338b6">files</a> |
changeset |
<a href="/comm-central/raw-rev/67f13193a5017590d9ecf009075326dda13338b6">raw</a>  | <a href="/comm-central/archive/67f13193a5017590d9ecf009075326dda13338b6.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=461136">Bug 461136</a> - &lt;video&gt; context menu for SeaMonkey; r+sr=neil
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#78;&#101;&#117;&#111;&#115;&#32;&#60;&#110;&#101;&#117;&#111;&#115;&#64;&#116;&#101;&#99;&#104;&#110;&#111;&#100;&#114;&#111;&#109;&#101;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Sat, 01 Nov 2008 01:15:19 +0100</td></tr>

<tr>
 <td>changeset 781</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/67f13193a5017590d9ecf009075326dda13338b6">67f13193a5017590d9ecf009075326dda13338b6</a></td>
</tr>



<tr>
<td>parent 780</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/47a9189abb800bb7a6d9a07bab89146e64e0539b">47a9189abb800bb7a6d9a07bab89146e64e0539b</a>
</td>
</tr>

<tr>
<td>child 782</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/3dd34f4ecbbefc38909055867cbc1208af02d638">3dd34f4ecbbefc38909055867cbc1208af02d638</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=67f13193a5017590d9ecf009075326dda13338b6">706</a></td></tr>
<tr><td>push user</td><td>sgautherie.bz@free.fr</td></tr>
<tr><td>push date</td><td class="date age">Sat, 01 Nov 2008 00:15:41 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@67f13193a501 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=67f13193a5017590d9ecf009075326dda13338b6">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=67f13193a5017590d9ecf009075326dda13338b6&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=67f13193a5017590d9ecf009075326dda13338b6&newProject=comm-central&newRevision=67f13193a5017590d9ecf009075326dda13338b6&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=67f13193a5017590d9ecf009075326dda13338b6&newProject=comm-central&newRevision=67f13193a5017590d9ecf009075326dda13338b6&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=67f13193a5017590d9ecf009075326dda13338b6&newProject=comm-central&newRevision=67f13193a5017590d9ecf009075326dda13338b6&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>

<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=461136">461136</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=461136">Bug 461136</a> - &lt;video&gt; context menu for SeaMonkey; r+sr=neil</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/67f13193a5017590d9ecf009075326dda13338b6/suite/browser/mailNavigatorOverlay.xul">suite/browser/mailNavigatorOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/67f13193a5017590d9ecf009075326dda13338b6/suite/browser/mailNavigatorOverlay.xul">file</a> |
<a href="/comm-central/annotate/67f13193a5017590d9ecf009075326dda13338b6/suite/browser/mailNavigatorOverlay.xul">annotate</a> |
<a href="/comm-central/diff/67f13193a5017590d9ecf009075326dda13338b6/suite/browser/mailNavigatorOverlay.xul">diff</a> |
<a href="/comm-central/comparison/67f13193a5017590d9ecf009075326dda13338b6/suite/browser/mailNavigatorOverlay.xul">comparison</a> |
<a href="/comm-central/log/67f13193a5017590d9ecf009075326dda13338b6/suite/browser/mailNavigatorOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/67f13193a5017590d9ecf009075326dda13338b6/suite/common/contentAreaContextOverlay.xul">suite/common/contentAreaContextOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/67f13193a5017590d9ecf009075326dda13338b6/suite/common/contentAreaContextOverlay.xul">file</a> |
<a href="/comm-central/annotate/67f13193a5017590d9ecf009075326dda13338b6/suite/common/contentAreaContextOverlay.xul">annotate</a> |
<a href="/comm-central/diff/67f13193a5017590d9ecf009075326dda13338b6/suite/common/contentAreaContextOverlay.xul">diff</a> |
<a href="/comm-central/comparison/67f13193a5017590d9ecf009075326dda13338b6/suite/common/contentAreaContextOverlay.xul">comparison</a> |
<a href="/comm-central/log/67f13193a5017590d9ecf009075326dda13338b6/suite/common/contentAreaContextOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/67f13193a5017590d9ecf009075326dda13338b6/suite/common/nsContextMenu.js">suite/common/nsContextMenu.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/67f13193a5017590d9ecf009075326dda13338b6/suite/common/nsContextMenu.js">file</a> |
<a href="/comm-central/annotate/67f13193a5017590d9ecf009075326dda13338b6/suite/common/nsContextMenu.js">annotate</a> |
<a href="/comm-central/diff/67f13193a5017590d9ecf009075326dda13338b6/suite/common/nsContextMenu.js">diff</a> |
<a href="/comm-central/comparison/67f13193a5017590d9ecf009075326dda13338b6/suite/common/nsContextMenu.js">comparison</a> |
<a href="/comm-central/log/67f13193a5017590d9ecf009075326dda13338b6/suite/common/nsContextMenu.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/67f13193a5017590d9ecf009075326dda13338b6/suite/common/permissions/imageContextOverlay.xul">suite/common/permissions/imageContextOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/67f13193a5017590d9ecf009075326dda13338b6/suite/common/permissions/imageContextOverlay.xul">file</a> |
<a href="/comm-central/annotate/67f13193a5017590d9ecf009075326dda13338b6/suite/common/permissions/imageContextOverlay.xul">annotate</a> |
<a href="/comm-central/diff/67f13193a5017590d9ecf009075326dda13338b6/suite/common/permissions/imageContextOverlay.xul">diff</a> |
<a href="/comm-central/comparison/67f13193a5017590d9ecf009075326dda13338b6/suite/common/permissions/imageContextOverlay.xul">comparison</a> |
<a href="/comm-central/log/67f13193a5017590d9ecf009075326dda13338b6/suite/common/permissions/imageContextOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/browser/mailNavigatorOverlay.dtd">suite/locales/en-US/chrome/browser/mailNavigatorOverlay.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/browser/mailNavigatorOverlay.dtd">file</a> |
<a href="/comm-central/annotate/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/browser/mailNavigatorOverlay.dtd">annotate</a> |
<a href="/comm-central/diff/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/browser/mailNavigatorOverlay.dtd">diff</a> |
<a href="/comm-central/comparison/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/browser/mailNavigatorOverlay.dtd">comparison</a> |
<a href="/comm-central/log/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/browser/mailNavigatorOverlay.dtd">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/common/contentAreaCommands.dtd">suite/locales/en-US/chrome/common/contentAreaCommands.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/common/contentAreaCommands.dtd">file</a> |
<a href="/comm-central/annotate/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/common/contentAreaCommands.dtd">annotate</a> |
<a href="/comm-central/diff/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/common/contentAreaCommands.dtd">diff</a> |
<a href="/comm-central/comparison/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/common/contentAreaCommands.dtd">comparison</a> |
<a href="/comm-central/log/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/common/contentAreaCommands.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/common/contentAreaCommands.properties">suite/locales/en-US/chrome/common/contentAreaCommands.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/common/contentAreaCommands.properties">file</a> |
<a href="/comm-central/annotate/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/common/contentAreaCommands.properties">annotate</a> |
<a href="/comm-central/diff/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/common/contentAreaCommands.properties">diff</a> |
<a href="/comm-central/comparison/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/common/contentAreaCommands.properties">comparison</a> |
<a href="/comm-central/log/67f13193a5017590d9ecf009075326dda13338b6/suite/locales/en-US/chrome/common/contentAreaCommands.properties">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/suite/browser/mailNavigatorOverlay.xul</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/suite/browser/mailNavigatorOverlay.xul</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -110,39 +110,39 @@</span>
<a href="#l1.4"></a><span id="l1.4">         aURL = window.content.document.URL;</span>
<a href="#l1.5"></a><span id="l1.5">         title = window.content.document.title;</span>
<a href="#l1.6"></a><span id="l1.6">       }</span>
<a href="#l1.7"></a><span id="l1.7">       try {</span>
<a href="#l1.8"></a><span id="l1.8">         openComposeWindow(aURL, title, 0, null);</span>
<a href="#l1.9"></a><span id="l1.9">       } catch(ex) { dump(&quot;Cannot Send Link: &quot; + ex + &quot;\n&quot;); }</span>
<a href="#l1.10"></a><span id="l1.10">     }</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-    function sendImage(imageURL)</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    function sendMedia(mediaURL)</span>
<a href="#l1.14"></a><span id="l1.14">     {</span>
<a href="#l1.15"></a><span id="l1.15">       try {</span>
<a href="#l1.16"></a><span id="l1.16">         var charset =  getCharsetforSave(null);</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineminus">-        openComposeWindow(imageURL, null, 2, charset);</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineminus">-      } catch(ex) { dump(&quot;Cannot Send Image: &quot; + ex + &quot;\n&quot;); }</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineplus">+        openComposeWindow(mediaURL, null, 2, charset);</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineplus">+      } catch(ex) { dump(&quot;Cannot Send Media: &quot; + ex + &quot;\n&quot;); }</span>
<a href="#l1.21"></a><span id="l1.21">     }</span>
<a href="#l1.22"></a><span id="l1.22"> </span>
<a href="#l1.23"></a><span id="l1.23">     function sendPage(aDocument)</span>
<a href="#l1.24"></a><span id="l1.24">     {</span>
<a href="#l1.25"></a><span id="l1.25">       if (!aDocument)</span>
<a href="#l1.26"></a><span id="l1.26">         aDocument = window.content.document;</span>
<a href="#l1.27"></a><span id="l1.27">         </span>
<a href="#l1.28"></a><span id="l1.28">       try {</span>
<a href="#l1.29"></a><span id="l1.29">         var charset = getCharsetforSave(aDocument);</span>
<a href="#l1.30"></a><span id="l1.30">         openComposeWindow(aDocument.URL, aDocument.title, 1, charset);</span>
<a href="#l1.31"></a><span id="l1.31">       } catch(ex) { dump(&quot;Cannot Send Page: &quot; + ex + &quot;\n&quot;); }</span>
<a href="#l1.32"></a><span id="l1.32">     }</span>
<a href="#l1.33"></a><span id="l1.33"> </span>
<a href="#l1.34"></a><span id="l1.34">     function initMailContextMenuItems(aEvent)</span>
<a href="#l1.35"></a><span id="l1.35">     {</span>
<a href="#l1.36"></a><span id="l1.36" class="difflineminus">-      var shouldShowSendPage = !(gContextMenu.onTextInput || </span>
<a href="#l1.37"></a><span id="l1.37" class="difflineminus">-                               gContextMenu.isContentSelected) &amp;&amp; </span>
<a href="#l1.38"></a><span id="l1.38" class="difflineplus">+      var shouldShowSendPage = !(gContextMenu.onTextInput || gContextMenu.isContentSelected ||</span>
<a href="#l1.39"></a><span id="l1.39" class="difflineplus">+                               gContextMenu.onVideo || gContextMenu.onAudio) &amp;&amp;</span>
<a href="#l1.40"></a><span id="l1.40">                                !(gContextMenu.onLink &amp;&amp; gContextMenu.onImage) &amp;&amp;</span>
<a href="#l1.41"></a><span id="l1.41">                                gHasIntegratedMailClient;</span>
<a href="#l1.42"></a><span id="l1.42">       gContextMenu.showItem(&quot;context-sendpage&quot;, shouldShowSendPage);</span>
<a href="#l1.43"></a><span id="l1.43">    </span>
<a href="#l1.44"></a><span id="l1.44">       gContextMenu.showItem(&quot;context-sep-apps&quot;, gContextMenu.shouldShowSeparator(&quot;context-sep-apps&quot;));</span>
<a href="#l1.45"></a><span id="l1.45">     }</span>
<a href="#l1.46"></a><span id="l1.46">       </span>
<a href="#l1.47"></a><span id="l1.47">     function initMailContextMenuPopupListener(aEvent)</span>
<a href="#l1.48"></a><span id="l1.48" class="difflineat">@@ -211,18 +211,28 @@</span>
<a href="#l1.49"></a><span id="l1.49">     &lt;menuitem id=&quot;context-sendpage&quot;</span>
<a href="#l1.50"></a><span id="l1.50">               label=&quot;&amp;contextSendThisPage.label;&quot;</span>
<a href="#l1.51"></a><span id="l1.51">               accesskey=&quot;&amp;contextSendThisPage.accesskey;&quot;</span>
<a href="#l1.52"></a><span id="l1.52">               oncommand=&quot;sendPage();&quot;</span>
<a href="#l1.53"></a><span id="l1.53">               insertafter=&quot;context-savepage&quot;/&gt;</span>
<a href="#l1.54"></a><span id="l1.54">     &lt;menuitem id=&quot;context-sendimage&quot;</span>
<a href="#l1.55"></a><span id="l1.55">               label=&quot;&amp;contextSendImage.label;&quot;</span>
<a href="#l1.56"></a><span id="l1.56">               accesskey=&quot;&amp;contextSendImage.accesskey;&quot;</span>
<a href="#l1.57"></a><span id="l1.57" class="difflineminus">-              oncommand=&quot;sendImage(gContextMenu.imageURL);&quot;</span>
<a href="#l1.58"></a><span id="l1.58" class="difflineplus">+              oncommand=&quot;sendMedia(gContextMenu.mediaURL);&quot;</span>
<a href="#l1.59"></a><span id="l1.59">               insertafter=&quot;context-saveimage&quot;/&gt;</span>
<a href="#l1.60"></a><span id="l1.60" class="difflineplus">+    &lt;menuitem id=&quot;context-sendvideo&quot;</span>
<a href="#l1.61"></a><span id="l1.61" class="difflineplus">+              label=&quot;&amp;contextSendVideo.label;&quot;</span>
<a href="#l1.62"></a><span id="l1.62" class="difflineplus">+              accesskey=&quot;&amp;contextSendVideo.accesskey;&quot;</span>
<a href="#l1.63"></a><span id="l1.63" class="difflineplus">+              oncommand=&quot;sendMedia(gContextMenu.mediaURL);&quot;</span>
<a href="#l1.64"></a><span id="l1.64" class="difflineplus">+              insertafter=&quot;context-savevideo&quot;/&gt;</span>
<a href="#l1.65"></a><span id="l1.65" class="difflineplus">+    &lt;menuitem id=&quot;context-sendaudio&quot;</span>
<a href="#l1.66"></a><span id="l1.66" class="difflineplus">+              label=&quot;&amp;contextSendAudio.label;&quot;</span>
<a href="#l1.67"></a><span id="l1.67" class="difflineplus">+              accesskey=&quot;&amp;contextSendAudio.accesskey;&quot;</span>
<a href="#l1.68"></a><span id="l1.68" class="difflineplus">+              oncommand=&quot;sendMedia(gContextMenu.mediaURL);&quot;</span>
<a href="#l1.69"></a><span id="l1.69" class="difflineplus">+              insertafter=&quot;context-saveaudio&quot;/&gt;</span>
<a href="#l1.70"></a><span id="l1.70">     &lt;menuitem id=&quot;context-sendlink&quot;</span>
<a href="#l1.71"></a><span id="l1.71">               label=&quot;&amp;contextSendThisLink.label;&quot;</span>
<a href="#l1.72"></a><span id="l1.72">               accesskey=&quot;&amp;contextSendThisLink.accesskey;&quot;</span>
<a href="#l1.73"></a><span id="l1.73">               oncommand=&quot;sendLink(gContextMenu.linkURL());&quot;</span>
<a href="#l1.74"></a><span id="l1.74">               insertafter=&quot;context-savelink&quot;/&gt;</span>
<a href="#l1.75"></a><span id="l1.75">     &lt;menu id=&quot;frame&quot;&gt;</span>
<a href="#l1.76"></a><span id="l1.76">     &lt;menupopup id=&quot;frame_popup&quot;&gt;</span>
<a href="#l1.77"></a><span id="l1.77">       &lt;menuitem insertafter=&quot;saveframeas&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/suite/common/contentAreaContextOverlay.xul</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/suite/common/contentAreaContextOverlay.xul</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -107,43 +107,84 @@</span>
<a href="#l2.4"></a><span id="l2.4">                 label=&quot;&amp;copyEmailCmd.label;&quot;</span>
<a href="#l2.5"></a><span id="l2.5">                 accesskey=&quot;&amp;copyEmailCmd.accesskey;&quot;</span>
<a href="#l2.6"></a><span id="l2.6">                 oncommand=&quot;gContextMenu.copyEmail();&quot;/&gt;</span>
<a href="#l2.7"></a><span id="l2.7">       &lt;menuitem id=&quot;context-copylink&quot;</span>
<a href="#l2.8"></a><span id="l2.8">                 label=&quot;&amp;copyLinkCmd.label;&quot;</span>
<a href="#l2.9"></a><span id="l2.9">                 accesskey=&quot;&amp;copyLinkCmd.accesskey;&quot;</span>
<a href="#l2.10"></a><span id="l2.10">                 command=&quot;cmd_copyLink&quot;/&gt;</span>
<a href="#l2.11"></a><span id="l2.11">       &lt;menuseparator id=&quot;context-sep-copylink&quot;/&gt;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+      &lt;menuitem id=&quot;context-media-play&quot;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+                label=&quot;&amp;mediaPlay.label;&quot;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+                accesskey=&quot;&amp;mediaPlay.accesskey;&quot;</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+                oncommand=&quot;gContextMenu.mediaCommand('play');&quot;/&gt;</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+      &lt;menuitem id=&quot;context-media-pause&quot;</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+                label=&quot;&amp;mediaPause.label;&quot;</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineplus">+                accesskey=&quot;&amp;mediaPause.accesskey;&quot;</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+                oncommand=&quot;gContextMenu.mediaCommand('pause');&quot;/&gt;</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineplus">+      &lt;menuitem id=&quot;context-media-mute&quot;</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineplus">+                label=&quot;&amp;mediaMute.label;&quot;</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineplus">+                accesskey=&quot;&amp;mediaMute.accesskey;&quot;</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineplus">+                oncommand=&quot;gContextMenu.mediaCommand('mute');&quot;/&gt;</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineplus">+      &lt;menuitem id=&quot;context-media-unmute&quot;</span>
<a href="#l2.25"></a><span id="l2.25" class="difflineplus">+                label=&quot;&amp;mediaUnmute.label;&quot;</span>
<a href="#l2.26"></a><span id="l2.26" class="difflineplus">+                accesskey=&quot;&amp;mediaUnmute.accesskey;&quot;</span>
<a href="#l2.27"></a><span id="l2.27" class="difflineplus">+                oncommand=&quot;gContextMenu.mediaCommand('unmute');&quot;/&gt;</span>
<a href="#l2.28"></a><span id="l2.28" class="difflineplus">+      &lt;menuitem id=&quot;context-media-showcontrols&quot;</span>
<a href="#l2.29"></a><span id="l2.29" class="difflineplus">+                label=&quot;&amp;mediaShowControls.label;&quot;</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineplus">+                accesskey=&quot;&amp;mediaShowControls.accesskey;&quot;</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineplus">+                oncommand=&quot;gContextMenu.mediaCommand('showcontrols');&quot;/&gt;</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+      &lt;menuitem id=&quot;context-media-hidecontrols&quot;</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineplus">+                label=&quot;&amp;mediaHideControls.label;&quot;</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineplus">+                accesskey=&quot;&amp;mediaHideControls.accesskey;&quot;</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineplus">+                oncommand=&quot;gContextMenu.mediaCommand('hidecontrols');&quot;/&gt;</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineplus">+      &lt;menuseparator id=&quot;context-media-sep-commands&quot;/&gt;</span>
<a href="#l2.37"></a><span id="l2.37">       &lt;menuitem id=&quot;context-fitimage&quot;</span>
<a href="#l2.38"></a><span id="l2.38">                 type=&quot;checkbox&quot;</span>
<a href="#l2.39"></a><span id="l2.39">                 label=&quot;&amp;fitImageCmd.label;&quot;</span>
<a href="#l2.40"></a><span id="l2.40">                 accesskey=&quot;&amp;fitImageCmd.accesskey;&quot;</span>
<a href="#l2.41"></a><span id="l2.41">                 oncommand=&quot;gContextMenu.toggleImageSize();&quot;/&gt;</span>
<a href="#l2.42"></a><span id="l2.42">       &lt;menuitem id=&quot;context-reloadimage&quot;</span>
<a href="#l2.43"></a><span id="l2.43">                 label=&quot;&amp;reloadImageCmd.label;&quot;</span>
<a href="#l2.44"></a><span id="l2.44">                 accesskey=&quot;&amp;reloadImageCmd.accesskey;&quot;</span>
<a href="#l2.45"></a><span id="l2.45">                 oncommand=&quot;gContextMenu.reloadImage();&quot;/&gt;</span>
<a href="#l2.46"></a><span id="l2.46">       &lt;menuitem id=&quot;context-viewimage&quot;</span>
<a href="#l2.47"></a><span id="l2.47">                 label=&quot;&amp;viewImageCmd.label;&quot;</span>
<a href="#l2.48"></a><span id="l2.48">                 accesskey=&quot;&amp;viewImageCmd.accesskey;&quot;</span>
<a href="#l2.49"></a><span id="l2.49" class="difflineminus">-                oncommand=&quot;gContextMenu.viewImage();&quot;/&gt;</span>
<a href="#l2.50"></a><span id="l2.50" class="difflineplus">+                oncommand=&quot;gContextMenu.viewMedia();&quot;/&gt;</span>
<a href="#l2.51"></a><span id="l2.51">       &lt;menuitem id=&quot;context-copyimage&quot;</span>
<a href="#l2.52"></a><span id="l2.52">                 label=&quot;&amp;copyImageCmd.label;&quot;</span>
<a href="#l2.53"></a><span id="l2.53">                 accesskey=&quot;&amp;copyImageCmd.accesskey;&quot;</span>
<a href="#l2.54"></a><span id="l2.54">                 command=&quot;cmd_copyImage&quot;/&gt;</span>
<a href="#l2.55"></a><span id="l2.55" class="difflineplus">+      &lt;menuitem id=&quot;context-copyvideourl&quot;</span>
<a href="#l2.56"></a><span id="l2.56" class="difflineplus">+                label=&quot;&amp;copyVideoURLCmd.label;&quot;</span>
<a href="#l2.57"></a><span id="l2.57" class="difflineplus">+                accesskey=&quot;&amp;copyVideoURLCmd.accesskey;&quot;</span>
<a href="#l2.58"></a><span id="l2.58" class="difflineplus">+                oncommand=&quot;gContextMenu.copyMediaLocation();&quot;/&gt;</span>
<a href="#l2.59"></a><span id="l2.59" class="difflineplus">+      &lt;menuitem id=&quot;context-copyaudiourl&quot;</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineplus">+                label=&quot;&amp;copyAudioURLCmd.label;&quot;</span>
<a href="#l2.61"></a><span id="l2.61" class="difflineplus">+                accesskey=&quot;&amp;copyAudioURLCmd.accesskey;&quot;</span>
<a href="#l2.62"></a><span id="l2.62" class="difflineplus">+                oncommand=&quot;gContextMenu.copyMediaLocation();&quot;/&gt;</span>
<a href="#l2.63"></a><span id="l2.63">       &lt;menuseparator id=&quot;context-sep-copyimage&quot;/&gt;</span>
<a href="#l2.64"></a><span id="l2.64">       &lt;menuitem id=&quot;context-saveimage&quot;</span>
<a href="#l2.65"></a><span id="l2.65">                 valueSaveAs=&quot;&amp;saveImageAsCmd.label;&quot;</span>
<a href="#l2.66"></a><span id="l2.66">                 valueSave=&quot;&amp;saveImageCmd.label;&quot;</span>
<a href="#l2.67"></a><span id="l2.67">                 accesskey=&quot;&amp;saveImageCmd.accesskey;&quot;</span>
<a href="#l2.68"></a><span id="l2.68" class="difflineminus">-                oncommand=&quot;gContextMenu.saveImage();&quot;/&gt;</span>
<a href="#l2.69"></a><span id="l2.69" class="difflineplus">+                oncommand=&quot;gContextMenu.saveMedia();&quot;/&gt;</span>
<a href="#l2.70"></a><span id="l2.70">       &lt;menuitem id=&quot;context-setWallpaper&quot;</span>
<a href="#l2.71"></a><span id="l2.71">                 label=&quot;&amp;setWallpaperCmd.label;&quot;</span>
<a href="#l2.72"></a><span id="l2.72">                 accesskey=&quot;&amp;setWallpaperCmd.accesskey;&quot;</span>
<a href="#l2.73"></a><span id="l2.73">                 oncommand=&quot;gContextMenu.setWallpaper();&quot;/&gt;</span>
<a href="#l2.74"></a><span id="l2.74" class="difflineplus">+      &lt;menuitem id=&quot;context-savevideo&quot;</span>
<a href="#l2.75"></a><span id="l2.75" class="difflineplus">+                label=&quot;&amp;saveVideoCmd.label;&quot;</span>
<a href="#l2.76"></a><span id="l2.76" class="difflineplus">+                accesskey=&quot;&amp;saveVideoCmd.accesskey;&quot;</span>
<a href="#l2.77"></a><span id="l2.77" class="difflineplus">+                oncommand=&quot;gContextMenu.saveMedia();&quot;/&gt;</span>
<a href="#l2.78"></a><span id="l2.78" class="difflineplus">+      &lt;menuitem id=&quot;context-saveaudio&quot;</span>
<a href="#l2.79"></a><span id="l2.79" class="difflineplus">+                label=&quot;&amp;saveAudioCmd.label;&quot;</span>
<a href="#l2.80"></a><span id="l2.80" class="difflineplus">+                accesskey=&quot;&amp;saveAudioCmd.accesskey;&quot;</span>
<a href="#l2.81"></a><span id="l2.81" class="difflineplus">+                oncommand=&quot;gContextMenu.saveMedia();&quot;/&gt;</span>
<a href="#l2.82"></a><span id="l2.82">       &lt;menuseparator id=&quot;context-sep-image&quot;/&gt;</span>
<a href="#l2.83"></a><span id="l2.83">       &lt;menuitem id=&quot;context-back&quot;</span>
<a href="#l2.84"></a><span id="l2.84">                 label=&quot;&amp;goBackCmd.label;&quot;</span>
<a href="#l2.85"></a><span id="l2.85">                 accesskey=&quot;&amp;goBackCmd.accesskey;&quot;</span>
<a href="#l2.86"></a><span id="l2.86">                 oncommand=&quot;BrowserBack()&quot;/&gt;</span>
<a href="#l2.87"></a><span id="l2.87">       &lt;menuitem id=&quot;context-forward&quot;</span>
<a href="#l2.88"></a><span id="l2.88">                 label=&quot;&amp;goForwardCmd.label;&quot;</span>
<a href="#l2.89"></a><span id="l2.89">                 accesskey=&quot;&amp;goForwardCmd.accesskey;&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/suite/common/nsContextMenu.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/suite/common/nsContextMenu.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -52,16 +52,18 @@</span>
<a href="#l3.4"></a><span id="l3.4"> function nsContextMenu( xulMenu ) {</span>
<a href="#l3.5"></a><span id="l3.5">     this.target            = null;</span>
<a href="#l3.6"></a><span id="l3.6">     this.menu              = null;</span>
<a href="#l3.7"></a><span id="l3.7">     this.popupURL          = null;</span>
<a href="#l3.8"></a><span id="l3.8">     this.onTextInput       = false;</span>
<a href="#l3.9"></a><span id="l3.9">     this.onImage           = false;</span>
<a href="#l3.10"></a><span id="l3.10">     this.onLoadedImage     = false;</span>
<a href="#l3.11"></a><span id="l3.11">     this.onCanvas          = false;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+    this.onVideo           = false;</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+    this.onAudio           = false;</span>
<a href="#l3.14"></a><span id="l3.14">     this.onLink            = false;</span>
<a href="#l3.15"></a><span id="l3.15">     this.onMailtoLink      = false;</span>
<a href="#l3.16"></a><span id="l3.16">     this.onSaveableLink    = false;</span>
<a href="#l3.17"></a><span id="l3.17">     this.onMetaDataItem    = false;</span>
<a href="#l3.18"></a><span id="l3.18">     this.onMathML          = false;</span>
<a href="#l3.19"></a><span id="l3.19">     this.link              = false;</span>
<a href="#l3.20"></a><span id="l3.20">     this.inFrame           = false;</span>
<a href="#l3.21"></a><span id="l3.21">     this.hasBGImage        = false;</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineat">@@ -106,16 +108,17 @@ nsContextMenu.prototype = {</span>
<a href="#l3.23"></a><span id="l3.23">         this.initOpenItems();</span>
<a href="#l3.24"></a><span id="l3.24">         this.initNavigationItems();</span>
<a href="#l3.25"></a><span id="l3.25">         this.initViewItems();</span>
<a href="#l3.26"></a><span id="l3.26">         this.initMiscItems();</span>
<a href="#l3.27"></a><span id="l3.27">         this.initSpellingItems();</span>
<a href="#l3.28"></a><span id="l3.28">         this.initSaveItems();</span>
<a href="#l3.29"></a><span id="l3.29">         this.initClipboardItems();</span>
<a href="#l3.30"></a><span id="l3.30">         this.initMetadataItems();</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineplus">+        this.initMediaPlayerItems();</span>
<a href="#l3.32"></a><span id="l3.32">     },</span>
<a href="#l3.33"></a><span id="l3.33">     initOpenItems : function () {</span>
<a href="#l3.34"></a><span id="l3.34">         var showOpen = this.onSaveableLink || ( this.inDirList &amp;&amp; this.onLink );</span>
<a href="#l3.35"></a><span id="l3.35"> </span>
<a href="#l3.36"></a><span id="l3.36">         this.showItem( &quot;context-openlink&quot;, showOpen );</span>
<a href="#l3.37"></a><span id="l3.37">         this.showItem( &quot;context-openlinkintab&quot;, showOpen );</span>
<a href="#l3.38"></a><span id="l3.38"> </span>
<a href="#l3.39"></a><span id="l3.39">         this.showItem( &quot;context-sep-open&quot;, showOpen );</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineat">@@ -123,61 +126,68 @@ nsContextMenu.prototype = {</span>
<a href="#l3.41"></a><span id="l3.41">     initNavigationItems : function () {</span>
<a href="#l3.42"></a><span id="l3.42">         // Back determined by canGoBack broadcaster.</span>
<a href="#l3.43"></a><span id="l3.43">         this.setItemAttrFromNode( &quot;context-back&quot;, &quot;disabled&quot;, &quot;canGoBack&quot; );</span>
<a href="#l3.44"></a><span id="l3.44"> </span>
<a href="#l3.45"></a><span id="l3.45">         // Forward determined by canGoForward broadcaster.</span>
<a href="#l3.46"></a><span id="l3.46">         this.setItemAttrFromNode( &quot;context-forward&quot;, &quot;disabled&quot;, &quot;canGoForward&quot; );</span>
<a href="#l3.47"></a><span id="l3.47"> </span>
<a href="#l3.48"></a><span id="l3.48">         var showNav = !( this.isContentSelected || this.onLink || this.onImage ||</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineminus">-                         this.onCanvas || this.onTextInput );</span>
<a href="#l3.50"></a><span id="l3.50" class="difflineplus">+                         this.onCanvas || this.onVideo || this.onAudio || this.onTextInput );</span>
<a href="#l3.51"></a><span id="l3.51">         </span>
<a href="#l3.52"></a><span id="l3.52">         this.showItem( &quot;context-back&quot;, showNav );</span>
<a href="#l3.53"></a><span id="l3.53">         this.showItem( &quot;context-forward&quot;, showNav );</span>
<a href="#l3.54"></a><span id="l3.54"> </span>
<a href="#l3.55"></a><span id="l3.55">         this.showItem( &quot;context-reload&quot;, showNav );</span>
<a href="#l3.56"></a><span id="l3.56">         </span>
<a href="#l3.57"></a><span id="l3.57">         this.showItem( &quot;context-stop&quot;, showNav );</span>
<a href="#l3.58"></a><span id="l3.58">         this.showItem( &quot;context-sep-stop&quot;, showNav );</span>
<a href="#l3.59"></a><span id="l3.59"> </span>
<a href="#l3.60"></a><span id="l3.60">         // XXX: Stop is determined in navigator.js; the canStop broadcaster is broken</span>
<a href="#l3.61"></a><span id="l3.61">         //this.setItemAttrFromNode( &quot;context-stop&quot;, &quot;disabled&quot;, &quot;canStop&quot; );</span>
<a href="#l3.62"></a><span id="l3.62">     },</span>
<a href="#l3.63"></a><span id="l3.63">     initSaveItems : function () {</span>
<a href="#l3.64"></a><span id="l3.64">         var showSave = !( this.inDirList || this.isContentSelected || this.onTextInput ||</span>
<a href="#l3.65"></a><span id="l3.65" class="difflineminus">-                          this.onStandaloneImage || this.onCanvas ||</span>
<a href="#l3.66"></a><span id="l3.66" class="difflineplus">+                          this.onStandaloneImage || this.onCanvas || this.onVideo || this.onAudio ||</span>
<a href="#l3.67"></a><span id="l3.67">                        ( this.onLink &amp;&amp; this.onImage ) );</span>
<a href="#l3.68"></a><span id="l3.68">         if (showSave)</span>
<a href="#l3.69"></a><span id="l3.69">           goSetMenuValue( &quot;context-savepage&quot;, this.autoDownload ? &quot;valueSave&quot; : &quot;valueSaveAs&quot; );</span>
<a href="#l3.70"></a><span id="l3.70">         this.showItem( &quot;context-savepage&quot;, showSave );</span>
<a href="#l3.71"></a><span id="l3.71"> </span>
<a href="#l3.72"></a><span id="l3.72">         // Save/send link depends on whether we're in a link.</span>
<a href="#l3.73"></a><span id="l3.73">         if (this.onSaveableLink)</span>
<a href="#l3.74"></a><span id="l3.74">           goSetMenuValue( &quot;context-savelink&quot;, this.autoDownload ? &quot;valueSave&quot; : &quot;valueSaveAs&quot; );</span>
<a href="#l3.75"></a><span id="l3.75">         this.showItem( &quot;context-savelink&quot;, this.onSaveableLink );</span>
<a href="#l3.76"></a><span id="l3.76">         this.showItem( &quot;context-sendlink&quot;, this.onSaveableLink );</span>
<a href="#l3.77"></a><span id="l3.77"> </span>
<a href="#l3.78"></a><span id="l3.78" class="difflineminus">-        // Save/Send image depends on whether there is one.</span>
<a href="#l3.79"></a><span id="l3.79" class="difflineplus">+        // Save image depends on having loaded its content, video and audio don't.</span>
<a href="#l3.80"></a><span id="l3.80">         showSave = this.onLoadedImage || this.onStandaloneImage || this.onCanvas;</span>
<a href="#l3.81"></a><span id="l3.81">         if (showSave)</span>
<a href="#l3.82"></a><span id="l3.82">           goSetMenuValue( &quot;context-saveimage&quot;, this.autoDownload ? &quot;valueSave&quot; : &quot;valueSaveAs&quot; );</span>
<a href="#l3.83"></a><span id="l3.83">         this.showItem( &quot;context-saveimage&quot;, showSave );</span>
<a href="#l3.84"></a><span id="l3.84" class="difflineplus">+        this.showItem( &quot;context-savevideo&quot;, this.onVideo );</span>
<a href="#l3.85"></a><span id="l3.85" class="difflineplus">+        this.showItem( &quot;context-saveaudio&quot;, this.onAudio );</span>
<a href="#l3.86"></a><span id="l3.86" class="difflineplus">+        // Send media URL (but not for canvas, since it's a big data: URL)</span>
<a href="#l3.87"></a><span id="l3.87">         this.showItem( &quot;context-sendimage&quot;, showSave );</span>
<a href="#l3.88"></a><span id="l3.88" class="difflineplus">+        this.showItem( &quot;context-sendvideo&quot;, this.onVideo );</span>
<a href="#l3.89"></a><span id="l3.89" class="difflineplus">+        this.showItem( &quot;context-sendaudio&quot;, this.onAudio );</span>
<a href="#l3.90"></a><span id="l3.90">     },</span>
<a href="#l3.91"></a><span id="l3.91">     initViewItems : function () {</span>
<a href="#l3.92"></a><span id="l3.92">         // View source is always OK, unless in directory listing.</span>
<a href="#l3.93"></a><span id="l3.93">         this.showItem( &quot;context-viewpartialsource-selection&quot;, this.isContentSelected &amp;&amp; !this.onTextInput );</span>
<a href="#l3.94"></a><span id="l3.94">         this.showItem( &quot;context-viewpartialsource-mathml&quot;, this.onMathML &amp;&amp; !this.isContentSelected );</span>
<a href="#l3.95"></a><span id="l3.95"> </span>
<a href="#l3.96"></a><span id="l3.96" class="difflineminus">-        var showView = !( this.inDirList || this.onImage || this.isContentSelected || this.onLink || this.onTextInput );</span>
<a href="#l3.97"></a><span id="l3.97" class="difflineplus">+        var showView = !( this.inDirList || this.onImage || this.isContentSelected || this.onCanvas ||</span>
<a href="#l3.98"></a><span id="l3.98" class="difflineplus">+                          this.onVideo || this.onAudio || this.onLink || this.onTextInput );</span>
<a href="#l3.99"></a><span id="l3.99"> </span>
<a href="#l3.100"></a><span id="l3.100">         this.showItem( &quot;context-viewsource&quot;, showView );</span>
<a href="#l3.101"></a><span id="l3.101">         this.showItem( &quot;context-viewinfo&quot;, showView );</span>
<a href="#l3.102"></a><span id="l3.102"> </span>
<a href="#l3.103"></a><span id="l3.103" class="difflineminus">-        this.showItem( &quot;context-sep-properties&quot;, !( this.inDirList || this.isContentSelected || this.onTextInput ) );</span>
<a href="#l3.104"></a><span id="l3.104" class="difflineplus">+        this.showItem( &quot;context-sep-properties&quot;, !( this.inDirList || this.isContentSelected || this.onTextInput ||</span>
<a href="#l3.105"></a><span id="l3.105" class="difflineplus">+                                                    this.onCanvas || this.onVideo || this.onAudio ) );</span>
<a href="#l3.106"></a><span id="l3.106">         // Set As Wallpaper depends on whether an image was clicked on,</span>
<a href="#l3.107"></a><span id="l3.107">         // and requires the shell service.</span>
<a href="#l3.108"></a><span id="l3.108">         var hasShell = &quot;@mozilla.org/suite/shell-service;1&quot; in Components.classes;</span>
<a href="#l3.109"></a><span id="l3.109">         this.showItem( &quot;context-setWallpaper&quot;, hasShell &amp;&amp; (this.onLoadedImage || this.onStandaloneImage));</span>
<a href="#l3.110"></a><span id="l3.110"> </span>
<a href="#l3.111"></a><span id="l3.111">         this.showItem( &quot;context-sep-image&quot;, this.onLoadedImage || this.onStandaloneImage);</span>
<a href="#l3.112"></a><span id="l3.112"> </span>
<a href="#l3.113"></a><span id="l3.113">         if( hasShell &amp;&amp; this.onLoadedImage )</span>
<a href="#l3.114"></a><span id="l3.114" class="difflineat">@@ -198,17 +208,18 @@ nsContextMenu.prototype = {</span>
<a href="#l3.115"></a><span id="l3.115"> </span>
<a href="#l3.116"></a><span id="l3.116">         // View background image depends on whether there is one.</span>
<a href="#l3.117"></a><span id="l3.117">         this.showItem( &quot;context-viewbgimage&quot;, showView &amp;&amp; !this.onStandaloneImage);</span>
<a href="#l3.118"></a><span id="l3.118">         this.showItem( &quot;context-sep-viewbgimage&quot;, showView &amp;&amp; !this.onStandaloneImage);</span>
<a href="#l3.119"></a><span id="l3.119">         this.setItemAttr( &quot;context-viewbgimage&quot;, &quot;disabled&quot;, this.hasBGImage ? null : &quot;true&quot;);</span>
<a href="#l3.120"></a><span id="l3.120">     },</span>
<a href="#l3.121"></a><span id="l3.121">     initMiscItems : function () {</span>
<a href="#l3.122"></a><span id="l3.122">         // Use &quot;Bookmark This Link&quot; if on a link.</span>
<a href="#l3.123"></a><span id="l3.123" class="difflineminus">-        this.showItem( &quot;context-bookmarkpage&quot;, !( this.isContentSelected || this.onTextInput || this.onStandaloneImage ) );</span>
<a href="#l3.124"></a><span id="l3.124" class="difflineplus">+        this.showItem( &quot;context-bookmarkpage&quot;, !( this.isContentSelected || this.onTextInput ||</span>
<a href="#l3.125"></a><span id="l3.125" class="difflineplus">+                                                  this.onStandaloneImage || this.onVideo || this.onAudio ) );</span>
<a href="#l3.126"></a><span id="l3.126">         this.showItem( &quot;context-bookmarklink&quot;, this.onLink &amp;&amp; !this.onMailtoLink );</span>
<a href="#l3.127"></a><span id="l3.127">         this.showItem( &quot;context-searchselect&quot;, this.isTextSelected &amp;&amp; !this.onTextInput );</span>
<a href="#l3.128"></a><span id="l3.128">         this.showItem( &quot;frame&quot;, this.inFrame );</span>
<a href="#l3.129"></a><span id="l3.129">         this.showItem( &quot;frame-sep&quot;, this.inFrame );</span>
<a href="#l3.130"></a><span id="l3.130">         if (this.inFrame)</span>
<a href="#l3.131"></a><span id="l3.131">           goSetMenuValue( &quot;saveframeas&quot;, this.autoDownload ? &quot;valueSave&quot; : &quot;valueSaveAs&quot; );</span>
<a href="#l3.132"></a><span id="l3.132">         var blocking = true;</span>
<a href="#l3.133"></a><span id="l3.133">         if (this.popupURL)</span>
<a href="#l3.134"></a><span id="l3.134" class="difflineat">@@ -277,17 +288,17 @@ nsContextMenu.prototype = {</span>
<a href="#l3.135"></a><span id="l3.135">         this.showItem( &quot;context-undo&quot;, this.onTextInput );</span>
<a href="#l3.136"></a><span id="l3.136">         this.showItem( &quot;context-redo&quot;, this.onTextInput );</span>
<a href="#l3.137"></a><span id="l3.137">         this.showItem( &quot;context-sep-undo&quot;, this.onTextInput );</span>
<a href="#l3.138"></a><span id="l3.138">         this.showItem( &quot;context-cut&quot;, this.onTextInput );</span>
<a href="#l3.139"></a><span id="l3.139">         this.showItem( &quot;context-copy&quot;, this.isContentSelected || this.onTextInput);</span>
<a href="#l3.140"></a><span id="l3.140">         this.showItem( &quot;context-paste&quot;, this.onTextInput );</span>
<a href="#l3.141"></a><span id="l3.141">         this.showItem( &quot;context-delete&quot;, this.onTextInput );</span>
<a href="#l3.142"></a><span id="l3.142">         this.showItem( &quot;context-sep-paste&quot;, this.onTextInput );</span>
<a href="#l3.143"></a><span id="l3.143" class="difflineminus">-        this.showItem( &quot;context-selectall&quot;, !( this.onLink || this.onImage ) );</span>
<a href="#l3.144"></a><span id="l3.144" class="difflineplus">+        this.showItem( &quot;context-selectall&quot;, !( this.onLink || this.onImage || this.onVideo || this.onAudio ) );</span>
<a href="#l3.145"></a><span id="l3.145">         this.showItem( &quot;context-sep-selectall&quot;, this.isContentSelected &amp;&amp; !this.onTextInput );</span>
<a href="#l3.146"></a><span id="l3.146">         // In a text area there will be nothing after select all, so we don't want a sep</span>
<a href="#l3.147"></a><span id="l3.147">         // Otherwise, if there's text selected then there are extra menu items</span>
<a href="#l3.148"></a><span id="l3.148">         // (search for selection and view selection source), so we do want a sep</span>
<a href="#l3.149"></a><span id="l3.149"> </span>
<a href="#l3.150"></a><span id="l3.150">         // XXX dr</span>
<a href="#l3.151"></a><span id="l3.151">         // ------</span>
<a href="#l3.152"></a><span id="l3.152">         // nsDocumentViewer.cpp has code to determine whether we're</span>
<a href="#l3.153"></a><span id="l3.153" class="difflineat">@@ -297,32 +308,47 @@ nsContextMenu.prototype = {</span>
<a href="#l3.154"></a><span id="l3.154">         this.showItem( &quot;context-copyemail&quot;, this.onMailtoLink );</span>
<a href="#l3.155"></a><span id="l3.155"> </span>
<a href="#l3.156"></a><span id="l3.156">         // Copy link location depends on whether we're on a link.</span>
<a href="#l3.157"></a><span id="l3.157">         this.showItem( &quot;context-copylink&quot;, this.onLink );</span>
<a href="#l3.158"></a><span id="l3.158">         this.showItem( &quot;context-sep-copylink&quot;, this.onLink );</span>
<a href="#l3.159"></a><span id="l3.159"> </span>
<a href="#l3.160"></a><span id="l3.160">         // Copy image location depends on whether we're on an image.</span>
<a href="#l3.161"></a><span id="l3.161">         this.showItem( &quot;context-copyimage&quot;, this.onImage );</span>
<a href="#l3.162"></a><span id="l3.162" class="difflineminus">-        this.showItem( &quot;context-sep-copyimage&quot;, this.onImage );</span>
<a href="#l3.163"></a><span id="l3.163" class="difflineplus">+        this.showItem( &quot;context-copyvideourl&quot;, this.onVideo );</span>
<a href="#l3.164"></a><span id="l3.164" class="difflineplus">+        this.showItem( &quot;context-copyaudiourl&quot;, this.onAudio );</span>
<a href="#l3.165"></a><span id="l3.165" class="difflineplus">+        this.showItem( &quot;context-sep-copyimage&quot;, this.onImage || this.onVideo || this.onAudio );</span>
<a href="#l3.166"></a><span id="l3.166">     },</span>
<a href="#l3.167"></a><span id="l3.167">     initMetadataItems : function () {</span>
<a href="#l3.168"></a><span id="l3.168">         // Show if user clicked on something which has metadata.</span>
<a href="#l3.169"></a><span id="l3.169">         this.showItem( &quot;context-metadata&quot;, this.onMetaDataItem );</span>
<a href="#l3.170"></a><span id="l3.170">     },</span>
<a href="#l3.171"></a><span id="l3.171" class="difflineplus">+    initMediaPlayerItems : function () {</span>
<a href="#l3.172"></a><span id="l3.172" class="difflineplus">+        var onMedia = ( this.onVideo || this.onAudio );</span>
<a href="#l3.173"></a><span id="l3.173" class="difflineplus">+        // Several mutually exclusive items... play/pause, mute/unmute, show/hide</span>
<a href="#l3.174"></a><span id="l3.174" class="difflineplus">+        this.showItem( &quot;context-media-play&quot;, onMedia &amp;&amp; this.target.paused );</span>
<a href="#l3.175"></a><span id="l3.175" class="difflineplus">+        this.showItem( &quot;context-media-pause&quot;, onMedia &amp;&amp; !this.target.paused );</span>
<a href="#l3.176"></a><span id="l3.176" class="difflineplus">+        this.showItem( &quot;context-media-mute&quot;, onMedia &amp;&amp; !this.target.muted );</span>
<a href="#l3.177"></a><span id="l3.177" class="difflineplus">+        this.showItem( &quot;context-media-unmute&quot;, onMedia &amp;&amp; this.target.muted );</span>
<a href="#l3.178"></a><span id="l3.178" class="difflineplus">+        this.showItem( &quot;context-media-showcontrols&quot;, onMedia &amp;&amp; !this.target.controls );</span>
<a href="#l3.179"></a><span id="l3.179" class="difflineplus">+        this.showItem( &quot;context-media-hidecontrols&quot;, onMedia &amp;&amp; this.target.controls );</span>
<a href="#l3.180"></a><span id="l3.180" class="difflineplus">+        this.showItem( &quot;context-media-sep-commands&quot;, onMedia );</span>
<a href="#l3.181"></a><span id="l3.181" class="difflineplus">+    },</span>
<a href="#l3.182"></a><span id="l3.182">     // Set various context menu attributes based on the state of the world.</span>
<a href="#l3.183"></a><span id="l3.183">     setTarget : function ( node, rangeParent, rangeOffset ) {</span>
<a href="#l3.184"></a><span id="l3.184">         // Initialize contextual info.</span>
<a href="#l3.185"></a><span id="l3.185">         this.onImage    = false;</span>
<a href="#l3.186"></a><span id="l3.186">         this.onLoadedImage = false;</span>
<a href="#l3.187"></a><span id="l3.187">         this.onStandaloneImage = false;</span>
<a href="#l3.188"></a><span id="l3.188">         this.onCanvas          = false;</span>
<a href="#l3.189"></a><span id="l3.189" class="difflineplus">+        this.onVideo           = false;</span>
<a href="#l3.190"></a><span id="l3.190" class="difflineplus">+        this.onAudio           = false;</span>
<a href="#l3.191"></a><span id="l3.191">         this.onMetaDataItem = false;</span>
<a href="#l3.192"></a><span id="l3.192">         this.onTextInput = false;</span>
<a href="#l3.193"></a><span id="l3.193" class="difflineminus">-        this.imageURL   = &quot;&quot;;</span>
<a href="#l3.194"></a><span id="l3.194" class="difflineplus">+        this.mediaURL   = &quot;&quot;;</span>
<a href="#l3.195"></a><span id="l3.195">         this.onLink     = false;</span>
<a href="#l3.196"></a><span id="l3.196">         this.onMathML   = false;</span>
<a href="#l3.197"></a><span id="l3.197">         this.inFrame    = false;</span>
<a href="#l3.198"></a><span id="l3.198">         this.hasBGImage = false;</span>
<a href="#l3.199"></a><span id="l3.199">         this.bgImageURL = &quot;&quot;;</span>
<a href="#l3.200"></a><span id="l3.200">         this.possibleSpellChecking = false;</span>
<a href="#l3.201"></a><span id="l3.201"> </span>
<a href="#l3.202"></a><span id="l3.202">         // Remember the node that was clicked.</span>
<a href="#l3.203"></a><span id="l3.203" class="difflineat">@@ -363,22 +389,28 @@ nsContextMenu.prototype = {</span>
<a href="#l3.204"></a><span id="l3.204"> </span>
<a href="#l3.205"></a><span id="l3.205">         // See if the user clicked on an image.</span>
<a href="#l3.206"></a><span id="l3.206">         if ( this.target.nodeType == Node.ELEMENT_NODE ) {</span>
<a href="#l3.207"></a><span id="l3.207">             if ( this.target instanceof Components.interfaces.nsIImageLoadingContent &amp;&amp; this.target.currentURI  ) {</span>
<a href="#l3.208"></a><span id="l3.208">                 this.onImage = true;</span>
<a href="#l3.209"></a><span id="l3.209">                 var request = this.target.getRequest( Components.interfaces.nsIImageLoadingContent.CURRENT_REQUEST );</span>
<a href="#l3.210"></a><span id="l3.210">                 if (request &amp;&amp; (request.imageStatus &amp; request.STATUS_SIZE_AVAILABLE))</span>
<a href="#l3.211"></a><span id="l3.211">                     this.onLoadedImage = true;</span>
<a href="#l3.212"></a><span id="l3.212" class="difflineminus">-                this.imageURL = this.target.currentURI.spec;</span>
<a href="#l3.213"></a><span id="l3.213" class="difflineplus">+                this.mediaURL = this.target.currentURI.spec;</span>
<a href="#l3.214"></a><span id="l3.214"> </span>
<a href="#l3.215"></a><span id="l3.215">                 if ( this.target.ownerDocument instanceof ImageDocument )</span>
<a href="#l3.216"></a><span id="l3.216">                    this.onStandaloneImage = true;</span>
<a href="#l3.217"></a><span id="l3.217">             } else if (this.target instanceof HTMLCanvasElement) {</span>
<a href="#l3.218"></a><span id="l3.218">                 this.onCanvas = true;</span>
<a href="#l3.219"></a><span id="l3.219" class="difflineplus">+            } else if ( this.target instanceof HTMLVideoElement ) {</span>
<a href="#l3.220"></a><span id="l3.220" class="difflineplus">+                this.onVideo = true;</span>
<a href="#l3.221"></a><span id="l3.221" class="difflineplus">+                this.mediaURL = this.target.currentSrc;</span>
<a href="#l3.222"></a><span id="l3.222" class="difflineplus">+            } else if ( this.target instanceof HTMLAudioElement ) {</span>
<a href="#l3.223"></a><span id="l3.223" class="difflineplus">+                this.onAudio = true;</span>
<a href="#l3.224"></a><span id="l3.224" class="difflineplus">+                this.mediaURL = this.target.currentSrc;</span>
<a href="#l3.225"></a><span id="l3.225">             } else if ( this.target instanceof HTMLInputElement ) {</span>
<a href="#l3.226"></a><span id="l3.226">                 this.onTextInput = this.isTargetATextBox(this.target);</span>
<a href="#l3.227"></a><span id="l3.227">                 // allow spellchecking UI on all writable text boxes except passwords</span>
<a href="#l3.228"></a><span id="l3.228">                 if (!this.target.readOnly &amp;&amp; !this.target.disabled &amp;&amp; this.target.type == &quot;text&quot;) {</span>
<a href="#l3.229"></a><span id="l3.229">                     this.possibleSpellChecking = true;</span>
<a href="#l3.230"></a><span id="l3.230">                     InlineSpellCheckerUI.init(this.target.QueryInterface(Components.interfaces.nsIDOMNSEditableElement).editor);</span>
<a href="#l3.231"></a><span id="l3.231">                     InlineSpellCheckerUI.initFromEvent(rangeParent, rangeOffset);</span>
<a href="#l3.232"></a><span id="l3.232">                 }</span>
<a href="#l3.233"></a><span id="l3.233" class="difflineat">@@ -668,28 +700,28 @@ nsContextMenu.prototype = {</span>
<a href="#l3.234"></a><span id="l3.234">     viewFrameInfo : function () {</span>
<a href="#l3.235"></a><span id="l3.235">         BrowserPageInfo(this.target.ownerDocument);</span>
<a href="#l3.236"></a><span id="l3.236">     },</span>
<a href="#l3.237"></a><span id="l3.237">     toggleImageSize : function () {</span>
<a href="#l3.238"></a><span id="l3.238">         content.document.toggleImageSize();</span>
<a href="#l3.239"></a><span id="l3.239">     },</span>
<a href="#l3.240"></a><span id="l3.240">     // Reload image</span>
<a href="#l3.241"></a><span id="l3.241">     reloadImage : function () {</span>
<a href="#l3.242"></a><span id="l3.242" class="difflineminus">-        urlSecurityCheck( this.imageURL, this.target.nodePrincipal,</span>
<a href="#l3.243"></a><span id="l3.243" class="difflineplus">+        urlSecurityCheck( this.mediaURL, this.target.nodePrincipal,</span>
<a href="#l3.244"></a><span id="l3.244">                           Components.interfaces.nsIScriptSecurityManager.ALLOW_CHROME );</span>
<a href="#l3.245"></a><span id="l3.245">         if (this.target instanceof Components.interfaces.nsIImageLoadingContent)</span>
<a href="#l3.246"></a><span id="l3.246">           this.target.forceReload();</span>
<a href="#l3.247"></a><span id="l3.247">     },</span>
<a href="#l3.248"></a><span id="l3.248" class="difflineminus">-    // Change current window to the URL of the image.</span>
<a href="#l3.249"></a><span id="l3.249" class="difflineminus">-    viewImage : function () {</span>
<a href="#l3.250"></a><span id="l3.250" class="difflineplus">+    // Change current window to the URL of the image, video, or audio.</span>
<a href="#l3.251"></a><span id="l3.251" class="difflineplus">+    viewMedia : function () {</span>
<a href="#l3.252"></a><span id="l3.252">         var viewURL;</span>
<a href="#l3.253"></a><span id="l3.253">         if (this.onCanvas)</span>
<a href="#l3.254"></a><span id="l3.254">           viewURL = this.target.toDataURL();</span>
<a href="#l3.255"></a><span id="l3.255">         else {</span>
<a href="#l3.256"></a><span id="l3.256" class="difflineminus">-          viewURL = this.imageURL;</span>
<a href="#l3.257"></a><span id="l3.257" class="difflineplus">+          viewURL = this.mediaURL;</span>
<a href="#l3.258"></a><span id="l3.258">           urlSecurityCheck( viewURL, this.target.nodePrincipal,</span>
<a href="#l3.259"></a><span id="l3.259">                             Components.interfaces.nsIScriptSecurityManager.ALLOW_CHROME );</span>
<a href="#l3.260"></a><span id="l3.260">         }</span>
<a href="#l3.261"></a><span id="l3.261">         openTopWin( viewURL, this.target.ownerDocument.defaultView );</span>
<a href="#l3.262"></a><span id="l3.262">     },</span>
<a href="#l3.263"></a><span id="l3.263">     // Change current window to the URL of the background image.</span>
<a href="#l3.264"></a><span id="l3.264">     viewBGImage : function () {</span>
<a href="#l3.265"></a><span id="l3.265">         urlSecurityCheck( this.bgImageURL, this.target.nodePrincipal,</span>
<a href="#l3.266"></a><span id="l3.266" class="difflineat">@@ -724,25 +756,35 @@ nsContextMenu.prototype = {</span>
<a href="#l3.267"></a><span id="l3.267">     saveFrame : function () {</span>
<a href="#l3.268"></a><span id="l3.268">         saveDocument( this.target.ownerDocument );</span>
<a href="#l3.269"></a><span id="l3.269">     },</span>
<a href="#l3.270"></a><span id="l3.270">     // Save URL of clicked-on link.</span>
<a href="#l3.271"></a><span id="l3.271">     saveLink : function () {</span>
<a href="#l3.272"></a><span id="l3.272">         saveURL( this.linkURL(), this.linkText(), null, true,</span>
<a href="#l3.273"></a><span id="l3.273">                  this.target.ownerDocument.documentURIObject );</span>
<a href="#l3.274"></a><span id="l3.274">     },</span>
<a href="#l3.275"></a><span id="l3.275" class="difflineminus">-    // Save URL of clicked-on image.</span>
<a href="#l3.276"></a><span id="l3.276" class="difflineminus">-    saveImage : function () {</span>
<a href="#l3.277"></a><span id="l3.277" class="difflineplus">+    // Save URL of clicked-on image, video, or audio.</span>
<a href="#l3.278"></a><span id="l3.278" class="difflineplus">+    saveMedia : function () {</span>
<a href="#l3.279"></a><span id="l3.279">         if (this.onCanvas)</span>
<a href="#l3.280"></a><span id="l3.280">           // Bypass cache, since it's a data: URL.</span>
<a href="#l3.281"></a><span id="l3.281">           saveImageURL( this.target.toDataURL(), &quot;canvas.png&quot;, &quot;SaveImageTitle&quot;,</span>
<a href="#l3.282"></a><span id="l3.282">                         true, null );</span>
<a href="#l3.283"></a><span id="l3.283" class="difflineminus">-        else</span>
<a href="#l3.284"></a><span id="l3.284" class="difflineminus">-          saveImageURL( this.imageURL, null, &quot;SaveImageTitle&quot;, false,</span>
<a href="#l3.285"></a><span id="l3.285" class="difflineplus">+        else if (this.onImage)</span>
<a href="#l3.286"></a><span id="l3.286" class="difflineplus">+          saveImageURL( this.mediaURL, null, &quot;SaveImageTitle&quot;, false,</span>
<a href="#l3.287"></a><span id="l3.287">                         this.target.ownerDocument.documentURIObject );</span>
<a href="#l3.288"></a><span id="l3.288" class="difflineplus">+        else if (this.onVideo || this.onAudio) {</span>
<a href="#l3.289"></a><span id="l3.289" class="difflineplus">+          var dialogTitle = this.onVideo ? &quot;SaveVideoTitle&quot; : &quot;SaveAudioTitle&quot;;</span>
<a href="#l3.290"></a><span id="l3.290" class="difflineplus">+          saveURL( this.mediaURL, null, dialogTitle, false,</span>
<a href="#l3.291"></a><span id="l3.291" class="difflineplus">+                   this.target.ownerDocument.documentURIObject );</span>
<a href="#l3.292"></a><span id="l3.292" class="difflineplus">+        }</span>
<a href="#l3.293"></a><span id="l3.293" class="difflineplus">+    },</span>
<a href="#l3.294"></a><span id="l3.294" class="difflineplus">+    // Backwards-compatability wrapper</span>
<a href="#l3.295"></a><span id="l3.295" class="difflineplus">+    saveImage : function () {</span>
<a href="#l3.296"></a><span id="l3.296" class="difflineplus">+        if (this.onCanvas || this.onImage)</span>
<a href="#l3.297"></a><span id="l3.297" class="difflineplus">+          this.saveMedia();</span>
<a href="#l3.298"></a><span id="l3.298">     },</span>
<a href="#l3.299"></a><span id="l3.299">     // Generate email address.</span>
<a href="#l3.300"></a><span id="l3.300">     getEmail : function () {</span>
<a href="#l3.301"></a><span id="l3.301">         // Get the comma-separated list of email addresses only.</span>
<a href="#l3.302"></a><span id="l3.302">         // There are other ways of embedding email addresses in a mailto:</span>
<a href="#l3.303"></a><span id="l3.303">         // link, but such complex parsing is beyond us.</span>
<a href="#l3.304"></a><span id="l3.304">         var addresses;</span>
<a href="#l3.305"></a><span id="l3.305">         try {</span>
<a href="#l3.306"></a><span id="l3.306" class="difflineat">@@ -981,16 +1023,47 @@ nsContextMenu.prototype = {</span>
<a href="#l3.307"></a><span id="l3.307">     {</span>
<a href="#l3.308"></a><span id="l3.308">       try {</span>
<a href="#l3.309"></a><span id="l3.309">         var formatter = Components.classes[&quot;@mozilla.org/toolkit/URLFormatterService;1&quot;]</span>
<a href="#l3.310"></a><span id="l3.310">                       .getService(Components.interfaces.nsIURLFormatter);</span>
<a href="#l3.311"></a><span id="l3.311">         var url = formatter.formatURLPref(&quot;spellchecker.dictionaries.download.url&quot;);</span>
<a href="#l3.312"></a><span id="l3.312">         window.openDialog(getBrowserURL(), &quot;_blank&quot;, &quot;chrome,all,dialog=no&quot;, url);</span>
<a href="#l3.313"></a><span id="l3.313">       }</span>
<a href="#l3.314"></a><span id="l3.314">       catch (ex) {}</span>
<a href="#l3.315"></a><span id="l3.315" class="difflineplus">+    },</span>
<a href="#l3.316"></a><span id="l3.316" class="difflineplus">+</span>
<a href="#l3.317"></a><span id="l3.317" class="difflineplus">+    mediaCommand : function (command) {</span>
<a href="#l3.318"></a><span id="l3.318" class="difflineplus">+        var media = this.target;</span>
<a href="#l3.319"></a><span id="l3.319" class="difflineplus">+</span>
<a href="#l3.320"></a><span id="l3.320" class="difflineplus">+        switch (command) {</span>
<a href="#l3.321"></a><span id="l3.321" class="difflineplus">+          case &quot;play&quot;:</span>
<a href="#l3.322"></a><span id="l3.322" class="difflineplus">+            media.play();</span>
<a href="#l3.323"></a><span id="l3.323" class="difflineplus">+            break;</span>
<a href="#l3.324"></a><span id="l3.324" class="difflineplus">+          case &quot;pause&quot;:</span>
<a href="#l3.325"></a><span id="l3.325" class="difflineplus">+            media.pause();</span>
<a href="#l3.326"></a><span id="l3.326" class="difflineplus">+            break;</span>
<a href="#l3.327"></a><span id="l3.327" class="difflineplus">+          case &quot;mute&quot;:</span>
<a href="#l3.328"></a><span id="l3.328" class="difflineplus">+            media.muted = true;</span>
<a href="#l3.329"></a><span id="l3.329" class="difflineplus">+            break;</span>
<a href="#l3.330"></a><span id="l3.330" class="difflineplus">+          case &quot;unmute&quot;:</span>
<a href="#l3.331"></a><span id="l3.331" class="difflineplus">+            media.muted = false;</span>
<a href="#l3.332"></a><span id="l3.332" class="difflineplus">+            break;</span>
<a href="#l3.333"></a><span id="l3.333" class="difflineplus">+          case &quot;hidecontrols&quot;:</span>
<a href="#l3.334"></a><span id="l3.334" class="difflineplus">+            media.removeAttribute(&quot;controls&quot;);</span>
<a href="#l3.335"></a><span id="l3.335" class="difflineplus">+            break;</span>
<a href="#l3.336"></a><span id="l3.336" class="difflineplus">+          case &quot;showcontrols&quot;:</span>
<a href="#l3.337"></a><span id="l3.337" class="difflineplus">+            media.setAttribute(&quot;controls&quot;, &quot;true&quot;);</span>
<a href="#l3.338"></a><span id="l3.338" class="difflineplus">+            break;</span>
<a href="#l3.339"></a><span id="l3.339" class="difflineplus">+        }</span>
<a href="#l3.340"></a><span id="l3.340" class="difflineplus">+    },</span>
<a href="#l3.341"></a><span id="l3.341" class="difflineplus">+</span>
<a href="#l3.342"></a><span id="l3.342" class="difflineplus">+    copyMediaLocation : function () {</span>
<a href="#l3.343"></a><span id="l3.343" class="difflineplus">+        var clipboard = Components.classes[&quot;@mozilla.org/widget/clipboardhelper;1&quot;]</span>
<a href="#l3.344"></a><span id="l3.344" class="difflineplus">+                        .getService(Components.interfaces.nsIClipboardHelper);</span>
<a href="#l3.345"></a><span id="l3.345" class="difflineplus">+        clipboard.copyString(this.mediaURL);</span>
<a href="#l3.346"></a><span id="l3.346">     }</span>
<a href="#l3.347"></a><span id="l3.347"> };</span>
<a href="#l3.348"></a><span id="l3.348"> </span>
<a href="#l3.349"></a><span id="l3.349"> /*************************************************************************</span>
<a href="#l3.350"></a><span id="l3.350">  *</span>
<a href="#l3.351"></a><span id="l3.351">  *   nsDefaultEngine : nsIObserver</span>
<a href="#l3.352"></a><span id="l3.352">  *</span>
<a href="#l3.353"></a><span id="l3.353">  *************************************************************************/</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/suite/common/permissions/imageContextOverlay.xul</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/suite/common/permissions/imageContextOverlay.xul</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -56,17 +56,17 @@</span>
<a href="#l4.4"></a><span id="l4.4">           Components.classes[&quot;@mozilla.org/permissionmanager;1&quot;]</span>
<a href="#l4.5"></a><span id="l4.5">                     .getService(nsIPermissionManager);</span>
<a href="#l4.6"></a><span id="l4.6">         if (!permissionmanager) {</span>
<a href="#l4.7"></a><span id="l4.7">           return;</span>
<a href="#l4.8"></a><span id="l4.8">         }</span>
<a href="#l4.9"></a><span id="l4.9"> </span>
<a href="#l4.10"></a><span id="l4.10">         const uri = Components.classes[&quot;@mozilla.org/network/io-service;1&quot;]</span>
<a href="#l4.11"></a><span id="l4.11">                               .getService(Components.interfaces.nsIIOService)</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-                              .newURI(gContextMenu.imageURL, null, null);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+                              .newURI(gContextMenu.mediaURL, null, null);</span>
<a href="#l4.14"></a><span id="l4.14">         if (aBlock)</span>
<a href="#l4.15"></a><span id="l4.15">           permissionmanager.add(uri, &quot;image&quot;,</span>
<a href="#l4.16"></a><span id="l4.16">                                 nsIPermissionManager.DENY_ACTION);</span>
<a href="#l4.17"></a><span id="l4.17">         else</span>
<a href="#l4.18"></a><span id="l4.18">           permissionmanager.remove(uri.host, &quot;image&quot;);</span>
<a href="#l4.19"></a><span id="l4.19">       },</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21">       initImageBlocking : function () {</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineat">@@ -75,17 +75,17 @@</span>
<a href="#l4.23"></a><span id="l4.23">         //Hide Block and Unblock menuitems</span>
<a href="#l4.24"></a><span id="l4.24">         gContextMenu.showItem(&quot;context-blockimage&quot;, false);</span>
<a href="#l4.25"></a><span id="l4.25">         gContextMenu.showItem(&quot;context-unblockimage&quot;, false);</span>
<a href="#l4.26"></a><span id="l4.26"> </span>
<a href="#l4.27"></a><span id="l4.27">         // Block image depends on whether an image was clicked on</span>
<a href="#l4.28"></a><span id="l4.28">         if (gContextMenu.onImage) {</span>
<a href="#l4.29"></a><span id="l4.29">           var IOService = Components.classes[&quot;@mozilla.org/network/io-service;1&quot;]</span>
<a href="#l4.30"></a><span id="l4.30">                                     .getService(Components.interfaces.nsIIOService);</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineminus">-          var uri = IOService.newURI(gContextMenu.imageURL, null, null);</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+          var uri = IOService.newURI(gContextMenu.mediaURL, null, null);</span>
<a href="#l4.33"></a><span id="l4.33">           try {</span>
<a href="#l4.34"></a><span id="l4.34">             var serverLabel = uri.host;</span>
<a href="#l4.35"></a><span id="l4.35">             if (serverLabel) {</span>
<a href="#l4.36"></a><span id="l4.36">               // Limit length to max 15 characters</span>
<a href="#l4.37"></a><span id="l4.37">               serverLabel = serverLabel.replace(/^www\./i, &quot;&quot;);</span>
<a href="#l4.38"></a><span id="l4.38">               if (serverLabel.length &gt; 15) {</span>
<a href="#l4.39"></a><span id="l4.39">                 var pref = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l4.40"></a><span id="l4.40">                                      .getService(Components.interfaces.nsIPrefBranch);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/suite/locales/en-US/chrome/browser/mailNavigatorOverlay.dtd</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/browser/mailNavigatorOverlay.dtd</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -9,14 +9,18 @@</span>
<a href="#l5.4"></a><span id="l5.4"> &lt;!ENTITY sendPage.accesskey              &quot;S&quot;&gt;</span>
<a href="#l5.5"></a><span id="l5.5"> </span>
<a href="#l5.6"></a><span id="l5.6"> &lt;!ENTITY contextSendThisPage.label       &quot;Send This Page&quot;&gt;</span>
<a href="#l5.7"></a><span id="l5.7"> &lt;!ENTITY contextSendThisPage.accesskey   &quot;d&quot;&gt;</span>
<a href="#l5.8"></a><span id="l5.8"> &lt;!ENTITY contextSendThisLink.label       &quot;Send This Link&quot;&gt;</span>
<a href="#l5.9"></a><span id="l5.9"> &lt;!ENTITY contextSendThisLink.accesskey   &quot;k&quot;&gt;</span>
<a href="#l5.10"></a><span id="l5.10"> &lt;!ENTITY contextSendImage.label          &quot;Send Image&quot;&gt;</span>
<a href="#l5.11"></a><span id="l5.11"> &lt;!ENTITY contextSendImage.accesskey      &quot;n&quot;&gt;</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+&lt;!ENTITY contextSendVideo.label          &quot;Send Video&quot;&gt;</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+&lt;!ENTITY contextSendVideo.accesskey      &quot;n&quot;&gt;</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+&lt;!ENTITY contextSendAudio.label          &quot;Send Audio&quot;&gt;</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+&lt;!ENTITY contextSendAudio.accesskey      &quot;n&quot;&gt;</span>
<a href="#l5.16"></a><span id="l5.16"> &lt;!ENTITY contextSendFrame.label          &quot;Send Frame&quot;&gt;</span>
<a href="#l5.17"></a><span id="l5.17"> &lt;!ENTITY contextSendFrame.accesskey      &quot;d&quot;&gt;</span>
<a href="#l5.18"></a><span id="l5.18"> </span>
<a href="#l5.19"></a><span id="l5.19"> &lt;!ENTITY sendLinkCmd.label               &quot;Send Link&quot;&gt; </span>
<a href="#l5.20"></a><span id="l5.20"> &lt;!ENTITY sendLinkCmd.accesskey           &quot;d&quot;&gt;</span>
<a href="#l5.21"></a><span id="l5.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/suite/locales/en-US/chrome/common/contentAreaCommands.dtd</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/common/contentAreaCommands.dtd</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -65,40 +65,60 @@</span>
<a href="#l6.4"></a><span id="l6.4"> &lt;!ENTITY saveFrameCmd.label           &quot;Save Frame&quot;&gt;</span>
<a href="#l6.5"></a><span id="l6.5"> &lt;!ENTITY saveFrameCmd.accesskey       &quot;m&quot;&gt;</span>
<a href="#l6.6"></a><span id="l6.6"> &lt;!ENTITY saveLinkAsCmd.label          &quot;Save Link Target As&quot;&gt;</span>
<a href="#l6.7"></a><span id="l6.7"> &lt;!ENTITY saveLinkCmd.label            &quot;Save Link Target&quot;&gt;</span>
<a href="#l6.8"></a><span id="l6.8"> &lt;!ENTITY saveLinkCmd.accesskey        &quot;r&quot;&gt;</span>
<a href="#l6.9"></a><span id="l6.9"> &lt;!ENTITY saveImageAsCmd.label         &quot;Save Image As&quot;&gt;</span>
<a href="#l6.10"></a><span id="l6.10"> &lt;!ENTITY saveImageCmd.label           &quot;Save Image&quot;&gt;</span>
<a href="#l6.11"></a><span id="l6.11"> &lt;!ENTITY saveImageCmd.accesskey       &quot;v&quot;&gt;</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineplus">+&lt;!ENTITY saveVideoCmd.label           &quot;Save Video As&quot;&gt;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+&lt;!ENTITY saveVideoCmd.accesskey       &quot;v&quot;&gt;</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+&lt;!ENTITY saveAudioCmd.label           &quot;Save Audio As&quot;&gt;</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+&lt;!ENTITY saveAudioCmd.accesskey       &quot;v&quot;&gt;</span>
<a href="#l6.16"></a><span id="l6.16"> &lt;!ENTITY copyCmd.label                &quot;Copy&quot;&gt;</span>
<a href="#l6.17"></a><span id="l6.17"> &lt;!ENTITY copyCmd.accesskey            &quot;C&quot;&gt;</span>
<a href="#l6.18"></a><span id="l6.18"> &lt;!ENTITY selectAllCmd.label           &quot;Select All&quot;&gt;</span>
<a href="#l6.19"></a><span id="l6.19"> &lt;!ENTITY selectAllCmd.accesskey       &quot;A&quot;&gt;</span>
<a href="#l6.20"></a><span id="l6.20"> &lt;!ENTITY copyLinkCmd.label            &quot;Copy Link Location&quot;&gt;</span>
<a href="#l6.21"></a><span id="l6.21"> &lt;!ENTITY copyLinkCmd.accesskey        &quot;C&quot;&gt;</span>
<a href="#l6.22"></a><span id="l6.22"> &lt;!ENTITY copyImageCmd.label           &quot;Copy Image&quot;&gt;</span>
<a href="#l6.23"></a><span id="l6.23"> &lt;!ENTITY copyImageCmd.accesskey       &quot;o&quot;&gt;</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineplus">+&lt;!ENTITY copyVideoURLCmd.label        &quot;Copy Video Location&quot;&gt;</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineplus">+&lt;!ENTITY copyVideoURLCmd.accesskey    &quot;o&quot;&gt;</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineplus">+&lt;!ENTITY copyAudioURLCmd.label        &quot;Copy Audio Location&quot;&gt;</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineplus">+&lt;!ENTITY copyAudioURLCmd.accesskey    &quot;o&quot;&gt;</span>
<a href="#l6.28"></a><span id="l6.28"> &lt;!ENTITY metadataCmd.label            &quot;Properties&quot;&gt;</span>
<a href="#l6.29"></a><span id="l6.29"> &lt;!ENTITY metadataCmd.accesskey        &quot;P&quot;&gt;</span>
<a href="#l6.30"></a><span id="l6.30"> &lt;!ENTITY copyEmailCmd.label           &quot;Copy Email Address&quot;&gt;</span>
<a href="#l6.31"></a><span id="l6.31"> &lt;!ENTITY copyEmailCmd.accesskey       &quot;E&quot;&gt;</span>
<a href="#l6.32"></a><span id="l6.32"> &lt;!ENTITY pasteCmd.label               &quot;Paste&quot;&gt;</span>
<a href="#l6.33"></a><span id="l6.33"> &lt;!ENTITY pasteCmd.accesskey           &quot;P&quot;&gt;</span>
<a href="#l6.34"></a><span id="l6.34"> &lt;!ENTITY cutCmd.label                 &quot;Cut&quot;&gt;</span>
<a href="#l6.35"></a><span id="l6.35"> &lt;!ENTITY cutCmd.accesskey             &quot;t&quot;&gt;</span>
<a href="#l6.36"></a><span id="l6.36"> &lt;!ENTITY deleteCmd.label              &quot;Delete&quot;&gt;</span>
<a href="#l6.37"></a><span id="l6.37"> &lt;!ENTITY deleteCmd.accesskey          &quot;D&quot;&gt;</span>
<a href="#l6.38"></a><span id="l6.38"> &lt;!ENTITY undoCmd.label                &quot;Undo&quot;&gt;</span>
<a href="#l6.39"></a><span id="l6.39"> &lt;!ENTITY undoCmd.accesskey            &quot;U&quot;&gt;</span>
<a href="#l6.40"></a><span id="l6.40"> &lt;!ENTITY redoCmd.label                &quot;Redo&quot;&gt;</span>
<a href="#l6.41"></a><span id="l6.41"> &lt;!ENTITY redoCmd.accesskey            &quot;R&quot;&gt;</span>
<a href="#l6.42"></a><span id="l6.42"> &lt;!ENTITY thisFrameMenu.label          &quot;This Frame&quot;&gt;</span>
<a href="#l6.43"></a><span id="l6.43"> &lt;!ENTITY thisFrameMenu.accesskey      &quot;h&quot;&gt;</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineplus">+&lt;!ENTITY mediaPlay.label              &quot;Play&quot;&gt;</span>
<a href="#l6.45"></a><span id="l6.45" class="difflineplus">+&lt;!ENTITY mediaPlay.accesskey          &quot;P&quot;&gt;</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineplus">+&lt;!ENTITY mediaPause.label             &quot;Pause&quot;&gt;</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineplus">+&lt;!ENTITY mediaPause.accesskey         &quot;P&quot;&gt;</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineplus">+&lt;!ENTITY mediaMute.label              &quot;Mute&quot;&gt;</span>
<a href="#l6.49"></a><span id="l6.49" class="difflineplus">+&lt;!ENTITY mediaMute.accesskey          &quot;M&quot;&gt;</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineplus">+&lt;!ENTITY mediaUnmute.label            &quot;Unmute&quot;&gt;</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineplus">+&lt;!ENTITY mediaUnmute.accesskey        &quot;m&quot;&gt;</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineplus">+&lt;!ENTITY mediaShowControls.label      &quot;Show Media Controls&quot;&gt;</span>
<a href="#l6.53"></a><span id="l6.53" class="difflineplus">+&lt;!ENTITY mediaShowControls.accesskey  &quot;a&quot;&gt;</span>
<a href="#l6.54"></a><span id="l6.54" class="difflineplus">+&lt;!ENTITY mediaHideControls.label      &quot;Hide Media Controls&quot;&gt;</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineplus">+&lt;!ENTITY mediaHideControls.accesskey  &quot;a&quot;&gt;</span>
<a href="#l6.56"></a><span id="l6.56"> &lt;!ENTITY search.accesskey             &quot;W&quot;&gt;</span>
<a href="#l6.57"></a><span id="l6.57"> &lt;!ENTITY bidiSwitchPageDirectionItem.label        &quot;Switch Page Direction&quot;&gt;</span>
<a href="#l6.58"></a><span id="l6.58"> &lt;!ENTITY bidiSwitchPageDirectionItem.accesskey    &quot;g&quot;&gt;</span>
<a href="#l6.59"></a><span id="l6.59"> &lt;!ENTITY bidiSwitchTextDirectionItem.label        &quot;Switch Text Direction&quot;&gt;</span>
<a href="#l6.60"></a><span id="l6.60"> &lt;!ENTITY bidiSwitchTextDirectionItem.accesskey    &quot;w&quot;&gt;</span>
<a href="#l6.61"></a><span id="l6.61"> &lt;!ENTITY spellAddToDictionary.label     &quot;Add to Dictionary&quot;&gt;</span>
<a href="#l6.62"></a><span id="l6.62"> &lt;!ENTITY spellAddToDictionary.accesskey &quot;o&quot;&gt;</span>
<a href="#l6.63"></a><span id="l6.63"> &lt;!ENTITY spellIgnoreWord.label          &quot;Ignore Word&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/suite/locales/en-US/chrome/common/contentAreaCommands.properties</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/common/contentAreaCommands.properties</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -5,16 +5,18 @@ searchText.accesskey=W</span>
<a href="#l7.4"></a><span id="l7.4"> </span>
<a href="#l7.5"></a><span id="l7.5"> blockImage=Block Images from %S</span>
<a href="#l7.6"></a><span id="l7.6"> blockImage.accesskey=B</span>
<a href="#l7.7"></a><span id="l7.7"> unblockImage=Unblock Images from %S</span>
<a href="#l7.8"></a><span id="l7.8"> unblockImage.accesskey=b</span>
<a href="#l7.9"></a><span id="l7.9"> </span>
<a href="#l7.10"></a><span id="l7.10"> SavePageTitle=Save Web Page</span>
<a href="#l7.11"></a><span id="l7.11"> SaveImageTitle=Save Image</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+SaveVideoTitle=Save Video</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+SaveAudioTitle=Save Audio</span>
<a href="#l7.14"></a><span id="l7.14"> SaveLinkTitle=Save As</span>
<a href="#l7.15"></a><span id="l7.15"> SaveAttachmentTitle=Save Attachment</span>
<a href="#l7.16"></a><span id="l7.16"> DefaultSaveFileName=index</span>
<a href="#l7.17"></a><span id="l7.17"> WebPageCompleteFilter=Web Page, complete</span>
<a href="#l7.18"></a><span id="l7.18"> WebPageHTMLOnlyFilter=Web Page, HTML only</span>
<a href="#l7.19"></a><span id="l7.19"> WebPageXHTMLOnlyFilter=Web Page, XHTML only</span>
<a href="#l7.20"></a><span id="l7.20"> WebPageSVGOnlyFilter=Web Page, SVG only</span>
<a href="#l7.21"></a><span id="l7.21"> WebPageXMLOnlyFilter=Web Page, XML only</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

