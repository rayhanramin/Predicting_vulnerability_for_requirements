<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 16125:af30e12503ab60017b490d09d4108696e77cb2fd</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ af30e12503ab60017b490d09d4108696e77cb2fd" />
<meta property="og:url" content="/comm-central/rev/af30e12503ab60017b490d09d4108696e77cb2fd" />
<meta property="og:description" content="Bug 457296 - Part 4: migrate RemoteContent pref (Implement separate whitelist for addresses/domains allowed to load remote images for email. r=mconley, r=standard8, a=standard8" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / af30e12503ab60017b490d09d4108696e77cb2fd 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/af30e12503ab60017b490d09d4108696e77cb2fd">shortlog</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/af30e12503ab60017b490d09d4108696e77cb2fd">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd">files</a> |
changeset |
<a href="/comm-central/raw-rev/af30e12503ab60017b490d09d4108696e77cb2fd">raw</a>  | <a href="/comm-central/archive/af30e12503ab60017b490d09d4108696e77cb2fd.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=457296">Bug 457296</a> - Part 4: migrate RemoteContent pref (Implement separate whitelist for addresses/domains allowed to load remote images for email. r=mconley, r=standard8, a=standard8
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#77;&#97;&#103;&#110;&#117;&#115;&#32;&#77;&#101;&#108;&#105;&#110;&#32;&#60;&#109;&#107;&#109;&#101;&#108;&#105;&#110;&#43;&#109;&#111;&#122;&#105;&#108;&#108;&#97;&#64;&#105;&#107;&#105;&#46;&#102;&#105;&#62;</td></tr>
<tr><td></td><td class="date age">Mon, 28 Apr 2014 13:31:10 +0300</td></tr>

<tr>
 <td>changeset 16125</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/af30e12503ab60017b490d09d4108696e77cb2fd">af30e12503ab60017b490d09d4108696e77cb2fd</a></td>
</tr>



<tr>
<td>parent 16124</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/45cc03b40060d5d5aa8f8bd3c20082e1e709d723">45cc03b40060d5d5aa8f8bd3c20082e1e709d723</a>
</td>
</tr>

<tr>
<td>child 16126</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/6991232407063296e14bd1bc26941b5330cc36c9">6991232407063296e14bd1bc26941b5330cc36c9</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=af30e12503ab60017b490d09d4108696e77cb2fd">10084</a></td></tr>
<tr><td>push user</td><td>mkmelin@iki.fi</td></tr>
<tr><td>push date</td><td class="date age">Mon, 28 Apr 2014 10:32:05 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@af30e12503ab [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=af30e12503ab60017b490d09d4108696e77cb2fd">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=af30e12503ab60017b490d09d4108696e77cb2fd&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=af30e12503ab60017b490d09d4108696e77cb2fd&newProject=comm-central&newRevision=ec82de81c636d3d76a61194fefd88e27e5c7b90b&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=af30e12503ab60017b490d09d4108696e77cb2fd&newProject=comm-central&newRevision=ec82de81c636d3d76a61194fefd88e27e5c7b90b&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=af30e12503ab60017b490d09d4108696e77cb2fd&newProject=comm-central&newRevision=ec82de81c636d3d76a61194fefd88e27e5c7b90b&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28mconley%29&revcount=50">mconley</a>, <a href="/comm-central/log?rev=reviewer%28standard8%29&revcount=50">standard8</a>, <a href="/comm-central/log?rev=reviewer%28standard8%29&revcount=50">standard8</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=457296">457296</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=457296">Bug 457296</a> - Part 4: migrate RemoteContent pref (Implement separate whitelist for addresses/domains allowed to load remote images for email. r=mconley, r=standard8, a=standard8</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mail/base/content/mailWindowOverlay.js">mail/base/content/mailWindowOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd/mail/base/content/mailWindowOverlay.js">file</a> |
<a href="/comm-central/annotate/af30e12503ab60017b490d09d4108696e77cb2fd/mail/base/content/mailWindowOverlay.js">annotate</a> |
<a href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mail/base/content/mailWindowOverlay.js">diff</a> |
<a href="/comm-central/comparison/af30e12503ab60017b490d09d4108696e77cb2fd/mail/base/content/mailWindowOverlay.js">comparison</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd/mail/base/content/mailWindowOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mail/base/content/mailWindowOverlay.xul">mail/base/content/mailWindowOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd/mail/base/content/mailWindowOverlay.xul">file</a> |
<a href="/comm-central/annotate/af30e12503ab60017b490d09d4108696e77cb2fd/mail/base/content/mailWindowOverlay.xul">annotate</a> |
<a href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mail/base/content/mailWindowOverlay.xul">diff</a> |
<a href="/comm-central/comparison/af30e12503ab60017b490d09d4108696e77cb2fd/mail/base/content/mailWindowOverlay.xul">comparison</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd/mail/base/content/mailWindowOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mail/components/addrbook/content/abCardOverlay.js">mail/components/addrbook/content/abCardOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd/mail/components/addrbook/content/abCardOverlay.js">file</a> |
<a href="/comm-central/annotate/af30e12503ab60017b490d09d4108696e77cb2fd/mail/components/addrbook/content/abCardOverlay.js">annotate</a> |
<a href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mail/components/addrbook/content/abCardOverlay.js">diff</a> |
<a href="/comm-central/comparison/af30e12503ab60017b490d09d4108696e77cb2fd/mail/components/addrbook/content/abCardOverlay.js">comparison</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd/mail/components/addrbook/content/abCardOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mail/components/addrbook/content/abCardOverlay.xul">mail/components/addrbook/content/abCardOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd/mail/components/addrbook/content/abCardOverlay.xul">file</a> |
<a href="/comm-central/annotate/af30e12503ab60017b490d09d4108696e77cb2fd/mail/components/addrbook/content/abCardOverlay.xul">annotate</a> |
<a href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mail/components/addrbook/content/abCardOverlay.xul">diff</a> |
<a href="/comm-central/comparison/af30e12503ab60017b490d09d4108696e77cb2fd/mail/components/addrbook/content/abCardOverlay.xul">comparison</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd/mail/components/addrbook/content/abCardOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mail/locales/en-US/chrome/messenger/addressbook/abCardOverlay.dtd">mail/locales/en-US/chrome/messenger/addressbook/abCardOverlay.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd/mail/locales/en-US/chrome/messenger/addressbook/abCardOverlay.dtd">file</a> |
<a href="/comm-central/annotate/af30e12503ab60017b490d09d4108696e77cb2fd/mail/locales/en-US/chrome/messenger/addressbook/abCardOverlay.dtd">annotate</a> |
<a href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mail/locales/en-US/chrome/messenger/addressbook/abCardOverlay.dtd">diff</a> |
<a href="/comm-central/comparison/af30e12503ab60017b490d09d4108696e77cb2fd/mail/locales/en-US/chrome/messenger/addressbook/abCardOverlay.dtd">comparison</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd/mail/locales/en-US/chrome/messenger/addressbook/abCardOverlay.dtd">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mail/locales/en-US/chrome/messenger/messenger.dtd">mail/locales/en-US/chrome/messenger/messenger.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd/mail/locales/en-US/chrome/messenger/messenger.dtd">file</a> |
<a href="/comm-central/annotate/af30e12503ab60017b490d09d4108696e77cb2fd/mail/locales/en-US/chrome/messenger/messenger.dtd">annotate</a> |
<a href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mail/locales/en-US/chrome/messenger/messenger.dtd">diff</a> |
<a href="/comm-central/comparison/af30e12503ab60017b490d09d4108696e77cb2fd/mail/locales/en-US/chrome/messenger/messenger.dtd">comparison</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd/mail/locales/en-US/chrome/messenger/messenger.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/public/nsIAbCard.idl">mailnews/addrbook/public/nsIAbCard.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/public/nsIAbCard.idl">file</a> |
<a href="/comm-central/annotate/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/public/nsIAbCard.idl">annotate</a> |
<a href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/public/nsIAbCard.idl">diff</a> |
<a href="/comm-central/comparison/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/public/nsIAbCard.idl">comparison</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/public/nsIAbCard.idl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/public/nsIAddrDatabase.idl">mailnews/addrbook/public/nsIAddrDatabase.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/public/nsIAddrDatabase.idl">file</a> |
<a href="/comm-central/annotate/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/public/nsIAddrDatabase.idl">annotate</a> |
<a href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/public/nsIAddrDatabase.idl">diff</a> |
<a href="/comm-central/comparison/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/public/nsIAddrDatabase.idl">comparison</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/public/nsIAddrDatabase.idl">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAbCardProperty.cpp">mailnews/addrbook/src/nsAbCardProperty.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAbCardProperty.cpp">file</a> |
<a href="/comm-central/annotate/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAbCardProperty.cpp">annotate</a> |
<a href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAbCardProperty.cpp">diff</a> |
<a href="/comm-central/comparison/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAbCardProperty.cpp">comparison</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAbCardProperty.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAddrDatabase.cpp">mailnews/addrbook/src/nsAddrDatabase.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAddrDatabase.cpp">file</a> |
<a href="/comm-central/annotate/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAddrDatabase.cpp">annotate</a> |
<a href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAddrDatabase.cpp">diff</a> |
<a href="/comm-central/comparison/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAddrDatabase.cpp">comparison</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAddrDatabase.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAddrDatabase.h">mailnews/addrbook/src/nsAddrDatabase.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAddrDatabase.h">file</a> |
<a href="/comm-central/annotate/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAddrDatabase.h">annotate</a> |
<a href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAddrDatabase.h">diff</a> |
<a href="/comm-central/comparison/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAddrDatabase.h">comparison</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/addrbook/src/nsAddrDatabase.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/test/unit/data/remoteContent.mab">mailnews/base/test/unit/data/remoteContent.mab</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/test/unit/data/remoteContent.mab">file</a> |
<a href="/comm-central/annotate/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/test/unit/data/remoteContent.mab">annotate</a> |
<a href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/test/unit/data/remoteContent.mab">diff</a> |
<a href="/comm-central/comparison/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/test/unit/data/remoteContent.mab">comparison</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/test/unit/data/remoteContent.mab">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/test/unit/test_accountMigration.js">mailnews/base/test/unit/test_accountMigration.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/test/unit/test_accountMigration.js">file</a> |
<a href="/comm-central/annotate/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/test/unit/test_accountMigration.js">annotate</a> |
<a href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/test/unit/test_accountMigration.js">diff</a> |
<a href="/comm-central/comparison/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/test/unit/test_accountMigration.js">comparison</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/test/unit/test_accountMigration.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/util/mailnewsMigrator.js">mailnews/base/util/mailnewsMigrator.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/util/mailnewsMigrator.js">file</a> |
<a href="/comm-central/annotate/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/util/mailnewsMigrator.js">annotate</a> |
<a href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/util/mailnewsMigrator.js">diff</a> |
<a href="/comm-central/comparison/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/util/mailnewsMigrator.js">comparison</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/base/util/mailnewsMigrator.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/import/test/unit/resources/import_helper.js">mailnews/import/test/unit/resources/import_helper.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/import/test/unit/resources/import_helper.js">file</a> |
<a href="/comm-central/annotate/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/import/test/unit/resources/import_helper.js">annotate</a> |
<a href="/comm-central/diff/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/import/test/unit/resources/import_helper.js">diff</a> |
<a href="/comm-central/comparison/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/import/test/unit/resources/import_helper.js">comparison</a> |
<a href="/comm-central/log/af30e12503ab60017b490d09d4108696e77cb2fd/mailnews/import/test/unit/resources/import_helper.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/base/content/mailWindowOverlay.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/base/content/mailWindowOverlay.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -3047,89 +3047,28 @@ function LoadMsgWithRemoteContent()</span>
<a href="#l1.4"></a><span id="l1.4">   // change the &quot;remoteContentBar&quot; property on it</span>
<a href="#l1.5"></a><span id="l1.5">   // then reload the message</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7">   setMsgHdrPropertyAndReload(&quot;remoteContentPolicy&quot;, kAllowRemoteContent);</span>
<a href="#l1.8"></a><span id="l1.8">   window.content.focus();</span>
<a href="#l1.9"></a><span id="l1.9"> }</span>
<a href="#l1.10"></a><span id="l1.10"> </span>
<a href="#l1.11"></a><span id="l1.11"> /**</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">- *  Reloads the message after adjusting the remote content policy for the sender.</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">- *  Iterate through the local address books looking for a card with the same e-mail address as the</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineminus">- *  sender of the current loaded message. If we find a card, update the allow remote content field.</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineminus">- *  If we can't find a card, prompt the user with a new AB card dialog, pre-selecting the remote content field.</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineminus">- */</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineminus">-function allowRemoteContentForSender()</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineminus">-{</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineminus">-  // get the sender of the msg hdr</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineminus">-  let msgHdr = gMessageDisplay.displayedMessage;</span>
<a href="#l1.21"></a><span id="l1.21" class="difflineminus">-  if (!msgHdr)</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineminus">-    return;</span>
<a href="#l1.23"></a><span id="l1.23" class="difflineminus">-</span>
<a href="#l1.24"></a><span id="l1.24" class="difflineminus">-  let names = {};</span>
<a href="#l1.25"></a><span id="l1.25" class="difflineminus">-  let addresses = {};</span>
<a href="#l1.26"></a><span id="l1.26" class="difflineminus">-</span>
<a href="#l1.27"></a><span id="l1.27" class="difflineminus">-  MailServices.headerParser.parseHeadersWithArray(msgHdr.author, addresses, names, {});</span>
<a href="#l1.28"></a><span id="l1.28" class="difflineminus">-  let authorEmailAddress = addresses.value[0];</span>
<a href="#l1.29"></a><span id="l1.29" class="difflineminus">-  let authorDisplayName = names.value[0];</span>
<a href="#l1.30"></a><span id="l1.30" class="difflineminus">-</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineminus">-  // search through all of our local address books looking for a match.</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineminus">-  let enumerator = MailServices.ab.directories;</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineminus">-  var cardForEmailAddress;</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineminus">-  var addrbook;</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineminus">-  while (!cardForEmailAddress &amp;&amp; enumerator.hasMoreElements())</span>
<a href="#l1.36"></a><span id="l1.36" class="difflineminus">-  {</span>
<a href="#l1.37"></a><span id="l1.37" class="difflineminus">-    addrbook = enumerator.getNext()</span>
<a href="#l1.38"></a><span id="l1.38" class="difflineminus">-                         .QueryInterface(Components.interfaces.nsIAbDirectory);</span>
<a href="#l1.39"></a><span id="l1.39" class="difflineminus">-    // Try/catch because some cardForEmailAddress functions may not be</span>
<a href="#l1.40"></a><span id="l1.40" class="difflineminus">-    // implemented.</span>
<a href="#l1.41"></a><span id="l1.41" class="difflineminus">-    try {</span>
<a href="#l1.42"></a><span id="l1.42" class="difflineminus">-      // If its a read-only book, don't find a card as we won't be able</span>
<a href="#l1.43"></a><span id="l1.43" class="difflineminus">-      // to modify the card.</span>
<a href="#l1.44"></a><span id="l1.44" class="difflineminus">-      if (!addrbook.readOnly)</span>
<a href="#l1.45"></a><span id="l1.45" class="difflineminus">-        cardForEmailAddress = addrbook.cardForEmailAddress(authorEmailAddress);</span>
<a href="#l1.46"></a><span id="l1.46" class="difflineminus">-    } catch (e) {}</span>
<a href="#l1.47"></a><span id="l1.47" class="difflineminus">-  }</span>
<a href="#l1.48"></a><span id="l1.48" class="difflineminus">-</span>
<a href="#l1.49"></a><span id="l1.49" class="difflineminus">-  var allowRemoteContent = false;</span>
<a href="#l1.50"></a><span id="l1.50" class="difflineminus">-  if (cardForEmailAddress)</span>
<a href="#l1.51"></a><span id="l1.51" class="difflineminus">-  {</span>
<a href="#l1.52"></a><span id="l1.52" class="difflineminus">-    // set the property for remote content</span>
<a href="#l1.53"></a><span id="l1.53" class="difflineminus">-    cardForEmailAddress.setProperty(&quot;AllowRemoteContent&quot;, true);</span>
<a href="#l1.54"></a><span id="l1.54" class="difflineminus">-    addrbook.modifyCard(cardForEmailAddress);</span>
<a href="#l1.55"></a><span id="l1.55" class="difflineminus">-    allowRemoteContent = true;</span>
<a href="#l1.56"></a><span id="l1.56" class="difflineminus">-  }</span>
<a href="#l1.57"></a><span id="l1.57" class="difflineminus">-  else</span>
<a href="#l1.58"></a><span id="l1.58" class="difflineminus">-  {</span>
<a href="#l1.59"></a><span id="l1.59" class="difflineminus">-    let args = {primaryEmail:authorEmailAddress, displayName:authorDisplayName,</span>
<a href="#l1.60"></a><span id="l1.60" class="difflineminus">-                allowRemoteContent:true};</span>
<a href="#l1.61"></a><span id="l1.61" class="difflineminus">-    // create a new card and set the property</span>
<a href="#l1.62"></a><span id="l1.62" class="difflineminus">-    window.openDialog(&quot;chrome://messenger/content/addressbook/abNewCardDialog.xul&quot;,</span>
<a href="#l1.63"></a><span id="l1.63" class="difflineminus">-                      &quot;&quot;, &quot;chrome,resizable=no,titlebar,modal,centerscreen&quot;, args);</span>
<a href="#l1.64"></a><span id="l1.64" class="difflineminus">-    allowRemoteContent = args.allowRemoteContent;</span>
<a href="#l1.65"></a><span id="l1.65" class="difflineminus">-  }</span>
<a href="#l1.66"></a><span id="l1.66" class="difflineminus">-</span>
<a href="#l1.67"></a><span id="l1.67" class="difflineminus">-  // Reload the message if we've updated the remote content policy for the sender.</span>
<a href="#l1.68"></a><span id="l1.68" class="difflineminus">-  if (allowRemoteContent)</span>
<a href="#l1.69"></a><span id="l1.69" class="difflineminus">-    ReloadMessage();</span>
<a href="#l1.70"></a><span id="l1.70" class="difflineminus">-}</span>
<a href="#l1.71"></a><span id="l1.71" class="difflineminus">-</span>
<a href="#l1.72"></a><span id="l1.72" class="difflineminus">-/**</span>
<a href="#l1.73"></a><span id="l1.73">  * Populate the remote content options for the current message.</span>
<a href="#l1.74"></a><span id="l1.74">  */</span>
<a href="#l1.75"></a><span id="l1.75"> function onRemoteContentOptionsShowing(aEvent) {</span>
<a href="#l1.76"></a><span id="l1.76">   let hosts = aEvent.target.value ? aEvent.target.value.split(&quot; &quot;) : [];</span>
<a href="#l1.77"></a><span id="l1.77"> </span>
<a href="#l1.78"></a><span id="l1.78">   let addresses = {};</span>
<a href="#l1.79"></a><span id="l1.79">   MailServices.headerParser.parseHeadersWithArray(</span>
<a href="#l1.80"></a><span id="l1.80">     gMessageDisplay.displayedMessage.author, addresses, {}, {});</span>
<a href="#l1.81"></a><span id="l1.81">   let authorEmailAddress = addresses.value[0];</span>
<a href="#l1.82"></a><span id="l1.82">   // Needs bug 457296 policy patch to actually work, but I don't want to</span>
<a href="#l1.83"></a><span id="l1.83">   // keep this bug hostage for that, so just if-false it for now.</span>
<a href="#l1.84"></a><span id="l1.84" class="difflineminus">-  if (false &amp;&amp; authorEmailAddress)</span>
<a href="#l1.85"></a><span id="l1.85" class="difflineplus">+  if (authorEmailAddress)</span>
<a href="#l1.86"></a><span id="l1.86">     hosts.splice(0, 0, authorEmailAddress);</span>
<a href="#l1.87"></a><span id="l1.87"> </span>
<a href="#l1.88"></a><span id="l1.88">   let messengerBundle = document.getElementById(&quot;bundle_messenger&quot;);</span>
<a href="#l1.89"></a><span id="l1.89"> </span>
<a href="#l1.90"></a><span id="l1.90">   // Out with the old...</span>
<a href="#l1.91"></a><span id="l1.91">   let childNodes = aEvent.target.childNodes;</span>
<a href="#l1.92"></a><span id="l1.92">   for (let i = childNodes.length - 1; i &gt;= 0; i--) {</span>
<a href="#l1.93"></a><span id="l1.93">     if (childNodes[i].getAttribute(&quot;class&quot;) == &quot;allow-remote-uri&quot;)</span>
<a href="#l1.94"></a><span id="l1.94" class="difflineat">@@ -3141,26 +3080,26 @@ function onRemoteContentOptionsShowing(a</span>
<a href="#l1.95"></a><span id="l1.95">     let uri = Services.io.newURI(</span>
<a href="#l1.96"></a><span id="l1.96">       host.contains(&quot;@&quot;) ? &quot;mailto:&quot; + host : &quot;http://&quot; + host, null, null);</span>
<a href="#l1.97"></a><span id="l1.97"> </span>
<a href="#l1.98"></a><span id="l1.98">     let menuitem = document.createElement(&quot;menuitem&quot;);</span>
<a href="#l1.99"></a><span id="l1.99">     menuitem.setAttribute(&quot;label&quot;,</span>
<a href="#l1.100"></a><span id="l1.100">       messengerBundle.getFormattedString(&quot;remoteAllow&quot;, [host]));</span>
<a href="#l1.101"></a><span id="l1.101">     menuitem.setAttribute(&quot;value&quot;, uri.spec);</span>
<a href="#l1.102"></a><span id="l1.102">     menuitem.setAttribute(&quot;class&quot;, &quot;allow-remote-uri&quot;);</span>
<a href="#l1.103"></a><span id="l1.103" class="difflineminus">-    menuitem.setAttribute(&quot;oncommand&quot;, &quot;allowRemoteContentForSite(this.value);&quot;);</span>
<a href="#l1.104"></a><span id="l1.104" class="difflineplus">+    menuitem.setAttribute(&quot;oncommand&quot;, &quot;allowRemoteContentForURI(this.value);&quot;);</span>
<a href="#l1.105"></a><span id="l1.105">     aEvent.target.appendChild(menuitem);</span>
<a href="#l1.106"></a><span id="l1.106">   }</span>
<a href="#l1.107"></a><span id="l1.107"> }</span>
<a href="#l1.108"></a><span id="l1.108"> </span>
<a href="#l1.109"></a><span id="l1.109"> /**</span>
<a href="#l1.110"></a><span id="l1.110">  * Add privileges to display remote content for the given uri.</span>
<a href="#l1.111"></a><span id="l1.111">  * @param aUriSpec |String| uri for the site to add permissions for.</span>
<a href="#l1.112"></a><span id="l1.112">  */</span>
<a href="#l1.113"></a><span id="l1.113" class="difflineminus">-function allowRemoteContentForSite(aUriSpec) {</span>
<a href="#l1.114"></a><span id="l1.114" class="difflineplus">+function allowRemoteContentForURI(aUriSpec) {</span>
<a href="#l1.115"></a><span id="l1.115">   let uri = Services.io.newURI(aUriSpec, null, null);</span>
<a href="#l1.116"></a><span id="l1.116">   Services.perms.add(uri, &quot;image&quot;, Services.perms.ALLOW_ACTION);</span>
<a href="#l1.117"></a><span id="l1.117">   ReloadMessage();</span>
<a href="#l1.118"></a><span id="l1.118"> }</span>
<a href="#l1.119"></a><span id="l1.119"> </span>
<a href="#l1.120"></a><span id="l1.120"> /**</span>
<a href="#l1.121"></a><span id="l1.121">  * Displays fine-grained, per-site preferences for remote content.</span>
<a href="#l1.122"></a><span id="l1.122">  */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/mailWindowOverlay.xul</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/mailWindowOverlay.xul</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -983,21 +983,16 @@</span>
<a href="#l2.4"></a><span id="l2.4"> #ifdef XP_WIN</span>
<a href="#l2.5"></a><span id="l2.5">               label=&quot;&amp;editRemoteContentSettings.label;&quot;</span>
<a href="#l2.6"></a><span id="l2.6">               accesskey=&quot;&amp;editRemoteContentSettings.accesskey;&quot;</span>
<a href="#l2.7"></a><span id="l2.7"> #else</span>
<a href="#l2.8"></a><span id="l2.8">               label=&quot;&amp;editRemoteContentSettingsUnix.label;&quot;</span>
<a href="#l2.9"></a><span id="l2.9">               accesskey=&quot;&amp;editRemoteContentSettingsUnix.accesskey;&quot;</span>
<a href="#l2.10"></a><span id="l2.10"> #endif</span>
<a href="#l2.11"></a><span id="l2.11">               oncommand=&quot;editRemoteContentSettings();&quot;/&gt;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-&lt;!--    &lt;menuitem id=&quot;remoteContentOptionAllowForAddress&quot;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-              label=&quot;&amp;remoteContentOptionAllowForAddress.label;&quot;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineminus">-              accesskey=&quot;&amp;remoteContentOptionAllowForAddress.accesskey;&quot;</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineminus">-              oncommand=&quot;allowRemoteContentForSender();&quot;/&gt;</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineminus">---&gt;</span>
<a href="#l2.17"></a><span id="l2.17">   &lt;/menupopup&gt;</span>
<a href="#l2.18"></a><span id="l2.18"> </span>
<a href="#l2.19"></a><span id="l2.19">   &lt;menupopup id=&quot;phishingOptions&quot;&gt;</span>
<a href="#l2.20"></a><span id="l2.20">     &lt;menuitem id=&quot;phishingOptionIgnore&quot;</span>
<a href="#l2.21"></a><span id="l2.21">               label=&quot;&amp;phishingOptionIgnore.label;&quot;</span>
<a href="#l2.22"></a><span id="l2.22">               accesskey=&quot;&amp;phishingOptionIgnore.accesskey;&quot;</span>
<a href="#l2.23"></a><span id="l2.23">               oncommand=&quot;IgnorePhishingWarning();&quot;/&gt;</span>
<a href="#l2.24"></a><span id="l2.24">     &lt;menuitem id=&quot;phishingOptionSettings&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/components/addrbook/content/abCardOverlay.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/components/addrbook/content/abCardOverlay.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -3,17 +3,17 @@</span>
<a href="#l3.4"></a><span id="l3.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l3.5"></a><span id="l3.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l3.6"></a><span id="l3.6"> </span>
<a href="#l3.7"></a><span id="l3.7"> Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l3.8"></a><span id="l3.8"> Components.utils.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l3.9"></a><span id="l3.9"> </span>
<a href="#l3.10"></a><span id="l3.10"> const kNonVcardFields =</span>
<a href="#l3.11"></a><span id="l3.11">         [&quot;NickNameContainer&quot;, &quot;SecondaryEmailContainer&quot;, &quot;ScreenNameContainer&quot;,</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-         &quot;customFields&quot;, &quot;allowRemoteContent&quot;, &quot;preferDisplayName&quot;];</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+         &quot;customFields&quot;, &quot;preferDisplayName&quot;];</span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15"> const kPhoneticFields =</span>
<a href="#l3.16"></a><span id="l3.16">         [&quot;PhoneticLastName&quot;, &quot;PhoneticLabel1&quot;, &quot;PhoneticSpacer1&quot;,</span>
<a href="#l3.17"></a><span id="l3.17">          &quot;PhoneticFirstName&quot;, &quot;PhoneticLabel2&quot;, &quot;PhoneticSpacer2&quot;];</span>
<a href="#l3.18"></a><span id="l3.18"> </span>
<a href="#l3.19"></a><span id="l3.19"> // Item is |[dialogField, cardProperty]|.</span>
<a href="#l3.20"></a><span id="l3.20"> const kVcardFields =</span>
<a href="#l3.21"></a><span id="l3.21">         [ // Contact &gt; Name</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineat">@@ -117,19 +117,16 @@ function OnLoadNewCard()</span>
<a href="#l3.23"></a><span id="l3.23">       // a display name (and stomp on the existing display name)</span>
<a href="#l3.24"></a><span id="l3.24">       // when the user types a first or last name</span>
<a href="#l3.25"></a><span id="l3.25">       if (gEditCard.card.displayName)</span>
<a href="#l3.26"></a><span id="l3.26">         gEditCard.generateDisplayName = false;</span>
<a href="#l3.27"></a><span id="l3.27">     }</span>
<a href="#l3.28"></a><span id="l3.28">     if (&quot;aimScreenName&quot; in window.arguments[0])</span>
<a href="#l3.29"></a><span id="l3.29">       gEditCard.card.setProperty(&quot;_AimScreenName&quot;,</span>
<a href="#l3.30"></a><span id="l3.30">                                  window.arguments[0].aimScreenName);</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-    if (&quot;allowRemoteContent&quot; in window.arguments[0])</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineminus">-      gEditCard.card.setProperty(&quot;AllowRemoteContent&quot;,</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineminus">-                                 window.arguments[0].allowRemoteContent);</span>
<a href="#l3.34"></a><span id="l3.34"> </span>
<a href="#l3.35"></a><span id="l3.35">     if (&quot;okCallback&quot; in window.arguments[0])</span>
<a href="#l3.36"></a><span id="l3.36">       gOkCallback = window.arguments[0].okCallback;</span>
<a href="#l3.37"></a><span id="l3.37"> </span>
<a href="#l3.38"></a><span id="l3.38">     if (&quot;escapedVCardStr&quot; in window.arguments[0]) {</span>
<a href="#l3.39"></a><span id="l3.39">       // hide non vcard values</span>
<a href="#l3.40"></a><span id="l3.40">       HideNonVcardFields();</span>
<a href="#l3.41"></a><span id="l3.41">       gEditCard.card =</span>
<a href="#l3.42"></a><span id="l3.42" class="difflineat">@@ -284,28 +281,23 @@ function OnLoadEditCard()</span>
<a href="#l3.43"></a><span id="l3.43">         document.getElementById(&quot;UpdatePhoto&quot;).disabled      = true;</span>
<a href="#l3.44"></a><span id="l3.44"> </span>
<a href="#l3.45"></a><span id="l3.45">         // And the phonetic fields</span>
<a href="#l3.46"></a><span id="l3.46">         document.getElementById(kPhoneticFields[0]).readOnly = true;</span>
<a href="#l3.47"></a><span id="l3.47">         document.getElementById(kPhoneticFields[3]).readOnly = true;</span>
<a href="#l3.48"></a><span id="l3.48"> </span>
<a href="#l3.49"></a><span id="l3.49">         // Also disable the mail format popup and allow remote content items.</span>
<a href="#l3.50"></a><span id="l3.50">         document.getElementById(&quot;PreferMailFormatPopup&quot;).disabled = true;</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineminus">-        document.getElementById(&quot;allowRemoteContent&quot;).disabled = true;</span>
<a href="#l3.52"></a><span id="l3.52"> </span>
<a href="#l3.53"></a><span id="l3.53">         // And the &quot;prefer display name&quot; checkbox</span>
<a href="#l3.54"></a><span id="l3.54">         document.getElementById(&quot;preferDisplayName&quot;).disabled = true;</span>
<a href="#l3.55"></a><span id="l3.55"> </span>
<a href="#l3.56"></a><span id="l3.56">         document.documentElement.buttons = &quot;accept&quot;;</span>
<a href="#l3.57"></a><span id="l3.57">         document.documentElement.removeAttribute(&quot;ondialogaccept&quot;);</span>
<a href="#l3.58"></a><span id="l3.58">       }</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineminus">-      </span>
<a href="#l3.60"></a><span id="l3.60" class="difflineminus">-      // hide  remote content in HTML field for remote directories</span>
<a href="#l3.61"></a><span id="l3.61" class="difflineminus">-      if (directory.isRemote)</span>
<a href="#l3.62"></a><span id="l3.62" class="difflineminus">-        document.getElementById('allowRemoteContent').hidden = true;</span>
<a href="#l3.63"></a><span id="l3.63">     }</span>
<a href="#l3.64"></a><span id="l3.64">   }</span>
<a href="#l3.65"></a><span id="l3.65"> }</span>
<a href="#l3.66"></a><span id="l3.66"> </span>
<a href="#l3.67"></a><span id="l3.67"> /* Registers functions that are called when loading the card</span>
<a href="#l3.68"></a><span id="l3.68">  * values into the contact editor dialog.  This is useful if</span>
<a href="#l3.69"></a><span id="l3.69">  * extensions have added extra fields to the nsIAbCard, and</span>
<a href="#l3.70"></a><span id="l3.70">  * need to display them in the contact editor.</span>
<a href="#l3.71"></a><span id="l3.71" class="difflineat">@@ -429,22 +421,16 @@ function NewCardOKButton()</span>
<a href="#l3.72"></a><span id="l3.72">         return false;  // don't close window</span>
<a href="#l3.73"></a><span id="l3.73"> </span>
<a href="#l3.74"></a><span id="l3.74">       // replace gEditCard.card with the card we added</span>
<a href="#l3.75"></a><span id="l3.75">       // so that save listeners can get / set attributes on</span>
<a href="#l3.76"></a><span id="l3.76">       // the card that got created.</span>
<a href="#l3.77"></a><span id="l3.77">       var directory = GetDirectoryFromURI(uri);</span>
<a href="#l3.78"></a><span id="l3.78">       gEditCard.card = directory.addCard(gEditCard.card);</span>
<a href="#l3.79"></a><span id="l3.79">       NotifySaveListeners(directory);</span>
<a href="#l3.80"></a><span id="l3.80" class="difflineminus">-      if (&quot;arguments&quot; in window &amp;&amp; window.arguments[0] &amp;&amp;</span>
<a href="#l3.81"></a><span id="l3.81" class="difflineminus">-          &quot;allowRemoteContent&quot; in window.arguments[0]) {</span>
<a href="#l3.82"></a><span id="l3.82" class="difflineminus">-        // getProperty may return a &quot;1&quot; or &quot;0&quot; string, we want a boolean</span>
<a href="#l3.83"></a><span id="l3.83" class="difflineminus">-        window.arguments[0].allowRemoteContent =</span>
<a href="#l3.84"></a><span id="l3.84" class="difflineminus">-          gEditCard.card.getProperty(&quot;AllowRemoteContent&quot;, false) != false;</span>
<a href="#l3.85"></a><span id="l3.85" class="difflineminus">-      }</span>
<a href="#l3.86"></a><span id="l3.86">     }</span>
<a href="#l3.87"></a><span id="l3.87">   }</span>
<a href="#l3.88"></a><span id="l3.88"> </span>
<a href="#l3.89"></a><span id="l3.89">   return true;  // close the window</span>
<a href="#l3.90"></a><span id="l3.90"> }</span>
<a href="#l3.91"></a><span id="l3.91"> </span>
<a href="#l3.92"></a><span id="l3.92"> // Move the data from the cardproperty to the dialog</span>
<a href="#l3.93"></a><span id="l3.93"> function GetCardValues(cardproperty, doc)</span>
<a href="#l3.94"></a><span id="l3.94" class="difflineat">@@ -495,21 +481,16 @@ function GetCardValues(cardproperty, doc</span>
<a href="#l3.95"></a><span id="l3.95">   birthday.onchange = calculateAge;</span>
<a href="#l3.96"></a><span id="l3.96">   var age = doc.getElementById(&quot;Age&quot;);</span>
<a href="#l3.97"></a><span id="l3.97">   age.onchange = calculateYear;</span>
<a href="#l3.98"></a><span id="l3.98"> </span>
<a href="#l3.99"></a><span id="l3.99">   var popup = document.getElementById(&quot;PreferMailFormatPopup&quot;);</span>
<a href="#l3.100"></a><span id="l3.100">   if (popup)</span>
<a href="#l3.101"></a><span id="l3.101">     popup.value = cardproperty.getProperty(&quot;PreferMailFormat&quot;, &quot;&quot;);</span>
<a href="#l3.102"></a><span id="l3.102"> </span>
<a href="#l3.103"></a><span id="l3.103" class="difflineminus">-  var allowRemoteContentEl = document.getElementById(&quot;allowRemoteContent&quot;);</span>
<a href="#l3.104"></a><span id="l3.104" class="difflineminus">-  if (allowRemoteContentEl)</span>
<a href="#l3.105"></a><span id="l3.105" class="difflineminus">-    // getProperty may return a &quot;1&quot; or &quot;0&quot; string, we want a boolean</span>
<a href="#l3.106"></a><span id="l3.106" class="difflineminus">-    allowRemoteContentEl.checked = cardproperty.getProperty(&quot;AllowRemoteContent&quot;, false) != false;</span>
<a href="#l3.107"></a><span id="l3.107" class="difflineminus">-</span>
<a href="#l3.108"></a><span id="l3.108">   var preferDisplayNameEl = document.getElementById(&quot;preferDisplayName&quot;);</span>
<a href="#l3.109"></a><span id="l3.109">   if (preferDisplayNameEl)</span>
<a href="#l3.110"></a><span id="l3.110">     // getProperty may return a &quot;1&quot; or &quot;0&quot; string, we want a boolean</span>
<a href="#l3.111"></a><span id="l3.111">     preferDisplayNameEl.checked = cardproperty.getProperty(&quot;PreferDisplayName&quot;, true) != false;</span>
<a href="#l3.112"></a><span id="l3.112"> </span>
<a href="#l3.113"></a><span id="l3.113">   // get phonetic fields if exist</span>
<a href="#l3.114"></a><span id="l3.114">   try {</span>
<a href="#l3.115"></a><span id="l3.115">     doc.getElementById(&quot;PhoneticFirstName&quot;).value = cardproperty.getProperty(&quot;PhoneticFirstName&quot;, &quot;&quot;);</span>
<a href="#l3.116"></a><span id="l3.116" class="difflineat">@@ -568,20 +549,16 @@ function CheckAndSetCardValues(cardprope</span>
<a href="#l3.117"></a><span id="l3.117">   // set the birth day, month, and year properties</span>
<a href="#l3.118"></a><span id="l3.118">   cardproperty.setProperty(&quot;BirthDay&quot;, birthDay);</span>
<a href="#l3.119"></a><span id="l3.119">   cardproperty.setProperty(&quot;BirthMonth&quot;, birthMonth);</span>
<a href="#l3.120"></a><span id="l3.120">   cardproperty.setProperty(&quot;BirthYear&quot;, birthYear);</span>
<a href="#l3.121"></a><span id="l3.121"> </span>
<a href="#l3.122"></a><span id="l3.122">   var popup = document.getElementById(&quot;PreferMailFormatPopup&quot;);</span>
<a href="#l3.123"></a><span id="l3.123">   if (popup)</span>
<a href="#l3.124"></a><span id="l3.124">     cardproperty.setProperty(&quot;PreferMailFormat&quot;, popup.value);</span>
<a href="#l3.125"></a><span id="l3.125" class="difflineminus">-    </span>
<a href="#l3.126"></a><span id="l3.126" class="difflineminus">-  var allowRemoteContentEl = document.getElementById(&quot;allowRemoteContent&quot;);</span>
<a href="#l3.127"></a><span id="l3.127" class="difflineminus">-  if (allowRemoteContentEl)</span>
<a href="#l3.128"></a><span id="l3.128" class="difflineminus">-    cardproperty.setProperty(&quot;AllowRemoteContent&quot;, allowRemoteContentEl.checked);</span>
<a href="#l3.129"></a><span id="l3.129"> </span>
<a href="#l3.130"></a><span id="l3.130">   var preferDisplayNameEl = document.getElementById(&quot;preferDisplayName&quot;);</span>
<a href="#l3.131"></a><span id="l3.131">   if (preferDisplayNameEl)</span>
<a href="#l3.132"></a><span id="l3.132">     cardproperty.setProperty(&quot;PreferDisplayName&quot;, preferDisplayNameEl.checked);</span>
<a href="#l3.133"></a><span id="l3.133"> </span>
<a href="#l3.134"></a><span id="l3.134">   // set phonetic fields if exist</span>
<a href="#l3.135"></a><span id="l3.135">   try {</span>
<a href="#l3.136"></a><span id="l3.136">     cardproperty.setProperty(&quot;PhoneticFirstName&quot;, doc.getElementById(&quot;PhoneticFirstName&quot;).value);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/components/addrbook/content/abCardOverlay.xul</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/components/addrbook/content/abCardOverlay.xul</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -178,20 +178,16 @@</span>
<a href="#l4.4"></a><span id="l4.4">           &lt;menulist id=&quot;PreferMailFormatPopup&quot;&gt;</span>
<a href="#l4.5"></a><span id="l4.5">             &lt;menupopup&gt;</span>
<a href="#l4.6"></a><span id="l4.6">               &lt;!-- 0,1,2 come from nsIAbPreferMailFormat in nsIAbCard.idl --&gt;</span>
<a href="#l4.7"></a><span id="l4.7">               &lt;menuitem value=&quot;0&quot; label=&quot;&amp;Unknown.label;&quot;/&gt;</span>
<a href="#l4.8"></a><span id="l4.8">               &lt;menuitem value=&quot;1&quot; label=&quot;&amp;PlainText.label;&quot;/&gt;</span>
<a href="#l4.9"></a><span id="l4.9">               &lt;menuitem value=&quot;2&quot; label=&quot;&amp;HTML.label;&quot;/&gt;</span>
<a href="#l4.10"></a><span id="l4.10">             &lt;/menupopup&gt;</span>
<a href="#l4.11"></a><span id="l4.11">           &lt;/menulist&gt;</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-          &lt;checkbox id=&quot;allowRemoteContent&quot; label=&quot;&amp;allowRemoteContent1.label;&quot;</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-                    accesskey=&quot;&amp;allowRemoteContent1.accesskey;&quot;</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">-                    tooltiptext=&quot;&amp;allowRemoteContent1.tooltip;&quot;/&gt;</span>
<a href="#l4.16"></a><span id="l4.16">         &lt;/hbox&gt;</span>
<a href="#l4.17"></a><span id="l4.17">       &lt;/vbox&gt; &lt;!-- End of Name Tab --&gt;</span>
<a href="#l4.18"></a><span id="l4.18"> </span>
<a href="#l4.19"></a><span id="l4.19">       &lt;!-- ** Home Address Tab ** --&gt;</span>
<a href="#l4.20"></a><span id="l4.20">       &lt;vbox id=&quot;abHomeTab&quot; &gt;</span>
<a href="#l4.21"></a><span id="l4.21">         &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l4.22"></a><span id="l4.22">           &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l4.23"></a><span id="l4.23">           &lt;label control=&quot;HomeAddress&quot; value=&quot;&amp;HomeAddress.label;&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/addressbook/abCardOverlay.dtd</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/addressbook/abCardOverlay.dtd</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -42,24 +42,16 @@</span>
<a href="#l5.4"></a><span id="l5.4"> &lt;!ENTITY SecondEmail.accesskey          &quot;i&quot;&gt;</span>
<a href="#l5.5"></a><span id="l5.5"> &lt;!ENTITY PreferMailFormat.label         &quot;Prefers to receive messages formatted as:&quot;&gt;</span>
<a href="#l5.6"></a><span id="l5.6"> &lt;!ENTITY PreferMailFormat.accesskey     &quot;v&quot;&gt;</span>
<a href="#l5.7"></a><span id="l5.7"> &lt;!ENTITY PlainText.label                &quot;Plain Text&quot;&gt;</span>
<a href="#l5.8"></a><span id="l5.8"> &lt;!ENTITY HTML.label                     &quot;HTML&quot;&gt;</span>
<a href="#l5.9"></a><span id="l5.9"> &lt;!ENTITY Unknown.label                  &quot;Unknown&quot;&gt;</span>
<a href="#l5.10"></a><span id="l5.10"> &lt;!ENTITY chatName.label                 &quot;Chat Name:&quot;&gt;</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-&lt;!ENTITY allowRemoteContent1.label      &quot;Allow remote content.&quot;&gt;</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-&lt;!ENTITY allowRemoteContent1.accesskey  &quot;r&quot;&gt;</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineminus">-&lt;!ENTITY allowRemoteContent1.tooltip    &quot;In HTML messages it is possible to</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineminus">-embed content from remote sources. Opening such a message will open a</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineminus">-connection to this external source. This may allow tracking of the</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineminus">-message being read. Checking this box will allow such external embedded</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineminus">-content in HTML messages from this contact.&quot;&gt;</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineminus">-</span>
<a href="#l5.20"></a><span id="l5.20"> &lt;!ENTITY WorkPhone.label                &quot;Work:&quot;&gt;</span>
<a href="#l5.21"></a><span id="l5.21"> &lt;!ENTITY WorkPhone.accesskey            &quot;k&quot;&gt;</span>
<a href="#l5.22"></a><span id="l5.22"> &lt;!ENTITY HomePhone.label                &quot;Home:&quot;&gt;</span>
<a href="#l5.23"></a><span id="l5.23"> &lt;!ENTITY HomePhone.accesskey            &quot;m&quot;&gt;</span>
<a href="#l5.24"></a><span id="l5.24"> &lt;!ENTITY FaxNumber.label                &quot;Fax:&quot;&gt;</span>
<a href="#l5.25"></a><span id="l5.25"> &lt;!ENTITY FaxNumber.accesskey            &quot;x&quot;&gt;</span>
<a href="#l5.26"></a><span id="l5.26"> &lt;!ENTITY PagerNumber.label              &quot;Pager:&quot;&gt;</span>
<a href="#l5.27"></a><span id="l5.27"> &lt;!ENTITY PagerNumber.accesskey          &quot;g&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -558,18 +558,16 @@</span>
<a href="#l6.4"></a><span id="l6.4"> </span>
<a href="#l6.5"></a><span id="l6.5"> &lt;!-- Toolbar Button Popup --&gt;</span>
<a href="#l6.6"></a><span id="l6.6"> &lt;!ENTITY buttonMenuForwardAsInline.label &quot;Forward Inline&quot;&gt;</span>
<a href="#l6.7"></a><span id="l6.7"> &lt;!ENTITY buttonMenuForwardAsAttachment.label &quot;Forward As Attachment&quot;&gt;</span>
<a href="#l6.8"></a><span id="l6.8"> </span>
<a href="#l6.9"></a><span id="l6.9"> &lt;!-- Remote Content Button Popup --&gt;</span>
<a href="#l6.10"></a><span id="l6.10"> &lt;!ENTITY remoteContentOptionsAllowForMsg.label &quot;Show remote content in this message&quot;&gt;</span>
<a href="#l6.11"></a><span id="l6.11"> &lt;!ENTITY remoteContentOptionsAllowForMsg.accesskey &quot;S&quot;&gt;</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-&lt;!ENTITY remoteContentOptionAllowForAddress.label &quot;Show remote content from this sender&quot;&gt;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-&lt;!ENTITY remoteContentOptionAllowForAddress.accesskey &quot;f&quot;&gt;</span>
<a href="#l6.14"></a><span id="l6.14"> &lt;!ENTITY editRemoteContentSettings.label &quot;Edit remote content options&quot;&gt;</span>
<a href="#l6.15"></a><span id="l6.15"> &lt;!ENTITY editRemoteContentSettings.accesskey &quot;E&quot;&gt;</span>
<a href="#l6.16"></a><span id="l6.16"> &lt;!ENTITY editRemoteContentSettingsUnix.label &quot;Edit remote content preferences&quot;&gt;</span>
<a href="#l6.17"></a><span id="l6.17"> &lt;!ENTITY editRemoteContentSettingsUnix.accesskey &quot;E&quot;&gt;</span>
<a href="#l6.18"></a><span id="l6.18"> </span>
<a href="#l6.19"></a><span id="l6.19"> &lt;!-- Phishing Button Popup --&gt;</span>
<a href="#l6.20"></a><span id="l6.20"> &lt;!ENTITY phishingOptionIgnore.label &quot;Ignore warning for this message&quot;&gt;</span>
<a href="#l6.21"></a><span id="l6.21"> &lt;!ENTITY phishingOptionIgnore.accesskey &quot;n&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/addrbook/public/nsIAbCard.idl</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/addrbook/public/nsIAbCard.idl</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -52,18 +52,16 @@ interface nsIAbPreferMailFormat {</span>
<a href="#l7.4"></a><span id="l7.4">  *   - BirthYear, BirthMonth, BirthDay</span>
<a href="#l7.5"></a><span id="l7.5">  * - WebPage1 (work), WebPage2 (home)</span>
<a href="#l7.6"></a><span id="l7.6">  * - Custom1, Custom2, Custom3, Custom4</span>
<a href="#l7.7"></a><span id="l7.7">  * - Notes</span>
<a href="#l7.8"></a><span id="l7.8">  * - Integral properties:</span>
<a href="#l7.9"></a><span id="l7.9">  *   - LastModifiedDate</span>
<a href="#l7.10"></a><span id="l7.10">  *   - PopularityIndex</span>
<a href="#l7.11"></a><span id="l7.11">  *   - PreferMailFormat (see nsIAbPreferMailFormat)</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">- * - Boolean properties:</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">- *   - AllowRemoteContent</span>
<a href="#l7.14"></a><span id="l7.14">  * - Photo properties:</span>
<a href="#l7.15"></a><span id="l7.15">  *   - PhotoName</span>
<a href="#l7.16"></a><span id="l7.16">  *   - PhotoType</span>
<a href="#l7.17"></a><span id="l7.17">  *   - PhotoURI</span>
<a href="#l7.18"></a><span id="l7.18">  *</span>
<a href="#l7.19"></a><span id="l7.19">  * The contract id for the standard implementation is</span>
<a href="#l7.20"></a><span id="l7.20">  * &lt;tt&gt;\@mozilla.org/addressbook/cardproperty;1&lt;/tt&gt;.</span>
<a href="#l7.21"></a><span id="l7.21">  */</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineat">@@ -292,17 +290,16 @@ interface nsIAbCard : nsIAbItem {</span>
<a href="#l7.23"></a><span id="l7.23"> #define kFirstNameProperty          &quot;FirstName&quot;</span>
<a href="#l7.24"></a><span id="l7.24"> #define kLastNameProperty           &quot;LastName&quot;</span>
<a href="#l7.25"></a><span id="l7.25"> #define kDisplayNameProperty        &quot;DisplayName&quot;</span>
<a href="#l7.26"></a><span id="l7.26"> #define kNicknameProperty           &quot;NickName&quot;</span>
<a href="#l7.27"></a><span id="l7.27"> #define kPriEmailProperty           &quot;PrimaryEmail&quot;</span>
<a href="#l7.28"></a><span id="l7.28"> #define kPreferMailFormatProperty   &quot;PreferMailFormat&quot;</span>
<a href="#l7.29"></a><span id="l7.29"> #define kLastModifiedDateProperty   &quot;LastModifiedDate&quot;</span>
<a href="#l7.30"></a><span id="l7.30"> #define kPopularityIndexProperty    &quot;PopularityIndex&quot;</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineminus">-#define kAllowRemoteContentProperty &quot;AllowRemoteContent&quot;</span>
<a href="#l7.32"></a><span id="l7.32"> </span>
<a href="#l7.33"></a><span id="l7.33"> #define kPhoneticFirstNameProperty  &quot;PhoneticFirstName&quot;</span>
<a href="#l7.34"></a><span id="l7.34"> #define kPhoneticLastNameProperty   &quot;PhoneticLastName&quot;</span>
<a href="#l7.35"></a><span id="l7.35"> #define kSpouseNameProperty         &quot;SpouseName&quot;</span>
<a href="#l7.36"></a><span id="l7.36"> #define kFamilyNameProperty         &quot;FamilyName&quot;</span>
<a href="#l7.37"></a><span id="l7.37"> #define k2ndEmailProperty           &quot;SecondEmail&quot;</span>
<a href="#l7.38"></a><span id="l7.38"> </span>
<a href="#l7.39"></a><span id="l7.39"> #define kHomeAddressProperty        &quot;HomeAddress&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/addrbook/public/nsIAddrDatabase.idl</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/addrbook/public/nsIAddrDatabase.idl</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -43,17 +43,17 @@ interface nsISimpleEnumerator;</span>
<a href="#l8.4"></a><span id="l8.4"> [scriptable, uuid(20d4c6c3-0460-403e-aa9c-813654641566)]</span>
<a href="#l8.5"></a><span id="l8.5"> interface nsAddrDBCommitType </span>
<a href="#l8.6"></a><span id="l8.6"> {</span>
<a href="#l8.7"></a><span id="l8.7">   const long kLargeCommit = 1;</span>
<a href="#l8.8"></a><span id="l8.8">   const long kSessionCommit = 2;</span>
<a href="#l8.9"></a><span id="l8.9">   const long kCompressCommit = 3;</span>
<a href="#l8.10"></a><span id="l8.10"> };</span>
<a href="#l8.11"></a><span id="l8.11"> </span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-[scriptable, uuid(a71d3d0d-5605-4dd9-8ac1-b258cc3bda93)]</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+[scriptable, uuid(c54973e4-d251-4b93-a0d0-81a616225061)]</span>
<a href="#l8.14"></a><span id="l8.14"> interface nsIAddrDatabase : nsIAddrDBAnnouncer {</span>
<a href="#l8.15"></a><span id="l8.15"> </span>
<a href="#l8.16"></a><span id="l8.16">   /**</span>
<a href="#l8.17"></a><span id="l8.17">    * Path to the address book database that this instance represents.</span>
<a href="#l8.18"></a><span id="l8.18">    */</span>
<a href="#l8.19"></a><span id="l8.19">   attribute nsIFile dbPath;</span>
<a href="#l8.20"></a><span id="l8.20">   nsIAddrDatabase open(in nsIFile dbFile, in boolean create, in boolean upgrading);</span>
<a href="#l8.21"></a><span id="l8.21">              </span>
<a href="#l8.22"></a><span id="l8.22" class="difflineat">@@ -253,17 +253,16 @@ interface nsIAddrDatabase : nsIAddrDBAnn</span>
<a href="#l8.23"></a><span id="l8.23">   [noscript] void addBirthDay(in nsIMdbRow row, in string value);</span>
<a href="#l8.24"></a><span id="l8.24">   [noscript] void addCustom1(in nsIMdbRow row, in string value);</span>
<a href="#l8.25"></a><span id="l8.25">   [noscript] void addCustom2(in nsIMdbRow row, in string value);</span>
<a href="#l8.26"></a><span id="l8.26">   [noscript] void addCustom3(in nsIMdbRow row, in string value);</span>
<a href="#l8.27"></a><span id="l8.27">   [noscript] void addCustom4(in nsIMdbRow row, in string value);</span>
<a href="#l8.28"></a><span id="l8.28">   [noscript] void addNotes(in nsIMdbRow row, in string value);</span>
<a href="#l8.29"></a><span id="l8.29">   [noscript] void addPreferMailFormat(in nsIMdbRow row, in unsigned long value);</span>
<a href="#l8.30"></a><span id="l8.30">   [noscript] void addPopularityIndex(in nsIMdbRow row, in unsigned long value);</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineminus">-  [noscript] void addAllowRemoteContent(in nsIMdbRow row, in boolean value);</span>
<a href="#l8.32"></a><span id="l8.32"> </span>
<a href="#l8.33"></a><span id="l8.33">   [noscript] void addListName(in nsIMdbRow row, in string value);</span>
<a href="#l8.34"></a><span id="l8.34">   [noscript] void addListNickName(in nsIMdbRow row, in string value);</span>
<a href="#l8.35"></a><span id="l8.35">   [noscript] void addListDescription(in nsIMdbRow row, in string value);</span>
<a href="#l8.36"></a><span id="l8.36">   [noscript] void addListDirNode(in nsIMdbRow listRow);</span>
<a href="#l8.37"></a><span id="l8.37"> </span>
<a href="#l8.38"></a><span id="l8.38">   /**</span>
<a href="#l8.39"></a><span id="l8.39">    * use for getting and setting generic string attributes</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAbCardProperty.cpp</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAbCardProperty.cpp</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -107,17 +107,16 @@ static const AppendItem CHAT_ATTRS_ARRAY</span>
<a href="#l9.4"></a><span id="l9.4"> nsAbCardProperty::nsAbCardProperty()</span>
<a href="#l9.5"></a><span id="l9.5">   : m_IsMailList(false)</span>
<a href="#l9.6"></a><span id="l9.6"> {</span>
<a href="#l9.7"></a><span id="l9.7">   // Initialize some default properties</span>
<a href="#l9.8"></a><span id="l9.8">   SetPropertyAsUint32(kPreferMailFormatProperty, nsIAbPreferMailFormat::unknown);</span>
<a href="#l9.9"></a><span id="l9.9">   SetPropertyAsUint32(kPopularityIndexProperty, 0);</span>
<a href="#l9.10"></a><span id="l9.10">   // Uninitialized...</span>
<a href="#l9.11"></a><span id="l9.11">   SetPropertyAsUint32(kLastModifiedDateProperty, 0);</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-  SetPropertyAsBool(kAllowRemoteContentProperty, false);</span>
<a href="#l9.13"></a><span id="l9.13"> }</span>
<a href="#l9.14"></a><span id="l9.14"> </span>
<a href="#l9.15"></a><span id="l9.15"> nsAbCardProperty::~nsAbCardProperty(void)</span>
<a href="#l9.16"></a><span id="l9.16"> {</span>
<a href="#l9.17"></a><span id="l9.17"> }</span>
<a href="#l9.18"></a><span id="l9.18"> </span>
<a href="#l9.19"></a><span id="l9.19"> NS_IMPL_ISUPPORTS(nsAbCardProperty, nsIAbCard, nsIAbItem)</span>
<a href="#l9.20"></a><span id="l9.20"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAddrDatabase.cpp</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAddrDatabase.cpp</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -122,17 +122,16 @@ nsAddrDatabase::nsAddrDatabase()</span>
<a href="#l10.4"></a><span id="l10.4">       m_Custom1ColumnToken(0),</span>
<a href="#l10.5"></a><span id="l10.5">       m_Custom2ColumnToken(0),</span>
<a href="#l10.6"></a><span id="l10.6">       m_Custom3ColumnToken(0),</span>
<a href="#l10.7"></a><span id="l10.7">       m_Custom4ColumnToken(0),</span>
<a href="#l10.8"></a><span id="l10.8">       m_NotesColumnToken(0),</span>
<a href="#l10.9"></a><span id="l10.9">       m_LastModDateColumnToken(0),</span>
<a href="#l10.10"></a><span id="l10.10">       m_MailFormatColumnToken(0),</span>
<a href="#l10.11"></a><span id="l10.11">       m_PopularityIndexColumnToken(0),</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-      m_AllowRemoteContentColumnToken(0),</span>
<a href="#l10.13"></a><span id="l10.13">       m_AddressCharSetColumnToken(0),</span>
<a href="#l10.14"></a><span id="l10.14">       m_LastRecordKey(0),</span>
<a href="#l10.15"></a><span id="l10.15">       m_dbDirectory(nullptr)</span>
<a href="#l10.16"></a><span id="l10.16"> {</span>
<a href="#l10.17"></a><span id="l10.17"> }</span>
<a href="#l10.18"></a><span id="l10.18"> </span>
<a href="#l10.19"></a><span id="l10.19"> nsAddrDatabase::~nsAddrDatabase()</span>
<a href="#l10.20"></a><span id="l10.20"> {</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineat">@@ -1057,17 +1056,16 @@ nsresult nsAddrDatabase::InitMDBInfo()</span>
<a href="#l10.22"></a><span id="l10.22">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  kDisplayNameProperty, &amp;m_DisplayNameColumnToken);</span>
<a href="#l10.23"></a><span id="l10.23">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  kNicknameProperty, &amp;m_NickNameColumnToken);</span>
<a href="#l10.24"></a><span id="l10.24">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  kPriEmailProperty, &amp;m_PriEmailColumnToken);</span>
<a href="#l10.25"></a><span id="l10.25">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  kLowerPriEmailColumn, &amp;m_LowerPriEmailColumnToken);</span>
<a href="#l10.26"></a><span id="l10.26">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  k2ndEmailProperty, &amp;m_2ndEmailColumnToken);</span>
<a href="#l10.27"></a><span id="l10.27">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  kLower2ndEmailColumn, &amp;m_Lower2ndEmailColumnToken);</span>
<a href="#l10.28"></a><span id="l10.28">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  kPreferMailFormatProperty, &amp;m_MailFormatColumnToken);</span>
<a href="#l10.29"></a><span id="l10.29">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  kPopularityIndexProperty, &amp;m_PopularityIndexColumnToken);</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineminus">-      m_mdbStore-&gt;StringToToken(m_mdbEnv,  kAllowRemoteContentProperty, &amp;m_AllowRemoteContentColumnToken);</span>
<a href="#l10.31"></a><span id="l10.31">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  kWorkPhoneProperty, &amp;m_WorkPhoneColumnToken);</span>
<a href="#l10.32"></a><span id="l10.32">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  kHomePhoneProperty, &amp;m_HomePhoneColumnToken);</span>
<a href="#l10.33"></a><span id="l10.33">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  kFaxProperty, &amp;m_FaxColumnToken);</span>
<a href="#l10.34"></a><span id="l10.34">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  kPagerProperty, &amp;m_PagerColumnToken);</span>
<a href="#l10.35"></a><span id="l10.35">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  kCellularProperty, &amp;m_CellularColumnToken);</span>
<a href="#l10.36"></a><span id="l10.36">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  kWorkPhoneTypeProperty, &amp;m_WorkPhoneTypeColumnToken);</span>
<a href="#l10.37"></a><span id="l10.37">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  kHomePhoneTypeProperty, &amp;m_HomePhoneTypeColumnToken);</span>
<a href="#l10.38"></a><span id="l10.38">       m_mdbStore-&gt;StringToToken(m_mdbEnv,  kFaxTypeProperty, &amp;m_FaxTypeColumnToken);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/addrbook/src/nsAddrDatabase.h</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/addrbook/src/nsAddrDatabase.h</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -93,19 +93,16 @@ public:</span>
<a href="#l11.4"></a><span id="l11.4">   NS_IMETHOD Add2ndEmail(nsIMdbRow * row, const char * value) MOZ_OVERRIDE;</span>
<a href="#l11.5"></a><span id="l11.5"> </span>
<a href="#l11.6"></a><span id="l11.6">   NS_IMETHOD AddPreferMailFormat(nsIMdbRow * row, uint32_t value) MOZ_OVERRIDE</span>
<a href="#l11.7"></a><span id="l11.7">   { return AddIntColumn(row, m_MailFormatColumnToken, value); }</span>
<a href="#l11.8"></a><span id="l11.8"> </span>
<a href="#l11.9"></a><span id="l11.9">   NS_IMETHOD AddPopularityIndex(nsIMdbRow * row, uint32_t value) MOZ_OVERRIDE</span>
<a href="#l11.10"></a><span id="l11.10">   { return AddIntColumn(row, m_PopularityIndexColumnToken, value); }</span>
<a href="#l11.11"></a><span id="l11.11"> </span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-  NS_IMETHOD AddAllowRemoteContent(nsIMdbRow * row, bool value) MOZ_OVERRIDE</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-  { return AddBoolColumn(row, m_AllowRemoteContentColumnToken, value); }</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineminus">-</span>
<a href="#l11.15"></a><span id="l11.15">   NS_IMETHOD AddWorkPhone(nsIMdbRow * row, const char * value) MOZ_OVERRIDE</span>
<a href="#l11.16"></a><span id="l11.16">   { return AddCharStringColumn(row, m_WorkPhoneColumnToken, value); }</span>
<a href="#l11.17"></a><span id="l11.17"> </span>
<a href="#l11.18"></a><span id="l11.18">   NS_IMETHOD AddHomePhone(nsIMdbRow * row, const char * value) MOZ_OVERRIDE</span>
<a href="#l11.19"></a><span id="l11.19">   { return AddCharStringColumn(row, m_HomePhoneColumnToken, value); }</span>
<a href="#l11.20"></a><span id="l11.20"> </span>
<a href="#l11.21"></a><span id="l11.21">   NS_IMETHOD AddFaxNumber(nsIMdbRow * row, const char * value) MOZ_OVERRIDE</span>
<a href="#l11.22"></a><span id="l11.22">   { return AddCharStringColumn(row, m_FaxColumnToken, value); }</span>
<a href="#l11.23"></a><span id="l11.23" class="difflineat">@@ -407,17 +404,16 @@ protected:</span>
<a href="#l11.24"></a><span id="l11.24">   mdb_token      m_NotesColumnToken;</span>
<a href="#l11.25"></a><span id="l11.25">   mdb_token      m_LastModDateColumnToken;</span>
<a href="#l11.26"></a><span id="l11.26">   mdb_token      m_RecordKeyColumnToken;</span>
<a href="#l11.27"></a><span id="l11.27">   mdb_token      m_LowerPriEmailColumnToken;</span>
<a href="#l11.28"></a><span id="l11.28">   mdb_token      m_Lower2ndEmailColumnToken;</span>
<a href="#l11.29"></a><span id="l11.29"> </span>
<a href="#l11.30"></a><span id="l11.30">   mdb_token      m_MailFormatColumnToken;</span>
<a href="#l11.31"></a><span id="l11.31">   mdb_token     m_PopularityIndexColumnToken;</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineminus">-  mdb_token     m_AllowRemoteContentColumnToken;</span>
<a href="#l11.33"></a><span id="l11.33"> </span>
<a href="#l11.34"></a><span id="l11.34">   mdb_token      m_AddressCharSetColumnToken;</span>
<a href="#l11.35"></a><span id="l11.35">   mdb_token      m_LastRecordKeyColumnToken;</span>
<a href="#l11.36"></a><span id="l11.36"> </span>
<a href="#l11.37"></a><span id="l11.37">   mdb_token      m_ListNameColumnToken;</span>
<a href="#l11.38"></a><span id="l11.38">   mdb_token      m_ListNickNameColumnToken;</span>
<a href="#l11.39"></a><span id="l11.39">   mdb_token      m_ListDescriptionColumnToken;</span>
<a href="#l11.40"></a><span id="l11.40">   mdb_token      m_ListTotalColumnToken;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1">new file mode 100644</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineminus">--- /dev/null</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineplus">+++ b/mailnews/base/test/unit/data/remoteContent.mab</span>
<a href="#l12.4"></a><span id="l12.4" class="difflineat">@@ -0,0 +1,61 @@</span>
<a href="#l12.5"></a><span id="l12.5" class="difflineplus">+// &lt;!-- &lt;mdb:mork:z v=&quot;1.4&quot;/&gt; --&gt;</span>
<a href="#l12.6"></a><span id="l12.6" class="difflineplus">+&lt; &lt;(a=c)&gt; // (f=iso-8859-1)</span>
<a href="#l12.7"></a><span id="l12.7" class="difflineplus">+  (B8=Notes)(B9=LastModifiedDate)(BA=RecordKey)(BB=AddrCharSet)</span>
<a href="#l12.8"></a><span id="l12.8" class="difflineplus">+  (BC=LastRecordKey)(BD=ns:addrbk:db:table:kind:pab)(BE=ListName)</span>
<a href="#l12.9"></a><span id="l12.9" class="difflineplus">+  (BF=ListNickName)(C0=ListDescription)(C1=ListTotalAddresses)</span>
<a href="#l12.10"></a><span id="l12.10" class="difflineplus">+  (C2=LowercaseListName)(C3=ns:addrbk:db:table:kind:deleted)(C4=_Yahoo)</span>
<a href="#l12.11"></a><span id="l12.11" class="difflineplus">+  (C5=_MSN)(C6=_GoogleTalk)(C7=_Skype)(C8=_IRC)(C9=_JabberId)</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineplus">+  (CA=PreferDisplayName)(CB=PhotoURI)(CC=PhotoType)(CD=PhotoName)</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+  (CE=DbRowID)(CF=_QQ)(D0=_ICQ)(80=ns:addrbk:db:row:scope:card:all)</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+  (81=ns:addrbk:db:row:scope:list:all)</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+  (82=ns:addrbk:db:row:scope:data:all)(83=FirstName)(84=LastName)</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+  (85=PhoneticFirstName)(86=PhoneticLastName)(87=DisplayName)</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineplus">+  (88=NickName)(89=PrimaryEmail)(8A=LowercasePrimaryEmail)</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+  (8B=SecondEmail)(8C=LowercaseSecondEmail)(8D=PreferMailFormat)</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+  (8E=PopularityIndex)(8F=AllowRemoteContent)(90=WorkPhone)(91=HomePhone)</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineplus">+  (92=FaxNumber)(93=PagerNumber)(94=CellularNumber)(95=WorkPhoneType)</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineplus">+  (96=HomePhoneType)(97=FaxNumberType)(98=PagerNumberType)</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineplus">+  (99=CellularNumberType)(9A=HomeAddress)(9B=HomeAddress2)(9C=HomeCity)</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineplus">+  (9D=HomeState)(9E=HomeZipCode)(9F=HomeCountry)(A0=WorkAddress)</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineplus">+  (A1=WorkAddress2)(A2=WorkCity)(A3=WorkState)(A4=WorkZipCode)</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineplus">+  (A5=WorkCountry)(A6=JobTitle)(A7=Department)(A8=Company)</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineplus">+  (A9=_AimScreenName)(AA=AnniversaryYear)(AB=AnniversaryMonth)</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineplus">+  (AC=AnniversaryDay)(AD=SpouseName)(AE=FamilyName)(AF=WebPage1)</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineplus">+  (B0=WebPage2)(B1=BirthYear)(B2=BirthMonth)(B3=BirthDay)(B4=Custom1)</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineplus">+  (B5=Custom2)(B6=Custom3)(B7=Custom4)&gt;</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineplus">+</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineplus">+&lt;(86=2)(81=)(80=0)(82=1)(83=no@test.invalid)(84=generic)(85</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+    =yes@test.invalid)&gt;</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineplus">+{1:^80 {(k^BD:c)(s=9)} </span>
<a href="#l12.34"></a><span id="l12.34" class="difflineplus">+  [1:^82(^BC=2)]</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineplus">+  [1(^87=)(^86=)(^C4=)(^A2=)(^AF=)(^C5=)(^C6=)(^B3=)(^A8=)(^9B=)(^B4=)</span>
<a href="#l12.36"></a><span id="l12.36" class="difflineplus">+    (^C7=)(^A7=)(^A5=)(^A6=)(^A4=)(^C8=)(^85=)(^B1=)(^8E=0)(^C9=)(^A1=)</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineplus">+    (^A3=)(^B8=)(^8D=0)(^9F=)(^B9=0)(^83=)(^A9=)(^CA=1)(^84=)(^93=)</span>
<a href="#l12.38"></a><span id="l12.38" class="difflineplus">+    (^CB=)(^B7=)(^9E=)(^89^83)(^8F=0)(^B0=)(^CC^84)(^90=)(^CD=)(^8B=)</span>
<a href="#l12.39"></a><span id="l12.39" class="difflineplus">+    (^94=)(^91=)(^CE=1)(^B2=)(^CF=)(^9C=)(^9D=)(^92=)(^B5=)(^A0=)(^9A=)</span>
<a href="#l12.40"></a><span id="l12.40" class="difflineplus">+    (^88=)(^D0=)(^B6=)(^8A^83)(^BA=1)]</span>
<a href="#l12.41"></a><span id="l12.41" class="difflineplus">+  [2(^87=)(^86=)(^C4=)(^A2=)(^AF=)(^C5=)(^C6=)(^B3=)(^A8=)(^9B=)(^B4=)</span>
<a href="#l12.42"></a><span id="l12.42" class="difflineplus">+    (^C7=)(^A7=)(^A5=)(^A6=)(^A4=)(^C8=)(^85=)(^B1=)(^8E=0)(^C9=)(^A1=)</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineplus">+    (^A3=)(^B8=)(^8D=0)(^9F=)(^B9=0)(^83=)(^A9=)(^CA=1)(^84=)(^93=)</span>
<a href="#l12.44"></a><span id="l12.44" class="difflineplus">+    (^CB=)(^B7=)(^9E=)(^89^85)(^8F=0)(^B0=)(^CC^84)(^90=)(^CD=)(^8B=)</span>
<a href="#l12.45"></a><span id="l12.45" class="difflineplus">+    (^94=)(^91=)(^CE=2)(^B2=)(^CF=)(^9C=)(^9D=)(^92=)(^B5=)(^A0=)(^9A=)</span>
<a href="#l12.46"></a><span id="l12.46" class="difflineplus">+    (^88=)(^D0=)(^B6=)(^8A^85)(^BA=2)]}</span>
<a href="#l12.47"></a><span id="l12.47" class="difflineplus">+</span>
<a href="#l12.48"></a><span id="l12.48" class="difflineplus">+@$${2{@</span>
<a href="#l12.49"></a><span id="l12.49" class="difflineplus">+&lt;(87=1397303325)&gt;[-2:^80(^87=)(^86=)(^C4=)(^A2=)(^AF=)(^C5=)(^C6=)</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineplus">+    (^B3=)(^A8=)(^9B=)(^B4=)(^C7=)(^A7=)(^A5=)(^A6=)(^A4=)(^C8=)(^85=)</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineplus">+    (^B1=)(^8E=0)(^C9=)(^A1=)(^A3=)(^B8=)(^8D=0)(^9F=)(^B9^87)(^83=)</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineplus">+    (^A9=)(^CA=1)(^84=)(^93=)(^CB=)(^B7=)(^9E=)(^89^85)(^8F=1)(^B0=)</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineplus">+    (^CC^84)(^90=)(^CD=)(^8B=)(^94=)(^91=)(^CE=2)(^B2=)(^CF=)(^9C=)</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineplus">+    (^9D=)(^92=)(^B5=)(^A0=)(^9A=)(^88=)(^D0=)(^B6=)(^8A^85)(^BA=2)]</span>
<a href="#l12.55"></a><span id="l12.55" class="difflineplus">+@$$}2}@</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineplus">+</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineplus">+@$${4{@</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineplus">+&lt;(88=1397383824)(89=yes2@test.invalid)&gt;</span>
<a href="#l12.59"></a><span id="l12.59" class="difflineplus">+[-2:^80(^87=)(^86=)(^C4=)(^A2=)(^AF=)(^C5=)(^C6=)(^B3=)(^A8=)(^9B=)</span>
<a href="#l12.60"></a><span id="l12.60" class="difflineplus">+    (^B4=)(^C7=)(^A7=)(^A5=)(^A6=)(^A4=)(^C8=)(^85=)(^B1=)(^8E=0)(^C9=)</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineplus">+    (^A1=)(^A3=)(^B8=)(^8D=0)(^9F=)(^B9^88)(^83=)(^A9=)(^CA=1)(^84=)</span>
<a href="#l12.62"></a><span id="l12.62" class="difflineplus">+    (^93=)(^CB=)(^B7=)(^9E=)(^89^85)(^8F=1)(^B0=)(^CC^84)(^90=)(^CD=)</span>
<a href="#l12.63"></a><span id="l12.63" class="difflineplus">+    (^8B^89)(^94=)(^91=)(^CE=2)(^B2=)(^CF=)(^9C=)(^9D=)(^92=)(^B5=)</span>
<a href="#l12.64"></a><span id="l12.64" class="difflineplus">+    (^A0=)(^9A=)(^88=)(^D0=)(^B6=)(^8A^85)(^BA=2)]</span>
<a href="#l12.65"></a><span id="l12.65" class="difflineplus">+@$$}4}@</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/base/test/unit/test_accountMigration.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_accountMigration.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -1,33 +1,55 @@</span>
<a href="#l13.4"></a><span id="l13.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l13.5"></a><span id="l13.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l13.6"></a><span id="l13.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l13.7"></a><span id="l13.7"> </span>
<a href="#l13.8"></a><span id="l13.8"> /**</span>
<a href="#l13.9"></a><span id="l13.9">  * This tests that we don't try to reset the mail.server.server&lt;n&gt;.authMethod</span>
<a href="#l13.10"></a><span id="l13.10" class="difflineminus">- * preference every time we run the migration code.</span>
<a href="#l13.11"></a><span id="l13.11" class="difflineplus">+ * preference every time we run the migration code, and other migration stuff</span>
<a href="#l13.12"></a><span id="l13.12">  */</span>
<a href="#l13.13"></a><span id="l13.13"> </span>
<a href="#l13.14"></a><span id="l13.14" class="difflineplus">+// make xpcshell-tests TEST_PATH=mailnews/base/test/unit/test_accountMigration.js</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineplus">+</span>
<a href="#l13.16"></a><span id="l13.16"> Components.utils.import(&quot;resource:///modules/mailnewsMigrator.js&quot;);</span>
<a href="#l13.17"></a><span id="l13.17"> </span>
<a href="#l13.18"></a><span id="l13.18" class="difflineplus">+load(&quot;../../../resources/abSetup.js&quot;);</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineplus">+</span>
<a href="#l13.20"></a><span id="l13.20"> function run_test() {</span>
<a href="#l13.21"></a><span id="l13.21">   // Set up some basic accounts with limited prefs - enough to satisfy the</span>
<a href="#l13.22"></a><span id="l13.22">   // migrator.</span>
<a href="#l13.23"></a><span id="l13.23">   Services.prefs.setCharPref(&quot;mail.account.account1.server&quot;, &quot;server1&quot;);</span>
<a href="#l13.24"></a><span id="l13.24">   Services.prefs.setCharPref(&quot;mail.account.account2.server&quot;, &quot;server2&quot;);</span>
<a href="#l13.25"></a><span id="l13.25"> </span>
<a href="#l13.26"></a><span id="l13.26">   // Server1 has nothing set.</span>
<a href="#l13.27"></a><span id="l13.27"> </span>
<a href="#l13.28"></a><span id="l13.28">   // Server2 has useSecAuth set to true, auth_login unset</span>
<a href="#l13.29"></a><span id="l13.29">   Services.prefs.setBoolPref(&quot;mail.server.server2.useSecAuth&quot;, true);</span>
<a href="#l13.30"></a><span id="l13.30"> </span>
<a href="#l13.31"></a><span id="l13.31">   Services.prefs.setCharPref(&quot;mail.accountmanager.accounts&quot;,</span>
<a href="#l13.32"></a><span id="l13.32">                              &quot;account1,account2&quot;);</span>
<a href="#l13.33"></a><span id="l13.33"> </span>
<a href="#l13.34"></a><span id="l13.34" class="difflineplus">+  let testAB = do_get_file(&quot;data/remoteContent.mab&quot;);</span>
<a href="#l13.35"></a><span id="l13.35" class="difflineplus">+</span>
<a href="#l13.36"></a><span id="l13.36" class="difflineplus">+  // Copy the file to the profile directory for a PAB.</span>
<a href="#l13.37"></a><span id="l13.37" class="difflineplus">+  testAB.copyTo(do_get_profile(), kPABData.fileName);</span>
<a href="#l13.38"></a><span id="l13.38" class="difflineplus">+</span>
<a href="#l13.39"></a><span id="l13.39" class="difflineplus">+  let uriAllowed = Services.io.newURI(&quot;mailto:yes@test.invalid&quot;, null, null);</span>
<a href="#l13.40"></a><span id="l13.40" class="difflineplus">+  let uriAllowed2 = Services.io.newURI(&quot;mailto:yes2@test.invalid&quot;, null, null);</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineplus">+  let uriDisallowed = Services.io.newURI(&quot;mailto:no@test.invalid&quot;, null, null);</span>
<a href="#l13.42"></a><span id="l13.42" class="difflineplus">+</span>
<a href="#l13.43"></a><span id="l13.43" class="difflineplus">+  // Check that this email that according to the ab data has (had!)</span>
<a href="#l13.44"></a><span id="l13.44" class="difflineplus">+  // remote content premissions, has no premissions pre migration.</span>
<a href="#l13.45"></a><span id="l13.45" class="difflineplus">+  do_check_eq(Services.perms.testPermission(uriAllowed, &quot;image&quot;),</span>
<a href="#l13.46"></a><span id="l13.46" class="difflineplus">+              Services.perms.UNKNOWN_ACTION);</span>
<a href="#l13.47"></a><span id="l13.47" class="difflineplus">+  do_check_eq(Services.perms.testPermission(uriAllowed2, &quot;image&quot;),</span>
<a href="#l13.48"></a><span id="l13.48" class="difflineplus">+              Services.perms.UNKNOWN_ACTION);</span>
<a href="#l13.49"></a><span id="l13.49" class="difflineplus">+  do_check_eq(Services.perms.testPermission(uriDisallowed, &quot;image&quot;),</span>
<a href="#l13.50"></a><span id="l13.50" class="difflineplus">+              Services.perms.UNKNOWN_ACTION);</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineplus">+</span>
<a href="#l13.52"></a><span id="l13.52">   // Now migrate the prefs.</span>
<a href="#l13.53"></a><span id="l13.53">   migrateMailnews();</span>
<a href="#l13.54"></a><span id="l13.54"> </span>
<a href="#l13.55"></a><span id="l13.55">   // Check what has been set.</span>
<a href="#l13.56"></a><span id="l13.56">   do_check_false(Services.prefs.prefHasUserValue(&quot;mail.server.server1.authMethod&quot;));</span>
<a href="#l13.57"></a><span id="l13.57">   do_check_true(Services.prefs.prefHasUserValue(&quot;mail.server.server2.authMethod&quot;));</span>
<a href="#l13.58"></a><span id="l13.58">   do_check_eq(Services.prefs.getIntPref(&quot;mail.server.server2.authMethod&quot;),</span>
<a href="#l13.59"></a><span id="l13.59">               Ci.nsMsgAuthMethod.secure);</span>
<a href="#l13.60"></a><span id="l13.60" class="difflineat">@@ -50,16 +72,26 @@ function run_test() {</span>
<a href="#l13.61"></a><span id="l13.61"> </span>
<a href="#l13.62"></a><span id="l13.62">   Services.prefs.setCharPref(&quot;mail.smtpservers&quot;, &quot;smtp1,smtp2&quot;);</span>
<a href="#l13.63"></a><span id="l13.63"> </span>
<a href="#l13.64"></a><span id="l13.64">   // smtp1 has nothing set.</span>
<a href="#l13.65"></a><span id="l13.65"> </span>
<a href="#l13.66"></a><span id="l13.66">   // smtp2 has useSecAuth set to true, auth_method unset</span>
<a href="#l13.67"></a><span id="l13.67">   Services.prefs.setBoolPref(&quot;mail.smtpserver.smtp2.useSecAuth&quot;, true);</span>
<a href="#l13.68"></a><span id="l13.68"> </span>
<a href="#l13.69"></a><span id="l13.69" class="difflineplus">+  // Migration should now have added permissions for the address that had them</span>
<a href="#l13.70"></a><span id="l13.70" class="difflineplus">+  // and not for the one that didn't have them.</span>
<a href="#l13.71"></a><span id="l13.71" class="difflineplus">+  do_check_true(Services.prefs.getIntPref(&quot;mail.ab_remote_content.migrated&quot;) &gt; 0);</span>
<a href="#l13.72"></a><span id="l13.72" class="difflineplus">+  do_check_eq(Services.perms.testPermission(uriAllowed, &quot;image&quot;),</span>
<a href="#l13.73"></a><span id="l13.73" class="difflineplus">+              Services.perms.ALLOW_ACTION);</span>
<a href="#l13.74"></a><span id="l13.74" class="difflineplus">+  do_check_eq(Services.perms.testPermission(uriAllowed2, &quot;image&quot;),</span>
<a href="#l13.75"></a><span id="l13.75" class="difflineplus">+              Services.perms.ALLOW_ACTION);</span>
<a href="#l13.76"></a><span id="l13.76" class="difflineplus">+  do_check_eq(Services.perms.testPermission(uriDisallowed, &quot;image&quot;),</span>
<a href="#l13.77"></a><span id="l13.77" class="difflineplus">+              Services.perms.UNKNOWN_ACTION);</span>
<a href="#l13.78"></a><span id="l13.78" class="difflineplus">+</span>
<a href="#l13.79"></a><span id="l13.79">   // Now migrate the prefs</span>
<a href="#l13.80"></a><span id="l13.80">   migrateMailnews();</span>
<a href="#l13.81"></a><span id="l13.81"> </span>
<a href="#l13.82"></a><span id="l13.82">   do_check_false(Services.prefs.prefHasUserValue(&quot;mail.smtpserver.smtp1.authMethod&quot;));</span>
<a href="#l13.83"></a><span id="l13.83">   do_check_true(Services.prefs.prefHasUserValue(&quot;mail.smtpserver.smtp2.authMethod&quot;));</span>
<a href="#l13.84"></a><span id="l13.84">   do_check_eq(Services.prefs.getIntPref(&quot;mail.smtpserver.smtp2.authMethod&quot;),</span>
<a href="#l13.85"></a><span id="l13.85">               Ci.nsMsgAuthMethod.secure);</span>
<a href="#l13.86"></a><span id="l13.86"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/base/util/mailnewsMigrator.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/base/util/mailnewsMigrator.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -5,29 +5,35 @@</span>
<a href="#l14.4"></a><span id="l14.4"> /**</span>
<a href="#l14.5"></a><span id="l14.5">  * Migrate profile (prefs and other files) from older versions of Mailnews to</span>
<a href="#l14.6"></a><span id="l14.6">  * current.</span>
<a href="#l14.7"></a><span id="l14.7">  * This should be run at startup. It migrates as needed: each migration</span>
<a href="#l14.8"></a><span id="l14.8">  * function should be written to be a no-op when the value is already migrated</span>
<a href="#l14.9"></a><span id="l14.9">  * or was never used in the old version.</span>
<a href="#l14.10"></a><span id="l14.10">  */</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-var EXPORTED_SYMBOLS = [ &quot;migrateMailnews&quot; ];</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+const EXPORTED_SYMBOLS = [ &quot;migrateMailnews&quot; ];</span>
<a href="#l14.14"></a><span id="l14.14"> </span>
<a href="#l14.15"></a><span id="l14.15"> Components.utils.import(&quot;resource:///modules/errUtils.js&quot;);</span>
<a href="#l14.16"></a><span id="l14.16"> Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineplus">+Components.utils.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l14.18"></a><span id="l14.18"> const Ci = Components.interfaces;</span>
<a href="#l14.19"></a><span id="l14.19"> const kServerPrefVersion = 1;</span>
<a href="#l14.20"></a><span id="l14.20"> const kSmtpPrefVersion = 1;</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineplus">+const kABRemoteContentPrefVersion = 1;</span>
<a href="#l14.22"></a><span id="l14.22"> </span>
<a href="#l14.23"></a><span id="l14.23"> function migrateMailnews()</span>
<a href="#l14.24"></a><span id="l14.24"> {</span>
<a href="#l14.25"></a><span id="l14.25">   try {</span>
<a href="#l14.26"></a><span id="l14.26">     MigrateServerAuthPref();</span>
<a href="#l14.27"></a><span id="l14.27">   } catch (e) { logException(e); }</span>
<a href="#l14.28"></a><span id="l14.28" class="difflineplus">+</span>
<a href="#l14.29"></a><span id="l14.29" class="difflineplus">+  try {</span>
<a href="#l14.30"></a><span id="l14.30" class="difflineplus">+    MigrateABRemoteContentSettings();</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineplus">+  } catch (e) { logException(e); }</span>
<a href="#l14.32"></a><span id="l14.32"> }</span>
<a href="#l14.33"></a><span id="l14.33"> </span>
<a href="#l14.34"></a><span id="l14.34"> /**</span>
<a href="#l14.35"></a><span id="l14.35">  * Migrates from pref useSecAuth to pref authMethod</span>
<a href="#l14.36"></a><span id="l14.36">  */</span>
<a href="#l14.37"></a><span id="l14.37"> function MigrateServerAuthPref()</span>
<a href="#l14.38"></a><span id="l14.38"> {</span>
<a href="#l14.39"></a><span id="l14.39">   try {</span>
<a href="#l14.40"></a><span id="l14.40" class="difflineat">@@ -99,8 +105,58 @@ function MigrateServerAuthPref()</span>
<a href="#l14.41"></a><span id="l14.41">           auth_method ? (useSecAuth ?</span>
<a href="#l14.42"></a><span id="l14.42">                             Ci.nsMsgAuthMethod.secure :</span>
<a href="#l14.43"></a><span id="l14.43">                             Ci.nsMsgAuthMethod.passwordCleartext) :</span>
<a href="#l14.44"></a><span id="l14.44">                         Ci.nsMsgAuthMethod.none);</span>
<a href="#l14.45"></a><span id="l14.45">       Services.prefs.setIntPref(server + &quot;migrated&quot;, kSmtpPrefVersion);</span>
<a href="#l14.46"></a><span id="l14.46">     }</span>
<a href="#l14.47"></a><span id="l14.47">   } catch(e) { logException(e); }</span>
<a href="#l14.48"></a><span id="l14.48"> }</span>
<a href="#l14.49"></a><span id="l14.49" class="difflineplus">+</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineplus">+/**</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineplus">+ * The address book used to contain information about wheather to allow remote</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineplus">+ * content for a given contact. Now we use the permission manager for that.</span>
<a href="#l14.53"></a><span id="l14.53" class="difflineplus">+ * Do a one-time migration for it.</span>
<a href="#l14.54"></a><span id="l14.54" class="difflineplus">+ */</span>
<a href="#l14.55"></a><span id="l14.55" class="difflineplus">+function MigrateABRemoteContentSettings()</span>
<a href="#l14.56"></a><span id="l14.56" class="difflineplus">+{</span>
<a href="#l14.57"></a><span id="l14.57" class="difflineplus">+  if (Services.prefs.prefHasUserValue(&quot;mail.ab_remote_content.migrated&quot;))</span>
<a href="#l14.58"></a><span id="l14.58" class="difflineplus">+    return;</span>
<a href="#l14.59"></a><span id="l14.59" class="difflineplus">+</span>
<a href="#l14.60"></a><span id="l14.60" class="difflineplus">+  // Search through all of our local address books looking for a match.</span>
<a href="#l14.61"></a><span id="l14.61" class="difflineplus">+  let enumerator = MailServices.ab.directories;</span>
<a href="#l14.62"></a><span id="l14.62" class="difflineplus">+  while (enumerator.hasMoreElements())</span>
<a href="#l14.63"></a><span id="l14.63" class="difflineplus">+  {</span>
<a href="#l14.64"></a><span id="l14.64" class="difflineplus">+    let migrateAddress = function(aEmail) {</span>
<a href="#l14.65"></a><span id="l14.65" class="difflineplus">+      let uri = Services.io.newURI(&quot;mailto:&quot; + aEmail, null, null);</span>
<a href="#l14.66"></a><span id="l14.66" class="difflineplus">+      Services.perms.add(uri, &quot;image&quot;, Services.perms.ALLOW_ACTION);</span>
<a href="#l14.67"></a><span id="l14.67" class="difflineplus">+    }</span>
<a href="#l14.68"></a><span id="l14.68" class="difflineplus">+</span>
<a href="#l14.69"></a><span id="l14.69" class="difflineplus">+    let addrbook = enumerator.getNext()</span>
<a href="#l14.70"></a><span id="l14.70" class="difflineplus">+      .QueryInterface(Components.interfaces.nsIAbDirectory);</span>
<a href="#l14.71"></a><span id="l14.71" class="difflineplus">+    try {</span>
<a href="#l14.72"></a><span id="l14.72" class="difflineplus">+      // If it's a read-only book, don't try to find a card as we we could never</span>
<a href="#l14.73"></a><span id="l14.73" class="difflineplus">+      // have set the AllowRemoteContent property.</span>
<a href="#l14.74"></a><span id="l14.74" class="difflineplus">+      if (addrbook.readOnly)</span>
<a href="#l14.75"></a><span id="l14.75" class="difflineplus">+        continue;</span>
<a href="#l14.76"></a><span id="l14.76" class="difflineplus">+</span>
<a href="#l14.77"></a><span id="l14.77" class="difflineplus">+      let childCards = addrbook.childCards;</span>
<a href="#l14.78"></a><span id="l14.78" class="difflineplus">+      while (childCards.hasMoreElements())</span>
<a href="#l14.79"></a><span id="l14.79" class="difflineplus">+      {</span>
<a href="#l14.80"></a><span id="l14.80" class="difflineplus">+        let card = childCards.getNext()</span>
<a href="#l14.81"></a><span id="l14.81" class="difflineplus">+                             .QueryInterface(Components.interfaces.nsIAbCard);</span>
<a href="#l14.82"></a><span id="l14.82" class="difflineplus">+</span>
<a href="#l14.83"></a><span id="l14.83" class="difflineplus">+        if (card.getProperty(&quot;AllowRemoteContent&quot;, false) == false)</span>
<a href="#l14.84"></a><span id="l14.84" class="difflineplus">+          continue; // not allowed for this contact</span>
<a href="#l14.85"></a><span id="l14.85" class="difflineplus">+</span>
<a href="#l14.86"></a><span id="l14.86" class="difflineplus">+        if (card.primaryEmail)</span>
<a href="#l14.87"></a><span id="l14.87" class="difflineplus">+          migrateAddress(card.primaryEmail);</span>
<a href="#l14.88"></a><span id="l14.88" class="difflineplus">+</span>
<a href="#l14.89"></a><span id="l14.89" class="difflineplus">+        if (card.getProperty(&quot;SecondEmail&quot;, &quot;&quot;))</span>
<a href="#l14.90"></a><span id="l14.90" class="difflineplus">+          migrateAddress(card.getProperty(&quot;SecondEmail&quot;, &quot;&quot;));</span>
<a href="#l14.91"></a><span id="l14.91" class="difflineplus">+      }</span>
<a href="#l14.92"></a><span id="l14.92" class="difflineplus">+    } catch (e) { logException(e); }</span>
<a href="#l14.93"></a><span id="l14.93" class="difflineplus">+  }</span>
<a href="#l14.94"></a><span id="l14.94" class="difflineplus">+</span>
<a href="#l14.95"></a><span id="l14.95" class="difflineplus">+  Services.prefs.setIntPref(&quot;mail.ab_remote_content.migrated&quot;,</span>
<a href="#l14.96"></a><span id="l14.96" class="difflineplus">+                            kABRemoteContentPrefVersion);</span>
<a href="#l14.97"></a><span id="l14.97" class="difflineplus">+}</span>
<a href="#l14.98"></a><span id="l14.98" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/import/test/unit/resources/import_helper.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/import/test/unit/resources/import_helper.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -131,18 +131,17 @@ function AbImportHelper(aFile, aModuleSe</span>
<a href="#l15.4"></a><span id="l15.4"> {</span>
<a href="#l15.5"></a><span id="l15.5">   GenericImportHelper.call(this, &quot;addressbook&quot;, aModuleSearchString, aFile);</span>
<a href="#l15.6"></a><span id="l15.6"> </span>
<a href="#l15.7"></a><span id="l15.7">   this.mAbName = aAbName;</span>
<a href="#l15.8"></a><span id="l15.8">   /* Attribute notes:  The attributes listed in the declaration below are</span>
<a href="#l15.9"></a><span id="l15.9">    * supported by all three text export/import types. PreferMailFormat is only</span>
<a href="#l15.10"></a><span id="l15.10">    * supported by LDIF.</span>
<a href="#l15.11"></a><span id="l15.11">    * The following are not supported: anniversaryYear, anniversaryMonth,</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-   * anniversaryDay, popularityIndex, isMailList, mailListURI, lastModifiedDate,</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-   * and allowRemoteContent</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineplus">+   * anniversaryDay, popularityIndex, isMailList, mailListURI, lastModifiedDate.</span>
<a href="#l15.15"></a><span id="l15.15">    */</span>
<a href="#l15.16"></a><span id="l15.16">   var supportedAttributes =</span>
<a href="#l15.17"></a><span id="l15.17">     [&quot;FirstName&quot;, &quot;LastName&quot;, &quot;DisplayName&quot;, &quot;NickName&quot;, &quot;PrimaryEmail&quot;,</span>
<a href="#l15.18"></a><span id="l15.18">      &quot;SecondEmail&quot;, &quot;WorkPhone&quot;, &quot;HomePhone&quot;, &quot;FaxNumber&quot;, &quot;PagerNumber&quot;,</span>
<a href="#l15.19"></a><span id="l15.19">      &quot;CellularNumber&quot;, &quot;HomeAddress&quot;, &quot;HomeAddress2&quot;, &quot;HomeCity&quot;, &quot;HomeState&quot;,</span>
<a href="#l15.20"></a><span id="l15.20">      &quot;HomeZipCode&quot;, &quot;HomeCountry&quot;, &quot;WorkAddress&quot;, &quot;WorkAddress2&quot;, &quot;WorkCity&quot;,</span>
<a href="#l15.21"></a><span id="l15.21">      &quot;WorkState&quot;, &quot;WorkZipCode&quot;, &quot;WorkCountry&quot;, &quot;JobTitle&quot;, &quot;Department&quot;,</span>
<a href="#l15.22"></a><span id="l15.22">      &quot;Company&quot;, &quot;BirthYear&quot;, &quot;BirthMonth&quot;, &quot;BirthDay&quot;, &quot;WebPage1&quot;, &quot;WebPage2&quot;,</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

