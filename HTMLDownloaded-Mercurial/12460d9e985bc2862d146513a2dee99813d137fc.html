<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 3473:12460d9e985bc2862d146513a2dee99813d137fc</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 12460d9e985bc2862d146513a2dee99813d137fc" />
<meta property="og:url" content="/comm-central/rev/12460d9e985bc2862d146513a2dee99813d137fc" />
<meta property="og:description" content="Bug 490111 - Setting kDebug to false broke &quot;function getElementById()&quot; which had apparently never been tested, and is even less pretty when it's made to work, so just use document.getElementById() instead, r=philringnalda" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 12460d9e985bc2862d146513a2dee99813d137fc 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/12460d9e985bc2862d146513a2dee99813d137fc">shortlog</a> |
<a href="/comm-central/log/12460d9e985bc2862d146513a2dee99813d137fc">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/12460d9e985bc2862d146513a2dee99813d137fc">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/12460d9e985bc2862d146513a2dee99813d137fc">files</a> |
changeset |
<a href="/comm-central/raw-rev/12460d9e985bc2862d146513a2dee99813d137fc">raw</a>  | <a href="/comm-central/archive/12460d9e985bc2862d146513a2dee99813d137fc.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=490111">Bug 490111</a> - Setting kDebug to false broke &quot;function getElementById()&quot; which had apparently never been tested, and is even less pretty when it's made to work, so just use document.getElementById() instead, r=philringnalda
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#66;&#108;&#97;&#107;&#101;&#32;&#87;&#105;&#110;&#116;&#111;&#110;&#32;&#60;&#98;&#119;&#105;&#110;&#116;&#111;&#110;&#64;&#108;&#97;&#116;&#116;&#101;&#46;&#99;&#97;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 01 Sep 2009 16:42:23 +0100</td></tr>

<tr>
 <td>changeset 3473</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/12460d9e985bc2862d146513a2dee99813d137fc">12460d9e985bc2862d146513a2dee99813d137fc</a></td>
</tr>



<tr>
<td>parent 3472</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/2c185d4050c25030e358d0f39a479fc81a6c18ac">2c185d4050c25030e358d0f39a479fc81a6c18ac</a>
</td>
</tr>

<tr>
<td>child 3474</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/e2d7771ba879fcf38159df92c473223ba242bb2a">e2d7771ba879fcf38159df92c473223ba242bb2a</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=12460d9e985bc2862d146513a2dee99813d137fc">2818</a></td></tr>
<tr><td>push user</td><td>bugzilla@standard8.plus.com</td></tr>
<tr><td>push date</td><td class="date age">Tue, 01 Sep 2009 15:45:33 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@9c1a3c3eaa80 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=9c1a3c3eaa80d09b41eb76e8b885dc5f4b36edc2">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=9c1a3c3eaa80d09b41eb76e8b885dc5f4b36edc2&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=9c1a3c3eaa80d09b41eb76e8b885dc5f4b36edc2&newProject=comm-central&newRevision=12460d9e985bc2862d146513a2dee99813d137fc&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=9c1a3c3eaa80d09b41eb76e8b885dc5f4b36edc2&newProject=comm-central&newRevision=12460d9e985bc2862d146513a2dee99813d137fc&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=9c1a3c3eaa80d09b41eb76e8b885dc5f4b36edc2&newProject=comm-central&newRevision=12460d9e985bc2862d146513a2dee99813d137fc&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28philringnalda%29&revcount=50">philringnalda</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=490111">490111</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=490111">Bug 490111</a> - Setting kDebug to false broke &quot;function getElementById()&quot; which had apparently never been tested, and is even less pretty when it's made to work, so just use document.getElementById() instead, r=philringnalda</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/12460d9e985bc2862d146513a2dee99813d137fc/mailnews/base/prefs/content/accountcreation/emailWizard.js">mailnews/base/prefs/content/accountcreation/emailWizard.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/12460d9e985bc2862d146513a2dee99813d137fc/mailnews/base/prefs/content/accountcreation/emailWizard.js">file</a> |
<a href="/comm-central/annotate/12460d9e985bc2862d146513a2dee99813d137fc/mailnews/base/prefs/content/accountcreation/emailWizard.js">annotate</a> |
<a href="/comm-central/diff/12460d9e985bc2862d146513a2dee99813d137fc/mailnews/base/prefs/content/accountcreation/emailWizard.js">diff</a> |
<a href="/comm-central/comparison/12460d9e985bc2862d146513a2dee99813d137fc/mailnews/base/prefs/content/accountcreation/emailWizard.js">comparison</a> |
<a href="/comm-central/log/12460d9e985bc2862d146513a2dee99813d137fc/mailnews/base/prefs/content/accountcreation/emailWizard.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mailnews/base/prefs/content/accountcreation/emailWizard.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mailnews/base/prefs/content/accountcreation/emailWizard.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -70,38 +70,23 @@ Cu.import(&quot;resource://app/modules/gloda/</span>
<a href="#l1.4"></a><span id="l1.4"> let gSmtpManager = Cc[&quot;@mozilla.org/messengercompose/smtp;1&quot;]</span>
<a href="#l1.5"></a><span id="l1.5">                    .getService(Ci.nsISmtpService);</span>
<a href="#l1.6"></a><span id="l1.6"> let gAccountMgr = Cc[&quot;@mozilla.org/messenger/account-manager;1&quot;]</span>
<a href="#l1.7"></a><span id="l1.7">                   .getService(Ci.nsIMsgAccountManager);</span>
<a href="#l1.8"></a><span id="l1.8"> let gEmailWizardLogger = Log4Moz.getConfiguredLogger(&quot;emailwizard&quot;);</span>
<a href="#l1.9"></a><span id="l1.9"> let gStringsBundle;</span>
<a href="#l1.10"></a><span id="l1.10"> let gBrandBundle;</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-// debugging aid</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-if (kDebug) {</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineminus">-  function getElementById(id)</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineminus">-  {</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineminus">-    let elt = document.getElementById(id);</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineminus">-    if (!elt)</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineminus">-    {</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineminus">-      gEmailWizardLogger.error(&quot;Can't find element ID: &quot; + id);</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineminus">-      return null;</span>
<a href="#l1.21"></a><span id="l1.21" class="difflineminus">-    }</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineminus">-    return elt;</span>
<a href="#l1.23"></a><span id="l1.23" class="difflineminus">-  }</span>
<a href="#l1.24"></a><span id="l1.24" class="difflineminus">-} else // production</span>
<a href="#l1.25"></a><span id="l1.25" class="difflineminus">-  getElementById = document.getElementById;</span>
<a href="#l1.26"></a><span id="l1.26" class="difflineminus">-</span>
<a href="#l1.27"></a><span id="l1.27"> function _hide(id)</span>
<a href="#l1.28"></a><span id="l1.28"> {</span>
<a href="#l1.29"></a><span id="l1.29" class="difflineminus">-  getElementById(id).hidden = true;</span>
<a href="#l1.30"></a><span id="l1.30" class="difflineplus">+  document.getElementById(id).hidden = true;</span>
<a href="#l1.31"></a><span id="l1.31"> }</span>
<a href="#l1.32"></a><span id="l1.32"> function _show(id)</span>
<a href="#l1.33"></a><span id="l1.33"> {</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineminus">-  getElementById(id).hidden = false;</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineplus">+  document.getElementById(id).hidden = false;</span>
<a href="#l1.36"></a><span id="l1.36"> }</span>
<a href="#l1.37"></a><span id="l1.37"> function EmailConfigWizard()</span>
<a href="#l1.38"></a><span id="l1.38"> {</span>
<a href="#l1.39"></a><span id="l1.39">   this._init();</span>
<a href="#l1.40"></a><span id="l1.40"> }</span>
<a href="#l1.41"></a><span id="l1.41"> EmailConfigWizard.prototype =</span>
<a href="#l1.42"></a><span id="l1.42"> {</span>
<a href="#l1.43"></a><span id="l1.43">   _init : function EmailConfigWizard__init()</span>
<a href="#l1.44"></a><span id="l1.44" class="difflineat">@@ -126,56 +111,56 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.45"></a><span id="l1.45">     this._incomingWarning = 'cleartext';</span>
<a href="#l1.46"></a><span id="l1.46">     this._outgoingWarning = 'cleartext';</span>
<a href="#l1.47"></a><span id="l1.47">     this._userPickedOutgoingServer = false;</span>
<a href="#l1.48"></a><span id="l1.48"> </span>
<a href="#l1.49"></a><span id="l1.49">     if (window.arguments &amp;&amp; window.arguments[0] &amp;&amp;</span>
<a href="#l1.50"></a><span id="l1.50">         window.arguments[0].msgWindow)</span>
<a href="#l1.51"></a><span id="l1.51">       this._parentMsgWindow = window.arguments[0].msgWindow;</span>
<a href="#l1.52"></a><span id="l1.52"> </span>
<a href="#l1.53"></a><span id="l1.53" class="difflineminus">-    gStringsBundle = getElementById(&quot;strings&quot;);</span>
<a href="#l1.54"></a><span id="l1.54" class="difflineplus">+    gStringsBundle = document.getElementById(&quot;strings&quot;);</span>
<a href="#l1.55"></a><span id="l1.55">     gBrandBundle = document.getElementById(&quot;bundle_brand&quot;);</span>
<a href="#l1.56"></a><span id="l1.56"> </span>
<a href="#l1.57"></a><span id="l1.57">     // Populate SMTP server dropdown with already configured SMTP servers from</span>
<a href="#l1.58"></a><span id="l1.58">     // other accounts.</span>
<a href="#l1.59"></a><span id="l1.59">     let gSmtpManager = Cc[&quot;@mozilla.org/messengercompose/smtp;1&quot;]</span>
<a href="#l1.60"></a><span id="l1.60">                        .getService(Ci.nsISmtpService);</span>
<a href="#l1.61"></a><span id="l1.61">     this._smtpServers = gSmtpManager.smtpServers;</span>
<a href="#l1.62"></a><span id="l1.62" class="difflineminus">-    var menupopup = getElementById(&quot;smtp_menupopup&quot;);</span>
<a href="#l1.63"></a><span id="l1.63" class="difflineplus">+    var menupopup = document.getElementById(&quot;smtp_menupopup&quot;);</span>
<a href="#l1.64"></a><span id="l1.64">     this._smtpServerCount = 0;</span>
<a href="#l1.65"></a><span id="l1.65">     while (this._smtpServers.hasMoreElements())</span>
<a href="#l1.66"></a><span id="l1.66">     {</span>
<a href="#l1.67"></a><span id="l1.67">       var server = this._smtpServers.getNext().QueryInterface(Ci.nsISmtpServer);</span>
<a href="#l1.68"></a><span id="l1.68">       this._smtpServerCount++;</span>
<a href="#l1.69"></a><span id="l1.69">       var menuitem = document.createElement(&quot;menuitem&quot;);</span>
<a href="#l1.70"></a><span id="l1.70">       var label = server.displayname;</span>
<a href="#l1.71"></a><span id="l1.71">       if (server.key == gSmtpManager.defaultServer.key)</span>
<a href="#l1.72"></a><span id="l1.72">         label += &quot; &quot; + gStringsBundle.getString(&quot;default_server_tag&quot;);</span>
<a href="#l1.73"></a><span id="l1.73"> </span>
<a href="#l1.74"></a><span id="l1.74">       menuitem.setAttribute(&quot;label&quot;, label);</span>
<a href="#l1.75"></a><span id="l1.75">       menuitem.setAttribute(&quot;value&quot;, server.key);</span>
<a href="#l1.76"></a><span id="l1.76">       menuitem.hostname = server.hostname;</span>
<a href="#l1.77"></a><span id="l1.77">       menupopup.appendChild(menuitem);</span>
<a href="#l1.78"></a><span id="l1.78">     }</span>
<a href="#l1.79"></a><span id="l1.79" class="difflineminus">-    var menulist = getElementById(&quot;outgoing_server&quot;);</span>
<a href="#l1.80"></a><span id="l1.80" class="difflineplus">+    var menulist = document.getElementById(&quot;outgoing_server&quot;);</span>
<a href="#l1.81"></a><span id="l1.81">     menulist.addEventListener(&quot;command&quot;,</span>
<a href="#l1.82"></a><span id="l1.82">       function(event) { gEmailConfigWizard.userChangedOutgoing(event); }, true);</span>
<a href="#l1.83"></a><span id="l1.83">   },</span>
<a href="#l1.84"></a><span id="l1.84"> </span>
<a href="#l1.85"></a><span id="l1.85">   /* When the next button is clicked we've moved from the initial account</span>
<a href="#l1.86"></a><span id="l1.86">    * information stage to using that information to configure account details.</span>
<a href="#l1.87"></a><span id="l1.87">    */</span>
<a href="#l1.88"></a><span id="l1.88">   onNext : function()</span>
<a href="#l1.89"></a><span id="l1.89">   {</span>
<a href="#l1.90"></a><span id="l1.90">     // change the inputs to a flat look</span>
<a href="#l1.91"></a><span id="l1.91">     this._accountInfoInputs(true);</span>
<a href="#l1.92"></a><span id="l1.92"> </span>
<a href="#l1.93"></a><span id="l1.93" class="difflineminus">-    this._email = getElementById(&quot;email&quot;).value;</span>
<a href="#l1.94"></a><span id="l1.94" class="difflineminus">-    this._realname = getElementById(&quot;realname&quot;).value;</span>
<a href="#l1.95"></a><span id="l1.95" class="difflineminus">-    this._password = getElementById(&quot;password&quot;).value;</span>
<a href="#l1.96"></a><span id="l1.96" class="difflineplus">+    this._email = document.getElementById(&quot;email&quot;).value;</span>
<a href="#l1.97"></a><span id="l1.97" class="difflineplus">+    this._realname = document.getElementById(&quot;realname&quot;).value;</span>
<a href="#l1.98"></a><span id="l1.98" class="difflineplus">+    this._password = document.getElementById(&quot;password&quot;).value;</span>
<a href="#l1.99"></a><span id="l1.99"> </span>
<a href="#l1.100"></a><span id="l1.100">     this.showConfigDetails();</span>
<a href="#l1.101"></a><span id="l1.101"> </span>
<a href="#l1.102"></a><span id="l1.102">     let domain = this._email.split(&quot;@&quot;)[1];</span>
<a href="#l1.103"></a><span id="l1.103">     this.findConfig(domain, this._email);</span>
<a href="#l1.104"></a><span id="l1.104"> </span>
<a href="#l1.105"></a><span id="l1.105">     // swap out buttons</span>
<a href="#l1.106"></a><span id="l1.106">     _hide(&quot;next_button&quot;);</span>
<a href="#l1.107"></a><span id="l1.107" class="difflineat">@@ -210,42 +195,44 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.108"></a><span id="l1.108">    *</span>
<a href="#l1.109"></a><span id="l1.109">    * NOTE: The remember password input was skipped purposefully, people should</span>
<a href="#l1.110"></a><span id="l1.110">    *        continue to be able to change that setting even as account details</span>
<a href="#l1.111"></a><span id="l1.111">    *        are determined.</span>
<a href="#l1.112"></a><span id="l1.112">    */</span>
<a href="#l1.113"></a><span id="l1.113">   _accountInfoInputs : function(disabled)</span>
<a href="#l1.114"></a><span id="l1.114">   {</span>
<a href="#l1.115"></a><span id="l1.115">     let ids = [&quot;realname&quot;,&quot;email&quot;,&quot;password&quot;];</span>
<a href="#l1.116"></a><span id="l1.116" class="difflineminus">-    if (disabled &amp;&amp; getElementById(&quot;password&quot;).getAttribute(&quot;empty&quot;)) {</span>
<a href="#l1.117"></a><span id="l1.117" class="difflineminus">-      getElementById(&quot;password&quot;).value = &quot; &quot;;</span>
<a href="#l1.118"></a><span id="l1.118" class="difflineminus">-      getElementById(&quot;password&quot;).setAttribute(&quot;empty&quot;, true);</span>
<a href="#l1.119"></a><span id="l1.119" class="difflineminus">-      getElementById(&quot;remember_password&quot;).checked = false;</span>
<a href="#l1.120"></a><span id="l1.120" class="difflineplus">+    if (disabled &amp;&amp; document.getElementById(&quot;password&quot;).getAttribute(&quot;empty&quot;)) {</span>
<a href="#l1.121"></a><span id="l1.121" class="difflineplus">+      document.getElementById(&quot;password&quot;).value = &quot; &quot;;</span>
<a href="#l1.122"></a><span id="l1.122" class="difflineplus">+      document.getElementById(&quot;password&quot;).setAttribute(&quot;empty&quot;, true);</span>
<a href="#l1.123"></a><span id="l1.123" class="difflineplus">+      document.getElementById(&quot;remember_password&quot;).checked = false;</span>
<a href="#l1.124"></a><span id="l1.124">     }</span>
<a href="#l1.125"></a><span id="l1.125"> </span>
<a href="#l1.126"></a><span id="l1.126">     for ( let i = 0; i &lt; ids.length; i++ )</span>
<a href="#l1.127"></a><span id="l1.127" class="difflineminus">-      getElementById(ids[i]).disabled = disabled;</span>
<a href="#l1.128"></a><span id="l1.128" class="difflineplus">+      document.getElementById(ids[i]).disabled = disabled;</span>
<a href="#l1.129"></a><span id="l1.129"> </span>
<a href="#l1.130"></a><span id="l1.130" class="difflineminus">-    if (!disabled &amp;&amp; getElementById(&quot;password&quot;).getAttribute(&quot;empty&quot;)) {</span>
<a href="#l1.131"></a><span id="l1.131" class="difflineminus">-      getElementById(&quot;password&quot;).value = &quot;&quot;;</span>
<a href="#l1.132"></a><span id="l1.132" class="difflineminus">-      getElementById(&quot;password&quot;).setAttribute(&quot;empty&quot;, true);</span>
<a href="#l1.133"></a><span id="l1.133" class="difflineminus">-      getElementById(&quot;remember_password&quot;).checked = false;</span>
<a href="#l1.134"></a><span id="l1.134" class="difflineplus">+    if (!disabled &amp;&amp;</span>
<a href="#l1.135"></a><span id="l1.135" class="difflineplus">+        document.getElementById(&quot;password&quot;).getAttribute(&quot;empty&quot;)) {</span>
<a href="#l1.136"></a><span id="l1.136" class="difflineplus">+      document.getElementById(&quot;password&quot;).value = &quot;&quot;;</span>
<a href="#l1.137"></a><span id="l1.137" class="difflineplus">+      document.getElementById(&quot;password&quot;).setAttribute(&quot;empty&quot;, true);</span>
<a href="#l1.138"></a><span id="l1.138" class="difflineplus">+      document.getElementById(&quot;remember_password&quot;).checked = false;</span>
<a href="#l1.139"></a><span id="l1.139">     }</span>
<a href="#l1.140"></a><span id="l1.140">   },</span>
<a href="#l1.141"></a><span id="l1.141"> </span>
<a href="#l1.142"></a><span id="l1.142">   userChangedOutgoing : function(event)</span>
<a href="#l1.143"></a><span id="l1.143">   {</span>
<a href="#l1.144"></a><span id="l1.144" class="difflineminus">-    let menulist = getElementById(&quot;outgoing_server&quot;);</span>
<a href="#l1.145"></a><span id="l1.145" class="difflineplus">+    let menulist = document.getElementById(&quot;outgoing_server&quot;);</span>
<a href="#l1.146"></a><span id="l1.146"> </span>
<a href="#l1.147"></a><span id="l1.147">     let selectedIndex = menulist.getIndexOfItem(event.target);</span>
<a href="#l1.148"></a><span id="l1.148"> </span>
<a href="#l1.149"></a><span id="l1.149">     if (selectedIndex != -1) {</span>
<a href="#l1.150"></a><span id="l1.150" class="difflineminus">-      getElementById(&quot;outgoing_port&quot;).value = this._currentConfig.outgoing.port;</span>
<a href="#l1.151"></a><span id="l1.151" class="difflineminus">-      getElementById(&quot;outgoing_security&quot;).value = this._currentConfig</span>
<a href="#l1.152"></a><span id="l1.152" class="difflineminus">-                                                      .outgoing.socketType;</span>
<a href="#l1.153"></a><span id="l1.153" class="difflineplus">+      document.getElementById(&quot;outgoing_port&quot;).value =</span>
<a href="#l1.154"></a><span id="l1.154" class="difflineplus">+        this._currentConfig.outgoing.port;</span>
<a href="#l1.155"></a><span id="l1.155" class="difflineplus">+      document.getElementById(&quot;outgoing_security&quot;).value =</span>
<a href="#l1.156"></a><span id="l1.156" class="difflineplus">+        this._currentConfig.outgoing.socketType;</span>
<a href="#l1.157"></a><span id="l1.157">     }</span>
<a href="#l1.158"></a><span id="l1.158"> </span>
<a href="#l1.159"></a><span id="l1.159">     if (selectedIndex == -1 || selectedIndex == 0) {</span>
<a href="#l1.160"></a><span id="l1.160">       this._outgoingState = '';</span>
<a href="#l1.161"></a><span id="l1.161">       this._userPickedOutgoingServer = false;</span>
<a href="#l1.162"></a><span id="l1.162">       _show('outgoing_protocol');</span>
<a href="#l1.163"></a><span id="l1.163">       _show('outgoing_port');</span>
<a href="#l1.164"></a><span id="l1.164">       _show('outgoing_security');</span>
<a href="#l1.165"></a><span id="l1.165" class="difflineat">@@ -270,66 +257,66 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.166"></a><span id="l1.166">   },</span>
<a href="#l1.167"></a><span id="l1.167"> </span>
<a href="#l1.168"></a><span id="l1.168">   /* This does very little other than to check that a name was entered at all</span>
<a href="#l1.169"></a><span id="l1.169">    * Since this is such an insignificant test we should be using a very light</span>
<a href="#l1.170"></a><span id="l1.170">    * or even jovial warning.</span>
<a href="#l1.171"></a><span id="l1.171">    */</span>
<a href="#l1.172"></a><span id="l1.172">   validateRealname : function()</span>
<a href="#l1.173"></a><span id="l1.173">   {</span>
<a href="#l1.174"></a><span id="l1.174" class="difflineminus">-    if (getElementById('realname').value.length &gt; 0)</span>
<a href="#l1.175"></a><span id="l1.175" class="difflineplus">+    if (document.getElementById('realname').value.length &gt; 0)</span>
<a href="#l1.176"></a><span id="l1.176">       this.clearError('nameerror');</span>
<a href="#l1.177"></a><span id="l1.177">     else</span>
<a href="#l1.178"></a><span id="l1.178">       this.setError(&quot;nameerror&quot;, &quot;name.error&quot;);</span>
<a href="#l1.179"></a><span id="l1.179">   },</span>
<a href="#l1.180"></a><span id="l1.180"> </span>
<a href="#l1.181"></a><span id="l1.181">   /*</span>
<a href="#l1.182"></a><span id="l1.182">    * This checks if the email address is at least possibly valid, meaning it</span>
<a href="#l1.183"></a><span id="l1.183">    * has an '@' before the last char.</span>
<a href="#l1.184"></a><span id="l1.184">    */</span>
<a href="#l1.185"></a><span id="l1.185">   emailAddrValidish : function()</span>
<a href="#l1.186"></a><span id="l1.186">   {</span>
<a href="#l1.187"></a><span id="l1.187" class="difflineminus">-    let emailAddr = getElementById('email').value;</span>
<a href="#l1.188"></a><span id="l1.188" class="difflineplus">+    let emailAddr = document.getElementById('email').value;</span>
<a href="#l1.189"></a><span id="l1.189">     let atPos = emailAddr.lastIndexOf(&quot;@&quot;);</span>
<a href="#l1.190"></a><span id="l1.190">     return  atPos &gt; 0 &amp;&amp; atPos + 1 &lt; emailAddr.length;</span>
<a href="#l1.191"></a><span id="l1.191">   },</span>
<a href="#l1.192"></a><span id="l1.192"> </span>
<a href="#l1.193"></a><span id="l1.193">   /*</span>
<a href="#l1.194"></a><span id="l1.194">    * onEmailInput and onRealnameInput are called onInput, and just handle</span>
<a href="#l1.195"></a><span id="l1.195">    * hiding/showing the next button based on whether there's a semi-reasonable</span>
<a href="#l1.196"></a><span id="l1.196">    * e-mail address and nonblank realname to start with.</span>
<a href="#l1.197"></a><span id="l1.197">    */</span>
<a href="#l1.198"></a><span id="l1.198">   onEmailInput : function()</span>
<a href="#l1.199"></a><span id="l1.199">   {</span>
<a href="#l1.200"></a><span id="l1.200" class="difflineminus">-    if (getElementById('realname').value.length &gt; 0 &amp;&amp;</span>
<a href="#l1.201"></a><span id="l1.201" class="difflineplus">+    if (document.getElementById('realname').value.length &gt; 0 &amp;&amp;</span>
<a href="#l1.202"></a><span id="l1.202">         this.emailAddrValidish())</span>
<a href="#l1.203"></a><span id="l1.203">       _show(&quot;next_button&quot;);</span>
<a href="#l1.204"></a><span id="l1.204">     else</span>
<a href="#l1.205"></a><span id="l1.205">       _hide(&quot;next_button&quot;);</span>
<a href="#l1.206"></a><span id="l1.206">    },</span>
<a href="#l1.207"></a><span id="l1.207"> </span>
<a href="#l1.208"></a><span id="l1.208">   onRealnameInput : function()</span>
<a href="#l1.209"></a><span id="l1.209">   {</span>
<a href="#l1.210"></a><span id="l1.210" class="difflineminus">-    if (getElementById('realname').value.length &gt; 0 &amp;&amp;</span>
<a href="#l1.211"></a><span id="l1.211" class="difflineplus">+    if (document.getElementById('realname').value.length &gt; 0 &amp;&amp;</span>
<a href="#l1.212"></a><span id="l1.212">         this.emailAddrValidish())</span>
<a href="#l1.213"></a><span id="l1.213">       _show(&quot;next_button&quot;);</span>
<a href="#l1.214"></a><span id="l1.214">     else</span>
<a href="#l1.215"></a><span id="l1.215">       _hide(&quot;next_button&quot;);</span>
<a href="#l1.216"></a><span id="l1.216">    },</span>
<a href="#l1.217"></a><span id="l1.217"> </span>
<a href="#l1.218"></a><span id="l1.218">   /* This check is done on blur and is only done as an informative warning</span>
<a href="#l1.219"></a><span id="l1.219">    * we don't want to block the person if they've entered and email that</span>
<a href="#l1.220"></a><span id="l1.220">    * doesn't conform to our regex</span>
<a href="#l1.221"></a><span id="l1.221">    */</span>
<a href="#l1.222"></a><span id="l1.222">   validateEmail : function()</span>
<a href="#l1.223"></a><span id="l1.223">   {</span>
<a href="#l1.224"></a><span id="l1.224" class="difflineminus">-    if (getElementById('email').value.length &lt;= 0)</span>
<a href="#l1.225"></a><span id="l1.225" class="difflineplus">+    if (document.getElementById('email').value.length &lt;= 0)</span>
<a href="#l1.226"></a><span id="l1.226">       return;</span>
<a href="#l1.227"></a><span id="l1.227"> </span>
<a href="#l1.228"></a><span id="l1.228" class="difflineminus">-    if (emailRE.test(getElementById('email').value))</span>
<a href="#l1.229"></a><span id="l1.229" class="difflineplus">+    if (emailRE.test(document.getElementById('email').value))</span>
<a href="#l1.230"></a><span id="l1.230">       this.clearError('emailerror');</span>
<a href="#l1.231"></a><span id="l1.231">     else</span>
<a href="#l1.232"></a><span id="l1.232">       this.setError(&quot;emailerror&quot;, &quot;email.error&quot;);</span>
<a href="#l1.233"></a><span id="l1.233">   },</span>
<a href="#l1.234"></a><span id="l1.234"> </span>
<a href="#l1.235"></a><span id="l1.235">   // We use this to  prevent probing from forgetting the user's choice.</span>
<a href="#l1.236"></a><span id="l1.236">   setSecurity : function(eltId)</span>
<a href="#l1.237"></a><span id="l1.237">   {</span>
<a href="#l1.238"></a><span id="l1.238" class="difflineat">@@ -362,33 +349,33 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.239"></a><span id="l1.239">         this._userChangedOutgoingPort = true;</span>
<a href="#l1.240"></a><span id="l1.240">         this._outgoingState = &quot;&quot;;</span>
<a href="#l1.241"></a><span id="l1.241">         break;</span>
<a href="#l1.242"></a><span id="l1.242">     }</span>
<a href="#l1.243"></a><span id="l1.243">   },</span>
<a href="#l1.244"></a><span id="l1.244">   </span>
<a href="#l1.245"></a><span id="l1.245">   oninputPassword : function()</span>
<a href="#l1.246"></a><span id="l1.246">   {</span>
<a href="#l1.247"></a><span id="l1.247" class="difflineminus">-    let passwordElt = getElementById(&quot;password&quot;);</span>
<a href="#l1.248"></a><span id="l1.248" class="difflineminus">-    let rememberPasswordElt = getElementById(&quot;remember_password&quot;);</span>
<a href="#l1.249"></a><span id="l1.249" class="difflineplus">+    let passwordElt = document.getElementById(&quot;password&quot;);</span>
<a href="#l1.250"></a><span id="l1.250" class="difflineplus">+    let rememberPasswordElt = document.getElementById(&quot;remember_password&quot;);</span>
<a href="#l1.251"></a><span id="l1.251">     if (passwordElt.value.length &lt; 1) {</span>
<a href="#l1.252"></a><span id="l1.252" class="difflineminus">-      getElementById(&quot;remember_password&quot;).checked = false;</span>
<a href="#l1.253"></a><span id="l1.253" class="difflineplus">+      document.getElementById(&quot;remember_password&quot;).checked = false;</span>
<a href="#l1.254"></a><span id="l1.254">       this._userChangedPassword = false;</span>
<a href="#l1.255"></a><span id="l1.255">     }</span>
<a href="#l1.256"></a><span id="l1.256">     else if (!this._userChangedPassword)</span>
<a href="#l1.257"></a><span id="l1.257" class="difflineminus">-      getElementById(&quot;remember_password&quot;).checked = true;</span>
<a href="#l1.258"></a><span id="l1.258" class="difflineplus">+      document.getElementById(&quot;remember_password&quot;).checked = true;</span>
<a href="#l1.259"></a><span id="l1.259">   },</span>
<a href="#l1.260"></a><span id="l1.260"> </span>
<a href="#l1.261"></a><span id="l1.261">   /* If the user just tabbed through the password input without entering</span>
<a href="#l1.262"></a><span id="l1.262">    * anything, set the type back to text so we don't wind up showing the</span>
<a href="#l1.263"></a><span id="l1.263">    * emptytext as bullet characters.</span>
<a href="#l1.264"></a><span id="l1.264">    */</span>
<a href="#l1.265"></a><span id="l1.265">   onblurPassword : function()</span>
<a href="#l1.266"></a><span id="l1.266">   {</span>
<a href="#l1.267"></a><span id="l1.267" class="difflineminus">-    let passwordElt = getElementById(&quot;password&quot;);</span>
<a href="#l1.268"></a><span id="l1.268" class="difflineplus">+    let passwordElt = document.getElementById(&quot;password&quot;);</span>
<a href="#l1.269"></a><span id="l1.269">     if (passwordElt.value.length &lt; 1)</span>
<a href="#l1.270"></a><span id="l1.270">       passwordElt.type = &quot;text&quot;;</span>
<a href="#l1.271"></a><span id="l1.271">   },</span>
<a href="#l1.272"></a><span id="l1.272"> </span>
<a href="#l1.273"></a><span id="l1.273">   findConfig : function(domain, email)</span>
<a href="#l1.274"></a><span id="l1.274">   {</span>
<a href="#l1.275"></a><span id="l1.275">     gEmailWizardLogger.info(&quot;findConfig()&quot;);</span>
<a href="#l1.276"></a><span id="l1.276">     this.startSpinner(&quot;searching_for_configs&quot;);</span>
<a href="#l1.277"></a><span id="l1.277" class="difflineat">@@ -543,18 +530,18 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.278"></a><span id="l1.278">   {</span>
<a href="#l1.279"></a><span id="l1.279">     this._currentConfigFilledIn = config.copy();</span>
<a href="#l1.280"></a><span id="l1.280">     _show(&quot;advanced_settings&quot;);</span>
<a href="#l1.281"></a><span id="l1.281">     replaceVariables(this._currentConfigFilledIn, this._realname, this._email,</span>
<a href="#l1.282"></a><span id="l1.282">                      this._password);</span>
<a href="#l1.283"></a><span id="l1.283"> </span>
<a href="#l1.284"></a><span id="l1.284">     this.updateConfig(this._currentConfigFilledIn);</span>
<a href="#l1.285"></a><span id="l1.285"> </span>
<a href="#l1.286"></a><span id="l1.286" class="difflineminus">-    getElementById('create_button').disabled = false;</span>
<a href="#l1.287"></a><span id="l1.287" class="difflineminus">-    getElementById('create_button').hidden = false;</span>
<a href="#l1.288"></a><span id="l1.288" class="difflineplus">+    document.getElementById('create_button').disabled = false;</span>
<a href="#l1.289"></a><span id="l1.289" class="difflineplus">+    document.getElementById('create_button').hidden = false;</span>
<a href="#l1.290"></a><span id="l1.290"> </span>
<a href="#l1.291"></a><span id="l1.291">   },</span>
<a href="#l1.292"></a><span id="l1.292"> </span>
<a href="#l1.293"></a><span id="l1.293">   /*</span>
<a href="#l1.294"></a><span id="l1.294">    * Returns either the nsISmtpServer.key for an existing account that matches</span>
<a href="#l1.295"></a><span id="l1.295">    * our discovered hostname + port + username, or false if no match is found.</span>
<a href="#l1.296"></a><span id="l1.296">    */</span>
<a href="#l1.297"></a><span id="l1.297">   keyForExistingOutgoingAccount : function()</span>
<a href="#l1.298"></a><span id="l1.298" class="difflineat">@@ -604,17 +591,17 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.299"></a><span id="l1.299">       details.setAttribute(&quot;collapsed&quot;, true);</span>
<a href="#l1.300"></a><span id="l1.300">       tech.removeAttribute(&quot;expanded&quot;);</span>
<a href="#l1.301"></a><span id="l1.301">     }</span>
<a href="#l1.302"></a><span id="l1.302">   },</span>
<a href="#l1.303"></a><span id="l1.303"> </span>
<a href="#l1.304"></a><span id="l1.304">   toggleAcknowledgeWarning : function()</span>
<a href="#l1.305"></a><span id="l1.305">   {</span>
<a href="#l1.306"></a><span id="l1.306">     this._warningAcknowledged =</span>
<a href="#l1.307"></a><span id="l1.307" class="difflineminus">-      getElementById('acknowledge_warning').checked;</span>
<a href="#l1.308"></a><span id="l1.308" class="difflineplus">+      document.getElementById('acknowledge_warning').checked;</span>
<a href="#l1.309"></a><span id="l1.309">     this.checkEnableIKnow();</span>
<a href="#l1.310"></a><span id="l1.310">   },</span>
<a href="#l1.311"></a><span id="l1.311"> </span>
<a href="#l1.312"></a><span id="l1.312">   checkEnableIKnow: function()</span>
<a href="#l1.313"></a><span id="l1.313">   {</span>
<a href="#l1.314"></a><span id="l1.314">     if ((!this._incomingWarning &amp;&amp; !this._outgoingWarning) ||</span>
<a href="#l1.315"></a><span id="l1.315">         this._warningAcknowledged)</span>
<a href="#l1.316"></a><span id="l1.316">       document.getElementById('iknow').disabled = false;</span>
<a href="#l1.317"></a><span id="l1.317" class="difflineat">@@ -699,17 +686,17 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.318"></a><span id="l1.318">       }</span>
<a href="#l1.319"></a><span id="l1.319"> </span>
<a href="#l1.320"></a><span id="l1.320">     } catch (ex) { alertPrompt(gStringsBundle.getString(&quot;error_creating_account&quot;), ex); }</span>
<a href="#l1.321"></a><span id="l1.321">   },</span>
<a href="#l1.322"></a><span id="l1.322"> </span>
<a href="#l1.323"></a><span id="l1.323">   getMeOutOfHere : function()</span>
<a href="#l1.324"></a><span id="l1.324">   {</span>
<a href="#l1.325"></a><span id="l1.325">     // If we're going backwards, we should reset the acknowledge_warning.</span>
<a href="#l1.326"></a><span id="l1.326" class="difflineminus">-    getElementById('acknowledge_warning').checked = false;</span>
<a href="#l1.327"></a><span id="l1.327" class="difflineplus">+    document.getElementById('acknowledge_warning').checked = false;</span>
<a href="#l1.328"></a><span id="l1.328">     this.toggleAcknowledgeWarning();</span>
<a href="#l1.329"></a><span id="l1.329">     _hide('warningbox');</span>
<a href="#l1.330"></a><span id="l1.330">     _show('mastervbox');</span>
<a href="#l1.331"></a><span id="l1.331">   },</span>
<a href="#l1.332"></a><span id="l1.332"> </span>
<a href="#l1.333"></a><span id="l1.333">   validateAndFinish : function()</span>
<a href="#l1.334"></a><span id="l1.334">   {</span>
<a href="#l1.335"></a><span id="l1.335">     // if we're coming from the cert warning dialog</span>
<a href="#l1.336"></a><span id="l1.336" class="difflineat">@@ -728,26 +715,26 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.337"></a><span id="l1.337">       let existingKey = this.keyForExistingOutgoingAccount();</span>
<a href="#l1.338"></a><span id="l1.338">       if (existingKey)</span>
<a href="#l1.339"></a><span id="l1.339">       {</span>
<a href="#l1.340"></a><span id="l1.340">         this._currentConfigFilledIn.outgoing.addThisServer = false;</span>
<a href="#l1.341"></a><span id="l1.341">         this._currentConfigFilledIn.outgoing.existingServerKey = existingKey;</span>
<a href="#l1.342"></a><span id="l1.342">       }</span>
<a href="#l1.343"></a><span id="l1.343">     }</span>
<a href="#l1.344"></a><span id="l1.344"> </span>
<a href="#l1.345"></a><span id="l1.345" class="difflineminus">-    getElementById('create_button').disabled = true;</span>
<a href="#l1.346"></a><span id="l1.346" class="difflineplus">+    document.getElementById('create_button').disabled = true;</span>
<a href="#l1.347"></a><span id="l1.347">     var me = this;</span>
<a href="#l1.348"></a><span id="l1.348">     if (!this._verifiedConfig)</span>
<a href="#l1.349"></a><span id="l1.349">       this.verifyConfig(function() // success</span>
<a href="#l1.350"></a><span id="l1.350">                         {</span>
<a href="#l1.351"></a><span id="l1.351">                           me.finish();</span>
<a href="#l1.352"></a><span id="l1.352">                         },</span>
<a href="#l1.353"></a><span id="l1.353">                         function(e) // failure</span>
<a href="#l1.354"></a><span id="l1.354">                         {</span>
<a href="#l1.355"></a><span id="l1.355" class="difflineminus">-                          getElementById('create_button').disabled = false;</span>
<a href="#l1.356"></a><span id="l1.356" class="difflineplus">+                          document.getElementById('create_button').disabled = false;</span>
<a href="#l1.357"></a><span id="l1.357">                         });</span>
<a href="#l1.358"></a><span id="l1.358">     else</span>
<a href="#l1.359"></a><span id="l1.359">       this.finish();</span>
<a href="#l1.360"></a><span id="l1.360">   },</span>
<a href="#l1.361"></a><span id="l1.361"> </span>
<a href="#l1.362"></a><span id="l1.362">   verifyConfig : function(successCallback, errorCallback)</span>
<a href="#l1.363"></a><span id="l1.363">   {</span>
<a href="#l1.364"></a><span id="l1.364">     var me = this;</span>
<a href="#l1.365"></a><span id="l1.365" class="difflineat">@@ -775,32 +762,32 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.366"></a><span id="l1.366">           errorCallback(e);</span>
<a href="#l1.367"></a><span id="l1.367">       });</span>
<a href="#l1.368"></a><span id="l1.368">   },</span>
<a href="#l1.369"></a><span id="l1.369"> </span>
<a href="#l1.370"></a><span id="l1.370">   finish : function()</span>
<a href="#l1.371"></a><span id="l1.371">   {</span>
<a href="#l1.372"></a><span id="l1.372">     gEmailWizardLogger.info(&quot;creating account in backend&quot;);</span>
<a href="#l1.373"></a><span id="l1.373">     this._currentConfigFilledIn.rememberPassword =</span>
<a href="#l1.374"></a><span id="l1.374" class="difflineminus">-      getElementById(&quot;remember_password&quot;).checked;</span>
<a href="#l1.375"></a><span id="l1.375" class="difflineplus">+      document.getElementById(&quot;remember_password&quot;).checked;</span>
<a href="#l1.376"></a><span id="l1.376">     createAccountInBackend(this._currentConfigFilledIn);</span>
<a href="#l1.377"></a><span id="l1.377">     window.close();</span>
<a href="#l1.378"></a><span id="l1.378">   },</span>
<a href="#l1.379"></a><span id="l1.379"> </span>
<a href="#l1.380"></a><span id="l1.380">   advancedSettings : function()</span>
<a href="#l1.381"></a><span id="l1.381">   {</span>
<a href="#l1.382"></a><span id="l1.382">     let config = this._currentConfigFilledIn ? this._currentConfigFilledIn.copy()</span>
<a href="#l1.383"></a><span id="l1.383">                                              : this.getUserConfig();</span>
<a href="#l1.384"></a><span id="l1.384">     // call this to set the password</span>
<a href="#l1.385"></a><span id="l1.385">     replaceVariables(config, this._realname, this._email,</span>
<a href="#l1.386"></a><span id="l1.386">                      this._password);</span>
<a href="#l1.387"></a><span id="l1.387"> </span>
<a href="#l1.388"></a><span id="l1.388">     gEmailWizardLogger.info(&quot;creating account in backend&quot;);</span>
<a href="#l1.389"></a><span id="l1.389">     config.rememberPassword =</span>
<a href="#l1.390"></a><span id="l1.390" class="difflineminus">-      getElementById(&quot;remember_password&quot;).checked;</span>
<a href="#l1.391"></a><span id="l1.391" class="difflineplus">+      document.getElementById(&quot;remember_password&quot;).checked;</span>
<a href="#l1.392"></a><span id="l1.392">     var newAccount = createAccountInBackend(config);</span>
<a href="#l1.393"></a><span id="l1.393">     var windowManager =</span>
<a href="#l1.394"></a><span id="l1.394">       Components.classes['@mozilla.org/appshell/window-mediator;1']</span>
<a href="#l1.395"></a><span id="l1.395">                 .getService(Components.interfaces.nsIWindowMediator);</span>
<a href="#l1.396"></a><span id="l1.396"> </span>
<a href="#l1.397"></a><span id="l1.397">     var existingAccountManager =</span>
<a href="#l1.398"></a><span id="l1.398">       windowManager.getMostRecentWindow(&quot;mailnews:accountmanager&quot;);</span>
<a href="#l1.399"></a><span id="l1.399"> </span>
<a href="#l1.400"></a><span id="l1.400" class="difflineat">@@ -825,39 +812,42 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.401"></a><span id="l1.401">     config.source = AccountConfig.kSourceGuess;</span>
<a href="#l1.402"></a><span id="l1.402"> </span>
<a href="#l1.403"></a><span id="l1.403">     // Did the user select one of the already configured SMTP servers from the</span>
<a href="#l1.404"></a><span id="l1.404">     // drop-down list? If so, use it.</span>
<a href="#l1.405"></a><span id="l1.405">     if (this._userPickedOutgoingServer)</span>
<a href="#l1.406"></a><span id="l1.406">     {</span>
<a href="#l1.407"></a><span id="l1.407">       config.outgoing.addThisServer = false;</span>
<a href="#l1.408"></a><span id="l1.408">       config.outgoing.existingServerKey =</span>
<a href="#l1.409"></a><span id="l1.409" class="difflineminus">-        getElementById(&quot;outgoing_server&quot;).selectedItem.value;</span>
<a href="#l1.410"></a><span id="l1.410" class="difflineplus">+        document.getElementById(&quot;outgoing_server&quot;).selectedItem.value;</span>
<a href="#l1.411"></a><span id="l1.411">       config.outgoing.existingServerLabel =</span>
<a href="#l1.412"></a><span id="l1.412" class="difflineminus">-        getElementById(&quot;outgoing_server&quot;).selectedItem.label;</span>
<a href="#l1.413"></a><span id="l1.413" class="difflineplus">+        document.getElementById(&quot;outgoing_server&quot;).selectedItem.label;</span>
<a href="#l1.414"></a><span id="l1.414">     }</span>
<a href="#l1.415"></a><span id="l1.415">     else</span>
<a href="#l1.416"></a><span id="l1.416">     {</span>
<a href="#l1.417"></a><span id="l1.417" class="difflineminus">-      config.outgoing.username = getElementById(&quot;username&quot;).value;</span>
<a href="#l1.418"></a><span id="l1.418" class="difflineminus">-      config.outgoing.hostname = getElementById(&quot;outgoing_server&quot;).value;</span>
<a href="#l1.419"></a><span id="l1.419" class="difflineplus">+      config.outgoing.username = document.getElementById(&quot;username&quot;).value;</span>
<a href="#l1.420"></a><span id="l1.420" class="difflineplus">+      config.outgoing.hostname =</span>
<a href="#l1.421"></a><span id="l1.421" class="difflineplus">+        document.getElementById(&quot;outgoing_server&quot;).value;</span>
<a href="#l1.422"></a><span id="l1.422">       config.outgoing.port =</span>
<a href="#l1.423"></a><span id="l1.423" class="difflineminus">-        sanitize.integerRange(getElementById(&quot;outgoing_port&quot;).value, 1,</span>
<a href="#l1.424"></a><span id="l1.424" class="difflineplus">+        sanitize.integerRange(document.getElementById(&quot;outgoing_port&quot;).value, 1,</span>
<a href="#l1.425"></a><span id="l1.425">                               kHighestPort);</span>
<a href="#l1.426"></a><span id="l1.426" class="difflineminus">-      config.outgoing.socketType = parseInt(getElementById(&quot;outgoing_security&quot;).value);</span>
<a href="#l1.427"></a><span id="l1.427" class="difflineplus">+      config.outgoing.socketType =</span>
<a href="#l1.428"></a><span id="l1.428" class="difflineplus">+        parseInt(document.getElementById(&quot;outgoing_security&quot;).value);</span>
<a href="#l1.429"></a><span id="l1.429">     }</span>
<a href="#l1.430"></a><span id="l1.430" class="difflineminus">-    config.incoming.username = getElementById(&quot;username&quot;).value;</span>
<a href="#l1.431"></a><span id="l1.431" class="difflineminus">-    config.incoming.hostname = getElementById(&quot;incoming_server&quot;).value;</span>
<a href="#l1.432"></a><span id="l1.432" class="difflineplus">+    config.incoming.username = document.getElementById(&quot;username&quot;).value;</span>
<a href="#l1.433"></a><span id="l1.433" class="difflineplus">+    config.incoming.hostname = document.getElementById(&quot;incoming_server&quot;).value;</span>
<a href="#l1.434"></a><span id="l1.434">     config.incoming.port =</span>
<a href="#l1.435"></a><span id="l1.435" class="difflineminus">-      sanitize.integerRange(getElementById(&quot;incoming_port&quot;).value, 1,</span>
<a href="#l1.436"></a><span id="l1.436" class="difflineplus">+      sanitize.integerRange(document.getElementById(&quot;incoming_port&quot;).value, 1,</span>
<a href="#l1.437"></a><span id="l1.437">                             kHighestPort);</span>
<a href="#l1.438"></a><span id="l1.438">     config.incoming.type =</span>
<a href="#l1.439"></a><span id="l1.439" class="difflineminus">-      getElementById(&quot;incoming_protocol&quot;).value == 1 ? &quot;imap&quot; : &quot;pop3&quot;;</span>
<a href="#l1.440"></a><span id="l1.440" class="difflineplus">+      document.getElementById(&quot;incoming_protocol&quot;).value == 1 ? &quot;imap&quot; : &quot;pop3&quot;;</span>
<a href="#l1.441"></a><span id="l1.441">     // type is a string, &quot;imap&quot; or &quot;pop3&quot;, protocol is a protocol type.</span>
<a href="#l1.442"></a><span id="l1.442">     config.incoming.protocol = sanitize.translate(config.incoming.type, { &quot;imap&quot; : 0, &quot;pop3&quot; : 1});</span>
<a href="#l1.443"></a><span id="l1.443" class="difflineminus">-    config.incoming.socketType = parseInt(getElementById(&quot;incoming_security&quot;).value);</span>
<a href="#l1.444"></a><span id="l1.444" class="difflineplus">+    config.incoming.socketType =</span>
<a href="#l1.445"></a><span id="l1.445" class="difflineplus">+      parseInt(document.getElementById(&quot;incoming_security&quot;).value);</span>
<a href="#l1.446"></a><span id="l1.446"> </span>
<a href="#l1.447"></a><span id="l1.447">     return config;</span>
<a href="#l1.448"></a><span id="l1.448">   },</span>
<a href="#l1.449"></a><span id="l1.449"> </span>
<a href="#l1.450"></a><span id="l1.450">   _setIncomingStatus : function(state, details)</span>
<a href="#l1.451"></a><span id="l1.451">   {</span>
<a href="#l1.452"></a><span id="l1.452">     if (!details)</span>
<a href="#l1.453"></a><span id="l1.453">       details = &quot;&quot;;</span>
<a href="#l1.454"></a><span id="l1.454" class="difflineat">@@ -909,17 +899,17 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.455"></a><span id="l1.455">     if (state == 'weak')</span>
<a href="#l1.456"></a><span id="l1.456">       this._outgoingState = 'done';</span>
<a href="#l1.457"></a><span id="l1.457"> </span>
<a href="#l1.458"></a><span id="l1.458">     this._setIconAndTooltip('outgoing_status', state, details);</span>
<a href="#l1.459"></a><span id="l1.459">   },</span>
<a href="#l1.460"></a><span id="l1.460"> </span>
<a href="#l1.461"></a><span id="l1.461">   _setIconAndTooltip : function(id, state, details)</span>
<a href="#l1.462"></a><span id="l1.462">   {</span>
<a href="#l1.463"></a><span id="l1.463" class="difflineminus">-    let icon = getElementById(id);</span>
<a href="#l1.464"></a><span id="l1.464" class="difflineplus">+    let icon = document.getElementById(id);</span>
<a href="#l1.465"></a><span id="l1.465">     icon.setAttribute(&quot;state&quot;, state);</span>
<a href="#l1.466"></a><span id="l1.466">     switch (state)</span>
<a href="#l1.467"></a><span id="l1.467">     {</span>
<a href="#l1.468"></a><span id="l1.468">       case &quot;weak&quot;:</span>
<a href="#l1.469"></a><span id="l1.469">         icon.setAttribute(&quot;tooltip&quot;, &quot;insecureserver-&quot; + details);</span>
<a href="#l1.470"></a><span id="l1.470">         icon.setAttribute(&quot;popup&quot;, &quot;insecureserver-&quot; + details + &quot;-panel&quot;);</span>
<a href="#l1.471"></a><span id="l1.471">         break;</span>
<a href="#l1.472"></a><span id="l1.472">       case &quot;hidden&quot;:</span>
<a href="#l1.473"></a><span id="l1.473" class="difflineat">@@ -950,42 +940,42 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.474"></a><span id="l1.474">   /* Clears out the config details information, this is really only meant to be</span>
<a href="#l1.475"></a><span id="l1.475">    * called from the (Back) button.</span>
<a href="#l1.476"></a><span id="l1.476">    * XXX This can destroy user input where it might not be necessary</span>
<a href="#l1.477"></a><span id="l1.477">    */</span>
<a href="#l1.478"></a><span id="l1.478">   clearConfigDetails : function()</span>
<a href="#l1.479"></a><span id="l1.479">   {</span>
<a href="#l1.480"></a><span id="l1.480">     for (let i = 0; i &lt; this._configDetailTextInputs.length; i++ )</span>
<a href="#l1.481"></a><span id="l1.481">     {</span>
<a href="#l1.482"></a><span id="l1.482" class="difflineminus">-      getElementById(this._configDetailTextInputs[i]).value = &quot;&quot;;</span>
<a href="#l1.483"></a><span id="l1.483" class="difflineplus">+      document.getElementById(this._configDetailTextInputs[i]).value = &quot;&quot;;</span>
<a href="#l1.484"></a><span id="l1.484">     }</span>
<a href="#l1.485"></a><span id="l1.485"> </span>
<a href="#l1.486"></a><span id="l1.486">     this._setIncomingStatus('hidden');</span>
<a href="#l1.487"></a><span id="l1.487">     this._setOutgoingStatus('hidden');</span>
<a href="#l1.488"></a><span id="l1.488">   },</span>
<a href="#l1.489"></a><span id="l1.489"> </span>
<a href="#l1.490"></a><span id="l1.490">   /* Setting the config details form so it can be edited.  We also disable</span>
<a href="#l1.491"></a><span id="l1.491">    * (and hide) the create button during this time because we don't know what</span>
<a href="#l1.492"></a><span id="l1.492">    * might have changed.  The function called from the button that restarts</span>
<a href="#l1.493"></a><span id="l1.493">    * the config check should be enabling the config button as needed.</span>
<a href="#l1.494"></a><span id="l1.494">    */</span>
<a href="#l1.495"></a><span id="l1.495">   editConfigDetails : function()</span>
<a href="#l1.496"></a><span id="l1.496">   {</span>
<a href="#l1.497"></a><span id="l1.497">     // Add the custom entry to the menulist, if it's not already there.</span>
<a href="#l1.498"></a><span id="l1.498" class="difflineminus">-    let menulist = getElementById(&quot;outgoing_server&quot;);</span>
<a href="#l1.499"></a><span id="l1.499" class="difflineplus">+    let menulist = document.getElementById(&quot;outgoing_server&quot;);</span>
<a href="#l1.500"></a><span id="l1.500">     if (this._smtpServerCount == menulist.itemCount) {</span>
<a href="#l1.501"></a><span id="l1.501" class="difflineminus">-      var hostname = getElementById(&quot;outgoing_server&quot;).value;</span>
<a href="#l1.502"></a><span id="l1.502" class="difflineplus">+      var hostname = document.getElementById(&quot;outgoing_server&quot;).value;</span>
<a href="#l1.503"></a><span id="l1.503">       let menuitem = menulist.insertItemAt(0, hostname, hostname);</span>
<a href="#l1.504"></a><span id="l1.504">       menuitem.hostname = hostname;</span>
<a href="#l1.505"></a><span id="l1.505">     }</span>
<a href="#l1.506"></a><span id="l1.506"> </span>
<a href="#l1.507"></a><span id="l1.507">     this._disableConfigDetails(false);</span>
<a href="#l1.508"></a><span id="l1.508">     this._setIncomingStatus('hidden');</span>
<a href="#l1.509"></a><span id="l1.509">     this._setOutgoingStatus('hidden');</span>
<a href="#l1.510"></a><span id="l1.510" class="difflineminus">-    getElementById('create_button').disabled = true;</span>
<a href="#l1.511"></a><span id="l1.511" class="difflineplus">+    document.getElementById('create_button').disabled = true;</span>
<a href="#l1.512"></a><span id="l1.512">     _hide(&quot;create_button&quot;);</span>
<a href="#l1.513"></a><span id="l1.513">     _hide(&quot;stop_button&quot;);</span>
<a href="#l1.514"></a><span id="l1.514">     _hide(&quot;edit_button&quot;);</span>
<a href="#l1.515"></a><span id="l1.515">     _show(&quot;go_button&quot;);</span>
<a href="#l1.516"></a><span id="l1.516">   },</span>
<a href="#l1.517"></a><span id="l1.517"> </span>
<a href="#l1.518"></a><span id="l1.518">   /* This _doesn't_ set create back to enabled, that needs to be done in a</span>
<a href="#l1.519"></a><span id="l1.519">    * config check.  Only showing the button.</span>
<a href="#l1.520"></a><span id="l1.520" class="difflineat">@@ -1012,51 +1002,53 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.521"></a><span id="l1.521">    * enable or disable each</span>
<a href="#l1.522"></a><span id="l1.522">    */</span>
<a href="#l1.523"></a><span id="l1.523">   _disableConfigDetails : function(disabled)</span>
<a href="#l1.524"></a><span id="l1.524">   {</span>
<a href="#l1.525"></a><span id="l1.525">     let formElements =</span>
<a href="#l1.526"></a><span id="l1.526">       this._configDetailTextInputs.concat(this._configDetailMenulists);</span>
<a href="#l1.527"></a><span id="l1.527">     for (let i = 0; i &lt; formElements.length; i++)</span>
<a href="#l1.528"></a><span id="l1.528">     {</span>
<a href="#l1.529"></a><span id="l1.529" class="difflineminus">-      getElementById(formElements[i]).disabled = disabled;</span>
<a href="#l1.530"></a><span id="l1.530" class="difflineplus">+      document.getElementById(formElements[i]).disabled = disabled;</span>
<a href="#l1.531"></a><span id="l1.531">     }</span>
<a href="#l1.532"></a><span id="l1.532">   },</span>
<a href="#l1.533"></a><span id="l1.533"> </span>
<a href="#l1.534"></a><span id="l1.534">   /**</span>
<a href="#l1.535"></a><span id="l1.535">    * Updates a (probed) config to the user,</span>
<a href="#l1.536"></a><span id="l1.536">    * in the config details area</span>
<a href="#l1.537"></a><span id="l1.537">    *</span>
<a href="#l1.538"></a><span id="l1.538">    * @param config {AccountConfig} The config to present to user</span>
<a href="#l1.539"></a><span id="l1.539">    */</span>
<a href="#l1.540"></a><span id="l1.540">   updateConfig : function(config)</span>
<a href="#l1.541"></a><span id="l1.541">   {</span>
<a href="#l1.542"></a><span id="l1.542">     _show(&quot;advanced_settings&quot;);</span>
<a href="#l1.543"></a><span id="l1.543">     this._currentConfig = config;</span>
<a href="#l1.544"></a><span id="l1.544">     // if we have a username, set it.</span>
<a href="#l1.545"></a><span id="l1.545">     if (config.incoming.username)</span>
<a href="#l1.546"></a><span id="l1.546">     {</span>
<a href="#l1.547"></a><span id="l1.547" class="difflineminus">-      getElementById(&quot;username&quot;).value = config.incoming.username;</span>
<a href="#l1.548"></a><span id="l1.548" class="difflineplus">+      document.getElementById(&quot;username&quot;).value = config.incoming.username;</span>
<a href="#l1.549"></a><span id="l1.549">     }</span>
<a href="#l1.550"></a><span id="l1.550">     else</span>
<a href="#l1.551"></a><span id="l1.551">     {</span>
<a href="#l1.552"></a><span id="l1.552">       // XXX needs more thought</span>
<a href="#l1.553"></a><span id="l1.553">     }</span>
<a href="#l1.554"></a><span id="l1.554"> </span>
<a href="#l1.555"></a><span id="l1.555">     // incoming server</span>
<a href="#l1.556"></a><span id="l1.556">     if (config.incoming.hostname &amp;&amp; config.incoming.hostname != -1)</span>
<a href="#l1.557"></a><span id="l1.557">     {</span>
<a href="#l1.558"></a><span id="l1.558">       /* -1 failure needs to be handled in the context of the failure</span>
<a href="#l1.559"></a><span id="l1.559">         * at this point all we know is there is no hostname, but not why</span>
<a href="#l1.560"></a><span id="l1.560">         * the error handling behaviour needs to be done above</span>
<a href="#l1.561"></a><span id="l1.561">         */</span>
<a href="#l1.562"></a><span id="l1.562" class="difflineminus">-      getElementById(&quot;incoming_server&quot;).value = config.incoming.hostname;</span>
<a href="#l1.563"></a><span id="l1.563" class="difflineminus">-      getElementById(&quot;incoming_port&quot;).value = config.incoming.port;</span>
<a href="#l1.564"></a><span id="l1.564" class="difflineminus">-      getElementById(&quot;incoming_security&quot;).value = config.incoming.socketType;</span>
<a href="#l1.565"></a><span id="l1.565" class="difflineminus">-      getElementById(&quot;incoming_protocol&quot;).value =</span>
<a href="#l1.566"></a><span id="l1.566" class="difflineplus">+      document.getElementById(&quot;incoming_server&quot;).value =</span>
<a href="#l1.567"></a><span id="l1.567" class="difflineplus">+        config.incoming.hostname;</span>
<a href="#l1.568"></a><span id="l1.568" class="difflineplus">+      document.getElementById(&quot;incoming_port&quot;).value = config.incoming.port;</span>
<a href="#l1.569"></a><span id="l1.569" class="difflineplus">+      document.getElementById(&quot;incoming_security&quot;).value =</span>
<a href="#l1.570"></a><span id="l1.570" class="difflineplus">+        config.incoming.socketType;</span>
<a href="#l1.571"></a><span id="l1.571" class="difflineplus">+      document.getElementById(&quot;incoming_protocol&quot;).value =</span>
<a href="#l1.572"></a><span id="l1.572">         sanitize.translate(config.incoming.type, { &quot;imap&quot; : 1, &quot;pop3&quot; : 2});</span>
<a href="#l1.573"></a><span id="l1.573"> </span>
<a href="#l1.574"></a><span id="l1.574">       if (config.incoming._inprogress)</span>
<a href="#l1.575"></a><span id="l1.575">       {</span>
<a href="#l1.576"></a><span id="l1.576">         this._setIncomingStatus('probing');</span>
<a href="#l1.577"></a><span id="l1.577">       }</span>
<a href="#l1.578"></a><span id="l1.578">       else</span>
<a href="#l1.579"></a><span id="l1.579">       {</span>
<a href="#l1.580"></a><span id="l1.580" class="difflineat">@@ -1092,19 +1084,21 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.581"></a><span id="l1.581">     if (config.outgoing.hostname &amp;&amp; config.outgoing.hostname != -1)</span>
<a href="#l1.582"></a><span id="l1.582">     {</span>
<a href="#l1.583"></a><span id="l1.583">       /* -1 failure needs to be handled in the context of the failure</span>
<a href="#l1.584"></a><span id="l1.584">        * at this point all we know is there is no hostname, but not why.</span>
<a href="#l1.585"></a><span id="l1.585">        * The error handling behaviour needs to be done elsewhere</span>
<a href="#l1.586"></a><span id="l1.586">        */</span>
<a href="#l1.587"></a><span id="l1.587">       if (!gEmailConfigWizard._userPickedOutgoingServer)</span>
<a href="#l1.588"></a><span id="l1.588">       {</span>
<a href="#l1.589"></a><span id="l1.589" class="difflineminus">-        getElementById(&quot;outgoing_server&quot;).value = config.outgoing.hostname;</span>
<a href="#l1.590"></a><span id="l1.590" class="difflineminus">-        getElementById(&quot;outgoing_port&quot;).value = config.outgoing.port;</span>
<a href="#l1.591"></a><span id="l1.591" class="difflineminus">-        getElementById(&quot;outgoing_security&quot;).value = config.outgoing.socketType;</span>
<a href="#l1.592"></a><span id="l1.592" class="difflineplus">+        document.getElementById(&quot;outgoing_server&quot;).value =</span>
<a href="#l1.593"></a><span id="l1.593" class="difflineplus">+          config.outgoing.hostname;</span>
<a href="#l1.594"></a><span id="l1.594" class="difflineplus">+        document.getElementById(&quot;outgoing_port&quot;).value = config.outgoing.port;</span>
<a href="#l1.595"></a><span id="l1.595" class="difflineplus">+        document.getElementById(&quot;outgoing_security&quot;).value =</span>
<a href="#l1.596"></a><span id="l1.596" class="difflineplus">+          config.outgoing.socketType;</span>
<a href="#l1.597"></a><span id="l1.597">         _show(&quot;outgoing_port&quot;);</span>
<a href="#l1.598"></a><span id="l1.598">         _show(&quot;outgoing_security&quot;);</span>
<a href="#l1.599"></a><span id="l1.599">         if (config.outgoing._inprogress) {</span>
<a href="#l1.600"></a><span id="l1.600">           this._setOutgoingStatus('probing');</span>
<a href="#l1.601"></a><span id="l1.601">         }</span>
<a href="#l1.602"></a><span id="l1.602">         else</span>
<a href="#l1.603"></a><span id="l1.603">         {</span>
<a href="#l1.604"></a><span id="l1.604">           switch (config.outgoing.socketType)</span>
<a href="#l1.605"></a><span id="l1.605" class="difflineat">@@ -1211,46 +1205,46 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.606"></a><span id="l1.606">   {</span>
<a href="#l1.607"></a><span id="l1.607">     this._showStatusTitle(true, actionStrName);</span>
<a href="#l1.608"></a><span id="l1.608">     gEmailWizardLogger.warn(&quot;spinner stop\n&quot;);</span>
<a href="#l1.609"></a><span id="l1.609">   },</span>
<a href="#l1.610"></a><span id="l1.610"> </span>
<a href="#l1.611"></a><span id="l1.611">   // thought this would be needed other places, not likely though</span>
<a href="#l1.612"></a><span id="l1.612">   _hideSpinner : function(hidden)</span>
<a href="#l1.613"></a><span id="l1.613">   {</span>
<a href="#l1.614"></a><span id="l1.614" class="difflineminus">-    getElementById(&quot;config_spinner&quot;).hidden = hidden;</span>
<a href="#l1.615"></a><span id="l1.615" class="difflineplus">+    document.getElementById(&quot;config_spinner&quot;).hidden = hidden;</span>
<a href="#l1.616"></a><span id="l1.616">   },</span>
<a href="#l1.617"></a><span id="l1.617"> </span>
<a href="#l1.618"></a><span id="l1.618">   _showStatusTitle: function(success, msgName)</span>
<a href="#l1.619"></a><span id="l1.619">   {</span>
<a href="#l1.620"></a><span id="l1.620">     let msg;</span>
<a href="#l1.621"></a><span id="l1.621">     try {</span>
<a href="#l1.622"></a><span id="l1.622">       msg = msgName ? gStringsBundle.getString(msgName) : &quot;&quot;;</span>
<a href="#l1.623"></a><span id="l1.623">     } catch(ex) {</span>
<a href="#l1.624"></a><span id="l1.624">       gEmailWizardLogger.error(&quot;missing string for &quot; + msgName);</span>
<a href="#l1.625"></a><span id="l1.625">     }</span>
<a href="#l1.626"></a><span id="l1.626"> </span>
<a href="#l1.627"></a><span id="l1.627">     this._hideSpinner(success);</span>
<a href="#l1.628"></a><span id="l1.628" class="difflineminus">-    let title = getElementById(&quot;config_status_title&quot;);</span>
<a href="#l1.629"></a><span id="l1.629" class="difflineplus">+    let title = document.getElementById(&quot;config_status_title&quot;);</span>
<a href="#l1.630"></a><span id="l1.630">     title.hidden = false;</span>
<a href="#l1.631"></a><span id="l1.631">     title.textContent = msg;</span>
<a href="#l1.632"></a><span id="l1.632">     gEmailWizardLogger.info(&quot;show status title &quot; + (success ? &quot;success&quot; : &quot;failure&quot;) +</span>
<a href="#l1.633"></a><span id="l1.633">                             &quot;, msg: &quot; + msg);</span>
<a href="#l1.634"></a><span id="l1.634">   },</span>
<a href="#l1.635"></a><span id="l1.635"> </span>
<a href="#l1.636"></a><span id="l1.636">   _showStatus: function(msgName)</span>
<a href="#l1.637"></a><span id="l1.637">   {</span>
<a href="#l1.638"></a><span id="l1.638">     let msg;</span>
<a href="#l1.639"></a><span id="l1.639">     try {</span>
<a href="#l1.640"></a><span id="l1.640">       msg = msgName ? gStringsBundle.getString(msgName) : &quot;&quot;;</span>
<a href="#l1.641"></a><span id="l1.641">     } catch(ex) {</span>
<a href="#l1.642"></a><span id="l1.642">       gEmailWizardLogger.error(&quot;missing string for &quot; + msgName);</span>
<a href="#l1.643"></a><span id="l1.643">     }</span>
<a href="#l1.644"></a><span id="l1.644"> </span>
<a href="#l1.645"></a><span id="l1.645" class="difflineminus">-    let subtitle = getElementById(&quot;config_status_subtitle&quot;);</span>
<a href="#l1.646"></a><span id="l1.646" class="difflineplus">+    let subtitle = document.getElementById(&quot;config_status_subtitle&quot;);</span>
<a href="#l1.647"></a><span id="l1.647">     subtitle.hidden = false;</span>
<a href="#l1.648"></a><span id="l1.648">     subtitle.textContent = msg;</span>
<a href="#l1.649"></a><span id="l1.649">     gEmailWizardLogger.info(&quot;show status subtitle: &quot; + msg);</span>
<a href="#l1.650"></a><span id="l1.650">   },</span>
<a href="#l1.651"></a><span id="l1.651"> </span>
<a href="#l1.652"></a><span id="l1.652">   _prefillConfig: function(initialConfig)</span>
<a href="#l1.653"></a><span id="l1.653">   {</span>
<a href="#l1.654"></a><span id="l1.654">     var emailsplit = this._email.split(&quot;@&quot;);</span>
<a href="#l1.655"></a><span id="l1.655" class="difflineat">@@ -1318,41 +1312,42 @@ EmailConfigWizard.prototype =</span>
<a href="#l1.656"></a><span id="l1.656">     else</span>
<a href="#l1.657"></a><span id="l1.657">     {</span>
<a href="#l1.658"></a><span id="l1.658">       this._guessConfig(config.outgoing.hostname, config, &quot;outgoing&quot;);</span>
<a href="#l1.659"></a><span id="l1.659">     }</span>
<a href="#l1.660"></a><span id="l1.660">   },</span>
<a href="#l1.661"></a><span id="l1.661"> </span>
<a href="#l1.662"></a><span id="l1.662">   clearError: function(which) {</span>
<a href="#l1.663"></a><span id="l1.663">     _hide(which);</span>
<a href="#l1.664"></a><span id="l1.664" class="difflineminus">-    getElementById(which).textContent = &quot;&quot;;</span>
<a href="#l1.665"></a><span id="l1.665" class="difflineplus">+    document.getElementById(which).textContent = &quot;&quot;;</span>
<a href="#l1.666"></a><span id="l1.666">   },</span>
<a href="#l1.667"></a><span id="l1.667"> </span>
<a href="#l1.668"></a><span id="l1.668">   setError: function(which, msg_name) {</span>
<a href="#l1.669"></a><span id="l1.669">     try {</span>
<a href="#l1.670"></a><span id="l1.670">       _show(which);</span>
<a href="#l1.671"></a><span id="l1.671" class="difflineminus">-      getElementById(which).textContent = gStringsBundle.getString(msg_name);</span>
<a href="#l1.672"></a><span id="l1.672" class="difflineplus">+      document.getElementById(which).textContent =</span>
<a href="#l1.673"></a><span id="l1.673" class="difflineplus">+        gStringsBundle.getString(msg_name);</span>
<a href="#l1.674"></a><span id="l1.674">     }</span>
<a href="#l1.675"></a><span id="l1.675">     catch(ex) {</span>
<a href="#l1.676"></a><span id="l1.676">       alertPrompt(&quot;missing error string&quot;, msg_name);</span>
<a href="#l1.677"></a><span id="l1.677">     }</span>
<a href="#l1.678"></a><span id="l1.678">   },</span>
<a href="#l1.679"></a><span id="l1.679"> </span>
<a href="#l1.680"></a><span id="l1.680">   onKeyDown : function(event)</span>
<a href="#l1.681"></a><span id="l1.681">   {</span>
<a href="#l1.682"></a><span id="l1.682">     let key = event.keyCode;</span>
<a href="#l1.683"></a><span id="l1.683">     if (key == 27) {</span>
<a href="#l1.684"></a><span id="l1.684">       this.onCancel();</span>
<a href="#l1.685"></a><span id="l1.685">       return true;</span>
<a href="#l1.686"></a><span id="l1.686">     }</span>
<a href="#l1.687"></a><span id="l1.687" class="difflineminus">-    if (key == 13 &amp;&amp; !getElementById('create_button').hidden) {</span>
<a href="#l1.688"></a><span id="l1.688" class="difflineplus">+    if (key == 13 &amp;&amp; !document.getElementById('create_button').hidden) {</span>
<a href="#l1.689"></a><span id="l1.689">       this.onOK();</span>
<a href="#l1.690"></a><span id="l1.690">       return true;</span>
<a href="#l1.691"></a><span id="l1.691">     }</span>
<a href="#l1.692"></a><span id="l1.692" class="difflineminus">-    if (key == 13 &amp;&amp; !getElementById('next_button').hidden) {</span>
<a href="#l1.693"></a><span id="l1.693" class="difflineplus">+    if (key == 13 &amp;&amp; !document.getElementById('next_button').hidden) {</span>
<a href="#l1.694"></a><span id="l1.694">       this.onNext();</span>
<a href="#l1.695"></a><span id="l1.695">       return true;</span>
<a href="#l1.696"></a><span id="l1.696">     }</span>
<a href="#l1.697"></a><span id="l1.697">     return false;</span>
<a href="#l1.698"></a><span id="l1.698">   },</span>
<a href="#l1.699"></a><span id="l1.699"> </span>
<a href="#l1.700"></a><span id="l1.700">   onWizardShutdown: function EmailConfigWizard_onWizardshutdown() {</span>
<a href="#l1.701"></a><span id="l1.701">     if (this._probeAbortable)</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

