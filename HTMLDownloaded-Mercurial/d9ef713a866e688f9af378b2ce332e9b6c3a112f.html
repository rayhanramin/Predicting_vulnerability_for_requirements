<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 16831:d9ef713a866e688f9af378b2ce332e9b6c3a112f</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ d9ef713a866e688f9af378b2ce332e9b6c3a112f" />
<meta property="og:url" content="/comm-central/rev/d9ef713a866e688f9af378b2ce332e9b6c3a112f" />
<meta property="og:description" content="Bug 1074034, part 3: Use mozilla-central's baseconfig.mk instead of forking it, r=Standard8. a=jcranmer" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / d9ef713a866e688f9af378b2ce332e9b6c3a112f 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/d9ef713a866e688f9af378b2ce332e9b6c3a112f">shortlog</a> |
<a href="/comm-central/log/d9ef713a866e688f9af378b2ce332e9b6c3a112f">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/d9ef713a866e688f9af378b2ce332e9b6c3a112f">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/d9ef713a866e688f9af378b2ce332e9b6c3a112f">files</a> |
changeset |
<a href="/comm-central/raw-rev/d9ef713a866e688f9af378b2ce332e9b6c3a112f">raw</a>  | <a href="/comm-central/archive/d9ef713a866e688f9af378b2ce332e9b6c3a112f.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1074034">Bug 1074034</a>, part 3: Use mozilla-central's baseconfig.mk instead of forking it, r=Standard8. a=jcranmer
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#74;&#111;&#115;&#104;&#117;&#97;&#32;&#67;&#114;&#97;&#110;&#109;&#101;&#114;&#32;&#60;&#80;&#105;&#100;&#103;&#101;&#111;&#116;&#49;&#56;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Mon, 29 Sep 2014 18:20:08 -0500</td></tr>

<tr>
 <td>changeset 16831</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/d9ef713a866e688f9af378b2ce332e9b6c3a112f">d9ef713a866e688f9af378b2ce332e9b6c3a112f</a></td>
</tr>



<tr>
<td>parent 16830</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/2bc3fa56968298764f14f05b0779ebd43a14b66c">2bc3fa56968298764f14f05b0779ebd43a14b66c</a>
</td>
</tr>

<tr>
<td>child 16832</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/3a8e98f52f91fa3708ba1793bbb251f813fa120f">3a8e98f52f91fa3708ba1793bbb251f813fa120f</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=d9ef713a866e688f9af378b2ce332e9b6c3a112f">10471</a></td></tr>
<tr><td>push user</td><td>Pidgeot18@gmail.com</td></tr>
<tr><td>push date</td><td class="date age">Tue, 30 Sep 2014 01:17:31 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@d9ef713a866e [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=d9ef713a866e688f9af378b2ce332e9b6c3a112f">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=d9ef713a866e688f9af378b2ce332e9b6c3a112f&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=d9ef713a866e688f9af378b2ce332e9b6c3a112f&newProject=comm-central&newRevision=fa89bf616d7ef7cf02ecba846fa3edac84ec49fc&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=d9ef713a866e688f9af378b2ce332e9b6c3a112f&newProject=comm-central&newRevision=fa89bf616d7ef7cf02ecba846fa3edac84ec49fc&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=d9ef713a866e688f9af378b2ce332e9b6c3a112f&newProject=comm-central&newRevision=fa89bf616d7ef7cf02ecba846fa3edac84ec49fc&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28Standard8%29&revcount=50">Standard8</a>, <a href="/comm-central/log?rev=reviewer%28jcranmer%29&revcount=50">jcranmer</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1074034">1074034</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1074034">Bug 1074034</a>, part 3: Use mozilla-central's baseconfig.mk instead of forking it, r=Standard8. a=jcranmer

A small complication arises in that we need to maintain distinct topsrcdir
variables, so we can't just delete this file. But we can make it as small as
possible.

Note that we don't include the mozilla-central version if INCLUDED_AUTOCONF_MK
is not defined, since topsrcdir (and hence MOZILLA_SRCDIR) is undefined.

Pushing to a CLOSED TREE because this is important to get to developers, since
it makes incremental builds work again!</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d9ef713a866e688f9af378b2ce332e9b6c3a112f/config/baseconfig.mk">config/baseconfig.mk</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d9ef713a866e688f9af378b2ce332e9b6c3a112f/config/baseconfig.mk">file</a> |
<a href="/comm-central/annotate/d9ef713a866e688f9af378b2ce332e9b6c3a112f/config/baseconfig.mk">annotate</a> |
<a href="/comm-central/diff/d9ef713a866e688f9af378b2ce332e9b6c3a112f/config/baseconfig.mk">diff</a> |
<a href="/comm-central/comparison/d9ef713a866e688f9af378b2ce332e9b6c3a112f/config/baseconfig.mk">comparison</a> |
<a href="/comm-central/log/d9ef713a866e688f9af378b2ce332e9b6c3a112f/config/baseconfig.mk">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/config/baseconfig.mk</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/config/baseconfig.mk</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -1,42 +1,16 @@</span>
<a href="#l1.4"></a><span id="l1.4"> # This file is normally included by autoconf.mk, but it is also used</span>
<a href="#l1.5"></a><span id="l1.5"> # directly in python/mozbuild/mozbuild/base.py for gmake validation.</span>
<a href="#l1.6"></a><span id="l1.6"> # We thus use INCLUDED_AUTOCONF_MK to enable/disable some parts depending</span>
<a href="#l1.7"></a><span id="l1.7"> # whether a normal build is happening or whether the check is running.</span>
<a href="#l1.8"></a><span id="l1.8" class="difflineminus">-includedir := $(includedir)/$(MOZ_APP_NAME)-$(MOZ_APP_VERSION)</span>
<a href="#l1.9"></a><span id="l1.9" class="difflineminus">-idldir = $(datadir)/idl/$(MOZ_APP_NAME)-$(MOZ_APP_VERSION)</span>
<a href="#l1.10"></a><span id="l1.10" class="difflineminus">-installdir = $(libdir)/$(MOZ_APP_NAME)-$(MOZ_APP_VERSION)</span>
<a href="#l1.11"></a><span id="l1.11" class="difflineminus">-sdkdir = $(libdir)/$(MOZ_APP_NAME)-devel-$(MOZ_APP_VERSION)</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+</span>
<a href="#l1.13"></a><span id="l1.13"> MOZILLA_SRCDIR = $(topsrcdir)/mozilla</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineminus">-DIST = $(DEPTH)/dist</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineminus">-</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineminus">-# We do magic with OBJ_SUFFIX in config.mk, the following ensures we don't</span>
<a href="#l1.17"></a><span id="l1.17" class="difflineminus">-# manually use it before config.mk inclusion</span>
<a href="#l1.18"></a><span id="l1.18" class="difflineminus">-_OBJ_SUFFIX := $(OBJ_SUFFIX)</span>
<a href="#l1.19"></a><span id="l1.19" class="difflineminus">-OBJ_SUFFIX = $(error config/config.mk needs to be included before using OBJ_SUFFIX)</span>
<a href="#l1.20"></a><span id="l1.20" class="difflineminus">-</span>
<a href="#l1.21"></a><span id="l1.21" class="difflineminus">-ifeq ($(HOST_OS_ARCH),WINNT)</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineminus">-# We only support building with a non-msys gnu make version</span>
<a href="#l1.23"></a><span id="l1.23" class="difflineminus">-# strictly above 4.0.</span>
<a href="#l1.24"></a><span id="l1.24" class="difflineminus">-ifdef .PYMAKE</span>
<a href="#l1.25"></a><span id="l1.25" class="difflineminus">-$(error Pymake is no longer supported. Please upgrade to MozillaBuild 1.9 or newer and build with 'mach' or 'mozmake')</span>
<a href="#l1.26"></a><span id="l1.26" class="difflineminus">-endif</span>
<a href="#l1.27"></a><span id="l1.27" class="difflineminus">-</span>
<a href="#l1.28"></a><span id="l1.28" class="difflineminus">-ifeq (,$(filter mozmake%,$(notdir $(MAKE))))</span>
<a href="#l1.29"></a><span id="l1.29" class="difflineminus">-$(error Only building with pymake or mozmake is supported.)</span>
<a href="#l1.30"></a><span id="l1.30" class="difflineminus">-endif</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineminus">-</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineminus">-ifdef INCLUDED_AUTOCONF_MK</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineminus">-ifeq (a,$(firstword a$(subst /, ,$(srcdir))))</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineminus">-$(error MSYS-style srcdir are not supported for Windows builds.)</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineminus">-endif</span>
<a href="#l1.36"></a><span id="l1.36" class="difflineminus">-endif</span>
<a href="#l1.37"></a><span id="l1.37" class="difflineminus">-endif # WINNT</span>
<a href="#l1.38"></a><span id="l1.38" class="difflineminus">-</span>
<a href="#l1.39"></a><span id="l1.39"> ifndef INCLUDED_AUTOCONF_MK</span>
<a href="#l1.40"></a><span id="l1.40"> default::</span>
<a href="#l1.41"></a><span id="l1.41" class="difflineplus">+else</span>
<a href="#l1.42"></a><span id="l1.42" class="difflineplus">+include $(MOZILLA_SRCDIR)/config/baseconfig.mk</span>
<a href="#l1.43"></a><span id="l1.43"> endif</span>
<a href="#l1.44"></a><span id="l1.44"> </span>
<a href="#l1.45"></a><span id="l1.45"> # WIN_TOP_SRC is converted by config.mk to mozilla-central, but this needs to be comm-central.</span>
<a href="#l1.46"></a><span id="l1.46"> ifdef WIN_TOP_SRC</span>
<a href="#l1.47"></a><span id="l1.47"> WIN_TOP_SRC := $(patsubst %/mozilla,%,$(WIN_TOP_SRC))</span>
<a href="#l1.48"></a><span id="l1.48"> endif</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

