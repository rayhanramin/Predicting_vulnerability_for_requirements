<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 24937:5333ee90a410dedf329fe207fff3b6af98f370d2</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 5333ee90a410dedf329fe207fff3b6af98f370d2" />
<meta property="og:url" content="/comm-central/rev/5333ee90a410dedf329fe207fff3b6af98f370d2" />
<meta property="og:description" content="Bug 1498041 - Part 0: Give modules in mail/base/modules proper names. r=jorgk" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 5333ee90a410dedf329fe207fff3b6af98f370d2 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/5333ee90a410dedf329fe207fff3b6af98f370d2">shortlog</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/5333ee90a410dedf329fe207fff3b6af98f370d2">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2">files</a> |
changeset |
<a href="/comm-central/raw-rev/5333ee90a410dedf329fe207fff3b6af98f370d2">raw</a>  | <a href="/comm-central/archive/5333ee90a410dedf329fe207fff3b6af98f370d2.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1498041">Bug 1498041</a> - Part 0: Give modules in mail/base/modules proper names. r=jorgk
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#71;&#101;&#111;&#102;&#102;&#32;&#76;&#97;&#110;&#107;&#111;&#119;&#32;&#60;&#103;&#101;&#111;&#102;&#102;&#64;&#100;&#97;&#114;&#107;&#116;&#114;&#111;&#106;&#97;&#110;&#46;&#110;&#101;&#116;&#62;</td></tr>
<tr><td></td><td class="date age">Thu, 11 Oct 2018 11:16:53 +1300</td></tr>

<tr>
 <td>changeset 24937</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/5333ee90a410dedf329fe207fff3b6af98f370d2">5333ee90a410dedf329fe207fff3b6af98f370d2</a></td>
</tr>



<tr>
<td>parent 24936</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/7f3ce4f1b0a119e9428bbda4391765f009396368">7f3ce4f1b0a119e9428bbda4391765f009396368</a>
</td>
</tr>

<tr>
<td>child 24938</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/e4fff573e9c7593cfeec20903728590d37443c7b">e4fff573e9c7593cfeec20903728590d37443c7b</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=5333ee90a410dedf329fe207fff3b6af98f370d2">14997</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Thu, 11 Oct 2018 22:04:11 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@056b4d7d3d6b [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=056b4d7d3d6b1e2689c028805757b637bf8f0bb3">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=056b4d7d3d6b1e2689c028805757b637bf8f0bb3&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=056b4d7d3d6b1e2689c028805757b637bf8f0bb3&newProject=comm-central&newRevision=5333ee90a410dedf329fe207fff3b6af98f370d2&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=056b4d7d3d6b1e2689c028805757b637bf8f0bb3&newProject=comm-central&newRevision=5333ee90a410dedf329fe207fff3b6af98f370d2&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=056b4d7d3d6b1e2689c028805757b637bf8f0bb3&newProject=comm-central&newRevision=5333ee90a410dedf329fe207fff3b6af98f370d2&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28jorgk%29&revcount=50">jorgk</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1498041">1498041</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1498041">Bug 1498041</a> - Part 0: Give modules in mail/base/modules proper names. r=jorgk</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/app/profile/all-thunderbird.js">mail/app/profile/all-thunderbird.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/app/profile/all-thunderbird.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/app/profile/all-thunderbird.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/app/profile/all-thunderbird.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/app/profile/all-thunderbird.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/app/profile/all-thunderbird.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/SearchDialog.js">mail/base/content/SearchDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/SearchDialog.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/SearchDialog.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/SearchDialog.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/SearchDialog.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/SearchDialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/folderDisplay.js">mail/base/content/folderDisplay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/folderDisplay.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/folderDisplay.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/folderDisplay.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/folderDisplay.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/folderDisplay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/folderPane.js">mail/base/content/folderPane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/folderPane.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/folderPane.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/folderPane.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/folderPane.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/folderPane.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mail3PaneWindowCommands.js">mail/base/content/mail3PaneWindowCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mail3PaneWindowCommands.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mail3PaneWindowCommands.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mail3PaneWindowCommands.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mail3PaneWindowCommands.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mail3PaneWindowCommands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailCommands.js">mail/base/content/mailCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailCommands.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailCommands.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailCommands.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailCommands.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailCommands.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailTabs.js">mail/base/content/mailTabs.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailTabs.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailTabs.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailTabs.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailTabs.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailTabs.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWidgets.xml">mail/base/content/mailWidgets.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWidgets.xml">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWidgets.xml">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWidgets.xml">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWidgets.xml">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWidgets.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWindow.js">mail/base/content/mailWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWindow.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWindow.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWindow.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWindow.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWindow.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWindowOverlay.js">mail/base/content/mailWindowOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWindowOverlay.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWindowOverlay.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWindowOverlay.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWindowOverlay.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/mailWindowOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/messageWindow.js">mail/base/content/messageWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/messageWindow.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/messageWindow.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/messageWindow.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/messageWindow.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/messageWindow.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/msgHdrView.js">mail/base/content/msgHdrView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/msgHdrView.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/msgHdrView.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/msgHdrView.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/msgHdrView.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/msgHdrView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/msgMail3PaneWindow.js">mail/base/content/msgMail3PaneWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/msgMail3PaneWindow.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/msgMail3PaneWindow.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/msgMail3PaneWindow.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/msgMail3PaneWindow.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/msgMail3PaneWindow.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/multimessageview.js">mail/base/content/multimessageview.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/multimessageview.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/multimessageview.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/multimessageview.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/multimessageview.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/multimessageview.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/nsContextMenu.js">mail/base/content/nsContextMenu.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/nsContextMenu.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/nsContextMenu.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/nsContextMenu.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/nsContextMenu.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/nsContextMenu.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/quickFilterBar.js">mail/base/content/quickFilterBar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/quickFilterBar.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/quickFilterBar.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/quickFilterBar.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/quickFilterBar.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/content/quickFilterBar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/AttachmentChecker.jsm">mail/base/modules/AttachmentChecker.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/AttachmentChecker.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/AttachmentChecker.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/AttachmentChecker.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/AttachmentChecker.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/AttachmentChecker.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/DBViewWrapper.jsm">mail/base/modules/DBViewWrapper.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/DBViewWrapper.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/DBViewWrapper.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/DBViewWrapper.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/DBViewWrapper.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/DBViewWrapper.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/DisplayNameUtils.jsm">mail/base/modules/DisplayNameUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/DisplayNameUtils.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/DisplayNameUtils.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/DisplayNameUtils.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/DisplayNameUtils.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/DisplayNameUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailConsts.js">mail/base/modules/MailConsts.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailConsts.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailConsts.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailConsts.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailConsts.jsm">mail/base/modules/MailConsts.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailConsts.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailConsts.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailConsts.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailConsts.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailConsts.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailInstrumentation.jsm">mail/base/modules/MailInstrumentation.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailInstrumentation.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailInstrumentation.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailInstrumentation.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailInstrumentation.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailInstrumentation.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailMigrator.jsm">mail/base/modules/MailMigrator.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailMigrator.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailMigrator.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailMigrator.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailMigrator.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailMigrator.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailUtils.js">mail/base/modules/MailUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailUtils.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailUtils.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailUtils.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailUtils.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailUtils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailUtils.jsm">mail/base/modules/MailUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailUtils.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailUtils.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailUtils.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailUtils.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailViewManager.jsm">mail/base/modules/MailViewManager.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailViewManager.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailViewManager.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailViewManager.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailViewManager.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MailViewManager.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MsgHdrSyntheticView.js">mail/base/modules/MsgHdrSyntheticView.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MsgHdrSyntheticView.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MsgHdrSyntheticView.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MsgHdrSyntheticView.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MsgHdrSyntheticView.jsm">mail/base/modules/MsgHdrSyntheticView.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MsgHdrSyntheticView.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MsgHdrSyntheticView.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MsgHdrSyntheticView.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MsgHdrSyntheticView.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/MsgHdrSyntheticView.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/QuickFilterManager.jsm">mail/base/modules/QuickFilterManager.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/QuickFilterManager.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/QuickFilterManager.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/QuickFilterManager.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/QuickFilterManager.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/QuickFilterManager.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SearchSpec.jsm">mail/base/modules/SearchSpec.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SearchSpec.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SearchSpec.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SearchSpec.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SearchSpec.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SearchSpec.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SessionStoreManager.jsm">mail/base/modules/SessionStoreManager.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SessionStoreManager.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SessionStoreManager.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SessionStoreManager.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SessionStoreManager.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SessionStoreManager.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SummaryFrameManager.jsm">mail/base/modules/SummaryFrameManager.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SummaryFrameManager.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SummaryFrameManager.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SummaryFrameManager.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SummaryFrameManager.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/SummaryFrameManager.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/TBDistCustomizer.jsm">mail/base/modules/TBDistCustomizer.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/TBDistCustomizer.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/TBDistCustomizer.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/TBDistCustomizer.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/TBDistCustomizer.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/TBDistCustomizer.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/attachmentChecker.js">mail/base/modules/attachmentChecker.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/attachmentChecker.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/attachmentChecker.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/attachmentChecker.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/dbViewWrapper.js">mail/base/modules/dbViewWrapper.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/dbViewWrapper.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/dbViewWrapper.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/dbViewWrapper.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/displayNameUtils.js">mail/base/modules/displayNameUtils.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/displayNameUtils.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/displayNameUtils.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/displayNameUtils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/distribution.js">mail/base/modules/distribution.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/distribution.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/distribution.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/distribution.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/mailInstrumentation.js">mail/base/modules/mailInstrumentation.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/mailInstrumentation.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/mailInstrumentation.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/mailInstrumentation.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/mailMigrator.js">mail/base/modules/mailMigrator.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/mailMigrator.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/mailMigrator.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/mailMigrator.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/mailViewManager.js">mail/base/modules/mailViewManager.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/mailViewManager.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/mailViewManager.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/mailViewManager.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/moz.build">mail/base/modules/moz.build</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/moz.build">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/moz.build">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/moz.build">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/moz.build">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/moz.build">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/oauth.jsm">mail/base/modules/oauth.jsm</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/oauth.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/oauth.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/oauth.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/quickFilterManager.js">mail/base/modules/quickFilterManager.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/quickFilterManager.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/quickFilterManager.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/quickFilterManager.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/searchSpec.js">mail/base/modules/searchSpec.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/searchSpec.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/searchSpec.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/searchSpec.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/sessionStoreManager.js">mail/base/modules/sessionStoreManager.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/sessionStoreManager.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/sessionStoreManager.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/sessionStoreManager.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/summaryFrameManager.js">mail/base/modules/summaryFrameManager.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/summaryFrameManager.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/summaryFrameManager.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/modules/summaryFrameManager.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/resources/viewWrapperTestUtils.js">mail/base/test/unit/resources/viewWrapperTestUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/resources/viewWrapperTestUtils.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/resources/viewWrapperTestUtils.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/resources/viewWrapperTestUtils.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/resources/viewWrapperTestUtils.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/resources/viewWrapperTestUtils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_attachmentChecker.js">mail/base/test/unit/test_attachmentChecker.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_attachmentChecker.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_attachmentChecker.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_attachmentChecker.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_attachmentChecker.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_attachmentChecker.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_mailGlue_distribution.js">mail/base/test/unit/test_mailGlue_distribution.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_mailGlue_distribution.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_mailGlue_distribution.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_mailGlue_distribution.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_mailGlue_distribution.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_mailGlue_distribution.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_windows_font_migration.js">mail/base/test/unit/test_windows_font_migration.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_windows_font_migration.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_windows_font_migration.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_windows_font_migration.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_windows_font_migration.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/base/test/unit/test_windows_font_migration.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/compose/content/MsgComposeCommands.js">mail/components/compose/content/MsgComposeCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/compose/content/MsgComposeCommands.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/compose/content/MsgComposeCommands.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/compose/content/MsgComposeCommands.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/compose/content/MsgComposeCommands.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/compose/content/MsgComposeCommands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/mailGlue.js">mail/components/mailGlue.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/mailGlue.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/mailGlue.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/mailGlue.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/mailGlue.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/mailGlue.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/nsMailDefaultHandler.js">mail/components/nsMailDefaultHandler.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/nsMailDefaultHandler.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/nsMailDefaultHandler.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/nsMailDefaultHandler.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/nsMailDefaultHandler.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/nsMailDefaultHandler.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/search/content/SpotlightIntegration.js">mail/components/search/content/SpotlightIntegration.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/search/content/SpotlightIntegration.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/search/content/SpotlightIntegration.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/search/content/SpotlightIntegration.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/search/content/SpotlightIntegration.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/search/content/SpotlightIntegration.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/search/content/WinSearchIntegration.js">mail/components/search/content/WinSearchIntegration.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/search/content/WinSearchIntegration.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/search/content/WinSearchIntegration.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/search/content/WinSearchIntegration.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/search/content/WinSearchIntegration.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/components/search/content/WinSearchIntegration.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/extensions/mailviews/content/msgViewPickerOverlay.js">mail/extensions/mailviews/content/msgViewPickerOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/extensions/mailviews/content/msgViewPickerOverlay.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/extensions/mailviews/content/msgViewPickerOverlay.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/extensions/mailviews/content/msgViewPickerOverlay.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/extensions/mailviews/content/msgViewPickerOverlay.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/extensions/mailviews/content/msgViewPickerOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-columns.js">mail/test/mozmill/folder-display/test-columns.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-columns.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-columns.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-columns.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-columns.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-columns.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-mail-views.js">mail/test/mozmill/folder-display/test-mail-views.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-mail-views.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-mail-views.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-mail-views.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-mail-views.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-mail-views.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-message-commands.js">mail/test/mozmill/folder-display/test-message-commands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-message-commands.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-message-commands.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-message-commands.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-message-commands.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-message-commands.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js">mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-recent-menu.js">mail/test/mozmill/folder-display/test-recent-menu.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-recent-menu.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-recent-menu.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-recent-menu.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-recent-menu.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/folder-display/test-recent-menu.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/instrumentation/test-instrument-setup.js">mail/test/mozmill/instrumentation/test-instrument-setup.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/instrumentation/test-instrument-setup.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/instrumentation/test-instrument-setup.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/instrumentation/test-instrument-setup.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/instrumentation/test-instrument-setup.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/instrumentation/test-instrument-setup.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/session-store/test-session-store.js">mail/test/mozmill/session-store/test-session-store.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/session-store/test-session-store.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/session-store/test-session-store.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/session-store/test-session-store.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/session-store/test-session-store.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/session-store/test-session-store.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">mail/test/mozmill/shared-modules/test-folder-display-helpers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mail/test/mozmill/shared-modules/test-folder-display-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/folderWidgets.xml">mailnews/base/content/folderWidgets.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/folderWidgets.xml">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/folderWidgets.xml">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/folderWidgets.xml">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/folderWidgets.xml">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/folderWidgets.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/junkCommands.js">mailnews/base/content/junkCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/junkCommands.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/junkCommands.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/junkCommands.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/junkCommands.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/junkCommands.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/msgFolderPickerOverlay.js">mailnews/base/content/msgFolderPickerOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/msgFolderPickerOverlay.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/msgFolderPickerOverlay.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/msgFolderPickerOverlay.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/msgFolderPickerOverlay.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/msgFolderPickerOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/subscribe.js">mailnews/base/content/subscribe.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/subscribe.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/subscribe.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/subscribe.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/subscribe.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/subscribe.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/virtualFolderProperties.js">mailnews/base/content/virtualFolderProperties.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/virtualFolderProperties.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/virtualFolderProperties.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/virtualFolderProperties.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/virtualFolderProperties.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/content/virtualFolderProperties.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-copies.js">mailnews/base/prefs/content/am-copies.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-copies.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-copies.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-copies.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-copies.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-copies.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-junk.js">mailnews/base/prefs/content/am-junk.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-junk.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-junk.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-junk.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-junk.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-junk.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-server.js">mailnews/base/prefs/content/am-server.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-server.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-server.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-server.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-server.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/am-server.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/amUtils.js">mailnews/base/prefs/content/amUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/amUtils.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/amUtils.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/amUtils.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/amUtils.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/amUtils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/converterDialog.js">mailnews/base/prefs/content/converterDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/converterDialog.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/converterDialog.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/converterDialog.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/converterDialog.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/prefs/content/converterDialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/search/content/FilterEditor.js">mailnews/base/search/content/FilterEditor.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/search/content/FilterEditor.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/search/content/FilterEditor.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/search/content/FilterEditor.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/search/content/FilterEditor.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/search/content/FilterEditor.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/search/content/searchWidgets.xml">mailnews/base/search/content/searchWidgets.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/search/content/searchWidgets.xml">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/search/content/searchWidgets.xml">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/search/content/searchWidgets.xml">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/search/content/searchWidgets.xml">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/search/content/searchWidgets.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMailNewsCommandLineHandler.js">mailnews/base/src/nsMailNewsCommandLineHandler.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMailNewsCommandLineHandler.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMailNewsCommandLineHandler.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMailNewsCommandLineHandler.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMailNewsCommandLineHandler.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMailNewsCommandLineHandler.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMsgSearchDBView.cpp">mailnews/base/src/nsMsgSearchDBView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMsgSearchDBView.cpp">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMsgSearchDBView.cpp">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMsgSearchDBView.cpp">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMsgSearchDBView.cpp">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMsgSearchDBView.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMsgXFVirtualFolderDBView.cpp">mailnews/base/src/nsMsgXFVirtualFolderDBView.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMsgXFVirtualFolderDBView.cpp">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMsgXFVirtualFolderDBView.cpp">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMsgXFVirtualFolderDBView.cpp">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMsgXFVirtualFolderDBView.cpp">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/src/nsMsgXFVirtualFolderDBView.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/util/mailstoreConverter.jsm">mailnews/base/util/mailstoreConverter.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/util/mailstoreConverter.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/util/mailstoreConverter.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/util/mailstoreConverter.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/util/mailstoreConverter.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/base/util/mailstoreConverter.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/db/gloda/modules/index_msg.js">mailnews/db/gloda/modules/index_msg.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/db/gloda/modules/index_msg.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/db/gloda/modules/index_msg.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/db/gloda/modules/index_msg.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/db/gloda/modules/index_msg.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/db/gloda/modules/index_msg.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/db/gloda/test/unit/base_index_messages.js">mailnews/db/gloda/test/unit/base_index_messages.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/db/gloda/test/unit/base_index_messages.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/db/gloda/test/unit/base_index_messages.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/db/gloda/test/unit/base_index_messages.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/db/gloda/test/unit/base_index_messages.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/db/gloda/test/unit/base_index_messages.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/extensions/newsblog/content/FeedUtils.jsm">mailnews/extensions/newsblog/content/FeedUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/extensions/newsblog/content/FeedUtils.jsm">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/extensions/newsblog/content/FeedUtils.jsm">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/extensions/newsblog/content/FeedUtils.jsm">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/extensions/newsblog/content/FeedUtils.jsm">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/extensions/newsblog/content/FeedUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/imap/test/unit/test_saveTemplate.js">mailnews/imap/test/unit/test_saveTemplate.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/imap/test/unit/test_saveTemplate.js">file</a> |
<a href="/comm-central/annotate/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/imap/test/unit/test_saveTemplate.js">annotate</a> |
<a href="/comm-central/diff/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/imap/test/unit/test_saveTemplate.js">diff</a> |
<a href="/comm-central/comparison/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/imap/test/unit/test_saveTemplate.js">comparison</a> |
<a href="/comm-central/log/5333ee90a410dedf329fe207fff3b6af98f370d2/mailnews/imap/test/unit/test_saveTemplate.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/app/profile/all-thunderbird.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/app/profile/all-thunderbird.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -597,17 +597,17 @@ pref(&quot;font.name.sans-serif.el&quot;, &quot;Lucida </span>
<a href="#l1.4"></a><span id="l1.4"> pref(&quot;font.name.monospace.el&quot;, &quot;Menlo&quot;);</span>
<a href="#l1.5"></a><span id="l1.5"> pref(&quot;font.name-list.sans-serif.el&quot;, &quot;Lucida Grande&quot;);</span>
<a href="#l1.6"></a><span id="l1.6"> pref(&quot;font.name-list.monospace.el&quot;, &quot;Menlo, Monaco&quot;);</span>
<a href="#l1.7"></a><span id="l1.7"> pref(&quot;font.size.variable.el&quot;, 15);</span>
<a href="#l1.8"></a><span id="l1.8"> pref(&quot;font.size.fixed.el&quot;, 12);</span>
<a href="#l1.9"></a><span id="l1.9"> #endif</span>
<a href="#l1.10"></a><span id="l1.10"> </span>
<a href="#l1.11"></a><span id="l1.11"> // Since different versions of Windows need different settings, we'll handle</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-// this in mailMigrator.js.</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+// this in MailMigrator.jsm.</span>
<a href="#l1.14"></a><span id="l1.14"> </span>
<a href="#l1.15"></a><span id="l1.15"> // Linux, in other words.  Other OSes may wish to override.</span>
<a href="#l1.16"></a><span id="l1.16"> #ifdef UNIX_BUT_NOT_MAC</span>
<a href="#l1.17"></a><span id="l1.17"> // The font.name-list fallback is defined in case font.name isn't</span>
<a href="#l1.18"></a><span id="l1.18"> // present -- e.g. in case a profile that's been used on Windows Vista or above</span>
<a href="#l1.19"></a><span id="l1.19"> // is used on Linux.</span>
<a href="#l1.20"></a><span id="l1.20"> pref(&quot;font.name-list.serif.x-unicode&quot;, &quot;serif&quot;);</span>
<a href="#l1.21"></a><span id="l1.21"> pref(&quot;font.name-list.sans-serif.x-unicode&quot;, &quot;sans-serif&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/SearchDialog.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/SearchDialog.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1,13 +1,13 @@</span>
<a href="#l2.4"></a><span id="l2.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l2.5"></a><span id="l2.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l2.6"></a><span id="l2.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l2.7"></a><span id="l2.7"> </span>
<a href="#l2.8"></a><span id="l2.8" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l2.9"></a><span id="l2.9" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l2.10"></a><span id="l2.10"> ChromeUtils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l2.11"></a><span id="l2.11"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l2.12"></a><span id="l2.12"> </span>
<a href="#l2.13"></a><span id="l2.13"> var gCurrentFolder;</span>
<a href="#l2.14"></a><span id="l2.14"> </span>
<a href="#l2.15"></a><span id="l2.15"> var gFolderDisplay;</span>
<a href="#l2.16"></a><span id="l2.16"> // Although we don't display messages, we have a message display object to</span>
<a href="#l2.17"></a><span id="l2.17"> //  simplify our code.  It's just always disabled.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/base/content/folderDisplay.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/base/content/folderDisplay.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1,15 +1,15 @@</span>
<a href="#l3.4"></a><span id="l3.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l3.5"></a><span id="l3.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l3.6"></a><span id="l3.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/dbViewWrapper.js&quot;);</span>
<a href="#l3.9"></a><span id="l3.9" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/DBViewWrapper.jsm&quot;);</span>
<a href="#l3.10"></a><span id="l3.10"> ChromeUtils.import(&quot;resource:///modules/jsTreeSelection.js&quot;);</span>
<a href="#l3.11"></a><span id="l3.11" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l3.13"></a><span id="l3.13"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l3.14"></a><span id="l3.14"> </span>
<a href="#l3.15"></a><span id="l3.15"> var gFolderDisplay = null;</span>
<a href="#l3.16"></a><span id="l3.16"> var gMessageDisplay = null;</span>
<a href="#l3.17"></a><span id="l3.17"> </span>
<a href="#l3.18"></a><span id="l3.18"> var nsMsgFolderFlags = Ci.nsMsgFolderFlags;</span>
<a href="#l3.19"></a><span id="l3.19"> var nsMsgMessageFlags = Ci.nsMsgMessageFlags;</span>
<a href="#l3.20"></a><span id="l3.20"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/base/content/folderPane.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/base/content/folderPane.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -5,17 +5,17 @@</span>
<a href="#l4.4"></a><span id="l4.4"> // Implements a tree of folders. It shows icons depending on folder type</span>
<a href="#l4.5"></a><span id="l4.5"> // and other fancy styling.</span>
<a href="#l4.6"></a><span id="l4.6"> // This is used in the main folder pane, but also some dialogs that need</span>
<a href="#l4.7"></a><span id="l4.7"> // to show a nice list of folders.</span>
<a href="#l4.8"></a><span id="l4.8"> </span>
<a href="#l4.9"></a><span id="l4.9"> ChromeUtils.import(&quot;resource:///modules/folderUtils.jsm&quot;);</span>
<a href="#l4.10"></a><span id="l4.10"> ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l4.11"></a><span id="l4.11"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l4.14"></a><span id="l4.14"> ChromeUtils.import(&quot;resource:///modules/IOUtils.js&quot;);</span>
<a href="#l4.15"></a><span id="l4.15"> ChromeUtils.import(&quot;resource:///modules/FeedUtils.jsm&quot;);</span>
<a href="#l4.16"></a><span id="l4.16"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l4.17"></a><span id="l4.17"> </span>
<a href="#l4.18"></a><span id="l4.18"> if (typeof FeedMessageHandler != &quot;object&quot;)</span>
<a href="#l4.19"></a><span id="l4.19">   Services.scriptloader.loadSubScript(&quot;chrome://messenger-newsblog/content/newsblogOverlay.js&quot;);</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21"> var kDefaultMode = &quot;all&quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/base/content/mail3PaneWindowCommands.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/base/content/mail3PaneWindowCommands.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -3,17 +3,17 @@</span>
<a href="#l5.4"></a><span id="l5.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l5.5"></a><span id="l5.5"> </span>
<a href="#l5.6"></a><span id="l5.6"> /**</span>
<a href="#l5.7"></a><span id="l5.7">  * Functionality for the main application window (aka the 3pane) usually</span>
<a href="#l5.8"></a><span id="l5.8">  * consisting of folder pane, thread pane and message pane.</span>
<a href="#l5.9"></a><span id="l5.9">  */</span>
<a href="#l5.10"></a><span id="l5.10"> </span>
<a href="#l5.11"></a><span id="l5.11"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l5.14"></a><span id="l5.14"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l5.15"></a><span id="l5.15"> ChromeUtils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l5.16"></a><span id="l5.16"> </span>
<a href="#l5.17"></a><span id="l5.17"> // Controller object for folder pane</span>
<a href="#l5.18"></a><span id="l5.18"> var FolderPaneController =</span>
<a href="#l5.19"></a><span id="l5.19"> {</span>
<a href="#l5.20"></a><span id="l5.20">   supportsCommand: function(command)</span>
<a href="#l5.21"></a><span id="l5.21">   {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/base/content/mailCommands.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/base/content/mailCommands.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -1,15 +1,15 @@</span>
<a href="#l6.4"></a><span id="l6.4"> /* -*- Mode: Javascript; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l6.5"></a><span id="l6.5">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.6"></a><span id="l6.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.7"></a><span id="l6.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l6.8"></a><span id="l6.8"> </span>
<a href="#l6.9"></a><span id="l6.9"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l6.10"></a><span id="l6.10" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l6.12"></a><span id="l6.12"> </span>
<a href="#l6.13"></a><span id="l6.13"> /**</span>
<a href="#l6.14"></a><span id="l6.14">  * Get the identity that most likely is the best one to use, given the hint.</span>
<a href="#l6.15"></a><span id="l6.15">  * @param identities    nsIArray&lt;nsIMsgIdentity&gt; of identities</span>
<a href="#l6.16"></a><span id="l6.16">  * @param optionalHint  string containing comma separated mailboxes</span>
<a href="#l6.17"></a><span id="l6.17">  * @param useDefault    If true, use the default identity of the default</span>
<a href="#l6.18"></a><span id="l6.18">  *                      account as last choice. This is useful when all</span>
<a href="#l6.19"></a><span id="l6.19">  *                      identities are passed in. Otherwise, use the first</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/base/content/mailTabs.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/base/content/mailTabs.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -1,13 +1,13 @@</span>
<a href="#l7.4"></a><span id="l7.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l7.5"></a><span id="l7.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l7.6"></a><span id="l7.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l7.7"></a><span id="l7.7"> </span>
<a href="#l7.8"></a><span id="l7.8" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MsgHdrSyntheticView.js&quot;);</span>
<a href="#l7.9"></a><span id="l7.9" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MsgHdrSyntheticView.jsm&quot;);</span>
<a href="#l7.10"></a><span id="l7.10"> ChromeUtils.import(&quot;resource:///modules/errUtils.js&quot;);</span>
<a href="#l7.11"></a><span id="l7.11"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l7.12"></a><span id="l7.12"> </span>
<a href="#l7.13"></a><span id="l7.13"> /**</span>
<a href="#l7.14"></a><span id="l7.14">  * Displays message &quot;folder&quot;s, mail &quot;message&quot;s, and &quot;glodaList&quot; results.  The</span>
<a href="#l7.15"></a><span id="l7.15">  *  commonality is that they all use the &quot;mailContent&quot; panel's folder tree,</span>
<a href="#l7.16"></a><span id="l7.16">  *  thread tree, and message pane objects.  This happens for historical reasons,</span>
<a href="#l7.17"></a><span id="l7.17">  *  likely involving the fact that prior to the introduction of this</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/base/content/mailWidgets.xml</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/base/content/mailWidgets.xml</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -2407,17 +2407,17 @@</span>
<a href="#l8.4"></a><span id="l8.4">           &lt;xul:spring anonid=&quot;spring&quot; flex=&quot;100%&quot;/&gt;</span>
<a href="#l8.5"></a><span id="l8.5">         &lt;/xul:hbox&gt;</span>
<a href="#l8.6"></a><span id="l8.6">         &lt;xul:description anonid=&quot;preview&quot; class=&quot;folderSummary-message-row folderSummary-previewText&quot; xbl:inherits=&quot;value=previewText&quot; crop=&quot;right&quot;&gt;&lt;/xul:description&gt;</span>
<a href="#l8.7"></a><span id="l8.7">       &lt;/xul:vbox&gt;</span>
<a href="#l8.8"></a><span id="l8.8">     &lt;/content&gt;</span>
<a href="#l8.9"></a><span id="l8.9">     &lt;implementation&gt;</span>
<a href="#l8.10"></a><span id="l8.10">       &lt;constructor&gt;</span>
<a href="#l8.11"></a><span id="l8.11">         &lt;![CDATA[</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-          ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+          ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l8.14"></a><span id="l8.14">           ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;, this);</span>
<a href="#l8.15"></a><span id="l8.15"> </span>
<a href="#l8.16"></a><span id="l8.16">           if (!this.Services.prefs.getBoolPref(&quot;mail.biff.alert.show_preview&quot;))</span>
<a href="#l8.17"></a><span id="l8.17">             document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;preview&quot;).hidden = true;</span>
<a href="#l8.18"></a><span id="l8.18">           var hideSubject = !this.Services.prefs.getBoolPref(&quot;mail.biff.alert.show_subject&quot;);</span>
<a href="#l8.19"></a><span id="l8.19">           var hideSender = !this.Services.prefs.getBoolPref(&quot;mail.biff.alert.show_sender&quot;);</span>
<a href="#l8.20"></a><span id="l8.20">           if (hideSubject)</span>
<a href="#l8.21"></a><span id="l8.21">             document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;subject&quot;).hidden = true;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mail/base/content/mailWindow.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mail/base/content/mailWindow.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l9.4"></a><span id="l9.4"> /**</span>
<a href="#l9.5"></a><span id="l9.5">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l9.6"></a><span id="l9.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l9.7"></a><span id="l9.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l9.8"></a><span id="l9.8"> </span>
<a href="#l9.9"></a><span id="l9.9"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l9.10"></a><span id="l9.10"> ChromeUtils.import(&quot;resource:///modules/appIdleManager.js&quot;);</span>
<a href="#l9.11"></a><span id="l9.11" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l9.13"></a><span id="l9.13"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l9.14"></a><span id="l9.14"> ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l9.15"></a><span id="l9.15"> ChromeUtils.import(&quot;resource:///modules/gloda/log4moz.js&quot;);</span>
<a href="#l9.16"></a><span id="l9.16"> ChromeUtils.import(&quot;resource:///modules/gloda/public.js&quot;);</span>
<a href="#l9.17"></a><span id="l9.17"> </span>
<a href="#l9.18"></a><span id="l9.18"> //This file stores variables common to mail windows</span>
<a href="#l9.19"></a><span id="l9.19"> var messenger;</span>
<a href="#l9.20"></a><span id="l9.20"> var statusFeedback;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mail/base/content/mailWindowOverlay.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mail/base/content/mailWindowOverlay.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -1,18 +1,18 @@</span>
<a href="#l10.4"></a><span id="l10.4"> /* -*- indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l10.5"></a><span id="l10.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l10.6"></a><span id="l10.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l10.7"></a><span id="l10.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l10.8"></a><span id="l10.8"> </span>
<a href="#l10.9"></a><span id="l10.9"> ChromeUtils.import(&quot;resource:///modules/FeedUtils.jsm&quot;);</span>
<a href="#l10.10"></a><span id="l10.10"> ChromeUtils.import(&quot;resource:///modules/gloda/dbview.js&quot;);</span>
<a href="#l10.11"></a><span id="l10.11" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailConsts.js&quot;);</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailConsts.jsm&quot;);</span>
<a href="#l10.13"></a><span id="l10.13"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l10.16"></a><span id="l10.16"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l10.17"></a><span id="l10.17"> ChromeUtils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l10.18"></a><span id="l10.18"> ChromeUtils.import(&quot;resource://gre/modules/AppConstants.jsm&quot;);</span>
<a href="#l10.19"></a><span id="l10.19"> </span>
<a href="#l10.20"></a><span id="l10.20"> ChromeUtils.defineModuleGetter(this, &quot;BrowserToolboxProcess&quot;, &quot;resource://devtools/client/framework/ToolboxProcess.jsm&quot;);</span>
<a href="#l10.21"></a><span id="l10.21"> ChromeUtils.defineModuleGetter(this, &quot;ScratchpadManager&quot;,&quot;resource://devtools/client/scratchpad/scratchpad-manager.jsm&quot;);</span>
<a href="#l10.22"></a><span id="l10.22"> Object.defineProperty(this, &quot;HUDService&quot;, {</span>
<a href="#l10.23"></a><span id="l10.23">   get: function HUDService_getter() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mail/base/content/messageWindow.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mail/base/content/messageWindow.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -1,21 +1,21 @@</span>
<a href="#l11.4"></a><span id="l11.4"> /**</span>
<a href="#l11.5"></a><span id="l11.5">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l11.6"></a><span id="l11.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l11.7"></a><span id="l11.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l11.8"></a><span id="l11.8"> </span>
<a href="#l11.9"></a><span id="l11.9"> /* This is where functions related to the standalone message window are kept */</span>
<a href="#l11.10"></a><span id="l11.10"> </span>
<a href="#l11.11"></a><span id="l11.11"> ChromeUtils.import(&quot;resource:///modules/jsTreeSelection.js&quot;);</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l11.14"></a><span id="l11.14"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l11.15"></a><span id="l11.15"> ChromeUtils.import(&quot;resource://gre/modules/AppConstants.jsm&quot;);</span>
<a href="#l11.16"></a><span id="l11.16"> ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MsgHdrSyntheticView.js&quot;);</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MsgHdrSyntheticView.jsm&quot;);</span>
<a href="#l11.19"></a><span id="l11.19"> </span>
<a href="#l11.20"></a><span id="l11.20"> // from MailNewsTypes.h</span>
<a href="#l11.21"></a><span id="l11.21"> var nsMsgKey_None = 0xFFFFFFFF;</span>
<a href="#l11.22"></a><span id="l11.22"> var nsMsgViewIndex_None = 0xFFFFFFFF;</span>
<a href="#l11.23"></a><span id="l11.23"> </span>
<a href="#l11.24"></a><span id="l11.24"> /* globals for a particular window */</span>
<a href="#l11.25"></a><span id="l11.25"> </span>
<a href="#l11.26"></a><span id="l11.26"> /// we have no tree view; let people know that.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mail/base/content/msgHdrView.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mail/base/content/msgHdrView.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -4,17 +4,17 @@</span>
<a href="#l12.4"></a><span id="l12.4"> </span>
<a href="#l12.5"></a><span id="l12.5"> /**</span>
<a href="#l12.6"></a><span id="l12.6">  * Functions related to displaying the headers for a selected message in the</span>
<a href="#l12.7"></a><span id="l12.7">  * message pane.</span>
<a href="#l12.8"></a><span id="l12.8">  */</span>
<a href="#l12.9"></a><span id="l12.9"> </span>
<a href="#l12.10"></a><span id="l12.10"> ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l12.11"></a><span id="l12.11"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/displayNameUtils.js&quot;);</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/DisplayNameUtils.jsm&quot;);</span>
<a href="#l12.14"></a><span id="l12.14"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l12.15"></a><span id="l12.15"> ChromeUtils.import(&quot;resource:///modules/gloda/utils.js&quot;);</span>
<a href="#l12.16"></a><span id="l12.16"> var {Status: statusUtils} =</span>
<a href="#l12.17"></a><span id="l12.17">   ChromeUtils.import(&quot;resource:///modules/imStatusUtils.jsm&quot;);</span>
<a href="#l12.18"></a><span id="l12.18"> </span>
<a href="#l12.19"></a><span id="l12.19"> ////////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l12.20"></a><span id="l12.20"> // Warning: It's critical that the code in here for displaying the message</span>
<a href="#l12.21"></a><span id="l12.21"> // headers for a selected message remain as fast as possible. In particular,</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineat">@@ -1278,17 +1278,17 @@ function updateEmailAddressNode(emailAdd</span>
<a href="#l12.23"></a><span id="l12.23">   emailAddressNode.setAttribute(&quot;displayName&quot;, address.displayName || &quot;&quot;);</span>
<a href="#l12.24"></a><span id="l12.24"> </span>
<a href="#l12.25"></a><span id="l12.25">   if (address.emailAddress)</span>
<a href="#l12.26"></a><span id="l12.26">     UpdateEmailNodeDetails(address.emailAddress, emailAddressNode);</span>
<a href="#l12.27"></a><span id="l12.27"> }</span>
<a href="#l12.28"></a><span id="l12.28"> </span>
<a href="#l12.29"></a><span id="l12.29"> function UpdateEmailNodeDetails(aEmailAddress, aDocumentNode, aCardDetails) {</span>
<a href="#l12.30"></a><span id="l12.30">   // If we haven't been given specific details, search for a card.</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineminus">-  var cardDetails = aCardDetails || GetCardForEmail(aEmailAddress);</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+  var cardDetails = aCardDetails || DisplayNameUtils.getCardForEmail(aEmailAddress);</span>
<a href="#l12.33"></a><span id="l12.33">   aDocumentNode.cardDetails = cardDetails;</span>
<a href="#l12.34"></a><span id="l12.34"> </span>
<a href="#l12.35"></a><span id="l12.35">   if (!cardDetails.card) {</span>
<a href="#l12.36"></a><span id="l12.36">     aDocumentNode.setAttribute(&quot;hascard&quot;, &quot;false&quot;);</span>
<a href="#l12.37"></a><span id="l12.37">     aDocumentNode.setAttribute(&quot;tooltipstar&quot;,</span>
<a href="#l12.38"></a><span id="l12.38">       document.getElementById(&quot;addToAddressBookItem&quot;).label);</span>
<a href="#l12.39"></a><span id="l12.39">   } else {</span>
<a href="#l12.40"></a><span id="l12.40">     aDocumentNode.setAttribute(&quot;hascard&quot;, &quot;true&quot;);</span>
<a href="#l12.41"></a><span id="l12.41" class="difflineat">@@ -1342,20 +1342,22 @@ function UpdateEmailNodeDetails(aEmailAd</span>
<a href="#l12.42"></a><span id="l12.42">   UpdateEmailPresenceDetails(aDocumentNode, chatContact);</span>
<a href="#l12.43"></a><span id="l12.43"> </span>
<a href="#l12.44"></a><span id="l12.44">   // When we are adding cards, we don't want to move the display around if the</span>
<a href="#l12.45"></a><span id="l12.45">   // user has clicked on the star, therefore if it is locked, just exit and</span>
<a href="#l12.46"></a><span id="l12.46">   // leave the display updates until later.</span>
<a href="#l12.47"></a><span id="l12.47">   if (aDocumentNode.hasAttribute(&quot;updatingUI&quot;))</span>
<a href="#l12.48"></a><span id="l12.48">     return;</span>
<a href="#l12.49"></a><span id="l12.49"> </span>
<a href="#l12.50"></a><span id="l12.50" class="difflineminus">-  var displayName = FormatDisplayName(aEmailAddress,</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineminus">-                                      aDocumentNode.getAttribute(&quot;displayName&quot;),</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineminus">-                                      aDocumentNode.getAttribute(&quot;headerName&quot;),</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineminus">-                                      aDocumentNode.cardDetails.card);</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineplus">+  var displayName = DisplayNameUtils.formatDisplayName(</span>
<a href="#l12.55"></a><span id="l12.55" class="difflineplus">+    aEmailAddress,</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineplus">+    aDocumentNode.getAttribute(&quot;displayName&quot;),</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineplus">+    aDocumentNode.getAttribute(&quot;headerName&quot;),</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineplus">+    aDocumentNode.cardDetails.card</span>
<a href="#l12.59"></a><span id="l12.59" class="difflineplus">+  );</span>
<a href="#l12.60"></a><span id="l12.60"> </span>
<a href="#l12.61"></a><span id="l12.61">   if (gShowCondensedEmailAddresses &amp;&amp; displayName) {</span>
<a href="#l12.62"></a><span id="l12.62">     aDocumentNode.setAttribute(&quot;tooltiptext&quot;, aEmailAddress);</span>
<a href="#l12.63"></a><span id="l12.63">   } else {</span>
<a href="#l12.64"></a><span id="l12.64">     aDocumentNode.removeAttribute(&quot;tooltiptext&quot;);</span>
<a href="#l12.65"></a><span id="l12.65">     displayName = aDocumentNode.getAttribute(&quot;fullAddress&quot;) ||</span>
<a href="#l12.66"></a><span id="l12.66">                   aDocumentNode.getAttribute(&quot;displayName&quot;);</span>
<a href="#l12.67"></a><span id="l12.67">   }</span>
<a href="#l12.68"></a><span id="l12.68" class="difflineat">@@ -1389,20 +1391,22 @@ function UpdateExtraAddressProcessing(aA</span>
<a href="#l12.69"></a><span id="l12.69">                                       aParentDir, aItem)</span>
<a href="#l12.70"></a><span id="l12.70"> {</span>
<a href="#l12.71"></a><span id="l12.71">   switch (aAction) {</span>
<a href="#l12.72"></a><span id="l12.72">   case nsIAbListener.itemChanged:</span>
<a href="#l12.73"></a><span id="l12.73">     if (aAddressData &amp;&amp;</span>
<a href="#l12.74"></a><span id="l12.74">         aDocumentNode.cardDetails.card &amp;&amp;</span>
<a href="#l12.75"></a><span id="l12.75">         aItem.hasEmailAddress(aAddressData.emailAddress)) {</span>
<a href="#l12.76"></a><span id="l12.76">       aDocumentNode.cardDetails.card = aItem;</span>
<a href="#l12.77"></a><span id="l12.77" class="difflineminus">-      var displayName = FormatDisplayName(aAddressData.emailAddress,</span>
<a href="#l12.78"></a><span id="l12.78" class="difflineminus">-                                          aDocumentNode.getAttribute(&quot;displayName&quot;),</span>
<a href="#l12.79"></a><span id="l12.79" class="difflineminus">-                                          aDocumentNode.getAttribute(&quot;headerName&quot;),</span>
<a href="#l12.80"></a><span id="l12.80" class="difflineminus">-                                          aDocumentNode.cardDetails.card);</span>
<a href="#l12.81"></a><span id="l12.81" class="difflineplus">+      var displayName = DisplayNameUtils.formatDisplayName(</span>
<a href="#l12.82"></a><span id="l12.82" class="difflineplus">+        aAddressData.emailAddress,</span>
<a href="#l12.83"></a><span id="l12.83" class="difflineplus">+        aDocumentNode.getAttribute(&quot;displayName&quot;),</span>
<a href="#l12.84"></a><span id="l12.84" class="difflineplus">+        aDocumentNode.getAttribute(&quot;headerName&quot;),</span>
<a href="#l12.85"></a><span id="l12.85" class="difflineplus">+        aDocumentNode.cardDetails.card</span>
<a href="#l12.86"></a><span id="l12.86" class="difflineplus">+      );</span>
<a href="#l12.87"></a><span id="l12.87"> </span>
<a href="#l12.88"></a><span id="l12.88">       if (gShowCondensedEmailAddresses &amp;&amp; displayName) {</span>
<a href="#l12.89"></a><span id="l12.89">         aDocumentNode.setAttribute(&quot;label&quot;, displayName);</span>
<a href="#l12.90"></a><span id="l12.90">       } else {</span>
<a href="#l12.91"></a><span id="l12.91">         aDocumentNode.setAttribute(&quot;label&quot;,</span>
<a href="#l12.92"></a><span id="l12.92">                                    aDocumentNode.getAttribute(&quot;fullAddress&quot;) ||</span>
<a href="#l12.93"></a><span id="l12.93">                                    aDocumentNode.getAttribute(&quot;displayName&quot;));</span>
<a href="#l12.94"></a><span id="l12.94">       }</span>
<a href="#l12.95"></a><span id="l12.95" class="difflineat">@@ -1487,50 +1491,16 @@ function setupEmailAddressPopup(emailAdd</span>
<a href="#l12.96"></a><span id="l12.96">     }</span>
<a href="#l12.97"></a><span id="l12.97">   } else {</span>
<a href="#l12.98"></a><span id="l12.98">     document.getElementById(&quot;addToAddressBookItem&quot;).removeAttribute(&quot;hidden&quot;);</span>
<a href="#l12.99"></a><span id="l12.99">     document.getElementById(&quot;editContactItem&quot;).setAttribute(&quot;hidden&quot;, true);</span>
<a href="#l12.100"></a><span id="l12.100">     document.getElementById(&quot;viewContactItem&quot;).setAttribute(&quot;hidden&quot;, true);</span>
<a href="#l12.101"></a><span id="l12.101">   }</span>
<a href="#l12.102"></a><span id="l12.102"> }</span>
<a href="#l12.103"></a><span id="l12.103"> </span>
<a href="#l12.104"></a><span id="l12.104" class="difflineminus">-/**</span>
<a href="#l12.105"></a><span id="l12.105" class="difflineminus">- * Returns an object with two properties, book and card. If the email address</span>
<a href="#l12.106"></a><span id="l12.106" class="difflineminus">- * is found in the address books, then the book will contain an nsIAbDirectory,</span>
<a href="#l12.107"></a><span id="l12.107" class="difflineminus">- * and card will contain an nsIAbCard. If the email address is not found, both</span>
<a href="#l12.108"></a><span id="l12.108" class="difflineminus">- * items will contain null.</span>
<a href="#l12.109"></a><span id="l12.109" class="difflineminus">- *</span>
<a href="#l12.110"></a><span id="l12.110" class="difflineminus">- * @param emailAddress  address to look for</span>
<a href="#l12.111"></a><span id="l12.111" class="difflineminus">- * @return              an object with two properties, .book and .card</span>
<a href="#l12.112"></a><span id="l12.112" class="difflineminus">- */</span>
<a href="#l12.113"></a><span id="l12.113" class="difflineminus">-function getCardForEmail(emailAddress)</span>
<a href="#l12.114"></a><span id="l12.114" class="difflineminus">-{</span>
<a href="#l12.115"></a><span id="l12.115" class="difflineminus">-  // Email address is searched for in any of the address books that support</span>
<a href="#l12.116"></a><span id="l12.116" class="difflineminus">-  // the cardForEmailAddress function.</span>
<a href="#l12.117"></a><span id="l12.117" class="difflineminus">-  // Future expansion could be to domain matches</span>
<a href="#l12.118"></a><span id="l12.118" class="difflineminus">-</span>
<a href="#l12.119"></a><span id="l12.119" class="difflineminus">-  var books = MailServices.ab.directories;</span>
<a href="#l12.120"></a><span id="l12.120" class="difflineminus">-</span>
<a href="#l12.121"></a><span id="l12.121" class="difflineminus">-  var result = { book: null, card: null };</span>
<a href="#l12.122"></a><span id="l12.122" class="difflineminus">-</span>
<a href="#l12.123"></a><span id="l12.123" class="difflineminus">-  while (!result.card &amp;&amp; books.hasMoreElements()) {</span>
<a href="#l12.124"></a><span id="l12.124" class="difflineminus">-    var ab = books.getNext().QueryInterface(nsIAbDirectory);</span>
<a href="#l12.125"></a><span id="l12.125" class="difflineminus">-    try {</span>
<a href="#l12.126"></a><span id="l12.126" class="difflineminus">-      var card = ab.cardForEmailAddress(emailAddress);</span>
<a href="#l12.127"></a><span id="l12.127" class="difflineminus">-      if (card) {</span>
<a href="#l12.128"></a><span id="l12.128" class="difflineminus">-        result.book = ab;</span>
<a href="#l12.129"></a><span id="l12.129" class="difflineminus">-        result.card = card;</span>
<a href="#l12.130"></a><span id="l12.130" class="difflineminus">-      }</span>
<a href="#l12.131"></a><span id="l12.131" class="difflineminus">-    }</span>
<a href="#l12.132"></a><span id="l12.132" class="difflineminus">-    catch (ex) { }</span>
<a href="#l12.133"></a><span id="l12.133" class="difflineminus">-  }</span>
<a href="#l12.134"></a><span id="l12.134" class="difflineminus">-</span>
<a href="#l12.135"></a><span id="l12.135" class="difflineminus">-  return result;</span>
<a href="#l12.136"></a><span id="l12.136" class="difflineminus">-}</span>
<a href="#l12.137"></a><span id="l12.137" class="difflineminus">-</span>
<a href="#l12.138"></a><span id="l12.138"> function onClickEmailStar(event, emailAddressNode)</span>
<a href="#l12.139"></a><span id="l12.139"> {</span>
<a href="#l12.140"></a><span id="l12.140">   // Only care about left-click events</span>
<a href="#l12.141"></a><span id="l12.141">   if (event.button != 0)</span>
<a href="#l12.142"></a><span id="l12.142">     return;</span>
<a href="#l12.143"></a><span id="l12.143"> </span>
<a href="#l12.144"></a><span id="l12.144">   if (emailAddressNode &amp;&amp; emailAddressNode.cardDetails &amp;&amp;</span>
<a href="#l12.145"></a><span id="l12.145">       emailAddressNode.cardDetails.card) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mail/base/content/msgMail3PaneWindow.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mail/base/content/msgMail3PaneWindow.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -3,24 +3,24 @@</span>
<a href="#l13.4"></a><span id="l13.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l13.5"></a><span id="l13.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l13.6"></a><span id="l13.6"> </span>
<a href="#l13.7"></a><span id="l13.7"> ChromeUtils.import(&quot;resource:///modules/activity/activityModules.jsm&quot;);</span>
<a href="#l13.8"></a><span id="l13.8"> ChromeUtils.import(&quot;resource:///modules/errUtils.js&quot;);</span>
<a href="#l13.9"></a><span id="l13.9"> ChromeUtils.import(&quot;resource:///modules/folderUtils.jsm&quot;);</span>
<a href="#l13.10"></a><span id="l13.10"> ChromeUtils.import(&quot;resource:///modules/IOUtils.js&quot;);</span>
<a href="#l13.11"></a><span id="l13.11"> ChromeUtils.import(&quot;resource:///modules/jsTreeSelection.js&quot;);</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailConsts.js&quot;);</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/mailInstrumentation.js&quot;);</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailConsts.jsm&quot;);</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailInstrumentation.jsm&quot;);</span>
<a href="#l13.16"></a><span id="l13.16"> ChromeUtils.import(&quot;resource:///modules/mailnewsMigrator.js&quot;);</span>
<a href="#l13.17"></a><span id="l13.17"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l13.18"></a><span id="l13.18"> ChromeUtils.import(&quot;resource:///modules/msgDBCacheManager.js&quot;);</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/sessionStoreManager.js&quot;);</span>
<a href="#l13.20"></a><span id="l13.20" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/summaryFrameManager.js&quot;);</span>
<a href="#l13.21"></a><span id="l13.21" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/SessionStoreManager.jsm&quot;);</span>
<a href="#l13.23"></a><span id="l13.23" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/SummaryFrameManager.jsm&quot;);</span>
<a href="#l13.24"></a><span id="l13.24" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l13.25"></a><span id="l13.25"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l13.26"></a><span id="l13.26"> ChromeUtils.import(&quot;resource://gre/modules/AppConstants.jsm&quot;);</span>
<a href="#l13.27"></a><span id="l13.27"> ChromeUtils.import(&quot;resource://gre/modules/Color.jsm&quot;);</span>
<a href="#l13.28"></a><span id="l13.28"> </span>
<a href="#l13.29"></a><span id="l13.29"> XPCOMUtils.defineLazyModuleGetters(this, {</span>
<a href="#l13.30"></a><span id="l13.30">   LightweightThemeManager: &quot;resource://gre/modules/LightweightThemeManager.jsm&quot;,</span>
<a href="#l13.31"></a><span id="l13.31"> });</span>
<a href="#l13.32"></a><span id="l13.32"> </span>
<a href="#l13.33"></a><span id="l13.33" class="difflineat">@@ -391,17 +391,17 @@ function OnLoadMessenger()</span>
<a href="#l13.34"></a><span id="l13.34">   MailOfflineMgr.init();</span>
<a href="#l13.35"></a><span id="l13.35">   CreateMailWindowGlobals();</span>
<a href="#l13.36"></a><span id="l13.36">   GetMessagePaneWrapper().collapsed = true;</span>
<a href="#l13.37"></a><span id="l13.37">   msgDBCacheManager.init();</span>
<a href="#l13.38"></a><span id="l13.38">   Services.search.init();</span>
<a href="#l13.39"></a><span id="l13.39"> </span>
<a href="#l13.40"></a><span id="l13.40">   // This needs to be before we throw up the account wizard on first run.</span>
<a href="#l13.41"></a><span id="l13.41">   try {</span>
<a href="#l13.42"></a><span id="l13.42" class="difflineminus">-    mailInstrumentationManager.init();</span>
<a href="#l13.43"></a><span id="l13.43" class="difflineplus">+    MailInstrumentation.init();</span>
<a href="#l13.44"></a><span id="l13.44">   } catch(ex) {logException(ex);}</span>
<a href="#l13.45"></a><span id="l13.45"> </span>
<a href="#l13.46"></a><span id="l13.46">   // - initialize tabmail system</span>
<a href="#l13.47"></a><span id="l13.47">   // Do this before LoadPostAccountWizard since that code selects the first</span>
<a href="#l13.48"></a><span id="l13.48">   //  folder for display, and we want gFolderDisplay setup and ready to handle</span>
<a href="#l13.49"></a><span id="l13.49">   //  that event chain.</span>
<a href="#l13.50"></a><span id="l13.50">   // Also, we definitely need to register the tab type prior to the call to</span>
<a href="#l13.51"></a><span id="l13.51">   //  specialTabs.openSpecialTabsOnStartup below.</span>
<a href="#l13.52"></a><span id="l13.52" class="difflineat">@@ -454,17 +454,17 @@ function LoadPostAccountWizard()</span>
<a href="#l13.53"></a><span id="l13.53"> {</span>
<a href="#l13.54"></a><span id="l13.54">   InitMsgWindow();</span>
<a href="#l13.55"></a><span id="l13.55">   messenger.setWindow(window, msgWindow);</span>
<a href="#l13.56"></a><span id="l13.56"> </span>
<a href="#l13.57"></a><span id="l13.57">   InitPanes();</span>
<a href="#l13.58"></a><span id="l13.58">   MigrateJunkMailSettings();</span>
<a href="#l13.59"></a><span id="l13.59">   MigrateFolderViews();</span>
<a href="#l13.60"></a><span id="l13.60">   MigrateOpenMessageBehavior();</span>
<a href="#l13.61"></a><span id="l13.61" class="difflineminus">-  ChromeUtils.import(&quot;resource:///modules/mailMigrator.js&quot;);</span>
<a href="#l13.62"></a><span id="l13.62" class="difflineplus">+  ChromeUtils.import(&quot;resource:///modules/MailMigrator.jsm&quot;);</span>
<a href="#l13.63"></a><span id="l13.63">   MailMigrator.migratePostAccountWizard();</span>
<a href="#l13.64"></a><span id="l13.64"> </span>
<a href="#l13.65"></a><span id="l13.65">   accountManager.setSpecialFolders();</span>
<a href="#l13.66"></a><span id="l13.66"> </span>
<a href="#l13.67"></a><span id="l13.67">   try {</span>
<a href="#l13.68"></a><span id="l13.68">     accountManager.loadVirtualFolders();</span>
<a href="#l13.69"></a><span id="l13.69">   } catch (e) {Cu.reportError(e);}</span>
<a href="#l13.70"></a><span id="l13.70">   accountManager.addIncomingServerListener(gThreePaneIncomingServerListener);</span>
<a href="#l13.71"></a><span id="l13.71" class="difflineat">@@ -625,17 +625,17 @@ function OnUnloadMessenger()</span>
<a href="#l13.72"></a><span id="l13.72">   Services.prefs.removeObserver(&quot;mail.showCondensedAddresses&quot;, MailPrefObserver);</span>
<a href="#l13.73"></a><span id="l13.73"> </span>
<a href="#l13.74"></a><span id="l13.74">   if (gRightMouseButtonSavedSelection) {</span>
<a href="#l13.75"></a><span id="l13.75">     // Avoid possible cycle leaks.</span>
<a href="#l13.76"></a><span id="l13.76">     gRightMouseButtonSavedSelection.view = null;</span>
<a href="#l13.77"></a><span id="l13.77">     gRightMouseButtonSavedSelection = null;</span>
<a href="#l13.78"></a><span id="l13.78">   }</span>
<a href="#l13.79"></a><span id="l13.79"> </span>
<a href="#l13.80"></a><span id="l13.80" class="difflineminus">-  sessionStoreManager.unloadingWindow(window);</span>
<a href="#l13.81"></a><span id="l13.81" class="difflineplus">+  SessionStoreManager.unloadingWindow(window);</span>
<a href="#l13.82"></a><span id="l13.82"> </span>
<a href="#l13.83"></a><span id="l13.83">   TabsInTitlebar.uninit();</span>
<a href="#l13.84"></a><span id="l13.84"> </span>
<a href="#l13.85"></a><span id="l13.85">   ToolbarIconColor.uninit();</span>
<a href="#l13.86"></a><span id="l13.86"> </span>
<a href="#l13.87"></a><span id="l13.87">   CompactTheme.uninit();</span>
<a href="#l13.88"></a><span id="l13.88"> </span>
<a href="#l13.89"></a><span id="l13.89">   let tabmail = document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l13.90"></a><span id="l13.90" class="difflineat">@@ -649,17 +649,17 @@ function OnUnloadMessenger()</span>
<a href="#l13.91"></a><span id="l13.91"> </span>
<a href="#l13.92"></a><span id="l13.92">   // FIX ME - later we will be able to use onload from the overlay</span>
<a href="#l13.93"></a><span id="l13.93">   OnUnloadMsgHeaderPane();</span>
<a href="#l13.94"></a><span id="l13.94"> </span>
<a href="#l13.95"></a><span id="l13.95">   UnloadPanes();</span>
<a href="#l13.96"></a><span id="l13.96"> </span>
<a href="#l13.97"></a><span id="l13.97">   OnMailWindowUnload();</span>
<a href="#l13.98"></a><span id="l13.98">   try {</span>
<a href="#l13.99"></a><span id="l13.99" class="difflineminus">-    mailInstrumentationManager.uninit();</span>
<a href="#l13.100"></a><span id="l13.100" class="difflineplus">+    MailInstrumentation.uninit();</span>
<a href="#l13.101"></a><span id="l13.101">   } catch (ex) {logException(ex);}</span>
<a href="#l13.102"></a><span id="l13.102"> }</span>
<a href="#l13.103"></a><span id="l13.103"> </span>
<a href="#l13.104"></a><span id="l13.104"> /**</span>
<a href="#l13.105"></a><span id="l13.105">  * Called by the session store manager periodically and at shutdown to get</span>
<a href="#l13.106"></a><span id="l13.106">  * the state of this window for persistence.</span>
<a href="#l13.107"></a><span id="l13.107">  */</span>
<a href="#l13.108"></a><span id="l13.108"> function getWindowStateForSessionPersistence()</span>
<a href="#l13.109"></a><span id="l13.109" class="difflineat">@@ -676,26 +676,26 @@ function getWindowStateForSessionPersist</span>
<a href="#l13.110"></a><span id="l13.110">  * @param aDontRestoreFirstTab If this is true, the first tab will not be</span>
<a href="#l13.111"></a><span id="l13.111">  *                             restored, and will continue to retain focus at</span>
<a href="#l13.112"></a><span id="l13.112">  *                             the end. This is needed if the window was opened</span>
<a href="#l13.113"></a><span id="l13.113">  *                             with a folder or a message as an argument.</span>
<a href="#l13.114"></a><span id="l13.114">  *</span>
<a href="#l13.115"></a><span id="l13.115">  * @return true if the restoration was successful, false otherwise.</span>
<a href="#l13.116"></a><span id="l13.116">  */</span>
<a href="#l13.117"></a><span id="l13.117"> async function atStartupRestoreTabs(aDontRestoreFirstTab) {</span>
<a href="#l13.118"></a><span id="l13.118" class="difflineminus">-  let state = await sessionStoreManager.loadingWindow(window);</span>
<a href="#l13.119"></a><span id="l13.119" class="difflineplus">+  let state = await SessionStoreManager.loadingWindow(window);</span>
<a href="#l13.120"></a><span id="l13.120">   if (state) {</span>
<a href="#l13.121"></a><span id="l13.121">     let tabsState = state.tabs;</span>
<a href="#l13.122"></a><span id="l13.122">     let tabmail = document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l13.123"></a><span id="l13.123">     tabmail.restoreTabs(tabsState, aDontRestoreFirstTab);</span>
<a href="#l13.124"></a><span id="l13.124">   }</span>
<a href="#l13.125"></a><span id="l13.125"> </span>
<a href="#l13.126"></a><span id="l13.126">   // it's now safe to load extra Tabs.</span>
<a href="#l13.127"></a><span id="l13.127">   setTimeout(loadExtraTabs, 0);</span>
<a href="#l13.128"></a><span id="l13.128" class="difflineminus">-  sessionStoreManager._restored = true;</span>
<a href="#l13.129"></a><span id="l13.129" class="difflineplus">+  SessionStoreManager._restored = true;</span>
<a href="#l13.130"></a><span id="l13.130">   Services.obs.notifyObservers(window, &quot;mail-tabs-session-restored&quot;);</span>
<a href="#l13.131"></a><span id="l13.131">   return state ? true : false;</span>
<a href="#l13.132"></a><span id="l13.132"> }</span>
<a href="#l13.133"></a><span id="l13.133"> </span>
<a href="#l13.134"></a><span id="l13.134"> /**</span>
<a href="#l13.135"></a><span id="l13.135">  * Loads and restores tabs upon opening a window by evaluating window.arguments[1].</span>
<a href="#l13.136"></a><span id="l13.136">  *</span>
<a href="#l13.137"></a><span id="l13.137">  * The type of the object is specified by it's action property. It can be</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mail/base/content/multimessageview.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mail/base/content/multimessageview.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -1,17 +1,17 @@</span>
<a href="#l14.4"></a><span id="l14.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l14.5"></a><span id="l14.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l14.6"></a><span id="l14.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l14.7"></a><span id="l14.7"> </span>
<a href="#l14.8"></a><span id="l14.8"> ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l14.9"></a><span id="l14.9"> ChromeUtils.import(&quot;resource:///modules/gloda/gloda.js&quot;);</span>
<a href="#l14.10"></a><span id="l14.10"> ChromeUtils.import(&quot;resource:///modules/gloda/connotent.js&quot;);</span>
<a href="#l14.11"></a><span id="l14.11"> ChromeUtils.import(&quot;resource:///modules/gloda/mimemsg.js&quot;);</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/displayNameUtils.js&quot;);</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/DisplayNameUtils.jsm&quot;);</span>
<a href="#l14.14"></a><span id="l14.14"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l14.15"></a><span id="l14.15"> ChromeUtils.import(&quot;resource:///modules/templateUtils.js&quot;);</span>
<a href="#l14.16"></a><span id="l14.16"> </span>
<a href="#l14.17"></a><span id="l14.17"> var gMessenger = Cc[&quot;@mozilla.org/messenger;1&quot;]</span>
<a href="#l14.18"></a><span id="l14.18">                    .createInstance(Ci.nsIMessenger);</span>
<a href="#l14.19"></a><span id="l14.19"> </span>
<a href="#l14.20"></a><span id="l14.20"> // Set up our string formatter for localizing strings.</span>
<a href="#l14.21"></a><span id="l14.21"> XPCOMUtils.defineLazyGetter(this, &quot;formatString&quot;, function() {</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineat">@@ -227,17 +227,17 @@ MultiMessageSummary.prototype = {</span>
<a href="#l14.23"></a><span id="l14.23">                       '&lt;div class=&quot;item_header&quot;/&gt;' +</span>
<a href="#l14.24"></a><span id="l14.24">                       '&lt;div class=&quot;snippet&quot;/&gt;' +</span>
<a href="#l14.25"></a><span id="l14.25">                     '&lt;/div&gt;';</span>
<a href="#l14.26"></a><span id="l14.26"> </span>
<a href="#l14.27"></a><span id="l14.27">     let itemHeaderNode = row.querySelector(&quot;.item_header&quot;);</span>
<a href="#l14.28"></a><span id="l14.28"> </span>
<a href="#l14.29"></a><span id="l14.29">     let authorNode = document.createElement(&quot;span&quot;);</span>
<a href="#l14.30"></a><span id="l14.30">     authorNode.classList.add(&quot;author&quot;);</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineminus">-    authorNode.textContent = FormatDisplayNameList(</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+    authorNode.textContent = DisplayNameUtils.formatDisplayNameList(</span>
<a href="#l14.33"></a><span id="l14.33">       message.mime2DecodedAuthor, &quot;from&quot;</span>
<a href="#l14.34"></a><span id="l14.34">     );</span>
<a href="#l14.35"></a><span id="l14.35"> </span>
<a href="#l14.36"></a><span id="l14.36">     if (aOptions &amp;&amp; aOptions.showSubject) {</span>
<a href="#l14.37"></a><span id="l14.37">       authorNode.classList.add(&quot;right&quot;);</span>
<a href="#l14.38"></a><span id="l14.38">       itemHeaderNode.appendChild(authorNode);</span>
<a href="#l14.39"></a><span id="l14.39"> </span>
<a href="#l14.40"></a><span id="l14.40">       let subjectNode = document.createElement(&quot;span&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mail/base/content/nsContextMenu.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mail/base/content/nsContextMenu.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -3,17 +3,17 @@</span>
<a href="#l15.4"></a><span id="l15.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l15.5"></a><span id="l15.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l15.6"></a><span id="l15.6"> </span>
<a href="#l15.7"></a><span id="l15.7"> ChromeUtils.import(&quot;resource://gre/modules/InlineSpellChecker.jsm&quot;);</span>
<a href="#l15.8"></a><span id="l15.8"> ChromeUtils.import(&quot;resource://gre/modules/PlacesUtils.jsm&quot;);</span>
<a href="#l15.9"></a><span id="l15.9"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l15.10"></a><span id="l15.10"> ChromeUtils.import(&quot;resource://gre/modules/AppConstants.jsm&quot;);</span>
<a href="#l15.11"></a><span id="l15.11"> ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l15.14"></a><span id="l15.14"> </span>
<a href="#l15.15"></a><span id="l15.15"> XPCOMUtils.defineLazyGetter(this, &quot;PageMenuParent&quot;, function() {</span>
<a href="#l15.16"></a><span id="l15.16">   let tmp = {};</span>
<a href="#l15.17"></a><span id="l15.17">   ChromeUtils.import(&quot;resource://gre/modules/PageMenu.jsm&quot;, tmp);</span>
<a href="#l15.18"></a><span id="l15.18">   return new tmp.PageMenuParent();</span>
<a href="#l15.19"></a><span id="l15.19"> });</span>
<a href="#l15.20"></a><span id="l15.20"> </span>
<a href="#l15.21"></a><span id="l15.21"> var gSpellChecker = new InlineSpellChecker();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mail/base/content/quickFilterBar.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mail/base/content/quickFilterBar.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l16.4"></a><span id="l16.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l16.5"></a><span id="l16.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l16.6"></a><span id="l16.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l16.7"></a><span id="l16.7"> </span>
<a href="#l16.8"></a><span id="l16.8"> ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l16.9"></a><span id="l16.9"> ChromeUtils.import(&quot;resource:///modules/errUtils.js&quot;);</span>
<a href="#l16.10"></a><span id="l16.10" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/quickFilterManager.js&quot;);</span>
<a href="#l16.11"></a><span id="l16.11" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/searchSpec.js&quot;);</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/QuickFilterManager.jsm&quot;);</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/SearchSpec.jsm&quot;);</span>
<a href="#l16.14"></a><span id="l16.14"> </span>
<a href="#l16.15"></a><span id="l16.15"> ////////////////////////////////////////////////////////////////////////////////</span>
<a href="#l16.16"></a><span id="l16.16"> //// Proper Code</span>
<a href="#l16.17"></a><span id="l16.17"> </span>
<a href="#l16.18"></a><span id="l16.18"> /**</span>
<a href="#l16.19"></a><span id="l16.19">  * There is only one message filter bar widget; the muxer deals with tab</span>
<a href="#l16.20"></a><span id="l16.20">  *  changes and directing modifications to and reflecting the state of the</span>
<a href="#l16.21"></a><span id="l16.21">  *  actual filterer objects.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1">rename from mail/base/modules/attachmentChecker.js</span>
<a href="#l17.2"></a><span id="l17.2">rename to mail/base/modules/AttachmentChecker.jsm</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineminus">--- a/mail/base/modules/attachmentChecker.js</span>
<a href="#l17.4"></a><span id="l17.4" class="difflineplus">+++ b/mail/base/modules/AttachmentChecker.jsm</span>
<a href="#l17.5"></a><span id="l17.5" class="difflineat">@@ -1,13 +1,17 @@</span>
<a href="#l17.6"></a><span id="l17.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l17.7"></a><span id="l17.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l17.8"></a><span id="l17.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l17.9"></a><span id="l17.9"> </span>
<a href="#l17.10"></a><span id="l17.10" class="difflineminus">-this.EXPORTED_SYMBOLS = [&quot;GetAttachmentKeywords&quot;];</span>
<a href="#l17.11"></a><span id="l17.11" class="difflineplus">+this.EXPORTED_SYMBOLS = [&quot;AttachmentChecker&quot;];</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineplus">+</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+var AttachmentChecker = {</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineplus">+  getAttachmentKeywords,</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineplus">+};</span>
<a href="#l17.16"></a><span id="l17.16"> </span>
<a href="#l17.17"></a><span id="l17.17"> /**</span>
<a href="#l17.18"></a><span id="l17.18">  * Check whether the character is a CJK character or not.</span>
<a href="#l17.19"></a><span id="l17.19">  *</span>
<a href="#l17.20"></a><span id="l17.20">  * @return true if it is a CJK character.</span>
<a href="#l17.21"></a><span id="l17.21">  */</span>
<a href="#l17.22"></a><span id="l17.22"> function IsCJK(code)</span>
<a href="#l17.23"></a><span id="l17.23"> {</span>
<a href="#l17.24"></a><span id="l17.24" class="difflineat">@@ -26,17 +30,17 @@ function IsCJK(code)</span>
<a href="#l17.25"></a><span id="l17.25">   return false;</span>
<a href="#l17.26"></a><span id="l17.26"> }</span>
<a href="#l17.27"></a><span id="l17.27"> </span>
<a href="#l17.28"></a><span id="l17.28"> /**</span>
<a href="#l17.29"></a><span id="l17.29">  * Get the (possibly-empty) list of attachment keywords in this message.</span>
<a href="#l17.30"></a><span id="l17.30">  *</span>
<a href="#l17.31"></a><span id="l17.31">  * @return the (possibly-empty) list of attachment keywords in this message</span>
<a href="#l17.32"></a><span id="l17.32">  **/</span>
<a href="#l17.33"></a><span id="l17.33" class="difflineminus">-function GetAttachmentKeywords(mailData,keywordsInCsv)</span>
<a href="#l17.34"></a><span id="l17.34" class="difflineplus">+function getAttachmentKeywords(mailData,keywordsInCsv)</span>
<a href="#l17.35"></a><span id="l17.35"> {</span>
<a href="#l17.36"></a><span id="l17.36">   // The empty string would get split to an array of size 1.  Avoid that...</span>
<a href="#l17.37"></a><span id="l17.37">   var keywordsArray = (keywordsInCsv) ? keywordsInCsv.split(&quot;,&quot;) : [];</span>
<a href="#l17.38"></a><span id="l17.38"> </span>
<a href="#l17.39"></a><span id="l17.39">   function escapeRegxpSpecials(inputString)</span>
<a href="#l17.40"></a><span id="l17.40">   {</span>
<a href="#l17.41"></a><span id="l17.41">     const specials = [&quot;.&quot;, &quot;\\&quot;, &quot;^&quot;, &quot;$&quot;, &quot;*&quot;, &quot;+&quot;, &quot;?&quot;, &quot;|&quot;,</span>
<a href="#l17.42"></a><span id="l17.42">                       &quot;(&quot;, &quot;)&quot; , &quot;[&quot;, &quot;]&quot;, &quot;{&quot;, &quot;}&quot;];</span>
<a href="#l17.43"></a><span id="l17.43" class="difflineat">@@ -86,14 +90,13 @@ function GetAttachmentKeywords(mailData,</span>
<a href="#l17.44"></a><span id="l17.44">           break;</span>
<a href="#l17.45"></a><span id="l17.45">         }</span>
<a href="#l17.46"></a><span id="l17.46">       }</span>
<a href="#l17.47"></a><span id="l17.47">     }</span>
<a href="#l17.48"></a><span id="l17.48">   }</span>
<a href="#l17.49"></a><span id="l17.49">   return keywordsFound;</span>
<a href="#l17.50"></a><span id="l17.50"> }</span>
<a href="#l17.51"></a><span id="l17.51"> </span>
<a href="#l17.52"></a><span id="l17.52" class="difflineminus">-var onmessage = function(event)</span>
<a href="#l17.53"></a><span id="l17.53" class="difflineminus">-{</span>
<a href="#l17.54"></a><span id="l17.54" class="difflineminus">-  var keywordsFound = GetAttachmentKeywords(event.data[0], event.data[1]);</span>
<a href="#l17.55"></a><span id="l17.55" class="difflineplus">+var onmessage = function(event) {</span>
<a href="#l17.56"></a><span id="l17.56" class="difflineplus">+  var keywordsFound = AttachmentChecker.getAttachmentKeywords(event.data[0], event.data[1]);</span>
<a href="#l17.57"></a><span id="l17.57">   postMessage(keywordsFound);</span>
<a href="#l17.58"></a><span id="l17.58"> };</span>
<a href="#l17.59"></a><span id="l17.59"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1">rename from mail/base/modules/dbViewWrapper.js</span>
<a href="#l18.2"></a><span id="l18.2">rename to mail/base/modules/DBViewWrapper.jsm</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineminus">--- a/mail/base/modules/dbViewWrapper.js</span>
<a href="#l18.4"></a><span id="l18.4" class="difflineplus">+++ b/mail/base/modules/DBViewWrapper.jsm</span>
<a href="#l18.5"></a><span id="l18.5" class="difflineat">@@ -1,17 +1,17 @@</span>
<a href="#l18.6"></a><span id="l18.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l18.7"></a><span id="l18.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l18.8"></a><span id="l18.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l18.9"></a><span id="l18.9"> </span>
<a href="#l18.10"></a><span id="l18.10"> this.EXPORTED_SYMBOLS = ['DBViewWrapper', 'IDBViewWrapperListener'];</span>
<a href="#l18.11"></a><span id="l18.11"> </span>
<a href="#l18.12"></a><span id="l18.12"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/mailViewManager.js&quot;);</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/searchSpec.js&quot;);</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailViewManager.jsm&quot;);</span>
<a href="#l18.16"></a><span id="l18.16" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/SearchSpec.jsm&quot;);</span>
<a href="#l18.17"></a><span id="l18.17"> ChromeUtils.import(&quot;resource:///modules/virtualFolderWrapper.js&quot;);</span>
<a href="#l18.18"></a><span id="l18.18"> </span>
<a href="#l18.19"></a><span id="l18.19"> var nsMsgFolderFlags = Ci.nsMsgFolderFlags;</span>
<a href="#l18.20"></a><span id="l18.20"> var nsMsgViewType = Ci.nsMsgViewType;</span>
<a href="#l18.21"></a><span id="l18.21"> var nsMsgViewFlagsType = Ci.nsMsgViewFlagsType;</span>
<a href="#l18.22"></a><span id="l18.22"> var nsMsgViewSortType = Ci.nsMsgViewSortType;</span>
<a href="#l18.23"></a><span id="l18.23"> var nsMsgViewSortOrder = Ci.nsMsgViewSortOrder;</span>
<a href="#l18.24"></a><span id="l18.24"> var nsMsgMessageFlags = Ci.nsMsgMessageFlags;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1">rename from mail/base/modules/displayNameUtils.js</span>
<a href="#l19.2"></a><span id="l19.2">rename to mail/base/modules/DisplayNameUtils.jsm</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineminus">--- a/mail/base/modules/displayNameUtils.js</span>
<a href="#l19.4"></a><span id="l19.4" class="difflineplus">+++ b/mail/base/modules/DisplayNameUtils.jsm</span>
<a href="#l19.5"></a><span id="l19.5" class="difflineat">@@ -1,35 +1,39 @@</span>
<a href="#l19.6"></a><span id="l19.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l19.7"></a><span id="l19.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l19.8"></a><span id="l19.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l19.9"></a><span id="l19.9"> </span>
<a href="#l19.10"></a><span id="l19.10"> ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l19.11"></a><span id="l19.11"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l19.12"></a><span id="l19.12"> ChromeUtils.import(&quot;resource:///modules/StringBundle.js&quot;);</span>
<a href="#l19.13"></a><span id="l19.13"> </span>
<a href="#l19.14"></a><span id="l19.14" class="difflineminus">-var EXPORTED_SYMBOLS = [</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineminus">-  &quot;GetCardForEmail&quot;, &quot;FormatDisplayName&quot;, &quot;FormatDisplayNameList&quot;,</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineminus">-];</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineplus">+var EXPORTED_SYMBOLS = [&quot;DisplayNameUtils&quot;];</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineplus">+</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineplus">+var DisplayNameUtils = {</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineplus">+  formatDisplayName,</span>
<a href="#l19.21"></a><span id="l19.21" class="difflineplus">+  formatDisplayNameList,</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineplus">+  getCardForEmail,</span>
<a href="#l19.23"></a><span id="l19.23" class="difflineplus">+};</span>
<a href="#l19.24"></a><span id="l19.24"> </span>
<a href="#l19.25"></a><span id="l19.25"> // XXX: Maybe the strings for this file should go in a separate bundle?</span>
<a href="#l19.26"></a><span id="l19.26"> var gMessengerBundle = new StringBundle(</span>
<a href="#l19.27"></a><span id="l19.27">   &quot;chrome://messenger/locale/messenger.properties&quot;</span>
<a href="#l19.28"></a><span id="l19.28"> );</span>
<a href="#l19.29"></a><span id="l19.29"> </span>
<a href="#l19.30"></a><span id="l19.30"> /**</span>
<a href="#l19.31"></a><span id="l19.31">  * Returns an object with two properties, .book and .card. If the email address</span>
<a href="#l19.32"></a><span id="l19.32">  * is found in the address books, then the book will contain an nsIAbDirectory,</span>
<a href="#l19.33"></a><span id="l19.33">  * and card will contain an nsIAbCard. If the email address is not found, both</span>
<a href="#l19.34"></a><span id="l19.34">  * items will contain null.</span>
<a href="#l19.35"></a><span id="l19.35">  *</span>
<a href="#l19.36"></a><span id="l19.36">  * @param aEmailAddress The address to look for.</span>
<a href="#l19.37"></a><span id="l19.37">  * @return An object with two properties, .book and .card.</span>
<a href="#l19.38"></a><span id="l19.38">  */</span>
<a href="#l19.39"></a><span id="l19.39" class="difflineminus">-function GetCardForEmail(aEmailAddress) {</span>
<a href="#l19.40"></a><span id="l19.40" class="difflineplus">+function getCardForEmail(aEmailAddress) {</span>
<a href="#l19.41"></a><span id="l19.41">   // Email address is searched for in any of the address books that support</span>
<a href="#l19.42"></a><span id="l19.42">   // the cardForEmailAddress function.</span>
<a href="#l19.43"></a><span id="l19.43">   // Future expansion could be to domain matches</span>
<a href="#l19.44"></a><span id="l19.44">   let books = MailServices.ab.directories;</span>
<a href="#l19.45"></a><span id="l19.45">   for (let book of fixIterator(books, Ci.nsIAbDirectory)) {</span>
<a href="#l19.46"></a><span id="l19.46">     try {</span>
<a href="#l19.47"></a><span id="l19.47">       let card = book.cardForEmailAddress(aEmailAddress);</span>
<a href="#l19.48"></a><span id="l19.48">       if (card)</span>
<a href="#l19.49"></a><span id="l19.49" class="difflineat">@@ -62,21 +66,21 @@ function _getIdentityForAddress(aEmailAd</span>
<a href="#l19.50"></a><span id="l19.50">  * @param aEmailAddress      The email address to format.</span>
<a href="#l19.51"></a><span id="l19.51">  * @param aHeaderDisplayName The display name from the header, if any</span>
<a href="#l19.52"></a><span id="l19.52">  *                           (unused, maintained for add-ons, previously used</span>
<a href="#l19.53"></a><span id="l19.53">  *                           as a fallback).</span>
<a href="#l19.54"></a><span id="l19.54">  * @param aContext           The field being formatted (e.g. &quot;to&quot;, &quot;from&quot;).</span>
<a href="#l19.55"></a><span id="l19.55">  * @param aCard              The address book card, if any.</span>
<a href="#l19.56"></a><span id="l19.56">  * @return The formatted display name, or null.</span>
<a href="#l19.57"></a><span id="l19.57">  */</span>
<a href="#l19.58"></a><span id="l19.58" class="difflineminus">-function FormatDisplayName(aEmailAddress, aHeaderDisplayName, aContext, aCard)</span>
<a href="#l19.59"></a><span id="l19.59" class="difflineplus">+function formatDisplayName(aEmailAddress, aHeaderDisplayName, aContext, aCard)</span>
<a href="#l19.60"></a><span id="l19.60"> {</span>
<a href="#l19.61"></a><span id="l19.61">   var displayName = null;</span>
<a href="#l19.62"></a><span id="l19.62">   var identity = _getIdentityForAddress(aEmailAddress);</span>
<a href="#l19.63"></a><span id="l19.63" class="difflineminus">-  var card = aCard || GetCardForEmail(aEmailAddress).card;</span>
<a href="#l19.64"></a><span id="l19.64" class="difflineplus">+  var card = aCard || getCardForEmail(aEmailAddress).card;</span>
<a href="#l19.65"></a><span id="l19.65"> </span>
<a href="#l19.66"></a><span id="l19.66">   // If this address is one of the user's identities...</span>
<a href="#l19.67"></a><span id="l19.67">   if (identity) {</span>
<a href="#l19.68"></a><span id="l19.68">     // ...pick a localized version of the word &quot;Me&quot; appropriate to this</span>
<a href="#l19.69"></a><span id="l19.69">     // specific header; fall back to the version used by the &quot;to&quot; header</span>
<a href="#l19.70"></a><span id="l19.70">     // if nothing else is available.</span>
<a href="#l19.71"></a><span id="l19.71">     try {</span>
<a href="#l19.72"></a><span id="l19.72">       displayName = gMessengerBundle.getString(&quot;header&quot; + aContext + &quot;FieldMe&quot;);</span>
<a href="#l19.73"></a><span id="l19.73" class="difflineat">@@ -103,27 +107,27 @@ function FormatDisplayName(aEmailAddress</span>
<a href="#l19.74"></a><span id="l19.74">     // caused by a collected address using an e-mail address as display name.</span>
<a href="#l19.75"></a><span id="l19.75">   }</span>
<a href="#l19.76"></a><span id="l19.76"> </span>
<a href="#l19.77"></a><span id="l19.77">   return displayName;</span>
<a href="#l19.78"></a><span id="l19.78"> }</span>
<a href="#l19.79"></a><span id="l19.79"> </span>
<a href="#l19.80"></a><span id="l19.80"> /**</span>
<a href="#l19.81"></a><span id="l19.81">  * Format the display name from a list of addresses. First, try using</span>
<a href="#l19.82"></a><span id="l19.82" class="difflineminus">- * FormatDisplayName, then fall back to the header's display name or the</span>
<a href="#l19.83"></a><span id="l19.83" class="difflineplus">+ * formatDisplayName, then fall back to the header's display name or the</span>
<a href="#l19.84"></a><span id="l19.84">  * address.</span>
<a href="#l19.85"></a><span id="l19.85">  *</span>
<a href="#l19.86"></a><span id="l19.86">  * @param aHeaderValue  The decoded header value (e.g. mime2DecodedAuthor).</span>
<a href="#l19.87"></a><span id="l19.87">  * @param aContext      The context of the header field (e.g. &quot;to&quot;, &quot;from&quot;).</span>
<a href="#l19.88"></a><span id="l19.88">  * @return The formatted display name.</span>
<a href="#l19.89"></a><span id="l19.89">  */</span>
<a href="#l19.90"></a><span id="l19.90" class="difflineminus">-function FormatDisplayNameList(aHeaderValue, aContext) {</span>
<a href="#l19.91"></a><span id="l19.91" class="difflineplus">+function formatDisplayNameList(aHeaderValue, aContext) {</span>
<a href="#l19.92"></a><span id="l19.92">   let addresses = MailServices.headerParser.parseDecodedHeader(aHeaderValue);</span>
<a href="#l19.93"></a><span id="l19.93">   if (addresses.length &gt; 0) {</span>
<a href="#l19.94"></a><span id="l19.94" class="difflineminus">-    let displayName = FormatDisplayName(addresses[0].email,</span>
<a href="#l19.95"></a><span id="l19.95" class="difflineplus">+    let displayName = formatDisplayName(addresses[0].email,</span>
<a href="#l19.96"></a><span id="l19.96">                                         addresses[0].name, aContext);</span>
<a href="#l19.97"></a><span id="l19.97">     if (displayName)</span>
<a href="#l19.98"></a><span id="l19.98">       return displayName;</span>
<a href="#l19.99"></a><span id="l19.99"> </span>
<a href="#l19.100"></a><span id="l19.100">     // Construct default display.</span>
<a href="#l19.101"></a><span id="l19.101">     if (addresses[0].email) {</span>
<a href="#l19.102"></a><span id="l19.102">       return MailServices.headerParser</span>
<a href="#l19.103"></a><span id="l19.103">                          .makeMailboxObject(addresses[0].name,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1">rename from mail/base/modules/MailConsts.js</span>
<a href="#l20.2"></a><span id="l20.2">rename to mail/base/modules/MailConsts.jsm</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1">rename from mail/base/modules/mailInstrumentation.js</span>
<a href="#l21.2"></a><span id="l21.2">rename to mail/base/modules/MailInstrumentation.jsm</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineminus">--- a/mail/base/modules/mailInstrumentation.js</span>
<a href="#l21.4"></a><span id="l21.4" class="difflineplus">+++ b/mail/base/modules/MailInstrumentation.jsm</span>
<a href="#l21.5"></a><span id="l21.5" class="difflineat">@@ -3,29 +3,29 @@</span>
<a href="#l21.6"></a><span id="l21.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l21.7"></a><span id="l21.7"> </span>
<a href="#l21.8"></a><span id="l21.8"> /**</span>
<a href="#l21.9"></a><span id="l21.9">  * Thunderbird UI Instrumentation, currently just the account setup process.</span>
<a href="#l21.10"></a><span id="l21.10">  */</span>
<a href="#l21.11"></a><span id="l21.11"> </span>
<a href="#l21.12"></a><span id="l21.12"> /* :::::::: Constants and Helpers ::::::::::::::: */</span>
<a href="#l21.13"></a><span id="l21.13"> </span>
<a href="#l21.14"></a><span id="l21.14" class="difflineminus">-this.EXPORTED_SYMBOLS = [&quot;mailInstrumentationManager&quot;];</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineplus">+this.EXPORTED_SYMBOLS = [&quot;MailInstrumentation&quot;];</span>
<a href="#l21.16"></a><span id="l21.16"> </span>
<a href="#l21.17"></a><span id="l21.17"> var nsIMFNService = Ci.nsIMsgFolderNotificationService;</span>
<a href="#l21.18"></a><span id="l21.18"> </span>
<a href="#l21.19"></a><span id="l21.19"> ChromeUtils.import(&quot;resource:///modules/errUtils.js&quot;);</span>
<a href="#l21.20"></a><span id="l21.20"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l21.21"></a><span id="l21.21"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l21.22"></a><span id="l21.22"> </span>
<a href="#l21.23"></a><span id="l21.23"> Cu.importGlobalProperties([&quot;XMLHttpRequest&quot;]);</span>
<a href="#l21.24"></a><span id="l21.24"> </span>
<a href="#l21.25"></a><span id="l21.25"> /* :::::::: The Module ::::::::::::::: */</span>
<a href="#l21.26"></a><span id="l21.26"> </span>
<a href="#l21.27"></a><span id="l21.27" class="difflineminus">-var mailInstrumentationManager =</span>
<a href="#l21.28"></a><span id="l21.28" class="difflineplus">+var MailInstrumentation =</span>
<a href="#l21.29"></a><span id="l21.29"> {</span>
<a href="#l21.30"></a><span id="l21.30">   // JS object containing the current state object</span>
<a href="#l21.31"></a><span id="l21.31">   _currentState: null,</span>
<a href="#l21.32"></a><span id="l21.32"> </span>
<a href="#l21.33"></a><span id="l21.33">   /**</span>
<a href="#l21.34"></a><span id="l21.34">    * The string containing the JSON stringified representation of the last</span>
<a href="#l21.35"></a><span id="l21.35">    * state we uploaded.</span>
<a href="#l21.36"></a><span id="l21.36">    */</span>
<a href="#l21.37"></a><span id="l21.37" class="difflineat">@@ -34,46 +34,46 @@ var mailInstrumentationManager =</span>
<a href="#l21.38"></a><span id="l21.38">   // if true, need to remove ourselves as a folder notification listener</span>
<a href="#l21.39"></a><span id="l21.39">   _mfnListener: false,</span>
<a href="#l21.40"></a><span id="l21.40"> </span>
<a href="#l21.41"></a><span id="l21.41">   // if true, we need to remove our observers in uninit.</span>
<a href="#l21.42"></a><span id="l21.42">   _observersRegistered: false,</span>
<a href="#l21.43"></a><span id="l21.43"> </span>
<a href="#l21.44"></a><span id="l21.44">   observe: function (aSubject, aTopic, aState) {</span>
<a href="#l21.45"></a><span id="l21.45">     if (aTopic == &quot;mail:composeSendSucceeded&quot;)</span>
<a href="#l21.46"></a><span id="l21.46" class="difflineminus">-      mailInstrumentationManager.addEvent(&quot;msgSent&quot;, true);</span>
<a href="#l21.47"></a><span id="l21.47" class="difflineplus">+      MailInstrumentation.addEvent(&quot;msgSent&quot;, true);</span>
<a href="#l21.48"></a><span id="l21.48">     else if (aTopic == &quot;mail:setAsDefault&quot;)</span>
<a href="#l21.49"></a><span id="l21.49" class="difflineminus">-      mailInstrumentationManager.addEvent(&quot;setAsDefault&quot;, true);</span>
<a href="#l21.50"></a><span id="l21.50" class="difflineplus">+      MailInstrumentation.addEvent(&quot;setAsDefault&quot;, true);</span>
<a href="#l21.51"></a><span id="l21.51"> </span>
<a href="#l21.52"></a><span id="l21.52">   },</span>
<a href="#l21.53"></a><span id="l21.53">   msgAdded: function (aMsg) {</span>
<a href="#l21.54"></a><span id="l21.54">     MailServices.mfn.removeListener(this);</span>
<a href="#l21.55"></a><span id="l21.55">     this._mfnListener = false;</span>
<a href="#l21.56"></a><span id="l21.56" class="difflineminus">-    mailInstrumentationManager.addEvent(&quot;msgDownloaded&quot;, true);</span>
<a href="#l21.57"></a><span id="l21.57" class="difflineplus">+    MailInstrumentation.addEvent(&quot;msgDownloaded&quot;, true);</span>
<a href="#l21.58"></a><span id="l21.58">   },</span>
<a href="#l21.59"></a><span id="l21.59"> </span>
<a href="#l21.60"></a><span id="l21.60">   _accountsChanged: function() {</span>
<a href="#l21.61"></a><span id="l21.61">     // check if there are at least two accounts - one is local folders account</span>
<a href="#l21.62"></a><span id="l21.62">     if (Services.prefs.getCharPref(&quot;mail.accountmanager.accounts&quot;).includes(',', 1)) {</span>
<a href="#l21.63"></a><span id="l21.63" class="difflineminus">-      mailInstrumentationManager.addEvent(&quot;accountAdded&quot;, true);</span>
<a href="#l21.64"></a><span id="l21.64" class="difflineminus">-      mailInstrumentationManager._removeObserver(</span>
<a href="#l21.65"></a><span id="l21.65" class="difflineplus">+      MailInstrumentation.addEvent(&quot;accountAdded&quot;, true);</span>
<a href="#l21.66"></a><span id="l21.66" class="difflineplus">+      MailInstrumentation._removeObserver(</span>
<a href="#l21.67"></a><span id="l21.67">         &quot;mail.accountmanager.accounts&quot;,</span>
<a href="#l21.68"></a><span id="l21.68" class="difflineminus">-        mailInstrumentationManager._accountsChanged);</span>
<a href="#l21.69"></a><span id="l21.69" class="difflineplus">+        MailInstrumentation._accountsChanged);</span>
<a href="#l21.70"></a><span id="l21.70"> </span>
<a href="#l21.71"></a><span id="l21.71">     }</span>
<a href="#l21.72"></a><span id="l21.72">   },</span>
<a href="#l21.73"></a><span id="l21.73">   _smtpServerAdded: function() {</span>
<a href="#l21.74"></a><span id="l21.74" class="difflineminus">-    mailInstrumentationManager.addEvent(&quot;smtpServerAdded&quot;, true);</span>
<a href="#l21.75"></a><span id="l21.75" class="difflineminus">-    mailInstrumentationManager._removeObserver(&quot;mail.smtpservers&quot;,</span>
<a href="#l21.76"></a><span id="l21.76" class="difflineminus">-      mailInstrumentationManager._smtpServerAdded);</span>
<a href="#l21.77"></a><span id="l21.77" class="difflineplus">+    MailInstrumentation.addEvent(&quot;smtpServerAdded&quot;, true);</span>
<a href="#l21.78"></a><span id="l21.78" class="difflineplus">+    MailInstrumentation._removeObserver(&quot;mail.smtpservers&quot;,</span>
<a href="#l21.79"></a><span id="l21.79" class="difflineplus">+      MailInstrumentation._smtpServerAdded);</span>
<a href="#l21.80"></a><span id="l21.80">   },</span>
<a href="#l21.81"></a><span id="l21.81">   _userOptedIn: function() {</span>
<a href="#l21.82"></a><span id="l21.82">     try {</span>
<a href="#l21.83"></a><span id="l21.83">       if (Services.prefs.getBoolPref(&quot;mail.instrumentation.userOptedIn&quot;))</span>
<a href="#l21.84"></a><span id="l21.84" class="difflineminus">-        mailInstrumentationManager._postStateObject();</span>
<a href="#l21.85"></a><span id="l21.85" class="difflineplus">+        MailInstrumentation._postStateObject();</span>
<a href="#l21.86"></a><span id="l21.86">     } catch (ex) {logException(ex);}</span>
<a href="#l21.87"></a><span id="l21.87">   },</span>
<a href="#l21.88"></a><span id="l21.88"> </span>
<a href="#l21.89"></a><span id="l21.89">   /**</span>
<a href="#l21.90"></a><span id="l21.90">    * Loads the last saved state. This should only be called by</span>
<a href="#l21.91"></a><span id="l21.91">    * _init and a unit test.</span>
<a href="#l21.92"></a><span id="l21.92">    */</span>
<a href="#l21.93"></a><span id="l21.93">   _loadState: function minst_loadState() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1">rename from mail/base/modules/mailMigrator.js</span>
<a href="#l22.2"></a><span id="l22.2">rename to mail/base/modules/MailMigrator.jsm</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/mail/base/modules/MailUtils.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/mail/base/modules/MailUtils.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -1,386 +1,14 @@</span>
<a href="#l23.4"></a><span id="l23.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l23.5"></a><span id="l23.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l23.6"></a><span id="l23.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l23.7"></a><span id="l23.7"> </span>
<a href="#l23.8"></a><span id="l23.8"> var EXPORTED_SYMBOLS = [&quot;MailUtils&quot;];</span>
<a href="#l23.9"></a><span id="l23.9"> </span>
<a href="#l23.10"></a><span id="l23.10" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l23.11"></a><span id="l23.11" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailConsts.js&quot;);</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l23.14"></a><span id="l23.14" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l23.15"></a><span id="l23.15" class="difflineminus">-</span>
<a href="#l23.16"></a><span id="l23.16" class="difflineminus">-var MC = MailConsts;</span>
<a href="#l23.17"></a><span id="l23.17" class="difflineminus">-</span>
<a href="#l23.18"></a><span id="l23.18" class="difflineminus">-/**</span>
<a href="#l23.19"></a><span id="l23.19" class="difflineminus">- * This module has several utility functions for use by both core and</span>
<a href="#l23.20"></a><span id="l23.20" class="difflineminus">- * third-party code. Some functions are aimed at code that doesn't have a</span>
<a href="#l23.21"></a><span id="l23.21" class="difflineminus">- * window context, while others can be used anywhere.</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineminus">- */</span>
<a href="#l23.23"></a><span id="l23.23" class="difflineminus">-var MailUtils =</span>
<a href="#l23.24"></a><span id="l23.24" class="difflineminus">-{</span>
<a href="#l23.25"></a><span id="l23.25" class="difflineminus">-  /**</span>
<a href="#l23.26"></a><span id="l23.26" class="difflineminus">-   * Discover all folders. This is useful during startup, when you have code</span>
<a href="#l23.27"></a><span id="l23.27" class="difflineminus">-   * that deals with folders and that executes before the main 3pane window is</span>
<a href="#l23.28"></a><span id="l23.28" class="difflineminus">-   * open (the folder tree wouldn't have been initialized yet).</span>
<a href="#l23.29"></a><span id="l23.29" class="difflineminus">-   */</span>
<a href="#l23.30"></a><span id="l23.30" class="difflineminus">-  discoverFolders: function MailUtils_discoverFolders() {</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineminus">-    let servers = MailServices.accounts.allServers;</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineminus">-    for (let server of fixIterator(servers, Ci.nsIMsgIncomingServer)) {</span>
<a href="#l23.33"></a><span id="l23.33" class="difflineminus">-      // Bug 466311 Sometimes this can throw file not found, we're unsure</span>
<a href="#l23.34"></a><span id="l23.34" class="difflineminus">-      // why, but catch it and log the fact.</span>
<a href="#l23.35"></a><span id="l23.35" class="difflineminus">-      try {</span>
<a href="#l23.36"></a><span id="l23.36" class="difflineminus">-        server.rootFolder.subFolders;</span>
<a href="#l23.37"></a><span id="l23.37" class="difflineminus">-      }</span>
<a href="#l23.38"></a><span id="l23.38" class="difflineminus">-      catch (ex) {</span>
<a href="#l23.39"></a><span id="l23.39" class="difflineminus">-        Services.console.logStringMessage(&quot;Discovering folders for account failed with &quot; +</span>
<a href="#l23.40"></a><span id="l23.40" class="difflineminus">-                                          &quot;exception: &quot; + ex);</span>
<a href="#l23.41"></a><span id="l23.41" class="difflineminus">-      }</span>
<a href="#l23.42"></a><span id="l23.42" class="difflineminus">-    }</span>
<a href="#l23.43"></a><span id="l23.43" class="difflineminus">-  },</span>
<a href="#l23.44"></a><span id="l23.44" class="difflineminus">-</span>
<a href="#l23.45"></a><span id="l23.45" class="difflineminus">-  /**</span>
<a href="#l23.46"></a><span id="l23.46" class="difflineminus">-   * Get the nsIMsgFolder corresponding to this file. This just looks at all</span>
<a href="#l23.47"></a><span id="l23.47" class="difflineminus">-   * folders and does a direct match.</span>
<a href="#l23.48"></a><span id="l23.48" class="difflineminus">-   *</span>
<a href="#l23.49"></a><span id="l23.49" class="difflineminus">-   * One of the places this is used is desktop search integration -- to open</span>
<a href="#l23.50"></a><span id="l23.50" class="difflineminus">-   * the search result corresponding to a mozeml/wdseml file, we need to figure</span>
<a href="#l23.51"></a><span id="l23.51" class="difflineminus">-   * out the folder using the file's path.</span>
<a href="#l23.52"></a><span id="l23.52" class="difflineminus">-   *</span>
<a href="#l23.53"></a><span id="l23.53" class="difflineminus">-   * @param aFile the nsIFile to convert to a folder</span>
<a href="#l23.54"></a><span id="l23.54" class="difflineminus">-   * @returns the nsIMsgFolder corresponding to aFile, or null if the folder</span>
<a href="#l23.55"></a><span id="l23.55" class="difflineminus">-   *          isn't found</span>
<a href="#l23.56"></a><span id="l23.56" class="difflineminus">-   */</span>
<a href="#l23.57"></a><span id="l23.57" class="difflineminus">-  getFolderForFileInProfile:</span>
<a href="#l23.58"></a><span id="l23.58" class="difflineminus">-      function MailUtils_getFolderForFileInProfile(aFile) {</span>
<a href="#l23.59"></a><span id="l23.59" class="difflineminus">-    let folders = MailServices.accounts.allFolders;</span>
<a href="#l23.60"></a><span id="l23.60" class="difflineminus">-</span>
<a href="#l23.61"></a><span id="l23.61" class="difflineminus">-    for (let folder of fixIterator(folders, Ci.nsIMsgFolder)) {</span>
<a href="#l23.62"></a><span id="l23.62" class="difflineminus">-      if (folder.filePath.equals(aFile))</span>
<a href="#l23.63"></a><span id="l23.63" class="difflineminus">-        return folder;</span>
<a href="#l23.64"></a><span id="l23.64" class="difflineminus">-    }</span>
<a href="#l23.65"></a><span id="l23.65" class="difflineminus">-    return null;</span>
<a href="#l23.66"></a><span id="l23.66" class="difflineminus">-  },</span>
<a href="#l23.67"></a><span id="l23.67" class="difflineminus">-</span>
<a href="#l23.68"></a><span id="l23.68" class="difflineminus">-  /**</span>
<a href="#l23.69"></a><span id="l23.69" class="difflineminus">-   * Get the nsIMsgFolder corresponding to this URI. This uses the RDF service</span>
<a href="#l23.70"></a><span id="l23.70" class="difflineminus">-   * to do the work.</span>
<a href="#l23.71"></a><span id="l23.71" class="difflineminus">-   *</span>
<a href="#l23.72"></a><span id="l23.72" class="difflineminus">-   * @param aFolderURI the URI to convert into a folder</span>
<a href="#l23.73"></a><span id="l23.73" class="difflineminus">-   * @param aCheckFolderAttributes whether to check that the folder either has</span>
<a href="#l23.74"></a><span id="l23.74" class="difflineminus">-   *                              a parent or isn't a server</span>
<a href="#l23.75"></a><span id="l23.75" class="difflineminus">-   * @returns the nsIMsgFolder corresponding to this URI, or null if</span>
<a href="#l23.76"></a><span id="l23.76" class="difflineminus">-   *          aCheckFolderAttributes is true and the folder doesn't have a</span>
<a href="#l23.77"></a><span id="l23.77" class="difflineminus">-   *          parent or is a server</span>
<a href="#l23.78"></a><span id="l23.78" class="difflineminus">-   */</span>
<a href="#l23.79"></a><span id="l23.79" class="difflineminus">-  getFolderForURI: function MailUtils_getFolderForURI(aFolderURI,</span>
<a href="#l23.80"></a><span id="l23.80" class="difflineminus">-                       aCheckFolderAttributes) {</span>
<a href="#l23.81"></a><span id="l23.81" class="difflineminus">-    let folder = null;</span>
<a href="#l23.82"></a><span id="l23.82" class="difflineminus">-    let rdfService = Cc['@mozilla.org/rdf/rdf-service;1']</span>
<a href="#l23.83"></a><span id="l23.83" class="difflineminus">-                       .getService(Ci.nsIRDFService);</span>
<a href="#l23.84"></a><span id="l23.84" class="difflineminus">-    folder = rdfService.GetResource(aFolderURI);</span>
<a href="#l23.85"></a><span id="l23.85" class="difflineminus">-    // This is going to QI the folder to an nsIMsgFolder as well</span>
<a href="#l23.86"></a><span id="l23.86" class="difflineminus">-    if (folder &amp;&amp; folder instanceof Ci.nsIMsgFolder) {</span>
<a href="#l23.87"></a><span id="l23.87" class="difflineminus">-      if (aCheckFolderAttributes &amp;&amp; !(folder.parent || folder.isServer))</span>
<a href="#l23.88"></a><span id="l23.88" class="difflineminus">-        return null;</span>
<a href="#l23.89"></a><span id="l23.89" class="difflineminus">-    }</span>
<a href="#l23.90"></a><span id="l23.90" class="difflineminus">-    else {</span>
<a href="#l23.91"></a><span id="l23.91" class="difflineminus">-      return null;</span>
<a href="#l23.92"></a><span id="l23.92" class="difflineminus">-    }</span>
<a href="#l23.93"></a><span id="l23.93" class="difflineminus">-</span>
<a href="#l23.94"></a><span id="l23.94" class="difflineminus">-    return folder;</span>
<a href="#l23.95"></a><span id="l23.95" class="difflineminus">-  },</span>
<a href="#l23.96"></a><span id="l23.96" class="difflineminus">-</span>
<a href="#l23.97"></a><span id="l23.97" class="difflineminus">-  /**</span>
<a href="#l23.98"></a><span id="l23.98" class="difflineminus">-   * Display this message header in a new tab, a new window or an existing</span>
<a href="#l23.99"></a><span id="l23.99" class="difflineminus">-   * window, depending on the preference and whether a 3pane or standalone</span>
<a href="#l23.100"></a><span id="l23.100" class="difflineminus">-   * window is already open. This function should be called when you'd like to</span>
<a href="#l23.101"></a><span id="l23.101" class="difflineminus">-   * display a message to the user according to the pref set.</span>
<a href="#l23.102"></a><span id="l23.102" class="difflineminus">-   *</span>
<a href="#l23.103"></a><span id="l23.103" class="difflineminus">-   * @note Do not use this if you want to open multiple messages at once. Use</span>
<a href="#l23.104"></a><span id="l23.104" class="difflineminus">-   *       |displayMessages| instead.</span>
<a href="#l23.105"></a><span id="l23.105" class="difflineminus">-   *</span>
<a href="#l23.106"></a><span id="l23.106" class="difflineminus">-   * @param aMsgHdr the message header to display</span>
<a href="#l23.107"></a><span id="l23.107" class="difflineminus">-   * @param [aViewWrapperToClone] a view wrapper to clone. If null or not</span>
<a href="#l23.108"></a><span id="l23.108" class="difflineminus">-   *                              given, the message header's folder's default</span>
<a href="#l23.109"></a><span id="l23.109" class="difflineminus">-   *                              view will be used</span>
<a href="#l23.110"></a><span id="l23.110" class="difflineminus">-   * @param [aTabmail] a tabmail element to use in case we need to open tabs.</span>
<a href="#l23.111"></a><span id="l23.111" class="difflineminus">-   *                   If null or not given:</span>
<a href="#l23.112"></a><span id="l23.112" class="difflineminus">-   *                   - if one or more 3pane windows are open, the most recent</span>
<a href="#l23.113"></a><span id="l23.113" class="difflineminus">-   *                     one's tabmail is used</span>
<a href="#l23.114"></a><span id="l23.114" class="difflineminus">-   *                   - if no 3pane windows are open, a standalone window is</span>
<a href="#l23.115"></a><span id="l23.115" class="difflineminus">-   *                     opened instead of a tab</span>
<a href="#l23.116"></a><span id="l23.116" class="difflineminus">-   */</span>
<a href="#l23.117"></a><span id="l23.117" class="difflineminus">-  displayMessage: function MailUtils_displayMessage(aMsgHdr,</span>
<a href="#l23.118"></a><span id="l23.118" class="difflineminus">-                      aViewWrapperToClone, aTabmail) {</span>
<a href="#l23.119"></a><span id="l23.119" class="difflineminus">-    this.displayMessages([aMsgHdr], aViewWrapperToClone, aTabmail);</span>
<a href="#l23.120"></a><span id="l23.120" class="difflineminus">-  },</span>
<a href="#l23.121"></a><span id="l23.121" class="difflineminus">-</span>
<a href="#l23.122"></a><span id="l23.122" class="difflineminus">-  /**</span>
<a href="#l23.123"></a><span id="l23.123" class="difflineminus">-   * Display the warning if the number of messages to be displayed is greater than</span>
<a href="#l23.124"></a><span id="l23.124" class="difflineminus">-   * the limit set in preferences.</span>
<a href="#l23.125"></a><span id="l23.125" class="difflineminus">-   * @param aNumMessages: number of messages to be displayed</span>
<a href="#l23.126"></a><span id="l23.126" class="difflineminus">-   * @param aConfirmTitle: title ID</span>
<a href="#l23.127"></a><span id="l23.127" class="difflineminus">-   * @param aConfirmMsg: message ID</span>
<a href="#l23.128"></a><span id="l23.128" class="difflineminus">-   * @param aLiitingPref: the name of the pref to retrieve the limit from</span>
<a href="#l23.129"></a><span id="l23.129" class="difflineminus">-   */</span>
<a href="#l23.130"></a><span id="l23.130" class="difflineminus">-  confirmAction: function (aNumMessages, aConfirmTitle, aConfirmMsg, aLimitingPref) {</span>
<a href="#l23.131"></a><span id="l23.131" class="difflineminus">-    let openWarning = Services.prefs.getIntPref(aLimitingPref);</span>
<a href="#l23.132"></a><span id="l23.132" class="difflineminus">-    if ((openWarning &gt; 1) &amp;&amp; (aNumMessages &gt;= openWarning)) {</span>
<a href="#l23.133"></a><span id="l23.133" class="difflineminus">-      let bundle = Services.strings.createBundle(</span>
<a href="#l23.134"></a><span id="l23.134" class="difflineminus">-        &quot;chrome://messenger/locale/messenger.properties&quot;);</span>
<a href="#l23.135"></a><span id="l23.135" class="difflineminus">-      let title = bundle.GetStringFromName(aConfirmTitle);</span>
<a href="#l23.136"></a><span id="l23.136" class="difflineminus">-      let message = PluralForm.get(aNumMessages,</span>
<a href="#l23.137"></a><span id="l23.137" class="difflineminus">-        bundle.GetStringFromName(aConfirmMsg))</span>
<a href="#l23.138"></a><span id="l23.138" class="difflineminus">-                .replace(&quot;#1&quot;, aNumMessages);</span>
<a href="#l23.139"></a><span id="l23.139" class="difflineminus">-      if (!Services.prompt.confirm(null, title, message))</span>
<a href="#l23.140"></a><span id="l23.140" class="difflineminus">-        return true;</span>
<a href="#l23.141"></a><span id="l23.141" class="difflineminus">-    }</span>
<a href="#l23.142"></a><span id="l23.142" class="difflineminus">-    return false;</span>
<a href="#l23.143"></a><span id="l23.143" class="difflineminus">-  },</span>
<a href="#l23.144"></a><span id="l23.144" class="difflineminus">-  /**</span>
<a href="#l23.145"></a><span id="l23.145" class="difflineminus">-   * Display these message headers in new tabs, new windows or existing</span>
<a href="#l23.146"></a><span id="l23.146" class="difflineminus">-   * windows, depending on the preference, the number of messages, and whether</span>
<a href="#l23.147"></a><span id="l23.147" class="difflineminus">-   * a 3pane or standalone window is already open. This function should be</span>
<a href="#l23.148"></a><span id="l23.148" class="difflineminus">-   * called when you'd like to display multiple messages to the user according</span>
<a href="#l23.149"></a><span id="l23.149" class="difflineminus">-   * to the pref set.</span>
<a href="#l23.150"></a><span id="l23.150" class="difflineminus">-   *</span>
<a href="#l23.151"></a><span id="l23.151" class="difflineminus">-   * @param aMsgHdrs an array containing the message headers to display. The</span>
<a href="#l23.152"></a><span id="l23.152" class="difflineminus">-   *                 array should contain at least one message header</span>
<a href="#l23.153"></a><span id="l23.153" class="difflineminus">-   * @param [aViewWrapperToClone] a DB view wrapper to clone for each of the</span>
<a href="#l23.154"></a><span id="l23.154" class="difflineminus">-   *                              tabs or windows</span>
<a href="#l23.155"></a><span id="l23.155" class="difflineminus">-   * @param [aTabmail] a tabmail element to use in case we need to open tabs.</span>
<a href="#l23.156"></a><span id="l23.156" class="difflineminus">-   *                   If given, the window containing the tabmail is assumed</span>
<a href="#l23.157"></a><span id="l23.157" class="difflineminus">-   *                   to be in front. If null or not given:</span>
<a href="#l23.158"></a><span id="l23.158" class="difflineminus">-   *                   - if one or more 3pane windows are open, the most recent</span>
<a href="#l23.159"></a><span id="l23.159" class="difflineminus">-   *                     one's tabmail is used, and the window is brought to the</span>
<a href="#l23.160"></a><span id="l23.160" class="difflineminus">-   *                     front</span>
<a href="#l23.161"></a><span id="l23.161" class="difflineminus">-   *                   - if no 3pane windows are open, standalone windows are</span>
<a href="#l23.162"></a><span id="l23.162" class="difflineminus">-   *                     opened instead of tabs</span>
<a href="#l23.163"></a><span id="l23.163" class="difflineminus">-   */</span>
<a href="#l23.164"></a><span id="l23.164" class="difflineminus">-  displayMessages: function MailUtils_displayMessages(aMsgHdrs,</span>
<a href="#l23.165"></a><span id="l23.165" class="difflineminus">-                       aViewWrapperToClone, aTabmail) {</span>
<a href="#l23.166"></a><span id="l23.166" class="difflineminus">-    let openMessageBehavior = Services.prefs.getIntPref(</span>
<a href="#l23.167"></a><span id="l23.167" class="difflineminus">-                                  &quot;mail.openMessageBehavior&quot;);</span>
<a href="#l23.168"></a><span id="l23.168" class="difflineminus">-</span>
<a href="#l23.169"></a><span id="l23.169" class="difflineminus">-    if (openMessageBehavior == MC.OpenMessageBehavior.NEW_WINDOW) {</span>
<a href="#l23.170"></a><span id="l23.170" class="difflineminus">-      this.openMessagesInNewWindows(aMsgHdrs, aViewWrapperToClone);</span>
<a href="#l23.171"></a><span id="l23.171" class="difflineminus">-    }</span>
<a href="#l23.172"></a><span id="l23.172" class="difflineminus">-    else if (openMessageBehavior == MC.OpenMessageBehavior.EXISTING_WINDOW) {</span>
<a href="#l23.173"></a><span id="l23.173" class="difflineminus">-      // Try reusing an existing window. If we can't, fall back to opening new</span>
<a href="#l23.174"></a><span id="l23.174" class="difflineminus">-      // windows</span>
<a href="#l23.175"></a><span id="l23.175" class="difflineminus">-      if (aMsgHdrs.length &gt; 1 || !this.openMessageInExistingWindow(aMsgHdrs[0]))</span>
<a href="#l23.176"></a><span id="l23.176" class="difflineminus">-        this.openMessagesInNewWindows(aMsgHdrs, aViewWrapperToClone);</span>
<a href="#l23.177"></a><span id="l23.177" class="difflineminus">-    }</span>
<a href="#l23.178"></a><span id="l23.178" class="difflineminus">-    else if (openMessageBehavior == MC.OpenMessageBehavior.NEW_TAB) {</span>
<a href="#l23.179"></a><span id="l23.179" class="difflineminus">-      let mail3PaneWindow = null;</span>
<a href="#l23.180"></a><span id="l23.180" class="difflineminus">-      if (!aTabmail) {</span>
<a href="#l23.181"></a><span id="l23.181" class="difflineminus">-        // Try opening new tabs in a 3pane window</span>
<a href="#l23.182"></a><span id="l23.182" class="difflineminus">-        mail3PaneWindow = Services.wm.getMostRecentWindow(&quot;mail:3pane&quot;);</span>
<a href="#l23.183"></a><span id="l23.183" class="difflineminus">-        if (mail3PaneWindow)</span>
<a href="#l23.184"></a><span id="l23.184" class="difflineminus">-          aTabmail = mail3PaneWindow.document.getElementById(&quot;tabmail&quot;);</span>
<a href="#l23.185"></a><span id="l23.185" class="difflineminus">-      }</span>
<a href="#l23.186"></a><span id="l23.186" class="difflineminus">-</span>
<a href="#l23.187"></a><span id="l23.187" class="difflineminus">-      if (aTabmail) {</span>
<a href="#l23.188"></a><span id="l23.188" class="difflineminus">-        if (this.confirmAction(aMsgHdrs.length, &quot;openTabWarningTitle&quot;,</span>
<a href="#l23.189"></a><span id="l23.189" class="difflineminus">-                               &quot;openTabWarningConfirmation&quot;,</span>
<a href="#l23.190"></a><span id="l23.190" class="difflineminus">-                               &quot;mailnews.open_tab_warning&quot;))</span>
<a href="#l23.191"></a><span id="l23.191" class="difflineminus">-          return;</span>
<a href="#l23.192"></a><span id="l23.192" class="difflineminus">-        for (let [i, msgHdr] of aMsgHdrs.entries())</span>
<a href="#l23.193"></a><span id="l23.193" class="difflineminus">-          // Open all the tabs in the background, except for the last one</span>
<a href="#l23.194"></a><span id="l23.194" class="difflineminus">-          aTabmail.openTab(&quot;message&quot;, {msgHdr: msgHdr,</span>
<a href="#l23.195"></a><span id="l23.195" class="difflineminus">-              viewWrapperToClone: aViewWrapperToClone,</span>
<a href="#l23.196"></a><span id="l23.196" class="difflineminus">-              background: (i &lt; (aMsgHdrs.length - 1)),</span>
<a href="#l23.197"></a><span id="l23.197" class="difflineminus">-              disregardOpener: (aMsgHdrs.length &gt; 1),</span>
<a href="#l23.198"></a><span id="l23.198" class="difflineminus">-          });</span>
<a href="#l23.199"></a><span id="l23.199" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l23.200"></a><span id="l23.200"> </span>
<a href="#l23.201"></a><span id="l23.201" class="difflineminus">-        if (mail3PaneWindow)</span>
<a href="#l23.202"></a><span id="l23.202" class="difflineminus">-          mail3PaneWindow.focus();</span>
<a href="#l23.203"></a><span id="l23.203" class="difflineminus">-      }</span>
<a href="#l23.204"></a><span id="l23.204" class="difflineminus">-      else {</span>
<a href="#l23.205"></a><span id="l23.205" class="difflineminus">-        // We still haven't found a tabmail, so we'll need to open new windows</span>
<a href="#l23.206"></a><span id="l23.206" class="difflineminus">-        this.openMessagesInNewWindows(aMsgHdrs, aViewWrapperToClone);</span>
<a href="#l23.207"></a><span id="l23.207" class="difflineminus">-      }</span>
<a href="#l23.208"></a><span id="l23.208" class="difflineminus">-    }</span>
<a href="#l23.209"></a><span id="l23.209" class="difflineminus">-  },</span>
<a href="#l23.210"></a><span id="l23.210" class="difflineminus">-</span>
<a href="#l23.211"></a><span id="l23.211" class="difflineminus">-  /**</span>
<a href="#l23.212"></a><span id="l23.212" class="difflineminus">-   * Show this message in an existing window.</span>
<a href="#l23.213"></a><span id="l23.213" class="difflineminus">-   *</span>
<a href="#l23.214"></a><span id="l23.214" class="difflineminus">-   * @param aMsgHdr the message header to display</span>
<a href="#l23.215"></a><span id="l23.215" class="difflineminus">-   * @param [aViewWrapperToClone] a DB view wrapper to clone for the message</span>
<a href="#l23.216"></a><span id="l23.216" class="difflineminus">-   *                              window</span>
<a href="#l23.217"></a><span id="l23.217" class="difflineminus">-   * @returns true if an existing window was found and the message header was</span>
<a href="#l23.218"></a><span id="l23.218" class="difflineminus">-   *          displayed, false otherwise</span>
<a href="#l23.219"></a><span id="l23.219" class="difflineminus">-   */</span>
<a href="#l23.220"></a><span id="l23.220" class="difflineminus">-  openMessageInExistingWindow:</span>
<a href="#l23.221"></a><span id="l23.221" class="difflineminus">-      function MailUtils_openMessageInExistingWindow(aMsgHdr,</span>
<a href="#l23.222"></a><span id="l23.222" class="difflineminus">-                                                     aViewWrapperToClone) {</span>
<a href="#l23.223"></a><span id="l23.223" class="difflineminus">-    let messageWindow = Services.wm.getMostRecentWindow(&quot;mail:messageWindow&quot;);</span>
<a href="#l23.224"></a><span id="l23.224" class="difflineminus">-    if (messageWindow) {</span>
<a href="#l23.225"></a><span id="l23.225" class="difflineminus">-      messageWindow.displayMessage(aMsgHdr, aViewWrapperToClone);</span>
<a href="#l23.226"></a><span id="l23.226" class="difflineminus">-      return true;</span>
<a href="#l23.227"></a><span id="l23.227" class="difflineminus">-    }</span>
<a href="#l23.228"></a><span id="l23.228" class="difflineminus">-    return false;</span>
<a href="#l23.229"></a><span id="l23.229" class="difflineminus">-  },</span>
<a href="#l23.230"></a><span id="l23.230" class="difflineminus">-</span>
<a href="#l23.231"></a><span id="l23.231" class="difflineminus">-  /**</span>
<a href="#l23.232"></a><span id="l23.232" class="difflineminus">-   * Open a new standalone message window with this header.</span>
<a href="#l23.233"></a><span id="l23.233" class="difflineminus">-   *</span>
<a href="#l23.234"></a><span id="l23.234" class="difflineminus">-   * @param aMsgHdr the message header to display</span>
<a href="#l23.235"></a><span id="l23.235" class="difflineminus">-   * @param [aViewWrapperToClone] a DB view wrapper to clone for the message</span>
<a href="#l23.236"></a><span id="l23.236" class="difflineminus">-   *                              window</span>
<a href="#l23.237"></a><span id="l23.237" class="difflineminus">-   */</span>
<a href="#l23.238"></a><span id="l23.238" class="difflineminus">-  openMessageInNewWindow:</span>
<a href="#l23.239"></a><span id="l23.239" class="difflineminus">-      function MailUtils_openMessageInNewWindow(aMsgHdr, aViewWrapperToClone) {</span>
<a href="#l23.240"></a><span id="l23.240" class="difflineminus">-    // It sucks that we have to go through XPCOM for this</span>
<a href="#l23.241"></a><span id="l23.241" class="difflineminus">-    let args = {msgHdr: aMsgHdr, viewWrapperToClone: aViewWrapperToClone};</span>
<a href="#l23.242"></a><span id="l23.242" class="difflineminus">-    args.wrappedJSObject = args;</span>
<a href="#l23.243"></a><span id="l23.243" class="difflineminus">-</span>
<a href="#l23.244"></a><span id="l23.244" class="difflineminus">-    Services.ww.openWindow(null,</span>
<a href="#l23.245"></a><span id="l23.245" class="difflineminus">-        &quot;chrome://messenger/content/messageWindow.xul&quot;, &quot;&quot;,</span>
<a href="#l23.246"></a><span id="l23.246" class="difflineminus">-        &quot;all,chrome,dialog=no,status,toolbar&quot;, args);</span>
<a href="#l23.247"></a><span id="l23.247" class="difflineminus">-  },</span>
<a href="#l23.248"></a><span id="l23.248" class="difflineminus">-</span>
<a href="#l23.249"></a><span id="l23.249" class="difflineminus">-  /**</span>
<a href="#l23.250"></a><span id="l23.250" class="difflineminus">-   * Open new standalone message windows for these headers. This will prompt</span>
<a href="#l23.251"></a><span id="l23.251" class="difflineminus">-   * for confirmation if the number of windows to be opened is greater than the</span>
<a href="#l23.252"></a><span id="l23.252" class="difflineminus">-   * value of the mailnews.open_window_warning preference.</span>
<a href="#l23.253"></a><span id="l23.253" class="difflineminus">-   *</span>
<a href="#l23.254"></a><span id="l23.254" class="difflineminus">-   * @param aMsgHdrs an array containing the message headers to display</span>
<a href="#l23.255"></a><span id="l23.255" class="difflineminus">-   * @param [aViewWrapperToClone] a DB view wrapper to clone for each message</span>
<a href="#l23.256"></a><span id="l23.256" class="difflineminus">-   *                              window</span>
<a href="#l23.257"></a><span id="l23.257" class="difflineminus">-   */</span>
<a href="#l23.258"></a><span id="l23.258" class="difflineminus">-   openMessagesInNewWindows:</span>
<a href="#l23.259"></a><span id="l23.259" class="difflineminus">-       function MailUtils_openMessagesInNewWindows(aMsgHdrs,</span>
<a href="#l23.260"></a><span id="l23.260" class="difflineminus">-                                                   aViewWrapperToClone) {</span>
<a href="#l23.261"></a><span id="l23.261" class="difflineminus">-    if (this.confirmAction(aMsgHdrs.length, &quot;openWindowWarningTitle&quot;,</span>
<a href="#l23.262"></a><span id="l23.262" class="difflineminus">-                           &quot;openWindowWarningConfirmation&quot;,</span>
<a href="#l23.263"></a><span id="l23.263" class="difflineminus">-                           &quot;mailnews.open_window_warning&quot;))</span>
<a href="#l23.264"></a><span id="l23.264" class="difflineminus">-      return;</span>
<a href="#l23.265"></a><span id="l23.265" class="difflineminus">-</span>
<a href="#l23.266"></a><span id="l23.266" class="difflineminus">-    for (let msgHdr of aMsgHdrs)</span>
<a href="#l23.267"></a><span id="l23.267" class="difflineminus">-      this.openMessageInNewWindow(msgHdr, aViewWrapperToClone);</span>
<a href="#l23.268"></a><span id="l23.268" class="difflineminus">-  },</span>
<a href="#l23.269"></a><span id="l23.269" class="difflineminus">-</span>
<a href="#l23.270"></a><span id="l23.270" class="difflineminus">-  /**</span>
<a href="#l23.271"></a><span id="l23.271" class="difflineminus">-   * Display this message header in a folder tab in a 3pane window. This is</span>
<a href="#l23.272"></a><span id="l23.272" class="difflineminus">-   * useful when the message needs to be displayed in the context of its folder</span>
<a href="#l23.273"></a><span id="l23.273" class="difflineminus">-   * or thread.</span>
<a href="#l23.274"></a><span id="l23.274" class="difflineminus">-   *</span>
<a href="#l23.275"></a><span id="l23.275" class="difflineminus">-   * @param aMsgHdr the message header to display</span>
<a href="#l23.276"></a><span id="l23.276" class="difflineminus">-   */</span>
<a href="#l23.277"></a><span id="l23.277" class="difflineminus">-  displayMessageInFolderTab: function MailUtils_displayMessageInFolderTab(</span>
<a href="#l23.278"></a><span id="l23.278" class="difflineminus">-                                 aMsgHdr) {</span>
<a href="#l23.279"></a><span id="l23.279" class="difflineminus">-    // Try opening new tabs in a 3pane window</span>
<a href="#l23.280"></a><span id="l23.280" class="difflineminus">-    let mail3PaneWindow = Services.wm.getMostRecentWindow(&quot;mail:3pane&quot;);</span>
<a href="#l23.281"></a><span id="l23.281" class="difflineminus">-    if (mail3PaneWindow) {</span>
<a href="#l23.282"></a><span id="l23.282" class="difflineminus">-      mail3PaneWindow.MsgDisplayMessageInFolderTab(aMsgHdr);</span>
<a href="#l23.283"></a><span id="l23.283" class="difflineminus">-    }</span>
<a href="#l23.284"></a><span id="l23.284" class="difflineminus">-    else {</span>
<a href="#l23.285"></a><span id="l23.285" class="difflineminus">-      let args = {msgHdr: aMsgHdr};</span>
<a href="#l23.286"></a><span id="l23.286" class="difflineminus">-      args.wrappedJSObject = args;</span>
<a href="#l23.287"></a><span id="l23.287" class="difflineminus">-      Services.ww.openWindow(null,</span>
<a href="#l23.288"></a><span id="l23.288" class="difflineminus">-          &quot;chrome://messenger/content/&quot;, &quot;&quot;,</span>
<a href="#l23.289"></a><span id="l23.289" class="difflineminus">-          &quot;all,chrome,dialog=no,status,toolbar&quot;, args);</span>
<a href="#l23.290"></a><span id="l23.290" class="difflineminus">-    }</span>
<a href="#l23.291"></a><span id="l23.291" class="difflineminus">-  },</span>
<a href="#l23.292"></a><span id="l23.292" class="difflineminus">-</span>
<a href="#l23.293"></a><span id="l23.293" class="difflineminus">-  /**</span>
<a href="#l23.294"></a><span id="l23.294" class="difflineminus">-   * The number of milliseconds to wait between loading of folders in</span>
<a href="#l23.295"></a><span id="l23.295" class="difflineminus">-   * |setStringPropertyOnFolderAndDescendents|.  We wait at all because</span>
<a href="#l23.296"></a><span id="l23.296" class="difflineminus">-   * opening msf databases is a potentially expensive synchronous operation that</span>
<a href="#l23.297"></a><span id="l23.297" class="difflineminus">-   * can approach the order of a second in pathological cases like gmail's</span>
<a href="#l23.298"></a><span id="l23.298" class="difflineminus">-   * all mail folder.</span>
<a href="#l23.299"></a><span id="l23.299" class="difflineminus">-   *</span>
<a href="#l23.300"></a><span id="l23.300" class="difflineminus">-   * If we did not use a timer or otherwise spin the event loop we would</span>
<a href="#l23.301"></a><span id="l23.301" class="difflineminus">-   * completely lock up the UI.  In theory we would still maintain some degree</span>
<a href="#l23.302"></a><span id="l23.302" class="difflineminus">-   * of UI responsiveness if we just used postMessage to break up our work so</span>
<a href="#l23.303"></a><span id="l23.303" class="difflineminus">-   * that the event loop still got a chance to run between our folder openings.</span>
<a href="#l23.304"></a><span id="l23.304" class="difflineminus">-   * The use of any delay between processing folders is to try and avoid causing</span>
<a href="#l23.305"></a><span id="l23.305" class="difflineminus">-   * system-wide interactivity problems from dominating the system's available</span>
<a href="#l23.306"></a><span id="l23.306" class="difflineminus">-   * disk seeks to such an extent that other applications start experiencing</span>
<a href="#l23.307"></a><span id="l23.307" class="difflineminus">-   * non-trivial I/O waits.</span>
<a href="#l23.308"></a><span id="l23.308" class="difflineminus">-   *</span>
<a href="#l23.309"></a><span id="l23.309" class="difflineminus">-   * The specific choice of delay remains an arbitrary one to maintain app</span>
<a href="#l23.310"></a><span id="l23.310" class="difflineminus">-   * and system responsiveness per the above while also processing as many</span>
<a href="#l23.311"></a><span id="l23.311" class="difflineminus">-   * folders as quickly as possible.</span>
<a href="#l23.312"></a><span id="l23.312" class="difflineminus">-   *</span>
<a href="#l23.313"></a><span id="l23.313" class="difflineminus">-   * This is exposed primarily to allow unit tests to set this to 0 to minimize</span>
<a href="#l23.314"></a><span id="l23.314" class="difflineminus">-   * throttling.</span>
<a href="#l23.315"></a><span id="l23.315" class="difflineminus">-   */</span>
<a href="#l23.316"></a><span id="l23.316" class="difflineminus">-  INTER_FOLDER_PROCESSING_DELAY_MS: 10,</span>
<a href="#l23.317"></a><span id="l23.317" class="difflineminus">-</span>
<a href="#l23.318"></a><span id="l23.318" class="difflineminus">-  /**</span>
<a href="#l23.319"></a><span id="l23.319" class="difflineminus">-   * Set a string property on a folder and all of its descendents, taking care</span>
<a href="#l23.320"></a><span id="l23.320" class="difflineminus">-   * to avoid locking up the main thread and to avoid leaving folder databases</span>
<a href="#l23.321"></a><span id="l23.321" class="difflineminus">-   * open.  To avoid locking up the main thread we operate in an asynchronous</span>
<a href="#l23.322"></a><span id="l23.322" class="difflineminus">-   * fashion; we invoke a callback when we have completed our work.</span>
<a href="#l23.323"></a><span id="l23.323" class="difflineminus">-   *</span>
<a href="#l23.324"></a><span id="l23.324" class="difflineminus">-   * Using this function will write the value into the folder cache</span>
<a href="#l23.325"></a><span id="l23.325" class="difflineminus">-   * (panacea.dat) as well as the folder itself.  Hopefully you want this; if</span>
<a href="#l23.326"></a><span id="l23.326" class="difflineminus">-   * you do not, keep in mind that the only way to avoid that is to retrieve</span>
<a href="#l23.327"></a><span id="l23.327" class="difflineminus">-   * the nsIMsgDatabase and then the nsIDbFolderInfo.  You would want to avoid</span>
<a href="#l23.328"></a><span id="l23.328" class="difflineminus">-   * that as much as possible because once those are exposed to you, XPConnect</span>
<a href="#l23.329"></a><span id="l23.329" class="difflineminus">-   * is going to hold onto them creating a situation where you are going to be</span>
<a href="#l23.330"></a><span id="l23.330" class="difflineminus">-   * in severe danger of extreme memory bloat unless you force garbage</span>
<a href="#l23.331"></a><span id="l23.331" class="difflineminus">-   * collections after every time you close a database.</span>
<a href="#l23.332"></a><span id="l23.332" class="difflineminus">-   *</span>
<a href="#l23.333"></a><span id="l23.333" class="difflineminus">-   * @param aPropertyName The name of the property to set.</span>
<a href="#l23.334"></a><span id="l23.334" class="difflineminus">-   * @param aPropertyValue The (string) value of the property to set.</span>
<a href="#l23.335"></a><span id="l23.335" class="difflineminus">-   *     Alternately, you can pass a function that takes the nsIMsgFolder and</span>
<a href="#l23.336"></a><span id="l23.336" class="difflineminus">-   *     returns a string value.</span>
<a href="#l23.337"></a><span id="l23.337" class="difflineminus">-   * @param aFolder The parent folder; we set the string property on it and all</span>
<a href="#l23.338"></a><span id="l23.338" class="difflineminus">-   *     of its descendents.</span>
<a href="#l23.339"></a><span id="l23.339" class="difflineminus">-   * @param [aCallback] The optional callback to invoke once we finish our work.</span>
<a href="#l23.340"></a><span id="l23.340" class="difflineminus">-   *     The callback is provided a boolean success value; true means we</span>
<a href="#l23.341"></a><span id="l23.341" class="difflineminus">-   *     managed to set the values on all folders, false means we encountered a</span>
<a href="#l23.342"></a><span id="l23.342" class="difflineminus">-   *     problem.</span>
<a href="#l23.343"></a><span id="l23.343" class="difflineminus">-   */</span>
<a href="#l23.344"></a><span id="l23.344" class="difflineminus">-  setStringPropertyOnFolderAndDescendents:</span>
<a href="#l23.345"></a><span id="l23.345" class="difflineminus">-      function MailUtils_setStringPropertyOnFolderAndDescendents(aPropertyName,</span>
<a href="#l23.346"></a><span id="l23.346" class="difflineminus">-                                                                 aPropertyValue,</span>
<a href="#l23.347"></a><span id="l23.347" class="difflineminus">-                                                                 aFolder,</span>
<a href="#l23.348"></a><span id="l23.348" class="difflineminus">-                                                                 aCallback) {</span>
<a href="#l23.349"></a><span id="l23.349" class="difflineminus">-    // We need to add the base folder as it does not get added by ListDescendants.</span>
<a href="#l23.350"></a><span id="l23.350" class="difflineminus">-    let allFolders = toXPCOMArray([aFolder], Ci.nsIMutableArray);</span>
<a href="#l23.351"></a><span id="l23.351" class="difflineminus">-    // - get all the descendants</span>
<a href="#l23.352"></a><span id="l23.352" class="difflineminus">-    aFolder.ListDescendants(allFolders);</span>
<a href="#l23.353"></a><span id="l23.353" class="difflineminus">-</span>
<a href="#l23.354"></a><span id="l23.354" class="difflineminus">-    // - worker function</span>
<a href="#l23.355"></a><span id="l23.355" class="difflineminus">-    function* folder_string_setter_worker() {</span>
<a href="#l23.356"></a><span id="l23.356" class="difflineminus">-      for (let folder of fixIterator(allFolders, Ci.nsIMsgFolder)) {</span>
<a href="#l23.357"></a><span id="l23.357" class="difflineminus">-        // set the property; this may open the database...</span>
<a href="#l23.358"></a><span id="l23.358" class="difflineminus">-        let value = (typeof aPropertyValue == &quot;function&quot; ?</span>
<a href="#l23.359"></a><span id="l23.359" class="difflineminus">-                     aPropertyValue(folder) : aPropertyValue);</span>
<a href="#l23.360"></a><span id="l23.360" class="difflineminus">-        folder.setStringProperty(aPropertyName, value);</span>
<a href="#l23.361"></a><span id="l23.361" class="difflineminus">-        // force the reference to be forgotten.</span>
<a href="#l23.362"></a><span id="l23.362" class="difflineminus">-        folder.msgDatabase = null;</span>
<a href="#l23.363"></a><span id="l23.363" class="difflineminus">-        yield undefined;</span>
<a href="#l23.364"></a><span id="l23.364" class="difflineminus">-      }</span>
<a href="#l23.365"></a><span id="l23.365" class="difflineminus">-    }</span>
<a href="#l23.366"></a><span id="l23.366" class="difflineminus">-    let worker = folder_string_setter_worker();</span>
<a href="#l23.367"></a><span id="l23.367" class="difflineminus">-</span>
<a href="#l23.368"></a><span id="l23.368" class="difflineminus">-    // - driver logic</span>
<a href="#l23.369"></a><span id="l23.369" class="difflineminus">-    let timer = Cc[&quot;@mozilla.org/timer;1&quot;].createInstance(Ci.nsITimer);</span>
<a href="#l23.370"></a><span id="l23.370" class="difflineminus">-    function folder_string_setter_driver() {</span>
<a href="#l23.371"></a><span id="l23.371" class="difflineminus">-      try {</span>
<a href="#l23.372"></a><span id="l23.372" class="difflineminus">-        if (worker.next().done) {</span>
<a href="#l23.373"></a><span id="l23.373" class="difflineminus">-          timer.cancel();</span>
<a href="#l23.374"></a><span id="l23.374" class="difflineminus">-          if (aCallback)</span>
<a href="#l23.375"></a><span id="l23.375" class="difflineminus">-            aCallback(true);</span>
<a href="#l23.376"></a><span id="l23.376" class="difflineminus">-        }</span>
<a href="#l23.377"></a><span id="l23.377" class="difflineminus">-      }</span>
<a href="#l23.378"></a><span id="l23.378" class="difflineminus">-      catch (ex) {</span>
<a href="#l23.379"></a><span id="l23.379" class="difflineminus">-        // Any type of exception kills the generator.</span>
<a href="#l23.380"></a><span id="l23.380" class="difflineminus">-        timer.cancel();</span>
<a href="#l23.381"></a><span id="l23.381" class="difflineminus">-        if (aCallback)</span>
<a href="#l23.382"></a><span id="l23.382" class="difflineminus">-          aCallback(false);</span>
<a href="#l23.383"></a><span id="l23.383" class="difflineminus">-      }</span>
<a href="#l23.384"></a><span id="l23.384" class="difflineminus">-    }</span>
<a href="#l23.385"></a><span id="l23.385" class="difflineminus">-    // make sure there is at least 100 ms of not us between doing things.</span>
<a href="#l23.386"></a><span id="l23.386" class="difflineminus">-    timer.initWithCallback(folder_string_setter_driver,</span>
<a href="#l23.387"></a><span id="l23.387" class="difflineminus">-                           this.INTER_FOLDER_PROCESSING_DELAY_MS,</span>
<a href="#l23.388"></a><span id="l23.388" class="difflineminus">-                           Ci.nsITimer.TYPE_REPEATING_SLACK);</span>
<a href="#l23.389"></a><span id="l23.389" class="difflineminus">-  },</span>
<a href="#l23.390"></a><span id="l23.390" class="difflineminus">-};</span>
<a href="#l23.391"></a><span id="l23.391" class="difflineplus">+ChromeUtils.import(&quot;resource://gre/modules/Deprecated.jsm&quot;);</span>
<a href="#l23.392"></a><span id="l23.392" class="difflineplus">+Deprecated.warning(</span>
<a href="#l23.393"></a><span id="l23.393" class="difflineplus">+    &quot;MailUtils.js has been renamed MailUtils.jsm&quot;,</span>
<a href="#l23.394"></a><span id="l23.394" class="difflineplus">+    &quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1498041&quot;,</span>
<a href="#l23.395"></a><span id="l23.395" class="difflineplus">+    Components.stack.caller</span>
<a href="#l23.396"></a><span id="l23.396" class="difflineplus">+);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1">copy from mail/base/modules/MailUtils.js</span>
<a href="#l24.2"></a><span id="l24.2">copy to mail/base/modules/MailUtils.jsm</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineminus">--- a/mail/base/modules/MailUtils.js</span>
<a href="#l24.4"></a><span id="l24.4" class="difflineplus">+++ b/mail/base/modules/MailUtils.jsm</span>
<a href="#l24.5"></a><span id="l24.5" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l24.6"></a><span id="l24.6"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l24.7"></a><span id="l24.7">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l24.8"></a><span id="l24.8">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l24.9"></a><span id="l24.9"> </span>
<a href="#l24.10"></a><span id="l24.10"> var EXPORTED_SYMBOLS = [&quot;MailUtils&quot;];</span>
<a href="#l24.11"></a><span id="l24.11"> </span>
<a href="#l24.12"></a><span id="l24.12"> ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailConsts.js&quot;);</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailConsts.jsm&quot;);</span>
<a href="#l24.15"></a><span id="l24.15"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l24.16"></a><span id="l24.16"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l24.17"></a><span id="l24.17"> ChromeUtils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l24.18"></a><span id="l24.18"> </span>
<a href="#l24.19"></a><span id="l24.19"> var MC = MailConsts;</span>
<a href="#l24.20"></a><span id="l24.20"> </span>
<a href="#l24.21"></a><span id="l24.21"> /**</span>
<a href="#l24.22"></a><span id="l24.22">  * This module has several utility functions for use by both core and</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1">rename from mail/base/modules/mailViewManager.js</span>
<a href="#l25.2"></a><span id="l25.2">rename to mail/base/modules/MailViewManager.jsm</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1">rename from mail/base/modules/MsgHdrSyntheticView.js</span>
<a href="#l26.2"></a><span id="l26.2">rename to mail/base/modules/MsgHdrSyntheticView.jsm</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1">rename from mail/base/modules/quickFilterManager.js</span>
<a href="#l27.2"></a><span id="l27.2">rename to mail/base/modules/QuickFilterManager.jsm</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineminus">--- a/mail/base/modules/quickFilterManager.js</span>
<a href="#l27.4"></a><span id="l27.4" class="difflineplus">+++ b/mail/base/modules/QuickFilterManager.jsm</span>
<a href="#l27.5"></a><span id="l27.5" class="difflineat">@@ -7,17 +7,17 @@ this.EXPORTED_SYMBOLS = [&quot;QuickFilterSta</span>
<a href="#l27.6"></a><span id="l27.6"> </span>
<a href="#l27.7"></a><span id="l27.7"> ChromeUtils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l27.8"></a><span id="l27.8"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l27.9"></a><span id="l27.9"> ChromeUtils.import(&quot;resource://gre/modules/AppConstants.jsm&quot;);</span>
<a href="#l27.10"></a><span id="l27.10"> </span>
<a href="#l27.11"></a><span id="l27.11"> ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l27.12"></a><span id="l27.12"> ChromeUtils.import(&quot;resource:///modules/errUtils.js&quot;);</span>
<a href="#l27.13"></a><span id="l27.13"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l27.14"></a><span id="l27.14" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/searchSpec.js&quot;);</span>
<a href="#l27.15"></a><span id="l27.15" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/SearchSpec.jsm&quot;);</span>
<a href="#l27.16"></a><span id="l27.16"> </span>
<a href="#l27.17"></a><span id="l27.17"> var nsMsgSearchAttrib = Ci.nsMsgSearchAttrib;</span>
<a href="#l27.18"></a><span id="l27.18"> var nsMsgMessageFlags = Ci.nsMsgMessageFlags;</span>
<a href="#l27.19"></a><span id="l27.19"> var nsMsgSearchOp = Ci.nsMsgSearchOp;</span>
<a href="#l27.20"></a><span id="l27.20"> </span>
<a href="#l27.21"></a><span id="l27.21"> // XXX we need to know whether the gloda indexer is enabled for upsell reasons,</span>
<a href="#l27.22"></a><span id="l27.22"> // but this should really just be exposed on the main Gloda public interface.</span>
<a href="#l27.23"></a><span id="l27.23"> ChromeUtils.import(&quot;resource:///modules/gloda/indexer.js&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1">rename from mail/base/modules/searchSpec.js</span>
<a href="#l28.2"></a><span id="l28.2">rename to mail/base/modules/SearchSpec.jsm</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1">rename from mail/base/modules/sessionStoreManager.js</span>
<a href="#l29.2"></a><span id="l29.2">rename to mail/base/modules/SessionStoreManager.jsm</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineminus">--- a/mail/base/modules/sessionStoreManager.js</span>
<a href="#l29.4"></a><span id="l29.4" class="difflineplus">+++ b/mail/base/modules/SessionStoreManager.jsm</span>
<a href="#l29.5"></a><span id="l29.5" class="difflineat">@@ -3,31 +3,31 @@</span>
<a href="#l29.6"></a><span id="l29.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l29.7"></a><span id="l29.7"> </span>
<a href="#l29.8"></a><span id="l29.8"> /**</span>
<a href="#l29.9"></a><span id="l29.9">  * Session Storage and Restoration</span>
<a href="#l29.10"></a><span id="l29.10">  */</span>
<a href="#l29.11"></a><span id="l29.11"> </span>
<a href="#l29.12"></a><span id="l29.12"> /* :::::::: Constants and Helpers ::::::::::::::: */</span>
<a href="#l29.13"></a><span id="l29.13"> </span>
<a href="#l29.14"></a><span id="l29.14" class="difflineminus">-this.EXPORTED_SYMBOLS = [&quot;sessionStoreManager&quot;];</span>
<a href="#l29.15"></a><span id="l29.15" class="difflineplus">+this.EXPORTED_SYMBOLS = [&quot;SessionStoreManager&quot;];</span>
<a href="#l29.16"></a><span id="l29.16"> </span>
<a href="#l29.17"></a><span id="l29.17"> ChromeUtils.import(&quot;resource://gre/modules/JSONFile.jsm&quot;);</span>
<a href="#l29.18"></a><span id="l29.18"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l29.19"></a><span id="l29.19"> </span>
<a href="#l29.20"></a><span id="l29.20"> /**</span>
<a href="#l29.21"></a><span id="l29.21">  * asuth arbitrarily chose this value to trade-off powersaving,</span>
<a href="#l29.22"></a><span id="l29.22">  * processor usage, and recency of state in the face of the impossibility of</span>
<a href="#l29.23"></a><span id="l29.23">  * our crashing; he also worded this.</span>
<a href="#l29.24"></a><span id="l29.24">  */</span>
<a href="#l29.25"></a><span id="l29.25"> var SESSION_AUTO_SAVE_DEFAULT_MS = 300000; // 5 minutes</span>
<a href="#l29.26"></a><span id="l29.26"> </span>
<a href="#l29.27"></a><span id="l29.27"> /* :::::::: The Module ::::::::::::::: */</span>
<a href="#l29.28"></a><span id="l29.28"> </span>
<a href="#l29.29"></a><span id="l29.29" class="difflineminus">-var sessionStoreManager =</span>
<a href="#l29.30"></a><span id="l29.30" class="difflineplus">+var SessionStoreManager =</span>
<a href="#l29.31"></a><span id="l29.31"> {</span>
<a href="#l29.32"></a><span id="l29.32">   _initialized: false,</span>
<a href="#l29.33"></a><span id="l29.33"> </span>
<a href="#l29.34"></a><span id="l29.34">   /**</span>
<a href="#l29.35"></a><span id="l29.35">    * Session restored successfully on startup; use this to test for an early</span>
<a href="#l29.36"></a><span id="l29.36">    * failed startup which does not restore user tab state to ensure a session</span>
<a href="#l29.37"></a><span id="l29.37">    * save on close will not overwrite the last good session state.</span>
<a href="#l29.38"></a><span id="l29.38">    */</span>
<a href="#l29.39"></a><span id="l29.39" class="difflineat">@@ -128,17 +128,17 @@ var sessionStoreManager =</span>
<a href="#l29.40"></a><span id="l29.40">   },</span>
<a href="#l29.41"></a><span id="l29.41"> </span>
<a href="#l29.42"></a><span id="l29.42">   /**</span>
<a href="#l29.43"></a><span id="l29.43">    * Writes the state object to disk.</span>
<a href="#l29.44"></a><span id="l29.44">    */</span>
<a href="#l29.45"></a><span id="l29.45">   _saveStateObject: function ssm_saveStateObject(aStateObj)</span>
<a href="#l29.46"></a><span id="l29.46">   {</span>
<a href="#l29.47"></a><span id="l29.47">     if (!this.store) {</span>
<a href="#l29.48"></a><span id="l29.48" class="difflineminus">-      Cu.reportError(&quot;sessionStoreManager: could not create data store from file&quot;);</span>
<a href="#l29.49"></a><span id="l29.49" class="difflineplus">+      Cu.reportError(&quot;SessionStoreManager: could not create data store from file&quot;);</span>
<a href="#l29.50"></a><span id="l29.50">       return;</span>
<a href="#l29.51"></a><span id="l29.51">     }</span>
<a href="#l29.52"></a><span id="l29.52"> </span>
<a href="#l29.53"></a><span id="l29.53">     let currentStateString = JSON.stringify(aStateObj);</span>
<a href="#l29.54"></a><span id="l29.54">     let storedStateString = this.store.dataReady &amp;&amp; this.store.data ?</span>
<a href="#l29.55"></a><span id="l29.55">                               JSON.stringify(this.store.data) : null;</span>
<a href="#l29.56"></a><span id="l29.56"> </span>
<a href="#l29.57"></a><span id="l29.57">     // Do not save state (overwrite last good state) in case of a failed startup.</span>
<a href="#l29.58"></a><span id="l29.58" class="difflineat">@@ -180,17 +180,17 @@ var sessionStoreManager =</span>
<a href="#l29.59"></a><span id="l29.59"> </span>
<a href="#l29.60"></a><span id="l29.60">     this._saveStateObject(state);</span>
<a href="#l29.61"></a><span id="l29.61">   },</span>
<a href="#l29.62"></a><span id="l29.62"> </span>
<a href="#l29.63"></a><span id="l29.63"> /* ........ Timer Callback ................*/</span>
<a href="#l29.64"></a><span id="l29.64"> </span>
<a href="#l29.65"></a><span id="l29.65">   _sessionAutoSaveTimerCallback: function ssm_sessionAutoSaveTimerCallback()</span>
<a href="#l29.66"></a><span id="l29.66">   {</span>
<a href="#l29.67"></a><span id="l29.67" class="difflineminus">-    sessionStoreManager._saveState();</span>
<a href="#l29.68"></a><span id="l29.68" class="difflineplus">+    SessionStoreManager._saveState();</span>
<a href="#l29.69"></a><span id="l29.69">   },</span>
<a href="#l29.70"></a><span id="l29.70"> </span>
<a href="#l29.71"></a><span id="l29.71"> /* ........ Observer Notification Handler ................*/</span>
<a href="#l29.72"></a><span id="l29.72"> </span>
<a href="#l29.73"></a><span id="l29.73">   observe: function ssm_observe(aSubject, aTopic, aData) {</span>
<a href="#l29.74"></a><span id="l29.74">     switch (aTopic) {</span>
<a href="#l29.75"></a><span id="l29.75">     // This is observed before any windows start unloading if something other</span>
<a href="#l29.76"></a><span id="l29.76">     // than the last 3pane window closing requested the application be</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1">rename from mail/base/modules/summaryFrameManager.js</span>
<a href="#l30.2"></a><span id="l30.2">rename to mail/base/modules/SummaryFrameManager.jsm</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1">rename from mail/base/modules/distribution.js</span>
<a href="#l31.2"></a><span id="l31.2">rename to mail/base/modules/TBDistCustomizer.jsm</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/mail/base/modules/moz.build</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/mail/base/modules/moz.build</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -1,28 +1,28 @@</span>
<a href="#l32.4"></a><span id="l32.4"> # vim: set filetype=python:</span>
<a href="#l32.5"></a><span id="l32.5"> # This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l32.6"></a><span id="l32.6"> # License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l32.7"></a><span id="l32.7"> # file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l32.8"></a><span id="l32.8"> </span>
<a href="#l32.9"></a><span id="l32.9"> EXTRA_JS_MODULES += [</span>
<a href="#l32.10"></a><span id="l32.10" class="difflineminus">-    'attachmentChecker.js',</span>
<a href="#l32.11"></a><span id="l32.11" class="difflineminus">-    'dbViewWrapper.js',</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-    'displayNameUtils.js',</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineminus">-    'distribution.js',</span>
<a href="#l32.14"></a><span id="l32.14" class="difflineminus">-    'MailConsts.js',</span>
<a href="#l32.15"></a><span id="l32.15" class="difflineminus">-    'mailInstrumentation.js',</span>
<a href="#l32.16"></a><span id="l32.16" class="difflineminus">-    'mailMigrator.js',</span>
<a href="#l32.17"></a><span id="l32.17" class="difflineplus">+    'AttachmentChecker.jsm',</span>
<a href="#l32.18"></a><span id="l32.18" class="difflineplus">+    'DBViewWrapper.jsm',</span>
<a href="#l32.19"></a><span id="l32.19" class="difflineplus">+    'DisplayNameUtils.jsm',</span>
<a href="#l32.20"></a><span id="l32.20" class="difflineplus">+    'MailConsts.jsm',</span>
<a href="#l32.21"></a><span id="l32.21" class="difflineplus">+    'MailInstrumentation.jsm',</span>
<a href="#l32.22"></a><span id="l32.22" class="difflineplus">+    'MailMigrator.jsm',</span>
<a href="#l32.23"></a><span id="l32.23">     'MailUtils.js',</span>
<a href="#l32.24"></a><span id="l32.24" class="difflineminus">-    'mailViewManager.js',</span>
<a href="#l32.25"></a><span id="l32.25" class="difflineminus">-    'MsgHdrSyntheticView.js',</span>
<a href="#l32.26"></a><span id="l32.26" class="difflineminus">-    'oauth.jsm',</span>
<a href="#l32.27"></a><span id="l32.27" class="difflineminus">-    'quickFilterManager.js',</span>
<a href="#l32.28"></a><span id="l32.28" class="difflineminus">-    'searchSpec.js',</span>
<a href="#l32.29"></a><span id="l32.29" class="difflineminus">-    'sessionStoreManager.js',</span>
<a href="#l32.30"></a><span id="l32.30" class="difflineminus">-    'summaryFrameManager.js',</span>
<a href="#l32.31"></a><span id="l32.31" class="difflineplus">+    'MailUtils.jsm',</span>
<a href="#l32.32"></a><span id="l32.32" class="difflineplus">+    'MailViewManager.jsm',</span>
<a href="#l32.33"></a><span id="l32.33" class="difflineplus">+    'MsgHdrSyntheticView.jsm',</span>
<a href="#l32.34"></a><span id="l32.34" class="difflineplus">+    'QuickFilterManager.jsm',</span>
<a href="#l32.35"></a><span id="l32.35" class="difflineplus">+    'SearchSpec.jsm',</span>
<a href="#l32.36"></a><span id="l32.36" class="difflineplus">+    'SessionStoreManager.jsm',</span>
<a href="#l32.37"></a><span id="l32.37" class="difflineplus">+    'SummaryFrameManager.jsm',</span>
<a href="#l32.38"></a><span id="l32.38" class="difflineplus">+    'TBDistCustomizer.jsm',</span>
<a href="#l32.39"></a><span id="l32.39">     'Windows8WindowFrameColor.jsm',</span>
<a href="#l32.40"></a><span id="l32.40"> ]</span>
<a href="#l32.41"></a><span id="l32.41"> </span>
<a href="#l32.42"></a><span id="l32.42"> FINAL_TARGET_FILES.modules += [</span>
<a href="#l32.43"></a><span id="l32.43">     'ThemeVariableMap.jsm'</span>
<a href="#l32.44"></a><span id="l32.44"> ]</span>
<a href="#l32.45"></a><span id="l32.45"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1">deleted file mode 100644</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineminus">--- a/mail/base/modules/oauth.jsm</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineplus">+++ /dev/null</span>
<a href="#l33.4"></a><span id="l33.4" class="difflineat">@@ -1,315 +0,0 @@</span>
<a href="#l33.5"></a><span id="l33.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l33.6"></a><span id="l33.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l33.7"></a><span id="l33.7" class="difflineminus">- * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l33.8"></a><span id="l33.8" class="difflineminus">-</span>
<a href="#l33.9"></a><span id="l33.9" class="difflineminus">-/**</span>
<a href="#l33.10"></a><span id="l33.10" class="difflineminus">- * This js module does OAuth 1.0 authentication. It was originally intended to</span>
<a href="#l33.11"></a><span id="l33.11" class="difflineminus">- * be shareable by various components that need Oauth, but some changes will</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">- * need to be made to support differences in OAuth usage.</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineminus">- */</span>
<a href="#l33.14"></a><span id="l33.14" class="difflineminus">-</span>
<a href="#l33.15"></a><span id="l33.15" class="difflineminus">-var EXPORTED_SYMBOLS = [&quot;OAuth&quot;];</span>
<a href="#l33.16"></a><span id="l33.16" class="difflineminus">-</span>
<a href="#l33.17"></a><span id="l33.17" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/Http.jsm&quot;);</span>
<a href="#l33.18"></a><span id="l33.18" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l33.19"></a><span id="l33.19" class="difflineminus">-ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l33.20"></a><span id="l33.20" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/gloda/log4moz.js&quot;);</span>
<a href="#l33.21"></a><span id="l33.21" class="difflineminus">-</span>
<a href="#l33.22"></a><span id="l33.22" class="difflineminus">-function OAuth(aDisplayName, aBaseUri, aAuthUri, aAuthToken, aAuthTokenSecret,</span>
<a href="#l33.23"></a><span id="l33.23" class="difflineminus">-               aAppKey, aAppSecret, aSignatureMethod,</span>
<a href="#l33.24"></a><span id="l33.24" class="difflineminus">-               aTempCredentialsMethod = &quot;oauth/request_token&quot;,</span>
<a href="#l33.25"></a><span id="l33.25" class="difflineminus">-               aAuthorizeMethod = &quot;oauth/authorize&quot;,</span>
<a href="#l33.26"></a><span id="l33.26" class="difflineminus">-               aRequestCredentialsMethod = &quot;oauth/access_token&quot;)</span>
<a href="#l33.27"></a><span id="l33.27" class="difflineminus">-{</span>
<a href="#l33.28"></a><span id="l33.28" class="difflineminus">-  this._userInfo = {};</span>
<a href="#l33.29"></a><span id="l33.29" class="difflineminus">-  this.displayName = aDisplayName;</span>
<a href="#l33.30"></a><span id="l33.30" class="difflineminus">-  this.baseURI = aBaseUri;</span>
<a href="#l33.31"></a><span id="l33.31" class="difflineminus">-  this.authURI = aAuthUri;</span>
<a href="#l33.32"></a><span id="l33.32" class="difflineminus">-  this.token = aAuthToken;</span>
<a href="#l33.33"></a><span id="l33.33" class="difflineminus">-  this.tokenSecret = aAuthTokenSecret;</span>
<a href="#l33.34"></a><span id="l33.34" class="difflineminus">-  this.consumerKey = aAppKey;</span>
<a href="#l33.35"></a><span id="l33.35" class="difflineminus">-  this.consumerSecret = aAppSecret;</span>
<a href="#l33.36"></a><span id="l33.36" class="difflineminus">-  this.log = Log4Moz.getConfiguredLogger(&quot;TBOAuth&quot;);</span>
<a href="#l33.37"></a><span id="l33.37" class="difflineminus">-</span>
<a href="#l33.38"></a><span id="l33.38" class="difflineminus">-  this.signatureMethod = aSignatureMethod || &quot;HMAC-SHA1&quot;;</span>
<a href="#l33.39"></a><span id="l33.39" class="difflineminus">-  this.tempCredentialsMethod = aTempCredentialsMethod;</span>
<a href="#l33.40"></a><span id="l33.40" class="difflineminus">-  this.authorizeMethod = aAuthorizeMethod;</span>
<a href="#l33.41"></a><span id="l33.41" class="difflineminus">-  this.requestCredentialsMethod = aRequestCredentialsMethod;</span>
<a href="#l33.42"></a><span id="l33.42" class="difflineminus">-}</span>
<a href="#l33.43"></a><span id="l33.43" class="difflineminus">-</span>
<a href="#l33.44"></a><span id="l33.44" class="difflineminus">-OAuth.prototype = {</span>
<a href="#l33.45"></a><span id="l33.45" class="difflineminus">-  consumerKey: &quot;&quot;,</span>
<a href="#l33.46"></a><span id="l33.46" class="difflineminus">-  consumerSecret: &quot;&quot;,</span>
<a href="#l33.47"></a><span id="l33.47" class="difflineminus">-  completionURI: &quot;http://oauthcallback.local/&quot;,</span>
<a href="#l33.48"></a><span id="l33.48" class="difflineminus">-  baseURI: &quot;&quot;,</span>
<a href="#l33.49"></a><span id="l33.49" class="difflineminus">-  token : &quot;&quot;,</span>
<a href="#l33.50"></a><span id="l33.50" class="difflineminus">-  tokenSecret : &quot;&quot;,</span>
<a href="#l33.51"></a><span id="l33.51" class="difflineminus">-  connectSuccessCallback : null,</span>
<a href="#l33.52"></a><span id="l33.52" class="difflineminus">-  connectFailureCallback : null,</span>
<a href="#l33.53"></a><span id="l33.53" class="difflineminus">-  /**</span>
<a href="#l33.54"></a><span id="l33.54" class="difflineminus">-   * Start the OAuth connection process, if not connected.</span>
<a href="#l33.55"></a><span id="l33.55" class="difflineminus">-   *</span>
<a href="#l33.56"></a><span id="l33.56" class="difflineminus">-   * @param aSuccess success callback, called synchronously if we are already</span>
<a href="#l33.57"></a><span id="l33.57" class="difflineminus">-                     connected, or the connection succeeds.</span>
<a href="#l33.58"></a><span id="l33.58" class="difflineminus">-   * @param aFailure failure callback.</span>
<a href="#l33.59"></a><span id="l33.59" class="difflineminus">-   */</span>
<a href="#l33.60"></a><span id="l33.60" class="difflineminus">-  connect: function(aSuccess, aFailure, aWithUI) {</span>
<a href="#l33.61"></a><span id="l33.61" class="difflineminus">-    if (this.connected || this.connecting)</span>
<a href="#l33.62"></a><span id="l33.62" class="difflineminus">-      return;</span>
<a href="#l33.63"></a><span id="l33.63" class="difflineminus">-</span>
<a href="#l33.64"></a><span id="l33.64" class="difflineminus">-    this._enabled = true;</span>
<a href="#l33.65"></a><span id="l33.65" class="difflineminus">-    // Get a new token if needed...</span>
<a href="#l33.66"></a><span id="l33.66" class="difflineminus">-    if (!this.token || !this.tokenSecret) {</span>
<a href="#l33.67"></a><span id="l33.67" class="difflineminus">-      if (!aWithUI) {</span>
<a href="#l33.68"></a><span id="l33.68" class="difflineminus">-        aFailure();</span>
<a href="#l33.69"></a><span id="l33.69" class="difflineminus">-        return;</span>
<a href="#l33.70"></a><span id="l33.70" class="difflineminus">-      }</span>
<a href="#l33.71"></a><span id="l33.71" class="difflineminus">-      this.connectSuccessCallback = aSuccess;</span>
<a href="#l33.72"></a><span id="l33.72" class="difflineminus">-      this.connectFailureCallback = aFailure;</span>
<a href="#l33.73"></a><span id="l33.73" class="difflineminus">-      this.log.info(&quot;don't think we have a token or token secret&quot;);</span>
<a href="#l33.74"></a><span id="l33.74" class="difflineminus">-      this.requestToken();</span>
<a href="#l33.75"></a><span id="l33.75" class="difflineminus">-      return;</span>
<a href="#l33.76"></a><span id="l33.76" class="difflineminus">-    }</span>
<a href="#l33.77"></a><span id="l33.77" class="difflineminus">-</span>
<a href="#l33.78"></a><span id="l33.78" class="difflineminus">-    this.log.info(&quot;Connecting using existing token&quot;);</span>
<a href="#l33.79"></a><span id="l33.79" class="difflineminus">-    aSuccess();</span>
<a href="#l33.80"></a><span id="l33.80" class="difflineminus">-  },</span>
<a href="#l33.81"></a><span id="l33.81" class="difflineminus">-  /**</span>
<a href="#l33.82"></a><span id="l33.82" class="difflineminus">-   * Sign a request and send it, using the oauth connection.</span>
<a href="#l33.83"></a><span id="l33.83" class="difflineminus">-   *</span>
<a href="#l33.84"></a><span id="l33.84" class="difflineminus">-   * @param aUrl Url to open</span>
<a href="#l33.85"></a><span id="l33.85" class="difflineminus">-   * @param aHeaders Additional headers to send</span>
<a href="#l33.86"></a><span id="l33.86" class="difflineminus">-   * @param aMethod &quot;Get&quot;/&quot;Post&quot;/&quot;Put&quot;</span>
<a href="#l33.87"></a><span id="l33.87" class="difflineminus">-   * @param aPOSTData Data to post</span>
<a href="#l33.88"></a><span id="l33.88" class="difflineminus">-   * @param aOnLoad Success callback</span>
<a href="#l33.89"></a><span id="l33.89" class="difflineminus">-   * @param aOnError Error callback</span>
<a href="#l33.90"></a><span id="l33.90" class="difflineminus">-   * @param aThis passed as first param to success and error callbacks</span>
<a href="#l33.91"></a><span id="l33.91" class="difflineminus">-   * @param aOAuthParams additional params to pass to request</span>
<a href="#l33.92"></a><span id="l33.92" class="difflineminus">-   */</span>
<a href="#l33.93"></a><span id="l33.93" class="difflineminus">-  signAndSend: function(aUrl, aHeaders, aMethod, aPOSTData, aOnLoad, aOnError, aThis,</span>
<a href="#l33.94"></a><span id="l33.94" class="difflineminus">-                        aOAuthParams) {</span>
<a href="#l33.95"></a><span id="l33.95" class="difflineminus">-    this.log.info(&quot;sign and send aUrl = &quot; + aUrl);</span>
<a href="#l33.96"></a><span id="l33.96" class="difflineminus">-    const kChars =</span>
<a href="#l33.97"></a><span id="l33.97" class="difflineminus">-      &quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz&quot;;</span>
<a href="#l33.98"></a><span id="l33.98" class="difflineminus">-    const kNonceLength = 6;</span>
<a href="#l33.99"></a><span id="l33.99" class="difflineminus">-    let nonce = &quot;&quot;;</span>
<a href="#l33.100"></a><span id="l33.100" class="difflineminus">-    for (let i = 0; i &lt; kNonceLength; ++i)</span>
<a href="#l33.101"></a><span id="l33.101" class="difflineminus">-      nonce += kChars[Math.floor(Math.random() * kChars.length)];</span>
<a href="#l33.102"></a><span id="l33.102" class="difflineminus">-</span>
<a href="#l33.103"></a><span id="l33.103" class="difflineminus">-    let params = (aOAuthParams || []).concat([</span>
<a href="#l33.104"></a><span id="l33.104" class="difflineminus">-      [&quot;oauth_consumer_key&quot;, this.consumerKey],</span>
<a href="#l33.105"></a><span id="l33.105" class="difflineminus">-      [&quot;oauth_nonce&quot;, nonce],</span>
<a href="#l33.106"></a><span id="l33.106" class="difflineminus">-      [&quot;oauth_signature_method&quot;, this.signatureMethod],</span>
<a href="#l33.107"></a><span id="l33.107" class="difflineminus">-      [&quot;oauth_timestamp&quot;, Math.floor(((new Date()).getTime()) / 1000)],</span>
<a href="#l33.108"></a><span id="l33.108" class="difflineminus">-      [&quot;oauth_version&quot;, &quot;1.0&quot;]</span>
<a href="#l33.109"></a><span id="l33.109" class="difflineminus">-    ]);</span>
<a href="#l33.110"></a><span id="l33.110" class="difflineminus">-    if (this.token) {</span>
<a href="#l33.111"></a><span id="l33.111" class="difflineminus">-      params.push([&quot;oauth_token&quot;, this.token]);</span>
<a href="#l33.112"></a><span id="l33.112" class="difflineminus">-    }</span>
<a href="#l33.113"></a><span id="l33.113" class="difflineminus">-</span>
<a href="#l33.114"></a><span id="l33.114" class="difflineminus">-    let dataParams = [];</span>
<a href="#l33.115"></a><span id="l33.115" class="difflineminus">-    let url = /^https?:/.test(aUrl) ? aUrl : this.baseURI + aUrl;</span>
<a href="#l33.116"></a><span id="l33.116" class="difflineminus">-    let urlSpec = url;</span>
<a href="#l33.117"></a><span id="l33.117" class="difflineminus">-    let queryIndex = url.indexOf(&quot;?&quot;);</span>
<a href="#l33.118"></a><span id="l33.118" class="difflineminus">-    if (queryIndex != -1) {</span>
<a href="#l33.119"></a><span id="l33.119" class="difflineminus">-      urlSpec = url.slice(0, queryIndex);</span>
<a href="#l33.120"></a><span id="l33.120" class="difflineminus">-      dataParams = url.slice(queryIndex + 1).split(&quot;&amp;&quot;)</span>
<a href="#l33.121"></a><span id="l33.121" class="difflineminus">-                      .map(p =&gt; p.split(&quot;=&quot;).map(percentEncode));</span>
<a href="#l33.122"></a><span id="l33.122" class="difflineminus">-    }</span>
<a href="#l33.123"></a><span id="l33.123" class="difflineminus">-    this.log.info(&quot;in sign and send url = &quot; + url + &quot;\nurlSpec = &quot; + urlSpec);</span>
<a href="#l33.124"></a><span id="l33.124" class="difflineminus">-    this.log.info(&quot;dataParams = &quot; + dataParams);</span>
<a href="#l33.125"></a><span id="l33.125" class="difflineminus">-</span>
<a href="#l33.126"></a><span id="l33.126" class="difflineminus">-    let signature;</span>
<a href="#l33.127"></a><span id="l33.127" class="difflineminus">-    if (this.signatureMethod === &quot;HMAC-SHA1&quot;) {</span>
<a href="#l33.128"></a><span id="l33.128" class="difflineminus">-      let signatureKey = this.consumerSecret + &quot;&amp;&quot; + this.tokenSecret;</span>
<a href="#l33.129"></a><span id="l33.129" class="difflineminus">-      let signatureBase =</span>
<a href="#l33.130"></a><span id="l33.130" class="difflineminus">-        aMethod + &quot;&amp;&quot; + encodeURIComponent(urlSpec) + &quot;&amp;&quot; +</span>
<a href="#l33.131"></a><span id="l33.131" class="difflineminus">-        params.concat(dataParams)</span>
<a href="#l33.132"></a><span id="l33.132" class="difflineminus">-              .sort((a, b) =&gt; (a[0] &lt; b[0]) ? -1 : (a[0] &gt; b[0]) ? 1 : 0)</span>
<a href="#l33.133"></a><span id="l33.133" class="difflineminus">-              .map(p =&gt; p.map(percentEncode).join(&quot;%3D&quot;))</span>
<a href="#l33.134"></a><span id="l33.134" class="difflineminus">-              .join(&quot;%26&quot;);</span>
<a href="#l33.135"></a><span id="l33.135" class="difflineminus">-</span>
<a href="#l33.136"></a><span id="l33.136" class="difflineminus">-      this.log.info(&quot;sig base = &quot; + signatureBase);</span>
<a href="#l33.137"></a><span id="l33.137" class="difflineminus">-      let keyFactory = Cc[&quot;@mozilla.org/security/keyobjectfactory;1&quot;]</span>
<a href="#l33.138"></a><span id="l33.138" class="difflineminus">-                       .getService(Ci.nsIKeyObjectFactory);</span>
<a href="#l33.139"></a><span id="l33.139" class="difflineminus">-      let hmac =</span>
<a href="#l33.140"></a><span id="l33.140" class="difflineminus">-        Cc[&quot;@mozilla.org/security/hmac;1&quot;].createInstance(Ci.nsICryptoHMAC);</span>
<a href="#l33.141"></a><span id="l33.141" class="difflineminus">-      hmac.init(hmac.SHA1,</span>
<a href="#l33.142"></a><span id="l33.142" class="difflineminus">-                keyFactory.keyFromString(Ci.nsIKeyObject.HMAC, signatureKey));</span>
<a href="#l33.143"></a><span id="l33.143" class="difflineminus">-      // No UTF-8 encoding, special chars are already escaped.</span>
<a href="#l33.144"></a><span id="l33.144" class="difflineminus">-      let bytes = Array.from(signatureBase).map(b =&gt; b.charCodeAt(0));</span>
<a href="#l33.145"></a><span id="l33.145" class="difflineminus">-      hmac.update(bytes, bytes.length);</span>
<a href="#l33.146"></a><span id="l33.146" class="difflineminus">-      signature = encodeURIComponent(hmac.finish(true));</span>
<a href="#l33.147"></a><span id="l33.147" class="difflineminus">-    }</span>
<a href="#l33.148"></a><span id="l33.148" class="difflineminus">-    else if (this.signatureMethod == &quot;PLAINTEXT&quot;) {</span>
<a href="#l33.149"></a><span id="l33.149" class="difflineminus">-      signature = percentEncode(percentEncode(this.consumerSecret) + &quot;&amp;&quot; +</span>
<a href="#l33.150"></a><span id="l33.150" class="difflineminus">-                                percentEncode(this.tokenSecret));</span>
<a href="#l33.151"></a><span id="l33.151" class="difflineminus">-    }</span>
<a href="#l33.152"></a><span id="l33.152" class="difflineminus">-    else {</span>
<a href="#l33.153"></a><span id="l33.153" class="difflineminus">-      throw Cr.NS_ERROR_NOT_IMPLEMENTED;</span>
<a href="#l33.154"></a><span id="l33.154" class="difflineminus">-    }</span>
<a href="#l33.155"></a><span id="l33.155" class="difflineminus">-</span>
<a href="#l33.156"></a><span id="l33.156" class="difflineminus">-    params.push([&quot;oauth_signature&quot;, signature]);</span>
<a href="#l33.157"></a><span id="l33.157" class="difflineminus">-</span>
<a href="#l33.158"></a><span id="l33.158" class="difflineminus">-    let authorization =</span>
<a href="#l33.159"></a><span id="l33.159" class="difflineminus">-      &quot;OAuth &quot; + params.map(p =&gt; p[0] + &quot;=\&quot;&quot; + p[1] + &quot;\&quot;&quot;).join(&quot;, &quot;);</span>
<a href="#l33.160"></a><span id="l33.160" class="difflineminus">-    let options = {</span>
<a href="#l33.161"></a><span id="l33.161" class="difflineminus">-      headers: (aHeaders || []).concat([[&quot;Authorization&quot;, authorization]]),</span>
<a href="#l33.162"></a><span id="l33.162" class="difflineminus">-      postData: aPOSTData,</span>
<a href="#l33.163"></a><span id="l33.163" class="difflineminus">-      method: aMethod,</span>
<a href="#l33.164"></a><span id="l33.164" class="difflineminus">-      onLoad: aOnLoad.bind(aThis),</span>
<a href="#l33.165"></a><span id="l33.165" class="difflineminus">-      onError: aOnError.bind(aThis)</span>
<a href="#l33.166"></a><span id="l33.166" class="difflineminus">-    };</span>
<a href="#l33.167"></a><span id="l33.167" class="difflineminus">-    return httpRequest(url, options);</span>
<a href="#l33.168"></a><span id="l33.168" class="difflineminus">-  },</span>
<a href="#l33.169"></a><span id="l33.169" class="difflineminus">-  _parseURLData: function(aData) {</span>
<a href="#l33.170"></a><span id="l33.170" class="difflineminus">-    let result = {};</span>
<a href="#l33.171"></a><span id="l33.171" class="difflineminus">-    aData.split(&quot;&amp;&quot;).forEach(function (aParam) {</span>
<a href="#l33.172"></a><span id="l33.172" class="difflineminus">-      let [key, value] = aParam.split(&quot;=&quot;);</span>
<a href="#l33.173"></a><span id="l33.173" class="difflineminus">-      result[key] = value;</span>
<a href="#l33.174"></a><span id="l33.174" class="difflineminus">-    });</span>
<a href="#l33.175"></a><span id="l33.175" class="difflineminus">-    return result;</span>
<a href="#l33.176"></a><span id="l33.176" class="difflineminus">-  },</span>
<a href="#l33.177"></a><span id="l33.177" class="difflineminus">-</span>
<a href="#l33.178"></a><span id="l33.178" class="difflineminus">-  _streamingRequest: null,</span>
<a href="#l33.179"></a><span id="l33.179" class="difflineminus">-  _pendingData: &quot;&quot;,</span>
<a href="#l33.180"></a><span id="l33.180" class="difflineminus">-  _receivedLength: 0,</span>
<a href="#l33.181"></a><span id="l33.181" class="difflineminus">-  onDataAvailable: function(aRequest) {</span>
<a href="#l33.182"></a><span id="l33.182" class="difflineminus">-    let text = aRequest.target.responseText;</span>
<a href="#l33.183"></a><span id="l33.183" class="difflineminus">-    let newText = this._pendingData + text.slice(this._receivedLength);</span>
<a href="#l33.184"></a><span id="l33.184" class="difflineminus">-    this.log.info(&quot;Received data: &quot; + newText);</span>
<a href="#l33.185"></a><span id="l33.185" class="difflineminus">-    let messages = newText.split(/\r\n?/);</span>
<a href="#l33.186"></a><span id="l33.186" class="difflineminus">-  },</span>
<a href="#l33.187"></a><span id="l33.187" class="difflineminus">-</span>
<a href="#l33.188"></a><span id="l33.188" class="difflineminus">-  requestToken: function() {</span>
<a href="#l33.189"></a><span id="l33.189" class="difflineminus">-    let oauthParams =</span>
<a href="#l33.190"></a><span id="l33.190" class="difflineminus">-      [[&quot;oauth_callback&quot;, encodeURIComponent(this.completionURI)]];</span>
<a href="#l33.191"></a><span id="l33.191" class="difflineminus">-    this.signAndSend(this.tempCredentialsMethod,</span>
<a href="#l33.192"></a><span id="l33.192" class="difflineminus">-                     null, &quot;POST&quot;, null,</span>
<a href="#l33.193"></a><span id="l33.193" class="difflineminus">-                     this.onRequestTokenReceived,</span>
<a href="#l33.194"></a><span id="l33.194" class="difflineminus">-                     this.connectFailureCallback, this,</span>
<a href="#l33.195"></a><span id="l33.195" class="difflineminus">-                     oauthParams);</span>
<a href="#l33.196"></a><span id="l33.196" class="difflineminus">-  },</span>
<a href="#l33.197"></a><span id="l33.197" class="difflineminus">-  onRequestTokenReceived: function(aData) {</span>
<a href="#l33.198"></a><span id="l33.198" class="difflineminus">-    this.log.info(&quot;Received request token.&quot;);</span>
<a href="#l33.199"></a><span id="l33.199" class="difflineminus">-    let data = this._parseURLData(aData);</span>
<a href="#l33.200"></a><span id="l33.200" class="difflineminus">-    if (!data.oauth_token ||</span>
<a href="#l33.201"></a><span id="l33.201" class="difflineminus">-        (this.signatureMethod == &quot;HMAC-SHA1&quot; &amp;&amp; !data.oauth_token_secret)) {</span>
<a href="#l33.202"></a><span id="l33.202" class="difflineminus">-      this.log.info(&quot;didn't get request token&quot;);</span>
<a href="#l33.203"></a><span id="l33.203" class="difflineminus">-      this.connectFailureCallback();</span>
<a href="#l33.204"></a><span id="l33.204" class="difflineminus">-      return;</span>
<a href="#l33.205"></a><span id="l33.205" class="difflineminus">-    }</span>
<a href="#l33.206"></a><span id="l33.206" class="difflineminus">-    this.token = data.oauth_token;</span>
<a href="#l33.207"></a><span id="l33.207" class="difflineminus">-    this.tokenSecret = data.oauth_token_secret;</span>
<a href="#l33.208"></a><span id="l33.208" class="difflineminus">-</span>
<a href="#l33.209"></a><span id="l33.209" class="difflineminus">-    this.requestAuthorization();</span>
<a href="#l33.210"></a><span id="l33.210" class="difflineminus">-  },</span>
<a href="#l33.211"></a><span id="l33.211" class="difflineminus">-  requestAuthorization: function() {</span>
<a href="#l33.212"></a><span id="l33.212" class="difflineminus">-    this.log.info(&quot;requesting oauth&quot;);</span>
<a href="#l33.213"></a><span id="l33.213" class="difflineminus">-    const url = this.authURI + this.authorizeMethod + &quot;?oauth_token=&quot;;</span>
<a href="#l33.214"></a><span id="l33.214" class="difflineminus">-    this._browserRequest =</span>
<a href="#l33.215"></a><span id="l33.215" class="difflineminus">-      { promptText : &quot;auth prompt&quot;,</span>
<a href="#l33.216"></a><span id="l33.216" class="difflineminus">-        account: this,</span>
<a href="#l33.217"></a><span id="l33.217" class="difflineminus">-        url: url + this.token + &quot;&amp;oauth_callback=&quot; + this.completionURI,</span>
<a href="#l33.218"></a><span id="l33.218" class="difflineminus">-        _active: true,</span>
<a href="#l33.219"></a><span id="l33.219" class="difflineminus">-        iconURI : &quot;&quot;,  // would be nice to set this from the oauth user...</span>
<a href="#l33.220"></a><span id="l33.220" class="difflineminus">-        cancelled: function() {</span>
<a href="#l33.221"></a><span id="l33.221" class="difflineminus">-          if (!this._active)</span>
<a href="#l33.222"></a><span id="l33.222" class="difflineminus">-            return;</span>
<a href="#l33.223"></a><span id="l33.223" class="difflineminus">-          this.account.log.info(&quot;auth cancelled&quot;);</span>
<a href="#l33.224"></a><span id="l33.224" class="difflineminus">-          this.account.finishAuthorizationRequest();</span>
<a href="#l33.225"></a><span id="l33.225" class="difflineminus">-          this.account.onAuthorizationReceived(null);</span>
<a href="#l33.226"></a><span id="l33.226" class="difflineminus">-          this.account.connectFailureCallback();</span>
<a href="#l33.227"></a><span id="l33.227" class="difflineminus">-        // ### auth cancelled.</span>
<a href="#l33.228"></a><span id="l33.228" class="difflineminus">-        },</span>
<a href="#l33.229"></a><span id="l33.229" class="difflineminus">-        loaded: function(aWindow, aWebProgress) {</span>
<a href="#l33.230"></a><span id="l33.230" class="difflineminus">-          if (!this._active)</span>
<a href="#l33.231"></a><span id="l33.231" class="difflineminus">-            return;</span>
<a href="#l33.232"></a><span id="l33.232" class="difflineminus">-</span>
<a href="#l33.233"></a><span id="l33.233" class="difflineminus">-          this._listener = {</span>
<a href="#l33.234"></a><span id="l33.234" class="difflineminus">-            QueryInterface: ChromeUtils.generateQI([Ci.nsIWebProgressListener,</span>
<a href="#l33.235"></a><span id="l33.235" class="difflineminus">-                                                    Ci.nsISupportsWeakReference]),</span>
<a href="#l33.236"></a><span id="l33.236" class="difflineminus">-            _cleanUp: function() {</span>
<a href="#l33.237"></a><span id="l33.237" class="difflineminus">-              this.webProgress.removeProgressListener(this);</span>
<a href="#l33.238"></a><span id="l33.238" class="difflineminus">-              this.window.close();</span>
<a href="#l33.239"></a><span id="l33.239" class="difflineminus">-              delete this.window;</span>
<a href="#l33.240"></a><span id="l33.240" class="difflineminus">-            },</span>
<a href="#l33.241"></a><span id="l33.241" class="difflineminus">-            _checkForRedirect: function(aURL) {</span>
<a href="#l33.242"></a><span id="l33.242" class="difflineminus">-              if (!aURL.startsWith(this._parent.completionURI))</span>
<a href="#l33.243"></a><span id="l33.243" class="difflineminus">-                return;</span>
<a href="#l33.244"></a><span id="l33.244" class="difflineminus">-</span>
<a href="#l33.245"></a><span id="l33.245" class="difflineminus">-              this._parent.finishAuthorizationRequest();</span>
<a href="#l33.246"></a><span id="l33.246" class="difflineminus">-              this._parent.onAuthorizationReceived(aURL);</span>
<a href="#l33.247"></a><span id="l33.247" class="difflineminus">-            },</span>
<a href="#l33.248"></a><span id="l33.248" class="difflineminus">-            onStateChange: function(aWebProgress, aRequest, aStateFlags, aStatus) {</span>
<a href="#l33.249"></a><span id="l33.249" class="difflineminus">-              const wpl = Ci.nsIWebProgressListener;</span>
<a href="#l33.250"></a><span id="l33.250" class="difflineminus">-              if (aStateFlags &amp; (wpl.STATE_START | wpl.STATE_IS_NETWORK))</span>
<a href="#l33.251"></a><span id="l33.251" class="difflineminus">-                this._checkForRedirect(aRequest.name);</span>
<a href="#l33.252"></a><span id="l33.252" class="difflineminus">-            },</span>
<a href="#l33.253"></a><span id="l33.253" class="difflineminus">-            onLocationChange: function(aWebProgress, aRequest, aLocation) {</span>
<a href="#l33.254"></a><span id="l33.254" class="difflineminus">-              this._checkForRedirect(aLocation.spec);</span>
<a href="#l33.255"></a><span id="l33.255" class="difflineminus">-            },</span>
<a href="#l33.256"></a><span id="l33.256" class="difflineminus">-            onProgressChange: function() {},</span>
<a href="#l33.257"></a><span id="l33.257" class="difflineminus">-            onStatusChange: function() {},</span>
<a href="#l33.258"></a><span id="l33.258" class="difflineminus">-            onSecurityChange: function() {},</span>
<a href="#l33.259"></a><span id="l33.259" class="difflineminus">-</span>
<a href="#l33.260"></a><span id="l33.260" class="difflineminus">-            window: aWindow,</span>
<a href="#l33.261"></a><span id="l33.261" class="difflineminus">-            webProgress: aWebProgress,</span>
<a href="#l33.262"></a><span id="l33.262" class="difflineminus">-            _parent: this.account</span>
<a href="#l33.263"></a><span id="l33.263" class="difflineminus">-          };</span>
<a href="#l33.264"></a><span id="l33.264" class="difflineminus">-        aWebProgress.addProgressListener(this._listener,</span>
<a href="#l33.265"></a><span id="l33.265" class="difflineminus">-                                         Ci.nsIWebProgress.NOTIFY_ALL);</span>
<a href="#l33.266"></a><span id="l33.266" class="difflineminus">-      },</span>
<a href="#l33.267"></a><span id="l33.267" class="difflineminus">-    };</span>
<a href="#l33.268"></a><span id="l33.268" class="difflineminus">-     this.wrappedJSObject = this._browserRequest;</span>
<a href="#l33.269"></a><span id="l33.269" class="difflineminus">-     Services.ww.openWindow(null,</span>
<a href="#l33.270"></a><span id="l33.270" class="difflineminus">-                            &quot;chrome://messenger/content/browserRequest.xul&quot;,</span>
<a href="#l33.271"></a><span id="l33.271" class="difflineminus">-                             null, &quot;chrome,centerscreen,width=980px,height=600px&quot;, this);</span>
<a href="#l33.272"></a><span id="l33.272" class="difflineminus">-  },</span>
<a href="#l33.273"></a><span id="l33.273" class="difflineminus">-  finishAuthorizationRequest: function() {</span>
<a href="#l33.274"></a><span id="l33.274" class="difflineminus">-    if (!(&quot;_browserRequest&quot; in this))</span>
<a href="#l33.275"></a><span id="l33.275" class="difflineminus">-      return;</span>
<a href="#l33.276"></a><span id="l33.276" class="difflineminus">-</span>
<a href="#l33.277"></a><span id="l33.277" class="difflineminus">-    this._browserRequest._active = false;</span>
<a href="#l33.278"></a><span id="l33.278" class="difflineminus">-    if (&quot;_listener&quot; in this._browserRequest)</span>
<a href="#l33.279"></a><span id="l33.279" class="difflineminus">-      this._browserRequest._listener._cleanUp();</span>
<a href="#l33.280"></a><span id="l33.280" class="difflineminus">-    delete this._browserRequest;</span>
<a href="#l33.281"></a><span id="l33.281" class="difflineminus">-  },</span>
<a href="#l33.282"></a><span id="l33.282" class="difflineminus">-  onAuthorizationReceived: function(aData) {</span>
<a href="#l33.283"></a><span id="l33.283" class="difflineminus">-    this.log.info(&quot;authorization received&quot;);</span>
<a href="#l33.284"></a><span id="l33.284" class="difflineminus">-    let data = this._parseURLData(aData);</span>
<a href="#l33.285"></a><span id="l33.285" class="difflineminus">-</span>
<a href="#l33.286"></a><span id="l33.286" class="difflineminus">-    this.requestAccessToken([[&quot;oauth_verifier&quot;, data.oauth_verifier]]);</span>
<a href="#l33.287"></a><span id="l33.287" class="difflineminus">-  },</span>
<a href="#l33.288"></a><span id="l33.288" class="difflineminus">-  requestAccessToken: function(aVerifier) {</span>
<a href="#l33.289"></a><span id="l33.289" class="difflineminus">-    this.signAndSend(this.requestCredentialsMethod, null, &quot;POST&quot;, null,</span>
<a href="#l33.290"></a><span id="l33.290" class="difflineminus">-                     this.onAccessTokenReceived, this.connectFailureCallback, this,</span>
<a href="#l33.291"></a><span id="l33.291" class="difflineminus">-                     aVerifier);</span>
<a href="#l33.292"></a><span id="l33.292" class="difflineminus">-  },</span>
<a href="#l33.293"></a><span id="l33.293" class="difflineminus">-  onAccessTokenReceived: function(aData) {</span>
<a href="#l33.294"></a><span id="l33.294" class="difflineminus">-    this.log.info(&quot;Received access token. urlData = &quot; + aData);</span>
<a href="#l33.295"></a><span id="l33.295" class="difflineminus">-    let result = this._parseURLData(aData);</span>
<a href="#l33.296"></a><span id="l33.296" class="difflineminus">-</span>
<a href="#l33.297"></a><span id="l33.297" class="difflineminus">-    this.token = result.oauth_token;</span>
<a href="#l33.298"></a><span id="l33.298" class="difflineminus">-    this.tokenSecret = result.oauth_token_secret;</span>
<a href="#l33.299"></a><span id="l33.299" class="difflineminus">-    this.connectSuccessCallback(result);</span>
<a href="#l33.300"></a><span id="l33.300" class="difflineminus">-  },</span>
<a href="#l33.301"></a><span id="l33.301" class="difflineminus">-</span>
<a href="#l33.302"></a><span id="l33.302" class="difflineminus">-</span>
<a href="#l33.303"></a><span id="l33.303" class="difflineminus">-  cleanUp: function() {</span>
<a href="#l33.304"></a><span id="l33.304" class="difflineminus">-    this.finishAuthorizationRequest();</span>
<a href="#l33.305"></a><span id="l33.305" class="difflineminus">-    if (this._pendingRequests.length != 0) {</span>
<a href="#l33.306"></a><span id="l33.306" class="difflineminus">-      for (let request of this._pendingRequests)</span>
<a href="#l33.307"></a><span id="l33.307" class="difflineminus">-        request.abort();</span>
<a href="#l33.308"></a><span id="l33.308" class="difflineminus">-      delete this._pendingRequests;</span>
<a href="#l33.309"></a><span id="l33.309" class="difflineminus">-    }</span>
<a href="#l33.310"></a><span id="l33.310" class="difflineminus">-    if (this._streamingRequest) {</span>
<a href="#l33.311"></a><span id="l33.311" class="difflineminus">-      this._streamingRequest.abort();</span>
<a href="#l33.312"></a><span id="l33.312" class="difflineminus">-      delete this._streamingRequest;</span>
<a href="#l33.313"></a><span id="l33.313" class="difflineminus">-    }</span>
<a href="#l33.314"></a><span id="l33.314" class="difflineminus">-  },</span>
<a href="#l33.315"></a><span id="l33.315" class="difflineminus">-  unInit: function() {</span>
<a href="#l33.316"></a><span id="l33.316" class="difflineminus">-    this.cleanUp();</span>
<a href="#l33.317"></a><span id="l33.317" class="difflineminus">-  },</span>
<a href="#l33.318"></a><span id="l33.318" class="difflineminus">-};</span>
<a href="#l33.319"></a><span id="l33.319" class="difflineminus">-</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/mail/base/test/unit/resources/viewWrapperTestUtils.js</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/mail/base/test/unit/resources/viewWrapperTestUtils.js</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -1,14 +1,14 @@</span>
<a href="#l34.4"></a><span id="l34.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l34.5"></a><span id="l34.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l34.6"></a><span id="l34.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l34.7"></a><span id="l34.7"> </span>
<a href="#l34.8"></a><span id="l34.8" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/dbViewWrapper.js&quot;);</span>
<a href="#l34.9"></a><span id="l34.9" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/mailViewManager.js&quot;);</span>
<a href="#l34.10"></a><span id="l34.10" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/DBViewWrapper.jsm&quot;);</span>
<a href="#l34.11"></a><span id="l34.11" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailViewManager.jsm&quot;);</span>
<a href="#l34.12"></a><span id="l34.12"> ChromeUtils.import(&quot;resource:///modules/virtualFolderWrapper.js&quot;);</span>
<a href="#l34.13"></a><span id="l34.13"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l34.14"></a><span id="l34.14"> </span>
<a href="#l34.15"></a><span id="l34.15"> var gInbox;</span>
<a href="#l34.16"></a><span id="l34.16"> </span>
<a href="#l34.17"></a><span id="l34.17"> /**</span>
<a href="#l34.18"></a><span id="l34.18">  * Do initialization for xpcshell-tests; not used by</span>
<a href="#l34.19"></a><span id="l34.19">  *  test-folder-display-helpers.js, our friendly mozmill test helper.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/mail/base/test/unit/test_attachmentChecker.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/mail/base/test/unit/test_attachmentChecker.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -2,24 +2,24 @@</span>
<a href="#l35.4"></a><span id="l35.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l35.5"></a><span id="l35.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l35.6"></a><span id="l35.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l35.7"></a><span id="l35.7"> </span>
<a href="#l35.8"></a><span id="l35.8"> /*</span>
<a href="#l35.9"></a><span id="l35.9">  * Test suite for the attachmentChecker class</span>
<a href="#l35.10"></a><span id="l35.10">  *</span>
<a href="#l35.11"></a><span id="l35.11">  * Currently tested:</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">- * - GetAttachmentKeywords function.</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineplus">+ * - getAttachmentKeywords function.</span>
<a href="#l35.14"></a><span id="l35.14">  */</span>
<a href="#l35.15"></a><span id="l35.15"> </span>
<a href="#l35.16"></a><span id="l35.16"> // make xpcshell-tests TEST_PATH=mail/base/test/unit/test_attachmentChecker.js</span>
<a href="#l35.17"></a><span id="l35.17"> </span>
<a href="#l35.18"></a><span id="l35.18"> // Globals</span>
<a href="#l35.19"></a><span id="l35.19"> </span>
<a href="#l35.20"></a><span id="l35.20" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/attachmentChecker.js&quot;);</span>
<a href="#l35.21"></a><span id="l35.21" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/AttachmentChecker.jsm&quot;);</span>
<a href="#l35.22"></a><span id="l35.22"> </span>
<a href="#l35.23"></a><span id="l35.23"> /*</span>
<a href="#l35.24"></a><span id="l35.24">  * UTILITIES</span>
<a href="#l35.25"></a><span id="l35.25">  */</span>
<a href="#l35.26"></a><span id="l35.26"> </span>
<a href="#l35.27"></a><span id="l35.27"> function assert(aBeTrue, aWhy)</span>
<a href="#l35.28"></a><span id="l35.28"> {</span>
<a href="#l35.29"></a><span id="l35.29">   if (!aBeTrue)</span>
<a href="#l35.30"></a><span id="l35.30" class="difflineat">@@ -31,19 +31,19 @@ function assert_equal(aA, aB, aWhy)</span>
<a href="#l35.31"></a><span id="l35.31">   assert(aA == aB, aWhy + &quot; (&quot; + unescape(encodeURIComponent(aA)) + &quot; != &quot; +</span>
<a href="#l35.32"></a><span id="l35.32">                                  unescape(encodeURIComponent(aB)) + &quot;).&quot;);</span>
<a href="#l35.33"></a><span id="l35.33"> };</span>
<a href="#l35.34"></a><span id="l35.34"> </span>
<a href="#l35.35"></a><span id="l35.35"> /*</span>
<a href="#l35.36"></a><span id="l35.36">  * TESTS</span>
<a href="#l35.37"></a><span id="l35.37">  */</span>
<a href="#l35.38"></a><span id="l35.38"> </span>
<a href="#l35.39"></a><span id="l35.39" class="difflineminus">-function test_GetAttachmentKeywords(desc, mailData, keywords, expected)</span>
<a href="#l35.40"></a><span id="l35.40" class="difflineplus">+function test_getAttachmentKeywords(desc, mailData, keywords, expected)</span>
<a href="#l35.41"></a><span id="l35.41"> {</span>
<a href="#l35.42"></a><span id="l35.42" class="difflineminus">-  let result = GetAttachmentKeywords(mailData, keywords);</span>
<a href="#l35.43"></a><span id="l35.43" class="difflineplus">+  let result = AttachmentChecker.getAttachmentKeywords(mailData, keywords);</span>
<a href="#l35.44"></a><span id="l35.44">   assert_equal(result, expected, desc + &quot; not equal!&quot;);</span>
<a href="#l35.45"></a><span id="l35.45"> }</span>
<a href="#l35.46"></a><span id="l35.46"> </span>
<a href="#l35.47"></a><span id="l35.47"> var tests = [</span>
<a href="#l35.48"></a><span id="l35.48">   // Desc, mail body Data, keywords to search for, expected keywords found.</span>
<a href="#l35.49"></a><span id="l35.49">   [&quot;Simple keyword&quot;, &quot;latte.ca&quot;, &quot;latte&quot;, &quot;latte&quot;],</span>
<a href="#l35.50"></a><span id="l35.50">   [&quot;Extension&quot;, &quot;testing document.pdf&quot;, &quot;.pdf&quot;, &quot;document.pdf&quot;],</span>
<a href="#l35.51"></a><span id="l35.51">   [&quot;Two Extensions&quot;, &quot;testing document.pdf and test.pdf&quot;, &quot;.pdf&quot;,</span>
<a href="#l35.52"></a><span id="l35.52" class="difflineat">@@ -77,12 +77,12 @@ var tests = [</span>
<a href="#l35.53"></a><span id="l35.53"> function run_test()</span>
<a href="#l35.54"></a><span id="l35.54"> {</span>
<a href="#l35.55"></a><span id="l35.55">   do_test_pending();</span>
<a href="#l35.56"></a><span id="l35.56"> </span>
<a href="#l35.57"></a><span id="l35.57">   for (var i in tests)</span>
<a href="#l35.58"></a><span id="l35.58">     if (typeof(tests[i]) == &quot;function&quot;)</span>
<a href="#l35.59"></a><span id="l35.59">       tests[i]();</span>
<a href="#l35.60"></a><span id="l35.60">     else</span>
<a href="#l35.61"></a><span id="l35.61" class="difflineminus">-      test_GetAttachmentKeywords.apply(null, tests[i]);</span>
<a href="#l35.62"></a><span id="l35.62" class="difflineplus">+      test_getAttachmentKeywords.apply(null, tests[i]);</span>
<a href="#l35.63"></a><span id="l35.63"> </span>
<a href="#l35.64"></a><span id="l35.64">   do_test_finished();</span>
<a href="#l35.65"></a><span id="l35.65"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/mail/base/test/unit/test_mailGlue_distribution.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/mail/base/test/unit/test_mailGlue_distribution.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -1,9 +1,9 @@</span>
<a href="#l36.4"></a><span id="l36.4" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/distribution.js&quot;);</span>
<a href="#l36.5"></a><span id="l36.5" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/TBDistCustomizer.jsm&quot;);</span>
<a href="#l36.6"></a><span id="l36.6"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l36.7"></a><span id="l36.7"> </span>
<a href="#l36.8"></a><span id="l36.8"> function run_test()</span>
<a href="#l36.9"></a><span id="l36.9"> {</span>
<a href="#l36.10"></a><span id="l36.10">   do_test_pending();</span>
<a href="#l36.11"></a><span id="l36.11"> </span>
<a href="#l36.12"></a><span id="l36.12">   Services.locale.requestedLocales = [&quot;en-US&quot;];</span>
<a href="#l36.13"></a><span id="l36.13"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/mail/base/test/unit/test_windows_font_migration.js</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/mail/base/test/unit/test_windows_font_migration.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -4,17 +4,17 @@</span>
<a href="#l37.4"></a><span id="l37.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l37.5"></a><span id="l37.5"> </span>
<a href="#l37.6"></a><span id="l37.6"> /*</span>
<a href="#l37.7"></a><span id="l37.7">  * Test font preference migration. This currently only makes sense on Windows --</span>
<a href="#l37.8"></a><span id="l37.8">  * however, we're able to test for all versions of Windows, regardless of which</span>
<a href="#l37.9"></a><span id="l37.9">  * version the test is run on.</span>
<a href="#l37.10"></a><span id="l37.10">  */</span>
<a href="#l37.11"></a><span id="l37.11"> </span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/mailMigrator.js&quot;);</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailMigrator.jsm&quot;);</span>
<a href="#l37.14"></a><span id="l37.14"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l37.15"></a><span id="l37.15"> </span>
<a href="#l37.16"></a><span id="l37.16"> /**</span>
<a href="#l37.17"></a><span id="l37.17">  * A list of font names to verify using |makeVerifier| and</span>
<a href="#l37.18"></a><span id="l37.18">  * |verifier|. |makeVerifier| expects all the prefs to be passed in, while</span>
<a href="#l37.19"></a><span id="l37.19">  * |verifier| doesn't require any.</span>
<a href="#l37.20"></a><span id="l37.20">  */</span>
<a href="#l37.21"></a><span id="l37.21"> var kNamesToVerify = [&quot;serif&quot;, &quot;sans&quot;, &quot;monospace&quot;];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/mail/components/compose/content/MsgComposeCommands.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -5,23 +5,23 @@</span>
<a href="#l38.4"></a><span id="l38.4"> /* import-globals-from addressingWidgetOverlay.js */</span>
<a href="#l38.5"></a><span id="l38.5"> </span>
<a href="#l38.6"></a><span id="l38.6"> /**</span>
<a href="#l38.7"></a><span id="l38.7">  * Commands for the message composition window.</span>
<a href="#l38.8"></a><span id="l38.8">  */</span>
<a href="#l38.9"></a><span id="l38.9"> </span>
<a href="#l38.10"></a><span id="l38.10"> // Ensure the activity modules are loaded for this window.</span>
<a href="#l38.11"></a><span id="l38.11"> ChromeUtils.import(&quot;resource:///modules/activity/activityModules.jsm&quot;);</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-const { GetAttachmentKeywords } = ChromeUtils.import(&quot;resource:///modules/attachmentChecker.js&quot;, null);</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/AttachmentChecker.jsm&quot;);</span>
<a href="#l38.14"></a><span id="l38.14"> ChromeUtils.import(&quot;resource:///modules/cloudFileAccounts.js&quot;);</span>
<a href="#l38.15"></a><span id="l38.15"> const { MimeParser } = ChromeUtils.import(&quot;resource:///modules/mimeParser.jsm&quot;, null);</span>
<a href="#l38.16"></a><span id="l38.16"> const { allAccountsSorted } = ChromeUtils.import(&quot;resource:///modules/folderUtils.jsm&quot;, null);</span>
<a href="#l38.17"></a><span id="l38.17"> const { fixIterator, toArray } = ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;, null);</span>
<a href="#l38.18"></a><span id="l38.18"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l38.19"></a><span id="l38.19" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l38.20"></a><span id="l38.20" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l38.21"></a><span id="l38.21"> ChromeUtils.import(&quot;resource://gre/modules/InlineSpellChecker.jsm&quot;);</span>
<a href="#l38.22"></a><span id="l38.22"> ChromeUtils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l38.23"></a><span id="l38.23"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l38.24"></a><span id="l38.24"> ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l38.25"></a><span id="l38.25"> ChromeUtils.import(&quot;resource://gre/modules/AppConstants.jsm&quot;);</span>
<a href="#l38.26"></a><span id="l38.26"> </span>
<a href="#l38.27"></a><span id="l38.27"> ChromeUtils.defineModuleGetter(this, &quot;OS&quot;, &quot;resource://gre/modules/osfile.jsm&quot;);</span>
<a href="#l38.28"></a><span id="l38.28"> ChromeUtils.defineModuleGetter(this, &quot;ShortcutUtils&quot;,</span>
<a href="#l38.29"></a><span id="l38.29" class="difflineat">@@ -2232,17 +2232,17 @@ function manageAttachmentNotification(aF</span>
<a href="#l38.30"></a><span id="l38.30">  * Returns whether the attachment notification should be suppressed regardless of</span>
<a href="#l38.31"></a><span id="l38.31">  * the state of keywords.</span>
<a href="#l38.32"></a><span id="l38.32">  */</span>
<a href="#l38.33"></a><span id="l38.33"> function attachmentNotificationSupressed() {</span>
<a href="#l38.34"></a><span id="l38.34">   return (gDisableAttachmentReminder || gManualAttachmentReminder ||</span>
<a href="#l38.35"></a><span id="l38.35">           AttachmentElementHasItems());</span>
<a href="#l38.36"></a><span id="l38.36"> }</span>
<a href="#l38.37"></a><span id="l38.37"> </span>
<a href="#l38.38"></a><span id="l38.38" class="difflineminus">-var attachmentWorker = new Worker(&quot;resource:///modules/attachmentChecker.js&quot;);</span>
<a href="#l38.39"></a><span id="l38.39" class="difflineplus">+var attachmentWorker = new Worker(&quot;resource:///modules/AttachmentChecker.jsm&quot;);</span>
<a href="#l38.40"></a><span id="l38.40"> </span>
<a href="#l38.41"></a><span id="l38.41"> // The array of currently found keywords. Or null if keyword detection wasn't</span>
<a href="#l38.42"></a><span id="l38.42"> // run yet so we don't know.</span>
<a href="#l38.43"></a><span id="l38.43"> attachmentWorker.lastMessage = null;</span>
<a href="#l38.44"></a><span id="l38.44"> </span>
<a href="#l38.45"></a><span id="l38.45"> attachmentWorker.onerror = function(error) {</span>
<a href="#l38.46"></a><span id="l38.46">   Cu.reportError(&quot;Attachment Notification Worker error!!! &quot; + error.message);</span>
<a href="#l38.47"></a><span id="l38.47">   throw error;</span>
<a href="#l38.48"></a><span id="l38.48" class="difflineat">@@ -6474,17 +6474,17 @@ var gAttachmentNotifier = {</span>
<a href="#l38.49"></a><span id="l38.49">           gComposeType == Ci.nsIMsgCompType.Draft ||</span>
<a href="#l38.50"></a><span id="l38.50">           gComposeType == Ci.nsIMsgCompType.Template ||</span>
<a href="#l38.51"></a><span id="l38.51">           gComposeType == Ci.nsIMsgCompType.EditTemplate ||</span>
<a href="#l38.52"></a><span id="l38.52">           gComposeType == Ci.nsIMsgCompType.EditAsNew ||</span>
<a href="#l38.53"></a><span id="l38.53">           gComposeType == Ci.nsIMsgCompType.MailToUrl))))</span>
<a href="#l38.54"></a><span id="l38.54">       mailData = subject + &quot; &quot; + mailData;</span>
<a href="#l38.55"></a><span id="l38.55"> </span>
<a href="#l38.56"></a><span id="l38.56">     if (!async)</span>
<a href="#l38.57"></a><span id="l38.57" class="difflineminus">-      return GetAttachmentKeywords(mailData, keywordsInCsv);</span>
<a href="#l38.58"></a><span id="l38.58" class="difflineplus">+      return AttachmentChecker.getAttachmentKeywords(mailData, keywordsInCsv);</span>
<a href="#l38.59"></a><span id="l38.59"> </span>
<a href="#l38.60"></a><span id="l38.60">     attachmentWorker.postMessage([mailData, keywordsInCsv]);</span>
<a href="#l38.61"></a><span id="l38.61">     return null;</span>
<a href="#l38.62"></a><span id="l38.62">   },</span>
<a href="#l38.63"></a><span id="l38.63"> </span>
<a href="#l38.64"></a><span id="l38.64">   shutdown: function gAN_shutdown() {</span>
<a href="#l38.65"></a><span id="l38.65">     if (this._obs)</span>
<a href="#l38.66"></a><span id="l38.66">       this._obs.disconnect();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/mail/components/mailGlue.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/mail/components/mailGlue.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -4,18 +4,18 @@</span>
<a href="#l39.4"></a><span id="l39.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l39.5"></a><span id="l39.5"> </span>
<a href="#l39.6"></a><span id="l39.6"> &quot;use strict&quot;;</span>
<a href="#l39.7"></a><span id="l39.7"> </span>
<a href="#l39.8"></a><span id="l39.8"> ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l39.9"></a><span id="l39.9"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l39.10"></a><span id="l39.10"> ChromeUtils.import(&quot;resource://gre/modules/AddonManager.jsm&quot;);</span>
<a href="#l39.11"></a><span id="l39.11"> ChromeUtils.import(&quot;resource://gre/modules/LightweightThemeConsumer.jsm&quot;);</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-const { TBDistCustomizer } = ChromeUtils.import(&quot;resource:///modules/distribution.js&quot;, null);</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineminus">-const { MailMigrator } = ChromeUtils.import(&quot;resource:///modules/mailMigrator.js&quot;, null);</span>
<a href="#l39.14"></a><span id="l39.14" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/TBDistCustomizer.jsm&quot;);</span>
<a href="#l39.15"></a><span id="l39.15" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailMigrator.jsm&quot;);</span>
<a href="#l39.16"></a><span id="l39.16"> const {</span>
<a href="#l39.17"></a><span id="l39.17">   ExtensionSupport,</span>
<a href="#l39.18"></a><span id="l39.18">   extensionDefaults,</span>
<a href="#l39.19"></a><span id="l39.19"> } = ChromeUtils.import(&quot;resource:///modules/extensionSupport.jsm&quot;, null);</span>
<a href="#l39.20"></a><span id="l39.20"> const { L10nRegistry, FileSource } = ChromeUtils.import(&quot;resource://gre/modules/L10nRegistry.jsm&quot;, null);</span>
<a href="#l39.21"></a><span id="l39.21"> </span>
<a href="#l39.22"></a><span id="l39.22"> // lazy module getters</span>
<a href="#l39.23"></a><span id="l39.23"> </span>
<a href="#l39.24"></a><span id="l39.24" class="difflineat">@@ -35,17 +35,17 @@ ChromeUtils.defineModuleGetter(this, &quot;Ac</span>
<a href="#l39.25"></a><span id="l39.25">                                &quot;resource://gre/modules/ActorManagerParent.jsm&quot;);</span>
<a href="#l39.26"></a><span id="l39.26"> </span>
<a href="#l39.27"></a><span id="l39.27"> let ACTORS = {</span>
<a href="#l39.28"></a><span id="l39.28"> };</span>
<a href="#l39.29"></a><span id="l39.29"> </span>
<a href="#l39.30"></a><span id="l39.30"> /**</span>
<a href="#l39.31"></a><span id="l39.31">  * Glue code that should be executed before any windows are opened. Any</span>
<a href="#l39.32"></a><span id="l39.32">  * window-independent helper methods (a la nsBrowserGlue.js) should go in</span>
<a href="#l39.33"></a><span id="l39.33" class="difflineminus">- * MailUtils.js instead.</span>
<a href="#l39.34"></a><span id="l39.34" class="difflineplus">+ * MailUtils.jsm instead.</span>
<a href="#l39.35"></a><span id="l39.35">  */</span>
<a href="#l39.36"></a><span id="l39.36"> </span>
<a href="#l39.37"></a><span id="l39.37"> function MailGlue() {</span>
<a href="#l39.38"></a><span id="l39.38">   XPCOMUtils.defineLazyGetter(this, &quot;_sanitizer&quot;,</span>
<a href="#l39.39"></a><span id="l39.39">     function() {</span>
<a href="#l39.40"></a><span id="l39.40">       let sanitizerScope = {};</span>
<a href="#l39.41"></a><span id="l39.41">       Services.scriptloader.loadSubScript(&quot;chrome://messenger/content/sanitize.js&quot;, sanitizerScope);</span>
<a href="#l39.42"></a><span id="l39.42">       return sanitizerScope.Sanitizer;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/mail/components/nsMailDefaultHandler.js</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/mail/components/nsMailDefaultHandler.js</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -34,17 +34,17 @@ function resolveURIInternal(aCmdLine, aA</span>
<a href="#l40.4"></a><span id="l40.4">     Cu.reportError(e);</span>
<a href="#l40.5"></a><span id="l40.5">   }</span>
<a href="#l40.6"></a><span id="l40.6"> </span>
<a href="#l40.7"></a><span id="l40.7">   return uri;</span>
<a href="#l40.8"></a><span id="l40.8"> }</span>
<a href="#l40.9"></a><span id="l40.9"> </span>
<a href="#l40.10"></a><span id="l40.10"> function handleIndexerResult(aFile) {</span>
<a href="#l40.11"></a><span id="l40.11">   // Do this here because xpcshell isn't too happy with this at startup</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-  ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+  ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l40.14"></a><span id="l40.14">   // Make sure the folder tree is initialized</span>
<a href="#l40.15"></a><span id="l40.15">   MailUtils.discoverFolders();</span>
<a href="#l40.16"></a><span id="l40.16"> </span>
<a href="#l40.17"></a><span id="l40.17">   // Use the search integration module to convert the indexer result into a</span>
<a href="#l40.18"></a><span id="l40.18">   // message header</span>
<a href="#l40.19"></a><span id="l40.19">   ChromeUtils.import(&quot;resource:///modules/SearchIntegration.jsm&quot;);</span>
<a href="#l40.20"></a><span id="l40.20">   let msgHdr = SearchIntegration.handleResult(aFile);</span>
<a href="#l40.21"></a><span id="l40.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/mail/components/search/content/SpotlightIntegration.js</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/mail/components/search/content/SpotlightIntegration.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -1,17 +1,17 @@</span>
<a href="#l41.4"></a><span id="l41.4"> /* -*- Mode: JavaScript; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l41.5"></a><span id="l41.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l41.6"></a><span id="l41.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l41.7"></a><span id="l41.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l41.8"></a><span id="l41.8"> </span>
<a href="#l41.9"></a><span id="l41.9"> // SearchIntegration.jsm</span>
<a href="#l41.10"></a><span id="l41.10"> /* globals SearchIntegration, SearchSupport, Services */</span>
<a href="#l41.11"></a><span id="l41.11"> </span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l41.14"></a><span id="l41.14"> </span>
<a href="#l41.15"></a><span id="l41.15"> var MSG_DB_LARGE_COMMIT = 1;</span>
<a href="#l41.16"></a><span id="l41.16"> var gFileHeader = &quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&lt;!DOCTYPE plist PUBLIC \&quot;-//Apple Computer//DTD PLIST 1.0//EN\&quot; \&quot;http://www.apple.\ncom/DTDs/PropertyList-1.0.dtd\&quot;&gt;\n&lt;plist version=\&quot;1.0\&quot;&gt;\n&lt;dict&gt;&quot;;</span>
<a href="#l41.17"></a><span id="l41.17"> </span>
<a href="#l41.18"></a><span id="l41.18"> SearchIntegration = { // eslint-disable-line no-global-assign</span>
<a href="#l41.19"></a><span id="l41.19">   __proto__: SearchSupport,</span>
<a href="#l41.20"></a><span id="l41.20"> </span>
<a href="#l41.21"></a><span id="l41.21">   // The property of the header and (sometimes) folders that's used to check</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/mail/components/search/content/WinSearchIntegration.js</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/mail/components/search/content/WinSearchIntegration.js</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -1,17 +1,17 @@</span>
<a href="#l42.4"></a><span id="l42.4"> /* -*- Mode: JavaScript; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l42.5"></a><span id="l42.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l42.6"></a><span id="l42.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l42.7"></a><span id="l42.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l42.8"></a><span id="l42.8"> </span>
<a href="#l42.9"></a><span id="l42.9"> // SearchIntegration.jsm</span>
<a href="#l42.10"></a><span id="l42.10"> /* globals SearchIntegration, SearchSupport, Services */</span>
<a href="#l42.11"></a><span id="l42.11"> </span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l42.14"></a><span id="l42.14"> </span>
<a href="#l42.15"></a><span id="l42.15"> var MSG_DB_LARGE_COMMIT = 1;</span>
<a href="#l42.16"></a><span id="l42.16"> var CRLF = &quot;\r\n&quot;;</span>
<a href="#l42.17"></a><span id="l42.17"> </span>
<a href="#l42.18"></a><span id="l42.18"> /**</span>
<a href="#l42.19"></a><span id="l42.19">  * Required to access the 64-bit registry, even though we're probably a 32-bit</span>
<a href="#l42.20"></a><span id="l42.20">  * program</span>
<a href="#l42.21"></a><span id="l42.21">  */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/mail/extensions/mailviews/content/msgViewPickerOverlay.js</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/mail/extensions/mailviews/content/msgViewPickerOverlay.js</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l43.4"></a><span id="l43.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l43.5"></a><span id="l43.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l43.6"></a><span id="l43.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l43.7"></a><span id="l43.7"> </span>
<a href="#l43.8"></a><span id="l43.8"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l43.9"></a><span id="l43.9" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/mailViewManager.js&quot;);</span>
<a href="#l43.10"></a><span id="l43.10" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailViewManager.jsm&quot;);</span>
<a href="#l43.11"></a><span id="l43.11"> </span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-// these constants are now authoritatively defined in mailViewManager.js (above)</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineplus">+// these constants are now authoritatively defined in MailViewManager.jsm (above)</span>
<a href="#l43.14"></a><span id="l43.14"> // tag views have kViewTagMarker + their key as value</span>
<a href="#l43.15"></a><span id="l43.15"> var kViewItemAll         = MailViewConstants.kViewItemAll;</span>
<a href="#l43.16"></a><span id="l43.16"> var kViewItemUnread      = MailViewConstants.kViewItemUnread;</span>
<a href="#l43.17"></a><span id="l43.17"> var kViewItemTags        = MailViewConstants.kViewItemTags; // former labels used values 2-6</span>
<a href="#l43.18"></a><span id="l43.18"> var kViewItemNotDeleted  = MailViewConstants.kViewItemNotDeleted;</span>
<a href="#l43.19"></a><span id="l43.19"> // not a real view! a sentinel value to pop up a dialog</span>
<a href="#l43.20"></a><span id="l43.20"> var kViewItemVirtual     = MailViewConstants.kViewItemVirtual;</span>
<a href="#l43.21"></a><span id="l43.21"> // not a real view! a sentinel value to pop up a dialog</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-columns.js</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-columns.js</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -3,17 +3,17 @@</span>
<a href="#l44.4"></a><span id="l44.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l44.5"></a><span id="l44.5"> </span>
<a href="#l44.6"></a><span id="l44.6"> &quot;use strict&quot;;</span>
<a href="#l44.7"></a><span id="l44.7"> </span>
<a href="#l44.8"></a><span id="l44.8"> var elib = {};</span>
<a href="#l44.9"></a><span id="l44.9"> ChromeUtils.import(&quot;chrome://mozmill/content/modules/elementslib.js&quot;, elib);</span>
<a href="#l44.10"></a><span id="l44.10"> </span>
<a href="#l44.11"></a><span id="l44.11"> // needed to zero inter-folder processing delay</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l44.14"></a><span id="l44.14"> </span>
<a href="#l44.15"></a><span id="l44.15"> </span>
<a href="#l44.16"></a><span id="l44.16"> /*</span>
<a href="#l44.17"></a><span id="l44.17">  * Test column default logic and persistence logic.  Persistence comes in both</span>
<a href="#l44.18"></a><span id="l44.18">  *  tab-switching (because of the multiplexed implementation) and</span>
<a href="#l44.19"></a><span id="l44.19">  *  folder-switching forms.</span>
<a href="#l44.20"></a><span id="l44.20">  */</span>
<a href="#l44.21"></a><span id="l44.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-mail-views.js</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-mail-views.js</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -7,17 +7,17 @@</span>
<a href="#l45.4"></a><span id="l45.4"> var MODULE_NAME = 'test-mail-views';</span>
<a href="#l45.5"></a><span id="l45.5"> </span>
<a href="#l45.6"></a><span id="l45.6"> var RELATIVE_ROOT = '../shared-modules';</span>
<a href="#l45.7"></a><span id="l45.7"> var MODULE_REQUIRES = ['folder-display-helpers', 'window-helpers'];</span>
<a href="#l45.8"></a><span id="l45.8"> </span>
<a href="#l45.9"></a><span id="l45.9"> var baseFolder, savedFolder;</span>
<a href="#l45.10"></a><span id="l45.10"> var setUntagged, setTagged;</span>
<a href="#l45.11"></a><span id="l45.11"> </span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/mailViewManager.js&quot;);</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailViewManager.jsm&quot;);</span>
<a href="#l45.14"></a><span id="l45.14"> </span>
<a href="#l45.15"></a><span id="l45.15"> var setupModule = function(module) {</span>
<a href="#l45.16"></a><span id="l45.16">   let fdh = collector.getModule('folder-display-helpers');</span>
<a href="#l45.17"></a><span id="l45.17">   fdh.installInto(module);</span>
<a href="#l45.18"></a><span id="l45.18">   let wh = collector.getModule('window-helpers');</span>
<a href="#l45.19"></a><span id="l45.19">   wh.installInto(module);</span>
<a href="#l45.20"></a><span id="l45.20"> </span>
<a href="#l45.21"></a><span id="l45.21">   // Create a folder with some messages that have no tags and some that are</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-message-commands.js</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-message-commands.js</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -11,17 +11,17 @@</span>
<a href="#l46.4"></a><span id="l46.4"> &quot;use strict&quot;;</span>
<a href="#l46.5"></a><span id="l46.5"> </span>
<a href="#l46.6"></a><span id="l46.6"> var MODULE_NAME = 'test-message-commands';</span>
<a href="#l46.7"></a><span id="l46.7"> </span>
<a href="#l46.8"></a><span id="l46.8"> var RELATIVE_ROOT = '../shared-modules';</span>
<a href="#l46.9"></a><span id="l46.9"> var MODULE_REQUIRES = ['folder-display-helpers', 'content-tab-helpers',</span>
<a href="#l46.10"></a><span id="l46.10">                        'window-helpers'];</span>
<a href="#l46.11"></a><span id="l46.11"> </span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l46.14"></a><span id="l46.14"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l46.15"></a><span id="l46.15"> </span>
<a href="#l46.16"></a><span id="l46.16"> var unreadFolder, shiftDeleteFolder, threadDeleteFolder;</span>
<a href="#l46.17"></a><span id="l46.17"> var archiveSrcFolder = null;</span>
<a href="#l46.18"></a><span id="l46.18"> var archiveURI;</span>
<a href="#l46.19"></a><span id="l46.19"> </span>
<a href="#l46.20"></a><span id="l46.20"> var acctMgr;</span>
<a href="#l46.21"></a><span id="l46.21"> var tagArray;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-opening-messages-without-a-backing-view.js</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -10,17 +10,17 @@</span>
<a href="#l47.4"></a><span id="l47.4"> </span>
<a href="#l47.5"></a><span id="l47.5"> &quot;use strict&quot;;</span>
<a href="#l47.6"></a><span id="l47.6"> </span>
<a href="#l47.7"></a><span id="l47.7"> var MODULE_NAME = 'test-opening-messages-without-a-backing-view';</span>
<a href="#l47.8"></a><span id="l47.8"> </span>
<a href="#l47.9"></a><span id="l47.9"> var RELATIVE_ROOT = '../shared-modules';</span>
<a href="#l47.10"></a><span id="l47.10"> var MODULE_REQUIRES = ['folder-display-helpers', 'window-helpers'];</span>
<a href="#l47.11"></a><span id="l47.11"> </span>
<a href="#l47.12"></a><span id="l47.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l47.14"></a><span id="l47.14"> </span>
<a href="#l47.15"></a><span id="l47.15"> // One folder's enough</span>
<a href="#l47.16"></a><span id="l47.16"> var folder = null;</span>
<a href="#l47.17"></a><span id="l47.17"> </span>
<a href="#l47.18"></a><span id="l47.18"> // A list of the message headers in this folder</span>
<a href="#l47.19"></a><span id="l47.19"> var msgHdrsInFolder = null;</span>
<a href="#l47.20"></a><span id="l47.20"> </span>
<a href="#l47.21"></a><span id="l47.21"> // Number of messages to open for multi-message tests</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1" class="difflineminus">--- a/mail/test/mozmill/folder-display/test-recent-menu.js</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineplus">+++ b/mail/test/mozmill/folder-display/test-recent-menu.js</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineat">@@ -5,17 +5,17 @@</span>
<a href="#l48.4"></a><span id="l48.4"> /**</span>
<a href="#l48.5"></a><span id="l48.5">  * This tests the move/copy to recent folder menus to make sure</span>
<a href="#l48.6"></a><span id="l48.6">  * that they get updated when messages are moved to folders, and</span>
<a href="#l48.7"></a><span id="l48.7">  * don't get updated when we archive.</span>
<a href="#l48.8"></a><span id="l48.8">  */</span>
<a href="#l48.9"></a><span id="l48.9"> </span>
<a href="#l48.10"></a><span id="l48.10"> &quot;use strict&quot;;</span>
<a href="#l48.11"></a><span id="l48.11"> </span>
<a href="#l48.12"></a><span id="l48.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l48.14"></a><span id="l48.14"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l48.15"></a><span id="l48.15"> </span>
<a href="#l48.16"></a><span id="l48.16"> var MODULE_NAME = 'test-recent-menu';</span>
<a href="#l48.17"></a><span id="l48.17"> </span>
<a href="#l48.18"></a><span id="l48.18"> var RELATIVE_ROOT = '../shared-modules';</span>
<a href="#l48.19"></a><span id="l48.19"> var MODULE_REQUIRES = ['folder-display-helpers', 'window-helpers'];</span>
<a href="#l48.20"></a><span id="l48.20"> </span>
<a href="#l48.21"></a><span id="l48.21"> var folder1, folder2;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1" class="difflineminus">--- a/mail/test/mozmill/instrumentation/test-instrument-setup.js</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineplus">+++ b/mail/test/mozmill/instrumentation/test-instrument-setup.js</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineat">@@ -54,17 +54,17 @@ function test_mail_account_setup() {</span>
<a href="#l49.4"></a><span id="l49.4">   // XXX: This should probably use a notification, once we fix bug 561143.</span>
<a href="#l49.5"></a><span id="l49.5">   awc.waitFor(() =&gt; awc.window.gEmailConfigWizard._currentConfig != null,</span>
<a href="#l49.6"></a><span id="l49.6">               &quot;Timeout waiting for current config to become non-null&quot;,</span>
<a href="#l49.7"></a><span id="l49.7">               8000, 600);</span>
<a href="#l49.8"></a><span id="l49.8">   config = awc.window.gEmailConfigWizard._currentConfig;</span>
<a href="#l49.9"></a><span id="l49.9">   plan_for_window_close(awc);</span>
<a href="#l49.10"></a><span id="l49.10">   awc.e(&quot;create_button&quot;).click();</span>
<a href="#l49.11"></a><span id="l49.11"> </span>
<a href="#l49.12"></a><span id="l49.12" class="difflineminus">-  let events = mc.window.mailInstrumentationManager._currentState.events;</span>
<a href="#l49.13"></a><span id="l49.13" class="difflineplus">+  let events = mc.window.MailInstrumentation._currentState.events;</span>
<a href="#l49.14"></a><span id="l49.14">   wait_for_window_close();</span>
<a href="#l49.15"></a><span id="l49.15"> </span>
<a href="#l49.16"></a><span id="l49.16">   // we expect to have accountAdded and smtpServerAdded events.</span>
<a href="#l49.17"></a><span id="l49.17">   if (! (events[&quot;accountAdded&quot;].data))</span>
<a href="#l49.18"></a><span id="l49.18">     throw new Error(&quot;failed to add an account&quot;);</span>
<a href="#l49.19"></a><span id="l49.19">   else if (! (events[&quot;smtpServerAdded&quot;].data))</span>
<a href="#l49.20"></a><span id="l49.20">     throw new Error(&quot;failed to add an smtp server&quot;);</span>
<a href="#l49.21"></a><span id="l49.21"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/mail/test/mozmill/session-store/test-session-store.js</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/mail/test/mozmill/session-store/test-session-store.js</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -13,17 +13,17 @@ var MODULE_NAME = &quot;test-session-store&quot;;</span>
<a href="#l50.4"></a><span id="l50.4"> </span>
<a href="#l50.5"></a><span id="l50.5"> var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l50.6"></a><span id="l50.6"> var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;window-helpers&quot;];</span>
<a href="#l50.7"></a><span id="l50.7"> </span>
<a href="#l50.8"></a><span id="l50.8"> var controller = {};</span>
<a href="#l50.9"></a><span id="l50.9"> ChromeUtils.import(&quot;chrome://mozmill/content/modules/controller.js&quot;, controller);</span>
<a href="#l50.10"></a><span id="l50.10"> </span>
<a href="#l50.11"></a><span id="l50.11"> ChromeUtils.import(&quot;resource://gre/modules/FileUtils.jsm&quot;);</span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/sessionStoreManager.js&quot;);</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/SessionStoreManager.jsm&quot;);</span>
<a href="#l50.14"></a><span id="l50.14"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l50.15"></a><span id="l50.15"> </span>
<a href="#l50.16"></a><span id="l50.16"> var folderA, folderB;</span>
<a href="#l50.17"></a><span id="l50.17"> </span>
<a href="#l50.18"></a><span id="l50.18"> // Default JSONFile save delay with saveSoon().</span>
<a href="#l50.19"></a><span id="l50.19"> var kSaveDelayMs = 1500;</span>
<a href="#l50.20"></a><span id="l50.20"> </span>
<a href="#l50.21"></a><span id="l50.21"> // With async file writes, use a delay larger than the session autosave timer.</span>
<a href="#l50.22"></a><span id="l50.22" class="difflineat">@@ -31,31 +31,31 @@ var asyncFileWriteDelayMS = 3000;</span>
<a href="#l50.23"></a><span id="l50.23"> </span>
<a href="#l50.24"></a><span id="l50.24"> /* ........ Helper Functions ................*/</span>
<a href="#l50.25"></a><span id="l50.25"> </span>
<a href="#l50.26"></a><span id="l50.26"> /**</span>
<a href="#l50.27"></a><span id="l50.27">  * Reads the contents of the session file into a JSON object.</span>
<a href="#l50.28"></a><span id="l50.28">  */</span>
<a href="#l50.29"></a><span id="l50.29"> function readFile() {</span>
<a href="#l50.30"></a><span id="l50.30">   try {</span>
<a href="#l50.31"></a><span id="l50.31" class="difflineminus">-    let data = IOUtils.loadFileToString(sessionStoreManager.sessionFile);</span>
<a href="#l50.32"></a><span id="l50.32" class="difflineplus">+    let data = IOUtils.loadFileToString(SessionStoreManager.sessionFile);</span>
<a href="#l50.33"></a><span id="l50.33">     if (data)</span>
<a href="#l50.34"></a><span id="l50.34">       return JSON.parse(data);</span>
<a href="#l50.35"></a><span id="l50.35">   }</span>
<a href="#l50.36"></a><span id="l50.36">   catch (ex) {</span>
<a href="#l50.37"></a><span id="l50.37">     // fall through and return null if the session file cannot be read</span>
<a href="#l50.38"></a><span id="l50.38">     // or is bad</span>
<a href="#l50.39"></a><span id="l50.39">   }</span>
<a href="#l50.40"></a><span id="l50.40"> </span>
<a href="#l50.41"></a><span id="l50.41">   return null;</span>
<a href="#l50.42"></a><span id="l50.42"> }</span>
<a href="#l50.43"></a><span id="l50.43"> </span>
<a href="#l50.44"></a><span id="l50.44"> function waitForFileRefresh() {</span>
<a href="#l50.45"></a><span id="l50.45">   controller.sleep(kSaveDelayMs);</span>
<a href="#l50.46"></a><span id="l50.46" class="difflineminus">-  utils.waitFor(() =&gt; sessionStoreManager.sessionFile.exists(),</span>
<a href="#l50.47"></a><span id="l50.47" class="difflineplus">+  utils.waitFor(() =&gt; SessionStoreManager.sessionFile.exists(),</span>
<a href="#l50.48"></a><span id="l50.48">                 &quot;session file should exist&quot;);</span>
<a href="#l50.49"></a><span id="l50.49">   controller.sleep(asyncFileWriteDelayMS);</span>
<a href="#l50.50"></a><span id="l50.50"> }</span>
<a href="#l50.51"></a><span id="l50.51"> </span>
<a href="#l50.52"></a><span id="l50.52"> function open3PaneWindow() {</span>
<a href="#l50.53"></a><span id="l50.53">   plan_for_new_window(&quot;mail:3pane&quot;);</span>
<a href="#l50.54"></a><span id="l50.54">   Services.ww.openWindow(null,</span>
<a href="#l50.55"></a><span id="l50.55">                          &quot;chrome://messenger/content/messenger.xul&quot;, &quot;&quot;,</span>
<a href="#l50.56"></a><span id="l50.56" class="difflineat">@@ -81,77 +81,77 @@ function setupModule(module) {</span>
<a href="#l50.57"></a><span id="l50.57">   }</span>
<a href="#l50.58"></a><span id="l50.58"> </span>
<a href="#l50.59"></a><span id="l50.59">   folderA = create_folder(&quot;SessionStoreA&quot;);</span>
<a href="#l50.60"></a><span id="l50.60">   make_new_sets_in_folder(folderA, [{count: 3}]);</span>
<a href="#l50.61"></a><span id="l50.61"> </span>
<a href="#l50.62"></a><span id="l50.62">   folderB = create_folder(&quot;SessionStoreB&quot;);</span>
<a href="#l50.63"></a><span id="l50.63">   make_new_sets_in_folder(folderB, [{count: 3}]);</span>
<a href="#l50.64"></a><span id="l50.64"> </span>
<a href="#l50.65"></a><span id="l50.65" class="difflineminus">-  sessionStoreManager.stopPeriodicSave();</span>
<a href="#l50.66"></a><span id="l50.66" class="difflineplus">+  SessionStoreManager.stopPeriodicSave();</span>
<a href="#l50.67"></a><span id="l50.67"> </span>
<a href="#l50.68"></a><span id="l50.68">   // Opt out of calendar promotion so we don't show the &quot;ligthing now</span>
<a href="#l50.69"></a><span id="l50.69">   // integrated&quot; notification bar (which gives us unexpected heights).</span>
<a href="#l50.70"></a><span id="l50.70">   Services.prefs.setBoolPref(&quot;calendar.integration.notify&quot;, false);</span>
<a href="#l50.71"></a><span id="l50.71"> }</span>
<a href="#l50.72"></a><span id="l50.72"> </span>
<a href="#l50.73"></a><span id="l50.73"> function teardownModule(module) {</span>
<a href="#l50.74"></a><span id="l50.74">   folderA.Delete();</span>
<a href="#l50.75"></a><span id="l50.75">   folderB.Delete();</span>
<a href="#l50.76"></a><span id="l50.76">   Services.prefs.clearUserPref(&quot;calendar.integration.notify&quot;);</span>
<a href="#l50.77"></a><span id="l50.77"> }</span>
<a href="#l50.78"></a><span id="l50.78"> </span>
<a href="#l50.79"></a><span id="l50.79"> function test_periodic_session_persistence_simple() {</span>
<a href="#l50.80"></a><span id="l50.80">   // delete the session file if it exists</span>
<a href="#l50.81"></a><span id="l50.81" class="difflineminus">-  let sessionFile = sessionStoreManager.sessionFile;</span>
<a href="#l50.82"></a><span id="l50.82" class="difflineplus">+  let sessionFile = SessionStoreManager.sessionFile;</span>
<a href="#l50.83"></a><span id="l50.83">   if (sessionFile.exists())</span>
<a href="#l50.84"></a><span id="l50.84">     sessionFile.remove(false);</span>
<a href="#l50.85"></a><span id="l50.85"> </span>
<a href="#l50.86"></a><span id="l50.86">   utils.waitFor(() =&gt; !sessionFile.exists(),</span>
<a href="#l50.87"></a><span id="l50.87">                 &quot;session file should not exist&quot;);</span>
<a href="#l50.88"></a><span id="l50.88"> </span>
<a href="#l50.89"></a><span id="l50.89">   // change some state to guarantee the file will be recreated</span>
<a href="#l50.90"></a><span id="l50.90">   // if periodic session persistence works</span>
<a href="#l50.91"></a><span id="l50.91">   be_in_folder(folderA);</span>
<a href="#l50.92"></a><span id="l50.92"> </span>
<a href="#l50.93"></a><span id="l50.93">   // if periodic session persistence is working, the file should be</span>
<a href="#l50.94"></a><span id="l50.94">   // re-created</span>
<a href="#l50.95"></a><span id="l50.95" class="difflineminus">-  sessionStoreManager._saveState();</span>
<a href="#l50.96"></a><span id="l50.96" class="difflineplus">+  SessionStoreManager._saveState();</span>
<a href="#l50.97"></a><span id="l50.97">   waitForFileRefresh();</span>
<a href="#l50.98"></a><span id="l50.98"> }</span>
<a href="#l50.99"></a><span id="l50.99"> </span>
<a href="#l50.100"></a><span id="l50.100"> function test_periodic_nondirty_session_persistence() {</span>
<a href="#l50.101"></a><span id="l50.101">   // This changes state.</span>
<a href="#l50.102"></a><span id="l50.102">   be_in_folder(folderB);</span>
<a href="#l50.103"></a><span id="l50.103"> </span>
<a href="#l50.104"></a><span id="l50.104" class="difflineminus">-  sessionStoreManager._saveState();</span>
<a href="#l50.105"></a><span id="l50.105" class="difflineplus">+  SessionStoreManager._saveState();</span>
<a href="#l50.106"></a><span id="l50.106">   waitForFileRefresh();</span>
<a href="#l50.107"></a><span id="l50.107"> </span>
<a href="#l50.108"></a><span id="l50.108">   // delete the session file</span>
<a href="#l50.109"></a><span id="l50.109" class="difflineminus">-  let sessionFile = sessionStoreManager.sessionFile;</span>
<a href="#l50.110"></a><span id="l50.110" class="difflineplus">+  let sessionFile = SessionStoreManager.sessionFile;</span>
<a href="#l50.111"></a><span id="l50.111">   sessionFile.remove(false);</span>
<a href="#l50.112"></a><span id="l50.112"> </span>
<a href="#l50.113"></a><span id="l50.113">   // Since the state of the session hasn't changed since last _saveState(),</span>
<a href="#l50.114"></a><span id="l50.114">   // the session file should not be re-created.</span>
<a href="#l50.115"></a><span id="l50.115" class="difflineminus">-  sessionStoreManager._saveState();</span>
<a href="#l50.116"></a><span id="l50.116" class="difflineplus">+  SessionStoreManager._saveState();</span>
<a href="#l50.117"></a><span id="l50.117">   controller.sleep(kSaveDelayMs + asyncFileWriteDelayMS);</span>
<a href="#l50.118"></a><span id="l50.118"> </span>
<a href="#l50.119"></a><span id="l50.119">   utils.waitFor(() =&gt; !sessionFile.exists(),</span>
<a href="#l50.120"></a><span id="l50.120">                 &quot;session file should not exist&quot;);</span>
<a href="#l50.121"></a><span id="l50.121"> }</span>
<a href="#l50.122"></a><span id="l50.122"> </span>
<a href="#l50.123"></a><span id="l50.123"> function test_single_3pane_periodic_session_persistence() {</span>
<a href="#l50.124"></a><span id="l50.124">   be_in_folder(folderA);</span>
<a href="#l50.125"></a><span id="l50.125"> </span>
<a href="#l50.126"></a><span id="l50.126">   // get the state object. this assumes there is one and only one</span>
<a href="#l50.127"></a><span id="l50.127">   // 3pane window.</span>
<a href="#l50.128"></a><span id="l50.128">   let mail3PaneWindow = Services.wm.getMostRecentWindow(&quot;mail:3pane&quot;);</span>
<a href="#l50.129"></a><span id="l50.129">   let state = mail3PaneWindow.getWindowStateForSessionPersistence();</span>
<a href="#l50.130"></a><span id="l50.130"> </span>
<a href="#l50.131"></a><span id="l50.131" class="difflineminus">-  sessionStoreManager._saveState();</span>
<a href="#l50.132"></a><span id="l50.132" class="difflineplus">+  SessionStoreManager._saveState();</span>
<a href="#l50.133"></a><span id="l50.133">   waitForFileRefresh();</span>
<a href="#l50.134"></a><span id="l50.134"> </span>
<a href="#l50.135"></a><span id="l50.135">   // load the saved state from disk</span>
<a href="#l50.136"></a><span id="l50.136">   let loadedState = readFile();</span>
<a href="#l50.137"></a><span id="l50.137">   assert_true(loadedState, &quot;previously saved state should be non-null&quot;);</span>
<a href="#l50.138"></a><span id="l50.138"> </span>
<a href="#l50.139"></a><span id="l50.139">   // get the state object for the one and only one 3pane window</span>
<a href="#l50.140"></a><span id="l50.140">   let windowState = loadedState.windows[0];</span>
<a href="#l50.141"></a><span id="l50.141" class="difflineat">@@ -364,17 +364,17 @@ function test_multiple_3pane_periodic_se</span>
<a href="#l50.142"></a><span id="l50.142">     open3PaneWindow();</span>
<a href="#l50.143"></a><span id="l50.143"> </span>
<a href="#l50.144"></a><span id="l50.144">   // then get the state objects for each window</span>
<a href="#l50.145"></a><span id="l50.145">   let state = [];</span>
<a href="#l50.146"></a><span id="l50.146">   let enumerator = Services.wm.getEnumerator(&quot;mail:3pane&quot;);</span>
<a href="#l50.147"></a><span id="l50.147">   while (enumerator.hasMoreElements())</span>
<a href="#l50.148"></a><span id="l50.148">     state.push(enumerator.getNext().getWindowStateForSessionPersistence());</span>
<a href="#l50.149"></a><span id="l50.149"> </span>
<a href="#l50.150"></a><span id="l50.150" class="difflineminus">-  sessionStoreManager._saveState();</span>
<a href="#l50.151"></a><span id="l50.151" class="difflineplus">+  SessionStoreManager._saveState();</span>
<a href="#l50.152"></a><span id="l50.152">   waitForFileRefresh();</span>
<a href="#l50.153"></a><span id="l50.153"> </span>
<a href="#l50.154"></a><span id="l50.154">   // load the saved state from disk</span>
<a href="#l50.155"></a><span id="l50.155">   let loadedState = readFile();</span>
<a href="#l50.156"></a><span id="l50.156">   assert_true(loadedState, &quot;previously saved state should be non-null&quot;);</span>
<a href="#l50.157"></a><span id="l50.157"> </span>
<a href="#l50.158"></a><span id="l50.158">   assert_equals(loadedState.windows.length, state.length,</span>
<a href="#l50.159"></a><span id="l50.159">           &quot;number of windows in saved state and loaded state should be equal&quot;);</span>
<a href="#l50.160"></a><span id="l50.160" class="difflineat">@@ -392,32 +392,32 @@ function test_multiple_3pane_periodic_se</span>
<a href="#l50.161"></a><span id="l50.161">     if (enumerator.hasMoreElements())</span>
<a href="#l50.162"></a><span id="l50.162">       window.close();</span>
<a href="#l50.163"></a><span id="l50.163">   }</span>
<a href="#l50.164"></a><span id="l50.164"> }</span>
<a href="#l50.165"></a><span id="l50.165"> </span>
<a href="#l50.166"></a><span id="l50.166"> async function test_bad_session_file_simple() {</span>
<a href="#l50.167"></a><span id="l50.167">   // forcefully write a bad session file</span>
<a href="#l50.168"></a><span id="l50.168">   let data = &quot;BAD SESSION FILE&quot;;</span>
<a href="#l50.169"></a><span id="l50.169" class="difflineminus">-  let fos = FileUtils.openSafeFileOutputStream(sessionStoreManager.sessionFile);</span>
<a href="#l50.170"></a><span id="l50.170" class="difflineplus">+  let fos = FileUtils.openSafeFileOutputStream(SessionStoreManager.sessionFile);</span>
<a href="#l50.171"></a><span id="l50.171">   fos.write(data, data.length);</span>
<a href="#l50.172"></a><span id="l50.172">   FileUtils.closeSafeFileOutputStream(fos);</span>
<a href="#l50.173"></a><span id="l50.173"> </span>
<a href="#l50.174"></a><span id="l50.174">   // tell the session store manager to try loading the bad session file.</span>
<a href="#l50.175"></a><span id="l50.175">   // NOTE: periodic session persistence is not enabled in this test</span>
<a href="#l50.176"></a><span id="l50.176" class="difflineminus">-  sessionStoreManager._store = null;</span>
<a href="#l50.177"></a><span id="l50.177" class="difflineminus">-  await sessionStoreManager._loadSessionFile();</span>
<a href="#l50.178"></a><span id="l50.178" class="difflineplus">+  SessionStoreManager._store = null;</span>
<a href="#l50.179"></a><span id="l50.179" class="difflineplus">+  await SessionStoreManager._loadSessionFile();</span>
<a href="#l50.180"></a><span id="l50.180"> </span>
<a href="#l50.181"></a><span id="l50.181">   // since the session file is bad, the session store manager's state field</span>
<a href="#l50.182"></a><span id="l50.182">   // should be null</span>
<a href="#l50.183"></a><span id="l50.183" class="difflineminus">-  assert_false(sessionStoreManager._initialState,</span>
<a href="#l50.184"></a><span id="l50.184" class="difflineplus">+  assert_false(SessionStoreManager._initialState,</span>
<a href="#l50.185"></a><span id="l50.185">                &quot;saved state is bad so state object should be null&quot;);</span>
<a href="#l50.186"></a><span id="l50.186"> </span>
<a href="#l50.187"></a><span id="l50.187">   // The bad session file should now not exist.</span>
<a href="#l50.188"></a><span id="l50.188" class="difflineminus">-  utils.waitFor(() =&gt; !sessionStoreManager.sessionFile.exists(),</span>
<a href="#l50.189"></a><span id="l50.189" class="difflineplus">+  utils.waitFor(() =&gt; !SessionStoreManager.sessionFile.exists(),</span>
<a href="#l50.190"></a><span id="l50.190">                 &quot;session file should now not exist&quot;);</span>
<a href="#l50.191"></a><span id="l50.191"> }</span>
<a href="#l50.192"></a><span id="l50.192"> </span>
<a href="#l50.193"></a><span id="l50.193"> function test_clean_shutdown_session_persistence_simple() {</span>
<a href="#l50.194"></a><span id="l50.194">   // open a few more 3pane windows</span>
<a href="#l50.195"></a><span id="l50.195">   for (var i = 0; i &lt; 3; ++i) {</span>
<a href="#l50.196"></a><span id="l50.196">     open3PaneWindow();</span>
<a href="#l50.197"></a><span id="l50.197">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-folder-display-helpers.js</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/test-folder-display-helpers.js</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineat">@@ -19,20 +19,20 @@ ChromeUtils.import(&quot;chrome://mozmill/con</span>
<a href="#l51.4"></a><span id="l51.4"> var os = {};</span>
<a href="#l51.5"></a><span id="l51.5"> ChromeUtils.import(&quot;chrome://mozmill/content/stdlib/os.js&quot;, os);</span>
<a href="#l51.6"></a><span id="l51.6"> var utils = {};</span>
<a href="#l51.7"></a><span id="l51.7"> ChromeUtils.import(&quot;chrome://mozmill/content/modules/utils.js&quot;, utils);</span>
<a href="#l51.8"></a><span id="l51.8"> </span>
<a href="#l51.9"></a><span id="l51.9"> ChromeUtils.import(&quot;resource:///modules/gloda/log4moz.js&quot;);</span>
<a href="#l51.10"></a><span id="l51.10"> </span>
<a href="#l51.11"></a><span id="l51.11"> var nsMsgViewIndex_None = 0xffffffff;</span>
<a href="#l51.12"></a><span id="l51.12" class="difflineminus">-ChromeUtils.import('resource:///modules/MailConsts.js');</span>
<a href="#l51.13"></a><span id="l51.13" class="difflineplus">+ChromeUtils.import('resource:///modules/MailConsts.jsm');</span>
<a href="#l51.14"></a><span id="l51.14"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l51.15"></a><span id="l51.15" class="difflineminus">-ChromeUtils.import('resource:///modules/MailUtils.js');</span>
<a href="#l51.16"></a><span id="l51.16" class="difflineminus">-ChromeUtils.import('resource:///modules/mailViewManager.js');</span>
<a href="#l51.17"></a><span id="l51.17" class="difflineplus">+ChromeUtils.import('resource:///modules/MailUtils.jsm');</span>
<a href="#l51.18"></a><span id="l51.18" class="difflineplus">+ChromeUtils.import('resource:///modules/MailViewManager.jsm');</span>
<a href="#l51.19"></a><span id="l51.19"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l51.20"></a><span id="l51.20"> </span>
<a href="#l51.21"></a><span id="l51.21"> var FILE_LOAD_PATHS = [</span>
<a href="#l51.22"></a><span id="l51.22">   &quot;../&quot;,</span>
<a href="#l51.23"></a><span id="l51.23">   &quot;../../&quot;,</span>
<a href="#l51.24"></a><span id="l51.24">   &quot;../../../../mailnews/test/&quot;,</span>
<a href="#l51.25"></a><span id="l51.25">   &quot;../../../../mail/base/test/unit/&quot;,</span>
<a href="#l51.26"></a><span id="l51.26"> ];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1" class="difflineminus">--- a/mailnews/base/content/folderWidgets.xml</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineplus">+++ b/mailnews/base/content/folderWidgets.xml</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineat">@@ -13,17 +13,17 @@</span>
<a href="#l52.4"></a><span id="l52.4">   &lt;binding id=&quot;folder-menupopup&quot;</span>
<a href="#l52.5"></a><span id="l52.5">            extends=&quot;chrome://global/content/bindings/popup.xml#popup&quot;&gt;</span>
<a href="#l52.6"></a><span id="l52.6">     &lt;implementation&gt;</span>
<a href="#l52.7"></a><span id="l52.7">       &lt;constructor&gt;&lt;![CDATA[</span>
<a href="#l52.8"></a><span id="l52.8">         ChromeUtils.import(&quot;resource:///modules/FeedUtils.jsm&quot;, this);</span>
<a href="#l52.9"></a><span id="l52.9">         ChromeUtils.import(&quot;resource:///modules/folderUtils.jsm&quot;, this);</span>
<a href="#l52.10"></a><span id="l52.10">         ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;, this);</span>
<a href="#l52.11"></a><span id="l52.11">         ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;, this);</span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">-        ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;, this);</span>
<a href="#l52.13"></a><span id="l52.13" class="difflineplus">+        ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;, this);</span>
<a href="#l52.14"></a><span id="l52.14">         ChromeUtils.import(&quot;resource:///modules/StringBundle.js&quot;, this);</span>
<a href="#l52.15"></a><span id="l52.15">         this._stringBundle = new this</span>
<a href="#l52.16"></a><span id="l52.16">             .StringBundle(&quot;chrome://messenger/locale/folderWidgets.properties&quot;);</span>
<a href="#l52.17"></a><span id="l52.17"> </span>
<a href="#l52.18"></a><span id="l52.18">         // Get the displayformat if set.</span>
<a href="#l52.19"></a><span id="l52.19">         if (this.parentNode &amp;&amp; this.parentNode.localName == &quot;menulist&quot;)</span>
<a href="#l52.20"></a><span id="l52.20">           this._displayformat = this.parentNode.getAttribute(&quot;displayformat&quot;);</span>
<a href="#l52.21"></a><span id="l52.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/mailnews/base/content/junkCommands.js</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/mailnews/base/content/junkCommands.js</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -21,17 +21,17 @@</span>
<a href="#l53.4"></a><span id="l53.4">   *   either gMsgFolderSelected or gFolderDisplay</span>
<a href="#l53.5"></a><span id="l53.5">   *   MsgJunkMailInfo(aCheckFirstUse)</span>
<a href="#l53.6"></a><span id="l53.6">   *   SetNextMessageAfterDelete()</span>
<a href="#l53.7"></a><span id="l53.7">   *   pref</span>
<a href="#l53.8"></a><span id="l53.8">   *   msgWindow</span>
<a href="#l53.9"></a><span id="l53.9">   */</span>
<a href="#l53.10"></a><span id="l53.10"> </span>
<a href="#l53.11"></a><span id="l53.11"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l53.13"></a><span id="l53.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l53.14"></a><span id="l53.14"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l53.15"></a><span id="l53.15"> </span>
<a href="#l53.16"></a><span id="l53.16"> /*</span>
<a href="#l53.17"></a><span id="l53.17">  * determineActionsForJunkMsgs</span>
<a href="#l53.18"></a><span id="l53.18">  *</span>
<a href="#l53.19"></a><span id="l53.19">  * Determines the actions that should be carried out on the messages</span>
<a href="#l53.20"></a><span id="l53.20">  * that are being marked as junk</span>
<a href="#l53.21"></a><span id="l53.21">  *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1" class="difflineminus">--- a/mailnews/base/content/msgFolderPickerOverlay.js</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineplus">+++ b/mailnews/base/content/msgFolderPickerOverlay.js</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineat">@@ -1,14 +1,14 @@</span>
<a href="#l54.4"></a><span id="l54.4"> /* -*- Mode: Java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */</span>
<a href="#l54.5"></a><span id="l54.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l54.6"></a><span id="l54.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l54.7"></a><span id="l54.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l54.8"></a><span id="l54.8"> </span>
<a href="#l54.9"></a><span id="l54.9" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l54.10"></a><span id="l54.10" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l54.11"></a><span id="l54.11"> </span>
<a href="#l54.12"></a><span id="l54.12"> var gMessengerBundle;</span>
<a href="#l54.13"></a><span id="l54.13"> </span>
<a href="#l54.14"></a><span id="l54.14"> // call this from dialog onload() to set the menu item to the correct value</span>
<a href="#l54.15"></a><span id="l54.15"> function MsgFolderPickerOnLoad(pickerID)</span>
<a href="#l54.16"></a><span id="l54.16"> {</span>
<a href="#l54.17"></a><span id="l54.17">   var uri = null;</span>
<a href="#l54.18"></a><span id="l54.18">   try {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1" class="difflineminus">--- a/mailnews/base/content/subscribe.js</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineplus">+++ b/mailnews/base/content/subscribe.js</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineat">@@ -1,13 +1,13 @@</span>
<a href="#l55.4"></a><span id="l55.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l55.5"></a><span id="l55.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l55.6"></a><span id="l55.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l55.7"></a><span id="l55.7"> </span>
<a href="#l55.8"></a><span id="l55.8" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l55.9"></a><span id="l55.9" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l55.10"></a><span id="l55.10"> ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l55.11"></a><span id="l55.11"> </span>
<a href="#l55.12"></a><span id="l55.12"> var gSubscribeTree = null;</span>
<a href="#l55.13"></a><span id="l55.13"> var gSubscribeBody = null;</span>
<a href="#l55.14"></a><span id="l55.14"> var gSearchTree;</span>
<a href="#l55.15"></a><span id="l55.15"> var okCallback = null;</span>
<a href="#l55.16"></a><span id="l55.16"> var gChangeTable = {};</span>
<a href="#l55.17"></a><span id="l55.17"> var gServerURI = null;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1" class="difflineminus">--- a/mailnews/base/content/virtualFolderProperties.js</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineplus">+++ b/mailnews/base/content/virtualFolderProperties.js</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineat">@@ -12,17 +12,17 @@ var gMessengerBundle = null;</span>
<a href="#l56.4"></a><span id="l56.4"> </span>
<a href="#l56.5"></a><span id="l56.5"> var nsMsgSearchScope = Ci.nsMsgSearchScope;</span>
<a href="#l56.6"></a><span id="l56.6"> </span>
<a href="#l56.7"></a><span id="l56.7"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l56.8"></a><span id="l56.8"> ChromeUtils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l56.9"></a><span id="l56.9"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l56.10"></a><span id="l56.10"> ChromeUtils.import(&quot;resource:///modules/virtualFolderWrapper.js&quot;);</span>
<a href="#l56.11"></a><span id="l56.11"> ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l56.12"></a><span id="l56.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l56.13"></a><span id="l56.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l56.14"></a><span id="l56.14"> </span>
<a href="#l56.15"></a><span id="l56.15"> function onLoad()</span>
<a href="#l56.16"></a><span id="l56.16"> {</span>
<a href="#l56.17"></a><span id="l56.17">   var windowArgs = window.arguments[0];</span>
<a href="#l56.18"></a><span id="l56.18">   var acceptButton = document.documentElement.getButton(&quot;accept&quot;);</span>
<a href="#l56.19"></a><span id="l56.19"> </span>
<a href="#l56.20"></a><span id="l56.20">   gMessengerBundle = document.getElementById(&quot;bundle_messenger&quot;);</span>
<a href="#l56.21"></a><span id="l56.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l57.1"></a><span id="l57.1" class="difflineminus">--- a/mailnews/base/prefs/content/am-copies.js</span>
<a href="#l57.2"></a><span id="l57.2" class="difflineplus">+++ b/mailnews/base/prefs/content/am-copies.js</span>
<a href="#l57.3"></a><span id="l57.3" class="difflineat">@@ -1,14 +1,14 @@</span>
<a href="#l57.4"></a><span id="l57.4"> /* -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l57.5"></a><span id="l57.5">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l57.6"></a><span id="l57.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l57.7"></a><span id="l57.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l57.8"></a><span id="l57.8"> </span>
<a href="#l57.9"></a><span id="l57.9" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l57.10"></a><span id="l57.10" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l57.11"></a><span id="l57.11"> </span>
<a href="#l57.12"></a><span id="l57.12"> var gFccRadioElemChoice, gDraftsRadioElemChoice, gArchivesRadioElemChoice, gTmplRadioElemChoice;</span>
<a href="#l57.13"></a><span id="l57.13"> var gFccRadioElemChoiceLocked, gDraftsRadioElemChoiceLocked, gArchivesRadioElemChoiceLocked, gTmplRadioElemChoiceLocked;</span>
<a href="#l57.14"></a><span id="l57.14"> var gDefaultPickerMode = &quot;1&quot;;</span>
<a href="#l57.15"></a><span id="l57.15"> </span>
<a href="#l57.16"></a><span id="l57.16"> var gFccFolderWithDelim, gDraftsFolderWithDelim, gArchivesFolderWithDelim, gTemplatesFolderWithDelim;</span>
<a href="#l57.17"></a><span id="l57.17"> var gAccount;</span>
<a href="#l57.18"></a><span id="l57.18"> var gCurrentServerId;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l58.1"></a><span id="l58.1" class="difflineminus">--- a/mailnews/base/prefs/content/am-junk.js</span>
<a href="#l58.2"></a><span id="l58.2" class="difflineplus">+++ b/mailnews/base/prefs/content/am-junk.js</span>
<a href="#l58.3"></a><span id="l58.3" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l58.4"></a><span id="l58.4"> /* -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l58.5"></a><span id="l58.5">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l58.6"></a><span id="l58.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l58.7"></a><span id="l58.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l58.8"></a><span id="l58.8">  */</span>
<a href="#l58.9"></a><span id="l58.9"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l58.10"></a><span id="l58.10"> ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l58.11"></a><span id="l58.11" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l58.12"></a><span id="l58.12" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l58.13"></a><span id="l58.13"> </span>
<a href="#l58.14"></a><span id="l58.14"> var gDeferredToAccount = &quot;&quot;;</span>
<a href="#l58.15"></a><span id="l58.15"> </span>
<a href="#l58.16"></a><span id="l58.16"> function onInit(aPageId, aServerId)</span>
<a href="#l58.17"></a><span id="l58.17"> {</span>
<a href="#l58.18"></a><span id="l58.18">   // manually adjust several pref UI elements</span>
<a href="#l58.19"></a><span id="l58.19">   document.getElementById('server.spamLevel.visible').setAttribute(&quot;checked&quot;,</span>
<a href="#l58.20"></a><span id="l58.20">     document.getElementById('server.spamLevel').value &gt; 0);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l59.1"></a><span id="l59.1" class="difflineminus">--- a/mailnews/base/prefs/content/am-server.js</span>
<a href="#l59.2"></a><span id="l59.2" class="difflineplus">+++ b/mailnews/base/prefs/content/am-server.js</span>
<a href="#l59.3"></a><span id="l59.3" class="difflineat">@@ -1,15 +1,15 @@</span>
<a href="#l59.4"></a><span id="l59.4"> /* -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span>
<a href="#l59.5"></a><span id="l59.5">  * This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l59.6"></a><span id="l59.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l59.7"></a><span id="l59.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l59.8"></a><span id="l59.8"> </span>
<a href="#l59.9"></a><span id="l59.9"> ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l59.10"></a><span id="l59.10" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l59.11"></a><span id="l59.11" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l59.12"></a><span id="l59.12"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l59.13"></a><span id="l59.13"> </span>
<a href="#l59.14"></a><span id="l59.14"> var gServer;</span>
<a href="#l59.15"></a><span id="l59.15"> var gOriginalStoreType;</span>
<a href="#l59.16"></a><span id="l59.16"> </span>
<a href="#l59.17"></a><span id="l59.17"> /**</span>
<a href="#l59.18"></a><span id="l59.18">  * Called when the store type menu is clicked.</span>
<a href="#l59.19"></a><span id="l59.19">  * @param {Object} aStoreTypeElement - store type menu list element.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l60.1"></a><span id="l60.1" class="difflineminus">--- a/mailnews/base/prefs/content/amUtils.js</span>
<a href="#l60.2"></a><span id="l60.2" class="difflineplus">+++ b/mailnews/base/prefs/content/amUtils.js</span>
<a href="#l60.3"></a><span id="l60.3" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l60.4"></a><span id="l60.4"> /* -*- Mode: C++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l60.5"></a><span id="l60.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l60.6"></a><span id="l60.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l60.7"></a><span id="l60.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l60.8"></a><span id="l60.8"> </span>
<a href="#l60.9"></a><span id="l60.9"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l60.10"></a><span id="l60.10"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l60.11"></a><span id="l60.11" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l60.12"></a><span id="l60.12" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l60.13"></a><span id="l60.13"> ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l60.14"></a><span id="l60.14"> </span>
<a href="#l60.15"></a><span id="l60.15"> function BrowseForLocalFolders()</span>
<a href="#l60.16"></a><span id="l60.16"> {</span>
<a href="#l60.17"></a><span id="l60.17">   const nsIFilePicker = Ci.nsIFilePicker;</span>
<a href="#l60.18"></a><span id="l60.18">   const nsIFile = Ci.nsIFile;</span>
<a href="#l60.19"></a><span id="l60.19"> </span>
<a href="#l60.20"></a><span id="l60.20">   var currentFolderTextBox = document.getElementById(&quot;server.localPath&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l61.1"></a><span id="l61.1" class="difflineminus">--- a/mailnews/base/prefs/content/converterDialog.js</span>
<a href="#l61.2"></a><span id="l61.2" class="difflineplus">+++ b/mailnews/base/prefs/content/converterDialog.js</span>
<a href="#l61.3"></a><span id="l61.3" class="difflineat">@@ -4,17 +4,17 @@</span>
<a href="#l61.4"></a><span id="l61.4"> </span>
<a href="#l61.5"></a><span id="l61.5"> /**</span>
<a href="#l61.6"></a><span id="l61.6">  * This file contains functionality for the front-end part of the mail store</span>
<a href="#l61.7"></a><span id="l61.7">  * type conversion.</span>
<a href="#l61.8"></a><span id="l61.8">  */</span>
<a href="#l61.9"></a><span id="l61.9"> </span>
<a href="#l61.10"></a><span id="l61.10"> ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l61.11"></a><span id="l61.11"> ChromeUtils.import(&quot;resource://gre/modules/BrowserUtils.jsm&quot;);</span>
<a href="#l61.12"></a><span id="l61.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l61.13"></a><span id="l61.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l61.14"></a><span id="l61.14"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l61.15"></a><span id="l61.15"> ChromeUtils.import(&quot;resource://gre/modules/FileUtils.jsm&quot;);</span>
<a href="#l61.16"></a><span id="l61.16"> ChromeUtils.import(&quot;resource://gre/modules/osfile.jsm&quot;);</span>
<a href="#l61.17"></a><span id="l61.17"> ChromeUtils.import(&quot;resource://gre/modules/Log.jsm&quot;);</span>
<a href="#l61.18"></a><span id="l61.18"> ChromeUtils.import(&quot;resource:///modules/mailstoreConverter.jsm&quot;);</span>
<a href="#l61.19"></a><span id="l61.19"> ChromeUtils.import(&quot;resource:///modules/folderUtils.jsm&quot;);</span>
<a href="#l61.20"></a><span id="l61.20"> </span>
<a href="#l61.21"></a><span id="l61.21"> var log = Log.repository.getLogger(&quot;MailStoreConverter&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l62.1"></a><span id="l62.1" class="difflineminus">--- a/mailnews/base/search/content/FilterEditor.js</span>
<a href="#l62.2"></a><span id="l62.2" class="difflineplus">+++ b/mailnews/base/search/content/FilterEditor.js</span>
<a href="#l62.3"></a><span id="l62.3" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l62.4"></a><span id="l62.4"> /* -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l62.5"></a><span id="l62.5"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l62.6"></a><span id="l62.6">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l62.7"></a><span id="l62.7">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l62.8"></a><span id="l62.8"> </span>
<a href="#l62.9"></a><span id="l62.9"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l62.10"></a><span id="l62.10"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l62.11"></a><span id="l62.11" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l62.12"></a><span id="l62.12" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l62.13"></a><span id="l62.13"> </span>
<a href="#l62.14"></a><span id="l62.14"> // The actual filter that we're editing if it is a _saved_ filter or prefill;</span>
<a href="#l62.15"></a><span id="l62.15"> // void otherwise.</span>
<a href="#l62.16"></a><span id="l62.16"> var gFilter;</span>
<a href="#l62.17"></a><span id="l62.17"> // cache the key elements we need</span>
<a href="#l62.18"></a><span id="l62.18"> var gFilterList;</span>
<a href="#l62.19"></a><span id="l62.19"> // The filter name as it appears in the &quot;Filter Name&quot; field of dialog.</span>
<a href="#l62.20"></a><span id="l62.20"> var gFilterNameElement;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l63.1"></a><span id="l63.1" class="difflineminus">--- a/mailnews/base/search/content/searchWidgets.xml</span>
<a href="#l63.2"></a><span id="l63.2" class="difflineplus">+++ b/mailnews/base/search/content/searchWidgets.xml</span>
<a href="#l63.3"></a><span id="l63.3" class="difflineat">@@ -442,17 +442,17 @@</span>
<a href="#l63.4"></a><span id="l63.4">         &lt;/body&gt;</span>
<a href="#l63.5"></a><span id="l63.5">       &lt;/method&gt;</span>
<a href="#l63.6"></a><span id="l63.6"> </span>
<a href="#l63.7"></a><span id="l63.7">       &lt;method name=&quot;validateAction&quot;&gt;</span>
<a href="#l63.8"></a><span id="l63.8">         &lt;body&gt;</span>
<a href="#l63.9"></a><span id="l63.9">           &lt;![CDATA[</span>
<a href="#l63.10"></a><span id="l63.10">             // returns true if this row represents a valid filter action and false otherwise.</span>
<a href="#l63.11"></a><span id="l63.11">             // This routine also prompts the user.</span>
<a href="#l63.12"></a><span id="l63.12" class="difflineminus">-            ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;, this);</span>
<a href="#l63.13"></a><span id="l63.13" class="difflineplus">+            ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;, this);</span>
<a href="#l63.14"></a><span id="l63.14">             var filterActionString = this.getAttribute('value');</span>
<a href="#l63.15"></a><span id="l63.15">             var actionTarget = document.getAnonymousNodes(this)[1];</span>
<a href="#l63.16"></a><span id="l63.16">             var errorString, customError;</span>
<a href="#l63.17"></a><span id="l63.17"> </span>
<a href="#l63.18"></a><span id="l63.18">             switch (filterActionString)</span>
<a href="#l63.19"></a><span id="l63.19">             {</span>
<a href="#l63.20"></a><span id="l63.20">               case &quot;movemessage&quot;:</span>
<a href="#l63.21"></a><span id="l63.21">               case &quot;copymessage&quot;:</span>
<a href="#l63.22"></a><span id="l63.22" class="difflineat">@@ -716,17 +716,17 @@</span>
<a href="#l63.23"></a><span id="l63.23">                        recentLabel=&quot;&amp;recentFolders.label;&quot;</span>
<a href="#l63.24"></a><span id="l63.24">                        showFileHereLabel=&quot;true&quot;/&gt;</span>
<a href="#l63.25"></a><span id="l63.25">       &lt;/xul:menulist&gt;</span>
<a href="#l63.26"></a><span id="l63.26">     &lt;/content&gt;</span>
<a href="#l63.27"></a><span id="l63.27"> </span>
<a href="#l63.28"></a><span id="l63.28">     &lt;implementation&gt;</span>
<a href="#l63.29"></a><span id="l63.29">       &lt;constructor&gt;</span>
<a href="#l63.30"></a><span id="l63.30">         &lt;![CDATA[</span>
<a href="#l63.31"></a><span id="l63.31" class="difflineminus">-          ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;, this);</span>
<a href="#l63.32"></a><span id="l63.32" class="difflineplus">+          ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;, this);</span>
<a href="#l63.33"></a><span id="l63.33">           let folder = this.menulist.value ?</span>
<a href="#l63.34"></a><span id="l63.34">                          this.MailUtils.getFolderForURI(this.menulist.value) :</span>
<a href="#l63.35"></a><span id="l63.35">                          gFilterList.folder;</span>
<a href="#l63.36"></a><span id="l63.36">           // An account folder is not a move/copy target; show &quot;Choose Folder&quot;.</span>
<a href="#l63.37"></a><span id="l63.37">           folder = folder.isServer ? null : folder;</span>
<a href="#l63.38"></a><span id="l63.38">           let menupopup = this.menulist.menupopup;</span>
<a href="#l63.39"></a><span id="l63.39">           // The menupopup constructor needs to finish first.</span>
<a href="#l63.40"></a><span id="l63.40">           setTimeout(function() { menupopup.selectFolder(folder); }, 0);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l64.1"></a><span id="l64.1" class="difflineminus">--- a/mailnews/base/src/nsMailNewsCommandLineHandler.js</span>
<a href="#l64.2"></a><span id="l64.2" class="difflineplus">+++ b/mailnews/base/src/nsMailNewsCommandLineHandler.js</span>
<a href="#l64.3"></a><span id="l64.3" class="difflineat">@@ -25,17 +25,17 @@ var nsMailNewsCommandLineHandler =</span>
<a href="#l64.4"></a><span id="l64.4">   /**</span>
<a href="#l64.5"></a><span id="l64.5">    * Handles the following command line arguments:</span>
<a href="#l64.6"></a><span id="l64.6">    * - -mail: opens the mail folder view</span>
<a href="#l64.7"></a><span id="l64.7">    * - -MapiStartup: indicates that this startup is due to MAPI.</span>
<a href="#l64.8"></a><span id="l64.8">    *   Don't do anything for now.</span>
<a href="#l64.9"></a><span id="l64.9">    */</span>
<a href="#l64.10"></a><span id="l64.10">   handle: function nsMailNewsCommandLineHandler_handle(aCommandLine) {</span>
<a href="#l64.11"></a><span id="l64.11">     // Do this here because xpcshell isn't too happy with this at startup</span>
<a href="#l64.12"></a><span id="l64.12" class="difflineminus">-    ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l64.13"></a><span id="l64.13" class="difflineplus">+    ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l64.14"></a><span id="l64.14">     // -mail &lt;URL&gt;</span>
<a href="#l64.15"></a><span id="l64.15">     let mailURL = null;</span>
<a href="#l64.16"></a><span id="l64.16">     try {</span>
<a href="#l64.17"></a><span id="l64.17">       mailURL = aCommandLine.handleFlagWithParam(&quot;mail&quot;, false);</span>
<a href="#l64.18"></a><span id="l64.18">     }</span>
<a href="#l64.19"></a><span id="l64.19">     catch (e) {</span>
<a href="#l64.20"></a><span id="l64.20">       // We're going to cover -mail without a parameter later</span>
<a href="#l64.21"></a><span id="l64.21">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l65.1"></a><span id="l65.1" class="difflineminus">--- a/mailnews/base/src/nsMsgSearchDBView.cpp</span>
<a href="#l65.2"></a><span id="l65.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgSearchDBView.cpp</span>
<a href="#l65.3"></a><span id="l65.3" class="difflineat">@@ -44,17 +44,17 @@ NS_IMPL_ISUPPORTS_INHERITED(nsMsgSearchD</span>
<a href="#l65.4"></a><span id="l65.4"> </span>
<a href="#l65.5"></a><span id="l65.5"> NS_IMETHODIMP</span>
<a href="#l65.6"></a><span id="l65.6"> nsMsgSearchDBView::Open(nsIMsgFolder *folder,</span>
<a href="#l65.7"></a><span id="l65.7">                         nsMsgViewSortTypeValue sortType,</span>
<a href="#l65.8"></a><span id="l65.8">                         nsMsgViewSortOrderValue sortOrder,</span>
<a href="#l65.9"></a><span id="l65.9">                         nsMsgViewFlagsTypeValue viewFlags,</span>
<a href="#l65.10"></a><span id="l65.10">                         int32_t *pCount)</span>
<a href="#l65.11"></a><span id="l65.11"> {</span>
<a href="#l65.12"></a><span id="l65.12" class="difflineminus">-  // dbViewWrapper.js likes to create search views with a sort order</span>
<a href="#l65.13"></a><span id="l65.13" class="difflineplus">+  // DBViewWrapper.jsm likes to create search views with a sort order</span>
<a href="#l65.14"></a><span id="l65.14">   // of byNone, in order to have the order be the order the search results</span>
<a href="#l65.15"></a><span id="l65.15">   // are returned. But this doesn't work with threaded view, so make the</span>
<a href="#l65.16"></a><span id="l65.16">   // sort order be byDate if we're threaded.</span>
<a href="#l65.17"></a><span id="l65.17"> </span>
<a href="#l65.18"></a><span id="l65.18">   if (viewFlags &amp; nsMsgViewFlagsType::kThreadedDisplay &amp;&amp;</span>
<a href="#l65.19"></a><span id="l65.19">       sortType == nsMsgViewSortType::byNone)</span>
<a href="#l65.20"></a><span id="l65.20">     sortType = nsMsgViewSortType::byDate;</span>
<a href="#l65.21"></a><span id="l65.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l66.1"></a><span id="l66.1" class="difflineminus">--- a/mailnews/base/src/nsMsgXFVirtualFolderDBView.cpp</span>
<a href="#l66.2"></a><span id="l66.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgXFVirtualFolderDBView.cpp</span>
<a href="#l66.3"></a><span id="l66.3" class="difflineat">@@ -433,17 +433,17 @@ nsMsgXFVirtualFolderDBView::OnNewSearch(</span>
<a href="#l66.4"></a><span id="l66.4">   dbFolderInfo-&gt;GetCharProperty(&quot;searchStr&quot;, terms);</span>
<a href="#l66.5"></a><span id="l66.5">   nsCOMPtr&lt;nsIMutableArray&gt; searchTerms;</span>
<a href="#l66.6"></a><span id="l66.6">   rv = searchSession-&gt;GetSearchTerms(getter_AddRefs(searchTerms));</span>
<a href="#l66.7"></a><span id="l66.7">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l66.8"></a><span id="l66.8">   nsCString curSearchAsString;</span>
<a href="#l66.9"></a><span id="l66.9"> </span>
<a href="#l66.10"></a><span id="l66.10">   rv = MsgTermListToString(searchTerms, curSearchAsString);</span>
<a href="#l66.11"></a><span id="l66.11">   // Trim off the initial AND/OR, which is irrelevant and inconsistent between</span>
<a href="#l66.12"></a><span id="l66.12" class="difflineminus">-  // what searchSpec.js generates, and what's in virtualFolders.dat.</span>
<a href="#l66.13"></a><span id="l66.13" class="difflineplus">+  // what SearchSpec.jsm generates, and what's in virtualFolders.dat.</span>
<a href="#l66.14"></a><span id="l66.14">   curSearchAsString.Cut(0, StringBeginsWith(curSearchAsString,</span>
<a href="#l66.15"></a><span id="l66.15">                                             NS_LITERAL_CSTRING(&quot;AND&quot;)) ? 3 : 2);</span>
<a href="#l66.16"></a><span id="l66.16">   terms.Cut(0, StringBeginsWith(terms, NS_LITERAL_CSTRING(&quot;AND&quot;)) ? 3 : 2);</span>
<a href="#l66.17"></a><span id="l66.17"> </span>
<a href="#l66.18"></a><span id="l66.18">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l66.19"></a><span id="l66.19">   // If the search session search string doesn't match the vf search str,</span>
<a href="#l66.20"></a><span id="l66.20">   // then we're doing quick search, which means we don't want to invalidate</span>
<a href="#l66.21"></a><span id="l66.21">   // cached results, or used cached results.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l67.1"></a><span id="l67.1" class="difflineminus">--- a/mailnews/base/util/mailstoreConverter.jsm</span>
<a href="#l67.2"></a><span id="l67.2" class="difflineplus">+++ b/mailnews/base/util/mailstoreConverter.jsm</span>
<a href="#l67.3"></a><span id="l67.3" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l67.4"></a><span id="l67.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l67.5"></a><span id="l67.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l67.6"></a><span id="l67.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l67.7"></a><span id="l67.7"> </span>
<a href="#l67.8"></a><span id="l67.8"> var EXPORTED_SYMBOLS = [&quot;convertMailStoreTo&quot;, &quot;terminateWorkers&quot;];</span>
<a href="#l67.9"></a><span id="l67.9"> </span>
<a href="#l67.10"></a><span id="l67.10"> ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l67.11"></a><span id="l67.11" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l67.12"></a><span id="l67.12" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l67.13"></a><span id="l67.13"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l67.14"></a><span id="l67.14"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l67.15"></a><span id="l67.15"> ChromeUtils.import(&quot;resource://gre/modules/FileUtils.jsm&quot;);</span>
<a href="#l67.16"></a><span id="l67.16"> ChromeUtils.import(&quot;resource://gre/modules/osfile.jsm&quot;);</span>
<a href="#l67.17"></a><span id="l67.17"> ChromeUtils.import(&quot;resource://gre/modules/Log.jsm&quot;);</span>
<a href="#l67.18"></a><span id="l67.18"> </span>
<a href="#l67.19"></a><span id="l67.19"> var log = Log.repository.getLogger(&quot;MailStoreConverter&quot;);</span>
<a href="#l67.20"></a><span id="l67.20"> log.level = Log.Level.Debug;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l68.1"></a><span id="l68.1" class="difflineminus">--- a/mailnews/db/gloda/modules/index_msg.js</span>
<a href="#l68.2"></a><span id="l68.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/index_msg.js</span>
<a href="#l68.3"></a><span id="l68.3" class="difflineat">@@ -12,17 +12,17 @@</span>
<a href="#l68.4"></a><span id="l68.4">  *  benefit readability/size as well.</span>
<a href="#l68.5"></a><span id="l68.5">  */</span>
<a href="#l68.6"></a><span id="l68.6"> </span>
<a href="#l68.7"></a><span id="l68.7"> this.EXPORTED_SYMBOLS = ['GlodaMsgIndexer'];</span>
<a href="#l68.8"></a><span id="l68.8"> </span>
<a href="#l68.9"></a><span id="l68.9"> ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l68.10"></a><span id="l68.10"> ChromeUtils.import(&quot;resource:///modules/iteratorUtils.jsm&quot;);</span>
<a href="#l68.11"></a><span id="l68.11"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l68.12"></a><span id="l68.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l68.13"></a><span id="l68.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l68.14"></a><span id="l68.14"> </span>
<a href="#l68.15"></a><span id="l68.15"> ChromeUtils.import(&quot;resource:///modules/gloda/log4moz.js&quot;);</span>
<a href="#l68.16"></a><span id="l68.16"> </span>
<a href="#l68.17"></a><span id="l68.17"> ChromeUtils.import(&quot;resource:///modules/gloda/utils.js&quot;);</span>
<a href="#l68.18"></a><span id="l68.18"> ChromeUtils.import(&quot;resource:///modules/gloda/datastore.js&quot;);</span>
<a href="#l68.19"></a><span id="l68.19"> ChromeUtils.import(&quot;resource:///modules/gloda/datamodel.js&quot;);</span>
<a href="#l68.20"></a><span id="l68.20"> ChromeUtils.import(&quot;resource:///modules/gloda/gloda.js&quot;);</span>
<a href="#l68.21"></a><span id="l68.21"> ChromeUtils.import(&quot;resource:///modules/gloda/collection.js&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l69.1"></a><span id="l69.1" class="difflineminus">--- a/mailnews/db/gloda/test/unit/base_index_messages.js</span>
<a href="#l69.2"></a><span id="l69.2" class="difflineplus">+++ b/mailnews/db/gloda/test/unit/base_index_messages.js</span>
<a href="#l69.3"></a><span id="l69.3" class="difflineat">@@ -12,17 +12,17 @@</span>
<a href="#l69.4"></a><span id="l69.4">  *  variants.  See the text_index_messages_*.js files.</span>
<a href="#l69.5"></a><span id="l69.5">  *</span>
<a href="#l69.6"></a><span id="l69.6">  * Things we don't test that you think we might test:</span>
<a href="#l69.7"></a><span id="l69.7">  * - Full-text search.  Happens in query testing.</span>
<a href="#l69.8"></a><span id="l69.8">  */</span>
<a href="#l69.9"></a><span id="l69.9"> </span>
<a href="#l69.10"></a><span id="l69.10"> load(&quot;resources/glodaTestHelper.js&quot;);</span>
<a href="#l69.11"></a><span id="l69.11"> </span>
<a href="#l69.12"></a><span id="l69.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l69.13"></a><span id="l69.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l69.14"></a><span id="l69.14"> ChromeUtils.import(&quot;resource://gre/modules/NetUtil.jsm&quot;);</span>
<a href="#l69.15"></a><span id="l69.15"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l69.16"></a><span id="l69.16"> </span>
<a href="#l69.17"></a><span id="l69.17"> // Whether we can expect fulltext results</span>
<a href="#l69.18"></a><span id="l69.18"> var expectFulltextResults = true;</span>
<a href="#l69.19"></a><span id="l69.19"> </span>
<a href="#l69.20"></a><span id="l69.20"> /**</span>
<a href="#l69.21"></a><span id="l69.21">  * Should we force our folders offline after we have indexed them once.  We do</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l70.1"></a><span id="l70.1" class="difflineminus">--- a/mailnews/extensions/newsblog/content/FeedUtils.jsm</span>
<a href="#l70.2"></a><span id="l70.2" class="difflineplus">+++ b/mailnews/extensions/newsblog/content/FeedUtils.jsm</span>
<a href="#l70.3"></a><span id="l70.3" class="difflineat">@@ -3,17 +3,17 @@</span>
<a href="#l70.4"></a><span id="l70.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l70.5"></a><span id="l70.5">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l70.6"></a><span id="l70.6"> </span>
<a href="#l70.7"></a><span id="l70.7"> this.EXPORTED_SYMBOLS = [&quot;Feed&quot;, &quot;FeedItem&quot;, &quot;FeedParser&quot;, &quot;FeedUtils&quot;];</span>
<a href="#l70.8"></a><span id="l70.8"> </span>
<a href="#l70.9"></a><span id="l70.9"> /* eslint-disable-next-line no-unused-vars */</span>
<a href="#l70.10"></a><span id="l70.10"> ChromeUtils.import(&quot;resource:///modules/gloda/log4moz.js&quot;);</span>
<a href="#l70.11"></a><span id="l70.11"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l70.12"></a><span id="l70.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l70.13"></a><span id="l70.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l70.14"></a><span id="l70.14"> ChromeUtils.import(&quot;resource:///modules/jsmime.jsm&quot;);</span>
<a href="#l70.15"></a><span id="l70.15"> ChromeUtils.import(&quot;resource://gre/modules/FileUtils.jsm&quot;);</span>
<a href="#l70.16"></a><span id="l70.16"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l70.17"></a><span id="l70.17"> ChromeUtils.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l70.18"></a><span id="l70.18"> </span>
<a href="#l70.19"></a><span id="l70.19"> Cu.importGlobalProperties([&quot;XMLHttpRequest&quot;]);</span>
<a href="#l70.20"></a><span id="l70.20"> </span>
<a href="#l70.21"></a><span id="l70.21"> Services.scriptloader.loadSubScript(&quot;chrome://messenger-newsblog/content/Feed.js&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l71.1"></a><span id="l71.1" class="difflineminus">--- a/mailnews/imap/test/unit/test_saveTemplate.js</span>
<a href="#l71.2"></a><span id="l71.2" class="difflineplus">+++ b/mailnews/imap/test/unit/test_saveTemplate.js</span>
<a href="#l71.3"></a><span id="l71.3" class="difflineat">@@ -4,17 +4,17 @@</span>
<a href="#l71.4"></a><span id="l71.4"> </span>
<a href="#l71.5"></a><span id="l71.5"> /*</span>
<a href="#l71.6"></a><span id="l71.6">  * Tests imap save of message as a template, and test initial save right after</span>
<a href="#l71.7"></a><span id="l71.7">  * creation of folder.</span>
<a href="#l71.8"></a><span id="l71.8">  */</span>
<a href="#l71.9"></a><span id="l71.9"> </span>
<a href="#l71.10"></a><span id="l71.10"> ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l71.11"></a><span id="l71.11"> ChromeUtils.import(&quot;resource:///modules/MailServices.jsm&quot;);</span>
<a href="#l71.12"></a><span id="l71.12" class="difflineminus">-ChromeUtils.import(&quot;resource:///modules/MailUtils.js&quot;);</span>
<a href="#l71.13"></a><span id="l71.13" class="difflineplus">+ChromeUtils.import(&quot;resource:///modules/MailUtils.jsm&quot;);</span>
<a href="#l71.14"></a><span id="l71.14"> </span>
<a href="#l71.15"></a><span id="l71.15"> load(&quot;../../../resources/logHelper.js&quot;);</span>
<a href="#l71.16"></a><span id="l71.16"> load(&quot;../../../resources/asyncTestUtils.js&quot;);</span>
<a href="#l71.17"></a><span id="l71.17"> load(&quot;../../../resources/messageGenerator.js&quot;);</span>
<a href="#l71.18"></a><span id="l71.18"> </span>
<a href="#l71.19"></a><span id="l71.19"> // IMAP pump</span>
<a href="#l71.20"></a><span id="l71.20"> </span>
<a href="#l71.21"></a><span id="l71.21"> setupIMAPPump();</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:33Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

