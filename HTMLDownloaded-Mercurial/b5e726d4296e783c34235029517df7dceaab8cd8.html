<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 29894:b5e726d4296e783c34235029517df7dceaab8cd8</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ b5e726d4296e783c34235029517df7dceaab8cd8" />
<meta property="og:url" content="/comm-central/rev/b5e726d4296e783c34235029517df7dceaab8cd8" />
<meta property="og:description" content="Bug 1638822 - convert openpgp strings to Fluent - part 4 - jsm files continue. r=mkmelin" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / b5e726d4296e783c34235029517df7dceaab8cd8 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/b5e726d4296e783c34235029517df7dceaab8cd8">shortlog</a> |
<a href="/comm-central/log/b5e726d4296e783c34235029517df7dceaab8cd8">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/b5e726d4296e783c34235029517df7dceaab8cd8">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/b5e726d4296e783c34235029517df7dceaab8cd8">files</a> |
changeset |
<a href="/comm-central/raw-rev/b5e726d4296e783c34235029517df7dceaab8cd8">raw</a>  | <a href="/comm-central/archive/b5e726d4296e783c34235029517df7dceaab8cd8.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1638822">Bug 1638822</a> - convert openpgp strings to Fluent - part 4 - jsm files continue. r=mkmelin
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#75;&#104;&#117;&#115;&#104;&#105;&#108;&#32;&#77;&#105;&#115;&#116;&#114;&#121;&#32;&#60;&#107;&#104;&#117;&#115;&#104;&#105;&#108;&#51;&#50;&#52;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Thu, 18 Jun 2020 13:55:06 +0300</td></tr>

<tr>
 <td>changeset 29894</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/b5e726d4296e783c34235029517df7dceaab8cd8">b5e726d4296e783c34235029517df7dceaab8cd8</a></td>
</tr>



<tr>
<td>parent 29893</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/387694d31eb31e5e7fe462c2c52ef367768d0166">387694d31eb31e5e7fe462c2c52ef367768d0166</a>
</td>
</tr>

<tr>
<td>child 29895</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/edee35309f496e96b7b2708f1f87de89b505b3d9">edee35309f496e96b7b2708f1f87de89b505b3d9</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=b5e726d4296e783c34235029517df7dceaab8cd8">17586</a></td></tr>
<tr><td>push user</td><td>mkmelin@iki.fi</td></tr>
<tr><td>push date</td><td class="date age">Thu, 18 Jun 2020 10:58:18 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@a55755a0f3fe [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=a55755a0f3fe6e48e615cc6c54edcb8df30fdc9e">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=a55755a0f3fe6e48e615cc6c54edcb8df30fdc9e&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a55755a0f3fe6e48e615cc6c54edcb8df30fdc9e&newProject=comm-central&newRevision=b5e726d4296e783c34235029517df7dceaab8cd8&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a55755a0f3fe6e48e615cc6c54edcb8df30fdc9e&newProject=comm-central&newRevision=b5e726d4296e783c34235029517df7dceaab8cd8&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a55755a0f3fe6e48e615cc6c54edcb8df30fdc9e&newProject=comm-central&newRevision=b5e726d4296e783c34235029517df7dceaab8cd8&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28mkmelin%29&revcount=50">mkmelin</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1638822">1638822</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1638822">Bug 1638822</a> - convert openpgp strings to Fluent - part 4 - jsm files continue. r=mkmelin</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/cryptoAPI/GnuPGCryptoAPI.jsm">mail/extensions/openpgp/content/modules/cryptoAPI/GnuPGCryptoAPI.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/cryptoAPI/GnuPGCryptoAPI.jsm">file</a> |
<a href="/comm-central/annotate/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/cryptoAPI/GnuPGCryptoAPI.jsm">annotate</a> |
<a href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/cryptoAPI/GnuPGCryptoAPI.jsm">diff</a> |
<a href="/comm-central/comparison/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/cryptoAPI/GnuPGCryptoAPI.jsm">comparison</a> |
<a href="/comm-central/log/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/cryptoAPI/GnuPGCryptoAPI.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/cryptoAPI/gnupg-keylist.jsm">mail/extensions/openpgp/content/modules/cryptoAPI/gnupg-keylist.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/cryptoAPI/gnupg-keylist.jsm">file</a> |
<a href="/comm-central/annotate/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/cryptoAPI/gnupg-keylist.jsm">annotate</a> |
<a href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/cryptoAPI/gnupg-keylist.jsm">diff</a> |
<a href="/comm-central/comparison/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/cryptoAPI/gnupg-keylist.jsm">comparison</a> |
<a href="/comm-central/log/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/cryptoAPI/gnupg-keylist.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/errorHandling.jsm">mail/extensions/openpgp/content/modules/errorHandling.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/errorHandling.jsm">file</a> |
<a href="/comm-central/annotate/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/errorHandling.jsm">annotate</a> |
<a href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/errorHandling.jsm">diff</a> |
<a href="/comm-central/comparison/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/errorHandling.jsm">comparison</a> |
<a href="/comm-central/log/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/errorHandling.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/keyLookupHelper.jsm">mail/extensions/openpgp/content/modules/keyLookupHelper.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/keyLookupHelper.jsm">file</a> |
<a href="/comm-central/annotate/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/keyLookupHelper.jsm">annotate</a> |
<a href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/keyLookupHelper.jsm">diff</a> |
<a href="/comm-central/comparison/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/keyLookupHelper.jsm">comparison</a> |
<a href="/comm-central/log/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/keyLookupHelper.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/keyRing.jsm">mail/extensions/openpgp/content/modules/keyRing.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/keyRing.jsm">file</a> |
<a href="/comm-central/annotate/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/keyRing.jsm">annotate</a> |
<a href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/keyRing.jsm">diff</a> |
<a href="/comm-central/comparison/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/keyRing.jsm">comparison</a> |
<a href="/comm-central/log/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/keyRing.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/trust.jsm">mail/extensions/openpgp/content/modules/trust.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/trust.jsm">file</a> |
<a href="/comm-central/annotate/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/trust.jsm">annotate</a> |
<a href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/trust.jsm">diff</a> |
<a href="/comm-central/comparison/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/trust.jsm">comparison</a> |
<a href="/comm-central/log/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/trust.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/windows.jsm">mail/extensions/openpgp/content/modules/windows.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/windows.jsm">file</a> |
<a href="/comm-central/annotate/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/windows.jsm">annotate</a> |
<a href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/windows.jsm">diff</a> |
<a href="/comm-central/comparison/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/windows.jsm">comparison</a> |
<a href="/comm-central/log/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/modules/windows.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/strings/enigmail.ftl">mail/extensions/openpgp/content/strings/enigmail.ftl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/strings/enigmail.ftl">file</a> |
<a href="/comm-central/annotate/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/strings/enigmail.ftl">annotate</a> |
<a href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/strings/enigmail.ftl">diff</a> |
<a href="/comm-central/comparison/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/strings/enigmail.ftl">comparison</a> |
<a href="/comm-central/log/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/strings/enigmail.ftl">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/strings/enigmail.properties">mail/extensions/openpgp/content/strings/enigmail.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/strings/enigmail.properties">file</a> |
<a href="/comm-central/annotate/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/strings/enigmail.properties">annotate</a> |
<a href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/strings/enigmail.properties">diff</a> |
<a href="/comm-central/comparison/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/strings/enigmail.properties">comparison</a> |
<a href="/comm-central/log/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/strings/enigmail.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/commonWorkflows.js">mail/extensions/openpgp/content/ui/commonWorkflows.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/commonWorkflows.js">file</a> |
<a href="/comm-central/annotate/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/commonWorkflows.js">annotate</a> |
<a href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/commonWorkflows.js">diff</a> |
<a href="/comm-central/comparison/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/commonWorkflows.js">comparison</a> |
<a href="/comm-central/log/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/commonWorkflows.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/enigmailKeyManager.js">mail/extensions/openpgp/content/ui/enigmailKeyManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/enigmailKeyManager.js">file</a> |
<a href="/comm-central/annotate/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/enigmailKeyManager.js">annotate</a> |
<a href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/enigmailKeyManager.js">diff</a> |
<a href="/comm-central/comparison/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/enigmailKeyManager.js">comparison</a> |
<a href="/comm-central/log/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/enigmailKeyManager.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/enigmailKeygen.js">mail/extensions/openpgp/content/ui/enigmailKeygen.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/enigmailKeygen.js">file</a> |
<a href="/comm-central/annotate/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/enigmailKeygen.js">annotate</a> |
<a href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/enigmailKeygen.js">diff</a> |
<a href="/comm-central/comparison/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/enigmailKeygen.js">comparison</a> |
<a href="/comm-central/log/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/enigmailKeygen.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/keyDetailsDlg.js">mail/extensions/openpgp/content/ui/keyDetailsDlg.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/keyDetailsDlg.js">file</a> |
<a href="/comm-central/annotate/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/keyDetailsDlg.js">annotate</a> |
<a href="/comm-central/diff/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/keyDetailsDlg.js">diff</a> |
<a href="/comm-central/comparison/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/keyDetailsDlg.js">comparison</a> |
<a href="/comm-central/log/b5e726d4296e783c34235029517df7dceaab8cd8/mail/extensions/openpgp/content/ui/keyDetailsDlg.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/cryptoAPI/GnuPGCryptoAPI.jsm</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/cryptoAPI/GnuPGCryptoAPI.jsm</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -17,19 +17,18 @@ Services.scriptloader.loadSubScript(</span>
<a href="#l1.4"></a><span id="l1.4"> ); /* global CryptoAPI */</span>
<a href="#l1.5"></a><span id="l1.5"> </span>
<a href="#l1.6"></a><span id="l1.6"> const { EnigmailLog } = ChromeUtils.import(</span>
<a href="#l1.7"></a><span id="l1.7">   &quot;chrome://openpgp/content/modules/log.jsm&quot;</span>
<a href="#l1.8"></a><span id="l1.8"> );</span>
<a href="#l1.9"></a><span id="l1.9"> const { EnigmailConstants } = ChromeUtils.import(</span>
<a href="#l1.10"></a><span id="l1.10">   &quot;chrome://openpgp/content/modules/constants.jsm&quot;</span>
<a href="#l1.11"></a><span id="l1.11"> );</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-const { EnigmailLocale } = ChromeUtils.import(</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-  &quot;chrome://openpgp/content/modules/locale.jsm&quot;</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineminus">-);</span>
<a href="#l1.15"></a><span id="l1.15" class="difflineplus">+</span>
<a href="#l1.16"></a><span id="l1.16" class="difflineplus">+const l10n = new Localization([&quot;messenger/openpgp/enigmail.ftl&quot;], true);</span>
<a href="#l1.17"></a><span id="l1.17"> </span>
<a href="#l1.18"></a><span id="l1.18"> const {</span>
<a href="#l1.19"></a><span id="l1.19">   obtainKeyList,</span>
<a href="#l1.20"></a><span id="l1.20">   getPhotoFileFromGnuPG,</span>
<a href="#l1.21"></a><span id="l1.21">   getGpgKeyData,</span>
<a href="#l1.22"></a><span id="l1.22"> } = ChromeUtils.import(</span>
<a href="#l1.23"></a><span id="l1.23">   &quot;chrome://openpgp/content/modules/cryptoAPI/gnupg-keylist.jsm&quot;</span>
<a href="#l1.24"></a><span id="l1.24"> );</span>
<a href="#l1.25"></a><span id="l1.25" class="difflineat">@@ -137,17 +136,17 @@ class GnuPGCryptoAPI extends CryptoAPI {</span>
<a href="#l1.26"></a><span id="l1.26">    *   - {String} errorMsg:  error message in case exitCode !== 0</span>
<a href="#l1.27"></a><span id="l1.27">    */</span>
<a href="#l1.28"></a><span id="l1.28"> </span>
<a href="#l1.29"></a><span id="l1.29">   async extractSecretKey(keyId, minimalKey) {</span>
<a href="#l1.30"></a><span id="l1.30">     let ret = await GnuPG_extractSecretKey(keyId, minimalKey);</span>
<a href="#l1.31"></a><span id="l1.31"> </span>
<a href="#l1.32"></a><span id="l1.32">     if (ret.exitCode !== 0) {</span>
<a href="#l1.33"></a><span id="l1.33">       ret.errorMsg =</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineminus">-        EnigmailLocale.getString(&quot;failKeyExtract&quot;) + &quot;\n&quot; + ret.errorMsg;</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineplus">+        (await l10n.formatValue(&quot;fail-key-extract&quot;)) + &quot;\n&quot; + ret.errorMsg;</span>
<a href="#l1.36"></a><span id="l1.36">     }</span>
<a href="#l1.37"></a><span id="l1.37">     return ret;</span>
<a href="#l1.38"></a><span id="l1.38">   }</span>
<a href="#l1.39"></a><span id="l1.39"> </span>
<a href="#l1.40"></a><span id="l1.40">   /**</span>
<a href="#l1.41"></a><span id="l1.41">    *</span>
<a href="#l1.42"></a><span id="l1.42">    * @param {byte} byteData    The encrypted data</span>
<a href="#l1.43"></a><span id="l1.43">    *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/cryptoAPI/gnupg-keylist.jsm</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/cryptoAPI/gnupg-keylist.jsm</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -24,19 +24,16 @@ const { EnigmailLog } = ChromeUtils.impo</span>
<a href="#l2.4"></a><span id="l2.4">   &quot;chrome://openpgp/content/modules/log.jsm&quot;</span>
<a href="#l2.5"></a><span id="l2.5"> );</span>
<a href="#l2.6"></a><span id="l2.6"> const { EnigmailTrust } = ChromeUtils.import(</span>
<a href="#l2.7"></a><span id="l2.7">   &quot;chrome://openpgp/content/modules/trust.jsm&quot;</span>
<a href="#l2.8"></a><span id="l2.8"> );</span>
<a href="#l2.9"></a><span id="l2.9"> const { EnigmailData } = ChromeUtils.import(</span>
<a href="#l2.10"></a><span id="l2.10">   &quot;chrome://openpgp/content/modules/data.jsm&quot;</span>
<a href="#l2.11"></a><span id="l2.11"> );</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-const { EnigmailLocale } = ChromeUtils.import(</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-  &quot;chrome://openpgp/content/modules/locale.jsm&quot;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineminus">-);</span>
<a href="#l2.15"></a><span id="l2.15"> </span>
<a href="#l2.16"></a><span id="l2.16"> var l10n = new Localization([&quot;messenger/openpgp/enigmail.ftl&quot;], true);</span>
<a href="#l2.17"></a><span id="l2.17"> </span>
<a href="#l2.18"></a><span id="l2.18"> // field ID's of key list (as described in the doc/DETAILS file in the GnuPG distribution)</span>
<a href="#l2.19"></a><span id="l2.19"> const ENTRY_ID = 0;</span>
<a href="#l2.20"></a><span id="l2.20"> const KEY_TRUST_ID = 1;</span>
<a href="#l2.21"></a><span id="l2.21"> const KEY_SIZE_ID = 2;</span>
<a href="#l2.22"></a><span id="l2.22"> const KEY_ALGO_ID = 3;</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineat">@@ -81,17 +78,17 @@ async function obtainKeyList(onlyKeys = </span>
<a href="#l2.24"></a><span id="l2.24">  *</span>
<a href="#l2.25"></a><span id="l2.25">  * @param keyListString: array of |string| formatted output from GnuPG for key listing</span>
<a href="#l2.26"></a><span id="l2.26">  * @param keyList:    |object| holding the resulting key list</span>
<a href="#l2.27"></a><span id="l2.27">  *                         obj.keyList:     Array holding key objects</span>
<a href="#l2.28"></a><span id="l2.28">  *                         obj.keySortList: Array holding values to make sorting easier</span>
<a href="#l2.29"></a><span id="l2.29">  *</span>
<a href="#l2.30"></a><span id="l2.30">  * no return value</span>
<a href="#l2.31"></a><span id="l2.31">  */</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineminus">-function appendKeyItems(keyListString, keyList) {</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineplus">+async function appendKeyItems(keyListString, keyList) {</span>
<a href="#l2.34"></a><span id="l2.34">   EnigmailLog.DEBUG(&quot;gnupg-keylist.jsm: appendKeyItems()\n&quot;);</span>
<a href="#l2.35"></a><span id="l2.35">   let keyObj = {};</span>
<a href="#l2.36"></a><span id="l2.36">   let uatNum = 0; // counter for photos (counts per key)</span>
<a href="#l2.37"></a><span id="l2.37"> </span>
<a href="#l2.38"></a><span id="l2.38">   const TRUSTLEVELS_SORTED = EnigmailTrust.trustLevelsSorted();</span>
<a href="#l2.39"></a><span id="l2.39"> </span>
<a href="#l2.40"></a><span id="l2.40">   for (let i = 0; i &lt; keyListString.length; i++) {</span>
<a href="#l2.41"></a><span id="l2.41">     let listRow = keyListString[i].split(/:/);</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineat">@@ -158,17 +155,17 @@ function appendKeyItems(keyListString, k</span>
<a href="#l2.43"></a><span id="l2.43">           algoSym: ALGO_SYMBOL[listRow[KEY_ALGO_ID]],</span>
<a href="#l2.44"></a><span id="l2.44">           created: EnigmailTime.getDateTime(listRow[CREATED_ID], true, false),</span>
<a href="#l2.45"></a><span id="l2.45">           keyCreated: Number(listRow[CREATED_ID]),</span>
<a href="#l2.46"></a><span id="l2.46">           type: &quot;sub&quot;,</span>
<a href="#l2.47"></a><span id="l2.47">         });</span>
<a href="#l2.48"></a><span id="l2.48">         break;</span>
<a href="#l2.49"></a><span id="l2.49">       case &quot;uat&quot;:</span>
<a href="#l2.50"></a><span id="l2.50">         if (listRow[USERID_ID].indexOf(&quot;1 &quot;) === 0) {</span>
<a href="#l2.51"></a><span id="l2.51" class="difflineminus">-          const userId = EnigmailLocale.getString(&quot;userAtt.photo&quot;);</span>
<a href="#l2.52"></a><span id="l2.52" class="difflineplus">+          const userId = await l10n.formatValue(&quot;user-att-photo&quot;);</span>
<a href="#l2.53"></a><span id="l2.53">           keyObj.userIds.push({</span>
<a href="#l2.54"></a><span id="l2.54">             userId,</span>
<a href="#l2.55"></a><span id="l2.55">             keyTrust: listRow[KEY_TRUST_ID],</span>
<a href="#l2.56"></a><span id="l2.56">             uidFpr: listRow[UID_ID],</span>
<a href="#l2.57"></a><span id="l2.57">             type: &quot;uat&quot;,</span>
<a href="#l2.58"></a><span id="l2.58">             uatNum,</span>
<a href="#l2.59"></a><span id="l2.59">           });</span>
<a href="#l2.60"></a><span id="l2.60">           keyObj.photoAvailable = true;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/errorHandling.jsm</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/errorHandling.jsm</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -6,33 +6,32 @@</span>
<a href="#l3.4"></a><span id="l3.4"> </span>
<a href="#l3.5"></a><span id="l3.5"> &quot;use strict&quot;;</span>
<a href="#l3.6"></a><span id="l3.6"> </span>
<a href="#l3.7"></a><span id="l3.7"> var EXPORTED_SYMBOLS = [&quot;EnigmailErrorHandling&quot;];</span>
<a href="#l3.8"></a><span id="l3.8"> </span>
<a href="#l3.9"></a><span id="l3.9"> const { EnigmailLog } = ChromeUtils.import(</span>
<a href="#l3.10"></a><span id="l3.10">   &quot;chrome://openpgp/content/modules/log.jsm&quot;</span>
<a href="#l3.11"></a><span id="l3.11"> );</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-const { EnigmailLocale } = ChromeUtils.import(</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-  &quot;chrome://openpgp/content/modules/locale.jsm&quot;</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineminus">-);</span>
<a href="#l3.15"></a><span id="l3.15"> const { EnigmailLazy } = ChromeUtils.import(</span>
<a href="#l3.16"></a><span id="l3.16">   &quot;chrome://openpgp/content/modules/lazy.jsm&quot;</span>
<a href="#l3.17"></a><span id="l3.17"> );</span>
<a href="#l3.18"></a><span id="l3.18"> </span>
<a href="#l3.19"></a><span id="l3.19"> const getEnigmailKeyRing = EnigmailLazy.loader(</span>
<a href="#l3.20"></a><span id="l3.20">   &quot;enigmail/keyRing.jsm&quot;,</span>
<a href="#l3.21"></a><span id="l3.21">   &quot;EnigmailKeyRing&quot;</span>
<a href="#l3.22"></a><span id="l3.22"> );</span>
<a href="#l3.23"></a><span id="l3.23"> const getEnigmailFiles = EnigmailLazy.loader(</span>
<a href="#l3.24"></a><span id="l3.24">   &quot;enigmail/files.jsm&quot;,</span>
<a href="#l3.25"></a><span id="l3.25">   &quot;EnigmailFiles&quot;</span>
<a href="#l3.26"></a><span id="l3.26"> );</span>
<a href="#l3.27"></a><span id="l3.27"> const getEnigmailRNG = EnigmailLazy.loader(&quot;enigmail/rng.jsm&quot;, &quot;EnigmailRNG&quot;);</span>
<a href="#l3.28"></a><span id="l3.28"> </span>
<a href="#l3.29"></a><span id="l3.29" class="difflineplus">+const l10n = new Localization([&quot;messenger/openpgp/enigmail.ftl&quot;], true);</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineplus">+</span>
<a href="#l3.31"></a><span id="l3.31"> var EnigmailErrorHandling = {</span>
<a href="#l3.32"></a><span id="l3.32">   /**</span>
<a href="#l3.33"></a><span id="l3.33">    * Determin why a given key or userID cannot be used for signing</span>
<a href="#l3.34"></a><span id="l3.34">    *</span>
<a href="#l3.35"></a><span id="l3.35">    * @param keySpec String - key ID or user ID</span>
<a href="#l3.36"></a><span id="l3.36">    *</span>
<a href="#l3.37"></a><span id="l3.37">    * @return String - the reason(s) as message to display to the user</span>
<a href="#l3.38"></a><span id="l3.38">    *                  &quot;&quot; in case the key is valid</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineat">@@ -42,36 +41,35 @@ var EnigmailErrorHandling = {</span>
<a href="#l3.40"></a><span id="l3.40">       &quot;errorHandling.jsm: determineInvSignReason: keySpec: &quot; + keySpec + &quot;\n&quot;</span>
<a href="#l3.41"></a><span id="l3.41">     );</span>
<a href="#l3.42"></a><span id="l3.42"> </span>
<a href="#l3.43"></a><span id="l3.43">     let reasonMsg = &quot;&quot;;</span>
<a href="#l3.44"></a><span id="l3.44"> </span>
<a href="#l3.45"></a><span id="l3.45">     if (keySpec.search(/^(0x)?[0-9A-F]+$/) === 0) {</span>
<a href="#l3.46"></a><span id="l3.46">       let key = getEnigmailKeyRing().getKeyById(keySpec);</span>
<a href="#l3.47"></a><span id="l3.47">       if (!key) {</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineminus">-        reasonMsg = EnigmailLocale.getString(&quot;keyError.keyIdNotFound&quot;, keySpec);</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineminus">-      } else {</span>
<a href="#l3.50"></a><span id="l3.50" class="difflineminus">-        let r = key.getSigningValidity();</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineminus">-        if (!r.keyValid) {</span>
<a href="#l3.52"></a><span id="l3.52" class="difflineminus">-          reasonMsg = r.reason;</span>
<a href="#l3.53"></a><span id="l3.53" class="difflineminus">-        }</span>
<a href="#l3.54"></a><span id="l3.54" class="difflineplus">+        return l10n.formatValueSync(&quot;key-error-key-id-not-found&quot;, {</span>
<a href="#l3.55"></a><span id="l3.55" class="difflineplus">+          keySpec,</span>
<a href="#l3.56"></a><span id="l3.56" class="difflineplus">+        });</span>
<a href="#l3.57"></a><span id="l3.57" class="difflineplus">+      }</span>
<a href="#l3.58"></a><span id="l3.58" class="difflineplus">+      let r = key.getSigningValidity();</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineplus">+      if (!r.keyValid) {</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineplus">+        reasonMsg = r.reason;</span>
<a href="#l3.61"></a><span id="l3.61">       }</span>
<a href="#l3.62"></a><span id="l3.62">     } else {</span>
<a href="#l3.63"></a><span id="l3.63">       let keys = getEnigmailKeyRing().getKeysByUserId(keySpec);</span>
<a href="#l3.64"></a><span id="l3.64">       if (!keys || keys.length === 0) {</span>
<a href="#l3.65"></a><span id="l3.65" class="difflineminus">-        reasonMsg = EnigmailLocale.getString(</span>
<a href="#l3.66"></a><span id="l3.66" class="difflineminus">-          &quot;keyError.keySpecNotFound&quot;,</span>
<a href="#l3.67"></a><span id="l3.67" class="difflineminus">-          keySpec</span>
<a href="#l3.68"></a><span id="l3.68" class="difflineminus">-        );</span>
<a href="#l3.69"></a><span id="l3.69" class="difflineminus">-      } else {</span>
<a href="#l3.70"></a><span id="l3.70" class="difflineminus">-        for (let i in keys) {</span>
<a href="#l3.71"></a><span id="l3.71" class="difflineminus">-          let r = keys[i].getSigningValidity();</span>
<a href="#l3.72"></a><span id="l3.72" class="difflineminus">-          if (!r.keyValid) {</span>
<a href="#l3.73"></a><span id="l3.73" class="difflineminus">-            reasonMsg += r.reason + &quot;\n&quot;;</span>
<a href="#l3.74"></a><span id="l3.74" class="difflineminus">-          }</span>
<a href="#l3.75"></a><span id="l3.75" class="difflineplus">+        return l10n.formatValueSync(&quot;key-error-key-spec-not-found&quot;, {</span>
<a href="#l3.76"></a><span id="l3.76" class="difflineplus">+          keySpec,</span>
<a href="#l3.77"></a><span id="l3.77" class="difflineplus">+        });</span>
<a href="#l3.78"></a><span id="l3.78" class="difflineplus">+      }</span>
<a href="#l3.79"></a><span id="l3.79" class="difflineplus">+      for (let i in keys) {</span>
<a href="#l3.80"></a><span id="l3.80" class="difflineplus">+        let r = keys[i].getSigningValidity();</span>
<a href="#l3.81"></a><span id="l3.81" class="difflineplus">+        if (!r.keyValid) {</span>
<a href="#l3.82"></a><span id="l3.82" class="difflineplus">+          reasonMsg += r.reason + &quot;\n&quot;;</span>
<a href="#l3.83"></a><span id="l3.83">         }</span>
<a href="#l3.84"></a><span id="l3.84">       }</span>
<a href="#l3.85"></a><span id="l3.85">     }</span>
<a href="#l3.86"></a><span id="l3.86"> </span>
<a href="#l3.87"></a><span id="l3.87">     return reasonMsg;</span>
<a href="#l3.88"></a><span id="l3.88">   },</span>
<a href="#l3.89"></a><span id="l3.89"> </span>
<a href="#l3.90"></a><span id="l3.90">   /**</span>
<a href="#l3.91"></a><span id="l3.91" class="difflineat">@@ -87,36 +85,35 @@ var EnigmailErrorHandling = {</span>
<a href="#l3.92"></a><span id="l3.92">       &quot;errorHandling.jsm: determineInvRcptReason: keySpec: &quot; + keySpec + &quot;\n&quot;</span>
<a href="#l3.93"></a><span id="l3.93">     );</span>
<a href="#l3.94"></a><span id="l3.94"> </span>
<a href="#l3.95"></a><span id="l3.95">     let reasonMsg = &quot;&quot;;</span>
<a href="#l3.96"></a><span id="l3.96"> </span>
<a href="#l3.97"></a><span id="l3.97">     if (keySpec.search(/^(0x)?[0-9A-F]+$/) === 0) {</span>
<a href="#l3.98"></a><span id="l3.98">       let key = getEnigmailKeyRing().getKeyById(keySpec);</span>
<a href="#l3.99"></a><span id="l3.99">       if (!key) {</span>
<a href="#l3.100"></a><span id="l3.100" class="difflineminus">-        reasonMsg = EnigmailLocale.getString(&quot;keyError.keyIdNotFound&quot;, keySpec);</span>
<a href="#l3.101"></a><span id="l3.101" class="difflineminus">-      } else {</span>
<a href="#l3.102"></a><span id="l3.102" class="difflineminus">-        let r = key.getEncryptionValidity();</span>
<a href="#l3.103"></a><span id="l3.103" class="difflineminus">-        if (!r.keyValid) {</span>
<a href="#l3.104"></a><span id="l3.104" class="difflineminus">-          reasonMsg = r.reason;</span>
<a href="#l3.105"></a><span id="l3.105" class="difflineminus">-        }</span>
<a href="#l3.106"></a><span id="l3.106" class="difflineplus">+        return l10n.formatValueSync(&quot;key-error-key-id-not-found&quot;, {</span>
<a href="#l3.107"></a><span id="l3.107" class="difflineplus">+          keySpec,</span>
<a href="#l3.108"></a><span id="l3.108" class="difflineplus">+        });</span>
<a href="#l3.109"></a><span id="l3.109" class="difflineplus">+      }</span>
<a href="#l3.110"></a><span id="l3.110" class="difflineplus">+      let r = key.getEncryptionValidity();</span>
<a href="#l3.111"></a><span id="l3.111" class="difflineplus">+      if (!r.keyValid) {</span>
<a href="#l3.112"></a><span id="l3.112" class="difflineplus">+        reasonMsg = r.reason;</span>
<a href="#l3.113"></a><span id="l3.113">       }</span>
<a href="#l3.114"></a><span id="l3.114">     } else {</span>
<a href="#l3.115"></a><span id="l3.115">       let keys = getEnigmailKeyRing().getKeysByUserId(keySpec);</span>
<a href="#l3.116"></a><span id="l3.116">       if (!keys || keys.length === 0) {</span>
<a href="#l3.117"></a><span id="l3.117" class="difflineminus">-        reasonMsg = EnigmailLocale.getString(</span>
<a href="#l3.118"></a><span id="l3.118" class="difflineminus">-          &quot;keyError.keySpecNotFound&quot;,</span>
<a href="#l3.119"></a><span id="l3.119" class="difflineminus">-          keySpec</span>
<a href="#l3.120"></a><span id="l3.120" class="difflineminus">-        );</span>
<a href="#l3.121"></a><span id="l3.121" class="difflineminus">-      } else {</span>
<a href="#l3.122"></a><span id="l3.122" class="difflineminus">-        for (let i in keys) {</span>
<a href="#l3.123"></a><span id="l3.123" class="difflineminus">-          let r = keys[i].getEncryptionValidity();</span>
<a href="#l3.124"></a><span id="l3.124" class="difflineminus">-          if (!r.keyValid) {</span>
<a href="#l3.125"></a><span id="l3.125" class="difflineminus">-            reasonMsg += r.reason + &quot;\n&quot;;</span>
<a href="#l3.126"></a><span id="l3.126" class="difflineminus">-          }</span>
<a href="#l3.127"></a><span id="l3.127" class="difflineplus">+        return l10n.formatValueSync(&quot;key-error-key-spec-not-found&quot;, {</span>
<a href="#l3.128"></a><span id="l3.128" class="difflineplus">+          keySpec,</span>
<a href="#l3.129"></a><span id="l3.129" class="difflineplus">+        });</span>
<a href="#l3.130"></a><span id="l3.130" class="difflineplus">+      }</span>
<a href="#l3.131"></a><span id="l3.131" class="difflineplus">+      for (let i in keys) {</span>
<a href="#l3.132"></a><span id="l3.132" class="difflineplus">+        let r = keys[i].getEncryptionValidity();</span>
<a href="#l3.133"></a><span id="l3.133" class="difflineplus">+        if (!r.keyValid) {</span>
<a href="#l3.134"></a><span id="l3.134" class="difflineplus">+          reasonMsg += r.reason + &quot;\n&quot;;</span>
<a href="#l3.135"></a><span id="l3.135">         }</span>
<a href="#l3.136"></a><span id="l3.136">       }</span>
<a href="#l3.137"></a><span id="l3.137">     }</span>
<a href="#l3.138"></a><span id="l3.138"> </span>
<a href="#l3.139"></a><span id="l3.139">     return reasonMsg;</span>
<a href="#l3.140"></a><span id="l3.140">   },</span>
<a href="#l3.141"></a><span id="l3.141"> </span>
<a href="#l3.142"></a><span id="l3.142">   /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/keyLookupHelper.jsm</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/keyLookupHelper.jsm</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -25,16 +25,18 @@ var { EnigmailKeyserverURIs } = ChromeUt</span>
<a href="#l4.4"></a><span id="l4.4"> );</span>
<a href="#l4.5"></a><span id="l4.5"> var EnigmailLocale = ChromeUtils.import(</span>
<a href="#l4.6"></a><span id="l4.6">   &quot;chrome://openpgp/content/modules/locale.jsm&quot;</span>
<a href="#l4.7"></a><span id="l4.7"> ).EnigmailLocale;</span>
<a href="#l4.8"></a><span id="l4.8"> var EnigmailWkdLookup = ChromeUtils.import(</span>
<a href="#l4.9"></a><span id="l4.9">   &quot;chrome://openpgp/content/modules/wkdLookup.jsm&quot;</span>
<a href="#l4.10"></a><span id="l4.10"> ).EnigmailWkdLookup;</span>
<a href="#l4.11"></a><span id="l4.11"> </span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+const l10n = new Localization([&quot;messenger/openpgp/enigmail.ftl&quot;], true);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+</span>
<a href="#l4.14"></a><span id="l4.14"> var KeyLookupHelper = {</span>
<a href="#l4.15"></a><span id="l4.15">   async lookupAndImportOnKeyserver(</span>
<a href="#l4.16"></a><span id="l4.16">     window,</span>
<a href="#l4.17"></a><span id="l4.17">     identifier,</span>
<a href="#l4.18"></a><span id="l4.18">     giveFeedbackToUser,</span>
<a href="#l4.19"></a><span id="l4.19">     whenDoneCB</span>
<a href="#l4.20"></a><span id="l4.20">   ) {</span>
<a href="#l4.21"></a><span id="l4.21">     let defKs = EnigmailKeyserverURIs.getDefaultKeyServer();</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineat">@@ -112,12 +114,14 @@ var KeyLookupHelper = {</span>
<a href="#l4.23"></a><span id="l4.23">         window,</span>
<a href="#l4.24"></a><span id="l4.24">         email,</span>
<a href="#l4.25"></a><span id="l4.25">         giveFeedbackToUser,</span>
<a href="#l4.26"></a><span id="l4.26">         whenDoneCB</span>
<a href="#l4.27"></a><span id="l4.27">       );</span>
<a href="#l4.28"></a><span id="l4.28">     }</span>
<a href="#l4.29"></a><span id="l4.29"> </span>
<a href="#l4.30"></a><span id="l4.30">     if (!somethingWasImported) {</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineminus">-      EnigmailDialog.alert(window, EnigmailLocale.getString(&quot;noKeyFound&quot;));</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+      l10n.formatValue(&quot;no-key-found&quot;).then(value =&gt; {</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+        EnigmailDialog.alert(window, value);</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineplus">+      });</span>
<a href="#l4.35"></a><span id="l4.35">     }</span>
<a href="#l4.36"></a><span id="l4.36">   },</span>
<a href="#l4.37"></a><span id="l4.37"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/keyRing.jsm</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/keyRing.jsm</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -501,33 +501,33 @@ var EnigmailKeyRing = {</span>
<a href="#l5.4"></a><span id="l5.4">       throw new Error(</span>
<a href="#l5.5"></a><span id="l5.5">         &quot;keyRing.jsm: EnigmailKeyRing.extractKey: multiple IDs not yet implemented&quot;</span>
<a href="#l5.6"></a><span id="l5.6">       );</span>
<a href="#l5.7"></a><span id="l5.7">     }</span>
<a href="#l5.8"></a><span id="l5.8"> </span>
<a href="#l5.9"></a><span id="l5.9">     const cApi = EnigmailCryptoAPI();</span>
<a href="#l5.10"></a><span id="l5.10">     let keyBlock = cApi.sync(cApi.getPublicKey(idArray[0]));</span>
<a href="#l5.11"></a><span id="l5.11">     if (!keyBlock) {</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-      errorMsgObj.value = EnigmailLocale.getString(&quot;failKeyExtract&quot;);</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+      errorMsgObj.value = l10n.formatValueSync(&quot;fail-key-extract&quot;);</span>
<a href="#l5.14"></a><span id="l5.14">       return &quot;&quot;;</span>
<a href="#l5.15"></a><span id="l5.15">     }</span>
<a href="#l5.16"></a><span id="l5.16"> </span>
<a href="#l5.17"></a><span id="l5.17">     exitCodeObj.value = 0;</span>
<a href="#l5.18"></a><span id="l5.18">     if (outputFile) {</span>
<a href="#l5.19"></a><span id="l5.19">       if (</span>
<a href="#l5.20"></a><span id="l5.20">         !EnigmailFiles.writeFileContents(</span>
<a href="#l5.21"></a><span id="l5.21">           outputFile,</span>
<a href="#l5.22"></a><span id="l5.22">           keyBlock,</span>
<a href="#l5.23"></a><span id="l5.23">           DEFAULT_FILE_PERMS</span>
<a href="#l5.24"></a><span id="l5.24">         )</span>
<a href="#l5.25"></a><span id="l5.25">       ) {</span>
<a href="#l5.26"></a><span id="l5.26">         exitCodeObj.value = -1;</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineminus">-        errorMsgObj.value = EnigmailLocale.getString(&quot;fileWriteFailed&quot;, [</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineminus">-          outputFile,</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineminus">-        ]);</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineplus">+        errorMsgObj.value = l10n.formatValueSync(&quot;file-write-failed&quot;, {</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineplus">+          output: outputFile,</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+        });</span>
<a href="#l5.33"></a><span id="l5.33">       }</span>
<a href="#l5.34"></a><span id="l5.34">       return &quot;&quot;;</span>
<a href="#l5.35"></a><span id="l5.35">     }</span>
<a href="#l5.36"></a><span id="l5.36">     return keyBlock;</span>
<a href="#l5.37"></a><span id="l5.37">   },</span>
<a href="#l5.38"></a><span id="l5.38"> </span>
<a href="#l5.39"></a><span id="l5.39">   /**</span>
<a href="#l5.40"></a><span id="l5.40">    * import key from provided key data (synchronous)</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineat">@@ -618,35 +618,35 @@ var EnigmailKeyRing = {</span>
<a href="#l5.42"></a><span id="l5.42">         {}</span>
<a href="#l5.43"></a><span id="l5.43">       );</span>
<a href="#l5.44"></a><span id="l5.44">       if (!blockType) {</span>
<a href="#l5.45"></a><span id="l5.45">         errorMsgObj.value = EnigmailLocale.getString(&quot;noPGPblock&quot;);</span>
<a href="#l5.46"></a><span id="l5.46">         return 1;</span>
<a href="#l5.47"></a><span id="l5.47">       }</span>
<a href="#l5.48"></a><span id="l5.48"> </span>
<a href="#l5.49"></a><span id="l5.49">       if (blockType.search(/^(PUBLIC|PRIVATE) KEY BLOCK$/) !== 0) {</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineminus">-        errorMsgObj.value = EnigmailLocale.getString(&quot;notFirstBlock&quot;);</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineplus">+        errorMsgObj.value = l10n.formatValueSync(&quot;not-first-block&quot;);</span>
<a href="#l5.52"></a><span id="l5.52">         return 1;</span>
<a href="#l5.53"></a><span id="l5.53">       }</span>
<a href="#l5.54"></a><span id="l5.54"> </span>
<a href="#l5.55"></a><span id="l5.55">       pgpBlock = keyBlock.substr(</span>
<a href="#l5.56"></a><span id="l5.56">         beginIndexObj.value,</span>
<a href="#l5.57"></a><span id="l5.57">         endIndexObj.value - beginIndexObj.value + 1</span>
<a href="#l5.58"></a><span id="l5.58">       );</span>
<a href="#l5.59"></a><span id="l5.59">     }</span>
<a href="#l5.60"></a><span id="l5.60"> </span>
<a href="#l5.61"></a><span id="l5.61">     if (isInteractive) {</span>
<a href="#l5.62"></a><span id="l5.62">       if (</span>
<a href="#l5.63"></a><span id="l5.63">         !getDialog().confirmDlg(</span>
<a href="#l5.64"></a><span id="l5.64">           parent,</span>
<a href="#l5.65"></a><span id="l5.65" class="difflineminus">-          EnigmailLocale.getString(&quot;importKeyConfirm&quot;),</span>
<a href="#l5.66"></a><span id="l5.66" class="difflineplus">+          l10n.formatValueSync(&quot;import-key-confirm&quot;),</span>
<a href="#l5.67"></a><span id="l5.67">           l10n.formatValueSync(&quot;key-man-button-import&quot;)</span>
<a href="#l5.68"></a><span id="l5.68">         )</span>
<a href="#l5.69"></a><span id="l5.69">       ) {</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineminus">-        errorMsgObj.value = EnigmailLocale.getString(&quot;failCancel&quot;);</span>
<a href="#l5.71"></a><span id="l5.71" class="difflineplus">+        errorMsgObj.value = l10n.formatValueSync(&quot;fail-cancel&quot;);</span>
<a href="#l5.72"></a><span id="l5.72">         return -1;</span>
<a href="#l5.73"></a><span id="l5.73">       }</span>
<a href="#l5.74"></a><span id="l5.74">     }</span>
<a href="#l5.75"></a><span id="l5.75"> </span>
<a href="#l5.76"></a><span id="l5.76">     if (limitedUids.length &gt; 0) {</span>
<a href="#l5.77"></a><span id="l5.77">       throw new Error(</span>
<a href="#l5.78"></a><span id="l5.78">         &quot;importKeyAsync with limitedUids: not implemented &quot; + limitedUids</span>
<a href="#l5.79"></a><span id="l5.79">       );</span>
<a href="#l5.80"></a><span id="l5.80" class="difflineat">@@ -734,24 +734,25 @@ var EnigmailKeyRing = {</span>
<a href="#l5.81"></a><span id="l5.81">           console.debug(ex);</span>
<a href="#l5.82"></a><span id="l5.82">         }</span>
<a href="#l5.83"></a><span id="l5.83"> </span>
<a href="#l5.84"></a><span id="l5.84">         if (exitStatus === 0) {</span>
<a href="#l5.85"></a><span id="l5.85">           let keyList = preview.map(a =&gt; a.id);</span>
<a href="#l5.86"></a><span id="l5.86">           getDialog().keyImportDlg(window, keyList);</span>
<a href="#l5.87"></a><span id="l5.87">           somethingWasImported = true;</span>
<a href="#l5.88"></a><span id="l5.88">         } else {</span>
<a href="#l5.89"></a><span id="l5.89" class="difflineminus">-          getDialog().alert(</span>
<a href="#l5.90"></a><span id="l5.90" class="difflineminus">-            window,</span>
<a href="#l5.91"></a><span id="l5.91" class="difflineminus">-            EnigmailLocale.getString(&quot;failKeyImport&quot;) + &quot;\n&quot; + errorMsgObj.value</span>
<a href="#l5.92"></a><span id="l5.92" class="difflineminus">-          );</span>
<a href="#l5.93"></a><span id="l5.93" class="difflineplus">+          l10n.formatValue(&quot;fail-key-import&quot;).then(value =&gt; {</span>
<a href="#l5.94"></a><span id="l5.94" class="difflineplus">+            getDialog().alert(window, value + &quot;\n&quot; + errorMsgObj.value);</span>
<a href="#l5.95"></a><span id="l5.95" class="difflineplus">+          });</span>
<a href="#l5.96"></a><span id="l5.96">         }</span>
<a href="#l5.97"></a><span id="l5.97">       }</span>
<a href="#l5.98"></a><span id="l5.98">     } else {</span>
<a href="#l5.99"></a><span id="l5.99" class="difflineminus">-      getDialog().alert(window, EnigmailLocale.getString(&quot;noKeyFound&quot;));</span>
<a href="#l5.100"></a><span id="l5.100" class="difflineplus">+      l10n.formatValue(&quot;no-key-found&quot;).then(value =&gt; {</span>
<a href="#l5.101"></a><span id="l5.101" class="difflineplus">+        getDialog().alert(window, value);</span>
<a href="#l5.102"></a><span id="l5.102" class="difflineplus">+      });</span>
<a href="#l5.103"></a><span id="l5.103">     }</span>
<a href="#l5.104"></a><span id="l5.104">     return somethingWasImported;</span>
<a href="#l5.105"></a><span id="l5.105">   },</span>
<a href="#l5.106"></a><span id="l5.106"> </span>
<a href="#l5.107"></a><span id="l5.107">   /**</span>
<a href="#l5.108"></a><span id="l5.108">    * Generate a new key pair with GnuPG</span>
<a href="#l5.109"></a><span id="l5.109">    *</span>
<a href="#l5.110"></a><span id="l5.110">    * @name:       String     - name part of UID</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/trust.jsm</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/trust.jsm</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -3,19 +3,17 @@</span>
<a href="#l6.4"></a><span id="l6.4">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.5"></a><span id="l6.5">  * file, You can obtain one at https://mozilla.org/MPL/2.0/.</span>
<a href="#l6.6"></a><span id="l6.6">  */</span>
<a href="#l6.7"></a><span id="l6.7"> </span>
<a href="#l6.8"></a><span id="l6.8"> &quot;use strict&quot;;</span>
<a href="#l6.9"></a><span id="l6.9"> </span>
<a href="#l6.10"></a><span id="l6.10"> var EXPORTED_SYMBOLS = [&quot;EnigmailTrust&quot;];</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-const { EnigmailLocale } = ChromeUtils.import(</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-  &quot;chrome://openpgp/content/modules/locale.jsm&quot;</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineminus">-);</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+const l10n = new Localization([&quot;messenger/openpgp/enigmail.ftl&quot;], true);</span>
<a href="#l6.16"></a><span id="l6.16"> </span>
<a href="#l6.17"></a><span id="l6.17"> // trust flags according to GPG documentation:</span>
<a href="#l6.18"></a><span id="l6.18"> // - https://www.gnupg.org/documentation/manuals/gnupg.pdf</span>
<a href="#l6.19"></a><span id="l6.19"> // - sources: doc/DETAILS</span>
<a href="#l6.20"></a><span id="l6.20"> // In the order of trustworthy:</span>
<a href="#l6.21"></a><span id="l6.21"> //  ---------------------------------------------------------</span>
<a href="#l6.22"></a><span id="l6.22"> //  i = The key is invalid (e.g. due to a missing self-signature)</span>
<a href="#l6.23"></a><span id="l6.23"> //  n = The key is not valid / Never trust this key</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineat">@@ -69,46 +67,36 @@ var EnigmailTrust = {</span>
<a href="#l6.25"></a><span id="l6.25"> </span>
<a href="#l6.26"></a><span id="l6.26">     return keyObj.keyTrust;</span>
<a href="#l6.27"></a><span id="l6.27">   },</span>
<a href="#l6.28"></a><span id="l6.28"> </span>
<a href="#l6.29"></a><span id="l6.29">   getTrustLabel(trustCode) {</span>
<a href="#l6.30"></a><span id="l6.30">     let keyTrust;</span>
<a href="#l6.31"></a><span id="l6.31">     switch (trustCode) {</span>
<a href="#l6.32"></a><span id="l6.32">       case &quot;q&quot;:</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineminus">-        keyTrust = EnigmailLocale.getString(&quot;keyValid.unknown&quot;);</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineminus">-        break;</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineplus">+        return l10n.formatValueSync(&quot;key-valid-unknown&quot;);</span>
<a href="#l6.36"></a><span id="l6.36">       case &quot;i&quot;:</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineminus">-        keyTrust = EnigmailLocale.getString(&quot;keyValid.invalid&quot;);</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineminus">-        break;</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineplus">+        return l10n.formatValueSync(&quot;key-valid-invalid&quot;);</span>
<a href="#l6.40"></a><span id="l6.40">       case &quot;d&quot;:</span>
<a href="#l6.41"></a><span id="l6.41">       case &quot;D&quot;:</span>
<a href="#l6.42"></a><span id="l6.42" class="difflineminus">-        keyTrust = EnigmailLocale.getString(&quot;keyValid.disabled&quot;);</span>
<a href="#l6.43"></a><span id="l6.43" class="difflineminus">-        break;</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineplus">+        return l10n.formatValueSync(&quot;key-valid-disabled&quot;);</span>
<a href="#l6.45"></a><span id="l6.45">       case &quot;r&quot;:</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineminus">-        keyTrust = EnigmailLocale.getString(&quot;keyValid.revoked&quot;);</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineminus">-        break;</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineplus">+        return l10n.formatValueSync(&quot;key-valid-revoked&quot;);</span>
<a href="#l6.49"></a><span id="l6.49">       case &quot;e&quot;:</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineminus">-        keyTrust = EnigmailLocale.getString(&quot;keyValid.expired&quot;);</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineminus">-        break;</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineplus">+        return l10n.formatValueSync(&quot;key-valid-expired&quot;);</span>
<a href="#l6.53"></a><span id="l6.53">       case &quot;n&quot;:</span>
<a href="#l6.54"></a><span id="l6.54" class="difflineminus">-        keyTrust = EnigmailLocale.getString(&quot;keyTrust.untrusted&quot;);</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineminus">-        break;</span>
<a href="#l6.56"></a><span id="l6.56" class="difflineplus">+        return l10n.formatValueSync(&quot;key-trust-untrusted&quot;);</span>
<a href="#l6.57"></a><span id="l6.57">       case &quot;m&quot;:</span>
<a href="#l6.58"></a><span id="l6.58" class="difflineminus">-        keyTrust = EnigmailLocale.getString(&quot;keyTrust.marginal&quot;);</span>
<a href="#l6.59"></a><span id="l6.59" class="difflineminus">-        break;</span>
<a href="#l6.60"></a><span id="l6.60" class="difflineplus">+        return l10n.formatValueSync(&quot;key-trust-marginal&quot;);</span>
<a href="#l6.61"></a><span id="l6.61">       case &quot;f&quot;:</span>
<a href="#l6.62"></a><span id="l6.62" class="difflineminus">-        keyTrust = EnigmailLocale.getString(&quot;keyTrust.full&quot;);</span>
<a href="#l6.63"></a><span id="l6.63" class="difflineminus">-        break;</span>
<a href="#l6.64"></a><span id="l6.64" class="difflineplus">+        return l10n.formatValueSync(&quot;key-trust-full&quot;);</span>
<a href="#l6.65"></a><span id="l6.65">       case &quot;u&quot;:</span>
<a href="#l6.66"></a><span id="l6.66" class="difflineminus">-        keyTrust = EnigmailLocale.getString(&quot;keyTrust.ultimate&quot;);</span>
<a href="#l6.67"></a><span id="l6.67" class="difflineminus">-        break;</span>
<a href="#l6.68"></a><span id="l6.68" class="difflineplus">+        return l10n.formatValueSync(&quot;key-trust-ultimate&quot;);</span>
<a href="#l6.69"></a><span id="l6.69">       case &quot;g&quot;:</span>
<a href="#l6.70"></a><span id="l6.70" class="difflineminus">-        keyTrust = EnigmailLocale.getString(&quot;keyTrust.group&quot;);</span>
<a href="#l6.71"></a><span id="l6.71" class="difflineminus">-        break;</span>
<a href="#l6.72"></a><span id="l6.72" class="difflineplus">+        return l10n.formatValueSync(&quot;key-trust-group&quot;);</span>
<a href="#l6.73"></a><span id="l6.73">       case &quot;-&quot;:</span>
<a href="#l6.74"></a><span id="l6.74">         keyTrust = &quot;-&quot;;</span>
<a href="#l6.75"></a><span id="l6.75">         break;</span>
<a href="#l6.76"></a><span id="l6.76">       default:</span>
<a href="#l6.77"></a><span id="l6.77">         keyTrust = &quot;&quot;;</span>
<a href="#l6.78"></a><span id="l6.78">     }</span>
<a href="#l6.79"></a><span id="l6.79">     return keyTrust;</span>
<a href="#l6.80"></a><span id="l6.80">   },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/extensions/openpgp/content/modules/windows.jsm</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/modules/windows.jsm</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -21,16 +21,18 @@ const { EnigmailLocale } = ChromeUtils.i</span>
<a href="#l7.4"></a><span id="l7.4"> );</span>
<a href="#l7.5"></a><span id="l7.5"> const { EnigmailKeyRing } = ChromeUtils.import(</span>
<a href="#l7.6"></a><span id="l7.6">   &quot;chrome://openpgp/content/modules/keyRing.jsm&quot;</span>
<a href="#l7.7"></a><span id="l7.7"> );</span>
<a href="#l7.8"></a><span id="l7.8"> const { EnigmailStdlib } = ChromeUtils.import(</span>
<a href="#l7.9"></a><span id="l7.9">   &quot;chrome://openpgp/content/modules/stdlib.jsm&quot;</span>
<a href="#l7.10"></a><span id="l7.10"> );</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+const l10n = new Localization([&quot;messenger/openpgp/enigmail.ftl&quot;], true);</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+</span>
<a href="#l7.14"></a><span id="l7.14"> var EnigmailWindows = {</span>
<a href="#l7.15"></a><span id="l7.15">   /**</span>
<a href="#l7.16"></a><span id="l7.16">    * Open a window, or focus it if it is already open</span>
<a href="#l7.17"></a><span id="l7.17">    *</span>
<a href="#l7.18"></a><span id="l7.18">    * @winName   : String - name of the window; used to identify if it is already open</span>
<a href="#l7.19"></a><span id="l7.19">    * @spec      : String - window URL (e.g. chrome://openpgp/content/ui/test.xhtml)</span>
<a href="#l7.20"></a><span id="l7.20">    * @winOptions: String - window options as defined in nsIWindow.open</span>
<a href="#l7.21"></a><span id="l7.21">    * @optObj    : any    - an Object, Array, String, etc. that is passed as parameter</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineat">@@ -461,17 +463,19 @@ var EnigmailWindows = {</span>
<a href="#l7.23"></a><span id="l7.23">     EnigmailLog.DEBUG(</span>
<a href="#l7.24"></a><span id="l7.24">       &quot;windows.jsm: downloadKeys: searchList=&quot; + inputObj.searchList + &quot;\n&quot;</span>
<a href="#l7.25"></a><span id="l7.25">     );</span>
<a href="#l7.26"></a><span id="l7.26"> </span>
<a href="#l7.27"></a><span id="l7.27">     resultObj.importedKeys = 0;</span>
<a href="#l7.28"></a><span id="l7.28"> </span>
<a href="#l7.29"></a><span id="l7.29">     const ioService = Services.io;</span>
<a href="#l7.30"></a><span id="l7.30">     if (ioService &amp;&amp; ioService.offline) {</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineminus">-      EnigmailWindows.alert(win, EnigmailLocale.getString(&quot;needOnline&quot;));</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+      l10n.formatValue(&quot;need-online&quot;).then(value =&gt; {</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineplus">+        EnigmailWindows.alert(win, value);</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineplus">+      });</span>
<a href="#l7.35"></a><span id="l7.35">       return;</span>
<a href="#l7.36"></a><span id="l7.36">     }</span>
<a href="#l7.37"></a><span id="l7.37"> </span>
<a href="#l7.38"></a><span id="l7.38">     let valueObj = {};</span>
<a href="#l7.39"></a><span id="l7.39">     if (inputObj.searchList) {</span>
<a href="#l7.40"></a><span id="l7.40">       valueObj = {</span>
<a href="#l7.41"></a><span id="l7.41">         keyId: &quot;&lt;&quot; + inputObj.searchList.join(&quot;&gt; &lt;&quot;) + &quot;&gt;&quot;,</span>
<a href="#l7.42"></a><span id="l7.42">       };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/extensions/openpgp/content/strings/enigmail.ftl</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/strings/enigmail.ftl</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -271,16 +271,27 @@ copy-to-clipbrd-ok = Key(s) copied to cl</span>
<a href="#l8.4"></a><span id="l8.4"> delete-secret-key = WARNING: You are about to delete a secret key!\nIf you delete your secret key, you will no longer be able to decrypt any messages encrypted for that key, nor will you be able to revoke it.\n\nDo you really want to delete BOTH, the secret key and the public key\n'{ $userId }'?</span>
<a href="#l8.5"></a><span id="l8.5"> delete-mix = WARNING: You are about to delete secret keys!\nIf you delete your secret key, you will no longer be able to decrypt any messages encrypted for that key.\n\nDo you really want to delete BOTH, the selected secret and public keys?</span>
<a href="#l8.6"></a><span id="l8.6"> delete-pub-key = Do you want to delete the public key\n'{ $userId }'?</span>
<a href="#l8.7"></a><span id="l8.7"> delete-selected-pub-key = Do you want to delete the public keys?</span>
<a href="#l8.8"></a><span id="l8.8"> refresh-all-question = You did not select any key. Would you like to refresh ALL keys?</span>
<a href="#l8.9"></a><span id="l8.9"> key-man-button-export-sec-key = Export &amp;Secret Keys</span>
<a href="#l8.10"></a><span id="l8.10"> key-man-button-export-pub-key = Export &amp;Public Keys Only</span>
<a href="#l8.11"></a><span id="l8.11"> key-man-button-refresh-all = &amp;Refresh All Keys</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+key-man-loading-keys = Loading keys, please wait</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+ascii-armor-file = ASCII Armored Files (*.asc)</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineplus">+no-key-selected = You should select at least one key in order to perform the selected operation</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineplus">+export-to-file = Export Public Key To File</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineplus">+export-keypair-to-file = Export Secret and Public Key To File</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineplus">+export-secret-key = Do you want to include the secret key in the saved OpenPGP key file?</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineplus">+save-keys-ok = The keys were successfully saved</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineplus">+save-keys-failed = Saving the keys failed</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineplus">+default-pub-key-filename = Exported-public-keys</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineplus">+default-pub-sec-key-filename = Exported-public-and-secret-keys</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineplus">+refresh-key-warn = Warning: depending on the number of keys and the connection speed, refreshing all keys could be quite a lengthy process!</span>
<a href="#l8.23"></a><span id="l8.23"> </span>
<a href="#l8.24"></a><span id="l8.24"> # Strings in keyObj.jsm</span>
<a href="#l8.25"></a><span id="l8.25"> key-ring-pub-key-revoked = The key { $userId } (key ID { $keyId }) is revoked.</span>
<a href="#l8.26"></a><span id="l8.26"> key-ring-pub-key-expired = The key { $userId } (key ID { $keyId }) has expired.</span>
<a href="#l8.27"></a><span id="l8.27"> key-ring-key-disabled = The key { $userId } (key ID { $keyId }) is disabled; it cannot be used.</span>
<a href="#l8.28"></a><span id="l8.28"> key-ring-key-invalid = The key { $userId } (key ID { $keyId }) is not valid. Please consider verifying it correctly.</span>
<a href="#l8.29"></a><span id="l8.29"> key-ring-key-not-trusted=The key { $userId } (key ID { $keyId }) is not trusted enough. Please set the trust level of your key to &quot;ultimate&quot; to use it for signing.</span>
<a href="#l8.30"></a><span id="l8.30"> key-ring-no-secret-key = You do not seem to have the secret key for { $userId } (key ID { $keyId }) on your keyring; you cannot use the key for signing.</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineat">@@ -290,17 +301,60 @@ key-ring-sign-sub-keys-revoked = All sig</span>
<a href="#l8.32"></a><span id="l8.32"> key-ring-sign-sub-keys-expired = All signing-subkeys of key { $userId } (key ID { $keyId }) have expired.</span>
<a href="#l8.33"></a><span id="l8.33"> key-ring-sign-sub-keys-unusable = All signing-subkeys of key { $userId } (key ID { $keyId }) are revoked, expired or otherwise unusable.</span>
<a href="#l8.34"></a><span id="l8.34"> key-ring-enc-sub-keys-revoked = All encryption subkeys of key { $userId } (key ID { $keyId }) are revoked.</span>
<a href="#l8.35"></a><span id="l8.35"> key-ring-enc-sub-keys-expired = All encryption subkeys of key { $userId } (key ID { $keyId }) have expired.</span>
<a href="#l8.36"></a><span id="l8.36"> key-ring-enc-sub-keys-unusable = All encryption subkeys of key { $userId } (key ID { $keyId }) are revoked, expired or otherwise unusable.</span>
<a href="#l8.37"></a><span id="l8.37"> </span>
<a href="#l8.38"></a><span id="l8.38"> # Strings in gnupg-keylist.jsm</span>
<a href="#l8.39"></a><span id="l8.39"> keyring-photo = Photo</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineplus">+user-att-photo = User attribute (JPEG image)</span>
<a href="#l8.41"></a><span id="l8.41"> </span>
<a href="#l8.42"></a><span id="l8.42"> # Strings in key.jsm</span>
<a href="#l8.43"></a><span id="l8.43"> revoke-key-question = You are about to revoke the key '{ $userId }'.\n\nYou will no longer be able to sign with this key, and once distributed, others will no longer be able to encrypt with that key. You can still use the key to decrypt old messages.\n\nDo you want to proceed?</span>
<a href="#l8.44"></a><span id="l8.44"> revoke-key-not-present = You have no key (0x{ $keyId }) which matches this revocation certificate!\n\nIf you have lost your key, you must import it (e.g. from a keyserver) before importing the revocation certificate!</span>
<a href="#l8.45"></a><span id="l8.45"> revoke-key-already-revoked = The key 0x{ $keyId } has already been revoked.</span>
<a href="#l8.46"></a><span id="l8.46"> key-man-button-revoke-key = &amp;Revoke Key</span>
<a href="#l8.47"></a><span id="l8.47"> </span>
<a href="#l8.48"></a><span id="l8.48"> # Strings in keyRing.jsm &amp; decryption.jsm</span>
<a href="#l8.49"></a><span id="l8.49"> key-man-button-import = &amp;Import</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineplus">+</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineplus">+# Strings used in errorHandling.jsm</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineplus">+key-error-key-spec-not-found = The email address '{ $keySpec }' cannot be matched to a key on your keyring.</span>
<a href="#l8.53"></a><span id="l8.53" class="difflineplus">+key-error-key-id-not-found = The configured key ID '{ $keySpec }' cannot be found on your keyring.</span>
<a href="#l8.54"></a><span id="l8.54" class="difflineplus">+</span>
<a href="#l8.55"></a><span id="l8.55" class="difflineplus">+# Strings used in enigmailKeyManager.js &amp; windows.jsm</span>
<a href="#l8.56"></a><span id="l8.56" class="difflineplus">+need-online = The function you have selected is not available in offline mode. Please go online and try again.</span>
<a href="#l8.57"></a><span id="l8.57" class="difflineplus">+</span>
<a href="#l8.58"></a><span id="l8.58" class="difflineplus">+# Strings used in keyRing.jsm &amp; keyLookupHelper.jsm</span>
<a href="#l8.59"></a><span id="l8.59" class="difflineplus">+no-key-found = We could not find any key matching the specified search criteria.</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineplus">+</span>
<a href="#l8.61"></a><span id="l8.61" class="difflineplus">+# Strings used in keyRing.jsm &amp; GnuPGCryptoAPI.jsm</span>
<a href="#l8.62"></a><span id="l8.62" class="difflineplus">+fail-key-extract = Error - key extraction command failed</span>
<a href="#l8.63"></a><span id="l8.63" class="difflineplus">+</span>
<a href="#l8.64"></a><span id="l8.64" class="difflineplus">+# Strings used in keyRing.jsm</span>
<a href="#l8.65"></a><span id="l8.65" class="difflineplus">+fail-cancel = Error - Key receive cancelled by user</span>
<a href="#l8.66"></a><span id="l8.66" class="difflineplus">+not-first-block = Error - First OpenPGP block not public key block</span>
<a href="#l8.67"></a><span id="l8.67" class="difflineplus">+import-key-confirm = Import public key(s) embedded in message?</span>
<a href="#l8.68"></a><span id="l8.68" class="difflineplus">+fail-key-import = Error - key importing failed</span>
<a href="#l8.69"></a><span id="l8.69" class="difflineplus">+file-write-failed = Failed to write to file { $output }</span>
<a href="#l8.70"></a><span id="l8.70" class="difflineplus">+</span>
<a href="#l8.71"></a><span id="l8.71" class="difflineplus">+# Strings used in trust.jsm</span>
<a href="#l8.72"></a><span id="l8.72" class="difflineplus">+key-valid-unknown = unknown</span>
<a href="#l8.73"></a><span id="l8.73" class="difflineplus">+key-valid-invalid = invalid</span>
<a href="#l8.74"></a><span id="l8.74" class="difflineplus">+key-valid-disabled = disabled</span>
<a href="#l8.75"></a><span id="l8.75" class="difflineplus">+key-valid-revoked = revoked</span>
<a href="#l8.76"></a><span id="l8.76" class="difflineplus">+key-valid-expired = expired</span>
<a href="#l8.77"></a><span id="l8.77" class="difflineplus">+key-trust-untrusted = untrusted</span>
<a href="#l8.78"></a><span id="l8.78" class="difflineplus">+key-trust-marginal = marginal</span>
<a href="#l8.79"></a><span id="l8.79" class="difflineplus">+key-trust-full = trusted</span>
<a href="#l8.80"></a><span id="l8.80" class="difflineplus">+key-trust-ultimate = ultimate</span>
<a href="#l8.81"></a><span id="l8.81" class="difflineplus">+key-trust-group = (group)</span>
<a href="#l8.82"></a><span id="l8.82" class="difflineplus">+</span>
<a href="#l8.83"></a><span id="l8.83" class="difflineplus">+# Strings used in commonWorkflows.js</span>
<a href="#l8.84"></a><span id="l8.84" class="difflineplus">+import-key-file = Import OpenPGP Key File</span>
<a href="#l8.85"></a><span id="l8.85" class="difflineplus">+gnupg-file = GnuPG Files</span>
<a href="#l8.86"></a><span id="l8.86" class="difflineplus">+import-keys-failed=Importing the keys failed</span>
<a href="#l8.87"></a><span id="l8.87" class="difflineplus">+</span>
<a href="#l8.88"></a><span id="l8.88" class="difflineplus">+# Strings used in enigmailKeygen.js</span>
<a href="#l8.89"></a><span id="l8.89" class="difflineplus">+save-revoke-cert-as = Create &amp; Save Revocation Certificate</span>
<a href="#l8.90"></a><span id="l8.90" class="difflineplus">+revoke-cert-ok = The revocation certificate has been successfully created. You can use it to invalidate your public key, e.g. in case you would lose your secret key.</span>
<a href="#l8.91"></a><span id="l8.91" class="difflineplus">+revoke-cert-failed = The revocation certificate could not be created.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mail/extensions/openpgp/content/strings/enigmail.properties</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/strings/enigmail.properties</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -288,34 +288,26 @@ previewFailed=Can't read public key file</span>
<a href="#l9.4"></a><span id="l9.4"> passphrasePrompt=Please enter the passphrase that unlocks the following key: %S</span>
<a href="#l9.5"></a><span id="l9.5"> </span>
<a href="#l9.6"></a><span id="l9.6"> # Strings used in errorHandling.jsm</span>
<a href="#l9.7"></a><span id="l9.7"> ### sc.wrongCardAvailable=The SmartCard %1$S found in your reader cannot be used to process the message.\nPlease insert your SmartCard %2$S and repeat the operation.</span>
<a href="#l9.8"></a><span id="l9.8"> ### sc.insertCard=The operation requires your SmartCard %S.\nPlease insert the required SmartCard and repeat the operation.</span>
<a href="#l9.9"></a><span id="l9.9"> ### sc.removeCard=The operation requires no SmartCard to be in the reader.\nPlease remove your SmartCard and repeat the operation.</span>
<a href="#l9.10"></a><span id="l9.10"> ### sc.noCardAvailable=No SmartCard could be found in your reader\nPlease insert your SmartCard and repeat the operation.</span>
<a href="#l9.11"></a><span id="l9.11"> ### sc.noReaderAvailable=Your SmartCard reader could not be accessed\nPlease attach your SmartCard reader, insert your card, and repeat the operation.</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-keyError.keySpecNotFound=The email address '%S' cannot be matched to a key on your keyring.</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-keyError.keyIdNotFound=The configured key ID '%S' cannot be found on your keyring.</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineminus">-keyError.resolutionAction=Please select a valid key in the OpenPGP section of your Account Settings.</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+### keyError.resolutionAction=Please select a valid key in the OpenPGP section of your Account Settings.</span>
<a href="#l9.16"></a><span id="l9.16"> ### missingPassphrase=Missing passphrase</span>
<a href="#l9.17"></a><span id="l9.17"> ### errorHandling.gpgAgentInvalid=Your system is running a version of gpg-agent that is not suitable for your GnuPG version.</span>
<a href="#l9.18"></a><span id="l9.18"> ### errorHandling.gpgAgentError=GnuPG reported an error in the communication with gpg-agent (a component of GnuPG).</span>
<a href="#l9.19"></a><span id="l9.19"> ### errorHandling.pinentryError=GnuPG cannot query your passphrase via pinentry.</span>
<a href="#l9.20"></a><span id="l9.20"> </span>
<a href="#l9.21"></a><span id="l9.21"> ### prefGood=Good signature from %S</span>
<a href="#l9.22"></a><span id="l9.22"> ### prefBad=BAD signature from %S</span>
<a href="#l9.23"></a><span id="l9.23"> </span>
<a href="#l9.24"></a><span id="l9.24" class="difflineminus">-failCancel=Error - Key receive cancelled by user</span>
<a href="#l9.25"></a><span id="l9.25" class="difflineminus">-failKeyExtract=Error - key extraction command failed</span>
<a href="#l9.26"></a><span id="l9.26"> ### failKeyNoSubkey=No valid (sub-)key</span>
<a href="#l9.27"></a><span id="l9.27" class="difflineminus">-notFirstBlock=Error - First OpenPGP block not public key block</span>
<a href="#l9.28"></a><span id="l9.28" class="difflineminus">-importKeyConfirm=Import public key(s) embedded in message?</span>
<a href="#l9.29"></a><span id="l9.29" class="difflineminus">-failKeyImport=Error - key importing failed</span>
<a href="#l9.30"></a><span id="l9.30" class="difflineminus">-fileWriteFailed=Failed to write to file %S</span>
<a href="#l9.31"></a><span id="l9.31"> </span>
<a href="#l9.32"></a><span id="l9.32"> ### importKey=Import public key %S from keyserver:</span>
<a href="#l9.33"></a><span id="l9.33"> ### uploadKey=Send public key %S to keyserver:</span>
<a href="#l9.34"></a><span id="l9.34"> ### keyId=Key ID</span>
<a href="#l9.35"></a><span id="l9.35"> ### keyAndSigDate=Key ID: 0x%1$S / Signed on: %2$S</span>
<a href="#l9.36"></a><span id="l9.36"> ### keyFpr=Key fingerprint: %S</span>
<a href="#l9.37"></a><span id="l9.37"> ### noEmailProvided=You did not provide an email address!</span>
<a href="#l9.38"></a><span id="l9.38"> ### keyAlreadySigned=The key is already signed, you cannot sign it twice.</span>
<a href="#l9.39"></a><span id="l9.39" class="difflineat">@@ -337,83 +329,49 @@ fileWriteFailed=Failed to write to file </span>
<a href="#l9.40"></a><span id="l9.40"> ### always=Always</span>
<a href="#l9.41"></a><span id="l9.41"> ### possible=Possible</span>
<a href="#l9.42"></a><span id="l9.42"> ### deleteRule=Really delete the selected rule?</span>
<a href="#l9.43"></a><span id="l9.43"> ### nextRcpt=(Next recipient)</span>
<a href="#l9.44"></a><span id="l9.44"> ### negateRule=Not</span>
<a href="#l9.45"></a><span id="l9.45"> ### addKeyToRule=Add key %1$S (%2$S) to per-recipient rule</span>
<a href="#l9.46"></a><span id="l9.46"> </span>
<a href="#l9.47"></a><span id="l9.47"> # Strings used in enigmailSearchKey.js</span>
<a href="#l9.48"></a><span id="l9.48" class="difflineminus">-needOnline=The function you have selected is not available in offline mode. Please go online and try again.</span>
<a href="#l9.49"></a><span id="l9.49"> ### noKeyserverConn=Could not connect to keyserver at %S.</span>
<a href="#l9.50"></a><span id="l9.50"> ### internalError=An internal error occurred. The keys could not be downloaded or imported.</span>
<a href="#l9.51"></a><span id="l9.51" class="difflineminus">-noKeyFound=We could not find any key matching the specified search criteria.</span>
<a href="#l9.52"></a><span id="l9.52"> ### keyDownload.keyUnavailable=The key with ID %S is not available on the keyserver. Most likely, the owner of the key did not upload their key to the keyserver.\n\nPlease ask the sender of the message to send you their public key by email.</span>
<a href="#l9.53"></a><span id="l9.53"> </span>
<a href="#l9.54"></a><span id="l9.54"> # Strings in enigmailEditKeyTrustDlg.xhtml</span>
<a href="#l9.55"></a><span id="l9.55"> ### setKeyTrustFailed=Setting owner trust failed</span>
<a href="#l9.56"></a><span id="l9.56"> </span>
<a href="#l9.57"></a><span id="l9.57" class="difflineminus">-</span>
<a href="#l9.58"></a><span id="l9.58"> # Strings in enigmailSignKeyDlg.js</span>
<a href="#l9.59"></a><span id="l9.59"> ### signKeyFailed=Key signing failed</span>
<a href="#l9.60"></a><span id="l9.60"> ### alreadySigned.label=Note: the key %S is already signed with the selected secret key.</span>
<a href="#l9.61"></a><span id="l9.61"> ### alreadySignedexportable.label=Note: the key %S is already signed exportable with the selected secret key. A local signature does not make sense.</span>
<a href="#l9.62"></a><span id="l9.62"> ### partlySigned.label=Note: some user IDs of key %S are already signed with the selected secret key.</span>
<a href="#l9.63"></a><span id="l9.63"> ### noTrustedOwnKeys=No eligible key found for signing! You need at least one fully trusted secret key in order to sign keys.</span>
<a href="#l9.64"></a><span id="l9.64"> </span>
<a href="#l9.65"></a><span id="l9.65"> # Strings in enigmailKeyManager.js</span>
<a href="#l9.66"></a><span id="l9.66" class="difflineminus">-keyMan.loadingKeys=Loading keys, please wait ...</span>
<a href="#l9.67"></a><span id="l9.67" class="difflineminus">-keyValid.unknown=unknown</span>
<a href="#l9.68"></a><span id="l9.68" class="difflineminus">-keyValid.invalid=invalid</span>
<a href="#l9.69"></a><span id="l9.69" class="difflineminus">-keyValid.disabled=disabled</span>
<a href="#l9.70"></a><span id="l9.70" class="difflineminus">-keyValid.revoked=revoked</span>
<a href="#l9.71"></a><span id="l9.71" class="difflineminus">-keyValid.expired=expired</span>
<a href="#l9.72"></a><span id="l9.72"> ### keyValid.noSubkey=no valid subkey</span>
<a href="#l9.73"></a><span id="l9.73"> </span>
<a href="#l9.74"></a><span id="l9.74" class="difflineminus">-keyTrust.untrusted=untrusted</span>
<a href="#l9.75"></a><span id="l9.75" class="difflineminus">-keyTrust.marginal=marginal</span>
<a href="#l9.76"></a><span id="l9.76" class="difflineminus">-keyTrust.full=trusted</span>
<a href="#l9.77"></a><span id="l9.77" class="difflineminus">-keyTrust.ultimate=ultimate</span>
<a href="#l9.78"></a><span id="l9.78" class="difflineminus">-keyTrust.group=(group)</span>
<a href="#l9.79"></a><span id="l9.79"> ### keyType.public=pub</span>
<a href="#l9.80"></a><span id="l9.80"> ### keyType.publicAndSec=pub/sec</span>
<a href="#l9.81"></a><span id="l9.81" class="difflineminus">-userAtt.photo=User attribute (JPEG image)</span>
<a href="#l9.82"></a><span id="l9.82"> </span>
<a href="#l9.83"></a><span id="l9.83" class="difflineminus">-asciiArmorFile=ASCII Armored Files (*.asc)</span>
<a href="#l9.84"></a><span id="l9.84" class="difflineminus">-importKeyFile=Import OpenPGP Key File</span>
<a href="#l9.85"></a><span id="l9.85" class="difflineminus">-gnupgFile=GnuPG Files</span>
<a href="#l9.86"></a><span id="l9.86" class="difflineminus">-saveRevokeCertAs=Create &amp; Save Revocation Certificate</span>
<a href="#l9.87"></a><span id="l9.87" class="difflineminus">-revokeCertOK=The revocation certificate has been successfully created. You can use it to invalidate your public key, e.g. in case you would lose your secret key.</span>
<a href="#l9.88"></a><span id="l9.88" class="difflineminus">-revokeCertFailed=The revocation certificate could not be created.</span>
<a href="#l9.89"></a><span id="l9.89" class="difflineminus">-</span>
<a href="#l9.90"></a><span id="l9.90" class="difflineminus">-addUidOK=User ID added successfully</span>
<a href="#l9.91"></a><span id="l9.91" class="difflineminus">-addUidFailed=Adding the User ID failed</span>
<a href="#l9.92"></a><span id="l9.92" class="difflineminus">-noKeySelected=You should select at least one key in order to perform the selected operation</span>
<a href="#l9.93"></a><span id="l9.93" class="difflineminus">-exportToFile=Export Public Key To File</span>
<a href="#l9.94"></a><span id="l9.94" class="difflineminus">-exportKeypairToFile=Export Secret and Public Key To File</span>
<a href="#l9.95"></a><span id="l9.95" class="difflineminus">-exportSecretKey=Do you want to include the secret key in the saved OpenPGP key file?</span>
<a href="#l9.96"></a><span id="l9.96" class="difflineminus">-saveKeysOK=The keys were successfully saved</span>
<a href="#l9.97"></a><span id="l9.97" class="difflineminus">-saveKeysFailed=Saving the keys failed</span>
<a href="#l9.98"></a><span id="l9.98" class="difflineminus">-importKeysFailed=Importing the keys failed</span>
<a href="#l9.99"></a><span id="l9.99" class="difflineminus">-specificPubKeyFilename=%1$S (0x%2$S) pub</span>
<a href="#l9.100"></a><span id="l9.100" class="difflineminus">-specificPubSecKeyFilename=%1$S (0x%2$S) pub-sec</span>
<a href="#l9.101"></a><span id="l9.101" class="difflineminus">-defaultPubKeyFilename=Exported-public-keys</span>
<a href="#l9.102"></a><span id="l9.102" class="difflineminus">-defaultPubSecKeyFilename=Exported-public-and-secret-keys</span>
<a href="#l9.103"></a><span id="l9.103" class="difflineplus">+### addUidOK=User ID added successfully</span>
<a href="#l9.104"></a><span id="l9.104" class="difflineplus">+### addUidFailed=Adding the User ID failed</span>
<a href="#l9.105"></a><span id="l9.105"> </span>
<a href="#l9.106"></a><span id="l9.106"> ### sendKeysOk=Key(s) sent successfully</span>
<a href="#l9.107"></a><span id="l9.107"> ### sendKeysFailed=Sending of keys failed</span>
<a href="#l9.108"></a><span id="l9.108"> ### receiveKeysOk=Key(s) updated successfully</span>
<a href="#l9.109"></a><span id="l9.109"> ### receiveKeysFailed=Downloading of keys failed</span>
<a href="#l9.110"></a><span id="l9.110"> ### keyUpload.verifyEmails=The keyserver will send you an email for each email address of your uploaded key. To confirm publication of your key, you'll need to click on the link in each of the emails you'll receive.</span>
<a href="#l9.111"></a><span id="l9.111"> </span>
<a href="#l9.112"></a><span id="l9.112"> ### deleteKeyFailed=The key could not be deleted.</span>
<a href="#l9.113"></a><span id="l9.113"> ### revokeKeyOk=The key has been revoked. If your key is available on a key server, it is recommended to re-upload it, so that others can see the revocation.</span>
<a href="#l9.114"></a><span id="l9.114"> ### revokeKeyFailed=The key could not be revoked.</span>
<a href="#l9.115"></a><span id="l9.115"> ### refreshKeyServiceOn.warn=Warning: Your keys are currently being refreshed in the background as safely as possible.\nRefreshing all your keys at once will unnecessarily reveal information about you.\nDo you really want to do this?</span>
<a href="#l9.116"></a><span id="l9.116" class="difflineminus">-### refreshKey.warn=Warning: depending on the number of keys and the connection speed, refreshing all keys could be quite a lengthy process!</span>
<a href="#l9.117"></a><span id="l9.117"> ### downloadContactsKeys.importFrom=Import contacts from address book '%S'?</span>
<a href="#l9.118"></a><span id="l9.118"> </span>
<a href="#l9.119"></a><span id="l9.119"> ### keylist.noOtherUids=Has no other identities</span>
<a href="#l9.120"></a><span id="l9.120"> ### keylist.hasOtherUids=Also known as</span>
<a href="#l9.121"></a><span id="l9.121"> ### keylist.noPhotos=No photo available</span>
<a href="#l9.122"></a><span id="l9.122"> ### keylist.hasPhotos=Photos</span>
<a href="#l9.123"></a><span id="l9.123"> </span>
<a href="#l9.124"></a><span id="l9.124"> ### keyMan.addphoto.filepicker.title=Select photo to add</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mail/extensions/openpgp/content/ui/commonWorkflows.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/ui/commonWorkflows.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -15,16 +15,18 @@ var EnigmailLocale = ChromeUtils.import(</span>
<a href="#l10.4"></a><span id="l10.4"> ).EnigmailLocale;</span>
<a href="#l10.5"></a><span id="l10.5"> var { EnigmailKey } = ChromeUtils.import(</span>
<a href="#l10.6"></a><span id="l10.6">   &quot;chrome://openpgp/content/modules/key.jsm&quot;</span>
<a href="#l10.7"></a><span id="l10.7"> );</span>
<a href="#l10.8"></a><span id="l10.8"> var EnigmailKeyRing = ChromeUtils.import(</span>
<a href="#l10.9"></a><span id="l10.9">   &quot;chrome://openpgp/content/modules/keyRing.jsm&quot;</span>
<a href="#l10.10"></a><span id="l10.10"> ).EnigmailKeyRing;</span>
<a href="#l10.11"></a><span id="l10.11"> </span>
<a href="#l10.12"></a><span id="l10.12" class="difflineplus">+var l10n = new Localization([&quot;messenger/openpgp/enigmail.ftl&quot;], true);</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+</span>
<a href="#l10.14"></a><span id="l10.14"> /**</span>
<a href="#l10.15"></a><span id="l10.15">  * opens a prompt, asking the user to enter passphrase for given key id</span>
<a href="#l10.16"></a><span id="l10.16">  * returns: the passphrase if entered (empty string is allowed)</span>
<a href="#l10.17"></a><span id="l10.17">  * resultFlags.canceled is set to true if the user clicked cancel</span>
<a href="#l10.18"></a><span id="l10.18">  */</span>
<a href="#l10.19"></a><span id="l10.19"> function passphrasePromptCallback(win, keyId, resultFlags) {</span>
<a href="#l10.20"></a><span id="l10.20">   let p = {};</span>
<a href="#l10.21"></a><span id="l10.21">   p.value = &quot;&quot;;</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineat">@@ -48,22 +50,22 @@ function passphrasePromptCallback(win, k</span>
<a href="#l10.23"></a><span id="l10.23"> }</span>
<a href="#l10.24"></a><span id="l10.24"> </span>
<a href="#l10.25"></a><span id="l10.25"> /**</span>
<a href="#l10.26"></a><span id="l10.26">  * import OpenPGP keys from file</span>
<a href="#l10.27"></a><span id="l10.27">  */</span>
<a href="#l10.28"></a><span id="l10.28"> function EnigmailCommon_importKeysFromFile(secret) {</span>
<a href="#l10.29"></a><span id="l10.29">   let inFile = EnigmailDialog.filePicker(</span>
<a href="#l10.30"></a><span id="l10.30">     window,</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineminus">-    EnigmailLocale.getString(&quot;importKeyFile&quot;),</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+    l10n.formatValueSync(&quot;import-key-file&quot;),</span>
<a href="#l10.33"></a><span id="l10.33">     &quot;&quot;,</span>
<a href="#l10.34"></a><span id="l10.34">     false,</span>
<a href="#l10.35"></a><span id="l10.35">     &quot;*.asc&quot;,</span>
<a href="#l10.36"></a><span id="l10.36">     &quot;&quot;,</span>
<a href="#l10.37"></a><span id="l10.37" class="difflineminus">-    [EnigmailLocale.getString(&quot;gnupgFile&quot;), &quot;*.asc;*.gpg;*.pgp&quot;]</span>
<a href="#l10.38"></a><span id="l10.38" class="difflineplus">+    [l10n.formatValueSync(&quot;gnupg-file&quot;), &quot;*.asc;*.gpg;*.pgp&quot;]</span>
<a href="#l10.39"></a><span id="l10.39">   );</span>
<a href="#l10.40"></a><span id="l10.40">   if (!inFile) {</span>
<a href="#l10.41"></a><span id="l10.41">     return false;</span>
<a href="#l10.42"></a><span id="l10.42">   }</span>
<a href="#l10.43"></a><span id="l10.43"> </span>
<a href="#l10.44"></a><span id="l10.44">   // infile type: nsIFile</span>
<a href="#l10.45"></a><span id="l10.45">   // RNP.maxImportKeyBlockSize</span>
<a href="#l10.46"></a><span id="l10.46">   if (inFile.fileSize &gt; 5000000) {</span>
<a href="#l10.47"></a><span id="l10.47" class="difflineat">@@ -75,20 +77,19 @@ function EnigmailCommon_importKeysFromFi</span>
<a href="#l10.48"></a><span id="l10.48">   let preview = EnigmailKey.getKeyListFromKeyFile(</span>
<a href="#l10.49"></a><span id="l10.49">     inFile,</span>
<a href="#l10.50"></a><span id="l10.50">     errorMsgObj,</span>
<a href="#l10.51"></a><span id="l10.51">     !secret,</span>
<a href="#l10.52"></a><span id="l10.52">     secret</span>
<a href="#l10.53"></a><span id="l10.53">   );</span>
<a href="#l10.54"></a><span id="l10.54"> </span>
<a href="#l10.55"></a><span id="l10.55">   if (!preview || !preview.length || errorMsgObj.value) {</span>
<a href="#l10.56"></a><span id="l10.56" class="difflineminus">-    EnigmailDialog.alert(</span>
<a href="#l10.57"></a><span id="l10.57" class="difflineminus">-      window,</span>
<a href="#l10.58"></a><span id="l10.58" class="difflineminus">-      EnigmailLocale.getString(&quot;importKeysFailed&quot;) + &quot;\n\n&quot; + errorMsgObj.value</span>
<a href="#l10.59"></a><span id="l10.59" class="difflineminus">-    );</span>
<a href="#l10.60"></a><span id="l10.60" class="difflineplus">+    document.l10n.formatValue(&quot;import-keys-failed&quot;).then(value =&gt; {</span>
<a href="#l10.61"></a><span id="l10.61" class="difflineplus">+      EnigmailDialog.alert(window, value + &quot;\n\n&quot; + errorMsgObj.value);</span>
<a href="#l10.62"></a><span id="l10.62" class="difflineplus">+    });</span>
<a href="#l10.63"></a><span id="l10.63">     return false;</span>
<a href="#l10.64"></a><span id="l10.64">   }</span>
<a href="#l10.65"></a><span id="l10.65">   let exitStatus = -1;</span>
<a href="#l10.66"></a><span id="l10.66"> </span>
<a href="#l10.67"></a><span id="l10.67">   if (preview.length &gt; 0) {</span>
<a href="#l10.68"></a><span id="l10.68">     if (preview.length == 1) {</span>
<a href="#l10.69"></a><span id="l10.69">       exitStatus = EnigmailDialog.confirmDlg(</span>
<a href="#l10.70"></a><span id="l10.70">         window,</span>
<a href="#l10.71"></a><span id="l10.71" class="difflineat">@@ -118,22 +119,19 @@ function EnigmailCommon_importKeysFromFi</span>
<a href="#l10.72"></a><span id="l10.72">         passphrasePromptCallback,</span>
<a href="#l10.73"></a><span id="l10.73">         inFile,</span>
<a href="#l10.74"></a><span id="l10.74">         errorMsgObj,</span>
<a href="#l10.75"></a><span id="l10.75">         resultKeys,</span>
<a href="#l10.76"></a><span id="l10.76">         !secret,</span>
<a href="#l10.77"></a><span id="l10.77">         secret</span>
<a href="#l10.78"></a><span id="l10.78">       );</span>
<a href="#l10.79"></a><span id="l10.79">       if (exitCode !== 0) {</span>
<a href="#l10.80"></a><span id="l10.80" class="difflineminus">-        EnigmailDialog.alert(</span>
<a href="#l10.81"></a><span id="l10.81" class="difflineminus">-          window,</span>
<a href="#l10.82"></a><span id="l10.82" class="difflineminus">-          EnigmailLocale.getString(&quot;importKeysFailed&quot;) +</span>
<a href="#l10.83"></a><span id="l10.83" class="difflineminus">-            &quot;\n\n&quot; +</span>
<a href="#l10.84"></a><span id="l10.84" class="difflineminus">-            errorMsgObj.value</span>
<a href="#l10.85"></a><span id="l10.85" class="difflineminus">-        );</span>
<a href="#l10.86"></a><span id="l10.86" class="difflineplus">+        document.l10n.formatValue(&quot;import-keys-failed&quot;).then(value =&gt; {</span>
<a href="#l10.87"></a><span id="l10.87" class="difflineplus">+          EnigmailDialog.alert(window, value + &quot;\n\n&quot; + errorMsgObj.value);</span>
<a href="#l10.88"></a><span id="l10.88" class="difflineplus">+        });</span>
<a href="#l10.89"></a><span id="l10.89">       } else {</span>
<a href="#l10.90"></a><span id="l10.90">         console.debug(&quot;import final resultKeys: %o&quot;, resultKeys.keys);</span>
<a href="#l10.91"></a><span id="l10.91">         EnigmailDialog.keyImportDlg(window, resultKeys.keys);</span>
<a href="#l10.92"></a><span id="l10.92">         return true;</span>
<a href="#l10.93"></a><span id="l10.93">       }</span>
<a href="#l10.94"></a><span id="l10.94">     }</span>
<a href="#l10.95"></a><span id="l10.95">   }</span>
<a href="#l10.96"></a><span id="l10.96"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mail/extensions/openpgp/content/ui/enigmailKeyManager.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/ui/enigmailKeyManager.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -99,18 +99,19 @@ function enigmailKeyManagerLoad() {</span>
<a href="#l11.4"></a><span id="l11.4">   EnigmailSearchCallback.setup(gSearchInput, gTimeoutId, applyFilter, 200);</span>
<a href="#l11.5"></a><span id="l11.5"> </span>
<a href="#l11.6"></a><span id="l11.6">   if (EnigGetPref(&quot;keyManShowAllKeys&quot;)) {</span>
<a href="#l11.7"></a><span id="l11.7">     gShowAllKeysElement.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l11.8"></a><span id="l11.8">   }</span>
<a href="#l11.9"></a><span id="l11.9"> </span>
<a href="#l11.10"></a><span id="l11.10">   gUserList.addEventListener(&quot;click&quot;, onListClick, true);</span>
<a href="#l11.11"></a><span id="l11.11">   //document.getElementById(&quot;pleaseWait&quot;).showPopup(gSearchInput, -1, -1, &quot;tooltip&quot;, &quot;after_end&quot;, &quot;&quot;);</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-  document.getElementById(&quot;statusText&quot;).value = EnigGetString(</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-    &quot;keyMan.loadingKeys&quot;</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineplus">+  document.l10n.setAttributes(</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineplus">+    document.getElementById(&quot;statusText&quot;),</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineplus">+    &quot;key-man-loading-keys&quot;</span>
<a href="#l11.17"></a><span id="l11.17">   );</span>
<a href="#l11.18"></a><span id="l11.18">   document.getElementById(&quot;progressBar&quot;).style.visibility = &quot;visible&quot;;</span>
<a href="#l11.19"></a><span id="l11.19">   EnigmailEvents.dispatchEvent(loadkeyList, 100, null);</span>
<a href="#l11.20"></a><span id="l11.20"> </span>
<a href="#l11.21"></a><span id="l11.21">   gUserList.view = gKeyListView;</span>
<a href="#l11.22"></a><span id="l11.22">   gSearchInput.focus();</span>
<a href="#l11.23"></a><span id="l11.23"> }</span>
<a href="#l11.24"></a><span id="l11.24"> </span>
<a href="#l11.25"></a><span id="l11.25" class="difflineat">@@ -366,17 +367,19 @@ function enigmailDeleteKey() {</span>
<a href="#l11.26"></a><span id="l11.26"> function enigCreateKeyMsg() {</span>
<a href="#l11.27"></a><span id="l11.27">   var enigmailSvc = GetEnigmailSvc();</span>
<a href="#l11.28"></a><span id="l11.28">   if (!enigmailSvc) {</span>
<a href="#l11.29"></a><span id="l11.29">     return;</span>
<a href="#l11.30"></a><span id="l11.30">   }</span>
<a href="#l11.31"></a><span id="l11.31"> </span>
<a href="#l11.32"></a><span id="l11.32">   var keyList = getSelectedKeyIds();</span>
<a href="#l11.33"></a><span id="l11.33">   if (keyList.length === 0) {</span>
<a href="#l11.34"></a><span id="l11.34" class="difflineminus">-    EnigAlert(EnigGetString(&quot;noKeySelected&quot;));</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineplus">+    document.l10n.formatValue(&quot;no-key-selected&quot;).then(value =&gt; {</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineplus">+      EnigAlert(value);</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineplus">+    });</span>
<a href="#l11.38"></a><span id="l11.38">     return;</span>
<a href="#l11.39"></a><span id="l11.39">   }</span>
<a href="#l11.40"></a><span id="l11.40"> </span>
<a href="#l11.41"></a><span id="l11.41">   var tmpDir = EnigGetTempDir();</span>
<a href="#l11.42"></a><span id="l11.42">   var tmpFile;</span>
<a href="#l11.43"></a><span id="l11.43">   try {</span>
<a href="#l11.44"></a><span id="l11.44">     tmpFile = Cc[ENIG_LOCAL_FILE_CONTRACTID].createInstance(</span>
<a href="#l11.45"></a><span id="l11.45">       EnigGetLocalFileApi()</span>
<a href="#l11.46"></a><span id="l11.46" class="difflineat">@@ -445,17 +448,19 @@ function enigCreateKeyMsg() {</span>
<a href="#l11.47"></a><span id="l11.47">   msgCompParam.format = Ci.nsIMsgCompFormat.Default;</span>
<a href="#l11.48"></a><span id="l11.48">   msgCompParam.originalMsgURI = &quot;&quot;;</span>
<a href="#l11.49"></a><span id="l11.49">   msgCompSvc.OpenComposeWindowWithParams(&quot;&quot;, msgCompParam);</span>
<a href="#l11.50"></a><span id="l11.50"> }</span>
<a href="#l11.51"></a><span id="l11.51"> </span>
<a href="#l11.52"></a><span id="l11.52"> function createNewMail() {</span>
<a href="#l11.53"></a><span id="l11.53">   var keyList = getSelectedKeys();</span>
<a href="#l11.54"></a><span id="l11.54">   if (keyList.length === 0) {</span>
<a href="#l11.55"></a><span id="l11.55" class="difflineminus">-    EnigmailDialog.info(window, EnigGetString(&quot;noKeySelected&quot;));</span>
<a href="#l11.56"></a><span id="l11.56" class="difflineplus">+    document.l10n.formatValue(&quot;no-key-selected&quot;).then(value =&gt; {</span>
<a href="#l11.57"></a><span id="l11.57" class="difflineplus">+      EnigmailDialog.info(window, value);</span>
<a href="#l11.58"></a><span id="l11.58" class="difflineplus">+    });</span>
<a href="#l11.59"></a><span id="l11.59">     return;</span>
<a href="#l11.60"></a><span id="l11.60">   }</span>
<a href="#l11.61"></a><span id="l11.61"> </span>
<a href="#l11.62"></a><span id="l11.62">   var addresses = [];</span>
<a href="#l11.63"></a><span id="l11.63">   var rangeCount = gUserList.view.selection.getRangeCount();</span>
<a href="#l11.64"></a><span id="l11.64">   var start = {};</span>
<a href="#l11.65"></a><span id="l11.65">   var end = {};</span>
<a href="#l11.66"></a><span id="l11.66">   var keyType, keyNum, r, i;</span>
<a href="#l11.67"></a><span id="l11.67" class="difflineat">@@ -572,39 +577,42 @@ function enigmailRevokeKey() {</span>
<a href="#l11.68"></a><span id="l11.68"> </span>
<a href="#l11.69"></a><span id="l11.69"> function enigCreateRevokeCert() {</span>
<a href="#l11.70"></a><span id="l11.70">   var keyList = getSelectedKeys();</span>
<a href="#l11.71"></a><span id="l11.71"> </span>
<a href="#l11.72"></a><span id="l11.72">   EnigCreateRevokeCert(gKeyList[keyList[0]].keyId, gKeyList[keyList[0]].userId);</span>
<a href="#l11.73"></a><span id="l11.73"> }</span>
<a href="#l11.74"></a><span id="l11.74"> */</span>
<a href="#l11.75"></a><span id="l11.75"> </span>
<a href="#l11.76"></a><span id="l11.76" class="difflineminus">-function enigmailExportKeys() {</span>
<a href="#l11.77"></a><span id="l11.77" class="difflineplus">+async function enigmailExportKeys() {</span>
<a href="#l11.78"></a><span id="l11.78">   var keyList = getSelectedKeys();</span>
<a href="#l11.79"></a><span id="l11.79">   if (keyList.length === 0) {</span>
<a href="#l11.80"></a><span id="l11.80" class="difflineminus">-    EnigmailDialog.info(window, EnigGetString(&quot;noKeySelected&quot;));</span>
<a href="#l11.81"></a><span id="l11.81" class="difflineplus">+    EnigmailDialog.info(</span>
<a href="#l11.82"></a><span id="l11.82" class="difflineplus">+      window,</span>
<a href="#l11.83"></a><span id="l11.83" class="difflineplus">+      await document.l10n.formatValue(&quot;no-key-selected&quot;)</span>
<a href="#l11.84"></a><span id="l11.84" class="difflineplus">+    );</span>
<a href="#l11.85"></a><span id="l11.85">     return;</span>
<a href="#l11.86"></a><span id="l11.86">   }</span>
<a href="#l11.87"></a><span id="l11.87"> </span>
<a href="#l11.88"></a><span id="l11.88">   // check whether we want to export a private key anywhere in the key list</span>
<a href="#l11.89"></a><span id="l11.89">   var secretFound = false;</span>
<a href="#l11.90"></a><span id="l11.90">   for (var i = 0; i &lt; keyList.length &amp;&amp; !secretFound; ++i) {</span>
<a href="#l11.91"></a><span id="l11.91">     if (gKeyList[keyList[i]].secretAvailable) {</span>
<a href="#l11.92"></a><span id="l11.92">       secretFound = true;</span>
<a href="#l11.93"></a><span id="l11.93">     }</span>
<a href="#l11.94"></a><span id="l11.94">   }</span>
<a href="#l11.95"></a><span id="l11.95"> </span>
<a href="#l11.96"></a><span id="l11.96">   var exportSecretKey = false;</span>
<a href="#l11.97"></a><span id="l11.97">   if (secretFound) {</span>
<a href="#l11.98"></a><span id="l11.98">     // double check that also the pivate keys shall be exportet</span>
<a href="#l11.99"></a><span id="l11.99">     var r = EnigmailDialog.msgBox(window, {</span>
<a href="#l11.100"></a><span id="l11.100" class="difflineminus">-      msgtext: EnigGetString(&quot;exportSecretKey&quot;),</span>
<a href="#l11.101"></a><span id="l11.101" class="difflineplus">+      msgtext: await document.l10n.formatValue(&quot;export-secret-key&quot;),</span>
<a href="#l11.102"></a><span id="l11.102">       dialogTitle: EnigGetString(&quot;enigConfirm2&quot;),</span>
<a href="#l11.103"></a><span id="l11.103" class="difflineminus">-      button1: l10n.formatValueSync(&quot;key-man-button-export-pub-key&quot;),</span>
<a href="#l11.104"></a><span id="l11.104" class="difflineminus">-      button2: l10n.formatValueSync(&quot;key-man-button-export-sec-key&quot;),</span>
<a href="#l11.105"></a><span id="l11.105" class="difflineplus">+      button1: await document.l10n.formatValue(&quot;key-man-button-export-pub-key&quot;),</span>
<a href="#l11.106"></a><span id="l11.106" class="difflineplus">+      button2: await document.l10n.formatValue(&quot;key-man-button-export-sec-key&quot;),</span>
<a href="#l11.107"></a><span id="l11.107">       cancelButton: &quot;:cancel&quot;,</span>
<a href="#l11.108"></a><span id="l11.108">       iconType: EnigmailConstants.ICONTYPE_QUESTION,</span>
<a href="#l11.109"></a><span id="l11.109">     });</span>
<a href="#l11.110"></a><span id="l11.110">     switch (r) {</span>
<a href="#l11.111"></a><span id="l11.111">       case 0: // export pub key only</span>
<a href="#l11.112"></a><span id="l11.112">         break;</span>
<a href="#l11.113"></a><span id="l11.113">       case 1: // export secret key</span>
<a href="#l11.114"></a><span id="l11.114">         exportSecretKey = true;</span>
<a href="#l11.115"></a><span id="l11.115" class="difflineat">@@ -619,49 +627,52 @@ function enigmailExportKeys() {</span>
<a href="#l11.116"></a><span id="l11.116">   if (!enigmailSvc) {</span>
<a href="#l11.117"></a><span id="l11.117">     return;</span>
<a href="#l11.118"></a><span id="l11.118">   }</span>
<a href="#l11.119"></a><span id="l11.119">   var defaultFileName;</span>
<a href="#l11.120"></a><span id="l11.120">   if (keyList.length == 1) {</span>
<a href="#l11.121"></a><span id="l11.121">     defaultFileName = gKeyList[keyList[0]].userId.replace(/[&lt;&gt;]/g, &quot;&quot;);</span>
<a href="#l11.122"></a><span id="l11.122">     if (exportSecretKey) {</span>
<a href="#l11.123"></a><span id="l11.123">       defaultFileName =</span>
<a href="#l11.124"></a><span id="l11.124" class="difflineminus">-        EnigGetString(</span>
<a href="#l11.125"></a><span id="l11.125" class="difflineminus">-          &quot;specificPubSecKeyFilename&quot;,</span>
<a href="#l11.126"></a><span id="l11.126" class="difflineminus">-          defaultFileName,</span>
<a href="#l11.127"></a><span id="l11.127" class="difflineminus">-          gKeyList[keyList[0]].keyId</span>
<a href="#l11.128"></a><span id="l11.128" class="difflineminus">-        ) + &quot;.asc&quot;;</span>
<a href="#l11.129"></a><span id="l11.129" class="difflineplus">+        defaultFileName +</span>
<a href="#l11.130"></a><span id="l11.130" class="difflineplus">+        &quot; &quot; +</span>
<a href="#l11.131"></a><span id="l11.131" class="difflineplus">+        `(0x${gKeyList[keyList[0]].keyId}` +</span>
<a href="#l11.132"></a><span id="l11.132" class="difflineplus">+        &quot; &quot; +</span>
<a href="#l11.133"></a><span id="l11.133" class="difflineplus">+        &quot;pub-sec.asc&quot;;</span>
<a href="#l11.134"></a><span id="l11.134">     } else {</span>
<a href="#l11.135"></a><span id="l11.135">       defaultFileName =</span>
<a href="#l11.136"></a><span id="l11.136" class="difflineminus">-        EnigGetString(</span>
<a href="#l11.137"></a><span id="l11.137" class="difflineminus">-          &quot;specificPubKeyFilename&quot;,</span>
<a href="#l11.138"></a><span id="l11.138" class="difflineminus">-          defaultFileName,</span>
<a href="#l11.139"></a><span id="l11.139" class="difflineminus">-          gKeyList[keyList[0]].keyId</span>
<a href="#l11.140"></a><span id="l11.140" class="difflineminus">-        ) + &quot;.asc&quot;;</span>
<a href="#l11.141"></a><span id="l11.141" class="difflineplus">+        defaultFileName +</span>
<a href="#l11.142"></a><span id="l11.142" class="difflineplus">+        &quot; &quot; +</span>
<a href="#l11.143"></a><span id="l11.143" class="difflineplus">+        `(0x${gKeyList[keyList[0]].keyId})` +</span>
<a href="#l11.144"></a><span id="l11.144" class="difflineplus">+        &quot; &quot; +</span>
<a href="#l11.145"></a><span id="l11.145" class="difflineplus">+        &quot;pub.asc&quot;;</span>
<a href="#l11.146"></a><span id="l11.146">     }</span>
<a href="#l11.147"></a><span id="l11.147">   } else if (exportSecretKey) {</span>
<a href="#l11.148"></a><span id="l11.148" class="difflineminus">-    defaultFileName = EnigGetString(&quot;defaultPubSecKeyFilename&quot;) + &quot;.asc&quot;;</span>
<a href="#l11.149"></a><span id="l11.149" class="difflineplus">+    defaultFileName =</span>
<a href="#l11.150"></a><span id="l11.150" class="difflineplus">+      (await document.l10n.formatValue(&quot;default-pub-sec-key-filename&quot;)) +</span>
<a href="#l11.151"></a><span id="l11.151" class="difflineplus">+      &quot;.asc&quot;;</span>
<a href="#l11.152"></a><span id="l11.152">   } else {</span>
<a href="#l11.153"></a><span id="l11.153" class="difflineminus">-    defaultFileName = EnigGetString(&quot;defaultPubKeyFilename&quot;) + &quot;.asc&quot;;</span>
<a href="#l11.154"></a><span id="l11.154" class="difflineplus">+    defaultFileName =</span>
<a href="#l11.155"></a><span id="l11.155" class="difflineplus">+      (await document.l10n.formatValue(&quot;default-pub-key-filename&quot;)) + &quot;.asc&quot;;</span>
<a href="#l11.156"></a><span id="l11.156">   }</span>
<a href="#l11.157"></a><span id="l11.157"> </span>
<a href="#l11.158"></a><span id="l11.158">   var FilePickerLabel = &quot;&quot;;</span>
<a href="#l11.159"></a><span id="l11.159"> </span>
<a href="#l11.160"></a><span id="l11.160">   if (exportSecretKey) {</span>
<a href="#l11.161"></a><span id="l11.161" class="difflineminus">-    FilePickerLabel = EnigGetString(&quot;exportKeypairToFile&quot;);</span>
<a href="#l11.162"></a><span id="l11.162" class="difflineplus">+    FilePickerLabel = await document.l10n.formatValue(&quot;export-keypair-to-file&quot;);</span>
<a href="#l11.163"></a><span id="l11.163">   } else {</span>
<a href="#l11.164"></a><span id="l11.164" class="difflineminus">-    FilePickerLabel = EnigGetString(&quot;exportToFile&quot;);</span>
<a href="#l11.165"></a><span id="l11.165" class="difflineplus">+    FilePickerLabel = await document.l10n.formatValue(&quot;export-to-file&quot;);</span>
<a href="#l11.166"></a><span id="l11.166">   }</span>
<a href="#l11.167"></a><span id="l11.167">   var outFile = EnigFilePicker(</span>
<a href="#l11.168"></a><span id="l11.168">     FilePickerLabel,</span>
<a href="#l11.169"></a><span id="l11.169">     &quot;&quot;,</span>
<a href="#l11.170"></a><span id="l11.170">     true,</span>
<a href="#l11.171"></a><span id="l11.171">     &quot;*.asc&quot;,</span>
<a href="#l11.172"></a><span id="l11.172">     defaultFileName,</span>
<a href="#l11.173"></a><span id="l11.173" class="difflineminus">-    [EnigGetString(&quot;asciiArmorFile&quot;), &quot;*.asc&quot;]</span>
<a href="#l11.174"></a><span id="l11.174" class="difflineplus">+    [await document.l10n.formatValue(&quot;ascii-armor-file&quot;), &quot;*.asc&quot;]</span>
<a href="#l11.175"></a><span id="l11.175">   );</span>
<a href="#l11.176"></a><span id="l11.176">   if (!outFile) {</span>
<a href="#l11.177"></a><span id="l11.177">     return;</span>
<a href="#l11.178"></a><span id="l11.178">   }</span>
<a href="#l11.179"></a><span id="l11.179"> </span>
<a href="#l11.180"></a><span id="l11.180">   var exitCodeObj = {};</span>
<a href="#l11.181"></a><span id="l11.181">   var errorMsgObj = {};</span>
<a href="#l11.182"></a><span id="l11.182"> </span>
<a href="#l11.183"></a><span id="l11.183" class="difflineat">@@ -674,19 +685,26 @@ function enigmailExportKeys() {</span>
<a href="#l11.184"></a><span id="l11.184">   EnigmailKeyRing.extractKey(</span>
<a href="#l11.185"></a><span id="l11.185">     exportSecretKey,</span>
<a href="#l11.186"></a><span id="l11.186">     keyIdArray,</span>
<a href="#l11.187"></a><span id="l11.187">     outFile,</span>
<a href="#l11.188"></a><span id="l11.188">     exitCodeObj,</span>
<a href="#l11.189"></a><span id="l11.189">     errorMsgObj</span>
<a href="#l11.190"></a><span id="l11.190">   );</span>
<a href="#l11.191"></a><span id="l11.191">   if (exitCodeObj.value !== 0) {</span>
<a href="#l11.192"></a><span id="l11.192" class="difflineminus">-    EnigAlert(EnigGetString(&quot;saveKeysFailed&quot;) + &quot;\n\n&quot; + errorMsgObj.value);</span>
<a href="#l11.193"></a><span id="l11.193" class="difflineplus">+    EnigAlert(</span>
<a href="#l11.194"></a><span id="l11.194" class="difflineplus">+      (await document.l10n.formatValue(&quot;save-keys-failed&quot;)) +</span>
<a href="#l11.195"></a><span id="l11.195" class="difflineplus">+        &quot;\n\n&quot; +</span>
<a href="#l11.196"></a><span id="l11.196" class="difflineplus">+        errorMsgObj.value</span>
<a href="#l11.197"></a><span id="l11.197" class="difflineplus">+    );</span>
<a href="#l11.198"></a><span id="l11.198">   } else {</span>
<a href="#l11.199"></a><span id="l11.199" class="difflineminus">-    EnigmailDialog.info(window, EnigGetString(&quot;saveKeysOK&quot;));</span>
<a href="#l11.200"></a><span id="l11.200" class="difflineplus">+    EnigmailDialog.info(</span>
<a href="#l11.201"></a><span id="l11.201" class="difflineplus">+      window,</span>
<a href="#l11.202"></a><span id="l11.202" class="difflineplus">+      await document.l10n.formatValue(&quot;save-keys-ok&quot;)</span>
<a href="#l11.203"></a><span id="l11.203" class="difflineplus">+    );</span>
<a href="#l11.204"></a><span id="l11.204">   }</span>
<a href="#l11.205"></a><span id="l11.205"> }</span>
<a href="#l11.206"></a><span id="l11.206"> </span>
<a href="#l11.207"></a><span id="l11.207"> /*</span>
<a href="#l11.208"></a><span id="l11.208"> function enigmailManageUids() {</span>
<a href="#l11.209"></a><span id="l11.209">   var keyList = getSelectedKeys();</span>
<a href="#l11.210"></a><span id="l11.210">   var inputObj = {</span>
<a href="#l11.211"></a><span id="l11.211">     keyId: gKeyList[keyList[0]].keyId,</span>
<a href="#l11.212"></a><span id="l11.212" class="difflineat">@@ -795,17 +813,19 @@ function enigmailImportFromClipbrd() {</span>
<a href="#l11.213"></a><span id="l11.213"> function enigmailCopyToClipbrd() {</span>
<a href="#l11.214"></a><span id="l11.214">   var enigmailSvc = GetEnigmailSvc();</span>
<a href="#l11.215"></a><span id="l11.215">   if (!enigmailSvc) {</span>
<a href="#l11.216"></a><span id="l11.216">     return;</span>
<a href="#l11.217"></a><span id="l11.217">   }</span>
<a href="#l11.218"></a><span id="l11.218"> </span>
<a href="#l11.219"></a><span id="l11.219">   var keyList = getSelectedKeyIds();</span>
<a href="#l11.220"></a><span id="l11.220">   if (keyList.length === 0) {</span>
<a href="#l11.221"></a><span id="l11.221" class="difflineminus">-    EnigmailDialog.info(window, EnigGetString(&quot;noKeySelected&quot;));</span>
<a href="#l11.222"></a><span id="l11.222" class="difflineplus">+    document.l10n.formatValue(&quot;no-key-selected&quot;).then(value =&gt; {</span>
<a href="#l11.223"></a><span id="l11.223" class="difflineplus">+      EnigmailDialog.info(window, value);</span>
<a href="#l11.224"></a><span id="l11.224" class="difflineplus">+    });</span>
<a href="#l11.225"></a><span id="l11.225">     return;</span>
<a href="#l11.226"></a><span id="l11.226">   }</span>
<a href="#l11.227"></a><span id="l11.227">   var exitCodeObj = {};</span>
<a href="#l11.228"></a><span id="l11.228">   var errorMsgObj = {};</span>
<a href="#l11.229"></a><span id="l11.229"> </span>
<a href="#l11.230"></a><span id="l11.230">   var keyIdArray = [];</span>
<a href="#l11.231"></a><span id="l11.231">   for (let id of keyList) {</span>
<a href="#l11.232"></a><span id="l11.232">     keyIdArray.push(&quot;0x&quot; + id);</span>
<a href="#l11.233"></a><span id="l11.233" class="difflineat">@@ -814,19 +834,19 @@ function enigmailCopyToClipbrd() {</span>
<a href="#l11.234"></a><span id="l11.234">   var keyData = EnigmailKeyRing.extractKey(</span>
<a href="#l11.235"></a><span id="l11.235">     0,</span>
<a href="#l11.236"></a><span id="l11.236">     keyIdArray,</span>
<a href="#l11.237"></a><span id="l11.237">     null,</span>
<a href="#l11.238"></a><span id="l11.238">     exitCodeObj,</span>
<a href="#l11.239"></a><span id="l11.239">     errorMsgObj</span>
<a href="#l11.240"></a><span id="l11.240">   );</span>
<a href="#l11.241"></a><span id="l11.241">   if (exitCodeObj.value !== 0) {</span>
<a href="#l11.242"></a><span id="l11.242" class="difflineminus">-    EnigAlert(</span>
<a href="#l11.243"></a><span id="l11.243" class="difflineminus">-      EnigGetString(&quot;copyToClipbrdFailed&quot;) + &quot;\n\n&quot; + errorMsgObj.value</span>
<a href="#l11.244"></a><span id="l11.244" class="difflineminus">-    );</span>
<a href="#l11.245"></a><span id="l11.245" class="difflineplus">+    l10n.formatValue(&quot;copy-to-clipbrd-failed&quot;).then(value =&gt; {</span>
<a href="#l11.246"></a><span id="l11.246" class="difflineplus">+      EnigAlert(value);</span>
<a href="#l11.247"></a><span id="l11.247" class="difflineplus">+    });</span>
<a href="#l11.248"></a><span id="l11.248">     return;</span>
<a href="#l11.249"></a><span id="l11.249">   }</span>
<a href="#l11.250"></a><span id="l11.250">   if (EnigmailClipboard.setClipboardContent(keyData)) {</span>
<a href="#l11.251"></a><span id="l11.251">     EnigmailLog.DEBUG(</span>
<a href="#l11.252"></a><span id="l11.252">       &quot;enigmailKeyManager.js: enigmailImportFromClipbrd: set clipboard data\n&quot;</span>
<a href="#l11.253"></a><span id="l11.253">     );</span>
<a href="#l11.254"></a><span id="l11.254">     l10n.formatValue(&quot;copy-to-clipbrd-ok&quot;).then(value =&gt; {</span>
<a href="#l11.255"></a><span id="l11.255">       EnigmailDialog.info(window, value);</span>
<a href="#l11.256"></a><span id="l11.256" class="difflineat">@@ -1211,17 +1231,19 @@ function determineHiddenKeys(</span>
<a href="#l11.257"></a><span id="l11.257"> function accessKeyServer(accessType, callbackFunc) {</span>
<a href="#l11.258"></a><span id="l11.258">   var enigmailSvc = GetEnigmailSvc();</span>
<a href="#l11.259"></a><span id="l11.259">   if (!enigmailSvc) {</span>
<a href="#l11.260"></a><span id="l11.260">     return;</span>
<a href="#l11.261"></a><span id="l11.261">   }</span>
<a href="#l11.262"></a><span id="l11.262"> </span>
<a href="#l11.263"></a><span id="l11.263">   const ioService = Services.io;</span>
<a href="#l11.264"></a><span id="l11.264">   if (ioService &amp;&amp; ioService.offline) {</span>
<a href="#l11.265"></a><span id="l11.265" class="difflineminus">-    EnigmailDialog.alert(window, EnigmailLocale.getString(&quot;needOnline&quot;));</span>
<a href="#l11.266"></a><span id="l11.266" class="difflineplus">+    document.l10n.formatValue(&quot;need-online&quot;).then(value =&gt; {</span>
<a href="#l11.267"></a><span id="l11.267" class="difflineplus">+      EnigmailDialog.alert(window, value);</span>
<a href="#l11.268"></a><span id="l11.268" class="difflineplus">+    });</span>
<a href="#l11.269"></a><span id="l11.269">     return;</span>
<a href="#l11.270"></a><span id="l11.270">   }</span>
<a href="#l11.271"></a><span id="l11.271"> </span>
<a href="#l11.272"></a><span id="l11.272">   let inputObj = {};</span>
<a href="#l11.273"></a><span id="l11.273">   let resultObj = {};</span>
<a href="#l11.274"></a><span id="l11.274">   let selKeyList = getSelectedKeys();</span>
<a href="#l11.275"></a><span id="l11.275">   let keyList = [];</span>
<a href="#l11.276"></a><span id="l11.276">   for (let i = 0; i &lt; selKeyList.length; i++) {</span>
<a href="#l11.277"></a><span id="l11.277" class="difflineat">@@ -1234,17 +1256,17 @@ function accessKeyServer(accessType, cal</span>
<a href="#l11.278"></a><span id="l11.278">         window,</span>
<a href="#l11.279"></a><span id="l11.279">         l10n.formatValueSync(&quot;refresh-all-question&quot;),</span>
<a href="#l11.280"></a><span id="l11.280">         l10n.formatValueSync(&quot;key-man-button-refresh-all&quot;)</span>
<a href="#l11.281"></a><span id="l11.281">       )</span>
<a href="#l11.282"></a><span id="l11.282">     ) {</span>
<a href="#l11.283"></a><span id="l11.283">       accessType = EnigmailConstants.DOWNLOAD_KEY;</span>
<a href="#l11.284"></a><span id="l11.284">       EnigmailDialog.alertPref(</span>
<a href="#l11.285"></a><span id="l11.285">         window,</span>
<a href="#l11.286"></a><span id="l11.286" class="difflineminus">-        EnigmailLocale.getString(&quot;refreshKey.warn&quot;),</span>
<a href="#l11.287"></a><span id="l11.287" class="difflineplus">+        l10n.formatValueSync(&quot;refresh-key-warn&quot;),</span>
<a href="#l11.288"></a><span id="l11.288">         &quot;warnRefreshAll&quot;</span>
<a href="#l11.289"></a><span id="l11.289">       );</span>
<a href="#l11.290"></a><span id="l11.290">     } else {</span>
<a href="#l11.291"></a><span id="l11.291">       return;</span>
<a href="#l11.292"></a><span id="l11.292">     }</span>
<a href="#l11.293"></a><span id="l11.293">   }</span>
<a href="#l11.294"></a><span id="l11.294"> </span>
<a href="#l11.295"></a><span id="l11.295">   let keyServer = EnigmailPrefs.getPref(&quot;autoKeyServerSelection&quot;)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mail/extensions/openpgp/content/ui/enigmailKeygen.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/ui/enigmailKeygen.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -31,16 +31,18 @@ var { EnigmailFiles } = ChromeUtils.impo</span>
<a href="#l12.4"></a><span id="l12.4"> var OpenPGPMasterpass = ChromeUtils.import(</span>
<a href="#l12.5"></a><span id="l12.5">   &quot;chrome://openpgp/content/modules/masterpass.jsm&quot;</span>
<a href="#l12.6"></a><span id="l12.6"> ).OpenPGPMasterpass;</span>
<a href="#l12.7"></a><span id="l12.7"> var { RNP } = ChromeUtils.import(&quot;chrome://openpgp/content/modules/RNP.jsm&quot;);</span>
<a href="#l12.8"></a><span id="l12.8"> const { MailServices } = ChromeUtils.import(</span>
<a href="#l12.9"></a><span id="l12.9">   &quot;resource:///modules/MailServices.jsm&quot;</span>
<a href="#l12.10"></a><span id="l12.10"> );</span>
<a href="#l12.11"></a><span id="l12.11"> </span>
<a href="#l12.12"></a><span id="l12.12" class="difflineplus">+var l10n = new Localization([&quot;messenger/openpgp/enigmail.ftl&quot;], true);</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+</span>
<a href="#l12.14"></a><span id="l12.14"> var gUserIdentityList;</span>
<a href="#l12.15"></a><span id="l12.15"> var gUserIdentityListPopup;</span>
<a href="#l12.16"></a><span id="l12.16"> </span>
<a href="#l12.17"></a><span id="l12.17"> var gKeygenRequest;</span>
<a href="#l12.18"></a><span id="l12.18"> var gAllData = &quot;&quot;;</span>
<a href="#l12.19"></a><span id="l12.19"> var gGeneratedKey = null;</span>
<a href="#l12.20"></a><span id="l12.20"> var gUsedId;</span>
<a href="#l12.21"></a><span id="l12.21"> </span>
<a href="#l12.22"></a><span id="l12.22" class="difflineat">@@ -119,35 +121,38 @@ function enigmailKeygenUnload() {</span>
<a href="#l12.23"></a><span id="l12.23">   EnigmailLog.DEBUG(&quot;enigmailKeygen.js: Unload\n&quot;);</span>
<a href="#l12.24"></a><span id="l12.24"> </span>
<a href="#l12.25"></a><span id="l12.25">   enigmailKeygenCloseRequest();</span>
<a href="#l12.26"></a><span id="l12.26"> }</span>
<a href="#l12.27"></a><span id="l12.27"> </span>
<a href="#l12.28"></a><span id="l12.28"> /**</span>
<a href="#l12.29"></a><span id="l12.29">  *  create a copy of the revokation cert at a user defined location</span>
<a href="#l12.30"></a><span id="l12.30">  */</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineminus">-function saveRevCert(inputKeyFile, keyId, uid, resolve, reject) {</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+async function saveRevCert(inputKeyFile, keyId, uid, resolve, reject) {</span>
<a href="#l12.33"></a><span id="l12.33">   let defaultFileName = uid.replace(/[\\/&lt;&gt;]/g, &quot;&quot;);</span>
<a href="#l12.34"></a><span id="l12.34">   defaultFileName += &quot; (0x&quot; + keyId + &quot;) rev.asc&quot;;</span>
<a href="#l12.35"></a><span id="l12.35"> </span>
<a href="#l12.36"></a><span id="l12.36">   let outFile = EnigFilePicker(</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineminus">-    EnigGetString(&quot;saveRevokeCertAs&quot;),</span>
<a href="#l12.38"></a><span id="l12.38" class="difflineplus">+    await document.l10n.formatValue(&quot;save-revoke-cert-as&quot;),</span>
<a href="#l12.39"></a><span id="l12.39">     &quot;&quot;,</span>
<a href="#l12.40"></a><span id="l12.40">     true,</span>
<a href="#l12.41"></a><span id="l12.41">     &quot;*.asc&quot;,</span>
<a href="#l12.42"></a><span id="l12.42">     defaultFileName,</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineminus">-    [EnigGetString(&quot;asciiArmorFile&quot;), &quot;*.asc&quot;]</span>
<a href="#l12.44"></a><span id="l12.44" class="difflineplus">+    [await document.l10n.formatValue(&quot;ascii-armor-file&quot;), &quot;*.asc&quot;]</span>
<a href="#l12.45"></a><span id="l12.45">   );</span>
<a href="#l12.46"></a><span id="l12.46"> </span>
<a href="#l12.47"></a><span id="l12.47">   if (outFile) {</span>
<a href="#l12.48"></a><span id="l12.48">     try {</span>
<a href="#l12.49"></a><span id="l12.49">       inputKeyFile.copyToFollowingLinks(outFile.parent, outFile.leafName);</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineminus">-      EnigmailDialog.info(window, EnigGetString(&quot;revokeCertOK&quot;));</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineplus">+      EnigmailDialog.info(</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineplus">+        window,</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineplus">+        await document.l10n.formatValue(&quot;revoke-cert-ok&quot;)</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineplus">+      );</span>
<a href="#l12.55"></a><span id="l12.55">     } catch (ex) {</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineminus">-      EnigAlert(EnigGetString(&quot;revokeCertFailed&quot;));</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineplus">+      EnigAlert(await document.l10n.formatValue(&quot;revoke-cert-failed&quot;));</span>
<a href="#l12.58"></a><span id="l12.58">       reject(2);</span>
<a href="#l12.59"></a><span id="l12.59">     }</span>
<a href="#l12.60"></a><span id="l12.60">   }</span>
<a href="#l12.61"></a><span id="l12.61">   resolve();</span>
<a href="#l12.62"></a><span id="l12.62"> }</span>
<a href="#l12.63"></a><span id="l12.63"> </span>
<a href="#l12.64"></a><span id="l12.64"> function closeAndReset() {</span>
<a href="#l12.65"></a><span id="l12.65">   EnigmailKeyRing.clearCache();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mail/extensions/openpgp/content/ui/keyDetailsDlg.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mail/extensions/openpgp/content/ui/keyDetailsDlg.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -213,17 +213,17 @@ function createUidData(listNode, keyDeta</span>
<a href="#l13.4"></a><span id="l13.4">       }</span>
<a href="#l13.5"></a><span id="l13.5">     }</span>
<a href="#l13.6"></a><span id="l13.6">   }</span>
<a href="#l13.7"></a><span id="l13.7"> }</span>
<a href="#l13.8"></a><span id="l13.8"> </span>
<a href="#l13.9"></a><span id="l13.9"> function getTrustLabel(trustCode) {</span>
<a href="#l13.10"></a><span id="l13.10">   var trustTxt = EnigGetTrustLabel(trustCode);</span>
<a href="#l13.11"></a><span id="l13.11">   if (trustTxt == &quot;-&quot; || trustTxt.length === 0) {</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-    trustTxt = EnigmailLocale.getString(&quot;keyValid.unknown&quot;);</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+    return l10n.formatValueSync(&quot;key-valid-unknown&quot;);</span>
<a href="#l13.14"></a><span id="l13.14">   }</span>
<a href="#l13.15"></a><span id="l13.15">   return trustTxt;</span>
<a href="#l13.16"></a><span id="l13.16"> }</span>
<a href="#l13.17"></a><span id="l13.17"> </span>
<a href="#l13.18"></a><span id="l13.18"> function setAttr(attribute, value) {</span>
<a href="#l13.19"></a><span id="l13.19">   var elem = document.getElementById(attribute);</span>
<a href="#l13.20"></a><span id="l13.20">   if (elem) {</span>
<a href="#l13.21"></a><span id="l13.21">     elem.value = value;</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:33Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

