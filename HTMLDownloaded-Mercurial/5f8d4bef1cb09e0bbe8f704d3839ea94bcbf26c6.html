<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 20989:5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6" />
<meta property="og:url" content="/comm-central/rev/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6" />
<meta property="og:description" content="Bug 1293007 - Replace in-tree consumer of non-standard Iterator() with Object.{values,entries} in mailnews/ in comm-central. r=aceman" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6">shortlog</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6">files</a> |
changeset |
<a href="/comm-central/raw-rev/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6">raw</a>  | <a href="/comm-central/archive/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1293007">Bug 1293007</a> - Replace in-tree consumer of non-standard Iterator() with Object.{values,entries} in mailnews/ in comm-central. r=aceman
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#65;&#109;&#97;&#110;&#32;&#68;&#119;&#105;&#118;&#101;&#100;&#105;&#32;&#60;&#100;&#119;&#105;&#118;&#101;&#100;&#105;&#46;&#97;&#109;&#97;&#110;&#57;&#54;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Thu, 05 Jan 2017 13:43:41 +0530</td></tr>

<tr>
 <td>changeset 20989</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6">5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6</a></td>
</tr>



<tr>
<td>parent 20988</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/d9c51a68b3730c824393c84539025cd9296ca581">d9c51a68b3730c824393c84539025cd9296ca581</a>
</td>
</tr>

<tr>
<td>child 20990</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/48fcd36a39e793b2c92a76a0128c936762757b5e">48fcd36a39e793b2c92a76a0128c936762757b5e</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6">12732</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Tue, 10 Jan 2017 18:01:38 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@a5407b27ddc0 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=a5407b27ddc02622e90ca7278c78d8db5145ab77">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=a5407b27ddc02622e90ca7278c78d8db5145ab77&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a5407b27ddc02622e90ca7278c78d8db5145ab77&newProject=comm-central&newRevision=5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a5407b27ddc02622e90ca7278c78d8db5145ab77&newProject=comm-central&newRevision=5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=a5407b27ddc02622e90ca7278c78d8db5145ab77&newProject=comm-central&newRevision=5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28aceman%29&revcount=50">aceman</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1293007">1293007</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1293007">Bug 1293007</a> - Replace in-tree consumer of non-standard Iterator() with Object.{values,entries} in mailnews/ in comm-central. r=aceman</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/content/jsTreeView.js">mailnews/base/content/jsTreeView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/content/jsTreeView.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/content/jsTreeView.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/content/jsTreeView.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/content/jsTreeView.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/content/jsTreeView.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_autoconfigUtils.js">mailnews/base/test/unit/test_autoconfigUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_autoconfigUtils.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_autoconfigUtils.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_autoconfigUtils.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_autoconfigUtils.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_autoconfigUtils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_iteratorUtils.js">mailnews/base/test/unit/test_iteratorUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_iteratorUtils.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_iteratorUtils.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_iteratorUtils.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_iteratorUtils.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_iteratorUtils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_nsMsgDBView.js">mailnews/base/test/unit/test_nsMsgDBView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_nsMsgDBView.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_nsMsgDBView.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_nsMsgDBView.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_nsMsgDBView.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/base/test/unit/test_nsMsgDBView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/components/glautocomp.js">mailnews/db/gloda/components/glautocomp.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/components/glautocomp.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/components/glautocomp.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/components/glautocomp.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/components/glautocomp.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/components/glautocomp.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/collection.js">mailnews/db/gloda/modules/collection.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/collection.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/collection.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/collection.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/collection.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/collection.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/datamodel.js">mailnews/db/gloda/modules/datamodel.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/datamodel.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/datamodel.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/datamodel.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/datamodel.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/datamodel.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/datastore.js">mailnews/db/gloda/modules/datastore.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/datastore.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/datastore.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/datastore.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/datastore.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/datastore.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/fundattr.js">mailnews/db/gloda/modules/fundattr.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/fundattr.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/fundattr.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/fundattr.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/fundattr.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/fundattr.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/gloda.js">mailnews/db/gloda/modules/gloda.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/gloda.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/gloda.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/gloda.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/gloda.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/modules/gloda.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/test/unit/resources/genericIndexer.js">mailnews/db/gloda/test/unit/resources/genericIndexer.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/test/unit/resources/genericIndexer.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/test/unit/resources/genericIndexer.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/test/unit/resources/genericIndexer.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/test/unit/resources/genericIndexer.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/test/unit/resources/genericIndexer.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/test/unit/test_fts3_tokenizer.js">mailnews/db/gloda/test/unit/test_fts3_tokenizer.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/test/unit/test_fts3_tokenizer.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/test/unit/test_fts3_tokenizer.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/test/unit/test_fts3_tokenizer.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/test/unit/test_fts3_tokenizer.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/db/gloda/test/unit/test_fts3_tokenizer.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/mime/test/unit/test_message_attachment.js">mailnews/mime/test/unit/test_message_attachment.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/mime/test/unit/test_message_attachment.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/mime/test/unit/test_message_attachment.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/mime/test/unit/test_message_attachment.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/mime/test/unit/test_message_attachment.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/mime/test/unit/test_message_attachment.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/mailTestUtils.js">mailnews/test/resources/mailTestUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/mailTestUtils.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/mailTestUtils.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/mailTestUtils.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/mailTestUtils.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/mailTestUtils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/messageGenerator.js">mailnews/test/resources/messageGenerator.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/messageGenerator.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/messageGenerator.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/messageGenerator.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/messageGenerator.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/messageGenerator.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/messageModifier.js">mailnews/test/resources/messageModifier.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/messageModifier.js">file</a> |
<a href="/comm-central/annotate/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/messageModifier.js">annotate</a> |
<a href="/comm-central/diff/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/messageModifier.js">diff</a> |
<a href="/comm-central/comparison/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/messageModifier.js">comparison</a> |
<a href="/comm-central/log/5f8d4bef1cb09e0bbe8f704d3839ea94bcbf26c6/mailnews/test/resources/messageModifier.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mailnews/base/content/jsTreeView.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mailnews/base/content/jsTreeView.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -119,17 +119,17 @@ PROTO_TREE_VIEW.prototype = {</span>
<a href="#l1.4"></a><span id="l1.4">     this._tree = aTree;</span>
<a href="#l1.5"></a><span id="l1.5">   },</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7">   recursivelyAddToMap: function jstv_recursivelyAddToMap(aChild, aNewIndex) {</span>
<a href="#l1.8"></a><span id="l1.8">     // When we add sub-children, we're going to need to increase our index</span>
<a href="#l1.9"></a><span id="l1.9">     // for the next add item at our own level.</span>
<a href="#l1.10"></a><span id="l1.10">     let currentCount = this._rowMap.length;</span>
<a href="#l1.11"></a><span id="l1.11">     if (aChild.children.length &amp;&amp; aChild.open) {</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-      for (let [i, child] in Iterator(this._rowMap[aNewIndex].children)) {</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+      for (let [i, child] of this._rowMap[aNewIndex].children.entries()) {</span>
<a href="#l1.14"></a><span id="l1.14">         let index = aNewIndex + i + 1;</span>
<a href="#l1.15"></a><span id="l1.15">         this._rowMap.splice(index, 0, child);</span>
<a href="#l1.16"></a><span id="l1.16">         aNewIndex += this.recursivelyAddToMap(child, index);</span>
<a href="#l1.17"></a><span id="l1.17">       }</span>
<a href="#l1.18"></a><span id="l1.18">     }</span>
<a href="#l1.19"></a><span id="l1.19">     return this._rowMap.length - currentCount;</span>
<a href="#l1.20"></a><span id="l1.20">   },</span>
<a href="#l1.21"></a><span id="l1.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mailnews/base/test/unit/test_autoconfigUtils.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_autoconfigUtils.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -61,17 +61,17 @@ function assert_equal_host_entries(hostE</span>
<a href="#l2.4"></a><span id="l2.4"> };</span>
<a href="#l2.5"></a><span id="l2.5"> </span>
<a href="#l2.6"></a><span id="l2.6"> /**</span>
<a href="#l2.7"></a><span id="l2.7">  * Assert that the list of tryOrders are the same.</span>
<a href="#l2.8"></a><span id="l2.8">  */</span>
<a href="#l2.9"></a><span id="l2.9"> function assert_equal_try_orders(aA, aB)</span>
<a href="#l2.10"></a><span id="l2.10"> {</span>
<a href="#l2.11"></a><span id="l2.11">   assert_equal(aA.length, aB.length, &quot;tryOrders have different length&quot;);</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-  for (let [i,subA] in Iterator(aA)) {</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+  for (let [i,subA] of aA.entries()) {</span>
<a href="#l2.14"></a><span id="l2.14">     let subB = aB[i];</span>
<a href="#l2.15"></a><span id="l2.15">     assert_equal_host_entries(subA, subB);</span>
<a href="#l2.16"></a><span id="l2.16">   }</span>
<a href="#l2.17"></a><span id="l2.17"> };</span>
<a href="#l2.18"></a><span id="l2.18"> </span>
<a href="#l2.19"></a><span id="l2.19"> /**</span>
<a href="#l2.20"></a><span id="l2.20">  * Check that the POP calculations are correct for a given host and</span>
<a href="#l2.21"></a><span id="l2.21">  * protocol.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mailnews/base/test/unit/test_iteratorUtils.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_iteratorUtils.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -127,32 +127,32 @@ function test_toArray_NodeList() {</span>
<a href="#l3.4"></a><span id="l3.4">   // Sanity check -- rootNode should have tag &quot;rootnode&quot;</span>
<a href="#l3.5"></a><span id="l3.5">   do_check_eq(rootNode.tagName, &quot;rootnode&quot;);</span>
<a href="#l3.6"></a><span id="l3.6">   // childNodes is a NodeList</span>
<a href="#l3.7"></a><span id="l3.7">   let childNodes = rootNode.childNodes;</span>
<a href="#l3.8"></a><span id="l3.8">   // Make sure we have at least one child node</span>
<a href="#l3.9"></a><span id="l3.9">   do_check_true(childNodes.length &gt; 0);</span>
<a href="#l3.10"></a><span id="l3.10">   let childArray = iteratorUtils.toArray(childNodes);</span>
<a href="#l3.11"></a><span id="l3.11">   do_check_eq(childNodes.length, childArray.length);</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-  for (let [i, node] in Iterator(childArray))</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+  for (let [i, node] of childArray.entries())</span>
<a href="#l3.14"></a><span id="l3.14">     do_check_eq(node, childArray[i]);</span>
<a href="#l3.15"></a><span id="l3.15"> }</span>
<a href="#l3.16"></a><span id="l3.16"> </span>
<a href="#l3.17"></a><span id="l3.17"> /**</span>
<a href="#l3.18"></a><span id="l3.18">  * Test that toArray works correctly with a built-in iterator generated by an</span>
<a href="#l3.19"></a><span id="l3.19">  * array.</span>
<a href="#l3.20"></a><span id="l3.20">  */</span>
<a href="#l3.21"></a><span id="l3.21"> function test_toArray_builtin_iterator() {</span>
<a href="#l3.22"></a><span id="l3.22">   let arr = [11, 12, 13, 14, 15, 16, 17, 18, 19, 20];</span>
<a href="#l3.23"></a><span id="l3.23">   let iterator = Iterator(arr);</span>
<a href="#l3.24"></a><span id="l3.24">   // Note that this is going to be an array of [key, value] pairs, as is</span>
<a href="#l3.25"></a><span id="l3.25">   // returned by Iterator for an array</span>
<a href="#l3.26"></a><span id="l3.26">   let iteratorArray = iteratorUtils.toArray(iterator);</span>
<a href="#l3.27"></a><span id="l3.27">   do_check_eq(arr.length, iteratorArray.length);</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineminus">-  for (let [i, val] in Iterator(arr)) {</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineplus">+  for (let [i, val] of arr.entries()) {</span>
<a href="#l3.30"></a><span id="l3.30">     do_check_eq(i, iteratorArray[i][0]);</span>
<a href="#l3.31"></a><span id="l3.31">     do_check_eq(val, iteratorArray[i][1]);</span>
<a href="#l3.32"></a><span id="l3.32">   }</span>
<a href="#l3.33"></a><span id="l3.33"> </span>
<a href="#l3.34"></a><span id="l3.34">   // Bug 1126509, test that toArray rejects unknown objects.</span>
<a href="#l3.35"></a><span id="l3.35">   let thrown = false;</span>
<a href="#l3.36"></a><span id="l3.36">   let tryIterate = { item: &quot;An object, that is not supported by toArray.&quot; };</span>
<a href="#l3.37"></a><span id="l3.37">   try {</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineat">@@ -178,17 +178,17 @@ function test_toArray_custom_iterator() </span>
<a href="#l3.39"></a><span id="l3.39">       // C-style for loop so that we don't confuse ourselves with yet another</span>
<a href="#l3.40"></a><span id="l3.40">       // iterator</span>
<a href="#l3.41"></a><span id="l3.41">       for (let i = 0; i &lt; arr.length; i++)</span>
<a href="#l3.42"></a><span id="l3.42">         yield arr[i];</span>
<a href="#l3.43"></a><span id="l3.43">     },</span>
<a href="#l3.44"></a><span id="l3.44">   };</span>
<a href="#l3.45"></a><span id="l3.45">   let iteratorArray = iteratorUtils.toArray(iterator);</span>
<a href="#l3.46"></a><span id="l3.46">   do_check_eq(arr.length, iteratorArray.length);</span>
<a href="#l3.47"></a><span id="l3.47" class="difflineminus">-  for (let [i, val] in Iterator(arr))</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineplus">+  for (let [i, val] of arr.entries())</span>
<a href="#l3.49"></a><span id="l3.49">     do_check_eq(val, iteratorArray[i]);</span>
<a href="#l3.50"></a><span id="l3.50"> }</span>
<a href="#l3.51"></a><span id="l3.51"> </span>
<a href="#l3.52"></a><span id="l3.52"> var gTests = [</span>
<a href="#l3.53"></a><span id="l3.53">   test_fixIterator,</span>
<a href="#l3.54"></a><span id="l3.54">   test_toArray_NodeList,</span>
<a href="#l3.55"></a><span id="l3.55">   test_toArray_builtin_iterator,</span>
<a href="#l3.56"></a><span id="l3.56">   test_toArray_custom_iterator,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mailnews/base/test/unit/test_nsMsgDBView.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mailnews/base/test/unit/test_nsMsgDBView.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -968,32 +968,32 @@ function run_test() {</span>
<a href="#l4.4"></a><span id="l4.4"> }</span>
<a href="#l4.5"></a><span id="l4.5"> </span>
<a href="#l4.6"></a><span id="l4.6"> function* actually_run_test() {</span>
<a href="#l4.7"></a><span id="l4.7">   dump(&quot;in actually_run_test\n&quot;);</span>
<a href="#l4.8"></a><span id="l4.8">   yield async_run({func: setup_globals});</span>
<a href="#l4.9"></a><span id="l4.9">   dump(&quot;Num Messages: &quot; + gTestFolder.msgDatabase.dBFolderInfo.numMessages + &quot;\n&quot;);</span>
<a href="#l4.10"></a><span id="l4.10"> </span>
<a href="#l4.11"></a><span id="l4.11">   // for each view type...</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-  for (let [, view_type_and_flags] in Iterator(view_types)) {</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+  for (let view_type_and_flags of view_types) {</span>
<a href="#l4.14"></a><span id="l4.14">     let [view_type, view_flags] = view_type_and_flags;</span>
<a href="#l4.15"></a><span id="l4.15">     dump(&quot;===== Testing View Type: &quot; + view_type + &quot; flags: &quot; + view_flags +</span>
<a href="#l4.16"></a><span id="l4.16">          &quot;\n&quot;);</span>
<a href="#l4.17"></a><span id="l4.17"> </span>
<a href="#l4.18"></a><span id="l4.18">     let save_gTestFolder = gTestFolder;</span>
<a href="#l4.19"></a><span id="l4.19">     // ... run each test</span>
<a href="#l4.20"></a><span id="l4.20">     setup_view(view_type, view_flags);</span>
<a href="#l4.21"></a><span id="l4.21"> </span>
<a href="#l4.22"></a><span id="l4.22" class="difflineminus">-    for (let [, testFunc] in Iterator(tests_for_all_views)) {</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineplus">+    for (let testFunc of tests_for_all_views) {</span>
<a href="#l4.24"></a><span id="l4.24">       dump(&quot;=== Running generic test: &quot; + testFunc.name + &quot;\n&quot;);</span>
<a href="#l4.25"></a><span id="l4.25">       yield async_run({func: testFunc});</span>
<a href="#l4.26"></a><span id="l4.26">     }</span>
<a href="#l4.27"></a><span id="l4.27"> </span>
<a href="#l4.28"></a><span id="l4.28">     if (tests_for_specific_views[view_type]) {</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineminus">-      for (let [, testFunc] in Iterator(tests_for_specific_views[view_type])) {</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineplus">+      for (let testFunc of tests_for_specific_views[view_type]) {</span>
<a href="#l4.31"></a><span id="l4.31">         dump(&quot;=== Running view-specific test: &quot; + testFunc.name + &quot;\n&quot;);</span>
<a href="#l4.32"></a><span id="l4.32">         yield async_run({func: testFunc});</span>
<a href="#l4.33"></a><span id="l4.33">       }</span>
<a href="#l4.34"></a><span id="l4.34">     }</span>
<a href="#l4.35"></a><span id="l4.35">     gTestFolder = save_gTestFolder;</span>
<a href="#l4.36"></a><span id="l4.36">   }</span>
<a href="#l4.37"></a><span id="l4.37">   do_test_finished();</span>
<a href="#l4.38"></a><span id="l4.38"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mailnews/db/gloda/components/glautocomp.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mailnews/db/gloda/components/glautocomp.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -341,17 +341,17 @@ ContactIdentityCompleter.prototype = {</span>
<a href="#l5.4"></a><span id="l5.4"> function ContactTagCompleter() {</span>
<a href="#l5.5"></a><span id="l5.5">   FreeTagNoun.populateKnownFreeTags();</span>
<a href="#l5.6"></a><span id="l5.6">   this._buildSuffixTree();</span>
<a href="#l5.7"></a><span id="l5.7">   FreeTagNoun.addListener(this);</span>
<a href="#l5.8"></a><span id="l5.8"> }</span>
<a href="#l5.9"></a><span id="l5.9"> ContactTagCompleter.prototype = {</span>
<a href="#l5.10"></a><span id="l5.10">   _buildSuffixTree: function() {</span>
<a href="#l5.11"></a><span id="l5.11">     let tagNames = [], tags = [];</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-    for (let [tagName, tag] in Iterator(FreeTagNoun.knownFreeTags)) {</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+    for (let [tagName, tag] of Object.entries(FreeTagNoun.knownFreeTags)) {</span>
<a href="#l5.14"></a><span id="l5.14">       tagNames.push(tagName.toLowerCase());</span>
<a href="#l5.15"></a><span id="l5.15">       tags.push(tag);</span>
<a href="#l5.16"></a><span id="l5.16">     }</span>
<a href="#l5.17"></a><span id="l5.17">     this._suffixTree = new MultiSuffixTree(tagNames, tags);</span>
<a href="#l5.18"></a><span id="l5.18">     this._suffixTreeDirty = false;</span>
<a href="#l5.19"></a><span id="l5.19">   },</span>
<a href="#l5.20"></a><span id="l5.20">   onFreeTagAdded: function(aTag) {</span>
<a href="#l5.21"></a><span id="l5.21">     this._suffixTreeDirty = true;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mailnews/db/gloda/modules/collection.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/collection.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -268,17 +268,17 @@ var GlodaCollectionManager = {</span>
<a href="#l6.4"></a><span id="l6.4">         unresolvedIndexToItem[iItem] = aItems[iItem];</span>
<a href="#l6.5"></a><span id="l6.5">       }</span>
<a href="#l6.6"></a><span id="l6.6">       numUnresolved = aItems.length;</span>
<a href="#l6.7"></a><span id="l6.7">     }</span>
<a href="#l6.8"></a><span id="l6.8"> </span>
<a href="#l6.9"></a><span id="l6.9">     let needToCache = [];</span>
<a href="#l6.10"></a><span id="l6.10">     // next, let's fall back to our collections</span>
<a href="#l6.11"></a><span id="l6.11">     for (let collection of this.getCollectionsForNounID(aNounID)) {</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-      for (let [iItem, item] in Iterator(unresolvedIndexToItem)) {</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+      for (let [iItem, item] of Object.entries(unresolvedIndexToItem)) {</span>
<a href="#l6.14"></a><span id="l6.14">         if (item.id in collection._idMap) {</span>
<a href="#l6.15"></a><span id="l6.15">           let realItem = collection._idMap[item.id];</span>
<a href="#l6.16"></a><span id="l6.16">           // update the caller's array to now have the 'real' object</span>
<a href="#l6.17"></a><span id="l6.17">           aItems[iItem] = realItem;</span>
<a href="#l6.18"></a><span id="l6.18">           // flag that we need to cache this guy (we use an inclusive cache)</span>
<a href="#l6.19"></a><span id="l6.19">           needToCache.push(realItem);</span>
<a href="#l6.20"></a><span id="l6.20">           // we no longer need to resolve this item...</span>
<a href="#l6.21"></a><span id="l6.21">           delete unresolvedIndexToItem[iItem];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mailnews/db/gloda/modules/datamodel.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/datamodel.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -149,17 +149,17 @@ var GlodaHasAttributesMixIn = {</span>
<a href="#l7.4"></a><span id="l7.4">       if (this[attrName])</span>
<a href="#l7.5"></a><span id="l7.5">         aDomNode.setAttribute(attr.domExpose, this[attrName]);</span>
<a href="#l7.6"></a><span id="l7.6">     }</span>
<a href="#l7.7"></a><span id="l7.7">   },</span>
<a href="#l7.8"></a><span id="l7.8"> };</span>
<a href="#l7.9"></a><span id="l7.9"> </span>
<a href="#l7.10"></a><span id="l7.10"> function MixIn(aConstructor, aMixIn) {</span>
<a href="#l7.11"></a><span id="l7.11">   let proto = aConstructor.prototype;</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-  for (let [name, func] in Iterator(aMixIn)) {</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+  for (let [name, func] of Object.entries(aMixIn)) {</span>
<a href="#l7.14"></a><span id="l7.14">     if (name.startsWith(&quot;get_&quot;))</span>
<a href="#l7.15"></a><span id="l7.15">       proto.__defineGetter__(name.substring(4), func);</span>
<a href="#l7.16"></a><span id="l7.16">     else</span>
<a href="#l7.17"></a><span id="l7.17">       proto[name] = func;</span>
<a href="#l7.18"></a><span id="l7.18">   }</span>
<a href="#l7.19"></a><span id="l7.19"> }</span>
<a href="#l7.20"></a><span id="l7.20"> </span>
<a href="#l7.21"></a><span id="l7.21"> /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mailnews/db/gloda/modules/datastore.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/datastore.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -107,17 +107,17 @@ var QueryFromQueryResolver = {</span>
<a href="#l8.4"></a><span id="l8.4">       return;</span>
<a href="#l8.5"></a><span id="l8.5">     }</span>
<a href="#l8.6"></a><span id="l8.6"> </span>
<a href="#l8.7"></a><span id="l8.7">     let referencesByNounID = originColl.masterCollection.referencesByNounID;</span>
<a href="#l8.8"></a><span id="l8.8">     let inverseReferencesByNounID =</span>
<a href="#l8.9"></a><span id="l8.9">       originColl.masterCollection.inverseReferencesByNounID;</span>
<a href="#l8.10"></a><span id="l8.10"> </span>
<a href="#l8.11"></a><span id="l8.11">     if (originColl.pendingItems) {</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-      for (let [, item] in Iterator(originColl.pendingItems)) {</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+      for (let item of originColl.pendingItems) {</span>
<a href="#l8.14"></a><span id="l8.14">         //QFQ_LOG.debug(&quot;QFQR: loading deferred &quot; + item.NOUN_ID + &quot;:&quot; + item.id);</span>
<a href="#l8.15"></a><span id="l8.15">         GlodaDatastore.loadNounDeferredDeps(item, referencesByNounID,</span>
<a href="#l8.16"></a><span id="l8.16">             inverseReferencesByNounID);</span>
<a href="#l8.17"></a><span id="l8.17">       }</span>
<a href="#l8.18"></a><span id="l8.18"> </span>
<a href="#l8.19"></a><span id="l8.19">       // we need to consider the possibility that we are racing a collection very</span>
<a href="#l8.20"></a><span id="l8.20">       //  much like our own.  as such, this means we need to perform cache</span>
<a href="#l8.21"></a><span id="l8.21">       //  unification as our last step.</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineat">@@ -209,18 +209,17 @@ QueryFromQueryCallback.prototype = {</span>
<a href="#l8.23"></a><span id="l8.23">       let pendingIdMap = this.collection._pendingIdMap;</span>
<a href="#l8.24"></a><span id="l8.24">       let row;</span>
<a href="#l8.25"></a><span id="l8.25">       let nounDef = this.nounDef;</span>
<a href="#l8.26"></a><span id="l8.26">       let nounID = nounDef.id;</span>
<a href="#l8.27"></a><span id="l8.27">       while ((row = aResultSet.getNextRow())) {</span>
<a href="#l8.28"></a><span id="l8.28">         let item = nounDef.objFromRow.call(nounDef.datastore, row);</span>
<a href="#l8.29"></a><span id="l8.29">         if (this.collection.stashedColumns) {</span>
<a href="#l8.30"></a><span id="l8.30">           let stashed = this.collection.stashedColumns[item.id] = [];</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineminus">-          for (let [,iCol] in</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineminus">-               Iterator(this.collection.query.options.stashColumns)) {</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineplus">+          for (let iCol of this.collection.query.options.stashColumns) {</span>
<a href="#l8.34"></a><span id="l8.34">             stashed.push(GlodaDatastore._getVariant(row, iCol));</span>
<a href="#l8.35"></a><span id="l8.35">           }</span>
<a href="#l8.36"></a><span id="l8.36">         }</span>
<a href="#l8.37"></a><span id="l8.37">         // try and replace the item with one from the cache, if we can</span>
<a href="#l8.38"></a><span id="l8.38">         let cachedItem = GlodaCollectionManager.cacheLookupOne(nounID, item.id,</span>
<a href="#l8.39"></a><span id="l8.39">                                                                false);</span>
<a href="#l8.40"></a><span id="l8.40"> </span>
<a href="#l8.41"></a><span id="l8.41">         // if we already have a copy in the pending id map, skip it</span>
<a href="#l8.42"></a><span id="l8.42" class="difflineat">@@ -3488,17 +3487,17 @@ var GlodaDatastore = {</span>
<a href="#l8.43"></a><span id="l8.43">       sqlString = aQuery.options.explicitSQL;</span>
<a href="#l8.44"></a><span id="l8.44"> </span>
<a href="#l8.45"></a><span id="l8.45">     if (aQuery.options.outerWrapColumns)</span>
<a href="#l8.46"></a><span id="l8.46">       sqlString = &quot;SELECT *, &quot; + aQuery.options.outerWrapColumns.join(&quot;, &quot;) +</span>
<a href="#l8.47"></a><span id="l8.47">                   &quot; FROM (&quot; + sqlString + &quot;)&quot;;</span>
<a href="#l8.48"></a><span id="l8.48"> </span>
<a href="#l8.49"></a><span id="l8.49">     if (aQuery._order.length) {</span>
<a href="#l8.50"></a><span id="l8.50">       let orderClauses = [];</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineminus">-      for (let [, colName] in Iterator(aQuery._order)) {</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineplus">+      for (let colName of aQuery._order) {</span>
<a href="#l8.53"></a><span id="l8.53">          if (colName.startsWith(&quot;-&quot;))</span>
<a href="#l8.54"></a><span id="l8.54">            orderClauses.push(colName.substring(1) + &quot; DESC&quot;);</span>
<a href="#l8.55"></a><span id="l8.55">          else</span>
<a href="#l8.56"></a><span id="l8.56">            orderClauses.push(colName + &quot; ASC&quot;);</span>
<a href="#l8.57"></a><span id="l8.57">       }</span>
<a href="#l8.58"></a><span id="l8.58">       sqlString += &quot; ORDER BY &quot; + orderClauses.join(&quot;, &quot;);</span>
<a href="#l8.59"></a><span id="l8.59">     }</span>
<a href="#l8.60"></a><span id="l8.60"> </span>
<a href="#l8.61"></a><span id="l8.61" class="difflineat">@@ -3526,17 +3525,17 @@ var GlodaDatastore = {</span>
<a href="#l8.62"></a><span id="l8.62">     return this._queryFromSQLString(sqlString, boundArgs, nounDef, aQuery,</span>
<a href="#l8.63"></a><span id="l8.63">         aListener, aListenerData, aExistingCollection, aMasterCollection);</span>
<a href="#l8.64"></a><span id="l8.64">   },</span>
<a href="#l8.65"></a><span id="l8.65"> </span>
<a href="#l8.66"></a><span id="l8.66">   _queryFromSQLString: function gloda_ds__queryFromSQLString(aSqlString,</span>
<a href="#l8.67"></a><span id="l8.67">       aBoundArgs, aNounDef, aQuery, aListener, aListenerData,</span>
<a href="#l8.68"></a><span id="l8.68">       aExistingCollection, aMasterCollection) {</span>
<a href="#l8.69"></a><span id="l8.69">     let statement = this._createAsyncStatement(aSqlString, true);</span>
<a href="#l8.70"></a><span id="l8.70" class="difflineminus">-    for (let [iBinding, bindingValue] in Iterator(aBoundArgs)) {</span>
<a href="#l8.71"></a><span id="l8.71" class="difflineplus">+    for (let [iBinding, bindingValue] of aBoundArgs.entries()) {</span>
<a href="#l8.72"></a><span id="l8.72">       this._bindVariant(statement, iBinding, bindingValue);</span>
<a href="#l8.73"></a><span id="l8.73">     }</span>
<a href="#l8.74"></a><span id="l8.74"> </span>
<a href="#l8.75"></a><span id="l8.75">     let collection;</span>
<a href="#l8.76"></a><span id="l8.76">     if (aExistingCollection)</span>
<a href="#l8.77"></a><span id="l8.77">       collection = aExistingCollection;</span>
<a href="#l8.78"></a><span id="l8.78">     else {</span>
<a href="#l8.79"></a><span id="l8.79">       collection = new GlodaCollection(aNounDef, [], aQuery, aListener,</span>
<a href="#l8.80"></a><span id="l8.80" class="difflineat">@@ -3727,17 +3726,17 @@ var GlodaDatastore = {</span>
<a href="#l8.81"></a><span id="l8.81">       return;</span>
<a href="#l8.82"></a><span id="l8.82"> </span>
<a href="#l8.83"></a><span id="l8.83">     //this._log.debug(&quot;  loading deferred, deps: &quot; +</span>
<a href="#l8.84"></a><span id="l8.84">     //    Log4Moz.enumerateProperties(aItem._deps).join(&quot;,&quot;));</span>
<a href="#l8.85"></a><span id="l8.85"> </span>
<a href="#l8.86"></a><span id="l8.86"> </span>
<a href="#l8.87"></a><span id="l8.87">     let attribIDToDBDefAndParam = this._attributeIDToDBDefAndParam;</span>
<a href="#l8.88"></a><span id="l8.88"> </span>
<a href="#l8.89"></a><span id="l8.89" class="difflineminus">-    for (let [attribId, jsonValue] in Iterator(aItem._deps)) {</span>
<a href="#l8.90"></a><span id="l8.90" class="difflineplus">+    for (let [attribId, jsonValue] of Object.entries(aItem._deps)) {</span>
<a href="#l8.91"></a><span id="l8.91">       let dbAttrib = attribIDToDBDefAndParam[attribId][0];</span>
<a href="#l8.92"></a><span id="l8.92">       let attrib = dbAttrib.attrDef;</span>
<a href="#l8.93"></a><span id="l8.93"> </span>
<a href="#l8.94"></a><span id="l8.94">       let objectNounDef = attrib.objectNounDef;</span>
<a href="#l8.95"></a><span id="l8.95">       let references = aReferencesByNounID[objectNounDef.id];</span>
<a href="#l8.96"></a><span id="l8.96">       if (attrib.special) {</span>
<a href="#l8.97"></a><span id="l8.97">         if (attrib.special === this.kSpecialColumnChildren) {</span>
<a href="#l8.98"></a><span id="l8.98">           let inverseReferences = aInverseReferencesByNounID[objectNounDef.id];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/db/gloda/modules/fundattr.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/fundattr.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -776,20 +776,20 @@ var GlodaFundAttr = {</span>
<a href="#l9.4"></a><span id="l9.4">     if (authorIdentity.id in Gloda.myIdentities)</span>
<a href="#l9.5"></a><span id="l9.5">       score += this.NOTABILITY_FROM_ME;</span>
<a href="#l9.6"></a><span id="l9.6">     else if (authorIdentity.inAddressBook)</span>
<a href="#l9.7"></a><span id="l9.7">       score += this.NOTABILITY_FROM_IN_ADDR_BOOK;</span>
<a href="#l9.8"></a><span id="l9.8">     if (aMessage.toMe)</span>
<a href="#l9.9"></a><span id="l9.9">       score += this.NOTABILITY_INVOLVING_ME;</span>
<a href="#l9.10"></a><span id="l9.10"> </span>
<a href="#l9.11"></a><span id="l9.11">     let involvedAddrBookCount = 0;</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    for (let [, identity] in Iterator(aMessage.to))</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+    for (let identity of aMessage.to)</span>
<a href="#l9.14"></a><span id="l9.14">       if (identity.inAddressBook)</span>
<a href="#l9.15"></a><span id="l9.15">         involvedAddrBookCount++;</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineminus">-    for (let [, identity] in Iterator(aMessage.cc))</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineplus">+    for (let identity of aMessage.cc)</span>
<a href="#l9.18"></a><span id="l9.18">       if (identity.inAddressBook)</span>
<a href="#l9.19"></a><span id="l9.19">         involvedAddrBookCount++;</span>
<a href="#l9.20"></a><span id="l9.20">     if (involvedAddrBookCount)</span>
<a href="#l9.21"></a><span id="l9.21">       score += this.NOTABILITY_INVOLVING_ADDR_BOOK_FIRST +</span>
<a href="#l9.22"></a><span id="l9.22">         (involvedAddrBookCount - 1) * this.NOTABILITY_INVOLVING_ADDR_BOOK_ADDL;</span>
<a href="#l9.23"></a><span id="l9.23">     return score;</span>
<a href="#l9.24"></a><span id="l9.24">   },</span>
<a href="#l9.25"></a><span id="l9.25"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/db/gloda/modules/gloda.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/db/gloda/modules/gloda.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -2049,17 +2049,17 @@ var Gloda = {</span>
<a href="#l10.4"></a><span id="l10.4">           jsonDict[attrib.id] = objectNounDef.toJSON(value);</span>
<a href="#l10.5"></a><span id="l10.5">         else</span>
<a href="#l10.6"></a><span id="l10.6">           jsonDict[attrib.id] = value;</span>
<a href="#l10.7"></a><span id="l10.7">       }</span>
<a href="#l10.8"></a><span id="l10.8">       else {</span>
<a href="#l10.9"></a><span id="l10.9">         if (objectNounDef.toJSON) {</span>
<a href="#l10.10"></a><span id="l10.10">           let toJSON = objectNounDef.toJSON;</span>
<a href="#l10.11"></a><span id="l10.11">           jsonDict[attrib.id] = [];</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-          for (let [, subValue] in Iterator(value)) {</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+          for (let subValue of value) {</span>
<a href="#l10.14"></a><span id="l10.14">             jsonDict[attrib.id].push(toJSON(subValue));</span>
<a href="#l10.15"></a><span id="l10.15">           }</span>
<a href="#l10.16"></a><span id="l10.16">         }</span>
<a href="#l10.17"></a><span id="l10.17">         else</span>
<a href="#l10.18"></a><span id="l10.18">           jsonDict[attrib.id] = value;</span>
<a href="#l10.19"></a><span id="l10.19">       }</span>
<a href="#l10.20"></a><span id="l10.20"> </span>
<a href="#l10.21"></a><span id="l10.21">       let oldValue = aOldItem[key];</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineat">@@ -2256,17 +2256,17 @@ var Gloda = {</span>
<a href="#l10.23"></a><span id="l10.23">     for (let item of aItems) {</span>
<a href="#l10.24"></a><span id="l10.24">       let score = 0;</span>
<a href="#l10.25"></a><span id="l10.25">       let attrProviders = this._attrProviderOrderByNoun[itemNounDef.id];</span>
<a href="#l10.26"></a><span id="l10.26">       for (let iProvider = 0; iProvider &lt; attrProviders.length; iProvider++) {</span>
<a href="#l10.27"></a><span id="l10.27">         let provider = attrProviders[iProvider];</span>
<a href="#l10.28"></a><span id="l10.28">         if (provider.score)</span>
<a href="#l10.29"></a><span id="l10.29">           score += provider.score(item);</span>
<a href="#l10.30"></a><span id="l10.30">       }</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineminus">-      for (let [, extraScoreFunc] in Iterator(aExtraScoreFuncs))</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+      for (let extraScoreFunc of aExtraScoreFuncs)</span>
<a href="#l10.33"></a><span id="l10.33">         score += extraScoreFunc(item, aContext);</span>
<a href="#l10.34"></a><span id="l10.34">       scores.push(score);</span>
<a href="#l10.35"></a><span id="l10.35">     }</span>
<a href="#l10.36"></a><span id="l10.36"> </span>
<a href="#l10.37"></a><span id="l10.37">     return scores;</span>
<a href="#l10.38"></a><span id="l10.38">   }</span>
<a href="#l10.39"></a><span id="l10.39"> };</span>
<a href="#l10.40"></a><span id="l10.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/db/gloda/test/unit/resources/genericIndexer.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/db/gloda/test/unit/resources/genericIndexer.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -31,17 +31,17 @@ var GenericIndexer = {</span>
<a href="#l11.4"></a><span id="l11.4">       &quot; generic objects with id: &quot; + aObjects[0].NOUN_ID);</span>
<a href="#l11.5"></a><span id="l11.5">     GlodaIndexer.indexJob(new IndexingJob(&quot;generic&quot;, null,</span>
<a href="#l11.6"></a><span id="l11.6">                                           aObjects.concat()));</span>
<a href="#l11.7"></a><span id="l11.7">   },</span>
<a href="#l11.8"></a><span id="l11.8">   /* implementation */</span>
<a href="#l11.9"></a><span id="l11.9">   _worker_index_generic: function*(aJob, aCallbackHandle) {</span>
<a href="#l11.10"></a><span id="l11.10">     this._log.debug(&quot;Beginning indexing &quot; + aJob.items.length +</span>
<a href="#l11.11"></a><span id="l11.11">                     &quot; generic items&quot;);</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-    for (let [, item] in Iterator(aJob.items)) {</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+    for (let item of aJob.items) {</span>
<a href="#l11.14"></a><span id="l11.14">       this._log.debug(&quot;Indexing: &quot; + item);</span>
<a href="#l11.15"></a><span id="l11.15">       yield aCallbackHandle.pushAndGo(</span>
<a href="#l11.16"></a><span id="l11.16">         Gloda.grokNounItem(item, {},</span>
<a href="#l11.17"></a><span id="l11.17">                            item.id === undefined, item.id === undefined,</span>
<a href="#l11.18"></a><span id="l11.18">                            aCallbackHandle,</span>
<a href="#l11.19"></a><span id="l11.19">                            item.NOUN_DEF.cache));</span>
<a href="#l11.20"></a><span id="l11.20">       item._stash();</span>
<a href="#l11.21"></a><span id="l11.21">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/db/gloda/test/unit/test_fts3_tokenizer.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/db/gloda/test/unit/test_fts3_tokenizer.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -168,17 +168,17 @@ function msgSearchExpectCount(aCount, aF</span>
<a href="#l12.4"></a><span id="l12.4">     sql = aSql</span>
<a href="#l12.5"></a><span id="l12.5">     args = aArgs;</span>
<a href="#l12.6"></a><span id="l12.6">   };</span>
<a href="#l12.7"></a><span id="l12.7">   query.getCollection();</span>
<a href="#l12.8"></a><span id="l12.8">   GlodaDatastore._queryFromSQLString = oldFunc;</span>
<a href="#l12.9"></a><span id="l12.9"> </span>
<a href="#l12.10"></a><span id="l12.10">   // Bind the parameters</span>
<a href="#l12.11"></a><span id="l12.11">   let stmt = conn.createStatement(sql);</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  for (let [iBinding, bindingValue] in Iterator(args)) {</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+  for (let [iBinding, bindingValue] of args.entries()) {</span>
<a href="#l12.14"></a><span id="l12.14">     GlodaDatastore._bindVariant(stmt, iBinding, bindingValue);</span>
<a href="#l12.15"></a><span id="l12.15">   }</span>
<a href="#l12.16"></a><span id="l12.16"> </span>
<a href="#l12.17"></a><span id="l12.17">   let i = 0;</span>
<a href="#l12.18"></a><span id="l12.18">   stmt.executeAsync({</span>
<a href="#l12.19"></a><span id="l12.19">     handleResult: function(aResultSet) {</span>
<a href="#l12.20"></a><span id="l12.20">       for (let row = aResultSet.getNextRow();</span>
<a href="#l12.21"></a><span id="l12.21">            row;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/mime/test/unit/test_message_attachment.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/mime/test/unit/test_message_attachment.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -70,17 +70,17 @@ var gStreamListener = {</span>
<a href="#l13.4"></a><span id="l13.4">     this.contents = &quot;&quot;;</span>
<a href="#l13.5"></a><span id="l13.5">     this.stream = null;</span>
<a href="#l13.6"></a><span id="l13.6">   },</span>
<a href="#l13.7"></a><span id="l13.7">   onStopRequest: function (aRequest, aContext, aStatusCode) {</span>
<a href="#l13.8"></a><span id="l13.8">     // Check that the attachments' filenames are as expected. Just use a regex</span>
<a href="#l13.9"></a><span id="l13.9">     // here because it's simple.</span>
<a href="#l13.10"></a><span id="l13.10">     let regex = /&lt;legend class=&quot;mimeAttachmentHeaderName&quot;&gt;(.*?)&lt;\/legend&gt;/gi;</span>
<a href="#l13.11"></a><span id="l13.11"> </span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-    for (let [,attachment] in Iterator(messages[this.index].attachments)) {</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+    for (let attachment of messages[this.index].attachments) {</span>
<a href="#l13.14"></a><span id="l13.14">       let match = regex.exec(this.contents);</span>
<a href="#l13.15"></a><span id="l13.15">       do_check_neq(match, null);</span>
<a href="#l13.16"></a><span id="l13.16">       do_check_eq(match[1], attachment.expectedFilename || attachment.filename);</span>
<a href="#l13.17"></a><span id="l13.17">     }</span>
<a href="#l13.18"></a><span id="l13.18">     do_check_eq(regex.exec(this.contents), null);</span>
<a href="#l13.19"></a><span id="l13.19"> </span>
<a href="#l13.20"></a><span id="l13.20">     this.index++;</span>
<a href="#l13.21"></a><span id="l13.21">     async_driver();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/test/resources/mailTestUtils.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/test/resources/mailTestUtils.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -471,17 +471,17 @@ var mailTestUtils = {</span>
<a href="#l14.4"></a><span id="l14.4">     if (!aSomeoneElseWillTriggerTheUpdate)</span>
<a href="#l14.5"></a><span id="l14.5">       aFolder.updateFolder(null);</span>
<a href="#l14.6"></a><span id="l14.6">   },</span>
<a href="#l14.7"></a><span id="l14.7"> </span>
<a href="#l14.8"></a><span id="l14.8">   /**</span>
<a href="#l14.9"></a><span id="l14.9">    * For when you want to compare elements non-strictly.</span>
<a href="#l14.10"></a><span id="l14.10">    */</span>
<a href="#l14.11"></a><span id="l14.11">   non_strict_index_of: function(aArray, aElem) {</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-    for (let [i, elem] in Iterator(aArray)) {</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+    for (let [i, elem] of aArray.entries()) {</span>
<a href="#l14.14"></a><span id="l14.14">       if (elem == aElem)</span>
<a href="#l14.15"></a><span id="l14.15">         return i;</span>
<a href="#l14.16"></a><span id="l14.16">     }</span>
<a href="#l14.17"></a><span id="l14.17">     return -1;</span>
<a href="#l14.18"></a><span id="l14.18">   },</span>
<a href="#l14.19"></a><span id="l14.19"> </span>
<a href="#l14.20"></a><span id="l14.20">   /**</span>
<a href="#l14.21"></a><span id="l14.21">    * Registers a directory provider for UMimTyp for when its needed.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/test/resources/messageGenerator.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/test/resources/messageGenerator.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -98,17 +98,17 @@ SyntheticPart.prototype = {</span>
<a href="#l15.4"></a><span id="l15.4">     let s = this._contentType;</span>
<a href="#l15.5"></a><span id="l15.5">     if (this._charset)</span>
<a href="#l15.6"></a><span id="l15.6">       s += '; charset=' + this._charset;</span>
<a href="#l15.7"></a><span id="l15.7">     if (this._format)</span>
<a href="#l15.8"></a><span id="l15.8">       s += '; format=' + this._format;</span>
<a href="#l15.9"></a><span id="l15.9">     if (this._filename)</span>
<a href="#l15.10"></a><span id="l15.10">       s += ';\r\n name=&quot;' + this._filename +'&quot;';</span>
<a href="#l15.11"></a><span id="l15.11">     if (this._contentTypeExtra) {</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-      for (let [key, value] in Iterator(this._contentTypeExtra))</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+      for (let [key, value] of Object.entries(this._contentTypeExtra))</span>
<a href="#l15.14"></a><span id="l15.14">         s += ';\r\n ' + key + '=&quot;' + value + '&quot;';</span>
<a href="#l15.15"></a><span id="l15.15">     }</span>
<a href="#l15.16"></a><span id="l15.16">     if (this._boundary)</span>
<a href="#l15.17"></a><span id="l15.17">       s += ';\r\n boundary=&quot;' + this._boundary + '&quot;';</span>
<a href="#l15.18"></a><span id="l15.18">     return s;</span>
<a href="#l15.19"></a><span id="l15.19">   },</span>
<a href="#l15.20"></a><span id="l15.20">   get hasTransferEncoding() {</span>
<a href="#l15.21"></a><span id="l15.21">     return this._encoding;</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineat">@@ -187,17 +187,17 @@ function SyntheticPartMulti(aParts, aPro</span>
<a href="#l15.23"></a><span id="l15.23">   this.BOUNDARY_COUNTER_HOME.BOUNDARY_COUNTER += 1;</span>
<a href="#l15.24"></a><span id="l15.24">   this.parts = (aParts != null) ? aParts : [];</span>
<a href="#l15.25"></a><span id="l15.25"> }</span>
<a href="#l15.26"></a><span id="l15.26"> SyntheticPartMulti.prototype = {</span>
<a href="#l15.27"></a><span id="l15.27">   __proto__: SyntheticPart.prototype,</span>
<a href="#l15.28"></a><span id="l15.28">   BOUNDARY_COUNTER: 0,</span>
<a href="#l15.29"></a><span id="l15.29">   toMessageString: function() {</span>
<a href="#l15.30"></a><span id="l15.30">     let s = &quot;This is a multi-part message in MIME format.\r\n&quot;;</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineminus">-    for (let [,part] in Iterator(this.parts)) {</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+    for (let part of this.parts) {</span>
<a href="#l15.33"></a><span id="l15.33">       s += &quot;--&quot; + this._boundary + &quot;\r\n&quot;;</span>
<a href="#l15.34"></a><span id="l15.34">       if (part instanceof SyntheticDegeneratePartEmpty)</span>
<a href="#l15.35"></a><span id="l15.35">         continue;</span>
<a href="#l15.36"></a><span id="l15.36">       s += &quot;Content-Type: &quot; + part.contentTypeHeaderValue + '\r\n';</span>
<a href="#l15.37"></a><span id="l15.37">       if (part.hasTransferEncoding)</span>
<a href="#l15.38"></a><span id="l15.38">         s += 'Content-Transfer-Encoding: ' +</span>
<a href="#l15.39"></a><span id="l15.39">              part.contentTransferEncodingHeaderValue + '\r\n';</span>
<a href="#l15.40"></a><span id="l15.40">       if (part.hasDisposition)</span>
<a href="#l15.41"></a><span id="l15.41" class="difflineat">@@ -650,17 +650,17 @@ SyntheticMessage.prototype = {</span>
<a href="#l15.42"></a><span id="l15.42">  * Write a list of messages to a folder</span>
<a href="#l15.43"></a><span id="l15.43">  *</span>
<a href="#l15.44"></a><span id="l15.44">  * @param aMessages The list of SyntheticMessages instances to write.</span>
<a href="#l15.45"></a><span id="l15.45">  * @param aFolder The folder to write to.</span>
<a href="#l15.46"></a><span id="l15.46">  */</span>
<a href="#l15.47"></a><span id="l15.47"> function addMessagesToFolder (aMessages, aFolder)</span>
<a href="#l15.48"></a><span id="l15.48"> {</span>
<a href="#l15.49"></a><span id="l15.49">   let localFolder = aFolder.QueryInterface(Ci.nsIMsgLocalMailFolder);</span>
<a href="#l15.50"></a><span id="l15.50" class="difflineminus">-  for (let [, message] in Iterator(aMessages))</span>
<a href="#l15.51"></a><span id="l15.51" class="difflineplus">+  for (let message of aMessages)</span>
<a href="#l15.52"></a><span id="l15.52">     localFolder.addMessage(message.toMboxString());</span>
<a href="#l15.53"></a><span id="l15.53"> }</span>
<a href="#l15.54"></a><span id="l15.54"> </span>
<a href="#l15.55"></a><span id="l15.55"> /**</span>
<a href="#l15.56"></a><span id="l15.56">  * Provides mechanisms for creating vaguely interesting, but at least valid,</span>
<a href="#l15.57"></a><span id="l15.57">  *  SyntheticMessage instances.</span>
<a href="#l15.58"></a><span id="l15.58">  */</span>
<a href="#l15.59"></a><span id="l15.59"> function MessageGenerator() {</span>
<a href="#l15.60"></a><span id="l15.60" class="difflineat">@@ -1015,23 +1015,23 @@ MessageGenerator.prototype = {</span>
<a href="#l15.61"></a><span id="l15.61">    */</span>
<a href="#l15.62"></a><span id="l15.62">   makeMessages: function MessageGenerator_makeMessages(aSetDef) {</span>
<a href="#l15.63"></a><span id="l15.63">     let messages = [];</span>
<a href="#l15.64"></a><span id="l15.64"> </span>
<a href="#l15.65"></a><span id="l15.65">     let args = {};</span>
<a href="#l15.66"></a><span id="l15.66">     // zero out all the age_incr fields in age (if present)</span>
<a href="#l15.67"></a><span id="l15.67">     if (aSetDef.age_incr) {</span>
<a href="#l15.68"></a><span id="l15.68">       args.age = {};</span>
<a href="#l15.69"></a><span id="l15.69" class="difflineminus">-      for (let [unit, delta] in Iterator(aSetDef.age_incr))</span>
<a href="#l15.70"></a><span id="l15.70" class="difflineplus">+      for (let [unit, delta] of Object.entries(aSetDef.age_incr))</span>
<a href="#l15.71"></a><span id="l15.71">         args.age[unit] = 0;</span>
<a href="#l15.72"></a><span id="l15.72">     }</span>
<a href="#l15.73"></a><span id="l15.73">     // copy over the initial values from age (if present)</span>
<a href="#l15.74"></a><span id="l15.74">     if (aSetDef.age) {</span>
<a href="#l15.75"></a><span id="l15.75">       args.age = args.age || {};</span>
<a href="#l15.76"></a><span id="l15.76" class="difflineminus">-      for (let [unit, value] in Iterator(aSetDef.age))</span>
<a href="#l15.77"></a><span id="l15.77" class="difflineplus">+      for (let [unit, value] of Object.entries(aSetDef.age))</span>
<a href="#l15.78"></a><span id="l15.78">         args.age[unit] = value;</span>
<a href="#l15.79"></a><span id="l15.79">     }</span>
<a href="#l15.80"></a><span id="l15.80">     // just copy over any attributes found from MAKE_MESSAGES_PROPAGATE</span>
<a href="#l15.81"></a><span id="l15.81">     for (let propAttrName of this.MAKE_MESSAGES_PROPAGATE) {</span>
<a href="#l15.82"></a><span id="l15.82">       if (aSetDef[propAttrName])</span>
<a href="#l15.83"></a><span id="l15.83">         args[propAttrName] = aSetDef[propAttrName];</span>
<a href="#l15.84"></a><span id="l15.84">     }</span>
<a href="#l15.85"></a><span id="l15.85"> </span>
<a href="#l15.86"></a><span id="l15.86" class="difflineat">@@ -1043,17 +1043,17 @@ MessageGenerator.prototype = {</span>
<a href="#l15.87"></a><span id="l15.87">       if (lastMessage &amp;&amp; (iMsg % messagsPerThread != 0))</span>
<a href="#l15.88"></a><span id="l15.88">         args.inReplyTo = lastMessage;</span>
<a href="#l15.89"></a><span id="l15.89">       else if (!(&quot;inReplyTo&quot; in aSetDef))</span>
<a href="#l15.90"></a><span id="l15.90">         args.inReplyTo = null;</span>
<a href="#l15.91"></a><span id="l15.91">       lastMessage = this.makeMessage(args);</span>
<a href="#l15.92"></a><span id="l15.92">       messages.push(lastMessage);</span>
<a href="#l15.93"></a><span id="l15.93"> </span>
<a href="#l15.94"></a><span id="l15.94">       if (aSetDef.age_incr) {</span>
<a href="#l15.95"></a><span id="l15.95" class="difflineminus">-        for (let [unit, delta] in Iterator(aSetDef.age_incr))</span>
<a href="#l15.96"></a><span id="l15.96" class="difflineplus">+        for (let [unit, delta] of Object.entries(aSetDef.age_incr))</span>
<a href="#l15.97"></a><span id="l15.97">           args.age[unit] += delta;</span>
<a href="#l15.98"></a><span id="l15.98">       }</span>
<a href="#l15.99"></a><span id="l15.99">     }</span>
<a href="#l15.100"></a><span id="l15.100"> </span>
<a href="#l15.101"></a><span id="l15.101">     return messages;</span>
<a href="#l15.102"></a><span id="l15.102">   },</span>
<a href="#l15.103"></a><span id="l15.103"> };</span>
<a href="#l15.104"></a><span id="l15.104"> </span>
<a href="#l15.105"></a><span id="l15.105" class="difflineat">@@ -1138,17 +1138,17 @@ MessageScenarioFactory.prototype = {</span>
<a href="#l15.106"></a><span id="l15.106">  *  because we are using a getter and 'this' in js always refers to the object</span>
<a href="#l15.107"></a><span id="l15.107">  *  in question (never any part of its prototype chain).  As such, you probably</span>
<a href="#l15.108"></a><span id="l15.108">  *  want to invoke us on your prototype object(s).</span>
<a href="#l15.109"></a><span id="l15.109">  *</span>
<a href="#l15.110"></a><span id="l15.110">  * @param The object on whom we want to perform magic binding.  This should</span>
<a href="#l15.111"></a><span id="l15.111">  *     probably be your prototype object.</span>
<a href="#l15.112"></a><span id="l15.112">  */</span>
<a href="#l15.113"></a><span id="l15.113"> function bindMethods(aObj) {</span>
<a href="#l15.114"></a><span id="l15.114" class="difflineminus">-  for (let [name, ubfunc] in Iterator(aObj)) {</span>
<a href="#l15.115"></a><span id="l15.115" class="difflineplus">+  for (let [name, ubfunc] of Object.entries(aObj)) {</span>
<a href="#l15.116"></a><span id="l15.116">     // the variable binding needs to get captured...</span>
<a href="#l15.117"></a><span id="l15.117">     let realFunc = ubfunc;</span>
<a href="#l15.118"></a><span id="l15.118">     delete aObj[name];</span>
<a href="#l15.119"></a><span id="l15.119">     Object.defineProperty(aObj, name, {</span>
<a href="#l15.120"></a><span id="l15.120">       get: function getterFunc() {</span>
<a href="#l15.121"></a><span id="l15.121"> 	return realFunc.bind(this);</span>
<a href="#l15.122"></a><span id="l15.122">       }</span>
<a href="#l15.123"></a><span id="l15.123">     });</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/test/resources/messageModifier.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/test/resources/messageModifier.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -122,17 +122,17 @@ SyntheticMessageSet.prototype = {</span>
<a href="#l16.4"></a><span id="l16.4"> </span>
<a href="#l16.5"></a><span id="l16.5">   /**</span>
<a href="#l16.6"></a><span id="l16.6">    * @return a JS iterator of the message headers for all messages inserted into</span>
<a href="#l16.7"></a><span id="l16.7">    *     a folder.</span>
<a href="#l16.8"></a><span id="l16.8">    */</span>
<a href="#l16.9"></a><span id="l16.9">   msgHdrs: function*() {</span>
<a href="#l16.10"></a><span id="l16.10">     // get the databases</span>
<a href="#l16.11"></a><span id="l16.11">     let msgDatabases = this.msgFolders.map(folder =&gt; folder.msgDatabase);</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-    for (let [iMsg, synMsg] in Iterator(this.synMessages)) {</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+    for (let [iMsg, synMsg] of this.synMessages.entries()) {</span>
<a href="#l16.14"></a><span id="l16.14">       let folderIndex = this.folderIndices[iMsg];</span>
<a href="#l16.15"></a><span id="l16.15">       if (folderIndex != null)</span>
<a href="#l16.16"></a><span id="l16.16">         yield msgDatabases[folderIndex].getMsgHdrForMessageID(synMsg.messageId);</span>
<a href="#l16.17"></a><span id="l16.17">     }</span>
<a href="#l16.18"></a><span id="l16.18">   },</span>
<a href="#l16.19"></a><span id="l16.19">   /**</span>
<a href="#l16.20"></a><span id="l16.20">    * @return a JS list of the message headers for all messages inserted into a</span>
<a href="#l16.21"></a><span id="l16.21">    *     folder.</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineat">@@ -150,17 +150,17 @@ SyntheticMessageSet.prototype = {</span>
<a href="#l16.23"></a><span id="l16.23">   },</span>
<a href="#l16.24"></a><span id="l16.24">   /**</span>
<a href="#l16.25"></a><span id="l16.25">    * @return a list where each item is a list with two elements; the first is</span>
<a href="#l16.26"></a><span id="l16.26">    *     an nsIMsgFolder, and the second is a list of all of the nsIMsgDBHdrs</span>
<a href="#l16.27"></a><span id="l16.27">    *     for the synthetic messages in the set inserted into that folder.</span>
<a href="#l16.28"></a><span id="l16.28">    */</span>
<a href="#l16.29"></a><span id="l16.29">   get foldersWithMsgHdrs() {</span>
<a href="#l16.30"></a><span id="l16.30">     let results = this.msgFolders.map(folder =&gt; [folder, []]);</span>
<a href="#l16.31"></a><span id="l16.31" class="difflineminus">-    for (let [iMsg, synMsg] in Iterator(this.synMessages)) {</span>
<a href="#l16.32"></a><span id="l16.32" class="difflineplus">+    for (let [iMsg, synMsg] of this.synMessages.entries()) {</span>
<a href="#l16.33"></a><span id="l16.33">       let folderIndex = this.folderIndices[iMsg];</span>
<a href="#l16.34"></a><span id="l16.34">       if (folderIndex != null) {</span>
<a href="#l16.35"></a><span id="l16.35">         let [folder, msgHdrs] = results[folderIndex];</span>
<a href="#l16.36"></a><span id="l16.36">         msgHdrs.push(folder.msgDatabase.getMsgHdrForMessageID(synMsg.messageId));</span>
<a href="#l16.37"></a><span id="l16.37">       }</span>
<a href="#l16.38"></a><span id="l16.38">     }</span>
<a href="#l16.39"></a><span id="l16.39">     return results;</span>
<a href="#l16.40"></a><span id="l16.40">   },</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

