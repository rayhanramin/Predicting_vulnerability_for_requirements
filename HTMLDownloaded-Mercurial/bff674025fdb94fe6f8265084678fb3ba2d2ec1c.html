<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 342:bff674025fdb94fe6f8265084678fb3ba2d2ec1c</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ bff674025fdb94fe6f8265084678fb3ba2d2ec1c" />
<meta property="og:url" content="/comm-central/rev/bff674025fdb94fe6f8265084678fb3ba2d2ec1c" />
<meta property="og:description" content="land Magnus' fix for 231654, make delete only apply to folder if no message selected, and put folder name in delete confirmation prompt, r/sr=bienvenu" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / bff674025fdb94fe6f8265084678fb3ba2d2ec1c 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/bff674025fdb94fe6f8265084678fb3ba2d2ec1c">shortlog</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/bff674025fdb94fe6f8265084678fb3ba2d2ec1c">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c">files</a> |
changeset |
<a href="/comm-central/raw-rev/bff674025fdb94fe6f8265084678fb3ba2d2ec1c">raw</a>  | <a href="/comm-central/archive/bff674025fdb94fe6f8265084678fb3ba2d2ec1c.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
land Magnus' fix for 231654, make delete only apply to folder if no message selected, and put folder name in delete confirmation prompt, r/sr=bienvenu
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#68;&#97;&#118;&#105;&#100;&#32;&#66;&#105;&#101;&#110;&#118;&#101;&#110;&#117;&#32;&#60;&#98;&#105;&#101;&#110;&#118;&#101;&#110;&#117;&#64;&#110;&#118;&#101;&#110;&#116;&#117;&#114;&#101;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Tue, 16 Sep 2008 14:36:02 -0700</td></tr>

<tr>
 <td>changeset 342</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/bff674025fdb94fe6f8265084678fb3ba2d2ec1c">bff674025fdb94fe6f8265084678fb3ba2d2ec1c</a></td>
</tr>



<tr>
<td>parent 341</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/190d8aa1c9d73eb4efd8342b200a0e8424d28041">190d8aa1c9d73eb4efd8342b200a0e8424d28041</a>
</td>
</tr>

<tr>
<td>child 343</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/4c8b7768fc76e5669ad68442011c3a73eeef77be">4c8b7768fc76e5669ad68442011c3a73eeef77be</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=bff674025fdb94fe6f8265084678fb3ba2d2ec1c">310</a></td></tr>
<tr><td>push user</td><td>bienvenu@nventure.com</td></tr>
<tr><td>push date</td><td class="date age">Tue, 16 Sep 2008 21:36:12 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@bff674025fdb [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=bff674025fdb94fe6f8265084678fb3ba2d2ec1c">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=bff674025fdb94fe6f8265084678fb3ba2d2ec1c&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=bff674025fdb94fe6f8265084678fb3ba2d2ec1c&newProject=comm-central&newRevision=bff674025fdb94fe6f8265084678fb3ba2d2ec1c&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=bff674025fdb94fe6f8265084678fb3ba2d2ec1c&newProject=comm-central&newRevision=bff674025fdb94fe6f8265084678fb3ba2d2ec1c&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=bff674025fdb94fe6f8265084678fb3ba2d2ec1c&newProject=comm-central&newRevision=bff674025fdb94fe6f8265084678fb3ba2d2ec1c&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>

<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=231654">231654</a></td></tr>




</table></div>

<div class="page_body description">land Magnus' fix for 231654, make delete only apply to folder if no message selected, and put folder name in delete confirmation prompt, r/sr=bienvenu</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/hiddenWindow.js">mail/base/content/hiddenWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/hiddenWindow.js">file</a> |
<a href="/comm-central/annotate/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/hiddenWindow.js">annotate</a> |
<a href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/hiddenWindow.js">diff</a> |
<a href="/comm-central/comparison/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/hiddenWindow.js">comparison</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/hiddenWindow.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mail3PaneWindowCommands.js">mail/base/content/mail3PaneWindowCommands.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mail3PaneWindowCommands.js">file</a> |
<a href="/comm-central/annotate/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mail3PaneWindowCommands.js">annotate</a> |
<a href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mail3PaneWindowCommands.js">diff</a> |
<a href="/comm-central/comparison/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mail3PaneWindowCommands.js">comparison</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mail3PaneWindowCommands.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mailWindowOverlay.js">mail/base/content/mailWindowOverlay.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mailWindowOverlay.js">file</a> |
<a href="/comm-central/annotate/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mailWindowOverlay.js">annotate</a> |
<a href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mailWindowOverlay.js">diff</a> |
<a href="/comm-central/comparison/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mailWindowOverlay.js">comparison</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mailWindowOverlay.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mailWindowOverlay.xul">mail/base/content/mailWindowOverlay.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mailWindowOverlay.xul">file</a> |
<a href="/comm-central/annotate/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mailWindowOverlay.xul">annotate</a> |
<a href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mailWindowOverlay.xul">diff</a> |
<a href="/comm-central/comparison/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mailWindowOverlay.xul">comparison</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/mailWindowOverlay.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/messageWindow.js">mail/base/content/messageWindow.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/messageWindow.js">file</a> |
<a href="/comm-central/annotate/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/messageWindow.js">annotate</a> |
<a href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/messageWindow.js">diff</a> |
<a href="/comm-central/comparison/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/messageWindow.js">comparison</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/base/content/messageWindow.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/imapMsgs.properties">mail/locales/en-US/chrome/messenger/imapMsgs.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/imapMsgs.properties">file</a> |
<a href="/comm-central/annotate/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/imapMsgs.properties">annotate</a> |
<a href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/imapMsgs.properties">diff</a> |
<a href="/comm-central/comparison/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/imapMsgs.properties">comparison</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/imapMsgs.properties">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/localMsgs.properties">mail/locales/en-US/chrome/messenger/localMsgs.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/localMsgs.properties">file</a> |
<a href="/comm-central/annotate/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/localMsgs.properties">annotate</a> |
<a href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/localMsgs.properties">diff</a> |
<a href="/comm-central/comparison/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/localMsgs.properties">comparison</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/localMsgs.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/messenger.dtd">mail/locales/en-US/chrome/messenger/messenger.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/messenger.dtd">file</a> |
<a href="/comm-central/annotate/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/messenger.dtd">annotate</a> |
<a href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/messenger.dtd">diff</a> |
<a href="/comm-central/comparison/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/messenger.dtd">comparison</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mail/locales/en-US/chrome/messenger/messenger.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/imap/src/nsImapMailFolder.cpp">mailnews/imap/src/nsImapMailFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/imap/src/nsImapMailFolder.cpp">file</a> |
<a href="/comm-central/annotate/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/imap/src/nsImapMailFolder.cpp">annotate</a> |
<a href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/imap/src/nsImapMailFolder.cpp">diff</a> |
<a href="/comm-central/comparison/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/imap/src/nsImapMailFolder.cpp">comparison</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/imap/src/nsImapMailFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/imap/src/nsImapStringBundle.h">mailnews/imap/src/nsImapStringBundle.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/imap/src/nsImapStringBundle.h">file</a> |
<a href="/comm-central/annotate/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/imap/src/nsImapStringBundle.h">annotate</a> |
<a href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/imap/src/nsImapStringBundle.h">diff</a> |
<a href="/comm-central/comparison/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/imap/src/nsImapStringBundle.h">comparison</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/imap/src/nsImapStringBundle.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalMailFolder.cpp">mailnews/local/src/nsLocalMailFolder.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalMailFolder.cpp">file</a> |
<a href="/comm-central/annotate/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalMailFolder.cpp">annotate</a> |
<a href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalMailFolder.cpp">diff</a> |
<a href="/comm-central/comparison/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalMailFolder.cpp">comparison</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalMailFolder.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalMailFolder.h">mailnews/local/src/nsLocalMailFolder.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalMailFolder.h">file</a> |
<a href="/comm-central/annotate/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalMailFolder.h">annotate</a> |
<a href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalMailFolder.h">diff</a> |
<a href="/comm-central/comparison/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalMailFolder.h">comparison</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalMailFolder.h">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalStrings.h">mailnews/local/src/nsLocalStrings.h</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalStrings.h">file</a> |
<a href="/comm-central/annotate/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalStrings.h">annotate</a> |
<a href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalStrings.h">diff</a> |
<a href="/comm-central/comparison/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalStrings.h">comparison</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/mailnews/local/src/nsLocalStrings.h">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/suite/locales/en-US/chrome/mailnews/imapMsgs.properties">suite/locales/en-US/chrome/mailnews/imapMsgs.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/suite/locales/en-US/chrome/mailnews/imapMsgs.properties">file</a> |
<a href="/comm-central/annotate/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/suite/locales/en-US/chrome/mailnews/imapMsgs.properties">annotate</a> |
<a href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/suite/locales/en-US/chrome/mailnews/imapMsgs.properties">diff</a> |
<a href="/comm-central/comparison/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/suite/locales/en-US/chrome/mailnews/imapMsgs.properties">comparison</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/suite/locales/en-US/chrome/mailnews/imapMsgs.properties">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/suite/locales/en-US/chrome/mailnews/localMsgs.properties">suite/locales/en-US/chrome/mailnews/localMsgs.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/suite/locales/en-US/chrome/mailnews/localMsgs.properties">file</a> |
<a href="/comm-central/annotate/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/suite/locales/en-US/chrome/mailnews/localMsgs.properties">annotate</a> |
<a href="/comm-central/diff/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/suite/locales/en-US/chrome/mailnews/localMsgs.properties">diff</a> |
<a href="/comm-central/comparison/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/suite/locales/en-US/chrome/mailnews/localMsgs.properties">comparison</a> |
<a href="/comm-central/log/bff674025fdb94fe6f8265084678fb3ba2d2ec1c/suite/locales/en-US/chrome/mailnews/localMsgs.properties">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/base/content/hiddenWindow.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/base/content/hiddenWindow.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -36,17 +36,18 @@</span>
<a href="#l1.4"></a><span id="l1.4"> #</span>
<a href="#l1.5"></a><span id="l1.5"> # ***** END LICENSE BLOCK *****</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7"> function hiddenWindowStartup()</span>
<a href="#l1.8"></a><span id="l1.8"> {</span>
<a href="#l1.9"></a><span id="l1.9">   // Disable menus which are not appropriate</span>
<a href="#l1.10"></a><span id="l1.10">   var disabledItems = ['newNewMsgCmd', 'menu_newFolder', 'newAccountMenuItem', 'menu_close', 'menu_saveAs',</span>
<a href="#l1.11"></a><span id="l1.11">              'menu_saveAsFile', 'menu_newVirtualFolder', 'menu_find', 'menu_findCmd', 'menu_findAgainCmd',</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-             'menu_sendunsentmsgs', 'menu_subscribe', 'menu_renameFolder', 'menu_select',</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+             'menu_sendunsentmsgs', 'menu_subscribe', 'menu_deleteFolder',</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+             'menu_renameFolder', 'menu_select',</span>
<a href="#l1.15"></a><span id="l1.15">              'menu_selectAll', 'menu_selectThread',</span>
<a href="#l1.16"></a><span id="l1.16">              'menu_favoriteFolder', 'menu_properties',</span>
<a href="#l1.17"></a><span id="l1.17">              'menu_Toolbars', 'menu_MessagePaneLayout', 'menu_showMessage', 'menu_FolderViews',</span>
<a href="#l1.18"></a><span id="l1.18">              'viewSortMenu', 'groupBySort', 'viewMessageViewMenu', 'mailviewCharsetMenu',</span>
<a href="#l1.19"></a><span id="l1.19">              'viewMessagesMenu', 'menu_expandAllThreads', 'collapseAllThreads',</span>
<a href="#l1.20"></a><span id="l1.20">              'viewheadersmenu', 'viewBodyMenu', 'viewAttachmentsInlineMenuitem',</span>
<a href="#l1.21"></a><span id="l1.21">              'viewTextSizeMenu', 'menu_textZoomEnlarge', 'menu_textZoomReduce',</span>
<a href="#l1.22"></a><span id="l1.22">              'goNextMenu', 'menu_nextMsg', 'menu_nextUnreadMsg', 'menu_nextUnreadThread',</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/mail/base/content/mail3PaneWindowCommands.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/mail/base/content/mail3PaneWindowCommands.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -45,16 +45,17 @@ var gMessengerBundle = document.getEleme</span>
<a href="#l2.4"></a><span id="l2.4"> var FolderPaneController =</span>
<a href="#l2.5"></a><span id="l2.5"> {</span>
<a href="#l2.6"></a><span id="l2.6">    supportsCommand: function(command)</span>
<a href="#l2.7"></a><span id="l2.7">   {</span>
<a href="#l2.8"></a><span id="l2.8">     switch ( command )</span>
<a href="#l2.9"></a><span id="l2.9">     {</span>
<a href="#l2.10"></a><span id="l2.10">       case &quot;cmd_delete&quot;:</span>
<a href="#l2.11"></a><span id="l2.11">       case &quot;button_delete&quot;:</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+      case &quot;cmd_deleteFolder&quot;:</span>
<a href="#l2.13"></a><span id="l2.13">       case &quot;button_compact&quot;:</span>
<a href="#l2.14"></a><span id="l2.14">       //case &quot;cmd_selectAll&quot;: the folder pane currently only handles single selection</span>
<a href="#l2.15"></a><span id="l2.15">       case &quot;cmd_cut&quot;:</span>
<a href="#l2.16"></a><span id="l2.16">       case &quot;cmd_copy&quot;:</span>
<a href="#l2.17"></a><span id="l2.17">       case &quot;cmd_paste&quot;:</span>
<a href="#l2.18"></a><span id="l2.18">         return true;</span>
<a href="#l2.19"></a><span id="l2.19"> </span>
<a href="#l2.20"></a><span id="l2.20">       default:</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineat">@@ -67,16 +68,22 @@ var FolderPaneController =</span>
<a href="#l2.22"></a><span id="l2.22">     switch ( command )</span>
<a href="#l2.23"></a><span id="l2.23">     {</span>
<a href="#l2.24"></a><span id="l2.24">       case &quot;cmd_cut&quot;:</span>
<a href="#l2.25"></a><span id="l2.25">       case &quot;cmd_copy&quot;:</span>
<a href="#l2.26"></a><span id="l2.26">       case &quot;cmd_paste&quot;:</span>
<a href="#l2.27"></a><span id="l2.27">         return false;</span>
<a href="#l2.28"></a><span id="l2.28">       case &quot;cmd_delete&quot;:</span>
<a href="#l2.29"></a><span id="l2.29">       case &quot;button_delete&quot;:</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineplus">+        // Even if the folder pane has focus, don't do a folder delete if</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineplus">+        // we have a selected message, but do a message delete instead.</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineplus">+        if (GetNumSelectedMessages() != 0)</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineplus">+          return DefaultController.isCommandEnabled(command);</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineplus">+         // else fall through</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineplus">+      case &quot;cmd_deleteFolder&quot;:</span>
<a href="#l2.36"></a><span id="l2.36">         // Make sure the button doesn't show &quot;Undelete&quot; for folders.</span>
<a href="#l2.37"></a><span id="l2.37">         UpdateDeleteToolbarButton();</span>
<a href="#l2.38"></a><span id="l2.38">       case &quot;button_compact&quot;:</span>
<a href="#l2.39"></a><span id="l2.39">       if ( command == &quot;cmd_delete&quot; )</span>
<a href="#l2.40"></a><span id="l2.40">         goSetMenuValue(command, 'valueFolder');</span>
<a href="#l2.41"></a><span id="l2.41">       var folders = GetSelectedMsgFolders();</span>
<a href="#l2.42"></a><span id="l2.42"> </span>
<a href="#l2.43"></a><span id="l2.43">       if (folders.length) {</span>
<a href="#l2.44"></a><span id="l2.44" class="difflineat">@@ -85,19 +92,23 @@ var FolderPaneController =</span>
<a href="#l2.45"></a><span id="l2.45">         var isServer = null;</span>
<a href="#l2.46"></a><span id="l2.46">         var serverType = null;</span>
<a href="#l2.47"></a><span id="l2.47">         try {</span>
<a href="#l2.48"></a><span id="l2.48">           var folder = folders[0];</span>
<a href="#l2.49"></a><span id="l2.49">           specialFolder = getSpecialFolderString(folder);</span>
<a href="#l2.50"></a><span id="l2.50">           isServer = folder.isServer;</span>
<a href="#l2.51"></a><span id="l2.51">           serverType = folder.server.type;</span>
<a href="#l2.52"></a><span id="l2.52">           if (serverType == &quot;nntp&quot;) {</span>
<a href="#l2.53"></a><span id="l2.53" class="difflineminus">-             if ( command == &quot;cmd_delete&quot; ) {</span>
<a href="#l2.54"></a><span id="l2.54" class="difflineminus">-                goSetMenuValue(command, 'valueNewsgroup');</span>
<a href="#l2.55"></a><span id="l2.55" class="difflineminus">-                goSetAccessKey(command, 'valueNewsgroupAccessKey');</span>
<a href="#l2.56"></a><span id="l2.56" class="difflineplus">+            if (command == &quot;cmd_deleteFolder&quot;) {</span>
<a href="#l2.57"></a><span id="l2.57" class="difflineplus">+              // Just disable the command for news.</span>
<a href="#l2.58"></a><span id="l2.58" class="difflineplus">+              return false;</span>
<a href="#l2.59"></a><span id="l2.59" class="difflineplus">+            }</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineplus">+            else if (command == &quot;cmd_delete&quot;) {</span>
<a href="#l2.61"></a><span id="l2.61" class="difflineplus">+              goSetMenuValue(command, 'valueNewsgroup');</span>
<a href="#l2.62"></a><span id="l2.62" class="difflineplus">+              goSetAccessKey(command, 'valueNewsgroupAccessKey');</span>
<a href="#l2.63"></a><span id="l2.63">             }</span>
<a href="#l2.64"></a><span id="l2.64">           }</span>
<a href="#l2.65"></a><span id="l2.65">         }</span>
<a href="#l2.66"></a><span id="l2.66">         catch (ex) {</span>
<a href="#l2.67"></a><span id="l2.67">           //dump(&quot;specialFolder failure: &quot; + ex + &quot;\n&quot;);</span>
<a href="#l2.68"></a><span id="l2.68">         }</span>
<a href="#l2.69"></a><span id="l2.69">         if (specialFolder == &quot;Inbox&quot; || specialFolder == &quot;Trash&quot; || specialFolder == &quot;Drafts&quot; ||</span>
<a href="#l2.70"></a><span id="l2.70">             specialFolder == &quot;Sent&quot; || specialFolder == &quot;Templates&quot; || specialFolder == &quot;Unsent Messages&quot; ||</span>
<a href="#l2.71"></a><span id="l2.71" class="difflineat">@@ -121,16 +132,24 @@ var FolderPaneController =</span>
<a href="#l2.72"></a><span id="l2.72">     // if the user invoked a key short cut then it is possible that we got here for a command which is</span>
<a href="#l2.73"></a><span id="l2.73">     // really disabled. kick out if the command should be disabled.</span>
<a href="#l2.74"></a><span id="l2.74">     if (!this.isCommandEnabled(command)) return;</span>
<a href="#l2.75"></a><span id="l2.75"> </span>
<a href="#l2.76"></a><span id="l2.76">     switch ( command )</span>
<a href="#l2.77"></a><span id="l2.77">     {</span>
<a href="#l2.78"></a><span id="l2.78">       case &quot;cmd_delete&quot;:</span>
<a href="#l2.79"></a><span id="l2.79">       case &quot;button_delete&quot;:</span>
<a href="#l2.80"></a><span id="l2.80" class="difflineplus">+        // Even if the folder pane has focus, don't do a folder delete if</span>
<a href="#l2.81"></a><span id="l2.81" class="difflineplus">+        // we have a selected message, but delete the message instead.</span>
<a href="#l2.82"></a><span id="l2.82" class="difflineplus">+        if (GetNumSelectedMessages() == 0)</span>
<a href="#l2.83"></a><span id="l2.83" class="difflineplus">+          MsgDeleteFolder();</span>
<a href="#l2.84"></a><span id="l2.84" class="difflineplus">+        else</span>
<a href="#l2.85"></a><span id="l2.85" class="difflineplus">+          DefaultController.doCommand(command);</span>
<a href="#l2.86"></a><span id="l2.86" class="difflineplus">+        break;</span>
<a href="#l2.87"></a><span id="l2.87" class="difflineplus">+      case &quot;cmd_deleteFolder&quot;:</span>
<a href="#l2.88"></a><span id="l2.88">         MsgDeleteFolder();</span>
<a href="#l2.89"></a><span id="l2.89">         break;</span>
<a href="#l2.90"></a><span id="l2.90">       case &quot;button_compact&quot;:</span>
<a href="#l2.91"></a><span id="l2.91">         MsgCompactFolder(false);</span>
<a href="#l2.92"></a><span id="l2.92">         break;</span>
<a href="#l2.93"></a><span id="l2.93">     }</span>
<a href="#l2.94"></a><span id="l2.94">   },</span>
<a href="#l2.95"></a><span id="l2.95"> </span>
<a href="#l2.96"></a><span id="l2.96" class="difflineat">@@ -156,16 +175,17 @@ var DefaultController =</span>
<a href="#l2.97"></a><span id="l2.97">       case &quot;button_replyall&quot;:</span>
<a href="#l2.98"></a><span id="l2.98">       case &quot;cmd_forward&quot;:</span>
<a href="#l2.99"></a><span id="l2.99">       case &quot;button_forward&quot;:</span>
<a href="#l2.100"></a><span id="l2.100">       case &quot;cmd_forwardInline&quot;:</span>
<a href="#l2.101"></a><span id="l2.101">       case &quot;cmd_forwardAttachment&quot;:</span>
<a href="#l2.102"></a><span id="l2.102">       case &quot;cmd_editAsNew&quot;:</span>
<a href="#l2.103"></a><span id="l2.103">       case &quot;cmd_createFilterFromMenu&quot;:</span>
<a href="#l2.104"></a><span id="l2.104">       case &quot;cmd_delete&quot;:</span>
<a href="#l2.105"></a><span id="l2.105" class="difflineplus">+      case &quot;cmd_deleteFolder&quot;:</span>
<a href="#l2.106"></a><span id="l2.106">       case &quot;button_delete&quot;:</span>
<a href="#l2.107"></a><span id="l2.107">       case &quot;button_junk&quot;:</span>
<a href="#l2.108"></a><span id="l2.108">       case &quot;cmd_shiftDelete&quot;:</span>
<a href="#l2.109"></a><span id="l2.109">       case &quot;cmd_nextMsg&quot;:</span>
<a href="#l2.110"></a><span id="l2.110">       case &quot;button_next&quot;:</span>
<a href="#l2.111"></a><span id="l2.111">       case &quot;button_previous&quot;:</span>
<a href="#l2.112"></a><span id="l2.112">       case &quot;cmd_nextUnreadMsg&quot;:</span>
<a href="#l2.113"></a><span id="l2.113">       case &quot;cmd_nextFlaggedMsg&quot;:</span>
<a href="#l2.114"></a><span id="l2.114" class="difflineat">@@ -264,16 +284,18 @@ var DefaultController =</span>
<a href="#l2.115"></a><span id="l2.115">         UpdateDeleteToolbarButton();</span>
<a href="#l2.116"></a><span id="l2.116">         if (gDBView)</span>
<a href="#l2.117"></a><span id="l2.117">           gDBView.getCommandStatus(nsMsgViewCommandType.deleteMsg, enabled, checkStatus);</span>
<a href="#l2.118"></a><span id="l2.118">         return enabled.value;</span>
<a href="#l2.119"></a><span id="l2.119">       case &quot;cmd_shiftDelete&quot;:</span>
<a href="#l2.120"></a><span id="l2.120">         if (gDBView)</span>
<a href="#l2.121"></a><span id="l2.121">           gDBView.getCommandStatus(nsMsgViewCommandType.deleteNoTrash, enabled, checkStatus);</span>
<a href="#l2.122"></a><span id="l2.122">         return enabled.value;</span>
<a href="#l2.123"></a><span id="l2.123" class="difflineplus">+      case &quot;cmd_deleteFolder&quot;:</span>
<a href="#l2.124"></a><span id="l2.124" class="difflineplus">+        return FolderPaneController.isCommandEnabled(command);</span>
<a href="#l2.125"></a><span id="l2.125">       case &quot;button_junk&quot;:</span>
<a href="#l2.126"></a><span id="l2.126">         UpdateJunkToolbarButton();</span>
<a href="#l2.127"></a><span id="l2.127">         if (gDBView)</span>
<a href="#l2.128"></a><span id="l2.128">           gDBView.getCommandStatus(nsMsgViewCommandType.junk, enabled, checkStatus);</span>
<a href="#l2.129"></a><span id="l2.129">         return enabled.value;</span>
<a href="#l2.130"></a><span id="l2.130">       case &quot;cmd_killThread&quot;:</span>
<a href="#l2.131"></a><span id="l2.131">       case &quot;cmd_killSubthread&quot;:</span>
<a href="#l2.132"></a><span id="l2.132">         return GetNumSelectedMessages() &gt; 0;</span>
<a href="#l2.133"></a><span id="l2.133" class="difflineat">@@ -512,16 +534,19 @@ var DefaultController =</span>
<a href="#l2.134"></a><span id="l2.134">         gDBView.doCommand(nsMsgViewCommandType.deleteMsg);</span>
<a href="#l2.135"></a><span id="l2.135">         break;</span>
<a href="#l2.136"></a><span id="l2.136">       case &quot;cmd_shiftDelete&quot;:</span>
<a href="#l2.137"></a><span id="l2.137">         if (gMarkViewedMessageAsReadTimer)</span>
<a href="#l2.138"></a><span id="l2.138">           MarkCurrentMessageAsRead();</span>
<a href="#l2.139"></a><span id="l2.139">         SetNextMessageAfterDelete();</span>
<a href="#l2.140"></a><span id="l2.140">         gDBView.doCommand(nsMsgViewCommandType.deleteNoTrash);</span>
<a href="#l2.141"></a><span id="l2.141">         break;</span>
<a href="#l2.142"></a><span id="l2.142" class="difflineplus">+      case &quot;cmd_deleteFolder&quot;:</span>
<a href="#l2.143"></a><span id="l2.143" class="difflineplus">+        FolderPaneController.doCommand(command);</span>
<a href="#l2.144"></a><span id="l2.144" class="difflineplus">+        break;</span>
<a href="#l2.145"></a><span id="l2.145">       case &quot;cmd_killThread&quot;:</span>
<a href="#l2.146"></a><span id="l2.146">         /* kill thread kills the thread and then does a next unread */</span>
<a href="#l2.147"></a><span id="l2.147">         GoNextMessage(nsMsgNavigationType.toggleThreadKilled, true);</span>
<a href="#l2.148"></a><span id="l2.148">         break;</span>
<a href="#l2.149"></a><span id="l2.149">       case &quot;cmd_killSubthread&quot;:</span>
<a href="#l2.150"></a><span id="l2.150">         GoNextMessage(nsMsgNavigationType.toggleSubthreadKilled, true);</span>
<a href="#l2.151"></a><span id="l2.151">         break;</span>
<a href="#l2.152"></a><span id="l2.152">       case &quot;cmd_watchThread&quot;:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/mail/base/content/mailWindowOverlay.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/mail/base/content/mailWindowOverlay.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -783,23 +783,24 @@ function UpdateJunkToolbarButton()</span>
<a href="#l3.4"></a><span id="l3.4"> }</span>
<a href="#l3.5"></a><span id="l3.5"> </span>
<a href="#l3.6"></a><span id="l3.6"> function UpdateDeleteToolbarButton()</span>
<a href="#l3.7"></a><span id="l3.7"> {</span>
<a href="#l3.8"></a><span id="l3.8">   var deleteButtonDeck = document.getElementById(&quot;delete-deck&quot;);</span>
<a href="#l3.9"></a><span id="l3.9">   if (!deleteButtonDeck)</span>
<a href="#l3.10"></a><span id="l3.10">     return;</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-  // Never show &quot;Undelete&quot; for folders.</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-  if (WhichPaneHasFocus() == GetFolderTree())</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineplus">+  // Never show &quot;Undelete&quot; in the 3-pane for folders, when delete would</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineplus">+  // apply to the selected folder.</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineplus">+  if (this.WhichPaneHasFocus &amp;&amp; WhichPaneHasFocus() == GetFolderTree()</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineplus">+      &amp;&amp; GetNumSelectedMessages() == 0)</span>
<a href="#l3.18"></a><span id="l3.18">     deleteButtonDeck.selectedIndex = 0;</span>
<a href="#l3.19"></a><span id="l3.19">   else</span>
<a href="#l3.20"></a><span id="l3.20">     deleteButtonDeck.selectedIndex = SelectedMessagesAreDeleted() ? 1 : 0;</span>
<a href="#l3.21"></a><span id="l3.21"> }</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineminus">-</span>
<a href="#l3.23"></a><span id="l3.23"> function UpdateDeleteCommand()</span>
<a href="#l3.24"></a><span id="l3.24"> {</span>
<a href="#l3.25"></a><span id="l3.25">   var value = &quot;value&quot;;</span>
<a href="#l3.26"></a><span id="l3.26">   var uri = GetFirstSelectedMessage();</span>
<a href="#l3.27"></a><span id="l3.27">   if (IsNewsMessage(uri))</span>
<a href="#l3.28"></a><span id="l3.28">     value += &quot;News&quot;;</span>
<a href="#l3.29"></a><span id="l3.29">   else if (SelectedMessagesAreDeleted())</span>
<a href="#l3.30"></a><span id="l3.30">     value += &quot;IMAPDeleted&quot;;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/base/content/mailWindowOverlay.xul</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/base/content/mailWindowOverlay.xul</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -106,16 +106,17 @@</span>
<a href="#l4.4"></a><span id="l4.4">     &lt;command id=&quot;cmd_emptyTrash&quot; oncommand=&quot;goDoCommand('cmd_emptyTrash')&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l4.5"></a><span id="l4.5">     &lt;command id=&quot;cmd_compactFolder&quot; oncommand=&quot;goDoCommand('cmd_compactFolder')&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l4.6"></a><span id="l4.6">     &lt;command id=&quot;cmd_printSetup&quot; oncommand=&quot;goDoCommand('cmd_printSetup')&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l4.7"></a><span id="l4.7">     &lt;command id=&quot;cmd_print&quot; oncommand=&quot;goDoCommand('cmd_print')&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l4.8"></a><span id="l4.8">     &lt;command id=&quot;cmd_printpreview&quot; oncommand=&quot;goDoCommand('cmd_printpreview')&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l4.9"></a><span id="l4.9">     &lt;command id=&quot;cmd_saveAsFile&quot; oncommand=&quot;goDoCommand('cmd_saveAsFile')&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l4.10"></a><span id="l4.10">     &lt;command id=&quot;cmd_saveAsTemplate&quot; oncommand=&quot;goDoCommand('cmd_saveAsTemplate')&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l4.11"></a><span id="l4.11">     &lt;command id=&quot;cmd_getNextNMessages&quot; oncommand=&quot;goDoCommand('cmd_getNextNMessages')&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+    &lt;command id=&quot;cmd_deleteFolder&quot; oncommand=&quot;goDoCommand('cmd_deleteFolder')&quot;/&gt;</span>
<a href="#l4.13"></a><span id="l4.13">     &lt;command id=&quot;cmd_renameFolder&quot; oncommand=&quot;goDoCommand('cmd_renameFolder')&quot; /&gt;</span>
<a href="#l4.14"></a><span id="l4.14">     &lt;command id=&quot;cmd_sendUnsentMsgs&quot; oncommand=&quot;goDoCommand('cmd_sendUnsentMsgs')&quot; /&gt;</span>
<a href="#l4.15"></a><span id="l4.15">     &lt;command id=&quot;cmd_synchronizeOffline&quot; oncommand=&quot;goDoCommand('cmd_synchronizeOffline')&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l4.16"></a><span id="l4.16">     &lt;command id=&quot;cmd_downloadFlagged&quot; oncommand=&quot;goDoCommand('cmd_downloadFlagged')&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l4.17"></a><span id="l4.17">     &lt;command id=&quot;cmd_downloadSelected&quot; oncommand=&quot;goDoCommand('cmd_downloadSelected')&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l4.18"></a><span id="l4.18">     &lt;command id=&quot;cmd_settingsOffline&quot; oncommand=&quot;goDoCommand('cmd_settingsOffline')&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l4.19"></a><span id="l4.19"> &lt;/commandset&gt;</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21" class="difflineat">@@ -945,16 +946,19 @@</span>
<a href="#l4.22"></a><span id="l4.22">           &lt;/menu&gt;</span>
<a href="#l4.23"></a><span id="l4.23">           &lt;menuitem id=&quot;menu_getnextnmsg&quot; label=&quot;&amp;getNextNMsgCmd.label;&quot; accesskey=&quot;&amp;getNextNMsgCmd.accesskey;&quot;</span>
<a href="#l4.24"></a><span id="l4.24">                     command=&quot;cmd_getNextNMessages&quot;/&gt;</span>
<a href="#l4.25"></a><span id="l4.25">           &lt;menuitem id=&quot;menu_sendunsentmsgs&quot; label=&quot;&amp;sendUnsentCmd.label;&quot;</span>
<a href="#l4.26"></a><span id="l4.26">                     accesskey=&quot;&amp;sendUnsentCmd.accesskey;&quot; command=&quot;cmd_sendUnsentMsgs&quot;/&gt;</span>
<a href="#l4.27"></a><span id="l4.27">           &lt;menuitem id=&quot;menu_subscribe&quot; label=&quot;&amp;subscribeCmd.label;&quot;</span>
<a href="#l4.28"></a><span id="l4.28">                     accesskey=&quot;&amp;subscribeCmd.accesskey;&quot; oncommand=&quot;MsgSubscribe();&quot;/&gt;</span>
<a href="#l4.29"></a><span id="l4.29">           &lt;menuseparator id=&quot;fileMenuAfterSubscribeSeparator&quot;/&gt;</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineplus">+          &lt;menuitem id=&quot;menu_deleteFolder&quot; label=&quot;&amp;deleteFolder.label;&quot;</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineplus">+                 accesskey=&quot;&amp;deleteFolder.accesskey;&quot;</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+                 command=&quot;cmd_deleteFolder&quot;/&gt;</span>
<a href="#l4.33"></a><span id="l4.33">           &lt;menuitem id=&quot;menu_renameFolder&quot; label=&quot;&amp;renameFolder.label;&quot;</span>
<a href="#l4.34"></a><span id="l4.34">                  accesskey=&quot;&amp;renameFolder.accesskey;&quot;</span>
<a href="#l4.35"></a><span id="l4.35">                  key=&quot;key_renameFolder&quot;</span>
<a href="#l4.36"></a><span id="l4.36">                  command=&quot;cmd_renameFolder&quot;/&gt;</span>
<a href="#l4.37"></a><span id="l4.37">           &lt;menuitem id=&quot;menu_compactFolder&quot; label=&quot;&amp;compactFolders.label;&quot; accesskey=&quot;&amp;compactFolder.accesskey;&quot; command=&quot;cmd_compactFolder&quot;/&gt;</span>
<a href="#l4.38"></a><span id="l4.38">           &lt;menuitem id=&quot;menu_emptyTrash&quot; label=&quot;&amp;emptyTrashCmd.label;&quot;</span>
<a href="#l4.39"></a><span id="l4.39">                  accesskey=&quot;&amp;emptyTrashCmd.accesskey;&quot;</span>
<a href="#l4.40"></a><span id="l4.40">                  command=&quot;cmd_emptyTrash&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/mail/base/content/messageWindow.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/mail/base/content/messageWindow.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -481,16 +481,20 @@ function HideMenus()</span>
<a href="#l5.4"></a><span id="l5.4">   var showSearch_showMessage_Separator = document.getElementById('menu_showSearch_showMessage_Separator');</span>
<a href="#l5.5"></a><span id="l5.5">   if (showSearch_showMessage_Separator)</span>
<a href="#l5.6"></a><span id="l5.6">     showSearch_showMessage_Separator.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l5.7"></a><span id="l5.7"> </span>
<a href="#l5.8"></a><span id="l5.8">   var expandOrCollapseMenu = document.getElementById('menu_expandOrCollapse');</span>
<a href="#l5.9"></a><span id="l5.9">   if (expandOrCollapseMenu)</span>
<a href="#l5.10"></a><span id="l5.10">     expandOrCollapseMenu.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l5.11"></a><span id="l5.11"> </span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+  var menuDeleteFolder = document.getElementById('menu_deleteFolder');</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+  if (menuDeleteFolder)</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+    menuDeleteFolder.hidden = true;</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+</span>
<a href="#l5.16"></a><span id="l5.16">   var renameFolderMenu = document.getElementById('menu_renameFolder');</span>
<a href="#l5.17"></a><span id="l5.17">   if (renameFolderMenu)</span>
<a href="#l5.18"></a><span id="l5.18">     renameFolderMenu.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l5.19"></a><span id="l5.19"> </span>
<a href="#l5.20"></a><span id="l5.20">   var viewLayoutMenu = document.getElementById(&quot;menu_MessagePaneLayout&quot;);</span>
<a href="#l5.21"></a><span id="l5.21">   if (viewLayoutMenu)</span>
<a href="#l5.22"></a><span id="l5.22">     viewLayoutMenu.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l5.23"></a><span id="l5.23"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/imapMsgs.properties</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/imapMsgs.properties</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -278,33 +278,25 @@ 5052=Failed to connect to server %S.</span>
<a href="#l6.4"></a><span id="l6.4"> ## @name IMAP_IMAP_CONNECTION_REFUSED_ERROR</span>
<a href="#l6.5"></a><span id="l6.5"> ## @loc None</span>
<a href="#l6.6"></a><span id="l6.6"> 5053=Could not connect to mail server %S; the connection was refused.</span>
<a href="#l6.7"></a><span id="l6.7"> </span>
<a href="#l6.8"></a><span id="l6.8"> ## @name IMAP_NET_TIMEOUT_ERROR</span>
<a href="#l6.9"></a><span id="l6.9"> ## @loc None</span>
<a href="#l6.10"></a><span id="l6.10"> 5054=Connection to server %S timed out.</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-## @name IMAP_MOVE_FOLDER_TO_TRASH</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-## @loc None</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineminus">-5055=Are you sure you want to move the selected folder into the Trash?</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineminus">-</span>
<a href="#l6.16"></a><span id="l6.16"> # Status - no messages to download </span>
<a href="#l6.17"></a><span id="l6.17"> ## @name IMAP_NO_NEW_MESSAGES</span>
<a href="#l6.18"></a><span id="l6.18"> ## @loc None</span>
<a href="#l6.19"></a><span id="l6.19"> 5056=There are no new messages on the server.</span>
<a href="#l6.20"></a><span id="l6.20"> </span>
<a href="#l6.21"></a><span id="l6.21"> ## @name IMAP_DEFAULT_ACCOUNT_NAME</span>
<a href="#l6.22"></a><span id="l6.22"> ## @loc None</span>
<a href="#l6.23"></a><span id="l6.23"> 5057=Mail for %S</span>
<a href="#l6.24"></a><span id="l6.24"> </span>
<a href="#l6.25"></a><span id="l6.25" class="difflineminus">-## @name IMAP_DELETE_NO_TRASH</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineminus">-## @loc None</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineminus">-5058=Deleting this folder is not undoable and will delete all of the messages it contains, and its sub-folders. Are you sure you still want to delete this folder?</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineminus">-</span>
<a href="#l6.29"></a><span id="l6.29"> ## @name IMAP_EMPTY_TRASH_CONFIRM</span>
<a href="#l6.30"></a><span id="l6.30"> ## @loc None</span>
<a href="#l6.31"></a><span id="l6.31"> 5061=Emptying trash will delete %S and all of the messages it contains. Do you want to delete this folder?</span>
<a href="#l6.32"></a><span id="l6.32"> </span>
<a href="#l6.33"></a><span id="l6.33"> ## @name IMAP_PERSONAL_FILING_CABINET</span>
<a href="#l6.34"></a><span id="l6.34"> ## @loc None</span>
<a href="#l6.35"></a><span id="l6.35"> 5062=Personal Filing Cabinet</span>
<a href="#l6.36"></a><span id="l6.36"> </span>
<a href="#l6.37"></a><span id="l6.37" class="difflineat">@@ -444,8 +436,28 @@ 5102=You cannot log in to %S because you</span>
<a href="#l6.38"></a><span id="l6.38"> # Place the word %3$S in your translation where the name of the destination folder should appear.</span>
<a href="#l6.39"></a><span id="l6.39"> # Place the word %1$S where the currently copying message should appear.</span>
<a href="#l6.40"></a><span id="l6.40"> # Place the word %2$S where the total number of messages should appear.</span>
<a href="#l6.41"></a><span id="l6.41"> 5103=Copying Message %1$S of %2$S to %3$S</span>
<a href="#l6.42"></a><span id="l6.42"> </span>
<a href="#l6.43"></a><span id="l6.43"> ## @name IMAP_LOGIN_DISABLED</span>
<a href="#l6.44"></a><span id="l6.44"> ## @loc None</span>
<a href="#l6.45"></a><span id="l6.45"> 5104=You cannot log in to %S because the server has disabled login. You may need to connect via SSL or TLS. Please check the account settings for your mail server.</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineplus">+</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineplus">+## @name IMAP_MOVE_FOLDER_TO_TRASH</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineplus">+## @loc None</span>
<a href="#l6.49"></a><span id="l6.49" class="difflineplus">+# LOCALIZATION NOTE (5105): Do not translate the word %S below.</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineplus">+# &quot;%S&quot; is the the name of the folder.</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineplus">+5105=Are you sure you want to delete the folder '%S'?</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineplus">+</span>
<a href="#l6.53"></a><span id="l6.53" class="difflineplus">+## @name IMAP_DELETE_NO_TRASH</span>
<a href="#l6.54"></a><span id="l6.54" class="difflineplus">+## @loc None</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineplus">+# LOCALIZATION NOTE (5106): Do not translate the word %S below.</span>
<a href="#l6.56"></a><span id="l6.56" class="difflineplus">+# &quot;%S&quot; is the the name of the folder.</span>
<a href="#l6.57"></a><span id="l6.57" class="difflineplus">+5106=Deleting this folder is not undoable and will delete all of the messages it contains, and its sub-folders. Are you sure you still want to delete the folder '%S'?</span>
<a href="#l6.58"></a><span id="l6.58" class="difflineplus">+</span>
<a href="#l6.59"></a><span id="l6.59" class="difflineplus">+## @name IMAP_DELETE_FOLDER_DIALOG_TITLE</span>
<a href="#l6.60"></a><span id="l6.60" class="difflineplus">+## @loc None</span>
<a href="#l6.61"></a><span id="l6.61" class="difflineplus">+5107=Delete Folder</span>
<a href="#l6.62"></a><span id="l6.62" class="difflineplus">+</span>
<a href="#l6.63"></a><span id="l6.63" class="difflineplus">+## @name IMAP_DELETE_FOLDER_BUTTON_LABEL</span>
<a href="#l6.64"></a><span id="l6.64" class="difflineplus">+## @loc None</span>
<a href="#l6.65"></a><span id="l6.65" class="difflineplus">+5108=&amp;Delete Folder</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/localMsgs.properties</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/localMsgs.properties</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -151,20 +151,16 @@ 4018=Please enter a new password for use</span>
<a href="#l7.4"></a><span id="l7.4"> ## @name POP3_NO_ANSWER</span>
<a href="#l7.5"></a><span id="l7.5"> ## @loc None</span>
<a href="#l7.6"></a><span id="l7.6"> 4019=No Answer</span>
<a href="#l7.7"></a><span id="l7.7"> </span>
<a href="#l7.8"></a><span id="l7.8"> ## @name POP3_ENTER_PASSWORD_PROMPT_TITLE</span>
<a href="#l7.9"></a><span id="l7.9"> ## @loc None</span>
<a href="#l7.10"></a><span id="l7.10"> 4020=Enter your password:</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-## @name moveFolderToTrash</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-## @loc None</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-4021=Are you sure you want to move the selected folder into the Trash?</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineminus">-</span>
<a href="#l7.16"></a><span id="l7.16"> ## @name POP3_FOLDER_FOR_TRASH</span>
<a href="#l7.17"></a><span id="l7.17"> ## @loc None</span>
<a href="#l7.18"></a><span id="l7.18"> 4023=The Trash already contained a folder named %s. The folder which you just deleted can be found in the Trash under the new name %s.</span>
<a href="#l7.19"></a><span id="l7.19"> </span>
<a href="#l7.20"></a><span id="l7.20"> # Status - stat failed</span>
<a href="#l7.21"></a><span id="l7.21"> ## @name POP3_STAT</span>
<a href="#l7.22"></a><span id="l7.22"> ## @loc None</span>
<a href="#l7.23"></a><span id="l7.23"> 4024= The STAT command did not succeed. Error getting message number and sizes.</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineat">@@ -244,8 +240,22 @@ 4041=The POP3 mail server (%S) does not </span>
<a href="#l7.25"></a><span id="l7.25"> # secure authentication failed and unsure why</span>
<a href="#l7.26"></a><span id="l7.26"> ## @name CANNOT_PROCESS_APOP_AUTH</span>
<a href="#l7.27"></a><span id="l7.27"> ## @loc None</span>
<a href="#l7.28"></a><span id="l7.28"> 4042=The mail server does not support secure authentication or you have entered an incorrect password. Please check your password, or turn off secure authentication in the Server Settings for your mail server in the Account Settings window.\n</span>
<a href="#l7.29"></a><span id="l7.29"> </span>
<a href="#l7.30"></a><span id="l7.30"> ## @name NS_ERROR_COULD_NOT_CONNECT_VIA_TLS</span>
<a href="#l7.31"></a><span id="l7.31"> ## @loc None</span>
<a href="#l7.32"></a><span id="l7.32"> 4043=Unable to establish TLS connection to POP3 server. The server may be down or may be incorrectly configured. Please verify the correct configuration in the Server Settings for your mail server in the Account Settings window and try again.</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineplus">+</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineplus">+## @name POP3_MOVE_FOLDER_TO_TRASH</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineplus">+## @loc None</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineplus">+# LOCALIZATION NOTE (4044): Do not translate the word %S below.</span>
<a href="#l7.37"></a><span id="l7.37" class="difflineplus">+# &quot;%S&quot; is the the name of the folder.</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineplus">+4044=Are you sure you want to delete the folder '%S'?</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineplus">+</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineplus">+## @name POP3_DELETE_FOLDER_DIALOG_TITLE</span>
<a href="#l7.41"></a><span id="l7.41" class="difflineplus">+## @loc None</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineplus">+4045=Delete Folder</span>
<a href="#l7.43"></a><span id="l7.43" class="difflineplus">+</span>
<a href="#l7.44"></a><span id="l7.44" class="difflineplus">+## @name POP3_DELETE_FOLDER_BUTTON_LABEL</span>
<a href="#l7.45"></a><span id="l7.45" class="difflineplus">+## @loc None</span>
<a href="#l7.46"></a><span id="l7.46" class="difflineplus">+4046=&amp;Delete Folder</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/messenger.dtd</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -33,16 +33,18 @@</span>
<a href="#l8.4"></a><span id="l8.4"> &lt;!ENTITY getNewMsgCurrentAccountCmdPopupMenu.label &quot;Current Account&quot;&gt;</span>
<a href="#l8.5"></a><span id="l8.5"> &lt;!ENTITY getNewMsgCurrentAccountCmdPopupMenu.accesskey &quot;C&quot;&gt;</span>
<a href="#l8.6"></a><span id="l8.6"> &lt;!ENTITY getNextNMsgCmd.label &quot;Get Next 500 News Messages&quot;&gt;</span>
<a href="#l8.7"></a><span id="l8.7"> &lt;!ENTITY getNextNMsgCmd.accesskey &quot;t&quot;&gt;</span>
<a href="#l8.8"></a><span id="l8.8"> &lt;!ENTITY sendUnsentCmd.label &quot;Send Unsent Messages&quot;&gt;</span>
<a href="#l8.9"></a><span id="l8.9"> &lt;!ENTITY sendUnsentCmd.accesskey &quot;d&quot;&gt;</span>
<a href="#l8.10"></a><span id="l8.10"> &lt;!ENTITY subscribeCmd.label &quot;Subscribe&quot;&gt;</span>
<a href="#l8.11"></a><span id="l8.11"> &lt;!ENTITY subscribeCmd.accesskey &quot;b&quot;&gt;</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+&lt;!ENTITY deleteFolder.label &quot;Delete Folder&quot;&gt;</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+&lt;!ENTITY deleteFolder.accesskey &quot;e&quot;&gt;</span>
<a href="#l8.14"></a><span id="l8.14"> &lt;!ENTITY renameFolder.label &quot;Rename Folder&quot;&gt;</span>
<a href="#l8.15"></a><span id="l8.15"> &lt;!ENTITY renameFolder.accesskey &quot;R&quot;&gt;</span>
<a href="#l8.16"></a><span id="l8.16"> &lt;!ENTITY renameFolder.key &quot;VK_F2&quot;&gt;</span>
<a href="#l8.17"></a><span id="l8.17"> &lt;!ENTITY compactFolders.label &quot;Compact Folders&quot;&gt;</span>
<a href="#l8.18"></a><span id="l8.18"> &lt;!ENTITY compactFolder.accesskey    &quot;F&quot;&gt;</span>
<a href="#l8.19"></a><span id="l8.19"> &lt;!ENTITY emptyTrashCmd.label &quot;Empty Trash&quot;&gt;</span>
<a href="#l8.20"></a><span id="l8.20"> &lt;!ENTITY emptyTrashCmd.accesskey    &quot;y&quot;&gt;</span>
<a href="#l8.21"></a><span id="l8.21"> &lt;!ENTITY importCmd.label &quot;Import&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/imap/src/nsImapMailFolder.cpp</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapMailFolder.cpp</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -2212,28 +2212,62 @@ nsImapMailFolder::DeleteSubFolders(nsIAr</span>
<a href="#l9.4"></a><span id="l9.4">     if (!canHaveSubFoldersOfTrash)</span>
<a href="#l9.5"></a><span id="l9.5">       deleteNoTrash = PR_TRUE;</span>
<a href="#l9.6"></a><span id="l9.6">     nsCOMPtr&lt;nsIPrefBranch&gt; prefBranch(do_GetService(NS_PREFSERVICE_CONTRACTID, &amp;rv));</span>
<a href="#l9.7"></a><span id="l9.7">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l9.8"></a><span id="l9.8">     prefBranch-&gt;GetBoolPref(&quot;mailnews.confirm.moveFoldersToTrash&quot;, &amp;confirmDeletion);</span>
<a href="#l9.9"></a><span id="l9.9">   }</span>
<a href="#l9.10"></a><span id="l9.10">   if (!confirmed &amp;&amp; (confirmDeletion || deleteNoTrash)) //let us alert the user if we are deleting folder immediately</span>
<a href="#l9.11"></a><span id="l9.11">   {</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    nsString confirmationStr;</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-    IMAPGetStringByID(((!deleteNoTrash) ? IMAP_MOVE_FOLDER_TO_TRASH : IMAP_DELETE_NO_TRASH),</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineminus">-    getter_Copies(confirmationStr));</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineplus">+    nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineplus">+    rv = IMAPGetStringBundle(getter_AddRefs(bundle));</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineplus">+    NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineplus">+</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+    nsAutoString folderName;</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineplus">+    rv = curFolder-&gt;GetName(folderName);</span>
<a href="#l9.21"></a><span id="l9.21" class="difflineplus">+    NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineplus">+    const PRUnichar *formatStrings[1] = { folderName.get() };</span>
<a href="#l9.23"></a><span id="l9.23" class="difflineplus">+</span>
<a href="#l9.24"></a><span id="l9.24" class="difflineplus">+    nsAutoString deleteFolderDialogTitle;</span>
<a href="#l9.25"></a><span id="l9.25" class="difflineplus">+    rv = bundle-&gt;GetStringFromID(IMAP_DELETE_FOLDER_DIALOG_TITLE,</span>
<a href="#l9.26"></a><span id="l9.26" class="difflineplus">+                                 getter_Copies(deleteFolderDialogTitle));</span>
<a href="#l9.27"></a><span id="l9.27" class="difflineplus">+    NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l9.28"></a><span id="l9.28" class="difflineplus">+</span>
<a href="#l9.29"></a><span id="l9.29" class="difflineplus">+    nsAutoString deleteFolderButtonLabel;</span>
<a href="#l9.30"></a><span id="l9.30" class="difflineplus">+    rv = bundle-&gt;GetStringFromID(IMAP_DELETE_FOLDER_BUTTON_LABEL,</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineplus">+                                 getter_Copies(deleteFolderButtonLabel));</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineplus">+    NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l9.33"></a><span id="l9.33" class="difflineplus">+</span>
<a href="#l9.34"></a><span id="l9.34" class="difflineplus">+    nsAutoString confirmationStr;</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineplus">+    rv = bundle-&gt;FormatStringFromID(</span>
<a href="#l9.36"></a><span id="l9.36" class="difflineplus">+           (!deleteNoTrash) ? IMAP_MOVE_FOLDER_TO_TRASH : IMAP_DELETE_NO_TRASH,</span>
<a href="#l9.37"></a><span id="l9.37" class="difflineplus">+           formatStrings, 1, getter_Copies(confirmationStr));</span>
<a href="#l9.38"></a><span id="l9.38" class="difflineplus">+    NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l9.39"></a><span id="l9.39">     if (!msgWindow)</span>
<a href="#l9.40"></a><span id="l9.40">       return NS_ERROR_NULL_POINTER;</span>
<a href="#l9.41"></a><span id="l9.41">     nsCOMPtr&lt;nsIDocShell&gt; docShell;</span>
<a href="#l9.42"></a><span id="l9.42">     msgWindow-&gt;GetRootDocShell(getter_AddRefs(docShell));</span>
<a href="#l9.43"></a><span id="l9.43">     nsCOMPtr&lt;nsIPrompt&gt; dialog;</span>
<a href="#l9.44"></a><span id="l9.44">     if (docShell)</span>
<a href="#l9.45"></a><span id="l9.45">       dialog = do_GetInterface(docShell);</span>
<a href="#l9.46"></a><span id="l9.46" class="difflineminus">-    if (dialog &amp;&amp; !confirmationStr.IsEmpty())</span>
<a href="#l9.47"></a><span id="l9.47" class="difflineminus">-      dialog-&gt;Confirm(nsnull, confirmationStr.get(), &amp;confirmed);</span>
<a href="#l9.48"></a><span id="l9.48" class="difflineplus">+    if (dialog)</span>
<a href="#l9.49"></a><span id="l9.49" class="difflineplus">+    {</span>
<a href="#l9.50"></a><span id="l9.50" class="difflineplus">+      PRInt32 buttonPressed = 0;</span>
<a href="#l9.51"></a><span id="l9.51" class="difflineplus">+      // Default the dialog to &quot;cancel&quot;.</span>
<a href="#l9.52"></a><span id="l9.52" class="difflineplus">+      const PRUint32 buttonFlags =</span>
<a href="#l9.53"></a><span id="l9.53" class="difflineplus">+        (nsIPrompt::BUTTON_TITLE_IS_STRING * nsIPrompt::BUTTON_POS_0) +</span>
<a href="#l9.54"></a><span id="l9.54" class="difflineplus">+        (nsIPrompt::BUTTON_TITLE_CANCEL * nsIPrompt::BUTTON_POS_1);</span>
<a href="#l9.55"></a><span id="l9.55" class="difflineplus">+</span>
<a href="#l9.56"></a><span id="l9.56" class="difflineplus">+      rv = dialog-&gt;ConfirmEx(deleteFolderDialogTitle.get(), confirmationStr.get(),</span>
<a href="#l9.57"></a><span id="l9.57" class="difflineplus">+                             buttonFlags,  deleteFolderButtonLabel.get(),</span>
<a href="#l9.58"></a><span id="l9.58" class="difflineplus">+                             nsnull, nsnull, nsnull, nsnull,</span>
<a href="#l9.59"></a><span id="l9.59" class="difflineplus">+                             &amp;buttonPressed);</span>
<a href="#l9.60"></a><span id="l9.60" class="difflineplus">+      NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l9.61"></a><span id="l9.61" class="difflineplus">+      confirmed = !buttonPressed; // &quot;ok&quot; is in position 0</span>
<a href="#l9.62"></a><span id="l9.62" class="difflineplus">+    }</span>
<a href="#l9.63"></a><span id="l9.63">   }</span>
<a href="#l9.64"></a><span id="l9.64">   else</span>
<a href="#l9.65"></a><span id="l9.65">     confirmed = PR_TRUE;</span>
<a href="#l9.66"></a><span id="l9.66"> </span>
<a href="#l9.67"></a><span id="l9.67">   if (confirmed)</span>
<a href="#l9.68"></a><span id="l9.68">   {</span>
<a href="#l9.69"></a><span id="l9.69">     for (i = 0; i &lt; folderCount; i++)</span>
<a href="#l9.70"></a><span id="l9.70">     {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mailnews/imap/src/nsImapStringBundle.h</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mailnews/imap/src/nsImapStringBundle.h</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -42,18 +42,16 @@</span>
<a href="#l10.4"></a><span id="l10.4"> </span>
<a href="#l10.5"></a><span id="l10.5"> PR_BEGIN_EXTERN_C</span>
<a href="#l10.6"></a><span id="l10.6"> </span>
<a href="#l10.7"></a><span id="l10.7"> nsresult      IMAPGetStringByID(PRInt32 stringID, PRUnichar **aString);</span>
<a href="#l10.8"></a><span id="l10.8"> nsresult      IMAPGetStringBundle(nsIStringBundle **aBundle);</span>
<a href="#l10.9"></a><span id="l10.9"> </span>
<a href="#l10.10"></a><span id="l10.10"> PR_END_EXTERN_C</span>
<a href="#l10.11"></a><span id="l10.11"> </span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-</span>
<a href="#l10.14"></a><span id="l10.14"> #define	IMAP_STATUS_SELECTING_MAILBOX                                  5000</span>
<a href="#l10.15"></a><span id="l10.15"> #define	IMAP_STATUS_CREATING_MAILBOX                                  5001</span>
<a href="#l10.16"></a><span id="l10.16"> #define	IMAP_STATUS_DELETING_MAILBOX                                  5002</span>
<a href="#l10.17"></a><span id="l10.17"> #define	IMAP_STATUS_RENAMING_MAILBOX                                  5003</span>
<a href="#l10.18"></a><span id="l10.18"> #define	IMAP_STATUS_LOOKING_FOR_MAILBOX                                  5004</span>
<a href="#l10.19"></a><span id="l10.19"> #define	IMAP_STATUS_SUBSCRIBE_TO_MAILBOX                                  5005</span>
<a href="#l10.20"></a><span id="l10.20"> #define	IMAP_STATUS_UNSUBSCRIBE_MAILBOX                                  5006</span>
<a href="#l10.21"></a><span id="l10.21"> #define	IMAP_STATUS_SEARCH_MAILBOX                                  5007</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineat">@@ -91,20 +89,18 @@ PR_END_EXTERN_C</span>
<a href="#l10.23"></a><span id="l10.23"> #define IMAP_ENTER_PASSWORD_PROMPT		5047</span>
<a href="#l10.24"></a><span id="l10.24"> #define IMAP_SERVER_NOT_IMAP4			5048</span>
<a href="#l10.25"></a><span id="l10.25"> #define IMAP_SERVER_SAID			5049</span>
<a href="#l10.26"></a><span id="l10.26"> #define IMAP_DONE				5050</span>
<a href="#l10.27"></a><span id="l10.27"> #define IMAP_ENTER_PASSWORD_PROMPT_TITLE	5051</span>
<a href="#l10.28"></a><span id="l10.28"> #define IMAP_UNKNOWN_HOST_ERROR			5052</span>
<a href="#l10.29"></a><span id="l10.29"> #define IMAP_CONNECTION_REFUSED_ERROR               5053</span>
<a href="#l10.30"></a><span id="l10.30"> #define IMAP_NET_TIMEOUT_ERROR                      5054</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineminus">-#define IMAP_MOVE_FOLDER_TO_TRASH                   5055</span>
<a href="#l10.32"></a><span id="l10.32"> #define IMAP_NO_NEW_MESSAGES                        5056</span>
<a href="#l10.33"></a><span id="l10.33"> #define IMAP_DEFAULT_ACCOUNT_NAME                   5057</span>
<a href="#l10.34"></a><span id="l10.34" class="difflineminus">-#define IMAP_DELETE_NO_TRASH                        5058</span>
<a href="#l10.35"></a><span id="l10.35"> #define IMAP_HTML_NO_CACHED_BODY_TITLE              5059</span>
<a href="#l10.36"></a><span id="l10.36"> #define IMAP_HTML_NO_CACHED_BODY_BODY               5060</span>
<a href="#l10.37"></a><span id="l10.37"> #define IMAP_EMPTY_TRASH_CONFIRM                    5061</span>
<a href="#l10.38"></a><span id="l10.38"> #define IMAP_PERSONAL_FILING_CABINET                5062</span>
<a href="#l10.39"></a><span id="l10.39"> #define IMAP_PFC_READ_MAIL                          5063</span>
<a href="#l10.40"></a><span id="l10.40"> #define IMAP_PFC_SENT_MAIL                          5064</span>
<a href="#l10.41"></a><span id="l10.41"> #define IMAP_SPECIAL_CHAR                           5065</span>
<a href="#l10.42"></a><span id="l10.42"> #define IMAP_PERSONAL_SHARED_FOLDER_TYPE_NAME       5066</span>
<a href="#l10.43"></a><span id="l10.43" class="difflineat">@@ -133,9 +129,13 @@ PR_END_EXTERN_C</span>
<a href="#l10.44"></a><span id="l10.44"> #define IMAP_SERVER_DROPPED_CONNECTION              5093</span>
<a href="#l10.45"></a><span id="l10.45"> #define IMAP_QUOTA_STATUS_FOLDERNOTOPEN             5095</span>
<a href="#l10.46"></a><span id="l10.46"> #define IMAP_QUOTA_STATUS_NOTSUPPORTED              5096</span>
<a href="#l10.47"></a><span id="l10.47"> #define IMAP_QUOTA_STATUS_NOQUOTA                   5097</span>
<a href="#l10.48"></a><span id="l10.48"> #define	IMAP_OUT_OF_MEMORY                          5100</span>
<a href="#l10.49"></a><span id="l10.49"> #define IMAP_AUTH_SECURE_NOTSUPPORTED               5102</span>
<a href="#l10.50"></a><span id="l10.50"> #define IMAP_COPYING_MESSAGE_OF                     5103</span>
<a href="#l10.51"></a><span id="l10.51"> #define IMAP_LOGIN_DISABLED                         5104</span>
<a href="#l10.52"></a><span id="l10.52" class="difflineplus">+#define IMAP_MOVE_FOLDER_TO_TRASH                   5105</span>
<a href="#l10.53"></a><span id="l10.53" class="difflineplus">+#define IMAP_DELETE_NO_TRASH                        5106</span>
<a href="#l10.54"></a><span id="l10.54" class="difflineplus">+#define IMAP_DELETE_FOLDER_DIALOG_TITLE             5107</span>
<a href="#l10.55"></a><span id="l10.55" class="difflineplus">+#define IMAP_DELETE_FOLDER_BUTTON_LABEL             5108</span>
<a href="#l10.56"></a><span id="l10.56"> #endif /* _nsImapStringBundle_H__ */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mailnews/local/src/nsLocalMailFolder.cpp</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mailnews/local/src/nsLocalMailFolder.cpp</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -1007,41 +1007,74 @@ NS_IMETHODIMP nsMsgLocalMailFolder::Dele</span>
<a href="#l11.4"></a><span id="l11.4">       nsCOMPtr&lt;nsIMsgCopyService&gt; copyService(do_GetService(NS_MSGCOPYSERVICE_CONTRACTID, &amp;rv));</span>
<a href="#l11.5"></a><span id="l11.5">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l11.6"></a><span id="l11.6">       rv = copyService-&gt;CopyFolders(folders, trashFolder, PR_TRUE, nsnull, msgWindow);</span>
<a href="#l11.7"></a><span id="l11.7">     }</span>
<a href="#l11.8"></a><span id="l11.8">   }</span>
<a href="#l11.9"></a><span id="l11.9">   return rv;</span>
<a href="#l11.10"></a><span id="l11.10"> }</span>
<a href="#l11.11"></a><span id="l11.11"> </span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-nsresult nsMsgLocalMailFolder::ConfirmFolderDeletion(nsIMsgWindow *aMsgWindow, PRBool *aResult)</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+nsresult nsMsgLocalMailFolder::ConfirmFolderDeletion(nsIMsgWindow *aMsgWindow,</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineplus">+                                                     nsIMsgFolder *aFolder, PRBool *aResult)</span>
<a href="#l11.15"></a><span id="l11.15"> {</span>
<a href="#l11.16"></a><span id="l11.16">   NS_ENSURE_ARG(aResult);</span>
<a href="#l11.17"></a><span id="l11.17">   NS_ENSURE_ARG(aMsgWindow);</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineplus">+  NS_ENSURE_ARG(aFolder);</span>
<a href="#l11.19"></a><span id="l11.19">   nsCOMPtr&lt;nsIDocShell&gt; docShell;</span>
<a href="#l11.20"></a><span id="l11.20">   aMsgWindow-&gt;GetRootDocShell(getter_AddRefs(docShell));</span>
<a href="#l11.21"></a><span id="l11.21">   if (docShell)</span>
<a href="#l11.22"></a><span id="l11.22">   {</span>
<a href="#l11.23"></a><span id="l11.23">     PRBool confirmDeletion = PR_TRUE;</span>
<a href="#l11.24"></a><span id="l11.24">     nsresult rv;</span>
<a href="#l11.25"></a><span id="l11.25">     nsCOMPtr&lt;nsIPrefBranch&gt; pPrefBranch(do_GetService(NS_PREFSERVICE_CONTRACTID, &amp;rv));</span>
<a href="#l11.26"></a><span id="l11.26">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l11.27"></a><span id="l11.27">     pPrefBranch-&gt;GetBoolPref(&quot;mailnews.confirm.moveFoldersToTrash&quot;, &amp;confirmDeletion);</span>
<a href="#l11.28"></a><span id="l11.28">     if (confirmDeletion)</span>
<a href="#l11.29"></a><span id="l11.29">     {</span>
<a href="#l11.30"></a><span id="l11.30">       nsCOMPtr&lt;nsIStringBundleService&gt; bundleService(do_GetService(&quot;@mozilla.org/intl/stringbundle;1&quot;, &amp;rv));</span>
<a href="#l11.31"></a><span id="l11.31">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l11.32"></a><span id="l11.32">       nsCOMPtr&lt;nsIStringBundle&gt; bundle;</span>
<a href="#l11.33"></a><span id="l11.33">       rv = bundleService-&gt;CreateBundle(&quot;chrome://messenger/locale/localMsgs.properties&quot;, getter_AddRefs(bundle));</span>
<a href="#l11.34"></a><span id="l11.34">       NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineminus">-      nsString alertString;</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineminus">-      bundle-&gt;GetStringFromID(POP3_MOVE_FOLDER_TO_TRASH, getter_Copies(alertString));</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineplus">+</span>
<a href="#l11.38"></a><span id="l11.38" class="difflineplus">+      nsAutoString folderName;</span>
<a href="#l11.39"></a><span id="l11.39" class="difflineplus">+      rv = aFolder-&gt;GetName(folderName);</span>
<a href="#l11.40"></a><span id="l11.40" class="difflineplus">+      NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l11.41"></a><span id="l11.41" class="difflineplus">+      const PRUnichar *formatStrings[1] = { folderName.get() };</span>
<a href="#l11.42"></a><span id="l11.42" class="difflineplus">+</span>
<a href="#l11.43"></a><span id="l11.43" class="difflineplus">+      nsAutoString deleteFolderDialogTitle;</span>
<a href="#l11.44"></a><span id="l11.44" class="difflineplus">+      rv = bundle-&gt;GetStringFromID(POP3_DELETE_FOLDER_DIALOG_TITLE,</span>
<a href="#l11.45"></a><span id="l11.45" class="difflineplus">+                                   getter_Copies(deleteFolderDialogTitle));</span>
<a href="#l11.46"></a><span id="l11.46" class="difflineplus">+      NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l11.47"></a><span id="l11.47" class="difflineplus">+</span>
<a href="#l11.48"></a><span id="l11.48" class="difflineplus">+      nsAutoString deleteFolderButtonLabel;</span>
<a href="#l11.49"></a><span id="l11.49" class="difflineplus">+      rv = bundle-&gt;GetStringFromID(POP3_DELETE_FOLDER_BUTTON_LABEL,</span>
<a href="#l11.50"></a><span id="l11.50" class="difflineplus">+                                   getter_Copies(deleteFolderButtonLabel));</span>
<a href="#l11.51"></a><span id="l11.51" class="difflineplus">+      NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l11.52"></a><span id="l11.52" class="difflineplus">+</span>
<a href="#l11.53"></a><span id="l11.53" class="difflineplus">+      nsAutoString confirmationStr;</span>
<a href="#l11.54"></a><span id="l11.54" class="difflineplus">+      rv = bundle-&gt;FormatStringFromID(POP3_MOVE_FOLDER_TO_TRASH, formatStrings, 1,</span>
<a href="#l11.55"></a><span id="l11.55" class="difflineplus">+                                      getter_Copies(confirmationStr));</span>
<a href="#l11.56"></a><span id="l11.56" class="difflineplus">+      NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l11.57"></a><span id="l11.57" class="difflineplus">+</span>
<a href="#l11.58"></a><span id="l11.58">       nsCOMPtr&lt;nsIPrompt&gt; dialog(do_GetInterface(docShell));</span>
<a href="#l11.59"></a><span id="l11.59">       if (dialog)</span>
<a href="#l11.60"></a><span id="l11.60" class="difflineminus">-        dialog-&gt;Confirm(nsnull, alertString.get(), aResult);</span>
<a href="#l11.61"></a><span id="l11.61" class="difflineplus">+      {</span>
<a href="#l11.62"></a><span id="l11.62" class="difflineplus">+        PRInt32 buttonPressed = 0;</span>
<a href="#l11.63"></a><span id="l11.63" class="difflineplus">+        // Default the dialog to &quot;cancel&quot;.</span>
<a href="#l11.64"></a><span id="l11.64" class="difflineplus">+        const PRUint32 buttonFlags =</span>
<a href="#l11.65"></a><span id="l11.65" class="difflineplus">+          (nsIPrompt::BUTTON_TITLE_IS_STRING * nsIPrompt::BUTTON_POS_0) +</span>
<a href="#l11.66"></a><span id="l11.66" class="difflineplus">+          (nsIPrompt::BUTTON_TITLE_CANCEL * nsIPrompt::BUTTON_POS_1);</span>
<a href="#l11.67"></a><span id="l11.67" class="difflineplus">+        rv = dialog-&gt;ConfirmEx(deleteFolderDialogTitle.get(), confirmationStr.get(),</span>
<a href="#l11.68"></a><span id="l11.68" class="difflineplus">+                               buttonFlags,  deleteFolderButtonLabel.get(),</span>
<a href="#l11.69"></a><span id="l11.69" class="difflineplus">+                               nsnull, nsnull, nsnull, nsnull,</span>
<a href="#l11.70"></a><span id="l11.70" class="difflineplus">+                               &amp;buttonPressed);</span>
<a href="#l11.71"></a><span id="l11.71" class="difflineplus">+        NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l11.72"></a><span id="l11.72" class="difflineplus">+        *aResult = !buttonPressed; // &quot;ok&quot; is in position 0</span>
<a href="#l11.73"></a><span id="l11.73" class="difflineplus">+      }</span>
<a href="#l11.74"></a><span id="l11.74">     }</span>
<a href="#l11.75"></a><span id="l11.75">     else</span>
<a href="#l11.76"></a><span id="l11.76">       *aResult = PR_TRUE;</span>
<a href="#l11.77"></a><span id="l11.77">   }</span>
<a href="#l11.78"></a><span id="l11.78">   return NS_OK;</span>
<a href="#l11.79"></a><span id="l11.79"> }</span>
<a href="#l11.80"></a><span id="l11.80"> </span>
<a href="#l11.81"></a><span id="l11.81"> NS_IMETHODIMP nsMsgLocalMailFolder::Rename(const nsAString&amp; aNewName, nsIMsgWindow *msgWindow)</span>
<a href="#l11.82"></a><span id="l11.82" class="difflineat">@@ -1860,17 +1893,17 @@ nsMsgLocalMailFolder::CopyFolderLocal(ns</span>
<a href="#l11.83"></a><span id="l11.83">     // don't confirm for rss folders.</span>
<a href="#l11.84"></a><span id="l11.84">     if (isMoveFolder)</span>
<a href="#l11.85"></a><span id="l11.85">     {</span>
<a href="#l11.86"></a><span id="l11.86">       // if there's a msgWindow, confirm the deletion</span>
<a href="#l11.87"></a><span id="l11.87">       if (msgWindow) </span>
<a href="#l11.88"></a><span id="l11.88">       {</span>
<a href="#l11.89"></a><span id="l11.89"> </span>
<a href="#l11.90"></a><span id="l11.90">         PRBool okToDelete = PR_FALSE;</span>
<a href="#l11.91"></a><span id="l11.91" class="difflineminus">-        ConfirmFolderDeletion(msgWindow, &amp;okToDelete);</span>
<a href="#l11.92"></a><span id="l11.92" class="difflineplus">+        ConfirmFolderDeletion(msgWindow, srcFolder, &amp;okToDelete);</span>
<a href="#l11.93"></a><span id="l11.93">         if (!okToDelete)</span>
<a href="#l11.94"></a><span id="l11.94">           return NS_MSG_ERROR_COPY_FOLDER_ABORTED;</span>
<a href="#l11.95"></a><span id="l11.95">       }</span>
<a href="#l11.96"></a><span id="l11.96">       // if we are moving a favorite folder to trash, we should clear the favorites flag</span>
<a href="#l11.97"></a><span id="l11.97">       // so it gets removed from the view.</span>
<a href="#l11.98"></a><span id="l11.98">       srcFolder-&gt;ClearFlag(nsMsgFolderFlags::Favorite);</span>
<a href="#l11.99"></a><span id="l11.99">     }</span>
<a href="#l11.100"></a><span id="l11.100"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/local/src/nsLocalMailFolder.h</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/local/src/nsLocalMailFolder.h</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -200,17 +200,17 @@ public:</span>
<a href="#l12.4"></a><span id="l12.4"> protected:</span>
<a href="#l12.5"></a><span id="l12.5">   nsresult CopyFolderAcrossServer(nsIMsgFolder *srcFolder, nsIMsgWindow *msgWindow,nsIMsgCopyServiceListener* listener);</span>
<a href="#l12.6"></a><span id="l12.6"> </span>
<a href="#l12.7"></a><span id="l12.7">   nsresult CreateSubFolders(nsIFile *path);</span>
<a href="#l12.8"></a><span id="l12.8">   nsresult GetTrashFolder(nsIMsgFolder** trashFolder);</span>
<a href="#l12.9"></a><span id="l12.9">   nsresult WriteStartOfNewMessage();</span>
<a href="#l12.10"></a><span id="l12.10">   nsresult IsChildOfTrash(PRBool *result);</span>
<a href="#l12.11"></a><span id="l12.11">   nsresult RecursiveSetDeleteIsMoveTrash(PRBool bVal);</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-  nsresult ConfirmFolderDeletion(nsIMsgWindow *aMsgWindow, PRBool *aResult);</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+  nsresult ConfirmFolderDeletion(nsIMsgWindow *aMsgWindow, nsIMsgFolder *aFolder, PRBool *aResult);</span>
<a href="#l12.14"></a><span id="l12.14"> </span>
<a href="#l12.15"></a><span id="l12.15">   nsresult DeleteMessage(nsISupports *message, nsIMsgWindow *msgWindow,</span>
<a href="#l12.16"></a><span id="l12.16">                    PRBool deleteStorage, PRBool commit);</span>
<a href="#l12.17"></a><span id="l12.17">   nsresult GetDatabase(nsIMsgWindow *msgWindow);</span>
<a href="#l12.18"></a><span id="l12.18"> </span>
<a href="#l12.19"></a><span id="l12.19">   // copy message helper</span>
<a href="#l12.20"></a><span id="l12.20">   nsresult DisplayMoveCopyStatusMsg();</span>
<a href="#l12.21"></a><span id="l12.21">   nsresult SortMessagesBasedOnKey(nsTArray&lt;nsMsgKey&gt; &amp;aKeyArray, nsIMsgFolder *srcFolder, nsIMutableArray* messages);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/local/src/nsLocalStrings.h</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/local/src/nsLocalStrings.h</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -21,17 +21,16 @@</span>
<a href="#l13.4"></a><span id="l13.4"> #define POP3_PASSWORD_UNDEFINED                               4013</span>
<a href="#l13.5"></a><span id="l13.5"> #define POP3_USERNAME_UNDEFINED                               4014</span>
<a href="#l13.6"></a><span id="l13.6"> #define POP3_LIST_FAILURE                                     4015</span>
<a href="#l13.7"></a><span id="l13.7"> #define POP3_DELE_FAILURE                                     4016</span>
<a href="#l13.8"></a><span id="l13.8"> #define POP3_ENTER_PASSWORD_PROMPT                            4017</span>
<a href="#l13.9"></a><span id="l13.9"> #define POP3_PREVIOUSLY_ENTERED_PASSWORD_IS_INVALID_ETC       4018</span>
<a href="#l13.10"></a><span id="l13.10"> #define POP3_NO_ANSWER                                        4019</span>
<a href="#l13.11"></a><span id="l13.11"> #define POP3_ENTER_PASSWORD_PROMPT_TITLE                      4020</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-#define POP3_MOVE_FOLDER_TO_TRASH                             4021</span>
<a href="#l13.13"></a><span id="l13.13"> #define POP3_FOLDER_FOR_TRASH                                 4023</span>
<a href="#l13.14"></a><span id="l13.14"> #define POP3_STAT_FAILURE                                     4024</span>
<a href="#l13.15"></a><span id="l13.15"> #define POP3_SERVER_SAID                                      4025</span>
<a href="#l13.16"></a><span id="l13.16"> #define DELETING_MSGS_STATUS                                  4026</span>
<a href="#l13.17"></a><span id="l13.17"> #define COPYING_MSGS_STATUS                                   4027</span>
<a href="#l13.18"></a><span id="l13.18"> #define MOVING_MSGS_STATUS                                    4028</span>
<a href="#l13.19"></a><span id="l13.19"> #define POP3_MESSAGE_FOLDER_BUSY                              4029</span>
<a href="#l13.20"></a><span id="l13.20"> #define CANNOT_PROCESS_SECURE_AUTH                            4030</span>
<a href="#l13.21"></a><span id="l13.21" class="difflineat">@@ -41,10 +40,13 @@</span>
<a href="#l13.22"></a><span id="l13.22"> #define MOVEMAIL_CANT_DELETE_LOCK                             4035</span>
<a href="#l13.23"></a><span id="l13.23"> #define MOVEMAIL_CANT_TRUNCATE_SPOOL_FILE                     4036</span>
<a href="#l13.24"></a><span id="l13.24"> #define MOVEMAIL_SPOOL_FILE_NOT_FOUND                         4037</span>
<a href="#l13.25"></a><span id="l13.25"> #define POP3_TMP_DOWNLOAD_FAILED                              4038</span>
<a href="#l13.26"></a><span id="l13.26"> #define POP3_SERVER_DOES_NOT_SUPPORT_UIDL_ETC                 4040</span>
<a href="#l13.27"></a><span id="l13.27"> #define POP3_SERVER_DOES_NOT_SUPPORT_THE_TOP_COMMAND          4041</span>
<a href="#l13.28"></a><span id="l13.28"> #define CANNOT_PROCESS_APOP_AUTH                              4042</span>
<a href="#l13.29"></a><span id="l13.29"> #define NS_ERROR_COULD_NOT_CONNECT_VIA_TLS                    4043</span>
<a href="#l13.30"></a><span id="l13.30" class="difflineplus">+#define POP3_MOVE_FOLDER_TO_TRASH                             4044</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineplus">+#define POP3_DELETE_FOLDER_DIALOG_TITLE                       4045</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+#define POP3_DELETE_FOLDER_BUTTON_LABEL                       4046</span>
<a href="#l13.33"></a><span id="l13.33"> </span>
<a href="#l13.34"></a><span id="l13.34"> #endif /* _nsLocalStrings_H__ */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/suite/locales/en-US/chrome/mailnews/imapMsgs.properties</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/mailnews/imapMsgs.properties</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -278,33 +278,25 @@ 5052=Failed to connect to server %S.</span>
<a href="#l14.4"></a><span id="l14.4"> ## @name IMAP_IMAP_CONNECTION_REFUSED_ERROR</span>
<a href="#l14.5"></a><span id="l14.5"> ## @loc None</span>
<a href="#l14.6"></a><span id="l14.6"> 5053=Could not connect to mail server %S; the connection was refused.</span>
<a href="#l14.7"></a><span id="l14.7"> </span>
<a href="#l14.8"></a><span id="l14.8"> ## @name IMAP_NET_TIMEOUT_ERROR</span>
<a href="#l14.9"></a><span id="l14.9"> ## @loc None</span>
<a href="#l14.10"></a><span id="l14.10"> 5054=Connection to server %S timed out.</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-## @name IMAP_MOVE_FOLDER_TO_TRASH</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-## @loc None</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineminus">-5055=Are you sure you want to move the selected folder into the Trash?</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineminus">-</span>
<a href="#l14.16"></a><span id="l14.16"> # Status - no messages to download </span>
<a href="#l14.17"></a><span id="l14.17"> ## @name IMAP_NO_NEW_MESSAGES</span>
<a href="#l14.18"></a><span id="l14.18"> ## @loc None</span>
<a href="#l14.19"></a><span id="l14.19"> 5056=There are no new messages on the server.</span>
<a href="#l14.20"></a><span id="l14.20"> </span>
<a href="#l14.21"></a><span id="l14.21"> ## @name IMAP_DEFAULT_ACCOUNT_NAME</span>
<a href="#l14.22"></a><span id="l14.22"> ## @loc None</span>
<a href="#l14.23"></a><span id="l14.23"> 5057=Mail for %S</span>
<a href="#l14.24"></a><span id="l14.24"> </span>
<a href="#l14.25"></a><span id="l14.25" class="difflineminus">-## @name IMAP_DELETE_NO_TRASH</span>
<a href="#l14.26"></a><span id="l14.26" class="difflineminus">-## @loc None</span>
<a href="#l14.27"></a><span id="l14.27" class="difflineminus">-5058=Deleting this folder is not undoable and will delete all of the messages it contains, and its sub-folders. Are you sure you still want to delete this folder?</span>
<a href="#l14.28"></a><span id="l14.28" class="difflineminus">-</span>
<a href="#l14.29"></a><span id="l14.29"> ## @name IMAP_EMPTY_TRASH_CONFIRM</span>
<a href="#l14.30"></a><span id="l14.30"> ## @loc None</span>
<a href="#l14.31"></a><span id="l14.31"> 5061=Emptying trash will delete %S and all of the messages it contains. Do you want to delete this folder?</span>
<a href="#l14.32"></a><span id="l14.32"> </span>
<a href="#l14.33"></a><span id="l14.33"> ## @name IMAP_PERSONAL_FILING_CABINET</span>
<a href="#l14.34"></a><span id="l14.34"> ## @loc None</span>
<a href="#l14.35"></a><span id="l14.35"> 5062=Personal Filing Cabinet</span>
<a href="#l14.36"></a><span id="l14.36"> </span>
<a href="#l14.37"></a><span id="l14.37" class="difflineat">@@ -444,8 +436,28 @@ 5102=You cannot log in to %S because you</span>
<a href="#l14.38"></a><span id="l14.38"> # Place the word %3$S in your translation where the name of the destination folder should appear.</span>
<a href="#l14.39"></a><span id="l14.39"> # Place the word %1$S where the currently copying message should appear.</span>
<a href="#l14.40"></a><span id="l14.40"> # Place the word %2$S where the total number of messages should appear.</span>
<a href="#l14.41"></a><span id="l14.41"> 5103=Copying Message %1$S of %2$S to %3$S</span>
<a href="#l14.42"></a><span id="l14.42"> </span>
<a href="#l14.43"></a><span id="l14.43"> ## @name IMAP_LOGIN_DISABLED</span>
<a href="#l14.44"></a><span id="l14.44"> ## @loc None</span>
<a href="#l14.45"></a><span id="l14.45"> 5104=You cannot log in to %S because the server has disabled login. You may need to connect via SSL or TLS. Please check the account settings for your mail server.</span>
<a href="#l14.46"></a><span id="l14.46" class="difflineplus">+</span>
<a href="#l14.47"></a><span id="l14.47" class="difflineplus">+## @name IMAP_MOVE_FOLDER_TO_TRASH</span>
<a href="#l14.48"></a><span id="l14.48" class="difflineplus">+## @loc None</span>
<a href="#l14.49"></a><span id="l14.49" class="difflineplus">+# LOCALIZATION NOTE (5105): Do not translate the word %S below.</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineplus">+# &quot;%S&quot; is the the name of the folder.</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineplus">+5105=Are you sure you want to delete the folder '%S'?</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineplus">+</span>
<a href="#l14.53"></a><span id="l14.53" class="difflineplus">+## @name IMAP_DELETE_NO_TRASH</span>
<a href="#l14.54"></a><span id="l14.54" class="difflineplus">+## @loc None</span>
<a href="#l14.55"></a><span id="l14.55" class="difflineplus">+# LOCALIZATION NOTE (5106): Do not translate the word %S below.</span>
<a href="#l14.56"></a><span id="l14.56" class="difflineplus">+# &quot;%S&quot; is the the name of the folder.</span>
<a href="#l14.57"></a><span id="l14.57" class="difflineplus">+5106=Deleting this folder is not undoable and will delete all of the messages it contains, and its sub-folders. Are you sure you still want to delete the folder '%S'?</span>
<a href="#l14.58"></a><span id="l14.58" class="difflineplus">+</span>
<a href="#l14.59"></a><span id="l14.59" class="difflineplus">+## @name IMAP_DELETE_FOLDER_DIALOG_TITLE</span>
<a href="#l14.60"></a><span id="l14.60" class="difflineplus">+## @loc None</span>
<a href="#l14.61"></a><span id="l14.61" class="difflineplus">+5107=Delete Folder</span>
<a href="#l14.62"></a><span id="l14.62" class="difflineplus">+</span>
<a href="#l14.63"></a><span id="l14.63" class="difflineplus">+## @name IMAP_DELETE_FOLDER_BUTTON_LABEL</span>
<a href="#l14.64"></a><span id="l14.64" class="difflineplus">+## @loc None</span>
<a href="#l14.65"></a><span id="l14.65" class="difflineplus">+5108=&amp;Delete Folder</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/suite/locales/en-US/chrome/mailnews/localMsgs.properties</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/mailnews/localMsgs.properties</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -156,20 +156,16 @@ 4018=Please enter a new password for use</span>
<a href="#l15.4"></a><span id="l15.4"> ## @name POP3_NO_ANSWER</span>
<a href="#l15.5"></a><span id="l15.5"> ## @loc None</span>
<a href="#l15.6"></a><span id="l15.6"> 4019=No Answer</span>
<a href="#l15.7"></a><span id="l15.7"> </span>
<a href="#l15.8"></a><span id="l15.8"> ## @name POP3_ENTER_PASSWORD_PROMPT_TITLE</span>
<a href="#l15.9"></a><span id="l15.9"> ## @loc None</span>
<a href="#l15.10"></a><span id="l15.10"> 4020=Enter your password:</span>
<a href="#l15.11"></a><span id="l15.11"> </span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-## @name moveFolderToTrash</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-## @loc None</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineminus">-4021=Are you sure you want to move the selected folder into the Trash?</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">-</span>
<a href="#l15.16"></a><span id="l15.16"> ## @name POP3_FOLDER_FOR_TRASH</span>
<a href="#l15.17"></a><span id="l15.17"> ## @loc None</span>
<a href="#l15.18"></a><span id="l15.18"> 4023=The Trash already contained a folder named %s. The folder which you just deleted can be found in the Trash under the new name %s.</span>
<a href="#l15.19"></a><span id="l15.19"> </span>
<a href="#l15.20"></a><span id="l15.20"> # Status - stat failed</span>
<a href="#l15.21"></a><span id="l15.21"> ## @name POP3_STAT</span>
<a href="#l15.22"></a><span id="l15.22"> ## @loc None</span>
<a href="#l15.23"></a><span id="l15.23"> 4024= The STAT command did not succeed. Error getting message number and sizes.</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineat">@@ -244,8 +240,22 @@ 4041=The POP3 mail server (%S) does not </span>
<a href="#l15.25"></a><span id="l15.25"> # secure authentication failed and unsure why</span>
<a href="#l15.26"></a><span id="l15.26"> ## @name CANNOT_PROCESS_APOP_AUTH</span>
<a href="#l15.27"></a><span id="l15.27"> ## @loc None</span>
<a href="#l15.28"></a><span id="l15.28"> 4042=The mail server does not support secure authentication or you have entered an incorrect password. Please check your password, or turn off secure authentication in the Server Settings for your mail server in the Account Settings window.\n</span>
<a href="#l15.29"></a><span id="l15.29"> </span>
<a href="#l15.30"></a><span id="l15.30"> ## @name NS_ERROR_COULD_NOT_CONNECT_VIA_TLS</span>
<a href="#l15.31"></a><span id="l15.31"> ## @loc None</span>
<a href="#l15.32"></a><span id="l15.32"> 4043=Unable to establish TLS connection to POP3 server. The server may be down or may be incorrectly configured. Please verify the correct configuration in the Server Settings for your mail server in the Account Settings window and try again.</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineplus">+</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineplus">+## @name POP3_MOVE_FOLDER_TO_TRASH</span>
<a href="#l15.35"></a><span id="l15.35" class="difflineplus">+## @loc None</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineplus">+# LOCALIZATION NOTE (4044): Do not translate the word %S below.</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineplus">+# &quot;%S&quot; is the the name of the folder.</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineplus">+4044=Are you sure you want to delete the folder '%S'?</span>
<a href="#l15.39"></a><span id="l15.39" class="difflineplus">+</span>
<a href="#l15.40"></a><span id="l15.40" class="difflineplus">+## @name POP3_DELETE_FOLDER_DIALOG_TITLE</span>
<a href="#l15.41"></a><span id="l15.41" class="difflineplus">+## @loc None</span>
<a href="#l15.42"></a><span id="l15.42" class="difflineplus">+4045=Delete Folder</span>
<a href="#l15.43"></a><span id="l15.43" class="difflineplus">+</span>
<a href="#l15.44"></a><span id="l15.44" class="difflineplus">+## @name POP3_DELETE_FOLDER_BUTTON_LABEL</span>
<a href="#l15.45"></a><span id="l15.45" class="difflineplus">+## @loc None</span>
<a href="#l15.46"></a><span id="l15.46" class="difflineplus">+4046=&amp;Delete Folder</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

