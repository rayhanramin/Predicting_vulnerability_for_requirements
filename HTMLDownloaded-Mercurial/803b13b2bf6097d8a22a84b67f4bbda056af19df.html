<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 19811:803b13b2bf6097d8a22a84b67f4bbda056af19df</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 803b13b2bf6097d8a22a84b67f4bbda056af19df" />
<meta property="og:url" content="/comm-central/rev/803b13b2bf6097d8a22a84b67f4bbda056af19df" />
<meta property="og:description" content="Bug 955642 - Handle Twitter direct messages (DMs) - Update twitter-text.jsm, r=clokep." />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 803b13b2bf6097d8a22a84b67f4bbda056af19df 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/803b13b2bf6097d8a22a84b67f4bbda056af19df">shortlog</a> |
<a href="/comm-central/log/803b13b2bf6097d8a22a84b67f4bbda056af19df">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/803b13b2bf6097d8a22a84b67f4bbda056af19df">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/803b13b2bf6097d8a22a84b67f4bbda056af19df">files</a> |
changeset |
<a href="/comm-central/raw-rev/803b13b2bf6097d8a22a84b67f4bbda056af19df">raw</a>  | <a href="/comm-central/archive/803b13b2bf6097d8a22a84b67f4bbda056af19df.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=955642">Bug 955642</a> - Handle Twitter direct messages (DMs) - Update twitter-text.jsm, r=clokep.
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#65;&#114;&#108;&#111;&#32;&#66;&#114;&#101;&#97;&#117;&#108;&#116;&#32;&#60;&#97;&#114;&#108;&#111;&#108;&#114;&#97;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Wed, 06 Jul 2016 12:40:00 -0400</td></tr>

<tr>
 <td>changeset 19811</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/803b13b2bf6097d8a22a84b67f4bbda056af19df">803b13b2bf6097d8a22a84b67f4bbda056af19df</a></td>
</tr>



<tr>
<td>parent 19810</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/01f5f751c3aad6ef989081f49e9a0c377886796b">01f5f751c3aad6ef989081f49e9a0c377886796b</a>
</td>
</tr>

<tr>
<td>child 19812</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/de9e1f18b4d9ac07c347a15e799b00238f1d98f3">de9e1f18b4d9ac07c347a15e799b00238f1d98f3</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=803b13b2bf6097d8a22a84b67f4bbda056af19df">12133</a></td></tr>
<tr><td>push user</td><td>clokep@gmail.com</td></tr>
<tr><td>push date</td><td class="date age">Tue, 02 Aug 2016 13:02:17 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@f885abf8aac7 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=f885abf8aac76a14b39a27484c90cf51d24dec1c">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=f885abf8aac76a14b39a27484c90cf51d24dec1c&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=f885abf8aac76a14b39a27484c90cf51d24dec1c&newProject=comm-central&newRevision=803b13b2bf6097d8a22a84b67f4bbda056af19df&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=f885abf8aac76a14b39a27484c90cf51d24dec1c&newProject=comm-central&newRevision=803b13b2bf6097d8a22a84b67f4bbda056af19df&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=f885abf8aac76a14b39a27484c90cf51d24dec1c&newProject=comm-central&newRevision=803b13b2bf6097d8a22a84b67f4bbda056af19df&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28clokep%29&revcount=50">clokep</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=955642">955642</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=955642">Bug 955642</a> - Handle Twitter direct messages (DMs) - Update twitter-text.jsm, r=clokep.</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/803b13b2bf6097d8a22a84b67f4bbda056af19df/chat/protocols/twitter/twitter-text.jsm">chat/protocols/twitter/twitter-text.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/803b13b2bf6097d8a22a84b67f4bbda056af19df/chat/protocols/twitter/twitter-text.jsm">file</a> |
<a href="/comm-central/annotate/803b13b2bf6097d8a22a84b67f4bbda056af19df/chat/protocols/twitter/twitter-text.jsm">annotate</a> |
<a href="/comm-central/diff/803b13b2bf6097d8a22a84b67f4bbda056af19df/chat/protocols/twitter/twitter-text.jsm">diff</a> |
<a href="/comm-central/comparison/803b13b2bf6097d8a22a84b67f4bbda056af19df/chat/protocols/twitter/twitter-text.jsm">comparison</a> |
<a href="/comm-central/log/803b13b2bf6097d8a22a84b67f4bbda056af19df/chat/protocols/twitter/twitter-text.jsm">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/chat/protocols/twitter/twitter-text.jsm</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/chat/protocols/twitter/twitter-text.jsm</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -14,17 +14,17 @@</span>
<a href="#l1.4"></a><span id="l1.4">  */</span>
<a href="#l1.5"></a><span id="l1.5"> </span>
<a href="#l1.6"></a><span id="l1.6"> this.EXPORTED_SYMBOLS = [&quot;twttr&quot;];</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8"> var window = {};</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10"> // The code below is imported from Twitter's JavaScript utility for parsing</span>
<a href="#l1.11"></a><span id="l1.11"> // tweets. The original version of this file can be found at</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-// https://github.com/twitter/twitter-text-js/blob/master/twitter-text.js</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+// https://github.com/twitter/twitter-text/blob/master/js/twitter-text.js</span>
<a href="#l1.14"></a><span id="l1.14"> </span>
<a href="#l1.15"></a><span id="l1.15"> (function() {</span>
<a href="#l1.16"></a><span id="l1.16">   if (typeof twttr === &quot;undefined&quot; || twttr === null) {</span>
<a href="#l1.17"></a><span id="l1.17">     var twttr = {};</span>
<a href="#l1.18"></a><span id="l1.18">   }</span>
<a href="#l1.19"></a><span id="l1.19"> </span>
<a href="#l1.20"></a><span id="l1.20">   twttr.txt = {};</span>
<a href="#l1.21"></a><span id="l1.21">   twttr.txt.regexen = {};</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineat">@@ -120,90 +120,16 @@ var window = {};</span>
<a href="#l1.23"></a><span id="l1.23"> </span>
<a href="#l1.24"></a><span id="l1.24">   twttr.txt.regexen.spaces_group = regexSupplant(UNICODE_SPACES.join(&quot;&quot;));</span>
<a href="#l1.25"></a><span id="l1.25">   twttr.txt.regexen.spaces = regexSupplant(&quot;[&quot; + UNICODE_SPACES.join(&quot;&quot;) + &quot;]&quot;);</span>
<a href="#l1.26"></a><span id="l1.26">   twttr.txt.regexen.invalid_chars_group = regexSupplant(INVALID_CHARS.join(&quot;&quot;));</span>
<a href="#l1.27"></a><span id="l1.27">   twttr.txt.regexen.punct = /\!'#%&amp;'\(\)*\+,\\\-\.\/:;&lt;=&gt;\?@\[\]\^_{|}~\$/;</span>
<a href="#l1.28"></a><span id="l1.28">   twttr.txt.regexen.rtl_chars = /[\u0600-\u06FF]|[\u0750-\u077F]|[\u0590-\u05FF]|[\uFE70-\uFEFF]/mg;</span>
<a href="#l1.29"></a><span id="l1.29">   twttr.txt.regexen.non_bmp_code_pairs = /[\uD800-\uDBFF][\uDC00-\uDFFF]/mg;</span>
<a href="#l1.30"></a><span id="l1.30"> </span>
<a href="#l1.31"></a><span id="l1.31" class="difflineminus">-  var nonLatinHashtagChars = [];</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineminus">-  // Cyrillic</span>
<a href="#l1.33"></a><span id="l1.33" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x0400, 0x04ff); // Cyrillic</span>
<a href="#l1.34"></a><span id="l1.34" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x0500, 0x0527); // Cyrillic Supplement</span>
<a href="#l1.35"></a><span id="l1.35" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x2de0, 0x2dff); // Cyrillic Extended A</span>
<a href="#l1.36"></a><span id="l1.36" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xa640, 0xa69f); // Cyrillic Extended B</span>
<a href="#l1.37"></a><span id="l1.37" class="difflineminus">-  // Hebrew</span>
<a href="#l1.38"></a><span id="l1.38" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x0591, 0x05bf); // Hebrew</span>
<a href="#l1.39"></a><span id="l1.39" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x05c1, 0x05c2);</span>
<a href="#l1.40"></a><span id="l1.40" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x05c4, 0x05c5);</span>
<a href="#l1.41"></a><span id="l1.41" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x05c7, 0x05c7);</span>
<a href="#l1.42"></a><span id="l1.42" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x05d0, 0x05ea);</span>
<a href="#l1.43"></a><span id="l1.43" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x05f0, 0x05f4);</span>
<a href="#l1.44"></a><span id="l1.44" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xfb12, 0xfb28); // Hebrew Presentation Forms</span>
<a href="#l1.45"></a><span id="l1.45" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xfb2a, 0xfb36);</span>
<a href="#l1.46"></a><span id="l1.46" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xfb38, 0xfb3c);</span>
<a href="#l1.47"></a><span id="l1.47" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xfb3e, 0xfb3e);</span>
<a href="#l1.48"></a><span id="l1.48" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xfb40, 0xfb41);</span>
<a href="#l1.49"></a><span id="l1.49" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xfb43, 0xfb44);</span>
<a href="#l1.50"></a><span id="l1.50" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xfb46, 0xfb4f);</span>
<a href="#l1.51"></a><span id="l1.51" class="difflineminus">-  // Arabic</span>
<a href="#l1.52"></a><span id="l1.52" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x0610, 0x061a); // Arabic</span>
<a href="#l1.53"></a><span id="l1.53" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x0620, 0x065f);</span>
<a href="#l1.54"></a><span id="l1.54" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x066e, 0x06d3);</span>
<a href="#l1.55"></a><span id="l1.55" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x06d5, 0x06dc);</span>
<a href="#l1.56"></a><span id="l1.56" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x06de, 0x06e8);</span>
<a href="#l1.57"></a><span id="l1.57" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x06ea, 0x06ef);</span>
<a href="#l1.58"></a><span id="l1.58" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x06fa, 0x06fc);</span>
<a href="#l1.59"></a><span id="l1.59" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x06ff, 0x06ff);</span>
<a href="#l1.60"></a><span id="l1.60" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x0750, 0x077f); // Arabic Supplement</span>
<a href="#l1.61"></a><span id="l1.61" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x08a0, 0x08a0); // Arabic Extended A</span>
<a href="#l1.62"></a><span id="l1.62" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x08a2, 0x08ac);</span>
<a href="#l1.63"></a><span id="l1.63" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x08e4, 0x08fe);</span>
<a href="#l1.64"></a><span id="l1.64" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xfb50, 0xfbb1); // Arabic Pres. Forms A</span>
<a href="#l1.65"></a><span id="l1.65" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xfbd3, 0xfd3d);</span>
<a href="#l1.66"></a><span id="l1.66" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xfd50, 0xfd8f);</span>
<a href="#l1.67"></a><span id="l1.67" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xfd92, 0xfdc7);</span>
<a href="#l1.68"></a><span id="l1.68" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xfdf0, 0xfdfb);</span>
<a href="#l1.69"></a><span id="l1.69" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xfe70, 0xfe74); // Arabic Pres. Forms B</span>
<a href="#l1.70"></a><span id="l1.70" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xfe76, 0xfefc);</span>
<a href="#l1.71"></a><span id="l1.71" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x200c, 0x200c); // Zero-Width Non-Joiner</span>
<a href="#l1.72"></a><span id="l1.72" class="difflineminus">-  // Thai</span>
<a href="#l1.73"></a><span id="l1.73" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x0e01, 0x0e3a);</span>
<a href="#l1.74"></a><span id="l1.74" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x0e40, 0x0e4e);</span>
<a href="#l1.75"></a><span id="l1.75" class="difflineminus">-  // Hangul (Korean)</span>
<a href="#l1.76"></a><span id="l1.76" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x1100, 0x11ff); // Hangul Jamo</span>
<a href="#l1.77"></a><span id="l1.77" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x3130, 0x3185); // Hangul Compatibility Jamo</span>
<a href="#l1.78"></a><span id="l1.78" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xA960, 0xA97F); // Hangul Jamo Extended-A</span>
<a href="#l1.79"></a><span id="l1.79" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xAC00, 0xD7AF); // Hangul Syllables</span>
<a href="#l1.80"></a><span id="l1.80" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xD7B0, 0xD7FF); // Hangul Jamo Extended-B</span>
<a href="#l1.81"></a><span id="l1.81" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xFFA1, 0xFFDC); // half-width Hangul</span>
<a href="#l1.82"></a><span id="l1.82" class="difflineminus">-  // Japanese and Chinese</span>
<a href="#l1.83"></a><span id="l1.83" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x30A1, 0x30FA); // Katakana (full-width)</span>
<a href="#l1.84"></a><span id="l1.84" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x30FC, 0x30FE); // Katakana Chouon and iteration marks (full-width)</span>
<a href="#l1.85"></a><span id="l1.85" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xFF66, 0xFF9F); // Katakana (half-width)</span>
<a href="#l1.86"></a><span id="l1.86" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xFF70, 0xFF70); // Katakana Chouon (half-width)</span>
<a href="#l1.87"></a><span id="l1.87" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xFF10, 0xFF19); // \</span>
<a href="#l1.88"></a><span id="l1.88" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xFF21, 0xFF3A); //  - Latin (full-width)</span>
<a href="#l1.89"></a><span id="l1.89" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0xFF41, 0xFF5A); // /</span>
<a href="#l1.90"></a><span id="l1.90" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x3041, 0x3096); // Hiragana</span>
<a href="#l1.91"></a><span id="l1.91" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x3099, 0x309E); // Hiragana voicing and iteration mark</span>
<a href="#l1.92"></a><span id="l1.92" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x3400, 0x4DBF); // Kanji (CJK Extension A)</span>
<a href="#l1.93"></a><span id="l1.93" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x4E00, 0x9FFF); // Kanji (Unified)</span>
<a href="#l1.94"></a><span id="l1.94" class="difflineminus">-  // -- Disabled as it breaks the Regex.</span>
<a href="#l1.95"></a><span id="l1.95" class="difflineminus">-  //addCharsToCharClass(nonLatinHashtagChars, 0x20000, 0x2A6DF); // Kanji (CJK Extension B)</span>
<a href="#l1.96"></a><span id="l1.96" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x2A700, 0x2B73F); // Kanji (CJK Extension C)</span>
<a href="#l1.97"></a><span id="l1.97" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x2B740, 0x2B81F); // Kanji (CJK Extension D)</span>
<a href="#l1.98"></a><span id="l1.98" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x2F800, 0x2FA1F); // Kanji (CJK supplement)</span>
<a href="#l1.99"></a><span id="l1.99" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x3003, 0x3003); // Kanji iteration mark</span>
<a href="#l1.100"></a><span id="l1.100" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x3005, 0x3005); // Kanji iteration mark</span>
<a href="#l1.101"></a><span id="l1.101" class="difflineminus">-  addCharsToCharClass(nonLatinHashtagChars, 0x303B, 0x303B); // Han iteration mark</span>
<a href="#l1.102"></a><span id="l1.102" class="difflineminus">-</span>
<a href="#l1.103"></a><span id="l1.103" class="difflineminus">-  twttr.txt.regexen.nonLatinHashtagChars = regexSupplant(nonLatinHashtagChars.join(&quot;&quot;));</span>
<a href="#l1.104"></a><span id="l1.104" class="difflineminus">-</span>
<a href="#l1.105"></a><span id="l1.105">   var latinAccentChars = [];</span>
<a href="#l1.106"></a><span id="l1.106">   // Latin accented characters (subtracted 0xD7 from the range, it's a confusable multiplication sign. Looks like &quot;x&quot;)</span>
<a href="#l1.107"></a><span id="l1.107">   addCharsToCharClass(latinAccentChars, 0x00c0, 0x00d6);</span>
<a href="#l1.108"></a><span id="l1.108">   addCharsToCharClass(latinAccentChars, 0x00d8, 0x00f6);</span>
<a href="#l1.109"></a><span id="l1.109">   addCharsToCharClass(latinAccentChars, 0x00f8, 0x00ff);</span>
<a href="#l1.110"></a><span id="l1.110">   // Latin Extended A and B</span>
<a href="#l1.111"></a><span id="l1.111">   addCharsToCharClass(latinAccentChars, 0x0100, 0x024f);</span>
<a href="#l1.112"></a><span id="l1.112">   // assorted IPA Extensions</span>
<a href="#l1.113"></a><span id="l1.113" class="difflineat">@@ -220,26 +146,32 @@ var window = {};</span>
<a href="#l1.114"></a><span id="l1.114">   // Okina for Hawaiian (it *is* a letter character)</span>
<a href="#l1.115"></a><span id="l1.115">   addCharsToCharClass(latinAccentChars, 0x02bb, 0x02bb);</span>
<a href="#l1.116"></a><span id="l1.116">   // Combining diacritics</span>
<a href="#l1.117"></a><span id="l1.117">   addCharsToCharClass(latinAccentChars, 0x0300, 0x036f);</span>
<a href="#l1.118"></a><span id="l1.118">   // Latin Extended Additional</span>
<a href="#l1.119"></a><span id="l1.119">   addCharsToCharClass(latinAccentChars, 0x1e00, 0x1eff);</span>
<a href="#l1.120"></a><span id="l1.120">   twttr.txt.regexen.latinAccentChars = regexSupplant(latinAccentChars.join(&quot;&quot;));</span>
<a href="#l1.121"></a><span id="l1.121"> </span>
<a href="#l1.122"></a><span id="l1.122" class="difflineminus">-  // A hashtag must contain characters, numbers and underscores, but not all numbers.</span>
<a href="#l1.123"></a><span id="l1.123" class="difflineplus">+  // Some minimizers convert string escapes into their literal values, which leads to intermittent Unicode normalization bugs and</span>
<a href="#l1.124"></a><span id="l1.124" class="difflineplus">+  // increases the gzipped download size. Use RegEx literals as opposed to string literals to prevent that.</span>
<a href="#l1.125"></a><span id="l1.125" class="difflineplus">+  var unicodeLettersAndMarks = /A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B2\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA7AD\uA7B0\uA7B1\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB5F\uAB64\uAB65\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E4-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u192B\u1930-\u193B\u19B0-\u19C0\u19C8\u19C9\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFC-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2D/.source;</span>
<a href="#l1.126"></a><span id="l1.126" class="difflineplus">+  var unicodeNumbers = /0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source;</span>
<a href="#l1.127"></a><span id="l1.127" class="difflineplus">+  var hashtagSpecialChars = /_\u200c\u200d\ua67e\u05be\u05f3\u05f4\uff5e\u301c\u309b\u309c\u30a0\u30fb\u3003\u0f0b\u0f0c\u00b7/.source;</span>
<a href="#l1.128"></a><span id="l1.128" class="difflineplus">+</span>
<a href="#l1.129"></a><span id="l1.129" class="difflineplus">+  // A hashtag must contain at least one unicode letter or mark, as well as numbers, underscores, and select special characters.</span>
<a href="#l1.130"></a><span id="l1.130">   twttr.txt.regexen.hashSigns = /[#＃]/;</span>
<a href="#l1.131"></a><span id="l1.131" class="difflineminus">-  twttr.txt.regexen.hashtagAlpha = regexSupplant(/[a-z_#{latinAccentChars}#{nonLatinHashtagChars}]/i);</span>
<a href="#l1.132"></a><span id="l1.132" class="difflineminus">-  twttr.txt.regexen.hashtagAlphaNumeric = regexSupplant(/[a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}]/i);</span>
<a href="#l1.133"></a><span id="l1.133" class="difflineplus">+  twttr.txt.regexen.hashtagAlpha = new RegExp(&quot;[&quot; + unicodeLettersAndMarks + &quot;]&quot;);</span>
<a href="#l1.134"></a><span id="l1.134" class="difflineplus">+  twttr.txt.regexen.hashtagAlphaNumeric = new RegExp(&quot;[&quot; + unicodeLettersAndMarks + unicodeNumbers + hashtagSpecialChars + &quot;]&quot;);</span>
<a href="#l1.135"></a><span id="l1.135">   twttr.txt.regexen.endHashtagMatch = regexSupplant(/^(?:#{hashSigns}|:\/\/)/);</span>
<a href="#l1.136"></a><span id="l1.136" class="difflineminus">-  twttr.txt.regexen.hashtagBoundary = regexSupplant(/(?:^|$|[^&amp;a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}])/);</span>
<a href="#l1.137"></a><span id="l1.137" class="difflineminus">-  twttr.txt.regexen.validHashtag = regexSupplant(/(#{hashtagBoundary})(#{hashSigns})(#{hashtagAlphaNumeric}*#{hashtagAlpha}#{hashtagAlphaNumeric}*)/gi);</span>
<a href="#l1.138"></a><span id="l1.138" class="difflineplus">+  twttr.txt.regexen.hashtagBoundary = new RegExp(&quot;(?:^|$|[^&amp;&quot; + unicodeLettersAndMarks + unicodeNumbers + hashtagSpecialChars + &quot;])&quot;);</span>
<a href="#l1.139"></a><span id="l1.139" class="difflineplus">+  twttr.txt.regexen.validHashtag = regexSupplant(/(#{hashtagBoundary})(#{hashSigns})(?!\ufe0f|\u20e3)(#{hashtagAlphaNumeric}*#{hashtagAlpha}#{hashtagAlphaNumeric}*)/gi);</span>
<a href="#l1.140"></a><span id="l1.140"> </span>
<a href="#l1.141"></a><span id="l1.141">   // Mention related regex collection</span>
<a href="#l1.142"></a><span id="l1.142" class="difflineminus">-  twttr.txt.regexen.validMentionPrecedingChars = /(?:^|[^a-zA-Z0-9_!#$%&amp;*@＠]|RT:?)/;</span>
<a href="#l1.143"></a><span id="l1.143" class="difflineplus">+  twttr.txt.regexen.validMentionPrecedingChars = /(?:^|[^a-zA-Z0-9_!#$%&amp;*@＠]|(?:^|[^a-zA-Z0-9_+~.-])(?:rt|RT|rT|Rt):?)/;</span>
<a href="#l1.144"></a><span id="l1.144">   twttr.txt.regexen.atSigns = /[@＠]/;</span>
<a href="#l1.145"></a><span id="l1.145">   twttr.txt.regexen.validMentionOrList = regexSupplant(</span>
<a href="#l1.146"></a><span id="l1.146">     '(#{validMentionPrecedingChars})' +  // $1: Preceding character</span>
<a href="#l1.147"></a><span id="l1.147">     '(#{atSigns})' +                     // $2: At mark</span>
<a href="#l1.148"></a><span id="l1.148">     '([a-zA-Z0-9_]{1,20})' +             // $3: Screen name</span>
<a href="#l1.149"></a><span id="l1.149">     '(\/[a-zA-Z][a-zA-Z0-9_\-]{0,24})?'  // $4: List (optional)</span>
<a href="#l1.150"></a><span id="l1.150">   , 'g');</span>
<a href="#l1.151"></a><span id="l1.151">   twttr.txt.regexen.validReply = regexSupplant(/^(?:#{spaces})*#{atSigns}([a-zA-Z0-9_]{1,20})/);</span>
<a href="#l1.152"></a><span id="l1.152" class="difflineat">@@ -247,40 +179,144 @@ var window = {};</span>
<a href="#l1.153"></a><span id="l1.153"> </span>
<a href="#l1.154"></a><span id="l1.154">   // URL related regex collection</span>
<a href="#l1.155"></a><span id="l1.155">   twttr.txt.regexen.validUrlPrecedingChars = regexSupplant(/(?:[^A-Za-z0-9@＠$#＃#{invalid_chars_group}]|^)/);</span>
<a href="#l1.156"></a><span id="l1.156">   twttr.txt.regexen.invalidUrlWithoutProtocolPrecedingChars = /[-_.\/]$/;</span>
<a href="#l1.157"></a><span id="l1.157">   twttr.txt.regexen.invalidDomainChars = stringSupplant(&quot;#{punct}#{spaces_group}#{invalid_chars_group}&quot;, twttr.txt.regexen);</span>
<a href="#l1.158"></a><span id="l1.158">   twttr.txt.regexen.validDomainChars = regexSupplant(/[^#{invalidDomainChars}]/);</span>
<a href="#l1.159"></a><span id="l1.159">   twttr.txt.regexen.validSubdomain = regexSupplant(/(?:(?:#{validDomainChars}(?:[_-]|#{validDomainChars})*)?#{validDomainChars}\.)/);</span>
<a href="#l1.160"></a><span id="l1.160">   twttr.txt.regexen.validDomainName = regexSupplant(/(?:(?:#{validDomainChars}(?:-|#{validDomainChars})*)?#{validDomainChars}\.)/);</span>
<a href="#l1.161"></a><span id="l1.161" class="difflineminus">-  twttr.txt.regexen.validGTLD = regexSupplant(/(?:(?:aero|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|pro|tel|travel|xxx)(?=[^0-9a-zA-Z]|$))/);</span>
<a href="#l1.162"></a><span id="l1.162" class="difflineplus">+  twttr.txt.regexen.validGTLD = regexSupplant(RegExp(</span>
<a href="#l1.163"></a><span id="l1.163" class="difflineplus">+    '(?:(?:' +</span>
<a href="#l1.164"></a><span id="l1.164" class="difflineplus">+    '삼성|닷컴|닷넷|香格里拉|餐厅|食品|飞利浦|電訊盈科|集团|购物|谷歌|诺基亚|联通|网络|网站|网店|网址|组织机构|移动|珠宝|点看|游戏|淡马锡|机构|書籍|时尚|新闻|政府|政务|' +</span>
<a href="#l1.165"></a><span id="l1.165" class="difflineplus">+    '手表|手机|我爱你|慈善|微博|广东|工行|家電|娱乐|大拿|在线|嘉里大酒店|嘉里|商标|商店|商城|公益|公司|八卦|健康|信息|佛山|企业|中文网|中信|世界|ポイント|ファッション|' +</span>
<a href="#l1.166"></a><span id="l1.166" class="difflineplus">+    'セール|ストア|コム|グーグル|クラウド|みんな|คอม|संगठन|नेट|कॉम|همراه|موقع|موبايلي|كوم|شبكة|بيتك|بازار|العليان|' +</span>
<a href="#l1.167"></a><span id="l1.167" class="difflineplus">+    'ارامكو|ابوظبي|קום|сайт|рус|орг|онлайн|москва|ком|дети|zuerich|zone|zippo|zip|zero|zara|zappos|' +</span>
<a href="#l1.168"></a><span id="l1.168" class="difflineplus">+    'yun|youtube|you|yokohama|yoga|yodobashi|yandex|yamaxun|yahoo|yachts|xyz|xxx|xperia|xin|xihuan|' +</span>
<a href="#l1.169"></a><span id="l1.169" class="difflineplus">+    'xfinity|xerox|xbox|wtf|wtc|world|works|work|woodside|wolterskluwer|wme|wine|windows|win|' +</span>
<a href="#l1.170"></a><span id="l1.170" class="difflineplus">+    'williamhill|wiki|wien|whoswho|weir|weibo|wedding|wed|website|weber|webcam|weatherchannel|' +</span>
<a href="#l1.171"></a><span id="l1.171" class="difflineplus">+    'weather|watches|watch|warman|wanggou|wang|walter|wales|vuelos|voyage|voto|voting|vote|' +</span>
<a href="#l1.172"></a><span id="l1.172" class="difflineplus">+    'volkswagen|vodka|vlaanderen|viva|vistaprint|vista|vision|virgin|vip|vin|villas|viking|vig|video|' +</span>
<a href="#l1.173"></a><span id="l1.173" class="difflineplus">+    'viajes|vet|versicherung|vermögensberatung|vermögensberater|verisign|ventures|vegas|vana|' +</span>
<a href="#l1.174"></a><span id="l1.174" class="difflineplus">+    'vacations|ups|uol|uno|university|unicom|ubs|tvs|tushu|tunes|tui|tube|trv|trust|' +</span>
<a href="#l1.175"></a><span id="l1.175" class="difflineplus">+    'travelersinsurance|travelers|travelchannel|travel|training|trading|trade|toys|toyota|town|tours|' +</span>
<a href="#l1.176"></a><span id="l1.176" class="difflineplus">+    'total|toshiba|toray|top|tools|tokyo|today|tmall|tirol|tires|tips|tiffany|tienda|tickets|theatre|' +</span>
<a href="#l1.177"></a><span id="l1.177" class="difflineplus">+    'theater|thd|teva|tennis|temasek|telefonica|telecity|tel|technology|tech|team|tdk|tci|taxi|tax|' +</span>
<a href="#l1.178"></a><span id="l1.178" class="difflineplus">+    'tattoo|tatar|tatamotors|taobao|talk|taipei|tab|systems|symantec|sydney|swiss|swatch|suzuki|' +</span>
<a href="#l1.179"></a><span id="l1.179" class="difflineplus">+    'surgery|surf|support|supply|supplies|sucks|style|study|studio|stream|store|storage|stockholm|' +</span>
<a href="#l1.180"></a><span id="l1.180" class="difflineplus">+    'stcgroup|stc|statoil|statefarm|statebank|starhub|star|stada|srl|spreadbetting|spot|spiegel|' +</span>
<a href="#l1.181"></a><span id="l1.181" class="difflineplus">+    'space|soy|sony|song|solutions|solar|sohu|software|softbank|social|soccer|sncf|smile|skype|sky|' +</span>
<a href="#l1.182"></a><span id="l1.182" class="difflineplus">+    'skin|ski|site|singles|sina|silk|shriram|show|shouji|shopping|shop|shoes|shiksha|shia|shell|shaw|' +</span>
<a href="#l1.183"></a><span id="l1.183" class="difflineplus">+    'sharp|shangrila|sfr|sexy|sex|sew|seven|services|sener|select|seek|security|seat|scot|scor|' +</span>
<a href="#l1.184"></a><span id="l1.184" class="difflineplus">+    'science|schwarz|schule|school|scholarships|schmidt|schaeffler|scb|sca|sbs|sbi|saxo|save|sas|' +</span>
<a href="#l1.185"></a><span id="l1.185" class="difflineplus">+    'sarl|sapo|sap|sanofi|sandvikcoromant|sandvik|samsung|salon|sale|sakura|safety|safe|saarland|' +</span>
<a href="#l1.186"></a><span id="l1.186" class="difflineplus">+    'ryukyu|rwe|run|ruhr|rsvp|room|rodeo|rocks|rocher|rip|rio|ricoh|richardli|rich|rexroth|reviews|' +</span>
<a href="#l1.187"></a><span id="l1.187" class="difflineplus">+    'review|restaurant|rest|republican|report|repair|rentals|rent|ren|reit|reisen|reise|rehab|' +</span>
<a href="#l1.188"></a><span id="l1.188" class="difflineplus">+    'redumbrella|redstone|red|recipes|realty|realtor|realestate|read|racing|quest|quebec|qpon|pwc|' +</span>
<a href="#l1.189"></a><span id="l1.189" class="difflineplus">+    'pub|protection|property|properties|promo|progressive|prof|productions|prod|pro|prime|press|' +</span>
<a href="#l1.190"></a><span id="l1.190" class="difflineplus">+    'praxi|post|porn|politie|poker|pohl|pnc|plus|plumbing|playstation|play|place|pizza|pioneer|pink|' +</span>
<a href="#l1.191"></a><span id="l1.191" class="difflineplus">+    'ping|pin|pid|pictures|pictet|pics|piaget|physio|photos|photography|photo|philips|pharmacy|pet|' +</span>
<a href="#l1.192"></a><span id="l1.192" class="difflineplus">+    'pccw|passagens|party|parts|partners|pars|paris|panerai|pamperedchef|page|ovh|ott|otsuka|osaka|' +</span>
<a href="#l1.193"></a><span id="l1.193" class="difflineplus">+    'origins|orientexpress|organic|org|orange|oracle|ooo|online|onl|ong|one|omega|ollo|olayangroup|' +</span>
<a href="#l1.194"></a><span id="l1.194" class="difflineplus">+    'olayan|okinawa|office|obi|nyc|ntt|nrw|nra|nowtv|nowruz|now|norton|northwesternmutual|nokia|' +</span>
<a href="#l1.195"></a><span id="l1.195" class="difflineplus">+    'nissay|nissan|ninja|nikon|nico|nhk|ngo|nfl|nexus|nextdirect|next|news|new|neustar|network|' +</span>
<a href="#l1.196"></a><span id="l1.196" class="difflineplus">+    'netflix|netbank|net|nec|navy|natura|name|nagoya|nadex|mutuelle|mutual|museum|mtr|mtpc|mtn|' +</span>
<a href="#l1.197"></a><span id="l1.197" class="difflineplus">+    'movistar|movie|mov|motorcycles|moscow|mortgage|mormon|montblanc|money|monash|mom|moi|moe|moda|' +</span>
<a href="#l1.198"></a><span id="l1.198" class="difflineplus">+    'mobily|mobi|mma|mls|mlb|mitsubishi|mit|mini|mil|microsoft|miami|metlife|meo|menu|men|memorial|' +</span>
<a href="#l1.199"></a><span id="l1.199" class="difflineplus">+    'meme|melbourne|meet|media|med|mba|mattel|marriott|markets|marketing|market|mango|management|man|' +</span>
<a href="#l1.200"></a><span id="l1.200" class="difflineplus">+    'makeup|maison|maif|madrid|luxury|luxe|lupin|ltda|ltd|love|lotto|lotte|london|lol|locus|locker|' +</span>
<a href="#l1.201"></a><span id="l1.201" class="difflineplus">+    'loans|loan|lixil|living|live|lipsy|link|linde|lincoln|limo|limited|like|lighting|lifestyle|' +</span>
<a href="#l1.202"></a><span id="l1.202" class="difflineplus">+    'lifeinsurance|life|lidl|liaison|lgbt|lexus|lego|legal|leclerc|lease|lds|lawyer|law|latrobe|lat|' +</span>
<a href="#l1.203"></a><span id="l1.203" class="difflineplus">+    'lasalle|lanxess|landrover|land|lancaster|lamer|lamborghini|lacaixa|kyoto|kuokgroup|kred|krd|kpn|' +</span>
<a href="#l1.204"></a><span id="l1.204" class="difflineplus">+    'kpmg|kosher|komatsu|koeln|kiwi|kitchen|kindle|kinder|kim|kia|kfh|kerryproperties|kerrylogistics|' +</span>
<a href="#l1.205"></a><span id="l1.205" class="difflineplus">+    'kerryhotels|kddi|kaufen|juegos|jprs|jpmorgan|joy|jot|joburg|jobs|jnj|jmp|jll|jlc|jewelry|jetzt|' +</span>
<a href="#l1.206"></a><span id="l1.206" class="difflineplus">+    'jcp|jcb|java|jaguar|iwc|itv|itau|istanbul|ist|ismaili|iselect|irish|ipiranga|investments|' +</span>
<a href="#l1.207"></a><span id="l1.207" class="difflineplus">+    'international|int|insure|insurance|institute|ink|ing|info|infiniti|industries|immobilien|immo|' +</span>
<a href="#l1.208"></a><span id="l1.208" class="difflineplus">+    'imdb|imamat|ikano|iinet|ifm|icu|ice|icbc|ibm|hyundai|htc|hsbc|how|house|hotmail|hoteles|hosting|' +</span>
<a href="#l1.209"></a><span id="l1.209" class="difflineplus">+    'host|horse|honda|homes|homedepot|holiday|holdings|hockey|hkt|hiv|hitachi|hisamitsu|hiphop|hgtv|' +</span>
<a href="#l1.210"></a><span id="l1.210" class="difflineplus">+    'hermes|here|helsinki|help|healthcare|health|hdfcbank|haus|hangout|hamburg|guru|guitars|guide|' +</span>
<a href="#l1.211"></a><span id="l1.211" class="difflineplus">+    'guge|gucci|guardian|group|gripe|green|gratis|graphics|grainger|gov|got|gop|google|goog|goodyear|' +</span>
<a href="#l1.212"></a><span id="l1.212" class="difflineplus">+    'goo|golf|goldpoint|gold|godaddy|gmx|gmo|gmbh|gmail|globo|global|gle|glass|giving|gives|gifts|' +</span>
<a href="#l1.213"></a><span id="l1.213" class="difflineplus">+    'gift|ggee|genting|gent|gea|gdn|gbiz|garden|games|game|gallup|gallo|gallery|gal|fyi|futbol|' +</span>
<a href="#l1.214"></a><span id="l1.214" class="difflineplus">+    'furniture|fund|fujitsu|ftr|frontier|frontdoor|frogans|frl|fresenius|fox|foundation|forum|' +</span>
<a href="#l1.215"></a><span id="l1.215" class="difflineplus">+    'forsale|forex|ford|football|foodnetwork|foo|fly|flsmidth|flowers|florist|flir|flights|flickr|' +</span>
<a href="#l1.216"></a><span id="l1.216" class="difflineplus">+    'fitness|fit|fishing|fish|firmdale|firestone|fire|financial|finance|final|film|ferrero|feedback|' +</span>
<a href="#l1.217"></a><span id="l1.217" class="difflineplus">+    'fedex|fast|fashion|farmers|farm|fans|fan|family|faith|fairwinds|fail|fage|extraspace|express|' +</span>
<a href="#l1.218"></a><span id="l1.218" class="difflineplus">+    'exposed|expert|exchange|everbank|events|eus|eurovision|estate|esq|erni|ericsson|equipment|epson|' +</span>
<a href="#l1.219"></a><span id="l1.219" class="difflineplus">+    'epost|enterprises|engineering|engineer|energy|emerck|email|education|edu|edeka|eat|earth|dvag|' +</span>
<a href="#l1.220"></a><span id="l1.220" class="difflineplus">+    'durban|dupont|dunlop|dubai|dtv|drive|download|dot|doosan|domains|doha|dog|docs|dnp|discount|' +</span>
<a href="#l1.221"></a><span id="l1.221" class="difflineplus">+    'directory|direct|digital|diet|diamonds|dhl|dev|design|desi|dentist|dental|democrat|delta|' +</span>
<a href="#l1.222"></a><span id="l1.222" class="difflineplus">+    'deloitte|dell|delivery|degree|deals|dealer|deal|dds|dclk|day|datsun|dating|date|dance|dad|dabur|' +</span>
<a href="#l1.223"></a><span id="l1.223" class="difflineplus">+    'cyou|cymru|cuisinella|csc|cruises|crs|crown|cricket|creditunion|creditcard|credit|courses|' +</span>
<a href="#l1.224"></a><span id="l1.224" class="difflineplus">+    'coupons|coupon|country|corsica|coop|cool|cookingchannel|cooking|contractors|contact|consulting|' +</span>
<a href="#l1.225"></a><span id="l1.225" class="difflineplus">+    'construction|condos|comsec|computer|compare|company|community|commbank|comcast|com|cologne|' +</span>
<a href="#l1.226"></a><span id="l1.226" class="difflineplus">+    'college|coffee|codes|coach|clubmed|club|cloud|clothing|clinique|clinic|click|cleaning|claims|' +</span>
<a href="#l1.227"></a><span id="l1.227" class="difflineplus">+    'cityeats|city|citic|cisco|circle|cipriani|church|chrome|christmas|chloe|chintai|cheap|chat|' +</span>
<a href="#l1.228"></a><span id="l1.228" class="difflineplus">+    'chase|channel|chanel|cfd|cfa|cern|ceo|center|ceb|cbre|cbn|cba|catering|cat|casino|cash|casa|' +</span>
<a href="#l1.229"></a><span id="l1.229" class="difflineplus">+    'cartier|cars|careers|career|care|cards|caravan|car|capital|capetown|canon|cancerresearch|camp|' +</span>
<a href="#l1.230"></a><span id="l1.230" class="difflineplus">+    'camera|cam|call|cal|cafe|cab|bzh|buzz|buy|business|builders|build|bugatti|budapest|brussels|' +</span>
<a href="#l1.231"></a><span id="l1.231" class="difflineplus">+    'brother|broker|broadway|bridgestone|bradesco|boutique|bot|bostik|bosch|boots|book|boo|bond|bom|' +</span>
<a href="#l1.232"></a><span id="l1.232" class="difflineplus">+    'boehringer|boats|bnpparibas|bnl|bmw|bms|blue|bloomberg|blog|blanco|blackfriday|black|biz|bio|' +</span>
<a href="#l1.233"></a><span id="l1.233" class="difflineplus">+    'bingo|bing|bike|bid|bible|bharti|bet|best|berlin|bentley|beer|beats|bcn|bcg|bbva|bbc|bayern|' +</span>
<a href="#l1.234"></a><span id="l1.234" class="difflineplus">+    'bauhaus|bargains|barefoot|barclays|barclaycard|barcelona|bar|bank|band|baidu|baby|azure|axa|aws|' +</span>
<a href="#l1.235"></a><span id="l1.235" class="difflineplus">+    'avianca|autos|auto|author|audio|audible|audi|auction|attorney|associates|asia|arte|art|arpa|' +</span>
<a href="#l1.236"></a><span id="l1.236" class="difflineplus">+    'army|archi|aramco|aquarelle|apple|app|apartments|anz|anquan|android|analytics|amsterdam|amica|' +</span>
<a href="#l1.237"></a><span id="l1.237" class="difflineplus">+    'alstom|alsace|ally|allfinanz|alipay|alibaba|akdn|airtel|airforce|airbus|aig|agency|agakhan|afl|' +</span>
<a href="#l1.238"></a><span id="l1.238" class="difflineplus">+    'aetna|aero|aeg|adult|ads|adac|actor|active|aco|accountants|accountant|accenture|academy|' +</span>
<a href="#l1.239"></a><span id="l1.239" class="difflineplus">+    'abudhabi|abogado|able|abbvie|abbott|abb|aarp|aaa|onion' +</span>
<a href="#l1.240"></a><span id="l1.240" class="difflineplus">+    ')(?=[^0-9a-zA-Z@]|$))'));</span>
<a href="#l1.241"></a><span id="l1.241">   twttr.txt.regexen.validCCTLD = regexSupplant(RegExp(</span>
<a href="#l1.242"></a><span id="l1.242" class="difflineminus">-        &quot;(?:(?:ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|&quot; +</span>
<a href="#l1.243"></a><span id="l1.243" class="difflineminus">-        &quot;ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|&quot; +</span>
<a href="#l1.244"></a><span id="l1.244" class="difflineminus">-        &quot;ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|&quot; +</span>
<a href="#l1.245"></a><span id="l1.245" class="difflineminus">-        &quot;ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|&quot; +</span>
<a href="#l1.246"></a><span id="l1.246" class="difflineminus">-        &quot;na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|&quot; +</span>
<a href="#l1.247"></a><span id="l1.247" class="difflineminus">-        &quot;sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|&quot; +</span>
<a href="#l1.248"></a><span id="l1.248" class="difflineminus">-        &quot;ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)(?=[^0-9a-zA-Z]|$))&quot;));</span>
<a href="#l1.249"></a><span id="l1.249" class="difflineplus">+    '(?:(?:' +</span>
<a href="#l1.250"></a><span id="l1.250" class="difflineplus">+    '한국|香港|澳門|新加坡|台灣|台湾|中國|中国|გე|ไทย|ලංකා|ഭാരതം|ಭಾರತ|భారత్|சிங்கப்பூர்|இலங்கை|இந்தியா|ଭାରତ|ભારત|ਭਾਰਤ|' +</span>
<a href="#l1.251"></a><span id="l1.251" class="difflineplus">+    'ভাৰত|ভারত|বাংলা|भारत|پاکستان|مليسيا|مصر|قطر|فلسطين|عمان|عراق|سورية|سودان|تونس|بھارت|ایران|' +</span>
<a href="#l1.252"></a><span id="l1.252" class="difflineplus">+    'امارات|المغرب|السعودية|الجزائر|الاردن|հայ|қаз|укр|срб|рф|мон|мкд|ею|бел|бг|ελ|zw|zm|za|yt|ye|ws|' +</span>
<a href="#l1.253"></a><span id="l1.253" class="difflineplus">+    'wf|vu|vn|vi|vg|ve|vc|va|uz|uy|us|um|uk|ug|ua|tz|tw|tv|tt|tr|tp|to|tn|tm|tl|tk|tj|th|tg|tf|td|tc|' +</span>
<a href="#l1.254"></a><span id="l1.254" class="difflineplus">+    'sz|sy|sx|sv|su|st|ss|sr|so|sn|sm|sl|sk|sj|si|sh|sg|se|sd|sc|sb|sa|rw|ru|rs|ro|re|qa|py|pw|pt|ps|' +</span>
<a href="#l1.255"></a><span id="l1.255" class="difflineplus">+    'pr|pn|pm|pl|pk|ph|pg|pf|pe|pa|om|nz|nu|nr|np|no|nl|ni|ng|nf|ne|nc|na|mz|my|mx|mw|mv|mu|mt|ms|mr|' +</span>
<a href="#l1.256"></a><span id="l1.256" class="difflineplus">+    'mq|mp|mo|mn|mm|ml|mk|mh|mg|mf|me|md|mc|ma|ly|lv|lu|lt|ls|lr|lk|li|lc|lb|la|kz|ky|kw|kr|kp|kn|km|' +</span>
<a href="#l1.257"></a><span id="l1.257" class="difflineplus">+    'ki|kh|kg|ke|jp|jo|jm|je|it|is|ir|iq|io|in|im|il|ie|id|hu|ht|hr|hn|hm|hk|gy|gw|gu|gt|gs|gr|gq|gp|' +</span>
<a href="#l1.258"></a><span id="l1.258" class="difflineplus">+    'gn|gm|gl|gi|gh|gg|gf|ge|gd|gb|ga|fr|fo|fm|fk|fj|fi|eu|et|es|er|eh|eg|ee|ec|dz|do|dm|dk|dj|de|cz|' +</span>
<a href="#l1.259"></a><span id="l1.259" class="difflineplus">+    'cy|cx|cw|cv|cu|cr|co|cn|cm|cl|ck|ci|ch|cg|cf|cd|cc|ca|bz|by|bw|bv|bt|bs|br|bq|bo|bn|bm|bl|bj|bi|' +</span>
<a href="#l1.260"></a><span id="l1.260" class="difflineplus">+    'bh|bg|bf|be|bd|bb|ba|az|ax|aw|au|at|as|ar|aq|ao|an|am|al|ai|ag|af|ae|ad|ac' +</span>
<a href="#l1.261"></a><span id="l1.261" class="difflineplus">+    ')(?=[^0-9a-zA-Z@]|$))'));</span>
<a href="#l1.262"></a><span id="l1.262">   twttr.txt.regexen.validPunycode = regexSupplant(/(?:xn--[0-9a-z]+)/);</span>
<a href="#l1.263"></a><span id="l1.263" class="difflineplus">+  twttr.txt.regexen.validSpecialCCTLD = regexSupplant(RegExp(</span>
<a href="#l1.264"></a><span id="l1.264" class="difflineplus">+    '(?:(?:co|tv)(?=[^0-9a-zA-Z@]|$))'));</span>
<a href="#l1.265"></a><span id="l1.265">   twttr.txt.regexen.validDomain = regexSupplant(/(?:#{validSubdomain}*#{validDomainName}(?:#{validGTLD}|#{validCCTLD}|#{validPunycode}))/);</span>
<a href="#l1.266"></a><span id="l1.266">   twttr.txt.regexen.validAsciiDomain = regexSupplant(/(?:(?:[\-a-z0-9#{latinAccentChars}]+)\.)+(?:#{validGTLD}|#{validCCTLD}|#{validPunycode})/gi);</span>
<a href="#l1.267"></a><span id="l1.267" class="difflineminus">-  twttr.txt.regexen.invalidShortDomain = regexSupplant(/^#{validDomainName}#{validCCTLD}$/);</span>
<a href="#l1.268"></a><span id="l1.268" class="difflineplus">+  twttr.txt.regexen.invalidShortDomain = regexSupplant(/^#{validDomainName}#{validCCTLD}$/i);</span>
<a href="#l1.269"></a><span id="l1.269" class="difflineplus">+  twttr.txt.regexen.validSpecialShortDomain = regexSupplant(/^#{validDomainName}#{validSpecialCCTLD}$/i);</span>
<a href="#l1.270"></a><span id="l1.270"> </span>
<a href="#l1.271"></a><span id="l1.271">   twttr.txt.regexen.validPortNumber = regexSupplant(/[0-9]+/);</span>
<a href="#l1.272"></a><span id="l1.272"> </span>
<a href="#l1.273"></a><span id="l1.273" class="difflineminus">-  twttr.txt.regexen.validGeneralUrlPathChars = regexSupplant(/[a-z0-9!\*';:=\+,\.\$\/%#\[\]\-_~@|&amp;#{latinAccentChars}]/i);</span>
<a href="#l1.274"></a><span id="l1.274" class="difflineminus">-  // Allow URL paths to contain balanced parens</span>
<a href="#l1.275"></a><span id="l1.275" class="difflineplus">+  twttr.txt.regexen.cyrillicLettersAndMarks = regexSupplant(/\u0400-\u04FF/);</span>
<a href="#l1.276"></a><span id="l1.276" class="difflineplus">+  twttr.txt.regexen.validGeneralUrlPathChars = regexSupplant(/[a-z#{cyrillicLettersAndMarks}0-9!\*';:=\+,\.\$\/%#\[\]\-_~@\|&amp;#{latinAccentChars}]/i);</span>
<a href="#l1.277"></a><span id="l1.277" class="difflineplus">+  // Allow URL paths to contain up to two nested levels of balanced parens</span>
<a href="#l1.278"></a><span id="l1.278">   //  1. Used in Wikipedia URLs like /Primer_(film)</span>
<a href="#l1.279"></a><span id="l1.279">   //  2. Used in IIS sessions like /S(dfd346)/</span>
<a href="#l1.280"></a><span id="l1.280" class="difflineminus">-  twttr.txt.regexen.validUrlBalancedParens = regexSupplant(/\(#{validGeneralUrlPathChars}+\)/i);</span>
<a href="#l1.281"></a><span id="l1.281" class="difflineplus">+  //  3. Used in Rdio URLs like /track/We_Up_(Album_Version_(Edited))/</span>
<a href="#l1.282"></a><span id="l1.282" class="difflineplus">+  twttr.txt.regexen.validUrlBalancedParens = regexSupplant(</span>
<a href="#l1.283"></a><span id="l1.283" class="difflineplus">+    '\\('                                   +</span>
<a href="#l1.284"></a><span id="l1.284" class="difflineplus">+      '(?:'                                 +</span>
<a href="#l1.285"></a><span id="l1.285" class="difflineplus">+        '#{validGeneralUrlPathChars}+'      +</span>
<a href="#l1.286"></a><span id="l1.286" class="difflineplus">+        '|'                                 +</span>
<a href="#l1.287"></a><span id="l1.287" class="difflineplus">+        // allow one nested level of balanced parentheses</span>
<a href="#l1.288"></a><span id="l1.288" class="difflineplus">+        '(?:'                               +</span>
<a href="#l1.289"></a><span id="l1.289" class="difflineplus">+          '#{validGeneralUrlPathChars}*'    +</span>
<a href="#l1.290"></a><span id="l1.290" class="difflineplus">+          '\\('                             +</span>
<a href="#l1.291"></a><span id="l1.291" class="difflineplus">+            '#{validGeneralUrlPathChars}+'  +</span>
<a href="#l1.292"></a><span id="l1.292" class="difflineplus">+          '\\)'                             +</span>
<a href="#l1.293"></a><span id="l1.293" class="difflineplus">+          '#{validGeneralUrlPathChars}*'    +</span>
<a href="#l1.294"></a><span id="l1.294" class="difflineplus">+        ')'                                 +</span>
<a href="#l1.295"></a><span id="l1.295" class="difflineplus">+      ')'                                   +</span>
<a href="#l1.296"></a><span id="l1.296" class="difflineplus">+    '\\)'</span>
<a href="#l1.297"></a><span id="l1.297" class="difflineplus">+  , 'i');</span>
<a href="#l1.298"></a><span id="l1.298">   // Valid end-of-path chracters (so /foo. does not gobble the period).</span>
<a href="#l1.299"></a><span id="l1.299">   // 1. Allow =&amp;# for empty URL parameters and other URL-join artifacts</span>
<a href="#l1.300"></a><span id="l1.300" class="difflineminus">-  twttr.txt.regexen.validUrlPathEndingChars = regexSupplant(/[\+\-a-z0-9=_#\/#{latinAccentChars}]|(?:#{validUrlBalancedParens})/i);</span>
<a href="#l1.301"></a><span id="l1.301" class="difflineplus">+  twttr.txt.regexen.validUrlPathEndingChars = regexSupplant(/[\+\-a-z#{cyrillicLettersAndMarks}0-9=_#\/#{latinAccentChars}]|(?:#{validUrlBalancedParens})/i);</span>
<a href="#l1.302"></a><span id="l1.302">   // Allow @ in a url, but only in the middle. Catch things like http://example.com/@user/</span>
<a href="#l1.303"></a><span id="l1.303">   twttr.txt.regexen.validUrlPath = regexSupplant('(?:' +</span>
<a href="#l1.304"></a><span id="l1.304">     '(?:' +</span>
<a href="#l1.305"></a><span id="l1.305">       '#{validGeneralUrlPathChars}*' +</span>
<a href="#l1.306"></a><span id="l1.306">         '(?:#{validUrlBalancedParens}#{validGeneralUrlPathChars}*)*' +</span>
<a href="#l1.307"></a><span id="l1.307">         '#{validUrlPathEndingChars}'+</span>
<a href="#l1.308"></a><span id="l1.308">       ')|(?:@#{validGeneralUrlPathChars}+\/)'+</span>
<a href="#l1.309"></a><span id="l1.309">     ')', 'i');</span>
<a href="#l1.310"></a><span id="l1.310" class="difflineat">@@ -304,17 +340,17 @@ var window = {};</span>
<a href="#l1.311"></a><span id="l1.311">   twttr.txt.regexen.urlHasProtocol = /^https?:\/\//i;</span>
<a href="#l1.312"></a><span id="l1.312">   twttr.txt.regexen.urlHasHttps = /^https:\/\//i;</span>
<a href="#l1.313"></a><span id="l1.313"> </span>
<a href="#l1.314"></a><span id="l1.314">   // cashtag related regex</span>
<a href="#l1.315"></a><span id="l1.315">   twttr.txt.regexen.cashtag = /[a-z]{1,6}(?:[._][a-z]{1,2})?/i;</span>
<a href="#l1.316"></a><span id="l1.316">   twttr.txt.regexen.validCashtag = regexSupplant('(^|#{spaces})(\\$)(#{cashtag})(?=$|\\s|[#{punct}])', 'gi');</span>
<a href="#l1.317"></a><span id="l1.317"> </span>
<a href="#l1.318"></a><span id="l1.318">   // These URL validation pattern strings are based on the ABNF from RFC 3986</span>
<a href="#l1.319"></a><span id="l1.319" class="difflineminus">-  twttr.txt.regexen.validateUrlUnreserved = /[a-z0-9\-._~]/i;</span>
<a href="#l1.320"></a><span id="l1.320" class="difflineplus">+  twttr.txt.regexen.validateUrlUnreserved = /[a-z\u0400-\u04FF0-9\-._~]/i;</span>
<a href="#l1.321"></a><span id="l1.321">   twttr.txt.regexen.validateUrlPctEncoded = /(?:%[0-9a-f]{2})/i;</span>
<a href="#l1.322"></a><span id="l1.322">   twttr.txt.regexen.validateUrlSubDelims = /[!$&amp;'()*+,;=]/i;</span>
<a href="#l1.323"></a><span id="l1.323">   twttr.txt.regexen.validateUrlPchar = regexSupplant('(?:' +</span>
<a href="#l1.324"></a><span id="l1.324">     '#{validateUrlUnreserved}|' +</span>
<a href="#l1.325"></a><span id="l1.325">     '#{validateUrlPctEncoded}|' +</span>
<a href="#l1.326"></a><span id="l1.326">     '#{validateUrlSubDelims}|' +</span>
<a href="#l1.327"></a><span id="l1.327">     '[:|@]' +</span>
<a href="#l1.328"></a><span id="l1.328">   ')', 'i');</span>
<a href="#l1.329"></a><span id="l1.329" class="difflineat">@@ -473,17 +509,17 @@ var window = {};</span>
<a href="#l1.330"></a><span id="l1.330"> </span>
<a href="#l1.331"></a><span id="l1.331">   twttr.txt.linkToHashtag = function(entity, text, options) {</span>
<a href="#l1.332"></a><span id="l1.332">     var hash = text.substring(entity.indices[0], entity.indices[0] + 1);</span>
<a href="#l1.333"></a><span id="l1.333">     var hashtag = twttr.txt.htmlEscape(entity.hashtag);</span>
<a href="#l1.334"></a><span id="l1.334">     var attrs = clone(options.htmlAttrs || {});</span>
<a href="#l1.335"></a><span id="l1.335">     attrs.href = options.hashtagUrlBase + hashtag;</span>
<a href="#l1.336"></a><span id="l1.336">     attrs.title = &quot;#&quot; + hashtag;</span>
<a href="#l1.337"></a><span id="l1.337">     attrs[&quot;class&quot;] = options.hashtagClass;</span>
<a href="#l1.338"></a><span id="l1.338" class="difflineminus">-    if (hashtag[0].match(twttr.txt.regexen.rtl_chars)){</span>
<a href="#l1.339"></a><span id="l1.339" class="difflineplus">+    if (hashtag.charAt(0).match(twttr.txt.regexen.rtl_chars)){</span>
<a href="#l1.340"></a><span id="l1.340">       attrs[&quot;class&quot;] += &quot; rtl&quot;;</span>
<a href="#l1.341"></a><span id="l1.341">     }</span>
<a href="#l1.342"></a><span id="l1.342">     if (options.targetBlank) {</span>
<a href="#l1.343"></a><span id="l1.343">       attrs.target = '_blank';</span>
<a href="#l1.344"></a><span id="l1.344">     }</span>
<a href="#l1.345"></a><span id="l1.345"> </span>
<a href="#l1.346"></a><span id="l1.346">     return twttr.txt.linkToTextWithSymbol(entity, hash, hashtag, attrs, options);</span>
<a href="#l1.347"></a><span id="l1.347">   };</span>
<a href="#l1.348"></a><span id="l1.348" class="difflineat">@@ -678,32 +714,44 @@ var window = {};</span>
<a href="#l1.349"></a><span id="l1.349">       }</span>
<a href="#l1.350"></a><span id="l1.350">       beginIndex = entity.indices[1];</span>
<a href="#l1.351"></a><span id="l1.351">     }</span>
<a href="#l1.352"></a><span id="l1.352">     result += nonEntity(text.substring(beginIndex, text.length));</span>
<a href="#l1.353"></a><span id="l1.353">     return result;</span>
<a href="#l1.354"></a><span id="l1.354">   };</span>
<a href="#l1.355"></a><span id="l1.355"> </span>
<a href="#l1.356"></a><span id="l1.356">   twttr.txt.autoLinkWithJSON = function(text, json, options) {</span>
<a href="#l1.357"></a><span id="l1.357" class="difflineplus">+    // map JSON entity to twitter-text entity</span>
<a href="#l1.358"></a><span id="l1.358" class="difflineplus">+    if (json.user_mentions) {</span>
<a href="#l1.359"></a><span id="l1.359" class="difflineplus">+      for (var i = 0; i &lt; json.user_mentions.length; i++) {</span>
<a href="#l1.360"></a><span id="l1.360" class="difflineplus">+        // this is a @mention</span>
<a href="#l1.361"></a><span id="l1.361" class="difflineplus">+        json.user_mentions[i].screenName = json.user_mentions[i].screen_name;</span>
<a href="#l1.362"></a><span id="l1.362" class="difflineplus">+      }</span>
<a href="#l1.363"></a><span id="l1.363" class="difflineplus">+    }</span>
<a href="#l1.364"></a><span id="l1.364" class="difflineplus">+</span>
<a href="#l1.365"></a><span id="l1.365" class="difflineplus">+    if (json.hashtags) {</span>
<a href="#l1.366"></a><span id="l1.366" class="difflineplus">+      for (var i = 0; i &lt; json.hashtags.length; i++) {</span>
<a href="#l1.367"></a><span id="l1.367" class="difflineplus">+        // this is a #hashtag</span>
<a href="#l1.368"></a><span id="l1.368" class="difflineplus">+        json.hashtags[i].hashtag = json.hashtags[i].text;</span>
<a href="#l1.369"></a><span id="l1.369" class="difflineplus">+      }</span>
<a href="#l1.370"></a><span id="l1.370" class="difflineplus">+    }</span>
<a href="#l1.371"></a><span id="l1.371" class="difflineplus">+</span>
<a href="#l1.372"></a><span id="l1.372" class="difflineplus">+    if (json.symbols) {</span>
<a href="#l1.373"></a><span id="l1.373" class="difflineplus">+      for (var i = 0; i &lt; json.symbols.length; i++) {</span>
<a href="#l1.374"></a><span id="l1.374" class="difflineplus">+        // this is a $CASH tag</span>
<a href="#l1.375"></a><span id="l1.375" class="difflineplus">+        json.symbols[i].cashtag = json.symbols[i].text;</span>
<a href="#l1.376"></a><span id="l1.376" class="difflineplus">+      }</span>
<a href="#l1.377"></a><span id="l1.377" class="difflineplus">+    }</span>
<a href="#l1.378"></a><span id="l1.378" class="difflineplus">+</span>
<a href="#l1.379"></a><span id="l1.379">     // concatenate all entities</span>
<a href="#l1.380"></a><span id="l1.380">     var entities = [];</span>
<a href="#l1.381"></a><span id="l1.381">     for (var key in json) {</span>
<a href="#l1.382"></a><span id="l1.382">       entities = entities.concat(json[key]);</span>
<a href="#l1.383"></a><span id="l1.383">     }</span>
<a href="#l1.384"></a><span id="l1.384" class="difflineminus">-    // map JSON entity to twitter-text entity</span>
<a href="#l1.385"></a><span id="l1.385" class="difflineminus">-    for (var i = 0; i &lt; entities.length; i++) {</span>
<a href="#l1.386"></a><span id="l1.386" class="difflineminus">-      entity = entities[i];</span>
<a href="#l1.387"></a><span id="l1.387" class="difflineminus">-      if (entity.screen_name) {</span>
<a href="#l1.388"></a><span id="l1.388" class="difflineminus">-        // this is @mention</span>
<a href="#l1.389"></a><span id="l1.389" class="difflineminus">-        entity.screenName = entity.screen_name;</span>
<a href="#l1.390"></a><span id="l1.390" class="difflineminus">-      } else if (entity.text) {</span>
<a href="#l1.391"></a><span id="l1.391" class="difflineminus">-        // this is #hashtag</span>
<a href="#l1.392"></a><span id="l1.392" class="difflineminus">-        entity.hashtag = entity.text;</span>
<a href="#l1.393"></a><span id="l1.393" class="difflineminus">-      }</span>
<a href="#l1.394"></a><span id="l1.394" class="difflineminus">-    }</span>
<a href="#l1.395"></a><span id="l1.395" class="difflineplus">+</span>
<a href="#l1.396"></a><span id="l1.396">     // modify indices to UTF-16</span>
<a href="#l1.397"></a><span id="l1.397">     twttr.txt.modifyIndicesFromUnicodeToUTF16(text, entities);</span>
<a href="#l1.398"></a><span id="l1.398"> </span>
<a href="#l1.399"></a><span id="l1.399">     return twttr.txt.autoLinkEntities(text, entities, options);</span>
<a href="#l1.400"></a><span id="l1.400">   };</span>
<a href="#l1.401"></a><span id="l1.401"> </span>
<a href="#l1.402"></a><span id="l1.402">   twttr.txt.extractHtmlAttrsFromOptions = function(options) {</span>
<a href="#l1.403"></a><span id="l1.403">     var htmlAttrs = {};</span>
<a href="#l1.404"></a><span id="l1.404" class="difflineat">@@ -856,17 +904,16 @@ var window = {};</span>
<a href="#l1.405"></a><span id="l1.405"> </span>
<a href="#l1.406"></a><span id="l1.406">     return urlsOnly;</span>
<a href="#l1.407"></a><span id="l1.407">   };</span>
<a href="#l1.408"></a><span id="l1.408"> </span>
<a href="#l1.409"></a><span id="l1.409">   twttr.txt.extractUrlsWithIndices = function(text, options) {</span>
<a href="#l1.410"></a><span id="l1.410">     if (!options) {</span>
<a href="#l1.411"></a><span id="l1.411">       options = {extractUrlsWithoutProtocol: true};</span>
<a href="#l1.412"></a><span id="l1.412">     }</span>
<a href="#l1.413"></a><span id="l1.413" class="difflineminus">-</span>
<a href="#l1.414"></a><span id="l1.414">     if (!text || (options.extractUrlsWithoutProtocol ? !text.match(/\./) : !text.match(/:/))) {</span>
<a href="#l1.415"></a><span id="l1.415">       return [];</span>
<a href="#l1.416"></a><span id="l1.416">     }</span>
<a href="#l1.417"></a><span id="l1.417"> </span>
<a href="#l1.418"></a><span id="l1.418">     var urls = [];</span>
<a href="#l1.419"></a><span id="l1.419"> </span>
<a href="#l1.420"></a><span id="l1.420">     while (twttr.txt.regexen.extractUrl.exec(text)) {</span>
<a href="#l1.421"></a><span id="l1.421">       var before = RegExp.$2, url = RegExp.$3, protocol = RegExp.$4, domain = RegExp.$5, path = RegExp.$7;</span>
<a href="#l1.422"></a><span id="l1.422" class="difflineat">@@ -876,41 +923,38 @@ var window = {};</span>
<a href="#l1.423"></a><span id="l1.423">       // if protocol is missing and domain contains non-ASCII characters,</span>
<a href="#l1.424"></a><span id="l1.424">       // extract ASCII-only domains.</span>
<a href="#l1.425"></a><span id="l1.425">       if (!protocol) {</span>
<a href="#l1.426"></a><span id="l1.426">         if (!options.extractUrlsWithoutProtocol</span>
<a href="#l1.427"></a><span id="l1.427">             || before.match(twttr.txt.regexen.invalidUrlWithoutProtocolPrecedingChars)) {</span>
<a href="#l1.428"></a><span id="l1.428">           continue;</span>
<a href="#l1.429"></a><span id="l1.429">         }</span>
<a href="#l1.430"></a><span id="l1.430">         var lastUrl = null,</span>
<a href="#l1.431"></a><span id="l1.431" class="difflineminus">-            lastUrlInvalidMatch = false,</span>
<a href="#l1.432"></a><span id="l1.432">             asciiEndPosition = 0;</span>
<a href="#l1.433"></a><span id="l1.433">         domain.replace(twttr.txt.regexen.validAsciiDomain, function(asciiDomain) {</span>
<a href="#l1.434"></a><span id="l1.434">           var asciiStartPosition = domain.indexOf(asciiDomain, asciiEndPosition);</span>
<a href="#l1.435"></a><span id="l1.435">           asciiEndPosition = asciiStartPosition + asciiDomain.length;</span>
<a href="#l1.436"></a><span id="l1.436">           lastUrl = {</span>
<a href="#l1.437"></a><span id="l1.437">             url: asciiDomain,</span>
<a href="#l1.438"></a><span id="l1.438">             indices: [startPosition + asciiStartPosition, startPosition + asciiEndPosition]</span>
<a href="#l1.439"></a><span id="l1.439">           };</span>
<a href="#l1.440"></a><span id="l1.440" class="difflineminus">-          lastUrlInvalidMatch = asciiDomain.match(twttr.txt.regexen.invalidShortDomain);</span>
<a href="#l1.441"></a><span id="l1.441" class="difflineminus">-          if (!lastUrlInvalidMatch) {</span>
<a href="#l1.442"></a><span id="l1.442" class="difflineplus">+          if (path</span>
<a href="#l1.443"></a><span id="l1.443" class="difflineplus">+              || asciiDomain.match(twttr.txt.regexen.validSpecialShortDomain)</span>
<a href="#l1.444"></a><span id="l1.444" class="difflineplus">+              || !asciiDomain.match(twttr.txt.regexen.invalidShortDomain)) {</span>
<a href="#l1.445"></a><span id="l1.445">             urls.push(lastUrl);</span>
<a href="#l1.446"></a><span id="l1.446">           }</span>
<a href="#l1.447"></a><span id="l1.447">         });</span>
<a href="#l1.448"></a><span id="l1.448"> </span>
<a href="#l1.449"></a><span id="l1.449">         // no ASCII-only domain found. Skip the entire URL.</span>
<a href="#l1.450"></a><span id="l1.450">         if (lastUrl == null) {</span>
<a href="#l1.451"></a><span id="l1.451">           continue;</span>
<a href="#l1.452"></a><span id="l1.452">         }</span>
<a href="#l1.453"></a><span id="l1.453"> </span>
<a href="#l1.454"></a><span id="l1.454">         // lastUrl only contains domain. Need to add path and query if they exist.</span>
<a href="#l1.455"></a><span id="l1.455">         if (path) {</span>
<a href="#l1.456"></a><span id="l1.456" class="difflineminus">-          if (lastUrlInvalidMatch) {</span>
<a href="#l1.457"></a><span id="l1.457" class="difflineminus">-            urls.push(lastUrl);</span>
<a href="#l1.458"></a><span id="l1.458" class="difflineminus">-          }</span>
<a href="#l1.459"></a><span id="l1.459">           lastUrl.url = url.replace(domain, lastUrl.url);</span>
<a href="#l1.460"></a><span id="l1.460">           lastUrl.indices[1] = endPosition;</span>
<a href="#l1.461"></a><span id="l1.461">         }</span>
<a href="#l1.462"></a><span id="l1.462">       } else {</span>
<a href="#l1.463"></a><span id="l1.463">         // In the case of t.co URLs, don't allow additional path characters.</span>
<a href="#l1.464"></a><span id="l1.464">         if (url.match(twttr.txt.regexen.validTcoUrl)) {</span>
<a href="#l1.465"></a><span id="l1.465">           url = RegExp.lastMatch;</span>
<a href="#l1.466"></a><span id="l1.466">           endPosition = startPosition + url.length;</span>
<a href="#l1.467"></a><span id="l1.467" class="difflineat">@@ -1194,30 +1238,30 @@ var window = {};</span>
<a href="#l1.468"></a><span id="l1.468"> </span>
<a href="#l1.469"></a><span id="l1.469">   // Returns the length of Tweet text with consideration to t.co URL replacement</span>
<a href="#l1.470"></a><span id="l1.470">   // and chars outside the basic multilingual plane that use 2 UTF16 code points</span>
<a href="#l1.471"></a><span id="l1.471">   twttr.txt.getTweetLength = function(text, options) {</span>
<a href="#l1.472"></a><span id="l1.472">     if (!options) {</span>
<a href="#l1.473"></a><span id="l1.473">       options = {</span>
<a href="#l1.474"></a><span id="l1.474">           // These come from https://api.twitter.com/1/help/configuration.json</span>
<a href="#l1.475"></a><span id="l1.475">           // described by https://dev.twitter.com/docs/api/1/get/help/configuration</span>
<a href="#l1.476"></a><span id="l1.476" class="difflineminus">-          short_url_length: 22,</span>
<a href="#l1.477"></a><span id="l1.477" class="difflineplus">+          short_url_length: 23,</span>
<a href="#l1.478"></a><span id="l1.478">           short_url_length_https: 23</span>
<a href="#l1.479"></a><span id="l1.479">       };</span>
<a href="#l1.480"></a><span id="l1.480">     }</span>
<a href="#l1.481"></a><span id="l1.481">     var textLength = twttr.txt.getUnicodeTextLength(text),</span>
<a href="#l1.482"></a><span id="l1.482">         urlsWithIndices = twttr.txt.extractUrlsWithIndices(text);</span>
<a href="#l1.483"></a><span id="l1.483">     twttr.txt.modifyIndicesFromUTF16ToUnicode(text, urlsWithIndices);</span>
<a href="#l1.484"></a><span id="l1.484"> </span>
<a href="#l1.485"></a><span id="l1.485">     for (var i = 0; i &lt; urlsWithIndices.length; i++) {</span>
<a href="#l1.486"></a><span id="l1.486" class="difflineminus">-    	// Subtract the length of the original URL</span>
<a href="#l1.487"></a><span id="l1.487" class="difflineplus">+      // Subtract the length of the original URL</span>
<a href="#l1.488"></a><span id="l1.488">       textLength += urlsWithIndices[i].indices[0] - urlsWithIndices[i].indices[1];</span>
<a href="#l1.489"></a><span id="l1.489"> </span>
<a href="#l1.490"></a><span id="l1.490">       // Add 23 characters for URL starting with https://</span>
<a href="#l1.491"></a><span id="l1.491" class="difflineminus">-      // Otherwise add 22 characters</span>
<a href="#l1.492"></a><span id="l1.492" class="difflineplus">+      // http:// URLs still use https://t.co so they are 23 characters as well</span>
<a href="#l1.493"></a><span id="l1.493">       if (urlsWithIndices[i].url.toLowerCase().match(twttr.txt.regexen.urlHasHttps)) {</span>
<a href="#l1.494"></a><span id="l1.494">          textLength += options.short_url_length_https;</span>
<a href="#l1.495"></a><span id="l1.495">       } else {</span>
<a href="#l1.496"></a><span id="l1.496">         textLength += options.short_url_length;</span>
<a href="#l1.497"></a><span id="l1.497">       }</span>
<a href="#l1.498"></a><span id="l1.498">     }</span>
<a href="#l1.499"></a><span id="l1.499"> </span>
<a href="#l1.500"></a><span id="l1.500">     return textLength;</span>
<a href="#l1.501"></a><span id="l1.501" class="difflineat">@@ -1237,22 +1281,29 @@ var window = {};</span>
<a href="#l1.502"></a><span id="l1.502">       return &quot;empty&quot;;</span>
<a href="#l1.503"></a><span id="l1.503">     }</span>
<a href="#l1.504"></a><span id="l1.504"> </span>
<a href="#l1.505"></a><span id="l1.505">     // Determine max length independent of URL length</span>
<a href="#l1.506"></a><span id="l1.506">     if (twttr.txt.getTweetLength(text) &gt; MAX_LENGTH) {</span>
<a href="#l1.507"></a><span id="l1.507">       return &quot;too_long&quot;;</span>
<a href="#l1.508"></a><span id="l1.508">     }</span>
<a href="#l1.509"></a><span id="l1.509"> </span>
<a href="#l1.510"></a><span id="l1.510" class="difflineplus">+    if (twttr.txt.hasInvalidCharacters(text)) {</span>
<a href="#l1.511"></a><span id="l1.511" class="difflineplus">+      return &quot;invalid_characters&quot;;</span>
<a href="#l1.512"></a><span id="l1.512" class="difflineplus">+    }</span>
<a href="#l1.513"></a><span id="l1.513" class="difflineplus">+</span>
<a href="#l1.514"></a><span id="l1.514" class="difflineplus">+    return false;</span>
<a href="#l1.515"></a><span id="l1.515" class="difflineplus">+  };</span>
<a href="#l1.516"></a><span id="l1.516" class="difflineplus">+</span>
<a href="#l1.517"></a><span id="l1.517" class="difflineplus">+  twttr.txt.hasInvalidCharacters = function(text) {</span>
<a href="#l1.518"></a><span id="l1.518">     for (var i = 0; i &lt; INVALID_CHARACTERS.length; i++) {</span>
<a href="#l1.519"></a><span id="l1.519">       if (text.indexOf(INVALID_CHARACTERS[i]) &gt;= 0) {</span>
<a href="#l1.520"></a><span id="l1.520" class="difflineminus">-        return &quot;invalid_characters&quot;;</span>
<a href="#l1.521"></a><span id="l1.521" class="difflineplus">+        return true;</span>
<a href="#l1.522"></a><span id="l1.522">       }</span>
<a href="#l1.523"></a><span id="l1.523">     }</span>
<a href="#l1.524"></a><span id="l1.524" class="difflineminus">-</span>
<a href="#l1.525"></a><span id="l1.525">     return false;</span>
<a href="#l1.526"></a><span id="l1.526">   };</span>
<a href="#l1.527"></a><span id="l1.527"> </span>
<a href="#l1.528"></a><span id="l1.528">   twttr.txt.isValidTweetText = function(text) {</span>
<a href="#l1.529"></a><span id="l1.529">     return !twttr.txt.isInvalidTweet(text);</span>
<a href="#l1.530"></a><span id="l1.530">   };</span>
<a href="#l1.531"></a><span id="l1.531"> </span>
<a href="#l1.532"></a><span id="l1.532">   twttr.txt.isValidUsername = function(username) {</span>
<a href="#l1.533"></a><span id="l1.533" class="difflineat">@@ -1334,16 +1385,20 @@ var window = {};</span>
<a href="#l1.534"></a><span id="l1.534">     // RegExp[&quot;$&amp;&quot;] is the text of the last match</span>
<a href="#l1.535"></a><span id="l1.535">     return (!string || (string.match(regex) &amp;&amp; RegExp[&quot;$&amp;&quot;] === string));</span>
<a href="#l1.536"></a><span id="l1.536">   }</span>
<a href="#l1.537"></a><span id="l1.537"> </span>
<a href="#l1.538"></a><span id="l1.538">   if (typeof module != 'undefined' &amp;&amp; module.exports) {</span>
<a href="#l1.539"></a><span id="l1.539">     module.exports = twttr.txt;</span>
<a href="#l1.540"></a><span id="l1.540">   }</span>
<a href="#l1.541"></a><span id="l1.541"> </span>
<a href="#l1.542"></a><span id="l1.542" class="difflineplus">+  if (typeof define == 'function' &amp;&amp; define.amd) {</span>
<a href="#l1.543"></a><span id="l1.543" class="difflineplus">+    define([], twttr.txt);</span>
<a href="#l1.544"></a><span id="l1.544" class="difflineplus">+  }</span>
<a href="#l1.545"></a><span id="l1.545" class="difflineplus">+</span>
<a href="#l1.546"></a><span id="l1.546">   if (typeof window != 'undefined') {</span>
<a href="#l1.547"></a><span id="l1.547">     if (window.twttr) {</span>
<a href="#l1.548"></a><span id="l1.548">       for (var prop in twttr) {</span>
<a href="#l1.549"></a><span id="l1.549">         window.twttr[prop] = twttr[prop];</span>
<a href="#l1.550"></a><span id="l1.550">       }</span>
<a href="#l1.551"></a><span id="l1.551">     } else {</span>
<a href="#l1.552"></a><span id="l1.552">       window.twttr = twttr;</span>
<a href="#l1.553"></a><span id="l1.553">     }</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

