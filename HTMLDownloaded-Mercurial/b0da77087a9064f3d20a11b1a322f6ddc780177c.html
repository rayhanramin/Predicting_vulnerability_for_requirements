<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 21873:b0da77087a9064f3d20a11b1a322f6ddc780177c</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ b0da77087a9064f3d20a11b1a322f6ddc780177c" />
<meta property="og:url" content="/comm-central/rev/b0da77087a9064f3d20a11b1a322f6ddc780177c" />
<meta property="og:description" content="Bug 1386916 - Port bug 1326520 to C-C: Rename nsIURI.path to nsIURI.pathQueryRef in JS files. rs=bustage-fix" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / b0da77087a9064f3d20a11b1a322f6ddc780177c 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/b0da77087a9064f3d20a11b1a322f6ddc780177c">shortlog</a> |
<a href="/comm-central/log/b0da77087a9064f3d20a11b1a322f6ddc780177c">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/b0da77087a9064f3d20a11b1a322f6ddc780177c">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/b0da77087a9064f3d20a11b1a322f6ddc780177c">files</a> |
changeset |
<a href="/comm-central/raw-rev/b0da77087a9064f3d20a11b1a322f6ddc780177c">raw</a>  | <a href="/comm-central/archive/b0da77087a9064f3d20a11b1a322f6ddc780177c.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1386916">Bug 1386916</a> - Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1326520">bug 1326520</a> to C-C: Rename nsIURI.path to nsIURI.pathQueryRef in JS files. rs=bustage-fix
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#74;&#111;&#114;&#103;&#32;&#75;&#32;&#60;&#106;&#111;&#114;&#103;&#107;&#64;&#106;&#111;&#114;&#103;&#107;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Thu, 03 Aug 2017 16:40:41 +0200</td></tr>

<tr>
 <td>changeset 21873</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/b0da77087a9064f3d20a11b1a322f6ddc780177c">b0da77087a9064f3d20a11b1a322f6ddc780177c</a></td>
</tr>



<tr>
<td>parent 21872</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/ec72d5653abf8c27512fdf7c4e83b05ca5d380df">ec72d5653abf8c27512fdf7c4e83b05ca5d380df</a>
</td>
</tr>

<tr>
<td>child 21874</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/72451623db7f2bcc4794cf146ac48515fdb2c494">72451623db7f2bcc4794cf146ac48515fdb2c494</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=b0da77087a9064f3d20a11b1a322f6ddc780177c">13358</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Thu, 03 Aug 2017 14:46:42 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@b0da77087a90 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=b0da77087a9064f3d20a11b1a322f6ddc780177c">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=b0da77087a9064f3d20a11b1a322f6ddc780177c&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=b0da77087a9064f3d20a11b1a322f6ddc780177c&newProject=comm-central&newRevision=b0da77087a9064f3d20a11b1a322f6ddc780177c&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=b0da77087a9064f3d20a11b1a322f6ddc780177c&newProject=comm-central&newRevision=b0da77087a9064f3d20a11b1a322f6ddc780177c&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=b0da77087a9064f3d20a11b1a322f6ddc780177c&newProject=comm-central&newRevision=b0da77087a9064f3d20a11b1a322f6ddc780177c&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28bustage-fix%29&revcount=50">bustage-fix</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1386916">1386916</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1326520">1326520</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1386916">Bug 1386916</a> - Port <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1326520">bug 1326520</a> to C-C: Rename nsIURI.path to nsIURI.pathQueryRef in JS files. rs=bustage-fix</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/base/content/calendar-dnd-listener.js">calendar/base/content/calendar-dnd-listener.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/base/content/calendar-dnd-listener.js">file</a> |
<a href="/comm-central/annotate/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/base/content/calendar-dnd-listener.js">annotate</a> |
<a href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/base/content/calendar-dnd-listener.js">diff</a> |
<a href="/comm-central/comparison/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/base/content/calendar-dnd-listener.js">comparison</a> |
<a href="/comm-central/log/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/base/content/calendar-dnd-listener.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/caldav/calDavCalendar.js">calendar/providers/caldav/calDavCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/caldav/calDavCalendar.js">file</a> |
<a href="/comm-central/annotate/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/caldav/calDavCalendar.js">annotate</a> |
<a href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/caldav/calDavCalendar.js">diff</a> |
<a href="/comm-central/comparison/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/caldav/calDavCalendar.js">comparison</a> |
<a href="/comm-central/log/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/caldav/calDavCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/gdata/components/calGoogleCalendar.js">calendar/providers/gdata/components/calGoogleCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/gdata/components/calGoogleCalendar.js">file</a> |
<a href="/comm-central/annotate/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/gdata/components/calGoogleCalendar.js">annotate</a> |
<a href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/gdata/components/calGoogleCalendar.js">diff</a> |
<a href="/comm-central/comparison/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/gdata/components/calGoogleCalendar.js">comparison</a> |
<a href="/comm-central/log/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/gdata/components/calGoogleCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/gdata/modules/gdataSession.jsm">calendar/providers/gdata/modules/gdataSession.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/gdata/modules/gdataSession.jsm">file</a> |
<a href="/comm-central/annotate/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/gdata/modules/gdataSession.jsm">annotate</a> |
<a href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/gdata/modules/gdataSession.jsm">diff</a> |
<a href="/comm-central/comparison/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/gdata/modules/gdataSession.jsm">comparison</a> |
<a href="/comm-central/log/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/gdata/modules/gdataSession.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/storage/calStorageCalendar.js">calendar/providers/storage/calStorageCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/storage/calStorageCalendar.js">file</a> |
<a href="/comm-central/annotate/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/storage/calStorageCalendar.js">annotate</a> |
<a href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/storage/calStorageCalendar.js">diff</a> |
<a href="/comm-central/comparison/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/storage/calStorageCalendar.js">comparison</a> |
<a href="/comm-central/log/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/storage/calStorageCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/wcap/calWcapCalendar.js">calendar/providers/wcap/calWcapCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/wcap/calWcapCalendar.js">file</a> |
<a href="/comm-central/annotate/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/wcap/calWcapCalendar.js">annotate</a> |
<a href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/wcap/calWcapCalendar.js">diff</a> |
<a href="/comm-central/comparison/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/wcap/calWcapCalendar.js">comparison</a> |
<a href="/comm-central/log/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/wcap/calWcapCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/wcap/calWcapSession.js">calendar/providers/wcap/calWcapSession.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/wcap/calWcapSession.js">file</a> |
<a href="/comm-central/annotate/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/wcap/calWcapSession.js">annotate</a> |
<a href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/wcap/calWcapSession.js">diff</a> |
<a href="/comm-central/comparison/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/wcap/calWcapSession.js">comparison</a> |
<a href="/comm-central/log/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/providers/wcap/calWcapSession.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/test/mozmill/shared-modules/test-calendar-utils.js">calendar/test/mozmill/shared-modules/test-calendar-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/test/mozmill/shared-modules/test-calendar-utils.js">file</a> |
<a href="/comm-central/annotate/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/test/mozmill/shared-modules/test-calendar-utils.js">annotate</a> |
<a href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/test/mozmill/shared-modules/test-calendar-utils.js">diff</a> |
<a href="/comm-central/comparison/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/test/mozmill/shared-modules/test-calendar-utils.js">comparison</a> |
<a href="/comm-central/log/b0da77087a9064f3d20a11b1a322f6ddc780177c/calendar/test/mozmill/shared-modules/test-calendar-utils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/ldap/xpcom/tests/unit/test_nsLDAPURL.js">ldap/xpcom/tests/unit/test_nsLDAPURL.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b0da77087a9064f3d20a11b1a322f6ddc780177c/ldap/xpcom/tests/unit/test_nsLDAPURL.js">file</a> |
<a href="/comm-central/annotate/b0da77087a9064f3d20a11b1a322f6ddc780177c/ldap/xpcom/tests/unit/test_nsLDAPURL.js">annotate</a> |
<a href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/ldap/xpcom/tests/unit/test_nsLDAPURL.js">diff</a> |
<a href="/comm-central/comparison/b0da77087a9064f3d20a11b1a322f6ddc780177c/ldap/xpcom/tests/unit/test_nsLDAPURL.js">comparison</a> |
<a href="/comm-central/log/b0da77087a9064f3d20a11b1a322f6ddc780177c/ldap/xpcom/tests/unit/test_nsLDAPURL.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/components/aboutRedirector.js">mail/components/aboutRedirector.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/components/aboutRedirector.js">file</a> |
<a href="/comm-central/annotate/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/components/aboutRedirector.js">annotate</a> |
<a href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/components/aboutRedirector.js">diff</a> |
<a href="/comm-central/comparison/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/components/aboutRedirector.js">comparison</a> |
<a href="/comm-central/log/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/components/aboutRedirector.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/mozmill/newmailaccount/test-newmailaccount.js">mail/test/mozmill/newmailaccount/test-newmailaccount.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/mozmill/newmailaccount/test-newmailaccount.js">file</a> |
<a href="/comm-central/annotate/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/mozmill/newmailaccount/test-newmailaccount.js">annotate</a> |
<a href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/mozmill/newmailaccount/test-newmailaccount.js">diff</a> |
<a href="/comm-central/comparison/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/mozmill/newmailaccount/test-newmailaccount.js">comparison</a> |
<a href="/comm-central/log/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/mozmill/newmailaccount/test-newmailaccount.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js">mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js">file</a> |
<a href="/comm-central/annotate/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js">annotate</a> |
<a href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js">diff</a> |
<a href="/comm-central/comparison/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js">comparison</a> |
<a href="/comm-central/log/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js">mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js">file</a> |
<a href="/comm-central/annotate/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js">annotate</a> |
<a href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js">diff</a> |
<a href="/comm-central/comparison/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js">comparison</a> |
<a href="/comm-central/log/b0da77087a9064f3d20a11b1a322f6ddc780177c/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/mailnews/jsaccount/test/unit/resources/testJaFooUrlComponent.js">mailnews/jsaccount/test/unit/resources/testJaFooUrlComponent.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/b0da77087a9064f3d20a11b1a322f6ddc780177c/mailnews/jsaccount/test/unit/resources/testJaFooUrlComponent.js">file</a> |
<a href="/comm-central/annotate/b0da77087a9064f3d20a11b1a322f6ddc780177c/mailnews/jsaccount/test/unit/resources/testJaFooUrlComponent.js">annotate</a> |
<a href="/comm-central/diff/b0da77087a9064f3d20a11b1a322f6ddc780177c/mailnews/jsaccount/test/unit/resources/testJaFooUrlComponent.js">diff</a> |
<a href="/comm-central/comparison/b0da77087a9064f3d20a11b1a322f6ddc780177c/mailnews/jsaccount/test/unit/resources/testJaFooUrlComponent.js">comparison</a> |
<a href="/comm-central/log/b0da77087a9064f3d20a11b1a322f6ddc780177c/mailnews/jsaccount/test/unit/resources/testJaFooUrlComponent.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/content/calendar-dnd-listener.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/content/calendar-dnd-listener.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -254,17 +254,17 @@ calDNDBaseObserver.prototype = {</span>
<a href="#l1.4"></a><span id="l1.4">                 var droppedUrl = this.retrieveURLFromData(data, bestFlavor.value);</span>
<a href="#l1.5"></a><span id="l1.5">                 if (!droppedUrl)</span>
<a href="#l1.6"></a><span id="l1.6">                     return;</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8">                 var url = Services.io.newURI(droppedUrl);</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10">                 var localFileInstance = Components.classes[&quot;@mozilla.org/file/local;1&quot;]</span>
<a href="#l1.11"></a><span id="l1.11">                                         .createInstance(Components.interfaces.nsILocalFile);</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-                localFileInstance.initWithPath(url.path);</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+                localFileInstance.initWithPath(url.pathQueryRef);</span>
<a href="#l1.14"></a><span id="l1.14"> </span>
<a href="#l1.15"></a><span id="l1.15">                 var inputStream = Components.classes[&quot;@mozilla.org/network/file-input-stream;1&quot;]</span>
<a href="#l1.16"></a><span id="l1.16">                                   .createInstance(Components.interfaces.nsIFileInputStream);</span>
<a href="#l1.17"></a><span id="l1.17">                 inputStream.init(localFileInstance,</span>
<a href="#l1.18"></a><span id="l1.18">                                  MODE_RDONLY,</span>
<a href="#l1.19"></a><span id="l1.19">                                  parseInt(&quot;0444&quot;, 8),</span>
<a href="#l1.20"></a><span id="l1.20">                                  {});</span>
<a href="#l1.21"></a><span id="l1.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -521,26 +521,26 @@ calDavCalendar.prototype = {</span>
<a href="#l2.4"></a><span id="l2.4">      * @param aBaseUri       base uri (nsIURI object), if null, this.calendarUri</span>
<a href="#l2.5"></a><span id="l2.5">      *                       will be used.</span>
<a href="#l2.6"></a><span id="l2.6">      */</span>
<a href="#l2.7"></a><span id="l2.7">     makeUri: function(aInsertString, aBaseUri) {</span>
<a href="#l2.8"></a><span id="l2.8">         let baseUri = aBaseUri || this.calendarUri;</span>
<a href="#l2.9"></a><span id="l2.9">         // Build a string containing the full path, decoded, so it looks like</span>
<a href="#l2.10"></a><span id="l2.10">         // this:</span>
<a href="#l2.11"></a><span id="l2.11">         // /some path/insert string.ics</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-        let decodedPath = this.ensureDecodedPath(baseUri.path) + (aInsertString || &quot;&quot;);</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+        let decodedPath = this.ensureDecodedPath(baseUri.pathQueryRef) + (aInsertString || &quot;&quot;);</span>
<a href="#l2.14"></a><span id="l2.14"> </span>
<a href="#l2.15"></a><span id="l2.15">         // Build the nsIURI by specifying a string with a fully encoded path</span>
<a href="#l2.16"></a><span id="l2.16">         // the end result will be something like this:</span>
<a href="#l2.17"></a><span id="l2.17">         // http://caldav.example.com:8080/some%20path/insert%20string.ics</span>
<a href="#l2.18"></a><span id="l2.18">         return Services.io.newURI(baseUri.prePath + this.ensureEncodedPath(decodedPath) + (this.mUriParams || &quot;&quot;));</span>
<a href="#l2.19"></a><span id="l2.19">     },</span>
<a href="#l2.20"></a><span id="l2.20"> </span>
<a href="#l2.21"></a><span id="l2.21">     get mLocationPath() {</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineminus">-        return this.ensureDecodedPath(this.calendarUri.path);</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineplus">+        return this.ensureDecodedPath(this.calendarUri.pathQueryRef);</span>
<a href="#l2.24"></a><span id="l2.24">     },</span>
<a href="#l2.25"></a><span id="l2.25"> </span>
<a href="#l2.26"></a><span id="l2.26">     getItemLocationPath: function(aItem) {</span>
<a href="#l2.27"></a><span id="l2.27">         if (aItem.id &amp;&amp;</span>
<a href="#l2.28"></a><span id="l2.28">             aItem.id in this.mItemInfoCache &amp;&amp;</span>
<a href="#l2.29"></a><span id="l2.29">             this.mItemInfoCache[aItem.id].locationPath) {</span>
<a href="#l2.30"></a><span id="l2.30">             // modifying items use the cached location path</span>
<a href="#l2.31"></a><span id="l2.31">             return this.mItemInfoCache[aItem.id].locationPath;</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineat">@@ -676,17 +676,17 @@ calDavCalendar.prototype = {</span>
<a href="#l2.33"></a><span id="l2.33"> </span>
<a href="#l2.34"></a><span id="l2.34">                 // Translate the HTTP status code to a status and message for the listener</span>
<a href="#l2.35"></a><span id="l2.35">                 if (responseStatus == 201 || responseStatus == 204) {</span>
<a href="#l2.36"></a><span id="l2.36">                     // 201 = HTTP &quot;Created&quot;</span>
<a href="#l2.37"></a><span id="l2.37">                     // 204 = HTTP &quot;No Content&quot;</span>
<a href="#l2.38"></a><span id="l2.38">                     cal.LOG(&quot;CalDAV: Item added to &quot; + self.name + &quot; successfully&quot;);</span>
<a href="#l2.39"></a><span id="l2.39"> </span>
<a href="#l2.40"></a><span id="l2.40">                     let uriComponentParts = self.makeUri().path.replace(/\/{2,}/g, &quot;/&quot;).split(&quot;/&quot;).length;</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineminus">-                    let targetParts = request.URI.path.split(&quot;/&quot;);</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineplus">+                    let targetParts = request.URI.pathQueryRef.split(&quot;/&quot;);</span>
<a href="#l2.43"></a><span id="l2.43">                     targetParts.splice(0, uriComponentParts - 1);</span>
<a href="#l2.44"></a><span id="l2.44"> </span>
<a href="#l2.45"></a><span id="l2.45">                     self.mItemInfoCache[parentItem.id] = { locationPath: targetParts.join(&quot;/&quot;) };</span>
<a href="#l2.46"></a><span id="l2.46">                     // TODO: onOpComplete adds the item to the cache, probably after getUpdatedItem!</span>
<a href="#l2.47"></a><span id="l2.47"> </span>
<a href="#l2.48"></a><span id="l2.48">                     // Some CalDAV servers will modify items on PUT (add X-props,</span>
<a href="#l2.49"></a><span id="l2.49">                     // for instance) so we'd best re-fetch in order to know</span>
<a href="#l2.50"></a><span id="l2.50">                     // the current state of the item</span>
<a href="#l2.51"></a><span id="l2.51" class="difflineat">@@ -887,17 +887,17 @@ calDavCalendar.prototype = {</span>
<a href="#l2.52"></a><span id="l2.52">         if (aUri) {</span>
<a href="#l2.53"></a><span id="l2.53">             eventUri = aUri;</span>
<a href="#l2.54"></a><span id="l2.54">         } else if (aFromInbox || this.mItemInfoCache[aItem.id].isInboxItem) {</span>
<a href="#l2.55"></a><span id="l2.55">             eventUri = this.makeUri(this.mItemInfoCache[aItem.id].locationPath, this.mInboxUrl);</span>
<a href="#l2.56"></a><span id="l2.56">         } else {</span>
<a href="#l2.57"></a><span id="l2.57">             eventUri = this.makeUri(this.mItemInfoCache[aItem.id].locationPath);</span>
<a href="#l2.58"></a><span id="l2.58">         }</span>
<a href="#l2.59"></a><span id="l2.59"> </span>
<a href="#l2.60"></a><span id="l2.60" class="difflineminus">-        if (eventUri.path == this.calendarUri.path) {</span>
<a href="#l2.61"></a><span id="l2.61" class="difflineplus">+        if (eventUri.pathQueryRef == this.calendarUri.pathQueryRef) {</span>
<a href="#l2.62"></a><span id="l2.62">             notifyListener(Components.results.NS_ERROR_FAILURE,</span>
<a href="#l2.63"></a><span id="l2.63">                            &quot;eventUri and calendarUri paths are the same, &quot; +</span>
<a href="#l2.64"></a><span id="l2.64">                            &quot;will not go on to delete entire calendar&quot;);</span>
<a href="#l2.65"></a><span id="l2.65">             return;</span>
<a href="#l2.66"></a><span id="l2.66">         }</span>
<a href="#l2.67"></a><span id="l2.67"> </span>
<a href="#l2.68"></a><span id="l2.68">         let self = this;</span>
<a href="#l2.69"></a><span id="l2.69"> </span>
<a href="#l2.70"></a><span id="l2.70" class="difflineat">@@ -920,17 +920,17 @@ calDavCalendar.prototype = {</span>
<a href="#l2.71"></a><span id="l2.71">                     cal.LOG(&quot;CalDAV: Request error during delete: &quot; + ex);</span>
<a href="#l2.72"></a><span id="l2.72">                 }</span>
<a href="#l2.73"></a><span id="l2.73"> </span>
<a href="#l2.74"></a><span id="l2.74">                 // 204 = HTTP &quot;No content&quot;</span>
<a href="#l2.75"></a><span id="l2.75">                 // 404 = Not Found - This is kind of a success, since the item is already deleted.</span>
<a href="#l2.76"></a><span id="l2.76">                 //</span>
<a href="#l2.77"></a><span id="l2.77">                 if (responseStatus == 204 || responseStatus == 200 || responseStatus == 404) {</span>
<a href="#l2.78"></a><span id="l2.78">                     if (!aFromInbox) {</span>
<a href="#l2.79"></a><span id="l2.79" class="difflineminus">-                        let decodedPath = self.ensureDecodedPath(eventUri.path);</span>
<a href="#l2.80"></a><span id="l2.80" class="difflineplus">+                        let decodedPath = self.ensureDecodedPath(eventUri.pathQueryRef);</span>
<a href="#l2.81"></a><span id="l2.81">                         delete self.mHrefIndex[decodedPath];</span>
<a href="#l2.82"></a><span id="l2.82">                         delete self.mItemInfoCache[aItem.id];</span>
<a href="#l2.83"></a><span id="l2.83">                         cal.LOG(&quot;CalDAV: Item deleted successfully from calendar &quot; + self.name);</span>
<a href="#l2.84"></a><span id="l2.84"> </span>
<a href="#l2.85"></a><span id="l2.85">                         if (!self.isCached) {</span>
<a href="#l2.86"></a><span id="l2.86">                             // If the calendar is not cached, we need to remove</span>
<a href="#l2.87"></a><span id="l2.87">                             // the item from our memory calendar now. The</span>
<a href="#l2.88"></a><span id="l2.88">                             // listeners will be notified there.</span>
<a href="#l2.89"></a><span id="l2.89" class="difflineat">@@ -1033,19 +1033,19 @@ calDavCalendar.prototype = {</span>
<a href="#l2.90"></a><span id="l2.90">      * @param path      Item path MUST NOT BE ENCODED</span>
<a href="#l2.91"></a><span id="l2.91">      * @param calData   iCalendar string representation of the item</span>
<a href="#l2.92"></a><span id="l2.92">      * @param aUri      Base URI of the request</span>
<a href="#l2.93"></a><span id="l2.93">      * @param aListener Listener</span>
<a href="#l2.94"></a><span id="l2.94">      */</span>
<a href="#l2.95"></a><span id="l2.95">     addTargetCalendarItem: function(path, calData, aUri, etag, aListener) {</span>
<a href="#l2.96"></a><span id="l2.96">         let parser = Components.classes[&quot;@mozilla.org/calendar/ics-parser;1&quot;]</span>
<a href="#l2.97"></a><span id="l2.97">                                .createInstance(Components.interfaces.calIIcsParser);</span>
<a href="#l2.98"></a><span id="l2.98" class="difflineminus">-        // aUri.path may contain double slashes whereas path does not</span>
<a href="#l2.99"></a><span id="l2.99" class="difflineplus">+        // aUri.pathQueryRef may contain double slashes whereas path does not</span>
<a href="#l2.100"></a><span id="l2.100">         // this confuses our counting, so remove multiple successive slashes</span>
<a href="#l2.101"></a><span id="l2.101" class="difflineminus">-        let strippedUriPath = aUri.path.replace(/\/{2,}/g, &quot;/&quot;);</span>
<a href="#l2.102"></a><span id="l2.102" class="difflineplus">+        let strippedUriPath = aUri.pathQueryRef.replace(/\/{2,}/g, &quot;/&quot;);</span>
<a href="#l2.103"></a><span id="l2.103">         let uriPathComponentLength = strippedUriPath.split(&quot;/&quot;).length;</span>
<a href="#l2.104"></a><span id="l2.104">         try {</span>
<a href="#l2.105"></a><span id="l2.105">             parser.parseString(calData);</span>
<a href="#l2.106"></a><span id="l2.106">         } catch (e) {</span>
<a href="#l2.107"></a><span id="l2.107">             // Warn and continue.</span>
<a href="#l2.108"></a><span id="l2.108">             // TODO As soon as we have activity manager integration,</span>
<a href="#l2.109"></a><span id="l2.109">             // this should be replace with logic to notify that a</span>
<a href="#l2.110"></a><span id="l2.110">             // certain event failed.</span>
<a href="#l2.111"></a><span id="l2.111" class="difflineat">@@ -1264,17 +1264,17 @@ calDavCalendar.prototype = {</span>
<a href="#l2.112"></a><span id="l2.112">                                          null,</span>
<a href="#l2.113"></a><span id="l2.113">                                          &quot;passed in null item&quot;);</span>
<a href="#l2.114"></a><span id="l2.114">             return;</span>
<a href="#l2.115"></a><span id="l2.115">         }</span>
<a href="#l2.116"></a><span id="l2.116"> </span>
<a href="#l2.117"></a><span id="l2.117">         let locationPath = this.getItemLocationPath(aItem);</span>
<a href="#l2.118"></a><span id="l2.118">         let itemUri = this.makeUri(locationPath);</span>
<a href="#l2.119"></a><span id="l2.119"> </span>
<a href="#l2.120"></a><span id="l2.120" class="difflineminus">-        let multiget = new multigetSyncHandler([this.ensureDecodedPath(itemUri.path)],</span>
<a href="#l2.121"></a><span id="l2.121" class="difflineplus">+        let multiget = new multigetSyncHandler([this.ensureDecodedPath(itemUri.pathQueryRef)],</span>
<a href="#l2.122"></a><span id="l2.122">                                                this,</span>
<a href="#l2.123"></a><span id="l2.123">                                                this.makeUri(),</span>
<a href="#l2.124"></a><span id="l2.124">                                                null,</span>
<a href="#l2.125"></a><span id="l2.125">                                                false,</span>
<a href="#l2.126"></a><span id="l2.126">                                                aListener,</span>
<a href="#l2.127"></a><span id="l2.127">                                                aChangeLogListener);</span>
<a href="#l2.128"></a><span id="l2.128">         multiget.doMultiGet();</span>
<a href="#l2.129"></a><span id="l2.129">     },</span>
<a href="#l2.130"></a><span id="l2.130" class="difflineat">@@ -2201,20 +2201,20 @@ calDavCalendar.prototype = {</span>
<a href="#l2.131"></a><span id="l2.131">             let homeSets = caldavXPath(multistatus, &quot;/D:multistatus/D:response/D:propstat/D:prop/C:calendar-home-set/D:href/text()&quot;);</span>
<a href="#l2.132"></a><span id="l2.132">             function homeSetMatches(homeSet) {</span>
<a href="#l2.133"></a><span id="l2.133">                 let normalized = homeSet.replace(/([^\/])$/, &quot;$1/&quot;);</span>
<a href="#l2.134"></a><span id="l2.134">                 let chs = self.mCalHomeSet;</span>
<a href="#l2.135"></a><span id="l2.135">                 return normalized == chs.path || normalized == chs.spec;</span>
<a href="#l2.136"></a><span id="l2.136">             }</span>
<a href="#l2.137"></a><span id="l2.137">             function createBoxUrl(path) {</span>
<a href="#l2.138"></a><span id="l2.138">                 let url = self.mUri.clone();</span>
<a href="#l2.139"></a><span id="l2.139" class="difflineminus">-                url.path = self.ensureDecodedPath(path);</span>
<a href="#l2.140"></a><span id="l2.140" class="difflineplus">+                url.pathQueryRef = self.ensureDecodedPath(path);</span>
<a href="#l2.141"></a><span id="l2.141">                 // Make sure the uri has a / at the end, as we do with the calendarUri.</span>
<a href="#l2.142"></a><span id="l2.142" class="difflineminus">-                if (url.path.charAt(url.path.length - 1) != &quot;/&quot;) {</span>
<a href="#l2.143"></a><span id="l2.143" class="difflineminus">-                    url.path += &quot;/&quot;;</span>
<a href="#l2.144"></a><span id="l2.144" class="difflineplus">+                if (url.pathQueryRef.charAt(url.pathQueryRef.length - 1) != &quot;/&quot;) {</span>
<a href="#l2.145"></a><span id="l2.145" class="difflineplus">+                    url.pathQueryRef += &quot;/&quot;;</span>
<a href="#l2.146"></a><span id="l2.146">                 }</span>
<a href="#l2.147"></a><span id="l2.147">                 return url;</span>
<a href="#l2.148"></a><span id="l2.148">             }</span>
<a href="#l2.149"></a><span id="l2.149"> </span>
<a href="#l2.150"></a><span id="l2.150">             // If there are multiple home sets, we need to match the email addresses for scheduling.</span>
<a href="#l2.151"></a><span id="l2.151">             // If there is only one, assume its the right one.</span>
<a href="#l2.152"></a><span id="l2.152">             // TODO with multiple address sets, we should just use the ACL manager.</span>
<a href="#l2.153"></a><span id="l2.153">             if (homeSets &amp;&amp; (homeSets.length == 1 || homeSets.some(homeSetMatches))) {</span>
<a href="#l2.154"></a><span id="l2.154" class="difflineat">@@ -2664,17 +2664,17 @@ calDavCalendar.prototype = {</span>
<a href="#l2.155"></a><span id="l2.155">         modListener.QueryInterface = XPCOMUtils.generateQI([Components.interfaces.calIOperationListener]);</span>
<a href="#l2.156"></a><span id="l2.156">         modListener.onOperationComplete = function(aCalendar, aStatus, aOperationType, aItemId, aDetail) {</span>
<a href="#l2.157"></a><span id="l2.157">             cal.LOG(&quot;CalDAV: status &quot; + aStatus + &quot; while processing iTIP REPLY &quot; +</span>
<a href="#l2.158"></a><span id="l2.158">                     &quot; for &quot; + self.name);</span>
<a href="#l2.159"></a><span id="l2.159">             // don't delete the REPLY item from inbox unless modifying the master</span>
<a href="#l2.160"></a><span id="l2.160">             // item was successful</span>
<a href="#l2.161"></a><span id="l2.161">             if (aStatus == 0) { // aStatus undocumented; 0 seems to indicate no error</span>
<a href="#l2.162"></a><span id="l2.162">                 let delUri = self.calendarUri.clone();</span>
<a href="#l2.163"></a><span id="l2.163" class="difflineminus">-                delUri.path = self.ensureEncodedPath(aPath);</span>
<a href="#l2.164"></a><span id="l2.164" class="difflineplus">+                delUri.pathQueryRef = self.ensureEncodedPath(aPath);</span>
<a href="#l2.165"></a><span id="l2.165">                 self.doDeleteItem(aItem, null, true, true, delUri);</span>
<a href="#l2.166"></a><span id="l2.166">             }</span>
<a href="#l2.167"></a><span id="l2.167">         };</span>
<a href="#l2.168"></a><span id="l2.168"> </span>
<a href="#l2.169"></a><span id="l2.169">         this.mOfflineStorage.getItem(aItem.id, getItemListener);</span>
<a href="#l2.170"></a><span id="l2.170">     },</span>
<a href="#l2.171"></a><span id="l2.171"> </span>
<a href="#l2.172"></a><span id="l2.172">     canNotify: function(aMethod, aItem) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/providers/gdata/components/calGoogleCalendar.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/providers/gdata/components/calGoogleCalendar.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -118,17 +118,17 @@ calGoogleCalendar.prototype = {</span>
<a href="#l3.4"></a><span id="l3.4">     },</span>
<a href="#l3.5"></a><span id="l3.5"> </span>
<a href="#l3.6"></a><span id="l3.6">     get uri() { return this.mUri; },</span>
<a href="#l3.7"></a><span id="l3.7">     set uri(aUri) {</span>
<a href="#l3.8"></a><span id="l3.8">         const protocols = [&quot;http&quot;, &quot;https&quot;, &quot;webcal&quot;, &quot;webcals&quot;];</span>
<a href="#l3.9"></a><span id="l3.9">         this.mUri = aUri;</span>
<a href="#l3.10"></a><span id="l3.10">         if (aUri &amp;&amp; aUri.schemeIs(&quot;googleapi&quot;)) {</span>
<a href="#l3.11"></a><span id="l3.11">             // new format:  googleapi://session-id/?calendar=calhash@group.calendar.google.com&amp;tasks=taskhash</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-            let [fullUser, path] = aUri.path.substr(2).split(&quot;/&quot;, 2);</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+            let [fullUser, path] = aUri.pathQueryRef.substr(2).split(&quot;/&quot;, 2);</span>
<a href="#l3.14"></a><span id="l3.14">             let parameters = new Map(path.substr(1).split(&quot;&amp;&quot;).filter(Boolean)</span>
<a href="#l3.15"></a><span id="l3.15">                              .map(function(x) { return x.split(&quot;=&quot;, 2).map(decodeURIComponent); }));</span>
<a href="#l3.16"></a><span id="l3.16"> </span>
<a href="#l3.17"></a><span id="l3.17">             if (parameters.size == 0) {</span>
<a href="#l3.18"></a><span id="l3.18">                 this.mCalendarName = fullUser;</span>
<a href="#l3.19"></a><span id="l3.19">                 this.mTasklistName = this.isDefaultCalendar ? &quot;@default&quot; : null;</span>
<a href="#l3.20"></a><span id="l3.20">             } else {</span>
<a href="#l3.21"></a><span id="l3.21">                 this.mCalendarName = parameters.get(&quot;calendar&quot;);</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineat">@@ -155,17 +155,17 @@ calGoogleCalendar.prototype = {</span>
<a href="#l3.23"></a><span id="l3.23">             }</span>
<a href="#l3.24"></a><span id="l3.24">         } else if (aUri &amp;&amp; protocols.some(function(scheme) { return aUri.schemeIs(scheme); })) {</span>
<a href="#l3.25"></a><span id="l3.25">             // Parse google url, catch private cookies, public calendars,</span>
<a href="#l3.26"></a><span id="l3.26">             // basic and full types, bogus ics file extensions, invalid hostnames</span>
<a href="#l3.27"></a><span id="l3.27">             let re = new RegExp(&quot;/calendar/(feeds|ical)/&quot; +</span>
<a href="#l3.28"></a><span id="l3.28">                                 &quot;([^/]+)/(public|private|free-busy)-?([^/]+)?/&quot; +</span>
<a href="#l3.29"></a><span id="l3.29">                                 &quot;(full|basic)(.ics)?$&quot;);</span>
<a href="#l3.30"></a><span id="l3.30"> </span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-            let matches = aUri.path.match(re);</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+            let matches = aUri.pathQueryRef.match(re);</span>
<a href="#l3.33"></a><span id="l3.33">             if (matches) {</span>
<a href="#l3.34"></a><span id="l3.34">                 this.mCalendarName = decodeURIComponent(matches[2]);</span>
<a href="#l3.35"></a><span id="l3.35"> </span>
<a href="#l3.36"></a><span id="l3.36">                 let googleUser = Preferences.get(&quot;calendar.google.calPrefs.&quot; + this.mCalendarName + &quot;.googleUser&quot;);</span>
<a href="#l3.37"></a><span id="l3.37">                 let newUri = &quot;googleapi://&quot; + (googleUser || this.mCalendarName) + &quot;/?calendar=&quot; + matches[2];</span>
<a href="#l3.38"></a><span id="l3.38"> </span>
<a href="#l3.39"></a><span id="l3.39">                 // Use the default task list, but only if this is the primary account.</span>
<a href="#l3.40"></a><span id="l3.40">                 if (googleUser &amp;&amp; googleUser == this.mCalendarName) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/providers/gdata/modules/gdataSession.jsm</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/providers/gdata/modules/gdataSession.jsm</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -44,19 +44,19 @@ var calGoogleSessionManager = {</span>
<a href="#l4.4"></a><span id="l4.4">         let host = (function() { try { return uri.host; } catch (e) {} })();</span>
<a href="#l4.5"></a><span id="l4.5">         const protocols = [&quot;http&quot;, &quot;https&quot;, &quot;webcal&quot;, &quot;webcals&quot;];</span>
<a href="#l4.6"></a><span id="l4.6"> </span>
<a href="#l4.7"></a><span id="l4.7">         if (aCalendar.type != &quot;gdata&quot;) {</span>
<a href="#l4.8"></a><span id="l4.8">             return;</span>
<a href="#l4.9"></a><span id="l4.9">         }</span>
<a href="#l4.10"></a><span id="l4.10"> </span>
<a href="#l4.11"></a><span id="l4.11">         if (uri.schemeIs(&quot;googleapi&quot;)) {</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-            let [fullUser, path] = uri.path.substr(2).split(&quot;/&quot;, 2);</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+            let [fullUser, path] = uri.pathQueryRef.substr(2).split(&quot;/&quot;, 2);</span>
<a href="#l4.14"></a><span id="l4.14">             id = fullUser || cal.getUUID();</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">-        } else if (host == &quot;www.google.com&quot; &amp;&amp; uri.path.startsWith(&quot;/calendar/feeds&quot;) &amp;&amp; protocols.some(function(s) { return uri.schemeIs(s); })) {</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+        } else if (host == &quot;www.google.com&quot; &amp;&amp; uri.pathQueryRef.startsWith(&quot;/calendar/feeds&quot;) &amp;&amp; protocols.some(function(s) { return uri.schemeIs(s); })) {</span>
<a href="#l4.17"></a><span id="l4.17">             let googleCalendarName = aCalendar.getProperty(&quot;googleCalendarName&quot;);</span>
<a href="#l4.18"></a><span id="l4.18">             let googleUser = Preferences.get(&quot;calendar.google.calPrefs.&quot; + googleCalendarName  + &quot;.googleUser&quot;);</span>
<a href="#l4.19"></a><span id="l4.19">             id = googleUser || googleCalendarName || cal.getUUID();</span>
<a href="#l4.20"></a><span id="l4.20">         }</span>
<a href="#l4.21"></a><span id="l4.21"> </span>
<a href="#l4.22"></a><span id="l4.22">         return id ? this.getSessionById(id, aCreate) : null;</span>
<a href="#l4.23"></a><span id="l4.23">     },</span>
<a href="#l4.24"></a><span id="l4.24"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/providers/storage/calStorageCalendar.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/providers/storage/calStorageCalendar.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -302,33 +302,33 @@ calStorageCalendar.prototype = {</span>
<a href="#l5.4"></a><span id="l5.4">                             if (stmt) {</span>
<a href="#l5.5"></a><span id="l5.5">                                 stmt.reset();</span>
<a href="#l5.6"></a><span id="l5.6">                             }</span>
<a href="#l5.7"></a><span id="l5.7">                         }</span>
<a href="#l5.8"></a><span id="l5.8">                     }</span>
<a href="#l5.9"></a><span id="l5.9">                 };</span>
<a href="#l5.10"></a><span id="l5.10"> </span>
<a href="#l5.11"></a><span id="l5.11">                 let id = 0;</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-                let path = this.uri.path;</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+                let path = this.uri.pathQueryRef;</span>
<a href="#l5.14"></a><span id="l5.14">                 let pos = path.indexOf(&quot;?id=&quot;);</span>
<a href="#l5.15"></a><span id="l5.15"> </span>
<a href="#l5.16"></a><span id="l5.16">                 if (pos == -1) {</span>
<a href="#l5.17"></a><span id="l5.17">                     // For some reason, the first storage calendar before the</span>
<a href="#l5.18"></a><span id="l5.18">                     // v19 upgrade has cal_id=0. If we still have a</span>
<a href="#l5.19"></a><span id="l5.19">                     // moz-profile-calendar here, then this is the one and we</span>
<a href="#l5.20"></a><span id="l5.20">                     // need to move all events with cal_id=0 to this id.</span>
<a href="#l5.21"></a><span id="l5.21">                     cal.LOG(&quot;[calStorageCalendar] Migrating stray cal_id=0 calendar to uuid&quot;);</span>
<a href="#l5.22"></a><span id="l5.22">                     migrateTables(this.mDB, this.id, 0);</span>
<a href="#l5.23"></a><span id="l5.23">                     this.setProperty(&quot;uri&quot;, &quot;moz-storage-calendar://&quot;);</span>
<a href="#l5.24"></a><span id="l5.24">                     this.setProperty(&quot;old_calendar_id&quot;, 0);</span>
<a href="#l5.25"></a><span id="l5.25">                     this.mDB.commitTransaction();</span>
<a href="#l5.26"></a><span id="l5.26">                 } else {</span>
<a href="#l5.27"></a><span id="l5.27">                     // There is an &quot;id&quot; parameter in the uri. This calendar</span>
<a href="#l5.28"></a><span id="l5.28">                     // has not been migrated to using the uuid as its cal_id.</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineminus">-                    pos = this.uri.path.indexOf(&quot;?id=&quot;);</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineplus">+                    pos = this.uri.pathQueryRef.indexOf(&quot;?id=&quot;);</span>
<a href="#l5.31"></a><span id="l5.31">                     if (pos == -1) {</span>
<a href="#l5.32"></a><span id="l5.32">                         this.mDB.rollbackTransaction();</span>
<a href="#l5.33"></a><span id="l5.33">                     } else {</span>
<a href="#l5.34"></a><span id="l5.34">                         cal.LOG(&quot;[calStorageCalendar] Migrating numeric cal_id to uuid&quot;);</span>
<a href="#l5.35"></a><span id="l5.35">                         id = parseInt(path.substr(pos + 4), 10);</span>
<a href="#l5.36"></a><span id="l5.36">                         migrateTables(this.mDB, this.id, id);</span>
<a href="#l5.37"></a><span id="l5.37"> </span>
<a href="#l5.38"></a><span id="l5.38">                         // Now remove the id from the uri to make sure we don't do this</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapCalendar.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapCalendar.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -100,17 +100,17 @@ calWcapCalendar.prototype = {</span>
<a href="#l6.4"></a><span id="l6.4">     },</span>
<a href="#l6.5"></a><span id="l6.5"> </span>
<a href="#l6.6"></a><span id="l6.6">     m_uri: null,</span>
<a href="#l6.7"></a><span id="l6.7">     get uri() {</span>
<a href="#l6.8"></a><span id="l6.8">         return this.m_uri;</span>
<a href="#l6.9"></a><span id="l6.9">     },</span>
<a href="#l6.10"></a><span id="l6.10">     set uri(thatUri) {</span>
<a href="#l6.11"></a><span id="l6.11">         this.m_uri = thatUri.clone();</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-        let path = thatUri.path;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+        let path = thatUri.pathQueryRef;</span>
<a href="#l6.14"></a><span id="l6.14">         let qmPos = path.indexOf(&quot;?&quot;);</span>
<a href="#l6.15"></a><span id="l6.15">         if (qmPos != -1) {</span>
<a href="#l6.16"></a><span id="l6.16">             let pos = path.indexOf(&quot;?calid=&quot;, qmPos);</span>
<a href="#l6.17"></a><span id="l6.17">             if (pos != -1) {</span>
<a href="#l6.18"></a><span id="l6.18">                 let start = pos + &quot;?calid=&quot;.length;</span>
<a href="#l6.19"></a><span id="l6.19">                 let end = path.indexOf(&quot;&amp;&quot;, start);</span>
<a href="#l6.20"></a><span id="l6.20">                 this.m_calId = decodeURIComponent(</span>
<a href="#l6.21"></a><span id="l6.21">                     path.substring(start, end == -1 ? path.length : end));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapSession.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapSession.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -563,17 +563,17 @@ calWcapSession.prototype = {</span>
<a href="#l7.4"></a><span id="l7.4">                     checkWcapXmlErrno(node);</span>
<a href="#l7.5"></a><span id="l7.5">                     let calid = filterXmlNodes(&quot;X-NSCP-CALPROPS-RELATIVE-CALID&quot;, node);</span>
<a href="#l7.6"></a><span id="l7.6">                     if (calid.length &gt; 0) {</span>
<a href="#l7.7"></a><span id="l7.7">                         let calId = calid[0];</span>
<a href="#l7.8"></a><span id="l7.8">                         let calendar = cals[calId];</span>
<a href="#l7.9"></a><span id="l7.9">                         if (calendar === null) {</span>
<a href="#l7.10"></a><span id="l7.10">                             calendar = new calWcapCalendar(this);</span>
<a href="#l7.11"></a><span id="l7.11">                             let uri = this.uri.clone();</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-                            uri.path += &quot;?calid=&quot; + encodeURIComponent(calId);</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+                            uri.pathQueryRef += &quot;?calid=&quot; + encodeURIComponent(calId);</span>
<a href="#l7.14"></a><span id="l7.14">                             calendar.uri = uri;</span>
<a href="#l7.15"></a><span id="l7.15">                         }</span>
<a href="#l7.16"></a><span id="l7.16">                         if (calendar) {</span>
<a href="#l7.17"></a><span id="l7.17">                             calendar.m_calProps = node;</span>
<a href="#l7.18"></a><span id="l7.18">                             if (respFunc) {</span>
<a href="#l7.19"></a><span id="l7.19">                                 respFunc(calendar);</span>
<a href="#l7.20"></a><span id="l7.20">                             }</span>
<a href="#l7.21"></a><span id="l7.21">                         }</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineat">@@ -891,17 +891,17 @@ calWcapSession.prototype = {</span>
<a href="#l7.23"></a><span id="l7.23">                             if (calIdNodes.length &gt; 0) {</span>
<a href="#l7.24"></a><span id="l7.24">                                 let calId = calIdNodes[0];</span>
<a href="#l7.25"></a><span id="l7.25">                                 let calendar = registeredCalendars[calId];</span>
<a href="#l7.26"></a><span id="l7.26">                                 if (calendar) {</span>
<a href="#l7.27"></a><span id="l7.27">                                     calendar.m_calProps = node; // update calprops</span>
<a href="#l7.28"></a><span id="l7.28">                                 } else {</span>
<a href="#l7.29"></a><span id="l7.29">                                     calendar = new calWcapCalendar(this, node);</span>
<a href="#l7.30"></a><span id="l7.30">                                     let uri = this.uri.clone();</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineminus">-                                    uri.path += &quot;?calid=&quot; + encodeURIComponent(calId);</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+                                    uri.pathQueryRef += &quot;?calid=&quot; + encodeURIComponent(calId);</span>
<a href="#l7.33"></a><span id="l7.33">                                     calendar.uri = uri;</span>
<a href="#l7.34"></a><span id="l7.34">                                 }</span>
<a href="#l7.35"></a><span id="l7.35">                                 ret.push(calendar);</span>
<a href="#l7.36"></a><span id="l7.36">                             }</span>
<a href="#l7.37"></a><span id="l7.37">                         } catch (exc) {</span>
<a href="#l7.38"></a><span id="l7.38">                             switch (getResultCode(exc)) {</span>
<a href="#l7.39"></a><span id="l7.39">                                 case calIWcapErrors.WCAP_NO_ERRNO: // workaround</span>
<a href="#l7.40"></a><span id="l7.40">                                 case calIWcapErrors.WCAP_ACCESS_DENIED_TO_CALENDAR:</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/test/mozmill/shared-modules/test-calendar-utils.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/test/mozmill/shared-modules/test-calendar-utils.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -516,17 +516,17 @@ function handleNewCalendarWizard(wizard,</span>
<a href="#l8.4"></a><span id="l8.4">         wizard.waitForElement(formatOption);</span>
<a href="#l8.5"></a><span id="l8.5">         wizard.radio(formatOption);</span>
<a href="#l8.6"></a><span id="l8.6"> </span>
<a href="#l8.7"></a><span id="l8.7">         // enter location</span>
<a href="#l8.8"></a><span id="l8.8">         if (data.network.location == undefined) {</span>
<a href="#l8.9"></a><span id="l8.9">             let calendarFile = Services.dirsvc.get(&quot;TmpD&quot;, Ci.nsIFile);</span>
<a href="#l8.10"></a><span id="l8.10">             calendarFile.append(name + &quot;.ics&quot;);</span>
<a href="#l8.11"></a><span id="l8.11">             let fileURI = Services.io.newFileURI(calendarFile);</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-            data.network.location = fileURI.prePath + fileURI.path;</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+            data.network.location = fileURI.prePath + fileURI.pathQueryRef;</span>
<a href="#l8.14"></a><span id="l8.14">         }</span>
<a href="#l8.15"></a><span id="l8.15">         wizard.type(wizardlookup(`</span>
<a href="#l8.16"></a><span id="l8.16">             /id(&quot;calendar-wizard&quot;)/{&quot;pageid&quot;:&quot;locationPage&quot;}/[1]/[1]/</span>
<a href="#l8.17"></a><span id="l8.17">             {&quot;align&quot;:&quot;center&quot;}/id(&quot;calendar-uri&quot;)/</span>
<a href="#l8.18"></a><span id="l8.18">             anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})</span>
<a href="#l8.19"></a><span id="l8.19">         `), data.network.location);</span>
<a href="#l8.20"></a><span id="l8.20"> </span>
<a href="#l8.21"></a><span id="l8.21">         // choose offline support</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/ldap/xpcom/tests/unit/test_nsLDAPURL.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/ldap/xpcom/tests/unit/test_nsLDAPURL.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -91,17 +91,17 @@ function run_test() {</span>
<a href="#l9.4"></a><span id="l9.4">     url = ioService.newURI(ldapURLs[part].url);</span>
<a href="#l9.5"></a><span id="l9.5"> </span>
<a href="#l9.6"></a><span id="l9.6">     do_check_eq(url.spec, ldapURLs[part].spec);</span>
<a href="#l9.7"></a><span id="l9.7">     do_check_eq(url.asciiSpec, ldapURLs[part].asciiSpec);</span>
<a href="#l9.8"></a><span id="l9.8">     do_check_eq(url.scheme, ldapURLs[part].scheme);</span>
<a href="#l9.9"></a><span id="l9.9">     do_check_eq(url.host, ldapURLs[part].host);</span>
<a href="#l9.10"></a><span id="l9.10">     do_check_eq(url.asciiHost, ldapURLs[part].asciiHost);</span>
<a href="#l9.11"></a><span id="l9.11">     do_check_eq(url.port, ldapURLs[part].port);</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    do_check_eq(url.path, ldapURLs[part].path);</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+    do_check_eq(url.pathQueryRef, ldapURLs[part].path);</span>
<a href="#l9.14"></a><span id="l9.14">     do_check_eq(url.prePath, ldapURLs[part].prePath);</span>
<a href="#l9.15"></a><span id="l9.15">     do_check_eq(url.hostPort, ldapURLs[part].hostPort);</span>
<a href="#l9.16"></a><span id="l9.16">     // XXX nsLDAPURL ought to have classinfo.</span>
<a href="#l9.17"></a><span id="l9.17">     url = url.QueryInterface(Ci.nsILDAPURL);</span>
<a href="#l9.18"></a><span id="l9.18">     do_check_eq(url.dn, ldapURLs[part].dn);</span>
<a href="#l9.19"></a><span id="l9.19">     do_check_eq(url.scope, ldapURLs[part].scope);</span>
<a href="#l9.20"></a><span id="l9.20">     do_check_eq(url.filter, ldapURLs[part].filter);</span>
<a href="#l9.21"></a><span id="l9.21">     do_check_eq(url.options, ldapURLs[part].options);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/mail/components/aboutRedirector.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/mail/components/aboutRedirector.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -30,17 +30,17 @@ AboutRedirector.prototype = {</span>
<a href="#l10.4"></a><span id="l10.4">                   flags: Ci.nsIAboutModule.ALLOW_SCRIPT},</span>
<a href="#l10.5"></a><span id="l10.5">   },</span>
<a href="#l10.6"></a><span id="l10.6"> </span>
<a href="#l10.7"></a><span id="l10.7">   /**</span>
<a href="#l10.8"></a><span id="l10.8">    * Gets the module name from the given URI.</span>
<a href="#l10.9"></a><span id="l10.9">    */</span>
<a href="#l10.10"></a><span id="l10.10">   _getModuleName: function AboutRedirector__getModuleName(aURI) {</span>
<a href="#l10.11"></a><span id="l10.11">     // Strip out the first ? or #, and anything following it</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-    let name = (/[^?#]+/.exec(aURI.path))[0];</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+    let name = (/[^?#]+/.exec(aURI.pathQueryRef))[0];</span>
<a href="#l10.14"></a><span id="l10.14">     return name.toLowerCase();</span>
<a href="#l10.15"></a><span id="l10.15">   },</span>
<a href="#l10.16"></a><span id="l10.16"> </span>
<a href="#l10.17"></a><span id="l10.17">   getURIFlags: function(aURI) {</span>
<a href="#l10.18"></a><span id="l10.18">     let name = this._getModuleName(aURI);</span>
<a href="#l10.19"></a><span id="l10.19">     if (!(name in this._redirMap))</span>
<a href="#l10.20"></a><span id="l10.20">       throw Components.results.NS_ERROR_ILLEGAL_VALUE;</span>
<a href="#l10.21"></a><span id="l10.21">     return this._redirMap[name].flags;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/mail/test/mozmill/newmailaccount/test-newmailaccount.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/mail/test/mozmill/newmailaccount/test-newmailaccount.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -934,17 +934,17 @@ function test_internal_link_opening_beha</span>
<a href="#l11.4"></a><span id="l11.4">   let tab = mc.tabmail.currentTabInfo;</span>
<a href="#l11.5"></a><span id="l11.5">   let doc = tab.browser.contentWindow.document;</span>
<a href="#l11.6"></a><span id="l11.6"> </span>
<a href="#l11.7"></a><span id="l11.7">   // Click on the internal link.</span>
<a href="#l11.8"></a><span id="l11.8">   mc.click(new elib.Elem(doc.getElementById(&quot;internal&quot;)));</span>
<a href="#l11.9"></a><span id="l11.9"> </span>
<a href="#l11.10"></a><span id="l11.10">   // We should load the target page in the current tab browser.</span>
<a href="#l11.11"></a><span id="l11.11">   wait_for_browser_load(tab.browser, function(aURL) {</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-    return aURL.host == &quot;localhost&quot; &amp;&amp; aURL.path == &quot;/target.html&quot;;</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+    return aURL.host == &quot;localhost&quot; &amp;&amp; aURL.pathQueryRef == &quot;/target.html&quot;;</span>
<a href="#l11.14"></a><span id="l11.14">   });</span>
<a href="#l11.15"></a><span id="l11.15">   // Now close the tab.</span>
<a href="#l11.16"></a><span id="l11.16">   mc.tabmail.closeTab(tab);</span>
<a href="#l11.17"></a><span id="l11.17"> }</span>
<a href="#l11.18"></a><span id="l11.18"> </span>
<a href="#l11.19"></a><span id="l11.19"> /**</span>
<a href="#l11.20"></a><span id="l11.20">  * Test that window.open in the order form opens in new content tabs.</span>
<a href="#l11.21"></a><span id="l11.21">  */</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineat">@@ -953,17 +953,17 @@ function test_window_open_link_opening_b</span>
<a href="#l11.23"></a><span id="l11.23"> </span>
<a href="#l11.24"></a><span id="l11.24">   let tab = mc.tabmail.currentTabInfo;</span>
<a href="#l11.25"></a><span id="l11.25">   let doc = tab.browser.contentWindow.document;</span>
<a href="#l11.26"></a><span id="l11.26"> </span>
<a href="#l11.27"></a><span id="l11.27">   // First, click on the Javascript link - this should open in a new content</span>
<a href="#l11.28"></a><span id="l11.28">   // tab and be focused.</span>
<a href="#l11.29"></a><span id="l11.29">   let newTabLink = doc.getElementById(&quot;newtab&quot;);</span>
<a href="#l11.30"></a><span id="l11.30">   open_content_tab_with_click(newTabLink, function(aURL) {</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineminus">-    return aURL.host == &quot;localhost&quot; &amp;&amp; aURL.path == &quot;/target.html&quot;;</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+    return aURL.host == &quot;localhost&quot; &amp;&amp; aURL.pathQueryRef == &quot;/target.html&quot;;</span>
<a href="#l11.33"></a><span id="l11.33">   });</span>
<a href="#l11.34"></a><span id="l11.34"> </span>
<a href="#l11.35"></a><span id="l11.35">   // Close the new tab.</span>
<a href="#l11.36"></a><span id="l11.36">   let newTab = mc.tabmail.currentTabInfo;</span>
<a href="#l11.37"></a><span id="l11.37">   mc.tabmail.closeTab(newTab);</span>
<a href="#l11.38"></a><span id="l11.38">   mc.tabmail.closeTab(tab);</span>
<a href="#l11.39"></a><span id="l11.39"> }</span>
<a href="#l11.40"></a><span id="l11.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/httpd.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -1683,17 +1683,17 @@ RequestReader.prototype =</span>
<a href="#l12.4"></a><span id="l12.4">         throw HTTP_400;</span>
<a href="#l12.5"></a><span id="l12.5">       }</span>
<a href="#l12.6"></a><span id="l12.6"> </span>
<a href="#l12.7"></a><span id="l12.7">       try</span>
<a href="#l12.8"></a><span id="l12.8">       {</span>
<a href="#l12.9"></a><span id="l12.9">         var uri = Cc[&quot;@mozilla.org/network/io-service;1&quot;]</span>
<a href="#l12.10"></a><span id="l12.10">                     .getService(Ci.nsIIOService)</span>
<a href="#l12.11"></a><span id="l12.11">                     .newURI(fullPath);</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-        fullPath = uri.path;</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+        fullPath = uri.pathQueryRef;</span>
<a href="#l12.14"></a><span id="l12.14">         scheme = uri.scheme;</span>
<a href="#l12.15"></a><span id="l12.15">         host = metadata._host = uri.asciiHost;</span>
<a href="#l12.16"></a><span id="l12.16">         port = uri.port;</span>
<a href="#l12.17"></a><span id="l12.17">         if (port === -1)</span>
<a href="#l12.18"></a><span id="l12.18">         {</span>
<a href="#l12.19"></a><span id="l12.19">           if (scheme === &quot;http&quot;)</span>
<a href="#l12.20"></a><span id="l12.20">           {</span>
<a href="#l12.21"></a><span id="l12.21">             port = 80;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mail/test/resources/mozmill/mozmill/extension/resource/stdlib/securable-module.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -91,17 +91,17 @@</span>
<a href="#l13.4"></a><span id="l13.4">        // nsIChromeRegistry.wrappersEnabled() available from script</span>
<a href="#l13.5"></a><span id="l13.5">        // and use it here. Until that's in the platform, though,</span>
<a href="#l13.6"></a><span id="l13.6">        // we'll play it safe and parentify the filename unless</span>
<a href="#l13.7"></a><span id="l13.7">        // we're absolutely certain things will be ok if we don't.</span>
<a href="#l13.8"></a><span id="l13.8">        var filenameURI = ios.newURI(options.filename,</span>
<a href="#l13.9"></a><span id="l13.9">                                     null,</span>
<a href="#l13.10"></a><span id="l13.10">                                     baseURI);</span>
<a href="#l13.11"></a><span id="l13.11">        if (filenameURI.scheme == 'chrome' &amp;&amp;</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-           filenameURI.path.indexOf('/content/') == 0)</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+           filenameURI.pathQueryRef.indexOf('/content/') == 0)</span>
<a href="#l13.14"></a><span id="l13.14">          // Content packages will always have wrappers made for them;</span>
<a href="#l13.15"></a><span id="l13.15">          // if automatic wrappers have been disabled for the</span>
<a href="#l13.16"></a><span id="l13.16">          // chrome package via a chrome manifest flag, then</span>
<a href="#l13.17"></a><span id="l13.17">          // this still works too, to the extent that the</span>
<a href="#l13.18"></a><span id="l13.18">          // content package is insecure anyways.</span>
<a href="#l13.19"></a><span id="l13.19">          doParentifyFilename = false;</span>
<a href="#l13.20"></a><span id="l13.20">      } catch (e) {}</span>
<a href="#l13.21"></a><span id="l13.21">      if (doParentifyFilename)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/jsaccount/test/unit/resources/testJaFooUrlComponent.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/jsaccount/test/unit/resources/testJaFooUrlComponent.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -81,17 +81,17 @@ FooUrl.prototype = {</span>
<a href="#l14.4"></a><span id="l14.4">     // nsIMsgMailNewsUrl overrides</span>
<a href="#l14.5"></a><span id="l14.5"> </span>
<a href="#l14.6"></a><span id="l14.6">   // Override cloneInternal() to always make the pathname capitalized. This is useful</span>
<a href="#l14.7"></a><span id="l14.7">   // to test that a method called from C++, but overridden in JS, gets the JS</span>
<a href="#l14.8"></a><span id="l14.8">   // method, since nsMsgMailNewsUrl::CloneIgnoringRef calls CloneInternal().</span>
<a href="#l14.9"></a><span id="l14.9">   cloneInternal: function(aRefHandle, aRef)</span>
<a href="#l14.10"></a><span id="l14.10">   {</span>
<a href="#l14.11"></a><span id="l14.11">     let uriClone = this.cppBase.cloneInternal(aRefHandle, aRef);</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-    uriClone.path = uriClone.path.toUpperCase();</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+    uriClone.pathQueryRef = uriClone.pathQueryRef.toUpperCase();</span>
<a href="#l14.14"></a><span id="l14.14">     return uriClone;</span>
<a href="#l14.15"></a><span id="l14.15">   },</span>
<a href="#l14.16"></a><span id="l14.16"> </span>
<a href="#l14.17"></a><span id="l14.17">   // Override to allow setting from a JS variable.</span>
<a href="#l14.18"></a><span id="l14.18">   IsUrlType(aType) { return aType == this._urlType;},</span>
<a href="#l14.19"></a><span id="l14.19"> </span>
<a href="#l14.20"></a><span id="l14.20">     // msgIFooUrl implementation</span>
<a href="#l14.21"></a><span id="l14.21"> </span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

