<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 12630:374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9" />
<meta property="og:url" content="/comm-central/rev/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9" />
<meta property="og:description" content="Bug 883629 - remove test pilot from thunderbird. r=standard8" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9">shortlog</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9">files</a> |
changeset |
<a href="/comm-central/raw-rev/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9">raw</a>  | <a href="/comm-central/archive/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=883629">Bug 883629</a> - remove test pilot from thunderbird. r=standard8
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#77;&#97;&#103;&#110;&#117;&#115;&#32;&#77;&#101;&#108;&#105;&#110;&#32;&#60;&#109;&#107;&#109;&#101;&#108;&#105;&#110;&#43;&#109;&#111;&#122;&#105;&#108;&#108;&#97;&#64;&#105;&#107;&#105;&#46;&#102;&#105;&#62;</td></tr>
<tr><td></td><td class="date age">Sun, 23 Jun 2013 12:21:40 +0300</td></tr>

<tr>
 <td>changeset 12630</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9">374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9</a></td>
</tr>



<tr>
<td>parent 12629</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/89ca38497a74fa4e060e24e81e863fd31609520f">89ca38497a74fa4e060e24e81e863fd31609520f</a>
</td>
</tr>

<tr>
<td>child 12631</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/4a17c2c1bb24a7fe5916bdbab66934bcb3946b21">4a17c2c1bb24a7fe5916bdbab66934bcb3946b21</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9">9275</a></td></tr>
<tr><td>push user</td><td>mkmelin@iki.fi</td></tr>
<tr><td>push date</td><td class="date age">Sun, 23 Jun 2013 09:22:23 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@374d30ca7c59 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9&newProject=comm-central&newRevision=374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9&newProject=comm-central&newRevision=374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9&newProject=comm-central&newRevision=374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28standard8%29&revcount=50">standard8</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=883629">883629</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=883629">Bug 883629</a> - remove test pilot from thunderbird. r=standard8</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/Makefile.in">mail/app/profile/extensions/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/Makefile.in">file</a> |
<a href="/comm-central/annotate/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/Makefile.in">annotate</a> |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/Makefile.in">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/Makefile.in">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/chrome.manifest">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/chrome.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/chrome.manifest">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/chrome.manifest">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/chrome.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/components/TestPilot.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/components/TestPilot.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/components/TestPilot.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/components/TestPilot.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/components/TestPilot.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies-window.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/all-studies-window.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies-window.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies-window.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies-window.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies-window.xul">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/all-studies-window.xul</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies-window.xul">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies-window.xul">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies-window.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies.html">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/all-studies.html</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies.html">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies.html">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies.html">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/all-studies.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/all-studies.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/browser.css">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/browser.css</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/browser.css">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/browser.css">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/browser.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/browser.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/browser.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/browser.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/browser.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/browser.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/browser.xul">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/browser.xul</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/browser.xul">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/browser.xul">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/browser.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/debug.html">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/debug.html</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/debug.html">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/debug.html">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/debug.html">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/experiment-page.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/experiment-page.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/experiment-page.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/experiment-page.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/experiment-page.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/feedback-browser.xul">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/feedback-browser.xul</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/feedback-browser.xul">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/feedback-browser.xul">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/feedback-browser.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/fennec-options.xul">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/fennec-options.xul</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/fennec-options.xul">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/fennec-options.xul">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/fennec-options.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.colorhelpers.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.colorhelpers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.colorhelpers.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.colorhelpers.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.colorhelpers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.crosshair.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.flot.crosshair.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.crosshair.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.crosshair.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.crosshair.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.image.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.flot.image.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.image.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.image.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.image.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.flot.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.navigate.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.flot.navigate.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.navigate.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.navigate.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.navigate.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.selection.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.flot.selection.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.selection.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.selection.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.selection.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.stack.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.flot.stack.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.stack.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.stack.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.stack.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.threshold.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.flot.threshold.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.threshold.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.threshold.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.flot.threshold.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/flot/jquery.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/notificationBindings.xml">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/notificationBindings.xml</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/notificationBindings.xml">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/notificationBindings.xml">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/notificationBindings.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/raw-data-dialog.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/raw-data-dialog.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/raw-data-dialog.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/raw-data-dialog.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/raw-data-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/raw-data-dialog.xul">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/raw-data-dialog.xul</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/raw-data-dialog.xul">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/raw-data-dialog.xul">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/raw-data-dialog.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/raw-data.html">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/raw-data.html</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/raw-data.html">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/raw-data.html">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/raw-data.html">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/screen.css">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/screen.css</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/screen.css">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/screen.css">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/screen.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/status-quit.html">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/status-quit.html</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/status-quit.html">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/status-quit.html">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/status-quit.html">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/status.html">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/status.html</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/status.html">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/status.html">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/status.html">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/survey-generator.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/survey-generator.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/survey-generator.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/survey-generator.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/survey-generator.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/take-survey.html">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/take-survey.html</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/take-survey.html">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/take-survey.html">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/take-survey.html">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/tp-browser-customNotifications.xul">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/tp-browser-customNotifications.xul</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/tp-browser-customNotifications.xul">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/tp-browser-customNotifications.xul">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/tp-browser-customNotifications.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/tp-browser-popupNotifications.xul">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/tp-browser-popupNotifications.xul</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/tp-browser-popupNotifications.xul">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/tp-browser-popupNotifications.xul">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/tp-browser-popupNotifications.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/welcome-page.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/welcome-page.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/welcome-page.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/welcome-page.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/welcome-page.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/welcome.html">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/welcome.html</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/welcome.html">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/welcome.html">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/welcome.html">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/window-utils.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/window-utils.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/window-utils.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/window-utils.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/content/window-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/defaults/preferences/preferences.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/defaults/preferences/preferences.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/defaults/preferences/preferences.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/defaults/preferences/preferences.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/defaults/preferences/preferences.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/install.rdf.in">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/install.rdf.in</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/install.rdf.in">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/install.rdf.in">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/install.rdf.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/chrome.manifest">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/instrument/chrome.manifest</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/chrome.manifest">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/chrome.manifest">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/chrome.manifest">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/install.rdf">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/instrument/install.rdf</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/install.rdf">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/install.rdf">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/install.rdf">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/instrument.jsm">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/instrument/instrument.jsm</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/instrument.jsm">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/instrument.jsm">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/instrument.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/instrument.xul">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/instrument/instrument.xul</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/instrument.xul">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/instrument.xul">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/instrument/instrument.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/Observers.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/Observers.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/Observers.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/Observers.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/Observers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/dbutils.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/dbutils.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/dbutils.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/dbutils.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/dbutils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/experiment_data_store.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/experiment_data_store.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/experiment_data_store.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/experiment_data_store.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/experiment_data_store.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/feedback.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/feedback.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/feedback.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/feedback.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/feedback.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/interface.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/interface.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/interface.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/interface.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/interface.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/jar-code-store.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/jar-code-store.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/jar-code-store.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/jar-code-store.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/jar-code-store.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/cuddlefish.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/cuddlefish.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/cuddlefish.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/cuddlefish.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/cuddlefish.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/file.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/file.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/file.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/file.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/file.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/memory.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/memory.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/memory.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/memory.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/memory.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/observer-service.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/observer-service.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/observer-service.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/observer-service.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/observer-service.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/plain-text-console.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/plain-text-console.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/plain-text-console.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/plain-text-console.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/plain-text-console.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/preferences-service.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/preferences-service.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/preferences-service.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/preferences-service.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/preferences-service.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/securable-module.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/securable-module.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/securable-module.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/securable-module.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/securable-module.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/timer.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/timer.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/timer.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/timer.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/timer.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/traceback.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/traceback.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/traceback.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/traceback.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/traceback.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/unit-test.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/unit-test.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/unit-test.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/unit-test.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/unit-test.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/unload.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/unload.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/unload.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/unload.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/unload.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/url.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/url.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/url.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/url.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/url.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/xhr.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/xhr.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/xhr.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/xhr.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/lib/xhr.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/log4moz.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/log4moz.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/log4moz.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/log4moz.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/log4moz.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/metadata.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/metadata.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/metadata.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/metadata.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/metadata.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/notifications.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/notifications.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/notifications.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/notifications.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/notifications.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/remote-experiment-loader.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/remote-experiment-loader.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/remote-experiment-loader.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/remote-experiment-loader.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/remote-experiment-loader.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/setup.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/setup.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/setup.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/setup.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/setup.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/string_sanitizer.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/string_sanitizer.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/string_sanitizer.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/string_sanitizer.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/string_sanitizer.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/tasks.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/tasks.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/tasks.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/tasks.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/modules/tasks.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/badge-default.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/badge-default.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/badge-default.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/badge-default.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/badge-default.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/bg.jpg">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/bg.jpg</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/bg.jpg">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/bg.jpg">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/bg.jpg">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/css/screen-standalone-mobile.css">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/css/screen-standalone-mobile.css</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/css/screen-standalone-mobile.css">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/css/screen-standalone-mobile.css">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/css/screen-standalone-mobile.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/css/screen-standalone.css">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/css/screen-standalone.css</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/css/screen-standalone.css">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/css/screen-standalone.css">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/css/screen-standalone.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/dino_32x32.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/dino_32x32.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/dino_32x32.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/dino_32x32.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/dino_32x32.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/bg-status.jpg">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/images/bg-status.jpg</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/bg-status.jpg">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/bg-status.jpg">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/bg-status.jpg">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/callout.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/images/callout.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/callout.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/callout.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/callout.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/callout_continue.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/images/callout_continue.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/callout_continue.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/callout_continue.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/callout_continue.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/data1.jpg">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/images/data1.jpg</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/data1.jpg">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/data1.jpg">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/data1.jpg">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/data2.jpg">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/images/data2.jpg</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/data2.jpg">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/data2.jpg">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/data2.jpg">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_comments.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/images/home_comments.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_comments.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_comments.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_comments.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_computer.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/images/home_computer.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_computer.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_computer.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_computer.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_continue.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/images/home_continue.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_continue.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_continue.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_continue.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_quit.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/images/home_quit.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_quit.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_quit.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_quit.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_results.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/images/home_results.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_results.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_results.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_results.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_twitter.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/images/home_twitter.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_twitter.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_twitter.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_twitter.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_upcoming.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/images/home_upcoming.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_upcoming.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_upcoming.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/images/home_upcoming.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/logo.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/logo.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/logo.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/logo.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/logo.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/mozilla-logo.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/mozilla-logo.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/mozilla-logo.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/mozilla-logo.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/mozilla-logo.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/notification-tail-down.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/notification-tail-down.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/notification-tail-down.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/notification-tail-down.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/notification-tail-down.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/status-completed.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/status-completed.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/status-completed.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/status-completed.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/status-completed.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/status-ejected.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/status-ejected.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/status-ejected.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/status-ejected.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/status-ejected.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/status-missed.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/status-missed.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/status-missed.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/status-missed.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/status-missed.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/testPilot_200x200.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/testPilot_200x200.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/testPilot_200x200.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/testPilot_200x200.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/testPilot_200x200.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/testpilot_16x16.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/testpilot_16x16.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/testpilot_16x16.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/testpilot_16x16.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/testpilot_16x16.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/testpilot_32x32.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/testpilot_32x32.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/testpilot_32x32.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/testpilot_32x32.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/testpilot_32x32.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-completedstudies-32x32.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/tp-completedstudies-32x32.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-completedstudies-32x32.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-completedstudies-32x32.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-completedstudies-32x32.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-currentstudies-32x32.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/tp-currentstudies-32x32.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-currentstudies-32x32.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-currentstudies-32x32.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-currentstudies-32x32.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-generic-32x32.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/tp-generic-32x32.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-generic-32x32.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-generic-32x32.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-generic-32x32.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-learned-32x32.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/tp-learned-32x32.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-learned-32x32.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-learned-32x32.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-learned-32x32.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-results-48x48.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/tp-results-48x48.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-results-48x48.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-results-48x48.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-results-48x48.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-settings-32x32.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/tp-settings-32x32.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-settings-32x32.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-settings-32x32.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-settings-32x32.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-study-48x48.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/tp-study-48x48.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-study-48x48.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-study-48x48.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-study-48x48.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-submit-48x48.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/tp-submit-48x48.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-submit-48x48.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-submit-48x48.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/all/tp-submit-48x48.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/close_button.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/linux/close_button.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/close_button.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/close_button.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/close_button.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-broken-website.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/linux/feedback-broken-website.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-broken-website.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-broken-website.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-broken-website.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-frown-16x16.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/linux/feedback-frown-16x16.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-frown-16x16.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-frown-16x16.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-frown-16x16.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-idea.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/linux/feedback-idea.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-idea.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-idea.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-idea.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-rate.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/linux/feedback-rate.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-rate.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-rate.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-rate.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-smile-16x16.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/linux/feedback-smile-16x16.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-smile-16x16.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-smile-16x16.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback-smile-16x16.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback.css">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/linux/feedback.css</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback.css">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback.css">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/linux/feedback.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/close_button.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/mac/close_button.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/close_button.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/close_button.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/close_button.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-broken-website.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/mac/feedback-broken-website.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-broken-website.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-broken-website.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-broken-website.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-frown-16x16.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/mac/feedback-frown-16x16.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-frown-16x16.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-frown-16x16.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-frown-16x16.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-idea.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/mac/feedback-idea.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-idea.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-idea.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-idea.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-rate.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/mac/feedback-rate.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-rate.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-rate.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-rate.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-smile-16x16.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/mac/feedback-smile-16x16.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-smile-16x16.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-smile-16x16.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback-smile-16x16.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback.css">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/mac/feedback.css</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback.css">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback.css">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/feedback.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/notification-tail-down.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/mac/notification-tail-down.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/notification-tail-down.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/notification-tail-down.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/notification-tail-down.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/notification-tail-up.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/mac/notification-tail-up.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/notification-tail-up.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/notification-tail-up.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/mac/notification-tail-up.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/close_button.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/win/close_button.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/close_button.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/close_button.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/close_button.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-broken-website.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/win/feedback-broken-website.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-broken-website.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-broken-website.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-broken-website.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-frown-16x16.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/win/feedback-frown-16x16.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-frown-16x16.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-frown-16x16.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-frown-16x16.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-idea.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/win/feedback-idea.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-idea.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-idea.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-idea.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-rate.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/win/feedback-rate.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-rate.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-rate.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-rate.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-smile-16x16.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/win/feedback-smile-16x16.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-smile-16x16.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-smile-16x16.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback-smile-16x16.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback.css">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/win/feedback.css</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback.css">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback.css">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/feedback.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/notification-tail-down.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/win/notification-tail-down.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/notification-tail-down.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/notification-tail-down.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/notification-tail-down.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/notification-tail-up.png">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/win/notification-tail-up.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/notification-tail-up.png">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/notification-tail-up.png">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/skin/win/notification-tail-up.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/foo.jar">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/tests/foo.jar</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/foo.jar">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/foo.jar">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/foo.jar">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/foo.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/tests/foo.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/foo.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/foo.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/foo.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/test_data_store.js">mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/tests/test_data_store.js</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/test_data_store.js">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/test_data_store.js">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/app/profile/extensions/tbtestpilot%40labs.mozilla.com/tests/test_data_store.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/installer/package-manifest.in">mail/installer/package-manifest.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/installer/package-manifest.in">file</a> |
<a href="/comm-central/annotate/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/installer/package-manifest.in">annotate</a> |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/installer/package-manifest.in">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/installer/package-manifest.in">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/installer/package-manifest.in">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/installer/removed-files.in">mail/installer/removed-files.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/installer/removed-files.in">file</a> |
<a href="/comm-central/annotate/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/installer/removed-files.in">annotate</a> |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/installer/removed-files.in">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/installer/removed-files.in">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/installer/removed-files.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/locales/en-US/feedback/main.dtd">mail/locales/en-US/feedback/main.dtd</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/locales/en-US/feedback/main.dtd">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/locales/en-US/feedback/main.dtd">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/locales/en-US/feedback/main.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/locales/en-US/feedback/main.properties">mail/locales/en-US/feedback/main.properties</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/locales/en-US/feedback/main.properties">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/locales/en-US/feedback/main.properties">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/locales/en-US/feedback/main.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/locales/jar.mn">mail/locales/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/locales/jar.mn">file</a> |
<a href="/comm-central/annotate/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/locales/jar.mn">annotate</a> |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/locales/jar.mn">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/locales/jar.mn">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/locales/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/test/mozmill/runtest.py">mail/test/mozmill/runtest.py</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/test/mozmill/runtest.py">file</a> |
<a href="/comm-central/annotate/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/test/mozmill/runtest.py">annotate</a> |
<a href="/comm-central/diff/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/test/mozmill/runtest.py">diff</a> |
<a href="/comm-central/comparison/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/test/mozmill/runtest.py">comparison</a> |
<a href="/comm-central/log/374d30ca7c599aae5c72dec2cfcb63fe49b3a6d9/mail/test/mozmill/runtest.py">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/app/profile/extensions/Makefile.in</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/app/profile/extensions/Makefile.in</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -12,17 +12,16 @@ DISTROEXT = $(call core_abspath,$(DIST))</span>
<a href="#l1.4"></a><span id="l1.4"> </span>
<a href="#l1.5"></a><span id="l1.5"> include $(DEPTH)/config/autoconf.mk</span>
<a href="#l1.6"></a><span id="l1.6"> </span>
<a href="#l1.7"></a><span id="l1.7"> include $(topsrcdir)/config/rules.mk</span>
<a href="#l1.8"></a><span id="l1.8"> </span>
<a href="#l1.9"></a><span id="l1.9"> # If adding extra extensions here, check that EXTRA_ARGS defined below won't</span>
<a href="#l1.10"></a><span id="l1.10"> # affect them unintentionally.</span>
<a href="#l1.11"></a><span id="l1.11"> EXTENSIONS = \</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-  tbtestpilot@labs.mozilla.com \</span>
<a href="#l1.13"></a><span id="l1.13">   $(NULL)</span>
<a href="#l1.14"></a><span id="l1.14"> </span>
<a href="#l1.15"></a><span id="l1.15"> # We are in release mode, we don't want to ship the debug file.</span>
<a href="#l1.16"></a><span id="l1.16"> ifndef MOZ_DEBUG</span>
<a href="#l1.17"></a><span id="l1.17"> EXTRA_ARGS = -x content/debug.html</span>
<a href="#l1.18"></a><span id="l1.18"> endif</span>
<a href="#l1.19"></a><span id="l1.19"> </span>
<a href="#l1.20"></a><span id="l1.20"> DEFINES += \</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1">deleted file mode 100644</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/chrome.manifest</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineplus">+++ /dev/null</span>
<a href="#l2.4"></a><span id="l2.4" class="difflineat">@@ -1,28 +0,0 @@</span>
<a href="#l2.5"></a><span id="l2.5" class="difflineminus">-resource testpilot ./</span>
<a href="#l2.6"></a><span id="l2.6" class="difflineminus">-content testpilot content/</span>
<a href="#l2.7"></a><span id="l2.7" class="difflineminus">-skin testpilot skin skin/all/</span>
<a href="#l2.8"></a><span id="l2.8" class="difflineminus">-skin testpilot-os skin skin/linux/ os=Linux</span>
<a href="#l2.9"></a><span id="l2.9" class="difflineminus">-skin testpilot-os skin skin/linux/ os=SunOS</span>
<a href="#l2.10"></a><span id="l2.10" class="difflineminus">-skin testpilot-os skin skin/mac/ os=Darwin</span>
<a href="#l2.11"></a><span id="l2.11" class="difflineminus">-skin testpilot-os skin skin/win/ os=WINNT</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-# firefox</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineminus">-overlay chrome://browser/content/macBrowserOverlay.xul chrome://testpilot/content/browser.xul   application={ec8030f7-c20a-464f-9b0e-13a3a9e97384}</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineminus">-</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineminus">-# firefox</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineminus">-overlay chrome://browser/content/browser.xul chrome://testpilot/content/browser.xul   application={ec8030f7-c20a-464f-9b0e-13a3a9e97384}</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineminus">-</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineminus">-# thunderbird</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineminus">-overlay chrome://messenger/content/mailWindowOverlay.xul chrome://testpilot/content/browser.xul   application={3550f703-e582-4d05-9a08-453d09bdfdc6}</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineminus">-</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineminus">-style	chrome://global/content/customizeToolbar.xul	chrome://testpilot/content/browser.css</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineminus">-# For the menubar on Mac</span>
<a href="#l2.24"></a><span id="l2.24" class="difflineminus">-overlay chrome://testpilot/content/all-studies-window.xul chrome://browser/content/macBrowserOverlay.xul application={ec8030f7-c20a-464f-9b0e-13a3a9e97384} os=Darwin</span>
<a href="#l2.25"></a><span id="l2.25" class="difflineminus">-</span>
<a href="#l2.26"></a><span id="l2.26" class="difflineminus">-</span>
<a href="#l2.27"></a><span id="l2.27" class="difflineminus">-component {e6e5e58f-7977-485a-b076-2f74bee2677b} components/TestPilot.js</span>
<a href="#l2.28"></a><span id="l2.28" class="difflineminus">-contract @mozilla.org/testpilot/service;1 {e6e5e58f-7977-485a-b076-2f74bee2677b}</span>
<a href="#l2.29"></a><span id="l2.29" class="difflineminus">-category profile-after-change testpilot @mozilla.org/testpilot/service;1</span>
<a href="#l2.30"></a><span id="l2.30" class="difflineminus">-</span>
<a href="#l2.31"></a><span id="l2.31" class="difflineminus">-# For the options on Fennec</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineminus">-override chrome://testpilot/content/options.xul chrome://testpilot/content/fennec-options.xul application={a23983c0-fd0e-11dc-95ff-0800200c9a66}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1">deleted file mode 100644</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/components/TestPilot.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineplus">+++ /dev/null</span>
<a href="#l3.4"></a><span id="l3.4" class="difflineat">@@ -1,56 +0,0 @@</span>
<a href="#l3.5"></a><span id="l3.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l3.6"></a><span id="l3.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l3.7"></a><span id="l3.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l3.8"></a><span id="l3.8" class="difflineminus">-</span>
<a href="#l3.9"></a><span id="l3.9" class="difflineminus">-const Cc = Components.classes;</span>
<a href="#l3.10"></a><span id="l3.10" class="difflineminus">-const Ci = Components.interfaces;</span>
<a href="#l3.11"></a><span id="l3.11" class="difflineminus">-const Cu = Components.utils;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-Cu.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineminus">-</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineminus">-function TestPilotComponent() {}</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineminus">-TestPilotComponent.prototype = {</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineminus">-  classDescription: &quot;Test Pilot Component&quot;,</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineminus">-  contractID: &quot;@mozilla.org/testpilot/service;1&quot;,</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineminus">-  classID: Components.ID(&quot;{e6e5e58f-7977-485a-b076-2f74bee2677b}&quot;),</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineminus">-  _xpcom_categories: [{ category: &quot;profile-after-change&quot; }],</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineminus">-  _startupTimer: null,</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineminus">-</span>
<a href="#l3.23"></a><span id="l3.23" class="difflineminus">-  QueryInterface: XPCOMUtils.generateQI([Ci.nsIObserver,</span>
<a href="#l3.24"></a><span id="l3.24" class="difflineminus">-                                         Ci.nsISupportsWeakReference]),</span>
<a href="#l3.25"></a><span id="l3.25" class="difflineminus">-</span>
<a href="#l3.26"></a><span id="l3.26" class="difflineminus">-  observe: function TPC__observe(subject, topic, data) {</span>
<a href="#l3.27"></a><span id="l3.27" class="difflineminus">-    let os = Cc[&quot;@mozilla.org/observer-service;1&quot;].</span>
<a href="#l3.28"></a><span id="l3.28" class="difflineminus">-        getService(Ci.nsIObserverService);</span>
<a href="#l3.29"></a><span id="l3.29" class="difflineminus">-    switch (topic) {</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineminus">-    case &quot;profile-after-change&quot;:</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-      //Services.console.logStringMessage(&quot;Test Pilot Component Sessionstore\n&quot;);</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineminus">-      os.addObserver(this, &quot;mail-startup-done&quot;, true);</span>
<a href="#l3.33"></a><span id="l3.33" class="difflineminus">-      os.addObserver(this, &quot;sessionstore-windows-restored&quot;, true);</span>
<a href="#l3.34"></a><span id="l3.34" class="difflineminus">-      break;</span>
<a href="#l3.35"></a><span id="l3.35" class="difflineminus">-    case &quot;sessionstore-windows-restored&quot;:</span>
<a href="#l3.36"></a><span id="l3.36" class="difflineminus">-    case &quot;mail-startup-done&quot;:</span>
<a href="#l3.37"></a><span id="l3.37" class="difflineminus">-      /* Stop oberver, to ensure that globalStartup doesn't get</span>
<a href="#l3.38"></a><span id="l3.38" class="difflineminus">-       * called more than once. */</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineminus">-      os.removeObserver(this, topic, false);</span>
<a href="#l3.40"></a><span id="l3.40" class="difflineminus">-      /* Call global startup on a timer so that it's off of the main</span>
<a href="#l3.41"></a><span id="l3.41" class="difflineminus">-       * thread... delay a few seconds to give firefox time to finish</span>
<a href="#l3.42"></a><span id="l3.42" class="difflineminus">-       * starting up.</span>
<a href="#l3.43"></a><span id="l3.43" class="difflineminus">-       */</span>
<a href="#l3.44"></a><span id="l3.44" class="difflineminus">-      this._startupTimer = Cc[&quot;@mozilla.org/timer;1&quot;].createInstance(Ci.nsITimer);</span>
<a href="#l3.45"></a><span id="l3.45" class="difflineminus">-      this._startupTimer.initWithCallback(</span>
<a href="#l3.46"></a><span id="l3.46" class="difflineminus">-        {notify: function(timer) {</span>
<a href="#l3.47"></a><span id="l3.47" class="difflineminus">-           Cu.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineminus">-           TestPilotSetup.globalStartup();</span>
<a href="#l3.49"></a><span id="l3.49" class="difflineminus">-         }}, 3000, Ci.nsITimer.TYPE_ONE_SHOT);</span>
<a href="#l3.50"></a><span id="l3.50" class="difflineminus">-      break;</span>
<a href="#l3.51"></a><span id="l3.51" class="difflineminus">-    }</span>
<a href="#l3.52"></a><span id="l3.52" class="difflineminus">-  }</span>
<a href="#l3.53"></a><span id="l3.53" class="difflineminus">-};</span>
<a href="#l3.54"></a><span id="l3.54" class="difflineminus">-</span>
<a href="#l3.55"></a><span id="l3.55" class="difflineminus">-const components = [TestPilotComponent];</span>
<a href="#l3.56"></a><span id="l3.56" class="difflineminus">-var NSGetFactory, NSGetModule;</span>
<a href="#l3.57"></a><span id="l3.57" class="difflineminus">-if (XPCOMUtils.generateNSGetFactory)</span>
<a href="#l3.58"></a><span id="l3.58" class="difflineminus">-  NSGetFactory = XPCOMUtils.generateNSGetFactory(components);</span>
<a href="#l3.59"></a><span id="l3.59" class="difflineminus">-else</span>
<a href="#l3.60"></a><span id="l3.60" class="difflineminus">-  NSGetModule = XPCOMUtils.generateNSGetModule(components);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1">deleted file mode 100644</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/all-studies-window.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineplus">+++ /dev/null</span>
<a href="#l4.4"></a><span id="l4.4" class="difflineat">@@ -1,439 +0,0 @@</span>
<a href="#l4.5"></a><span id="l4.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l4.6"></a><span id="l4.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l4.7"></a><span id="l4.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l4.8"></a><span id="l4.8" class="difflineminus">-</span>
<a href="#l4.9"></a><span id="l4.9" class="difflineminus">-// TODO Show individual status page in new chromeless window as html with</span>
<a href="#l4.10"></a><span id="l4.10" class="difflineminus">-// background color set to &quot;moz-dialog&quot;.</span>
<a href="#l4.11"></a><span id="l4.11" class="difflineminus">-</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-const NO_STUDIES_IMG = &quot;chrome://testpilot/skin/testPilot_200x200.png&quot;;</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-const PROPOSE_STUDY_URL =</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-  &quot;https://wiki.mozilla.org/Labs/Test_Pilot#For_researchers&quot;;</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">-</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineminus">-var TestPilotXulWindow = {</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineminus">-  _stringBundle : null,</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineminus">-</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineminus">-  onSubmitButton: function(experimentId) {</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineminus">-    let task = TestPilotSetup.getTaskById(experimentId);</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineminus">-    let button = document.getElementById(&quot;submit-button-&quot; + task.id);</span>
<a href="#l4.23"></a><span id="l4.23" class="difflineminus">-</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineminus">-    // Hide the upload button so it doesn't get clicked again...</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineminus">-    let parent = button.parentNode;</span>
<a href="#l4.26"></a><span id="l4.26" class="difflineminus">-    while (parent.firstChild) {</span>
<a href="#l4.27"></a><span id="l4.27" class="difflineminus">-      parent.removeChild(parent.firstChild);</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineminus">-    }</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineminus">-    // Replace it with a message:</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineminus">-    this.addLabel(</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineminus">-      parent,</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineminus">-      this._stringBundle.getString(&quot;testpilot.studiesWindow.uploading&quot;));</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineminus">-    let self = this;</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineminus">-</span>
<a href="#l4.35"></a><span id="l4.35" class="difflineminus">-    task.upload( function(success) {</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineminus">-      while (parent.firstChild) {</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineminus">-        parent.removeChild(parent.firstChild);</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineminus">-      }</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineminus">-      if (success) {</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineminus">-        self.addThanksMessage(parent);</span>
<a href="#l4.41"></a><span id="l4.41" class="difflineminus">-        // TODO or should we move it to 'finished studies' immediately?</span>
<a href="#l4.42"></a><span id="l4.42" class="difflineminus">-      } else {</span>
<a href="#l4.43"></a><span id="l4.43" class="difflineminus">-        // TODO a better error message?</span>
<a href="#l4.44"></a><span id="l4.44" class="difflineminus">-        self.addLabel(</span>
<a href="#l4.45"></a><span id="l4.45" class="difflineminus">-          parent,</span>
<a href="#l4.46"></a><span id="l4.46" class="difflineminus">-          self._stringBundle.getString(</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineminus">-            &quot;testpilot.studiesWindow.unableToReachServer&quot;));</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineminus">-      }</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineminus">-    });</span>
<a href="#l4.50"></a><span id="l4.50" class="difflineminus">-</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineminus">-  },</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineminus">-</span>
<a href="#l4.53"></a><span id="l4.53" class="difflineminus">-  addThanksMessage: function(container) {</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineminus">-    // Fill in status box with icon and message to show success</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineminus">-    let hbox = document.createElement(&quot;hbox&quot;);</span>
<a href="#l4.56"></a><span id="l4.56" class="difflineminus">-    container.appendChild(this.makeSpacer());</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineminus">-    container.appendChild(hbox);</span>
<a href="#l4.58"></a><span id="l4.58" class="difflineminus">-    this.addLabel(</span>
<a href="#l4.59"></a><span id="l4.59" class="difflineminus">-      container,</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineminus">-      this._stringBundle.getString(</span>
<a href="#l4.61"></a><span id="l4.61" class="difflineminus">-        &quot;testpilot.studiesWindow.thanksForContributing&quot;));</span>
<a href="#l4.62"></a><span id="l4.62" class="difflineminus">-    container.appendChild(this.makeSpacer());</span>
<a href="#l4.63"></a><span id="l4.63" class="difflineminus">-    hbox.appendChild(this.makeSpacer());</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineminus">-    this.addImg(hbox, &quot;study-submitted&quot;);</span>
<a href="#l4.65"></a><span id="l4.65" class="difflineminus">-    hbox.appendChild(this.makeSpacer());</span>
<a href="#l4.66"></a><span id="l4.66" class="difflineminus">-  },</span>
<a href="#l4.67"></a><span id="l4.67" class="difflineminus">-</span>
<a href="#l4.68"></a><span id="l4.68" class="difflineminus">-  addXulLink: function (container, text, url, openInTab) {</span>
<a href="#l4.69"></a><span id="l4.69" class="difflineminus">-    let linkContainer = document.createElement(&quot;hbox&quot;);</span>
<a href="#l4.70"></a><span id="l4.70" class="difflineminus">-    let link = document.createElement(&quot;label&quot;);</span>
<a href="#l4.71"></a><span id="l4.71" class="difflineminus">-    let spacer = document.createElement(&quot;spacer&quot;);</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineminus">-    link.setAttribute(&quot;value&quot;, text);</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineminus">-    link.setAttribute(&quot;class&quot;, &quot;text-link&quot;);</span>
<a href="#l4.74"></a><span id="l4.74" class="difflineminus">-    if (openInTab) {</span>
<a href="#l4.75"></a><span id="l4.75" class="difflineminus">-      link.addEventListener(&quot;click&quot;,</span>
<a href="#l4.76"></a><span id="l4.76" class="difflineminus">-        function(event) {</span>
<a href="#l4.77"></a><span id="l4.77" class="difflineminus">-          if (event.button == 0) {</span>
<a href="#l4.78"></a><span id="l4.78" class="difflineminus">-            TestPilotWindowUtils.openInTab(url);</span>
<a href="#l4.79"></a><span id="l4.79" class="difflineminus">-          }</span>
<a href="#l4.80"></a><span id="l4.80" class="difflineminus">-        }, false);</span>
<a href="#l4.81"></a><span id="l4.81" class="difflineminus">-    } else {</span>
<a href="#l4.82"></a><span id="l4.82" class="difflineminus">-      link.addEventListener(&quot;click&quot;,</span>
<a href="#l4.83"></a><span id="l4.83" class="difflineminus">-        function(event) {</span>
<a href="#l4.84"></a><span id="l4.84" class="difflineminus">-          if (event.button == 0) {</span>
<a href="#l4.85"></a><span id="l4.85" class="difflineminus">-            TestPilotWindowUtils.openChromeless(url);</span>
<a href="#l4.86"></a><span id="l4.86" class="difflineminus">-          }</span>
<a href="#l4.87"></a><span id="l4.87" class="difflineminus">-        }, false);</span>
<a href="#l4.88"></a><span id="l4.88" class="difflineminus">-    }</span>
<a href="#l4.89"></a><span id="l4.89" class="difflineminus">-    linkContainer.appendChild(link);</span>
<a href="#l4.90"></a><span id="l4.90" class="difflineminus">-    spacer.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l4.91"></a><span id="l4.91" class="difflineminus">-    linkContainer.appendChild(spacer);</span>
<a href="#l4.92"></a><span id="l4.92" class="difflineminus">-    container.appendChild(linkContainer);</span>
<a href="#l4.93"></a><span id="l4.93" class="difflineminus">-  },</span>
<a href="#l4.94"></a><span id="l4.94" class="difflineminus">-</span>
<a href="#l4.95"></a><span id="l4.95" class="difflineminus">-  addLabel: function(container, text, styleClass) {</span>
<a href="#l4.96"></a><span id="l4.96" class="difflineminus">-    let label = document.createElement(&quot;label&quot;);</span>
<a href="#l4.97"></a><span id="l4.97" class="difflineminus">-    label.setAttribute(&quot;value&quot;, text);</span>
<a href="#l4.98"></a><span id="l4.98" class="difflineminus">-    if (styleClass) {</span>
<a href="#l4.99"></a><span id="l4.99" class="difflineminus">-      label.setAttribute(&quot;class&quot;, styleClass);</span>
<a href="#l4.100"></a><span id="l4.100" class="difflineminus">-    }</span>
<a href="#l4.101"></a><span id="l4.101" class="difflineminus">-    container.appendChild(label);</span>
<a href="#l4.102"></a><span id="l4.102" class="difflineminus">-  },</span>
<a href="#l4.103"></a><span id="l4.103" class="difflineminus">-</span>
<a href="#l4.104"></a><span id="l4.104" class="difflineminus">-  addImg: function(container, iconClass) {</span>
<a href="#l4.105"></a><span id="l4.105" class="difflineminus">-    let newImg = document.createElement(&quot;image&quot;);</span>
<a href="#l4.106"></a><span id="l4.106" class="difflineminus">-    newImg.setAttribute(&quot;class&quot;, iconClass);</span>
<a href="#l4.107"></a><span id="l4.107" class="difflineminus">-    container.appendChild(newImg);</span>
<a href="#l4.108"></a><span id="l4.108" class="difflineminus">-  },</span>
<a href="#l4.109"></a><span id="l4.109" class="difflineminus">-</span>
<a href="#l4.110"></a><span id="l4.110" class="difflineminus">-  makeSpacer: function() {</span>
<a href="#l4.111"></a><span id="l4.111" class="difflineminus">-    let spacer = document.createElement(&quot;spacer&quot;);</span>
<a href="#l4.112"></a><span id="l4.112" class="difflineminus">-    spacer.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l4.113"></a><span id="l4.113" class="difflineminus">-    return spacer;</span>
<a href="#l4.114"></a><span id="l4.114" class="difflineminus">-  },</span>
<a href="#l4.115"></a><span id="l4.115" class="difflineminus">-</span>
<a href="#l4.116"></a><span id="l4.116" class="difflineminus">-  addThumbnail: function(container, imgUrl) {</span>
<a href="#l4.117"></a><span id="l4.117" class="difflineminus">-    let boundingBox = document.createElement(&quot;vbox&quot;);</span>
<a href="#l4.118"></a><span id="l4.118" class="difflineminus">-    boundingBox.setAttribute(&quot;class&quot;, &quot;results-thumbnail&quot;);</span>
<a href="#l4.119"></a><span id="l4.119" class="difflineminus">-    let bBox2 = document.createElement(&quot;hbox&quot;);</span>
<a href="#l4.120"></a><span id="l4.120" class="difflineminus">-</span>
<a href="#l4.121"></a><span id="l4.121" class="difflineminus">-    boundingBox.appendChild(this.makeSpacer());</span>
<a href="#l4.122"></a><span id="l4.122" class="difflineminus">-    boundingBox.appendChild(bBox2);</span>
<a href="#l4.123"></a><span id="l4.123" class="difflineminus">-    boundingBox.appendChild(this.makeSpacer());</span>
<a href="#l4.124"></a><span id="l4.124" class="difflineminus">-</span>
<a href="#l4.125"></a><span id="l4.125" class="difflineminus">-    bBox2.appendChild(this.makeSpacer());</span>
<a href="#l4.126"></a><span id="l4.126" class="difflineminus">-    let newImg = document.createElement(&quot;image&quot;);</span>
<a href="#l4.127"></a><span id="l4.127" class="difflineminus">-    newImg.setAttribute(&quot;src&quot;, imgUrl);</span>
<a href="#l4.128"></a><span id="l4.128" class="difflineminus">-    newImg.setAttribute(&quot;class&quot;, &quot;results-thumbnail&quot;);</span>
<a href="#l4.129"></a><span id="l4.129" class="difflineminus">-    bBox2.appendChild(newImg);</span>
<a href="#l4.130"></a><span id="l4.130" class="difflineminus">-    bBox2.appendChild(this.makeSpacer());</span>
<a href="#l4.131"></a><span id="l4.131" class="difflineminus">-</span>
<a href="#l4.132"></a><span id="l4.132" class="difflineminus">-    container.appendChild(boundingBox);</span>
<a href="#l4.133"></a><span id="l4.133" class="difflineminus">-  },</span>
<a href="#l4.134"></a><span id="l4.134" class="difflineminus">-</span>
<a href="#l4.135"></a><span id="l4.135" class="difflineminus">-  addProgressBar: function(container, percent) {</span>
<a href="#l4.136"></a><span id="l4.136" class="difflineminus">-    let progBar = document.createElement(&quot;progressmeter&quot;);</span>
<a href="#l4.137"></a><span id="l4.137" class="difflineminus">-    progBar.setAttribute(&quot;mode&quot;, &quot;determined&quot;);</span>
<a href="#l4.138"></a><span id="l4.138" class="difflineminus">-    progBar.setAttribute(&quot;value&quot;, Math.ceil(percent).toString());</span>
<a href="#l4.139"></a><span id="l4.139" class="difflineminus">-    container.appendChild(progBar);</span>
<a href="#l4.140"></a><span id="l4.140" class="difflineminus">-  },</span>
<a href="#l4.141"></a><span id="l4.141" class="difflineminus">-</span>
<a href="#l4.142"></a><span id="l4.142" class="difflineminus">-  addDescription: function(container, title, paragraph) {</span>
<a href="#l4.143"></a><span id="l4.143" class="difflineminus">-    let desc = document.createElement(&quot;description&quot;);</span>
<a href="#l4.144"></a><span id="l4.144" class="difflineminus">-    desc.setAttribute(&quot;class&quot;, &quot;study-title&quot;);</span>
<a href="#l4.145"></a><span id="l4.145" class="difflineminus">-    let txtNode = document.createTextNode(title);</span>
<a href="#l4.146"></a><span id="l4.146" class="difflineminus">-    desc.appendChild(txtNode);</span>
<a href="#l4.147"></a><span id="l4.147" class="difflineminus">-    container.appendChild(desc);</span>
<a href="#l4.148"></a><span id="l4.148" class="difflineminus">-</span>
<a href="#l4.149"></a><span id="l4.149" class="difflineminus">-    desc = document.createElement(&quot;description&quot;);</span>
<a href="#l4.150"></a><span id="l4.150" class="difflineminus">-    desc.setAttribute(&quot;class&quot;, &quot;study-description&quot;);</span>
<a href="#l4.151"></a><span id="l4.151" class="difflineminus">-    desc.setAttribute(&quot;crop&quot;, &quot;none&quot;);</span>
<a href="#l4.152"></a><span id="l4.152" class="difflineminus">-    txtNode = document.createTextNode(paragraph);</span>
<a href="#l4.153"></a><span id="l4.153" class="difflineminus">-    desc.appendChild(txtNode);</span>
<a href="#l4.154"></a><span id="l4.154" class="difflineminus">-    container.appendChild(desc);</span>
<a href="#l4.155"></a><span id="l4.155" class="difflineminus">-  },</span>
<a href="#l4.156"></a><span id="l4.156" class="difflineminus">-</span>
<a href="#l4.157"></a><span id="l4.157" class="difflineminus">-  addButton: function(container, label, id, onClickHandler) {</span>
<a href="#l4.158"></a><span id="l4.158" class="difflineminus">-    let button = document.createElement(&quot;button&quot;);</span>
<a href="#l4.159"></a><span id="l4.159" class="difflineminus">-    button.setAttribute(&quot;label&quot;, this._stringBundle.getString(label));</span>
<a href="#l4.160"></a><span id="l4.160" class="difflineminus">-    button.setAttribute(&quot;id&quot;, id);</span>
<a href="#l4.161"></a><span id="l4.161" class="difflineminus">-    button.addEventListener(&quot;command&quot;, onClickHandler, false);</span>
<a href="#l4.162"></a><span id="l4.162" class="difflineminus">-    container.appendChild(button);</span>
<a href="#l4.163"></a><span id="l4.163" class="difflineminus">-  },</span>
<a href="#l4.164"></a><span id="l4.164" class="difflineminus">-</span>
<a href="#l4.165"></a><span id="l4.165" class="difflineminus">-  _sortNewestFirst: function(experiments) {</span>
<a href="#l4.166"></a><span id="l4.166" class="difflineminus">-    experiments.sort(</span>
<a href="#l4.167"></a><span id="l4.167" class="difflineminus">-      function sortFunc(a, b) {</span>
<a href="#l4.168"></a><span id="l4.168" class="difflineminus">-        if (a.endDate &amp;&amp; b.endDate) {</span>
<a href="#l4.169"></a><span id="l4.169" class="difflineminus">-          return b.endDate - a.endDate;</span>
<a href="#l4.170"></a><span id="l4.170" class="difflineminus">-        }</span>
<a href="#l4.171"></a><span id="l4.171" class="difflineminus">-        if (a.publishDate &amp;&amp; b.publishDate) {</span>
<a href="#l4.172"></a><span id="l4.172" class="difflineminus">-          if (isNaN(a.publishDate) || isNaN(b.publishDate)) {</span>
<a href="#l4.173"></a><span id="l4.173" class="difflineminus">-            return 0;</span>
<a href="#l4.174"></a><span id="l4.174" class="difflineminus">-          }</span>
<a href="#l4.175"></a><span id="l4.175" class="difflineminus">-          return b.publishDate - a.publishDate;</span>
<a href="#l4.176"></a><span id="l4.176" class="difflineminus">-        }</span>
<a href="#l4.177"></a><span id="l4.177" class="difflineminus">-        return 0;</span>
<a href="#l4.178"></a><span id="l4.178" class="difflineminus">-      });</span>
<a href="#l4.179"></a><span id="l4.179" class="difflineminus">-    return experiments;</span>
<a href="#l4.180"></a><span id="l4.180" class="difflineminus">-  },</span>
<a href="#l4.181"></a><span id="l4.181" class="difflineminus">-</span>
<a href="#l4.182"></a><span id="l4.182" class="difflineminus">-  onLoad: function () {</span>
<a href="#l4.183"></a><span id="l4.183" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/Observers.js&quot;);</span>
<a href="#l4.184"></a><span id="l4.184" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l4.185"></a><span id="l4.185" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/tasks.js&quot;);</span>
<a href="#l4.186"></a><span id="l4.186" class="difflineminus">-</span>
<a href="#l4.187"></a><span id="l4.187" class="difflineminus">-    this._stringBundle = document.getElementById(&quot;testpilot-stringbundle&quot;);</span>
<a href="#l4.188"></a><span id="l4.188" class="difflineminus">-    this.sizeWindow();</span>
<a href="#l4.189"></a><span id="l4.189" class="difflineminus">-    this._init(false);</span>
<a href="#l4.190"></a><span id="l4.190" class="difflineminus">-    Observers.add(&quot;testpilot:task:changed&quot;, this._onTaskStatusChanged, this);</span>
<a href="#l4.191"></a><span id="l4.191" class="difflineminus">-  },</span>
<a href="#l4.192"></a><span id="l4.192" class="difflineminus">-</span>
<a href="#l4.193"></a><span id="l4.193" class="difflineminus">-  onUnload: function() {</span>
<a href="#l4.194"></a><span id="l4.194" class="difflineminus">-    document.getElementById(&quot;settings-pane&quot;).writePreferences(true);</span>
<a href="#l4.195"></a><span id="l4.195" class="difflineminus">-    Observers.remove(&quot;testpilot:task:changed&quot;, this._onTaskStatusChanged, this);</span>
<a href="#l4.196"></a><span id="l4.196" class="difflineminus">-  },</span>
<a href="#l4.197"></a><span id="l4.197" class="difflineminus">-</span>
<a href="#l4.198"></a><span id="l4.198" class="difflineminus">-  _onTaskStatusChanged : function() {</span>
<a href="#l4.199"></a><span id="l4.199" class="difflineminus">-    this._init(true);</span>
<a href="#l4.200"></a><span id="l4.200" class="difflineminus">-  },</span>
<a href="#l4.201"></a><span id="l4.201" class="difflineminus">-</span>
<a href="#l4.202"></a><span id="l4.202" class="difflineminus">-  onTakeSurveyButton: function(taskId) {</span>
<a href="#l4.203"></a><span id="l4.203" class="difflineminus">-    let task = TestPilotSetup.getTaskById(taskId);</span>
<a href="#l4.204"></a><span id="l4.204" class="difflineminus">-    TestPilotWindowUtils.openChromeless(task.defaultUrl);</span>
<a href="#l4.205"></a><span id="l4.205" class="difflineminus">-    task.onDetailPageOpened();</span>
<a href="#l4.206"></a><span id="l4.206" class="difflineminus">-  },</span>
<a href="#l4.207"></a><span id="l4.207" class="difflineminus">-</span>
<a href="#l4.208"></a><span id="l4.208" class="difflineminus">-  _init: function(aReload) {</span>
<a href="#l4.209"></a><span id="l4.209" class="difflineminus">-    if (!TestPilotSetup.startupComplete) {</span>
<a href="#l4.210"></a><span id="l4.210" class="difflineminus">-      // If you opened the window before tasks are done loading, exit now</span>
<a href="#l4.211"></a><span id="l4.211" class="difflineminus">-      // but try again in a few seconds.</span>
<a href="#l4.212"></a><span id="l4.212" class="difflineminus">-      window.setTimeout(</span>
<a href="#l4.213"></a><span id="l4.213" class="difflineminus">-        function() { TestPilotXulWindow._init(aReload); }, 2000);</span>
<a href="#l4.214"></a><span id="l4.214" class="difflineminus">-      return;</span>
<a href="#l4.215"></a><span id="l4.215" class="difflineminus">-    }</span>
<a href="#l4.216"></a><span id="l4.216" class="difflineminus">-</span>
<a href="#l4.217"></a><span id="l4.217" class="difflineminus">-    let numFinishedStudies = 0;</span>
<a href="#l4.218"></a><span id="l4.218" class="difflineminus">-    let numCurrentStudies = 0;</span>
<a href="#l4.219"></a><span id="l4.219" class="difflineminus">-</span>
<a href="#l4.220"></a><span id="l4.220" class="difflineminus">-    /* Remove 'loading' message */</span>
<a href="#l4.221"></a><span id="l4.221" class="difflineminus">-    let msg = window.document.getElementById(&quot;still-loading-msg&quot;);</span>
<a href="#l4.222"></a><span id="l4.222" class="difflineminus">-    msg.setAttribute(&quot;hidden&quot;, &quot;true&quot;);</span>
<a href="#l4.223"></a><span id="l4.223" class="difflineminus">-</span>
<a href="#l4.224"></a><span id="l4.224" class="difflineminus">-    if (aReload) {</span>
<a href="#l4.225"></a><span id="l4.225" class="difflineminus">-      /* If we're reloading, start by clearing out any old stuff already</span>
<a href="#l4.226"></a><span id="l4.226" class="difflineminus">-       * present in the listboxes. */</span>
<a href="#l4.227"></a><span id="l4.227" class="difflineminus">-      let listboxIds =</span>
<a href="#l4.228"></a><span id="l4.228" class="difflineminus">-        [&quot;current-studies-listbox&quot;, &quot;finished-studies-listbox&quot;,</span>
<a href="#l4.229"></a><span id="l4.229" class="difflineminus">-         &quot;study-results-listbox&quot;];</span>
<a href="#l4.230"></a><span id="l4.230" class="difflineminus">-      for (let i = 0; i &lt; listboxIds.length; i++) {</span>
<a href="#l4.231"></a><span id="l4.231" class="difflineminus">-        let listbox = document.getElementById(listboxIds[i]);</span>
<a href="#l4.232"></a><span id="l4.232" class="difflineminus">-</span>
<a href="#l4.233"></a><span id="l4.233" class="difflineminus">-        while (listbox.lastChild) {</span>
<a href="#l4.234"></a><span id="l4.234" class="difflineminus">-          listbox.removeChild(listbox.lastChild);</span>
<a href="#l4.235"></a><span id="l4.235" class="difflineminus">-        }</span>
<a href="#l4.236"></a><span id="l4.236" class="difflineminus">-      }</span>
<a href="#l4.237"></a><span id="l4.237" class="difflineminus">-    }</span>
<a href="#l4.238"></a><span id="l4.238" class="difflineminus">-</span>
<a href="#l4.239"></a><span id="l4.239" class="difflineminus">-    let experiments = TestPilotSetup.getAllTasks();</span>
<a href="#l4.240"></a><span id="l4.240" class="difflineminus">-    experiments = this._sortNewestFirst(experiments);</span>
<a href="#l4.241"></a><span id="l4.241" class="difflineminus">-</span>
<a href="#l4.242"></a><span id="l4.242" class="difflineminus">-    for (let i = 0; i &lt; experiments.length; i++) {</span>
<a href="#l4.243"></a><span id="l4.243" class="difflineminus">-      let task = experiments[i];</span>
<a href="#l4.244"></a><span id="l4.244" class="difflineminus">-      let newRow = document.createElement(&quot;richlistitem&quot;);</span>
<a href="#l4.245"></a><span id="l4.245" class="difflineminus">-      newRow.setAttribute(&quot;class&quot;, &quot;tp-study-list&quot;);</span>
<a href="#l4.246"></a><span id="l4.246" class="difflineminus">-</span>
<a href="#l4.247"></a><span id="l4.247" class="difflineminus">-      this.addThumbnail(newRow, task.thumbnail);</span>
<a href="#l4.248"></a><span id="l4.248" class="difflineminus">-</span>
<a href="#l4.249"></a><span id="l4.249" class="difflineminus">-      let textVbox = document.createElement(&quot;vbox&quot;);</span>
<a href="#l4.250"></a><span id="l4.250" class="difflineminus">-      newRow.appendChild(textVbox);</span>
<a href="#l4.251"></a><span id="l4.251" class="difflineminus">-</span>
<a href="#l4.252"></a><span id="l4.252" class="difflineminus">-      let openInTab = (task.taskType == TaskConstants.TYPE_LEGACY);</span>
<a href="#l4.253"></a><span id="l4.253" class="difflineminus">-</span>
<a href="#l4.254"></a><span id="l4.254" class="difflineminus">-      this.addDescription(textVbox, task.title, task.summary);</span>
<a href="#l4.255"></a><span id="l4.255" class="difflineminus">-      this.addXulLink(</span>
<a href="#l4.256"></a><span id="l4.256" class="difflineminus">-        textVbox, this._stringBundle.getString(&quot;testpilot.moreInfo&quot;),</span>
<a href="#l4.257"></a><span id="l4.257" class="difflineminus">-        task.defaultUrl, openInTab);</span>
<a href="#l4.258"></a><span id="l4.258" class="difflineminus">-</span>
<a href="#l4.259"></a><span id="l4.259" class="difflineminus">-      // Create the rightmost status area, depending on status:</span>
<a href="#l4.260"></a><span id="l4.260" class="difflineminus">-      let statusVbox = document.createElement(&quot;vbox&quot;);</span>
<a href="#l4.261"></a><span id="l4.261" class="difflineminus">-      if (task.status == TaskConstants.STATUS_FINISHED) {</span>
<a href="#l4.262"></a><span id="l4.262" class="difflineminus">-        this.addLabel(</span>
<a href="#l4.263"></a><span id="l4.263" class="difflineminus">-          statusVbox,</span>
<a href="#l4.264"></a><span id="l4.264" class="difflineminus">-          this._stringBundle.getFormattedString(</span>
<a href="#l4.265"></a><span id="l4.265" class="difflineminus">-            &quot;testpilot.studiesWindow.finishedOn&quot;,</span>
<a href="#l4.266"></a><span id="l4.266" class="difflineminus">-            [(new Date(task.endDate)).toLocaleDateString()]));</span>
<a href="#l4.267"></a><span id="l4.267" class="difflineminus">-        this.addButton(statusVbox,</span>
<a href="#l4.268"></a><span id="l4.268" class="difflineminus">-          &quot;testpilot.submit&quot;,</span>
<a href="#l4.269"></a><span id="l4.269" class="difflineminus">-          &quot;submit-button-&quot; + task.id,</span>
<a href="#l4.270"></a><span id="l4.270" class="difflineminus">-          function() {TestPilotXulWindow.onSubmitButton(task.id)});</span>
<a href="#l4.271"></a><span id="l4.271" class="difflineminus">-      }</span>
<a href="#l4.272"></a><span id="l4.272" class="difflineminus">-      if (task.status == TaskConstants.STATUS_CANCELLED) {</span>
<a href="#l4.273"></a><span id="l4.273" class="difflineminus">-        let hbox = document.createElement(&quot;hbox&quot;);</span>
<a href="#l4.274"></a><span id="l4.274" class="difflineminus">-        newRow.setAttribute(&quot;class&quot;, &quot;tp-opted-out&quot;);</span>
<a href="#l4.275"></a><span id="l4.275" class="difflineminus">-        statusVbox.appendChild(this.makeSpacer());</span>
<a href="#l4.276"></a><span id="l4.276" class="difflineminus">-        statusVbox.appendChild(hbox);</span>
<a href="#l4.277"></a><span id="l4.277" class="difflineminus">-        this.addLabel(</span>
<a href="#l4.278"></a><span id="l4.278" class="difflineminus">-          statusVbox,</span>
<a href="#l4.279"></a><span id="l4.279" class="difflineminus">-          this._stringBundle.getString(&quot;testpilot.studiesWindow.canceledStudy&quot;));</span>
<a href="#l4.280"></a><span id="l4.280" class="difflineminus">-        statusVbox.appendChild(this.makeSpacer());</span>
<a href="#l4.281"></a><span id="l4.281" class="difflineminus">-        hbox.appendChild(this.makeSpacer());</span>
<a href="#l4.282"></a><span id="l4.282" class="difflineminus">-        this.addImg(hbox, &quot;study-canceled&quot;);</span>
<a href="#l4.283"></a><span id="l4.283" class="difflineminus">-        hbox.appendChild(this.makeSpacer());</span>
<a href="#l4.284"></a><span id="l4.284" class="difflineminus">-      }</span>
<a href="#l4.285"></a><span id="l4.285" class="difflineminus">-      if (task.status == TaskConstants.STATUS_NEW ||</span>
<a href="#l4.286"></a><span id="l4.286" class="difflineminus">-          task.status == TaskConstants.STATUS_PENDING ) {</span>
<a href="#l4.287"></a><span id="l4.287" class="difflineminus">-        newRow.setAttribute(&quot;class&quot;, &quot;tp-new-results&quot;);</span>
<a href="#l4.288"></a><span id="l4.288" class="difflineminus">-</span>
<a href="#l4.289"></a><span id="l4.289" class="difflineminus">-        if (task.taskType == TaskConstants.TYPE_SURVEY) {</span>
<a href="#l4.290"></a><span id="l4.290" class="difflineminus">-          this.addButton(</span>
<a href="#l4.291"></a><span id="l4.291" class="difflineminus">-            statusVbox,</span>
<a href="#l4.292"></a><span id="l4.292" class="difflineminus">-            &quot;testpilot.takeSurvey&quot;,</span>
<a href="#l4.293"></a><span id="l4.293" class="difflineminus">-            &quot;survey-button&quot;,</span>
<a href="#l4.294"></a><span id="l4.294" class="difflineminus">-            function(){TestPilotXulWindow.onTakeSurveyButton(task.id)});</span>
<a href="#l4.295"></a><span id="l4.295" class="difflineminus">-        } else if (task.taskType == TaskConstants.TYPE_EXPERIMENT) {</span>
<a href="#l4.296"></a><span id="l4.296" class="difflineminus">-          if (task.startDate) {</span>
<a href="#l4.297"></a><span id="l4.297" class="difflineminus">-            this.addLabel(</span>
<a href="#l4.298"></a><span id="l4.298" class="difflineminus">-              statusVbox,</span>
<a href="#l4.299"></a><span id="l4.299" class="difflineminus">-              this._stringBundle.getFormattedString(</span>
<a href="#l4.300"></a><span id="l4.300" class="difflineminus">-                &quot;testpilot.studiesWindow.willStart&quot;,</span>
<a href="#l4.301"></a><span id="l4.301" class="difflineminus">-                [(new Date(task.startDate)).toLocaleDateString()]));</span>
<a href="#l4.302"></a><span id="l4.302" class="difflineminus">-          }</span>
<a href="#l4.303"></a><span id="l4.303" class="difflineminus">-        }</span>
<a href="#l4.304"></a><span id="l4.304" class="difflineminus">-      }</span>
<a href="#l4.305"></a><span id="l4.305" class="difflineminus">-      if (task.status == TaskConstants.STATUS_IN_PROGRESS ||</span>
<a href="#l4.306"></a><span id="l4.306" class="difflineminus">-          task.status == TaskConstants.STATUS_STARTING) {</span>
<a href="#l4.307"></a><span id="l4.307" class="difflineminus">-</span>
<a href="#l4.308"></a><span id="l4.308" class="difflineminus">-        if (task.taskType == TaskConstants.TYPE_SURVEY) {</span>
<a href="#l4.309"></a><span id="l4.309" class="difflineminus">-          this.addButton(</span>
<a href="#l4.310"></a><span id="l4.310" class="difflineminus">-            statusVbox,</span>
<a href="#l4.311"></a><span id="l4.311" class="difflineminus">-            &quot;testpilot.takeSurvey&quot;,</span>
<a href="#l4.312"></a><span id="l4.312" class="difflineminus">-            &quot;survey-button&quot;,</span>
<a href="#l4.313"></a><span id="l4.313" class="difflineminus">-            function(){TestPilotXulWindow.onTakeSurveyButton(task.id)});</span>
<a href="#l4.314"></a><span id="l4.314" class="difflineminus">-        } else if (task.taskType == TaskConstants.TYPE_EXPERIMENT) {</span>
<a href="#l4.315"></a><span id="l4.315" class="difflineminus">-          this.addLabel(</span>
<a href="#l4.316"></a><span id="l4.316" class="difflineminus">-            statusVbox,</span>
<a href="#l4.317"></a><span id="l4.317" class="difflineminus">-            this._stringBundle.getString(</span>
<a href="#l4.318"></a><span id="l4.318" class="difflineminus">-             &quot;testpilot.studiesWindow.gatheringData&quot;));</span>
<a href="#l4.319"></a><span id="l4.319" class="difflineminus">-             let now = (new Date()).getTime();</span>
<a href="#l4.320"></a><span id="l4.320" class="difflineminus">-          let progress =</span>
<a href="#l4.321"></a><span id="l4.321" class="difflineminus">-            100 * (now - task.startDate) / (task.endDate - task.startDate);</span>
<a href="#l4.322"></a><span id="l4.322" class="difflineminus">-          this.addProgressBar(statusVbox, progress);</span>
<a href="#l4.323"></a><span id="l4.323" class="difflineminus">-          this.addLabel(</span>
<a href="#l4.324"></a><span id="l4.324" class="difflineminus">-            statusVbox,</span>
<a href="#l4.325"></a><span id="l4.325" class="difflineminus">-            this._stringBundle.getFormattedString(</span>
<a href="#l4.326"></a><span id="l4.326" class="difflineminus">-              &quot;testpilot.studiesWindow.willFinish&quot;,</span>
<a href="#l4.327"></a><span id="l4.327" class="difflineminus">-              [(new Date(task.endDate)).toLocaleDateString()]));</span>
<a href="#l4.328"></a><span id="l4.328" class="difflineminus">-        }</span>
<a href="#l4.329"></a><span id="l4.329" class="difflineminus">-      }</span>
<a href="#l4.330"></a><span id="l4.330" class="difflineminus">-      if (task.status &gt;= TaskConstants.STATUS_SUBMITTED) {</span>
<a href="#l4.331"></a><span id="l4.331" class="difflineminus">-        if (task.taskType == TaskConstants.TYPE_RESULTS) {</span>
<a href="#l4.332"></a><span id="l4.332" class="difflineminus">-          let maintask = TestPilotSetup.getTaskById(task.relatedStudyId);</span>
<a href="#l4.333"></a><span id="l4.333" class="difflineminus">-          if (maintask &amp;&amp; maintask.status &gt;= TaskConstants.STATUS_SUBMITTED) {</span>
<a href="#l4.334"></a><span id="l4.334" class="difflineminus">-            this.addThanksMessage(statusVbox);</span>
<a href="#l4.335"></a><span id="l4.335" class="difflineminus">-          }</span>
<a href="#l4.336"></a><span id="l4.336" class="difflineminus">-        } else {</span>
<a href="#l4.337"></a><span id="l4.337" class="difflineminus">-          if (task.status == TaskConstants.STATUS_MISSED) {</span>
<a href="#l4.338"></a><span id="l4.338" class="difflineminus">-            // Icon for missed studies</span>
<a href="#l4.339"></a><span id="l4.339" class="difflineminus">-            let hbox = document.createElement(&quot;hbox&quot;);</span>
<a href="#l4.340"></a><span id="l4.340" class="difflineminus">-            newRow.setAttribute(&quot;class&quot;, &quot;tp-opted-out&quot;);</span>
<a href="#l4.341"></a><span id="l4.341" class="difflineminus">-            statusVbox.appendChild(this.makeSpacer());</span>
<a href="#l4.342"></a><span id="l4.342" class="difflineminus">-            statusVbox.appendChild(hbox);</span>
<a href="#l4.343"></a><span id="l4.343" class="difflineminus">-            this.addLabel(</span>
<a href="#l4.344"></a><span id="l4.344" class="difflineminus">-              statusVbox,</span>
<a href="#l4.345"></a><span id="l4.345" class="difflineminus">-              this._stringBundle.getString(&quot;testpilot.studiesWindow.missedStudy&quot;));</span>
<a href="#l4.346"></a><span id="l4.346" class="difflineminus">-            statusVbox.appendChild(this.makeSpacer());</span>
<a href="#l4.347"></a><span id="l4.347" class="difflineminus">-            hbox.appendChild(this.makeSpacer());</span>
<a href="#l4.348"></a><span id="l4.348" class="difflineminus">-            this.addImg(hbox, &quot;study-missed&quot;);</span>
<a href="#l4.349"></a><span id="l4.349" class="difflineminus">-            hbox.appendChild(this.makeSpacer());</span>
<a href="#l4.350"></a><span id="l4.350" class="difflineminus">-          } else {</span>
<a href="#l4.351"></a><span id="l4.351" class="difflineminus">-            this.addThanksMessage(statusVbox);</span>
<a href="#l4.352"></a><span id="l4.352" class="difflineminus">-            numFinishedStudies ++;</span>
<a href="#l4.353"></a><span id="l4.353" class="difflineminus">-          }</span>
<a href="#l4.354"></a><span id="l4.354" class="difflineminus">-        }</span>
<a href="#l4.355"></a><span id="l4.355" class="difflineminus">-      }</span>
<a href="#l4.356"></a><span id="l4.356" class="difflineminus">-      let spacer = document.createElement(&quot;spacer&quot;);</span>
<a href="#l4.357"></a><span id="l4.357" class="difflineminus">-      spacer.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l4.358"></a><span id="l4.358" class="difflineminus">-      newRow.appendChild(spacer);</span>
<a href="#l4.359"></a><span id="l4.359" class="difflineminus">-      newRow.appendChild(statusVbox);</span>
<a href="#l4.360"></a><span id="l4.360" class="difflineminus">-</span>
<a href="#l4.361"></a><span id="l4.361" class="difflineminus">-      // Use status to decide which panel to add this to:</span>
<a href="#l4.362"></a><span id="l4.362" class="difflineminus">-      let rowset;</span>
<a href="#l4.363"></a><span id="l4.363" class="difflineminus">-      if (task.taskType == TaskConstants.TYPE_RESULTS) {</span>
<a href="#l4.364"></a><span id="l4.364" class="difflineminus">-        rowset = document.getElementById(&quot;study-results-listbox&quot;);</span>
<a href="#l4.365"></a><span id="l4.365" class="difflineminus">-      } else if (task.status &gt; TaskConstants.STATUS_FINISHED) {</span>
<a href="#l4.366"></a><span id="l4.366" class="difflineminus">-        rowset = document.getElementById(&quot;finished-studies-listbox&quot;);</span>
<a href="#l4.367"></a><span id="l4.367" class="difflineminus">-      } else {</span>
<a href="#l4.368"></a><span id="l4.368" class="difflineminus">-        rowset = document.getElementById(&quot;current-studies-listbox&quot;);</span>
<a href="#l4.369"></a><span id="l4.369" class="difflineminus">-        numCurrentStudies++;</span>
<a href="#l4.370"></a><span id="l4.370" class="difflineminus">-      }</span>
<a href="#l4.371"></a><span id="l4.371" class="difflineminus">-</span>
<a href="#l4.372"></a><span id="l4.372" class="difflineminus">-      // TODO further distinguish by background colors.</span>
<a href="#l4.373"></a><span id="l4.373" class="difflineminus">-      rowset.appendChild(newRow);</span>
<a href="#l4.374"></a><span id="l4.374" class="difflineminus">-    }</span>
<a href="#l4.375"></a><span id="l4.375" class="difflineminus">-</span>
<a href="#l4.376"></a><span id="l4.376" class="difflineminus">-    // If there are no current studies, show a message about upcoming</span>
<a href="#l4.377"></a><span id="l4.377" class="difflineminus">-    // studies:</span>
<a href="#l4.378"></a><span id="l4.378" class="difflineminus">-    if (numCurrentStudies == 0) {</span>
<a href="#l4.379"></a><span id="l4.379" class="difflineminus">-      let newRow = document.createElement(&quot;richlistitem&quot;);</span>
<a href="#l4.380"></a><span id="l4.380" class="difflineminus">-      newRow.setAttribute(&quot;class&quot;, &quot;tp-study-list&quot;);</span>
<a href="#l4.381"></a><span id="l4.381" class="difflineminus">-      this.addThumbnail(newRow, NO_STUDIES_IMG);</span>
<a href="#l4.382"></a><span id="l4.382" class="difflineminus">-      let textVbox = document.createElement(&quot;vbox&quot;);</span>
<a href="#l4.383"></a><span id="l4.383" class="difflineminus">-      textVbox.setAttribute(&quot;class&quot;, &quot;pilot-largetext&quot;);</span>
<a href="#l4.384"></a><span id="l4.384" class="difflineminus">-      newRow.appendChild(textVbox);</span>
<a href="#l4.385"></a><span id="l4.385" class="difflineminus">-      this.addDescription(</span>
<a href="#l4.386"></a><span id="l4.386" class="difflineminus">-        textVbox, &quot;&quot;,</span>
<a href="#l4.387"></a><span id="l4.387" class="difflineminus">-        this._stringBundle.getString(&quot;testpilot.studiesWindow.noStudies&quot;));</span>
<a href="#l4.388"></a><span id="l4.388" class="difflineminus">-      this.addXulLink(</span>
<a href="#l4.389"></a><span id="l4.389" class="difflineminus">-        textVbox,</span>
<a href="#l4.390"></a><span id="l4.390" class="difflineminus">-        this._stringBundle.getString(&quot;testpilot.studiesWindow.proposeStudy&quot;),</span>
<a href="#l4.391"></a><span id="l4.391" class="difflineminus">-        PROPOSE_STUDY_URL, true);</span>
<a href="#l4.392"></a><span id="l4.392" class="difflineminus">-      document.getElementById(&quot;current-studies-listbox&quot;).appendChild(newRow);</span>
<a href="#l4.393"></a><span id="l4.393" class="difflineminus">-    }</span>
<a href="#l4.394"></a><span id="l4.394" class="difflineminus">-</span>
<a href="#l4.395"></a><span id="l4.395" class="difflineminus">-    // Show number of studies the user finished on badge:</span>
<a href="#l4.396"></a><span id="l4.396" class="difflineminus">-    document.getElementById(&quot;num-finished-badge&quot;).setAttribute(</span>
<a href="#l4.397"></a><span id="l4.397" class="difflineminus">-      &quot;value&quot;, numFinishedStudies);</span>
<a href="#l4.398"></a><span id="l4.398" class="difflineminus">-  },</span>
<a href="#l4.399"></a><span id="l4.399" class="difflineminus">-</span>
<a href="#l4.400"></a><span id="l4.400" class="difflineminus">-  sizeWindow: function() {</span>
<a href="#l4.401"></a><span id="l4.401" class="difflineminus">-    // Size listboxes based on available screen size, then size window to fit</span>
<a href="#l4.402"></a><span id="l4.402" class="difflineminus">-    // list boxes.</span>
<a href="#l4.403"></a><span id="l4.403" class="difflineminus">-    let currList = document.getElementById(&quot;current-studies-listbox&quot;);</span>
<a href="#l4.404"></a><span id="l4.404" class="difflineminus">-    let finList = document.getElementById(&quot;finished-studies-listbox&quot;);</span>
<a href="#l4.405"></a><span id="l4.405" class="difflineminus">-    let resultsList = document.getElementById(&quot;study-results-listbox&quot;);</span>
<a href="#l4.406"></a><span id="l4.406" class="difflineminus">-</span>
<a href="#l4.407"></a><span id="l4.407" class="difflineminus">-    let screenWidth = window.screen.availWidth;</span>
<a href="#l4.408"></a><span id="l4.408" class="difflineminus">-    let screenHeight = window.screen.availHeight;</span>
<a href="#l4.409"></a><span id="l4.409" class="difflineminus">-    let width = screenWidth &gt;= 800 ? 700 : screenWidth - 100;</span>
<a href="#l4.410"></a><span id="l4.410" class="difflineminus">-    let height = screenHeight &gt;= 800 ? 700 : screenHeight - 100;</span>
<a href="#l4.411"></a><span id="l4.411" class="difflineminus">-</span>
<a href="#l4.412"></a><span id="l4.412" class="difflineminus">-    height -= 130; // Or whatever is height of title bar plus windowdragbox</span>
<a href="#l4.413"></a><span id="l4.413" class="difflineminus">-</span>
<a href="#l4.414"></a><span id="l4.414" class="difflineminus">-    currList.width = width;</span>
<a href="#l4.415"></a><span id="l4.415" class="difflineminus">-    currList.height = height;</span>
<a href="#l4.416"></a><span id="l4.416" class="difflineminus">-    finList.width = width;</span>
<a href="#l4.417"></a><span id="l4.417" class="difflineminus">-    finList.height = height;</span>
<a href="#l4.418"></a><span id="l4.418" class="difflineminus">-    resultsList.width = width;</span>
<a href="#l4.419"></a><span id="l4.419" class="difflineminus">-    resultsList.height = height;</span>
<a href="#l4.420"></a><span id="l4.420" class="difflineminus">-    window.sizeToContent();</span>
<a href="#l4.421"></a><span id="l4.421" class="difflineminus">-  },</span>
<a href="#l4.422"></a><span id="l4.422" class="difflineminus">-</span>
<a href="#l4.423"></a><span id="l4.423" class="difflineminus">-  focusPane: function(paneIndex) {</span>
<a href="#l4.424"></a><span id="l4.424" class="difflineminus">-    document.getElementById(&quot;tp-xulwindow-deck&quot;).selectedIndex = paneIndex;</span>
<a href="#l4.425"></a><span id="l4.425" class="difflineminus">-</span>
<a href="#l4.426"></a><span id="l4.426" class="difflineminus">-    // When you focus the 'study findings' tab, any results there which</span>
<a href="#l4.427"></a><span id="l4.427" class="difflineminus">-    // are still marked &quot;new&quot; should have their status changed as the user</span>
<a href="#l4.428"></a><span id="l4.428" class="difflineminus">-    // is considered to have seen them.</span>
<a href="#l4.429"></a><span id="l4.429" class="difflineminus">-    if (paneIndex == 2) {</span>
<a href="#l4.430"></a><span id="l4.430" class="difflineminus">-      Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l4.431"></a><span id="l4.431" class="difflineminus">-      Components.utils.import(&quot;resource://testpilot/modules/tasks.js&quot;);</span>
<a href="#l4.432"></a><span id="l4.432" class="difflineminus">-</span>
<a href="#l4.433"></a><span id="l4.433" class="difflineminus">-      let experiments = TestPilotSetup.getAllTasks();</span>
<a href="#l4.434"></a><span id="l4.434" class="difflineminus">-      for each (let experiment in experiments) {</span>
<a href="#l4.435"></a><span id="l4.435" class="difflineminus">-        if (experiment.taskType == TaskConstants.TYPE_RESULTS) {</span>
<a href="#l4.436"></a><span id="l4.436" class="difflineminus">-          if (experiment.status == TaskConstants.STATUS_NEW) {</span>
<a href="#l4.437"></a><span id="l4.437" class="difflineminus">-            experiment.changeStatus(TaskConstants.STATUS_ARCHIVED, true);</span>
<a href="#l4.438"></a><span id="l4.438" class="difflineminus">-          }</span>
<a href="#l4.439"></a><span id="l4.439" class="difflineminus">-        }</span>
<a href="#l4.440"></a><span id="l4.440" class="difflineminus">-      }</span>
<a href="#l4.441"></a><span id="l4.441" class="difflineminus">-    }</span>
<a href="#l4.442"></a><span id="l4.442" class="difflineminus">-  }</span>
<a href="#l4.443"></a><span id="l4.443" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1">deleted file mode 100644</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/all-studies-window.xul</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineplus">+++ /dev/null</span>
<a href="#l5.4"></a><span id="l5.4" class="difflineat">@@ -1,144 +0,0 @@</span>
<a href="#l5.5"></a><span id="l5.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l5.6"></a><span id="l5.6" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l5.7"></a><span id="l5.7" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l5.8"></a><span id="l5.8" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l5.9"></a><span id="l5.9" class="difflineminus">-</span>
<a href="#l5.10"></a><span id="l5.10" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://global/skin/global.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://global/skin/preferences.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://mozapps/content/extensions/extensions.css&quot;</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-  type=&quot;text/css&quot;?&gt;</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://testpilot/content/browser.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineminus">-</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineminus">-</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineminus">-&lt;!DOCTYPE prefwindow [</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineminus">-  &lt;!ENTITY % testpilotDTD SYSTEM &quot;chrome://testpilot/locale/main.dtd&quot;&gt;</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineminus">-    %testpilotDTD;</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineminus">-]&gt;</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineminus">-</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineminus">-&lt;prefwindow id=&quot;test-pilot-all-studies-window&quot;</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineminus">-  title=&quot;&amp;testpilot.studiesWindow.title;&quot;</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineminus">-  windowtype=&quot;extensions:testpilot:all_studies_window&quot;</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineminus">-  xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineminus">-  onload=&quot;TestPilotXulWindow.onLoad();&quot;</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineminus">-  onunload=&quot;TestPilotXulWindow.onUnload();&quot;&gt;</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineminus">-</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineminus">-  &lt;script src=&quot;chrome://testpilot/content/window-utils.js&quot;</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineminus">-    type=&quot;application/javascript;version=1.8&quot;/&gt;</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineminus">-  &lt;script src=&quot;chrome://testpilot/content/all-studies-window.js&quot;</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineminus">-    type=&quot;application/javascript;version=1.8&quot;/&gt;</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineminus">-  &lt;script src=&quot;chrome://communicator/content/utilityOverlay.js&quot;</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineminus">-    type=&quot;application/javascript;version=1.8&quot;/&gt;</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineminus">-</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineminus">-  &lt;stringbundleset id=&quot;stringbundleset&quot;&gt;</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineminus">-    &lt;stringbundle id=&quot;testpilot-stringbundle&quot;</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineminus">-      src=&quot;chrome://testpilot/locale/main.properties&quot; /&gt;</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineminus">-  &lt;/stringbundleset&gt;</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineminus">-</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineminus">-  &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineminus">-    &lt;windowdragbox orient=&quot;vertical&quot;&gt;</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineminus">-      &lt;radiogroup id=&quot;tp-radiogroup&quot; orient=&quot;horizontal&quot; role=&quot;listbox&quot;</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineminus">-        class=&quot;paneSelector&quot;</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineminus">-        onselect=&quot;TestPilotXulWindow.focusPane(this.selectedIndex);&quot;&gt;</span>
<a href="#l5.46"></a><span id="l5.46" class="difflineminus">-        &lt;radio pane=&quot;current-studies-pane-button&quot; orient=&quot;vertical&quot;&gt;</span>
<a href="#l5.47"></a><span id="l5.47" class="difflineminus">-          &lt;image class=&quot;paneButtonIcon&quot; /&gt;</span>
<a href="#l5.48"></a><span id="l5.48" class="difflineminus">-          &lt;label class=&quot;paneButtonLabel&quot;</span>
<a href="#l5.49"></a><span id="l5.49" class="difflineminus">-            value=&quot;&amp;testpilot.studiesWindow.currentStudies.label;&quot;/&gt;</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineminus">-        &lt;/radio&gt;</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineminus">-        &lt;radio pane=&quot;finished-studies-pane-button&quot; orient=&quot;vertical&quot;&gt;</span>
<a href="#l5.52"></a><span id="l5.52" class="difflineminus">-          &lt;stack align=&quot;center&quot; pack=&quot;center&quot;&gt;</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineminus">-            &lt;hbox align=&quot;center&quot; pack=&quot;center&quot;&gt;</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineminus">-             &lt;image class=&quot;paneButtonIcon&quot; /&gt;</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineminus">-            &lt;/hbox&gt;</span>
<a href="#l5.56"></a><span id="l5.56" class="difflineminus">-            &lt;label id=&quot;num-finished-badge&quot; class=&quot;pane-button-badge&quot;/&gt;</span>
<a href="#l5.57"></a><span id="l5.57" class="difflineminus">-          &lt;/stack&gt;</span>
<a href="#l5.58"></a><span id="l5.58" class="difflineminus">-          &lt;label class=&quot;paneButtonLabel&quot;</span>
<a href="#l5.59"></a><span id="l5.59" class="difflineminus">-            value=&quot;&amp;testpilot.studiesWindow.finishedStudies.label;&quot;/&gt;</span>
<a href="#l5.60"></a><span id="l5.60" class="difflineminus">-        &lt;/radio&gt;</span>
<a href="#l5.61"></a><span id="l5.61" class="difflineminus">-        &lt;radio pane=&quot;study-results-pane-button&quot; orient=&quot;vertical&quot;&gt;</span>
<a href="#l5.62"></a><span id="l5.62" class="difflineminus">-          &lt;image class=&quot;paneButtonIcon&quot; /&gt;</span>
<a href="#l5.63"></a><span id="l5.63" class="difflineminus">-          &lt;label class=&quot;paneButtonLabel&quot;</span>
<a href="#l5.64"></a><span id="l5.64" class="difflineminus">-            value=&quot;&amp;testpilot.studiesWindow.studyFindings.label;&quot;/&gt;</span>
<a href="#l5.65"></a><span id="l5.65" class="difflineminus">-        &lt;/radio&gt;</span>
<a href="#l5.66"></a><span id="l5.66" class="difflineminus">-        &lt;radio pane=&quot;settings-pane-button&quot; orient=&quot;vertical&quot;&gt;</span>
<a href="#l5.67"></a><span id="l5.67" class="difflineminus">-          &lt;image class=&quot;paneButtonIcon&quot; /&gt;</span>
<a href="#l5.68"></a><span id="l5.68" class="difflineminus">-          &lt;label class=&quot;paneButtonLabel&quot;</span>
<a href="#l5.69"></a><span id="l5.69" class="difflineminus">-            value=&quot;&amp;testpilot.studiesWindow.settings.label;&quot;/&gt;</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineminus">-        &lt;/radio&gt;</span>
<a href="#l5.71"></a><span id="l5.71" class="difflineminus">-      &lt;/radiogroup&gt;</span>
<a href="#l5.72"></a><span id="l5.72" class="difflineminus">-    &lt;/windowdragbox&gt;</span>
<a href="#l5.73"></a><span id="l5.73" class="difflineminus">-</span>
<a href="#l5.74"></a><span id="l5.74" class="difflineminus">-    &lt;deck id=&quot;tp-xulwindow-deck&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l5.75"></a><span id="l5.75" class="difflineminus">-      &lt;prefpane id=&quot;current-studies-pane&quot; class=&quot;tp-tab-panel&quot;&gt;</span>
<a href="#l5.76"></a><span id="l5.76" class="difflineminus">-        &lt;richlistbox id=&quot;current-studies-listbox&quot; class=&quot;tp-study-list&quot;</span>
<a href="#l5.77"></a><span id="l5.77" class="difflineminus">-          disabled=&quot;true&quot;&gt;</span>
<a href="#l5.78"></a><span id="l5.78" class="difflineminus">-          &lt;richlistitem id=&quot;still-loading-msg&quot; class=&quot;tp-study-list&quot;&gt;</span>
<a href="#l5.79"></a><span id="l5.79" class="difflineminus">-            &lt;description class=&quot;pilot-largetext&quot;&gt;</span>
<a href="#l5.80"></a><span id="l5.80" class="difflineminus">-              &amp;testpilot.studiesWindow.stillLoadingMessage;</span>
<a href="#l5.81"></a><span id="l5.81" class="difflineminus">-            &lt;/description&gt;</span>
<a href="#l5.82"></a><span id="l5.82" class="difflineminus">-          &lt;/richlistitem&gt;</span>
<a href="#l5.83"></a><span id="l5.83" class="difflineminus">-        &lt;/richlistbox&gt;</span>
<a href="#l5.84"></a><span id="l5.84" class="difflineminus">-      &lt;/prefpane&gt;</span>
<a href="#l5.85"></a><span id="l5.85" class="difflineminus">-</span>
<a href="#l5.86"></a><span id="l5.86" class="difflineminus">-      &lt;prefpane id=&quot;finished-studies-pane&quot; class=&quot;tp-tab-panel&quot;&gt;</span>
<a href="#l5.87"></a><span id="l5.87" class="difflineminus">-        &lt;richlistbox id=&quot;finished-studies-listbox&quot; class=&quot;tp-study-list&quot;</span>
<a href="#l5.88"></a><span id="l5.88" class="difflineminus">-          disabled=&quot;true&quot;/&gt;</span>
<a href="#l5.89"></a><span id="l5.89" class="difflineminus">-      &lt;/prefpane&gt;</span>
<a href="#l5.90"></a><span id="l5.90" class="difflineminus">-</span>
<a href="#l5.91"></a><span id="l5.91" class="difflineminus">-      &lt;prefpane id=&quot;study-results-pane&quot; class=&quot;tp-tab-panel&quot;&gt;</span>
<a href="#l5.92"></a><span id="l5.92" class="difflineminus">-        &lt;richlistbox id=&quot;study-results-listbox&quot; class=&quot;tp-study-list&quot;</span>
<a href="#l5.93"></a><span id="l5.93" class="difflineminus">-          disabled=&quot;true&quot;/&gt;</span>
<a href="#l5.94"></a><span id="l5.94" class="difflineminus">-      &lt;/prefpane&gt;</span>
<a href="#l5.95"></a><span id="l5.95" class="difflineminus">-</span>
<a href="#l5.96"></a><span id="l5.96" class="difflineminus">-      &lt;prefpane id=&quot;settings-pane&quot; class=&quot;tp-tab-panel&quot;&gt;</span>
<a href="#l5.97"></a><span id="l5.97" class="difflineminus">-        &lt;preferences&gt;</span>
<a href="#l5.98"></a><span id="l5.98" class="difflineminus">-          &lt;preference id=&quot;notify-finished&quot; type=&quot;bool&quot;</span>
<a href="#l5.99"></a><span id="l5.99" class="difflineminus">-                      name=&quot;extensions.testpilot.popup.showOnStudyFinished&quot;/&gt;</span>
<a href="#l5.100"></a><span id="l5.100" class="difflineminus">-          &lt;preference id=&quot;notify-new&quot; type=&quot;bool&quot;</span>
<a href="#l5.101"></a><span id="l5.101" class="difflineminus">-                      name=&quot;extensions.testpilot.popup.showOnNewStudy&quot;/&gt;</span>
<a href="#l5.102"></a><span id="l5.102" class="difflineminus">-          &lt;preference id=&quot;notify-results&quot; type=&quot;bool&quot;</span>
<a href="#l5.103"></a><span id="l5.103" class="difflineminus">-                      name=&quot;extensions.testpilot.popup.showOnNewResults&quot;/&gt;</span>
<a href="#l5.104"></a><span id="l5.104" class="difflineminus">-          &lt;preference id=&quot;always-submit-data&quot; type=&quot;bool&quot;</span>
<a href="#l5.105"></a><span id="l5.105" class="difflineminus">-                      name=&quot;extensions.testpilot.alwaysSubmitData&quot;/&gt;</span>
<a href="#l5.106"></a><span id="l5.106" class="difflineminus">-        &lt;/preferences&gt;</span>
<a href="#l5.107"></a><span id="l5.107" class="difflineminus">-        &lt;vbox style=&quot;padding: 12px;&quot;&gt;</span>
<a href="#l5.108"></a><span id="l5.108" class="difflineminus">-          &lt;groupbox&gt;</span>
<a href="#l5.109"></a><span id="l5.109" class="difflineminus">-            &lt;caption label=&quot;&amp;testpilot.settings.dataSubmission.label;&quot; /&gt;</span>
<a href="#l5.110"></a><span id="l5.110" class="difflineminus">-            &lt;checkbox label=&quot;&amp;testpilot.settings.alwaysSubmitData.shortLabel;&quot;</span>
<a href="#l5.111"></a><span id="l5.111" class="difflineminus">-                      preference=&quot;always-submit-data&quot;/&gt;</span>
<a href="#l5.112"></a><span id="l5.112" class="difflineminus">-          &lt;/groupbox&gt;</span>
<a href="#l5.113"></a><span id="l5.113" class="difflineminus">-          &lt;groupbox&gt;</span>
<a href="#l5.114"></a><span id="l5.114" class="difflineminus">-            &lt;caption label=&quot;&amp;testpilot.settings.notifications.label;&quot; /&gt;</span>
<a href="#l5.115"></a><span id="l5.115" class="difflineminus">-            &lt;label value=&quot;&amp;testpilot.settings.notifyWhen.label;&quot;/&gt;</span>
<a href="#l5.116"></a><span id="l5.116" class="difflineminus">-            &lt;hbox&gt;</span>
<a href="#l5.117"></a><span id="l5.117" class="difflineminus">-              &lt;separator orient=&quot;vertical&quot; /&gt;</span>
<a href="#l5.118"></a><span id="l5.118" class="difflineminus">-              &lt;vbox&gt;</span>
<a href="#l5.119"></a><span id="l5.119" class="difflineminus">-                &lt;checkbox label=&quot;&amp;testpilot.settings.readyToSubmit.label;&quot;</span>
<a href="#l5.120"></a><span id="l5.120" class="difflineminus">-                          preference=&quot;notify-finished&quot;/&gt;</span>
<a href="#l5.121"></a><span id="l5.121" class="difflineminus">-                &lt;checkbox label=&quot;&amp;testpilot.settings.newStudy.label;&quot;</span>
<a href="#l5.122"></a><span id="l5.122" class="difflineminus">-                          preference=&quot;notify-new&quot;/&gt;</span>
<a href="#l5.123"></a><span id="l5.123" class="difflineminus">-                &lt;checkbox label=&quot;&amp;testpilot.settings.hasNewResults.label;&quot;</span>
<a href="#l5.124"></a><span id="l5.124" class="difflineminus">-                          preference=&quot;notify-results&quot;/&gt;</span>
<a href="#l5.125"></a><span id="l5.125" class="difflineminus">-              &lt;/vbox&gt;</span>
<a href="#l5.126"></a><span id="l5.126" class="difflineminus">-            &lt;/hbox&gt;</span>
<a href="#l5.127"></a><span id="l5.127" class="difflineminus">-          &lt;/groupbox&gt;</span>
<a href="#l5.128"></a><span id="l5.128" class="difflineminus">-        &lt;/vbox&gt;</span>
<a href="#l5.129"></a><span id="l5.129" class="difflineminus">-      &lt;/prefpane&gt;</span>
<a href="#l5.130"></a><span id="l5.130" class="difflineminus">-    &lt;/deck&gt;</span>
<a href="#l5.131"></a><span id="l5.131" class="difflineminus">-  &lt;/vbox&gt;</span>
<a href="#l5.132"></a><span id="l5.132" class="difflineminus">-</span>
<a href="#l5.133"></a><span id="l5.133" class="difflineminus">-  &lt;!-- For the menubar on mac, the below elements are needed for</span>
<a href="#l5.134"></a><span id="l5.134" class="difflineminus">-       macBrowserOverlay.xul to overlay this window. --&gt;</span>
<a href="#l5.135"></a><span id="l5.135" class="difflineminus">-  &lt;stringbundleset id=&quot;stringbundleset&quot;/&gt;</span>
<a href="#l5.136"></a><span id="l5.136" class="difflineminus">-</span>
<a href="#l5.137"></a><span id="l5.137" class="difflineminus">-  &lt;commandset id=&quot;mainCommandSet&quot;/&gt;</span>
<a href="#l5.138"></a><span id="l5.138" class="difflineminus">-  &lt;commandset id=&quot;baseMenuCommandSet&quot;/&gt;</span>
<a href="#l5.139"></a><span id="l5.139" class="difflineminus">-  &lt;commandset id=&quot;placesCommands&quot;/&gt;</span>
<a href="#l5.140"></a><span id="l5.140" class="difflineminus">-</span>
<a href="#l5.141"></a><span id="l5.141" class="difflineminus">-  &lt;broadcasterset id=&quot;mainBroadcasterSet&quot;/&gt;</span>
<a href="#l5.142"></a><span id="l5.142" class="difflineminus">-</span>
<a href="#l5.143"></a><span id="l5.143" class="difflineminus">-  &lt;keyset id=&quot;mainKeyset&quot;/&gt;</span>
<a href="#l5.144"></a><span id="l5.144" class="difflineminus">-  &lt;keyset id=&quot;baseMenuKeyset&quot;/&gt;</span>
<a href="#l5.145"></a><span id="l5.145" class="difflineminus">-</span>
<a href="#l5.146"></a><span id="l5.146" class="difflineminus">-  &lt;menubar id=&quot;main-menubar&quot; style=&quot;border:none !important;margin:0;padding:0;&quot;/&gt;</span>
<a href="#l5.147"></a><span id="l5.147" class="difflineminus">-</span>
<a href="#l5.148"></a><span id="l5.148" class="difflineminus">-&lt;/prefwindow&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1">deleted file mode 100644</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/all-studies.html</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineplus">+++ /dev/null</span>
<a href="#l6.4"></a><span id="l6.4" class="difflineat">@@ -1,18 +0,0 @@</span>
<a href="#l6.5"></a><span id="l6.5" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.6"></a><span id="l6.6" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.7"></a><span id="l6.7" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l6.8"></a><span id="l6.8" class="difflineminus">-</span>
<a href="#l6.9"></a><span id="l6.9" class="difflineminus">-&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML//EN&quot;&gt;</span>
<a href="#l6.10"></a><span id="l6.10" class="difflineminus">-&lt;html&gt;</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineminus">-  &lt;head&gt;</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-    &lt;title&gt;All Test Pilot Studies&lt;/title&gt;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-    &lt;script src=&quot;chrome://testpilot/content/all-studies.js&quot;</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineminus">-             type=&quot;application/javascript;version=1.8&quot;&gt;</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineminus">-    &lt;/script&gt;</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineminus">-  &lt;/head&gt;</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineminus">-  &lt;body onload=&quot;fillAllStudiesPage();&quot;&gt;</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineminus">-    &lt;h1&gt;All Test Pilot Studies&lt;/h1&gt;</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineminus">-    &lt;p id=&quot;still-loading-msg&quot;&gt;Loading, please wait...&lt;/p&gt;</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineminus">-    &lt;table id=&quot;studies-list&quot;&gt;&lt;/table&gt;</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineminus">-  &lt;/body&gt;</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineminus">-&lt;/html&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1">deleted file mode 100644</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/all-studies.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineplus">+++ /dev/null</span>
<a href="#l7.4"></a><span id="l7.4" class="difflineat">@@ -1,70 +0,0 @@</span>
<a href="#l7.5"></a><span id="l7.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l7.6"></a><span id="l7.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l7.7"></a><span id="l7.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l7.8"></a><span id="l7.8" class="difflineminus">-</span>
<a href="#l7.9"></a><span id="l7.9" class="difflineminus">-// for the HTML version</span>
<a href="#l7.10"></a><span id="l7.10" class="difflineminus">-</span>
<a href="#l7.11"></a><span id="l7.11" class="difflineminus">-function _sortNewestFirst(experiments) {</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-    experiments.sort(</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-      function sortFunc(a, b) {</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-        if (a.endDate &amp;&amp; b.endDate) {</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineminus">-          return b.endDate - a.endDate;</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineminus">-        }</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineminus">-        if (a.publishDate &amp;&amp; b.publishDate) {</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineminus">-          if (isNaN(a.publishDate) || isNaN(b.publishDate)) {</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineminus">-            return 0;</span>
<a href="#l7.20"></a><span id="l7.20" class="difflineminus">-          }</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineminus">-          return b.publishDate - a.publishDate;</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineminus">-        }</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineminus">-        return 0;</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineminus">-      });</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineminus">-    return experiments;</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineminus">-}</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineminus">-</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineminus">-</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineminus">-function fillAllStudiesPage() {</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineminus">-  Components.utils.import(&quot;resource://testpilot/modules/Observers.js&quot;);</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineminus">-  Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineminus">-  Components.utils.import(&quot;resource://testpilot/modules/tasks.js&quot;);</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineminus">-  //this._stringBundle = document.getElementById(&quot;testpilot-stringbundle&quot;);</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineminus">-</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineminus">-</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineminus">-  // Are we done loading tasks?</span>
<a href="#l7.37"></a><span id="l7.37" class="difflineminus">-  if (!TestPilotSetup.startupComplete || TestPilotSetup.getAllTasks().length == 0) {</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineminus">-    // If you opened the window before tasks are done loading, exit now</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineminus">-    // but try again in a few seconds.</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineminus">-    window.setTimeout(fillAllStudiesPage, 2000);</span>
<a href="#l7.41"></a><span id="l7.41" class="difflineminus">-    return;</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineminus">-  }</span>
<a href="#l7.43"></a><span id="l7.43" class="difflineminus">-</span>
<a href="#l7.44"></a><span id="l7.44" class="difflineminus">-  // hide the 'loading' msg</span>
<a href="#l7.45"></a><span id="l7.45" class="difflineminus">-  window.document.getElementById(&quot;still-loading-msg&quot;).innerHTML = &quot;&quot;;</span>
<a href="#l7.46"></a><span id="l7.46" class="difflineminus">-</span>
<a href="#l7.47"></a><span id="l7.47" class="difflineminus">-  // clear the table</span>
<a href="#l7.48"></a><span id="l7.48" class="difflineminus">-  let table = window.document.getElementById(&quot;studies-list&quot;);</span>
<a href="#l7.49"></a><span id="l7.49" class="difflineminus">-  table.innerHTML = &quot;&quot;;</span>
<a href="#l7.50"></a><span id="l7.50" class="difflineminus">-</span>
<a href="#l7.51"></a><span id="l7.51" class="difflineminus">-  let experiments = _sortNewestFirst(TestPilotSetup.getAllTasks());</span>
<a href="#l7.52"></a><span id="l7.52" class="difflineminus">-</span>
<a href="#l7.53"></a><span id="l7.53" class="difflineminus">-  for (let i = 0; i &lt; experiments.length; i++) {</span>
<a href="#l7.54"></a><span id="l7.54" class="difflineminus">-    let task = experiments[i];</span>
<a href="#l7.55"></a><span id="l7.55" class="difflineminus">-    let newRow = document.createElement(&quot;tr&quot;);</span>
<a href="#l7.56"></a><span id="l7.56" class="difflineminus">-</span>
<a href="#l7.57"></a><span id="l7.57" class="difflineminus">-    let newCell = document.createElement(&quot;td&quot;);</span>
<a href="#l7.58"></a><span id="l7.58" class="difflineminus">-    newCell.textContent = task.title;</span>
<a href="#l7.59"></a><span id="l7.59" class="difflineminus">-    newRow.appendChild(newCell);</span>
<a href="#l7.60"></a><span id="l7.60" class="difflineminus">-    newCell = document.createElement(&quot;td&quot;);</span>
<a href="#l7.61"></a><span id="l7.61" class="difflineminus">-    newCell.textContent = task.summary;</span>
<a href="#l7.62"></a><span id="l7.62" class="difflineminus">-    newRow.appendChild(newCell);</span>
<a href="#l7.63"></a><span id="l7.63" class="difflineminus">-</span>
<a href="#l7.64"></a><span id="l7.64" class="difflineminus">-    let link = document.createElement(&quot;a&quot;);</span>
<a href="#l7.65"></a><span id="l7.65" class="difflineminus">-    link.setAttribute(&quot;href&quot;, task.defaultUrl);</span>
<a href="#l7.66"></a><span id="l7.66" class="difflineminus">-    link.textContent = &quot;More Info&quot;;</span>
<a href="#l7.67"></a><span id="l7.67" class="difflineminus">-</span>
<a href="#l7.68"></a><span id="l7.68" class="difflineminus">-    newCell = document.createElement(&quot;td&quot;);</span>
<a href="#l7.69"></a><span id="l7.69" class="difflineminus">-    newCell.appendChild(link);</span>
<a href="#l7.70"></a><span id="l7.70" class="difflineminus">-    newRow.appendChild(newCell);</span>
<a href="#l7.71"></a><span id="l7.71" class="difflineminus">-</span>
<a href="#l7.72"></a><span id="l7.72" class="difflineminus">-    table.appendChild(newRow);</span>
<a href="#l7.73"></a><span id="l7.73" class="difflineminus">-  }</span>
<a href="#l7.74"></a><span id="l7.74" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1">deleted file mode 100644</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/browser.css</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineplus">+++ /dev/null</span>
<a href="#l8.4"></a><span id="l8.4" class="difflineat">@@ -1,299 +0,0 @@</span>
<a href="#l8.5"></a><span id="l8.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l8.6"></a><span id="l8.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l8.7"></a><span id="l8.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l8.8"></a><span id="l8.8" class="difflineminus">-</span>
<a href="#l8.9"></a><span id="l8.9" class="difflineminus">-/* Toolbar Button */</span>
<a href="#l8.10"></a><span id="l8.10" class="difflineminus">-</span>
<a href="#l8.11"></a><span id="l8.11" class="difflineminus">-#feedback-menu-button {</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-  -moz-box-orient: horizontal;</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineminus">-}</span>
<a href="#l8.14"></a><span id="l8.14" class="difflineminus">-</span>
<a href="#l8.15"></a><span id="l8.15" class="difflineminus">-#feedback-menu-button .toolbarbutton-icon {</span>
<a href="#l8.16"></a><span id="l8.16" class="difflineminus">-  display: none;</span>
<a href="#l8.17"></a><span id="l8.17" class="difflineminus">-}</span>
<a href="#l8.18"></a><span id="l8.18" class="difflineminus">-</span>
<a href="#l8.19"></a><span id="l8.19" class="difflineminus">-#feedback-menu-button .toolbarbutton-menu-dropmarker {</span>
<a href="#l8.20"></a><span id="l8.20" class="difflineminus">-  -moz-padding-start: 5px;</span>
<a href="#l8.21"></a><span id="l8.21" class="difflineminus">-}</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineminus">-</span>
<a href="#l8.23"></a><span id="l8.23" class="difflineminus">-#pilot-notifications-button {</span>
<a href="#l8.24"></a><span id="l8.24" class="difflineminus">-  margin-right: 10px;</span>
<a href="#l8.25"></a><span id="l8.25" class="difflineminus">-}</span>
<a href="#l8.26"></a><span id="l8.26" class="difflineminus">-</span>
<a href="#l8.27"></a><span id="l8.27" class="difflineminus">-/* For Firefox 4 built-in popup notification system */</span>
<a href="#l8.28"></a><span id="l8.28" class="difflineminus">-#tp-notification-popup-icon {</span>
<a href="#l8.29"></a><span id="l8.29" class="difflineminus">-  list-style-image: url(&quot;chrome://testpilot/skin/testpilot_16x16.png&quot;);</span>
<a href="#l8.30"></a><span id="l8.30" class="difflineminus">-}</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineminus">-</span>
<a href="#l8.32"></a><span id="l8.32" class="difflineminus">-#tp-notification-popup-box[anchorid=&quot;tp-notification-popup-icon&quot;] &gt; #tp-notification-popup-icon {</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineminus">-  display: -moz-box;</span>
<a href="#l8.34"></a><span id="l8.34" class="difflineminus">-}</span>
<a href="#l8.35"></a><span id="l8.35" class="difflineminus">-</span>
<a href="#l8.36"></a><span id="l8.36" class="difflineminus">-#testpilot-notification {</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineminus">-  -moz-binding: url(&quot;chrome://testpilot/content/notificationBindings.xml#testpilot-notification&quot;);</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineminus">-}</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineminus">-</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineminus">-/* hide menu separator and &quot;not now&quot; item: */</span>
<a href="#l8.41"></a><span id="l8.41" class="difflineminus">-#testpilot-notification menuseparator { display: none }</span>
<a href="#l8.42"></a><span id="l8.42" class="difflineminus">-#testpilot-notification .popup-notification-closeitem { display: none }</span>
<a href="#l8.43"></a><span id="l8.43" class="difflineminus">-</span>
<a href="#l8.44"></a><span id="l8.44" class="difflineminus">-.testpilot-notification-title {</span>
<a href="#l8.45"></a><span id="l8.45" class="difflineminus">-    text-align: center;</span>
<a href="#l8.46"></a><span id="l8.46" class="difflineminus">-    font-size: large;</span>
<a href="#l8.47"></a><span id="l8.47" class="difflineminus">-}</span>
<a href="#l8.48"></a><span id="l8.48" class="difflineminus">-</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineminus">-/* .popup-notification-icon[popupid=&quot;study-finished&quot;] {</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineminus">-  list-style-image: url(&quot;chrome://testpilot/skin/tp-submit-48x48.png&quot;);</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineminus">-  height: 48px;</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineminus">-  width: 48px;</span>
<a href="#l8.53"></a><span id="l8.53" class="difflineminus">-}</span>
<a href="#l8.54"></a><span id="l8.54" class="difflineminus">-.popup-notification-icon[popupid=&quot;new-study&quot;] {</span>
<a href="#l8.55"></a><span id="l8.55" class="difflineminus">-  list-style-image: url(&quot;chrome://testpilot/skin/tp-study-48x48.png&quot;);</span>
<a href="#l8.56"></a><span id="l8.56" class="difflineminus">-  height: 48px;</span>
<a href="#l8.57"></a><span id="l8.57" class="difflineminus">-  width: 48px;</span>
<a href="#l8.58"></a><span id="l8.58" class="difflineminus">-}</span>
<a href="#l8.59"></a><span id="l8.59" class="difflineminus">-.popup-notification-icon[popupid=&quot;new-results&quot;] {</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineminus">-  list-style-image: url(&quot;chrome://testpilot/skin/tp-results-48x48.png&quot;);</span>
<a href="#l8.61"></a><span id="l8.61" class="difflineminus">-  height: 48px;</span>
<a href="#l8.62"></a><span id="l8.62" class="difflineminus">-  width: 48px;</span>
<a href="#l8.63"></a><span id="l8.63" class="difflineminus">-}</span>
<a href="#l8.64"></a><span id="l8.64" class="difflineminus">-.popup-notification-icon[popupid=&quot;study-submitted&quot;] {</span>
<a href="#l8.65"></a><span id="l8.65" class="difflineminus">-  list-style-image: url(&quot;chrome://testpilot/skin/status-completed.png&quot;);</span>
<a href="#l8.66"></a><span id="l8.66" class="difflineminus">-  height: 32px;</span>
<a href="#l8.67"></a><span id="l8.67" class="difflineminus">-  width: 64px;</span>
<a href="#l8.68"></a><span id="l8.68" class="difflineminus">-}*/</span>
<a href="#l8.69"></a><span id="l8.69" class="difflineminus">-</span>
<a href="#l8.70"></a><span id="l8.70" class="difflineminus">-/* For older notification system */</span>
<a href="#l8.71"></a><span id="l8.71" class="difflineminus">-</span>
<a href="#l8.72"></a><span id="l8.72" class="difflineminus">-/* Popup Bounding Box */</span>
<a href="#l8.73"></a><span id="l8.73" class="difflineminus">-#pilot-notification-popup {</span>
<a href="#l8.74"></a><span id="l8.74" class="difflineminus">-  -moz-appearance: none;</span>
<a href="#l8.75"></a><span id="l8.75" class="difflineminus">-  -moz-window-shadow: none;</span>
<a href="#l8.76"></a><span id="l8.76" class="difflineminus">-  background-color: transparent;</span>
<a href="#l8.77"></a><span id="l8.77" class="difflineminus">-  margin-top: -6px;</span>
<a href="#l8.78"></a><span id="l8.78" class="difflineminus">-  margin-right: -3px;</span>
<a href="#l8.79"></a><span id="l8.79" class="difflineminus">-  width: 480px;</span>
<a href="#l8.80"></a><span id="l8.80" class="difflineminus">-}</span>
<a href="#l8.81"></a><span id="l8.81" class="difflineminus">-</span>
<a href="#l8.82"></a><span id="l8.82" class="difflineminus">-.tail-up {</span>
<a href="#l8.83"></a><span id="l8.83" class="difflineminus">- /* Needed whilst we support Gecko &lt; 13 */</span>
<a href="#l8.84"></a><span id="l8.84" class="difflineminus">- -moz-border-image: url(chrome://testpilot-os/skin/notification-tail-up.png) 26 56 22 18 / 26px 56px 22px 18px round stretch;</span>
<a href="#l8.85"></a><span id="l8.85" class="difflineminus">- /* Supported in Gecko &gt;= 13 */</span>
<a href="#l8.86"></a><span id="l8.86" class="difflineminus">- -moz-border-image: url(chrome://testpilot-os/skin/notification-tail-up.png) 26 50 22 18 fill repeat;</span>
<a href="#l8.87"></a><span id="l8.87" class="difflineminus">- border-width: 26px 56px 22px 18px;</span>
<a href="#l8.88"></a><span id="l8.88" class="difflineminus">- border-style: solid;</span>
<a href="#l8.89"></a><span id="l8.89" class="difflineminus">-}</span>
<a href="#l8.90"></a><span id="l8.90" class="difflineminus">-</span>
<a href="#l8.91"></a><span id="l8.91" class="difflineminus">-/* tail-down uses the old styling; it doesn't look as good as the new styling,</span>
<a href="#l8.92"></a><span id="l8.92" class="difflineminus">-   but the new styling doesn't work on 3.6.</span>
<a href="#l8.93"></a><span id="l8.93" class="difflineminus">-   TODO: If someone is using 3.7.* or 4.* but is NOT on the beta channel and</span>
<a href="#l8.94"></a><span id="l8.94" class="difflineminus">-   installed Test Pilot from AMO, they should get the new styling, similar</span>
<a href="#l8.95"></a><span id="l8.95" class="difflineminus">-   to .tail-up! */</span>
<a href="#l8.96"></a><span id="l8.96" class="difflineminus">-.tail-down {</span>
<a href="#l8.97"></a><span id="l8.97" class="difflineminus">- /* Needed whilst we support Gecko &lt; 13 */</span>
<a href="#l8.98"></a><span id="l8.98" class="difflineminus">- -moz-border-image: url(chrome://testpilot/skin/notification-tail-down.png) 26 50 22 18 / 26px 50px 22px 18px repeat;</span>
<a href="#l8.99"></a><span id="l8.99" class="difflineminus">- /* Supported in Gecko &gt;= 13 */</span>
<a href="#l8.100"></a><span id="l8.100" class="difflineminus">- -moz-border-image: url(chrome://testpilot/skin/notification-tail-down.png) 26 50 22 18 fill repeat;</span>
<a href="#l8.101"></a><span id="l8.101" class="difflineminus">- border-width: 26px 56px 22px 18px;</span>
<a href="#l8.102"></a><span id="l8.102" class="difflineminus">- border-style: solid;</span>
<a href="#l8.103"></a><span id="l8.103" class="difflineminus">- color: white;</span>
<a href="#l8.104"></a><span id="l8.104" class="difflineminus">-}</span>
<a href="#l8.105"></a><span id="l8.105" class="difflineminus">-</span>
<a href="#l8.106"></a><span id="l8.106" class="difflineminus">-.pilot-notification-popup-container {</span>
<a href="#l8.107"></a><span id="l8.107" class="difflineminus">-  -moz-appearance: none;</span>
<a href="#l8.108"></a><span id="l8.108" class="difflineminus">-  margin-right: -42px;</span>
<a href="#l8.109"></a><span id="l8.109" class="difflineminus">-  padding: 0px 5px 5px 5px;</span>
<a href="#l8.110"></a><span id="l8.110" class="difflineminus">-  font-size: 14px;</span>
<a href="#l8.111"></a><span id="l8.111" class="difflineminus">-}</span>
<a href="#l8.112"></a><span id="l8.112" class="difflineminus">-</span>
<a href="#l8.113"></a><span id="l8.113" class="difflineminus">-.pilot-notification-toprow {</span>
<a href="#l8.114"></a><span id="l8.114" class="difflineminus">-  margin-bottom: 12px;</span>
<a href="#l8.115"></a><span id="l8.115" class="difflineminus">-}</span>
<a href="#l8.116"></a><span id="l8.116" class="difflineminus">-</span>
<a href="#l8.117"></a><span id="l8.117" class="difflineminus">-#pilot-notification-text,</span>
<a href="#l8.118"></a><span id="l8.118" class="difflineminus">-#pilot-notification-link {</span>
<a href="#l8.119"></a><span id="l8.119" class="difflineminus">-  margin-bottom: 5px;</span>
<a href="#l8.120"></a><span id="l8.120" class="difflineminus">-}</span>
<a href="#l8.121"></a><span id="l8.121" class="difflineminus">-</span>
<a href="#l8.122"></a><span id="l8.122" class="difflineminus">-#pilot-notification-close {</span>
<a href="#l8.123"></a><span id="l8.123" class="difflineminus">-  list-style-image: url(&quot;chrome://testpilot-os/skin/close_button.png&quot;);</span>
<a href="#l8.124"></a><span id="l8.124" class="difflineminus">-  -moz-image-region: rect(0px, 14px, 14px, 0px);</span>
<a href="#l8.125"></a><span id="l8.125" class="difflineminus">-  width: 14px;</span>
<a href="#l8.126"></a><span id="l8.126" class="difflineminus">-  height: 14px;</span>
<a href="#l8.127"></a><span id="l8.127" class="difflineminus">-}</span>
<a href="#l8.128"></a><span id="l8.128" class="difflineminus">-</span>
<a href="#l8.129"></a><span id="l8.129" class="difflineminus">-#pilot-notification-close:hover {</span>
<a href="#l8.130"></a><span id="l8.130" class="difflineminus">-  -moz-image-region: rect(0px, 28px, 14px, 14px);</span>
<a href="#l8.131"></a><span id="l8.131" class="difflineminus">-}</span>
<a href="#l8.132"></a><span id="l8.132" class="difflineminus">-</span>
<a href="#l8.133"></a><span id="l8.133" class="difflineminus">-#pilot-notification-close:hover:active {</span>
<a href="#l8.134"></a><span id="l8.134" class="difflineminus">-  -moz-image-region: rect(0px, 42px, 14px, 28px);</span>
<a href="#l8.135"></a><span id="l8.135" class="difflineminus">-}</span>
<a href="#l8.136"></a><span id="l8.136" class="difflineminus">-</span>
<a href="#l8.137"></a><span id="l8.137" class="difflineminus">-.pilot-notify-me-when[disabled=&quot;true&quot;] {</span>
<a href="#l8.138"></a><span id="l8.138" class="difflineminus">-  color: MenuText;</span>
<a href="#l8.139"></a><span id="l8.139" class="difflineminus">-}</span>
<a href="#l8.140"></a><span id="l8.140" class="difflineminus">-.pilot-title {</span>
<a href="#l8.141"></a><span id="l8.141" class="difflineminus">-  font-size: 25px;</span>
<a href="#l8.142"></a><span id="l8.142" class="difflineminus">-}</span>
<a href="#l8.143"></a><span id="l8.143" class="difflineminus">-</span>
<a href="#l8.144"></a><span id="l8.144" class="difflineminus">-image.study-finished {</span>
<a href="#l8.145"></a><span id="l8.145" class="difflineminus">-  list-style-image: url(&quot;chrome://testpilot/skin/tp-submit-48x48.png&quot;);</span>
<a href="#l8.146"></a><span id="l8.146" class="difflineminus">-  height: 48px;</span>
<a href="#l8.147"></a><span id="l8.147" class="difflineminus">-  width: 48px;</span>
<a href="#l8.148"></a><span id="l8.148" class="difflineminus">-  margin-right: 8px;</span>
<a href="#l8.149"></a><span id="l8.149" class="difflineminus">-}</span>
<a href="#l8.150"></a><span id="l8.150" class="difflineminus">-</span>
<a href="#l8.151"></a><span id="l8.151" class="difflineminus">-image.study-submitted {</span>
<a href="#l8.152"></a><span id="l8.152" class="difflineminus">-  list-style-image: url(&quot;chrome://testpilot/skin/status-completed.png&quot;);</span>
<a href="#l8.153"></a><span id="l8.153" class="difflineminus">-  height: 32px;</span>
<a href="#l8.154"></a><span id="l8.154" class="difflineminus">-  width: 64px;</span>
<a href="#l8.155"></a><span id="l8.155" class="difflineminus">-  margin-right: 8px;</span>
<a href="#l8.156"></a><span id="l8.156" class="difflineminus">-}</span>
<a href="#l8.157"></a><span id="l8.157" class="difflineminus">-</span>
<a href="#l8.158"></a><span id="l8.158" class="difflineminus">-image.study-canceled {</span>
<a href="#l8.159"></a><span id="l8.159" class="difflineminus">-  list-style-image: url(&quot;chrome://testpilot/skin/status-ejected.png&quot;);</span>
<a href="#l8.160"></a><span id="l8.160" class="difflineminus">-  height: 32px;</span>
<a href="#l8.161"></a><span id="l8.161" class="difflineminus">-  width: 64px;</span>
<a href="#l8.162"></a><span id="l8.162" class="difflineminus">-  margin-right: 8px;</span>
<a href="#l8.163"></a><span id="l8.163" class="difflineminus">-}</span>
<a href="#l8.164"></a><span id="l8.164" class="difflineminus">-</span>
<a href="#l8.165"></a><span id="l8.165" class="difflineminus">-image.study-missed {</span>
<a href="#l8.166"></a><span id="l8.166" class="difflineminus">-  list-style-image: url(&quot;chrome://testpilot/skin/status-missed.png&quot;);</span>
<a href="#l8.167"></a><span id="l8.167" class="difflineminus">-  height: 32px;</span>
<a href="#l8.168"></a><span id="l8.168" class="difflineminus">-  width: 64px;</span>
<a href="#l8.169"></a><span id="l8.169" class="difflineminus">-  margin-right: 8px;</span>
<a href="#l8.170"></a><span id="l8.170" class="difflineminus">-}</span>
<a href="#l8.171"></a><span id="l8.171" class="difflineminus">-</span>
<a href="#l8.172"></a><span id="l8.172" class="difflineminus">-image.new-study {</span>
<a href="#l8.173"></a><span id="l8.173" class="difflineminus">-  list-style-image: url(&quot;chrome://testpilot/skin/tp-study-48x48.png&quot;);</span>
<a href="#l8.174"></a><span id="l8.174" class="difflineminus">-  height: 48px;</span>
<a href="#l8.175"></a><span id="l8.175" class="difflineminus">-  width: 48px;</span>
<a href="#l8.176"></a><span id="l8.176" class="difflineminus">-  margin-right: 8px;</span>
<a href="#l8.177"></a><span id="l8.177" class="difflineminus">-}</span>
<a href="#l8.178"></a><span id="l8.178" class="difflineminus">-</span>
<a href="#l8.179"></a><span id="l8.179" class="difflineminus">-image.new-results {</span>
<a href="#l8.180"></a><span id="l8.180" class="difflineminus">-  list-style-image: url(&quot;chrome://testpilot/skin/tp-results-48x48.png&quot;);</span>
<a href="#l8.181"></a><span id="l8.181" class="difflineminus">-  height: 48px;</span>
<a href="#l8.182"></a><span id="l8.182" class="difflineminus">-  width: 48px;</span>
<a href="#l8.183"></a><span id="l8.183" class="difflineminus">-  margin-right: 8px;</span>
<a href="#l8.184"></a><span id="l8.184" class="difflineminus">-}</span>
<a href="#l8.185"></a><span id="l8.185" class="difflineminus">-</span>
<a href="#l8.186"></a><span id="l8.186" class="difflineminus">-image.update-extension {</span>
<a href="#l8.187"></a><span id="l8.187" class="difflineminus">-  list-style-image: url(&quot;chrome://testpilot/skin/testpilot_32x32.png&quot;);</span>
<a href="#l8.188"></a><span id="l8.188" class="difflineminus">-  height: 48px;</span>
<a href="#l8.189"></a><span id="l8.189" class="difflineminus">-  width: 48px;</span>
<a href="#l8.190"></a><span id="l8.190" class="difflineminus">-  margin-right: 8px;</span>
<a href="#l8.191"></a><span id="l8.191" class="difflineminus">-}</span>
<a href="#l8.192"></a><span id="l8.192" class="difflineminus">-</span>
<a href="#l8.193"></a><span id="l8.193" class="difflineminus">-image.study-result {</span>
<a href="#l8.194"></a><span id="l8.194" class="difflineminus">-  list-style-image: url(&quot;chrome://testpilot/skin/badge-default.png&quot;);</span>
<a href="#l8.195"></a><span id="l8.195" class="difflineminus">-  height: 96px;</span>
<a href="#l8.196"></a><span id="l8.196" class="difflineminus">-  width: 96px;</span>
<a href="#l8.197"></a><span id="l8.197" class="difflineminus">-  margin-right: 8px;</span>
<a href="#l8.198"></a><span id="l8.198" class="difflineminus">-}</span>
<a href="#l8.199"></a><span id="l8.199" class="difflineminus">-</span>
<a href="#l8.200"></a><span id="l8.200" class="difflineminus">-/* All studies window */</span>
<a href="#l8.201"></a><span id="l8.201" class="difflineminus">-.pilot-largetext {</span>
<a href="#l8.202"></a><span id="l8.202" class="difflineminus">-  font-size: 16px;</span>
<a href="#l8.203"></a><span id="l8.203" class="difflineminus">-}</span>
<a href="#l8.204"></a><span id="l8.204" class="difflineminus">-</span>
<a href="#l8.205"></a><span id="l8.205" class="difflineminus">-#test-pilot-all-studies-window &gt; .prefWindow-dlgbuttons {</span>
<a href="#l8.206"></a><span id="l8.206" class="difflineminus">-    display: none;</span>
<a href="#l8.207"></a><span id="l8.207" class="difflineminus">-}</span>
<a href="#l8.208"></a><span id="l8.208" class="difflineminus">-</span>
<a href="#l8.209"></a><span id="l8.209" class="difflineminus">-.paneSelector {</span>
<a href="#l8.210"></a><span id="l8.210" class="difflineminus">-    margin: 0 !important;</span>
<a href="#l8.211"></a><span id="l8.211" class="difflineminus">-}</span>
<a href="#l8.212"></a><span id="l8.212" class="difflineminus">-</span>
<a href="#l8.213"></a><span id="l8.213" class="difflineminus">-.paneSelector radio[pane=&quot;current-studies-pane-button&quot;] .paneButtonIcon {</span>
<a href="#l8.214"></a><span id="l8.214" class="difflineminus">-    list-style-image: url(&quot;chrome://testpilot/skin/tp-currentstudies-32x32.png&quot;);</span>
<a href="#l8.215"></a><span id="l8.215" class="difflineminus">-    padding-top: 3px;</span>
<a href="#l8.216"></a><span id="l8.216" class="difflineminus">-}</span>
<a href="#l8.217"></a><span id="l8.217" class="difflineminus">-.paneSelector radio[pane=&quot;finished-studies-pane-button&quot;] .paneButtonIcon {</span>
<a href="#l8.218"></a><span id="l8.218" class="difflineminus">-    list-style-image: url(&quot;chrome://testpilot/skin/tp-completedstudies-32x32.png&quot;);</span>
<a href="#l8.219"></a><span id="l8.219" class="difflineminus">-    padding-top: 3px;</span>
<a href="#l8.220"></a><span id="l8.220" class="difflineminus">-}</span>
<a href="#l8.221"></a><span id="l8.221" class="difflineminus">-.paneSelector radio[pane=&quot;study-results-pane-button&quot;] .paneButtonIcon {</span>
<a href="#l8.222"></a><span id="l8.222" class="difflineminus">-    list-style-image: url(&quot;chrome://testpilot/skin/tp-learned-32x32.png&quot;);</span>
<a href="#l8.223"></a><span id="l8.223" class="difflineminus">-    padding-top: 3px;</span>
<a href="#l8.224"></a><span id="l8.224" class="difflineminus">-}</span>
<a href="#l8.225"></a><span id="l8.225" class="difflineminus">-.paneSelector radio[pane=&quot;settings-pane-button&quot;] .paneButtonIcon {</span>
<a href="#l8.226"></a><span id="l8.226" class="difflineminus">-    list-style-image: url(&quot;chrome://testpilot/skin/tp-settings-32x32.png&quot;);</span>
<a href="#l8.227"></a><span id="l8.227" class="difflineminus">-    padding-top: 3px;</span>
<a href="#l8.228"></a><span id="l8.228" class="difflineminus">-}</span>
<a href="#l8.229"></a><span id="l8.229" class="difflineminus">-</span>
<a href="#l8.230"></a><span id="l8.230" class="difflineminus">-.pane-button-badge {</span>
<a href="#l8.231"></a><span id="l8.231" class="difflineminus">-    background-color: green;</span>
<a href="#l8.232"></a><span id="l8.232" class="difflineminus">-    color: white;</span>
<a href="#l8.233"></a><span id="l8.233" class="difflineminus">-    font-weight: bold;</span>
<a href="#l8.234"></a><span id="l8.234" class="difflineminus">-    padding: 2px;</span>
<a href="#l8.235"></a><span id="l8.235" class="difflineminus">-    border-radius: 100%;</span>
<a href="#l8.236"></a><span id="l8.236" class="difflineminus">-    margin-right: 25px;</span>
<a href="#l8.237"></a><span id="l8.237" class="difflineminus">-    margin-bottom: 13px;</span>
<a href="#l8.238"></a><span id="l8.238" class="difflineminus">-}</span>
<a href="#l8.239"></a><span id="l8.239" class="difflineminus">-</span>
<a href="#l8.240"></a><span id="l8.240" class="difflineminus">-richlistbox.tp-study-list {</span>
<a href="#l8.241"></a><span id="l8.241" class="difflineminus">-    overflow: auto;</span>
<a href="#l8.242"></a><span id="l8.242" class="difflineminus">-    margin: 0px;</span>
<a href="#l8.243"></a><span id="l8.243" class="difflineminus">-}</span>
<a href="#l8.244"></a><span id="l8.244" class="difflineminus">-</span>
<a href="#l8.245"></a><span id="l8.245" class="difflineminus">-.tp-tab-panel {</span>
<a href="#l8.246"></a><span id="l8.246" class="difflineminus">-    background-color: -moz-dialog;</span>
<a href="#l8.247"></a><span id="l8.247" class="difflineminus">-    padding: 0px;</span>
<a href="#l8.248"></a><span id="l8.248" class="difflineminus">-}</span>
<a href="#l8.249"></a><span id="l8.249" class="difflineminus">-</span>
<a href="#l8.250"></a><span id="l8.250" class="difflineminus">-description.study-description {</span>
<a href="#l8.251"></a><span id="l8.251" class="difflineminus">-    width: 350px;</span>
<a href="#l8.252"></a><span id="l8.252" class="difflineminus">-}</span>
<a href="#l8.253"></a><span id="l8.253" class="difflineminus">-</span>
<a href="#l8.254"></a><span id="l8.254" class="difflineminus">-description.study-title {</span>
<a href="#l8.255"></a><span id="l8.255" class="difflineminus">-    width: 350px;</span>
<a href="#l8.256"></a><span id="l8.256" class="difflineminus">-    font-size: 20px;</span>
<a href="#l8.257"></a><span id="l8.257" class="difflineminus">-    text-align: left;</span>
<a href="#l8.258"></a><span id="l8.258" class="difflineminus">-    margin-top: 10px;</span>
<a href="#l8.259"></a><span id="l8.259" class="difflineminus">-}</span>
<a href="#l8.260"></a><span id="l8.260" class="difflineminus">-</span>
<a href="#l8.261"></a><span id="l8.261" class="difflineminus">-richlistitem.tp-study-list {</span>
<a href="#l8.262"></a><span id="l8.262" class="difflineminus">-    min-height: 120px;</span>
<a href="#l8.263"></a><span id="l8.263" class="difflineminus">-    color: black;</span>
<a href="#l8.264"></a><span id="l8.264" class="difflineminus">-    background-color: -moz-dialog;</span>
<a href="#l8.265"></a><span id="l8.265" class="difflineminus">-}</span>
<a href="#l8.266"></a><span id="l8.266" class="difflineminus">-</span>
<a href="#l8.267"></a><span id="l8.267" class="difflineminus">-richlistitem.tp-new-results {</span>
<a href="#l8.268"></a><span id="l8.268" class="difflineminus">-    min-height: 120px;</span>
<a href="#l8.269"></a><span id="l8.269" class="difflineminus">-    color: black;</span>
<a href="#l8.270"></a><span id="l8.270" class="difflineminus">-    background-color: LemonChiffon;</span>
<a href="#l8.271"></a><span id="l8.271" class="difflineminus">-}</span>
<a href="#l8.272"></a><span id="l8.272" class="difflineminus">-</span>
<a href="#l8.273"></a><span id="l8.273" class="difflineminus">-richlistitem.tp-opted-out {</span>
<a href="#l8.274"></a><span id="l8.274" class="difflineminus">-    min-height: 120px;</span>
<a href="#l8.275"></a><span id="l8.275" class="difflineminus">-    color: grey;</span>
<a href="#l8.276"></a><span id="l8.276" class="difflineminus">-    background-color: -moz-dialog;</span>
<a href="#l8.277"></a><span id="l8.277" class="difflineminus">-}</span>
<a href="#l8.278"></a><span id="l8.278" class="difflineminus">-</span>
<a href="#l8.279"></a><span id="l8.279" class="difflineminus">-vbox.results-thumbnail {</span>
<a href="#l8.280"></a><span id="l8.280" class="difflineminus">-    height: 120px;</span>
<a href="#l8.281"></a><span id="l8.281" class="difflineminus">-    width: 120px;</span>
<a href="#l8.282"></a><span id="l8.282" class="difflineminus">-}</span>
<a href="#l8.283"></a><span id="l8.283" class="difflineminus">-</span>
<a href="#l8.284"></a><span id="l8.284" class="difflineminus">-image.results-thumbnail {</span>
<a href="#l8.285"></a><span id="l8.285" class="difflineminus">-    max-height: 90px;</span>
<a href="#l8.286"></a><span id="l8.286" class="difflineminus">-    max-width:  90px;</span>
<a href="#l8.287"></a><span id="l8.287" class="difflineminus">-    margin: 10px;</span>
<a href="#l8.288"></a><span id="l8.288" class="difflineminus">-}</span>
<a href="#l8.289"></a><span id="l8.289" class="difflineminus">-</span>
<a href="#l8.290"></a><span id="l8.290" class="difflineminus">-.notification-link {</span>
<a href="#l8.291"></a><span id="l8.291" class="difflineminus">-    text-decoration: underline;</span>
<a href="#l8.292"></a><span id="l8.292" class="difflineminus">-    cursor: pointer;</span>
<a href="#l8.293"></a><span id="l8.293" class="difflineminus">-}</span>
<a href="#l8.294"></a><span id="l8.294" class="difflineminus">-</span>
<a href="#l8.295"></a><span id="l8.295" class="difflineminus">-prefpane .groupbox-body {</span>
<a href="#l8.296"></a><span id="l8.296" class="difflineminus">-  -moz-appearance: none;</span>
<a href="#l8.297"></a><span id="l8.297" class="difflineminus">-  padding: 8px 4px 4px 4px;</span>
<a href="#l8.298"></a><span id="l8.298" class="difflineminus">-}</span>
<a href="#l8.299"></a><span id="l8.299" class="difflineminus">-</span>
<a href="#l8.300"></a><span id="l8.300" class="difflineminus">-prefpane .groupbox-title {</span>
<a href="#l8.301"></a><span id="l8.301" class="difflineminus">-  background: url(&quot;chrome://global/skin/50pct_transparent_grey.png&quot;) repeat-x bottom left;</span>
<a href="#l8.302"></a><span id="l8.302" class="difflineminus">-  margin-bottom: 4px;</span>
<a href="#l8.303"></a><span id="l8.303" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1">deleted file mode 100644</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/browser.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineplus">+++ /dev/null</span>
<a href="#l9.4"></a><span id="l9.4" class="difflineat">@@ -1,162 +0,0 @@</span>
<a href="#l9.5"></a><span id="l9.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l9.6"></a><span id="l9.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l9.7"></a><span id="l9.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l9.8"></a><span id="l9.8" class="difflineminus">-</span>
<a href="#l9.9"></a><span id="l9.9" class="difflineminus">-var TestPilotMenuUtils;</span>
<a href="#l9.10"></a><span id="l9.10" class="difflineminus">-</span>
<a href="#l9.11"></a><span id="l9.11" class="difflineminus">-(function() {</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-  var Cc = Components.classes;</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineminus">-  var Cu = Components.utils;</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineminus">-  var Ci = Components.interfaces;</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineminus">-</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineminus">-  Cu.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineminus">-</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineminus">-  TestPilotMenuUtils = {</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineminus">-    __prefs: null,</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineminus">-    get _prefs() {</span>
<a href="#l9.21"></a><span id="l9.21" class="difflineminus">-      this.__prefs = Cc[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineminus">-        .getService(Ci.nsIPrefBranch);</span>
<a href="#l9.23"></a><span id="l9.23" class="difflineminus">-      return this.__prefs;</span>
<a href="#l9.24"></a><span id="l9.24" class="difflineminus">-    },</span>
<a href="#l9.25"></a><span id="l9.25" class="difflineminus">-</span>
<a href="#l9.26"></a><span id="l9.26" class="difflineminus">-    updateSubmenu: function() {</span>
<a href="#l9.27"></a><span id="l9.27" class="difflineminus">-      let ntfyMenuFinished =</span>
<a href="#l9.28"></a><span id="l9.28" class="difflineminus">-        document.getElementById(&quot;pilot-menu-notify-finished&quot;);</span>
<a href="#l9.29"></a><span id="l9.29" class="difflineminus">-      let ntfyMenuNew = document.getElementById(&quot;pilot-menu-notify-new&quot;);</span>
<a href="#l9.30"></a><span id="l9.30" class="difflineminus">-      let ntfyMenuResults = document.getElementById(&quot;pilot-menu-notify-results&quot;);</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineminus">-      let alwaysSubmitData =</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineminus">-        document.getElementById(&quot;pilot-menu-always-submit-data&quot;);</span>
<a href="#l9.33"></a><span id="l9.33" class="difflineminus">-      ntfyMenuFinished.setAttribute(&quot;checked&quot;,</span>
<a href="#l9.34"></a><span id="l9.34" class="difflineminus">-                                    this._prefs.getBoolPref(POPUP_SHOW_ON_FINISH));</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineminus">-      ntfyMenuNew.setAttribute(&quot;checked&quot;,</span>
<a href="#l9.36"></a><span id="l9.36" class="difflineminus">-                                 this._prefs.getBoolPref(POPUP_SHOW_ON_NEW));</span>
<a href="#l9.37"></a><span id="l9.37" class="difflineminus">-      ntfyMenuResults.setAttribute(&quot;checked&quot;,</span>
<a href="#l9.38"></a><span id="l9.38" class="difflineminus">-                                   this._prefs.getBoolPref(POPUP_SHOW_ON_RESULTS));</span>
<a href="#l9.39"></a><span id="l9.39" class="difflineminus">-      alwaysSubmitData.setAttribute(&quot;checked&quot;,</span>
<a href="#l9.40"></a><span id="l9.40" class="difflineminus">-                                    this._prefs.getBoolPref(ALWAYS_SUBMIT_DATA));</span>
<a href="#l9.41"></a><span id="l9.41" class="difflineminus">-    },</span>
<a href="#l9.42"></a><span id="l9.42" class="difflineminus">-</span>
<a href="#l9.43"></a><span id="l9.43" class="difflineminus">-    togglePref: function(id) {</span>
<a href="#l9.44"></a><span id="l9.44" class="difflineminus">-      let prefName = &quot;extensions.testpilot.&quot; + id;</span>
<a href="#l9.45"></a><span id="l9.45" class="difflineminus">-      let oldVal = false;</span>
<a href="#l9.46"></a><span id="l9.46" class="difflineminus">-      if (this._prefs.prefHasUserValue(prefName)) {</span>
<a href="#l9.47"></a><span id="l9.47" class="difflineminus">-        oldVal = this._prefs.getBoolPref(prefName);</span>
<a href="#l9.48"></a><span id="l9.48" class="difflineminus">-      }</span>
<a href="#l9.49"></a><span id="l9.49" class="difflineminus">-      this._prefs.setBoolPref(prefName, !oldVal);</span>
<a href="#l9.50"></a><span id="l9.50" class="difflineminus">-</span>
<a href="#l9.51"></a><span id="l9.51" class="difflineminus">-      // If you turn on or off the global pref, startup or shutdown test pilot</span>
<a href="#l9.52"></a><span id="l9.52" class="difflineminus">-      // accordingly:</span>
<a href="#l9.53"></a><span id="l9.53" class="difflineminus">-      if (prefName == RUN_AT_ALL_PREF) {</span>
<a href="#l9.54"></a><span id="l9.54" class="difflineminus">-        if (oldVal == true) {</span>
<a href="#l9.55"></a><span id="l9.55" class="difflineminus">-          TestPilotSetup.globalShutdown();</span>
<a href="#l9.56"></a><span id="l9.56" class="difflineminus">-        }</span>
<a href="#l9.57"></a><span id="l9.57" class="difflineminus">-        if (oldVal == false) {</span>
<a href="#l9.58"></a><span id="l9.58" class="difflineminus">-          TestPilotSetup.globalStartup();</span>
<a href="#l9.59"></a><span id="l9.59" class="difflineminus">-        }</span>
<a href="#l9.60"></a><span id="l9.60" class="difflineminus">-      }</span>
<a href="#l9.61"></a><span id="l9.61" class="difflineminus">-    },</span>
<a href="#l9.62"></a><span id="l9.62" class="difflineminus">-</span>
<a href="#l9.63"></a><span id="l9.63" class="difflineminus">-    onPopupShowing: function(event) {</span>
<a href="#l9.64"></a><span id="l9.64" class="difflineminus">-      this._setMenuLabels();</span>
<a href="#l9.65"></a><span id="l9.65" class="difflineminus">-    },</span>
<a href="#l9.66"></a><span id="l9.66" class="difflineminus">-</span>
<a href="#l9.67"></a><span id="l9.67" class="difflineminus">-    onPopupHiding: function(event) {</span>
<a href="#l9.68"></a><span id="l9.68" class="difflineminus">-      let target = event.target;</span>
<a href="#l9.69"></a><span id="l9.69" class="difflineminus">-      if (target.id == &quot;pilot-menu-popup&quot;) {</span>
<a href="#l9.70"></a><span id="l9.70" class="difflineminus">-        let menu = document.getElementById(&quot;pilot-menu&quot;);</span>
<a href="#l9.71"></a><span id="l9.71" class="difflineminus">-        if (target.parentNode != menu) {</span>
<a href="#l9.72"></a><span id="l9.72" class="difflineminus">-          menu.appendChild(target);</span>
<a href="#l9.73"></a><span id="l9.73" class="difflineminus">-        }</span>
<a href="#l9.74"></a><span id="l9.74" class="difflineminus">-      }</span>
<a href="#l9.75"></a><span id="l9.75" class="difflineminus">-    },</span>
<a href="#l9.76"></a><span id="l9.76" class="difflineminus">-</span>
<a href="#l9.77"></a><span id="l9.77" class="difflineminus">-    _setMenuLabels: function() {</span>
<a href="#l9.78"></a><span id="l9.78" class="difflineminus">-      // Make the enable/disable User Studies menu item show the right label</span>
<a href="#l9.79"></a><span id="l9.79" class="difflineminus">-      // for the current status...</span>
<a href="#l9.80"></a><span id="l9.80" class="difflineminus">-      let runStudiesToggle = document.getElementById(&quot;feedback-menu-enable-studies&quot;);</span>
<a href="#l9.81"></a><span id="l9.81" class="difflineminus">-      if (runStudiesToggle) {</span>
<a href="#l9.82"></a><span id="l9.82" class="difflineminus">-        let currSetting = this._prefs.getBoolPref(RUN_AT_ALL_PREF);</span>
<a href="#l9.83"></a><span id="l9.83" class="difflineminus">-</span>
<a href="#l9.84"></a><span id="l9.84" class="difflineminus">-        let stringBundle = Cc[&quot;@mozilla.org/intl/stringbundle;1&quot;].</span>
<a href="#l9.85"></a><span id="l9.85" class="difflineminus">-          getService(Ci.nsIStringBundleService).</span>
<a href="#l9.86"></a><span id="l9.86" class="difflineminus">-          createBundle(&quot;chrome://testpilot/locale/main.properties&quot;);</span>
<a href="#l9.87"></a><span id="l9.87" class="difflineminus">-</span>
<a href="#l9.88"></a><span id="l9.88" class="difflineminus">-        if (currSetting) {</span>
<a href="#l9.89"></a><span id="l9.89" class="difflineminus">-          runStudiesToggle.setAttribute(&quot;label&quot;,</span>
<a href="#l9.90"></a><span id="l9.90" class="difflineminus">-            stringBundle.GetStringFromName(&quot;testpilot.turnOff&quot;));</span>
<a href="#l9.91"></a><span id="l9.91" class="difflineminus">-        } else {</span>
<a href="#l9.92"></a><span id="l9.92" class="difflineminus">-          runStudiesToggle.setAttribute(&quot;label&quot;,</span>
<a href="#l9.93"></a><span id="l9.93" class="difflineminus">-            stringBundle.GetStringFromName(&quot;testpilot.turnOn&quot;));</span>
<a href="#l9.94"></a><span id="l9.94" class="difflineminus">-        }</span>
<a href="#l9.95"></a><span id="l9.95" class="difflineminus">-      }</span>
<a href="#l9.96"></a><span id="l9.96" class="difflineminus">-</span>
<a href="#l9.97"></a><span id="l9.97" class="difflineminus">-      let studiesMenuItem = document.getElementById(&quot;feedback-menu-show-studies&quot;);</span>
<a href="#l9.98"></a><span id="l9.98" class="difflineminus">-      studiesMenuItem.setAttribute(&quot;disabled&quot;,</span>
<a href="#l9.99"></a><span id="l9.99" class="difflineminus">-                                   !this._prefs.getBoolPref(RUN_AT_ALL_PREF));</span>
<a href="#l9.100"></a><span id="l9.100" class="difflineminus">-    },</span>
<a href="#l9.101"></a><span id="l9.101" class="difflineminus">-</span>
<a href="#l9.102"></a><span id="l9.102" class="difflineminus">-    onMenuButtonMouseDown: function(attachPointId) {</span>
<a href="#l9.103"></a><span id="l9.103" class="difflineminus">-      if (!attachPointId) {</span>
<a href="#l9.104"></a><span id="l9.104" class="difflineminus">-        attachPointId = &quot;pilot-notifications-button&quot;;</span>
<a href="#l9.105"></a><span id="l9.105" class="difflineminus">-      }</span>
<a href="#l9.106"></a><span id="l9.106" class="difflineminus">-      let menuPopup = document.getElementById(&quot;pilot-menu-popup&quot;);</span>
<a href="#l9.107"></a><span id="l9.107" class="difflineminus">-      let menuButton = document.getElementById(attachPointId);</span>
<a href="#l9.108"></a><span id="l9.108" class="difflineminus">-</span>
<a href="#l9.109"></a><span id="l9.109" class="difflineminus">-      // TODO failing here with &quot;menuPopup is null&quot; for Tracy</span>
<a href="#l9.110"></a><span id="l9.110" class="difflineminus">-      if (menuPopup.parentNode != menuButton)</span>
<a href="#l9.111"></a><span id="l9.111" class="difflineminus">-        menuButton.appendChild(menuPopup);</span>
<a href="#l9.112"></a><span id="l9.112" class="difflineminus">-</span>
<a href="#l9.113"></a><span id="l9.113" class="difflineminus">-      let alignment;</span>
<a href="#l9.114"></a><span id="l9.114" class="difflineminus">-      // Menu should appear above status bar icon, but below Feedback button</span>
<a href="#l9.115"></a><span id="l9.115" class="difflineminus">-      if (attachPointId == &quot;pilot-notifications-button&quot;) {</span>
<a href="#l9.116"></a><span id="l9.116" class="difflineminus">-        alignment = &quot;before_start&quot;;</span>
<a href="#l9.117"></a><span id="l9.117" class="difflineminus">-      } else {</span>
<a href="#l9.118"></a><span id="l9.118" class="difflineminus">-        alignment = &quot;after_end&quot;;</span>
<a href="#l9.119"></a><span id="l9.119" class="difflineminus">-      }</span>
<a href="#l9.120"></a><span id="l9.120" class="difflineminus">-</span>
<a href="#l9.121"></a><span id="l9.121" class="difflineminus">-      menuPopup.openPopup(menuButton, alignment, 0, 0, true);</span>
<a href="#l9.122"></a><span id="l9.122" class="difflineminus">-    }</span>
<a href="#l9.123"></a><span id="l9.123" class="difflineminus">-  };</span>
<a href="#l9.124"></a><span id="l9.124" class="difflineminus">-</span>
<a href="#l9.125"></a><span id="l9.125" class="difflineminus">-</span>
<a href="#l9.126"></a><span id="l9.126" class="difflineminus">-  var TestPilotWindowHandlers = {</span>
<a href="#l9.127"></a><span id="l9.127" class="difflineminus">-    initialized: false,</span>
<a href="#l9.128"></a><span id="l9.128" class="difflineminus">-    onWindowLoad: function() {</span>
<a href="#l9.129"></a><span id="l9.129" class="difflineminus">-      try {</span>
<a href="#l9.130"></a><span id="l9.130" class="difflineminus">-      // Customize the interface of the newly opened window.</span>
<a href="#l9.131"></a><span id="l9.131" class="difflineminus">-      Cu.import(&quot;resource://testpilot/modules/interface.js&quot;);</span>
<a href="#l9.132"></a><span id="l9.132" class="difflineminus">-      TestPilotUIBuilder.buildCorrectInterface(window);</span>
<a href="#l9.133"></a><span id="l9.133" class="difflineminus">-</span>
<a href="#l9.134"></a><span id="l9.134" class="difflineminus">-      /* &quot;Hold&quot; window load events for TestPilotSetup, passing them along only</span>
<a href="#l9.135"></a><span id="l9.135" class="difflineminus">-       * after startup is complete.  It's hacky, but the benefit is that</span>
<a href="#l9.136"></a><span id="l9.136" class="difflineminus">-       * TestPilotSetup.onWindowLoad can treat all windows the same no matter</span>
<a href="#l9.137"></a><span id="l9.137" class="difflineminus">-       * whether they opened with Firefox on startup or were opened later. */</span>
<a href="#l9.138"></a><span id="l9.138" class="difflineminus">-</span>
<a href="#l9.139"></a><span id="l9.139" class="difflineminus">-      if ((&quot;TestPilotSetup&quot; in window) &amp;&amp; TestPilotSetup.startupComplete) {</span>
<a href="#l9.140"></a><span id="l9.140" class="difflineminus">-        TestPilotSetup.onWindowLoad(window);</span>
<a href="#l9.141"></a><span id="l9.141" class="difflineminus">-      } else {</span>
<a href="#l9.142"></a><span id="l9.142" class="difflineminus">-        let observerSvc = Cc[&quot;@mozilla.org/observer-service;1&quot;]</span>
<a href="#l9.143"></a><span id="l9.143" class="difflineminus">-                             .getService(Ci.nsIObserverService);</span>
<a href="#l9.144"></a><span id="l9.144" class="difflineminus">-        let observer = {</span>
<a href="#l9.145"></a><span id="l9.145" class="difflineminus">-          observe: function(subject, topic, data) {</span>
<a href="#l9.146"></a><span id="l9.146" class="difflineminus">-            observerSvc.removeObserver(this, &quot;testpilot:startup:complete&quot;);</span>
<a href="#l9.147"></a><span id="l9.147" class="difflineminus">-            TestPilotSetup.onWindowLoad(window);</span>
<a href="#l9.148"></a><span id="l9.148" class="difflineminus">-          }</span>
<a href="#l9.149"></a><span id="l9.149" class="difflineminus">-        };</span>
<a href="#l9.150"></a><span id="l9.150" class="difflineminus">-        observerSvc.addObserver(observer, &quot;testpilot:startup:complete&quot;, false);</span>
<a href="#l9.151"></a><span id="l9.151" class="difflineminus">-      }</span>
<a href="#l9.152"></a><span id="l9.152" class="difflineminus">-</span>
<a href="#l9.153"></a><span id="l9.153" class="difflineminus">-      } catch (e) {</span>
<a href="#l9.154"></a><span id="l9.154" class="difflineminus">-        Cu.reportError(e);</span>
<a href="#l9.155"></a><span id="l9.155" class="difflineminus">-      }</span>
<a href="#l9.156"></a><span id="l9.156" class="difflineminus">-    },</span>
<a href="#l9.157"></a><span id="l9.157" class="difflineminus">-</span>
<a href="#l9.158"></a><span id="l9.158" class="difflineminus">-    onWindowUnload: function() {</span>
<a href="#l9.159"></a><span id="l9.159" class="difflineminus">-      TestPilotSetup.onWindowUnload(window);</span>
<a href="#l9.160"></a><span id="l9.160" class="difflineminus">-    }</span>
<a href="#l9.161"></a><span id="l9.161" class="difflineminus">-  };</span>
<a href="#l9.162"></a><span id="l9.162" class="difflineminus">-</span>
<a href="#l9.163"></a><span id="l9.163" class="difflineminus">-  window.addEventListener(&quot;load&quot;, TestPilotWindowHandlers.onWindowLoad, false);</span>
<a href="#l9.164"></a><span id="l9.164" class="difflineminus">-  window.addEventListener(&quot;unload&quot;, TestPilotWindowHandlers.onWindowUnload, false);</span>
<a href="#l9.165"></a><span id="l9.165" class="difflineminus">-}());</span>
<a href="#l9.166"></a><span id="l9.166" class="difflineminus">-</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1">deleted file mode 100644</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/browser.xul</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineplus">+++ /dev/null</span>
<a href="#l10.4"></a><span id="l10.4" class="difflineat">@@ -1,27 +0,0 @@</span>
<a href="#l10.5"></a><span id="l10.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l10.6"></a><span id="l10.6" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l10.7"></a><span id="l10.7" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l10.8"></a><span id="l10.8" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l10.9"></a><span id="l10.9" class="difflineminus">-</span>
<a href="#l10.10"></a><span id="l10.10" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://testpilot/content/browser.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l10.11"></a><span id="l10.11" class="difflineminus">-</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-&lt;!DOCTYPE overlay [</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineminus">-  &lt;!ENTITY % testpilotDTD SYSTEM &quot;chrome://testpilot/locale/main.dtd&quot;&gt;</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineminus">-    %testpilotDTD;</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineminus">-]&gt;</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineminus">-</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineminus">-&lt;overlay xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l10.18"></a><span id="l10.18" class="difflineminus">-&lt;script src=&quot;chrome://testpilot/content/browser.js&quot;</span>
<a href="#l10.19"></a><span id="l10.19" class="difflineminus">-  type=&quot;application/x-javascript&quot; /&gt;</span>
<a href="#l10.20"></a><span id="l10.20" class="difflineminus">-&lt;script src=&quot;chrome://testpilot/content/window-utils.js&quot;</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineminus">-  type=&quot;application/x-javascript&quot; /&gt;</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineminus">-</span>
<a href="#l10.23"></a><span id="l10.23" class="difflineminus">-&lt;toolbarpalette id=&quot;MailToolbarPalette&quot;&gt;</span>
<a href="#l10.24"></a><span id="l10.24" class="difflineminus">-  &lt;toolbarbutton id=&quot;feedback-menu-button&quot;</span>
<a href="#l10.25"></a><span id="l10.25" class="difflineminus">-    type=&quot;menu&quot; class=&quot;toolbarbutton-1&quot; label=&quot;&amp;testpilot.feedbackbutton.label;&quot;</span>
<a href="#l10.26"></a><span id="l10.26" class="difflineminus">-    onmousedown=&quot;event.preventDefault();</span>
<a href="#l10.27"></a><span id="l10.27" class="difflineminus">-    TestPilotMenuUtils.onMenuButtonMouseDown('feedback-menu-button');&quot;/&gt;</span>
<a href="#l10.28"></a><span id="l10.28" class="difflineminus">-</span>
<a href="#l10.29"></a><span id="l10.29" class="difflineminus">-&lt;/toolbarpalette&gt;</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineminus">-</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineminus">-&lt;/overlay&gt;</span>
<a href="#l10.32"></a><span id="l10.32">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1">deleted file mode 100644</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/debug.html</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineplus">+++ /dev/null</span>
<a href="#l11.4"></a><span id="l11.4" class="difflineat">@@ -1,303 +0,0 @@</span>
<a href="#l11.5"></a><span id="l11.5" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l11.6"></a><span id="l11.6" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l11.7"></a><span id="l11.7" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l11.8"></a><span id="l11.8" class="difflineminus">-</span>
<a href="#l11.9"></a><span id="l11.9" class="difflineminus">-&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML//EN&quot;&gt;</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineminus">-&lt;html&gt; &lt;head&gt;</span>
<a href="#l11.11"></a><span id="l11.11" class="difflineminus">-&lt;title&gt;Test Pilot Debug Page&lt;/title&gt;</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-&lt;script src=&quot;experiment-page.js&quot; type=&quot;application/javascript;version=1.8&quot;&gt;&lt;/script&gt;</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-&lt;script type=&quot;application/javascript;version=1.8&quot;&gt;</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineminus">-</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineminus">-  function getEid() {</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineminus">-    var selector = document.getElementById(&quot;task-selector&quot;);</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineminus">-    var i = selector.selectedIndex;</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineminus">-    return selector.options[i].getAttribute(&quot;value&quot;);</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineminus">-  }</span>
<a href="#l11.20"></a><span id="l11.20" class="difflineminus">-</span>
<a href="#l11.21"></a><span id="l11.21" class="difflineminus">-  function setTaskStatus() {</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l11.23"></a><span id="l11.23" class="difflineminus">-    var newStatus = document.getElementById(&quot;status-code&quot;).value;</span>
<a href="#l11.24"></a><span id="l11.24" class="difflineminus">-    newStatus = parseInt(newStatus);</span>
<a href="#l11.25"></a><span id="l11.25" class="difflineminus">-    var task = TestPilotSetup.getTaskById(getEid());</span>
<a href="#l11.26"></a><span id="l11.26" class="difflineminus">-    task.changeStatus(newStatus, false);</span>
<a href="#l11.27"></a><span id="l11.27" class="difflineminus">-  }</span>
<a href="#l11.28"></a><span id="l11.28" class="difflineminus">-</span>
<a href="#l11.29"></a><span id="l11.29" class="difflineminus">-  function reloadAllExperiments() {</span>
<a href="#l11.30"></a><span id="l11.30" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineminus">-    TestPilotSetup.reloadRemoteExperiments(function(success) {</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineminus">-      let errors = TestPilotSetup._remoteExperimentLoader.getLoadErrors();</span>
<a href="#l11.33"></a><span id="l11.33" class="difflineminus">-      let str;</span>
<a href="#l11.34"></a><span id="l11.34" class="difflineminus">-      if (errors.length &gt; 0) {</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineminus">-        str = &quot;&lt;ul&gt;&quot;;</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineminus">-        for each (let errStr in errors) {</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineminus">-          str += &quot;&lt;li&gt;&quot; + errStr + &quot;&lt;/li&gt;&quot;;          </span>
<a href="#l11.38"></a><span id="l11.38" class="difflineminus">-        }</span>
<a href="#l11.39"></a><span id="l11.39" class="difflineminus">-        str += &quot;&lt;/ul&gt;&quot;;</span>
<a href="#l11.40"></a><span id="l11.40" class="difflineminus">-      } else {</span>
<a href="#l11.41"></a><span id="l11.41" class="difflineminus">-        str = &quot;All experiments reloaded, no errors.&quot;;</span>
<a href="#l11.42"></a><span id="l11.42" class="difflineminus">-      }</span>
<a href="#l11.43"></a><span id="l11.43" class="difflineminus">-      document.getElementById(&quot;debug&quot;).innerHTML = str;</span>
<a href="#l11.44"></a><span id="l11.44" class="difflineminus">-    });</span>
<a href="#l11.45"></a><span id="l11.45" class="difflineminus">-  }</span>
<a href="#l11.46"></a><span id="l11.46" class="difflineminus">-</span>
<a href="#l11.47"></a><span id="l11.47" class="difflineminus">-  function runUnitTests() {</span>
<a href="#l11.48"></a><span id="l11.48" class="difflineminus">-   Components.utils.import(&quot;resource://testpilot/tests/test_data_store.js&quot;);</span>
<a href="#l11.49"></a><span id="l11.49" class="difflineminus">-   runAllTests();</span>
<a href="#l11.50"></a><span id="l11.50" class="difflineminus">-  }</span>
<a href="#l11.51"></a><span id="l11.51" class="difflineminus">-</span>
<a href="#l11.52"></a><span id="l11.52" class="difflineminus">-  function testJarStore() {</span>
<a href="#l11.53"></a><span id="l11.53" class="difflineminus">-    var Cuddlefish = {};</span>
<a href="#l11.54"></a><span id="l11.54" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/lib/cuddlefish.js&quot;,</span>
<a href="#l11.55"></a><span id="l11.55" class="difflineminus">-                        Cuddlefish);</span>
<a href="#l11.56"></a><span id="l11.56" class="difflineminus">-    var loader = new Cuddlefish.Loader(</span>
<a href="#l11.57"></a><span id="l11.57" class="difflineminus">-      {rootPaths: [&quot;resource://testpilot/modules/&quot;,</span>
<a href="#l11.58"></a><span id="l11.58" class="difflineminus">-                   &quot;resource://testpilot/modules/lib/&quot;]});</span>
<a href="#l11.59"></a><span id="l11.59" class="difflineminus">-    var jarStoreModule = loader.require(&quot;jar-code-store&quot;);</span>
<a href="#l11.60"></a><span id="l11.60" class="difflineminus">-    var SecurableModule = loader.require(&quot;securable-module&quot;);</span>
<a href="#l11.61"></a><span id="l11.61" class="difflineminus">-    var jarStore = new jarStoreModule.JarStore();</span>
<a href="#l11.62"></a><span id="l11.62" class="difflineminus">-</span>
<a href="#l11.63"></a><span id="l11.63" class="difflineminus">-    // OK now watch this!  It's gonna be awesome!</span>
<a href="#l11.64"></a><span id="l11.64" class="difflineminus">-    var clientLoader = Cuddlefish.Loader(</span>
<a href="#l11.65"></a><span id="l11.65" class="difflineminus">-      {fs: new SecurableModule.CompositeFileSystem(</span>
<a href="#l11.66"></a><span id="l11.66" class="difflineminus">-         [jarStore, loader.fs])});</span>
<a href="#l11.67"></a><span id="l11.67" class="difflineminus">-    dump(&quot;Debug page Requiring toolbar study.\n&quot;);</span>
<a href="#l11.68"></a><span id="l11.68" class="difflineminus">-    var toolbarStudy = clientLoader.require(&quot;toolbar-study&quot;);</span>
<a href="#l11.69"></a><span id="l11.69" class="difflineminus">-    </span>
<a href="#l11.70"></a><span id="l11.70" class="difflineminus">-  }</span>
<a href="#l11.71"></a><span id="l11.71" class="difflineminus">-</span>
<a href="#l11.72"></a><span id="l11.72" class="difflineminus">-  function remindMe() {</span>
<a href="#l11.73"></a><span id="l11.73" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l11.74"></a><span id="l11.74" class="difflineminus">-    TestPilotSetup._notifyUserOfTasks();</span>
<a href="#l11.75"></a><span id="l11.75" class="difflineminus">-    //TestPilotSetup._doHousekeeping();</span>
<a href="#l11.76"></a><span id="l11.76" class="difflineminus">-  }</span>
<a href="#l11.77"></a><span id="l11.77" class="difflineminus">-</span>
<a href="#l11.78"></a><span id="l11.78" class="difflineminus">-  function getCodeStorage() {</span>
<a href="#l11.79"></a><span id="l11.79" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l11.80"></a><span id="l11.80" class="difflineminus">-    var loader = TestPilotSetup._remoteExperimentLoader;</span>
<a href="#l11.81"></a><span id="l11.81" class="difflineminus">-    return loader._jarStore;</span>
<a href="#l11.82"></a><span id="l11.82" class="difflineminus">-  }</span>
<a href="#l11.83"></a><span id="l11.83" class="difflineminus">-</span>
<a href="#l11.84"></a><span id="l11.84" class="difflineminus">-  function getSelectedFilename() {</span>
<a href="#l11.85"></a><span id="l11.85" class="difflineminus">-    var selector = document.getElementById(&quot;file-selector&quot;);</span>
<a href="#l11.86"></a><span id="l11.86" class="difflineminus">-    var i = selector.selectedIndex;</span>
<a href="#l11.87"></a><span id="l11.87" class="difflineminus">-    return selector.options[i].text;</span>
<a href="#l11.88"></a><span id="l11.88" class="difflineminus">-  }</span>
<a href="#l11.89"></a><span id="l11.89" class="difflineminus">-</span>
<a href="#l11.90"></a><span id="l11.90" class="difflineminus">-  function loadExperimentCode() {</span>
<a href="#l11.91"></a><span id="l11.91" class="difflineminus">-    var filename = getSelectedFilename();</span>
<a href="#l11.92"></a><span id="l11.92" class="difflineminus">-    var codeStore = getCodeStorage();</span>
<a href="#l11.93"></a><span id="l11.93" class="difflineminus">-    var textArea = document.getElementById(&quot;experiment-code-area&quot;);</span>
<a href="#l11.94"></a><span id="l11.94" class="difflineminus">-    var path = codeStore.resolveModule(null, filename);</span>
<a href="#l11.95"></a><span id="l11.95" class="difflineminus">-    code = codeStore.getFile(path).contents;</span>
<a href="#l11.96"></a><span id="l11.96" class="difflineminus">-    textArea.value = code;</span>
<a href="#l11.97"></a><span id="l11.97" class="difflineminus">-  }</span>
<a href="#l11.98"></a><span id="l11.98" class="difflineminus">-</span>
<a href="#l11.99"></a><span id="l11.99" class="difflineminus">-  function saveAndRun() {</span>
<a href="#l11.100"></a><span id="l11.100" class="difflineminus">-    var filename = getSelectedFilename();</span>
<a href="#l11.101"></a><span id="l11.101" class="difflineminus">-    var codeStore = getCodeStorage();</span>
<a href="#l11.102"></a><span id="l11.102" class="difflineminus">-    var path = codeStore.resolveModule(null, filename);</span>
<a href="#l11.103"></a><span id="l11.103" class="difflineminus">-    var textArea = document.getElementById(&quot;experiment-code-area&quot;);</span>
<a href="#l11.104"></a><span id="l11.104" class="difflineminus">-    codeStore.setLocalOverride(path, textArea.value);</span>
<a href="#l11.105"></a><span id="l11.105" class="difflineminus">-    reloadAllExperiments();</span>
<a href="#l11.106"></a><span id="l11.106" class="difflineminus">-  }</span>
<a href="#l11.107"></a><span id="l11.107" class="difflineminus">-</span>
<a href="#l11.108"></a><span id="l11.108" class="difflineminus">-  function showMetaData() {</span>
<a href="#l11.109"></a><span id="l11.109" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l11.110"></a><span id="l11.110" class="difflineminus">-    let task = TestPilotSetup.getTaskById(getEid());</span>
<a href="#l11.111"></a><span id="l11.111" class="difflineminus">-    let json = task._prependMetadataToJSON(function(json) {</span>
<a href="#l11.112"></a><span id="l11.112" class="difflineminus">-      document.getElementById(&quot;debug&quot;).innerHTML = json;</span>
<a href="#l11.113"></a><span id="l11.113" class="difflineminus">-    });</span>
<a href="#l11.114"></a><span id="l11.114" class="difflineminus">-  }</span>
<a href="#l11.115"></a><span id="l11.115" class="difflineminus">-</span>
<a href="#l11.116"></a><span id="l11.116" class="difflineminus">-  function makeThereBeAPopup() {</span>
<a href="#l11.117"></a><span id="l11.117" class="difflineminus">-    document.getElementById(&quot;debug&quot;).innerHTML = &quot;Making popup...&quot;;</span>
<a href="#l11.118"></a><span id="l11.118" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/interface.js&quot;);</span>
<a href="#l11.119"></a><span id="l11.119" class="difflineminus">-    var notifier = TestPilotUIBuilder.getNotificationManager();</span>
<a href="#l11.120"></a><span id="l11.120" class="difflineminus">-    document.getElementById(&quot;debug&quot;).innerHTML = &quot;Got Notfn Manager&quot;;</span>
<a href="#l11.121"></a><span id="l11.121" class="difflineminus">-    var wm = Components.classes[&quot;@mozilla.org/appshell/window-mediator;1&quot;].</span>
<a href="#l11.122"></a><span id="l11.122" class="difflineminus">-               getService(Components.interfaces.nsIWindowMediator);</span>
<a href="#l11.123"></a><span id="l11.123" class="difflineminus">-    var window = wm.getMostRecentWindow(&quot;navigator:browser&quot;) ||</span>
<a href="#l11.124"></a><span id="l11.124" class="difflineminus">-                 wm.getMostRecentWindow(&quot;mail:3pane&quot;);</span>
<a href="#l11.125"></a><span id="l11.125" class="difflineminus">-    document.getElementById(&quot;debug&quot;).innerHTML = &quot;Got Window.&quot;;</span>
<a href="#l11.126"></a><span id="l11.126" class="difflineminus">-    try {</span>
<a href="#l11.127"></a><span id="l11.127" class="difflineminus">-    notifier.showNotification(window, { title: &quot;This is title&quot;,</span>
<a href="#l11.128"></a><span id="l11.128" class="difflineminus">-                                        text: &quot;This is text&quot;,</span>
<a href="#l11.129"></a><span id="l11.129" class="difflineminus">-                                        iconClass: &quot;study-submitted&quot;,</span>
<a href="#l11.130"></a><span id="l11.130" class="difflineminus">-                                        moreInfoLabel: &quot;This is a link&quot;,</span>
<a href="#l11.131"></a><span id="l11.131" class="difflineminus">-                                        moreInfoCallback: function() {dump(&quot;You picked More Info\n&quot;);},</span>
<a href="#l11.132"></a><span id="l11.132" class="difflineminus">-                                        closeCallback: function() {dump(&quot;You closed the notfn\n&quot;);},</span>
<a href="#l11.133"></a><span id="l11.133" class="difflineminus">-                                        fragile: true</span>
<a href="#l11.134"></a><span id="l11.134" class="difflineminus">-     });</span>
<a href="#l11.135"></a><span id="l11.135" class="difflineminus">-    } catch(e) {</span>
<a href="#l11.136"></a><span id="l11.136" class="difflineminus">-      document.getElementById(&quot;debug&quot;).innerHTML = &quot;Error: &quot; + e;</span>
<a href="#l11.137"></a><span id="l11.137" class="difflineminus">-    }</span>
<a href="#l11.138"></a><span id="l11.138" class="difflineminus">-  }</span>
<a href="#l11.139"></a><span id="l11.139" class="difflineminus">-</span>
<a href="#l11.140"></a><span id="l11.140" class="difflineminus">-  function wipeDb() {</span>
<a href="#l11.141"></a><span id="l11.141" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l11.142"></a><span id="l11.142" class="difflineminus">-    var task = TestPilotSetup.getTaskById(getEid());</span>
<a href="#l11.143"></a><span id="l11.143" class="difflineminus">-    task.dataStore.wipeAllData();</span>
<a href="#l11.144"></a><span id="l11.144" class="difflineminus">-    var debug = document.getElementById(&quot;debug&quot;);</span>
<a href="#l11.145"></a><span id="l11.145" class="difflineminus">-    debug.innerHTML = &quot;Wiped!&quot;;</span>
<a href="#l11.146"></a><span id="l11.146" class="difflineminus">-  }</span>
<a href="#l11.147"></a><span id="l11.147" class="difflineminus">-</span>
<a href="#l11.148"></a><span id="l11.148" class="difflineminus">-  function nukeDb() {</span>
<a href="#l11.149"></a><span id="l11.149" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l11.150"></a><span id="l11.150" class="difflineminus">-    var task = TestPilotSetup.getTaskById(getEid());</span>
<a href="#l11.151"></a><span id="l11.151" class="difflineminus">-    task.dataStore.nukeTable();</span>
<a href="#l11.152"></a><span id="l11.152" class="difflineminus">-    var debug = document.getElementById(&quot;debug&quot;);</span>
<a href="#l11.153"></a><span id="l11.153" class="difflineminus">-    debug.innerHTML = &quot;Nuked!&quot;;</span>
<a href="#l11.154"></a><span id="l11.154" class="difflineminus">-  }</span>
<a href="#l11.155"></a><span id="l11.155" class="difflineminus">-</span>
<a href="#l11.156"></a><span id="l11.156" class="difflineminus">-  function populateFileDropdown() {</span>
<a href="#l11.157"></a><span id="l11.157" class="difflineminus">-    var codeStore = getCodeStorage();</span>
<a href="#l11.158"></a><span id="l11.158" class="difflineminus">-    var files = codeStore.listAllFiles();</span>
<a href="#l11.159"></a><span id="l11.159" class="difflineminus">-    var selector = document.getElementById(&quot;file-selector&quot;);</span>
<a href="#l11.160"></a><span id="l11.160" class="difflineminus">-    var opt, i;</span>
<a href="#l11.161"></a><span id="l11.161" class="difflineminus">-    for (var i = 0; i &lt; files.length; i++) {</span>
<a href="#l11.162"></a><span id="l11.162" class="difflineminus">-      opt = document.createElement(&quot;option&quot;);</span>
<a href="#l11.163"></a><span id="l11.163" class="difflineminus">-      opt.innerHTML = files[i];</span>
<a href="#l11.164"></a><span id="l11.164" class="difflineminus">-      selector.appendChild(opt);</span>
<a href="#l11.165"></a><span id="l11.165" class="difflineminus">-    }</span>
<a href="#l11.166"></a><span id="l11.166" class="difflineminus">-</span>
<a href="#l11.167"></a><span id="l11.167" class="difflineminus">-    selector = document.getElementById(&quot;task-selector&quot;);</span>
<a href="#l11.168"></a><span id="l11.168" class="difflineminus">-    var tasks = TestPilotSetup.getAllTasks();</span>
<a href="#l11.169"></a><span id="l11.169" class="difflineminus">-    var title;</span>
<a href="#l11.170"></a><span id="l11.170" class="difflineminus">-    for (i = 0; i &lt; tasks.length; i++) {</span>
<a href="#l11.171"></a><span id="l11.171" class="difflineminus">-      opt = document.createElement(&quot;option&quot;);</span>
<a href="#l11.172"></a><span id="l11.172" class="difflineminus">-      title = tasks[i].title;</span>
<a href="#l11.173"></a><span id="l11.173" class="difflineminus">-      opt.innerHTML = title;</span>
<a href="#l11.174"></a><span id="l11.174" class="difflineminus">-      opt.setAttribute(&quot;value&quot;, tasks[i].id);</span>
<a href="#l11.175"></a><span id="l11.175" class="difflineminus">-      selector.appendChild(opt);</span>
<a href="#l11.176"></a><span id="l11.176" class="difflineminus">-    }</span>
<a href="#l11.177"></a><span id="l11.177" class="difflineminus">-  }</span>
<a href="#l11.178"></a><span id="l11.178" class="difflineminus">-</span>
<a href="#l11.179"></a><span id="l11.179" class="difflineminus">-  function showSelectedTaskStatus() {</span>
<a href="#l11.180"></a><span id="l11.180" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l11.181"></a><span id="l11.181" class="difflineminus">-    var task = TestPilotSetup.getTaskById(getEid());</span>
<a href="#l11.182"></a><span id="l11.182" class="difflineminus">-    document.getElementById(&quot;show-status-span&quot;).innerHTML = task.status;</span>
<a href="#l11.183"></a><span id="l11.183" class="difflineminus">-    var selector = document.getElementById(&quot;status-selector&quot;);</span>
<a href="#l11.184"></a><span id="l11.184" class="difflineminus">-    selector.selectedIndex = task.status;</span>
<a href="#l11.185"></a><span id="l11.185" class="difflineminus">-  }</span>
<a href="#l11.186"></a><span id="l11.186" class="difflineminus">-</span>
<a href="#l11.187"></a><span id="l11.187" class="difflineminus">-  function resetSelectedTask() {</span>
<a href="#l11.188"></a><span id="l11.188" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l11.189"></a><span id="l11.189" class="difflineminus">-    var task = TestPilotSetup.getTaskById(getEid());</span>
<a href="#l11.190"></a><span id="l11.190" class="difflineminus">-    task.changeStatus(0, true);</span>
<a href="#l11.191"></a><span id="l11.191" class="difflineminus">-    var prefService  = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;].getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l11.192"></a><span id="l11.192" class="difflineminus">-    var prefName= &quot;extensions.testpilot.startDate.&quot; + task.id;</span>
<a href="#l11.193"></a><span id="l11.193" class="difflineminus">-    if (prefService.prefHasUserValue(prefName)) {</span>
<a href="#l11.194"></a><span id="l11.194" class="difflineminus">-      prefService.clearUserPref(prefName);</span>
<a href="#l11.195"></a><span id="l11.195" class="difflineminus">-    }</span>
<a href="#l11.196"></a><span id="l11.196" class="difflineminus">-  }</span>
<a href="#l11.197"></a><span id="l11.197" class="difflineminus">-</span>
<a href="#l11.198"></a><span id="l11.198" class="difflineminus">-  function setSelectedTaskStatus() {</span>
<a href="#l11.199"></a><span id="l11.199" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l11.200"></a><span id="l11.200" class="difflineminus">-    var task = TestPilotSetup.getTaskById(getEid());</span>
<a href="#l11.201"></a><span id="l11.201" class="difflineminus">-</span>
<a href="#l11.202"></a><span id="l11.202" class="difflineminus">-    var selector = document.getElementById(&quot;status-selector&quot;);</span>
<a href="#l11.203"></a><span id="l11.203" class="difflineminus">-    var i = selector.selectedIndex;</span>
<a href="#l11.204"></a><span id="l11.204" class="difflineminus">-    var newStatus = parseInt( selector.options[i].value );</span>
<a href="#l11.205"></a><span id="l11.205" class="difflineminus">-    task.changeStatus(newStatus, false);</span>
<a href="#l11.206"></a><span id="l11.206" class="difflineminus">-  }</span>
<a href="#l11.207"></a><span id="l11.207" class="difflineminus">-</span>
<a href="#l11.208"></a><span id="l11.208" class="difflineminus">-  function showIndexFileDropdown() {</span>
<a href="#l11.209"></a><span id="l11.209" class="difflineminus">-    var prefService  = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;].getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l11.210"></a><span id="l11.210" class="difflineminus">-    var prefName = &quot;extensions.testpilot.indexFileName&quot;;</span>
<a href="#l11.211"></a><span id="l11.211" class="difflineminus">-    var selector = document.getElementById(&quot;index-file-selector&quot;);</span>
<a href="#l11.212"></a><span id="l11.212" class="difflineminus">-    switch (prefService.getCharPref(prefName)) {</span>
<a href="#l11.213"></a><span id="l11.213" class="difflineminus">-      case &quot;index.json&quot;:</span>
<a href="#l11.214"></a><span id="l11.214" class="difflineminus">-        selector.selectedIndex = 0;</span>
<a href="#l11.215"></a><span id="l11.215" class="difflineminus">-      break;</span>
<a href="#l11.216"></a><span id="l11.216" class="difflineminus">-      case &quot;index-dev.json&quot;:</span>
<a href="#l11.217"></a><span id="l11.217" class="difflineminus">-        selector.selectedIndex = 1;</span>
<a href="#l11.218"></a><span id="l11.218" class="difflineminus">-      break;</span>
<a href="#l11.219"></a><span id="l11.219" class="difflineminus">-      case &quot;index-mobile.json&quot;:</span>
<a href="#l11.220"></a><span id="l11.220" class="difflineminus">-        selector.selectedIndex = 2;</span>
<a href="#l11.221"></a><span id="l11.221" class="difflineminus">-      break;</span>
<a href="#l11.222"></a><span id="l11.222" class="difflineminus">-      case &quot;index-tb-dev.json&quot;:</span>
<a href="#l11.223"></a><span id="l11.223" class="difflineminus">-        selector.selectedIndex = 3;</span>
<a href="#l11.224"></a><span id="l11.224" class="difflineminus">-      break;</span>
<a href="#l11.225"></a><span id="l11.225" class="difflineminus">-    }</span>
<a href="#l11.226"></a><span id="l11.226" class="difflineminus">-  }</span>
<a href="#l11.227"></a><span id="l11.227" class="difflineminus">-</span>
<a href="#l11.228"></a><span id="l11.228" class="difflineminus">-  function setSelectedIndexFile() {</span>
<a href="#l11.229"></a><span id="l11.229" class="difflineminus">-    document.getElementById(&quot;debug&quot;).innerHTML = &quot;Setting index file&quot;;</span>
<a href="#l11.230"></a><span id="l11.230" class="difflineminus">-    try {</span>
<a href="#l11.231"></a><span id="l11.231" class="difflineminus">-    var prefService  = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;].getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l11.232"></a><span id="l11.232" class="difflineminus">-    var prefName = &quot;extensions.testpilot.indexFileName&quot;;</span>
<a href="#l11.233"></a><span id="l11.233" class="difflineminus">-    var selector = document.getElementById(&quot;index-file-selector&quot;);</span>
<a href="#l11.234"></a><span id="l11.234" class="difflineminus">-    var i = selector.selectedIndex;</span>
<a href="#l11.235"></a><span id="l11.235" class="difflineminus">-    document.getElementById(&quot;debug&quot;).innerHTML = &quot;Setting index file to &quot; + selector.options[i].value;</span>
<a href="#l11.236"></a><span id="l11.236" class="difflineminus">-    prefService.setCharPref( prefName, selector.options[i].value );</span>
<a href="#l11.237"></a><span id="l11.237" class="difflineminus">-</span>
<a href="#l11.238"></a><span id="l11.238" class="difflineminus">-    // DELETE CACHED INDEX FILE</span>
<a href="#l11.239"></a><span id="l11.239" class="difflineminus">-    var file = Components.classes[&quot;@mozilla.org/file/directory_service;1&quot;].</span>
<a href="#l11.240"></a><span id="l11.240" class="difflineminus">-                     getService(Components.interfaces.nsIProperties).</span>
<a href="#l11.241"></a><span id="l11.241" class="difflineminus">-                     get(&quot;ProfD&quot;, Components.interfaces.nsIFile);</span>
<a href="#l11.242"></a><span id="l11.242" class="difflineminus">-    file.append(&quot;TestPilotExperimentFiles&quot;);</span>
<a href="#l11.243"></a><span id="l11.243" class="difflineminus">-    file.append(&quot;index.json&quot;);</span>
<a href="#l11.244"></a><span id="l11.244" class="difflineminus">-    if (file.exists()) {</span>
<a href="#l11.245"></a><span id="l11.245" class="difflineminus">-      file.remove(false);</span>
<a href="#l11.246"></a><span id="l11.246" class="difflineminus">-    }</span>
<a href="#l11.247"></a><span id="l11.247" class="difflineminus">-    } catch(e) {</span>
<a href="#l11.248"></a><span id="l11.248" class="difflineminus">-       document.getElementById(&quot;debug&quot;).innerHTML = &quot;Error: &quot; + e;</span>
<a href="#l11.249"></a><span id="l11.249" class="difflineminus">-    }</span>
<a href="#l11.250"></a><span id="l11.250" class="difflineminus">-  }</span>
<a href="#l11.251"></a><span id="l11.251" class="difflineminus">-</span>
<a href="#l11.252"></a><span id="l11.252" class="difflineminus">-&lt;/script&gt;</span>
<a href="#l11.253"></a><span id="l11.253" class="difflineminus">-</span>
<a href="#l11.254"></a><span id="l11.254" class="difflineminus">-&lt;style type=&quot;text/css&quot;&gt;</span>
<a href="#l11.255"></a><span id="l11.255" class="difflineminus">-      canvas { border: 1px solid black; }</span>
<a href="#l11.256"></a><span id="l11.256" class="difflineminus">-    &lt;/style&gt;</span>
<a href="#l11.257"></a><span id="l11.257" class="difflineminus">-</span>
<a href="#l11.258"></a><span id="l11.258" class="difflineminus">-&lt;/head&gt;</span>
<a href="#l11.259"></a><span id="l11.259" class="difflineminus">-</span>
<a href="#l11.260"></a><span id="l11.260" class="difflineminus">-&lt;body onload=&quot;populateFileDropdown();showSelectedTaskStatus();showIndexFileDropdown();&quot;&gt;</span>
<a href="#l11.261"></a><span id="l11.261" class="difflineminus">-</span>
<a href="#l11.262"></a><span id="l11.262" class="difflineminus">-&lt;fieldset&gt;</span>
<a href="#l11.263"></a><span id="l11.263" class="difflineminus">-&lt;p&gt;&lt;select id=&quot;task-selector&quot; onchange=&quot;showSelectedTaskStatus();&quot;&gt;&lt;/select&gt; Current Status = &lt;span id=&quot;show-status-span&quot;&gt;&lt;/span&gt;.</span>
<a href="#l11.264"></a><span id="l11.264" class="difflineminus">-&lt;button onclick=&quot;resetSelectedTask();showSelectedTaskStatus();&quot;&gt;Reset Task&lt;/button&gt;</span>
<a href="#l11.265"></a><span id="l11.265" class="difflineminus">-or set it to</span>
<a href="#l11.266"></a><span id="l11.266" class="difflineminus">-&lt;select id=&quot;status-selector&quot; onchange=&quot;setSelectedTaskStatus(); showSelectedTaskStatus();&quot;&gt;</span>
<a href="#l11.267"></a><span id="l11.267" class="difflineminus">-  &lt;option value=&quot;0&quot;&gt;0 (New)&lt;/option&gt;</span>
<a href="#l11.268"></a><span id="l11.268" class="difflineminus">-  &lt;option value=&quot;1&quot;&gt;1 (Pending)&lt;/option&gt;</span>
<a href="#l11.269"></a><span id="l11.269" class="difflineminus">-  &lt;option value=&quot;2&quot;&gt;2 (Starting)&lt;/option&gt;</span>
<a href="#l11.270"></a><span id="l11.270" class="difflineminus">-  &lt;option value=&quot;3&quot;&gt;3 (In Progress)&lt;/option&gt;</span>
<a href="#l11.271"></a><span id="l11.271" class="difflineminus">-  &lt;option value=&quot;4&quot;&gt;4 (Finished)&lt;/option&gt;</span>
<a href="#l11.272"></a><span id="l11.272" class="difflineminus">-  &lt;option value=&quot;5&quot;&gt;5 (Cancelled)&lt;/option&gt;</span>
<a href="#l11.273"></a><span id="l11.273" class="difflineminus">-  &lt;option value=&quot;6&quot;&gt;6 (Submitted)&lt;/option&gt;</span>
<a href="#l11.274"></a><span id="l11.274" class="difflineminus">-  &lt;option value=&quot;7&quot;&gt;7 (Results)&lt;/option&gt;</span>
<a href="#l11.275"></a><span id="l11.275" class="difflineminus">-  &lt;option value=&quot;8&quot;&gt;8 (Archived)&lt;/option&gt;</span>
<a href="#l11.276"></a><span id="l11.276" class="difflineminus">-&lt;/select&gt;</span>
<a href="#l11.277"></a><span id="l11.277" class="difflineminus">-&lt;button onclick=&quot;wipeDb();&quot;&gt;Wipe My Data&lt;/button&gt;</span>
<a href="#l11.278"></a><span id="l11.278" class="difflineminus">-&lt;button onclick=&quot;nukeDb();&quot;&gt;NUKE&lt;/button&gt;</span>
<a href="#l11.279"></a><span id="l11.279" class="difflineminus">-&lt;button onclick=&quot;uploadData();&quot;&gt;Upload My Data&lt;/button&gt;</span>
<a href="#l11.280"></a><span id="l11.280" class="difflineminus">-&lt;button onclick=&quot;showMetaData();&quot;&gt;Show Metadata&lt;/button&gt;</span>
<a href="#l11.281"></a><span id="l11.281" class="difflineminus">-&lt;button onclick=&quot;runUnitTests();&quot;&gt;Run Tests&lt;/button&gt;</span>
<a href="#l11.282"></a><span id="l11.282" class="difflineminus">-&lt;/fieldset&gt;</span>
<a href="#l11.283"></a><span id="l11.283" class="difflineminus">-&lt;fieldset&gt;</span>
<a href="#l11.284"></a><span id="l11.284" class="difflineminus">-&lt;p&gt;&lt;button onclick=&quot;makeThereBeAPopup();&quot;&gt;Show Dummy Popup&lt;/button&gt;</span>
<a href="#l11.285"></a><span id="l11.285" class="difflineminus">-&lt;button onclick=&quot;reloadAllExperiments();&quot;&gt;Reload All Experiments&lt;/button&gt;</span>
<a href="#l11.286"></a><span id="l11.286" class="difflineminus">-&lt;button onclick=&quot;remindMe();&quot;&gt;Notify Me&lt;/button&gt;</span>
<a href="#l11.287"></a><span id="l11.287" class="difflineminus">-&lt;button onclick=&quot;testJarStore();&quot;&gt;Test Jar Store&lt;/button&gt;</span>
<a href="#l11.288"></a><span id="l11.288" class="difflineminus">-Index file: </span>
<a href="#l11.289"></a><span id="l11.289" class="difflineminus">-&lt;select id=&quot;index-file-selector&quot; onchange=&quot;setSelectedIndexFile();&quot;&gt;</span>
<a href="#l11.290"></a><span id="l11.290" class="difflineminus">-  &lt;option value=&quot;index.json&quot;&gt;index.json&lt;/option&gt;</span>
<a href="#l11.291"></a><span id="l11.291" class="difflineminus">-  &lt;option value=&quot;index-dev.json&quot;&gt;index-dev.json&lt;/option&gt;</span>
<a href="#l11.292"></a><span id="l11.292" class="difflineminus">-  &lt;option value=&quot;index-mobile.json&quot;&gt;index-mobile.json&lt;/option&gt;</span>
<a href="#l11.293"></a><span id="l11.293" class="difflineminus">-  &lt;option value=&quot;index-tb-dev.json&quot;&gt;index-tb-dev.json&lt;/option&gt;</span>
<a href="#l11.294"></a><span id="l11.294" class="difflineminus">-&lt;/select&gt;</span>
<a href="#l11.295"></a><span id="l11.295" class="difflineminus">-&lt;/p&gt;</span>
<a href="#l11.296"></a><span id="l11.296" class="difflineminus">-&lt;/fieldset&gt;</span>
<a href="#l11.297"></a><span id="l11.297" class="difflineminus">-&lt;p&gt;&lt;span id=&quot;debug&quot;&gt;&lt;/span&gt;&lt;/p&gt;</span>
<a href="#l11.298"></a><span id="l11.298" class="difflineminus">-</span>
<a href="#l11.299"></a><span id="l11.299" class="difflineminus">-</span>
<a href="#l11.300"></a><span id="l11.300" class="difflineminus">-&lt;textarea id=&quot;experiment-code-area&quot; rows=&quot;40&quot; cols=&quot;80&quot;&gt;</span>
<a href="#l11.301"></a><span id="l11.301" class="difflineminus">-&lt;/textarea&gt;</span>
<a href="#l11.302"></a><span id="l11.302" class="difflineminus">-&lt;select id=&quot;file-selector&quot;&gt;&lt;/select&gt;</span>
<a href="#l11.303"></a><span id="l11.303" class="difflineminus">-&lt;button onclick=&quot;loadExperimentCode();&quot;&gt;Load Ye Code&lt;/button&gt;</span>
<a href="#l11.304"></a><span id="l11.304" class="difflineminus">-&lt;button onclick=&quot;saveAndRun();&quot;&gt;Save And Run Ye Code&lt;/button&gt;</span>
<a href="#l11.305"></a><span id="l11.305" class="difflineminus">-</span>
<a href="#l11.306"></a><span id="l11.306" class="difflineminus">-</span>
<a href="#l11.307"></a><span id="l11.307" class="difflineminus">-&lt;/body&gt; &lt;/html&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1">deleted file mode 100644</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/experiment-page.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineplus">+++ /dev/null</span>
<a href="#l12.4"></a><span id="l12.4" class="difflineat">@@ -1,491 +0,0 @@</span>
<a href="#l12.5"></a><span id="l12.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l12.6"></a><span id="l12.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l12.7"></a><span id="l12.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l12.8"></a><span id="l12.8" class="difflineminus">-</span>
<a href="#l12.9"></a><span id="l12.9" class="difflineminus">-const PAGE_TYPE_STATUS = 0;</span>
<a href="#l12.10"></a><span id="l12.10" class="difflineminus">-const PAGE_TYPE_QUIT = 1;</span>
<a href="#l12.11"></a><span id="l12.11" class="difflineminus">-var stringBundle;</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-  function showRawData(experimentId) {</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-    window.openDialog(</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineminus">-      &quot;chrome://testpilot/content/raw-data-dialog.xul&quot;,</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineminus">-      &quot;TestPilotRawDataDialog&quot;, &quot;chrome,centerscreen,resizable,scrollbars&quot;,</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineminus">-      experimentId);</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineminus">-  }</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineminus">-</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineminus">-  function getUrlParam(name) {</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineminus">-    // from http://www.netlobo.com/url_query_string_javascript.html</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineminus">-    name = name.replace(/[\[]/,&quot;\\\[&quot;).replace(/[\]]/,&quot;\\\]&quot;);</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineminus">-    var regexS = &quot;[\\?&amp;]&quot;+name+&quot;=([^&amp;#]*)&quot;;</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineminus">-    var regex = new RegExp(regexS);</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineminus">-    var results = regex.exec(window.location.href);</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineminus">-    if( results == null )</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineminus">-      return &quot;&quot;;</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineminus">-    else</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineminus">-      return results[1];</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineminus">-  }</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineminus">-</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineminus">-  function uploadData() {</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineminus">-    let eid = getUrlParam(&quot;eid&quot;);</span>
<a href="#l12.35"></a><span id="l12.35" class="difflineminus">-    let task = TestPilotSetup.getTaskById(eid);</span>
<a href="#l12.36"></a><span id="l12.36" class="difflineminus">-</span>
<a href="#l12.37"></a><span id="l12.37" class="difflineminus">-    // If always-submit-checkbox is checked, set the pref</span>
<a href="#l12.38"></a><span id="l12.38" class="difflineminus">-    if (task._recursAutomatically) {</span>
<a href="#l12.39"></a><span id="l12.39" class="difflineminus">-      let checkBox = document.getElementById(&quot;always-submit-checkbox&quot;);</span>
<a href="#l12.40"></a><span id="l12.40" class="difflineminus">-      if (checkBox &amp;&amp; checkBox.checked) {</span>
<a href="#l12.41"></a><span id="l12.41" class="difflineminus">-        task.setRecurPref(TaskConstants.ALWAYS_SUBMIT);</span>
<a href="#l12.42"></a><span id="l12.42" class="difflineminus">-      }</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineminus">-    }</span>
<a href="#l12.44"></a><span id="l12.44" class="difflineminus">-</span>
<a href="#l12.45"></a><span id="l12.45" class="difflineminus">-    // Study web content must provide an element with id 'upload-status'.</span>
<a href="#l12.46"></a><span id="l12.46" class="difflineminus">-    // Fill it first with a message about data being uploaded; if there's</span>
<a href="#l12.47"></a><span id="l12.47" class="difflineminus">-    // an error, replace it with the error message.</span>
<a href="#l12.48"></a><span id="l12.48" class="difflineminus">-    let uploadStatus = document.getElementById(&quot;upload-status&quot;);</span>
<a href="#l12.49"></a><span id="l12.49" class="difflineminus">-    uploadStatus.textContent =</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineminus">-      stringBundle.GetStringFromName(&quot;testpilot.statusPage.uploadingData&quot;);</span>
<a href="#l12.51"></a><span id="l12.51" class="difflineminus">-    task.upload( function(success) {</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineminus">-      if (success) {</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineminus">-        onStatusPageLoad();</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineminus">-      } else {</span>
<a href="#l12.55"></a><span id="l12.55" class="difflineminus">-        // Replace 'now uploading' message</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineminus">-        let errorParagraph = document.createElement(&quot;p&quot;);</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineminus">-        errorParagraph.textContent = stringBundle.GetStringFromName(&quot;testpilot.statusPage.uploadErrorMsg&quot;);</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineminus">-        let willRetryParagraph = document.createElement(&quot;p&quot;);</span>
<a href="#l12.59"></a><span id="l12.59" class="difflineminus">-        willRetryParagraph.textContent = stringBundle.GetStringFromName(&quot;testpilot.statusPage.willRetry&quot;);</span>
<a href="#l12.60"></a><span id="l12.60" class="difflineminus">-        uploadStatus.innerHTML = &quot;&quot;;</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineminus">-        uploadStatus.appendChild(errorParagraph);</span>
<a href="#l12.62"></a><span id="l12.62" class="difflineminus">-        uploadStatus.appendChild(willRetryParagraph);</span>
<a href="#l12.63"></a><span id="l12.63" class="difflineminus">-      }</span>
<a href="#l12.64"></a><span id="l12.64" class="difflineminus">-    });</span>
<a href="#l12.65"></a><span id="l12.65" class="difflineminus">-  }</span>
<a href="#l12.66"></a><span id="l12.66" class="difflineminus">-</span>
<a href="#l12.67"></a><span id="l12.67" class="difflineminus">-  function deleteData() {</span>
<a href="#l12.68"></a><span id="l12.68" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/tasks.js&quot;);</span>
<a href="#l12.70"></a><span id="l12.70" class="difflineminus">-    let eid = getUrlParam(&quot;eid&quot;);</span>
<a href="#l12.71"></a><span id="l12.71" class="difflineminus">-    let task = TestPilotSetup.getTaskById(eid);</span>
<a href="#l12.72"></a><span id="l12.72" class="difflineminus">-    task.dataStore.wipeAllData();</span>
<a href="#l12.73"></a><span id="l12.73" class="difflineminus">-    // reload the URL after wiping all data.</span>
<a href="#l12.74"></a><span id="l12.74" class="difflineminus">-    window.location = &quot;chrome://testpilot/content/status.html?eid=&quot; + eid;</span>
<a href="#l12.75"></a><span id="l12.75" class="difflineminus">-  }</span>
<a href="#l12.76"></a><span id="l12.76" class="difflineminus">-</span>
<a href="#l12.77"></a><span id="l12.77" class="difflineminus">-  function saveCanvas(canvas) {</span>
<a href="#l12.78"></a><span id="l12.78" class="difflineminus">-    const nsIFilePicker = Components.interfaces.nsIFilePicker;</span>
<a href="#l12.79"></a><span id="l12.79" class="difflineminus">-    let filePicker = Components.classes[&quot;@mozilla.org/filepicker;1&quot;].</span>
<a href="#l12.80"></a><span id="l12.80" class="difflineminus">-      createInstance(nsIFilePicker);</span>
<a href="#l12.81"></a><span id="l12.81" class="difflineminus">-    filePicker.init(window, null, nsIFilePicker.modeSave);</span>
<a href="#l12.82"></a><span id="l12.82" class="difflineminus">-    filePicker.appendFilters(</span>
<a href="#l12.83"></a><span id="l12.83" class="difflineminus">-	nsIFilePicker.filterImages | nsIFilePicker.filterAll);</span>
<a href="#l12.84"></a><span id="l12.84" class="difflineminus">-    filePicker.defaultString = &quot;canvas.png&quot;;</span>
<a href="#l12.85"></a><span id="l12.85" class="difflineminus">-</span>
<a href="#l12.86"></a><span id="l12.86" class="difflineminus">-    let response = filePicker.show();</span>
<a href="#l12.87"></a><span id="l12.87" class="difflineminus">-    if (response == nsIFilePicker.returnOK ||</span>
<a href="#l12.88"></a><span id="l12.88" class="difflineminus">-	response == nsIFilePicker.returnReplace) {</span>
<a href="#l12.89"></a><span id="l12.89" class="difflineminus">-      const nsIWebBrowserPersist = Components.interfaces.nsIWebBrowserPersist;</span>
<a href="#l12.90"></a><span id="l12.90" class="difflineminus">-      let file = filePicker.file;</span>
<a href="#l12.91"></a><span id="l12.91" class="difflineminus">-</span>
<a href="#l12.92"></a><span id="l12.92" class="difflineminus">-      // create a data url from the canvas and then create URIs of the source</span>
<a href="#l12.93"></a><span id="l12.93" class="difflineminus">-      // and targets</span>
<a href="#l12.94"></a><span id="l12.94" class="difflineminus">-      let io = Components.classes[&quot;@mozilla.org/network/io-service;1&quot;].</span>
<a href="#l12.95"></a><span id="l12.95" class="difflineminus">-	getService(Components.interfaces.nsIIOService);</span>
<a href="#l12.96"></a><span id="l12.96" class="difflineminus">-      let source = io.newURI(canvas.toDataURL(&quot;image/png&quot;, &quot;&quot;), &quot;UTF8&quot;, null);</span>
<a href="#l12.97"></a><span id="l12.97" class="difflineminus">-      let target = io.newFileURI(file);</span>
<a href="#l12.98"></a><span id="l12.98" class="difflineminus">-</span>
<a href="#l12.99"></a><span id="l12.99" class="difflineminus">-      // prepare to save the canvas data</span>
<a href="#l12.100"></a><span id="l12.100" class="difflineminus">-      let persist = Components.classes[</span>
<a href="#l12.101"></a><span id="l12.101" class="difflineminus">-	&quot;@mozilla.org/embedding/browser/nsWebBrowserPersist;1&quot;].</span>
<a href="#l12.102"></a><span id="l12.102" class="difflineminus">-	  createInstance(nsIWebBrowserPersist);</span>
<a href="#l12.103"></a><span id="l12.103" class="difflineminus">-      persist.persistFlags = nsIWebBrowserPersist.</span>
<a href="#l12.104"></a><span id="l12.104" class="difflineminus">-	PERSIST_FLAGS_REPLACE_EXISTING_FILES;</span>
<a href="#l12.105"></a><span id="l12.105" class="difflineminus">-      persist.persistFlags |= nsIWebBrowserPersist.</span>
<a href="#l12.106"></a><span id="l12.106" class="difflineminus">-        PERSIST_FLAGS_AUTODETECT_APPLY_CONVERSION;</span>
<a href="#l12.107"></a><span id="l12.107" class="difflineminus">-</span>
<a href="#l12.108"></a><span id="l12.108" class="difflineminus">-      // displays a download dialog (remove these 3 lines for silent download)</span>
<a href="#l12.109"></a><span id="l12.109" class="difflineminus">-      let xfer = Components.classes[&quot;@mozilla.org/transfer;1&quot;].</span>
<a href="#l12.110"></a><span id="l12.110" class="difflineminus">-	createInstance(Components.interfaces.nsITransfer);</span>
<a href="#l12.111"></a><span id="l12.111" class="difflineminus">-      xfer.init(source, target, &quot;&quot;, null, null, null, persist);</span>
<a href="#l12.112"></a><span id="l12.112" class="difflineminus">-      persist.progressListener = xfer;</span>
<a href="#l12.113"></a><span id="l12.113" class="difflineminus">-</span>
<a href="#l12.114"></a><span id="l12.114" class="difflineminus">-      // save the canvas data to the file</span>
<a href="#l12.115"></a><span id="l12.115" class="difflineminus">-      persist.saveURI(source, null, null, null, null, file);</span>
<a href="#l12.116"></a><span id="l12.116" class="difflineminus">-    }</span>
<a href="#l12.117"></a><span id="l12.117" class="difflineminus">-  }</span>
<a href="#l12.118"></a><span id="l12.118" class="difflineminus">-</span>
<a href="#l12.119"></a><span id="l12.119" class="difflineminus">-  function exportData() {</span>
<a href="#l12.120"></a><span id="l12.120" class="difflineminus">-    const nsIFilePicker = Components.interfaces.nsIFilePicker;</span>
<a href="#l12.121"></a><span id="l12.121" class="difflineminus">-    let filePicker = Components.classes[&quot;@mozilla.org/filepicker;1&quot;].</span>
<a href="#l12.122"></a><span id="l12.122" class="difflineminus">-      createInstance(nsIFilePicker);</span>
<a href="#l12.123"></a><span id="l12.123" class="difflineminus">-    let eid = getUrlParam(&quot;eid&quot;);</span>
<a href="#l12.124"></a><span id="l12.124" class="difflineminus">-    let task = TestPilotSetup.getTaskById(eid);</span>
<a href="#l12.125"></a><span id="l12.125" class="difflineminus">-</span>
<a href="#l12.126"></a><span id="l12.126" class="difflineminus">-    filePicker.init(window, null, nsIFilePicker.modeSave);</span>
<a href="#l12.127"></a><span id="l12.127" class="difflineminus">-    filePicker.appendFilters(</span>
<a href="#l12.128"></a><span id="l12.128" class="difflineminus">-	nsIFilePicker.filterImages | nsIFilePicker.filterAll);</span>
<a href="#l12.129"></a><span id="l12.129" class="difflineminus">-    filePicker.defaultString = task.title + &quot;.csv&quot;;</span>
<a href="#l12.130"></a><span id="l12.130" class="difflineminus">-</span>
<a href="#l12.131"></a><span id="l12.131" class="difflineminus">-    let response = filePicker.show();</span>
<a href="#l12.132"></a><span id="l12.132" class="difflineminus">-    if (response == nsIFilePicker.returnOK ||</span>
<a href="#l12.133"></a><span id="l12.133" class="difflineminus">-	response == nsIFilePicker.returnReplace) {</span>
<a href="#l12.134"></a><span id="l12.134" class="difflineminus">-      const nsIWebBrowserPersist = Components.interfaces.nsIWebBrowserPersist;</span>
<a href="#l12.135"></a><span id="l12.135" class="difflineminus">-      let foStream =</span>
<a href="#l12.136"></a><span id="l12.136" class="difflineminus">-        Components.classes[&quot;@mozilla.org/network/file-output-stream;1&quot;].</span>
<a href="#l12.137"></a><span id="l12.137" class="difflineminus">-	  createInstance(Components.interfaces.nsIFileOutputStream);</span>
<a href="#l12.138"></a><span id="l12.138" class="difflineminus">-      let converter =</span>
<a href="#l12.139"></a><span id="l12.139" class="difflineminus">-        Components.classes[&quot;@mozilla.org/intl/converter-output-stream;1&quot;].</span>
<a href="#l12.140"></a><span id="l12.140" class="difflineminus">-	  createInstance(Components.interfaces.nsIConverterOutputStream);</span>
<a href="#l12.141"></a><span id="l12.141" class="difflineminus">-      let file = filePicker.file;</span>
<a href="#l12.142"></a><span id="l12.142" class="difflineminus">-      let dataStore = task.dataStore;</span>
<a href="#l12.143"></a><span id="l12.143" class="difflineminus">-      let columnNames = dataStore.getHumanReadableColumnNames();</span>
<a href="#l12.144"></a><span id="l12.144" class="difflineminus">-      let propertyNames = dataStore.getPropertyNames();</span>
<a href="#l12.145"></a><span id="l12.145" class="difflineminus">-      let csvString = &quot;&quot;;</span>
<a href="#l12.146"></a><span id="l12.146" class="difflineminus">-</span>
<a href="#l12.147"></a><span id="l12.147" class="difflineminus">-      // titles</span>
<a href="#l12.148"></a><span id="l12.148" class="difflineminus">-      for (let i = 0; i &lt; columnNames.length; i++) {</span>
<a href="#l12.149"></a><span id="l12.149" class="difflineminus">-	csvString += &quot;\&quot;&quot; + columnNames[i] + &quot;\&quot;,&quot;;</span>
<a href="#l12.150"></a><span id="l12.150" class="difflineminus">-      }</span>
<a href="#l12.151"></a><span id="l12.151" class="difflineminus">-      if (csvString.length &gt; 0) {</span>
<a href="#l12.152"></a><span id="l12.152" class="difflineminus">-	csvString = csvString.substring(0, (csvString.length - 1));</span>
<a href="#l12.153"></a><span id="l12.153" class="difflineminus">-        csvString += &quot;\n&quot;;</span>
<a href="#l12.154"></a><span id="l12.154" class="difflineminus">-      }</span>
<a href="#l12.155"></a><span id="l12.155" class="difflineminus">-</span>
<a href="#l12.156"></a><span id="l12.156" class="difflineminus">-      dataStore.getAllDataAsJSON(true, function(rawData) {</span>
<a href="#l12.157"></a><span id="l12.157" class="difflineminus">-        // data</span>
<a href="#l12.158"></a><span id="l12.158" class="difflineminus">-        for (let i = 0; i &lt; rawData.length; i++) {</span>
<a href="#l12.159"></a><span id="l12.159" class="difflineminus">-          for (let j = 0; j &lt; columnNames.length; j++) {</span>
<a href="#l12.160"></a><span id="l12.160" class="difflineminus">-	    csvString += &quot;\&quot;&quot; + rawData[i][propertyNames[j]] + &quot;\&quot;,&quot;;</span>
<a href="#l12.161"></a><span id="l12.161" class="difflineminus">-          }</span>
<a href="#l12.162"></a><span id="l12.162" class="difflineminus">-	  csvString = csvString.substring(0, (csvString.length - 1));</span>
<a href="#l12.163"></a><span id="l12.163" class="difflineminus">-          csvString += &quot;\n&quot;;</span>
<a href="#l12.164"></a><span id="l12.164" class="difflineminus">-        }</span>
<a href="#l12.165"></a><span id="l12.165" class="difflineminus">-</span>
<a href="#l12.166"></a><span id="l12.166" class="difflineminus">-        // write, create, truncate</span>
<a href="#l12.167"></a><span id="l12.167" class="difflineminus">-        foStream.init(file, 0x02 | 0x08 | 0x20, 0664, 0);</span>
<a href="#l12.168"></a><span id="l12.168" class="difflineminus">-        converter.init(foStream, &quot;UTF-8&quot;, 0, 0);</span>
<a href="#l12.169"></a><span id="l12.169" class="difflineminus">-        converter.writeString(csvString);</span>
<a href="#l12.170"></a><span id="l12.170" class="difflineminus">-        converter.close();</span>
<a href="#l12.171"></a><span id="l12.171" class="difflineminus">-      });</span>
<a href="#l12.172"></a><span id="l12.172" class="difflineminus">-    }</span>
<a href="#l12.173"></a><span id="l12.173" class="difflineminus">-  }</span>
<a href="#l12.174"></a><span id="l12.174" class="difflineminus">-</span>
<a href="#l12.175"></a><span id="l12.175" class="difflineminus">-  function openLink(url) {</span>
<a href="#l12.176"></a><span id="l12.176" class="difflineminus">-    const THUNDERBIRD_APP_ID = &quot;{3550f703-e582-4d05-9a08-453d09bdfdc6}&quot;;</span>
<a href="#l12.177"></a><span id="l12.177" class="difflineminus">-</span>
<a href="#l12.178"></a><span id="l12.178" class="difflineminus">-    if (Application.id == THUNDERBIRD_APP_ID) {</span>
<a href="#l12.179"></a><span id="l12.179" class="difflineminus">-      Components.classes[&quot;@mozilla.org/messenger;1&quot;]</span>
<a href="#l12.180"></a><span id="l12.180" class="difflineminus">-                .createInstance(Components.interfaces.nsIMessenger)</span>
<a href="#l12.181"></a><span id="l12.181" class="difflineminus">-                .launchExternalURL(url);</span>
<a href="#l12.182"></a><span id="l12.182" class="difflineminus">-    }</span>
<a href="#l12.183"></a><span id="l12.183" class="difflineminus">-    else {</span>
<a href="#l12.184"></a><span id="l12.184" class="difflineminus">-      // open the link in the chromeless window</span>
<a href="#l12.185"></a><span id="l12.185" class="difflineminus">-      let wm = Components.classes[&quot;@mozilla.org/appshell/window-mediator;1&quot;]</span>
<a href="#l12.186"></a><span id="l12.186" class="difflineminus">-                         .getService(Components.interfaces.nsIWindowMediator);</span>
<a href="#l12.187"></a><span id="l12.187" class="difflineminus">-      let recentWindow = wm.getMostRecentWindow(&quot;navigator:browser&quot;);</span>
<a href="#l12.188"></a><span id="l12.188" class="difflineminus">-</span>
<a href="#l12.189"></a><span id="l12.189" class="difflineminus">-      if (recentWindow) {</span>
<a href="#l12.190"></a><span id="l12.190" class="difflineminus">-        recentWindow.TestPilotWindowUtils.openInTab(url);</span>
<a href="#l12.191"></a><span id="l12.191" class="difflineminus">-      } else {</span>
<a href="#l12.192"></a><span id="l12.192" class="difflineminus">-        window.open(url);</span>
<a href="#l12.193"></a><span id="l12.193" class="difflineminus">-      } </span>
<a href="#l12.194"></a><span id="l12.194" class="difflineminus">-    }</span>
<a href="#l12.195"></a><span id="l12.195" class="difflineminus">-  }</span>
<a href="#l12.196"></a><span id="l12.196" class="difflineminus">-</span>
<a href="#l12.197"></a><span id="l12.197" class="difflineminus">-  function getTestEndingDate(experimentId) {</span>
<a href="#l12.198"></a><span id="l12.198" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l12.199"></a><span id="l12.199" class="difflineminus">-    var task = TestPilotSetup.getTaskById(experimentId);</span>
<a href="#l12.200"></a><span id="l12.200" class="difflineminus">-    var endDate = new Date(task.endDate);</span>
<a href="#l12.201"></a><span id="l12.201" class="difflineminus">-    var diff = (endDate - Date.now());</span>
<a href="#l12.202"></a><span id="l12.202" class="difflineminus">-    var span = document.getElementById(&quot;test-end-time&quot;);</span>
<a href="#l12.203"></a><span id="l12.203" class="difflineminus">-    if (!span) {</span>
<a href="#l12.204"></a><span id="l12.204" class="difflineminus">-      return;</span>
<a href="#l12.205"></a><span id="l12.205" class="difflineminus">-    }</span>
<a href="#l12.206"></a><span id="l12.206" class="difflineminus">-    if (diff &lt; 0) {</span>
<a href="#l12.207"></a><span id="l12.207" class="difflineminus">-      span.textContent =</span>
<a href="#l12.208"></a><span id="l12.208" class="difflineminus">-        stringBundle.GetStringFromName(&quot;testpilot.statusPage.endedAlready&quot;);</span>
<a href="#l12.209"></a><span id="l12.209" class="difflineminus">-      return;</span>
<a href="#l12.210"></a><span id="l12.210" class="difflineminus">-    }</span>
<a href="#l12.211"></a><span id="l12.211" class="difflineminus">-    var hours = diff / (60 * 60 * 1000);</span>
<a href="#l12.212"></a><span id="l12.212" class="difflineminus">-    if (hours &lt; 24) {</span>
<a href="#l12.213"></a><span id="l12.213" class="difflineminus">-      span.textContent =</span>
<a href="#l12.214"></a><span id="l12.214" class="difflineminus">-        stringBundle.formatStringFromName(</span>
<a href="#l12.215"></a><span id="l12.215" class="difflineminus">-	  &quot;testpilot.statusPage.todayAt&quot;, [endDate.toLocaleTimeString()], 1);</span>
<a href="#l12.216"></a><span id="l12.216" class="difflineminus">-    } else {</span>
<a href="#l12.217"></a><span id="l12.217" class="difflineminus">-      span.textContent =</span>
<a href="#l12.218"></a><span id="l12.218" class="difflineminus">-        stringBundle.formatStringFromName(</span>
<a href="#l12.219"></a><span id="l12.219" class="difflineminus">-	  &quot;testpilot.statusPage.endOn&quot;, [endDate.toLocaleString()], 1);</span>
<a href="#l12.220"></a><span id="l12.220" class="difflineminus">-    }</span>
<a href="#l12.221"></a><span id="l12.221" class="difflineminus">-  }</span>
<a href="#l12.222"></a><span id="l12.222" class="difflineminus">-</span>
<a href="#l12.223"></a><span id="l12.223" class="difflineminus">-  function showMetaData() {</span>
<a href="#l12.224"></a><span id="l12.224" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/metadata.js&quot;);</span>
<a href="#l12.225"></a><span id="l12.225" class="difflineminus">-    Components.utils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l12.226"></a><span id="l12.226" class="difflineminus">-    MetadataCollector.getMetadata(function(md) {</span>
<a href="#l12.227"></a><span id="l12.227" class="difflineminus">-      var mdLocale = document.getElementById(&quot;md-locale&quot;);</span>
<a href="#l12.228"></a><span id="l12.228" class="difflineminus">-      if (mdLocale)</span>
<a href="#l12.229"></a><span id="l12.229" class="difflineminus">-        mdLocale.textContent = md.location;</span>
<a href="#l12.230"></a><span id="l12.230" class="difflineminus">-      var mdVersion = document.getElementById(&quot;md-version&quot;);</span>
<a href="#l12.231"></a><span id="l12.231" class="difflineminus">-      if (mdVersion)</span>
<a href="#l12.232"></a><span id="l12.232" class="difflineminus">-        mdVersion.textContent = md.version;</span>
<a href="#l12.233"></a><span id="l12.233" class="difflineminus">-      var mdOs = document.getElementById(&quot;md-os&quot;);</span>
<a href="#l12.234"></a><span id="l12.234" class="difflineminus">-      if (mdOs)</span>
<a href="#l12.235"></a><span id="l12.235" class="difflineminus">-        mdOs.textContent = md.operatingSystem;</span>
<a href="#l12.236"></a><span id="l12.236" class="difflineminus">-      var mdNumExt = document.getElementById(&quot;md-num-ext&quot;);</span>
<a href="#l12.237"></a><span id="l12.237" class="difflineminus">-      if (mdNumExt) {</span>
<a href="#l12.238"></a><span id="l12.238" class="difflineminus">-        // This computes the correctly localized singular or plural string</span>
<a href="#l12.239"></a><span id="l12.239" class="difflineminus">-        // of the number of extensions, e.g. &quot;1 extension&quot;, &quot;2 extensions&quot;, etc.</span>
<a href="#l12.240"></a><span id="l12.240" class="difflineminus">-        let str = stringBundle.GetStringFromName(&quot;testpilot.statusPage.numExtensions&quot;);</span>
<a href="#l12.241"></a><span id="l12.241" class="difflineminus">-        var numExt = md.extensions.length;</span>
<a href="#l12.242"></a><span id="l12.242" class="difflineminus">-        mdNumExt.textContent = PluralForm.get(numExt, str).replace(&quot;#1&quot;, numExt);</span>
<a href="#l12.243"></a><span id="l12.243" class="difflineminus">-      }</span>
<a href="#l12.244"></a><span id="l12.244" class="difflineminus">-    });</span>
<a href="#l12.245"></a><span id="l12.245" class="difflineminus">-  }</span>
<a href="#l12.246"></a><span id="l12.246" class="difflineminus">-</span>
<a href="#l12.247"></a><span id="l12.247" class="difflineminus">-  function onQuitPageLoad() {</span>
<a href="#l12.248"></a><span id="l12.248" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l12.249"></a><span id="l12.249" class="difflineminus">-    setStrings(PAGE_TYPE_QUIT);</span>
<a href="#l12.250"></a><span id="l12.250" class="difflineminus">-    let eid = getUrlParam(&quot;eid&quot;);</span>
<a href="#l12.251"></a><span id="l12.251" class="difflineminus">-    let task = TestPilotSetup.getTaskById(eid);</span>
<a href="#l12.252"></a><span id="l12.252" class="difflineminus">-    let header = document.getElementById(&quot;about-quit-title&quot;);</span>
<a href="#l12.253"></a><span id="l12.253" class="difflineminus">-    header.textContent =</span>
<a href="#l12.254"></a><span id="l12.254" class="difflineminus">-      stringBundle.formatStringFromName(</span>
<a href="#l12.255"></a><span id="l12.255" class="difflineminus">-	&quot;testpilot.quitPage.aboutToQuit&quot;, [task.title], 1);</span>
<a href="#l12.256"></a><span id="l12.256" class="difflineminus">-</span>
<a href="#l12.257"></a><span id="l12.257" class="difflineminus">-    if (task._recursAutomatically) {</span>
<a href="#l12.258"></a><span id="l12.258" class="difflineminus">-      document.getElementById(&quot;recur-options&quot;).setAttribute(&quot;style&quot;, &quot;&quot;);</span>
<a href="#l12.259"></a><span id="l12.259" class="difflineminus">-      document.getElementById(&quot;recur-checkbox-container&quot;).</span>
<a href="#l12.260"></a><span id="l12.260" class="difflineminus">-        setAttribute(&quot;style&quot;, &quot;&quot;);</span>
<a href="#l12.261"></a><span id="l12.261" class="difflineminus">-    }</span>
<a href="#l12.262"></a><span id="l12.262" class="difflineminus">-  }</span>
<a href="#l12.263"></a><span id="l12.263" class="difflineminus">-</span>
<a href="#l12.264"></a><span id="l12.264" class="difflineminus">-  function quitExperiment() {</span>
<a href="#l12.265"></a><span id="l12.265" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l12.266"></a><span id="l12.266" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/tasks.js&quot;);</span>
<a href="#l12.267"></a><span id="l12.267" class="difflineminus">-    let eid = getUrlParam(&quot;eid&quot;);</span>
<a href="#l12.268"></a><span id="l12.268" class="difflineminus">-    let reason = document.getElementById(&quot;reason-for-quit&quot;).value;</span>
<a href="#l12.269"></a><span id="l12.269" class="difflineminus">-    let task = TestPilotSetup.getTaskById(eid);</span>
<a href="#l12.270"></a><span id="l12.270" class="difflineminus">-    task.optOut(reason, function(success) {</span>
<a href="#l12.271"></a><span id="l12.271" class="difflineminus">-      // load the you-are-canceleed page.</span>
<a href="#l12.272"></a><span id="l12.272" class="difflineminus">-      $(&quot;#quit-ui&quot;).slideUp();</span>
<a href="#l12.273"></a><span id="l12.273" class="difflineminus">-      $(&quot;#main-experiment-ui&quot;).slideDown();</span>
<a href="#l12.274"></a><span id="l12.274" class="difflineminus">-      onStatusPageLoad();</span>
<a href="#l12.275"></a><span id="l12.275" class="difflineminus">-    });</span>
<a href="#l12.276"></a><span id="l12.276" class="difflineminus">-</span>
<a href="#l12.277"></a><span id="l12.277" class="difflineminus">-    // If opt-out-forever checkbox is checked, opt out forever!</span>
<a href="#l12.278"></a><span id="l12.278" class="difflineminus">-    if (task._recursAutomatically) {</span>
<a href="#l12.279"></a><span id="l12.279" class="difflineminus">-      let checkBox = document.getElementById(&quot;opt-out-forever&quot;);</span>
<a href="#l12.280"></a><span id="l12.280" class="difflineminus">-      if (checkBox.checked) {</span>
<a href="#l12.281"></a><span id="l12.281" class="difflineminus">-        task.setRecurPref(TaskConstants.NEVER_SUBMIT);</span>
<a href="#l12.282"></a><span id="l12.282" class="difflineminus">-      }</span>
<a href="#l12.283"></a><span id="l12.283" class="difflineminus">-      // quit test so rescheduling</span>
<a href="#l12.284"></a><span id="l12.284" class="difflineminus">-      task._reschedule();</span>
<a href="#l12.285"></a><span id="l12.285" class="difflineminus">-    }</span>
<a href="#l12.286"></a><span id="l12.286" class="difflineminus">-  }</span>
<a href="#l12.287"></a><span id="l12.287" class="difflineminus">-</span>
<a href="#l12.288"></a><span id="l12.288" class="difflineminus">-  function updateRecurSettings() {</span>
<a href="#l12.289"></a><span id="l12.289" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l12.290"></a><span id="l12.290" class="difflineminus">-    let eid = getUrlParam(&quot;eid&quot;);</span>
<a href="#l12.291"></a><span id="l12.291" class="difflineminus">-    let experiment = TestPilotSetup.getTaskById(eid);</span>
<a href="#l12.292"></a><span id="l12.292" class="difflineminus">-    let recurSelector = document.getElementById(&quot;recur-selector&quot;);</span>
<a href="#l12.293"></a><span id="l12.293" class="difflineminus">-    let newValue = recurSelector.options[recurSelector.selectedIndex].value;</span>
<a href="#l12.294"></a><span id="l12.294" class="difflineminus">-    experiment.setRecurPref(parseInt(newValue));</span>
<a href="#l12.295"></a><span id="l12.295" class="difflineminus">-  }</span>
<a href="#l12.296"></a><span id="l12.296" class="difflineminus">-</span>
<a href="#l12.297"></a><span id="l12.297" class="difflineminus">-  function showRecurControls(experiment) {</span>
<a href="#l12.298"></a><span id="l12.298" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/tasks.js&quot;);</span>
<a href="#l12.299"></a><span id="l12.299" class="difflineminus">-    let recurPrefSpan = document.getElementById(&quot;recur-pref&quot;);</span>
<a href="#l12.300"></a><span id="l12.300" class="difflineminus">-    if (!recurPrefSpan) {</span>
<a href="#l12.301"></a><span id="l12.301" class="difflineminus">-      return;</span>
<a href="#l12.302"></a><span id="l12.302" class="difflineminus">-    }</span>
<a href="#l12.303"></a><span id="l12.303" class="difflineminus">-    let days = experiment._recurrenceInterval;</span>
<a href="#l12.304"></a><span id="l12.304" class="difflineminus">-    recurPrefSpan.textContent =</span>
<a href="#l12.305"></a><span id="l12.305" class="difflineminus">-      stringBundle.formatStringFromName(</span>
<a href="#l12.306"></a><span id="l12.306" class="difflineminus">-	&quot;testpilot.statusPage.recursEveryNumberOfDays&quot;, [days], 1);</span>
<a href="#l12.307"></a><span id="l12.307" class="difflineminus">-</span>
<a href="#l12.308"></a><span id="l12.308" class="difflineminus">-    let controls = document.getElementById(&quot;recur-controls&quot;);</span>
<a href="#l12.309"></a><span id="l12.309" class="difflineminus">-    let selector = document.createElement(&quot;select&quot;);</span>
<a href="#l12.310"></a><span id="l12.310" class="difflineminus">-    controls.appendChild(selector);</span>
<a href="#l12.311"></a><span id="l12.311" class="difflineminus">-    selector.addEventListener(&quot;change&quot;, updateRecurSettings, false);</span>
<a href="#l12.312"></a><span id="l12.312" class="difflineminus">-    selector.setAttribute(&quot;id&quot;, &quot;recur-selector&quot;);</span>
<a href="#l12.313"></a><span id="l12.313" class="difflineminus">-</span>
<a href="#l12.314"></a><span id="l12.314" class="difflineminus">-    let option = document.createElement(&quot;option&quot;);</span>
<a href="#l12.315"></a><span id="l12.315" class="difflineminus">-    option.setAttribute(&quot;value&quot;, TaskConstants.ASK_EACH_TIME);</span>
<a href="#l12.316"></a><span id="l12.316" class="difflineminus">-    if (experiment.recurPref == TaskConstants.ASK_EACH_TIME) {</span>
<a href="#l12.317"></a><span id="l12.317" class="difflineminus">-      option.setAttribute(&quot;selected&quot;, &quot;true&quot;);</span>
<a href="#l12.318"></a><span id="l12.318" class="difflineminus">-    }</span>
<a href="#l12.319"></a><span id="l12.319" class="difflineminus">-    option.textContent =</span>
<a href="#l12.320"></a><span id="l12.320" class="difflineminus">-      stringBundle.GetStringFromName(</span>
<a href="#l12.321"></a><span id="l12.321" class="difflineminus">-	&quot;testpilot.statusPage.askMeBeforeSubmitData&quot;);</span>
<a href="#l12.322"></a><span id="l12.322" class="difflineminus">-    selector.appendChild(option);</span>
<a href="#l12.323"></a><span id="l12.323" class="difflineminus">-</span>
<a href="#l12.324"></a><span id="l12.324" class="difflineminus">-    option = document.createElement(&quot;option&quot;);</span>
<a href="#l12.325"></a><span id="l12.325" class="difflineminus">-    option.setAttribute(&quot;value&quot;, TaskConstants.ALWAYS_SUBMIT);</span>
<a href="#l12.326"></a><span id="l12.326" class="difflineminus">-    if (experiment.recurPref == TaskConstants.ALWAYS_SUBMIT) {</span>
<a href="#l12.327"></a><span id="l12.327" class="difflineminus">-      option.setAttribute(&quot;selected&quot;, &quot;true&quot;);</span>
<a href="#l12.328"></a><span id="l12.328" class="difflineminus">-    }</span>
<a href="#l12.329"></a><span id="l12.329" class="difflineminus">-    option.textContent =</span>
<a href="#l12.330"></a><span id="l12.330" class="difflineminus">-      stringBundle.GetStringFromName(</span>
<a href="#l12.331"></a><span id="l12.331" class="difflineminus">-	&quot;testpilot.statusPage.alwaysSubmitData&quot;);</span>
<a href="#l12.332"></a><span id="l12.332" class="difflineminus">-    selector.appendChild(option);</span>
<a href="#l12.333"></a><span id="l12.333" class="difflineminus">-</span>
<a href="#l12.334"></a><span id="l12.334" class="difflineminus">-    option = document.createElement(&quot;option&quot;);</span>
<a href="#l12.335"></a><span id="l12.335" class="difflineminus">-    option.setAttribute(&quot;value&quot;, TaskConstants.NEVER_SUBMIT);</span>
<a href="#l12.336"></a><span id="l12.336" class="difflineminus">-    if (experiment.recurPref == TaskConstants.NEVER_SUBMIT) {</span>
<a href="#l12.337"></a><span id="l12.337" class="difflineminus">-      option.setAttribute(&quot;selected&quot;, &quot;true&quot;);</span>
<a href="#l12.338"></a><span id="l12.338" class="difflineminus">-    }</span>
<a href="#l12.339"></a><span id="l12.339" class="difflineminus">-    option.textContent =</span>
<a href="#l12.340"></a><span id="l12.340" class="difflineminus">-      stringBundle.GetStringFromName(</span>
<a href="#l12.341"></a><span id="l12.341" class="difflineminus">-	&quot;testpilot.statusPage.neverSubmitData&quot;);</span>
<a href="#l12.342"></a><span id="l12.342" class="difflineminus">-    selector.appendChild(option);</span>
<a href="#l12.343"></a><span id="l12.343" class="difflineminus">-  }</span>
<a href="#l12.344"></a><span id="l12.344" class="difflineminus">-</span>
<a href="#l12.345"></a><span id="l12.345" class="difflineminus">-  function loadExperimentPage() {</span>
<a href="#l12.346"></a><span id="l12.346" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l12.347"></a><span id="l12.347" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/tasks.js&quot;);</span>
<a href="#l12.348"></a><span id="l12.348" class="difflineminus">-    var contentDiv = $(&quot;#experiment-specific-text&quot;);</span>
<a href="#l12.349"></a><span id="l12.349" class="difflineminus">-    var dataPrivacyDiv = $(&quot;#data-privacy-text&quot;);</span>
<a href="#l12.350"></a><span id="l12.350" class="difflineminus">-    // Get experimentID from the GET args of page</span>
<a href="#l12.351"></a><span id="l12.351" class="difflineminus">-    var eid = getUrlParam(&quot;eid&quot;);</span>
<a href="#l12.352"></a><span id="l12.352" class="difflineminus">-    var experiment = TestPilotSetup.getTaskById(eid);</span>
<a href="#l12.353"></a><span id="l12.353" class="difflineminus">-    if (!experiment) {</span>
<a href="#l12.354"></a><span id="l12.354" class="difflineminus">-      // Possible that experiments aren't done loading yet.  Try again in</span>
<a href="#l12.355"></a><span id="l12.355" class="difflineminus">-      // a few seconds.</span>
<a href="#l12.356"></a><span id="l12.356" class="difflineminus">-      contentDiv.html(stringBundle.GetStringFromName(&quot;testpilot.statusPage.loading&quot;));</span>
<a href="#l12.357"></a><span id="l12.357" class="difflineminus">-      window.setTimeout(function() { loadExperimentPage(); }, 2000);</span>
<a href="#l12.358"></a><span id="l12.358" class="difflineminus">-      return;</span>
<a href="#l12.359"></a><span id="l12.359" class="difflineminus">-    }</span>
<a href="#l12.360"></a><span id="l12.360" class="difflineminus">-</span>
<a href="#l12.361"></a><span id="l12.361" class="difflineminus">-    // Fill in &quot;opt out&quot; and &quot;raw data&quot; links.</span>
<a href="#l12.362"></a><span id="l12.362" class="difflineminus">-    $(&quot;#raw-data-link&quot;).attr(&quot;href&quot;, &quot;raw-data.html?eid=&quot; + eid);</span>
<a href="#l12.363"></a><span id="l12.363" class="difflineminus">-</span>
<a href="#l12.364"></a><span id="l12.364" class="difflineminus">-    // Let the experiment fill in its web content (asynchronous)</span>
<a href="#l12.365"></a><span id="l12.365" class="difflineminus">-    experiment.getWebContent(function(webContent) {</span>
<a href="#l12.366"></a><span id="l12.366" class="difflineminus">-      contentDiv.html(webContent);</span>
<a href="#l12.367"></a><span id="l12.367" class="difflineminus">-</span>
<a href="#l12.368"></a><span id="l12.368" class="difflineminus">-      // Metadata and start/end date should be filled in for every experiment:</span>
<a href="#l12.369"></a><span id="l12.369" class="difflineminus">-      showMetaData();</span>
<a href="#l12.370"></a><span id="l12.370" class="difflineminus">-      getTestEndingDate(eid);</span>
<a href="#l12.371"></a><span id="l12.371" class="difflineminus">-      if (experiment._recursAutomatically &amp;&amp;</span>
<a href="#l12.372"></a><span id="l12.372" class="difflineminus">-        experiment.status != TaskConstants.STATUS_FINISHED) {</span>
<a href="#l12.373"></a><span id="l12.373" class="difflineminus">-        showRecurControls(experiment);</span>
<a href="#l12.374"></a><span id="l12.374" class="difflineminus">-      }</span>
<a href="#l12.375"></a><span id="l12.375" class="difflineminus">-</span>
<a href="#l12.376"></a><span id="l12.376" class="difflineminus">-      // Do whatever the experiment's web content wants done on load</span>
<a href="#l12.377"></a><span id="l12.377" class="difflineminus">-      // (Usually drawing a graph) - must be done after innerHTML is set.</span>
<a href="#l12.378"></a><span id="l12.378" class="difflineminus">-      experiment.webContent.onPageLoad(experiment, document, jQuery);</span>
<a href="#l12.379"></a><span id="l12.379" class="difflineminus">-    });</span>
<a href="#l12.380"></a><span id="l12.380" class="difflineminus">-</span>
<a href="#l12.381"></a><span id="l12.381" class="difflineminus">-    experiment.getDataPrivacyContent(function(dataPrivacyContent) {</span>
<a href="#l12.382"></a><span id="l12.382" class="difflineminus">-      if (dataPrivacyContent &amp;&amp; dataPrivacyContent.length &gt; 0) {</span>
<a href="#l12.383"></a><span id="l12.383" class="difflineminus">-        dataPrivacyDiv.html(dataPrivacyContent);</span>
<a href="#l12.384"></a><span id="l12.384" class="difflineminus">-        dataPrivacyDiv.removeAttr(&quot;hidden&quot;);</span>
<a href="#l12.385"></a><span id="l12.385" class="difflineminus">-      }</span>
<a href="#l12.386"></a><span id="l12.386" class="difflineminus">-    });</span>
<a href="#l12.387"></a><span id="l12.387" class="difflineminus">-  }</span>
<a href="#l12.388"></a><span id="l12.388" class="difflineminus">-</span>
<a href="#l12.389"></a><span id="l12.389" class="difflineminus">-  function onStatusPageLoad() {</span>
<a href="#l12.390"></a><span id="l12.390" class="difflineminus">-    setStrings(PAGE_TYPE_STATUS);</span>
<a href="#l12.391"></a><span id="l12.391" class="difflineminus">-    /* An experiment ID (eid) must be provided in the url params. Show status</span>
<a href="#l12.392"></a><span id="l12.392" class="difflineminus">-     * for that experiment.*/</span>
<a href="#l12.393"></a><span id="l12.393" class="difflineminus">-    loadExperimentPage();</span>
<a href="#l12.394"></a><span id="l12.394" class="difflineminus">-  }</span>
<a href="#l12.395"></a><span id="l12.395" class="difflineminus">-</span>
<a href="#l12.396"></a><span id="l12.396" class="difflineminus">-  function toggleSection(id) {</span>
<a href="#l12.397"></a><span id="l12.397" class="difflineminus">-    let div = $(&quot;#&quot; + id + &quot;-text&quot;);</span>
<a href="#l12.398"></a><span id="l12.398" class="difflineminus">-    div.slideToggle();</span>
<a href="#l12.399"></a><span id="l12.399" class="difflineminus">-    let button = $(&quot;#&quot; + id + &quot;-button&quot;);</span>
<a href="#l12.400"></a><span id="l12.400" class="difflineminus">-    if (button.html() == &quot;Hide&quot;) {</span>
<a href="#l12.401"></a><span id="l12.401" class="difflineminus">-      button.html(&quot;Show&quot;);</span>
<a href="#l12.402"></a><span id="l12.402" class="difflineminus">-    } else {</span>
<a href="#l12.403"></a><span id="l12.403" class="difflineminus">-      button.html(&quot;Hide&quot;);</span>
<a href="#l12.404"></a><span id="l12.404" class="difflineminus">-    }</span>
<a href="#l12.405"></a><span id="l12.405" class="difflineminus">-  }</span>
<a href="#l12.406"></a><span id="l12.406" class="difflineminus">-</span>
<a href="#l12.407"></a><span id="l12.407" class="difflineminus">-  function setStrings(pageType) {</span>
<a href="#l12.408"></a><span id="l12.408" class="difflineminus">-    Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l12.409"></a><span id="l12.409" class="difflineminus">-</span>
<a href="#l12.410"></a><span id="l12.410" class="difflineminus">-    stringBundle =</span>
<a href="#l12.411"></a><span id="l12.411" class="difflineminus">-      Components.classes[&quot;@mozilla.org/intl/stringbundle;1&quot;].</span>
<a href="#l12.412"></a><span id="l12.412" class="difflineminus">-        getService(Components.interfaces.nsIStringBundleService).</span>
<a href="#l12.413"></a><span id="l12.413" class="difflineminus">-	  createBundle(&quot;chrome://testpilot/locale/main.properties&quot;);</span>
<a href="#l12.414"></a><span id="l12.414" class="difflineminus">-    let map;</span>
<a href="#l12.415"></a><span id="l12.415" class="difflineminus">-    let mapLength;</span>
<a href="#l12.416"></a><span id="l12.416" class="difflineminus">-</span>
<a href="#l12.417"></a><span id="l12.417" class="difflineminus">-    if (pageType == PAGE_TYPE_STATUS) {</span>
<a href="#l12.418"></a><span id="l12.418" class="difflineminus">-      map = [</span>
<a href="#l12.419"></a><span id="l12.419" class="difflineminus">-	{ id: &quot;page-title&quot;, stringKey: &quot;testpilot.fullBrandName&quot; },</span>
<a href="#l12.420"></a><span id="l12.420" class="difflineminus">-	{ id: &quot;comments-and-discussions-link&quot;,</span>
<a href="#l12.421"></a><span id="l12.421" class="difflineminus">-	  stringKey: &quot;testpilot.page.commentsAndDiscussions&quot; },</span>
<a href="#l12.422"></a><span id="l12.422" class="difflineminus">-	{ id: &quot;propose-test-link&quot;,</span>
<a href="#l12.423"></a><span id="l12.423" class="difflineminus">-	  stringKey: &quot;testpilot.page.proposeATest&quot; },</span>
<a href="#l12.424"></a><span id="l12.424" class="difflineminus">-	{ id: &quot;testpilot-twitter-link&quot;,</span>
<a href="#l12.425"></a><span id="l12.425" class="difflineminus">-	  stringKey: &quot;testpilot.page.testpilotOnTwitter&quot; }</span>
<a href="#l12.426"></a><span id="l12.426" class="difflineminus">-      ];</span>
<a href="#l12.427"></a><span id="l12.427" class="difflineminus">-    } else if (pageType == PAGE_TYPE_QUIT) {</span>
<a href="#l12.428"></a><span id="l12.428" class="difflineminus">-      map = [</span>
<a href="#l12.429"></a><span id="l12.429" class="difflineminus">-	{ id: &quot;page-title&quot;, stringKey: &quot;testpilot.fullBrandName&quot; },</span>
<a href="#l12.430"></a><span id="l12.430" class="difflineminus">-	{ id: &quot;comments-and-discussions-link&quot;,</span>
<a href="#l12.431"></a><span id="l12.431" class="difflineminus">-	  stringKey: &quot;testpilot.page.commentsAndDiscussions&quot; },</span>
<a href="#l12.432"></a><span id="l12.432" class="difflineminus">-	{ id: &quot;propose-test-link&quot;,</span>
<a href="#l12.433"></a><span id="l12.433" class="difflineminus">-	  stringKey: &quot;testpilot.page.proposeATest&quot; },</span>
<a href="#l12.434"></a><span id="l12.434" class="difflineminus">-	{ id: &quot;testpilot-twitter-link&quot;,</span>
<a href="#l12.435"></a><span id="l12.435" class="difflineminus">-	  stringKey: &quot;testpilot.page.testpilotOnTwitter&quot; },</span>
<a href="#l12.436"></a><span id="l12.436" class="difflineminus">-	{ id: &quot;optional-message&quot;,</span>
<a href="#l12.437"></a><span id="l12.437" class="difflineminus">-	  stringKey: &quot;testpilot.quitPage.optionalMessage&quot; },</span>
<a href="#l12.438"></a><span id="l12.438" class="difflineminus">-	{ id: &quot;reason-text&quot;,</span>
<a href="#l12.439"></a><span id="l12.439" class="difflineminus">-	  stringKey: &quot;testpilot.quitPage.reason&quot; },</span>
<a href="#l12.440"></a><span id="l12.440" class="difflineminus">-	{ id: &quot;recur-options&quot;,</span>
<a href="#l12.441"></a><span id="l12.441" class="difflineminus">-	  stringKey: &quot;testpilot.quitPage.recurringStudy&quot; },</span>
<a href="#l12.442"></a><span id="l12.442" class="difflineminus">-	{ id: &quot;quit-forever-text&quot;,</span>
<a href="#l12.443"></a><span id="l12.443" class="difflineminus">-	  stringKey: &quot;testpilot.quitPage.quitForever&quot; },</span>
<a href="#l12.444"></a><span id="l12.444" class="difflineminus">-	{ id: &quot;quit-study-link&quot;,</span>
<a href="#l12.445"></a><span id="l12.445" class="difflineminus">-	  stringKey: &quot;testpilot.quitPage.quitStudy&quot; }</span>
<a href="#l12.446"></a><span id="l12.446" class="difflineminus">-      ];</span>
<a href="#l12.447"></a><span id="l12.447" class="difflineminus">-    }</span>
<a href="#l12.448"></a><span id="l12.448" class="difflineminus">-    mapLength = map.length;</span>
<a href="#l12.449"></a><span id="l12.449" class="difflineminus">-    for (let i = 0; i &lt; mapLength; i++) {</span>
<a href="#l12.450"></a><span id="l12.450" class="difflineminus">-      let entry = map[i];</span>
<a href="#l12.451"></a><span id="l12.451" class="difflineminus">-      let elem = document.getElementById(entry.id);</span>
<a href="#l12.452"></a><span id="l12.452" class="difflineminus">-      if (!elem) {</span>
<a href="#l12.453"></a><span id="l12.453" class="difflineminus">-        Services.console.logStringMessage(&quot;No elem as &quot; + entry.id +&quot;.\n&quot;);</span>
<a href="#l12.454"></a><span id="l12.454" class="difflineminus">-        continue;</span>
<a href="#l12.455"></a><span id="l12.455" class="difflineminus">-      }</span>
<a href="#l12.456"></a><span id="l12.456" class="difflineminus">-      elem.textContent = stringBundle.GetStringFromName(entry.stringKey);</span>
<a href="#l12.457"></a><span id="l12.457" class="difflineminus">-    }</span>
<a href="#l12.458"></a><span id="l12.458" class="difflineminus">-  }</span>
<a href="#l12.459"></a><span id="l12.459" class="difflineminus">-</span>
<a href="#l12.460"></a><span id="l12.460" class="difflineminus">-function showDbContentsHtml() {</span>
<a href="#l12.461"></a><span id="l12.461" class="difflineminus">-  Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l12.462"></a><span id="l12.462" class="difflineminus">-  var experimentId = getUrlParam(&quot;eid&quot;);</span>
<a href="#l12.463"></a><span id="l12.463" class="difflineminus">-  var experiment = TestPilotSetup.getTaskById(experimentId);</span>
<a href="#l12.464"></a><span id="l12.464" class="difflineminus">-  var dataStore = experiment.dataStore;</span>
<a href="#l12.465"></a><span id="l12.465" class="difflineminus">-  var table = document.getElementById(&quot;raw-data-table&quot;);</span>
<a href="#l12.466"></a><span id="l12.466" class="difflineminus">-  var columnNames = dataStore.getHumanReadableColumnNames();</span>
<a href="#l12.467"></a><span id="l12.467" class="difflineminus">-  var propertyNames = dataStore.getPropertyNames();</span>
<a href="#l12.468"></a><span id="l12.468" class="difflineminus">-</span>
<a href="#l12.469"></a><span id="l12.469" class="difflineminus">-  $(&quot;title&quot;).html(&quot;Raw Data For &quot; + experiment.title + &quot; Study&quot;);</span>
<a href="#l12.470"></a><span id="l12.470" class="difflineminus">-</span>
<a href="#l12.471"></a><span id="l12.471" class="difflineminus">-  var headerRow = $(&quot;#raw-data-header-row&quot;);</span>
<a href="#l12.472"></a><span id="l12.472" class="difflineminus">-</span>
<a href="#l12.473"></a><span id="l12.473" class="difflineminus">-  var i, j;</span>
<a href="#l12.474"></a><span id="l12.474" class="difflineminus">-  for (j = 0; j &lt; columnNames.length; j++) {</span>
<a href="#l12.475"></a><span id="l12.475" class="difflineminus">-    headerRow.append($(&quot;&lt;th&gt;&lt;/th&gt;&quot;).html(columnNames[j]));</span>
<a href="#l12.476"></a><span id="l12.476" class="difflineminus">-  }</span>
<a href="#l12.477"></a><span id="l12.477" class="difflineminus">-</span>
<a href="#l12.478"></a><span id="l12.478" class="difflineminus">-  dataStore.getAllDataAsJSON(true, function(rawData) {</span>
<a href="#l12.479"></a><span id="l12.479" class="difflineminus">-    // Convert each object in the JSON into a row of the table.</span>
<a href="#l12.480"></a><span id="l12.480" class="difflineminus">-    for (i = 0; i &lt; rawData.length; i++) {</span>
<a href="#l12.481"></a><span id="l12.481" class="difflineminus">-      var row = $(&quot;&lt;tr&gt;&lt;/tr&gt;&quot;);</span>
<a href="#l12.482"></a><span id="l12.482" class="difflineminus">-      for (j = 0; j &lt; columnNames.length; j++) {</span>
<a href="#l12.483"></a><span id="l12.483" class="difflineminus">-        row.append($(&quot;&lt;td&gt;&lt;/td&gt;&quot;).html(rawData[i][propertyNames[j]]));</span>
<a href="#l12.484"></a><span id="l12.484" class="difflineminus">-      }</span>
<a href="#l12.485"></a><span id="l12.485" class="difflineminus">-      $(&quot;#raw-data-table&quot;).append(row);</span>
<a href="#l12.486"></a><span id="l12.486" class="difflineminus">-    }</span>
<a href="#l12.487"></a><span id="l12.487" class="difflineminus">-  });</span>
<a href="#l12.488"></a><span id="l12.488" class="difflineminus">-</span>
<a href="#l12.489"></a><span id="l12.489" class="difflineminus">-}</span>
<a href="#l12.490"></a><span id="l12.490" class="difflineminus">-</span>
<a href="#l12.491"></a><span id="l12.491" class="difflineminus">-function showQuitUi() {</span>
<a href="#l12.492"></a><span id="l12.492" class="difflineminus">-  $('#quit-ui').slideDown();</span>
<a href="#l12.493"></a><span id="l12.493" class="difflineminus">-  $(&quot;#main-experiment-ui&quot;).slideUp();</span>
<a href="#l12.494"></a><span id="l12.494" class="difflineminus">-  onQuitPageLoad();</span>
<a href="#l12.495"></a><span id="l12.495" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1">deleted file mode 100644</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/feedback-browser.xul</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineplus">+++ /dev/null</span>
<a href="#l13.4"></a><span id="l13.4" class="difflineat">@@ -1,88 +0,0 @@</span>
<a href="#l13.5"></a><span id="l13.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l13.6"></a><span id="l13.6" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l13.7"></a><span id="l13.7" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l13.8"></a><span id="l13.8" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l13.9"></a><span id="l13.9" class="difflineminus">-</span>
<a href="#l13.10"></a><span id="l13.10" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://testpilot/content/browser.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l13.11"></a><span id="l13.11" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://testpilot-os/skin/feedback.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineminus">-&lt;!DOCTYPE overlay [</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineminus">-  &lt;!ENTITY % testpilotDTD SYSTEM &quot;chrome://testpilot/locale/main.dtd&quot;&gt;</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineminus">-    %testpilotDTD;</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineminus">-]&gt;</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineminus">-</span>
<a href="#l13.18"></a><span id="l13.18" class="difflineminus">-&lt;overlay xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineminus">-&lt;menupopup id=&quot;menu_ToolsPopup&quot;&gt;</span>
<a href="#l13.20"></a><span id="l13.20" class="difflineminus">-  &lt;menu id=&quot;pilot-menu&quot; insertafter=&quot;menu_openAddons&quot; /&gt;</span>
<a href="#l13.21"></a><span id="l13.21" class="difflineminus">-&lt;/menupopup&gt;</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineminus">-&lt;menupopup id=&quot;taskPopup&quot;&gt;</span>
<a href="#l13.23"></a><span id="l13.23" class="difflineminus">-  &lt;menu id=&quot;pilot-menu&quot; insertafter=&quot;addonsManager&quot; /&gt;</span>
<a href="#l13.24"></a><span id="l13.24" class="difflineminus">-&lt;/menupopup&gt;</span>
<a href="#l13.25"></a><span id="l13.25" class="difflineminus">-</span>
<a href="#l13.26"></a><span id="l13.26" class="difflineminus">-&lt;toolbar id=&quot;nav-bar&quot;&gt;</span>
<a href="#l13.27"></a><span id="l13.27" class="difflineminus">-  &lt;panel id=&quot;pilot-notification-popup&quot;/&gt;</span>
<a href="#l13.28"></a><span id="l13.28" class="difflineminus">-&lt;/toolbar&gt;</span>
<a href="#l13.29"></a><span id="l13.29" class="difflineminus">-&lt;!-- XXX Disabled until we're ready for the feedback button.</span>
<a href="#l13.30"></a><span id="l13.30" class="difflineminus">-&lt;toolbar id=&quot;mail-bar3&quot;&gt;</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineminus">-  &lt;panel id=&quot;pilot-notification-popup&quot;/&gt;</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineminus">-&lt;/toolbar&gt;</span>
<a href="#l13.33"></a><span id="l13.33" class="difflineminus">---&gt;</span>
<a href="#l13.34"></a><span id="l13.34" class="difflineminus">-</span>
<a href="#l13.35"></a><span id="l13.35" class="difflineminus">-</span>
<a href="#l13.36"></a><span id="l13.36" class="difflineminus">-&lt;panel id=&quot;pilot-notification-popup&quot; hidden=&quot;true&quot; noautofocus=&quot;true&quot;</span>
<a href="#l13.37"></a><span id="l13.37" class="difflineminus">-  level=&quot;parent&quot; position=&quot;after_start&quot;&gt;</span>
<a href="#l13.38"></a><span id="l13.38" class="difflineminus">-  &lt;vbox class=&quot;pilot-notification-popup-container&quot;&gt;</span>
<a href="#l13.39"></a><span id="l13.39" class="difflineminus">-    &lt;hbox class=&quot;pilot-notification-toprow&quot;&gt;</span>
<a href="#l13.40"></a><span id="l13.40" class="difflineminus">-      &lt;image id=&quot;pilot-notification-icon&quot; /&gt;</span>
<a href="#l13.41"></a><span id="l13.41" class="difflineminus">-      &lt;vbox pack=&quot;center&quot;&gt;</span>
<a href="#l13.42"></a><span id="l13.42" class="difflineminus">-        &lt;label id=&quot;pilot-notification-title&quot; class=&quot;pilot-title&quot; /&gt;</span>
<a href="#l13.43"></a><span id="l13.43" class="difflineminus">-      &lt;/vbox&gt;</span>
<a href="#l13.44"></a><span id="l13.44" class="difflineminus">-      &lt;spacer flex=&quot;1&quot; /&gt;</span>
<a href="#l13.45"></a><span id="l13.45" class="difflineminus">-      &lt;vbox pack=&quot;start&quot;&gt;</span>
<a href="#l13.46"></a><span id="l13.46" class="difflineminus">-        &lt;image id=&quot;pilot-notification-close&quot;</span>
<a href="#l13.47"></a><span id="l13.47" class="difflineminus">-          tooltiptext=&quot;&amp;testpilot.notification.close.tooltip;&quot; /&gt;</span>
<a href="#l13.48"></a><span id="l13.48" class="difflineminus">-      &lt;/vbox&gt;</span>
<a href="#l13.49"></a><span id="l13.49" class="difflineminus">-    &lt;/hbox&gt;</span>
<a href="#l13.50"></a><span id="l13.50" class="difflineminus">-    &lt;description id=&quot;pilot-notification-text&quot; /&gt;</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineminus">-    &lt;hbox align=&quot;right&quot;&gt;&lt;label id=&quot;pilot-notification-link&quot; /&gt;&lt;/hbox&gt;</span>
<a href="#l13.52"></a><span id="l13.52" class="difflineminus">-    &lt;hbox&gt;</span>
<a href="#l13.53"></a><span id="l13.53" class="difflineminus">-      &lt;checkbox id=&quot;pilot-notification-always-submit-checkbox&quot;</span>
<a href="#l13.54"></a><span id="l13.54" class="difflineminus">-        label=&quot;&amp;testpilot.settings.alwaysSubmitData.shortLabel;&quot; /&gt;</span>
<a href="#l13.55"></a><span id="l13.55" class="difflineminus">-      &lt;spacer flex=&quot;1&quot; /&gt;</span>
<a href="#l13.56"></a><span id="l13.56" class="difflineminus">-    &lt;/hbox&gt;</span>
<a href="#l13.57"></a><span id="l13.57" class="difflineminus">-    &lt;hbox align=&quot;right&quot;&gt;</span>
<a href="#l13.58"></a><span id="l13.58" class="difflineminus">-      &lt;button id=&quot;pilot-notification-submit&quot; /&gt;</span>
<a href="#l13.59"></a><span id="l13.59" class="difflineminus">-    &lt;/hbox&gt;</span>
<a href="#l13.60"></a><span id="l13.60" class="difflineminus">-  &lt;/vbox&gt;</span>
<a href="#l13.61"></a><span id="l13.61" class="difflineminus">-&lt;/panel&gt;</span>
<a href="#l13.62"></a><span id="l13.62" class="difflineminus">-</span>
<a href="#l13.63"></a><span id="l13.63" class="difflineminus">-&lt;menu id=&quot;pilot-menu&quot; class=&quot;menu-iconic&quot;</span>
<a href="#l13.64"></a><span id="l13.64" class="difflineminus">-      label=&quot;&amp;testpilot.feedbackbutton.label;&quot;</span>
<a href="#l13.65"></a><span id="l13.65" class="difflineminus">-      insertafter=&quot;addonsManager&quot;&gt;</span>
<a href="#l13.66"></a><span id="l13.66" class="difflineminus">-  &lt;menupopup id=&quot;pilot-menu-popup&quot;</span>
<a href="#l13.67"></a><span id="l13.67" class="difflineminus">-             onpopupshowing=&quot;TestPilotMenuUtils.onPopupShowing(event);&quot;</span>
<a href="#l13.68"></a><span id="l13.68" class="difflineminus">-             onpopuphiding=&quot;TestPilotMenuUtils.onPopupHiding(event);&quot;&gt;</span>
<a href="#l13.69"></a><span id="l13.69" class="difflineminus">-&lt;!-- XXX Disabled until we're ready for the feedback button.</span>
<a href="#l13.70"></a><span id="l13.70" class="difflineminus">-    &lt;menuitem id=&quot;feedback-menu-happy-button&quot;</span>
<a href="#l13.71"></a><span id="l13.71" class="difflineminus">-              class=&quot;menuitem-iconic&quot;</span>
<a href="#l13.72"></a><span id="l13.72" class="difflineminus">-              image=&quot;chrome://testpilot-os/skin/feedback-smile-16x16.png&quot;</span>
<a href="#l13.73"></a><span id="l13.73" class="difflineminus">-              label=&quot;&amp;testpilot.happy.label;&quot;</span>
<a href="#l13.74"></a><span id="l13.74" class="difflineminus">-              thunderbirdLabel=&quot;&amp;testpilot.happy.thunderbirdLabel;&quot;</span>
<a href="#l13.75"></a><span id="l13.75" class="difflineminus">-              oncommand=&quot;TestPilotWindowUtils.openFeedbackPage('happy');&quot;/&gt;</span>
<a href="#l13.76"></a><span id="l13.76" class="difflineminus">-    &lt;menuitem id=&quot;feedback-menu-sad-button&quot;</span>
<a href="#l13.77"></a><span id="l13.77" class="difflineminus">-              class=&quot;menuitem-iconic&quot;</span>
<a href="#l13.78"></a><span id="l13.78" class="difflineminus">-              image=&quot;chrome://testpilot-os/skin/feedback-frown-16x16.png&quot;</span>
<a href="#l13.79"></a><span id="l13.79" class="difflineminus">-              label=&quot;&amp;testpilot.sad.label;&quot;</span>
<a href="#l13.80"></a><span id="l13.80" class="difflineminus">-              thunderbirdLabel=&quot;&amp;testpilot.sad.thunderbirdLabel;&quot;</span>
<a href="#l13.81"></a><span id="l13.81" class="difflineminus">-              oncommand=&quot;TestPilotWindowUtils.openFeedbackPage('sad');&quot;/&gt;</span>
<a href="#l13.82"></a><span id="l13.82" class="difflineminus">-    &lt;menuseparator/&gt;</span>
<a href="#l13.83"></a><span id="l13.83" class="difflineminus">---&gt;</span>
<a href="#l13.84"></a><span id="l13.84" class="difflineminus">-    &lt;menuitem id=&quot;feedback-menu-show-studies&quot;</span>
<a href="#l13.85"></a><span id="l13.85" class="difflineminus">-              label=&quot;&amp;testpilot.allYourStudies.label;&quot;</span>
<a href="#l13.86"></a><span id="l13.86" class="difflineminus">-              oncommand=&quot;TestPilotWindowUtils.openAllStudiesWindow();&quot;/&gt;</span>
<a href="#l13.87"></a><span id="l13.87" class="difflineminus">-    &lt;menuitem id=&quot;feedback-menu-enable-studies&quot; </span>
<a href="#l13.88"></a><span id="l13.88" class="difflineminus">-              label=&quot;&amp;testpilot.enable.label;&quot;</span>
<a href="#l13.89"></a><span id="l13.89" class="difflineminus">-              oncommand=&quot;TestPilotMenuUtils.togglePref('runStudies');&quot;/&gt;</span>
<a href="#l13.90"></a><span id="l13.90" class="difflineminus">-  &lt;/menupopup&gt;</span>
<a href="#l13.91"></a><span id="l13.91" class="difflineminus">-&lt;/menu&gt;</span>
<a href="#l13.92"></a><span id="l13.92" class="difflineminus">-&lt;/overlay&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1">deleted file mode 100644</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/fennec-options.xul</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineplus">+++ /dev/null</span>
<a href="#l14.4"></a><span id="l14.4" class="difflineat">@@ -1,17 +0,0 @@</span>
<a href="#l14.5"></a><span id="l14.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l14.6"></a><span id="l14.6" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l14.7"></a><span id="l14.7" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l14.8"></a><span id="l14.8" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l14.9"></a><span id="l14.9" class="difflineminus">-</span>
<a href="#l14.10"></a><span id="l14.10" class="difflineminus">-</span>
<a href="#l14.11"></a><span id="l14.11" class="difflineminus">-&lt;vbox xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-  &lt;setting pref=&quot;extensions.testpilot.runStudies&quot; type=&quot;bool&quot; title=&quot;Run User Studies&quot;/&gt;</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineminus">-  &lt;setting pref=&quot;extensions.testpilot.alwaysSubmitData&quot; type=&quot;bool&quot; title=&quot;Automatically Submit&quot;&gt;</span>
<a href="#l14.14"></a><span id="l14.14" class="difflineminus">-    Data from finished studies will be submitted without asking you each time.</span>
<a href="#l14.15"></a><span id="l14.15" class="difflineminus">-  &lt;/setting&gt;</span>
<a href="#l14.16"></a><span id="l14.16" class="difflineminus">-  &lt;setting title=&quot;Test Pilot Studies&quot; type=&quot;control&quot;&gt;</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineminus">-    See all Test Pilot studies currently running</span>
<a href="#l14.18"></a><span id="l14.18" class="difflineminus">-    &lt;button id=&quot;see-all-studies-button&quot; label=&quot;See All Studies&quot;</span>
<a href="#l14.19"></a><span id="l14.19" class="difflineminus">-            oncommand=&quot;TestPilotWindowUtils.openAllStudies();&quot;/&gt;</span>
<a href="#l14.20"></a><span id="l14.20" class="difflineminus">-  &lt;/setting&gt;</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineminus">-&lt;/vbox&gt;</span>
<a href="#l14.22"></a><span id="l14.22">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1">deleted file mode 100644</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.colorhelpers.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineplus">+++ /dev/null</span>
<a href="#l15.4"></a><span id="l15.4" class="difflineat">@@ -1,174 +0,0 @@</span>
<a href="#l15.5"></a><span id="l15.5" class="difflineminus">-/* Plugin for jQuery for working with colors.</span>
<a href="#l15.6"></a><span id="l15.6" class="difflineminus">- * </span>
<a href="#l15.7"></a><span id="l15.7" class="difflineminus">- * Version 1.0.</span>
<a href="#l15.8"></a><span id="l15.8" class="difflineminus">- * </span>
<a href="#l15.9"></a><span id="l15.9" class="difflineminus">- * Inspiration from jQuery color animation plugin by John Resig.</span>
<a href="#l15.10"></a><span id="l15.10" class="difflineminus">- *</span>
<a href="#l15.11"></a><span id="l15.11" class="difflineminus">- * Released under the MIT license by Ole Laursen, October 2009.</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">- *</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">- * Examples:</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineminus">- *</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">- *   $.color.parse(&quot;#fff&quot;).scale('rgb', 0.25).add('a', -0.5).toString()</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineminus">- *   var c = $.color.extract($(&quot;#mydiv&quot;), 'background-color');</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineminus">- *   console.log(c.r, c.g, c.b, c.a);</span>
<a href="#l15.18"></a><span id="l15.18" class="difflineminus">- *   $.color.make(100, 50, 25, 0.4).toString() // returns &quot;rgba(100,50,25,0.4)&quot;</span>
<a href="#l15.19"></a><span id="l15.19" class="difflineminus">- *</span>
<a href="#l15.20"></a><span id="l15.20" class="difflineminus">- * Note that .scale() and .add() work in-place instead of returning</span>
<a href="#l15.21"></a><span id="l15.21" class="difflineminus">- * new objects.</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineminus">- */ </span>
<a href="#l15.23"></a><span id="l15.23" class="difflineminus">-</span>
<a href="#l15.24"></a><span id="l15.24" class="difflineminus">-(function() {</span>
<a href="#l15.25"></a><span id="l15.25" class="difflineminus">-    jQuery.color = {};</span>
<a href="#l15.26"></a><span id="l15.26" class="difflineminus">-</span>
<a href="#l15.27"></a><span id="l15.27" class="difflineminus">-    // construct color object with some convenient chainable helpers</span>
<a href="#l15.28"></a><span id="l15.28" class="difflineminus">-    jQuery.color.make = function (r, g, b, a) {</span>
<a href="#l15.29"></a><span id="l15.29" class="difflineminus">-        var o = {};</span>
<a href="#l15.30"></a><span id="l15.30" class="difflineminus">-        o.r = r || 0;</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineminus">-        o.g = g || 0;</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineminus">-        o.b = b || 0;</span>
<a href="#l15.33"></a><span id="l15.33" class="difflineminus">-        o.a = a != null ? a : 1;</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineminus">-</span>
<a href="#l15.35"></a><span id="l15.35" class="difflineminus">-        o.add = function (c, d) {</span>
<a href="#l15.36"></a><span id="l15.36" class="difflineminus">-            for (var i = 0; i &lt; c.length; ++i)</span>
<a href="#l15.37"></a><span id="l15.37" class="difflineminus">-                o[c.charAt(i)] += d;</span>
<a href="#l15.38"></a><span id="l15.38" class="difflineminus">-            return o.normalize();</span>
<a href="#l15.39"></a><span id="l15.39" class="difflineminus">-        };</span>
<a href="#l15.40"></a><span id="l15.40" class="difflineminus">-        </span>
<a href="#l15.41"></a><span id="l15.41" class="difflineminus">-        o.scale = function (c, f) {</span>
<a href="#l15.42"></a><span id="l15.42" class="difflineminus">-            for (var i = 0; i &lt; c.length; ++i)</span>
<a href="#l15.43"></a><span id="l15.43" class="difflineminus">-                o[c.charAt(i)] *= f;</span>
<a href="#l15.44"></a><span id="l15.44" class="difflineminus">-            return o.normalize();</span>
<a href="#l15.45"></a><span id="l15.45" class="difflineminus">-        };</span>
<a href="#l15.46"></a><span id="l15.46" class="difflineminus">-        </span>
<a href="#l15.47"></a><span id="l15.47" class="difflineminus">-        o.toString = function () {</span>
<a href="#l15.48"></a><span id="l15.48" class="difflineminus">-            if (o.a &gt;= 1.0) {</span>
<a href="#l15.49"></a><span id="l15.49" class="difflineminus">-                return &quot;rgb(&quot;+[o.r, o.g, o.b].join(&quot;,&quot;)+&quot;)&quot;;</span>
<a href="#l15.50"></a><span id="l15.50" class="difflineminus">-            } else {</span>
<a href="#l15.51"></a><span id="l15.51" class="difflineminus">-                return &quot;rgba(&quot;+[o.r, o.g, o.b, o.a].join(&quot;,&quot;)+&quot;)&quot;;</span>
<a href="#l15.52"></a><span id="l15.52" class="difflineminus">-            }</span>
<a href="#l15.53"></a><span id="l15.53" class="difflineminus">-        };</span>
<a href="#l15.54"></a><span id="l15.54" class="difflineminus">-</span>
<a href="#l15.55"></a><span id="l15.55" class="difflineminus">-        o.normalize = function () {</span>
<a href="#l15.56"></a><span id="l15.56" class="difflineminus">-            function clamp(min, value, max) {</span>
<a href="#l15.57"></a><span id="l15.57" class="difflineminus">-                return value &lt; min ? min: (value &gt; max ? max: value);</span>
<a href="#l15.58"></a><span id="l15.58" class="difflineminus">-            }</span>
<a href="#l15.59"></a><span id="l15.59" class="difflineminus">-            </span>
<a href="#l15.60"></a><span id="l15.60" class="difflineminus">-            o.r = clamp(0, parseInt(o.r), 255);</span>
<a href="#l15.61"></a><span id="l15.61" class="difflineminus">-            o.g = clamp(0, parseInt(o.g), 255);</span>
<a href="#l15.62"></a><span id="l15.62" class="difflineminus">-            o.b = clamp(0, parseInt(o.b), 255);</span>
<a href="#l15.63"></a><span id="l15.63" class="difflineminus">-            o.a = clamp(0, o.a, 1);</span>
<a href="#l15.64"></a><span id="l15.64" class="difflineminus">-            return o;</span>
<a href="#l15.65"></a><span id="l15.65" class="difflineminus">-        };</span>
<a href="#l15.66"></a><span id="l15.66" class="difflineminus">-</span>
<a href="#l15.67"></a><span id="l15.67" class="difflineminus">-        o.clone = function () {</span>
<a href="#l15.68"></a><span id="l15.68" class="difflineminus">-            return jQuery.color.make(o.r, o.b, o.g, o.a);</span>
<a href="#l15.69"></a><span id="l15.69" class="difflineminus">-        };</span>
<a href="#l15.70"></a><span id="l15.70" class="difflineminus">-</span>
<a href="#l15.71"></a><span id="l15.71" class="difflineminus">-        return o.normalize();</span>
<a href="#l15.72"></a><span id="l15.72" class="difflineminus">-    }</span>
<a href="#l15.73"></a><span id="l15.73" class="difflineminus">-</span>
<a href="#l15.74"></a><span id="l15.74" class="difflineminus">-    // extract CSS color property from element, going up in the DOM</span>
<a href="#l15.75"></a><span id="l15.75" class="difflineminus">-    // if it's &quot;transparent&quot;</span>
<a href="#l15.76"></a><span id="l15.76" class="difflineminus">-    jQuery.color.extract = function (elem, css) {</span>
<a href="#l15.77"></a><span id="l15.77" class="difflineminus">-        var c;</span>
<a href="#l15.78"></a><span id="l15.78" class="difflineminus">-        do {</span>
<a href="#l15.79"></a><span id="l15.79" class="difflineminus">-            c = elem.css(css).toLowerCase();</span>
<a href="#l15.80"></a><span id="l15.80" class="difflineminus">-            // keep going until we find an element that has color, or</span>
<a href="#l15.81"></a><span id="l15.81" class="difflineminus">-            // we hit the body</span>
<a href="#l15.82"></a><span id="l15.82" class="difflineminus">-            if (c != '' &amp;&amp; c != 'transparent')</span>
<a href="#l15.83"></a><span id="l15.83" class="difflineminus">-                break;</span>
<a href="#l15.84"></a><span id="l15.84" class="difflineminus">-            elem = elem.parent();</span>
<a href="#l15.85"></a><span id="l15.85" class="difflineminus">-        } while (!jQuery.nodeName(elem.get(0), &quot;body&quot;));</span>
<a href="#l15.86"></a><span id="l15.86" class="difflineminus">-</span>
<a href="#l15.87"></a><span id="l15.87" class="difflineminus">-        // catch Safari's way of signalling transparent</span>
<a href="#l15.88"></a><span id="l15.88" class="difflineminus">-        if (c == &quot;rgba(0, 0, 0, 0)&quot;)</span>
<a href="#l15.89"></a><span id="l15.89" class="difflineminus">-            c = &quot;transparent&quot;;</span>
<a href="#l15.90"></a><span id="l15.90" class="difflineminus">-        </span>
<a href="#l15.91"></a><span id="l15.91" class="difflineminus">-        return jQuery.color.parse(c);</span>
<a href="#l15.92"></a><span id="l15.92" class="difflineminus">-    }</span>
<a href="#l15.93"></a><span id="l15.93" class="difflineminus">-    </span>
<a href="#l15.94"></a><span id="l15.94" class="difflineminus">-    // parse CSS color string (like &quot;rgb(10, 32, 43)&quot; or &quot;#fff&quot;),</span>
<a href="#l15.95"></a><span id="l15.95" class="difflineminus">-    // returns color object</span>
<a href="#l15.96"></a><span id="l15.96" class="difflineminus">-    jQuery.color.parse = function (str) {</span>
<a href="#l15.97"></a><span id="l15.97" class="difflineminus">-        var res, m = jQuery.color.make;</span>
<a href="#l15.98"></a><span id="l15.98" class="difflineminus">-</span>
<a href="#l15.99"></a><span id="l15.99" class="difflineminus">-        // Look for rgb(num,num,num)</span>
<a href="#l15.100"></a><span id="l15.100" class="difflineminus">-        if (res = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(str))</span>
<a href="#l15.101"></a><span id="l15.101" class="difflineminus">-            return m(parseInt(res[1], 10), parseInt(res[2], 10), parseInt(res[3], 10));</span>
<a href="#l15.102"></a><span id="l15.102" class="difflineminus">-        </span>
<a href="#l15.103"></a><span id="l15.103" class="difflineminus">-        // Look for rgba(num,num,num,num)</span>
<a href="#l15.104"></a><span id="l15.104" class="difflineminus">-        if (res = /rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(str))</span>
<a href="#l15.105"></a><span id="l15.105" class="difflineminus">-            return m(parseInt(res[1], 10), parseInt(res[2], 10), parseInt(res[3], 10), parseFloat(res[4]));</span>
<a href="#l15.106"></a><span id="l15.106" class="difflineminus">-            </span>
<a href="#l15.107"></a><span id="l15.107" class="difflineminus">-        // Look for rgb(num%,num%,num%)</span>
<a href="#l15.108"></a><span id="l15.108" class="difflineminus">-        if (res = /rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(str))</span>
<a href="#l15.109"></a><span id="l15.109" class="difflineminus">-            return m(parseFloat(res[1])*2.55, parseFloat(res[2])*2.55, parseFloat(res[3])*2.55);</span>
<a href="#l15.110"></a><span id="l15.110" class="difflineminus">-</span>
<a href="#l15.111"></a><span id="l15.111" class="difflineminus">-        // Look for rgba(num%,num%,num%,num)</span>
<a href="#l15.112"></a><span id="l15.112" class="difflineminus">-        if (res = /rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(str))</span>
<a href="#l15.113"></a><span id="l15.113" class="difflineminus">-            return m(parseFloat(res[1])*2.55, parseFloat(res[2])*2.55, parseFloat(res[3])*2.55, parseFloat(res[4]));</span>
<a href="#l15.114"></a><span id="l15.114" class="difflineminus">-        </span>
<a href="#l15.115"></a><span id="l15.115" class="difflineminus">-        // Look for #a0b1c2</span>
<a href="#l15.116"></a><span id="l15.116" class="difflineminus">-        if (res = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(str))</span>
<a href="#l15.117"></a><span id="l15.117" class="difflineminus">-            return m(parseInt(res[1], 16), parseInt(res[2], 16), parseInt(res[3], 16));</span>
<a href="#l15.118"></a><span id="l15.118" class="difflineminus">-</span>
<a href="#l15.119"></a><span id="l15.119" class="difflineminus">-        // Look for #fff</span>
<a href="#l15.120"></a><span id="l15.120" class="difflineminus">-        if (res = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(str))</span>
<a href="#l15.121"></a><span id="l15.121" class="difflineminus">-            return m(parseInt(res[1]+res[1], 16), parseInt(res[2]+res[2], 16), parseInt(res[3]+res[3], 16));</span>
<a href="#l15.122"></a><span id="l15.122" class="difflineminus">-</span>
<a href="#l15.123"></a><span id="l15.123" class="difflineminus">-        // Otherwise, we're most likely dealing with a named color</span>
<a href="#l15.124"></a><span id="l15.124" class="difflineminus">-        var name = jQuery.trim(str).toLowerCase();</span>
<a href="#l15.125"></a><span id="l15.125" class="difflineminus">-        if (name == &quot;transparent&quot;)</span>
<a href="#l15.126"></a><span id="l15.126" class="difflineminus">-            return m(255, 255, 255, 0);</span>
<a href="#l15.127"></a><span id="l15.127" class="difflineminus">-        else {</span>
<a href="#l15.128"></a><span id="l15.128" class="difflineminus">-            res = lookupColors[name];</span>
<a href="#l15.129"></a><span id="l15.129" class="difflineminus">-            return m(res[0], res[1], res[2]);</span>
<a href="#l15.130"></a><span id="l15.130" class="difflineminus">-        }</span>
<a href="#l15.131"></a><span id="l15.131" class="difflineminus">-    }</span>
<a href="#l15.132"></a><span id="l15.132" class="difflineminus">-    </span>
<a href="#l15.133"></a><span id="l15.133" class="difflineminus">-    var lookupColors = {</span>
<a href="#l15.134"></a><span id="l15.134" class="difflineminus">-        aqua:[0,255,255],</span>
<a href="#l15.135"></a><span id="l15.135" class="difflineminus">-        azure:[240,255,255],</span>
<a href="#l15.136"></a><span id="l15.136" class="difflineminus">-        beige:[245,245,220],</span>
<a href="#l15.137"></a><span id="l15.137" class="difflineminus">-        black:[0,0,0],</span>
<a href="#l15.138"></a><span id="l15.138" class="difflineminus">-        blue:[0,0,255],</span>
<a href="#l15.139"></a><span id="l15.139" class="difflineminus">-        brown:[165,42,42],</span>
<a href="#l15.140"></a><span id="l15.140" class="difflineminus">-        cyan:[0,255,255],</span>
<a href="#l15.141"></a><span id="l15.141" class="difflineminus">-        darkblue:[0,0,139],</span>
<a href="#l15.142"></a><span id="l15.142" class="difflineminus">-        darkcyan:[0,139,139],</span>
<a href="#l15.143"></a><span id="l15.143" class="difflineminus">-        darkgrey:[169,169,169],</span>
<a href="#l15.144"></a><span id="l15.144" class="difflineminus">-        darkgreen:[0,100,0],</span>
<a href="#l15.145"></a><span id="l15.145" class="difflineminus">-        darkkhaki:[189,183,107],</span>
<a href="#l15.146"></a><span id="l15.146" class="difflineminus">-        darkmagenta:[139,0,139],</span>
<a href="#l15.147"></a><span id="l15.147" class="difflineminus">-        darkolivegreen:[85,107,47],</span>
<a href="#l15.148"></a><span id="l15.148" class="difflineminus">-        darkorange:[255,140,0],</span>
<a href="#l15.149"></a><span id="l15.149" class="difflineminus">-        darkorchid:[153,50,204],</span>
<a href="#l15.150"></a><span id="l15.150" class="difflineminus">-        darkred:[139,0,0],</span>
<a href="#l15.151"></a><span id="l15.151" class="difflineminus">-        darksalmon:[233,150,122],</span>
<a href="#l15.152"></a><span id="l15.152" class="difflineminus">-        darkviolet:[148,0,211],</span>
<a href="#l15.153"></a><span id="l15.153" class="difflineminus">-        fuchsia:[255,0,255],</span>
<a href="#l15.154"></a><span id="l15.154" class="difflineminus">-        gold:[255,215,0],</span>
<a href="#l15.155"></a><span id="l15.155" class="difflineminus">-        green:[0,128,0],</span>
<a href="#l15.156"></a><span id="l15.156" class="difflineminus">-        indigo:[75,0,130],</span>
<a href="#l15.157"></a><span id="l15.157" class="difflineminus">-        khaki:[240,230,140],</span>
<a href="#l15.158"></a><span id="l15.158" class="difflineminus">-        lightblue:[173,216,230],</span>
<a href="#l15.159"></a><span id="l15.159" class="difflineminus">-        lightcyan:[224,255,255],</span>
<a href="#l15.160"></a><span id="l15.160" class="difflineminus">-        lightgreen:[144,238,144],</span>
<a href="#l15.161"></a><span id="l15.161" class="difflineminus">-        lightgrey:[211,211,211],</span>
<a href="#l15.162"></a><span id="l15.162" class="difflineminus">-        lightpink:[255,182,193],</span>
<a href="#l15.163"></a><span id="l15.163" class="difflineminus">-        lightyellow:[255,255,224],</span>
<a href="#l15.164"></a><span id="l15.164" class="difflineminus">-        lime:[0,255,0],</span>
<a href="#l15.165"></a><span id="l15.165" class="difflineminus">-        magenta:[255,0,255],</span>
<a href="#l15.166"></a><span id="l15.166" class="difflineminus">-        maroon:[128,0,0],</span>
<a href="#l15.167"></a><span id="l15.167" class="difflineminus">-        navy:[0,0,128],</span>
<a href="#l15.168"></a><span id="l15.168" class="difflineminus">-        olive:[128,128,0],</span>
<a href="#l15.169"></a><span id="l15.169" class="difflineminus">-        orange:[255,165,0],</span>
<a href="#l15.170"></a><span id="l15.170" class="difflineminus">-        pink:[255,192,203],</span>
<a href="#l15.171"></a><span id="l15.171" class="difflineminus">-        purple:[128,0,128],</span>
<a href="#l15.172"></a><span id="l15.172" class="difflineminus">-        violet:[128,0,128],</span>
<a href="#l15.173"></a><span id="l15.173" class="difflineminus">-        red:[255,0,0],</span>
<a href="#l15.174"></a><span id="l15.174" class="difflineminus">-        silver:[192,192,192],</span>
<a href="#l15.175"></a><span id="l15.175" class="difflineminus">-        white:[255,255,255],</span>
<a href="#l15.176"></a><span id="l15.176" class="difflineminus">-        yellow:[255,255,0]</span>
<a href="#l15.177"></a><span id="l15.177" class="difflineminus">-    };    </span>
<a href="#l15.178"></a><span id="l15.178" class="difflineminus">-})();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1">deleted file mode 100644</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.flot.crosshair.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineplus">+++ /dev/null</span>
<a href="#l16.4"></a><span id="l16.4" class="difflineat">@@ -1,160 +0,0 @@</span>
<a href="#l16.5"></a><span id="l16.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l16.6"></a><span id="l16.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l16.7"></a><span id="l16.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l16.8"></a><span id="l16.8" class="difflineminus">-</span>
<a href="#l16.9"></a><span id="l16.9" class="difflineminus">-/*</span>
<a href="#l16.10"></a><span id="l16.10" class="difflineminus">-Flot plugin for showing a crosshair, thin lines, when the mouse hovers</span>
<a href="#l16.11"></a><span id="l16.11" class="difflineminus">-over the plot.</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineminus">-  crosshair: {</span>
<a href="#l16.14"></a><span id="l16.14" class="difflineminus">-    mode: null or &quot;x&quot; or &quot;y&quot; or &quot;xy&quot;</span>
<a href="#l16.15"></a><span id="l16.15" class="difflineminus">-    color: color</span>
<a href="#l16.16"></a><span id="l16.16" class="difflineminus">-    lineWidth: number</span>
<a href="#l16.17"></a><span id="l16.17" class="difflineminus">-  }</span>
<a href="#l16.18"></a><span id="l16.18" class="difflineminus">-</span>
<a href="#l16.19"></a><span id="l16.19" class="difflineminus">-Set the mode to one of &quot;x&quot;, &quot;y&quot; or &quot;xy&quot;. The &quot;x&quot; mode enables a</span>
<a href="#l16.20"></a><span id="l16.20" class="difflineminus">-vertical crosshair that lets you trace the values on the x axis, &quot;y&quot;</span>
<a href="#l16.21"></a><span id="l16.21" class="difflineminus">-enables a horizontal crosshair and &quot;xy&quot; enables them both. &quot;color&quot; is</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineminus">-the color of the crosshair (default is &quot;rgba(170, 0, 0, 0.80)&quot;),</span>
<a href="#l16.23"></a><span id="l16.23" class="difflineminus">-&quot;lineWidth&quot; is the width of the drawn lines (default is 1).</span>
<a href="#l16.24"></a><span id="l16.24" class="difflineminus">-</span>
<a href="#l16.25"></a><span id="l16.25" class="difflineminus">-The plugin also adds four public methods:</span>
<a href="#l16.26"></a><span id="l16.26" class="difflineminus">-</span>
<a href="#l16.27"></a><span id="l16.27" class="difflineminus">-  - setCrosshair(pos)</span>
<a href="#l16.28"></a><span id="l16.28" class="difflineminus">-</span>
<a href="#l16.29"></a><span id="l16.29" class="difflineminus">-    Set the position of the crosshair. Note that this is cleared if</span>
<a href="#l16.30"></a><span id="l16.30" class="difflineminus">-    the user moves the mouse. &quot;pos&quot; should be on the form { x: xpos,</span>
<a href="#l16.31"></a><span id="l16.31" class="difflineminus">-    y: ypos } (or x2 and y2 if you're using the secondary axes), which</span>
<a href="#l16.32"></a><span id="l16.32" class="difflineminus">-    is coincidentally the same format as what you get from a &quot;plothover&quot;</span>
<a href="#l16.33"></a><span id="l16.33" class="difflineminus">-    event. If &quot;pos&quot; is null, the crosshair is cleared.</span>
<a href="#l16.34"></a><span id="l16.34" class="difflineminus">-</span>
<a href="#l16.35"></a><span id="l16.35" class="difflineminus">-  - clearCrosshair()</span>
<a href="#l16.36"></a><span id="l16.36" class="difflineminus">-</span>
<a href="#l16.37"></a><span id="l16.37" class="difflineminus">-    Clear the crosshair.</span>
<a href="#l16.38"></a><span id="l16.38" class="difflineminus">-</span>
<a href="#l16.39"></a><span id="l16.39" class="difflineminus">-  - lockCrosshair(pos)</span>
<a href="#l16.40"></a><span id="l16.40" class="difflineminus">-</span>
<a href="#l16.41"></a><span id="l16.41" class="difflineminus">-    Cause the crosshair to lock to the current location, no longer</span>
<a href="#l16.42"></a><span id="l16.42" class="difflineminus">-    updating if the user moves the mouse. Optionally supply a position</span>
<a href="#l16.43"></a><span id="l16.43" class="difflineminus">-    (passed on to setCrosshair()) to move it to.</span>
<a href="#l16.44"></a><span id="l16.44" class="difflineminus">-</span>
<a href="#l16.45"></a><span id="l16.45" class="difflineminus">-    Example usage:</span>
<a href="#l16.46"></a><span id="l16.46" class="difflineminus">-      var myFlot = $.plot( $(&quot;#graph&quot;), ..., { crosshair: { mode: &quot;x&quot; } } };</span>
<a href="#l16.47"></a><span id="l16.47" class="difflineminus">-      $(&quot;#graph&quot;).bind(&quot;plothover&quot;, function (evt, position, item) {</span>
<a href="#l16.48"></a><span id="l16.48" class="difflineminus">-        if (item) {</span>
<a href="#l16.49"></a><span id="l16.49" class="difflineminus">-          // Lock the crosshair to the data point being hovered</span>
<a href="#l16.50"></a><span id="l16.50" class="difflineminus">-          myFlot.lockCrosshair({ x: item.datapoint[0], y: item.datapoint[1] });</span>
<a href="#l16.51"></a><span id="l16.51" class="difflineminus">-        }</span>
<a href="#l16.52"></a><span id="l16.52" class="difflineminus">-        else {</span>
<a href="#l16.53"></a><span id="l16.53" class="difflineminus">-          // Return normal crosshair operation</span>
<a href="#l16.54"></a><span id="l16.54" class="difflineminus">-          myFlot.unlockCrosshair();</span>
<a href="#l16.55"></a><span id="l16.55" class="difflineminus">-        }</span>
<a href="#l16.56"></a><span id="l16.56" class="difflineminus">-      });</span>
<a href="#l16.57"></a><span id="l16.57" class="difflineminus">-</span>
<a href="#l16.58"></a><span id="l16.58" class="difflineminus">-  - unlockCrosshair()</span>
<a href="#l16.59"></a><span id="l16.59" class="difflineminus">-</span>
<a href="#l16.60"></a><span id="l16.60" class="difflineminus">-    Free the crosshair to move again after locking it.</span>
<a href="#l16.61"></a><span id="l16.61" class="difflineminus">-*/</span>
<a href="#l16.62"></a><span id="l16.62" class="difflineminus">-</span>
<a href="#l16.63"></a><span id="l16.63" class="difflineminus">-(function ($) {</span>
<a href="#l16.64"></a><span id="l16.64" class="difflineminus">-    var options = {</span>
<a href="#l16.65"></a><span id="l16.65" class="difflineminus">-        crosshair: {</span>
<a href="#l16.66"></a><span id="l16.66" class="difflineminus">-            mode: null, // one of null, &quot;x&quot;, &quot;y&quot; or &quot;xy&quot;,</span>
<a href="#l16.67"></a><span id="l16.67" class="difflineminus">-            color: &quot;rgba(170, 0, 0, 0.80)&quot;,</span>
<a href="#l16.68"></a><span id="l16.68" class="difflineminus">-            lineWidth: 1</span>
<a href="#l16.69"></a><span id="l16.69" class="difflineminus">-        }</span>
<a href="#l16.70"></a><span id="l16.70" class="difflineminus">-    };</span>
<a href="#l16.71"></a><span id="l16.71" class="difflineminus">-    </span>
<a href="#l16.72"></a><span id="l16.72" class="difflineminus">-    function init(plot) {</span>
<a href="#l16.73"></a><span id="l16.73" class="difflineminus">-        // position of crosshair in pixels</span>
<a href="#l16.74"></a><span id="l16.74" class="difflineminus">-        var crosshair = { x: -1, y: -1, locked: false };</span>
<a href="#l16.75"></a><span id="l16.75" class="difflineminus">-</span>
<a href="#l16.76"></a><span id="l16.76" class="difflineminus">-        plot.setCrosshair = function setCrosshair(pos) {</span>
<a href="#l16.77"></a><span id="l16.77" class="difflineminus">-            if (!pos)</span>
<a href="#l16.78"></a><span id="l16.78" class="difflineminus">-                crosshair.x = -1;</span>
<a href="#l16.79"></a><span id="l16.79" class="difflineminus">-            else {</span>
<a href="#l16.80"></a><span id="l16.80" class="difflineminus">-                var axes = plot.getAxes();</span>
<a href="#l16.81"></a><span id="l16.81" class="difflineminus">-                </span>
<a href="#l16.82"></a><span id="l16.82" class="difflineminus">-                crosshair.x = Math.max(0, Math.min(pos.x != null ? axes.xaxis.p2c(pos.x) : axes.x2axis.p2c(pos.x2), plot.width()));</span>
<a href="#l16.83"></a><span id="l16.83" class="difflineminus">-                crosshair.y = Math.max(0, Math.min(pos.y != null ? axes.yaxis.p2c(pos.y) : axes.y2axis.p2c(pos.y2), plot.height()));</span>
<a href="#l16.84"></a><span id="l16.84" class="difflineminus">-            }</span>
<a href="#l16.85"></a><span id="l16.85" class="difflineminus">-            </span>
<a href="#l16.86"></a><span id="l16.86" class="difflineminus">-            plot.triggerRedrawOverlay();</span>
<a href="#l16.87"></a><span id="l16.87" class="difflineminus">-        };</span>
<a href="#l16.88"></a><span id="l16.88" class="difflineminus">-        </span>
<a href="#l16.89"></a><span id="l16.89" class="difflineminus">-        plot.clearCrosshair = plot.setCrosshair; // passes null for pos</span>
<a href="#l16.90"></a><span id="l16.90" class="difflineminus">-        </span>
<a href="#l16.91"></a><span id="l16.91" class="difflineminus">-        plot.lockCrosshair = function lockCrosshair(pos) {</span>
<a href="#l16.92"></a><span id="l16.92" class="difflineminus">-            if (pos)</span>
<a href="#l16.93"></a><span id="l16.93" class="difflineminus">-                plot.setCrosshair(pos);</span>
<a href="#l16.94"></a><span id="l16.94" class="difflineminus">-            crosshair.locked = true;</span>
<a href="#l16.95"></a><span id="l16.95" class="difflineminus">-        }</span>
<a href="#l16.96"></a><span id="l16.96" class="difflineminus">-</span>
<a href="#l16.97"></a><span id="l16.97" class="difflineminus">-        plot.unlockCrosshair = function unlockCrosshair() {</span>
<a href="#l16.98"></a><span id="l16.98" class="difflineminus">-            crosshair.locked = false;</span>
<a href="#l16.99"></a><span id="l16.99" class="difflineminus">-        }</span>
<a href="#l16.100"></a><span id="l16.100" class="difflineminus">-</span>
<a href="#l16.101"></a><span id="l16.101" class="difflineminus">-        plot.hooks.bindEvents.push(function (plot, eventHolder) {</span>
<a href="#l16.102"></a><span id="l16.102" class="difflineminus">-            if (!plot.getOptions().crosshair.mode)</span>
<a href="#l16.103"></a><span id="l16.103" class="difflineminus">-                return;</span>
<a href="#l16.104"></a><span id="l16.104" class="difflineminus">-</span>
<a href="#l16.105"></a><span id="l16.105" class="difflineminus">-            eventHolder.mouseout(function () {</span>
<a href="#l16.106"></a><span id="l16.106" class="difflineminus">-                if (crosshair.x != -1) {</span>
<a href="#l16.107"></a><span id="l16.107" class="difflineminus">-                    crosshair.x = -1;</span>
<a href="#l16.108"></a><span id="l16.108" class="difflineminus">-                    plot.triggerRedrawOverlay();</span>
<a href="#l16.109"></a><span id="l16.109" class="difflineminus">-                }</span>
<a href="#l16.110"></a><span id="l16.110" class="difflineminus">-            });</span>
<a href="#l16.111"></a><span id="l16.111" class="difflineminus">-            </span>
<a href="#l16.112"></a><span id="l16.112" class="difflineminus">-            eventHolder.mousemove(function (e) {</span>
<a href="#l16.113"></a><span id="l16.113" class="difflineminus">-                if (plot.getSelection &amp;&amp; plot.getSelection()) {</span>
<a href="#l16.114"></a><span id="l16.114" class="difflineminus">-                    crosshair.x = -1; // hide the crosshair while selecting</span>
<a href="#l16.115"></a><span id="l16.115" class="difflineminus">-                    return;</span>
<a href="#l16.116"></a><span id="l16.116" class="difflineminus">-                }</span>
<a href="#l16.117"></a><span id="l16.117" class="difflineminus">-                </span>
<a href="#l16.118"></a><span id="l16.118" class="difflineminus">-                if (crosshair.locked)</span>
<a href="#l16.119"></a><span id="l16.119" class="difflineminus">-                    return;</span>
<a href="#l16.120"></a><span id="l16.120" class="difflineminus">-                </span>
<a href="#l16.121"></a><span id="l16.121" class="difflineminus">-                var offset = plot.offset();</span>
<a href="#l16.122"></a><span id="l16.122" class="difflineminus">-                crosshair.x = Math.max(0, Math.min(e.pageX - offset.left, plot.width()));</span>
<a href="#l16.123"></a><span id="l16.123" class="difflineminus">-                crosshair.y = Math.max(0, Math.min(e.pageY - offset.top, plot.height()));</span>
<a href="#l16.124"></a><span id="l16.124" class="difflineminus">-                plot.triggerRedrawOverlay();</span>
<a href="#l16.125"></a><span id="l16.125" class="difflineminus">-            });</span>
<a href="#l16.126"></a><span id="l16.126" class="difflineminus">-        });</span>
<a href="#l16.127"></a><span id="l16.127" class="difflineminus">-</span>
<a href="#l16.128"></a><span id="l16.128" class="difflineminus">-        plot.hooks.drawOverlay.push(function (plot, ctx) {</span>
<a href="#l16.129"></a><span id="l16.129" class="difflineminus">-            var c = plot.getOptions().crosshair;</span>
<a href="#l16.130"></a><span id="l16.130" class="difflineminus">-            if (!c.mode)</span>
<a href="#l16.131"></a><span id="l16.131" class="difflineminus">-                return;</span>
<a href="#l16.132"></a><span id="l16.132" class="difflineminus">-</span>
<a href="#l16.133"></a><span id="l16.133" class="difflineminus">-            var plotOffset = plot.getPlotOffset();</span>
<a href="#l16.134"></a><span id="l16.134" class="difflineminus">-            </span>
<a href="#l16.135"></a><span id="l16.135" class="difflineminus">-            ctx.save();</span>
<a href="#l16.136"></a><span id="l16.136" class="difflineminus">-            ctx.translate(plotOffset.left, plotOffset.top);</span>
<a href="#l16.137"></a><span id="l16.137" class="difflineminus">-</span>
<a href="#l16.138"></a><span id="l16.138" class="difflineminus">-            if (crosshair.x != -1) {</span>
<a href="#l16.139"></a><span id="l16.139" class="difflineminus">-                ctx.strokeStyle = c.color;</span>
<a href="#l16.140"></a><span id="l16.140" class="difflineminus">-                ctx.lineWidth = c.lineWidth;</span>
<a href="#l16.141"></a><span id="l16.141" class="difflineminus">-                ctx.lineJoin = &quot;round&quot;;</span>
<a href="#l16.142"></a><span id="l16.142" class="difflineminus">-</span>
<a href="#l16.143"></a><span id="l16.143" class="difflineminus">-                ctx.beginPath();</span>
<a href="#l16.144"></a><span id="l16.144" class="difflineminus">-                if (c.mode.indexOf(&quot;x&quot;) != -1) {</span>
<a href="#l16.145"></a><span id="l16.145" class="difflineminus">-                    ctx.moveTo(crosshair.x, 0);</span>
<a href="#l16.146"></a><span id="l16.146" class="difflineminus">-                    ctx.lineTo(crosshair.x, plot.height());</span>
<a href="#l16.147"></a><span id="l16.147" class="difflineminus">-                }</span>
<a href="#l16.148"></a><span id="l16.148" class="difflineminus">-                if (c.mode.indexOf(&quot;y&quot;) != -1) {</span>
<a href="#l16.149"></a><span id="l16.149" class="difflineminus">-                    ctx.moveTo(0, crosshair.y);</span>
<a href="#l16.150"></a><span id="l16.150" class="difflineminus">-                    ctx.lineTo(plot.width(), crosshair.y);</span>
<a href="#l16.151"></a><span id="l16.151" class="difflineminus">-                }</span>
<a href="#l16.152"></a><span id="l16.152" class="difflineminus">-                ctx.stroke();</span>
<a href="#l16.153"></a><span id="l16.153" class="difflineminus">-            }</span>
<a href="#l16.154"></a><span id="l16.154" class="difflineminus">-            ctx.restore();</span>
<a href="#l16.155"></a><span id="l16.155" class="difflineminus">-        });</span>
<a href="#l16.156"></a><span id="l16.156" class="difflineminus">-    }</span>
<a href="#l16.157"></a><span id="l16.157" class="difflineminus">-    </span>
<a href="#l16.158"></a><span id="l16.158" class="difflineminus">-    $.plot.plugins.push({</span>
<a href="#l16.159"></a><span id="l16.159" class="difflineminus">-        init: init,</span>
<a href="#l16.160"></a><span id="l16.160" class="difflineminus">-        options: options,</span>
<a href="#l16.161"></a><span id="l16.161" class="difflineminus">-        name: 'crosshair',</span>
<a href="#l16.162"></a><span id="l16.162" class="difflineminus">-        version: '1.0'</span>
<a href="#l16.163"></a><span id="l16.163" class="difflineminus">-    });</span>
<a href="#l16.164"></a><span id="l16.164" class="difflineminus">-})(jQuery);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1">deleted file mode 100644</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.flot.image.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineplus">+++ /dev/null</span>
<a href="#l17.4"></a><span id="l17.4" class="difflineat">@@ -1,241 +0,0 @@</span>
<a href="#l17.5"></a><span id="l17.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l17.6"></a><span id="l17.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l17.7"></a><span id="l17.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l17.8"></a><span id="l17.8" class="difflineminus">-</span>
<a href="#l17.9"></a><span id="l17.9" class="difflineminus">-/*</span>
<a href="#l17.10"></a><span id="l17.10" class="difflineminus">-Flot plugin for plotting images, e.g. useful for putting ticks on a</span>
<a href="#l17.11"></a><span id="l17.11" class="difflineminus">-prerendered complex visualization.</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineminus">-The data syntax is [[image, x1, y1, x2, y2], ...] where (x1, y1) and</span>
<a href="#l17.14"></a><span id="l17.14" class="difflineminus">-(x2, y2) are where you intend the two opposite corners of the image to</span>
<a href="#l17.15"></a><span id="l17.15" class="difflineminus">-end up in the plot. Image must be a fully loaded Javascript image (you</span>
<a href="#l17.16"></a><span id="l17.16" class="difflineminus">-can make one with new Image()). If the image is not complete, it's</span>
<a href="#l17.17"></a><span id="l17.17" class="difflineminus">-skipped when plotting.</span>
<a href="#l17.18"></a><span id="l17.18" class="difflineminus">-</span>
<a href="#l17.19"></a><span id="l17.19" class="difflineminus">-There are two helpers included for retrieving images. The easiest work</span>
<a href="#l17.20"></a><span id="l17.20" class="difflineminus">-the way that you put in URLs instead of images in the data (like</span>
<a href="#l17.21"></a><span id="l17.21" class="difflineminus">-[&quot;myimage.png&quot;, 0, 0, 10, 10]), then call $.plot.image.loadData(data,</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineminus">-options, callback) where data and options are the same as you pass in</span>
<a href="#l17.23"></a><span id="l17.23" class="difflineminus">-to $.plot. This loads the images, replaces the URLs in the data with</span>
<a href="#l17.24"></a><span id="l17.24" class="difflineminus">-the corresponding images and calls &quot;callback&quot; when all images are</span>
<a href="#l17.25"></a><span id="l17.25" class="difflineminus">-loaded (or failed loading). In the callback, you can then call $.plot</span>
<a href="#l17.26"></a><span id="l17.26" class="difflineminus">-with the data set. See the included example.</span>
<a href="#l17.27"></a><span id="l17.27" class="difflineminus">-</span>
<a href="#l17.28"></a><span id="l17.28" class="difflineminus">-A more low-level helper, $.plot.image.load(urls, callback) is also</span>
<a href="#l17.29"></a><span id="l17.29" class="difflineminus">-included. Given a list of URLs, it calls callback with an object</span>
<a href="#l17.30"></a><span id="l17.30" class="difflineminus">-mapping from URL to Image object when all images are loaded or have</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineminus">-failed loading.</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineminus">-</span>
<a href="#l17.33"></a><span id="l17.33" class="difflineminus">-Options for the plugin are</span>
<a href="#l17.34"></a><span id="l17.34" class="difflineminus">-</span>
<a href="#l17.35"></a><span id="l17.35" class="difflineminus">-  series: {</span>
<a href="#l17.36"></a><span id="l17.36" class="difflineminus">-      images: {</span>
<a href="#l17.37"></a><span id="l17.37" class="difflineminus">-          show: boolean</span>
<a href="#l17.38"></a><span id="l17.38" class="difflineminus">-          anchor: &quot;corner&quot; or &quot;center&quot;</span>
<a href="#l17.39"></a><span id="l17.39" class="difflineminus">-          alpha: [0,1]</span>
<a href="#l17.40"></a><span id="l17.40" class="difflineminus">-      }</span>
<a href="#l17.41"></a><span id="l17.41" class="difflineminus">-  }</span>
<a href="#l17.42"></a><span id="l17.42" class="difflineminus">-</span>
<a href="#l17.43"></a><span id="l17.43" class="difflineminus">-which can be specified for a specific series</span>
<a href="#l17.44"></a><span id="l17.44" class="difflineminus">-</span>
<a href="#l17.45"></a><span id="l17.45" class="difflineminus">-  $.plot($(&quot;#placeholder&quot;), [{ data: [ ... ], images: { ... } ])</span>
<a href="#l17.46"></a><span id="l17.46" class="difflineminus">-</span>
<a href="#l17.47"></a><span id="l17.47" class="difflineminus">-Note that because the data format is different from usual data points,</span>
<a href="#l17.48"></a><span id="l17.48" class="difflineminus">-you can't use images with anything else in a specific data series.</span>
<a href="#l17.49"></a><span id="l17.49" class="difflineminus">-</span>
<a href="#l17.50"></a><span id="l17.50" class="difflineminus">-Setting &quot;anchor&quot; to &quot;center&quot; causes the pixels in the image to be</span>
<a href="#l17.51"></a><span id="l17.51" class="difflineminus">-anchored at the corner pixel centers inside of at the pixel corners,</span>
<a href="#l17.52"></a><span id="l17.52" class="difflineminus">-effectively letting half a pixel stick out to each side in the plot.</span>
<a href="#l17.53"></a><span id="l17.53" class="difflineminus">-</span>
<a href="#l17.54"></a><span id="l17.54" class="difflineminus">-</span>
<a href="#l17.55"></a><span id="l17.55" class="difflineminus">-A possible future direction could be support for tiling for large</span>
<a href="#l17.56"></a><span id="l17.56" class="difflineminus">-images (like Google Maps).</span>
<a href="#l17.57"></a><span id="l17.57" class="difflineminus">-</span>
<a href="#l17.58"></a><span id="l17.58" class="difflineminus">-*/</span>
<a href="#l17.59"></a><span id="l17.59" class="difflineminus">-</span>
<a href="#l17.60"></a><span id="l17.60" class="difflineminus">-(function ($) {</span>
<a href="#l17.61"></a><span id="l17.61" class="difflineminus">-    var options = {</span>
<a href="#l17.62"></a><span id="l17.62" class="difflineminus">-        series: {</span>
<a href="#l17.63"></a><span id="l17.63" class="difflineminus">-            images: {</span>
<a href="#l17.64"></a><span id="l17.64" class="difflineminus">-                show: false,</span>
<a href="#l17.65"></a><span id="l17.65" class="difflineminus">-                alpha: 1,</span>
<a href="#l17.66"></a><span id="l17.66" class="difflineminus">-                anchor: &quot;corner&quot; // or &quot;center&quot;</span>
<a href="#l17.67"></a><span id="l17.67" class="difflineminus">-            }</span>
<a href="#l17.68"></a><span id="l17.68" class="difflineminus">-        }</span>
<a href="#l17.69"></a><span id="l17.69" class="difflineminus">-    };</span>
<a href="#l17.70"></a><span id="l17.70" class="difflineminus">-</span>
<a href="#l17.71"></a><span id="l17.71" class="difflineminus">-    $.plot.image = {};</span>
<a href="#l17.72"></a><span id="l17.72" class="difflineminus">-</span>
<a href="#l17.73"></a><span id="l17.73" class="difflineminus">-    $.plot.image.loadDataImages = function (series, options, callback) {</span>
<a href="#l17.74"></a><span id="l17.74" class="difflineminus">-        var urls = [], points = [];</span>
<a href="#l17.75"></a><span id="l17.75" class="difflineminus">-</span>
<a href="#l17.76"></a><span id="l17.76" class="difflineminus">-        var defaultShow = options.series.images.show;</span>
<a href="#l17.77"></a><span id="l17.77" class="difflineminus">-        </span>
<a href="#l17.78"></a><span id="l17.78" class="difflineminus">-        $.each(series, function (i, s) {</span>
<a href="#l17.79"></a><span id="l17.79" class="difflineminus">-            if (!(defaultShow || s.images.show))</span>
<a href="#l17.80"></a><span id="l17.80" class="difflineminus">-                return;</span>
<a href="#l17.81"></a><span id="l17.81" class="difflineminus">-            </span>
<a href="#l17.82"></a><span id="l17.82" class="difflineminus">-            if (s.data)</span>
<a href="#l17.83"></a><span id="l17.83" class="difflineminus">-                s = s.data;</span>
<a href="#l17.84"></a><span id="l17.84" class="difflineminus">-</span>
<a href="#l17.85"></a><span id="l17.85" class="difflineminus">-            $.each(s, function (i, p) {</span>
<a href="#l17.86"></a><span id="l17.86" class="difflineminus">-                if (typeof p[0] == &quot;string&quot;) {</span>
<a href="#l17.87"></a><span id="l17.87" class="difflineminus">-                    urls.push(p[0]);</span>
<a href="#l17.88"></a><span id="l17.88" class="difflineminus">-                    points.push(p);</span>
<a href="#l17.89"></a><span id="l17.89" class="difflineminus">-                }</span>
<a href="#l17.90"></a><span id="l17.90" class="difflineminus">-            });</span>
<a href="#l17.91"></a><span id="l17.91" class="difflineminus">-        });</span>
<a href="#l17.92"></a><span id="l17.92" class="difflineminus">-</span>
<a href="#l17.93"></a><span id="l17.93" class="difflineminus">-        $.plot.image.load(urls, function (loadedImages) {</span>
<a href="#l17.94"></a><span id="l17.94" class="difflineminus">-            $.each(points, function (i, p) {</span>
<a href="#l17.95"></a><span id="l17.95" class="difflineminus">-                var url = p[0];</span>
<a href="#l17.96"></a><span id="l17.96" class="difflineminus">-                if (loadedImages[url])</span>
<a href="#l17.97"></a><span id="l17.97" class="difflineminus">-                    p[0] = loadedImages[url];</span>
<a href="#l17.98"></a><span id="l17.98" class="difflineminus">-            });</span>
<a href="#l17.99"></a><span id="l17.99" class="difflineminus">-</span>
<a href="#l17.100"></a><span id="l17.100" class="difflineminus">-            callback();</span>
<a href="#l17.101"></a><span id="l17.101" class="difflineminus">-        });</span>
<a href="#l17.102"></a><span id="l17.102" class="difflineminus">-    }</span>
<a href="#l17.103"></a><span id="l17.103" class="difflineminus">-    </span>
<a href="#l17.104"></a><span id="l17.104" class="difflineminus">-    $.plot.image.load = function (urls, callback) {</span>
<a href="#l17.105"></a><span id="l17.105" class="difflineminus">-        var missing = urls.length, loaded = {};</span>
<a href="#l17.106"></a><span id="l17.106" class="difflineminus">-        if (missing == 0)</span>
<a href="#l17.107"></a><span id="l17.107" class="difflineminus">-            callback({});</span>
<a href="#l17.108"></a><span id="l17.108" class="difflineminus">-</span>
<a href="#l17.109"></a><span id="l17.109" class="difflineminus">-        $.each(urls, function (i, url) {</span>
<a href="#l17.110"></a><span id="l17.110" class="difflineminus">-            var handler = function () {</span>
<a href="#l17.111"></a><span id="l17.111" class="difflineminus">-                --missing;</span>
<a href="#l17.112"></a><span id="l17.112" class="difflineminus">-                </span>
<a href="#l17.113"></a><span id="l17.113" class="difflineminus">-                loaded[url] = this;</span>
<a href="#l17.114"></a><span id="l17.114" class="difflineminus">-                </span>
<a href="#l17.115"></a><span id="l17.115" class="difflineminus">-                if (missing == 0)</span>
<a href="#l17.116"></a><span id="l17.116" class="difflineminus">-                    callback(loaded);</span>
<a href="#l17.117"></a><span id="l17.117" class="difflineminus">-            };</span>
<a href="#l17.118"></a><span id="l17.118" class="difflineminus">-</span>
<a href="#l17.119"></a><span id="l17.119" class="difflineminus">-            $('&lt;img /&gt;').load(handler).error(handler).attr('src', url);</span>
<a href="#l17.120"></a><span id="l17.120" class="difflineminus">-        });</span>
<a href="#l17.121"></a><span id="l17.121" class="difflineminus">-    }</span>
<a href="#l17.122"></a><span id="l17.122" class="difflineminus">-    </span>
<a href="#l17.123"></a><span id="l17.123" class="difflineminus">-    function draw(plot, ctx) {</span>
<a href="#l17.124"></a><span id="l17.124" class="difflineminus">-        var plotOffset = plot.getPlotOffset();</span>
<a href="#l17.125"></a><span id="l17.125" class="difflineminus">-        </span>
<a href="#l17.126"></a><span id="l17.126" class="difflineminus">-        $.each(plot.getData(), function (i, series) {</span>
<a href="#l17.127"></a><span id="l17.127" class="difflineminus">-            var points = series.datapoints.points,</span>
<a href="#l17.128"></a><span id="l17.128" class="difflineminus">-                ps = series.datapoints.pointsize;</span>
<a href="#l17.129"></a><span id="l17.129" class="difflineminus">-            </span>
<a href="#l17.130"></a><span id="l17.130" class="difflineminus">-            for (var i = 0; i &lt; points.length; i += ps) {</span>
<a href="#l17.131"></a><span id="l17.131" class="difflineminus">-                var img = points[i],</span>
<a href="#l17.132"></a><span id="l17.132" class="difflineminus">-                    x1 = points[i + 1], y1 = points[i + 2],</span>
<a href="#l17.133"></a><span id="l17.133" class="difflineminus">-                    x2 = points[i + 3], y2 = points[i + 4],</span>
<a href="#l17.134"></a><span id="l17.134" class="difflineminus">-                    xaxis = series.xaxis, yaxis = series.yaxis,</span>
<a href="#l17.135"></a><span id="l17.135" class="difflineminus">-                    tmp;</span>
<a href="#l17.136"></a><span id="l17.136" class="difflineminus">-</span>
<a href="#l17.137"></a><span id="l17.137" class="difflineminus">-                // actually we should check img.complete, but it</span>
<a href="#l17.138"></a><span id="l17.138" class="difflineminus">-                // appears to be a somewhat unreliable indicator in</span>
<a href="#l17.139"></a><span id="l17.139" class="difflineminus">-                // IE6 (false even after load event)</span>
<a href="#l17.140"></a><span id="l17.140" class="difflineminus">-                if (!img || img.width &lt;= 0 || img.height &lt;= 0)</span>
<a href="#l17.141"></a><span id="l17.141" class="difflineminus">-                    continue;</span>
<a href="#l17.142"></a><span id="l17.142" class="difflineminus">-</span>
<a href="#l17.143"></a><span id="l17.143" class="difflineminus">-                if (x1 &gt; x2) {</span>
<a href="#l17.144"></a><span id="l17.144" class="difflineminus">-                    tmp = x2;</span>
<a href="#l17.145"></a><span id="l17.145" class="difflineminus">-                    x2 = x1;</span>
<a href="#l17.146"></a><span id="l17.146" class="difflineminus">-                    x1 = tmp;</span>
<a href="#l17.147"></a><span id="l17.147" class="difflineminus">-                }</span>
<a href="#l17.148"></a><span id="l17.148" class="difflineminus">-                if (y1 &gt; y2) {</span>
<a href="#l17.149"></a><span id="l17.149" class="difflineminus">-                    tmp = y2;</span>
<a href="#l17.150"></a><span id="l17.150" class="difflineminus">-                    y2 = y1;</span>
<a href="#l17.151"></a><span id="l17.151" class="difflineminus">-                    y1 = tmp;</span>
<a href="#l17.152"></a><span id="l17.152" class="difflineminus">-                }</span>
<a href="#l17.153"></a><span id="l17.153" class="difflineminus">-                </span>
<a href="#l17.154"></a><span id="l17.154" class="difflineminus">-                // if the anchor is at the center of the pixel, expand the </span>
<a href="#l17.155"></a><span id="l17.155" class="difflineminus">-                // image by 1/2 pixel in each direction</span>
<a href="#l17.156"></a><span id="l17.156" class="difflineminus">-                if (series.images.anchor == &quot;center&quot;) {</span>
<a href="#l17.157"></a><span id="l17.157" class="difflineminus">-                    tmp = 0.5 * (x2-x1) / (img.width - 1);</span>
<a href="#l17.158"></a><span id="l17.158" class="difflineminus">-                    x1 -= tmp;</span>
<a href="#l17.159"></a><span id="l17.159" class="difflineminus">-                    x2 += tmp;</span>
<a href="#l17.160"></a><span id="l17.160" class="difflineminus">-                    tmp = 0.5 * (y2-y1) / (img.height - 1);</span>
<a href="#l17.161"></a><span id="l17.161" class="difflineminus">-                    y1 -= tmp;</span>
<a href="#l17.162"></a><span id="l17.162" class="difflineminus">-                    y2 += tmp;</span>
<a href="#l17.163"></a><span id="l17.163" class="difflineminus">-                }</span>
<a href="#l17.164"></a><span id="l17.164" class="difflineminus">-                </span>
<a href="#l17.165"></a><span id="l17.165" class="difflineminus">-                // clip</span>
<a href="#l17.166"></a><span id="l17.166" class="difflineminus">-                if (x1 == x2 || y1 == y2 ||</span>
<a href="#l17.167"></a><span id="l17.167" class="difflineminus">-                    x1 &gt;= xaxis.max || x2 &lt;= xaxis.min ||</span>
<a href="#l17.168"></a><span id="l17.168" class="difflineminus">-                    y1 &gt;= yaxis.max || y2 &lt;= yaxis.min)</span>
<a href="#l17.169"></a><span id="l17.169" class="difflineminus">-                    continue;</span>
<a href="#l17.170"></a><span id="l17.170" class="difflineminus">-</span>
<a href="#l17.171"></a><span id="l17.171" class="difflineminus">-                var sx1 = 0, sy1 = 0, sx2 = img.width, sy2 = img.height;</span>
<a href="#l17.172"></a><span id="l17.172" class="difflineminus">-                if (x1 &lt; xaxis.min) {</span>
<a href="#l17.173"></a><span id="l17.173" class="difflineminus">-                    sx1 += (sx2 - sx1) * (xaxis.min - x1) / (x2 - x1);</span>
<a href="#l17.174"></a><span id="l17.174" class="difflineminus">-                    x1 = xaxis.min;</span>
<a href="#l17.175"></a><span id="l17.175" class="difflineminus">-                }</span>
<a href="#l17.176"></a><span id="l17.176" class="difflineminus">-</span>
<a href="#l17.177"></a><span id="l17.177" class="difflineminus">-                if (x2 &gt; xaxis.max) {</span>
<a href="#l17.178"></a><span id="l17.178" class="difflineminus">-                    sx2 += (sx2 - sx1) * (xaxis.max - x2) / (x2 - x1);</span>
<a href="#l17.179"></a><span id="l17.179" class="difflineminus">-                    x2 = xaxis.max;</span>
<a href="#l17.180"></a><span id="l17.180" class="difflineminus">-                }</span>
<a href="#l17.181"></a><span id="l17.181" class="difflineminus">-</span>
<a href="#l17.182"></a><span id="l17.182" class="difflineminus">-                if (y1 &lt; yaxis.min) {</span>
<a href="#l17.183"></a><span id="l17.183" class="difflineminus">-                    sy2 += (sy1 - sy2) * (yaxis.min - y1) / (y2 - y1);</span>
<a href="#l17.184"></a><span id="l17.184" class="difflineminus">-                    y1 = yaxis.min;</span>
<a href="#l17.185"></a><span id="l17.185" class="difflineminus">-                }</span>
<a href="#l17.186"></a><span id="l17.186" class="difflineminus">-</span>
<a href="#l17.187"></a><span id="l17.187" class="difflineminus">-                if (y2 &gt; yaxis.max) {</span>
<a href="#l17.188"></a><span id="l17.188" class="difflineminus">-                    sy1 += (sy1 - sy2) * (yaxis.max - y2) / (y2 - y1);</span>
<a href="#l17.189"></a><span id="l17.189" class="difflineminus">-                    y2 = yaxis.max;</span>
<a href="#l17.190"></a><span id="l17.190" class="difflineminus">-                }</span>
<a href="#l17.191"></a><span id="l17.191" class="difflineminus">-                </span>
<a href="#l17.192"></a><span id="l17.192" class="difflineminus">-                x1 = xaxis.p2c(x1);</span>
<a href="#l17.193"></a><span id="l17.193" class="difflineminus">-                x2 = xaxis.p2c(x2);</span>
<a href="#l17.194"></a><span id="l17.194" class="difflineminus">-                y1 = yaxis.p2c(y1);</span>
<a href="#l17.195"></a><span id="l17.195" class="difflineminus">-                y2 = yaxis.p2c(y2);</span>
<a href="#l17.196"></a><span id="l17.196" class="difflineminus">-                </span>
<a href="#l17.197"></a><span id="l17.197" class="difflineminus">-                // the transformation may have swapped us</span>
<a href="#l17.198"></a><span id="l17.198" class="difflineminus">-                if (x1 &gt; x2) {</span>
<a href="#l17.199"></a><span id="l17.199" class="difflineminus">-                    tmp = x2;</span>
<a href="#l17.200"></a><span id="l17.200" class="difflineminus">-                    x2 = x1;</span>
<a href="#l17.201"></a><span id="l17.201" class="difflineminus">-                    x1 = tmp;</span>
<a href="#l17.202"></a><span id="l17.202" class="difflineminus">-                }</span>
<a href="#l17.203"></a><span id="l17.203" class="difflineminus">-                if (y1 &gt; y2) {</span>
<a href="#l17.204"></a><span id="l17.204" class="difflineminus">-                    tmp = y2;</span>
<a href="#l17.205"></a><span id="l17.205" class="difflineminus">-                    y2 = y1;</span>
<a href="#l17.206"></a><span id="l17.206" class="difflineminus">-                    y1 = tmp;</span>
<a href="#l17.207"></a><span id="l17.207" class="difflineminus">-                }</span>
<a href="#l17.208"></a><span id="l17.208" class="difflineminus">-</span>
<a href="#l17.209"></a><span id="l17.209" class="difflineminus">-                tmp = ctx.globalAlpha;</span>
<a href="#l17.210"></a><span id="l17.210" class="difflineminus">-                ctx.globalAlpha *= series.images.alpha;</span>
<a href="#l17.211"></a><span id="l17.211" class="difflineminus">-                ctx.drawImage(img,</span>
<a href="#l17.212"></a><span id="l17.212" class="difflineminus">-                              sx1, sy1, sx2 - sx1, sy2 - sy1,</span>
<a href="#l17.213"></a><span id="l17.213" class="difflineminus">-                              x1 + plotOffset.left, y1 + plotOffset.top,</span>
<a href="#l17.214"></a><span id="l17.214" class="difflineminus">-                              x2 - x1, y2 - y1);</span>
<a href="#l17.215"></a><span id="l17.215" class="difflineminus">-                ctx.globalAlpha = tmp;</span>
<a href="#l17.216"></a><span id="l17.216" class="difflineminus">-            }</span>
<a href="#l17.217"></a><span id="l17.217" class="difflineminus">-        });</span>
<a href="#l17.218"></a><span id="l17.218" class="difflineminus">-    }</span>
<a href="#l17.219"></a><span id="l17.219" class="difflineminus">-</span>
<a href="#l17.220"></a><span id="l17.220" class="difflineminus">-    function processRawData(plot, series, data, datapoints) {</span>
<a href="#l17.221"></a><span id="l17.221" class="difflineminus">-        if (!series.images.show)</span>
<a href="#l17.222"></a><span id="l17.222" class="difflineminus">-            return;</span>
<a href="#l17.223"></a><span id="l17.223" class="difflineminus">-</span>
<a href="#l17.224"></a><span id="l17.224" class="difflineminus">-        // format is Image, x1, y1, x2, y2 (opposite corners)</span>
<a href="#l17.225"></a><span id="l17.225" class="difflineminus">-        datapoints.format = [</span>
<a href="#l17.226"></a><span id="l17.226" class="difflineminus">-            { required: true },</span>
<a href="#l17.227"></a><span id="l17.227" class="difflineminus">-            { x: true, number: true, required: true },</span>
<a href="#l17.228"></a><span id="l17.228" class="difflineminus">-            { y: true, number: true, required: true },</span>
<a href="#l17.229"></a><span id="l17.229" class="difflineminus">-            { x: true, number: true, required: true },</span>
<a href="#l17.230"></a><span id="l17.230" class="difflineminus">-            { y: true, number: true, required: true }</span>
<a href="#l17.231"></a><span id="l17.231" class="difflineminus">-        ];</span>
<a href="#l17.232"></a><span id="l17.232" class="difflineminus">-    }</span>
<a href="#l17.233"></a><span id="l17.233" class="difflineminus">-    </span>
<a href="#l17.234"></a><span id="l17.234" class="difflineminus">-    function init(plot) {</span>
<a href="#l17.235"></a><span id="l17.235" class="difflineminus">-        plot.hooks.processRawData.push(processRawData);</span>
<a href="#l17.236"></a><span id="l17.236" class="difflineminus">-        plot.hooks.draw.push(draw);</span>
<a href="#l17.237"></a><span id="l17.237" class="difflineminus">-    }</span>
<a href="#l17.238"></a><span id="l17.238" class="difflineminus">-    </span>
<a href="#l17.239"></a><span id="l17.239" class="difflineminus">-    $.plot.plugins.push({</span>
<a href="#l17.240"></a><span id="l17.240" class="difflineminus">-        init: init,</span>
<a href="#l17.241"></a><span id="l17.241" class="difflineminus">-        options: options,</span>
<a href="#l17.242"></a><span id="l17.242" class="difflineminus">-        name: 'image',</span>
<a href="#l17.243"></a><span id="l17.243" class="difflineminus">-        version: '1.1'</span>
<a href="#l17.244"></a><span id="l17.244" class="difflineminus">-    });</span>
<a href="#l17.245"></a><span id="l17.245" class="difflineminus">-})(jQuery);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1">deleted file mode 100644</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.flot.js</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineplus">+++ /dev/null</span>
<a href="#l18.4"></a><span id="l18.4" class="difflineat">@@ -1,2119 +0,0 @@</span>
<a href="#l18.5"></a><span id="l18.5" class="difflineminus">-/* Javascript plotting library for jQuery, v. 0.6.</span>
<a href="#l18.6"></a><span id="l18.6" class="difflineminus">- *</span>
<a href="#l18.7"></a><span id="l18.7" class="difflineminus">- * Released under the MIT license by IOLA, December 2007.</span>
<a href="#l18.8"></a><span id="l18.8" class="difflineminus">- *</span>
<a href="#l18.9"></a><span id="l18.9" class="difflineminus">- */</span>
<a href="#l18.10"></a><span id="l18.10" class="difflineminus">-</span>
<a href="#l18.11"></a><span id="l18.11" class="difflineminus">-// first an inline dependency, jquery.colorhelpers.js, we inline it here</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-// for convenience</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineminus">-</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineminus">-/* Plugin for jQuery for working with colors.</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineminus">- * </span>
<a href="#l18.16"></a><span id="l18.16" class="difflineminus">- * Version 1.0.</span>
<a href="#l18.17"></a><span id="l18.17" class="difflineminus">- * </span>
<a href="#l18.18"></a><span id="l18.18" class="difflineminus">- * Inspiration from jQuery color animation plugin by John Resig.</span>
<a href="#l18.19"></a><span id="l18.19" class="difflineminus">- *</span>
<a href="#l18.20"></a><span id="l18.20" class="difflineminus">- * Released under the MIT license by Ole Laursen, October 2009.</span>
<a href="#l18.21"></a><span id="l18.21" class="difflineminus">- *</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineminus">- * Examples:</span>
<a href="#l18.23"></a><span id="l18.23" class="difflineminus">- *</span>
<a href="#l18.24"></a><span id="l18.24" class="difflineminus">- *   $.color.parse(&quot;#fff&quot;).scale('rgb', 0.25).add('a', -0.5).toString()</span>
<a href="#l18.25"></a><span id="l18.25" class="difflineminus">- *   var c = $.color.extract($(&quot;#mydiv&quot;), 'background-color');</span>
<a href="#l18.26"></a><span id="l18.26" class="difflineminus">- *   console.log(c.r, c.g, c.b, c.a);</span>
<a href="#l18.27"></a><span id="l18.27" class="difflineminus">- *   $.color.make(100, 50, 25, 0.4).toString() // returns &quot;rgba(100,50,25,0.4)&quot;</span>
<a href="#l18.28"></a><span id="l18.28" class="difflineminus">- *</span>
<a href="#l18.29"></a><span id="l18.29" class="difflineminus">- * Note that .scale() and .add() work in-place instead of returning</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineminus">- * new objects.</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineminus">- */ </span>
<a href="#l18.32"></a><span id="l18.32" class="difflineminus">-(function(){jQuery.color={};jQuery.color.make=function(E,D,B,C){var F={};F.r=E||0;F.g=D||0;F.b=B||0;F.a=C!=null?C:1;F.add=function(I,H){for(var G=0;G&lt;I.length;++G){F[I.charAt(G)]+=H}return F.normalize()};F.scale=function(I,H){for(var G=0;G&lt;I.length;++G){F[I.charAt(G)]*=H}return F.normalize()};F.toString=function(){if(F.a&gt;=1){return&quot;rgb(&quot;+[F.r,F.g,F.b].join(&quot;,&quot;)+&quot;)&quot;}else{return&quot;rgba(&quot;+[F.r,F.g,F.b,F.a].join(&quot;,&quot;)+&quot;)&quot;}};F.normalize=function(){function G(I,J,H){return J&lt;I?I:(J&gt;H?H:J)}F.r=G(0,parseInt(F.r),255);F.g=G(0,parseInt(F.g),255);F.b=G(0,parseInt(F.b),255);F.a=G(0,F.a,1);return F};F.clone=function(){return jQuery.color.make(F.r,F.b,F.g,F.a)};return F.normalize()};jQuery.color.extract=function(C,B){var D;do{D=C.css(B).toLowerCase();if(D!=&quot;&quot;&amp;&amp;D!=&quot;transparent&quot;){break}C=C.parent()}while(!jQuery.nodeName(C.get(0),&quot;body&quot;));if(D==&quot;rgba(0, 0, 0, 0)&quot;){D=&quot;transparent&quot;}return jQuery.color.parse(D)};jQuery.color.parse=function(E){var D,B=jQuery.color.make;if(D=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(E)){return B(parseInt(D[1],10),parseInt(D[2],10),parseInt(D[3],10))}if(D=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(E)){return B(parseInt(D[1],10),parseInt(D[2],10),parseInt(D[3],10),parseFloat(D[4]))}if(D=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(E)){return B(parseFloat(D[1])*2.55,parseFloat(D[2])*2.55,parseFloat(D[3])*2.55)}if(D=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(E)){return B(parseFloat(D[1])*2.55,parseFloat(D[2])*2.55,parseFloat(D[3])*2.55,parseFloat(D[4]))}if(D=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(E)){return B(parseInt(D[1],16),parseInt(D[2],16),parseInt(D[3],16))}if(D=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(E)){return B(parseInt(D[1]+D[1],16),parseInt(D[2]+D[2],16),parseInt(D[3]+D[3],16))}var C=jQuery.trim(E).toLowerCase();if(C==&quot;transparent&quot;){return B(255,255,255,0)}else{D=A[C];return B(D[0],D[1],D[2])}};var A={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})();</span>
<a href="#l18.33"></a><span id="l18.33" class="difflineminus">-</span>
<a href="#l18.34"></a><span id="l18.34" class="difflineminus">-// the actual Flot code</span>
<a href="#l18.35"></a><span id="l18.35" class="difflineminus">-(function($) {</span>
<a href="#l18.36"></a><span id="l18.36" class="difflineminus">-    function Plot(placeholder, data_, options_, plugins) {</span>
<a href="#l18.37"></a><span id="l18.37" class="difflineminus">-        // data is on the form:</span>
<a href="#l18.38"></a><span id="l18.38" class="difflineminus">-        //   [ series1, series2 ... ]</span>
<a href="#l18.39"></a><span id="l18.39" class="difflineminus">-        // where series is either just the data as [ [x1, y1], [x2, y2], ... ]</span>
<a href="#l18.40"></a><span id="l18.40" class="difflineminus">-        // or { data: [ [x1, y1], [x2, y2], ... ], label: &quot;some label&quot;, ... }</span>
<a href="#l18.41"></a><span id="l18.41" class="difflineminus">-        </span>
<a href="#l18.42"></a><span id="l18.42" class="difflineminus">-        var series = [],</span>
<a href="#l18.43"></a><span id="l18.43" class="difflineminus">-            options = {</span>
<a href="#l18.44"></a><span id="l18.44" class="difflineminus">-                // the color theme used for graphs</span>
<a href="#l18.45"></a><span id="l18.45" class="difflineminus">-                colors: [&quot;#edc240&quot;, &quot;#afd8f8&quot;, &quot;#cb4b4b&quot;, &quot;#4da74d&quot;, &quot;#9440ed&quot;],</span>
<a href="#l18.46"></a><span id="l18.46" class="difflineminus">-                legend: {</span>
<a href="#l18.47"></a><span id="l18.47" class="difflineminus">-                    show: true,</span>
<a href="#l18.48"></a><span id="l18.48" class="difflineminus">-                    noColumns: 1, // number of colums in legend table</span>
<a href="#l18.49"></a><span id="l18.49" class="difflineminus">-                    labelFormatter: null, // fn: string -&gt; string</span>
<a href="#l18.50"></a><span id="l18.50" class="difflineminus">-                    labelBoxBorderColor: &quot;#ccc&quot;, // border color for the little label boxes</span>
<a href="#l18.51"></a><span id="l18.51" class="difflineminus">-                    container: null, // container (as jQuery object) to put legend in, null means default on top of graph</span>
<a href="#l18.52"></a><span id="l18.52" class="difflineminus">-                    position: &quot;ne&quot;, // position of default legend container within plot</span>
<a href="#l18.53"></a><span id="l18.53" class="difflineminus">-                    margin: 5, // distance from grid edge to default legend container within plot</span>
<a href="#l18.54"></a><span id="l18.54" class="difflineminus">-                    backgroundColor: null, // null means auto-detect</span>
<a href="#l18.55"></a><span id="l18.55" class="difflineminus">-                    backgroundOpacity: 0.85 // set to 0 to avoid background</span>
<a href="#l18.56"></a><span id="l18.56" class="difflineminus">-                },</span>
<a href="#l18.57"></a><span id="l18.57" class="difflineminus">-                xaxis: {</span>
<a href="#l18.58"></a><span id="l18.58" class="difflineminus">-                    mode: null, // null or &quot;time&quot;</span>
<a href="#l18.59"></a><span id="l18.59" class="difflineminus">-                    transform: null, // null or f: number -&gt; number to transform axis</span>
<a href="#l18.60"></a><span id="l18.60" class="difflineminus">-                    inverseTransform: null, // if transform is set, this should be the inverse function</span>
<a href="#l18.61"></a><span id="l18.61" class="difflineminus">-                    min: null, // min. value to show, null means set automatically</span>
<a href="#l18.62"></a><span id="l18.62" class="difflineminus">-                    max: null, // max. value to show, null means set automatically</span>
<a href="#l18.63"></a><span id="l18.63" class="difflineminus">-                    autoscaleMargin: null, // margin in % to add if auto-setting min/max</span>
<a href="#l18.64"></a><span id="l18.64" class="difflineminus">-                    ticks: null, // either [1, 3] or [[1, &quot;a&quot;], 3] or (fn: axis info -&gt; ticks) or app. number of ticks for auto-ticks</span>
<a href="#l18.65"></a><span id="l18.65" class="difflineminus">-                    tickFormatter: null, // fn: number -&gt; string</span>
<a href="#l18.66"></a><span id="l18.66" class="difflineminus">-                    labelWidth: null, // size of tick labels in pixels</span>
<a href="#l18.67"></a><span id="l18.67" class="difflineminus">-                    labelHeight: null,</span>
<a href="#l18.68"></a><span id="l18.68" class="difflineminus">-                    </span>
<a href="#l18.69"></a><span id="l18.69" class="difflineminus">-                    // mode specific options</span>
<a href="#l18.70"></a><span id="l18.70" class="difflineminus">-                    tickDecimals: null, // no. of decimals, null means auto</span>
<a href="#l18.71"></a><span id="l18.71" class="difflineminus">-                    tickSize: null, // number or [number, &quot;unit&quot;]</span>
<a href="#l18.72"></a><span id="l18.72" class="difflineminus">-                    minTickSize: null, // number or [number, &quot;unit&quot;]</span>
<a href="#l18.73"></a><span id="l18.73" class="difflineminus">-                    monthNames: null, // list of names of months</span>
<a href="#l18.74"></a><span id="l18.74" class="difflineminus">-                    timeformat: null, // format string to use</span>
<a href="#l18.75"></a><span id="l18.75" class="difflineminus">-                    twelveHourClock: false // 12 or 24 time in time mode</span>
<a href="#l18.76"></a><span id="l18.76" class="difflineminus">-                },</span>
<a href="#l18.77"></a><span id="l18.77" class="difflineminus">-                yaxis: {</span>
<a href="#l18.78"></a><span id="l18.78" class="difflineminus">-                    autoscaleMargin: 0.02</span>
<a href="#l18.79"></a><span id="l18.79" class="difflineminus">-                },</span>
<a href="#l18.80"></a><span id="l18.80" class="difflineminus">-                x2axis: {</span>
<a href="#l18.81"></a><span id="l18.81" class="difflineminus">-                    autoscaleMargin: null</span>
<a href="#l18.82"></a><span id="l18.82" class="difflineminus">-                },</span>
<a href="#l18.83"></a><span id="l18.83" class="difflineminus">-                y2axis: {</span>
<a href="#l18.84"></a><span id="l18.84" class="difflineminus">-                    autoscaleMargin: 0.02</span>
<a href="#l18.85"></a><span id="l18.85" class="difflineminus">-                },</span>
<a href="#l18.86"></a><span id="l18.86" class="difflineminus">-                series: {</span>
<a href="#l18.87"></a><span id="l18.87" class="difflineminus">-                    points: {</span>
<a href="#l18.88"></a><span id="l18.88" class="difflineminus">-                        show: false,</span>
<a href="#l18.89"></a><span id="l18.89" class="difflineminus">-                        radius: 3,</span>
<a href="#l18.90"></a><span id="l18.90" class="difflineminus">-                        lineWidth: 2, // in pixels</span>
<a href="#l18.91"></a><span id="l18.91" class="difflineminus">-                        fill: true,</span>
<a href="#l18.92"></a><span id="l18.92" class="difflineminus">-                        fillColor: &quot;#ffffff&quot;</span>
<a href="#l18.93"></a><span id="l18.93" class="difflineminus">-                    },</span>
<a href="#l18.94"></a><span id="l18.94" class="difflineminus">-                    lines: {</span>
<a href="#l18.95"></a><span id="l18.95" class="difflineminus">-                        // we don't put in show: false so we can see</span>
<a href="#l18.96"></a><span id="l18.96" class="difflineminus">-                        // whether lines were actively disabled </span>
<a href="#l18.97"></a><span id="l18.97" class="difflineminus">-                        lineWidth: 2, // in pixels</span>
<a href="#l18.98"></a><span id="l18.98" class="difflineminus">-                        fill: false,</span>
<a href="#l18.99"></a><span id="l18.99" class="difflineminus">-                        fillColor: null,</span>
<a href="#l18.100"></a><span id="l18.100" class="difflineminus">-                        steps: false</span>
<a href="#l18.101"></a><span id="l18.101" class="difflineminus">-                    },</span>
<a href="#l18.102"></a><span id="l18.102" class="difflineminus">-                    bars: {</span>
<a href="#l18.103"></a><span id="l18.103" class="difflineminus">-                        show: false,</span>
<a href="#l18.104"></a><span id="l18.104" class="difflineminus">-                        lineWidth: 2, // in pixels</span>
<a href="#l18.105"></a><span id="l18.105" class="difflineminus">-                        barWidth: 1, // in units of the x axis</span>
<a href="#l18.106"></a><span id="l18.106" class="difflineminus">-                        fill: true,</span>
<a href="#l18.107"></a><span id="l18.107" class="difflineminus">-                        fillColor: null,</span>
<a href="#l18.108"></a><span id="l18.108" class="difflineminus">-                        align: &quot;left&quot;, // or &quot;center&quot; </span>
<a href="#l18.109"></a><span id="l18.109" class="difflineminus">-                        horizontal: false // when horizontal, left is now top</span>
<a href="#l18.110"></a><span id="l18.110" class="difflineminus">-                    },</span>
<a href="#l18.111"></a><span id="l18.111" class="difflineminus">-                    shadowSize: 3</span>
<a href="#l18.112"></a><span id="l18.112" class="difflineminus">-                },</span>
<a href="#l18.113"></a><span id="l18.113" class="difflineminus">-                grid: {</span>
<a href="#l18.114"></a><span id="l18.114" class="difflineminus">-                    show: true,</span>
<a href="#l18.115"></a><span id="l18.115" class="difflineminus">-                    aboveData: false,</span>
<a href="#l18.116"></a><span id="l18.116" class="difflineminus">-                    color: &quot;#545454&quot;, // primary color used for outline and labels</span>
<a href="#l18.117"></a><span id="l18.117" class="difflineminus">-                    backgroundColor: null, // null for transparent, else color</span>
<a href="#l18.118"></a><span id="l18.118" class="difflineminus">-                    tickColor: &quot;rgba(0,0,0,0.15)&quot;, // color used for the ticks</span>
<a href="#l18.119"></a><span id="l18.119" class="difflineminus">-                    labelMargin: 5, // in pixels</span>
<a href="#l18.120"></a><span id="l18.120" class="difflineminus">-                    borderWidth: 2, // in pixels</span>
<a href="#l18.121"></a><span id="l18.121" class="difflineminus">-                    borderColor: null, // set if different from the grid color</span>
<a href="#l18.122"></a><span id="l18.122" class="difflineminus">-                    markings: null, // array of ranges or fn: axes -&gt; array of ranges</span>
<a href="#l18.123"></a><span id="l18.123" class="difflineminus">-                    markingsColor: &quot;#f4f4f4&quot;,</span>
<a href="#l18.124"></a><span id="l18.124" class="difflineminus">-                    markingsLineWidth: 2,</span>
<a href="#l18.125"></a><span id="l18.125" class="difflineminus">-                    // interactive stuff</span>
<a href="#l18.126"></a><span id="l18.126" class="difflineminus">-                    clickable: false,</span>
<a href="#l18.127"></a><span id="l18.127" class="difflineminus">-                    hoverable: false,</span>
<a href="#l18.128"></a><span id="l18.128" class="difflineminus">-                    autoHighlight: true, // highlight in case mouse is near</span>
<a href="#l18.129"></a><span id="l18.129" class="difflineminus">-                    mouseActiveRadius: 10 // how far the mouse can be away to activate an item</span>
<a href="#l18.130"></a><span id="l18.130" class="difflineminus">-                },</span>
<a href="#l18.131"></a><span id="l18.131" class="difflineminus">-                hooks: {}</span>
<a href="#l18.132"></a><span id="l18.132" class="difflineminus">-            },</span>
<a href="#l18.133"></a><span id="l18.133" class="difflineminus">-        canvas = null,      // the canvas for the plot itself</span>
<a href="#l18.134"></a><span id="l18.134" class="difflineminus">-        overlay = null,     // canvas for interactive stuff on top of plot</span>
<a href="#l18.135"></a><span id="l18.135" class="difflineminus">-        eventHolder = null, // jQuery object that events should be bound to</span>
<a href="#l18.136"></a><span id="l18.136" class="difflineminus">-        ctx = null, octx = null,</span>
<a href="#l18.137"></a><span id="l18.137" class="difflineminus">-        axes = { xaxis: {}, yaxis: {}, x2axis: {}, y2axis: {} },</span>
<a href="#l18.138"></a><span id="l18.138" class="difflineminus">-        plotOffset = { left: 0, right: 0, top: 0, bottom: 0},</span>
<a href="#l18.139"></a><span id="l18.139" class="difflineminus">-        canvasWidth = 0, canvasHeight = 0,</span>
<a href="#l18.140"></a><span id="l18.140" class="difflineminus">-        plotWidth = 0, plotHeight = 0,</span>
<a href="#l18.141"></a><span id="l18.141" class="difflineminus">-        hooks = {</span>
<a href="#l18.142"></a><span id="l18.142" class="difflineminus">-            processOptions: [],</span>
<a href="#l18.143"></a><span id="l18.143" class="difflineminus">-            processRawData: [],</span>
<a href="#l18.144"></a><span id="l18.144" class="difflineminus">-            processDatapoints: [],</span>
<a href="#l18.145"></a><span id="l18.145" class="difflineminus">-            draw: [],</span>
<a href="#l18.146"></a><span id="l18.146" class="difflineminus">-            bindEvents: [],</span>
<a href="#l18.147"></a><span id="l18.147" class="difflineminus">-            drawOverlay: []</span>
<a href="#l18.148"></a><span id="l18.148" class="difflineminus">-        },</span>
<a href="#l18.149"></a><span id="l18.149" class="difflineminus">-        plot = this;</span>
<a href="#l18.150"></a><span id="l18.150" class="difflineminus">-</span>
<a href="#l18.151"></a><span id="l18.151" class="difflineminus">-        // public functions</span>
<a href="#l18.152"></a><span id="l18.152" class="difflineminus">-        plot.setData = setData;</span>
<a href="#l18.153"></a><span id="l18.153" class="difflineminus">-        plot.setupGrid = setupGrid;</span>
<a href="#l18.154"></a><span id="l18.154" class="difflineminus">-        plot.draw = draw;</span>
<a href="#l18.155"></a><span id="l18.155" class="difflineminus">-        plot.getPlaceholder = function() { return placeholder; };</span>
<a href="#l18.156"></a><span id="l18.156" class="difflineminus">-        plot.getCanvas = function() { return canvas; };</span>
<a href="#l18.157"></a><span id="l18.157" class="difflineminus">-        plot.getPlotOffset = function() { return plotOffset; };</span>
<a href="#l18.158"></a><span id="l18.158" class="difflineminus">-        plot.width = function () { return plotWidth; };</span>
<a href="#l18.159"></a><span id="l18.159" class="difflineminus">-        plot.height = function () { return plotHeight; };</span>
<a href="#l18.160"></a><span id="l18.160" class="difflineminus">-        plot.offset = function () {</span>
<a href="#l18.161"></a><span id="l18.161" class="difflineminus">-            var o = eventHolder.offset();</span>
<a href="#l18.162"></a><span id="l18.162" class="difflineminus">-            o.left += plotOffset.left;</span>
<a href="#l18.163"></a><span id="l18.163" class="difflineminus">-            o.top += plotOffset.top;</span>
<a href="#l18.164"></a><span id="l18.164" class="difflineminus">-            return o;</span>
<a href="#l18.165"></a><span id="l18.165" class="difflineminus">-        };</span>
<a href="#l18.166"></a><span id="l18.166" class="difflineminus">-        plot.getData = function() { return series; };</span>
<a href="#l18.167"></a><span id="l18.167" class="difflineminus">-        plot.getAxes = function() { return axes; };</span>
<a href="#l18.168"></a><span id="l18.168" class="difflineminus">-        plot.getOptions = function() { return options; };</span>
<a href="#l18.169"></a><span id="l18.169" class="difflineminus">-        plot.highlight = highlight;</span>
<a href="#l18.170"></a><span id="l18.170" class="difflineminus">-        plot.unhighlight = unhighlight;</span>
<a href="#l18.171"></a><span id="l18.171" class="difflineminus">-        plot.triggerRedrawOverlay = triggerRedrawOverlay;</span>
<a href="#l18.172"></a><span id="l18.172" class="difflineminus">-        plot.pointOffset = function(point) {</span>
<a href="#l18.173"></a><span id="l18.173" class="difflineminus">-            return { left: parseInt(axisSpecToRealAxis(point, &quot;xaxis&quot;).p2c(+point.x) + plotOffset.left),</span>
<a href="#l18.174"></a><span id="l18.174" class="difflineminus">-                     top: parseInt(axisSpecToRealAxis(point, &quot;yaxis&quot;).p2c(+point.y) + plotOffset.top) };</span>
<a href="#l18.175"></a><span id="l18.175" class="difflineminus">-        };</span>
<a href="#l18.176"></a><span id="l18.176" class="difflineminus">-        </span>
<a href="#l18.177"></a><span id="l18.177" class="difflineminus">-</span>
<a href="#l18.178"></a><span id="l18.178" class="difflineminus">-        // public attributes</span>
<a href="#l18.179"></a><span id="l18.179" class="difflineminus">-        plot.hooks = hooks;</span>
<a href="#l18.180"></a><span id="l18.180" class="difflineminus">-        </span>
<a href="#l18.181"></a><span id="l18.181" class="difflineminus">-        // initialize</span>
<a href="#l18.182"></a><span id="l18.182" class="difflineminus">-        initPlugins(plot);</span>
<a href="#l18.183"></a><span id="l18.183" class="difflineminus">-        parseOptions(options_);</span>
<a href="#l18.184"></a><span id="l18.184" class="difflineminus">-        constructCanvas();</span>
<a href="#l18.185"></a><span id="l18.185" class="difflineminus">-        setData(data_);</span>
<a href="#l18.186"></a><span id="l18.186" class="difflineminus">-        setupGrid();</span>
<a href="#l18.187"></a><span id="l18.187" class="difflineminus">-        draw();</span>
<a href="#l18.188"></a><span id="l18.188" class="difflineminus">-        bindEvents();</span>
<a href="#l18.189"></a><span id="l18.189" class="difflineminus">-</span>
<a href="#l18.190"></a><span id="l18.190" class="difflineminus">-</span>
<a href="#l18.191"></a><span id="l18.191" class="difflineminus">-        function executeHooks(hook, args) {</span>
<a href="#l18.192"></a><span id="l18.192" class="difflineminus">-            args = [plot].concat(args);</span>
<a href="#l18.193"></a><span id="l18.193" class="difflineminus">-            for (var i = 0; i &lt; hook.length; ++i)</span>
<a href="#l18.194"></a><span id="l18.194" class="difflineminus">-                hook[i].apply(this, args);</span>
<a href="#l18.195"></a><span id="l18.195" class="difflineminus">-        }</span>
<a href="#l18.196"></a><span id="l18.196" class="difflineminus">-</span>
<a href="#l18.197"></a><span id="l18.197" class="difflineminus">-        function initPlugins() {</span>
<a href="#l18.198"></a><span id="l18.198" class="difflineminus">-            for (var i = 0; i &lt; plugins.length; ++i) {</span>
<a href="#l18.199"></a><span id="l18.199" class="difflineminus">-                var p = plugins[i];</span>
<a href="#l18.200"></a><span id="l18.200" class="difflineminus">-                p.init(plot);</span>
<a href="#l18.201"></a><span id="l18.201" class="difflineminus">-                if (p.options)</span>
<a href="#l18.202"></a><span id="l18.202" class="difflineminus">-                    $.extend(true, options, p.options);</span>
<a href="#l18.203"></a><span id="l18.203" class="difflineminus">-            }</span>
<a href="#l18.204"></a><span id="l18.204" class="difflineminus">-        }</span>
<a href="#l18.205"></a><span id="l18.205" class="difflineminus">-        </span>
<a href="#l18.206"></a><span id="l18.206" class="difflineminus">-        function parseOptions(opts) {</span>
<a href="#l18.207"></a><span id="l18.207" class="difflineminus">-            $.extend(true, options, opts);</span>
<a href="#l18.208"></a><span id="l18.208" class="difflineminus">-            if (options.grid.borderColor == null)</span>
<a href="#l18.209"></a><span id="l18.209" class="difflineminus">-                options.grid.borderColor = options.grid.color;</span>
<a href="#l18.210"></a><span id="l18.210" class="difflineminus">-            // backwards compatibility, to be removed in future</span>
<a href="#l18.211"></a><span id="l18.211" class="difflineminus">-            if (options.xaxis.noTicks &amp;&amp; options.xaxis.ticks == null)</span>
<a href="#l18.212"></a><span id="l18.212" class="difflineminus">-                options.xaxis.ticks = options.xaxis.noTicks;</span>
<a href="#l18.213"></a><span id="l18.213" class="difflineminus">-            if (options.yaxis.noTicks &amp;&amp; options.yaxis.ticks == null)</span>
<a href="#l18.214"></a><span id="l18.214" class="difflineminus">-                options.yaxis.ticks = options.yaxis.noTicks;</span>
<a href="#l18.215"></a><span id="l18.215" class="difflineminus">-            if (options.grid.coloredAreas)</span>
<a href="#l18.216"></a><span id="l18.216" class="difflineminus">-                options.grid.markings = options.grid.coloredAreas;</span>
<a href="#l18.217"></a><span id="l18.217" class="difflineminus">-            if (options.grid.coloredAreasColor)</span>
<a href="#l18.218"></a><span id="l18.218" class="difflineminus">-                options.grid.markingsColor = options.grid.coloredAreasColor;</span>
<a href="#l18.219"></a><span id="l18.219" class="difflineminus">-            if (options.lines)</span>
<a href="#l18.220"></a><span id="l18.220" class="difflineminus">-                $.extend(true, options.series.lines, options.lines);</span>
<a href="#l18.221"></a><span id="l18.221" class="difflineminus">-            if (options.points)</span>
<a href="#l18.222"></a><span id="l18.222" class="difflineminus">-                $.extend(true, options.series.points, options.points);</span>
<a href="#l18.223"></a><span id="l18.223" class="difflineminus">-            if (options.bars)</span>
<a href="#l18.224"></a><span id="l18.224" class="difflineminus">-                $.extend(true, options.series.bars, options.bars);</span>
<a href="#l18.225"></a><span id="l18.225" class="difflineminus">-            if (options.shadowSize)</span>
<a href="#l18.226"></a><span id="l18.226" class="difflineminus">-                options.series.shadowSize = options.shadowSize;</span>
<a href="#l18.227"></a><span id="l18.227" class="difflineminus">-</span>
<a href="#l18.228"></a><span id="l18.228" class="difflineminus">-            for (var n in hooks)</span>
<a href="#l18.229"></a><span id="l18.229" class="difflineminus">-                if (options.hooks[n] &amp;&amp; options.hooks[n].length)</span>
<a href="#l18.230"></a><span id="l18.230" class="difflineminus">-                    hooks[n] = hooks[n].concat(options.hooks[n]);</span>
<a href="#l18.231"></a><span id="l18.231" class="difflineminus">-</span>
<a href="#l18.232"></a><span id="l18.232" class="difflineminus">-            executeHooks(hooks.processOptions, [options]);</span>
<a href="#l18.233"></a><span id="l18.233" class="difflineminus">-        }</span>
<a href="#l18.234"></a><span id="l18.234" class="difflineminus">-</span>
<a href="#l18.235"></a><span id="l18.235" class="difflineminus">-        function setData(d) {</span>
<a href="#l18.236"></a><span id="l18.236" class="difflineminus">-            series = parseData(d);</span>
<a href="#l18.237"></a><span id="l18.237" class="difflineminus">-            fillInSeriesOptions();</span>
<a href="#l18.238"></a><span id="l18.238" class="difflineminus">-            processData();</span>
<a href="#l18.239"></a><span id="l18.239" class="difflineminus">-        }</span>
<a href="#l18.240"></a><span id="l18.240" class="difflineminus">-        </span>
<a href="#l18.241"></a><span id="l18.241" class="difflineminus">-        function parseData(d) {</span>
<a href="#l18.242"></a><span id="l18.242" class="difflineminus">-            var res = [];</span>
<a href="#l18.243"></a><span id="l18.243" class="difflineminus">-            for (var i = 0; i &lt; d.length; ++i) {</span>
<a href="#l18.244"></a><span id="l18.244" class="difflineminus">-                var s = $.extend(true, {}, options.series);</span>
<a href="#l18.245"></a><span id="l18.245" class="difflineminus">-</span>
<a href="#l18.246"></a><span id="l18.246" class="difflineminus">-                if (d[i].data) {</span>
<a href="#l18.247"></a><span id="l18.247" class="difflineminus">-                    s.data = d[i].data; // move the data instead of deep-copy</span>
<a href="#l18.248"></a><span id="l18.248" class="difflineminus">-                    delete d[i].data;</span>
<a href="#l18.249"></a><span id="l18.249" class="difflineminus">-</span>
<a href="#l18.250"></a><span id="l18.250" class="difflineminus">-                    $.extend(true, s, d[i]);</span>
<a href="#l18.251"></a><span id="l18.251" class="difflineminus">-</span>
<a href="#l18.252"></a><span id="l18.252" class="difflineminus">-                    d[i].data = s.data;</span>
<a href="#l18.253"></a><span id="l18.253" class="difflineminus">-                }</span>
<a href="#l18.254"></a><span id="l18.254" class="difflineminus">-                else</span>
<a href="#l18.255"></a><span id="l18.255" class="difflineminus">-                    s.data = d[i];</span>
<a href="#l18.256"></a><span id="l18.256" class="difflineminus">-                res.push(s);</span>
<a href="#l18.257"></a><span id="l18.257" class="difflineminus">-            }</span>
<a href="#l18.258"></a><span id="l18.258" class="difflineminus">-</span>
<a href="#l18.259"></a><span id="l18.259" class="difflineminus">-            return res;</span>
<a href="#l18.260"></a><span id="l18.260" class="difflineminus">-        }</span>
<a href="#l18.261"></a><span id="l18.261" class="difflineminus">-        </span>
<a href="#l18.262"></a><span id="l18.262" class="difflineminus">-        function axisSpecToRealAxis(obj, attr) {</span>
<a href="#l18.263"></a><span id="l18.263" class="difflineminus">-            var a = obj[attr];</span>
<a href="#l18.264"></a><span id="l18.264" class="difflineminus">-            if (!a || a == 1)</span>
<a href="#l18.265"></a><span id="l18.265" class="difflineminus">-                return axes[attr];</span>
<a href="#l18.266"></a><span id="l18.266" class="difflineminus">-            if (typeof a == &quot;number&quot;)</span>
<a href="#l18.267"></a><span id="l18.267" class="difflineminus">-                return axes[attr.charAt(0) + a + attr.slice(1)];</span>
<a href="#l18.268"></a><span id="l18.268" class="difflineminus">-            return a; // assume it's OK</span>
<a href="#l18.269"></a><span id="l18.269" class="difflineminus">-        }</span>
<a href="#l18.270"></a><span id="l18.270" class="difflineminus">-        </span>
<a href="#l18.271"></a><span id="l18.271" class="difflineminus">-        function fillInSeriesOptions() {</span>
<a href="#l18.272"></a><span id="l18.272" class="difflineminus">-            var i;</span>
<a href="#l18.273"></a><span id="l18.273" class="difflineminus">-            </span>
<a href="#l18.274"></a><span id="l18.274" class="difflineminus">-            // collect what we already got of colors</span>
<a href="#l18.275"></a><span id="l18.275" class="difflineminus">-            var neededColors = series.length,</span>
<a href="#l18.276"></a><span id="l18.276" class="difflineminus">-                usedColors = [],</span>
<a href="#l18.277"></a><span id="l18.277" class="difflineminus">-                assignedColors = [];</span>
<a href="#l18.278"></a><span id="l18.278" class="difflineminus">-            for (i = 0; i &lt; series.length; ++i) {</span>
<a href="#l18.279"></a><span id="l18.279" class="difflineminus">-                var sc = series[i].color;</span>
<a href="#l18.280"></a><span id="l18.280" class="difflineminus">-                if (sc != null) {</span>
<a href="#l18.281"></a><span id="l18.281" class="difflineminus">-                    --neededColors;</span>
<a href="#l18.282"></a><span id="l18.282" class="difflineminus">-                    if (typeof sc == &quot;number&quot;)</span>
<a href="#l18.283"></a><span id="l18.283" class="difflineminus">-                        assignedColors.push(sc);</span>
<a href="#l18.284"></a><span id="l18.284" class="difflineminus">-                    else</span>
<a href="#l18.285"></a><span id="l18.285" class="difflineminus">-                        usedColors.push($.color.parse(series[i].color));</span>
<a href="#l18.286"></a><span id="l18.286" class="difflineminus">-                }</span>
<a href="#l18.287"></a><span id="l18.287" class="difflineminus">-            }</span>
<a href="#l18.288"></a><span id="l18.288" class="difflineminus">-            </span>
<a href="#l18.289"></a><span id="l18.289" class="difflineminus">-            // we might need to generate more colors if higher indices</span>
<a href="#l18.290"></a><span id="l18.290" class="difflineminus">-            // are assigned</span>
<a href="#l18.291"></a><span id="l18.291" class="difflineminus">-            for (i = 0; i &lt; assignedColors.length; ++i) {</span>
<a href="#l18.292"></a><span id="l18.292" class="difflineminus">-                neededColors = Math.max(neededColors, assignedColors[i] + 1);</span>
<a href="#l18.293"></a><span id="l18.293" class="difflineminus">-            }</span>
<a href="#l18.294"></a><span id="l18.294" class="difflineminus">-</span>
<a href="#l18.295"></a><span id="l18.295" class="difflineminus">-            // produce colors as needed</span>
<a href="#l18.296"></a><span id="l18.296" class="difflineminus">-            var colors = [], variation = 0;</span>
<a href="#l18.297"></a><span id="l18.297" class="difflineminus">-            i = 0;</span>
<a href="#l18.298"></a><span id="l18.298" class="difflineminus">-            while (colors.length &lt; neededColors) {</span>
<a href="#l18.299"></a><span id="l18.299" class="difflineminus">-                var c;</span>
<a href="#l18.300"></a><span id="l18.300" class="difflineminus">-                if (options.colors.length == i) // check degenerate case</span>
<a href="#l18.301"></a><span id="l18.301" class="difflineminus">-                    c = $.color.make(100, 100, 100);</span>
<a href="#l18.302"></a><span id="l18.302" class="difflineminus">-                else</span>
<a href="#l18.303"></a><span id="l18.303" class="difflineminus">-                    c = $.color.parse(options.colors[i]);</span>
<a href="#l18.304"></a><span id="l18.304" class="difflineminus">-</span>
<a href="#l18.305"></a><span id="l18.305" class="difflineminus">-                // vary color if needed</span>
<a href="#l18.306"></a><span id="l18.306" class="difflineminus">-                var sign = variation % 2 == 1 ? -1 : 1;</span>
<a href="#l18.307"></a><span id="l18.307" class="difflineminus">-                c.scale('rgb', 1 + sign * Math.ceil(variation / 2) * 0.2)</span>
<a href="#l18.308"></a><span id="l18.308" class="difflineminus">-</span>
<a href="#l18.309"></a><span id="l18.309" class="difflineminus">-                // FIXME: if we're getting to close to something else,</span>
<a href="#l18.310"></a><span id="l18.310" class="difflineminus">-                // we should probably skip this one</span>
<a href="#l18.311"></a><span id="l18.311" class="difflineminus">-                colors.push(c);</span>
<a href="#l18.312"></a><span id="l18.312" class="difflineminus">-                </span>
<a href="#l18.313"></a><span id="l18.313" class="difflineminus">-                ++i;</span>
<a href="#l18.314"></a><span id="l18.314" class="difflineminus">-                if (i &gt;= options.colors.length) {</span>
<a href="#l18.315"></a><span id="l18.315" class="difflineminus">-                    i = 0;</span>
<a href="#l18.316"></a><span id="l18.316" class="difflineminus">-                    ++variation;</span>
<a href="#l18.317"></a><span id="l18.317" class="difflineminus">-                }</span>
<a href="#l18.318"></a><span id="l18.318" class="difflineminus">-            }</span>
<a href="#l18.319"></a><span id="l18.319" class="difflineminus">-</span>
<a href="#l18.320"></a><span id="l18.320" class="difflineminus">-            // fill in the options</span>
<a href="#l18.321"></a><span id="l18.321" class="difflineminus">-            var colori = 0, s;</span>
<a href="#l18.322"></a><span id="l18.322" class="difflineminus">-            for (i = 0; i &lt; series.length; ++i) {</span>
<a href="#l18.323"></a><span id="l18.323" class="difflineminus">-                s = series[i];</span>
<a href="#l18.324"></a><span id="l18.324" class="difflineminus">-                </span>
<a href="#l18.325"></a><span id="l18.325" class="difflineminus">-                // assign colors</span>
<a href="#l18.326"></a><span id="l18.326" class="difflineminus">-                if (s.color == null) {</span>
<a href="#l18.327"></a><span id="l18.327" class="difflineminus">-                    s.color = colors[colori].toString();</span>
<a href="#l18.328"></a><span id="l18.328" class="difflineminus">-                    ++colori;</span>
<a href="#l18.329"></a><span id="l18.329" class="difflineminus">-                }</span>
<a href="#l18.330"></a><span id="l18.330" class="difflineminus">-                else if (typeof s.color == &quot;number&quot;)</span>
<a href="#l18.331"></a><span id="l18.331" class="difflineminus">-                    s.color = colors[s.color].toString();</span>
<a href="#l18.332"></a><span id="l18.332" class="difflineminus">-</span>
<a href="#l18.333"></a><span id="l18.333" class="difflineminus">-                // turn on lines automatically in case nothing is set</span>
<a href="#l18.334"></a><span id="l18.334" class="difflineminus">-                if (s.lines.show == null) {</span>
<a href="#l18.335"></a><span id="l18.335" class="difflineminus">-                    var v, show = true;</span>
<a href="#l18.336"></a><span id="l18.336" class="difflineminus">-                    for (v in s)</span>
<a href="#l18.337"></a><span id="l18.337" class="difflineminus">-                        if (s[v].show) {</span>
<a href="#l18.338"></a><span id="l18.338" class="difflineminus">-                            show = false;</span>
<a href="#l18.339"></a><span id="l18.339" class="difflineminus">-                            break;</span>
<a href="#l18.340"></a><span id="l18.340" class="difflineminus">-                        }</span>
<a href="#l18.341"></a><span id="l18.341" class="difflineminus">-                    if (show)</span>
<a href="#l18.342"></a><span id="l18.342" class="difflineminus">-                        s.lines.show = true;</span>
<a href="#l18.343"></a><span id="l18.343" class="difflineminus">-                }</span>
<a href="#l18.344"></a><span id="l18.344" class="difflineminus">-</span>
<a href="#l18.345"></a><span id="l18.345" class="difflineminus">-                // setup axes</span>
<a href="#l18.346"></a><span id="l18.346" class="difflineminus">-                s.xaxis = axisSpecToRealAxis(s, &quot;xaxis&quot;);</span>
<a href="#l18.347"></a><span id="l18.347" class="difflineminus">-                s.yaxis = axisSpecToRealAxis(s, &quot;yaxis&quot;);</span>
<a href="#l18.348"></a><span id="l18.348" class="difflineminus">-            }</span>
<a href="#l18.349"></a><span id="l18.349" class="difflineminus">-        }</span>
<a href="#l18.350"></a><span id="l18.350" class="difflineminus">-        </span>
<a href="#l18.351"></a><span id="l18.351" class="difflineminus">-        function processData() {</span>
<a href="#l18.352"></a><span id="l18.352" class="difflineminus">-            var topSentry = Number.POSITIVE_INFINITY,</span>
<a href="#l18.353"></a><span id="l18.353" class="difflineminus">-                bottomSentry = Number.NEGATIVE_INFINITY,</span>
<a href="#l18.354"></a><span id="l18.354" class="difflineminus">-                i, j, k, m, length,</span>
<a href="#l18.355"></a><span id="l18.355" class="difflineminus">-                s, points, ps, x, y, axis, val, f, p;</span>
<a href="#l18.356"></a><span id="l18.356" class="difflineminus">-</span>
<a href="#l18.357"></a><span id="l18.357" class="difflineminus">-            for (axis in axes) {</span>
<a href="#l18.358"></a><span id="l18.358" class="difflineminus">-                axes[axis].datamin = topSentry;</span>
<a href="#l18.359"></a><span id="l18.359" class="difflineminus">-                axes[axis].datamax = bottomSentry;</span>
<a href="#l18.360"></a><span id="l18.360" class="difflineminus">-                axes[axis].used = false;</span>
<a href="#l18.361"></a><span id="l18.361" class="difflineminus">-            }</span>
<a href="#l18.362"></a><span id="l18.362" class="difflineminus">-</span>
<a href="#l18.363"></a><span id="l18.363" class="difflineminus">-            function updateAxis(axis, min, max) {</span>
<a href="#l18.364"></a><span id="l18.364" class="difflineminus">-                if (min &lt; axis.datamin)</span>
<a href="#l18.365"></a><span id="l18.365" class="difflineminus">-                    axis.datamin = min;</span>
<a href="#l18.366"></a><span id="l18.366" class="difflineminus">-                if (max &gt; axis.datamax)</span>
<a href="#l18.367"></a><span id="l18.367" class="difflineminus">-                    axis.datamax = max;</span>
<a href="#l18.368"></a><span id="l18.368" class="difflineminus">-            }</span>
<a href="#l18.369"></a><span id="l18.369" class="difflineminus">-</span>
<a href="#l18.370"></a><span id="l18.370" class="difflineminus">-            for (i = 0; i &lt; series.length; ++i) {</span>
<a href="#l18.371"></a><span id="l18.371" class="difflineminus">-                s = series[i];</span>
<a href="#l18.372"></a><span id="l18.372" class="difflineminus">-                s.datapoints = { points: [] };</span>
<a href="#l18.373"></a><span id="l18.373" class="difflineminus">-                </span>
<a href="#l18.374"></a><span id="l18.374" class="difflineminus">-                executeHooks(hooks.processRawData, [ s, s.data, s.datapoints ]);</span>
<a href="#l18.375"></a><span id="l18.375" class="difflineminus">-            }</span>
<a href="#l18.376"></a><span id="l18.376" class="difflineminus">-            </span>
<a href="#l18.377"></a><span id="l18.377" class="difflineminus">-            // first pass: clean and copy data</span>
<a href="#l18.378"></a><span id="l18.378" class="difflineminus">-            for (i = 0; i &lt; series.length; ++i) {</span>
<a href="#l18.379"></a><span id="l18.379" class="difflineminus">-                s = series[i];</span>
<a href="#l18.380"></a><span id="l18.380" class="difflineminus">-</span>
<a href="#l18.381"></a><span id="l18.381" class="difflineminus">-                var data = s.data, format = s.datapoints.format;</span>
<a href="#l18.382"></a><span id="l18.382" class="difflineminus">-</span>
<a href="#l18.383"></a><span id="l18.383" class="difflineminus">-                if (!format) {</span>
<a href="#l18.384"></a><span id="l18.384" class="difflineminus">-                    format = [];</span>
<a href="#l18.385"></a><span id="l18.385" class="difflineminus">-                    // find out how to copy</span>
<a href="#l18.386"></a><span id="l18.386" class="difflineminus">-                    format.push({ x: true, number: true, required: true });</span>
<a href="#l18.387"></a><span id="l18.387" class="difflineminus">-                    format.push({ y: true, number: true, required: true });</span>
<a href="#l18.388"></a><span id="l18.388" class="difflineminus">-</span>
<a href="#l18.389"></a><span id="l18.389" class="difflineminus">-                    if (s.bars.show)</span>
<a href="#l18.390"></a><span id="l18.390" class="difflineminus">-                        format.push({ y: true, number: true, required: false, defaultValue: 0 });</span>
<a href="#l18.391"></a><span id="l18.391" class="difflineminus">-                    </span>
<a href="#l18.392"></a><span id="l18.392" class="difflineminus">-                    s.datapoints.format = format;</span>
<a href="#l18.393"></a><span id="l18.393" class="difflineminus">-                }</span>
<a href="#l18.394"></a><span id="l18.394" class="difflineminus">-</span>
<a href="#l18.395"></a><span id="l18.395" class="difflineminus">-                if (s.datapoints.pointsize != null)</span>
<a href="#l18.396"></a><span id="l18.396" class="difflineminus">-                    continue; // already filled in</span>
<a href="#l18.397"></a><span id="l18.397" class="difflineminus">-</span>
<a href="#l18.398"></a><span id="l18.398" class="difflineminus">-                if (s.datapoints.pointsize == null)</span>
<a href="#l18.399"></a><span id="l18.399" class="difflineminus">-                    s.datapoints.pointsize = format.length;</span>
<a href="#l18.400"></a><span id="l18.400" class="difflineminus">-                </span>
<a href="#l18.401"></a><span id="l18.401" class="difflineminus">-                ps = s.datapoints.pointsize;</span>
<a href="#l18.402"></a><span id="l18.402" class="difflineminus">-                points = s.datapoints.points;</span>
<a href="#l18.403"></a><span id="l18.403" class="difflineminus">-</span>
<a href="#l18.404"></a><span id="l18.404" class="difflineminus">-                insertSteps = s.lines.show &amp;&amp; s.lines.steps;</span>
<a href="#l18.405"></a><span id="l18.405" class="difflineminus">-                s.xaxis.used = s.yaxis.used = true;</span>
<a href="#l18.406"></a><span id="l18.406" class="difflineminus">-                </span>
<a href="#l18.407"></a><span id="l18.407" class="difflineminus">-                for (j = k = 0; j &lt; data.length; ++j, k += ps) {</span>
<a href="#l18.408"></a><span id="l18.408" class="difflineminus">-                    p = data[j];</span>
<a href="#l18.409"></a><span id="l18.409" class="difflineminus">-</span>
<a href="#l18.410"></a><span id="l18.410" class="difflineminus">-                    var nullify = p == null;</span>
<a href="#l18.411"></a><span id="l18.411" class="difflineminus">-                    if (!nullify) {</span>
<a href="#l18.412"></a><span id="l18.412" class="difflineminus">-                        for (m = 0; m &lt; ps; ++m) {</span>
<a href="#l18.413"></a><span id="l18.413" class="difflineminus">-                            val = p[m];</span>
<a href="#l18.414"></a><span id="l18.414" class="difflineminus">-                            f = format[m];</span>
<a href="#l18.415"></a><span id="l18.415" class="difflineminus">-</span>
<a href="#l18.416"></a><span id="l18.416" class="difflineminus">-                            if (f) {</span>
<a href="#l18.417"></a><span id="l18.417" class="difflineminus">-                                if (f.number &amp;&amp; val != null) {</span>
<a href="#l18.418"></a><span id="l18.418" class="difflineminus">-                                    val = +val; // convert to number</span>
<a href="#l18.419"></a><span id="l18.419" class="difflineminus">-                                    if (isNaN(val))</span>
<a href="#l18.420"></a><span id="l18.420" class="difflineminus">-                                        val = null;</span>
<a href="#l18.421"></a><span id="l18.421" class="difflineminus">-                                }</span>
<a href="#l18.422"></a><span id="l18.422" class="difflineminus">-</span>
<a href="#l18.423"></a><span id="l18.423" class="difflineminus">-                                if (val == null) {</span>
<a href="#l18.424"></a><span id="l18.424" class="difflineminus">-                                    if (f.required)</span>
<a href="#l18.425"></a><span id="l18.425" class="difflineminus">-                                        nullify = true;</span>
<a href="#l18.426"></a><span id="l18.426" class="difflineminus">-                                    </span>
<a href="#l18.427"></a><span id="l18.427" class="difflineminus">-                                    if (f.defaultValue != null)</span>
<a href="#l18.428"></a><span id="l18.428" class="difflineminus">-                                        val = f.defaultValue;</span>
<a href="#l18.429"></a><span id="l18.429" class="difflineminus">-                                }</span>
<a href="#l18.430"></a><span id="l18.430" class="difflineminus">-                            }</span>
<a href="#l18.431"></a><span id="l18.431" class="difflineminus">-                            </span>
<a href="#l18.432"></a><span id="l18.432" class="difflineminus">-                            points[k + m] = val;</span>
<a href="#l18.433"></a><span id="l18.433" class="difflineminus">-                        }</span>
<a href="#l18.434"></a><span id="l18.434" class="difflineminus">-                    }</span>
<a href="#l18.435"></a><span id="l18.435" class="difflineminus">-                    </span>
<a href="#l18.436"></a><span id="l18.436" class="difflineminus">-                    if (nullify) {</span>
<a href="#l18.437"></a><span id="l18.437" class="difflineminus">-                        for (m = 0; m &lt; ps; ++m) {</span>
<a href="#l18.438"></a><span id="l18.438" class="difflineminus">-                            val = points[k + m];</span>
<a href="#l18.439"></a><span id="l18.439" class="difflineminus">-                            if (val != null) {</span>
<a href="#l18.440"></a><span id="l18.440" class="difflineminus">-                                f = format[m];</span>
<a href="#l18.441"></a><span id="l18.441" class="difflineminus">-                                // extract min/max info</span>
<a href="#l18.442"></a><span id="l18.442" class="difflineminus">-                                if (f.x)</span>
<a href="#l18.443"></a><span id="l18.443" class="difflineminus">-                                    updateAxis(s.xaxis, val, val);</span>
<a href="#l18.444"></a><span id="l18.444" class="difflineminus">-                                if (f.y)</span>
<a href="#l18.445"></a><span id="l18.445" class="difflineminus">-                                    updateAxis(s.yaxis, val, val);</span>
<a href="#l18.446"></a><span id="l18.446" class="difflineminus">-                            }</span>
<a href="#l18.447"></a><span id="l18.447" class="difflineminus">-                            points[k + m] = null;</span>
<a href="#l18.448"></a><span id="l18.448" class="difflineminus">-                        }</span>
<a href="#l18.449"></a><span id="l18.449" class="difflineminus">-                    }</span>
<a href="#l18.450"></a><span id="l18.450" class="difflineminus">-                    else {</span>
<a href="#l18.451"></a><span id="l18.451" class="difflineminus">-                        // a little bit of line specific stuff that</span>
<a href="#l18.452"></a><span id="l18.452" class="difflineminus">-                        // perhaps shouldn't be here, but lacking</span>
<a href="#l18.453"></a><span id="l18.453" class="difflineminus">-                        // better means...</span>
<a href="#l18.454"></a><span id="l18.454" class="difflineminus">-                        if (insertSteps &amp;&amp; k &gt; 0</span>
<a href="#l18.455"></a><span id="l18.455" class="difflineminus">-                            &amp;&amp; points[k - ps] != null</span>
<a href="#l18.456"></a><span id="l18.456" class="difflineminus">-                            &amp;&amp; points[k - ps] != points[k]</span>
<a href="#l18.457"></a><span id="l18.457" class="difflineminus">-                            &amp;&amp; points[k - ps + 1] != points[k + 1]) {</span>
<a href="#l18.458"></a><span id="l18.458" class="difflineminus">-                            // copy the point to make room for a middle point</span>
<a href="#l18.459"></a><span id="l18.459" class="difflineminus">-                            for (m = 0; m &lt; ps; ++m)</span>
<a href="#l18.460"></a><span id="l18.460" class="difflineminus">-                                points[k + ps + m] = points[k + m];</span>
<a href="#l18.461"></a><span id="l18.461" class="difflineminus">-</span>
<a href="#l18.462"></a><span id="l18.462" class="difflineminus">-                            // middle point has same y</span>
<a href="#l18.463"></a><span id="l18.463" class="difflineminus">-                            points[k + 1] = points[k - ps + 1];</span>
<a href="#l18.464"></a><span id="l18.464" class="difflineminus">-</span>
<a href="#l18.465"></a><span id="l18.465" class="difflineminus">-                            // we've added a point, better reflect that</span>
<a href="#l18.466"></a><span id="l18.466" class="difflineminus">-                            k += ps;</span>
<a href="#l18.467"></a><span id="l18.467" class="difflineminus">-                        }</span>
<a href="#l18.468"></a><span id="l18.468" class="difflineminus">-                    }</span>
<a href="#l18.469"></a><span id="l18.469" class="difflineminus">-                }</span>
<a href="#l18.470"></a><span id="l18.470" class="difflineminus">-            }</span>
<a href="#l18.471"></a><span id="l18.471" class="difflineminus">-</span>
<a href="#l18.472"></a><span id="l18.472" class="difflineminus">-            // give the hooks a chance to run</span>
<a href="#l18.473"></a><span id="l18.473" class="difflineminus">-            for (i = 0; i &lt; series.length; ++i) {</span>
<a href="#l18.474"></a><span id="l18.474" class="difflineminus">-                s = series[i];</span>
<a href="#l18.475"></a><span id="l18.475" class="difflineminus">-                </span>
<a href="#l18.476"></a><span id="l18.476" class="difflineminus">-                executeHooks(hooks.processDatapoints, [ s, s.datapoints]);</span>
<a href="#l18.477"></a><span id="l18.477" class="difflineminus">-            }</span>
<a href="#l18.478"></a><span id="l18.478" class="difflineminus">-</span>
<a href="#l18.479"></a><span id="l18.479" class="difflineminus">-            // second pass: find datamax/datamin for auto-scaling</span>
<a href="#l18.480"></a><span id="l18.480" class="difflineminus">-            for (i = 0; i &lt; series.length; ++i) {</span>
<a href="#l18.481"></a><span id="l18.481" class="difflineminus">-                s = series[i];</span>
<a href="#l18.482"></a><span id="l18.482" class="difflineminus">-                points = s.datapoints.points,</span>
<a href="#l18.483"></a><span id="l18.483" class="difflineminus">-                ps = s.datapoints.pointsize;</span>
<a href="#l18.484"></a><span id="l18.484" class="difflineminus">-</span>
<a href="#l18.485"></a><span id="l18.485" class="difflineminus">-                var xmin = topSentry, ymin = topSentry,</span>
<a href="#l18.486"></a><span id="l18.486" class="difflineminus">-                    xmax = bottomSentry, ymax = bottomSentry;</span>
<a href="#l18.487"></a><span id="l18.487" class="difflineminus">-                </span>
<a href="#l18.488"></a><span id="l18.488" class="difflineminus">-                for (j = 0; j &lt; points.length; j += ps) {</span>
<a href="#l18.489"></a><span id="l18.489" class="difflineminus">-                    if (points[j] == null)</span>
<a href="#l18.490"></a><span id="l18.490" class="difflineminus">-                        continue;</span>
<a href="#l18.491"></a><span id="l18.491" class="difflineminus">-</span>
<a href="#l18.492"></a><span id="l18.492" class="difflineminus">-                    for (m = 0; m &lt; ps; ++m) {</span>
<a href="#l18.493"></a><span id="l18.493" class="difflineminus">-                        val = points[j + m];</span>
<a href="#l18.494"></a><span id="l18.494" class="difflineminus">-                        f = format[m];</span>
<a href="#l18.495"></a><span id="l18.495" class="difflineminus">-                        if (!f)</span>
<a href="#l18.496"></a><span id="l18.496" class="difflineminus">-                            continue;</span>
<a href="#l18.497"></a><span id="l18.497" class="difflineminus">-                        </span>
<a href="#l18.498"></a><span id="l18.498" class="difflineminus">-                        if (f.x) {</span>
<a href="#l18.499"></a><span id="l18.499" class="difflineminus">-                            if (val &lt; xmin)</span>
<a href="#l18.500"></a><span id="l18.500" class="difflineminus">-                                xmin = val;</span>
<a href="#l18.501"></a><span id="l18.501" class="difflineminus">-                            if (val &gt; xmax)</span>
<a href="#l18.502"></a><span id="l18.502" class="difflineminus">-                                xmax = val;</span>
<a href="#l18.503"></a><span id="l18.503" class="difflineminus">-                        }</span>
<a href="#l18.504"></a><span id="l18.504" class="difflineminus">-                        if (f.y) {</span>
<a href="#l18.505"></a><span id="l18.505" class="difflineminus">-                            if (val &lt; ymin)</span>
<a href="#l18.506"></a><span id="l18.506" class="difflineminus">-                                ymin = val;</span>
<a href="#l18.507"></a><span id="l18.507" class="difflineminus">-                            if (val &gt; ymax)</span>
<a href="#l18.508"></a><span id="l18.508" class="difflineminus">-                                ymax = val;</span>
<a href="#l18.509"></a><span id="l18.509" class="difflineminus">-                        }</span>
<a href="#l18.510"></a><span id="l18.510" class="difflineminus">-                    }</span>
<a href="#l18.511"></a><span id="l18.511" class="difflineminus">-                }</span>
<a href="#l18.512"></a><span id="l18.512" class="difflineminus">-                </span>
<a href="#l18.513"></a><span id="l18.513" class="difflineminus">-                if (s.bars.show) {</span>
<a href="#l18.514"></a><span id="l18.514" class="difflineminus">-                    // make sure we got room for the bar on the dancing floor</span>
<a href="#l18.515"></a><span id="l18.515" class="difflineminus">-                    var delta = s.bars.align == &quot;left&quot; ? 0 : -s.bars.barWidth/2;</span>
<a href="#l18.516"></a><span id="l18.516" class="difflineminus">-                    if (s.bars.horizontal) {</span>
<a href="#l18.517"></a><span id="l18.517" class="difflineminus">-                        ymin += delta;</span>
<a href="#l18.518"></a><span id="l18.518" class="difflineminus">-                        ymax += delta + s.bars.barWidth;</span>
<a href="#l18.519"></a><span id="l18.519" class="difflineminus">-                    }</span>
<a href="#l18.520"></a><span id="l18.520" class="difflineminus">-                    else {</span>
<a href="#l18.521"></a><span id="l18.521" class="difflineminus">-                        xmin += delta;</span>
<a href="#l18.522"></a><span id="l18.522" class="difflineminus">-                        xmax += delta + s.bars.barWidth;</span>
<a href="#l18.523"></a><span id="l18.523" class="difflineminus">-                    }</span>
<a href="#l18.524"></a><span id="l18.524" class="difflineminus">-                }</span>
<a href="#l18.525"></a><span id="l18.525" class="difflineminus">-                </span>
<a href="#l18.526"></a><span id="l18.526" class="difflineminus">-                updateAxis(s.xaxis, xmin, xmax);</span>
<a href="#l18.527"></a><span id="l18.527" class="difflineminus">-                updateAxis(s.yaxis, ymin, ymax);</span>
<a href="#l18.528"></a><span id="l18.528" class="difflineminus">-            }</span>
<a href="#l18.529"></a><span id="l18.529" class="difflineminus">-</span>
<a href="#l18.530"></a><span id="l18.530" class="difflineminus">-            for (axis in axes) {</span>
<a href="#l18.531"></a><span id="l18.531" class="difflineminus">-                if (axes[axis].datamin == topSentry)</span>
<a href="#l18.532"></a><span id="l18.532" class="difflineminus">-                    axes[axis].datamin = null;</span>
<a href="#l18.533"></a><span id="l18.533" class="difflineminus">-                if (axes[axis].datamax == bottomSentry)</span>
<a href="#l18.534"></a><span id="l18.534" class="difflineminus">-                    axes[axis].datamax = null;</span>
<a href="#l18.535"></a><span id="l18.535" class="difflineminus">-            }</span>
<a href="#l18.536"></a><span id="l18.536" class="difflineminus">-        }</span>
<a href="#l18.537"></a><span id="l18.537" class="difflineminus">-</span>
<a href="#l18.538"></a><span id="l18.538" class="difflineminus">-        function constructCanvas() {</span>
<a href="#l18.539"></a><span id="l18.539" class="difflineminus">-            function makeCanvas(width, height) {</span>
<a href="#l18.540"></a><span id="l18.540" class="difflineminus">-                var c = document.createElement('canvas');</span>
<a href="#l18.541"></a><span id="l18.541" class="difflineminus">-                c.width = width;</span>
<a href="#l18.542"></a><span id="l18.542" class="difflineminus">-                c.height = height;</span>
<a href="#l18.543"></a><span id="l18.543" class="difflineminus">-                if ($.browser.msie) // excanvas hack</span>
<a href="#l18.544"></a><span id="l18.544" class="difflineminus">-                    c = window.G_vmlCanvasManager.initElement(c);</span>
<a href="#l18.545"></a><span id="l18.545" class="difflineminus">-                return c;</span>
<a href="#l18.546"></a><span id="l18.546" class="difflineminus">-            }</span>
<a href="#l18.547"></a><span id="l18.547" class="difflineminus">-            </span>
<a href="#l18.548"></a><span id="l18.548" class="difflineminus">-            canvasWidth = placeholder.width();</span>
<a href="#l18.549"></a><span id="l18.549" class="difflineminus">-            canvasHeight = placeholder.height();</span>
<a href="#l18.550"></a><span id="l18.550" class="difflineminus">-            placeholder.html(&quot;&quot;); // clear placeholder</span>
<a href="#l18.551"></a><span id="l18.551" class="difflineminus">-            if (placeholder.css(&quot;position&quot;) == 'static')</span>
<a href="#l18.552"></a><span id="l18.552" class="difflineminus">-                placeholder.css(&quot;position&quot;, &quot;relative&quot;); // for positioning labels and overlay</span>
<a href="#l18.553"></a><span id="l18.553" class="difflineminus">-</span>
<a href="#l18.554"></a><span id="l18.554" class="difflineminus">-            if (canvasWidth &lt;= 0 || canvasHeight &lt;= 0)</span>
<a href="#l18.555"></a><span id="l18.555" class="difflineminus">-                throw &quot;Invalid dimensions for plot, width = &quot; + canvasWidth + &quot;, height = &quot; + canvasHeight;</span>
<a href="#l18.556"></a><span id="l18.556" class="difflineminus">-</span>
<a href="#l18.557"></a><span id="l18.557" class="difflineminus">-            if ($.browser.msie) // excanvas hack</span>
<a href="#l18.558"></a><span id="l18.558" class="difflineminus">-                window.G_vmlCanvasManager.init_(document); // make sure everything is setup</span>
<a href="#l18.559"></a><span id="l18.559" class="difflineminus">-            </span>
<a href="#l18.560"></a><span id="l18.560" class="difflineminus">-            // the canvas</span>
<a href="#l18.561"></a><span id="l18.561" class="difflineminus">-            canvas = $(makeCanvas(canvasWidth, canvasHeight)).appendTo(placeholder).get(0);</span>
<a href="#l18.562"></a><span id="l18.562" class="difflineminus">-            ctx = canvas.getContext(&quot;2d&quot;);</span>
<a href="#l18.563"></a><span id="l18.563" class="difflineminus">-</span>
<a href="#l18.564"></a><span id="l18.564" class="difflineminus">-            // overlay canvas for interactive features</span>
<a href="#l18.565"></a><span id="l18.565" class="difflineminus">-            overlay = $(makeCanvas(canvasWidth, canvasHeight)).css({ position: 'absolute', left: 0, top: 0 }).appendTo(placeholder).get(0);</span>
<a href="#l18.566"></a><span id="l18.566" class="difflineminus">-            octx = overlay.getContext(&quot;2d&quot;);</span>
<a href="#l18.567"></a><span id="l18.567" class="difflineminus">-            octx.stroke();</span>
<a href="#l18.568"></a><span id="l18.568" class="difflineminus">-        }</span>
<a href="#l18.569"></a><span id="l18.569" class="difflineminus">-</span>
<a href="#l18.570"></a><span id="l18.570" class="difflineminus">-        function bindEvents() {</span>
<a href="#l18.571"></a><span id="l18.571" class="difflineminus">-            // we include the canvas in the event holder too, because IE 7</span>
<a href="#l18.572"></a><span id="l18.572" class="difflineminus">-            // sometimes has trouble with the stacking order</span>
<a href="#l18.573"></a><span id="l18.573" class="difflineminus">-            eventHolder = $([overlay, canvas]);</span>
<a href="#l18.574"></a><span id="l18.574" class="difflineminus">-</span>
<a href="#l18.575"></a><span id="l18.575" class="difflineminus">-            // bind events</span>
<a href="#l18.576"></a><span id="l18.576" class="difflineminus">-            if (options.grid.hoverable)</span>
<a href="#l18.577"></a><span id="l18.577" class="difflineminus">-                eventHolder.mousemove(onMouseMove);</span>
<a href="#l18.578"></a><span id="l18.578" class="difflineminus">-</span>
<a href="#l18.579"></a><span id="l18.579" class="difflineminus">-            if (options.grid.clickable)</span>
<a href="#l18.580"></a><span id="l18.580" class="difflineminus">-                eventHolder.click(onClick);</span>
<a href="#l18.581"></a><span id="l18.581" class="difflineminus">-</span>
<a href="#l18.582"></a><span id="l18.582" class="difflineminus">-            executeHooks(hooks.bindEvents, [eventHolder]);</span>
<a href="#l18.583"></a><span id="l18.583" class="difflineminus">-        }</span>
<a href="#l18.584"></a><span id="l18.584" class="difflineminus">-</span>
<a href="#l18.585"></a><span id="l18.585" class="difflineminus">-        function setupGrid() {</span>
<a href="#l18.586"></a><span id="l18.586" class="difflineminus">-            function setTransformationHelpers(axis, o) {</span>
<a href="#l18.587"></a><span id="l18.587" class="difflineminus">-                function identity(x) { return x; }</span>
<a href="#l18.588"></a><span id="l18.588" class="difflineminus">-                </span>
<a href="#l18.589"></a><span id="l18.589" class="difflineminus">-                var s, m, t = o.transform || identity,</span>
<a href="#l18.590"></a><span id="l18.590" class="difflineminus">-                    it = o.inverseTransform;</span>
<a href="#l18.591"></a><span id="l18.591" class="difflineminus">-                    </span>
<a href="#l18.592"></a><span id="l18.592" class="difflineminus">-                // add transformation helpers</span>
<a href="#l18.593"></a><span id="l18.593" class="difflineminus">-                if (axis == axes.xaxis || axis == axes.x2axis) {</span>
<a href="#l18.594"></a><span id="l18.594" class="difflineminus">-                    // precompute how much the axis is scaling a point</span>
<a href="#l18.595"></a><span id="l18.595" class="difflineminus">-                    // in canvas space</span>
<a href="#l18.596"></a><span id="l18.596" class="difflineminus">-                    s = axis.scale = plotWidth / (t(axis.max) - t(axis.min));</span>
<a href="#l18.597"></a><span id="l18.597" class="difflineminus">-                    m = t(axis.min);</span>
<a href="#l18.598"></a><span id="l18.598" class="difflineminus">-</span>
<a href="#l18.599"></a><span id="l18.599" class="difflineminus">-                    // data point to canvas coordinate</span>
<a href="#l18.600"></a><span id="l18.600" class="difflineminus">-                    if (t == identity) // slight optimization</span>
<a href="#l18.601"></a><span id="l18.601" class="difflineminus">-                        axis.p2c = function (p) { return (p - m) * s; };</span>
<a href="#l18.602"></a><span id="l18.602" class="difflineminus">-                    else</span>
<a href="#l18.603"></a><span id="l18.603" class="difflineminus">-                        axis.p2c = function (p) { return (t(p) - m) * s; };</span>
<a href="#l18.604"></a><span id="l18.604" class="difflineminus">-                    // canvas coordinate to data point</span>
<a href="#l18.605"></a><span id="l18.605" class="difflineminus">-                    if (!it)</span>
<a href="#l18.606"></a><span id="l18.606" class="difflineminus">-                        axis.c2p = function (c) { return m + c / s; };</span>
<a href="#l18.607"></a><span id="l18.607" class="difflineminus">-                    else</span>
<a href="#l18.608"></a><span id="l18.608" class="difflineminus">-                        axis.c2p = function (c) { return it(m + c / s); };</span>
<a href="#l18.609"></a><span id="l18.609" class="difflineminus">-                }</span>
<a href="#l18.610"></a><span id="l18.610" class="difflineminus">-                else {</span>
<a href="#l18.611"></a><span id="l18.611" class="difflineminus">-                    s = axis.scale = plotHeight / (t(axis.max) - t(axis.min));</span>
<a href="#l18.612"></a><span id="l18.612" class="difflineminus">-                    m = t(axis.max);</span>
<a href="#l18.613"></a><span id="l18.613" class="difflineminus">-                    </span>
<a href="#l18.614"></a><span id="l18.614" class="difflineminus">-                    if (t == identity)</span>
<a href="#l18.615"></a><span id="l18.615" class="difflineminus">-                        axis.p2c = function (p) { return (m - p) * s; };</span>
<a href="#l18.616"></a><span id="l18.616" class="difflineminus">-                    else</span>
<a href="#l18.617"></a><span id="l18.617" class="difflineminus">-                        axis.p2c = function (p) { return (m - t(p)) * s; };</span>
<a href="#l18.618"></a><span id="l18.618" class="difflineminus">-                    if (!it)</span>
<a href="#l18.619"></a><span id="l18.619" class="difflineminus">-                        axis.c2p = function (c) { return m - c / s; };</span>
<a href="#l18.620"></a><span id="l18.620" class="difflineminus">-                    else</span>
<a href="#l18.621"></a><span id="l18.621" class="difflineminus">-                        axis.c2p = function (c) { return it(m - c / s); };</span>
<a href="#l18.622"></a><span id="l18.622" class="difflineminus">-                }</span>
<a href="#l18.623"></a><span id="l18.623" class="difflineminus">-            }</span>
<a href="#l18.624"></a><span id="l18.624" class="difflineminus">-</span>
<a href="#l18.625"></a><span id="l18.625" class="difflineminus">-            function measureLabels(axis, axisOptions) {</span>
<a href="#l18.626"></a><span id="l18.626" class="difflineminus">-                var i, labels = [], l;</span>
<a href="#l18.627"></a><span id="l18.627" class="difflineminus">-                </span>
<a href="#l18.628"></a><span id="l18.628" class="difflineminus">-                axis.labelWidth = axisOptions.labelWidth;</span>
<a href="#l18.629"></a><span id="l18.629" class="difflineminus">-                axis.labelHeight = axisOptions.labelHeight;</span>
<a href="#l18.630"></a><span id="l18.630" class="difflineminus">-</span>
<a href="#l18.631"></a><span id="l18.631" class="difflineminus">-                if (axis == axes.xaxis || axis == axes.x2axis) {</span>
<a href="#l18.632"></a><span id="l18.632" class="difflineminus">-                    // to avoid measuring the widths of the labels, we</span>
<a href="#l18.633"></a><span id="l18.633" class="difflineminus">-                    // construct fixed-size boxes and put the labels inside</span>
<a href="#l18.634"></a><span id="l18.634" class="difflineminus">-                    // them, we don't need the exact figures and the</span>
<a href="#l18.635"></a><span id="l18.635" class="difflineminus">-                    // fixed-size box content is easy to center</span>
<a href="#l18.636"></a><span id="l18.636" class="difflineminus">-                    if (axis.labelWidth == null)</span>
<a href="#l18.637"></a><span id="l18.637" class="difflineminus">-                        axis.labelWidth = canvasWidth / (axis.ticks.length &gt; 0 ? axis.ticks.length : 1);</span>
<a href="#l18.638"></a><span id="l18.638" class="difflineminus">-</span>
<a href="#l18.639"></a><span id="l18.639" class="difflineminus">-                    // measure x label heights</span>
<a href="#l18.640"></a><span id="l18.640" class="difflineminus">-                    if (axis.labelHeight == null) {</span>
<a href="#l18.641"></a><span id="l18.641" class="difflineminus">-                        labels = [];</span>
<a href="#l18.642"></a><span id="l18.642" class="difflineminus">-                        for (i = 0; i &lt; axis.ticks.length; ++i) {</span>
<a href="#l18.643"></a><span id="l18.643" class="difflineminus">-                            l = axis.ticks[i].label;</span>
<a href="#l18.644"></a><span id="l18.644" class="difflineminus">-                            if (l)</span>
<a href="#l18.645"></a><span id="l18.645" class="difflineminus">-                                labels.push('&lt;div class=&quot;tickLabel&quot; style=&quot;float:left;width:' + axis.labelWidth + 'px&quot;&gt;' + l + '&lt;/div&gt;');</span>
<a href="#l18.646"></a><span id="l18.646" class="difflineminus">-                        }</span>
<a href="#l18.647"></a><span id="l18.647" class="difflineminus">-                        </span>
<a href="#l18.648"></a><span id="l18.648" class="difflineminus">-                        if (labels.length &gt; 0) {</span>
<a href="#l18.649"></a><span id="l18.649" class="difflineminus">-                            var dummyDiv = $('&lt;div style=&quot;position:absolute;top:-10000px;width:10000px;font-size:smaller&quot;&gt;'</span>
<a href="#l18.650"></a><span id="l18.650" class="difflineminus">-                                             + labels.join(&quot;&quot;) + '&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;&lt;/div&gt;').appendTo(placeholder);</span>
<a href="#l18.651"></a><span id="l18.651" class="difflineminus">-                            axis.labelHeight = dummyDiv.height();</span>
<a href="#l18.652"></a><span id="l18.652" class="difflineminus">-                            dummyDiv.remove();</span>
<a href="#l18.653"></a><span id="l18.653" class="difflineminus">-                        }</span>
<a href="#l18.654"></a><span id="l18.654" class="difflineminus">-                    }</span>
<a href="#l18.655"></a><span id="l18.655" class="difflineminus">-                }</span>
<a href="#l18.656"></a><span id="l18.656" class="difflineminus">-                else if (axis.labelWidth == null || axis.labelHeight == null) {</span>
<a href="#l18.657"></a><span id="l18.657" class="difflineminus">-                    // calculate y label dimensions</span>
<a href="#l18.658"></a><span id="l18.658" class="difflineminus">-                    for (i = 0; i &lt; axis.ticks.length; ++i) {</span>
<a href="#l18.659"></a><span id="l18.659" class="difflineminus">-                        l = axis.ticks[i].label;</span>
<a href="#l18.660"></a><span id="l18.660" class="difflineminus">-                        if (l)</span>
<a href="#l18.661"></a><span id="l18.661" class="difflineminus">-                            labels.push('&lt;div class=&quot;tickLabel&quot;&gt;' + l + '&lt;/div&gt;');</span>
<a href="#l18.662"></a><span id="l18.662" class="difflineminus">-                    }</span>
<a href="#l18.663"></a><span id="l18.663" class="difflineminus">-                    </span>
<a href="#l18.664"></a><span id="l18.664" class="difflineminus">-                    if (labels.length &gt; 0) {</span>
<a href="#l18.665"></a><span id="l18.665" class="difflineminus">-                        var dummyDiv = $('&lt;div style=&quot;position:absolute;top:-10000px;font-size:smaller&quot;&gt;'</span>
<a href="#l18.666"></a><span id="l18.666" class="difflineminus">-                                         + labels.join(&quot;&quot;) + '&lt;/div&gt;').appendTo(placeholder);</span>
<a href="#l18.667"></a><span id="l18.667" class="difflineminus">-                        if (axis.labelWidth == null)</span>
<a href="#l18.668"></a><span id="l18.668" class="difflineminus">-                            axis.labelWidth = dummyDiv.width();</span>
<a href="#l18.669"></a><span id="l18.669" class="difflineminus">-                        if (axis.labelHeight == null)</span>
<a href="#l18.670"></a><span id="l18.670" class="difflineminus">-                            axis.labelHeight = dummyDiv.find(&quot;div&quot;).height();</span>
<a href="#l18.671"></a><span id="l18.671" class="difflineminus">-                        dummyDiv.remove();</span>
<a href="#l18.672"></a><span id="l18.672" class="difflineminus">-                    }</span>
<a href="#l18.673"></a><span id="l18.673" class="difflineminus">-                    </span>
<a href="#l18.674"></a><span id="l18.674" class="difflineminus">-                }</span>
<a href="#l18.675"></a><span id="l18.675" class="difflineminus">-</span>
<a href="#l18.676"></a><span id="l18.676" class="difflineminus">-                if (axis.labelWidth == null)</span>
<a href="#l18.677"></a><span id="l18.677" class="difflineminus">-                    axis.labelWidth = 0;</span>
<a href="#l18.678"></a><span id="l18.678" class="difflineminus">-                if (axis.labelHeight == null)</span>
<a href="#l18.679"></a><span id="l18.679" class="difflineminus">-                    axis.labelHeight = 0;</span>
<a href="#l18.680"></a><span id="l18.680" class="difflineminus">-            }</span>
<a href="#l18.681"></a><span id="l18.681" class="difflineminus">-            </span>
<a href="#l18.682"></a><span id="l18.682" class="difflineminus">-            function setGridSpacing() {</span>
<a href="#l18.683"></a><span id="l18.683" class="difflineminus">-                // get the most space needed around the grid for things</span>
<a href="#l18.684"></a><span id="l18.684" class="difflineminus">-                // that may stick out</span>
<a href="#l18.685"></a><span id="l18.685" class="difflineminus">-                var maxOutset = options.grid.borderWidth;</span>
<a href="#l18.686"></a><span id="l18.686" class="difflineminus">-                for (i = 0; i &lt; series.length; ++i)</span>
<a href="#l18.687"></a><span id="l18.687" class="difflineminus">-                    maxOutset = Math.max(maxOutset, 2 * (series[i].points.radius + series[i].points.lineWidth/2));</span>
<a href="#l18.688"></a><span id="l18.688" class="difflineminus">-                </span>
<a href="#l18.689"></a><span id="l18.689" class="difflineminus">-                plotOffset.left = plotOffset.right = plotOffset.top = plotOffset.bottom = maxOutset;</span>
<a href="#l18.690"></a><span id="l18.690" class="difflineminus">-                </span>
<a href="#l18.691"></a><span id="l18.691" class="difflineminus">-                var margin = options.grid.labelMargin + options.grid.borderWidth;</span>
<a href="#l18.692"></a><span id="l18.692" class="difflineminus">-                </span>
<a href="#l18.693"></a><span id="l18.693" class="difflineminus">-                if (axes.xaxis.labelHeight &gt; 0)</span>
<a href="#l18.694"></a><span id="l18.694" class="difflineminus">-                    plotOffset.bottom = Math.max(maxOutset, axes.xaxis.labelHeight + margin);</span>
<a href="#l18.695"></a><span id="l18.695" class="difflineminus">-                if (axes.yaxis.labelWidth &gt; 0)</span>
<a href="#l18.696"></a><span id="l18.696" class="difflineminus">-                    plotOffset.left = Math.max(maxOutset, axes.yaxis.labelWidth + margin);</span>
<a href="#l18.697"></a><span id="l18.697" class="difflineminus">-                if (axes.x2axis.labelHeight &gt; 0)</span>
<a href="#l18.698"></a><span id="l18.698" class="difflineminus">-                    plotOffset.top = Math.max(maxOutset, axes.x2axis.labelHeight + margin);</span>
<a href="#l18.699"></a><span id="l18.699" class="difflineminus">-                if (axes.y2axis.labelWidth &gt; 0)</span>
<a href="#l18.700"></a><span id="l18.700" class="difflineminus">-                    plotOffset.right = Math.max(maxOutset, axes.y2axis.labelWidth + margin);</span>
<a href="#l18.701"></a><span id="l18.701" class="difflineminus">-            </span>
<a href="#l18.702"></a><span id="l18.702" class="difflineminus">-                plotWidth = canvasWidth - plotOffset.left - plotOffset.right;</span>
<a href="#l18.703"></a><span id="l18.703" class="difflineminus">-                plotHeight = canvasHeight - plotOffset.bottom - plotOffset.top;</span>
<a href="#l18.704"></a><span id="l18.704" class="difflineminus">-            }</span>
<a href="#l18.705"></a><span id="l18.705" class="difflineminus">-            </span>
<a href="#l18.706"></a><span id="l18.706" class="difflineminus">-            var axis;</span>
<a href="#l18.707"></a><span id="l18.707" class="difflineminus">-            for (axis in axes)</span>
<a href="#l18.708"></a><span id="l18.708" class="difflineminus">-                setRange(axes[axis], options[axis]);</span>
<a href="#l18.709"></a><span id="l18.709" class="difflineminus">-            </span>
<a href="#l18.710"></a><span id="l18.710" class="difflineminus">-            if (options.grid.show) {</span>
<a href="#l18.711"></a><span id="l18.711" class="difflineminus">-                for (axis in axes) {</span>
<a href="#l18.712"></a><span id="l18.712" class="difflineminus">-                    prepareTickGeneration(axes[axis], options[axis]);</span>
<a href="#l18.713"></a><span id="l18.713" class="difflineminus">-                    setTicks(axes[axis], options[axis]);</span>
<a href="#l18.714"></a><span id="l18.714" class="difflineminus">-                    measureLabels(axes[axis], options[axis]);</span>
<a href="#l18.715"></a><span id="l18.715" class="difflineminus">-                }</span>
<a href="#l18.716"></a><span id="l18.716" class="difflineminus">-</span>
<a href="#l18.717"></a><span id="l18.717" class="difflineminus">-                setGridSpacing();</span>
<a href="#l18.718"></a><span id="l18.718" class="difflineminus">-            }</span>
<a href="#l18.719"></a><span id="l18.719" class="difflineminus">-            else {</span>
<a href="#l18.720"></a><span id="l18.720" class="difflineminus">-                plotOffset.left = plotOffset.right = plotOffset.top = plotOffset.bottom = 0;</span>
<a href="#l18.721"></a><span id="l18.721" class="difflineminus">-                plotWidth = canvasWidth;</span>
<a href="#l18.722"></a><span id="l18.722" class="difflineminus">-                plotHeight = canvasHeight;</span>
<a href="#l18.723"></a><span id="l18.723" class="difflineminus">-            }</span>
<a href="#l18.724"></a><span id="l18.724" class="difflineminus">-            </span>
<a href="#l18.725"></a><span id="l18.725" class="difflineminus">-            for (axis in axes)</span>
<a href="#l18.726"></a><span id="l18.726" class="difflineminus">-                setTransformationHelpers(axes[axis], options[axis]);</span>
<a href="#l18.727"></a><span id="l18.727" class="difflineminus">-</span>
<a href="#l18.728"></a><span id="l18.728" class="difflineminus">-            if (options.grid.show)</span>
<a href="#l18.729"></a><span id="l18.729" class="difflineminus">-                insertLabels();</span>
<a href="#l18.730"></a><span id="l18.730" class="difflineminus">-            </span>
<a href="#l18.731"></a><span id="l18.731" class="difflineminus">-            insertLegend();</span>
<a href="#l18.732"></a><span id="l18.732" class="difflineminus">-        }</span>
<a href="#l18.733"></a><span id="l18.733" class="difflineminus">-        </span>
<a href="#l18.734"></a><span id="l18.734" class="difflineminus">-        function setRange(axis, axisOptions) {</span>
<a href="#l18.735"></a><span id="l18.735" class="difflineminus">-            var min = +(axisOptions.min != null ? axisOptions.min : axis.datamin),</span>
<a href="#l18.736"></a><span id="l18.736" class="difflineminus">-                max = +(axisOptions.max != null ? axisOptions.max : axis.datamax),</span>
<a href="#l18.737"></a><span id="l18.737" class="difflineminus">-                delta = max - min;</span>
<a href="#l18.738"></a><span id="l18.738" class="difflineminus">-</span>
<a href="#l18.739"></a><span id="l18.739" class="difflineminus">-            if (delta == 0.0) {</span>
<a href="#l18.740"></a><span id="l18.740" class="difflineminus">-                // degenerate case</span>
<a href="#l18.741"></a><span id="l18.741" class="difflineminus">-                var widen = max == 0 ? 1 : 0.01;</span>
<a href="#l18.742"></a><span id="l18.742" class="difflineminus">-</span>
<a href="#l18.743"></a><span id="l18.743" class="difflineminus">-                if (axisOptions.min == null)</span>
<a href="#l18.744"></a><span id="l18.744" class="difflineminus">-                    min -= widen;</span>
<a href="#l18.745"></a><span id="l18.745" class="difflineminus">-                // alway widen max if we couldn't widen min to ensure we</span>
<a href="#l18.746"></a><span id="l18.746" class="difflineminus">-                // don't fall into min == max which doesn't work</span>
<a href="#l18.747"></a><span id="l18.747" class="difflineminus">-                if (axisOptions.max == null || axisOptions.min != null)</span>
<a href="#l18.748"></a><span id="l18.748" class="difflineminus">-                    max += widen;</span>
<a href="#l18.749"></a><span id="l18.749" class="difflineminus">-            }</span>
<a href="#l18.750"></a><span id="l18.750" class="difflineminus">-            else {</span>
<a href="#l18.751"></a><span id="l18.751" class="difflineminus">-                // consider autoscaling</span>
<a href="#l18.752"></a><span id="l18.752" class="difflineminus">-                var margin = axisOptions.autoscaleMargin;</span>
<a href="#l18.753"></a><span id="l18.753" class="difflineminus">-                if (margin != null) {</span>
<a href="#l18.754"></a><span id="l18.754" class="difflineminus">-                    if (axisOptions.min == null) {</span>
<a href="#l18.755"></a><span id="l18.755" class="difflineminus">-                        min -= delta * margin;</span>
<a href="#l18.756"></a><span id="l18.756" class="difflineminus">-                        // make sure we don't go below zero if all values</span>
<a href="#l18.757"></a><span id="l18.757" class="difflineminus">-                        // are positive</span>
<a href="#l18.758"></a><span id="l18.758" class="difflineminus">-                        if (min &lt; 0 &amp;&amp; axis.datamin != null &amp;&amp; axis.datamin &gt;= 0)</span>
<a href="#l18.759"></a><span id="l18.759" class="difflineminus">-                            min = 0;</span>
<a href="#l18.760"></a><span id="l18.760" class="difflineminus">-                    }</span>
<a href="#l18.761"></a><span id="l18.761" class="difflineminus">-                    if (axisOptions.max == null) {</span>
<a href="#l18.762"></a><span id="l18.762" class="difflineminus">-                        max += delta * margin;</span>
<a href="#l18.763"></a><span id="l18.763" class="difflineminus">-                        if (max &gt; 0 &amp;&amp; axis.datamax != null &amp;&amp; axis.datamax &lt;= 0)</span>
<a href="#l18.764"></a><span id="l18.764" class="difflineminus">-                            max = 0;</span>
<a href="#l18.765"></a><span id="l18.765" class="difflineminus">-                    }</span>
<a href="#l18.766"></a><span id="l18.766" class="difflineminus">-                }</span>
<a href="#l18.767"></a><span id="l18.767" class="difflineminus">-            }</span>
<a href="#l18.768"></a><span id="l18.768" class="difflineminus">-            axis.min = min;</span>
<a href="#l18.769"></a><span id="l18.769" class="difflineminus">-            axis.max = max;</span>
<a href="#l18.770"></a><span id="l18.770" class="difflineminus">-        }</span>
<a href="#l18.771"></a><span id="l18.771" class="difflineminus">-</span>
<a href="#l18.772"></a><span id="l18.772" class="difflineminus">-        function prepareTickGeneration(axis, axisOptions) {</span>
<a href="#l18.773"></a><span id="l18.773" class="difflineminus">-            // estimate number of ticks</span>
<a href="#l18.774"></a><span id="l18.774" class="difflineminus">-            var noTicks;</span>
<a href="#l18.775"></a><span id="l18.775" class="difflineminus">-            if (typeof axisOptions.ticks == &quot;number&quot; &amp;&amp; axisOptions.ticks &gt; 0)</span>
<a href="#l18.776"></a><span id="l18.776" class="difflineminus">-                noTicks = axisOptions.ticks;</span>
<a href="#l18.777"></a><span id="l18.777" class="difflineminus">-            else if (axis == axes.xaxis || axis == axes.x2axis)</span>
<a href="#l18.778"></a><span id="l18.778" class="difflineminus">-                 // heuristic based on the model a*sqrt(x) fitted to</span>
<a href="#l18.779"></a><span id="l18.779" class="difflineminus">-                 // some reasonable data points</span>
<a href="#l18.780"></a><span id="l18.780" class="difflineminus">-                noTicks = 0.3 * Math.sqrt(canvasWidth);</span>
<a href="#l18.781"></a><span id="l18.781" class="difflineminus">-            else</span>
<a href="#l18.782"></a><span id="l18.782" class="difflineminus">-                noTicks = 0.3 * Math.sqrt(canvasHeight);</span>
<a href="#l18.783"></a><span id="l18.783" class="difflineminus">-            </span>
<a href="#l18.784"></a><span id="l18.784" class="difflineminus">-            var delta = (axis.max - axis.min) / noTicks,</span>
<a href="#l18.785"></a><span id="l18.785" class="difflineminus">-                size, generator, unit, formatter, i, magn, norm;</span>
<a href="#l18.786"></a><span id="l18.786" class="difflineminus">-</span>
<a href="#l18.787"></a><span id="l18.787" class="difflineminus">-            if (axisOptions.mode == &quot;time&quot;) {</span>
<a href="#l18.788"></a><span id="l18.788" class="difflineminus">-                // pretty handling of time</span>
<a href="#l18.789"></a><span id="l18.789" class="difflineminus">-                </span>
<a href="#l18.790"></a><span id="l18.790" class="difflineminus">-                // map of app. size of time units in milliseconds</span>
<a href="#l18.791"></a><span id="l18.791" class="difflineminus">-                var timeUnitSize = {</span>
<a href="#l18.792"></a><span id="l18.792" class="difflineminus">-                    &quot;second&quot;: 1000,</span>
<a href="#l18.793"></a><span id="l18.793" class="difflineminus">-                    &quot;minute&quot;: 60 * 1000,</span>
<a href="#l18.794"></a><span id="l18.794" class="difflineminus">-                    &quot;hour&quot;: 60 * 60 * 1000,</span>
<a href="#l18.795"></a><span id="l18.795" class="difflineminus">-                    &quot;day&quot;: 24 * 60 * 60 * 1000,</span>
<a href="#l18.796"></a><span id="l18.796" class="difflineminus">-                    &quot;month&quot;: 30 * 24 * 60 * 60 * 1000,</span>
<a href="#l18.797"></a><span id="l18.797" class="difflineminus">-                    &quot;year&quot;: 365.2425 * 24 * 60 * 60 * 1000</span>
<a href="#l18.798"></a><span id="l18.798" class="difflineminus">-                };</span>
<a href="#l18.799"></a><span id="l18.799" class="difflineminus">-</span>
<a href="#l18.800"></a><span id="l18.800" class="difflineminus">-</span>
<a href="#l18.801"></a><span id="l18.801" class="difflineminus">-                // the allowed tick sizes, after 1 year we use</span>
<a href="#l18.802"></a><span id="l18.802" class="difflineminus">-                // an integer algorithm</span>
<a href="#l18.803"></a><span id="l18.803" class="difflineminus">-                var spec = [</span>
<a href="#l18.804"></a><span id="l18.804" class="difflineminus">-                    [1, &quot;second&quot;], [2, &quot;second&quot;], [5, &quot;second&quot;], [10, &quot;second&quot;],</span>
<a href="#l18.805"></a><span id="l18.805" class="difflineminus">-                    [30, &quot;second&quot;], </span>
<a href="#l18.806"></a><span id="l18.806" class="difflineminus">-                    [1, &quot;minute&quot;], [2, &quot;minute&quot;], [5, &quot;minute&quot;], [10, &quot;minute&quot;],</span>
<a href="#l18.807"></a><span id="l18.807" class="difflineminus">-                    [30, &quot;minute&quot;], </span>
<a href="#l18.808"></a><span id="l18.808" class="difflineminus">-                    [1, &quot;hour&quot;], [2, &quot;hour&quot;], [4, &quot;hour&quot;],</span>
<a href="#l18.809"></a><span id="l18.809" class="difflineminus">-                    [8, &quot;hour&quot;], [12, &quot;hour&quot;],</span>
<a href="#l18.810"></a><span id="l18.810" class="difflineminus">-                    [1, &quot;day&quot;], [2, &quot;day&quot;], [3, &quot;day&quot;],</span>
<a href="#l18.811"></a><span id="l18.811" class="difflineminus">-                    [0.25, &quot;month&quot;], [0.5, &quot;month&quot;], [1, &quot;month&quot;],</span>
<a href="#l18.812"></a><span id="l18.812" class="difflineminus">-                    [2, &quot;month&quot;], [3, &quot;month&quot;], [6, &quot;month&quot;],</span>
<a href="#l18.813"></a><span id="l18.813" class="difflineminus">-                    [1, &quot;year&quot;]</span>
<a href="#l18.814"></a><span id="l18.814" class="difflineminus">-                ];</span>
<a href="#l18.815"></a><span id="l18.815" class="difflineminus">-</span>
<a href="#l18.816"></a><span id="l18.816" class="difflineminus">-                var minSize = 0;</span>
<a href="#l18.817"></a><span id="l18.817" class="difflineminus">-                if (axisOptions.minTickSize != null) {</span>
<a href="#l18.818"></a><span id="l18.818" class="difflineminus">-                    if (typeof axisOptions.tickSize == &quot;number&quot;)</span>
<a href="#l18.819"></a><span id="l18.819" class="difflineminus">-                        minSize = axisOptions.tickSize;</span>
<a href="#l18.820"></a><span id="l18.820" class="difflineminus">-                    else</span>
<a href="#l18.821"></a><span id="l18.821" class="difflineminus">-                        minSize = axisOptions.minTickSize[0] * timeUnitSize[axisOptions.minTickSize[1]];</span>
<a href="#l18.822"></a><span id="l18.822" class="difflineminus">-                }</span>
<a href="#l18.823"></a><span id="l18.823" class="difflineminus">-</span>
<a href="#l18.824"></a><span id="l18.824" class="difflineminus">-                for (i = 0; i &lt; spec.length - 1; ++i)</span>
<a href="#l18.825"></a><span id="l18.825" class="difflineminus">-                    if (delta &lt; (spec[i][0] * timeUnitSize[spec[i][1]]</span>
<a href="#l18.826"></a><span id="l18.826" class="difflineminus">-                                 + spec[i + 1][0] * timeUnitSize[spec[i + 1][1]]) / 2</span>
<a href="#l18.827"></a><span id="l18.827" class="difflineminus">-                       &amp;&amp; spec[i][0] * timeUnitSize[spec[i][1]] &gt;= minSize)</span>
<a href="#l18.828"></a><span id="l18.828" class="difflineminus">-                        break;</span>
<a href="#l18.829"></a><span id="l18.829" class="difflineminus">-                size = spec[i][0];</span>
<a href="#l18.830"></a><span id="l18.830" class="difflineminus">-                unit = spec[i][1];</span>
<a href="#l18.831"></a><span id="l18.831" class="difflineminus">-                </span>
<a href="#l18.832"></a><span id="l18.832" class="difflineminus">-                // special-case the possibility of several years</span>
<a href="#l18.833"></a><span id="l18.833" class="difflineminus">-                if (unit == &quot;year&quot;) {</span>
<a href="#l18.834"></a><span id="l18.834" class="difflineminus">-                    magn = Math.pow(10, Math.floor(Math.log(delta / timeUnitSize.year) / Math.LN10));</span>
<a href="#l18.835"></a><span id="l18.835" class="difflineminus">-                    norm = (delta / timeUnitSize.year) / magn;</span>
<a href="#l18.836"></a><span id="l18.836" class="difflineminus">-                    if (norm &lt; 1.5)</span>
<a href="#l18.837"></a><span id="l18.837" class="difflineminus">-                        size = 1;</span>
<a href="#l18.838"></a><span id="l18.838" class="difflineminus">-                    else if (norm &lt; 3)</span>
<a href="#l18.839"></a><span id="l18.839" class="difflineminus">-                        size = 2;</span>
<a href="#l18.840"></a><span id="l18.840" class="difflineminus">-                    else if (norm &lt; 7.5)</span>
<a href="#l18.841"></a><span id="l18.841" class="difflineminus">-                        size = 5;</span>
<a href="#l18.842"></a><span id="l18.842" class="difflineminus">-                    else</span>
<a href="#l18.843"></a><span id="l18.843" class="difflineminus">-                        size = 10;</span>
<a href="#l18.844"></a><span id="l18.844" class="difflineminus">-</span>
<a href="#l18.845"></a><span id="l18.845" class="difflineminus">-                    size *= magn;</span>
<a href="#l18.846"></a><span id="l18.846" class="difflineminus">-                }</span>
<a href="#l18.847"></a><span id="l18.847" class="difflineminus">-</span>
<a href="#l18.848"></a><span id="l18.848" class="difflineminus">-                if (axisOptions.tickSize) {</span>
<a href="#l18.849"></a><span id="l18.849" class="difflineminus">-                    size = axisOptions.tickSize[0];</span>
<a href="#l18.850"></a><span id="l18.850" class="difflineminus">-                    unit = axisOptions.tickSize[1];</span>
<a href="#l18.851"></a><span id="l18.851" class="difflineminus">-                }</span>
<a href="#l18.852"></a><span id="l18.852" class="difflineminus">-                </span>
<a href="#l18.853"></a><span id="l18.853" class="difflineminus">-                generator = function(axis) {</span>
<a href="#l18.854"></a><span id="l18.854" class="difflineminus">-                    var ticks = [],</span>
<a href="#l18.855"></a><span id="l18.855" class="difflineminus">-                        tickSize = axis.tickSize[0], unit = axis.tickSize[1],</span>
<a href="#l18.856"></a><span id="l18.856" class="difflineminus">-                        d = new Date(axis.min);</span>
<a href="#l18.857"></a><span id="l18.857" class="difflineminus">-                    </span>
<a href="#l18.858"></a><span id="l18.858" class="difflineminus">-                    var step = tickSize * timeUnitSize[unit];</span>
<a href="#l18.859"></a><span id="l18.859" class="difflineminus">-</span>
<a href="#l18.860"></a><span id="l18.860" class="difflineminus">-                    if (unit == &quot;second&quot;)</span>
<a href="#l18.861"></a><span id="l18.861" class="difflineminus">-                        d.setUTCSeconds(floorInBase(d.getUTCSeconds(), tickSize));</span>
<a href="#l18.862"></a><span id="l18.862" class="difflineminus">-                    if (unit == &quot;minute&quot;)</span>
<a href="#l18.863"></a><span id="l18.863" class="difflineminus">-                        d.setUTCMinutes(floorInBase(d.getUTCMinutes(), tickSize));</span>
<a href="#l18.864"></a><span id="l18.864" class="difflineminus">-                    if (unit == &quot;hour&quot;)</span>
<a href="#l18.865"></a><span id="l18.865" class="difflineminus">-                        d.setUTCHours(floorInBase(d.getUTCHours(), tickSize));</span>
<a href="#l18.866"></a><span id="l18.866" class="difflineminus">-                    if (unit == &quot;month&quot;)</span>
<a href="#l18.867"></a><span id="l18.867" class="difflineminus">-                        d.setUTCMonth(floorInBase(d.getUTCMonth(), tickSize));</span>
<a href="#l18.868"></a><span id="l18.868" class="difflineminus">-                    if (unit == &quot;year&quot;)</span>
<a href="#l18.869"></a><span id="l18.869" class="difflineminus">-                        d.setUTCFullYear(floorInBase(d.getUTCFullYear(), tickSize));</span>
<a href="#l18.870"></a><span id="l18.870" class="difflineminus">-                    </span>
<a href="#l18.871"></a><span id="l18.871" class="difflineminus">-                    // reset smaller components</span>
<a href="#l18.872"></a><span id="l18.872" class="difflineminus">-                    d.setUTCMilliseconds(0);</span>
<a href="#l18.873"></a><span id="l18.873" class="difflineminus">-                    if (step &gt;= timeUnitSize.minute)</span>
<a href="#l18.874"></a><span id="l18.874" class="difflineminus">-                        d.setUTCSeconds(0);</span>
<a href="#l18.875"></a><span id="l18.875" class="difflineminus">-                    if (step &gt;= timeUnitSize.hour)</span>
<a href="#l18.876"></a><span id="l18.876" class="difflineminus">-                        d.setUTCMinutes(0);</span>
<a href="#l18.877"></a><span id="l18.877" class="difflineminus">-                    if (step &gt;= timeUnitSize.day)</span>
<a href="#l18.878"></a><span id="l18.878" class="difflineminus">-                        d.setUTCHours(0);</span>
<a href="#l18.879"></a><span id="l18.879" class="difflineminus">-                    if (step &gt;= timeUnitSize.day * 4)</span>
<a href="#l18.880"></a><span id="l18.880" class="difflineminus">-                        d.setUTCDate(1);</span>
<a href="#l18.881"></a><span id="l18.881" class="difflineminus">-                    if (step &gt;= timeUnitSize.year)</span>
<a href="#l18.882"></a><span id="l18.882" class="difflineminus">-                        d.setUTCMonth(0);</span>
<a href="#l18.883"></a><span id="l18.883" class="difflineminus">-</span>
<a href="#l18.884"></a><span id="l18.884" class="difflineminus">-</span>
<a href="#l18.885"></a><span id="l18.885" class="difflineminus">-                    var carry = 0, v = Number.NaN, prev;</span>
<a href="#l18.886"></a><span id="l18.886" class="difflineminus">-                    do {</span>
<a href="#l18.887"></a><span id="l18.887" class="difflineminus">-                        prev = v;</span>
<a href="#l18.888"></a><span id="l18.888" class="difflineminus">-                        v = d.getTime();</span>
<a href="#l18.889"></a><span id="l18.889" class="difflineminus">-                        ticks.push({ v: v, label: axis.tickFormatter(v, axis) });</span>
<a href="#l18.890"></a><span id="l18.890" class="difflineminus">-                        if (unit == &quot;month&quot;) {</span>
<a href="#l18.891"></a><span id="l18.891" class="difflineminus">-                            if (tickSize &lt; 1) {</span>
<a href="#l18.892"></a><span id="l18.892" class="difflineminus">-                                // a bit complicated - we'll divide the month</span>
<a href="#l18.893"></a><span id="l18.893" class="difflineminus">-                                // up but we need to take care of fractions</span>
<a href="#l18.894"></a><span id="l18.894" class="difflineminus">-                                // so we don't end up in the middle of a day</span>
<a href="#l18.895"></a><span id="l18.895" class="difflineminus">-                                d.setUTCDate(1);</span>
<a href="#l18.896"></a><span id="l18.896" class="difflineminus">-                                var start = d.getTime();</span>
<a href="#l18.897"></a><span id="l18.897" class="difflineminus">-                                d.setUTCMonth(d.getUTCMonth() + 1);</span>
<a href="#l18.898"></a><span id="l18.898" class="difflineminus">-                                var end = d.getTime();</span>
<a href="#l18.899"></a><span id="l18.899" class="difflineminus">-                                d.setTime(v + carry * timeUnitSize.hour + (end - start) * tickSize);</span>
<a href="#l18.900"></a><span id="l18.900" class="difflineminus">-                                carry = d.getUTCHours();</span>
<a href="#l18.901"></a><span id="l18.901" class="difflineminus">-                                d.setUTCHours(0);</span>
<a href="#l18.902"></a><span id="l18.902" class="difflineminus">-                            }</span>
<a href="#l18.903"></a><span id="l18.903" class="difflineminus">-                            else</span>
<a href="#l18.904"></a><span id="l18.904" class="difflineminus">-                                d.setUTCMonth(d.getUTCMonth() + tickSize);</span>
<a href="#l18.905"></a><span id="l18.905" class="difflineminus">-                        }</span>
<a href="#l18.906"></a><span id="l18.906" class="difflineminus">-                        else if (unit == &quot;year&quot;) {</span>
<a href="#l18.907"></a><span id="l18.907" class="difflineminus">-                            d.setUTCFullYear(d.getUTCFullYear() + tickSize);</span>
<a href="#l18.908"></a><span id="l18.908" class="difflineminus">-                        }</span>
<a href="#l18.909"></a><span id="l18.909" class="difflineminus">-                        else</span>
<a href="#l18.910"></a><span id="l18.910" class="difflineminus">-                            d.setTime(v + step);</span>
<a href="#l18.911"></a><span id="l18.911" class="difflineminus">-                    } while (v &lt; axis.max &amp;&amp; v != prev);</span>
<a href="#l18.912"></a><span id="l18.912" class="difflineminus">-</span>
<a href="#l18.913"></a><span id="l18.913" class="difflineminus">-                    return ticks;</span>
<a href="#l18.914"></a><span id="l18.914" class="difflineminus">-                };</span>
<a href="#l18.915"></a><span id="l18.915" class="difflineminus">-</span>
<a href="#l18.916"></a><span id="l18.916" class="difflineminus">-                formatter = function (v, axis) {</span>
<a href="#l18.917"></a><span id="l18.917" class="difflineminus">-                    var d = new Date(v);</span>
<a href="#l18.918"></a><span id="l18.918" class="difflineminus">-</span>
<a href="#l18.919"></a><span id="l18.919" class="difflineminus">-                    // first check global format</span>
<a href="#l18.920"></a><span id="l18.920" class="difflineminus">-                    if (axisOptions.timeformat != null)</span>
<a href="#l18.921"></a><span id="l18.921" class="difflineminus">-                        return $.plot.formatDate(d, axisOptions.timeformat, axisOptions.monthNames);</span>
<a href="#l18.922"></a><span id="l18.922" class="difflineminus">-                    </span>
<a href="#l18.923"></a><span id="l18.923" class="difflineminus">-                    var t = axis.tickSize[0] * timeUnitSize[axis.tickSize[1]];</span>
<a href="#l18.924"></a><span id="l18.924" class="difflineminus">-                    var span = axis.max - axis.min;</span>
<a href="#l18.925"></a><span id="l18.925" class="difflineminus">-                    var suffix = (axisOptions.twelveHourClock) ? &quot; %p&quot; : &quot;&quot;;</span>
<a href="#l18.926"></a><span id="l18.926" class="difflineminus">-                    </span>
<a href="#l18.927"></a><span id="l18.927" class="difflineminus">-                    if (t &lt; timeUnitSize.minute)</span>
<a href="#l18.928"></a><span id="l18.928" class="difflineminus">-                        fmt = &quot;%h:%M:%S&quot; + suffix;</span>
<a href="#l18.929"></a><span id="l18.929" class="difflineminus">-                    else if (t &lt; timeUnitSize.day) {</span>
<a href="#l18.930"></a><span id="l18.930" class="difflineminus">-                        if (span &lt; 2 * timeUnitSize.day)</span>
<a href="#l18.931"></a><span id="l18.931" class="difflineminus">-                            fmt = &quot;%h:%M&quot; + suffix;</span>
<a href="#l18.932"></a><span id="l18.932" class="difflineminus">-                        else</span>
<a href="#l18.933"></a><span id="l18.933" class="difflineminus">-                            fmt = &quot;%b %d %h:%M&quot; + suffix;</span>
<a href="#l18.934"></a><span id="l18.934" class="difflineminus">-                    }</span>
<a href="#l18.935"></a><span id="l18.935" class="difflineminus">-                    else if (t &lt; timeUnitSize.month)</span>
<a href="#l18.936"></a><span id="l18.936" class="difflineminus">-                        fmt = &quot;%b %d&quot;;</span>
<a href="#l18.937"></a><span id="l18.937" class="difflineminus">-                    else if (t &lt; timeUnitSize.year) {</span>
<a href="#l18.938"></a><span id="l18.938" class="difflineminus">-                        if (span &lt; timeUnitSize.year)</span>
<a href="#l18.939"></a><span id="l18.939" class="difflineminus">-                            fmt = &quot;%b&quot;;</span>
<a href="#l18.940"></a><span id="l18.940" class="difflineminus">-                        else</span>
<a href="#l18.941"></a><span id="l18.941" class="difflineminus">-                            fmt = &quot;%b %y&quot;;</span>
<a href="#l18.942"></a><span id="l18.942" class="difflineminus">-                    }</span>
<a href="#l18.943"></a><span id="l18.943" class="difflineminus">-                    else</span>
<a href="#l18.944"></a><span id="l18.944" class="difflineminus">-                        fmt = &quot;%y&quot;;</span>
<a href="#l18.945"></a><span id="l18.945" class="difflineminus">-                    </span>
<a href="#l18.946"></a><span id="l18.946" class="difflineminus">-                    return $.plot.formatDate(d, fmt, axisOptions.monthNames);</span>
<a href="#l18.947"></a><span id="l18.947" class="difflineminus">-                };</span>
<a href="#l18.948"></a><span id="l18.948" class="difflineminus">-            }</span>
<a href="#l18.949"></a><span id="l18.949" class="difflineminus">-            else {</span>
<a href="#l18.950"></a><span id="l18.950" class="difflineminus">-                // pretty rounding of base-10 numbers</span>
<a href="#l18.951"></a><span id="l18.951" class="difflineminus">-                var maxDec = axisOptions.tickDecimals;</span>
<a href="#l18.952"></a><span id="l18.952" class="difflineminus">-                var dec = -Math.floor(Math.log(delta) / Math.LN10);</span>
<a href="#l18.953"></a><span id="l18.953" class="difflineminus">-                if (maxDec != null &amp;&amp; dec &gt; maxDec)</span>
<a href="#l18.954"></a><span id="l18.954" class="difflineminus">-                    dec = maxDec;</span>
<a href="#l18.955"></a><span id="l18.955" class="difflineminus">-</span>
<a href="#l18.956"></a><span id="l18.956" class="difflineminus">-                magn = Math.pow(10, -dec);</span>
<a href="#l18.957"></a><span id="l18.957" class="difflineminus">-                norm = delta / magn; // norm is between 1.0 and 10.0</span>
<a href="#l18.958"></a><span id="l18.958" class="difflineminus">-                </span>
<a href="#l18.959"></a><span id="l18.959" class="difflineminus">-                if (norm &lt; 1.5)</span>
<a href="#l18.960"></a><span id="l18.960" class="difflineminus">-                    size = 1;</span>
<a href="#l18.961"></a><span id="l18.961" class="difflineminus">-                else if (norm &lt; 3) {</span>
<a href="#l18.962"></a><span id="l18.962" class="difflineminus">-                    size = 2;</span>
<a href="#l18.963"></a><span id="l18.963" class="difflineminus">-                    // special case for 2.5, requires an extra decimal</span>
<a href="#l18.964"></a><span id="l18.964" class="difflineminus">-                    if (norm &gt; 2.25 &amp;&amp; (maxDec == null || dec + 1 &lt;= maxDec)) {</span>
<a href="#l18.965"></a><span id="l18.965" class="difflineminus">-                        size = 2.5;</span>
<a href="#l18.966"></a><span id="l18.966" class="difflineminus">-                        ++dec;</span>
<a href="#l18.967"></a><span id="l18.967" class="difflineminus">-                    }</span>
<a href="#l18.968"></a><span id="l18.968" class="difflineminus">-                }</span>
<a href="#l18.969"></a><span id="l18.969" class="difflineminus">-                else if (norm &lt; 7.5)</span>
<a href="#l18.970"></a><span id="l18.970" class="difflineminus">-                    size = 5;</span>
<a href="#l18.971"></a><span id="l18.971" class="difflineminus">-                else</span>
<a href="#l18.972"></a><span id="l18.972" class="difflineminus">-                    size = 10;</span>
<a href="#l18.973"></a><span id="l18.973" class="difflineminus">-</span>
<a href="#l18.974"></a><span id="l18.974" class="difflineminus">-                size *= magn;</span>
<a href="#l18.975"></a><span id="l18.975" class="difflineminus">-                </span>
<a href="#l18.976"></a><span id="l18.976" class="difflineminus">-                if (axisOptions.minTickSize != null &amp;&amp; size &lt; axisOptions.minTickSize)</span>
<a href="#l18.977"></a><span id="l18.977" class="difflineminus">-                    size = axisOptions.minTickSize;</span>
<a href="#l18.978"></a><span id="l18.978" class="difflineminus">-</span>
<a href="#l18.979"></a><span id="l18.979" class="difflineminus">-                if (axisOptions.tickSize != null)</span>
<a href="#l18.980"></a><span id="l18.980" class="difflineminus">-                    size = axisOptions.tickSize;</span>
<a href="#l18.981"></a><span id="l18.981" class="difflineminus">-</span>
<a href="#l18.982"></a><span id="l18.982" class="difflineminus">-                axis.tickDecimals = Math.max(0, (maxDec != null) ? maxDec : dec);</span>
<a href="#l18.983"></a><span id="l18.983" class="difflineminus">-</span>
<a href="#l18.984"></a><span id="l18.984" class="difflineminus">-                generator = function (axis) {</span>
<a href="#l18.985"></a><span id="l18.985" class="difflineminus">-                    var ticks = [];</span>
<a href="#l18.986"></a><span id="l18.986" class="difflineminus">-</span>
<a href="#l18.987"></a><span id="l18.987" class="difflineminus">-                    // spew out all possible ticks</span>
<a href="#l18.988"></a><span id="l18.988" class="difflineminus">-                    var start = floorInBase(axis.min, axis.tickSize),</span>
<a href="#l18.989"></a><span id="l18.989" class="difflineminus">-                        i = 0, v = Number.NaN, prev;</span>
<a href="#l18.990"></a><span id="l18.990" class="difflineminus">-                    do {</span>
<a href="#l18.991"></a><span id="l18.991" class="difflineminus">-                        prev = v;</span>
<a href="#l18.992"></a><span id="l18.992" class="difflineminus">-                        v = start + i * axis.tickSize;</span>
<a href="#l18.993"></a><span id="l18.993" class="difflineminus">-                        ticks.push({ v: v, label: axis.tickFormatter(v, axis) });</span>
<a href="#l18.994"></a><span id="l18.994" class="difflineminus">-                        ++i;</span>
<a href="#l18.995"></a><span id="l18.995" class="difflineminus">-                    } while (v &lt; axis.max &amp;&amp; v != prev);</span>
<a href="#l18.996"></a><span id="l18.996" class="difflineminus">-                    return ticks;</span>
<a href="#l18.997"></a><span id="l18.997" class="difflineminus">-                };</span>
<a href="#l18.998"></a><span id="l18.998" class="difflineminus">-</span>
<a href="#l18.999"></a><span id="l18.999" class="difflineminus">-                formatter = function (v, axis) {</span>
<a href="#l18.1000"></a><span id="l18.1000" class="difflineminus">-                    return v.toFixed(axis.tickDecimals);</span>
<a href="#l18.1001"></a><span id="l18.1001" class="difflineminus">-                };</span>
<a href="#l18.1002"></a><span id="l18.1002" class="difflineminus">-            }</span>
<a href="#l18.1003"></a><span id="l18.1003" class="difflineminus">-</span>
<a href="#l18.1004"></a><span id="l18.1004" class="difflineminus">-            axis.tickSize = unit ? [size, unit] : size;</span>
<a href="#l18.1005"></a><span id="l18.1005" class="difflineminus">-            axis.tickGenerator = generator;</span>
<a href="#l18.1006"></a><span id="l18.1006" class="difflineminus">-            if ($.isFunction(axisOptions.tickFormatter))</span>
<a href="#l18.1007"></a><span id="l18.1007" class="difflineminus">-                axis.tickFormatter = function (v, axis) { return &quot;&quot; + axisOptions.tickFormatter(v, axis); };</span>
<a href="#l18.1008"></a><span id="l18.1008" class="difflineminus">-            else</span>
<a href="#l18.1009"></a><span id="l18.1009" class="difflineminus">-                axis.tickFormatter = formatter;</span>
<a href="#l18.1010"></a><span id="l18.1010" class="difflineminus">-        }</span>
<a href="#l18.1011"></a><span id="l18.1011" class="difflineminus">-        </span>
<a href="#l18.1012"></a><span id="l18.1012" class="difflineminus">-        function setTicks(axis, axisOptions) {</span>
<a href="#l18.1013"></a><span id="l18.1013" class="difflineminus">-            axis.ticks = [];</span>
<a href="#l18.1014"></a><span id="l18.1014" class="difflineminus">-</span>
<a href="#l18.1015"></a><span id="l18.1015" class="difflineminus">-            if (!axis.used)</span>
<a href="#l18.1016"></a><span id="l18.1016" class="difflineminus">-                return;</span>
<a href="#l18.1017"></a><span id="l18.1017" class="difflineminus">-            </span>
<a href="#l18.1018"></a><span id="l18.1018" class="difflineminus">-            if (axisOptions.ticks == null)</span>
<a href="#l18.1019"></a><span id="l18.1019" class="difflineminus">-                axis.ticks = axis.tickGenerator(axis);</span>
<a href="#l18.1020"></a><span id="l18.1020" class="difflineminus">-            else if (typeof axisOptions.ticks == &quot;number&quot;) {</span>
<a href="#l18.1021"></a><span id="l18.1021" class="difflineminus">-                if (axisOptions.ticks &gt; 0)</span>
<a href="#l18.1022"></a><span id="l18.1022" class="difflineminus">-                    axis.ticks = axis.tickGenerator(axis);</span>
<a href="#l18.1023"></a><span id="l18.1023" class="difflineminus">-            }</span>
<a href="#l18.1024"></a><span id="l18.1024" class="difflineminus">-            else if (axisOptions.ticks) {</span>
<a href="#l18.1025"></a><span id="l18.1025" class="difflineminus">-                var ticks = axisOptions.ticks;</span>
<a href="#l18.1026"></a><span id="l18.1026" class="difflineminus">-</span>
<a href="#l18.1027"></a><span id="l18.1027" class="difflineminus">-                if ($.isFunction(ticks))</span>
<a href="#l18.1028"></a><span id="l18.1028" class="difflineminus">-                    // generate the ticks</span>
<a href="#l18.1029"></a><span id="l18.1029" class="difflineminus">-                    ticks = ticks({ min: axis.min, max: axis.max });</span>
<a href="#l18.1030"></a><span id="l18.1030" class="difflineminus">-                </span>
<a href="#l18.1031"></a><span id="l18.1031" class="difflineminus">-                // clean up the user-supplied ticks, copy them over</span>
<a href="#l18.1032"></a><span id="l18.1032" class="difflineminus">-                var i, v;</span>
<a href="#l18.1033"></a><span id="l18.1033" class="difflineminus">-                for (i = 0; i &lt; ticks.length; ++i) {</span>
<a href="#l18.1034"></a><span id="l18.1034" class="difflineminus">-                    var label = null;</span>
<a href="#l18.1035"></a><span id="l18.1035" class="difflineminus">-                    var t = ticks[i];</span>
<a href="#l18.1036"></a><span id="l18.1036" class="difflineminus">-                    if (typeof t == &quot;object&quot;) {</span>
<a href="#l18.1037"></a><span id="l18.1037" class="difflineminus">-                        v = t[0];</span>
<a href="#l18.1038"></a><span id="l18.1038" class="difflineminus">-                        if (t.length &gt; 1)</span>
<a href="#l18.1039"></a><span id="l18.1039" class="difflineminus">-                            label = t[1];</span>
<a href="#l18.1040"></a><span id="l18.1040" class="difflineminus">-                    }</span>
<a href="#l18.1041"></a><span id="l18.1041" class="difflineminus">-                    else</span>
<a href="#l18.1042"></a><span id="l18.1042" class="difflineminus">-                        v = t;</span>
<a href="#l18.1043"></a><span id="l18.1043" class="difflineminus">-                    if (label == null)</span>
<a href="#l18.1044"></a><span id="l18.1044" class="difflineminus">-                        label = axis.tickFormatter(v, axis);</span>
<a href="#l18.1045"></a><span id="l18.1045" class="difflineminus">-                    axis.ticks[i] = { v: v, label: label };</span>
<a href="#l18.1046"></a><span id="l18.1046" class="difflineminus">-                }</span>
<a href="#l18.1047"></a><span id="l18.1047" class="difflineminus">-            }</span>
<a href="#l18.1048"></a><span id="l18.1048" class="difflineminus">-</span>
<a href="#l18.1049"></a><span id="l18.1049" class="difflineminus">-            if (axisOptions.autoscaleMargin != null &amp;&amp; axis.ticks.length &gt; 0) {</span>
<a href="#l18.1050"></a><span id="l18.1050" class="difflineminus">-                // snap to ticks</span>
<a href="#l18.1051"></a><span id="l18.1051" class="difflineminus">-                if (axisOptions.min == null)</span>
<a href="#l18.1052"></a><span id="l18.1052" class="difflineminus">-                    axis.min = Math.min(axis.min, axis.ticks[0].v);</span>
<a href="#l18.1053"></a><span id="l18.1053" class="difflineminus">-                if (axisOptions.max == null &amp;&amp; axis.ticks.length &gt; 1)</span>
<a href="#l18.1054"></a><span id="l18.1054" class="difflineminus">-                    axis.max = Math.max(axis.max, axis.ticks[axis.ticks.length - 1].v);</span>
<a href="#l18.1055"></a><span id="l18.1055" class="difflineminus">-            }</span>
<a href="#l18.1056"></a><span id="l18.1056" class="difflineminus">-        }</span>
<a href="#l18.1057"></a><span id="l18.1057" class="difflineminus">-      </span>
<a href="#l18.1058"></a><span id="l18.1058" class="difflineminus">-        function draw() {</span>
<a href="#l18.1059"></a><span id="l18.1059" class="difflineminus">-            ctx.clearRect(0, 0, canvasWidth, canvasHeight);</span>
<a href="#l18.1060"></a><span id="l18.1060" class="difflineminus">-</span>
<a href="#l18.1061"></a><span id="l18.1061" class="difflineminus">-            var grid = options.grid;</span>
<a href="#l18.1062"></a><span id="l18.1062" class="difflineminus">-            </span>
<a href="#l18.1063"></a><span id="l18.1063" class="difflineminus">-            if (grid.show &amp;&amp; !grid.aboveData)</span>
<a href="#l18.1064"></a><span id="l18.1064" class="difflineminus">-                drawGrid();</span>
<a href="#l18.1065"></a><span id="l18.1065" class="difflineminus">-</span>
<a href="#l18.1066"></a><span id="l18.1066" class="difflineminus">-            for (var i = 0; i &lt; series.length; ++i)</span>
<a href="#l18.1067"></a><span id="l18.1067" class="difflineminus">-                drawSeries(series[i]);</span>
<a href="#l18.1068"></a><span id="l18.1068" class="difflineminus">-</span>
<a href="#l18.1069"></a><span id="l18.1069" class="difflineminus">-            executeHooks(hooks.draw, [ctx]);</span>
<a href="#l18.1070"></a><span id="l18.1070" class="difflineminus">-            </span>
<a href="#l18.1071"></a><span id="l18.1071" class="difflineminus">-            if (grid.show &amp;&amp; grid.aboveData)</span>
<a href="#l18.1072"></a><span id="l18.1072" class="difflineminus">-                drawGrid();</span>
<a href="#l18.1073"></a><span id="l18.1073" class="difflineminus">-        }</span>
<a href="#l18.1074"></a><span id="l18.1074" class="difflineminus">-</span>
<a href="#l18.1075"></a><span id="l18.1075" class="difflineminus">-        function extractRange(ranges, coord) {</span>
<a href="#l18.1076"></a><span id="l18.1076" class="difflineminus">-            var firstAxis = coord + &quot;axis&quot;,</span>
<a href="#l18.1077"></a><span id="l18.1077" class="difflineminus">-                secondaryAxis = coord + &quot;2axis&quot;,</span>
<a href="#l18.1078"></a><span id="l18.1078" class="difflineminus">-                axis, from, to, reverse;</span>
<a href="#l18.1079"></a><span id="l18.1079" class="difflineminus">-</span>
<a href="#l18.1080"></a><span id="l18.1080" class="difflineminus">-            if (ranges[firstAxis]) {</span>
<a href="#l18.1081"></a><span id="l18.1081" class="difflineminus">-                axis = axes[firstAxis];</span>
<a href="#l18.1082"></a><span id="l18.1082" class="difflineminus">-                from = ranges[firstAxis].from;</span>
<a href="#l18.1083"></a><span id="l18.1083" class="difflineminus">-                to = ranges[firstAxis].to;</span>
<a href="#l18.1084"></a><span id="l18.1084" class="difflineminus">-            }</span>
<a href="#l18.1085"></a><span id="l18.1085" class="difflineminus">-            else if (ranges[secondaryAxis]) {</span>
<a href="#l18.1086"></a><span id="l18.1086" class="difflineminus">-                axis = axes[secondaryAxis];</span>
<a href="#l18.1087"></a><span id="l18.1087" class="difflineminus">-                from = ranges[secondaryAxis].from;</span>
<a href="#l18.1088"></a><span id="l18.1088" class="difflineminus">-                to = ranges[secondaryAxis].to;</span>
<a href="#l18.1089"></a><span id="l18.1089" class="difflineminus">-            }</span>
<a href="#l18.1090"></a><span id="l18.1090" class="difflineminus">-            else {</span>
<a href="#l18.1091"></a><span id="l18.1091" class="difflineminus">-                // backwards-compat stuff - to be removed in future</span>
<a href="#l18.1092"></a><span id="l18.1092" class="difflineminus">-                axis = axes[firstAxis];</span>
<a href="#l18.1093"></a><span id="l18.1093" class="difflineminus">-                from = ranges[coord + &quot;1&quot;];</span>
<a href="#l18.1094"></a><span id="l18.1094" class="difflineminus">-                to = ranges[coord + &quot;2&quot;];</span>
<a href="#l18.1095"></a><span id="l18.1095" class="difflineminus">-            }</span>
<a href="#l18.1096"></a><span id="l18.1096" class="difflineminus">-</span>
<a href="#l18.1097"></a><span id="l18.1097" class="difflineminus">-            // auto-reverse as an added bonus</span>
<a href="#l18.1098"></a><span id="l18.1098" class="difflineminus">-            if (from != null &amp;&amp; to != null &amp;&amp; from &gt; to)</span>
<a href="#l18.1099"></a><span id="l18.1099" class="difflineminus">-                return { from: to, to: from, axis: axis };</span>
<a href="#l18.1100"></a><span id="l18.1100" class="difflineminus">-            </span>
<a href="#l18.1101"></a><span id="l18.1101" class="difflineminus">-            return { from: from, to: to, axis: axis };</span>
<a href="#l18.1102"></a><span id="l18.1102" class="difflineminus">-        }</span>
<a href="#l18.1103"></a><span id="l18.1103" class="difflineminus">-        </span>
<a href="#l18.1104"></a><span id="l18.1104" class="difflineminus">-        function drawGrid() {</span>
<a href="#l18.1105"></a><span id="l18.1105" class="difflineminus">-            var i;</span>
<a href="#l18.1106"></a><span id="l18.1106" class="difflineminus">-            </span>
<a href="#l18.1107"></a><span id="l18.1107" class="difflineminus">-            ctx.save();</span>
<a href="#l18.1108"></a><span id="l18.1108" class="difflineminus">-            ctx.translate(plotOffset.left, plotOffset.top);</span>
<a href="#l18.1109"></a><span id="l18.1109" class="difflineminus">-</span>
<a href="#l18.1110"></a><span id="l18.1110" class="difflineminus">-            // draw background, if any</span>
<a href="#l18.1111"></a><span id="l18.1111" class="difflineminus">-            if (options.grid.backgroundColor) {</span>
<a href="#l18.1112"></a><span id="l18.1112" class="difflineminus">-                ctx.fillStyle = getColorOrGradient(options.grid.backgroundColor, plotHeight, 0, &quot;rgba(255, 255, 255, 0)&quot;);</span>
<a href="#l18.1113"></a><span id="l18.1113" class="difflineminus">-                ctx.fillRect(0, 0, plotWidth, plotHeight);</span>
<a href="#l18.1114"></a><span id="l18.1114" class="difflineminus">-            }</span>
<a href="#l18.1115"></a><span id="l18.1115" class="difflineminus">-</span>
<a href="#l18.1116"></a><span id="l18.1116" class="difflineminus">-            // draw markings</span>
<a href="#l18.1117"></a><span id="l18.1117" class="difflineminus">-            var markings = options.grid.markings;</span>
<a href="#l18.1118"></a><span id="l18.1118" class="difflineminus">-            if (markings) {</span>
<a href="#l18.1119"></a><span id="l18.1119" class="difflineminus">-                if ($.isFunction(markings))</span>
<a href="#l18.1120"></a><span id="l18.1120" class="difflineminus">-                    // xmin etc. are backwards-compatible, to be removed in future</span>
<a href="#l18.1121"></a><span id="l18.1121" class="difflineminus">-                    markings = markings({ xmin: axes.xaxis.min, xmax: axes.xaxis.max, ymin: axes.yaxis.min, ymax: axes.yaxis.max, xaxis: axes.xaxis, yaxis: axes.yaxis, x2axis: axes.x2axis, y2axis: axes.y2axis });</span>
<a href="#l18.1122"></a><span id="l18.1122" class="difflineminus">-</span>
<a href="#l18.1123"></a><span id="l18.1123" class="difflineminus">-                for (i = 0; i &lt; markings.length; ++i) {</span>
<a href="#l18.1124"></a><span id="l18.1124" class="difflineminus">-                    var m = markings[i],</span>
<a href="#l18.1125"></a><span id="l18.1125" class="difflineminus">-                        xrange = extractRange(m, &quot;x&quot;),</span>
<a href="#l18.1126"></a><span id="l18.1126" class="difflineminus">-                        yrange = extractRange(m, &quot;y&quot;);</span>
<a href="#l18.1127"></a><span id="l18.1127" class="difflineminus">-</span>
<a href="#l18.1128"></a><span id="l18.1128" class="difflineminus">-                    // fill in missing</span>
<a href="#l18.1129"></a><span id="l18.1129" class="difflineminus">-                    if (xrange.from == null)</span>
<a href="#l18.1130"></a><span id="l18.1130" class="difflineminus">-                        xrange.from = xrange.axis.min;</span>
<a href="#l18.1131"></a><span id="l18.1131" class="difflineminus">-                    if (xrange.to == null)</span>
<a href="#l18.1132"></a><span id="l18.1132" class="difflineminus">-                        xrange.to = xrange.axis.max;</span>
<a href="#l18.1133"></a><span id="l18.1133" class="difflineminus">-                    if (yrange.from == null)</span>
<a href="#l18.1134"></a><span id="l18.1134" class="difflineminus">-                        yrange.from = yrange.axis.min;</span>
<a href="#l18.1135"></a><span id="l18.1135" class="difflineminus">-                    if (yrange.to == null)</span>
<a href="#l18.1136"></a><span id="l18.1136" class="difflineminus">-                        yrange.to = yrange.axis.max;</span>
<a href="#l18.1137"></a><span id="l18.1137" class="difflineminus">-</span>
<a href="#l18.1138"></a><span id="l18.1138" class="difflineminus">-                    // clip</span>
<a href="#l18.1139"></a><span id="l18.1139" class="difflineminus">-                    if (xrange.to &lt; xrange.axis.min || xrange.from &gt; xrange.axis.max ||</span>
<a href="#l18.1140"></a><span id="l18.1140" class="difflineminus">-                        yrange.to &lt; yrange.axis.min || yrange.from &gt; yrange.axis.max)</span>
<a href="#l18.1141"></a><span id="l18.1141" class="difflineminus">-                        continue;</span>
<a href="#l18.1142"></a><span id="l18.1142" class="difflineminus">-</span>
<a href="#l18.1143"></a><span id="l18.1143" class="difflineminus">-                    xrange.from = Math.max(xrange.from, xrange.axis.min);</span>
<a href="#l18.1144"></a><span id="l18.1144" class="difflineminus">-                    xrange.to = Math.min(xrange.to, xrange.axis.max);</span>
<a href="#l18.1145"></a><span id="l18.1145" class="difflineminus">-                    yrange.from = Math.max(yrange.from, yrange.axis.min);</span>
<a href="#l18.1146"></a><span id="l18.1146" class="difflineminus">-                    yrange.to = Math.min(yrange.to, yrange.axis.max);</span>
<a href="#l18.1147"></a><span id="l18.1147" class="difflineminus">-</span>
<a href="#l18.1148"></a><span id="l18.1148" class="difflineminus">-                    if (xrange.from == xrange.to &amp;&amp; yrange.from == yrange.to)</span>
<a href="#l18.1149"></a><span id="l18.1149" class="difflineminus">-                        continue;</span>
<a href="#l18.1150"></a><span id="l18.1150" class="difflineminus">-</span>
<a href="#l18.1151"></a><span id="l18.1151" class="difflineminus">-                    // then draw</span>
<a href="#l18.1152"></a><span id="l18.1152" class="difflineminus">-                    xrange.from = xrange.axis.p2c(xrange.from);</span>
<a href="#l18.1153"></a><span id="l18.1153" class="difflineminus">-                    xrange.to = xrange.axis.p2c(xrange.to);</span>
<a href="#l18.1154"></a><span id="l18.1154" class="difflineminus">-                    yrange.from = yrange.axis.p2c(yrange.from);</span>
<a href="#l18.1155"></a><span id="l18.1155" class="difflineminus">-                    yrange.to = yrange.axis.p2c(yrange.to);</span>
<a href="#l18.1156"></a><span id="l18.1156" class="difflineminus">-                    </span>
<a href="#l18.1157"></a><span id="l18.1157" class="difflineminus">-                    if (xrange.from == xrange.to || yrange.from == yrange.to) {</span>
<a href="#l18.1158"></a><span id="l18.1158" class="difflineminus">-                        // draw line</span>
<a href="#l18.1159"></a><span id="l18.1159" class="difflineminus">-                        ctx.beginPath();</span>
<a href="#l18.1160"></a><span id="l18.1160" class="difflineminus">-                        ctx.strokeStyle = m.color || options.grid.markingsColor;</span>
<a href="#l18.1161"></a><span id="l18.1161" class="difflineminus">-                        ctx.lineWidth = m.lineWidth || options.grid.markingsLineWidth;</span>
<a href="#l18.1162"></a><span id="l18.1162" class="difflineminus">-                        //ctx.moveTo(Math.floor(xrange.from), yrange.from);</span>
<a href="#l18.1163"></a><span id="l18.1163" class="difflineminus">-                        //ctx.lineTo(Math.floor(xrange.to), yrange.to);</span>
<a href="#l18.1164"></a><span id="l18.1164" class="difflineminus">-                        ctx.moveTo(xrange.from, yrange.from);</span>
<a href="#l18.1165"></a><span id="l18.1165" class="difflineminus">-                        ctx.lineTo(xrange.to, yrange.to);</span>
<a href="#l18.1166"></a><span id="l18.1166" class="difflineminus">-                        ctx.stroke();</span>
<a href="#l18.1167"></a><span id="l18.1167" class="difflineminus">-                    }</span>
<a href="#l18.1168"></a><span id="l18.1168" class="difflineminus">-                    else {</span>
<a href="#l18.1169"></a><span id="l18.1169" class="difflineminus">-                        // fill area</span>
<a href="#l18.1170"></a><span id="l18.1170" class="difflineminus">-                        ctx.fillStyle = m.color || options.grid.markingsColor;</span>
<a href="#l18.1171"></a><span id="l18.1171" class="difflineminus">-                        ctx.fillRect(xrange.from, yrange.to,</span>
<a href="#l18.1172"></a><span id="l18.1172" class="difflineminus">-                                     xrange.to - xrange.from,</span>
<a href="#l18.1173"></a><span id="l18.1173" class="difflineminus">-                                     yrange.from - yrange.to);</span>
<a href="#l18.1174"></a><span id="l18.1174" class="difflineminus">-                    }</span>
<a href="#l18.1175"></a><span id="l18.1175" class="difflineminus">-                }</span>
<a href="#l18.1176"></a><span id="l18.1176" class="difflineminus">-            }</span>
<a href="#l18.1177"></a><span id="l18.1177" class="difflineminus">-            </span>
<a href="#l18.1178"></a><span id="l18.1178" class="difflineminus">-            // draw the inner grid</span>
<a href="#l18.1179"></a><span id="l18.1179" class="difflineminus">-            ctx.lineWidth = 1;</span>
<a href="#l18.1180"></a><span id="l18.1180" class="difflineminus">-            ctx.strokeStyle = options.grid.tickColor;</span>
<a href="#l18.1181"></a><span id="l18.1181" class="difflineminus">-            ctx.beginPath();</span>
<a href="#l18.1182"></a><span id="l18.1182" class="difflineminus">-            var v, axis = axes.xaxis;</span>
<a href="#l18.1183"></a><span id="l18.1183" class="difflineminus">-            for (i = 0; i &lt; axis.ticks.length; ++i) {</span>
<a href="#l18.1184"></a><span id="l18.1184" class="difflineminus">-                v = axis.ticks[i].v;</span>
<a href="#l18.1185"></a><span id="l18.1185" class="difflineminus">-                if (v &lt;= axis.min || v &gt;= axes.xaxis.max)</span>
<a href="#l18.1186"></a><span id="l18.1186" class="difflineminus">-                    continue;   // skip those lying on the axes</span>
<a href="#l18.1187"></a><span id="l18.1187" class="difflineminus">-</span>
<a href="#l18.1188"></a><span id="l18.1188" class="difflineminus">-                ctx.moveTo(Math.floor(axis.p2c(v)) + ctx.lineWidth/2, 0);</span>
<a href="#l18.1189"></a><span id="l18.1189" class="difflineminus">-                ctx.lineTo(Math.floor(axis.p2c(v)) + ctx.lineWidth/2, plotHeight);</span>
<a href="#l18.1190"></a><span id="l18.1190" class="difflineminus">-            }</span>
<a href="#l18.1191"></a><span id="l18.1191" class="difflineminus">-</span>
<a href="#l18.1192"></a><span id="l18.1192" class="difflineminus">-            axis = axes.yaxis;</span>
<a href="#l18.1193"></a><span id="l18.1193" class="difflineminus">-            for (i = 0; i &lt; axis.ticks.length; ++i) {</span>
<a href="#l18.1194"></a><span id="l18.1194" class="difflineminus">-                v = axis.ticks[i].v;</span>
<a href="#l18.1195"></a><span id="l18.1195" class="difflineminus">-                if (v &lt;= axis.min || v &gt;= axis.max)</span>
<a href="#l18.1196"></a><span id="l18.1196" class="difflineminus">-                    continue;</span>
<a href="#l18.1197"></a><span id="l18.1197" class="difflineminus">-</span>
<a href="#l18.1198"></a><span id="l18.1198" class="difflineminus">-                ctx.moveTo(0, Math.floor(axis.p2c(v)) + ctx.lineWidth/2);</span>
<a href="#l18.1199"></a><span id="l18.1199" class="difflineminus">-                ctx.lineTo(plotWidth, Math.floor(axis.p2c(v)) + ctx.lineWidth/2);</span>
<a href="#l18.1200"></a><span id="l18.1200" class="difflineminus">-            }</span>
<a href="#l18.1201"></a><span id="l18.1201" class="difflineminus">-</span>
<a href="#l18.1202"></a><span id="l18.1202" class="difflineminus">-            axis = axes.x2axis;</span>
<a href="#l18.1203"></a><span id="l18.1203" class="difflineminus">-            for (i = 0; i &lt; axis.ticks.length; ++i) {</span>
<a href="#l18.1204"></a><span id="l18.1204" class="difflineminus">-                v = axis.ticks[i].v;</span>
<a href="#l18.1205"></a><span id="l18.1205" class="difflineminus">-                if (v &lt;= axis.min || v &gt;= axis.max)</span>
<a href="#l18.1206"></a><span id="l18.1206" class="difflineminus">-                    continue;</span>
<a href="#l18.1207"></a><span id="l18.1207" class="difflineminus">-    </span>
<a href="#l18.1208"></a><span id="l18.1208" class="difflineminus">-                ctx.moveTo(Math.floor(axis.p2c(v)) + ctx.lineWidth/2, -5);</span>
<a href="#l18.1209"></a><span id="l18.1209" class="difflineminus">-                ctx.lineTo(Math.floor(axis.p2c(v)) + ctx.lineWidth/2, 5);</span>
<a href="#l18.1210"></a><span id="l18.1210" class="difflineminus">-            }</span>
<a href="#l18.1211"></a><span id="l18.1211" class="difflineminus">-</span>
<a href="#l18.1212"></a><span id="l18.1212" class="difflineminus">-            axis = axes.y2axis;</span>
<a href="#l18.1213"></a><span id="l18.1213" class="difflineminus">-            for (i = 0; i &lt; axis.ticks.length; ++i) {</span>
<a href="#l18.1214"></a><span id="l18.1214" class="difflineminus">-                v = axis.ticks[i].v;</span>
<a href="#l18.1215"></a><span id="l18.1215" class="difflineminus">-                if (v &lt;= axis.min || v &gt;= axis.max)</span>
<a href="#l18.1216"></a><span id="l18.1216" class="difflineminus">-                    continue;</span>
<a href="#l18.1217"></a><span id="l18.1217" class="difflineminus">-</span>
<a href="#l18.1218"></a><span id="l18.1218" class="difflineminus">-                ctx.moveTo(plotWidth-5, Math.floor(axis.p2c(v)) + ctx.lineWidth/2);</span>
<a href="#l18.1219"></a><span id="l18.1219" class="difflineminus">-                ctx.lineTo(plotWidth+5, Math.floor(axis.p2c(v)) + ctx.lineWidth/2);</span>
<a href="#l18.1220"></a><span id="l18.1220" class="difflineminus">-            }</span>
<a href="#l18.1221"></a><span id="l18.1221" class="difflineminus">-            </span>
<a href="#l18.1222"></a><span id="l18.1222" class="difflineminus">-            ctx.stroke();</span>
<a href="#l18.1223"></a><span id="l18.1223" class="difflineminus">-            </span>
<a href="#l18.1224"></a><span id="l18.1224" class="difflineminus">-            if (options.grid.borderWidth) {</span>
<a href="#l18.1225"></a><span id="l18.1225" class="difflineminus">-                // draw border</span>
<a href="#l18.1226"></a><span id="l18.1226" class="difflineminus">-                var bw = options.grid.borderWidth;</span>
<a href="#l18.1227"></a><span id="l18.1227" class="difflineminus">-                ctx.lineWidth = bw;</span>
<a href="#l18.1228"></a><span id="l18.1228" class="difflineminus">-                ctx.strokeStyle = options.grid.borderColor;</span>
<a href="#l18.1229"></a><span id="l18.1229" class="difflineminus">-                ctx.strokeRect(-bw/2, -bw/2, plotWidth + bw, plotHeight + bw);</span>
<a href="#l18.1230"></a><span id="l18.1230" class="difflineminus">-            }</span>
<a href="#l18.1231"></a><span id="l18.1231" class="difflineminus">-</span>
<a href="#l18.1232"></a><span id="l18.1232" class="difflineminus">-            ctx.restore();</span>
<a href="#l18.1233"></a><span id="l18.1233" class="difflineminus">-        }</span>
<a href="#l18.1234"></a><span id="l18.1234" class="difflineminus">-</span>
<a href="#l18.1235"></a><span id="l18.1235" class="difflineminus">-        function insertLabels() {</span>
<a href="#l18.1236"></a><span id="l18.1236" class="difflineminus">-            placeholder.find(&quot;.tickLabels&quot;).remove();</span>
<a href="#l18.1237"></a><span id="l18.1237" class="difflineminus">-            </span>
<a href="#l18.1238"></a><span id="l18.1238" class="difflineminus">-            var html = ['&lt;div class=&quot;tickLabels&quot; style=&quot;font-size:smaller;color:' + options.grid.color + '&quot;&gt;'];</span>
<a href="#l18.1239"></a><span id="l18.1239" class="difflineminus">-</span>
<a href="#l18.1240"></a><span id="l18.1240" class="difflineminus">-            function addLabels(axis, labelGenerator) {</span>
<a href="#l18.1241"></a><span id="l18.1241" class="difflineminus">-                for (var i = 0; i &lt; axis.ticks.length; ++i) {</span>
<a href="#l18.1242"></a><span id="l18.1242" class="difflineminus">-                    var tick = axis.ticks[i];</span>
<a href="#l18.1243"></a><span id="l18.1243" class="difflineminus">-                    if (!tick.label || tick.v &lt; axis.min || tick.v &gt; axis.max)</span>
<a href="#l18.1244"></a><span id="l18.1244" class="difflineminus">-                        continue;</span>
<a href="#l18.1245"></a><span id="l18.1245" class="difflineminus">-                    html.push(labelGenerator(tick, axis));</span>
<a href="#l18.1246"></a><span id="l18.1246" class="difflineminus">-                }</span>
<a href="#l18.1247"></a><span id="l18.1247" class="difflineminus">-            }</span>
<a href="#l18.1248"></a><span id="l18.1248" class="difflineminus">-</span>
<a href="#l18.1249"></a><span id="l18.1249" class="difflineminus">-            var margin = options.grid.labelMargin + options.grid.borderWidth;</span>
<a href="#l18.1250"></a><span id="l18.1250" class="difflineminus">-            </span>
<a href="#l18.1251"></a><span id="l18.1251" class="difflineminus">-            addLabels(axes.xaxis, function (tick, axis) {</span>
<a href="#l18.1252"></a><span id="l18.1252" class="difflineminus">-                return '&lt;div style=&quot;position:absolute;top:' + (plotOffset.top + plotHeight + margin) + 'px;left:' + Math.round(plotOffset.left + axis.p2c(tick.v) - axis.labelWidth/2) + 'px;width:' + axis.labelWidth + 'px;text-align:center&quot; class=&quot;tickLabel&quot;&gt;' + tick.label + &quot;&lt;/div&gt;&quot;;</span>
<a href="#l18.1253"></a><span id="l18.1253" class="difflineminus">-            });</span>
<a href="#l18.1254"></a><span id="l18.1254" class="difflineminus">-            </span>
<a href="#l18.1255"></a><span id="l18.1255" class="difflineminus">-            </span>
<a href="#l18.1256"></a><span id="l18.1256" class="difflineminus">-            addLabels(axes.yaxis, function (tick, axis) {</span>
<a href="#l18.1257"></a><span id="l18.1257" class="difflineminus">-                return '&lt;div style=&quot;position:absolute;top:' + Math.round(plotOffset.top + axis.p2c(tick.v) - axis.labelHeight/2) + 'px;right:' + (plotOffset.right + plotWidth + margin) + 'px;width:' + axis.labelWidth + 'px;text-align:right&quot; class=&quot;tickLabel&quot;&gt;' + tick.label + &quot;&lt;/div&gt;&quot;;</span>
<a href="#l18.1258"></a><span id="l18.1258" class="difflineminus">-            });</span>
<a href="#l18.1259"></a><span id="l18.1259" class="difflineminus">-            </span>
<a href="#l18.1260"></a><span id="l18.1260" class="difflineminus">-            addLabels(axes.x2axis, function (tick, axis) {</span>
<a href="#l18.1261"></a><span id="l18.1261" class="difflineminus">-                return '&lt;div style=&quot;position:absolute;bottom:' + (plotOffset.bottom + plotHeight + margin) + 'px;left:' + Math.round(plotOffset.left + axis.p2c(tick.v) - axis.labelWidth/2) + 'px;width:' + axis.labelWidth + 'px;text-align:center&quot; class=&quot;tickLabel&quot;&gt;' + tick.label + &quot;&lt;/div&gt;&quot;;</span>
<a href="#l18.1262"></a><span id="l18.1262" class="difflineminus">-            });</span>
<a href="#l18.1263"></a><span id="l18.1263" class="difflineminus">-            </span>
<a href="#l18.1264"></a><span id="l18.1264" class="difflineminus">-            addLabels(axes.y2axis, function (tick, axis) {</span>
<a href="#l18.1265"></a><span id="l18.1265" class="difflineminus">-                return '&lt;div style=&quot;position:absolute;top:' + Math.round(plotOffset.top + axis.p2c(tick.v) - axis.labelHeight/2) + 'px;left:' + (plotOffset.left + plotWidth + margin) +'px;width:' + axis.labelWidth + 'px;text-align:left&quot; class=&quot;tickLabel&quot;&gt;' + tick.label + &quot;&lt;/div&gt;&quot;;</span>
<a href="#l18.1266"></a><span id="l18.1266" class="difflineminus">-            });</span>
<a href="#l18.1267"></a><span id="l18.1267" class="difflineminus">-</span>
<a href="#l18.1268"></a><span id="l18.1268" class="difflineminus">-            html.push('&lt;/div&gt;');</span>
<a href="#l18.1269"></a><span id="l18.1269" class="difflineminus">-            </span>
<a href="#l18.1270"></a><span id="l18.1270" class="difflineminus">-            placeholder.append(html.join(&quot;&quot;));</span>
<a href="#l18.1271"></a><span id="l18.1271" class="difflineminus">-        }</span>
<a href="#l18.1272"></a><span id="l18.1272" class="difflineminus">-</span>
<a href="#l18.1273"></a><span id="l18.1273" class="difflineminus">-        function drawSeries(series) {</span>
<a href="#l18.1274"></a><span id="l18.1274" class="difflineminus">-            if (series.lines.show)</span>
<a href="#l18.1275"></a><span id="l18.1275" class="difflineminus">-                drawSeriesLines(series);</span>
<a href="#l18.1276"></a><span id="l18.1276" class="difflineminus">-            if (series.bars.show)</span>
<a href="#l18.1277"></a><span id="l18.1277" class="difflineminus">-                drawSeriesBars(series);</span>
<a href="#l18.1278"></a><span id="l18.1278" class="difflineminus">-            if (series.points.show)</span>
<a href="#l18.1279"></a><span id="l18.1279" class="difflineminus">-                drawSeriesPoints(series);</span>
<a href="#l18.1280"></a><span id="l18.1280" class="difflineminus">-        }</span>
<a href="#l18.1281"></a><span id="l18.1281" class="difflineminus">-        </span>
<a href="#l18.1282"></a><span id="l18.1282" class="difflineminus">-        function drawSeriesLines(series) {</span>
<a href="#l18.1283"></a><span id="l18.1283" class="difflineminus">-            function plotLine(datapoints, xoffset, yoffset, axisx, axisy) {</span>
<a href="#l18.1284"></a><span id="l18.1284" class="difflineminus">-                var points = datapoints.points,</span>
<a href="#l18.1285"></a><span id="l18.1285" class="difflineminus">-                    ps = datapoints.pointsize,</span>
<a href="#l18.1286"></a><span id="l18.1286" class="difflineminus">-                    prevx = null, prevy = null;</span>
<a href="#l18.1287"></a><span id="l18.1287" class="difflineminus">-                </span>
<a href="#l18.1288"></a><span id="l18.1288" class="difflineminus">-                ctx.beginPath();</span>
<a href="#l18.1289"></a><span id="l18.1289" class="difflineminus">-                for (var i = ps; i &lt; points.length; i += ps) {</span>
<a href="#l18.1290"></a><span id="l18.1290" class="difflineminus">-                    var x1 = points[i - ps], y1 = points[i - ps + 1],</span>
<a href="#l18.1291"></a><span id="l18.1291" class="difflineminus">-                        x2 = points[i], y2 = points[i + 1];</span>
<a href="#l18.1292"></a><span id="l18.1292" class="difflineminus">-                    </span>
<a href="#l18.1293"></a><span id="l18.1293" class="difflineminus">-                    if (x1 == null || x2 == null)</span>
<a href="#l18.1294"></a><span id="l18.1294" class="difflineminus">-                        continue;</span>
<a href="#l18.1295"></a><span id="l18.1295" class="difflineminus">-</span>
<a href="#l18.1296"></a><span id="l18.1296" class="difflineminus">-                    // clip with ymin</span>
<a href="#l18.1297"></a><span id="l18.1297" class="difflineminus">-                    if (y1 &lt;= y2 &amp;&amp; y1 &lt; axisy.min) {</span>
<a href="#l18.1298"></a><span id="l18.1298" class="difflineminus">-                        if (y2 &lt; axisy.min)</span>
<a href="#l18.1299"></a><span id="l18.1299" class="difflineminus">-                            continue;   // line segment is outside</span>
<a href="#l18.1300"></a><span id="l18.1300" class="difflineminus">-                        // compute new intersection point</span>
<a href="#l18.1301"></a><span id="l18.1301" class="difflineminus">-                        x1 = (axisy.min - y1) / (y2 - y1) * (x2 - x1) + x1;</span>
<a href="#l18.1302"></a><span id="l18.1302" class="difflineminus">-                        y1 = axisy.min;</span>
<a href="#l18.1303"></a><span id="l18.1303" class="difflineminus">-                    }</span>
<a href="#l18.1304"></a><span id="l18.1304" class="difflineminus">-                    else if (y2 &lt;= y1 &amp;&amp; y2 &lt; axisy.min) {</span>
<a href="#l18.1305"></a><span id="l18.1305" class="difflineminus">-                        if (y1 &lt; axisy.min)</span>
<a href="#l18.1306"></a><span id="l18.1306" class="difflineminus">-                            continue;</span>
<a href="#l18.1307"></a><span id="l18.1307" class="difflineminus">-                        x2 = (axisy.min - y1) / (y2 - y1) * (x2 - x1) + x1;</span>
<a href="#l18.1308"></a><span id="l18.1308" class="difflineminus">-                        y2 = axisy.min;</span>
<a href="#l18.1309"></a><span id="l18.1309" class="difflineminus">-                    }</span>
<a href="#l18.1310"></a><span id="l18.1310" class="difflineminus">-</span>
<a href="#l18.1311"></a><span id="l18.1311" class="difflineminus">-                    // clip with ymax</span>
<a href="#l18.1312"></a><span id="l18.1312" class="difflineminus">-                    if (y1 &gt;= y2 &amp;&amp; y1 &gt; axisy.max) {</span>
<a href="#l18.1313"></a><span id="l18.1313" class="difflineminus">-                        if (y2 &gt; axisy.max)</span>
<a href="#l18.1314"></a><span id="l18.1314" class="difflineminus">-                            continue;</span>
<a href="#l18.1315"></a><span id="l18.1315" class="difflineminus">-                        x1 = (axisy.max - y1) / (y2 - y1) * (x2 - x1) + x1;</span>
<a href="#l18.1316"></a><span id="l18.1316" class="difflineminus">-                        y1 = axisy.max;</span>
<a href="#l18.1317"></a><span id="l18.1317" class="difflineminus">-                    }</span>
<a href="#l18.1318"></a><span id="l18.1318" class="difflineminus">-                    else if (y2 &gt;= y1 &amp;&amp; y2 &gt; axisy.max) {</span>
<a href="#l18.1319"></a><span id="l18.1319" class="difflineminus">-                        if (y1 &gt; axisy.max)</span>
<a href="#l18.1320"></a><span id="l18.1320" class="difflineminus">-                            continue;</span>
<a href="#l18.1321"></a><span id="l18.1321" class="difflineminus">-                        x2 = (axisy.max - y1) / (y2 - y1) * (x2 - x1) + x1;</span>
<a href="#l18.1322"></a><span id="l18.1322" class="difflineminus">-                        y2 = axisy.max;</span>
<a href="#l18.1323"></a><span id="l18.1323" class="difflineminus">-                    }</span>
<a href="#l18.1324"></a><span id="l18.1324" class="difflineminus">-</span>
<a href="#l18.1325"></a><span id="l18.1325" class="difflineminus">-                    // clip with xmin</span>
<a href="#l18.1326"></a><span id="l18.1326" class="difflineminus">-                    if (x1 &lt;= x2 &amp;&amp; x1 &lt; axisx.min) {</span>
<a href="#l18.1327"></a><span id="l18.1327" class="difflineminus">-                        if (x2 &lt; axisx.min)</span>
<a href="#l18.1328"></a><span id="l18.1328" class="difflineminus">-                            continue;</span>
<a href="#l18.1329"></a><span id="l18.1329" class="difflineminus">-                        y1 = (axisx.min - x1) / (x2 - x1) * (y2 - y1) + y1;</span>
<a href="#l18.1330"></a><span id="l18.1330" class="difflineminus">-                        x1 = axisx.min;</span>
<a href="#l18.1331"></a><span id="l18.1331" class="difflineminus">-                    }</span>
<a href="#l18.1332"></a><span id="l18.1332" class="difflineminus">-                    else if (x2 &lt;= x1 &amp;&amp; x2 &lt; axisx.min) {</span>
<a href="#l18.1333"></a><span id="l18.1333" class="difflineminus">-                        if (x1 &lt; axisx.min)</span>
<a href="#l18.1334"></a><span id="l18.1334" class="difflineminus">-                            continue;</span>
<a href="#l18.1335"></a><span id="l18.1335" class="difflineminus">-                        y2 = (axisx.min - x1) / (x2 - x1) * (y2 - y1) + y1;</span>
<a href="#l18.1336"></a><span id="l18.1336" class="difflineminus">-                        x2 = axisx.min;</span>
<a href="#l18.1337"></a><span id="l18.1337" class="difflineminus">-                    }</span>
<a href="#l18.1338"></a><span id="l18.1338" class="difflineminus">-</span>
<a href="#l18.1339"></a><span id="l18.1339" class="difflineminus">-                    // clip with xmax</span>
<a href="#l18.1340"></a><span id="l18.1340" class="difflineminus">-                    if (x1 &gt;= x2 &amp;&amp; x1 &gt; axisx.max) {</span>
<a href="#l18.1341"></a><span id="l18.1341" class="difflineminus">-                        if (x2 &gt; axisx.max)</span>
<a href="#l18.1342"></a><span id="l18.1342" class="difflineminus">-                            continue;</span>
<a href="#l18.1343"></a><span id="l18.1343" class="difflineminus">-                        y1 = (axisx.max - x1) / (x2 - x1) * (y2 - y1) + y1;</span>
<a href="#l18.1344"></a><span id="l18.1344" class="difflineminus">-                        x1 = axisx.max;</span>
<a href="#l18.1345"></a><span id="l18.1345" class="difflineminus">-                    }</span>
<a href="#l18.1346"></a><span id="l18.1346" class="difflineminus">-                    else if (x2 &gt;= x1 &amp;&amp; x2 &gt; axisx.max) {</span>
<a href="#l18.1347"></a><span id="l18.1347" class="difflineminus">-                        if (x1 &gt; axisx.max)</span>
<a href="#l18.1348"></a><span id="l18.1348" class="difflineminus">-                            continue;</span>
<a href="#l18.1349"></a><span id="l18.1349" class="difflineminus">-                        y2 = (axisx.max - x1) / (x2 - x1) * (y2 - y1) + y1;</span>
<a href="#l18.1350"></a><span id="l18.1350" class="difflineminus">-                        x2 = axisx.max;</span>
<a href="#l18.1351"></a><span id="l18.1351" class="difflineminus">-                    }</span>
<a href="#l18.1352"></a><span id="l18.1352" class="difflineminus">-</span>
<a href="#l18.1353"></a><span id="l18.1353" class="difflineminus">-                    if (x1 != prevx || y1 != prevy)</span>
<a href="#l18.1354"></a><span id="l18.1354" class="difflineminus">-                        ctx.moveTo(axisx.p2c(x1) + xoffset, axisy.p2c(y1) + yoffset);</span>
<a href="#l18.1355"></a><span id="l18.1355" class="difflineminus">-                    </span>
<a href="#l18.1356"></a><span id="l18.1356" class="difflineminus">-                    prevx = x2;</span>
<a href="#l18.1357"></a><span id="l18.1357" class="difflineminus">-                    prevy = y2;</span>
<a href="#l18.1358"></a><span id="l18.1358" class="difflineminus">-                    ctx.lineTo(axisx.p2c(x2) + xoffset, axisy.p2c(y2) + yoffset);</span>
<a href="#l18.1359"></a><span id="l18.1359" class="difflineminus">-                }</span>
<a href="#l18.1360"></a><span id="l18.1360" class="difflineminus">-                ctx.stroke();</span>
<a href="#l18.1361"></a><span id="l18.1361" class="difflineminus">-            }</span>
<a href="#l18.1362"></a><span id="l18.1362" class="difflineminus">-</span>
<a href="#l18.1363"></a><span id="l18.1363" class="difflineminus">-            function plotLineArea(datapoints, axisx, axisy) {</span>
<a href="#l18.1364"></a><span id="l18.1364" class="difflineminus">-                var points = datapoints.points,</span>
<a href="#l18.1365"></a><span id="l18.1365" class="difflineminus">-                    ps = datapoints.pointsize,</span>
<a href="#l18.1366"></a><span id="l18.1366" class="difflineminus">-                    bottom = Math.min(Math.max(0, axisy.min), axisy.max),</span>
<a href="#l18.1367"></a><span id="l18.1367" class="difflineminus">-                    top, lastX = 0, areaOpen = false;</span>
<a href="#l18.1368"></a><span id="l18.1368" class="difflineminus">-                </span>
<a href="#l18.1369"></a><span id="l18.1369" class="difflineminus">-                for (var i = ps; i &lt; points.length; i += ps) {</span>
<a href="#l18.1370"></a><span id="l18.1370" class="difflineminus">-                    var x1 = points[i - ps], y1 = points[i - ps + 1],</span>
<a href="#l18.1371"></a><span id="l18.1371" class="difflineminus">-                        x2 = points[i], y2 = points[i + 1];</span>
<a href="#l18.1372"></a><span id="l18.1372" class="difflineminus">-                    </span>
<a href="#l18.1373"></a><span id="l18.1373" class="difflineminus">-                    if (areaOpen &amp;&amp; x1 != null &amp;&amp; x2 == null) {</span>
<a href="#l18.1374"></a><span id="l18.1374" class="difflineminus">-                        // close area</span>
<a href="#l18.1375"></a><span id="l18.1375" class="difflineminus">-                        ctx.lineTo(axisx.p2c(lastX), axisy.p2c(bottom));</span>
<a href="#l18.1376"></a><span id="l18.1376" class="difflineminus">-                        ctx.fill();</span>
<a href="#l18.1377"></a><span id="l18.1377" class="difflineminus">-                        areaOpen = false;</span>
<a href="#l18.1378"></a><span id="l18.1378" class="difflineminus">-                        continue;</span>
<a href="#l18.1379"></a><span id="l18.1379" class="difflineminus">-                    }</span>
<a href="#l18.1380"></a><span id="l18.1380" class="difflineminus">-</span>
<a href="#l18.1381"></a><span id="l18.1381" class="difflineminus">-                    if (x1 == null || x2 == null)</span>
<a href="#l18.1382"></a><span id="l18.1382" class="difflineminus">-                        continue;</span>
<a href="#l18.1383"></a><span id="l18.1383" class="difflineminus">-</span>
<a href="#l18.1384"></a><span id="l18.1384" class="difflineminus">-                    // clip x values</span>
<a href="#l18.1385"></a><span id="l18.1385" class="difflineminus">-                    </span>
<a href="#l18.1386"></a><span id="l18.1386" class="difflineminus">-                    // clip with xmin</span>
<a href="#l18.1387"></a><span id="l18.1387" class="difflineminus">-                    if (x1 &lt;= x2 &amp;&amp; x1 &lt; axisx.min) {</span>
<a href="#l18.1388"></a><span id="l18.1388" class="difflineminus">-                        if (x2 &lt; axisx.min)</span>
<a href="#l18.1389"></a><span id="l18.1389" class="difflineminus">-                            continue;</span>
<a href="#l18.1390"></a><span id="l18.1390" class="difflineminus">-                        y1 = (axisx.min - x1) / (x2 - x1) * (y2 - y1) + y1;</span>
<a href="#l18.1391"></a><span id="l18.1391" class="difflineminus">-                        x1 = axisx.min;</span>
<a href="#l18.1392"></a><span id="l18.1392" class="difflineminus">-                    }</span>
<a href="#l18.1393"></a><span id="l18.1393" class="difflineminus">-                    else if (x2 &lt;= x1 &amp;&amp; x2 &lt; axisx.min) {</span>
<a href="#l18.1394"></a><span id="l18.1394" class="difflineminus">-                        if (x1 &lt; axisx.min)</span>
<a href="#l18.1395"></a><span id="l18.1395" class="difflineminus">-                            continue;</span>
<a href="#l18.1396"></a><span id="l18.1396" class="difflineminus">-                        y2 = (axisx.min - x1) / (x2 - x1) * (y2 - y1) + y1;</span>
<a href="#l18.1397"></a><span id="l18.1397" class="difflineminus">-                        x2 = axisx.min;</span>
<a href="#l18.1398"></a><span id="l18.1398" class="difflineminus">-                    }</span>
<a href="#l18.1399"></a><span id="l18.1399" class="difflineminus">-</span>
<a href="#l18.1400"></a><span id="l18.1400" class="difflineminus">-                    // clip with xmax</span>
<a href="#l18.1401"></a><span id="l18.1401" class="difflineminus">-                    if (x1 &gt;= x2 &amp;&amp; x1 &gt; axisx.max) {</span>
<a href="#l18.1402"></a><span id="l18.1402" class="difflineminus">-                        if (x2 &gt; axisx.max)</span>
<a href="#l18.1403"></a><span id="l18.1403" class="difflineminus">-                            continue;</span>
<a href="#l18.1404"></a><span id="l18.1404" class="difflineminus">-                        y1 = (axisx.max - x1) / (x2 - x1) * (y2 - y1) + y1;</span>
<a href="#l18.1405"></a><span id="l18.1405" class="difflineminus">-                        x1 = axisx.max;</span>
<a href="#l18.1406"></a><span id="l18.1406" class="difflineminus">-                    }</span>
<a href="#l18.1407"></a><span id="l18.1407" class="difflineminus">-                    else if (x2 &gt;= x1 &amp;&amp; x2 &gt; axisx.max) {</span>
<a href="#l18.1408"></a><span id="l18.1408" class="difflineminus">-                        if (x1 &gt; axisx.max)</span>
<a href="#l18.1409"></a><span id="l18.1409" class="difflineminus">-                            continue;</span>
<a href="#l18.1410"></a><span id="l18.1410" class="difflineminus">-                        y2 = (axisx.max - x1) / (x2 - x1) * (y2 - y1) + y1;</span>
<a href="#l18.1411"></a><span id="l18.1411" class="difflineminus">-                        x2 = axisx.max;</span>
<a href="#l18.1412"></a><span id="l18.1412" class="difflineminus">-                    }</span>
<a href="#l18.1413"></a><span id="l18.1413" class="difflineminus">-</span>
<a href="#l18.1414"></a><span id="l18.1414" class="difflineminus">-                    if (!areaOpen) {</span>
<a href="#l18.1415"></a><span id="l18.1415" class="difflineminus">-                        // open area</span>
<a href="#l18.1416"></a><span id="l18.1416" class="difflineminus">-                        ctx.beginPath();</span>
<a href="#l18.1417"></a><span id="l18.1417" class="difflineminus">-                        ctx.moveTo(axisx.p2c(x1), axisy.p2c(bottom));</span>
<a href="#l18.1418"></a><span id="l18.1418" class="difflineminus">-                        areaOpen = true;</span>
<a href="#l18.1419"></a><span id="l18.1419" class="difflineminus">-                    }</span>
<a href="#l18.1420"></a><span id="l18.1420" class="difflineminus">-                    </span>
<a href="#l18.1421"></a><span id="l18.1421" class="difflineminus">-                    // now first check the case where both is outside</span>
<a href="#l18.1422"></a><span id="l18.1422" class="difflineminus">-                    if (y1 &gt;= axisy.max &amp;&amp; y2 &gt;= axisy.max) {</span>
<a href="#l18.1423"></a><span id="l18.1423" class="difflineminus">-                        ctx.lineTo(axisx.p2c(x1), axisy.p2c(axisy.max));</span>
<a href="#l18.1424"></a><span id="l18.1424" class="difflineminus">-                        ctx.lineTo(axisx.p2c(x2), axisy.p2c(axisy.max));</span>
<a href="#l18.1425"></a><span id="l18.1425" class="difflineminus">-                        lastX = x2;</span>
<a href="#l18.1426"></a><span id="l18.1426" class="difflineminus">-                        continue;</span>
<a href="#l18.1427"></a><span id="l18.1427" class="difflineminus">-                    }</span>
<a href="#l18.1428"></a><span id="l18.1428" class="difflineminus">-                    else if (y1 &lt;= axisy.min &amp;&amp; y2 &lt;= axisy.min) {</span>
<a href="#l18.1429"></a><span id="l18.1429" class="difflineminus">-                        ctx.lineTo(axisx.p2c(x1), axisy.p2c(axisy.min));</span>
<a href="#l18.1430"></a><span id="l18.1430" class="difflineminus">-                        ctx.lineTo(axisx.p2c(x2), axisy.p2c(axisy.min));</span>
<a href="#l18.1431"></a><span id="l18.1431" class="difflineminus">-                        lastX = x2;</span>
<a href="#l18.1432"></a><span id="l18.1432" class="difflineminus">-                        continue;</span>
<a href="#l18.1433"></a><span id="l18.1433" class="difflineminus">-                    }</span>
<a href="#l18.1434"></a><span id="l18.1434" class="difflineminus">-                    </span>
<a href="#l18.1435"></a><span id="l18.1435" class="difflineminus">-                    // else it's a bit more complicated, there might</span>
<a href="#l18.1436"></a><span id="l18.1436" class="difflineminus">-                    // be two rectangles and two triangles we need to fill</span>
<a href="#l18.1437"></a><span id="l18.1437" class="difflineminus">-                    // in; to find these keep track of the current x values</span>
<a href="#l18.1438"></a><span id="l18.1438" class="difflineminus">-                    var x1old = x1, x2old = x2;</span>
<a href="#l18.1439"></a><span id="l18.1439" class="difflineminus">-</span>
<a href="#l18.1440"></a><span id="l18.1440" class="difflineminus">-                    // and clip the y values, without shortcutting</span>
<a href="#l18.1441"></a><span id="l18.1441" class="difflineminus">-                    </span>
<a href="#l18.1442"></a><span id="l18.1442" class="difflineminus">-                    // clip with ymin</span>
<a href="#l18.1443"></a><span id="l18.1443" class="difflineminus">-                    if (y1 &lt;= y2 &amp;&amp; y1 &lt; axisy.min &amp;&amp; y2 &gt;= axisy.min) {</span>
<a href="#l18.1444"></a><span id="l18.1444" class="difflineminus">-                        x1 = (axisy.min - y1) / (y2 - y1) * (x2 - x1) + x1;</span>
<a href="#l18.1445"></a><span id="l18.1445" class="difflineminus">-                        y1 = axisy.min;</span>
<a href="#l18.1446"></a><span id="l18.1446" class="difflineminus">-                    }</span>
<a href="#l18.1447"></a><span id="l18.1447" class="difflineminus">-                    else if (y2 &lt;= y1 &amp;&amp; y2 &lt; axisy.min &amp;&amp; y1 &gt;= axisy.min) {</span>
<a href="#l18.1448"></a><span id="l18.1448" class="difflineminus">-                        x2 = (axisy.min - y1) / (y2 - y1) * (x2 - x1) + x1;</span>
<a href="#l18.1449"></a><span id="l18.1449" class="difflineminus">-                        y2 = axisy.min;</span>
<a href="#l18.1450"></a><span id="l18.1450" class="difflineminus">-                    }</span>
<a href="#l18.1451"></a><span id="l18.1451" class="difflineminus">-</span>
<a href="#l18.1452"></a><span id="l18.1452" class="difflineminus">-                    // clip with ymax</span>
<a href="#l18.1453"></a><span id="l18.1453" class="difflineminus">-                    if (y1 &gt;= y2 &amp;&amp; y1 &gt; axisy.max &amp;&amp; y2 &lt;= axisy.max) {</span>
<a href="#l18.1454"></a><span id="l18.1454" class="difflineminus">-                        x1 = (axisy.max - y1) / (y2 - y1) * (x2 - x1) + x1;</span>
<a href="#l18.1455"></a><span id="l18.1455" class="difflineminus">-                        y1 = axisy.max;</span>
<a href="#l18.1456"></a><span id="l18.1456" class="difflineminus">-                    }</span>
<a href="#l18.1457"></a><span id="l18.1457" class="difflineminus">-                    else if (y2 &gt;= y1 &amp;&amp; y2 &gt; axisy.max &amp;&amp; y1 &lt;= axisy.max) {</span>
<a href="#l18.1458"></a><span id="l18.1458" class="difflineminus">-                        x2 = (axisy.max - y1) / (y2 - y1) * (x2 - x1) + x1;</span>
<a href="#l18.1459"></a><span id="l18.1459" class="difflineminus">-                        y2 = axisy.max;</span>
<a href="#l18.1460"></a><span id="l18.1460" class="difflineminus">-                    }</span>
<a href="#l18.1461"></a><span id="l18.1461" class="difflineminus">-</span>
<a href="#l18.1462"></a><span id="l18.1462" class="difflineminus">-</span>
<a href="#l18.1463"></a><span id="l18.1463" class="difflineminus">-                    // if the x value was changed we got a rectangle</span>
<a href="#l18.1464"></a><span id="l18.1464" class="difflineminus">-                    // to fill</span>
<a href="#l18.1465"></a><span id="l18.1465" class="difflineminus">-                    if (x1 != x1old) {</span>
<a href="#l18.1466"></a><span id="l18.1466" class="difflineminus">-                        if (y1 &lt;= axisy.min)</span>
<a href="#l18.1467"></a><span id="l18.1467" class="difflineminus">-                            top = axisy.min;</span>
<a href="#l18.1468"></a><span id="l18.1468" class="difflineminus">-                        else</span>
<a href="#l18.1469"></a><span id="l18.1469" class="difflineminus">-                            top = axisy.max;</span>
<a href="#l18.1470"></a><span id="l18.1470" class="difflineminus">-                        </span>
<a href="#l18.1471"></a><span id="l18.1471" class="difflineminus">-                        ctx.lineTo(axisx.p2c(x1old), axisy.p2c(top));</span>
<a href="#l18.1472"></a><span id="l18.1472" class="difflineminus">-                        ctx.lineTo(axisx.p2c(x1), axisy.p2c(top));</span>
<a href="#l18.1473"></a><span id="l18.1473" class="difflineminus">-                    }</span>
<a href="#l18.1474"></a><span id="l18.1474" class="difflineminus">-                    </span>
<a href="#l18.1475"></a><span id="l18.1475" class="difflineminus">-                    // fill the triangles</span>
<a href="#l18.1476"></a><span id="l18.1476" class="difflineminus">-                    ctx.lineTo(axisx.p2c(x1), axisy.p2c(y1));</span>
<a href="#l18.1477"></a><span id="l18.1477" class="difflineminus">-                    ctx.lineTo(axisx.p2c(x2), axisy.p2c(y2));</span>
<a href="#l18.1478"></a><span id="l18.1478" class="difflineminus">-</span>
<a href="#l18.1479"></a><span id="l18.1479" class="difflineminus">-                    // fill the other rectangle if it's there</span>
<a href="#l18.1480"></a><span id="l18.1480" class="difflineminus">-                    if (x2 != x2old) {</span>
<a href="#l18.1481"></a><span id="l18.1481" class="difflineminus">-                        if (y2 &lt;= axisy.min)</span>
<a href="#l18.1482"></a><span id="l18.1482" class="difflineminus">-                            top = axisy.min;</span>
<a href="#l18.1483"></a><span id="l18.1483" class="difflineminus">-                        else</span>
<a href="#l18.1484"></a><span id="l18.1484" class="difflineminus">-                            top = axisy.max;</span>
<a href="#l18.1485"></a><span id="l18.1485" class="difflineminus">-                        </span>
<a href="#l18.1486"></a><span id="l18.1486" class="difflineminus">-                        ctx.lineTo(axisx.p2c(x2), axisy.p2c(top));</span>
<a href="#l18.1487"></a><span id="l18.1487" class="difflineminus">-                        ctx.lineTo(axisx.p2c(x2old), axisy.p2c(top));</span>
<a href="#l18.1488"></a><span id="l18.1488" class="difflineminus">-                    }</span>
<a href="#l18.1489"></a><span id="l18.1489" class="difflineminus">-</span>
<a href="#l18.1490"></a><span id="l18.1490" class="difflineminus">-                    lastX = Math.max(x2, x2old);</span>
<a href="#l18.1491"></a><span id="l18.1491" class="difflineminus">-                }</span>
<a href="#l18.1492"></a><span id="l18.1492" class="difflineminus">-</span>
<a href="#l18.1493"></a><span id="l18.1493" class="difflineminus">-                if (areaOpen) {</span>
<a href="#l18.1494"></a><span id="l18.1494" class="difflineminus">-                    ctx.lineTo(axisx.p2c(lastX), axisy.p2c(bottom));</span>
<a href="#l18.1495"></a><span id="l18.1495" class="difflineminus">-                    ctx.fill();</span>
<a href="#l18.1496"></a><span id="l18.1496" class="difflineminus">-                }</span>
<a href="#l18.1497"></a><span id="l18.1497" class="difflineminus">-            }</span>
<a href="#l18.1498"></a><span id="l18.1498" class="difflineminus">-            </span>
<a href="#l18.1499"></a><span id="l18.1499" class="difflineminus">-            ctx.save();</span>
<a href="#l18.1500"></a><span id="l18.1500" class="difflineminus">-            ctx.translate(plotOffset.left, plotOffset.top);</span>
<a href="#l18.1501"></a><span id="l18.1501" class="difflineminus">-            ctx.lineJoin = &quot;round&quot;;</span>
<a href="#l18.1502"></a><span id="l18.1502" class="difflineminus">-</span>
<a href="#l18.1503"></a><span id="l18.1503" class="difflineminus">-            var lw = series.lines.lineWidth,</span>
<a href="#l18.1504"></a><span id="l18.1504" class="difflineminus">-                sw = series.shadowSize;</span>
<a href="#l18.1505"></a><span id="l18.1505" class="difflineminus">-            // FIXME: consider another form of shadow when filling is turned on</span>
<a href="#l18.1506"></a><span id="l18.1506" class="difflineminus">-            if (lw &gt; 0 &amp;&amp; sw &gt; 0) {</span>
<a href="#l18.1507"></a><span id="l18.1507" class="difflineminus">-                // draw shadow as a thick and thin line with transparency</span>
<a href="#l18.1508"></a><span id="l18.1508" class="difflineminus">-                ctx.lineWidth = sw;</span>
<a href="#l18.1509"></a><span id="l18.1509" class="difflineminus">-                ctx.strokeStyle = &quot;rgba(0,0,0,0.1)&quot;;</span>
<a href="#l18.1510"></a><span id="l18.1510" class="difflineminus">-                // position shadow at angle from the mid of line</span>
<a href="#l18.1511"></a><span id="l18.1511" class="difflineminus">-                var angle = Math.PI/18;</span>
<a href="#l18.1512"></a><span id="l18.1512" class="difflineminus">-                plotLine(series.datapoints, Math.sin(angle) * (lw/2 + sw/2), Math.cos(angle) * (lw/2 + sw/2), series.xaxis, series.yaxis);</span>
<a href="#l18.1513"></a><span id="l18.1513" class="difflineminus">-                ctx.lineWidth = sw/2;</span>
<a href="#l18.1514"></a><span id="l18.1514" class="difflineminus">-                plotLine(series.datapoints, Math.sin(angle) * (lw/2 + sw/4), Math.cos(angle) * (lw/2 + sw/4), series.xaxis, series.yaxis);</span>
<a href="#l18.1515"></a><span id="l18.1515" class="difflineminus">-            }</span>
<a href="#l18.1516"></a><span id="l18.1516" class="difflineminus">-</span>
<a href="#l18.1517"></a><span id="l18.1517" class="difflineminus">-            ctx.lineWidth = lw;</span>
<a href="#l18.1518"></a><span id="l18.1518" class="difflineminus">-            ctx.strokeStyle = series.color;</span>
<a href="#l18.1519"></a><span id="l18.1519" class="difflineminus">-            var fillStyle = getFillStyle(series.lines, series.color, 0, plotHeight);</span>
<a href="#l18.1520"></a><span id="l18.1520" class="difflineminus">-            if (fillStyle) {</span>
<a href="#l18.1521"></a><span id="l18.1521" class="difflineminus">-                ctx.fillStyle = fillStyle;</span>
<a href="#l18.1522"></a><span id="l18.1522" class="difflineminus">-                plotLineArea(series.datapoints, series.xaxis, series.yaxis);</span>
<a href="#l18.1523"></a><span id="l18.1523" class="difflineminus">-            }</span>
<a href="#l18.1524"></a><span id="l18.1524" class="difflineminus">-</span>
<a href="#l18.1525"></a><span id="l18.1525" class="difflineminus">-            if (lw &gt; 0)</span>
<a href="#l18.1526"></a><span id="l18.1526" class="difflineminus">-                plotLine(series.datapoints, 0, 0, series.xaxis, series.yaxis);</span>
<a href="#l18.1527"></a><span id="l18.1527" class="difflineminus">-            ctx.restore();</span>
<a href="#l18.1528"></a><span id="l18.1528" class="difflineminus">-        }</span>
<a href="#l18.1529"></a><span id="l18.1529" class="difflineminus">-</span>
<a href="#l18.1530"></a><span id="l18.1530" class="difflineminus">-        function drawSeriesPoints(series) {</span>
<a href="#l18.1531"></a><span id="l18.1531" class="difflineminus">-            function plotPoints(datapoints, radius, fillStyle, offset, circumference, axisx, axisy) {</span>
<a href="#l18.1532"></a><span id="l18.1532" class="difflineminus">-                var points = datapoints.points, ps = datapoints.pointsize;</span>
<a href="#l18.1533"></a><span id="l18.1533" class="difflineminus">-                </span>
<a href="#l18.1534"></a><span id="l18.1534" class="difflineminus">-                for (var i = 0; i &lt; points.length; i += ps) {</span>
<a href="#l18.1535"></a><span id="l18.1535" class="difflineminus">-                    var x = points[i], y = points[i + 1];</span>
<a href="#l18.1536"></a><span id="l18.1536" class="difflineminus">-                    if (x == null || x &lt; axisx.min || x &gt; axisx.max || y &lt; axisy.min || y &gt; axisy.max)</span>
<a href="#l18.1537"></a><span id="l18.1537" class="difflineminus">-                        continue;</span>
<a href="#l18.1538"></a><span id="l18.1538" class="difflineminus">-                    </span>
<a href="#l18.1539"></a><span id="l18.1539" class="difflineminus">-                    ctx.beginPath();</span>
<a href="#l18.1540"></a><span id="l18.1540" class="difflineminus">-                    ctx.arc(axisx.p2c(x), axisy.p2c(y) + offset, radius, 0, circumference, false);</span>
<a href="#l18.1541"></a><span id="l18.1541" class="difflineminus">-                    if (fillStyle) {</span>
<a href="#l18.1542"></a><span id="l18.1542" class="difflineminus">-                        ctx.fillStyle = fillStyle;</span>
<a href="#l18.1543"></a><span id="l18.1543" class="difflineminus">-                        ctx.fill();</span>
<a href="#l18.1544"></a><span id="l18.1544" class="difflineminus">-                    }</span>
<a href="#l18.1545"></a><span id="l18.1545" class="difflineminus">-                    ctx.stroke();</span>
<a href="#l18.1546"></a><span id="l18.1546" class="difflineminus">-                }</span>
<a href="#l18.1547"></a><span id="l18.1547" class="difflineminus">-            }</span>
<a href="#l18.1548"></a><span id="l18.1548" class="difflineminus">-            </span>
<a href="#l18.1549"></a><span id="l18.1549" class="difflineminus">-            ctx.save();</span>
<a href="#l18.1550"></a><span id="l18.1550" class="difflineminus">-            ctx.translate(plotOffset.left, plotOffset.top);</span>
<a href="#l18.1551"></a><span id="l18.1551" class="difflineminus">-</span>
<a href="#l18.1552"></a><span id="l18.1552" class="difflineminus">-            var lw = series.lines.lineWidth,</span>
<a href="#l18.1553"></a><span id="l18.1553" class="difflineminus">-                sw = series.shadowSize,</span>
<a href="#l18.1554"></a><span id="l18.1554" class="difflineminus">-                radius = series.points.radius;</span>
<a href="#l18.1555"></a><span id="l18.1555" class="difflineminus">-            if (lw &gt; 0 &amp;&amp; sw &gt; 0) {</span>
<a href="#l18.1556"></a><span id="l18.1556" class="difflineminus">-                // draw shadow in two steps</span>
<a href="#l18.1557"></a><span id="l18.1557" class="difflineminus">-                var w = sw / 2;</span>
<a href="#l18.1558"></a><span id="l18.1558" class="difflineminus">-                ctx.lineWidth = w;</span>
<a href="#l18.1559"></a><span id="l18.1559" class="difflineminus">-                ctx.strokeStyle = &quot;rgba(0,0,0,0.1)&quot;;</span>
<a href="#l18.1560"></a><span id="l18.1560" class="difflineminus">-                plotPoints(series.datapoints, radius, null, w + w/2, Math.PI,</span>
<a href="#l18.1561"></a><span id="l18.1561" class="difflineminus">-                           series.xaxis, series.yaxis);</span>
<a href="#l18.1562"></a><span id="l18.1562" class="difflineminus">-</span>
<a href="#l18.1563"></a><span id="l18.1563" class="difflineminus">-                ctx.strokeStyle = &quot;rgba(0,0,0,0.2)&quot;;</span>
<a href="#l18.1564"></a><span id="l18.1564" class="difflineminus">-                plotPoints(series.datapoints, radius, null, w/2, Math.PI,</span>
<a href="#l18.1565"></a><span id="l18.1565" class="difflineminus">-                           series.xaxis, series.yaxis);</span>
<a href="#l18.1566"></a><span id="l18.1566" class="difflineminus">-            }</span>
<a href="#l18.1567"></a><span id="l18.1567" class="difflineminus">-</span>
<a href="#l18.1568"></a><span id="l18.1568" class="difflineminus">-            ctx.lineWidth = lw;</span>
<a href="#l18.1569"></a><span id="l18.1569" class="difflineminus">-            ctx.strokeStyle = series.color;</span>
<a href="#l18.1570"></a><span id="l18.1570" class="difflineminus">-            plotPoints(series.datapoints, radius,</span>
<a href="#l18.1571"></a><span id="l18.1571" class="difflineminus">-                       getFillStyle(series.points, series.color), 0, 2 * Math.PI,</span>
<a href="#l18.1572"></a><span id="l18.1572" class="difflineminus">-                       series.xaxis, series.yaxis);</span>
<a href="#l18.1573"></a><span id="l18.1573" class="difflineminus">-            ctx.restore();</span>
<a href="#l18.1574"></a><span id="l18.1574" class="difflineminus">-        }</span>
<a href="#l18.1575"></a><span id="l18.1575" class="difflineminus">-</span>
<a href="#l18.1576"></a><span id="l18.1576" class="difflineminus">-        function drawBar(x, y, b, barLeft, barRight, offset, fillStyleCallback, axisx, axisy, c, horizontal) {</span>
<a href="#l18.1577"></a><span id="l18.1577" class="difflineminus">-            var left, right, bottom, top,</span>
<a href="#l18.1578"></a><span id="l18.1578" class="difflineminus">-                drawLeft, drawRight, drawTop, drawBottom,</span>
<a href="#l18.1579"></a><span id="l18.1579" class="difflineminus">-                tmp;</span>
<a href="#l18.1580"></a><span id="l18.1580" class="difflineminus">-</span>
<a href="#l18.1581"></a><span id="l18.1581" class="difflineminus">-            if (horizontal) {</span>
<a href="#l18.1582"></a><span id="l18.1582" class="difflineminus">-                drawBottom = drawRight = drawTop = true;</span>
<a href="#l18.1583"></a><span id="l18.1583" class="difflineminus">-                drawLeft = false;</span>
<a href="#l18.1584"></a><span id="l18.1584" class="difflineminus">-                left = b;</span>
<a href="#l18.1585"></a><span id="l18.1585" class="difflineminus">-                right = x;</span>
<a href="#l18.1586"></a><span id="l18.1586" class="difflineminus">-                top = y + barLeft;</span>
<a href="#l18.1587"></a><span id="l18.1587" class="difflineminus">-                bottom = y + barRight;</span>
<a href="#l18.1588"></a><span id="l18.1588" class="difflineminus">-</span>
<a href="#l18.1589"></a><span id="l18.1589" class="difflineminus">-                // account for negative bars</span>
<a href="#l18.1590"></a><span id="l18.1590" class="difflineminus">-                if (right &lt; left) {</span>
<a href="#l18.1591"></a><span id="l18.1591" class="difflineminus">-                    tmp = right;</span>
<a href="#l18.1592"></a><span id="l18.1592" class="difflineminus">-                    right = left;</span>
<a href="#l18.1593"></a><span id="l18.1593" class="difflineminus">-                    left = tmp;</span>
<a href="#l18.1594"></a><span id="l18.1594" class="difflineminus">-                    drawLeft = true;</span>
<a href="#l18.1595"></a><span id="l18.1595" class="difflineminus">-                    drawRight = false;</span>
<a href="#l18.1596"></a><span id="l18.1596" class="difflineminus">-                }</span>
<a href="#l18.1597"></a><span id="l18.1597" class="difflineminus">-            }</span>
<a href="#l18.1598"></a><span id="l18.1598" class="difflineminus">-            else {</span>
<a href="#l18.1599"></a><span id="l18.1599" class="difflineminus">-                drawLeft = drawRight = drawTop = true;</span>
<a href="#l18.1600"></a><span id="l18.1600" class="difflineminus">-                drawBottom = false;</span>
<a href="#l18.1601"></a><span id="l18.1601" class="difflineminus">-                left = x + barLeft;</span>
<a href="#l18.1602"></a><span id="l18.1602" class="difflineminus">-                right = x + barRight;</span>
<a href="#l18.1603"></a><span id="l18.1603" class="difflineminus">-                bottom = b;</span>
<a href="#l18.1604"></a><span id="l18.1604" class="difflineminus">-                top = y;</span>
<a href="#l18.1605"></a><span id="l18.1605" class="difflineminus">-</span>
<a href="#l18.1606"></a><span id="l18.1606" class="difflineminus">-                // account for negative bars</span>
<a href="#l18.1607"></a><span id="l18.1607" class="difflineminus">-                if (top &lt; bottom) {</span>
<a href="#l18.1608"></a><span id="l18.1608" class="difflineminus">-                    tmp = top;</span>
<a href="#l18.1609"></a><span id="l18.1609" class="difflineminus">-                    top = bottom;</span>
<a href="#l18.1610"></a><span id="l18.1610" class="difflineminus">-                    bottom = tmp;</span>
<a href="#l18.1611"></a><span id="l18.1611" class="difflineminus">-                    drawBottom = true;</span>
<a href="#l18.1612"></a><span id="l18.1612" class="difflineminus">-                    drawTop = false;</span>
<a href="#l18.1613"></a><span id="l18.1613" class="difflineminus">-                }</span>
<a href="#l18.1614"></a><span id="l18.1614" class="difflineminus">-            }</span>
<a href="#l18.1615"></a><span id="l18.1615" class="difflineminus">-           </span>
<a href="#l18.1616"></a><span id="l18.1616" class="difflineminus">-            // clip</span>
<a href="#l18.1617"></a><span id="l18.1617" class="difflineminus">-            if (right &lt; axisx.min || left &gt; axisx.max ||</span>
<a href="#l18.1618"></a><span id="l18.1618" class="difflineminus">-                top &lt; axisy.min || bottom &gt; axisy.max)</span>
<a href="#l18.1619"></a><span id="l18.1619" class="difflineminus">-                return;</span>
<a href="#l18.1620"></a><span id="l18.1620" class="difflineminus">-            </span>
<a href="#l18.1621"></a><span id="l18.1621" class="difflineminus">-            if (left &lt; axisx.min) {</span>
<a href="#l18.1622"></a><span id="l18.1622" class="difflineminus">-                left = axisx.min;</span>
<a href="#l18.1623"></a><span id="l18.1623" class="difflineminus">-                drawLeft = false;</span>
<a href="#l18.1624"></a><span id="l18.1624" class="difflineminus">-            }</span>
<a href="#l18.1625"></a><span id="l18.1625" class="difflineminus">-</span>
<a href="#l18.1626"></a><span id="l18.1626" class="difflineminus">-            if (right &gt; axisx.max) {</span>
<a href="#l18.1627"></a><span id="l18.1627" class="difflineminus">-                right = axisx.max;</span>
<a href="#l18.1628"></a><span id="l18.1628" class="difflineminus">-                drawRight = false;</span>
<a href="#l18.1629"></a><span id="l18.1629" class="difflineminus">-            }</span>
<a href="#l18.1630"></a><span id="l18.1630" class="difflineminus">-</span>
<a href="#l18.1631"></a><span id="l18.1631" class="difflineminus">-            if (bottom &lt; axisy.min) {</span>
<a href="#l18.1632"></a><span id="l18.1632" class="difflineminus">-                bottom = axisy.min;</span>
<a href="#l18.1633"></a><span id="l18.1633" class="difflineminus">-                drawBottom = false;</span>
<a href="#l18.1634"></a><span id="l18.1634" class="difflineminus">-            }</span>
<a href="#l18.1635"></a><span id="l18.1635" class="difflineminus">-            </span>
<a href="#l18.1636"></a><span id="l18.1636" class="difflineminus">-            if (top &gt; axisy.max) {</span>
<a href="#l18.1637"></a><span id="l18.1637" class="difflineminus">-                top = axisy.max;</span>
<a href="#l18.1638"></a><span id="l18.1638" class="difflineminus">-                drawTop = false;</span>
<a href="#l18.1639"></a><span id="l18.1639" class="difflineminus">-            }</span>
<a href="#l18.1640"></a><span id="l18.1640" class="difflineminus">-</span>
<a href="#l18.1641"></a><span id="l18.1641" class="difflineminus">-            left = axisx.p2c(left);</span>
<a href="#l18.1642"></a><span id="l18.1642" class="difflineminus">-            bottom = axisy.p2c(bottom);</span>
<a href="#l18.1643"></a><span id="l18.1643" class="difflineminus">-            right = axisx.p2c(right);</span>
<a href="#l18.1644"></a><span id="l18.1644" class="difflineminus">-            top = axisy.p2c(top);</span>
<a href="#l18.1645"></a><span id="l18.1645" class="difflineminus">-            </span>
<a href="#l18.1646"></a><span id="l18.1646" class="difflineminus">-            // fill the bar</span>
<a href="#l18.1647"></a><span id="l18.1647" class="difflineminus">-            if (fillStyleCallback) {</span>
<a href="#l18.1648"></a><span id="l18.1648" class="difflineminus">-                c.beginPath();</span>
<a href="#l18.1649"></a><span id="l18.1649" class="difflineminus">-                c.moveTo(left, bottom);</span>
<a href="#l18.1650"></a><span id="l18.1650" class="difflineminus">-                c.lineTo(left, top);</span>
<a href="#l18.1651"></a><span id="l18.1651" class="difflineminus">-                c.lineTo(right, top);</span>
<a href="#l18.1652"></a><span id="l18.1652" class="difflineminus">-                c.lineTo(right, bottom);</span>
<a href="#l18.1653"></a><span id="l18.1653" class="difflineminus">-                c.fillStyle = fillStyleCallback(bottom, top);</span>
<a href="#l18.1654"></a><span id="l18.1654" class="difflineminus">-                c.fill();</span>
<a href="#l18.1655"></a><span id="l18.1655" class="difflineminus">-            }</span>
<a href="#l18.1656"></a><span id="l18.1656" class="difflineminus">-</span>
<a href="#l18.1657"></a><span id="l18.1657" class="difflineminus">-            // draw outline</span>
<a href="#l18.1658"></a><span id="l18.1658" class="difflineminus">-            if (drawLeft || drawRight || drawTop || drawBottom) {</span>
<a href="#l18.1659"></a><span id="l18.1659" class="difflineminus">-                c.beginPath();</span>
<a href="#l18.1660"></a><span id="l18.1660" class="difflineminus">-</span>
<a href="#l18.1661"></a><span id="l18.1661" class="difflineminus">-                // FIXME: inline moveTo is buggy with excanvas</span>
<a href="#l18.1662"></a><span id="l18.1662" class="difflineminus">-                c.moveTo(left, bottom + offset);</span>
<a href="#l18.1663"></a><span id="l18.1663" class="difflineminus">-                if (drawLeft)</span>
<a href="#l18.1664"></a><span id="l18.1664" class="difflineminus">-                    c.lineTo(left, top + offset);</span>
<a href="#l18.1665"></a><span id="l18.1665" class="difflineminus">-                else</span>
<a href="#l18.1666"></a><span id="l18.1666" class="difflineminus">-                    c.moveTo(left, top + offset);</span>
<a href="#l18.1667"></a><span id="l18.1667" class="difflineminus">-                if (drawTop)</span>
<a href="#l18.1668"></a><span id="l18.1668" class="difflineminus">-                    c.lineTo(right, top + offset);</span>
<a href="#l18.1669"></a><span id="l18.1669" class="difflineminus">-                else</span>
<a href="#l18.1670"></a><span id="l18.1670" class="difflineminus">-                    c.moveTo(right, top + offset);</span>
<a href="#l18.1671"></a><span id="l18.1671" class="difflineminus">-                if (drawRight)</span>
<a href="#l18.1672"></a><span id="l18.1672" class="difflineminus">-                    c.lineTo(right, bottom + offset);</span>
<a href="#l18.1673"></a><span id="l18.1673" class="difflineminus">-                else</span>
<a href="#l18.1674"></a><span id="l18.1674" class="difflineminus">-                    c.moveTo(right, bottom + offset);</span>
<a href="#l18.1675"></a><span id="l18.1675" class="difflineminus">-                if (drawBottom)</span>
<a href="#l18.1676"></a><span id="l18.1676" class="difflineminus">-                    c.lineTo(left, bottom + offset);</span>
<a href="#l18.1677"></a><span id="l18.1677" class="difflineminus">-                else</span>
<a href="#l18.1678"></a><span id="l18.1678" class="difflineminus">-                    c.moveTo(left, bottom + offset);</span>
<a href="#l18.1679"></a><span id="l18.1679" class="difflineminus">-                c.stroke();</span>
<a href="#l18.1680"></a><span id="l18.1680" class="difflineminus">-            }</span>
<a href="#l18.1681"></a><span id="l18.1681" class="difflineminus">-        }</span>
<a href="#l18.1682"></a><span id="l18.1682" class="difflineminus">-        </span>
<a href="#l18.1683"></a><span id="l18.1683" class="difflineminus">-        function drawSeriesBars(series) {</span>
<a href="#l18.1684"></a><span id="l18.1684" class="difflineminus">-            function plotBars(datapoints, barLeft, barRight, offset, fillStyleCallback, axisx, axisy) {</span>
<a href="#l18.1685"></a><span id="l18.1685" class="difflineminus">-                var points = datapoints.points, ps = datapoints.pointsize;</span>
<a href="#l18.1686"></a><span id="l18.1686" class="difflineminus">-                </span>
<a href="#l18.1687"></a><span id="l18.1687" class="difflineminus">-                for (var i = 0; i &lt; points.length; i += ps) {</span>
<a href="#l18.1688"></a><span id="l18.1688" class="difflineminus">-                    if (points[i] == null)</span>
<a href="#l18.1689"></a><span id="l18.1689" class="difflineminus">-                        continue;</span>
<a href="#l18.1690"></a><span id="l18.1690" class="difflineminus">-                    drawBar(points[i], points[i + 1], points[i + 2], barLeft, barRight, offset, fillStyleCallback, axisx, axisy, ctx, series.bars.horizontal);</span>
<a href="#l18.1691"></a><span id="l18.1691" class="difflineminus">-                }</span>
<a href="#l18.1692"></a><span id="l18.1692" class="difflineminus">-            }</span>
<a href="#l18.1693"></a><span id="l18.1693" class="difflineminus">-</span>
<a href="#l18.1694"></a><span id="l18.1694" class="difflineminus">-            ctx.save();</span>
<a href="#l18.1695"></a><span id="l18.1695" class="difflineminus">-            ctx.translate(plotOffset.left, plotOffset.top);</span>
<a href="#l18.1696"></a><span id="l18.1696" class="difflineminus">-</span>
<a href="#l18.1697"></a><span id="l18.1697" class="difflineminus">-            // FIXME: figure out a way to add shadows (for instance along the right edge)</span>
<a href="#l18.1698"></a><span id="l18.1698" class="difflineminus">-            ctx.lineWidth = series.bars.lineWidth;</span>
<a href="#l18.1699"></a><span id="l18.1699" class="difflineminus">-            ctx.strokeStyle = series.color;</span>
<a href="#l18.1700"></a><span id="l18.1700" class="difflineminus">-            var barLeft = series.bars.align == &quot;left&quot; ? 0 : -series.bars.barWidth/2;</span>
<a href="#l18.1701"></a><span id="l18.1701" class="difflineminus">-            var fillStyleCallback = series.bars.fill ? function (bottom, top) { return getFillStyle(series.bars, series.color, bottom, top); } : null;</span>
<a href="#l18.1702"></a><span id="l18.1702" class="difflineminus">-            plotBars(series.datapoints, barLeft, barLeft + series.bars.barWidth, 0, fillStyleCallback, series.xaxis, series.yaxis);</span>
<a href="#l18.1703"></a><span id="l18.1703" class="difflineminus">-            ctx.restore();</span>
<a href="#l18.1704"></a><span id="l18.1704" class="difflineminus">-        }</span>
<a href="#l18.1705"></a><span id="l18.1705" class="difflineminus">-</span>
<a href="#l18.1706"></a><span id="l18.1706" class="difflineminus">-        function getFillStyle(filloptions, seriesColor, bottom, top) {</span>
<a href="#l18.1707"></a><span id="l18.1707" class="difflineminus">-            var fill = filloptions.fill;</span>
<a href="#l18.1708"></a><span id="l18.1708" class="difflineminus">-            if (!fill)</span>
<a href="#l18.1709"></a><span id="l18.1709" class="difflineminus">-                return null;</span>
<a href="#l18.1710"></a><span id="l18.1710" class="difflineminus">-</span>
<a href="#l18.1711"></a><span id="l18.1711" class="difflineminus">-            if (filloptions.fillColor)</span>
<a href="#l18.1712"></a><span id="l18.1712" class="difflineminus">-                return getColorOrGradient(filloptions.fillColor, bottom, top, seriesColor);</span>
<a href="#l18.1713"></a><span id="l18.1713" class="difflineminus">-            </span>
<a href="#l18.1714"></a><span id="l18.1714" class="difflineminus">-            var c = $.color.parse(seriesColor);</span>
<a href="#l18.1715"></a><span id="l18.1715" class="difflineminus">-            c.a = typeof fill == &quot;number&quot; ? fill : 0.4;</span>
<a href="#l18.1716"></a><span id="l18.1716" class="difflineminus">-            c.normalize();</span>
<a href="#l18.1717"></a><span id="l18.1717" class="difflineminus">-            return c.toString();</span>
<a href="#l18.1718"></a><span id="l18.1718" class="difflineminus">-        }</span>
<a href="#l18.1719"></a><span id="l18.1719" class="difflineminus">-        </span>
<a href="#l18.1720"></a><span id="l18.1720" class="difflineminus">-        function insertLegend() {</span>
<a href="#l18.1721"></a><span id="l18.1721" class="difflineminus">-            placeholder.find(&quot;.legend&quot;).remove();</span>
<a href="#l18.1722"></a><span id="l18.1722" class="difflineminus">-</span>
<a href="#l18.1723"></a><span id="l18.1723" class="difflineminus">-            if (!options.legend.show)</span>
<a href="#l18.1724"></a><span id="l18.1724" class="difflineminus">-                return;</span>
<a href="#l18.1725"></a><span id="l18.1725" class="difflineminus">-            </span>
<a href="#l18.1726"></a><span id="l18.1726" class="difflineminus">-            var fragments = [], rowStarted = false,</span>
<a href="#l18.1727"></a><span id="l18.1727" class="difflineminus">-                lf = options.legend.labelFormatter, s, label;</span>
<a href="#l18.1728"></a><span id="l18.1728" class="difflineminus">-            for (i = 0; i &lt; series.length; ++i) {</span>
<a href="#l18.1729"></a><span id="l18.1729" class="difflineminus">-                s = series[i];</span>
<a href="#l18.1730"></a><span id="l18.1730" class="difflineminus">-                label = s.label;</span>
<a href="#l18.1731"></a><span id="l18.1731" class="difflineminus">-                if (!label)</span>
<a href="#l18.1732"></a><span id="l18.1732" class="difflineminus">-                    continue;</span>
<a href="#l18.1733"></a><span id="l18.1733" class="difflineminus">-                </span>
<a href="#l18.1734"></a><span id="l18.1734" class="difflineminus">-                if (i % options.legend.noColumns == 0) {</span>
<a href="#l18.1735"></a><span id="l18.1735" class="difflineminus">-                    if (rowStarted)</span>
<a href="#l18.1736"></a><span id="l18.1736" class="difflineminus">-                        fragments.push('&lt;/tr&gt;');</span>
<a href="#l18.1737"></a><span id="l18.1737" class="difflineminus">-                    fragments.push('&lt;tr&gt;');</span>
<a href="#l18.1738"></a><span id="l18.1738" class="difflineminus">-                    rowStarted = true;</span>
<a href="#l18.1739"></a><span id="l18.1739" class="difflineminus">-                }</span>
<a href="#l18.1740"></a><span id="l18.1740" class="difflineminus">-</span>
<a href="#l18.1741"></a><span id="l18.1741" class="difflineminus">-                if (lf)</span>
<a href="#l18.1742"></a><span id="l18.1742" class="difflineminus">-                    label = lf(label, s);</span>
<a href="#l18.1743"></a><span id="l18.1743" class="difflineminus">-                </span>
<a href="#l18.1744"></a><span id="l18.1744" class="difflineminus">-                fragments.push(</span>
<a href="#l18.1745"></a><span id="l18.1745" class="difflineminus">-                    '&lt;td class=&quot;legendColorBox&quot;&gt;&lt;div style=&quot;border:1px solid ' + options.legend.labelBoxBorderColor + ';padding:1px&quot;&gt;&lt;div style=&quot;width:4px;height:0;border:5px solid ' + s.color + ';overflow:hidden&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/td&gt;' +</span>
<a href="#l18.1746"></a><span id="l18.1746" class="difflineminus">-                    '&lt;td class=&quot;legendLabel&quot;&gt;' + label + '&lt;/td&gt;');</span>
<a href="#l18.1747"></a><span id="l18.1747" class="difflineminus">-            }</span>
<a href="#l18.1748"></a><span id="l18.1748" class="difflineminus">-            if (rowStarted)</span>
<a href="#l18.1749"></a><span id="l18.1749" class="difflineminus">-                fragments.push('&lt;/tr&gt;');</span>
<a href="#l18.1750"></a><span id="l18.1750" class="difflineminus">-            </span>
<a href="#l18.1751"></a><span id="l18.1751" class="difflineminus">-            if (fragments.length == 0)</span>
<a href="#l18.1752"></a><span id="l18.1752" class="difflineminus">-                return;</span>
<a href="#l18.1753"></a><span id="l18.1753" class="difflineminus">-</span>
<a href="#l18.1754"></a><span id="l18.1754" class="difflineminus">-            var table = '&lt;table style=&quot;font-size:smaller;color:' + options.grid.color + '&quot;&gt;' + fragments.join(&quot;&quot;) + '&lt;/table&gt;';</span>
<a href="#l18.1755"></a><span id="l18.1755" class="difflineminus">-            if (options.legend.container != null)</span>
<a href="#l18.1756"></a><span id="l18.1756" class="difflineminus">-                $(options.legend.container).html(table);</span>
<a href="#l18.1757"></a><span id="l18.1757" class="difflineminus">-            else {</span>
<a href="#l18.1758"></a><span id="l18.1758" class="difflineminus">-                var pos = &quot;&quot;,</span>
<a href="#l18.1759"></a><span id="l18.1759" class="difflineminus">-                    p = options.legend.position,</span>
<a href="#l18.1760"></a><span id="l18.1760" class="difflineminus">-                    m = options.legend.margin;</span>
<a href="#l18.1761"></a><span id="l18.1761" class="difflineminus">-                if (m[0] == null)</span>
<a href="#l18.1762"></a><span id="l18.1762" class="difflineminus">-                    m = [m, m];</span>
<a href="#l18.1763"></a><span id="l18.1763" class="difflineminus">-                if (p.charAt(0) == &quot;n&quot;)</span>
<a href="#l18.1764"></a><span id="l18.1764" class="difflineminus">-                    pos += 'top:' + (m[1] + plotOffset.top) + 'px;';</span>
<a href="#l18.1765"></a><span id="l18.1765" class="difflineminus">-                else if (p.charAt(0) == &quot;s&quot;)</span>
<a href="#l18.1766"></a><span id="l18.1766" class="difflineminus">-                    pos += 'bottom:' + (m[1] + plotOffset.bottom) + 'px;';</span>
<a href="#l18.1767"></a><span id="l18.1767" class="difflineminus">-                if (p.charAt(1) == &quot;e&quot;)</span>
<a href="#l18.1768"></a><span id="l18.1768" class="difflineminus">-                    pos += 'right:' + (m[0] + plotOffset.right) + 'px;';</span>
<a href="#l18.1769"></a><span id="l18.1769" class="difflineminus">-                else if (p.charAt(1) == &quot;w&quot;)</span>
<a href="#l18.1770"></a><span id="l18.1770" class="difflineminus">-                    pos += 'left:' + (m[0] + plotOffset.left) + 'px;';</span>
<a href="#l18.1771"></a><span id="l18.1771" class="difflineminus">-                var legend = $('&lt;div class=&quot;legend&quot;&gt;' + table.replace('style=&quot;', 'style=&quot;position:absolute;' + pos +';') + '&lt;/div&gt;').appendTo(placeholder);</span>
<a href="#l18.1772"></a><span id="l18.1772" class="difflineminus">-                if (options.legend.backgroundOpacity != 0.0) {</span>
<a href="#l18.1773"></a><span id="l18.1773" class="difflineminus">-                    // put in the transparent background</span>
<a href="#l18.1774"></a><span id="l18.1774" class="difflineminus">-                    // separately to avoid blended labels and</span>
<a href="#l18.1775"></a><span id="l18.1775" class="difflineminus">-                    // label boxes</span>
<a href="#l18.1776"></a><span id="l18.1776" class="difflineminus">-                    var c = options.legend.backgroundColor;</span>
<a href="#l18.1777"></a><span id="l18.1777" class="difflineminus">-                    if (c == null) {</span>
<a href="#l18.1778"></a><span id="l18.1778" class="difflineminus">-                        c = options.grid.backgroundColor;</span>
<a href="#l18.1779"></a><span id="l18.1779" class="difflineminus">-                        if (c &amp;&amp; typeof c == &quot;string&quot;)</span>
<a href="#l18.1780"></a><span id="l18.1780" class="difflineminus">-                            c = $.color.parse(c);</span>
<a href="#l18.1781"></a><span id="l18.1781" class="difflineminus">-                        else</span>
<a href="#l18.1782"></a><span id="l18.1782" class="difflineminus">-                            c = $.color.extract(legend, 'background-color');</span>
<a href="#l18.1783"></a><span id="l18.1783" class="difflineminus">-                        c.a = 1;</span>
<a href="#l18.1784"></a><span id="l18.1784" class="difflineminus">-                        c = c.toString();</span>
<a href="#l18.1785"></a><span id="l18.1785" class="difflineminus">-                    }</span>
<a href="#l18.1786"></a><span id="l18.1786" class="difflineminus">-                    var div = legend.children();</span>
<a href="#l18.1787"></a><span id="l18.1787" class="difflineminus">-                    $('&lt;div style=&quot;position:absolute;width:' + div.width() + 'px;height:' + div.height() + 'px;' + pos +'background-color:' + c + ';&quot;&gt; &lt;/div&gt;').prependTo(legend).css('opacity', options.legend.backgroundOpacity);</span>
<a href="#l18.1788"></a><span id="l18.1788" class="difflineminus">-                }</span>
<a href="#l18.1789"></a><span id="l18.1789" class="difflineminus">-            }</span>
<a href="#l18.1790"></a><span id="l18.1790" class="difflineminus">-        }</span>
<a href="#l18.1791"></a><span id="l18.1791" class="difflineminus">-</span>
<a href="#l18.1792"></a><span id="l18.1792" class="difflineminus">-</span>
<a href="#l18.1793"></a><span id="l18.1793" class="difflineminus">-        // interactive features</span>
<a href="#l18.1794"></a><span id="l18.1794" class="difflineminus">-        </span>
<a href="#l18.1795"></a><span id="l18.1795" class="difflineminus">-        var highlights = [],</span>
<a href="#l18.1796"></a><span id="l18.1796" class="difflineminus">-            redrawTimeout = null;</span>
<a href="#l18.1797"></a><span id="l18.1797" class="difflineminus">-        </span>
<a href="#l18.1798"></a><span id="l18.1798" class="difflineminus">-        // returns the data item the mouse is over, or null if none is found</span>
<a href="#l18.1799"></a><span id="l18.1799" class="difflineminus">-        function findNearbyItem(mouseX, mouseY, seriesFilter) {</span>
<a href="#l18.1800"></a><span id="l18.1800" class="difflineminus">-            var maxDistance = options.grid.mouseActiveRadius,</span>
<a href="#l18.1801"></a><span id="l18.1801" class="difflineminus">-                smallestDistance = maxDistance * maxDistance + 1,</span>
<a href="#l18.1802"></a><span id="l18.1802" class="difflineminus">-                item = null, foundPoint = false, i, j;</span>
<a href="#l18.1803"></a><span id="l18.1803" class="difflineminus">-</span>
<a href="#l18.1804"></a><span id="l18.1804" class="difflineminus">-            for (i = 0; i &lt; series.length; ++i) {</span>
<a href="#l18.1805"></a><span id="l18.1805" class="difflineminus">-                if (!seriesFilter(series[i]))</span>
<a href="#l18.1806"></a><span id="l18.1806" class="difflineminus">-                    continue;</span>
<a href="#l18.1807"></a><span id="l18.1807" class="difflineminus">-                </span>
<a href="#l18.1808"></a><span id="l18.1808" class="difflineminus">-                var s = series[i],</span>
<a href="#l18.1809"></a><span id="l18.1809" class="difflineminus">-                    axisx = s.xaxis,</span>
<a href="#l18.1810"></a><span id="l18.1810" class="difflineminus">-                    axisy = s.yaxis,</span>
<a href="#l18.1811"></a><span id="l18.1811" class="difflineminus">-                    points = s.datapoints.points,</span>
<a href="#l18.1812"></a><span id="l18.1812" class="difflineminus">-                    ps = s.datapoints.pointsize,</span>
<a href="#l18.1813"></a><span id="l18.1813" class="difflineminus">-                    mx = axisx.c2p(mouseX), // precompute some stuff to make the loop faster</span>
<a href="#l18.1814"></a><span id="l18.1814" class="difflineminus">-                    my = axisy.c2p(mouseY),</span>
<a href="#l18.1815"></a><span id="l18.1815" class="difflineminus">-                    maxx = maxDistance / axisx.scale,</span>
<a href="#l18.1816"></a><span id="l18.1816" class="difflineminus">-                    maxy = maxDistance / axisy.scale;</span>
<a href="#l18.1817"></a><span id="l18.1817" class="difflineminus">-</span>
<a href="#l18.1818"></a><span id="l18.1818" class="difflineminus">-                if (s.lines.show || s.points.show) {</span>
<a href="#l18.1819"></a><span id="l18.1819" class="difflineminus">-                    for (j = 0; j &lt; points.length; j += ps) {</span>
<a href="#l18.1820"></a><span id="l18.1820" class="difflineminus">-                        var x = points[j], y = points[j + 1];</span>
<a href="#l18.1821"></a><span id="l18.1821" class="difflineminus">-                        if (x == null)</span>
<a href="#l18.1822"></a><span id="l18.1822" class="difflineminus">-                            continue;</span>
<a href="#l18.1823"></a><span id="l18.1823" class="difflineminus">-                        </span>
<a href="#l18.1824"></a><span id="l18.1824" class="difflineminus">-                        // For points and lines, the cursor must be within a</span>
<a href="#l18.1825"></a><span id="l18.1825" class="difflineminus">-                        // certain distance to the data point</span>
<a href="#l18.1826"></a><span id="l18.1826" class="difflineminus">-                        if (x - mx &gt; maxx || x - mx &lt; -maxx ||</span>
<a href="#l18.1827"></a><span id="l18.1827" class="difflineminus">-                            y - my &gt; maxy || y - my &lt; -maxy)</span>
<a href="#l18.1828"></a><span id="l18.1828" class="difflineminus">-                            continue;</span>
<a href="#l18.1829"></a><span id="l18.1829" class="difflineminus">-</span>
<a href="#l18.1830"></a><span id="l18.1830" class="difflineminus">-                        // We have to calculate distances in pixels, not in</span>
<a href="#l18.1831"></a><span id="l18.1831" class="difflineminus">-                        // data units, because the scales of the axes may be different</span>
<a href="#l18.1832"></a><span id="l18.1832" class="difflineminus">-                        var dx = Math.abs(axisx.p2c(x) - mouseX),</span>
<a href="#l18.1833"></a><span id="l18.1833" class="difflineminus">-                            dy = Math.abs(axisy.p2c(y) - mouseY),</span>
<a href="#l18.1834"></a><span id="l18.1834" class="difflineminus">-                            dist = dx * dx + dy * dy; // we save the sqrt</span>
<a href="#l18.1835"></a><span id="l18.1835" class="difflineminus">-</span>
<a href="#l18.1836"></a><span id="l18.1836" class="difflineminus">-                        // use &lt;= to ensure last point takes precedence</span>
<a href="#l18.1837"></a><span id="l18.1837" class="difflineminus">-                        // (last generally means on top of)</span>
<a href="#l18.1838"></a><span id="l18.1838" class="difflineminus">-                        if (dist &lt;= smallestDistance) {</span>
<a href="#l18.1839"></a><span id="l18.1839" class="difflineminus">-                            smallestDistance = dist;</span>
<a href="#l18.1840"></a><span id="l18.1840" class="difflineminus">-                            item = [i, j / ps];</span>
<a href="#l18.1841"></a><span id="l18.1841" class="difflineminus">-                        }</span>
<a href="#l18.1842"></a><span id="l18.1842" class="difflineminus">-                    }</span>
<a href="#l18.1843"></a><span id="l18.1843" class="difflineminus">-                }</span>
<a href="#l18.1844"></a><span id="l18.1844" class="difflineminus">-                    </span>
<a href="#l18.1845"></a><span id="l18.1845" class="difflineminus">-                if (s.bars.show &amp;&amp; !item) { // no other point can be nearby</span>
<a href="#l18.1846"></a><span id="l18.1846" class="difflineminus">-                    var barLeft = s.bars.align == &quot;left&quot; ? 0 : -s.bars.barWidth/2,</span>
<a href="#l18.1847"></a><span id="l18.1847" class="difflineminus">-                        barRight = barLeft + s.bars.barWidth;</span>
<a href="#l18.1848"></a><span id="l18.1848" class="difflineminus">-                    </span>
<a href="#l18.1849"></a><span id="l18.1849" class="difflineminus">-                    for (j = 0; j &lt; points.length; j += ps) {</span>
<a href="#l18.1850"></a><span id="l18.1850" class="difflineminus">-                        var x = points[j], y = points[j + 1], b = points[j + 2];</span>
<a href="#l18.1851"></a><span id="l18.1851" class="difflineminus">-                        if (x == null)</span>
<a href="#l18.1852"></a><span id="l18.1852" class="difflineminus">-                            continue;</span>
<a href="#l18.1853"></a><span id="l18.1853" class="difflineminus">-  </span>
<a href="#l18.1854"></a><span id="l18.1854" class="difflineminus">-                        // for a bar graph, the cursor must be inside the bar</span>
<a href="#l18.1855"></a><span id="l18.1855" class="difflineminus">-                        if (series[i].bars.horizontal ? </span>
<a href="#l18.1856"></a><span id="l18.1856" class="difflineminus">-                            (mx &lt;= Math.max(b, x) &amp;&amp; mx &gt;= Math.min(b, x) &amp;&amp; </span>
<a href="#l18.1857"></a><span id="l18.1857" class="difflineminus">-                             my &gt;= y + barLeft &amp;&amp; my &lt;= y + barRight) :</span>
<a href="#l18.1858"></a><span id="l18.1858" class="difflineminus">-                            (mx &gt;= x + barLeft &amp;&amp; mx &lt;= x + barRight &amp;&amp;</span>
<a href="#l18.1859"></a><span id="l18.1859" class="difflineminus">-                             my &gt;= Math.min(b, y) &amp;&amp; my &lt;= Math.max(b, y)))</span>
<a href="#l18.1860"></a><span id="l18.1860" class="difflineminus">-                                item = [i, j / ps];</span>
<a href="#l18.1861"></a><span id="l18.1861" class="difflineminus">-                    }</span>
<a href="#l18.1862"></a><span id="l18.1862" class="difflineminus">-                }</span>
<a href="#l18.1863"></a><span id="l18.1863" class="difflineminus">-            }</span>
<a href="#l18.1864"></a><span id="l18.1864" class="difflineminus">-</span>
<a href="#l18.1865"></a><span id="l18.1865" class="difflineminus">-            if (item) {</span>
<a href="#l18.1866"></a><span id="l18.1866" class="difflineminus">-                i = item[0];</span>
<a href="#l18.1867"></a><span id="l18.1867" class="difflineminus">-                j = item[1];</span>
<a href="#l18.1868"></a><span id="l18.1868" class="difflineminus">-                ps = series[i].datapoints.pointsize;</span>
<a href="#l18.1869"></a><span id="l18.1869" class="difflineminus">-                </span>
<a href="#l18.1870"></a><span id="l18.1870" class="difflineminus">-                return { datapoint: series[i].datapoints.points.slice(j * ps, (j + 1) * ps),</span>
<a href="#l18.1871"></a><span id="l18.1871" class="difflineminus">-                         dataIndex: j,</span>
<a href="#l18.1872"></a><span id="l18.1872" class="difflineminus">-                         series: series[i],</span>
<a href="#l18.1873"></a><span id="l18.1873" class="difflineminus">-                         seriesIndex: i };</span>
<a href="#l18.1874"></a><span id="l18.1874" class="difflineminus">-            }</span>
<a href="#l18.1875"></a><span id="l18.1875" class="difflineminus">-            </span>
<a href="#l18.1876"></a><span id="l18.1876" class="difflineminus">-            return null;</span>
<a href="#l18.1877"></a><span id="l18.1877" class="difflineminus">-        }</span>
<a href="#l18.1878"></a><span id="l18.1878" class="difflineminus">-</span>
<a href="#l18.1879"></a><span id="l18.1879" class="difflineminus">-        function onMouseMove(e) {</span>
<a href="#l18.1880"></a><span id="l18.1880" class="difflineminus">-            if (options.grid.hoverable)</span>
<a href="#l18.1881"></a><span id="l18.1881" class="difflineminus">-                triggerClickHoverEvent(&quot;plothover&quot;, e,</span>
<a href="#l18.1882"></a><span id="l18.1882" class="difflineminus">-                                       function (s) { return s[&quot;hoverable&quot;] != false; });</span>
<a href="#l18.1883"></a><span id="l18.1883" class="difflineminus">-        }</span>
<a href="#l18.1884"></a><span id="l18.1884" class="difflineminus">-        </span>
<a href="#l18.1885"></a><span id="l18.1885" class="difflineminus">-        function onClick(e) {</span>
<a href="#l18.1886"></a><span id="l18.1886" class="difflineminus">-            triggerClickHoverEvent(&quot;plotclick&quot;, e,</span>
<a href="#l18.1887"></a><span id="l18.1887" class="difflineminus">-                                   function (s) { return s[&quot;clickable&quot;] != false; });</span>
<a href="#l18.1888"></a><span id="l18.1888" class="difflineminus">-        }</span>
<a href="#l18.1889"></a><span id="l18.1889" class="difflineminus">-</span>
<a href="#l18.1890"></a><span id="l18.1890" class="difflineminus">-        // trigger click or hover event (they send the same parameters</span>
<a href="#l18.1891"></a><span id="l18.1891" class="difflineminus">-        // so we share their code)</span>
<a href="#l18.1892"></a><span id="l18.1892" class="difflineminus">-        function triggerClickHoverEvent(eventname, event, seriesFilter) {</span>
<a href="#l18.1893"></a><span id="l18.1893" class="difflineminus">-            var offset = eventHolder.offset(),</span>
<a href="#l18.1894"></a><span id="l18.1894" class="difflineminus">-                pos = { pageX: event.pageX, pageY: event.pageY },</span>
<a href="#l18.1895"></a><span id="l18.1895" class="difflineminus">-                canvasX = event.pageX - offset.left - plotOffset.left,</span>
<a href="#l18.1896"></a><span id="l18.1896" class="difflineminus">-                canvasY = event.pageY - offset.top - plotOffset.top;</span>
<a href="#l18.1897"></a><span id="l18.1897" class="difflineminus">-</span>
<a href="#l18.1898"></a><span id="l18.1898" class="difflineminus">-            if (axes.xaxis.used)</span>
<a href="#l18.1899"></a><span id="l18.1899" class="difflineminus">-                pos.x = axes.xaxis.c2p(canvasX);</span>
<a href="#l18.1900"></a><span id="l18.1900" class="difflineminus">-            if (axes.yaxis.used)</span>
<a href="#l18.1901"></a><span id="l18.1901" class="difflineminus">-                pos.y = axes.yaxis.c2p(canvasY);</span>
<a href="#l18.1902"></a><span id="l18.1902" class="difflineminus">-            if (axes.x2axis.used)</span>
<a href="#l18.1903"></a><span id="l18.1903" class="difflineminus">-                pos.x2 = axes.x2axis.c2p(canvasX);</span>
<a href="#l18.1904"></a><span id="l18.1904" class="difflineminus">-            if (axes.y2axis.used)</span>
<a href="#l18.1905"></a><span id="l18.1905" class="difflineminus">-                pos.y2 = axes.y2axis.c2p(canvasY);</span>
<a href="#l18.1906"></a><span id="l18.1906" class="difflineminus">-</span>
<a href="#l18.1907"></a><span id="l18.1907" class="difflineminus">-            var item = findNearbyItem(canvasX, canvasY, seriesFilter);</span>
<a href="#l18.1908"></a><span id="l18.1908" class="difflineminus">-</span>
<a href="#l18.1909"></a><span id="l18.1909" class="difflineminus">-            if (item) {</span>
<a href="#l18.1910"></a><span id="l18.1910" class="difflineminus">-                // fill in mouse pos for any listeners out there</span>
<a href="#l18.1911"></a><span id="l18.1911" class="difflineminus">-                item.pageX = parseInt(item.series.xaxis.p2c(item.datapoint[0]) + offset.left + plotOffset.left);</span>
<a href="#l18.1912"></a><span id="l18.1912" class="difflineminus">-                item.pageY = parseInt(item.series.yaxis.p2c(item.datapoint[1]) + offset.top + plotOffset.top);</span>
<a href="#l18.1913"></a><span id="l18.1913" class="difflineminus">-            }</span>
<a href="#l18.1914"></a><span id="l18.1914" class="difflineminus">-</span>
<a href="#l18.1915"></a><span id="l18.1915" class="difflineminus">-            if (options.grid.autoHighlight) {</span>
<a href="#l18.1916"></a><span id="l18.1916" class="difflineminus">-                // clear auto-highlights</span>
<a href="#l18.1917"></a><span id="l18.1917" class="difflineminus">-                for (var i = 0; i &lt; highlights.length; ++i) {</span>
<a href="#l18.1918"></a><span id="l18.1918" class="difflineminus">-                    var h = highlights[i];</span>
<a href="#l18.1919"></a><span id="l18.1919" class="difflineminus">-                    if (h.auto == eventname &amp;&amp;</span>
<a href="#l18.1920"></a><span id="l18.1920" class="difflineminus">-                        !(item &amp;&amp; h.series == item.series &amp;&amp; h.point == item.datapoint))</span>
<a href="#l18.1921"></a><span id="l18.1921" class="difflineminus">-                        unhighlight(h.series, h.point);</span>
<a href="#l18.1922"></a><span id="l18.1922" class="difflineminus">-                }</span>
<a href="#l18.1923"></a><span id="l18.1923" class="difflineminus">-                </span>
<a href="#l18.1924"></a><span id="l18.1924" class="difflineminus">-                if (item)</span>
<a href="#l18.1925"></a><span id="l18.1925" class="difflineminus">-                    highlight(item.series, item.datapoint, eventname);</span>
<a href="#l18.1926"></a><span id="l18.1926" class="difflineminus">-            }</span>
<a href="#l18.1927"></a><span id="l18.1927" class="difflineminus">-            </span>
<a href="#l18.1928"></a><span id="l18.1928" class="difflineminus">-            placeholder.trigger(eventname, [ pos, item ]);</span>
<a href="#l18.1929"></a><span id="l18.1929" class="difflineminus">-        }</span>
<a href="#l18.1930"></a><span id="l18.1930" class="difflineminus">-</span>
<a href="#l18.1931"></a><span id="l18.1931" class="difflineminus">-        function triggerRedrawOverlay() {</span>
<a href="#l18.1932"></a><span id="l18.1932" class="difflineminus">-            if (!redrawTimeout)</span>
<a href="#l18.1933"></a><span id="l18.1933" class="difflineminus">-                redrawTimeout = setTimeout(drawOverlay, 30);</span>
<a href="#l18.1934"></a><span id="l18.1934" class="difflineminus">-        }</span>
<a href="#l18.1935"></a><span id="l18.1935" class="difflineminus">-</span>
<a href="#l18.1936"></a><span id="l18.1936" class="difflineminus">-        function drawOverlay() {</span>
<a href="#l18.1937"></a><span id="l18.1937" class="difflineminus">-            redrawTimeout = null;</span>
<a href="#l18.1938"></a><span id="l18.1938" class="difflineminus">-</span>
<a href="#l18.1939"></a><span id="l18.1939" class="difflineminus">-            // draw highlights</span>
<a href="#l18.1940"></a><span id="l18.1940" class="difflineminus">-            octx.save();</span>
<a href="#l18.1941"></a><span id="l18.1941" class="difflineminus">-            octx.clearRect(0, 0, canvasWidth, canvasHeight);</span>
<a href="#l18.1942"></a><span id="l18.1942" class="difflineminus">-            octx.translate(plotOffset.left, plotOffset.top);</span>
<a href="#l18.1943"></a><span id="l18.1943" class="difflineminus">-            </span>
<a href="#l18.1944"></a><span id="l18.1944" class="difflineminus">-            var i, hi;</span>
<a href="#l18.1945"></a><span id="l18.1945" class="difflineminus">-            for (i = 0; i &lt; highlights.length; ++i) {</span>
<a href="#l18.1946"></a><span id="l18.1946" class="difflineminus">-                hi = highlights[i];</span>
<a href="#l18.1947"></a><span id="l18.1947" class="difflineminus">-</span>
<a href="#l18.1948"></a><span id="l18.1948" class="difflineminus">-                if (hi.series.bars.show)</span>
<a href="#l18.1949"></a><span id="l18.1949" class="difflineminus">-                    drawBarHighlight(hi.series, hi.point);</span>
<a href="#l18.1950"></a><span id="l18.1950" class="difflineminus">-                else</span>
<a href="#l18.1951"></a><span id="l18.1951" class="difflineminus">-                    drawPointHighlight(hi.series, hi.point);</span>
<a href="#l18.1952"></a><span id="l18.1952" class="difflineminus">-            }</span>
<a href="#l18.1953"></a><span id="l18.1953" class="difflineminus">-            octx.restore();</span>
<a href="#l18.1954"></a><span id="l18.1954" class="difflineminus">-            </span>
<a href="#l18.1955"></a><span id="l18.1955" class="difflineminus">-            executeHooks(hooks.drawOverlay, [octx]);</span>
<a href="#l18.1956"></a><span id="l18.1956" class="difflineminus">-        }</span>
<a href="#l18.1957"></a><span id="l18.1957" class="difflineminus">-        </span>
<a href="#l18.1958"></a><span id="l18.1958" class="difflineminus">-        function highlight(s, point, auto) {</span>
<a href="#l18.1959"></a><span id="l18.1959" class="difflineminus">-            if (typeof s == &quot;number&quot;)</span>
<a href="#l18.1960"></a><span id="l18.1960" class="difflineminus">-                s = series[s];</span>
<a href="#l18.1961"></a><span id="l18.1961" class="difflineminus">-</span>
<a href="#l18.1962"></a><span id="l18.1962" class="difflineminus">-            if (typeof point == &quot;number&quot;)</span>
<a href="#l18.1963"></a><span id="l18.1963" class="difflineminus">-                point = s.data[point];</span>
<a href="#l18.1964"></a><span id="l18.1964" class="difflineminus">-</span>
<a href="#l18.1965"></a><span id="l18.1965" class="difflineminus">-            var i = indexOfHighlight(s, point);</span>
<a href="#l18.1966"></a><span id="l18.1966" class="difflineminus">-            if (i == -1) {</span>
<a href="#l18.1967"></a><span id="l18.1967" class="difflineminus">-                highlights.push({ series: s, point: point, auto: auto });</span>
<a href="#l18.1968"></a><span id="l18.1968" class="difflineminus">-</span>
<a href="#l18.1969"></a><span id="l18.1969" class="difflineminus">-                triggerRedrawOverlay();</span>
<a href="#l18.1970"></a><span id="l18.1970" class="difflineminus">-            }</span>
<a href="#l18.1971"></a><span id="l18.1971" class="difflineminus">-            else if (!auto)</span>
<a href="#l18.1972"></a><span id="l18.1972" class="difflineminus">-                highlights[i].auto = false;</span>
<a href="#l18.1973"></a><span id="l18.1973" class="difflineminus">-        }</span>
<a href="#l18.1974"></a><span id="l18.1974" class="difflineminus">-            </span>
<a href="#l18.1975"></a><span id="l18.1975" class="difflineminus">-        function unhighlight(s, point) {</span>
<a href="#l18.1976"></a><span id="l18.1976" class="difflineminus">-            if (s == null &amp;&amp; point == null) {</span>
<a href="#l18.1977"></a><span id="l18.1977" class="difflineminus">-                highlights = [];</span>
<a href="#l18.1978"></a><span id="l18.1978" class="difflineminus">-                triggerRedrawOverlay();</span>
<a href="#l18.1979"></a><span id="l18.1979" class="difflineminus">-            }</span>
<a href="#l18.1980"></a><span id="l18.1980" class="difflineminus">-            </span>
<a href="#l18.1981"></a><span id="l18.1981" class="difflineminus">-            if (typeof s == &quot;number&quot;)</span>
<a href="#l18.1982"></a><span id="l18.1982" class="difflineminus">-                s = series[s];</span>
<a href="#l18.1983"></a><span id="l18.1983" class="difflineminus">-</span>
<a href="#l18.1984"></a><span id="l18.1984" class="difflineminus">-            if (typeof point == &quot;number&quot;)</span>
<a href="#l18.1985"></a><span id="l18.1985" class="difflineminus">-                point = s.data[point];</span>
<a href="#l18.1986"></a><span id="l18.1986" class="difflineminus">-</span>
<a href="#l18.1987"></a><span id="l18.1987" class="difflineminus">-            var i = indexOfHighlight(s, point);</span>
<a href="#l18.1988"></a><span id="l18.1988" class="difflineminus">-            if (i != -1) {</span>
<a href="#l18.1989"></a><span id="l18.1989" class="difflineminus">-                highlights.splice(i, 1);</span>
<a href="#l18.1990"></a><span id="l18.1990" class="difflineminus">-</span>
<a href="#l18.1991"></a><span id="l18.1991" class="difflineminus">-                triggerRedrawOverlay();</span>
<a href="#l18.1992"></a><span id="l18.1992" class="difflineminus">-            }</span>
<a href="#l18.1993"></a><span id="l18.1993" class="difflineminus">-        }</span>
<a href="#l18.1994"></a><span id="l18.1994" class="difflineminus">-        </span>
<a href="#l18.1995"></a><span id="l18.1995" class="difflineminus">-        function indexOfHighlight(s, p) {</span>
<a href="#l18.1996"></a><span id="l18.1996" class="difflineminus">-            for (var i = 0; i &lt; highlights.length; ++i) {</span>
<a href="#l18.1997"></a><span id="l18.1997" class="difflineminus">-                var h = highlights[i];</span>
<a href="#l18.1998"></a><span id="l18.1998" class="difflineminus">-                if (h.series == s &amp;&amp; h.point[0] == p[0]</span>
<a href="#l18.1999"></a><span id="l18.1999" class="difflineminus">-                    &amp;&amp; h.point[1] == p[1])</span>
<a href="#l18.2000"></a><span id="l18.2000" class="difflineminus">-                    return i;</span>
<a href="#l18.2001"></a><span id="l18.2001" class="difflineminus">-            }</span>
<a href="#l18.2002"></a><span id="l18.2002" class="difflineminus">-            return -1;</span>
<a href="#l18.2003"></a><span id="l18.2003" class="difflineminus">-        }</span>
<a href="#l18.2004"></a><span id="l18.2004" class="difflineminus">-        </span>
<a href="#l18.2005"></a><span id="l18.2005" class="difflineminus">-        function drawPointHighlight(series, point) {</span>
<a href="#l18.2006"></a><span id="l18.2006" class="difflineminus">-            var x = point[0], y = point[1],</span>
<a href="#l18.2007"></a><span id="l18.2007" class="difflineminus">-                axisx = series.xaxis, axisy = series.yaxis;</span>
<a href="#l18.2008"></a><span id="l18.2008" class="difflineminus">-            </span>
<a href="#l18.2009"></a><span id="l18.2009" class="difflineminus">-            if (x &lt; axisx.min || x &gt; axisx.max || y &lt; axisy.min || y &gt; axisy.max)</span>
<a href="#l18.2010"></a><span id="l18.2010" class="difflineminus">-                return;</span>
<a href="#l18.2011"></a><span id="l18.2011" class="difflineminus">-            </span>
<a href="#l18.2012"></a><span id="l18.2012" class="difflineminus">-            var pointRadius = series.points.radius + series.points.lineWidth / 2;</span>
<a href="#l18.2013"></a><span id="l18.2013" class="difflineminus">-            octx.lineWidth = pointRadius;</span>
<a href="#l18.2014"></a><span id="l18.2014" class="difflineminus">-            octx.strokeStyle = $.color.parse(series.color).scale('a', 0.5).toString();</span>
<a href="#l18.2015"></a><span id="l18.2015" class="difflineminus">-            var radius = 1.5 * pointRadius;</span>
<a href="#l18.2016"></a><span id="l18.2016" class="difflineminus">-            octx.beginPath();</span>
<a href="#l18.2017"></a><span id="l18.2017" class="difflineminus">-            octx.arc(axisx.p2c(x), axisy.p2c(y), radius, 0, 2 * Math.PI, false);</span>
<a href="#l18.2018"></a><span id="l18.2018" class="difflineminus">-            octx.stroke();</span>
<a href="#l18.2019"></a><span id="l18.2019" class="difflineminus">-        }</span>
<a href="#l18.2020"></a><span id="l18.2020" class="difflineminus">-</span>
<a href="#l18.2021"></a><span id="l18.2021" class="difflineminus">-        function drawBarHighlight(series, point) {</span>
<a href="#l18.2022"></a><span id="l18.2022" class="difflineminus">-            octx.lineWidth = series.bars.lineWidth;</span>
<a href="#l18.2023"></a><span id="l18.2023" class="difflineminus">-            octx.strokeStyle = $.color.parse(series.color).scale('a', 0.5).toString();</span>
<a href="#l18.2024"></a><span id="l18.2024" class="difflineminus">-            var fillStyle = $.color.parse(series.color).scale('a', 0.5).toString();</span>
<a href="#l18.2025"></a><span id="l18.2025" class="difflineminus">-            var barLeft = series.bars.align == &quot;left&quot; ? 0 : -series.bars.barWidth/2;</span>
<a href="#l18.2026"></a><span id="l18.2026" class="difflineminus">-            drawBar(point[0], point[1], point[2] || 0, barLeft, barLeft + series.bars.barWidth,</span>
<a href="#l18.2027"></a><span id="l18.2027" class="difflineminus">-                    0, function () { return fillStyle; }, series.xaxis, series.yaxis, octx, series.bars.horizontal);</span>
<a href="#l18.2028"></a><span id="l18.2028" class="difflineminus">-        }</span>
<a href="#l18.2029"></a><span id="l18.2029" class="difflineminus">-</span>
<a href="#l18.2030"></a><span id="l18.2030" class="difflineminus">-        function getColorOrGradient(spec, bottom, top, defaultColor) {</span>
<a href="#l18.2031"></a><span id="l18.2031" class="difflineminus">-            if (typeof spec == &quot;string&quot;)</span>
<a href="#l18.2032"></a><span id="l18.2032" class="difflineminus">-                return spec;</span>
<a href="#l18.2033"></a><span id="l18.2033" class="difflineminus">-            else {</span>
<a href="#l18.2034"></a><span id="l18.2034" class="difflineminus">-                // assume this is a gradient spec; IE currently only</span>
<a href="#l18.2035"></a><span id="l18.2035" class="difflineminus">-                // supports a simple vertical gradient properly, so that's</span>
<a href="#l18.2036"></a><span id="l18.2036" class="difflineminus">-                // what we support too</span>
<a href="#l18.2037"></a><span id="l18.2037" class="difflineminus">-                var gradient = ctx.createLinearGradient(0, top, 0, bottom);</span>
<a href="#l18.2038"></a><span id="l18.2038" class="difflineminus">-                </span>
<a href="#l18.2039"></a><span id="l18.2039" class="difflineminus">-                for (var i = 0, l = spec.colors.length; i &lt; l; ++i) {</span>
<a href="#l18.2040"></a><span id="l18.2040" class="difflineminus">-                    var c = spec.colors[i];</span>
<a href="#l18.2041"></a><span id="l18.2041" class="difflineminus">-                    if (typeof c != &quot;string&quot;) {</span>
<a href="#l18.2042"></a><span id="l18.2042" class="difflineminus">-                        c = $.color.parse(defaultColor).scale('rgb', c.brightness);</span>
<a href="#l18.2043"></a><span id="l18.2043" class="difflineminus">-                        c.a *= c.opacity;</span>
<a href="#l18.2044"></a><span id="l18.2044" class="difflineminus">-                        c = c.toString();</span>
<a href="#l18.2045"></a><span id="l18.2045" class="difflineminus">-                    }</span>
<a href="#l18.2046"></a><span id="l18.2046" class="difflineminus">-                    gradient.addColorStop(i / (l - 1), c);</span>
<a href="#l18.2047"></a><span id="l18.2047" class="difflineminus">-                }</span>
<a href="#l18.2048"></a><span id="l18.2048" class="difflineminus">-                </span>
<a href="#l18.2049"></a><span id="l18.2049" class="difflineminus">-                return gradient;</span>
<a href="#l18.2050"></a><span id="l18.2050" class="difflineminus">-            }</span>
<a href="#l18.2051"></a><span id="l18.2051" class="difflineminus">-        }</span>
<a href="#l18.2052"></a><span id="l18.2052" class="difflineminus">-    }</span>
<a href="#l18.2053"></a><span id="l18.2053" class="difflineminus">-</span>
<a href="#l18.2054"></a><span id="l18.2054" class="difflineminus">-    $.plot = function(placeholder, data, options) {</span>
<a href="#l18.2055"></a><span id="l18.2055" class="difflineminus">-        var plot = new Plot($(placeholder), data, options, $.plot.plugins);</span>
<a href="#l18.2056"></a><span id="l18.2056" class="difflineminus">-        /*var t0 = new Date();</span>
<a href="#l18.2057"></a><span id="l18.2057" class="difflineminus">-        var t1 = new Date();</span>
<a href="#l18.2058"></a><span id="l18.2058" class="difflineminus">-        var tstr = &quot;time used (msecs): &quot; + (t1.getTime() - t0.getTime())</span>
<a href="#l18.2059"></a><span id="l18.2059" class="difflineminus">-        if (window.console)</span>
<a href="#l18.2060"></a><span id="l18.2060" class="difflineminus">-            console.log(tstr);</span>
<a href="#l18.2061"></a><span id="l18.2061" class="difflineminus">-        else</span>
<a href="#l18.2062"></a><span id="l18.2062" class="difflineminus">-            alert(tstr);*/</span>
<a href="#l18.2063"></a><span id="l18.2063" class="difflineminus">-        return plot;</span>
<a href="#l18.2064"></a><span id="l18.2064" class="difflineminus">-    };</span>
<a href="#l18.2065"></a><span id="l18.2065" class="difflineminus">-</span>
<a href="#l18.2066"></a><span id="l18.2066" class="difflineminus">-    $.plot.plugins = [];</span>
<a href="#l18.2067"></a><span id="l18.2067" class="difflineminus">-</span>
<a href="#l18.2068"></a><span id="l18.2068" class="difflineminus">-    // returns a string with the date d formatted according to fmt</span>
<a href="#l18.2069"></a><span id="l18.2069" class="difflineminus">-    $.plot.formatDate = function(d, fmt, monthNames) {</span>
<a href="#l18.2070"></a><span id="l18.2070" class="difflineminus">-        var leftPad = function(n) {</span>
<a href="#l18.2071"></a><span id="l18.2071" class="difflineminus">-            n = &quot;&quot; + n;</span>
<a href="#l18.2072"></a><span id="l18.2072" class="difflineminus">-            return n.length == 1 ? &quot;0&quot; + n : n;</span>
<a href="#l18.2073"></a><span id="l18.2073" class="difflineminus">-        };</span>
<a href="#l18.2074"></a><span id="l18.2074" class="difflineminus">-        </span>
<a href="#l18.2075"></a><span id="l18.2075" class="difflineminus">-        var r = [];</span>
<a href="#l18.2076"></a><span id="l18.2076" class="difflineminus">-        var escape = false;</span>
<a href="#l18.2077"></a><span id="l18.2077" class="difflineminus">-        var hours = d.getUTCHours();</span>
<a href="#l18.2078"></a><span id="l18.2078" class="difflineminus">-        var isAM = hours &lt; 12;</span>
<a href="#l18.2079"></a><span id="l18.2079" class="difflineminus">-        if (monthNames == null)</span>
<a href="#l18.2080"></a><span id="l18.2080" class="difflineminus">-            monthNames = [&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;, &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;];</span>
<a href="#l18.2081"></a><span id="l18.2081" class="difflineminus">-</span>
<a href="#l18.2082"></a><span id="l18.2082" class="difflineminus">-        if (fmt.search(/%p|%P/) != -1) {</span>
<a href="#l18.2083"></a><span id="l18.2083" class="difflineminus">-            if (hours &gt; 12) {</span>
<a href="#l18.2084"></a><span id="l18.2084" class="difflineminus">-                hours = hours - 12;</span>
<a href="#l18.2085"></a><span id="l18.2085" class="difflineminus">-            } else if (hours == 0) {</span>
<a href="#l18.2086"></a><span id="l18.2086" class="difflineminus">-                hours = 12;</span>
<a href="#l18.2087"></a><span id="l18.2087" class="difflineminus">-            }</span>
<a href="#l18.2088"></a><span id="l18.2088" class="difflineminus">-        }</span>
<a href="#l18.2089"></a><span id="l18.2089" class="difflineminus">-        for (var i = 0; i &lt; fmt.length; ++i) {</span>
<a href="#l18.2090"></a><span id="l18.2090" class="difflineminus">-            var c = fmt.charAt(i);</span>
<a href="#l18.2091"></a><span id="l18.2091" class="difflineminus">-            </span>
<a href="#l18.2092"></a><span id="l18.2092" class="difflineminus">-            if (escape) {</span>
<a href="#l18.2093"></a><span id="l18.2093" class="difflineminus">-                switch (c) {</span>
<a href="#l18.2094"></a><span id="l18.2094" class="difflineminus">-                case 'h': c = &quot;&quot; + hours; break;</span>
<a href="#l18.2095"></a><span id="l18.2095" class="difflineminus">-                case 'H': c = leftPad(hours); break;</span>
<a href="#l18.2096"></a><span id="l18.2096" class="difflineminus">-                case 'M': c = leftPad(d.getUTCMinutes()); break;</span>
<a href="#l18.2097"></a><span id="l18.2097" class="difflineminus">-                case 'S': c = leftPad(d.getUTCSeconds()); break;</span>
<a href="#l18.2098"></a><span id="l18.2098" class="difflineminus">-                case 'd': c = &quot;&quot; + d.getUTCDate(); break;</span>
<a href="#l18.2099"></a><span id="l18.2099" class="difflineminus">-                case 'm': c = &quot;&quot; + (d.getUTCMonth() + 1); break;</span>
<a href="#l18.2100"></a><span id="l18.2100" class="difflineminus">-                case 'y': c = &quot;&quot; + d.getUTCFullYear(); break;</span>
<a href="#l18.2101"></a><span id="l18.2101" class="difflineminus">-                case 'b': c = &quot;&quot; + monthNames[d.getUTCMonth()]; break;</span>
<a href="#l18.2102"></a><span id="l18.2102" class="difflineminus">-                case 'p': c = (isAM) ? (&quot;&quot; + &quot;am&quot;) : (&quot;&quot; + &quot;pm&quot;); break;</span>
<a href="#l18.2103"></a><span id="l18.2103" class="difflineminus">-                case 'P': c = (isAM) ? (&quot;&quot; + &quot;AM&quot;) : (&quot;&quot; + &quot;PM&quot;); break;</span>
<a href="#l18.2104"></a><span id="l18.2104" class="difflineminus">-                }</span>
<a href="#l18.2105"></a><span id="l18.2105" class="difflineminus">-                r.push(c);</span>
<a href="#l18.2106"></a><span id="l18.2106" class="difflineminus">-                escape = false;</span>
<a href="#l18.2107"></a><span id="l18.2107" class="difflineminus">-            }</span>
<a href="#l18.2108"></a><span id="l18.2108" class="difflineminus">-            else {</span>
<a href="#l18.2109"></a><span id="l18.2109" class="difflineminus">-                if (c == &quot;%&quot;)</span>
<a href="#l18.2110"></a><span id="l18.2110" class="difflineminus">-                    escape = true;</span>
<a href="#l18.2111"></a><span id="l18.2111" class="difflineminus">-                else</span>
<a href="#l18.2112"></a><span id="l18.2112" class="difflineminus">-                    r.push(c);</span>
<a href="#l18.2113"></a><span id="l18.2113" class="difflineminus">-            }</span>
<a href="#l18.2114"></a><span id="l18.2114" class="difflineminus">-        }</span>
<a href="#l18.2115"></a><span id="l18.2115" class="difflineminus">-        return r.join(&quot;&quot;);</span>
<a href="#l18.2116"></a><span id="l18.2116" class="difflineminus">-    };</span>
<a href="#l18.2117"></a><span id="l18.2117" class="difflineminus">-    </span>
<a href="#l18.2118"></a><span id="l18.2118" class="difflineminus">-    // round to nearby lower multiple of base</span>
<a href="#l18.2119"></a><span id="l18.2119" class="difflineminus">-    function floorInBase(n, base) {</span>
<a href="#l18.2120"></a><span id="l18.2120" class="difflineminus">-        return base * Math.floor(n / base);</span>
<a href="#l18.2121"></a><span id="l18.2121" class="difflineminus">-    }</span>
<a href="#l18.2122"></a><span id="l18.2122" class="difflineminus">-    </span>
<a href="#l18.2123"></a><span id="l18.2123" class="difflineminus">-})(jQuery);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1">deleted file mode 100644</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.flot.navigate.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineplus">+++ /dev/null</span>
<a href="#l19.4"></a><span id="l19.4" class="difflineat">@@ -1,272 +0,0 @@</span>
<a href="#l19.5"></a><span id="l19.5" class="difflineminus">-/*</span>
<a href="#l19.6"></a><span id="l19.6" class="difflineminus">-Flot plugin for adding panning and zooming capabilities to a plot.</span>
<a href="#l19.7"></a><span id="l19.7" class="difflineminus">-</span>
<a href="#l19.8"></a><span id="l19.8" class="difflineminus">-The default behaviour is double click and scrollwheel up/down to zoom</span>
<a href="#l19.9"></a><span id="l19.9" class="difflineminus">-in, drag to pan. The plugin defines plot.zoom({ center }),</span>
<a href="#l19.10"></a><span id="l19.10" class="difflineminus">-plot.zoomOut() and plot.pan(offset) so you easily can add custom</span>
<a href="#l19.11"></a><span id="l19.11" class="difflineminus">-controls. It also fires a &quot;plotpan&quot; and &quot;plotzoom&quot; event when</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-something happens, useful for synchronizing plots.</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineminus">-</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineminus">-Example usage:</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineminus">-</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineminus">-  plot = $.plot(...);</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineminus">-  </span>
<a href="#l19.18"></a><span id="l19.18" class="difflineminus">-  // zoom default amount in on the pixel (100, 200) </span>
<a href="#l19.19"></a><span id="l19.19" class="difflineminus">-  plot.zoom({ center: { left: 10, top: 20 } });</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineminus">-</span>
<a href="#l19.21"></a><span id="l19.21" class="difflineminus">-  // zoom out again</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineminus">-  plot.zoomOut({ center: { left: 10, top: 20 } });</span>
<a href="#l19.23"></a><span id="l19.23" class="difflineminus">-</span>
<a href="#l19.24"></a><span id="l19.24" class="difflineminus">-  // pan 100 pixels to the left and 20 down</span>
<a href="#l19.25"></a><span id="l19.25" class="difflineminus">-  plot.pan({ left: -100, top: 20 })</span>
<a href="#l19.26"></a><span id="l19.26" class="difflineminus">-</span>
<a href="#l19.27"></a><span id="l19.27" class="difflineminus">-</span>
<a href="#l19.28"></a><span id="l19.28" class="difflineminus">-Options:</span>
<a href="#l19.29"></a><span id="l19.29" class="difflineminus">-</span>
<a href="#l19.30"></a><span id="l19.30" class="difflineminus">-  zoom: {</span>
<a href="#l19.31"></a><span id="l19.31" class="difflineminus">-    interactive: false</span>
<a href="#l19.32"></a><span id="l19.32" class="difflineminus">-    trigger: &quot;dblclick&quot; // or &quot;click&quot; for single click</span>
<a href="#l19.33"></a><span id="l19.33" class="difflineminus">-    amount: 1.5         // 2 = 200% (zoom in), 0.5 = 50% (zoom out)</span>
<a href="#l19.34"></a><span id="l19.34" class="difflineminus">-  }</span>
<a href="#l19.35"></a><span id="l19.35" class="difflineminus">-  </span>
<a href="#l19.36"></a><span id="l19.36" class="difflineminus">-  pan: {</span>
<a href="#l19.37"></a><span id="l19.37" class="difflineminus">-    interactive: false</span>
<a href="#l19.38"></a><span id="l19.38" class="difflineminus">-  }</span>
<a href="#l19.39"></a><span id="l19.39" class="difflineminus">-</span>
<a href="#l19.40"></a><span id="l19.40" class="difflineminus">-  xaxis, yaxis, x2axis, y2axis: {</span>
<a href="#l19.41"></a><span id="l19.41" class="difflineminus">-    zoomRange: null  // or [number, number] (min range, max range)</span>
<a href="#l19.42"></a><span id="l19.42" class="difflineminus">-    panRange: null   // or [number, number] (min, max)</span>
<a href="#l19.43"></a><span id="l19.43" class="difflineminus">-  }</span>
<a href="#l19.44"></a><span id="l19.44" class="difflineminus">-  </span>
<a href="#l19.45"></a><span id="l19.45" class="difflineminus">-&quot;interactive&quot; enables the built-in drag/click behaviour. &quot;amount&quot; is</span>
<a href="#l19.46"></a><span id="l19.46" class="difflineminus">-the amount to zoom the viewport relative to the current range, so 1 is</span>
<a href="#l19.47"></a><span id="l19.47" class="difflineminus">-100% (i.e. no change), 1.5 is 150% (zoom in), 0.7 is 70% (zoom out).</span>
<a href="#l19.48"></a><span id="l19.48" class="difflineminus">-</span>
<a href="#l19.49"></a><span id="l19.49" class="difflineminus">-&quot;zoomRange&quot; is the interval in which zooming can happen, e.g. with</span>
<a href="#l19.50"></a><span id="l19.50" class="difflineminus">-zoomRange: [1, 100] the zoom will never scale the axis so that the</span>
<a href="#l19.51"></a><span id="l19.51" class="difflineminus">-difference between min and max is smaller than 1 or larger than 100.</span>
<a href="#l19.52"></a><span id="l19.52" class="difflineminus">-You can set either of them to null to ignore.</span>
<a href="#l19.53"></a><span id="l19.53" class="difflineminus">-</span>
<a href="#l19.54"></a><span id="l19.54" class="difflineminus">-&quot;panRange&quot; confines the panning to stay within a range, e.g. with</span>
<a href="#l19.55"></a><span id="l19.55" class="difflineminus">-panRange: [-10, 20] panning stops at -10 in one end and at 20 in the</span>
<a href="#l19.56"></a><span id="l19.56" class="difflineminus">-other. Either can be null.</span>
<a href="#l19.57"></a><span id="l19.57" class="difflineminus">-*/</span>
<a href="#l19.58"></a><span id="l19.58" class="difflineminus">-</span>
<a href="#l19.59"></a><span id="l19.59" class="difflineminus">-</span>
<a href="#l19.60"></a><span id="l19.60" class="difflineminus">-// First two dependencies, jquery.event.drag.js and</span>
<a href="#l19.61"></a><span id="l19.61" class="difflineminus">-// jquery.mousewheel.js, we put them inline here to save people the</span>
<a href="#l19.62"></a><span id="l19.62" class="difflineminus">-// effort of downloading them.</span>
<a href="#l19.63"></a><span id="l19.63" class="difflineminus">-</span>
<a href="#l19.64"></a><span id="l19.64" class="difflineminus">-/*</span>
<a href="#l19.65"></a><span id="l19.65" class="difflineminus">-jquery.event.drag.js ~ v1.5 ~ Copyright (c) 2008, Three Dub Media (http://threedubmedia.com)  </span>
<a href="#l19.66"></a><span id="l19.66" class="difflineminus">-Licensed under the MIT License ~ http://threedubmedia.googlecode.com/files/MIT-LICENSE.txt</span>
<a href="#l19.67"></a><span id="l19.67" class="difflineminus">-*/</span>
<a href="#l19.68"></a><span id="l19.68" class="difflineminus">-(function(E){E.fn.drag=function(L,K,J){if(K){this.bind(&quot;dragstart&quot;,L)}if(J){this.bind(&quot;dragend&quot;,J)}return !L?this.trigger(&quot;drag&quot;):this.bind(&quot;drag&quot;,K?K:L)};var A=E.event,B=A.special,F=B.drag={not:&quot;:input&quot;,distance:0,which:1,dragging:false,setup:function(J){J=E.extend({distance:F.distance,which:F.which,not:F.not},J||{});J.distance=I(J.distance);A.add(this,&quot;mousedown&quot;,H,J);if(this.attachEvent){this.attachEvent(&quot;ondragstart&quot;,D)}},teardown:function(){A.remove(this,&quot;mousedown&quot;,H);if(this===F.dragging){F.dragging=F.proxy=false}G(this,true);if(this.detachEvent){this.detachEvent(&quot;ondragstart&quot;,D)}}};B.dragstart=B.dragend={setup:function(){},teardown:function(){}};function H(L){var K=this,J,M=L.data||{};if(M.elem){K=L.dragTarget=M.elem;L.dragProxy=F.proxy||K;L.cursorOffsetX=M.pageX-M.left;L.cursorOffsetY=M.pageY-M.top;L.offsetX=L.pageX-L.cursorOffsetX;L.offsetY=L.pageY-L.cursorOffsetY}else{if(F.dragging||(M.which&gt;0&amp;&amp;L.which!=M.which)||E(L.target).is(M.not)){return }}switch(L.type){case&quot;mousedown&quot;:E.extend(M,E(K).offset(),{elem:K,target:L.target,pageX:L.pageX,pageY:L.pageY});A.add(document,&quot;mousemove mouseup&quot;,H,M);G(K,false);F.dragging=null;return false;case !F.dragging&amp;&amp;&quot;mousemove&quot;:if(I(L.pageX-M.pageX)+I(L.pageY-M.pageY)&lt;M.distance){break}L.target=M.target;J=C(L,&quot;dragstart&quot;,K);if(J!==false){F.dragging=K;F.proxy=L.dragProxy=E(J||K)[0]}case&quot;mousemove&quot;:if(F.dragging){J=C(L,&quot;drag&quot;,K);if(B.drop){B.drop.allowed=(J!==false);B.drop.handler(L)}if(J!==false){break}L.type=&quot;mouseup&quot;}case&quot;mouseup&quot;:A.remove(document,&quot;mousemove mouseup&quot;,H);if(F.dragging){if(B.drop){B.drop.handler(L)}C(L,&quot;dragend&quot;,K)}G(K,true);F.dragging=F.proxy=M.elem=false;break}return true}function C(M,K,L){M.type=K;var J=E.event.handle.call(L,M);return J===false?false:J||M.result}function I(J){return Math.pow(J,2)}function D(){return(F.dragging===false)}function G(K,J){if(!K){return }K.unselectable=J?&quot;off&quot;:&quot;on&quot;;K.onselectstart=function(){return J};if(K.style){K.style.MozUserSelect=J?&quot;&quot;:&quot;none&quot;}}})(jQuery);</span>
<a href="#l19.69"></a><span id="l19.69" class="difflineminus">-</span>
<a href="#l19.70"></a><span id="l19.70" class="difflineminus">-</span>
<a href="#l19.71"></a><span id="l19.71" class="difflineminus">-/* jquery.mousewheel.min.js</span>
<a href="#l19.72"></a><span id="l19.72" class="difflineminus">- * Copyright (c) 2009 Brandon Aaron (http://brandonaaron.net)</span>
<a href="#l19.73"></a><span id="l19.73" class="difflineminus">- * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)</span>
<a href="#l19.74"></a><span id="l19.74" class="difflineminus">- * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.</span>
<a href="#l19.75"></a><span id="l19.75" class="difflineminus">- * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.</span>
<a href="#l19.76"></a><span id="l19.76" class="difflineminus">- * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.</span>
<a href="#l19.77"></a><span id="l19.77" class="difflineminus">- *</span>
<a href="#l19.78"></a><span id="l19.78" class="difflineminus">- * Version: 3.0.2</span>
<a href="#l19.79"></a><span id="l19.79" class="difflineminus">- * </span>
<a href="#l19.80"></a><span id="l19.80" class="difflineminus">- * Requires: 1.2.2+</span>
<a href="#l19.81"></a><span id="l19.81" class="difflineminus">- */</span>
<a href="#l19.82"></a><span id="l19.82" class="difflineminus">-(function(c){var a=[&quot;DOMMouseScroll&quot;,&quot;mousewheel&quot;];c.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var d=a.length;d;){this.addEventListener(a[--d],b,false)}}else{this.onmousewheel=b}},teardown:function(){if(this.removeEventListener){for(var d=a.length;d;){this.removeEventListener(a[--d],b,false)}}else{this.onmousewheel=null}}};c.fn.extend({mousewheel:function(d){return d?this.bind(&quot;mousewheel&quot;,d):this.trigger(&quot;mousewheel&quot;)},unmousewheel:function(d){return this.unbind(&quot;mousewheel&quot;,d)}});function b(f){var d=[].slice.call(arguments,1),g=0,e=true;f=c.event.fix(f||window.event);f.type=&quot;mousewheel&quot;;if(f.wheelDelta){g=f.wheelDelta/120}if(f.detail){g=-f.detail/3}d.unshift(f,g);return c.event.handle.apply(this,d)}})(jQuery);</span>
<a href="#l19.83"></a><span id="l19.83" class="difflineminus">-</span>
<a href="#l19.84"></a><span id="l19.84" class="difflineminus">-</span>
<a href="#l19.85"></a><span id="l19.85" class="difflineminus">-</span>
<a href="#l19.86"></a><span id="l19.86" class="difflineminus">-</span>
<a href="#l19.87"></a><span id="l19.87" class="difflineminus">-(function ($) {</span>
<a href="#l19.88"></a><span id="l19.88" class="difflineminus">-    var options = {</span>
<a href="#l19.89"></a><span id="l19.89" class="difflineminus">-        xaxis: {</span>
<a href="#l19.90"></a><span id="l19.90" class="difflineminus">-            zoomRange: null, // or [number, number] (min range, max range)</span>
<a href="#l19.91"></a><span id="l19.91" class="difflineminus">-            panRange: null // or [number, number] (min, max)</span>
<a href="#l19.92"></a><span id="l19.92" class="difflineminus">-        },</span>
<a href="#l19.93"></a><span id="l19.93" class="difflineminus">-        zoom: {</span>
<a href="#l19.94"></a><span id="l19.94" class="difflineminus">-            interactive: false,</span>
<a href="#l19.95"></a><span id="l19.95" class="difflineminus">-            trigger: &quot;dblclick&quot;, // or &quot;click&quot; for single click</span>
<a href="#l19.96"></a><span id="l19.96" class="difflineminus">-            amount: 1.5 // how much to zoom relative to current position, 2 = 200% (zoom in), 0.5 = 50% (zoom out)</span>
<a href="#l19.97"></a><span id="l19.97" class="difflineminus">-        },</span>
<a href="#l19.98"></a><span id="l19.98" class="difflineminus">-        pan: {</span>
<a href="#l19.99"></a><span id="l19.99" class="difflineminus">-            interactive: false</span>
<a href="#l19.100"></a><span id="l19.100" class="difflineminus">-        }</span>
<a href="#l19.101"></a><span id="l19.101" class="difflineminus">-    };</span>
<a href="#l19.102"></a><span id="l19.102" class="difflineminus">-</span>
<a href="#l19.103"></a><span id="l19.103" class="difflineminus">-    function init(plot) {</span>
<a href="#l19.104"></a><span id="l19.104" class="difflineminus">-        function bindEvents(plot, eventHolder) {</span>
<a href="#l19.105"></a><span id="l19.105" class="difflineminus">-            var o = plot.getOptions();</span>
<a href="#l19.106"></a><span id="l19.106" class="difflineminus">-            if (o.zoom.interactive) {</span>
<a href="#l19.107"></a><span id="l19.107" class="difflineminus">-                function clickHandler(e, zoomOut) {</span>
<a href="#l19.108"></a><span id="l19.108" class="difflineminus">-                    var c = plot.offset();</span>
<a href="#l19.109"></a><span id="l19.109" class="difflineminus">-                    c.left = e.pageX - c.left;</span>
<a href="#l19.110"></a><span id="l19.110" class="difflineminus">-                    c.top = e.pageY - c.top;</span>
<a href="#l19.111"></a><span id="l19.111" class="difflineminus">-                    if (zoomOut)</span>
<a href="#l19.112"></a><span id="l19.112" class="difflineminus">-                        plot.zoomOut({ center: c });</span>
<a href="#l19.113"></a><span id="l19.113" class="difflineminus">-                    else</span>
<a href="#l19.114"></a><span id="l19.114" class="difflineminus">-                        plot.zoom({ center: c });</span>
<a href="#l19.115"></a><span id="l19.115" class="difflineminus">-                }</span>
<a href="#l19.116"></a><span id="l19.116" class="difflineminus">-                </span>
<a href="#l19.117"></a><span id="l19.117" class="difflineminus">-                eventHolder[o.zoom.trigger](clickHandler);</span>
<a href="#l19.118"></a><span id="l19.118" class="difflineminus">-</span>
<a href="#l19.119"></a><span id="l19.119" class="difflineminus">-                eventHolder.mousewheel(function (e, delta) {</span>
<a href="#l19.120"></a><span id="l19.120" class="difflineminus">-                    clickHandler(e, delta &lt; 0);</span>
<a href="#l19.121"></a><span id="l19.121" class="difflineminus">-                    return false;</span>
<a href="#l19.122"></a><span id="l19.122" class="difflineminus">-                });</span>
<a href="#l19.123"></a><span id="l19.123" class="difflineminus">-            }</span>
<a href="#l19.124"></a><span id="l19.124" class="difflineminus">-            if (o.pan.interactive) {</span>
<a href="#l19.125"></a><span id="l19.125" class="difflineminus">-                var prevCursor = 'default', pageX = 0, pageY = 0;</span>
<a href="#l19.126"></a><span id="l19.126" class="difflineminus">-                </span>
<a href="#l19.127"></a><span id="l19.127" class="difflineminus">-                eventHolder.bind(&quot;dragstart&quot;, { distance: 10 }, function (e) {</span>
<a href="#l19.128"></a><span id="l19.128" class="difflineminus">-                    if (e.which != 1)  // only accept left-click</span>
<a href="#l19.129"></a><span id="l19.129" class="difflineminus">-                        return false;</span>
<a href="#l19.130"></a><span id="l19.130" class="difflineminus">-                    eventHolderCursor = eventHolder.css('cursor');</span>
<a href="#l19.131"></a><span id="l19.131" class="difflineminus">-                    eventHolder.css('cursor', 'move');</span>
<a href="#l19.132"></a><span id="l19.132" class="difflineminus">-                    pageX = e.pageX;</span>
<a href="#l19.133"></a><span id="l19.133" class="difflineminus">-                    pageY = e.pageY;</span>
<a href="#l19.134"></a><span id="l19.134" class="difflineminus">-                });</span>
<a href="#l19.135"></a><span id="l19.135" class="difflineminus">-                eventHolder.bind(&quot;drag&quot;, function (e) {</span>
<a href="#l19.136"></a><span id="l19.136" class="difflineminus">-                    // unused at the moment, but we need it here to</span>
<a href="#l19.137"></a><span id="l19.137" class="difflineminus">-                    // trigger the dragstart/dragend events</span>
<a href="#l19.138"></a><span id="l19.138" class="difflineminus">-                });</span>
<a href="#l19.139"></a><span id="l19.139" class="difflineminus">-                eventHolder.bind(&quot;dragend&quot;, function (e) {</span>
<a href="#l19.140"></a><span id="l19.140" class="difflineminus">-                    eventHolder.css('cursor', prevCursor);</span>
<a href="#l19.141"></a><span id="l19.141" class="difflineminus">-                    plot.pan({ left: pageX - e.pageX,</span>
<a href="#l19.142"></a><span id="l19.142" class="difflineminus">-                               top: pageY - e.pageY });</span>
<a href="#l19.143"></a><span id="l19.143" class="difflineminus">-                });</span>
<a href="#l19.144"></a><span id="l19.144" class="difflineminus">-            }</span>
<a href="#l19.145"></a><span id="l19.145" class="difflineminus">-        }</span>
<a href="#l19.146"></a><span id="l19.146" class="difflineminus">-</span>
<a href="#l19.147"></a><span id="l19.147" class="difflineminus">-        plot.zoomOut = function (args) {</span>
<a href="#l19.148"></a><span id="l19.148" class="difflineminus">-            if (!args)</span>
<a href="#l19.149"></a><span id="l19.149" class="difflineminus">-                args = {};</span>
<a href="#l19.150"></a><span id="l19.150" class="difflineminus">-            </span>
<a href="#l19.151"></a><span id="l19.151" class="difflineminus">-            if (!args.amount)</span>
<a href="#l19.152"></a><span id="l19.152" class="difflineminus">-                args.amount = plot.getOptions().zoom.amount</span>
<a href="#l19.153"></a><span id="l19.153" class="difflineminus">-</span>
<a href="#l19.154"></a><span id="l19.154" class="difflineminus">-            args.amount = 1 / args.amount;</span>
<a href="#l19.155"></a><span id="l19.155" class="difflineminus">-            plot.zoom(args);</span>
<a href="#l19.156"></a><span id="l19.156" class="difflineminus">-        }</span>
<a href="#l19.157"></a><span id="l19.157" class="difflineminus">-        </span>
<a href="#l19.158"></a><span id="l19.158" class="difflineminus">-        plot.zoom = function (args) {</span>
<a href="#l19.159"></a><span id="l19.159" class="difflineminus">-            if (!args)</span>
<a href="#l19.160"></a><span id="l19.160" class="difflineminus">-                args = {};</span>
<a href="#l19.161"></a><span id="l19.161" class="difflineminus">-            </span>
<a href="#l19.162"></a><span id="l19.162" class="difflineminus">-            var axes = plot.getAxes(),</span>
<a href="#l19.163"></a><span id="l19.163" class="difflineminus">-                options = plot.getOptions(),</span>
<a href="#l19.164"></a><span id="l19.164" class="difflineminus">-                c = args.center,</span>
<a href="#l19.165"></a><span id="l19.165" class="difflineminus">-                amount = args.amount ? args.amount : options.zoom.amount,</span>
<a href="#l19.166"></a><span id="l19.166" class="difflineminus">-                w = plot.width(), h = plot.height();</span>
<a href="#l19.167"></a><span id="l19.167" class="difflineminus">-</span>
<a href="#l19.168"></a><span id="l19.168" class="difflineminus">-            if (!c)</span>
<a href="#l19.169"></a><span id="l19.169" class="difflineminus">-                c = { left: w / 2, top: h / 2 };</span>
<a href="#l19.170"></a><span id="l19.170" class="difflineminus">-                </span>
<a href="#l19.171"></a><span id="l19.171" class="difflineminus">-            var xf = c.left / w,</span>
<a href="#l19.172"></a><span id="l19.172" class="difflineminus">-                x1 = c.left - xf * w / amount,</span>
<a href="#l19.173"></a><span id="l19.173" class="difflineminus">-                x2 = c.left + (1 - xf) * w / amount,</span>
<a href="#l19.174"></a><span id="l19.174" class="difflineminus">-                yf = c.top / h,</span>
<a href="#l19.175"></a><span id="l19.175" class="difflineminus">-                y1 = c.top - yf * h / amount,</span>
<a href="#l19.176"></a><span id="l19.176" class="difflineminus">-                y2 = c.top + (1 - yf) * h / amount;</span>
<a href="#l19.177"></a><span id="l19.177" class="difflineminus">-</span>
<a href="#l19.178"></a><span id="l19.178" class="difflineminus">-            function scaleAxis(min, max, name) {</span>
<a href="#l19.179"></a><span id="l19.179" class="difflineminus">-                var axis = axes[name],</span>
<a href="#l19.180"></a><span id="l19.180" class="difflineminus">-                    axisOptions = options[name];</span>
<a href="#l19.181"></a><span id="l19.181" class="difflineminus">-                </span>
<a href="#l19.182"></a><span id="l19.182" class="difflineminus">-                if (!axis.used)</span>
<a href="#l19.183"></a><span id="l19.183" class="difflineminus">-                    return;</span>
<a href="#l19.184"></a><span id="l19.184" class="difflineminus">-                    </span>
<a href="#l19.185"></a><span id="l19.185" class="difflineminus">-                min = axis.c2p(min);</span>
<a href="#l19.186"></a><span id="l19.186" class="difflineminus">-                max = axis.c2p(max);</span>
<a href="#l19.187"></a><span id="l19.187" class="difflineminus">-                if (max &lt; min) { // make sure min &lt; max</span>
<a href="#l19.188"></a><span id="l19.188" class="difflineminus">-                    var tmp = min</span>
<a href="#l19.189"></a><span id="l19.189" class="difflineminus">-                    min = max;</span>
<a href="#l19.190"></a><span id="l19.190" class="difflineminus">-                    max = tmp;</span>
<a href="#l19.191"></a><span id="l19.191" class="difflineminus">-                }</span>
<a href="#l19.192"></a><span id="l19.192" class="difflineminus">-</span>
<a href="#l19.193"></a><span id="l19.193" class="difflineminus">-                var range = max - min, zr = axisOptions.zoomRange;</span>
<a href="#l19.194"></a><span id="l19.194" class="difflineminus">-                if (zr &amp;&amp;</span>
<a href="#l19.195"></a><span id="l19.195" class="difflineminus">-                    ((zr[0] != null &amp;&amp; range &lt; zr[0]) ||</span>
<a href="#l19.196"></a><span id="l19.196" class="difflineminus">-                     (zr[1] != null &amp;&amp; range &gt; zr[1])))</span>
<a href="#l19.197"></a><span id="l19.197" class="difflineminus">-                    return;</span>
<a href="#l19.198"></a><span id="l19.198" class="difflineminus">-            </span>
<a href="#l19.199"></a><span id="l19.199" class="difflineminus">-                axisOptions.min = min;</span>
<a href="#l19.200"></a><span id="l19.200" class="difflineminus">-                axisOptions.max = max;</span>
<a href="#l19.201"></a><span id="l19.201" class="difflineminus">-            }</span>
<a href="#l19.202"></a><span id="l19.202" class="difflineminus">-</span>
<a href="#l19.203"></a><span id="l19.203" class="difflineminus">-            scaleAxis(x1, x2, 'xaxis');</span>
<a href="#l19.204"></a><span id="l19.204" class="difflineminus">-            scaleAxis(x1, x2, 'x2axis');</span>
<a href="#l19.205"></a><span id="l19.205" class="difflineminus">-            scaleAxis(y1, y2, 'yaxis');</span>
<a href="#l19.206"></a><span id="l19.206" class="difflineminus">-            scaleAxis(y1, y2, 'y2axis');</span>
<a href="#l19.207"></a><span id="l19.207" class="difflineminus">-            </span>
<a href="#l19.208"></a><span id="l19.208" class="difflineminus">-            plot.setupGrid();</span>
<a href="#l19.209"></a><span id="l19.209" class="difflineminus">-            plot.draw();</span>
<a href="#l19.210"></a><span id="l19.210" class="difflineminus">-            </span>
<a href="#l19.211"></a><span id="l19.211" class="difflineminus">-            if (!args.preventEvent)</span>
<a href="#l19.212"></a><span id="l19.212" class="difflineminus">-                plot.getPlaceholder().trigger(&quot;plotzoom&quot;, [ plot ]);</span>
<a href="#l19.213"></a><span id="l19.213" class="difflineminus">-        }</span>
<a href="#l19.214"></a><span id="l19.214" class="difflineminus">-</span>
<a href="#l19.215"></a><span id="l19.215" class="difflineminus">-        plot.pan = function (args) {</span>
<a href="#l19.216"></a><span id="l19.216" class="difflineminus">-            var l = +args.left, t = +args.top,</span>
<a href="#l19.217"></a><span id="l19.217" class="difflineminus">-                axes = plot.getAxes(), options = plot.getOptions();</span>
<a href="#l19.218"></a><span id="l19.218" class="difflineminus">-</span>
<a href="#l19.219"></a><span id="l19.219" class="difflineminus">-            if (isNaN(l))</span>
<a href="#l19.220"></a><span id="l19.220" class="difflineminus">-                l = 0;</span>
<a href="#l19.221"></a><span id="l19.221" class="difflineminus">-            if (isNaN(t))</span>
<a href="#l19.222"></a><span id="l19.222" class="difflineminus">-                t = 0;</span>
<a href="#l19.223"></a><span id="l19.223" class="difflineminus">-</span>
<a href="#l19.224"></a><span id="l19.224" class="difflineminus">-            function panAxis(delta, name) {</span>
<a href="#l19.225"></a><span id="l19.225" class="difflineminus">-                var axis = axes[name],</span>
<a href="#l19.226"></a><span id="l19.226" class="difflineminus">-                    axisOptions = options[name],</span>
<a href="#l19.227"></a><span id="l19.227" class="difflineminus">-                    min, max;</span>
<a href="#l19.228"></a><span id="l19.228" class="difflineminus">-                </span>
<a href="#l19.229"></a><span id="l19.229" class="difflineminus">-                if (!axis.used)</span>
<a href="#l19.230"></a><span id="l19.230" class="difflineminus">-                    return;</span>
<a href="#l19.231"></a><span id="l19.231" class="difflineminus">-</span>
<a href="#l19.232"></a><span id="l19.232" class="difflineminus">-                min = axis.c2p(axis.p2c(axis.min) + delta),</span>
<a href="#l19.233"></a><span id="l19.233" class="difflineminus">-                max = axis.c2p(axis.p2c(axis.max) + delta);</span>
<a href="#l19.234"></a><span id="l19.234" class="difflineminus">-</span>
<a href="#l19.235"></a><span id="l19.235" class="difflineminus">-                var pr = axisOptions.panRange;</span>
<a href="#l19.236"></a><span id="l19.236" class="difflineminus">-                if (pr) {</span>
<a href="#l19.237"></a><span id="l19.237" class="difflineminus">-                    // check whether we hit the wall</span>
<a href="#l19.238"></a><span id="l19.238" class="difflineminus">-                    if (pr[0] != null &amp;&amp; pr[0] &gt; min) {</span>
<a href="#l19.239"></a><span id="l19.239" class="difflineminus">-                        delta = pr[0] - min;</span>
<a href="#l19.240"></a><span id="l19.240" class="difflineminus">-                        min += delta;</span>
<a href="#l19.241"></a><span id="l19.241" class="difflineminus">-                        max += delta;</span>
<a href="#l19.242"></a><span id="l19.242" class="difflineminus">-                    }</span>
<a href="#l19.243"></a><span id="l19.243" class="difflineminus">-                    </span>
<a href="#l19.244"></a><span id="l19.244" class="difflineminus">-                    if (pr[1] != null &amp;&amp; pr[1] &lt; max) {</span>
<a href="#l19.245"></a><span id="l19.245" class="difflineminus">-                        delta = pr[1] - max;</span>
<a href="#l19.246"></a><span id="l19.246" class="difflineminus">-                        min += delta;</span>
<a href="#l19.247"></a><span id="l19.247" class="difflineminus">-                        max += delta;</span>
<a href="#l19.248"></a><span id="l19.248" class="difflineminus">-                    }</span>
<a href="#l19.249"></a><span id="l19.249" class="difflineminus">-                }</span>
<a href="#l19.250"></a><span id="l19.250" class="difflineminus">-                </span>
<a href="#l19.251"></a><span id="l19.251" class="difflineminus">-                axisOptions.min = min;</span>
<a href="#l19.252"></a><span id="l19.252" class="difflineminus">-                axisOptions.max = max;</span>
<a href="#l19.253"></a><span id="l19.253" class="difflineminus">-            }</span>
<a href="#l19.254"></a><span id="l19.254" class="difflineminus">-</span>
<a href="#l19.255"></a><span id="l19.255" class="difflineminus">-            panAxis(l, 'xaxis');</span>
<a href="#l19.256"></a><span id="l19.256" class="difflineminus">-            panAxis(l, 'x2axis');</span>
<a href="#l19.257"></a><span id="l19.257" class="difflineminus">-            panAxis(t, 'yaxis');</span>
<a href="#l19.258"></a><span id="l19.258" class="difflineminus">-            panAxis(t, 'y2axis');</span>
<a href="#l19.259"></a><span id="l19.259" class="difflineminus">-            </span>
<a href="#l19.260"></a><span id="l19.260" class="difflineminus">-            plot.setupGrid();</span>
<a href="#l19.261"></a><span id="l19.261" class="difflineminus">-            plot.draw();</span>
<a href="#l19.262"></a><span id="l19.262" class="difflineminus">-            </span>
<a href="#l19.263"></a><span id="l19.263" class="difflineminus">-            if (!args.preventEvent)</span>
<a href="#l19.264"></a><span id="l19.264" class="difflineminus">-                plot.getPlaceholder().trigger(&quot;plotpan&quot;, [ plot ]);</span>
<a href="#l19.265"></a><span id="l19.265" class="difflineminus">-        }</span>
<a href="#l19.266"></a><span id="l19.266" class="difflineminus">-        </span>
<a href="#l19.267"></a><span id="l19.267" class="difflineminus">-        plot.hooks.bindEvents.push(bindEvents);</span>
<a href="#l19.268"></a><span id="l19.268" class="difflineminus">-    }</span>
<a href="#l19.269"></a><span id="l19.269" class="difflineminus">-    </span>
<a href="#l19.270"></a><span id="l19.270" class="difflineminus">-    $.plot.plugins.push({</span>
<a href="#l19.271"></a><span id="l19.271" class="difflineminus">-        init: init,</span>
<a href="#l19.272"></a><span id="l19.272" class="difflineminus">-        options: options,</span>
<a href="#l19.273"></a><span id="l19.273" class="difflineminus">-        name: 'navigate',</span>
<a href="#l19.274"></a><span id="l19.274" class="difflineminus">-        version: '1.1'</span>
<a href="#l19.275"></a><span id="l19.275" class="difflineminus">-    });</span>
<a href="#l19.276"></a><span id="l19.276" class="difflineminus">-})(jQuery);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1">deleted file mode 100644</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.flot.selection.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineplus">+++ /dev/null</span>
<a href="#l20.4"></a><span id="l20.4" class="difflineat">@@ -1,303 +0,0 @@</span>
<a href="#l20.5"></a><span id="l20.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l20.6"></a><span id="l20.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l20.7"></a><span id="l20.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l20.8"></a><span id="l20.8" class="difflineminus">-</span>
<a href="#l20.9"></a><span id="l20.9" class="difflineminus">-/*</span>
<a href="#l20.10"></a><span id="l20.10" class="difflineminus">-Flot plugin for selecting regions.</span>
<a href="#l20.11"></a><span id="l20.11" class="difflineminus">-</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-The plugin defines the following options:</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineminus">-</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineminus">-  selection: {</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineminus">-    mode: null or &quot;x&quot; or &quot;y&quot; or &quot;xy&quot;,</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineminus">-    color: color</span>
<a href="#l20.17"></a><span id="l20.17" class="difflineminus">-  }</span>
<a href="#l20.18"></a><span id="l20.18" class="difflineminus">-</span>
<a href="#l20.19"></a><span id="l20.19" class="difflineminus">-You enable selection support by setting the mode to one of &quot;x&quot;, &quot;y&quot; or</span>
<a href="#l20.20"></a><span id="l20.20" class="difflineminus">-&quot;xy&quot;. In &quot;x&quot; mode, the user will only be able to specify the x range,</span>
<a href="#l20.21"></a><span id="l20.21" class="difflineminus">-similarly for &quot;y&quot; mode. For &quot;xy&quot;, the selection becomes a rectangle</span>
<a href="#l20.22"></a><span id="l20.22" class="difflineminus">-where both ranges can be specified. &quot;color&quot; is color of the selection.</span>
<a href="#l20.23"></a><span id="l20.23" class="difflineminus">-</span>
<a href="#l20.24"></a><span id="l20.24" class="difflineminus">-When selection support is enabled, a &quot;plotselected&quot; event will be emitted</span>
<a href="#l20.25"></a><span id="l20.25" class="difflineminus">-on the DOM element you passed into the plot function. The event</span>
<a href="#l20.26"></a><span id="l20.26" class="difflineminus">-handler gets one extra parameter with the ranges selected on the axes,</span>
<a href="#l20.27"></a><span id="l20.27" class="difflineminus">-like this:</span>
<a href="#l20.28"></a><span id="l20.28" class="difflineminus">-</span>
<a href="#l20.29"></a><span id="l20.29" class="difflineminus">-  placeholder.bind(&quot;plotselected&quot;, function(event, ranges) {</span>
<a href="#l20.30"></a><span id="l20.30" class="difflineminus">-    alert(&quot;You selected &quot; + ranges.xaxis.from + &quot; to &quot; + ranges.xaxis.to)</span>
<a href="#l20.31"></a><span id="l20.31" class="difflineminus">-    // similar for yaxis, secondary axes are in x2axis</span>
<a href="#l20.32"></a><span id="l20.32" class="difflineminus">-    // and y2axis if present</span>
<a href="#l20.33"></a><span id="l20.33" class="difflineminus">-  });</span>
<a href="#l20.34"></a><span id="l20.34" class="difflineminus">-</span>
<a href="#l20.35"></a><span id="l20.35" class="difflineminus">-The &quot;plotselected&quot; event is only fired when the user has finished</span>
<a href="#l20.36"></a><span id="l20.36" class="difflineminus">-making the selection. A &quot;plotselecting&quot; event is fired during the</span>
<a href="#l20.37"></a><span id="l20.37" class="difflineminus">-process with the same parameters as the &quot;plotselected&quot; event, in case</span>
<a href="#l20.38"></a><span id="l20.38" class="difflineminus">-you want to know what's happening while it's happening,</span>
<a href="#l20.39"></a><span id="l20.39" class="difflineminus">-</span>
<a href="#l20.40"></a><span id="l20.40" class="difflineminus">-A &quot;plotunselected&quot; event with no arguments is emitted when the user</span>
<a href="#l20.41"></a><span id="l20.41" class="difflineminus">-clicks the mouse to remove the selection.</span>
<a href="#l20.42"></a><span id="l20.42" class="difflineminus">-</span>
<a href="#l20.43"></a><span id="l20.43" class="difflineminus">-The plugin allso adds the following methods to the plot object:</span>
<a href="#l20.44"></a><span id="l20.44" class="difflineminus">-</span>
<a href="#l20.45"></a><span id="l20.45" class="difflineminus">-- setSelection(ranges, preventEvent)</span>
<a href="#l20.46"></a><span id="l20.46" class="difflineminus">-</span>
<a href="#l20.47"></a><span id="l20.47" class="difflineminus">-  Set the selection rectangle. The passed in ranges is on the same</span>
<a href="#l20.48"></a><span id="l20.48" class="difflineminus">-  form as returned in the &quot;plotselected&quot; event. If the selection</span>
<a href="#l20.49"></a><span id="l20.49" class="difflineminus">-  mode is &quot;x&quot;, you should put in either an xaxis (or x2axis) object,</span>
<a href="#l20.50"></a><span id="l20.50" class="difflineminus">-  if the mode is &quot;y&quot; you need to put in an yaxis (or y2axis) object</span>
<a href="#l20.51"></a><span id="l20.51" class="difflineminus">-  and both xaxis/x2axis and yaxis/y2axis if the selection mode is</span>
<a href="#l20.52"></a><span id="l20.52" class="difflineminus">-  &quot;xy&quot;, like this:</span>
<a href="#l20.53"></a><span id="l20.53" class="difflineminus">-</span>
<a href="#l20.54"></a><span id="l20.54" class="difflineminus">-    setSelection({ xaxis: { from: 0, to: 10 }, yaxis: { from: 40, to: 60 } });</span>
<a href="#l20.55"></a><span id="l20.55" class="difflineminus">-</span>
<a href="#l20.56"></a><span id="l20.56" class="difflineminus">-  setSelection will trigger the &quot;plotselected&quot; event when called. If</span>
<a href="#l20.57"></a><span id="l20.57" class="difflineminus">-  you don't want that to happen, e.g. if you're inside a</span>
<a href="#l20.58"></a><span id="l20.58" class="difflineminus">-  &quot;plotselected&quot; handler, pass true as the second parameter.</span>
<a href="#l20.59"></a><span id="l20.59" class="difflineminus">-  </span>
<a href="#l20.60"></a><span id="l20.60" class="difflineminus">-- clearSelection(preventEvent)</span>
<a href="#l20.61"></a><span id="l20.61" class="difflineminus">-</span>
<a href="#l20.62"></a><span id="l20.62" class="difflineminus">-  Clear the selection rectangle. Pass in true to avoid getting a</span>
<a href="#l20.63"></a><span id="l20.63" class="difflineminus">-  &quot;plotunselected&quot; event.</span>
<a href="#l20.64"></a><span id="l20.64" class="difflineminus">-</span>
<a href="#l20.65"></a><span id="l20.65" class="difflineminus">-- getSelection()</span>
<a href="#l20.66"></a><span id="l20.66" class="difflineminus">-</span>
<a href="#l20.67"></a><span id="l20.67" class="difflineminus">-  Returns the current selection in the same format as the</span>
<a href="#l20.68"></a><span id="l20.68" class="difflineminus">-  &quot;plotselected&quot; event. If there's currently no selection, the</span>
<a href="#l20.69"></a><span id="l20.69" class="difflineminus">-  function returns null.</span>
<a href="#l20.70"></a><span id="l20.70" class="difflineminus">-</span>
<a href="#l20.71"></a><span id="l20.71" class="difflineminus">-*/</span>
<a href="#l20.72"></a><span id="l20.72" class="difflineminus">-</span>
<a href="#l20.73"></a><span id="l20.73" class="difflineminus">-(function ($) {</span>
<a href="#l20.74"></a><span id="l20.74" class="difflineminus">-    function init(plot) {</span>
<a href="#l20.75"></a><span id="l20.75" class="difflineminus">-        var selection = {</span>
<a href="#l20.76"></a><span id="l20.76" class="difflineminus">-                first: { x: -1, y: -1}, second: { x: -1, y: -1},</span>
<a href="#l20.77"></a><span id="l20.77" class="difflineminus">-                show: false,</span>
<a href="#l20.78"></a><span id="l20.78" class="difflineminus">-                active: false</span>
<a href="#l20.79"></a><span id="l20.79" class="difflineminus">-            };</span>
<a href="#l20.80"></a><span id="l20.80" class="difflineminus">-</span>
<a href="#l20.81"></a><span id="l20.81" class="difflineminus">-        // FIXME: The drag handling implemented here should be</span>
<a href="#l20.82"></a><span id="l20.82" class="difflineminus">-        // abstracted out, there's some similar code from a library in</span>
<a href="#l20.83"></a><span id="l20.83" class="difflineminus">-        // the navigation plugin, this should be massaged a bit to fit</span>
<a href="#l20.84"></a><span id="l20.84" class="difflineminus">-        // the Flot cases here better and reused. Doing this would</span>
<a href="#l20.85"></a><span id="l20.85" class="difflineminus">-        // make this plugin much slimmer.</span>
<a href="#l20.86"></a><span id="l20.86" class="difflineminus">-        var savedhandlers = {};</span>
<a href="#l20.87"></a><span id="l20.87" class="difflineminus">-</span>
<a href="#l20.88"></a><span id="l20.88" class="difflineminus">-        function onMouseMove(e) {</span>
<a href="#l20.89"></a><span id="l20.89" class="difflineminus">-            if (selection.active) {</span>
<a href="#l20.90"></a><span id="l20.90" class="difflineminus">-                plot.getPlaceholder().trigger(&quot;plotselecting&quot;, [ getSelection() ]);</span>
<a href="#l20.91"></a><span id="l20.91" class="difflineminus">-</span>
<a href="#l20.92"></a><span id="l20.92" class="difflineminus">-                updateSelection(e);</span>
<a href="#l20.93"></a><span id="l20.93" class="difflineminus">-            }</span>
<a href="#l20.94"></a><span id="l20.94" class="difflineminus">-        }</span>
<a href="#l20.95"></a><span id="l20.95" class="difflineminus">-</span>
<a href="#l20.96"></a><span id="l20.96" class="difflineminus">-        function onMouseDown(e) {</span>
<a href="#l20.97"></a><span id="l20.97" class="difflineminus">-            if (e.which != 1)  // only accept left-click</span>
<a href="#l20.98"></a><span id="l20.98" class="difflineminus">-                return;</span>
<a href="#l20.99"></a><span id="l20.99" class="difflineminus">-            </span>
<a href="#l20.100"></a><span id="l20.100" class="difflineminus">-            // cancel out any text selections</span>
<a href="#l20.101"></a><span id="l20.101" class="difflineminus">-            document.body.focus();</span>
<a href="#l20.102"></a><span id="l20.102" class="difflineminus">-</span>
<a href="#l20.103"></a><span id="l20.103" class="difflineminus">-            // prevent text selection and drag in old-school browsers</span>
<a href="#l20.104"></a><span id="l20.104" class="difflineminus">-            if (document.onselectstart !== undefined &amp;&amp; savedhandlers.onselectstart == null) {</span>
<a href="#l20.105"></a><span id="l20.105" class="difflineminus">-                savedhandlers.onselectstart = document.onselectstart;</span>
<a href="#l20.106"></a><span id="l20.106" class="difflineminus">-                document.onselectstart = function () { return false; };</span>
<a href="#l20.107"></a><span id="l20.107" class="difflineminus">-            }</span>
<a href="#l20.108"></a><span id="l20.108" class="difflineminus">-            if (document.ondrag !== undefined &amp;&amp; savedhandlers.ondrag == null) {</span>
<a href="#l20.109"></a><span id="l20.109" class="difflineminus">-                savedhandlers.ondrag = document.ondrag;</span>
<a href="#l20.110"></a><span id="l20.110" class="difflineminus">-                document.ondrag = function () { return false; };</span>
<a href="#l20.111"></a><span id="l20.111" class="difflineminus">-            }</span>
<a href="#l20.112"></a><span id="l20.112" class="difflineminus">-</span>
<a href="#l20.113"></a><span id="l20.113" class="difflineminus">-            setSelectionPos(selection.first, e);</span>
<a href="#l20.114"></a><span id="l20.114" class="difflineminus">-</span>
<a href="#l20.115"></a><span id="l20.115" class="difflineminus">-            selection.active = true;</span>
<a href="#l20.116"></a><span id="l20.116" class="difflineminus">-            </span>
<a href="#l20.117"></a><span id="l20.117" class="difflineminus">-            $(document).one(&quot;mouseup&quot;, onMouseUp);</span>
<a href="#l20.118"></a><span id="l20.118" class="difflineminus">-        }</span>
<a href="#l20.119"></a><span id="l20.119" class="difflineminus">-</span>
<a href="#l20.120"></a><span id="l20.120" class="difflineminus">-        function onMouseUp(e) {</span>
<a href="#l20.121"></a><span id="l20.121" class="difflineminus">-            // revert drag stuff for old-school browsers</span>
<a href="#l20.122"></a><span id="l20.122" class="difflineminus">-            if (document.onselectstart !== undefined)</span>
<a href="#l20.123"></a><span id="l20.123" class="difflineminus">-                document.onselectstart = savedhandlers.onselectstart;</span>
<a href="#l20.124"></a><span id="l20.124" class="difflineminus">-            if (document.ondrag !== undefined)</span>
<a href="#l20.125"></a><span id="l20.125" class="difflineminus">-                document.ondrag = savedhandlers.ondrag;</span>
<a href="#l20.126"></a><span id="l20.126" class="difflineminus">-</span>
<a href="#l20.127"></a><span id="l20.127" class="difflineminus">-            // no more draggy-dee-drag</span>
<a href="#l20.128"></a><span id="l20.128" class="difflineminus">-            selection.active = false;</span>
<a href="#l20.129"></a><span id="l20.129" class="difflineminus">-            updateSelection(e);</span>
<a href="#l20.130"></a><span id="l20.130" class="difflineminus">-</span>
<a href="#l20.131"></a><span id="l20.131" class="difflineminus">-            if (selectionIsSane())</span>
<a href="#l20.132"></a><span id="l20.132" class="difflineminus">-                triggerSelectedEvent();</span>
<a href="#l20.133"></a><span id="l20.133" class="difflineminus">-            else {</span>
<a href="#l20.134"></a><span id="l20.134" class="difflineminus">-                // this counts as a clear</span>
<a href="#l20.135"></a><span id="l20.135" class="difflineminus">-                plot.getPlaceholder().trigger(&quot;plotunselected&quot;, [ ]);</span>
<a href="#l20.136"></a><span id="l20.136" class="difflineminus">-                plot.getPlaceholder().trigger(&quot;plotselecting&quot;, [ null ]);</span>
<a href="#l20.137"></a><span id="l20.137" class="difflineminus">-            }</span>
<a href="#l20.138"></a><span id="l20.138" class="difflineminus">-</span>
<a href="#l20.139"></a><span id="l20.139" class="difflineminus">-            return false;</span>
<a href="#l20.140"></a><span id="l20.140" class="difflineminus">-        }</span>
<a href="#l20.141"></a><span id="l20.141" class="difflineminus">-</span>
<a href="#l20.142"></a><span id="l20.142" class="difflineminus">-        function getSelection() {</span>
<a href="#l20.143"></a><span id="l20.143" class="difflineminus">-            if (!selectionIsSane())</span>
<a href="#l20.144"></a><span id="l20.144" class="difflineminus">-                return null;</span>
<a href="#l20.145"></a><span id="l20.145" class="difflineminus">-</span>
<a href="#l20.146"></a><span id="l20.146" class="difflineminus">-            var x1 = Math.min(selection.first.x, selection.second.x),</span>
<a href="#l20.147"></a><span id="l20.147" class="difflineminus">-                x2 = Math.max(selection.first.x, selection.second.x),</span>
<a href="#l20.148"></a><span id="l20.148" class="difflineminus">-                y1 = Math.max(selection.first.y, selection.second.y),</span>
<a href="#l20.149"></a><span id="l20.149" class="difflineminus">-                y2 = Math.min(selection.first.y, selection.second.y);</span>
<a href="#l20.150"></a><span id="l20.150" class="difflineminus">-</span>
<a href="#l20.151"></a><span id="l20.151" class="difflineminus">-            var r = {};</span>
<a href="#l20.152"></a><span id="l20.152" class="difflineminus">-            var axes = plot.getAxes();</span>
<a href="#l20.153"></a><span id="l20.153" class="difflineminus">-            if (axes.xaxis.used)</span>
<a href="#l20.154"></a><span id="l20.154" class="difflineminus">-                r.xaxis = { from: axes.xaxis.c2p(x1), to: axes.xaxis.c2p(x2) };</span>
<a href="#l20.155"></a><span id="l20.155" class="difflineminus">-            if (axes.x2axis.used)</span>
<a href="#l20.156"></a><span id="l20.156" class="difflineminus">-                r.x2axis = { from: axes.x2axis.c2p(x1), to: axes.x2axis.c2p(x2) };</span>
<a href="#l20.157"></a><span id="l20.157" class="difflineminus">-            if (axes.yaxis.used)</span>
<a href="#l20.158"></a><span id="l20.158" class="difflineminus">-                r.yaxis = { from: axes.yaxis.c2p(y1), to: axes.yaxis.c2p(y2) };</span>
<a href="#l20.159"></a><span id="l20.159" class="difflineminus">-            if (axes.y2axis.used)</span>
<a href="#l20.160"></a><span id="l20.160" class="difflineminus">-                r.y2axis = { from: axes.y2axis.c2p(y1), to: axes.y2axis.c2p(y2) };</span>
<a href="#l20.161"></a><span id="l20.161" class="difflineminus">-            return r;</span>
<a href="#l20.162"></a><span id="l20.162" class="difflineminus">-        }</span>
<a href="#l20.163"></a><span id="l20.163" class="difflineminus">-</span>
<a href="#l20.164"></a><span id="l20.164" class="difflineminus">-        function triggerSelectedEvent() {</span>
<a href="#l20.165"></a><span id="l20.165" class="difflineminus">-            var r = getSelection();</span>
<a href="#l20.166"></a><span id="l20.166" class="difflineminus">-</span>
<a href="#l20.167"></a><span id="l20.167" class="difflineminus">-            plot.getPlaceholder().trigger(&quot;plotselected&quot;, [ r ]);</span>
<a href="#l20.168"></a><span id="l20.168" class="difflineminus">-</span>
<a href="#l20.169"></a><span id="l20.169" class="difflineminus">-            // backwards-compat stuff, to be removed in future</span>
<a href="#l20.170"></a><span id="l20.170" class="difflineminus">-            var axes = plot.getAxes();</span>
<a href="#l20.171"></a><span id="l20.171" class="difflineminus">-            if (axes.xaxis.used &amp;&amp; axes.yaxis.used)</span>
<a href="#l20.172"></a><span id="l20.172" class="difflineminus">-                plot.getPlaceholder().trigger(&quot;selected&quot;, [ { x1: r.xaxis.from, y1: r.yaxis.from, x2: r.xaxis.to, y2: r.yaxis.to } ]);</span>
<a href="#l20.173"></a><span id="l20.173" class="difflineminus">-        }</span>
<a href="#l20.174"></a><span id="l20.174" class="difflineminus">-</span>
<a href="#l20.175"></a><span id="l20.175" class="difflineminus">-        function clamp(min, value, max) {</span>
<a href="#l20.176"></a><span id="l20.176" class="difflineminus">-            return value &lt; min? min: (value &gt; max? max: value);</span>
<a href="#l20.177"></a><span id="l20.177" class="difflineminus">-        }</span>
<a href="#l20.178"></a><span id="l20.178" class="difflineminus">-</span>
<a href="#l20.179"></a><span id="l20.179" class="difflineminus">-        function setSelectionPos(pos, e) {</span>
<a href="#l20.180"></a><span id="l20.180" class="difflineminus">-            var o = plot.getOptions();</span>
<a href="#l20.181"></a><span id="l20.181" class="difflineminus">-            var offset = plot.getPlaceholder().offset();</span>
<a href="#l20.182"></a><span id="l20.182" class="difflineminus">-            var plotOffset = plot.getPlotOffset();</span>
<a href="#l20.183"></a><span id="l20.183" class="difflineminus">-            pos.x = clamp(0, e.pageX - offset.left - plotOffset.left, plot.width());</span>
<a href="#l20.184"></a><span id="l20.184" class="difflineminus">-            pos.y = clamp(0, e.pageY - offset.top - plotOffset.top, plot.height());</span>
<a href="#l20.185"></a><span id="l20.185" class="difflineminus">-</span>
<a href="#l20.186"></a><span id="l20.186" class="difflineminus">-            if (o.selection.mode == &quot;y&quot;)</span>
<a href="#l20.187"></a><span id="l20.187" class="difflineminus">-                pos.x = pos == selection.first? 0: plot.width();</span>
<a href="#l20.188"></a><span id="l20.188" class="difflineminus">-</span>
<a href="#l20.189"></a><span id="l20.189" class="difflineminus">-            if (o.selection.mode == &quot;x&quot;)</span>
<a href="#l20.190"></a><span id="l20.190" class="difflineminus">-                pos.y = pos == selection.first? 0: plot.height();</span>
<a href="#l20.191"></a><span id="l20.191" class="difflineminus">-        }</span>
<a href="#l20.192"></a><span id="l20.192" class="difflineminus">-</span>
<a href="#l20.193"></a><span id="l20.193" class="difflineminus">-        function updateSelection(pos) {</span>
<a href="#l20.194"></a><span id="l20.194" class="difflineminus">-            if (pos.pageX == null)</span>
<a href="#l20.195"></a><span id="l20.195" class="difflineminus">-                return;</span>
<a href="#l20.196"></a><span id="l20.196" class="difflineminus">-</span>
<a href="#l20.197"></a><span id="l20.197" class="difflineminus">-            setSelectionPos(selection.second, pos);</span>
<a href="#l20.198"></a><span id="l20.198" class="difflineminus">-            if (selectionIsSane()) {</span>
<a href="#l20.199"></a><span id="l20.199" class="difflineminus">-                selection.show = true;</span>
<a href="#l20.200"></a><span id="l20.200" class="difflineminus">-                plot.triggerRedrawOverlay();</span>
<a href="#l20.201"></a><span id="l20.201" class="difflineminus">-            }</span>
<a href="#l20.202"></a><span id="l20.202" class="difflineminus">-            else</span>
<a href="#l20.203"></a><span id="l20.203" class="difflineminus">-                clearSelection(true);</span>
<a href="#l20.204"></a><span id="l20.204" class="difflineminus">-        }</span>
<a href="#l20.205"></a><span id="l20.205" class="difflineminus">-</span>
<a href="#l20.206"></a><span id="l20.206" class="difflineminus">-        function clearSelection(preventEvent) {</span>
<a href="#l20.207"></a><span id="l20.207" class="difflineminus">-            if (selection.show) {</span>
<a href="#l20.208"></a><span id="l20.208" class="difflineminus">-                selection.show = false;</span>
<a href="#l20.209"></a><span id="l20.209" class="difflineminus">-                plot.triggerRedrawOverlay();</span>
<a href="#l20.210"></a><span id="l20.210" class="difflineminus">-                if (!preventEvent)</span>
<a href="#l20.211"></a><span id="l20.211" class="difflineminus">-                    plot.getPlaceholder().trigger(&quot;plotunselected&quot;, [ ]);</span>
<a href="#l20.212"></a><span id="l20.212" class="difflineminus">-            }</span>
<a href="#l20.213"></a><span id="l20.213" class="difflineminus">-        }</span>
<a href="#l20.214"></a><span id="l20.214" class="difflineminus">-</span>
<a href="#l20.215"></a><span id="l20.215" class="difflineminus">-        function setSelection(ranges, preventEvent) {</span>
<a href="#l20.216"></a><span id="l20.216" class="difflineminus">-            var axis, range, axes = plot.getAxes();</span>
<a href="#l20.217"></a><span id="l20.217" class="difflineminus">-            var o = plot.getOptions();</span>
<a href="#l20.218"></a><span id="l20.218" class="difflineminus">-</span>
<a href="#l20.219"></a><span id="l20.219" class="difflineminus">-            if (o.selection.mode == &quot;y&quot;) {</span>
<a href="#l20.220"></a><span id="l20.220" class="difflineminus">-                selection.first.x = 0;</span>
<a href="#l20.221"></a><span id="l20.221" class="difflineminus">-                selection.second.x = plot.width();</span>
<a href="#l20.222"></a><span id="l20.222" class="difflineminus">-            }</span>
<a href="#l20.223"></a><span id="l20.223" class="difflineminus">-            else {</span>
<a href="#l20.224"></a><span id="l20.224" class="difflineminus">-                axis = ranges[&quot;xaxis&quot;]? axes[&quot;xaxis&quot;]: (ranges[&quot;x2axis&quot;]? axes[&quot;x2axis&quot;]: axes[&quot;xaxis&quot;]);</span>
<a href="#l20.225"></a><span id="l20.225" class="difflineminus">-                range = ranges[&quot;xaxis&quot;] || ranges[&quot;x2axis&quot;] || { from:ranges[&quot;x1&quot;], to:ranges[&quot;x2&quot;] }</span>
<a href="#l20.226"></a><span id="l20.226" class="difflineminus">-                selection.first.x = axis.p2c(Math.min(range.from, range.to));</span>
<a href="#l20.227"></a><span id="l20.227" class="difflineminus">-                selection.second.x = axis.p2c(Math.max(range.from, range.to));</span>
<a href="#l20.228"></a><span id="l20.228" class="difflineminus">-            }</span>
<a href="#l20.229"></a><span id="l20.229" class="difflineminus">-</span>
<a href="#l20.230"></a><span id="l20.230" class="difflineminus">-            if (o.selection.mode == &quot;x&quot;) {</span>
<a href="#l20.231"></a><span id="l20.231" class="difflineminus">-                selection.first.y = 0;</span>
<a href="#l20.232"></a><span id="l20.232" class="difflineminus">-                selection.second.y = plot.height();</span>
<a href="#l20.233"></a><span id="l20.233" class="difflineminus">-            }</span>
<a href="#l20.234"></a><span id="l20.234" class="difflineminus">-            else {</span>
<a href="#l20.235"></a><span id="l20.235" class="difflineminus">-                axis = ranges[&quot;yaxis&quot;]? axes[&quot;yaxis&quot;]: (ranges[&quot;y2axis&quot;]? axes[&quot;y2axis&quot;]: axes[&quot;yaxis&quot;]);</span>
<a href="#l20.236"></a><span id="l20.236" class="difflineminus">-                range = ranges[&quot;yaxis&quot;] || ranges[&quot;y2axis&quot;] || { from:ranges[&quot;y1&quot;], to:ranges[&quot;y2&quot;] }</span>
<a href="#l20.237"></a><span id="l20.237" class="difflineminus">-                selection.first.y = axis.p2c(Math.min(range.from, range.to));</span>
<a href="#l20.238"></a><span id="l20.238" class="difflineminus">-                selection.second.y = axis.p2c(Math.max(range.from, range.to));</span>
<a href="#l20.239"></a><span id="l20.239" class="difflineminus">-            }</span>
<a href="#l20.240"></a><span id="l20.240" class="difflineminus">-</span>
<a href="#l20.241"></a><span id="l20.241" class="difflineminus">-            selection.show = true;</span>
<a href="#l20.242"></a><span id="l20.242" class="difflineminus">-            plot.triggerRedrawOverlay();</span>
<a href="#l20.243"></a><span id="l20.243" class="difflineminus">-            if (!preventEvent)</span>
<a href="#l20.244"></a><span id="l20.244" class="difflineminus">-                triggerSelectedEvent();</span>
<a href="#l20.245"></a><span id="l20.245" class="difflineminus">-        }</span>
<a href="#l20.246"></a><span id="l20.246" class="difflineminus">-</span>
<a href="#l20.247"></a><span id="l20.247" class="difflineminus">-        function selectionIsSane() {</span>
<a href="#l20.248"></a><span id="l20.248" class="difflineminus">-            var minSize = 5;</span>
<a href="#l20.249"></a><span id="l20.249" class="difflineminus">-            return Math.abs(selection.second.x - selection.first.x) &gt;= minSize &amp;&amp;</span>
<a href="#l20.250"></a><span id="l20.250" class="difflineminus">-                Math.abs(selection.second.y - selection.first.y) &gt;= minSize;</span>
<a href="#l20.251"></a><span id="l20.251" class="difflineminus">-        }</span>
<a href="#l20.252"></a><span id="l20.252" class="difflineminus">-</span>
<a href="#l20.253"></a><span id="l20.253" class="difflineminus">-        plot.clearSelection = clearSelection;</span>
<a href="#l20.254"></a><span id="l20.254" class="difflineminus">-        plot.setSelection = setSelection;</span>
<a href="#l20.255"></a><span id="l20.255" class="difflineminus">-        plot.getSelection = getSelection;</span>
<a href="#l20.256"></a><span id="l20.256" class="difflineminus">-</span>
<a href="#l20.257"></a><span id="l20.257" class="difflineminus">-        plot.hooks.bindEvents.push(function(plot, eventHolder) {</span>
<a href="#l20.258"></a><span id="l20.258" class="difflineminus">-            var o = plot.getOptions();</span>
<a href="#l20.259"></a><span id="l20.259" class="difflineminus">-            if (o.selection.mode != null)</span>
<a href="#l20.260"></a><span id="l20.260" class="difflineminus">-                eventHolder.mousemove(onMouseMove);</span>
<a href="#l20.261"></a><span id="l20.261" class="difflineminus">-</span>
<a href="#l20.262"></a><span id="l20.262" class="difflineminus">-            if (o.selection.mode != null)</span>
<a href="#l20.263"></a><span id="l20.263" class="difflineminus">-                eventHolder.mousedown(onMouseDown);</span>
<a href="#l20.264"></a><span id="l20.264" class="difflineminus">-        });</span>
<a href="#l20.265"></a><span id="l20.265" class="difflineminus">-</span>
<a href="#l20.266"></a><span id="l20.266" class="difflineminus">-</span>
<a href="#l20.267"></a><span id="l20.267" class="difflineminus">-        plot.hooks.drawOverlay.push(function (plot, ctx) {</span>
<a href="#l20.268"></a><span id="l20.268" class="difflineminus">-            // draw selection</span>
<a href="#l20.269"></a><span id="l20.269" class="difflineminus">-            if (selection.show &amp;&amp; selectionIsSane()) {</span>
<a href="#l20.270"></a><span id="l20.270" class="difflineminus">-                var plotOffset = plot.getPlotOffset();</span>
<a href="#l20.271"></a><span id="l20.271" class="difflineminus">-                var o = plot.getOptions();</span>
<a href="#l20.272"></a><span id="l20.272" class="difflineminus">-</span>
<a href="#l20.273"></a><span id="l20.273" class="difflineminus">-                ctx.save();</span>
<a href="#l20.274"></a><span id="l20.274" class="difflineminus">-                ctx.translate(plotOffset.left, plotOffset.top);</span>
<a href="#l20.275"></a><span id="l20.275" class="difflineminus">-</span>
<a href="#l20.276"></a><span id="l20.276" class="difflineminus">-                var c = $.color.parse(o.selection.color);</span>
<a href="#l20.277"></a><span id="l20.277" class="difflineminus">-</span>
<a href="#l20.278"></a><span id="l20.278" class="difflineminus">-                ctx.strokeStyle = c.scale('a', 0.8).toString();</span>
<a href="#l20.279"></a><span id="l20.279" class="difflineminus">-                ctx.lineWidth = 1;</span>
<a href="#l20.280"></a><span id="l20.280" class="difflineminus">-                ctx.lineJoin = &quot;round&quot;;</span>
<a href="#l20.281"></a><span id="l20.281" class="difflineminus">-                ctx.fillStyle = c.scale('a', 0.4).toString();</span>
<a href="#l20.282"></a><span id="l20.282" class="difflineminus">-</span>
<a href="#l20.283"></a><span id="l20.283" class="difflineminus">-                var x = Math.min(selection.first.x, selection.second.x),</span>
<a href="#l20.284"></a><span id="l20.284" class="difflineminus">-                    y = Math.min(selection.first.y, selection.second.y),</span>
<a href="#l20.285"></a><span id="l20.285" class="difflineminus">-                    w = Math.abs(selection.second.x - selection.first.x),</span>
<a href="#l20.286"></a><span id="l20.286" class="difflineminus">-                    h = Math.abs(selection.second.y - selection.first.y);</span>
<a href="#l20.287"></a><span id="l20.287" class="difflineminus">-</span>
<a href="#l20.288"></a><span id="l20.288" class="difflineminus">-                ctx.fillRect(x, y, w, h);</span>
<a href="#l20.289"></a><span id="l20.289" class="difflineminus">-                ctx.strokeRect(x, y, w, h);</span>
<a href="#l20.290"></a><span id="l20.290" class="difflineminus">-</span>
<a href="#l20.291"></a><span id="l20.291" class="difflineminus">-                ctx.restore();</span>
<a href="#l20.292"></a><span id="l20.292" class="difflineminus">-            }</span>
<a href="#l20.293"></a><span id="l20.293" class="difflineminus">-        });</span>
<a href="#l20.294"></a><span id="l20.294" class="difflineminus">-    }</span>
<a href="#l20.295"></a><span id="l20.295" class="difflineminus">-</span>
<a href="#l20.296"></a><span id="l20.296" class="difflineminus">-    $.plot.plugins.push({</span>
<a href="#l20.297"></a><span id="l20.297" class="difflineminus">-        init: init,</span>
<a href="#l20.298"></a><span id="l20.298" class="difflineminus">-        options: {</span>
<a href="#l20.299"></a><span id="l20.299" class="difflineminus">-            selection: {</span>
<a href="#l20.300"></a><span id="l20.300" class="difflineminus">-                mode: null, // one of null, &quot;x&quot;, &quot;y&quot; or &quot;xy&quot;</span>
<a href="#l20.301"></a><span id="l20.301" class="difflineminus">-                color: &quot;#e8cfac&quot;</span>
<a href="#l20.302"></a><span id="l20.302" class="difflineminus">-            }</span>
<a href="#l20.303"></a><span id="l20.303" class="difflineminus">-        },</span>
<a href="#l20.304"></a><span id="l20.304" class="difflineminus">-        name: 'selection',</span>
<a href="#l20.305"></a><span id="l20.305" class="difflineminus">-        version: '1.0'</span>
<a href="#l20.306"></a><span id="l20.306" class="difflineminus">-    });</span>
<a href="#l20.307"></a><span id="l20.307" class="difflineminus">-})(jQuery);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1">deleted file mode 100644</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.flot.stack.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineplus">+++ /dev/null</span>
<a href="#l21.4"></a><span id="l21.4" class="difflineat">@@ -1,156 +0,0 @@</span>
<a href="#l21.5"></a><span id="l21.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l21.6"></a><span id="l21.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l21.7"></a><span id="l21.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l21.8"></a><span id="l21.8" class="difflineminus">-</span>
<a href="#l21.9"></a><span id="l21.9" class="difflineminus">-/*</span>
<a href="#l21.10"></a><span id="l21.10" class="difflineminus">-Flot plugin for stacking data sets, i.e. putting them on top of each</span>
<a href="#l21.11"></a><span id="l21.11" class="difflineminus">-other, for accumulative graphs. Note that the plugin assumes the data</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-is sorted on x. Also note that stacking a mix of positive and negative</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineminus">-values in most instances doesn't make sense (so it looks weird).</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineminus">-</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineminus">-Two or more series are stacked when their &quot;stack&quot; attribute is set to</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineminus">-the same key (which can be any number or string or just &quot;true&quot;). To</span>
<a href="#l21.17"></a><span id="l21.17" class="difflineminus">-specify the default stack, you can set</span>
<a href="#l21.18"></a><span id="l21.18" class="difflineminus">-</span>
<a href="#l21.19"></a><span id="l21.19" class="difflineminus">-  series: {</span>
<a href="#l21.20"></a><span id="l21.20" class="difflineminus">-    stack: null or true or key (number/string)</span>
<a href="#l21.21"></a><span id="l21.21" class="difflineminus">-  }</span>
<a href="#l21.22"></a><span id="l21.22" class="difflineminus">-</span>
<a href="#l21.23"></a><span id="l21.23" class="difflineminus">-or specify it for a specific series</span>
<a href="#l21.24"></a><span id="l21.24" class="difflineminus">-</span>
<a href="#l21.25"></a><span id="l21.25" class="difflineminus">-  $.plot($(&quot;#placeholder&quot;), [{ data: [ ... ], stack: true ])</span>
<a href="#l21.26"></a><span id="l21.26" class="difflineminus">-  </span>
<a href="#l21.27"></a><span id="l21.27" class="difflineminus">-The stacking order is determined by the order of the data series in</span>
<a href="#l21.28"></a><span id="l21.28" class="difflineminus">-the array (later series end up on top of the previous).</span>
<a href="#l21.29"></a><span id="l21.29" class="difflineminus">-</span>
<a href="#l21.30"></a><span id="l21.30" class="difflineminus">-Internally, the plugin modifies the datapoints in each series, adding</span>
<a href="#l21.31"></a><span id="l21.31" class="difflineminus">-an offset to the y value. For line series, extra data points are</span>
<a href="#l21.32"></a><span id="l21.32" class="difflineminus">-inserted through interpolation. For bar charts, the second y value is</span>
<a href="#l21.33"></a><span id="l21.33" class="difflineminus">-also adjusted.</span>
<a href="#l21.34"></a><span id="l21.34" class="difflineminus">-*/</span>
<a href="#l21.35"></a><span id="l21.35" class="difflineminus">-</span>
<a href="#l21.36"></a><span id="l21.36" class="difflineminus">-(function ($) {</span>
<a href="#l21.37"></a><span id="l21.37" class="difflineminus">-    var options = {</span>
<a href="#l21.38"></a><span id="l21.38" class="difflineminus">-        series: { stack: null } // or number/string</span>
<a href="#l21.39"></a><span id="l21.39" class="difflineminus">-    };</span>
<a href="#l21.40"></a><span id="l21.40" class="difflineminus">-    </span>
<a href="#l21.41"></a><span id="l21.41" class="difflineminus">-    function init(plot) {</span>
<a href="#l21.42"></a><span id="l21.42" class="difflineminus">-        function findMatchingSeries(s, allseries) {</span>
<a href="#l21.43"></a><span id="l21.43" class="difflineminus">-            var res = null</span>
<a href="#l21.44"></a><span id="l21.44" class="difflineminus">-            for (var i = 0; i &lt; allseries.length; ++i) {</span>
<a href="#l21.45"></a><span id="l21.45" class="difflineminus">-                if (s == allseries[i])</span>
<a href="#l21.46"></a><span id="l21.46" class="difflineminus">-                    break;</span>
<a href="#l21.47"></a><span id="l21.47" class="difflineminus">-                </span>
<a href="#l21.48"></a><span id="l21.48" class="difflineminus">-                if (allseries[i].stack == s.stack)</span>
<a href="#l21.49"></a><span id="l21.49" class="difflineminus">-                    res = allseries[i];</span>
<a href="#l21.50"></a><span id="l21.50" class="difflineminus">-            }</span>
<a href="#l21.51"></a><span id="l21.51" class="difflineminus">-            </span>
<a href="#l21.52"></a><span id="l21.52" class="difflineminus">-            return res;</span>
<a href="#l21.53"></a><span id="l21.53" class="difflineminus">-        }</span>
<a href="#l21.54"></a><span id="l21.54" class="difflineminus">-        </span>
<a href="#l21.55"></a><span id="l21.55" class="difflineminus">-        function stackData(plot, s, datapoints) {</span>
<a href="#l21.56"></a><span id="l21.56" class="difflineminus">-            if (s.stack == null)</span>
<a href="#l21.57"></a><span id="l21.57" class="difflineminus">-                return;</span>
<a href="#l21.58"></a><span id="l21.58" class="difflineminus">-</span>
<a href="#l21.59"></a><span id="l21.59" class="difflineminus">-            var other = findMatchingSeries(s, plot.getData());</span>
<a href="#l21.60"></a><span id="l21.60" class="difflineminus">-            if (!other)</span>
<a href="#l21.61"></a><span id="l21.61" class="difflineminus">-                return;</span>
<a href="#l21.62"></a><span id="l21.62" class="difflineminus">-            </span>
<a href="#l21.63"></a><span id="l21.63" class="difflineminus">-            var ps = datapoints.pointsize,</span>
<a href="#l21.64"></a><span id="l21.64" class="difflineminus">-                points = datapoints.points,</span>
<a href="#l21.65"></a><span id="l21.65" class="difflineminus">-                otherps = other.datapoints.pointsize,</span>
<a href="#l21.66"></a><span id="l21.66" class="difflineminus">-                otherpoints = other.datapoints.points,</span>
<a href="#l21.67"></a><span id="l21.67" class="difflineminus">-                newpoints = [],</span>
<a href="#l21.68"></a><span id="l21.68" class="difflineminus">-                px, py, intery, qx, qy, bottom,</span>
<a href="#l21.69"></a><span id="l21.69" class="difflineminus">-                withlines = s.lines.show, withbars = s.bars.show,</span>
<a href="#l21.70"></a><span id="l21.70" class="difflineminus">-                withsteps = withlines &amp;&amp; s.lines.steps,</span>
<a href="#l21.71"></a><span id="l21.71" class="difflineminus">-                i = 0, j = 0, l;</span>
<a href="#l21.72"></a><span id="l21.72" class="difflineminus">-</span>
<a href="#l21.73"></a><span id="l21.73" class="difflineminus">-            while (true) {</span>
<a href="#l21.74"></a><span id="l21.74" class="difflineminus">-                if (i &gt;= points.length)</span>
<a href="#l21.75"></a><span id="l21.75" class="difflineminus">-                    break;</span>
<a href="#l21.76"></a><span id="l21.76" class="difflineminus">-</span>
<a href="#l21.77"></a><span id="l21.77" class="difflineminus">-                l = newpoints.length;</span>
<a href="#l21.78"></a><span id="l21.78" class="difflineminus">-</span>
<a href="#l21.79"></a><span id="l21.79" class="difflineminus">-                if (j &gt;= otherpoints.length</span>
<a href="#l21.80"></a><span id="l21.80" class="difflineminus">-                    || otherpoints[j] == null</span>
<a href="#l21.81"></a><span id="l21.81" class="difflineminus">-                    || points[i] == null) {</span>
<a href="#l21.82"></a><span id="l21.82" class="difflineminus">-                    // degenerate cases</span>
<a href="#l21.83"></a><span id="l21.83" class="difflineminus">-                    for (m = 0; m &lt; ps; ++m)</span>
<a href="#l21.84"></a><span id="l21.84" class="difflineminus">-                        newpoints.push(points[i + m]);</span>
<a href="#l21.85"></a><span id="l21.85" class="difflineminus">-                    i += ps;</span>
<a href="#l21.86"></a><span id="l21.86" class="difflineminus">-                }</span>
<a href="#l21.87"></a><span id="l21.87" class="difflineminus">-                else {</span>
<a href="#l21.88"></a><span id="l21.88" class="difflineminus">-                    // cases where we actually got two points</span>
<a href="#l21.89"></a><span id="l21.89" class="difflineminus">-                    px = points[i];</span>
<a href="#l21.90"></a><span id="l21.90" class="difflineminus">-                    py = points[i + 1];</span>
<a href="#l21.91"></a><span id="l21.91" class="difflineminus">-                    qx = otherpoints[j];</span>
<a href="#l21.92"></a><span id="l21.92" class="difflineminus">-                    qy = otherpoints[j + 1];</span>
<a href="#l21.93"></a><span id="l21.93" class="difflineminus">-                    bottom = 0;</span>
<a href="#l21.94"></a><span id="l21.94" class="difflineminus">-</span>
<a href="#l21.95"></a><span id="l21.95" class="difflineminus">-                    if (px == qx) {</span>
<a href="#l21.96"></a><span id="l21.96" class="difflineminus">-                        for (m = 0; m &lt; ps; ++m)</span>
<a href="#l21.97"></a><span id="l21.97" class="difflineminus">-                            newpoints.push(points[i + m]);</span>
<a href="#l21.98"></a><span id="l21.98" class="difflineminus">-</span>
<a href="#l21.99"></a><span id="l21.99" class="difflineminus">-                        newpoints[l + 1] += qy;</span>
<a href="#l21.100"></a><span id="l21.100" class="difflineminus">-                        bottom = qy;</span>
<a href="#l21.101"></a><span id="l21.101" class="difflineminus">-                        </span>
<a href="#l21.102"></a><span id="l21.102" class="difflineminus">-                        i += ps;</span>
<a href="#l21.103"></a><span id="l21.103" class="difflineminus">-                        j += otherps;</span>
<a href="#l21.104"></a><span id="l21.104" class="difflineminus">-                    }</span>
<a href="#l21.105"></a><span id="l21.105" class="difflineminus">-                    else if (px &gt; qx) {</span>
<a href="#l21.106"></a><span id="l21.106" class="difflineminus">-                        // we got past point below, might need to</span>
<a href="#l21.107"></a><span id="l21.107" class="difflineminus">-                        // insert interpolated extra point</span>
<a href="#l21.108"></a><span id="l21.108" class="difflineminus">-                        if (withlines &amp;&amp; i &gt; 0 &amp;&amp; points[i - ps] != null) {</span>
<a href="#l21.109"></a><span id="l21.109" class="difflineminus">-                            intery = py + (points[i - ps + 1] - py) * (qx - px) / (points[i - ps] - px);</span>
<a href="#l21.110"></a><span id="l21.110" class="difflineminus">-                            newpoints.push(qx);</span>
<a href="#l21.111"></a><span id="l21.111" class="difflineminus">-                            newpoints.push(intery + qy)</span>
<a href="#l21.112"></a><span id="l21.112" class="difflineminus">-                            for (m = 2; m &lt; ps; ++m)</span>
<a href="#l21.113"></a><span id="l21.113" class="difflineminus">-                                newpoints.push(points[i + m]);</span>
<a href="#l21.114"></a><span id="l21.114" class="difflineminus">-                            bottom = qy; </span>
<a href="#l21.115"></a><span id="l21.115" class="difflineminus">-                        }</span>
<a href="#l21.116"></a><span id="l21.116" class="difflineminus">-</span>
<a href="#l21.117"></a><span id="l21.117" class="difflineminus">-                        j += otherps;</span>
<a href="#l21.118"></a><span id="l21.118" class="difflineminus">-                    }</span>
<a href="#l21.119"></a><span id="l21.119" class="difflineminus">-                    else {</span>
<a href="#l21.120"></a><span id="l21.120" class="difflineminus">-                        for (m = 0; m &lt; ps; ++m)</span>
<a href="#l21.121"></a><span id="l21.121" class="difflineminus">-                            newpoints.push(points[i + m]);</span>
<a href="#l21.122"></a><span id="l21.122" class="difflineminus">-                        </span>
<a href="#l21.123"></a><span id="l21.123" class="difflineminus">-                        // we might be able to interpolate a point below,</span>
<a href="#l21.124"></a><span id="l21.124" class="difflineminus">-                        // this can give us a better y</span>
<a href="#l21.125"></a><span id="l21.125" class="difflineminus">-                        if (withlines &amp;&amp; j &gt; 0 &amp;&amp; otherpoints[j - ps] != null)</span>
<a href="#l21.126"></a><span id="l21.126" class="difflineminus">-                            bottom = qy + (otherpoints[j - ps + 1] - qy) * (px - qx) / (otherpoints[j - ps] - qx);</span>
<a href="#l21.127"></a><span id="l21.127" class="difflineminus">-</span>
<a href="#l21.128"></a><span id="l21.128" class="difflineminus">-                        newpoints[l + 1] += bottom;</span>
<a href="#l21.129"></a><span id="l21.129" class="difflineminus">-                        </span>
<a href="#l21.130"></a><span id="l21.130" class="difflineminus">-                        i += ps;</span>
<a href="#l21.131"></a><span id="l21.131" class="difflineminus">-                    }</span>
<a href="#l21.132"></a><span id="l21.132" class="difflineminus">-                    </span>
<a href="#l21.133"></a><span id="l21.133" class="difflineminus">-                    if (l != newpoints.length &amp;&amp; withbars)</span>
<a href="#l21.134"></a><span id="l21.134" class="difflineminus">-                        newpoints[l + 2] += bottom;</span>
<a href="#l21.135"></a><span id="l21.135" class="difflineminus">-                }</span>
<a href="#l21.136"></a><span id="l21.136" class="difflineminus">-</span>
<a href="#l21.137"></a><span id="l21.137" class="difflineminus">-                // maintain the line steps invariant</span>
<a href="#l21.138"></a><span id="l21.138" class="difflineminus">-                if (withsteps &amp;&amp; l != newpoints.length &amp;&amp; l &gt; 0</span>
<a href="#l21.139"></a><span id="l21.139" class="difflineminus">-                    &amp;&amp; newpoints[l] != null</span>
<a href="#l21.140"></a><span id="l21.140" class="difflineminus">-                    &amp;&amp; newpoints[l] != newpoints[l - ps]</span>
<a href="#l21.141"></a><span id="l21.141" class="difflineminus">-                    &amp;&amp; newpoints[l + 1] != newpoints[l - ps + 1]) {</span>
<a href="#l21.142"></a><span id="l21.142" class="difflineminus">-                    for (m = 0; m &lt; ps; ++m)</span>
<a href="#l21.143"></a><span id="l21.143" class="difflineminus">-                        newpoints[l + ps + m] = newpoints[l + m];</span>
<a href="#l21.144"></a><span id="l21.144" class="difflineminus">-                    newpoints[l + 1] = newpoints[l - ps + 1];</span>
<a href="#l21.145"></a><span id="l21.145" class="difflineminus">-                }</span>
<a href="#l21.146"></a><span id="l21.146" class="difflineminus">-            }</span>
<a href="#l21.147"></a><span id="l21.147" class="difflineminus">-            </span>
<a href="#l21.148"></a><span id="l21.148" class="difflineminus">-            datapoints.points = newpoints;</span>
<a href="#l21.149"></a><span id="l21.149" class="difflineminus">-        }</span>
<a href="#l21.150"></a><span id="l21.150" class="difflineminus">-        </span>
<a href="#l21.151"></a><span id="l21.151" class="difflineminus">-        plot.hooks.processDatapoints.push(stackData);</span>
<a href="#l21.152"></a><span id="l21.152" class="difflineminus">-    }</span>
<a href="#l21.153"></a><span id="l21.153" class="difflineminus">-    </span>
<a href="#l21.154"></a><span id="l21.154" class="difflineminus">-    $.plot.plugins.push({</span>
<a href="#l21.155"></a><span id="l21.155" class="difflineminus">-        init: init,</span>
<a href="#l21.156"></a><span id="l21.156" class="difflineminus">-        options: options,</span>
<a href="#l21.157"></a><span id="l21.157" class="difflineminus">-        name: 'stack',</span>
<a href="#l21.158"></a><span id="l21.158" class="difflineminus">-        version: '1.0'</span>
<a href="#l21.159"></a><span id="l21.159" class="difflineminus">-    });</span>
<a href="#l21.160"></a><span id="l21.160" class="difflineminus">-})(jQuery);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1">deleted file mode 100644</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.flot.threshold.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineplus">+++ /dev/null</span>
<a href="#l22.4"></a><span id="l22.4" class="difflineat">@@ -1,107 +0,0 @@</span>
<a href="#l22.5"></a><span id="l22.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l22.6"></a><span id="l22.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l22.7"></a><span id="l22.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l22.8"></a><span id="l22.8" class="difflineminus">-</span>
<a href="#l22.9"></a><span id="l22.9" class="difflineminus">-/*</span>
<a href="#l22.10"></a><span id="l22.10" class="difflineminus">-Flot plugin for thresholding data. Controlled through the option</span>
<a href="#l22.11"></a><span id="l22.11" class="difflineminus">-&quot;threshold&quot; in either the global series options</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineminus">-  series: {</span>
<a href="#l22.14"></a><span id="l22.14" class="difflineminus">-    threshold: {</span>
<a href="#l22.15"></a><span id="l22.15" class="difflineminus">-      below: number</span>
<a href="#l22.16"></a><span id="l22.16" class="difflineminus">-      color: colorspec</span>
<a href="#l22.17"></a><span id="l22.17" class="difflineminus">-    }</span>
<a href="#l22.18"></a><span id="l22.18" class="difflineminus">-  }</span>
<a href="#l22.19"></a><span id="l22.19" class="difflineminus">-</span>
<a href="#l22.20"></a><span id="l22.20" class="difflineminus">-or in a specific series</span>
<a href="#l22.21"></a><span id="l22.21" class="difflineminus">-</span>
<a href="#l22.22"></a><span id="l22.22" class="difflineminus">-  $.plot($(&quot;#placeholder&quot;), [{ data: [ ... ], threshold: { ... }}])</span>
<a href="#l22.23"></a><span id="l22.23" class="difflineminus">-</span>
<a href="#l22.24"></a><span id="l22.24" class="difflineminus">-The data points below &quot;below&quot; are drawn with the specified color. This</span>
<a href="#l22.25"></a><span id="l22.25" class="difflineminus">-makes it easy to mark points below 0, e.g. for budget data.</span>
<a href="#l22.26"></a><span id="l22.26" class="difflineminus">-</span>
<a href="#l22.27"></a><span id="l22.27" class="difflineminus">-Internally, the plugin works by splitting the data into two series,</span>
<a href="#l22.28"></a><span id="l22.28" class="difflineminus">-above and below the threshold. The extra series below the threshold</span>
<a href="#l22.29"></a><span id="l22.29" class="difflineminus">-will have its label cleared and the special &quot;originSeries&quot; attribute</span>
<a href="#l22.30"></a><span id="l22.30" class="difflineminus">-set to the original series. You may need to check for this in hover</span>
<a href="#l22.31"></a><span id="l22.31" class="difflineminus">-events.</span>
<a href="#l22.32"></a><span id="l22.32" class="difflineminus">-*/</span>
<a href="#l22.33"></a><span id="l22.33" class="difflineminus">-</span>
<a href="#l22.34"></a><span id="l22.34" class="difflineminus">-(function ($) {</span>
<a href="#l22.35"></a><span id="l22.35" class="difflineminus">-    var options = {</span>
<a href="#l22.36"></a><span id="l22.36" class="difflineminus">-        series: { threshold: null } // or { below: number, color: color spec}</span>
<a href="#l22.37"></a><span id="l22.37" class="difflineminus">-    };</span>
<a href="#l22.38"></a><span id="l22.38" class="difflineminus">-    </span>
<a href="#l22.39"></a><span id="l22.39" class="difflineminus">-    function init(plot) {</span>
<a href="#l22.40"></a><span id="l22.40" class="difflineminus">-        function thresholdData(plot, s, datapoints) {</span>
<a href="#l22.41"></a><span id="l22.41" class="difflineminus">-            if (!s.threshold)</span>
<a href="#l22.42"></a><span id="l22.42" class="difflineminus">-                return;</span>
<a href="#l22.43"></a><span id="l22.43" class="difflineminus">-            </span>
<a href="#l22.44"></a><span id="l22.44" class="difflineminus">-            var ps = datapoints.pointsize, i, x, y, p, prevp,</span>
<a href="#l22.45"></a><span id="l22.45" class="difflineminus">-                thresholded = $.extend({}, s); // note: shallow copy</span>
<a href="#l22.46"></a><span id="l22.46" class="difflineminus">-</span>
<a href="#l22.47"></a><span id="l22.47" class="difflineminus">-            thresholded.datapoints = { points: [], pointsize: ps };</span>
<a href="#l22.48"></a><span id="l22.48" class="difflineminus">-            thresholded.label = null;</span>
<a href="#l22.49"></a><span id="l22.49" class="difflineminus">-            thresholded.color = s.threshold.color;</span>
<a href="#l22.50"></a><span id="l22.50" class="difflineminus">-            thresholded.threshold = null;</span>
<a href="#l22.51"></a><span id="l22.51" class="difflineminus">-            thresholded.originSeries = s;</span>
<a href="#l22.52"></a><span id="l22.52" class="difflineminus">-            thresholded.data = [];</span>
<a href="#l22.53"></a><span id="l22.53" class="difflineminus">-</span>
<a href="#l22.54"></a><span id="l22.54" class="difflineminus">-            var below = s.threshold.below,</span>
<a href="#l22.55"></a><span id="l22.55" class="difflineminus">-                origpoints = datapoints.points,</span>
<a href="#l22.56"></a><span id="l22.56" class="difflineminus">-                addCrossingPoints = s.lines.show;</span>
<a href="#l22.57"></a><span id="l22.57" class="difflineminus">-</span>
<a href="#l22.58"></a><span id="l22.58" class="difflineminus">-            threspoints = [];</span>
<a href="#l22.59"></a><span id="l22.59" class="difflineminus">-            newpoints = [];</span>
<a href="#l22.60"></a><span id="l22.60" class="difflineminus">-</span>
<a href="#l22.61"></a><span id="l22.61" class="difflineminus">-            for (i = 0; i &lt; origpoints.length; i += ps) {</span>
<a href="#l22.62"></a><span id="l22.62" class="difflineminus">-                x = origpoints[i]</span>
<a href="#l22.63"></a><span id="l22.63" class="difflineminus">-                y = origpoints[i + 1];</span>
<a href="#l22.64"></a><span id="l22.64" class="difflineminus">-</span>
<a href="#l22.65"></a><span id="l22.65" class="difflineminus">-                prevp = p;</span>
<a href="#l22.66"></a><span id="l22.66" class="difflineminus">-                if (y &lt; below)</span>
<a href="#l22.67"></a><span id="l22.67" class="difflineminus">-                    p = threspoints;</span>
<a href="#l22.68"></a><span id="l22.68" class="difflineminus">-                else</span>
<a href="#l22.69"></a><span id="l22.69" class="difflineminus">-                    p = newpoints;</span>
<a href="#l22.70"></a><span id="l22.70" class="difflineminus">-</span>
<a href="#l22.71"></a><span id="l22.71" class="difflineminus">-                if (addCrossingPoints &amp;&amp; prevp != p &amp;&amp; x != null</span>
<a href="#l22.72"></a><span id="l22.72" class="difflineminus">-                    &amp;&amp; i &gt; 0 &amp;&amp; origpoints[i - ps] != null) {</span>
<a href="#l22.73"></a><span id="l22.73" class="difflineminus">-                    var interx = (x - origpoints[i - ps]) / (y - origpoints[i - ps + 1]) * (below - y) + x;</span>
<a href="#l22.74"></a><span id="l22.74" class="difflineminus">-                    prevp.push(interx);</span>
<a href="#l22.75"></a><span id="l22.75" class="difflineminus">-                    prevp.push(below);</span>
<a href="#l22.76"></a><span id="l22.76" class="difflineminus">-                    for (m = 2; m &lt; ps; ++m)</span>
<a href="#l22.77"></a><span id="l22.77" class="difflineminus">-                        prevp.push(origpoints[i + m]);</span>
<a href="#l22.78"></a><span id="l22.78" class="difflineminus">-                    </span>
<a href="#l22.79"></a><span id="l22.79" class="difflineminus">-                    p.push(null); // start new segment</span>
<a href="#l22.80"></a><span id="l22.80" class="difflineminus">-                    p.push(null);</span>
<a href="#l22.81"></a><span id="l22.81" class="difflineminus">-                    for (m = 2; m &lt; ps; ++m)</span>
<a href="#l22.82"></a><span id="l22.82" class="difflineminus">-                        p.push(origpoints[i + m]);</span>
<a href="#l22.83"></a><span id="l22.83" class="difflineminus">-                    p.push(interx);</span>
<a href="#l22.84"></a><span id="l22.84" class="difflineminus">-                    p.push(below);</span>
<a href="#l22.85"></a><span id="l22.85" class="difflineminus">-                    for (m = 2; m &lt; ps; ++m)</span>
<a href="#l22.86"></a><span id="l22.86" class="difflineminus">-                        p.push(origpoints[i + m]);</span>
<a href="#l22.87"></a><span id="l22.87" class="difflineminus">-                }</span>
<a href="#l22.88"></a><span id="l22.88" class="difflineminus">-</span>
<a href="#l22.89"></a><span id="l22.89" class="difflineminus">-                p.push(x);</span>
<a href="#l22.90"></a><span id="l22.90" class="difflineminus">-                p.push(y);</span>
<a href="#l22.91"></a><span id="l22.91" class="difflineminus">-            }</span>
<a href="#l22.92"></a><span id="l22.92" class="difflineminus">-</span>
<a href="#l22.93"></a><span id="l22.93" class="difflineminus">-            datapoints.points = newpoints;</span>
<a href="#l22.94"></a><span id="l22.94" class="difflineminus">-            thresholded.datapoints.points = threspoints;</span>
<a href="#l22.95"></a><span id="l22.95" class="difflineminus">-            </span>
<a href="#l22.96"></a><span id="l22.96" class="difflineminus">-            if (thresholded.datapoints.points.length &gt; 0)</span>
<a href="#l22.97"></a><span id="l22.97" class="difflineminus">-                plot.getData().push(thresholded);</span>
<a href="#l22.98"></a><span id="l22.98" class="difflineminus">-                </span>
<a href="#l22.99"></a><span id="l22.99" class="difflineminus">-            // FIXME: there are probably some edge cases left in bars</span>
<a href="#l22.100"></a><span id="l22.100" class="difflineminus">-        }</span>
<a href="#l22.101"></a><span id="l22.101" class="difflineminus">-        </span>
<a href="#l22.102"></a><span id="l22.102" class="difflineminus">-        plot.hooks.processDatapoints.push(thresholdData);</span>
<a href="#l22.103"></a><span id="l22.103" class="difflineminus">-    }</span>
<a href="#l22.104"></a><span id="l22.104" class="difflineminus">-    </span>
<a href="#l22.105"></a><span id="l22.105" class="difflineminus">-    $.plot.plugins.push({</span>
<a href="#l22.106"></a><span id="l22.106" class="difflineminus">-        init: init,</span>
<a href="#l22.107"></a><span id="l22.107" class="difflineminus">-        options: options,</span>
<a href="#l22.108"></a><span id="l22.108" class="difflineminus">-        name: 'threshold',</span>
<a href="#l22.109"></a><span id="l22.109" class="difflineminus">-        version: '1.0'</span>
<a href="#l22.110"></a><span id="l22.110" class="difflineminus">-    });</span>
<a href="#l22.111"></a><span id="l22.111" class="difflineminus">-})(jQuery);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1">deleted file mode 100644</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/flot/jquery.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineplus">+++ /dev/null</span>
<a href="#l23.4"></a><span id="l23.4" class="difflineat">@@ -1,4376 +0,0 @@</span>
<a href="#l23.5"></a><span id="l23.5" class="difflineminus">-/*!</span>
<a href="#l23.6"></a><span id="l23.6" class="difflineminus">- * jQuery JavaScript Library v1.3.2</span>
<a href="#l23.7"></a><span id="l23.7" class="difflineminus">- * http://jquery.com/</span>
<a href="#l23.8"></a><span id="l23.8" class="difflineminus">- *</span>
<a href="#l23.9"></a><span id="l23.9" class="difflineminus">- * Copyright (c) 2009 John Resig</span>
<a href="#l23.10"></a><span id="l23.10" class="difflineminus">- * Dual licensed under the MIT and GPL licenses.</span>
<a href="#l23.11"></a><span id="l23.11" class="difflineminus">- * http://docs.jquery.com/License</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">- *</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineminus">- * Date: 2009-02-19 17:34:21 -0500 (Thu, 19 Feb 2009)</span>
<a href="#l23.14"></a><span id="l23.14" class="difflineminus">- * Revision: 6246</span>
<a href="#l23.15"></a><span id="l23.15" class="difflineminus">- */</span>
<a href="#l23.16"></a><span id="l23.16" class="difflineminus">-(function(){</span>
<a href="#l23.17"></a><span id="l23.17" class="difflineminus">-</span>
<a href="#l23.18"></a><span id="l23.18" class="difflineminus">-var </span>
<a href="#l23.19"></a><span id="l23.19" class="difflineminus">-	// Will speed up references to window, and allows munging its name.</span>
<a href="#l23.20"></a><span id="l23.20" class="difflineminus">-	window = this,</span>
<a href="#l23.21"></a><span id="l23.21" class="difflineminus">-	// Will speed up references to undefined, and allows munging its name.</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineminus">-	undefined,</span>
<a href="#l23.23"></a><span id="l23.23" class="difflineminus">-	// Map over jQuery in case of overwrite</span>
<a href="#l23.24"></a><span id="l23.24" class="difflineminus">-	_jQuery = window.jQuery,</span>
<a href="#l23.25"></a><span id="l23.25" class="difflineminus">-	// Map over the $ in case of overwrite</span>
<a href="#l23.26"></a><span id="l23.26" class="difflineminus">-	_$ = window.$,</span>
<a href="#l23.27"></a><span id="l23.27" class="difflineminus">-</span>
<a href="#l23.28"></a><span id="l23.28" class="difflineminus">-	jQuery = window.jQuery = window.$ = function( selector, context ) {</span>
<a href="#l23.29"></a><span id="l23.29" class="difflineminus">-		// The jQuery object is actually just the init constructor 'enhanced'</span>
<a href="#l23.30"></a><span id="l23.30" class="difflineminus">-		return new jQuery.fn.init( selector, context );</span>
<a href="#l23.31"></a><span id="l23.31" class="difflineminus">-	},</span>
<a href="#l23.32"></a><span id="l23.32" class="difflineminus">-</span>
<a href="#l23.33"></a><span id="l23.33" class="difflineminus">-	// A simple way to check for HTML strings or ID strings</span>
<a href="#l23.34"></a><span id="l23.34" class="difflineminus">-	// (both of which we optimize for)</span>
<a href="#l23.35"></a><span id="l23.35" class="difflineminus">-	quickExpr = /^[^&lt;]*(&lt;(.|\s)+&gt;)[^&gt;]*$|^#([\w-]+)$/,</span>
<a href="#l23.36"></a><span id="l23.36" class="difflineminus">-	// Is it a simple selector</span>
<a href="#l23.37"></a><span id="l23.37" class="difflineminus">-	isSimple = /^.[^:#\[\.,]*$/;</span>
<a href="#l23.38"></a><span id="l23.38" class="difflineminus">-</span>
<a href="#l23.39"></a><span id="l23.39" class="difflineminus">-jQuery.fn = jQuery.prototype = {</span>
<a href="#l23.40"></a><span id="l23.40" class="difflineminus">-	init: function( selector, context ) {</span>
<a href="#l23.41"></a><span id="l23.41" class="difflineminus">-		// Make sure that a selection was provided</span>
<a href="#l23.42"></a><span id="l23.42" class="difflineminus">-		selector = selector || document;</span>
<a href="#l23.43"></a><span id="l23.43" class="difflineminus">-</span>
<a href="#l23.44"></a><span id="l23.44" class="difflineminus">-		// Handle $(DOMElement)</span>
<a href="#l23.45"></a><span id="l23.45" class="difflineminus">-		if ( selector.nodeType ) {</span>
<a href="#l23.46"></a><span id="l23.46" class="difflineminus">-			this[0] = selector;</span>
<a href="#l23.47"></a><span id="l23.47" class="difflineminus">-			this.length = 1;</span>
<a href="#l23.48"></a><span id="l23.48" class="difflineminus">-			this.context = selector;</span>
<a href="#l23.49"></a><span id="l23.49" class="difflineminus">-			return this;</span>
<a href="#l23.50"></a><span id="l23.50" class="difflineminus">-		}</span>
<a href="#l23.51"></a><span id="l23.51" class="difflineminus">-		// Handle HTML strings</span>
<a href="#l23.52"></a><span id="l23.52" class="difflineminus">-		if ( typeof selector === &quot;string&quot; ) {</span>
<a href="#l23.53"></a><span id="l23.53" class="difflineminus">-			// Are we dealing with HTML string or an ID?</span>
<a href="#l23.54"></a><span id="l23.54" class="difflineminus">-			var match = quickExpr.exec( selector );</span>
<a href="#l23.55"></a><span id="l23.55" class="difflineminus">-</span>
<a href="#l23.56"></a><span id="l23.56" class="difflineminus">-			// Verify a match, and that no context was specified for #id</span>
<a href="#l23.57"></a><span id="l23.57" class="difflineminus">-			if ( match &amp;&amp; (match[1] || !context) ) {</span>
<a href="#l23.58"></a><span id="l23.58" class="difflineminus">-</span>
<a href="#l23.59"></a><span id="l23.59" class="difflineminus">-				// HANDLE: $(html) -&gt; $(array)</span>
<a href="#l23.60"></a><span id="l23.60" class="difflineminus">-				if ( match[1] )</span>
<a href="#l23.61"></a><span id="l23.61" class="difflineminus">-					selector = jQuery.clean( [ match[1] ], context );</span>
<a href="#l23.62"></a><span id="l23.62" class="difflineminus">-</span>
<a href="#l23.63"></a><span id="l23.63" class="difflineminus">-				// HANDLE: $(&quot;#id&quot;)</span>
<a href="#l23.64"></a><span id="l23.64" class="difflineminus">-				else {</span>
<a href="#l23.65"></a><span id="l23.65" class="difflineminus">-					var elem = document.getElementById( match[3] );</span>
<a href="#l23.66"></a><span id="l23.66" class="difflineminus">-</span>
<a href="#l23.67"></a><span id="l23.67" class="difflineminus">-					// Handle the case where IE and Opera return items</span>
<a href="#l23.68"></a><span id="l23.68" class="difflineminus">-					// by name instead of ID</span>
<a href="#l23.69"></a><span id="l23.69" class="difflineminus">-					if ( elem &amp;&amp; elem.id != match[3] )</span>
<a href="#l23.70"></a><span id="l23.70" class="difflineminus">-						return jQuery().find( selector );</span>
<a href="#l23.71"></a><span id="l23.71" class="difflineminus">-</span>
<a href="#l23.72"></a><span id="l23.72" class="difflineminus">-					// Otherwise, we inject the element directly into the jQuery object</span>
<a href="#l23.73"></a><span id="l23.73" class="difflineminus">-					var ret = jQuery( elem || [] );</span>
<a href="#l23.74"></a><span id="l23.74" class="difflineminus">-					ret.context = document;</span>
<a href="#l23.75"></a><span id="l23.75" class="difflineminus">-					ret.selector = selector;</span>
<a href="#l23.76"></a><span id="l23.76" class="difflineminus">-					return ret;</span>
<a href="#l23.77"></a><span id="l23.77" class="difflineminus">-				}</span>
<a href="#l23.78"></a><span id="l23.78" class="difflineminus">-</span>
<a href="#l23.79"></a><span id="l23.79" class="difflineminus">-			// HANDLE: $(expr, [context])</span>
<a href="#l23.80"></a><span id="l23.80" class="difflineminus">-			// (which is just equivalent to: $(content).find(expr)</span>
<a href="#l23.81"></a><span id="l23.81" class="difflineminus">-			} else</span>
<a href="#l23.82"></a><span id="l23.82" class="difflineminus">-				return jQuery( context ).find( selector );</span>
<a href="#l23.83"></a><span id="l23.83" class="difflineminus">-</span>
<a href="#l23.84"></a><span id="l23.84" class="difflineminus">-		// HANDLE: $(function)</span>
<a href="#l23.85"></a><span id="l23.85" class="difflineminus">-		// Shortcut for document ready</span>
<a href="#l23.86"></a><span id="l23.86" class="difflineminus">-		} else if ( jQuery.isFunction( selector ) )</span>
<a href="#l23.87"></a><span id="l23.87" class="difflineminus">-			return jQuery( document ).ready( selector );</span>
<a href="#l23.88"></a><span id="l23.88" class="difflineminus">-</span>
<a href="#l23.89"></a><span id="l23.89" class="difflineminus">-		// Make sure that old selector state is passed along</span>
<a href="#l23.90"></a><span id="l23.90" class="difflineminus">-		if ( selector.selector &amp;&amp; selector.context ) {</span>
<a href="#l23.91"></a><span id="l23.91" class="difflineminus">-			this.selector = selector.selector;</span>
<a href="#l23.92"></a><span id="l23.92" class="difflineminus">-			this.context = selector.context;</span>
<a href="#l23.93"></a><span id="l23.93" class="difflineminus">-		}</span>
<a href="#l23.94"></a><span id="l23.94" class="difflineminus">-</span>
<a href="#l23.95"></a><span id="l23.95" class="difflineminus">-		return this.setArray(jQuery.isArray( selector ) ?</span>
<a href="#l23.96"></a><span id="l23.96" class="difflineminus">-			selector :</span>
<a href="#l23.97"></a><span id="l23.97" class="difflineminus">-			jQuery.makeArray(selector));</span>
<a href="#l23.98"></a><span id="l23.98" class="difflineminus">-	},</span>
<a href="#l23.99"></a><span id="l23.99" class="difflineminus">-</span>
<a href="#l23.100"></a><span id="l23.100" class="difflineminus">-	// Start with an empty selector</span>
<a href="#l23.101"></a><span id="l23.101" class="difflineminus">-	selector: &quot;&quot;,</span>
<a href="#l23.102"></a><span id="l23.102" class="difflineminus">-</span>
<a href="#l23.103"></a><span id="l23.103" class="difflineminus">-	// The current version of jQuery being used</span>
<a href="#l23.104"></a><span id="l23.104" class="difflineminus">-	jquery: &quot;1.3.2&quot;,</span>
<a href="#l23.105"></a><span id="l23.105" class="difflineminus">-</span>
<a href="#l23.106"></a><span id="l23.106" class="difflineminus">-	// The number of elements contained in the matched element set</span>
<a href="#l23.107"></a><span id="l23.107" class="difflineminus">-	size: function() {</span>
<a href="#l23.108"></a><span id="l23.108" class="difflineminus">-		return this.length;</span>
<a href="#l23.109"></a><span id="l23.109" class="difflineminus">-	},</span>
<a href="#l23.110"></a><span id="l23.110" class="difflineminus">-</span>
<a href="#l23.111"></a><span id="l23.111" class="difflineminus">-	// Get the Nth element in the matched element set OR</span>
<a href="#l23.112"></a><span id="l23.112" class="difflineminus">-	// Get the whole matched element set as a clean array</span>
<a href="#l23.113"></a><span id="l23.113" class="difflineminus">-	get: function( num ) {</span>
<a href="#l23.114"></a><span id="l23.114" class="difflineminus">-		return num === undefined ?</span>
<a href="#l23.115"></a><span id="l23.115" class="difflineminus">-</span>
<a href="#l23.116"></a><span id="l23.116" class="difflineminus">-			// Return a 'clean' array</span>
<a href="#l23.117"></a><span id="l23.117" class="difflineminus">-			Array.prototype.slice.call( this ) :</span>
<a href="#l23.118"></a><span id="l23.118" class="difflineminus">-</span>
<a href="#l23.119"></a><span id="l23.119" class="difflineminus">-			// Return just the object</span>
<a href="#l23.120"></a><span id="l23.120" class="difflineminus">-			this[ num ];</span>
<a href="#l23.121"></a><span id="l23.121" class="difflineminus">-	},</span>
<a href="#l23.122"></a><span id="l23.122" class="difflineminus">-</span>
<a href="#l23.123"></a><span id="l23.123" class="difflineminus">-	// Take an array of elements and push it onto the stack</span>
<a href="#l23.124"></a><span id="l23.124" class="difflineminus">-	// (returning the new matched element set)</span>
<a href="#l23.125"></a><span id="l23.125" class="difflineminus">-	pushStack: function( elems, name, selector ) {</span>
<a href="#l23.126"></a><span id="l23.126" class="difflineminus">-		// Build a new jQuery matched element set</span>
<a href="#l23.127"></a><span id="l23.127" class="difflineminus">-		var ret = jQuery( elems );</span>
<a href="#l23.128"></a><span id="l23.128" class="difflineminus">-</span>
<a href="#l23.129"></a><span id="l23.129" class="difflineminus">-		// Add the old object onto the stack (as a reference)</span>
<a href="#l23.130"></a><span id="l23.130" class="difflineminus">-		ret.prevObject = this;</span>
<a href="#l23.131"></a><span id="l23.131" class="difflineminus">-</span>
<a href="#l23.132"></a><span id="l23.132" class="difflineminus">-		ret.context = this.context;</span>
<a href="#l23.133"></a><span id="l23.133" class="difflineminus">-</span>
<a href="#l23.134"></a><span id="l23.134" class="difflineminus">-		if ( name === &quot;find&quot; )</span>
<a href="#l23.135"></a><span id="l23.135" class="difflineminus">-			ret.selector = this.selector + (this.selector ? &quot; &quot; : &quot;&quot;) + selector;</span>
<a href="#l23.136"></a><span id="l23.136" class="difflineminus">-		else if ( name )</span>
<a href="#l23.137"></a><span id="l23.137" class="difflineminus">-			ret.selector = this.selector + &quot;.&quot; + name + &quot;(&quot; + selector + &quot;)&quot;;</span>
<a href="#l23.138"></a><span id="l23.138" class="difflineminus">-</span>
<a href="#l23.139"></a><span id="l23.139" class="difflineminus">-		// Return the newly-formed element set</span>
<a href="#l23.140"></a><span id="l23.140" class="difflineminus">-		return ret;</span>
<a href="#l23.141"></a><span id="l23.141" class="difflineminus">-	},</span>
<a href="#l23.142"></a><span id="l23.142" class="difflineminus">-</span>
<a href="#l23.143"></a><span id="l23.143" class="difflineminus">-	// Force the current matched set of elements to become</span>
<a href="#l23.144"></a><span id="l23.144" class="difflineminus">-	// the specified array of elements (destroying the stack in the process)</span>
<a href="#l23.145"></a><span id="l23.145" class="difflineminus">-	// You should use pushStack() in order to do this, but maintain the stack</span>
<a href="#l23.146"></a><span id="l23.146" class="difflineminus">-	setArray: function( elems ) {</span>
<a href="#l23.147"></a><span id="l23.147" class="difflineminus">-		// Resetting the length to 0, then using the native Array push</span>
<a href="#l23.148"></a><span id="l23.148" class="difflineminus">-		// is a super-fast way to populate an object with array-like properties</span>
<a href="#l23.149"></a><span id="l23.149" class="difflineminus">-		this.length = 0;</span>
<a href="#l23.150"></a><span id="l23.150" class="difflineminus">-		Array.prototype.push.apply( this, elems );</span>
<a href="#l23.151"></a><span id="l23.151" class="difflineminus">-</span>
<a href="#l23.152"></a><span id="l23.152" class="difflineminus">-		return this;</span>
<a href="#l23.153"></a><span id="l23.153" class="difflineminus">-	},</span>
<a href="#l23.154"></a><span id="l23.154" class="difflineminus">-</span>
<a href="#l23.155"></a><span id="l23.155" class="difflineminus">-	// Execute a callback for every element in the matched set.</span>
<a href="#l23.156"></a><span id="l23.156" class="difflineminus">-	// (You can seed the arguments with an array of args, but this is</span>
<a href="#l23.157"></a><span id="l23.157" class="difflineminus">-	// only used internally.)</span>
<a href="#l23.158"></a><span id="l23.158" class="difflineminus">-	each: function( callback, args ) {</span>
<a href="#l23.159"></a><span id="l23.159" class="difflineminus">-		return jQuery.each( this, callback, args );</span>
<a href="#l23.160"></a><span id="l23.160" class="difflineminus">-	},</span>
<a href="#l23.161"></a><span id="l23.161" class="difflineminus">-</span>
<a href="#l23.162"></a><span id="l23.162" class="difflineminus">-	// Determine the position of an element within</span>
<a href="#l23.163"></a><span id="l23.163" class="difflineminus">-	// the matched set of elements</span>
<a href="#l23.164"></a><span id="l23.164" class="difflineminus">-	index: function( elem ) {</span>
<a href="#l23.165"></a><span id="l23.165" class="difflineminus">-		// Locate the position of the desired element</span>
<a href="#l23.166"></a><span id="l23.166" class="difflineminus">-		return jQuery.inArray(</span>
<a href="#l23.167"></a><span id="l23.167" class="difflineminus">-			// If it receives a jQuery object, the first element is used</span>
<a href="#l23.168"></a><span id="l23.168" class="difflineminus">-			elem &amp;&amp; elem.jquery ? elem[0] : elem</span>
<a href="#l23.169"></a><span id="l23.169" class="difflineminus">-		, this );</span>
<a href="#l23.170"></a><span id="l23.170" class="difflineminus">-	},</span>
<a href="#l23.171"></a><span id="l23.171" class="difflineminus">-</span>
<a href="#l23.172"></a><span id="l23.172" class="difflineminus">-	attr: function( name, value, type ) {</span>
<a href="#l23.173"></a><span id="l23.173" class="difflineminus">-		var options = name;</span>
<a href="#l23.174"></a><span id="l23.174" class="difflineminus">-</span>
<a href="#l23.175"></a><span id="l23.175" class="difflineminus">-		// Look for the case where we're accessing a style value</span>
<a href="#l23.176"></a><span id="l23.176" class="difflineminus">-		if ( typeof name === &quot;string&quot; )</span>
<a href="#l23.177"></a><span id="l23.177" class="difflineminus">-			if ( value === undefined )</span>
<a href="#l23.178"></a><span id="l23.178" class="difflineminus">-				return this[0] &amp;&amp; jQuery[ type || &quot;attr&quot; ]( this[0], name );</span>
<a href="#l23.179"></a><span id="l23.179" class="difflineminus">-</span>
<a href="#l23.180"></a><span id="l23.180" class="difflineminus">-			else {</span>
<a href="#l23.181"></a><span id="l23.181" class="difflineminus">-				options = {};</span>
<a href="#l23.182"></a><span id="l23.182" class="difflineminus">-				options[ name ] = value;</span>
<a href="#l23.183"></a><span id="l23.183" class="difflineminus">-			}</span>
<a href="#l23.184"></a><span id="l23.184" class="difflineminus">-</span>
<a href="#l23.185"></a><span id="l23.185" class="difflineminus">-		// Check to see if we're setting style values</span>
<a href="#l23.186"></a><span id="l23.186" class="difflineminus">-		return this.each(function(i){</span>
<a href="#l23.187"></a><span id="l23.187" class="difflineminus">-			// Set all the styles</span>
<a href="#l23.188"></a><span id="l23.188" class="difflineminus">-			for ( name in options )</span>
<a href="#l23.189"></a><span id="l23.189" class="difflineminus">-				jQuery.attr(</span>
<a href="#l23.190"></a><span id="l23.190" class="difflineminus">-					type ?</span>
<a href="#l23.191"></a><span id="l23.191" class="difflineminus">-						this.style :</span>
<a href="#l23.192"></a><span id="l23.192" class="difflineminus">-						this,</span>
<a href="#l23.193"></a><span id="l23.193" class="difflineminus">-					name, jQuery.prop( this, options[ name ], type, i, name )</span>
<a href="#l23.194"></a><span id="l23.194" class="difflineminus">-				);</span>
<a href="#l23.195"></a><span id="l23.195" class="difflineminus">-		});</span>
<a href="#l23.196"></a><span id="l23.196" class="difflineminus">-	},</span>
<a href="#l23.197"></a><span id="l23.197" class="difflineminus">-</span>
<a href="#l23.198"></a><span id="l23.198" class="difflineminus">-	css: function( key, value ) {</span>
<a href="#l23.199"></a><span id="l23.199" class="difflineminus">-		// ignore negative width and height values</span>
<a href="#l23.200"></a><span id="l23.200" class="difflineminus">-		if ( (key == 'width' || key == 'height') &amp;&amp; parseFloat(value) &lt; 0 )</span>
<a href="#l23.201"></a><span id="l23.201" class="difflineminus">-			value = undefined;</span>
<a href="#l23.202"></a><span id="l23.202" class="difflineminus">-		return this.attr( key, value, &quot;curCSS&quot; );</span>
<a href="#l23.203"></a><span id="l23.203" class="difflineminus">-	},</span>
<a href="#l23.204"></a><span id="l23.204" class="difflineminus">-</span>
<a href="#l23.205"></a><span id="l23.205" class="difflineminus">-	text: function( text ) {</span>
<a href="#l23.206"></a><span id="l23.206" class="difflineminus">-		if ( typeof text !== &quot;object&quot; &amp;&amp; text != null )</span>
<a href="#l23.207"></a><span id="l23.207" class="difflineminus">-			return this.empty().append( (this[0] &amp;&amp; this[0].ownerDocument || document).createTextNode( text ) );</span>
<a href="#l23.208"></a><span id="l23.208" class="difflineminus">-</span>
<a href="#l23.209"></a><span id="l23.209" class="difflineminus">-		var ret = &quot;&quot;;</span>
<a href="#l23.210"></a><span id="l23.210" class="difflineminus">-</span>
<a href="#l23.211"></a><span id="l23.211" class="difflineminus">-		jQuery.each( text || this, function(){</span>
<a href="#l23.212"></a><span id="l23.212" class="difflineminus">-			jQuery.each( this.childNodes, function(){</span>
<a href="#l23.213"></a><span id="l23.213" class="difflineminus">-				if ( this.nodeType != 8 )</span>
<a href="#l23.214"></a><span id="l23.214" class="difflineminus">-					ret += this.nodeType != 1 ?</span>
<a href="#l23.215"></a><span id="l23.215" class="difflineminus">-						this.nodeValue :</span>
<a href="#l23.216"></a><span id="l23.216" class="difflineminus">-						jQuery.fn.text( [ this ] );</span>
<a href="#l23.217"></a><span id="l23.217" class="difflineminus">-			});</span>
<a href="#l23.218"></a><span id="l23.218" class="difflineminus">-		});</span>
<a href="#l23.219"></a><span id="l23.219" class="difflineminus">-</span>
<a href="#l23.220"></a><span id="l23.220" class="difflineminus">-		return ret;</span>
<a href="#l23.221"></a><span id="l23.221" class="difflineminus">-	},</span>
<a href="#l23.222"></a><span id="l23.222" class="difflineminus">-</span>
<a href="#l23.223"></a><span id="l23.223" class="difflineminus">-	wrapAll: function( html ) {</span>
<a href="#l23.224"></a><span id="l23.224" class="difflineminus">-		if ( this[0] ) {</span>
<a href="#l23.225"></a><span id="l23.225" class="difflineminus">-			// The elements to wrap the target around</span>
<a href="#l23.226"></a><span id="l23.226" class="difflineminus">-			var wrap = jQuery( html, this[0].ownerDocument ).clone();</span>
<a href="#l23.227"></a><span id="l23.227" class="difflineminus">-</span>
<a href="#l23.228"></a><span id="l23.228" class="difflineminus">-			if ( this[0].parentNode )</span>
<a href="#l23.229"></a><span id="l23.229" class="difflineminus">-				wrap.insertBefore( this[0] );</span>
<a href="#l23.230"></a><span id="l23.230" class="difflineminus">-</span>
<a href="#l23.231"></a><span id="l23.231" class="difflineminus">-			wrap.map(function(){</span>
<a href="#l23.232"></a><span id="l23.232" class="difflineminus">-				var elem = this;</span>
<a href="#l23.233"></a><span id="l23.233" class="difflineminus">-</span>
<a href="#l23.234"></a><span id="l23.234" class="difflineminus">-				while ( elem.firstChild )</span>
<a href="#l23.235"></a><span id="l23.235" class="difflineminus">-					elem = elem.firstChild;</span>
<a href="#l23.236"></a><span id="l23.236" class="difflineminus">-</span>
<a href="#l23.237"></a><span id="l23.237" class="difflineminus">-				return elem;</span>
<a href="#l23.238"></a><span id="l23.238" class="difflineminus">-			}).append(this);</span>
<a href="#l23.239"></a><span id="l23.239" class="difflineminus">-		}</span>
<a href="#l23.240"></a><span id="l23.240" class="difflineminus">-</span>
<a href="#l23.241"></a><span id="l23.241" class="difflineminus">-		return this;</span>
<a href="#l23.242"></a><span id="l23.242" class="difflineminus">-	},</span>
<a href="#l23.243"></a><span id="l23.243" class="difflineminus">-</span>
<a href="#l23.244"></a><span id="l23.244" class="difflineminus">-	wrapInner: function( html ) {</span>
<a href="#l23.245"></a><span id="l23.245" class="difflineminus">-		return this.each(function(){</span>
<a href="#l23.246"></a><span id="l23.246" class="difflineminus">-			jQuery( this ).contents().wrapAll( html );</span>
<a href="#l23.247"></a><span id="l23.247" class="difflineminus">-		});</span>
<a href="#l23.248"></a><span id="l23.248" class="difflineminus">-	},</span>
<a href="#l23.249"></a><span id="l23.249" class="difflineminus">-</span>
<a href="#l23.250"></a><span id="l23.250" class="difflineminus">-	wrap: function( html ) {</span>
<a href="#l23.251"></a><span id="l23.251" class="difflineminus">-		return this.each(function(){</span>
<a href="#l23.252"></a><span id="l23.252" class="difflineminus">-			jQuery( this ).wrapAll( html );</span>
<a href="#l23.253"></a><span id="l23.253" class="difflineminus">-		});</span>
<a href="#l23.254"></a><span id="l23.254" class="difflineminus">-	},</span>
<a href="#l23.255"></a><span id="l23.255" class="difflineminus">-</span>
<a href="#l23.256"></a><span id="l23.256" class="difflineminus">-	append: function() {</span>
<a href="#l23.257"></a><span id="l23.257" class="difflineminus">-		return this.domManip(arguments, true, function(elem){</span>
<a href="#l23.258"></a><span id="l23.258" class="difflineminus">-			if (this.nodeType == 1)</span>
<a href="#l23.259"></a><span id="l23.259" class="difflineminus">-				this.appendChild( elem );</span>
<a href="#l23.260"></a><span id="l23.260" class="difflineminus">-		});</span>
<a href="#l23.261"></a><span id="l23.261" class="difflineminus">-	},</span>
<a href="#l23.262"></a><span id="l23.262" class="difflineminus">-</span>
<a href="#l23.263"></a><span id="l23.263" class="difflineminus">-	prepend: function() {</span>
<a href="#l23.264"></a><span id="l23.264" class="difflineminus">-		return this.domManip(arguments, true, function(elem){</span>
<a href="#l23.265"></a><span id="l23.265" class="difflineminus">-			if (this.nodeType == 1)</span>
<a href="#l23.266"></a><span id="l23.266" class="difflineminus">-				this.insertBefore( elem, this.firstChild );</span>
<a href="#l23.267"></a><span id="l23.267" class="difflineminus">-		});</span>
<a href="#l23.268"></a><span id="l23.268" class="difflineminus">-	},</span>
<a href="#l23.269"></a><span id="l23.269" class="difflineminus">-</span>
<a href="#l23.270"></a><span id="l23.270" class="difflineminus">-	before: function() {</span>
<a href="#l23.271"></a><span id="l23.271" class="difflineminus">-		return this.domManip(arguments, false, function(elem){</span>
<a href="#l23.272"></a><span id="l23.272" class="difflineminus">-			this.parentNode.insertBefore( elem, this );</span>
<a href="#l23.273"></a><span id="l23.273" class="difflineminus">-		});</span>
<a href="#l23.274"></a><span id="l23.274" class="difflineminus">-	},</span>
<a href="#l23.275"></a><span id="l23.275" class="difflineminus">-</span>
<a href="#l23.276"></a><span id="l23.276" class="difflineminus">-	after: function() {</span>
<a href="#l23.277"></a><span id="l23.277" class="difflineminus">-		return this.domManip(arguments, false, function(elem){</span>
<a href="#l23.278"></a><span id="l23.278" class="difflineminus">-			this.parentNode.insertBefore( elem, this.nextSibling );</span>
<a href="#l23.279"></a><span id="l23.279" class="difflineminus">-		});</span>
<a href="#l23.280"></a><span id="l23.280" class="difflineminus">-	},</span>
<a href="#l23.281"></a><span id="l23.281" class="difflineminus">-</span>
<a href="#l23.282"></a><span id="l23.282" class="difflineminus">-	end: function() {</span>
<a href="#l23.283"></a><span id="l23.283" class="difflineminus">-		return this.prevObject || jQuery( [] );</span>
<a href="#l23.284"></a><span id="l23.284" class="difflineminus">-	},</span>
<a href="#l23.285"></a><span id="l23.285" class="difflineminus">-</span>
<a href="#l23.286"></a><span id="l23.286" class="difflineminus">-	// For internal use only.</span>
<a href="#l23.287"></a><span id="l23.287" class="difflineminus">-	// Behaves like an Array's method, not like a jQuery method.</span>
<a href="#l23.288"></a><span id="l23.288" class="difflineminus">-	push: [].push,</span>
<a href="#l23.289"></a><span id="l23.289" class="difflineminus">-	sort: [].sort,</span>
<a href="#l23.290"></a><span id="l23.290" class="difflineminus">-	splice: [].splice,</span>
<a href="#l23.291"></a><span id="l23.291" class="difflineminus">-</span>
<a href="#l23.292"></a><span id="l23.292" class="difflineminus">-	find: function( selector ) {</span>
<a href="#l23.293"></a><span id="l23.293" class="difflineminus">-		if ( this.length === 1 ) {</span>
<a href="#l23.294"></a><span id="l23.294" class="difflineminus">-			var ret = this.pushStack( [], &quot;find&quot;, selector );</span>
<a href="#l23.295"></a><span id="l23.295" class="difflineminus">-			ret.length = 0;</span>
<a href="#l23.296"></a><span id="l23.296" class="difflineminus">-			jQuery.find( selector, this[0], ret );</span>
<a href="#l23.297"></a><span id="l23.297" class="difflineminus">-			return ret;</span>
<a href="#l23.298"></a><span id="l23.298" class="difflineminus">-		} else {</span>
<a href="#l23.299"></a><span id="l23.299" class="difflineminus">-			return this.pushStack( jQuery.unique(jQuery.map(this, function(elem){</span>
<a href="#l23.300"></a><span id="l23.300" class="difflineminus">-				return jQuery.find( selector, elem );</span>
<a href="#l23.301"></a><span id="l23.301" class="difflineminus">-			})), &quot;find&quot;, selector );</span>
<a href="#l23.302"></a><span id="l23.302" class="difflineminus">-		}</span>
<a href="#l23.303"></a><span id="l23.303" class="difflineminus">-	},</span>
<a href="#l23.304"></a><span id="l23.304" class="difflineminus">-</span>
<a href="#l23.305"></a><span id="l23.305" class="difflineminus">-	clone: function( events ) {</span>
<a href="#l23.306"></a><span id="l23.306" class="difflineminus">-		// Do the clone</span>
<a href="#l23.307"></a><span id="l23.307" class="difflineminus">-		var ret = this.map(function(){</span>
<a href="#l23.308"></a><span id="l23.308" class="difflineminus">-			if ( !jQuery.support.noCloneEvent &amp;&amp; !jQuery.isXMLDoc(this) ) {</span>
<a href="#l23.309"></a><span id="l23.309" class="difflineminus">-				// IE copies events bound via attachEvent when</span>
<a href="#l23.310"></a><span id="l23.310" class="difflineminus">-				// using cloneNode. Calling detachEvent on the</span>
<a href="#l23.311"></a><span id="l23.311" class="difflineminus">-				// clone will also remove the events from the orignal</span>
<a href="#l23.312"></a><span id="l23.312" class="difflineminus">-				// In order to get around this, we use innerHTML.</span>
<a href="#l23.313"></a><span id="l23.313" class="difflineminus">-				// Unfortunately, this means some modifications to</span>
<a href="#l23.314"></a><span id="l23.314" class="difflineminus">-				// attributes in IE that are actually only stored</span>
<a href="#l23.315"></a><span id="l23.315" class="difflineminus">-				// as properties will not be copied (such as the</span>
<a href="#l23.316"></a><span id="l23.316" class="difflineminus">-				// the name attribute on an input).</span>
<a href="#l23.317"></a><span id="l23.317" class="difflineminus">-				var html = this.outerHTML;</span>
<a href="#l23.318"></a><span id="l23.318" class="difflineminus">-				if ( !html ) {</span>
<a href="#l23.319"></a><span id="l23.319" class="difflineminus">-					var div = this.ownerDocument.createElement(&quot;div&quot;);</span>
<a href="#l23.320"></a><span id="l23.320" class="difflineminus">-					div.appendChild( this.cloneNode(true) );</span>
<a href="#l23.321"></a><span id="l23.321" class="difflineminus">-					html = div.innerHTML;</span>
<a href="#l23.322"></a><span id="l23.322" class="difflineminus">-				}</span>
<a href="#l23.323"></a><span id="l23.323" class="difflineminus">-</span>
<a href="#l23.324"></a><span id="l23.324" class="difflineminus">-				return jQuery.clean([html.replace(/ jQuery\d+=&quot;(?:\d+|null)&quot;/g, &quot;&quot;).replace(/^\s*/, &quot;&quot;)])[0];</span>
<a href="#l23.325"></a><span id="l23.325" class="difflineminus">-			} else</span>
<a href="#l23.326"></a><span id="l23.326" class="difflineminus">-				return this.cloneNode(true);</span>
<a href="#l23.327"></a><span id="l23.327" class="difflineminus">-		});</span>
<a href="#l23.328"></a><span id="l23.328" class="difflineminus">-</span>
<a href="#l23.329"></a><span id="l23.329" class="difflineminus">-		// Copy the events from the original to the clone</span>
<a href="#l23.330"></a><span id="l23.330" class="difflineminus">-		if ( events === true ) {</span>
<a href="#l23.331"></a><span id="l23.331" class="difflineminus">-			var orig = this.find(&quot;*&quot;).andSelf(), i = 0;</span>
<a href="#l23.332"></a><span id="l23.332" class="difflineminus">-</span>
<a href="#l23.333"></a><span id="l23.333" class="difflineminus">-			ret.find(&quot;*&quot;).andSelf().each(function(){</span>
<a href="#l23.334"></a><span id="l23.334" class="difflineminus">-				if ( this.nodeName !== orig[i].nodeName )</span>
<a href="#l23.335"></a><span id="l23.335" class="difflineminus">-					return;</span>
<a href="#l23.336"></a><span id="l23.336" class="difflineminus">-</span>
<a href="#l23.337"></a><span id="l23.337" class="difflineminus">-				var events = jQuery.data( orig[i], &quot;events&quot; );</span>
<a href="#l23.338"></a><span id="l23.338" class="difflineminus">-</span>
<a href="#l23.339"></a><span id="l23.339" class="difflineminus">-				for ( var type in events ) {</span>
<a href="#l23.340"></a><span id="l23.340" class="difflineminus">-					for ( var handler in events[ type ] ) {</span>
<a href="#l23.341"></a><span id="l23.341" class="difflineminus">-						jQuery.event.add( this, type, events[ type ][ handler ], events[ type ][ handler ].data );</span>
<a href="#l23.342"></a><span id="l23.342" class="difflineminus">-					}</span>
<a href="#l23.343"></a><span id="l23.343" class="difflineminus">-				}</span>
<a href="#l23.344"></a><span id="l23.344" class="difflineminus">-</span>
<a href="#l23.345"></a><span id="l23.345" class="difflineminus">-				i++;</span>
<a href="#l23.346"></a><span id="l23.346" class="difflineminus">-			});</span>
<a href="#l23.347"></a><span id="l23.347" class="difflineminus">-		}</span>
<a href="#l23.348"></a><span id="l23.348" class="difflineminus">-</span>
<a href="#l23.349"></a><span id="l23.349" class="difflineminus">-		// Return the cloned set</span>
<a href="#l23.350"></a><span id="l23.350" class="difflineminus">-		return ret;</span>
<a href="#l23.351"></a><span id="l23.351" class="difflineminus">-	},</span>
<a href="#l23.352"></a><span id="l23.352" class="difflineminus">-</span>
<a href="#l23.353"></a><span id="l23.353" class="difflineminus">-	filter: function( selector ) {</span>
<a href="#l23.354"></a><span id="l23.354" class="difflineminus">-		return this.pushStack(</span>
<a href="#l23.355"></a><span id="l23.355" class="difflineminus">-			jQuery.isFunction( selector ) &amp;&amp;</span>
<a href="#l23.356"></a><span id="l23.356" class="difflineminus">-			jQuery.grep(this, function(elem, i){</span>
<a href="#l23.357"></a><span id="l23.357" class="difflineminus">-				return selector.call( elem, i );</span>
<a href="#l23.358"></a><span id="l23.358" class="difflineminus">-			}) ||</span>
<a href="#l23.359"></a><span id="l23.359" class="difflineminus">-</span>
<a href="#l23.360"></a><span id="l23.360" class="difflineminus">-			jQuery.multiFilter( selector, jQuery.grep(this, function(elem){</span>
<a href="#l23.361"></a><span id="l23.361" class="difflineminus">-				return elem.nodeType === 1;</span>
<a href="#l23.362"></a><span id="l23.362" class="difflineminus">-			}) ), &quot;filter&quot;, selector );</span>
<a href="#l23.363"></a><span id="l23.363" class="difflineminus">-	},</span>
<a href="#l23.364"></a><span id="l23.364" class="difflineminus">-</span>
<a href="#l23.365"></a><span id="l23.365" class="difflineminus">-	closest: function( selector ) {</span>
<a href="#l23.366"></a><span id="l23.366" class="difflineminus">-		var pos = jQuery.expr.match.POS.test( selector ) ? jQuery(selector) : null,</span>
<a href="#l23.367"></a><span id="l23.367" class="difflineminus">-			closer = 0;</span>
<a href="#l23.368"></a><span id="l23.368" class="difflineminus">-</span>
<a href="#l23.369"></a><span id="l23.369" class="difflineminus">-		return this.map(function(){</span>
<a href="#l23.370"></a><span id="l23.370" class="difflineminus">-			var cur = this;</span>
<a href="#l23.371"></a><span id="l23.371" class="difflineminus">-			while ( cur &amp;&amp; cur.ownerDocument ) {</span>
<a href="#l23.372"></a><span id="l23.372" class="difflineminus">-				if ( pos ? pos.index(cur) &gt; -1 : jQuery(cur).is(selector) ) {</span>
<a href="#l23.373"></a><span id="l23.373" class="difflineminus">-					jQuery.data(cur, &quot;closest&quot;, closer);</span>
<a href="#l23.374"></a><span id="l23.374" class="difflineminus">-					return cur;</span>
<a href="#l23.375"></a><span id="l23.375" class="difflineminus">-				}</span>
<a href="#l23.376"></a><span id="l23.376" class="difflineminus">-				cur = cur.parentNode;</span>
<a href="#l23.377"></a><span id="l23.377" class="difflineminus">-				closer++;</span>
<a href="#l23.378"></a><span id="l23.378" class="difflineminus">-			}</span>
<a href="#l23.379"></a><span id="l23.379" class="difflineminus">-		});</span>
<a href="#l23.380"></a><span id="l23.380" class="difflineminus">-	},</span>
<a href="#l23.381"></a><span id="l23.381" class="difflineminus">-</span>
<a href="#l23.382"></a><span id="l23.382" class="difflineminus">-	not: function( selector ) {</span>
<a href="#l23.383"></a><span id="l23.383" class="difflineminus">-		if ( typeof selector === &quot;string&quot; )</span>
<a href="#l23.384"></a><span id="l23.384" class="difflineminus">-			// test special case where just one selector is passed in</span>
<a href="#l23.385"></a><span id="l23.385" class="difflineminus">-			if ( isSimple.test( selector ) )</span>
<a href="#l23.386"></a><span id="l23.386" class="difflineminus">-				return this.pushStack( jQuery.multiFilter( selector, this, true ), &quot;not&quot;, selector );</span>
<a href="#l23.387"></a><span id="l23.387" class="difflineminus">-			else</span>
<a href="#l23.388"></a><span id="l23.388" class="difflineminus">-				selector = jQuery.multiFilter( selector, this );</span>
<a href="#l23.389"></a><span id="l23.389" class="difflineminus">-</span>
<a href="#l23.390"></a><span id="l23.390" class="difflineminus">-		var isArrayLike = selector.length &amp;&amp; selector[selector.length - 1] !== undefined &amp;&amp; !selector.nodeType;</span>
<a href="#l23.391"></a><span id="l23.391" class="difflineminus">-		return this.filter(function() {</span>
<a href="#l23.392"></a><span id="l23.392" class="difflineminus">-			return isArrayLike ? jQuery.inArray( this, selector ) &lt; 0 : this != selector;</span>
<a href="#l23.393"></a><span id="l23.393" class="difflineminus">-		});</span>
<a href="#l23.394"></a><span id="l23.394" class="difflineminus">-	},</span>
<a href="#l23.395"></a><span id="l23.395" class="difflineminus">-</span>
<a href="#l23.396"></a><span id="l23.396" class="difflineminus">-	add: function( selector ) {</span>
<a href="#l23.397"></a><span id="l23.397" class="difflineminus">-		return this.pushStack( jQuery.unique( jQuery.merge(</span>
<a href="#l23.398"></a><span id="l23.398" class="difflineminus">-			this.get(),</span>
<a href="#l23.399"></a><span id="l23.399" class="difflineminus">-			typeof selector === &quot;string&quot; ?</span>
<a href="#l23.400"></a><span id="l23.400" class="difflineminus">-				jQuery( selector ) :</span>
<a href="#l23.401"></a><span id="l23.401" class="difflineminus">-				jQuery.makeArray( selector )</span>
<a href="#l23.402"></a><span id="l23.402" class="difflineminus">-		)));</span>
<a href="#l23.403"></a><span id="l23.403" class="difflineminus">-	},</span>
<a href="#l23.404"></a><span id="l23.404" class="difflineminus">-</span>
<a href="#l23.405"></a><span id="l23.405" class="difflineminus">-	is: function( selector ) {</span>
<a href="#l23.406"></a><span id="l23.406" class="difflineminus">-		return !!selector &amp;&amp; jQuery.multiFilter( selector, this ).length &gt; 0;</span>
<a href="#l23.407"></a><span id="l23.407" class="difflineminus">-	},</span>
<a href="#l23.408"></a><span id="l23.408" class="difflineminus">-</span>
<a href="#l23.409"></a><span id="l23.409" class="difflineminus">-	hasClass: function( selector ) {</span>
<a href="#l23.410"></a><span id="l23.410" class="difflineminus">-		return !!selector &amp;&amp; this.is( &quot;.&quot; + selector );</span>
<a href="#l23.411"></a><span id="l23.411" class="difflineminus">-	},</span>
<a href="#l23.412"></a><span id="l23.412" class="difflineminus">-</span>
<a href="#l23.413"></a><span id="l23.413" class="difflineminus">-	val: function( value ) {</span>
<a href="#l23.414"></a><span id="l23.414" class="difflineminus">-		if ( value === undefined ) {			</span>
<a href="#l23.415"></a><span id="l23.415" class="difflineminus">-			var elem = this[0];</span>
<a href="#l23.416"></a><span id="l23.416" class="difflineminus">-</span>
<a href="#l23.417"></a><span id="l23.417" class="difflineminus">-			if ( elem ) {</span>
<a href="#l23.418"></a><span id="l23.418" class="difflineminus">-				if( jQuery.nodeName( elem, 'option' ) )</span>
<a href="#l23.419"></a><span id="l23.419" class="difflineminus">-					return (elem.attributes.value || {}).specified ? elem.value : elem.text;</span>
<a href="#l23.420"></a><span id="l23.420" class="difflineminus">-				</span>
<a href="#l23.421"></a><span id="l23.421" class="difflineminus">-				// We need to handle select boxes special</span>
<a href="#l23.422"></a><span id="l23.422" class="difflineminus">-				if ( jQuery.nodeName( elem, &quot;select&quot; ) ) {</span>
<a href="#l23.423"></a><span id="l23.423" class="difflineminus">-					var index = elem.selectedIndex,</span>
<a href="#l23.424"></a><span id="l23.424" class="difflineminus">-						values = [],</span>
<a href="#l23.425"></a><span id="l23.425" class="difflineminus">-						options = elem.options,</span>
<a href="#l23.426"></a><span id="l23.426" class="difflineminus">-						one = elem.type == &quot;select-one&quot;;</span>
<a href="#l23.427"></a><span id="l23.427" class="difflineminus">-</span>
<a href="#l23.428"></a><span id="l23.428" class="difflineminus">-					// Nothing was selected</span>
<a href="#l23.429"></a><span id="l23.429" class="difflineminus">-					if ( index &lt; 0 )</span>
<a href="#l23.430"></a><span id="l23.430" class="difflineminus">-						return null;</span>
<a href="#l23.431"></a><span id="l23.431" class="difflineminus">-</span>
<a href="#l23.432"></a><span id="l23.432" class="difflineminus">-					// Loop through all the selected options</span>
<a href="#l23.433"></a><span id="l23.433" class="difflineminus">-					for ( var i = one ? index : 0, max = one ? index + 1 : options.length; i &lt; max; i++ ) {</span>
<a href="#l23.434"></a><span id="l23.434" class="difflineminus">-						var option = options[ i ];</span>
<a href="#l23.435"></a><span id="l23.435" class="difflineminus">-</span>
<a href="#l23.436"></a><span id="l23.436" class="difflineminus">-						if ( option.selected ) {</span>
<a href="#l23.437"></a><span id="l23.437" class="difflineminus">-							// Get the specifc value for the option</span>
<a href="#l23.438"></a><span id="l23.438" class="difflineminus">-							value = jQuery(option).val();</span>
<a href="#l23.439"></a><span id="l23.439" class="difflineminus">-</span>
<a href="#l23.440"></a><span id="l23.440" class="difflineminus">-							// We don't need an array for one selects</span>
<a href="#l23.441"></a><span id="l23.441" class="difflineminus">-							if ( one )</span>
<a href="#l23.442"></a><span id="l23.442" class="difflineminus">-								return value;</span>
<a href="#l23.443"></a><span id="l23.443" class="difflineminus">-</span>
<a href="#l23.444"></a><span id="l23.444" class="difflineminus">-							// Multi-Selects return an array</span>
<a href="#l23.445"></a><span id="l23.445" class="difflineminus">-							values.push( value );</span>
<a href="#l23.446"></a><span id="l23.446" class="difflineminus">-						}</span>
<a href="#l23.447"></a><span id="l23.447" class="difflineminus">-					}</span>
<a href="#l23.448"></a><span id="l23.448" class="difflineminus">-</span>
<a href="#l23.449"></a><span id="l23.449" class="difflineminus">-					return values;				</span>
<a href="#l23.450"></a><span id="l23.450" class="difflineminus">-				}</span>
<a href="#l23.451"></a><span id="l23.451" class="difflineminus">-</span>
<a href="#l23.452"></a><span id="l23.452" class="difflineminus">-				// Everything else, we just grab the value</span>
<a href="#l23.453"></a><span id="l23.453" class="difflineminus">-				return (elem.value || &quot;&quot;).replace(/\r/g, &quot;&quot;);</span>
<a href="#l23.454"></a><span id="l23.454" class="difflineminus">-</span>
<a href="#l23.455"></a><span id="l23.455" class="difflineminus">-			}</span>
<a href="#l23.456"></a><span id="l23.456" class="difflineminus">-</span>
<a href="#l23.457"></a><span id="l23.457" class="difflineminus">-			return undefined;</span>
<a href="#l23.458"></a><span id="l23.458" class="difflineminus">-		}</span>
<a href="#l23.459"></a><span id="l23.459" class="difflineminus">-</span>
<a href="#l23.460"></a><span id="l23.460" class="difflineminus">-		if ( typeof value === &quot;number&quot; )</span>
<a href="#l23.461"></a><span id="l23.461" class="difflineminus">-			value += '';</span>
<a href="#l23.462"></a><span id="l23.462" class="difflineminus">-</span>
<a href="#l23.463"></a><span id="l23.463" class="difflineminus">-		return this.each(function(){</span>
<a href="#l23.464"></a><span id="l23.464" class="difflineminus">-			if ( this.nodeType != 1 )</span>
<a href="#l23.465"></a><span id="l23.465" class="difflineminus">-				return;</span>
<a href="#l23.466"></a><span id="l23.466" class="difflineminus">-</span>
<a href="#l23.467"></a><span id="l23.467" class="difflineminus">-			if ( jQuery.isArray(value) &amp;&amp; /radio|checkbox/.test( this.type ) )</span>
<a href="#l23.468"></a><span id="l23.468" class="difflineminus">-				this.checked = (jQuery.inArray(this.value, value) &gt;= 0 ||</span>
<a href="#l23.469"></a><span id="l23.469" class="difflineminus">-					jQuery.inArray(this.name, value) &gt;= 0);</span>
<a href="#l23.470"></a><span id="l23.470" class="difflineminus">-</span>
<a href="#l23.471"></a><span id="l23.471" class="difflineminus">-			else if ( jQuery.nodeName( this, &quot;select&quot; ) ) {</span>
<a href="#l23.472"></a><span id="l23.472" class="difflineminus">-				var values = jQuery.makeArray(value);</span>
<a href="#l23.473"></a><span id="l23.473" class="difflineminus">-</span>
<a href="#l23.474"></a><span id="l23.474" class="difflineminus">-				jQuery( &quot;option&quot;, this ).each(function(){</span>
<a href="#l23.475"></a><span id="l23.475" class="difflineminus">-					this.selected = (jQuery.inArray( this.value, values ) &gt;= 0 ||</span>
<a href="#l23.476"></a><span id="l23.476" class="difflineminus">-						jQuery.inArray( this.text, values ) &gt;= 0);</span>
<a href="#l23.477"></a><span id="l23.477" class="difflineminus">-				});</span>
<a href="#l23.478"></a><span id="l23.478" class="difflineminus">-</span>
<a href="#l23.479"></a><span id="l23.479" class="difflineminus">-				if ( !values.length )</span>
<a href="#l23.480"></a><span id="l23.480" class="difflineminus">-					this.selectedIndex = -1;</span>
<a href="#l23.481"></a><span id="l23.481" class="difflineminus">-</span>
<a href="#l23.482"></a><span id="l23.482" class="difflineminus">-			} else</span>
<a href="#l23.483"></a><span id="l23.483" class="difflineminus">-				this.value = value;</span>
<a href="#l23.484"></a><span id="l23.484" class="difflineminus">-		});</span>
<a href="#l23.485"></a><span id="l23.485" class="difflineminus">-	},</span>
<a href="#l23.486"></a><span id="l23.486" class="difflineminus">-</span>
<a href="#l23.487"></a><span id="l23.487" class="difflineminus">-	html: function( value ) {</span>
<a href="#l23.488"></a><span id="l23.488" class="difflineminus">-		return value === undefined ?</span>
<a href="#l23.489"></a><span id="l23.489" class="difflineminus">-			(this[0] ?</span>
<a href="#l23.490"></a><span id="l23.490" class="difflineminus">-				this[0].innerHTML.replace(/ jQuery\d+=&quot;(?:\d+|null)&quot;/g, &quot;&quot;) :</span>
<a href="#l23.491"></a><span id="l23.491" class="difflineminus">-				null) :</span>
<a href="#l23.492"></a><span id="l23.492" class="difflineminus">-			this.empty().append( value );</span>
<a href="#l23.493"></a><span id="l23.493" class="difflineminus">-	},</span>
<a href="#l23.494"></a><span id="l23.494" class="difflineminus">-</span>
<a href="#l23.495"></a><span id="l23.495" class="difflineminus">-	replaceWith: function( value ) {</span>
<a href="#l23.496"></a><span id="l23.496" class="difflineminus">-		return this.after( value ).remove();</span>
<a href="#l23.497"></a><span id="l23.497" class="difflineminus">-	},</span>
<a href="#l23.498"></a><span id="l23.498" class="difflineminus">-</span>
<a href="#l23.499"></a><span id="l23.499" class="difflineminus">-	eq: function( i ) {</span>
<a href="#l23.500"></a><span id="l23.500" class="difflineminus">-		return this.slice( i, +i + 1 );</span>
<a href="#l23.501"></a><span id="l23.501" class="difflineminus">-	},</span>
<a href="#l23.502"></a><span id="l23.502" class="difflineminus">-</span>
<a href="#l23.503"></a><span id="l23.503" class="difflineminus">-	slice: function() {</span>
<a href="#l23.504"></a><span id="l23.504" class="difflineminus">-		return this.pushStack( Array.prototype.slice.apply( this, arguments ),</span>
<a href="#l23.505"></a><span id="l23.505" class="difflineminus">-			&quot;slice&quot;, Array.prototype.slice.call(arguments).join(&quot;,&quot;) );</span>
<a href="#l23.506"></a><span id="l23.506" class="difflineminus">-	},</span>
<a href="#l23.507"></a><span id="l23.507" class="difflineminus">-</span>
<a href="#l23.508"></a><span id="l23.508" class="difflineminus">-	map: function( callback ) {</span>
<a href="#l23.509"></a><span id="l23.509" class="difflineminus">-		return this.pushStack( jQuery.map(this, function(elem, i){</span>
<a href="#l23.510"></a><span id="l23.510" class="difflineminus">-			return callback.call( elem, i, elem );</span>
<a href="#l23.511"></a><span id="l23.511" class="difflineminus">-		}));</span>
<a href="#l23.512"></a><span id="l23.512" class="difflineminus">-	},</span>
<a href="#l23.513"></a><span id="l23.513" class="difflineminus">-</span>
<a href="#l23.514"></a><span id="l23.514" class="difflineminus">-	andSelf: function() {</span>
<a href="#l23.515"></a><span id="l23.515" class="difflineminus">-		return this.add( this.prevObject );</span>
<a href="#l23.516"></a><span id="l23.516" class="difflineminus">-	},</span>
<a href="#l23.517"></a><span id="l23.517" class="difflineminus">-</span>
<a href="#l23.518"></a><span id="l23.518" class="difflineminus">-	domManip: function( args, table, callback ) {</span>
<a href="#l23.519"></a><span id="l23.519" class="difflineminus">-		if ( this[0] ) {</span>
<a href="#l23.520"></a><span id="l23.520" class="difflineminus">-			var fragment = (this[0].ownerDocument || this[0]).createDocumentFragment(),</span>
<a href="#l23.521"></a><span id="l23.521" class="difflineminus">-				scripts = jQuery.clean( args, (this[0].ownerDocument || this[0]), fragment ),</span>
<a href="#l23.522"></a><span id="l23.522" class="difflineminus">-				first = fragment.firstChild;</span>
<a href="#l23.523"></a><span id="l23.523" class="difflineminus">-</span>
<a href="#l23.524"></a><span id="l23.524" class="difflineminus">-			if ( first )</span>
<a href="#l23.525"></a><span id="l23.525" class="difflineminus">-				for ( var i = 0, l = this.length; i &lt; l; i++ )</span>
<a href="#l23.526"></a><span id="l23.526" class="difflineminus">-					callback.call( root(this[i], first), this.length &gt; 1 || i &gt; 0 ?</span>
<a href="#l23.527"></a><span id="l23.527" class="difflineminus">-							fragment.cloneNode(true) : fragment );</span>
<a href="#l23.528"></a><span id="l23.528" class="difflineminus">-		</span>
<a href="#l23.529"></a><span id="l23.529" class="difflineminus">-			if ( scripts )</span>
<a href="#l23.530"></a><span id="l23.530" class="difflineminus">-				jQuery.each( scripts, evalScript );</span>
<a href="#l23.531"></a><span id="l23.531" class="difflineminus">-		}</span>
<a href="#l23.532"></a><span id="l23.532" class="difflineminus">-</span>
<a href="#l23.533"></a><span id="l23.533" class="difflineminus">-		return this;</span>
<a href="#l23.534"></a><span id="l23.534" class="difflineminus">-		</span>
<a href="#l23.535"></a><span id="l23.535" class="difflineminus">-		function root( elem, cur ) {</span>
<a href="#l23.536"></a><span id="l23.536" class="difflineminus">-			return table &amp;&amp; jQuery.nodeName(elem, &quot;table&quot;) &amp;&amp; jQuery.nodeName(cur, &quot;tr&quot;) ?</span>
<a href="#l23.537"></a><span id="l23.537" class="difflineminus">-				(elem.getElementsByTagName(&quot;tbody&quot;)[0] ||</span>
<a href="#l23.538"></a><span id="l23.538" class="difflineminus">-				elem.appendChild(elem.ownerDocument.createElement(&quot;tbody&quot;))) :</span>
<a href="#l23.539"></a><span id="l23.539" class="difflineminus">-				elem;</span>
<a href="#l23.540"></a><span id="l23.540" class="difflineminus">-		}</span>
<a href="#l23.541"></a><span id="l23.541" class="difflineminus">-	}</span>
<a href="#l23.542"></a><span id="l23.542" class="difflineminus">-};</span>
<a href="#l23.543"></a><span id="l23.543" class="difflineminus">-</span>
<a href="#l23.544"></a><span id="l23.544" class="difflineminus">-// Give the init function the jQuery prototype for later instantiation</span>
<a href="#l23.545"></a><span id="l23.545" class="difflineminus">-jQuery.fn.init.prototype = jQuery.fn;</span>
<a href="#l23.546"></a><span id="l23.546" class="difflineminus">-</span>
<a href="#l23.547"></a><span id="l23.547" class="difflineminus">-function evalScript( i, elem ) {</span>
<a href="#l23.548"></a><span id="l23.548" class="difflineminus">-	if ( elem.src )</span>
<a href="#l23.549"></a><span id="l23.549" class="difflineminus">-		jQuery.ajax({</span>
<a href="#l23.550"></a><span id="l23.550" class="difflineminus">-			url: elem.src,</span>
<a href="#l23.551"></a><span id="l23.551" class="difflineminus">-			async: false,</span>
<a href="#l23.552"></a><span id="l23.552" class="difflineminus">-			dataType: &quot;script&quot;</span>
<a href="#l23.553"></a><span id="l23.553" class="difflineminus">-		});</span>
<a href="#l23.554"></a><span id="l23.554" class="difflineminus">-</span>
<a href="#l23.555"></a><span id="l23.555" class="difflineminus">-	else</span>
<a href="#l23.556"></a><span id="l23.556" class="difflineminus">-		jQuery.globalEval( elem.text || elem.textContent || elem.innerHTML || &quot;&quot; );</span>
<a href="#l23.557"></a><span id="l23.557" class="difflineminus">-</span>
<a href="#l23.558"></a><span id="l23.558" class="difflineminus">-	if ( elem.parentNode )</span>
<a href="#l23.559"></a><span id="l23.559" class="difflineminus">-		elem.parentNode.removeChild( elem );</span>
<a href="#l23.560"></a><span id="l23.560" class="difflineminus">-}</span>
<a href="#l23.561"></a><span id="l23.561" class="difflineminus">-</span>
<a href="#l23.562"></a><span id="l23.562" class="difflineminus">-function now(){</span>
<a href="#l23.563"></a><span id="l23.563" class="difflineminus">-	return +new Date;</span>
<a href="#l23.564"></a><span id="l23.564" class="difflineminus">-}</span>
<a href="#l23.565"></a><span id="l23.565" class="difflineminus">-</span>
<a href="#l23.566"></a><span id="l23.566" class="difflineminus">-jQuery.extend = jQuery.fn.extend = function() {</span>
<a href="#l23.567"></a><span id="l23.567" class="difflineminus">-	// copy reference to target object</span>
<a href="#l23.568"></a><span id="l23.568" class="difflineminus">-	var target = arguments[0] || {}, i = 1, length = arguments.length, deep = false, options;</span>
<a href="#l23.569"></a><span id="l23.569" class="difflineminus">-</span>
<a href="#l23.570"></a><span id="l23.570" class="difflineminus">-	// Handle a deep copy situation</span>
<a href="#l23.571"></a><span id="l23.571" class="difflineminus">-	if ( typeof target === &quot;boolean&quot; ) {</span>
<a href="#l23.572"></a><span id="l23.572" class="difflineminus">-		deep = target;</span>
<a href="#l23.573"></a><span id="l23.573" class="difflineminus">-		target = arguments[1] || {};</span>
<a href="#l23.574"></a><span id="l23.574" class="difflineminus">-		// skip the boolean and the target</span>
<a href="#l23.575"></a><span id="l23.575" class="difflineminus">-		i = 2;</span>
<a href="#l23.576"></a><span id="l23.576" class="difflineminus">-	}</span>
<a href="#l23.577"></a><span id="l23.577" class="difflineminus">-</span>
<a href="#l23.578"></a><span id="l23.578" class="difflineminus">-	// Handle case when target is a string or something (possible in deep copy)</span>
<a href="#l23.579"></a><span id="l23.579" class="difflineminus">-	if ( typeof target !== &quot;object&quot; &amp;&amp; !jQuery.isFunction(target) )</span>
<a href="#l23.580"></a><span id="l23.580" class="difflineminus">-		target = {};</span>
<a href="#l23.581"></a><span id="l23.581" class="difflineminus">-</span>
<a href="#l23.582"></a><span id="l23.582" class="difflineminus">-	// extend jQuery itself if only one argument is passed</span>
<a href="#l23.583"></a><span id="l23.583" class="difflineminus">-	if ( length == i ) {</span>
<a href="#l23.584"></a><span id="l23.584" class="difflineminus">-		target = this;</span>
<a href="#l23.585"></a><span id="l23.585" class="difflineminus">-		--i;</span>
<a href="#l23.586"></a><span id="l23.586" class="difflineminus">-	}</span>
<a href="#l23.587"></a><span id="l23.587" class="difflineminus">-</span>
<a href="#l23.588"></a><span id="l23.588" class="difflineminus">-	for ( ; i &lt; length; i++ )</span>
<a href="#l23.589"></a><span id="l23.589" class="difflineminus">-		// Only deal with non-null/undefined values</span>
<a href="#l23.590"></a><span id="l23.590" class="difflineminus">-		if ( (options = arguments[ i ]) != null )</span>
<a href="#l23.591"></a><span id="l23.591" class="difflineminus">-			// Extend the base object</span>
<a href="#l23.592"></a><span id="l23.592" class="difflineminus">-			for ( var name in options ) {</span>
<a href="#l23.593"></a><span id="l23.593" class="difflineminus">-				var src = target[ name ], copy = options[ name ];</span>
<a href="#l23.594"></a><span id="l23.594" class="difflineminus">-</span>
<a href="#l23.595"></a><span id="l23.595" class="difflineminus">-				// Prevent never-ending loop</span>
<a href="#l23.596"></a><span id="l23.596" class="difflineminus">-				if ( target === copy )</span>
<a href="#l23.597"></a><span id="l23.597" class="difflineminus">-					continue;</span>
<a href="#l23.598"></a><span id="l23.598" class="difflineminus">-</span>
<a href="#l23.599"></a><span id="l23.599" class="difflineminus">-				// Recurse if we're merging object values</span>
<a href="#l23.600"></a><span id="l23.600" class="difflineminus">-				if ( deep &amp;&amp; copy &amp;&amp; typeof copy === &quot;object&quot; &amp;&amp; !copy.nodeType )</span>
<a href="#l23.601"></a><span id="l23.601" class="difflineminus">-					target[ name ] = jQuery.extend( deep, </span>
<a href="#l23.602"></a><span id="l23.602" class="difflineminus">-						// Never move original objects, clone them</span>
<a href="#l23.603"></a><span id="l23.603" class="difflineminus">-						src || ( copy.length != null ? [ ] : { } )</span>
<a href="#l23.604"></a><span id="l23.604" class="difflineminus">-					, copy );</span>
<a href="#l23.605"></a><span id="l23.605" class="difflineminus">-</span>
<a href="#l23.606"></a><span id="l23.606" class="difflineminus">-				// Don't bring in undefined values</span>
<a href="#l23.607"></a><span id="l23.607" class="difflineminus">-				else if ( copy !== undefined )</span>
<a href="#l23.608"></a><span id="l23.608" class="difflineminus">-					target[ name ] = copy;</span>
<a href="#l23.609"></a><span id="l23.609" class="difflineminus">-</span>
<a href="#l23.610"></a><span id="l23.610" class="difflineminus">-			}</span>
<a href="#l23.611"></a><span id="l23.611" class="difflineminus">-</span>
<a href="#l23.612"></a><span id="l23.612" class="difflineminus">-	// Return the modified object</span>
<a href="#l23.613"></a><span id="l23.613" class="difflineminus">-	return target;</span>
<a href="#l23.614"></a><span id="l23.614" class="difflineminus">-};</span>
<a href="#l23.615"></a><span id="l23.615" class="difflineminus">-</span>
<a href="#l23.616"></a><span id="l23.616" class="difflineminus">-// exclude the following css properties to add px</span>
<a href="#l23.617"></a><span id="l23.617" class="difflineminus">-var	exclude = /z-?index|font-?weight|opacity|zoom|line-?height/i,</span>
<a href="#l23.618"></a><span id="l23.618" class="difflineminus">-	// cache defaultView</span>
<a href="#l23.619"></a><span id="l23.619" class="difflineminus">-	defaultView = document.defaultView || {},</span>
<a href="#l23.620"></a><span id="l23.620" class="difflineminus">-	toString = Object.prototype.toString;</span>
<a href="#l23.621"></a><span id="l23.621" class="difflineminus">-</span>
<a href="#l23.622"></a><span id="l23.622" class="difflineminus">-jQuery.extend({</span>
<a href="#l23.623"></a><span id="l23.623" class="difflineminus">-	noConflict: function( deep ) {</span>
<a href="#l23.624"></a><span id="l23.624" class="difflineminus">-		window.$ = _$;</span>
<a href="#l23.625"></a><span id="l23.625" class="difflineminus">-</span>
<a href="#l23.626"></a><span id="l23.626" class="difflineminus">-		if ( deep )</span>
<a href="#l23.627"></a><span id="l23.627" class="difflineminus">-			window.jQuery = _jQuery;</span>
<a href="#l23.628"></a><span id="l23.628" class="difflineminus">-</span>
<a href="#l23.629"></a><span id="l23.629" class="difflineminus">-		return jQuery;</span>
<a href="#l23.630"></a><span id="l23.630" class="difflineminus">-	},</span>
<a href="#l23.631"></a><span id="l23.631" class="difflineminus">-</span>
<a href="#l23.632"></a><span id="l23.632" class="difflineminus">-	// See test/unit/core.js for details concerning isFunction.</span>
<a href="#l23.633"></a><span id="l23.633" class="difflineminus">-	// Since version 1.3, DOM methods and functions like alert</span>
<a href="#l23.634"></a><span id="l23.634" class="difflineminus">-	// aren't supported. They return false on IE (#2968).</span>
<a href="#l23.635"></a><span id="l23.635" class="difflineminus">-	isFunction: function( obj ) {</span>
<a href="#l23.636"></a><span id="l23.636" class="difflineminus">-		return toString.call(obj) === &quot;[object Function]&quot;;</span>
<a href="#l23.637"></a><span id="l23.637" class="difflineminus">-	},</span>
<a href="#l23.638"></a><span id="l23.638" class="difflineminus">-</span>
<a href="#l23.639"></a><span id="l23.639" class="difflineminus">-	isArray: function( obj ) {</span>
<a href="#l23.640"></a><span id="l23.640" class="difflineminus">-		return toString.call(obj) === &quot;[object Array]&quot;;</span>
<a href="#l23.641"></a><span id="l23.641" class="difflineminus">-	},</span>
<a href="#l23.642"></a><span id="l23.642" class="difflineminus">-</span>
<a href="#l23.643"></a><span id="l23.643" class="difflineminus">-	// check if an element is in a (or is an) XML document</span>
<a href="#l23.644"></a><span id="l23.644" class="difflineminus">-	isXMLDoc: function( elem ) {</span>
<a href="#l23.645"></a><span id="l23.645" class="difflineminus">-		return elem.nodeType === 9 &amp;&amp; elem.documentElement.nodeName !== &quot;HTML&quot; ||</span>
<a href="#l23.646"></a><span id="l23.646" class="difflineminus">-			!!elem.ownerDocument &amp;&amp; jQuery.isXMLDoc( elem.ownerDocument );</span>
<a href="#l23.647"></a><span id="l23.647" class="difflineminus">-	},</span>
<a href="#l23.648"></a><span id="l23.648" class="difflineminus">-</span>
<a href="#l23.649"></a><span id="l23.649" class="difflineminus">-	// Evalulates a script in a global context</span>
<a href="#l23.650"></a><span id="l23.650" class="difflineminus">-	globalEval: function( data ) {</span>
<a href="#l23.651"></a><span id="l23.651" class="difflineminus">-		if ( data &amp;&amp; /\S/.test(data) ) {</span>
<a href="#l23.652"></a><span id="l23.652" class="difflineminus">-			// Inspired by code by Andrea Giammarchi</span>
<a href="#l23.653"></a><span id="l23.653" class="difflineminus">-			// http://webreflection.blogspot.com/2007/08/global-scope-evaluation-and-dom.html</span>
<a href="#l23.654"></a><span id="l23.654" class="difflineminus">-			var head = document.getElementsByTagName(&quot;head&quot;)[0] || document.documentElement,</span>
<a href="#l23.655"></a><span id="l23.655" class="difflineminus">-				script = document.createElement(&quot;script&quot;);</span>
<a href="#l23.656"></a><span id="l23.656" class="difflineminus">-</span>
<a href="#l23.657"></a><span id="l23.657" class="difflineminus">-			script.type = &quot;text/javascript&quot;;</span>
<a href="#l23.658"></a><span id="l23.658" class="difflineminus">-			if ( jQuery.support.scriptEval )</span>
<a href="#l23.659"></a><span id="l23.659" class="difflineminus">-				script.appendChild( document.createTextNode( data ) );</span>
<a href="#l23.660"></a><span id="l23.660" class="difflineminus">-			else</span>
<a href="#l23.661"></a><span id="l23.661" class="difflineminus">-				script.text = data;</span>
<a href="#l23.662"></a><span id="l23.662" class="difflineminus">-</span>
<a href="#l23.663"></a><span id="l23.663" class="difflineminus">-			// Use insertBefore instead of appendChild  to circumvent an IE6 bug.</span>
<a href="#l23.664"></a><span id="l23.664" class="difflineminus">-			// This arises when a base node is used (#2709).</span>
<a href="#l23.665"></a><span id="l23.665" class="difflineminus">-			head.insertBefore( script, head.firstChild );</span>
<a href="#l23.666"></a><span id="l23.666" class="difflineminus">-			head.removeChild( script );</span>
<a href="#l23.667"></a><span id="l23.667" class="difflineminus">-		}</span>
<a href="#l23.668"></a><span id="l23.668" class="difflineminus">-	},</span>
<a href="#l23.669"></a><span id="l23.669" class="difflineminus">-</span>
<a href="#l23.670"></a><span id="l23.670" class="difflineminus">-	nodeName: function( elem, name ) {</span>
<a href="#l23.671"></a><span id="l23.671" class="difflineminus">-		return elem.nodeName &amp;&amp; elem.nodeName.toUpperCase() == name.toUpperCase();</span>
<a href="#l23.672"></a><span id="l23.672" class="difflineminus">-	},</span>
<a href="#l23.673"></a><span id="l23.673" class="difflineminus">-</span>
<a href="#l23.674"></a><span id="l23.674" class="difflineminus">-	// args is for internal usage only</span>
<a href="#l23.675"></a><span id="l23.675" class="difflineminus">-	each: function( object, callback, args ) {</span>
<a href="#l23.676"></a><span id="l23.676" class="difflineminus">-		var name, i = 0, length = object.length;</span>
<a href="#l23.677"></a><span id="l23.677" class="difflineminus">-</span>
<a href="#l23.678"></a><span id="l23.678" class="difflineminus">-		if ( args ) {</span>
<a href="#l23.679"></a><span id="l23.679" class="difflineminus">-			if ( length === undefined ) {</span>
<a href="#l23.680"></a><span id="l23.680" class="difflineminus">-				for ( name in object )</span>
<a href="#l23.681"></a><span id="l23.681" class="difflineminus">-					if ( callback.apply( object[ name ], args ) === false )</span>
<a href="#l23.682"></a><span id="l23.682" class="difflineminus">-						break;</span>
<a href="#l23.683"></a><span id="l23.683" class="difflineminus">-			} else</span>
<a href="#l23.684"></a><span id="l23.684" class="difflineminus">-				for ( ; i &lt; length; )</span>
<a href="#l23.685"></a><span id="l23.685" class="difflineminus">-					if ( callback.apply( object[ i++ ], args ) === false )</span>
<a href="#l23.686"></a><span id="l23.686" class="difflineminus">-						break;</span>
<a href="#l23.687"></a><span id="l23.687" class="difflineminus">-</span>
<a href="#l23.688"></a><span id="l23.688" class="difflineminus">-		// A special, fast, case for the most common use of each</span>
<a href="#l23.689"></a><span id="l23.689" class="difflineminus">-		} else {</span>
<a href="#l23.690"></a><span id="l23.690" class="difflineminus">-			if ( length === undefined ) {</span>
<a href="#l23.691"></a><span id="l23.691" class="difflineminus">-				for ( name in object )</span>
<a href="#l23.692"></a><span id="l23.692" class="difflineminus">-					if ( callback.call( object[ name ], name, object[ name ] ) === false )</span>
<a href="#l23.693"></a><span id="l23.693" class="difflineminus">-						break;</span>
<a href="#l23.694"></a><span id="l23.694" class="difflineminus">-			} else</span>
<a href="#l23.695"></a><span id="l23.695" class="difflineminus">-				for ( var value = object[0];</span>
<a href="#l23.696"></a><span id="l23.696" class="difflineminus">-					i &lt; length &amp;&amp; callback.call( value, i, value ) !== false; value = object[++i] ){}</span>
<a href="#l23.697"></a><span id="l23.697" class="difflineminus">-		}</span>
<a href="#l23.698"></a><span id="l23.698" class="difflineminus">-</span>
<a href="#l23.699"></a><span id="l23.699" class="difflineminus">-		return object;</span>
<a href="#l23.700"></a><span id="l23.700" class="difflineminus">-	},</span>
<a href="#l23.701"></a><span id="l23.701" class="difflineminus">-</span>
<a href="#l23.702"></a><span id="l23.702" class="difflineminus">-	prop: function( elem, value, type, i, name ) {</span>
<a href="#l23.703"></a><span id="l23.703" class="difflineminus">-		// Handle executable functions</span>
<a href="#l23.704"></a><span id="l23.704" class="difflineminus">-		if ( jQuery.isFunction( value ) )</span>
<a href="#l23.705"></a><span id="l23.705" class="difflineminus">-			value = value.call( elem, i );</span>
<a href="#l23.706"></a><span id="l23.706" class="difflineminus">-</span>
<a href="#l23.707"></a><span id="l23.707" class="difflineminus">-		// Handle passing in a number to a CSS property</span>
<a href="#l23.708"></a><span id="l23.708" class="difflineminus">-		return typeof value === &quot;number&quot; &amp;&amp; type == &quot;curCSS&quot; &amp;&amp; !exclude.test( name ) ?</span>
<a href="#l23.709"></a><span id="l23.709" class="difflineminus">-			value + &quot;px&quot; :</span>
<a href="#l23.710"></a><span id="l23.710" class="difflineminus">-			value;</span>
<a href="#l23.711"></a><span id="l23.711" class="difflineminus">-	},</span>
<a href="#l23.712"></a><span id="l23.712" class="difflineminus">-</span>
<a href="#l23.713"></a><span id="l23.713" class="difflineminus">-	className: {</span>
<a href="#l23.714"></a><span id="l23.714" class="difflineminus">-		// internal only, use addClass(&quot;class&quot;)</span>
<a href="#l23.715"></a><span id="l23.715" class="difflineminus">-		add: function( elem, classNames ) {</span>
<a href="#l23.716"></a><span id="l23.716" class="difflineminus">-			jQuery.each((classNames || &quot;&quot;).split(/\s+/), function(i, className){</span>
<a href="#l23.717"></a><span id="l23.717" class="difflineminus">-				if ( elem.nodeType == 1 &amp;&amp; !jQuery.className.has( elem.className, className ) )</span>
<a href="#l23.718"></a><span id="l23.718" class="difflineminus">-					elem.className += (elem.className ? &quot; &quot; : &quot;&quot;) + className;</span>
<a href="#l23.719"></a><span id="l23.719" class="difflineminus">-			});</span>
<a href="#l23.720"></a><span id="l23.720" class="difflineminus">-		},</span>
<a href="#l23.721"></a><span id="l23.721" class="difflineminus">-</span>
<a href="#l23.722"></a><span id="l23.722" class="difflineminus">-		// internal only, use removeClass(&quot;class&quot;)</span>
<a href="#l23.723"></a><span id="l23.723" class="difflineminus">-		remove: function( elem, classNames ) {</span>
<a href="#l23.724"></a><span id="l23.724" class="difflineminus">-			if (elem.nodeType == 1)</span>
<a href="#l23.725"></a><span id="l23.725" class="difflineminus">-				elem.className = classNames !== undefined ?</span>
<a href="#l23.726"></a><span id="l23.726" class="difflineminus">-					jQuery.grep(elem.className.split(/\s+/), function(className){</span>
<a href="#l23.727"></a><span id="l23.727" class="difflineminus">-						return !jQuery.className.has( classNames, className );</span>
<a href="#l23.728"></a><span id="l23.728" class="difflineminus">-					}).join(&quot; &quot;) :</span>
<a href="#l23.729"></a><span id="l23.729" class="difflineminus">-					&quot;&quot;;</span>
<a href="#l23.730"></a><span id="l23.730" class="difflineminus">-		},</span>
<a href="#l23.731"></a><span id="l23.731" class="difflineminus">-</span>
<a href="#l23.732"></a><span id="l23.732" class="difflineminus">-		// internal only, use hasClass(&quot;class&quot;)</span>
<a href="#l23.733"></a><span id="l23.733" class="difflineminus">-		has: function( elem, className ) {</span>
<a href="#l23.734"></a><span id="l23.734" class="difflineminus">-			return elem &amp;&amp; jQuery.inArray( className, (elem.className || elem).toString().split(/\s+/) ) &gt; -1;</span>
<a href="#l23.735"></a><span id="l23.735" class="difflineminus">-		}</span>
<a href="#l23.736"></a><span id="l23.736" class="difflineminus">-	},</span>
<a href="#l23.737"></a><span id="l23.737" class="difflineminus">-</span>
<a href="#l23.738"></a><span id="l23.738" class="difflineminus">-	// A method for quickly swapping in/out CSS properties to get correct calculations</span>
<a href="#l23.739"></a><span id="l23.739" class="difflineminus">-	swap: function( elem, options, callback ) {</span>
<a href="#l23.740"></a><span id="l23.740" class="difflineminus">-		var old = {};</span>
<a href="#l23.741"></a><span id="l23.741" class="difflineminus">-		// Remember the old values, and insert the new ones</span>
<a href="#l23.742"></a><span id="l23.742" class="difflineminus">-		for ( var name in options ) {</span>
<a href="#l23.743"></a><span id="l23.743" class="difflineminus">-			old[ name ] = elem.style[ name ];</span>
<a href="#l23.744"></a><span id="l23.744" class="difflineminus">-			elem.style[ name ] = options[ name ];</span>
<a href="#l23.745"></a><span id="l23.745" class="difflineminus">-		}</span>
<a href="#l23.746"></a><span id="l23.746" class="difflineminus">-</span>
<a href="#l23.747"></a><span id="l23.747" class="difflineminus">-		callback.call( elem );</span>
<a href="#l23.748"></a><span id="l23.748" class="difflineminus">-</span>
<a href="#l23.749"></a><span id="l23.749" class="difflineminus">-		// Revert the old values</span>
<a href="#l23.750"></a><span id="l23.750" class="difflineminus">-		for ( var name in options )</span>
<a href="#l23.751"></a><span id="l23.751" class="difflineminus">-			elem.style[ name ] = old[ name ];</span>
<a href="#l23.752"></a><span id="l23.752" class="difflineminus">-	},</span>
<a href="#l23.753"></a><span id="l23.753" class="difflineminus">-</span>
<a href="#l23.754"></a><span id="l23.754" class="difflineminus">-	css: function( elem, name, force, extra ) {</span>
<a href="#l23.755"></a><span id="l23.755" class="difflineminus">-		if ( name == &quot;width&quot; || name == &quot;height&quot; ) {</span>
<a href="#l23.756"></a><span id="l23.756" class="difflineminus">-			var val, props = { position: &quot;absolute&quot;, visibility: &quot;hidden&quot;, display:&quot;block&quot; }, which = name == &quot;width&quot; ? [ &quot;Left&quot;, &quot;Right&quot; ] : [ &quot;Top&quot;, &quot;Bottom&quot; ];</span>
<a href="#l23.757"></a><span id="l23.757" class="difflineminus">-</span>
<a href="#l23.758"></a><span id="l23.758" class="difflineminus">-			function getWH() {</span>
<a href="#l23.759"></a><span id="l23.759" class="difflineminus">-				val = name == &quot;width&quot; ? elem.offsetWidth : elem.offsetHeight;</span>
<a href="#l23.760"></a><span id="l23.760" class="difflineminus">-</span>
<a href="#l23.761"></a><span id="l23.761" class="difflineminus">-				if ( extra === &quot;border&quot; )</span>
<a href="#l23.762"></a><span id="l23.762" class="difflineminus">-					return;</span>
<a href="#l23.763"></a><span id="l23.763" class="difflineminus">-</span>
<a href="#l23.764"></a><span id="l23.764" class="difflineminus">-				jQuery.each( which, function() {</span>
<a href="#l23.765"></a><span id="l23.765" class="difflineminus">-					if ( !extra )</span>
<a href="#l23.766"></a><span id="l23.766" class="difflineminus">-						val -= parseFloat(jQuery.curCSS( elem, &quot;padding&quot; + this, true)) || 0;</span>
<a href="#l23.767"></a><span id="l23.767" class="difflineminus">-					if ( extra === &quot;margin&quot; )</span>
<a href="#l23.768"></a><span id="l23.768" class="difflineminus">-						val += parseFloat(jQuery.curCSS( elem, &quot;margin&quot; + this, true)) || 0;</span>
<a href="#l23.769"></a><span id="l23.769" class="difflineminus">-					else</span>
<a href="#l23.770"></a><span id="l23.770" class="difflineminus">-						val -= parseFloat(jQuery.curCSS( elem, &quot;border&quot; + this + &quot;Width&quot;, true)) || 0;</span>
<a href="#l23.771"></a><span id="l23.771" class="difflineminus">-				});</span>
<a href="#l23.772"></a><span id="l23.772" class="difflineminus">-			}</span>
<a href="#l23.773"></a><span id="l23.773" class="difflineminus">-</span>
<a href="#l23.774"></a><span id="l23.774" class="difflineminus">-			if ( elem.offsetWidth !== 0 )</span>
<a href="#l23.775"></a><span id="l23.775" class="difflineminus">-				getWH();</span>
<a href="#l23.776"></a><span id="l23.776" class="difflineminus">-			else</span>
<a href="#l23.777"></a><span id="l23.777" class="difflineminus">-				jQuery.swap( elem, props, getWH );</span>
<a href="#l23.778"></a><span id="l23.778" class="difflineminus">-</span>
<a href="#l23.779"></a><span id="l23.779" class="difflineminus">-			return Math.max(0, Math.round(val));</span>
<a href="#l23.780"></a><span id="l23.780" class="difflineminus">-		}</span>
<a href="#l23.781"></a><span id="l23.781" class="difflineminus">-</span>
<a href="#l23.782"></a><span id="l23.782" class="difflineminus">-		return jQuery.curCSS( elem, name, force );</span>
<a href="#l23.783"></a><span id="l23.783" class="difflineminus">-	},</span>
<a href="#l23.784"></a><span id="l23.784" class="difflineminus">-</span>
<a href="#l23.785"></a><span id="l23.785" class="difflineminus">-	curCSS: function( elem, name, force ) {</span>
<a href="#l23.786"></a><span id="l23.786" class="difflineminus">-		var ret, style = elem.style;</span>
<a href="#l23.787"></a><span id="l23.787" class="difflineminus">-</span>
<a href="#l23.788"></a><span id="l23.788" class="difflineminus">-		// We need to handle opacity special in IE</span>
<a href="#l23.789"></a><span id="l23.789" class="difflineminus">-		if ( name == &quot;opacity&quot; &amp;&amp; !jQuery.support.opacity ) {</span>
<a href="#l23.790"></a><span id="l23.790" class="difflineminus">-			ret = jQuery.attr( style, &quot;opacity&quot; );</span>
<a href="#l23.791"></a><span id="l23.791" class="difflineminus">-</span>
<a href="#l23.792"></a><span id="l23.792" class="difflineminus">-			return ret == &quot;&quot; ?</span>
<a href="#l23.793"></a><span id="l23.793" class="difflineminus">-				&quot;1&quot; :</span>
<a href="#l23.794"></a><span id="l23.794" class="difflineminus">-				ret;</span>
<a href="#l23.795"></a><span id="l23.795" class="difflineminus">-		}</span>
<a href="#l23.796"></a><span id="l23.796" class="difflineminus">-</span>
<a href="#l23.797"></a><span id="l23.797" class="difflineminus">-		// Make sure we're using the right name for getting the float value</span>
<a href="#l23.798"></a><span id="l23.798" class="difflineminus">-		if ( name.match( /float/i ) )</span>
<a href="#l23.799"></a><span id="l23.799" class="difflineminus">-			name = styleFloat;</span>
<a href="#l23.800"></a><span id="l23.800" class="difflineminus">-</span>
<a href="#l23.801"></a><span id="l23.801" class="difflineminus">-		if ( !force &amp;&amp; style &amp;&amp; style[ name ] )</span>
<a href="#l23.802"></a><span id="l23.802" class="difflineminus">-			ret = style[ name ];</span>
<a href="#l23.803"></a><span id="l23.803" class="difflineminus">-</span>
<a href="#l23.804"></a><span id="l23.804" class="difflineminus">-		else if ( defaultView.getComputedStyle ) {</span>
<a href="#l23.805"></a><span id="l23.805" class="difflineminus">-</span>
<a href="#l23.806"></a><span id="l23.806" class="difflineminus">-			// Only &quot;float&quot; is needed here</span>
<a href="#l23.807"></a><span id="l23.807" class="difflineminus">-			if ( name.match( /float/i ) )</span>
<a href="#l23.808"></a><span id="l23.808" class="difflineminus">-				name = &quot;float&quot;;</span>
<a href="#l23.809"></a><span id="l23.809" class="difflineminus">-</span>
<a href="#l23.810"></a><span id="l23.810" class="difflineminus">-			name = name.replace( /([A-Z])/g, &quot;-$1&quot; ).toLowerCase();</span>
<a href="#l23.811"></a><span id="l23.811" class="difflineminus">-</span>
<a href="#l23.812"></a><span id="l23.812" class="difflineminus">-			var computedStyle = defaultView.getComputedStyle( elem, null );</span>
<a href="#l23.813"></a><span id="l23.813" class="difflineminus">-</span>
<a href="#l23.814"></a><span id="l23.814" class="difflineminus">-			if ( computedStyle )</span>
<a href="#l23.815"></a><span id="l23.815" class="difflineminus">-				ret = computedStyle.getPropertyValue( name );</span>
<a href="#l23.816"></a><span id="l23.816" class="difflineminus">-</span>
<a href="#l23.817"></a><span id="l23.817" class="difflineminus">-			// We should always get a number back from opacity</span>
<a href="#l23.818"></a><span id="l23.818" class="difflineminus">-			if ( name == &quot;opacity&quot; &amp;&amp; ret == &quot;&quot; )</span>
<a href="#l23.819"></a><span id="l23.819" class="difflineminus">-				ret = &quot;1&quot;;</span>
<a href="#l23.820"></a><span id="l23.820" class="difflineminus">-</span>
<a href="#l23.821"></a><span id="l23.821" class="difflineminus">-		} else if ( elem.currentStyle ) {</span>
<a href="#l23.822"></a><span id="l23.822" class="difflineminus">-			var camelCase = name.replace(/\-(\w)/g, function(all, letter){</span>
<a href="#l23.823"></a><span id="l23.823" class="difflineminus">-				return letter.toUpperCase();</span>
<a href="#l23.824"></a><span id="l23.824" class="difflineminus">-			});</span>
<a href="#l23.825"></a><span id="l23.825" class="difflineminus">-</span>
<a href="#l23.826"></a><span id="l23.826" class="difflineminus">-			ret = elem.currentStyle[ name ] || elem.currentStyle[ camelCase ];</span>
<a href="#l23.827"></a><span id="l23.827" class="difflineminus">-</span>
<a href="#l23.828"></a><span id="l23.828" class="difflineminus">-			// From the awesome hack by Dean Edwards</span>
<a href="#l23.829"></a><span id="l23.829" class="difflineminus">-			// http://erik.eae.net/archives/2007/07/27/18.54.15/#comment-102291</span>
<a href="#l23.830"></a><span id="l23.830" class="difflineminus">-</span>
<a href="#l23.831"></a><span id="l23.831" class="difflineminus">-			// If we're not dealing with a regular pixel number</span>
<a href="#l23.832"></a><span id="l23.832" class="difflineminus">-			// but a number that has a weird ending, we need to convert it to pixels</span>
<a href="#l23.833"></a><span id="l23.833" class="difflineminus">-			if ( !/^\d+(px)?$/i.test( ret ) &amp;&amp; /^\d/.test( ret ) ) {</span>
<a href="#l23.834"></a><span id="l23.834" class="difflineminus">-				// Remember the original values</span>
<a href="#l23.835"></a><span id="l23.835" class="difflineminus">-				var left = style.left, rsLeft = elem.runtimeStyle.left;</span>
<a href="#l23.836"></a><span id="l23.836" class="difflineminus">-</span>
<a href="#l23.837"></a><span id="l23.837" class="difflineminus">-				// Put in the new values to get a computed value out</span>
<a href="#l23.838"></a><span id="l23.838" class="difflineminus">-				elem.runtimeStyle.left = elem.currentStyle.left;</span>
<a href="#l23.839"></a><span id="l23.839" class="difflineminus">-				style.left = ret || 0;</span>
<a href="#l23.840"></a><span id="l23.840" class="difflineminus">-				ret = style.pixelLeft + &quot;px&quot;;</span>
<a href="#l23.841"></a><span id="l23.841" class="difflineminus">-</span>
<a href="#l23.842"></a><span id="l23.842" class="difflineminus">-				// Revert the changed values</span>
<a href="#l23.843"></a><span id="l23.843" class="difflineminus">-				style.left = left;</span>
<a href="#l23.844"></a><span id="l23.844" class="difflineminus">-				elem.runtimeStyle.left = rsLeft;</span>
<a href="#l23.845"></a><span id="l23.845" class="difflineminus">-			}</span>
<a href="#l23.846"></a><span id="l23.846" class="difflineminus">-		}</span>
<a href="#l23.847"></a><span id="l23.847" class="difflineminus">-</span>
<a href="#l23.848"></a><span id="l23.848" class="difflineminus">-		return ret;</span>
<a href="#l23.849"></a><span id="l23.849" class="difflineminus">-	},</span>
<a href="#l23.850"></a><span id="l23.850" class="difflineminus">-</span>
<a href="#l23.851"></a><span id="l23.851" class="difflineminus">-	clean: function( elems, context, fragment ) {</span>
<a href="#l23.852"></a><span id="l23.852" class="difflineminus">-		context = context || document;</span>
<a href="#l23.853"></a><span id="l23.853" class="difflineminus">-</span>
<a href="#l23.854"></a><span id="l23.854" class="difflineminus">-		// !context.createElement fails in IE with an error but returns typeof 'object'</span>
<a href="#l23.855"></a><span id="l23.855" class="difflineminus">-		if ( typeof context.createElement === &quot;undefined&quot; )</span>
<a href="#l23.856"></a><span id="l23.856" class="difflineminus">-			context = context.ownerDocument || context[0] &amp;&amp; context[0].ownerDocument || document;</span>
<a href="#l23.857"></a><span id="l23.857" class="difflineminus">-</span>
<a href="#l23.858"></a><span id="l23.858" class="difflineminus">-		// If a single string is passed in and it's a single tag</span>
<a href="#l23.859"></a><span id="l23.859" class="difflineminus">-		// just do a createElement and skip the rest</span>
<a href="#l23.860"></a><span id="l23.860" class="difflineminus">-		if ( !fragment &amp;&amp; elems.length === 1 &amp;&amp; typeof elems[0] === &quot;string&quot; ) {</span>
<a href="#l23.861"></a><span id="l23.861" class="difflineminus">-			var match = /^&lt;(\w+)\s*\/?&gt;$/.exec(elems[0]);</span>
<a href="#l23.862"></a><span id="l23.862" class="difflineminus">-			if ( match )</span>
<a href="#l23.863"></a><span id="l23.863" class="difflineminus">-				return [ context.createElement( match[1] ) ];</span>
<a href="#l23.864"></a><span id="l23.864" class="difflineminus">-		}</span>
<a href="#l23.865"></a><span id="l23.865" class="difflineminus">-</span>
<a href="#l23.866"></a><span id="l23.866" class="difflineminus">-		var ret = [], scripts = [], div = context.createElement(&quot;div&quot;);</span>
<a href="#l23.867"></a><span id="l23.867" class="difflineminus">-</span>
<a href="#l23.868"></a><span id="l23.868" class="difflineminus">-		jQuery.each(elems, function(i, elem){</span>
<a href="#l23.869"></a><span id="l23.869" class="difflineminus">-			if ( typeof elem === &quot;number&quot; )</span>
<a href="#l23.870"></a><span id="l23.870" class="difflineminus">-				elem += '';</span>
<a href="#l23.871"></a><span id="l23.871" class="difflineminus">-</span>
<a href="#l23.872"></a><span id="l23.872" class="difflineminus">-			if ( !elem )</span>
<a href="#l23.873"></a><span id="l23.873" class="difflineminus">-				return;</span>
<a href="#l23.874"></a><span id="l23.874" class="difflineminus">-</span>
<a href="#l23.875"></a><span id="l23.875" class="difflineminus">-			// Convert html string into DOM nodes</span>
<a href="#l23.876"></a><span id="l23.876" class="difflineminus">-			if ( typeof elem === &quot;string&quot; ) {</span>
<a href="#l23.877"></a><span id="l23.877" class="difflineminus">-				// Fix &quot;XHTML&quot;-style tags in all browsers</span>
<a href="#l23.878"></a><span id="l23.878" class="difflineminus">-				elem = elem.replace(/(&lt;(\w+)[^&gt;]*?)\/&gt;/g, function(all, front, tag){</span>
<a href="#l23.879"></a><span id="l23.879" class="difflineminus">-					return tag.match(/^(abbr|br|col|img|input|link|meta|param|hr|area|embed)$/i) ?</span>
<a href="#l23.880"></a><span id="l23.880" class="difflineminus">-						all :</span>
<a href="#l23.881"></a><span id="l23.881" class="difflineminus">-						front + &quot;&gt;&lt;/&quot; + tag + &quot;&gt;&quot;;</span>
<a href="#l23.882"></a><span id="l23.882" class="difflineminus">-				});</span>
<a href="#l23.883"></a><span id="l23.883" class="difflineminus">-</span>
<a href="#l23.884"></a><span id="l23.884" class="difflineminus">-				// Trim whitespace, otherwise indexOf won't work as expected</span>
<a href="#l23.885"></a><span id="l23.885" class="difflineminus">-				var tags = elem.replace(/^\s+/, &quot;&quot;).substring(0, 10).toLowerCase();</span>
<a href="#l23.886"></a><span id="l23.886" class="difflineminus">-</span>
<a href="#l23.887"></a><span id="l23.887" class="difflineminus">-				var wrap =</span>
<a href="#l23.888"></a><span id="l23.888" class="difflineminus">-					// option or optgroup</span>
<a href="#l23.889"></a><span id="l23.889" class="difflineminus">-					!tags.indexOf(&quot;&lt;opt&quot;) &amp;&amp;</span>
<a href="#l23.890"></a><span id="l23.890" class="difflineminus">-					[ 1, &quot;&lt;select multiple='multiple'&gt;&quot;, &quot;&lt;/select&gt;&quot; ] ||</span>
<a href="#l23.891"></a><span id="l23.891" class="difflineminus">-</span>
<a href="#l23.892"></a><span id="l23.892" class="difflineminus">-					!tags.indexOf(&quot;&lt;leg&quot;) &amp;&amp;</span>
<a href="#l23.893"></a><span id="l23.893" class="difflineminus">-					[ 1, &quot;&lt;fieldset&gt;&quot;, &quot;&lt;/fieldset&gt;&quot; ] ||</span>
<a href="#l23.894"></a><span id="l23.894" class="difflineminus">-</span>
<a href="#l23.895"></a><span id="l23.895" class="difflineminus">-					tags.match(/^&lt;(thead|tbody|tfoot|colg|cap)/) &amp;&amp;</span>
<a href="#l23.896"></a><span id="l23.896" class="difflineminus">-					[ 1, &quot;&lt;table&gt;&quot;, &quot;&lt;/table&gt;&quot; ] ||</span>
<a href="#l23.897"></a><span id="l23.897" class="difflineminus">-</span>
<a href="#l23.898"></a><span id="l23.898" class="difflineminus">-					!tags.indexOf(&quot;&lt;tr&quot;) &amp;&amp;</span>
<a href="#l23.899"></a><span id="l23.899" class="difflineminus">-					[ 2, &quot;&lt;table&gt;&lt;tbody&gt;&quot;, &quot;&lt;/tbody&gt;&lt;/table&gt;&quot; ] ||</span>
<a href="#l23.900"></a><span id="l23.900" class="difflineminus">-</span>
<a href="#l23.901"></a><span id="l23.901" class="difflineminus">-				 	// &lt;thead&gt; matched above</span>
<a href="#l23.902"></a><span id="l23.902" class="difflineminus">-					(!tags.indexOf(&quot;&lt;td&quot;) || !tags.indexOf(&quot;&lt;th&quot;)) &amp;&amp;</span>
<a href="#l23.903"></a><span id="l23.903" class="difflineminus">-					[ 3, &quot;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&quot;, &quot;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&quot; ] ||</span>
<a href="#l23.904"></a><span id="l23.904" class="difflineminus">-</span>
<a href="#l23.905"></a><span id="l23.905" class="difflineminus">-					!tags.indexOf(&quot;&lt;col&quot;) &amp;&amp;</span>
<a href="#l23.906"></a><span id="l23.906" class="difflineminus">-					[ 2, &quot;&lt;table&gt;&lt;tbody&gt;&lt;/tbody&gt;&lt;colgroup&gt;&quot;, &quot;&lt;/colgroup&gt;&lt;/table&gt;&quot; ] ||</span>
<a href="#l23.907"></a><span id="l23.907" class="difflineminus">-</span>
<a href="#l23.908"></a><span id="l23.908" class="difflineminus">-					// IE can't serialize &lt;link&gt; and &lt;script&gt; tags normally</span>
<a href="#l23.909"></a><span id="l23.909" class="difflineminus">-					!jQuery.support.htmlSerialize &amp;&amp;</span>
<a href="#l23.910"></a><span id="l23.910" class="difflineminus">-					[ 1, &quot;div&lt;div&gt;&quot;, &quot;&lt;/div&gt;&quot; ] ||</span>
<a href="#l23.911"></a><span id="l23.911" class="difflineminus">-</span>
<a href="#l23.912"></a><span id="l23.912" class="difflineminus">-					[ 0, &quot;&quot;, &quot;&quot; ];</span>
<a href="#l23.913"></a><span id="l23.913" class="difflineminus">-</span>
<a href="#l23.914"></a><span id="l23.914" class="difflineminus">-				// Go to html and back, then peel off extra wrappers</span>
<a href="#l23.915"></a><span id="l23.915" class="difflineminus">-				div.innerHTML = wrap[1] + elem + wrap[2];</span>
<a href="#l23.916"></a><span id="l23.916" class="difflineminus">-</span>
<a href="#l23.917"></a><span id="l23.917" class="difflineminus">-				// Move to the right depth</span>
<a href="#l23.918"></a><span id="l23.918" class="difflineminus">-				while ( wrap[0]-- )</span>
<a href="#l23.919"></a><span id="l23.919" class="difflineminus">-					div = div.lastChild;</span>
<a href="#l23.920"></a><span id="l23.920" class="difflineminus">-</span>
<a href="#l23.921"></a><span id="l23.921" class="difflineminus">-				// Remove IE's autoinserted &lt;tbody&gt; from table fragments</span>
<a href="#l23.922"></a><span id="l23.922" class="difflineminus">-				if ( !jQuery.support.tbody ) {</span>
<a href="#l23.923"></a><span id="l23.923" class="difflineminus">-</span>
<a href="#l23.924"></a><span id="l23.924" class="difflineminus">-					// String was a &lt;table&gt;, *may* have spurious &lt;tbody&gt;</span>
<a href="#l23.925"></a><span id="l23.925" class="difflineminus">-					var hasBody = /&lt;tbody/i.test(elem),</span>
<a href="#l23.926"></a><span id="l23.926" class="difflineminus">-						tbody = !tags.indexOf(&quot;&lt;table&quot;) &amp;&amp; !hasBody ?</span>
<a href="#l23.927"></a><span id="l23.927" class="difflineminus">-							div.firstChild &amp;&amp; div.firstChild.childNodes :</span>
<a href="#l23.928"></a><span id="l23.928" class="difflineminus">-</span>
<a href="#l23.929"></a><span id="l23.929" class="difflineminus">-						// String was a bare &lt;thead&gt; or &lt;tfoot&gt;</span>
<a href="#l23.930"></a><span id="l23.930" class="difflineminus">-						wrap[1] == &quot;&lt;table&gt;&quot; &amp;&amp; !hasBody ?</span>
<a href="#l23.931"></a><span id="l23.931" class="difflineminus">-							div.childNodes :</span>
<a href="#l23.932"></a><span id="l23.932" class="difflineminus">-							[];</span>
<a href="#l23.933"></a><span id="l23.933" class="difflineminus">-</span>
<a href="#l23.934"></a><span id="l23.934" class="difflineminus">-					for ( var j = tbody.length - 1; j &gt;= 0 ; --j )</span>
<a href="#l23.935"></a><span id="l23.935" class="difflineminus">-						if ( jQuery.nodeName( tbody[ j ], &quot;tbody&quot; ) &amp;&amp; !tbody[ j ].childNodes.length )</span>
<a href="#l23.936"></a><span id="l23.936" class="difflineminus">-							tbody[ j ].parentNode.removeChild( tbody[ j ] );</span>
<a href="#l23.937"></a><span id="l23.937" class="difflineminus">-</span>
<a href="#l23.938"></a><span id="l23.938" class="difflineminus">-					}</span>
<a href="#l23.939"></a><span id="l23.939" class="difflineminus">-</span>
<a href="#l23.940"></a><span id="l23.940" class="difflineminus">-				// IE completely kills leading whitespace when innerHTML is used</span>
<a href="#l23.941"></a><span id="l23.941" class="difflineminus">-				if ( !jQuery.support.leadingWhitespace &amp;&amp; /^\s/.test( elem ) )</span>
<a href="#l23.942"></a><span id="l23.942" class="difflineminus">-					div.insertBefore( context.createTextNode( elem.match(/^\s*/)[0] ), div.firstChild );</span>
<a href="#l23.943"></a><span id="l23.943" class="difflineminus">-				</span>
<a href="#l23.944"></a><span id="l23.944" class="difflineminus">-				elem = jQuery.makeArray( div.childNodes );</span>
<a href="#l23.945"></a><span id="l23.945" class="difflineminus">-			}</span>
<a href="#l23.946"></a><span id="l23.946" class="difflineminus">-</span>
<a href="#l23.947"></a><span id="l23.947" class="difflineminus">-			if ( elem.nodeType )</span>
<a href="#l23.948"></a><span id="l23.948" class="difflineminus">-				ret.push( elem );</span>
<a href="#l23.949"></a><span id="l23.949" class="difflineminus">-			else</span>
<a href="#l23.950"></a><span id="l23.950" class="difflineminus">-				ret = jQuery.merge( ret, elem );</span>
<a href="#l23.951"></a><span id="l23.951" class="difflineminus">-</span>
<a href="#l23.952"></a><span id="l23.952" class="difflineminus">-		});</span>
<a href="#l23.953"></a><span id="l23.953" class="difflineminus">-</span>
<a href="#l23.954"></a><span id="l23.954" class="difflineminus">-		if ( fragment ) {</span>
<a href="#l23.955"></a><span id="l23.955" class="difflineminus">-			for ( var i = 0; ret[i]; i++ ) {</span>
<a href="#l23.956"></a><span id="l23.956" class="difflineminus">-				if ( jQuery.nodeName( ret[i], &quot;script&quot; ) &amp;&amp; (!ret[i].type || ret[i].type.toLowerCase() === &quot;text/javascript&quot;) ) {</span>
<a href="#l23.957"></a><span id="l23.957" class="difflineminus">-					scripts.push( ret[i].parentNode ? ret[i].parentNode.removeChild( ret[i] ) : ret[i] );</span>
<a href="#l23.958"></a><span id="l23.958" class="difflineminus">-				} else {</span>
<a href="#l23.959"></a><span id="l23.959" class="difflineminus">-					if ( ret[i].nodeType === 1 )</span>
<a href="#l23.960"></a><span id="l23.960" class="difflineminus">-						ret.splice.apply( ret, [i + 1, 0].concat(jQuery.makeArray(ret[i].getElementsByTagName(&quot;script&quot;))) );</span>
<a href="#l23.961"></a><span id="l23.961" class="difflineminus">-					fragment.appendChild( ret[i] );</span>
<a href="#l23.962"></a><span id="l23.962" class="difflineminus">-				}</span>
<a href="#l23.963"></a><span id="l23.963" class="difflineminus">-			}</span>
<a href="#l23.964"></a><span id="l23.964" class="difflineminus">-			</span>
<a href="#l23.965"></a><span id="l23.965" class="difflineminus">-			return scripts;</span>
<a href="#l23.966"></a><span id="l23.966" class="difflineminus">-		}</span>
<a href="#l23.967"></a><span id="l23.967" class="difflineminus">-</span>
<a href="#l23.968"></a><span id="l23.968" class="difflineminus">-		return ret;</span>
<a href="#l23.969"></a><span id="l23.969" class="difflineminus">-	},</span>
<a href="#l23.970"></a><span id="l23.970" class="difflineminus">-</span>
<a href="#l23.971"></a><span id="l23.971" class="difflineminus">-	attr: function( elem, name, value ) {</span>
<a href="#l23.972"></a><span id="l23.972" class="difflineminus">-		// don't set attributes on text and comment nodes</span>
<a href="#l23.973"></a><span id="l23.973" class="difflineminus">-		if (!elem || elem.nodeType == 3 || elem.nodeType == 8)</span>
<a href="#l23.974"></a><span id="l23.974" class="difflineminus">-			return undefined;</span>
<a href="#l23.975"></a><span id="l23.975" class="difflineminus">-</span>
<a href="#l23.976"></a><span id="l23.976" class="difflineminus">-		var notxml = !jQuery.isXMLDoc( elem ),</span>
<a href="#l23.977"></a><span id="l23.977" class="difflineminus">-			// Whether we are setting (or getting)</span>
<a href="#l23.978"></a><span id="l23.978" class="difflineminus">-			set = value !== undefined;</span>
<a href="#l23.979"></a><span id="l23.979" class="difflineminus">-</span>
<a href="#l23.980"></a><span id="l23.980" class="difflineminus">-		// Try to normalize/fix the name</span>
<a href="#l23.981"></a><span id="l23.981" class="difflineminus">-		name = notxml &amp;&amp; jQuery.props[ name ] || name;</span>
<a href="#l23.982"></a><span id="l23.982" class="difflineminus">-</span>
<a href="#l23.983"></a><span id="l23.983" class="difflineminus">-		// Only do all the following if this is a node (faster for style)</span>
<a href="#l23.984"></a><span id="l23.984" class="difflineminus">-		// IE elem.getAttribute passes even for style</span>
<a href="#l23.985"></a><span id="l23.985" class="difflineminus">-		if ( elem.tagName ) {</span>
<a href="#l23.986"></a><span id="l23.986" class="difflineminus">-</span>
<a href="#l23.987"></a><span id="l23.987" class="difflineminus">-			// These attributes require special treatment</span>
<a href="#l23.988"></a><span id="l23.988" class="difflineminus">-			var special = /href|src|style/.test( name );</span>
<a href="#l23.989"></a><span id="l23.989" class="difflineminus">-</span>
<a href="#l23.990"></a><span id="l23.990" class="difflineminus">-			// Safari mis-reports the default selected property of a hidden option</span>
<a href="#l23.991"></a><span id="l23.991" class="difflineminus">-			// Accessing the parent's selectedIndex property fixes it</span>
<a href="#l23.992"></a><span id="l23.992" class="difflineminus">-			if ( name == &quot;selected&quot; &amp;&amp; elem.parentNode )</span>
<a href="#l23.993"></a><span id="l23.993" class="difflineminus">-				elem.parentNode.selectedIndex;</span>
<a href="#l23.994"></a><span id="l23.994" class="difflineminus">-</span>
<a href="#l23.995"></a><span id="l23.995" class="difflineminus">-			// If applicable, access the attribute via the DOM 0 way</span>
<a href="#l23.996"></a><span id="l23.996" class="difflineminus">-			if ( name in elem &amp;&amp; notxml &amp;&amp; !special ) {</span>
<a href="#l23.997"></a><span id="l23.997" class="difflineminus">-				if ( set ){</span>
<a href="#l23.998"></a><span id="l23.998" class="difflineminus">-					// We can't allow the type property to be changed (since it causes problems in IE)</span>
<a href="#l23.999"></a><span id="l23.999" class="difflineminus">-					if ( name == &quot;type&quot; &amp;&amp; jQuery.nodeName( elem, &quot;input&quot; ) &amp;&amp; elem.parentNode )</span>
<a href="#l23.1000"></a><span id="l23.1000" class="difflineminus">-						throw &quot;type property can't be changed&quot;;</span>
<a href="#l23.1001"></a><span id="l23.1001" class="difflineminus">-</span>
<a href="#l23.1002"></a><span id="l23.1002" class="difflineminus">-					elem[ name ] = value;</span>
<a href="#l23.1003"></a><span id="l23.1003" class="difflineminus">-				}</span>
<a href="#l23.1004"></a><span id="l23.1004" class="difflineminus">-</span>
<a href="#l23.1005"></a><span id="l23.1005" class="difflineminus">-				// browsers index elements by id/name on forms, give priority to attributes.</span>
<a href="#l23.1006"></a><span id="l23.1006" class="difflineminus">-				if( jQuery.nodeName( elem, &quot;form&quot; ) &amp;&amp; elem.getAttributeNode(name) )</span>
<a href="#l23.1007"></a><span id="l23.1007" class="difflineminus">-					return elem.getAttributeNode( name ).nodeValue;</span>
<a href="#l23.1008"></a><span id="l23.1008" class="difflineminus">-</span>
<a href="#l23.1009"></a><span id="l23.1009" class="difflineminus">-				// elem.tabIndex doesn't always return the correct value when it hasn't been explicitly set</span>
<a href="#l23.1010"></a><span id="l23.1010" class="difflineminus">-				// http://fluidproject.org/blog/2008/01/09/getting-setting-and-removing-tabindex-values-with-javascript/</span>
<a href="#l23.1011"></a><span id="l23.1011" class="difflineminus">-				if ( name == &quot;tabIndex&quot; ) {</span>
<a href="#l23.1012"></a><span id="l23.1012" class="difflineminus">-					var attributeNode = elem.getAttributeNode( &quot;tabIndex&quot; );</span>
<a href="#l23.1013"></a><span id="l23.1013" class="difflineminus">-					return attributeNode &amp;&amp; attributeNode.specified</span>
<a href="#l23.1014"></a><span id="l23.1014" class="difflineminus">-						? attributeNode.value</span>
<a href="#l23.1015"></a><span id="l23.1015" class="difflineminus">-						: elem.nodeName.match(/(button|input|object|select|textarea)/i)</span>
<a href="#l23.1016"></a><span id="l23.1016" class="difflineminus">-							? 0</span>
<a href="#l23.1017"></a><span id="l23.1017" class="difflineminus">-							: elem.nodeName.match(/^(a|area)$/i) &amp;&amp; elem.href</span>
<a href="#l23.1018"></a><span id="l23.1018" class="difflineminus">-								? 0</span>
<a href="#l23.1019"></a><span id="l23.1019" class="difflineminus">-								: undefined;</span>
<a href="#l23.1020"></a><span id="l23.1020" class="difflineminus">-				}</span>
<a href="#l23.1021"></a><span id="l23.1021" class="difflineminus">-</span>
<a href="#l23.1022"></a><span id="l23.1022" class="difflineminus">-				return elem[ name ];</span>
<a href="#l23.1023"></a><span id="l23.1023" class="difflineminus">-			}</span>
<a href="#l23.1024"></a><span id="l23.1024" class="difflineminus">-</span>
<a href="#l23.1025"></a><span id="l23.1025" class="difflineminus">-			if ( !jQuery.support.style &amp;&amp; notxml &amp;&amp;  name == &quot;style&quot; )</span>
<a href="#l23.1026"></a><span id="l23.1026" class="difflineminus">-				return jQuery.attr( elem.style, &quot;cssText&quot;, value );</span>
<a href="#l23.1027"></a><span id="l23.1027" class="difflineminus">-</span>
<a href="#l23.1028"></a><span id="l23.1028" class="difflineminus">-			if ( set )</span>
<a href="#l23.1029"></a><span id="l23.1029" class="difflineminus">-				// convert the value to a string (all browsers do this but IE) see #1070</span>
<a href="#l23.1030"></a><span id="l23.1030" class="difflineminus">-				elem.setAttribute( name, &quot;&quot; + value );</span>
<a href="#l23.1031"></a><span id="l23.1031" class="difflineminus">-</span>
<a href="#l23.1032"></a><span id="l23.1032" class="difflineminus">-			var attr = !jQuery.support.hrefNormalized &amp;&amp; notxml &amp;&amp; special</span>
<a href="#l23.1033"></a><span id="l23.1033" class="difflineminus">-					// Some attributes require a special call on IE</span>
<a href="#l23.1034"></a><span id="l23.1034" class="difflineminus">-					? elem.getAttribute( name, 2 )</span>
<a href="#l23.1035"></a><span id="l23.1035" class="difflineminus">-					: elem.getAttribute( name );</span>
<a href="#l23.1036"></a><span id="l23.1036" class="difflineminus">-</span>
<a href="#l23.1037"></a><span id="l23.1037" class="difflineminus">-			// Non-existent attributes return null, we normalize to undefined</span>
<a href="#l23.1038"></a><span id="l23.1038" class="difflineminus">-			return attr === null ? undefined : attr;</span>
<a href="#l23.1039"></a><span id="l23.1039" class="difflineminus">-		}</span>
<a href="#l23.1040"></a><span id="l23.1040" class="difflineminus">-</span>
<a href="#l23.1041"></a><span id="l23.1041" class="difflineminus">-		// elem is actually elem.style ... set the style</span>
<a href="#l23.1042"></a><span id="l23.1042" class="difflineminus">-</span>
<a href="#l23.1043"></a><span id="l23.1043" class="difflineminus">-		// IE uses filters for opacity</span>
<a href="#l23.1044"></a><span id="l23.1044" class="difflineminus">-		if ( !jQuery.support.opacity &amp;&amp; name == &quot;opacity&quot; ) {</span>
<a href="#l23.1045"></a><span id="l23.1045" class="difflineminus">-			if ( set ) {</span>
<a href="#l23.1046"></a><span id="l23.1046" class="difflineminus">-				// IE has trouble with opacity if it does not have layout</span>
<a href="#l23.1047"></a><span id="l23.1047" class="difflineminus">-				// Force it by setting the zoom level</span>
<a href="#l23.1048"></a><span id="l23.1048" class="difflineminus">-				elem.zoom = 1;</span>
<a href="#l23.1049"></a><span id="l23.1049" class="difflineminus">-</span>
<a href="#l23.1050"></a><span id="l23.1050" class="difflineminus">-				// Set the alpha filter to set the opacity</span>
<a href="#l23.1051"></a><span id="l23.1051" class="difflineminus">-				elem.filter = (elem.filter || &quot;&quot;).replace( /alpha\([^)]*\)/, &quot;&quot; ) +</span>
<a href="#l23.1052"></a><span id="l23.1052" class="difflineminus">-					(parseInt( value ) + '' == &quot;NaN&quot; ? &quot;&quot; : &quot;alpha(opacity=&quot; + value * 100 + &quot;)&quot;);</span>
<a href="#l23.1053"></a><span id="l23.1053" class="difflineminus">-			}</span>
<a href="#l23.1054"></a><span id="l23.1054" class="difflineminus">-</span>
<a href="#l23.1055"></a><span id="l23.1055" class="difflineminus">-			return elem.filter &amp;&amp; elem.filter.indexOf(&quot;opacity=&quot;) &gt;= 0 ?</span>
<a href="#l23.1056"></a><span id="l23.1056" class="difflineminus">-				(parseFloat( elem.filter.match(/opacity=([^)]*)/)[1] ) / 100) + '':</span>
<a href="#l23.1057"></a><span id="l23.1057" class="difflineminus">-				&quot;&quot;;</span>
<a href="#l23.1058"></a><span id="l23.1058" class="difflineminus">-		}</span>
<a href="#l23.1059"></a><span id="l23.1059" class="difflineminus">-</span>
<a href="#l23.1060"></a><span id="l23.1060" class="difflineminus">-		name = name.replace(/-([a-z])/ig, function(all, letter){</span>
<a href="#l23.1061"></a><span id="l23.1061" class="difflineminus">-			return letter.toUpperCase();</span>
<a href="#l23.1062"></a><span id="l23.1062" class="difflineminus">-		});</span>
<a href="#l23.1063"></a><span id="l23.1063" class="difflineminus">-</span>
<a href="#l23.1064"></a><span id="l23.1064" class="difflineminus">-		if ( set )</span>
<a href="#l23.1065"></a><span id="l23.1065" class="difflineminus">-			elem[ name ] = value;</span>
<a href="#l23.1066"></a><span id="l23.1066" class="difflineminus">-</span>
<a href="#l23.1067"></a><span id="l23.1067" class="difflineminus">-		return elem[ name ];</span>
<a href="#l23.1068"></a><span id="l23.1068" class="difflineminus">-	},</span>
<a href="#l23.1069"></a><span id="l23.1069" class="difflineminus">-</span>
<a href="#l23.1070"></a><span id="l23.1070" class="difflineminus">-	trim: function( text ) {</span>
<a href="#l23.1071"></a><span id="l23.1071" class="difflineminus">-		return (text || &quot;&quot;).replace( /^\s+|\s+$/g, &quot;&quot; );</span>
<a href="#l23.1072"></a><span id="l23.1072" class="difflineminus">-	},</span>
<a href="#l23.1073"></a><span id="l23.1073" class="difflineminus">-</span>
<a href="#l23.1074"></a><span id="l23.1074" class="difflineminus">-	makeArray: function( array ) {</span>
<a href="#l23.1075"></a><span id="l23.1075" class="difflineminus">-		var ret = [];</span>
<a href="#l23.1076"></a><span id="l23.1076" class="difflineminus">-</span>
<a href="#l23.1077"></a><span id="l23.1077" class="difflineminus">-		if( array != null ){</span>
<a href="#l23.1078"></a><span id="l23.1078" class="difflineminus">-			var i = array.length;</span>
<a href="#l23.1079"></a><span id="l23.1079" class="difflineminus">-			// The window, strings (and functions) also have 'length'</span>
<a href="#l23.1080"></a><span id="l23.1080" class="difflineminus">-			if( i == null || typeof array === &quot;string&quot; || jQuery.isFunction(array) || array.setInterval )</span>
<a href="#l23.1081"></a><span id="l23.1081" class="difflineminus">-				ret[0] = array;</span>
<a href="#l23.1082"></a><span id="l23.1082" class="difflineminus">-			else</span>
<a href="#l23.1083"></a><span id="l23.1083" class="difflineminus">-				while( i )</span>
<a href="#l23.1084"></a><span id="l23.1084" class="difflineminus">-					ret[--i] = array[i];</span>
<a href="#l23.1085"></a><span id="l23.1085" class="difflineminus">-		}</span>
<a href="#l23.1086"></a><span id="l23.1086" class="difflineminus">-</span>
<a href="#l23.1087"></a><span id="l23.1087" class="difflineminus">-		return ret;</span>
<a href="#l23.1088"></a><span id="l23.1088" class="difflineminus">-	},</span>
<a href="#l23.1089"></a><span id="l23.1089" class="difflineminus">-</span>
<a href="#l23.1090"></a><span id="l23.1090" class="difflineminus">-	inArray: function( elem, array ) {</span>
<a href="#l23.1091"></a><span id="l23.1091" class="difflineminus">-		for ( var i = 0, length = array.length; i &lt; length; i++ )</span>
<a href="#l23.1092"></a><span id="l23.1092" class="difflineminus">-		// Use === because on IE, window == document</span>
<a href="#l23.1093"></a><span id="l23.1093" class="difflineminus">-			if ( array[ i ] === elem )</span>
<a href="#l23.1094"></a><span id="l23.1094" class="difflineminus">-				return i;</span>
<a href="#l23.1095"></a><span id="l23.1095" class="difflineminus">-</span>
<a href="#l23.1096"></a><span id="l23.1096" class="difflineminus">-		return -1;</span>
<a href="#l23.1097"></a><span id="l23.1097" class="difflineminus">-	},</span>
<a href="#l23.1098"></a><span id="l23.1098" class="difflineminus">-</span>
<a href="#l23.1099"></a><span id="l23.1099" class="difflineminus">-	merge: function( first, second ) {</span>
<a href="#l23.1100"></a><span id="l23.1100" class="difflineminus">-		// We have to loop this way because IE &amp; Opera overwrite the length</span>
<a href="#l23.1101"></a><span id="l23.1101" class="difflineminus">-		// expando of getElementsByTagName</span>
<a href="#l23.1102"></a><span id="l23.1102" class="difflineminus">-		var i = 0, elem, pos = first.length;</span>
<a href="#l23.1103"></a><span id="l23.1103" class="difflineminus">-		// Also, we need to make sure that the correct elements are being returned</span>
<a href="#l23.1104"></a><span id="l23.1104" class="difflineminus">-		// (IE returns comment nodes in a '*' query)</span>
<a href="#l23.1105"></a><span id="l23.1105" class="difflineminus">-		if ( !jQuery.support.getAll ) {</span>
<a href="#l23.1106"></a><span id="l23.1106" class="difflineminus">-			while ( (elem = second[ i++ ]) != null )</span>
<a href="#l23.1107"></a><span id="l23.1107" class="difflineminus">-				if ( elem.nodeType != 8 )</span>
<a href="#l23.1108"></a><span id="l23.1108" class="difflineminus">-					first[ pos++ ] = elem;</span>
<a href="#l23.1109"></a><span id="l23.1109" class="difflineminus">-</span>
<a href="#l23.1110"></a><span id="l23.1110" class="difflineminus">-		} else</span>
<a href="#l23.1111"></a><span id="l23.1111" class="difflineminus">-			while ( (elem = second[ i++ ]) != null )</span>
<a href="#l23.1112"></a><span id="l23.1112" class="difflineminus">-				first[ pos++ ] = elem;</span>
<a href="#l23.1113"></a><span id="l23.1113" class="difflineminus">-</span>
<a href="#l23.1114"></a><span id="l23.1114" class="difflineminus">-		return first;</span>
<a href="#l23.1115"></a><span id="l23.1115" class="difflineminus">-	},</span>
<a href="#l23.1116"></a><span id="l23.1116" class="difflineminus">-</span>
<a href="#l23.1117"></a><span id="l23.1117" class="difflineminus">-	unique: function( array ) {</span>
<a href="#l23.1118"></a><span id="l23.1118" class="difflineminus">-		var ret = [], done = {};</span>
<a href="#l23.1119"></a><span id="l23.1119" class="difflineminus">-</span>
<a href="#l23.1120"></a><span id="l23.1120" class="difflineminus">-		try {</span>
<a href="#l23.1121"></a><span id="l23.1121" class="difflineminus">-</span>
<a href="#l23.1122"></a><span id="l23.1122" class="difflineminus">-			for ( var i = 0, length = array.length; i &lt; length; i++ ) {</span>
<a href="#l23.1123"></a><span id="l23.1123" class="difflineminus">-				var id = jQuery.data( array[ i ] );</span>
<a href="#l23.1124"></a><span id="l23.1124" class="difflineminus">-</span>
<a href="#l23.1125"></a><span id="l23.1125" class="difflineminus">-				if ( !done[ id ] ) {</span>
<a href="#l23.1126"></a><span id="l23.1126" class="difflineminus">-					done[ id ] = true;</span>
<a href="#l23.1127"></a><span id="l23.1127" class="difflineminus">-					ret.push( array[ i ] );</span>
<a href="#l23.1128"></a><span id="l23.1128" class="difflineminus">-				}</span>
<a href="#l23.1129"></a><span id="l23.1129" class="difflineminus">-			}</span>
<a href="#l23.1130"></a><span id="l23.1130" class="difflineminus">-</span>
<a href="#l23.1131"></a><span id="l23.1131" class="difflineminus">-		} catch( e ) {</span>
<a href="#l23.1132"></a><span id="l23.1132" class="difflineminus">-			ret = array;</span>
<a href="#l23.1133"></a><span id="l23.1133" class="difflineminus">-		}</span>
<a href="#l23.1134"></a><span id="l23.1134" class="difflineminus">-</span>
<a href="#l23.1135"></a><span id="l23.1135" class="difflineminus">-		return ret;</span>
<a href="#l23.1136"></a><span id="l23.1136" class="difflineminus">-	},</span>
<a href="#l23.1137"></a><span id="l23.1137" class="difflineminus">-</span>
<a href="#l23.1138"></a><span id="l23.1138" class="difflineminus">-	grep: function( elems, callback, inv ) {</span>
<a href="#l23.1139"></a><span id="l23.1139" class="difflineminus">-		var ret = [];</span>
<a href="#l23.1140"></a><span id="l23.1140" class="difflineminus">-</span>
<a href="#l23.1141"></a><span id="l23.1141" class="difflineminus">-		// Go through the array, only saving the items</span>
<a href="#l23.1142"></a><span id="l23.1142" class="difflineminus">-		// that pass the validator function</span>
<a href="#l23.1143"></a><span id="l23.1143" class="difflineminus">-		for ( var i = 0, length = elems.length; i &lt; length; i++ )</span>
<a href="#l23.1144"></a><span id="l23.1144" class="difflineminus">-			if ( !inv != !callback( elems[ i ], i ) )</span>
<a href="#l23.1145"></a><span id="l23.1145" class="difflineminus">-				ret.push( elems[ i ] );</span>
<a href="#l23.1146"></a><span id="l23.1146" class="difflineminus">-</span>
<a href="#l23.1147"></a><span id="l23.1147" class="difflineminus">-		return ret;</span>
<a href="#l23.1148"></a><span id="l23.1148" class="difflineminus">-	},</span>
<a href="#l23.1149"></a><span id="l23.1149" class="difflineminus">-</span>
<a href="#l23.1150"></a><span id="l23.1150" class="difflineminus">-	map: function( elems, callback ) {</span>
<a href="#l23.1151"></a><span id="l23.1151" class="difflineminus">-		var ret = [];</span>
<a href="#l23.1152"></a><span id="l23.1152" class="difflineminus">-</span>
<a href="#l23.1153"></a><span id="l23.1153" class="difflineminus">-		// Go through the array, translating each of the items to their</span>
<a href="#l23.1154"></a><span id="l23.1154" class="difflineminus">-		// new value (or values).</span>
<a href="#l23.1155"></a><span id="l23.1155" class="difflineminus">-		for ( var i = 0, length = elems.length; i &lt; length; i++ ) {</span>
<a href="#l23.1156"></a><span id="l23.1156" class="difflineminus">-			var value = callback( elems[ i ], i );</span>
<a href="#l23.1157"></a><span id="l23.1157" class="difflineminus">-</span>
<a href="#l23.1158"></a><span id="l23.1158" class="difflineminus">-			if ( value != null )</span>
<a href="#l23.1159"></a><span id="l23.1159" class="difflineminus">-				ret[ ret.length ] = value;</span>
<a href="#l23.1160"></a><span id="l23.1160" class="difflineminus">-		}</span>
<a href="#l23.1161"></a><span id="l23.1161" class="difflineminus">-</span>
<a href="#l23.1162"></a><span id="l23.1162" class="difflineminus">-		return ret.concat.apply( [], ret );</span>
<a href="#l23.1163"></a><span id="l23.1163" class="difflineminus">-	}</span>
<a href="#l23.1164"></a><span id="l23.1164" class="difflineminus">-});</span>
<a href="#l23.1165"></a><span id="l23.1165" class="difflineminus">-</span>
<a href="#l23.1166"></a><span id="l23.1166" class="difflineminus">-// Use of jQuery.browser is deprecated.</span>
<a href="#l23.1167"></a><span id="l23.1167" class="difflineminus">-// It's included for backwards compatibility and plugins,</span>
<a href="#l23.1168"></a><span id="l23.1168" class="difflineminus">-// although they should work to migrate away.</span>
<a href="#l23.1169"></a><span id="l23.1169" class="difflineminus">-</span>
<a href="#l23.1170"></a><span id="l23.1170" class="difflineminus">-var userAgent = navigator.userAgent.toLowerCase();</span>
<a href="#l23.1171"></a><span id="l23.1171" class="difflineminus">-</span>
<a href="#l23.1172"></a><span id="l23.1172" class="difflineminus">-// Figure out what browser is being used</span>
<a href="#l23.1173"></a><span id="l23.1173" class="difflineminus">-jQuery.browser = {</span>
<a href="#l23.1174"></a><span id="l23.1174" class="difflineminus">-	version: (userAgent.match( /.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/ ) || [0,'0'])[1],</span>
<a href="#l23.1175"></a><span id="l23.1175" class="difflineminus">-	safari: /webkit/.test( userAgent ),</span>
<a href="#l23.1176"></a><span id="l23.1176" class="difflineminus">-	opera: /opera/.test( userAgent ),</span>
<a href="#l23.1177"></a><span id="l23.1177" class="difflineminus">-	msie: /msie/.test( userAgent ) &amp;&amp; !/opera/.test( userAgent ),</span>
<a href="#l23.1178"></a><span id="l23.1178" class="difflineminus">-	mozilla: /mozilla/.test( userAgent ) &amp;&amp; !/(compatible|webkit)/.test( userAgent )</span>
<a href="#l23.1179"></a><span id="l23.1179" class="difflineminus">-};</span>
<a href="#l23.1180"></a><span id="l23.1180" class="difflineminus">-</span>
<a href="#l23.1181"></a><span id="l23.1181" class="difflineminus">-jQuery.each({</span>
<a href="#l23.1182"></a><span id="l23.1182" class="difflineminus">-	parent: function(elem){return elem.parentNode;},</span>
<a href="#l23.1183"></a><span id="l23.1183" class="difflineminus">-	parents: function(elem){return jQuery.dir(elem,&quot;parentNode&quot;);},</span>
<a href="#l23.1184"></a><span id="l23.1184" class="difflineminus">-	next: function(elem){return jQuery.nth(elem,2,&quot;nextSibling&quot;);},</span>
<a href="#l23.1185"></a><span id="l23.1185" class="difflineminus">-	prev: function(elem){return jQuery.nth(elem,2,&quot;previousSibling&quot;);},</span>
<a href="#l23.1186"></a><span id="l23.1186" class="difflineminus">-	nextAll: function(elem){return jQuery.dir(elem,&quot;nextSibling&quot;);},</span>
<a href="#l23.1187"></a><span id="l23.1187" class="difflineminus">-	prevAll: function(elem){return jQuery.dir(elem,&quot;previousSibling&quot;);},</span>
<a href="#l23.1188"></a><span id="l23.1188" class="difflineminus">-	siblings: function(elem){return jQuery.sibling(elem.parentNode.firstChild,elem);},</span>
<a href="#l23.1189"></a><span id="l23.1189" class="difflineminus">-	children: function(elem){return jQuery.sibling(elem.firstChild);},</span>
<a href="#l23.1190"></a><span id="l23.1190" class="difflineminus">-	contents: function(elem){return jQuery.nodeName(elem,&quot;iframe&quot;)?elem.contentDocument||elem.contentWindow.document:jQuery.makeArray(elem.childNodes);}</span>
<a href="#l23.1191"></a><span id="l23.1191" class="difflineminus">-}, function(name, fn){</span>
<a href="#l23.1192"></a><span id="l23.1192" class="difflineminus">-	jQuery.fn[ name ] = function( selector ) {</span>
<a href="#l23.1193"></a><span id="l23.1193" class="difflineminus">-		var ret = jQuery.map( this, fn );</span>
<a href="#l23.1194"></a><span id="l23.1194" class="difflineminus">-</span>
<a href="#l23.1195"></a><span id="l23.1195" class="difflineminus">-		if ( selector &amp;&amp; typeof selector == &quot;string&quot; )</span>
<a href="#l23.1196"></a><span id="l23.1196" class="difflineminus">-			ret = jQuery.multiFilter( selector, ret );</span>
<a href="#l23.1197"></a><span id="l23.1197" class="difflineminus">-</span>
<a href="#l23.1198"></a><span id="l23.1198" class="difflineminus">-		return this.pushStack( jQuery.unique( ret ), name, selector );</span>
<a href="#l23.1199"></a><span id="l23.1199" class="difflineminus">-	};</span>
<a href="#l23.1200"></a><span id="l23.1200" class="difflineminus">-});</span>
<a href="#l23.1201"></a><span id="l23.1201" class="difflineminus">-</span>
<a href="#l23.1202"></a><span id="l23.1202" class="difflineminus">-jQuery.each({</span>
<a href="#l23.1203"></a><span id="l23.1203" class="difflineminus">-	appendTo: &quot;append&quot;,</span>
<a href="#l23.1204"></a><span id="l23.1204" class="difflineminus">-	prependTo: &quot;prepend&quot;,</span>
<a href="#l23.1205"></a><span id="l23.1205" class="difflineminus">-	insertBefore: &quot;before&quot;,</span>
<a href="#l23.1206"></a><span id="l23.1206" class="difflineminus">-	insertAfter: &quot;after&quot;,</span>
<a href="#l23.1207"></a><span id="l23.1207" class="difflineminus">-	replaceAll: &quot;replaceWith&quot;</span>
<a href="#l23.1208"></a><span id="l23.1208" class="difflineminus">-}, function(name, original){</span>
<a href="#l23.1209"></a><span id="l23.1209" class="difflineminus">-	jQuery.fn[ name ] = function( selector ) {</span>
<a href="#l23.1210"></a><span id="l23.1210" class="difflineminus">-		var ret = [], insert = jQuery( selector );</span>
<a href="#l23.1211"></a><span id="l23.1211" class="difflineminus">-</span>
<a href="#l23.1212"></a><span id="l23.1212" class="difflineminus">-		for ( var i = 0, l = insert.length; i &lt; l; i++ ) {</span>
<a href="#l23.1213"></a><span id="l23.1213" class="difflineminus">-			var elems = (i &gt; 0 ? this.clone(true) : this).get();</span>
<a href="#l23.1214"></a><span id="l23.1214" class="difflineminus">-			jQuery.fn[ original ].apply( jQuery(insert[i]), elems );</span>
<a href="#l23.1215"></a><span id="l23.1215" class="difflineminus">-			ret = ret.concat( elems );</span>
<a href="#l23.1216"></a><span id="l23.1216" class="difflineminus">-		}</span>
<a href="#l23.1217"></a><span id="l23.1217" class="difflineminus">-</span>
<a href="#l23.1218"></a><span id="l23.1218" class="difflineminus">-		return this.pushStack( ret, name, selector );</span>
<a href="#l23.1219"></a><span id="l23.1219" class="difflineminus">-	};</span>
<a href="#l23.1220"></a><span id="l23.1220" class="difflineminus">-});</span>
<a href="#l23.1221"></a><span id="l23.1221" class="difflineminus">-</span>
<a href="#l23.1222"></a><span id="l23.1222" class="difflineminus">-jQuery.each({</span>
<a href="#l23.1223"></a><span id="l23.1223" class="difflineminus">-	removeAttr: function( name ) {</span>
<a href="#l23.1224"></a><span id="l23.1224" class="difflineminus">-		jQuery.attr( this, name, &quot;&quot; );</span>
<a href="#l23.1225"></a><span id="l23.1225" class="difflineminus">-		if (this.nodeType == 1)</span>
<a href="#l23.1226"></a><span id="l23.1226" class="difflineminus">-			this.removeAttribute( name );</span>
<a href="#l23.1227"></a><span id="l23.1227" class="difflineminus">-	},</span>
<a href="#l23.1228"></a><span id="l23.1228" class="difflineminus">-</span>
<a href="#l23.1229"></a><span id="l23.1229" class="difflineminus">-	addClass: function( classNames ) {</span>
<a href="#l23.1230"></a><span id="l23.1230" class="difflineminus">-		jQuery.className.add( this, classNames );</span>
<a href="#l23.1231"></a><span id="l23.1231" class="difflineminus">-	},</span>
<a href="#l23.1232"></a><span id="l23.1232" class="difflineminus">-</span>
<a href="#l23.1233"></a><span id="l23.1233" class="difflineminus">-	removeClass: function( classNames ) {</span>
<a href="#l23.1234"></a><span id="l23.1234" class="difflineminus">-		jQuery.className.remove( this, classNames );</span>
<a href="#l23.1235"></a><span id="l23.1235" class="difflineminus">-	},</span>
<a href="#l23.1236"></a><span id="l23.1236" class="difflineminus">-</span>
<a href="#l23.1237"></a><span id="l23.1237" class="difflineminus">-	toggleClass: function( classNames, state ) {</span>
<a href="#l23.1238"></a><span id="l23.1238" class="difflineminus">-		if( typeof state !== &quot;boolean&quot; )</span>
<a href="#l23.1239"></a><span id="l23.1239" class="difflineminus">-			state = !jQuery.className.has( this, classNames );</span>
<a href="#l23.1240"></a><span id="l23.1240" class="difflineminus">-		jQuery.className[ state ? &quot;add&quot; : &quot;remove&quot; ]( this, classNames );</span>
<a href="#l23.1241"></a><span id="l23.1241" class="difflineminus">-	},</span>
<a href="#l23.1242"></a><span id="l23.1242" class="difflineminus">-</span>
<a href="#l23.1243"></a><span id="l23.1243" class="difflineminus">-	remove: function( selector ) {</span>
<a href="#l23.1244"></a><span id="l23.1244" class="difflineminus">-		if ( !selector || jQuery.filter( selector, [ this ] ).length ) {</span>
<a href="#l23.1245"></a><span id="l23.1245" class="difflineminus">-			// Prevent memory leaks</span>
<a href="#l23.1246"></a><span id="l23.1246" class="difflineminus">-			jQuery( &quot;*&quot;, this ).add([this]).each(function(){</span>
<a href="#l23.1247"></a><span id="l23.1247" class="difflineminus">-				jQuery.event.remove(this);</span>
<a href="#l23.1248"></a><span id="l23.1248" class="difflineminus">-				jQuery.removeData(this);</span>
<a href="#l23.1249"></a><span id="l23.1249" class="difflineminus">-			});</span>
<a href="#l23.1250"></a><span id="l23.1250" class="difflineminus">-			if (this.parentNode)</span>
<a href="#l23.1251"></a><span id="l23.1251" class="difflineminus">-				this.parentNode.removeChild( this );</span>
<a href="#l23.1252"></a><span id="l23.1252" class="difflineminus">-		}</span>
<a href="#l23.1253"></a><span id="l23.1253" class="difflineminus">-	},</span>
<a href="#l23.1254"></a><span id="l23.1254" class="difflineminus">-</span>
<a href="#l23.1255"></a><span id="l23.1255" class="difflineminus">-	empty: function() {</span>
<a href="#l23.1256"></a><span id="l23.1256" class="difflineminus">-		// Remove element nodes and prevent memory leaks</span>
<a href="#l23.1257"></a><span id="l23.1257" class="difflineminus">-		jQuery(this).children().remove();</span>
<a href="#l23.1258"></a><span id="l23.1258" class="difflineminus">-</span>
<a href="#l23.1259"></a><span id="l23.1259" class="difflineminus">-		// Remove any remaining nodes</span>
<a href="#l23.1260"></a><span id="l23.1260" class="difflineminus">-		while ( this.firstChild )</span>
<a href="#l23.1261"></a><span id="l23.1261" class="difflineminus">-			this.removeChild( this.firstChild );</span>
<a href="#l23.1262"></a><span id="l23.1262" class="difflineminus">-	}</span>
<a href="#l23.1263"></a><span id="l23.1263" class="difflineminus">-}, function(name, fn){</span>
<a href="#l23.1264"></a><span id="l23.1264" class="difflineminus">-	jQuery.fn[ name ] = function(){</span>
<a href="#l23.1265"></a><span id="l23.1265" class="difflineminus">-		return this.each( fn, arguments );</span>
<a href="#l23.1266"></a><span id="l23.1266" class="difflineminus">-	};</span>
<a href="#l23.1267"></a><span id="l23.1267" class="difflineminus">-});</span>
<a href="#l23.1268"></a><span id="l23.1268" class="difflineminus">-</span>
<a href="#l23.1269"></a><span id="l23.1269" class="difflineminus">-// Helper function used by the dimensions and offset modules</span>
<a href="#l23.1270"></a><span id="l23.1270" class="difflineminus">-function num(elem, prop) {</span>
<a href="#l23.1271"></a><span id="l23.1271" class="difflineminus">-	return elem[0] &amp;&amp; parseInt( jQuery.curCSS(elem[0], prop, true), 10 ) || 0;</span>
<a href="#l23.1272"></a><span id="l23.1272" class="difflineminus">-}</span>
<a href="#l23.1273"></a><span id="l23.1273" class="difflineminus">-var expando = &quot;jQuery&quot; + now(), uuid = 0, windowData = {};</span>
<a href="#l23.1274"></a><span id="l23.1274" class="difflineminus">-</span>
<a href="#l23.1275"></a><span id="l23.1275" class="difflineminus">-jQuery.extend({</span>
<a href="#l23.1276"></a><span id="l23.1276" class="difflineminus">-	cache: {},</span>
<a href="#l23.1277"></a><span id="l23.1277" class="difflineminus">-</span>
<a href="#l23.1278"></a><span id="l23.1278" class="difflineminus">-	data: function( elem, name, data ) {</span>
<a href="#l23.1279"></a><span id="l23.1279" class="difflineminus">-		elem = elem == window ?</span>
<a href="#l23.1280"></a><span id="l23.1280" class="difflineminus">-			windowData :</span>
<a href="#l23.1281"></a><span id="l23.1281" class="difflineminus">-			elem;</span>
<a href="#l23.1282"></a><span id="l23.1282" class="difflineminus">-</span>
<a href="#l23.1283"></a><span id="l23.1283" class="difflineminus">-		var id = elem[ expando ];</span>
<a href="#l23.1284"></a><span id="l23.1284" class="difflineminus">-</span>
<a href="#l23.1285"></a><span id="l23.1285" class="difflineminus">-		// Compute a unique ID for the element</span>
<a href="#l23.1286"></a><span id="l23.1286" class="difflineminus">-		if ( !id )</span>
<a href="#l23.1287"></a><span id="l23.1287" class="difflineminus">-			id = elem[ expando ] = ++uuid;</span>
<a href="#l23.1288"></a><span id="l23.1288" class="difflineminus">-</span>
<a href="#l23.1289"></a><span id="l23.1289" class="difflineminus">-		// Only generate the data cache if we're</span>
<a href="#l23.1290"></a><span id="l23.1290" class="difflineminus">-		// trying to access or manipulate it</span>
<a href="#l23.1291"></a><span id="l23.1291" class="difflineminus">-		if ( name &amp;&amp; !jQuery.cache[ id ] )</span>
<a href="#l23.1292"></a><span id="l23.1292" class="difflineminus">-			jQuery.cache[ id ] = {};</span>
<a href="#l23.1293"></a><span id="l23.1293" class="difflineminus">-</span>
<a href="#l23.1294"></a><span id="l23.1294" class="difflineminus">-		// Prevent overriding the named cache with undefined values</span>
<a href="#l23.1295"></a><span id="l23.1295" class="difflineminus">-		if ( data !== undefined )</span>
<a href="#l23.1296"></a><span id="l23.1296" class="difflineminus">-			jQuery.cache[ id ][ name ] = data;</span>
<a href="#l23.1297"></a><span id="l23.1297" class="difflineminus">-</span>
<a href="#l23.1298"></a><span id="l23.1298" class="difflineminus">-		// Return the named cache data, or the ID for the element</span>
<a href="#l23.1299"></a><span id="l23.1299" class="difflineminus">-		return name ?</span>
<a href="#l23.1300"></a><span id="l23.1300" class="difflineminus">-			jQuery.cache[ id ][ name ] :</span>
<a href="#l23.1301"></a><span id="l23.1301" class="difflineminus">-			id;</span>
<a href="#l23.1302"></a><span id="l23.1302" class="difflineminus">-	},</span>
<a href="#l23.1303"></a><span id="l23.1303" class="difflineminus">-</span>
<a href="#l23.1304"></a><span id="l23.1304" class="difflineminus">-	removeData: function( elem, name ) {</span>
<a href="#l23.1305"></a><span id="l23.1305" class="difflineminus">-		elem = elem == window ?</span>
<a href="#l23.1306"></a><span id="l23.1306" class="difflineminus">-			windowData :</span>
<a href="#l23.1307"></a><span id="l23.1307" class="difflineminus">-			elem;</span>
<a href="#l23.1308"></a><span id="l23.1308" class="difflineminus">-</span>
<a href="#l23.1309"></a><span id="l23.1309" class="difflineminus">-		var id = elem[ expando ];</span>
<a href="#l23.1310"></a><span id="l23.1310" class="difflineminus">-</span>
<a href="#l23.1311"></a><span id="l23.1311" class="difflineminus">-		// If we want to remove a specific section of the element's data</span>
<a href="#l23.1312"></a><span id="l23.1312" class="difflineminus">-		if ( name ) {</span>
<a href="#l23.1313"></a><span id="l23.1313" class="difflineminus">-			if ( jQuery.cache[ id ] ) {</span>
<a href="#l23.1314"></a><span id="l23.1314" class="difflineminus">-				// Remove the section of cache data</span>
<a href="#l23.1315"></a><span id="l23.1315" class="difflineminus">-				delete jQuery.cache[ id ][ name ];</span>
<a href="#l23.1316"></a><span id="l23.1316" class="difflineminus">-</span>
<a href="#l23.1317"></a><span id="l23.1317" class="difflineminus">-				// If we've removed all the data, remove the element's cache</span>
<a href="#l23.1318"></a><span id="l23.1318" class="difflineminus">-				name = &quot;&quot;;</span>
<a href="#l23.1319"></a><span id="l23.1319" class="difflineminus">-</span>
<a href="#l23.1320"></a><span id="l23.1320" class="difflineminus">-				for ( name in jQuery.cache[ id ] )</span>
<a href="#l23.1321"></a><span id="l23.1321" class="difflineminus">-					break;</span>
<a href="#l23.1322"></a><span id="l23.1322" class="difflineminus">-</span>
<a href="#l23.1323"></a><span id="l23.1323" class="difflineminus">-				if ( !name )</span>
<a href="#l23.1324"></a><span id="l23.1324" class="difflineminus">-					jQuery.removeData( elem );</span>
<a href="#l23.1325"></a><span id="l23.1325" class="difflineminus">-			}</span>
<a href="#l23.1326"></a><span id="l23.1326" class="difflineminus">-</span>
<a href="#l23.1327"></a><span id="l23.1327" class="difflineminus">-		// Otherwise, we want to remove all of the element's data</span>
<a href="#l23.1328"></a><span id="l23.1328" class="difflineminus">-		} else {</span>
<a href="#l23.1329"></a><span id="l23.1329" class="difflineminus">-			// Clean up the element expando</span>
<a href="#l23.1330"></a><span id="l23.1330" class="difflineminus">-			try {</span>
<a href="#l23.1331"></a><span id="l23.1331" class="difflineminus">-				delete elem[ expando ];</span>
<a href="#l23.1332"></a><span id="l23.1332" class="difflineminus">-			} catch(e){</span>
<a href="#l23.1333"></a><span id="l23.1333" class="difflineminus">-				// IE has trouble directly removing the expando</span>
<a href="#l23.1334"></a><span id="l23.1334" class="difflineminus">-				// but it's ok with using removeAttribute</span>
<a href="#l23.1335"></a><span id="l23.1335" class="difflineminus">-				if ( elem.removeAttribute )</span>
<a href="#l23.1336"></a><span id="l23.1336" class="difflineminus">-					elem.removeAttribute( expando );</span>
<a href="#l23.1337"></a><span id="l23.1337" class="difflineminus">-			}</span>
<a href="#l23.1338"></a><span id="l23.1338" class="difflineminus">-</span>
<a href="#l23.1339"></a><span id="l23.1339" class="difflineminus">-			// Completely remove the data cache</span>
<a href="#l23.1340"></a><span id="l23.1340" class="difflineminus">-			delete jQuery.cache[ id ];</span>
<a href="#l23.1341"></a><span id="l23.1341" class="difflineminus">-		}</span>
<a href="#l23.1342"></a><span id="l23.1342" class="difflineminus">-	},</span>
<a href="#l23.1343"></a><span id="l23.1343" class="difflineminus">-	queue: function( elem, type, data ) {</span>
<a href="#l23.1344"></a><span id="l23.1344" class="difflineminus">-		if ( elem ){</span>
<a href="#l23.1345"></a><span id="l23.1345" class="difflineminus">-	</span>
<a href="#l23.1346"></a><span id="l23.1346" class="difflineminus">-			type = (type || &quot;fx&quot;) + &quot;queue&quot;;</span>
<a href="#l23.1347"></a><span id="l23.1347" class="difflineminus">-	</span>
<a href="#l23.1348"></a><span id="l23.1348" class="difflineminus">-			var q = jQuery.data( elem, type );</span>
<a href="#l23.1349"></a><span id="l23.1349" class="difflineminus">-	</span>
<a href="#l23.1350"></a><span id="l23.1350" class="difflineminus">-			if ( !q || jQuery.isArray(data) )</span>
<a href="#l23.1351"></a><span id="l23.1351" class="difflineminus">-				q = jQuery.data( elem, type, jQuery.makeArray(data) );</span>
<a href="#l23.1352"></a><span id="l23.1352" class="difflineminus">-			else if( data )</span>
<a href="#l23.1353"></a><span id="l23.1353" class="difflineminus">-				q.push( data );</span>
<a href="#l23.1354"></a><span id="l23.1354" class="difflineminus">-	</span>
<a href="#l23.1355"></a><span id="l23.1355" class="difflineminus">-		}</span>
<a href="#l23.1356"></a><span id="l23.1356" class="difflineminus">-		return q;</span>
<a href="#l23.1357"></a><span id="l23.1357" class="difflineminus">-	},</span>
<a href="#l23.1358"></a><span id="l23.1358" class="difflineminus">-</span>
<a href="#l23.1359"></a><span id="l23.1359" class="difflineminus">-	dequeue: function( elem, type ){</span>
<a href="#l23.1360"></a><span id="l23.1360" class="difflineminus">-		var queue = jQuery.queue( elem, type ),</span>
<a href="#l23.1361"></a><span id="l23.1361" class="difflineminus">-			fn = queue.shift();</span>
<a href="#l23.1362"></a><span id="l23.1362" class="difflineminus">-		</span>
<a href="#l23.1363"></a><span id="l23.1363" class="difflineminus">-		if( !type || type === &quot;fx&quot; )</span>
<a href="#l23.1364"></a><span id="l23.1364" class="difflineminus">-			fn = queue[0];</span>
<a href="#l23.1365"></a><span id="l23.1365" class="difflineminus">-			</span>
<a href="#l23.1366"></a><span id="l23.1366" class="difflineminus">-		if( fn !== undefined )</span>
<a href="#l23.1367"></a><span id="l23.1367" class="difflineminus">-			fn.call(elem);</span>
<a href="#l23.1368"></a><span id="l23.1368" class="difflineminus">-	}</span>
<a href="#l23.1369"></a><span id="l23.1369" class="difflineminus">-});</span>
<a href="#l23.1370"></a><span id="l23.1370" class="difflineminus">-</span>
<a href="#l23.1371"></a><span id="l23.1371" class="difflineminus">-jQuery.fn.extend({</span>
<a href="#l23.1372"></a><span id="l23.1372" class="difflineminus">-	data: function( key, value ){</span>
<a href="#l23.1373"></a><span id="l23.1373" class="difflineminus">-		var parts = key.split(&quot;.&quot;);</span>
<a href="#l23.1374"></a><span id="l23.1374" class="difflineminus">-		parts[1] = parts[1] ? &quot;.&quot; + parts[1] : &quot;&quot;;</span>
<a href="#l23.1375"></a><span id="l23.1375" class="difflineminus">-</span>
<a href="#l23.1376"></a><span id="l23.1376" class="difflineminus">-		if ( value === undefined ) {</span>
<a href="#l23.1377"></a><span id="l23.1377" class="difflineminus">-			var data = this.triggerHandler(&quot;getData&quot; + parts[1] + &quot;!&quot;, [parts[0]]);</span>
<a href="#l23.1378"></a><span id="l23.1378" class="difflineminus">-</span>
<a href="#l23.1379"></a><span id="l23.1379" class="difflineminus">-			if ( data === undefined &amp;&amp; this.length )</span>
<a href="#l23.1380"></a><span id="l23.1380" class="difflineminus">-				data = jQuery.data( this[0], key );</span>
<a href="#l23.1381"></a><span id="l23.1381" class="difflineminus">-</span>
<a href="#l23.1382"></a><span id="l23.1382" class="difflineminus">-			return data === undefined &amp;&amp; parts[1] ?</span>
<a href="#l23.1383"></a><span id="l23.1383" class="difflineminus">-				this.data( parts[0] ) :</span>
<a href="#l23.1384"></a><span id="l23.1384" class="difflineminus">-				data;</span>
<a href="#l23.1385"></a><span id="l23.1385" class="difflineminus">-		} else</span>
<a href="#l23.1386"></a><span id="l23.1386" class="difflineminus">-			return this.trigger(&quot;setData&quot; + parts[1] + &quot;!&quot;, [parts[0], value]).each(function(){</span>
<a href="#l23.1387"></a><span id="l23.1387" class="difflineminus">-				jQuery.data( this, key, value );</span>
<a href="#l23.1388"></a><span id="l23.1388" class="difflineminus">-			});</span>
<a href="#l23.1389"></a><span id="l23.1389" class="difflineminus">-	},</span>
<a href="#l23.1390"></a><span id="l23.1390" class="difflineminus">-</span>
<a href="#l23.1391"></a><span id="l23.1391" class="difflineminus">-	removeData: function( key ){</span>
<a href="#l23.1392"></a><span id="l23.1392" class="difflineminus">-		return this.each(function(){</span>
<a href="#l23.1393"></a><span id="l23.1393" class="difflineminus">-			jQuery.removeData( this, key );</span>
<a href="#l23.1394"></a><span id="l23.1394" class="difflineminus">-		});</span>
<a href="#l23.1395"></a><span id="l23.1395" class="difflineminus">-	},</span>
<a href="#l23.1396"></a><span id="l23.1396" class="difflineminus">-	queue: function(type, data){</span>
<a href="#l23.1397"></a><span id="l23.1397" class="difflineminus">-		if ( typeof type !== &quot;string&quot; ) {</span>
<a href="#l23.1398"></a><span id="l23.1398" class="difflineminus">-			data = type;</span>
<a href="#l23.1399"></a><span id="l23.1399" class="difflineminus">-			type = &quot;fx&quot;;</span>
<a href="#l23.1400"></a><span id="l23.1400" class="difflineminus">-		}</span>
<a href="#l23.1401"></a><span id="l23.1401" class="difflineminus">-</span>
<a href="#l23.1402"></a><span id="l23.1402" class="difflineminus">-		if ( data === undefined )</span>
<a href="#l23.1403"></a><span id="l23.1403" class="difflineminus">-			return jQuery.queue( this[0], type );</span>
<a href="#l23.1404"></a><span id="l23.1404" class="difflineminus">-</span>
<a href="#l23.1405"></a><span id="l23.1405" class="difflineminus">-		return this.each(function(){</span>
<a href="#l23.1406"></a><span id="l23.1406" class="difflineminus">-			var queue = jQuery.queue( this, type, data );</span>
<a href="#l23.1407"></a><span id="l23.1407" class="difflineminus">-			</span>
<a href="#l23.1408"></a><span id="l23.1408" class="difflineminus">-			 if( type == &quot;fx&quot; &amp;&amp; queue.length == 1 )</span>
<a href="#l23.1409"></a><span id="l23.1409" class="difflineminus">-				queue[0].call(this);</span>
<a href="#l23.1410"></a><span id="l23.1410" class="difflineminus">-		});</span>
<a href="#l23.1411"></a><span id="l23.1411" class="difflineminus">-	},</span>
<a href="#l23.1412"></a><span id="l23.1412" class="difflineminus">-	dequeue: function(type){</span>
<a href="#l23.1413"></a><span id="l23.1413" class="difflineminus">-		return this.each(function(){</span>
<a href="#l23.1414"></a><span id="l23.1414" class="difflineminus">-			jQuery.dequeue( this, type );</span>
<a href="#l23.1415"></a><span id="l23.1415" class="difflineminus">-		});</span>
<a href="#l23.1416"></a><span id="l23.1416" class="difflineminus">-	}</span>
<a href="#l23.1417"></a><span id="l23.1417" class="difflineminus">-});/*!</span>
<a href="#l23.1418"></a><span id="l23.1418" class="difflineminus">- * Sizzle CSS Selector Engine - v0.9.3</span>
<a href="#l23.1419"></a><span id="l23.1419" class="difflineminus">- *  Copyright 2009, The Dojo Foundation</span>
<a href="#l23.1420"></a><span id="l23.1420" class="difflineminus">- *  Released under the MIT, BSD, and GPL Licenses.</span>
<a href="#l23.1421"></a><span id="l23.1421" class="difflineminus">- *  More information: http://sizzlejs.com/</span>
<a href="#l23.1422"></a><span id="l23.1422" class="difflineminus">- */</span>
<a href="#l23.1423"></a><span id="l23.1423" class="difflineminus">-(function(){</span>
<a href="#l23.1424"></a><span id="l23.1424" class="difflineminus">-</span>
<a href="#l23.1425"></a><span id="l23.1425" class="difflineminus">-var chunker = /((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['&quot;][^'&quot;]*['&quot;]|[^[\]'&quot;]+)+\]|\\.|[^ &gt;+~,(\[\\]+)+|[&gt;+~])(\s*,\s*)?/g,</span>
<a href="#l23.1426"></a><span id="l23.1426" class="difflineminus">-	done = 0,</span>
<a href="#l23.1427"></a><span id="l23.1427" class="difflineminus">-	toString = Object.prototype.toString;</span>
<a href="#l23.1428"></a><span id="l23.1428" class="difflineminus">-</span>
<a href="#l23.1429"></a><span id="l23.1429" class="difflineminus">-var Sizzle = function(selector, context, results, seed) {</span>
<a href="#l23.1430"></a><span id="l23.1430" class="difflineminus">-	results = results || [];</span>
<a href="#l23.1431"></a><span id="l23.1431" class="difflineminus">-	context = context || document;</span>
<a href="#l23.1432"></a><span id="l23.1432" class="difflineminus">-</span>
<a href="#l23.1433"></a><span id="l23.1433" class="difflineminus">-	if ( context.nodeType !== 1 &amp;&amp; context.nodeType !== 9 )</span>
<a href="#l23.1434"></a><span id="l23.1434" class="difflineminus">-		return [];</span>
<a href="#l23.1435"></a><span id="l23.1435" class="difflineminus">-	</span>
<a href="#l23.1436"></a><span id="l23.1436" class="difflineminus">-	if ( !selector || typeof selector !== &quot;string&quot; ) {</span>
<a href="#l23.1437"></a><span id="l23.1437" class="difflineminus">-		return results;</span>
<a href="#l23.1438"></a><span id="l23.1438" class="difflineminus">-	}</span>
<a href="#l23.1439"></a><span id="l23.1439" class="difflineminus">-</span>
<a href="#l23.1440"></a><span id="l23.1440" class="difflineminus">-	var parts = [], m, set, checkSet, check, mode, extra, prune = true;</span>
<a href="#l23.1441"></a><span id="l23.1441" class="difflineminus">-	</span>
<a href="#l23.1442"></a><span id="l23.1442" class="difflineminus">-	// Reset the position of the chunker regexp (start from head)</span>
<a href="#l23.1443"></a><span id="l23.1443" class="difflineminus">-	chunker.lastIndex = 0;</span>
<a href="#l23.1444"></a><span id="l23.1444" class="difflineminus">-	</span>
<a href="#l23.1445"></a><span id="l23.1445" class="difflineminus">-	while ( (m = chunker.exec(selector)) !== null ) {</span>
<a href="#l23.1446"></a><span id="l23.1446" class="difflineminus">-		parts.push( m[1] );</span>
<a href="#l23.1447"></a><span id="l23.1447" class="difflineminus">-		</span>
<a href="#l23.1448"></a><span id="l23.1448" class="difflineminus">-		if ( m[2] ) {</span>
<a href="#l23.1449"></a><span id="l23.1449" class="difflineminus">-			extra = RegExp.rightContext;</span>
<a href="#l23.1450"></a><span id="l23.1450" class="difflineminus">-			break;</span>
<a href="#l23.1451"></a><span id="l23.1451" class="difflineminus">-		}</span>
<a href="#l23.1452"></a><span id="l23.1452" class="difflineminus">-	}</span>
<a href="#l23.1453"></a><span id="l23.1453" class="difflineminus">-</span>
<a href="#l23.1454"></a><span id="l23.1454" class="difflineminus">-	if ( parts.length &gt; 1 &amp;&amp; origPOS.exec( selector ) ) {</span>
<a href="#l23.1455"></a><span id="l23.1455" class="difflineminus">-		if ( parts.length === 2 &amp;&amp; Expr.relative[ parts[0] ] ) {</span>
<a href="#l23.1456"></a><span id="l23.1456" class="difflineminus">-			set = posProcess( parts[0] + parts[1], context );</span>
<a href="#l23.1457"></a><span id="l23.1457" class="difflineminus">-		} else {</span>
<a href="#l23.1458"></a><span id="l23.1458" class="difflineminus">-			set = Expr.relative[ parts[0] ] ?</span>
<a href="#l23.1459"></a><span id="l23.1459" class="difflineminus">-				[ context ] :</span>
<a href="#l23.1460"></a><span id="l23.1460" class="difflineminus">-				Sizzle( parts.shift(), context );</span>
<a href="#l23.1461"></a><span id="l23.1461" class="difflineminus">-</span>
<a href="#l23.1462"></a><span id="l23.1462" class="difflineminus">-			while ( parts.length ) {</span>
<a href="#l23.1463"></a><span id="l23.1463" class="difflineminus">-				selector = parts.shift();</span>
<a href="#l23.1464"></a><span id="l23.1464" class="difflineminus">-</span>
<a href="#l23.1465"></a><span id="l23.1465" class="difflineminus">-				if ( Expr.relative[ selector ] )</span>
<a href="#l23.1466"></a><span id="l23.1466" class="difflineminus">-					selector += parts.shift();</span>
<a href="#l23.1467"></a><span id="l23.1467" class="difflineminus">-</span>
<a href="#l23.1468"></a><span id="l23.1468" class="difflineminus">-				set = posProcess( selector, set );</span>
<a href="#l23.1469"></a><span id="l23.1469" class="difflineminus">-			}</span>
<a href="#l23.1470"></a><span id="l23.1470" class="difflineminus">-		}</span>
<a href="#l23.1471"></a><span id="l23.1471" class="difflineminus">-	} else {</span>
<a href="#l23.1472"></a><span id="l23.1472" class="difflineminus">-		var ret = seed ?</span>
<a href="#l23.1473"></a><span id="l23.1473" class="difflineminus">-			{ expr: parts.pop(), set: makeArray(seed) } :</span>
<a href="#l23.1474"></a><span id="l23.1474" class="difflineminus">-			Sizzle.find( parts.pop(), parts.length === 1 &amp;&amp; context.parentNode ? context.parentNode : context, isXML(context) );</span>
<a href="#l23.1475"></a><span id="l23.1475" class="difflineminus">-		set = Sizzle.filter( ret.expr, ret.set );</span>
<a href="#l23.1476"></a><span id="l23.1476" class="difflineminus">-</span>
<a href="#l23.1477"></a><span id="l23.1477" class="difflineminus">-		if ( parts.length &gt; 0 ) {</span>
<a href="#l23.1478"></a><span id="l23.1478" class="difflineminus">-			checkSet = makeArray(set);</span>
<a href="#l23.1479"></a><span id="l23.1479" class="difflineminus">-		} else {</span>
<a href="#l23.1480"></a><span id="l23.1480" class="difflineminus">-			prune = false;</span>
<a href="#l23.1481"></a><span id="l23.1481" class="difflineminus">-		}</span>
<a href="#l23.1482"></a><span id="l23.1482" class="difflineminus">-</span>
<a href="#l23.1483"></a><span id="l23.1483" class="difflineminus">-		while ( parts.length ) {</span>
<a href="#l23.1484"></a><span id="l23.1484" class="difflineminus">-			var cur = parts.pop(), pop = cur;</span>
<a href="#l23.1485"></a><span id="l23.1485" class="difflineminus">-</span>
<a href="#l23.1486"></a><span id="l23.1486" class="difflineminus">-			if ( !Expr.relative[ cur ] ) {</span>
<a href="#l23.1487"></a><span id="l23.1487" class="difflineminus">-				cur = &quot;&quot;;</span>
<a href="#l23.1488"></a><span id="l23.1488" class="difflineminus">-			} else {</span>
<a href="#l23.1489"></a><span id="l23.1489" class="difflineminus">-				pop = parts.pop();</span>
<a href="#l23.1490"></a><span id="l23.1490" class="difflineminus">-			}</span>
<a href="#l23.1491"></a><span id="l23.1491" class="difflineminus">-</span>
<a href="#l23.1492"></a><span id="l23.1492" class="difflineminus">-			if ( pop == null ) {</span>
<a href="#l23.1493"></a><span id="l23.1493" class="difflineminus">-				pop = context;</span>
<a href="#l23.1494"></a><span id="l23.1494" class="difflineminus">-			}</span>
<a href="#l23.1495"></a><span id="l23.1495" class="difflineminus">-</span>
<a href="#l23.1496"></a><span id="l23.1496" class="difflineminus">-			Expr.relative[ cur ]( checkSet, pop, isXML(context) );</span>
<a href="#l23.1497"></a><span id="l23.1497" class="difflineminus">-		}</span>
<a href="#l23.1498"></a><span id="l23.1498" class="difflineminus">-	}</span>
<a href="#l23.1499"></a><span id="l23.1499" class="difflineminus">-</span>
<a href="#l23.1500"></a><span id="l23.1500" class="difflineminus">-	if ( !checkSet ) {</span>
<a href="#l23.1501"></a><span id="l23.1501" class="difflineminus">-		checkSet = set;</span>
<a href="#l23.1502"></a><span id="l23.1502" class="difflineminus">-	}</span>
<a href="#l23.1503"></a><span id="l23.1503" class="difflineminus">-</span>
<a href="#l23.1504"></a><span id="l23.1504" class="difflineminus">-	if ( !checkSet ) {</span>
<a href="#l23.1505"></a><span id="l23.1505" class="difflineminus">-		throw &quot;Syntax error, unrecognized expression: &quot; + (cur || selector);</span>
<a href="#l23.1506"></a><span id="l23.1506" class="difflineminus">-	}</span>
<a href="#l23.1507"></a><span id="l23.1507" class="difflineminus">-</span>
<a href="#l23.1508"></a><span id="l23.1508" class="difflineminus">-	if ( toString.call(checkSet) === &quot;[object Array]&quot; ) {</span>
<a href="#l23.1509"></a><span id="l23.1509" class="difflineminus">-		if ( !prune ) {</span>
<a href="#l23.1510"></a><span id="l23.1510" class="difflineminus">-			results.push.apply( results, checkSet );</span>
<a href="#l23.1511"></a><span id="l23.1511" class="difflineminus">-		} else if ( context.nodeType === 1 ) {</span>
<a href="#l23.1512"></a><span id="l23.1512" class="difflineminus">-			for ( var i = 0; checkSet[i] != null; i++ ) {</span>
<a href="#l23.1513"></a><span id="l23.1513" class="difflineminus">-				if ( checkSet[i] &amp;&amp; (checkSet[i] === true || checkSet[i].nodeType === 1 &amp;&amp; contains(context, checkSet[i])) ) {</span>
<a href="#l23.1514"></a><span id="l23.1514" class="difflineminus">-					results.push( set[i] );</span>
<a href="#l23.1515"></a><span id="l23.1515" class="difflineminus">-				}</span>
<a href="#l23.1516"></a><span id="l23.1516" class="difflineminus">-			}</span>
<a href="#l23.1517"></a><span id="l23.1517" class="difflineminus">-		} else {</span>
<a href="#l23.1518"></a><span id="l23.1518" class="difflineminus">-			for ( var i = 0; checkSet[i] != null; i++ ) {</span>
<a href="#l23.1519"></a><span id="l23.1519" class="difflineminus">-				if ( checkSet[i] &amp;&amp; checkSet[i].nodeType === 1 ) {</span>
<a href="#l23.1520"></a><span id="l23.1520" class="difflineminus">-					results.push( set[i] );</span>
<a href="#l23.1521"></a><span id="l23.1521" class="difflineminus">-				}</span>
<a href="#l23.1522"></a><span id="l23.1522" class="difflineminus">-			}</span>
<a href="#l23.1523"></a><span id="l23.1523" class="difflineminus">-		}</span>
<a href="#l23.1524"></a><span id="l23.1524" class="difflineminus">-	} else {</span>
<a href="#l23.1525"></a><span id="l23.1525" class="difflineminus">-		makeArray( checkSet, results );</span>
<a href="#l23.1526"></a><span id="l23.1526" class="difflineminus">-	}</span>
<a href="#l23.1527"></a><span id="l23.1527" class="difflineminus">-</span>
<a href="#l23.1528"></a><span id="l23.1528" class="difflineminus">-	if ( extra ) {</span>
<a href="#l23.1529"></a><span id="l23.1529" class="difflineminus">-		Sizzle( extra, context, results, seed );</span>
<a href="#l23.1530"></a><span id="l23.1530" class="difflineminus">-</span>
<a href="#l23.1531"></a><span id="l23.1531" class="difflineminus">-		if ( sortOrder ) {</span>
<a href="#l23.1532"></a><span id="l23.1532" class="difflineminus">-			hasDuplicate = false;</span>
<a href="#l23.1533"></a><span id="l23.1533" class="difflineminus">-			results.sort(sortOrder);</span>
<a href="#l23.1534"></a><span id="l23.1534" class="difflineminus">-</span>
<a href="#l23.1535"></a><span id="l23.1535" class="difflineminus">-			if ( hasDuplicate ) {</span>
<a href="#l23.1536"></a><span id="l23.1536" class="difflineminus">-				for ( var i = 1; i &lt; results.length; i++ ) {</span>
<a href="#l23.1537"></a><span id="l23.1537" class="difflineminus">-					if ( results[i] === results[i-1] ) {</span>
<a href="#l23.1538"></a><span id="l23.1538" class="difflineminus">-						results.splice(i--, 1);</span>
<a href="#l23.1539"></a><span id="l23.1539" class="difflineminus">-					}</span>
<a href="#l23.1540"></a><span id="l23.1540" class="difflineminus">-				}</span>
<a href="#l23.1541"></a><span id="l23.1541" class="difflineminus">-			}</span>
<a href="#l23.1542"></a><span id="l23.1542" class="difflineminus">-		}</span>
<a href="#l23.1543"></a><span id="l23.1543" class="difflineminus">-	}</span>
<a href="#l23.1544"></a><span id="l23.1544" class="difflineminus">-</span>
<a href="#l23.1545"></a><span id="l23.1545" class="difflineminus">-	return results;</span>
<a href="#l23.1546"></a><span id="l23.1546" class="difflineminus">-};</span>
<a href="#l23.1547"></a><span id="l23.1547" class="difflineminus">-</span>
<a href="#l23.1548"></a><span id="l23.1548" class="difflineminus">-Sizzle.matches = function(expr, set){</span>
<a href="#l23.1549"></a><span id="l23.1549" class="difflineminus">-	return Sizzle(expr, null, null, set);</span>
<a href="#l23.1550"></a><span id="l23.1550" class="difflineminus">-};</span>
<a href="#l23.1551"></a><span id="l23.1551" class="difflineminus">-</span>
<a href="#l23.1552"></a><span id="l23.1552" class="difflineminus">-Sizzle.find = function(expr, context, isXML){</span>
<a href="#l23.1553"></a><span id="l23.1553" class="difflineminus">-	var set, match;</span>
<a href="#l23.1554"></a><span id="l23.1554" class="difflineminus">-</span>
<a href="#l23.1555"></a><span id="l23.1555" class="difflineminus">-	if ( !expr ) {</span>
<a href="#l23.1556"></a><span id="l23.1556" class="difflineminus">-		return [];</span>
<a href="#l23.1557"></a><span id="l23.1557" class="difflineminus">-	}</span>
<a href="#l23.1558"></a><span id="l23.1558" class="difflineminus">-</span>
<a href="#l23.1559"></a><span id="l23.1559" class="difflineminus">-	for ( var i = 0, l = Expr.order.length; i &lt; l; i++ ) {</span>
<a href="#l23.1560"></a><span id="l23.1560" class="difflineminus">-		var type = Expr.order[i], match;</span>
<a href="#l23.1561"></a><span id="l23.1561" class="difflineminus">-		</span>
<a href="#l23.1562"></a><span id="l23.1562" class="difflineminus">-		if ( (match = Expr.match[ type ].exec( expr )) ) {</span>
<a href="#l23.1563"></a><span id="l23.1563" class="difflineminus">-			var left = RegExp.leftContext;</span>
<a href="#l23.1564"></a><span id="l23.1564" class="difflineminus">-</span>
<a href="#l23.1565"></a><span id="l23.1565" class="difflineminus">-			if ( left.substr( left.length - 1 ) !== &quot;\\&quot; ) {</span>
<a href="#l23.1566"></a><span id="l23.1566" class="difflineminus">-				match[1] = (match[1] || &quot;&quot;).replace(/\\/g, &quot;&quot;);</span>
<a href="#l23.1567"></a><span id="l23.1567" class="difflineminus">-				set = Expr.find[ type ]( match, context, isXML );</span>
<a href="#l23.1568"></a><span id="l23.1568" class="difflineminus">-				if ( set != null ) {</span>
<a href="#l23.1569"></a><span id="l23.1569" class="difflineminus">-					expr = expr.replace( Expr.match[ type ], &quot;&quot; );</span>
<a href="#l23.1570"></a><span id="l23.1570" class="difflineminus">-					break;</span>
<a href="#l23.1571"></a><span id="l23.1571" class="difflineminus">-				}</span>
<a href="#l23.1572"></a><span id="l23.1572" class="difflineminus">-			}</span>
<a href="#l23.1573"></a><span id="l23.1573" class="difflineminus">-		}</span>
<a href="#l23.1574"></a><span id="l23.1574" class="difflineminus">-	}</span>
<a href="#l23.1575"></a><span id="l23.1575" class="difflineminus">-</span>
<a href="#l23.1576"></a><span id="l23.1576" class="difflineminus">-	if ( !set ) {</span>
<a href="#l23.1577"></a><span id="l23.1577" class="difflineminus">-		set = context.getElementsByTagName(&quot;*&quot;);</span>
<a href="#l23.1578"></a><span id="l23.1578" class="difflineminus">-	}</span>
<a href="#l23.1579"></a><span id="l23.1579" class="difflineminus">-</span>
<a href="#l23.1580"></a><span id="l23.1580" class="difflineminus">-	return {set: set, expr: expr};</span>
<a href="#l23.1581"></a><span id="l23.1581" class="difflineminus">-};</span>
<a href="#l23.1582"></a><span id="l23.1582" class="difflineminus">-</span>
<a href="#l23.1583"></a><span id="l23.1583" class="difflineminus">-Sizzle.filter = function(expr, set, inplace, not){</span>
<a href="#l23.1584"></a><span id="l23.1584" class="difflineminus">-	var old = expr, result = [], curLoop = set, match, anyFound,</span>
<a href="#l23.1585"></a><span id="l23.1585" class="difflineminus">-		isXMLFilter = set &amp;&amp; set[0] &amp;&amp; isXML(set[0]);</span>
<a href="#l23.1586"></a><span id="l23.1586" class="difflineminus">-</span>
<a href="#l23.1587"></a><span id="l23.1587" class="difflineminus">-	while ( expr &amp;&amp; set.length ) {</span>
<a href="#l23.1588"></a><span id="l23.1588" class="difflineminus">-		for ( var type in Expr.filter ) {</span>
<a href="#l23.1589"></a><span id="l23.1589" class="difflineminus">-			if ( (match = Expr.match[ type ].exec( expr )) != null ) {</span>
<a href="#l23.1590"></a><span id="l23.1590" class="difflineminus">-				var filter = Expr.filter[ type ], found, item;</span>
<a href="#l23.1591"></a><span id="l23.1591" class="difflineminus">-				anyFound = false;</span>
<a href="#l23.1592"></a><span id="l23.1592" class="difflineminus">-</span>
<a href="#l23.1593"></a><span id="l23.1593" class="difflineminus">-				if ( curLoop == result ) {</span>
<a href="#l23.1594"></a><span id="l23.1594" class="difflineminus">-					result = [];</span>
<a href="#l23.1595"></a><span id="l23.1595" class="difflineminus">-				}</span>
<a href="#l23.1596"></a><span id="l23.1596" class="difflineminus">-</span>
<a href="#l23.1597"></a><span id="l23.1597" class="difflineminus">-				if ( Expr.preFilter[ type ] ) {</span>
<a href="#l23.1598"></a><span id="l23.1598" class="difflineminus">-					match = Expr.preFilter[ type ]( match, curLoop, inplace, result, not, isXMLFilter );</span>
<a href="#l23.1599"></a><span id="l23.1599" class="difflineminus">-</span>
<a href="#l23.1600"></a><span id="l23.1600" class="difflineminus">-					if ( !match ) {</span>
<a href="#l23.1601"></a><span id="l23.1601" class="difflineminus">-						anyFound = found = true;</span>
<a href="#l23.1602"></a><span id="l23.1602" class="difflineminus">-					} else if ( match === true ) {</span>
<a href="#l23.1603"></a><span id="l23.1603" class="difflineminus">-						continue;</span>
<a href="#l23.1604"></a><span id="l23.1604" class="difflineminus">-					}</span>
<a href="#l23.1605"></a><span id="l23.1605" class="difflineminus">-				}</span>
<a href="#l23.1606"></a><span id="l23.1606" class="difflineminus">-</span>
<a href="#l23.1607"></a><span id="l23.1607" class="difflineminus">-				if ( match ) {</span>
<a href="#l23.1608"></a><span id="l23.1608" class="difflineminus">-					for ( var i = 0; (item = curLoop[i]) != null; i++ ) {</span>
<a href="#l23.1609"></a><span id="l23.1609" class="difflineminus">-						if ( item ) {</span>
<a href="#l23.1610"></a><span id="l23.1610" class="difflineminus">-							found = filter( item, match, i, curLoop );</span>
<a href="#l23.1611"></a><span id="l23.1611" class="difflineminus">-							var pass = not ^ !!found;</span>
<a href="#l23.1612"></a><span id="l23.1612" class="difflineminus">-</span>
<a href="#l23.1613"></a><span id="l23.1613" class="difflineminus">-							if ( inplace &amp;&amp; found != null ) {</span>
<a href="#l23.1614"></a><span id="l23.1614" class="difflineminus">-								if ( pass ) {</span>
<a href="#l23.1615"></a><span id="l23.1615" class="difflineminus">-									anyFound = true;</span>
<a href="#l23.1616"></a><span id="l23.1616" class="difflineminus">-								} else {</span>
<a href="#l23.1617"></a><span id="l23.1617" class="difflineminus">-									curLoop[i] = false;</span>
<a href="#l23.1618"></a><span id="l23.1618" class="difflineminus">-								}</span>
<a href="#l23.1619"></a><span id="l23.1619" class="difflineminus">-							} else if ( pass ) {</span>
<a href="#l23.1620"></a><span id="l23.1620" class="difflineminus">-								result.push( item );</span>
<a href="#l23.1621"></a><span id="l23.1621" class="difflineminus">-								anyFound = true;</span>
<a href="#l23.1622"></a><span id="l23.1622" class="difflineminus">-							}</span>
<a href="#l23.1623"></a><span id="l23.1623" class="difflineminus">-						}</span>
<a href="#l23.1624"></a><span id="l23.1624" class="difflineminus">-					}</span>
<a href="#l23.1625"></a><span id="l23.1625" class="difflineminus">-				}</span>
<a href="#l23.1626"></a><span id="l23.1626" class="difflineminus">-</span>
<a href="#l23.1627"></a><span id="l23.1627" class="difflineminus">-				if ( found !== undefined ) {</span>
<a href="#l23.1628"></a><span id="l23.1628" class="difflineminus">-					if ( !inplace ) {</span>
<a href="#l23.1629"></a><span id="l23.1629" class="difflineminus">-						curLoop = result;</span>
<a href="#l23.1630"></a><span id="l23.1630" class="difflineminus">-					}</span>
<a href="#l23.1631"></a><span id="l23.1631" class="difflineminus">-</span>
<a href="#l23.1632"></a><span id="l23.1632" class="difflineminus">-					expr = expr.replace( Expr.match[ type ], &quot;&quot; );</span>
<a href="#l23.1633"></a><span id="l23.1633" class="difflineminus">-</span>
<a href="#l23.1634"></a><span id="l23.1634" class="difflineminus">-					if ( !anyFound ) {</span>
<a href="#l23.1635"></a><span id="l23.1635" class="difflineminus">-						return [];</span>
<a href="#l23.1636"></a><span id="l23.1636" class="difflineminus">-					}</span>
<a href="#l23.1637"></a><span id="l23.1637" class="difflineminus">-</span>
<a href="#l23.1638"></a><span id="l23.1638" class="difflineminus">-					break;</span>
<a href="#l23.1639"></a><span id="l23.1639" class="difflineminus">-				}</span>
<a href="#l23.1640"></a><span id="l23.1640" class="difflineminus">-			}</span>
<a href="#l23.1641"></a><span id="l23.1641" class="difflineminus">-		}</span>
<a href="#l23.1642"></a><span id="l23.1642" class="difflineminus">-</span>
<a href="#l23.1643"></a><span id="l23.1643" class="difflineminus">-		// Improper expression</span>
<a href="#l23.1644"></a><span id="l23.1644" class="difflineminus">-		if ( expr == old ) {</span>
<a href="#l23.1645"></a><span id="l23.1645" class="difflineminus">-			if ( anyFound == null ) {</span>
<a href="#l23.1646"></a><span id="l23.1646" class="difflineminus">-				throw &quot;Syntax error, unrecognized expression: &quot; + expr;</span>
<a href="#l23.1647"></a><span id="l23.1647" class="difflineminus">-			} else {</span>
<a href="#l23.1648"></a><span id="l23.1648" class="difflineminus">-				break;</span>
<a href="#l23.1649"></a><span id="l23.1649" class="difflineminus">-			}</span>
<a href="#l23.1650"></a><span id="l23.1650" class="difflineminus">-		}</span>
<a href="#l23.1651"></a><span id="l23.1651" class="difflineminus">-</span>
<a href="#l23.1652"></a><span id="l23.1652" class="difflineminus">-		old = expr;</span>
<a href="#l23.1653"></a><span id="l23.1653" class="difflineminus">-	}</span>
<a href="#l23.1654"></a><span id="l23.1654" class="difflineminus">-</span>
<a href="#l23.1655"></a><span id="l23.1655" class="difflineminus">-	return curLoop;</span>
<a href="#l23.1656"></a><span id="l23.1656" class="difflineminus">-};</span>
<a href="#l23.1657"></a><span id="l23.1657" class="difflineminus">-</span>
<a href="#l23.1658"></a><span id="l23.1658" class="difflineminus">-var Expr = Sizzle.selectors = {</span>
<a href="#l23.1659"></a><span id="l23.1659" class="difflineminus">-	order: [ &quot;ID&quot;, &quot;NAME&quot;, &quot;TAG&quot; ],</span>
<a href="#l23.1660"></a><span id="l23.1660" class="difflineminus">-	match: {</span>
<a href="#l23.1661"></a><span id="l23.1661" class="difflineminus">-		ID: /#((?:[\w\u00c0-\uFFFF_-]|\\.)+)/,</span>
<a href="#l23.1662"></a><span id="l23.1662" class="difflineminus">-		CLASS: /\.((?:[\w\u00c0-\uFFFF_-]|\\.)+)/,</span>
<a href="#l23.1663"></a><span id="l23.1663" class="difflineminus">-		NAME: /\[name=['&quot;]*((?:[\w\u00c0-\uFFFF_-]|\\.)+)['&quot;]*\]/,</span>
<a href="#l23.1664"></a><span id="l23.1664" class="difflineminus">-		ATTR: /\[\s*((?:[\w\u00c0-\uFFFF_-]|\\.)+)\s*(?:(\S?=)\s*(['&quot;]*)(.*?)\3|)\s*\]/,</span>
<a href="#l23.1665"></a><span id="l23.1665" class="difflineminus">-		TAG: /^((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)/,</span>
<a href="#l23.1666"></a><span id="l23.1666" class="difflineminus">-		CHILD: /:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,</span>
<a href="#l23.1667"></a><span id="l23.1667" class="difflineminus">-		POS: /:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,</span>
<a href="#l23.1668"></a><span id="l23.1668" class="difflineminus">-		PSEUDO: /:((?:[\w\u00c0-\uFFFF_-]|\\.)+)(?:\((['&quot;]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/</span>
<a href="#l23.1669"></a><span id="l23.1669" class="difflineminus">-	},</span>
<a href="#l23.1670"></a><span id="l23.1670" class="difflineminus">-	attrMap: {</span>
<a href="#l23.1671"></a><span id="l23.1671" class="difflineminus">-		&quot;class&quot;: &quot;className&quot;,</span>
<a href="#l23.1672"></a><span id="l23.1672" class="difflineminus">-		&quot;for&quot;: &quot;htmlFor&quot;</span>
<a href="#l23.1673"></a><span id="l23.1673" class="difflineminus">-	},</span>
<a href="#l23.1674"></a><span id="l23.1674" class="difflineminus">-	attrHandle: {</span>
<a href="#l23.1675"></a><span id="l23.1675" class="difflineminus">-		href: function(elem){</span>
<a href="#l23.1676"></a><span id="l23.1676" class="difflineminus">-			return elem.getAttribute(&quot;href&quot;);</span>
<a href="#l23.1677"></a><span id="l23.1677" class="difflineminus">-		}</span>
<a href="#l23.1678"></a><span id="l23.1678" class="difflineminus">-	},</span>
<a href="#l23.1679"></a><span id="l23.1679" class="difflineminus">-	relative: {</span>
<a href="#l23.1680"></a><span id="l23.1680" class="difflineminus">-		&quot;+&quot;: function(checkSet, part, isXML){</span>
<a href="#l23.1681"></a><span id="l23.1681" class="difflineminus">-			var isPartStr = typeof part === &quot;string&quot;,</span>
<a href="#l23.1682"></a><span id="l23.1682" class="difflineminus">-				isTag = isPartStr &amp;&amp; !/\W/.test(part),</span>
<a href="#l23.1683"></a><span id="l23.1683" class="difflineminus">-				isPartStrNotTag = isPartStr &amp;&amp; !isTag;</span>
<a href="#l23.1684"></a><span id="l23.1684" class="difflineminus">-</span>
<a href="#l23.1685"></a><span id="l23.1685" class="difflineminus">-			if ( isTag &amp;&amp; !isXML ) {</span>
<a href="#l23.1686"></a><span id="l23.1686" class="difflineminus">-				part = part.toUpperCase();</span>
<a href="#l23.1687"></a><span id="l23.1687" class="difflineminus">-			}</span>
<a href="#l23.1688"></a><span id="l23.1688" class="difflineminus">-</span>
<a href="#l23.1689"></a><span id="l23.1689" class="difflineminus">-			for ( var i = 0, l = checkSet.length, elem; i &lt; l; i++ ) {</span>
<a href="#l23.1690"></a><span id="l23.1690" class="difflineminus">-				if ( (elem = checkSet[i]) ) {</span>
<a href="#l23.1691"></a><span id="l23.1691" class="difflineminus">-					while ( (elem = elem.previousSibling) &amp;&amp; elem.nodeType !== 1 ) {}</span>
<a href="#l23.1692"></a><span id="l23.1692" class="difflineminus">-</span>
<a href="#l23.1693"></a><span id="l23.1693" class="difflineminus">-					checkSet[i] = isPartStrNotTag || elem &amp;&amp; elem.nodeName === part ?</span>
<a href="#l23.1694"></a><span id="l23.1694" class="difflineminus">-						elem || false :</span>
<a href="#l23.1695"></a><span id="l23.1695" class="difflineminus">-						elem === part;</span>
<a href="#l23.1696"></a><span id="l23.1696" class="difflineminus">-				}</span>
<a href="#l23.1697"></a><span id="l23.1697" class="difflineminus">-			}</span>
<a href="#l23.1698"></a><span id="l23.1698" class="difflineminus">-</span>
<a href="#l23.1699"></a><span id="l23.1699" class="difflineminus">-			if ( isPartStrNotTag ) {</span>
<a href="#l23.1700"></a><span id="l23.1700" class="difflineminus">-				Sizzle.filter( part, checkSet, true );</span>
<a href="#l23.1701"></a><span id="l23.1701" class="difflineminus">-			}</span>
<a href="#l23.1702"></a><span id="l23.1702" class="difflineminus">-		},</span>
<a href="#l23.1703"></a><span id="l23.1703" class="difflineminus">-		&quot;&gt;&quot;: function(checkSet, part, isXML){</span>
<a href="#l23.1704"></a><span id="l23.1704" class="difflineminus">-			var isPartStr = typeof part === &quot;string&quot;;</span>
<a href="#l23.1705"></a><span id="l23.1705" class="difflineminus">-</span>
<a href="#l23.1706"></a><span id="l23.1706" class="difflineminus">-			if ( isPartStr &amp;&amp; !/\W/.test(part) ) {</span>
<a href="#l23.1707"></a><span id="l23.1707" class="difflineminus">-				part = isXML ? part : part.toUpperCase();</span>
<a href="#l23.1708"></a><span id="l23.1708" class="difflineminus">-</span>
<a href="#l23.1709"></a><span id="l23.1709" class="difflineminus">-				for ( var i = 0, l = checkSet.length; i &lt; l; i++ ) {</span>
<a href="#l23.1710"></a><span id="l23.1710" class="difflineminus">-					var elem = checkSet[i];</span>
<a href="#l23.1711"></a><span id="l23.1711" class="difflineminus">-					if ( elem ) {</span>
<a href="#l23.1712"></a><span id="l23.1712" class="difflineminus">-						var parent = elem.parentNode;</span>
<a href="#l23.1713"></a><span id="l23.1713" class="difflineminus">-						checkSet[i] = parent.nodeName === part ? parent : false;</span>
<a href="#l23.1714"></a><span id="l23.1714" class="difflineminus">-					}</span>
<a href="#l23.1715"></a><span id="l23.1715" class="difflineminus">-				}</span>
<a href="#l23.1716"></a><span id="l23.1716" class="difflineminus">-			} else {</span>
<a href="#l23.1717"></a><span id="l23.1717" class="difflineminus">-				for ( var i = 0, l = checkSet.length; i &lt; l; i++ ) {</span>
<a href="#l23.1718"></a><span id="l23.1718" class="difflineminus">-					var elem = checkSet[i];</span>
<a href="#l23.1719"></a><span id="l23.1719" class="difflineminus">-					if ( elem ) {</span>
<a href="#l23.1720"></a><span id="l23.1720" class="difflineminus">-						checkSet[i] = isPartStr ?</span>
<a href="#l23.1721"></a><span id="l23.1721" class="difflineminus">-							elem.parentNode :</span>
<a href="#l23.1722"></a><span id="l23.1722" class="difflineminus">-							elem.parentNode === part;</span>
<a href="#l23.1723"></a><span id="l23.1723" class="difflineminus">-					}</span>
<a href="#l23.1724"></a><span id="l23.1724" class="difflineminus">-				}</span>
<a href="#l23.1725"></a><span id="l23.1725" class="difflineminus">-</span>
<a href="#l23.1726"></a><span id="l23.1726" class="difflineminus">-				if ( isPartStr ) {</span>
<a href="#l23.1727"></a><span id="l23.1727" class="difflineminus">-					Sizzle.filter( part, checkSet, true );</span>
<a href="#l23.1728"></a><span id="l23.1728" class="difflineminus">-				}</span>
<a href="#l23.1729"></a><span id="l23.1729" class="difflineminus">-			}</span>
<a href="#l23.1730"></a><span id="l23.1730" class="difflineminus">-		},</span>
<a href="#l23.1731"></a><span id="l23.1731" class="difflineminus">-		&quot;&quot;: function(checkSet, part, isXML){</span>
<a href="#l23.1732"></a><span id="l23.1732" class="difflineminus">-			var doneName = done++, checkFn = dirCheck;</span>
<a href="#l23.1733"></a><span id="l23.1733" class="difflineminus">-</span>
<a href="#l23.1734"></a><span id="l23.1734" class="difflineminus">-			if ( !part.match(/\W/) ) {</span>
<a href="#l23.1735"></a><span id="l23.1735" class="difflineminus">-				var nodeCheck = part = isXML ? part : part.toUpperCase();</span>
<a href="#l23.1736"></a><span id="l23.1736" class="difflineminus">-				checkFn = dirNodeCheck;</span>
<a href="#l23.1737"></a><span id="l23.1737" class="difflineminus">-			}</span>
<a href="#l23.1738"></a><span id="l23.1738" class="difflineminus">-</span>
<a href="#l23.1739"></a><span id="l23.1739" class="difflineminus">-			checkFn(&quot;parentNode&quot;, part, doneName, checkSet, nodeCheck, isXML);</span>
<a href="#l23.1740"></a><span id="l23.1740" class="difflineminus">-		},</span>
<a href="#l23.1741"></a><span id="l23.1741" class="difflineminus">-		&quot;~&quot;: function(checkSet, part, isXML){</span>
<a href="#l23.1742"></a><span id="l23.1742" class="difflineminus">-			var doneName = done++, checkFn = dirCheck;</span>
<a href="#l23.1743"></a><span id="l23.1743" class="difflineminus">-</span>
<a href="#l23.1744"></a><span id="l23.1744" class="difflineminus">-			if ( typeof part === &quot;string&quot; &amp;&amp; !part.match(/\W/) ) {</span>
<a href="#l23.1745"></a><span id="l23.1745" class="difflineminus">-				var nodeCheck = part = isXML ? part : part.toUpperCase();</span>
<a href="#l23.1746"></a><span id="l23.1746" class="difflineminus">-				checkFn = dirNodeCheck;</span>
<a href="#l23.1747"></a><span id="l23.1747" class="difflineminus">-			}</span>
<a href="#l23.1748"></a><span id="l23.1748" class="difflineminus">-</span>
<a href="#l23.1749"></a><span id="l23.1749" class="difflineminus">-			checkFn(&quot;previousSibling&quot;, part, doneName, checkSet, nodeCheck, isXML);</span>
<a href="#l23.1750"></a><span id="l23.1750" class="difflineminus">-		}</span>
<a href="#l23.1751"></a><span id="l23.1751" class="difflineminus">-	},</span>
<a href="#l23.1752"></a><span id="l23.1752" class="difflineminus">-	find: {</span>
<a href="#l23.1753"></a><span id="l23.1753" class="difflineminus">-		ID: function(match, context, isXML){</span>
<a href="#l23.1754"></a><span id="l23.1754" class="difflineminus">-			if ( typeof context.getElementById !== &quot;undefined&quot; &amp;&amp; !isXML ) {</span>
<a href="#l23.1755"></a><span id="l23.1755" class="difflineminus">-				var m = context.getElementById(match[1]);</span>
<a href="#l23.1756"></a><span id="l23.1756" class="difflineminus">-				return m ? [m] : [];</span>
<a href="#l23.1757"></a><span id="l23.1757" class="difflineminus">-			}</span>
<a href="#l23.1758"></a><span id="l23.1758" class="difflineminus">-		},</span>
<a href="#l23.1759"></a><span id="l23.1759" class="difflineminus">-		NAME: function(match, context, isXML){</span>
<a href="#l23.1760"></a><span id="l23.1760" class="difflineminus">-			if ( typeof context.getElementsByName !== &quot;undefined&quot; ) {</span>
<a href="#l23.1761"></a><span id="l23.1761" class="difflineminus">-				var ret = [], results = context.getElementsByName(match[1]);</span>
<a href="#l23.1762"></a><span id="l23.1762" class="difflineminus">-</span>
<a href="#l23.1763"></a><span id="l23.1763" class="difflineminus">-				for ( var i = 0, l = results.length; i &lt; l; i++ ) {</span>
<a href="#l23.1764"></a><span id="l23.1764" class="difflineminus">-					if ( results[i].getAttribute(&quot;name&quot;) === match[1] ) {</span>
<a href="#l23.1765"></a><span id="l23.1765" class="difflineminus">-						ret.push( results[i] );</span>
<a href="#l23.1766"></a><span id="l23.1766" class="difflineminus">-					}</span>
<a href="#l23.1767"></a><span id="l23.1767" class="difflineminus">-				}</span>
<a href="#l23.1768"></a><span id="l23.1768" class="difflineminus">-</span>
<a href="#l23.1769"></a><span id="l23.1769" class="difflineminus">-				return ret.length === 0 ? null : ret;</span>
<a href="#l23.1770"></a><span id="l23.1770" class="difflineminus">-			}</span>
<a href="#l23.1771"></a><span id="l23.1771" class="difflineminus">-		},</span>
<a href="#l23.1772"></a><span id="l23.1772" class="difflineminus">-		TAG: function(match, context){</span>
<a href="#l23.1773"></a><span id="l23.1773" class="difflineminus">-			return context.getElementsByTagName(match[1]);</span>
<a href="#l23.1774"></a><span id="l23.1774" class="difflineminus">-		}</span>
<a href="#l23.1775"></a><span id="l23.1775" class="difflineminus">-	},</span>
<a href="#l23.1776"></a><span id="l23.1776" class="difflineminus">-	preFilter: {</span>
<a href="#l23.1777"></a><span id="l23.1777" class="difflineminus">-		CLASS: function(match, curLoop, inplace, result, not, isXML){</span>
<a href="#l23.1778"></a><span id="l23.1778" class="difflineminus">-			match = &quot; &quot; + match[1].replace(/\\/g, &quot;&quot;) + &quot; &quot;;</span>
<a href="#l23.1779"></a><span id="l23.1779" class="difflineminus">-</span>
<a href="#l23.1780"></a><span id="l23.1780" class="difflineminus">-			if ( isXML ) {</span>
<a href="#l23.1781"></a><span id="l23.1781" class="difflineminus">-				return match;</span>
<a href="#l23.1782"></a><span id="l23.1782" class="difflineminus">-			}</span>
<a href="#l23.1783"></a><span id="l23.1783" class="difflineminus">-</span>
<a href="#l23.1784"></a><span id="l23.1784" class="difflineminus">-			for ( var i = 0, elem; (elem = curLoop[i]) != null; i++ ) {</span>
<a href="#l23.1785"></a><span id="l23.1785" class="difflineminus">-				if ( elem ) {</span>
<a href="#l23.1786"></a><span id="l23.1786" class="difflineminus">-					if ( not ^ (elem.className &amp;&amp; (&quot; &quot; + elem.className + &quot; &quot;).indexOf(match) &gt;= 0) ) {</span>
<a href="#l23.1787"></a><span id="l23.1787" class="difflineminus">-						if ( !inplace )</span>
<a href="#l23.1788"></a><span id="l23.1788" class="difflineminus">-							result.push( elem );</span>
<a href="#l23.1789"></a><span id="l23.1789" class="difflineminus">-					} else if ( inplace ) {</span>
<a href="#l23.1790"></a><span id="l23.1790" class="difflineminus">-						curLoop[i] = false;</span>
<a href="#l23.1791"></a><span id="l23.1791" class="difflineminus">-					}</span>
<a href="#l23.1792"></a><span id="l23.1792" class="difflineminus">-				}</span>
<a href="#l23.1793"></a><span id="l23.1793" class="difflineminus">-			}</span>
<a href="#l23.1794"></a><span id="l23.1794" class="difflineminus">-</span>
<a href="#l23.1795"></a><span id="l23.1795" class="difflineminus">-			return false;</span>
<a href="#l23.1796"></a><span id="l23.1796" class="difflineminus">-		},</span>
<a href="#l23.1797"></a><span id="l23.1797" class="difflineminus">-		ID: function(match){</span>
<a href="#l23.1798"></a><span id="l23.1798" class="difflineminus">-			return match[1].replace(/\\/g, &quot;&quot;);</span>
<a href="#l23.1799"></a><span id="l23.1799" class="difflineminus">-		},</span>
<a href="#l23.1800"></a><span id="l23.1800" class="difflineminus">-		TAG: function(match, curLoop){</span>
<a href="#l23.1801"></a><span id="l23.1801" class="difflineminus">-			for ( var i = 0; curLoop[i] === false; i++ ){}</span>
<a href="#l23.1802"></a><span id="l23.1802" class="difflineminus">-			return curLoop[i] &amp;&amp; isXML(curLoop[i]) ? match[1] : match[1].toUpperCase();</span>
<a href="#l23.1803"></a><span id="l23.1803" class="difflineminus">-		},</span>
<a href="#l23.1804"></a><span id="l23.1804" class="difflineminus">-		CHILD: function(match){</span>
<a href="#l23.1805"></a><span id="l23.1805" class="difflineminus">-			if ( match[1] == &quot;nth&quot; ) {</span>
<a href="#l23.1806"></a><span id="l23.1806" class="difflineminus">-				// parse equations like 'even', 'odd', '5', '2n', '3n+2', '4n-1', '-n+6'</span>
<a href="#l23.1807"></a><span id="l23.1807" class="difflineminus">-				var test = /(-?)(\d*)n((?:\+|-)?\d*)/.exec(</span>
<a href="#l23.1808"></a><span id="l23.1808" class="difflineminus">-					match[2] == &quot;even&quot; &amp;&amp; &quot;2n&quot; || match[2] == &quot;odd&quot; &amp;&amp; &quot;2n+1&quot; ||</span>
<a href="#l23.1809"></a><span id="l23.1809" class="difflineminus">-					!/\D/.test( match[2] ) &amp;&amp; &quot;0n+&quot; + match[2] || match[2]);</span>
<a href="#l23.1810"></a><span id="l23.1810" class="difflineminus">-</span>
<a href="#l23.1811"></a><span id="l23.1811" class="difflineminus">-				// calculate the numbers (first)n+(last) including if they are negative</span>
<a href="#l23.1812"></a><span id="l23.1812" class="difflineminus">-				match[2] = (test[1] + (test[2] || 1)) - 0;</span>
<a href="#l23.1813"></a><span id="l23.1813" class="difflineminus">-				match[3] = test[3] - 0;</span>
<a href="#l23.1814"></a><span id="l23.1814" class="difflineminus">-			}</span>
<a href="#l23.1815"></a><span id="l23.1815" class="difflineminus">-</span>
<a href="#l23.1816"></a><span id="l23.1816" class="difflineminus">-			// TODO: Move to normal caching system</span>
<a href="#l23.1817"></a><span id="l23.1817" class="difflineminus">-			match[0] = done++;</span>
<a href="#l23.1818"></a><span id="l23.1818" class="difflineminus">-</span>
<a href="#l23.1819"></a><span id="l23.1819" class="difflineminus">-			return match;</span>
<a href="#l23.1820"></a><span id="l23.1820" class="difflineminus">-		},</span>
<a href="#l23.1821"></a><span id="l23.1821" class="difflineminus">-		ATTR: function(match, curLoop, inplace, result, not, isXML){</span>
<a href="#l23.1822"></a><span id="l23.1822" class="difflineminus">-			var name = match[1].replace(/\\/g, &quot;&quot;);</span>
<a href="#l23.1823"></a><span id="l23.1823" class="difflineminus">-			</span>
<a href="#l23.1824"></a><span id="l23.1824" class="difflineminus">-			if ( !isXML &amp;&amp; Expr.attrMap[name] ) {</span>
<a href="#l23.1825"></a><span id="l23.1825" class="difflineminus">-				match[1] = Expr.attrMap[name];</span>
<a href="#l23.1826"></a><span id="l23.1826" class="difflineminus">-			}</span>
<a href="#l23.1827"></a><span id="l23.1827" class="difflineminus">-</span>
<a href="#l23.1828"></a><span id="l23.1828" class="difflineminus">-			if ( match[2] === &quot;~=&quot; ) {</span>
<a href="#l23.1829"></a><span id="l23.1829" class="difflineminus">-				match[4] = &quot; &quot; + match[4] + &quot; &quot;;</span>
<a href="#l23.1830"></a><span id="l23.1830" class="difflineminus">-			}</span>
<a href="#l23.1831"></a><span id="l23.1831" class="difflineminus">-</span>
<a href="#l23.1832"></a><span id="l23.1832" class="difflineminus">-			return match;</span>
<a href="#l23.1833"></a><span id="l23.1833" class="difflineminus">-		},</span>
<a href="#l23.1834"></a><span id="l23.1834" class="difflineminus">-		PSEUDO: function(match, curLoop, inplace, result, not){</span>
<a href="#l23.1835"></a><span id="l23.1835" class="difflineminus">-			if ( match[1] === &quot;not&quot; ) {</span>
<a href="#l23.1836"></a><span id="l23.1836" class="difflineminus">-				// If we're dealing with a complex expression, or a simple one</span>
<a href="#l23.1837"></a><span id="l23.1837" class="difflineminus">-				if ( match[3].match(chunker).length &gt; 1 || /^\w/.test(match[3]) ) {</span>
<a href="#l23.1838"></a><span id="l23.1838" class="difflineminus">-					match[3] = Sizzle(match[3], null, null, curLoop);</span>
<a href="#l23.1839"></a><span id="l23.1839" class="difflineminus">-				} else {</span>
<a href="#l23.1840"></a><span id="l23.1840" class="difflineminus">-					var ret = Sizzle.filter(match[3], curLoop, inplace, true ^ not);</span>
<a href="#l23.1841"></a><span id="l23.1841" class="difflineminus">-					if ( !inplace ) {</span>
<a href="#l23.1842"></a><span id="l23.1842" class="difflineminus">-						result.push.apply( result, ret );</span>
<a href="#l23.1843"></a><span id="l23.1843" class="difflineminus">-					}</span>
<a href="#l23.1844"></a><span id="l23.1844" class="difflineminus">-					return false;</span>
<a href="#l23.1845"></a><span id="l23.1845" class="difflineminus">-				}</span>
<a href="#l23.1846"></a><span id="l23.1846" class="difflineminus">-			} else if ( Expr.match.POS.test( match[0] ) || Expr.match.CHILD.test( match[0] ) ) {</span>
<a href="#l23.1847"></a><span id="l23.1847" class="difflineminus">-				return true;</span>
<a href="#l23.1848"></a><span id="l23.1848" class="difflineminus">-			}</span>
<a href="#l23.1849"></a><span id="l23.1849" class="difflineminus">-			</span>
<a href="#l23.1850"></a><span id="l23.1850" class="difflineminus">-			return match;</span>
<a href="#l23.1851"></a><span id="l23.1851" class="difflineminus">-		},</span>
<a href="#l23.1852"></a><span id="l23.1852" class="difflineminus">-		POS: function(match){</span>
<a href="#l23.1853"></a><span id="l23.1853" class="difflineminus">-			match.unshift( true );</span>
<a href="#l23.1854"></a><span id="l23.1854" class="difflineminus">-			return match;</span>
<a href="#l23.1855"></a><span id="l23.1855" class="difflineminus">-		}</span>
<a href="#l23.1856"></a><span id="l23.1856" class="difflineminus">-	},</span>
<a href="#l23.1857"></a><span id="l23.1857" class="difflineminus">-	filters: {</span>
<a href="#l23.1858"></a><span id="l23.1858" class="difflineminus">-		enabled: function(elem){</span>
<a href="#l23.1859"></a><span id="l23.1859" class="difflineminus">-			return elem.disabled === false &amp;&amp; elem.type !== &quot;hidden&quot;;</span>
<a href="#l23.1860"></a><span id="l23.1860" class="difflineminus">-		},</span>
<a href="#l23.1861"></a><span id="l23.1861" class="difflineminus">-		disabled: function(elem){</span>
<a href="#l23.1862"></a><span id="l23.1862" class="difflineminus">-			return elem.disabled === true;</span>
<a href="#l23.1863"></a><span id="l23.1863" class="difflineminus">-		},</span>
<a href="#l23.1864"></a><span id="l23.1864" class="difflineminus">-		checked: function(elem){</span>
<a href="#l23.1865"></a><span id="l23.1865" class="difflineminus">-			return elem.checked === true;</span>
<a href="#l23.1866"></a><span id="l23.1866" class="difflineminus">-		},</span>
<a href="#l23.1867"></a><span id="l23.1867" class="difflineminus">-		selected: function(elem){</span>
<a href="#l23.1868"></a><span id="l23.1868" class="difflineminus">-			// Accessing this property makes selected-by-default</span>
<a href="#l23.1869"></a><span id="l23.1869" class="difflineminus">-			// options in Safari work properly</span>
<a href="#l23.1870"></a><span id="l23.1870" class="difflineminus">-			elem.parentNode.selectedIndex;</span>
<a href="#l23.1871"></a><span id="l23.1871" class="difflineminus">-			return elem.selected === true;</span>
<a href="#l23.1872"></a><span id="l23.1872" class="difflineminus">-		},</span>
<a href="#l23.1873"></a><span id="l23.1873" class="difflineminus">-		parent: function(elem){</span>
<a href="#l23.1874"></a><span id="l23.1874" class="difflineminus">-			return !!elem.firstChild;</span>
<a href="#l23.1875"></a><span id="l23.1875" class="difflineminus">-		},</span>
<a href="#l23.1876"></a><span id="l23.1876" class="difflineminus">-		empty: function(elem){</span>
<a href="#l23.1877"></a><span id="l23.1877" class="difflineminus">-			return !elem.firstChild;</span>
<a href="#l23.1878"></a><span id="l23.1878" class="difflineminus">-		},</span>
<a href="#l23.1879"></a><span id="l23.1879" class="difflineminus">-		has: function(elem, i, match){</span>
<a href="#l23.1880"></a><span id="l23.1880" class="difflineminus">-			return !!Sizzle( match[3], elem ).length;</span>
<a href="#l23.1881"></a><span id="l23.1881" class="difflineminus">-		},</span>
<a href="#l23.1882"></a><span id="l23.1882" class="difflineminus">-		header: function(elem){</span>
<a href="#l23.1883"></a><span id="l23.1883" class="difflineminus">-			return /h\d/i.test( elem.nodeName );</span>
<a href="#l23.1884"></a><span id="l23.1884" class="difflineminus">-		},</span>
<a href="#l23.1885"></a><span id="l23.1885" class="difflineminus">-		text: function(elem){</span>
<a href="#l23.1886"></a><span id="l23.1886" class="difflineminus">-			return &quot;text&quot; === elem.type;</span>
<a href="#l23.1887"></a><span id="l23.1887" class="difflineminus">-		},</span>
<a href="#l23.1888"></a><span id="l23.1888" class="difflineminus">-		radio: function(elem){</span>
<a href="#l23.1889"></a><span id="l23.1889" class="difflineminus">-			return &quot;radio&quot; === elem.type;</span>
<a href="#l23.1890"></a><span id="l23.1890" class="difflineminus">-		},</span>
<a href="#l23.1891"></a><span id="l23.1891" class="difflineminus">-		checkbox: function(elem){</span>
<a href="#l23.1892"></a><span id="l23.1892" class="difflineminus">-			return &quot;checkbox&quot; === elem.type;</span>
<a href="#l23.1893"></a><span id="l23.1893" class="difflineminus">-		},</span>
<a href="#l23.1894"></a><span id="l23.1894" class="difflineminus">-		file: function(elem){</span>
<a href="#l23.1895"></a><span id="l23.1895" class="difflineminus">-			return &quot;file&quot; === elem.type;</span>
<a href="#l23.1896"></a><span id="l23.1896" class="difflineminus">-		},</span>
<a href="#l23.1897"></a><span id="l23.1897" class="difflineminus">-		password: function(elem){</span>
<a href="#l23.1898"></a><span id="l23.1898" class="difflineminus">-			return &quot;password&quot; === elem.type;</span>
<a href="#l23.1899"></a><span id="l23.1899" class="difflineminus">-		},</span>
<a href="#l23.1900"></a><span id="l23.1900" class="difflineminus">-		submit: function(elem){</span>
<a href="#l23.1901"></a><span id="l23.1901" class="difflineminus">-			return &quot;submit&quot; === elem.type;</span>
<a href="#l23.1902"></a><span id="l23.1902" class="difflineminus">-		},</span>
<a href="#l23.1903"></a><span id="l23.1903" class="difflineminus">-		image: function(elem){</span>
<a href="#l23.1904"></a><span id="l23.1904" class="difflineminus">-			return &quot;image&quot; === elem.type;</span>
<a href="#l23.1905"></a><span id="l23.1905" class="difflineminus">-		},</span>
<a href="#l23.1906"></a><span id="l23.1906" class="difflineminus">-		reset: function(elem){</span>
<a href="#l23.1907"></a><span id="l23.1907" class="difflineminus">-			return &quot;reset&quot; === elem.type;</span>
<a href="#l23.1908"></a><span id="l23.1908" class="difflineminus">-		},</span>
<a href="#l23.1909"></a><span id="l23.1909" class="difflineminus">-		button: function(elem){</span>
<a href="#l23.1910"></a><span id="l23.1910" class="difflineminus">-			return &quot;button&quot; === elem.type || elem.nodeName.toUpperCase() === &quot;BUTTON&quot;;</span>
<a href="#l23.1911"></a><span id="l23.1911" class="difflineminus">-		},</span>
<a href="#l23.1912"></a><span id="l23.1912" class="difflineminus">-		input: function(elem){</span>
<a href="#l23.1913"></a><span id="l23.1913" class="difflineminus">-			return /input|select|textarea|button/i.test(elem.nodeName);</span>
<a href="#l23.1914"></a><span id="l23.1914" class="difflineminus">-		}</span>
<a href="#l23.1915"></a><span id="l23.1915" class="difflineminus">-	},</span>
<a href="#l23.1916"></a><span id="l23.1916" class="difflineminus">-	setFilters: {</span>
<a href="#l23.1917"></a><span id="l23.1917" class="difflineminus">-		first: function(elem, i){</span>
<a href="#l23.1918"></a><span id="l23.1918" class="difflineminus">-			return i === 0;</span>
<a href="#l23.1919"></a><span id="l23.1919" class="difflineminus">-		},</span>
<a href="#l23.1920"></a><span id="l23.1920" class="difflineminus">-		last: function(elem, i, match, array){</span>
<a href="#l23.1921"></a><span id="l23.1921" class="difflineminus">-			return i === array.length - 1;</span>
<a href="#l23.1922"></a><span id="l23.1922" class="difflineminus">-		},</span>
<a href="#l23.1923"></a><span id="l23.1923" class="difflineminus">-		even: function(elem, i){</span>
<a href="#l23.1924"></a><span id="l23.1924" class="difflineminus">-			return i % 2 === 0;</span>
<a href="#l23.1925"></a><span id="l23.1925" class="difflineminus">-		},</span>
<a href="#l23.1926"></a><span id="l23.1926" class="difflineminus">-		odd: function(elem, i){</span>
<a href="#l23.1927"></a><span id="l23.1927" class="difflineminus">-			return i % 2 === 1;</span>
<a href="#l23.1928"></a><span id="l23.1928" class="difflineminus">-		},</span>
<a href="#l23.1929"></a><span id="l23.1929" class="difflineminus">-		lt: function(elem, i, match){</span>
<a href="#l23.1930"></a><span id="l23.1930" class="difflineminus">-			return i &lt; match[3] - 0;</span>
<a href="#l23.1931"></a><span id="l23.1931" class="difflineminus">-		},</span>
<a href="#l23.1932"></a><span id="l23.1932" class="difflineminus">-		gt: function(elem, i, match){</span>
<a href="#l23.1933"></a><span id="l23.1933" class="difflineminus">-			return i &gt; match[3] - 0;</span>
<a href="#l23.1934"></a><span id="l23.1934" class="difflineminus">-		},</span>
<a href="#l23.1935"></a><span id="l23.1935" class="difflineminus">-		nth: function(elem, i, match){</span>
<a href="#l23.1936"></a><span id="l23.1936" class="difflineminus">-			return match[3] - 0 == i;</span>
<a href="#l23.1937"></a><span id="l23.1937" class="difflineminus">-		},</span>
<a href="#l23.1938"></a><span id="l23.1938" class="difflineminus">-		eq: function(elem, i, match){</span>
<a href="#l23.1939"></a><span id="l23.1939" class="difflineminus">-			return match[3] - 0 == i;</span>
<a href="#l23.1940"></a><span id="l23.1940" class="difflineminus">-		}</span>
<a href="#l23.1941"></a><span id="l23.1941" class="difflineminus">-	},</span>
<a href="#l23.1942"></a><span id="l23.1942" class="difflineminus">-	filter: {</span>
<a href="#l23.1943"></a><span id="l23.1943" class="difflineminus">-		PSEUDO: function(elem, match, i, array){</span>
<a href="#l23.1944"></a><span id="l23.1944" class="difflineminus">-			var name = match[1], filter = Expr.filters[ name ];</span>
<a href="#l23.1945"></a><span id="l23.1945" class="difflineminus">-</span>
<a href="#l23.1946"></a><span id="l23.1946" class="difflineminus">-			if ( filter ) {</span>
<a href="#l23.1947"></a><span id="l23.1947" class="difflineminus">-				return filter( elem, i, match, array );</span>
<a href="#l23.1948"></a><span id="l23.1948" class="difflineminus">-			} else if ( name === &quot;contains&quot; ) {</span>
<a href="#l23.1949"></a><span id="l23.1949" class="difflineminus">-				return (elem.textContent || elem.innerText || &quot;&quot;).indexOf(match[3]) &gt;= 0;</span>
<a href="#l23.1950"></a><span id="l23.1950" class="difflineminus">-			} else if ( name === &quot;not&quot; ) {</span>
<a href="#l23.1951"></a><span id="l23.1951" class="difflineminus">-				var not = match[3];</span>
<a href="#l23.1952"></a><span id="l23.1952" class="difflineminus">-</span>
<a href="#l23.1953"></a><span id="l23.1953" class="difflineminus">-				for ( var i = 0, l = not.length; i &lt; l; i++ ) {</span>
<a href="#l23.1954"></a><span id="l23.1954" class="difflineminus">-					if ( not[i] === elem ) {</span>
<a href="#l23.1955"></a><span id="l23.1955" class="difflineminus">-						return false;</span>
<a href="#l23.1956"></a><span id="l23.1956" class="difflineminus">-					}</span>
<a href="#l23.1957"></a><span id="l23.1957" class="difflineminus">-				}</span>
<a href="#l23.1958"></a><span id="l23.1958" class="difflineminus">-</span>
<a href="#l23.1959"></a><span id="l23.1959" class="difflineminus">-				return true;</span>
<a href="#l23.1960"></a><span id="l23.1960" class="difflineminus">-			}</span>
<a href="#l23.1961"></a><span id="l23.1961" class="difflineminus">-		},</span>
<a href="#l23.1962"></a><span id="l23.1962" class="difflineminus">-		CHILD: function(elem, match){</span>
<a href="#l23.1963"></a><span id="l23.1963" class="difflineminus">-			var type = match[1], node = elem;</span>
<a href="#l23.1964"></a><span id="l23.1964" class="difflineminus">-			switch (type) {</span>
<a href="#l23.1965"></a><span id="l23.1965" class="difflineminus">-				case 'only':</span>
<a href="#l23.1966"></a><span id="l23.1966" class="difflineminus">-				case 'first':</span>
<a href="#l23.1967"></a><span id="l23.1967" class="difflineminus">-					while (node = node.previousSibling)  {</span>
<a href="#l23.1968"></a><span id="l23.1968" class="difflineminus">-						if ( node.nodeType === 1 ) return false;</span>
<a href="#l23.1969"></a><span id="l23.1969" class="difflineminus">-					}</span>
<a href="#l23.1970"></a><span id="l23.1970" class="difflineminus">-					if ( type == 'first') return true;</span>
<a href="#l23.1971"></a><span id="l23.1971" class="difflineminus">-					node = elem;</span>
<a href="#l23.1972"></a><span id="l23.1972" class="difflineminus">-				case 'last':</span>
<a href="#l23.1973"></a><span id="l23.1973" class="difflineminus">-					while (node = node.nextSibling)  {</span>
<a href="#l23.1974"></a><span id="l23.1974" class="difflineminus">-						if ( node.nodeType === 1 ) return false;</span>
<a href="#l23.1975"></a><span id="l23.1975" class="difflineminus">-					}</span>
<a href="#l23.1976"></a><span id="l23.1976" class="difflineminus">-					return true;</span>
<a href="#l23.1977"></a><span id="l23.1977" class="difflineminus">-				case 'nth':</span>
<a href="#l23.1978"></a><span id="l23.1978" class="difflineminus">-					var first = match[2], last = match[3];</span>
<a href="#l23.1979"></a><span id="l23.1979" class="difflineminus">-</span>
<a href="#l23.1980"></a><span id="l23.1980" class="difflineminus">-					if ( first == 1 &amp;&amp; last == 0 ) {</span>
<a href="#l23.1981"></a><span id="l23.1981" class="difflineminus">-						return true;</span>
<a href="#l23.1982"></a><span id="l23.1982" class="difflineminus">-					}</span>
<a href="#l23.1983"></a><span id="l23.1983" class="difflineminus">-					</span>
<a href="#l23.1984"></a><span id="l23.1984" class="difflineminus">-					var doneName = match[0],</span>
<a href="#l23.1985"></a><span id="l23.1985" class="difflineminus">-						parent = elem.parentNode;</span>
<a href="#l23.1986"></a><span id="l23.1986" class="difflineminus">-	</span>
<a href="#l23.1987"></a><span id="l23.1987" class="difflineminus">-					if ( parent &amp;&amp; (parent.sizcache !== doneName || !elem.nodeIndex) ) {</span>
<a href="#l23.1988"></a><span id="l23.1988" class="difflineminus">-						var count = 0;</span>
<a href="#l23.1989"></a><span id="l23.1989" class="difflineminus">-						for ( node = parent.firstChild; node; node = node.nextSibling ) {</span>
<a href="#l23.1990"></a><span id="l23.1990" class="difflineminus">-							if ( node.nodeType === 1 ) {</span>
<a href="#l23.1991"></a><span id="l23.1991" class="difflineminus">-								node.nodeIndex = ++count;</span>
<a href="#l23.1992"></a><span id="l23.1992" class="difflineminus">-							}</span>
<a href="#l23.1993"></a><span id="l23.1993" class="difflineminus">-						} </span>
<a href="#l23.1994"></a><span id="l23.1994" class="difflineminus">-						parent.sizcache = doneName;</span>
<a href="#l23.1995"></a><span id="l23.1995" class="difflineminus">-					}</span>
<a href="#l23.1996"></a><span id="l23.1996" class="difflineminus">-					</span>
<a href="#l23.1997"></a><span id="l23.1997" class="difflineminus">-					var diff = elem.nodeIndex - last;</span>
<a href="#l23.1998"></a><span id="l23.1998" class="difflineminus">-					if ( first == 0 ) {</span>
<a href="#l23.1999"></a><span id="l23.1999" class="difflineminus">-						return diff == 0;</span>
<a href="#l23.2000"></a><span id="l23.2000" class="difflineminus">-					} else {</span>
<a href="#l23.2001"></a><span id="l23.2001" class="difflineminus">-						return ( diff % first == 0 &amp;&amp; diff / first &gt;= 0 );</span>
<a href="#l23.2002"></a><span id="l23.2002" class="difflineminus">-					}</span>
<a href="#l23.2003"></a><span id="l23.2003" class="difflineminus">-			}</span>
<a href="#l23.2004"></a><span id="l23.2004" class="difflineminus">-		},</span>
<a href="#l23.2005"></a><span id="l23.2005" class="difflineminus">-		ID: function(elem, match){</span>
<a href="#l23.2006"></a><span id="l23.2006" class="difflineminus">-			return elem.nodeType === 1 &amp;&amp; elem.getAttribute(&quot;id&quot;) === match;</span>
<a href="#l23.2007"></a><span id="l23.2007" class="difflineminus">-		},</span>
<a href="#l23.2008"></a><span id="l23.2008" class="difflineminus">-		TAG: function(elem, match){</span>
<a href="#l23.2009"></a><span id="l23.2009" class="difflineminus">-			return (match === &quot;*&quot; &amp;&amp; elem.nodeType === 1) || elem.nodeName === match;</span>
<a href="#l23.2010"></a><span id="l23.2010" class="difflineminus">-		},</span>
<a href="#l23.2011"></a><span id="l23.2011" class="difflineminus">-		CLASS: function(elem, match){</span>
<a href="#l23.2012"></a><span id="l23.2012" class="difflineminus">-			return (&quot; &quot; + (elem.className || elem.getAttribute(&quot;class&quot;)) + &quot; &quot;)</span>
<a href="#l23.2013"></a><span id="l23.2013" class="difflineminus">-				.indexOf( match ) &gt; -1;</span>
<a href="#l23.2014"></a><span id="l23.2014" class="difflineminus">-		},</span>
<a href="#l23.2015"></a><span id="l23.2015" class="difflineminus">-		ATTR: function(elem, match){</span>
<a href="#l23.2016"></a><span id="l23.2016" class="difflineminus">-			var name = match[1],</span>
<a href="#l23.2017"></a><span id="l23.2017" class="difflineminus">-				result = Expr.attrHandle[ name ] ?</span>
<a href="#l23.2018"></a><span id="l23.2018" class="difflineminus">-					Expr.attrHandle[ name ]( elem ) :</span>
<a href="#l23.2019"></a><span id="l23.2019" class="difflineminus">-					elem[ name ] != null ?</span>
<a href="#l23.2020"></a><span id="l23.2020" class="difflineminus">-						elem[ name ] :</span>
<a href="#l23.2021"></a><span id="l23.2021" class="difflineminus">-						elem.getAttribute( name ),</span>
<a href="#l23.2022"></a><span id="l23.2022" class="difflineminus">-				value = result + &quot;&quot;,</span>
<a href="#l23.2023"></a><span id="l23.2023" class="difflineminus">-				type = match[2],</span>
<a href="#l23.2024"></a><span id="l23.2024" class="difflineminus">-				check = match[4];</span>
<a href="#l23.2025"></a><span id="l23.2025" class="difflineminus">-</span>
<a href="#l23.2026"></a><span id="l23.2026" class="difflineminus">-			return result == null ?</span>
<a href="#l23.2027"></a><span id="l23.2027" class="difflineminus">-				type === &quot;!=&quot; :</span>
<a href="#l23.2028"></a><span id="l23.2028" class="difflineminus">-				type === &quot;=&quot; ?</span>
<a href="#l23.2029"></a><span id="l23.2029" class="difflineminus">-				value === check :</span>
<a href="#l23.2030"></a><span id="l23.2030" class="difflineminus">-				type === &quot;*=&quot; ?</span>
<a href="#l23.2031"></a><span id="l23.2031" class="difflineminus">-				value.indexOf(check) &gt;= 0 :</span>
<a href="#l23.2032"></a><span id="l23.2032" class="difflineminus">-				type === &quot;~=&quot; ?</span>
<a href="#l23.2033"></a><span id="l23.2033" class="difflineminus">-				(&quot; &quot; + value + &quot; &quot;).indexOf(check) &gt;= 0 :</span>
<a href="#l23.2034"></a><span id="l23.2034" class="difflineminus">-				!check ?</span>
<a href="#l23.2035"></a><span id="l23.2035" class="difflineminus">-				value &amp;&amp; result !== false :</span>
<a href="#l23.2036"></a><span id="l23.2036" class="difflineminus">-				type === &quot;!=&quot; ?</span>
<a href="#l23.2037"></a><span id="l23.2037" class="difflineminus">-				value != check :</span>
<a href="#l23.2038"></a><span id="l23.2038" class="difflineminus">-				type === &quot;^=&quot; ?</span>
<a href="#l23.2039"></a><span id="l23.2039" class="difflineminus">-				value.indexOf(check) === 0 :</span>
<a href="#l23.2040"></a><span id="l23.2040" class="difflineminus">-				type === &quot;$=&quot; ?</span>
<a href="#l23.2041"></a><span id="l23.2041" class="difflineminus">-				value.substr(value.length - check.length) === check :</span>
<a href="#l23.2042"></a><span id="l23.2042" class="difflineminus">-				type === &quot;|=&quot; ?</span>
<a href="#l23.2043"></a><span id="l23.2043" class="difflineminus">-				value === check || value.substr(0, check.length + 1) === check + &quot;-&quot; :</span>
<a href="#l23.2044"></a><span id="l23.2044" class="difflineminus">-				false;</span>
<a href="#l23.2045"></a><span id="l23.2045" class="difflineminus">-		},</span>
<a href="#l23.2046"></a><span id="l23.2046" class="difflineminus">-		POS: function(elem, match, i, array){</span>
<a href="#l23.2047"></a><span id="l23.2047" class="difflineminus">-			var name = match[2], filter = Expr.setFilters[ name ];</span>
<a href="#l23.2048"></a><span id="l23.2048" class="difflineminus">-</span>
<a href="#l23.2049"></a><span id="l23.2049" class="difflineminus">-			if ( filter ) {</span>
<a href="#l23.2050"></a><span id="l23.2050" class="difflineminus">-				return filter( elem, i, match, array );</span>
<a href="#l23.2051"></a><span id="l23.2051" class="difflineminus">-			}</span>
<a href="#l23.2052"></a><span id="l23.2052" class="difflineminus">-		}</span>
<a href="#l23.2053"></a><span id="l23.2053" class="difflineminus">-	}</span>
<a href="#l23.2054"></a><span id="l23.2054" class="difflineminus">-};</span>
<a href="#l23.2055"></a><span id="l23.2055" class="difflineminus">-</span>
<a href="#l23.2056"></a><span id="l23.2056" class="difflineminus">-var origPOS = Expr.match.POS;</span>
<a href="#l23.2057"></a><span id="l23.2057" class="difflineminus">-</span>
<a href="#l23.2058"></a><span id="l23.2058" class="difflineminus">-for ( var type in Expr.match ) {</span>
<a href="#l23.2059"></a><span id="l23.2059" class="difflineminus">-	Expr.match[ type ] = RegExp( Expr.match[ type ].source + /(?![^\[]*\])(?![^\(]*\))/.source );</span>
<a href="#l23.2060"></a><span id="l23.2060" class="difflineminus">-}</span>
<a href="#l23.2061"></a><span id="l23.2061" class="difflineminus">-</span>
<a href="#l23.2062"></a><span id="l23.2062" class="difflineminus">-var makeArray = function(array, results) {</span>
<a href="#l23.2063"></a><span id="l23.2063" class="difflineminus">-	array = Array.prototype.slice.call( array );</span>
<a href="#l23.2064"></a><span id="l23.2064" class="difflineminus">-</span>
<a href="#l23.2065"></a><span id="l23.2065" class="difflineminus">-	if ( results ) {</span>
<a href="#l23.2066"></a><span id="l23.2066" class="difflineminus">-		results.push.apply( results, array );</span>
<a href="#l23.2067"></a><span id="l23.2067" class="difflineminus">-		return results;</span>
<a href="#l23.2068"></a><span id="l23.2068" class="difflineminus">-	}</span>
<a href="#l23.2069"></a><span id="l23.2069" class="difflineminus">-	</span>
<a href="#l23.2070"></a><span id="l23.2070" class="difflineminus">-	return array;</span>
<a href="#l23.2071"></a><span id="l23.2071" class="difflineminus">-};</span>
<a href="#l23.2072"></a><span id="l23.2072" class="difflineminus">-</span>
<a href="#l23.2073"></a><span id="l23.2073" class="difflineminus">-// Perform a simple check to determine if the browser is capable of</span>
<a href="#l23.2074"></a><span id="l23.2074" class="difflineminus">-// converting a NodeList to an array using builtin methods.</span>
<a href="#l23.2075"></a><span id="l23.2075" class="difflineminus">-try {</span>
<a href="#l23.2076"></a><span id="l23.2076" class="difflineminus">-	Array.prototype.slice.call( document.documentElement.childNodes );</span>
<a href="#l23.2077"></a><span id="l23.2077" class="difflineminus">-</span>
<a href="#l23.2078"></a><span id="l23.2078" class="difflineminus">-// Provide a fallback method if it does not work</span>
<a href="#l23.2079"></a><span id="l23.2079" class="difflineminus">-} catch(e){</span>
<a href="#l23.2080"></a><span id="l23.2080" class="difflineminus">-	makeArray = function(array, results) {</span>
<a href="#l23.2081"></a><span id="l23.2081" class="difflineminus">-		var ret = results || [];</span>
<a href="#l23.2082"></a><span id="l23.2082" class="difflineminus">-</span>
<a href="#l23.2083"></a><span id="l23.2083" class="difflineminus">-		if ( toString.call(array) === &quot;[object Array]&quot; ) {</span>
<a href="#l23.2084"></a><span id="l23.2084" class="difflineminus">-			Array.prototype.push.apply( ret, array );</span>
<a href="#l23.2085"></a><span id="l23.2085" class="difflineminus">-		} else {</span>
<a href="#l23.2086"></a><span id="l23.2086" class="difflineminus">-			if ( typeof array.length === &quot;number&quot; ) {</span>
<a href="#l23.2087"></a><span id="l23.2087" class="difflineminus">-				for ( var i = 0, l = array.length; i &lt; l; i++ ) {</span>
<a href="#l23.2088"></a><span id="l23.2088" class="difflineminus">-					ret.push( array[i] );</span>
<a href="#l23.2089"></a><span id="l23.2089" class="difflineminus">-				}</span>
<a href="#l23.2090"></a><span id="l23.2090" class="difflineminus">-			} else {</span>
<a href="#l23.2091"></a><span id="l23.2091" class="difflineminus">-				for ( var i = 0; array[i]; i++ ) {</span>
<a href="#l23.2092"></a><span id="l23.2092" class="difflineminus">-					ret.push( array[i] );</span>
<a href="#l23.2093"></a><span id="l23.2093" class="difflineminus">-				}</span>
<a href="#l23.2094"></a><span id="l23.2094" class="difflineminus">-			}</span>
<a href="#l23.2095"></a><span id="l23.2095" class="difflineminus">-		}</span>
<a href="#l23.2096"></a><span id="l23.2096" class="difflineminus">-</span>
<a href="#l23.2097"></a><span id="l23.2097" class="difflineminus">-		return ret;</span>
<a href="#l23.2098"></a><span id="l23.2098" class="difflineminus">-	};</span>
<a href="#l23.2099"></a><span id="l23.2099" class="difflineminus">-}</span>
<a href="#l23.2100"></a><span id="l23.2100" class="difflineminus">-</span>
<a href="#l23.2101"></a><span id="l23.2101" class="difflineminus">-var sortOrder;</span>
<a href="#l23.2102"></a><span id="l23.2102" class="difflineminus">-</span>
<a href="#l23.2103"></a><span id="l23.2103" class="difflineminus">-if ( document.documentElement.compareDocumentPosition ) {</span>
<a href="#l23.2104"></a><span id="l23.2104" class="difflineminus">-	sortOrder = function( a, b ) {</span>
<a href="#l23.2105"></a><span id="l23.2105" class="difflineminus">-		var ret = a.compareDocumentPosition(b) &amp; 4 ? -1 : a === b ? 0 : 1;</span>
<a href="#l23.2106"></a><span id="l23.2106" class="difflineminus">-		if ( ret === 0 ) {</span>
<a href="#l23.2107"></a><span id="l23.2107" class="difflineminus">-			hasDuplicate = true;</span>
<a href="#l23.2108"></a><span id="l23.2108" class="difflineminus">-		}</span>
<a href="#l23.2109"></a><span id="l23.2109" class="difflineminus">-		return ret;</span>
<a href="#l23.2110"></a><span id="l23.2110" class="difflineminus">-	};</span>
<a href="#l23.2111"></a><span id="l23.2111" class="difflineminus">-} else if ( &quot;sourceIndex&quot; in document.documentElement ) {</span>
<a href="#l23.2112"></a><span id="l23.2112" class="difflineminus">-	sortOrder = function( a, b ) {</span>
<a href="#l23.2113"></a><span id="l23.2113" class="difflineminus">-		var ret = a.sourceIndex - b.sourceIndex;</span>
<a href="#l23.2114"></a><span id="l23.2114" class="difflineminus">-		if ( ret === 0 ) {</span>
<a href="#l23.2115"></a><span id="l23.2115" class="difflineminus">-			hasDuplicate = true;</span>
<a href="#l23.2116"></a><span id="l23.2116" class="difflineminus">-		}</span>
<a href="#l23.2117"></a><span id="l23.2117" class="difflineminus">-		return ret;</span>
<a href="#l23.2118"></a><span id="l23.2118" class="difflineminus">-	};</span>
<a href="#l23.2119"></a><span id="l23.2119" class="difflineminus">-} else if ( document.createRange ) {</span>
<a href="#l23.2120"></a><span id="l23.2120" class="difflineminus">-	sortOrder = function( a, b ) {</span>
<a href="#l23.2121"></a><span id="l23.2121" class="difflineminus">-		var aRange = a.ownerDocument.createRange(), bRange = b.ownerDocument.createRange();</span>
<a href="#l23.2122"></a><span id="l23.2122" class="difflineminus">-		aRange.selectNode(a);</span>
<a href="#l23.2123"></a><span id="l23.2123" class="difflineminus">-		aRange.collapse(true);</span>
<a href="#l23.2124"></a><span id="l23.2124" class="difflineminus">-		bRange.selectNode(b);</span>
<a href="#l23.2125"></a><span id="l23.2125" class="difflineminus">-		bRange.collapse(true);</span>
<a href="#l23.2126"></a><span id="l23.2126" class="difflineminus">-		var ret = aRange.compareBoundaryPoints(Range.START_TO_END, bRange);</span>
<a href="#l23.2127"></a><span id="l23.2127" class="difflineminus">-		if ( ret === 0 ) {</span>
<a href="#l23.2128"></a><span id="l23.2128" class="difflineminus">-			hasDuplicate = true;</span>
<a href="#l23.2129"></a><span id="l23.2129" class="difflineminus">-		}</span>
<a href="#l23.2130"></a><span id="l23.2130" class="difflineminus">-		return ret;</span>
<a href="#l23.2131"></a><span id="l23.2131" class="difflineminus">-	};</span>
<a href="#l23.2132"></a><span id="l23.2132" class="difflineminus">-}</span>
<a href="#l23.2133"></a><span id="l23.2133" class="difflineminus">-</span>
<a href="#l23.2134"></a><span id="l23.2134" class="difflineminus">-// Check to see if the browser returns elements by name when</span>
<a href="#l23.2135"></a><span id="l23.2135" class="difflineminus">-// querying by getElementById (and provide a workaround)</span>
<a href="#l23.2136"></a><span id="l23.2136" class="difflineminus">-(function(){</span>
<a href="#l23.2137"></a><span id="l23.2137" class="difflineminus">-	// We're going to inject a fake input element with a specified name</span>
<a href="#l23.2138"></a><span id="l23.2138" class="difflineminus">-	var form = document.createElement(&quot;form&quot;),</span>
<a href="#l23.2139"></a><span id="l23.2139" class="difflineminus">-		id = &quot;script&quot; + (new Date).getTime();</span>
<a href="#l23.2140"></a><span id="l23.2140" class="difflineminus">-	form.innerHTML = &quot;&lt;input name='&quot; + id + &quot;'/&gt;&quot;;</span>
<a href="#l23.2141"></a><span id="l23.2141" class="difflineminus">-</span>
<a href="#l23.2142"></a><span id="l23.2142" class="difflineminus">-	// Inject it into the root element, check its status, and remove it quickly</span>
<a href="#l23.2143"></a><span id="l23.2143" class="difflineminus">-	var root = document.documentElement;</span>
<a href="#l23.2144"></a><span id="l23.2144" class="difflineminus">-	root.insertBefore( form, root.firstChild );</span>
<a href="#l23.2145"></a><span id="l23.2145" class="difflineminus">-</span>
<a href="#l23.2146"></a><span id="l23.2146" class="difflineminus">-	// The workaround has to do additional checks after a getElementById</span>
<a href="#l23.2147"></a><span id="l23.2147" class="difflineminus">-	// Which slows things down for other browsers (hence the branching)</span>
<a href="#l23.2148"></a><span id="l23.2148" class="difflineminus">-	if ( !!document.getElementById( id ) ) {</span>
<a href="#l23.2149"></a><span id="l23.2149" class="difflineminus">-		Expr.find.ID = function(match, context, isXML){</span>
<a href="#l23.2150"></a><span id="l23.2150" class="difflineminus">-			if ( typeof context.getElementById !== &quot;undefined&quot; &amp;&amp; !isXML ) {</span>
<a href="#l23.2151"></a><span id="l23.2151" class="difflineminus">-				var m = context.getElementById(match[1]);</span>
<a href="#l23.2152"></a><span id="l23.2152" class="difflineminus">-				return m ? m.id === match[1] || typeof m.getAttributeNode !== &quot;undefined&quot; &amp;&amp; m.getAttributeNode(&quot;id&quot;).nodeValue === match[1] ? [m] : undefined : [];</span>
<a href="#l23.2153"></a><span id="l23.2153" class="difflineminus">-			}</span>
<a href="#l23.2154"></a><span id="l23.2154" class="difflineminus">-		};</span>
<a href="#l23.2155"></a><span id="l23.2155" class="difflineminus">-</span>
<a href="#l23.2156"></a><span id="l23.2156" class="difflineminus">-		Expr.filter.ID = function(elem, match){</span>
<a href="#l23.2157"></a><span id="l23.2157" class="difflineminus">-			var node = typeof elem.getAttributeNode !== &quot;undefined&quot; &amp;&amp; elem.getAttributeNode(&quot;id&quot;);</span>
<a href="#l23.2158"></a><span id="l23.2158" class="difflineminus">-			return elem.nodeType === 1 &amp;&amp; node &amp;&amp; node.nodeValue === match;</span>
<a href="#l23.2159"></a><span id="l23.2159" class="difflineminus">-		};</span>
<a href="#l23.2160"></a><span id="l23.2160" class="difflineminus">-	}</span>
<a href="#l23.2161"></a><span id="l23.2161" class="difflineminus">-</span>
<a href="#l23.2162"></a><span id="l23.2162" class="difflineminus">-	root.removeChild( form );</span>
<a href="#l23.2163"></a><span id="l23.2163" class="difflineminus">-})();</span>
<a href="#l23.2164"></a><span id="l23.2164" class="difflineminus">-</span>
<a href="#l23.2165"></a><span id="l23.2165" class="difflineminus">-(function(){</span>
<a href="#l23.2166"></a><span id="l23.2166" class="difflineminus">-	// Check to see if the browser returns only elements</span>
<a href="#l23.2167"></a><span id="l23.2167" class="difflineminus">-	// when doing getElementsByTagName(&quot;*&quot;)</span>
<a href="#l23.2168"></a><span id="l23.2168" class="difflineminus">-</span>
<a href="#l23.2169"></a><span id="l23.2169" class="difflineminus">-	// Create a fake element</span>
<a href="#l23.2170"></a><span id="l23.2170" class="difflineminus">-	var div = document.createElement(&quot;div&quot;);</span>
<a href="#l23.2171"></a><span id="l23.2171" class="difflineminus">-	div.appendChild( document.createComment(&quot;&quot;) );</span>
<a href="#l23.2172"></a><span id="l23.2172" class="difflineminus">-</span>
<a href="#l23.2173"></a><span id="l23.2173" class="difflineminus">-	// Make sure no comments are found</span>
<a href="#l23.2174"></a><span id="l23.2174" class="difflineminus">-	if ( div.getElementsByTagName(&quot;*&quot;).length &gt; 0 ) {</span>
<a href="#l23.2175"></a><span id="l23.2175" class="difflineminus">-		Expr.find.TAG = function(match, context){</span>
<a href="#l23.2176"></a><span id="l23.2176" class="difflineminus">-			var results = context.getElementsByTagName(match[1]);</span>
<a href="#l23.2177"></a><span id="l23.2177" class="difflineminus">-</span>
<a href="#l23.2178"></a><span id="l23.2178" class="difflineminus">-			// Filter out possible comments</span>
<a href="#l23.2179"></a><span id="l23.2179" class="difflineminus">-			if ( match[1] === &quot;*&quot; ) {</span>
<a href="#l23.2180"></a><span id="l23.2180" class="difflineminus">-				var tmp = [];</span>
<a href="#l23.2181"></a><span id="l23.2181" class="difflineminus">-</span>
<a href="#l23.2182"></a><span id="l23.2182" class="difflineminus">-				for ( var i = 0; results[i]; i++ ) {</span>
<a href="#l23.2183"></a><span id="l23.2183" class="difflineminus">-					if ( results[i].nodeType === 1 ) {</span>
<a href="#l23.2184"></a><span id="l23.2184" class="difflineminus">-						tmp.push( results[i] );</span>
<a href="#l23.2185"></a><span id="l23.2185" class="difflineminus">-					}</span>
<a href="#l23.2186"></a><span id="l23.2186" class="difflineminus">-				}</span>
<a href="#l23.2187"></a><span id="l23.2187" class="difflineminus">-</span>
<a href="#l23.2188"></a><span id="l23.2188" class="difflineminus">-				results = tmp;</span>
<a href="#l23.2189"></a><span id="l23.2189" class="difflineminus">-			}</span>
<a href="#l23.2190"></a><span id="l23.2190" class="difflineminus">-</span>
<a href="#l23.2191"></a><span id="l23.2191" class="difflineminus">-			return results;</span>
<a href="#l23.2192"></a><span id="l23.2192" class="difflineminus">-		};</span>
<a href="#l23.2193"></a><span id="l23.2193" class="difflineminus">-	}</span>
<a href="#l23.2194"></a><span id="l23.2194" class="difflineminus">-</span>
<a href="#l23.2195"></a><span id="l23.2195" class="difflineminus">-	// Check to see if an attribute returns normalized href attributes</span>
<a href="#l23.2196"></a><span id="l23.2196" class="difflineminus">-	div.innerHTML = &quot;&lt;a href='#'&gt;&lt;/a&gt;&quot;;</span>
<a href="#l23.2197"></a><span id="l23.2197" class="difflineminus">-	if ( div.firstChild &amp;&amp; typeof div.firstChild.getAttribute !== &quot;undefined&quot; &amp;&amp;</span>
<a href="#l23.2198"></a><span id="l23.2198" class="difflineminus">-			div.firstChild.getAttribute(&quot;href&quot;) !== &quot;#&quot; ) {</span>
<a href="#l23.2199"></a><span id="l23.2199" class="difflineminus">-		Expr.attrHandle.href = function(elem){</span>
<a href="#l23.2200"></a><span id="l23.2200" class="difflineminus">-			return elem.getAttribute(&quot;href&quot;, 2);</span>
<a href="#l23.2201"></a><span id="l23.2201" class="difflineminus">-		};</span>
<a href="#l23.2202"></a><span id="l23.2202" class="difflineminus">-	}</span>
<a href="#l23.2203"></a><span id="l23.2203" class="difflineminus">-})();</span>
<a href="#l23.2204"></a><span id="l23.2204" class="difflineminus">-</span>
<a href="#l23.2205"></a><span id="l23.2205" class="difflineminus">-if ( document.querySelectorAll ) (function(){</span>
<a href="#l23.2206"></a><span id="l23.2206" class="difflineminus">-	var oldSizzle = Sizzle, div = document.createElement(&quot;div&quot;);</span>
<a href="#l23.2207"></a><span id="l23.2207" class="difflineminus">-	div.innerHTML = &quot;&lt;p class='TEST'&gt;&lt;/p&gt;&quot;;</span>
<a href="#l23.2208"></a><span id="l23.2208" class="difflineminus">-</span>
<a href="#l23.2209"></a><span id="l23.2209" class="difflineminus">-	// Safari can't handle uppercase or unicode characters when</span>
<a href="#l23.2210"></a><span id="l23.2210" class="difflineminus">-	// in quirks mode.</span>
<a href="#l23.2211"></a><span id="l23.2211" class="difflineminus">-	if ( div.querySelectorAll &amp;&amp; div.querySelectorAll(&quot;.TEST&quot;).length === 0 ) {</span>
<a href="#l23.2212"></a><span id="l23.2212" class="difflineminus">-		return;</span>
<a href="#l23.2213"></a><span id="l23.2213" class="difflineminus">-	}</span>
<a href="#l23.2214"></a><span id="l23.2214" class="difflineminus">-	</span>
<a href="#l23.2215"></a><span id="l23.2215" class="difflineminus">-	Sizzle = function(query, context, extra, seed){</span>
<a href="#l23.2216"></a><span id="l23.2216" class="difflineminus">-		context = context || document;</span>
<a href="#l23.2217"></a><span id="l23.2217" class="difflineminus">-</span>
<a href="#l23.2218"></a><span id="l23.2218" class="difflineminus">-		// Only use querySelectorAll on non-XML documents</span>
<a href="#l23.2219"></a><span id="l23.2219" class="difflineminus">-		// (ID selectors don't work in non-HTML documents)</span>
<a href="#l23.2220"></a><span id="l23.2220" class="difflineminus">-		if ( !seed &amp;&amp; context.nodeType === 9 &amp;&amp; !isXML(context) ) {</span>
<a href="#l23.2221"></a><span id="l23.2221" class="difflineminus">-			try {</span>
<a href="#l23.2222"></a><span id="l23.2222" class="difflineminus">-				return makeArray( context.querySelectorAll(query), extra );</span>
<a href="#l23.2223"></a><span id="l23.2223" class="difflineminus">-			} catch(e){}</span>
<a href="#l23.2224"></a><span id="l23.2224" class="difflineminus">-		}</span>
<a href="#l23.2225"></a><span id="l23.2225" class="difflineminus">-		</span>
<a href="#l23.2226"></a><span id="l23.2226" class="difflineminus">-		return oldSizzle(query, context, extra, seed);</span>
<a href="#l23.2227"></a><span id="l23.2227" class="difflineminus">-	};</span>
<a href="#l23.2228"></a><span id="l23.2228" class="difflineminus">-</span>
<a href="#l23.2229"></a><span id="l23.2229" class="difflineminus">-	Sizzle.find = oldSizzle.find;</span>
<a href="#l23.2230"></a><span id="l23.2230" class="difflineminus">-	Sizzle.filter = oldSizzle.filter;</span>
<a href="#l23.2231"></a><span id="l23.2231" class="difflineminus">-	Sizzle.selectors = oldSizzle.selectors;</span>
<a href="#l23.2232"></a><span id="l23.2232" class="difflineminus">-	Sizzle.matches = oldSizzle.matches;</span>
<a href="#l23.2233"></a><span id="l23.2233" class="difflineminus">-})();</span>
<a href="#l23.2234"></a><span id="l23.2234" class="difflineminus">-</span>
<a href="#l23.2235"></a><span id="l23.2235" class="difflineminus">-if ( document.getElementsByClassName &amp;&amp; document.documentElement.getElementsByClassName ) (function(){</span>
<a href="#l23.2236"></a><span id="l23.2236" class="difflineminus">-	var div = document.createElement(&quot;div&quot;);</span>
<a href="#l23.2237"></a><span id="l23.2237" class="difflineminus">-	div.innerHTML = &quot;&lt;div class='test e'&gt;&lt;/div&gt;&lt;div class='test'&gt;&lt;/div&gt;&quot;;</span>
<a href="#l23.2238"></a><span id="l23.2238" class="difflineminus">-</span>
<a href="#l23.2239"></a><span id="l23.2239" class="difflineminus">-	// Opera can't find a second classname (in 9.6)</span>
<a href="#l23.2240"></a><span id="l23.2240" class="difflineminus">-	if ( div.getElementsByClassName(&quot;e&quot;).length === 0 )</span>
<a href="#l23.2241"></a><span id="l23.2241" class="difflineminus">-		return;</span>
<a href="#l23.2242"></a><span id="l23.2242" class="difflineminus">-</span>
<a href="#l23.2243"></a><span id="l23.2243" class="difflineminus">-	// Safari caches class attributes, doesn't catch changes (in 3.2)</span>
<a href="#l23.2244"></a><span id="l23.2244" class="difflineminus">-	div.lastChild.className = &quot;e&quot;;</span>
<a href="#l23.2245"></a><span id="l23.2245" class="difflineminus">-</span>
<a href="#l23.2246"></a><span id="l23.2246" class="difflineminus">-	if ( div.getElementsByClassName(&quot;e&quot;).length === 1 )</span>
<a href="#l23.2247"></a><span id="l23.2247" class="difflineminus">-		return;</span>
<a href="#l23.2248"></a><span id="l23.2248" class="difflineminus">-</span>
<a href="#l23.2249"></a><span id="l23.2249" class="difflineminus">-	Expr.order.splice(1, 0, &quot;CLASS&quot;);</span>
<a href="#l23.2250"></a><span id="l23.2250" class="difflineminus">-	Expr.find.CLASS = function(match, context, isXML) {</span>
<a href="#l23.2251"></a><span id="l23.2251" class="difflineminus">-		if ( typeof context.getElementsByClassName !== &quot;undefined&quot; &amp;&amp; !isXML ) {</span>
<a href="#l23.2252"></a><span id="l23.2252" class="difflineminus">-			return context.getElementsByClassName(match[1]);</span>
<a href="#l23.2253"></a><span id="l23.2253" class="difflineminus">-		}</span>
<a href="#l23.2254"></a><span id="l23.2254" class="difflineminus">-	};</span>
<a href="#l23.2255"></a><span id="l23.2255" class="difflineminus">-})();</span>
<a href="#l23.2256"></a><span id="l23.2256" class="difflineminus">-</span>
<a href="#l23.2257"></a><span id="l23.2257" class="difflineminus">-function dirNodeCheck( dir, cur, doneName, checkSet, nodeCheck, isXML ) {</span>
<a href="#l23.2258"></a><span id="l23.2258" class="difflineminus">-	var sibDir = dir == &quot;previousSibling&quot; &amp;&amp; !isXML;</span>
<a href="#l23.2259"></a><span id="l23.2259" class="difflineminus">-	for ( var i = 0, l = checkSet.length; i &lt; l; i++ ) {</span>
<a href="#l23.2260"></a><span id="l23.2260" class="difflineminus">-		var elem = checkSet[i];</span>
<a href="#l23.2261"></a><span id="l23.2261" class="difflineminus">-		if ( elem ) {</span>
<a href="#l23.2262"></a><span id="l23.2262" class="difflineminus">-			if ( sibDir &amp;&amp; elem.nodeType === 1 ){</span>
<a href="#l23.2263"></a><span id="l23.2263" class="difflineminus">-				elem.sizcache = doneName;</span>
<a href="#l23.2264"></a><span id="l23.2264" class="difflineminus">-				elem.sizset = i;</span>
<a href="#l23.2265"></a><span id="l23.2265" class="difflineminus">-			}</span>
<a href="#l23.2266"></a><span id="l23.2266" class="difflineminus">-			elem = elem[dir];</span>
<a href="#l23.2267"></a><span id="l23.2267" class="difflineminus">-			var match = false;</span>
<a href="#l23.2268"></a><span id="l23.2268" class="difflineminus">-</span>
<a href="#l23.2269"></a><span id="l23.2269" class="difflineminus">-			while ( elem ) {</span>
<a href="#l23.2270"></a><span id="l23.2270" class="difflineminus">-				if ( elem.sizcache === doneName ) {</span>
<a href="#l23.2271"></a><span id="l23.2271" class="difflineminus">-					match = checkSet[elem.sizset];</span>
<a href="#l23.2272"></a><span id="l23.2272" class="difflineminus">-					break;</span>
<a href="#l23.2273"></a><span id="l23.2273" class="difflineminus">-				}</span>
<a href="#l23.2274"></a><span id="l23.2274" class="difflineminus">-</span>
<a href="#l23.2275"></a><span id="l23.2275" class="difflineminus">-				if ( elem.nodeType === 1 &amp;&amp; !isXML ){</span>
<a href="#l23.2276"></a><span id="l23.2276" class="difflineminus">-					elem.sizcache = doneName;</span>
<a href="#l23.2277"></a><span id="l23.2277" class="difflineminus">-					elem.sizset = i;</span>
<a href="#l23.2278"></a><span id="l23.2278" class="difflineminus">-				}</span>
<a href="#l23.2279"></a><span id="l23.2279" class="difflineminus">-</span>
<a href="#l23.2280"></a><span id="l23.2280" class="difflineminus">-				if ( elem.nodeName === cur ) {</span>
<a href="#l23.2281"></a><span id="l23.2281" class="difflineminus">-					match = elem;</span>
<a href="#l23.2282"></a><span id="l23.2282" class="difflineminus">-					break;</span>
<a href="#l23.2283"></a><span id="l23.2283" class="difflineminus">-				}</span>
<a href="#l23.2284"></a><span id="l23.2284" class="difflineminus">-</span>
<a href="#l23.2285"></a><span id="l23.2285" class="difflineminus">-				elem = elem[dir];</span>
<a href="#l23.2286"></a><span id="l23.2286" class="difflineminus">-			}</span>
<a href="#l23.2287"></a><span id="l23.2287" class="difflineminus">-</span>
<a href="#l23.2288"></a><span id="l23.2288" class="difflineminus">-			checkSet[i] = match;</span>
<a href="#l23.2289"></a><span id="l23.2289" class="difflineminus">-		}</span>
<a href="#l23.2290"></a><span id="l23.2290" class="difflineminus">-	}</span>
<a href="#l23.2291"></a><span id="l23.2291" class="difflineminus">-}</span>
<a href="#l23.2292"></a><span id="l23.2292" class="difflineminus">-</span>
<a href="#l23.2293"></a><span id="l23.2293" class="difflineminus">-function dirCheck( dir, cur, doneName, checkSet, nodeCheck, isXML ) {</span>
<a href="#l23.2294"></a><span id="l23.2294" class="difflineminus">-	var sibDir = dir == &quot;previousSibling&quot; &amp;&amp; !isXML;</span>
<a href="#l23.2295"></a><span id="l23.2295" class="difflineminus">-	for ( var i = 0, l = checkSet.length; i &lt; l; i++ ) {</span>
<a href="#l23.2296"></a><span id="l23.2296" class="difflineminus">-		var elem = checkSet[i];</span>
<a href="#l23.2297"></a><span id="l23.2297" class="difflineminus">-		if ( elem ) {</span>
<a href="#l23.2298"></a><span id="l23.2298" class="difflineminus">-			if ( sibDir &amp;&amp; elem.nodeType === 1 ) {</span>
<a href="#l23.2299"></a><span id="l23.2299" class="difflineminus">-				elem.sizcache = doneName;</span>
<a href="#l23.2300"></a><span id="l23.2300" class="difflineminus">-				elem.sizset = i;</span>
<a href="#l23.2301"></a><span id="l23.2301" class="difflineminus">-			}</span>
<a href="#l23.2302"></a><span id="l23.2302" class="difflineminus">-			elem = elem[dir];</span>
<a href="#l23.2303"></a><span id="l23.2303" class="difflineminus">-			var match = false;</span>
<a href="#l23.2304"></a><span id="l23.2304" class="difflineminus">-</span>
<a href="#l23.2305"></a><span id="l23.2305" class="difflineminus">-			while ( elem ) {</span>
<a href="#l23.2306"></a><span id="l23.2306" class="difflineminus">-				if ( elem.sizcache === doneName ) {</span>
<a href="#l23.2307"></a><span id="l23.2307" class="difflineminus">-					match = checkSet[elem.sizset];</span>
<a href="#l23.2308"></a><span id="l23.2308" class="difflineminus">-					break;</span>
<a href="#l23.2309"></a><span id="l23.2309" class="difflineminus">-				}</span>
<a href="#l23.2310"></a><span id="l23.2310" class="difflineminus">-</span>
<a href="#l23.2311"></a><span id="l23.2311" class="difflineminus">-				if ( elem.nodeType === 1 ) {</span>
<a href="#l23.2312"></a><span id="l23.2312" class="difflineminus">-					if ( !isXML ) {</span>
<a href="#l23.2313"></a><span id="l23.2313" class="difflineminus">-						elem.sizcache = doneName;</span>
<a href="#l23.2314"></a><span id="l23.2314" class="difflineminus">-						elem.sizset = i;</span>
<a href="#l23.2315"></a><span id="l23.2315" class="difflineminus">-					}</span>
<a href="#l23.2316"></a><span id="l23.2316" class="difflineminus">-					if ( typeof cur !== &quot;string&quot; ) {</span>
<a href="#l23.2317"></a><span id="l23.2317" class="difflineminus">-						if ( elem === cur ) {</span>
<a href="#l23.2318"></a><span id="l23.2318" class="difflineminus">-							match = true;</span>
<a href="#l23.2319"></a><span id="l23.2319" class="difflineminus">-							break;</span>
<a href="#l23.2320"></a><span id="l23.2320" class="difflineminus">-						}</span>
<a href="#l23.2321"></a><span id="l23.2321" class="difflineminus">-</span>
<a href="#l23.2322"></a><span id="l23.2322" class="difflineminus">-					} else if ( Sizzle.filter( cur, [elem] ).length &gt; 0 ) {</span>
<a href="#l23.2323"></a><span id="l23.2323" class="difflineminus">-						match = elem;</span>
<a href="#l23.2324"></a><span id="l23.2324" class="difflineminus">-						break;</span>
<a href="#l23.2325"></a><span id="l23.2325" class="difflineminus">-					}</span>
<a href="#l23.2326"></a><span id="l23.2326" class="difflineminus">-				}</span>
<a href="#l23.2327"></a><span id="l23.2327" class="difflineminus">-</span>
<a href="#l23.2328"></a><span id="l23.2328" class="difflineminus">-				elem = elem[dir];</span>
<a href="#l23.2329"></a><span id="l23.2329" class="difflineminus">-			}</span>
<a href="#l23.2330"></a><span id="l23.2330" class="difflineminus">-</span>
<a href="#l23.2331"></a><span id="l23.2331" class="difflineminus">-			checkSet[i] = match;</span>
<a href="#l23.2332"></a><span id="l23.2332" class="difflineminus">-		}</span>
<a href="#l23.2333"></a><span id="l23.2333" class="difflineminus">-	}</span>
<a href="#l23.2334"></a><span id="l23.2334" class="difflineminus">-}</span>
<a href="#l23.2335"></a><span id="l23.2335" class="difflineminus">-</span>
<a href="#l23.2336"></a><span id="l23.2336" class="difflineminus">-var contains = document.compareDocumentPosition ?  function(a, b){</span>
<a href="#l23.2337"></a><span id="l23.2337" class="difflineminus">-	return a.compareDocumentPosition(b) &amp; 16;</span>
<a href="#l23.2338"></a><span id="l23.2338" class="difflineminus">-} : function(a, b){</span>
<a href="#l23.2339"></a><span id="l23.2339" class="difflineminus">-	return a !== b &amp;&amp; (a.contains ? a.contains(b) : true);</span>
<a href="#l23.2340"></a><span id="l23.2340" class="difflineminus">-};</span>
<a href="#l23.2341"></a><span id="l23.2341" class="difflineminus">-</span>
<a href="#l23.2342"></a><span id="l23.2342" class="difflineminus">-var isXML = function(elem){</span>
<a href="#l23.2343"></a><span id="l23.2343" class="difflineminus">-	return elem.nodeType === 9 &amp;&amp; elem.documentElement.nodeName !== &quot;HTML&quot; ||</span>
<a href="#l23.2344"></a><span id="l23.2344" class="difflineminus">-		!!elem.ownerDocument &amp;&amp; isXML( elem.ownerDocument );</span>
<a href="#l23.2345"></a><span id="l23.2345" class="difflineminus">-};</span>
<a href="#l23.2346"></a><span id="l23.2346" class="difflineminus">-</span>
<a href="#l23.2347"></a><span id="l23.2347" class="difflineminus">-var posProcess = function(selector, context){</span>
<a href="#l23.2348"></a><span id="l23.2348" class="difflineminus">-	var tmpSet = [], later = &quot;&quot;, match,</span>
<a href="#l23.2349"></a><span id="l23.2349" class="difflineminus">-		root = context.nodeType ? [context] : context;</span>
<a href="#l23.2350"></a><span id="l23.2350" class="difflineminus">-</span>
<a href="#l23.2351"></a><span id="l23.2351" class="difflineminus">-	// Position selectors must be done after the filter</span>
<a href="#l23.2352"></a><span id="l23.2352" class="difflineminus">-	// And so must :not(positional) so we move all PSEUDOs to the end</span>
<a href="#l23.2353"></a><span id="l23.2353" class="difflineminus">-	while ( (match = Expr.match.PSEUDO.exec( selector )) ) {</span>
<a href="#l23.2354"></a><span id="l23.2354" class="difflineminus">-		later += match[0];</span>
<a href="#l23.2355"></a><span id="l23.2355" class="difflineminus">-		selector = selector.replace( Expr.match.PSEUDO, &quot;&quot; );</span>
<a href="#l23.2356"></a><span id="l23.2356" class="difflineminus">-	}</span>
<a href="#l23.2357"></a><span id="l23.2357" class="difflineminus">-</span>
<a href="#l23.2358"></a><span id="l23.2358" class="difflineminus">-	selector = Expr.relative[selector] ? selector + &quot;*&quot; : selector;</span>
<a href="#l23.2359"></a><span id="l23.2359" class="difflineminus">-</span>
<a href="#l23.2360"></a><span id="l23.2360" class="difflineminus">-	for ( var i = 0, l = root.length; i &lt; l; i++ ) {</span>
<a href="#l23.2361"></a><span id="l23.2361" class="difflineminus">-		Sizzle( selector, root[i], tmpSet );</span>
<a href="#l23.2362"></a><span id="l23.2362" class="difflineminus">-	}</span>
<a href="#l23.2363"></a><span id="l23.2363" class="difflineminus">-</span>
<a href="#l23.2364"></a><span id="l23.2364" class="difflineminus">-	return Sizzle.filter( later, tmpSet );</span>
<a href="#l23.2365"></a><span id="l23.2365" class="difflineminus">-};</span>
<a href="#l23.2366"></a><span id="l23.2366" class="difflineminus">-</span>
<a href="#l23.2367"></a><span id="l23.2367" class="difflineminus">-// EXPOSE</span>
<a href="#l23.2368"></a><span id="l23.2368" class="difflineminus">-jQuery.find = Sizzle;</span>
<a href="#l23.2369"></a><span id="l23.2369" class="difflineminus">-jQuery.filter = Sizzle.filter;</span>
<a href="#l23.2370"></a><span id="l23.2370" class="difflineminus">-jQuery.expr = Sizzle.selectors;</span>
<a href="#l23.2371"></a><span id="l23.2371" class="difflineminus">-jQuery.expr[&quot;:&quot;] = jQuery.expr.filters;</span>
<a href="#l23.2372"></a><span id="l23.2372" class="difflineminus">-</span>
<a href="#l23.2373"></a><span id="l23.2373" class="difflineminus">-Sizzle.selectors.filters.hidden = function(elem){</span>
<a href="#l23.2374"></a><span id="l23.2374" class="difflineminus">-	return elem.offsetWidth === 0 || elem.offsetHeight === 0;</span>
<a href="#l23.2375"></a><span id="l23.2375" class="difflineminus">-};</span>
<a href="#l23.2376"></a><span id="l23.2376" class="difflineminus">-</span>
<a href="#l23.2377"></a><span id="l23.2377" class="difflineminus">-Sizzle.selectors.filters.visible = function(elem){</span>
<a href="#l23.2378"></a><span id="l23.2378" class="difflineminus">-	return elem.offsetWidth &gt; 0 || elem.offsetHeight &gt; 0;</span>
<a href="#l23.2379"></a><span id="l23.2379" class="difflineminus">-};</span>
<a href="#l23.2380"></a><span id="l23.2380" class="difflineminus">-</span>
<a href="#l23.2381"></a><span id="l23.2381" class="difflineminus">-Sizzle.selectors.filters.animated = function(elem){</span>
<a href="#l23.2382"></a><span id="l23.2382" class="difflineminus">-	return jQuery.grep(jQuery.timers, function(fn){</span>
<a href="#l23.2383"></a><span id="l23.2383" class="difflineminus">-		return elem === fn.elem;</span>
<a href="#l23.2384"></a><span id="l23.2384" class="difflineminus">-	}).length;</span>
<a href="#l23.2385"></a><span id="l23.2385" class="difflineminus">-};</span>
<a href="#l23.2386"></a><span id="l23.2386" class="difflineminus">-</span>
<a href="#l23.2387"></a><span id="l23.2387" class="difflineminus">-jQuery.multiFilter = function( expr, elems, not ) {</span>
<a href="#l23.2388"></a><span id="l23.2388" class="difflineminus">-	if ( not ) {</span>
<a href="#l23.2389"></a><span id="l23.2389" class="difflineminus">-		expr = &quot;:not(&quot; + expr + &quot;)&quot;;</span>
<a href="#l23.2390"></a><span id="l23.2390" class="difflineminus">-	}</span>
<a href="#l23.2391"></a><span id="l23.2391" class="difflineminus">-</span>
<a href="#l23.2392"></a><span id="l23.2392" class="difflineminus">-	return Sizzle.matches(expr, elems);</span>
<a href="#l23.2393"></a><span id="l23.2393" class="difflineminus">-};</span>
<a href="#l23.2394"></a><span id="l23.2394" class="difflineminus">-</span>
<a href="#l23.2395"></a><span id="l23.2395" class="difflineminus">-jQuery.dir = function( elem, dir ){</span>
<a href="#l23.2396"></a><span id="l23.2396" class="difflineminus">-	var matched = [], cur = elem[dir];</span>
<a href="#l23.2397"></a><span id="l23.2397" class="difflineminus">-	while ( cur &amp;&amp; cur != document ) {</span>
<a href="#l23.2398"></a><span id="l23.2398" class="difflineminus">-		if ( cur.nodeType == 1 )</span>
<a href="#l23.2399"></a><span id="l23.2399" class="difflineminus">-			matched.push( cur );</span>
<a href="#l23.2400"></a><span id="l23.2400" class="difflineminus">-		cur = cur[dir];</span>
<a href="#l23.2401"></a><span id="l23.2401" class="difflineminus">-	}</span>
<a href="#l23.2402"></a><span id="l23.2402" class="difflineminus">-	return matched;</span>
<a href="#l23.2403"></a><span id="l23.2403" class="difflineminus">-};</span>
<a href="#l23.2404"></a><span id="l23.2404" class="difflineminus">-</span>
<a href="#l23.2405"></a><span id="l23.2405" class="difflineminus">-jQuery.nth = function(cur, result, dir, elem){</span>
<a href="#l23.2406"></a><span id="l23.2406" class="difflineminus">-	result = result || 1;</span>
<a href="#l23.2407"></a><span id="l23.2407" class="difflineminus">-	var num = 0;</span>
<a href="#l23.2408"></a><span id="l23.2408" class="difflineminus">-</span>
<a href="#l23.2409"></a><span id="l23.2409" class="difflineminus">-	for ( ; cur; cur = cur[dir] )</span>
<a href="#l23.2410"></a><span id="l23.2410" class="difflineminus">-		if ( cur.nodeType == 1 &amp;&amp; ++num == result )</span>
<a href="#l23.2411"></a><span id="l23.2411" class="difflineminus">-			break;</span>
<a href="#l23.2412"></a><span id="l23.2412" class="difflineminus">-</span>
<a href="#l23.2413"></a><span id="l23.2413" class="difflineminus">-	return cur;</span>
<a href="#l23.2414"></a><span id="l23.2414" class="difflineminus">-};</span>
<a href="#l23.2415"></a><span id="l23.2415" class="difflineminus">-</span>
<a href="#l23.2416"></a><span id="l23.2416" class="difflineminus">-jQuery.sibling = function(n, elem){</span>
<a href="#l23.2417"></a><span id="l23.2417" class="difflineminus">-	var r = [];</span>
<a href="#l23.2418"></a><span id="l23.2418" class="difflineminus">-</span>
<a href="#l23.2419"></a><span id="l23.2419" class="difflineminus">-	for ( ; n; n = n.nextSibling ) {</span>
<a href="#l23.2420"></a><span id="l23.2420" class="difflineminus">-		if ( n.nodeType == 1 &amp;&amp; n != elem )</span>
<a href="#l23.2421"></a><span id="l23.2421" class="difflineminus">-			r.push( n );</span>
<a href="#l23.2422"></a><span id="l23.2422" class="difflineminus">-	}</span>
<a href="#l23.2423"></a><span id="l23.2423" class="difflineminus">-</span>
<a href="#l23.2424"></a><span id="l23.2424" class="difflineminus">-	return r;</span>
<a href="#l23.2425"></a><span id="l23.2425" class="difflineminus">-};</span>
<a href="#l23.2426"></a><span id="l23.2426" class="difflineminus">-</span>
<a href="#l23.2427"></a><span id="l23.2427" class="difflineminus">-return;</span>
<a href="#l23.2428"></a><span id="l23.2428" class="difflineminus">-</span>
<a href="#l23.2429"></a><span id="l23.2429" class="difflineminus">-window.Sizzle = Sizzle;</span>
<a href="#l23.2430"></a><span id="l23.2430" class="difflineminus">-</span>
<a href="#l23.2431"></a><span id="l23.2431" class="difflineminus">-})();</span>
<a href="#l23.2432"></a><span id="l23.2432" class="difflineminus">-/*</span>
<a href="#l23.2433"></a><span id="l23.2433" class="difflineminus">- * A number of helper functions used for managing events.</span>
<a href="#l23.2434"></a><span id="l23.2434" class="difflineminus">- * Many of the ideas behind this code originated from</span>
<a href="#l23.2435"></a><span id="l23.2435" class="difflineminus">- * Dean Edwards' addEvent library.</span>
<a href="#l23.2436"></a><span id="l23.2436" class="difflineminus">- */</span>
<a href="#l23.2437"></a><span id="l23.2437" class="difflineminus">-jQuery.event = {</span>
<a href="#l23.2438"></a><span id="l23.2438" class="difflineminus">-</span>
<a href="#l23.2439"></a><span id="l23.2439" class="difflineminus">-	// Bind an event to an element</span>
<a href="#l23.2440"></a><span id="l23.2440" class="difflineminus">-	// Original by Dean Edwards</span>
<a href="#l23.2441"></a><span id="l23.2441" class="difflineminus">-	add: function(elem, types, handler, data) {</span>
<a href="#l23.2442"></a><span id="l23.2442" class="difflineminus">-		if ( elem.nodeType == 3 || elem.nodeType == 8 )</span>
<a href="#l23.2443"></a><span id="l23.2443" class="difflineminus">-			return;</span>
<a href="#l23.2444"></a><span id="l23.2444" class="difflineminus">-</span>
<a href="#l23.2445"></a><span id="l23.2445" class="difflineminus">-		// For whatever reason, IE has trouble passing the window object</span>
<a href="#l23.2446"></a><span id="l23.2446" class="difflineminus">-		// around, causing it to be cloned in the process</span>
<a href="#l23.2447"></a><span id="l23.2447" class="difflineminus">-		if ( elem.setInterval &amp;&amp; elem != window )</span>
<a href="#l23.2448"></a><span id="l23.2448" class="difflineminus">-			elem = window;</span>
<a href="#l23.2449"></a><span id="l23.2449" class="difflineminus">-</span>
<a href="#l23.2450"></a><span id="l23.2450" class="difflineminus">-		// Make sure that the function being executed has a unique ID</span>
<a href="#l23.2451"></a><span id="l23.2451" class="difflineminus">-		if ( !handler.guid )</span>
<a href="#l23.2452"></a><span id="l23.2452" class="difflineminus">-			handler.guid = this.guid++;</span>
<a href="#l23.2453"></a><span id="l23.2453" class="difflineminus">-</span>
<a href="#l23.2454"></a><span id="l23.2454" class="difflineminus">-		// if data is passed, bind to handler</span>
<a href="#l23.2455"></a><span id="l23.2455" class="difflineminus">-		if ( data !== undefined ) {</span>
<a href="#l23.2456"></a><span id="l23.2456" class="difflineminus">-			// Create temporary function pointer to original handler</span>
<a href="#l23.2457"></a><span id="l23.2457" class="difflineminus">-			var fn = handler;</span>
<a href="#l23.2458"></a><span id="l23.2458" class="difflineminus">-</span>
<a href="#l23.2459"></a><span id="l23.2459" class="difflineminus">-			// Create unique handler function, wrapped around original handler</span>
<a href="#l23.2460"></a><span id="l23.2460" class="difflineminus">-			handler = this.proxy( fn );</span>
<a href="#l23.2461"></a><span id="l23.2461" class="difflineminus">-</span>
<a href="#l23.2462"></a><span id="l23.2462" class="difflineminus">-			// Store data in unique handler</span>
<a href="#l23.2463"></a><span id="l23.2463" class="difflineminus">-			handler.data = data;</span>
<a href="#l23.2464"></a><span id="l23.2464" class="difflineminus">-		}</span>
<a href="#l23.2465"></a><span id="l23.2465" class="difflineminus">-</span>
<a href="#l23.2466"></a><span id="l23.2466" class="difflineminus">-		// Init the element's event structure</span>
<a href="#l23.2467"></a><span id="l23.2467" class="difflineminus">-		var events = jQuery.data(elem, &quot;events&quot;) || jQuery.data(elem, &quot;events&quot;, {}),</span>
<a href="#l23.2468"></a><span id="l23.2468" class="difflineminus">-			handle = jQuery.data(elem, &quot;handle&quot;) || jQuery.data(elem, &quot;handle&quot;, function(){</span>
<a href="#l23.2469"></a><span id="l23.2469" class="difflineminus">-				// Handle the second event of a trigger and when</span>
<a href="#l23.2470"></a><span id="l23.2470" class="difflineminus">-				// an event is called after a page has unloaded</span>
<a href="#l23.2471"></a><span id="l23.2471" class="difflineminus">-				return typeof jQuery !== &quot;undefined&quot; &amp;&amp; !jQuery.event.triggered ?</span>
<a href="#l23.2472"></a><span id="l23.2472" class="difflineminus">-					jQuery.event.handle.apply(arguments.callee.elem, arguments) :</span>
<a href="#l23.2473"></a><span id="l23.2473" class="difflineminus">-					undefined;</span>
<a href="#l23.2474"></a><span id="l23.2474" class="difflineminus">-			});</span>
<a href="#l23.2475"></a><span id="l23.2475" class="difflineminus">-		// Add elem as a property of the handle function</span>
<a href="#l23.2476"></a><span id="l23.2476" class="difflineminus">-		// This is to prevent a memory leak with non-native</span>
<a href="#l23.2477"></a><span id="l23.2477" class="difflineminus">-		// event in IE.</span>
<a href="#l23.2478"></a><span id="l23.2478" class="difflineminus">-		handle.elem = elem;</span>
<a href="#l23.2479"></a><span id="l23.2479" class="difflineminus">-</span>
<a href="#l23.2480"></a><span id="l23.2480" class="difflineminus">-		// Handle multiple events separated by a space</span>
<a href="#l23.2481"></a><span id="l23.2481" class="difflineminus">-		// jQuery(...).bind(&quot;mouseover mouseout&quot;, fn);</span>
<a href="#l23.2482"></a><span id="l23.2482" class="difflineminus">-		jQuery.each(types.split(/\s+/), function(index, type) {</span>
<a href="#l23.2483"></a><span id="l23.2483" class="difflineminus">-			// Namespaced event handlers</span>
<a href="#l23.2484"></a><span id="l23.2484" class="difflineminus">-			var namespaces = type.split(&quot;.&quot;);</span>
<a href="#l23.2485"></a><span id="l23.2485" class="difflineminus">-			type = namespaces.shift();</span>
<a href="#l23.2486"></a><span id="l23.2486" class="difflineminus">-			handler.type = namespaces.slice().sort().join(&quot;.&quot;);</span>
<a href="#l23.2487"></a><span id="l23.2487" class="difflineminus">-</span>
<a href="#l23.2488"></a><span id="l23.2488" class="difflineminus">-			// Get the current list of functions bound to this event</span>
<a href="#l23.2489"></a><span id="l23.2489" class="difflineminus">-			var handlers = events[type];</span>
<a href="#l23.2490"></a><span id="l23.2490" class="difflineminus">-			</span>
<a href="#l23.2491"></a><span id="l23.2491" class="difflineminus">-			if ( jQuery.event.specialAll[type] )</span>
<a href="#l23.2492"></a><span id="l23.2492" class="difflineminus">-				jQuery.event.specialAll[type].setup.call(elem, data, namespaces);</span>
<a href="#l23.2493"></a><span id="l23.2493" class="difflineminus">-</span>
<a href="#l23.2494"></a><span id="l23.2494" class="difflineminus">-			// Init the event handler queue</span>
<a href="#l23.2495"></a><span id="l23.2495" class="difflineminus">-			if (!handlers) {</span>
<a href="#l23.2496"></a><span id="l23.2496" class="difflineminus">-				handlers = events[type] = {};</span>
<a href="#l23.2497"></a><span id="l23.2497" class="difflineminus">-</span>
<a href="#l23.2498"></a><span id="l23.2498" class="difflineminus">-				// Check for a special event handler</span>
<a href="#l23.2499"></a><span id="l23.2499" class="difflineminus">-				// Only use addEventListener/attachEvent if the special</span>
<a href="#l23.2500"></a><span id="l23.2500" class="difflineminus">-				// events handler returns false</span>
<a href="#l23.2501"></a><span id="l23.2501" class="difflineminus">-				if ( !jQuery.event.special[type] || jQuery.event.special[type].setup.call(elem, data, namespaces) === false ) {</span>
<a href="#l23.2502"></a><span id="l23.2502" class="difflineminus">-					// Bind the global event handler to the element</span>
<a href="#l23.2503"></a><span id="l23.2503" class="difflineminus">-					if (elem.addEventListener)</span>
<a href="#l23.2504"></a><span id="l23.2504" class="difflineminus">-						elem.addEventListener(type, handle, false);</span>
<a href="#l23.2505"></a><span id="l23.2505" class="difflineminus">-					else if (elem.attachEvent)</span>
<a href="#l23.2506"></a><span id="l23.2506" class="difflineminus">-						elem.attachEvent(&quot;on&quot; + type, handle);</span>
<a href="#l23.2507"></a><span id="l23.2507" class="difflineminus">-				}</span>
<a href="#l23.2508"></a><span id="l23.2508" class="difflineminus">-			}</span>
<a href="#l23.2509"></a><span id="l23.2509" class="difflineminus">-</span>
<a href="#l23.2510"></a><span id="l23.2510" class="difflineminus">-			// Add the function to the element's handler list</span>
<a href="#l23.2511"></a><span id="l23.2511" class="difflineminus">-			handlers[handler.guid] = handler;</span>
<a href="#l23.2512"></a><span id="l23.2512" class="difflineminus">-</span>
<a href="#l23.2513"></a><span id="l23.2513" class="difflineminus">-			// Keep track of which events have been used, for global triggering</span>
<a href="#l23.2514"></a><span id="l23.2514" class="difflineminus">-			jQuery.event.global[type] = true;</span>
<a href="#l23.2515"></a><span id="l23.2515" class="difflineminus">-		});</span>
<a href="#l23.2516"></a><span id="l23.2516" class="difflineminus">-</span>
<a href="#l23.2517"></a><span id="l23.2517" class="difflineminus">-		// Nullify elem to prevent memory leaks in IE</span>
<a href="#l23.2518"></a><span id="l23.2518" class="difflineminus">-		elem = null;</span>
<a href="#l23.2519"></a><span id="l23.2519" class="difflineminus">-	},</span>
<a href="#l23.2520"></a><span id="l23.2520" class="difflineminus">-</span>
<a href="#l23.2521"></a><span id="l23.2521" class="difflineminus">-	guid: 1,</span>
<a href="#l23.2522"></a><span id="l23.2522" class="difflineminus">-	global: {},</span>
<a href="#l23.2523"></a><span id="l23.2523" class="difflineminus">-</span>
<a href="#l23.2524"></a><span id="l23.2524" class="difflineminus">-	// Detach an event or set of events from an element</span>
<a href="#l23.2525"></a><span id="l23.2525" class="difflineminus">-	remove: function(elem, types, handler) {</span>
<a href="#l23.2526"></a><span id="l23.2526" class="difflineminus">-		// don't do events on text and comment nodes</span>
<a href="#l23.2527"></a><span id="l23.2527" class="difflineminus">-		if ( elem.nodeType == 3 || elem.nodeType == 8 )</span>
<a href="#l23.2528"></a><span id="l23.2528" class="difflineminus">-			return;</span>
<a href="#l23.2529"></a><span id="l23.2529" class="difflineminus">-</span>
<a href="#l23.2530"></a><span id="l23.2530" class="difflineminus">-		var events = jQuery.data(elem, &quot;events&quot;), ret, index;</span>
<a href="#l23.2531"></a><span id="l23.2531" class="difflineminus">-</span>
<a href="#l23.2532"></a><span id="l23.2532" class="difflineminus">-		if ( events ) {</span>
<a href="#l23.2533"></a><span id="l23.2533" class="difflineminus">-			// Unbind all events for the element</span>
<a href="#l23.2534"></a><span id="l23.2534" class="difflineminus">-			if ( types === undefined || (typeof types === &quot;string&quot; &amp;&amp; types.charAt(0) == &quot;.&quot;) )</span>
<a href="#l23.2535"></a><span id="l23.2535" class="difflineminus">-				for ( var type in events )</span>
<a href="#l23.2536"></a><span id="l23.2536" class="difflineminus">-					this.remove( elem, type + (types || &quot;&quot;) );</span>
<a href="#l23.2537"></a><span id="l23.2537" class="difflineminus">-			else {</span>
<a href="#l23.2538"></a><span id="l23.2538" class="difflineminus">-				// types is actually an event object here</span>
<a href="#l23.2539"></a><span id="l23.2539" class="difflineminus">-				if ( types.type ) {</span>
<a href="#l23.2540"></a><span id="l23.2540" class="difflineminus">-					handler = types.handler;</span>
<a href="#l23.2541"></a><span id="l23.2541" class="difflineminus">-					types = types.type;</span>
<a href="#l23.2542"></a><span id="l23.2542" class="difflineminus">-				}</span>
<a href="#l23.2543"></a><span id="l23.2543" class="difflineminus">-</span>
<a href="#l23.2544"></a><span id="l23.2544" class="difflineminus">-				// Handle multiple events seperated by a space</span>
<a href="#l23.2545"></a><span id="l23.2545" class="difflineminus">-				// jQuery(...).unbind(&quot;mouseover mouseout&quot;, fn);</span>
<a href="#l23.2546"></a><span id="l23.2546" class="difflineminus">-				jQuery.each(types.split(/\s+/), function(index, type){</span>
<a href="#l23.2547"></a><span id="l23.2547" class="difflineminus">-					// Namespaced event handlers</span>
<a href="#l23.2548"></a><span id="l23.2548" class="difflineminus">-					var namespaces = type.split(&quot;.&quot;);</span>
<a href="#l23.2549"></a><span id="l23.2549" class="difflineminus">-					type = namespaces.shift();</span>
<a href="#l23.2550"></a><span id="l23.2550" class="difflineminus">-					var namespace = RegExp(&quot;(^|\\.)&quot; + namespaces.slice().sort().join(&quot;.*\\.&quot;) + &quot;(\\.|$)&quot;);</span>
<a href="#l23.2551"></a><span id="l23.2551" class="difflineminus">-</span>
<a href="#l23.2552"></a><span id="l23.2552" class="difflineminus">-					if ( events[type] ) {</span>
<a href="#l23.2553"></a><span id="l23.2553" class="difflineminus">-						// remove the given handler for the given type</span>
<a href="#l23.2554"></a><span id="l23.2554" class="difflineminus">-						if ( handler )</span>
<a href="#l23.2555"></a><span id="l23.2555" class="difflineminus">-							delete events[type][handler.guid];</span>
<a href="#l23.2556"></a><span id="l23.2556" class="difflineminus">-</span>
<a href="#l23.2557"></a><span id="l23.2557" class="difflineminus">-						// remove all handlers for the given type</span>
<a href="#l23.2558"></a><span id="l23.2558" class="difflineminus">-						else</span>
<a href="#l23.2559"></a><span id="l23.2559" class="difflineminus">-							for ( var handle in events[type] )</span>
<a href="#l23.2560"></a><span id="l23.2560" class="difflineminus">-								// Handle the removal of namespaced events</span>
<a href="#l23.2561"></a><span id="l23.2561" class="difflineminus">-								if ( namespace.test(events[type][handle].type) )</span>
<a href="#l23.2562"></a><span id="l23.2562" class="difflineminus">-									delete events[type][handle];</span>
<a href="#l23.2563"></a><span id="l23.2563" class="difflineminus">-									</span>
<a href="#l23.2564"></a><span id="l23.2564" class="difflineminus">-						if ( jQuery.event.specialAll[type] )</span>
<a href="#l23.2565"></a><span id="l23.2565" class="difflineminus">-							jQuery.event.specialAll[type].teardown.call(elem, namespaces);</span>
<a href="#l23.2566"></a><span id="l23.2566" class="difflineminus">-</span>
<a href="#l23.2567"></a><span id="l23.2567" class="difflineminus">-						// remove generic event handler if no more handlers exist</span>
<a href="#l23.2568"></a><span id="l23.2568" class="difflineminus">-						for ( ret in events[type] ) break;</span>
<a href="#l23.2569"></a><span id="l23.2569" class="difflineminus">-						if ( !ret ) {</span>
<a href="#l23.2570"></a><span id="l23.2570" class="difflineminus">-							if ( !jQuery.event.special[type] || jQuery.event.special[type].teardown.call(elem, namespaces) === false ) {</span>
<a href="#l23.2571"></a><span id="l23.2571" class="difflineminus">-								if (elem.removeEventListener)</span>
<a href="#l23.2572"></a><span id="l23.2572" class="difflineminus">-									elem.removeEventListener(type, jQuery.data(elem, &quot;handle&quot;), false);</span>
<a href="#l23.2573"></a><span id="l23.2573" class="difflineminus">-								else if (elem.detachEvent)</span>
<a href="#l23.2574"></a><span id="l23.2574" class="difflineminus">-									elem.detachEvent(&quot;on&quot; + type, jQuery.data(elem, &quot;handle&quot;));</span>
<a href="#l23.2575"></a><span id="l23.2575" class="difflineminus">-							}</span>
<a href="#l23.2576"></a><span id="l23.2576" class="difflineminus">-							ret = null;</span>
<a href="#l23.2577"></a><span id="l23.2577" class="difflineminus">-							delete events[type];</span>
<a href="#l23.2578"></a><span id="l23.2578" class="difflineminus">-						}</span>
<a href="#l23.2579"></a><span id="l23.2579" class="difflineminus">-					}</span>
<a href="#l23.2580"></a><span id="l23.2580" class="difflineminus">-				});</span>
<a href="#l23.2581"></a><span id="l23.2581" class="difflineminus">-			}</span>
<a href="#l23.2582"></a><span id="l23.2582" class="difflineminus">-</span>
<a href="#l23.2583"></a><span id="l23.2583" class="difflineminus">-			// Remove the expando if it's no longer used</span>
<a href="#l23.2584"></a><span id="l23.2584" class="difflineminus">-			for ( ret in events ) break;</span>
<a href="#l23.2585"></a><span id="l23.2585" class="difflineminus">-			if ( !ret ) {</span>
<a href="#l23.2586"></a><span id="l23.2586" class="difflineminus">-				var handle = jQuery.data( elem, &quot;handle&quot; );</span>
<a href="#l23.2587"></a><span id="l23.2587" class="difflineminus">-				if ( handle ) handle.elem = null;</span>
<a href="#l23.2588"></a><span id="l23.2588" class="difflineminus">-				jQuery.removeData( elem, &quot;events&quot; );</span>
<a href="#l23.2589"></a><span id="l23.2589" class="difflineminus">-				jQuery.removeData( elem, &quot;handle&quot; );</span>
<a href="#l23.2590"></a><span id="l23.2590" class="difflineminus">-			}</span>
<a href="#l23.2591"></a><span id="l23.2591" class="difflineminus">-		}</span>
<a href="#l23.2592"></a><span id="l23.2592" class="difflineminus">-	},</span>
<a href="#l23.2593"></a><span id="l23.2593" class="difflineminus">-</span>
<a href="#l23.2594"></a><span id="l23.2594" class="difflineminus">-	// bubbling is internal</span>
<a href="#l23.2595"></a><span id="l23.2595" class="difflineminus">-	trigger: function( event, data, elem, bubbling ) {</span>
<a href="#l23.2596"></a><span id="l23.2596" class="difflineminus">-		// Event object or event type</span>
<a href="#l23.2597"></a><span id="l23.2597" class="difflineminus">-		var type = event.type || event;</span>
<a href="#l23.2598"></a><span id="l23.2598" class="difflineminus">-</span>
<a href="#l23.2599"></a><span id="l23.2599" class="difflineminus">-		if( !bubbling ){</span>
<a href="#l23.2600"></a><span id="l23.2600" class="difflineminus">-			event = typeof event === &quot;object&quot; ?</span>
<a href="#l23.2601"></a><span id="l23.2601" class="difflineminus">-				// jQuery.Event object</span>
<a href="#l23.2602"></a><span id="l23.2602" class="difflineminus">-				event[expando] ? event :</span>
<a href="#l23.2603"></a><span id="l23.2603" class="difflineminus">-				// Object literal</span>
<a href="#l23.2604"></a><span id="l23.2604" class="difflineminus">-				jQuery.extend( jQuery.Event(type), event ) :</span>
<a href="#l23.2605"></a><span id="l23.2605" class="difflineminus">-				// Just the event type (string)</span>
<a href="#l23.2606"></a><span id="l23.2606" class="difflineminus">-				jQuery.Event(type);</span>
<a href="#l23.2607"></a><span id="l23.2607" class="difflineminus">-</span>
<a href="#l23.2608"></a><span id="l23.2608" class="difflineminus">-			if ( type.indexOf(&quot;!&quot;) &gt;= 0 ) {</span>
<a href="#l23.2609"></a><span id="l23.2609" class="difflineminus">-				event.type = type = type.slice(0, -1);</span>
<a href="#l23.2610"></a><span id="l23.2610" class="difflineminus">-				event.exclusive = true;</span>
<a href="#l23.2611"></a><span id="l23.2611" class="difflineminus">-			}</span>
<a href="#l23.2612"></a><span id="l23.2612" class="difflineminus">-</span>
<a href="#l23.2613"></a><span id="l23.2613" class="difflineminus">-			// Handle a global trigger</span>
<a href="#l23.2614"></a><span id="l23.2614" class="difflineminus">-			if ( !elem ) {</span>
<a href="#l23.2615"></a><span id="l23.2615" class="difflineminus">-				// Don't bubble custom events when global (to avoid too much overhead)</span>
<a href="#l23.2616"></a><span id="l23.2616" class="difflineminus">-				event.stopPropagation();</span>
<a href="#l23.2617"></a><span id="l23.2617" class="difflineminus">-				// Only trigger if we've ever bound an event for it</span>
<a href="#l23.2618"></a><span id="l23.2618" class="difflineminus">-				if ( this.global[type] )</span>
<a href="#l23.2619"></a><span id="l23.2619" class="difflineminus">-					jQuery.each( jQuery.cache, function(){</span>
<a href="#l23.2620"></a><span id="l23.2620" class="difflineminus">-						if ( this.events &amp;&amp; this.events[type] )</span>
<a href="#l23.2621"></a><span id="l23.2621" class="difflineminus">-							jQuery.event.trigger( event, data, this.handle.elem );</span>
<a href="#l23.2622"></a><span id="l23.2622" class="difflineminus">-					});</span>
<a href="#l23.2623"></a><span id="l23.2623" class="difflineminus">-			}</span>
<a href="#l23.2624"></a><span id="l23.2624" class="difflineminus">-</span>
<a href="#l23.2625"></a><span id="l23.2625" class="difflineminus">-			// Handle triggering a single element</span>
<a href="#l23.2626"></a><span id="l23.2626" class="difflineminus">-</span>
<a href="#l23.2627"></a><span id="l23.2627" class="difflineminus">-			// don't do events on text and comment nodes</span>
<a href="#l23.2628"></a><span id="l23.2628" class="difflineminus">-			if ( !elem || elem.nodeType == 3 || elem.nodeType == 8 )</span>
<a href="#l23.2629"></a><span id="l23.2629" class="difflineminus">-				return undefined;</span>
<a href="#l23.2630"></a><span id="l23.2630" class="difflineminus">-			</span>
<a href="#l23.2631"></a><span id="l23.2631" class="difflineminus">-			// Clean up in case it is reused</span>
<a href="#l23.2632"></a><span id="l23.2632" class="difflineminus">-			event.result = undefined;</span>
<a href="#l23.2633"></a><span id="l23.2633" class="difflineminus">-			event.target = elem;</span>
<a href="#l23.2634"></a><span id="l23.2634" class="difflineminus">-			</span>
<a href="#l23.2635"></a><span id="l23.2635" class="difflineminus">-			// Clone the incoming data, if any</span>
<a href="#l23.2636"></a><span id="l23.2636" class="difflineminus">-			data = jQuery.makeArray(data);</span>
<a href="#l23.2637"></a><span id="l23.2637" class="difflineminus">-			data.unshift( event );</span>
<a href="#l23.2638"></a><span id="l23.2638" class="difflineminus">-		}</span>
<a href="#l23.2639"></a><span id="l23.2639" class="difflineminus">-</span>
<a href="#l23.2640"></a><span id="l23.2640" class="difflineminus">-		event.currentTarget = elem;</span>
<a href="#l23.2641"></a><span id="l23.2641" class="difflineminus">-</span>
<a href="#l23.2642"></a><span id="l23.2642" class="difflineminus">-		// Trigger the event, it is assumed that &quot;handle&quot; is a function</span>
<a href="#l23.2643"></a><span id="l23.2643" class="difflineminus">-		var handle = jQuery.data(elem, &quot;handle&quot;);</span>
<a href="#l23.2644"></a><span id="l23.2644" class="difflineminus">-		if ( handle )</span>
<a href="#l23.2645"></a><span id="l23.2645" class="difflineminus">-			handle.apply( elem, data );</span>
<a href="#l23.2646"></a><span id="l23.2646" class="difflineminus">-</span>
<a href="#l23.2647"></a><span id="l23.2647" class="difflineminus">-		// Handle triggering native .onfoo handlers (and on links since we don't call .click() for links)</span>
<a href="#l23.2648"></a><span id="l23.2648" class="difflineminus">-		if ( (!elem[type] || (jQuery.nodeName(elem, 'a') &amp;&amp; type == &quot;click&quot;)) &amp;&amp; elem[&quot;on&quot;+type] &amp;&amp; elem[&quot;on&quot;+type].apply( elem, data ) === false )</span>
<a href="#l23.2649"></a><span id="l23.2649" class="difflineminus">-			event.result = false;</span>
<a href="#l23.2650"></a><span id="l23.2650" class="difflineminus">-</span>
<a href="#l23.2651"></a><span id="l23.2651" class="difflineminus">-		// Trigger the native events (except for clicks on links)</span>
<a href="#l23.2652"></a><span id="l23.2652" class="difflineminus">-		if ( !bubbling &amp;&amp; elem[type] &amp;&amp; !event.isDefaultPrevented() &amp;&amp; !(jQuery.nodeName(elem, 'a') &amp;&amp; type == &quot;click&quot;) ) {</span>
<a href="#l23.2653"></a><span id="l23.2653" class="difflineminus">-			this.triggered = true;</span>
<a href="#l23.2654"></a><span id="l23.2654" class="difflineminus">-			try {</span>
<a href="#l23.2655"></a><span id="l23.2655" class="difflineminus">-				elem[ type ]();</span>
<a href="#l23.2656"></a><span id="l23.2656" class="difflineminus">-			// prevent IE from throwing an error for some hidden elements</span>
<a href="#l23.2657"></a><span id="l23.2657" class="difflineminus">-			} catch (e) {}</span>
<a href="#l23.2658"></a><span id="l23.2658" class="difflineminus">-		}</span>
<a href="#l23.2659"></a><span id="l23.2659" class="difflineminus">-</span>
<a href="#l23.2660"></a><span id="l23.2660" class="difflineminus">-		this.triggered = false;</span>
<a href="#l23.2661"></a><span id="l23.2661" class="difflineminus">-</span>
<a href="#l23.2662"></a><span id="l23.2662" class="difflineminus">-		if ( !event.isPropagationStopped() ) {</span>
<a href="#l23.2663"></a><span id="l23.2663" class="difflineminus">-			var parent = elem.parentNode || elem.ownerDocument;</span>
<a href="#l23.2664"></a><span id="l23.2664" class="difflineminus">-			if ( parent )</span>
<a href="#l23.2665"></a><span id="l23.2665" class="difflineminus">-				jQuery.event.trigger(event, data, parent, true);</span>
<a href="#l23.2666"></a><span id="l23.2666" class="difflineminus">-		}</span>
<a href="#l23.2667"></a><span id="l23.2667" class="difflineminus">-	},</span>
<a href="#l23.2668"></a><span id="l23.2668" class="difflineminus">-</span>
<a href="#l23.2669"></a><span id="l23.2669" class="difflineminus">-	handle: function(event) {</span>
<a href="#l23.2670"></a><span id="l23.2670" class="difflineminus">-		// returned undefined or false</span>
<a href="#l23.2671"></a><span id="l23.2671" class="difflineminus">-		var all, handlers;</span>
<a href="#l23.2672"></a><span id="l23.2672" class="difflineminus">-</span>
<a href="#l23.2673"></a><span id="l23.2673" class="difflineminus">-		event = arguments[0] = jQuery.event.fix( event || window.event );</span>
<a href="#l23.2674"></a><span id="l23.2674" class="difflineminus">-		event.currentTarget = this;</span>
<a href="#l23.2675"></a><span id="l23.2675" class="difflineminus">-		</span>
<a href="#l23.2676"></a><span id="l23.2676" class="difflineminus">-		// Namespaced event handlers</span>
<a href="#l23.2677"></a><span id="l23.2677" class="difflineminus">-		var namespaces = event.type.split(&quot;.&quot;);</span>
<a href="#l23.2678"></a><span id="l23.2678" class="difflineminus">-		event.type = namespaces.shift();</span>
<a href="#l23.2679"></a><span id="l23.2679" class="difflineminus">-</span>
<a href="#l23.2680"></a><span id="l23.2680" class="difflineminus">-		// Cache this now, all = true means, any handler</span>
<a href="#l23.2681"></a><span id="l23.2681" class="difflineminus">-		all = !namespaces.length &amp;&amp; !event.exclusive;</span>
<a href="#l23.2682"></a><span id="l23.2682" class="difflineminus">-		</span>
<a href="#l23.2683"></a><span id="l23.2683" class="difflineminus">-		var namespace = RegExp(&quot;(^|\\.)&quot; + namespaces.slice().sort().join(&quot;.*\\.&quot;) + &quot;(\\.|$)&quot;);</span>
<a href="#l23.2684"></a><span id="l23.2684" class="difflineminus">-</span>
<a href="#l23.2685"></a><span id="l23.2685" class="difflineminus">-		handlers = ( jQuery.data(this, &quot;events&quot;) || {} )[event.type];</span>
<a href="#l23.2686"></a><span id="l23.2686" class="difflineminus">-</span>
<a href="#l23.2687"></a><span id="l23.2687" class="difflineminus">-		for ( var j in handlers ) {</span>
<a href="#l23.2688"></a><span id="l23.2688" class="difflineminus">-			var handler = handlers[j];</span>
<a href="#l23.2689"></a><span id="l23.2689" class="difflineminus">-</span>
<a href="#l23.2690"></a><span id="l23.2690" class="difflineminus">-			// Filter the functions by class</span>
<a href="#l23.2691"></a><span id="l23.2691" class="difflineminus">-			if ( all || namespace.test(handler.type) ) {</span>
<a href="#l23.2692"></a><span id="l23.2692" class="difflineminus">-				// Pass in a reference to the handler function itself</span>
<a href="#l23.2693"></a><span id="l23.2693" class="difflineminus">-				// So that we can later remove it</span>
<a href="#l23.2694"></a><span id="l23.2694" class="difflineminus">-				event.handler = handler;</span>
<a href="#l23.2695"></a><span id="l23.2695" class="difflineminus">-				event.data = handler.data;</span>
<a href="#l23.2696"></a><span id="l23.2696" class="difflineminus">-</span>
<a href="#l23.2697"></a><span id="l23.2697" class="difflineminus">-				var ret = handler.apply(this, arguments);</span>
<a href="#l23.2698"></a><span id="l23.2698" class="difflineminus">-</span>
<a href="#l23.2699"></a><span id="l23.2699" class="difflineminus">-				if( ret !== undefined ){</span>
<a href="#l23.2700"></a><span id="l23.2700" class="difflineminus">-					event.result = ret;</span>
<a href="#l23.2701"></a><span id="l23.2701" class="difflineminus">-					if ( ret === false ) {</span>
<a href="#l23.2702"></a><span id="l23.2702" class="difflineminus">-						event.preventDefault();</span>
<a href="#l23.2703"></a><span id="l23.2703" class="difflineminus">-						event.stopPropagation();</span>
<a href="#l23.2704"></a><span id="l23.2704" class="difflineminus">-					}</span>
<a href="#l23.2705"></a><span id="l23.2705" class="difflineminus">-				}</span>
<a href="#l23.2706"></a><span id="l23.2706" class="difflineminus">-</span>
<a href="#l23.2707"></a><span id="l23.2707" class="difflineminus">-				if( event.isImmediatePropagationStopped() )</span>
<a href="#l23.2708"></a><span id="l23.2708" class="difflineminus">-					break;</span>
<a href="#l23.2709"></a><span id="l23.2709" class="difflineminus">-</span>
<a href="#l23.2710"></a><span id="l23.2710" class="difflineminus">-			}</span>
<a href="#l23.2711"></a><span id="l23.2711" class="difflineminus">-		}</span>
<a href="#l23.2712"></a><span id="l23.2712" class="difflineminus">-	},</span>
<a href="#l23.2713"></a><span id="l23.2713" class="difflineminus">-</span>
<a href="#l23.2714"></a><span id="l23.2714" class="difflineminus">-	props: &quot;altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which&quot;.split(&quot; &quot;),</span>
<a href="#l23.2715"></a><span id="l23.2715" class="difflineminus">-</span>
<a href="#l23.2716"></a><span id="l23.2716" class="difflineminus">-	fix: function(event) {</span>
<a href="#l23.2717"></a><span id="l23.2717" class="difflineminus">-		if ( event[expando] )</span>
<a href="#l23.2718"></a><span id="l23.2718" class="difflineminus">-			return event;</span>
<a href="#l23.2719"></a><span id="l23.2719" class="difflineminus">-</span>
<a href="#l23.2720"></a><span id="l23.2720" class="difflineminus">-		// store a copy of the original event object</span>
<a href="#l23.2721"></a><span id="l23.2721" class="difflineminus">-		// and &quot;clone&quot; to set read-only properties</span>
<a href="#l23.2722"></a><span id="l23.2722" class="difflineminus">-		var originalEvent = event;</span>
<a href="#l23.2723"></a><span id="l23.2723" class="difflineminus">-		event = jQuery.Event( originalEvent );</span>
<a href="#l23.2724"></a><span id="l23.2724" class="difflineminus">-</span>
<a href="#l23.2725"></a><span id="l23.2725" class="difflineminus">-		for ( var i = this.props.length, prop; i; ){</span>
<a href="#l23.2726"></a><span id="l23.2726" class="difflineminus">-			prop = this.props[ --i ];</span>
<a href="#l23.2727"></a><span id="l23.2727" class="difflineminus">-			event[ prop ] = originalEvent[ prop ];</span>
<a href="#l23.2728"></a><span id="l23.2728" class="difflineminus">-		}</span>
<a href="#l23.2729"></a><span id="l23.2729" class="difflineminus">-</span>
<a href="#l23.2730"></a><span id="l23.2730" class="difflineminus">-		// Fix target property, if necessary</span>
<a href="#l23.2731"></a><span id="l23.2731" class="difflineminus">-		if ( !event.target )</span>
<a href="#l23.2732"></a><span id="l23.2732" class="difflineminus">-			event.target = event.srcElement || document; // Fixes #1925 where srcElement might not be defined either</span>
<a href="#l23.2733"></a><span id="l23.2733" class="difflineminus">-</span>
<a href="#l23.2734"></a><span id="l23.2734" class="difflineminus">-		// check if target is a textnode (safari)</span>
<a href="#l23.2735"></a><span id="l23.2735" class="difflineminus">-		if ( event.target.nodeType == 3 )</span>
<a href="#l23.2736"></a><span id="l23.2736" class="difflineminus">-			event.target = event.target.parentNode;</span>
<a href="#l23.2737"></a><span id="l23.2737" class="difflineminus">-</span>
<a href="#l23.2738"></a><span id="l23.2738" class="difflineminus">-		// Add relatedTarget, if necessary</span>
<a href="#l23.2739"></a><span id="l23.2739" class="difflineminus">-		if ( !event.relatedTarget &amp;&amp; event.fromElement )</span>
<a href="#l23.2740"></a><span id="l23.2740" class="difflineminus">-			event.relatedTarget = event.fromElement == event.target ? event.toElement : event.fromElement;</span>
<a href="#l23.2741"></a><span id="l23.2741" class="difflineminus">-</span>
<a href="#l23.2742"></a><span id="l23.2742" class="difflineminus">-		// Calculate pageX/Y if missing and clientX/Y available</span>
<a href="#l23.2743"></a><span id="l23.2743" class="difflineminus">-		if ( event.pageX == null &amp;&amp; event.clientX != null ) {</span>
<a href="#l23.2744"></a><span id="l23.2744" class="difflineminus">-			var doc = document.documentElement, body = document.body;</span>
<a href="#l23.2745"></a><span id="l23.2745" class="difflineminus">-			event.pageX = event.clientX + (doc &amp;&amp; doc.scrollLeft || body &amp;&amp; body.scrollLeft || 0) - (doc.clientLeft || 0);</span>
<a href="#l23.2746"></a><span id="l23.2746" class="difflineminus">-			event.pageY = event.clientY + (doc &amp;&amp; doc.scrollTop || body &amp;&amp; body.scrollTop || 0) - (doc.clientTop || 0);</span>
<a href="#l23.2747"></a><span id="l23.2747" class="difflineminus">-		}</span>
<a href="#l23.2748"></a><span id="l23.2748" class="difflineminus">-</span>
<a href="#l23.2749"></a><span id="l23.2749" class="difflineminus">-		// Add which for key events</span>
<a href="#l23.2750"></a><span id="l23.2750" class="difflineminus">-		if ( !event.which &amp;&amp; ((event.charCode || event.charCode === 0) ? event.charCode : event.keyCode) )</span>
<a href="#l23.2751"></a><span id="l23.2751" class="difflineminus">-			event.which = event.charCode || event.keyCode;</span>
<a href="#l23.2752"></a><span id="l23.2752" class="difflineminus">-</span>
<a href="#l23.2753"></a><span id="l23.2753" class="difflineminus">-		// Add metaKey to non-Mac browsers (use ctrl for PC's and Meta for Macs)</span>
<a href="#l23.2754"></a><span id="l23.2754" class="difflineminus">-		if ( !event.metaKey &amp;&amp; event.ctrlKey )</span>
<a href="#l23.2755"></a><span id="l23.2755" class="difflineminus">-			event.metaKey = event.ctrlKey;</span>
<a href="#l23.2756"></a><span id="l23.2756" class="difflineminus">-</span>
<a href="#l23.2757"></a><span id="l23.2757" class="difflineminus">-		// Add which for click: 1 == left; 2 == middle; 3 == right</span>
<a href="#l23.2758"></a><span id="l23.2758" class="difflineminus">-		// Note: button is not normalized, so don't use it</span>
<a href="#l23.2759"></a><span id="l23.2759" class="difflineminus">-		if ( !event.which &amp;&amp; event.button )</span>
<a href="#l23.2760"></a><span id="l23.2760" class="difflineminus">-			event.which = (event.button &amp; 1 ? 1 : ( event.button &amp; 2 ? 3 : ( event.button &amp; 4 ? 2 : 0 ) ));</span>
<a href="#l23.2761"></a><span id="l23.2761" class="difflineminus">-</span>
<a href="#l23.2762"></a><span id="l23.2762" class="difflineminus">-		return event;</span>
<a href="#l23.2763"></a><span id="l23.2763" class="difflineminus">-	},</span>
<a href="#l23.2764"></a><span id="l23.2764" class="difflineminus">-</span>
<a href="#l23.2765"></a><span id="l23.2765" class="difflineminus">-	proxy: function( fn, proxy ){</span>
<a href="#l23.2766"></a><span id="l23.2766" class="difflineminus">-		proxy = proxy || function(){ return fn.apply(this, arguments); };</span>
<a href="#l23.2767"></a><span id="l23.2767" class="difflineminus">-		// Set the guid of unique handler to the same of original handler, so it can be removed</span>
<a href="#l23.2768"></a><span id="l23.2768" class="difflineminus">-		proxy.guid = fn.guid = fn.guid || proxy.guid || this.guid++;</span>
<a href="#l23.2769"></a><span id="l23.2769" class="difflineminus">-		// So proxy can be declared as an argument</span>
<a href="#l23.2770"></a><span id="l23.2770" class="difflineminus">-		return proxy;</span>
<a href="#l23.2771"></a><span id="l23.2771" class="difflineminus">-	},</span>
<a href="#l23.2772"></a><span id="l23.2772" class="difflineminus">-</span>
<a href="#l23.2773"></a><span id="l23.2773" class="difflineminus">-	special: {</span>
<a href="#l23.2774"></a><span id="l23.2774" class="difflineminus">-		ready: {</span>
<a href="#l23.2775"></a><span id="l23.2775" class="difflineminus">-			// Make sure the ready event is setup</span>
<a href="#l23.2776"></a><span id="l23.2776" class="difflineminus">-			setup: bindReady,</span>
<a href="#l23.2777"></a><span id="l23.2777" class="difflineminus">-			teardown: function() {}</span>
<a href="#l23.2778"></a><span id="l23.2778" class="difflineminus">-		}</span>
<a href="#l23.2779"></a><span id="l23.2779" class="difflineminus">-	},</span>
<a href="#l23.2780"></a><span id="l23.2780" class="difflineminus">-	</span>
<a href="#l23.2781"></a><span id="l23.2781" class="difflineminus">-	specialAll: {</span>
<a href="#l23.2782"></a><span id="l23.2782" class="difflineminus">-		live: {</span>
<a href="#l23.2783"></a><span id="l23.2783" class="difflineminus">-			setup: function( selector, namespaces ){</span>
<a href="#l23.2784"></a><span id="l23.2784" class="difflineminus">-				jQuery.event.add( this, namespaces[0], liveHandler );</span>
<a href="#l23.2785"></a><span id="l23.2785" class="difflineminus">-			},</span>
<a href="#l23.2786"></a><span id="l23.2786" class="difflineminus">-			teardown:  function( namespaces ){</span>
<a href="#l23.2787"></a><span id="l23.2787" class="difflineminus">-				if ( namespaces.length ) {</span>
<a href="#l23.2788"></a><span id="l23.2788" class="difflineminus">-					var remove = 0, name = RegExp(&quot;(^|\\.)&quot; + namespaces[0] + &quot;(\\.|$)&quot;);</span>
<a href="#l23.2789"></a><span id="l23.2789" class="difflineminus">-					</span>
<a href="#l23.2790"></a><span id="l23.2790" class="difflineminus">-					jQuery.each( (jQuery.data(this, &quot;events&quot;).live || {}), function(){</span>
<a href="#l23.2791"></a><span id="l23.2791" class="difflineminus">-						if ( name.test(this.type) )</span>
<a href="#l23.2792"></a><span id="l23.2792" class="difflineminus">-							remove++;</span>
<a href="#l23.2793"></a><span id="l23.2793" class="difflineminus">-					});</span>
<a href="#l23.2794"></a><span id="l23.2794" class="difflineminus">-					</span>
<a href="#l23.2795"></a><span id="l23.2795" class="difflineminus">-					if ( remove &lt; 1 )</span>
<a href="#l23.2796"></a><span id="l23.2796" class="difflineminus">-						jQuery.event.remove( this, namespaces[0], liveHandler );</span>
<a href="#l23.2797"></a><span id="l23.2797" class="difflineminus">-				}</span>
<a href="#l23.2798"></a><span id="l23.2798" class="difflineminus">-			}</span>
<a href="#l23.2799"></a><span id="l23.2799" class="difflineminus">-		}</span>
<a href="#l23.2800"></a><span id="l23.2800" class="difflineminus">-	}</span>
<a href="#l23.2801"></a><span id="l23.2801" class="difflineminus">-};</span>
<a href="#l23.2802"></a><span id="l23.2802" class="difflineminus">-</span>
<a href="#l23.2803"></a><span id="l23.2803" class="difflineminus">-jQuery.Event = function( src ){</span>
<a href="#l23.2804"></a><span id="l23.2804" class="difflineminus">-	// Allow instantiation without the 'new' keyword</span>
<a href="#l23.2805"></a><span id="l23.2805" class="difflineminus">-	if( !this.preventDefault )</span>
<a href="#l23.2806"></a><span id="l23.2806" class="difflineminus">-		return new jQuery.Event(src);</span>
<a href="#l23.2807"></a><span id="l23.2807" class="difflineminus">-	</span>
<a href="#l23.2808"></a><span id="l23.2808" class="difflineminus">-	// Event object</span>
<a href="#l23.2809"></a><span id="l23.2809" class="difflineminus">-	if( src &amp;&amp; src.type ){</span>
<a href="#l23.2810"></a><span id="l23.2810" class="difflineminus">-		this.originalEvent = src;</span>
<a href="#l23.2811"></a><span id="l23.2811" class="difflineminus">-		this.type = src.type;</span>
<a href="#l23.2812"></a><span id="l23.2812" class="difflineminus">-	// Event type</span>
<a href="#l23.2813"></a><span id="l23.2813" class="difflineminus">-	}else</span>
<a href="#l23.2814"></a><span id="l23.2814" class="difflineminus">-		this.type = src;</span>
<a href="#l23.2815"></a><span id="l23.2815" class="difflineminus">-</span>
<a href="#l23.2816"></a><span id="l23.2816" class="difflineminus">-	// timeStamp is buggy for some events on Firefox(#3843)</span>
<a href="#l23.2817"></a><span id="l23.2817" class="difflineminus">-	// So we won't rely on the native value</span>
<a href="#l23.2818"></a><span id="l23.2818" class="difflineminus">-	this.timeStamp = now();</span>
<a href="#l23.2819"></a><span id="l23.2819" class="difflineminus">-	</span>
<a href="#l23.2820"></a><span id="l23.2820" class="difflineminus">-	// Mark it as fixed</span>
<a href="#l23.2821"></a><span id="l23.2821" class="difflineminus">-	this[expando] = true;</span>
<a href="#l23.2822"></a><span id="l23.2822" class="difflineminus">-};</span>
<a href="#l23.2823"></a><span id="l23.2823" class="difflineminus">-</span>
<a href="#l23.2824"></a><span id="l23.2824" class="difflineminus">-function returnFalse(){</span>
<a href="#l23.2825"></a><span id="l23.2825" class="difflineminus">-	return false;</span>
<a href="#l23.2826"></a><span id="l23.2826" class="difflineminus">-}</span>
<a href="#l23.2827"></a><span id="l23.2827" class="difflineminus">-function returnTrue(){</span>
<a href="#l23.2828"></a><span id="l23.2828" class="difflineminus">-	return true;</span>
<a href="#l23.2829"></a><span id="l23.2829" class="difflineminus">-}</span>
<a href="#l23.2830"></a><span id="l23.2830" class="difflineminus">-</span>
<a href="#l23.2831"></a><span id="l23.2831" class="difflineminus">-// jQuery.Event is based on DOM3 Events as specified by the ECMAScript Language Binding</span>
<a href="#l23.2832"></a><span id="l23.2832" class="difflineminus">-// http://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html</span>
<a href="#l23.2833"></a><span id="l23.2833" class="difflineminus">-jQuery.Event.prototype = {</span>
<a href="#l23.2834"></a><span id="l23.2834" class="difflineminus">-	preventDefault: function() {</span>
<a href="#l23.2835"></a><span id="l23.2835" class="difflineminus">-		this.isDefaultPrevented = returnTrue;</span>
<a href="#l23.2836"></a><span id="l23.2836" class="difflineminus">-</span>
<a href="#l23.2837"></a><span id="l23.2837" class="difflineminus">-		var e = this.originalEvent;</span>
<a href="#l23.2838"></a><span id="l23.2838" class="difflineminus">-		if( !e )</span>
<a href="#l23.2839"></a><span id="l23.2839" class="difflineminus">-			return;</span>
<a href="#l23.2840"></a><span id="l23.2840" class="difflineminus">-		// if preventDefault exists run it on the original event</span>
<a href="#l23.2841"></a><span id="l23.2841" class="difflineminus">-		if (e.preventDefault)</span>
<a href="#l23.2842"></a><span id="l23.2842" class="difflineminus">-			e.preventDefault();</span>
<a href="#l23.2843"></a><span id="l23.2843" class="difflineminus">-		// otherwise set the returnValue property of the original event to false (IE)</span>
<a href="#l23.2844"></a><span id="l23.2844" class="difflineminus">-		e.returnValue = false;</span>
<a href="#l23.2845"></a><span id="l23.2845" class="difflineminus">-	},</span>
<a href="#l23.2846"></a><span id="l23.2846" class="difflineminus">-	stopPropagation: function() {</span>
<a href="#l23.2847"></a><span id="l23.2847" class="difflineminus">-		this.isPropagationStopped = returnTrue;</span>
<a href="#l23.2848"></a><span id="l23.2848" class="difflineminus">-</span>
<a href="#l23.2849"></a><span id="l23.2849" class="difflineminus">-		var e = this.originalEvent;</span>
<a href="#l23.2850"></a><span id="l23.2850" class="difflineminus">-		if( !e )</span>
<a href="#l23.2851"></a><span id="l23.2851" class="difflineminus">-			return;</span>
<a href="#l23.2852"></a><span id="l23.2852" class="difflineminus">-		// if stopPropagation exists run it on the original event</span>
<a href="#l23.2853"></a><span id="l23.2853" class="difflineminus">-		if (e.stopPropagation)</span>
<a href="#l23.2854"></a><span id="l23.2854" class="difflineminus">-			e.stopPropagation();</span>
<a href="#l23.2855"></a><span id="l23.2855" class="difflineminus">-		// otherwise set the cancelBubble property of the original event to true (IE)</span>
<a href="#l23.2856"></a><span id="l23.2856" class="difflineminus">-		e.cancelBubble = true;</span>
<a href="#l23.2857"></a><span id="l23.2857" class="difflineminus">-	},</span>
<a href="#l23.2858"></a><span id="l23.2858" class="difflineminus">-	stopImmediatePropagation:function(){</span>
<a href="#l23.2859"></a><span id="l23.2859" class="difflineminus">-		this.isImmediatePropagationStopped = returnTrue;</span>
<a href="#l23.2860"></a><span id="l23.2860" class="difflineminus">-		this.stopPropagation();</span>
<a href="#l23.2861"></a><span id="l23.2861" class="difflineminus">-	},</span>
<a href="#l23.2862"></a><span id="l23.2862" class="difflineminus">-	isDefaultPrevented: returnFalse,</span>
<a href="#l23.2863"></a><span id="l23.2863" class="difflineminus">-	isPropagationStopped: returnFalse,</span>
<a href="#l23.2864"></a><span id="l23.2864" class="difflineminus">-	isImmediatePropagationStopped: returnFalse</span>
<a href="#l23.2865"></a><span id="l23.2865" class="difflineminus">-};</span>
<a href="#l23.2866"></a><span id="l23.2866" class="difflineminus">-// Checks if an event happened on an element within another element</span>
<a href="#l23.2867"></a><span id="l23.2867" class="difflineminus">-// Used in jQuery.event.special.mouseenter and mouseleave handlers</span>
<a href="#l23.2868"></a><span id="l23.2868" class="difflineminus">-var withinElement = function(event) {</span>
<a href="#l23.2869"></a><span id="l23.2869" class="difflineminus">-	// Check if mouse(over|out) are still within the same parent element</span>
<a href="#l23.2870"></a><span id="l23.2870" class="difflineminus">-	var parent = event.relatedTarget;</span>
<a href="#l23.2871"></a><span id="l23.2871" class="difflineminus">-	// Traverse up the tree</span>
<a href="#l23.2872"></a><span id="l23.2872" class="difflineminus">-	while ( parent &amp;&amp; parent != this )</span>
<a href="#l23.2873"></a><span id="l23.2873" class="difflineminus">-		try { parent = parent.parentNode; }</span>
<a href="#l23.2874"></a><span id="l23.2874" class="difflineminus">-		catch(e) { parent = this; }</span>
<a href="#l23.2875"></a><span id="l23.2875" class="difflineminus">-	</span>
<a href="#l23.2876"></a><span id="l23.2876" class="difflineminus">-	if( parent != this ){</span>
<a href="#l23.2877"></a><span id="l23.2877" class="difflineminus">-		// set the correct event type</span>
<a href="#l23.2878"></a><span id="l23.2878" class="difflineminus">-		event.type = event.data;</span>
<a href="#l23.2879"></a><span id="l23.2879" class="difflineminus">-		// handle event if we actually just moused on to a non sub-element</span>
<a href="#l23.2880"></a><span id="l23.2880" class="difflineminus">-		jQuery.event.handle.apply( this, arguments );</span>
<a href="#l23.2881"></a><span id="l23.2881" class="difflineminus">-	}</span>
<a href="#l23.2882"></a><span id="l23.2882" class="difflineminus">-};</span>
<a href="#l23.2883"></a><span id="l23.2883" class="difflineminus">-	</span>
<a href="#l23.2884"></a><span id="l23.2884" class="difflineminus">-jQuery.each({ </span>
<a href="#l23.2885"></a><span id="l23.2885" class="difflineminus">-	mouseover: 'mouseenter', </span>
<a href="#l23.2886"></a><span id="l23.2886" class="difflineminus">-	mouseout: 'mouseleave'</span>
<a href="#l23.2887"></a><span id="l23.2887" class="difflineminus">-}, function( orig, fix ){</span>
<a href="#l23.2888"></a><span id="l23.2888" class="difflineminus">-	jQuery.event.special[ fix ] = {</span>
<a href="#l23.2889"></a><span id="l23.2889" class="difflineminus">-		setup: function(){</span>
<a href="#l23.2890"></a><span id="l23.2890" class="difflineminus">-			jQuery.event.add( this, orig, withinElement, fix );</span>
<a href="#l23.2891"></a><span id="l23.2891" class="difflineminus">-		},</span>
<a href="#l23.2892"></a><span id="l23.2892" class="difflineminus">-		teardown: function(){</span>
<a href="#l23.2893"></a><span id="l23.2893" class="difflineminus">-			jQuery.event.remove( this, orig, withinElement );</span>
<a href="#l23.2894"></a><span id="l23.2894" class="difflineminus">-		}</span>
<a href="#l23.2895"></a><span id="l23.2895" class="difflineminus">-	};			   </span>
<a href="#l23.2896"></a><span id="l23.2896" class="difflineminus">-});</span>
<a href="#l23.2897"></a><span id="l23.2897" class="difflineminus">-</span>
<a href="#l23.2898"></a><span id="l23.2898" class="difflineminus">-jQuery.fn.extend({</span>
<a href="#l23.2899"></a><span id="l23.2899" class="difflineminus">-	bind: function( type, data, fn ) {</span>
<a href="#l23.2900"></a><span id="l23.2900" class="difflineminus">-		return type == &quot;unload&quot; ? this.one(type, data, fn) : this.each(function(){</span>
<a href="#l23.2901"></a><span id="l23.2901" class="difflineminus">-			jQuery.event.add( this, type, fn || data, fn &amp;&amp; data );</span>
<a href="#l23.2902"></a><span id="l23.2902" class="difflineminus">-		});</span>
<a href="#l23.2903"></a><span id="l23.2903" class="difflineminus">-	},</span>
<a href="#l23.2904"></a><span id="l23.2904" class="difflineminus">-</span>
<a href="#l23.2905"></a><span id="l23.2905" class="difflineminus">-	one: function( type, data, fn ) {</span>
<a href="#l23.2906"></a><span id="l23.2906" class="difflineminus">-		var one = jQuery.event.proxy( fn || data, function(event) {</span>
<a href="#l23.2907"></a><span id="l23.2907" class="difflineminus">-			jQuery(this).unbind(event, one);</span>
<a href="#l23.2908"></a><span id="l23.2908" class="difflineminus">-			return (fn || data).apply( this, arguments );</span>
<a href="#l23.2909"></a><span id="l23.2909" class="difflineminus">-		});</span>
<a href="#l23.2910"></a><span id="l23.2910" class="difflineminus">-		return this.each(function(){</span>
<a href="#l23.2911"></a><span id="l23.2911" class="difflineminus">-			jQuery.event.add( this, type, one, fn &amp;&amp; data);</span>
<a href="#l23.2912"></a><span id="l23.2912" class="difflineminus">-		});</span>
<a href="#l23.2913"></a><span id="l23.2913" class="difflineminus">-	},</span>
<a href="#l23.2914"></a><span id="l23.2914" class="difflineminus">-</span>
<a href="#l23.2915"></a><span id="l23.2915" class="difflineminus">-	unbind: function( type, fn ) {</span>
<a href="#l23.2916"></a><span id="l23.2916" class="difflineminus">-		return this.each(function(){</span>
<a href="#l23.2917"></a><span id="l23.2917" class="difflineminus">-			jQuery.event.remove( this, type, fn );</span>
<a href="#l23.2918"></a><span id="l23.2918" class="difflineminus">-		});</span>
<a href="#l23.2919"></a><span id="l23.2919" class="difflineminus">-	},</span>
<a href="#l23.2920"></a><span id="l23.2920" class="difflineminus">-</span>
<a href="#l23.2921"></a><span id="l23.2921" class="difflineminus">-	trigger: function( type, data ) {</span>
<a href="#l23.2922"></a><span id="l23.2922" class="difflineminus">-		return this.each(function(){</span>
<a href="#l23.2923"></a><span id="l23.2923" class="difflineminus">-			jQuery.event.trigger( type, data, this );</span>
<a href="#l23.2924"></a><span id="l23.2924" class="difflineminus">-		});</span>
<a href="#l23.2925"></a><span id="l23.2925" class="difflineminus">-	},</span>
<a href="#l23.2926"></a><span id="l23.2926" class="difflineminus">-</span>
<a href="#l23.2927"></a><span id="l23.2927" class="difflineminus">-	triggerHandler: function( type, data ) {</span>
<a href="#l23.2928"></a><span id="l23.2928" class="difflineminus">-		if( this[0] ){</span>
<a href="#l23.2929"></a><span id="l23.2929" class="difflineminus">-			var event = jQuery.Event(type);</span>
<a href="#l23.2930"></a><span id="l23.2930" class="difflineminus">-			event.preventDefault();</span>
<a href="#l23.2931"></a><span id="l23.2931" class="difflineminus">-			event.stopPropagation();</span>
<a href="#l23.2932"></a><span id="l23.2932" class="difflineminus">-			jQuery.event.trigger( event, data, this[0] );</span>
<a href="#l23.2933"></a><span id="l23.2933" class="difflineminus">-			return event.result;</span>
<a href="#l23.2934"></a><span id="l23.2934" class="difflineminus">-		}		</span>
<a href="#l23.2935"></a><span id="l23.2935" class="difflineminus">-	},</span>
<a href="#l23.2936"></a><span id="l23.2936" class="difflineminus">-</span>
<a href="#l23.2937"></a><span id="l23.2937" class="difflineminus">-	toggle: function( fn ) {</span>
<a href="#l23.2938"></a><span id="l23.2938" class="difflineminus">-		// Save reference to arguments for access in closure</span>
<a href="#l23.2939"></a><span id="l23.2939" class="difflineminus">-		var args = arguments, i = 1;</span>
<a href="#l23.2940"></a><span id="l23.2940" class="difflineminus">-</span>
<a href="#l23.2941"></a><span id="l23.2941" class="difflineminus">-		// link all the functions, so any of them can unbind this click handler</span>
<a href="#l23.2942"></a><span id="l23.2942" class="difflineminus">-		while( i &lt; args.length )</span>
<a href="#l23.2943"></a><span id="l23.2943" class="difflineminus">-			jQuery.event.proxy( fn, args[i++] );</span>
<a href="#l23.2944"></a><span id="l23.2944" class="difflineminus">-</span>
<a href="#l23.2945"></a><span id="l23.2945" class="difflineminus">-		return this.click( jQuery.event.proxy( fn, function(event) {</span>
<a href="#l23.2946"></a><span id="l23.2946" class="difflineminus">-			// Figure out which function to execute</span>
<a href="#l23.2947"></a><span id="l23.2947" class="difflineminus">-			this.lastToggle = ( this.lastToggle || 0 ) % i;</span>
<a href="#l23.2948"></a><span id="l23.2948" class="difflineminus">-</span>
<a href="#l23.2949"></a><span id="l23.2949" class="difflineminus">-			// Make sure that clicks stop</span>
<a href="#l23.2950"></a><span id="l23.2950" class="difflineminus">-			event.preventDefault();</span>
<a href="#l23.2951"></a><span id="l23.2951" class="difflineminus">-</span>
<a href="#l23.2952"></a><span id="l23.2952" class="difflineminus">-			// and execute the function</span>
<a href="#l23.2953"></a><span id="l23.2953" class="difflineminus">-			return args[ this.lastToggle++ ].apply( this, arguments ) || false;</span>
<a href="#l23.2954"></a><span id="l23.2954" class="difflineminus">-		}));</span>
<a href="#l23.2955"></a><span id="l23.2955" class="difflineminus">-	},</span>
<a href="#l23.2956"></a><span id="l23.2956" class="difflineminus">-</span>
<a href="#l23.2957"></a><span id="l23.2957" class="difflineminus">-	hover: function(fnOver, fnOut) {</span>
<a href="#l23.2958"></a><span id="l23.2958" class="difflineminus">-		return this.mouseenter(fnOver).mouseleave(fnOut);</span>
<a href="#l23.2959"></a><span id="l23.2959" class="difflineminus">-	},</span>
<a href="#l23.2960"></a><span id="l23.2960" class="difflineminus">-</span>
<a href="#l23.2961"></a><span id="l23.2961" class="difflineminus">-	ready: function(fn) {</span>
<a href="#l23.2962"></a><span id="l23.2962" class="difflineminus">-		// Attach the listeners</span>
<a href="#l23.2963"></a><span id="l23.2963" class="difflineminus">-		bindReady();</span>
<a href="#l23.2964"></a><span id="l23.2964" class="difflineminus">-</span>
<a href="#l23.2965"></a><span id="l23.2965" class="difflineminus">-		// If the DOM is already ready</span>
<a href="#l23.2966"></a><span id="l23.2966" class="difflineminus">-		if ( jQuery.isReady )</span>
<a href="#l23.2967"></a><span id="l23.2967" class="difflineminus">-			// Execute the function immediately</span>
<a href="#l23.2968"></a><span id="l23.2968" class="difflineminus">-			fn.call( document, jQuery );</span>
<a href="#l23.2969"></a><span id="l23.2969" class="difflineminus">-</span>
<a href="#l23.2970"></a><span id="l23.2970" class="difflineminus">-		// Otherwise, remember the function for later</span>
<a href="#l23.2971"></a><span id="l23.2971" class="difflineminus">-		else</span>
<a href="#l23.2972"></a><span id="l23.2972" class="difflineminus">-			// Add the function to the wait list</span>
<a href="#l23.2973"></a><span id="l23.2973" class="difflineminus">-			jQuery.readyList.push( fn );</span>
<a href="#l23.2974"></a><span id="l23.2974" class="difflineminus">-</span>
<a href="#l23.2975"></a><span id="l23.2975" class="difflineminus">-		return this;</span>
<a href="#l23.2976"></a><span id="l23.2976" class="difflineminus">-	},</span>
<a href="#l23.2977"></a><span id="l23.2977" class="difflineminus">-	</span>
<a href="#l23.2978"></a><span id="l23.2978" class="difflineminus">-	live: function( type, fn ){</span>
<a href="#l23.2979"></a><span id="l23.2979" class="difflineminus">-		var proxy = jQuery.event.proxy( fn );</span>
<a href="#l23.2980"></a><span id="l23.2980" class="difflineminus">-		proxy.guid += this.selector + type;</span>
<a href="#l23.2981"></a><span id="l23.2981" class="difflineminus">-</span>
<a href="#l23.2982"></a><span id="l23.2982" class="difflineminus">-		jQuery(document).bind( liveConvert(type, this.selector), this.selector, proxy );</span>
<a href="#l23.2983"></a><span id="l23.2983" class="difflineminus">-</span>
<a href="#l23.2984"></a><span id="l23.2984" class="difflineminus">-		return this;</span>
<a href="#l23.2985"></a><span id="l23.2985" class="difflineminus">-	},</span>
<a href="#l23.2986"></a><span id="l23.2986" class="difflineminus">-	</span>
<a href="#l23.2987"></a><span id="l23.2987" class="difflineminus">-	die: function( type, fn ){</span>
<a href="#l23.2988"></a><span id="l23.2988" class="difflineminus">-		jQuery(document).unbind( liveConvert(type, this.selector), fn ? { guid: fn.guid + this.selector + type } : null );</span>
<a href="#l23.2989"></a><span id="l23.2989" class="difflineminus">-		return this;</span>
<a href="#l23.2990"></a><span id="l23.2990" class="difflineminus">-	}</span>
<a href="#l23.2991"></a><span id="l23.2991" class="difflineminus">-});</span>
<a href="#l23.2992"></a><span id="l23.2992" class="difflineminus">-</span>
<a href="#l23.2993"></a><span id="l23.2993" class="difflineminus">-function liveHandler( event ){</span>
<a href="#l23.2994"></a><span id="l23.2994" class="difflineminus">-	var check = RegExp(&quot;(^|\\.)&quot; + event.type + &quot;(\\.|$)&quot;),</span>
<a href="#l23.2995"></a><span id="l23.2995" class="difflineminus">-		stop = true,</span>
<a href="#l23.2996"></a><span id="l23.2996" class="difflineminus">-		elems = [];</span>
<a href="#l23.2997"></a><span id="l23.2997" class="difflineminus">-</span>
<a href="#l23.2998"></a><span id="l23.2998" class="difflineminus">-	jQuery.each(jQuery.data(this, &quot;events&quot;).live || [], function(i, fn){</span>
<a href="#l23.2999"></a><span id="l23.2999" class="difflineminus">-		if ( check.test(fn.type) ) {</span>
<a href="#l23.3000"></a><span id="l23.3000" class="difflineminus">-			var elem = jQuery(event.target).closest(fn.data)[0];</span>
<a href="#l23.3001"></a><span id="l23.3001" class="difflineminus">-			if ( elem )</span>
<a href="#l23.3002"></a><span id="l23.3002" class="difflineminus">-				elems.push({ elem: elem, fn: fn });</span>
<a href="#l23.3003"></a><span id="l23.3003" class="difflineminus">-		}</span>
<a href="#l23.3004"></a><span id="l23.3004" class="difflineminus">-	});</span>
<a href="#l23.3005"></a><span id="l23.3005" class="difflineminus">-</span>
<a href="#l23.3006"></a><span id="l23.3006" class="difflineminus">-	elems.sort(function(a,b) {</span>
<a href="#l23.3007"></a><span id="l23.3007" class="difflineminus">-		return jQuery.data(a.elem, &quot;closest&quot;) - jQuery.data(b.elem, &quot;closest&quot;);</span>
<a href="#l23.3008"></a><span id="l23.3008" class="difflineminus">-	});</span>
<a href="#l23.3009"></a><span id="l23.3009" class="difflineminus">-	</span>
<a href="#l23.3010"></a><span id="l23.3010" class="difflineminus">-	jQuery.each(elems, function(){</span>
<a href="#l23.3011"></a><span id="l23.3011" class="difflineminus">-		if ( this.fn.call(this.elem, event, this.fn.data) === false )</span>
<a href="#l23.3012"></a><span id="l23.3012" class="difflineminus">-			return (stop = false);</span>
<a href="#l23.3013"></a><span id="l23.3013" class="difflineminus">-	});</span>
<a href="#l23.3014"></a><span id="l23.3014" class="difflineminus">-</span>
<a href="#l23.3015"></a><span id="l23.3015" class="difflineminus">-	return stop;</span>
<a href="#l23.3016"></a><span id="l23.3016" class="difflineminus">-}</span>
<a href="#l23.3017"></a><span id="l23.3017" class="difflineminus">-</span>
<a href="#l23.3018"></a><span id="l23.3018" class="difflineminus">-function liveConvert(type, selector){</span>
<a href="#l23.3019"></a><span id="l23.3019" class="difflineminus">-	return [&quot;live&quot;, type, selector.replace(/\./g, &quot;`&quot;).replace(/ /g, &quot;|&quot;)].join(&quot;.&quot;);</span>
<a href="#l23.3020"></a><span id="l23.3020" class="difflineminus">-}</span>
<a href="#l23.3021"></a><span id="l23.3021" class="difflineminus">-</span>
<a href="#l23.3022"></a><span id="l23.3022" class="difflineminus">-jQuery.extend({</span>
<a href="#l23.3023"></a><span id="l23.3023" class="difflineminus">-	isReady: false,</span>
<a href="#l23.3024"></a><span id="l23.3024" class="difflineminus">-	readyList: [],</span>
<a href="#l23.3025"></a><span id="l23.3025" class="difflineminus">-	// Handle when the DOM is ready</span>
<a href="#l23.3026"></a><span id="l23.3026" class="difflineminus">-	ready: function() {</span>
<a href="#l23.3027"></a><span id="l23.3027" class="difflineminus">-		// Make sure that the DOM is not already loaded</span>
<a href="#l23.3028"></a><span id="l23.3028" class="difflineminus">-		if ( !jQuery.isReady ) {</span>
<a href="#l23.3029"></a><span id="l23.3029" class="difflineminus">-			// Remember that the DOM is ready</span>
<a href="#l23.3030"></a><span id="l23.3030" class="difflineminus">-			jQuery.isReady = true;</span>
<a href="#l23.3031"></a><span id="l23.3031" class="difflineminus">-</span>
<a href="#l23.3032"></a><span id="l23.3032" class="difflineminus">-			// If there are functions bound, to execute</span>
<a href="#l23.3033"></a><span id="l23.3033" class="difflineminus">-			if ( jQuery.readyList ) {</span>
<a href="#l23.3034"></a><span id="l23.3034" class="difflineminus">-				// Execute all of them</span>
<a href="#l23.3035"></a><span id="l23.3035" class="difflineminus">-				jQuery.each( jQuery.readyList, function(){</span>
<a href="#l23.3036"></a><span id="l23.3036" class="difflineminus">-					this.call( document, jQuery );</span>
<a href="#l23.3037"></a><span id="l23.3037" class="difflineminus">-				});</span>
<a href="#l23.3038"></a><span id="l23.3038" class="difflineminus">-</span>
<a href="#l23.3039"></a><span id="l23.3039" class="difflineminus">-				// Reset the list of functions</span>
<a href="#l23.3040"></a><span id="l23.3040" class="difflineminus">-				jQuery.readyList = null;</span>
<a href="#l23.3041"></a><span id="l23.3041" class="difflineminus">-			}</span>
<a href="#l23.3042"></a><span id="l23.3042" class="difflineminus">-</span>
<a href="#l23.3043"></a><span id="l23.3043" class="difflineminus">-			// Trigger any bound ready events</span>
<a href="#l23.3044"></a><span id="l23.3044" class="difflineminus">-			jQuery(document).triggerHandler(&quot;ready&quot;);</span>
<a href="#l23.3045"></a><span id="l23.3045" class="difflineminus">-		}</span>
<a href="#l23.3046"></a><span id="l23.3046" class="difflineminus">-	}</span>
<a href="#l23.3047"></a><span id="l23.3047" class="difflineminus">-});</span>
<a href="#l23.3048"></a><span id="l23.3048" class="difflineminus">-</span>
<a href="#l23.3049"></a><span id="l23.3049" class="difflineminus">-var readyBound = false;</span>
<a href="#l23.3050"></a><span id="l23.3050" class="difflineminus">-</span>
<a href="#l23.3051"></a><span id="l23.3051" class="difflineminus">-function bindReady(){</span>
<a href="#l23.3052"></a><span id="l23.3052" class="difflineminus">-	if ( readyBound ) return;</span>
<a href="#l23.3053"></a><span id="l23.3053" class="difflineminus">-	readyBound = true;</span>
<a href="#l23.3054"></a><span id="l23.3054" class="difflineminus">-</span>
<a href="#l23.3055"></a><span id="l23.3055" class="difflineminus">-	// Mozilla, Opera and webkit nightlies currently support this event</span>
<a href="#l23.3056"></a><span id="l23.3056" class="difflineminus">-	if ( document.addEventListener ) {</span>
<a href="#l23.3057"></a><span id="l23.3057" class="difflineminus">-		// Use the handy event callback</span>
<a href="#l23.3058"></a><span id="l23.3058" class="difflineminus">-		document.addEventListener( &quot;DOMContentLoaded&quot;, function(){</span>
<a href="#l23.3059"></a><span id="l23.3059" class="difflineminus">-			document.removeEventListener( &quot;DOMContentLoaded&quot;, arguments.callee, false );</span>
<a href="#l23.3060"></a><span id="l23.3060" class="difflineminus">-			jQuery.ready();</span>
<a href="#l23.3061"></a><span id="l23.3061" class="difflineminus">-		}, false );</span>
<a href="#l23.3062"></a><span id="l23.3062" class="difflineminus">-</span>
<a href="#l23.3063"></a><span id="l23.3063" class="difflineminus">-	// If IE event model is used</span>
<a href="#l23.3064"></a><span id="l23.3064" class="difflineminus">-	} else if ( document.attachEvent ) {</span>
<a href="#l23.3065"></a><span id="l23.3065" class="difflineminus">-		// ensure firing before onload,</span>
<a href="#l23.3066"></a><span id="l23.3066" class="difflineminus">-		// maybe late but safe also for iframes</span>
<a href="#l23.3067"></a><span id="l23.3067" class="difflineminus">-		document.attachEvent(&quot;onreadystatechange&quot;, function(){</span>
<a href="#l23.3068"></a><span id="l23.3068" class="difflineminus">-			if ( document.readyState === &quot;complete&quot; ) {</span>
<a href="#l23.3069"></a><span id="l23.3069" class="difflineminus">-				document.detachEvent( &quot;onreadystatechange&quot;, arguments.callee );</span>
<a href="#l23.3070"></a><span id="l23.3070" class="difflineminus">-				jQuery.ready();</span>
<a href="#l23.3071"></a><span id="l23.3071" class="difflineminus">-			}</span>
<a href="#l23.3072"></a><span id="l23.3072" class="difflineminus">-		});</span>
<a href="#l23.3073"></a><span id="l23.3073" class="difflineminus">-</span>
<a href="#l23.3074"></a><span id="l23.3074" class="difflineminus">-		// If IE and not an iframe</span>
<a href="#l23.3075"></a><span id="l23.3075" class="difflineminus">-		// continually check to see if the document is ready</span>
<a href="#l23.3076"></a><span id="l23.3076" class="difflineminus">-		if ( document.documentElement.doScroll &amp;&amp; window == window.top ) (function(){</span>
<a href="#l23.3077"></a><span id="l23.3077" class="difflineminus">-			if ( jQuery.isReady ) return;</span>
<a href="#l23.3078"></a><span id="l23.3078" class="difflineminus">-</span>
<a href="#l23.3079"></a><span id="l23.3079" class="difflineminus">-			try {</span>
<a href="#l23.3080"></a><span id="l23.3080" class="difflineminus">-				// If IE is used, use the trick by Diego Perini</span>
<a href="#l23.3081"></a><span id="l23.3081" class="difflineminus">-				// http://javascript.nwbox.com/IEContentLoaded/</span>
<a href="#l23.3082"></a><span id="l23.3082" class="difflineminus">-				document.documentElement.doScroll(&quot;left&quot;);</span>
<a href="#l23.3083"></a><span id="l23.3083" class="difflineminus">-			} catch( error ) {</span>
<a href="#l23.3084"></a><span id="l23.3084" class="difflineminus">-				setTimeout( arguments.callee, 0 );</span>
<a href="#l23.3085"></a><span id="l23.3085" class="difflineminus">-				return;</span>
<a href="#l23.3086"></a><span id="l23.3086" class="difflineminus">-			}</span>
<a href="#l23.3087"></a><span id="l23.3087" class="difflineminus">-</span>
<a href="#l23.3088"></a><span id="l23.3088" class="difflineminus">-			// and execute any waiting functions</span>
<a href="#l23.3089"></a><span id="l23.3089" class="difflineminus">-			jQuery.ready();</span>
<a href="#l23.3090"></a><span id="l23.3090" class="difflineminus">-		})();</span>
<a href="#l23.3091"></a><span id="l23.3091" class="difflineminus">-	}</span>
<a href="#l23.3092"></a><span id="l23.3092" class="difflineminus">-</span>
<a href="#l23.3093"></a><span id="l23.3093" class="difflineminus">-	// A fallback to window.onload, that will always work</span>
<a href="#l23.3094"></a><span id="l23.3094" class="difflineminus">-	jQuery.event.add( window, &quot;load&quot;, jQuery.ready );</span>
<a href="#l23.3095"></a><span id="l23.3095" class="difflineminus">-}</span>
<a href="#l23.3096"></a><span id="l23.3096" class="difflineminus">-</span>
<a href="#l23.3097"></a><span id="l23.3097" class="difflineminus">-jQuery.each( (&quot;blur,focus,load,resize,scroll,unload,click,dblclick,&quot; +</span>
<a href="#l23.3098"></a><span id="l23.3098" class="difflineminus">-	&quot;mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,&quot; +</span>
<a href="#l23.3099"></a><span id="l23.3099" class="difflineminus">-	&quot;change,select,submit,keydown,keypress,keyup,error&quot;).split(&quot;,&quot;), function(i, name){</span>
<a href="#l23.3100"></a><span id="l23.3100" class="difflineminus">-</span>
<a href="#l23.3101"></a><span id="l23.3101" class="difflineminus">-	// Handle event binding</span>
<a href="#l23.3102"></a><span id="l23.3102" class="difflineminus">-	jQuery.fn[name] = function(fn){</span>
<a href="#l23.3103"></a><span id="l23.3103" class="difflineminus">-		return fn ? this.bind(name, fn) : this.trigger(name);</span>
<a href="#l23.3104"></a><span id="l23.3104" class="difflineminus">-	};</span>
<a href="#l23.3105"></a><span id="l23.3105" class="difflineminus">-});</span>
<a href="#l23.3106"></a><span id="l23.3106" class="difflineminus">-</span>
<a href="#l23.3107"></a><span id="l23.3107" class="difflineminus">-// Prevent memory leaks in IE</span>
<a href="#l23.3108"></a><span id="l23.3108" class="difflineminus">-// And prevent errors on refresh with events like mouseover in other browsers</span>
<a href="#l23.3109"></a><span id="l23.3109" class="difflineminus">-// Window isn't included so as not to unbind existing unload events</span>
<a href="#l23.3110"></a><span id="l23.3110" class="difflineminus">-jQuery( window ).bind( 'unload', function(){ </span>
<a href="#l23.3111"></a><span id="l23.3111" class="difflineminus">-	for ( var id in jQuery.cache )</span>
<a href="#l23.3112"></a><span id="l23.3112" class="difflineminus">-		// Skip the window</span>
<a href="#l23.3113"></a><span id="l23.3113" class="difflineminus">-		if ( id != 1 &amp;&amp; jQuery.cache[ id ].handle )</span>
<a href="#l23.3114"></a><span id="l23.3114" class="difflineminus">-			jQuery.event.remove( jQuery.cache[ id ].handle.elem );</span>
<a href="#l23.3115"></a><span id="l23.3115" class="difflineminus">-}); </span>
<a href="#l23.3116"></a><span id="l23.3116" class="difflineminus">-(function(){</span>
<a href="#l23.3117"></a><span id="l23.3117" class="difflineminus">-</span>
<a href="#l23.3118"></a><span id="l23.3118" class="difflineminus">-	jQuery.support = {};</span>
<a href="#l23.3119"></a><span id="l23.3119" class="difflineminus">-</span>
<a href="#l23.3120"></a><span id="l23.3120" class="difflineminus">-	var root = document.documentElement,</span>
<a href="#l23.3121"></a><span id="l23.3121" class="difflineminus">-		script = document.createElement(&quot;script&quot;),</span>
<a href="#l23.3122"></a><span id="l23.3122" class="difflineminus">-		div = document.createElement(&quot;div&quot;),</span>
<a href="#l23.3123"></a><span id="l23.3123" class="difflineminus">-		id = &quot;script&quot; + (new Date).getTime();</span>
<a href="#l23.3124"></a><span id="l23.3124" class="difflineminus">-</span>
<a href="#l23.3125"></a><span id="l23.3125" class="difflineminus">-	div.style.display = &quot;none&quot;;</span>
<a href="#l23.3126"></a><span id="l23.3126" class="difflineminus">-	div.innerHTML = '   &lt;link/&gt;&lt;table&gt;&lt;/table&gt;&lt;a href=&quot;/a&quot; style=&quot;color:red;float:left;opacity:.5;&quot;&gt;a&lt;/a&gt;&lt;select&gt;&lt;option&gt;text&lt;/option&gt;&lt;/select&gt;&lt;object&gt;&lt;param/&gt;&lt;/object&gt;';</span>
<a href="#l23.3127"></a><span id="l23.3127" class="difflineminus">-</span>
<a href="#l23.3128"></a><span id="l23.3128" class="difflineminus">-	var all = div.getElementsByTagName(&quot;*&quot;),</span>
<a href="#l23.3129"></a><span id="l23.3129" class="difflineminus">-		a = div.getElementsByTagName(&quot;a&quot;)[0];</span>
<a href="#l23.3130"></a><span id="l23.3130" class="difflineminus">-</span>
<a href="#l23.3131"></a><span id="l23.3131" class="difflineminus">-	// Can't get basic test support</span>
<a href="#l23.3132"></a><span id="l23.3132" class="difflineminus">-	if ( !all || !all.length || !a ) {</span>
<a href="#l23.3133"></a><span id="l23.3133" class="difflineminus">-		return;</span>
<a href="#l23.3134"></a><span id="l23.3134" class="difflineminus">-	}</span>
<a href="#l23.3135"></a><span id="l23.3135" class="difflineminus">-</span>
<a href="#l23.3136"></a><span id="l23.3136" class="difflineminus">-	jQuery.support = {</span>
<a href="#l23.3137"></a><span id="l23.3137" class="difflineminus">-		// IE strips leading whitespace when .innerHTML is used</span>
<a href="#l23.3138"></a><span id="l23.3138" class="difflineminus">-		leadingWhitespace: div.firstChild.nodeType == 3,</span>
<a href="#l23.3139"></a><span id="l23.3139" class="difflineminus">-		</span>
<a href="#l23.3140"></a><span id="l23.3140" class="difflineminus">-		// Make sure that tbody elements aren't automatically inserted</span>
<a href="#l23.3141"></a><span id="l23.3141" class="difflineminus">-		// IE will insert them into empty tables</span>
<a href="#l23.3142"></a><span id="l23.3142" class="difflineminus">-		tbody: !div.getElementsByTagName(&quot;tbody&quot;).length,</span>
<a href="#l23.3143"></a><span id="l23.3143" class="difflineminus">-		</span>
<a href="#l23.3144"></a><span id="l23.3144" class="difflineminus">-		// Make sure that you can get all elements in an &lt;object&gt; element</span>
<a href="#l23.3145"></a><span id="l23.3145" class="difflineminus">-		// IE 7 always returns no results</span>
<a href="#l23.3146"></a><span id="l23.3146" class="difflineminus">-		objectAll: !!div.getElementsByTagName(&quot;object&quot;)[0]</span>
<a href="#l23.3147"></a><span id="l23.3147" class="difflineminus">-			.getElementsByTagName(&quot;*&quot;).length,</span>
<a href="#l23.3148"></a><span id="l23.3148" class="difflineminus">-		</span>
<a href="#l23.3149"></a><span id="l23.3149" class="difflineminus">-		// Make sure that link elements get serialized correctly by innerHTML</span>
<a href="#l23.3150"></a><span id="l23.3150" class="difflineminus">-		// This requires a wrapper element in IE</span>
<a href="#l23.3151"></a><span id="l23.3151" class="difflineminus">-		htmlSerialize: !!div.getElementsByTagName(&quot;link&quot;).length,</span>
<a href="#l23.3152"></a><span id="l23.3152" class="difflineminus">-		</span>
<a href="#l23.3153"></a><span id="l23.3153" class="difflineminus">-		// Get the style information from getAttribute</span>
<a href="#l23.3154"></a><span id="l23.3154" class="difflineminus">-		// (IE uses .cssText insted)</span>
<a href="#l23.3155"></a><span id="l23.3155" class="difflineminus">-		style: /red/.test( a.getAttribute(&quot;style&quot;) ),</span>
<a href="#l23.3156"></a><span id="l23.3156" class="difflineminus">-		</span>
<a href="#l23.3157"></a><span id="l23.3157" class="difflineminus">-		// Make sure that URLs aren't manipulated</span>
<a href="#l23.3158"></a><span id="l23.3158" class="difflineminus">-		// (IE normalizes it by default)</span>
<a href="#l23.3159"></a><span id="l23.3159" class="difflineminus">-		hrefNormalized: a.getAttribute(&quot;href&quot;) === &quot;/a&quot;,</span>
<a href="#l23.3160"></a><span id="l23.3160" class="difflineminus">-		</span>
<a href="#l23.3161"></a><span id="l23.3161" class="difflineminus">-		// Make sure that element opacity exists</span>
<a href="#l23.3162"></a><span id="l23.3162" class="difflineminus">-		// (IE uses filter instead)</span>
<a href="#l23.3163"></a><span id="l23.3163" class="difflineminus">-		opacity: a.style.opacity === &quot;0.5&quot;,</span>
<a href="#l23.3164"></a><span id="l23.3164" class="difflineminus">-		</span>
<a href="#l23.3165"></a><span id="l23.3165" class="difflineminus">-		// Verify style float existence</span>
<a href="#l23.3166"></a><span id="l23.3166" class="difflineminus">-		// (IE uses styleFloat instead of cssFloat)</span>
<a href="#l23.3167"></a><span id="l23.3167" class="difflineminus">-		cssFloat: !!a.style.cssFloat,</span>
<a href="#l23.3168"></a><span id="l23.3168" class="difflineminus">-</span>
<a href="#l23.3169"></a><span id="l23.3169" class="difflineminus">-		// Will be defined later</span>
<a href="#l23.3170"></a><span id="l23.3170" class="difflineminus">-		scriptEval: false,</span>
<a href="#l23.3171"></a><span id="l23.3171" class="difflineminus">-		noCloneEvent: true,</span>
<a href="#l23.3172"></a><span id="l23.3172" class="difflineminus">-		boxModel: null</span>
<a href="#l23.3173"></a><span id="l23.3173" class="difflineminus">-	};</span>
<a href="#l23.3174"></a><span id="l23.3174" class="difflineminus">-	</span>
<a href="#l23.3175"></a><span id="l23.3175" class="difflineminus">-	script.type = &quot;text/javascript&quot;;</span>
<a href="#l23.3176"></a><span id="l23.3176" class="difflineminus">-	try {</span>
<a href="#l23.3177"></a><span id="l23.3177" class="difflineminus">-		script.appendChild( document.createTextNode( &quot;window.&quot; + id + &quot;=1;&quot; ) );</span>
<a href="#l23.3178"></a><span id="l23.3178" class="difflineminus">-	} catch(e){}</span>
<a href="#l23.3179"></a><span id="l23.3179" class="difflineminus">-</span>
<a href="#l23.3180"></a><span id="l23.3180" class="difflineminus">-	root.insertBefore( script, root.firstChild );</span>
<a href="#l23.3181"></a><span id="l23.3181" class="difflineminus">-	</span>
<a href="#l23.3182"></a><span id="l23.3182" class="difflineminus">-	// Make sure that the execution of code works by injecting a script</span>
<a href="#l23.3183"></a><span id="l23.3183" class="difflineminus">-	// tag with appendChild/createTextNode</span>
<a href="#l23.3184"></a><span id="l23.3184" class="difflineminus">-	// (IE doesn't support this, fails, and uses .text instead)</span>
<a href="#l23.3185"></a><span id="l23.3185" class="difflineminus">-	if ( window[ id ] ) {</span>
<a href="#l23.3186"></a><span id="l23.3186" class="difflineminus">-		jQuery.support.scriptEval = true;</span>
<a href="#l23.3187"></a><span id="l23.3187" class="difflineminus">-		delete window[ id ];</span>
<a href="#l23.3188"></a><span id="l23.3188" class="difflineminus">-	}</span>
<a href="#l23.3189"></a><span id="l23.3189" class="difflineminus">-</span>
<a href="#l23.3190"></a><span id="l23.3190" class="difflineminus">-	root.removeChild( script );</span>
<a href="#l23.3191"></a><span id="l23.3191" class="difflineminus">-</span>
<a href="#l23.3192"></a><span id="l23.3192" class="difflineminus">-	if ( div.attachEvent &amp;&amp; div.fireEvent ) {</span>
<a href="#l23.3193"></a><span id="l23.3193" class="difflineminus">-		div.attachEvent(&quot;onclick&quot;, function(){</span>
<a href="#l23.3194"></a><span id="l23.3194" class="difflineminus">-			// Cloning a node shouldn't copy over any</span>
<a href="#l23.3195"></a><span id="l23.3195" class="difflineminus">-			// bound event handlers (IE does this)</span>
<a href="#l23.3196"></a><span id="l23.3196" class="difflineminus">-			jQuery.support.noCloneEvent = false;</span>
<a href="#l23.3197"></a><span id="l23.3197" class="difflineminus">-			div.detachEvent(&quot;onclick&quot;, arguments.callee);</span>
<a href="#l23.3198"></a><span id="l23.3198" class="difflineminus">-		});</span>
<a href="#l23.3199"></a><span id="l23.3199" class="difflineminus">-		div.cloneNode(true).fireEvent(&quot;onclick&quot;);</span>
<a href="#l23.3200"></a><span id="l23.3200" class="difflineminus">-	}</span>
<a href="#l23.3201"></a><span id="l23.3201" class="difflineminus">-</span>
<a href="#l23.3202"></a><span id="l23.3202" class="difflineminus">-	// Figure out if the W3C box model works as expected</span>
<a href="#l23.3203"></a><span id="l23.3203" class="difflineminus">-	// document.body must exist before we can do this</span>
<a href="#l23.3204"></a><span id="l23.3204" class="difflineminus">-	jQuery(function(){</span>
<a href="#l23.3205"></a><span id="l23.3205" class="difflineminus">-		var div = document.createElement(&quot;div&quot;);</span>
<a href="#l23.3206"></a><span id="l23.3206" class="difflineminus">-		div.style.width = div.style.paddingLeft = &quot;1px&quot;;</span>
<a href="#l23.3207"></a><span id="l23.3207" class="difflineminus">-</span>
<a href="#l23.3208"></a><span id="l23.3208" class="difflineminus">-		document.body.appendChild( div );</span>
<a href="#l23.3209"></a><span id="l23.3209" class="difflineminus">-		jQuery.boxModel = jQuery.support.boxModel = div.offsetWidth === 2;</span>
<a href="#l23.3210"></a><span id="l23.3210" class="difflineminus">-		document.body.removeChild( div ).style.display = 'none';</span>
<a href="#l23.3211"></a><span id="l23.3211" class="difflineminus">-	});</span>
<a href="#l23.3212"></a><span id="l23.3212" class="difflineminus">-})();</span>
<a href="#l23.3213"></a><span id="l23.3213" class="difflineminus">-</span>
<a href="#l23.3214"></a><span id="l23.3214" class="difflineminus">-var styleFloat = jQuery.support.cssFloat ? &quot;cssFloat&quot; : &quot;styleFloat&quot;;</span>
<a href="#l23.3215"></a><span id="l23.3215" class="difflineminus">-</span>
<a href="#l23.3216"></a><span id="l23.3216" class="difflineminus">-jQuery.props = {</span>
<a href="#l23.3217"></a><span id="l23.3217" class="difflineminus">-	&quot;for&quot;: &quot;htmlFor&quot;,</span>
<a href="#l23.3218"></a><span id="l23.3218" class="difflineminus">-	&quot;class&quot;: &quot;className&quot;,</span>
<a href="#l23.3219"></a><span id="l23.3219" class="difflineminus">-	&quot;float&quot;: styleFloat,</span>
<a href="#l23.3220"></a><span id="l23.3220" class="difflineminus">-	cssFloat: styleFloat,</span>
<a href="#l23.3221"></a><span id="l23.3221" class="difflineminus">-	styleFloat: styleFloat,</span>
<a href="#l23.3222"></a><span id="l23.3222" class="difflineminus">-	readonly: &quot;readOnly&quot;,</span>
<a href="#l23.3223"></a><span id="l23.3223" class="difflineminus">-	maxlength: &quot;maxLength&quot;,</span>
<a href="#l23.3224"></a><span id="l23.3224" class="difflineminus">-	cellspacing: &quot;cellSpacing&quot;,</span>
<a href="#l23.3225"></a><span id="l23.3225" class="difflineminus">-	rowspan: &quot;rowSpan&quot;,</span>
<a href="#l23.3226"></a><span id="l23.3226" class="difflineminus">-	tabindex: &quot;tabIndex&quot;</span>
<a href="#l23.3227"></a><span id="l23.3227" class="difflineminus">-};</span>
<a href="#l23.3228"></a><span id="l23.3228" class="difflineminus">-jQuery.fn.extend({</span>
<a href="#l23.3229"></a><span id="l23.3229" class="difflineminus">-	// Keep a copy of the old load</span>
<a href="#l23.3230"></a><span id="l23.3230" class="difflineminus">-	_load: jQuery.fn.load,</span>
<a href="#l23.3231"></a><span id="l23.3231" class="difflineminus">-</span>
<a href="#l23.3232"></a><span id="l23.3232" class="difflineminus">-	load: function( url, params, callback ) {</span>
<a href="#l23.3233"></a><span id="l23.3233" class="difflineminus">-		if ( typeof url !== &quot;string&quot; )</span>
<a href="#l23.3234"></a><span id="l23.3234" class="difflineminus">-			return this._load( url );</span>
<a href="#l23.3235"></a><span id="l23.3235" class="difflineminus">-</span>
<a href="#l23.3236"></a><span id="l23.3236" class="difflineminus">-		var off = url.indexOf(&quot; &quot;);</span>
<a href="#l23.3237"></a><span id="l23.3237" class="difflineminus">-		if ( off &gt;= 0 ) {</span>
<a href="#l23.3238"></a><span id="l23.3238" class="difflineminus">-			var selector = url.slice(off, url.length);</span>
<a href="#l23.3239"></a><span id="l23.3239" class="difflineminus">-			url = url.slice(0, off);</span>
<a href="#l23.3240"></a><span id="l23.3240" class="difflineminus">-		}</span>
<a href="#l23.3241"></a><span id="l23.3241" class="difflineminus">-</span>
<a href="#l23.3242"></a><span id="l23.3242" class="difflineminus">-		// Default to a GET request</span>
<a href="#l23.3243"></a><span id="l23.3243" class="difflineminus">-		var type = &quot;GET&quot;;</span>
<a href="#l23.3244"></a><span id="l23.3244" class="difflineminus">-</span>
<a href="#l23.3245"></a><span id="l23.3245" class="difflineminus">-		// If the second parameter was provided</span>
<a href="#l23.3246"></a><span id="l23.3246" class="difflineminus">-		if ( params )</span>
<a href="#l23.3247"></a><span id="l23.3247" class="difflineminus">-			// If it's a function</span>
<a href="#l23.3248"></a><span id="l23.3248" class="difflineminus">-			if ( jQuery.isFunction( params ) ) {</span>
<a href="#l23.3249"></a><span id="l23.3249" class="difflineminus">-				// We assume that it's the callback</span>
<a href="#l23.3250"></a><span id="l23.3250" class="difflineminus">-				callback = params;</span>
<a href="#l23.3251"></a><span id="l23.3251" class="difflineminus">-				params = null;</span>
<a href="#l23.3252"></a><span id="l23.3252" class="difflineminus">-</span>
<a href="#l23.3253"></a><span id="l23.3253" class="difflineminus">-			// Otherwise, build a param string</span>
<a href="#l23.3254"></a><span id="l23.3254" class="difflineminus">-			} else if( typeof params === &quot;object&quot; ) {</span>
<a href="#l23.3255"></a><span id="l23.3255" class="difflineminus">-				params = jQuery.param( params );</span>
<a href="#l23.3256"></a><span id="l23.3256" class="difflineminus">-				type = &quot;POST&quot;;</span>
<a href="#l23.3257"></a><span id="l23.3257" class="difflineminus">-			}</span>
<a href="#l23.3258"></a><span id="l23.3258" class="difflineminus">-</span>
<a href="#l23.3259"></a><span id="l23.3259" class="difflineminus">-		var self = this;</span>
<a href="#l23.3260"></a><span id="l23.3260" class="difflineminus">-</span>
<a href="#l23.3261"></a><span id="l23.3261" class="difflineminus">-		// Request the remote document</span>
<a href="#l23.3262"></a><span id="l23.3262" class="difflineminus">-		jQuery.ajax({</span>
<a href="#l23.3263"></a><span id="l23.3263" class="difflineminus">-			url: url,</span>
<a href="#l23.3264"></a><span id="l23.3264" class="difflineminus">-			type: type,</span>
<a href="#l23.3265"></a><span id="l23.3265" class="difflineminus">-			dataType: &quot;html&quot;,</span>
<a href="#l23.3266"></a><span id="l23.3266" class="difflineminus">-			data: params,</span>
<a href="#l23.3267"></a><span id="l23.3267" class="difflineminus">-			complete: function(res, status){</span>
<a href="#l23.3268"></a><span id="l23.3268" class="difflineminus">-				// If successful, inject the HTML into all the matched elements</span>
<a href="#l23.3269"></a><span id="l23.3269" class="difflineminus">-				if ( status == &quot;success&quot; || status == &quot;notmodified&quot; )</span>
<a href="#l23.3270"></a><span id="l23.3270" class="difflineminus">-					// See if a selector was specified</span>
<a href="#l23.3271"></a><span id="l23.3271" class="difflineminus">-					self.html( selector ?</span>
<a href="#l23.3272"></a><span id="l23.3272" class="difflineminus">-						// Create a dummy div to hold the results</span>
<a href="#l23.3273"></a><span id="l23.3273" class="difflineminus">-						jQuery(&quot;&lt;div/&gt;&quot;)</span>
<a href="#l23.3274"></a><span id="l23.3274" class="difflineminus">-							// inject the contents of the document in, removing the scripts</span>
<a href="#l23.3275"></a><span id="l23.3275" class="difflineminus">-							// to avoid any 'Permission Denied' errors in IE</span>
<a href="#l23.3276"></a><span id="l23.3276" class="difflineminus">-							.append(res.responseText.replace(/&lt;script(.|\s)*?\/script&gt;/g, &quot;&quot;))</span>
<a href="#l23.3277"></a><span id="l23.3277" class="difflineminus">-</span>
<a href="#l23.3278"></a><span id="l23.3278" class="difflineminus">-							// Locate the specified elements</span>
<a href="#l23.3279"></a><span id="l23.3279" class="difflineminus">-							.find(selector) :</span>
<a href="#l23.3280"></a><span id="l23.3280" class="difflineminus">-</span>
<a href="#l23.3281"></a><span id="l23.3281" class="difflineminus">-						// If not, just inject the full result</span>
<a href="#l23.3282"></a><span id="l23.3282" class="difflineminus">-						res.responseText );</span>
<a href="#l23.3283"></a><span id="l23.3283" class="difflineminus">-</span>
<a href="#l23.3284"></a><span id="l23.3284" class="difflineminus">-				if( callback )</span>
<a href="#l23.3285"></a><span id="l23.3285" class="difflineminus">-					self.each( callback, [res.responseText, status, res] );</span>
<a href="#l23.3286"></a><span id="l23.3286" class="difflineminus">-			}</span>
<a href="#l23.3287"></a><span id="l23.3287" class="difflineminus">-		});</span>
<a href="#l23.3288"></a><span id="l23.3288" class="difflineminus">-		return this;</span>
<a href="#l23.3289"></a><span id="l23.3289" class="difflineminus">-	},</span>
<a href="#l23.3290"></a><span id="l23.3290" class="difflineminus">-</span>
<a href="#l23.3291"></a><span id="l23.3291" class="difflineminus">-	serialize: function() {</span>
<a href="#l23.3292"></a><span id="l23.3292" class="difflineminus">-		return jQuery.param(this.serializeArray());</span>
<a href="#l23.3293"></a><span id="l23.3293" class="difflineminus">-	},</span>
<a href="#l23.3294"></a><span id="l23.3294" class="difflineminus">-	serializeArray: function() {</span>
<a href="#l23.3295"></a><span id="l23.3295" class="difflineminus">-		return this.map(function(){</span>
<a href="#l23.3296"></a><span id="l23.3296" class="difflineminus">-			return this.elements ? jQuery.makeArray(this.elements) : this;</span>
<a href="#l23.3297"></a><span id="l23.3297" class="difflineminus">-		})</span>
<a href="#l23.3298"></a><span id="l23.3298" class="difflineminus">-		.filter(function(){</span>
<a href="#l23.3299"></a><span id="l23.3299" class="difflineminus">-			return this.name &amp;&amp; !this.disabled &amp;&amp;</span>
<a href="#l23.3300"></a><span id="l23.3300" class="difflineminus">-				(this.checked || /select|textarea/i.test(this.nodeName) ||</span>
<a href="#l23.3301"></a><span id="l23.3301" class="difflineminus">-					/text|hidden|password|search/i.test(this.type));</span>
<a href="#l23.3302"></a><span id="l23.3302" class="difflineminus">-		})</span>
<a href="#l23.3303"></a><span id="l23.3303" class="difflineminus">-		.map(function(i, elem){</span>
<a href="#l23.3304"></a><span id="l23.3304" class="difflineminus">-			var val = jQuery(this).val();</span>
<a href="#l23.3305"></a><span id="l23.3305" class="difflineminus">-			return val == null ? null :</span>
<a href="#l23.3306"></a><span id="l23.3306" class="difflineminus">-				jQuery.isArray(val) ?</span>
<a href="#l23.3307"></a><span id="l23.3307" class="difflineminus">-					jQuery.map( val, function(val, i){</span>
<a href="#l23.3308"></a><span id="l23.3308" class="difflineminus">-						return {name: elem.name, value: val};</span>
<a href="#l23.3309"></a><span id="l23.3309" class="difflineminus">-					}) :</span>
<a href="#l23.3310"></a><span id="l23.3310" class="difflineminus">-					{name: elem.name, value: val};</span>
<a href="#l23.3311"></a><span id="l23.3311" class="difflineminus">-		}).get();</span>
<a href="#l23.3312"></a><span id="l23.3312" class="difflineminus">-	}</span>
<a href="#l23.3313"></a><span id="l23.3313" class="difflineminus">-});</span>
<a href="#l23.3314"></a><span id="l23.3314" class="difflineminus">-</span>
<a href="#l23.3315"></a><span id="l23.3315" class="difflineminus">-// Attach a bunch of functions for handling common AJAX events</span>
<a href="#l23.3316"></a><span id="l23.3316" class="difflineminus">-jQuery.each( &quot;ajaxStart,ajaxStop,ajaxComplete,ajaxError,ajaxSuccess,ajaxSend&quot;.split(&quot;,&quot;), function(i,o){</span>
<a href="#l23.3317"></a><span id="l23.3317" class="difflineminus">-	jQuery.fn[o] = function(f){</span>
<a href="#l23.3318"></a><span id="l23.3318" class="difflineminus">-		return this.bind(o, f);</span>
<a href="#l23.3319"></a><span id="l23.3319" class="difflineminus">-	};</span>
<a href="#l23.3320"></a><span id="l23.3320" class="difflineminus">-});</span>
<a href="#l23.3321"></a><span id="l23.3321" class="difflineminus">-</span>
<a href="#l23.3322"></a><span id="l23.3322" class="difflineminus">-var jsc = now();</span>
<a href="#l23.3323"></a><span id="l23.3323" class="difflineminus">-</span>
<a href="#l23.3324"></a><span id="l23.3324" class="difflineminus">-jQuery.extend({</span>
<a href="#l23.3325"></a><span id="l23.3325" class="difflineminus">-  </span>
<a href="#l23.3326"></a><span id="l23.3326" class="difflineminus">-	get: function( url, data, callback, type ) {</span>
<a href="#l23.3327"></a><span id="l23.3327" class="difflineminus">-		// shift arguments if data argument was ommited</span>
<a href="#l23.3328"></a><span id="l23.3328" class="difflineminus">-		if ( jQuery.isFunction( data ) ) {</span>
<a href="#l23.3329"></a><span id="l23.3329" class="difflineminus">-			callback = data;</span>
<a href="#l23.3330"></a><span id="l23.3330" class="difflineminus">-			data = null;</span>
<a href="#l23.3331"></a><span id="l23.3331" class="difflineminus">-		}</span>
<a href="#l23.3332"></a><span id="l23.3332" class="difflineminus">-</span>
<a href="#l23.3333"></a><span id="l23.3333" class="difflineminus">-		return jQuery.ajax({</span>
<a href="#l23.3334"></a><span id="l23.3334" class="difflineminus">-			type: &quot;GET&quot;,</span>
<a href="#l23.3335"></a><span id="l23.3335" class="difflineminus">-			url: url,</span>
<a href="#l23.3336"></a><span id="l23.3336" class="difflineminus">-			data: data,</span>
<a href="#l23.3337"></a><span id="l23.3337" class="difflineminus">-			success: callback,</span>
<a href="#l23.3338"></a><span id="l23.3338" class="difflineminus">-			dataType: type</span>
<a href="#l23.3339"></a><span id="l23.3339" class="difflineminus">-		});</span>
<a href="#l23.3340"></a><span id="l23.3340" class="difflineminus">-	},</span>
<a href="#l23.3341"></a><span id="l23.3341" class="difflineminus">-</span>
<a href="#l23.3342"></a><span id="l23.3342" class="difflineminus">-	getScript: function( url, callback ) {</span>
<a href="#l23.3343"></a><span id="l23.3343" class="difflineminus">-		return jQuery.get(url, null, callback, &quot;script&quot;);</span>
<a href="#l23.3344"></a><span id="l23.3344" class="difflineminus">-	},</span>
<a href="#l23.3345"></a><span id="l23.3345" class="difflineminus">-</span>
<a href="#l23.3346"></a><span id="l23.3346" class="difflineminus">-	getJSON: function( url, data, callback ) {</span>
<a href="#l23.3347"></a><span id="l23.3347" class="difflineminus">-		return jQuery.get(url, data, callback, &quot;json&quot;);</span>
<a href="#l23.3348"></a><span id="l23.3348" class="difflineminus">-	},</span>
<a href="#l23.3349"></a><span id="l23.3349" class="difflineminus">-</span>
<a href="#l23.3350"></a><span id="l23.3350" class="difflineminus">-	post: function( url, data, callback, type ) {</span>
<a href="#l23.3351"></a><span id="l23.3351" class="difflineminus">-		if ( jQuery.isFunction( data ) ) {</span>
<a href="#l23.3352"></a><span id="l23.3352" class="difflineminus">-			callback = data;</span>
<a href="#l23.3353"></a><span id="l23.3353" class="difflineminus">-			data = {};</span>
<a href="#l23.3354"></a><span id="l23.3354" class="difflineminus">-		}</span>
<a href="#l23.3355"></a><span id="l23.3355" class="difflineminus">-</span>
<a href="#l23.3356"></a><span id="l23.3356" class="difflineminus">-		return jQuery.ajax({</span>
<a href="#l23.3357"></a><span id="l23.3357" class="difflineminus">-			type: &quot;POST&quot;,</span>
<a href="#l23.3358"></a><span id="l23.3358" class="difflineminus">-			url: url,</span>
<a href="#l23.3359"></a><span id="l23.3359" class="difflineminus">-			data: data,</span>
<a href="#l23.3360"></a><span id="l23.3360" class="difflineminus">-			success: callback,</span>
<a href="#l23.3361"></a><span id="l23.3361" class="difflineminus">-			dataType: type</span>
<a href="#l23.3362"></a><span id="l23.3362" class="difflineminus">-		});</span>
<a href="#l23.3363"></a><span id="l23.3363" class="difflineminus">-	},</span>
<a href="#l23.3364"></a><span id="l23.3364" class="difflineminus">-</span>
<a href="#l23.3365"></a><span id="l23.3365" class="difflineminus">-	ajaxSetup: function( settings ) {</span>
<a href="#l23.3366"></a><span id="l23.3366" class="difflineminus">-		jQuery.extend( jQuery.ajaxSettings, settings );</span>
<a href="#l23.3367"></a><span id="l23.3367" class="difflineminus">-	},</span>
<a href="#l23.3368"></a><span id="l23.3368" class="difflineminus">-</span>
<a href="#l23.3369"></a><span id="l23.3369" class="difflineminus">-	ajaxSettings: {</span>
<a href="#l23.3370"></a><span id="l23.3370" class="difflineminus">-		url: location.href,</span>
<a href="#l23.3371"></a><span id="l23.3371" class="difflineminus">-		global: true,</span>
<a href="#l23.3372"></a><span id="l23.3372" class="difflineminus">-		type: &quot;GET&quot;,</span>
<a href="#l23.3373"></a><span id="l23.3373" class="difflineminus">-		contentType: &quot;application/x-www-form-urlencoded&quot;,</span>
<a href="#l23.3374"></a><span id="l23.3374" class="difflineminus">-		processData: true,</span>
<a href="#l23.3375"></a><span id="l23.3375" class="difflineminus">-		async: true,</span>
<a href="#l23.3376"></a><span id="l23.3376" class="difflineminus">-		/*</span>
<a href="#l23.3377"></a><span id="l23.3377" class="difflineminus">-		timeout: 0,</span>
<a href="#l23.3378"></a><span id="l23.3378" class="difflineminus">-		data: null,</span>
<a href="#l23.3379"></a><span id="l23.3379" class="difflineminus">-		username: null,</span>
<a href="#l23.3380"></a><span id="l23.3380" class="difflineminus">-		password: null,</span>
<a href="#l23.3381"></a><span id="l23.3381" class="difflineminus">-		*/</span>
<a href="#l23.3382"></a><span id="l23.3382" class="difflineminus">-		// Create the request object; Microsoft failed to properly</span>
<a href="#l23.3383"></a><span id="l23.3383" class="difflineminus">-		// implement the XMLHttpRequest in IE7, so we use the ActiveXObject when it is available</span>
<a href="#l23.3384"></a><span id="l23.3384" class="difflineminus">-		// This function can be overriden by calling jQuery.ajaxSetup</span>
<a href="#l23.3385"></a><span id="l23.3385" class="difflineminus">-		xhr:function(){</span>
<a href="#l23.3386"></a><span id="l23.3386" class="difflineminus">-			return window.ActiveXObject ? new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;) : new XMLHttpRequest();</span>
<a href="#l23.3387"></a><span id="l23.3387" class="difflineminus">-		},</span>
<a href="#l23.3388"></a><span id="l23.3388" class="difflineminus">-		accepts: {</span>
<a href="#l23.3389"></a><span id="l23.3389" class="difflineminus">-			xml: &quot;application/xml, text/xml&quot;,</span>
<a href="#l23.3390"></a><span id="l23.3390" class="difflineminus">-			html: &quot;text/html&quot;,</span>
<a href="#l23.3391"></a><span id="l23.3391" class="difflineminus">-			script: &quot;text/javascript, application/javascript&quot;,</span>
<a href="#l23.3392"></a><span id="l23.3392" class="difflineminus">-			json: &quot;application/json, text/javascript&quot;,</span>
<a href="#l23.3393"></a><span id="l23.3393" class="difflineminus">-			text: &quot;text/plain&quot;,</span>
<a href="#l23.3394"></a><span id="l23.3394" class="difflineminus">-			_default: &quot;*/*&quot;</span>
<a href="#l23.3395"></a><span id="l23.3395" class="difflineminus">-		}</span>
<a href="#l23.3396"></a><span id="l23.3396" class="difflineminus">-	},</span>
<a href="#l23.3397"></a><span id="l23.3397" class="difflineminus">-</span>
<a href="#l23.3398"></a><span id="l23.3398" class="difflineminus">-	// Last-Modified header cache for next request</span>
<a href="#l23.3399"></a><span id="l23.3399" class="difflineminus">-	lastModified: {},</span>
<a href="#l23.3400"></a><span id="l23.3400" class="difflineminus">-</span>
<a href="#l23.3401"></a><span id="l23.3401" class="difflineminus">-	ajax: function( s ) {</span>
<a href="#l23.3402"></a><span id="l23.3402" class="difflineminus">-		// Extend the settings, but re-extend 's' so that it can be</span>
<a href="#l23.3403"></a><span id="l23.3403" class="difflineminus">-		// checked again later (in the test suite, specifically)</span>
<a href="#l23.3404"></a><span id="l23.3404" class="difflineminus">-		s = jQuery.extend(true, s, jQuery.extend(true, {}, jQuery.ajaxSettings, s));</span>
<a href="#l23.3405"></a><span id="l23.3405" class="difflineminus">-</span>
<a href="#l23.3406"></a><span id="l23.3406" class="difflineminus">-		var jsonp, jsre = /=\?(&amp;|$)/g, status, data,</span>
<a href="#l23.3407"></a><span id="l23.3407" class="difflineminus">-			type = s.type.toUpperCase();</span>
<a href="#l23.3408"></a><span id="l23.3408" class="difflineminus">-</span>
<a href="#l23.3409"></a><span id="l23.3409" class="difflineminus">-		// convert data if not already a string</span>
<a href="#l23.3410"></a><span id="l23.3410" class="difflineminus">-		if ( s.data &amp;&amp; s.processData &amp;&amp; typeof s.data !== &quot;string&quot; )</span>
<a href="#l23.3411"></a><span id="l23.3411" class="difflineminus">-			s.data = jQuery.param(s.data);</span>
<a href="#l23.3412"></a><span id="l23.3412" class="difflineminus">-</span>
<a href="#l23.3413"></a><span id="l23.3413" class="difflineminus">-		// Handle JSONP Parameter Callbacks</span>
<a href="#l23.3414"></a><span id="l23.3414" class="difflineminus">-		if ( s.dataType == &quot;jsonp&quot; ) {</span>
<a href="#l23.3415"></a><span id="l23.3415" class="difflineminus">-			if ( type == &quot;GET&quot; ) {</span>
<a href="#l23.3416"></a><span id="l23.3416" class="difflineminus">-				if ( !s.url.match(jsre) )</span>
<a href="#l23.3417"></a><span id="l23.3417" class="difflineminus">-					s.url += (s.url.match(/\?/) ? &quot;&amp;&quot; : &quot;?&quot;) + (s.jsonp || &quot;callback&quot;) + &quot;=?&quot;;</span>
<a href="#l23.3418"></a><span id="l23.3418" class="difflineminus">-			} else if ( !s.data || !s.data.match(jsre) )</span>
<a href="#l23.3419"></a><span id="l23.3419" class="difflineminus">-				s.data = (s.data ? s.data + &quot;&amp;&quot; : &quot;&quot;) + (s.jsonp || &quot;callback&quot;) + &quot;=?&quot;;</span>
<a href="#l23.3420"></a><span id="l23.3420" class="difflineminus">-			s.dataType = &quot;json&quot;;</span>
<a href="#l23.3421"></a><span id="l23.3421" class="difflineminus">-		}</span>
<a href="#l23.3422"></a><span id="l23.3422" class="difflineminus">-</span>
<a href="#l23.3423"></a><span id="l23.3423" class="difflineminus">-		// Build temporary JSONP function</span>
<a href="#l23.3424"></a><span id="l23.3424" class="difflineminus">-		if ( s.dataType == &quot;json&quot; &amp;&amp; (s.data &amp;&amp; s.data.match(jsre) || s.url.match(jsre)) ) {</span>
<a href="#l23.3425"></a><span id="l23.3425" class="difflineminus">-			jsonp = &quot;jsonp&quot; + jsc++;</span>
<a href="#l23.3426"></a><span id="l23.3426" class="difflineminus">-</span>
<a href="#l23.3427"></a><span id="l23.3427" class="difflineminus">-			// Replace the =? sequence both in the query string and the data</span>
<a href="#l23.3428"></a><span id="l23.3428" class="difflineminus">-			if ( s.data )</span>
<a href="#l23.3429"></a><span id="l23.3429" class="difflineminus">-				s.data = (s.data + &quot;&quot;).replace(jsre, &quot;=&quot; + jsonp + &quot;$1&quot;);</span>
<a href="#l23.3430"></a><span id="l23.3430" class="difflineminus">-			s.url = s.url.replace(jsre, &quot;=&quot; + jsonp + &quot;$1&quot;);</span>
<a href="#l23.3431"></a><span id="l23.3431" class="difflineminus">-</span>
<a href="#l23.3432"></a><span id="l23.3432" class="difflineminus">-			// We need to make sure</span>
<a href="#l23.3433"></a><span id="l23.3433" class="difflineminus">-			// that a JSONP style response is executed properly</span>
<a href="#l23.3434"></a><span id="l23.3434" class="difflineminus">-			s.dataType = &quot;script&quot;;</span>
<a href="#l23.3435"></a><span id="l23.3435" class="difflineminus">-</span>
<a href="#l23.3436"></a><span id="l23.3436" class="difflineminus">-			// Handle JSONP-style loading</span>
<a href="#l23.3437"></a><span id="l23.3437" class="difflineminus">-			window[ jsonp ] = function(tmp){</span>
<a href="#l23.3438"></a><span id="l23.3438" class="difflineminus">-				data = tmp;</span>
<a href="#l23.3439"></a><span id="l23.3439" class="difflineminus">-				success();</span>
<a href="#l23.3440"></a><span id="l23.3440" class="difflineminus">-				complete();</span>
<a href="#l23.3441"></a><span id="l23.3441" class="difflineminus">-				// Garbage collect</span>
<a href="#l23.3442"></a><span id="l23.3442" class="difflineminus">-				window[ jsonp ] = undefined;</span>
<a href="#l23.3443"></a><span id="l23.3443" class="difflineminus">-				try{ delete window[ jsonp ]; } catch(e){}</span>
<a href="#l23.3444"></a><span id="l23.3444" class="difflineminus">-				if ( head )</span>
<a href="#l23.3445"></a><span id="l23.3445" class="difflineminus">-					head.removeChild( script );</span>
<a href="#l23.3446"></a><span id="l23.3446" class="difflineminus">-			};</span>
<a href="#l23.3447"></a><span id="l23.3447" class="difflineminus">-		}</span>
<a href="#l23.3448"></a><span id="l23.3448" class="difflineminus">-</span>
<a href="#l23.3449"></a><span id="l23.3449" class="difflineminus">-		if ( s.dataType == &quot;script&quot; &amp;&amp; s.cache == null )</span>
<a href="#l23.3450"></a><span id="l23.3450" class="difflineminus">-			s.cache = false;</span>
<a href="#l23.3451"></a><span id="l23.3451" class="difflineminus">-</span>
<a href="#l23.3452"></a><span id="l23.3452" class="difflineminus">-		if ( s.cache === false &amp;&amp; type == &quot;GET&quot; ) {</span>
<a href="#l23.3453"></a><span id="l23.3453" class="difflineminus">-			var ts = now();</span>
<a href="#l23.3454"></a><span id="l23.3454" class="difflineminus">-			// try replacing _= if it is there</span>
<a href="#l23.3455"></a><span id="l23.3455" class="difflineminus">-			var ret = s.url.replace(/(\?|&amp;)_=.*?(&amp;|$)/, &quot;$1_=&quot; + ts + &quot;$2&quot;);</span>
<a href="#l23.3456"></a><span id="l23.3456" class="difflineminus">-			// if nothing was replaced, add timestamp to the end</span>
<a href="#l23.3457"></a><span id="l23.3457" class="difflineminus">-			s.url = ret + ((ret == s.url) ? (s.url.match(/\?/) ? &quot;&amp;&quot; : &quot;?&quot;) + &quot;_=&quot; + ts : &quot;&quot;);</span>
<a href="#l23.3458"></a><span id="l23.3458" class="difflineminus">-		}</span>
<a href="#l23.3459"></a><span id="l23.3459" class="difflineminus">-</span>
<a href="#l23.3460"></a><span id="l23.3460" class="difflineminus">-		// If data is available, append data to url for get requests</span>
<a href="#l23.3461"></a><span id="l23.3461" class="difflineminus">-		if ( s.data &amp;&amp; type == &quot;GET&quot; ) {</span>
<a href="#l23.3462"></a><span id="l23.3462" class="difflineminus">-			s.url += (s.url.match(/\?/) ? &quot;&amp;&quot; : &quot;?&quot;) + s.data;</span>
<a href="#l23.3463"></a><span id="l23.3463" class="difflineminus">-</span>
<a href="#l23.3464"></a><span id="l23.3464" class="difflineminus">-			// IE likes to send both get and post data, prevent this</span>
<a href="#l23.3465"></a><span id="l23.3465" class="difflineminus">-			s.data = null;</span>
<a href="#l23.3466"></a><span id="l23.3466" class="difflineminus">-		}</span>
<a href="#l23.3467"></a><span id="l23.3467" class="difflineminus">-</span>
<a href="#l23.3468"></a><span id="l23.3468" class="difflineminus">-		// Watch for a new set of requests</span>
<a href="#l23.3469"></a><span id="l23.3469" class="difflineminus">-		if ( s.global &amp;&amp; ! jQuery.active++ )</span>
<a href="#l23.3470"></a><span id="l23.3470" class="difflineminus">-			jQuery.event.trigger( &quot;ajaxStart&quot; );</span>
<a href="#l23.3471"></a><span id="l23.3471" class="difflineminus">-</span>
<a href="#l23.3472"></a><span id="l23.3472" class="difflineminus">-		// Matches an absolute URL, and saves the domain</span>
<a href="#l23.3473"></a><span id="l23.3473" class="difflineminus">-		var parts = /^(\w+:)?\/\/([^\/?#]+)/.exec( s.url );</span>
<a href="#l23.3474"></a><span id="l23.3474" class="difflineminus">-</span>
<a href="#l23.3475"></a><span id="l23.3475" class="difflineminus">-		// If we're requesting a remote document</span>
<a href="#l23.3476"></a><span id="l23.3476" class="difflineminus">-		// and trying to load JSON or Script with a GET</span>
<a href="#l23.3477"></a><span id="l23.3477" class="difflineminus">-		if ( s.dataType == &quot;script&quot; &amp;&amp; type == &quot;GET&quot; &amp;&amp; parts</span>
<a href="#l23.3478"></a><span id="l23.3478" class="difflineminus">-			&amp;&amp; ( parts[1] &amp;&amp; parts[1] != location.protocol || parts[2] != location.host )){</span>
<a href="#l23.3479"></a><span id="l23.3479" class="difflineminus">-</span>
<a href="#l23.3480"></a><span id="l23.3480" class="difflineminus">-			var head = document.getElementsByTagName(&quot;head&quot;)[0];</span>
<a href="#l23.3481"></a><span id="l23.3481" class="difflineminus">-			var script = document.createElement(&quot;script&quot;);</span>
<a href="#l23.3482"></a><span id="l23.3482" class="difflineminus">-			script.src = s.url;</span>
<a href="#l23.3483"></a><span id="l23.3483" class="difflineminus">-			if (s.scriptCharset)</span>
<a href="#l23.3484"></a><span id="l23.3484" class="difflineminus">-				script.charset = s.scriptCharset;</span>
<a href="#l23.3485"></a><span id="l23.3485" class="difflineminus">-</span>
<a href="#l23.3486"></a><span id="l23.3486" class="difflineminus">-			// Handle Script loading</span>
<a href="#l23.3487"></a><span id="l23.3487" class="difflineminus">-			if ( !jsonp ) {</span>
<a href="#l23.3488"></a><span id="l23.3488" class="difflineminus">-				var done = false;</span>
<a href="#l23.3489"></a><span id="l23.3489" class="difflineminus">-</span>
<a href="#l23.3490"></a><span id="l23.3490" class="difflineminus">-				// Attach handlers for all browsers</span>
<a href="#l23.3491"></a><span id="l23.3491" class="difflineminus">-				script.onload = script.onreadystatechange = function(){</span>
<a href="#l23.3492"></a><span id="l23.3492" class="difflineminus">-					if ( !done &amp;&amp; (!this.readyState ||</span>
<a href="#l23.3493"></a><span id="l23.3493" class="difflineminus">-							this.readyState == &quot;loaded&quot; || this.readyState == &quot;complete&quot;) ) {</span>
<a href="#l23.3494"></a><span id="l23.3494" class="difflineminus">-						done = true;</span>
<a href="#l23.3495"></a><span id="l23.3495" class="difflineminus">-						success();</span>
<a href="#l23.3496"></a><span id="l23.3496" class="difflineminus">-						complete();</span>
<a href="#l23.3497"></a><span id="l23.3497" class="difflineminus">-</span>
<a href="#l23.3498"></a><span id="l23.3498" class="difflineminus">-						// Handle memory leak in IE</span>
<a href="#l23.3499"></a><span id="l23.3499" class="difflineminus">-						script.onload = script.onreadystatechange = null;</span>
<a href="#l23.3500"></a><span id="l23.3500" class="difflineminus">-						head.removeChild( script );</span>
<a href="#l23.3501"></a><span id="l23.3501" class="difflineminus">-					}</span>
<a href="#l23.3502"></a><span id="l23.3502" class="difflineminus">-				};</span>
<a href="#l23.3503"></a><span id="l23.3503" class="difflineminus">-			}</span>
<a href="#l23.3504"></a><span id="l23.3504" class="difflineminus">-</span>
<a href="#l23.3505"></a><span id="l23.3505" class="difflineminus">-			head.appendChild(script);</span>
<a href="#l23.3506"></a><span id="l23.3506" class="difflineminus">-</span>
<a href="#l23.3507"></a><span id="l23.3507" class="difflineminus">-			// We handle everything using the script element injection</span>
<a href="#l23.3508"></a><span id="l23.3508" class="difflineminus">-			return undefined;</span>
<a href="#l23.3509"></a><span id="l23.3509" class="difflineminus">-		}</span>
<a href="#l23.3510"></a><span id="l23.3510" class="difflineminus">-</span>
<a href="#l23.3511"></a><span id="l23.3511" class="difflineminus">-		var requestDone = false;</span>
<a href="#l23.3512"></a><span id="l23.3512" class="difflineminus">-</span>
<a href="#l23.3513"></a><span id="l23.3513" class="difflineminus">-		// Create the request object</span>
<a href="#l23.3514"></a><span id="l23.3514" class="difflineminus">-		var xhr = s.xhr();</span>
<a href="#l23.3515"></a><span id="l23.3515" class="difflineminus">-</span>
<a href="#l23.3516"></a><span id="l23.3516" class="difflineminus">-		// Open the socket</span>
<a href="#l23.3517"></a><span id="l23.3517" class="difflineminus">-		// Passing null username, generates a login popup on Opera (#2865)</span>
<a href="#l23.3518"></a><span id="l23.3518" class="difflineminus">-		if( s.username )</span>
<a href="#l23.3519"></a><span id="l23.3519" class="difflineminus">-			xhr.open(type, s.url, s.async, s.username, s.password);</span>
<a href="#l23.3520"></a><span id="l23.3520" class="difflineminus">-		else</span>
<a href="#l23.3521"></a><span id="l23.3521" class="difflineminus">-			xhr.open(type, s.url, s.async);</span>
<a href="#l23.3522"></a><span id="l23.3522" class="difflineminus">-</span>
<a href="#l23.3523"></a><span id="l23.3523" class="difflineminus">-		// Need an extra try/catch for cross domain requests in Firefox 3</span>
<a href="#l23.3524"></a><span id="l23.3524" class="difflineminus">-		try {</span>
<a href="#l23.3525"></a><span id="l23.3525" class="difflineminus">-			// Set the correct header, if data is being sent</span>
<a href="#l23.3526"></a><span id="l23.3526" class="difflineminus">-			if ( s.data )</span>
<a href="#l23.3527"></a><span id="l23.3527" class="difflineminus">-				xhr.setRequestHeader(&quot;Content-Type&quot;, s.contentType);</span>
<a href="#l23.3528"></a><span id="l23.3528" class="difflineminus">-</span>
<a href="#l23.3529"></a><span id="l23.3529" class="difflineminus">-			// Set the If-Modified-Since header, if ifModified mode.</span>
<a href="#l23.3530"></a><span id="l23.3530" class="difflineminus">-			if ( s.ifModified )</span>
<a href="#l23.3531"></a><span id="l23.3531" class="difflineminus">-				xhr.setRequestHeader(&quot;If-Modified-Since&quot;,</span>
<a href="#l23.3532"></a><span id="l23.3532" class="difflineminus">-					jQuery.lastModified[s.url] || &quot;Thu, 01 Jan 1970 00:00:00 GMT&quot; );</span>
<a href="#l23.3533"></a><span id="l23.3533" class="difflineminus">-</span>
<a href="#l23.3534"></a><span id="l23.3534" class="difflineminus">-			// Set header so the called script knows that it's an XMLHttpRequest</span>
<a href="#l23.3535"></a><span id="l23.3535" class="difflineminus">-			xhr.setRequestHeader(&quot;X-Requested-With&quot;, &quot;XMLHttpRequest&quot;);</span>
<a href="#l23.3536"></a><span id="l23.3536" class="difflineminus">-</span>
<a href="#l23.3537"></a><span id="l23.3537" class="difflineminus">-			// Set the Accepts header for the server, depending on the dataType</span>
<a href="#l23.3538"></a><span id="l23.3538" class="difflineminus">-			xhr.setRequestHeader(&quot;Accept&quot;, s.dataType &amp;&amp; s.accepts[ s.dataType ] ?</span>
<a href="#l23.3539"></a><span id="l23.3539" class="difflineminus">-				s.accepts[ s.dataType ] + &quot;, */*&quot; :</span>
<a href="#l23.3540"></a><span id="l23.3540" class="difflineminus">-				s.accepts._default );</span>
<a href="#l23.3541"></a><span id="l23.3541" class="difflineminus">-		} catch(e){}</span>
<a href="#l23.3542"></a><span id="l23.3542" class="difflineminus">-</span>
<a href="#l23.3543"></a><span id="l23.3543" class="difflineminus">-		// Allow custom headers/mimetypes and early abort</span>
<a href="#l23.3544"></a><span id="l23.3544" class="difflineminus">-		if ( s.beforeSend &amp;&amp; s.beforeSend(xhr, s) === false ) {</span>
<a href="#l23.3545"></a><span id="l23.3545" class="difflineminus">-			// Handle the global AJAX counter</span>
<a href="#l23.3546"></a><span id="l23.3546" class="difflineminus">-			if ( s.global &amp;&amp; ! --jQuery.active )</span>
<a href="#l23.3547"></a><span id="l23.3547" class="difflineminus">-				jQuery.event.trigger( &quot;ajaxStop&quot; );</span>
<a href="#l23.3548"></a><span id="l23.3548" class="difflineminus">-			// close opended socket</span>
<a href="#l23.3549"></a><span id="l23.3549" class="difflineminus">-			xhr.abort();</span>
<a href="#l23.3550"></a><span id="l23.3550" class="difflineminus">-			return false;</span>
<a href="#l23.3551"></a><span id="l23.3551" class="difflineminus">-		}</span>
<a href="#l23.3552"></a><span id="l23.3552" class="difflineminus">-</span>
<a href="#l23.3553"></a><span id="l23.3553" class="difflineminus">-		if ( s.global )</span>
<a href="#l23.3554"></a><span id="l23.3554" class="difflineminus">-			jQuery.event.trigger(&quot;ajaxSend&quot;, [xhr, s]);</span>
<a href="#l23.3555"></a><span id="l23.3555" class="difflineminus">-</span>
<a href="#l23.3556"></a><span id="l23.3556" class="difflineminus">-		// Wait for a response to come back</span>
<a href="#l23.3557"></a><span id="l23.3557" class="difflineminus">-		var onreadystatechange = function(isTimeout){</span>
<a href="#l23.3558"></a><span id="l23.3558" class="difflineminus">-			// The request was aborted, clear the interval and decrement jQuery.active</span>
<a href="#l23.3559"></a><span id="l23.3559" class="difflineminus">-			if (xhr.readyState == 0) {</span>
<a href="#l23.3560"></a><span id="l23.3560" class="difflineminus">-				if (ival) {</span>
<a href="#l23.3561"></a><span id="l23.3561" class="difflineminus">-					// clear poll interval</span>
<a href="#l23.3562"></a><span id="l23.3562" class="difflineminus">-					clearInterval(ival);</span>
<a href="#l23.3563"></a><span id="l23.3563" class="difflineminus">-					ival = null;</span>
<a href="#l23.3564"></a><span id="l23.3564" class="difflineminus">-					// Handle the global AJAX counter</span>
<a href="#l23.3565"></a><span id="l23.3565" class="difflineminus">-					if ( s.global &amp;&amp; ! --jQuery.active )</span>
<a href="#l23.3566"></a><span id="l23.3566" class="difflineminus">-						jQuery.event.trigger( &quot;ajaxStop&quot; );</span>
<a href="#l23.3567"></a><span id="l23.3567" class="difflineminus">-				}</span>
<a href="#l23.3568"></a><span id="l23.3568" class="difflineminus">-			// The transfer is complete and the data is available, or the request timed out</span>
<a href="#l23.3569"></a><span id="l23.3569" class="difflineminus">-			} else if ( !requestDone &amp;&amp; xhr &amp;&amp; (xhr.readyState == 4 || isTimeout == &quot;timeout&quot;) ) {</span>
<a href="#l23.3570"></a><span id="l23.3570" class="difflineminus">-				requestDone = true;</span>
<a href="#l23.3571"></a><span id="l23.3571" class="difflineminus">-</span>
<a href="#l23.3572"></a><span id="l23.3572" class="difflineminus">-				// clear poll interval</span>
<a href="#l23.3573"></a><span id="l23.3573" class="difflineminus">-				if (ival) {</span>
<a href="#l23.3574"></a><span id="l23.3574" class="difflineminus">-					clearInterval(ival);</span>
<a href="#l23.3575"></a><span id="l23.3575" class="difflineminus">-					ival = null;</span>
<a href="#l23.3576"></a><span id="l23.3576" class="difflineminus">-				}</span>
<a href="#l23.3577"></a><span id="l23.3577" class="difflineminus">-</span>
<a href="#l23.3578"></a><span id="l23.3578" class="difflineminus">-				status = isTimeout == &quot;timeout&quot; ? &quot;timeout&quot; :</span>
<a href="#l23.3579"></a><span id="l23.3579" class="difflineminus">-					!jQuery.httpSuccess( xhr ) ? &quot;error&quot; :</span>
<a href="#l23.3580"></a><span id="l23.3580" class="difflineminus">-					s.ifModified &amp;&amp; jQuery.httpNotModified( xhr, s.url ) ? &quot;notmodified&quot; :</span>
<a href="#l23.3581"></a><span id="l23.3581" class="difflineminus">-					&quot;success&quot;;</span>
<a href="#l23.3582"></a><span id="l23.3582" class="difflineminus">-</span>
<a href="#l23.3583"></a><span id="l23.3583" class="difflineminus">-				if ( status == &quot;success&quot; ) {</span>
<a href="#l23.3584"></a><span id="l23.3584" class="difflineminus">-					// Watch for, and catch, XML document parse errors</span>
<a href="#l23.3585"></a><span id="l23.3585" class="difflineminus">-					try {</span>
<a href="#l23.3586"></a><span id="l23.3586" class="difflineminus">-						// process the data (runs the xml through httpData regardless of callback)</span>
<a href="#l23.3587"></a><span id="l23.3587" class="difflineminus">-						data = jQuery.httpData( xhr, s.dataType, s );</span>
<a href="#l23.3588"></a><span id="l23.3588" class="difflineminus">-					} catch(e) {</span>
<a href="#l23.3589"></a><span id="l23.3589" class="difflineminus">-						status = &quot;parsererror&quot;;</span>
<a href="#l23.3590"></a><span id="l23.3590" class="difflineminus">-					}</span>
<a href="#l23.3591"></a><span id="l23.3591" class="difflineminus">-				}</span>
<a href="#l23.3592"></a><span id="l23.3592" class="difflineminus">-</span>
<a href="#l23.3593"></a><span id="l23.3593" class="difflineminus">-				// Make sure that the request was successful or notmodified</span>
<a href="#l23.3594"></a><span id="l23.3594" class="difflineminus">-				if ( status == &quot;success&quot; ) {</span>
<a href="#l23.3595"></a><span id="l23.3595" class="difflineminus">-					// Cache Last-Modified header, if ifModified mode.</span>
<a href="#l23.3596"></a><span id="l23.3596" class="difflineminus">-					var modRes;</span>
<a href="#l23.3597"></a><span id="l23.3597" class="difflineminus">-					try {</span>
<a href="#l23.3598"></a><span id="l23.3598" class="difflineminus">-						modRes = xhr.getResponseHeader(&quot;Last-Modified&quot;);</span>
<a href="#l23.3599"></a><span id="l23.3599" class="difflineminus">-					} catch(e) {} // swallow exception thrown by FF if header is not available</span>
<a href="#l23.3600"></a><span id="l23.3600" class="difflineminus">-</span>
<a href="#l23.3601"></a><span id="l23.3601" class="difflineminus">-					if ( s.ifModified &amp;&amp; modRes )</span>
<a href="#l23.3602"></a><span id="l23.3602" class="difflineminus">-						jQuery.lastModified[s.url] = modRes;</span>
<a href="#l23.3603"></a><span id="l23.3603" class="difflineminus">-</span>
<a href="#l23.3604"></a><span id="l23.3604" class="difflineminus">-					// JSONP handles its own success callback</span>
<a href="#l23.3605"></a><span id="l23.3605" class="difflineminus">-					if ( !jsonp )</span>
<a href="#l23.3606"></a><span id="l23.3606" class="difflineminus">-						success();</span>
<a href="#l23.3607"></a><span id="l23.3607" class="difflineminus">-				} else</span>
<a href="#l23.3608"></a><span id="l23.3608" class="difflineminus">-					jQuery.handleError(s, xhr, status);</span>
<a href="#l23.3609"></a><span id="l23.3609" class="difflineminus">-</span>
<a href="#l23.3610"></a><span id="l23.3610" class="difflineminus">-				// Fire the complete handlers</span>
<a href="#l23.3611"></a><span id="l23.3611" class="difflineminus">-				complete();</span>
<a href="#l23.3612"></a><span id="l23.3612" class="difflineminus">-</span>
<a href="#l23.3613"></a><span id="l23.3613" class="difflineminus">-				if ( isTimeout )</span>
<a href="#l23.3614"></a><span id="l23.3614" class="difflineminus">-					xhr.abort();</span>
<a href="#l23.3615"></a><span id="l23.3615" class="difflineminus">-</span>
<a href="#l23.3616"></a><span id="l23.3616" class="difflineminus">-				// Stop memory leaks</span>
<a href="#l23.3617"></a><span id="l23.3617" class="difflineminus">-				if ( s.async )</span>
<a href="#l23.3618"></a><span id="l23.3618" class="difflineminus">-					xhr = null;</span>
<a href="#l23.3619"></a><span id="l23.3619" class="difflineminus">-			}</span>
<a href="#l23.3620"></a><span id="l23.3620" class="difflineminus">-		};</span>
<a href="#l23.3621"></a><span id="l23.3621" class="difflineminus">-</span>
<a href="#l23.3622"></a><span id="l23.3622" class="difflineminus">-		if ( s.async ) {</span>
<a href="#l23.3623"></a><span id="l23.3623" class="difflineminus">-			// don't attach the handler to the request, just poll it instead</span>
<a href="#l23.3624"></a><span id="l23.3624" class="difflineminus">-			var ival = setInterval(onreadystatechange, 13);</span>
<a href="#l23.3625"></a><span id="l23.3625" class="difflineminus">-</span>
<a href="#l23.3626"></a><span id="l23.3626" class="difflineminus">-			// Timeout checker</span>
<a href="#l23.3627"></a><span id="l23.3627" class="difflineminus">-			if ( s.timeout &gt; 0 )</span>
<a href="#l23.3628"></a><span id="l23.3628" class="difflineminus">-				setTimeout(function(){</span>
<a href="#l23.3629"></a><span id="l23.3629" class="difflineminus">-					// Check to see if the request is still happening</span>
<a href="#l23.3630"></a><span id="l23.3630" class="difflineminus">-					if ( xhr &amp;&amp; !requestDone )</span>
<a href="#l23.3631"></a><span id="l23.3631" class="difflineminus">-						onreadystatechange( &quot;timeout&quot; );</span>
<a href="#l23.3632"></a><span id="l23.3632" class="difflineminus">-				}, s.timeout);</span>
<a href="#l23.3633"></a><span id="l23.3633" class="difflineminus">-		}</span>
<a href="#l23.3634"></a><span id="l23.3634" class="difflineminus">-</span>
<a href="#l23.3635"></a><span id="l23.3635" class="difflineminus">-		// Send the data</span>
<a href="#l23.3636"></a><span id="l23.3636" class="difflineminus">-		try {</span>
<a href="#l23.3637"></a><span id="l23.3637" class="difflineminus">-			xhr.send(s.data);</span>
<a href="#l23.3638"></a><span id="l23.3638" class="difflineminus">-		} catch(e) {</span>
<a href="#l23.3639"></a><span id="l23.3639" class="difflineminus">-			jQuery.handleError(s, xhr, null, e);</span>
<a href="#l23.3640"></a><span id="l23.3640" class="difflineminus">-		}</span>
<a href="#l23.3641"></a><span id="l23.3641" class="difflineminus">-</span>
<a href="#l23.3642"></a><span id="l23.3642" class="difflineminus">-		// firefox 1.5 doesn't fire statechange for sync requests</span>
<a href="#l23.3643"></a><span id="l23.3643" class="difflineminus">-		if ( !s.async )</span>
<a href="#l23.3644"></a><span id="l23.3644" class="difflineminus">-			onreadystatechange();</span>
<a href="#l23.3645"></a><span id="l23.3645" class="difflineminus">-</span>
<a href="#l23.3646"></a><span id="l23.3646" class="difflineminus">-		function success(){</span>
<a href="#l23.3647"></a><span id="l23.3647" class="difflineminus">-			// If a local callback was specified, fire it and pass it the data</span>
<a href="#l23.3648"></a><span id="l23.3648" class="difflineminus">-			if ( s.success )</span>
<a href="#l23.3649"></a><span id="l23.3649" class="difflineminus">-				s.success( data, status );</span>
<a href="#l23.3650"></a><span id="l23.3650" class="difflineminus">-</span>
<a href="#l23.3651"></a><span id="l23.3651" class="difflineminus">-			// Fire the global callback</span>
<a href="#l23.3652"></a><span id="l23.3652" class="difflineminus">-			if ( s.global )</span>
<a href="#l23.3653"></a><span id="l23.3653" class="difflineminus">-				jQuery.event.trigger( &quot;ajaxSuccess&quot;, [xhr, s] );</span>
<a href="#l23.3654"></a><span id="l23.3654" class="difflineminus">-		}</span>
<a href="#l23.3655"></a><span id="l23.3655" class="difflineminus">-</span>
<a href="#l23.3656"></a><span id="l23.3656" class="difflineminus">-		function complete(){</span>
<a href="#l23.3657"></a><span id="l23.3657" class="difflineminus">-			// Process result</span>
<a href="#l23.3658"></a><span id="l23.3658" class="difflineminus">-			if ( s.complete )</span>
<a href="#l23.3659"></a><span id="l23.3659" class="difflineminus">-				s.complete(xhr, status);</span>
<a href="#l23.3660"></a><span id="l23.3660" class="difflineminus">-</span>
<a href="#l23.3661"></a><span id="l23.3661" class="difflineminus">-			// The request was completed</span>
<a href="#l23.3662"></a><span id="l23.3662" class="difflineminus">-			if ( s.global )</span>
<a href="#l23.3663"></a><span id="l23.3663" class="difflineminus">-				jQuery.event.trigger( &quot;ajaxComplete&quot;, [xhr, s] );</span>
<a href="#l23.3664"></a><span id="l23.3664" class="difflineminus">-</span>
<a href="#l23.3665"></a><span id="l23.3665" class="difflineminus">-			// Handle the global AJAX counter</span>
<a href="#l23.3666"></a><span id="l23.3666" class="difflineminus">-			if ( s.global &amp;&amp; ! --jQuery.active )</span>
<a href="#l23.3667"></a><span id="l23.3667" class="difflineminus">-				jQuery.event.trigger( &quot;ajaxStop&quot; );</span>
<a href="#l23.3668"></a><span id="l23.3668" class="difflineminus">-		}</span>
<a href="#l23.3669"></a><span id="l23.3669" class="difflineminus">-</span>
<a href="#l23.3670"></a><span id="l23.3670" class="difflineminus">-		// return XMLHttpRequest to allow aborting the request etc.</span>
<a href="#l23.3671"></a><span id="l23.3671" class="difflineminus">-		return xhr;</span>
<a href="#l23.3672"></a><span id="l23.3672" class="difflineminus">-	},</span>
<a href="#l23.3673"></a><span id="l23.3673" class="difflineminus">-</span>
<a href="#l23.3674"></a><span id="l23.3674" class="difflineminus">-	handleError: function( s, xhr, status, e ) {</span>
<a href="#l23.3675"></a><span id="l23.3675" class="difflineminus">-		// If a local callback was specified, fire it</span>
<a href="#l23.3676"></a><span id="l23.3676" class="difflineminus">-		if ( s.error ) s.error( xhr, status, e );</span>
<a href="#l23.3677"></a><span id="l23.3677" class="difflineminus">-</span>
<a href="#l23.3678"></a><span id="l23.3678" class="difflineminus">-		// Fire the global callback</span>
<a href="#l23.3679"></a><span id="l23.3679" class="difflineminus">-		if ( s.global )</span>
<a href="#l23.3680"></a><span id="l23.3680" class="difflineminus">-			jQuery.event.trigger( &quot;ajaxError&quot;, [xhr, s, e] );</span>
<a href="#l23.3681"></a><span id="l23.3681" class="difflineminus">-	},</span>
<a href="#l23.3682"></a><span id="l23.3682" class="difflineminus">-</span>
<a href="#l23.3683"></a><span id="l23.3683" class="difflineminus">-	// Counter for holding the number of active queries</span>
<a href="#l23.3684"></a><span id="l23.3684" class="difflineminus">-	active: 0,</span>
<a href="#l23.3685"></a><span id="l23.3685" class="difflineminus">-</span>
<a href="#l23.3686"></a><span id="l23.3686" class="difflineminus">-	// Determines if an XMLHttpRequest was successful or not</span>
<a href="#l23.3687"></a><span id="l23.3687" class="difflineminus">-	httpSuccess: function( xhr ) {</span>
<a href="#l23.3688"></a><span id="l23.3688" class="difflineminus">-		try {</span>
<a href="#l23.3689"></a><span id="l23.3689" class="difflineminus">-			// IE error sometimes returns 1223 when it should be 204 so treat it as success, see #1450</span>
<a href="#l23.3690"></a><span id="l23.3690" class="difflineminus">-			return !xhr.status &amp;&amp; location.protocol == &quot;file:&quot; ||</span>
<a href="#l23.3691"></a><span id="l23.3691" class="difflineminus">-				( xhr.status &gt;= 200 &amp;&amp; xhr.status &lt; 300 ) || xhr.status == 304 || xhr.status == 1223;</span>
<a href="#l23.3692"></a><span id="l23.3692" class="difflineminus">-		} catch(e){}</span>
<a href="#l23.3693"></a><span id="l23.3693" class="difflineminus">-		return false;</span>
<a href="#l23.3694"></a><span id="l23.3694" class="difflineminus">-	},</span>
<a href="#l23.3695"></a><span id="l23.3695" class="difflineminus">-</span>
<a href="#l23.3696"></a><span id="l23.3696" class="difflineminus">-	// Determines if an XMLHttpRequest returns NotModified</span>
<a href="#l23.3697"></a><span id="l23.3697" class="difflineminus">-	httpNotModified: function( xhr, url ) {</span>
<a href="#l23.3698"></a><span id="l23.3698" class="difflineminus">-		try {</span>
<a href="#l23.3699"></a><span id="l23.3699" class="difflineminus">-			var xhrRes = xhr.getResponseHeader(&quot;Last-Modified&quot;);</span>
<a href="#l23.3700"></a><span id="l23.3700" class="difflineminus">-</span>
<a href="#l23.3701"></a><span id="l23.3701" class="difflineminus">-			// Firefox always returns 200. check Last-Modified date</span>
<a href="#l23.3702"></a><span id="l23.3702" class="difflineminus">-			return xhr.status == 304 || xhrRes == jQuery.lastModified[url];</span>
<a href="#l23.3703"></a><span id="l23.3703" class="difflineminus">-		} catch(e){}</span>
<a href="#l23.3704"></a><span id="l23.3704" class="difflineminus">-		return false;</span>
<a href="#l23.3705"></a><span id="l23.3705" class="difflineminus">-	},</span>
<a href="#l23.3706"></a><span id="l23.3706" class="difflineminus">-</span>
<a href="#l23.3707"></a><span id="l23.3707" class="difflineminus">-	httpData: function( xhr, type, s ) {</span>
<a href="#l23.3708"></a><span id="l23.3708" class="difflineminus">-		var ct = xhr.getResponseHeader(&quot;content-type&quot;),</span>
<a href="#l23.3709"></a><span id="l23.3709" class="difflineminus">-			xml = type == &quot;xml&quot; || !type &amp;&amp; ct &amp;&amp; ct.indexOf(&quot;xml&quot;) &gt;= 0,</span>
<a href="#l23.3710"></a><span id="l23.3710" class="difflineminus">-			data = xml ? xhr.responseXML : xhr.responseText;</span>
<a href="#l23.3711"></a><span id="l23.3711" class="difflineminus">-</span>
<a href="#l23.3712"></a><span id="l23.3712" class="difflineminus">-		if ( xml &amp;&amp; data.documentElement.tagName == &quot;parsererror&quot; )</span>
<a href="#l23.3713"></a><span id="l23.3713" class="difflineminus">-			throw &quot;parsererror&quot;;</span>
<a href="#l23.3714"></a><span id="l23.3714" class="difflineminus">-			</span>
<a href="#l23.3715"></a><span id="l23.3715" class="difflineminus">-		// Allow a pre-filtering function to sanitize the response</span>
<a href="#l23.3716"></a><span id="l23.3716" class="difflineminus">-		// s != null is checked to keep backwards compatibility</span>
<a href="#l23.3717"></a><span id="l23.3717" class="difflineminus">-		if( s &amp;&amp; s.dataFilter )</span>
<a href="#l23.3718"></a><span id="l23.3718" class="difflineminus">-			data = s.dataFilter( data, type );</span>
<a href="#l23.3719"></a><span id="l23.3719" class="difflineminus">-</span>
<a href="#l23.3720"></a><span id="l23.3720" class="difflineminus">-		// The filter can actually parse the response</span>
<a href="#l23.3721"></a><span id="l23.3721" class="difflineminus">-		if( typeof data === &quot;string&quot; ){</span>
<a href="#l23.3722"></a><span id="l23.3722" class="difflineminus">-</span>
<a href="#l23.3723"></a><span id="l23.3723" class="difflineminus">-			// If the type is &quot;script&quot;, eval it in global context</span>
<a href="#l23.3724"></a><span id="l23.3724" class="difflineminus">-			if ( type == &quot;script&quot; )</span>
<a href="#l23.3725"></a><span id="l23.3725" class="difflineminus">-				jQuery.globalEval( data );</span>
<a href="#l23.3726"></a><span id="l23.3726" class="difflineminus">-</span>
<a href="#l23.3727"></a><span id="l23.3727" class="difflineminus">-			// Get the JavaScript object, if JSON is used.</span>
<a href="#l23.3728"></a><span id="l23.3728" class="difflineminus">-			if ( type == &quot;json&quot; )</span>
<a href="#l23.3729"></a><span id="l23.3729" class="difflineminus">-				data = window[&quot;eval&quot;](&quot;(&quot; + data + &quot;)&quot;);</span>
<a href="#l23.3730"></a><span id="l23.3730" class="difflineminus">-		}</span>
<a href="#l23.3731"></a><span id="l23.3731" class="difflineminus">-		</span>
<a href="#l23.3732"></a><span id="l23.3732" class="difflineminus">-		return data;</span>
<a href="#l23.3733"></a><span id="l23.3733" class="difflineminus">-	},</span>
<a href="#l23.3734"></a><span id="l23.3734" class="difflineminus">-</span>
<a href="#l23.3735"></a><span id="l23.3735" class="difflineminus">-	// Serialize an array of form elements or a set of</span>
<a href="#l23.3736"></a><span id="l23.3736" class="difflineminus">-	// key/values into a query string</span>
<a href="#l23.3737"></a><span id="l23.3737" class="difflineminus">-	param: function( a ) {</span>
<a href="#l23.3738"></a><span id="l23.3738" class="difflineminus">-		var s = [ ];</span>
<a href="#l23.3739"></a><span id="l23.3739" class="difflineminus">-</span>
<a href="#l23.3740"></a><span id="l23.3740" class="difflineminus">-		function add( key, value ){</span>
<a href="#l23.3741"></a><span id="l23.3741" class="difflineminus">-			s[ s.length ] = encodeURIComponent(key) + '=' + encodeURIComponent(value);</span>
<a href="#l23.3742"></a><span id="l23.3742" class="difflineminus">-		};</span>
<a href="#l23.3743"></a><span id="l23.3743" class="difflineminus">-</span>
<a href="#l23.3744"></a><span id="l23.3744" class="difflineminus">-		// If an array was passed in, assume that it is an array</span>
<a href="#l23.3745"></a><span id="l23.3745" class="difflineminus">-		// of form elements</span>
<a href="#l23.3746"></a><span id="l23.3746" class="difflineminus">-		if ( jQuery.isArray(a) || a.jquery )</span>
<a href="#l23.3747"></a><span id="l23.3747" class="difflineminus">-			// Serialize the form elements</span>
<a href="#l23.3748"></a><span id="l23.3748" class="difflineminus">-			jQuery.each( a, function(){</span>
<a href="#l23.3749"></a><span id="l23.3749" class="difflineminus">-				add( this.name, this.value );</span>
<a href="#l23.3750"></a><span id="l23.3750" class="difflineminus">-			});</span>
<a href="#l23.3751"></a><span id="l23.3751" class="difflineminus">-</span>
<a href="#l23.3752"></a><span id="l23.3752" class="difflineminus">-		// Otherwise, assume that it's an object of key/value pairs</span>
<a href="#l23.3753"></a><span id="l23.3753" class="difflineminus">-		else</span>
<a href="#l23.3754"></a><span id="l23.3754" class="difflineminus">-			// Serialize the key/values</span>
<a href="#l23.3755"></a><span id="l23.3755" class="difflineminus">-			for ( var j in a )</span>
<a href="#l23.3756"></a><span id="l23.3756" class="difflineminus">-				// If the value is an array then the key names need to be repeated</span>
<a href="#l23.3757"></a><span id="l23.3757" class="difflineminus">-				if ( jQuery.isArray(a[j]) )</span>
<a href="#l23.3758"></a><span id="l23.3758" class="difflineminus">-					jQuery.each( a[j], function(){</span>
<a href="#l23.3759"></a><span id="l23.3759" class="difflineminus">-						add( j, this );</span>
<a href="#l23.3760"></a><span id="l23.3760" class="difflineminus">-					});</span>
<a href="#l23.3761"></a><span id="l23.3761" class="difflineminus">-				else</span>
<a href="#l23.3762"></a><span id="l23.3762" class="difflineminus">-					add( j, jQuery.isFunction(a[j]) ? a[j]() : a[j] );</span>
<a href="#l23.3763"></a><span id="l23.3763" class="difflineminus">-</span>
<a href="#l23.3764"></a><span id="l23.3764" class="difflineminus">-		// Return the resulting serialization</span>
<a href="#l23.3765"></a><span id="l23.3765" class="difflineminus">-		return s.join(&quot;&amp;&quot;).replace(/%20/g, &quot;+&quot;);</span>
<a href="#l23.3766"></a><span id="l23.3766" class="difflineminus">-	}</span>
<a href="#l23.3767"></a><span id="l23.3767" class="difflineminus">-</span>
<a href="#l23.3768"></a><span id="l23.3768" class="difflineminus">-});</span>
<a href="#l23.3769"></a><span id="l23.3769" class="difflineminus">-var elemdisplay = {},</span>
<a href="#l23.3770"></a><span id="l23.3770" class="difflineminus">-	timerId,</span>
<a href="#l23.3771"></a><span id="l23.3771" class="difflineminus">-	fxAttrs = [</span>
<a href="#l23.3772"></a><span id="l23.3772" class="difflineminus">-		// height animations</span>
<a href="#l23.3773"></a><span id="l23.3773" class="difflineminus">-		[ &quot;height&quot;, &quot;marginTop&quot;, &quot;marginBottom&quot;, &quot;paddingTop&quot;, &quot;paddingBottom&quot; ],</span>
<a href="#l23.3774"></a><span id="l23.3774" class="difflineminus">-		// width animations</span>
<a href="#l23.3775"></a><span id="l23.3775" class="difflineminus">-		[ &quot;width&quot;, &quot;marginLeft&quot;, &quot;marginRight&quot;, &quot;paddingLeft&quot;, &quot;paddingRight&quot; ],</span>
<a href="#l23.3776"></a><span id="l23.3776" class="difflineminus">-		// opacity animations</span>
<a href="#l23.3777"></a><span id="l23.3777" class="difflineminus">-		[ &quot;opacity&quot; ]</span>
<a href="#l23.3778"></a><span id="l23.3778" class="difflineminus">-	];</span>
<a href="#l23.3779"></a><span id="l23.3779" class="difflineminus">-</span>
<a href="#l23.3780"></a><span id="l23.3780" class="difflineminus">-function genFx( type, num ){</span>
<a href="#l23.3781"></a><span id="l23.3781" class="difflineminus">-	var obj = {};</span>
<a href="#l23.3782"></a><span id="l23.3782" class="difflineminus">-	jQuery.each( fxAttrs.concat.apply([], fxAttrs.slice(0,num)), function(){</span>
<a href="#l23.3783"></a><span id="l23.3783" class="difflineminus">-		obj[ this ] = type;</span>
<a href="#l23.3784"></a><span id="l23.3784" class="difflineminus">-	});</span>
<a href="#l23.3785"></a><span id="l23.3785" class="difflineminus">-	return obj;</span>
<a href="#l23.3786"></a><span id="l23.3786" class="difflineminus">-}</span>
<a href="#l23.3787"></a><span id="l23.3787" class="difflineminus">-</span>
<a href="#l23.3788"></a><span id="l23.3788" class="difflineminus">-jQuery.fn.extend({</span>
<a href="#l23.3789"></a><span id="l23.3789" class="difflineminus">-	show: function(speed,callback){</span>
<a href="#l23.3790"></a><span id="l23.3790" class="difflineminus">-		if ( speed ) {</span>
<a href="#l23.3791"></a><span id="l23.3791" class="difflineminus">-			return this.animate( genFx(&quot;show&quot;, 3), speed, callback);</span>
<a href="#l23.3792"></a><span id="l23.3792" class="difflineminus">-		} else {</span>
<a href="#l23.3793"></a><span id="l23.3793" class="difflineminus">-			for ( var i = 0, l = this.length; i &lt; l; i++ ){</span>
<a href="#l23.3794"></a><span id="l23.3794" class="difflineminus">-				var old = jQuery.data(this[i], &quot;olddisplay&quot;);</span>
<a href="#l23.3795"></a><span id="l23.3795" class="difflineminus">-				</span>
<a href="#l23.3796"></a><span id="l23.3796" class="difflineminus">-				this[i].style.display = old || &quot;&quot;;</span>
<a href="#l23.3797"></a><span id="l23.3797" class="difflineminus">-				</span>
<a href="#l23.3798"></a><span id="l23.3798" class="difflineminus">-				if ( jQuery.css(this[i], &quot;display&quot;) === &quot;none&quot; ) {</span>
<a href="#l23.3799"></a><span id="l23.3799" class="difflineminus">-					var tagName = this[i].tagName, display;</span>
<a href="#l23.3800"></a><span id="l23.3800" class="difflineminus">-					</span>
<a href="#l23.3801"></a><span id="l23.3801" class="difflineminus">-					if ( elemdisplay[ tagName ] ) {</span>
<a href="#l23.3802"></a><span id="l23.3802" class="difflineminus">-						display = elemdisplay[ tagName ];</span>
<a href="#l23.3803"></a><span id="l23.3803" class="difflineminus">-					} else {</span>
<a href="#l23.3804"></a><span id="l23.3804" class="difflineminus">-						var elem = jQuery(&quot;&lt;&quot; + tagName + &quot; /&gt;&quot;).appendTo(&quot;body&quot;);</span>
<a href="#l23.3805"></a><span id="l23.3805" class="difflineminus">-						</span>
<a href="#l23.3806"></a><span id="l23.3806" class="difflineminus">-						display = elem.css(&quot;display&quot;);</span>
<a href="#l23.3807"></a><span id="l23.3807" class="difflineminus">-						if ( display === &quot;none&quot; )</span>
<a href="#l23.3808"></a><span id="l23.3808" class="difflineminus">-							display = &quot;block&quot;;</span>
<a href="#l23.3809"></a><span id="l23.3809" class="difflineminus">-						</span>
<a href="#l23.3810"></a><span id="l23.3810" class="difflineminus">-						elem.remove();</span>
<a href="#l23.3811"></a><span id="l23.3811" class="difflineminus">-						</span>
<a href="#l23.3812"></a><span id="l23.3812" class="difflineminus">-						elemdisplay[ tagName ] = display;</span>
<a href="#l23.3813"></a><span id="l23.3813" class="difflineminus">-					}</span>
<a href="#l23.3814"></a><span id="l23.3814" class="difflineminus">-					</span>
<a href="#l23.3815"></a><span id="l23.3815" class="difflineminus">-					jQuery.data(this[i], &quot;olddisplay&quot;, display);</span>
<a href="#l23.3816"></a><span id="l23.3816" class="difflineminus">-				}</span>
<a href="#l23.3817"></a><span id="l23.3817" class="difflineminus">-			}</span>
<a href="#l23.3818"></a><span id="l23.3818" class="difflineminus">-</span>
<a href="#l23.3819"></a><span id="l23.3819" class="difflineminus">-			// Set the display of the elements in a second loop</span>
<a href="#l23.3820"></a><span id="l23.3820" class="difflineminus">-			// to avoid the constant reflow</span>
<a href="#l23.3821"></a><span id="l23.3821" class="difflineminus">-			for ( var i = 0, l = this.length; i &lt; l; i++ ){</span>
<a href="#l23.3822"></a><span id="l23.3822" class="difflineminus">-				this[i].style.display = jQuery.data(this[i], &quot;olddisplay&quot;) || &quot;&quot;;</span>
<a href="#l23.3823"></a><span id="l23.3823" class="difflineminus">-			}</span>
<a href="#l23.3824"></a><span id="l23.3824" class="difflineminus">-			</span>
<a href="#l23.3825"></a><span id="l23.3825" class="difflineminus">-			return this;</span>
<a href="#l23.3826"></a><span id="l23.3826" class="difflineminus">-		}</span>
<a href="#l23.3827"></a><span id="l23.3827" class="difflineminus">-	},</span>
<a href="#l23.3828"></a><span id="l23.3828" class="difflineminus">-</span>
<a href="#l23.3829"></a><span id="l23.3829" class="difflineminus">-	hide: function(speed,callback){</span>
<a href="#l23.3830"></a><span id="l23.3830" class="difflineminus">-		if ( speed ) {</span>
<a href="#l23.3831"></a><span id="l23.3831" class="difflineminus">-			return this.animate( genFx(&quot;hide&quot;, 3), speed, callback);</span>
<a href="#l23.3832"></a><span id="l23.3832" class="difflineminus">-		} else {</span>
<a href="#l23.3833"></a><span id="l23.3833" class="difflineminus">-			for ( var i = 0, l = this.length; i &lt; l; i++ ){</span>
<a href="#l23.3834"></a><span id="l23.3834" class="difflineminus">-				var old = jQuery.data(this[i], &quot;olddisplay&quot;);</span>
<a href="#l23.3835"></a><span id="l23.3835" class="difflineminus">-				if ( !old &amp;&amp; old !== &quot;none&quot; )</span>
<a href="#l23.3836"></a><span id="l23.3836" class="difflineminus">-					jQuery.data(this[i], &quot;olddisplay&quot;, jQuery.css(this[i], &quot;display&quot;));</span>
<a href="#l23.3837"></a><span id="l23.3837" class="difflineminus">-			}</span>
<a href="#l23.3838"></a><span id="l23.3838" class="difflineminus">-</span>
<a href="#l23.3839"></a><span id="l23.3839" class="difflineminus">-			// Set the display of the elements in a second loop</span>
<a href="#l23.3840"></a><span id="l23.3840" class="difflineminus">-			// to avoid the constant reflow</span>
<a href="#l23.3841"></a><span id="l23.3841" class="difflineminus">-			for ( var i = 0, l = this.length; i &lt; l; i++ ){</span>
<a href="#l23.3842"></a><span id="l23.3842" class="difflineminus">-				this[i].style.display = &quot;none&quot;;</span>
<a href="#l23.3843"></a><span id="l23.3843" class="difflineminus">-			}</span>
<a href="#l23.3844"></a><span id="l23.3844" class="difflineminus">-</span>
<a href="#l23.3845"></a><span id="l23.3845" class="difflineminus">-			return this;</span>
<a href="#l23.3846"></a><span id="l23.3846" class="difflineminus">-		}</span>
<a href="#l23.3847"></a><span id="l23.3847" class="difflineminus">-	},</span>
<a href="#l23.3848"></a><span id="l23.3848" class="difflineminus">-</span>
<a href="#l23.3849"></a><span id="l23.3849" class="difflineminus">-	// Save the old toggle function</span>
<a href="#l23.3850"></a><span id="l23.3850" class="difflineminus">-	_toggle: jQuery.fn.toggle,</span>
<a href="#l23.3851"></a><span id="l23.3851" class="difflineminus">-</span>
<a href="#l23.3852"></a><span id="l23.3852" class="difflineminus">-	toggle: function( fn, fn2 ){</span>
<a href="#l23.3853"></a><span id="l23.3853" class="difflineminus">-		var bool = typeof fn === &quot;boolean&quot;;</span>
<a href="#l23.3854"></a><span id="l23.3854" class="difflineminus">-</span>
<a href="#l23.3855"></a><span id="l23.3855" class="difflineminus">-		return jQuery.isFunction(fn) &amp;&amp; jQuery.isFunction(fn2) ?</span>
<a href="#l23.3856"></a><span id="l23.3856" class="difflineminus">-			this._toggle.apply( this, arguments ) :</span>
<a href="#l23.3857"></a><span id="l23.3857" class="difflineminus">-			fn == null || bool ?</span>
<a href="#l23.3858"></a><span id="l23.3858" class="difflineminus">-				this.each(function(){</span>
<a href="#l23.3859"></a><span id="l23.3859" class="difflineminus">-					var state = bool ? fn : jQuery(this).is(&quot;:hidden&quot;);</span>
<a href="#l23.3860"></a><span id="l23.3860" class="difflineminus">-					jQuery(this)[ state ? &quot;show&quot; : &quot;hide&quot; ]();</span>
<a href="#l23.3861"></a><span id="l23.3861" class="difflineminus">-				}) :</span>
<a href="#l23.3862"></a><span id="l23.3862" class="difflineminus">-				this.animate(genFx(&quot;toggle&quot;, 3), fn, fn2);</span>
<a href="#l23.3863"></a><span id="l23.3863" class="difflineminus">-	},</span>
<a href="#l23.3864"></a><span id="l23.3864" class="difflineminus">-</span>
<a href="#l23.3865"></a><span id="l23.3865" class="difflineminus">-	fadeTo: function(speed,to,callback){</span>
<a href="#l23.3866"></a><span id="l23.3866" class="difflineminus">-		return this.animate({opacity: to}, speed, callback);</span>
<a href="#l23.3867"></a><span id="l23.3867" class="difflineminus">-	},</span>
<a href="#l23.3868"></a><span id="l23.3868" class="difflineminus">-</span>
<a href="#l23.3869"></a><span id="l23.3869" class="difflineminus">-	animate: function( prop, speed, easing, callback ) {</span>
<a href="#l23.3870"></a><span id="l23.3870" class="difflineminus">-		var optall = jQuery.speed(speed, easing, callback);</span>
<a href="#l23.3871"></a><span id="l23.3871" class="difflineminus">-</span>
<a href="#l23.3872"></a><span id="l23.3872" class="difflineminus">-		return this[ optall.queue === false ? &quot;each&quot; : &quot;queue&quot; ](function(){</span>
<a href="#l23.3873"></a><span id="l23.3873" class="difflineminus">-		</span>
<a href="#l23.3874"></a><span id="l23.3874" class="difflineminus">-			var opt = jQuery.extend({}, optall), p,</span>
<a href="#l23.3875"></a><span id="l23.3875" class="difflineminus">-				hidden = this.nodeType == 1 &amp;&amp; jQuery(this).is(&quot;:hidden&quot;),</span>
<a href="#l23.3876"></a><span id="l23.3876" class="difflineminus">-				self = this;</span>
<a href="#l23.3877"></a><span id="l23.3877" class="difflineminus">-	</span>
<a href="#l23.3878"></a><span id="l23.3878" class="difflineminus">-			for ( p in prop ) {</span>
<a href="#l23.3879"></a><span id="l23.3879" class="difflineminus">-				if ( prop[p] == &quot;hide&quot; &amp;&amp; hidden || prop[p] == &quot;show&quot; &amp;&amp; !hidden )</span>
<a href="#l23.3880"></a><span id="l23.3880" class="difflineminus">-					return opt.complete.call(this);</span>
<a href="#l23.3881"></a><span id="l23.3881" class="difflineminus">-</span>
<a href="#l23.3882"></a><span id="l23.3882" class="difflineminus">-				if ( ( p == &quot;height&quot; || p == &quot;width&quot; ) &amp;&amp; this.style ) {</span>
<a href="#l23.3883"></a><span id="l23.3883" class="difflineminus">-					// Store display property</span>
<a href="#l23.3884"></a><span id="l23.3884" class="difflineminus">-					opt.display = jQuery.css(this, &quot;display&quot;);</span>
<a href="#l23.3885"></a><span id="l23.3885" class="difflineminus">-</span>
<a href="#l23.3886"></a><span id="l23.3886" class="difflineminus">-					// Make sure that nothing sneaks out</span>
<a href="#l23.3887"></a><span id="l23.3887" class="difflineminus">-					opt.overflow = this.style.overflow;</span>
<a href="#l23.3888"></a><span id="l23.3888" class="difflineminus">-				}</span>
<a href="#l23.3889"></a><span id="l23.3889" class="difflineminus">-			}</span>
<a href="#l23.3890"></a><span id="l23.3890" class="difflineminus">-</span>
<a href="#l23.3891"></a><span id="l23.3891" class="difflineminus">-			if ( opt.overflow != null )</span>
<a href="#l23.3892"></a><span id="l23.3892" class="difflineminus">-				this.style.overflow = &quot;hidden&quot;;</span>
<a href="#l23.3893"></a><span id="l23.3893" class="difflineminus">-</span>
<a href="#l23.3894"></a><span id="l23.3894" class="difflineminus">-			opt.curAnim = jQuery.extend({}, prop);</span>
<a href="#l23.3895"></a><span id="l23.3895" class="difflineminus">-</span>
<a href="#l23.3896"></a><span id="l23.3896" class="difflineminus">-			jQuery.each( prop, function(name, val){</span>
<a href="#l23.3897"></a><span id="l23.3897" class="difflineminus">-				var e = new jQuery.fx( self, opt, name );</span>
<a href="#l23.3898"></a><span id="l23.3898" class="difflineminus">-</span>
<a href="#l23.3899"></a><span id="l23.3899" class="difflineminus">-				if ( /toggle|show|hide/.test(val) )</span>
<a href="#l23.3900"></a><span id="l23.3900" class="difflineminus">-					e[ val == &quot;toggle&quot; ? hidden ? &quot;show&quot; : &quot;hide&quot; : val ]( prop );</span>
<a href="#l23.3901"></a><span id="l23.3901" class="difflineminus">-				else {</span>
<a href="#l23.3902"></a><span id="l23.3902" class="difflineminus">-					var parts = val.toString().match(/^([+-]=)?([\d+-.]+)(.*)$/),</span>
<a href="#l23.3903"></a><span id="l23.3903" class="difflineminus">-						start = e.cur(true) || 0;</span>
<a href="#l23.3904"></a><span id="l23.3904" class="difflineminus">-</span>
<a href="#l23.3905"></a><span id="l23.3905" class="difflineminus">-					if ( parts ) {</span>
<a href="#l23.3906"></a><span id="l23.3906" class="difflineminus">-						var end = parseFloat(parts[2]),</span>
<a href="#l23.3907"></a><span id="l23.3907" class="difflineminus">-							unit = parts[3] || &quot;px&quot;;</span>
<a href="#l23.3908"></a><span id="l23.3908" class="difflineminus">-</span>
<a href="#l23.3909"></a><span id="l23.3909" class="difflineminus">-						// We need to compute starting value</span>
<a href="#l23.3910"></a><span id="l23.3910" class="difflineminus">-						if ( unit != &quot;px&quot; ) {</span>
<a href="#l23.3911"></a><span id="l23.3911" class="difflineminus">-							self.style[ name ] = (end || 1) + unit;</span>
<a href="#l23.3912"></a><span id="l23.3912" class="difflineminus">-							start = ((end || 1) / e.cur(true)) * start;</span>
<a href="#l23.3913"></a><span id="l23.3913" class="difflineminus">-							self.style[ name ] = start + unit;</span>
<a href="#l23.3914"></a><span id="l23.3914" class="difflineminus">-						}</span>
<a href="#l23.3915"></a><span id="l23.3915" class="difflineminus">-</span>
<a href="#l23.3916"></a><span id="l23.3916" class="difflineminus">-						// If a +=/-= token was provided, we're doing a relative animation</span>
<a href="#l23.3917"></a><span id="l23.3917" class="difflineminus">-						if ( parts[1] )</span>
<a href="#l23.3918"></a><span id="l23.3918" class="difflineminus">-							end = ((parts[1] == &quot;-=&quot; ? -1 : 1) * end) + start;</span>
<a href="#l23.3919"></a><span id="l23.3919" class="difflineminus">-</span>
<a href="#l23.3920"></a><span id="l23.3920" class="difflineminus">-						e.custom( start, end, unit );</span>
<a href="#l23.3921"></a><span id="l23.3921" class="difflineminus">-					} else</span>
<a href="#l23.3922"></a><span id="l23.3922" class="difflineminus">-						e.custom( start, val, &quot;&quot; );</span>
<a href="#l23.3923"></a><span id="l23.3923" class="difflineminus">-				}</span>
<a href="#l23.3924"></a><span id="l23.3924" class="difflineminus">-			});</span>
<a href="#l23.3925"></a><span id="l23.3925" class="difflineminus">-</span>
<a href="#l23.3926"></a><span id="l23.3926" class="difflineminus">-			// For JS strict compliance</span>
<a href="#l23.3927"></a><span id="l23.3927" class="difflineminus">-			return true;</span>
<a href="#l23.3928"></a><span id="l23.3928" class="difflineminus">-		});</span>
<a href="#l23.3929"></a><span id="l23.3929" class="difflineminus">-	},</span>
<a href="#l23.3930"></a><span id="l23.3930" class="difflineminus">-</span>
<a href="#l23.3931"></a><span id="l23.3931" class="difflineminus">-	stop: function(clearQueue, gotoEnd){</span>
<a href="#l23.3932"></a><span id="l23.3932" class="difflineminus">-		var timers = jQuery.timers;</span>
<a href="#l23.3933"></a><span id="l23.3933" class="difflineminus">-</span>
<a href="#l23.3934"></a><span id="l23.3934" class="difflineminus">-		if (clearQueue)</span>
<a href="#l23.3935"></a><span id="l23.3935" class="difflineminus">-			this.queue([]);</span>
<a href="#l23.3936"></a><span id="l23.3936" class="difflineminus">-</span>
<a href="#l23.3937"></a><span id="l23.3937" class="difflineminus">-		this.each(function(){</span>
<a href="#l23.3938"></a><span id="l23.3938" class="difflineminus">-			// go in reverse order so anything added to the queue during the loop is ignored</span>
<a href="#l23.3939"></a><span id="l23.3939" class="difflineminus">-			for ( var i = timers.length - 1; i &gt;= 0; i-- )</span>
<a href="#l23.3940"></a><span id="l23.3940" class="difflineminus">-				if ( timers[i].elem == this ) {</span>
<a href="#l23.3941"></a><span id="l23.3941" class="difflineminus">-					if (gotoEnd)</span>
<a href="#l23.3942"></a><span id="l23.3942" class="difflineminus">-						// force the next step to be the last</span>
<a href="#l23.3943"></a><span id="l23.3943" class="difflineminus">-						timers[i](true);</span>
<a href="#l23.3944"></a><span id="l23.3944" class="difflineminus">-					timers.splice(i, 1);</span>
<a href="#l23.3945"></a><span id="l23.3945" class="difflineminus">-				}</span>
<a href="#l23.3946"></a><span id="l23.3946" class="difflineminus">-		});</span>
<a href="#l23.3947"></a><span id="l23.3947" class="difflineminus">-</span>
<a href="#l23.3948"></a><span id="l23.3948" class="difflineminus">-		// start the next in the queue if the last step wasn't forced</span>
<a href="#l23.3949"></a><span id="l23.3949" class="difflineminus">-		if (!gotoEnd)</span>
<a href="#l23.3950"></a><span id="l23.3950" class="difflineminus">-			this.dequeue();</span>
<a href="#l23.3951"></a><span id="l23.3951" class="difflineminus">-</span>
<a href="#l23.3952"></a><span id="l23.3952" class="difflineminus">-		return this;</span>
<a href="#l23.3953"></a><span id="l23.3953" class="difflineminus">-	}</span>
<a href="#l23.3954"></a><span id="l23.3954" class="difflineminus">-</span>
<a href="#l23.3955"></a><span id="l23.3955" class="difflineminus">-});</span>
<a href="#l23.3956"></a><span id="l23.3956" class="difflineminus">-</span>
<a href="#l23.3957"></a><span id="l23.3957" class="difflineminus">-// Generate shortcuts for custom animations</span>
<a href="#l23.3958"></a><span id="l23.3958" class="difflineminus">-jQuery.each({</span>
<a href="#l23.3959"></a><span id="l23.3959" class="difflineminus">-	slideDown: genFx(&quot;show&quot;, 1),</span>
<a href="#l23.3960"></a><span id="l23.3960" class="difflineminus">-	slideUp: genFx(&quot;hide&quot;, 1),</span>
<a href="#l23.3961"></a><span id="l23.3961" class="difflineminus">-	slideToggle: genFx(&quot;toggle&quot;, 1),</span>
<a href="#l23.3962"></a><span id="l23.3962" class="difflineminus">-	fadeIn: { opacity: &quot;show&quot; },</span>
<a href="#l23.3963"></a><span id="l23.3963" class="difflineminus">-	fadeOut: { opacity: &quot;hide&quot; }</span>
<a href="#l23.3964"></a><span id="l23.3964" class="difflineminus">-}, function( name, props ){</span>
<a href="#l23.3965"></a><span id="l23.3965" class="difflineminus">-	jQuery.fn[ name ] = function( speed, callback ){</span>
<a href="#l23.3966"></a><span id="l23.3966" class="difflineminus">-		return this.animate( props, speed, callback );</span>
<a href="#l23.3967"></a><span id="l23.3967" class="difflineminus">-	};</span>
<a href="#l23.3968"></a><span id="l23.3968" class="difflineminus">-});</span>
<a href="#l23.3969"></a><span id="l23.3969" class="difflineminus">-</span>
<a href="#l23.3970"></a><span id="l23.3970" class="difflineminus">-jQuery.extend({</span>
<a href="#l23.3971"></a><span id="l23.3971" class="difflineminus">-</span>
<a href="#l23.3972"></a><span id="l23.3972" class="difflineminus">-	speed: function(speed, easing, fn) {</span>
<a href="#l23.3973"></a><span id="l23.3973" class="difflineminus">-		var opt = typeof speed === &quot;object&quot; ? speed : {</span>
<a href="#l23.3974"></a><span id="l23.3974" class="difflineminus">-			complete: fn || !fn &amp;&amp; easing ||</span>
<a href="#l23.3975"></a><span id="l23.3975" class="difflineminus">-				jQuery.isFunction( speed ) &amp;&amp; speed,</span>
<a href="#l23.3976"></a><span id="l23.3976" class="difflineminus">-			duration: speed,</span>
<a href="#l23.3977"></a><span id="l23.3977" class="difflineminus">-			easing: fn &amp;&amp; easing || easing &amp;&amp; !jQuery.isFunction(easing) &amp;&amp; easing</span>
<a href="#l23.3978"></a><span id="l23.3978" class="difflineminus">-		};</span>
<a href="#l23.3979"></a><span id="l23.3979" class="difflineminus">-</span>
<a href="#l23.3980"></a><span id="l23.3980" class="difflineminus">-		opt.duration = jQuery.fx.off ? 0 : typeof opt.duration === &quot;number&quot; ? opt.duration :</span>
<a href="#l23.3981"></a><span id="l23.3981" class="difflineminus">-			jQuery.fx.speeds[opt.duration] || jQuery.fx.speeds._default;</span>
<a href="#l23.3982"></a><span id="l23.3982" class="difflineminus">-</span>
<a href="#l23.3983"></a><span id="l23.3983" class="difflineminus">-		// Queueing</span>
<a href="#l23.3984"></a><span id="l23.3984" class="difflineminus">-		opt.old = opt.complete;</span>
<a href="#l23.3985"></a><span id="l23.3985" class="difflineminus">-		opt.complete = function(){</span>
<a href="#l23.3986"></a><span id="l23.3986" class="difflineminus">-			if ( opt.queue !== false )</span>
<a href="#l23.3987"></a><span id="l23.3987" class="difflineminus">-				jQuery(this).dequeue();</span>
<a href="#l23.3988"></a><span id="l23.3988" class="difflineminus">-			if ( jQuery.isFunction( opt.old ) )</span>
<a href="#l23.3989"></a><span id="l23.3989" class="difflineminus">-				opt.old.call( this );</span>
<a href="#l23.3990"></a><span id="l23.3990" class="difflineminus">-		};</span>
<a href="#l23.3991"></a><span id="l23.3991" class="difflineminus">-</span>
<a href="#l23.3992"></a><span id="l23.3992" class="difflineminus">-		return opt;</span>
<a href="#l23.3993"></a><span id="l23.3993" class="difflineminus">-	},</span>
<a href="#l23.3994"></a><span id="l23.3994" class="difflineminus">-</span>
<a href="#l23.3995"></a><span id="l23.3995" class="difflineminus">-	easing: {</span>
<a href="#l23.3996"></a><span id="l23.3996" class="difflineminus">-		linear: function( p, n, firstNum, diff ) {</span>
<a href="#l23.3997"></a><span id="l23.3997" class="difflineminus">-			return firstNum + diff * p;</span>
<a href="#l23.3998"></a><span id="l23.3998" class="difflineminus">-		},</span>
<a href="#l23.3999"></a><span id="l23.3999" class="difflineminus">-		swing: function( p, n, firstNum, diff ) {</span>
<a href="#l23.4000"></a><span id="l23.4000" class="difflineminus">-			return ((-Math.cos(p*Math.PI)/2) + 0.5) * diff + firstNum;</span>
<a href="#l23.4001"></a><span id="l23.4001" class="difflineminus">-		}</span>
<a href="#l23.4002"></a><span id="l23.4002" class="difflineminus">-	},</span>
<a href="#l23.4003"></a><span id="l23.4003" class="difflineminus">-</span>
<a href="#l23.4004"></a><span id="l23.4004" class="difflineminus">-	timers: [],</span>
<a href="#l23.4005"></a><span id="l23.4005" class="difflineminus">-</span>
<a href="#l23.4006"></a><span id="l23.4006" class="difflineminus">-	fx: function( elem, options, prop ){</span>
<a href="#l23.4007"></a><span id="l23.4007" class="difflineminus">-		this.options = options;</span>
<a href="#l23.4008"></a><span id="l23.4008" class="difflineminus">-		this.elem = elem;</span>
<a href="#l23.4009"></a><span id="l23.4009" class="difflineminus">-		this.prop = prop;</span>
<a href="#l23.4010"></a><span id="l23.4010" class="difflineminus">-</span>
<a href="#l23.4011"></a><span id="l23.4011" class="difflineminus">-		if ( !options.orig )</span>
<a href="#l23.4012"></a><span id="l23.4012" class="difflineminus">-			options.orig = {};</span>
<a href="#l23.4013"></a><span id="l23.4013" class="difflineminus">-	}</span>
<a href="#l23.4014"></a><span id="l23.4014" class="difflineminus">-</span>
<a href="#l23.4015"></a><span id="l23.4015" class="difflineminus">-});</span>
<a href="#l23.4016"></a><span id="l23.4016" class="difflineminus">-</span>
<a href="#l23.4017"></a><span id="l23.4017" class="difflineminus">-jQuery.fx.prototype = {</span>
<a href="#l23.4018"></a><span id="l23.4018" class="difflineminus">-</span>
<a href="#l23.4019"></a><span id="l23.4019" class="difflineminus">-	// Simple function for setting a style value</span>
<a href="#l23.4020"></a><span id="l23.4020" class="difflineminus">-	update: function(){</span>
<a href="#l23.4021"></a><span id="l23.4021" class="difflineminus">-		if ( this.options.step )</span>
<a href="#l23.4022"></a><span id="l23.4022" class="difflineminus">-			this.options.step.call( this.elem, this.now, this );</span>
<a href="#l23.4023"></a><span id="l23.4023" class="difflineminus">-</span>
<a href="#l23.4024"></a><span id="l23.4024" class="difflineminus">-		(jQuery.fx.step[this.prop] || jQuery.fx.step._default)( this );</span>
<a href="#l23.4025"></a><span id="l23.4025" class="difflineminus">-</span>
<a href="#l23.4026"></a><span id="l23.4026" class="difflineminus">-		// Set display property to block for height/width animations</span>
<a href="#l23.4027"></a><span id="l23.4027" class="difflineminus">-		if ( ( this.prop == &quot;height&quot; || this.prop == &quot;width&quot; ) &amp;&amp; this.elem.style )</span>
<a href="#l23.4028"></a><span id="l23.4028" class="difflineminus">-			this.elem.style.display = &quot;block&quot;;</span>
<a href="#l23.4029"></a><span id="l23.4029" class="difflineminus">-	},</span>
<a href="#l23.4030"></a><span id="l23.4030" class="difflineminus">-</span>
<a href="#l23.4031"></a><span id="l23.4031" class="difflineminus">-	// Get the current size</span>
<a href="#l23.4032"></a><span id="l23.4032" class="difflineminus">-	cur: function(force){</span>
<a href="#l23.4033"></a><span id="l23.4033" class="difflineminus">-		if ( this.elem[this.prop] != null &amp;&amp; (!this.elem.style || this.elem.style[this.prop] == null) )</span>
<a href="#l23.4034"></a><span id="l23.4034" class="difflineminus">-			return this.elem[ this.prop ];</span>
<a href="#l23.4035"></a><span id="l23.4035" class="difflineminus">-</span>
<a href="#l23.4036"></a><span id="l23.4036" class="difflineminus">-		var r = parseFloat(jQuery.css(this.elem, this.prop, force));</span>
<a href="#l23.4037"></a><span id="l23.4037" class="difflineminus">-		return r &amp;&amp; r &gt; -10000 ? r : parseFloat(jQuery.curCSS(this.elem, this.prop)) || 0;</span>
<a href="#l23.4038"></a><span id="l23.4038" class="difflineminus">-	},</span>
<a href="#l23.4039"></a><span id="l23.4039" class="difflineminus">-</span>
<a href="#l23.4040"></a><span id="l23.4040" class="difflineminus">-	// Start an animation from one number to another</span>
<a href="#l23.4041"></a><span id="l23.4041" class="difflineminus">-	custom: function(from, to, unit){</span>
<a href="#l23.4042"></a><span id="l23.4042" class="difflineminus">-		this.startTime = now();</span>
<a href="#l23.4043"></a><span id="l23.4043" class="difflineminus">-		this.start = from;</span>
<a href="#l23.4044"></a><span id="l23.4044" class="difflineminus">-		this.end = to;</span>
<a href="#l23.4045"></a><span id="l23.4045" class="difflineminus">-		this.unit = unit || this.unit || &quot;px&quot;;</span>
<a href="#l23.4046"></a><span id="l23.4046" class="difflineminus">-		this.now = this.start;</span>
<a href="#l23.4047"></a><span id="l23.4047" class="difflineminus">-		this.pos = this.state = 0;</span>
<a href="#l23.4048"></a><span id="l23.4048" class="difflineminus">-</span>
<a href="#l23.4049"></a><span id="l23.4049" class="difflineminus">-		var self = this;</span>
<a href="#l23.4050"></a><span id="l23.4050" class="difflineminus">-		function t(gotoEnd){</span>
<a href="#l23.4051"></a><span id="l23.4051" class="difflineminus">-			return self.step(gotoEnd);</span>
<a href="#l23.4052"></a><span id="l23.4052" class="difflineminus">-		}</span>
<a href="#l23.4053"></a><span id="l23.4053" class="difflineminus">-</span>
<a href="#l23.4054"></a><span id="l23.4054" class="difflineminus">-		t.elem = this.elem;</span>
<a href="#l23.4055"></a><span id="l23.4055" class="difflineminus">-</span>
<a href="#l23.4056"></a><span id="l23.4056" class="difflineminus">-		if ( t() &amp;&amp; jQuery.timers.push(t) &amp;&amp; !timerId ) {</span>
<a href="#l23.4057"></a><span id="l23.4057" class="difflineminus">-			timerId = setInterval(function(){</span>
<a href="#l23.4058"></a><span id="l23.4058" class="difflineminus">-				var timers = jQuery.timers;</span>
<a href="#l23.4059"></a><span id="l23.4059" class="difflineminus">-</span>
<a href="#l23.4060"></a><span id="l23.4060" class="difflineminus">-				for ( var i = 0; i &lt; timers.length; i++ )</span>
<a href="#l23.4061"></a><span id="l23.4061" class="difflineminus">-					if ( !timers[i]() )</span>
<a href="#l23.4062"></a><span id="l23.4062" class="difflineminus">-						timers.splice(i--, 1);</span>
<a href="#l23.4063"></a><span id="l23.4063" class="difflineminus">-</span>
<a href="#l23.4064"></a><span id="l23.4064" class="difflineminus">-				if ( !timers.length ) {</span>
<a href="#l23.4065"></a><span id="l23.4065" class="difflineminus">-					clearInterval( timerId );</span>
<a href="#l23.4066"></a><span id="l23.4066" class="difflineminus">-					timerId = undefined;</span>
<a href="#l23.4067"></a><span id="l23.4067" class="difflineminus">-				}</span>
<a href="#l23.4068"></a><span id="l23.4068" class="difflineminus">-			}, 13);</span>
<a href="#l23.4069"></a><span id="l23.4069" class="difflineminus">-		}</span>
<a href="#l23.4070"></a><span id="l23.4070" class="difflineminus">-	},</span>
<a href="#l23.4071"></a><span id="l23.4071" class="difflineminus">-</span>
<a href="#l23.4072"></a><span id="l23.4072" class="difflineminus">-	// Simple 'show' function</span>
<a href="#l23.4073"></a><span id="l23.4073" class="difflineminus">-	show: function(){</span>
<a href="#l23.4074"></a><span id="l23.4074" class="difflineminus">-		// Remember where we started, so that we can go back to it later</span>
<a href="#l23.4075"></a><span id="l23.4075" class="difflineminus">-		this.options.orig[this.prop] = jQuery.attr( this.elem.style, this.prop );</span>
<a href="#l23.4076"></a><span id="l23.4076" class="difflineminus">-		this.options.show = true;</span>
<a href="#l23.4077"></a><span id="l23.4077" class="difflineminus">-</span>
<a href="#l23.4078"></a><span id="l23.4078" class="difflineminus">-		// Begin the animation</span>
<a href="#l23.4079"></a><span id="l23.4079" class="difflineminus">-		// Make sure that we start at a small width/height to avoid any</span>
<a href="#l23.4080"></a><span id="l23.4080" class="difflineminus">-		// flash of content</span>
<a href="#l23.4081"></a><span id="l23.4081" class="difflineminus">-		this.custom(this.prop == &quot;width&quot; || this.prop == &quot;height&quot; ? 1 : 0, this.cur());</span>
<a href="#l23.4082"></a><span id="l23.4082" class="difflineminus">-</span>
<a href="#l23.4083"></a><span id="l23.4083" class="difflineminus">-		// Start by showing the element</span>
<a href="#l23.4084"></a><span id="l23.4084" class="difflineminus">-		jQuery(this.elem).show();</span>
<a href="#l23.4085"></a><span id="l23.4085" class="difflineminus">-	},</span>
<a href="#l23.4086"></a><span id="l23.4086" class="difflineminus">-</span>
<a href="#l23.4087"></a><span id="l23.4087" class="difflineminus">-	// Simple 'hide' function</span>
<a href="#l23.4088"></a><span id="l23.4088" class="difflineminus">-	hide: function(){</span>
<a href="#l23.4089"></a><span id="l23.4089" class="difflineminus">-		// Remember where we started, so that we can go back to it later</span>
<a href="#l23.4090"></a><span id="l23.4090" class="difflineminus">-		this.options.orig[this.prop] = jQuery.attr( this.elem.style, this.prop );</span>
<a href="#l23.4091"></a><span id="l23.4091" class="difflineminus">-		this.options.hide = true;</span>
<a href="#l23.4092"></a><span id="l23.4092" class="difflineminus">-</span>
<a href="#l23.4093"></a><span id="l23.4093" class="difflineminus">-		// Begin the animation</span>
<a href="#l23.4094"></a><span id="l23.4094" class="difflineminus">-		this.custom(this.cur(), 0);</span>
<a href="#l23.4095"></a><span id="l23.4095" class="difflineminus">-	},</span>
<a href="#l23.4096"></a><span id="l23.4096" class="difflineminus">-</span>
<a href="#l23.4097"></a><span id="l23.4097" class="difflineminus">-	// Each step of an animation</span>
<a href="#l23.4098"></a><span id="l23.4098" class="difflineminus">-	step: function(gotoEnd){</span>
<a href="#l23.4099"></a><span id="l23.4099" class="difflineminus">-		var t = now();</span>
<a href="#l23.4100"></a><span id="l23.4100" class="difflineminus">-</span>
<a href="#l23.4101"></a><span id="l23.4101" class="difflineminus">-		if ( gotoEnd || t &gt;= this.options.duration + this.startTime ) {</span>
<a href="#l23.4102"></a><span id="l23.4102" class="difflineminus">-			this.now = this.end;</span>
<a href="#l23.4103"></a><span id="l23.4103" class="difflineminus">-			this.pos = this.state = 1;</span>
<a href="#l23.4104"></a><span id="l23.4104" class="difflineminus">-			this.update();</span>
<a href="#l23.4105"></a><span id="l23.4105" class="difflineminus">-</span>
<a href="#l23.4106"></a><span id="l23.4106" class="difflineminus">-			this.options.curAnim[ this.prop ] = true;</span>
<a href="#l23.4107"></a><span id="l23.4107" class="difflineminus">-</span>
<a href="#l23.4108"></a><span id="l23.4108" class="difflineminus">-			var done = true;</span>
<a href="#l23.4109"></a><span id="l23.4109" class="difflineminus">-			for ( var i in this.options.curAnim )</span>
<a href="#l23.4110"></a><span id="l23.4110" class="difflineminus">-				if ( this.options.curAnim[i] !== true )</span>
<a href="#l23.4111"></a><span id="l23.4111" class="difflineminus">-					done = false;</span>
<a href="#l23.4112"></a><span id="l23.4112" class="difflineminus">-</span>
<a href="#l23.4113"></a><span id="l23.4113" class="difflineminus">-			if ( done ) {</span>
<a href="#l23.4114"></a><span id="l23.4114" class="difflineminus">-				if ( this.options.display != null ) {</span>
<a href="#l23.4115"></a><span id="l23.4115" class="difflineminus">-					// Reset the overflow</span>
<a href="#l23.4116"></a><span id="l23.4116" class="difflineminus">-					this.elem.style.overflow = this.options.overflow;</span>
<a href="#l23.4117"></a><span id="l23.4117" class="difflineminus">-</span>
<a href="#l23.4118"></a><span id="l23.4118" class="difflineminus">-					// Reset the display</span>
<a href="#l23.4119"></a><span id="l23.4119" class="difflineminus">-					this.elem.style.display = this.options.display;</span>
<a href="#l23.4120"></a><span id="l23.4120" class="difflineminus">-					if ( jQuery.css(this.elem, &quot;display&quot;) == &quot;none&quot; )</span>
<a href="#l23.4121"></a><span id="l23.4121" class="difflineminus">-						this.elem.style.display = &quot;block&quot;;</span>
<a href="#l23.4122"></a><span id="l23.4122" class="difflineminus">-				}</span>
<a href="#l23.4123"></a><span id="l23.4123" class="difflineminus">-</span>
<a href="#l23.4124"></a><span id="l23.4124" class="difflineminus">-				// Hide the element if the &quot;hide&quot; operation was done</span>
<a href="#l23.4125"></a><span id="l23.4125" class="difflineminus">-				if ( this.options.hide )</span>
<a href="#l23.4126"></a><span id="l23.4126" class="difflineminus">-					jQuery(this.elem).hide();</span>
<a href="#l23.4127"></a><span id="l23.4127" class="difflineminus">-</span>
<a href="#l23.4128"></a><span id="l23.4128" class="difflineminus">-				// Reset the properties, if the item has been hidden or shown</span>
<a href="#l23.4129"></a><span id="l23.4129" class="difflineminus">-				if ( this.options.hide || this.options.show )</span>
<a href="#l23.4130"></a><span id="l23.4130" class="difflineminus">-					for ( var p in this.options.curAnim )</span>
<a href="#l23.4131"></a><span id="l23.4131" class="difflineminus">-						jQuery.attr(this.elem.style, p, this.options.orig[p]);</span>
<a href="#l23.4132"></a><span id="l23.4132" class="difflineminus">-					</span>
<a href="#l23.4133"></a><span id="l23.4133" class="difflineminus">-				// Execute the complete function</span>
<a href="#l23.4134"></a><span id="l23.4134" class="difflineminus">-				this.options.complete.call( this.elem );</span>
<a href="#l23.4135"></a><span id="l23.4135" class="difflineminus">-			}</span>
<a href="#l23.4136"></a><span id="l23.4136" class="difflineminus">-</span>
<a href="#l23.4137"></a><span id="l23.4137" class="difflineminus">-			return false;</span>
<a href="#l23.4138"></a><span id="l23.4138" class="difflineminus">-		} else {</span>
<a href="#l23.4139"></a><span id="l23.4139" class="difflineminus">-			var n = t - this.startTime;</span>
<a href="#l23.4140"></a><span id="l23.4140" class="difflineminus">-			this.state = n / this.options.duration;</span>
<a href="#l23.4141"></a><span id="l23.4141" class="difflineminus">-</span>
<a href="#l23.4142"></a><span id="l23.4142" class="difflineminus">-			// Perform the easing function, defaults to swing</span>
<a href="#l23.4143"></a><span id="l23.4143" class="difflineminus">-			this.pos = jQuery.easing[this.options.easing || (jQuery.easing.swing ? &quot;swing&quot; : &quot;linear&quot;)](this.state, n, 0, 1, this.options.duration);</span>
<a href="#l23.4144"></a><span id="l23.4144" class="difflineminus">-			this.now = this.start + ((this.end - this.start) * this.pos);</span>
<a href="#l23.4145"></a><span id="l23.4145" class="difflineminus">-</span>
<a href="#l23.4146"></a><span id="l23.4146" class="difflineminus">-			// Perform the next step of the animation</span>
<a href="#l23.4147"></a><span id="l23.4147" class="difflineminus">-			this.update();</span>
<a href="#l23.4148"></a><span id="l23.4148" class="difflineminus">-		}</span>
<a href="#l23.4149"></a><span id="l23.4149" class="difflineminus">-</span>
<a href="#l23.4150"></a><span id="l23.4150" class="difflineminus">-		return true;</span>
<a href="#l23.4151"></a><span id="l23.4151" class="difflineminus">-	}</span>
<a href="#l23.4152"></a><span id="l23.4152" class="difflineminus">-</span>
<a href="#l23.4153"></a><span id="l23.4153" class="difflineminus">-};</span>
<a href="#l23.4154"></a><span id="l23.4154" class="difflineminus">-</span>
<a href="#l23.4155"></a><span id="l23.4155" class="difflineminus">-jQuery.extend( jQuery.fx, {</span>
<a href="#l23.4156"></a><span id="l23.4156" class="difflineminus">-	speeds:{</span>
<a href="#l23.4157"></a><span id="l23.4157" class="difflineminus">-		slow: 600,</span>
<a href="#l23.4158"></a><span id="l23.4158" class="difflineminus">- 		fast: 200,</span>
<a href="#l23.4159"></a><span id="l23.4159" class="difflineminus">- 		// Default speed</span>
<a href="#l23.4160"></a><span id="l23.4160" class="difflineminus">- 		_default: 400</span>
<a href="#l23.4161"></a><span id="l23.4161" class="difflineminus">-	},</span>
<a href="#l23.4162"></a><span id="l23.4162" class="difflineminus">-	step: {</span>
<a href="#l23.4163"></a><span id="l23.4163" class="difflineminus">-</span>
<a href="#l23.4164"></a><span id="l23.4164" class="difflineminus">-		opacity: function(fx){</span>
<a href="#l23.4165"></a><span id="l23.4165" class="difflineminus">-			jQuery.attr(fx.elem.style, &quot;opacity&quot;, fx.now);</span>
<a href="#l23.4166"></a><span id="l23.4166" class="difflineminus">-		},</span>
<a href="#l23.4167"></a><span id="l23.4167" class="difflineminus">-</span>
<a href="#l23.4168"></a><span id="l23.4168" class="difflineminus">-		_default: function(fx){</span>
<a href="#l23.4169"></a><span id="l23.4169" class="difflineminus">-			if ( fx.elem.style &amp;&amp; fx.elem.style[ fx.prop ] != null )</span>
<a href="#l23.4170"></a><span id="l23.4170" class="difflineminus">-				fx.elem.style[ fx.prop ] = fx.now + fx.unit;</span>
<a href="#l23.4171"></a><span id="l23.4171" class="difflineminus">-			else</span>
<a href="#l23.4172"></a><span id="l23.4172" class="difflineminus">-				fx.elem[ fx.prop ] = fx.now;</span>
<a href="#l23.4173"></a><span id="l23.4173" class="difflineminus">-		}</span>
<a href="#l23.4174"></a><span id="l23.4174" class="difflineminus">-	}</span>
<a href="#l23.4175"></a><span id="l23.4175" class="difflineminus">-});</span>
<a href="#l23.4176"></a><span id="l23.4176" class="difflineminus">-if ( document.documentElement[&quot;getBoundingClientRect&quot;] )</span>
<a href="#l23.4177"></a><span id="l23.4177" class="difflineminus">-	jQuery.fn.offset = function() {</span>
<a href="#l23.4178"></a><span id="l23.4178" class="difflineminus">-		if ( !this[0] ) return { top: 0, left: 0 };</span>
<a href="#l23.4179"></a><span id="l23.4179" class="difflineminus">-		if ( this[0] === this[0].ownerDocument.body ) return jQuery.offset.bodyOffset( this[0] );</span>
<a href="#l23.4180"></a><span id="l23.4180" class="difflineminus">-		var box  = this[0].getBoundingClientRect(), doc = this[0].ownerDocument, body = doc.body, docElem = doc.documentElement,</span>
<a href="#l23.4181"></a><span id="l23.4181" class="difflineminus">-			clientTop = docElem.clientTop || body.clientTop || 0, clientLeft = docElem.clientLeft || body.clientLeft || 0,</span>
<a href="#l23.4182"></a><span id="l23.4182" class="difflineminus">-			top  = box.top  + (self.pageYOffset || jQuery.boxModel &amp;&amp; docElem.scrollTop  || body.scrollTop ) - clientTop,</span>
<a href="#l23.4183"></a><span id="l23.4183" class="difflineminus">-			left = box.left + (self.pageXOffset || jQuery.boxModel &amp;&amp; docElem.scrollLeft || body.scrollLeft) - clientLeft;</span>
<a href="#l23.4184"></a><span id="l23.4184" class="difflineminus">-		return { top: top, left: left };</span>
<a href="#l23.4185"></a><span id="l23.4185" class="difflineminus">-	};</span>
<a href="#l23.4186"></a><span id="l23.4186" class="difflineminus">-else </span>
<a href="#l23.4187"></a><span id="l23.4187" class="difflineminus">-	jQuery.fn.offset = function() {</span>
<a href="#l23.4188"></a><span id="l23.4188" class="difflineminus">-		if ( !this[0] ) return { top: 0, left: 0 };</span>
<a href="#l23.4189"></a><span id="l23.4189" class="difflineminus">-		if ( this[0] === this[0].ownerDocument.body ) return jQuery.offset.bodyOffset( this[0] );</span>
<a href="#l23.4190"></a><span id="l23.4190" class="difflineminus">-		jQuery.offset.initialized || jQuery.offset.initialize();</span>
<a href="#l23.4191"></a><span id="l23.4191" class="difflineminus">-</span>
<a href="#l23.4192"></a><span id="l23.4192" class="difflineminus">-		var elem = this[0], offsetParent = elem.offsetParent, prevOffsetParent = elem,</span>
<a href="#l23.4193"></a><span id="l23.4193" class="difflineminus">-			doc = elem.ownerDocument, computedStyle, docElem = doc.documentElement,</span>
<a href="#l23.4194"></a><span id="l23.4194" class="difflineminus">-			body = doc.body, defaultView = doc.defaultView,</span>
<a href="#l23.4195"></a><span id="l23.4195" class="difflineminus">-			prevComputedStyle = defaultView.getComputedStyle(elem, null),</span>
<a href="#l23.4196"></a><span id="l23.4196" class="difflineminus">-			top = elem.offsetTop, left = elem.offsetLeft;</span>
<a href="#l23.4197"></a><span id="l23.4197" class="difflineminus">-</span>
<a href="#l23.4198"></a><span id="l23.4198" class="difflineminus">-		while ( (elem = elem.parentNode) &amp;&amp; elem !== body &amp;&amp; elem !== docElem ) {</span>
<a href="#l23.4199"></a><span id="l23.4199" class="difflineminus">-			computedStyle = defaultView.getComputedStyle(elem, null);</span>
<a href="#l23.4200"></a><span id="l23.4200" class="difflineminus">-			top -= elem.scrollTop, left -= elem.scrollLeft;</span>
<a href="#l23.4201"></a><span id="l23.4201" class="difflineminus">-			if ( elem === offsetParent ) {</span>
<a href="#l23.4202"></a><span id="l23.4202" class="difflineminus">-				top += elem.offsetTop, left += elem.offsetLeft;</span>
<a href="#l23.4203"></a><span id="l23.4203" class="difflineminus">-				if ( jQuery.offset.doesNotAddBorder &amp;&amp; !(jQuery.offset.doesAddBorderForTableAndCells &amp;&amp; /^t(able|d|h)$/i.test(elem.tagName)) )</span>
<a href="#l23.4204"></a><span id="l23.4204" class="difflineminus">-					top  += parseInt( computedStyle.borderTopWidth,  10) || 0,</span>
<a href="#l23.4205"></a><span id="l23.4205" class="difflineminus">-					left += parseInt( computedStyle.borderLeftWidth, 10) || 0;</span>
<a href="#l23.4206"></a><span id="l23.4206" class="difflineminus">-				prevOffsetParent = offsetParent, offsetParent = elem.offsetParent;</span>
<a href="#l23.4207"></a><span id="l23.4207" class="difflineminus">-			}</span>
<a href="#l23.4208"></a><span id="l23.4208" class="difflineminus">-			if ( jQuery.offset.subtractsBorderForOverflowNotVisible &amp;&amp; computedStyle.overflow !== &quot;visible&quot; )</span>
<a href="#l23.4209"></a><span id="l23.4209" class="difflineminus">-				top  += parseInt( computedStyle.borderTopWidth,  10) || 0,</span>
<a href="#l23.4210"></a><span id="l23.4210" class="difflineminus">-				left += parseInt( computedStyle.borderLeftWidth, 10) || 0;</span>
<a href="#l23.4211"></a><span id="l23.4211" class="difflineminus">-			prevComputedStyle = computedStyle;</span>
<a href="#l23.4212"></a><span id="l23.4212" class="difflineminus">-		}</span>
<a href="#l23.4213"></a><span id="l23.4213" class="difflineminus">-</span>
<a href="#l23.4214"></a><span id="l23.4214" class="difflineminus">-		if ( prevComputedStyle.position === &quot;relative&quot; || prevComputedStyle.position === &quot;static&quot; )</span>
<a href="#l23.4215"></a><span id="l23.4215" class="difflineminus">-			top  += body.offsetTop,</span>
<a href="#l23.4216"></a><span id="l23.4216" class="difflineminus">-			left += body.offsetLeft;</span>
<a href="#l23.4217"></a><span id="l23.4217" class="difflineminus">-</span>
<a href="#l23.4218"></a><span id="l23.4218" class="difflineminus">-		if ( prevComputedStyle.position === &quot;fixed&quot; )</span>
<a href="#l23.4219"></a><span id="l23.4219" class="difflineminus">-			top  += Math.max(docElem.scrollTop, body.scrollTop),</span>
<a href="#l23.4220"></a><span id="l23.4220" class="difflineminus">-			left += Math.max(docElem.scrollLeft, body.scrollLeft);</span>
<a href="#l23.4221"></a><span id="l23.4221" class="difflineminus">-</span>
<a href="#l23.4222"></a><span id="l23.4222" class="difflineminus">-		return { top: top, left: left };</span>
<a href="#l23.4223"></a><span id="l23.4223" class="difflineminus">-	};</span>
<a href="#l23.4224"></a><span id="l23.4224" class="difflineminus">-</span>
<a href="#l23.4225"></a><span id="l23.4225" class="difflineminus">-jQuery.offset = {</span>
<a href="#l23.4226"></a><span id="l23.4226" class="difflineminus">-	initialize: function() {</span>
<a href="#l23.4227"></a><span id="l23.4227" class="difflineminus">-		if ( this.initialized ) return;</span>
<a href="#l23.4228"></a><span id="l23.4228" class="difflineminus">-		var body = document.body, container = document.createElement('div'), innerDiv, checkDiv, table, td, rules, prop, bodyMarginTop = body.style.marginTop,</span>
<a href="#l23.4229"></a><span id="l23.4229" class="difflineminus">-			html = '&lt;div style=&quot;position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;&quot;&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&lt;table style=&quot;position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;';</span>
<a href="#l23.4230"></a><span id="l23.4230" class="difflineminus">-</span>
<a href="#l23.4231"></a><span id="l23.4231" class="difflineminus">-		rules = { position: 'absolute', top: 0, left: 0, margin: 0, border: 0, width: '1px', height: '1px', visibility: 'hidden' };</span>
<a href="#l23.4232"></a><span id="l23.4232" class="difflineminus">-		for ( prop in rules ) container.style[prop] = rules[prop];</span>
<a href="#l23.4233"></a><span id="l23.4233" class="difflineminus">-</span>
<a href="#l23.4234"></a><span id="l23.4234" class="difflineminus">-		container.innerHTML = html;</span>
<a href="#l23.4235"></a><span id="l23.4235" class="difflineminus">-		body.insertBefore(container, body.firstChild);</span>
<a href="#l23.4236"></a><span id="l23.4236" class="difflineminus">-		innerDiv = container.firstChild, checkDiv = innerDiv.firstChild, td = innerDiv.nextSibling.firstChild.firstChild;</span>
<a href="#l23.4237"></a><span id="l23.4237" class="difflineminus">-</span>
<a href="#l23.4238"></a><span id="l23.4238" class="difflineminus">-		this.doesNotAddBorder = (checkDiv.offsetTop !== 5);</span>
<a href="#l23.4239"></a><span id="l23.4239" class="difflineminus">-		this.doesAddBorderForTableAndCells = (td.offsetTop === 5);</span>
<a href="#l23.4240"></a><span id="l23.4240" class="difflineminus">-</span>
<a href="#l23.4241"></a><span id="l23.4241" class="difflineminus">-		innerDiv.style.overflow = 'hidden', innerDiv.style.position = 'relative';</span>
<a href="#l23.4242"></a><span id="l23.4242" class="difflineminus">-		this.subtractsBorderForOverflowNotVisible = (checkDiv.offsetTop === -5);</span>
<a href="#l23.4243"></a><span id="l23.4243" class="difflineminus">-</span>
<a href="#l23.4244"></a><span id="l23.4244" class="difflineminus">-		body.style.marginTop = '1px';</span>
<a href="#l23.4245"></a><span id="l23.4245" class="difflineminus">-		this.doesNotIncludeMarginInBodyOffset = (body.offsetTop === 0);</span>
<a href="#l23.4246"></a><span id="l23.4246" class="difflineminus">-		body.style.marginTop = bodyMarginTop;</span>
<a href="#l23.4247"></a><span id="l23.4247" class="difflineminus">-</span>
<a href="#l23.4248"></a><span id="l23.4248" class="difflineminus">-		body.removeChild(container);</span>
<a href="#l23.4249"></a><span id="l23.4249" class="difflineminus">-		this.initialized = true;</span>
<a href="#l23.4250"></a><span id="l23.4250" class="difflineminus">-	},</span>
<a href="#l23.4251"></a><span id="l23.4251" class="difflineminus">-</span>
<a href="#l23.4252"></a><span id="l23.4252" class="difflineminus">-	bodyOffset: function(body) {</span>
<a href="#l23.4253"></a><span id="l23.4253" class="difflineminus">-		jQuery.offset.initialized || jQuery.offset.initialize();</span>
<a href="#l23.4254"></a><span id="l23.4254" class="difflineminus">-		var top = body.offsetTop, left = body.offsetLeft;</span>
<a href="#l23.4255"></a><span id="l23.4255" class="difflineminus">-		if ( jQuery.offset.doesNotIncludeMarginInBodyOffset )</span>
<a href="#l23.4256"></a><span id="l23.4256" class="difflineminus">-			top  += parseInt( jQuery.curCSS(body, 'marginTop',  true), 10 ) || 0,</span>
<a href="#l23.4257"></a><span id="l23.4257" class="difflineminus">-			left += parseInt( jQuery.curCSS(body, 'marginLeft', true), 10 ) || 0;</span>
<a href="#l23.4258"></a><span id="l23.4258" class="difflineminus">-		return { top: top, left: left };</span>
<a href="#l23.4259"></a><span id="l23.4259" class="difflineminus">-	}</span>
<a href="#l23.4260"></a><span id="l23.4260" class="difflineminus">-};</span>
<a href="#l23.4261"></a><span id="l23.4261" class="difflineminus">-</span>
<a href="#l23.4262"></a><span id="l23.4262" class="difflineminus">-</span>
<a href="#l23.4263"></a><span id="l23.4263" class="difflineminus">-jQuery.fn.extend({</span>
<a href="#l23.4264"></a><span id="l23.4264" class="difflineminus">-	position: function() {</span>
<a href="#l23.4265"></a><span id="l23.4265" class="difflineminus">-		var left = 0, top = 0, results;</span>
<a href="#l23.4266"></a><span id="l23.4266" class="difflineminus">-</span>
<a href="#l23.4267"></a><span id="l23.4267" class="difflineminus">-		if ( this[0] ) {</span>
<a href="#l23.4268"></a><span id="l23.4268" class="difflineminus">-			// Get *real* offsetParent</span>
<a href="#l23.4269"></a><span id="l23.4269" class="difflineminus">-			var offsetParent = this.offsetParent(),</span>
<a href="#l23.4270"></a><span id="l23.4270" class="difflineminus">-</span>
<a href="#l23.4271"></a><span id="l23.4271" class="difflineminus">-			// Get correct offsets</span>
<a href="#l23.4272"></a><span id="l23.4272" class="difflineminus">-			offset       = this.offset(),</span>
<a href="#l23.4273"></a><span id="l23.4273" class="difflineminus">-			parentOffset = /^body|html$/i.test(offsetParent[0].tagName) ? { top: 0, left: 0 } : offsetParent.offset();</span>
<a href="#l23.4274"></a><span id="l23.4274" class="difflineminus">-</span>
<a href="#l23.4275"></a><span id="l23.4275" class="difflineminus">-			// Subtract element margins</span>
<a href="#l23.4276"></a><span id="l23.4276" class="difflineminus">-			// note: when an element has margin: auto the offsetLeft and marginLeft </span>
<a href="#l23.4277"></a><span id="l23.4277" class="difflineminus">-			// are the same in Safari causing offset.left to incorrectly be 0</span>
<a href="#l23.4278"></a><span id="l23.4278" class="difflineminus">-			offset.top  -= num( this, 'marginTop'  );</span>
<a href="#l23.4279"></a><span id="l23.4279" class="difflineminus">-			offset.left -= num( this, 'marginLeft' );</span>
<a href="#l23.4280"></a><span id="l23.4280" class="difflineminus">-</span>
<a href="#l23.4281"></a><span id="l23.4281" class="difflineminus">-			// Add offsetParent borders</span>
<a href="#l23.4282"></a><span id="l23.4282" class="difflineminus">-			parentOffset.top  += num( offsetParent, 'borderTopWidth'  );</span>
<a href="#l23.4283"></a><span id="l23.4283" class="difflineminus">-			parentOffset.left += num( offsetParent, 'borderLeftWidth' );</span>
<a href="#l23.4284"></a><span id="l23.4284" class="difflineminus">-</span>
<a href="#l23.4285"></a><span id="l23.4285" class="difflineminus">-			// Subtract the two offsets</span>
<a href="#l23.4286"></a><span id="l23.4286" class="difflineminus">-			results = {</span>
<a href="#l23.4287"></a><span id="l23.4287" class="difflineminus">-				top:  offset.top  - parentOffset.top,</span>
<a href="#l23.4288"></a><span id="l23.4288" class="difflineminus">-				left: offset.left - parentOffset.left</span>
<a href="#l23.4289"></a><span id="l23.4289" class="difflineminus">-			};</span>
<a href="#l23.4290"></a><span id="l23.4290" class="difflineminus">-		}</span>
<a href="#l23.4291"></a><span id="l23.4291" class="difflineminus">-</span>
<a href="#l23.4292"></a><span id="l23.4292" class="difflineminus">-		return results;</span>
<a href="#l23.4293"></a><span id="l23.4293" class="difflineminus">-	},</span>
<a href="#l23.4294"></a><span id="l23.4294" class="difflineminus">-</span>
<a href="#l23.4295"></a><span id="l23.4295" class="difflineminus">-	offsetParent: function() {</span>
<a href="#l23.4296"></a><span id="l23.4296" class="difflineminus">-		var offsetParent = this[0].offsetParent || document.body;</span>
<a href="#l23.4297"></a><span id="l23.4297" class="difflineminus">-		while ( offsetParent &amp;&amp; (!/^body|html$/i.test(offsetParent.tagName) &amp;&amp; jQuery.css(offsetParent, 'position') == 'static') )</span>
<a href="#l23.4298"></a><span id="l23.4298" class="difflineminus">-			offsetParent = offsetParent.offsetParent;</span>
<a href="#l23.4299"></a><span id="l23.4299" class="difflineminus">-		return jQuery(offsetParent);</span>
<a href="#l23.4300"></a><span id="l23.4300" class="difflineminus">-	}</span>
<a href="#l23.4301"></a><span id="l23.4301" class="difflineminus">-});</span>
<a href="#l23.4302"></a><span id="l23.4302" class="difflineminus">-</span>
<a href="#l23.4303"></a><span id="l23.4303" class="difflineminus">-</span>
<a href="#l23.4304"></a><span id="l23.4304" class="difflineminus">-// Create scrollLeft and scrollTop methods</span>
<a href="#l23.4305"></a><span id="l23.4305" class="difflineminus">-jQuery.each( ['Left', 'Top'], function(i, name) {</span>
<a href="#l23.4306"></a><span id="l23.4306" class="difflineminus">-	var method = 'scroll' + name;</span>
<a href="#l23.4307"></a><span id="l23.4307" class="difflineminus">-	</span>
<a href="#l23.4308"></a><span id="l23.4308" class="difflineminus">-	jQuery.fn[ method ] = function(val) {</span>
<a href="#l23.4309"></a><span id="l23.4309" class="difflineminus">-		if (!this[0]) return null;</span>
<a href="#l23.4310"></a><span id="l23.4310" class="difflineminus">-</span>
<a href="#l23.4311"></a><span id="l23.4311" class="difflineminus">-		return val !== undefined ?</span>
<a href="#l23.4312"></a><span id="l23.4312" class="difflineminus">-</span>
<a href="#l23.4313"></a><span id="l23.4313" class="difflineminus">-			// Set the scroll offset</span>
<a href="#l23.4314"></a><span id="l23.4314" class="difflineminus">-			this.each(function() {</span>
<a href="#l23.4315"></a><span id="l23.4315" class="difflineminus">-				this == window || this == document ?</span>
<a href="#l23.4316"></a><span id="l23.4316" class="difflineminus">-					window.scrollTo(</span>
<a href="#l23.4317"></a><span id="l23.4317" class="difflineminus">-						!i ? val : jQuery(window).scrollLeft(),</span>
<a href="#l23.4318"></a><span id="l23.4318" class="difflineminus">-						 i ? val : jQuery(window).scrollTop()</span>
<a href="#l23.4319"></a><span id="l23.4319" class="difflineminus">-					) :</span>
<a href="#l23.4320"></a><span id="l23.4320" class="difflineminus">-					this[ method ] = val;</span>
<a href="#l23.4321"></a><span id="l23.4321" class="difflineminus">-			}) :</span>
<a href="#l23.4322"></a><span id="l23.4322" class="difflineminus">-</span>
<a href="#l23.4323"></a><span id="l23.4323" class="difflineminus">-			// Return the scroll offset</span>
<a href="#l23.4324"></a><span id="l23.4324" class="difflineminus">-			this[0] == window || this[0] == document ?</span>
<a href="#l23.4325"></a><span id="l23.4325" class="difflineminus">-				self[ i ? 'pageYOffset' : 'pageXOffset' ] ||</span>
<a href="#l23.4326"></a><span id="l23.4326" class="difflineminus">-					jQuery.boxModel &amp;&amp; document.documentElement[ method ] ||</span>
<a href="#l23.4327"></a><span id="l23.4327" class="difflineminus">-					document.body[ method ] :</span>
<a href="#l23.4328"></a><span id="l23.4328" class="difflineminus">-				this[0][ method ];</span>
<a href="#l23.4329"></a><span id="l23.4329" class="difflineminus">-	};</span>
<a href="#l23.4330"></a><span id="l23.4330" class="difflineminus">-});</span>
<a href="#l23.4331"></a><span id="l23.4331" class="difflineminus">-// Create innerHeight, innerWidth, outerHeight and outerWidth methods</span>
<a href="#l23.4332"></a><span id="l23.4332" class="difflineminus">-jQuery.each([ &quot;Height&quot;, &quot;Width&quot; ], function(i, name){</span>
<a href="#l23.4333"></a><span id="l23.4333" class="difflineminus">-</span>
<a href="#l23.4334"></a><span id="l23.4334" class="difflineminus">-	var tl = i ? &quot;Left&quot;  : &quot;Top&quot;,  // top or left</span>
<a href="#l23.4335"></a><span id="l23.4335" class="difflineminus">-		br = i ? &quot;Right&quot; : &quot;Bottom&quot;, // bottom or right</span>
<a href="#l23.4336"></a><span id="l23.4336" class="difflineminus">-		lower = name.toLowerCase();</span>
<a href="#l23.4337"></a><span id="l23.4337" class="difflineminus">-</span>
<a href="#l23.4338"></a><span id="l23.4338" class="difflineminus">-	// innerHeight and innerWidth</span>
<a href="#l23.4339"></a><span id="l23.4339" class="difflineminus">-	jQuery.fn[&quot;inner&quot; + name] = function(){</span>
<a href="#l23.4340"></a><span id="l23.4340" class="difflineminus">-		return this[0] ?</span>
<a href="#l23.4341"></a><span id="l23.4341" class="difflineminus">-			jQuery.css( this[0], lower, false, &quot;padding&quot; ) :</span>
<a href="#l23.4342"></a><span id="l23.4342" class="difflineminus">-			null;</span>
<a href="#l23.4343"></a><span id="l23.4343" class="difflineminus">-	};</span>
<a href="#l23.4344"></a><span id="l23.4344" class="difflineminus">-</span>
<a href="#l23.4345"></a><span id="l23.4345" class="difflineminus">-	// outerHeight and outerWidth</span>
<a href="#l23.4346"></a><span id="l23.4346" class="difflineminus">-	jQuery.fn[&quot;outer&quot; + name] = function(margin) {</span>
<a href="#l23.4347"></a><span id="l23.4347" class="difflineminus">-		return this[0] ?</span>
<a href="#l23.4348"></a><span id="l23.4348" class="difflineminus">-			jQuery.css( this[0], lower, false, margin ? &quot;margin&quot; : &quot;border&quot; ) :</span>
<a href="#l23.4349"></a><span id="l23.4349" class="difflineminus">-			null;</span>
<a href="#l23.4350"></a><span id="l23.4350" class="difflineminus">-	};</span>
<a href="#l23.4351"></a><span id="l23.4351" class="difflineminus">-	</span>
<a href="#l23.4352"></a><span id="l23.4352" class="difflineminus">-	var type = name.toLowerCase();</span>
<a href="#l23.4353"></a><span id="l23.4353" class="difflineminus">-</span>
<a href="#l23.4354"></a><span id="l23.4354" class="difflineminus">-	jQuery.fn[ type ] = function( size ) {</span>
<a href="#l23.4355"></a><span id="l23.4355" class="difflineminus">-		// Get window width or height</span>
<a href="#l23.4356"></a><span id="l23.4356" class="difflineminus">-		return this[0] == window ?</span>
<a href="#l23.4357"></a><span id="l23.4357" class="difflineminus">-			// Everyone else use document.documentElement or document.body depending on Quirks vs Standards mode</span>
<a href="#l23.4358"></a><span id="l23.4358" class="difflineminus">-			document.compatMode == &quot;CSS1Compat&quot; &amp;&amp; document.documentElement[ &quot;client&quot; + name ] ||</span>
<a href="#l23.4359"></a><span id="l23.4359" class="difflineminus">-			document.body[ &quot;client&quot; + name ] :</span>
<a href="#l23.4360"></a><span id="l23.4360" class="difflineminus">-</span>
<a href="#l23.4361"></a><span id="l23.4361" class="difflineminus">-			// Get document width or height</span>
<a href="#l23.4362"></a><span id="l23.4362" class="difflineminus">-			this[0] == document ?</span>
<a href="#l23.4363"></a><span id="l23.4363" class="difflineminus">-				// Either scroll[Width/Height] or offset[Width/Height], whichever is greater</span>
<a href="#l23.4364"></a><span id="l23.4364" class="difflineminus">-				Math.max(</span>
<a href="#l23.4365"></a><span id="l23.4365" class="difflineminus">-					document.documentElement[&quot;client&quot; + name],</span>
<a href="#l23.4366"></a><span id="l23.4366" class="difflineminus">-					document.body[&quot;scroll&quot; + name], document.documentElement[&quot;scroll&quot; + name],</span>
<a href="#l23.4367"></a><span id="l23.4367" class="difflineminus">-					document.body[&quot;offset&quot; + name], document.documentElement[&quot;offset&quot; + name]</span>
<a href="#l23.4368"></a><span id="l23.4368" class="difflineminus">-				) :</span>
<a href="#l23.4369"></a><span id="l23.4369" class="difflineminus">-</span>
<a href="#l23.4370"></a><span id="l23.4370" class="difflineminus">-				// Get or set width or height on the element</span>
<a href="#l23.4371"></a><span id="l23.4371" class="difflineminus">-				size === undefined ?</span>
<a href="#l23.4372"></a><span id="l23.4372" class="difflineminus">-					// Get width or height on the element</span>
<a href="#l23.4373"></a><span id="l23.4373" class="difflineminus">-					(this.length ? jQuery.css( this[0], type ) : null) :</span>
<a href="#l23.4374"></a><span id="l23.4374" class="difflineminus">-</span>
<a href="#l23.4375"></a><span id="l23.4375" class="difflineminus">-					// Set the width or height on the element (default to pixels if value is unitless)</span>
<a href="#l23.4376"></a><span id="l23.4376" class="difflineminus">-					this.css( type, typeof size === &quot;string&quot; ? size : size + &quot;px&quot; );</span>
<a href="#l23.4377"></a><span id="l23.4377" class="difflineminus">-	};</span>
<a href="#l23.4378"></a><span id="l23.4378" class="difflineminus">-</span>
<a href="#l23.4379"></a><span id="l23.4379" class="difflineminus">-});</span>
<a href="#l23.4380"></a><span id="l23.4380" class="difflineminus">-})();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1">deleted file mode 100644</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/notificationBindings.xml</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineplus">+++ /dev/null</span>
<a href="#l24.4"></a><span id="l24.4" class="difflineat">@@ -1,70 +0,0 @@</span>
<a href="#l24.5"></a><span id="l24.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l24.6"></a><span id="l24.6" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l24.7"></a><span id="l24.7" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l24.8"></a><span id="l24.8" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l24.9"></a><span id="l24.9" class="difflineminus">-</span>
<a href="#l24.10"></a><span id="l24.10" class="difflineminus">-&lt;!-- Remember to keep this up to date with the changes to base binding </span>
<a href="#l24.11"></a><span id="l24.11" class="difflineminus">-     at http://hg.mozilla.org/mozilla-central/file/tip/toolkit/content/widgets/notification.xml--&gt;</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineminus">-&lt;!DOCTYPE bindings [</span>
<a href="#l24.14"></a><span id="l24.14" class="difflineminus">-&lt;!ENTITY % notificationDTD SYSTEM &quot;chrome://global/locale/notification.dtd&quot;&gt;</span>
<a href="#l24.15"></a><span id="l24.15" class="difflineminus">-%notificationDTD;</span>
<a href="#l24.16"></a><span id="l24.16" class="difflineminus">-]&gt;</span>
<a href="#l24.17"></a><span id="l24.17" class="difflineminus">-</span>
<a href="#l24.18"></a><span id="l24.18" class="difflineminus">-&lt;bindings id=&quot;popupBindings&quot;</span>
<a href="#l24.19"></a><span id="l24.19" class="difflineminus">-   xmlns=&quot;http://www.mozilla.org/xbl&quot;</span>
<a href="#l24.20"></a><span id="l24.20" class="difflineminus">-   xmlns:xul=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l24.21"></a><span id="l24.21" class="difflineminus">-   xmlns:xbl=&quot;http://www.mozilla.org/xbl&quot;&gt;</span>
<a href="#l24.22"></a><span id="l24.22" class="difflineminus">-</span>
<a href="#l24.23"></a><span id="l24.23" class="difflineminus">-  &lt;binding id=&quot;testpilot-notification&quot;</span>
<a href="#l24.24"></a><span id="l24.24" class="difflineminus">-           extends=&quot;chrome://global/content/bindings/notification.xml#popup-notification&quot;&gt;</span>
<a href="#l24.25"></a><span id="l24.25" class="difflineminus">-    &lt;content align=&quot;start&quot;&gt;</span>
<a href="#l24.26"></a><span id="l24.26" class="difflineminus">-      &lt;xul:image class=&quot;popup-notification-icon&quot; anonid=&quot;notification-icon&quot;</span>
<a href="#l24.27"></a><span id="l24.27" class="difflineminus">-                 xbl:inherits=&quot;popupid&quot;/&gt;</span>
<a href="#l24.28"></a><span id="l24.28" class="difflineminus">-      &lt;xul:vbox flex=&quot;1&quot;&gt;</span>
<a href="#l24.29"></a><span id="l24.29" class="difflineminus">-        &lt;xul:label anonid=&quot;notification-title&quot; class=&quot;testpilot-notification-title&quot;/&gt;</span>
<a href="#l24.30"></a><span id="l24.30" class="difflineminus">-        &lt;xul:description class=&quot;popup-notification-description&quot;</span>
<a href="#l24.31"></a><span id="l24.31" class="difflineminus">-                         xbl:inherits=&quot;xbl:text=label&quot;/&gt;</span>
<a href="#l24.32"></a><span id="l24.32" class="difflineminus">-        &lt;xul:spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l24.33"></a><span id="l24.33" class="difflineminus">-        &lt;xul:hbox class=&quot;popup-notification-button-container&quot;</span>
<a href="#l24.34"></a><span id="l24.34" class="difflineminus">-                  pack=&quot;end&quot; align=&quot;center&quot;&gt;</span>
<a href="#l24.35"></a><span id="l24.35" class="difflineminus">-          &lt;xul:button anonid=&quot;button&quot;</span>
<a href="#l24.36"></a><span id="l24.36" class="difflineminus">-                      class=&quot;popup-notification-menubutton&quot;</span>
<a href="#l24.37"></a><span id="l24.37" class="difflineminus">-                      type=&quot;menu-button&quot;</span>
<a href="#l24.38"></a><span id="l24.38" class="difflineminus">-                      xbl:inherits=&quot;oncommand=buttoncommand,label=buttonlabel,accesskey=buttonaccesskey&quot;&gt;</span>
<a href="#l24.39"></a><span id="l24.39" class="difflineminus">-            &lt;xul:menupopup anonid=&quot;menupopup&quot;</span>
<a href="#l24.40"></a><span id="l24.40" class="difflineminus">-                           xbl:inherits=&quot;oncommand=menucommand&quot;&gt;</span>
<a href="#l24.41"></a><span id="l24.41" class="difflineminus">-              &lt;children/&gt;</span>
<a href="#l24.42"></a><span id="l24.42" class="difflineminus">-              &lt;xul:menuitem class=&quot;menuitem-iconic popup-notification-closeitem&quot;</span>
<a href="#l24.43"></a><span id="l24.43" class="difflineminus">-                            label=&quot;&amp;closeNotificationItem.label;&quot;</span>
<a href="#l24.44"></a><span id="l24.44" class="difflineminus">-                            xbl:inherits=&quot;oncommand=closeitemcommand&quot;/&gt;</span>
<a href="#l24.45"></a><span id="l24.45" class="difflineminus">-            &lt;/xul:menupopup&gt;</span>
<a href="#l24.46"></a><span id="l24.46" class="difflineminus">-          &lt;/xul:button&gt;</span>
<a href="#l24.47"></a><span id="l24.47" class="difflineminus">-</span>
<a href="#l24.48"></a><span id="l24.48" class="difflineminus">-        &lt;/xul:hbox&gt;</span>
<a href="#l24.49"></a><span id="l24.49" class="difflineminus">-      &lt;/xul:vbox&gt;</span>
<a href="#l24.50"></a><span id="l24.50" class="difflineminus">-      &lt;xul:vbox pack=&quot;start&quot;&gt;</span>
<a href="#l24.51"></a><span id="l24.51" class="difflineminus">-        &lt;xul:toolbarbutton anonid=&quot;closebutton&quot;</span>
<a href="#l24.52"></a><span id="l24.52" class="difflineminus">-                           class=&quot;messageCloseButton popup-notification-closebutton tabbable&quot;</span>
<a href="#l24.53"></a><span id="l24.53" class="difflineminus">-                           xbl:inherits=&quot;oncommand=closebuttoncommand&quot;</span>
<a href="#l24.54"></a><span id="l24.54" class="difflineminus">-                           tooltiptext=&quot;&amp;closeNotification.tooltip;&quot;/&gt;</span>
<a href="#l24.55"></a><span id="l24.55" class="difflineminus">-      &lt;/xul:vbox&gt;</span>
<a href="#l24.56"></a><span id="l24.56" class="difflineminus">-    &lt;/content&gt;</span>
<a href="#l24.57"></a><span id="l24.57" class="difflineminus">-    &lt;implementation&gt;</span>
<a href="#l24.58"></a><span id="l24.58" class="difflineminus">-      &lt;constructor&gt;&lt;![CDATA[</span>
<a href="#l24.59"></a><span id="l24.59" class="difflineminus">-        this.title.value = this.notification.options.title;</span>
<a href="#l24.60"></a><span id="l24.60" class="difflineminus">-        this.icon.setAttribute(&quot;class&quot;, &quot;popup-notification-icon &quot; + this.notification.options.iconClass);</span>
<a href="#l24.61"></a><span id="l24.61" class="difflineminus">-        this.closebutton.addEventListener(&quot;command&quot;,</span>
<a href="#l24.62"></a><span id="l24.62" class="difflineminus">-                                          this.notification.options.closeButtonFunc,</span>
<a href="#l24.63"></a><span id="l24.63" class="difflineminus">-                                          false);</span>
<a href="#l24.64"></a><span id="l24.64" class="difflineminus">-        ]]&gt;</span>
<a href="#l24.65"></a><span id="l24.65" class="difflineminus">-      &lt;/constructor&gt;</span>
<a href="#l24.66"></a><span id="l24.66" class="difflineminus">-      &lt;field name=&quot;title&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l24.67"></a><span id="l24.67" class="difflineminus">-        document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;notification-title&quot;);</span>
<a href="#l24.68"></a><span id="l24.68" class="difflineminus">-      &lt;/field&gt;</span>
<a href="#l24.69"></a><span id="l24.69" class="difflineminus">-      &lt;field name=&quot;icon&quot; readonly=&quot;true&quot;&gt;</span>
<a href="#l24.70"></a><span id="l24.70" class="difflineminus">-        document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;notification-icon&quot;);</span>
<a href="#l24.71"></a><span id="l24.71" class="difflineminus">-      &lt;/field&gt;</span>
<a href="#l24.72"></a><span id="l24.72" class="difflineminus">-    &lt;/implementation&gt;</span>
<a href="#l24.73"></a><span id="l24.73" class="difflineminus">-  &lt;/binding&gt;</span>
<a href="#l24.74"></a><span id="l24.74" class="difflineminus">-&lt;/bindings&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1">deleted file mode 100644</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/raw-data-dialog.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineplus">+++ /dev/null</span>
<a href="#l25.4"></a><span id="l25.4" class="difflineat">@@ -1,55 +0,0 @@</span>
<a href="#l25.5"></a><span id="l25.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l25.6"></a><span id="l25.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l25.7"></a><span id="l25.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l25.8"></a><span id="l25.8" class="difflineminus">-</span>
<a href="#l25.9"></a><span id="l25.9" class="difflineminus">-const Cu = Components.utils;</span>
<a href="#l25.10"></a><span id="l25.10" class="difflineminus">-</span>
<a href="#l25.11"></a><span id="l25.11" class="difflineminus">-Cu.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineminus">-function showdbcontents() {</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineminus">-  // experimentId is passed in through window.openDialog.  Access it like so:</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineminus">-  var experimentId = window.arguments[0];</span>
<a href="#l25.16"></a><span id="l25.16" class="difflineminus">-  var experiment = TestPilotSetup.getTaskById(experimentId);</span>
<a href="#l25.17"></a><span id="l25.17" class="difflineminus">-  var dataStore = experiment.dataStore;</span>
<a href="#l25.18"></a><span id="l25.18" class="difflineminus">-  var experimentTitle = experiment.title;</span>
<a href="#l25.19"></a><span id="l25.19" class="difflineminus">-  var listbox = document.getElementById(&quot;raw-data-listbox&quot;);</span>
<a href="#l25.20"></a><span id="l25.20" class="difflineminus">-  var columnNames = dataStore.getHumanReadableColumnNames();</span>
<a href="#l25.21"></a><span id="l25.21" class="difflineminus">-  var propertyNames = dataStore.getPropertyNames();</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineminus">-</span>
<a href="#l25.23"></a><span id="l25.23" class="difflineminus">-  // Set title of dialog box to match title of experiment:</span>
<a href="#l25.24"></a><span id="l25.24" class="difflineminus">-  var dialog = document.getElementById(&quot;raw-data-dialog&quot;);</span>
<a href="#l25.25"></a><span id="l25.25" class="difflineminus">-  var dialogTitle = dialog.getAttribute(&quot;title&quot;);</span>
<a href="#l25.26"></a><span id="l25.26" class="difflineminus">-  dialogTitle = dialogTitle + &quot;: &quot; + experimentTitle;</span>
<a href="#l25.27"></a><span id="l25.27" class="difflineminus">-  dialog.setAttribute(&quot;title&quot;, dialogTitle);</span>
<a href="#l25.28"></a><span id="l25.28" class="difflineminus">-</span>
<a href="#l25.29"></a><span id="l25.29" class="difflineminus">-  var i,j;</span>
<a href="#l25.30"></a><span id="l25.30" class="difflineminus">-  // Create the listcols and listheaders in the xul listbox to match the human</span>
<a href="#l25.31"></a><span id="l25.31" class="difflineminus">-  // readable column names provided:</span>
<a href="#l25.32"></a><span id="l25.32" class="difflineminus">-  var listcols = document.getElementById(&quot;raw-data-listcols&quot;);</span>
<a href="#l25.33"></a><span id="l25.33" class="difflineminus">-  var listhead = document.getElementById(&quot;raw-data-listhead&quot;);</span>
<a href="#l25.34"></a><span id="l25.34" class="difflineminus">-  for (j = 0; j &lt; columnNames.length; j++) {</span>
<a href="#l25.35"></a><span id="l25.35" class="difflineminus">-    listcols.appendChild(document.createElement(&quot;listcol&quot;));</span>
<a href="#l25.36"></a><span id="l25.36" class="difflineminus">-    var newHeader = document.createElement(&quot;listheader&quot;);</span>
<a href="#l25.37"></a><span id="l25.37" class="difflineminus">-    newHeader.setAttribute(&quot;label&quot;, columnNames[j]);</span>
<a href="#l25.38"></a><span id="l25.38" class="difflineminus">-    listhead.appendChild(newHeader);</span>
<a href="#l25.39"></a><span id="l25.39" class="difflineminus">-  }</span>
<a href="#l25.40"></a><span id="l25.40" class="difflineminus">-</span>
<a href="#l25.41"></a><span id="l25.41" class="difflineminus">-  dataStore.getAllDataAsJSON(true, function(rawData) {</span>
<a href="#l25.42"></a><span id="l25.42" class="difflineminus">-    // Convert each object in the JSON into a row of the listbox.</span>
<a href="#l25.43"></a><span id="l25.43" class="difflineminus">-    for (i = 0; i &lt; rawData.length; i++) {</span>
<a href="#l25.44"></a><span id="l25.44" class="difflineminus">-      var row = document.createElement(&quot;listitem&quot;);</span>
<a href="#l25.45"></a><span id="l25.45" class="difflineminus">-      for (j = 0; j &lt; columnNames.length; j++) {</span>
<a href="#l25.46"></a><span id="l25.46" class="difflineminus">-        var cell = document.createElement(&quot;listcell&quot;);</span>
<a href="#l25.47"></a><span id="l25.47" class="difflineminus">-        var value = rawData[i][propertyNames[j]];</span>
<a href="#l25.48"></a><span id="l25.48" class="difflineminus">-        cell.setAttribute(&quot;label&quot;, value);</span>
<a href="#l25.49"></a><span id="l25.49" class="difflineminus">-        row.appendChild(cell);</span>
<a href="#l25.50"></a><span id="l25.50" class="difflineminus">-      }</span>
<a href="#l25.51"></a><span id="l25.51" class="difflineminus">-      listbox.appendChild(row);</span>
<a href="#l25.52"></a><span id="l25.52" class="difflineminus">-    }</span>
<a href="#l25.53"></a><span id="l25.53" class="difflineminus">-  });</span>
<a href="#l25.54"></a><span id="l25.54" class="difflineminus">-}</span>
<a href="#l25.55"></a><span id="l25.55" class="difflineminus">-</span>
<a href="#l25.56"></a><span id="l25.56" class="difflineminus">-// OK button for dialog box.</span>
<a href="#l25.57"></a><span id="l25.57" class="difflineminus">-function onAccept() {</span>
<a href="#l25.58"></a><span id="l25.58" class="difflineminus">-  return true;</span>
<a href="#l25.59"></a><span id="l25.59" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1">deleted file mode 100644</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/raw-data-dialog.xul</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineplus">+++ /dev/null</span>
<a href="#l26.4"></a><span id="l26.4" class="difflineat">@@ -1,27 +0,0 @@</span>
<a href="#l26.5"></a><span id="l26.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l26.6"></a><span id="l26.6" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l26.7"></a><span id="l26.7" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l26.8"></a><span id="l26.8" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l26.9"></a><span id="l26.9" class="difflineminus">-</span>
<a href="#l26.10"></a><span id="l26.10" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://global/skin/global.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l26.11"></a><span id="l26.11" class="difflineminus">-</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-&lt;!DOCTYPE dialog [</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineminus">-  &lt;!ENTITY % testpilotDTD SYSTEM &quot;chrome://testpilot/locale/main.dtd&quot;&gt;</span>
<a href="#l26.14"></a><span id="l26.14" class="difflineminus">-    %testpilotDTD;</span>
<a href="#l26.15"></a><span id="l26.15" class="difflineminus">-]&gt;</span>
<a href="#l26.16"></a><span id="l26.16" class="difflineminus">-</span>
<a href="#l26.17"></a><span id="l26.17" class="difflineminus">-&lt;dialog xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l26.18"></a><span id="l26.18" class="difflineminus">-        xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l26.19"></a><span id="l26.19" class="difflineminus">-	id=&quot;raw-data-dialog&quot; title=&quot;&amp;testpilot.rawDataWindow.title;&quot;</span>
<a href="#l26.20"></a><span id="l26.20" class="difflineminus">-	buttons=&quot;accept&quot;</span>
<a href="#l26.21"></a><span id="l26.21" class="difflineminus">-        onload=&quot;showdbcontents();&quot;</span>
<a href="#l26.22"></a><span id="l26.22" class="difflineminus">-	ondialogaccept=&quot;return onAccept();&quot;&gt;</span>
<a href="#l26.23"></a><span id="l26.23" class="difflineminus">-</span>
<a href="#l26.24"></a><span id="l26.24" class="difflineminus">-  &lt;script src=&quot;chrome://testpilot/content/raw-data-dialog.js&quot;/&gt;</span>
<a href="#l26.25"></a><span id="l26.25" class="difflineminus">-</span>
<a href="#l26.26"></a><span id="l26.26" class="difflineminus">-  &lt;listbox id=&quot;raw-data-listbox&quot; rows=&quot;20&quot;&gt;</span>
<a href="#l26.27"></a><span id="l26.27" class="difflineminus">-    &lt;listcols id=&quot;raw-data-listcols&quot;&gt;&lt;/listcols&gt;</span>
<a href="#l26.28"></a><span id="l26.28" class="difflineminus">-    &lt;listhead id=&quot;raw-data-listhead&quot;&gt;&lt;/listhead&gt;</span>
<a href="#l26.29"></a><span id="l26.29" class="difflineminus">-  &lt;/listbox&gt;</span>
<a href="#l26.30"></a><span id="l26.30" class="difflineminus">-</span>
<a href="#l26.31"></a><span id="l26.31" class="difflineminus">-&lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1">deleted file mode 100644</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/raw-data.html</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineplus">+++ /dev/null</span>
<a href="#l27.4"></a><span id="l27.4" class="difflineat">@@ -1,24 +0,0 @@</span>
<a href="#l27.5"></a><span id="l27.5" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l27.6"></a><span id="l27.6" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l27.7"></a><span id="l27.7" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l27.8"></a><span id="l27.8" class="difflineminus">-</span>
<a href="#l27.9"></a><span id="l27.9" class="difflineminus">-&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;</span>
<a href="#l27.10"></a><span id="l27.10" class="difflineminus">-	&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;</span>
<a href="#l27.11"></a><span id="l27.11" class="difflineminus">-</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;en&quot; lang=&quot;en&quot;&gt;</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineminus">-&lt;head&gt;</span>
<a href="#l27.14"></a><span id="l27.14" class="difflineminus">-  &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span>
<a href="#l27.15"></a><span id="l27.15" class="difflineminus">-&lt;title&gt;&lt;/title&gt;</span>
<a href="#l27.16"></a><span id="l27.16" class="difflineminus">-  &lt;script src=&quot;flot/jquery.js&quot; language=&quot;javascript&quot;</span>
<a href="#l27.17"></a><span id="l27.17" class="difflineminus">-    type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</span>
<a href="#l27.18"></a><span id="l27.18" class="difflineminus">-  &lt;script src=&quot;experiment-page.js&quot;</span>
<a href="#l27.19"></a><span id="l27.19" class="difflineminus">-    type=&quot;application/javascript;version=1.8&quot;&gt;&lt;/script&gt;</span>
<a href="#l27.20"></a><span id="l27.20" class="difflineminus">-</span>
<a href="#l27.21"></a><span id="l27.21" class="difflineminus">-&lt;/head&gt;</span>
<a href="#l27.22"></a><span id="l27.22" class="difflineminus">-&lt;body onload=&quot;showDbContentsHtml();&quot;&gt;</span>
<a href="#l27.23"></a><span id="l27.23" class="difflineminus">-</span>
<a href="#l27.24"></a><span id="l27.24" class="difflineminus">-&lt;table id=&quot;raw-data-table&quot;&gt;</span>
<a href="#l27.25"></a><span id="l27.25" class="difflineminus">-  &lt;tr id=&quot;raw-data-header-row&quot;&gt;&lt;/tr&gt;</span>
<a href="#l27.26"></a><span id="l27.26" class="difflineminus">-&lt;/table&gt;</span>
<a href="#l27.27"></a><span id="l27.27" class="difflineminus">-</span>
<a href="#l27.28"></a><span id="l27.28" class="difflineminus">-&lt;/body&gt; &lt;/html&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1">deleted file mode 100644</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/screen.css</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineplus">+++ /dev/null</span>
<a href="#l28.4"></a><span id="l28.4" class="difflineat">@@ -1,257 +0,0 @@</span>
<a href="#l28.5"></a><span id="l28.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l28.6"></a><span id="l28.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l28.7"></a><span id="l28.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l28.8"></a><span id="l28.8" class="difflineminus">-</span>
<a href="#l28.9"></a><span id="l28.9" class="difflineminus">-html {</span>
<a href="#l28.10"></a><span id="l28.10" class="difflineminus">-	padding-bottom: 0px; </span>
<a href="#l28.11"></a><span id="l28.11" class="difflineminus">-	padding-top: 20px;</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-	padding-left: 0px;</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineminus">-	padding-right: 0px;</span>
<a href="#l28.14"></a><span id="l28.14" class="difflineminus">-}</span>
<a href="#l28.15"></a><span id="l28.15" class="difflineminus">-</span>
<a href="#l28.16"></a><span id="l28.16" class="difflineminus">-body { </span>
<a href="#l28.17"></a><span id="l28.17" class="difflineminus">-	font-family: 'Lucida Grande', 'Lucida Sans Unicode', Lucida, Arial, Helvetica, sans-serif;</span>
<a href="#l28.18"></a><span id="l28.18" class="difflineminus">-	font-family: 'DroidSans';</span>
<a href="#l28.19"></a><span id="l28.19" class="difflineminus">-	background: #fff url('chrome://testpilot/skin/bg.jpg') repeat-x top center;</span>
<a href="#l28.20"></a><span id="l28.20" class="difflineminus">-	padding: 0px; </span>
<a href="#l28.21"></a><span id="l28.21" class="difflineminus">-	color:#787878;</span>
<a href="#l28.22"></a><span id="l28.22" class="difflineminus">-	font-size:12px;</span>
<a href="#l28.23"></a><span id="l28.23" class="difflineminus">-	line-height: 18px;</span>
<a href="#l28.24"></a><span id="l28.24" class="difflineminus">-	margin: 0 auto;</span>
<a href="#l28.25"></a><span id="l28.25" class="difflineminus">-	</span>
<a href="#l28.26"></a><span id="l28.26" class="difflineminus">-}</span>
<a href="#l28.27"></a><span id="l28.27" class="difflineminus">-</span>
<a href="#l28.28"></a><span id="l28.28" class="difflineminus">-	h1 {font-family: 'DroidSans'; color: #3a3a3a; font-size: 28px; font-weight: normal; letter-spacing: -1px}</span>
<a href="#l28.29"></a><span id="l28.29" class="difflineminus">-	h2 {font-family: 'DroidSans'; color: #54717b; font-size: 24px; line-height: 22px;font-weight: normal; letter-spacing: -1px}</span>
<a href="#l28.30"></a><span id="l28.30" class="difflineminus">-	</span>
<a href="#l28.31"></a><span id="l28.31" class="difflineminus">-	p, ul {font-size: 12px;}</span>
<a href="#l28.32"></a><span id="l28.32" class="difflineminus">-	</span>
<a href="#l28.33"></a><span id="l28.33" class="difflineminus">-	a:link, a:hover, a:active, a:focus, a:visited {color: #9f423b; text-decoration: none;}</span>
<a href="#l28.34"></a><span id="l28.34" class="difflineminus">-	a:hover {color: #9f423b; text-decoration: none;}</span>
<a href="#l28.35"></a><span id="l28.35" class="difflineminus">-	</span>
<a href="#l28.36"></a><span id="l28.36" class="difflineminus">-	.bold {font-family: 'DroidSans-Bold'; color:#3a3a3a;}</span>
<a href="#l28.37"></a><span id="l28.37" class="difflineminus">-	.address {margin-left: 20px;}</span>
<a href="#l28.38"></a><span id="l28.38" class="difflineminus">-	.inactive {color:#ccc;}</span>
<a href="#l28.39"></a><span id="l28.39" class="difflineminus">-	</span>
<a href="#l28.40"></a><span id="l28.40" class="difflineminus">-	li {list-style-type: circle;}</span>
<a href="#l28.41"></a><span id="l28.41" class="difflineminus">-</span>
<a href="#l28.42"></a><span id="l28.42" class="difflineminus">-	.spacer {height: 75px;}</span>
<a href="#l28.43"></a><span id="l28.43" class="difflineminus">-</span>
<a href="#l28.44"></a><span id="l28.44" class="difflineminus">-</span>
<a href="#l28.45"></a><span id="l28.45" class="difflineminus">-@font-face{</span>
<a href="#l28.46"></a><span id="l28.46" class="difflineminus">-font-family: 'DroidSans'; </span>
<a href="#l28.47"></a><span id="l28.47" class="difflineminus">-src: url('chrome://testpilot/skin/fonts/DroidSans.ttf') format('truetype');</span>
<a href="#l28.48"></a><span id="l28.48" class="difflineminus">-}</span>
<a href="#l28.49"></a><span id="l28.49" class="difflineminus">-</span>
<a href="#l28.50"></a><span id="l28.50" class="difflineminus">-@font-face{</span>
<a href="#l28.51"></a><span id="l28.51" class="difflineminus">-font-family: 'DroidSans-Bold'; </span>
<a href="#l28.52"></a><span id="l28.52" class="difflineminus">-src: url('chrome://testpilot/skin/fonts/DroidSans-Bold.ttf') format('truetype');</span>
<a href="#l28.53"></a><span id="l28.53" class="difflineminus">-}</span>
<a href="#l28.54"></a><span id="l28.54" class="difflineminus">-</span>
<a href="#l28.55"></a><span id="l28.55" class="difflineminus">-#container {</span>
<a href="#l28.56"></a><span id="l28.56" class="difflineminus">-	margin: 0px auto;</span>
<a href="#l28.57"></a><span id="l28.57" class="difflineminus">-	width: 950px;</span>
<a href="#l28.58"></a><span id="l28.58" class="difflineminus">-</span>
<a href="#l28.59"></a><span id="l28.59" class="difflineminus">-}</span>
<a href="#l28.60"></a><span id="l28.60" class="difflineminus">-</span>
<a href="#l28.61"></a><span id="l28.61" class="difflineminus">-#logo {</span>
<a href="#l28.62"></a><span id="l28.62" class="difflineminus">-	margin-left: 20px;</span>
<a href="#l28.63"></a><span id="l28.63" class="difflineminus">-}</span>
<a href="#l28.64"></a><span id="l28.64" class="difflineminus">-</span>
<a href="#l28.65"></a><span id="l28.65" class="difflineminus">-#contentWelcome {</span>
<a href="#l28.66"></a><span id="l28.66" class="difflineminus">-	margin-top: 120px;</span>
<a href="#l28.67"></a><span id="l28.67" class="difflineminus">-	padding: 8px 24px 24px 24px;</span>
<a href="#l28.68"></a><span id="l28.68" class="difflineminus">-	font-family: 'DroidSans';</span>
<a href="#l28.69"></a><span id="l28.69" class="difflineminus">-	text-align: left;</span>
<a href="#l28.70"></a><span id="l28.70" class="difflineminus">-}</span>
<a href="#l28.71"></a><span id="l28.71" class="difflineminus">-</span>
<a href="#l28.72"></a><span id="l28.72" class="difflineminus">-#content {</span>
<a href="#l28.73"></a><span id="l28.73" class="difflineminus">-	margin-top: 60px;</span>
<a href="#l28.74"></a><span id="l28.74" class="difflineminus">-	padding: 8px 24px 24px 24px;</span>
<a href="#l28.75"></a><span id="l28.75" class="difflineminus">-	font-family: 'DroidSans';</span>
<a href="#l28.76"></a><span id="l28.76" class="difflineminus">-	text-align: left;</span>
<a href="#l28.77"></a><span id="l28.77" class="difflineminus">-}</span>
<a href="#l28.78"></a><span id="l28.78" class="difflineminus">-</span>
<a href="#l28.79"></a><span id="l28.79" class="difflineminus">-#download {</span>
<a href="#l28.80"></a><span id="l28.80" class="difflineminus">-	width: 300px;</span>
<a href="#l28.81"></a><span id="l28.81" class="difflineminus">-	margin-left: 410px;</span>
<a href="#l28.82"></a><span id="l28.82" class="difflineminus">-	margin-top: 240px;</span>
<a href="#l28.83"></a><span id="l28.83" class="difflineminus">-}</span>
<a href="#l28.84"></a><span id="l28.84" class="difflineminus">-</span>
<a href="#l28.85"></a><span id="l28.85" class="difflineminus">-.downloadButton {</span>
<a href="#l28.86"></a><span id="l28.86" class="difflineminus">-	margin-bottom: -10px;</span>
<a href="#l28.87"></a><span id="l28.87" class="difflineminus">-	margin-top: -2px;</span>
<a href="#l28.88"></a><span id="l28.88" class="difflineminus">-	margin-right: 12px;</span>
<a href="#l28.89"></a><span id="l28.89" class="difflineminus">-}</span>
<a href="#l28.90"></a><span id="l28.90" class="difflineminus">-</span>
<a href="#l28.91"></a><span id="l28.91" class="difflineminus">-.downloadH1 {font-family: 'DroidSans-bold'; color: #3a3a3a; font-size: 24px; font-weight: normal; letter-spacing: -1px; margin-right: 8px;}</span>
<a href="#l28.92"></a><span id="l28.92" class="difflineminus">-</span>
<a href="#l28.93"></a><span id="l28.93" class="difflineminus">-.downloadH2 {font-family: 'DroidSans'; color: #3a3a3a; font-size: 22px; font-weight: normal; letter-spacing: -1px; line-height: 28px; margin-left: 46px;}</span>
<a href="#l28.94"></a><span id="l28.94" class="difflineminus">-</span>
<a href="#l28.95"></a><span id="l28.95" class="difflineminus">-#intro {</span>
<a href="#l28.96"></a><span id="l28.96" class="difflineminus">-	float: left;</span>
<a href="#l28.97"></a><span id="l28.97" class="difflineminus">-	width: 500px;</span>
<a href="#l28.98"></a><span id="l28.98" class="difflineminus">-	margin-top: 30px;</span>
<a href="#l28.99"></a><span id="l28.99" class="difflineminus">-}</span>
<a href="#l28.100"></a><span id="l28.100" class="difflineminus">-</span>
<a href="#l28.101"></a><span id="l28.101" class="difflineminus">-#links {</span>
<a href="#l28.102"></a><span id="l28.102" class="difflineminus">-	float: right;</span>
<a href="#l28.103"></a><span id="l28.103" class="difflineminus">-	padding: 24px 0px;</span>
<a href="#l28.104"></a><span id="l28.104" class="difflineminus">-	margin-right: 0px;</span>
<a href="#l28.105"></a><span id="l28.105" class="difflineminus">-	margin-top: 30px;</span>
<a href="#l28.106"></a><span id="l28.106" class="difflineminus">-}</span>
<a href="#l28.107"></a><span id="l28.107" class="difflineminus">-</span>
<a href="#l28.108"></a><span id="l28.108" class="difflineminus">-.button {</span>
<a href="#l28.109"></a><span id="l28.109" class="difflineminus">-	font-family: 'DroidSans';</span>
<a href="#l28.110"></a><span id="l28.110" class="difflineminus">-	font-size: 16px;</span>
<a href="#l28.111"></a><span id="l28.111" class="difflineminus">-	padding: 8px 12px;</span>
<a href="#l28.112"></a><span id="l28.112" class="difflineminus">-	color: rgba(0, 0, 0, 0.8);</span>
<a href="#l28.113"></a><span id="l28.113" class="difflineminus">-	border-radius: 0.5em;</span>
<a href="#l28.114"></a><span id="l28.114" class="difflineminus">-	box-shadow: </span>
<a href="#l28.115"></a><span id="l28.115" class="difflineminus">-		inset rgba(0, 0, 0, 0.2) 0 1px 1px,</span>
<a href="#l28.116"></a><span id="l28.116" class="difflineminus">-		inset rgba(255, 255, 255, 1) 0 3px 1px,</span>
<a href="#l28.117"></a><span id="l28.117" class="difflineminus">-		inset rgba(255, 255, 255, 0.3) 0 16px 0px,</span>
<a href="#l28.118"></a><span id="l28.118" class="difflineminus">-		inset rgba(0, 0, 0, 0.2) 0 -1px 1px,</span>
<a href="#l28.119"></a><span id="l28.119" class="difflineminus">-		inset rgba(0, 0, 0, 0.1) 0 -2px 1px, </span>
<a href="#l28.120"></a><span id="l28.120" class="difflineminus">-		rgba(255, 255, 255, 1) 0 1px,</span>
<a href="#l28.121"></a><span id="l28.121" class="difflineminus">-		rgba(133, 153, 166, 0.3) 0px 1px 12px;</span>
<a href="#l28.122"></a><span id="l28.122" class="difflineminus">-	background-color: #e7eaec;</span>
<a href="#l28.123"></a><span id="l28.123" class="difflineminus">-	//display: inline;</span>
<a href="#l28.124"></a><span id="l28.124" class="difflineminus">-}</span>
<a href="#l28.125"></a><span id="l28.125" class="difflineminus">-</span>
<a href="#l28.126"></a><span id="l28.126" class="difflineminus">-.home_button {</span>
<a href="#l28.127"></a><span id="l28.127" class="difflineminus">-	font-family: 'DroidSans';</span>
<a href="#l28.128"></a><span id="l28.128" class="difflineminus">-	font-size: 16px;</span>
<a href="#l28.129"></a><span id="l28.129" class="difflineminus">-	padding: 8px 12px;</span>
<a href="#l28.130"></a><span id="l28.130" class="difflineminus">-	width: 240px;</span>
<a href="#l28.131"></a><span id="l28.131" class="difflineminus">-	color: rgba(0, 0, 0, 0.8);</span>
<a href="#l28.132"></a><span id="l28.132" class="difflineminus">-	border-radius: 0.5em;</span>
<a href="#l28.133"></a><span id="l28.133" class="difflineminus">-	box-shadow: </span>
<a href="#l28.134"></a><span id="l28.134" class="difflineminus">-		inset rgba(0, 0, 0, 0.2) 0 1px 1px,</span>
<a href="#l28.135"></a><span id="l28.135" class="difflineminus">-		inset rgba(255, 255, 255, 1) 0 3px 1px,</span>
<a href="#l28.136"></a><span id="l28.136" class="difflineminus">-		inset rgba(255, 255, 255, 0.3) 0 16px 0px,</span>
<a href="#l28.137"></a><span id="l28.137" class="difflineminus">-		inset rgba(0, 0, 0, 0.2) 0 -1px 1px,</span>
<a href="#l28.138"></a><span id="l28.138" class="difflineminus">-		inset rgba(0, 0, 0, 0.1) 0 -2px 1px, </span>
<a href="#l28.139"></a><span id="l28.139" class="difflineminus">-		rgba(255, 255, 255, 1) 0 1px,</span>
<a href="#l28.140"></a><span id="l28.140" class="difflineminus">-		rgba(133, 153, 166, 0.3) 0px 1px 12px;</span>
<a href="#l28.141"></a><span id="l28.141" class="difflineminus">-	background-color: #e7eaec;</span>
<a href="#l28.142"></a><span id="l28.142" class="difflineminus">-	//display: inline;</span>
<a href="#l28.143"></a><span id="l28.143" class="difflineminus">-}</span>
<a href="#l28.144"></a><span id="l28.144" class="difflineminus">-</span>
<a href="#l28.145"></a><span id="l28.145" class="difflineminus">-</span>
<a href="#l28.146"></a><span id="l28.146" class="difflineminus">-.callout {</span>
<a href="#l28.147"></a><span id="l28.147" class="difflineminus">-	font-family: 'DroidSans';</span>
<a href="#l28.148"></a><span id="l28.148" class="difflineminus">-	font-size: 16px;</span>
<a href="#l28.149"></a><span id="l28.149" class="difflineminus">-	padding: 8px 24px;</span>
<a href="#l28.150"></a><span id="l28.150" class="difflineminus">-	margin: 24px auto;</span>
<a href="#l28.151"></a><span id="l28.151" class="difflineminus">-	color: rgba(0, 0, 0, 0.8);</span>
<a href="#l28.152"></a><span id="l28.152" class="difflineminus">-	border-radius: 0.5em;</span>
<a href="#l28.153"></a><span id="l28.153" class="difflineminus">-	background: rgba(220, 240, 247, 0.8) url('chrome://testpilot/skin/callout.png') no-repeat top center;</span>
<a href="#l28.154"></a><span id="l28.154" class="difflineminus">-	box-shadow: </span>
<a href="#l28.155"></a><span id="l28.155" class="difflineminus">-		inset rgba(185, 221, 234, 0.2) 0 -10px 12px,</span>
<a href="#l28.156"></a><span id="l28.156" class="difflineminus">-		inset rgba(185, 221, 234, 1) 0 0px 1px,</span>
<a href="#l28.157"></a><span id="l28.157" class="difflineminus">-		inset rgba(255, 255, 255, 0.2) 0 10px 12px;</span>
<a href="#l28.158"></a><span id="l28.158" class="difflineminus">-	//display: inline;</span>
<a href="#l28.159"></a><span id="l28.159" class="difflineminus">-}</span>
<a href="#l28.160"></a><span id="l28.160" class="difflineminus">-</span>
<a href="#l28.161"></a><span id="l28.161" class="difflineminus">-.home_callout {</span>
<a href="#l28.162"></a><span id="l28.162" class="difflineminus">-	font-family: 'DroidSans';</span>
<a href="#l28.163"></a><span id="l28.163" class="difflineminus">-	font-size: 16px;</span>
<a href="#l28.164"></a><span id="l28.164" class="difflineminus">-	vertical-align: middle;</span>
<a href="#l28.165"></a><span id="l28.165" class="difflineminus">-	width: 240px;</span>
<a href="#l28.166"></a><span id="l28.166" class="difflineminus">-	padding: 8px 24px;</span>
<a href="#l28.167"></a><span id="l28.167" class="difflineminus">-	margin: 8px auto;</span>
<a href="#l28.168"></a><span id="l28.168" class="difflineminus">-	color: rgba(0, 0, 0, 0.8);</span>
<a href="#l28.169"></a><span id="l28.169" class="difflineminus">-	border-radius: 0.5em;</span>
<a href="#l28.170"></a><span id="l28.170" class="difflineminus">-	background: rgba(220, 240, 247, 0.8) url('chrome://testpilot/skin/callout.png') no-repeat top center;</span>
<a href="#l28.171"></a><span id="l28.171" class="difflineminus">-	box-shadow: </span>
<a href="#l28.172"></a><span id="l28.172" class="difflineminus">-		inset rgba(185, 221, 234, 0.2) 0 -10px 12px,</span>
<a href="#l28.173"></a><span id="l28.173" class="difflineminus">-		inset rgba(185, 221, 234, 1) 0 0px 1px,</span>
<a href="#l28.174"></a><span id="l28.174" class="difflineminus">-		inset rgba(255, 255, 255, 0.2) 0 10px 12px;</span>
<a href="#l28.175"></a><span id="l28.175" class="difflineminus">-	//display: inline;</span>
<a href="#l28.176"></a><span id="l28.176" class="difflineminus">-}</span>
<a href="#l28.177"></a><span id="l28.177" class="difflineminus">-</span>
<a href="#l28.178"></a><span id="l28.178" class="difflineminus">-.homeIcon {</span>
<a href="#l28.179"></a><span id="l28.179" class="difflineminus">-	margin-top: -32px;</span>
<a href="#l28.180"></a><span id="l28.180" class="difflineminus">-	margin-bottom: -32px;</span>
<a href="#l28.181"></a><span id="l28.181" class="difflineminus">-	margin-right: 12px;</span>
<a href="#l28.182"></a><span id="l28.182" class="difflineminus">-}</span>
<a href="#l28.183"></a><span id="l28.183" class="difflineminus">-</span>
<a href="#l28.184"></a><span id="l28.184" class="difflineminus">-#footer {</span>
<a href="#l28.185"></a><span id="l28.185" class="difflineminus">-	clear: both;</span>
<a href="#l28.186"></a><span id="l28.186" class="difflineminus">-	padding: 24px;</span>
<a href="#l28.187"></a><span id="l28.187" class="difflineminus">-	font-size: 9px;</span>
<a href="#l28.188"></a><span id="l28.188" class="difflineminus">-</span>
<a href="#l28.189"></a><span id="l28.189" class="difflineminus">-}</span>
<a href="#l28.190"></a><span id="l28.190" class="difflineminus">-</span>
<a href="#l28.191"></a><span id="l28.191" class="difflineminus">-.mozLogo {</span>
<a href="#l28.192"></a><span id="l28.192" class="difflineminus">-	margin-bottom: -10px;</span>
<a href="#l28.193"></a><span id="l28.193" class="difflineminus">-	margin-right: 6px;</span>
<a href="#l28.194"></a><span id="l28.194" class="difflineminus">-}</span>
<a href="#l28.195"></a><span id="l28.195" class="difflineminus">-</span>
<a href="#l28.196"></a><span id="l28.196" class="difflineminus">-/* ------- MENU ------- </span>
<a href="#l28.197"></a><span id="l28.197" class="difflineminus">-</span>
<a href="#l28.198"></a><span id="l28.198" class="difflineminus">-#menu {</span>
<a href="#l28.199"></a><span id="l28.199" class="difflineminus">-	margin: 20px auto;</span>
<a href="#l28.200"></a><span id="l28.200" class="difflineminus">-	max-width: 800px;</span>
<a href="#l28.201"></a><span id="l28.201" class="difflineminus">-	padding: 4px 40px;</span>
<a href="#l28.202"></a><span id="l28.202" class="difflineminus">-	width: 800px;</span>
<a href="#l28.203"></a><span id="l28.203" class="difflineminus">-	text-align: left;</span>
<a href="#l28.204"></a><span id="l28.204" class="difflineminus">-	border-radius: 0.25em;</span>
<a href="#l28.205"></a><span id="l28.205" class="difflineminus">-	border-top: 1px solid #adb6ba;</span>
<a href="#l28.206"></a><span id="l28.206" class="difflineminus">-	border-left: 1px solid #adb6ba;</span>
<a href="#l28.207"></a><span id="l28.207" class="difflineminus">-	border-right: 1px solid #adb6ba;</span>
<a href="#l28.208"></a><span id="l28.208" class="difflineminus">-	border-bottom: 3px solid #adb6ba;</span>
<a href="#l28.209"></a><span id="l28.209" class="difflineminus">-	-moz-border-bottom-colors:#adb6ba #e7eaec #e7eaec;</span>
<a href="#l28.210"></a><span id="l28.210" class="difflineminus">-	background-color: #fff;</span>
<a href="#l28.211"></a><span id="l28.211" class="difflineminus">-} </span>
<a href="#l28.212"></a><span id="l28.212" class="difflineminus">-</span>
<a href="#l28.213"></a><span id="l28.213" class="difflineminus">-*/</span>
<a href="#l28.214"></a><span id="l28.214" class="difflineminus">-</span>
<a href="#l28.215"></a><span id="l28.215" class="difflineminus">-.menuItem {</span>
<a href="#l28.216"></a><span id="l28.216" class="difflineminus">-	margin-right: 30px;</span>
<a href="#l28.217"></a><span id="l28.217" class="difflineminus">-	margin-bottom: 40px;</span>
<a href="#l28.218"></a><span id="l28.218" class="difflineminus">-	font-size: 14px;</span>
<a href="#l28.219"></a><span id="l28.219" class="difflineminus">-	text-shadow: 1px 1px 1px rgba(173, 182, 186, 0.6);</span>
<a href="#l28.220"></a><span id="l28.220" class="difflineminus">-	padding: 9px 8px 8px 8px;</span>
<a href="#l28.221"></a><span id="l28.221" class="difflineminus">-}</span>
<a href="#l28.222"></a><span id="l28.222" class="difflineminus">-</span>
<a href="#l28.223"></a><span id="l28.223" class="difflineminus">-.menuOn {</span>
<a href="#l28.224"></a><span id="l28.224" class="difflineminus">-	margin-right: 30px;</span>
<a href="#l28.225"></a><span id="l28.225" class="difflineminus">-	margin-bottom: 40px;</span>
<a href="#l28.226"></a><span id="l28.226" class="difflineminus">-	font-size: 14px;</span>
<a href="#l28.227"></a><span id="l28.227" class="difflineminus">-	text-shadow: 1px 1px 1px rgba(173, 182, 186, 1);</span>
<a href="#l28.228"></a><span id="l28.228" class="difflineminus">-	background-color: rgba(173, 182, 186, 0.3);</span>
<a href="#l28.229"></a><span id="l28.229" class="difflineminus">-	box-shadow: </span>
<a href="#l28.230"></a><span id="l28.230" class="difflineminus">-		inset rgba(0, 0, 0, 0.2) 0 -10px 12px;</span>
<a href="#l28.231"></a><span id="l28.231" class="difflineminus">-	padding: 9px 8px 8px 8px;</span>
<a href="#l28.232"></a><span id="l28.232" class="difflineminus">-}</span>
<a href="#l28.233"></a><span id="l28.233" class="difflineminus">-</span>
<a href="#l28.234"></a><span id="l28.234" class="difflineminus">-.menuItem a {color: #9f423b; text-decoration: none;}</span>
<a href="#l28.235"></a><span id="l28.235" class="difflineminus">-.menuItem a:hover {color: #9f423b; text-decoration: none; border-bottom: 1px dotted #9f423b;}</span>
<a href="#l28.236"></a><span id="l28.236" class="difflineminus">-</span>
<a href="#l28.237"></a><span id="l28.237" class="difflineminus">-</span>
<a href="#l28.238"></a><span id="l28.238" class="difflineminus">-.menuOn a {color: #666666; text-decoration: none;}</span>
<a href="#l28.239"></a><span id="l28.239" class="difflineminus">-.menuOn a:hover {color: #666666; text-decoration: none;}</span>
<a href="#l28.240"></a><span id="l28.240" class="difflineminus">-</span>
<a href="#l28.241"></a><span id="l28.241" class="difflineminus">-#get-started {</span>
<a href="#l28.242"></a><span id="l28.242" class="difflineminus">-    float: left;</span>
<a href="#l28.243"></a><span id="l28.243" class="difflineminus">-    width: 45%;</span>
<a href="#l28.244"></a><span id="l28.244" class="difflineminus">-    margin: 20px 0px;</span>
<a href="#l28.245"></a><span id="l28.245" class="difflineminus">-}</span>
<a href="#l28.246"></a><span id="l28.246" class="difflineminus">-</span>
<a href="#l28.247"></a><span id="l28.247" class="difflineminus">-#icon-explanation {</span>
<a href="#l28.248"></a><span id="l28.248" class="difflineminus">-    float: right;</span>
<a href="#l28.249"></a><span id="l28.249" class="difflineminus">-    width: 45%;</span>
<a href="#l28.250"></a><span id="l28.250" class="difflineminus">-    margin: 20px 0px;</span>
<a href="#l28.251"></a><span id="l28.251" class="difflineminus">-}</span>
<a href="#l28.252"></a><span id="l28.252" class="difflineminus">-</span>
<a href="#l28.253"></a><span id="l28.253" class="difflineminus">-.function-link {</span>
<a href="#l28.254"></a><span id="l28.254" class="difflineminus">-    cursor: pointer;</span>
<a href="#l28.255"></a><span id="l28.255" class="difflineminus">-    color: #9f423b;</span>
<a href="#l28.256"></a><span id="l28.256" class="difflineminus">-    text-decoration: underline;</span>
<a href="#l28.257"></a><span id="l28.257" class="difflineminus">-}</span>
<a href="#l28.258"></a><span id="l28.258" class="difflineminus">-</span>
<a href="#l28.259"></a><span id="l28.259" class="difflineminus">-p.embiggened {</span>
<a href="#l28.260"></a><span id="l28.260" class="difflineminus">-    font-size: 14px;</span>
<a href="#l28.261"></a><span id="l28.261" class="difflineminus">-}</span>
<a href="#l28.262"></a><span id="l28.262">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1">deleted file mode 100644</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/status-quit.html</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineplus">+++ /dev/null</span>
<a href="#l29.4"></a><span id="l29.4" class="difflineat">@@ -1,61 +0,0 @@</span>
<a href="#l29.5"></a><span id="l29.5" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l29.6"></a><span id="l29.6" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l29.7"></a><span id="l29.7" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l29.8"></a><span id="l29.8" class="difflineminus">-</span>
<a href="#l29.9"></a><span id="l29.9" class="difflineminus">-&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;</span>
<a href="#l29.10"></a><span id="l29.10" class="difflineminus">-  &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;</span>
<a href="#l29.11"></a><span id="l29.11" class="difflineminus">-</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;en&quot; lang=&quot;en&quot;&gt;</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineminus">-&lt;head&gt;</span>
<a href="#l29.14"></a><span id="l29.14" class="difflineminus">-  &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span>
<a href="#l29.15"></a><span id="l29.15" class="difflineminus">-  &lt;title id=&quot;page-title&quot;&gt;&lt;/title&gt;</span>
<a href="#l29.16"></a><span id="l29.16" class="difflineminus">-  &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; media=&quot;all&quot;</span>
<a href="#l29.17"></a><span id="l29.17" class="difflineminus">-    href=&quot;chrome://testpilot/skin/css/screen-standalone.css&quot; /&gt;</span>
<a href="#l29.18"></a><span id="l29.18" class="difflineminus">-  &lt;script src=&quot;experiment-page.js&quot; type=&quot;application/javascript;version=1.8&quot;&gt;</span>
<a href="#l29.19"></a><span id="l29.19" class="difflineminus">-  &lt;/script&gt;</span>
<a href="#l29.20"></a><span id="l29.20" class="difflineminus">-&lt;/head&gt;</span>
<a href="#l29.21"></a><span id="l29.21" class="difflineminus">-&lt;body onload=&quot;onQuitPageLoad();&quot;&gt;</span>
<a href="#l29.22"></a><span id="l29.22" class="difflineminus">-  &lt;div id=&quot;container&quot;&gt;</span>
<a href="#l29.23"></a><span id="l29.23" class="difflineminus">-    &lt;div id=&quot;content-standalone&quot;&gt;</span>
<a href="#l29.24"></a><span id="l29.24" class="difflineminus">-      &lt;div id=&quot;intro&quot;&gt;</span>
<a href="#l29.25"></a><span id="l29.25" class="difflineminus">-	&lt;h2 id=&quot;about-quit-title&quot;&gt;&lt;/h2&gt;</span>
<a href="#l29.26"></a><span id="l29.26" class="difflineminus">-	&lt;p id=&quot;optional-message&quot;&gt;&lt;/p&gt;</span>
<a href="#l29.27"></a><span id="l29.27" class="difflineminus">-	&lt;p&gt;&lt;span id=&quot;reason-text&quot;&gt;&lt;/span&gt;</span>
<a href="#l29.28"></a><span id="l29.28" class="difflineminus">-	  &lt;textarea rows=&quot;6&quot; cols=&quot;64&quot; id=&quot;reason-for-quit&quot;&gt;&lt;/textarea&gt;&lt;/p&gt;</span>
<a href="#l29.29"></a><span id="l29.29" class="difflineminus">-        &lt;p id=&quot;recur-options&quot; style=&quot;display:none&quot;&gt;&lt;/p&gt;&lt;br/&gt;</span>
<a href="#l29.30"></a><span id="l29.30" class="difflineminus">-	&lt;div id=&quot;recur-checkbox-container&quot; style=&quot;display:none&quot;&gt;</span>
<a href="#l29.31"></a><span id="l29.31" class="difflineminus">-        &lt;input type=&quot;checkbox&quot; id=&quot;opt-out-forever&quot;&gt;</span>
<a href="#l29.32"></a><span id="l29.32" class="difflineminus">-	&lt;span id=&quot;quit-forever-text&quot;&gt;&lt;/span&gt;</span>
<a href="#l29.33"></a><span id="l29.33" class="difflineminus">-        &lt;/div&gt;</span>
<a href="#l29.34"></a><span id="l29.34" class="difflineminus">-	&lt;div class=&quot;home_callout_continue&quot; style=&quot;text-align:center&quot;&gt;</span>
<a href="#l29.35"></a><span id="l29.35" class="difflineminus">-	  &lt;a id=&quot;quit-study-link&quot; onclick=&quot;quitExperiment();&quot;&gt;&lt;/a&gt;&lt;/div&gt;</span>
<a href="#l29.36"></a><span id="l29.36" class="difflineminus">-        &lt;/div&gt;</span>
<a href="#l29.37"></a><span id="l29.37" class="difflineminus">-        &lt;div id=&quot;links&quot;&gt;</span>
<a href="#l29.38"></a><span id="l29.38" class="difflineminus">-	&lt;p class=&quot;spacer&quot;&gt;&lt;/p&gt;</span>
<a href="#l29.39"></a><span id="l29.39" class="difflineminus">-        &lt;div class=&quot;home_callout&quot;&gt;</span>
<a href="#l29.40"></a><span id="l29.40" class="difflineminus">-	  &lt;img class=&quot;homeIcon&quot;</span>
<a href="#l29.41"></a><span id="l29.41" class="difflineminus">-	    src=&quot;chrome://testpilot/skin/images/home_comments.png&quot;&gt;</span>
<a href="#l29.42"></a><span id="l29.42" class="difflineminus">-	  &lt;a id=&quot;comments-and-discussions-link&quot;</span>
<a href="#l29.43"></a><span id="l29.43" class="difflineminus">-	    onclick=&quot;</span>
<a href="#l29.44"></a><span id="l29.44" class="difflineminus">-	      openLink('http://groups.google.com/group/mozilla-labs-testpilot');&quot;&gt;</span>
<a href="#l29.45"></a><span id="l29.45" class="difflineminus">-	  &lt;/a&gt;</span>
<a href="#l29.46"></a><span id="l29.46" class="difflineminus">-	&lt;/div&gt;</span>
<a href="#l29.47"></a><span id="l29.47" class="difflineminus">-	&lt;br&gt;</span>
<a href="#l29.48"></a><span id="l29.48" class="difflineminus">-        &lt;div class=&quot;home_callout&quot;&gt;</span>
<a href="#l29.49"></a><span id="l29.49" class="difflineminus">-	  &lt;img class=&quot;homeIcon&quot;</span>
<a href="#l29.50"></a><span id="l29.50" class="difflineminus">-	    src=&quot;chrome://testpilot/skin/images/home_results.png&quot;&gt;</span>
<a href="#l29.51"></a><span id="l29.51" class="difflineminus">-	  &lt;a id=&quot;propose-test-link&quot;</span>
<a href="#l29.52"></a><span id="l29.52" class="difflineminus">-	    onclick=&quot;openLink('https://wiki.mozilla.org/Labs/Test_Pilot');&quot;&gt;&lt;/a&gt;</span>
<a href="#l29.53"></a><span id="l29.53" class="difflineminus">-	&lt;/div&gt;</span>
<a href="#l29.54"></a><span id="l29.54" class="difflineminus">-	&lt;br&gt;</span>
<a href="#l29.55"></a><span id="l29.55" class="difflineminus">-        &lt;div class=&quot;home_callout&quot;&gt;</span>
<a href="#l29.56"></a><span id="l29.56" class="difflineminus">-	  &lt;img class=&quot;homeIcon&quot;</span>
<a href="#l29.57"></a><span id="l29.57" class="difflineminus">-	    src=&quot;chrome://testpilot/skin/images/home_twitter.png&quot;&gt;</span>
<a href="#l29.58"></a><span id="l29.58" class="difflineminus">-	  &lt;a id=&quot;testpilot-twitter-link&quot;</span>
<a href="#l29.59"></a><span id="l29.59" class="difflineminus">-	    onclick=&quot;openLink('http://www.twitter.com/MozTestPilot');&quot;&gt;&lt;/a&gt;</span>
<a href="#l29.60"></a><span id="l29.60" class="difflineminus">-	&lt;/div&gt;</span>
<a href="#l29.61"></a><span id="l29.61" class="difflineminus">-      &lt;/div&gt;</span>
<a href="#l29.62"></a><span id="l29.62" class="difflineminus">-    &lt;/div&gt;</span>
<a href="#l29.63"></a><span id="l29.63" class="difflineminus">-  &lt;/div&gt;</span>
<a href="#l29.64"></a><span id="l29.64" class="difflineminus">-&lt;/body&gt;</span>
<a href="#l29.65"></a><span id="l29.65" class="difflineminus">-&lt;/html&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1">deleted file mode 100644</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/status.html</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineplus">+++ /dev/null</span>
<a href="#l30.4"></a><span id="l30.4" class="difflineat">@@ -1,56 +0,0 @@</span>
<a href="#l30.5"></a><span id="l30.5" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l30.6"></a><span id="l30.6" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l30.7"></a><span id="l30.7" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l30.8"></a><span id="l30.8" class="difflineminus">-</span>
<a href="#l30.9"></a><span id="l30.9" class="difflineminus">-&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;</span>
<a href="#l30.10"></a><span id="l30.10" class="difflineminus">-	&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;</span>
<a href="#l30.11"></a><span id="l30.11" class="difflineminus">-</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;en&quot; lang=&quot;en&quot;&gt;</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineminus">-&lt;head&gt;</span>
<a href="#l30.14"></a><span id="l30.14" class="difflineminus">-  &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span>
<a href="#l30.15"></a><span id="l30.15" class="difflineminus">-  &lt;title id=&quot;page-title&quot;&gt;&lt;/title&gt;</span>
<a href="#l30.16"></a><span id="l30.16" class="difflineminus">-  &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; media=&quot;all&quot;</span>
<a href="#l30.17"></a><span id="l30.17" class="difflineminus">-    href=&quot;chrome://testpilot/skin/css/screen-standalone.css&quot;&gt;</span>
<a href="#l30.18"></a><span id="l30.18" class="difflineminus">-  &lt;script src=&quot;experiment-page.js&quot;</span>
<a href="#l30.19"></a><span id="l30.19" class="difflineminus">-    type=&quot;application/javascript;version=1.8&quot;&gt;&lt;/script&gt;</span>
<a href="#l30.20"></a><span id="l30.20" class="difflineminus">-  &lt;script src=&quot;flot/jquery.js&quot; language=&quot;javascript&quot;</span>
<a href="#l30.21"></a><span id="l30.21" class="difflineminus">-    type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</span>
<a href="#l30.22"></a><span id="l30.22" class="difflineminus">-  &lt;script src=&quot;flot/jquery.flot.js&quot; language=&quot;javascript&quot;</span>
<a href="#l30.23"></a><span id="l30.23" class="difflineminus">-    type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</span>
<a href="#l30.24"></a><span id="l30.24" class="difflineminus">-&lt;/head&gt;</span>
<a href="#l30.25"></a><span id="l30.25" class="difflineminus">-&lt;body onload=&quot;onStatusPageLoad();&quot;&gt;</span>
<a href="#l30.26"></a><span id="l30.26" class="difflineminus">-  &lt;div id=&quot;container&quot;&gt;</span>
<a href="#l30.27"></a><span id="l30.27" class="difflineminus">-    &lt;div id=&quot;content-standalone&quot;&gt;</span>
<a href="#l30.28"></a><span id="l30.28" class="difflineminus">-      &lt;div id=&quot;intro&quot;&gt;</span>
<a href="#l30.29"></a><span id="l30.29" class="difflineminus">-        &lt;span id=&quot;recur-pref&quot;&gt;&lt;/span&gt;</span>
<a href="#l30.30"></a><span id="l30.30" class="difflineminus">-        &lt;span id=&quot;recur-controls&quot;&gt;&lt;/span&gt;</span>
<a href="#l30.31"></a><span id="l30.31" class="difflineminus">-        &lt;div id=&quot;experiment-specific-text&quot;&gt;&lt;/div&gt;</span>
<a href="#l30.32"></a><span id="l30.32" class="difflineminus">-      &lt;/div&gt;</span>
<a href="#l30.33"></a><span id="l30.33" class="difflineminus">-     &lt;div id=&quot;links&quot;&gt;</span>
<a href="#l30.34"></a><span id="l30.34" class="difflineminus">-        &lt;p class=&quot;spacer&quot;&gt;</span>
<a href="#l30.35"></a><span id="l30.35" class="difflineminus">-	  &lt;div id=&quot;data-privacy-text&quot; hidden=&quot;true&quot;&gt;&lt;/div&gt;</span>
<a href="#l30.36"></a><span id="l30.36" class="difflineminus">-          &lt;div class=&quot;home_callout&quot;&gt;</span>
<a href="#l30.37"></a><span id="l30.37" class="difflineminus">-	    &lt;img class=&quot;homeIcon&quot;</span>
<a href="#l30.38"></a><span id="l30.38" class="difflineminus">-	      src=&quot;chrome://testpilot/skin/images/home_comments.png&quot;&gt;</span>
<a href="#l30.39"></a><span id="l30.39" class="difflineminus">-	    &lt;a id=&quot;comments-and-discussions-link&quot; onclick=&quot;openLink('http://groups.google.com/group/mozilla-labs-testpilot');&quot;&gt;</span>
<a href="#l30.40"></a><span id="l30.40" class="difflineminus">-	    &lt;/a&gt;</span>
<a href="#l30.41"></a><span id="l30.41" class="difflineminus">-	  &lt;/div&gt;&lt;br&gt;</span>
<a href="#l30.42"></a><span id="l30.42" class="difflineminus">-          &lt;div class=&quot;home_callout&quot;&gt;</span>
<a href="#l30.43"></a><span id="l30.43" class="difflineminus">-	    &lt;img class=&quot;homeIcon&quot;</span>
<a href="#l30.44"></a><span id="l30.44" class="difflineminus">-	      src=&quot;chrome://testpilot/skin/images/home_results.png&quot;&gt;</span>
<a href="#l30.45"></a><span id="l30.45" class="difflineminus">-	    &lt;a id=&quot;propose-test-link&quot;</span>
<a href="#l30.46"></a><span id="l30.46" class="difflineminus">-	      onclick=&quot;openLink('https://wiki.mozilla.org/Labs/Test_Pilot');&quot;&gt;</span>
<a href="#l30.47"></a><span id="l30.47" class="difflineminus">-	    &lt;/a&gt;</span>
<a href="#l30.48"></a><span id="l30.48" class="difflineminus">-	  &lt;/div&gt;&lt;br&gt;</span>
<a href="#l30.49"></a><span id="l30.49" class="difflineminus">-          &lt;div class=&quot;home_callout&quot;&gt;</span>
<a href="#l30.50"></a><span id="l30.50" class="difflineminus">-	    &lt;img class=&quot;homeIcon&quot;</span>
<a href="#l30.51"></a><span id="l30.51" class="difflineminus">-	      src=&quot;chrome://testpilot/skin/images/home_twitter.png&quot;&gt;</span>
<a href="#l30.52"></a><span id="l30.52" class="difflineminus">-	    &lt;a id=&quot;testpilot-twitter-link&quot;</span>
<a href="#l30.53"></a><span id="l30.53" class="difflineminus">-	      onclick=&quot;openLink('http://www.twitter.com/MozTestPilot');&quot;&gt;</span>
<a href="#l30.54"></a><span id="l30.54" class="difflineminus">-	    &lt;/a&gt;</span>
<a href="#l30.55"></a><span id="l30.55" class="difflineminus">-	  &lt;/div&gt;</span>
<a href="#l30.56"></a><span id="l30.56" class="difflineminus">-      &lt;/div&gt;</span>
<a href="#l30.57"></a><span id="l30.57" class="difflineminus">-     &lt;/div&gt;</span>
<a href="#l30.58"></a><span id="l30.58" class="difflineminus">-    &lt;/div&gt;</span>
<a href="#l30.59"></a><span id="l30.59" class="difflineminus">-&lt;/body&gt;</span>
<a href="#l30.60"></a><span id="l30.60" class="difflineminus">-&lt;/html&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1">deleted file mode 100644</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/survey-generator.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineplus">+++ /dev/null</span>
<a href="#l31.4"></a><span id="l31.4" class="difflineat">@@ -1,346 +0,0 @@</span>
<a href="#l31.5"></a><span id="l31.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l31.6"></a><span id="l31.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l31.7"></a><span id="l31.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l31.8"></a><span id="l31.8" class="difflineminus">-</span>
<a href="#l31.9"></a><span id="l31.9" class="difflineminus">-const MULTIPLE_CHOICE = 0;</span>
<a href="#l31.10"></a><span id="l31.10" class="difflineminus">-const CHECK_BOXES_WITH_FREE_ENTRY = 1;</span>
<a href="#l31.11"></a><span id="l31.11" class="difflineminus">-const SCALE = 2;</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-const FREE_ENTRY = 3;</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineminus">-const CHECK_BOXES = 4;</span>
<a href="#l31.14"></a><span id="l31.14" class="difflineminus">-const MULTIPLE_CHOICE_WITH_FREE_ENTRY = 5;</span>
<a href="#l31.15"></a><span id="l31.15" class="difflineminus">-</span>
<a href="#l31.16"></a><span id="l31.16" class="difflineminus">-var stringBundle;</span>
<a href="#l31.17"></a><span id="l31.17" class="difflineminus">-</span>
<a href="#l31.18"></a><span id="l31.18" class="difflineminus">-function onBuiltinSurveyLoad() {</span>
<a href="#l31.19"></a><span id="l31.19" class="difflineminus">-  Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l31.20"></a><span id="l31.20" class="difflineminus">-  Components.utils.import(&quot;resource://testpilot/modules/tasks.js&quot;);</span>
<a href="#l31.21"></a><span id="l31.21" class="difflineminus">-  setStrings();</span>
<a href="#l31.22"></a><span id="l31.22" class="difflineminus">-  let eid = getUrlParam(&quot;eid&quot;);</span>
<a href="#l31.23"></a><span id="l31.23" class="difflineminus">-  let task = TestPilotSetup.getTaskById(eid);</span>
<a href="#l31.24"></a><span id="l31.24" class="difflineminus">-  let contentDiv = document.getElementById(&quot;survey-contents&quot;);</span>
<a href="#l31.25"></a><span id="l31.25" class="difflineminus">-  let explanation = document.getElementById(&quot;survey-explanation&quot;);</span>
<a href="#l31.26"></a><span id="l31.26" class="difflineminus">-  if (!task) {</span>
<a href="#l31.27"></a><span id="l31.27" class="difflineminus">-    // Tasks haven't all loaded yet.  Try again in a few seconds.</span>
<a href="#l31.28"></a><span id="l31.28" class="difflineminus">-    contentDiv.textContent =</span>
<a href="#l31.29"></a><span id="l31.29" class="difflineminus">-      stringBundle.GetStringFromName(&quot;testpilot.surveyPage.loading&quot;);</span>
<a href="#l31.30"></a><span id="l31.30" class="difflineminus">-    window.setTimeout(function() { onBuiltinSurveyLoad(); }, 2000);</span>
<a href="#l31.31"></a><span id="l31.31" class="difflineminus">-    return;</span>
<a href="#l31.32"></a><span id="l31.32" class="difflineminus">-  }</span>
<a href="#l31.33"></a><span id="l31.33" class="difflineminus">-</span>
<a href="#l31.34"></a><span id="l31.34" class="difflineminus">-  let title = document.getElementById(&quot;survey-title&quot;);</span>
<a href="#l31.35"></a><span id="l31.35" class="difflineminus">-  title.textContent = task.title;</span>
<a href="#l31.36"></a><span id="l31.36" class="difflineminus">-</span>
<a href="#l31.37"></a><span id="l31.37" class="difflineminus">-  let submitButton = document.getElementById(&quot;survey-submit&quot;);</span>
<a href="#l31.38"></a><span id="l31.38" class="difflineminus">-  if (task.relatedStudyId) {</span>
<a href="#l31.39"></a><span id="l31.39" class="difflineminus">-     submitButton.textContent =</span>
<a href="#l31.40"></a><span id="l31.40" class="difflineminus">-      stringBundle.GetStringFromName(&quot;testpilot.surveyPage.submitAnswers&quot;);</span>
<a href="#l31.41"></a><span id="l31.41" class="difflineminus">-  } else {</span>
<a href="#l31.42"></a><span id="l31.42" class="difflineminus">-    submitButton.textContent =</span>
<a href="#l31.43"></a><span id="l31.43" class="difflineminus">-      stringBundle.GetStringFromName(&quot;testpilot.surveyPage.saveAnswers&quot;);</span>
<a href="#l31.44"></a><span id="l31.44" class="difflineminus">-  }</span>
<a href="#l31.45"></a><span id="l31.45" class="difflineminus">-</span>
<a href="#l31.46"></a><span id="l31.46" class="difflineminus">-  explanation.innerHTML = &quot;&quot;;</span>
<a href="#l31.47"></a><span id="l31.47" class="difflineminus">-  contentDiv.innerHTML = &quot;&quot;;</span>
<a href="#l31.48"></a><span id="l31.48" class="difflineminus">-  if (task.status == TaskConstants.STATUS_SUBMITTED) {</span>
<a href="#l31.49"></a><span id="l31.49" class="difflineminus">-    let thanks = document.createElement(&quot;p&quot;);</span>
<a href="#l31.50"></a><span id="l31.50" class="difflineminus">-    thanks.textContent =</span>
<a href="#l31.51"></a><span id="l31.51" class="difflineminus">-      stringBundle.GetStringFromName(&quot;testpilot.surveyPage.thankYouForFinishingSurvey&quot;);</span>
<a href="#l31.52"></a><span id="l31.52" class="difflineminus">-    contentDiv.appendChild(thanks);</span>
<a href="#l31.53"></a><span id="l31.53" class="difflineminus">-    let review = document.createElement(&quot;p&quot;);</span>
<a href="#l31.54"></a><span id="l31.54" class="difflineminus">-    review.textContent = </span>
<a href="#l31.55"></a><span id="l31.55" class="difflineminus">-      stringBundle.GetStringFromName(&quot;testpilot.surveyPage.reviewOrChangeYourAnswers&quot;);</span>
<a href="#l31.56"></a><span id="l31.56" class="difflineminus">-    contentDiv.appendChild(review);</span>
<a href="#l31.57"></a><span id="l31.57" class="difflineminus">-    submitButton.setAttribute(&quot;style&quot;, &quot;display:none&quot;);</span>
<a href="#l31.58"></a><span id="l31.58" class="difflineminus">-    let changeButton = document.getElementById(&quot;change-answers&quot;);</span>
<a href="#l31.59"></a><span id="l31.59" class="difflineminus">-    changeButton.setAttribute(&quot;style&quot;, &quot;&quot;);</span>
<a href="#l31.60"></a><span id="l31.60" class="difflineminus">-  } else {</span>
<a href="#l31.61"></a><span id="l31.61" class="difflineminus">-    if (task.surveyExplanation) {</span>
<a href="#l31.62"></a><span id="l31.62" class="difflineminus">-      // parse and sanitize HTML for surveyExplanation</span>
<a href="#l31.63"></a><span id="l31.63" class="difflineminus">-      // https://developer.mozilla.org/en/XUL_School/DOM_Building_and_HTML_Insertion#Safely_Using_Remote_HTML</span>
<a href="#l31.64"></a><span id="l31.64" class="difflineminus">-      let expl = Components.classes[&quot;@mozilla.org/feed-unescapehtml;1&quot;]  </span>
<a href="#l31.65"></a><span id="l31.65" class="difflineminus">-                   .getService(Components.interfaces.nsIScriptableUnescapeHTML)  </span>
<a href="#l31.66"></a><span id="l31.66" class="difflineminus">-                   .parseFragment(task.surveyExplanation, false, null, document);  </span>
<a href="#l31.67"></a><span id="l31.67" class="difflineminus">-      explanation.appendChild(expl);</span>
<a href="#l31.68"></a><span id="l31.68" class="difflineminus">-    }</span>
<a href="#l31.69"></a><span id="l31.69" class="difflineminus">-    drawSurveyForm(task, contentDiv);</span>
<a href="#l31.70"></a><span id="l31.70" class="difflineminus">-    // Allow surveys to define arbitrary page load handlers - call them</span>
<a href="#l31.71"></a><span id="l31.71" class="difflineminus">-    // after creating the rest of the page:</span>
<a href="#l31.72"></a><span id="l31.72" class="difflineminus">-    task.onPageLoad(task, document);</span>
<a href="#l31.73"></a><span id="l31.73" class="difflineminus">-  }</span>
<a href="#l31.74"></a><span id="l31.74" class="difflineminus">-}</span>
<a href="#l31.75"></a><span id="l31.75" class="difflineminus">-</span>
<a href="#l31.76"></a><span id="l31.76" class="difflineminus">-function drawSurveyForm(task, contentDiv) {</span>
<a href="#l31.77"></a><span id="l31.77" class="difflineminus">-  let surveyQuestions = task.surveyQuestions;</span>
<a href="#l31.78"></a><span id="l31.78" class="difflineminus">-</span>
<a href="#l31.79"></a><span id="l31.79" class="difflineminus">-  /* Fill form fields with old survey answers if available --</span>
<a href="#l31.80"></a><span id="l31.80" class="difflineminus">-   * but not if the survey version has changed since you stored them!!</span>
<a href="#l31.81"></a><span id="l31.81" class="difflineminus">-   * (bug 576482) */</span>
<a href="#l31.82"></a><span id="l31.82" class="difflineminus">-  let oldAnswers = null;</span>
<a href="#l31.83"></a><span id="l31.83" class="difflineminus">-  if (task.oldAnswers &amp;&amp; (task.version == task.oldAnswers[&quot;version_number&quot;])) {</span>
<a href="#l31.84"></a><span id="l31.84" class="difflineminus">-    oldAnswers = task.oldAnswers[&quot;answers&quot;];</span>
<a href="#l31.85"></a><span id="l31.85" class="difflineminus">-  }</span>
<a href="#l31.86"></a><span id="l31.86" class="difflineminus">-</span>
<a href="#l31.87"></a><span id="l31.87" class="difflineminus">-  let submitButton = document.getElementById(&quot;survey-submit&quot;);</span>
<a href="#l31.88"></a><span id="l31.88" class="difflineminus">-  submitButton.setAttribute(&quot;style&quot;, &quot;&quot;);</span>
<a href="#l31.89"></a><span id="l31.89" class="difflineminus">-  let changeButton = document.getElementById(&quot;change-answers&quot;);</span>
<a href="#l31.90"></a><span id="l31.90" class="difflineminus">-  changeButton.setAttribute(&quot;style&quot;, &quot;display:none&quot;);</span>
<a href="#l31.91"></a><span id="l31.91" class="difflineminus">-  // Loop through questions and render html form input elements for each</span>
<a href="#l31.92"></a><span id="l31.92" class="difflineminus">-  // one.</span>
<a href="#l31.93"></a><span id="l31.93" class="difflineminus">-  for (let i = 0; i &lt; surveyQuestions.length; i++) {</span>
<a href="#l31.94"></a><span id="l31.94" class="difflineminus">-    let question = surveyQuestions[i].question;</span>
<a href="#l31.95"></a><span id="l31.95" class="difflineminus">-    let explanation = surveyQuestions[i].explanation;</span>
<a href="#l31.96"></a><span id="l31.96" class="difflineminus">-    let elem, j;</span>
<a href="#l31.97"></a><span id="l31.97" class="difflineminus">-</span>
<a href="#l31.98"></a><span id="l31.98" class="difflineminus">-    elem = document.createElement(&quot;h3&quot;);</span>
<a href="#l31.99"></a><span id="l31.99" class="difflineminus">-    elem.textContent = (i+1) + &quot;. &quot; + question;</span>
<a href="#l31.100"></a><span id="l31.100" class="difflineminus">-    contentDiv.appendChild(elem);</span>
<a href="#l31.101"></a><span id="l31.101" class="difflineminus">-    if (explanation) {</span>
<a href="#l31.102"></a><span id="l31.102" class="difflineminus">-      elem = document.createElement(&quot;p&quot;);</span>
<a href="#l31.103"></a><span id="l31.103" class="difflineminus">-      elem.setAttribute(&quot;class&quot;, &quot;survey-question-explanation&quot;);</span>
<a href="#l31.104"></a><span id="l31.104" class="difflineminus">-      // XXX this might need to support HTML</span>
<a href="#l31.105"></a><span id="l31.105" class="difflineminus">-      elem.textContent = explanation;</span>
<a href="#l31.106"></a><span id="l31.106" class="difflineminus">-      contentDiv.appendChild(elem);</span>
<a href="#l31.107"></a><span id="l31.107" class="difflineminus">-    }</span>
<a href="#l31.108"></a><span id="l31.108" class="difflineminus">-    // If you've done this survey before, preset all inputs using old answers</span>
<a href="#l31.109"></a><span id="l31.109" class="difflineminus">-    let choices = surveyQuestions[i].choices;</span>
<a href="#l31.110"></a><span id="l31.110" class="difflineminus">-    switch (surveyQuestions[i].type) {</span>
<a href="#l31.111"></a><span id="l31.111" class="difflineminus">-    case MULTIPLE_CHOICE:</span>
<a href="#l31.112"></a><span id="l31.112" class="difflineminus">-      for (j = 0; j &lt; choices.length; j++) {</span>
<a href="#l31.113"></a><span id="l31.113" class="difflineminus">-        let newRadio = document.createElement(&quot;input&quot;);</span>
<a href="#l31.114"></a><span id="l31.114" class="difflineminus">-        newRadio.setAttribute(&quot;type&quot;, &quot;radio&quot;);</span>
<a href="#l31.115"></a><span id="l31.115" class="difflineminus">-        newRadio.setAttribute(&quot;name&quot;, &quot;answer_to_&quot; + i);</span>
<a href="#l31.116"></a><span id="l31.116" class="difflineminus">-        newRadio.setAttribute(&quot;value&quot;, j);</span>
<a href="#l31.117"></a><span id="l31.117" class="difflineminus">-        if (oldAnswers &amp;&amp; oldAnswers[i] == String(j)) {</span>
<a href="#l31.118"></a><span id="l31.118" class="difflineminus">-          newRadio.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l31.119"></a><span id="l31.119" class="difflineminus">-        }</span>
<a href="#l31.120"></a><span id="l31.120" class="difflineminus">-        let label = document.createElement(&quot;span&quot;);</span>
<a href="#l31.121"></a><span id="l31.121" class="difflineminus">-        label.textContent = choices[j];</span>
<a href="#l31.122"></a><span id="l31.122" class="difflineminus">-        contentDiv.appendChild(newRadio);</span>
<a href="#l31.123"></a><span id="l31.123" class="difflineminus">-        contentDiv.appendChild(label);</span>
<a href="#l31.124"></a><span id="l31.124" class="difflineminus">-        contentDiv.appendChild(document.createElement(&quot;br&quot;));</span>
<a href="#l31.125"></a><span id="l31.125" class="difflineminus">-      }</span>
<a href="#l31.126"></a><span id="l31.126" class="difflineminus">-      break;</span>
<a href="#l31.127"></a><span id="l31.127" class="difflineminus">-    case CHECK_BOXES:</span>
<a href="#l31.128"></a><span id="l31.128" class="difflineminus">-    case CHECK_BOXES_WITH_FREE_ENTRY:</span>
<a href="#l31.129"></a><span id="l31.129" class="difflineminus">-      let checkboxName = &quot;answer_to_&quot; + i;</span>
<a href="#l31.130"></a><span id="l31.130" class="difflineminus">-      // Check boxes:</span>
<a href="#l31.131"></a><span id="l31.131" class="difflineminus">-      for (j = 0; j &lt; choices.length; j++) {</span>
<a href="#l31.132"></a><span id="l31.132" class="difflineminus">-        let newCheck = document.createElement(&quot;input&quot;);</span>
<a href="#l31.133"></a><span id="l31.133" class="difflineminus">-        newCheck.setAttribute(&quot;type&quot;, &quot;checkbox&quot;);</span>
<a href="#l31.134"></a><span id="l31.134" class="difflineminus">-        newCheck.setAttribute(&quot;name&quot;, checkboxName);</span>
<a href="#l31.135"></a><span id="l31.135" class="difflineminus">-        newCheck.setAttribute(&quot;value&quot;, j);</span>
<a href="#l31.136"></a><span id="l31.136" class="difflineminus">-        if (oldAnswers &amp;&amp; oldAnswers[i]) {</span>
<a href="#l31.137"></a><span id="l31.137" class="difflineminus">-          for each (let an in oldAnswers[i]) {</span>
<a href="#l31.138"></a><span id="l31.138" class="difflineminus">-            if (an == String(j)) {</span>
<a href="#l31.139"></a><span id="l31.139" class="difflineminus">-              newCheck.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l31.140"></a><span id="l31.140" class="difflineminus">-              break;</span>
<a href="#l31.141"></a><span id="l31.141" class="difflineminus">-            }</span>
<a href="#l31.142"></a><span id="l31.142" class="difflineminus">-          }</span>
<a href="#l31.143"></a><span id="l31.143" class="difflineminus">-        }</span>
<a href="#l31.144"></a><span id="l31.144" class="difflineminus">-        let label = document.createElement(&quot;span&quot;);</span>
<a href="#l31.145"></a><span id="l31.145" class="difflineminus">-        label.textContent = choices[j];</span>
<a href="#l31.146"></a><span id="l31.146" class="difflineminus">-        contentDiv.appendChild(newCheck);</span>
<a href="#l31.147"></a><span id="l31.147" class="difflineminus">-        contentDiv.appendChild(label);</span>
<a href="#l31.148"></a><span id="l31.148" class="difflineminus">-        contentDiv.appendChild(document.createElement(&quot;br&quot;));</span>
<a href="#l31.149"></a><span id="l31.149" class="difflineminus">-      }</span>
<a href="#l31.150"></a><span id="l31.150" class="difflineminus">-      // Text area:</span>
<a href="#l31.151"></a><span id="l31.151" class="difflineminus">-      if (surveyQuestions[i].type == CHECK_BOXES_WITH_FREE_ENTRY &amp;&amp;</span>
<a href="#l31.152"></a><span id="l31.152" class="difflineminus">-          surveyQuestions[i].free_entry) {</span>
<a href="#l31.153"></a><span id="l31.153" class="difflineminus">-        let freeformId = &quot;freeform_&quot; + i;</span>
<a href="#l31.154"></a><span id="l31.154" class="difflineminus">-        let newCheck = document.createElement(&quot;input&quot;);</span>
<a href="#l31.155"></a><span id="l31.155" class="difflineminus">-        newCheck.setAttribute(&quot;type&quot;, &quot;checkbox&quot;);</span>
<a href="#l31.156"></a><span id="l31.156" class="difflineminus">-        newCheck.setAttribute(&quot;name&quot;, checkboxName);</span>
<a href="#l31.157"></a><span id="l31.157" class="difflineminus">-        newCheck.setAttribute(&quot;value&quot;, freeformId);</span>
<a href="#l31.158"></a><span id="l31.158" class="difflineminus">-        newCheck.addEventListener(</span>
<a href="#l31.159"></a><span id="l31.159" class="difflineminus">-          &quot;click&quot;, function(event) {</span>
<a href="#l31.160"></a><span id="l31.160" class="difflineminus">-            if (!event.target.checked) {</span>
<a href="#l31.161"></a><span id="l31.161" class="difflineminus">-              document.getElementById(freeformId).value = &quot;&quot;;</span>
<a href="#l31.162"></a><span id="l31.162" class="difflineminus">-            }</span>
<a href="#l31.163"></a><span id="l31.163" class="difflineminus">-          }, false);</span>
<a href="#l31.164"></a><span id="l31.164" class="difflineminus">-        let label = document.createElement(&quot;span&quot;);</span>
<a href="#l31.165"></a><span id="l31.165" class="difflineminus">-        label.textContent = surveyQuestions[i].free_entry + &quot;&amp;nbsp:&amp;nbsp&quot;;</span>
<a href="#l31.166"></a><span id="l31.166" class="difflineminus">-        let inputBox = document.createElement(&quot;textarea&quot;);</span>
<a href="#l31.167"></a><span id="l31.167" class="difflineminus">-        inputBox.setAttribute(&quot;id&quot;, freeformId);</span>
<a href="#l31.168"></a><span id="l31.168" class="difflineminus">-        inputBox.addEventListener(</span>
<a href="#l31.169"></a><span id="l31.169" class="difflineminus">-          &quot;keypress&quot;, function() {</span>
<a href="#l31.170"></a><span id="l31.170" class="difflineminus">-            let elements = document.getElementsByName(checkboxName);</span>
<a href="#l31.171"></a><span id="l31.171" class="difflineminus">-            for (j = (elements.length - 1); j &gt;= 0; j--) {</span>
<a href="#l31.172"></a><span id="l31.172" class="difflineminus">-              if (elements[j].value == freeformId) {</span>
<a href="#l31.173"></a><span id="l31.173" class="difflineminus">-                elements[j].checked = true;</span>
<a href="#l31.174"></a><span id="l31.174" class="difflineminus">-                break;</span>
<a href="#l31.175"></a><span id="l31.175" class="difflineminus">-              }</span>
<a href="#l31.176"></a><span id="l31.176" class="difflineminus">-            }</span>
<a href="#l31.177"></a><span id="l31.177" class="difflineminus">-          }, false);</span>
<a href="#l31.178"></a><span id="l31.178" class="difflineminus">-        if (oldAnswers &amp;&amp; oldAnswers[i]) {</span>
<a href="#l31.179"></a><span id="l31.179" class="difflineminus">-          for each (let an in oldAnswers[i]) {</span>
<a href="#l31.180"></a><span id="l31.180" class="difflineminus">-            if (isNaN(parseInt(an))) {</span>
<a href="#l31.181"></a><span id="l31.181" class="difflineminus">-              newCheck.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l31.182"></a><span id="l31.182" class="difflineminus">-              inputBox.value = an;</span>
<a href="#l31.183"></a><span id="l31.183" class="difflineminus">-              break;</span>
<a href="#l31.184"></a><span id="l31.184" class="difflineminus">-            }</span>
<a href="#l31.185"></a><span id="l31.185" class="difflineminus">-          }</span>
<a href="#l31.186"></a><span id="l31.186" class="difflineminus">-        }</span>
<a href="#l31.187"></a><span id="l31.187" class="difflineminus">-        contentDiv.appendChild(newCheck);</span>
<a href="#l31.188"></a><span id="l31.188" class="difflineminus">-        contentDiv.appendChild(label);</span>
<a href="#l31.189"></a><span id="l31.189" class="difflineminus">-        contentDiv.appendChild(inputBox);</span>
<a href="#l31.190"></a><span id="l31.190" class="difflineminus">-      }</span>
<a href="#l31.191"></a><span id="l31.191" class="difflineminus">-      break;</span>
<a href="#l31.192"></a><span id="l31.192" class="difflineminus">-    case SCALE:</span>
<a href="#l31.193"></a><span id="l31.193" class="difflineminus">-      let label = document.createElement(&quot;span&quot;);</span>
<a href="#l31.194"></a><span id="l31.194" class="difflineminus">-      label.textContent = surveyQuestions[i].min_label;</span>
<a href="#l31.195"></a><span id="l31.195" class="difflineminus">-      contentDiv.appendChild(label);</span>
<a href="#l31.196"></a><span id="l31.196" class="difflineminus">-      for (j = surveyQuestions[i].scale_minimum;</span>
<a href="#l31.197"></a><span id="l31.197" class="difflineminus">-           j &lt;= surveyQuestions[i].scale_maximum;</span>
<a href="#l31.198"></a><span id="l31.198" class="difflineminus">-           j++) {</span>
<a href="#l31.199"></a><span id="l31.199" class="difflineminus">-        let newRadio = document.createElement(&quot;input&quot;);</span>
<a href="#l31.200"></a><span id="l31.200" class="difflineminus">-        newRadio.setAttribute(&quot;type&quot;, &quot;radio&quot;);</span>
<a href="#l31.201"></a><span id="l31.201" class="difflineminus">-        newRadio.setAttribute(&quot;name&quot;, &quot;answer_to_&quot; + i);</span>
<a href="#l31.202"></a><span id="l31.202" class="difflineminus">-        newRadio.setAttribute(&quot;value&quot;, j);</span>
<a href="#l31.203"></a><span id="l31.203" class="difflineminus">-        if (oldAnswers &amp;&amp; oldAnswers[i] == String(j)) {</span>
<a href="#l31.204"></a><span id="l31.204" class="difflineminus">-          newRadio.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l31.205"></a><span id="l31.205" class="difflineminus">-        }</span>
<a href="#l31.206"></a><span id="l31.206" class="difflineminus">-        contentDiv.appendChild(newRadio);</span>
<a href="#l31.207"></a><span id="l31.207" class="difflineminus">-      }</span>
<a href="#l31.208"></a><span id="l31.208" class="difflineminus">-      label = document.createElement(&quot;span&quot;);</span>
<a href="#l31.209"></a><span id="l31.209" class="difflineminus">-      label.textContent = surveyQuestions[i].max_label;</span>
<a href="#l31.210"></a><span id="l31.210" class="difflineminus">-      contentDiv.appendChild(label);</span>
<a href="#l31.211"></a><span id="l31.211" class="difflineminus">-      break;</span>
<a href="#l31.212"></a><span id="l31.212" class="difflineminus">-    case FREE_ENTRY:</span>
<a href="#l31.213"></a><span id="l31.213" class="difflineminus">-      let inputBox = document.createElement(&quot;textarea&quot;);</span>
<a href="#l31.214"></a><span id="l31.214" class="difflineminus">-      inputBox.setAttribute(&quot;id&quot;, &quot;freeform_&quot; + i);</span>
<a href="#l31.215"></a><span id="l31.215" class="difflineminus">-</span>
<a href="#l31.216"></a><span id="l31.216" class="difflineminus">-      if (oldAnswers &amp;&amp; oldAnswers[i] &amp;&amp; (oldAnswers[i].length &gt; 0)) {</span>
<a href="#l31.217"></a><span id="l31.217" class="difflineminus">-        inputBox.value = oldAnswers[i];</span>
<a href="#l31.218"></a><span id="l31.218" class="difflineminus">-      }</span>
<a href="#l31.219"></a><span id="l31.219" class="difflineminus">-      contentDiv.appendChild(inputBox);</span>
<a href="#l31.220"></a><span id="l31.220" class="difflineminus">-      break;</span>
<a href="#l31.221"></a><span id="l31.221" class="difflineminus">-    case MULTIPLE_CHOICE_WITH_FREE_ENTRY:</span>
<a href="#l31.222"></a><span id="l31.222" class="difflineminus">-      let checked = false;</span>
<a href="#l31.223"></a><span id="l31.223" class="difflineminus">-      let freeformId = &quot;freeform_&quot; + i;</span>
<a href="#l31.224"></a><span id="l31.224" class="difflineminus">-      let radioName = &quot;answer_to_&quot; + i;</span>
<a href="#l31.225"></a><span id="l31.225" class="difflineminus">-</span>
<a href="#l31.226"></a><span id="l31.226" class="difflineminus">-      for (j = 0; j &lt; choices.length; j++) {</span>
<a href="#l31.227"></a><span id="l31.227" class="difflineminus">-        let newRadio = document.createElement(&quot;input&quot;);</span>
<a href="#l31.228"></a><span id="l31.228" class="difflineminus">-        newRadio.setAttribute(&quot;type&quot;, &quot;radio&quot;);</span>
<a href="#l31.229"></a><span id="l31.229" class="difflineminus">-        newRadio.setAttribute(&quot;name&quot;, radioName);</span>
<a href="#l31.230"></a><span id="l31.230" class="difflineminus">-        newRadio.setAttribute(&quot;value&quot;, j);</span>
<a href="#l31.231"></a><span id="l31.231" class="difflineminus">-        newRadio.addEventListener(</span>
<a href="#l31.232"></a><span id="l31.232" class="difflineminus">-          &quot;click&quot;, function() {</span>
<a href="#l31.233"></a><span id="l31.233" class="difflineminus">-            let inputBox = document.getElementById(freeformId);</span>
<a href="#l31.234"></a><span id="l31.234" class="difflineminus">-            if (inputBox) {</span>
<a href="#l31.235"></a><span id="l31.235" class="difflineminus">-              inputBox.value = &quot;&quot;;</span>
<a href="#l31.236"></a><span id="l31.236" class="difflineminus">-            }</span>
<a href="#l31.237"></a><span id="l31.237" class="difflineminus">-          }, false);</span>
<a href="#l31.238"></a><span id="l31.238" class="difflineminus">-        let label = document.createElement(&quot;span&quot;);</span>
<a href="#l31.239"></a><span id="l31.239" class="difflineminus">-        label.textContent = choices[j];</span>
<a href="#l31.240"></a><span id="l31.240" class="difflineminus">-        if (oldAnswers &amp;&amp; oldAnswers[i] == String(j)) {</span>
<a href="#l31.241"></a><span id="l31.241" class="difflineminus">-          newRadio.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l31.242"></a><span id="l31.242" class="difflineminus">-          checked = true;</span>
<a href="#l31.243"></a><span id="l31.243" class="difflineminus">-        }</span>
<a href="#l31.244"></a><span id="l31.244" class="difflineminus">-        contentDiv.appendChild(newRadio);</span>
<a href="#l31.245"></a><span id="l31.245" class="difflineminus">-        contentDiv.appendChild(label);</span>
<a href="#l31.246"></a><span id="l31.246" class="difflineminus">-        contentDiv.appendChild(document.createElement(&quot;br&quot;));</span>
<a href="#l31.247"></a><span id="l31.247" class="difflineminus">-      }</span>
<a href="#l31.248"></a><span id="l31.248" class="difflineminus">-</span>
<a href="#l31.249"></a><span id="l31.249" class="difflineminus">-      // Text area:</span>
<a href="#l31.250"></a><span id="l31.250" class="difflineminus">-      if (surveyQuestions[i].free_entry) {</span>
<a href="#l31.251"></a><span id="l31.251" class="difflineminus">-        let newRadio = document.createElement(&quot;input&quot;);</span>
<a href="#l31.252"></a><span id="l31.252" class="difflineminus">-        newRadio.setAttribute(&quot;type&quot;, &quot;radio&quot;);</span>
<a href="#l31.253"></a><span id="l31.253" class="difflineminus">-        newRadio.setAttribute(&quot;name&quot;, radioName);</span>
<a href="#l31.254"></a><span id="l31.254" class="difflineminus">-        newRadio.setAttribute(&quot;value&quot;, freeformId);</span>
<a href="#l31.255"></a><span id="l31.255" class="difflineminus">-        let label = document.createElement(&quot;span&quot;);</span>
<a href="#l31.256"></a><span id="l31.256" class="difflineminus">-        label.textContent = surveyQuestions[i].free_entry + &quot;&amp;nbsp:&amp;nbsp&quot;;</span>
<a href="#l31.257"></a><span id="l31.257" class="difflineminus">-        let inputBox = document.createElement(&quot;textarea&quot;);</span>
<a href="#l31.258"></a><span id="l31.258" class="difflineminus">-        inputBox.setAttribute(&quot;id&quot;, freeformId);</span>
<a href="#l31.259"></a><span id="l31.259" class="difflineminus">-        inputBox.addEventListener(</span>
<a href="#l31.260"></a><span id="l31.260" class="difflineminus">-          &quot;keypress&quot;, function() {</span>
<a href="#l31.261"></a><span id="l31.261" class="difflineminus">-            let elements = document.getElementsByName(radioName);</span>
<a href="#l31.262"></a><span id="l31.262" class="difflineminus">-            for (let j = 0; j &lt; elements.length; j++) {</span>
<a href="#l31.263"></a><span id="l31.263" class="difflineminus">-              if (elements[j].value == freeformId) {</span>
<a href="#l31.264"></a><span id="l31.264" class="difflineminus">-                elements[j].checked = true;</span>
<a href="#l31.265"></a><span id="l31.265" class="difflineminus">-              } else {</span>
<a href="#l31.266"></a><span id="l31.266" class="difflineminus">-                elements[j].checked = false;</span>
<a href="#l31.267"></a><span id="l31.267" class="difflineminus">-              }</span>
<a href="#l31.268"></a><span id="l31.268" class="difflineminus">-            }</span>
<a href="#l31.269"></a><span id="l31.269" class="difflineminus">-          }, false);</span>
<a href="#l31.270"></a><span id="l31.270" class="difflineminus">-       if (oldAnswers &amp;&amp; oldAnswers[i] &amp;&amp; (oldAnswers[i].length &gt; 0) &amp;&amp;</span>
<a href="#l31.271"></a><span id="l31.271" class="difflineminus">-            !checked) {</span>
<a href="#l31.272"></a><span id="l31.272" class="difflineminus">-          newRadio.setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l31.273"></a><span id="l31.273" class="difflineminus">-          inputBox.value = oldAnswers[i];</span>
<a href="#l31.274"></a><span id="l31.274" class="difflineminus">-        }</span>
<a href="#l31.275"></a><span id="l31.275" class="difflineminus">-        contentDiv.appendChild(newRadio);</span>
<a href="#l31.276"></a><span id="l31.276" class="difflineminus">-        contentDiv.appendChild(label);</span>
<a href="#l31.277"></a><span id="l31.277" class="difflineminus">-        contentDiv.appendChild(inputBox);</span>
<a href="#l31.278"></a><span id="l31.278" class="difflineminus">-      }</span>
<a href="#l31.279"></a><span id="l31.279" class="difflineminus">-      break;</span>
<a href="#l31.280"></a><span id="l31.280" class="difflineminus">-    }</span>
<a href="#l31.281"></a><span id="l31.281" class="difflineminus">-  }</span>
<a href="#l31.282"></a><span id="l31.282" class="difflineminus">-}</span>
<a href="#l31.283"></a><span id="l31.283" class="difflineminus">-</span>
<a href="#l31.284"></a><span id="l31.284" class="difflineminus">-function onBuiltinSurveySubmit() {</span>
<a href="#l31.285"></a><span id="l31.285" class="difflineminus">-  Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l31.286"></a><span id="l31.286" class="difflineminus">-  Components.utils.import(&quot;resource://testpilot/modules/log4moz.js&quot;);</span>
<a href="#l31.287"></a><span id="l31.287" class="difflineminus">-  let logger = Log4Moz.repository.getLogger(&quot;TestPilot.Survey&quot;);</span>
<a href="#l31.288"></a><span id="l31.288" class="difflineminus">-  let eid = getUrlParam(&quot;eid&quot;);</span>
<a href="#l31.289"></a><span id="l31.289" class="difflineminus">-  let task = TestPilotSetup.getTaskById(eid);</span>
<a href="#l31.290"></a><span id="l31.290" class="difflineminus">-  logger.info(&quot;Storing survey answers for survey id &quot; + eid);</span>
<a href="#l31.291"></a><span id="l31.291" class="difflineminus">-</span>
<a href="#l31.292"></a><span id="l31.292" class="difflineminus">-  // Read all values from form...</span>
<a href="#l31.293"></a><span id="l31.293" class="difflineminus">-  let answers = [];</span>
<a href="#l31.294"></a><span id="l31.294" class="difflineminus">-  let surveyQuestions = task.surveyQuestions;</span>
<a href="#l31.295"></a><span id="l31.295" class="difflineminus">-  let i;</span>
<a href="#l31.296"></a><span id="l31.296" class="difflineminus">-  for (i = 0; i &lt; surveyQuestions.length; i++) {</span>
<a href="#l31.297"></a><span id="l31.297" class="difflineminus">-    let elems = document.getElementsByName(&quot;answer_to_&quot; + i);</span>
<a href="#l31.298"></a><span id="l31.298" class="difflineminus">-    let anAnswer = [];</span>
<a href="#l31.299"></a><span id="l31.299" class="difflineminus">-    for each (let elem in elems) {</span>
<a href="#l31.300"></a><span id="l31.300" class="difflineminus">-      if (elem.checked &amp;&amp; elem.value != (&quot;freeform_&quot; + i)) {</span>
<a href="#l31.301"></a><span id="l31.301" class="difflineminus">-        anAnswer.push(elem.value);</span>
<a href="#l31.302"></a><span id="l31.302" class="difflineminus">-      }</span>
<a href="#l31.303"></a><span id="l31.303" class="difflineminus">-    }</span>
<a href="#l31.304"></a><span id="l31.304" class="difflineminus">-    let freeEntry = document.getElementById(&quot;freeform_&quot; + i);</span>
<a href="#l31.305"></a><span id="l31.305" class="difflineminus">-    if (freeEntry &amp;&amp; freeEntry.value) {</span>
<a href="#l31.306"></a><span id="l31.306" class="difflineminus">-      anAnswer.push(freeEntry.value);</span>
<a href="#l31.307"></a><span id="l31.307" class="difflineminus">-    }</span>
<a href="#l31.308"></a><span id="l31.308" class="difflineminus">-    answers.push(anAnswer);</span>
<a href="#l31.309"></a><span id="l31.309" class="difflineminus">-  }</span>
<a href="#l31.310"></a><span id="l31.310" class="difflineminus">-  let surveyResults = { answers: answers };</span>
<a href="#l31.311"></a><span id="l31.311" class="difflineminus">-  logger.info(&quot;Storing survey answers &quot; + JSON.stringify(surveyResults));</span>
<a href="#l31.312"></a><span id="l31.312" class="difflineminus">-  task.store(surveyResults, function(submitted) {</span>
<a href="#l31.313"></a><span id="l31.313" class="difflineminus">-    // Reload page to show submitted status:</span>
<a href="#l31.314"></a><span id="l31.314" class="difflineminus">-    if (submitted) {</span>
<a href="#l31.315"></a><span id="l31.315" class="difflineminus">-      onBuiltinSurveyLoad();</span>
<a href="#l31.316"></a><span id="l31.316" class="difflineminus">-    }</span>
<a href="#l31.317"></a><span id="l31.317" class="difflineminus">-  });</span>
<a href="#l31.318"></a><span id="l31.318" class="difflineminus">-}</span>
<a href="#l31.319"></a><span id="l31.319" class="difflineminus">-</span>
<a href="#l31.320"></a><span id="l31.320" class="difflineminus">-function onBuiltinSurveyChangeAnswers() {</span>
<a href="#l31.321"></a><span id="l31.321" class="difflineminus">-  let eid = getUrlParam(&quot;eid&quot;);</span>
<a href="#l31.322"></a><span id="l31.322" class="difflineminus">-  let task = TestPilotSetup.getTaskById(eid);</span>
<a href="#l31.323"></a><span id="l31.323" class="difflineminus">-  let contentDiv = document.getElementById(&quot;survey-contents&quot;);</span>
<a href="#l31.324"></a><span id="l31.324" class="difflineminus">-</span>
<a href="#l31.325"></a><span id="l31.325" class="difflineminus">-  drawSurveyForm(task, contentDiv);</span>
<a href="#l31.326"></a><span id="l31.326" class="difflineminus">-}</span>
<a href="#l31.327"></a><span id="l31.327" class="difflineminus">-</span>
<a href="#l31.328"></a><span id="l31.328" class="difflineminus">-function setStrings() {</span>
<a href="#l31.329"></a><span id="l31.329" class="difflineminus">-  stringBundle =</span>
<a href="#l31.330"></a><span id="l31.330" class="difflineminus">-    Components.classes[&quot;@mozilla.org/intl/stringbundle;1&quot;].</span>
<a href="#l31.331"></a><span id="l31.331" class="difflineminus">-      getService(Components.interfaces.nsIStringBundleService).</span>
<a href="#l31.332"></a><span id="l31.332" class="difflineminus">-        createBundle(&quot;chrome://testpilot/locale/main.properties&quot;);</span>
<a href="#l31.333"></a><span id="l31.333" class="difflineminus">-  let map = [</span>
<a href="#l31.334"></a><span id="l31.334" class="difflineminus">-    { id: &quot;page-title&quot;, stringKey: &quot;testpilot.fullBrandName&quot; },</span>
<a href="#l31.335"></a><span id="l31.335" class="difflineminus">-    { id: &quot;comments-and-discussions-link&quot;,</span>
<a href="#l31.336"></a><span id="l31.336" class="difflineminus">-      stringKey: &quot;testpilot.page.commentsAndDiscussions&quot; },</span>
<a href="#l31.337"></a><span id="l31.337" class="difflineminus">-    { id: &quot;propose-test-link&quot;,</span>
<a href="#l31.338"></a><span id="l31.338" class="difflineminus">-      stringKey: &quot;testpilot.page.proposeATest&quot; },</span>
<a href="#l31.339"></a><span id="l31.339" class="difflineminus">-    { id: &quot;testpilot-twitter-link&quot;,</span>
<a href="#l31.340"></a><span id="l31.340" class="difflineminus">-      stringKey: &quot;testpilot.page.testpilotOnTwitter&quot; },</span>
<a href="#l31.341"></a><span id="l31.341" class="difflineminus">-    { id: &quot;change-answers&quot;,</span>
<a href="#l31.342"></a><span id="l31.342" class="difflineminus">-      stringKey: &quot;testpilot.surveyPage.changeAnswers&quot; }</span>
<a href="#l31.343"></a><span id="l31.343" class="difflineminus">-  ];</span>
<a href="#l31.344"></a><span id="l31.344" class="difflineminus">-  let mapLength = map.length;</span>
<a href="#l31.345"></a><span id="l31.345" class="difflineminus">-  for (let i = 0; i &lt; mapLength; i++) {</span>
<a href="#l31.346"></a><span id="l31.346" class="difflineminus">-    let entry = map[i];</span>
<a href="#l31.347"></a><span id="l31.347" class="difflineminus">-    document.getElementById(entry.id).textContent =</span>
<a href="#l31.348"></a><span id="l31.348" class="difflineminus">-      stringBundle.GetStringFromName(entry.stringKey);</span>
<a href="#l31.349"></a><span id="l31.349" class="difflineminus">-  }</span>
<a href="#l31.350"></a><span id="l31.350" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1">deleted file mode 100644</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/take-survey.html</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineplus">+++ /dev/null</span>
<a href="#l32.4"></a><span id="l32.4" class="difflineat">@@ -1,57 +0,0 @@</span>
<a href="#l32.5"></a><span id="l32.5" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l32.6"></a><span id="l32.6" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l32.7"></a><span id="l32.7" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l32.8"></a><span id="l32.8" class="difflineminus">-</span>
<a href="#l32.9"></a><span id="l32.9" class="difflineminus">-&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;</span>
<a href="#l32.10"></a><span id="l32.10" class="difflineminus">-	&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;</span>
<a href="#l32.11"></a><span id="l32.11" class="difflineminus">-</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;en&quot; lang=&quot;en&quot;&gt;</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineminus">-&lt;head&gt;</span>
<a href="#l32.14"></a><span id="l32.14" class="difflineminus">-  &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span>
<a href="#l32.15"></a><span id="l32.15" class="difflineminus">-  &lt;title id=&quot;page-title&quot;&gt;&lt;/title&gt;</span>
<a href="#l32.16"></a><span id="l32.16" class="difflineminus">-  &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; media=&quot;all&quot;</span>
<a href="#l32.17"></a><span id="l32.17" class="difflineminus">-    href=&quot;chrome://testpilot/skin/css/screen-standalone.css&quot; /&gt;</span>
<a href="#l32.18"></a><span id="l32.18" class="difflineminus">-  &lt;script src=&quot;experiment-page.js&quot; type=&quot;application/javascript;version=1.8&quot;&gt;</span>
<a href="#l32.19"></a><span id="l32.19" class="difflineminus">-  &lt;/script&gt;</span>
<a href="#l32.20"></a><span id="l32.20" class="difflineminus">-  &lt;script src=&quot;survey-generator.js&quot; type=&quot;application/javascript;version=1.8&quot;&gt;</span>
<a href="#l32.21"></a><span id="l32.21" class="difflineminus">-  &lt;/script&gt;</span>
<a href="#l32.22"></a><span id="l32.22" class="difflineminus">-&lt;/head&gt;</span>
<a href="#l32.23"></a><span id="l32.23" class="difflineminus">-&lt;body onload=&quot;onBuiltinSurveyLoad();&quot;&gt;</span>
<a href="#l32.24"></a><span id="l32.24" class="difflineminus">-  &lt;div id=&quot;container&quot;&gt;</span>
<a href="#l32.25"></a><span id="l32.25" class="difflineminus">-    &lt;div id=&quot;content-standalone&quot;&gt;</span>
<a href="#l32.26"></a><span id="l32.26" class="difflineminus">-      &lt;div id=&quot;intro&quot;&gt;</span>
<a href="#l32.27"></a><span id="l32.27" class="difflineminus">-        &lt;h1 id=&quot;survey-title&quot;&gt;&lt;/h1&gt;</span>
<a href="#l32.28"></a><span id="l32.28" class="difflineminus">-        &lt;p id=&quot;survey-explanation&quot;&gt;&lt;/p&gt;</span>
<a href="#l32.29"></a><span id="l32.29" class="difflineminus">-        &lt;div id=&quot;survey-contents&quot;&gt;&lt;/div&gt;</span>
<a href="#l32.30"></a><span id="l32.30" class="difflineminus">-        &lt;br&gt;</span>
<a href="#l32.31"></a><span id="l32.31" class="difflineminus">-        &lt;button id=&quot;survey-submit&quot; style=&quot;display:none&quot;</span>
<a href="#l32.32"></a><span id="l32.32" class="difflineminus">-          onclick=&quot;onBuiltinSurveySubmit();&quot;&gt;&lt;/button&gt;</span>
<a href="#l32.33"></a><span id="l32.33" class="difflineminus">-        &lt;button id=&quot;change-answers&quot; style=&quot;display:none&quot;</span>
<a href="#l32.34"></a><span id="l32.34" class="difflineminus">-          onclick=&quot;onBuiltinSurveyChangeAnswers();&quot;&gt;&lt;/button&gt;</span>
<a href="#l32.35"></a><span id="l32.35" class="difflineminus">-      &lt;/div&gt;</span>
<a href="#l32.36"></a><span id="l32.36" class="difflineminus">-      &lt;div id=&quot;links&quot;&gt;</span>
<a href="#l32.37"></a><span id="l32.37" class="difflineminus">-        &lt;p class=&quot;spacer&quot;&gt;</span>
<a href="#l32.38"></a><span id="l32.38" class="difflineminus">-        &lt;div class=&quot;home_callout&quot;&gt;</span>
<a href="#l32.39"></a><span id="l32.39" class="difflineminus">-	  &lt;img class=&quot;homeIcon&quot;</span>
<a href="#l32.40"></a><span id="l32.40" class="difflineminus">-	    src=&quot;chrome://testpilot/skin/images/home_comments.png&quot;&gt;</span>
<a href="#l32.41"></a><span id="l32.41" class="difflineminus">-	  &lt;a onclick=&quot;</span>
<a href="#l32.42"></a><span id="l32.42" class="difflineminus">-	    openLink('http://groups.google.com/group/mozilla-labs-testpilot');&quot;</span>
<a href="#l32.43"></a><span id="l32.43" class="difflineminus">-	    id=&quot;comments-and-discussions-link&quot;&gt;&lt;/a&gt;</span>
<a href="#l32.44"></a><span id="l32.44" class="difflineminus">-        &lt;/div&gt; &lt;br&gt;</span>
<a href="#l32.45"></a><span id="l32.45" class="difflineminus">-        &lt;div class=&quot;home_callout&quot;&gt;</span>
<a href="#l32.46"></a><span id="l32.46" class="difflineminus">-	  &lt;img class=&quot;homeIcon&quot;</span>
<a href="#l32.47"></a><span id="l32.47" class="difflineminus">-	    src=&quot;chrome://testpilot/skin/images/home_results.png&quot;&gt;</span>
<a href="#l32.48"></a><span id="l32.48" class="difflineminus">-	  &lt;a onclick=&quot;openLink('https://wiki.mozilla.org/Labs/Test_Pilot');&quot;</span>
<a href="#l32.49"></a><span id="l32.49" class="difflineminus">-	    id=&quot;propose-test-link&quot;&gt;&lt;/a&gt;</span>
<a href="#l32.50"></a><span id="l32.50" class="difflineminus">-	&lt;/div&gt;&lt;br&gt;</span>
<a href="#l32.51"></a><span id="l32.51" class="difflineminus">-        &lt;div class=&quot;home_callout&quot;&gt;</span>
<a href="#l32.52"></a><span id="l32.52" class="difflineminus">-	  &lt;img class=&quot;homeIcon&quot;</span>
<a href="#l32.53"></a><span id="l32.53" class="difflineminus">-	    src=&quot;chrome://testpilot/skin/images/home_twitter.png&quot;&gt;</span>
<a href="#l32.54"></a><span id="l32.54" class="difflineminus">-	  &lt;a onclick=&quot;openLink('http://www.twitter.com/MozTestPilot');&quot;</span>
<a href="#l32.55"></a><span id="l32.55" class="difflineminus">-	    id=&quot;testpilot-twitter-link&quot;&gt;&lt;/a&gt;</span>
<a href="#l32.56"></a><span id="l32.56" class="difflineminus">-	&lt;/div&gt;</span>
<a href="#l32.57"></a><span id="l32.57" class="difflineminus">-      &lt;/div&gt;</span>
<a href="#l32.58"></a><span id="l32.58" class="difflineminus">-    &lt;/div&gt;</span>
<a href="#l32.59"></a><span id="l32.59" class="difflineminus">-  &lt;/div&gt;</span>
<a href="#l32.60"></a><span id="l32.60" class="difflineminus">-&lt;/body&gt;</span>
<a href="#l32.61"></a><span id="l32.61" class="difflineminus">-&lt;/html&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1">deleted file mode 100644</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/tp-browser-customNotifications.xul</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineplus">+++ /dev/null</span>
<a href="#l33.4"></a><span id="l33.4" class="difflineat">@@ -1,90 +0,0 @@</span>
<a href="#l33.5"></a><span id="l33.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l33.6"></a><span id="l33.6" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l33.7"></a><span id="l33.7" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l33.8"></a><span id="l33.8" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l33.9"></a><span id="l33.9" class="difflineminus">-</span>
<a href="#l33.10"></a><span id="l33.10" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://testpilot/content/browser.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l33.11"></a><span id="l33.11" class="difflineminus">-</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-&lt;!DOCTYPE overlay [</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineminus">-  &lt;!ENTITY % testpilotDTD SYSTEM &quot;chrome://testpilot/locale/main.dtd&quot;&gt;</span>
<a href="#l33.14"></a><span id="l33.14" class="difflineminus">-    %testpilotDTD;</span>
<a href="#l33.15"></a><span id="l33.15" class="difflineminus">-]&gt;</span>
<a href="#l33.16"></a><span id="l33.16" class="difflineminus">-</span>
<a href="#l33.17"></a><span id="l33.17" class="difflineminus">-&lt;overlay xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l33.18"></a><span id="l33.18" class="difflineminus">-&lt;menupopup id=&quot;menu_ToolsPopup&quot;&gt;</span>
<a href="#l33.19"></a><span id="l33.19" class="difflineminus">-  &lt;menu id=&quot;pilot-menu&quot; insertafter=&quot;menu_openAddons&quot; /&gt;</span>
<a href="#l33.20"></a><span id="l33.20" class="difflineminus">-&lt;/menupopup&gt;</span>
<a href="#l33.21"></a><span id="l33.21" class="difflineminus">-&lt;menupopup id=&quot;taskPopup&quot;&gt;</span>
<a href="#l33.22"></a><span id="l33.22" class="difflineminus">-  &lt;menu id=&quot;pilot-menu&quot; insertafter=&quot;addonsManager&quot; /&gt;</span>
<a href="#l33.23"></a><span id="l33.23" class="difflineminus">-&lt;/menupopup&gt;</span>
<a href="#l33.24"></a><span id="l33.24" class="difflineminus">-</span>
<a href="#l33.25"></a><span id="l33.25" class="difflineminus">-</span>
<a href="#l33.26"></a><span id="l33.26" class="difflineminus">-&lt;menu id=&quot;pilot-menu&quot; class=&quot;menu-iconic&quot; label=&quot;&amp;testpilot.brand.label;&quot;</span>
<a href="#l33.27"></a><span id="l33.27" class="difflineminus">-      insertafter=&quot;addonsManager&quot;</span>
<a href="#l33.28"></a><span id="l33.28" class="difflineminus">-      image=&quot;chrome://testpilot/skin/testpilot_16x16.png&quot;&gt;</span>
<a href="#l33.29"></a><span id="l33.29" class="difflineminus">-  &lt;menupopup id=&quot;pilot-menu-popup&quot;</span>
<a href="#l33.30"></a><span id="l33.30" class="difflineminus">-             onpopuphiding=&quot;TestPilotMenuUtils.onPopupHiding(event);&quot;&gt;</span>
<a href="#l33.31"></a><span id="l33.31" class="difflineminus">-    &lt;menu id=&quot;pilot-notification-settings&quot; label=&quot;&amp;testpilot.settings.label;&quot;&gt;</span>
<a href="#l33.32"></a><span id="l33.32" class="difflineminus">-      &lt;menupopup onpopupshowing=&quot;TestPilotMenuUtils.updateSubmenu();&quot;&gt;</span>
<a href="#l33.33"></a><span id="l33.33" class="difflineminus">-        &lt;menuitem class=&quot;pilot-notify-me-when&quot;</span>
<a href="#l33.34"></a><span id="l33.34" class="difflineminus">-                  label=&quot;&amp;testpilot.settings.notifyWhen.label;&quot;</span>
<a href="#l33.35"></a><span id="l33.35" class="difflineminus">-                  disabled=&quot;true&quot;/&gt;</span>
<a href="#l33.36"></a><span id="l33.36" class="difflineminus">-        &lt;menuitem id=&quot;pilot-menu-notify-finished&quot;</span>
<a href="#l33.37"></a><span id="l33.37" class="difflineminus">-                  label=&quot;&amp;testpilot.settings.readyToSubmit.label;&quot;</span>
<a href="#l33.38"></a><span id="l33.38" class="difflineminus">-                  type=&quot;checkbox&quot;</span>
<a href="#l33.39"></a><span id="l33.39" class="difflineminus">-                  oncommand=&quot;</span>
<a href="#l33.40"></a><span id="l33.40" class="difflineminus">-                    TestPilotMenuUtils.togglePref('popup.showOnStudyFinished');&quot;/&gt;</span>
<a href="#l33.41"></a><span id="l33.41" class="difflineminus">-        &lt;menuitem id=&quot;pilot-menu-notify-new&quot;</span>
<a href="#l33.42"></a><span id="l33.42" class="difflineminus">-                  label=&quot;&amp;testpilot.settings.newStudy.label;&quot; type=&quot;checkbox&quot;</span>
<a href="#l33.43"></a><span id="l33.43" class="difflineminus">-                  oncommand=&quot;</span>
<a href="#l33.44"></a><span id="l33.44" class="difflineminus">-                    TestPilotMenuUtils.togglePref('popup.showOnNewStudy');&quot;/&gt;</span>
<a href="#l33.45"></a><span id="l33.45" class="difflineminus">-        &lt;menuitem id=&quot;pilot-menu-notify-results&quot;</span>
<a href="#l33.46"></a><span id="l33.46" class="difflineminus">-                  label=&quot;&amp;testpilot.settings.hasNewResults.label;&quot;</span>
<a href="#l33.47"></a><span id="l33.47" class="difflineminus">-                  type=&quot;checkbox&quot;</span>
<a href="#l33.48"></a><span id="l33.48" class="difflineminus">-                  oncommand=&quot;</span>
<a href="#l33.49"></a><span id="l33.49" class="difflineminus">-                    TestPilotMenuUtils.togglePref('popup.showOnNewResults');&quot;/&gt;</span>
<a href="#l33.50"></a><span id="l33.50" class="difflineminus">-        &lt;menuseparator /&gt;</span>
<a href="#l33.51"></a><span id="l33.51" class="difflineminus">-        &lt;menuitem id=&quot;pilot-menu-always-submit-data&quot;</span>
<a href="#l33.52"></a><span id="l33.52" class="difflineminus">-                  label=&quot;&amp;testpilot.settings.alwaysSubmitData.shortLabel;&quot;</span>
<a href="#l33.53"></a><span id="l33.53" class="difflineminus">-                  type=&quot;checkbox&quot;</span>
<a href="#l33.54"></a><span id="l33.54" class="difflineminus">-                  oncommand=&quot;</span>
<a href="#l33.55"></a><span id="l33.55" class="difflineminus">-                    TestPilotMenuUtils.togglePref('alwaysSubmitData');&quot;/&gt;</span>
<a href="#l33.56"></a><span id="l33.56" class="difflineminus">-      &lt;/menupopup&gt;</span>
<a href="#l33.57"></a><span id="l33.57" class="difflineminus">-    &lt;/menu&gt;</span>
<a href="#l33.58"></a><span id="l33.58" class="difflineminus">-    &lt;menuitem label=&quot;&amp;testpilot.allYourStudies.label;&quot;</span>
<a href="#l33.59"></a><span id="l33.59" class="difflineminus">-              oncommand=&quot;TestPilotWindowUtils.openAllStudiesWindow();&quot;/&gt;</span>
<a href="#l33.60"></a><span id="l33.60" class="difflineminus">-    &lt;menuitem label=&quot;&amp;testpilot.about.label;&quot;</span>
<a href="#l33.61"></a><span id="l33.61" class="difflineminus">-              oncommand=&quot;TestPilotWindowUtils.openHomepage();&quot;/&gt;</span>
<a href="#l33.62"></a><span id="l33.62" class="difflineminus">-  &lt;/menupopup&gt;</span>
<a href="#l33.63"></a><span id="l33.63" class="difflineminus">-&lt;/menu&gt;</span>
<a href="#l33.64"></a><span id="l33.64" class="difflineminus">-</span>
<a href="#l33.65"></a><span id="l33.65" class="difflineminus">-// XXX Thunderbird uses the toolbar rather than the status panel.</span>
<a href="#l33.66"></a><span id="l33.66" class="difflineminus">-&lt;toolbox id=&quot;mail-toolbox&quot;&gt;</span>
<a href="#l33.67"></a><span id="l33.67" class="difflineminus">-  &lt;panel id=&quot;pilot-notification-popup&quot; hidden=&quot;true&quot; noautofocus=&quot;true&quot;</span>
<a href="#l33.68"></a><span id="l33.68" class="difflineminus">-    level=&quot;parent&quot; position=&quot;after_start&quot;&gt;</span>
<a href="#l33.69"></a><span id="l33.69" class="difflineminus">-    &lt;vbox class=&quot;pilot-notification-popup-container&quot;&gt;</span>
<a href="#l33.70"></a><span id="l33.70" class="difflineminus">-      &lt;hbox class=&quot;pilot-notification-toprow&quot;&gt;</span>
<a href="#l33.71"></a><span id="l33.71" class="difflineminus">-        &lt;image id=&quot;pilot-notification-icon&quot; /&gt;</span>
<a href="#l33.72"></a><span id="l33.72" class="difflineminus">-        &lt;vbox pack=&quot;center&quot;&gt;</span>
<a href="#l33.73"></a><span id="l33.73" class="difflineminus">-          &lt;label id=&quot;pilot-notification-title&quot; class=&quot;pilot-title&quot; /&gt;</span>
<a href="#l33.74"></a><span id="l33.74" class="difflineminus">-        &lt;/vbox&gt;</span>
<a href="#l33.75"></a><span id="l33.75" class="difflineminus">-        &lt;spacer flex=&quot;1&quot; /&gt;</span>
<a href="#l33.76"></a><span id="l33.76" class="difflineminus">-        &lt;vbox pack=&quot;start&quot;&gt;</span>
<a href="#l33.77"></a><span id="l33.77" class="difflineminus">-          &lt;image id=&quot;pilot-notification-close&quot;</span>
<a href="#l33.78"></a><span id="l33.78" class="difflineminus">-            tooltiptext=&quot;&amp;testpilot.notification.close.tooltip;&quot; /&gt;</span>
<a href="#l33.79"></a><span id="l33.79" class="difflineminus">-        &lt;/vbox&gt;</span>
<a href="#l33.80"></a><span id="l33.80" class="difflineminus">-      &lt;/hbox&gt;</span>
<a href="#l33.81"></a><span id="l33.81" class="difflineminus">-      &lt;description id=&quot;pilot-notification-text&quot; /&gt;</span>
<a href="#l33.82"></a><span id="l33.82" class="difflineminus">-      &lt;hbox align=&quot;right&quot;&gt;&lt;label id=&quot;pilot-notification-link&quot; /&gt;&lt;/hbox&gt;</span>
<a href="#l33.83"></a><span id="l33.83" class="difflineminus">-      &lt;hbox&gt;</span>
<a href="#l33.84"></a><span id="l33.84" class="difflineminus">-        &lt;checkbox id=&quot;pilot-notification-always-submit-checkbox&quot;</span>
<a href="#l33.85"></a><span id="l33.85" class="difflineminus">-          label=&quot;&amp;testpilot.settings.alwaysSubmitData.shortLabel;&quot; /&gt;</span>
<a href="#l33.86"></a><span id="l33.86" class="difflineminus">-        &lt;spacer flex=&quot;1&quot; /&gt;</span>
<a href="#l33.87"></a><span id="l33.87" class="difflineminus">-      &lt;/hbox&gt;</span>
<a href="#l33.88"></a><span id="l33.88" class="difflineminus">-      &lt;hbox align=&quot;right&quot;&gt;</span>
<a href="#l33.89"></a><span id="l33.89" class="difflineminus">-        &lt;button id=&quot;pilot-notification-submit&quot; /&gt;</span>
<a href="#l33.90"></a><span id="l33.90" class="difflineminus">-      &lt;/hbox&gt;</span>
<a href="#l33.91"></a><span id="l33.91" class="difflineminus">-    &lt;/vbox&gt;</span>
<a href="#l33.92"></a><span id="l33.92" class="difflineminus">-  &lt;/panel&gt;</span>
<a href="#l33.93"></a><span id="l33.93" class="difflineminus">-&lt;/toolbox&gt;</span>
<a href="#l33.94"></a><span id="l33.94" class="difflineminus">-&lt;/overlay&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1">deleted file mode 100644</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/tp-browser-popupNotifications.xul</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineplus">+++ /dev/null</span>
<a href="#l34.4"></a><span id="l34.4" class="difflineat">@@ -1,69 +0,0 @@</span>
<a href="#l34.5"></a><span id="l34.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l34.6"></a><span id="l34.6" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l34.7"></a><span id="l34.7" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l34.8"></a><span id="l34.8" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l34.9"></a><span id="l34.9" class="difflineminus">-</span>
<a href="#l34.10"></a><span id="l34.10" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://testpilot/content/browser.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l34.11"></a><span id="l34.11" class="difflineminus">-</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-&lt;!DOCTYPE overlay [</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineminus">-  &lt;!ENTITY % testpilotDTD SYSTEM &quot;chrome://testpilot/locale/main.dtd&quot;&gt;</span>
<a href="#l34.14"></a><span id="l34.14" class="difflineminus">-    %testpilotDTD;</span>
<a href="#l34.15"></a><span id="l34.15" class="difflineminus">-]&gt;</span>
<a href="#l34.16"></a><span id="l34.16" class="difflineminus">-</span>
<a href="#l34.17"></a><span id="l34.17" class="difflineminus">-&lt;overlay xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l34.18"></a><span id="l34.18" class="difflineminus">-&lt;menupopup id=&quot;menu_ToolsPopup&quot;&gt;</span>
<a href="#l34.19"></a><span id="l34.19" class="difflineminus">-  &lt;menu id=&quot;pilot-menu&quot; insertafter=&quot;menu_openAddons&quot; /&gt;</span>
<a href="#l34.20"></a><span id="l34.20" class="difflineminus">-&lt;/menupopup&gt;</span>
<a href="#l34.21"></a><span id="l34.21" class="difflineminus">-&lt;menupopup id=&quot;taskPopup&quot;&gt;</span>
<a href="#l34.22"></a><span id="l34.22" class="difflineminus">-  &lt;menu id=&quot;pilot-menu&quot; insertafter=&quot;addonsManager&quot; /&gt;</span>
<a href="#l34.23"></a><span id="l34.23" class="difflineminus">-&lt;/menupopup&gt;</span>
<a href="#l34.24"></a><span id="l34.24" class="difflineminus">-</span>
<a href="#l34.25"></a><span id="l34.25" class="difflineminus">-&lt;menu id=&quot;pilot-menu&quot; class=&quot;menu-iconic&quot; label=&quot;&amp;testpilot.brand.label;&quot;</span>
<a href="#l34.26"></a><span id="l34.26" class="difflineminus">-      insertafter=&quot;addonsManager&quot;</span>
<a href="#l34.27"></a><span id="l34.27" class="difflineminus">-      image=&quot;chrome://testpilot/skin/testpilot_16x16.png&quot;&gt;</span>
<a href="#l34.28"></a><span id="l34.28" class="difflineminus">-  &lt;menupopup id=&quot;pilot-menu-popup&quot;</span>
<a href="#l34.29"></a><span id="l34.29" class="difflineminus">-             onpopuphiding=&quot;TestPilotMenuUtils.onPopupHiding(event);&quot;&gt;</span>
<a href="#l34.30"></a><span id="l34.30" class="difflineminus">-    &lt;menu id=&quot;pilot-notification-settings&quot; label=&quot;&amp;testpilot.settings.label;&quot;&gt;</span>
<a href="#l34.31"></a><span id="l34.31" class="difflineminus">-      &lt;menupopup onpopupshowing=&quot;TestPilotMenuUtils.updateSubmenu();&quot;&gt;</span>
<a href="#l34.32"></a><span id="l34.32" class="difflineminus">-        &lt;menuitem class=&quot;pilot-notify-me-when&quot;</span>
<a href="#l34.33"></a><span id="l34.33" class="difflineminus">-                  label=&quot;&amp;testpilot.settings.notifyWhen.label;&quot;</span>
<a href="#l34.34"></a><span id="l34.34" class="difflineminus">-                  disabled=&quot;true&quot;/&gt;</span>
<a href="#l34.35"></a><span id="l34.35" class="difflineminus">-        &lt;menuitem id=&quot;pilot-menu-notify-finished&quot;</span>
<a href="#l34.36"></a><span id="l34.36" class="difflineminus">-                  label=&quot;&amp;testpilot.settings.readyToSubmit.label;&quot;</span>
<a href="#l34.37"></a><span id="l34.37" class="difflineminus">-                  type=&quot;checkbox&quot;</span>
<a href="#l34.38"></a><span id="l34.38" class="difflineminus">-                  oncommand=&quot;</span>
<a href="#l34.39"></a><span id="l34.39" class="difflineminus">-                    TestPilotMenuUtils.togglePref('popup.showOnStudyFinished');&quot;/&gt;</span>
<a href="#l34.40"></a><span id="l34.40" class="difflineminus">-        &lt;menuitem id=&quot;pilot-menu-notify-new&quot;</span>
<a href="#l34.41"></a><span id="l34.41" class="difflineminus">-                  label=&quot;&amp;testpilot.settings.newStudy.label;&quot; type=&quot;checkbox&quot;</span>
<a href="#l34.42"></a><span id="l34.42" class="difflineminus">-                  oncommand=&quot;</span>
<a href="#l34.43"></a><span id="l34.43" class="difflineminus">-                    TestPilotMenuUtils.togglePref('popup.showOnNewStudy');&quot;/&gt;</span>
<a href="#l34.44"></a><span id="l34.44" class="difflineminus">-        &lt;menuitem id=&quot;pilot-menu-notify-results&quot;</span>
<a href="#l34.45"></a><span id="l34.45" class="difflineminus">-                  label=&quot;&amp;testpilot.settings.hasNewResults.label;&quot;</span>
<a href="#l34.46"></a><span id="l34.46" class="difflineminus">-                  type=&quot;checkbox&quot;</span>
<a href="#l34.47"></a><span id="l34.47" class="difflineminus">-                  oncommand=&quot;</span>
<a href="#l34.48"></a><span id="l34.48" class="difflineminus">-                    TestPilotMenuUtils.togglePref('popup.showOnNewResults');&quot;/&gt;</span>
<a href="#l34.49"></a><span id="l34.49" class="difflineminus">-        &lt;menuseparator /&gt;</span>
<a href="#l34.50"></a><span id="l34.50" class="difflineminus">-        &lt;menuitem id=&quot;pilot-menu-always-submit-data&quot;</span>
<a href="#l34.51"></a><span id="l34.51" class="difflineminus">-                  label=&quot;&amp;testpilot.settings.alwaysSubmitData.shortLabel;&quot;</span>
<a href="#l34.52"></a><span id="l34.52" class="difflineminus">-                  type=&quot;checkbox&quot;</span>
<a href="#l34.53"></a><span id="l34.53" class="difflineminus">-                  oncommand=&quot;</span>
<a href="#l34.54"></a><span id="l34.54" class="difflineminus">-                    TestPilotMenuUtils.togglePref('alwaysSubmitData');&quot;/&gt;</span>
<a href="#l34.55"></a><span id="l34.55" class="difflineminus">-      &lt;/menupopup&gt;</span>
<a href="#l34.56"></a><span id="l34.56" class="difflineminus">-    &lt;/menu&gt;</span>
<a href="#l34.57"></a><span id="l34.57" class="difflineminus">-    &lt;menuitem label=&quot;&amp;testpilot.allYourStudies.label;&quot;</span>
<a href="#l34.58"></a><span id="l34.58" class="difflineminus">-              oncommand=&quot;TestPilotWindowUtils.openAllStudiesWindow();&quot;/&gt;</span>
<a href="#l34.59"></a><span id="l34.59" class="difflineminus">-    &lt;menuitem label=&quot;&amp;testpilot.about.label;&quot;</span>
<a href="#l34.60"></a><span id="l34.60" class="difflineminus">-              oncommand=&quot;TestPilotWindowUtils.openHomepage();&quot;/&gt;</span>
<a href="#l34.61"></a><span id="l34.61" class="difflineminus">-  &lt;/menupopup&gt;</span>
<a href="#l34.62"></a><span id="l34.62" class="difflineminus">-&lt;/menu&gt;</span>
<a href="#l34.63"></a><span id="l34.63" class="difflineminus">-</span>
<a href="#l34.64"></a><span id="l34.64" class="difflineminus">-&lt;!-- anchor for the fx4 style notifications --&gt;</span>
<a href="#l34.65"></a><span id="l34.65" class="difflineminus">-&lt;toolbar id=&quot;nav-bar&quot;&gt;</span>
<a href="#l34.66"></a><span id="l34.66" class="difflineminus">-  &lt;box id=&quot;tp-notification-popup-box&quot; hidden=&quot;true&quot; align=&quot;center&quot;&gt;</span>
<a href="#l34.67"></a><span id="l34.67" class="difflineminus">-    &lt;image id=&quot;tp-notification-popup-icon&quot; class=&quot;notification-anchor-icon&quot; role=&quot;button&quot;/&gt;</span>
<a href="#l34.68"></a><span id="l34.68" class="difflineminus">-  &lt;/box&gt;</span>
<a href="#l34.69"></a><span id="l34.69" class="difflineminus">-  &lt;panel id=&quot;testpilot-notification-popup&quot; type=&quot;arrow&quot; position=&quot;after_start&quot;</span>
<a href="#l34.70"></a><span id="l34.70" class="difflineminus">-         hidden=&quot;true&quot; orient=&quot;vertical&quot;&gt;</span>
<a href="#l34.71"></a><span id="l34.71" class="difflineminus">-  &lt;/panel&gt;</span>
<a href="#l34.72"></a><span id="l34.72" class="difflineminus">-&lt;/toolbar&gt;</span>
<a href="#l34.73"></a><span id="l34.73" class="difflineminus">-&lt;/overlay&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1">deleted file mode 100644</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/welcome-page.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineplus">+++ /dev/null</span>
<a href="#l35.4"></a><span id="l35.4" class="difflineat">@@ -1,78 +0,0 @@</span>
<a href="#l35.5"></a><span id="l35.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l35.6"></a><span id="l35.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l35.7"></a><span id="l35.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l35.8"></a><span id="l35.8" class="difflineminus">-</span>
<a href="#l35.9"></a><span id="l35.9" class="difflineminus">-var TestPilotWelcomePage = {</span>
<a href="#l35.10"></a><span id="l35.10" class="difflineminus">-  surveyId: &quot;basic_panel_survey_2&quot;,</span>
<a href="#l35.11"></a><span id="l35.11" class="difflineminus">-</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-  onLoad: function() {</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineminus">-    // Show link to pilot background survey only if user hasn't already</span>
<a href="#l35.14"></a><span id="l35.14" class="difflineminus">-    // taken it.</span>
<a href="#l35.15"></a><span id="l35.15" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l35.16"></a><span id="l35.16" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/tasks.js&quot;);</span>
<a href="#l35.17"></a><span id="l35.17" class="difflineminus">-    Components.utils.import(&quot;resource://testpilot/modules/interface.js&quot;);</span>
<a href="#l35.18"></a><span id="l35.18" class="difflineminus">-    this._setStrings();</span>
<a href="#l35.19"></a><span id="l35.19" class="difflineminus">-    let survey = TestPilotSetup.getTaskById(this.surveyId);</span>
<a href="#l35.20"></a><span id="l35.20" class="difflineminus">-    if (!survey) {</span>
<a href="#l35.21"></a><span id="l35.21" class="difflineminus">-      // Can happen if page loaded before all tasks loaded</span>
<a href="#l35.22"></a><span id="l35.22" class="difflineminus">-      window.setTimeout(function() { TestPilotWelcomePage.onLoad(); }, 2000);</span>
<a href="#l35.23"></a><span id="l35.23" class="difflineminus">-      return;</span>
<a href="#l35.24"></a><span id="l35.24" class="difflineminus">-    }</span>
<a href="#l35.25"></a><span id="l35.25" class="difflineminus">-    if (survey.status == TaskConstants.STATUS_NEW) {</span>
<a href="#l35.26"></a><span id="l35.26" class="difflineminus">-      document.getElementById(&quot;survey-link-p&quot;).setAttribute(&quot;style&quot;,</span>
<a href="#l35.27"></a><span id="l35.27" class="difflineminus">-                                                            &quot;display:block&quot;);</span>
<a href="#l35.28"></a><span id="l35.28" class="difflineminus">-    }</span>
<a href="#l35.29"></a><span id="l35.29" class="difflineminus">-  },</span>
<a href="#l35.30"></a><span id="l35.30" class="difflineminus">-</span>
<a href="#l35.31"></a><span id="l35.31" class="difflineminus">-  openPilotSurvey: function() {</span>
<a href="#l35.32"></a><span id="l35.32" class="difflineminus">-    let url =</span>
<a href="#l35.33"></a><span id="l35.33" class="difflineminus">-      &quot;chrome://testpilot/content/take-survey.html?eid=&quot; + this.surveyId;</span>
<a href="#l35.34"></a><span id="l35.34" class="difflineminus">-    TestPilotWindowUtils.openChromeless(url);</span>
<a href="#l35.35"></a><span id="l35.35" class="difflineminus">-  },</span>
<a href="#l35.36"></a><span id="l35.36" class="difflineminus">-</span>
<a href="#l35.37"></a><span id="l35.37" class="difflineminus">-  _setStrings: function() {</span>
<a href="#l35.38"></a><span id="l35.38" class="difflineminus">-    let stringBundle =</span>
<a href="#l35.39"></a><span id="l35.39" class="difflineminus">-      Components.classes[&quot;@mozilla.org/intl/stringbundle;1&quot;].</span>
<a href="#l35.40"></a><span id="l35.40" class="difflineminus">-        getService(Components.interfaces.nsIStringBundleService).</span>
<a href="#l35.41"></a><span id="l35.41" class="difflineminus">-	  createBundle(&quot;chrome://testpilot/locale/main.properties&quot;);</span>
<a href="#l35.42"></a><span id="l35.42" class="difflineminus">-    /* Use slightly different wording on this page depending on whether</span>
<a href="#l35.43"></a><span id="l35.43" class="difflineminus">-     * the user has the version with the doorhanger notifications (Firefox 4.0+)</span>
<a href="#l35.44"></a><span id="l35.44" class="difflineminus">-     * or not. */</span>
<a href="#l35.45"></a><span id="l35.45" class="difflineminus">-    let doorhangerUI = TestPilotUIBuilder.hasDoorhangerNotifications();</span>
<a href="#l35.46"></a><span id="l35.46" class="difflineminus">-    let map = [</span>
<a href="#l35.47"></a><span id="l35.47" class="difflineminus">-      { id: &quot;page-title&quot;, stringKey: &quot;testpilot.fullBrandName&quot; },</span>
<a href="#l35.48"></a><span id="l35.48" class="difflineminus">-      { id: &quot;thank-you-text&quot;,</span>
<a href="#l35.49"></a><span id="l35.49" class="difflineminus">-        stringKey: &quot;testpilot.welcomePage.thankYou&quot; },</span>
<a href="#l35.50"></a><span id="l35.50" class="difflineminus">-      { id: &quot;getting-started-text&quot;,</span>
<a href="#l35.51"></a><span id="l35.51" class="difflineminus">-        stringKey: &quot;testpilot.welcomePage.gettingStarted&quot; },</span>
<a href="#l35.52"></a><span id="l35.52" class="difflineminus">-      { id: &quot;please-take-text&quot;,</span>
<a href="#l35.53"></a><span id="l35.53" class="difflineminus">-        stringKey: &quot;testpilot.welcomePage.pleaseTake&quot; },</span>
<a href="#l35.54"></a><span id="l35.54" class="difflineminus">-      { id: &quot;background-survey-text&quot;,</span>
<a href="#l35.55"></a><span id="l35.55" class="difflineminus">-        stringKey: &quot;testpilot.welcomePage.backgroundSurvey&quot; },</span>
<a href="#l35.56"></a><span id="l35.56" class="difflineminus">-      { id: &quot;open-studies-window-link&quot;,</span>
<a href="#l35.57"></a><span id="l35.57" class="difflineminus">-        stringKey: &quot;testpilot.welcomePage.clickToOpenStudiesWindow&quot; },</span>
<a href="#l35.58"></a><span id="l35.58" class="difflineminus">-      { id: &quot;testpilot-addon-text&quot;,</span>
<a href="#l35.59"></a><span id="l35.59" class="difflineminus">-        stringKey: &quot;testpilot.welcomePage.testpilotAddon&quot; },</span>
<a href="#l35.60"></a><span id="l35.60" class="difflineminus">-      { id: &quot;icon-explanation-text&quot;,</span>
<a href="#l35.61"></a><span id="l35.61" class="difflineminus">-        stringKey: (doorhangerUI ? &quot;testpilot.welcomePage.iconExplanation2&quot;:</span>
<a href="#l35.62"></a><span id="l35.62" class="difflineminus">-                    &quot;testpilot.welcomePage.iconExplanation&quot;)},</span>
<a href="#l35.63"></a><span id="l35.63" class="difflineminus">-      { id: &quot;icon-explanation-more-text&quot;,</span>
<a href="#l35.64"></a><span id="l35.64" class="difflineminus">-        stringKey: (doorhangerUI ? &quot;testpilot.welcomePage.moreIconExplanation2&quot;:</span>
<a href="#l35.65"></a><span id="l35.65" class="difflineminus">-                    &quot;testpilot.welcomePage.moreIconExplanation&quot;)},</span>
<a href="#l35.66"></a><span id="l35.66" class="difflineminus">-      { id: &quot;notification-info-text&quot;,</span>
<a href="#l35.67"></a><span id="l35.67" class="difflineminus">-	stringKey: (doorhangerUI ? &quot;testpilot.welcomePage.notificationInfo2&quot;:</span>
<a href="#l35.68"></a><span id="l35.68" class="difflineminus">-                    &quot;testpilot.welcomePage.notificationInfo&quot;)},</span>
<a href="#l35.69"></a><span id="l35.69" class="difflineminus">-      { id: &quot;privacy-policy-link&quot;,</span>
<a href="#l35.70"></a><span id="l35.70" class="difflineminus">-	stringKey: &quot;testpilot.welcomePage.privacyPolicy&quot; },</span>
<a href="#l35.71"></a><span id="l35.71" class="difflineminus">-      { id: &quot;legal-notices-link&quot;,</span>
<a href="#l35.72"></a><span id="l35.72" class="difflineminus">-	stringKey: &quot;testpilot.welcomePage.legalNotices&quot; }</span>
<a href="#l35.73"></a><span id="l35.73" class="difflineminus">-      ];</span>
<a href="#l35.74"></a><span id="l35.74" class="difflineminus">-</span>
<a href="#l35.75"></a><span id="l35.75" class="difflineminus">-    let mapLength = map.length;</span>
<a href="#l35.76"></a><span id="l35.76" class="difflineminus">-    for (let i = 0; i &lt; mapLength; i++) {</span>
<a href="#l35.77"></a><span id="l35.77" class="difflineminus">-      let entry = map[i];</span>
<a href="#l35.78"></a><span id="l35.78" class="difflineminus">-      document.getElementById(entry.id).textContent =</span>
<a href="#l35.79"></a><span id="l35.79" class="difflineminus">-        stringBundle.GetStringFromName(entry.stringKey);</span>
<a href="#l35.80"></a><span id="l35.80" class="difflineminus">-    }</span>
<a href="#l35.81"></a><span id="l35.81" class="difflineminus">-  }</span>
<a href="#l35.82"></a><span id="l35.82" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1">deleted file mode 100644</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/welcome.html</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineplus">+++ /dev/null</span>
<a href="#l36.4"></a><span id="l36.4" class="difflineat">@@ -1,61 +0,0 @@</span>
<a href="#l36.5"></a><span id="l36.5" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l36.6"></a><span id="l36.6" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l36.7"></a><span id="l36.7" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l36.8"></a><span id="l36.8" class="difflineminus">-</span>
<a href="#l36.9"></a><span id="l36.9" class="difflineminus">-&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;</span>
<a href="#l36.10"></a><span id="l36.10" class="difflineminus">-&lt;html xml:lang=&quot;en&quot; xmlns=&quot;http://www.w3.org/1999/xhtml&quot; lang=&quot;en&quot;&gt;&lt;head&gt;</span>
<a href="#l36.11"></a><span id="l36.11" class="difflineminus">-  &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-  &lt;title id=&quot;page-title&quot;&gt;&lt;/title&gt;</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineminus">-  &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; media=&quot;all&quot; href=&quot;screen.css&quot; /&gt;</span>
<a href="#l36.14"></a><span id="l36.14" class="difflineminus">-  &lt;script src=&quot;window-utils.js&quot; type=&quot;application/javascript;version=1.8&quot;&gt;</span>
<a href="#l36.15"></a><span id="l36.15" class="difflineminus">-  &lt;/script&gt;</span>
<a href="#l36.16"></a><span id="l36.16" class="difflineminus">-  &lt;script src=&quot;welcome-page.js&quot; type=&quot;application/javascript;version=1.8&quot;&gt;</span>
<a href="#l36.17"></a><span id="l36.17" class="difflineminus">-  &lt;/script&gt;</span>
<a href="#l36.18"></a><span id="l36.18" class="difflineminus">-&lt;/head&gt;</span>
<a href="#l36.19"></a><span id="l36.19" class="difflineminus">-&lt;body onload=&quot;TestPilotWelcomePage.onLoad();&quot;&gt;</span>
<a href="#l36.20"></a><span id="l36.20" class="difflineminus">-  &lt;div id=&quot;container&quot;&gt;</span>
<a href="#l36.21"></a><span id="l36.21" class="difflineminus">-    &lt;div id=&quot;logo&quot;&gt;&lt;a href=&quot;http://labs.mozilla.com/&quot;&gt;</span>
<a href="#l36.22"></a><span id="l36.22" class="difflineminus">-      &lt;img src=&quot;chrome://testpilot/skin/logo.png&quot; border=&quot;0&quot;&gt;&lt;/a&gt;</span>
<a href="#l36.23"></a><span id="l36.23" class="difflineminus">-    &lt;/div&gt;</span>
<a href="#l36.24"></a><span id="l36.24" class="difflineminus">-    &lt;div id=&quot;contentWelcome&quot;&gt;</span>
<a href="#l36.25"></a><span id="l36.25" class="difflineminus">-      &lt;div id=&quot;thanks&quot;&gt;</span>
<a href="#l36.26"></a><span id="l36.26" class="difflineminus">-        &lt;h1 id=&quot;thank-you-text&quot;&gt;&lt;/h1&gt;</span>
<a href="#l36.27"></a><span id="l36.27" class="difflineminus">-      &lt;/div&gt;</span>
<a href="#l36.28"></a><span id="l36.28" class="difflineminus">-      &lt;div id=&quot;get-started&quot;&gt;</span>
<a href="#l36.29"></a><span id="l36.29" class="difflineminus">-        &lt;div class=&quot;button&quot;&gt;</span>
<a href="#l36.30"></a><span id="l36.30" class="difflineminus">-          &lt;h2 id=&quot;getting-started-text&quot;&gt;&lt;/h2&gt;</span>
<a href="#l36.31"></a><span id="l36.31" class="difflineminus">-          &lt;p class=&quot;embiggened&quot; id=&quot;survey-link-p&quot; style=&quot;display:none&quot;&gt;</span>
<a href="#l36.32"></a><span id="l36.32" class="difflineminus">-            &lt;span id=&quot;please-take-text&quot;&gt;&lt;/span&gt;&amp;nbsp;</span>
<a href="#l36.33"></a><span id="l36.33" class="difflineminus">-            &lt;a class=&quot;function-link&quot; id=&quot;background-survey-text&quot;</span>
<a href="#l36.34"></a><span id="l36.34" class="difflineminus">-              onclick=&quot;TestPilotWelcomePage.openPilotSurvey();&quot;&gt;&lt;/a&gt;!&lt;/p&gt;</span>
<a href="#l36.35"></a><span id="l36.35" class="difflineminus">-           &lt;p class=&quot;embiggened&quot;&gt;</span>
<a href="#l36.36"></a><span id="l36.36" class="difflineminus">-            &lt;a class=&quot;function-link&quot; id=&quot;privacy-policy-link&quot;</span>
<a href="#l36.37"></a><span id="l36.37" class="difflineminus">-               style=&quot;text-decoration: underline&quot;</span>
<a href="#l36.38"></a><span id="l36.38" class="difflineminus">-               href=&quot;http://www.mozilla.com/en-US/privacy-policy.html&quot;&gt;&lt;/a&gt;</span>
<a href="#l36.39"></a><span id="l36.39" class="difflineminus">-          &lt;/p&gt;</span>
<a href="#l36.40"></a><span id="l36.40" class="difflineminus">-          &lt;p class=&quot;embiggened&quot;&gt;</span>
<a href="#l36.41"></a><span id="l36.41" class="difflineminus">-            &lt;a class=&quot;function-link&quot; id=&quot;open-studies-window-link&quot;</span>
<a href="#l36.42"></a><span id="l36.42" class="difflineminus">-              onclick=&quot;TestPilotWindowUtils.openAllStudiesWindow();&quot;&gt;&lt;/a&gt;</span>
<a href="#l36.43"></a><span id="l36.43" class="difflineminus">-          &lt;/p&gt;</span>
<a href="#l36.44"></a><span id="l36.44" class="difflineminus">-          &lt;p&gt;&lt;/p&gt;</span>
<a href="#l36.45"></a><span id="l36.45" class="difflineminus">-        &lt;/div&gt;</span>
<a href="#l36.46"></a><span id="l36.46" class="difflineminus">-      &lt;/div&gt;</span>
<a href="#l36.47"></a><span id="l36.47" class="difflineminus">-      &lt;div id=&quot;icon-explanation&quot;&gt;</span>
<a href="#l36.48"></a><span id="l36.48" class="difflineminus">-        &lt;div class=&quot;button&quot;&gt;</span>
<a href="#l36.49"></a><span id="l36.49" class="difflineminus">-          &lt;p&gt;&lt;h2 id=&quot;testpilot-addon-text&quot;&gt;&lt;/h2&gt;&lt;/p&gt;</span>
<a href="#l36.50"></a><span id="l36.50" class="difflineminus">-          &lt;p class=&quot;embiggened&quot;&gt;</span>
<a href="#l36.51"></a><span id="l36.51" class="difflineminus">-            &lt;img src=&quot;chrome://testpilot/skin/testpilot_16x16.png&quot;&gt;</span>
<a href="#l36.52"></a><span id="l36.52" class="difflineminus">-            &lt;strong id=&quot;icon-explanation-text&quot;&gt;&lt;/strong&gt;</span>
<a href="#l36.53"></a><span id="l36.53" class="difflineminus">-            &lt;span id=&quot;icon-explanation-more-text&quot;&gt;&lt;/span&gt;</span>
<a href="#l36.54"></a><span id="l36.54" class="difflineminus">-          &lt;/p&gt;</span>
<a href="#l36.55"></a><span id="l36.55" class="difflineminus">-          &lt;p class=&quot;embiggened&quot; id=&quot;notification-info-text&quot;&gt;&lt;/p&gt;</span>
<a href="#l36.56"></a><span id="l36.56" class="difflineminus">-        &lt;/div&gt;</span>
<a href="#l36.57"></a><span id="l36.57" class="difflineminus">-      &lt;/div&gt;</span>
<a href="#l36.58"></a><span id="l36.58" class="difflineminus">-    &lt;/div&gt;</span>
<a href="#l36.59"></a><span id="l36.59" class="difflineminus">-    &lt;div id=&quot;footer&quot;&gt;</span>
<a href="#l36.60"></a><span id="l36.60" class="difflineminus">-      &lt;img class=&quot;mozLogo&quot; src=&quot;chrome://testpilot/skin/mozilla-logo.png&quot;&gt;</span>
<a href="#l36.61"></a><span id="l36.61" class="difflineminus">-        &lt;a href=&quot;http://www.mozilla.com/en-US/about/legal.html&quot;</span>
<a href="#l36.62"></a><span id="l36.62" class="difflineminus">-          id=&quot;legal-notices-link&quot;&gt;&lt;/a&gt;</span>
<a href="#l36.63"></a><span id="l36.63" class="difflineminus">-    &lt;/div&gt;</span>
<a href="#l36.64"></a><span id="l36.64" class="difflineminus">-  &lt;/div&gt;</span>
<a href="#l36.65"></a><span id="l36.65" class="difflineminus">-&lt;/body&gt;&lt;/html&gt;</span>
<a href="#l36.66"></a><span id="l36.66">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1">deleted file mode 100644</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/content/window-utils.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineplus">+++ /dev/null</span>
<a href="#l37.4"></a><span id="l37.4" class="difflineat">@@ -1,139 +0,0 @@</span>
<a href="#l37.5"></a><span id="l37.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l37.6"></a><span id="l37.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l37.7"></a><span id="l37.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l37.8"></a><span id="l37.8" class="difflineminus">-</span>
<a href="#l37.9"></a><span id="l37.9" class="difflineminus">-var TestPilotWindowUtils;</span>
<a href="#l37.10"></a><span id="l37.10" class="difflineminus">-</span>
<a href="#l37.11"></a><span id="l37.11" class="difflineminus">-(function() {</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-  const ALL_STUDIES_WINDOW_NAME = &quot;TestPilotAllStudiesWindow&quot;;</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineminus">-  const ALL_STUDIES_WINDOW_TYPE = &quot;extensions:testpilot:all_studies_window&quot;;</span>
<a href="#l37.14"></a><span id="l37.14" class="difflineminus">-  const FENNEC_APP_ID = &quot;{a23983c0-fd0e-11dc-95ff-0800200c9a66}&quot;;</span>
<a href="#l37.15"></a><span id="l37.15" class="difflineminus">-  const THUNDERBIRD_APP_ID = &quot;{3550f703-e582-4d05-9a08-453d09bdfdc6}&quot;;</span>
<a href="#l37.16"></a><span id="l37.16" class="difflineminus">-</span>
<a href="#l37.17"></a><span id="l37.17" class="difflineminus">-  TestPilotWindowUtils = {</span>
<a href="#l37.18"></a><span id="l37.18" class="difflineminus">-    openAllStudiesWindow: function() {</span>
<a href="#l37.19"></a><span id="l37.19" class="difflineminus">-      // If the window is not already open, open it; but if it is open,</span>
<a href="#l37.20"></a><span id="l37.20" class="difflineminus">-      // focus it instead.</span>
<a href="#l37.21"></a><span id="l37.21" class="difflineminus">-      let wm = Components.classes[&quot;@mozilla.org/appshell/window-mediator;1&quot;].</span>
<a href="#l37.22"></a><span id="l37.22" class="difflineminus">-                 getService(Components.interfaces.nsIWindowMediator);</span>
<a href="#l37.23"></a><span id="l37.23" class="difflineminus">-      let allStudiesWindow = wm.getMostRecentWindow(ALL_STUDIES_WINDOW_TYPE);</span>
<a href="#l37.24"></a><span id="l37.24" class="difflineminus">-</span>
<a href="#l37.25"></a><span id="l37.25" class="difflineminus">-      if (allStudiesWindow) {</span>
<a href="#l37.26"></a><span id="l37.26" class="difflineminus">-        allStudiesWindow.focus();</span>
<a href="#l37.27"></a><span id="l37.27" class="difflineminus">-      } else {</span>
<a href="#l37.28"></a><span id="l37.28" class="difflineminus">-        allStudiesWindow = window.openDialog(</span>
<a href="#l37.29"></a><span id="l37.29" class="difflineminus">-          &quot;chrome://testpilot/content/all-studies-window.xul&quot;,</span>
<a href="#l37.30"></a><span id="l37.30" class="difflineminus">-          ALL_STUDIES_WINDOW_NAME,</span>
<a href="#l37.31"></a><span id="l37.31" class="difflineminus">-          &quot;chrome,titlebar,centerscreen,dialog=no&quot;);</span>
<a href="#l37.32"></a><span id="l37.32" class="difflineminus">-      }</span>
<a href="#l37.33"></a><span id="l37.33" class="difflineminus">-    },</span>
<a href="#l37.34"></a><span id="l37.34" class="difflineminus">-</span>
<a href="#l37.35"></a><span id="l37.35" class="difflineminus">-    openAllStudies: function() {</span>
<a href="#l37.36"></a><span id="l37.36" class="difflineminus">-      Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l37.37"></a><span id="l37.37" class="difflineminus">-      if (TestPilotSetup._appID == FENNEC_APP_ID) { // Fennec only</span>
<a href="#l37.38"></a><span id="l37.38" class="difflineminus">-        // BrowserUI.newTab will focus on the content area of the new tab</span>
<a href="#l37.39"></a><span id="l37.39" class="difflineminus">-        BrowserUI.newTab(&quot;chrome://testpilot/content/all-studies.html&quot;, Browser.selectedTab);</span>
<a href="#l37.40"></a><span id="l37.40" class="difflineminus">-      }</span>
<a href="#l37.41"></a><span id="l37.41" class="difflineminus">-    },</span>
<a href="#l37.42"></a><span id="l37.42" class="difflineminus">-</span>
<a href="#l37.43"></a><span id="l37.43" class="difflineminus">-    openInTab: function(url) {</span>
<a href="#l37.44"></a><span id="l37.44" class="difflineminus">-      Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l37.45"></a><span id="l37.45" class="difflineminus">-      if (TestPilotSetup._appID == FENNEC_APP_ID) {</span>
<a href="#l37.46"></a><span id="l37.46" class="difflineminus">-        // see if url already open in a tab:</span>
<a href="#l37.47"></a><span id="l37.47" class="difflineminus">-        let browserList = Browser.browsers;</span>
<a href="#l37.48"></a><span id="l37.48" class="difflineminus">-        for (let i = 0; i &lt; browserList.length; i++) {</span>
<a href="#l37.49"></a><span id="l37.49" class="difflineminus">-          if (url == browserList[i].currentURI.spec) {</span>
<a href="#l37.50"></a><span id="l37.50" class="difflineminus">-            Browser.selectedTab = browserList[i];</span>
<a href="#l37.51"></a><span id="l37.51" class="difflineminus">-            return;</span>
<a href="#l37.52"></a><span id="l37.52" class="difflineminus">-          }</span>
<a href="#l37.53"></a><span id="l37.53" class="difflineminus">-        }</span>
<a href="#l37.54"></a><span id="l37.54" class="difflineminus">-</span>
<a href="#l37.55"></a><span id="l37.55" class="difflineminus">-        // if not, open it:</span>
<a href="#l37.56"></a><span id="l37.56" class="difflineminus">-        Browser.addTab(url, true); // true means bring it to front</span>
<a href="#l37.57"></a><span id="l37.57" class="difflineminus">-      }</span>
<a href="#l37.58"></a><span id="l37.58" class="difflineminus">-      else if (TestPilotSetup._appID == THUNDERBIRD_APP_ID) {</span>
<a href="#l37.59"></a><span id="l37.59" class="difflineminus">-        openContentTab(url);</span>
<a href="#l37.60"></a><span id="l37.60" class="difflineminus">-      }</span>
<a href="#l37.61"></a><span id="l37.61" class="difflineminus">-      else {</span>
<a href="#l37.62"></a><span id="l37.62" class="difflineminus">-        // Desktop implementation:</span>
<a href="#l37.63"></a><span id="l37.63" class="difflineminus">-        let wm = Components.classes[&quot;@mozilla.org/appshell/window-mediator;1&quot;]</span>
<a href="#l37.64"></a><span id="l37.64" class="difflineminus">-                   .getService(Components.interfaces.nsIWindowMediator);</span>
<a href="#l37.65"></a><span id="l37.65" class="difflineminus">-        let enumerator = wm.getEnumerator(&quot;navigator:browser&quot;);</span>
<a href="#l37.66"></a><span id="l37.66" class="difflineminus">-</span>
<a href="#l37.67"></a><span id="l37.67" class="difflineminus">-        while(enumerator.hasMoreElements()) {</span>
<a href="#l37.68"></a><span id="l37.68" class="difflineminus">-          let win = enumerator.getNext();</span>
<a href="#l37.69"></a><span id="l37.69" class="difflineminus">-          let tabbrowser = win.getBrowser();</span>
<a href="#l37.70"></a><span id="l37.70" class="difflineminus">-</span>
<a href="#l37.71"></a><span id="l37.71" class="difflineminus">-          // Check each tab of this browser instance</span>
<a href="#l37.72"></a><span id="l37.72" class="difflineminus">-          let numTabs = tabbrowser.browsers.length;</span>
<a href="#l37.73"></a><span id="l37.73" class="difflineminus">-          for (let i = 0; i &lt; numTabs; i++) {</span>
<a href="#l37.74"></a><span id="l37.74" class="difflineminus">-            let currentBrowser = tabbrowser.getBrowserAtIndex(i);</span>
<a href="#l37.75"></a><span id="l37.75" class="difflineminus">-            if (url == currentBrowser.currentURI.spec) {</span>
<a href="#l37.76"></a><span id="l37.76" class="difflineminus">-              tabbrowser.selectedTab = tabbrowser.tabContainer.childNodes[i];</span>
<a href="#l37.77"></a><span id="l37.77" class="difflineminus">-              win.focus();</span>
<a href="#l37.78"></a><span id="l37.78" class="difflineminus">-              return;</span>
<a href="#l37.79"></a><span id="l37.79" class="difflineminus">-            }</span>
<a href="#l37.80"></a><span id="l37.80" class="difflineminus">-          }</span>
<a href="#l37.81"></a><span id="l37.81" class="difflineminus">-        }</span>
<a href="#l37.82"></a><span id="l37.82" class="difflineminus">-</span>
<a href="#l37.83"></a><span id="l37.83" class="difflineminus">-        let win = wm.getMostRecentWindow(&quot;navigator:browser&quot;);</span>
<a href="#l37.84"></a><span id="l37.84" class="difflineminus">-        if (win) {</span>
<a href="#l37.85"></a><span id="l37.85" class="difflineminus">-          let browser = win.getBrowser();</span>
<a href="#l37.86"></a><span id="l37.86" class="difflineminus">-          let tab = browser.addTab(url);</span>
<a href="#l37.87"></a><span id="l37.87" class="difflineminus">-          browser.selectedTab = tab;</span>
<a href="#l37.88"></a><span id="l37.88" class="difflineminus">-          win.focus();</span>
<a href="#l37.89"></a><span id="l37.89" class="difflineminus">-        } else {</span>
<a href="#l37.90"></a><span id="l37.90" class="difflineminus">-          window.open(url);</span>
<a href="#l37.91"></a><span id="l37.91" class="difflineminus">-        }</span>
<a href="#l37.92"></a><span id="l37.92" class="difflineminus">-      }</span>
<a href="#l37.93"></a><span id="l37.93" class="difflineminus">-    },</span>
<a href="#l37.94"></a><span id="l37.94" class="difflineminus">-</span>
<a href="#l37.95"></a><span id="l37.95" class="difflineminus">-    getCurrentTabUrl: function() {</span>
<a href="#l37.96"></a><span id="l37.96" class="difflineminus">-      Components.utils.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l37.97"></a><span id="l37.97" class="difflineminus">-      if (TestPilotSetup._appID == THUNDERBIRD_APP_ID) {</span>
<a href="#l37.98"></a><span id="l37.98" class="difflineminus">-        return null; // TODO: not sure what to do here</span>
<a href="#l37.99"></a><span id="l37.99" class="difflineminus">-      }</span>
<a href="#l37.100"></a><span id="l37.100" class="difflineminus">-      else {</span>
<a href="#l37.101"></a><span id="l37.101" class="difflineminus">-        let wm = Components.classes[&quot;@mozilla.org/appshell/window-mediator;1&quot;]</span>
<a href="#l37.102"></a><span id="l37.102" class="difflineminus">-                   .getService(Components.interfaces.nsIWindowMediator);</span>
<a href="#l37.103"></a><span id="l37.103" class="difflineminus">-        let win = wm.getMostRecentWindow(&quot;navigator:browser&quot;);</span>
<a href="#l37.104"></a><span id="l37.104" class="difflineminus">-        let tabbrowser = win.getBrowser();</span>
<a href="#l37.105"></a><span id="l37.105" class="difflineminus">-        let currentBrowser = tabbrowser.selectedBrowser;</span>
<a href="#l37.106"></a><span id="l37.106" class="difflineminus">-        return currentBrowser.currentURI.spec;</span>
<a href="#l37.107"></a><span id="l37.107" class="difflineminus">-      }</span>
<a href="#l37.108"></a><span id="l37.108" class="difflineminus">-    },</span>
<a href="#l37.109"></a><span id="l37.109" class="difflineminus">-</span>
<a href="#l37.110"></a><span id="l37.110" class="difflineminus">-    openHomepage: function() {</span>
<a href="#l37.111"></a><span id="l37.111" class="difflineminus">-      let prefs = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l37.112"></a><span id="l37.112" class="difflineminus">-        .getService(Components.interfaces.nsIPrefBranch);</span>
<a href="#l37.113"></a><span id="l37.113" class="difflineminus">-      let url = prefs.getCharPref(&quot;extensions.testpilot.homepageURL&quot;);</span>
<a href="#l37.114"></a><span id="l37.114" class="difflineminus">-      this.openInTab(url);</span>
<a href="#l37.115"></a><span id="l37.115" class="difflineminus">-    },</span>
<a href="#l37.116"></a><span id="l37.116" class="difflineminus">-</span>
<a href="#l37.117"></a><span id="l37.117" class="difflineminus">-    openFeedbackPage: function(menuItemChosen) {</span>
<a href="#l37.118"></a><span id="l37.118" class="difflineminus">-      Components.utils.import(&quot;resource://testpilot/modules/feedback.js&quot;);</span>
<a href="#l37.119"></a><span id="l37.119" class="difflineminus">-      FeedbackManager.setCurrUrl(this.getCurrentTabUrl());</span>
<a href="#l37.120"></a><span id="l37.120" class="difflineminus">-      this.openInTab(FeedbackManager.getFeedbackUrl(menuItemChosen));</span>
<a href="#l37.121"></a><span id="l37.121" class="difflineminus">-    },</span>
<a href="#l37.122"></a><span id="l37.122" class="difflineminus">-</span>
<a href="#l37.123"></a><span id="l37.123" class="difflineminus">-    openChromeless: function(url) {</span>
<a href="#l37.124"></a><span id="l37.124" class="difflineminus">-      /* Make the window smaller and dialog-boxier</span>
<a href="#l37.125"></a><span id="l37.125" class="difflineminus">-       * Links to discussion group, twitter, etc should open in new</span>
<a href="#l37.126"></a><span id="l37.126" class="difflineminus">-       * tab in main browser window, if we have these links here at all!!</span>
<a href="#l37.127"></a><span id="l37.127" class="difflineminus">-       * Maybe just one link to the main Test Pilot website. */</span>
<a href="#l37.128"></a><span id="l37.128" class="difflineminus">-</span>
<a href="#l37.129"></a><span id="l37.129" class="difflineminus">-      // TODO this window opening triggers studies' window-open code.</span>
<a href="#l37.130"></a><span id="l37.130" class="difflineminus">-      // Is that what we want or not?</span>
<a href="#l37.131"></a><span id="l37.131" class="difflineminus">-</span>
<a href="#l37.132"></a><span id="l37.132" class="difflineminus">-      let screenWidth = window.screen.availWidth;</span>
<a href="#l37.133"></a><span id="l37.133" class="difflineminus">-      let screenHeight = window.screen.availHeight;</span>
<a href="#l37.134"></a><span id="l37.134" class="difflineminus">-      let width = screenWidth &gt;= 1200 ? 1000 : screenWidth - 200;</span>
<a href="#l37.135"></a><span id="l37.135" class="difflineminus">-      let height = screenHeight &gt;= 1000 ? 800 : screenHeight - 200;</span>
<a href="#l37.136"></a><span id="l37.136" class="difflineminus">-</span>
<a href="#l37.137"></a><span id="l37.137" class="difflineminus">-      let win = window.open(url, &quot;TestPilotStudyDetailWindow&quot;,</span>
<a href="#l37.138"></a><span id="l37.138" class="difflineminus">-                           &quot;chrome,centerscreen,resizable=yes,scrollbars=yes,&quot; +</span>
<a href="#l37.139"></a><span id="l37.139" class="difflineminus">-                           &quot;status=no,width=&quot; + width + &quot;,height=&quot; + height);</span>
<a href="#l37.140"></a><span id="l37.140" class="difflineminus">-      win.focus();</span>
<a href="#l37.141"></a><span id="l37.141" class="difflineminus">-    }</span>
<a href="#l37.142"></a><span id="l37.142" class="difflineminus">-  };</span>
<a href="#l37.143"></a><span id="l37.143" class="difflineminus">-}());</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1">deleted file mode 100755</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/defaults/preferences/preferences.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineplus">+++ /dev/null</span>
<a href="#l38.4"></a><span id="l38.4" class="difflineat">@@ -1,29 +0,0 @@</span>
<a href="#l38.5"></a><span id="l38.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l38.6"></a><span id="l38.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l38.7"></a><span id="l38.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l38.8"></a><span id="l38.8" class="difflineminus">-</span>
<a href="#l38.9"></a><span id="l38.9" class="difflineminus">-pref(&quot;extensions.testpilot.indexFileName&quot;, &quot;index-tb.json&quot;);</span>
<a href="#l38.10"></a><span id="l38.10" class="difflineminus">-</span>
<a href="#l38.11"></a><span id="l38.11" class="difflineminus">-pref(&quot;extensions.tbtestpilot@labs.mozilla.com.description&quot;, &quot;chrome://testpilot/locale/main.properties&quot;);</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineminus">-pref(&quot;extensions.testpilot.popup.delayAfterStartup&quot;, 180000); // 3 minutes</span>
<a href="#l38.14"></a><span id="l38.14" class="difflineminus">-pref(&quot;extensions.testpilot.popup.timeBetweenChecks&quot;, 86400000); // 24 hours</span>
<a href="#l38.15"></a><span id="l38.15" class="difflineminus">-pref(&quot;extensions.testpilot.uploadRetryInterval&quot;, 3600000); // 1 hour</span>
<a href="#l38.16"></a><span id="l38.16" class="difflineminus">-</span>
<a href="#l38.17"></a><span id="l38.17" class="difflineminus">-pref(&quot;extensions.testpilot.popup.showOnNewStudy&quot;, false);</span>
<a href="#l38.18"></a><span id="l38.18" class="difflineminus">-pref(&quot;extensions.testpilot.popup.showOnStudyFinished&quot;, true);</span>
<a href="#l38.19"></a><span id="l38.19" class="difflineminus">-pref(&quot;extensions.testpilot.popup.showOnNewResults&quot;, false);</span>
<a href="#l38.20"></a><span id="l38.20" class="difflineminus">-pref(&quot;extensions.testpilot.alwaysSubmitData&quot;, false);</span>
<a href="#l38.21"></a><span id="l38.21" class="difflineminus">-pref(&quot;extensions.testpilot.runStudies&quot;, true);</span>
<a href="#l38.22"></a><span id="l38.22" class="difflineminus">-pref(&quot;extensions.testpilot.alreadyCustomizedToolbar&quot;, false);</span>
<a href="#l38.23"></a><span id="l38.23" class="difflineminus">-</span>
<a href="#l38.24"></a><span id="l38.24" class="difflineminus">-pref(&quot;extensions.testpilot.indexBaseURL&quot;, &quot;https://testpilot.mozillalabs.com/testcases/&quot;);</span>
<a href="#l38.25"></a><span id="l38.25" class="difflineminus">-pref(&quot;extensions.testpilot.firstRunUrl&quot;, &quot;chrome://testpilot/content/welcome.html&quot;);</span>
<a href="#l38.26"></a><span id="l38.26" class="difflineminus">-pref(&quot;extensions.testpilot.dataUploadURL&quot;, &quot;https://testpilot.mozillalabs.com/submit/&quot;);</span>
<a href="#l38.27"></a><span id="l38.27" class="difflineminus">-pref(&quot;extensions.testpilot.homepageURL&quot;, &quot;https://testpilot.mozillalabs.com/&quot;);</span>
<a href="#l38.28"></a><span id="l38.28" class="difflineminus">-</span>
<a href="#l38.29"></a><span id="l38.29" class="difflineminus">-</span>
<a href="#l38.30"></a><span id="l38.30" class="difflineminus">-pref(&quot;extensions.input.happyURL&quot;, &quot;http://input.mozilla.com/happy&quot;);</span>
<a href="#l38.31"></a><span id="l38.31" class="difflineminus">-pref(&quot;extensions.input.sadURL&quot;, &quot;http://input.mozilla.com/sad&quot;);</span>
<a href="#l38.32"></a><span id="l38.32" class="difflineminus">-pref(&quot;extensions.input.brokenURL&quot;, &quot;http://input.mozilla.com/feedback#broken&quot;);</span>
<a href="#l38.33"></a><span id="l38.33" class="difflineminus">-pref(&quot;extensions.input.ideaURL&quot;, &quot;http://input.mozilla.com/feedback#idea&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1">deleted file mode 100644</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/install.rdf.in</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineplus">+++ /dev/null</span>
<a href="#l39.4"></a><span id="l39.4" class="difflineat">@@ -1,33 +0,0 @@</span>
<a href="#l39.5"></a><span id="l39.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l39.6"></a><span id="l39.6" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l39.7"></a><span id="l39.7" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l39.8"></a><span id="l39.8" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l39.9"></a><span id="l39.9" class="difflineminus">-</span>
<a href="#l39.10"></a><span id="l39.10" class="difflineminus">-</span>
<a href="#l39.11"></a><span id="l39.11" class="difflineminus">-#filter substitution</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineminus">-&lt;RDF xmlns=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span>
<a href="#l39.14"></a><span id="l39.14" class="difflineminus">-     xmlns:em=&quot;http://www.mozilla.org/2004/em-rdf#&quot;&gt;</span>
<a href="#l39.15"></a><span id="l39.15" class="difflineminus">-  &lt;Description about=&quot;urn:mozilla:install-manifest&quot;&gt;</span>
<a href="#l39.16"></a><span id="l39.16" class="difflineminus">-    &lt;em:id&gt;tbtestpilot@labs.mozilla.com&lt;/em:id&gt;</span>
<a href="#l39.17"></a><span id="l39.17" class="difflineminus">-    &lt;em:version&gt;1.3.9&lt;/em:version&gt;</span>
<a href="#l39.18"></a><span id="l39.18" class="difflineminus">-    &lt;em:type&gt;2&lt;/em:type&gt;</span>
<a href="#l39.19"></a><span id="l39.19" class="difflineminus">-</span>
<a href="#l39.20"></a><span id="l39.20" class="difflineminus">-    &lt;!-- Target Application this extension can install into, </span>
<a href="#l39.21"></a><span id="l39.21" class="difflineminus">-         with minimum and maximum supported versions. --&gt; </span>
<a href="#l39.22"></a><span id="l39.22" class="difflineminus">-    &lt;em:targetApplication&gt;</span>
<a href="#l39.23"></a><span id="l39.23" class="difflineminus">-      &lt;Description&gt;</span>
<a href="#l39.24"></a><span id="l39.24" class="difflineminus">-        &lt;em:id&gt;{3550f703-e582-4d05-9a08-453d09bdfdc6}&lt;/em:id&gt; &lt;!-- Thunderbird --&gt;</span>
<a href="#l39.25"></a><span id="l39.25" class="difflineminus">-        &lt;em:minVersion&gt;@MOZ_APP_VERSION@&lt;/em:minVersion&gt;</span>
<a href="#l39.26"></a><span id="l39.26" class="difflineminus">-        &lt;em:maxVersion&gt;@MOZ_APP_MAXVERSION@&lt;/em:maxVersion&gt;</span>
<a href="#l39.27"></a><span id="l39.27" class="difflineminus">-      &lt;/Description&gt;</span>
<a href="#l39.28"></a><span id="l39.28" class="difflineminus">-    &lt;/em:targetApplication&gt;</span>
<a href="#l39.29"></a><span id="l39.29" class="difflineminus">-   </span>
<a href="#l39.30"></a><span id="l39.30" class="difflineminus">-    &lt;!-- Front End MetaData --&gt;</span>
<a href="#l39.31"></a><span id="l39.31" class="difflineminus">-    &lt;em:name&gt;Test Pilot for Thunderbird&lt;/em:name&gt;</span>
<a href="#l39.32"></a><span id="l39.32" class="difflineminus">-    &lt;em:description&gt;Help make Thunderbird better by running user studies.&lt;/em:description&gt;</span>
<a href="#l39.33"></a><span id="l39.33" class="difflineminus">-    &lt;em:creator&gt;Mozilla Corporation&lt;/em:creator&gt;</span>
<a href="#l39.34"></a><span id="l39.34" class="difflineminus">-    &lt;em:homepageURL&gt;http://testpilot.mozillalabs.com/&lt;/em:homepageURL&gt;</span>
<a href="#l39.35"></a><span id="l39.35" class="difflineminus">-    &lt;em:iconURL&gt;chrome://testpilot/skin/testpilot_32x32.png&lt;/em:iconURL&gt;</span>
<a href="#l39.36"></a><span id="l39.36" class="difflineminus">-  &lt;/Description&gt;</span>
<a href="#l39.37"></a><span id="l39.37" class="difflineminus">-&lt;/RDF&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1">deleted file mode 100644</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/instrument/chrome.manifest</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineplus">+++ /dev/null</span>
<a href="#l40.4"></a><span id="l40.4" class="difflineat">@@ -1,3 +0,0 @@</span>
<a href="#l40.5"></a><span id="l40.5" class="difflineminus">-resource instrument .</span>
<a href="#l40.6"></a><span id="l40.6" class="difflineminus">-content instrument .</span>
<a href="#l40.7"></a><span id="l40.7" class="difflineminus">-overlay chrome://browser/content chrome://instrument/content</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1">deleted file mode 100644</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/instrument/install.rdf</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineplus">+++ /dev/null</span>
<a href="#l41.4"></a><span id="l41.4" class="difflineat">@@ -1,23 +0,0 @@</span>
<a href="#l41.5"></a><span id="l41.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l41.6"></a><span id="l41.6" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l41.7"></a><span id="l41.7" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l41.8"></a><span id="l41.8" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l41.9"></a><span id="l41.9" class="difflineminus">-</span>
<a href="#l41.10"></a><span id="l41.10" class="difflineminus">-&lt;RDF xmlns=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span>
<a href="#l41.11"></a><span id="l41.11" class="difflineminus">-     xmlns:em=&quot;http://www.mozilla.org/2004/em-rdf#&quot;&gt;</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-  &lt;Description about=&quot;urn:mozilla:install-manifest&quot;&gt;</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineminus">-    &lt;em:name&gt;Instrument Test&lt;/em:name&gt;</span>
<a href="#l41.14"></a><span id="l41.14" class="difflineminus">-    &lt;em:id&gt;instrument.test@agadak.net&lt;/em:id&gt;</span>
<a href="#l41.15"></a><span id="l41.15" class="difflineminus">-    &lt;em:version&gt;1&lt;/em:version&gt;</span>
<a href="#l41.16"></a><span id="l41.16" class="difflineminus">-    &lt;em:creator&gt;Edward Lee (Mardak)&lt;/em:creator&gt;</span>
<a href="#l41.17"></a><span id="l41.17" class="difflineminus">-    &lt;em:description&gt;Instrument various browser stuff&lt;/em:description&gt;</span>
<a href="#l41.18"></a><span id="l41.18" class="difflineminus">-    &lt;em:homepageURL&gt;http://ed.agadak.net/&lt;/em:homepageURL&gt;</span>
<a href="#l41.19"></a><span id="l41.19" class="difflineminus">-    &lt;em:targetApplication&gt;</span>
<a href="#l41.20"></a><span id="l41.20" class="difflineminus">-      &lt;Description&gt;</span>
<a href="#l41.21"></a><span id="l41.21" class="difflineminus">-        &lt;em:id&gt;{ec8030f7-c20a-464f-9b0e-13a3a9e97384}&lt;/em:id&gt;</span>
<a href="#l41.22"></a><span id="l41.22" class="difflineminus">-        &lt;em:minVersion&gt;3.0&lt;/em:minVersion&gt;</span>
<a href="#l41.23"></a><span id="l41.23" class="difflineminus">-        &lt;em:maxVersion&gt;3.6a1pre&lt;/em:maxVersion&gt;</span>
<a href="#l41.24"></a><span id="l41.24" class="difflineminus">-      &lt;/Description&gt;</span>
<a href="#l41.25"></a><span id="l41.25" class="difflineminus">-    &lt;/em:targetApplication&gt; </span>
<a href="#l41.26"></a><span id="l41.26" class="difflineminus">-  &lt;/Description&gt;</span>
<a href="#l41.27"></a><span id="l41.27" class="difflineminus">-&lt;/RDF&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1">deleted file mode 100644</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/instrument/instrument.jsm</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineplus">+++ /dev/null</span>
<a href="#l42.4"></a><span id="l42.4" class="difflineat">@@ -1,48 +0,0 @@</span>
<a href="#l42.5"></a><span id="l42.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l42.6"></a><span id="l42.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l42.7"></a><span id="l42.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l42.8"></a><span id="l42.8" class="difflineminus">-</span>
<a href="#l42.9"></a><span id="l42.9" class="difflineminus">-let EXPORTED_SYMBOLS = [&quot;Instrument&quot;];</span>
<a href="#l42.10"></a><span id="l42.10" class="difflineminus">-</span>
<a href="#l42.11"></a><span id="l42.11" class="difflineminus">-let data = {};</span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-/**</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineminus">- * Track how many times an object's member function is called</span>
<a href="#l42.14"></a><span id="l42.14" class="difflineminus">- *</span>
<a href="#l42.15"></a><span id="l42.15" class="difflineminus">- * @param obj</span>
<a href="#l42.16"></a><span id="l42.16" class="difflineminus">- *        Object containing the method to track</span>
<a href="#l42.17"></a><span id="l42.17" class="difflineminus">- * @param func</span>
<a href="#l42.18"></a><span id="l42.18" class="difflineminus">- *        Property name of the object that is the function to track</span>
<a href="#l42.19"></a><span id="l42.19" class="difflineminus">- * @param name</span>
<a href="#l42.20"></a><span id="l42.20" class="difflineminus">- *        &quot;Pretty&quot; name to log the usage counts</span>
<a href="#l42.21"></a><span id="l42.21" class="difflineminus">- */</span>
<a href="#l42.22"></a><span id="l42.22" class="difflineminus">-let track = function(obj, func, name) {</span>
<a href="#l42.23"></a><span id="l42.23" class="difflineminus">-  // Initialize count data</span>
<a href="#l42.24"></a><span id="l42.24" class="difflineminus">-  data[name] = 0;</span>
<a href="#l42.25"></a><span id="l42.25" class="difflineminus">-</span>
<a href="#l42.26"></a><span id="l42.26" class="difflineminus">-  // Save the original function to call</span>
<a href="#l42.27"></a><span id="l42.27" class="difflineminus">-  let orig = obj[func];</span>
<a href="#l42.28"></a><span id="l42.28" class="difflineminus">-  obj[func] = function() {</span>
<a href="#l42.29"></a><span id="l42.29" class="difflineminus">-    // Increment our counter right away (in-case there's an exception)</span>
<a href="#l42.30"></a><span id="l42.30" class="difflineminus">-    data[name]++;</span>
<a href="#l42.31"></a><span id="l42.31" class="difflineminus">-</span>
<a href="#l42.32"></a><span id="l42.32" class="difflineminus">-    // Make the call just like it was originally was called</span>
<a href="#l42.33"></a><span id="l42.33" class="difflineminus">-    return orig.apply(this, arguments);</span>
<a href="#l42.34"></a><span id="l42.34" class="difflineminus">-  };</span>
<a href="#l42.35"></a><span id="l42.35" class="difflineminus">-}</span>
<a href="#l42.36"></a><span id="l42.36" class="difflineminus">-</span>
<a href="#l42.37"></a><span id="l42.37" class="difflineminus">-/**</span>
<a href="#l42.38"></a><span id="l42.38" class="difflineminus">- * Instrument a browser window for various behavior</span>
<a href="#l42.39"></a><span id="l42.39" class="difflineminus">- *</span>
<a href="#l42.40"></a><span id="l42.40" class="difflineminus">- * @param window</span>
<a href="#l42.41"></a><span id="l42.41" class="difflineminus">- *        Browser window to instrument</span>
<a href="#l42.42"></a><span id="l42.42" class="difflineminus">- */</span>
<a href="#l42.43"></a><span id="l42.43" class="difflineminus">-function Instrument(window) {</span>
<a href="#l42.44"></a><span id="l42.44" class="difflineminus">-  let $ = function(id) window.document.getElementById(id);</span>
<a href="#l42.45"></a><span id="l42.45" class="difflineminus">-</span>
<a href="#l42.46"></a><span id="l42.46" class="difflineminus">-  track(window.gURLBar, &quot;showHistoryPopup&quot;, &quot;dropdown&quot;);</span>
<a href="#l42.47"></a><span id="l42.47" class="difflineminus">-  track($(&quot;back-button&quot;), &quot;_handleClick&quot;, &quot;back&quot;);</span>
<a href="#l42.48"></a><span id="l42.48" class="difflineminus">-  track($(&quot;forward-button&quot;), &quot;_handleClick&quot;, &quot;forward&quot;);</span>
<a href="#l42.49"></a><span id="l42.49" class="difflineminus">-}</span>
<a href="#l42.50"></a><span id="l42.50" class="difflineminus">-</span>
<a href="#l42.51"></a><span id="l42.51" class="difflineminus">-// Provide a way to get at the collected data (e.g., from Error Console)</span>
<a href="#l42.52"></a><span id="l42.52" class="difflineminus">-Instrument.report = function() JSON.stringify(data);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1">deleted file mode 100644</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/instrument/instrument.xul</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineplus">+++ /dev/null</span>
<a href="#l43.4"></a><span id="l43.4" class="difflineat">@@ -1,16 +0,0 @@</span>
<a href="#l43.5"></a><span id="l43.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l43.6"></a><span id="l43.6" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l43.7"></a><span id="l43.7" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l43.8"></a><span id="l43.8" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l43.9"></a><span id="l43.9" class="difflineminus">-</span>
<a href="#l43.10"></a><span id="l43.10" class="difflineminus">-&lt;overlay xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l43.11"></a><span id="l43.11" class="difflineminus">-  &lt;script type=&quot;application/javascript&quot;&gt;</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-  &lt;![CDATA[</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineminus">-    addEventListener(&quot;load&quot;, function() {</span>
<a href="#l43.14"></a><span id="l43.14" class="difflineminus">-      let I = {};</span>
<a href="#l43.15"></a><span id="l43.15" class="difflineminus">-      Components.utils.import(&quot;resource://instrument/instrument.jsm&quot;, I);</span>
<a href="#l43.16"></a><span id="l43.16" class="difflineminus">-      I.Instrument(window);</span>
<a href="#l43.17"></a><span id="l43.17" class="difflineminus">-    }, false);</span>
<a href="#l43.18"></a><span id="l43.18" class="difflineminus">-  ]]&gt;</span>
<a href="#l43.19"></a><span id="l43.19" class="difflineminus">-  &lt;/script&gt;</span>
<a href="#l43.20"></a><span id="l43.20" class="difflineminus">-&lt;/overlay&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1">deleted file mode 100644</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/Observers.js</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineplus">+++ /dev/null</span>
<a href="#l44.4"></a><span id="l44.4" class="difflineat">@@ -1,150 +0,0 @@</span>
<a href="#l44.5"></a><span id="l44.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l44.6"></a><span id="l44.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l44.7"></a><span id="l44.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l44.8"></a><span id="l44.8" class="difflineminus">-</span>
<a href="#l44.9"></a><span id="l44.9" class="difflineminus">-let EXPORTED_SYMBOLS = [&quot;Observers&quot;];</span>
<a href="#l44.10"></a><span id="l44.10" class="difflineminus">-</span>
<a href="#l44.11"></a><span id="l44.11" class="difflineminus">-const Cc = Components.classes;</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-const Ci = Components.interfaces;</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineminus">-const Cr = Components.results;</span>
<a href="#l44.14"></a><span id="l44.14" class="difflineminus">-const Cu = Components.utils;</span>
<a href="#l44.15"></a><span id="l44.15" class="difflineminus">-</span>
<a href="#l44.16"></a><span id="l44.16" class="difflineminus">-Cu.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l44.17"></a><span id="l44.17" class="difflineminus">-</span>
<a href="#l44.18"></a><span id="l44.18" class="difflineminus">-/**</span>
<a href="#l44.19"></a><span id="l44.19" class="difflineminus">- * A service for adding, removing and notifying observers of notifications.</span>
<a href="#l44.20"></a><span id="l44.20" class="difflineminus">- * Wraps the nsIObserverService interface.</span>
<a href="#l44.21"></a><span id="l44.21" class="difflineminus">- *</span>
<a href="#l44.22"></a><span id="l44.22" class="difflineminus">- * @version 0.2</span>
<a href="#l44.23"></a><span id="l44.23" class="difflineminus">- */</span>
<a href="#l44.24"></a><span id="l44.24" class="difflineminus">-let Observers = {</span>
<a href="#l44.25"></a><span id="l44.25" class="difflineminus">-  /**</span>
<a href="#l44.26"></a><span id="l44.26" class="difflineminus">-   * Register the given callback as an observer of the given topic.</span>
<a href="#l44.27"></a><span id="l44.27" class="difflineminus">-   *</span>
<a href="#l44.28"></a><span id="l44.28" class="difflineminus">-   * @param   topic       {String}</span>
<a href="#l44.29"></a><span id="l44.29" class="difflineminus">-   *          the topic to observe</span>
<a href="#l44.30"></a><span id="l44.30" class="difflineminus">-   *</span>
<a href="#l44.31"></a><span id="l44.31" class="difflineminus">-   * @param   callback    {Object}</span>
<a href="#l44.32"></a><span id="l44.32" class="difflineminus">-   *          the callback; an Object that implements nsIObserver or a Function</span>
<a href="#l44.33"></a><span id="l44.33" class="difflineminus">-   *          that gets called when the notification occurs</span>
<a href="#l44.34"></a><span id="l44.34" class="difflineminus">-   *</span>
<a href="#l44.35"></a><span id="l44.35" class="difflineminus">-   * @param   thisObject  {Object}  [optional]</span>
<a href="#l44.36"></a><span id="l44.36" class="difflineminus">-   *          the object to use as |this| when calling a Function callback</span>
<a href="#l44.37"></a><span id="l44.37" class="difflineminus">-   *</span>
<a href="#l44.38"></a><span id="l44.38" class="difflineminus">-   * @returns the observer</span>
<a href="#l44.39"></a><span id="l44.39" class="difflineminus">-   */</span>
<a href="#l44.40"></a><span id="l44.40" class="difflineminus">-  add: function(topic, callback, thisObject) {</span>
<a href="#l44.41"></a><span id="l44.41" class="difflineminus">-    let observer = new Observer(topic, callback, thisObject);</span>
<a href="#l44.42"></a><span id="l44.42" class="difflineminus">-    this._cache.push(observer);</span>
<a href="#l44.43"></a><span id="l44.43" class="difflineminus">-    this._service.addObserver(observer, topic, true);</span>
<a href="#l44.44"></a><span id="l44.44" class="difflineminus">-</span>
<a href="#l44.45"></a><span id="l44.45" class="difflineminus">-    return observer;</span>
<a href="#l44.46"></a><span id="l44.46" class="difflineminus">-  },</span>
<a href="#l44.47"></a><span id="l44.47" class="difflineminus">-</span>
<a href="#l44.48"></a><span id="l44.48" class="difflineminus">-  /**</span>
<a href="#l44.49"></a><span id="l44.49" class="difflineminus">-   * Unregister the given callback as an observer of the given topic.</span>
<a href="#l44.50"></a><span id="l44.50" class="difflineminus">-   *</span>
<a href="#l44.51"></a><span id="l44.51" class="difflineminus">-   * @param topic       {String}</span>
<a href="#l44.52"></a><span id="l44.52" class="difflineminus">-   *        the topic being observed</span>
<a href="#l44.53"></a><span id="l44.53" class="difflineminus">-   *</span>
<a href="#l44.54"></a><span id="l44.54" class="difflineminus">-   * @param callback    {Object}</span>
<a href="#l44.55"></a><span id="l44.55" class="difflineminus">-   *        the callback doing the observing</span>
<a href="#l44.56"></a><span id="l44.56" class="difflineminus">-   *</span>
<a href="#l44.57"></a><span id="l44.57" class="difflineminus">-   * @param thisObject  {Object}  [optional]</span>
<a href="#l44.58"></a><span id="l44.58" class="difflineminus">-   *        the object being used as |this| when calling a Function callback</span>
<a href="#l44.59"></a><span id="l44.59" class="difflineminus">-   */</span>
<a href="#l44.60"></a><span id="l44.60" class="difflineminus">-  remove: function(topic, callback, thisObject) {</span>
<a href="#l44.61"></a><span id="l44.61" class="difflineminus">-    // This seems fairly inefficient, but I'm not sure how much better</span>
<a href="#l44.62"></a><span id="l44.62" class="difflineminus">-    // we can make it.  We could index by topic, but we can't index by callback</span>
<a href="#l44.63"></a><span id="l44.63" class="difflineminus">-    // or thisObject, as far as I know, since the keys to JavaScript hashes</span>
<a href="#l44.64"></a><span id="l44.64" class="difflineminus">-    // (a.k.a. objects) can apparently only be primitive values.</span>
<a href="#l44.65"></a><span id="l44.65" class="difflineminus">-    let [observer] = this._cache.filter(function(v) v.topic      == topic    &amp;&amp;</span>
<a href="#l44.66"></a><span id="l44.66" class="difflineminus">-                                                    v.callback   == callback &amp;&amp;</span>
<a href="#l44.67"></a><span id="l44.67" class="difflineminus">-                                                    v.thisObject == thisObject);</span>
<a href="#l44.68"></a><span id="l44.68" class="difflineminus">-    if (observer) {</span>
<a href="#l44.69"></a><span id="l44.69" class="difflineminus">-      this._service.removeObserver(observer, topic);</span>
<a href="#l44.70"></a><span id="l44.70" class="difflineminus">-      this._cache.splice(this._cache.indexOf(observer), 1);</span>
<a href="#l44.71"></a><span id="l44.71" class="difflineminus">-    }</span>
<a href="#l44.72"></a><span id="l44.72" class="difflineminus">-  },</span>
<a href="#l44.73"></a><span id="l44.73" class="difflineminus">-</span>
<a href="#l44.74"></a><span id="l44.74" class="difflineminus">-  /**</span>
<a href="#l44.75"></a><span id="l44.75" class="difflineminus">-   * Notify observers about something.</span>
<a href="#l44.76"></a><span id="l44.76" class="difflineminus">-   *</span>
<a href="#l44.77"></a><span id="l44.77" class="difflineminus">-   * @param topic   {String}</span>
<a href="#l44.78"></a><span id="l44.78" class="difflineminus">-   *        the topic to notify observers about</span>
<a href="#l44.79"></a><span id="l44.79" class="difflineminus">-   *</span>
<a href="#l44.80"></a><span id="l44.80" class="difflineminus">-   * @param subject {Object}  [optional]</span>
<a href="#l44.81"></a><span id="l44.81" class="difflineminus">-   *        some information about the topic; can be any JS object or primitive</span>
<a href="#l44.82"></a><span id="l44.82" class="difflineminus">-   *</span>
<a href="#l44.83"></a><span id="l44.83" class="difflineminus">-   * @param data    {String}  [optional] [deprecated]</span>
<a href="#l44.84"></a><span id="l44.84" class="difflineminus">-   *        some more information about the topic; deprecated as the subject</span>
<a href="#l44.85"></a><span id="l44.85" class="difflineminus">-   *        is sufficient to pass all needed information to the JS observers</span>
<a href="#l44.86"></a><span id="l44.86" class="difflineminus">-   *        that this module targets; if you have multiple values to pass to</span>
<a href="#l44.87"></a><span id="l44.87" class="difflineminus">-   *        the observer, wrap them in an object and pass them via the subject</span>
<a href="#l44.88"></a><span id="l44.88" class="difflineminus">-   *        parameter (i.e.: { foo: 1, bar: &quot;some string&quot;, baz: myObject })</span>
<a href="#l44.89"></a><span id="l44.89" class="difflineminus">-   */</span>
<a href="#l44.90"></a><span id="l44.90" class="difflineminus">-  notify: function(topic, subject, data) {</span>
<a href="#l44.91"></a><span id="l44.91" class="difflineminus">-    subject = (typeof subject == &quot;undefined&quot;) ? null : new Subject(subject);</span>
<a href="#l44.92"></a><span id="l44.92" class="difflineminus">-       data = (typeof    data == &quot;undefined&quot;) ? null : data;</span>
<a href="#l44.93"></a><span id="l44.93" class="difflineminus">-    this._service.notifyObservers(subject, topic, data);</span>
<a href="#l44.94"></a><span id="l44.94" class="difflineminus">-  },</span>
<a href="#l44.95"></a><span id="l44.95" class="difflineminus">-</span>
<a href="#l44.96"></a><span id="l44.96" class="difflineminus">-  _service: Cc[&quot;@mozilla.org/observer-service;1&quot;].</span>
<a href="#l44.97"></a><span id="l44.97" class="difflineminus">-            getService(Ci.nsIObserverService),</span>
<a href="#l44.98"></a><span id="l44.98" class="difflineminus">-</span>
<a href="#l44.99"></a><span id="l44.99" class="difflineminus">-  /**</span>
<a href="#l44.100"></a><span id="l44.100" class="difflineminus">-   * A cache of observers that have been added.</span>
<a href="#l44.101"></a><span id="l44.101" class="difflineminus">-   *</span>
<a href="#l44.102"></a><span id="l44.102" class="difflineminus">-   * We use this to remove observers when a caller calls |remove|.</span>
<a href="#l44.103"></a><span id="l44.103" class="difflineminus">-   *</span>
<a href="#l44.104"></a><span id="l44.104" class="difflineminus">-   * XXX This might result in reference cycles, causing memory leaks,</span>
<a href="#l44.105"></a><span id="l44.105" class="difflineminus">-   * if we hold a reference to an observer that holds a reference to us.</span>
<a href="#l44.106"></a><span id="l44.106" class="difflineminus">-   * Could we fix that by making this an independent top-level object</span>
<a href="#l44.107"></a><span id="l44.107" class="difflineminus">-   * rather than a property of this object?</span>
<a href="#l44.108"></a><span id="l44.108" class="difflineminus">-   */</span>
<a href="#l44.109"></a><span id="l44.109" class="difflineminus">-  _cache: []</span>
<a href="#l44.110"></a><span id="l44.110" class="difflineminus">-};</span>
<a href="#l44.111"></a><span id="l44.111" class="difflineminus">-</span>
<a href="#l44.112"></a><span id="l44.112" class="difflineminus">-</span>
<a href="#l44.113"></a><span id="l44.113" class="difflineminus">-function Observer(topic, callback, thisObject) {</span>
<a href="#l44.114"></a><span id="l44.114" class="difflineminus">-  this.topic = topic;</span>
<a href="#l44.115"></a><span id="l44.115" class="difflineminus">-  this.callback = callback;</span>
<a href="#l44.116"></a><span id="l44.116" class="difflineminus">-  this.thisObject = thisObject;</span>
<a href="#l44.117"></a><span id="l44.117" class="difflineminus">-}</span>
<a href="#l44.118"></a><span id="l44.118" class="difflineminus">-</span>
<a href="#l44.119"></a><span id="l44.119" class="difflineminus">-Observer.prototype = {</span>
<a href="#l44.120"></a><span id="l44.120" class="difflineminus">-  QueryInterface: XPCOMUtils.generateQI([Ci.nsIObserver, Ci.nsISupportsWeakReference]),</span>
<a href="#l44.121"></a><span id="l44.121" class="difflineminus">-  observe: function(subject, topic, data) {</span>
<a href="#l44.122"></a><span id="l44.122" class="difflineminus">-    // Extract the wrapped object for subjects that are one of our wrappers</span>
<a href="#l44.123"></a><span id="l44.123" class="difflineminus">-    // around a JS object.  This way we support both wrapped subjects created</span>
<a href="#l44.124"></a><span id="l44.124" class="difflineminus">-    // using this module and those that are real XPCOM components.</span>
<a href="#l44.125"></a><span id="l44.125" class="difflineminus">-    if (subject &amp;&amp; typeof subject == &quot;object&quot; &amp;&amp;</span>
<a href="#l44.126"></a><span id="l44.126" class="difflineminus">-        (&quot;wrappedJSObject&quot; in subject) &amp;&amp;</span>
<a href="#l44.127"></a><span id="l44.127" class="difflineminus">-        (&quot;observersModuleSubjectWrapper&quot; in subject.wrappedJSObject))</span>
<a href="#l44.128"></a><span id="l44.128" class="difflineminus">-      subject = subject.wrappedJSObject.object;</span>
<a href="#l44.129"></a><span id="l44.129" class="difflineminus">-</span>
<a href="#l44.130"></a><span id="l44.130" class="difflineminus">-    if (typeof this.callback == &quot;function&quot;) {</span>
<a href="#l44.131"></a><span id="l44.131" class="difflineminus">-      if (this.thisObject)</span>
<a href="#l44.132"></a><span id="l44.132" class="difflineminus">-        this.callback.call(this.thisObject, subject, data);</span>
<a href="#l44.133"></a><span id="l44.133" class="difflineminus">-      else</span>
<a href="#l44.134"></a><span id="l44.134" class="difflineminus">-        this.callback(subject, data);</span>
<a href="#l44.135"></a><span id="l44.135" class="difflineminus">-    }</span>
<a href="#l44.136"></a><span id="l44.136" class="difflineminus">-    else // typeof this.callback == &quot;object&quot; (nsIObserver)</span>
<a href="#l44.137"></a><span id="l44.137" class="difflineminus">-      this.callback.observe(subject, topic, data);</span>
<a href="#l44.138"></a><span id="l44.138" class="difflineminus">-  }</span>
<a href="#l44.139"></a><span id="l44.139" class="difflineminus">-}</span>
<a href="#l44.140"></a><span id="l44.140" class="difflineminus">-</span>
<a href="#l44.141"></a><span id="l44.141" class="difflineminus">-</span>
<a href="#l44.142"></a><span id="l44.142" class="difflineminus">-function Subject(object) {</span>
<a href="#l44.143"></a><span id="l44.143" class="difflineminus">-  // Double-wrap the object and set a property identifying the wrappedJSObject</span>
<a href="#l44.144"></a><span id="l44.144" class="difflineminus">-  // as one of our wrappers to distinguish between subjects that are one of our</span>
<a href="#l44.145"></a><span id="l44.145" class="difflineminus">-  // wrappers (which we should unwrap when notifying our observers) and those</span>
<a href="#l44.146"></a><span id="l44.146" class="difflineminus">-  // that are real JS XPCOM components (which we should pass through unaltered).</span>
<a href="#l44.147"></a><span id="l44.147" class="difflineminus">-  this.wrappedJSObject = { observersModuleSubjectWrapper: true, object: object };</span>
<a href="#l44.148"></a><span id="l44.148" class="difflineminus">-}</span>
<a href="#l44.149"></a><span id="l44.149" class="difflineminus">-</span>
<a href="#l44.150"></a><span id="l44.150" class="difflineminus">-Subject.prototype = {</span>
<a href="#l44.151"></a><span id="l44.151" class="difflineminus">-  QueryInterface: XPCOMUtils.generateQI([]),</span>
<a href="#l44.152"></a><span id="l44.152" class="difflineminus">-  getHelperForLanguage: function() {},</span>
<a href="#l44.153"></a><span id="l44.153" class="difflineminus">-  getInterfaces: function() {}</span>
<a href="#l44.154"></a><span id="l44.154" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1">deleted file mode 100644</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/dbutils.js</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineplus">+++ /dev/null</span>
<a href="#l45.4"></a><span id="l45.4" class="difflineat">@@ -1,63 +0,0 @@</span>
<a href="#l45.5"></a><span id="l45.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l45.6"></a><span id="l45.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l45.7"></a><span id="l45.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l45.8"></a><span id="l45.8" class="difflineminus">-</span>
<a href="#l45.9"></a><span id="l45.9" class="difflineminus">-var Ci = Components.interfaces;</span>
<a href="#l45.10"></a><span id="l45.10" class="difflineminus">-var Cc = Components.classes;</span>
<a href="#l45.11"></a><span id="l45.11" class="difflineminus">-var Cu = Components.utils;</span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-var EXPORTED_SYMBOLS = [&quot;DbUtils&quot;];</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineminus">-</span>
<a href="#l45.14"></a><span id="l45.14" class="difflineminus">-Cu.import(&quot;resource://testpilot/modules/log4moz.js&quot;);</span>
<a href="#l45.15"></a><span id="l45.15" class="difflineminus">-</span>
<a href="#l45.16"></a><span id="l45.16" class="difflineminus">-/* Make a namespace object called DbUtils, to export,</span>
<a href="#l45.17"></a><span id="l45.17" class="difflineminus">- * which contains each function in this file.*/</span>
<a href="#l45.18"></a><span id="l45.18" class="difflineminus">-var DbUtils = ([f for each (f in this) if (typeof f === &quot;function&quot;)]</span>
<a href="#l45.19"></a><span id="l45.19" class="difflineminus">-                 .reduce(function(o, f)(o[f.name] = f, o), {}));</span>
<a href="#l45.20"></a><span id="l45.20" class="difflineminus">-</span>
<a href="#l45.21"></a><span id="l45.21" class="difflineminus">-var _dirSvc = Cc[&quot;@mozilla.org/file/directory_service;1&quot;]</span>
<a href="#l45.22"></a><span id="l45.22" class="difflineminus">-                .getService(Ci.nsIProperties);</span>
<a href="#l45.23"></a><span id="l45.23" class="difflineminus">-var _storSvc = Cc[&quot;@mozilla.org/storage/service;1&quot;]</span>
<a href="#l45.24"></a><span id="l45.24" class="difflineminus">-                 .getService(Ci.mozIStorageService);</span>
<a href="#l45.25"></a><span id="l45.25" class="difflineminus">-</span>
<a href="#l45.26"></a><span id="l45.26" class="difflineminus">-DbUtils.openDatabase = function openDatabase(file) {</span>
<a href="#l45.27"></a><span id="l45.27" class="difflineminus">-  /* If the pointed-at file doesn't already exist, it means the database</span>
<a href="#l45.28"></a><span id="l45.28" class="difflineminus">-   * has never been initialized */</span>
<a href="#l45.29"></a><span id="l45.29" class="difflineminus">-  let logger = Log4Moz.repository.getLogger(&quot;TestPilot.Database&quot;);</span>
<a href="#l45.30"></a><span id="l45.30" class="difflineminus">-  let connection = null;</span>
<a href="#l45.31"></a><span id="l45.31" class="difflineminus">-  try {</span>
<a href="#l45.32"></a><span id="l45.32" class="difflineminus">-    logger.debug(&quot;Trying to open file...\n&quot;);</span>
<a href="#l45.33"></a><span id="l45.33" class="difflineminus">-    connection = _storSvc.openDatabase(file);</span>
<a href="#l45.34"></a><span id="l45.34" class="difflineminus">-    logger.debug(&quot;Opening file done...\n&quot;);</span>
<a href="#l45.35"></a><span id="l45.35" class="difflineminus">-  } catch(e) {</span>
<a href="#l45.36"></a><span id="l45.36" class="difflineminus">-    logger.debug(&quot;Opening file failed...\n&quot;);</span>
<a href="#l45.37"></a><span id="l45.37" class="difflineminus">-    Components.utils.reportError(</span>
<a href="#l45.38"></a><span id="l45.38" class="difflineminus">-      &quot;Opening database failed, database may not have been initialized&quot;);</span>
<a href="#l45.39"></a><span id="l45.39" class="difflineminus">-  }</span>
<a href="#l45.40"></a><span id="l45.40" class="difflineminus">-  return connection;</span>
<a href="#l45.41"></a><span id="l45.41" class="difflineminus">-};</span>
<a href="#l45.42"></a><span id="l45.42" class="difflineminus">-</span>
<a href="#l45.43"></a><span id="l45.43" class="difflineminus">-DbUtils.createTable = function createTable(connection, tableName, schema){</span>
<a href="#l45.44"></a><span id="l45.44" class="difflineminus">-  let logger = Log4Moz.repository.getLogger(&quot;TestPilot.Database&quot;);</span>
<a href="#l45.45"></a><span id="l45.45" class="difflineminus">-  let file = connection.databaseFile;</span>
<a href="#l45.46"></a><span id="l45.46" class="difflineminus">-  logger.debug(&quot;File is &quot; + file + &quot;\n&quot;);</span>
<a href="#l45.47"></a><span id="l45.47" class="difflineminus">-  try{</span>
<a href="#l45.48"></a><span id="l45.48" class="difflineminus">-    if(!connection.tableExists(tableName)){</span>
<a href="#l45.49"></a><span id="l45.49" class="difflineminus">-      // TODO why don't we use connection.createTable here??</span>
<a href="#l45.50"></a><span id="l45.50" class="difflineminus">-      connection.executeSimpleSQL(schema);</span>
<a href="#l45.51"></a><span id="l45.51" class="difflineminus">-    } else{</span>
<a href="#l45.52"></a><span id="l45.52" class="difflineminus">-      logger.debug(&quot;database table: &quot; + tableName + &quot; already exists\n&quot;);</span>
<a href="#l45.53"></a><span id="l45.53" class="difflineminus">-    }</span>
<a href="#l45.54"></a><span id="l45.54" class="difflineminus">-  }</span>
<a href="#l45.55"></a><span id="l45.55" class="difflineminus">-  catch(e) {</span>
<a href="#l45.56"></a><span id="l45.56" class="difflineminus">-    logger.warn(&quot;Error creating database: &quot; + e + &quot;\n&quot;);</span>
<a href="#l45.57"></a><span id="l45.57" class="difflineminus">-    Cu.reportError(&quot;Test Pilot's &quot; + tableName +</span>
<a href="#l45.58"></a><span id="l45.58" class="difflineminus">-        &quot; database table appears to be corrupt, resetting it.&quot;);</span>
<a href="#l45.59"></a><span id="l45.59" class="difflineminus">-    if(file.exists()){</span>
<a href="#l45.60"></a><span id="l45.60" class="difflineminus">-      //remove corrupt database table</span>
<a href="#l45.61"></a><span id="l45.61" class="difflineminus">-      file.remove(false);</span>
<a href="#l45.62"></a><span id="l45.62" class="difflineminus">-    }</span>
<a href="#l45.63"></a><span id="l45.63" class="difflineminus">-    connection = _storSvc.openDatabase(file);</span>
<a href="#l45.64"></a><span id="l45.64" class="difflineminus">-    connection.executeSimpleSQL(schema);</span>
<a href="#l45.65"></a><span id="l45.65" class="difflineminus">-  }</span>
<a href="#l45.66"></a><span id="l45.66" class="difflineminus">-  return connection;</span>
<a href="#l45.67"></a><span id="l45.67" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1">deleted file mode 100644</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/experiment_data_store.js</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineplus">+++ /dev/null</span>
<a href="#l46.4"></a><span id="l46.4" class="difflineat">@@ -1,349 +0,0 @@</span>
<a href="#l46.5"></a><span id="l46.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l46.6"></a><span id="l46.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l46.7"></a><span id="l46.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l46.8"></a><span id="l46.8" class="difflineminus">-</span>
<a href="#l46.9"></a><span id="l46.9" class="difflineminus">-EXPORTED_SYMBOLS = [&quot;ExperimentDataStore&quot;, &quot;TYPE_INT_32&quot;, &quot;TYPE_DOUBLE&quot;,</span>
<a href="#l46.10"></a><span id="l46.10" class="difflineminus">-                   &quot;TYPE_STRING&quot;];</span>
<a href="#l46.11"></a><span id="l46.11" class="difflineminus">-</span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-const Cc = Components.classes;</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineminus">-const Ci = Components.interfaces;</span>
<a href="#l46.14"></a><span id="l46.14" class="difflineminus">-const Cu = Components.utils;</span>
<a href="#l46.15"></a><span id="l46.15" class="difflineminus">-</span>
<a href="#l46.16"></a><span id="l46.16" class="difflineminus">-Cu.import(&quot;resource://testpilot/modules/dbutils.js&quot;);</span>
<a href="#l46.17"></a><span id="l46.17" class="difflineminus">-Cu.import(&quot;resource://testpilot/modules/log4moz.js&quot;);</span>
<a href="#l46.18"></a><span id="l46.18" class="difflineminus">-Cu.import(&quot;resource://testpilot/modules/string_sanitizer.js&quot;);</span>
<a href="#l46.19"></a><span id="l46.19" class="difflineminus">-var _dirSvc = Cc[&quot;@mozilla.org/file/directory_service;1&quot;]</span>
<a href="#l46.20"></a><span id="l46.20" class="difflineminus">-                .getService(Ci.nsIProperties);</span>
<a href="#l46.21"></a><span id="l46.21" class="difflineminus">-var _storSvc = Cc[&quot;@mozilla.org/storage/service;1&quot;]</span>
<a href="#l46.22"></a><span id="l46.22" class="difflineminus">-                 .getService(Ci.mozIStorageService);</span>
<a href="#l46.23"></a><span id="l46.23" class="difflineminus">-</span>
<a href="#l46.24"></a><span id="l46.24" class="difflineminus">-const TYPE_INT_32 = 0;</span>
<a href="#l46.25"></a><span id="l46.25" class="difflineminus">-const TYPE_DOUBLE = 1;</span>
<a href="#l46.26"></a><span id="l46.26" class="difflineminus">-const TYPE_STRING = 2;</span>
<a href="#l46.27"></a><span id="l46.27" class="difflineminus">-</span>
<a href="#l46.28"></a><span id="l46.28" class="difflineminus">-const EXCEPTION_TABLE_NAME = &quot;exceptions&quot;;</span>
<a href="#l46.29"></a><span id="l46.29" class="difflineminus">-</span>
<a href="#l46.30"></a><span id="l46.30" class="difflineminus">-function ExperimentDataStore(fileName, tableName, columns) {</span>
<a href="#l46.31"></a><span id="l46.31" class="difflineminus">-  this._init(fileName, tableName, columns);</span>
<a href="#l46.32"></a><span id="l46.32" class="difflineminus">-}</span>
<a href="#l46.33"></a><span id="l46.33" class="difflineminus">-ExperimentDataStore.prototype = {</span>
<a href="#l46.34"></a><span id="l46.34" class="difflineminus">-  _init: function EDS__init(fileName, tableName, columns) {</span>
<a href="#l46.35"></a><span id="l46.35" class="difflineminus">-    this._fileName = fileName;</span>
<a href="#l46.36"></a><span id="l46.36" class="difflineminus">-    this._tableName = tableName;</span>
<a href="#l46.37"></a><span id="l46.37" class="difflineminus">-    this._columns = columns;</span>
<a href="#l46.38"></a><span id="l46.38" class="difflineminus">-    let logger = Log4Moz.repository.getLogger(&quot;TestPilot.Database&quot;);</span>
<a href="#l46.39"></a><span id="l46.39" class="difflineminus">-    let file = _dirSvc.get(&quot;ProfD&quot;, Ci.nsIFile);</span>
<a href="#l46.40"></a><span id="l46.40" class="difflineminus">-    file.append(this._fileName);</span>
<a href="#l46.41"></a><span id="l46.41" class="difflineminus">-    // openDatabase creates the file if it's not there yet:</span>
<a href="#l46.42"></a><span id="l46.42" class="difflineminus">-    this._connection = DbUtils.openDatabase(file);</span>
<a href="#l46.43"></a><span id="l46.43" class="difflineminus">-    // Create schema based on columns:</span>
<a href="#l46.44"></a><span id="l46.44" class="difflineminus">-    let schemaClauses = [];</span>
<a href="#l46.45"></a><span id="l46.45" class="difflineminus">-    for (let i = 0; i &lt; this._columns.length; i++) {</span>
<a href="#l46.46"></a><span id="l46.46" class="difflineminus">-      let colName = this._columns[i].property;</span>
<a href="#l46.47"></a><span id="l46.47" class="difflineminus">-      let colType;</span>
<a href="#l46.48"></a><span id="l46.48" class="difflineminus">-      switch( this._columns[i].type) {</span>
<a href="#l46.49"></a><span id="l46.49" class="difflineminus">-      case TYPE_INT_32: case TYPE_DOUBLE:</span>
<a href="#l46.50"></a><span id="l46.50" class="difflineminus">-        colType = &quot;INTEGER&quot;;</span>
<a href="#l46.51"></a><span id="l46.51" class="difflineminus">-        break;</span>
<a href="#l46.52"></a><span id="l46.52" class="difflineminus">-      case TYPE_STRING:</span>
<a href="#l46.53"></a><span id="l46.53" class="difflineminus">-        colType = &quot;TEXT&quot;;</span>
<a href="#l46.54"></a><span id="l46.54" class="difflineminus">-        break;</span>
<a href="#l46.55"></a><span id="l46.55" class="difflineminus">-</span>
<a href="#l46.56"></a><span id="l46.56" class="difflineminus">-      }</span>
<a href="#l46.57"></a><span id="l46.57" class="difflineminus">-      schemaClauses.push( colName + &quot; &quot; + colType );</span>
<a href="#l46.58"></a><span id="l46.58" class="difflineminus">-    }</span>
<a href="#l46.59"></a><span id="l46.59" class="difflineminus">-    let schema = &quot;CREATE TABLE &quot; + this._tableName + &quot;(&quot;</span>
<a href="#l46.60"></a><span id="l46.60" class="difflineminus">-                  + schemaClauses.join(&quot;, &quot;) + &quot;);&quot;;</span>
<a href="#l46.61"></a><span id="l46.61" class="difflineminus">-    // CreateTable creates the table only if it does not already exist:</span>
<a href="#l46.62"></a><span id="l46.62" class="difflineminus">-    try {</span>
<a href="#l46.63"></a><span id="l46.63" class="difflineminus">-      DbUtils.createTable(this._connection, this._tableName, schema);</span>
<a href="#l46.64"></a><span id="l46.64" class="difflineminus">-    } catch(e) {</span>
<a href="#l46.65"></a><span id="l46.65" class="difflineminus">-      logger.warn(&quot;Error in createTable: &quot; + e + &quot;\n&quot;);</span>
<a href="#l46.66"></a><span id="l46.66" class="difflineminus">-    }</span>
<a href="#l46.67"></a><span id="l46.67" class="difflineminus">-</span>
<a href="#l46.68"></a><span id="l46.68" class="difflineminus">-    // Create a second table for storing exceptions for this study.  It has a fixed</span>
<a href="#l46.69"></a><span id="l46.69" class="difflineminus">-    // name and schema:</span>
<a href="#l46.70"></a><span id="l46.70" class="difflineminus">-    let exceptionTableSchema = &quot;CREATE TABLE &quot; + EXCEPTION_TABLE_NAME +</span>
<a href="#l46.71"></a><span id="l46.71" class="difflineminus">-      &quot; (time INTEGER, trace TEXT);&quot;;</span>
<a href="#l46.72"></a><span id="l46.72" class="difflineminus">-    try {</span>
<a href="#l46.73"></a><span id="l46.73" class="difflineminus">-      DbUtils.createTable(this._connection, &quot;exceptions&quot;, exceptionTableSchema);</span>
<a href="#l46.74"></a><span id="l46.74" class="difflineminus">-    } catch(e) {</span>
<a href="#l46.75"></a><span id="l46.75" class="difflineminus">-      logger.warn(&quot;Error in createTable: &quot; + e + &quot;\n&quot;);</span>
<a href="#l46.76"></a><span id="l46.76" class="difflineminus">-    }</span>
<a href="#l46.77"></a><span id="l46.77" class="difflineminus">-  },</span>
<a href="#l46.78"></a><span id="l46.78" class="difflineminus">-</span>
<a href="#l46.79"></a><span id="l46.79" class="difflineminus">-  _createStatement: function _createStatement(selectSql) {</span>
<a href="#l46.80"></a><span id="l46.80" class="difflineminus">-    try {</span>
<a href="#l46.81"></a><span id="l46.81" class="difflineminus">-      var selStmt = this._connection.createStatement(selectSql);</span>
<a href="#l46.82"></a><span id="l46.82" class="difflineminus">-      return selStmt;</span>
<a href="#l46.83"></a><span id="l46.83" class="difflineminus">-    } catch (e) {</span>
<a href="#l46.84"></a><span id="l46.84" class="difflineminus">-      throw new Error(this._connection.lastErrorString);</span>
<a href="#l46.85"></a><span id="l46.85" class="difflineminus">-    }</span>
<a href="#l46.86"></a><span id="l46.86" class="difflineminus">-  },</span>
<a href="#l46.87"></a><span id="l46.87" class="difflineminus">-</span>
<a href="#l46.88"></a><span id="l46.88" class="difflineminus">-  storeEvent: function EDS_storeEvent(uiEvent, callback) {</span>
<a href="#l46.89"></a><span id="l46.89" class="difflineminus">-    // Stores event asynchronously; callback will be called back with</span>
<a href="#l46.90"></a><span id="l46.90" class="difflineminus">-    // true or false on success or failure.</span>
<a href="#l46.91"></a><span id="l46.91" class="difflineminus">-    let columnNumbers = [];</span>
<a href="#l46.92"></a><span id="l46.92" class="difflineminus">-    for (let i = 1; i &lt;= this._columns.length; i++) {</span>
<a href="#l46.93"></a><span id="l46.93" class="difflineminus">-      // the i = 1 is so that we'll start with 1 instead of 0... we want</span>
<a href="#l46.94"></a><span id="l46.94" class="difflineminus">-      // a string like &quot;...VALUES (?1, ?2, ?3)&quot;</span>
<a href="#l46.95"></a><span id="l46.95" class="difflineminus">-      columnNumbers.push( &quot;?&quot; + i);</span>
<a href="#l46.96"></a><span id="l46.96" class="difflineminus">-    }</span>
<a href="#l46.97"></a><span id="l46.97" class="difflineminus">-    let insertSql = &quot;INSERT INTO &quot; + this._tableName + &quot; VALUES (&quot;;</span>
<a href="#l46.98"></a><span id="l46.98" class="difflineminus">-    insertSql += columnNumbers.join(&quot;, &quot;) + &quot;)&quot;;</span>
<a href="#l46.99"></a><span id="l46.99" class="difflineminus">-    let insStmt = this._createStatement(insertSql);</span>
<a href="#l46.100"></a><span id="l46.100" class="difflineminus">-    for (i = 0; i &lt; this._columns.length; i++) {</span>
<a href="#l46.101"></a><span id="l46.101" class="difflineminus">-      let datum =  uiEvent[this._columns[i].property];</span>
<a href="#l46.102"></a><span id="l46.102" class="difflineminus">-      switch (this._columns[i].type) {</span>
<a href="#l46.103"></a><span id="l46.103" class="difflineminus">-        case TYPE_INT_32: case TYPE_DOUBLE:</span>
<a href="#l46.104"></a><span id="l46.104" class="difflineminus">-          insStmt.params[i] = datum;</span>
<a href="#l46.105"></a><span id="l46.105" class="difflineminus">-        break;</span>
<a href="#l46.106"></a><span id="l46.106" class="difflineminus">-        case TYPE_STRING:</span>
<a href="#l46.107"></a><span id="l46.107" class="difflineminus">-          insStmt.params[i] = sanitizeString(datum);</span>
<a href="#l46.108"></a><span id="l46.108" class="difflineminus">-        break;</span>
<a href="#l46.109"></a><span id="l46.109" class="difflineminus">-      }</span>
<a href="#l46.110"></a><span id="l46.110" class="difflineminus">-    }</span>
<a href="#l46.111"></a><span id="l46.111" class="difflineminus">-    insStmt.executeAsync({</span>
<a href="#l46.112"></a><span id="l46.112" class="difflineminus">-      handleResult: function(aResultSet) {</span>
<a href="#l46.113"></a><span id="l46.113" class="difflineminus">-      },</span>
<a href="#l46.114"></a><span id="l46.114" class="difflineminus">-      handleError: function(aError) {</span>
<a href="#l46.115"></a><span id="l46.115" class="difflineminus">-        if (callback) {</span>
<a href="#l46.116"></a><span id="l46.116" class="difflineminus">-          callback(false);</span>
<a href="#l46.117"></a><span id="l46.117" class="difflineminus">-        }</span>
<a href="#l46.118"></a><span id="l46.118" class="difflineminus">-      },</span>
<a href="#l46.119"></a><span id="l46.119" class="difflineminus">-      handleCompletion: function(aReason) {</span>
<a href="#l46.120"></a><span id="l46.120" class="difflineminus">-        if (aReason == Ci.mozIStorageStatementCallback.REASON_FINISHED) {</span>
<a href="#l46.121"></a><span id="l46.121" class="difflineminus">-          if (callback) {</span>
<a href="#l46.122"></a><span id="l46.122" class="difflineminus">-            callback(true);</span>
<a href="#l46.123"></a><span id="l46.123" class="difflineminus">-          }</span>
<a href="#l46.124"></a><span id="l46.124" class="difflineminus">-        } else {</span>
<a href="#l46.125"></a><span id="l46.125" class="difflineminus">-          if (callback) {</span>
<a href="#l46.126"></a><span id="l46.126" class="difflineminus">-            callback(false);</span>
<a href="#l46.127"></a><span id="l46.127" class="difflineminus">-          }</span>
<a href="#l46.128"></a><span id="l46.128" class="difflineminus">-        }</span>
<a href="#l46.129"></a><span id="l46.129" class="difflineminus">-      }</span>
<a href="#l46.130"></a><span id="l46.130" class="difflineminus">-    });</span>
<a href="#l46.131"></a><span id="l46.131" class="difflineminus">-    insStmt.finalize();</span>
<a href="#l46.132"></a><span id="l46.132" class="difflineminus">-  },</span>
<a href="#l46.133"></a><span id="l46.133" class="difflineminus">-</span>
<a href="#l46.134"></a><span id="l46.134" class="difflineminus">-  logException: function EDS_logException(exception) {</span>
<a href="#l46.135"></a><span id="l46.135" class="difflineminus">-    let insertSql = &quot;INSERT INTO &quot; + EXCEPTION_TABLE_NAME + &quot; VALUES (?1, ?2);&quot;;</span>
<a href="#l46.136"></a><span id="l46.136" class="difflineminus">-    let insStmt =  this._createStatement(insertSql);</span>
<a href="#l46.137"></a><span id="l46.137" class="difflineminus">-    // Even though the SQL says ?1 and ?2, the param indices count from 0.</span>
<a href="#l46.138"></a><span id="l46.138" class="difflineminus">-    insStmt.params[0] = Date.now();</span>
<a href="#l46.139"></a><span id="l46.139" class="difflineminus">-    let txt = exception.message ? exception.message : exception.toString();</span>
<a href="#l46.140"></a><span id="l46.140" class="difflineminus">-    insStmt.params[1] = txt;</span>
<a href="#l46.141"></a><span id="l46.141" class="difflineminus">-    insStmt.executeAsync();</span>
<a href="#l46.142"></a><span id="l46.142" class="difflineminus">-    insStmt.finalize(); // TODO Is this the right thing to do when calling asynchronously?</span>
<a href="#l46.143"></a><span id="l46.143" class="difflineminus">-  },</span>
<a href="#l46.144"></a><span id="l46.144" class="difflineminus">-</span>
<a href="#l46.145"></a><span id="l46.145" class="difflineminus">-  getJSONRows: function EDS_getJSONRows(callback) {</span>
<a href="#l46.146"></a><span id="l46.146" class="difflineminus">-    // TODO why do both this function and getAllDataAsJSON exist when they both do</span>
<a href="#l46.147"></a><span id="l46.147" class="difflineminus">-    // the same thing?</span>
<a href="#l46.148"></a><span id="l46.148" class="difflineminus">-    let selectSql = &quot;SELECT * FROM &quot; + this._tableName;</span>
<a href="#l46.149"></a><span id="l46.149" class="difflineminus">-    let selStmt = this._createStatement(selectSql);</span>
<a href="#l46.150"></a><span id="l46.150" class="difflineminus">-    let records = [];</span>
<a href="#l46.151"></a><span id="l46.151" class="difflineminus">-    let self = this;</span>
<a href="#l46.152"></a><span id="l46.152" class="difflineminus">-    let numCols = selStmt.columnCount;</span>
<a href="#l46.153"></a><span id="l46.153" class="difflineminus">-</span>
<a href="#l46.154"></a><span id="l46.154" class="difflineminus">-    selStmt.executeAsync({</span>
<a href="#l46.155"></a><span id="l46.155" class="difflineminus">-      handleResult: function(aResultSet) {</span>
<a href="#l46.156"></a><span id="l46.156" class="difflineminus">-        for (let row = aResultSet.getNextRow(); row;</span>
<a href="#l46.157"></a><span id="l46.157" class="difflineminus">-             row = aResultSet.getNextRow()) {</span>
<a href="#l46.158"></a><span id="l46.158" class="difflineminus">-          let newRecord = [];</span>
<a href="#l46.159"></a><span id="l46.159" class="difflineminus">-          for (let i = 0; i &lt; numCols; i++) {</span>
<a href="#l46.160"></a><span id="l46.160" class="difflineminus">-            let column = self._columns[i];</span>
<a href="#l46.161"></a><span id="l46.161" class="difflineminus">-            //let value = row.getResultByIndex(i);</span>
<a href="#l46.162"></a><span id="l46.162" class="difflineminus">-            let value = 0;</span>
<a href="#l46.163"></a><span id="l46.163" class="difflineminus">-            switch (column.type) {</span>
<a href="#l46.164"></a><span id="l46.164" class="difflineminus">-              case TYPE_INT_32:</span>
<a href="#l46.165"></a><span id="l46.165" class="difflineminus">-                value = row.getInt32(i);</span>
<a href="#l46.166"></a><span id="l46.166" class="difflineminus">-              break;</span>
<a href="#l46.167"></a><span id="l46.167" class="difflineminus">-              case TYPE_DOUBLE:</span>
<a href="#l46.168"></a><span id="l46.168" class="difflineminus">-                value = row.getDouble(i);</span>
<a href="#l46.169"></a><span id="l46.169" class="difflineminus">-              break;</span>
<a href="#l46.170"></a><span id="l46.170" class="difflineminus">-              case TYPE_STRING:</span>
<a href="#l46.171"></a><span id="l46.171" class="difflineminus">-                value = sanitizeString(row.getUTF8String(i));</span>
<a href="#l46.172"></a><span id="l46.172" class="difflineminus">-              break;</span>
<a href="#l46.173"></a><span id="l46.173" class="difflineminus">-            }</span>
<a href="#l46.174"></a><span id="l46.174" class="difflineminus">-            newRecord.push(value);</span>
<a href="#l46.175"></a><span id="l46.175" class="difflineminus">-          }</span>
<a href="#l46.176"></a><span id="l46.176" class="difflineminus">-          records.push(newRecord);</span>
<a href="#l46.177"></a><span id="l46.177" class="difflineminus">-        }</span>
<a href="#l46.178"></a><span id="l46.178" class="difflineminus">-      },</span>
<a href="#l46.179"></a><span id="l46.179" class="difflineminus">-      handleError: function(aError) {</span>
<a href="#l46.180"></a><span id="l46.180" class="difflineminus">-        callback(records);</span>
<a href="#l46.181"></a><span id="l46.181" class="difflineminus">-      },</span>
<a href="#l46.182"></a><span id="l46.182" class="difflineminus">-</span>
<a href="#l46.183"></a><span id="l46.183" class="difflineminus">-      handleCompletion: function(aReason) {</span>
<a href="#l46.184"></a><span id="l46.184" class="difflineminus">-        callback(records);</span>
<a href="#l46.185"></a><span id="l46.185" class="difflineminus">-      }</span>
<a href="#l46.186"></a><span id="l46.186" class="difflineminus">-    });</span>
<a href="#l46.187"></a><span id="l46.187" class="difflineminus">-    selStmt.finalize();</span>
<a href="#l46.188"></a><span id="l46.188" class="difflineminus">-  },</span>
<a href="#l46.189"></a><span id="l46.189" class="difflineminus">-</span>
<a href="#l46.190"></a><span id="l46.190" class="difflineminus">-  getAllDataAsJSON: function EDS_getAllDataAsJSON( useDisplayValues, callback ) {</span>
<a href="#l46.191"></a><span id="l46.191" class="difflineminus">-    /* if useDisplayValues is true, the values in the returned JSON are translated to</span>
<a href="#l46.192"></a><span id="l46.192" class="difflineminus">-     * their human-readable equivalents, using the mechanism provided in the columns</span>
<a href="#l46.193"></a><span id="l46.193" class="difflineminus">-     * set.  If it's false, the values in the returned JSON are straight numerical</span>
<a href="#l46.194"></a><span id="l46.194" class="difflineminus">-     * values. */</span>
<a href="#l46.195"></a><span id="l46.195" class="difflineminus">-</span>
<a href="#l46.196"></a><span id="l46.196" class="difflineminus">-    // Note this works without knowing what the schema is</span>
<a href="#l46.197"></a><span id="l46.197" class="difflineminus">-    let selectSql = &quot;SELECT * FROM &quot; + this._tableName;</span>
<a href="#l46.198"></a><span id="l46.198" class="difflineminus">-    let selStmt = this._createStatement(selectSql);</span>
<a href="#l46.199"></a><span id="l46.199" class="difflineminus">-    let records = [];</span>
<a href="#l46.200"></a><span id="l46.200" class="difflineminus">-    let self = this;</span>
<a href="#l46.201"></a><span id="l46.201" class="difflineminus">-    let numCols = selStmt.columnCount;</span>
<a href="#l46.202"></a><span id="l46.202" class="difflineminus">-</span>
<a href="#l46.203"></a><span id="l46.203" class="difflineminus">-    selStmt.executeAsync({</span>
<a href="#l46.204"></a><span id="l46.204" class="difflineminus">-      handleResult: function(aResultSet) {</span>
<a href="#l46.205"></a><span id="l46.205" class="difflineminus">-        for (let row = aResultSet.getNextRow(); row;</span>
<a href="#l46.206"></a><span id="l46.206" class="difflineminus">-             row = aResultSet.getNextRow()) {</span>
<a href="#l46.207"></a><span id="l46.207" class="difflineminus">-          let newRecord = {};</span>
<a href="#l46.208"></a><span id="l46.208" class="difflineminus">-          for (let i = 0; i &lt; numCols; i++) {</span>
<a href="#l46.209"></a><span id="l46.209" class="difflineminus">-            let column = self._columns[i];</span>
<a href="#l46.210"></a><span id="l46.210" class="difflineminus">-            //let value = row.getResultByIndex(i);</span>
<a href="#l46.211"></a><span id="l46.211" class="difflineminus">-            let value = 0;</span>
<a href="#l46.212"></a><span id="l46.212" class="difflineminus">-            switch (column.type) {</span>
<a href="#l46.213"></a><span id="l46.213" class="difflineminus">-              case TYPE_INT_32:</span>
<a href="#l46.214"></a><span id="l46.214" class="difflineminus">-                value = row.getInt32(i);</span>
<a href="#l46.215"></a><span id="l46.215" class="difflineminus">-              break;</span>
<a href="#l46.216"></a><span id="l46.216" class="difflineminus">-              case TYPE_DOUBLE:</span>
<a href="#l46.217"></a><span id="l46.217" class="difflineminus">-                value = row.getDouble(i);</span>
<a href="#l46.218"></a><span id="l46.218" class="difflineminus">-              break;</span>
<a href="#l46.219"></a><span id="l46.219" class="difflineminus">-              case TYPE_STRING:</span>
<a href="#l46.220"></a><span id="l46.220" class="difflineminus">-                value = sanitizeString(row.getUTF8String(i));</span>
<a href="#l46.221"></a><span id="l46.221" class="difflineminus">-              break;</span>
<a href="#l46.222"></a><span id="l46.222" class="difflineminus">-            }</span>
<a href="#l46.223"></a><span id="l46.223" class="difflineminus">-            /* The column may have a property called displayValue, which can be either</span>
<a href="#l46.224"></a><span id="l46.224" class="difflineminus">-             * a function returning a string or an array of strings.  If we're called</span>
<a href="#l46.225"></a><span id="l46.225" class="difflineminus">-             * with useDisplayValues, then take the raw numeric value and either use it as</span>
<a href="#l46.226"></a><span id="l46.226" class="difflineminus">-             * an index to the array of strings or use it as input to the function in order</span>
<a href="#l46.227"></a><span id="l46.227" class="difflineminus">-             * to get the human-readable display name of the value. */</span>
<a href="#l46.228"></a><span id="l46.228" class="difflineminus">-            if (useDisplayValues &amp;&amp; column.displayValue != undefined) {</span>
<a href="#l46.229"></a><span id="l46.229" class="difflineminus">-              if (typeof( column.displayValue) == &quot;function&quot;) {</span>
<a href="#l46.230"></a><span id="l46.230" class="difflineminus">-                newRecord[column.property] = column.displayValue(value);</span>
<a href="#l46.231"></a><span id="l46.231" class="difflineminus">-              } else {</span>
<a href="#l46.232"></a><span id="l46.232" class="difflineminus">-                newRecord[column.property] = column.displayValue[value];</span>
<a href="#l46.233"></a><span id="l46.233" class="difflineminus">-              }</span>
<a href="#l46.234"></a><span id="l46.234" class="difflineminus">-            } else {</span>
<a href="#l46.235"></a><span id="l46.235" class="difflineminus">-              newRecord[column.property] = value;</span>
<a href="#l46.236"></a><span id="l46.236" class="difflineminus">-            }</span>
<a href="#l46.237"></a><span id="l46.237" class="difflineminus">-          }</span>
<a href="#l46.238"></a><span id="l46.238" class="difflineminus">-          records.push(newRecord);</span>
<a href="#l46.239"></a><span id="l46.239" class="difflineminus">-        }</span>
<a href="#l46.240"></a><span id="l46.240" class="difflineminus">-      },</span>
<a href="#l46.241"></a><span id="l46.241" class="difflineminus">-      handleError: function(aError) {</span>
<a href="#l46.242"></a><span id="l46.242" class="difflineminus">-        callback(records);</span>
<a href="#l46.243"></a><span id="l46.243" class="difflineminus">-      },</span>
<a href="#l46.244"></a><span id="l46.244" class="difflineminus">-</span>
<a href="#l46.245"></a><span id="l46.245" class="difflineminus">-      handleCompletion: function(aReason) {</span>
<a href="#l46.246"></a><span id="l46.246" class="difflineminus">-        callback(records);</span>
<a href="#l46.247"></a><span id="l46.247" class="difflineminus">-      }</span>
<a href="#l46.248"></a><span id="l46.248" class="difflineminus">-    });</span>
<a href="#l46.249"></a><span id="l46.249" class="difflineminus">-    selStmt.finalize();</span>
<a href="#l46.250"></a><span id="l46.250" class="difflineminus">-  },</span>
<a href="#l46.251"></a><span id="l46.251" class="difflineminus">-</span>
<a href="#l46.252"></a><span id="l46.252" class="difflineminus">-  getExceptionsAsJson: function(callback) {</span>
<a href="#l46.253"></a><span id="l46.253" class="difflineminus">-    let selectSql = &quot;SELECT * FROM &quot; + EXCEPTION_TABLE_NAME;</span>
<a href="#l46.254"></a><span id="l46.254" class="difflineminus">-    let selStmt = this._createStatement(selectSql);</span>
<a href="#l46.255"></a><span id="l46.255" class="difflineminus">-    let records = [];</span>
<a href="#l46.256"></a><span id="l46.256" class="difflineminus">-    let self = this;</span>
<a href="#l46.257"></a><span id="l46.257" class="difflineminus">-</span>
<a href="#l46.258"></a><span id="l46.258" class="difflineminus">-    selStmt.executeAsync({</span>
<a href="#l46.259"></a><span id="l46.259" class="difflineminus">-      handleResult: function(aResultSet) {</span>
<a href="#l46.260"></a><span id="l46.260" class="difflineminus">-        for (let row = aResultSet.getNextRow(); row;</span>
<a href="#l46.261"></a><span id="l46.261" class="difflineminus">-             row = aResultSet.getNextRow()) {</span>
<a href="#l46.262"></a><span id="l46.262" class="difflineminus">-          records.push({ time: row.getDouble(0),</span>
<a href="#l46.263"></a><span id="l46.263" class="difflineminus">-                         exception: row.getString(1)});</span>
<a href="#l46.264"></a><span id="l46.264" class="difflineminus">-        }</span>
<a href="#l46.265"></a><span id="l46.265" class="difflineminus">-      },</span>
<a href="#l46.266"></a><span id="l46.266" class="difflineminus">-      handleError: function(aError) {</span>
<a href="#l46.267"></a><span id="l46.267" class="difflineminus">-        callback(records);</span>
<a href="#l46.268"></a><span id="l46.268" class="difflineminus">-      },</span>
<a href="#l46.269"></a><span id="l46.269" class="difflineminus">-      handleCompletion: function(aReason) {</span>
<a href="#l46.270"></a><span id="l46.270" class="difflineminus">-        callback(records);</span>
<a href="#l46.271"></a><span id="l46.271" class="difflineminus">-      }</span>
<a href="#l46.272"></a><span id="l46.272" class="difflineminus">-    });</span>
<a href="#l46.273"></a><span id="l46.273" class="difflineminus">-  },</span>
<a href="#l46.274"></a><span id="l46.274" class="difflineminus">-</span>
<a href="#l46.275"></a><span id="l46.275" class="difflineminus">-  wipeAllData: function EDS_wipeAllData(callback) {</span>
<a href="#l46.276"></a><span id="l46.276" class="difflineminus">-    // Wipe both the data table and the exception table; call callback when both</span>
<a href="#l46.277"></a><span id="l46.277" class="difflineminus">-    // are wiped.</span>
<a href="#l46.278"></a><span id="l46.278" class="difflineminus">-    let logger = Log4Moz.repository.getLogger(&quot;TestPilot.Database&quot;);</span>
<a href="#l46.279"></a><span id="l46.279" class="difflineminus">-    logger.trace(&quot;ExperimentDataStore.wipeAllData called.\n&quot;);</span>
<a href="#l46.280"></a><span id="l46.280" class="difflineminus">-    let wipeDataStmt = this._createStatement(&quot;DELETE FROM &quot; + this._tableName);</span>
<a href="#l46.281"></a><span id="l46.281" class="difflineminus">-    let wipeExcpStmt = this._createStatement(&quot;DELETE FROM &quot; + EXCEPTION_TABLE_NAME);</span>
<a href="#l46.282"></a><span id="l46.282" class="difflineminus">-</span>
<a href="#l46.283"></a><span id="l46.283" class="difflineminus">-    let numberWiped = 0;</span>
<a href="#l46.284"></a><span id="l46.284" class="difflineminus">-    let onComplete = function() {</span>
<a href="#l46.285"></a><span id="l46.285" class="difflineminus">-      numberWiped ++;</span>
<a href="#l46.286"></a><span id="l46.286" class="difflineminus">-      if (numberWiped == 2 &amp;&amp; callback) {</span>
<a href="#l46.287"></a><span id="l46.287" class="difflineminus">-        callback();</span>
<a href="#l46.288"></a><span id="l46.288" class="difflineminus">-      }</span>
<a href="#l46.289"></a><span id="l46.289" class="difflineminus">-    };</span>
<a href="#l46.290"></a><span id="l46.290" class="difflineminus">-    wipeDataStmt.executeAsync({</span>
<a href="#l46.291"></a><span id="l46.291" class="difflineminus">-      handleResult: function(aResultSet) {},</span>
<a href="#l46.292"></a><span id="l46.292" class="difflineminus">-      handleError: function(aError) { onComplete(); },</span>
<a href="#l46.293"></a><span id="l46.293" class="difflineminus">-      handleCompletion: function(aReason) {</span>
<a href="#l46.294"></a><span id="l46.294" class="difflineminus">-        if (aReason == Ci.mozIStorageStatementCallback.REASON_FINISHED) {</span>
<a href="#l46.295"></a><span id="l46.295" class="difflineminus">-          logger.trace(&quot;ExperimentDataStore.wipeAllData complete.\n&quot;);</span>
<a href="#l46.296"></a><span id="l46.296" class="difflineminus">-        }</span>
<a href="#l46.297"></a><span id="l46.297" class="difflineminus">-        onComplete();</span>
<a href="#l46.298"></a><span id="l46.298" class="difflineminus">-      }</span>
<a href="#l46.299"></a><span id="l46.299" class="difflineminus">-    });</span>
<a href="#l46.300"></a><span id="l46.300" class="difflineminus">-    wipeExcpStmt.executeAsync({</span>
<a href="#l46.301"></a><span id="l46.301" class="difflineminus">-      handleResult: function(aResultSet) {},</span>
<a href="#l46.302"></a><span id="l46.302" class="difflineminus">-      handleError: function(aError) {  onComplete(); },</span>
<a href="#l46.303"></a><span id="l46.303" class="difflineminus">-      handleCompletion: function(aReason) { onComplete(); }</span>
<a href="#l46.304"></a><span id="l46.304" class="difflineminus">-    });</span>
<a href="#l46.305"></a><span id="l46.305" class="difflineminus">-    wipeDataStmt.finalize();</span>
<a href="#l46.306"></a><span id="l46.306" class="difflineminus">-    wipeExcpStmt.finalize();</span>
<a href="#l46.307"></a><span id="l46.307" class="difflineminus">-  },</span>
<a href="#l46.308"></a><span id="l46.308" class="difflineminus">-</span>
<a href="#l46.309"></a><span id="l46.309" class="difflineminus">-  nukeTable: function EDS_nukeTable() {</span>
<a href="#l46.310"></a><span id="l46.310" class="difflineminus">-    // Should never be called, except if schema needs to be changed</span>
<a href="#l46.311"></a><span id="l46.311" class="difflineminus">-    // during debugging/development.</span>
<a href="#l46.312"></a><span id="l46.312" class="difflineminus">-    let nuke = this._createStatement(&quot;DROP TABLE &quot; + this._tableName);</span>
<a href="#l46.313"></a><span id="l46.313" class="difflineminus">-    nuke.executeAsync();</span>
<a href="#l46.314"></a><span id="l46.314" class="difflineminus">-    nuke.finalize();</span>
<a href="#l46.315"></a><span id="l46.315" class="difflineminus">-  },</span>
<a href="#l46.316"></a><span id="l46.316" class="difflineminus">-</span>
<a href="#l46.317"></a><span id="l46.317" class="difflineminus">-  haveData: function EDS_haveData(callback) {</span>
<a href="#l46.318"></a><span id="l46.318" class="difflineminus">-    let countSql = &quot;SELECT * FROM &quot; + this._tableName;</span>
<a href="#l46.319"></a><span id="l46.319" class="difflineminus">-    let countStmt = this._createStatement(countSql);</span>
<a href="#l46.320"></a><span id="l46.320" class="difflineminus">-    let hasData = false;</span>
<a href="#l46.321"></a><span id="l46.321" class="difflineminus">-    countStmt.executeAsync({</span>
<a href="#l46.322"></a><span id="l46.322" class="difflineminus">-      handleResult: function(aResultSet) {</span>
<a href="#l46.323"></a><span id="l46.323" class="difflineminus">-        if (aResultSet.getNextRow()) {</span>
<a href="#l46.324"></a><span id="l46.324" class="difflineminus">-          hasData = true;</span>
<a href="#l46.325"></a><span id="l46.325" class="difflineminus">-        }</span>
<a href="#l46.326"></a><span id="l46.326" class="difflineminus">-      },</span>
<a href="#l46.327"></a><span id="l46.327" class="difflineminus">-</span>
<a href="#l46.328"></a><span id="l46.328" class="difflineminus">-      handleError: function(aError) {</span>
<a href="#l46.329"></a><span id="l46.329" class="difflineminus">-        callback(false);</span>
<a href="#l46.330"></a><span id="l46.330" class="difflineminus">-      },</span>
<a href="#l46.331"></a><span id="l46.331" class="difflineminus">-</span>
<a href="#l46.332"></a><span id="l46.332" class="difflineminus">-      handleCompletion: function(aReason) {</span>
<a href="#l46.333"></a><span id="l46.333" class="difflineminus">-        if (aReason == Ci.mozIStorageStatementCallback.REASON_FINISHED &amp;&amp;</span>
<a href="#l46.334"></a><span id="l46.334" class="difflineminus">-            hasData) {</span>
<a href="#l46.335"></a><span id="l46.335" class="difflineminus">-          callback(true);</span>
<a href="#l46.336"></a><span id="l46.336" class="difflineminus">-        } else {</span>
<a href="#l46.337"></a><span id="l46.337" class="difflineminus">-          callback(false);</span>
<a href="#l46.338"></a><span id="l46.338" class="difflineminus">-        }</span>
<a href="#l46.339"></a><span id="l46.339" class="difflineminus">-      }</span>
<a href="#l46.340"></a><span id="l46.340" class="difflineminus">-    });</span>
<a href="#l46.341"></a><span id="l46.341" class="difflineminus">-    countStmt.finalize();</span>
<a href="#l46.342"></a><span id="l46.342" class="difflineminus">-  },</span>
<a href="#l46.343"></a><span id="l46.343" class="difflineminus">-</span>
<a href="#l46.344"></a><span id="l46.344" class="difflineminus">-  getHumanReadableColumnNames: function EDS_getHumanReadableColumnNames() {</span>
<a href="#l46.345"></a><span id="l46.345" class="difflineminus">-    let i;</span>
<a href="#l46.346"></a><span id="l46.346" class="difflineminus">-    return [ this._columns[i].displayName for (i in this._columns) ];</span>
<a href="#l46.347"></a><span id="l46.347" class="difflineminus">-  },</span>
<a href="#l46.348"></a><span id="l46.348" class="difflineminus">-</span>
<a href="#l46.349"></a><span id="l46.349" class="difflineminus">-  getPropertyNames: function EDS_getPropertyNames() {</span>
<a href="#l46.350"></a><span id="l46.350" class="difflineminus">-    let i;</span>
<a href="#l46.351"></a><span id="l46.351" class="difflineminus">-    return [ this._columns[i].property for (i in this._columns) ];</span>
<a href="#l46.352"></a><span id="l46.352" class="difflineminus">-  }</span>
<a href="#l46.353"></a><span id="l46.353" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1">deleted file mode 100644</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/feedback.js</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineplus">+++ /dev/null</span>
<a href="#l47.4"></a><span id="l47.4" class="difflineat">@@ -1,121 +0,0 @@</span>
<a href="#l47.5"></a><span id="l47.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l47.6"></a><span id="l47.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l47.7"></a><span id="l47.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l47.8"></a><span id="l47.8" class="difflineminus">-</span>
<a href="#l47.9"></a><span id="l47.9" class="difflineminus">-EXPORTED_SYMBOLS = [&quot;FeedbackManager&quot;];</span>
<a href="#l47.10"></a><span id="l47.10" class="difflineminus">-</span>
<a href="#l47.11"></a><span id="l47.11" class="difflineminus">-const Cc = Components.classes;</span>
<a href="#l47.12"></a><span id="l47.12" class="difflineminus">-const Ci = Components.interfaces;</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineminus">-</span>
<a href="#l47.14"></a><span id="l47.14" class="difflineminus">-var FeedbackManager = {</span>
<a href="#l47.15"></a><span id="l47.15" class="difflineminus">-  _lastVisitedUrl: null,</span>
<a href="#l47.16"></a><span id="l47.16" class="difflineminus">-</span>
<a href="#l47.17"></a><span id="l47.17" class="difflineminus">-  __prefs: null,</span>
<a href="#l47.18"></a><span id="l47.18" class="difflineminus">-  get _prefs() {</span>
<a href="#l47.19"></a><span id="l47.19" class="difflineminus">-    this.__prefs = Cc[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l47.20"></a><span id="l47.20" class="difflineminus">-      .getService(Ci.nsIPrefBranch);</span>
<a href="#l47.21"></a><span id="l47.21" class="difflineminus">-    return this.__prefs;</span>
<a href="#l47.22"></a><span id="l47.22" class="difflineminus">-  },</span>
<a href="#l47.23"></a><span id="l47.23" class="difflineminus">-</span>
<a href="#l47.24"></a><span id="l47.24" class="difflineminus">-  _happyUrl: null,</span>
<a href="#l47.25"></a><span id="l47.25" class="difflineminus">-  get happyUrl() {</span>
<a href="#l47.26"></a><span id="l47.26" class="difflineminus">-    if (!this._happyUrl) {</span>
<a href="#l47.27"></a><span id="l47.27" class="difflineminus">-      this._happyUrl = this._prefs.getCharPref(&quot;extensions.input.happyURL&quot;);</span>
<a href="#l47.28"></a><span id="l47.28" class="difflineminus">-    }</span>
<a href="#l47.29"></a><span id="l47.29" class="difflineminus">-    return this._happyUrl;</span>
<a href="#l47.30"></a><span id="l47.30" class="difflineminus">-  },</span>
<a href="#l47.31"></a><span id="l47.31" class="difflineminus">-</span>
<a href="#l47.32"></a><span id="l47.32" class="difflineminus">-  _sadUrl: null,</span>
<a href="#l47.33"></a><span id="l47.33" class="difflineminus">-  get sadUrl() {</span>
<a href="#l47.34"></a><span id="l47.34" class="difflineminus">-    if (!this._sadUrl) {</span>
<a href="#l47.35"></a><span id="l47.35" class="difflineminus">-      this._sadUrl = this._prefs.getCharPref(&quot;extensions.input.sadURL&quot;);</span>
<a href="#l47.36"></a><span id="l47.36" class="difflineminus">-    }</span>
<a href="#l47.37"></a><span id="l47.37" class="difflineminus">-    return this._sadUrl;</span>
<a href="#l47.38"></a><span id="l47.38" class="difflineminus">-  },</span>
<a href="#l47.39"></a><span id="l47.39" class="difflineminus">-</span>
<a href="#l47.40"></a><span id="l47.40" class="difflineminus">-  _brokenUrl: null,</span>
<a href="#l47.41"></a><span id="l47.41" class="difflineminus">-  get brokenUrl() {</span>
<a href="#l47.42"></a><span id="l47.42" class="difflineminus">-    if (!this._brokenUrl) {</span>
<a href="#l47.43"></a><span id="l47.43" class="difflineminus">-      this._brokenUrl = this._prefs.getCharPref(&quot;extensions.input.brokenURL&quot;);</span>
<a href="#l47.44"></a><span id="l47.44" class="difflineminus">-    }</span>
<a href="#l47.45"></a><span id="l47.45" class="difflineminus">-    return this._brokenUrl;</span>
<a href="#l47.46"></a><span id="l47.46" class="difflineminus">-  },</span>
<a href="#l47.47"></a><span id="l47.47" class="difflineminus">-</span>
<a href="#l47.48"></a><span id="l47.48" class="difflineminus">-  _ideaUrl: null,</span>
<a href="#l47.49"></a><span id="l47.49" class="difflineminus">-  get ideaUrl() {</span>
<a href="#l47.50"></a><span id="l47.50" class="difflineminus">-    if (!this._ideaUrl) {</span>
<a href="#l47.51"></a><span id="l47.51" class="difflineminus">-      this._ideaUrl = this._prefs.getCharPref(&quot;extensions.input.ideaURL&quot;);</span>
<a href="#l47.52"></a><span id="l47.52" class="difflineminus">-    }</span>
<a href="#l47.53"></a><span id="l47.53" class="difflineminus">-    return this._ideaUrl;</span>
<a href="#l47.54"></a><span id="l47.54" class="difflineminus">-  },</span>
<a href="#l47.55"></a><span id="l47.55" class="difflineminus">-</span>
<a href="#l47.56"></a><span id="l47.56" class="difflineminus">-  getFeedbackUrl: function FeedbackManager_getFeedbackUrl(menuItemChosen) {</span>
<a href="#l47.57"></a><span id="l47.57" class="difflineminus">-    switch(menuItemChosen) {</span>
<a href="#l47.58"></a><span id="l47.58" class="difflineminus">-    case &quot;happy&quot;:</span>
<a href="#l47.59"></a><span id="l47.59" class="difflineminus">-      return this.happyUrl;</span>
<a href="#l47.60"></a><span id="l47.60" class="difflineminus">-      break;</span>
<a href="#l47.61"></a><span id="l47.61" class="difflineminus">-    case &quot;sad&quot;:</span>
<a href="#l47.62"></a><span id="l47.62" class="difflineminus">-      return this.sadUrl;</span>
<a href="#l47.63"></a><span id="l47.63" class="difflineminus">-      break;</span>
<a href="#l47.64"></a><span id="l47.64" class="difflineminus">-    case &quot;broken&quot;:</span>
<a href="#l47.65"></a><span id="l47.65" class="difflineminus">-      return this.brokenUrl;</span>
<a href="#l47.66"></a><span id="l47.66" class="difflineminus">-      break;</span>
<a href="#l47.67"></a><span id="l47.67" class="difflineminus">-    case &quot;idea&quot;:</span>
<a href="#l47.68"></a><span id="l47.68" class="difflineminus">-      return this.ideaUrl;</span>
<a href="#l47.69"></a><span id="l47.69" class="difflineminus">-      break;</span>
<a href="#l47.70"></a><span id="l47.70" class="difflineminus">-    default:</span>
<a href="#l47.71"></a><span id="l47.71" class="difflineminus">-      return null;</span>
<a href="#l47.72"></a><span id="l47.72" class="difflineminus">-      break;</span>
<a href="#l47.73"></a><span id="l47.73" class="difflineminus">-    }</span>
<a href="#l47.74"></a><span id="l47.74" class="difflineminus">-  },</span>
<a href="#l47.75"></a><span id="l47.75" class="difflineminus">-</span>
<a href="#l47.76"></a><span id="l47.76" class="difflineminus">-  isInputUrl: function FeedbackManager_isInputUrl(url) {</span>
<a href="#l47.77"></a><span id="l47.77" class="difflineminus">-    /* Return true if the URL belongs to one of the pages of the Input website.  We can</span>
<a href="#l47.78"></a><span id="l47.78" class="difflineminus">-     * identify these by looking for a domain of input.mozilla.com and a page name ending</span>
<a href="#l47.79"></a><span id="l47.79" class="difflineminus">-     * in 'feedback', 'happy', or 'sad'.</span>
<a href="#l47.80"></a><span id="l47.80" class="difflineminus">-     */</span>
<a href="#l47.81"></a><span id="l47.81" class="difflineminus">-    let ioService = Cc[&quot;@mozilla.org/network/io-service;1&quot;]</span>
<a href="#l47.82"></a><span id="l47.82" class="difflineminus">-      .getService(Ci.nsIIOService);</span>
<a href="#l47.83"></a><span id="l47.83" class="difflineminus">-    try {</span>
<a href="#l47.84"></a><span id="l47.84" class="difflineminus">-      let uri = ioService.newURI(url, null, null);</span>
<a href="#l47.85"></a><span id="l47.85" class="difflineminus">-      let path = uri.path;</span>
<a href="#l47.86"></a><span id="l47.86" class="difflineminus">-      if (uri.host == &quot;input.mozilla.com&quot;) {</span>
<a href="#l47.87"></a><span id="l47.87" class="difflineminus">-        if (path.indexOf(&quot;feedback&quot;) &gt; -1 || path.indexOf(&quot;happy&quot;) &gt; -1 || path.indexOf(&quot;sad&quot;) &gt; -1) {</span>
<a href="#l47.88"></a><span id="l47.88" class="difflineminus">-          return true;</span>
<a href="#l47.89"></a><span id="l47.89" class="difflineminus">-        }</span>
<a href="#l47.90"></a><span id="l47.90" class="difflineminus">-      }</span>
<a href="#l47.91"></a><span id="l47.91" class="difflineminus">-    } catch(e) {</span>
<a href="#l47.92"></a><span id="l47.92" class="difflineminus">-      /* newURI throws an exception if we try to parse urls like &quot;about:config&quot;.  (Bug 644582)</span>
<a href="#l47.93"></a><span id="l47.93" class="difflineminus">-       * Those are not the urls we're looking for anyway. */</span>
<a href="#l47.94"></a><span id="l47.94" class="difflineminus">-      return false;</span>
<a href="#l47.95"></a><span id="l47.95" class="difflineminus">-    }</span>
<a href="#l47.96"></a><span id="l47.96" class="difflineminus">-    return false;</span>
<a href="#l47.97"></a><span id="l47.97" class="difflineminus">-  },</span>
<a href="#l47.98"></a><span id="l47.98" class="difflineminus">-</span>
<a href="#l47.99"></a><span id="l47.99" class="difflineminus">-  setCurrUrl: function FeedbackManager_setCurrUrl(url) {</span>
<a href="#l47.100"></a><span id="l47.100" class="difflineminus">-    this._lastVisitedUrl = url;</span>
<a href="#l47.101"></a><span id="l47.101" class="difflineminus">-  },</span>
<a href="#l47.102"></a><span id="l47.102" class="difflineminus">-</span>
<a href="#l47.103"></a><span id="l47.103" class="difflineminus">-  fillInFeedbackPage: function FeedbackManager_fifp(url, window) {</span>
<a href="#l47.104"></a><span id="l47.104" class="difflineminus">-    /* If the user activated the happy or sad feedback feature, a page</span>
<a href="#l47.105"></a><span id="l47.105" class="difflineminus">-     * gets loaded containing input fields - either a single one containing id = &quot;id_url&quot;,</span>
<a href="#l47.106"></a><span id="l47.106" class="difflineminus">-     * or (potentially multiple) with class = &quot;url&quot;.  Prefill all matching fields in with</span>
<a href="#l47.107"></a><span id="l47.107" class="difflineminus">-     * the referring URL.</span>
<a href="#l47.108"></a><span id="l47.108" class="difflineminus">-     */</span>
<a href="#l47.109"></a><span id="l47.109" class="difflineminus">-    if (this.isInputUrl(url)) {</span>
<a href="#l47.110"></a><span id="l47.110" class="difflineminus">-      if (this._lastVisitedUrl) {</span>
<a href="#l47.111"></a><span id="l47.111" class="difflineminus">-        let tabbrowser = window.getBrowser();</span>
<a href="#l47.112"></a><span id="l47.112" class="difflineminus">-        let currentBrowser = tabbrowser.selectedBrowser;</span>
<a href="#l47.113"></a><span id="l47.113" class="difflineminus">-        let document = currentBrowser.contentDocument;</span>
<a href="#l47.114"></a><span id="l47.114" class="difflineminus">-        let fields = document.getElementsByClassName(&quot;url&quot;);</span>
<a href="#l47.115"></a><span id="l47.115" class="difflineminus">-        for (let i = 0; i &lt; fields.length; i++) {</span>
<a href="#l47.116"></a><span id="l47.116" class="difflineminus">-          fields[i].value = this._lastVisitedUrl;</span>
<a href="#l47.117"></a><span id="l47.117" class="difflineminus">-        }</span>
<a href="#l47.118"></a><span id="l47.118" class="difflineminus">-        let field = document.getElementById(&quot;id_url&quot;);</span>
<a href="#l47.119"></a><span id="l47.119" class="difflineminus">-        if (field) {</span>
<a href="#l47.120"></a><span id="l47.120" class="difflineminus">-           field.value = this._lastVisitedUrl;</span>
<a href="#l47.121"></a><span id="l47.121" class="difflineminus">-        }</span>
<a href="#l47.122"></a><span id="l47.122" class="difflineminus">-      }</span>
<a href="#l47.123"></a><span id="l47.123" class="difflineminus">-    }</span>
<a href="#l47.124"></a><span id="l47.124" class="difflineminus">-  }</span>
<a href="#l47.125"></a><span id="l47.125" class="difflineminus">-};</span>
<a href="#l47.126"></a><span id="l47.126">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1">deleted file mode 100644</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/interface.js</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineplus">+++ /dev/null</span>
<a href="#l48.4"></a><span id="l48.4" class="difflineat">@@ -1,214 +0,0 @@</span>
<a href="#l48.5"></a><span id="l48.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l48.6"></a><span id="l48.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l48.7"></a><span id="l48.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l48.8"></a><span id="l48.8" class="difflineminus">-</span>
<a href="#l48.9"></a><span id="l48.9" class="difflineminus">-/* Choose correct overlay to apply based on user's update channel setting;</span>
<a href="#l48.10"></a><span id="l48.10" class="difflineminus">- * do any other tweaking to UI needed to work correctly with user's version.</span>
<a href="#l48.11"></a><span id="l48.11" class="difflineminus">- * 1. Fx 3.*, default update channel -&gt; TP icon menu in status bar</span>
<a href="#l48.12"></a><span id="l48.12" class="difflineminus">- * 2. beta update channel -&gt; Feedback button in toolbar, customizable</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineminus">- * 3. Fx 4.*, default update channel -&gt; TP icon in toolbar, doorhanger notifications</span>
<a href="#l48.14"></a><span id="l48.14" class="difflineminus">- */</span>
<a href="#l48.15"></a><span id="l48.15" class="difflineminus">-</span>
<a href="#l48.16"></a><span id="l48.16" class="difflineminus">-// A lot of the stuff that's currently in browser.js can get moved here.</span>
<a href="#l48.17"></a><span id="l48.17" class="difflineminus">-</span>
<a href="#l48.18"></a><span id="l48.18" class="difflineminus">-EXPORTED_SYMBOLS = [&quot;TestPilotUIBuilder&quot;];</span>
<a href="#l48.19"></a><span id="l48.19" class="difflineminus">-</span>
<a href="#l48.20"></a><span id="l48.20" class="difflineminus">-const Cc = Components.classes;</span>
<a href="#l48.21"></a><span id="l48.21" class="difflineminus">-const Ci = Components.interfaces;</span>
<a href="#l48.22"></a><span id="l48.22" class="difflineminus">-const Cu = Components.utils;</span>
<a href="#l48.23"></a><span id="l48.23" class="difflineminus">-const UPDATE_CHANNEL_PREF = &quot;app.update.channel&quot;;</span>
<a href="#l48.24"></a><span id="l48.24" class="difflineminus">-const POPUP_SHOW_ON_NEW = &quot;extensions.testpilot.popup.showOnNewStudy&quot;;</span>
<a href="#l48.25"></a><span id="l48.25" class="difflineminus">-const POPUP_CHECK_INTERVAL = &quot;extensions.testpilot.popup.delayAfterStartup&quot;;</span>
<a href="#l48.26"></a><span id="l48.26" class="difflineminus">-const FENNEC_APP_ID = &quot;{a23983c0-fd0e-11dc-95ff-0800200c9a66}&quot;;</span>
<a href="#l48.27"></a><span id="l48.27" class="difflineminus">-const THUNDERBIRD_APP_ID = &quot;{3550f703-e582-4d05-9a08-453d09bdfdc6}&quot;;</span>
<a href="#l48.28"></a><span id="l48.28" class="difflineminus">-</span>
<a href="#l48.29"></a><span id="l48.29" class="difflineminus">-var TestPilotUIBuilder = {</span>
<a href="#l48.30"></a><span id="l48.30" class="difflineminus">-  get _prefs() {</span>
<a href="#l48.31"></a><span id="l48.31" class="difflineminus">-    delete this._prefs;</span>
<a href="#l48.32"></a><span id="l48.32" class="difflineminus">-    return this._prefs = Cc[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l48.33"></a><span id="l48.33" class="difflineminus">-      .getService(Ci.nsIPrefBranch);</span>
<a href="#l48.34"></a><span id="l48.34" class="difflineminus">-  },</span>
<a href="#l48.35"></a><span id="l48.35" class="difflineminus">-</span>
<a href="#l48.36"></a><span id="l48.36" class="difflineminus">-  get _prefDefaultBranch() {</span>
<a href="#l48.37"></a><span id="l48.37" class="difflineminus">-    delete this._prefDefaultBranch;</span>
<a href="#l48.38"></a><span id="l48.38" class="difflineminus">-    return this._prefDefaultBranch = Cc[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l48.39"></a><span id="l48.39" class="difflineminus">-      .getService(Ci.nsIPrefService).getDefaultBranch(&quot;&quot;);</span>
<a href="#l48.40"></a><span id="l48.40" class="difflineminus">-  },</span>
<a href="#l48.41"></a><span id="l48.41" class="difflineminus">-</span>
<a href="#l48.42"></a><span id="l48.42" class="difflineminus">-  get _comparator() {</span>
<a href="#l48.43"></a><span id="l48.43" class="difflineminus">-    delete this._comparator;</span>
<a href="#l48.44"></a><span id="l48.44" class="difflineminus">-    return this._comparator = Cc[&quot;@mozilla.org/xpcom/version-comparator;1&quot;]</span>
<a href="#l48.45"></a><span id="l48.45" class="difflineminus">-      .getService(Ci.nsIVersionComparator);</span>
<a href="#l48.46"></a><span id="l48.46" class="difflineminus">-  },</span>
<a href="#l48.47"></a><span id="l48.47" class="difflineminus">-</span>
<a href="#l48.48"></a><span id="l48.48" class="difflineminus">-  get _appVersion() {</span>
<a href="#l48.49"></a><span id="l48.49" class="difflineminus">-    delete this._appVersion;</span>
<a href="#l48.50"></a><span id="l48.50" class="difflineminus">-    return this._appVersion = Cc[&quot;@mozilla.org/xre/app-info;1&quot;]</span>
<a href="#l48.51"></a><span id="l48.51" class="difflineminus">-      .getService(Ci.nsIXULAppInfo).version;</span>
<a href="#l48.52"></a><span id="l48.52" class="difflineminus">-  },</span>
<a href="#l48.53"></a><span id="l48.53" class="difflineminus">-</span>
<a href="#l48.54"></a><span id="l48.54" class="difflineminus">-  buildTestPilotInterface: function(currentWindow) {</span>
<a href="#l48.55"></a><span id="l48.55" class="difflineminus">-    // Don't need Feedback button: remove it</span>
<a href="#l48.56"></a><span id="l48.56" class="difflineminus">-    let feedbackButton = currentWindow.document.getElementById(&quot;feedback-menu-button&quot;);</span>
<a href="#l48.57"></a><span id="l48.57" class="difflineminus">-    if (!feedbackButton) {</span>
<a href="#l48.58"></a><span id="l48.58" class="difflineminus">-      let toolbox = currentWindow.document.getElementById(&quot;mail-toolbox&quot;);</span>
<a href="#l48.59"></a><span id="l48.59" class="difflineminus">-      let palette = toolbox.palette;</span>
<a href="#l48.60"></a><span id="l48.60" class="difflineminus">-      feedbackButton = palette.getElementsByAttribute(&quot;id&quot;, &quot;feedback-menu-button&quot;).item(0);</span>
<a href="#l48.61"></a><span id="l48.61" class="difflineminus">-    }</span>
<a href="#l48.62"></a><span id="l48.62" class="difflineminus">-    feedbackButton.parentNode.removeChild(feedbackButton);</span>
<a href="#l48.63"></a><span id="l48.63" class="difflineminus">-</span>
<a href="#l48.64"></a><span id="l48.64" class="difflineminus">-    /* Default prefs for test pilot version - default to NOT notifying user about new</span>
<a href="#l48.65"></a><span id="l48.65" class="difflineminus">-     * studies starting. Note we're setting default values, not current values -- we</span>
<a href="#l48.66"></a><span id="l48.66" class="difflineminus">-     * want these to be overridden by any user set values!!*/</span>
<a href="#l48.67"></a><span id="l48.67" class="difflineminus">-    this._prefDefaultBranch.setBoolPref(POPUP_SHOW_ON_NEW, false);</span>
<a href="#l48.68"></a><span id="l48.68" class="difflineminus">-    this._prefDefaultBranch.setIntPref(POPUP_CHECK_INTERVAL, 180000);</span>
<a href="#l48.69"></a><span id="l48.69" class="difflineminus">-  },</span>
<a href="#l48.70"></a><span id="l48.70" class="difflineminus">-</span>
<a href="#l48.71"></a><span id="l48.71" class="difflineminus">-  buildFeedbackInterface: function(currentWindow) {</span>
<a href="#l48.72"></a><span id="l48.72" class="difflineminus">-    // Until input.mozilla.org works for Thunderbird, just bail out.</span>
<a href="#l48.73"></a><span id="l48.73" class="difflineminus">-    return;</span>
<a href="#l48.74"></a><span id="l48.74" class="difflineminus">-</span>
<a href="#l48.75"></a><span id="l48.75" class="difflineminus">-    /* If this is first run, and it's ffx4 beta version, and the feedback</span>
<a href="#l48.76"></a><span id="l48.76" class="difflineminus">-     * button is not in the expected place, put it there!</span>
<a href="#l48.77"></a><span id="l48.77" class="difflineminus">-     * (copied from MozReporterButtons extension) */</span>
<a href="#l48.78"></a><span id="l48.78" class="difflineminus">-</span>
<a href="#l48.79"></a><span id="l48.79" class="difflineminus">-    /* Check if we've already done this customization -- if not, don't do it</span>
<a href="#l48.80"></a><span id="l48.80" class="difflineminus">-     * again  (don't want to put it back in after user explicitly takes it out-</span>
<a href="#l48.81"></a><span id="l48.81" class="difflineminus">-     * bug 577243 )*/</span>
<a href="#l48.82"></a><span id="l48.82" class="difflineminus">-</span>
<a href="#l48.83"></a><span id="l48.83" class="difflineminus">-    Cu.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l48.84"></a><span id="l48.84" class="difflineminus">-</span>
<a href="#l48.85"></a><span id="l48.85" class="difflineminus">-    let mainToolbar;</span>
<a href="#l48.86"></a><span id="l48.86" class="difflineminus">-    if (TestPilotSetup._appID == THUNDERBIRD_APP_ID)</span>
<a href="#l48.87"></a><span id="l48.87" class="difflineminus">-      mainToolbar = currentWindow.document.getElementById(&quot;mail-bar3&quot;);</span>
<a href="#l48.88"></a><span id="l48.88" class="difflineminus">-    else</span>
<a href="#l48.89"></a><span id="l48.89" class="difflineminus">-      mainToolbar = currentWindow.document.getElementById(&quot;nav-bar&quot;);</span>
<a href="#l48.90"></a><span id="l48.90" class="difflineminus">-    let pref = &quot;extensions.testpilot.alreadyCustomizedToolbar&quot;;</span>
<a href="#l48.91"></a><span id="l48.91" class="difflineminus">-    let alreadyCustomized = this._prefs.getBoolPref(pref);</span>
<a href="#l48.92"></a><span id="l48.92" class="difflineminus">-    let curSet = mainToolbar.currentSet;</span>
<a href="#l48.93"></a><span id="l48.93" class="difflineminus">-</span>
<a href="#l48.94"></a><span id="l48.94" class="difflineminus">-    if (!alreadyCustomized &amp;&amp; (-1 == curSet.indexOf(&quot;feedback-menu-button&quot;))) {</span>
<a href="#l48.95"></a><span id="l48.95" class="difflineminus">-      // place the buttons after the search box.</span>
<a href="#l48.96"></a><span id="l48.96" class="difflineminus">-      let newSet = curSet + &quot;,feedback-menu-button&quot;;</span>
<a href="#l48.97"></a><span id="l48.97" class="difflineminus">-      mainToolbar.setAttribute(&quot;currentset&quot;, newSet);</span>
<a href="#l48.98"></a><span id="l48.98" class="difflineminus">-      mainToolbar.currentSet = newSet;</span>
<a href="#l48.99"></a><span id="l48.99" class="difflineminus">-      currentWindow.document.persist(mainToolbar.id, &quot;currentset&quot;);</span>
<a href="#l48.100"></a><span id="l48.100" class="difflineminus">-      this._prefs.setBoolPref(pref, true);</span>
<a href="#l48.101"></a><span id="l48.101" class="difflineminus">-      // if you don't do the following call, funny things happen.</span>
<a href="#l48.102"></a><span id="l48.102" class="difflineminus">-      try {</span>
<a href="#l48.103"></a><span id="l48.103" class="difflineminus">-        currentWindow.BrowserToolboxCustomizeDone(true);</span>
<a href="#l48.104"></a><span id="l48.104" class="difflineminus">-      } catch (e) {</span>
<a href="#l48.105"></a><span id="l48.105" class="difflineminus">-      }</span>
<a href="#l48.106"></a><span id="l48.106" class="difflineminus">-    }</span>
<a href="#l48.107"></a><span id="l48.107" class="difflineminus">-</span>
<a href="#l48.108"></a><span id="l48.108" class="difflineminus">-    /* Pref defaults for Feedback version: default to notifying user about new</span>
<a href="#l48.109"></a><span id="l48.109" class="difflineminus">-     * studies starting. Note we're setting default values, not current values -- we</span>
<a href="#l48.110"></a><span id="l48.110" class="difflineminus">-     * want these to be overridden by any user set values!!*/</span>
<a href="#l48.111"></a><span id="l48.111" class="difflineminus">-    this._prefDefaultBranch.setBoolPref(POPUP_SHOW_ON_NEW, true);</span>
<a href="#l48.112"></a><span id="l48.112" class="difflineminus">-    this._prefDefaultBranch.setIntPref(POPUP_CHECK_INTERVAL, 600000);</span>
<a href="#l48.113"></a><span id="l48.113" class="difflineminus">-</span>
<a href="#l48.114"></a><span id="l48.114" class="difflineminus">-    // Change the happy/sad labels if necessary</span>
<a href="#l48.115"></a><span id="l48.115" class="difflineminus">-    if (TestPilotSetup._appID == THUNDERBIRD_APP_ID) {</span>
<a href="#l48.116"></a><span id="l48.116" class="difflineminus">-      let happy = currentWindow.document.getElementById(&quot;feedback-menu-happy-button&quot;);</span>
<a href="#l48.117"></a><span id="l48.117" class="difflineminus">-      let sad = currentWindow.document.getElementById(&quot;feedback-menu-sad-button&quot;);</span>
<a href="#l48.118"></a><span id="l48.118" class="difflineminus">-      happy.setAttribute(&quot;label&quot;, happy.getAttribute(&quot;thunderbirdLabel&quot;));</span>
<a href="#l48.119"></a><span id="l48.119" class="difflineminus">-      sad.setAttribute(&quot;label&quot;, sad.getAttribute(&quot;thunderbirdLabel&quot;));</span>
<a href="#l48.120"></a><span id="l48.120" class="difflineminus">-    }</span>
<a href="#l48.121"></a><span id="l48.121" class="difflineminus">-  },</span>
<a href="#l48.122"></a><span id="l48.122" class="difflineminus">-</span>
<a href="#l48.123"></a><span id="l48.123" class="difflineminus">-  channelUsesFeedback: function() {</span>
<a href="#l48.124"></a><span id="l48.124" class="difflineminus">-    // Thunderbird ships on all channels, so just return false.</span>
<a href="#l48.125"></a><span id="l48.125" class="difflineminus">-    return false;</span>
<a href="#l48.126"></a><span id="l48.126" class="difflineminus">-    </span>
<a href="#l48.127"></a><span id="l48.127" class="difflineminus">-    // Beta and aurora channels use feedback interface; nightly and release channels don't.</span>
<a href="#l48.128"></a><span id="l48.128" class="difflineminus">-//    let channel = this._prefDefaultBranch.getCharPref(UPDATE_CHANNEL_PREF);</span>
<a href="#l48.129"></a><span id="l48.129" class="difflineminus">-//    return (channel == &quot;beta&quot;) || (channel == &quot;betatest&quot;) || (channel == &quot;aurora&quot;);</span>
<a href="#l48.130"></a><span id="l48.130" class="difflineminus">-  },</span>
<a href="#l48.131"></a><span id="l48.131" class="difflineminus">-</span>
<a href="#l48.132"></a><span id="l48.132" class="difflineminus">-  hasDoorhangerNotifications: function() {</span>
<a href="#l48.133"></a><span id="l48.133" class="difflineminus">-    // Thunderbird doesn't use the add-on bar (it uses the plain old status</span>
<a href="#l48.134"></a><span id="l48.134" class="difflineminus">-    // bar), and so the doorhanger UI doesn't quite work.</span>
<a href="#l48.135"></a><span id="l48.135" class="difflineminus">-    Cu.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l48.136"></a><span id="l48.136" class="difflineminus">-</span>
<a href="#l48.137"></a><span id="l48.137" class="difflineminus">-    if (TestPilotSetup._appID == THUNDERBIRD_APP_ID)</span>
<a href="#l48.138"></a><span id="l48.138" class="difflineminus">-      return false;</span>
<a href="#l48.139"></a><span id="l48.139" class="difflineminus">-</span>
<a href="#l48.140"></a><span id="l48.140" class="difflineminus">-    try {</span>
<a href="#l48.141"></a><span id="l48.141" class="difflineminus">-      let popupModule = {};</span>
<a href="#l48.142"></a><span id="l48.142" class="difflineminus">-      Components.utils.import(&quot;resource://gre/modules/PopupNotifications.jsm&quot;, popupModule);</span>
<a href="#l48.143"></a><span id="l48.143" class="difflineminus">-      return true;</span>
<a href="#l48.144"></a><span id="l48.144" class="difflineminus">-    } catch (e) {</span>
<a href="#l48.145"></a><span id="l48.145" class="difflineminus">-      return false;</span>
<a href="#l48.146"></a><span id="l48.146" class="difflineminus">-    }</span>
<a href="#l48.147"></a><span id="l48.147" class="difflineminus">-  },</span>
<a href="#l48.148"></a><span id="l48.148" class="difflineminus">-</span>
<a href="#l48.149"></a><span id="l48.149" class="difflineminus">-  buildCorrectInterface: function(currentWindow) {</span>
<a href="#l48.150"></a><span id="l48.150" class="difflineminus">-    /* Apply no overlay to Fennec: */</span>
<a href="#l48.151"></a><span id="l48.151" class="difflineminus">-    Cu.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l48.152"></a><span id="l48.152" class="difflineminus">-</span>
<a href="#l48.153"></a><span id="l48.153" class="difflineminus">-    if (TestPilotSetup._appID == FENNEC_APP_ID) {</span>
<a href="#l48.154"></a><span id="l48.154" class="difflineminus">-      return;</span>
<a href="#l48.155"></a><span id="l48.155" class="difflineminus">-    }</span>
<a href="#l48.156"></a><span id="l48.156" class="difflineminus">-    else if (TestPilotSetup._appID == THUNDERBIRD_APP_ID) {</span>
<a href="#l48.157"></a><span id="l48.157" class="difflineminus">-      // TODO: do something special here, probably</span>
<a href="#l48.158"></a><span id="l48.158" class="difflineminus">-    }</span>
<a href="#l48.159"></a><span id="l48.159" class="difflineminus">-    else {</span>
<a href="#l48.160"></a><span id="l48.160" class="difflineminus">-      let firefoxnav = currentWindow.document.getElementById(&quot;nav-bar&quot;);</span>
<a href="#l48.161"></a><span id="l48.161" class="difflineminus">-      /* This is sometimes called for windows that don't have a navbar - in</span>
<a href="#l48.162"></a><span id="l48.162" class="difflineminus">-       * that case, do nothing. TODO maybe this should be in onWindowLoad?*/</span>
<a href="#l48.163"></a><span id="l48.163" class="difflineminus">-      if (!firefoxnav) {</span>
<a href="#l48.164"></a><span id="l48.164" class="difflineminus">-        return;</span>
<a href="#l48.165"></a><span id="l48.165" class="difflineminus">-      }</span>
<a href="#l48.166"></a><span id="l48.166" class="difflineminus">-    }</span>
<a href="#l48.167"></a><span id="l48.167" class="difflineminus">-</span>
<a href="#l48.168"></a><span id="l48.168" class="difflineminus">-    /* Overlay Feedback XUL if we're in the beta update channel, Test Pilot XUL otherwise.</span>
<a href="#l48.169"></a><span id="l48.169" class="difflineminus">-     * Once the overlay is complete, call buildFeedbackInterface() or buildTestPilotInterface(). */</span>
<a href="#l48.170"></a><span id="l48.170" class="difflineminus">-    let self = this;</span>
<a href="#l48.171"></a><span id="l48.171" class="difflineminus">-    if (this.channelUsesFeedback()) {</span>
<a href="#l48.172"></a><span id="l48.172" class="difflineminus">-      currentWindow.document.loadOverlay(&quot;chrome://testpilot/content/feedback-browser.xul&quot;,</span>
<a href="#l48.173"></a><span id="l48.173" class="difflineminus">-                                  {observe: function(subject, topic, data) {</span>
<a href="#l48.174"></a><span id="l48.174" class="difflineminus">-                                     if (topic == &quot;xul-overlay-merged&quot;) {</span>
<a href="#l48.175"></a><span id="l48.175" class="difflineminus">-                                       self.buildFeedbackInterface(currentWindow);</span>
<a href="#l48.176"></a><span id="l48.176" class="difflineminus">-                                     }</span>
<a href="#l48.177"></a><span id="l48.177" class="difflineminus">-                                   }});</span>
<a href="#l48.178"></a><span id="l48.178" class="difflineminus">-    } else {</span>
<a href="#l48.179"></a><span id="l48.179" class="difflineminus">-      let testPilotOverlay = (this.hasDoorhangerNotifications() ?</span>
<a href="#l48.180"></a><span id="l48.180" class="difflineminus">-                              &quot;chrome://testpilot/content/tp-browser-popupNotifications.xul&quot; :</span>
<a href="#l48.181"></a><span id="l48.181" class="difflineminus">-                              &quot;chrome://testpilot/content/tp-browser-customNotifications.xul&quot;);</span>
<a href="#l48.182"></a><span id="l48.182" class="difflineminus">-      currentWindow.document.loadOverlay(testPilotOverlay,</span>
<a href="#l48.183"></a><span id="l48.183" class="difflineminus">-                                  {observe: function(subject, topic, data) {</span>
<a href="#l48.184"></a><span id="l48.184" class="difflineminus">-                                     if (topic == &quot;xul-overlay-merged&quot;) {</span>
<a href="#l48.185"></a><span id="l48.185" class="difflineminus">-                                       self.buildTestPilotInterface(currentWindow);</span>
<a href="#l48.186"></a><span id="l48.186" class="difflineminus">-                                     }</span>
<a href="#l48.187"></a><span id="l48.187" class="difflineminus">-                                  }});</span>
<a href="#l48.188"></a><span id="l48.188" class="difflineminus">-    }</span>
<a href="#l48.189"></a><span id="l48.189" class="difflineminus">-  },</span>
<a href="#l48.190"></a><span id="l48.190" class="difflineminus">-</span>
<a href="#l48.191"></a><span id="l48.191" class="difflineminus">-  getNotificationManager: function() {</span>
<a href="#l48.192"></a><span id="l48.192" class="difflineminus">-    // If we're on Android, use the Android notification manager!</span>
<a href="#l48.193"></a><span id="l48.193" class="difflineminus">-    let ntfnModule = {};</span>
<a href="#l48.194"></a><span id="l48.194" class="difflineminus">-    Cu.import(&quot;resource://testpilot/modules/notifications.js&quot;, ntfnModule);</span>
<a href="#l48.195"></a><span id="l48.195" class="difflineminus">-    Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l48.196"></a><span id="l48.196" class="difflineminus">-    Cu.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l48.197"></a><span id="l48.197" class="difflineminus">-</span>
<a href="#l48.198"></a><span id="l48.198" class="difflineminus">-    Services.console.logStringMessage(&quot;appID is &quot; + TestPilotSetup._appID);</span>
<a href="#l48.199"></a><span id="l48.199" class="difflineminus">-    if (TestPilotSetup._appID == FENNEC_APP_ID) {</span>
<a href="#l48.200"></a><span id="l48.200" class="difflineminus">-      Services.console.logStringMessage(&quot;making Android Notfn Manager..&quot;);</span>
<a href="#l48.201"></a><span id="l48.201" class="difflineminus">-      return new ntfnModule.AndroidNotificationManager();</span>
<a href="#l48.202"></a><span id="l48.202" class="difflineminus">-    }</span>
<a href="#l48.203"></a><span id="l48.203" class="difflineminus">-</span>
<a href="#l48.204"></a><span id="l48.204" class="difflineminus">-    // Use custom notifications anchored to the Feedback button, if there is a Feedback button</span>
<a href="#l48.205"></a><span id="l48.205" class="difflineminus">-    if (this.channelUsesFeedback()) {</span>
<a href="#l48.206"></a><span id="l48.206" class="difflineminus">-      Services.console.logStringMessage(&quot;making Custom Notfn Manager..&quot;);</span>
<a href="#l48.207"></a><span id="l48.207" class="difflineminus">-      return new ntfnModule.CustomNotificationManager(true);</span>
<a href="#l48.208"></a><span id="l48.208" class="difflineminus">-    }</span>
<a href="#l48.209"></a><span id="l48.209" class="difflineminus">-    // If no feedback button, and popup notifications available, use those</span>
<a href="#l48.210"></a><span id="l48.210" class="difflineminus">-    if (this.hasDoorhangerNotifications()) {</span>
<a href="#l48.211"></a><span id="l48.211" class="difflineminus">-      Services.console.logStringMessage(&quot;making Popup Notfn Manager..&quot;);</span>
<a href="#l48.212"></a><span id="l48.212" class="difflineminus">-      return new ntfnModule.PopupNotificationManager();</span>
<a href="#l48.213"></a><span id="l48.213" class="difflineminus">-    }</span>
<a href="#l48.214"></a><span id="l48.214" class="difflineminus">-    // If neither one is available, use custom notifications anchored to Test Pilot status icon</span>
<a href="#l48.215"></a><span id="l48.215" class="difflineminus">-    Services.console.logStringMessage(&quot;making Custom Notfn Manager..&quot;);</span>
<a href="#l48.216"></a><span id="l48.216" class="difflineminus">-    return new ntfnModule.CustomNotificationManager(false);</span>
<a href="#l48.217"></a><span id="l48.217" class="difflineminus">-  }</span>
<a href="#l48.218"></a><span id="l48.218" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1">deleted file mode 100644</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/jar-code-store.js</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineplus">+++ /dev/null</span>
<a href="#l49.4"></a><span id="l49.4" class="difflineat">@@ -1,226 +0,0 @@</span>
<a href="#l49.5"></a><span id="l49.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l49.6"></a><span id="l49.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l49.7"></a><span id="l49.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l49.8"></a><span id="l49.8" class="difflineminus">-</span>
<a href="#l49.9"></a><span id="l49.9" class="difflineminus">-</span>
<a href="#l49.10"></a><span id="l49.10" class="difflineminus">-function JarStore() {</span>
<a href="#l49.11"></a><span id="l49.11" class="difflineminus">-  try {</span>
<a href="#l49.12"></a><span id="l49.12" class="difflineminus">-  let baseDirName = &quot;TestPilotExperimentFiles&quot;; // this should go in pref?</span>
<a href="#l49.13"></a><span id="l49.13" class="difflineminus">-  this._baseDir = null;</span>
<a href="#l49.14"></a><span id="l49.14" class="difflineminus">-  this._localOverrides = {}; //override with code for debugging purposes</span>
<a href="#l49.15"></a><span id="l49.15" class="difflineminus">-  this._index = {}; // tells us which jar file to look in for each module</span>
<a href="#l49.16"></a><span id="l49.16" class="difflineminus">-  this._lastModified = {}; // tells us when each jar file was last modified</span>
<a href="#l49.17"></a><span id="l49.17" class="difflineminus">-  this._init( baseDirName );</span>
<a href="#l49.18"></a><span id="l49.18" class="difflineminus">-  } catch (e) {</span>
<a href="#l49.19"></a><span id="l49.19" class="difflineminus">-    console.warn(&quot;Error instantiating jar store: &quot; + e);</span>
<a href="#l49.20"></a><span id="l49.20" class="difflineminus">-  }</span>
<a href="#l49.21"></a><span id="l49.21" class="difflineminus">-}</span>
<a href="#l49.22"></a><span id="l49.22" class="difflineminus">-JarStore.prototype = {</span>
<a href="#l49.23"></a><span id="l49.23" class="difflineminus">-</span>
<a href="#l49.24"></a><span id="l49.24" class="difflineminus">-  _init: function( baseDirectory ) {</span>
<a href="#l49.25"></a><span id="l49.25" class="difflineminus">-    let prefs = require(&quot;preferences-service&quot;);</span>
<a href="#l49.26"></a><span id="l49.26" class="difflineminus">-    this._localOverrides = JSON.parse(</span>
<a href="#l49.27"></a><span id="l49.27" class="difflineminus">-      prefs.get(&quot;extensions.testpilot.codeOverride&quot;, &quot;{}&quot;));</span>
<a href="#l49.28"></a><span id="l49.28" class="difflineminus">-</span>
<a href="#l49.29"></a><span id="l49.29" class="difflineminus">-    let dir = Cc[&quot;@mozilla.org/file/directory_service;1&quot;].</span>
<a href="#l49.30"></a><span id="l49.30" class="difflineminus">-      getService(Ci.nsIProperties).get(&quot;ProfD&quot;, Ci.nsIFile);</span>
<a href="#l49.31"></a><span id="l49.31" class="difflineminus">-    dir.append(baseDirectory);</span>
<a href="#l49.32"></a><span id="l49.32" class="difflineminus">-    this._baseDir = dir;</span>
<a href="#l49.33"></a><span id="l49.33" class="difflineminus">-    if( !this._baseDir.exists() || !this._baseDir.isDirectory() ) {</span>
<a href="#l49.34"></a><span id="l49.34" class="difflineminus">-      // if jar storage directory doesn't exist, create it:</span>
<a href="#l49.35"></a><span id="l49.35" class="difflineminus">-      console.info(&quot;Creating: &quot; + this._baseDir.path + &quot;\n&quot;);</span>
<a href="#l49.36"></a><span id="l49.36" class="difflineminus">-      this._baseDir.create(Ci.nsIFile.DIRECTORY_TYPE, 0777);</span>
<a href="#l49.37"></a><span id="l49.37" class="difflineminus">-    } else {</span>
<a href="#l49.38"></a><span id="l49.38" class="difflineminus">-      // Process any jar files already on disk from previous runs:</span>
<a href="#l49.39"></a><span id="l49.39" class="difflineminus">-      // Build lookup index of module-&gt;jar file and modified dates</span>
<a href="#l49.40"></a><span id="l49.40" class="difflineminus">-      let jarFiles = this._baseDir.directoryEntries;</span>
<a href="#l49.41"></a><span id="l49.41" class="difflineminus">-      while(jarFiles.hasMoreElements()) {</span>
<a href="#l49.42"></a><span id="l49.42" class="difflineminus">-        let jarFile = jarFiles.getNext().QueryInterface(Ci.nsIFile);</span>
<a href="#l49.43"></a><span id="l49.43" class="difflineminus">-        // Make sure this is actually a jar file:</span>
<a href="#l49.44"></a><span id="l49.44" class="difflineminus">-        if (jarFile.leafName.indexOf(&quot;.jar&quot;) != jarFile.leafName.length - 4) {</span>
<a href="#l49.45"></a><span id="l49.45" class="difflineminus">-          continue;</span>
<a href="#l49.46"></a><span id="l49.46" class="difflineminus">-        }</span>
<a href="#l49.47"></a><span id="l49.47" class="difflineminus">-        this._lastModified[jarFile.leafName] = jarFile.lastModifiedTime;</span>
<a href="#l49.48"></a><span id="l49.48" class="difflineminus">-        this._indexJar(jarFile);</span>
<a href="#l49.49"></a><span id="l49.49" class="difflineminus">-      }</span>
<a href="#l49.50"></a><span id="l49.50" class="difflineminus">-    }</span>
<a href="#l49.51"></a><span id="l49.51" class="difflineminus">-  },</span>
<a href="#l49.52"></a><span id="l49.52" class="difflineminus">-</span>
<a href="#l49.53"></a><span id="l49.53" class="difflineminus">-  _indexJar: function(jarFile) {</span>
<a href="#l49.54"></a><span id="l49.54" class="difflineminus">-    let zipReader = Cc[&quot;@mozilla.org/libjar/zip-reader;1&quot;]</span>
<a href="#l49.55"></a><span id="l49.55" class="difflineminus">-                .createInstance(Ci.nsIZipReader);</span>
<a href="#l49.56"></a><span id="l49.56" class="difflineminus">-    zipReader.open(jarFile); // must already be nsIFile</span>
<a href="#l49.57"></a><span id="l49.57" class="difflineminus">-    let entries = zipReader.findEntries(null);</span>
<a href="#l49.58"></a><span id="l49.58" class="difflineminus">-    while(entries.hasMore()) {</span>
<a href="#l49.59"></a><span id="l49.59" class="difflineminus">-      // Find all .js files inside jar file:</span>
<a href="#l49.60"></a><span id="l49.60" class="difflineminus">-      let entry = entries.getNext();</span>
<a href="#l49.61"></a><span id="l49.61" class="difflineminus">-      if (entry.indexOf(&quot;.js&quot;) == entry.length - 3) {</span>
<a href="#l49.62"></a><span id="l49.62" class="difflineminus">-        // add entry to index</span>
<a href="#l49.63"></a><span id="l49.63" class="difflineminus">-       let moduleName = entry.slice(0, entry.length - 3);</span>
<a href="#l49.64"></a><span id="l49.64" class="difflineminus">-       this._index[moduleName] = jarFile.path;</span>
<a href="#l49.65"></a><span id="l49.65" class="difflineminus">-      }</span>
<a href="#l49.66"></a><span id="l49.66" class="difflineminus">-    }</span>
<a href="#l49.67"></a><span id="l49.67" class="difflineminus">-    zipReader.close();</span>
<a href="#l49.68"></a><span id="l49.68" class="difflineminus">-  },</span>
<a href="#l49.69"></a><span id="l49.69" class="difflineminus">-</span>
<a href="#l49.70"></a><span id="l49.70" class="difflineminus">-  _verifyJar: function(jarFile, expectedHash) {</span>
<a href="#l49.71"></a><span id="l49.71" class="difflineminus">-    // Compare the jar file's hash to the expected hash from the</span>
<a href="#l49.72"></a><span id="l49.72" class="difflineminus">-    // index file.</span>
<a href="#l49.73"></a><span id="l49.73" class="difflineminus">-    // from https://developer.mozilla.org/en/nsICryptoHash#Computing_the_Hash_of_a_File</span>
<a href="#l49.74"></a><span id="l49.74" class="difflineminus">-    console.info(&quot;Attempting to verify jarfile vs hash = &quot; + expectedHash);</span>
<a href="#l49.75"></a><span id="l49.75" class="difflineminus">-    let istream = Cc[&quot;@mozilla.org/network/file-input-stream;1&quot;]</span>
<a href="#l49.76"></a><span id="l49.76" class="difflineminus">-                        .createInstance(Ci.nsIFileInputStream);</span>
<a href="#l49.77"></a><span id="l49.77" class="difflineminus">-    // open for reading</span>
<a href="#l49.78"></a><span id="l49.78" class="difflineminus">-    istream.init(jarFile, 0x01, 0444, 0);</span>
<a href="#l49.79"></a><span id="l49.79" class="difflineminus">-    let ch = Cc[&quot;@mozilla.org/security/hash;1&quot;]</span>
<a href="#l49.80"></a><span id="l49.80" class="difflineminus">-                   .createInstance(Ci.nsICryptoHash);</span>
<a href="#l49.81"></a><span id="l49.81" class="difflineminus">-    // Use SHA256, it's more secure than MD5:</span>
<a href="#l49.82"></a><span id="l49.82" class="difflineminus">-    ch.init(ch.SHA256);</span>
<a href="#l49.83"></a><span id="l49.83" class="difflineminus">-    // this tells updateFromStream to read the entire file</span>
<a href="#l49.84"></a><span id="l49.84" class="difflineminus">-    const PR_UINT32_MAX = 0xffffffff;</span>
<a href="#l49.85"></a><span id="l49.85" class="difflineminus">-    ch.updateFromStream(istream, PR_UINT32_MAX);</span>
<a href="#l49.86"></a><span id="l49.86" class="difflineminus">-    // pass false here to get binary data back</span>
<a href="#l49.87"></a><span id="l49.87" class="difflineminus">-    let hash = ch.finish(false);</span>
<a href="#l49.88"></a><span id="l49.88" class="difflineminus">-</span>
<a href="#l49.89"></a><span id="l49.89" class="difflineminus">-    // return the two-digit hexadecimal code for a byte</span>
<a href="#l49.90"></a><span id="l49.90" class="difflineminus">-    function toHexString(charCode)</span>
<a href="#l49.91"></a><span id="l49.91" class="difflineminus">-    {</span>
<a href="#l49.92"></a><span id="l49.92" class="difflineminus">-      return (&quot;0&quot; + charCode.toString(16)).slice(-2);</span>
<a href="#l49.93"></a><span id="l49.93" class="difflineminus">-    }</span>
<a href="#l49.94"></a><span id="l49.94" class="difflineminus">-</span>
<a href="#l49.95"></a><span id="l49.95" class="difflineminus">-    // convert the binary hash data to a hex string.</span>
<a href="#l49.96"></a><span id="l49.96" class="difflineminus">-    let s = [toHexString(hash.charCodeAt(i)) for (i in hash)].join(&quot;&quot;);</span>
<a href="#l49.97"></a><span id="l49.97" class="difflineminus">-    // s now contains your hash in hex</span>
<a href="#l49.98"></a><span id="l49.98" class="difflineminus">-</span>
<a href="#l49.99"></a><span id="l49.99" class="difflineminus">-    return (s == expectedHash);</span>
<a href="#l49.100"></a><span id="l49.100" class="difflineminus">-  },</span>
<a href="#l49.101"></a><span id="l49.101" class="difflineminus">-</span>
<a href="#l49.102"></a><span id="l49.102" class="difflineminus">-  saveJarFile: function( filename, rawData, expectedHash ) {</span>
<a href="#l49.103"></a><span id="l49.103" class="difflineminus">-    console.info(&quot;Saving a JAR file as &quot; + filename + &quot; hash = &quot; + expectedHash);</span>
<a href="#l49.104"></a><span id="l49.104" class="difflineminus">-    // rawData is a string of binary data representing a jar file</span>
<a href="#l49.105"></a><span id="l49.105" class="difflineminus">-    let jarFile;</span>
<a href="#l49.106"></a><span id="l49.106" class="difflineminus">-    try {</span>
<a href="#l49.107"></a><span id="l49.107" class="difflineminus">-      jarFile = this._baseDir.clone();</span>
<a href="#l49.108"></a><span id="l49.108" class="difflineminus">-      // filename may have directories in it; use just the last part</span>
<a href="#l49.109"></a><span id="l49.109" class="difflineminus">-      jarFile.append(filename.split(&quot;/&quot;).pop());</span>
<a href="#l49.110"></a><span id="l49.110" class="difflineminus">-</span>
<a href="#l49.111"></a><span id="l49.111" class="difflineminus">-      // If a file of that name already exists, remove it!</span>
<a href="#l49.112"></a><span id="l49.112" class="difflineminus">-      if (jarFile.exists()) {</span>
<a href="#l49.113"></a><span id="l49.113" class="difflineminus">-        jarFile.remove(false);</span>
<a href="#l49.114"></a><span id="l49.114" class="difflineminus">-      }</span>
<a href="#l49.115"></a><span id="l49.115" class="difflineminus">-      // From https://developer.mozilla.org/en/Code_snippets/File_I%2f%2fO#Getting_special_files</span>
<a href="#l49.116"></a><span id="l49.116" class="difflineminus">-      jarFile.create( Ci.nsIFile.NORMAL_FILE_TYPE, 0600);</span>
<a href="#l49.117"></a><span id="l49.117" class="difflineminus">-      let stream = Cc[&quot;@mozilla.org/network/safe-file-output-stream;1&quot;].</span>
<a href="#l49.118"></a><span id="l49.118" class="difflineminus">-                      createInstance(Ci.nsIFileOutputStream);</span>
<a href="#l49.119"></a><span id="l49.119" class="difflineminus">-      stream.init(jarFile, 0x04 | 0x08 | 0x20, 0600, 0); // readwrite, create, truncate</span>
<a href="#l49.120"></a><span id="l49.120" class="difflineminus">-      stream.write(rawData, rawData.length);</span>
<a href="#l49.121"></a><span id="l49.121" class="difflineminus">-      if (stream instanceof Ci.nsISafeOutputStream) {</span>
<a href="#l49.122"></a><span id="l49.122" class="difflineminus">-        stream.finish();</span>
<a href="#l49.123"></a><span id="l49.123" class="difflineminus">-      } else {</span>
<a href="#l49.124"></a><span id="l49.124" class="difflineminus">-        stream.close();</span>
<a href="#l49.125"></a><span id="l49.125" class="difflineminus">-      }</span>
<a href="#l49.126"></a><span id="l49.126" class="difflineminus">-      // Verify hash; if it's good, index and set last modified time.</span>
<a href="#l49.127"></a><span id="l49.127" class="difflineminus">-      // If not good, remove it.</span>
<a href="#l49.128"></a><span id="l49.128" class="difflineminus">-      if (this._verifyJar(jarFile, expectedHash)) {</span>
<a href="#l49.129"></a><span id="l49.129" class="difflineminus">-        this._indexJar(jarFile);</span>
<a href="#l49.130"></a><span id="l49.130" class="difflineminus">-        this._lastModified[jarFile.leafName] = jarFile.lastModifiedTime;</span>
<a href="#l49.131"></a><span id="l49.131" class="difflineminus">-      } else {</span>
<a href="#l49.132"></a><span id="l49.132" class="difflineminus">-        console.warn(&quot;Bad JAR file, doesn't match hash: &quot; + expectedHash);</span>
<a href="#l49.133"></a><span id="l49.133" class="difflineminus">-        jarFile.remove(false);</span>
<a href="#l49.134"></a><span id="l49.134" class="difflineminus">-      }</span>
<a href="#l49.135"></a><span id="l49.135" class="difflineminus">-    } catch(e) {</span>
<a href="#l49.136"></a><span id="l49.136" class="difflineminus">-      console.warn(&quot;Error in saving jar file: &quot; + e);</span>
<a href="#l49.137"></a><span id="l49.137" class="difflineminus">-      // Remove any partially saved file</span>
<a href="#l49.138"></a><span id="l49.138" class="difflineminus">-      if (jarFile.exists()) {</span>
<a href="#l49.139"></a><span id="l49.139" class="difflineminus">-        jarFile.remove(false);</span>
<a href="#l49.140"></a><span id="l49.140" class="difflineminus">-      }</span>
<a href="#l49.141"></a><span id="l49.141" class="difflineminus">-    }</span>
<a href="#l49.142"></a><span id="l49.142" class="difflineminus">-  },</span>
<a href="#l49.143"></a><span id="l49.143" class="difflineminus">-</span>
<a href="#l49.144"></a><span id="l49.144" class="difflineminus">-  resolveModule: function(root, path) {</span>
<a href="#l49.145"></a><span id="l49.145" class="difflineminus">-    // Root will be null if require() was done by absolute path.</span>
<a href="#l49.146"></a><span id="l49.146" class="difflineminus">-    if (root != null) {</span>
<a href="#l49.147"></a><span id="l49.147" class="difflineminus">-      // TODO I don't think we need to do anything special here.</span>
<a href="#l49.148"></a><span id="l49.148" class="difflineminus">-    }</span>
<a href="#l49.149"></a><span id="l49.149" class="difflineminus">-    // drop &quot;.js&quot; off end of path to get module</span>
<a href="#l49.150"></a><span id="l49.150" class="difflineminus">-    let module;</span>
<a href="#l49.151"></a><span id="l49.151" class="difflineminus">-    if (path.indexOf(&quot;.js&quot;) == path.length - 3) {</span>
<a href="#l49.152"></a><span id="l49.152" class="difflineminus">-      module = path.slice(0, path.length - 3);</span>
<a href="#l49.153"></a><span id="l49.153" class="difflineminus">-    } else {</span>
<a href="#l49.154"></a><span id="l49.154" class="difflineminus">-      module = path;</span>
<a href="#l49.155"></a><span id="l49.155" class="difflineminus">-    }</span>
<a href="#l49.156"></a><span id="l49.156" class="difflineminus">-    if (this._index[module]) {</span>
<a href="#l49.157"></a><span id="l49.157" class="difflineminus">-      let resolvedPath = this._index[module] + &quot;!&quot; + module + &quot;.js&quot;;</span>
<a href="#l49.158"></a><span id="l49.158" class="difflineminus">-      return resolvedPath;</span>
<a href="#l49.159"></a><span id="l49.159" class="difflineminus">-    }</span>
<a href="#l49.160"></a><span id="l49.160" class="difflineminus">-    return null;</span>
<a href="#l49.161"></a><span id="l49.161" class="difflineminus">-    // must return a path... which gets passed to getFile.</span>
<a href="#l49.162"></a><span id="l49.162" class="difflineminus">-  },</span>
<a href="#l49.163"></a><span id="l49.163" class="difflineminus">-</span>
<a href="#l49.164"></a><span id="l49.164" class="difflineminus">-  getFile: function(path) {</span>
<a href="#l49.165"></a><span id="l49.165" class="difflineminus">-    // used externally by cuddlefish; takes the path and returns</span>
<a href="#l49.166"></a><span id="l49.166" class="difflineminus">-    // {contents: data}.</span>
<a href="#l49.167"></a><span id="l49.167" class="difflineminus">-    if (this._localOverrides[path]) {</span>
<a href="#l49.168"></a><span id="l49.168" class="difflineminus">-      let code = this._localOverrides[path];</span>
<a href="#l49.169"></a><span id="l49.169" class="difflineminus">-      return {contents: code};</span>
<a href="#l49.170"></a><span id="l49.170" class="difflineminus">-    }</span>
<a href="#l49.171"></a><span id="l49.171" class="difflineminus">-    let parts = path.split(&quot;!&quot;);</span>
<a href="#l49.172"></a><span id="l49.172" class="difflineminus">-    let filePath = parts[0];</span>
<a href="#l49.173"></a><span id="l49.173" class="difflineminus">-    let entryName = parts[1];</span>
<a href="#l49.174"></a><span id="l49.174" class="difflineminus">-    let file = Cc[&quot;@mozilla.org/file/local;1&quot;].createInstance(Ci.nsILocalFile);</span>
<a href="#l49.175"></a><span id="l49.175" class="difflineminus">-    file.initWithPath(filePath);</span>
<a href="#l49.176"></a><span id="l49.176" class="difflineminus">-    return this._readEntryFromJarFile(file, entryName);</span>
<a href="#l49.177"></a><span id="l49.177" class="difflineminus">-  },</span>
<a href="#l49.178"></a><span id="l49.178" class="difflineminus">-</span>
<a href="#l49.179"></a><span id="l49.179" class="difflineminus">-  _readEntryFromJarFile: function(jarFile, entryName) {</span>
<a href="#l49.180"></a><span id="l49.180" class="difflineminus">-    // Reads out content of entry, without unzipping jar file to disk.</span>
<a href="#l49.181"></a><span id="l49.181" class="difflineminus">-    // Open the jar file</span>
<a href="#l49.182"></a><span id="l49.182" class="difflineminus">-    let zipReader = Cc[&quot;@mozilla.org/libjar/zip-reader;1&quot;]</span>
<a href="#l49.183"></a><span id="l49.183" class="difflineminus">-                .createInstance(Ci.nsIZipReader);</span>
<a href="#l49.184"></a><span id="l49.184" class="difflineminus">-    zipReader.open(jarFile); // must already be nsIFile</span>
<a href="#l49.185"></a><span id="l49.185" class="difflineminus">-    let rawStream = zipReader.getInputStream(entryName);</span>
<a href="#l49.186"></a><span id="l49.186" class="difflineminus">-    let stream = Cc[&quot;@mozilla.org/scriptableinputstream;1&quot;].</span>
<a href="#l49.187"></a><span id="l49.187" class="difflineminus">-      createInstance(Ci.nsIScriptableInputStream);</span>
<a href="#l49.188"></a><span id="l49.188" class="difflineminus">-    stream.init(rawStream);</span>
<a href="#l49.189"></a><span id="l49.189" class="difflineminus">-    try {</span>
<a href="#l49.190"></a><span id="l49.190" class="difflineminus">-      let data = new String();</span>
<a href="#l49.191"></a><span id="l49.191" class="difflineminus">-      let chunk = {};</span>
<a href="#l49.192"></a><span id="l49.192" class="difflineminus">-      do {</span>
<a href="#l49.193"></a><span id="l49.193" class="difflineminus">-        chunk = stream.read(-1);</span>
<a href="#l49.194"></a><span id="l49.194" class="difflineminus">-        data += chunk;</span>
<a href="#l49.195"></a><span id="l49.195" class="difflineminus">-      } while (chunk.length &gt; 0);</span>
<a href="#l49.196"></a><span id="l49.196" class="difflineminus">-      return {contents: data};</span>
<a href="#l49.197"></a><span id="l49.197" class="difflineminus">-    } catch(e) {</span>
<a href="#l49.198"></a><span id="l49.198" class="difflineminus">-      console.warn(&quot;Error reading entry from jar file: &quot; + e );</span>
<a href="#l49.199"></a><span id="l49.199" class="difflineminus">-    }</span>
<a href="#l49.200"></a><span id="l49.200" class="difflineminus">-    return null;</span>
<a href="#l49.201"></a><span id="l49.201" class="difflineminus">-  },</span>
<a href="#l49.202"></a><span id="l49.202" class="difflineminus">-</span>
<a href="#l49.203"></a><span id="l49.203" class="difflineminus">-</span>
<a href="#l49.204"></a><span id="l49.204" class="difflineminus">-  getFileModifiedDate: function(filename) {</span>
<a href="#l49.205"></a><span id="l49.205" class="difflineminus">-    // used by remote experiment loader to know whether we have to redownload</span>
<a href="#l49.206"></a><span id="l49.206" class="difflineminus">-    // a thing or not.</span>
<a href="#l49.207"></a><span id="l49.207" class="difflineminus">-    filename = filename.split(&quot;/&quot;).pop();</span>
<a href="#l49.208"></a><span id="l49.208" class="difflineminus">-    if (this._lastModified[filename]) {</span>
<a href="#l49.209"></a><span id="l49.209" class="difflineminus">-      return (this._lastModified[filename]);</span>
<a href="#l49.210"></a><span id="l49.210" class="difflineminus">-    } else {</span>
<a href="#l49.211"></a><span id="l49.211" class="difflineminus">-      return 0;</span>
<a href="#l49.212"></a><span id="l49.212" class="difflineminus">-    }</span>
<a href="#l49.213"></a><span id="l49.213" class="difflineminus">-  },</span>
<a href="#l49.214"></a><span id="l49.214" class="difflineminus">-</span>
<a href="#l49.215"></a><span id="l49.215" class="difflineminus">-  listAllFiles: function() {</span>
<a href="#l49.216"></a><span id="l49.216" class="difflineminus">-    // used by remote experiment loader</span>
<a href="#l49.217"></a><span id="l49.217" class="difflineminus">-    let x;</span>
<a href="#l49.218"></a><span id="l49.218" class="difflineminus">-    let list = [x for (x in this._index)];</span>
<a href="#l49.219"></a><span id="l49.219" class="difflineminus">-    return list;</span>
<a href="#l49.220"></a><span id="l49.220" class="difflineminus">-  },</span>
<a href="#l49.221"></a><span id="l49.221" class="difflineminus">-</span>
<a href="#l49.222"></a><span id="l49.222" class="difflineminus">-  setLocalOverride: function(path, code) {</span>
<a href="#l49.223"></a><span id="l49.223" class="difflineminus">-    let prefs = require(&quot;preferences-service&quot;);</span>
<a href="#l49.224"></a><span id="l49.224" class="difflineminus">-    this._localOverrides[path] = code;</span>
<a href="#l49.225"></a><span id="l49.225" class="difflineminus">-    prefs.set(&quot;extensions.testpilot.codeOverride&quot;,</span>
<a href="#l49.226"></a><span id="l49.226" class="difflineminus">-              JSON.stringify(this._localOverrides));</span>
<a href="#l49.227"></a><span id="l49.227" class="difflineminus">-  }</span>
<a href="#l49.228"></a><span id="l49.228" class="difflineminus">-};</span>
<a href="#l49.229"></a><span id="l49.229" class="difflineminus">-</span>
<a href="#l49.230"></a><span id="l49.230" class="difflineminus">-exports.JarStore = JarStore;</span>
<a href="#l49.231"></a><span id="l49.231">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1">deleted file mode 100644</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/cuddlefish.js</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineplus">+++ /dev/null</span>
<a href="#l50.4"></a><span id="l50.4" class="difflineat">@@ -1,119 +0,0 @@</span>
<a href="#l50.5"></a><span id="l50.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l50.6"></a><span id="l50.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l50.7"></a><span id="l50.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l50.8"></a><span id="l50.8" class="difflineminus">-</span>
<a href="#l50.9"></a><span id="l50.9" class="difflineminus">-(function(global) {</span>
<a href="#l50.10"></a><span id="l50.10" class="difflineminus">-   const Cc = Components.classes;</span>
<a href="#l50.11"></a><span id="l50.11" class="difflineminus">-   const Ci = Components.interfaces;</span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-   const Cu = Components.utils;</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineminus">-   const Cr = Components.results;</span>
<a href="#l50.14"></a><span id="l50.14" class="difflineminus">-</span>
<a href="#l50.15"></a><span id="l50.15" class="difflineminus">-   var exports = {};</span>
<a href="#l50.16"></a><span id="l50.16" class="difflineminus">-</span>
<a href="#l50.17"></a><span id="l50.17" class="difflineminus">-   // Load the SecurableModule prerequisite.</span>
<a href="#l50.18"></a><span id="l50.18" class="difflineminus">-   var securableModule;</span>
<a href="#l50.19"></a><span id="l50.19" class="difflineminus">-</span>
<a href="#l50.20"></a><span id="l50.20" class="difflineminus">-   if (global.require)</span>
<a href="#l50.21"></a><span id="l50.21" class="difflineminus">-     // We're being loaded in a SecurableModule.</span>
<a href="#l50.22"></a><span id="l50.22" class="difflineminus">-     securableModule = require(&quot;securable-module&quot;);</span>
<a href="#l50.23"></a><span id="l50.23" class="difflineminus">-   else {</span>
<a href="#l50.24"></a><span id="l50.24" class="difflineminus">-     var myURI = Components.stack.filename.split(&quot; -&gt; &quot;).slice(-1)[0];</span>
<a href="#l50.25"></a><span id="l50.25" class="difflineminus">-     var ios = Cc['@mozilla.org/network/io-service;1']</span>
<a href="#l50.26"></a><span id="l50.26" class="difflineminus">-               .getService(Ci.nsIIOService);</span>
<a href="#l50.27"></a><span id="l50.27" class="difflineminus">-     var securableModuleURI = ios.newURI(&quot;securable-module.js&quot;, null,</span>
<a href="#l50.28"></a><span id="l50.28" class="difflineminus">-                                         ios.newURI(myURI, null, null));</span>
<a href="#l50.29"></a><span id="l50.29" class="difflineminus">-     if (securableModuleURI.scheme == &quot;chrome&quot;) {</span>
<a href="#l50.30"></a><span id="l50.30" class="difflineminus">-       // The securable-module module is at a chrome URI, so we can't</span>
<a href="#l50.31"></a><span id="l50.31" class="difflineminus">-       // simply load it via Cu.import(). Let's assume we're in a</span>
<a href="#l50.32"></a><span id="l50.32" class="difflineminus">-       // chrome-privileged document and use mozIJSSubScriptLoader.</span>
<a href="#l50.33"></a><span id="l50.33" class="difflineminus">-       var loader = Cc[&quot;@mozilla.org/moz/jssubscript-loader;1&quot;]</span>
<a href="#l50.34"></a><span id="l50.34" class="difflineminus">-                    .getService(Ci.mozIJSSubScriptLoader);</span>
<a href="#l50.35"></a><span id="l50.35" class="difflineminus">-</span>
<a href="#l50.36"></a><span id="l50.36" class="difflineminus">-       // Import the script, don't pollute the global scope.</span>
<a href="#l50.37"></a><span id="l50.37" class="difflineminus">-       securableModule = {__proto__: global};</span>
<a href="#l50.38"></a><span id="l50.38" class="difflineminus">-       loader.loadSubScript(securableModuleURI.spec, securableModule);</span>
<a href="#l50.39"></a><span id="l50.39" class="difflineminus">-       securableModule = securableModule.SecurableModule;</span>
<a href="#l50.40"></a><span id="l50.40" class="difflineminus">-     } else {</span>
<a href="#l50.41"></a><span id="l50.41" class="difflineminus">-       securableModule = {};</span>
<a href="#l50.42"></a><span id="l50.42" class="difflineminus">-       try {</span>
<a href="#l50.43"></a><span id="l50.43" class="difflineminus">-         Cu.import(securableModuleURI.spec, securableModule);</span>
<a href="#l50.44"></a><span id="l50.44" class="difflineminus">-       } catch (e if e.result == Cr.NS_ERROR_ILLEGAL_VALUE) {</span>
<a href="#l50.45"></a><span id="l50.45" class="difflineminus">-         Cu.reportError(&quot;Failed to load &quot; + securableModuleURI.spec);</span>
<a href="#l50.46"></a><span id="l50.46" class="difflineminus">-       }</span>
<a href="#l50.47"></a><span id="l50.47" class="difflineminus">-     }</span>
<a href="#l50.48"></a><span id="l50.48" class="difflineminus">-   }</span>
<a href="#l50.49"></a><span id="l50.49" class="difflineminus">-</span>
<a href="#l50.50"></a><span id="l50.50" class="difflineminus">-   function unloadLoader() {</span>
<a href="#l50.51"></a><span id="l50.51" class="difflineminus">-     this.require(&quot;unload&quot;).send();</span>
<a href="#l50.52"></a><span id="l50.52" class="difflineminus">-   }</span>
<a href="#l50.53"></a><span id="l50.53" class="difflineminus">-</span>
<a href="#l50.54"></a><span id="l50.54" class="difflineminus">-   var cuddlefishSandboxFactory = {</span>
<a href="#l50.55"></a><span id="l50.55" class="difflineminus">-     createSandbox: function(options) {</span>
<a href="#l50.56"></a><span id="l50.56" class="difflineminus">-       var filename = options.filename ? options.filename : null;</span>
<a href="#l50.57"></a><span id="l50.57" class="difflineminus">-       var sandbox = this.__proto__.createSandbox(options);</span>
<a href="#l50.58"></a><span id="l50.58" class="difflineminus">-       sandbox.defineProperty(&quot;__url__&quot;, filename);</span>
<a href="#l50.59"></a><span id="l50.59" class="difflineminus">-       return sandbox;</span>
<a href="#l50.60"></a><span id="l50.60" class="difflineminus">-     },</span>
<a href="#l50.61"></a><span id="l50.61" class="difflineminus">-     __proto__: new securableModule.SandboxFactory(&quot;system&quot;)</span>
<a href="#l50.62"></a><span id="l50.62" class="difflineminus">-   };</span>
<a href="#l50.63"></a><span id="l50.63" class="difflineminus">-</span>
<a href="#l50.64"></a><span id="l50.64" class="difflineminus">-   function CuddlefishModule(loader) {</span>
<a href="#l50.65"></a><span id="l50.65" class="difflineminus">-     this.parentLoader = loader;</span>
<a href="#l50.66"></a><span id="l50.66" class="difflineminus">-     this.__proto__ = exports;</span>
<a href="#l50.67"></a><span id="l50.67" class="difflineminus">-   }</span>
<a href="#l50.68"></a><span id="l50.68" class="difflineminus">-</span>
<a href="#l50.69"></a><span id="l50.69" class="difflineminus">-   var Loader = exports.Loader = function Loader(options) {</span>
<a href="#l50.70"></a><span id="l50.70" class="difflineminus">-     var globals = {Cc: Components.classes,</span>
<a href="#l50.71"></a><span id="l50.71" class="difflineminus">-                    Ci: Components.interfaces,</span>
<a href="#l50.72"></a><span id="l50.72" class="difflineminus">-                    Cu: Components.utils,</span>
<a href="#l50.73"></a><span id="l50.73" class="difflineminus">-                    Cr: Components.results};</span>
<a href="#l50.74"></a><span id="l50.74" class="difflineminus">-</span>
<a href="#l50.75"></a><span id="l50.75" class="difflineminus">-     if (options.console)</span>
<a href="#l50.76"></a><span id="l50.76" class="difflineminus">-       globals.console = options.console;</span>
<a href="#l50.77"></a><span id="l50.77" class="difflineminus">-     if (options.memory)</span>
<a href="#l50.78"></a><span id="l50.78" class="difflineminus">-       globals.memory = options.memory;</span>
<a href="#l50.79"></a><span id="l50.79" class="difflineminus">-</span>
<a href="#l50.80"></a><span id="l50.80" class="difflineminus">-     var modules = {};</span>
<a href="#l50.81"></a><span id="l50.81" class="difflineminus">-     var loaderOptions = {rootPath: options.rootPath,</span>
<a href="#l50.82"></a><span id="l50.82" class="difflineminus">-                          rootPaths: options.rootPaths,</span>
<a href="#l50.83"></a><span id="l50.83" class="difflineminus">-                          fs: options.fs,</span>
<a href="#l50.84"></a><span id="l50.84" class="difflineminus">-                          sandboxFactory: cuddlefishSandboxFactory,</span>
<a href="#l50.85"></a><span id="l50.85" class="difflineminus">-                          globals: globals,</span>
<a href="#l50.86"></a><span id="l50.86" class="difflineminus">-                          modules: modules};</span>
<a href="#l50.87"></a><span id="l50.87" class="difflineminus">-</span>
<a href="#l50.88"></a><span id="l50.88" class="difflineminus">-     var loader = new securableModule.Loader(loaderOptions);</span>
<a href="#l50.89"></a><span id="l50.89" class="difflineminus">-     var path = loader.fs.resolveModule(null, &quot;cuddlefish&quot;);</span>
<a href="#l50.90"></a><span id="l50.90" class="difflineminus">-     modules[path] = new CuddlefishModule(loader);</span>
<a href="#l50.91"></a><span id="l50.91" class="difflineminus">-</span>
<a href="#l50.92"></a><span id="l50.92" class="difflineminus">-     if (!globals.console) {</span>
<a href="#l50.93"></a><span id="l50.93" class="difflineminus">-       var console = loader.require(&quot;plain-text-console&quot;);</span>
<a href="#l50.94"></a><span id="l50.94" class="difflineminus">-       globals.console = new console.PlainTextConsole(options.print);</span>
<a href="#l50.95"></a><span id="l50.95" class="difflineminus">-     }</span>
<a href="#l50.96"></a><span id="l50.96" class="difflineminus">-     if (!globals.memory)</span>
<a href="#l50.97"></a><span id="l50.97" class="difflineminus">-       globals.memory = loader.require(&quot;memory&quot;);</span>
<a href="#l50.98"></a><span id="l50.98" class="difflineminus">-</span>
<a href="#l50.99"></a><span id="l50.99" class="difflineminus">-     loader.console = globals.console;</span>
<a href="#l50.100"></a><span id="l50.100" class="difflineminus">-     loader.memory = globals.memory;</span>
<a href="#l50.101"></a><span id="l50.101" class="difflineminus">-     loader.unload = unloadLoader;</span>
<a href="#l50.102"></a><span id="l50.102" class="difflineminus">-</span>
<a href="#l50.103"></a><span id="l50.103" class="difflineminus">-     return loader;</span>
<a href="#l50.104"></a><span id="l50.104" class="difflineminus">-   };</span>
<a href="#l50.105"></a><span id="l50.105" class="difflineminus">-</span>
<a href="#l50.106"></a><span id="l50.106" class="difflineminus">-   if (global.window) {</span>
<a href="#l50.107"></a><span id="l50.107" class="difflineminus">-     // We're being loaded in a chrome window, or a web page with</span>
<a href="#l50.108"></a><span id="l50.108" class="difflineminus">-     // UniversalXPConnect privileges.</span>
<a href="#l50.109"></a><span id="l50.109" class="difflineminus">-     global.Cuddlefish = exports;</span>
<a href="#l50.110"></a><span id="l50.110" class="difflineminus">-   } else if (global.exports) {</span>
<a href="#l50.111"></a><span id="l50.111" class="difflineminus">-     // We're being loaded in a SecurableModule.</span>
<a href="#l50.112"></a><span id="l50.112" class="difflineminus">-     for (name in exports) {</span>
<a href="#l50.113"></a><span id="l50.113" class="difflineminus">-       global.exports[name] = exports[name];</span>
<a href="#l50.114"></a><span id="l50.114" class="difflineminus">-     }</span>
<a href="#l50.115"></a><span id="l50.115" class="difflineminus">-   } else {</span>
<a href="#l50.116"></a><span id="l50.116" class="difflineminus">-     // We're being loaded in a JS module.</span>
<a href="#l50.117"></a><span id="l50.117" class="difflineminus">-     global.EXPORTED_SYMBOLS = [];</span>
<a href="#l50.118"></a><span id="l50.118" class="difflineminus">-     for (name in exports) {</span>
<a href="#l50.119"></a><span id="l50.119" class="difflineminus">-       global.EXPORTED_SYMBOLS.push(name);</span>
<a href="#l50.120"></a><span id="l50.120" class="difflineminus">-       global[name] = exports[name];</span>
<a href="#l50.121"></a><span id="l50.121" class="difflineminus">-     }</span>
<a href="#l50.122"></a><span id="l50.122" class="difflineminus">-   }</span>
<a href="#l50.123"></a><span id="l50.123" class="difflineminus">- })(this);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1">deleted file mode 100644</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/file.js</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineplus">+++ /dev/null</span>
<a href="#l51.4"></a><span id="l51.4" class="difflineat">@@ -1,73 +0,0 @@</span>
<a href="#l51.5"></a><span id="l51.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l51.6"></a><span id="l51.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l51.7"></a><span id="l51.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l51.8"></a><span id="l51.8" class="difflineminus">-</span>
<a href="#l51.9"></a><span id="l51.9" class="difflineminus">-(function(global) {</span>
<a href="#l51.10"></a><span id="l51.10" class="difflineminus">-   const Cc = Components.classes;</span>
<a href="#l51.11"></a><span id="l51.11" class="difflineminus">-   const Ci = Components.interfaces;</span>
<a href="#l51.12"></a><span id="l51.12" class="difflineminus">-   const Cu = Components.utils;</span>
<a href="#l51.13"></a><span id="l51.13" class="difflineminus">-   const Cr = Components.results;</span>
<a href="#l51.14"></a><span id="l51.14" class="difflineminus">-</span>
<a href="#l51.15"></a><span id="l51.15" class="difflineminus">-   var exports = {};</span>
<a href="#l51.16"></a><span id="l51.16" class="difflineminus">-</span>
<a href="#l51.17"></a><span id="l51.17" class="difflineminus">-   var dirsvc = Cc[&quot;@mozilla.org/file/directory_service;1&quot;]</span>
<a href="#l51.18"></a><span id="l51.18" class="difflineminus">-                .getService(Ci.nsIProperties);</span>
<a href="#l51.19"></a><span id="l51.19" class="difflineminus">-</span>
<a href="#l51.20"></a><span id="l51.20" class="difflineminus">-   function MozFile(path) {</span>
<a href="#l51.21"></a><span id="l51.21" class="difflineminus">-     var file = Cc['@mozilla.org/file/local;1']</span>
<a href="#l51.22"></a><span id="l51.22" class="difflineminus">-                .createInstance(Ci.nsILocalFile);</span>
<a href="#l51.23"></a><span id="l51.23" class="difflineminus">-     file.initWithPath(path);</span>
<a href="#l51.24"></a><span id="l51.24" class="difflineminus">-     return {</span>
<a href="#l51.25"></a><span id="l51.25" class="difflineminus">-       get directoryEntries() {</span>
<a href="#l51.26"></a><span id="l51.26" class="difflineminus">-         try {</span>
<a href="#l51.27"></a><span id="l51.27" class="difflineminus">-           return file.directoryEntries;</span>
<a href="#l51.28"></a><span id="l51.28" class="difflineminus">-         } catch (e if e.result == Cr.NS_ERROR_FILE_NOT_FOUND) {</span>
<a href="#l51.29"></a><span id="l51.29" class="difflineminus">-           throw new Error(&quot;path does not exist: &quot; + file.path);</span>
<a href="#l51.30"></a><span id="l51.30" class="difflineminus">-         }</span>
<a href="#l51.31"></a><span id="l51.31" class="difflineminus">-       },</span>
<a href="#l51.32"></a><span id="l51.32" class="difflineminus">-       __proto__: file</span>
<a href="#l51.33"></a><span id="l51.33" class="difflineminus">-     };</span>
<a href="#l51.34"></a><span id="l51.34" class="difflineminus">-   }</span>
<a href="#l51.35"></a><span id="l51.35" class="difflineminus">-</span>
<a href="#l51.36"></a><span id="l51.36" class="difflineminus">-   exports.join = function join(base) {</span>
<a href="#l51.37"></a><span id="l51.37" class="difflineminus">-     if (arguments.length &lt; 2)</span>
<a href="#l51.38"></a><span id="l51.38" class="difflineminus">-       throw new Error(&quot;need at least 2 args&quot;);</span>
<a href="#l51.39"></a><span id="l51.39" class="difflineminus">-     base = MozFile(base);</span>
<a href="#l51.40"></a><span id="l51.40" class="difflineminus">-     for (var i = 1; i &lt; arguments.length; i++)</span>
<a href="#l51.41"></a><span id="l51.41" class="difflineminus">-       base.append(arguments[i]);</span>
<a href="#l51.42"></a><span id="l51.42" class="difflineminus">-     return base.path;</span>
<a href="#l51.43"></a><span id="l51.43" class="difflineminus">-   };</span>
<a href="#l51.44"></a><span id="l51.44" class="difflineminus">-</span>
<a href="#l51.45"></a><span id="l51.45" class="difflineminus">-   exports.dirname = function dirname(path) {</span>
<a href="#l51.46"></a><span id="l51.46" class="difflineminus">-     return MozFile(path).parent.path;</span>
<a href="#l51.47"></a><span id="l51.47" class="difflineminus">-   };</span>
<a href="#l51.48"></a><span id="l51.48" class="difflineminus">-</span>
<a href="#l51.49"></a><span id="l51.49" class="difflineminus">-   exports.list = function list(path) {</span>
<a href="#l51.50"></a><span id="l51.50" class="difflineminus">-     var entries = MozFile(path).directoryEntries;</span>
<a href="#l51.51"></a><span id="l51.51" class="difflineminus">-     var entryNames = [];</span>
<a href="#l51.52"></a><span id="l51.52" class="difflineminus">-     while(entries.hasMoreElements()) {</span>
<a href="#l51.53"></a><span id="l51.53" class="difflineminus">-       var entry = entries.getNext();</span>
<a href="#l51.54"></a><span id="l51.54" class="difflineminus">-       entry.QueryInterface(Ci.nsIFile);</span>
<a href="#l51.55"></a><span id="l51.55" class="difflineminus">-       entryNames.push(entry.leafName);</span>
<a href="#l51.56"></a><span id="l51.56" class="difflineminus">-     }</span>
<a href="#l51.57"></a><span id="l51.57" class="difflineminus">-     return entryNames;</span>
<a href="#l51.58"></a><span id="l51.58" class="difflineminus">-   };</span>
<a href="#l51.59"></a><span id="l51.59" class="difflineminus">-</span>
<a href="#l51.60"></a><span id="l51.60" class="difflineminus">-   if (global.window) {</span>
<a href="#l51.61"></a><span id="l51.61" class="difflineminus">-     // We're being loaded in a chrome window, or a web page with</span>
<a href="#l51.62"></a><span id="l51.62" class="difflineminus">-     // UniversalXPConnect privileges.</span>
<a href="#l51.63"></a><span id="l51.63" class="difflineminus">-     global.File = exports;</span>
<a href="#l51.64"></a><span id="l51.64" class="difflineminus">-   } else if (global.exports) {</span>
<a href="#l51.65"></a><span id="l51.65" class="difflineminus">-     // We're being loaded in a SecurableModule.</span>
<a href="#l51.66"></a><span id="l51.66" class="difflineminus">-     for (name in exports) {</span>
<a href="#l51.67"></a><span id="l51.67" class="difflineminus">-       global.exports[name] = exports[name];</span>
<a href="#l51.68"></a><span id="l51.68" class="difflineminus">-     }</span>
<a href="#l51.69"></a><span id="l51.69" class="difflineminus">-   } else {</span>
<a href="#l51.70"></a><span id="l51.70" class="difflineminus">-     // We're being loaded in a JS module.</span>
<a href="#l51.71"></a><span id="l51.71" class="difflineminus">-     global.EXPORTED_SYMBOLS = [];</span>
<a href="#l51.72"></a><span id="l51.72" class="difflineminus">-     for (name in exports) {</span>
<a href="#l51.73"></a><span id="l51.73" class="difflineminus">-       global.EXPORTED_SYMBOLS.push(name);</span>
<a href="#l51.74"></a><span id="l51.74" class="difflineminus">-       global[name] = exports[name];</span>
<a href="#l51.75"></a><span id="l51.75" class="difflineminus">-     }</span>
<a href="#l51.76"></a><span id="l51.76" class="difflineminus">-   }</span>
<a href="#l51.77"></a><span id="l51.77" class="difflineminus">- })(this);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1">deleted file mode 100644</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/memory.js</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineplus">+++ /dev/null</span>
<a href="#l52.4"></a><span id="l52.4" class="difflineat">@@ -1,83 +0,0 @@</span>
<a href="#l52.5"></a><span id="l52.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l52.6"></a><span id="l52.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l52.7"></a><span id="l52.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l52.8"></a><span id="l52.8" class="difflineminus">-</span>
<a href="#l52.9"></a><span id="l52.9" class="difflineminus">-var compactTimerId;</span>
<a href="#l52.10"></a><span id="l52.10" class="difflineminus">-var COMPACT_INTERVAL = 5000;</span>
<a href="#l52.11"></a><span id="l52.11" class="difflineminus">-var trackedObjects = {};</span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">-</span>
<a href="#l52.13"></a><span id="l52.13" class="difflineminus">-function scheduleNextCompaction() {</span>
<a href="#l52.14"></a><span id="l52.14" class="difflineminus">-  compactTimerId = require(&quot;timer&quot;).setTimeout(compact, COMPACT_INTERVAL);</span>
<a href="#l52.15"></a><span id="l52.15" class="difflineminus">-}</span>
<a href="#l52.16"></a><span id="l52.16" class="difflineminus">-</span>
<a href="#l52.17"></a><span id="l52.17" class="difflineminus">-function compact() {</span>
<a href="#l52.18"></a><span id="l52.18" class="difflineminus">-  var newTrackedObjects = {};</span>
<a href="#l52.19"></a><span id="l52.19" class="difflineminus">-  for (name in trackedObjects) {</span>
<a href="#l52.20"></a><span id="l52.20" class="difflineminus">-    var oldBin = trackedObjects[name];</span>
<a href="#l52.21"></a><span id="l52.21" class="difflineminus">-    var newBin = [];</span>
<a href="#l52.22"></a><span id="l52.22" class="difflineminus">-    var strongRefs = [];</span>
<a href="#l52.23"></a><span id="l52.23" class="difflineminus">-    for (var i = 0; i &lt; oldBin.length; i++) {</span>
<a href="#l52.24"></a><span id="l52.24" class="difflineminus">-      var strongRef = oldBin[i].weakref.get();</span>
<a href="#l52.25"></a><span id="l52.25" class="difflineminus">-      if (strongRef &amp;&amp; strongRefs.indexOf(strongRef) == -1) {</span>
<a href="#l52.26"></a><span id="l52.26" class="difflineminus">-        strongRefs.push(strongRef);</span>
<a href="#l52.27"></a><span id="l52.27" class="difflineminus">-        newBin.push(oldBin[i]);</span>
<a href="#l52.28"></a><span id="l52.28" class="difflineminus">-      }</span>
<a href="#l52.29"></a><span id="l52.29" class="difflineminus">-    }</span>
<a href="#l52.30"></a><span id="l52.30" class="difflineminus">-    if (newBin.length)</span>
<a href="#l52.31"></a><span id="l52.31" class="difflineminus">-      newTrackedObjects[name] = newBin;</span>
<a href="#l52.32"></a><span id="l52.32" class="difflineminus">-  }</span>
<a href="#l52.33"></a><span id="l52.33" class="difflineminus">-  trackedObjects = newTrackedObjects;</span>
<a href="#l52.34"></a><span id="l52.34" class="difflineminus">-  scheduleNextCompaction();</span>
<a href="#l52.35"></a><span id="l52.35" class="difflineminus">-}</span>
<a href="#l52.36"></a><span id="l52.36" class="difflineminus">-</span>
<a href="#l52.37"></a><span id="l52.37" class="difflineminus">-var track = exports.track = function track(object, bin, stackFrameNumber) {</span>
<a href="#l52.38"></a><span id="l52.38" class="difflineminus">-  if (!compactTimerId)</span>
<a href="#l52.39"></a><span id="l52.39" class="difflineminus">-    scheduleNextCompaction();</span>
<a href="#l52.40"></a><span id="l52.40" class="difflineminus">-  var frame = Components.stack.caller;</span>
<a href="#l52.41"></a><span id="l52.41" class="difflineminus">-  var weakref = Cu.getWeakReference(object);</span>
<a href="#l52.42"></a><span id="l52.42" class="difflineminus">-  if (!bin)</span>
<a href="#l52.43"></a><span id="l52.43" class="difflineminus">-    bin = object.constructor.name;</span>
<a href="#l52.44"></a><span id="l52.44" class="difflineminus">-  if (bin == &quot;Object&quot;)</span>
<a href="#l52.45"></a><span id="l52.45" class="difflineminus">-    bin = frame.name;</span>
<a href="#l52.46"></a><span id="l52.46" class="difflineminus">-  if (!bin)</span>
<a href="#l52.47"></a><span id="l52.47" class="difflineminus">-    bin = &quot;generic&quot;;</span>
<a href="#l52.48"></a><span id="l52.48" class="difflineminus">-  if (!(bin in trackedObjects))</span>
<a href="#l52.49"></a><span id="l52.49" class="difflineminus">-    trackedObjects[bin] = [];</span>
<a href="#l52.50"></a><span id="l52.50" class="difflineminus">-</span>
<a href="#l52.51"></a><span id="l52.51" class="difflineminus">-  if (stackFrameNumber &gt; 0)</span>
<a href="#l52.52"></a><span id="l52.52" class="difflineminus">-    for (var i = 0; i &lt; stackFrameNumber; i++)</span>
<a href="#l52.53"></a><span id="l52.53" class="difflineminus">-      frame = frame.caller;</span>
<a href="#l52.54"></a><span id="l52.54" class="difflineminus">-</span>
<a href="#l52.55"></a><span id="l52.55" class="difflineminus">-  trackedObjects[bin].push({weakref: weakref,</span>
<a href="#l52.56"></a><span id="l52.56" class="difflineminus">-                            created: new Date(),</span>
<a href="#l52.57"></a><span id="l52.57" class="difflineminus">-                            filename: frame.filename,</span>
<a href="#l52.58"></a><span id="l52.58" class="difflineminus">-                            lineNo: frame.lineNumber});</span>
<a href="#l52.59"></a><span id="l52.59" class="difflineminus">-};</span>
<a href="#l52.60"></a><span id="l52.60" class="difflineminus">-</span>
<a href="#l52.61"></a><span id="l52.61" class="difflineminus">-var getBins = exports.getBins = function getBins() {</span>
<a href="#l52.62"></a><span id="l52.62" class="difflineminus">-  var names = [];</span>
<a href="#l52.63"></a><span id="l52.63" class="difflineminus">-  for (name in trackedObjects)</span>
<a href="#l52.64"></a><span id="l52.64" class="difflineminus">-    names.push(name);</span>
<a href="#l52.65"></a><span id="l52.65" class="difflineminus">-  return names;</span>
<a href="#l52.66"></a><span id="l52.66" class="difflineminus">-};</span>
<a href="#l52.67"></a><span id="l52.67" class="difflineminus">-</span>
<a href="#l52.68"></a><span id="l52.68" class="difflineminus">-var getObjects = exports.getObjects = function getObjects(bin) {</span>
<a href="#l52.69"></a><span id="l52.69" class="difflineminus">-  function getLiveObjectsInBin(bin, array) {</span>
<a href="#l52.70"></a><span id="l52.70" class="difflineminus">-    for (var i = 0; i &lt; bin.length; i++) {</span>
<a href="#l52.71"></a><span id="l52.71" class="difflineminus">-      var object = bin[i].weakref.get();</span>
<a href="#l52.72"></a><span id="l52.72" class="difflineminus">-      if (object)</span>
<a href="#l52.73"></a><span id="l52.73" class="difflineminus">-        array.push(bin[i]);</span>
<a href="#l52.74"></a><span id="l52.74" class="difflineminus">-    }</span>
<a href="#l52.75"></a><span id="l52.75" class="difflineminus">-  }</span>
<a href="#l52.76"></a><span id="l52.76" class="difflineminus">-</span>
<a href="#l52.77"></a><span id="l52.77" class="difflineminus">-  var results = [];</span>
<a href="#l52.78"></a><span id="l52.78" class="difflineminus">-  if (bin) {</span>
<a href="#l52.79"></a><span id="l52.79" class="difflineminus">-    if (bin in trackedObjects)</span>
<a href="#l52.80"></a><span id="l52.80" class="difflineminus">-      getLiveObjectsInBin(trackedObjects[bin], results);</span>
<a href="#l52.81"></a><span id="l52.81" class="difflineminus">-  } else</span>
<a href="#l52.82"></a><span id="l52.82" class="difflineminus">-    for (name in trackedObjects)</span>
<a href="#l52.83"></a><span id="l52.83" class="difflineminus">-      getLiveObjectsInBin(trackedObjects[name], results);</span>
<a href="#l52.84"></a><span id="l52.84" class="difflineminus">-  return results;</span>
<a href="#l52.85"></a><span id="l52.85" class="difflineminus">-};</span>
<a href="#l52.86"></a><span id="l52.86" class="difflineminus">-</span>
<a href="#l52.87"></a><span id="l52.87" class="difflineminus">-require(&quot;unload&quot;).when(function() { trackedObjects = {}; });</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1">deleted file mode 100644</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/observer-service.js</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineplus">+++ /dev/null</span>
<a href="#l53.4"></a><span id="l53.4" class="difflineat">@@ -1,157 +0,0 @@</span>
<a href="#l53.5"></a><span id="l53.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l53.6"></a><span id="l53.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l53.7"></a><span id="l53.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l53.8"></a><span id="l53.8" class="difflineminus">-</span>
<a href="#l53.9"></a><span id="l53.9" class="difflineminus">-var jsm = {}; Cu.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;, jsm);</span>
<a href="#l53.10"></a><span id="l53.10" class="difflineminus">-var XPCOMUtils = jsm.XPCOMUtils;</span>
<a href="#l53.11"></a><span id="l53.11" class="difflineminus">-</span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-/**</span>
<a href="#l53.13"></a><span id="l53.13" class="difflineminus">- * A service for adding, removing and notifying observers of notifications.</span>
<a href="#l53.14"></a><span id="l53.14" class="difflineminus">- * Wraps the nsIObserverService interface.</span>
<a href="#l53.15"></a><span id="l53.15" class="difflineminus">- *</span>
<a href="#l53.16"></a><span id="l53.16" class="difflineminus">- * @version 0.2</span>
<a href="#l53.17"></a><span id="l53.17" class="difflineminus">- */</span>
<a href="#l53.18"></a><span id="l53.18" class="difflineminus">-</span>
<a href="#l53.19"></a><span id="l53.19" class="difflineminus">-var service = Cc[&quot;@mozilla.org/observer-service;1&quot;].</span>
<a href="#l53.20"></a><span id="l53.20" class="difflineminus">-              getService(Ci.nsIObserverService);</span>
<a href="#l53.21"></a><span id="l53.21" class="difflineminus">-</span>
<a href="#l53.22"></a><span id="l53.22" class="difflineminus">-/**</span>
<a href="#l53.23"></a><span id="l53.23" class="difflineminus">- * A cache of observers that have been added.</span>
<a href="#l53.24"></a><span id="l53.24" class="difflineminus">- *</span>
<a href="#l53.25"></a><span id="l53.25" class="difflineminus">- * We use this to remove observers when a caller calls |Observers.remove|.</span>
<a href="#l53.26"></a><span id="l53.26" class="difflineminus">- */</span>
<a href="#l53.27"></a><span id="l53.27" class="difflineminus">-var cache = [];</span>
<a href="#l53.28"></a><span id="l53.28" class="difflineminus">-</span>
<a href="#l53.29"></a><span id="l53.29" class="difflineminus">-/**</span>
<a href="#l53.30"></a><span id="l53.30" class="difflineminus">- * Register the given callback as an observer of the given topic.</span>
<a href="#l53.31"></a><span id="l53.31" class="difflineminus">- *</span>
<a href="#l53.32"></a><span id="l53.32" class="difflineminus">- * @param   topic       {String}</span>
<a href="#l53.33"></a><span id="l53.33" class="difflineminus">- *          the topic to observe</span>
<a href="#l53.34"></a><span id="l53.34" class="difflineminus">- *</span>
<a href="#l53.35"></a><span id="l53.35" class="difflineminus">- * @param   callback    {Object}</span>
<a href="#l53.36"></a><span id="l53.36" class="difflineminus">- *          the callback; an Object that implements nsIObserver or a Function</span>
<a href="#l53.37"></a><span id="l53.37" class="difflineminus">- *          that gets called when the notification occurs</span>
<a href="#l53.38"></a><span id="l53.38" class="difflineminus">- *</span>
<a href="#l53.39"></a><span id="l53.39" class="difflineminus">- * @param   thisObject  {Object}  [optional]</span>
<a href="#l53.40"></a><span id="l53.40" class="difflineminus">- *          the object to use as |this| when calling a Function callback</span>
<a href="#l53.41"></a><span id="l53.41" class="difflineminus">- *</span>
<a href="#l53.42"></a><span id="l53.42" class="difflineminus">- * @returns the observer</span>
<a href="#l53.43"></a><span id="l53.43" class="difflineminus">- */</span>
<a href="#l53.44"></a><span id="l53.44" class="difflineminus">-var add = exports.add = function add(topic, callback, thisObject) {</span>
<a href="#l53.45"></a><span id="l53.45" class="difflineminus">-  var observer = new Observer(topic, callback, thisObject);</span>
<a href="#l53.46"></a><span id="l53.46" class="difflineminus">-  service.addObserver(observer, topic, true);</span>
<a href="#l53.47"></a><span id="l53.47" class="difflineminus">-  cache.push(observer);</span>
<a href="#l53.48"></a><span id="l53.48" class="difflineminus">-</span>
<a href="#l53.49"></a><span id="l53.49" class="difflineminus">-  return observer;</span>
<a href="#l53.50"></a><span id="l53.50" class="difflineminus">-};</span>
<a href="#l53.51"></a><span id="l53.51" class="difflineminus">-</span>
<a href="#l53.52"></a><span id="l53.52" class="difflineminus">-/**</span>
<a href="#l53.53"></a><span id="l53.53" class="difflineminus">- * Unregister the given callback as an observer of the given topic.</span>
<a href="#l53.54"></a><span id="l53.54" class="difflineminus">- *</span>
<a href="#l53.55"></a><span id="l53.55" class="difflineminus">- * @param   topic       {String}</span>
<a href="#l53.56"></a><span id="l53.56" class="difflineminus">- *          the topic being observed</span>
<a href="#l53.57"></a><span id="l53.57" class="difflineminus">- *</span>
<a href="#l53.58"></a><span id="l53.58" class="difflineminus">- * @param   callback    {Object}</span>
<a href="#l53.59"></a><span id="l53.59" class="difflineminus">- *          the callback doing the observing</span>
<a href="#l53.60"></a><span id="l53.60" class="difflineminus">- *</span>
<a href="#l53.61"></a><span id="l53.61" class="difflineminus">- * @param   thisObject  {Object}  [optional]</span>
<a href="#l53.62"></a><span id="l53.62" class="difflineminus">- *          the object being used as |this| when calling a Function callback</span>
<a href="#l53.63"></a><span id="l53.63" class="difflineminus">- */</span>
<a href="#l53.64"></a><span id="l53.64" class="difflineminus">-var remove = exports.remove = function remove(topic, callback, thisObject) {</span>
<a href="#l53.65"></a><span id="l53.65" class="difflineminus">-  // This seems fairly inefficient, but I'm not sure how much better</span>
<a href="#l53.66"></a><span id="l53.66" class="difflineminus">-  // we can make it.  We could index by topic, but we can't index by callback</span>
<a href="#l53.67"></a><span id="l53.67" class="difflineminus">-  // or thisObject, as far as I know, since the keys to JavaScript hashes</span>
<a href="#l53.68"></a><span id="l53.68" class="difflineminus">-  // (a.k.a. objects) can apparently only be primitive values.</span>
<a href="#l53.69"></a><span id="l53.69" class="difflineminus">-  var [observer] = cache.filter(function(v) {</span>
<a href="#l53.70"></a><span id="l53.70" class="difflineminus">-                                  return (v.topic      == topic    &amp;&amp;</span>
<a href="#l53.71"></a><span id="l53.71" class="difflineminus">-                                          v.callback   == callback &amp;&amp;</span>
<a href="#l53.72"></a><span id="l53.72" class="difflineminus">-                                          v.thisObject == thisObject);</span>
<a href="#l53.73"></a><span id="l53.73" class="difflineminus">-                                });</span>
<a href="#l53.74"></a><span id="l53.74" class="difflineminus">-  if (observer) {</span>
<a href="#l53.75"></a><span id="l53.75" class="difflineminus">-    service.removeObserver(observer, topic);</span>
<a href="#l53.76"></a><span id="l53.76" class="difflineminus">-    cache.splice(cache.indexOf(observer), 1);</span>
<a href="#l53.77"></a><span id="l53.77" class="difflineminus">-  }</span>
<a href="#l53.78"></a><span id="l53.78" class="difflineminus">-};</span>
<a href="#l53.79"></a><span id="l53.79" class="difflineminus">-</span>
<a href="#l53.80"></a><span id="l53.80" class="difflineminus">-/**</span>
<a href="#l53.81"></a><span id="l53.81" class="difflineminus">- * Notify observers about something.</span>
<a href="#l53.82"></a><span id="l53.82" class="difflineminus">- *</span>
<a href="#l53.83"></a><span id="l53.83" class="difflineminus">- * @param topic   {String}</span>
<a href="#l53.84"></a><span id="l53.84" class="difflineminus">- *        the topic to notify observers about</span>
<a href="#l53.85"></a><span id="l53.85" class="difflineminus">- *</span>
<a href="#l53.86"></a><span id="l53.86" class="difflineminus">- * @param subject {Object}  [optional]</span>
<a href="#l53.87"></a><span id="l53.87" class="difflineminus">- *        some information about the topic; can be any JS object or primitive</span>
<a href="#l53.88"></a><span id="l53.88" class="difflineminus">- *</span>
<a href="#l53.89"></a><span id="l53.89" class="difflineminus">- * @param data    {String}  [optional] [deprecated]</span>
<a href="#l53.90"></a><span id="l53.90" class="difflineminus">- *        some more information about the topic; deprecated as the subject</span>
<a href="#l53.91"></a><span id="l53.91" class="difflineminus">- *        is sufficient to pass all needed information to the JS observers</span>
<a href="#l53.92"></a><span id="l53.92" class="difflineminus">- *        that this module targets; if you have multiple values to pass to</span>
<a href="#l53.93"></a><span id="l53.93" class="difflineminus">- *        the observer, wrap them in an object and pass them via the subject</span>
<a href="#l53.94"></a><span id="l53.94" class="difflineminus">- *        parameter (i.e.: { foo: 1, bar: &quot;some string&quot;, baz: myObject })</span>
<a href="#l53.95"></a><span id="l53.95" class="difflineminus">- */</span>
<a href="#l53.96"></a><span id="l53.96" class="difflineminus">-var notify = exports.notify = function notify(topic, subject, data) {</span>
<a href="#l53.97"></a><span id="l53.97" class="difflineminus">-  subject = (typeof subject == &quot;undefined&quot;) ? null : new Subject(subject);</span>
<a href="#l53.98"></a><span id="l53.98" class="difflineminus">-  data = (typeof    data == &quot;undefined&quot;) ? null : data;</span>
<a href="#l53.99"></a><span id="l53.99" class="difflineminus">-  service.notifyObservers(subject, topic, data);</span>
<a href="#l53.100"></a><span id="l53.100" class="difflineminus">-};</span>
<a href="#l53.101"></a><span id="l53.101" class="difflineminus">-</span>
<a href="#l53.102"></a><span id="l53.102" class="difflineminus">-function Observer(topic, callback, thisObject) {</span>
<a href="#l53.103"></a><span id="l53.103" class="difflineminus">-  this.topic = topic;</span>
<a href="#l53.104"></a><span id="l53.104" class="difflineminus">-  this.callback = callback;</span>
<a href="#l53.105"></a><span id="l53.105" class="difflineminus">-  this.thisObject = thisObject;</span>
<a href="#l53.106"></a><span id="l53.106" class="difflineminus">-}</span>
<a href="#l53.107"></a><span id="l53.107" class="difflineminus">-</span>
<a href="#l53.108"></a><span id="l53.108" class="difflineminus">-Observer.prototype = {</span>
<a href="#l53.109"></a><span id="l53.109" class="difflineminus">-  QueryInterface: XPCOMUtils.generateQI([Ci.nsIObserver,</span>
<a href="#l53.110"></a><span id="l53.110" class="difflineminus">-                                         Ci.nsISupportsWeakReference]),</span>
<a href="#l53.111"></a><span id="l53.111" class="difflineminus">-  observe: function(subject, topic, data) {</span>
<a href="#l53.112"></a><span id="l53.112" class="difflineminus">-    // Extract the wrapped object for subjects that are one of our</span>
<a href="#l53.113"></a><span id="l53.113" class="difflineminus">-    // wrappers around a JS object.  This way we support both wrapped</span>
<a href="#l53.114"></a><span id="l53.114" class="difflineminus">-    // subjects created using this module and those that are real</span>
<a href="#l53.115"></a><span id="l53.115" class="difflineminus">-    // XPCOM components.</span>
<a href="#l53.116"></a><span id="l53.116" class="difflineminus">-    if (subject &amp;&amp; typeof subject == &quot;object&quot; &amp;&amp;</span>
<a href="#l53.117"></a><span id="l53.117" class="difflineminus">-        (&quot;wrappedJSObject&quot; in subject) &amp;&amp;</span>
<a href="#l53.118"></a><span id="l53.118" class="difflineminus">-        (&quot;observersModuleSubjectWrapper&quot; in subject.wrappedJSObject))</span>
<a href="#l53.119"></a><span id="l53.119" class="difflineminus">-      subject = subject.wrappedJSObject.object;</span>
<a href="#l53.120"></a><span id="l53.120" class="difflineminus">-</span>
<a href="#l53.121"></a><span id="l53.121" class="difflineminus">-    try {</span>
<a href="#l53.122"></a><span id="l53.122" class="difflineminus">-      if (typeof this.callback == &quot;function&quot;) {</span>
<a href="#l53.123"></a><span id="l53.123" class="difflineminus">-        if (this.thisObject)</span>
<a href="#l53.124"></a><span id="l53.124" class="difflineminus">-          this.callback.call(this.thisObject, subject, data);</span>
<a href="#l53.125"></a><span id="l53.125" class="difflineminus">-        else</span>
<a href="#l53.126"></a><span id="l53.126" class="difflineminus">-          this.callback(subject, data);</span>
<a href="#l53.127"></a><span id="l53.127" class="difflineminus">-      } else // typeof this.callback == &quot;object&quot; (nsIObserver)</span>
<a href="#l53.128"></a><span id="l53.128" class="difflineminus">-        this.callback.observe(subject, topic, data);</span>
<a href="#l53.129"></a><span id="l53.129" class="difflineminus">-    } catch (e) {</span>
<a href="#l53.130"></a><span id="l53.130" class="difflineminus">-      console.exception(e);</span>
<a href="#l53.131"></a><span id="l53.131" class="difflineminus">-    }</span>
<a href="#l53.132"></a><span id="l53.132" class="difflineminus">-  }</span>
<a href="#l53.133"></a><span id="l53.133" class="difflineminus">-};</span>
<a href="#l53.134"></a><span id="l53.134" class="difflineminus">-</span>
<a href="#l53.135"></a><span id="l53.135" class="difflineminus">-function Subject(object) {</span>
<a href="#l53.136"></a><span id="l53.136" class="difflineminus">-  // Double-wrap the object and set a property identifying the</span>
<a href="#l53.137"></a><span id="l53.137" class="difflineminus">-  // wrappedJSObject as one of our wrappers to distinguish between</span>
<a href="#l53.138"></a><span id="l53.138" class="difflineminus">-  // subjects that are one of our wrappers (which we should unwrap</span>
<a href="#l53.139"></a><span id="l53.139" class="difflineminus">-  // when notifying our observers) and those that are real JS XPCOM</span>
<a href="#l53.140"></a><span id="l53.140" class="difflineminus">-  // components (which we should pass through unaltered).</span>
<a href="#l53.141"></a><span id="l53.141" class="difflineminus">-  this.wrappedJSObject = {</span>
<a href="#l53.142"></a><span id="l53.142" class="difflineminus">-    observersModuleSubjectWrapper: true,</span>
<a href="#l53.143"></a><span id="l53.143" class="difflineminus">-    object: object</span>
<a href="#l53.144"></a><span id="l53.144" class="difflineminus">-  };</span>
<a href="#l53.145"></a><span id="l53.145" class="difflineminus">-}</span>
<a href="#l53.146"></a><span id="l53.146" class="difflineminus">-</span>
<a href="#l53.147"></a><span id="l53.147" class="difflineminus">-Subject.prototype = {</span>
<a href="#l53.148"></a><span id="l53.148" class="difflineminus">-  QueryInterface: XPCOMUtils.generateQI([]),</span>
<a href="#l53.149"></a><span id="l53.149" class="difflineminus">-  getHelperForLanguage: function() {},</span>
<a href="#l53.150"></a><span id="l53.150" class="difflineminus">-  getInterfaces: function() {}</span>
<a href="#l53.151"></a><span id="l53.151" class="difflineminus">-};</span>
<a href="#l53.152"></a><span id="l53.152" class="difflineminus">-</span>
<a href="#l53.153"></a><span id="l53.153" class="difflineminus">-require(&quot;unload&quot;).when(</span>
<a href="#l53.154"></a><span id="l53.154" class="difflineminus">-  function removeAllObservers() {</span>
<a href="#l53.155"></a><span id="l53.155" class="difflineminus">-    // Make a copy of cache first, since cache will be changing as we</span>
<a href="#l53.156"></a><span id="l53.156" class="difflineminus">-    // iterate through it.</span>
<a href="#l53.157"></a><span id="l53.157" class="difflineminus">-    cache.slice().forEach(</span>
<a href="#l53.158"></a><span id="l53.158" class="difflineminus">-      function(observer) {</span>
<a href="#l53.159"></a><span id="l53.159" class="difflineminus">-        remove(observer.topic, observer.callback, observer.thisObject);</span>
<a href="#l53.160"></a><span id="l53.160" class="difflineminus">-      });</span>
<a href="#l53.161"></a><span id="l53.161" class="difflineminus">-  });</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1">deleted file mode 100644</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/plain-text-console.js</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineplus">+++ /dev/null</span>
<a href="#l54.4"></a><span id="l54.4" class="difflineat">@@ -1,68 +0,0 @@</span>
<a href="#l54.5"></a><span id="l54.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l54.6"></a><span id="l54.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l54.7"></a><span id="l54.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l54.8"></a><span id="l54.8" class="difflineminus">-</span>
<a href="#l54.9"></a><span id="l54.9" class="difflineminus">-function stringify(arg) {</span>
<a href="#l54.10"></a><span id="l54.10" class="difflineminus">-  try {</span>
<a href="#l54.11"></a><span id="l54.11" class="difflineminus">-    return String(arg);</span>
<a href="#l54.12"></a><span id="l54.12" class="difflineminus">-  }</span>
<a href="#l54.13"></a><span id="l54.13" class="difflineminus">-  catch(ex) {</span>
<a href="#l54.14"></a><span id="l54.14" class="difflineminus">-    return &quot;&lt;toString() error&gt;&quot;;</span>
<a href="#l54.15"></a><span id="l54.15" class="difflineminus">-  }</span>
<a href="#l54.16"></a><span id="l54.16" class="difflineminus">-}</span>
<a href="#l54.17"></a><span id="l54.17" class="difflineminus">-</span>
<a href="#l54.18"></a><span id="l54.18" class="difflineminus">-function stringifyArgs(args) {</span>
<a href="#l54.19"></a><span id="l54.19" class="difflineminus">-  return Array.map(args, stringify).join(&quot; &quot;);</span>
<a href="#l54.20"></a><span id="l54.20" class="difflineminus">-}</span>
<a href="#l54.21"></a><span id="l54.21" class="difflineminus">-</span>
<a href="#l54.22"></a><span id="l54.22" class="difflineminus">-function message(print, level, args) {</span>
<a href="#l54.23"></a><span id="l54.23" class="difflineminus">-  print(level + &quot;: &quot; + stringifyArgs(args) + &quot;\n&quot;);</span>
<a href="#l54.24"></a><span id="l54.24" class="difflineminus">-}</span>
<a href="#l54.25"></a><span id="l54.25" class="difflineminus">-</span>
<a href="#l54.26"></a><span id="l54.26" class="difflineminus">-var Console = exports.PlainTextConsole = function PlainTextConsole(print) {</span>
<a href="#l54.27"></a><span id="l54.27" class="difflineminus">-  if (!print)</span>
<a href="#l54.28"></a><span id="l54.28" class="difflineminus">-    print = dump;</span>
<a href="#l54.29"></a><span id="l54.29" class="difflineminus">-  if (print === dump) {</span>
<a href="#l54.30"></a><span id="l54.30" class="difflineminus">-    // If we're just using dump(), auto-enable preferences so</span>
<a href="#l54.31"></a><span id="l54.31" class="difflineminus">-    // that the developer actually sees the console output.</span>
<a href="#l54.32"></a><span id="l54.32" class="difflineminus">-    var prefs = Cc[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l54.33"></a><span id="l54.33" class="difflineminus">-                .getService(Ci.nsIPrefBranch);</span>
<a href="#l54.34"></a><span id="l54.34" class="difflineminus">-    prefs.setBoolPref(&quot;browser.dom.window.dump.enabled&quot;, true);</span>
<a href="#l54.35"></a><span id="l54.35" class="difflineminus">-  }</span>
<a href="#l54.36"></a><span id="l54.36" class="difflineminus">-  this.print = print;</span>
<a href="#l54.37"></a><span id="l54.37" class="difflineminus">-};</span>
<a href="#l54.38"></a><span id="l54.38" class="difflineminus">-</span>
<a href="#l54.39"></a><span id="l54.39" class="difflineminus">-Console.prototype = {</span>
<a href="#l54.40"></a><span id="l54.40" class="difflineminus">-  log: function log() {</span>
<a href="#l54.41"></a><span id="l54.41" class="difflineminus">-    message(this.print, &quot;info&quot;, arguments);</span>
<a href="#l54.42"></a><span id="l54.42" class="difflineminus">-  },</span>
<a href="#l54.43"></a><span id="l54.43" class="difflineminus">-</span>
<a href="#l54.44"></a><span id="l54.44" class="difflineminus">-  info: function info() {</span>
<a href="#l54.45"></a><span id="l54.45" class="difflineminus">-    message(this.print, &quot;info&quot;, arguments);</span>
<a href="#l54.46"></a><span id="l54.46" class="difflineminus">-  },</span>
<a href="#l54.47"></a><span id="l54.47" class="difflineminus">-</span>
<a href="#l54.48"></a><span id="l54.48" class="difflineminus">-  warn: function warn() {</span>
<a href="#l54.49"></a><span id="l54.49" class="difflineminus">-    message(this.print, &quot;warning&quot;, arguments);</span>
<a href="#l54.50"></a><span id="l54.50" class="difflineminus">-  },</span>
<a href="#l54.51"></a><span id="l54.51" class="difflineminus">-</span>
<a href="#l54.52"></a><span id="l54.52" class="difflineminus">-  error: function error() {</span>
<a href="#l54.53"></a><span id="l54.53" class="difflineminus">-    message(this.print, &quot;error&quot;, arguments);</span>
<a href="#l54.54"></a><span id="l54.54" class="difflineminus">-  },</span>
<a href="#l54.55"></a><span id="l54.55" class="difflineminus">-</span>
<a href="#l54.56"></a><span id="l54.56" class="difflineminus">-  debug: function debug() {</span>
<a href="#l54.57"></a><span id="l54.57" class="difflineminus">-    message(this.print, &quot;debug&quot;, arguments);</span>
<a href="#l54.58"></a><span id="l54.58" class="difflineminus">-  },</span>
<a href="#l54.59"></a><span id="l54.59" class="difflineminus">-</span>
<a href="#l54.60"></a><span id="l54.60" class="difflineminus">-  exception: function exception(e) {</span>
<a href="#l54.61"></a><span id="l54.61" class="difflineminus">-    var fullString = (&quot;An exception occurred.\n&quot; +</span>
<a href="#l54.62"></a><span id="l54.62" class="difflineminus">-                      require(&quot;traceback&quot;).format(e) + &quot;\n&quot; + e);</span>
<a href="#l54.63"></a><span id="l54.63" class="difflineminus">-    this.error(fullString);</span>
<a href="#l54.64"></a><span id="l54.64" class="difflineminus">-  },</span>
<a href="#l54.65"></a><span id="l54.65" class="difflineminus">-</span>
<a href="#l54.66"></a><span id="l54.66" class="difflineminus">-  trace: function trace() {</span>
<a href="#l54.67"></a><span id="l54.67" class="difflineminus">-    var traceback = require(&quot;traceback&quot;);</span>
<a href="#l54.68"></a><span id="l54.68" class="difflineminus">-    var stack = traceback.get();</span>
<a href="#l54.69"></a><span id="l54.69" class="difflineminus">-    stack.splice(-1, 1);</span>
<a href="#l54.70"></a><span id="l54.70" class="difflineminus">-    message(this.print, &quot;info&quot;, [traceback.format(stack)]);</span>
<a href="#l54.71"></a><span id="l54.71" class="difflineminus">-  }</span>
<a href="#l54.72"></a><span id="l54.72" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1">deleted file mode 100644</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/preferences-service.js</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineplus">+++ /dev/null</span>
<a href="#l55.4"></a><span id="l55.4" class="difflineat">@@ -1,104 +0,0 @@</span>
<a href="#l55.5"></a><span id="l55.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l55.6"></a><span id="l55.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l55.7"></a><span id="l55.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l55.8"></a><span id="l55.8" class="difflineminus">-</span>
<a href="#l55.9"></a><span id="l55.9" class="difflineminus">-var jsm = {}; Cu.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;, jsm);</span>
<a href="#l55.10"></a><span id="l55.10" class="difflineminus">-var XPCOMUtils = jsm.XPCOMUtils;</span>
<a href="#l55.11"></a><span id="l55.11" class="difflineminus">-</span>
<a href="#l55.12"></a><span id="l55.12" class="difflineminus">-// The minimum and maximum integers that can be set as preferences.</span>
<a href="#l55.13"></a><span id="l55.13" class="difflineminus">-// The range of valid values is narrower than the range of valid JS values</span>
<a href="#l55.14"></a><span id="l55.14" class="difflineminus">-// because the native preferences code treats integers as NSPR PRInt32s,</span>
<a href="#l55.15"></a><span id="l55.15" class="difflineminus">-// which are 32-bit signed integers on all platforms.</span>
<a href="#l55.16"></a><span id="l55.16" class="difflineminus">-const MAX_INT = Math.pow(2, 31) - 1;</span>
<a href="#l55.17"></a><span id="l55.17" class="difflineminus">-const MIN_INT = -MAX_INT;</span>
<a href="#l55.18"></a><span id="l55.18" class="difflineminus">-</span>
<a href="#l55.19"></a><span id="l55.19" class="difflineminus">-var prefSvc = Cc[&quot;@mozilla.org/preferences-service;1&quot;].</span>
<a href="#l55.20"></a><span id="l55.20" class="difflineminus">-              getService(Ci.nsIPrefService).getBranch(null);</span>
<a href="#l55.21"></a><span id="l55.21" class="difflineminus">-</span>
<a href="#l55.22"></a><span id="l55.22" class="difflineminus">-var get = exports.get = function get(name, defaultValue) {</span>
<a href="#l55.23"></a><span id="l55.23" class="difflineminus">-  switch (prefSvc.getPrefType(name)) {</span>
<a href="#l55.24"></a><span id="l55.24" class="difflineminus">-  case Ci.nsIPrefBranch.PREF_STRING:</span>
<a href="#l55.25"></a><span id="l55.25" class="difflineminus">-    return prefSvc.getComplexValue(name, Ci.nsISupportsString).data;</span>
<a href="#l55.26"></a><span id="l55.26" class="difflineminus">-</span>
<a href="#l55.27"></a><span id="l55.27" class="difflineminus">-  case Ci.nsIPrefBranch.PREF_INT:</span>
<a href="#l55.28"></a><span id="l55.28" class="difflineminus">-    return prefSvc.getIntPref(name);</span>
<a href="#l55.29"></a><span id="l55.29" class="difflineminus">-</span>
<a href="#l55.30"></a><span id="l55.30" class="difflineminus">-  case Ci.nsIPrefBranch.PREF_BOOL:</span>
<a href="#l55.31"></a><span id="l55.31" class="difflineminus">-    return prefSvc.getBoolPref(name);</span>
<a href="#l55.32"></a><span id="l55.32" class="difflineminus">-</span>
<a href="#l55.33"></a><span id="l55.33" class="difflineminus">-  case Ci.nsIPrefBranch.PREF_INVALID:</span>
<a href="#l55.34"></a><span id="l55.34" class="difflineminus">-    return defaultValue;</span>
<a href="#l55.35"></a><span id="l55.35" class="difflineminus">-</span>
<a href="#l55.36"></a><span id="l55.36" class="difflineminus">-  default:</span>
<a href="#l55.37"></a><span id="l55.37" class="difflineminus">-    // This should never happen.</span>
<a href="#l55.38"></a><span id="l55.38" class="difflineminus">-    throw new Error(&quot;Error getting pref &quot; + name +</span>
<a href="#l55.39"></a><span id="l55.39" class="difflineminus">-                    &quot;; its value's type is &quot; +</span>
<a href="#l55.40"></a><span id="l55.40" class="difflineminus">-                    prefSvc.getPrefType(name) +</span>
<a href="#l55.41"></a><span id="l55.41" class="difflineminus">-                    &quot;, which I don't know &quot; +</span>
<a href="#l55.42"></a><span id="l55.42" class="difflineminus">-                    &quot;how to handle.&quot;);</span>
<a href="#l55.43"></a><span id="l55.43" class="difflineminus">-  }</span>
<a href="#l55.44"></a><span id="l55.44" class="difflineminus">-};</span>
<a href="#l55.45"></a><span id="l55.45" class="difflineminus">-</span>
<a href="#l55.46"></a><span id="l55.46" class="difflineminus">-var set = exports.set = function set(name, value) {</span>
<a href="#l55.47"></a><span id="l55.47" class="difflineminus">-  var prefType;</span>
<a href="#l55.48"></a><span id="l55.48" class="difflineminus">-  if (typeof value != &quot;undefined&quot; &amp;&amp; value != null)</span>
<a href="#l55.49"></a><span id="l55.49" class="difflineminus">-    prefType = value.constructor.name;</span>
<a href="#l55.50"></a><span id="l55.50" class="difflineminus">-</span>
<a href="#l55.51"></a><span id="l55.51" class="difflineminus">-  switch (prefType) {</span>
<a href="#l55.52"></a><span id="l55.52" class="difflineminus">-  case &quot;String&quot;:</span>
<a href="#l55.53"></a><span id="l55.53" class="difflineminus">-    {</span>
<a href="#l55.54"></a><span id="l55.54" class="difflineminus">-      var string = Cc[&quot;@mozilla.org/supports-string;1&quot;].</span>
<a href="#l55.55"></a><span id="l55.55" class="difflineminus">-                   createInstance(Ci.nsISupportsString);</span>
<a href="#l55.56"></a><span id="l55.56" class="difflineminus">-      string.data = value;</span>
<a href="#l55.57"></a><span id="l55.57" class="difflineminus">-      prefSvc.setComplexValue(name, Ci.nsISupportsString, string);</span>
<a href="#l55.58"></a><span id="l55.58" class="difflineminus">-    }</span>
<a href="#l55.59"></a><span id="l55.59" class="difflineminus">-    break;</span>
<a href="#l55.60"></a><span id="l55.60" class="difflineminus">-</span>
<a href="#l55.61"></a><span id="l55.61" class="difflineminus">-  case &quot;Number&quot;:</span>
<a href="#l55.62"></a><span id="l55.62" class="difflineminus">-    // We throw if the number is outside the range, since the result</span>
<a href="#l55.63"></a><span id="l55.63" class="difflineminus">-    // will never be what the consumer wanted to store, but we only warn</span>
<a href="#l55.64"></a><span id="l55.64" class="difflineminus">-    // if the number is non-integer, since the consumer might not mind</span>
<a href="#l55.65"></a><span id="l55.65" class="difflineminus">-    // the loss of precision.</span>
<a href="#l55.66"></a><span id="l55.66" class="difflineminus">-    if (value &gt; MAX_INT || value &lt; MIN_INT)</span>
<a href="#l55.67"></a><span id="l55.67" class="difflineminus">-      throw new Error(&quot;you cannot set the &quot; + name +</span>
<a href="#l55.68"></a><span id="l55.68" class="difflineminus">-                      &quot; pref to the number &quot; + value +</span>
<a href="#l55.69"></a><span id="l55.69" class="difflineminus">-                      &quot;, as number pref values must be in the signed &quot; +</span>
<a href="#l55.70"></a><span id="l55.70" class="difflineminus">-                      &quot;32-bit integer range -(2^31-1) to 2^31-1.  &quot; +</span>
<a href="#l55.71"></a><span id="l55.71" class="difflineminus">-                      &quot;To store numbers outside that range, store &quot; +</span>
<a href="#l55.72"></a><span id="l55.72" class="difflineminus">-                      &quot;them as strings.&quot;);</span>
<a href="#l55.73"></a><span id="l55.73" class="difflineminus">-    if (value % 1 != 0)</span>
<a href="#l55.74"></a><span id="l55.74" class="difflineminus">-      throw new Error(&quot;cannot store non-integer number: &quot; + value);</span>
<a href="#l55.75"></a><span id="l55.75" class="difflineminus">-    prefSvc.setIntPref(name, value);</span>
<a href="#l55.76"></a><span id="l55.76" class="difflineminus">-    break;</span>
<a href="#l55.77"></a><span id="l55.77" class="difflineminus">-</span>
<a href="#l55.78"></a><span id="l55.78" class="difflineminus">-  case &quot;Boolean&quot;:</span>
<a href="#l55.79"></a><span id="l55.79" class="difflineminus">-    prefSvc.setBoolPref(name, value);</span>
<a href="#l55.80"></a><span id="l55.80" class="difflineminus">-    break;</span>
<a href="#l55.81"></a><span id="l55.81" class="difflineminus">-</span>
<a href="#l55.82"></a><span id="l55.82" class="difflineminus">-  default:</span>
<a href="#l55.83"></a><span id="l55.83" class="difflineminus">-    throw new Error(&quot;can't set pref &quot; + name + &quot; to value '&quot; + value +</span>
<a href="#l55.84"></a><span id="l55.84" class="difflineminus">-                    &quot;'; it isn't a String, Number, or Boolean&quot;);</span>
<a href="#l55.85"></a><span id="l55.85" class="difflineminus">-  }</span>
<a href="#l55.86"></a><span id="l55.86" class="difflineminus">-};</span>
<a href="#l55.87"></a><span id="l55.87" class="difflineminus">-</span>
<a href="#l55.88"></a><span id="l55.88" class="difflineminus">-var has = exports.has = function has(name) {</span>
<a href="#l55.89"></a><span id="l55.89" class="difflineminus">-  return (prefSvc.getPrefType(name) != Ci.nsIPrefBranch.PREF_INVALID);</span>
<a href="#l55.90"></a><span id="l55.90" class="difflineminus">-};</span>
<a href="#l55.91"></a><span id="l55.91" class="difflineminus">-</span>
<a href="#l55.92"></a><span id="l55.92" class="difflineminus">-var isSet = exports.isSet = function isSet(name) {</span>
<a href="#l55.93"></a><span id="l55.93" class="difflineminus">-  return (has(name) &amp;&amp; prefSvc.prefHasUserValue(name));</span>
<a href="#l55.94"></a><span id="l55.94" class="difflineminus">-};</span>
<a href="#l55.95"></a><span id="l55.95" class="difflineminus">-</span>
<a href="#l55.96"></a><span id="l55.96" class="difflineminus">-var reset = exports.reset = function reset(name) {</span>
<a href="#l55.97"></a><span id="l55.97" class="difflineminus">-  try {</span>
<a href="#l55.98"></a><span id="l55.98" class="difflineminus">-    prefSvc.clearUserPref(name);</span>
<a href="#l55.99"></a><span id="l55.99" class="difflineminus">-  } catch (e if e.result == Cr.NS_ERROR_UNEXPECTED) {</span>
<a href="#l55.100"></a><span id="l55.100" class="difflineminus">-    // The pref service throws NS_ERROR_UNEXPECTED when the caller tries</span>
<a href="#l55.101"></a><span id="l55.101" class="difflineminus">-    // to reset a pref that doesn't exist or is already set to its default</span>
<a href="#l55.102"></a><span id="l55.102" class="difflineminus">-    // value.  This interface fails silently in those cases, so callers</span>
<a href="#l55.103"></a><span id="l55.103" class="difflineminus">-    // can unconditionally reset a pref without having to check if it needs</span>
<a href="#l55.104"></a><span id="l55.104" class="difflineminus">-    // resetting first or trap exceptions after the fact.  It passes through</span>
<a href="#l55.105"></a><span id="l55.105" class="difflineminus">-    // other exceptions, however, so callers know about them, since we don't</span>
<a href="#l55.106"></a><span id="l55.106" class="difflineminus">-    // know what other exceptions might be thrown and what they might mean.</span>
<a href="#l55.107"></a><span id="l55.107" class="difflineminus">-  }</span>
<a href="#l55.108"></a><span id="l55.108" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1">deleted file mode 100644</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/securable-module.js</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineplus">+++ /dev/null</span>
<a href="#l56.4"></a><span id="l56.4" class="difflineat">@@ -1,288 +0,0 @@</span>
<a href="#l56.5"></a><span id="l56.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l56.6"></a><span id="l56.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l56.7"></a><span id="l56.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l56.8"></a><span id="l56.8" class="difflineminus">-</span>
<a href="#l56.9"></a><span id="l56.9" class="difflineminus">-(function(global) {</span>
<a href="#l56.10"></a><span id="l56.10" class="difflineminus">-   const Cc = Components.classes;</span>
<a href="#l56.11"></a><span id="l56.11" class="difflineminus">-   const Ci = Components.interfaces;</span>
<a href="#l56.12"></a><span id="l56.12" class="difflineminus">-   const Cu = Components.utils;</span>
<a href="#l56.13"></a><span id="l56.13" class="difflineminus">-   const Cr = Components.results;</span>
<a href="#l56.14"></a><span id="l56.14" class="difflineminus">-</span>
<a href="#l56.15"></a><span id="l56.15" class="difflineminus">-   var exports = {};</span>
<a href="#l56.16"></a><span id="l56.16" class="difflineminus">-</span>
<a href="#l56.17"></a><span id="l56.17" class="difflineminus">-   var ios = Cc['@mozilla.org/network/io-service;1']</span>
<a href="#l56.18"></a><span id="l56.18" class="difflineminus">-             .getService(Ci.nsIIOService);</span>
<a href="#l56.19"></a><span id="l56.19" class="difflineminus">-</span>
<a href="#l56.20"></a><span id="l56.20" class="difflineminus">-   var systemPrincipal = Cc[&quot;@mozilla.org/systemprincipal;1&quot;]</span>
<a href="#l56.21"></a><span id="l56.21" class="difflineminus">-                         .createInstance(Ci.nsIPrincipal);</span>
<a href="#l56.22"></a><span id="l56.22" class="difflineminus">-</span>
<a href="#l56.23"></a><span id="l56.23" class="difflineminus">-   function resolvePrincipal(principal, defaultPrincipal) {</span>
<a href="#l56.24"></a><span id="l56.24" class="difflineminus">-     if (principal === undefined)</span>
<a href="#l56.25"></a><span id="l56.25" class="difflineminus">-       return defaultPrincipal;</span>
<a href="#l56.26"></a><span id="l56.26" class="difflineminus">-     if (principal == &quot;system&quot;)</span>
<a href="#l56.27"></a><span id="l56.27" class="difflineminus">-       return systemPrincipal;</span>
<a href="#l56.28"></a><span id="l56.28" class="difflineminus">-     return principal;</span>
<a href="#l56.29"></a><span id="l56.29" class="difflineminus">-   }</span>
<a href="#l56.30"></a><span id="l56.30" class="difflineminus">-</span>
<a href="#l56.31"></a><span id="l56.31" class="difflineminus">-   // The base URI to we use when we're given relative URLs, if any.</span>
<a href="#l56.32"></a><span id="l56.32" class="difflineminus">-   var baseURI = null;</span>
<a href="#l56.33"></a><span id="l56.33" class="difflineminus">-   if (global.window)</span>
<a href="#l56.34"></a><span id="l56.34" class="difflineminus">-     baseURI = ios.newURI(global.location.href, null, null);</span>
<a href="#l56.35"></a><span id="l56.35" class="difflineminus">-   exports.baseURI = baseURI;</span>
<a href="#l56.36"></a><span id="l56.36" class="difflineminus">-</span>
<a href="#l56.37"></a><span id="l56.37" class="difflineminus">-   // The &quot;parent&quot; chrome URI to use if we're loading code that</span>
<a href="#l56.38"></a><span id="l56.38" class="difflineminus">-   // needs chrome privileges but may not have a filename that</span>
<a href="#l56.39"></a><span id="l56.39" class="difflineminus">-   // matches any of SpiderMonkey's defined system filename prefixes.</span>
<a href="#l56.40"></a><span id="l56.40" class="difflineminus">-   // The latter is needed so that wrappers can be automatically</span>
<a href="#l56.41"></a><span id="l56.41" class="difflineminus">-   // made for the code. For more information on this, see</span>
<a href="#l56.42"></a><span id="l56.42" class="difflineminus">-   // bug 418356:</span>
<a href="#l56.43"></a><span id="l56.43" class="difflineminus">-   //</span>
<a href="#l56.44"></a><span id="l56.44" class="difflineminus">-   // https://bugzilla.mozilla.org/show_bug.cgi?id=418356</span>
<a href="#l56.45"></a><span id="l56.45" class="difflineminus">-   var parentChromeURIString;</span>
<a href="#l56.46"></a><span id="l56.46" class="difflineminus">-   if (baseURI)</span>
<a href="#l56.47"></a><span id="l56.47" class="difflineminus">-     // We're being loaded from a chrome-privileged document, so</span>
<a href="#l56.48"></a><span id="l56.48" class="difflineminus">-     // use its URL as the parent string.</span>
<a href="#l56.49"></a><span id="l56.49" class="difflineminus">-     parentChromeURIString = baseURI.spec;</span>
<a href="#l56.50"></a><span id="l56.50" class="difflineminus">-   else</span>
<a href="#l56.51"></a><span id="l56.51" class="difflineminus">-     // We're being loaded from a chrome-privileged JS module or</span>
<a href="#l56.52"></a><span id="l56.52" class="difflineminus">-     // SecurableModule, so use its filename (which may itself</span>
<a href="#l56.53"></a><span id="l56.53" class="difflineminus">-     // contain a reference to a parent).</span>
<a href="#l56.54"></a><span id="l56.54" class="difflineminus">-     parentChromeURIString = Components.stack.filename;</span>
<a href="#l56.55"></a><span id="l56.55" class="difflineminus">-</span>
<a href="#l56.56"></a><span id="l56.56" class="difflineminus">-   function maybeParentifyFilename(filename) {</span>
<a href="#l56.57"></a><span id="l56.57" class="difflineminus">-     var doParentifyFilename = true;</span>
<a href="#l56.58"></a><span id="l56.58" class="difflineminus">-     try {</span>
<a href="#l56.59"></a><span id="l56.59" class="difflineminus">-       // TODO: Ideally we should just make</span>
<a href="#l56.60"></a><span id="l56.60" class="difflineminus">-       // nsIChromeRegistry.wrappersEnabled() available from script</span>
<a href="#l56.61"></a><span id="l56.61" class="difflineminus">-       // and use it here. Until that's in the platform, though,</span>
<a href="#l56.62"></a><span id="l56.62" class="difflineminus">-       // we'll play it safe and parentify the filename unless</span>
<a href="#l56.63"></a><span id="l56.63" class="difflineminus">-       // we're absolutely certain things will be ok if we don't.</span>
<a href="#l56.64"></a><span id="l56.64" class="difflineminus">-       var filenameURI = ios.newURI(options.filename,</span>
<a href="#l56.65"></a><span id="l56.65" class="difflineminus">-                                    null,</span>
<a href="#l56.66"></a><span id="l56.66" class="difflineminus">-                                    baseURI);</span>
<a href="#l56.67"></a><span id="l56.67" class="difflineminus">-       if (filenameURI.scheme == 'chrome' &amp;&amp;</span>
<a href="#l56.68"></a><span id="l56.68" class="difflineminus">-           filenameURI.path.indexOf('/content/') == 0)</span>
<a href="#l56.69"></a><span id="l56.69" class="difflineminus">-         // Content packages will always have wrappers made for them;</span>
<a href="#l56.70"></a><span id="l56.70" class="difflineminus">-         // if automatic wrappers have been disabled for the</span>
<a href="#l56.71"></a><span id="l56.71" class="difflineminus">-         // chrome package via a chrome manifest flag, then</span>
<a href="#l56.72"></a><span id="l56.72" class="difflineminus">-         // this still works too, to the extent that the</span>
<a href="#l56.73"></a><span id="l56.73" class="difflineminus">-         // content package is insecure anyways.</span>
<a href="#l56.74"></a><span id="l56.74" class="difflineminus">-         doParentifyFilename = false;</span>
<a href="#l56.75"></a><span id="l56.75" class="difflineminus">-     } catch (e) {}</span>
<a href="#l56.76"></a><span id="l56.76" class="difflineminus">-     if (doParentifyFilename)</span>
<a href="#l56.77"></a><span id="l56.77" class="difflineminus">-       return parentChromeURIString + &quot; -&gt; &quot; + filename;</span>
<a href="#l56.78"></a><span id="l56.78" class="difflineminus">-     return filename;</span>
<a href="#l56.79"></a><span id="l56.79" class="difflineminus">-   }</span>
<a href="#l56.80"></a><span id="l56.80" class="difflineminus">-</span>
<a href="#l56.81"></a><span id="l56.81" class="difflineminus">-   function getRootDir(urlStr) {</span>
<a href="#l56.82"></a><span id="l56.82" class="difflineminus">-     // TODO: This feels hacky, and like there will be edge cases.</span>
<a href="#l56.83"></a><span id="l56.83" class="difflineminus">-     return urlStr.slice(0, urlStr.lastIndexOf(&quot;/&quot;) + 1);</span>
<a href="#l56.84"></a><span id="l56.84" class="difflineminus">-   }</span>
<a href="#l56.85"></a><span id="l56.85" class="difflineminus">-</span>
<a href="#l56.86"></a><span id="l56.86" class="difflineminus">-   exports.SandboxFactory = function SandboxFactory(defaultPrincipal) {</span>
<a href="#l56.87"></a><span id="l56.87" class="difflineminus">-     // Unless specified otherwise, use a principal with limited</span>
<a href="#l56.88"></a><span id="l56.88" class="difflineminus">-     // privileges.</span>
<a href="#l56.89"></a><span id="l56.89" class="difflineminus">-     this._defaultPrincipal = resolvePrincipal(defaultPrincipal,</span>
<a href="#l56.90"></a><span id="l56.90" class="difflineminus">-                                               &quot;http://www.mozilla.org&quot;);</span>
<a href="#l56.91"></a><span id="l56.91" class="difflineminus">-   },</span>
<a href="#l56.92"></a><span id="l56.92" class="difflineminus">-</span>
<a href="#l56.93"></a><span id="l56.93" class="difflineminus">-   exports.SandboxFactory.prototype = {</span>
<a href="#l56.94"></a><span id="l56.94" class="difflineminus">-     createSandbox: function createSandbox(options) {</span>
<a href="#l56.95"></a><span id="l56.95" class="difflineminus">-       var principal = resolvePrincipal(options.principal,</span>
<a href="#l56.96"></a><span id="l56.96" class="difflineminus">-                                        this._defaultPrincipal);</span>
<a href="#l56.97"></a><span id="l56.97" class="difflineminus">-</span>
<a href="#l56.98"></a><span id="l56.98" class="difflineminus">-       return {</span>
<a href="#l56.99"></a><span id="l56.99" class="difflineminus">-         _sandbox: new Cu.Sandbox(principal),</span>
<a href="#l56.100"></a><span id="l56.100" class="difflineminus">-         _principal: principal,</span>
<a href="#l56.101"></a><span id="l56.101" class="difflineminus">-         defineProperty: function defineProperty(name, value) {</span>
<a href="#l56.102"></a><span id="l56.102" class="difflineminus">-           this._sandbox[name] = value;</span>
<a href="#l56.103"></a><span id="l56.103" class="difflineminus">-         },</span>
<a href="#l56.104"></a><span id="l56.104" class="difflineminus">-         evaluate: function evaluate(options) {</span>
<a href="#l56.105"></a><span id="l56.105" class="difflineminus">-           if (typeof(options) == 'string')</span>
<a href="#l56.106"></a><span id="l56.106" class="difflineminus">-             options = {contents: options};</span>
<a href="#l56.107"></a><span id="l56.107" class="difflineminus">-           options = {__proto__: options};</span>
<a href="#l56.108"></a><span id="l56.108" class="difflineminus">-           if (typeof(options.contents) != 'string')</span>
<a href="#l56.109"></a><span id="l56.109" class="difflineminus">-             throw new Error('Expected string for options.contents');</span>
<a href="#l56.110"></a><span id="l56.110" class="difflineminus">-           if (options.lineNo === undefined)</span>
<a href="#l56.111"></a><span id="l56.111" class="difflineminus">-             options.lineNo = 1;</span>
<a href="#l56.112"></a><span id="l56.112" class="difflineminus">-           if (options.jsVersion === undefined)</span>
<a href="#l56.113"></a><span id="l56.113" class="difflineminus">-             options.jsVersion = &quot;1.8&quot;;</span>
<a href="#l56.114"></a><span id="l56.114" class="difflineminus">-           if (typeof(options.filename) != 'string')</span>
<a href="#l56.115"></a><span id="l56.115" class="difflineminus">-             options.filename = '&lt;string&gt;';</span>
<a href="#l56.116"></a><span id="l56.116" class="difflineminus">-</span>
<a href="#l56.117"></a><span id="l56.117" class="difflineminus">-           if (this._principal == systemPrincipal)</span>
<a href="#l56.118"></a><span id="l56.118" class="difflineminus">-             options.filename = maybeParentifyFilename(options.filename);</span>
<a href="#l56.119"></a><span id="l56.119" class="difflineminus">-</span>
<a href="#l56.120"></a><span id="l56.120" class="difflineminus">-           return Cu.evalInSandbox(options.contents,</span>
<a href="#l56.121"></a><span id="l56.121" class="difflineminus">-                                   this._sandbox,</span>
<a href="#l56.122"></a><span id="l56.122" class="difflineminus">-                                   options.jsVersion,</span>
<a href="#l56.123"></a><span id="l56.123" class="difflineminus">-                                   options.filename,</span>
<a href="#l56.124"></a><span id="l56.124" class="difflineminus">-                                   options.lineNo);</span>
<a href="#l56.125"></a><span id="l56.125" class="difflineminus">-         }</span>
<a href="#l56.126"></a><span id="l56.126" class="difflineminus">-       };</span>
<a href="#l56.127"></a><span id="l56.127" class="difflineminus">-     }</span>
<a href="#l56.128"></a><span id="l56.128" class="difflineminus">-   };</span>
<a href="#l56.129"></a><span id="l56.129" class="difflineminus">-</span>
<a href="#l56.130"></a><span id="l56.130" class="difflineminus">-   exports.Loader = function Loader(options) {</span>
<a href="#l56.131"></a><span id="l56.131" class="difflineminus">-     options = {__proto__: options};</span>
<a href="#l56.132"></a><span id="l56.132" class="difflineminus">-     if (options.fs === undefined) {</span>
<a href="#l56.133"></a><span id="l56.133" class="difflineminus">-       var rootPaths = options.rootPath || options.rootPaths;</span>
<a href="#l56.134"></a><span id="l56.134" class="difflineminus">-       if (rootPaths) {</span>
<a href="#l56.135"></a><span id="l56.135" class="difflineminus">-         if (rootPaths.constructor.name != &quot;Array&quot;)</span>
<a href="#l56.136"></a><span id="l56.136" class="difflineminus">-           rootPaths = [rootPaths];</span>
<a href="#l56.137"></a><span id="l56.137" class="difflineminus">-         var fses = [new exports.LocalFileSystem(path)</span>
<a href="#l56.138"></a><span id="l56.138" class="difflineminus">-                     for each (path in rootPaths)];</span>
<a href="#l56.139"></a><span id="l56.139" class="difflineminus">-         options.fs = new exports.CompositeFileSystem(fses);</span>
<a href="#l56.140"></a><span id="l56.140" class="difflineminus">-       } else</span>
<a href="#l56.141"></a><span id="l56.141" class="difflineminus">-         options.fs = new exports.LocalFileSystem();</span>
<a href="#l56.142"></a><span id="l56.142" class="difflineminus">-     }</span>
<a href="#l56.143"></a><span id="l56.143" class="difflineminus">-     if (options.sandboxFactory === undefined)</span>
<a href="#l56.144"></a><span id="l56.144" class="difflineminus">-       options.sandboxFactory = new exports.SandboxFactory(</span>
<a href="#l56.145"></a><span id="l56.145" class="difflineminus">-         options.defaultPrincipal</span>
<a href="#l56.146"></a><span id="l56.146" class="difflineminus">-       );</span>
<a href="#l56.147"></a><span id="l56.147" class="difflineminus">-     if (options.modules === undefined)</span>
<a href="#l56.148"></a><span id="l56.148" class="difflineminus">-       options.modules = {};</span>
<a href="#l56.149"></a><span id="l56.149" class="difflineminus">-     if (options.globals === undefined)</span>
<a href="#l56.150"></a><span id="l56.150" class="difflineminus">-       options.globals = {};</span>
<a href="#l56.151"></a><span id="l56.151" class="difflineminus">-</span>
<a href="#l56.152"></a><span id="l56.152" class="difflineminus">-     this.fs = options.fs;</span>
<a href="#l56.153"></a><span id="l56.153" class="difflineminus">-     this.sandboxFactory = options.sandboxFactory;</span>
<a href="#l56.154"></a><span id="l56.154" class="difflineminus">-     this.modules = options.modules;</span>
<a href="#l56.155"></a><span id="l56.155" class="difflineminus">-     this.globals = options.globals;</span>
<a href="#l56.156"></a><span id="l56.156" class="difflineminus">-   };</span>
<a href="#l56.157"></a><span id="l56.157" class="difflineminus">-</span>
<a href="#l56.158"></a><span id="l56.158" class="difflineminus">-   exports.Loader.prototype = {</span>
<a href="#l56.159"></a><span id="l56.159" class="difflineminus">-     _makeRequire: function _makeRequire(rootDir) {</span>
<a href="#l56.160"></a><span id="l56.160" class="difflineminus">-       var self = this;</span>
<a href="#l56.161"></a><span id="l56.161" class="difflineminus">-</span>
<a href="#l56.162"></a><span id="l56.162" class="difflineminus">-       return function require(module) {</span>
<a href="#l56.163"></a><span id="l56.163" class="difflineminus">-         var path = self.fs.resolveModule(rootDir, module);</span>
<a href="#l56.164"></a><span id="l56.164" class="difflineminus">-         if (!path)</span>
<a href="#l56.165"></a><span id="l56.165" class="difflineminus">-           throw new Error('Module &quot;' + module + '&quot; not found');</span>
<a href="#l56.166"></a><span id="l56.166" class="difflineminus">-         if (!(path in self.modules)) {</span>
<a href="#l56.167"></a><span id="l56.167" class="difflineminus">-           var options = self.fs.getFile(path);</span>
<a href="#l56.168"></a><span id="l56.168" class="difflineminus">-           if (options.filename === undefined)</span>
<a href="#l56.169"></a><span id="l56.169" class="difflineminus">-             options.filename = path;</span>
<a href="#l56.170"></a><span id="l56.170" class="difflineminus">-</span>
<a href="#l56.171"></a><span id="l56.171" class="difflineminus">-           var exports = {};</span>
<a href="#l56.172"></a><span id="l56.172" class="difflineminus">-           var sandbox = self.sandboxFactory.createSandbox(options);</span>
<a href="#l56.173"></a><span id="l56.173" class="difflineminus">-           for (name in self.globals)</span>
<a href="#l56.174"></a><span id="l56.174" class="difflineminus">-             sandbox.defineProperty(name, self.globals[name]);</span>
<a href="#l56.175"></a><span id="l56.175" class="difflineminus">-           sandbox.defineProperty('require', self._makeRequire(path));</span>
<a href="#l56.176"></a><span id="l56.176" class="difflineminus">-           sandbox.defineProperty('exports', exports);</span>
<a href="#l56.177"></a><span id="l56.177" class="difflineminus">-           self.modules[path] = exports;</span>
<a href="#l56.178"></a><span id="l56.178" class="difflineminus">-           sandbox.evaluate(options);</span>
<a href="#l56.179"></a><span id="l56.179" class="difflineminus">-         }</span>
<a href="#l56.180"></a><span id="l56.180" class="difflineminus">-         return self.modules[path];</span>
<a href="#l56.181"></a><span id="l56.181" class="difflineminus">-       };</span>
<a href="#l56.182"></a><span id="l56.182" class="difflineminus">-     },</span>
<a href="#l56.183"></a><span id="l56.183" class="difflineminus">-</span>
<a href="#l56.184"></a><span id="l56.184" class="difflineminus">-     require: function require(module) {</span>
<a href="#l56.185"></a><span id="l56.185" class="difflineminus">-       return (this._makeRequire(null))(module);</span>
<a href="#l56.186"></a><span id="l56.186" class="difflineminus">-     },</span>
<a href="#l56.187"></a><span id="l56.187" class="difflineminus">-</span>
<a href="#l56.188"></a><span id="l56.188" class="difflineminus">-     runScript: function runScript(options) {</span>
<a href="#l56.189"></a><span id="l56.189" class="difflineminus">-       if (typeof(options) == 'string')</span>
<a href="#l56.190"></a><span id="l56.190" class="difflineminus">-         options = {contents: options};</span>
<a href="#l56.191"></a><span id="l56.191" class="difflineminus">-       options = {__proto__: options};</span>
<a href="#l56.192"></a><span id="l56.192" class="difflineminus">-       var sandbox = this.sandboxFactory.createSandbox(options);</span>
<a href="#l56.193"></a><span id="l56.193" class="difflineminus">-       for (name in this.globals)</span>
<a href="#l56.194"></a><span id="l56.194" class="difflineminus">-         sandbox.defineProperty(name, this.globals[name]);</span>
<a href="#l56.195"></a><span id="l56.195" class="difflineminus">-       sandbox.defineProperty('require', this._makeRequire(null));</span>
<a href="#l56.196"></a><span id="l56.196" class="difflineminus">-       return sandbox.evaluate(options);</span>
<a href="#l56.197"></a><span id="l56.197" class="difflineminus">-     }</span>
<a href="#l56.198"></a><span id="l56.198" class="difflineminus">-   };</span>
<a href="#l56.199"></a><span id="l56.199" class="difflineminus">-</span>
<a href="#l56.200"></a><span id="l56.200" class="difflineminus">-   exports.CompositeFileSystem = function CompositeFileSystem(fses) {</span>
<a href="#l56.201"></a><span id="l56.201" class="difflineminus">-     this.fses = fses;</span>
<a href="#l56.202"></a><span id="l56.202" class="difflineminus">-     this._pathMap = {};</span>
<a href="#l56.203"></a><span id="l56.203" class="difflineminus">-   };</span>
<a href="#l56.204"></a><span id="l56.204" class="difflineminus">-</span>
<a href="#l56.205"></a><span id="l56.205" class="difflineminus">-   exports.CompositeFileSystem.prototype = {</span>
<a href="#l56.206"></a><span id="l56.206" class="difflineminus">-     resolveModule: function resolveModule(base, path) {</span>
<a href="#l56.207"></a><span id="l56.207" class="difflineminus">-       for (var i = 0; i &lt; this.fses.length; i++) {</span>
<a href="#l56.208"></a><span id="l56.208" class="difflineminus">-         var fs = this.fses[i];</span>
<a href="#l56.209"></a><span id="l56.209" class="difflineminus">-         var absPath = fs.resolveModule(base, path);</span>
<a href="#l56.210"></a><span id="l56.210" class="difflineminus">-         if (absPath) {</span>
<a href="#l56.211"></a><span id="l56.211" class="difflineminus">-           this._pathMap[absPath] = fs;</span>
<a href="#l56.212"></a><span id="l56.212" class="difflineminus">-           return absPath;</span>
<a href="#l56.213"></a><span id="l56.213" class="difflineminus">-         }</span>
<a href="#l56.214"></a><span id="l56.214" class="difflineminus">-       }</span>
<a href="#l56.215"></a><span id="l56.215" class="difflineminus">-       return null;</span>
<a href="#l56.216"></a><span id="l56.216" class="difflineminus">-     },</span>
<a href="#l56.217"></a><span id="l56.217" class="difflineminus">-     getFile: function getFile(path) {</span>
<a href="#l56.218"></a><span id="l56.218" class="difflineminus">-       return this._pathMap[path].getFile(path);</span>
<a href="#l56.219"></a><span id="l56.219" class="difflineminus">-     }</span>
<a href="#l56.220"></a><span id="l56.220" class="difflineminus">-   };</span>
<a href="#l56.221"></a><span id="l56.221" class="difflineminus">-</span>
<a href="#l56.222"></a><span id="l56.222" class="difflineminus">-   exports.LocalFileSystem = function LocalFileSystem(root) {</span>
<a href="#l56.223"></a><span id="l56.223" class="difflineminus">-     if (root === undefined) {</span>
<a href="#l56.224"></a><span id="l56.224" class="difflineminus">-       if (!baseURI)</span>
<a href="#l56.225"></a><span id="l56.225" class="difflineminus">-         throw new Error(&quot;Need a root path for module filesystem&quot;);</span>
<a href="#l56.226"></a><span id="l56.226" class="difflineminus">-       root = baseURI;</span>
<a href="#l56.227"></a><span id="l56.227" class="difflineminus">-     }</span>
<a href="#l56.228"></a><span id="l56.228" class="difflineminus">-     if (typeof(root) == 'string')</span>
<a href="#l56.229"></a><span id="l56.229" class="difflineminus">-       root = ios.newURI(root, null, baseURI);</span>
<a href="#l56.230"></a><span id="l56.230" class="difflineminus">-     if (root instanceof Ci.nsIFile)</span>
<a href="#l56.231"></a><span id="l56.231" class="difflineminus">-       root = ios.newFileURI(root);</span>
<a href="#l56.232"></a><span id="l56.232" class="difflineminus">-     if (!(root instanceof Ci.nsIURI))</span>
<a href="#l56.233"></a><span id="l56.233" class="difflineminus">-       throw new Error('Expected nsIFile, nsIURI, or string for root');</span>
<a href="#l56.234"></a><span id="l56.234" class="difflineminus">-</span>
<a href="#l56.235"></a><span id="l56.235" class="difflineminus">-     this.root = root.spec;</span>
<a href="#l56.236"></a><span id="l56.236" class="difflineminus">-     this._rootURI = root;</span>
<a href="#l56.237"></a><span id="l56.237" class="difflineminus">-     this._rootURIDir = getRootDir(root.spec);</span>
<a href="#l56.238"></a><span id="l56.238" class="difflineminus">-   };</span>
<a href="#l56.239"></a><span id="l56.239" class="difflineminus">-</span>
<a href="#l56.240"></a><span id="l56.240" class="difflineminus">-   exports.LocalFileSystem.prototype = {</span>
<a href="#l56.241"></a><span id="l56.241" class="difflineminus">-     resolveModule: function resolveModule(base, path) {</span>
<a href="#l56.242"></a><span id="l56.242" class="difflineminus">-       path = path + &quot;.js&quot;;</span>
<a href="#l56.243"></a><span id="l56.243" class="difflineminus">-</span>
<a href="#l56.244"></a><span id="l56.244" class="difflineminus">-       var baseURI;</span>
<a href="#l56.245"></a><span id="l56.245" class="difflineminus">-       if (!base || path.charAt(0) != '.')</span>
<a href="#l56.246"></a><span id="l56.246" class="difflineminus">-         baseURI = this._rootURI;</span>
<a href="#l56.247"></a><span id="l56.247" class="difflineminus">-       else</span>
<a href="#l56.248"></a><span id="l56.248" class="difflineminus">-         baseURI = ios.newURI(base, null, null);</span>
<a href="#l56.249"></a><span id="l56.249" class="difflineminus">-       var newURI = ios.newURI(path, null, baseURI);</span>
<a href="#l56.250"></a><span id="l56.250" class="difflineminus">-       if (newURI.spec.indexOf(this._rootURIDir) == 0) {</span>
<a href="#l56.251"></a><span id="l56.251" class="difflineminus">-         var channel = ios.newChannelFromURI(newURI);</span>
<a href="#l56.252"></a><span id="l56.252" class="difflineminus">-         try {</span>
<a href="#l56.253"></a><span id="l56.253" class="difflineminus">-           channel.open().close();</span>
<a href="#l56.254"></a><span id="l56.254" class="difflineminus">-         } catch (e if e.result == Cr.NS_ERROR_FILE_NOT_FOUND) {</span>
<a href="#l56.255"></a><span id="l56.255" class="difflineminus">-           return null;</span>
<a href="#l56.256"></a><span id="l56.256" class="difflineminus">-         }</span>
<a href="#l56.257"></a><span id="l56.257" class="difflineminus">-         return newURI.spec;</span>
<a href="#l56.258"></a><span id="l56.258" class="difflineminus">-       }</span>
<a href="#l56.259"></a><span id="l56.259" class="difflineminus">-       return null;</span>
<a href="#l56.260"></a><span id="l56.260" class="difflineminus">-     },</span>
<a href="#l56.261"></a><span id="l56.261" class="difflineminus">-     getFile: function getFile(path) {</span>
<a href="#l56.262"></a><span id="l56.262" class="difflineminus">-       var channel = ios.newChannel(path, null, null);</span>
<a href="#l56.263"></a><span id="l56.263" class="difflineminus">-       var iStream = channel.open();</span>
<a href="#l56.264"></a><span id="l56.264" class="difflineminus">-       var siStream = Cc['@mozilla.org/scriptableinputstream;1']</span>
<a href="#l56.265"></a><span id="l56.265" class="difflineminus">-                      .createInstance(Ci.nsIScriptableInputStream);</span>
<a href="#l56.266"></a><span id="l56.266" class="difflineminus">-       siStream.init(iStream);</span>
<a href="#l56.267"></a><span id="l56.267" class="difflineminus">-       var data = new String();</span>
<a href="#l56.268"></a><span id="l56.268" class="difflineminus">-       data += siStream.read(-1);</span>
<a href="#l56.269"></a><span id="l56.269" class="difflineminus">-       siStream.close();</span>
<a href="#l56.270"></a><span id="l56.270" class="difflineminus">-       iStream.close();</span>
<a href="#l56.271"></a><span id="l56.271" class="difflineminus">-       return {contents: data};</span>
<a href="#l56.272"></a><span id="l56.272" class="difflineminus">-     }</span>
<a href="#l56.273"></a><span id="l56.273" class="difflineminus">-   };</span>
<a href="#l56.274"></a><span id="l56.274" class="difflineminus">-</span>
<a href="#l56.275"></a><span id="l56.275" class="difflineminus">-   if (global.window) {</span>
<a href="#l56.276"></a><span id="l56.276" class="difflineminus">-     // We're being loaded in a chrome window, or a web page with</span>
<a href="#l56.277"></a><span id="l56.277" class="difflineminus">-     // UniversalXPConnect privileges.</span>
<a href="#l56.278"></a><span id="l56.278" class="difflineminus">-     global.SecurableModule = exports;</span>
<a href="#l56.279"></a><span id="l56.279" class="difflineminus">-   } else if (global.exports) {</span>
<a href="#l56.280"></a><span id="l56.280" class="difflineminus">-     // We're being loaded in a SecurableModule.</span>
<a href="#l56.281"></a><span id="l56.281" class="difflineminus">-     for (name in exports) {</span>
<a href="#l56.282"></a><span id="l56.282" class="difflineminus">-       global.exports[name] = exports[name];</span>
<a href="#l56.283"></a><span id="l56.283" class="difflineminus">-     }</span>
<a href="#l56.284"></a><span id="l56.284" class="difflineminus">-   } else {</span>
<a href="#l56.285"></a><span id="l56.285" class="difflineminus">-     // We're being loaded in a JS module.</span>
<a href="#l56.286"></a><span id="l56.286" class="difflineminus">-     global.EXPORTED_SYMBOLS = [];</span>
<a href="#l56.287"></a><span id="l56.287" class="difflineminus">-     for (name in exports) {</span>
<a href="#l56.288"></a><span id="l56.288" class="difflineminus">-       global.EXPORTED_SYMBOLS.push(name);</span>
<a href="#l56.289"></a><span id="l56.289" class="difflineminus">-       global[name] = exports[name];</span>
<a href="#l56.290"></a><span id="l56.290" class="difflineminus">-     }</span>
<a href="#l56.291"></a><span id="l56.291" class="difflineminus">-   }</span>
<a href="#l56.292"></a><span id="l56.292" class="difflineminus">- })(this);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l57.1"></a><span id="l57.1">deleted file mode 100644</span>
<a href="#l57.2"></a><span id="l57.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/timer.js</span>
<a href="#l57.3"></a><span id="l57.3" class="difflineplus">+++ /dev/null</span>
<a href="#l57.4"></a><span id="l57.4" class="difflineat">@@ -1,56 +0,0 @@</span>
<a href="#l57.5"></a><span id="l57.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l57.6"></a><span id="l57.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l57.7"></a><span id="l57.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l57.8"></a><span id="l57.8" class="difflineminus">-</span>
<a href="#l57.9"></a><span id="l57.9" class="difflineminus">-var jsm = {}; Cu.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;, jsm);</span>
<a href="#l57.10"></a><span id="l57.10" class="difflineminus">-var XPCOMUtils = jsm.XPCOMUtils;</span>
<a href="#l57.11"></a><span id="l57.11" class="difflineminus">-</span>
<a href="#l57.12"></a><span id="l57.12" class="difflineminus">-var timerClass = Cc[&quot;@mozilla.org/timer;1&quot;];</span>
<a href="#l57.13"></a><span id="l57.13" class="difflineminus">-var nextID = 1;</span>
<a href="#l57.14"></a><span id="l57.14" class="difflineminus">-var timers = {};</span>
<a href="#l57.15"></a><span id="l57.15" class="difflineminus">-</span>
<a href="#l57.16"></a><span id="l57.16" class="difflineminus">-function TimerCallback(callback) {</span>
<a href="#l57.17"></a><span id="l57.17" class="difflineminus">-  this._callback = callback;</span>
<a href="#l57.18"></a><span id="l57.18" class="difflineminus">-  this.QueryInterface = XPCOMUtils.generateQI([Ci.nsITimerCallback]);</span>
<a href="#l57.19"></a><span id="l57.19" class="difflineminus">-};</span>
<a href="#l57.20"></a><span id="l57.20" class="difflineminus">-</span>
<a href="#l57.21"></a><span id="l57.21" class="difflineminus">-TimerCallback.prototype = {</span>
<a href="#l57.22"></a><span id="l57.22" class="difflineminus">-  notify : function notify(timer) {</span>
<a href="#l57.23"></a><span id="l57.23" class="difflineminus">-    try {</span>
<a href="#l57.24"></a><span id="l57.24" class="difflineminus">-      for (timerID in timers)</span>
<a href="#l57.25"></a><span id="l57.25" class="difflineminus">-        if (timers[timerID] === timer) {</span>
<a href="#l57.26"></a><span id="l57.26" class="difflineminus">-          delete timers[timerID];</span>
<a href="#l57.27"></a><span id="l57.27" class="difflineminus">-          break;</span>
<a href="#l57.28"></a><span id="l57.28" class="difflineminus">-        }</span>
<a href="#l57.29"></a><span id="l57.29" class="difflineminus">-      this._callback.apply(null, []);</span>
<a href="#l57.30"></a><span id="l57.30" class="difflineminus">-    } catch (e) {</span>
<a href="#l57.31"></a><span id="l57.31" class="difflineminus">-      console.exception(e);</span>
<a href="#l57.32"></a><span id="l57.32" class="difflineminus">-    }</span>
<a href="#l57.33"></a><span id="l57.33" class="difflineminus">-  }</span>
<a href="#l57.34"></a><span id="l57.34" class="difflineminus">-};</span>
<a href="#l57.35"></a><span id="l57.35" class="difflineminus">-</span>
<a href="#l57.36"></a><span id="l57.36" class="difflineminus">-var setTimeout = exports.setTimeout = function setTimeout(callback, delay) {</span>
<a href="#l57.37"></a><span id="l57.37" class="difflineminus">-  var timer = timerClass.createInstance(Ci.nsITimer);</span>
<a href="#l57.38"></a><span id="l57.38" class="difflineminus">-</span>
<a href="#l57.39"></a><span id="l57.39" class="difflineminus">-  var timerID = nextID++;</span>
<a href="#l57.40"></a><span id="l57.40" class="difflineminus">-  timers[timerID] = timer;</span>
<a href="#l57.41"></a><span id="l57.41" class="difflineminus">-</span>
<a href="#l57.42"></a><span id="l57.42" class="difflineminus">-  timer.initWithCallback(new TimerCallback(callback),</span>
<a href="#l57.43"></a><span id="l57.43" class="difflineminus">-                         delay,</span>
<a href="#l57.44"></a><span id="l57.44" class="difflineminus">-                         timer.TYPE_ONE_SHOT);</span>
<a href="#l57.45"></a><span id="l57.45" class="difflineminus">-  return timerID;</span>
<a href="#l57.46"></a><span id="l57.46" class="difflineminus">-};</span>
<a href="#l57.47"></a><span id="l57.47" class="difflineminus">-</span>
<a href="#l57.48"></a><span id="l57.48" class="difflineminus">-var clearTimeout = exports.clearTimeout = function clearTimeout(timerID) {</span>
<a href="#l57.49"></a><span id="l57.49" class="difflineminus">-  var timer = timers[timerID];</span>
<a href="#l57.50"></a><span id="l57.50" class="difflineminus">-  if (timer) {</span>
<a href="#l57.51"></a><span id="l57.51" class="difflineminus">-    timer.cancel();</span>
<a href="#l57.52"></a><span id="l57.52" class="difflineminus">-    delete timers[timerID];</span>
<a href="#l57.53"></a><span id="l57.53" class="difflineminus">-  }</span>
<a href="#l57.54"></a><span id="l57.54" class="difflineminus">-};</span>
<a href="#l57.55"></a><span id="l57.55" class="difflineminus">-</span>
<a href="#l57.56"></a><span id="l57.56" class="difflineminus">-require(&quot;unload&quot;).when(</span>
<a href="#l57.57"></a><span id="l57.57" class="difflineminus">-  function cancelAllPendingTimers() {</span>
<a href="#l57.58"></a><span id="l57.58" class="difflineminus">-    var timerIDs = [timerID for (timerID in timers)];</span>
<a href="#l57.59"></a><span id="l57.59" class="difflineminus">-    timerIDs.forEach(function(timerID) { clearTimeout(timerID); });</span>
<a href="#l57.60"></a><span id="l57.60" class="difflineminus">-  });</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l58.1"></a><span id="l58.1">deleted file mode 100644</span>
<a href="#l58.2"></a><span id="l58.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/traceback.js</span>
<a href="#l58.3"></a><span id="l58.3" class="difflineplus">+++ /dev/null</span>
<a href="#l58.4"></a><span id="l58.4" class="difflineat">@@ -1,108 +0,0 @@</span>
<a href="#l58.5"></a><span id="l58.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l58.6"></a><span id="l58.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l58.7"></a><span id="l58.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l58.8"></a><span id="l58.8" class="difflineminus">-</span>
<a href="#l58.9"></a><span id="l58.9" class="difflineminus">-// Undo the auto-parentification of URLs done in bug 418356.</span>
<a href="#l58.10"></a><span id="l58.10" class="difflineminus">-function deParentifyURL(url) {</span>
<a href="#l58.11"></a><span id="l58.11" class="difflineminus">-  return url ? url.split(&quot; -&gt; &quot;).slice(-1)[0] : url;</span>
<a href="#l58.12"></a><span id="l58.12" class="difflineminus">-}</span>
<a href="#l58.13"></a><span id="l58.13" class="difflineminus">-</span>
<a href="#l58.14"></a><span id="l58.14" class="difflineminus">-// TODO: We might want to move this function to url or some similar</span>
<a href="#l58.15"></a><span id="l58.15" class="difflineminus">-// module.</span>
<a href="#l58.16"></a><span id="l58.16" class="difflineminus">-function getLocalFile(path) {</span>
<a href="#l58.17"></a><span id="l58.17" class="difflineminus">-  var ios = Cc['@mozilla.org/network/io-service;1']</span>
<a href="#l58.18"></a><span id="l58.18" class="difflineminus">-            .getService(Ci.nsIIOService);</span>
<a href="#l58.19"></a><span id="l58.19" class="difflineminus">-  var channel = ios.newChannel(path, null, null);</span>
<a href="#l58.20"></a><span id="l58.20" class="difflineminus">-  var iStream = channel.open();</span>
<a href="#l58.21"></a><span id="l58.21" class="difflineminus">-  var siStream = Cc['@mozilla.org/scriptableinputstream;1']</span>
<a href="#l58.22"></a><span id="l58.22" class="difflineminus">-                 .createInstance(Ci.nsIScriptableInputStream);</span>
<a href="#l58.23"></a><span id="l58.23" class="difflineminus">-  siStream.init(iStream);</span>
<a href="#l58.24"></a><span id="l58.24" class="difflineminus">-  var data = new String();</span>
<a href="#l58.25"></a><span id="l58.25" class="difflineminus">-  data += siStream.read(-1);</span>
<a href="#l58.26"></a><span id="l58.26" class="difflineminus">-  siStream.close();</span>
<a href="#l58.27"></a><span id="l58.27" class="difflineminus">-  iStream.close();</span>
<a href="#l58.28"></a><span id="l58.28" class="difflineminus">-  return data;</span>
<a href="#l58.29"></a><span id="l58.29" class="difflineminus">-}</span>
<a href="#l58.30"></a><span id="l58.30" class="difflineminus">-</span>
<a href="#l58.31"></a><span id="l58.31" class="difflineminus">-function safeGetFileLine(path, line) {</span>
<a href="#l58.32"></a><span id="l58.32" class="difflineminus">-  try {</span>
<a href="#l58.33"></a><span id="l58.33" class="difflineminus">-    var scheme = require(&quot;url&quot;).parse(path).scheme;</span>
<a href="#l58.34"></a><span id="l58.34" class="difflineminus">-    // TODO: There should be an easier, more accurate way to figure out</span>
<a href="#l58.35"></a><span id="l58.35" class="difflineminus">-    // what's the case here.</span>
<a href="#l58.36"></a><span id="l58.36" class="difflineminus">-    if (!(scheme == &quot;http&quot; || scheme == &quot;https&quot;))</span>
<a href="#l58.37"></a><span id="l58.37" class="difflineminus">-      return getLocalFile(path).split(&quot;\n&quot;)[line - 1];</span>
<a href="#l58.38"></a><span id="l58.38" class="difflineminus">-  } catch (e) {}</span>
<a href="#l58.39"></a><span id="l58.39" class="difflineminus">-  return null;</span>
<a href="#l58.40"></a><span id="l58.40" class="difflineminus">-}</span>
<a href="#l58.41"></a><span id="l58.41" class="difflineminus">-</span>
<a href="#l58.42"></a><span id="l58.42" class="difflineminus">-function errorStackToJSON(stack) {</span>
<a href="#l58.43"></a><span id="l58.43" class="difflineminus">-  var lines = stack.split(&quot;\n&quot;);</span>
<a href="#l58.44"></a><span id="l58.44" class="difflineminus">-</span>
<a href="#l58.45"></a><span id="l58.45" class="difflineminus">-  var frames = [];</span>
<a href="#l58.46"></a><span id="l58.46" class="difflineminus">-  lines.forEach(</span>
<a href="#l58.47"></a><span id="l58.47" class="difflineminus">-    function(line) {</span>
<a href="#l58.48"></a><span id="l58.48" class="difflineminus">-      if (!line)</span>
<a href="#l58.49"></a><span id="l58.49" class="difflineminus">-        return;</span>
<a href="#l58.50"></a><span id="l58.50" class="difflineminus">-      var atIndex = line.indexOf(&quot;@&quot;);</span>
<a href="#l58.51"></a><span id="l58.51" class="difflineminus">-      var colonIndex = line.lastIndexOf(&quot;:&quot;);</span>
<a href="#l58.52"></a><span id="l58.52" class="difflineminus">-      var filename = deParentifyURL(line.slice(atIndex + 1, colonIndex));</span>
<a href="#l58.53"></a><span id="l58.53" class="difflineminus">-      var lineNo = parseInt(line.slice(colonIndex + 1));</span>
<a href="#l58.54"></a><span id="l58.54" class="difflineminus">-      var funcSig = line.slice(0, atIndex);</span>
<a href="#l58.55"></a><span id="l58.55" class="difflineminus">-      var funcName = funcSig.slice(0, funcSig.indexOf(&quot;(&quot;));</span>
<a href="#l58.56"></a><span id="l58.56" class="difflineminus">-      frames.unshift({filename: filename,</span>
<a href="#l58.57"></a><span id="l58.57" class="difflineminus">-                      funcName: funcName,</span>
<a href="#l58.58"></a><span id="l58.58" class="difflineminus">-                      lineNo: lineNo});</span>
<a href="#l58.59"></a><span id="l58.59" class="difflineminus">-    });</span>
<a href="#l58.60"></a><span id="l58.60" class="difflineminus">-</span>
<a href="#l58.61"></a><span id="l58.61" class="difflineminus">-  return frames;</span>
<a href="#l58.62"></a><span id="l58.62" class="difflineminus">-};</span>
<a href="#l58.63"></a><span id="l58.63" class="difflineminus">-</span>
<a href="#l58.64"></a><span id="l58.64" class="difflineminus">-function nsIStackFramesToJSON(frame) {</span>
<a href="#l58.65"></a><span id="l58.65" class="difflineminus">-  var stack = [];</span>
<a href="#l58.66"></a><span id="l58.66" class="difflineminus">-</span>
<a href="#l58.67"></a><span id="l58.67" class="difflineminus">-  while (frame) {</span>
<a href="#l58.68"></a><span id="l58.68" class="difflineminus">-    var filename = deParentifyURL(frame.filename);</span>
<a href="#l58.69"></a><span id="l58.69" class="difflineminus">-    stack.splice(0, 0, {filename: filename,</span>
<a href="#l58.70"></a><span id="l58.70" class="difflineminus">-                        lineNo: frame.lineNumber,</span>
<a href="#l58.71"></a><span id="l58.71" class="difflineminus">-                        funcName: frame.name});</span>
<a href="#l58.72"></a><span id="l58.72" class="difflineminus">-    frame = frame.caller;</span>
<a href="#l58.73"></a><span id="l58.73" class="difflineminus">-  }</span>
<a href="#l58.74"></a><span id="l58.74" class="difflineminus">-</span>
<a href="#l58.75"></a><span id="l58.75" class="difflineminus">-  return stack;</span>
<a href="#l58.76"></a><span id="l58.76" class="difflineminus">-};</span>
<a href="#l58.77"></a><span id="l58.77" class="difflineminus">-</span>
<a href="#l58.78"></a><span id="l58.78" class="difflineminus">-var fromException = exports.fromException = function fromException(e) {</span>
<a href="#l58.79"></a><span id="l58.79" class="difflineminus">-  if (e instanceof Ci.nsIException)</span>
<a href="#l58.80"></a><span id="l58.80" class="difflineminus">-    return nsIStackFramesToJSON(e.location);</span>
<a href="#l58.81"></a><span id="l58.81" class="difflineminus">-  return errorStackToJSON(e.stack);</span>
<a href="#l58.82"></a><span id="l58.82" class="difflineminus">-};</span>
<a href="#l58.83"></a><span id="l58.83" class="difflineminus">-</span>
<a href="#l58.84"></a><span id="l58.84" class="difflineminus">-var get = exports.get = function get() {</span>
<a href="#l58.85"></a><span id="l58.85" class="difflineminus">-  return nsIStackFramesToJSON(Components.stack.caller);</span>
<a href="#l58.86"></a><span id="l58.86" class="difflineminus">-};</span>
<a href="#l58.87"></a><span id="l58.87" class="difflineminus">-</span>
<a href="#l58.88"></a><span id="l58.88" class="difflineminus">-var format = exports.format = function format(tbOrException) {</span>
<a href="#l58.89"></a><span id="l58.89" class="difflineminus">-  if (tbOrException === undefined) {</span>
<a href="#l58.90"></a><span id="l58.90" class="difflineminus">-    tbOrException = get();</span>
<a href="#l58.91"></a><span id="l58.91" class="difflineminus">-    tbOrException.splice(-1, 1);</span>
<a href="#l58.92"></a><span id="l58.92" class="difflineminus">-  }</span>
<a href="#l58.93"></a><span id="l58.93" class="difflineminus">-</span>
<a href="#l58.94"></a><span id="l58.94" class="difflineminus">-  var tb;</span>
<a href="#l58.95"></a><span id="l58.95" class="difflineminus">-  if (tbOrException.length === undefined)</span>
<a href="#l58.96"></a><span id="l58.96" class="difflineminus">-    tb = fromException(tbOrException);</span>
<a href="#l58.97"></a><span id="l58.97" class="difflineminus">-  else</span>
<a href="#l58.98"></a><span id="l58.98" class="difflineminus">-    tb = tbOrException;</span>
<a href="#l58.99"></a><span id="l58.99" class="difflineminus">-</span>
<a href="#l58.100"></a><span id="l58.100" class="difflineminus">-  var lines = [&quot;Traceback (most recent call last):&quot;];</span>
<a href="#l58.101"></a><span id="l58.101" class="difflineminus">-</span>
<a href="#l58.102"></a><span id="l58.102" class="difflineminus">-  tb.forEach(</span>
<a href="#l58.103"></a><span id="l58.103" class="difflineminus">-    function(frame) {</span>
<a href="#l58.104"></a><span id="l58.104" class="difflineminus">-      lines.push('  File &quot;' + frame.filename + '&quot;, line ' +</span>
<a href="#l58.105"></a><span id="l58.105" class="difflineminus">-                 frame.lineNo + ', in ' + frame.funcName);</span>
<a href="#l58.106"></a><span id="l58.106" class="difflineminus">-      var sourceLine = safeGetFileLine(frame.filename, frame.lineNo);</span>
<a href="#l58.107"></a><span id="l58.107" class="difflineminus">-      if (sourceLine)</span>
<a href="#l58.108"></a><span id="l58.108" class="difflineminus">-        lines.push('    ' + sourceLine.trim());</span>
<a href="#l58.109"></a><span id="l58.109" class="difflineminus">-    });</span>
<a href="#l58.110"></a><span id="l58.110" class="difflineminus">-</span>
<a href="#l58.111"></a><span id="l58.111" class="difflineminus">-  return lines.join(&quot;\n&quot;);</span>
<a href="#l58.112"></a><span id="l58.112" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l59.1"></a><span id="l59.1">deleted file mode 100644</span>
<a href="#l59.2"></a><span id="l59.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/unit-test.js</span>
<a href="#l59.3"></a><span id="l59.3" class="difflineplus">+++ /dev/null</span>
<a href="#l59.4"></a><span id="l59.4" class="difflineat">@@ -1,199 +0,0 @@</span>
<a href="#l59.5"></a><span id="l59.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l59.6"></a><span id="l59.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l59.7"></a><span id="l59.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l59.8"></a><span id="l59.8" class="difflineminus">-</span>
<a href="#l59.9"></a><span id="l59.9" class="difflineminus">-var timer = require(&quot;timer&quot;);</span>
<a href="#l59.10"></a><span id="l59.10" class="difflineminus">-var file = require(&quot;file&quot;);</span>
<a href="#l59.11"></a><span id="l59.11" class="difflineminus">-</span>
<a href="#l59.12"></a><span id="l59.12" class="difflineminus">-exports.findAndRunTests = function findAndRunTests(options) {</span>
<a href="#l59.13"></a><span id="l59.13" class="difflineminus">-  var finder = new TestFinder(options.dirs);</span>
<a href="#l59.14"></a><span id="l59.14" class="difflineminus">-  var runner = new TestRunner();</span>
<a href="#l59.15"></a><span id="l59.15" class="difflineminus">-  runner.startMany({tests: finder.findTests(),</span>
<a href="#l59.16"></a><span id="l59.16" class="difflineminus">-                    onDone: options.onDone});</span>
<a href="#l59.17"></a><span id="l59.17" class="difflineminus">-};</span>
<a href="#l59.18"></a><span id="l59.18" class="difflineminus">-</span>
<a href="#l59.19"></a><span id="l59.19" class="difflineminus">-var TestFinder = exports.TestFinder = function TestFinder(dirs) {</span>
<a href="#l59.20"></a><span id="l59.20" class="difflineminus">-  this.dirs = dirs;</span>
<a href="#l59.21"></a><span id="l59.21" class="difflineminus">-};</span>
<a href="#l59.22"></a><span id="l59.22" class="difflineminus">-</span>
<a href="#l59.23"></a><span id="l59.23" class="difflineminus">-TestFinder.prototype = {</span>
<a href="#l59.24"></a><span id="l59.24" class="difflineminus">-  _makeTest: function _makeTest(suite, name, test) {</span>
<a href="#l59.25"></a><span id="l59.25" class="difflineminus">-    function runTest(runner) {</span>
<a href="#l59.26"></a><span id="l59.26" class="difflineminus">-      console.info(&quot;executing '&quot; + suite + &quot;.&quot; + name + &quot;'&quot;);</span>
<a href="#l59.27"></a><span id="l59.27" class="difflineminus">-      test(runner);</span>
<a href="#l59.28"></a><span id="l59.28" class="difflineminus">-    }</span>
<a href="#l59.29"></a><span id="l59.29" class="difflineminus">-    return runTest;</span>
<a href="#l59.30"></a><span id="l59.30" class="difflineminus">-  },</span>
<a href="#l59.31"></a><span id="l59.31" class="difflineminus">-</span>
<a href="#l59.32"></a><span id="l59.32" class="difflineminus">-  findTests: function findTests() {</span>
<a href="#l59.33"></a><span id="l59.33" class="difflineminus">-    var self = this;</span>
<a href="#l59.34"></a><span id="l59.34" class="difflineminus">-    var tests = [];</span>
<a href="#l59.35"></a><span id="l59.35" class="difflineminus">-</span>
<a href="#l59.36"></a><span id="l59.36" class="difflineminus">-    this.dirs.forEach(</span>
<a href="#l59.37"></a><span id="l59.37" class="difflineminus">-      function(dir) {</span>
<a href="#l59.38"></a><span id="l59.38" class="difflineminus">-        var suites = [name.slice(0, -3)</span>
<a href="#l59.39"></a><span id="l59.39" class="difflineminus">-                      for each (name in file.list(dir))</span>
<a href="#l59.40"></a><span id="l59.40" class="difflineminus">-                      if (/^test-.*\.js$/.test(name))];</span>
<a href="#l59.41"></a><span id="l59.41" class="difflineminus">-</span>
<a href="#l59.42"></a><span id="l59.42" class="difflineminus">-        suites.forEach(</span>
<a href="#l59.43"></a><span id="l59.43" class="difflineminus">-          function(suite) {</span>
<a href="#l59.44"></a><span id="l59.44" class="difflineminus">-            var module = require(suite);</span>
<a href="#l59.45"></a><span id="l59.45" class="difflineminus">-            for (name in module)</span>
<a href="#l59.46"></a><span id="l59.46" class="difflineminus">-              if (name.indexOf(&quot;test&quot;) == 0)</span>
<a href="#l59.47"></a><span id="l59.47" class="difflineminus">-                tests.push(self._makeTest(suite, name, module[name]));</span>
<a href="#l59.48"></a><span id="l59.48" class="difflineminus">-          });</span>
<a href="#l59.49"></a><span id="l59.49" class="difflineminus">-      });</span>
<a href="#l59.50"></a><span id="l59.50" class="difflineminus">-    return tests;</span>
<a href="#l59.51"></a><span id="l59.51" class="difflineminus">-  }</span>
<a href="#l59.52"></a><span id="l59.52" class="difflineminus">-};</span>
<a href="#l59.53"></a><span id="l59.53" class="difflineminus">-</span>
<a href="#l59.54"></a><span id="l59.54" class="difflineminus">-var TestRunner = exports.TestRunner = function TestRunner(options) {</span>
<a href="#l59.55"></a><span id="l59.55" class="difflineminus">-  this.passed = 0;</span>
<a href="#l59.56"></a><span id="l59.56" class="difflineminus">-  this.failed = 0;</span>
<a href="#l59.57"></a><span id="l59.57" class="difflineminus">-};</span>
<a href="#l59.58"></a><span id="l59.58" class="difflineminus">-</span>
<a href="#l59.59"></a><span id="l59.59" class="difflineminus">-TestRunner.prototype = {</span>
<a href="#l59.60"></a><span id="l59.60" class="difflineminus">-  DEFAULT_PAUSE_TIMEOUT: 10000,</span>
<a href="#l59.61"></a><span id="l59.61" class="difflineminus">-</span>
<a href="#l59.62"></a><span id="l59.62" class="difflineminus">-  makeSandboxedLoader: function makeSandboxedLoader(options) {</span>
<a href="#l59.63"></a><span id="l59.63" class="difflineminus">-    if (!options)</span>
<a href="#l59.64"></a><span id="l59.64" class="difflineminus">-      options = {};</span>
<a href="#l59.65"></a><span id="l59.65" class="difflineminus">-    var Cuddlefish = require(&quot;cuddlefish&quot;);</span>
<a href="#l59.66"></a><span id="l59.66" class="difflineminus">-</span>
<a href="#l59.67"></a><span id="l59.67" class="difflineminus">-    options.fs = Cuddlefish.parentLoader.fs;</span>
<a href="#l59.68"></a><span id="l59.68" class="difflineminus">-    return new Cuddlefish.Loader(options);</span>
<a href="#l59.69"></a><span id="l59.69" class="difflineminus">-  },</span>
<a href="#l59.70"></a><span id="l59.70" class="difflineminus">-</span>
<a href="#l59.71"></a><span id="l59.71" class="difflineminus">-  pass: function pass(message) {</span>
<a href="#l59.72"></a><span id="l59.72" class="difflineminus">-    console.info(&quot;pass:&quot;, message);</span>
<a href="#l59.73"></a><span id="l59.73" class="difflineminus">-    this.passed++;</span>
<a href="#l59.74"></a><span id="l59.74" class="difflineminus">-  },</span>
<a href="#l59.75"></a><span id="l59.75" class="difflineminus">-</span>
<a href="#l59.76"></a><span id="l59.76" class="difflineminus">-  fail: function fail(message) {</span>
<a href="#l59.77"></a><span id="l59.77" class="difflineminus">-    console.error(&quot;fail:&quot;, message);</span>
<a href="#l59.78"></a><span id="l59.78" class="difflineminus">-    this.failed++;</span>
<a href="#l59.79"></a><span id="l59.79" class="difflineminus">-  },</span>
<a href="#l59.80"></a><span id="l59.80" class="difflineminus">-</span>
<a href="#l59.81"></a><span id="l59.81" class="difflineminus">-  exception: function exception(e) {</span>
<a href="#l59.82"></a><span id="l59.82" class="difflineminus">-    console.exception(e);</span>
<a href="#l59.83"></a><span id="l59.83" class="difflineminus">-    this.failed++;</span>
<a href="#l59.84"></a><span id="l59.84" class="difflineminus">-  },</span>
<a href="#l59.85"></a><span id="l59.85" class="difflineminus">-</span>
<a href="#l59.86"></a><span id="l59.86" class="difflineminus">-  assertMatches: function assertMatches(string, regexp, message) {</span>
<a href="#l59.87"></a><span id="l59.87" class="difflineminus">-    if (regexp.test(string)) {</span>
<a href="#l59.88"></a><span id="l59.88" class="difflineminus">-      if (!message)</span>
<a href="#l59.89"></a><span id="l59.89" class="difflineminus">-        message = uneval(string) + &quot; matches &quot; + uneval(regexp);</span>
<a href="#l59.90"></a><span id="l59.90" class="difflineminus">-      this.pass(message);</span>
<a href="#l59.91"></a><span id="l59.91" class="difflineminus">-    } else {</span>
<a href="#l59.92"></a><span id="l59.92" class="difflineminus">-      var no = uneval(string) + &quot; doesn't match &quot; + uneval(regexp);</span>
<a href="#l59.93"></a><span id="l59.93" class="difflineminus">-      if (!message)</span>
<a href="#l59.94"></a><span id="l59.94" class="difflineminus">-        message = no;</span>
<a href="#l59.95"></a><span id="l59.95" class="difflineminus">-      else</span>
<a href="#l59.96"></a><span id="l59.96" class="difflineminus">-        message = message + &quot; (&quot; + no + &quot;)&quot;;</span>
<a href="#l59.97"></a><span id="l59.97" class="difflineminus">-      this.fail(message);</span>
<a href="#l59.98"></a><span id="l59.98" class="difflineminus">-    }</span>
<a href="#l59.99"></a><span id="l59.99" class="difflineminus">-  },</span>
<a href="#l59.100"></a><span id="l59.100" class="difflineminus">-</span>
<a href="#l59.101"></a><span id="l59.101" class="difflineminus">-  assertRaises: function assertRaises(func, predicate, message) {</span>
<a href="#l59.102"></a><span id="l59.102" class="difflineminus">-    try {</span>
<a href="#l59.103"></a><span id="l59.103" class="difflineminus">-      func();</span>
<a href="#l59.104"></a><span id="l59.104" class="difflineminus">-      if (message)</span>
<a href="#l59.105"></a><span id="l59.105" class="difflineminus">-        this.fail(message + &quot; (no exception thrown)&quot;);</span>
<a href="#l59.106"></a><span id="l59.106" class="difflineminus">-      else</span>
<a href="#l59.107"></a><span id="l59.107" class="difflineminus">-        this.fail(&quot;function failed to throw exception&quot;);</span>
<a href="#l59.108"></a><span id="l59.108" class="difflineminus">-    } catch (e) {</span>
<a href="#l59.109"></a><span id="l59.109" class="difflineminus">-      if (typeof(predicate) == &quot;object&quot;)</span>
<a href="#l59.110"></a><span id="l59.110" class="difflineminus">-        this.assertMatches(e.message, predicate, message);</span>
<a href="#l59.111"></a><span id="l59.111" class="difflineminus">-      else</span>
<a href="#l59.112"></a><span id="l59.112" class="difflineminus">-        this.assertEqual(e.message, predicate, message);</span>
<a href="#l59.113"></a><span id="l59.113" class="difflineminus">-    }</span>
<a href="#l59.114"></a><span id="l59.114" class="difflineminus">-  },</span>
<a href="#l59.115"></a><span id="l59.115" class="difflineminus">-</span>
<a href="#l59.116"></a><span id="l59.116" class="difflineminus">-  assertNotEqual: function assertNotEqual(a, b, message) {</span>
<a href="#l59.117"></a><span id="l59.117" class="difflineminus">-    if (a != b) {</span>
<a href="#l59.118"></a><span id="l59.118" class="difflineminus">-      if (!message)</span>
<a href="#l59.119"></a><span id="l59.119" class="difflineminus">-        message = &quot;a != b != &quot; + uneval(a);</span>
<a href="#l59.120"></a><span id="l59.120" class="difflineminus">-      this.pass(message);</span>
<a href="#l59.121"></a><span id="l59.121" class="difflineminus">-    } else {</span>
<a href="#l59.122"></a><span id="l59.122" class="difflineminus">-      var equality = uneval(a) + &quot; == &quot; + uneval(b);</span>
<a href="#l59.123"></a><span id="l59.123" class="difflineminus">-      if (!message)</span>
<a href="#l59.124"></a><span id="l59.124" class="difflineminus">-        message = equality;</span>
<a href="#l59.125"></a><span id="l59.125" class="difflineminus">-      else</span>
<a href="#l59.126"></a><span id="l59.126" class="difflineminus">-        message += &quot; (&quot; + equality + &quot;)&quot;;</span>
<a href="#l59.127"></a><span id="l59.127" class="difflineminus">-      this.fail(message);</span>
<a href="#l59.128"></a><span id="l59.128" class="difflineminus">-    }</span>
<a href="#l59.129"></a><span id="l59.129" class="difflineminus">-  },</span>
<a href="#l59.130"></a><span id="l59.130" class="difflineminus">-</span>
<a href="#l59.131"></a><span id="l59.131" class="difflineminus">-  assertEqual: function assertEqual(a, b, message) {</span>
<a href="#l59.132"></a><span id="l59.132" class="difflineminus">-    if (a == b) {</span>
<a href="#l59.133"></a><span id="l59.133" class="difflineminus">-      if (!message)</span>
<a href="#l59.134"></a><span id="l59.134" class="difflineminus">-        message = &quot;a == b == &quot; + uneval(a);</span>
<a href="#l59.135"></a><span id="l59.135" class="difflineminus">-      this.pass(message);</span>
<a href="#l59.136"></a><span id="l59.136" class="difflineminus">-    } else {</span>
<a href="#l59.137"></a><span id="l59.137" class="difflineminus">-      var inequality = uneval(a) + &quot; != &quot; + uneval(b);</span>
<a href="#l59.138"></a><span id="l59.138" class="difflineminus">-      if (!message)</span>
<a href="#l59.139"></a><span id="l59.139" class="difflineminus">-        message = inequality;</span>
<a href="#l59.140"></a><span id="l59.140" class="difflineminus">-      else</span>
<a href="#l59.141"></a><span id="l59.141" class="difflineminus">-        message += &quot; (&quot; + inequality + &quot;)&quot;;</span>
<a href="#l59.142"></a><span id="l59.142" class="difflineminus">-      this.fail(message);</span>
<a href="#l59.143"></a><span id="l59.143" class="difflineminus">-    }</span>
<a href="#l59.144"></a><span id="l59.144" class="difflineminus">-  },</span>
<a href="#l59.145"></a><span id="l59.145" class="difflineminus">-</span>
<a href="#l59.146"></a><span id="l59.146" class="difflineminus">-  done: function done() {</span>
<a href="#l59.147"></a><span id="l59.147" class="difflineminus">-    if (!this.isDone) {</span>
<a href="#l59.148"></a><span id="l59.148" class="difflineminus">-      this.isDone = true;</span>
<a href="#l59.149"></a><span id="l59.149" class="difflineminus">-      if (this.waitTimeout !== null) {</span>
<a href="#l59.150"></a><span id="l59.150" class="difflineminus">-        timer.clearTimeout(this.waitTimeout);</span>
<a href="#l59.151"></a><span id="l59.151" class="difflineminus">-        this.waitTimeout = null;</span>
<a href="#l59.152"></a><span id="l59.152" class="difflineminus">-      }</span>
<a href="#l59.153"></a><span id="l59.153" class="difflineminus">-      if (this.onDone !== null) {</span>
<a href="#l59.154"></a><span id="l59.154" class="difflineminus">-        var onDone = this.onDone;</span>
<a href="#l59.155"></a><span id="l59.155" class="difflineminus">-        this.onDone = null;</span>
<a href="#l59.156"></a><span id="l59.156" class="difflineminus">-        onDone(this);</span>
<a href="#l59.157"></a><span id="l59.157" class="difflineminus">-      }</span>
<a href="#l59.158"></a><span id="l59.158" class="difflineminus">-    }</span>
<a href="#l59.159"></a><span id="l59.159" class="difflineminus">-  },</span>
<a href="#l59.160"></a><span id="l59.160" class="difflineminus">-</span>
<a href="#l59.161"></a><span id="l59.161" class="difflineminus">-  waitUntilDone: function waitUntilDone(ms) {</span>
<a href="#l59.162"></a><span id="l59.162" class="difflineminus">-    if (ms === undefined)</span>
<a href="#l59.163"></a><span id="l59.163" class="difflineminus">-      ms = this.DEFAULT_PAUSE_TIMEOUT;</span>
<a href="#l59.164"></a><span id="l59.164" class="difflineminus">-</span>
<a href="#l59.165"></a><span id="l59.165" class="difflineminus">-    var self = this;</span>
<a href="#l59.166"></a><span id="l59.166" class="difflineminus">-</span>
<a href="#l59.167"></a><span id="l59.167" class="difflineminus">-    function tiredOfWaiting() {</span>
<a href="#l59.168"></a><span id="l59.168" class="difflineminus">-      self.failed++;</span>
<a href="#l59.169"></a><span id="l59.169" class="difflineminus">-      self.done();</span>
<a href="#l59.170"></a><span id="l59.170" class="difflineminus">-    }</span>
<a href="#l59.171"></a><span id="l59.171" class="difflineminus">-</span>
<a href="#l59.172"></a><span id="l59.172" class="difflineminus">-    this.waitTimeout = timer.setTimeout(tiredOfWaiting, ms);</span>
<a href="#l59.173"></a><span id="l59.173" class="difflineminus">-  },</span>
<a href="#l59.174"></a><span id="l59.174" class="difflineminus">-</span>
<a href="#l59.175"></a><span id="l59.175" class="difflineminus">-  startMany: function startMany(options) {</span>
<a href="#l59.176"></a><span id="l59.176" class="difflineminus">-    function scheduleNextTest(self) {</span>
<a href="#l59.177"></a><span id="l59.177" class="difflineminus">-      function runNextTest() {</span>
<a href="#l59.178"></a><span id="l59.178" class="difflineminus">-        var test = options.tests.pop();</span>
<a href="#l59.179"></a><span id="l59.179" class="difflineminus">-        if (test)</span>
<a href="#l59.180"></a><span id="l59.180" class="difflineminus">-          self.start({test: test, onDone: scheduleNextTest});</span>
<a href="#l59.181"></a><span id="l59.181" class="difflineminus">-        else</span>
<a href="#l59.182"></a><span id="l59.182" class="difflineminus">-          options.onDone(self);</span>
<a href="#l59.183"></a><span id="l59.183" class="difflineminus">-      }</span>
<a href="#l59.184"></a><span id="l59.184" class="difflineminus">-      timer.setTimeout(runNextTest, 0);</span>
<a href="#l59.185"></a><span id="l59.185" class="difflineminus">-    }</span>
<a href="#l59.186"></a><span id="l59.186" class="difflineminus">-    scheduleNextTest(this);</span>
<a href="#l59.187"></a><span id="l59.187" class="difflineminus">-  },</span>
<a href="#l59.188"></a><span id="l59.188" class="difflineminus">-</span>
<a href="#l59.189"></a><span id="l59.189" class="difflineminus">-  start: function start(options) {</span>
<a href="#l59.190"></a><span id="l59.190" class="difflineminus">-    this.test = options.test;</span>
<a href="#l59.191"></a><span id="l59.191" class="difflineminus">-    this.isDone = false;</span>
<a href="#l59.192"></a><span id="l59.192" class="difflineminus">-    this.onDone = options.onDone;</span>
<a href="#l59.193"></a><span id="l59.193" class="difflineminus">-    this.waitTimeout = null;</span>
<a href="#l59.194"></a><span id="l59.194" class="difflineminus">-</span>
<a href="#l59.195"></a><span id="l59.195" class="difflineminus">-    try {</span>
<a href="#l59.196"></a><span id="l59.196" class="difflineminus">-      this.test(this);</span>
<a href="#l59.197"></a><span id="l59.197" class="difflineminus">-    } catch (e) {</span>
<a href="#l59.198"></a><span id="l59.198" class="difflineminus">-      this.exception(e);</span>
<a href="#l59.199"></a><span id="l59.199" class="difflineminus">-    }</span>
<a href="#l59.200"></a><span id="l59.200" class="difflineminus">-    if (this.waitTimeout === null)</span>
<a href="#l59.201"></a><span id="l59.201" class="difflineminus">-      this.done();</span>
<a href="#l59.202"></a><span id="l59.202" class="difflineminus">-  }</span>
<a href="#l59.203"></a><span id="l59.203" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l60.1"></a><span id="l60.1">deleted file mode 100644</span>
<a href="#l60.2"></a><span id="l60.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/unload.js</span>
<a href="#l60.3"></a><span id="l60.3" class="difflineplus">+++ /dev/null</span>
<a href="#l60.4"></a><span id="l60.4" class="difflineat">@@ -1,19 +0,0 @@</span>
<a href="#l60.5"></a><span id="l60.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l60.6"></a><span id="l60.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l60.7"></a><span id="l60.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l60.8"></a><span id="l60.8" class="difflineminus">-</span>
<a href="#l60.9"></a><span id="l60.9" class="difflineminus">-// This module was taken from narwhal:</span>
<a href="#l60.10"></a><span id="l60.10" class="difflineminus">-//</span>
<a href="#l60.11"></a><span id="l60.11" class="difflineminus">-// http://narwhaljs.org</span>
<a href="#l60.12"></a><span id="l60.12" class="difflineminus">-</span>
<a href="#l60.13"></a><span id="l60.13" class="difflineminus">-var observers = [];</span>
<a href="#l60.14"></a><span id="l60.14" class="difflineminus">-</span>
<a href="#l60.15"></a><span id="l60.15" class="difflineminus">-exports.when = function (observer) {</span>
<a href="#l60.16"></a><span id="l60.16" class="difflineminus">-  observers.unshift(observer);</span>
<a href="#l60.17"></a><span id="l60.17" class="difflineminus">-};</span>
<a href="#l60.18"></a><span id="l60.18" class="difflineminus">-</span>
<a href="#l60.19"></a><span id="l60.19" class="difflineminus">-exports.send = function () {</span>
<a href="#l60.20"></a><span id="l60.20" class="difflineminus">-  observers.forEach(function (observer) {</span>
<a href="#l60.21"></a><span id="l60.21" class="difflineminus">-    observer();</span>
<a href="#l60.22"></a><span id="l60.22" class="difflineminus">-  });</span>
<a href="#l60.23"></a><span id="l60.23" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l61.1"></a><span id="l61.1">deleted file mode 100644</span>
<a href="#l61.2"></a><span id="l61.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/url.js</span>
<a href="#l61.3"></a><span id="l61.3" class="difflineplus">+++ /dev/null</span>
<a href="#l61.4"></a><span id="l61.4" class="difflineat">@@ -1,78 +0,0 @@</span>
<a href="#l61.5"></a><span id="l61.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l61.6"></a><span id="l61.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l61.7"></a><span id="l61.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l61.8"></a><span id="l61.8" class="difflineminus">-</span>
<a href="#l61.9"></a><span id="l61.9" class="difflineminus">-var ios = Cc['@mozilla.org/network/io-service;1']</span>
<a href="#l61.10"></a><span id="l61.10" class="difflineminus">-          .getService(Ci.nsIIOService);</span>
<a href="#l61.11"></a><span id="l61.11" class="difflineminus">-</span>
<a href="#l61.12"></a><span id="l61.12" class="difflineminus">-var resProt = ios.getProtocolHandler(&quot;resource&quot;)</span>
<a href="#l61.13"></a><span id="l61.13" class="difflineminus">-              .QueryInterface(Ci.nsIResProtocolHandler);</span>
<a href="#l61.14"></a><span id="l61.14" class="difflineminus">-</span>
<a href="#l61.15"></a><span id="l61.15" class="difflineminus">-function newURI(uriStr) {</span>
<a href="#l61.16"></a><span id="l61.16" class="difflineminus">-  try {</span>
<a href="#l61.17"></a><span id="l61.17" class="difflineminus">-    return ios.newURI(uriStr, null, null);</span>
<a href="#l61.18"></a><span id="l61.18" class="difflineminus">-  } catch (e if e.result == Cr.NS_ERROR_MALFORMED_URI) {</span>
<a href="#l61.19"></a><span id="l61.19" class="difflineminus">-    throw new Error(&quot;malformed URI: &quot; + uriStr);</span>
<a href="#l61.20"></a><span id="l61.20" class="difflineminus">-  } catch (e if (e.result == Cr.NS_ERROR_FAILURE ||</span>
<a href="#l61.21"></a><span id="l61.21" class="difflineminus">-                 e.result == Cr.NS_ERROR_ILLEGAL_VALUE)) {</span>
<a href="#l61.22"></a><span id="l61.22" class="difflineminus">-    throw new Error(&quot;invalid URI: &quot; + uriStr);</span>
<a href="#l61.23"></a><span id="l61.23" class="difflineminus">-  }</span>
<a href="#l61.24"></a><span id="l61.24" class="difflineminus">-}</span>
<a href="#l61.25"></a><span id="l61.25" class="difflineminus">-</span>
<a href="#l61.26"></a><span id="l61.26" class="difflineminus">-function resolveResourceURI(uri) {</span>
<a href="#l61.27"></a><span id="l61.27" class="difflineminus">-  var resolved;</span>
<a href="#l61.28"></a><span id="l61.28" class="difflineminus">-  try {</span>
<a href="#l61.29"></a><span id="l61.29" class="difflineminus">-    resolved = resProt.resolveURI(uri);</span>
<a href="#l61.30"></a><span id="l61.30" class="difflineminus">-  } catch (e if e.result == Cr.NS_ERROR_NOT_AVAILABLE) {</span>
<a href="#l61.31"></a><span id="l61.31" class="difflineminus">-    throw new Error(&quot;resource does not exist: &quot; + uri.spec);</span>
<a href="#l61.32"></a><span id="l61.32" class="difflineminus">-  };</span>
<a href="#l61.33"></a><span id="l61.33" class="difflineminus">-  return resolved;</span>
<a href="#l61.34"></a><span id="l61.34" class="difflineminus">-}</span>
<a href="#l61.35"></a><span id="l61.35" class="difflineminus">-</span>
<a href="#l61.36"></a><span id="l61.36" class="difflineminus">-var fromFilename = exports.fromFilename = function fromFilename(path) {</span>
<a href="#l61.37"></a><span id="l61.37" class="difflineminus">-  var file = Cc['@mozilla.org/file/local;1']</span>
<a href="#l61.38"></a><span id="l61.38" class="difflineminus">-             .createInstance(Ci.nsILocalFile);</span>
<a href="#l61.39"></a><span id="l61.39" class="difflineminus">-  file.initWithPath(path);</span>
<a href="#l61.40"></a><span id="l61.40" class="difflineminus">-  return ios.newFileURI(file).spec;</span>
<a href="#l61.41"></a><span id="l61.41" class="difflineminus">-};</span>
<a href="#l61.42"></a><span id="l61.42" class="difflineminus">-</span>
<a href="#l61.43"></a><span id="l61.43" class="difflineminus">-var toFilename = exports.toFilename = function toFilename(url) {</span>
<a href="#l61.44"></a><span id="l61.44" class="difflineminus">-  var uri = newURI(url);</span>
<a href="#l61.45"></a><span id="l61.45" class="difflineminus">-  if (uri.scheme == &quot;resource&quot;)</span>
<a href="#l61.46"></a><span id="l61.46" class="difflineminus">-    uri = newURI(resolveResourceURI(uri));</span>
<a href="#l61.47"></a><span id="l61.47" class="difflineminus">-  if (uri.scheme == &quot;file&quot;) {</span>
<a href="#l61.48"></a><span id="l61.48" class="difflineminus">-    var file = uri.QueryInterface(Ci.nsIFileURL).file;</span>
<a href="#l61.49"></a><span id="l61.49" class="difflineminus">-    return file.path;</span>
<a href="#l61.50"></a><span id="l61.50" class="difflineminus">-  }</span>
<a href="#l61.51"></a><span id="l61.51" class="difflineminus">-  throw new Error(&quot;cannot map to filename: &quot; + url);</span>
<a href="#l61.52"></a><span id="l61.52" class="difflineminus">-};</span>
<a href="#l61.53"></a><span id="l61.53" class="difflineminus">-</span>
<a href="#l61.54"></a><span id="l61.54" class="difflineminus">-var parse = exports.parse = function parse(url) {</span>
<a href="#l61.55"></a><span id="l61.55" class="difflineminus">-  var uri = newURI(url);</span>
<a href="#l61.56"></a><span id="l61.56" class="difflineminus">-</span>
<a href="#l61.57"></a><span id="l61.57" class="difflineminus">-  var userPass = null;</span>
<a href="#l61.58"></a><span id="l61.58" class="difflineminus">-  try {</span>
<a href="#l61.59"></a><span id="l61.59" class="difflineminus">-    userPass = uri.userPass ? uri.userPass : null;</span>
<a href="#l61.60"></a><span id="l61.60" class="difflineminus">-  } catch (e if e.result == Cr.NS_ERROR_FAILURE) {}</span>
<a href="#l61.61"></a><span id="l61.61" class="difflineminus">-</span>
<a href="#l61.62"></a><span id="l61.62" class="difflineminus">-  var host = null;</span>
<a href="#l61.63"></a><span id="l61.63" class="difflineminus">-  try {</span>
<a href="#l61.64"></a><span id="l61.64" class="difflineminus">-    host = uri.host;</span>
<a href="#l61.65"></a><span id="l61.65" class="difflineminus">-  } catch (e if e.result == Cr.NS_ERROR_FAILURE) {}</span>
<a href="#l61.66"></a><span id="l61.66" class="difflineminus">-</span>
<a href="#l61.67"></a><span id="l61.67" class="difflineminus">-  var port = null;</span>
<a href="#l61.68"></a><span id="l61.68" class="difflineminus">-  try {</span>
<a href="#l61.69"></a><span id="l61.69" class="difflineminus">-    port = uri.port == -1 ? null : uri.port;</span>
<a href="#l61.70"></a><span id="l61.70" class="difflineminus">-  } catch (e if e.result == Cr.NS_ERROR_FAILURE) {}</span>
<a href="#l61.71"></a><span id="l61.71" class="difflineminus">-</span>
<a href="#l61.72"></a><span id="l61.72" class="difflineminus">-  return {scheme: uri.scheme,</span>
<a href="#l61.73"></a><span id="l61.73" class="difflineminus">-          userPass: userPass,</span>
<a href="#l61.74"></a><span id="l61.74" class="difflineminus">-          host: host,</span>
<a href="#l61.75"></a><span id="l61.75" class="difflineminus">-          port: port,</span>
<a href="#l61.76"></a><span id="l61.76" class="difflineminus">-          path: uri.path};</span>
<a href="#l61.77"></a><span id="l61.77" class="difflineminus">-};</span>
<a href="#l61.78"></a><span id="l61.78" class="difflineminus">-</span>
<a href="#l61.79"></a><span id="l61.79" class="difflineminus">-var resolve = exports.resolve = function resolve(base, relative) {</span>
<a href="#l61.80"></a><span id="l61.80" class="difflineminus">-  var baseURI = newURI(base);</span>
<a href="#l61.81"></a><span id="l61.81" class="difflineminus">-  return ios.newURI(relative, null, baseURI).spec;</span>
<a href="#l61.82"></a><span id="l61.82" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l62.1"></a><span id="l62.1">deleted file mode 100644</span>
<a href="#l62.2"></a><span id="l62.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/lib/xhr.js</span>
<a href="#l62.3"></a><span id="l62.3" class="difflineplus">+++ /dev/null</span>
<a href="#l62.4"></a><span id="l62.4" class="difflineat">@@ -1,107 +0,0 @@</span>
<a href="#l62.5"></a><span id="l62.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l62.6"></a><span id="l62.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l62.7"></a><span id="l62.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l62.8"></a><span id="l62.8" class="difflineminus">-</span>
<a href="#l62.9"></a><span id="l62.9" class="difflineminus">-var requests = [];</span>
<a href="#l62.10"></a><span id="l62.10" class="difflineminus">-</span>
<a href="#l62.11"></a><span id="l62.11" class="difflineminus">-const TERMINATE_EVENTS = [&quot;load&quot;, &quot;error&quot;, &quot;abort&quot;];</span>
<a href="#l62.12"></a><span id="l62.12" class="difflineminus">-</span>
<a href="#l62.13"></a><span id="l62.13" class="difflineminus">-const READ_ONLY_PROPS = [&quot;readyState&quot;, &quot;responseText&quot;, &quot;responseXML&quot;,</span>
<a href="#l62.14"></a><span id="l62.14" class="difflineminus">-                         &quot;status&quot;, &quot;statusText&quot;];</span>
<a href="#l62.15"></a><span id="l62.15" class="difflineminus">-</span>
<a href="#l62.16"></a><span id="l62.16" class="difflineminus">-const DELEGATED_METHODS = [&quot;abort&quot;, &quot;getAllResponseHeaders&quot;,</span>
<a href="#l62.17"></a><span id="l62.17" class="difflineminus">-                           &quot;getResponseHeader&quot;, &quot;overrideMimeType&quot;,</span>
<a href="#l62.18"></a><span id="l62.18" class="difflineminus">-                           &quot;send&quot;, &quot;sendAsBinary&quot;, &quot;setRequestHeader&quot;,</span>
<a href="#l62.19"></a><span id="l62.19" class="difflineminus">-                           &quot;open&quot;];</span>
<a href="#l62.20"></a><span id="l62.20" class="difflineminus">-</span>
<a href="#l62.21"></a><span id="l62.21" class="difflineminus">-var getRequestCount = exports.getRequestCount = function getRequestCount() {</span>
<a href="#l62.22"></a><span id="l62.22" class="difflineminus">-  return requests.length;</span>
<a href="#l62.23"></a><span id="l62.23" class="difflineminus">-};</span>
<a href="#l62.24"></a><span id="l62.24" class="difflineminus">-</span>
<a href="#l62.25"></a><span id="l62.25" class="difflineminus">-var XMLHttpRequest = exports.XMLHttpRequest = function XMLHttpRequest() {</span>
<a href="#l62.26"></a><span id="l62.26" class="difflineminus">-  var req = Cc[&quot;@mozilla.org/xmlextras/xmlhttprequest;1&quot;]</span>
<a href="#l62.27"></a><span id="l62.27" class="difflineminus">-            .createInstance(Ci.nsIXMLHttpRequest);</span>
<a href="#l62.28"></a><span id="l62.28" class="difflineminus">-  req.mozBackgroundRequest = true;</span>
<a href="#l62.29"></a><span id="l62.29" class="difflineminus">-</span>
<a href="#l62.30"></a><span id="l62.30" class="difflineminus">-  this._req = req;</span>
<a href="#l62.31"></a><span id="l62.31" class="difflineminus">-  this._orsc = null;</span>
<a href="#l62.32"></a><span id="l62.32" class="difflineminus">-</span>
<a href="#l62.33"></a><span id="l62.33" class="difflineminus">-  requests.push(this);</span>
<a href="#l62.34"></a><span id="l62.34" class="difflineminus">-</span>
<a href="#l62.35"></a><span id="l62.35" class="difflineminus">-  var self = this;</span>
<a href="#l62.36"></a><span id="l62.36" class="difflineminus">-</span>
<a href="#l62.37"></a><span id="l62.37" class="difflineminus">-  this._boundCleanup = function _boundCleanup() {</span>
<a href="#l62.38"></a><span id="l62.38" class="difflineminus">-    self._cleanup();</span>
<a href="#l62.39"></a><span id="l62.39" class="difflineminus">-  };</span>
<a href="#l62.40"></a><span id="l62.40" class="difflineminus">-</span>
<a href="#l62.41"></a><span id="l62.41" class="difflineminus">-  TERMINATE_EVENTS.forEach(</span>
<a href="#l62.42"></a><span id="l62.42" class="difflineminus">-    function(name) {</span>
<a href="#l62.43"></a><span id="l62.43" class="difflineminus">-      self._req.addEventListener(name, self._boundCleanup, false);</span>
<a href="#l62.44"></a><span id="l62.44" class="difflineminus">-    });</span>
<a href="#l62.45"></a><span id="l62.45" class="difflineminus">-};</span>
<a href="#l62.46"></a><span id="l62.46" class="difflineminus">-</span>
<a href="#l62.47"></a><span id="l62.47" class="difflineminus">-XMLHttpRequest.prototype = {</span>
<a href="#l62.48"></a><span id="l62.48" class="difflineminus">-  _cleanup: function _cleanup() {</span>
<a href="#l62.49"></a><span id="l62.49" class="difflineminus">-    this.onreadystatechange = null;</span>
<a href="#l62.50"></a><span id="l62.50" class="difflineminus">-    var index = requests.indexOf(this);</span>
<a href="#l62.51"></a><span id="l62.51" class="difflineminus">-    if (index != -1) {</span>
<a href="#l62.52"></a><span id="l62.52" class="difflineminus">-      var self = this;</span>
<a href="#l62.53"></a><span id="l62.53" class="difflineminus">-      TERMINATE_EVENTS.forEach(</span>
<a href="#l62.54"></a><span id="l62.54" class="difflineminus">-        function(name) {</span>
<a href="#l62.55"></a><span id="l62.55" class="difflineminus">-          self._req.removeEventListener(name, self._boundCleanup, false);</span>
<a href="#l62.56"></a><span id="l62.56" class="difflineminus">-        });</span>
<a href="#l62.57"></a><span id="l62.57" class="difflineminus">-      requests.splice(index, 1);</span>
<a href="#l62.58"></a><span id="l62.58" class="difflineminus">-    }</span>
<a href="#l62.59"></a><span id="l62.59" class="difflineminus">-  },</span>
<a href="#l62.60"></a><span id="l62.60" class="difflineminus">-  _unload: function _unload() {</span>
<a href="#l62.61"></a><span id="l62.61" class="difflineminus">-    this._req.abort();</span>
<a href="#l62.62"></a><span id="l62.62" class="difflineminus">-    this._cleanup();</span>
<a href="#l62.63"></a><span id="l62.63" class="difflineminus">-  },</span>
<a href="#l62.64"></a><span id="l62.64" class="difflineminus">-  addEventListener: function addEventListener() {</span>
<a href="#l62.65"></a><span id="l62.65" class="difflineminus">-    throw new Error(&quot;not implemented&quot;);</span>
<a href="#l62.66"></a><span id="l62.66" class="difflineminus">-  },</span>
<a href="#l62.67"></a><span id="l62.67" class="difflineminus">-  removeEventListener: function removeEventListener() {</span>
<a href="#l62.68"></a><span id="l62.68" class="difflineminus">-    throw new Error(&quot;not implemented&quot;);</span>
<a href="#l62.69"></a><span id="l62.69" class="difflineminus">-  },</span>
<a href="#l62.70"></a><span id="l62.70" class="difflineminus">-  set upload(ignored) {</span>
<a href="#l62.71"></a><span id="l62.71" class="difflineminus">-    throw new Error(&quot;not implemented&quot;);</span>
<a href="#l62.72"></a><span id="l62.72" class="difflineminus">-  },</span>
<a href="#l62.73"></a><span id="l62.73" class="difflineminus">-  get onreadystatechange() {</span>
<a href="#l62.74"></a><span id="l62.74" class="difflineminus">-    return this._orsc;</span>
<a href="#l62.75"></a><span id="l62.75" class="difflineminus">-  },</span>
<a href="#l62.76"></a><span id="l62.76" class="difflineminus">-  set onreadystatechange(cb) {</span>
<a href="#l62.77"></a><span id="l62.77" class="difflineminus">-    this._orsc = cb;</span>
<a href="#l62.78"></a><span id="l62.78" class="difflineminus">-    if (cb) {</span>
<a href="#l62.79"></a><span id="l62.79" class="difflineminus">-      var self = this;</span>
<a href="#l62.80"></a><span id="l62.80" class="difflineminus">-      this._req.onreadystatechange = function() {</span>
<a href="#l62.81"></a><span id="l62.81" class="difflineminus">-        try {</span>
<a href="#l62.82"></a><span id="l62.82" class="difflineminus">-          self._orsc.apply(self, arguments);</span>
<a href="#l62.83"></a><span id="l62.83" class="difflineminus">-        } catch (e) {</span>
<a href="#l62.84"></a><span id="l62.84" class="difflineminus">-          console.exception(e);</span>
<a href="#l62.85"></a><span id="l62.85" class="difflineminus">-        }</span>
<a href="#l62.86"></a><span id="l62.86" class="difflineminus">-      };</span>
<a href="#l62.87"></a><span id="l62.87" class="difflineminus">-    } else</span>
<a href="#l62.88"></a><span id="l62.88" class="difflineminus">-      this._req.onreadystatechange = null;</span>
<a href="#l62.89"></a><span id="l62.89" class="difflineminus">-  }</span>
<a href="#l62.90"></a><span id="l62.90" class="difflineminus">-};</span>
<a href="#l62.91"></a><span id="l62.91" class="difflineminus">-</span>
<a href="#l62.92"></a><span id="l62.92" class="difflineminus">-READ_ONLY_PROPS.forEach(</span>
<a href="#l62.93"></a><span id="l62.93" class="difflineminus">-   function(name) {</span>
<a href="#l62.94"></a><span id="l62.94" class="difflineminus">-     XMLHttpRequest.prototype.__defineGetter__(</span>
<a href="#l62.95"></a><span id="l62.95" class="difflineminus">-       name,</span>
<a href="#l62.96"></a><span id="l62.96" class="difflineminus">-       function() {</span>
<a href="#l62.97"></a><span id="l62.97" class="difflineminus">-         return this._req[name];</span>
<a href="#l62.98"></a><span id="l62.98" class="difflineminus">-       });</span>
<a href="#l62.99"></a><span id="l62.99" class="difflineminus">-   });</span>
<a href="#l62.100"></a><span id="l62.100" class="difflineminus">-</span>
<a href="#l62.101"></a><span id="l62.101" class="difflineminus">-DELEGATED_METHODS.forEach(</span>
<a href="#l62.102"></a><span id="l62.102" class="difflineminus">-  function(name) {</span>
<a href="#l62.103"></a><span id="l62.103" class="difflineminus">-    XMLHttpRequest.prototype[name] = function() {</span>
<a href="#l62.104"></a><span id="l62.104" class="difflineminus">-      this._req[name].apply(this._req, arguments);</span>
<a href="#l62.105"></a><span id="l62.105" class="difflineminus">-    };</span>
<a href="#l62.106"></a><span id="l62.106" class="difflineminus">-  });</span>
<a href="#l62.107"></a><span id="l62.107" class="difflineminus">-</span>
<a href="#l62.108"></a><span id="l62.108" class="difflineminus">-require(&quot;unload&quot;).when(</span>
<a href="#l62.109"></a><span id="l62.109" class="difflineminus">-  function() {</span>
<a href="#l62.110"></a><span id="l62.110" class="difflineminus">-    requests.slice().forEach(function(request) { request._unload(); });</span>
<a href="#l62.111"></a><span id="l62.111" class="difflineminus">-  });</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l63.1"></a><span id="l63.1">deleted file mode 100644</span>
<a href="#l63.2"></a><span id="l63.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/log4moz.js</span>
<a href="#l63.3"></a><span id="l63.3" class="difflineplus">+++ /dev/null</span>
<a href="#l63.4"></a><span id="l63.4" class="difflineat">@@ -1,531 +0,0 @@</span>
<a href="#l63.5"></a><span id="l63.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l63.6"></a><span id="l63.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l63.7"></a><span id="l63.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l63.8"></a><span id="l63.8" class="difflineminus">-</span>
<a href="#l63.9"></a><span id="l63.9" class="difflineminus">-const EXPORTED_SYMBOLS = ['Log4Moz'];</span>
<a href="#l63.10"></a><span id="l63.10" class="difflineminus">-</span>
<a href="#l63.11"></a><span id="l63.11" class="difflineminus">-const Cc = Components.classes;</span>
<a href="#l63.12"></a><span id="l63.12" class="difflineminus">-const Ci = Components.interfaces;</span>
<a href="#l63.13"></a><span id="l63.13" class="difflineminus">-const Cr = Components.results;</span>
<a href="#l63.14"></a><span id="l63.14" class="difflineminus">-const Cu = Components.utils;</span>
<a href="#l63.15"></a><span id="l63.15" class="difflineminus">-</span>
<a href="#l63.16"></a><span id="l63.16" class="difflineminus">-Cu.import(&quot;resource://gre/modules/XPCOMUtils.jsm&quot;);</span>
<a href="#l63.17"></a><span id="l63.17" class="difflineminus">-</span>
<a href="#l63.18"></a><span id="l63.18" class="difflineminus">-const MODE_RDONLY   = 0x01;</span>
<a href="#l63.19"></a><span id="l63.19" class="difflineminus">-const MODE_WRONLY   = 0x02;</span>
<a href="#l63.20"></a><span id="l63.20" class="difflineminus">-const MODE_CREATE   = 0x08;</span>
<a href="#l63.21"></a><span id="l63.21" class="difflineminus">-const MODE_APPEND   = 0x10;</span>
<a href="#l63.22"></a><span id="l63.22" class="difflineminus">-const MODE_TRUNCATE = 0x20;</span>
<a href="#l63.23"></a><span id="l63.23" class="difflineminus">-</span>
<a href="#l63.24"></a><span id="l63.24" class="difflineminus">-const PERMS_FILE      = 0644;</span>
<a href="#l63.25"></a><span id="l63.25" class="difflineminus">-const PERMS_DIRECTORY = 0755;</span>
<a href="#l63.26"></a><span id="l63.26" class="difflineminus">-</span>
<a href="#l63.27"></a><span id="l63.27" class="difflineminus">-const ONE_BYTE = 1;</span>
<a href="#l63.28"></a><span id="l63.28" class="difflineminus">-const ONE_KILOBYTE = 1024 * ONE_BYTE;</span>
<a href="#l63.29"></a><span id="l63.29" class="difflineminus">-const ONE_MEGABYTE = 1024 * ONE_KILOBYTE;</span>
<a href="#l63.30"></a><span id="l63.30" class="difflineminus">-</span>
<a href="#l63.31"></a><span id="l63.31" class="difflineminus">-let Log4Moz = {</span>
<a href="#l63.32"></a><span id="l63.32" class="difflineminus">-  Level: {</span>
<a href="#l63.33"></a><span id="l63.33" class="difflineminus">-    Fatal:  70,</span>
<a href="#l63.34"></a><span id="l63.34" class="difflineminus">-    Error:  60,</span>
<a href="#l63.35"></a><span id="l63.35" class="difflineminus">-    Warn:   50,</span>
<a href="#l63.36"></a><span id="l63.36" class="difflineminus">-    Info:   40,</span>
<a href="#l63.37"></a><span id="l63.37" class="difflineminus">-    Config: 30,</span>
<a href="#l63.38"></a><span id="l63.38" class="difflineminus">-    Debug:  20,</span>
<a href="#l63.39"></a><span id="l63.39" class="difflineminus">-    Trace:  10,</span>
<a href="#l63.40"></a><span id="l63.40" class="difflineminus">-    All:    0,</span>
<a href="#l63.41"></a><span id="l63.41" class="difflineminus">-    Desc: {</span>
<a href="#l63.42"></a><span id="l63.42" class="difflineminus">-      70: &quot;FATAL&quot;,</span>
<a href="#l63.43"></a><span id="l63.43" class="difflineminus">-      60: &quot;ERROR&quot;,</span>
<a href="#l63.44"></a><span id="l63.44" class="difflineminus">-      50: &quot;WARN&quot;,</span>
<a href="#l63.45"></a><span id="l63.45" class="difflineminus">-      40: &quot;INFO&quot;,</span>
<a href="#l63.46"></a><span id="l63.46" class="difflineminus">-      30: &quot;CONFIG&quot;,</span>
<a href="#l63.47"></a><span id="l63.47" class="difflineminus">-      20: &quot;DEBUG&quot;,</span>
<a href="#l63.48"></a><span id="l63.48" class="difflineminus">-      10: &quot;TRACE&quot;,</span>
<a href="#l63.49"></a><span id="l63.49" class="difflineminus">-      0:  &quot;ALL&quot;</span>
<a href="#l63.50"></a><span id="l63.50" class="difflineminus">-    }</span>
<a href="#l63.51"></a><span id="l63.51" class="difflineminus">-  },</span>
<a href="#l63.52"></a><span id="l63.52" class="difflineminus">-</span>
<a href="#l63.53"></a><span id="l63.53" class="difflineminus">-  get repository() {</span>
<a href="#l63.54"></a><span id="l63.54" class="difflineminus">-    delete Log4Moz.repository;</span>
<a href="#l63.55"></a><span id="l63.55" class="difflineminus">-    Log4Moz.repository = new LoggerRepository();</span>
<a href="#l63.56"></a><span id="l63.56" class="difflineminus">-    return Log4Moz.repository;</span>
<a href="#l63.57"></a><span id="l63.57" class="difflineminus">-  },</span>
<a href="#l63.58"></a><span id="l63.58" class="difflineminus">-  set repository(value) {</span>
<a href="#l63.59"></a><span id="l63.59" class="difflineminus">-    delete Log4Moz.repository;</span>
<a href="#l63.60"></a><span id="l63.60" class="difflineminus">-    Log4Moz.repository = value;</span>
<a href="#l63.61"></a><span id="l63.61" class="difflineminus">-  },</span>
<a href="#l63.62"></a><span id="l63.62" class="difflineminus">-</span>
<a href="#l63.63"></a><span id="l63.63" class="difflineminus">-  get LogMessage() { return LogMessage; },</span>
<a href="#l63.64"></a><span id="l63.64" class="difflineminus">-  get Logger() { return Logger; },</span>
<a href="#l63.65"></a><span id="l63.65" class="difflineminus">-  get LoggerRepository() { return LoggerRepository; },</span>
<a href="#l63.66"></a><span id="l63.66" class="difflineminus">-</span>
<a href="#l63.67"></a><span id="l63.67" class="difflineminus">-  get Formatter() { return Formatter; },</span>
<a href="#l63.68"></a><span id="l63.68" class="difflineminus">-  get BasicFormatter() { return BasicFormatter; },</span>
<a href="#l63.69"></a><span id="l63.69" class="difflineminus">-</span>
<a href="#l63.70"></a><span id="l63.70" class="difflineminus">-  get Appender() { return Appender; },</span>
<a href="#l63.71"></a><span id="l63.71" class="difflineminus">-  get DumpAppender() { return DumpAppender; },</span>
<a href="#l63.72"></a><span id="l63.72" class="difflineminus">-  get ConsoleAppender() { return ConsoleAppender; },</span>
<a href="#l63.73"></a><span id="l63.73" class="difflineminus">-  get FileAppender() { return FileAppender; },</span>
<a href="#l63.74"></a><span id="l63.74" class="difflineminus">-  get RotatingFileAppender() { return RotatingFileAppender; },</span>
<a href="#l63.75"></a><span id="l63.75" class="difflineminus">-</span>
<a href="#l63.76"></a><span id="l63.76" class="difflineminus">-  // Logging helper:</span>
<a href="#l63.77"></a><span id="l63.77" class="difflineminus">-  // let logger = Log4Moz.repository.getLogger(&quot;foo&quot;);</span>
<a href="#l63.78"></a><span id="l63.78" class="difflineminus">-  // logger.info(Log4Moz.enumerateInterfaces(someObject).join(&quot;,&quot;));</span>
<a href="#l63.79"></a><span id="l63.79" class="difflineminus">-  enumerateInterfaces: function Log4Moz_enumerateInterfaces(aObject) {</span>
<a href="#l63.80"></a><span id="l63.80" class="difflineminus">-    let interfaces = [];</span>
<a href="#l63.81"></a><span id="l63.81" class="difflineminus">-</span>
<a href="#l63.82"></a><span id="l63.82" class="difflineminus">-    for (i in Ci) {</span>
<a href="#l63.83"></a><span id="l63.83" class="difflineminus">-      try {</span>
<a href="#l63.84"></a><span id="l63.84" class="difflineminus">-        aObject.QueryInterface(Ci[i]);</span>
<a href="#l63.85"></a><span id="l63.85" class="difflineminus">-        interfaces.push(i);</span>
<a href="#l63.86"></a><span id="l63.86" class="difflineminus">-      }</span>
<a href="#l63.87"></a><span id="l63.87" class="difflineminus">-      catch(ex) {}</span>
<a href="#l63.88"></a><span id="l63.88" class="difflineminus">-    }</span>
<a href="#l63.89"></a><span id="l63.89" class="difflineminus">-</span>
<a href="#l63.90"></a><span id="l63.90" class="difflineminus">-    return interfaces;</span>
<a href="#l63.91"></a><span id="l63.91" class="difflineminus">-  },</span>
<a href="#l63.92"></a><span id="l63.92" class="difflineminus">-</span>
<a href="#l63.93"></a><span id="l63.93" class="difflineminus">-  // Logging helper:</span>
<a href="#l63.94"></a><span id="l63.94" class="difflineminus">-  // let logger = Log4Moz.repository.getLogger(&quot;foo&quot;);</span>
<a href="#l63.95"></a><span id="l63.95" class="difflineminus">-  // logger.info(Log4Moz.enumerateProperties(someObject).join(&quot;,&quot;));</span>
<a href="#l63.96"></a><span id="l63.96" class="difflineminus">-  enumerateProperties: function Log4Moz_enumerateProps(aObject,</span>
<a href="#l63.97"></a><span id="l63.97" class="difflineminus">-                                                       aExcludeComplexTypes) {</span>
<a href="#l63.98"></a><span id="l63.98" class="difflineminus">-    let properties = [];</span>
<a href="#l63.99"></a><span id="l63.99" class="difflineminus">-</span>
<a href="#l63.100"></a><span id="l63.100" class="difflineminus">-    for (p in aObject) {</span>
<a href="#l63.101"></a><span id="l63.101" class="difflineminus">-      try {</span>
<a href="#l63.102"></a><span id="l63.102" class="difflineminus">-        if (aExcludeComplexTypes &amp;&amp;</span>
<a href="#l63.103"></a><span id="l63.103" class="difflineminus">-            (typeof aObject[p] == &quot;object&quot; || typeof aObject[p] == &quot;function&quot;))</span>
<a href="#l63.104"></a><span id="l63.104" class="difflineminus">-          continue;</span>
<a href="#l63.105"></a><span id="l63.105" class="difflineminus">-        properties.push(p + &quot; = &quot; + aObject[p]);</span>
<a href="#l63.106"></a><span id="l63.106" class="difflineminus">-      }</span>
<a href="#l63.107"></a><span id="l63.107" class="difflineminus">-      catch(ex) {</span>
<a href="#l63.108"></a><span id="l63.108" class="difflineminus">-        properties.push(p + &quot; = &quot; + ex);</span>
<a href="#l63.109"></a><span id="l63.109" class="difflineminus">-      }</span>
<a href="#l63.110"></a><span id="l63.110" class="difflineminus">-    }</span>
<a href="#l63.111"></a><span id="l63.111" class="difflineminus">-</span>
<a href="#l63.112"></a><span id="l63.112" class="difflineminus">-    return properties;</span>
<a href="#l63.113"></a><span id="l63.113" class="difflineminus">-  }</span>
<a href="#l63.114"></a><span id="l63.114" class="difflineminus">-};</span>
<a href="#l63.115"></a><span id="l63.115" class="difflineminus">-</span>
<a href="#l63.116"></a><span id="l63.116" class="difflineminus">-</span>
<a href="#l63.117"></a><span id="l63.117" class="difflineminus">-/*</span>
<a href="#l63.118"></a><span id="l63.118" class="difflineminus">- * LogMessage</span>
<a href="#l63.119"></a><span id="l63.119" class="difflineminus">- * Encapsulates a single log event's data</span>
<a href="#l63.120"></a><span id="l63.120" class="difflineminus">- */</span>
<a href="#l63.121"></a><span id="l63.121" class="difflineminus">-function LogMessage(loggerName, level, message){</span>
<a href="#l63.122"></a><span id="l63.122" class="difflineminus">-  this.loggerName = loggerName;</span>
<a href="#l63.123"></a><span id="l63.123" class="difflineminus">-  this.message = message;</span>
<a href="#l63.124"></a><span id="l63.124" class="difflineminus">-  this.level = level;</span>
<a href="#l63.125"></a><span id="l63.125" class="difflineminus">-  this.time = Date.now();</span>
<a href="#l63.126"></a><span id="l63.126" class="difflineminus">-}</span>
<a href="#l63.127"></a><span id="l63.127" class="difflineminus">-LogMessage.prototype = {</span>
<a href="#l63.128"></a><span id="l63.128" class="difflineminus">-  QueryInterface: XPCOMUtils.generateQI([Ci.nsISupports]),</span>
<a href="#l63.129"></a><span id="l63.129" class="difflineminus">-</span>
<a href="#l63.130"></a><span id="l63.130" class="difflineminus">-  get levelDesc() {</span>
<a href="#l63.131"></a><span id="l63.131" class="difflineminus">-    if (this.level in Log4Moz.Level.Desc)</span>
<a href="#l63.132"></a><span id="l63.132" class="difflineminus">-      return Log4Moz.Level.Desc[this.level];</span>
<a href="#l63.133"></a><span id="l63.133" class="difflineminus">-    return &quot;UNKNOWN&quot;;</span>
<a href="#l63.134"></a><span id="l63.134" class="difflineminus">-  },</span>
<a href="#l63.135"></a><span id="l63.135" class="difflineminus">-</span>
<a href="#l63.136"></a><span id="l63.136" class="difflineminus">-  toString: function LogMsg_toString(){</span>
<a href="#l63.137"></a><span id="l63.137" class="difflineminus">-    return &quot;LogMessage [&quot; + this.time + &quot; &quot; + this.level + &quot; &quot; +</span>
<a href="#l63.138"></a><span id="l63.138" class="difflineminus">-      this.message + &quot;]&quot;;</span>
<a href="#l63.139"></a><span id="l63.139" class="difflineminus">-  }</span>
<a href="#l63.140"></a><span id="l63.140" class="difflineminus">-};</span>
<a href="#l63.141"></a><span id="l63.141" class="difflineminus">-</span>
<a href="#l63.142"></a><span id="l63.142" class="difflineminus">-/*</span>
<a href="#l63.143"></a><span id="l63.143" class="difflineminus">- * Logger</span>
<a href="#l63.144"></a><span id="l63.144" class="difflineminus">- * Hierarchical version.  Logs to all appenders, assigned or inherited</span>
<a href="#l63.145"></a><span id="l63.145" class="difflineminus">- */</span>
<a href="#l63.146"></a><span id="l63.146" class="difflineminus">-</span>
<a href="#l63.147"></a><span id="l63.147" class="difflineminus">-function Logger(name, repository) {</span>
<a href="#l63.148"></a><span id="l63.148" class="difflineminus">-  this._init(name, repository);</span>
<a href="#l63.149"></a><span id="l63.149" class="difflineminus">-}</span>
<a href="#l63.150"></a><span id="l63.150" class="difflineminus">-Logger.prototype = {</span>
<a href="#l63.151"></a><span id="l63.151" class="difflineminus">-  _init: function Logger__init(name, repository) {</span>
<a href="#l63.152"></a><span id="l63.152" class="difflineminus">-    if (!repository)</span>
<a href="#l63.153"></a><span id="l63.153" class="difflineminus">-      repository = Log4Moz.repository;</span>
<a href="#l63.154"></a><span id="l63.154" class="difflineminus">-    this._name = name;</span>
<a href="#l63.155"></a><span id="l63.155" class="difflineminus">-    this._appenders = [];</span>
<a href="#l63.156"></a><span id="l63.156" class="difflineminus">-    this._repository = repository;</span>
<a href="#l63.157"></a><span id="l63.157" class="difflineminus">-  },</span>
<a href="#l63.158"></a><span id="l63.158" class="difflineminus">-</span>
<a href="#l63.159"></a><span id="l63.159" class="difflineminus">-  QueryInterface: XPCOMUtils.generateQI([Ci.nsISupports]),</span>
<a href="#l63.160"></a><span id="l63.160" class="difflineminus">-</span>
<a href="#l63.161"></a><span id="l63.161" class="difflineminus">-  parent: null,</span>
<a href="#l63.162"></a><span id="l63.162" class="difflineminus">-</span>
<a href="#l63.163"></a><span id="l63.163" class="difflineminus">-  get name() {</span>
<a href="#l63.164"></a><span id="l63.164" class="difflineminus">-    return this._name;</span>
<a href="#l63.165"></a><span id="l63.165" class="difflineminus">-  },</span>
<a href="#l63.166"></a><span id="l63.166" class="difflineminus">-</span>
<a href="#l63.167"></a><span id="l63.167" class="difflineminus">-  _level: null,</span>
<a href="#l63.168"></a><span id="l63.168" class="difflineminus">-  get level() {</span>
<a href="#l63.169"></a><span id="l63.169" class="difflineminus">-    if (this._level != null)</span>
<a href="#l63.170"></a><span id="l63.170" class="difflineminus">-      return this._level;</span>
<a href="#l63.171"></a><span id="l63.171" class="difflineminus">-    if (this.parent)</span>
<a href="#l63.172"></a><span id="l63.172" class="difflineminus">-      return this.parent.level;</span>
<a href="#l63.173"></a><span id="l63.173" class="difflineminus">-    dump(&quot;log4moz warning: root logger configuration error: no level defined\n&quot;);</span>
<a href="#l63.174"></a><span id="l63.174" class="difflineminus">-    return Log4Moz.Level.All;</span>
<a href="#l63.175"></a><span id="l63.175" class="difflineminus">-  },</span>
<a href="#l63.176"></a><span id="l63.176" class="difflineminus">-  set level(level) {</span>
<a href="#l63.177"></a><span id="l63.177" class="difflineminus">-    this._level = level;</span>
<a href="#l63.178"></a><span id="l63.178" class="difflineminus">-  },</span>
<a href="#l63.179"></a><span id="l63.179" class="difflineminus">-</span>
<a href="#l63.180"></a><span id="l63.180" class="difflineminus">-  _appenders: null,</span>
<a href="#l63.181"></a><span id="l63.181" class="difflineminus">-  get appenders() {</span>
<a href="#l63.182"></a><span id="l63.182" class="difflineminus">-    if (!this.parent)</span>
<a href="#l63.183"></a><span id="l63.183" class="difflineminus">-      return this._appenders;</span>
<a href="#l63.184"></a><span id="l63.184" class="difflineminus">-    return this._appenders.concat(this.parent.appenders);</span>
<a href="#l63.185"></a><span id="l63.185" class="difflineminus">-  },</span>
<a href="#l63.186"></a><span id="l63.186" class="difflineminus">-</span>
<a href="#l63.187"></a><span id="l63.187" class="difflineminus">-  addAppender: function Logger_addAppender(appender) {</span>
<a href="#l63.188"></a><span id="l63.188" class="difflineminus">-    for (let i = 0; i &lt; this._appenders.length; i++) {</span>
<a href="#l63.189"></a><span id="l63.189" class="difflineminus">-      if (this._appenders[i] == appender)</span>
<a href="#l63.190"></a><span id="l63.190" class="difflineminus">-        return;</span>
<a href="#l63.191"></a><span id="l63.191" class="difflineminus">-    }</span>
<a href="#l63.192"></a><span id="l63.192" class="difflineminus">-    this._appenders.push(appender);</span>
<a href="#l63.193"></a><span id="l63.193" class="difflineminus">-  },</span>
<a href="#l63.194"></a><span id="l63.194" class="difflineminus">-</span>
<a href="#l63.195"></a><span id="l63.195" class="difflineminus">-  removeAppender: function Logger_removeAppender(appender) {</span>
<a href="#l63.196"></a><span id="l63.196" class="difflineminus">-    let newAppenders = [];</span>
<a href="#l63.197"></a><span id="l63.197" class="difflineminus">-    for (let i = 0; i &lt; this._appenders.length; i++) {</span>
<a href="#l63.198"></a><span id="l63.198" class="difflineminus">-      if (this._appenders[i] != appender)</span>
<a href="#l63.199"></a><span id="l63.199" class="difflineminus">-        newAppenders.push(this._appenders[i]);</span>
<a href="#l63.200"></a><span id="l63.200" class="difflineminus">-    }</span>
<a href="#l63.201"></a><span id="l63.201" class="difflineminus">-    this._appenders = newAppenders;</span>
<a href="#l63.202"></a><span id="l63.202" class="difflineminus">-  },</span>
<a href="#l63.203"></a><span id="l63.203" class="difflineminus">-</span>
<a href="#l63.204"></a><span id="l63.204" class="difflineminus">-  log: function Logger_log(message) {</span>
<a href="#l63.205"></a><span id="l63.205" class="difflineminus">-    if (this.level &gt; message.level)</span>
<a href="#l63.206"></a><span id="l63.206" class="difflineminus">-      return;</span>
<a href="#l63.207"></a><span id="l63.207" class="difflineminus">-    let appenders = this.appenders;</span>
<a href="#l63.208"></a><span id="l63.208" class="difflineminus">-    for (let i = 0; i &lt; appenders.length; i++){</span>
<a href="#l63.209"></a><span id="l63.209" class="difflineminus">-      appenders[i].append(message);</span>
<a href="#l63.210"></a><span id="l63.210" class="difflineminus">-    }</span>
<a href="#l63.211"></a><span id="l63.211" class="difflineminus">-  },</span>
<a href="#l63.212"></a><span id="l63.212" class="difflineminus">-</span>
<a href="#l63.213"></a><span id="l63.213" class="difflineminus">-  fatal: function Logger_fatal(string) {</span>
<a href="#l63.214"></a><span id="l63.214" class="difflineminus">-    this.log(new LogMessage(this._name, Log4Moz.Level.Fatal, string));</span>
<a href="#l63.215"></a><span id="l63.215" class="difflineminus">-  },</span>
<a href="#l63.216"></a><span id="l63.216" class="difflineminus">-  error: function Logger_error(string) {</span>
<a href="#l63.217"></a><span id="l63.217" class="difflineminus">-    this.log(new LogMessage(this._name, Log4Moz.Level.Error, string));</span>
<a href="#l63.218"></a><span id="l63.218" class="difflineminus">-  },</span>
<a href="#l63.219"></a><span id="l63.219" class="difflineminus">-  warn: function Logger_warn(string) {</span>
<a href="#l63.220"></a><span id="l63.220" class="difflineminus">-    this.log(new LogMessage(this._name, Log4Moz.Level.Warn, string));</span>
<a href="#l63.221"></a><span id="l63.221" class="difflineminus">-  },</span>
<a href="#l63.222"></a><span id="l63.222" class="difflineminus">-  info: function Logger_info(string) {</span>
<a href="#l63.223"></a><span id="l63.223" class="difflineminus">-    this.log(new LogMessage(this._name, Log4Moz.Level.Info, string));</span>
<a href="#l63.224"></a><span id="l63.224" class="difflineminus">-  },</span>
<a href="#l63.225"></a><span id="l63.225" class="difflineminus">-  config: function Logger_config(string) {</span>
<a href="#l63.226"></a><span id="l63.226" class="difflineminus">-    this.log(new LogMessage(this._name, Log4Moz.Level.Config, string));</span>
<a href="#l63.227"></a><span id="l63.227" class="difflineminus">-  },</span>
<a href="#l63.228"></a><span id="l63.228" class="difflineminus">-  debug: function Logger_debug(string) {</span>
<a href="#l63.229"></a><span id="l63.229" class="difflineminus">-    this.log(new LogMessage(this._name, Log4Moz.Level.Debug, string));</span>
<a href="#l63.230"></a><span id="l63.230" class="difflineminus">-  },</span>
<a href="#l63.231"></a><span id="l63.231" class="difflineminus">-  trace: function Logger_trace(string) {</span>
<a href="#l63.232"></a><span id="l63.232" class="difflineminus">-    this.log(new LogMessage(this._name, Log4Moz.Level.Trace, string));</span>
<a href="#l63.233"></a><span id="l63.233" class="difflineminus">-  }</span>
<a href="#l63.234"></a><span id="l63.234" class="difflineminus">-};</span>
<a href="#l63.235"></a><span id="l63.235" class="difflineminus">-</span>
<a href="#l63.236"></a><span id="l63.236" class="difflineminus">-/*</span>
<a href="#l63.237"></a><span id="l63.237" class="difflineminus">- * LoggerRepository</span>
<a href="#l63.238"></a><span id="l63.238" class="difflineminus">- * Implements a hierarchy of Loggers</span>
<a href="#l63.239"></a><span id="l63.239" class="difflineminus">- */</span>
<a href="#l63.240"></a><span id="l63.240" class="difflineminus">-</span>
<a href="#l63.241"></a><span id="l63.241" class="difflineminus">-function LoggerRepository() {}</span>
<a href="#l63.242"></a><span id="l63.242" class="difflineminus">-LoggerRepository.prototype = {</span>
<a href="#l63.243"></a><span id="l63.243" class="difflineminus">-  QueryInterface: XPCOMUtils.generateQI([Ci.nsISupports]),</span>
<a href="#l63.244"></a><span id="l63.244" class="difflineminus">-</span>
<a href="#l63.245"></a><span id="l63.245" class="difflineminus">-  _loggers: {},</span>
<a href="#l63.246"></a><span id="l63.246" class="difflineminus">-</span>
<a href="#l63.247"></a><span id="l63.247" class="difflineminus">-  _rootLogger: null,</span>
<a href="#l63.248"></a><span id="l63.248" class="difflineminus">-  get rootLogger() {</span>
<a href="#l63.249"></a><span id="l63.249" class="difflineminus">-    if (!this._rootLogger) {</span>
<a href="#l63.250"></a><span id="l63.250" class="difflineminus">-      this._rootLogger = new Logger(&quot;root&quot;, this);</span>
<a href="#l63.251"></a><span id="l63.251" class="difflineminus">-      this._rootLogger.level = Log4Moz.Level.All;</span>
<a href="#l63.252"></a><span id="l63.252" class="difflineminus">-    }</span>
<a href="#l63.253"></a><span id="l63.253" class="difflineminus">-    return this._rootLogger;</span>
<a href="#l63.254"></a><span id="l63.254" class="difflineminus">-  },</span>
<a href="#l63.255"></a><span id="l63.255" class="difflineminus">-  // FIXME: need to update all parent values if we do this</span>
<a href="#l63.256"></a><span id="l63.256" class="difflineminus">-  //set rootLogger(logger) {</span>
<a href="#l63.257"></a><span id="l63.257" class="difflineminus">-  //  this._rootLogger = logger;</span>
<a href="#l63.258"></a><span id="l63.258" class="difflineminus">-  //},</span>
<a href="#l63.259"></a><span id="l63.259" class="difflineminus">-</span>
<a href="#l63.260"></a><span id="l63.260" class="difflineminus">-  _updateParents: function LogRep__updateParents(name) {</span>
<a href="#l63.261"></a><span id="l63.261" class="difflineminus">-    let pieces = name.split('.');</span>
<a href="#l63.262"></a><span id="l63.262" class="difflineminus">-    let cur, parent;</span>
<a href="#l63.263"></a><span id="l63.263" class="difflineminus">-</span>
<a href="#l63.264"></a><span id="l63.264" class="difflineminus">-    // find the closest parent</span>
<a href="#l63.265"></a><span id="l63.265" class="difflineminus">-    // don't test for the logger name itself, as there's a chance it's already</span>
<a href="#l63.266"></a><span id="l63.266" class="difflineminus">-    // there in this._loggers</span>
<a href="#l63.267"></a><span id="l63.267" class="difflineminus">-    for (let i = 0; i &lt; pieces.length - 1; i++) {</span>
<a href="#l63.268"></a><span id="l63.268" class="difflineminus">-      if (cur)</span>
<a href="#l63.269"></a><span id="l63.269" class="difflineminus">-        cur += '.' + pieces[i];</span>
<a href="#l63.270"></a><span id="l63.270" class="difflineminus">-      else</span>
<a href="#l63.271"></a><span id="l63.271" class="difflineminus">-        cur = pieces[i];</span>
<a href="#l63.272"></a><span id="l63.272" class="difflineminus">-      if (cur in this._loggers)</span>
<a href="#l63.273"></a><span id="l63.273" class="difflineminus">-        parent = cur;</span>
<a href="#l63.274"></a><span id="l63.274" class="difflineminus">-    }</span>
<a href="#l63.275"></a><span id="l63.275" class="difflineminus">-</span>
<a href="#l63.276"></a><span id="l63.276" class="difflineminus">-    // if we didn't assign a parent above, there is no parent</span>
<a href="#l63.277"></a><span id="l63.277" class="difflineminus">-    if (!parent)</span>
<a href="#l63.278"></a><span id="l63.278" class="difflineminus">-      this._loggers[name].parent = this.rootLogger;</span>
<a href="#l63.279"></a><span id="l63.279" class="difflineminus">-    else</span>
<a href="#l63.280"></a><span id="l63.280" class="difflineminus">-      this._loggers[name].parent = this._loggers[parent];</span>
<a href="#l63.281"></a><span id="l63.281" class="difflineminus">-</span>
<a href="#l63.282"></a><span id="l63.282" class="difflineminus">-    // trigger updates for any possible descendants of this logger</span>
<a href="#l63.283"></a><span id="l63.283" class="difflineminus">-    for (let logger in this._loggers) {</span>
<a href="#l63.284"></a><span id="l63.284" class="difflineminus">-      if (logger != name &amp;&amp; logger.indexOf(name) == 0)</span>
<a href="#l63.285"></a><span id="l63.285" class="difflineminus">-        this._updateParents(logger);</span>
<a href="#l63.286"></a><span id="l63.286" class="difflineminus">-    }</span>
<a href="#l63.287"></a><span id="l63.287" class="difflineminus">-  },</span>
<a href="#l63.288"></a><span id="l63.288" class="difflineminus">-</span>
<a href="#l63.289"></a><span id="l63.289" class="difflineminus">-  getLogger: function LogRep_getLogger(name) {</span>
<a href="#l63.290"></a><span id="l63.290" class="difflineminus">-    if (!name)</span>
<a href="#l63.291"></a><span id="l63.291" class="difflineminus">-      name = this.getLogger.caller.name;</span>
<a href="#l63.292"></a><span id="l63.292" class="difflineminus">-    if (name in this._loggers)</span>
<a href="#l63.293"></a><span id="l63.293" class="difflineminus">-      return this._loggers[name];</span>
<a href="#l63.294"></a><span id="l63.294" class="difflineminus">-    this._loggers[name] = new Logger(name, this);</span>
<a href="#l63.295"></a><span id="l63.295" class="difflineminus">-    this._updateParents(name);</span>
<a href="#l63.296"></a><span id="l63.296" class="difflineminus">-    return this._loggers[name];</span>
<a href="#l63.297"></a><span id="l63.297" class="difflineminus">-  }</span>
<a href="#l63.298"></a><span id="l63.298" class="difflineminus">-};</span>
<a href="#l63.299"></a><span id="l63.299" class="difflineminus">-</span>
<a href="#l63.300"></a><span id="l63.300" class="difflineminus">-/*</span>
<a href="#l63.301"></a><span id="l63.301" class="difflineminus">- * Formatters</span>
<a href="#l63.302"></a><span id="l63.302" class="difflineminus">- * These massage a LogMessage into whatever output is desired</span>
<a href="#l63.303"></a><span id="l63.303" class="difflineminus">- * Only the BasicFormatter is currently implemented</span>
<a href="#l63.304"></a><span id="l63.304" class="difflineminus">- */</span>
<a href="#l63.305"></a><span id="l63.305" class="difflineminus">-</span>
<a href="#l63.306"></a><span id="l63.306" class="difflineminus">-// Abstract formatter</span>
<a href="#l63.307"></a><span id="l63.307" class="difflineminus">-function Formatter() {}</span>
<a href="#l63.308"></a><span id="l63.308" class="difflineminus">-Formatter.prototype = {</span>
<a href="#l63.309"></a><span id="l63.309" class="difflineminus">-  QueryInterface: XPCOMUtils.generateQI([Ci.nsISupports]),</span>
<a href="#l63.310"></a><span id="l63.310" class="difflineminus">-  format: function Formatter_format(message) {}</span>
<a href="#l63.311"></a><span id="l63.311" class="difflineminus">-};</span>
<a href="#l63.312"></a><span id="l63.312" class="difflineminus">-</span>
<a href="#l63.313"></a><span id="l63.313" class="difflineminus">-// FIXME: should allow for formatting the whole string, not just the date</span>
<a href="#l63.314"></a><span id="l63.314" class="difflineminus">-function BasicFormatter(dateFormat) {</span>
<a href="#l63.315"></a><span id="l63.315" class="difflineminus">-  if (dateFormat)</span>
<a href="#l63.316"></a><span id="l63.316" class="difflineminus">-    this.dateFormat = dateFormat;</span>
<a href="#l63.317"></a><span id="l63.317" class="difflineminus">-}</span>
<a href="#l63.318"></a><span id="l63.318" class="difflineminus">-BasicFormatter.prototype = {</span>
<a href="#l63.319"></a><span id="l63.319" class="difflineminus">-  __proto__: Formatter.prototype,</span>
<a href="#l63.320"></a><span id="l63.320" class="difflineminus">-</span>
<a href="#l63.321"></a><span id="l63.321" class="difflineminus">-  _dateFormat: null,</span>
<a href="#l63.322"></a><span id="l63.322" class="difflineminus">-</span>
<a href="#l63.323"></a><span id="l63.323" class="difflineminus">-  get dateFormat() {</span>
<a href="#l63.324"></a><span id="l63.324" class="difflineminus">-    if (!this._dateFormat)</span>
<a href="#l63.325"></a><span id="l63.325" class="difflineminus">-      this._dateFormat = &quot;%Y-%m-%d %H:%M:%S&quot;;</span>
<a href="#l63.326"></a><span id="l63.326" class="difflineminus">-    return this._dateFormat;</span>
<a href="#l63.327"></a><span id="l63.327" class="difflineminus">-  },</span>
<a href="#l63.328"></a><span id="l63.328" class="difflineminus">-</span>
<a href="#l63.329"></a><span id="l63.329" class="difflineminus">-  set dateFormat(format) {</span>
<a href="#l63.330"></a><span id="l63.330" class="difflineminus">-    this._dateFormat = format;</span>
<a href="#l63.331"></a><span id="l63.331" class="difflineminus">-  },</span>
<a href="#l63.332"></a><span id="l63.332" class="difflineminus">-</span>
<a href="#l63.333"></a><span id="l63.333" class="difflineminus">-  format: function BF_format(message) {</span>
<a href="#l63.334"></a><span id="l63.334" class="difflineminus">-    // Pad a string to a certain length (20) with a character (space)</span>
<a href="#l63.335"></a><span id="l63.335" class="difflineminus">-    let pad = function BF__pad(str, len, chr) str +</span>
<a href="#l63.336"></a><span id="l63.336" class="difflineminus">-      new Array(Math.max((len || 20) - str.length + 1, 0)).join(chr || &quot; &quot;);</span>
<a href="#l63.337"></a><span id="l63.337" class="difflineminus">-</span>
<a href="#l63.338"></a><span id="l63.338" class="difflineminus">-    // Generate a date string because toLocaleString doesn't work XXX 514803</span>
<a href="#l63.339"></a><span id="l63.339" class="difflineminus">-    let z = function(n) n &lt; 10 ? &quot;0&quot; + n : n;</span>
<a href="#l63.340"></a><span id="l63.340" class="difflineminus">-    let d = new Date(message.time);</span>
<a href="#l63.341"></a><span id="l63.341" class="difflineminus">-    let dateStr = [d.getFullYear(), &quot;-&quot;, z(d.getMonth() + 1), &quot;-&quot;,</span>
<a href="#l63.342"></a><span id="l63.342" class="difflineminus">-      z(d.getDate()), &quot; &quot;, z(d.getHours()), &quot;:&quot;, z(d.getMinutes()), &quot;:&quot;,</span>
<a href="#l63.343"></a><span id="l63.343" class="difflineminus">-      z(d.getSeconds())].join(&quot;&quot;);</span>
<a href="#l63.344"></a><span id="l63.344" class="difflineminus">-</span>
<a href="#l63.345"></a><span id="l63.345" class="difflineminus">-    return dateStr + &quot;\t&quot; + pad(message.loggerName) + &quot; &quot; + message.levelDesc +</span>
<a href="#l63.346"></a><span id="l63.346" class="difflineminus">-      &quot;\t&quot; + message.message + &quot;\n&quot;;</span>
<a href="#l63.347"></a><span id="l63.347" class="difflineminus">-  }</span>
<a href="#l63.348"></a><span id="l63.348" class="difflineminus">-};</span>
<a href="#l63.349"></a><span id="l63.349" class="difflineminus">-</span>
<a href="#l63.350"></a><span id="l63.350" class="difflineminus">-/*</span>
<a href="#l63.351"></a><span id="l63.351" class="difflineminus">- * Appenders</span>
<a href="#l63.352"></a><span id="l63.352" class="difflineminus">- * These can be attached to Loggers to log to different places</span>
<a href="#l63.353"></a><span id="l63.353" class="difflineminus">- * Simply subclass and override doAppend to implement a new one</span>
<a href="#l63.354"></a><span id="l63.354" class="difflineminus">- */</span>
<a href="#l63.355"></a><span id="l63.355" class="difflineminus">-</span>
<a href="#l63.356"></a><span id="l63.356" class="difflineminus">-function Appender(formatter) {</span>
<a href="#l63.357"></a><span id="l63.357" class="difflineminus">-  this._name = &quot;Appender&quot;;</span>
<a href="#l63.358"></a><span id="l63.358" class="difflineminus">-  this._formatter = formatter? formatter : new BasicFormatter();</span>
<a href="#l63.359"></a><span id="l63.359" class="difflineminus">-}</span>
<a href="#l63.360"></a><span id="l63.360" class="difflineminus">-Appender.prototype = {</span>
<a href="#l63.361"></a><span id="l63.361" class="difflineminus">-  QueryInterface: XPCOMUtils.generateQI([Ci.nsISupports]),</span>
<a href="#l63.362"></a><span id="l63.362" class="difflineminus">-</span>
<a href="#l63.363"></a><span id="l63.363" class="difflineminus">-  _level: Log4Moz.Level.All,</span>
<a href="#l63.364"></a><span id="l63.364" class="difflineminus">-  get level() { return this._level; },</span>
<a href="#l63.365"></a><span id="l63.365" class="difflineminus">-  set level(level) { this._level = level; },</span>
<a href="#l63.366"></a><span id="l63.366" class="difflineminus">-</span>
<a href="#l63.367"></a><span id="l63.367" class="difflineminus">-  append: function App_append(message) {</span>
<a href="#l63.368"></a><span id="l63.368" class="difflineminus">-    if(this._level &lt;= message.level)</span>
<a href="#l63.369"></a><span id="l63.369" class="difflineminus">-      this.doAppend(this._formatter.format(message));</span>
<a href="#l63.370"></a><span id="l63.370" class="difflineminus">-  },</span>
<a href="#l63.371"></a><span id="l63.371" class="difflineminus">-  toString: function App_toString() {</span>
<a href="#l63.372"></a><span id="l63.372" class="difflineminus">-    return this._name + &quot; [level=&quot; + this._level +</span>
<a href="#l63.373"></a><span id="l63.373" class="difflineminus">-      &quot;, formatter=&quot; + this._formatter + &quot;]&quot;;</span>
<a href="#l63.374"></a><span id="l63.374" class="difflineminus">-  },</span>
<a href="#l63.375"></a><span id="l63.375" class="difflineminus">-  doAppend: function App_doAppend(message) {}</span>
<a href="#l63.376"></a><span id="l63.376" class="difflineminus">-};</span>
<a href="#l63.377"></a><span id="l63.377" class="difflineminus">-</span>
<a href="#l63.378"></a><span id="l63.378" class="difflineminus">-/*</span>
<a href="#l63.379"></a><span id="l63.379" class="difflineminus">- * DumpAppender</span>
<a href="#l63.380"></a><span id="l63.380" class="difflineminus">- * Logs to standard out</span>
<a href="#l63.381"></a><span id="l63.381" class="difflineminus">- */</span>
<a href="#l63.382"></a><span id="l63.382" class="difflineminus">-</span>
<a href="#l63.383"></a><span id="l63.383" class="difflineminus">-function DumpAppender(formatter) {</span>
<a href="#l63.384"></a><span id="l63.384" class="difflineminus">-  this._name = &quot;DumpAppender&quot;;</span>
<a href="#l63.385"></a><span id="l63.385" class="difflineminus">-  this._formatter = formatter? formatter : new BasicFormatter();</span>
<a href="#l63.386"></a><span id="l63.386" class="difflineminus">-}</span>
<a href="#l63.387"></a><span id="l63.387" class="difflineminus">-DumpAppender.prototype = {</span>
<a href="#l63.388"></a><span id="l63.388" class="difflineminus">-  __proto__: Appender.prototype,</span>
<a href="#l63.389"></a><span id="l63.389" class="difflineminus">-</span>
<a href="#l63.390"></a><span id="l63.390" class="difflineminus">-  doAppend: function DApp_doAppend(message) {</span>
<a href="#l63.391"></a><span id="l63.391" class="difflineminus">-    dump(message);</span>
<a href="#l63.392"></a><span id="l63.392" class="difflineminus">-  }</span>
<a href="#l63.393"></a><span id="l63.393" class="difflineminus">-};</span>
<a href="#l63.394"></a><span id="l63.394" class="difflineminus">-</span>
<a href="#l63.395"></a><span id="l63.395" class="difflineminus">-/*</span>
<a href="#l63.396"></a><span id="l63.396" class="difflineminus">- * ConsoleAppender</span>
<a href="#l63.397"></a><span id="l63.397" class="difflineminus">- * Logs to the javascript console</span>
<a href="#l63.398"></a><span id="l63.398" class="difflineminus">- */</span>
<a href="#l63.399"></a><span id="l63.399" class="difflineminus">-</span>
<a href="#l63.400"></a><span id="l63.400" class="difflineminus">-function ConsoleAppender(formatter) {</span>
<a href="#l63.401"></a><span id="l63.401" class="difflineminus">-  this._name = &quot;ConsoleAppender&quot;;</span>
<a href="#l63.402"></a><span id="l63.402" class="difflineminus">-  this._formatter = formatter;</span>
<a href="#l63.403"></a><span id="l63.403" class="difflineminus">-}</span>
<a href="#l63.404"></a><span id="l63.404" class="difflineminus">-ConsoleAppender.prototype = {</span>
<a href="#l63.405"></a><span id="l63.405" class="difflineminus">-  __proto__: Appender.prototype,</span>
<a href="#l63.406"></a><span id="l63.406" class="difflineminus">-</span>
<a href="#l63.407"></a><span id="l63.407" class="difflineminus">-  doAppend: function CApp_doAppend(message) {</span>
<a href="#l63.408"></a><span id="l63.408" class="difflineminus">-    if (message.level &gt; Log4Moz.Level.Warn) {</span>
<a href="#l63.409"></a><span id="l63.409" class="difflineminus">-      Cu.reportError(message);</span>
<a href="#l63.410"></a><span id="l63.410" class="difflineminus">-      return;</span>
<a href="#l63.411"></a><span id="l63.411" class="difflineminus">-    }</span>
<a href="#l63.412"></a><span id="l63.412" class="difflineminus">-    Cc[&quot;@mozilla.org/consoleservice;1&quot;].</span>
<a href="#l63.413"></a><span id="l63.413" class="difflineminus">-      getService(Ci.nsIConsoleService).logStringMessage(message);</span>
<a href="#l63.414"></a><span id="l63.414" class="difflineminus">-  }</span>
<a href="#l63.415"></a><span id="l63.415" class="difflineminus">-};</span>
<a href="#l63.416"></a><span id="l63.416" class="difflineminus">-</span>
<a href="#l63.417"></a><span id="l63.417" class="difflineminus">-/*</span>
<a href="#l63.418"></a><span id="l63.418" class="difflineminus">- * FileAppender</span>
<a href="#l63.419"></a><span id="l63.419" class="difflineminus">- * Logs to a file</span>
<a href="#l63.420"></a><span id="l63.420" class="difflineminus">- */</span>
<a href="#l63.421"></a><span id="l63.421" class="difflineminus">-</span>
<a href="#l63.422"></a><span id="l63.422" class="difflineminus">-function FileAppender(file, formatter) {</span>
<a href="#l63.423"></a><span id="l63.423" class="difflineminus">-  this._name = &quot;FileAppender&quot;;</span>
<a href="#l63.424"></a><span id="l63.424" class="difflineminus">-  this._file = file; // nsIFile</span>
<a href="#l63.425"></a><span id="l63.425" class="difflineminus">-  this._formatter = formatter? formatter : new BasicFormatter();</span>
<a href="#l63.426"></a><span id="l63.426" class="difflineminus">-}</span>
<a href="#l63.427"></a><span id="l63.427" class="difflineminus">-FileAppender.prototype = {</span>
<a href="#l63.428"></a><span id="l63.428" class="difflineminus">-  __proto__: Appender.prototype,</span>
<a href="#l63.429"></a><span id="l63.429" class="difflineminus">-  __fos: null,</span>
<a href="#l63.430"></a><span id="l63.430" class="difflineminus">-  get _fos() {</span>
<a href="#l63.431"></a><span id="l63.431" class="difflineminus">-    if (!this.__fos)</span>
<a href="#l63.432"></a><span id="l63.432" class="difflineminus">-      this.openStream();</span>
<a href="#l63.433"></a><span id="l63.433" class="difflineminus">-    return this.__fos;</span>
<a href="#l63.434"></a><span id="l63.434" class="difflineminus">-  },</span>
<a href="#l63.435"></a><span id="l63.435" class="difflineminus">-</span>
<a href="#l63.436"></a><span id="l63.436" class="difflineminus">-  openStream: function FApp_openStream() {</span>
<a href="#l63.437"></a><span id="l63.437" class="difflineminus">-    try {</span>
<a href="#l63.438"></a><span id="l63.438" class="difflineminus">-      let __fos = Cc[&quot;@mozilla.org/network/file-output-stream;1&quot;].</span>
<a href="#l63.439"></a><span id="l63.439" class="difflineminus">-        createInstance(Ci.nsIFileOutputStream);</span>
<a href="#l63.440"></a><span id="l63.440" class="difflineminus">-      let flags = MODE_WRONLY | MODE_CREATE | MODE_APPEND;</span>
<a href="#l63.441"></a><span id="l63.441" class="difflineminus">-      __fos.init(this._file, flags, PERMS_FILE, 0);</span>
<a href="#l63.442"></a><span id="l63.442" class="difflineminus">-</span>
<a href="#l63.443"></a><span id="l63.443" class="difflineminus">-      this.__fos = Cc[&quot;@mozilla.org/intl/converter-output-stream;1&quot;]</span>
<a href="#l63.444"></a><span id="l63.444" class="difflineminus">-            .createInstance(Ci.nsIConverterOutputStream);</span>
<a href="#l63.445"></a><span id="l63.445" class="difflineminus">-      this.__fos.init(__fos, &quot;UTF-8&quot;, 4096,</span>
<a href="#l63.446"></a><span id="l63.446" class="difflineminus">-            Ci.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER);</span>
<a href="#l63.447"></a><span id="l63.447" class="difflineminus">-    } catch(e) {</span>
<a href="#l63.448"></a><span id="l63.448" class="difflineminus">-      dump(&quot;Error opening stream:\n&quot; + e);</span>
<a href="#l63.449"></a><span id="l63.449" class="difflineminus">-    }</span>
<a href="#l63.450"></a><span id="l63.450" class="difflineminus">-  },</span>
<a href="#l63.451"></a><span id="l63.451" class="difflineminus">-</span>
<a href="#l63.452"></a><span id="l63.452" class="difflineminus">-  closeStream: function FApp_closeStream() {</span>
<a href="#l63.453"></a><span id="l63.453" class="difflineminus">-    if (!this.__fos)</span>
<a href="#l63.454"></a><span id="l63.454" class="difflineminus">-      return;</span>
<a href="#l63.455"></a><span id="l63.455" class="difflineminus">-    try {</span>
<a href="#l63.456"></a><span id="l63.456" class="difflineminus">-      this.__fos.close();</span>
<a href="#l63.457"></a><span id="l63.457" class="difflineminus">-      this.__fos = null;</span>
<a href="#l63.458"></a><span id="l63.458" class="difflineminus">-    } catch(e) {</span>
<a href="#l63.459"></a><span id="l63.459" class="difflineminus">-      dump(&quot;Failed to close file output stream\n&quot; + e);</span>
<a href="#l63.460"></a><span id="l63.460" class="difflineminus">-    }</span>
<a href="#l63.461"></a><span id="l63.461" class="difflineminus">-  },</span>
<a href="#l63.462"></a><span id="l63.462" class="difflineminus">-</span>
<a href="#l63.463"></a><span id="l63.463" class="difflineminus">-  doAppend: function FApp_doAppend(message) {</span>
<a href="#l63.464"></a><span id="l63.464" class="difflineminus">-    if (message === null || message.length &lt;= 0)</span>
<a href="#l63.465"></a><span id="l63.465" class="difflineminus">-      return;</span>
<a href="#l63.466"></a><span id="l63.466" class="difflineminus">-    try {</span>
<a href="#l63.467"></a><span id="l63.467" class="difflineminus">-      this._fos.writeString(message);</span>
<a href="#l63.468"></a><span id="l63.468" class="difflineminus">-    } catch(e) {</span>
<a href="#l63.469"></a><span id="l63.469" class="difflineminus">-      dump(&quot;Error writing file:\n&quot; + e);</span>
<a href="#l63.470"></a><span id="l63.470" class="difflineminus">-    }</span>
<a href="#l63.471"></a><span id="l63.471" class="difflineminus">-  },</span>
<a href="#l63.472"></a><span id="l63.472" class="difflineminus">-</span>
<a href="#l63.473"></a><span id="l63.473" class="difflineminus">-  clear: function FApp_clear() {</span>
<a href="#l63.474"></a><span id="l63.474" class="difflineminus">-    this.closeStream();</span>
<a href="#l63.475"></a><span id="l63.475" class="difflineminus">-    try {</span>
<a href="#l63.476"></a><span id="l63.476" class="difflineminus">-      this._file.remove(false);</span>
<a href="#l63.477"></a><span id="l63.477" class="difflineminus">-    } catch (e) {</span>
<a href="#l63.478"></a><span id="l63.478" class="difflineminus">-      // XXX do something?</span>
<a href="#l63.479"></a><span id="l63.479" class="difflineminus">-    }</span>
<a href="#l63.480"></a><span id="l63.480" class="difflineminus">-  }</span>
<a href="#l63.481"></a><span id="l63.481" class="difflineminus">-};</span>
<a href="#l63.482"></a><span id="l63.482" class="difflineminus">-</span>
<a href="#l63.483"></a><span id="l63.483" class="difflineminus">-/*</span>
<a href="#l63.484"></a><span id="l63.484" class="difflineminus">- * RotatingFileAppender</span>
<a href="#l63.485"></a><span id="l63.485" class="difflineminus">- * Similar to FileAppender, but rotates logs when they become too large</span>
<a href="#l63.486"></a><span id="l63.486" class="difflineminus">- */</span>
<a href="#l63.487"></a><span id="l63.487" class="difflineminus">-</span>
<a href="#l63.488"></a><span id="l63.488" class="difflineminus">-function RotatingFileAppender(file, formatter, maxSize, maxBackups) {</span>
<a href="#l63.489"></a><span id="l63.489" class="difflineminus">-  if (maxSize === undefined)</span>
<a href="#l63.490"></a><span id="l63.490" class="difflineminus">-    maxSize = ONE_MEGABYTE * 2;</span>
<a href="#l63.491"></a><span id="l63.491" class="difflineminus">-</span>
<a href="#l63.492"></a><span id="l63.492" class="difflineminus">-  if (maxBackups === undefined)</span>
<a href="#l63.493"></a><span id="l63.493" class="difflineminus">-    maxBackups = 0;</span>
<a href="#l63.494"></a><span id="l63.494" class="difflineminus">-</span>
<a href="#l63.495"></a><span id="l63.495" class="difflineminus">-  this._name = &quot;RotatingFileAppender&quot;;</span>
<a href="#l63.496"></a><span id="l63.496" class="difflineminus">-  this._file = file; // nsIFile</span>
<a href="#l63.497"></a><span id="l63.497" class="difflineminus">-  this._formatter = formatter? formatter : new BasicFormatter();</span>
<a href="#l63.498"></a><span id="l63.498" class="difflineminus">-  this._maxSize = maxSize;</span>
<a href="#l63.499"></a><span id="l63.499" class="difflineminus">-  this._maxBackups = maxBackups;</span>
<a href="#l63.500"></a><span id="l63.500" class="difflineminus">-}</span>
<a href="#l63.501"></a><span id="l63.501" class="difflineminus">-RotatingFileAppender.prototype = {</span>
<a href="#l63.502"></a><span id="l63.502" class="difflineminus">-  __proto__: FileAppender.prototype,</span>
<a href="#l63.503"></a><span id="l63.503" class="difflineminus">-</span>
<a href="#l63.504"></a><span id="l63.504" class="difflineminus">-  doAppend: function RFApp_doAppend(message) {</span>
<a href="#l63.505"></a><span id="l63.505" class="difflineminus">-    if (message === null || message.length &lt;= 0)</span>
<a href="#l63.506"></a><span id="l63.506" class="difflineminus">-      return;</span>
<a href="#l63.507"></a><span id="l63.507" class="difflineminus">-    try {</span>
<a href="#l63.508"></a><span id="l63.508" class="difflineminus">-      this.rotateLogs();</span>
<a href="#l63.509"></a><span id="l63.509" class="difflineminus">-      FileAppender.prototype.doAppend.call(this, message);</span>
<a href="#l63.510"></a><span id="l63.510" class="difflineminus">-    } catch(e) {</span>
<a href="#l63.511"></a><span id="l63.511" class="difflineminus">-      dump(&quot;Error writing file:&quot; + e + &quot;\n&quot;);</span>
<a href="#l63.512"></a><span id="l63.512" class="difflineminus">-    }</span>
<a href="#l63.513"></a><span id="l63.513" class="difflineminus">-  },</span>
<a href="#l63.514"></a><span id="l63.514" class="difflineminus">-</span>
<a href="#l63.515"></a><span id="l63.515" class="difflineminus">-  rotateLogs: function RFApp_rotateLogs() {</span>
<a href="#l63.516"></a><span id="l63.516" class="difflineminus">-    if(this._file.exists() &amp;&amp;</span>
<a href="#l63.517"></a><span id="l63.517" class="difflineminus">-       this._file.fileSize &lt; this._maxSize)</span>
<a href="#l63.518"></a><span id="l63.518" class="difflineminus">-      return;</span>
<a href="#l63.519"></a><span id="l63.519" class="difflineminus">-</span>
<a href="#l63.520"></a><span id="l63.520" class="difflineminus">-    this.closeStream();</span>
<a href="#l63.521"></a><span id="l63.521" class="difflineminus">-</span>
<a href="#l63.522"></a><span id="l63.522" class="difflineminus">-    for (let i = this.maxBackups - 1; i &gt; 0; i--){</span>
<a href="#l63.523"></a><span id="l63.523" class="difflineminus">-      let backup = this._file.parent.clone();</span>
<a href="#l63.524"></a><span id="l63.524" class="difflineminus">-      backup.append(this._file.leafName + &quot;.&quot; + i);</span>
<a href="#l63.525"></a><span id="l63.525" class="difflineminus">-      if (backup.exists())</span>
<a href="#l63.526"></a><span id="l63.526" class="difflineminus">-        backup.moveTo(this._file.parent, this._file.leafName + &quot;.&quot; + (i + 1));</span>
<a href="#l63.527"></a><span id="l63.527" class="difflineminus">-    }</span>
<a href="#l63.528"></a><span id="l63.528" class="difflineminus">-</span>
<a href="#l63.529"></a><span id="l63.529" class="difflineminus">-    let cur = this._file.clone();</span>
<a href="#l63.530"></a><span id="l63.530" class="difflineminus">-    if (cur.exists())</span>
<a href="#l63.531"></a><span id="l63.531" class="difflineminus">-      cur.moveTo(cur.parent, cur.leafName + &quot;.1&quot;);</span>
<a href="#l63.532"></a><span id="l63.532" class="difflineminus">-</span>
<a href="#l63.533"></a><span id="l63.533" class="difflineminus">-    // Note: this._file still points to the same file</span>
<a href="#l63.534"></a><span id="l63.534" class="difflineminus">-  }</span>
<a href="#l63.535"></a><span id="l63.535" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l64.1"></a><span id="l64.1">deleted file mode 100644</span>
<a href="#l64.2"></a><span id="l64.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/metadata.js</span>
<a href="#l64.3"></a><span id="l64.3" class="difflineplus">+++ /dev/null</span>
<a href="#l64.4"></a><span id="l64.4" class="difflineat">@@ -1,168 +0,0 @@</span>
<a href="#l64.5"></a><span id="l64.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l64.6"></a><span id="l64.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l64.7"></a><span id="l64.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l64.8"></a><span id="l64.8" class="difflineminus">-</span>
<a href="#l64.9"></a><span id="l64.9" class="difflineminus">-EXPORTED_SYMBOLS = [&quot;MetadataCollector&quot;];</span>
<a href="#l64.10"></a><span id="l64.10" class="difflineminus">-</span>
<a href="#l64.11"></a><span id="l64.11" class="difflineminus">-const Cc = Components.classes;</span>
<a href="#l64.12"></a><span id="l64.12" class="difflineminus">-const Ci = Components.interfaces;</span>
<a href="#l64.13"></a><span id="l64.13" class="difflineminus">-const Cu = Components.utils;</span>
<a href="#l64.14"></a><span id="l64.14" class="difflineminus">-</span>
<a href="#l64.15"></a><span id="l64.15" class="difflineminus">-Cu.import(&quot;resource://testpilot/modules/string_sanitizer.js&quot;);</span>
<a href="#l64.16"></a><span id="l64.16" class="difflineminus">-</span>
<a href="#l64.17"></a><span id="l64.17" class="difflineminus">-const LOCALE_PREF = &quot;general.useragent.locale&quot;;</span>
<a href="#l64.18"></a><span id="l64.18" class="difflineminus">-const EXTENSION_ID = &quot;tbtestpilot@labs.mozilla.com&quot;;</span>
<a href="#l64.19"></a><span id="l64.19" class="difflineminus">-const PREFIX_NS_EM = &quot;http://www.mozilla.org/2004/em-rdf#&quot;;</span>
<a href="#l64.20"></a><span id="l64.20" class="difflineminus">-const PREFIX_ITEM_URI = &quot;urn:mozilla:item:&quot;;</span>
<a href="#l64.21"></a><span id="l64.21" class="difflineminus">-const UPDATE_CHANNEL_PREF = &quot;app.update.channel&quot;;</span>
<a href="#l64.22"></a><span id="l64.22" class="difflineminus">-</span>
<a href="#l64.23"></a><span id="l64.23" class="difflineminus">-/* The following preference, if present, stores answers to the basic panel</span>
<a href="#l64.24"></a><span id="l64.24" class="difflineminus">- * survey, which tell us user's general tech level, and so should be included</span>
<a href="#l64.25"></a><span id="l64.25" class="difflineminus">- * with any upload.*/</span>
<a href="#l64.26"></a><span id="l64.26" class="difflineminus">-const SURVEY_ANS = &quot;extensions.testpilot.surveyAnswers.basic_panel_survey_2&quot;;</span>
<a href="#l64.27"></a><span id="l64.27" class="difflineminus">-</span>
<a href="#l64.28"></a><span id="l64.28" class="difflineminus">-// This function copied over from Weave:</span>
<a href="#l64.29"></a><span id="l64.29" class="difflineminus">-function Weave_sha1(string) {</span>
<a href="#l64.30"></a><span id="l64.30" class="difflineminus">-  let converter = Cc[&quot;@mozilla.org/intl/scriptableunicodeconverter&quot;].</span>
<a href="#l64.31"></a><span id="l64.31" class="difflineminus">-                  createInstance(Ci.nsIScriptableUnicodeConverter);</span>
<a href="#l64.32"></a><span id="l64.32" class="difflineminus">-  converter.charset = &quot;UTF-8&quot;;</span>
<a href="#l64.33"></a><span id="l64.33" class="difflineminus">-</span>
<a href="#l64.34"></a><span id="l64.34" class="difflineminus">-  let hasher = Cc[&quot;@mozilla.org/security/hash;1&quot;]</span>
<a href="#l64.35"></a><span id="l64.35" class="difflineminus">-               .createInstance(Ci.nsICryptoHash);</span>
<a href="#l64.36"></a><span id="l64.36" class="difflineminus">-  hasher.init(hasher.SHA1);</span>
<a href="#l64.37"></a><span id="l64.37" class="difflineminus">-</span>
<a href="#l64.38"></a><span id="l64.38" class="difflineminus">-  let data = converter.convertToByteArray(string, {});</span>
<a href="#l64.39"></a><span id="l64.39" class="difflineminus">-  hasher.update(data, data.length);</span>
<a href="#l64.40"></a><span id="l64.40" class="difflineminus">-  let rawHash = hasher.finish(false);</span>
<a href="#l64.41"></a><span id="l64.41" class="difflineminus">-</span>
<a href="#l64.42"></a><span id="l64.42" class="difflineminus">-  // return the two-digit hexadecimal code for a byte</span>
<a href="#l64.43"></a><span id="l64.43" class="difflineminus">-  function toHexString(charCode) {</span>
<a href="#l64.44"></a><span id="l64.44" class="difflineminus">-    return (&quot;0&quot; + charCode.toString(16)).slice(-2);</span>
<a href="#l64.45"></a><span id="l64.45" class="difflineminus">-  }</span>
<a href="#l64.46"></a><span id="l64.46" class="difflineminus">-  let hash = [toHexString(rawHash.charCodeAt(i)) for (i in rawHash)].join(&quot;&quot;);</span>
<a href="#l64.47"></a><span id="l64.47" class="difflineminus">-  return hash;</span>
<a href="#l64.48"></a><span id="l64.48" class="difflineminus">-}</span>
<a href="#l64.49"></a><span id="l64.49" class="difflineminus">-</span>
<a href="#l64.50"></a><span id="l64.50" class="difflineminus">-let MetadataCollector = {</span>
<a href="#l64.51"></a><span id="l64.51" class="difflineminus">-</span>
<a href="#l64.52"></a><span id="l64.52" class="difflineminus">-  __prefs: null,</span>
<a href="#l64.53"></a><span id="l64.53" class="difflineminus">-  get _prefs() {</span>
<a href="#l64.54"></a><span id="l64.54" class="difflineminus">-    this.__prefs = Cc[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l64.55"></a><span id="l64.55" class="difflineminus">-      .getService(Ci.nsIPrefBranch);</span>
<a href="#l64.56"></a><span id="l64.56" class="difflineminus">-    return this.__prefs;</span>
<a href="#l64.57"></a><span id="l64.57" class="difflineminus">-  },</span>
<a href="#l64.58"></a><span id="l64.58" class="difflineminus">-</span>
<a href="#l64.59"></a><span id="l64.59" class="difflineminus">-  // Collects metadata such as what country you're in, what extensions you have installed, etc.</span>
<a href="#l64.60"></a><span id="l64.60" class="difflineminus">-  getExtensions: function MetadataCollector_getExtensions(callback) {</span>
<a href="#l64.61"></a><span id="l64.61" class="difflineminus">-    //http://lxr.mozilla.org/aviarybranch/source/toolkit/mozapps/extensions/public/nsIExtensionManager.idl</span>
<a href="#l64.62"></a><span id="l64.62" class="difflineminus">-    //http://lxr.mozilla.org/aviarybranch/source/toolkit/mozapps/update/public/nsIUpdateService.idl#45</span>
<a href="#l64.63"></a><span id="l64.63" class="difflineminus">-    //resource://gre/modules/AddonManager.jsm</span>
<a href="#l64.64"></a><span id="l64.64" class="difflineminus">-    Cu.import(&quot;resource://gre/modules/AddonManager.jsm&quot;);</span>
<a href="#l64.65"></a><span id="l64.65" class="difflineminus">-    let myExtensions = [];</span>
<a href="#l64.66"></a><span id="l64.66" class="difflineminus">-    AddonManager.getAllAddons(function(extensions) {</span>
<a href="#l64.67"></a><span id="l64.67" class="difflineminus">-      for each (let ex in extensions.all) {</span>
<a href="#l64.68"></a><span id="l64.68" class="difflineminus">-        myExtensions.push({ id: Weave_sha1(ex.id), isEnabled: ex.enabled });</span>
<a href="#l64.69"></a><span id="l64.69" class="difflineminus">-      }</span>
<a href="#l64.70"></a><span id="l64.70" class="difflineminus">-      callback(myExtensions);</span>
<a href="#l64.71"></a><span id="l64.71" class="difflineminus">-    });</span>
<a href="#l64.72"></a><span id="l64.72" class="difflineminus">-  },</span>
<a href="#l64.73"></a><span id="l64.73" class="difflineminus">-</span>
<a href="#l64.74"></a><span id="l64.74" class="difflineminus">-  getAccessibilities : function MetadataCollector_getAccessibilities() {</span>
<a href="#l64.75"></a><span id="l64.75" class="difflineminus">-    let prefs =</span>
<a href="#l64.76"></a><span id="l64.76" class="difflineminus">-      Cc[&quot;@mozilla.org/preferences-service;1&quot;].getService(Ci.nsIPrefService);</span>
<a href="#l64.77"></a><span id="l64.77" class="difflineminus">-    let branch = prefs.getBranch(&quot;accessibility.&quot;);</span>
<a href="#l64.78"></a><span id="l64.78" class="difflineminus">-    let accessibilities = [];</span>
<a href="#l64.79"></a><span id="l64.79" class="difflineminus">-    let children = branch.getChildList(&quot;&quot;, {});</span>
<a href="#l64.80"></a><span id="l64.80" class="difflineminus">-    let length = children.length;</span>
<a href="#l64.81"></a><span id="l64.81" class="difflineminus">-    let prefName;</span>
<a href="#l64.82"></a><span id="l64.82" class="difflineminus">-    let prefValue;</span>
<a href="#l64.83"></a><span id="l64.83" class="difflineminus">-</span>
<a href="#l64.84"></a><span id="l64.84" class="difflineminus">-    for (let i = 0; i &lt; length; i++) {</span>
<a href="#l64.85"></a><span id="l64.85" class="difflineminus">-      prefName = &quot;accessibility.&quot; + children[i];</span>
<a href="#l64.86"></a><span id="l64.86" class="difflineminus">-      let type = branch.getPrefType(children[i]);</span>
<a href="#l64.87"></a><span id="l64.87" class="difflineminus">-      switch (type) {</span>
<a href="#l64.88"></a><span id="l64.88" class="difflineminus">-      case branch.PREF_STRING:</span>
<a href="#l64.89"></a><span id="l64.89" class="difflineminus">-        prefValue = branch.getCharPref(children[i]);</span>
<a href="#l64.90"></a><span id="l64.90" class="difflineminus">-        break;</span>
<a href="#l64.91"></a><span id="l64.91" class="difflineminus">-      case branch.PREF_INT:</span>
<a href="#l64.92"></a><span id="l64.92" class="difflineminus">-        prefValue = branch.getIntPref(children[i]);</span>
<a href="#l64.93"></a><span id="l64.93" class="difflineminus">-        break;</span>
<a href="#l64.94"></a><span id="l64.94" class="difflineminus">-      case branch.PREF_BOOL:</span>
<a href="#l64.95"></a><span id="l64.95" class="difflineminus">-        prefValue = branch.getBoolPref(children[i]);</span>
<a href="#l64.96"></a><span id="l64.96" class="difflineminus">-        break;</span>
<a href="#l64.97"></a><span id="l64.97" class="difflineminus">-      }</span>
<a href="#l64.98"></a><span id="l64.98" class="difflineminus">-      accessibilities.push({ name: prefName, value: prefValue });</span>
<a href="#l64.99"></a><span id="l64.99" class="difflineminus">-    }</span>
<a href="#l64.100"></a><span id="l64.100" class="difflineminus">-</span>
<a href="#l64.101"></a><span id="l64.101" class="difflineminus">-    /* Detect accessibility instantiation</span>
<a href="#l64.102"></a><span id="l64.102" class="difflineminus">-     * (David Bolter's code from bug 577694) */</span>
<a href="#l64.103"></a><span id="l64.103" class="difflineminus">-    let enabled;</span>
<a href="#l64.104"></a><span id="l64.104" class="difflineminus">-    try {</span>
<a href="#l64.105"></a><span id="l64.105" class="difflineminus">-      enabled = Components.manager.QueryInterface(Ci.nsIServiceManager)</span>
<a href="#l64.106"></a><span id="l64.106" class="difflineminus">-                  .isServiceInstantiatedByContractID(</span>
<a href="#l64.107"></a><span id="l64.107" class="difflineminus">-                    &quot;@mozilla.org/accessibilityService;1&quot;,</span>
<a href="#l64.108"></a><span id="l64.108" class="difflineminus">-                    Ci.nsISupports);</span>
<a href="#l64.109"></a><span id="l64.109" class="difflineminus">-    } catch (ex) {</span>
<a href="#l64.110"></a><span id="l64.110" class="difflineminus">-      enabled = false;</span>
<a href="#l64.111"></a><span id="l64.111" class="difflineminus">-    }</span>
<a href="#l64.112"></a><span id="l64.112" class="difflineminus">-    accessibilities.push({name: &quot;isInstantiated&quot;, value: enabled});</span>
<a href="#l64.113"></a><span id="l64.113" class="difflineminus">-</span>
<a href="#l64.114"></a><span id="l64.114" class="difflineminus">-    return accessibilities;</span>
<a href="#l64.115"></a><span id="l64.115" class="difflineminus">-  },</span>
<a href="#l64.116"></a><span id="l64.116" class="difflineminus">-</span>
<a href="#l64.117"></a><span id="l64.117" class="difflineminus">-  getLocation: function MetadataCollector_getLocation() {</span>
<a href="#l64.118"></a><span id="l64.118" class="difflineminus">-    // we don't want the lat/long, we just want the country</span>
<a href="#l64.119"></a><span id="l64.119" class="difflineminus">-    // so use the Locale.</span>
<a href="#l64.120"></a><span id="l64.120" class="difflineminus">-    return this._prefs.getCharPref(LOCALE_PREF);</span>
<a href="#l64.121"></a><span id="l64.121" class="difflineminus">-  },</span>
<a href="#l64.122"></a><span id="l64.122" class="difflineminus">-</span>
<a href="#l64.123"></a><span id="l64.123" class="difflineminus">-  getVersion: function MetadataCollector_getVersion() {</span>
<a href="#l64.124"></a><span id="l64.124" class="difflineminus">-    return Cc[&quot;@mozilla.org/xre/app-info;1&quot;]</span>
<a href="#l64.125"></a><span id="l64.125" class="difflineminus">-      .getService(Ci.nsIXULAppInfo).version;</span>
<a href="#l64.126"></a><span id="l64.126" class="difflineminus">-  },</span>
<a href="#l64.127"></a><span id="l64.127" class="difflineminus">-</span>
<a href="#l64.128"></a><span id="l64.128" class="difflineminus">-  getOperatingSystem: function MetadataCollector_getOSVersion() {</span>
<a href="#l64.129"></a><span id="l64.129" class="difflineminus">-    let oscpu = Cc[&quot;@mozilla.org/network/protocol;1?name=http&quot;].getService(Ci.nsIHttpProtocolHandler).oscpu;</span>
<a href="#l64.130"></a><span id="l64.130" class="difflineminus">-    let os = Cc[&quot;@mozilla.org/xre/app-info;1&quot;].getService(Ci.nsIXULRuntime).OS;</span>
<a href="#l64.131"></a><span id="l64.131" class="difflineminus">-    return os + &quot; &quot; + oscpu;</span>
<a href="#l64.132"></a><span id="l64.132" class="difflineminus">-  },</span>
<a href="#l64.133"></a><span id="l64.133" class="difflineminus">-</span>
<a href="#l64.134"></a><span id="l64.134" class="difflineminus">-  getSurveyAnswers: function MetadataCollector_getSurveyAnswers() {</span>
<a href="#l64.135"></a><span id="l64.135" class="difflineminus">-    if (this._prefs.prefHasUserValue(SURVEY_ANS)) {</span>
<a href="#l64.136"></a><span id="l64.136" class="difflineminus">-      let answers = this._prefs.getCharPref(SURVEY_ANS);</span>
<a href="#l64.137"></a><span id="l64.137" class="difflineminus">-      return sanitizeJSONStrings( JSON.parse(answers) );</span>
<a href="#l64.138"></a><span id="l64.138" class="difflineminus">-    } else {</span>
<a href="#l64.139"></a><span id="l64.139" class="difflineminus">-      return &quot;&quot;;</span>
<a href="#l64.140"></a><span id="l64.140" class="difflineminus">-    }</span>
<a href="#l64.141"></a><span id="l64.141" class="difflineminus">-  },</span>
<a href="#l64.142"></a><span id="l64.142" class="difflineminus">-</span>
<a href="#l64.143"></a><span id="l64.143" class="difflineminus">-  getTestPilotVersion: function MetadataCollector_getTPVersion(callback) {</span>
<a href="#l64.144"></a><span id="l64.144" class="difflineminus">-    Cu.import(&quot;resource://gre/modules/AddonManager.jsm&quot;);</span>
<a href="#l64.145"></a><span id="l64.145" class="difflineminus">-    AddonManager.getAddonByID(EXTENSION_ID, function(addon) {</span>
<a href="#l64.146"></a><span id="l64.146" class="difflineminus">-      callback(addon.version);</span>
<a href="#l64.147"></a><span id="l64.147" class="difflineminus">-    });</span>
<a href="#l64.148"></a><span id="l64.148" class="difflineminus">-  },</span>
<a href="#l64.149"></a><span id="l64.149" class="difflineminus">-</span>
<a href="#l64.150"></a><span id="l64.150" class="difflineminus">-  getUpdateChannel: function MetadataCollector_getUpdateChannel() {</span>
<a href="#l64.151"></a><span id="l64.151" class="difflineminus">-    // TODO should be reading this from default branch</span>
<a href="#l64.152"></a><span id="l64.152" class="difflineminus">-    return this._prefs.getCharPref(UPDATE_CHANNEL_PREF, &quot;&quot;);</span>
<a href="#l64.153"></a><span id="l64.153" class="difflineminus">-  },</span>
<a href="#l64.154"></a><span id="l64.154" class="difflineminus">-</span>
<a href="#l64.155"></a><span id="l64.155" class="difflineminus">-  getMetadata: function MetadataCollector_getMetadata(callback) {</span>
<a href="#l64.156"></a><span id="l64.156" class="difflineminus">-    let self = this;</span>
<a href="#l64.157"></a><span id="l64.157" class="difflineminus">-    self.getTestPilotVersion(function(tpVersion) {</span>
<a href="#l64.158"></a><span id="l64.158" class="difflineminus">-      self.getExtensions(function(extensions) {</span>
<a href="#l64.159"></a><span id="l64.159" class="difflineminus">-        callback({ extensions: extensions,</span>
<a href="#l64.160"></a><span id="l64.160" class="difflineminus">-                   accessibilities: self.getAccessibilities(),</span>
<a href="#l64.161"></a><span id="l64.161" class="difflineminus">-	           location: self.getLocation(),</span>
<a href="#l64.162"></a><span id="l64.162" class="difflineminus">-	           fxVersion: self.getVersion(),</span>
<a href="#l64.163"></a><span id="l64.163" class="difflineminus">-                   operatingSystem: self.getOperatingSystem(),</span>
<a href="#l64.164"></a><span id="l64.164" class="difflineminus">-                   tpVersion: tpVersion,</span>
<a href="#l64.165"></a><span id="l64.165" class="difflineminus">-                   surveyAnswers: self.getSurveyAnswers(),</span>
<a href="#l64.166"></a><span id="l64.166" class="difflineminus">-                   updateChannel: self.getUpdateChannel()}</span>
<a href="#l64.167"></a><span id="l64.167" class="difflineminus">-                 );</span>
<a href="#l64.168"></a><span id="l64.168" class="difflineminus">-      });</span>
<a href="#l64.169"></a><span id="l64.169" class="difflineminus">-    });</span>
<a href="#l64.170"></a><span id="l64.170" class="difflineminus">-  }</span>
<a href="#l64.171"></a><span id="l64.171" class="difflineminus">-  // TODO if we make a GUID for the user, we keep it here.</span>
<a href="#l64.172"></a><span id="l64.172" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l65.1"></a><span id="l65.1">deleted file mode 100644</span>
<a href="#l65.2"></a><span id="l65.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/notifications.js</span>
<a href="#l65.3"></a><span id="l65.3" class="difflineplus">+++ /dev/null</span>
<a href="#l65.4"></a><span id="l65.4" class="difflineat">@@ -1,293 +0,0 @@</span>
<a href="#l65.5"></a><span id="l65.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l65.6"></a><span id="l65.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l65.7"></a><span id="l65.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l65.8"></a><span id="l65.8" class="difflineminus">-</span>
<a href="#l65.9"></a><span id="l65.9" class="difflineminus">-/* The TestPilotSetup object will choose one of these implementations to instantiate.</span>
<a href="#l65.10"></a><span id="l65.10" class="difflineminus">- * The interface for all NotificationManager implementations is:</span>
<a href="#l65.11"></a><span id="l65.11" class="difflineminus">-     showNotification: function(window, options) {},</span>
<a href="#l65.12"></a><span id="l65.12" class="difflineminus">-     hideNotification: function(window) {}</span>
<a href="#l65.13"></a><span id="l65.13" class="difflineminus">- */</span>
<a href="#l65.14"></a><span id="l65.14" class="difflineminus">-</span>
<a href="#l65.15"></a><span id="l65.15" class="difflineminus">-EXPORTED_SYMBOLS = [&quot;CustomNotificationManager&quot;, &quot;PopupNotificationManager&quot;,</span>
<a href="#l65.16"></a><span id="l65.16" class="difflineminus">-                    &quot;AndroidNotificationManager&quot;];</span>
<a href="#l65.17"></a><span id="l65.17" class="difflineminus">-</span>
<a href="#l65.18"></a><span id="l65.18" class="difflineminus">-const Cc = Components.classes;</span>
<a href="#l65.19"></a><span id="l65.19" class="difflineminus">-const Ci = Components.interfaces;</span>
<a href="#l65.20"></a><span id="l65.20" class="difflineminus">-const Cu = Components.utils;</span>
<a href="#l65.21"></a><span id="l65.21" class="difflineminus">-</span>
<a href="#l65.22"></a><span id="l65.22" class="difflineminus">-function AndroidNotificationManager() {</span>
<a href="#l65.23"></a><span id="l65.23" class="difflineminus">-  // See https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIAlertsService</span>
<a href="#l65.24"></a><span id="l65.24" class="difflineminus">-  Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l65.25"></a><span id="l65.25" class="difflineminus">-  Services.console.logStringMessage(&quot;Android Notfn Manager Instantiated.&quot;);</span>
<a href="#l65.26"></a><span id="l65.26" class="difflineminus">-  // Get an error in the next line saying NS_ERROR_XPC_GS_RETURNED_FAILURE (nsIJSCID.getService)</span>
<a href="#l65.27"></a><span id="l65.27" class="difflineminus">-  // is this because the alert service isn't available on desktop fennec???</span>
<a href="#l65.28"></a><span id="l65.28" class="difflineminus">-  this._alerts = Cc[&quot;@mozilla.org/alerts-service;1&quot;].getService(Ci.nsIAlertsService);</span>
<a href="#l65.29"></a><span id="l65.29" class="difflineminus">-}</span>
<a href="#l65.30"></a><span id="l65.30" class="difflineminus">-AndroidNotificationManager.prototype = {</span>
<a href="#l65.31"></a><span id="l65.31" class="difflineminus">-  showNotification: function TP_AndroidNotfn_showNotification(window, options) {</span>
<a href="#l65.32"></a><span id="l65.32" class="difflineminus">-    /* Submit, SeeAllStudies, alwaysSubmit, and Cancel options not implemented.</span>
<a href="#l65.33"></a><span id="l65.33" class="difflineminus">-     * fragile and iconClass are ignored.  Clicking the notification always activates</span>
<a href="#l65.34"></a><span id="l65.34" class="difflineminus">-     * the moreInfo option (e.g. opens the More Info page.)</span>
<a href="#l65.35"></a><span id="l65.35" class="difflineminus">-     */</span>
<a href="#l65.36"></a><span id="l65.36" class="difflineminus">-    Services.console.logStringMessage(&quot;Showing Android Notfn: &quot; + options.text);</span>
<a href="#l65.37"></a><span id="l65.37" class="difflineminus">-</span>
<a href="#l65.38"></a><span id="l65.38" class="difflineminus">-    this._alerts.showAlertNotification(&quot;drawable://alertaddons&quot;,</span>
<a href="#l65.39"></a><span id="l65.39" class="difflineminus">-                                       options.title,</span>
<a href="#l65.40"></a><span id="l65.40" class="difflineminus">-                                       options.text,</span>
<a href="#l65.41"></a><span id="l65.41" class="difflineminus">-                                       true, // link is clickable</span>
<a href="#l65.42"></a><span id="l65.42" class="difflineminus">-                                       &quot;&quot;, // no cookie</span>
<a href="#l65.43"></a><span id="l65.43" class="difflineminus">-                                       { observe: function(aSubject, aTopic, data) {</span>
<a href="#l65.44"></a><span id="l65.44" class="difflineminus">-                                           if (aTopic == &quot;alertclickcallback&quot;) {</span>
<a href="#l65.45"></a><span id="l65.45" class="difflineminus">-                                             if (options.moreInfoLabel) {</span>
<a href="#l65.46"></a><span id="l65.46" class="difflineminus">-                                               options.moreInfoCallback();</span>
<a href="#l65.47"></a><span id="l65.47" class="difflineminus">-                                             }</span>
<a href="#l65.48"></a><span id="l65.48" class="difflineminus">-                                             Services.console.logStringMessage(&quot;Notfn clicked.&quot;);</span>
<a href="#l65.49"></a><span id="l65.49" class="difflineminus">-                                           }</span>
<a href="#l65.50"></a><span id="l65.50" class="difflineminus">-                                         }</span>
<a href="#l65.51"></a><span id="l65.51" class="difflineminus">-                                       },</span>
<a href="#l65.52"></a><span id="l65.52" class="difflineminus">-                                       &quot;test-pilot-notification&quot;);</span>
<a href="#l65.53"></a><span id="l65.53" class="difflineminus">-  },</span>
<a href="#l65.54"></a><span id="l65.54" class="difflineminus">-</span>
<a href="#l65.55"></a><span id="l65.55" class="difflineminus">-  hideNotification: function TP_AndroidNotfn_showNotification(window) {</span>
<a href="#l65.56"></a><span id="l65.56" class="difflineminus">-  }</span>
<a href="#l65.57"></a><span id="l65.57" class="difflineminus">-};</span>
<a href="#l65.58"></a><span id="l65.58" class="difflineminus">-</span>
<a href="#l65.59"></a><span id="l65.59" class="difflineminus">-</span>
<a href="#l65.60"></a><span id="l65.60" class="difflineminus">-/* CustomNotificationManager: the one where notifications</span>
<a href="#l65.61"></a><span id="l65.61" class="difflineminus">- * come up from the Test Pilot icon in the addon bar.  For Firefox 3.6. */</span>
<a href="#l65.62"></a><span id="l65.62" class="difflineminus">-function CustomNotificationManager(anchorToFeedbackButton) {</span>
<a href="#l65.63"></a><span id="l65.63" class="difflineminus">-  this._anchorToFeedback = anchorToFeedbackButton;</span>
<a href="#l65.64"></a><span id="l65.64" class="difflineminus">-}</span>
<a href="#l65.65"></a><span id="l65.65" class="difflineminus">-CustomNotificationManager.prototype = {</span>
<a href="#l65.66"></a><span id="l65.66" class="difflineminus">-  showNotification: function TP_OldNotfn_showNotification(window, options) {</span>
<a href="#l65.67"></a><span id="l65.67" class="difflineminus">-    let doc = window.document;</span>
<a href="#l65.68"></a><span id="l65.68" class="difflineminus">-    let popup = doc.getElementById(&quot;pilot-notification-popup&quot;);</span>
<a href="#l65.69"></a><span id="l65.69" class="difflineminus">-    let anchor;</span>
<a href="#l65.70"></a><span id="l65.70" class="difflineminus">-    if (this._anchorToFeedback) {</span>
<a href="#l65.71"></a><span id="l65.71" class="difflineminus">-      /* If we're in the Ffx4Beta version, popups come down from feedback</span>
<a href="#l65.72"></a><span id="l65.72" class="difflineminus">-       * button, but if we're in the standalone extension version, they</span>
<a href="#l65.73"></a><span id="l65.73" class="difflineminus">-       * come up from status bar icon. */</span>
<a href="#l65.74"></a><span id="l65.74" class="difflineminus">-      anchor = doc.getElementById(&quot;feedback-menu-button&quot;);</span>
<a href="#l65.75"></a><span id="l65.75" class="difflineminus">-      popup.setAttribute(&quot;class&quot;, &quot;tail-up&quot;);</span>
<a href="#l65.76"></a><span id="l65.76" class="difflineminus">-    } else {</span>
<a href="#l65.77"></a><span id="l65.77" class="difflineminus">-      // XXX Thunderbird doesn't have the pilot-notifications-button, so we anchor</span>
<a href="#l65.78"></a><span id="l65.78" class="difflineminus">-      // to the toolbar instead</span>
<a href="#l65.79"></a><span id="l65.79" class="difflineminus">-      // anchor = doc.getElementById(&quot;pilot-notifications-button&quot;);</span>
<a href="#l65.80"></a><span id="l65.80" class="difflineminus">-      anchor = doc.getElementById(&quot;mail-bar3&quot;);</span>
<a href="#l65.81"></a><span id="l65.81" class="difflineminus">-      popup.setAttribute(&quot;class&quot;, &quot;tail-down&quot;);</span>
<a href="#l65.82"></a><span id="l65.82" class="difflineminus">-    }</span>
<a href="#l65.83"></a><span id="l65.83" class="difflineminus">-    let textLabel = doc.getElementById(&quot;pilot-notification-text&quot;);</span>
<a href="#l65.84"></a><span id="l65.84" class="difflineminus">-    let titleLabel = doc.getElementById(&quot;pilot-notification-title&quot;);</span>
<a href="#l65.85"></a><span id="l65.85" class="difflineminus">-    let icon = doc.getElementById(&quot;pilot-notification-icon&quot;);</span>
<a href="#l65.86"></a><span id="l65.86" class="difflineminus">-    let submitBtn = doc.getElementById(&quot;pilot-notification-submit&quot;);</span>
<a href="#l65.87"></a><span id="l65.87" class="difflineminus">-    let closeBtn = doc.getElementById(&quot;pilot-notification-close&quot;);</span>
<a href="#l65.88"></a><span id="l65.88" class="difflineminus">-    let link = doc.getElementById(&quot;pilot-notification-link&quot;);</span>
<a href="#l65.89"></a><span id="l65.89" class="difflineminus">-    let alwaysSubmitCheckbox =</span>
<a href="#l65.90"></a><span id="l65.90" class="difflineminus">-      doc.getElementById(&quot;pilot-notification-always-submit-checkbox&quot;);</span>
<a href="#l65.91"></a><span id="l65.91" class="difflineminus">-    let self = this;</span>
<a href="#l65.92"></a><span id="l65.92" class="difflineminus">-</span>
<a href="#l65.93"></a><span id="l65.93" class="difflineminus">-    popup.setAttribute(&quot;noautohide&quot;, !(options.fragile));</span>
<a href="#l65.94"></a><span id="l65.94" class="difflineminus">-    if (options.title) {</span>
<a href="#l65.95"></a><span id="l65.95" class="difflineminus">-      titleLabel.setAttribute(&quot;value&quot;, options.title);</span>
<a href="#l65.96"></a><span id="l65.96" class="difflineminus">-    }</span>
<a href="#l65.97"></a><span id="l65.97" class="difflineminus">-    while (textLabel.lastChild) {</span>
<a href="#l65.98"></a><span id="l65.98" class="difflineminus">-      textLabel.removeChild(textLabel.lastChild);</span>
<a href="#l65.99"></a><span id="l65.99" class="difflineminus">-    }</span>
<a href="#l65.100"></a><span id="l65.100" class="difflineminus">-    if (options.text) {</span>
<a href="#l65.101"></a><span id="l65.101" class="difflineminus">-      textLabel.appendChild(doc.createTextNode(options.text));</span>
<a href="#l65.102"></a><span id="l65.102" class="difflineminus">-    }</span>
<a href="#l65.103"></a><span id="l65.103" class="difflineminus">-    if (options.iconClass) {</span>
<a href="#l65.104"></a><span id="l65.104" class="difflineminus">-      // css will set the image url based on the class.</span>
<a href="#l65.105"></a><span id="l65.105" class="difflineminus">-      icon.setAttribute(&quot;class&quot;, options.iconClass);</span>
<a href="#l65.106"></a><span id="l65.106" class="difflineminus">-    }</span>
<a href="#l65.107"></a><span id="l65.107" class="difflineminus">-</span>
<a href="#l65.108"></a><span id="l65.108" class="difflineminus">-    if (options.submitLabel &amp;&amp; options.alwaysSubmitLabel) {</span>
<a href="#l65.109"></a><span id="l65.109" class="difflineminus">-      alwaysSubmitCheckbox.removeAttribute(&quot;hidden&quot;);</span>
<a href="#l65.110"></a><span id="l65.110" class="difflineminus">-      alwaysSubmitCheckbox.setAttribute(&quot;label&quot;, options.alwaysSubmitLabel);</span>
<a href="#l65.111"></a><span id="l65.111" class="difflineminus">-    } else {</span>
<a href="#l65.112"></a><span id="l65.112" class="difflineminus">-      alwaysSubmitCheckbox.setAttribute(&quot;hidden&quot;, true);</span>
<a href="#l65.113"></a><span id="l65.113" class="difflineminus">-    }</span>
<a href="#l65.114"></a><span id="l65.114" class="difflineminus">-</span>
<a href="#l65.115"></a><span id="l65.115" class="difflineminus">-    if (options.submitLabel) {</span>
<a href="#l65.116"></a><span id="l65.116" class="difflineminus">-      submitBtn.setAttribute(&quot;label&quot;, options.submitLabel);</span>
<a href="#l65.117"></a><span id="l65.117" class="difflineminus">-      submitBtn.onclick = function(event) {</span>
<a href="#l65.118"></a><span id="l65.118" class="difflineminus">-        if (event.button == 0) {</span>
<a href="#l65.119"></a><span id="l65.119" class="difflineminus">-          if (alwaysSubmitCheckbox.checked &amp;&amp; options.alwaysSubmitCallback) {</span>
<a href="#l65.120"></a><span id="l65.120" class="difflineminus">-            options.alwaysSubmitCallback();</span>
<a href="#l65.121"></a><span id="l65.121" class="difflineminus">-          }</span>
<a href="#l65.122"></a><span id="l65.122" class="difflineminus">-          options.submitCallback();</span>
<a href="#l65.123"></a><span id="l65.123" class="difflineminus">-          self.hideNotification(window);</span>
<a href="#l65.124"></a><span id="l65.124" class="difflineminus">-          if (options.closeCallback) {</span>
<a href="#l65.125"></a><span id="l65.125" class="difflineminus">-            options.closeCallback();</span>
<a href="#l65.126"></a><span id="l65.126" class="difflineminus">-          }</span>
<a href="#l65.127"></a><span id="l65.127" class="difflineminus">-        }</span>
<a href="#l65.128"></a><span id="l65.128" class="difflineminus">-      };</span>
<a href="#l65.129"></a><span id="l65.129" class="difflineminus">-    }</span>
<a href="#l65.130"></a><span id="l65.130" class="difflineminus">-    if (options.submitLabel) {</span>
<a href="#l65.131"></a><span id="l65.131" class="difflineminus">-      submitBtn.removeAttribute(&quot;hidden&quot;);</span>
<a href="#l65.132"></a><span id="l65.132" class="difflineminus">-    } else {</span>
<a href="#l65.133"></a><span id="l65.133" class="difflineminus">-      submitBtn.setAttribute(&quot;hidden&quot;, true);</span>
<a href="#l65.134"></a><span id="l65.134" class="difflineminus">-    }</span>
<a href="#l65.135"></a><span id="l65.135" class="difflineminus">-</span>
<a href="#l65.136"></a><span id="l65.136" class="difflineminus">-    // Create the link if specified:</span>
<a href="#l65.137"></a><span id="l65.137" class="difflineminus">-    if (options.moreInfoLabel) {</span>
<a href="#l65.138"></a><span id="l65.138" class="difflineminus">-      link.setAttribute(&quot;value&quot;, options.moreInfoLabel);</span>
<a href="#l65.139"></a><span id="l65.139" class="difflineminus">-      link.setAttribute(&quot;class&quot;, &quot;notification-link&quot;);</span>
<a href="#l65.140"></a><span id="l65.140" class="difflineminus">-      link.onclick = function(event) {</span>
<a href="#l65.141"></a><span id="l65.141" class="difflineminus">-        if (event.button == 0) {</span>
<a href="#l65.142"></a><span id="l65.142" class="difflineminus">-          options.moreInfoCallback();</span>
<a href="#l65.143"></a><span id="l65.143" class="difflineminus">-          self.hideNotification(window);</span>
<a href="#l65.144"></a><span id="l65.144" class="difflineminus">-          if (options.closeCallback) {</span>
<a href="#l65.145"></a><span id="l65.145" class="difflineminus">-            options.closeCallback();</span>
<a href="#l65.146"></a><span id="l65.146" class="difflineminus">-          }</span>
<a href="#l65.147"></a><span id="l65.147" class="difflineminus">-        }</span>
<a href="#l65.148"></a><span id="l65.148" class="difflineminus">-      };</span>
<a href="#l65.149"></a><span id="l65.149" class="difflineminus">-      link.removeAttribute(&quot;hidden&quot;);</span>
<a href="#l65.150"></a><span id="l65.150" class="difflineminus">-    } else {</span>
<a href="#l65.151"></a><span id="l65.151" class="difflineminus">-      link.setAttribute(&quot;hidden&quot;, true);</span>
<a href="#l65.152"></a><span id="l65.152" class="difflineminus">-    }</span>
<a href="#l65.153"></a><span id="l65.153" class="difflineminus">-</span>
<a href="#l65.154"></a><span id="l65.154" class="difflineminus">-    closeBtn.onclick = function() {</span>
<a href="#l65.155"></a><span id="l65.155" class="difflineminus">-      self.hideNotification(window);</span>
<a href="#l65.156"></a><span id="l65.156" class="difflineminus">-      if (options.closeCallback) {</span>
<a href="#l65.157"></a><span id="l65.157" class="difflineminus">-        options.closeCallback();</span>
<a href="#l65.158"></a><span id="l65.158" class="difflineminus">-      }</span>
<a href="#l65.159"></a><span id="l65.159" class="difflineminus">-    };</span>
<a href="#l65.160"></a><span id="l65.160" class="difflineminus">-</span>
<a href="#l65.161"></a><span id="l65.161" class="difflineminus">-    // Show the popup:</span>
<a href="#l65.162"></a><span id="l65.162" class="difflineminus">-    popup.hidden = false;</span>
<a href="#l65.163"></a><span id="l65.163" class="difflineminus">-    popup.setAttribute(&quot;open&quot;, &quot;true&quot;);</span>
<a href="#l65.164"></a><span id="l65.164" class="difflineminus">-    // XXX Thunderbird needs after_start for now.</span>
<a href="#l65.165"></a><span id="l65.165" class="difflineminus">-    popup.openPopup( anchor, &quot;after_start&quot;);//&quot;after_end&quot;);</span>
<a href="#l65.166"></a><span id="l65.166" class="difflineminus">-  },</span>
<a href="#l65.167"></a><span id="l65.167" class="difflineminus">-</span>
<a href="#l65.168"></a><span id="l65.168" class="difflineminus">-  hideNotification: function TP_OldNotfn_hideNotification(window) {</span>
<a href="#l65.169"></a><span id="l65.169" class="difflineminus">-    let popup = window.document.getElementById(&quot;pilot-notification-popup&quot;);</span>
<a href="#l65.170"></a><span id="l65.170" class="difflineminus">-    popup.removeAttribute(&quot;open&quot;);</span>
<a href="#l65.171"></a><span id="l65.171" class="difflineminus">-    popup.hidePopup();</span>
<a href="#l65.172"></a><span id="l65.172" class="difflineminus">-  }</span>
<a href="#l65.173"></a><span id="l65.173" class="difflineminus">-};</span>
<a href="#l65.174"></a><span id="l65.174" class="difflineminus">-</span>
<a href="#l65.175"></a><span id="l65.175" class="difflineminus">-// For Fx 4.0 + , uses the built-in doorhanger notification system (but with my own anchor icon)</span>
<a href="#l65.176"></a><span id="l65.176" class="difflineminus">-function PopupNotificationManager(anchorToFeedbackButton) {</span>
<a href="#l65.177"></a><span id="l65.177" class="difflineminus">-  this._popupModule = {};</span>
<a href="#l65.178"></a><span id="l65.178" class="difflineminus">-  Components.utils.import(&quot;resource://gre/modules/PopupNotifications.jsm&quot;, this._popupModule);</span>
<a href="#l65.179"></a><span id="l65.179" class="difflineminus">-  this._anchorToFeedbackButton = anchorToFeedbackButton;</span>
<a href="#l65.180"></a><span id="l65.180" class="difflineminus">-  this._pn = null;</span>
<a href="#l65.181"></a><span id="l65.181" class="difflineminus">-}</span>
<a href="#l65.182"></a><span id="l65.182" class="difflineminus">-PopupNotificationManager.prototype = {</span>
<a href="#l65.183"></a><span id="l65.183" class="difflineminus">-  get _stringBundle() {</span>
<a href="#l65.184"></a><span id="l65.184" class="difflineminus">-    delete this._stringBundle;</span>
<a href="#l65.185"></a><span id="l65.185" class="difflineminus">-    return this._stringBundle = Cc[&quot;@mozilla.org/intl/stringbundle;1&quot;].</span>
<a href="#l65.186"></a><span id="l65.186" class="difflineminus">-        getService(Ci.nsIStringBundleService).</span>
<a href="#l65.187"></a><span id="l65.187" class="difflineminus">-          createBundle(&quot;chrome://testpilot/locale/main.properties&quot;);</span>
<a href="#l65.188"></a><span id="l65.188" class="difflineminus">-  },</span>
<a href="#l65.189"></a><span id="l65.189" class="difflineminus">-</span>
<a href="#l65.190"></a><span id="l65.190" class="difflineminus">-  _getLocalizedAccessKey: function(command) {</span>
<a href="#l65.191"></a><span id="l65.191" class="difflineminus">-    return this._stringBundle.GetStringFromName(&quot;testpilot.notification.accessKey.&quot; + command);</span>
<a href="#l65.192"></a><span id="l65.192" class="difflineminus">-  },</span>
<a href="#l65.193"></a><span id="l65.193" class="difflineminus">-</span>
<a href="#l65.194"></a><span id="l65.194" class="difflineminus">-  showNotification: function TP_NewNotfn_showNotification(window, options) {</span>
<a href="#l65.195"></a><span id="l65.195" class="difflineminus">-    let additionalOptions = [];</span>
<a href="#l65.196"></a><span id="l65.196" class="difflineminus">-    let defaultOption;</span>
<a href="#l65.197"></a><span id="l65.197" class="difflineminus">-    let self = this;</span>
<a href="#l65.198"></a><span id="l65.198" class="difflineminus">-    let tabbrowser = window.getBrowser();</span>
<a href="#l65.199"></a><span id="l65.199" class="difflineminus">-    let panel = window.document.getElementById(&quot;testpilot-notification-popup&quot;);</span>
<a href="#l65.200"></a><span id="l65.200" class="difflineminus">-    let iconBox = window.document.getElementById(&quot;tp-notification-popup-box&quot;);</span>
<a href="#l65.201"></a><span id="l65.201" class="difflineminus">-</span>
<a href="#l65.202"></a><span id="l65.202" class="difflineminus">-    // hide any existing notification so we don't get a weird stack</span>
<a href="#l65.203"></a><span id="l65.203" class="difflineminus">-    this.hideNotification();</span>
<a href="#l65.204"></a><span id="l65.204" class="difflineminus">-</span>
<a href="#l65.205"></a><span id="l65.205" class="difflineminus">-    // TODO this is recreating PopupNotifications every time... should create once and store ref, but</span>
<a href="#l65.206"></a><span id="l65.206" class="difflineminus">-    // can we do that without the window ref?</span>
<a href="#l65.207"></a><span id="l65.207" class="difflineminus">-    this._pn = new this._popupModule.PopupNotifications(tabbrowser, panel, iconBox);</span>
<a href="#l65.208"></a><span id="l65.208" class="difflineminus">-</span>
<a href="#l65.209"></a><span id="l65.209" class="difflineminus">-    let submitOption = {label: options.submitLabel,</span>
<a href="#l65.210"></a><span id="l65.210" class="difflineminus">-                        accessKey: self._getLocalizedAccessKey(&quot;submit&quot;),</span>
<a href="#l65.211"></a><span id="l65.211" class="difflineminus">-                        callback: function() {</span>
<a href="#l65.212"></a><span id="l65.212" class="difflineminus">-                          options.submitCallback();</span>
<a href="#l65.213"></a><span id="l65.213" class="difflineminus">-                          self.hideNotification();</span>
<a href="#l65.214"></a><span id="l65.214" class="difflineminus">-                        }};</span>
<a href="#l65.215"></a><span id="l65.215" class="difflineminus">-    let moreInfoOption = {label: options.moreInfoLabel,</span>
<a href="#l65.216"></a><span id="l65.216" class="difflineminus">-                          accessKey: self._getLocalizedAccessKey(&quot;moreInfo&quot;),</span>
<a href="#l65.217"></a><span id="l65.217" class="difflineminus">-                          callback: function() {</span>
<a href="#l65.218"></a><span id="l65.218" class="difflineminus">-                            options.moreInfoCallback();</span>
<a href="#l65.219"></a><span id="l65.219" class="difflineminus">-                            self.hideNotification();</span>
<a href="#l65.220"></a><span id="l65.220" class="difflineminus">-                          }};</span>
<a href="#l65.221"></a><span id="l65.221" class="difflineminus">-</span>
<a href="#l65.222"></a><span id="l65.222" class="difflineminus">-    if (submitOption.label &amp;&amp; moreInfoOption.label) {</span>
<a href="#l65.223"></a><span id="l65.223" class="difflineminus">-      // If both provided, then submit is default button, moreInfo is in the menu:</span>
<a href="#l65.224"></a><span id="l65.224" class="difflineminus">-      defaultOption = submitOption;</span>
<a href="#l65.225"></a><span id="l65.225" class="difflineminus">-      additionalOptions.push(moreInfoOption);</span>
<a href="#l65.226"></a><span id="l65.226" class="difflineminus">-    } else if (moreInfoOption.label) {</span>
<a href="#l65.227"></a><span id="l65.227" class="difflineminus">-      // If submit not provided, use the 'more info' as the default button.</span>
<a href="#l65.228"></a><span id="l65.228" class="difflineminus">-      defaultOption = moreInfoOption;</span>
<a href="#l65.229"></a><span id="l65.229" class="difflineminus">-    } else {</span>
<a href="#l65.230"></a><span id="l65.230" class="difflineminus">-      // There must be at least one of submit option and/or moreInfo option.</span>
<a href="#l65.231"></a><span id="l65.231" class="difflineminus">-      throw &quot;No valid default option specified.&quot;;</span>
<a href="#l65.232"></a><span id="l65.232" class="difflineminus">-    }</span>
<a href="#l65.233"></a><span id="l65.233" class="difflineminus">-</span>
<a href="#l65.234"></a><span id="l65.234" class="difflineminus">-    if (options.seeAllStudiesLabel) {</span>
<a href="#l65.235"></a><span id="l65.235" class="difflineminus">-      additionalOptions.push({ label: options.seeAllStudiesLabel,</span>
<a href="#l65.236"></a><span id="l65.236" class="difflineminus">-                               accessKey: self._getLocalizedAccessKey(&quot;allStudies&quot;),</span>
<a href="#l65.237"></a><span id="l65.237" class="difflineminus">-                               callback: function() {</span>
<a href="#l65.238"></a><span id="l65.238" class="difflineminus">-                                 options.seeAllStudiesCallback();</span>
<a href="#l65.239"></a><span id="l65.239" class="difflineminus">-                                 self.hideNotification();</span>
<a href="#l65.240"></a><span id="l65.240" class="difflineminus">-                               }});</span>
<a href="#l65.241"></a><span id="l65.241" class="difflineminus">-</span>
<a href="#l65.242"></a><span id="l65.242" class="difflineminus">-    }</span>
<a href="#l65.243"></a><span id="l65.243" class="difflineminus">-</span>
<a href="#l65.244"></a><span id="l65.244" class="difflineminus">-    if (options.alwaysSubmitLabel) {</span>
<a href="#l65.245"></a><span id="l65.245" class="difflineminus">-      additionalOptions.push({ label: options.alwaysSubmitLabel,</span>
<a href="#l65.246"></a><span id="l65.246" class="difflineminus">-                               accessKey: self._getLocalizedAccessKey(&quot;alwaysSubmit&quot;),</span>
<a href="#l65.247"></a><span id="l65.247" class="difflineminus">-                               callback: function() {</span>
<a href="#l65.248"></a><span id="l65.248" class="difflineminus">-                                 options.alwaysSubmitCallback();</span>
<a href="#l65.249"></a><span id="l65.249" class="difflineminus">-                                 if (options.submitCallback) {</span>
<a href="#l65.250"></a><span id="l65.250" class="difflineminus">-                                   options.submitCallback();</span>
<a href="#l65.251"></a><span id="l65.251" class="difflineminus">-                                 }</span>
<a href="#l65.252"></a><span id="l65.252" class="difflineminus">-                                 self.hideNotification();</span>
<a href="#l65.253"></a><span id="l65.253" class="difflineminus">-                               }});</span>
<a href="#l65.254"></a><span id="l65.254" class="difflineminus">-    }</span>
<a href="#l65.255"></a><span id="l65.255" class="difflineminus">-</span>
<a href="#l65.256"></a><span id="l65.256" class="difflineminus">-    if (options.cancelLabel) {</span>
<a href="#l65.257"></a><span id="l65.257" class="difflineminus">-      additionalOptions.push({ label: options.cancelLabel,</span>
<a href="#l65.258"></a><span id="l65.258" class="difflineminus">-                               accessKey: self._getLocalizedAccessKey(&quot;cancel&quot;),</span>
<a href="#l65.259"></a><span id="l65.259" class="difflineminus">-                               callback: function() {</span>
<a href="#l65.260"></a><span id="l65.260" class="difflineminus">-                                 options.cancelCallback();</span>
<a href="#l65.261"></a><span id="l65.261" class="difflineminus">-                                 self.hideNotification();</span>
<a href="#l65.262"></a><span id="l65.262" class="difflineminus">-                               }});</span>
<a href="#l65.263"></a><span id="l65.263" class="difflineminus">-    }</span>
<a href="#l65.264"></a><span id="l65.264" class="difflineminus">-</span>
<a href="#l65.265"></a><span id="l65.265" class="difflineminus">-    this._notifRef = this._pn.show(window.getBrowser().selectedBrowser,</span>
<a href="#l65.266"></a><span id="l65.266" class="difflineminus">-                             &quot;testpilot&quot;,</span>
<a href="#l65.267"></a><span id="l65.267" class="difflineminus">-                             options.text,</span>
<a href="#l65.268"></a><span id="l65.268" class="difflineminus">-                             &quot;tp-notification-popup-icon&quot;, // All TP notifications use this icon</span>
<a href="#l65.269"></a><span id="l65.269" class="difflineminus">-                             defaultOption,</span>
<a href="#l65.270"></a><span id="l65.270" class="difflineminus">-                             additionalOptions,</span>
<a href="#l65.271"></a><span id="l65.271" class="difflineminus">-                             {persistWhileVisible: true,</span>
<a href="#l65.272"></a><span id="l65.272" class="difflineminus">-                              timeout: 5000,</span>
<a href="#l65.273"></a><span id="l65.273" class="difflineminus">-                              removeOnDismissal: options.fragile,</span>
<a href="#l65.274"></a><span id="l65.274" class="difflineminus">-                              title: options.title,</span>
<a href="#l65.275"></a><span id="l65.275" class="difflineminus">-                              iconClass: options.iconClass,</span>
<a href="#l65.276"></a><span id="l65.276" class="difflineminus">-                              closeButtonFunc: function() {</span>
<a href="#l65.277"></a><span id="l65.277" class="difflineminus">-                                self.hideNotification();</span>
<a href="#l65.278"></a><span id="l65.278" class="difflineminus">-                              },</span>
<a href="#l65.279"></a><span id="l65.279" class="difflineminus">-                              eventCallback: function(stateChange){</span>
<a href="#l65.280"></a><span id="l65.280" class="difflineminus">-                                /* Note - closeCallback() will be called AFTER the button handler,</span>
<a href="#l65.281"></a><span id="l65.281" class="difflineminus">-                                 * and will be called no matter whether the notification is closed via</span>
<a href="#l65.282"></a><span id="l65.282" class="difflineminus">-                                 * close button or a menu button item.</span>
<a href="#l65.283"></a><span id="l65.283" class="difflineminus">-                                 */</span>
<a href="#l65.284"></a><span id="l65.284" class="difflineminus">-                                if (stateChange == &quot;removed&quot; &amp;&amp; options.closeCallback) {</span>
<a href="#l65.285"></a><span id="l65.285" class="difflineminus">-                                  options.closeCallback();</span>
<a href="#l65.286"></a><span id="l65.286" class="difflineminus">-                                }</span>
<a href="#l65.287"></a><span id="l65.287" class="difflineminus">-                              }}); // should make it not disappear for at least 5s?</span>
<a href="#l65.288"></a><span id="l65.288" class="difflineminus">-    // See http://mxr.mozilla.org/mozilla-central/source/toolkit/content/PopupNotifications.jsm</span>
<a href="#l65.289"></a><span id="l65.289" class="difflineminus">-  },</span>
<a href="#l65.290"></a><span id="l65.290" class="difflineminus">-</span>
<a href="#l65.291"></a><span id="l65.291" class="difflineminus">-  hideNotification: function TP_NewNotfn_hideNotification() {</span>
<a href="#l65.292"></a><span id="l65.292" class="difflineminus">-    if (this._notifRef &amp;&amp; this._pn) {</span>
<a href="#l65.293"></a><span id="l65.293" class="difflineminus">-      this._pn.remove(this._notifRef);</span>
<a href="#l65.294"></a><span id="l65.294" class="difflineminus">-      this._notifRef = null;</span>
<a href="#l65.295"></a><span id="l65.295" class="difflineminus">-    }</span>
<a href="#l65.296"></a><span id="l65.296" class="difflineminus">-  }</span>
<a href="#l65.297"></a><span id="l65.297" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l66.1"></a><span id="l66.1">deleted file mode 100644</span>
<a href="#l66.2"></a><span id="l66.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/remote-experiment-loader.js</span>
<a href="#l66.3"></a><span id="l66.3" class="difflineplus">+++ /dev/null</span>
<a href="#l66.4"></a><span id="l66.4" class="difflineat">@@ -1,518 +0,0 @@</span>
<a href="#l66.5"></a><span id="l66.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l66.6"></a><span id="l66.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l66.7"></a><span id="l66.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l66.8"></a><span id="l66.8" class="difflineminus">-</span>
<a href="#l66.9"></a><span id="l66.9" class="difflineminus">-const BASE_URL_PREF = &quot;extensions.testpilot.indexBaseURL&quot;;</span>
<a href="#l66.10"></a><span id="l66.10" class="difflineminus">-var Cuddlefish = require(&quot;cuddlefish&quot;);</span>
<a href="#l66.11"></a><span id="l66.11" class="difflineminus">-var resolveUrl = require(&quot;url&quot;).resolve;</span>
<a href="#l66.12"></a><span id="l66.12" class="difflineminus">-var SecurableModule = require(&quot;securable-module&quot;);</span>
<a href="#l66.13"></a><span id="l66.13" class="difflineminus">-let JarStore = require(&quot;jar-code-store&quot;).JarStore;</span>
<a href="#l66.14"></a><span id="l66.14" class="difflineminus">-</span>
<a href="#l66.15"></a><span id="l66.15" class="difflineminus">-/* Security info should look like this:</span>
<a href="#l66.16"></a><span id="l66.16" class="difflineminus">- * Security Info:</span>
<a href="#l66.17"></a><span id="l66.17" class="difflineminus">-	Security state: secure</span>
<a href="#l66.18"></a><span id="l66.18" class="difflineminus">-	Security description: Authenticated by Equifax</span>
<a href="#l66.19"></a><span id="l66.19" class="difflineminus">-	Security error message: null</span>
<a href="#l66.20"></a><span id="l66.20" class="difflineminus">-</span>
<a href="#l66.21"></a><span id="l66.21" class="difflineminus">-Certificate Status:</span>
<a href="#l66.22"></a><span id="l66.22" class="difflineminus">-	Verification: OK</span>
<a href="#l66.23"></a><span id="l66.23" class="difflineminus">-	Common name (CN) = *.mozillalabs.com</span>
<a href="#l66.24"></a><span id="l66.24" class="difflineminus">-	Organisation = Mozilla Corporation</span>
<a href="#l66.25"></a><span id="l66.25" class="difflineminus">-	Issuer = Equifax</span>
<a href="#l66.26"></a><span id="l66.26" class="difflineminus">-	SHA1 fingerprint = E5:CD:91:97:08:E6:88:F2:A2:AE:31:3C:F9:91:8D:14:33:07:C4:EE</span>
<a href="#l66.27"></a><span id="l66.27" class="difflineminus">-	Valid from 8/12/09 14:04:39</span>
<a href="#l66.28"></a><span id="l66.28" class="difflineminus">-	Valid until 8/14/11 3:27:26</span>
<a href="#l66.29"></a><span id="l66.29" class="difflineminus">- */</span>
<a href="#l66.30"></a><span id="l66.30" class="difflineminus">-</span>
<a href="#l66.31"></a><span id="l66.31" class="difflineminus">-function verifyChannelSecurity(channel) {</span>
<a href="#l66.32"></a><span id="l66.32" class="difflineminus">-  // http://mdn.beonex.com/En/How_to_check_the_security_state_of_an_XMLHTTPRequest_over_SSL</span>
<a href="#l66.33"></a><span id="l66.33" class="difflineminus">-  // Expect channel to have security state = secure, CN = *.mozillalabs.com,</span>
<a href="#l66.34"></a><span id="l66.34" class="difflineminus">-  // Organization = &quot;Mozilla Corporation&quot;, verification = OK.</span>
<a href="#l66.35"></a><span id="l66.35" class="difflineminus">-  console.info(&quot;Verifying SSL channel security info before download...&quot;);</span>
<a href="#l66.36"></a><span id="l66.36" class="difflineminus">-</span>
<a href="#l66.37"></a><span id="l66.37" class="difflineminus">-  try {</span>
<a href="#l66.38"></a><span id="l66.38" class="difflineminus">-    if (! channel instanceof  Ci.nsIChannel) {</span>
<a href="#l66.39"></a><span id="l66.39" class="difflineminus">-      console.warn(&quot;Not a channel.  This should never happen.&quot;);</span>
<a href="#l66.40"></a><span id="l66.40" class="difflineminus">-      return false;</span>
<a href="#l66.41"></a><span id="l66.41" class="difflineminus">-    }</span>
<a href="#l66.42"></a><span id="l66.42" class="difflineminus">-    let secInfo = channel.securityInfo;</span>
<a href="#l66.43"></a><span id="l66.43" class="difflineminus">-</span>
<a href="#l66.44"></a><span id="l66.44" class="difflineminus">-    if (secInfo instanceof Ci.nsITransportSecurityInfo) {</span>
<a href="#l66.45"></a><span id="l66.45" class="difflineminus">-      secInfo.QueryInterface(Ci.nsITransportSecurityInfo);</span>
<a href="#l66.46"></a><span id="l66.46" class="difflineminus">-      let secState = secInfo.securityState &amp; Ci.nsIWebProgressListener.STATE_IS_SECURE;</span>
<a href="#l66.47"></a><span id="l66.47" class="difflineminus">-      if (secState != Ci.nsIWebProgressListener.STATE_IS_SECURE) {</span>
<a href="#l66.48"></a><span id="l66.48" class="difflineminus">-        console.warn(&quot;Failing security check: Security state is not secure.&quot;);</span>
<a href="#l66.49"></a><span id="l66.49" class="difflineminus">-        return false;</span>
<a href="#l66.50"></a><span id="l66.50" class="difflineminus">-      }</span>
<a href="#l66.51"></a><span id="l66.51" class="difflineminus">-    } else {</span>
<a href="#l66.52"></a><span id="l66.52" class="difflineminus">-      console.warn(&quot;Failing secuity check: No TransportSecurityInfo.&quot;);</span>
<a href="#l66.53"></a><span id="l66.53" class="difflineminus">-      return false;</span>
<a href="#l66.54"></a><span id="l66.54" class="difflineminus">-    }</span>
<a href="#l66.55"></a><span id="l66.55" class="difflineminus">-</span>
<a href="#l66.56"></a><span id="l66.56" class="difflineminus">-    // check SSL certificate details</span>
<a href="#l66.57"></a><span id="l66.57" class="difflineminus">-    if (secInfo instanceof Ci.nsISSLStatusProvider) {</span>
<a href="#l66.58"></a><span id="l66.58" class="difflineminus">-      let cert = secInfo.QueryInterface(Ci.nsISSLStatusProvider).</span>
<a href="#l66.59"></a><span id="l66.59" class="difflineminus">-	SSLStatus.QueryInterface(Ci.nsISSLStatus).serverCert;</span>
<a href="#l66.60"></a><span id="l66.60" class="difflineminus">-</span>
<a href="#l66.61"></a><span id="l66.61" class="difflineminus">-      let verificationResult = cert.verifyForUsage(</span>
<a href="#l66.62"></a><span id="l66.62" class="difflineminus">-        Ci.nsIX509Cert.CERT_USAGE_SSLServer);</span>
<a href="#l66.63"></a><span id="l66.63" class="difflineminus">-      if (verificationResult != Ci.nsIX509Cert.VERIFIED_OK) {</span>
<a href="#l66.64"></a><span id="l66.64" class="difflineminus">-        console.warn(&quot;Failing security check: Cert not verified OK.&quot;);</span>
<a href="#l66.65"></a><span id="l66.65" class="difflineminus">-        return false;</span>
<a href="#l66.66"></a><span id="l66.66" class="difflineminus">-      }</span>
<a href="#l66.67"></a><span id="l66.67" class="difflineminus">-      if (cert.commonName != &quot;*.mozillalabs.com&quot;) {</span>
<a href="#l66.68"></a><span id="l66.68" class="difflineminus">-        console.warn(&quot;Failing security check: Cert not for *.mozillalabs.com&quot;);</span>
<a href="#l66.69"></a><span id="l66.69" class="difflineminus">-        return false;</span>
<a href="#l66.70"></a><span id="l66.70" class="difflineminus">-      }</span>
<a href="#l66.71"></a><span id="l66.71" class="difflineminus">-      if (cert.organization != &quot;Mozilla Corporation&quot;) {</span>
<a href="#l66.72"></a><span id="l66.72" class="difflineminus">-        console.warn(&quot;Failing security check: Cert not for Mozilla corporation.&quot;);</span>
<a href="#l66.73"></a><span id="l66.73" class="difflineminus">-        return false;</span>
<a href="#l66.74"></a><span id="l66.74" class="difflineminus">-      }</span>
<a href="#l66.75"></a><span id="l66.75" class="difflineminus">-    } else {</span>
<a href="#l66.76"></a><span id="l66.76" class="difflineminus">-      console.warn(&quot;Failing security check: No SSL cert info.&quot;);</span>
<a href="#l66.77"></a><span id="l66.77" class="difflineminus">-      return false;</span>
<a href="#l66.78"></a><span id="l66.78" class="difflineminus">-    }</span>
<a href="#l66.79"></a><span id="l66.79" class="difflineminus">-</span>
<a href="#l66.80"></a><span id="l66.80" class="difflineminus">-    // Passed everything</span>
<a href="#l66.81"></a><span id="l66.81" class="difflineminus">-    console.info(&quot;Channel passed SSL security check.&quot;);</span>
<a href="#l66.82"></a><span id="l66.82" class="difflineminus">-    return true;</span>
<a href="#l66.83"></a><span id="l66.83" class="difflineminus">-  } catch(err) {</span>
<a href="#l66.84"></a><span id="l66.84" class="difflineminus">-    console.warn(&quot;Failing security check:  Error: &quot; + err);</span>
<a href="#l66.85"></a><span id="l66.85" class="difflineminus">-    return false;</span>
<a href="#l66.86"></a><span id="l66.86" class="difflineminus">-  }</span>
<a href="#l66.87"></a><span id="l66.87" class="difflineminus">-}</span>
<a href="#l66.88"></a><span id="l66.88" class="difflineminus">-</span>
<a href="#l66.89"></a><span id="l66.89" class="difflineminus">-function downloadFile(url, cb, lastModified) {</span>
<a href="#l66.90"></a><span id="l66.90" class="difflineminus">-  // lastModified is a timestamp (ms since epoch); if provided, then the file</span>
<a href="#l66.91"></a><span id="l66.91" class="difflineminus">-  // will not be downloaded unless it is newer than this.</span>
<a href="#l66.92"></a><span id="l66.92" class="difflineminus">-  var req = Cc[&quot;@mozilla.org/xmlextras/xmlhttprequest;1&quot;]</span>
<a href="#l66.93"></a><span id="l66.93" class="difflineminus">-              .createInstance( Ci.nsIXMLHttpRequest );</span>
<a href="#l66.94"></a><span id="l66.94" class="difflineminus">-  req.open('GET', url, true);</span>
<a href="#l66.95"></a><span id="l66.95" class="difflineminus">-  if (lastModified != undefined) {</span>
<a href="#l66.96"></a><span id="l66.96" class="difflineminus">-    let d = new Date();</span>
<a href="#l66.97"></a><span id="l66.97" class="difflineminus">-    d.setTime(lastModified);</span>
<a href="#l66.98"></a><span id="l66.98" class="difflineminus">-    // example header: If-Modified-Since: Sat, 29 Oct 1994 19:43:31 GMT</span>
<a href="#l66.99"></a><span id="l66.99" class="difflineminus">-    req.setRequestHeader(&quot;If-Modified-Since&quot;, d.toGMTString());</span>
<a href="#l66.100"></a><span id="l66.100" class="difflineminus">-    console.info(&quot;Setting if-modified-since header to &quot; + d.toGMTString());</span>
<a href="#l66.101"></a><span id="l66.101" class="difflineminus">-  }</span>
<a href="#l66.102"></a><span id="l66.102" class="difflineminus">-  //Use binary mode to download jars TODO find a better switch</span>
<a href="#l66.103"></a><span id="l66.103" class="difflineminus">-  if (url.indexOf(&quot;.jar&quot;) == url.length - 4 ||</span>
<a href="#l66.104"></a><span id="l66.104" class="difflineminus">-      url.indexOf(&quot;.json&quot;) == url.length - 5) {</span>
<a href="#l66.105"></a><span id="l66.105" class="difflineminus">-    console.info(&quot;Using binary mode to download jar file.&quot;);</span>
<a href="#l66.106"></a><span id="l66.106" class="difflineminus">-    req.overrideMimeType('text/plain; charset=x-user-defined');</span>
<a href="#l66.107"></a><span id="l66.107" class="difflineminus">-  }</span>
<a href="#l66.108"></a><span id="l66.108" class="difflineminus">-  req.onreadystatechange = function(aEvt) {</span>
<a href="#l66.109"></a><span id="l66.109" class="difflineminus">-    if (req.readyState == 4) {</span>
<a href="#l66.110"></a><span id="l66.110" class="difflineminus">-      if (req.status == 200) {</span>
<a href="#l66.111"></a><span id="l66.111" class="difflineminus">-        // check security channel:</span>
<a href="#l66.112"></a><span id="l66.112" class="difflineminus">-        if (verifyChannelSecurity(req.channel)) {</span>
<a href="#l66.113"></a><span id="l66.113" class="difflineminus">-          cb(req.responseText);</span>
<a href="#l66.114"></a><span id="l66.114" class="difflineminus">-        } else {</span>
<a href="#l66.115"></a><span id="l66.115" class="difflineminus">-          cb(null);</span>
<a href="#l66.116"></a><span id="l66.116" class="difflineminus">-        }</span>
<a href="#l66.117"></a><span id="l66.117" class="difflineminus">-      } else if (req.status == 304) {</span>
<a href="#l66.118"></a><span id="l66.118" class="difflineminus">-        // 304 is &quot;Not Modified&quot;, which we can get because we send an</span>
<a href="#l66.119"></a><span id="l66.119" class="difflineminus">-        // If-Modified-Since header.</span>
<a href="#l66.120"></a><span id="l66.120" class="difflineminus">-        console.info(&quot;File &quot; + url + &quot; not modified; using cached version.&quot;);</span>
<a href="#l66.121"></a><span id="l66.121" class="difflineminus">-        cb(null);</span>
<a href="#l66.122"></a><span id="l66.122" class="difflineminus">-        // calling back with null lets the RemoteExperimentLoader know it should</span>
<a href="#l66.123"></a><span id="l66.123" class="difflineminus">-        // keep using the old cached version of the code.</span>
<a href="#l66.124"></a><span id="l66.124" class="difflineminus">-      } else {</span>
<a href="#l66.125"></a><span id="l66.125" class="difflineminus">-        // Some kind of error.</span>
<a href="#l66.126"></a><span id="l66.126" class="difflineminus">-        console.warn(&quot;Got a &quot; + req.status + &quot; error code downloading &quot; + url);</span>
<a href="#l66.127"></a><span id="l66.127" class="difflineminus">-	cb(null);</span>
<a href="#l66.128"></a><span id="l66.128" class="difflineminus">-      }</span>
<a href="#l66.129"></a><span id="l66.129" class="difflineminus">-    }</span>
<a href="#l66.130"></a><span id="l66.130" class="difflineminus">-  };</span>
<a href="#l66.131"></a><span id="l66.131" class="difflineminus">-  req.send();</span>
<a href="#l66.132"></a><span id="l66.132" class="difflineminus">-}</span>
<a href="#l66.133"></a><span id="l66.133" class="difflineminus">-</span>
<a href="#l66.134"></a><span id="l66.134" class="difflineminus">-// example contents of extensions.testpilot.experiment.codeFs:</span>
<a href="#l66.135"></a><span id="l66.135" class="difflineminus">-// {'fs': {&quot;bookmark01/experiment&quot;: &quot;&lt;plain-text code @ bookmarks.js&gt;&quot;}}</span>
<a href="#l66.136"></a><span id="l66.136" class="difflineminus">-// sample code</span>
<a href="#l66.137"></a><span id="l66.137" class="difflineminus">-    // example data:</span>
<a href="#l66.138"></a><span id="l66.138" class="difflineminus">-    // {'experiments': [{'name': 'Bookmark Experiment',</span>
<a href="#l66.139"></a><span id="l66.139" class="difflineminus">-    //                           'filename': 'bookmarks.js'}]}</span>
<a href="#l66.140"></a><span id="l66.140" class="difflineminus">-</span>
<a href="#l66.141"></a><span id="l66.141" class="difflineminus">-exports.RemoteExperimentLoader = function(logRepo, fileGetterFunction ) {</span>
<a href="#l66.142"></a><span id="l66.142" class="difflineminus">-  /* fileGetterFunction is an optional stub function for unit testing.  Pass in</span>
<a href="#l66.143"></a><span id="l66.143" class="difflineminus">-   * nothing to have it use the default behavior of downloading the files from the</span>
<a href="#l66.144"></a><span id="l66.144" class="difflineminus">-   * Test Pilot server.  FileGetterFunction must take (url, callback).*/</span>
<a href="#l66.145"></a><span id="l66.145" class="difflineminus">-  this._init(logRepo, fileGetterFunction);</span>
<a href="#l66.146"></a><span id="l66.146" class="difflineminus">-};</span>
<a href="#l66.147"></a><span id="l66.147" class="difflineminus">-</span>
<a href="#l66.148"></a><span id="l66.148" class="difflineminus">-exports.RemoteExperimentLoader.prototype = {</span>
<a href="#l66.149"></a><span id="l66.149" class="difflineminus">-  _init: function(logRepo, fileGetterFunction) {</span>
<a href="#l66.150"></a><span id="l66.150" class="difflineminus">-    this._logger = logRepo.getLogger(&quot;TestPilot.Loader&quot;);</span>
<a href="#l66.151"></a><span id="l66.151" class="difflineminus">-    this._expLogger = logRepo.getLogger(&quot;TestPilot.RemoteCode&quot;);</span>
<a href="#l66.152"></a><span id="l66.152" class="difflineminus">-    let prefs = require(&quot;preferences-service&quot;);</span>
<a href="#l66.153"></a><span id="l66.153" class="difflineminus">-    this._baseUrl = prefs.get(BASE_URL_PREF, &quot;&quot;);</span>
<a href="#l66.154"></a><span id="l66.154" class="difflineminus">-    if (fileGetterFunction != undefined) {</span>
<a href="#l66.155"></a><span id="l66.155" class="difflineminus">-      this._fileGetter = fileGetterFunction;</span>
<a href="#l66.156"></a><span id="l66.156" class="difflineminus">-    } else {</span>
<a href="#l66.157"></a><span id="l66.157" class="difflineminus">-      this._fileGetter = downloadFile;</span>
<a href="#l66.158"></a><span id="l66.158" class="difflineminus">-    }</span>
<a href="#l66.159"></a><span id="l66.159" class="difflineminus">-    this._logger.trace(&quot;About to instantiate jar store.&quot;);</span>
<a href="#l66.160"></a><span id="l66.160" class="difflineminus">-    this._jarStore = new JarStore();</span>
<a href="#l66.161"></a><span id="l66.161" class="difflineminus">-    let self = this;</span>
<a href="#l66.162"></a><span id="l66.162" class="difflineminus">-    this._logger.trace(&quot;About to instantiate cuddlefish loader.&quot;);</span>
<a href="#l66.163"></a><span id="l66.163" class="difflineminus">-    this._refreshLoader();</span>
<a href="#l66.164"></a><span id="l66.164" class="difflineminus">-    // set up the unloading</span>
<a href="#l66.165"></a><span id="l66.165" class="difflineminus">-    require(&quot;unload&quot;).when( function() {</span>
<a href="#l66.166"></a><span id="l66.166" class="difflineminus">-                              self._loader.unload();</span>
<a href="#l66.167"></a><span id="l66.167" class="difflineminus">-                            });</span>
<a href="#l66.168"></a><span id="l66.168" class="difflineminus">-    this._logger.trace(&quot;Done instantiating remoteExperimentLoader.&quot;);</span>
<a href="#l66.169"></a><span id="l66.169" class="difflineminus">-  },</span>
<a href="#l66.170"></a><span id="l66.170" class="difflineminus">-</span>
<a href="#l66.171"></a><span id="l66.171" class="difflineminus">-  _refreshLoader: function() {</span>
<a href="#l66.172"></a><span id="l66.172" class="difflineminus">-    if (this._loader) {</span>
<a href="#l66.173"></a><span id="l66.173" class="difflineminus">-      this._loader.unload();</span>
<a href="#l66.174"></a><span id="l66.174" class="difflineminus">-    }</span>
<a href="#l66.175"></a><span id="l66.175" class="difflineminus">-    /* Pass in &quot;TestPilot.experiment&quot; logger as the console object for</span>
<a href="#l66.176"></a><span id="l66.176" class="difflineminus">-     * all remote modules loaded through cuddlefish, so they will log their</span>
<a href="#l66.177"></a><span id="l66.177" class="difflineminus">-     * stuff to the same file as all other modules.  This logger is not</span>
<a href="#l66.178"></a><span id="l66.178" class="difflineminus">-     * technically a console object but as long as it has .debug, .info,</span>
<a href="#l66.179"></a><span id="l66.179" class="difflineminus">-     * .warn, and .error methods, it will work fine.*/</span>
<a href="#l66.180"></a><span id="l66.180" class="difflineminus">-</span>
<a href="#l66.181"></a><span id="l66.181" class="difflineminus">-    /* Use a composite file system here, compositing codeStorage and a new</span>
<a href="#l66.182"></a><span id="l66.182" class="difflineminus">-     * local file system so that securable modules loaded remotely can</span>
<a href="#l66.183"></a><span id="l66.183" class="difflineminus">-     * themselves require modules in the cuddlefish lib. */</span>
<a href="#l66.184"></a><span id="l66.184" class="difflineminus">-    let self = this;</span>
<a href="#l66.185"></a><span id="l66.185" class="difflineminus">-    this._loader = Cuddlefish.Loader(</span>
<a href="#l66.186"></a><span id="l66.186" class="difflineminus">-      {fs: new SecurableModule.CompositeFileSystem(</span>
<a href="#l66.187"></a><span id="l66.187" class="difflineminus">-         [self._jarStore, Cuddlefish.parentLoader.fs]),</span>
<a href="#l66.188"></a><span id="l66.188" class="difflineminus">-       console: this._expLogger</span>
<a href="#l66.189"></a><span id="l66.189" class="difflineminus">-      });</span>
<a href="#l66.190"></a><span id="l66.190" class="difflineminus">-</span>
<a href="#l66.191"></a><span id="l66.191" class="difflineminus">-    // Clear all of our lists of studies/surveys/results when refreshing loader</span>
<a href="#l66.192"></a><span id="l66.192" class="difflineminus">-    this._studyResults = [];</span>
<a href="#l66.193"></a><span id="l66.193" class="difflineminus">-    this._legacyStudies = [];</span>
<a href="#l66.194"></a><span id="l66.194" class="difflineminus">-    this._experimentFileNames = [];</span>
<a href="#l66.195"></a><span id="l66.195" class="difflineminus">-    this._loadErrors = [];</span>
<a href="#l66.196"></a><span id="l66.196" class="difflineminus">-  },</span>
<a href="#l66.197"></a><span id="l66.197" class="difflineminus">-</span>
<a href="#l66.198"></a><span id="l66.198" class="difflineminus">-  getLocalizedStudyInfo: function(studiesIndex) {</span>
<a href="#l66.199"></a><span id="l66.199" class="difflineminus">-    let prefs = require(&quot;preferences-service&quot;);</span>
<a href="#l66.200"></a><span id="l66.200" class="difflineminus">-    let myLocale = prefs.get(&quot;general.useragent.locale&quot;, &quot;&quot;);</span>
<a href="#l66.201"></a><span id="l66.201" class="difflineminus">-    let studiesToLoad = [];</span>
<a href="#l66.202"></a><span id="l66.202" class="difflineminus">-    for each (let set in studiesIndex) {</span>
<a href="#l66.203"></a><span id="l66.203" class="difflineminus">-      // First try for specific locale, e.g. pt-BR for brazillian portugese</span>
<a href="#l66.204"></a><span id="l66.204" class="difflineminus">-      if (set[myLocale]) {</span>
<a href="#l66.205"></a><span id="l66.205" class="difflineminus">-        studiesToLoad.push(set[myLocale]);</span>
<a href="#l66.206"></a><span id="l66.206" class="difflineminus">-        continue;</span>
<a href="#l66.207"></a><span id="l66.207" class="difflineminus">-      }</span>
<a href="#l66.208"></a><span id="l66.208" class="difflineminus">-      // If that's not there, look for the language, e.g. just &quot;pt&quot;:</span>
<a href="#l66.209"></a><span id="l66.209" class="difflineminus">-      let hyphen = myLocale.indexOf(&quot;-&quot;);</span>
<a href="#l66.210"></a><span id="l66.210" class="difflineminus">-      if (hyphen &gt; -1) {</span>
<a href="#l66.211"></a><span id="l66.211" class="difflineminus">-        let lang = myLocale.slice(0, hyphen);</span>
<a href="#l66.212"></a><span id="l66.212" class="difflineminus">-        if (set[lang]) {</span>
<a href="#l66.213"></a><span id="l66.213" class="difflineminus">-          studiesToLoad.push(set[lang]);</span>
<a href="#l66.214"></a><span id="l66.214" class="difflineminus">-          continue;</span>
<a href="#l66.215"></a><span id="l66.215" class="difflineminus">-        }</span>
<a href="#l66.216"></a><span id="l66.216" class="difflineminus">-      }</span>
<a href="#l66.217"></a><span id="l66.217" class="difflineminus">-      // If that's not there either, look for one called &quot;default&quot;:</span>
<a href="#l66.218"></a><span id="l66.218" class="difflineminus">-      if(set[&quot;default&quot;]) {</span>
<a href="#l66.219"></a><span id="l66.219" class="difflineminus">-        studiesToLoad.push(set[&quot;default&quot;]);</span>
<a href="#l66.220"></a><span id="l66.220" class="difflineminus">-      }</span>
<a href="#l66.221"></a><span id="l66.221" class="difflineminus">-      // If none of those are there, load nothing.</span>
<a href="#l66.222"></a><span id="l66.222" class="difflineminus">-    }</span>
<a href="#l66.223"></a><span id="l66.223" class="difflineminus">-    return studiesToLoad;</span>
<a href="#l66.224"></a><span id="l66.224" class="difflineminus">-  },</span>
<a href="#l66.225"></a><span id="l66.225" class="difflineminus">-</span>
<a href="#l66.226"></a><span id="l66.226" class="difflineminus">-  _executeFreshIndexFile: function(data, callback) {</span>
<a href="#l66.227"></a><span id="l66.227" class="difflineminus">-    try {</span>
<a href="#l66.228"></a><span id="l66.228" class="difflineminus">-      data = JSON.parse(data);</span>
<a href="#l66.229"></a><span id="l66.229" class="difflineminus">-    } catch (e) {</span>
<a href="#l66.230"></a><span id="l66.230" class="difflineminus">-      this._logger.warn(&quot;Error parsing index.json: &quot; + e );</span>
<a href="#l66.231"></a><span id="l66.231" class="difflineminus">-      callback(false);</span>
<a href="#l66.232"></a><span id="l66.232" class="difflineminus">-      return;</span>
<a href="#l66.233"></a><span id="l66.233" class="difflineminus">-    }</span>
<a href="#l66.234"></a><span id="l66.234" class="difflineminus">-</span>
<a href="#l66.235"></a><span id="l66.235" class="difflineminus">-    // Cache study results and legacy studies.</span>
<a href="#l66.236"></a><span id="l66.236" class="difflineminus">-    this._studyResults = data.results;</span>
<a href="#l66.237"></a><span id="l66.237" class="difflineminus">-    this._legacyStudies = data.legacy;</span>
<a href="#l66.238"></a><span id="l66.238" class="difflineminus">-</span>
<a href="#l66.239"></a><span id="l66.239" class="difflineminus">-</span>
<a href="#l66.240"></a><span id="l66.240" class="difflineminus">-    /* Look in the &quot;maintain_experiments&quot; section of the index file.  Experiments</span>
<a href="#l66.241"></a><span id="l66.241" class="difflineminus">-     * listed here should be run IF we alrady have the code present on disk, but should</span>
<a href="#l66.242"></a><span id="l66.242" class="difflineminus">-     * not be downloaded if we don't already have them.</span>
<a href="#l66.243"></a><span id="l66.243" class="difflineminus">-     */</span>
<a href="#l66.244"></a><span id="l66.244" class="difflineminus">-    if (data.maintain_experiments) {</span>
<a href="#l66.245"></a><span id="l66.245" class="difflineminus">-      this._logger.trace(data.maintain_experiments.length + &quot; files to maintain.\n&quot;);</span>
<a href="#l66.246"></a><span id="l66.246" class="difflineminus">-      for each (let studyFile in data.maintain_experiments) {</span>
<a href="#l66.247"></a><span id="l66.247" class="difflineminus">-        this._experimentFileNames.push(studyFile);</span>
<a href="#l66.248"></a><span id="l66.248" class="difflineminus">-      }</span>
<a href="#l66.249"></a><span id="l66.249" class="difflineminus">-    }</span>
<a href="#l66.250"></a><span id="l66.250" class="difflineminus">-</span>
<a href="#l66.251"></a><span id="l66.251" class="difflineminus">-    /* Look in the &quot;new_experiments&quot; section of the index file for new jar files</span>
<a href="#l66.252"></a><span id="l66.252" class="difflineminus">-     * to download. Go through each record indicated in index.json, look up the</span>
<a href="#l66.253"></a><span id="l66.253" class="difflineminus">-     * .jar file specified for our locale, and download it (replacing any version</span>
<a href="#l66.254"></a><span id="l66.254" class="difflineminus">-     * on disk)</span>
<a href="#l66.255"></a><span id="l66.255" class="difflineminus">-     */</span>
<a href="#l66.256"></a><span id="l66.256" class="difflineminus">-    let jarFiles = this.getLocalizedStudyInfo(data.new_experiments);</span>
<a href="#l66.257"></a><span id="l66.257" class="difflineminus">-    let numFilesToDload = jarFiles.length;</span>
<a href="#l66.258"></a><span id="l66.258" class="difflineminus">-    this._logger.trace(numFilesToDload + &quot; files to download.\n&quot;);</span>
<a href="#l66.259"></a><span id="l66.259" class="difflineminus">-    let self = this;</span>
<a href="#l66.260"></a><span id="l66.260" class="difflineminus">-</span>
<a href="#l66.261"></a><span id="l66.261" class="difflineminus">-    if (numFilesToDload == 0) {</span>
<a href="#l66.262"></a><span id="l66.262" class="difflineminus">-      this._logger.trace(&quot;Num files to download is 0, bailing\n&quot;);</span>
<a href="#l66.263"></a><span id="l66.263" class="difflineminus">-      // nothing has changed --&gt; callback false</span>
<a href="#l66.264"></a><span id="l66.264" class="difflineminus">-      callback(false);</span>
<a href="#l66.265"></a><span id="l66.265" class="difflineminus">-      return;</span>
<a href="#l66.266"></a><span id="l66.266" class="difflineminus">-    }</span>
<a href="#l66.267"></a><span id="l66.267" class="difflineminus">-</span>
<a href="#l66.268"></a><span id="l66.268" class="difflineminus">-    for each (let j in jarFiles) {</span>
<a href="#l66.269"></a><span id="l66.269" class="difflineminus">-      let filename = j.jarfile;</span>
<a href="#l66.270"></a><span id="l66.270" class="difflineminus">-      let hash = j.hash;</span>
<a href="#l66.271"></a><span id="l66.271" class="difflineminus">-      if (j.studyfile) {</span>
<a href="#l66.272"></a><span id="l66.272" class="difflineminus">-        this._experimentFileNames.push(j.studyfile);</span>
<a href="#l66.273"></a><span id="l66.273" class="difflineminus">-      }</span>
<a href="#l66.274"></a><span id="l66.274" class="difflineminus">-      this._logger.trace(&quot;I'm gonna go try to get the code for &quot; + filename);</span>
<a href="#l66.275"></a><span id="l66.275" class="difflineminus">-      let modDate = this._jarStore.getFileModifiedDate(filename);</span>
<a href="#l66.276"></a><span id="l66.276" class="difflineminus">-</span>
<a href="#l66.277"></a><span id="l66.277" class="difflineminus">-      this._fileGetter(resolveUrl(this._baseUrl, filename),</span>
<a href="#l66.278"></a><span id="l66.278" class="difflineminus">-      function onDone(code) {</span>
<a href="#l66.279"></a><span id="l66.279" class="difflineminus">-        // code will be non-null if there is actually new code to download.</span>
<a href="#l66.280"></a><span id="l66.280" class="difflineminus">-        if (code) {</span>
<a href="#l66.281"></a><span id="l66.281" class="difflineminus">-          self._logger.info(&quot;Downloaded jar file &quot; + filename);</span>
<a href="#l66.282"></a><span id="l66.282" class="difflineminus">-          self._jarStore.saveJarFile(filename, code, hash);</span>
<a href="#l66.283"></a><span id="l66.283" class="difflineminus">-          self._logger.trace(&quot;Saved code for: &quot; + filename);</span>
<a href="#l66.284"></a><span id="l66.284" class="difflineminus">-        } else {</span>
<a href="#l66.285"></a><span id="l66.285" class="difflineminus">-          self._logger.info(&quot;Nothing to download for &quot; + filename);</span>
<a href="#l66.286"></a><span id="l66.286" class="difflineminus">-        }</span>
<a href="#l66.287"></a><span id="l66.287" class="difflineminus">-        numFilesToDload--;</span>
<a href="#l66.288"></a><span id="l66.288" class="difflineminus">-        if (numFilesToDload == 0) {</span>
<a href="#l66.289"></a><span id="l66.289" class="difflineminus">-          self._logger.trace(&quot;Calling callback.&quot;);</span>
<a href="#l66.290"></a><span id="l66.290" class="difflineminus">-          callback(true);</span>
<a href="#l66.291"></a><span id="l66.291" class="difflineminus">-        }</span>
<a href="#l66.292"></a><span id="l66.292" class="difflineminus">-      }, modDate);</span>
<a href="#l66.293"></a><span id="l66.293" class="difflineminus">-    }</span>
<a href="#l66.294"></a><span id="l66.294" class="difflineminus">-  },</span>
<a href="#l66.295"></a><span id="l66.295" class="difflineminus">-</span>
<a href="#l66.296"></a><span id="l66.296" class="difflineminus">-  _executeCachedIndexFile: function(data) {</span>
<a href="#l66.297"></a><span id="l66.297" class="difflineminus">-    /* Working with a cached index file = follow its instructions except</span>
<a href="#l66.298"></a><span id="l66.298" class="difflineminus">-     * don't try to download anything - just work with the jar files already</span>
<a href="#l66.299"></a><span id="l66.299" class="difflineminus">-     * on disk. There's a lot of shared code between this and _executeFreshIndexFile;</span>
<a href="#l66.300"></a><span id="l66.300" class="difflineminus">-     * refactor?*/</span>
<a href="#l66.301"></a><span id="l66.301" class="difflineminus">-    try {</span>
<a href="#l66.302"></a><span id="l66.302" class="difflineminus">-      data = JSON.parse(data);</span>
<a href="#l66.303"></a><span id="l66.303" class="difflineminus">-    } catch (e) {</span>
<a href="#l66.304"></a><span id="l66.304" class="difflineminus">-      this._logger.warn(&quot;Error parsing index.json: &quot; + e );</span>
<a href="#l66.305"></a><span id="l66.305" class="difflineminus">-      return false;</span>
<a href="#l66.306"></a><span id="l66.306" class="difflineminus">-    }</span>
<a href="#l66.307"></a><span id="l66.307" class="difflineminus">-    // Read study results and legacy studies from index.</span>
<a href="#l66.308"></a><span id="l66.308" class="difflineminus">-    this._studyResults = data.results;</span>
<a href="#l66.309"></a><span id="l66.309" class="difflineminus">-    this._legacyStudies = data.legacy;</span>
<a href="#l66.310"></a><span id="l66.310" class="difflineminus">-</span>
<a href="#l66.311"></a><span id="l66.311" class="difflineminus">-    // Studies to be maintained:</span>
<a href="#l66.312"></a><span id="l66.312" class="difflineminus">-    if (data.maintain_experiments) {</span>
<a href="#l66.313"></a><span id="l66.313" class="difflineminus">-      for each (let studyFile in data.maintain_experiments) {</span>
<a href="#l66.314"></a><span id="l66.314" class="difflineminus">-        this._experimentFileNames.push(studyFile);</span>
<a href="#l66.315"></a><span id="l66.315" class="difflineminus">-      }</span>
<a href="#l66.316"></a><span id="l66.316" class="difflineminus">-    }</span>
<a href="#l66.317"></a><span id="l66.317" class="difflineminus">-</span>
<a href="#l66.318"></a><span id="l66.318" class="difflineminus">-    // Read names of experiment modules from index.</span>
<a href="#l66.319"></a><span id="l66.319" class="difflineminus">-    let jarFiles = this.getLocalizedStudyInfo(data.new_experiments);</span>
<a href="#l66.320"></a><span id="l66.320" class="difflineminus">-    for each (let j in jarFiles) {</span>
<a href="#l66.321"></a><span id="l66.321" class="difflineminus">-      let filename = j.jarfile;</span>
<a href="#l66.322"></a><span id="l66.322" class="difflineminus">-      let hash = j.hash;</span>
<a href="#l66.323"></a><span id="l66.323" class="difflineminus">-      if (j.studyfile) {</span>
<a href="#l66.324"></a><span id="l66.324" class="difflineminus">-        this._experimentFileNames.push(j.studyfile);</span>
<a href="#l66.325"></a><span id="l66.325" class="difflineminus">-      }</span>
<a href="#l66.326"></a><span id="l66.326" class="difflineminus">-    }</span>
<a href="#l66.327"></a><span id="l66.327" class="difflineminus">-    return true;</span>
<a href="#l66.328"></a><span id="l66.328" class="difflineminus">-  },</span>
<a href="#l66.329"></a><span id="l66.329" class="difflineminus">-</span>
<a href="#l66.330"></a><span id="l66.330" class="difflineminus">-  // TODO a bad thing that can go wrong: If we have a net connection but the index file</span>
<a href="#l66.331"></a><span id="l66.331" class="difflineminus">-  // has not changed, we currently don't try to download anything...</span>
<a href="#l66.332"></a><span id="l66.332" class="difflineminus">-  // The logic is bad because executeCachedIndexFile is called in two different</span>
<a href="#l66.333"></a><span id="l66.333" class="difflineminus">-  // cases: the one with no network, and the one with network but unchanged file.</span>
<a href="#l66.334"></a><span id="l66.334" class="difflineminus">-</span>
<a href="#l66.335"></a><span id="l66.335" class="difflineminus">-  // Another bad thing: If there's a jar download that's corrupt or unreadable or has</span>
<a href="#l66.336"></a><span id="l66.336" class="difflineminus">-  // the wrong permissions or something, we need to kill it and download a new one.</span>
<a href="#l66.337"></a><span id="l66.337" class="difflineminus">-  // Should also try to download a new jar if any required modules are missing</span>
<a href="#l66.338"></a><span id="l66.338" class="difflineminus">-  // (Which is currently the case!)</span>
<a href="#l66.339"></a><span id="l66.339" class="difflineminus">-</span>
<a href="#l66.340"></a><span id="l66.340" class="difflineminus">-  // (module &quot;about_firefox.js&quot; is not found; there is no about_firefox.jar on disk,</span>
<a href="#l66.341"></a><span id="l66.341" class="difflineminus">-  // indicating it didn't download, and we're not trying again because index-dev is</span>
<a href="#l66.342"></a><span id="l66.342" class="difflineminus">-  // unmodified.  Hmmm.)</span>
<a href="#l66.343"></a><span id="l66.343" class="difflineminus">-</span>
<a href="#l66.344"></a><span id="l66.344" class="difflineminus">-  _cachedIndexNsiFile: null,</span>
<a href="#l66.345"></a><span id="l66.345" class="difflineminus">-  get cachedIndexNsiFile() {</span>
<a href="#l66.346"></a><span id="l66.346" class="difflineminus">-    if (!this._cachedIndexNsiFile) {</span>
<a href="#l66.347"></a><span id="l66.347" class="difflineminus">-      try {</span>
<a href="#l66.348"></a><span id="l66.348" class="difflineminus">-        let file = Cc[&quot;@mozilla.org/file/directory_service;1&quot;].</span>
<a href="#l66.349"></a><span id="l66.349" class="difflineminus">-                         getService(Ci.nsIProperties).</span>
<a href="#l66.350"></a><span id="l66.350" class="difflineminus">-                         get(&quot;ProfD&quot;, Ci.nsIFile);</span>
<a href="#l66.351"></a><span id="l66.351" class="difflineminus">-        file.append(&quot;TestPilotExperimentFiles&quot;); // TODO this name should go in pref?</span>
<a href="#l66.352"></a><span id="l66.352" class="difflineminus">-        // Make sure there's a directory with this name; delete any non-directory</span>
<a href="#l66.353"></a><span id="l66.353" class="difflineminus">-        // file that's in the way.</span>
<a href="#l66.354"></a><span id="l66.354" class="difflineminus">-        if (file.exists() &amp;&amp; !file.isDirectory()) {</span>
<a href="#l66.355"></a><span id="l66.355" class="difflineminus">-          file.remove(false);</span>
<a href="#l66.356"></a><span id="l66.356" class="difflineminus">-        }</span>
<a href="#l66.357"></a><span id="l66.357" class="difflineminus">-        if (!file.exists()) {</span>
<a href="#l66.358"></a><span id="l66.358" class="difflineminus">-          file.create(Ci.nsIFile.DIRECTORY_TYPE, 0777);</span>
<a href="#l66.359"></a><span id="l66.359" class="difflineminus">-        }</span>
<a href="#l66.360"></a><span id="l66.360" class="difflineminus">-        file.append(&quot;index.json&quot;);</span>
<a href="#l66.361"></a><span id="l66.361" class="difflineminus">-        this._cachedIndexNsiFile = file;</span>
<a href="#l66.362"></a><span id="l66.362" class="difflineminus">-      } catch(e) {</span>
<a href="#l66.363"></a><span id="l66.363" class="difflineminus">-        console.warn(&quot;Error creating directory for cached index file: &quot; + e);</span>
<a href="#l66.364"></a><span id="l66.364" class="difflineminus">-      }</span>
<a href="#l66.365"></a><span id="l66.365" class="difflineminus">-    }</span>
<a href="#l66.366"></a><span id="l66.366" class="difflineminus">-    return this._cachedIndexNsiFile;</span>
<a href="#l66.367"></a><span id="l66.367" class="difflineminus">-  },</span>
<a href="#l66.368"></a><span id="l66.368" class="difflineminus">-</span>
<a href="#l66.369"></a><span id="l66.369" class="difflineminus">-  _cacheIndexFile: function(data) {</span>
<a href="#l66.370"></a><span id="l66.370" class="difflineminus">-    // write data to disk as basedir/index.json</span>
<a href="#l66.371"></a><span id="l66.371" class="difflineminus">-    try {</span>
<a href="#l66.372"></a><span id="l66.372" class="difflineminus">-      let file = this.cachedIndexNsiFile;</span>
<a href="#l66.373"></a><span id="l66.373" class="difflineminus">-      if (file == null) {</span>
<a href="#l66.374"></a><span id="l66.374" class="difflineminus">-        console.warn(&quot;Can't cache index file because directory does not exist.&quot;);</span>
<a href="#l66.375"></a><span id="l66.375" class="difflineminus">-        return;</span>
<a href="#l66.376"></a><span id="l66.376" class="difflineminus">-      }</span>
<a href="#l66.377"></a><span id="l66.377" class="difflineminus">-      if (file.exists()) {</span>
<a href="#l66.378"></a><span id="l66.378" class="difflineminus">-        file.remove(false);</span>
<a href="#l66.379"></a><span id="l66.379" class="difflineminus">-      }</span>
<a href="#l66.380"></a><span id="l66.380" class="difflineminus">-      file.create(Ci.nsIFile.NORMAL_FILE_TYPE, 0666);</span>
<a href="#l66.381"></a><span id="l66.381" class="difflineminus">-      // file is nsIFile, data is a string</span>
<a href="#l66.382"></a><span id="l66.382" class="difflineminus">-      let foStream = Cc[&quot;@mozilla.org/network/file-output-stream;1&quot;].</span>
<a href="#l66.383"></a><span id="l66.383" class="difflineminus">-                               createInstance(Ci.nsIFileOutputStream);</span>
<a href="#l66.384"></a><span id="l66.384" class="difflineminus">-</span>
<a href="#l66.385"></a><span id="l66.385" class="difflineminus">-      foStream.init(file, 0x02 | 0x08 | 0x20, 0666, 0);</span>
<a href="#l66.386"></a><span id="l66.386" class="difflineminus">-      // write, create, truncate</span>
<a href="#l66.387"></a><span id="l66.387" class="difflineminus">-      let converter = Cc[&quot;@mozilla.org/intl/converter-output-stream;1&quot;].</span>
<a href="#l66.388"></a><span id="l66.388" class="difflineminus">-                                createInstance(Ci.nsIConverterOutputStream);</span>
<a href="#l66.389"></a><span id="l66.389" class="difflineminus">-      converter.init(foStream, &quot;UTF-8&quot;, 0, 0);</span>
<a href="#l66.390"></a><span id="l66.390" class="difflineminus">-      converter.writeString(data);</span>
<a href="#l66.391"></a><span id="l66.391" class="difflineminus">-      converter.close(); // this closes foStream too</span>
<a href="#l66.392"></a><span id="l66.392" class="difflineminus">-    } catch(e) {</span>
<a href="#l66.393"></a><span id="l66.393" class="difflineminus">-      console.warn(&quot;Error cacheing index file: &quot; + e);</span>
<a href="#l66.394"></a><span id="l66.394" class="difflineminus">-    }</span>
<a href="#l66.395"></a><span id="l66.395" class="difflineminus">-  },</span>
<a href="#l66.396"></a><span id="l66.396" class="difflineminus">-</span>
<a href="#l66.397"></a><span id="l66.397" class="difflineminus">-  // https://developer.mozilla.org/en/Table_Of_Errors</span>
<a href="#l66.398"></a><span id="l66.398" class="difflineminus">-  _loadCachedIndexFile: function() {</span>
<a href="#l66.399"></a><span id="l66.399" class="difflineminus">-    // If basedir/index.json exists, read it and return its data</span>
<a href="#l66.400"></a><span id="l66.400" class="difflineminus">-    // Otherwise, return false</span>
<a href="#l66.401"></a><span id="l66.401" class="difflineminus">-    let file = this.cachedIndexNsiFile;</span>
<a href="#l66.402"></a><span id="l66.402" class="difflineminus">-    if (file == null) {</span>
<a href="#l66.403"></a><span id="l66.403" class="difflineminus">-      console.warn(&quot;Can't load cached index file because directory does not exist.&quot;);</span>
<a href="#l66.404"></a><span id="l66.404" class="difflineminus">-      return false;</span>
<a href="#l66.405"></a><span id="l66.405" class="difflineminus">-    }</span>
<a href="#l66.406"></a><span id="l66.406" class="difflineminus">-    if (file.exists()) {</span>
<a href="#l66.407"></a><span id="l66.407" class="difflineminus">-      try {</span>
<a href="#l66.408"></a><span id="l66.408" class="difflineminus">-        let data = &quot;&quot;;</span>
<a href="#l66.409"></a><span id="l66.409" class="difflineminus">-        let fstream = Cc[&quot;@mozilla.org/network/file-input-stream;1&quot;].</span>
<a href="#l66.410"></a><span id="l66.410" class="difflineminus">-                          createInstance(Ci.nsIFileInputStream);</span>
<a href="#l66.411"></a><span id="l66.411" class="difflineminus">-        let cstream = Cc[&quot;@mozilla.org/intl/converter-input-stream;1&quot;].</span>
<a href="#l66.412"></a><span id="l66.412" class="difflineminus">-                          createInstance(Ci.nsIConverterInputStream);</span>
<a href="#l66.413"></a><span id="l66.413" class="difflineminus">-        fstream.init(file, -1, 0, 0);</span>
<a href="#l66.414"></a><span id="l66.414" class="difflineminus">-        cstream.init(fstream, &quot;UTF-8&quot;, 0, 0);</span>
<a href="#l66.415"></a><span id="l66.415" class="difflineminus">-        let str = {};</span>
<a href="#l66.416"></a><span id="l66.416" class="difflineminus">-        while (cstream.readString(4096, str) != 0) {</span>
<a href="#l66.417"></a><span id="l66.417" class="difflineminus">-          data += str.value;</span>
<a href="#l66.418"></a><span id="l66.418" class="difflineminus">-        }</span>
<a href="#l66.419"></a><span id="l66.419" class="difflineminus">-        cstream.close(); // this closes fstream too</span>
<a href="#l66.420"></a><span id="l66.420" class="difflineminus">-        return data;</span>
<a href="#l66.421"></a><span id="l66.421" class="difflineminus">-      } catch(e) {</span>
<a href="#l66.422"></a><span id="l66.422" class="difflineminus">-        console.warn(&quot;Error occured in reading cached index file: &quot; + e);</span>
<a href="#l66.423"></a><span id="l66.423" class="difflineminus">-        return false;</span>
<a href="#l66.424"></a><span id="l66.424" class="difflineminus">-      }</span>
<a href="#l66.425"></a><span id="l66.425" class="difflineminus">-    } else {</span>
<a href="#l66.426"></a><span id="l66.426" class="difflineminus">-      console.warn(&quot;Trying to load cached index file but it does not exist.&quot;);</span>
<a href="#l66.427"></a><span id="l66.427" class="difflineminus">-      return false;</span>
<a href="#l66.428"></a><span id="l66.428" class="difflineminus">-    }</span>
<a href="#l66.429"></a><span id="l66.429" class="difflineminus">-  },</span>
<a href="#l66.430"></a><span id="l66.430" class="difflineminus">-</span>
<a href="#l66.431"></a><span id="l66.431" class="difflineminus">-  checkForUpdates: function(callback) {</span>
<a href="#l66.432"></a><span id="l66.432" class="difflineminus">-    // Check for surveys and studies.  Entry point for all download and execution of</span>
<a href="#l66.433"></a><span id="l66.433" class="difflineminus">-    // remote code.</span>
<a href="#l66.434"></a><span id="l66.434" class="difflineminus">-    /* Callback will be called with true or false</span>
<a href="#l66.435"></a><span id="l66.435" class="difflineminus">-     * to let us know whether there are any updates, so that client code can</span>
<a href="#l66.436"></a><span id="l66.436" class="difflineminus">-     * restart any experiment whose code has changed. */</span>
<a href="#l66.437"></a><span id="l66.437" class="difflineminus">-    let prefs = require(&quot;preferences-service&quot;);</span>
<a href="#l66.438"></a><span id="l66.438" class="difflineminus">-    let indexFileName = prefs.get(&quot;extensions.testpilot.indexFileName&quot;,</span>
<a href="#l66.439"></a><span id="l66.439" class="difflineminus">-                                  &quot;index.json&quot;);</span>
<a href="#l66.440"></a><span id="l66.440" class="difflineminus">-    let self = this;</span>
<a href="#l66.441"></a><span id="l66.441" class="difflineminus">-    // Unload everything before checking for updates, to be sure we</span>
<a href="#l66.442"></a><span id="l66.442" class="difflineminus">-    // get the newest stuff.</span>
<a href="#l66.443"></a><span id="l66.443" class="difflineminus">-    this._logger.info(&quot;Unloading everything to prepare to check for updates.&quot;);</span>
<a href="#l66.444"></a><span id="l66.444" class="difflineminus">-    this._refreshLoader();</span>
<a href="#l66.445"></a><span id="l66.445" class="difflineminus">-</span>
<a href="#l66.446"></a><span id="l66.446" class="difflineminus">-    let modDate = 0;</span>
<a href="#l66.447"></a><span id="l66.447" class="difflineminus">-    if (this.cachedIndexNsiFile) {</span>
<a href="#l66.448"></a><span id="l66.448" class="difflineminus">-      if (this.cachedIndexNsiFile.exists()) {</span>
<a href="#l66.449"></a><span id="l66.449" class="difflineminus">-        modDate = this.cachedIndexNsiFile.lastModifiedTime;</span>
<a href="#l66.450"></a><span id="l66.450" class="difflineminus">-      }</span>
<a href="#l66.451"></a><span id="l66.451" class="difflineminus">-    }</span>
<a href="#l66.452"></a><span id="l66.452" class="difflineminus">-    let url = resolveUrl(self._baseUrl, indexFileName);</span>
<a href="#l66.453"></a><span id="l66.453" class="difflineminus">-    self._fileGetter(url, function onDone(data) {</span>
<a href="#l66.454"></a><span id="l66.454" class="difflineminus">-      if (data) {</span>
<a href="#l66.455"></a><span id="l66.455" class="difflineminus">-        self._logger.trace(&quot;Index file updated on server.\n&quot;);</span>
<a href="#l66.456"></a><span id="l66.456" class="difflineminus">-        self._executeFreshIndexFile(data, callback);</span>
<a href="#l66.457"></a><span id="l66.457" class="difflineminus">-        // cache index file contents so we can read them later if we can't get online.</span>
<a href="#l66.458"></a><span id="l66.458" class="difflineminus">-        self._cacheIndexFile(data);</span>
<a href="#l66.459"></a><span id="l66.459" class="difflineminus">-        // executeFreshIndexFile will call the callback.</span>
<a href="#l66.460"></a><span id="l66.460" class="difflineminus">-      } else {</span>
<a href="#l66.461"></a><span id="l66.461" class="difflineminus">-        self._logger.info(&quot;Could not download index.json, using cached version.&quot;);</span>
<a href="#l66.462"></a><span id="l66.462" class="difflineminus">-        let data = self._loadCachedIndexFile();</span>
<a href="#l66.463"></a><span id="l66.463" class="difflineminus">-        if (data) {</span>
<a href="#l66.464"></a><span id="l66.464" class="difflineminus">-          let success = self._executeCachedIndexFile(data);</span>
<a href="#l66.465"></a><span id="l66.465" class="difflineminus">-          callback(success);</span>
<a href="#l66.466"></a><span id="l66.466" class="difflineminus">-        } else {</span>
<a href="#l66.467"></a><span id="l66.467" class="difflineminus">-          self._logger.warn(&quot;Could not download index.json and no cached version.&quot;);</span>
<a href="#l66.468"></a><span id="l66.468" class="difflineminus">-          // TODO Should display an error message to the user in this case.</span>
<a href="#l66.469"></a><span id="l66.469" class="difflineminus">-          callback(false);</span>
<a href="#l66.470"></a><span id="l66.470" class="difflineminus">-        }</span>
<a href="#l66.471"></a><span id="l66.471" class="difflineminus">-      }</span>
<a href="#l66.472"></a><span id="l66.472" class="difflineminus">-    }, modDate);</span>
<a href="#l66.473"></a><span id="l66.473" class="difflineminus">-  },</span>
<a href="#l66.474"></a><span id="l66.474" class="difflineminus">-</span>
<a href="#l66.475"></a><span id="l66.475" class="difflineminus">-  getExperiments: function() {</span>
<a href="#l66.476"></a><span id="l66.476" class="difflineminus">-    /* Load up and return all studies/surveys (not libraries)</span>
<a href="#l66.477"></a><span id="l66.477" class="difflineminus">-     * already stored in codeStorage.  Returns a dict with key =</span>
<a href="#l66.478"></a><span id="l66.478" class="difflineminus">-     * the module name and value = the module object. */</span>
<a href="#l66.479"></a><span id="l66.479" class="difflineminus">-    this._logger.trace(&quot;GetExperiments called.&quot;);</span>
<a href="#l66.480"></a><span id="l66.480" class="difflineminus">-    let remoteExperiments = {};</span>
<a href="#l66.481"></a><span id="l66.481" class="difflineminus">-    this._loadErrors = [];</span>
<a href="#l66.482"></a><span id="l66.482" class="difflineminus">-    for each (filename in this._experimentFileNames) {</span>
<a href="#l66.483"></a><span id="l66.483" class="difflineminus">-      this._logger.debug(&quot;GetExperiments is loading &quot; + filename);</span>
<a href="#l66.484"></a><span id="l66.484" class="difflineminus">-      try {</span>
<a href="#l66.485"></a><span id="l66.485" class="difflineminus">-        remoteExperiments[filename] = this._loader.require(filename);</span>
<a href="#l66.486"></a><span id="l66.486" class="difflineminus">-        this._logger.info(&quot;Loaded &quot; + filename + &quot; OK.&quot;);</span>
<a href="#l66.487"></a><span id="l66.487" class="difflineminus">-      } catch(e) {</span>
<a href="#l66.488"></a><span id="l66.488" class="difflineminus">-        /* Turn the load-time errors into strings and store them, so we can display</span>
<a href="#l66.489"></a><span id="l66.489" class="difflineminus">-         * them on a debug page or include them with a data upload!  (Don't store</span>
<a href="#l66.490"></a><span id="l66.490" class="difflineminus">-         * exception objects directly as that causes garbage collector problems-</span>
<a href="#l66.491"></a><span id="l66.491" class="difflineminus">-         * aka bug 646122) */</span>
<a href="#l66.492"></a><span id="l66.492" class="difflineminus">-        let errStr = e.name + &quot; on line &quot; + e.lineNumber + &quot; of file &quot; +</span>
<a href="#l66.493"></a><span id="l66.493" class="difflineminus">-          e.fileName + &quot;: &quot; + e.message;</span>
<a href="#l66.494"></a><span id="l66.494" class="difflineminus">-        this._loadErrors.push(errStr);</span>
<a href="#l66.495"></a><span id="l66.495" class="difflineminus">-        this._logger.warn(&quot;Error loading &quot; + filename);</span>
<a href="#l66.496"></a><span id="l66.496" class="difflineminus">-        this._logger.warn(errStr);</span>
<a href="#l66.497"></a><span id="l66.497" class="difflineminus">-      }</span>
<a href="#l66.498"></a><span id="l66.498" class="difflineminus">-    }</span>
<a href="#l66.499"></a><span id="l66.499" class="difflineminus">-    return remoteExperiments;</span>
<a href="#l66.500"></a><span id="l66.500" class="difflineminus">-  },</span>
<a href="#l66.501"></a><span id="l66.501" class="difflineminus">-</span>
<a href="#l66.502"></a><span id="l66.502" class="difflineminus">-  getStudyResults: function() {</span>
<a href="#l66.503"></a><span id="l66.503" class="difflineminus">-    return this._studyResults;</span>
<a href="#l66.504"></a><span id="l66.504" class="difflineminus">-  },</span>
<a href="#l66.505"></a><span id="l66.505" class="difflineminus">-</span>
<a href="#l66.506"></a><span id="l66.506" class="difflineminus">-  getLegacyStudies: function() {</span>
<a href="#l66.507"></a><span id="l66.507" class="difflineminus">-    return this._legacyStudies;</span>
<a href="#l66.508"></a><span id="l66.508" class="difflineminus">-  },</span>
<a href="#l66.509"></a><span id="l66.509" class="difflineminus">-</span>
<a href="#l66.510"></a><span id="l66.510" class="difflineminus">-  getLoadErrors: function() {</span>
<a href="#l66.511"></a><span id="l66.511" class="difflineminus">-    return this._loadErrors;</span>
<a href="#l66.512"></a><span id="l66.512" class="difflineminus">-  }</span>
<a href="#l66.513"></a><span id="l66.513" class="difflineminus">-};</span>
<a href="#l66.514"></a><span id="l66.514" class="difflineminus">-</span>
<a href="#l66.515"></a><span id="l66.515" class="difflineminus">-// TODO purge the pref store of anybody who has one.</span>
<a href="#l66.516"></a><span id="l66.516" class="difflineminus">-</span>
<a href="#l66.517"></a><span id="l66.517" class="difflineminus">-// TODO Also, if user has a study id foo that is not expired yet, and</span>
<a href="#l66.518"></a><span id="l66.518" class="difflineminus">-// a LegacyStudy appears with the same id, they should keep their &quot;real&quot;</span>
<a href="#l66.519"></a><span id="l66.519" class="difflineminus">-// version of id foo and not load the LegacyStudy version.</span>
<a href="#l66.520"></a><span id="l66.520" class="difflineminus">-</span>
<a href="#l66.521"></a><span id="l66.521" class="difflineminus">-// TODO but once the study is expired, should delete the jar for it and</span>
<a href="#l66.522"></a><span id="l66.522" class="difflineminus">-// just load the LegacyStudy version.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l67.1"></a><span id="l67.1">deleted file mode 100644</span>
<a href="#l67.2"></a><span id="l67.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/setup.js</span>
<a href="#l67.3"></a><span id="l67.3" class="difflineplus">+++ /dev/null</span>
<a href="#l67.4"></a><span id="l67.4" class="difflineat">@@ -1,728 +0,0 @@</span>
<a href="#l67.5"></a><span id="l67.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l67.6"></a><span id="l67.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l67.7"></a><span id="l67.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l67.8"></a><span id="l67.8" class="difflineminus">-</span>
<a href="#l67.9"></a><span id="l67.9" class="difflineminus">-EXPORTED_SYMBOLS = [&quot;TestPilotSetup&quot;, &quot;POPUP_SHOW_ON_NEW&quot;,</span>
<a href="#l67.10"></a><span id="l67.10" class="difflineminus">-                    &quot;POPUP_SHOW_ON_FINISH&quot;, &quot;POPUP_SHOW_ON_RESULTS&quot;,</span>
<a href="#l67.11"></a><span id="l67.11" class="difflineminus">-                    &quot;ALWAYS_SUBMIT_DATA&quot;, &quot;RUN_AT_ALL_PREF&quot;];</span>
<a href="#l67.12"></a><span id="l67.12" class="difflineminus">-</span>
<a href="#l67.13"></a><span id="l67.13" class="difflineminus">-const Cc = Components.classes;</span>
<a href="#l67.14"></a><span id="l67.14" class="difflineminus">-const Ci = Components.interfaces;</span>
<a href="#l67.15"></a><span id="l67.15" class="difflineminus">-const Cu = Components.utils;</span>
<a href="#l67.16"></a><span id="l67.16" class="difflineminus">-</span>
<a href="#l67.17"></a><span id="l67.17" class="difflineminus">-Cu.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l67.18"></a><span id="l67.18" class="difflineminus">-Cu.import(&quot;resource://testpilot/modules/log4moz.js&quot;);</span>
<a href="#l67.19"></a><span id="l67.19" class="difflineminus">-</span>
<a href="#l67.20"></a><span id="l67.20" class="difflineminus">-const EXTENSION_ID = &quot;tbtestpilot@labs.mozilla.com&quot;;</span>
<a href="#l67.21"></a><span id="l67.21" class="difflineminus">-const VERSION_PREF =&quot;extensions.testpilot.lastversion&quot;;</span>
<a href="#l67.22"></a><span id="l67.22" class="difflineminus">-const FIRST_RUN_PREF =&quot;extensions.testpilot.firstRunUrl&quot;;</span>
<a href="#l67.23"></a><span id="l67.23" class="difflineminus">-const RUN_AT_ALL_PREF = &quot;extensions.testpilot.runStudies&quot;;</span>
<a href="#l67.24"></a><span id="l67.24" class="difflineminus">-const POPUP_SHOW_ON_NEW = &quot;extensions.testpilot.popup.showOnNewStudy&quot;;</span>
<a href="#l67.25"></a><span id="l67.25" class="difflineminus">-const POPUP_SHOW_ON_FINISH = &quot;extensions.testpilot.popup.showOnStudyFinished&quot;;</span>
<a href="#l67.26"></a><span id="l67.26" class="difflineminus">-const POPUP_SHOW_ON_RESULTS = &quot;extensions.testpilot.popup.showOnNewResults&quot;;</span>
<a href="#l67.27"></a><span id="l67.27" class="difflineminus">-const POPUP_CHECK_INTERVAL = &quot;extensions.testpilot.popup.delayAfterStartup&quot;;</span>
<a href="#l67.28"></a><span id="l67.28" class="difflineminus">-const POPUP_REMINDER_INTERVAL = &quot;extensions.testpilot.popup.timeBetweenChecks&quot;;</span>
<a href="#l67.29"></a><span id="l67.29" class="difflineminus">-const ALWAYS_SUBMIT_DATA = &quot;extensions.testpilot.alwaysSubmitData&quot;;</span>
<a href="#l67.30"></a><span id="l67.30" class="difflineminus">-const UPDATE_CHANNEL_PREF = &quot;app.update.channel&quot;;</span>
<a href="#l67.31"></a><span id="l67.31" class="difflineminus">-const LOADER_LOG = &quot;extensions.testpilot.loader&quot;;</span>
<a href="#l67.32"></a><span id="l67.32" class="difflineminus">-const SETUP_LOG = &quot;extensions.testpilot.setup&quot;;</span>
<a href="#l67.33"></a><span id="l67.33" class="difflineminus">-const LOG_FILE_NAME = &quot;TestPilotErrorLog.log&quot;;</span>
<a href="#l67.34"></a><span id="l67.34" class="difflineminus">-const RANDOM_DEPLOY_PREFIX = &quot;extensions.testpilot.deploymentRandomizer&quot;;</span>
<a href="#l67.35"></a><span id="l67.35" class="difflineminus">-</span>
<a href="#l67.36"></a><span id="l67.36" class="difflineminus">-const THUNDERBIRD_APP_ID = &quot;{3550f703-e582-4d05-9a08-453d09bdfdc6}&quot;;</span>
<a href="#l67.37"></a><span id="l67.37" class="difflineminus">-</span>
<a href="#l67.38"></a><span id="l67.38" class="difflineminus">-Cu.import(&quot;resource://testpilot/modules/interface.js&quot;);</span>
<a href="#l67.39"></a><span id="l67.39" class="difflineminus">-</span>
<a href="#l67.40"></a><span id="l67.40" class="difflineminus">-let TestPilotSetup = {</span>
<a href="#l67.41"></a><span id="l67.41" class="difflineminus">-  didReminderAfterStartup: false,</span>
<a href="#l67.42"></a><span id="l67.42" class="difflineminus">-  startupComplete: false,</span>
<a href="#l67.43"></a><span id="l67.43" class="difflineminus">-  _shortTimer: null,</span>
<a href="#l67.44"></a><span id="l67.44" class="difflineminus">-  _longTimer: null,</span>
<a href="#l67.45"></a><span id="l67.45" class="difflineminus">-  _remoteExperimentLoader: null, // TODO make this a lazy initializer too?</span>
<a href="#l67.46"></a><span id="l67.46" class="difflineminus">-  taskList: [],</span>
<a href="#l67.47"></a><span id="l67.47" class="difflineminus">-  version: &quot;&quot;,</span>
<a href="#l67.48"></a><span id="l67.48" class="difflineminus">-</span>
<a href="#l67.49"></a><span id="l67.49" class="difflineminus">-  // Lazy initializers:</span>
<a href="#l67.50"></a><span id="l67.50" class="difflineminus">-  __prefs: null,</span>
<a href="#l67.51"></a><span id="l67.51" class="difflineminus">-  get _prefs() {</span>
<a href="#l67.52"></a><span id="l67.52" class="difflineminus">-    if (this.__prefs == null) {</span>
<a href="#l67.53"></a><span id="l67.53" class="difflineminus">-      this.__prefs = Services.prefs;</span>
<a href="#l67.54"></a><span id="l67.54" class="difflineminus">-    }</span>
<a href="#l67.55"></a><span id="l67.55" class="difflineminus">-    return this.__prefs;</span>
<a href="#l67.56"></a><span id="l67.56" class="difflineminus">-  },</span>
<a href="#l67.57"></a><span id="l67.57" class="difflineminus">-</span>
<a href="#l67.58"></a><span id="l67.58" class="difflineminus">-  __loader: null,</span>
<a href="#l67.59"></a><span id="l67.59" class="difflineminus">-  get _loader() {</span>
<a href="#l67.60"></a><span id="l67.60" class="difflineminus">-    if (this.__loader == null) {</span>
<a href="#l67.61"></a><span id="l67.61" class="difflineminus">-      let Cuddlefish = {};</span>
<a href="#l67.62"></a><span id="l67.62" class="difflineminus">-      Components.utils.import(&quot;resource://testpilot/modules/lib/cuddlefish.js&quot;,</span>
<a href="#l67.63"></a><span id="l67.63" class="difflineminus">-                        Cuddlefish);</span>
<a href="#l67.64"></a><span id="l67.64" class="difflineminus">-      let repo = this._logRepo;</span>
<a href="#l67.65"></a><span id="l67.65" class="difflineminus">-      let logger = repo.getLogger(LOADER_LOG)</span>
<a href="#l67.66"></a><span id="l67.66" class="difflineminus">-      try {</span>
<a href="#l67.67"></a><span id="l67.67" class="difflineminus">-        logger.level = Log4Moz.Level[Services.prefs.getCharPref(LOADER_LOG + &quot;.log&quot;)];</span>
<a href="#l67.68"></a><span id="l67.68" class="difflineminus">-      }</span>
<a href="#l67.69"></a><span id="l67.69" class="difflineminus">-      catch (e) {</span>
<a href="#l67.70"></a><span id="l67.70" class="difflineminus">-        logger.level = Log4Moz.Level.Error;</span>
<a href="#l67.71"></a><span id="l67.71" class="difflineminus">-      }</span>
<a href="#l67.72"></a><span id="l67.72" class="difflineminus">-      this.__loader = new Cuddlefish.Loader(</span>
<a href="#l67.73"></a><span id="l67.73" class="difflineminus">-          {rootPaths: [&quot;resource://testpilot/modules/&quot;,</span>
<a href="#l67.74"></a><span id="l67.74" class="difflineminus">-                     &quot;resource://testpilot/modules/lib/&quot;],</span>
<a href="#l67.75"></a><span id="l67.75" class="difflineminus">-           console: logger</span>
<a href="#l67.76"></a><span id="l67.76" class="difflineminus">-      });</span>
<a href="#l67.77"></a><span id="l67.77" class="difflineminus">-    }</span>
<a href="#l67.78"></a><span id="l67.78" class="difflineminus">-    return this.__loader;</span>
<a href="#l67.79"></a><span id="l67.79" class="difflineminus">-  },</span>
<a href="#l67.80"></a><span id="l67.80" class="difflineminus">-</span>
<a href="#l67.81"></a><span id="l67.81" class="difflineminus">-  __feedbackManager: null,</span>
<a href="#l67.82"></a><span id="l67.82" class="difflineminus">-  get _feedbackManager() {</span>
<a href="#l67.83"></a><span id="l67.83" class="difflineminus">-    if (this.__feedbackManager == null) {</span>
<a href="#l67.84"></a><span id="l67.84" class="difflineminus">-      let FeedbackModule = {};</span>
<a href="#l67.85"></a><span id="l67.85" class="difflineminus">-      Cu.import(&quot;resource://testpilot/modules/feedback.js&quot;, FeedbackModule);</span>
<a href="#l67.86"></a><span id="l67.86" class="difflineminus">-      this.__feedbackManager = FeedbackModule.FeedbackManager;</span>
<a href="#l67.87"></a><span id="l67.87" class="difflineminus">-    }</span>
<a href="#l67.88"></a><span id="l67.88" class="difflineminus">-    return this.__feedbackManager;</span>
<a href="#l67.89"></a><span id="l67.89" class="difflineminus">-  },</span>
<a href="#l67.90"></a><span id="l67.90" class="difflineminus">-</span>
<a href="#l67.91"></a><span id="l67.91" class="difflineminus">-  __dataStoreModule: null,</span>
<a href="#l67.92"></a><span id="l67.92" class="difflineminus">-  get _dataStoreModule() {</span>
<a href="#l67.93"></a><span id="l67.93" class="difflineminus">-    if (this.__dataStoreModule == null) {</span>
<a href="#l67.94"></a><span id="l67.94" class="difflineminus">-      this.__dataStoreModule = {};</span>
<a href="#l67.95"></a><span id="l67.95" class="difflineminus">-      Cu.import(&quot;resource://testpilot/modules/experiment_data_store.js&quot;,</span>
<a href="#l67.96"></a><span id="l67.96" class="difflineminus">-                  this._dataStoreModule);</span>
<a href="#l67.97"></a><span id="l67.97" class="difflineminus">-    }</span>
<a href="#l67.98"></a><span id="l67.98" class="difflineminus">-    return this.__dataStoreModule;</span>
<a href="#l67.99"></a><span id="l67.99" class="difflineminus">-  },</span>
<a href="#l67.100"></a><span id="l67.100" class="difflineminus">-</span>
<a href="#l67.101"></a><span id="l67.101" class="difflineminus">-  __logRepo: null,</span>
<a href="#l67.102"></a><span id="l67.102" class="difflineminus">-  get _logRepo() {</span>
<a href="#l67.103"></a><span id="l67.103" class="difflineminus">-    // Note: This hits the disk so it's an expensive operation; don't call it</span>
<a href="#l67.104"></a><span id="l67.104" class="difflineminus">-    // on startup.</span>
<a href="#l67.105"></a><span id="l67.105" class="difflineminus">-    if (this.__logRepo == null) {</span>
<a href="#l67.106"></a><span id="l67.106" class="difflineminus">-      let props = Services.dirsvc;</span>
<a href="#l67.107"></a><span id="l67.107" class="difflineminus">-      let logFile = props.get(&quot;ProfD&quot;, Components.interfaces.nsIFile);</span>
<a href="#l67.108"></a><span id="l67.108" class="difflineminus">-      logFile.append(LOG_FILE_NAME);</span>
<a href="#l67.109"></a><span id="l67.109" class="difflineminus">-      let formatter = new Log4Moz.BasicFormatter;</span>
<a href="#l67.110"></a><span id="l67.110" class="difflineminus">-      let root = Log4Moz.repository.rootLogger;</span>
<a href="#l67.111"></a><span id="l67.111" class="difflineminus">-      root.level = Log4Moz.Level.Error;</span>
<a href="#l67.112"></a><span id="l67.112" class="difflineminus">-      let appender = new Log4Moz.RotatingFileAppender(logFile, formatter);</span>
<a href="#l67.113"></a><span id="l67.113" class="difflineminus">-      root.addAppender(appender);</span>
<a href="#l67.114"></a><span id="l67.114" class="difflineminus">-      this.__logRepo = Log4Moz.repository;</span>
<a href="#l67.115"></a><span id="l67.115" class="difflineminus">-    }</span>
<a href="#l67.116"></a><span id="l67.116" class="difflineminus">-    return this.__logRepo;</span>
<a href="#l67.117"></a><span id="l67.117" class="difflineminus">-  },</span>
<a href="#l67.118"></a><span id="l67.118" class="difflineminus">-</span>
<a href="#l67.119"></a><span id="l67.119" class="difflineminus">-  __logger: null,</span>
<a href="#l67.120"></a><span id="l67.120" class="difflineminus">-  get _logger() {</span>
<a href="#l67.121"></a><span id="l67.121" class="difflineminus">-    if (this.__logger == null) {</span>
<a href="#l67.122"></a><span id="l67.122" class="difflineminus">-      this.__logger = this._logRepo.getLogger(SETUP_LOG);</span>
<a href="#l67.123"></a><span id="l67.123" class="difflineminus">-      try {</span>
<a href="#l67.124"></a><span id="l67.124" class="difflineminus">-        this.__logger.level = Log4Moz.Level[Services.prefs.getCharPref(SETUP_LOG + &quot;.log&quot;)];</span>
<a href="#l67.125"></a><span id="l67.125" class="difflineminus">-      }</span>
<a href="#l67.126"></a><span id="l67.126" class="difflineminus">-      catch (e) {</span>
<a href="#l67.127"></a><span id="l67.127" class="difflineminus">-        this.__logger.level = Log4Moz.Level.Error;</span>
<a href="#l67.128"></a><span id="l67.128" class="difflineminus">-      }</span>
<a href="#l67.129"></a><span id="l67.129" class="difflineminus">-    }</span>
<a href="#l67.130"></a><span id="l67.130" class="difflineminus">-    return this.__logger;</span>
<a href="#l67.131"></a><span id="l67.131" class="difflineminus">-  },</span>
<a href="#l67.132"></a><span id="l67.132" class="difflineminus">-</span>
<a href="#l67.133"></a><span id="l67.133" class="difflineminus">-  __taskModule: null,</span>
<a href="#l67.134"></a><span id="l67.134" class="difflineminus">-  get _taskModule() {</span>
<a href="#l67.135"></a><span id="l67.135" class="difflineminus">-    if (this.__taskModule == null) {</span>
<a href="#l67.136"></a><span id="l67.136" class="difflineminus">-      this.__taskModule = {};</span>
<a href="#l67.137"></a><span id="l67.137" class="difflineminus">-      Cu.import(&quot;resource://testpilot/modules/tasks.js&quot;, this.__taskModule);</span>
<a href="#l67.138"></a><span id="l67.138" class="difflineminus">-    }</span>
<a href="#l67.139"></a><span id="l67.139" class="difflineminus">-    return this.__taskModule;</span>
<a href="#l67.140"></a><span id="l67.140" class="difflineminus">-  },</span>
<a href="#l67.141"></a><span id="l67.141" class="difflineminus">-</span>
<a href="#l67.142"></a><span id="l67.142" class="difflineminus">-  __stringBundle: null,</span>
<a href="#l67.143"></a><span id="l67.143" class="difflineminus">-  get _stringBundle() {</span>
<a href="#l67.144"></a><span id="l67.144" class="difflineminus">-    if (this.__stringBundle == null) {</span>
<a href="#l67.145"></a><span id="l67.145" class="difflineminus">-      this.__stringBundle = Services.strings.</span>
<a href="#l67.146"></a><span id="l67.146" class="difflineminus">-          createBundle(&quot;chrome://testpilot/locale/main.properties&quot;);</span>
<a href="#l67.147"></a><span id="l67.147" class="difflineminus">-    }</span>
<a href="#l67.148"></a><span id="l67.148" class="difflineminus">-    return this.__stringBundle;</span>
<a href="#l67.149"></a><span id="l67.149" class="difflineminus">-  },</span>
<a href="#l67.150"></a><span id="l67.150" class="difflineminus">-</span>
<a href="#l67.151"></a><span id="l67.151" class="difflineminus">-  __obs: null,</span>
<a href="#l67.152"></a><span id="l67.152" class="difflineminus">-  get _obs() {</span>
<a href="#l67.153"></a><span id="l67.153" class="difflineminus">-    if (this.__obs == null) {</span>
<a href="#l67.154"></a><span id="l67.154" class="difflineminus">-      this.__obs = this._loader.require(&quot;observer-service&quot;);</span>
<a href="#l67.155"></a><span id="l67.155" class="difflineminus">-    }</span>
<a href="#l67.156"></a><span id="l67.156" class="difflineminus">-    return this.__obs;</span>
<a href="#l67.157"></a><span id="l67.157" class="difflineminus">-  },</span>
<a href="#l67.158"></a><span id="l67.158" class="difflineminus">-</span>
<a href="#l67.159"></a><span id="l67.159" class="difflineminus">-  __notifier: null,</span>
<a href="#l67.160"></a><span id="l67.160" class="difflineminus">-  get _notifier() {</span>
<a href="#l67.161"></a><span id="l67.161" class="difflineminus">-    if (this.__notifier == null) {</span>
<a href="#l67.162"></a><span id="l67.162" class="difflineminus">-      this.__notifier = TestPilotUIBuilder.getNotificationManager();</span>
<a href="#l67.163"></a><span id="l67.163" class="difflineminus">-    }</span>
<a href="#l67.164"></a><span id="l67.164" class="difflineminus">-    return this.__notifier;</span>
<a href="#l67.165"></a><span id="l67.165" class="difflineminus">-  },</span>
<a href="#l67.166"></a><span id="l67.166" class="difflineminus">-</span>
<a href="#l67.167"></a><span id="l67.167" class="difflineminus">-  get _appID() {</span>
<a href="#l67.168"></a><span id="l67.168" class="difflineminus">-    delete this._appID;</span>
<a href="#l67.169"></a><span id="l67.169" class="difflineminus">-    return this._appID = Services.appinfo.ID;</span>
<a href="#l67.170"></a><span id="l67.170" class="difflineminus">-  },</span>
<a href="#l67.171"></a><span id="l67.171" class="difflineminus">-</span>
<a href="#l67.172"></a><span id="l67.172" class="difflineminus">-  globalStartup: function TPS__doGlobalSetup() {</span>
<a href="#l67.173"></a><span id="l67.173" class="difflineminus">-    // Only ever run this stuff ONCE, on the first window restore.</span>
<a href="#l67.174"></a><span id="l67.174" class="difflineminus">-    // Should get called by the Test Pilot component.</span>
<a href="#l67.175"></a><span id="l67.175" class="difflineminus">-    let logger = this._logger;</span>
<a href="#l67.176"></a><span id="l67.176" class="difflineminus">-    logger.trace(&quot;TestPilotSetup.globalStartup was called.&quot;);</span>
<a href="#l67.177"></a><span id="l67.177" class="difflineminus">-</span>
<a href="#l67.178"></a><span id="l67.178" class="difflineminus">-    try {</span>
<a href="#l67.179"></a><span id="l67.179" class="difflineminus">-    if (!this._prefs.getBoolPref(RUN_AT_ALL_PREF)) {</span>
<a href="#l67.180"></a><span id="l67.180" class="difflineminus">-      logger.trace(&quot;Test Pilot globally disabled: Not starting up.&quot;);</span>
<a href="#l67.181"></a><span id="l67.181" class="difflineminus">-      return;</span>
<a href="#l67.182"></a><span id="l67.182" class="difflineminus">-    }</span>
<a href="#l67.183"></a><span id="l67.183" class="difflineminus">-</span>
<a href="#l67.184"></a><span id="l67.184" class="difflineminus">-    // Set up observation for task state changes</span>
<a href="#l67.185"></a><span id="l67.185" class="difflineminus">-    var self = this;</span>
<a href="#l67.186"></a><span id="l67.186" class="difflineminus">-    this._obs.add(&quot;testpilot:task:changed&quot;, this.onTaskStatusChanged, self);</span>
<a href="#l67.187"></a><span id="l67.187" class="difflineminus">-    this._obs.add(</span>
<a href="#l67.188"></a><span id="l67.188" class="difflineminus">-      &quot;testpilot:task:dataAutoSubmitted&quot;, this._onTaskDataAutoSubmitted, self);</span>
<a href="#l67.189"></a><span id="l67.189" class="difflineminus">-    // Set up observation for application shutdown.</span>
<a href="#l67.190"></a><span id="l67.190" class="difflineminus">-    this._obs.add(&quot;quit-application&quot;, this.globalShutdown, self);</span>
<a href="#l67.191"></a><span id="l67.191" class="difflineminus">-    // Set up observation for enter/exit private browsing:</span>
<a href="#l67.192"></a><span id="l67.192" class="difflineminus">-    this._obs.add(&quot;private-browsing&quot;, this.onPrivateBrowsingMode, self);</span>
<a href="#l67.193"></a><span id="l67.193" class="difflineminus">-</span>
<a href="#l67.194"></a><span id="l67.194" class="difflineminus">-    // Set up timers to remind user x minutes after startup</span>
<a href="#l67.195"></a><span id="l67.195" class="difflineminus">-    // and once per day thereafter.  Use nsITimer so it doesn't belong to</span>
<a href="#l67.196"></a><span id="l67.196" class="difflineminus">-    // any one window.</span>
<a href="#l67.197"></a><span id="l67.197" class="difflineminus">-    logger.trace(&quot;Setting interval for showing reminders...&quot;);</span>
<a href="#l67.198"></a><span id="l67.198" class="difflineminus">-</span>
<a href="#l67.199"></a><span id="l67.199" class="difflineminus">-    this._shortTimer = Cc[&quot;@mozilla.org/timer;1&quot;].createInstance(Ci.nsITimer);</span>
<a href="#l67.200"></a><span id="l67.200" class="difflineminus">-    this._shortTimer.initWithCallback(</span>
<a href="#l67.201"></a><span id="l67.201" class="difflineminus">-      { notify: function(timer) { self._doHousekeeping();} },</span>
<a href="#l67.202"></a><span id="l67.202" class="difflineminus">-      this._prefs.getIntPref(POPUP_CHECK_INTERVAL),</span>
<a href="#l67.203"></a><span id="l67.203" class="difflineminus">-      Ci.nsITimer.TYPE_REPEATING_SLACK</span>
<a href="#l67.204"></a><span id="l67.204" class="difflineminus">-    );</span>
<a href="#l67.205"></a><span id="l67.205" class="difflineminus">-    this._longTimer = Cc[&quot;@mozilla.org/timer;1&quot;].createInstance(Ci.nsITimer);</span>
<a href="#l67.206"></a><span id="l67.206" class="difflineminus">-    this._longTimer.initWithCallback(</span>
<a href="#l67.207"></a><span id="l67.207" class="difflineminus">-      { notify: function(timer) {</span>
<a href="#l67.208"></a><span id="l67.208" class="difflineminus">-          self.reloadRemoteExperiments(function() {</span>
<a href="#l67.209"></a><span id="l67.209" class="difflineminus">-            self._notifyUserOfTasks();</span>
<a href="#l67.210"></a><span id="l67.210" class="difflineminus">-	  });</span>
<a href="#l67.211"></a><span id="l67.211" class="difflineminus">-      }}, this._prefs.getIntPref(POPUP_REMINDER_INTERVAL),</span>
<a href="#l67.212"></a><span id="l67.212" class="difflineminus">-      Ci.nsITimer.TYPE_REPEATING_SLACK);</span>
<a href="#l67.213"></a><span id="l67.213" class="difflineminus">-</span>
<a href="#l67.214"></a><span id="l67.214" class="difflineminus">-      this.getVersion(function() {</span>
<a href="#l67.215"></a><span id="l67.215" class="difflineminus">-        /* Show first run page (in front window) only the first time after install;</span>
<a href="#l67.216"></a><span id="l67.216" class="difflineminus">-         * Don't show first run page in Feedback UI version. */</span>
<a href="#l67.217"></a><span id="l67.217" class="difflineminus">-        if (!self._prefs.prefHasUserValue(VERSION_PREF) &amp;&amp;</span>
<a href="#l67.218"></a><span id="l67.218" class="difflineminus">-            (!TestPilotUIBuilder.channelUsesFeedback())</span>
<a href="#l67.219"></a><span id="l67.219" class="difflineminus">-            &amp;&amp; self._shouldOpenTabs()) {</span>
<a href="#l67.220"></a><span id="l67.220" class="difflineminus">-            self._prefs.setCharPref(VERSION_PREF, self.version);</span>
<a href="#l67.221"></a><span id="l67.221" class="difflineminus">-            let browser = self._getFrontBrowserWindow().getBrowser();</span>
<a href="#l67.222"></a><span id="l67.222" class="difflineminus">-            let url = self._prefs.getCharPref(FIRST_RUN_PREF);</span>
<a href="#l67.223"></a><span id="l67.223" class="difflineminus">-            self._openInTab(url);</span>
<a href="#l67.224"></a><span id="l67.224" class="difflineminus">-        }</span>
<a href="#l67.225"></a><span id="l67.225" class="difflineminus">-</span>
<a href="#l67.226"></a><span id="l67.226" class="difflineminus">-        // Install tasks. (This requires knowing the version, so it is</span>
<a href="#l67.227"></a><span id="l67.227" class="difflineminus">-        // inside the callback from getVersion.)</span>
<a href="#l67.228"></a><span id="l67.228" class="difflineminus">-        self.checkForTasks(function() {</span>
<a href="#l67.229"></a><span id="l67.229" class="difflineminus">-          /* Callback to complete startup after we finish</span>
<a href="#l67.230"></a><span id="l67.230" class="difflineminus">-           * checking for tasks. */</span>
<a href="#l67.231"></a><span id="l67.231" class="difflineminus">-         self.startupComplete = true;</span>
<a href="#l67.232"></a><span id="l67.232" class="difflineminus">-         logger.trace(&quot;I'm in the callback from checkForTasks.&quot;);</span>
<a href="#l67.233"></a><span id="l67.233" class="difflineminus">-         // Send startup message to each task:</span>
<a href="#l67.234"></a><span id="l67.234" class="difflineminus">-         for (let i = 0; i &lt; self.taskList.length; i++) {</span>
<a href="#l67.235"></a><span id="l67.235" class="difflineminus">-           self.taskList[i].onAppStartup();</span>
<a href="#l67.236"></a><span id="l67.236" class="difflineminus">-         }</span>
<a href="#l67.237"></a><span id="l67.237" class="difflineminus">-         self._obs.notify(&quot;testpilot:startup:complete&quot;, &quot;&quot;, null);</span>
<a href="#l67.238"></a><span id="l67.238" class="difflineminus">-         /* onWindowLoad gets called once for each window,</span>
<a href="#l67.239"></a><span id="l67.239" class="difflineminus">-          * but only after we fire this notification. */</span>
<a href="#l67.240"></a><span id="l67.240" class="difflineminus">-         logger.trace(&quot;Testpilot startup complete.&quot;);</span>
<a href="#l67.241"></a><span id="l67.241" class="difflineminus">-      });</span>
<a href="#l67.242"></a><span id="l67.242" class="difflineminus">-    });</span>
<a href="#l67.243"></a><span id="l67.243" class="difflineminus">-    } catch(e) {</span>
<a href="#l67.244"></a><span id="l67.244" class="difflineminus">-      logger.error(&quot;Error in testPilot startup: &quot; + e);</span>
<a href="#l67.245"></a><span id="l67.245" class="difflineminus">-    }</span>
<a href="#l67.246"></a><span id="l67.246" class="difflineminus">-  },</span>
<a href="#l67.247"></a><span id="l67.247" class="difflineminus">-</span>
<a href="#l67.248"></a><span id="l67.248" class="difflineminus">-  globalShutdown: function TPS_globalShutdown() {</span>
<a href="#l67.249"></a><span id="l67.249" class="difflineminus">-    let logger = this._logger;</span>
<a href="#l67.250"></a><span id="l67.250" class="difflineminus">-    logger.trace(&quot;Global shutdown.  Unregistering everything.&quot;);</span>
<a href="#l67.251"></a><span id="l67.251" class="difflineminus">-    let self = this;</span>
<a href="#l67.252"></a><span id="l67.252" class="difflineminus">-    for (let i = 0; i &lt; self.taskList.length; i++) {</span>
<a href="#l67.253"></a><span id="l67.253" class="difflineminus">-      self.taskList[i].onAppShutdown();</span>
<a href="#l67.254"></a><span id="l67.254" class="difflineminus">-      self.taskList[i].onExperimentShutdown();</span>
<a href="#l67.255"></a><span id="l67.255" class="difflineminus">-    }</span>
<a href="#l67.256"></a><span id="l67.256" class="difflineminus">-    this.taskList = [];</span>
<a href="#l67.257"></a><span id="l67.257" class="difflineminus">-    this._loader.unload();</span>
<a href="#l67.258"></a><span id="l67.258" class="difflineminus">-    this._obs.remove(&quot;testpilot:task:changed&quot;, this.onTaskStatusChanged, self);</span>
<a href="#l67.259"></a><span id="l67.259" class="difflineminus">-    this._obs.remove(</span>
<a href="#l67.260"></a><span id="l67.260" class="difflineminus">-      &quot;testpilot:task:dataAutoSubmitted&quot;, this._onTaskDataAutoSubmitted, self);</span>
<a href="#l67.261"></a><span id="l67.261" class="difflineminus">-    this._obs.remove(&quot;quit-application&quot;, this.globalShutdown, self);</span>
<a href="#l67.262"></a><span id="l67.262" class="difflineminus">-    this._obs.remove(&quot;private-browsing&quot;, this.onPrivateBrowsingMode, self);</span>
<a href="#l67.263"></a><span id="l67.263" class="difflineminus">-    this._loader.unload();</span>
<a href="#l67.264"></a><span id="l67.264" class="difflineminus">-    this._shortTimer.cancel();</span>
<a href="#l67.265"></a><span id="l67.265" class="difflineminus">-    this._longTimer.cancel();</span>
<a href="#l67.266"></a><span id="l67.266" class="difflineminus">-    logger.trace(&quot;Done unregistering everything.&quot;);</span>
<a href="#l67.267"></a><span id="l67.267" class="difflineminus">-  },</span>
<a href="#l67.268"></a><span id="l67.268" class="difflineminus">-</span>
<a href="#l67.269"></a><span id="l67.269" class="difflineminus">-  _getFrontBrowserWindow: function TPS__getFrontWindow() {</span>
<a href="#l67.270"></a><span id="l67.270" class="difflineminus">-    let wm = Services.wm;</span>
<a href="#l67.271"></a><span id="l67.271" class="difflineminus">-    // TODO Is &quot;most recent&quot; the same as &quot;front&quot;?</span>
<a href="#l67.272"></a><span id="l67.272" class="difflineminus">-    return wm.getMostRecentWindow(&quot;navigator:browser&quot;) ||</span>
<a href="#l67.273"></a><span id="l67.273" class="difflineminus">-           wm.getMostRecentWindow(&quot;mail:3pane&quot;);</span>
<a href="#l67.274"></a><span id="l67.274" class="difflineminus">-  },</span>
<a href="#l67.275"></a><span id="l67.275" class="difflineminus">-</span>
<a href="#l67.276"></a><span id="l67.276" class="difflineminus">-  onPrivateBrowsingMode: function TPS_onPrivateBrowsingMode(topic, data) {</span>
<a href="#l67.277"></a><span id="l67.277" class="difflineminus">-    for (let i = 0; i &lt; this.taskList.length; i++) {</span>
<a href="#l67.278"></a><span id="l67.278" class="difflineminus">-      if (data == &quot;enter&quot;) {</span>
<a href="#l67.279"></a><span id="l67.279" class="difflineminus">-        this.taskList[i].onEnterPrivateBrowsing();</span>
<a href="#l67.280"></a><span id="l67.280" class="difflineminus">-      } else if (data == &quot;exit&quot;) {</span>
<a href="#l67.281"></a><span id="l67.281" class="difflineminus">-        this.taskList[i].onExitPrivateBrowsing();</span>
<a href="#l67.282"></a><span id="l67.282" class="difflineminus">-      }</span>
<a href="#l67.283"></a><span id="l67.283" class="difflineminus">-    }</span>
<a href="#l67.284"></a><span id="l67.284" class="difflineminus">-  },</span>
<a href="#l67.285"></a><span id="l67.285" class="difflineminus">-</span>
<a href="#l67.286"></a><span id="l67.286" class="difflineminus">-  onWindowUnload: function TPS__onWindowRegistered(window) {</span>
<a href="#l67.287"></a><span id="l67.287" class="difflineminus">-    this._logger.trace(&quot;Called TestPilotSetup.onWindow unload!&quot;);</span>
<a href="#l67.288"></a><span id="l67.288" class="difflineminus">-    for (let i = 0; i &lt; this.taskList.length; i++) {</span>
<a href="#l67.289"></a><span id="l67.289" class="difflineminus">-      this.taskList[i].onWindowClosed(window);</span>
<a href="#l67.290"></a><span id="l67.290" class="difflineminus">-    }</span>
<a href="#l67.291"></a><span id="l67.291" class="difflineminus">-  },</span>
<a href="#l67.292"></a><span id="l67.292" class="difflineminus">-</span>
<a href="#l67.293"></a><span id="l67.293" class="difflineminus">-  onWindowLoad: function TPS_onWindowLoad(window) {</span>
<a href="#l67.294"></a><span id="l67.294" class="difflineminus">-    this._logger.trace(&quot;Called TestPilotSetup.onWindowLoad!&quot;);</span>
<a href="#l67.295"></a><span id="l67.295" class="difflineminus">-    // Run this stuff once per window...</span>
<a href="#l67.296"></a><span id="l67.296" class="difflineminus">-    let self = this;</span>
<a href="#l67.297"></a><span id="l67.297" class="difflineminus">-</span>
<a href="#l67.298"></a><span id="l67.298" class="difflineminus">-    // Register listener for URL loads, that will notify all tasks about</span>
<a href="#l67.299"></a><span id="l67.299" class="difflineminus">-    // new page:</span>
<a href="#l67.300"></a><span id="l67.300" class="difflineminus">-    let appcontent = window.document.getElementById(&quot;appcontent&quot;);</span>
<a href="#l67.301"></a><span id="l67.301" class="difflineminus">-    if (appcontent) {</span>
<a href="#l67.302"></a><span id="l67.302" class="difflineminus">-      appcontent.addEventListener(&quot;DOMContentLoaded&quot;, function(event) {</span>
<a href="#l67.303"></a><span id="l67.303" class="difflineminus">-        let newUrl =  event.originalTarget.URL;</span>
<a href="#l67.304"></a><span id="l67.304" class="difflineminus">-        self._feedbackManager.fillInFeedbackPage(newUrl, window);</span>
<a href="#l67.305"></a><span id="l67.305" class="difflineminus">-        for (let i = 0; i &lt; self.taskList.length; i++) {</span>
<a href="#l67.306"></a><span id="l67.306" class="difflineminus">-          self.taskList[i].onUrlLoad(newUrl, event);</span>
<a href="#l67.307"></a><span id="l67.307" class="difflineminus">-        }</span>
<a href="#l67.308"></a><span id="l67.308" class="difflineminus">-      }, true);</span>
<a href="#l67.309"></a><span id="l67.309" class="difflineminus">-    }</span>
<a href="#l67.310"></a><span id="l67.310" class="difflineminus">-</span>
<a href="#l67.311"></a><span id="l67.311" class="difflineminus">-    // Let each task know about the new window.</span>
<a href="#l67.312"></a><span id="l67.312" class="difflineminus">-    for (let i = 0; i &lt; this.taskList.length; i++) {</span>
<a href="#l67.313"></a><span id="l67.313" class="difflineminus">-      this.taskList[i].onNewWindow(window);</span>
<a href="#l67.314"></a><span id="l67.314" class="difflineminus">-    }</span>
<a href="#l67.315"></a><span id="l67.315" class="difflineminus">-  },</span>
<a href="#l67.316"></a><span id="l67.316" class="difflineminus">-</span>
<a href="#l67.317"></a><span id="l67.317" class="difflineminus">-  addTask: function TPS_addTask(testPilotTask) {</span>
<a href="#l67.318"></a><span id="l67.318" class="difflineminus">-    // TODO raise some kind of exception if a task with the same ID already</span>
<a href="#l67.319"></a><span id="l67.319" class="difflineminus">-    // exists.  No excuse to ever be running two copies of the same task.</span>
<a href="#l67.320"></a><span id="l67.320" class="difflineminus">-    this.taskList.push(testPilotTask);</span>
<a href="#l67.321"></a><span id="l67.321" class="difflineminus">-  },</span>
<a href="#l67.322"></a><span id="l67.322" class="difflineminus">-</span>
<a href="#l67.323"></a><span id="l67.323" class="difflineminus">-  _openChromeless: function TPS__openChromeless(url) {</span>
<a href="#l67.324"></a><span id="l67.324" class="difflineminus">-    let window = this._getFrontBrowserWindow();</span>
<a href="#l67.325"></a><span id="l67.325" class="difflineminus">-    window.TestPilotWindowUtils.openChromeless(url);</span>
<a href="#l67.326"></a><span id="l67.326" class="difflineminus">-  },</span>
<a href="#l67.327"></a><span id="l67.327" class="difflineminus">-</span>
<a href="#l67.328"></a><span id="l67.328" class="difflineminus">-  _openInTab: function TPS__openInTab(url) {</span>
<a href="#l67.329"></a><span id="l67.329" class="difflineminus">-    let window = this._getFrontBrowserWindow();</span>
<a href="#l67.330"></a><span id="l67.330" class="difflineminus">-    window.TestPilotWindowUtils.openInTab(url);</span>
<a href="#l67.331"></a><span id="l67.331" class="difflineminus">-  },</span>
<a href="#l67.332"></a><span id="l67.332" class="difflineminus">-</span>
<a href="#l67.333"></a><span id="l67.333" class="difflineminus">-  _showSubmitNotification: function(task) {</span>
<a href="#l67.334"></a><span id="l67.334" class="difflineminus">-    let win = this._getFrontBrowserWindow();</span>
<a href="#l67.335"></a><span id="l67.335" class="difflineminus">-    let self = this;</span>
<a href="#l67.336"></a><span id="l67.336" class="difflineminus">-    this._notifier.showNotification(win, {</span>
<a href="#l67.337"></a><span id="l67.337" class="difflineminus">-      text: self._stringBundle.formatStringFromName(</span>
<a href="#l67.338"></a><span id="l67.338" class="difflineminus">-        &quot;testpilot.notification.readyToSubmit.message&quot;, [task.title], 1),</span>
<a href="#l67.339"></a><span id="l67.339" class="difflineminus">-      title: self._stringBundle.GetStringFromName(&quot;testpilot.notification.readyToSubmit&quot;),</span>
<a href="#l67.340"></a><span id="l67.340" class="difflineminus">-      iconClass: &quot;study-finished&quot;,</span>
<a href="#l67.341"></a><span id="l67.341" class="difflineminus">-      moreInfoLabel: self._stringBundle.GetStringFromName(&quot;testpilot.notification.seeYourData&quot;),</span>
<a href="#l67.342"></a><span id="l67.342" class="difflineminus">-      moreInfoCallback: function() { task.loadPage(); },</span>
<a href="#l67.343"></a><span id="l67.343" class="difflineminus">-      submitLabel: self._stringBundle.GetStringFromName(&quot;testpilot.submit&quot;),</span>
<a href="#l67.344"></a><span id="l67.344" class="difflineminus">-      submitCallback: function() {</span>
<a href="#l67.345"></a><span id="l67.345" class="difflineminus">-        task.upload( function(success) {</span>
<a href="#l67.346"></a><span id="l67.346" class="difflineminus">-          if (success) {</span>
<a href="#l67.347"></a><span id="l67.347" class="difflineminus">-            self._notifier.showNotification(win, {</span>
<a href="#l67.348"></a><span id="l67.348" class="difflineminus">-              text: self._stringBundle.GetStringFromName(</span>
<a href="#l67.349"></a><span id="l67.349" class="difflineminus">-                  &quot;testpilot.notification.thankYouForUploadingData.message&quot;),</span>
<a href="#l67.350"></a><span id="l67.350" class="difflineminus">-              title: self._stringBundle.GetStringFromName(</span>
<a href="#l67.351"></a><span id="l67.351" class="difflineminus">-                  &quot;testpilot.notification.thankYouForUploadingData&quot;),</span>
<a href="#l67.352"></a><span id="l67.352" class="difflineminus">-              iconClass:&quot;study-submitted&quot;,</span>
<a href="#l67.353"></a><span id="l67.353" class="difflineminus">-              linkText: self._stringBundle.GetStringFromName(&quot;testpilot.notification.seeYourData&quot;),</span>
<a href="#l67.354"></a><span id="l67.354" class="difflineminus">-              linkCallback: function() {task.loadPage(); },</span>
<a href="#l67.355"></a><span id="l67.355" class="difflineminus">-              fragile: true</span>
<a href="#l67.356"></a><span id="l67.356" class="difflineminus">-            });</span>
<a href="#l67.357"></a><span id="l67.357" class="difflineminus">-          } else {</span>
<a href="#l67.358"></a><span id="l67.358" class="difflineminus">-              // TODO any point in showing an error message here?</span>
<a href="#l67.359"></a><span id="l67.359" class="difflineminus">-          } }</span>
<a href="#l67.360"></a><span id="l67.360" class="difflineminus">-        );</span>
<a href="#l67.361"></a><span id="l67.361" class="difflineminus">-      },</span>
<a href="#l67.362"></a><span id="l67.362" class="difflineminus">-      cancelLabel: self._stringBundle.GetStringFromName(&quot;testpilot.notification.cancelLabel&quot;),</span>
<a href="#l67.363"></a><span id="l67.363" class="difflineminus">-      cancelCallback: function() {</span>
<a href="#l67.364"></a><span id="l67.364" class="difflineminus">-        task.optOut(null, null);</span>
<a href="#l67.365"></a><span id="l67.365" class="difflineminus">-      },</span>
<a href="#l67.366"></a><span id="l67.366" class="difflineminus">-      seeAllStudiesLabel: self._stringBundle.GetStringFromName(&quot;testpilot.notification.seeAllStudiesLabel&quot;),</span>
<a href="#l67.367"></a><span id="l67.367" class="difflineminus">-      seeAllStudiesCallback: function() {</span>
<a href="#l67.368"></a><span id="l67.368" class="difflineminus">-        self._getFrontBrowserWindow().TestPilotWindowUtils.openAllStudiesWindow();</span>
<a href="#l67.369"></a><span id="l67.369" class="difflineminus">-      },</span>
<a href="#l67.370"></a><span id="l67.370" class="difflineminus">-      alwaysSubmitLabel: self._stringBundle.GetStringFromName(&quot;testpilot.notification.alwaysSubmitLabel&quot;),</span>
<a href="#l67.371"></a><span id="l67.371" class="difflineminus">-      alwaysSubmitCallback: function() {</span>
<a href="#l67.372"></a><span id="l67.372" class="difflineminus">-        self._prefs.setBoolPref(ALWAYS_SUBMIT_DATA, true);</span>
<a href="#l67.373"></a><span id="l67.373" class="difflineminus">-      }</span>
<a href="#l67.374"></a><span id="l67.374" class="difflineminus">-    });</span>
<a href="#l67.375"></a><span id="l67.375" class="difflineminus">-  },</span>
<a href="#l67.376"></a><span id="l67.376" class="difflineminus">-</span>
<a href="#l67.377"></a><span id="l67.377" class="difflineminus">-  _notifyUserOfTasks: function TPS__notifyUser() {</span>
<a href="#l67.378"></a><span id="l67.378" class="difflineminus">-    // Check whether there are tasks needing attention, and if any are</span>
<a href="#l67.379"></a><span id="l67.379" class="difflineminus">-    // found, show the popup door-hanger thingy.</span>
<a href="#l67.380"></a><span id="l67.380" class="difflineminus">-    let i, task;</span>
<a href="#l67.381"></a><span id="l67.381" class="difflineminus">-    let self = this;</span>
<a href="#l67.382"></a><span id="l67.382" class="difflineminus">-    let TaskConstants = this._taskModule.TaskConstants;</span>
<a href="#l67.383"></a><span id="l67.383" class="difflineminus">-    let win = this._getFrontBrowserWindow();</span>
<a href="#l67.384"></a><span id="l67.384" class="difflineminus">-</span>
<a href="#l67.385"></a><span id="l67.385" class="difflineminus">-    // Highest priority is if there is a finished test (needs a decision)</span>
<a href="#l67.386"></a><span id="l67.386" class="difflineminus">-    if (this._prefs.getBoolPref(POPUP_SHOW_ON_FINISH)) {</span>
<a href="#l67.387"></a><span id="l67.387" class="difflineminus">-      for (i = 0; i &lt; this.taskList.length; i++) {</span>
<a href="#l67.388"></a><span id="l67.388" class="difflineminus">-        task = this.taskList[i];</span>
<a href="#l67.389"></a><span id="l67.389" class="difflineminus">-        if (task.status == TaskConstants.STATUS_FINISHED) {</span>
<a href="#l67.390"></a><span id="l67.390" class="difflineminus">-          if (!this._prefs.getBoolPref(ALWAYS_SUBMIT_DATA)) {</span>
<a href="#l67.391"></a><span id="l67.391" class="difflineminus">-            this._showSubmitNotification(task);</span>
<a href="#l67.392"></a><span id="l67.392" class="difflineminus">-            return;</span>
<a href="#l67.393"></a><span id="l67.393" class="difflineminus">-          }</span>
<a href="#l67.394"></a><span id="l67.394" class="difflineminus">-        }</span>
<a href="#l67.395"></a><span id="l67.395" class="difflineminus">-      }</span>
<a href="#l67.396"></a><span id="l67.396" class="difflineminus">-    }</span>
<a href="#l67.397"></a><span id="l67.397" class="difflineminus">-</span>
<a href="#l67.398"></a><span id="l67.398" class="difflineminus">-    // If there's no finished test, next highest priority is new tests that</span>
<a href="#l67.399"></a><span id="l67.399" class="difflineminus">-    // are starting...</span>
<a href="#l67.400"></a><span id="l67.400" class="difflineminus">-    if (this._prefs.getBoolPref(POPUP_SHOW_ON_NEW)) {</span>
<a href="#l67.401"></a><span id="l67.401" class="difflineminus">-      for (i = 0; i &lt; this.taskList.length; i++) {</span>
<a href="#l67.402"></a><span id="l67.402" class="difflineminus">-        task = this.taskList[i];</span>
<a href="#l67.403"></a><span id="l67.403" class="difflineminus">-        if (task.status == TaskConstants.STATUS_PENDING ||</span>
<a href="#l67.404"></a><span id="l67.404" class="difflineminus">-            task.status == TaskConstants.STATUS_NEW) {</span>
<a href="#l67.405"></a><span id="l67.405" class="difflineminus">-          if (task.taskType == TaskConstants.TYPE_EXPERIMENT) {</span>
<a href="#l67.406"></a><span id="l67.406" class="difflineminus">-            this._notifier.showNotification(win, {</span>
<a href="#l67.407"></a><span id="l67.407" class="difflineminus">-	      text: self._stringBundle.formatStringFromName(</span>
<a href="#l67.408"></a><span id="l67.408" class="difflineminus">-		&quot;testpilot.notification.newTestPilotStudy.pre.message&quot;,</span>
<a href="#l67.409"></a><span id="l67.409" class="difflineminus">-		[task.title], 1),</span>
<a href="#l67.410"></a><span id="l67.410" class="difflineminus">-	      title: self._stringBundle.GetStringFromName(</span>
<a href="#l67.411"></a><span id="l67.411" class="difflineminus">-		&quot;testpilot.notification.newTestPilotStudy&quot;),</span>
<a href="#l67.412"></a><span id="l67.412" class="difflineminus">-	      iconClass: &quot;new-study&quot;,</span>
<a href="#l67.413"></a><span id="l67.413" class="difflineminus">-	      moreInfoLabel: self._stringBundle.GetStringFromName(&quot;testpilot.moreInfo&quot;),</span>
<a href="#l67.414"></a><span id="l67.414" class="difflineminus">-              moreInfoCallback: function() { task.loadPage(); },</span>
<a href="#l67.415"></a><span id="l67.415" class="difflineminus">-              cancelLabel: self._stringBundle.GetStringFromName(&quot;testpilot.notification.cancelLabel&quot;),</span>
<a href="#l67.416"></a><span id="l67.416" class="difflineminus">-              cancelCallback: function() {</span>
<a href="#l67.417"></a><span id="l67.417" class="difflineminus">-                task.optOut(null, null);</span>
<a href="#l67.418"></a><span id="l67.418" class="difflineminus">-              },</span>
<a href="#l67.419"></a><span id="l67.419" class="difflineminus">-              seeAllStudiesLabel: self._stringBundle.GetStringFromName(&quot;testpilot.notification.seeAllStudiesLabel&quot;),</span>
<a href="#l67.420"></a><span id="l67.420" class="difflineminus">-              seeAllStudiesCallback: function() {</span>
<a href="#l67.421"></a><span id="l67.421" class="difflineminus">-                win.TestPilotWindowUtils.openAllStudiesWindow();</span>
<a href="#l67.422"></a><span id="l67.422" class="difflineminus">-              },</span>
<a href="#l67.423"></a><span id="l67.423" class="difflineminus">-              alwaysSubmitLabel: self._stringBundle.GetStringFromName(&quot;testpilot.notification.dontShowNewLabel&quot;),</span>
<a href="#l67.424"></a><span id="l67.424" class="difflineminus">-              alwaysSubmitCallback: function() {</span>
<a href="#l67.425"></a><span id="l67.425" class="difflineminus">-                self._prefs.setBoolPref(POPUP_SHOW_ON_NEW, false);</span>
<a href="#l67.426"></a><span id="l67.426" class="difflineminus">-              },</span>
<a href="#l67.427"></a><span id="l67.427" class="difflineminus">-              closeCallback: function() {</span>
<a href="#l67.428"></a><span id="l67.428" class="difflineminus">-                /* on close callback (Bug 575767) -- when the &quot;new study</span>
<a href="#l67.429"></a><span id="l67.429" class="difflineminus">-                 * starting&quot; popup is dismissed, then the study can start. */</span>
<a href="#l67.430"></a><span id="l67.430" class="difflineminus">-                // closeCallback gets called after cancelCallback, so make sure study isn't already</span>
<a href="#l67.431"></a><span id="l67.431" class="difflineminus">-                // canceled.</span>
<a href="#l67.432"></a><span id="l67.432" class="difflineminus">-                if (task.status &lt; TaskConstants.STATUS_STARTING) {</span>
<a href="#l67.433"></a><span id="l67.433" class="difflineminus">-                  task.changeStatus(TaskConstants.STATUS_STARTING, true);</span>
<a href="#l67.434"></a><span id="l67.434" class="difflineminus">-                  TestPilotSetup.reloadRemoteExperiments();</span>
<a href="#l67.435"></a><span id="l67.435" class="difflineminus">-                }</span>
<a href="#l67.436"></a><span id="l67.436" class="difflineminus">-              }});</span>
<a href="#l67.437"></a><span id="l67.437" class="difflineminus">-            return;</span>
<a href="#l67.438"></a><span id="l67.438" class="difflineminus">-          } else if (task.taskType == TaskConstants.TYPE_SURVEY) {</span>
<a href="#l67.439"></a><span id="l67.439" class="difflineminus">-            this._notifier.showNotification(win, {</span>
<a href="#l67.440"></a><span id="l67.440" class="difflineminus">-	      text: self._stringBundle.formatStringFromName(</span>
<a href="#l67.441"></a><span id="l67.441" class="difflineminus">-		&quot;testpilot.notification.newTestPilotSurvey.message&quot;,</span>
<a href="#l67.442"></a><span id="l67.442" class="difflineminus">-		[task.title], 1),</span>
<a href="#l67.443"></a><span id="l67.443" class="difflineminus">-              title: self._stringBundle.GetStringFromName(</span>
<a href="#l67.444"></a><span id="l67.444" class="difflineminus">-		&quot;testpilot.notification.newTestPilotSurvey&quot;),</span>
<a href="#l67.445"></a><span id="l67.445" class="difflineminus">-	      iconClass: &quot;new-study&quot;,</span>
<a href="#l67.446"></a><span id="l67.446" class="difflineminus">-	      moreInfoLabel: self._stringBundle.GetStringFromName(&quot;testpilot.takeSurvey&quot;),</span>
<a href="#l67.447"></a><span id="l67.447" class="difflineminus">-	      moreInfoCallback: function() { task.loadPage(); }</span>
<a href="#l67.448"></a><span id="l67.448" class="difflineminus">-            });</span>
<a href="#l67.449"></a><span id="l67.449" class="difflineminus">-            task.changeStatus(TaskConstants.STATUS_IN_PROGRESS, true);</span>
<a href="#l67.450"></a><span id="l67.450" class="difflineminus">-            return;</span>
<a href="#l67.451"></a><span id="l67.451" class="difflineminus">-          }</span>
<a href="#l67.452"></a><span id="l67.452" class="difflineminus">-        }</span>
<a href="#l67.453"></a><span id="l67.453" class="difflineminus">-      }</span>
<a href="#l67.454"></a><span id="l67.454" class="difflineminus">-    }</span>
<a href="#l67.455"></a><span id="l67.455" class="difflineminus">-</span>
<a href="#l67.456"></a><span id="l67.456" class="difflineminus">-    // And finally, new experiment results:</span>
<a href="#l67.457"></a><span id="l67.457" class="difflineminus">-    if (this._prefs.getBoolPref(POPUP_SHOW_ON_RESULTS)) {</span>
<a href="#l67.458"></a><span id="l67.458" class="difflineminus">-      for (i = 0; i &lt; this.taskList.length; i++) {</span>
<a href="#l67.459"></a><span id="l67.459" class="difflineminus">-        task = this.taskList[i];</span>
<a href="#l67.460"></a><span id="l67.460" class="difflineminus">-        if (task.taskType == TaskConstants.TYPE_RESULTS &amp;&amp;</span>
<a href="#l67.461"></a><span id="l67.461" class="difflineminus">-            task.status == TaskConstants.STATUS_NEW) {</span>
<a href="#l67.462"></a><span id="l67.462" class="difflineminus">-              self._notifier.showNotification( win, {</span>
<a href="#l67.463"></a><span id="l67.463" class="difflineminus">-	        text: self._stringBundle.formatStringFromName(</span>
<a href="#l67.464"></a><span id="l67.464" class="difflineminus">-	          &quot;testpilot.notification.newTestPilotResults.message&quot;,</span>
<a href="#l67.465"></a><span id="l67.465" class="difflineminus">-	          [task.title], 1),</span>
<a href="#l67.466"></a><span id="l67.466" class="difflineminus">-                title: self._stringBundle.GetStringFromName(</span>
<a href="#l67.467"></a><span id="l67.467" class="difflineminus">-	          &quot;testpilot.notification.newTestPilotResults&quot;),</span>
<a href="#l67.468"></a><span id="l67.468" class="difflineminus">-	        iconClass: &quot;new-results&quot;,</span>
<a href="#l67.469"></a><span id="l67.469" class="difflineminus">-	        moreInfoLabel: self._stringBundle.GetStringFromName(&quot;testpilot.moreInfo&quot;),</span>
<a href="#l67.470"></a><span id="l67.470" class="difflineminus">-                moreInfoCallback: function() { task.loadPage(); }</span>
<a href="#l67.471"></a><span id="l67.471" class="difflineminus">-              });</span>
<a href="#l67.472"></a><span id="l67.472" class="difflineminus">-                // TODO have a &quot;don't tell me about these anymore&quot; option?</span>
<a href="#l67.473"></a><span id="l67.473" class="difflineminus">-              /* Having shown the notification, advance the status of the</span>
<a href="#l67.474"></a><span id="l67.474" class="difflineminus">-               * results, so that this notification won't be shown again */</span>
<a href="#l67.475"></a><span id="l67.475" class="difflineminus">-              task.changeStatus(TaskConstants.STATUS_ARCHIVED, true);</span>
<a href="#l67.476"></a><span id="l67.476" class="difflineminus">-              return;</span>
<a href="#l67.477"></a><span id="l67.477" class="difflineminus">-        }</span>
<a href="#l67.478"></a><span id="l67.478" class="difflineminus">-      }</span>
<a href="#l67.479"></a><span id="l67.479" class="difflineminus">-    }</span>
<a href="#l67.480"></a><span id="l67.480" class="difflineminus">-  },</span>
<a href="#l67.481"></a><span id="l67.481" class="difflineminus">-</span>
<a href="#l67.482"></a><span id="l67.482" class="difflineminus">-  _doHousekeeping: function TPS__doHousekeeping() {</span>
<a href="#l67.483"></a><span id="l67.483" class="difflineminus">-    // check date on all tasks:</span>
<a href="#l67.484"></a><span id="l67.484" class="difflineminus">-    for (let i = 0; i &lt; this.taskList.length; i++) {</span>
<a href="#l67.485"></a><span id="l67.485" class="difflineminus">-      let task = this.taskList[i];</span>
<a href="#l67.486"></a><span id="l67.486" class="difflineminus">-      task.checkDate();</span>
<a href="#l67.487"></a><span id="l67.487" class="difflineminus">-    }</span>
<a href="#l67.488"></a><span id="l67.488" class="difflineminus">-    // Do a full reminder -- but at most once per browser session</span>
<a href="#l67.489"></a><span id="l67.489" class="difflineminus">-    if (!this.didReminderAfterStartup) {</span>
<a href="#l67.490"></a><span id="l67.490" class="difflineminus">-      this._logger.trace(&quot;Doing reminder after startup...&quot;);</span>
<a href="#l67.491"></a><span id="l67.491" class="difflineminus">-      this.didReminderAfterStartup = true;</span>
<a href="#l67.492"></a><span id="l67.492" class="difflineminus">-      this._notifyUserOfTasks();</span>
<a href="#l67.493"></a><span id="l67.493" class="difflineminus">-    }</span>
<a href="#l67.494"></a><span id="l67.494" class="difflineminus">-  },</span>
<a href="#l67.495"></a><span id="l67.495" class="difflineminus">-</span>
<a href="#l67.496"></a><span id="l67.496" class="difflineminus">-  onTaskStatusChanged: function TPS_onTaskStatusChanged() {</span>
<a href="#l67.497"></a><span id="l67.497" class="difflineminus">-    this._notifyUserOfTasks();</span>
<a href="#l67.498"></a><span id="l67.498" class="difflineminus">-  },</span>
<a href="#l67.499"></a><span id="l67.499" class="difflineminus">-</span>
<a href="#l67.500"></a><span id="l67.500" class="difflineminus">-  _onTaskDataAutoSubmitted: function(subject, data) {</span>
<a href="#l67.501"></a><span id="l67.501" class="difflineminus">-    let task = subject;</span>
<a href="#l67.502"></a><span id="l67.502" class="difflineminus">-    this._notifier.showNotification( win, {</span>
<a href="#l67.503"></a><span id="l67.503" class="difflineminus">-      text: self._stringBundle.formatStringFromName(</span>
<a href="#l67.504"></a><span id="l67.504" class="difflineminus">-	&quot;testpilot.notification.autoUploadedData.message&quot;,</span>
<a href="#l67.505"></a><span id="l67.505" class="difflineminus">-	[subject.title], 1),</span>
<a href="#l67.506"></a><span id="l67.506" class="difflineminus">-      title: self._stringBundle.GetStringFromName(</span>
<a href="#l67.507"></a><span id="l67.507" class="difflineminus">-	&quot;testpilot.notification.autoUploadedData&quot;),</span>
<a href="#l67.508"></a><span id="l67.508" class="difflineminus">-      iconClass: &quot;study-submitted&quot;,</span>
<a href="#l67.509"></a><span id="l67.509" class="difflineminus">-      moreInfoText: self._stringBundle.GetStringFromName(&quot;testpilot.notification.seeYourData&quot;),</span>
<a href="#l67.510"></a><span id="l67.510" class="difflineminus">-      moreInfoCallback: function() { task.loadPage(); }</span>
<a href="#l67.511"></a><span id="l67.511" class="difflineminus">-    });</span>
<a href="#l67.512"></a><span id="l67.512" class="difflineminus">-  },</span>
<a href="#l67.513"></a><span id="l67.513" class="difflineminus">-</span>
<a href="#l67.514"></a><span id="l67.514" class="difflineminus">-  getVersion: function TPS_getVersion(callback) {</span>
<a href="#l67.515"></a><span id="l67.515" class="difflineminus">-    // Application.extensions undefined in Firefox 4; will use the new</span>
<a href="#l67.516"></a><span id="l67.516" class="difflineminus">-    // asynchrounous API, store string in this.version, and call the</span>
<a href="#l67.517"></a><span id="l67.517" class="difflineminus">-    // callback when done.</span>
<a href="#l67.518"></a><span id="l67.518" class="difflineminus">-    let self = this;</span>
<a href="#l67.519"></a><span id="l67.519" class="difflineminus">-    if (self.version != &quot;&quot;) {</span>
<a href="#l67.520"></a><span id="l67.520" class="difflineminus">-      if (callback) {</span>
<a href="#l67.521"></a><span id="l67.521" class="difflineminus">-        callback();</span>
<a href="#l67.522"></a><span id="l67.522" class="difflineminus">-      }</span>
<a href="#l67.523"></a><span id="l67.523" class="difflineminus">-    } else {</span>
<a href="#l67.524"></a><span id="l67.524" class="difflineminus">-      Cu.import(&quot;resource://gre/modules/AddonManager.jsm&quot;);</span>
<a href="#l67.525"></a><span id="l67.525" class="difflineminus">-      AddonManager.getAddonByID(EXTENSION_ID, function(addon) {</span>
<a href="#l67.526"></a><span id="l67.526" class="difflineminus">-        self.version = addon.version;</span>
<a href="#l67.527"></a><span id="l67.527" class="difflineminus">-        if (callback) {</span>
<a href="#l67.528"></a><span id="l67.528" class="difflineminus">-          callback();</span>
<a href="#l67.529"></a><span id="l67.529" class="difflineminus">-        }</span>
<a href="#l67.530"></a><span id="l67.530" class="difflineminus">-      });</span>
<a href="#l67.531"></a><span id="l67.531" class="difflineminus">-    }</span>
<a href="#l67.532"></a><span id="l67.532" class="difflineminus">-  },</span>
<a href="#l67.533"></a><span id="l67.533" class="difflineminus">-</span>
<a href="#l67.534"></a><span id="l67.534" class="difflineminus">-  _isNewerThanMe: function TPS__isNewerThanMe(versionString) {</span>
<a href="#l67.535"></a><span id="l67.535" class="difflineminus">-    let result = Services.vc.compare(this.version, versionString);</span>
<a href="#l67.536"></a><span id="l67.536" class="difflineminus">-    if (result &lt; 0) {</span>
<a href="#l67.537"></a><span id="l67.537" class="difflineminus">-      return true; // versionString is newer than my version</span>
<a href="#l67.538"></a><span id="l67.538" class="difflineminus">-    } else {</span>
<a href="#l67.539"></a><span id="l67.539" class="difflineminus">-      return false; // versionString is the same as or older than my version</span>
<a href="#l67.540"></a><span id="l67.540" class="difflineminus">-    }</span>
<a href="#l67.541"></a><span id="l67.541" class="difflineminus">-  },</span>
<a href="#l67.542"></a><span id="l67.542" class="difflineminus">-</span>
<a href="#l67.543"></a><span id="l67.543" class="difflineminus">-  _isNewerThanFirefox: function TPS__isNewerThanFirefox(versionString) {</span>
<a href="#l67.544"></a><span id="l67.544" class="difflineminus">-    let appVersion = Services.appinfo.version;</span>
<a href="#l67.545"></a><span id="l67.545" class="difflineminus">-    let result = Services.vc.compare(appVersion, versionString);</span>
<a href="#l67.546"></a><span id="l67.546" class="difflineminus">-    if (result &lt; 0) {</span>
<a href="#l67.547"></a><span id="l67.547" class="difflineminus">-      return true; // versionString is newer than Firefox</span>
<a href="#l67.548"></a><span id="l67.548" class="difflineminus">-    } else {</span>
<a href="#l67.549"></a><span id="l67.549" class="difflineminus">-      return false; // versionString is the same as or older than Firefox</span>
<a href="#l67.550"></a><span id="l67.550" class="difflineminus">-    }</span>
<a href="#l67.551"></a><span id="l67.551" class="difflineminus">-  },</span>
<a href="#l67.552"></a><span id="l67.552" class="difflineminus">-</span>
<a href="#l67.553"></a><span id="l67.553" class="difflineminus">-  _experimentRequirementsAreMet: function TPS__requirementsMet(experiment) {</span>
<a href="#l67.554"></a><span id="l67.554" class="difflineminus">-    /* Returns true if we we meet the requirements to run this experiment</span>
<a href="#l67.555"></a><span id="l67.555" class="difflineminus">-     * (e.g. meet the minimum Test Pilot version and Firefox version)</span>
<a href="#l67.556"></a><span id="l67.556" class="difflineminus">-     * false if not.</span>
<a href="#l67.557"></a><span id="l67.557" class="difflineminus">-     * Default is always to run the study - return true UNLESS the study</span>
<a href="#l67.558"></a><span id="l67.558" class="difflineminus">-     * specifies a requirement that we don't meet. */</span>
<a href="#l67.559"></a><span id="l67.559" class="difflineminus">-    let logger = this._logger;</span>
<a href="#l67.560"></a><span id="l67.560" class="difflineminus">-    try {</span>
<a href="#l67.561"></a><span id="l67.561" class="difflineminus">-      let minTpVer, minFxVer, expName, runOrNotFunc, randomDeployment;</span>
<a href="#l67.562"></a><span id="l67.562" class="difflineminus">-      /* Could be an experiment, which specifies experimentInfo, or survey,</span>
<a href="#l67.563"></a><span id="l67.563" class="difflineminus">-       * which specifies surveyInfo. */</span>
<a href="#l67.564"></a><span id="l67.564" class="difflineminus">-      let info = experiment.experimentInfo ?</span>
<a href="#l67.565"></a><span id="l67.565" class="difflineminus">-                   experiment.experimentInfo :</span>
<a href="#l67.566"></a><span id="l67.566" class="difflineminus">-                   experiment.surveyInfo;</span>
<a href="#l67.567"></a><span id="l67.567" class="difflineminus">-      if (!info) {</span>
<a href="#l67.568"></a><span id="l67.568" class="difflineminus">-        // If neither one is supplied, study lacks metadata required to run</span>
<a href="#l67.569"></a><span id="l67.569" class="difflineminus">-        logger.warn(&quot;Study lacks minimum metadata to run.&quot;);</span>
<a href="#l67.570"></a><span id="l67.570" class="difflineminus">-        return false;</span>
<a href="#l67.571"></a><span id="l67.571" class="difflineminus">-      }</span>
<a href="#l67.572"></a><span id="l67.572" class="difflineminus">-      minTpVer = info.minTPVersion;</span>
<a href="#l67.573"></a><span id="l67.573" class="difflineminus">-      minFxVer = info.minFXVersion;</span>
<a href="#l67.574"></a><span id="l67.574" class="difflineminus">-      expName =  info.testName;</span>
<a href="#l67.575"></a><span id="l67.575" class="difflineminus">-      runOrNotFunc = info.runOrNotFunc;</span>
<a href="#l67.576"></a><span id="l67.576" class="difflineminus">-      randomDeployment = info.randomDeployment;</span>
<a href="#l67.577"></a><span id="l67.577" class="difflineminus">-</span>
<a href="#l67.578"></a><span id="l67.578" class="difflineminus">-      // Minimum test pilot version:</span>
<a href="#l67.579"></a><span id="l67.579" class="difflineminus">-      if (minTpVer &amp;&amp; this._isNewerThanMe(minTpVer)) {</span>
<a href="#l67.580"></a><span id="l67.580" class="difflineminus">-        logger.warn(&quot;Not loading &quot; + expName);</span>
<a href="#l67.581"></a><span id="l67.581" class="difflineminus">-        logger.warn(&quot;Because it requires Test Pilot version &quot; + minTpVer);</span>
<a href="#l67.582"></a><span id="l67.582" class="difflineminus">-        return false;</span>
<a href="#l67.583"></a><span id="l67.583" class="difflineminus">-      }</span>
<a href="#l67.584"></a><span id="l67.584" class="difflineminus">-</span>
<a href="#l67.585"></a><span id="l67.585" class="difflineminus">-      // Minimum firefox version:</span>
<a href="#l67.586"></a><span id="l67.586" class="difflineminus">-      if (minFxVer &amp;&amp; this._isNewerThanFirefox(minFxVer)) {</span>
<a href="#l67.587"></a><span id="l67.587" class="difflineminus">-        logger.warn(&quot;Not loading &quot; + expName);</span>
<a href="#l67.588"></a><span id="l67.588" class="difflineminus">-        logger.warn(&quot;Because it requires Firefox version &quot; + minFxVer);</span>
<a href="#l67.589"></a><span id="l67.589" class="difflineminus">-        return false;</span>
<a href="#l67.590"></a><span id="l67.590" class="difflineminus">-      }</span>
<a href="#l67.591"></a><span id="l67.591" class="difflineminus">-</span>
<a href="#l67.592"></a><span id="l67.592" class="difflineminus">-      // Random deployment (used to give study to random subsample of users)</span>
<a href="#l67.593"></a><span id="l67.593" class="difflineminus">-      if (randomDeployment) {</span>
<a href="#l67.594"></a><span id="l67.594" class="difflineminus">-        /* Roll a hundred-sided die. Remember what we roll for later reference.  A study</span>
<a href="#l67.595"></a><span id="l67.595" class="difflineminus">-         * using random subsample deployment will provide a range (say, 0 ~ 30) which means</span>
<a href="#l67.596"></a><span id="l67.596" class="difflineminus">-         * only users who roll within that range will run the study. */</span>
<a href="#l67.597"></a><span id="l67.597" class="difflineminus">-        let prefName = RANDOM_DEPLOY_PREFIX + &quot;.&quot; + randomDeployment.rolloutCode;</span>
<a href="#l67.598"></a><span id="l67.598" class="difflineminus">-        if (!this._prefs.prefHasUserValue(prefName)) {</span>
<a href="#l67.599"></a><span id="l67.599" class="difflineminus">-          let myRoll = Math.floor(Math.random()*100);</span>
<a href="#l67.600"></a><span id="l67.600" class="difflineminus">-          this._prefs.setIntPref(prefName, myRoll);</span>
<a href="#l67.601"></a><span id="l67.601" class="difflineminus">-        } else {</span>
<a href="#l67.602"></a><span id="l67.602" class="difflineminus">-          let myRoll = this._prefs.getIntPref(prefName);</span>
<a href="#l67.603"></a><span id="l67.603" class="difflineminus">-          if (myRoll &lt; randomDeployment.minRoll) {</span>
<a href="#l67.604"></a><span id="l67.604" class="difflineminus">-            return false;</span>
<a href="#l67.605"></a><span id="l67.605" class="difflineminus">-          }</span>
<a href="#l67.606"></a><span id="l67.606" class="difflineminus">-          if (myRoll &gt; randomDeployment.maxRoll) {</span>
<a href="#l67.607"></a><span id="l67.607" class="difflineminus">-            return false;</span>
<a href="#l67.608"></a><span id="l67.608" class="difflineminus">-          }</span>
<a href="#l67.609"></a><span id="l67.609" class="difflineminus">-        }</span>
<a href="#l67.610"></a><span id="l67.610" class="difflineminus">-      }</span>
<a href="#l67.611"></a><span id="l67.611" class="difflineminus">-</span>
<a href="#l67.612"></a><span id="l67.612" class="difflineminus">-      /* The all-purpose, arbitrary code &quot;Should this study run?&quot; function - if</span>
<a href="#l67.613"></a><span id="l67.613" class="difflineminus">-       * provided, use its return value. */</span>
<a href="#l67.614"></a><span id="l67.614" class="difflineminus">-      if (runOrNotFunc) {</span>
<a href="#l67.615"></a><span id="l67.615" class="difflineminus">-        return runOrNotFunc();</span>
<a href="#l67.616"></a><span id="l67.616" class="difflineminus">-      }</span>
<a href="#l67.617"></a><span id="l67.617" class="difflineminus">-    } catch (e) {</span>
<a href="#l67.618"></a><span id="l67.618" class="difflineminus">-      logger.warn(&quot;Error in requirements check &quot; +  e);</span>
<a href="#l67.619"></a><span id="l67.619" class="difflineminus">-    }</span>
<a href="#l67.620"></a><span id="l67.620" class="difflineminus">-    return true;</span>
<a href="#l67.621"></a><span id="l67.621" class="difflineminus">-  },</span>
<a href="#l67.622"></a><span id="l67.622" class="difflineminus">-</span>
<a href="#l67.623"></a><span id="l67.623" class="difflineminus">-  _shouldOpenTabs: function TPS__shouldOpenTabs() {</span>
<a href="#l67.624"></a><span id="l67.624" class="difflineminus">-    // For Thunderbird, we don't want the Test Pilot tab spawning, since</span>
<a href="#l67.625"></a><span id="l67.625" class="difflineminus">-    // we're bundling Test Pilot in the release.</span>
<a href="#l67.626"></a><span id="l67.626" class="difflineminus">-    return !(this._appID == THUNDERBIRD_APP_ID);</span>
<a href="#l67.627"></a><span id="l67.627" class="difflineminus">-  },</span>
<a href="#l67.628"></a><span id="l67.628" class="difflineminus">-</span>
<a href="#l67.629"></a><span id="l67.629" class="difflineminus">-  checkForTasks: function TPS_checkForTasks(callback) {</span>
<a href="#l67.630"></a><span id="l67.630" class="difflineminus">-    let logger = this._logger;</span>
<a href="#l67.631"></a><span id="l67.631" class="difflineminus">-    if (! this._remoteExperimentLoader ) {</span>
<a href="#l67.632"></a><span id="l67.632" class="difflineminus">-      logger.trace(&quot;Now requiring remote experiment loader:&quot;);</span>
<a href="#l67.633"></a><span id="l67.633" class="difflineminus">-      let remoteLoaderModule = this._loader.require(&quot;remote-experiment-loader&quot;);</span>
<a href="#l67.634"></a><span id="l67.634" class="difflineminus">-      logger.trace(&quot;Now instantiating remoteExperimentLoader:&quot;);</span>
<a href="#l67.635"></a><span id="l67.635" class="difflineminus">-      let rel = new remoteLoaderModule.RemoteExperimentLoader(this._logRepo);</span>
<a href="#l67.636"></a><span id="l67.636" class="difflineminus">-      this._remoteExperimentLoader = rel;</span>
<a href="#l67.637"></a><span id="l67.637" class="difflineminus">-    }</span>
<a href="#l67.638"></a><span id="l67.638" class="difflineminus">-</span>
<a href="#l67.639"></a><span id="l67.639" class="difflineminus">-    let self = this;</span>
<a href="#l67.640"></a><span id="l67.640" class="difflineminus">-    this._remoteExperimentLoader.checkForUpdates(</span>
<a href="#l67.641"></a><span id="l67.641" class="difflineminus">-      function(success) {</span>
<a href="#l67.642"></a><span id="l67.642" class="difflineminus">-        logger.info(&quot;Getting updated experiments... Success? &quot; + success);</span>
<a href="#l67.643"></a><span id="l67.643" class="difflineminus">-        // Actually, we do exactly the same thing whether we succeeded in</span>
<a href="#l67.644"></a><span id="l67.644" class="difflineminus">-        // downloading new contents or not...</span>
<a href="#l67.645"></a><span id="l67.645" class="difflineminus">-        let experiments = self._remoteExperimentLoader.getExperiments();</span>
<a href="#l67.646"></a><span id="l67.646" class="difflineminus">-</span>
<a href="#l67.647"></a><span id="l67.647" class="difflineminus">-        for (let filename in experiments) {</span>
<a href="#l67.648"></a><span id="l67.648" class="difflineminus">-          if (!self._experimentRequirementsAreMet(experiments[filename])) {</span>
<a href="#l67.649"></a><span id="l67.649" class="difflineminus">-            continue;</span>
<a href="#l67.650"></a><span id="l67.650" class="difflineminus">-          }</span>
<a href="#l67.651"></a><span id="l67.651" class="difflineminus">-          try {</span>
<a href="#l67.652"></a><span id="l67.652" class="difflineminus">-            // The try-catch ensures that if something goes wrong in loading one</span>
<a href="#l67.653"></a><span id="l67.653" class="difflineminus">-            // experiment, the other experiments after that one still get loaded.</span>
<a href="#l67.654"></a><span id="l67.654" class="difflineminus">-            logger.trace(&quot;Attempting to load experiment &quot; + filename);</span>
<a href="#l67.655"></a><span id="l67.655" class="difflineminus">-</span>
<a href="#l67.656"></a><span id="l67.656" class="difflineminus">-            let task;</span>
<a href="#l67.657"></a><span id="l67.657" class="difflineminus">-            // Could be a survey: check if surveyInfo is exported:</span>
<a href="#l67.658"></a><span id="l67.658" class="difflineminus">-            if (experiments[filename].surveyInfo != undefined) {</span>
<a href="#l67.659"></a><span id="l67.659" class="difflineminus">-              let sInfo = experiments[filename].surveyInfo;</span>
<a href="#l67.660"></a><span id="l67.660" class="difflineminus">-              // If it supplies questions, it's a built-in survey.</span>
<a href="#l67.661"></a><span id="l67.661" class="difflineminus">-              // If not, it's a web-based survey.</span>
<a href="#l67.662"></a><span id="l67.662" class="difflineminus">-              if (!sInfo.surveyQuestions) {</span>
<a href="#l67.663"></a><span id="l67.663" class="difflineminus">-                task = new self._taskModule.TestPilotWebSurvey(sInfo);</span>
<a href="#l67.664"></a><span id="l67.664" class="difflineminus">-              } else {</span>
<a href="#l67.665"></a><span id="l67.665" class="difflineminus">-                task = new self._taskModule.TestPilotBuiltinSurvey(sInfo);</span>
<a href="#l67.666"></a><span id="l67.666" class="difflineminus">-              }</span>
<a href="#l67.667"></a><span id="l67.667" class="difflineminus">-            } else {</span>
<a href="#l67.668"></a><span id="l67.668" class="difflineminus">-              // This one must be an experiment.</span>
<a href="#l67.669"></a><span id="l67.669" class="difflineminus">-              let expInfo = experiments[filename].experimentInfo;</span>
<a href="#l67.670"></a><span id="l67.670" class="difflineminus">-              let dsInfo = experiments[filename].dataStoreInfo;</span>
<a href="#l67.671"></a><span id="l67.671" class="difflineminus">-              let dataStore = new self._dataStoreModule.ExperimentDataStore(</span>
<a href="#l67.672"></a><span id="l67.672" class="difflineminus">-                dsInfo.fileName, dsInfo.tableName, dsInfo.columns );</span>
<a href="#l67.673"></a><span id="l67.673" class="difflineminus">-              let webContent = experiments[filename].webContent;</span>
<a href="#l67.674"></a><span id="l67.674" class="difflineminus">-              task = new self._taskModule.TestPilotExperiment(expInfo,</span>
<a href="#l67.675"></a><span id="l67.675" class="difflineminus">-                                                              dataStore,</span>
<a href="#l67.676"></a><span id="l67.676" class="difflineminus">-                                                              experiments[filename].handlers,</span>
<a href="#l67.677"></a><span id="l67.677" class="difflineminus">-                                                              webContent);</span>
<a href="#l67.678"></a><span id="l67.678" class="difflineminus">-            }</span>
<a href="#l67.679"></a><span id="l67.679" class="difflineminus">-            self.addTask(task);</span>
<a href="#l67.680"></a><span id="l67.680" class="difflineminus">-            logger.info(&quot;Loaded task &quot; + filename);</span>
<a href="#l67.681"></a><span id="l67.681" class="difflineminus">-          } catch (e) {</span>
<a href="#l67.682"></a><span id="l67.682" class="difflineminus">-            logger.warn(&quot;Failed to load task &quot; + filename + &quot;: &quot; + e);</span>
<a href="#l67.683"></a><span id="l67.683" class="difflineminus">-          }</span>
<a href="#l67.684"></a><span id="l67.684" class="difflineminus">-        } // end for filename in experiments</span>
<a href="#l67.685"></a><span id="l67.685" class="difflineminus">-</span>
<a href="#l67.686"></a><span id="l67.686" class="difflineminus">-        // Handling new results is much simpler:</span>
<a href="#l67.687"></a><span id="l67.687" class="difflineminus">-        let results = self._remoteExperimentLoader.getStudyResults();</span>
<a href="#l67.688"></a><span id="l67.688" class="difflineminus">-        for (let r in results) {</span>
<a href="#l67.689"></a><span id="l67.689" class="difflineminus">-          let studyResult = new self._taskModule.TestPilotStudyResults(results[r]);</span>
<a href="#l67.690"></a><span id="l67.690" class="difflineminus">-          self.addTask(studyResult);</span>
<a href="#l67.691"></a><span id="l67.691" class="difflineminus">-        }</span>
<a href="#l67.692"></a><span id="l67.692" class="difflineminus">-</span>
<a href="#l67.693"></a><span id="l67.693" class="difflineminus">-        /* Legacy studies = stuff we no longer have the code for, but</span>
<a href="#l67.694"></a><span id="l67.694" class="difflineminus">-         * if the user participated in it we want to keep that metadata. */</span>
<a href="#l67.695"></a><span id="l67.695" class="difflineminus">-        let legacyStudies = self._remoteExperimentLoader.getLegacyStudies();</span>
<a href="#l67.696"></a><span id="l67.696" class="difflineminus">-        for (let l in legacyStudies) {</span>
<a href="#l67.697"></a><span id="l67.697" class="difflineminus">-          let legacyStudy = new self._taskModule.TestPilotLegacyStudy(legacyStudies[l]);</span>
<a href="#l67.698"></a><span id="l67.698" class="difflineminus">-          self.addTask(legacyStudy);</span>
<a href="#l67.699"></a><span id="l67.699" class="difflineminus">-        }</span>
<a href="#l67.700"></a><span id="l67.700" class="difflineminus">-</span>
<a href="#l67.701"></a><span id="l67.701" class="difflineminus">-        if (callback) {</span>
<a href="#l67.702"></a><span id="l67.702" class="difflineminus">-          callback();</span>
<a href="#l67.703"></a><span id="l67.703" class="difflineminus">-        }</span>
<a href="#l67.704"></a><span id="l67.704" class="difflineminus">-      }</span>
<a href="#l67.705"></a><span id="l67.705" class="difflineminus">-    );</span>
<a href="#l67.706"></a><span id="l67.706" class="difflineminus">-  },</span>
<a href="#l67.707"></a><span id="l67.707" class="difflineminus">-</span>
<a href="#l67.708"></a><span id="l67.708" class="difflineminus">-  reloadRemoteExperiments: function TPS_reloadRemoteExperiments(callback) {</span>
<a href="#l67.709"></a><span id="l67.709" class="difflineminus">-    for (let i = 0; i &lt; this.taskList.length; i++) {</span>
<a href="#l67.710"></a><span id="l67.710" class="difflineminus">-      this.taskList[i].onExperimentShutdown();</span>
<a href="#l67.711"></a><span id="l67.711" class="difflineminus">-    }</span>
<a href="#l67.712"></a><span id="l67.712" class="difflineminus">-</span>
<a href="#l67.713"></a><span id="l67.713" class="difflineminus">-    this.taskList = [];</span>
<a href="#l67.714"></a><span id="l67.714" class="difflineminus">-    this._loader.unload();</span>
<a href="#l67.715"></a><span id="l67.715" class="difflineminus">-</span>
<a href="#l67.716"></a><span id="l67.716" class="difflineminus">-    this.checkForTasks(callback);</span>
<a href="#l67.717"></a><span id="l67.717" class="difflineminus">-  },</span>
<a href="#l67.718"></a><span id="l67.718" class="difflineminus">-</span>
<a href="#l67.719"></a><span id="l67.719" class="difflineminus">-  getTaskById: function TPS_getTaskById(id) {</span>
<a href="#l67.720"></a><span id="l67.720" class="difflineminus">-    for (let i = 0; i &lt; this.taskList.length; i++) {</span>
<a href="#l67.721"></a><span id="l67.721" class="difflineminus">-      let task = this.taskList[i];</span>
<a href="#l67.722"></a><span id="l67.722" class="difflineminus">-      if (task.id == id) {</span>
<a href="#l67.723"></a><span id="l67.723" class="difflineminus">-	return task;</span>
<a href="#l67.724"></a><span id="l67.724" class="difflineminus">-      }</span>
<a href="#l67.725"></a><span id="l67.725" class="difflineminus">-    }</span>
<a href="#l67.726"></a><span id="l67.726" class="difflineminus">-    return null;</span>
<a href="#l67.727"></a><span id="l67.727" class="difflineminus">-  },</span>
<a href="#l67.728"></a><span id="l67.728" class="difflineminus">-</span>
<a href="#l67.729"></a><span id="l67.729" class="difflineminus">-  getAllTasks: function TPS_getAllTasks() {</span>
<a href="#l67.730"></a><span id="l67.730" class="difflineminus">-    return this.taskList;</span>
<a href="#l67.731"></a><span id="l67.731" class="difflineminus">-  }</span>
<a href="#l67.732"></a><span id="l67.732" class="difflineminus">-};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l68.1"></a><span id="l68.1">deleted file mode 100644</span>
<a href="#l68.2"></a><span id="l68.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/string_sanitizer.js</span>
<a href="#l68.3"></a><span id="l68.3" class="difflineplus">+++ /dev/null</span>
<a href="#l68.4"></a><span id="l68.4" class="difflineat">@@ -1,23 +0,0 @@</span>
<a href="#l68.5"></a><span id="l68.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l68.6"></a><span id="l68.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l68.7"></a><span id="l68.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l68.8"></a><span id="l68.8" class="difflineminus">-</span>
<a href="#l68.9"></a><span id="l68.9" class="difflineminus">-EXPORTED_SYMBOLS = [&quot;sanitizeString&quot;, &quot;sanitizeJSONStrings&quot;];</span>
<a href="#l68.10"></a><span id="l68.10" class="difflineminus">-</span>
<a href="#l68.11"></a><span id="l68.11" class="difflineminus">-function sanitizeString(input) {</span>
<a href="#l68.12"></a><span id="l68.12" class="difflineminus">-  // Only allow alphanumerics, space, period, hypen, and underscore.</span>
<a href="#l68.13"></a><span id="l68.13" class="difflineminus">-  // Replace any other characters with question mark.</span>
<a href="#l68.14"></a><span id="l68.14" class="difflineminus">-  return input.replace(/[^a-zA-Z0-9 .\-_]/g, '?');</span>
<a href="#l68.15"></a><span id="l68.15" class="difflineminus">-}</span>
<a href="#l68.16"></a><span id="l68.16" class="difflineminus">-</span>
<a href="#l68.17"></a><span id="l68.17" class="difflineminus">-function sanitizeJSONStrings(jsonBlob) {</span>
<a href="#l68.18"></a><span id="l68.18" class="difflineminus">-  // recursively goes through json and sanitizes every string it finds</span>
<a href="#l68.19"></a><span id="l68.19" class="difflineminus">-  for (let x in jsonBlob) {</span>
<a href="#l68.20"></a><span id="l68.20" class="difflineminus">-    if (typeof jsonBlob[x] == &quot;string&quot;) {</span>
<a href="#l68.21"></a><span id="l68.21" class="difflineminus">-      jsonBlob[x] = sanitizeString(jsonBlob[x]);</span>
<a href="#l68.22"></a><span id="l68.22" class="difflineminus">-    } else if (typeof jsonBlob[x] == &quot;object&quot;) {</span>
<a href="#l68.23"></a><span id="l68.23" class="difflineminus">-      jsonBlob[x] = sanitizeJSONStrings(jsonBlob[x]);</span>
<a href="#l68.24"></a><span id="l68.24" class="difflineminus">-    }</span>
<a href="#l68.25"></a><span id="l68.25" class="difflineminus">-  }</span>
<a href="#l68.26"></a><span id="l68.26" class="difflineminus">-  return jsonBlob;</span>
<a href="#l68.27"></a><span id="l68.27" class="difflineminus">-}</span>
<a href="#l68.28"></a><span id="l68.28">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l69.1"></a><span id="l69.1">deleted file mode 100644</span>
<a href="#l69.2"></a><span id="l69.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/modules/tasks.js</span>
<a href="#l69.3"></a><span id="l69.3" class="difflineplus">+++ /dev/null</span>
<a href="#l69.4"></a><span id="l69.4" class="difflineat">@@ -1,1214 +0,0 @@</span>
<a href="#l69.5"></a><span id="l69.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l69.6"></a><span id="l69.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l69.7"></a><span id="l69.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l69.8"></a><span id="l69.8" class="difflineminus">-</span>
<a href="#l69.9"></a><span id="l69.9" class="difflineminus">-EXPORTED_SYMBOLS = [&quot;TaskConstants&quot;, &quot;TestPilotBuiltinSurvey&quot;,</span>
<a href="#l69.10"></a><span id="l69.10" class="difflineminus">-                    &quot;TestPilotExperiment&quot;, &quot;TestPilotStudyResults&quot;,</span>
<a href="#l69.11"></a><span id="l69.11" class="difflineminus">-                    &quot;TestPilotLegacyStudy&quot;, &quot;TestPilotWebSurvey&quot;];</span>
<a href="#l69.12"></a><span id="l69.12" class="difflineminus">-</span>
<a href="#l69.13"></a><span id="l69.13" class="difflineminus">-const Cc = Components.classes;</span>
<a href="#l69.14"></a><span id="l69.14" class="difflineminus">-const Ci = Components.interfaces;</span>
<a href="#l69.15"></a><span id="l69.15" class="difflineminus">-</span>
<a href="#l69.16"></a><span id="l69.16" class="difflineminus">-Components.utils.import(&quot;resource://testpilot/modules/Observers.js&quot;);</span>
<a href="#l69.17"></a><span id="l69.17" class="difflineminus">-Components.utils.import(&quot;resource://testpilot/modules/metadata.js&quot;);</span>
<a href="#l69.18"></a><span id="l69.18" class="difflineminus">-Components.utils.import(&quot;resource://testpilot/modules/log4moz.js&quot;);</span>
<a href="#l69.19"></a><span id="l69.19" class="difflineminus">-Components.utils.import(&quot;resource://testpilot/modules/string_sanitizer.js&quot;);</span>
<a href="#l69.20"></a><span id="l69.20" class="difflineminus">-</span>
<a href="#l69.21"></a><span id="l69.21" class="difflineminus">-const STATUS_PREF_PREFIX = &quot;extensions.testpilot.taskstatus.&quot;;</span>
<a href="#l69.22"></a><span id="l69.22" class="difflineminus">-const START_DATE_PREF_PREFIX = &quot;extensions.testpilot.startDate.&quot;;</span>
<a href="#l69.23"></a><span id="l69.23" class="difflineminus">-const RECUR_PREF_PREFIX = &quot;extensions.testpilot.reSubmit.&quot;;</span>
<a href="#l69.24"></a><span id="l69.24" class="difflineminus">-const RECUR_TIMES_PREF_PREFIX = &quot;extensions.testpilot.recurCount.&quot;;</span>
<a href="#l69.25"></a><span id="l69.25" class="difflineminus">-const SURVEY_ANSWER_PREFIX = &quot;extensions.testpilot.surveyAnswers.&quot;;</span>
<a href="#l69.26"></a><span id="l69.26" class="difflineminus">-const EXPIRATION_DATE_FOR_DATA_SUBMISSION_PREFIX =</span>
<a href="#l69.27"></a><span id="l69.27" class="difflineminus">-  &quot;extensions.testpilot.expirationDateForDataSubmission.&quot;;</span>
<a href="#l69.28"></a><span id="l69.28" class="difflineminus">-const DATE_FOR_DATA_DELETION_PREFIX =</span>
<a href="#l69.29"></a><span id="l69.29" class="difflineminus">-  &quot;extensions.testpilot.dateForDataDeletion.&quot;;</span>
<a href="#l69.30"></a><span id="l69.30" class="difflineminus">-const GUID_PREF_PREFIX = &quot;extensions.testpilot.taskGUID.&quot;;</span>
<a href="#l69.31"></a><span id="l69.31" class="difflineminus">-const RETRY_INTERVAL_PREF = &quot;extensions.testpilot.uploadRetryInterval&quot;;</span>
<a href="#l69.32"></a><span id="l69.32" class="difflineminus">-const TIME_FOR_DATA_DELETION = 7 * (24 * 60 * 60 * 1000); // 7 days</span>
<a href="#l69.33"></a><span id="l69.33" class="difflineminus">-const DATA_UPLOAD_PREF = &quot;extensions.testpilot.dataUploadURL&quot;;</span>
<a href="#l69.34"></a><span id="l69.34" class="difflineminus">-const DEFAULT_THUMBNAIL_URL = &quot;chrome://testpilot/skin/badge-default.png&quot;;</span>
<a href="#l69.35"></a><span id="l69.35" class="difflineminus">-</span>
<a href="#l69.36"></a><span id="l69.36" class="difflineminus">-</span>
<a href="#l69.37"></a><span id="l69.37" class="difflineminus">-const TaskConstants = {</span>
<a href="#l69.38"></a><span id="l69.38" class="difflineminus">-  // TODO status RESULTS and ARCHIVED don't make sense for studies anymore;</span>
<a href="#l69.39"></a><span id="l69.39" class="difflineminus">-  // we need a status MISSED and a status EXPIRED.  (can you be cancelled and</span>
<a href="#l69.40"></a><span id="l69.40" class="difflineminus">-  // expired?)</span>
<a href="#l69.41"></a><span id="l69.41" class="difflineminus">- STATUS_NEW: 0, // It's new and you haven't seen it yet.</span>
<a href="#l69.42"></a><span id="l69.42" class="difflineminus">- STATUS_PENDING : 1,  // You've seen it but it hasn't started.</span>
<a href="#l69.43"></a><span id="l69.43" class="difflineminus">- STATUS_STARTING: 2,  // Data collection started but notification not shown.</span>
<a href="#l69.44"></a><span id="l69.44" class="difflineminus">- STATUS_IN_PROGRESS : 3, // Started and notification shown.</span>
<a href="#l69.45"></a><span id="l69.45" class="difflineminus">- STATUS_FINISHED : 4, // Finished and awaiting your choice.</span>
<a href="#l69.46"></a><span id="l69.46" class="difflineminus">- STATUS_CANCELLED : 5, // You've opted out and not submitted anything.</span>
<a href="#l69.47"></a><span id="l69.47" class="difflineminus">- STATUS_SUBMITTED : 6, // You've submitted your data.</span>
<a href="#l69.48"></a><span id="l69.48" class="difflineminus">- STATUS_RESULTS : 7, // Test finished AND final results visible somewhere, deprecated</span>
<a href="#l69.49"></a><span id="l69.49" class="difflineminus">- STATUS_ARCHIVED: 8, // Results seen.  Deprecated. TODO: or use for expired?</span>
<a href="#l69.50"></a><span id="l69.50" class="difflineminus">- STATUS_MISSED: 9, // You never ran this study.</span>
<a href="#l69.51"></a><span id="l69.51" class="difflineminus">-</span>
<a href="#l69.52"></a><span id="l69.52" class="difflineminus">- TYPE_EXPERIMENT : 1,</span>
<a href="#l69.53"></a><span id="l69.53" class="difflineminus">- TYPE_SURVEY : 2,</span>
<a href="#l69.54"></a><span id="l69.54" class="difflineminus">- TYPE_RESULTS : 3,</span>
<a href="#l69.55"></a><span id="l69.55" class="difflineminus">- TYPE_LEGACY: 4,</span>
<a href="#l69.56"></a><span id="l69.56" class="difflineminus">-</span>
<a href="#l69.57"></a><span id="l69.57" class="difflineminus">- ALWAYS_SUBMIT: 1,</span>
<a href="#l69.58"></a><span id="l69.58" class="difflineminus">- NEVER_SUBMIT: -1,</span>
<a href="#l69.59"></a><span id="l69.59" class="difflineminus">- ASK_EACH_TIME: 0</span>
<a href="#l69.60"></a><span id="l69.60" class="difflineminus">-};</span>
<a href="#l69.61"></a><span id="l69.61" class="difflineminus">-/* Note that experiments use all 9 status codes, but surveys don't have a</span>
<a href="#l69.62"></a><span id="l69.62" class="difflineminus">- * data collection period so they are never STARTING or IN_PROGRESS or</span>
<a href="#l69.63"></a><span id="l69.63" class="difflineminus">- * FINISHED, they go straight from PENDING to SUBMITTED or CANCELED. */</span>
<a href="#l69.64"></a><span id="l69.64" class="difflineminus">-</span>
<a href="#l69.65"></a><span id="l69.65" class="difflineminus">-// Prototype for both TestPilotSurvey and TestPilotExperiment.</span>
<a href="#l69.66"></a><span id="l69.66" class="difflineminus">-var TestPilotTask = {</span>
<a href="#l69.67"></a><span id="l69.67" class="difflineminus">-  _id: null,</span>
<a href="#l69.68"></a><span id="l69.68" class="difflineminus">-  _title: null,</span>
<a href="#l69.69"></a><span id="l69.69" class="difflineminus">-  _status: null,</span>
<a href="#l69.70"></a><span id="l69.70" class="difflineminus">-  _url: null,</span>
<a href="#l69.71"></a><span id="l69.71" class="difflineminus">-</span>
<a href="#l69.72"></a><span id="l69.72" class="difflineminus">-  __prefs: null,</span>
<a href="#l69.73"></a><span id="l69.73" class="difflineminus">-  get _prefs() {</span>
<a href="#l69.74"></a><span id="l69.74" class="difflineminus">-    this.__prefs = Cc[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l69.75"></a><span id="l69.75" class="difflineminus">-      .getService(Ci.nsIPrefBranch);</span>
<a href="#l69.76"></a><span id="l69.76" class="difflineminus">-    return this.__prefs;</span>
<a href="#l69.77"></a><span id="l69.77" class="difflineminus">-  },</span>
<a href="#l69.78"></a><span id="l69.78" class="difflineminus">-</span>
<a href="#l69.79"></a><span id="l69.79" class="difflineminus">-  _taskInit: function TestPilotTask__taskInit(id, title, url, summary, thumb) {</span>
<a href="#l69.80"></a><span id="l69.80" class="difflineminus">-    this._id = id;</span>
<a href="#l69.81"></a><span id="l69.81" class="difflineminus">-    this._title = title;</span>
<a href="#l69.82"></a><span id="l69.82" class="difflineminus">-    let prefName = STATUS_PREF_PREFIX + this._id;</span>
<a href="#l69.83"></a><span id="l69.83" class="difflineminus">-    if (this._prefs.prefHasUserValue(prefName)) {</span>
<a href="#l69.84"></a><span id="l69.84" class="difflineminus">-      this._status = this._prefs.getIntPref(prefName);</span>
<a href="#l69.85"></a><span id="l69.85" class="difflineminus">-    } else {</span>
<a href="#l69.86"></a><span id="l69.86" class="difflineminus">-      this._status = TaskConstants.STATUS_NEW;</span>
<a href="#l69.87"></a><span id="l69.87" class="difflineminus">-    }</span>
<a href="#l69.88"></a><span id="l69.88" class="difflineminus">-    this._url = url;</span>
<a href="#l69.89"></a><span id="l69.89" class="difflineminus">-    this._summary = summary;</span>
<a href="#l69.90"></a><span id="l69.90" class="difflineminus">-    this._thumbnail = thumb;</span>
<a href="#l69.91"></a><span id="l69.91" class="difflineminus">-    this._logger = Log4Moz.repository.getLogger(&quot;TestPilot.Task_&quot;+this._id);</span>
<a href="#l69.92"></a><span id="l69.92" class="difflineminus">-  },</span>
<a href="#l69.93"></a><span id="l69.93" class="difflineminus">-</span>
<a href="#l69.94"></a><span id="l69.94" class="difflineminus">-  get title() {</span>
<a href="#l69.95"></a><span id="l69.95" class="difflineminus">-    return this._title;</span>
<a href="#l69.96"></a><span id="l69.96" class="difflineminus">-  },</span>
<a href="#l69.97"></a><span id="l69.97" class="difflineminus">-</span>
<a href="#l69.98"></a><span id="l69.98" class="difflineminus">-  get id() {</span>
<a href="#l69.99"></a><span id="l69.99" class="difflineminus">-    return this._id;</span>
<a href="#l69.100"></a><span id="l69.100" class="difflineminus">-  },</span>
<a href="#l69.101"></a><span id="l69.101" class="difflineminus">-</span>
<a href="#l69.102"></a><span id="l69.102" class="difflineminus">-  get version() {</span>
<a href="#l69.103"></a><span id="l69.103" class="difflineminus">-    return this._versionNumber;</span>
<a href="#l69.104"></a><span id="l69.104" class="difflineminus">-  },</span>
<a href="#l69.105"></a><span id="l69.105" class="difflineminus">-</span>
<a href="#l69.106"></a><span id="l69.106" class="difflineminus">-  get taskType() {</span>
<a href="#l69.107"></a><span id="l69.107" class="difflineminus">-    return null;</span>
<a href="#l69.108"></a><span id="l69.108" class="difflineminus">-  },</span>
<a href="#l69.109"></a><span id="l69.109" class="difflineminus">-</span>
<a href="#l69.110"></a><span id="l69.110" class="difflineminus">-  get status() {</span>
<a href="#l69.111"></a><span id="l69.111" class="difflineminus">-    return this._status;</span>
<a href="#l69.112"></a><span id="l69.112" class="difflineminus">-  },</span>
<a href="#l69.113"></a><span id="l69.113" class="difflineminus">-</span>
<a href="#l69.114"></a><span id="l69.114" class="difflineminus">-  get webContent() {</span>
<a href="#l69.115"></a><span id="l69.115" class="difflineminus">-    return this._webContent;</span>
<a href="#l69.116"></a><span id="l69.116" class="difflineminus">-  },</span>
<a href="#l69.117"></a><span id="l69.117" class="difflineminus">-</span>
<a href="#l69.118"></a><span id="l69.118" class="difflineminus">-  get summary() {</span>
<a href="#l69.119"></a><span id="l69.119" class="difflineminus">-    if (this._summary) {</span>
<a href="#l69.120"></a><span id="l69.120" class="difflineminus">-      return this._summary;</span>
<a href="#l69.121"></a><span id="l69.121" class="difflineminus">-    } else {</span>
<a href="#l69.122"></a><span id="l69.122" class="difflineminus">-      return this._title;</span>
<a href="#l69.123"></a><span id="l69.123" class="difflineminus">-    }</span>
<a href="#l69.124"></a><span id="l69.124" class="difflineminus">-  },</span>
<a href="#l69.125"></a><span id="l69.125" class="difflineminus">-</span>
<a href="#l69.126"></a><span id="l69.126" class="difflineminus">-  get thumbnail() {</span>
<a href="#l69.127"></a><span id="l69.127" class="difflineminus">-    if (this._thumbnail) {</span>
<a href="#l69.128"></a><span id="l69.128" class="difflineminus">-      return this._thumbnail;</span>
<a href="#l69.129"></a><span id="l69.129" class="difflineminus">-    } else {</span>
<a href="#l69.130"></a><span id="l69.130" class="difflineminus">-      return DEFAULT_THUMBNAIL_URL;</span>
<a href="#l69.131"></a><span id="l69.131" class="difflineminus">-    }</span>
<a href="#l69.132"></a><span id="l69.132" class="difflineminus">-  },</span>
<a href="#l69.133"></a><span id="l69.133" class="difflineminus">-</span>
<a href="#l69.134"></a><span id="l69.134" class="difflineminus">-  // urls:</span>
<a href="#l69.135"></a><span id="l69.135" class="difflineminus">-  get infoPageUrl() {</span>
<a href="#l69.136"></a><span id="l69.136" class="difflineminus">-    return this._url;</span>
<a href="#l69.137"></a><span id="l69.137" class="difflineminus">-  },</span>
<a href="#l69.138"></a><span id="l69.138" class="difflineminus">-</span>
<a href="#l69.139"></a><span id="l69.139" class="difflineminus">-  get currentStatusUrl() {</span>
<a href="#l69.140"></a><span id="l69.140" class="difflineminus">-    return this._url;</span>
<a href="#l69.141"></a><span id="l69.141" class="difflineminus">-  },</span>
<a href="#l69.142"></a><span id="l69.142" class="difflineminus">-</span>
<a href="#l69.143"></a><span id="l69.143" class="difflineminus">-  get defaultUrl() {</span>
<a href="#l69.144"></a><span id="l69.144" class="difflineminus">-    return this.infoPageUrl;</span>
<a href="#l69.145"></a><span id="l69.145" class="difflineminus">-  },</span>
<a href="#l69.146"></a><span id="l69.146" class="difflineminus">-</span>
<a href="#l69.147"></a><span id="l69.147" class="difflineminus">-  get uploadUrl() {</span>
<a href="#l69.148"></a><span id="l69.148" class="difflineminus">-    let url = this._prefs.getCharPref(DATA_UPLOAD_PREF);</span>
<a href="#l69.149"></a><span id="l69.149" class="difflineminus">-    return url + this._id;</span>
<a href="#l69.150"></a><span id="l69.150" class="difflineminus">-  },</span>
<a href="#l69.151"></a><span id="l69.151" class="difflineminus">-</span>
<a href="#l69.152"></a><span id="l69.152" class="difflineminus">-  // event handlers:</span>
<a href="#l69.153"></a><span id="l69.153" class="difflineminus">-</span>
<a href="#l69.154"></a><span id="l69.154" class="difflineminus">-  onExperimentStartup: function TestPilotTask_onExperimentStartup() {</span>
<a href="#l69.155"></a><span id="l69.155" class="difflineminus">-    // Called when experiment is to start running (either on Firefox</span>
<a href="#l69.156"></a><span id="l69.156" class="difflineminus">-    // startup, or when study first becomes IN_PROGRESS)</span>
<a href="#l69.157"></a><span id="l69.157" class="difflineminus">-  },</span>
<a href="#l69.158"></a><span id="l69.158" class="difflineminus">-</span>
<a href="#l69.159"></a><span id="l69.159" class="difflineminus">-  onExperimentShutdown: function TestPilotTask_onExperimentShutdown() {</span>
<a href="#l69.160"></a><span id="l69.160" class="difflineminus">-    // Called when experiment needs to stop running (either on Firefox</span>
<a href="#l69.161"></a><span id="l69.161" class="difflineminus">-    // shutdown, or on experiment reload, or on finishing or being canceled.)</span>
<a href="#l69.162"></a><span id="l69.162" class="difflineminus">-  },</span>
<a href="#l69.163"></a><span id="l69.163" class="difflineminus">-</span>
<a href="#l69.164"></a><span id="l69.164" class="difflineminus">-  doExperimentCleanup: function TestPilotTask_onExperimentCleanup() {</span>
<a href="#l69.165"></a><span id="l69.165" class="difflineminus">-    // Called when experiment has finished or been canceled; do any cleanup</span>
<a href="#l69.166"></a><span id="l69.166" class="difflineminus">-    // of user's profile.</span>
<a href="#l69.167"></a><span id="l69.167" class="difflineminus">-  },</span>
<a href="#l69.168"></a><span id="l69.168" class="difflineminus">-</span>
<a href="#l69.169"></a><span id="l69.169" class="difflineminus">-  onAppStartup: function TestPilotTask_onAppStartup() {</span>
<a href="#l69.170"></a><span id="l69.170" class="difflineminus">-    // Called by extension core when Firefox startup is complete.</span>
<a href="#l69.171"></a><span id="l69.171" class="difflineminus">-  },</span>
<a href="#l69.172"></a><span id="l69.172" class="difflineminus">-</span>
<a href="#l69.173"></a><span id="l69.173" class="difflineminus">-  onAppShutdown: function TestPilotTask_onAppShutdown() {</span>
<a href="#l69.174"></a><span id="l69.174" class="difflineminus">-    // Called by extension core when Firefox is shutting down.</span>
<a href="#l69.175"></a><span id="l69.175" class="difflineminus">-  },</span>
<a href="#l69.176"></a><span id="l69.176" class="difflineminus">-</span>
<a href="#l69.177"></a><span id="l69.177" class="difflineminus">-  onEnterPrivateBrowsing: function TestPilotTask_onEnterPrivate() {</span>
<a href="#l69.178"></a><span id="l69.178" class="difflineminus">-  },</span>
<a href="#l69.179"></a><span id="l69.179" class="difflineminus">-</span>
<a href="#l69.180"></a><span id="l69.180" class="difflineminus">-  onExitPrivateBrowsing: function TestPilotTask_onExitPrivate() {</span>
<a href="#l69.181"></a><span id="l69.181" class="difflineminus">-  },</span>
<a href="#l69.182"></a><span id="l69.182" class="difflineminus">-</span>
<a href="#l69.183"></a><span id="l69.183" class="difflineminus">-  onNewWindow: function TestPilotTask_onNewWindow(window) {</span>
<a href="#l69.184"></a><span id="l69.184" class="difflineminus">-  },</span>
<a href="#l69.185"></a><span id="l69.185" class="difflineminus">-</span>
<a href="#l69.186"></a><span id="l69.186" class="difflineminus">-  onWindowClosed: function TestPilotTask_onWindowClosed(window) {</span>
<a href="#l69.187"></a><span id="l69.187" class="difflineminus">-  },</span>
<a href="#l69.188"></a><span id="l69.188" class="difflineminus">-</span>
<a href="#l69.189"></a><span id="l69.189" class="difflineminus">-  onUrlLoad: function TestPilotTask_onUrlLoad(url) {</span>
<a href="#l69.190"></a><span id="l69.190" class="difflineminus">-  },</span>
<a href="#l69.191"></a><span id="l69.191" class="difflineminus">-</span>
<a href="#l69.192"></a><span id="l69.192" class="difflineminus">-  onDetailPageOpened: function TestPilotTask_onDetailPageOpened(){</span>
<a href="#l69.193"></a><span id="l69.193" class="difflineminus">-    // TODO fold this into loadPage()?</span>
<a href="#l69.194"></a><span id="l69.194" class="difflineminus">-  },</span>
<a href="#l69.195"></a><span id="l69.195" class="difflineminus">-</span>
<a href="#l69.196"></a><span id="l69.196" class="difflineminus">-  checkDate: function TestPilotTask_checkDate() {</span>
<a href="#l69.197"></a><span id="l69.197" class="difflineminus">-  },</span>
<a href="#l69.198"></a><span id="l69.198" class="difflineminus">-</span>
<a href="#l69.199"></a><span id="l69.199" class="difflineminus">-  changeStatus: function TPS_changeStatus(newStatus, suppressNotification) {</span>
<a href="#l69.200"></a><span id="l69.200" class="difflineminus">-    // TODO we always suppress notifications except when new status is</span>
<a href="#l69.201"></a><span id="l69.201" class="difflineminus">-    // &quot;finished&quot;; maybe remove that argument and only fire notification</span>
<a href="#l69.202"></a><span id="l69.202" class="difflineminus">-    // when status is &quot;finished&quot;.</span>
<a href="#l69.203"></a><span id="l69.203" class="difflineminus">-    let logger = Log4Moz.repository.getLogger(&quot;TestPilot.Task&quot;);</span>
<a href="#l69.204"></a><span id="l69.204" class="difflineminus">-    logger.info(&quot;Changing task &quot; + this._id + &quot; status to &quot; + newStatus);</span>
<a href="#l69.205"></a><span id="l69.205" class="difflineminus">-    this._status = newStatus;</span>
<a href="#l69.206"></a><span id="l69.206" class="difflineminus">-    // Set the pref:</span>
<a href="#l69.207"></a><span id="l69.207" class="difflineminus">-    this._prefs.setIntPref(STATUS_PREF_PREFIX + this._id, newStatus);</span>
<a href="#l69.208"></a><span id="l69.208" class="difflineminus">-    // Notify user of status change:</span>
<a href="#l69.209"></a><span id="l69.209" class="difflineminus">-    if (!suppressNotification) {</span>
<a href="#l69.210"></a><span id="l69.210" class="difflineminus">-      Observers.notify(&quot;testpilot:task:changed&quot;, &quot;&quot;, null);</span>
<a href="#l69.211"></a><span id="l69.211" class="difflineminus">-    }</span>
<a href="#l69.212"></a><span id="l69.212" class="difflineminus">-  },</span>
<a href="#l69.213"></a><span id="l69.213" class="difflineminus">-</span>
<a href="#l69.214"></a><span id="l69.214" class="difflineminus">-  loadPage: function TestPilotTask_loadPage() {</span>
<a href="#l69.215"></a><span id="l69.215" class="difflineminus">-    // open the link in the chromeless window</span>
<a href="#l69.216"></a><span id="l69.216" class="difflineminus">-    var wm = Cc[&quot;@mozilla.org/appshell/window-mediator;1&quot;]</span>
<a href="#l69.217"></a><span id="l69.217" class="difflineminus">-                       .getService(Ci.nsIWindowMediator);</span>
<a href="#l69.218"></a><span id="l69.218" class="difflineminus">-    let window = wm.getMostRecentWindow(&quot;navigator:browser&quot;) ||</span>
<a href="#l69.219"></a><span id="l69.219" class="difflineminus">-                 wm.getMostRecentWindow(&quot;mail:3pane&quot;);</span>
<a href="#l69.220"></a><span id="l69.220" class="difflineminus">-    window.TestPilotWindowUtils.openChromeless(this.defaultUrl);</span>
<a href="#l69.221"></a><span id="l69.221" class="difflineminus">-    /* Advance the status when the user sees the page, so that we can stop</span>
<a href="#l69.222"></a><span id="l69.222" class="difflineminus">-     * notifying them about stuff they've seen. */</span>
<a href="#l69.223"></a><span id="l69.223" class="difflineminus">-    if (this._status == TaskConstants.STATUS_NEW) {</span>
<a href="#l69.224"></a><span id="l69.224" class="difflineminus">-      this.changeStatus(TaskConstants.STATUS_PENDING);</span>
<a href="#l69.225"></a><span id="l69.225" class="difflineminus">-    } else if (this._status == TaskConstants.STATUS_STARTING) {</span>
<a href="#l69.226"></a><span id="l69.226" class="difflineminus">-      this.changeStatus(TaskConstants.STATUS_IN_PROGRESS);</span>
<a href="#l69.227"></a><span id="l69.227" class="difflineminus">-    } else if (this._status == TaskConstants.STATUS_RESULTS) {</span>
<a href="#l69.228"></a><span id="l69.228" class="difflineminus">-      this.changeStatus(TaskConstants.STATUS_ARCHIVED);</span>
<a href="#l69.229"></a><span id="l69.229" class="difflineminus">-    }</span>
<a href="#l69.230"></a><span id="l69.230" class="difflineminus">-</span>
<a href="#l69.231"></a><span id="l69.231" class="difflineminus">-    this.onDetailPageOpened();</span>
<a href="#l69.232"></a><span id="l69.232" class="difflineminus">-  },</span>
<a href="#l69.233"></a><span id="l69.233" class="difflineminus">-</span>
<a href="#l69.234"></a><span id="l69.234" class="difflineminus">-  getGuid: function TPS_getGuid(id) {</span>
<a href="#l69.235"></a><span id="l69.235" class="difflineminus">-    // If there is a guid for the task with the given id (not neccessarily this one!)</span>
<a href="#l69.236"></a><span id="l69.236" class="difflineminus">-    // then use it; if there isn't, generate it and store it.</span>
<a href="#l69.237"></a><span id="l69.237" class="difflineminus">-    let prefName = GUID_PREF_PREFIX + id;</span>
<a href="#l69.238"></a><span id="l69.238" class="difflineminus">-    if (this._prefs.prefHasUserValue(prefName)) {</span>
<a href="#l69.239"></a><span id="l69.239" class="difflineminus">-      return this._prefs.getCharPref(prefName);</span>
<a href="#l69.240"></a><span id="l69.240" class="difflineminus">-    } else {</span>
<a href="#l69.241"></a><span id="l69.241" class="difflineminus">-      let uuidGenerator =</span>
<a href="#l69.242"></a><span id="l69.242" class="difflineminus">-        Cc[&quot;@mozilla.org/uuid-generator;1&quot;].getService(Ci.nsIUUIDGenerator);</span>
<a href="#l69.243"></a><span id="l69.243" class="difflineminus">-      let guid = uuidGenerator.generateUUID().toString();</span>
<a href="#l69.244"></a><span id="l69.244" class="difflineminus">-      // remove the brackets from the generated UUID</span>
<a href="#l69.245"></a><span id="l69.245" class="difflineminus">-      if (guid.indexOf(&quot;{&quot;) == 0) {</span>
<a href="#l69.246"></a><span id="l69.246" class="difflineminus">-        guid = guid.substring(1, (guid.length - 1));</span>
<a href="#l69.247"></a><span id="l69.247" class="difflineminus">-      }</span>
<a href="#l69.248"></a><span id="l69.248" class="difflineminus">-      this._prefs.setCharPref(prefName, guid);</span>
<a href="#l69.249"></a><span id="l69.249" class="difflineminus">-      return guid;</span>
<a href="#l69.250"></a><span id="l69.250" class="difflineminus">-    }</span>
<a href="#l69.251"></a><span id="l69.251" class="difflineminus">-  }</span>
<a href="#l69.252"></a><span id="l69.252" class="difflineminus">-};</span>
<a href="#l69.253"></a><span id="l69.253" class="difflineminus">-</span>
<a href="#l69.254"></a><span id="l69.254" class="difflineminus">-function TestPilotExperiment(expInfo, dataStore, handlers, webContent, dateOverrideFunc) {</span>
<a href="#l69.255"></a><span id="l69.255" class="difflineminus">-  // All four of these are objects defined in the remote experiment file</span>
<a href="#l69.256"></a><span id="l69.256" class="difflineminus">-  this._init(expInfo, dataStore, handlers, webContent, dateOverrideFunc);</span>
<a href="#l69.257"></a><span id="l69.257" class="difflineminus">-}</span>
<a href="#l69.258"></a><span id="l69.258" class="difflineminus">-TestPilotExperiment.prototype = {</span>
<a href="#l69.259"></a><span id="l69.259" class="difflineminus">-  _init: function TestPilotExperiment__init(expInfo,</span>
<a href="#l69.260"></a><span id="l69.260" class="difflineminus">-					    dataStore,</span>
<a href="#l69.261"></a><span id="l69.261" class="difflineminus">-					    handlers,</span>
<a href="#l69.262"></a><span id="l69.262" class="difflineminus">-                                            webContent,</span>
<a href="#l69.263"></a><span id="l69.263" class="difflineminus">-                                            dateOverrideFunc) {</span>
<a href="#l69.264"></a><span id="l69.264" class="difflineminus">-    /* expInfo is a dictionary defined in the remote experiment code, which</span>
<a href="#l69.265"></a><span id="l69.265" class="difflineminus">-     * should have the following properties:</span>
<a href="#l69.266"></a><span id="l69.266" class="difflineminus">-     * startDate (string representation of date)</span>
<a href="#l69.267"></a><span id="l69.267" class="difflineminus">-     * duration (number of days)</span>
<a href="#l69.268"></a><span id="l69.268" class="difflineminus">-     * testName (human-readable string)</span>
<a href="#l69.269"></a><span id="l69.269" class="difflineminus">-     * testId (int)</span>
<a href="#l69.270"></a><span id="l69.270" class="difflineminus">-     * testInfoUrl (url)</span>
<a href="#l69.271"></a><span id="l69.271" class="difflineminus">-     * summary (string - couple of sentences explaining study)</span>
<a href="#l69.272"></a><span id="l69.272" class="difflineminus">-     * thumbnail (url of an image representing the study)</span>
<a href="#l69.273"></a><span id="l69.273" class="difflineminus">-     * optInRequired  (boolean)</span>
<a href="#l69.274"></a><span id="l69.274" class="difflineminus">-     * recursAutomatically (boolean)</span>
<a href="#l69.275"></a><span id="l69.275" class="difflineminus">-     * recurrenceInterval (number of days)</span>
<a href="#l69.276"></a><span id="l69.276" class="difflineminus">-     * versionNumber (int) */</span>
<a href="#l69.277"></a><span id="l69.277" class="difflineminus">-</span>
<a href="#l69.278"></a><span id="l69.278" class="difflineminus">-    // dateOverrideFunc: For unit testing. Optional. If provided, will be called</span>
<a href="#l69.279"></a><span id="l69.279" class="difflineminus">-    // instead of Date.now() for determining the current time.</span>
<a href="#l69.280"></a><span id="l69.280" class="difflineminus">-    if (dateOverrideFunc) {</span>
<a href="#l69.281"></a><span id="l69.281" class="difflineminus">-      this._now = dateOverrideFunc;</span>
<a href="#l69.282"></a><span id="l69.282" class="difflineminus">-    } else {</span>
<a href="#l69.283"></a><span id="l69.283" class="difflineminus">-      this._now = Date.now;</span>
<a href="#l69.284"></a><span id="l69.284" class="difflineminus">-    }</span>
<a href="#l69.285"></a><span id="l69.285" class="difflineminus">-    this._taskInit(expInfo.testId, expInfo.testName, expInfo.testInfoUrl,</span>
<a href="#l69.286"></a><span id="l69.286" class="difflineminus">-                   expInfo.summary, expInfo.thumbnail);</span>
<a href="#l69.287"></a><span id="l69.287" class="difflineminus">-    this._webContent = webContent;</span>
<a href="#l69.288"></a><span id="l69.288" class="difflineminus">-    this._dataStore = dataStore;</span>
<a href="#l69.289"></a><span id="l69.289" class="difflineminus">-    this._versionNumber = expInfo.versionNumber;</span>
<a href="#l69.290"></a><span id="l69.290" class="difflineminus">-    this._optInRequired = expInfo.optInRequired;</span>
<a href="#l69.291"></a><span id="l69.291" class="difflineminus">-    // TODO implement opt-in interface for tests that require opt-in.</span>
<a href="#l69.292"></a><span id="l69.292" class="difflineminus">-    this._recursAutomatically = expInfo.recursAutomatically;</span>
<a href="#l69.293"></a><span id="l69.293" class="difflineminus">-    this._recurrenceInterval = expInfo.recurrenceInterval;</span>
<a href="#l69.294"></a><span id="l69.294" class="difflineminus">-</span>
<a href="#l69.295"></a><span id="l69.295" class="difflineminus">-    let prefName = START_DATE_PREF_PREFIX + this._id;</span>
<a href="#l69.296"></a><span id="l69.296" class="difflineminus">-    if (this._prefs.prefHasUserValue(prefName)) {</span>
<a href="#l69.297"></a><span id="l69.297" class="difflineminus">-      // If this isn't the first time we're starting, use the start date</span>
<a href="#l69.298"></a><span id="l69.298" class="difflineminus">-      // already stored in prefs.</span>
<a href="#l69.299"></a><span id="l69.299" class="difflineminus">-      let startDateString = this._prefs.getCharPref(prefName);</span>
<a href="#l69.300"></a><span id="l69.300" class="difflineminus">-      this._startDate = Date.parse(startDateString);</span>
<a href="#l69.301"></a><span id="l69.301" class="difflineminus">-    } else {</span>
<a href="#l69.302"></a><span id="l69.302" class="difflineminus">-      // If a start date is provided in expInfo, use that.</span>
<a href="#l69.303"></a><span id="l69.303" class="difflineminus">-      // Otherwise, start immediately!</span>
<a href="#l69.304"></a><span id="l69.304" class="difflineminus">-      if (expInfo.startDate) {</span>
<a href="#l69.305"></a><span id="l69.305" class="difflineminus">-        this._startDate = Date.parse(expInfo.startDate);</span>
<a href="#l69.306"></a><span id="l69.306" class="difflineminus">-        this._prefs.setCharPref(prefName, expInfo.startDate);</span>
<a href="#l69.307"></a><span id="l69.307" class="difflineminus">-      } else {</span>
<a href="#l69.308"></a><span id="l69.308" class="difflineminus">-        this._startDate = this._now();</span>
<a href="#l69.309"></a><span id="l69.309" class="difflineminus">-        this._prefs.setCharPref(prefName, (new Date(this._startDate)).toString());</span>
<a href="#l69.310"></a><span id="l69.310" class="difflineminus">-      }</span>
<a href="#l69.311"></a><span id="l69.311" class="difflineminus">-    }</span>
<a href="#l69.312"></a><span id="l69.312" class="difflineminus">-</span>
<a href="#l69.313"></a><span id="l69.313" class="difflineminus">-    // Duration is specified in days:</span>
<a href="#l69.314"></a><span id="l69.314" class="difflineminus">-    let duration = expInfo.duration || 7; // default 1 week</span>
<a href="#l69.315"></a><span id="l69.315" class="difflineminus">-    this._endDate = this._startDate + duration * (24 * 60 * 60 * 1000);</span>
<a href="#l69.316"></a><span id="l69.316" class="difflineminus">-    this._logger.info(&quot;Start date is &quot; + this._startDate.toString());</span>
<a href="#l69.317"></a><span id="l69.317" class="difflineminus">-    this._logger.info(&quot;End date is &quot; + this._endDate.toString());</span>
<a href="#l69.318"></a><span id="l69.318" class="difflineminus">-</span>
<a href="#l69.319"></a><span id="l69.319" class="difflineminus">-    this._handlers = handlers;</span>
<a href="#l69.320"></a><span id="l69.320" class="difflineminus">-    this._uploadRetryTimer = null;</span>
<a href="#l69.321"></a><span id="l69.321" class="difflineminus">-    this._startedUpHandlers = false;</span>
<a href="#l69.322"></a><span id="l69.322" class="difflineminus">-</span>
<a href="#l69.323"></a><span id="l69.323" class="difflineminus">-    // checkDate will see what our status is with regards to the start and</span>
<a href="#l69.324"></a><span id="l69.324" class="difflineminus">-    // end dates, and set status appropriately.</span>
<a href="#l69.325"></a><span id="l69.325" class="difflineminus">-    this.checkDate();</span>
<a href="#l69.326"></a><span id="l69.326" class="difflineminus">-</span>
<a href="#l69.327"></a><span id="l69.327" class="difflineminus">-    if (this.experimentIsRunning) {</span>
<a href="#l69.328"></a><span id="l69.328" class="difflineminus">-      this.onExperimentStartup();</span>
<a href="#l69.329"></a><span id="l69.329" class="difflineminus">-    }</span>
<a href="#l69.330"></a><span id="l69.330" class="difflineminus">-  },</span>
<a href="#l69.331"></a><span id="l69.331" class="difflineminus">-</span>
<a href="#l69.332"></a><span id="l69.332" class="difflineminus">-  get taskType() {</span>
<a href="#l69.333"></a><span id="l69.333" class="difflineminus">-    return TaskConstants.TYPE_EXPERIMENT;</span>
<a href="#l69.334"></a><span id="l69.334" class="difflineminus">-  },</span>
<a href="#l69.335"></a><span id="l69.335" class="difflineminus">-</span>
<a href="#l69.336"></a><span id="l69.336" class="difflineminus">-  get endDate() {</span>
<a href="#l69.337"></a><span id="l69.337" class="difflineminus">-    return this._endDate;</span>
<a href="#l69.338"></a><span id="l69.338" class="difflineminus">-  },</span>
<a href="#l69.339"></a><span id="l69.339" class="difflineminus">-</span>
<a href="#l69.340"></a><span id="l69.340" class="difflineminus">-  get startDate() {</span>
<a href="#l69.341"></a><span id="l69.341" class="difflineminus">-    return this._startDate;</span>
<a href="#l69.342"></a><span id="l69.342" class="difflineminus">-  },</span>
<a href="#l69.343"></a><span id="l69.343" class="difflineminus">-</span>
<a href="#l69.344"></a><span id="l69.344" class="difflineminus">-  get dataStore() {</span>
<a href="#l69.345"></a><span id="l69.345" class="difflineminus">-    return this._dataStore;</span>
<a href="#l69.346"></a><span id="l69.346" class="difflineminus">-  },</span>
<a href="#l69.347"></a><span id="l69.347" class="difflineminus">-</span>
<a href="#l69.348"></a><span id="l69.348" class="difflineminus">-  get currentStatusUrl() {</span>
<a href="#l69.349"></a><span id="l69.349" class="difflineminus">-    // TODO chose status.html or status_mobile.html depending on platform...</span>
<a href="#l69.350"></a><span id="l69.350" class="difflineminus">-    let param = &quot;?eid=&quot; + this._id;</span>
<a href="#l69.351"></a><span id="l69.351" class="difflineminus">-    return &quot;chrome://testpilot/content/status.html&quot; + param;</span>
<a href="#l69.352"></a><span id="l69.352" class="difflineminus">-  },</span>
<a href="#l69.353"></a><span id="l69.353" class="difflineminus">-</span>
<a href="#l69.354"></a><span id="l69.354" class="difflineminus">-  get defaultUrl() {</span>
<a href="#l69.355"></a><span id="l69.355" class="difflineminus">-    return this.currentStatusUrl;</span>
<a href="#l69.356"></a><span id="l69.356" class="difflineminus">-  },</span>
<a href="#l69.357"></a><span id="l69.357" class="difflineminus">-</span>
<a href="#l69.358"></a><span id="l69.358" class="difflineminus">-  get recurPref() {</span>
<a href="#l69.359"></a><span id="l69.359" class="difflineminus">-    let prefName = RECUR_PREF_PREFIX + this._id;</span>
<a href="#l69.360"></a><span id="l69.360" class="difflineminus">-    if (this._prefs.prefHasUserValue(prefName)) {</span>
<a href="#l69.361"></a><span id="l69.361" class="difflineminus">-      return this._prefs.getIntPref(prefName);</span>
<a href="#l69.362"></a><span id="l69.362" class="difflineminus">-    } else {</span>
<a href="#l69.363"></a><span id="l69.363" class="difflineminus">-      return TaskConstants.ASK_EACH_TIME;</span>
<a href="#l69.364"></a><span id="l69.364" class="difflineminus">-    }</span>
<a href="#l69.365"></a><span id="l69.365" class="difflineminus">-  },</span>
<a href="#l69.366"></a><span id="l69.366" class="difflineminus">-</span>
<a href="#l69.367"></a><span id="l69.367" class="difflineminus">-  getDataStoreAsJSON: function(callback) {</span>
<a href="#l69.368"></a><span id="l69.368" class="difflineminus">-    this._dataStore.getAllDataAsJSON(false, callback);</span>
<a href="#l69.369"></a><span id="l69.369" class="difflineminus">-  },</span>
<a href="#l69.370"></a><span id="l69.370" class="difflineminus">-</span>
<a href="#l69.371"></a><span id="l69.371" class="difflineminus">-  getWebContent: function TestPilotExperiment_getWebContent(callback) {</span>
<a href="#l69.372"></a><span id="l69.372" class="difflineminus">-    let content = &quot;&quot;;</span>
<a href="#l69.373"></a><span id="l69.373" class="difflineminus">-    let waitForData = false;</span>
<a href="#l69.374"></a><span id="l69.374" class="difflineminus">-    let self = this;</span>
<a href="#l69.375"></a><span id="l69.375" class="difflineminus">-</span>
<a href="#l69.376"></a><span id="l69.376" class="difflineminus">-    switch (this._status) {</span>
<a href="#l69.377"></a><span id="l69.377" class="difflineminus">-      case TaskConstants.STATUS_NEW:</span>
<a href="#l69.378"></a><span id="l69.378" class="difflineminus">-      case TaskConstants.STATUS_PENDING:</span>
<a href="#l69.379"></a><span id="l69.379" class="difflineminus">-        content = this.webContent.upcomingHtml;</span>
<a href="#l69.380"></a><span id="l69.380" class="difflineminus">-      break;</span>
<a href="#l69.381"></a><span id="l69.381" class="difflineminus">-      case TaskConstants.STATUS_STARTING:</span>
<a href="#l69.382"></a><span id="l69.382" class="difflineminus">-      case TaskConstants.STATUS_IN_PROGRESS:</span>
<a href="#l69.383"></a><span id="l69.383" class="difflineminus">-        content = this.webContent.inProgressHtml;</span>
<a href="#l69.384"></a><span id="l69.384" class="difflineminus">-      break;</span>
<a href="#l69.385"></a><span id="l69.385" class="difflineminus">-      case TaskConstants.STATUS_FINISHED:</span>
<a href="#l69.386"></a><span id="l69.386" class="difflineminus">-	waitForData = true;</span>
<a href="#l69.387"></a><span id="l69.387" class="difflineminus">-	this._dataStore.haveData(function(withData) {</span>
<a href="#l69.388"></a><span id="l69.388" class="difflineminus">-	  if (withData) {</span>
<a href="#l69.389"></a><span id="l69.389" class="difflineminus">-	    content = self.webContent.completedHtml;</span>
<a href="#l69.390"></a><span id="l69.390" class="difflineminus">-	  } else {</span>
<a href="#l69.391"></a><span id="l69.391" class="difflineminus">-	    // for after deleting data manually by user.</span>
<a href="#l69.392"></a><span id="l69.392" class="difflineminus">-            let stringBundle =</span>
<a href="#l69.393"></a><span id="l69.393" class="difflineminus">-              Components.classes[&quot;@mozilla.org/intl/stringbundle;1&quot;].</span>
<a href="#l69.394"></a><span id="l69.394" class="difflineminus">-                getService(Components.interfaces.nsIStringBundleService).</span>
<a href="#l69.395"></a><span id="l69.395" class="difflineminus">-	          createBundle(&quot;chrome://testpilot/locale/main.properties&quot;);</span>
<a href="#l69.396"></a><span id="l69.396" class="difflineminus">-	    let link =</span>
<a href="#l69.397"></a><span id="l69.397" class="difflineminus">-	      '&lt;a href=&quot;' + self.infoPageUrl + '&quot;&gt;' + self.title + '&lt;/a&gt;';</span>
<a href="#l69.398"></a><span id="l69.398" class="difflineminus">-	    content =</span>
<a href="#l69.399"></a><span id="l69.399" class="difflineminus">-	      '&lt;h2&gt;' + stringBundle.formatStringFromName(</span>
<a href="#l69.400"></a><span id="l69.400" class="difflineminus">-	        &quot;testpilot.finishedTask.finishedStudy&quot;, [link], 1) + '&lt;/h2&gt;' +</span>
<a href="#l69.401"></a><span id="l69.401" class="difflineminus">-	      '&lt;p&gt;' + stringBundle.GetStringFromName(</span>
<a href="#l69.402"></a><span id="l69.402" class="difflineminus">-	        &quot;testpilot.finishedTask.allRelatedDataDeleted&quot;) + '&lt;/p&gt;';</span>
<a href="#l69.403"></a><span id="l69.403" class="difflineminus">-	  }</span>
<a href="#l69.404"></a><span id="l69.404" class="difflineminus">-	  callback(content);</span>
<a href="#l69.405"></a><span id="l69.405" class="difflineminus">-	});</span>
<a href="#l69.406"></a><span id="l69.406" class="difflineminus">-      break;</span>
<a href="#l69.407"></a><span id="l69.407" class="difflineminus">-      case TaskConstants.STATUS_CANCELLED:</span>
<a href="#l69.408"></a><span id="l69.408" class="difflineminus">-	if (this._expirationDateForDataSubmission.length == 0) {</span>
<a href="#l69.409"></a><span id="l69.409" class="difflineminus">-          content = this.webContent.canceledHtml;</span>
<a href="#l69.410"></a><span id="l69.410" class="difflineminus">-	} else {</span>
<a href="#l69.411"></a><span id="l69.411" class="difflineminus">-          content = this.webContent.dataExpiredHtml;</span>
<a href="#l69.412"></a><span id="l69.412" class="difflineminus">-	}</span>
<a href="#l69.413"></a><span id="l69.413" class="difflineminus">-      break;</span>
<a href="#l69.414"></a><span id="l69.414" class="difflineminus">-      case TaskConstants.STATUS_SUBMITTED:</span>
<a href="#l69.415"></a><span id="l69.415" class="difflineminus">-	if (this._dateForDataDeletion.length &gt; 0) {</span>
<a href="#l69.416"></a><span id="l69.416" class="difflineminus">-          content = this.webContent.remainDataHtml;</span>
<a href="#l69.417"></a><span id="l69.417" class="difflineminus">-	} else {</span>
<a href="#l69.418"></a><span id="l69.418" class="difflineminus">-          content = this.webContent.deletedRemainDataHtml;</span>
<a href="#l69.419"></a><span id="l69.419" class="difflineminus">-	}</span>
<a href="#l69.420"></a><span id="l69.420" class="difflineminus">-      break;</span>
<a href="#l69.421"></a><span id="l69.421" class="difflineminus">-    }</span>
<a href="#l69.422"></a><span id="l69.422" class="difflineminus">-    // TODO what to do if status is cancelled, submitted, results, or archived?</span>
<a href="#l69.423"></a><span id="l69.423" class="difflineminus">-    if (!waitForData) {</span>
<a href="#l69.424"></a><span id="l69.424" class="difflineminus">-      callback(content);</span>
<a href="#l69.425"></a><span id="l69.425" class="difflineminus">-    }</span>
<a href="#l69.426"></a><span id="l69.426" class="difflineminus">-  },</span>
<a href="#l69.427"></a><span id="l69.427" class="difflineminus">-</span>
<a href="#l69.428"></a><span id="l69.428" class="difflineminus">-  getDataPrivacyContent: function(callback) {</span>
<a href="#l69.429"></a><span id="l69.429" class="difflineminus">-    let content = &quot;&quot;;</span>
<a href="#l69.430"></a><span id="l69.430" class="difflineminus">-    let waitForData = false;</span>
<a href="#l69.431"></a><span id="l69.431" class="difflineminus">-    let self = this;</span>
<a href="#l69.432"></a><span id="l69.432" class="difflineminus">-</span>
<a href="#l69.433"></a><span id="l69.433" class="difflineminus">-    switch (this._status) {</span>
<a href="#l69.434"></a><span id="l69.434" class="difflineminus">-      case TaskConstants.STATUS_STARTING:</span>
<a href="#l69.435"></a><span id="l69.435" class="difflineminus">-      case TaskConstants.STATUS_IN_PROGRESS:</span>
<a href="#l69.436"></a><span id="l69.436" class="difflineminus">-        content = this.webContent.inProgressDataPrivacyHtml;</span>
<a href="#l69.437"></a><span id="l69.437" class="difflineminus">-      break;</span>
<a href="#l69.438"></a><span id="l69.438" class="difflineminus">-      case TaskConstants.STATUS_FINISHED:</span>
<a href="#l69.439"></a><span id="l69.439" class="difflineminus">-	waitForData = true;</span>
<a href="#l69.440"></a><span id="l69.440" class="difflineminus">-	this._dataStore.haveData(function(withData) {</span>
<a href="#l69.441"></a><span id="l69.441" class="difflineminus">-	  if (withData) {</span>
<a href="#l69.442"></a><span id="l69.442" class="difflineminus">-	    content = self.webContent.completedDataPrivacyHtml;</span>
<a href="#l69.443"></a><span id="l69.443" class="difflineminus">-	  }</span>
<a href="#l69.444"></a><span id="l69.444" class="difflineminus">-	  callback(content);</span>
<a href="#l69.445"></a><span id="l69.445" class="difflineminus">-	});</span>
<a href="#l69.446"></a><span id="l69.446" class="difflineminus">-      break;</span>
<a href="#l69.447"></a><span id="l69.447" class="difflineminus">-      case TaskConstants.STATUS_CANCELLED:</span>
<a href="#l69.448"></a><span id="l69.448" class="difflineminus">-	if (this._expirationDateForDataSubmission.length == 0) {</span>
<a href="#l69.449"></a><span id="l69.449" class="difflineminus">-          content = this.webContent.canceledDataPrivacyHtml;</span>
<a href="#l69.450"></a><span id="l69.450" class="difflineminus">-	} else {</span>
<a href="#l69.451"></a><span id="l69.451" class="difflineminus">-          content = this.webContent.dataExpiredDataPrivacyHtml;</span>
<a href="#l69.452"></a><span id="l69.452" class="difflineminus">-	}</span>
<a href="#l69.453"></a><span id="l69.453" class="difflineminus">-      break;</span>
<a href="#l69.454"></a><span id="l69.454" class="difflineminus">-      case TaskConstants.STATUS_SUBMITTED:</span>
<a href="#l69.455"></a><span id="l69.455" class="difflineminus">-	if (this._dateForDataDeletion.length &gt; 0) {</span>
<a href="#l69.456"></a><span id="l69.456" class="difflineminus">-          content = this.webContent.remainDataDataPrivacyHtml;</span>
<a href="#l69.457"></a><span id="l69.457" class="difflineminus">-	} else {</span>
<a href="#l69.458"></a><span id="l69.458" class="difflineminus">-          content = this.webContent.deletedRemainDataDataPrivacyHtml;</span>
<a href="#l69.459"></a><span id="l69.459" class="difflineminus">-	}</span>
<a href="#l69.460"></a><span id="l69.460" class="difflineminus">-      break;</span>
<a href="#l69.461"></a><span id="l69.461" class="difflineminus">-    }</span>
<a href="#l69.462"></a><span id="l69.462" class="difflineminus">-    if (!waitForData) {</span>
<a href="#l69.463"></a><span id="l69.463" class="difflineminus">-      callback(content);</span>
<a href="#l69.464"></a><span id="l69.464" class="difflineminus">-    }</span>
<a href="#l69.465"></a><span id="l69.465" class="difflineminus">-  },</span>
<a href="#l69.466"></a><span id="l69.466" class="difflineminus">-</span>
<a href="#l69.467"></a><span id="l69.467" class="difflineminus">-  experimentIsRunning: function TestPilotExperiment_isRunning() {</span>
<a href="#l69.468"></a><span id="l69.468" class="difflineminus">-    // bug 575767</span>
<a href="#l69.469"></a><span id="l69.469" class="difflineminus">-    return (this._status == TaskConstants.STATUS_STARTING ||</span>
<a href="#l69.470"></a><span id="l69.470" class="difflineminus">-            this._status == TaskConstants.STATUS_IN_PROGRESS);</span>
<a href="#l69.471"></a><span id="l69.471" class="difflineminus">-  },</span>
<a href="#l69.472"></a><span id="l69.472" class="difflineminus">-</span>
<a href="#l69.473"></a><span id="l69.473" class="difflineminus">-  // Pass events along to handlers:</span>
<a href="#l69.474"></a><span id="l69.474" class="difflineminus">-  onNewWindow: function TestPilotExperiment_onNewWindow(window) {</span>
<a href="#l69.475"></a><span id="l69.475" class="difflineminus">-    this._logger.trace(&quot;Experiment.onNewWindow called.&quot;);</span>
<a href="#l69.476"></a><span id="l69.476" class="difflineminus">-    if (this.experimentIsRunning()) {</span>
<a href="#l69.477"></a><span id="l69.477" class="difflineminus">-      try {</span>
<a href="#l69.478"></a><span id="l69.478" class="difflineminus">-        this._handlers.onNewWindow(window);</span>
<a href="#l69.479"></a><span id="l69.479" class="difflineminus">-      } catch(e) {</span>
<a href="#l69.480"></a><span id="l69.480" class="difflineminus">-        this._dataStore.logException(&quot;onNewWindow: &quot; + e);</span>
<a href="#l69.481"></a><span id="l69.481" class="difflineminus">-      }</span>
<a href="#l69.482"></a><span id="l69.482" class="difflineminus">-    }</span>
<a href="#l69.483"></a><span id="l69.483" class="difflineminus">-  },</span>
<a href="#l69.484"></a><span id="l69.484" class="difflineminus">-</span>
<a href="#l69.485"></a><span id="l69.485" class="difflineminus">-  onWindowClosed: function TestPilotExperiment_onWindowClosed(window) {</span>
<a href="#l69.486"></a><span id="l69.486" class="difflineminus">-    this._logger.trace(&quot;Experiment.onWindowClosed called.&quot;);</span>
<a href="#l69.487"></a><span id="l69.487" class="difflineminus">-    if (this.experimentIsRunning()) {</span>
<a href="#l69.488"></a><span id="l69.488" class="difflineminus">-      try {</span>
<a href="#l69.489"></a><span id="l69.489" class="difflineminus">-        this._handlers.onWindowClosed(window);</span>
<a href="#l69.490"></a><span id="l69.490" class="difflineminus">-      } catch(e) {</span>
<a href="#l69.491"></a><span id="l69.491" class="difflineminus">-        this._dataStore.logException(&quot;onWindowClosed: &quot; + e);</span>
<a href="#l69.492"></a><span id="l69.492" class="difflineminus">-      }</span>
<a href="#l69.493"></a><span id="l69.493" class="difflineminus">-    }</span>
<a href="#l69.494"></a><span id="l69.494" class="difflineminus">-  },</span>
<a href="#l69.495"></a><span id="l69.495" class="difflineminus">-</span>
<a href="#l69.496"></a><span id="l69.496" class="difflineminus">-  onAppStartup: function TestPilotExperiment_onAppStartup() {</span>
<a href="#l69.497"></a><span id="l69.497" class="difflineminus">-    this._logger.trace(&quot;Experiment.onAppStartup called.&quot;);</span>
<a href="#l69.498"></a><span id="l69.498" class="difflineminus">-    if (this.experimentIsRunning()) {</span>
<a href="#l69.499"></a><span id="l69.499" class="difflineminus">-      try {</span>
<a href="#l69.500"></a><span id="l69.500" class="difflineminus">-        this._handlers.onAppStartup();</span>
<a href="#l69.501"></a><span id="l69.501" class="difflineminus">-      } catch(e) {</span>
<a href="#l69.502"></a><span id="l69.502" class="difflineminus">-        this._dataStore.logException(&quot;onAppStartup: &quot; + e);</span>
<a href="#l69.503"></a><span id="l69.503" class="difflineminus">-      }</span>
<a href="#l69.504"></a><span id="l69.504" class="difflineminus">-    }</span>
<a href="#l69.505"></a><span id="l69.505" class="difflineminus">-  },</span>
<a href="#l69.506"></a><span id="l69.506" class="difflineminus">-</span>
<a href="#l69.507"></a><span id="l69.507" class="difflineminus">-  onAppShutdown: function TestPilotExperiment_onAppShutdown() {</span>
<a href="#l69.508"></a><span id="l69.508" class="difflineminus">-    this._logger.trace(&quot;Experiment.onAppShutdown called.&quot;);</span>
<a href="#l69.509"></a><span id="l69.509" class="difflineminus">-    if (this.experimentIsRunning()) {</span>
<a href="#l69.510"></a><span id="l69.510" class="difflineminus">-      try {</span>
<a href="#l69.511"></a><span id="l69.511" class="difflineminus">-        this._handlers.onAppShutdown();</span>
<a href="#l69.512"></a><span id="l69.512" class="difflineminus">-      } catch(e) {</span>
<a href="#l69.513"></a><span id="l69.513" class="difflineminus">-        this._dataStore.logException(&quot;onAppShutdown: &quot; + e);</span>
<a href="#l69.514"></a><span id="l69.514" class="difflineminus">-      }</span>
<a href="#l69.515"></a><span id="l69.515" class="difflineminus">-    }</span>
<a href="#l69.516"></a><span id="l69.516" class="difflineminus">-  },</span>
<a href="#l69.517"></a><span id="l69.517" class="difflineminus">-</span>
<a href="#l69.518"></a><span id="l69.518" class="difflineminus">-  onExperimentStartup: function TestPilotExperiment_onStartup() {</span>
<a href="#l69.519"></a><span id="l69.519" class="difflineminus">-    this._logger.trace(&quot;Experiment.onExperimentStartup called.&quot;);</span>
<a href="#l69.520"></a><span id="l69.520" class="difflineminus">-    // Make sure not to call this if it's already been called:</span>
<a href="#l69.521"></a><span id="l69.521" class="difflineminus">-    if (this.experimentIsRunning() &amp;&amp; !this._startedUpHandlers) {</span>
<a href="#l69.522"></a><span id="l69.522" class="difflineminus">-      this._logger.trace(&quot;  ... starting up handlers!&quot;);</span>
<a href="#l69.523"></a><span id="l69.523" class="difflineminus">-      try {</span>
<a href="#l69.524"></a><span id="l69.524" class="difflineminus">-        this._handlers.onExperimentStartup(this._dataStore);</span>
<a href="#l69.525"></a><span id="l69.525" class="difflineminus">-      } catch(e) {</span>
<a href="#l69.526"></a><span id="l69.526" class="difflineminus">-        this._dataStore.logException(&quot;onExperimentStartup: &quot; + e);</span>
<a href="#l69.527"></a><span id="l69.527" class="difflineminus">-      }</span>
<a href="#l69.528"></a><span id="l69.528" class="difflineminus">-      this._startedUpHandlers = true;</span>
<a href="#l69.529"></a><span id="l69.529" class="difflineminus">-    }</span>
<a href="#l69.530"></a><span id="l69.530" class="difflineminus">-  },</span>
<a href="#l69.531"></a><span id="l69.531" class="difflineminus">-</span>
<a href="#l69.532"></a><span id="l69.532" class="difflineminus">-  onExperimentShutdown: function TestPilotExperiment_onShutdown() {</span>
<a href="#l69.533"></a><span id="l69.533" class="difflineminus">-    this._logger.trace(&quot;Experiment.onExperimentShutdown called.&quot;);</span>
<a href="#l69.534"></a><span id="l69.534" class="difflineminus">-    if (this.experimentIsRunning() &amp;&amp; this._startedUpHandlers) {</span>
<a href="#l69.535"></a><span id="l69.535" class="difflineminus">-      try {</span>
<a href="#l69.536"></a><span id="l69.536" class="difflineminus">-        this._handlers.onExperimentShutdown();</span>
<a href="#l69.537"></a><span id="l69.537" class="difflineminus">-      } catch(e) {</span>
<a href="#l69.538"></a><span id="l69.538" class="difflineminus">-        this._dataStore.logException(&quot;onExperimentShutdown: &quot; + e);</span>
<a href="#l69.539"></a><span id="l69.539" class="difflineminus">-      }</span>
<a href="#l69.540"></a><span id="l69.540" class="difflineminus">-      this._startedUpHandlers = false;</span>
<a href="#l69.541"></a><span id="l69.541" class="difflineminus">-    }</span>
<a href="#l69.542"></a><span id="l69.542" class="difflineminus">-  },</span>
<a href="#l69.543"></a><span id="l69.543" class="difflineminus">-</span>
<a href="#l69.544"></a><span id="l69.544" class="difflineminus">-  doExperimentCleanup: function TestPilotExperiment_doExperimentCleanup() {</span>
<a href="#l69.545"></a><span id="l69.545" class="difflineminus">-    if (this._handlers.doExperimentCleanup) {</span>
<a href="#l69.546"></a><span id="l69.546" class="difflineminus">-      this._logger.trace(&quot;Doing experiment cleanup.&quot;);</span>
<a href="#l69.547"></a><span id="l69.547" class="difflineminus">-      try {</span>
<a href="#l69.548"></a><span id="l69.548" class="difflineminus">-        this._handlers.doExperimentCleanup();</span>
<a href="#l69.549"></a><span id="l69.549" class="difflineminus">-      } catch(e) {</span>
<a href="#l69.550"></a><span id="l69.550" class="difflineminus">-        this._dataStore.logException(&quot;doExperimentCleanup: &quot; + e);</span>
<a href="#l69.551"></a><span id="l69.551" class="difflineminus">-      }</span>
<a href="#l69.552"></a><span id="l69.552" class="difflineminus">-    }</span>
<a href="#l69.553"></a><span id="l69.553" class="difflineminus">-  },</span>
<a href="#l69.554"></a><span id="l69.554" class="difflineminus">-</span>
<a href="#l69.555"></a><span id="l69.555" class="difflineminus">-  onEnterPrivateBrowsing: function TestPilotExperiment_onEnterPrivate() {</span>
<a href="#l69.556"></a><span id="l69.556" class="difflineminus">-    this._logger.trace(&quot;Task is entering private browsing.&quot;);</span>
<a href="#l69.557"></a><span id="l69.557" class="difflineminus">-    if (this.experimentIsRunning()) {</span>
<a href="#l69.558"></a><span id="l69.558" class="difflineminus">-      try {</span>
<a href="#l69.559"></a><span id="l69.559" class="difflineminus">-        this._handlers.onEnterPrivateBrowsing();</span>
<a href="#l69.560"></a><span id="l69.560" class="difflineminus">-      } catch(e) {</span>
<a href="#l69.561"></a><span id="l69.561" class="difflineminus">-        this._dataStore.logException(&quot;onEnterPrivateBrowsing: &quot; + e);</span>
<a href="#l69.562"></a><span id="l69.562" class="difflineminus">-      }</span>
<a href="#l69.563"></a><span id="l69.563" class="difflineminus">-    }</span>
<a href="#l69.564"></a><span id="l69.564" class="difflineminus">-  },</span>
<a href="#l69.565"></a><span id="l69.565" class="difflineminus">-</span>
<a href="#l69.566"></a><span id="l69.566" class="difflineminus">-  onExitPrivateBrowsing: function TestPilotExperiment_onExitPrivate() {</span>
<a href="#l69.567"></a><span id="l69.567" class="difflineminus">-    this._logger.trace(&quot;Task is exiting private browsing.&quot;);</span>
<a href="#l69.568"></a><span id="l69.568" class="difflineminus">-    if (this.experimentIsRunning()) {</span>
<a href="#l69.569"></a><span id="l69.569" class="difflineminus">-      try {</span>
<a href="#l69.570"></a><span id="l69.570" class="difflineminus">-        this._handlers.onExitPrivateBrowsing();</span>
<a href="#l69.571"></a><span id="l69.571" class="difflineminus">-      } catch(e) {</span>
<a href="#l69.572"></a><span id="l69.572" class="difflineminus">-        this._dataStore.logException(&quot;onExitPrivateBrowsing: &quot; + e);</span>
<a href="#l69.573"></a><span id="l69.573" class="difflineminus">-      }</span>
<a href="#l69.574"></a><span id="l69.574" class="difflineminus">-    }</span>
<a href="#l69.575"></a><span id="l69.575" class="difflineminus">-  },</span>
<a href="#l69.576"></a><span id="l69.576" class="difflineminus">-</span>
<a href="#l69.577"></a><span id="l69.577" class="difflineminus">-  getStudyMetadata: function TestPilotExperiment_getStudyMetadata() {</span>
<a href="#l69.578"></a><span id="l69.578" class="difflineminus">-    try {</span>
<a href="#l69.579"></a><span id="l69.579" class="difflineminus">-      if (this._handlers.getStudyMetadata) {</span>
<a href="#l69.580"></a><span id="l69.580" class="difflineminus">-        let metadata = this._handlers.getStudyMetadata();</span>
<a href="#l69.581"></a><span id="l69.581" class="difflineminus">-        if (metadata.length) {</span>
<a href="#l69.582"></a><span id="l69.582" class="difflineminus">-          // getStudyMetadata must return an array, otherwise it is invalid.</span>
<a href="#l69.583"></a><span id="l69.583" class="difflineminus">-          return metadata;</span>
<a href="#l69.584"></a><span id="l69.584" class="difflineminus">-        }</span>
<a href="#l69.585"></a><span id="l69.585" class="difflineminus">-      }</span>
<a href="#l69.586"></a><span id="l69.586" class="difflineminus">-    } catch(e) {</span>
<a href="#l69.587"></a><span id="l69.587" class="difflineminus">-      this._dataStore.logException(&quot;getStudyMetadata: &quot; + e);</span>
<a href="#l69.588"></a><span id="l69.588" class="difflineminus">-    }</span>
<a href="#l69.589"></a><span id="l69.589" class="difflineminus">-    return null;</span>
<a href="#l69.590"></a><span id="l69.590" class="difflineminus">-  },</span>
<a href="#l69.591"></a><span id="l69.591" class="difflineminus">-</span>
<a href="#l69.592"></a><span id="l69.592" class="difflineminus">-  _reschedule: function TestPilotExperiment_reschedule() {</span>
<a href="#l69.593"></a><span id="l69.593" class="difflineminus">-    // Schedule next run of test:</span>
<a href="#l69.594"></a><span id="l69.594" class="difflineminus">-    // add recurrence interval to start date and store!</span>
<a href="#l69.595"></a><span id="l69.595" class="difflineminus">-    let ms = this._recurrenceInterval * (24 * 60 * 60 * 1000);</span>
<a href="#l69.596"></a><span id="l69.596" class="difflineminus">-    // recurrenceInterval is in days, convert to milliseconds:</span>
<a href="#l69.597"></a><span id="l69.597" class="difflineminus">-    this._startDate += ms;</span>
<a href="#l69.598"></a><span id="l69.598" class="difflineminus">-    this._endDate += ms;</span>
<a href="#l69.599"></a><span id="l69.599" class="difflineminus">-    let prefName = START_DATE_PREF_PREFIX + this._id;</span>
<a href="#l69.600"></a><span id="l69.600" class="difflineminus">-    this._prefs.setCharPref(prefName,</span>
<a href="#l69.601"></a><span id="l69.601" class="difflineminus">-                            (new Date(this._startDate)).toString());</span>
<a href="#l69.602"></a><span id="l69.602" class="difflineminus">-  },</span>
<a href="#l69.603"></a><span id="l69.603" class="difflineminus">-</span>
<a href="#l69.604"></a><span id="l69.604" class="difflineminus">-  get _numTimesRun() {</span>
<a href="#l69.605"></a><span id="l69.605" class="difflineminus">-    // For automatically recurring tests, this is the number of times it</span>
<a href="#l69.606"></a><span id="l69.606" class="difflineminus">-    // has recurred - it will be 1 on the first run, 2 on the second run,</span>
<a href="#l69.607"></a><span id="l69.607" class="difflineminus">-    // etc.</span>
<a href="#l69.608"></a><span id="l69.608" class="difflineminus">-    if (this._recursAutomatically) {</span>
<a href="#l69.609"></a><span id="l69.609" class="difflineminus">-      let prefName = RECUR_TIMES_PREF_PREFIX + this._id;</span>
<a href="#l69.610"></a><span id="l69.610" class="difflineminus">-      if (this._prefs.prefHasUserValue(prefName)) {</span>
<a href="#l69.611"></a><span id="l69.611" class="difflineminus">-        return this._prefs.getIntPref(prefName);</span>
<a href="#l69.612"></a><span id="l69.612" class="difflineminus">-      } else {</span>
<a href="#l69.613"></a><span id="l69.613" class="difflineminus">-        return 1;</span>
<a href="#l69.614"></a><span id="l69.614" class="difflineminus">-      }</span>
<a href="#l69.615"></a><span id="l69.615" class="difflineminus">-    } else {</span>
<a href="#l69.616"></a><span id="l69.616" class="difflineminus">-      return 0;</span>
<a href="#l69.617"></a><span id="l69.617" class="difflineminus">-    }</span>
<a href="#l69.618"></a><span id="l69.618" class="difflineminus">-  },</span>
<a href="#l69.619"></a><span id="l69.619" class="difflineminus">-</span>
<a href="#l69.620"></a><span id="l69.620" class="difflineminus">-  set _expirationDateForDataSubmission(date) {</span>
<a href="#l69.621"></a><span id="l69.621" class="difflineminus">-    if (date) {</span>
<a href="#l69.622"></a><span id="l69.622" class="difflineminus">-      this._prefs.setCharPref(</span>
<a href="#l69.623"></a><span id="l69.623" class="difflineminus">-        EXPIRATION_DATE_FOR_DATA_SUBMISSION_PREFIX + this._id,</span>
<a href="#l69.624"></a><span id="l69.624" class="difflineminus">-        (new Date(date)).toString());</span>
<a href="#l69.625"></a><span id="l69.625" class="difflineminus">-    } else {</span>
<a href="#l69.626"></a><span id="l69.626" class="difflineminus">-      this._prefs.setCharPref(</span>
<a href="#l69.627"></a><span id="l69.627" class="difflineminus">-        EXPIRATION_DATE_FOR_DATA_SUBMISSION_PREFIX + this._id, &quot;&quot;);</span>
<a href="#l69.628"></a><span id="l69.628" class="difflineminus">-    }</span>
<a href="#l69.629"></a><span id="l69.629" class="difflineminus">-  },</span>
<a href="#l69.630"></a><span id="l69.630" class="difflineminus">-</span>
<a href="#l69.631"></a><span id="l69.631" class="difflineminus">-  get _expirationDateForDataSubmission() {</span>
<a href="#l69.632"></a><span id="l69.632" class="difflineminus">-    let prefName = EXPIRATION_DATE_FOR_DATA_SUBMISSION_PREFIX + this._id;</span>
<a href="#l69.633"></a><span id="l69.633" class="difflineminus">-    if (this._prefs.prefHasUserValue(prefName)) {</span>
<a href="#l69.634"></a><span id="l69.634" class="difflineminus">-      return this._prefs.getCharPref(prefName);</span>
<a href="#l69.635"></a><span id="l69.635" class="difflineminus">-    } else {</span>
<a href="#l69.636"></a><span id="l69.636" class="difflineminus">-      return &quot;&quot;;</span>
<a href="#l69.637"></a><span id="l69.637" class="difflineminus">-    }</span>
<a href="#l69.638"></a><span id="l69.638" class="difflineminus">-  },</span>
<a href="#l69.639"></a><span id="l69.639" class="difflineminus">-</span>
<a href="#l69.640"></a><span id="l69.640" class="difflineminus">-  set _dateForDataDeletion(date) {</span>
<a href="#l69.641"></a><span id="l69.641" class="difflineminus">-    if (date) {</span>
<a href="#l69.642"></a><span id="l69.642" class="difflineminus">-      this._prefs.setCharPref(</span>
<a href="#l69.643"></a><span id="l69.643" class="difflineminus">-        DATE_FOR_DATA_DELETION_PREFIX + this._id, (new Date(date)).toString());</span>
<a href="#l69.644"></a><span id="l69.644" class="difflineminus">-    } else {</span>
<a href="#l69.645"></a><span id="l69.645" class="difflineminus">-      this._prefs.setCharPref(DATE_FOR_DATA_DELETION_PREFIX + this._id, &quot;&quot;);</span>
<a href="#l69.646"></a><span id="l69.646" class="difflineminus">-    }</span>
<a href="#l69.647"></a><span id="l69.647" class="difflineminus">-  },</span>
<a href="#l69.648"></a><span id="l69.648" class="difflineminus">-</span>
<a href="#l69.649"></a><span id="l69.649" class="difflineminus">-  get _dateForDataDeletion() {</span>
<a href="#l69.650"></a><span id="l69.650" class="difflineminus">-    let prefName = DATE_FOR_DATA_DELETION_PREFIX + this._id;</span>
<a href="#l69.651"></a><span id="l69.651" class="difflineminus">-    if (this._prefs.prefHasUserValue(prefName)) {</span>
<a href="#l69.652"></a><span id="l69.652" class="difflineminus">-      return this._prefs.getCharPref(prefName);</span>
<a href="#l69.653"></a><span id="l69.653" class="difflineminus">-    } else {</span>
<a href="#l69.654"></a><span id="l69.654" class="difflineminus">-      return &quot;&quot;;</span>
<a href="#l69.655"></a><span id="l69.655" class="difflineminus">-    }</span>
<a href="#l69.656"></a><span id="l69.656" class="difflineminus">-  },</span>
<a href="#l69.657"></a><span id="l69.657" class="difflineminus">-</span>
<a href="#l69.658"></a><span id="l69.658" class="difflineminus">-  checkDate: function TestPilotExperiment_checkDate() {</span>
<a href="#l69.659"></a><span id="l69.659" class="difflineminus">-    // This method handles all date-related status changes and should be</span>
<a href="#l69.660"></a><span id="l69.660" class="difflineminus">-    // called periodically.</span>
<a href="#l69.661"></a><span id="l69.661" class="difflineminus">-    let currentDate = this._now();</span>
<a href="#l69.662"></a><span id="l69.662" class="difflineminus">-    let self = this;</span>
<a href="#l69.663"></a><span id="l69.663" class="difflineminus">-</span>
<a href="#l69.664"></a><span id="l69.664" class="difflineminus">-    // Reset automatically recurring tests:</span>
<a href="#l69.665"></a><span id="l69.665" class="difflineminus">-    if (this._recursAutomatically &amp;&amp;</span>
<a href="#l69.666"></a><span id="l69.666" class="difflineminus">-        this._status &gt;= TaskConstants.STATUS_FINISHED &amp;&amp;</span>
<a href="#l69.667"></a><span id="l69.667" class="difflineminus">-        currentDate &gt;= this._startDate &amp;&amp;</span>
<a href="#l69.668"></a><span id="l69.668" class="difflineminus">-	currentDate &lt;= this._endDate) {</span>
<a href="#l69.669"></a><span id="l69.669" class="difflineminus">-      // if we've done a permanent opt-out, then don't start over-</span>
<a href="#l69.670"></a><span id="l69.670" class="difflineminus">-      // just keep rescheduling.</span>
<a href="#l69.671"></a><span id="l69.671" class="difflineminus">-      if (this.recurPref == TaskConstants.NEVER_SUBMIT) {</span>
<a href="#l69.672"></a><span id="l69.672" class="difflineminus">-        this._logger.info(&quot;recurPref is never submit, so I'm rescheduling.&quot;);</span>
<a href="#l69.673"></a><span id="l69.673" class="difflineminus">-        this._reschedule();</span>
<a href="#l69.674"></a><span id="l69.674" class="difflineminus">-      } else {</span>
<a href="#l69.675"></a><span id="l69.675" class="difflineminus">-        // Normal case is reset to new.</span>
<a href="#l69.676"></a><span id="l69.676" class="difflineminus">-        this.changeStatus(TaskConstants.STATUS_NEW, true);</span>
<a href="#l69.677"></a><span id="l69.677" class="difflineminus">-</span>
<a href="#l69.678"></a><span id="l69.678" class="difflineminus">-        // increment count of how many times this recurring test has run</span>
<a href="#l69.679"></a><span id="l69.679" class="difflineminus">-        let numTimesRun = this._numTimesRun;</span>
<a href="#l69.680"></a><span id="l69.680" class="difflineminus">-        numTimesRun++;</span>
<a href="#l69.681"></a><span id="l69.681" class="difflineminus">-        this._logger.trace(&quot;Test recurring... incrementing &quot; + RECUR_TIMES_PREF_PREFIX + this._id + &quot; to &quot; + numTimesRun);</span>
<a href="#l69.682"></a><span id="l69.682" class="difflineminus">-        this._prefs.setIntPref(RECUR_TIMES_PREF_PREFIX + this._id,</span>
<a href="#l69.683"></a><span id="l69.683" class="difflineminus">-                               numTimesRun );</span>
<a href="#l69.684"></a><span id="l69.684" class="difflineminus">-        this._logger.trace(&quot;Incremented it.&quot;);</span>
<a href="#l69.685"></a><span id="l69.685" class="difflineminus">-      }</span>
<a href="#l69.686"></a><span id="l69.686" class="difflineminus">-    }</span>
<a href="#l69.687"></a><span id="l69.687" class="difflineminus">-</span>
<a href="#l69.688"></a><span id="l69.688" class="difflineminus">-    // If the notify-on-new-study pref is turned off, and the test doesn't</span>
<a href="#l69.689"></a><span id="l69.689" class="difflineminus">-    // require opt-in, then it can jump straight ahead to STARTING.</span>
<a href="#l69.690"></a><span id="l69.690" class="difflineminus">-    if (!this._optInRequired &amp;&amp;</span>
<a href="#l69.691"></a><span id="l69.691" class="difflineminus">-        !this._prefs.getBoolPref(&quot;extensions.testpilot.popup.showOnNewStudy&quot;) &amp;&amp;</span>
<a href="#l69.692"></a><span id="l69.692" class="difflineminus">-        (this._status == TaskConstants.STATUS_NEW ||</span>
<a href="#l69.693"></a><span id="l69.693" class="difflineminus">-         this._status == TaskConstants.STATUS_PENDING)) {</span>
<a href="#l69.694"></a><span id="l69.694" class="difflineminus">-      this._logger.info(&quot;Skipping pending and going straight to starting.&quot;);</span>
<a href="#l69.695"></a><span id="l69.695" class="difflineminus">-      this.changeStatus(TaskConstants.STATUS_STARTING, true);</span>
<a href="#l69.696"></a><span id="l69.696" class="difflineminus">-    }</span>
<a href="#l69.697"></a><span id="l69.697" class="difflineminus">-</span>
<a href="#l69.698"></a><span id="l69.698" class="difflineminus">-    // If a study is STARTING, and we're in the right date range,</span>
<a href="#l69.699"></a><span id="l69.699" class="difflineminus">-    // then start it, and move it to IN_PROGRESS.</span>
<a href="#l69.700"></a><span id="l69.700" class="difflineminus">-    if ( this._status == TaskConstants.STATUS_STARTING &amp;&amp;</span>
<a href="#l69.701"></a><span id="l69.701" class="difflineminus">-        currentDate &gt;= this._startDate &amp;&amp;</span>
<a href="#l69.702"></a><span id="l69.702" class="difflineminus">-        currentDate &lt;= this._endDate) {</span>
<a href="#l69.703"></a><span id="l69.703" class="difflineminus">-      this._logger.info(&quot;Study now starting.&quot;);</span>
<a href="#l69.704"></a><span id="l69.704" class="difflineminus">-      // clear the data before starting.</span>
<a href="#l69.705"></a><span id="l69.705" class="difflineminus">-      this._dataStore.wipeAllData(function() {</span>
<a href="#l69.706"></a><span id="l69.706" class="difflineminus">-        // Experiment is now in progress.</span>
<a href="#l69.707"></a><span id="l69.707" class="difflineminus">-        self.changeStatus(TaskConstants.STATUS_IN_PROGRESS, true);</span>
<a href="#l69.708"></a><span id="l69.708" class="difflineminus">-        self.onExperimentStartup();</span>
<a href="#l69.709"></a><span id="l69.709" class="difflineminus">-      });</span>
<a href="#l69.710"></a><span id="l69.710" class="difflineminus">-    }</span>
<a href="#l69.711"></a><span id="l69.711" class="difflineminus">-</span>
<a href="#l69.712"></a><span id="l69.712" class="difflineminus">-    // What happens when a test finishes:</span>
<a href="#l69.713"></a><span id="l69.713" class="difflineminus">-    if (this._status &lt; TaskConstants.STATUS_FINISHED &amp;&amp;</span>
<a href="#l69.714"></a><span id="l69.714" class="difflineminus">-	currentDate &gt; this._endDate) {</span>
<a href="#l69.715"></a><span id="l69.715" class="difflineminus">-      let setDataDeletionDate = true;</span>
<a href="#l69.716"></a><span id="l69.716" class="difflineminus">-      this._logger.info(&quot;Passed End Date - Switched Task Status to Finished&quot;);</span>
<a href="#l69.717"></a><span id="l69.717" class="difflineminus">-      this.changeStatus(TaskConstants.STATUS_FINISHED);</span>
<a href="#l69.718"></a><span id="l69.718" class="difflineminus">-      this.onExperimentShutdown();</span>
<a href="#l69.719"></a><span id="l69.719" class="difflineminus">-      this.doExperimentCleanup();</span>
<a href="#l69.720"></a><span id="l69.720" class="difflineminus">-</span>
<a href="#l69.721"></a><span id="l69.721" class="difflineminus">-      if (this._recursAutomatically) {</span>
<a href="#l69.722"></a><span id="l69.722" class="difflineminus">-        this._reschedule();</span>
<a href="#l69.723"></a><span id="l69.723" class="difflineminus">-        // A recurring experiment may have been set to automatically submit. If</span>
<a href="#l69.724"></a><span id="l69.724" class="difflineminus">-        // so, submit now!</span>
<a href="#l69.725"></a><span id="l69.725" class="difflineminus">-        if (this.recurPref == TaskConstants.ALWAYS_SUBMIT) {</span>
<a href="#l69.726"></a><span id="l69.726" class="difflineminus">-          this._logger.info(&quot;Automatically Uploading Data&quot;);</span>
<a href="#l69.727"></a><span id="l69.727" class="difflineminus">-          this.upload(function(success) {</span>
<a href="#l69.728"></a><span id="l69.728" class="difflineminus">-            Observers.notify(&quot;testpilot:task:dataAutoSubmitted&quot;, self, null);</span>
<a href="#l69.729"></a><span id="l69.729" class="difflineminus">-	  });</span>
<a href="#l69.730"></a><span id="l69.730" class="difflineminus">-        } else if (this.recurPref == TaskConstants.NEVER_SUBMIT) {</span>
<a href="#l69.731"></a><span id="l69.731" class="difflineminus">-          this._logger.info(&quot;Automatically opting out of uploading data&quot;);</span>
<a href="#l69.732"></a><span id="l69.732" class="difflineminus">-          this.changeStatus(TaskConstants.STATUS_CANCELLED, true);</span>
<a href="#l69.733"></a><span id="l69.733" class="difflineminus">-          this._dataStore.wipeAllData();</span>
<a href="#l69.734"></a><span id="l69.734" class="difflineminus">-	  setDataDeletionDate = false;</span>
<a href="#l69.735"></a><span id="l69.735" class="difflineminus">-        } else {</span>
<a href="#l69.736"></a><span id="l69.736" class="difflineminus">-          if (this._prefs.getBoolPref(&quot;extensions.testpilot.alwaysSubmitData&quot;)) {</span>
<a href="#l69.737"></a><span id="l69.737" class="difflineminus">-            this.upload(function(success) {</span>
<a href="#l69.738"></a><span id="l69.738" class="difflineminus">-	      if (success) {</span>
<a href="#l69.739"></a><span id="l69.739" class="difflineminus">-                Observers.notify(</span>
<a href="#l69.740"></a><span id="l69.740" class="difflineminus">-		  &quot;testpilot:task:dataAutoSubmitted&quot;, self, null);</span>
<a href="#l69.741"></a><span id="l69.741" class="difflineminus">-	      }</span>
<a href="#l69.742"></a><span id="l69.742" class="difflineminus">-	    });</span>
<a href="#l69.743"></a><span id="l69.743" class="difflineminus">-          }</span>
<a href="#l69.744"></a><span id="l69.744" class="difflineminus">-	}</span>
<a href="#l69.745"></a><span id="l69.745" class="difflineminus">-      } else {</span>
<a href="#l69.746"></a><span id="l69.746" class="difflineminus">-        if (this._prefs.getBoolPref(&quot;extensions.testpilot.alwaysSubmitData&quot;)) {</span>
<a href="#l69.747"></a><span id="l69.747" class="difflineminus">-          this.upload(function(success) {</span>
<a href="#l69.748"></a><span id="l69.748" class="difflineminus">-	    if (success) {</span>
<a href="#l69.749"></a><span id="l69.749" class="difflineminus">-              Observers.notify(&quot;testpilot:task:dataAutoSubmitted&quot;, self, null);</span>
<a href="#l69.750"></a><span id="l69.750" class="difflineminus">-	    }</span>
<a href="#l69.751"></a><span id="l69.751" class="difflineminus">-	  });</span>
<a href="#l69.752"></a><span id="l69.752" class="difflineminus">-        }</span>
<a href="#l69.753"></a><span id="l69.753" class="difflineminus">-      }</span>
<a href="#l69.754"></a><span id="l69.754" class="difflineminus">-      if (setDataDeletionDate) {</span>
<a href="#l69.755"></a><span id="l69.755" class="difflineminus">-	let date = this._endDate + TIME_FOR_DATA_DELETION;</span>
<a href="#l69.756"></a><span id="l69.756" class="difflineminus">-        this._dateForDataDeletion = date;</span>
<a href="#l69.757"></a><span id="l69.757" class="difflineminus">-        this._expirationDateForDataSubmission = date;</span>
<a href="#l69.758"></a><span id="l69.758" class="difflineminus">-      } else {</span>
<a href="#l69.759"></a><span id="l69.759" class="difflineminus">-        this._dateForDataDeletion = null;</span>
<a href="#l69.760"></a><span id="l69.760" class="difflineminus">-        this._expirationDateForDataSubmission = null;</span>
<a href="#l69.761"></a><span id="l69.761" class="difflineminus">-      }</span>
<a href="#l69.762"></a><span id="l69.762" class="difflineminus">-    } else {</span>
<a href="#l69.763"></a><span id="l69.763" class="difflineminus">-      // only do this if the state is already finished and the data is expired.</span>
<a href="#l69.764"></a><span id="l69.764" class="difflineminus">-      if (this._status == TaskConstants.STATUS_FINISHED) {</span>
<a href="#l69.765"></a><span id="l69.765" class="difflineminus">-        if (this._prefs.getBoolPref(&quot;extensions.testpilot.alwaysSubmitData&quot;)) {</span>
<a href="#l69.766"></a><span id="l69.766" class="difflineminus">-          this.upload(function(success) {</span>
<a href="#l69.767"></a><span id="l69.767" class="difflineminus">-	    if (success) {</span>
<a href="#l69.768"></a><span id="l69.768" class="difflineminus">-              Observers.notify(&quot;testpilot:task:dataAutoSubmitted&quot;, self, null);</span>
<a href="#l69.769"></a><span id="l69.769" class="difflineminus">-	    }</span>
<a href="#l69.770"></a><span id="l69.770" class="difflineminus">-	  });</span>
<a href="#l69.771"></a><span id="l69.771" class="difflineminus">-        } else if (this._expirationDateForDataSubmission.length &gt; 0) {</span>
<a href="#l69.772"></a><span id="l69.772" class="difflineminus">-	  let expirationDate = Date.parse(this._expirationDateForDataSubmission);</span>
<a href="#l69.773"></a><span id="l69.773" class="difflineminus">-	  if (currentDate &gt; expirationDate) {</span>
<a href="#l69.774"></a><span id="l69.774" class="difflineminus">-            this.changeStatus(TaskConstants.STATUS_CANCELLED, true);</span>
<a href="#l69.775"></a><span id="l69.775" class="difflineminus">-            this._dataStore.wipeAllData();</span>
<a href="#l69.776"></a><span id="l69.776" class="difflineminus">-	    this._dateForDataDeletion = null;</span>
<a href="#l69.777"></a><span id="l69.777" class="difflineminus">-	    // need to keep the expirationDateForDataSubmission value so</span>
<a href="#l69.778"></a><span id="l69.778" class="difflineminus">-	    // we know that data is expired, not user cancels the task.</span>
<a href="#l69.779"></a><span id="l69.779" class="difflineminus">-	  }</span>
<a href="#l69.780"></a><span id="l69.780" class="difflineminus">-	}</span>
<a href="#l69.781"></a><span id="l69.781" class="difflineminus">-      } else if (this._status == TaskConstants.STATUS_SUBMITTED) {</span>
<a href="#l69.782"></a><span id="l69.782" class="difflineminus">-	if (this._dateForDataDeletion.length &gt; 0) {</span>
<a href="#l69.783"></a><span id="l69.783" class="difflineminus">-	  let deleteDate = Date.parse(this._dateForDataDeletion);</span>
<a href="#l69.784"></a><span id="l69.784" class="difflineminus">-	  if (currentDate &gt; deleteDate) {</span>
<a href="#l69.785"></a><span id="l69.785" class="difflineminus">-            this._dataStore.wipeAllData();</span>
<a href="#l69.786"></a><span id="l69.786" class="difflineminus">-	    this._dateForDataDeletion = null;</span>
<a href="#l69.787"></a><span id="l69.787" class="difflineminus">-	  }</span>
<a href="#l69.788"></a><span id="l69.788" class="difflineminus">-	}</span>
<a href="#l69.789"></a><span id="l69.789" class="difflineminus">-      }</span>
<a href="#l69.790"></a><span id="l69.790" class="difflineminus">-    }</span>
<a href="#l69.791"></a><span id="l69.791" class="difflineminus">-  },</span>
<a href="#l69.792"></a><span id="l69.792" class="difflineminus">-</span>
<a href="#l69.793"></a><span id="l69.793" class="difflineminus">-  _prependMetadataToJSON: function TestPilotExperiment__prependToJson(callback) {</span>
<a href="#l69.794"></a><span id="l69.794" class="difflineminus">-    let json = {};</span>
<a href="#l69.795"></a><span id="l69.795" class="difflineminus">-    let self = this;</span>
<a href="#l69.796"></a><span id="l69.796" class="difflineminus">-    MetadataCollector.getMetadata(function(md) {</span>
<a href="#l69.797"></a><span id="l69.797" class="difflineminus">-      json.metadata = md;</span>
<a href="#l69.798"></a><span id="l69.798" class="difflineminus">-      json.metadata.task_guid = self.getGuid(self._id);</span>
<a href="#l69.799"></a><span id="l69.799" class="difflineminus">-      json.metadata.event_headers = self._dataStore.getPropertyNames();</span>
<a href="#l69.800"></a><span id="l69.800" class="difflineminus">-      let moreMd = self.getStudyMetadata();</span>
<a href="#l69.801"></a><span id="l69.801" class="difflineminus">-      if (moreMd) {</span>
<a href="#l69.802"></a><span id="l69.802" class="difflineminus">-        for (let i = 0; i &lt; moreMd.length; i++) {</span>
<a href="#l69.803"></a><span id="l69.803" class="difflineminus">-          if (moreMd[i].name &amp;&amp; moreMd[i].value) {</span>
<a href="#l69.804"></a><span id="l69.804" class="difflineminus">-            json.metadata[ moreMd[i].name ] = moreMd[i].value; // TODO sanitize strings?</span>
<a href="#l69.805"></a><span id="l69.805" class="difflineminus">-            // TODO handle case where name or value are something other than strings?</span>
<a href="#l69.806"></a><span id="l69.806" class="difflineminus">-          }</span>
<a href="#l69.807"></a><span id="l69.807" class="difflineminus">-        }</span>
<a href="#l69.808"></a><span id="l69.808" class="difflineminus">-      }</span>
<a href="#l69.809"></a><span id="l69.809" class="difflineminus">-      self._dataStore.getJSONRows(function(rows) {</span>
<a href="#l69.810"></a><span id="l69.810" class="difflineminus">-        json.events = rows;</span>
<a href="#l69.811"></a><span id="l69.811" class="difflineminus">-        self._dataStore.getExceptionsAsJson(function(errs) {</span>
<a href="#l69.812"></a><span id="l69.812" class="difflineminus">-          json.exceptions = errs;</span>
<a href="#l69.813"></a><span id="l69.813" class="difflineminus">-          callback( JSON.stringify(json) );</span>
<a href="#l69.814"></a><span id="l69.814" class="difflineminus">-        });</span>
<a href="#l69.815"></a><span id="l69.815" class="difflineminus">-      });</span>
<a href="#l69.816"></a><span id="l69.816" class="difflineminus">-    });</span>
<a href="#l69.817"></a><span id="l69.817" class="difflineminus">-  },</span>
<a href="#l69.818"></a><span id="l69.818" class="difflineminus">-</span>
<a href="#l69.819"></a><span id="l69.819" class="difflineminus">-  // Note: When we have multiple experiments running, the uploads</span>
<a href="#l69.820"></a><span id="l69.820" class="difflineminus">-  // are separate files.</span>
<a href="#l69.821"></a><span id="l69.821" class="difflineminus">-  upload: function TestPilotExperiment_upload(callback, retryCount) {</span>
<a href="#l69.822"></a><span id="l69.822" class="difflineminus">-    // Callback is a function that will be called back with true or false</span>
<a href="#l69.823"></a><span id="l69.823" class="difflineminus">-    // on success or failure.</span>
<a href="#l69.824"></a><span id="l69.824" class="difflineminus">-</span>
<a href="#l69.825"></a><span id="l69.825" class="difflineminus">-    /* If we've already uploaded, and the user tries to upload again for</span>
<a href="#l69.826"></a><span id="l69.826" class="difflineminus">-     * some reason (they could navigate back to the status.html page,</span>
<a href="#l69.827"></a><span id="l69.827" class="difflineminus">-     * for instance), then proceed without uploading: */</span>
<a href="#l69.828"></a><span id="l69.828" class="difflineminus">-    if (this._status &gt;= TaskConstants.STATUS_SUBMITTED) {</span>
<a href="#l69.829"></a><span id="l69.829" class="difflineminus">-      callback(true);</span>
<a href="#l69.830"></a><span id="l69.830" class="difflineminus">-      return;</span>
<a href="#l69.831"></a><span id="l69.831" class="difflineminus">-    }</span>
<a href="#l69.832"></a><span id="l69.832" class="difflineminus">-</span>
<a href="#l69.833"></a><span id="l69.833" class="difflineminus">-    // note the server will reject any upload over 5MB - shouldn't be a problem</span>
<a href="#l69.834"></a><span id="l69.834" class="difflineminus">-    let self = this;</span>
<a href="#l69.835"></a><span id="l69.835" class="difflineminus">-    let url = self.uploadUrl;</span>
<a href="#l69.836"></a><span id="l69.836" class="difflineminus">-    self._logger.info(&quot;Posting data to url &quot; + url + &quot;\n&quot;);</span>
<a href="#l69.837"></a><span id="l69.837" class="difflineminus">-    self._prependMetadataToJSON( function(dataString) {</span>
<a href="#l69.838"></a><span id="l69.838" class="difflineminus">-      let req = Cc[&quot;@mozilla.org/xmlextras/xmlhttprequest;1&quot;]</span>
<a href="#l69.839"></a><span id="l69.839" class="difflineminus">-                  .createInstance( Ci.nsIXMLHttpRequest );</span>
<a href="#l69.840"></a><span id="l69.840" class="difflineminus">-      req.open('POST', url, true);</span>
<a href="#l69.841"></a><span id="l69.841" class="difflineminus">-      req.setRequestHeader(&quot;Content-type&quot;, &quot;application/json&quot;);</span>
<a href="#l69.842"></a><span id="l69.842" class="difflineminus">-      req.setRequestHeader(&quot;Content-length&quot;, dataString.length);</span>
<a href="#l69.843"></a><span id="l69.843" class="difflineminus">-      req.setRequestHeader(&quot;Connection&quot;, &quot;close&quot;);</span>
<a href="#l69.844"></a><span id="l69.844" class="difflineminus">-      req.onreadystatechange = function(aEvt) {</span>
<a href="#l69.845"></a><span id="l69.845" class="difflineminus">-        if (req.readyState == 4) {</span>
<a href="#l69.846"></a><span id="l69.846" class="difflineminus">-          if (req.status == 200 || req.status == 201 || req.status == 202) {</span>
<a href="#l69.847"></a><span id="l69.847" class="difflineminus">-            let location = req.getResponseHeader(&quot;Location&quot;);</span>
<a href="#l69.848"></a><span id="l69.848" class="difflineminus">-  	    self._logger.info(&quot;DATA WAS POSTED SUCCESSFULLY &quot; + location);</span>
<a href="#l69.849"></a><span id="l69.849" class="difflineminus">-            if (self._uploadRetryTimer) {</span>
<a href="#l69.850"></a><span id="l69.850" class="difflineminus">-              self._uploadRetryTimer.cancel(); // Stop retrying - it worked!</span>
<a href="#l69.851"></a><span id="l69.851" class="difflineminus">-            }</span>
<a href="#l69.852"></a><span id="l69.852" class="difflineminus">-            self.changeStatus(TaskConstants.STATUS_SUBMITTED);</span>
<a href="#l69.853"></a><span id="l69.853" class="difflineminus">-            self._dateForDataDeletion = self._now() + TIME_FOR_DATA_DELETION;</span>
<a href="#l69.854"></a><span id="l69.854" class="difflineminus">-            self._expirationDateForDataSubmission = null;</span>
<a href="#l69.855"></a><span id="l69.855" class="difflineminus">-            callback(true);</span>
<a href="#l69.856"></a><span id="l69.856" class="difflineminus">-          } else {</span>
<a href="#l69.857"></a><span id="l69.857" class="difflineminus">-          /* If something went wrong with the upload, give up for now,</span>
<a href="#l69.858"></a><span id="l69.858" class="difflineminus">-           * but start a timer to try again later.  Maybe the network will</span>
<a href="#l69.859"></a><span id="l69.859" class="difflineminus">-           * be better by then.  &quot;later&quot; starts at 1 hour, but increases</span>
<a href="#l69.860"></a><span id="l69.860" class="difflineminus">-           * using a random exponential function.  This serves as a backoff</span>
<a href="#l69.861"></a><span id="l69.861" class="difflineminus">-           * in cases where a lot of users are trying to submit data at</span>
<a href="#l69.862"></a><span id="l69.862" class="difflineminus">-           * the same time and the network or server can't handle it.</span>
<a href="#l69.863"></a><span id="l69.863" class="difflineminus">-           */</span>
<a href="#l69.864"></a><span id="l69.864" class="difflineminus">-</span>
<a href="#l69.865"></a><span id="l69.865" class="difflineminus">-            // TODO don't retry if status code is 401, 404, or...</span>
<a href="#l69.866"></a><span id="l69.866" class="difflineminus">-            // any others?</span>
<a href="#l69.867"></a><span id="l69.867" class="difflineminus">-            self._logger.warn(&quot;ERROR POSTING DATA: &quot; + req.responseText);</span>
<a href="#l69.868"></a><span id="l69.868" class="difflineminus">-            self._uploadRetryTimer = Cc[&quot;@mozilla.org/timer;1&quot;]</span>
<a href="#l69.869"></a><span id="l69.869" class="difflineminus">-              .createInstance(Ci.nsITimer);</span>
<a href="#l69.870"></a><span id="l69.870" class="difflineminus">-</span>
<a href="#l69.871"></a><span id="l69.871" class="difflineminus">-            if (!retryCount) {</span>
<a href="#l69.872"></a><span id="l69.872" class="difflineminus">-	      retryCount = 0;</span>
<a href="#l69.873"></a><span id="l69.873" class="difflineminus">-            }</span>
<a href="#l69.874"></a><span id="l69.874" class="difflineminus">-            let interval = this._prefs.getIntPref(RETRY_INTERVAL_PREF); // 1 hour</span>
<a href="#l69.875"></a><span id="l69.875" class="difflineminus">-            let delay = Math.random() * Math.pow(2, retryCount) * interval;</span>
<a href="#l69.876"></a><span id="l69.876" class="difflineminus">-            self._uploadRetryTimer.initWithCallback(</span>
<a href="#l69.877"></a><span id="l69.877" class="difflineminus">-              { notify: function(timer) {</span>
<a href="#l69.878"></a><span id="l69.878" class="difflineminus">-		self.upload(callback, retryCount++);</span>
<a href="#l69.879"></a><span id="l69.879" class="difflineminus">-	      } }, (interval + delay), Ci.nsITimer.TYPE_ONE_SHOT);</span>
<a href="#l69.880"></a><span id="l69.880" class="difflineminus">-            callback(false);</span>
<a href="#l69.881"></a><span id="l69.881" class="difflineminus">-          }</span>
<a href="#l69.882"></a><span id="l69.882" class="difflineminus">-        }</span>
<a href="#l69.883"></a><span id="l69.883" class="difflineminus">-      };</span>
<a href="#l69.884"></a><span id="l69.884" class="difflineminus">-      req.send(dataString);</span>
<a href="#l69.885"></a><span id="l69.885" class="difflineminus">-    });</span>
<a href="#l69.886"></a><span id="l69.886" class="difflineminus">-  },</span>
<a href="#l69.887"></a><span id="l69.887" class="difflineminus">-</span>
<a href="#l69.888"></a><span id="l69.888" class="difflineminus">-  optOut: function TestPilotExperiment_optOut(reason, callback) {</span>
<a href="#l69.889"></a><span id="l69.889" class="difflineminus">-    // Regardless of study ID, post the opt-out message to a special</span>
<a href="#l69.890"></a><span id="l69.890" class="difflineminus">-    // database table of just opt-out messages; include study ID in metadata.</span>
<a href="#l69.891"></a><span id="l69.891" class="difflineminus">-    let logger = this._logger;</span>
<a href="#l69.892"></a><span id="l69.892" class="difflineminus">-</span>
<a href="#l69.893"></a><span id="l69.893" class="difflineminus">-    this.onExperimentShutdown();</span>
<a href="#l69.894"></a><span id="l69.894" class="difflineminus">-    this.changeStatus(TaskConstants.STATUS_CANCELLED);</span>
<a href="#l69.895"></a><span id="l69.895" class="difflineminus">-    this._dataStore.wipeAllData();</span>
<a href="#l69.896"></a><span id="l69.896" class="difflineminus">-    this.doExperimentCleanup();</span>
<a href="#l69.897"></a><span id="l69.897" class="difflineminus">-    this._dateForDataDeletion = null;</span>
<a href="#l69.898"></a><span id="l69.898" class="difflineminus">-    this._expirationDateForDataSubmission = null;</span>
<a href="#l69.899"></a><span id="l69.899" class="difflineminus">-    logger.info(&quot;Opting out of test with reason &quot; + reason);</span>
<a href="#l69.900"></a><span id="l69.900" class="difflineminus">-    if (reason) {</span>
<a href="#l69.901"></a><span id="l69.901" class="difflineminus">-      // Send us the reason...</span>
<a href="#l69.902"></a><span id="l69.902" class="difflineminus">-      // (TODO: include metadata?)</span>
<a href="#l69.903"></a><span id="l69.903" class="difflineminus">-      let url = this._prefs.getCharPref(DATA_UPLOAD_PREF) + &quot;opt-out&quot;;</span>
<a href="#l69.904"></a><span id="l69.904" class="difflineminus">-      let answer = {id: this._id,</span>
<a href="#l69.905"></a><span id="l69.905" class="difflineminus">-                    reason: reason};</span>
<a href="#l69.906"></a><span id="l69.906" class="difflineminus">-      let dataString = JSON.stringify(answer);</span>
<a href="#l69.907"></a><span id="l69.907" class="difflineminus">-      var req =</span>
<a href="#l69.908"></a><span id="l69.908" class="difflineminus">-        Cc[&quot;@mozilla.org/xmlextras/xmlhttprequest;1&quot;].</span>
<a href="#l69.909"></a><span id="l69.909" class="difflineminus">-	  createInstance(Ci.nsIXMLHttpRequest);</span>
<a href="#l69.910"></a><span id="l69.910" class="difflineminus">-      logger.trace(&quot;Posting &quot; + dataString + &quot; to &quot; + url);</span>
<a href="#l69.911"></a><span id="l69.911" class="difflineminus">-      req.open('POST', url, true);</span>
<a href="#l69.912"></a><span id="l69.912" class="difflineminus">-      req.setRequestHeader(&quot;Content-type&quot;, &quot;application/json&quot;);</span>
<a href="#l69.913"></a><span id="l69.913" class="difflineminus">-      req.setRequestHeader(&quot;Content-length&quot;, dataString.length);</span>
<a href="#l69.914"></a><span id="l69.914" class="difflineminus">-      req.setRequestHeader(&quot;Connection&quot;, &quot;close&quot;);</span>
<a href="#l69.915"></a><span id="l69.915" class="difflineminus">-      req.onreadystatechange = function(aEvt) {</span>
<a href="#l69.916"></a><span id="l69.916" class="difflineminus">-        if (req.readyState == 4) {</span>
<a href="#l69.917"></a><span id="l69.917" class="difflineminus">-          if (req.status == 200 || req.status == 201 || req.status == 202) {</span>
<a href="#l69.918"></a><span id="l69.918" class="difflineminus">-	    logger.info(&quot;Quit reason posted successfully &quot; + req.responseText);</span>
<a href="#l69.919"></a><span id="l69.919" class="difflineminus">-            if (callback) {</span>
<a href="#l69.920"></a><span id="l69.920" class="difflineminus">-              callback(true);</span>
<a href="#l69.921"></a><span id="l69.921" class="difflineminus">-            }</span>
<a href="#l69.922"></a><span id="l69.922" class="difflineminus">-	  } else {</span>
<a href="#l69.923"></a><span id="l69.923" class="difflineminus">-	    logger.warn(req.status + &quot; posting error &quot; + req.responseText);</span>
<a href="#l69.924"></a><span id="l69.924" class="difflineminus">-            if (callback) {</span>
<a href="#l69.925"></a><span id="l69.925" class="difflineminus">-              callback(false);</span>
<a href="#l69.926"></a><span id="l69.926" class="difflineminus">-            }</span>
<a href="#l69.927"></a><span id="l69.927" class="difflineminus">-	  }</span>
<a href="#l69.928"></a><span id="l69.928" class="difflineminus">-	}</span>
<a href="#l69.929"></a><span id="l69.929" class="difflineminus">-      };</span>
<a href="#l69.930"></a><span id="l69.930" class="difflineminus">-      logger.trace(&quot;Sending quit reason.&quot;);</span>
<a href="#l69.931"></a><span id="l69.931" class="difflineminus">-      req.send(dataString);</span>
<a href="#l69.932"></a><span id="l69.932" class="difflineminus">-    } else {</span>
<a href="#l69.933"></a><span id="l69.933" class="difflineminus">-      if (callback) {</span>
<a href="#l69.934"></a><span id="l69.934" class="difflineminus">-        callback(false);</span>
<a href="#l69.935"></a><span id="l69.935" class="difflineminus">-      }</span>
<a href="#l69.936"></a><span id="l69.936" class="difflineminus">-    }</span>
<a href="#l69.937"></a><span id="l69.937" class="difflineminus">-  },</span>
<a href="#l69.938"></a><span id="l69.938" class="difflineminus">-</span>
<a href="#l69.939"></a><span id="l69.939" class="difflineminus">-  setRecurPref: function TPE_setRecurPrefs(value) {</span>
<a href="#l69.940"></a><span id="l69.940" class="difflineminus">-    // value is NEVER_SUBMIT, ALWAYS_SUBMIT, or ASK_EACH_TIME</span>
<a href="#l69.941"></a><span id="l69.941" class="difflineminus">-    let prefName = RECUR_PREF_PREFIX + this._id;</span>
<a href="#l69.942"></a><span id="l69.942" class="difflineminus">-    this._logger.info(&quot;Setting recur pref to &quot; + value);</span>
<a href="#l69.943"></a><span id="l69.943" class="difflineminus">-    this._prefs.setIntPref(prefName, value);</span>
<a href="#l69.944"></a><span id="l69.944" class="difflineminus">-  }</span>
<a href="#l69.945"></a><span id="l69.945" class="difflineminus">-};</span>
<a href="#l69.946"></a><span id="l69.946" class="difflineminus">-TestPilotExperiment.prototype.__proto__ = TestPilotTask;</span>
<a href="#l69.947"></a><span id="l69.947" class="difflineminus">-</span>
<a href="#l69.948"></a><span id="l69.948" class="difflineminus">-function TestPilotBuiltinSurvey(surveyInfo) {</span>
<a href="#l69.949"></a><span id="l69.949" class="difflineminus">-  this._init(surveyInfo);</span>
<a href="#l69.950"></a><span id="l69.950" class="difflineminus">-}</span>
<a href="#l69.951"></a><span id="l69.951" class="difflineminus">-TestPilotBuiltinSurvey.prototype = {</span>
<a href="#l69.952"></a><span id="l69.952" class="difflineminus">-  _init: function TestPilotBuiltinSurvey__init(surveyInfo) {</span>
<a href="#l69.953"></a><span id="l69.953" class="difflineminus">-    this._taskInit(surveyInfo.surveyId,</span>
<a href="#l69.954"></a><span id="l69.954" class="difflineminus">-                   surveyInfo.surveyName,</span>
<a href="#l69.955"></a><span id="l69.955" class="difflineminus">-                   surveyInfo.surveyUrl,</span>
<a href="#l69.956"></a><span id="l69.956" class="difflineminus">-                   surveyInfo.summary,</span>
<a href="#l69.957"></a><span id="l69.957" class="difflineminus">-                   surveyInfo.thumbnail);</span>
<a href="#l69.958"></a><span id="l69.958" class="difflineminus">-    this._studyId = surveyInfo.uploadWithExperiment; // what study do we belong to</span>
<a href="#l69.959"></a><span id="l69.959" class="difflineminus">-    this._versionNumber = surveyInfo.versionNumber;</span>
<a href="#l69.960"></a><span id="l69.960" class="difflineminus">-    this._questions = surveyInfo.surveyQuestions;</span>
<a href="#l69.961"></a><span id="l69.961" class="difflineminus">-    this._explanation = surveyInfo.surveyExplanation;</span>
<a href="#l69.962"></a><span id="l69.962" class="difflineminus">-    this._onPageLoad = surveyInfo.onPageLoad;</span>
<a href="#l69.963"></a><span id="l69.963" class="difflineminus">-  },</span>
<a href="#l69.964"></a><span id="l69.964" class="difflineminus">-</span>
<a href="#l69.965"></a><span id="l69.965" class="difflineminus">-  get taskType() {</span>
<a href="#l69.966"></a><span id="l69.966" class="difflineminus">-    return TaskConstants.TYPE_SURVEY;</span>
<a href="#l69.967"></a><span id="l69.967" class="difflineminus">-  },</span>
<a href="#l69.968"></a><span id="l69.968" class="difflineminus">-</span>
<a href="#l69.969"></a><span id="l69.969" class="difflineminus">-  get surveyExplanation() {</span>
<a href="#l69.970"></a><span id="l69.970" class="difflineminus">-    return this._explanation;</span>
<a href="#l69.971"></a><span id="l69.971" class="difflineminus">-  },</span>
<a href="#l69.972"></a><span id="l69.972" class="difflineminus">-</span>
<a href="#l69.973"></a><span id="l69.973" class="difflineminus">-  get surveyQuestions() {</span>
<a href="#l69.974"></a><span id="l69.974" class="difflineminus">-    return this._questions;</span>
<a href="#l69.975"></a><span id="l69.975" class="difflineminus">-  },</span>
<a href="#l69.976"></a><span id="l69.976" class="difflineminus">-</span>
<a href="#l69.977"></a><span id="l69.977" class="difflineminus">-  get currentStatusUrl() {</span>
<a href="#l69.978"></a><span id="l69.978" class="difflineminus">-    let param = &quot;?eid=&quot; + this._id;</span>
<a href="#l69.979"></a><span id="l69.979" class="difflineminus">-    return &quot;chrome://testpilot/content/take-survey.html&quot; + param;</span>
<a href="#l69.980"></a><span id="l69.980" class="difflineminus">-  },</span>
<a href="#l69.981"></a><span id="l69.981" class="difflineminus">-</span>
<a href="#l69.982"></a><span id="l69.982" class="difflineminus">-  get defaultUrl() {</span>
<a href="#l69.983"></a><span id="l69.983" class="difflineminus">-    return this.currentStatusUrl;</span>
<a href="#l69.984"></a><span id="l69.984" class="difflineminus">-  },</span>
<a href="#l69.985"></a><span id="l69.985" class="difflineminus">-</span>
<a href="#l69.986"></a><span id="l69.986" class="difflineminus">-  get relatedStudyId() {</span>
<a href="#l69.987"></a><span id="l69.987" class="difflineminus">-    return this._studyId;</span>
<a href="#l69.988"></a><span id="l69.988" class="difflineminus">-  },</span>
<a href="#l69.989"></a><span id="l69.989" class="difflineminus">-</span>
<a href="#l69.990"></a><span id="l69.990" class="difflineminus">-  onPageLoad: function(task, document) {</span>
<a href="#l69.991"></a><span id="l69.991" class="difflineminus">-    if (this._onPageLoad) {</span>
<a href="#l69.992"></a><span id="l69.992" class="difflineminus">-      this._onPageLoad(task, document);</span>
<a href="#l69.993"></a><span id="l69.993" class="difflineminus">-    }</span>
<a href="#l69.994"></a><span id="l69.994" class="difflineminus">-  },</span>
<a href="#l69.995"></a><span id="l69.995" class="difflineminus">-</span>
<a href="#l69.996"></a><span id="l69.996" class="difflineminus">-  onDetailPageOpened: function TPS_onDetailPageOpened() {</span>
<a href="#l69.997"></a><span id="l69.997" class="difflineminus">-    if (this._status &lt; TaskConstants.STATUS_IN_PROGRESS) {</span>
<a href="#l69.998"></a><span id="l69.998" class="difflineminus">-      this.changeStatus( TaskConstants.STATUS_IN_PROGRESS, true );</span>
<a href="#l69.999"></a><span id="l69.999" class="difflineminus">-    }</span>
<a href="#l69.1000"></a><span id="l69.1000" class="difflineminus">-  },</span>
<a href="#l69.1001"></a><span id="l69.1001" class="difflineminus">-</span>
<a href="#l69.1002"></a><span id="l69.1002" class="difflineminus">-  get oldAnswers() {</span>
<a href="#l69.1003"></a><span id="l69.1003" class="difflineminus">-    let prefName = SURVEY_ANSWER_PREFIX + this._id;</span>
<a href="#l69.1004"></a><span id="l69.1004" class="difflineminus">-    if (!this._prefs.prefHasUserValue(prefName)) {</span>
<a href="#l69.1005"></a><span id="l69.1005" class="difflineminus">-      return null;</span>
<a href="#l69.1006"></a><span id="l69.1006" class="difflineminus">-    } else {</span>
<a href="#l69.1007"></a><span id="l69.1007" class="difflineminus">-      let surveyResults = this._prefs.getCharPref(prefName);</span>
<a href="#l69.1008"></a><span id="l69.1008" class="difflineminus">-      this._logger.info(&quot;Trying to json.parse this: &quot; + surveyResults);</span>
<a href="#l69.1009"></a><span id="l69.1009" class="difflineminus">-      return sanitizeJSONStrings( JSON.parse(surveyResults) );</span>
<a href="#l69.1010"></a><span id="l69.1010" class="difflineminus">-    }</span>
<a href="#l69.1011"></a><span id="l69.1011" class="difflineminus">-  },</span>
<a href="#l69.1012"></a><span id="l69.1012" class="difflineminus">-</span>
<a href="#l69.1013"></a><span id="l69.1013" class="difflineminus">-  store: function TestPilotSurvey_store(surveyResults, callback) {</span>
<a href="#l69.1014"></a><span id="l69.1014" class="difflineminus">-    /* Store answers in preferences store; then, upload the survey data</span>
<a href="#l69.1015"></a><span id="l69.1015" class="difflineminus">-     * if this is a survey with an associated study (the matching GUIDs</span>
<a href="#l69.1016"></a><span id="l69.1016" class="difflineminus">-     * will be used to associate the two datasets server-side).</span>
<a href="#l69.1017"></a><span id="l69.1017" class="difflineminus">-     * If it's not one with an associated survey, just store and set status</span>
<a href="#l69.1018"></a><span id="l69.1018" class="difflineminus">-     * to submitted.  Either way, call the callback with true/false for</span>
<a href="#l69.1019"></a><span id="l69.1019" class="difflineminus">-     * success/failure.*/</span>
<a href="#l69.1020"></a><span id="l69.1020" class="difflineminus">-    surveyResults = sanitizeJSONStrings(surveyResults);</span>
<a href="#l69.1021"></a><span id="l69.1021" class="difflineminus">-    let prefName = SURVEY_ANSWER_PREFIX + this._id;</span>
<a href="#l69.1022"></a><span id="l69.1022" class="difflineminus">-    // Also store survey version number</span>
<a href="#l69.1023"></a><span id="l69.1023" class="difflineminus">-    if (this._versionNumber) {</span>
<a href="#l69.1024"></a><span id="l69.1024" class="difflineminus">-      surveyResults[&quot;version_number&quot;] = this._versionNumber;</span>
<a href="#l69.1025"></a><span id="l69.1025" class="difflineminus">-    }</span>
<a href="#l69.1026"></a><span id="l69.1026" class="difflineminus">-    this._prefs.setCharPref(prefName, JSON.stringify(surveyResults));</span>
<a href="#l69.1027"></a><span id="l69.1027" class="difflineminus">-    if (this._studyId) {</span>
<a href="#l69.1028"></a><span id="l69.1028" class="difflineminus">-      this._upload(callback, 0);</span>
<a href="#l69.1029"></a><span id="l69.1029" class="difflineminus">-    } else {</span>
<a href="#l69.1030"></a><span id="l69.1030" class="difflineminus">-      this.changeStatus(TaskConstants.STATUS_SUBMITTED);</span>
<a href="#l69.1031"></a><span id="l69.1031" class="difflineminus">-      callback(true);</span>
<a href="#l69.1032"></a><span id="l69.1032" class="difflineminus">-    }</span>
<a href="#l69.1033"></a><span id="l69.1033" class="difflineminus">-  },</span>
<a href="#l69.1034"></a><span id="l69.1034" class="difflineminus">-</span>
<a href="#l69.1035"></a><span id="l69.1035" class="difflineminus">-  _prependMetadataToJSON: function TestPilotSurvey__prependToJson(callback) {</span>
<a href="#l69.1036"></a><span id="l69.1036" class="difflineminus">-    let json = {};</span>
<a href="#l69.1037"></a><span id="l69.1037" class="difflineminus">-    let self = this;</span>
<a href="#l69.1038"></a><span id="l69.1038" class="difflineminus">-    MetadataCollector.getMetadata(function(md) {</span>
<a href="#l69.1039"></a><span id="l69.1039" class="difflineminus">-      json.metadata = md;</span>
<a href="#l69.1040"></a><span id="l69.1040" class="difflineminus">-      if (self._studyId) {</span>
<a href="#l69.1041"></a><span id="l69.1041" class="difflineminus">-        // Include guid of the study that this survey is related to, so we</span>
<a href="#l69.1042"></a><span id="l69.1042" class="difflineminus">-        // can match them up server-side.</span>
<a href="#l69.1043"></a><span id="l69.1043" class="difflineminus">-        json.metadata.task_guid = self.getGuid(self._studyId);</span>
<a href="#l69.1044"></a><span id="l69.1044" class="difflineminus">-      }</span>
<a href="#l69.1045"></a><span id="l69.1045" class="difflineminus">-      let prefName = SURVEY_ANSWER_PREFIX + self._id;</span>
<a href="#l69.1046"></a><span id="l69.1046" class="difflineminus">-      let surveyAnswers;</span>
<a href="#l69.1047"></a><span id="l69.1047" class="difflineminus">-      if (self._prefs.prefHasUserValue(prefName)) {</span>
<a href="#l69.1048"></a><span id="l69.1048" class="difflineminus">-        surveyAnswers = JSON.parse(this._prefs.getCharPref(prefName));</span>
<a href="#l69.1049"></a><span id="l69.1049" class="difflineminus">-      } else {</span>
<a href="#l69.1050"></a><span id="l69.1050" class="difflineminus">-        surveyAnswers = JSON.parse(&quot;{}&quot;);</span>
<a href="#l69.1051"></a><span id="l69.1051" class="difflineminus">-      }</span>
<a href="#l69.1052"></a><span id="l69.1052" class="difflineminus">-      json.survey_data = sanitizeJSONStrings(surveyAnswers);</span>
<a href="#l69.1053"></a><span id="l69.1053" class="difflineminus">-      callback(JSON.stringify(json));</span>
<a href="#l69.1054"></a><span id="l69.1054" class="difflineminus">-    });</span>
<a href="#l69.1055"></a><span id="l69.1055" class="difflineminus">-  },</span>
<a href="#l69.1056"></a><span id="l69.1056" class="difflineminus">-</span>
<a href="#l69.1057"></a><span id="l69.1057" class="difflineminus">-  // Upload function for survey -- TODO this duplicates a lot of code</span>
<a href="#l69.1058"></a><span id="l69.1058" class="difflineminus">-  // from study._upload().</span>
<a href="#l69.1059"></a><span id="l69.1059" class="difflineminus">-  _upload: function TestPilotSurvey__upload(callback, retryCount) {</span>
<a href="#l69.1060"></a><span id="l69.1060" class="difflineminus">-    let self = this;</span>
<a href="#l69.1061"></a><span id="l69.1061" class="difflineminus">-    this._prependMetadataToJSON(function(params) {</span>
<a href="#l69.1062"></a><span id="l69.1062" class="difflineminus">-      let req =</span>
<a href="#l69.1063"></a><span id="l69.1063" class="difflineminus">-        Cc[&quot;@mozilla.org/xmlextras/xmlhttprequest;1&quot;].</span>
<a href="#l69.1064"></a><span id="l69.1064" class="difflineminus">-          createInstance(Ci.nsIXMLHttpRequest);</span>
<a href="#l69.1065"></a><span id="l69.1065" class="difflineminus">-      let url = self.uploadUrl;</span>
<a href="#l69.1066"></a><span id="l69.1066" class="difflineminus">-      req.open(&quot;POST&quot;, url, true);</span>
<a href="#l69.1067"></a><span id="l69.1067" class="difflineminus">-      req.setRequestHeader(&quot;Content-type&quot;, &quot;application/json&quot;);</span>
<a href="#l69.1068"></a><span id="l69.1068" class="difflineminus">-      req.setRequestHeader(&quot;Content-length&quot;, params.length);</span>
<a href="#l69.1069"></a><span id="l69.1069" class="difflineminus">-      req.setRequestHeader(&quot;Connection&quot;, &quot;close&quot;);</span>
<a href="#l69.1070"></a><span id="l69.1070" class="difflineminus">-      req.onreadystatechange = function(aEvt) {</span>
<a href="#l69.1071"></a><span id="l69.1071" class="difflineminus">-        if (req.readyState == 4) {</span>
<a href="#l69.1072"></a><span id="l69.1072" class="difflineminus">-          if (req.status == 200 || req.status == 201 ||</span>
<a href="#l69.1073"></a><span id="l69.1073" class="difflineminus">-             req.status == 202) {</span>
<a href="#l69.1074"></a><span id="l69.1074" class="difflineminus">-            self._logger.info(</span>
<a href="#l69.1075"></a><span id="l69.1075" class="difflineminus">-	    &quot;DATA WAS POSTED SUCCESSFULLY &quot; + req.responseText);</span>
<a href="#l69.1076"></a><span id="l69.1076" class="difflineminus">-            if (self._uploadRetryTimer) {</span>
<a href="#l69.1077"></a><span id="l69.1077" class="difflineminus">-              self._uploadRetryTimer.cancel(); // Stop retrying - it worked!</span>
<a href="#l69.1078"></a><span id="l69.1078" class="difflineminus">-	    }</span>
<a href="#l69.1079"></a><span id="l69.1079" class="difflineminus">-            self.changeStatus(TaskConstants.STATUS_SUBMITTED);</span>
<a href="#l69.1080"></a><span id="l69.1080" class="difflineminus">-	    callback(true);</span>
<a href="#l69.1081"></a><span id="l69.1081" class="difflineminus">-	  } else {</span>
<a href="#l69.1082"></a><span id="l69.1082" class="difflineminus">-	    self._logger.warn(req.status + &quot; ERROR POSTING DATA: &quot; + req.responseText);</span>
<a href="#l69.1083"></a><span id="l69.1083" class="difflineminus">-	    self._uploadRetryTimer =</span>
<a href="#l69.1084"></a><span id="l69.1084" class="difflineminus">-	      Cc[&quot;@mozilla.org/timer;1&quot;].createInstance(Ci.nsITimer);</span>
<a href="#l69.1085"></a><span id="l69.1085" class="difflineminus">-</span>
<a href="#l69.1086"></a><span id="l69.1086" class="difflineminus">-	    if (!retryCount) {</span>
<a href="#l69.1087"></a><span id="l69.1087" class="difflineminus">-              retryCount = 0;</span>
<a href="#l69.1088"></a><span id="l69.1088" class="difflineminus">-	    }</span>
<a href="#l69.1089"></a><span id="l69.1089" class="difflineminus">-	    let interval = this._prefs.getIntPref(RETRY_INTERVAL_PREF); // 1 hour</span>
<a href="#l69.1090"></a><span id="l69.1090" class="difflineminus">-	    let delay = Math.random() * Math.pow(2, retryCount) * interval;</span>
<a href="#l69.1091"></a><span id="l69.1091" class="difflineminus">-	    self._uploadRetryTimer.initWithCallback(</span>
<a href="#l69.1092"></a><span id="l69.1092" class="difflineminus">-              { notify: function(timer) {</span>
<a href="#l69.1093"></a><span id="l69.1093" class="difflineminus">-	          self._upload(callback, retryCount++);</span>
<a href="#l69.1094"></a><span id="l69.1094" class="difflineminus">-	        } }, (interval + delay), Ci.nsITimer.TYPE_ONE_SHOT);</span>
<a href="#l69.1095"></a><span id="l69.1095" class="difflineminus">-	    callback(false);</span>
<a href="#l69.1096"></a><span id="l69.1096" class="difflineminus">-	  }</span>
<a href="#l69.1097"></a><span id="l69.1097" class="difflineminus">-        }</span>
<a href="#l69.1098"></a><span id="l69.1098" class="difflineminus">-      };</span>
<a href="#l69.1099"></a><span id="l69.1099" class="difflineminus">-      req.send(params);</span>
<a href="#l69.1100"></a><span id="l69.1100" class="difflineminus">-    });</span>
<a href="#l69.1101"></a><span id="l69.1101" class="difflineminus">-  }</span>
<a href="#l69.1102"></a><span id="l69.1102" class="difflineminus">-};</span>
<a href="#l69.1103"></a><span id="l69.1103" class="difflineminus">-TestPilotBuiltinSurvey.prototype.__proto__ = TestPilotTask;</span>
<a href="#l69.1104"></a><span id="l69.1104" class="difflineminus">-</span>
<a href="#l69.1105"></a><span id="l69.1105" class="difflineminus">-function TestPilotWebSurvey(surveyInfo) {</span>
<a href="#l69.1106"></a><span id="l69.1106" class="difflineminus">-  this._init(surveyInfo);</span>
<a href="#l69.1107"></a><span id="l69.1107" class="difflineminus">-}</span>
<a href="#l69.1108"></a><span id="l69.1108" class="difflineminus">-TestPilotWebSurvey.prototype = {</span>
<a href="#l69.1109"></a><span id="l69.1109" class="difflineminus">-  _init: function TestPilotWebSurvey__init(surveyInfo) {</span>
<a href="#l69.1110"></a><span id="l69.1110" class="difflineminus">-    this._taskInit(surveyInfo.surveyId,</span>
<a href="#l69.1111"></a><span id="l69.1111" class="difflineminus">-                   surveyInfo.surveyName,</span>
<a href="#l69.1112"></a><span id="l69.1112" class="difflineminus">-                   surveyInfo.surveyUrl,</span>
<a href="#l69.1113"></a><span id="l69.1113" class="difflineminus">-                   surveyInfo.summary,</span>
<a href="#l69.1114"></a><span id="l69.1114" class="difflineminus">-                   surveyInfo.thumbnail);</span>
<a href="#l69.1115"></a><span id="l69.1115" class="difflineminus">-    this._logger.info(&quot;Initing survey.  This._status is &quot; + this._status);</span>
<a href="#l69.1116"></a><span id="l69.1116" class="difflineminus">-  },</span>
<a href="#l69.1117"></a><span id="l69.1117" class="difflineminus">-</span>
<a href="#l69.1118"></a><span id="l69.1118" class="difflineminus">-  get taskType() {</span>
<a href="#l69.1119"></a><span id="l69.1119" class="difflineminus">-    return TaskConstants.TYPE_SURVEY;</span>
<a href="#l69.1120"></a><span id="l69.1120" class="difflineminus">-  },</span>
<a href="#l69.1121"></a><span id="l69.1121" class="difflineminus">-</span>
<a href="#l69.1122"></a><span id="l69.1122" class="difflineminus">-  get defaultUrl() {</span>
<a href="#l69.1123"></a><span id="l69.1123" class="difflineminus">-    return this.infoPageUrl;</span>
<a href="#l69.1124"></a><span id="l69.1124" class="difflineminus">-  },</span>
<a href="#l69.1125"></a><span id="l69.1125" class="difflineminus">-</span>
<a href="#l69.1126"></a><span id="l69.1126" class="difflineminus">-  onDetailPageOpened: function TPWS_onDetailPageOpened() {</span>
<a href="#l69.1127"></a><span id="l69.1127" class="difflineminus">-    /* Once you view the URL of the survey, we'll assume you've taken it.</span>
<a href="#l69.1128"></a><span id="l69.1128" class="difflineminus">-     * There's no reliable way to tell whether you have or not, so let's</span>
<a href="#l69.1129"></a><span id="l69.1129" class="difflineminus">-     * default to not bugging the user about it again.</span>
<a href="#l69.1130"></a><span id="l69.1130" class="difflineminus">-     */</span>
<a href="#l69.1131"></a><span id="l69.1131" class="difflineminus">-    if (this._status &lt; TaskConstants.STATUS_SUBMITTED) {</span>
<a href="#l69.1132"></a><span id="l69.1132" class="difflineminus">-      this.changeStatus( TaskConstants.STATUS_SUBMITTED, true );</span>
<a href="#l69.1133"></a><span id="l69.1133" class="difflineminus">-    }</span>
<a href="#l69.1134"></a><span id="l69.1134" class="difflineminus">-  }</span>
<a href="#l69.1135"></a><span id="l69.1135" class="difflineminus">-};</span>
<a href="#l69.1136"></a><span id="l69.1136" class="difflineminus">-TestPilotWebSurvey.prototype.__proto__ = TestPilotTask;</span>
<a href="#l69.1137"></a><span id="l69.1137" class="difflineminus">-</span>
<a href="#l69.1138"></a><span id="l69.1138" class="difflineminus">-</span>
<a href="#l69.1139"></a><span id="l69.1139" class="difflineminus">-function TestPilotStudyResults(resultsInfo) {</span>
<a href="#l69.1140"></a><span id="l69.1140" class="difflineminus">-  this._init(resultsInfo);</span>
<a href="#l69.1141"></a><span id="l69.1141" class="difflineminus">-};</span>
<a href="#l69.1142"></a><span id="l69.1142" class="difflineminus">-TestPilotStudyResults.prototype = {</span>
<a href="#l69.1143"></a><span id="l69.1143" class="difflineminus">-  _init: function TestPilotStudyResults__init(resultsInfo) {</span>
<a href="#l69.1144"></a><span id="l69.1144" class="difflineminus">-    this._taskInit( resultsInfo.id,</span>
<a href="#l69.1145"></a><span id="l69.1145" class="difflineminus">-                    resultsInfo.title,</span>
<a href="#l69.1146"></a><span id="l69.1146" class="difflineminus">-                    resultsInfo.url,</span>
<a href="#l69.1147"></a><span id="l69.1147" class="difflineminus">-                    resultsInfo.summary,</span>
<a href="#l69.1148"></a><span id="l69.1148" class="difflineminus">-                    resultsInfo.thumbnail);</span>
<a href="#l69.1149"></a><span id="l69.1149" class="difflineminus">-    this._studyId = resultsInfo.studyId; // what study do we belong to</span>
<a href="#l69.1150"></a><span id="l69.1150" class="difflineminus">-    this._pubDate = Date.parse(resultsInfo.date);</span>
<a href="#l69.1151"></a><span id="l69.1151" class="difflineminus">-  },</span>
<a href="#l69.1152"></a><span id="l69.1152" class="difflineminus">-</span>
<a href="#l69.1153"></a><span id="l69.1153" class="difflineminus">-  get taskType() {</span>
<a href="#l69.1154"></a><span id="l69.1154" class="difflineminus">-    return TaskConstants.TYPE_RESULTS;</span>
<a href="#l69.1155"></a><span id="l69.1155" class="difflineminus">-  },</span>
<a href="#l69.1156"></a><span id="l69.1156" class="difflineminus">-</span>
<a href="#l69.1157"></a><span id="l69.1157" class="difflineminus">-  get publishDate() {</span>
<a href="#l69.1158"></a><span id="l69.1158" class="difflineminus">-    return this._pubDate;</span>
<a href="#l69.1159"></a><span id="l69.1159" class="difflineminus">-  },</span>
<a href="#l69.1160"></a><span id="l69.1160" class="difflineminus">-</span>
<a href="#l69.1161"></a><span id="l69.1161" class="difflineminus">-  get relatedStudyId() {</span>
<a href="#l69.1162"></a><span id="l69.1162" class="difflineminus">-    return this._studyId;</span>
<a href="#l69.1163"></a><span id="l69.1163" class="difflineminus">-  }</span>
<a href="#l69.1164"></a><span id="l69.1164" class="difflineminus">-};</span>
<a href="#l69.1165"></a><span id="l69.1165" class="difflineminus">-TestPilotStudyResults.prototype.__proto__ = TestPilotTask;</span>
<a href="#l69.1166"></a><span id="l69.1166" class="difflineminus">-</span>
<a href="#l69.1167"></a><span id="l69.1167" class="difflineminus">-function TestPilotLegacyStudy(studyInfo) {</span>
<a href="#l69.1168"></a><span id="l69.1168" class="difflineminus">-  this._init(studyInfo);</span>
<a href="#l69.1169"></a><span id="l69.1169" class="difflineminus">-};</span>
<a href="#l69.1170"></a><span id="l69.1170" class="difflineminus">-TestPilotLegacyStudy.prototype = {</span>
<a href="#l69.1171"></a><span id="l69.1171" class="difflineminus">-  _init: function TestPilotLegacyStudy__init(studyInfo) {</span>
<a href="#l69.1172"></a><span id="l69.1172" class="difflineminus">-    let stat = null;</span>
<a href="#l69.1173"></a><span id="l69.1173" class="difflineminus">-    let prefName = STATUS_PREF_PREFIX + studyInfo.id;</span>
<a href="#l69.1174"></a><span id="l69.1174" class="difflineminus">-    if (this._prefs.prefHasUserValue(prefName)) {</span>
<a href="#l69.1175"></a><span id="l69.1175" class="difflineminus">-      stat = this._prefs.getIntPref(prefName);</span>
<a href="#l69.1176"></a><span id="l69.1176" class="difflineminus">-    }</span>
<a href="#l69.1177"></a><span id="l69.1177" class="difflineminus">-    this._taskInit( studyInfo.id,</span>
<a href="#l69.1178"></a><span id="l69.1178" class="difflineminus">-                    studyInfo.name,</span>
<a href="#l69.1179"></a><span id="l69.1179" class="difflineminus">-                    studyInfo.url,</span>
<a href="#l69.1180"></a><span id="l69.1180" class="difflineminus">-                    studyInfo.summary,</span>
<a href="#l69.1181"></a><span id="l69.1181" class="difflineminus">-                    studyInfo.thumbnail );</span>
<a href="#l69.1182"></a><span id="l69.1182" class="difflineminus">-</span>
<a href="#l69.1183"></a><span id="l69.1183" class="difflineminus">-    /* Only three statuses are valid for legacy studies: It must be either</span>
<a href="#l69.1184"></a><span id="l69.1184" class="difflineminus">-     * canceled, archived (meaning you submitted it), or missed (you never ran it).</span>
<a href="#l69.1185"></a><span id="l69.1185" class="difflineminus">-     * Set status to one of these.</span>
<a href="#l69.1186"></a><span id="l69.1186" class="difflineminus">-     */</span>
<a href="#l69.1187"></a><span id="l69.1187" class="difflineminus">-    switch (stat) {</span>
<a href="#l69.1188"></a><span id="l69.1188" class="difflineminus">-    case TaskConstants.STATUS_CANCELLED:</span>
<a href="#l69.1189"></a><span id="l69.1189" class="difflineminus">-    case TaskConstants.STATUS_ARCHIVED:</span>
<a href="#l69.1190"></a><span id="l69.1190" class="difflineminus">-    case TaskConstants.STATUS_MISSED:</span>
<a href="#l69.1191"></a><span id="l69.1191" class="difflineminus">-      // Keep that status, so do nothing</span>
<a href="#l69.1192"></a><span id="l69.1192" class="difflineminus">-      break;</span>
<a href="#l69.1193"></a><span id="l69.1193" class="difflineminus">-    case TaskConstants.STATUS_SUBMITTED:</span>
<a href="#l69.1194"></a><span id="l69.1194" class="difflineminus">-      // Change submitted to archived</span>
<a href="#l69.1195"></a><span id="l69.1195" class="difflineminus">-      this.changeStatus(TaskConstants.STATUS_ARCHIVED, true);</span>
<a href="#l69.1196"></a><span id="l69.1196" class="difflineminus">-      break;</span>
<a href="#l69.1197"></a><span id="l69.1197" class="difflineminus">-    default:</span>
<a href="#l69.1198"></a><span id="l69.1198" class="difflineminus">-      // Anything else means you missed it</span>
<a href="#l69.1199"></a><span id="l69.1199" class="difflineminus">-      this.changeStatus(TaskConstants.STATUS_MISSED, true);</span>
<a href="#l69.1200"></a><span id="l69.1200" class="difflineminus">-    }</span>
<a href="#l69.1201"></a><span id="l69.1201" class="difflineminus">-</span>
<a href="#l69.1202"></a><span id="l69.1202" class="difflineminus">-    if (studyInfo.duration) {</span>
<a href="#l69.1203"></a><span id="l69.1203" class="difflineminus">-      let prefName = START_DATE_PREF_PREFIX + this._id;</span>
<a href="#l69.1204"></a><span id="l69.1204" class="difflineminus">-      if (this._prefs.prefHasUserValue(prefName)) {</span>
<a href="#l69.1205"></a><span id="l69.1205" class="difflineminus">-        let startDateString = this._prefs.getCharPref(prefName);</span>
<a href="#l69.1206"></a><span id="l69.1206" class="difflineminus">-        this._startDate = Date.parse(startDateString);</span>
<a href="#l69.1207"></a><span id="l69.1207" class="difflineminus">-        this._endDate = this._startDate + duration * (24 * 60 * 60 * 1000);</span>
<a href="#l69.1208"></a><span id="l69.1208" class="difflineminus">-      }</span>
<a href="#l69.1209"></a><span id="l69.1209" class="difflineminus">-    }</span>
<a href="#l69.1210"></a><span id="l69.1210" class="difflineminus">-  },</span>
<a href="#l69.1211"></a><span id="l69.1211" class="difflineminus">-</span>
<a href="#l69.1212"></a><span id="l69.1212" class="difflineminus">-  get taskType() {</span>
<a href="#l69.1213"></a><span id="l69.1213" class="difflineminus">-    return TaskConstants.TYPE_LEGACY;</span>
<a href="#l69.1214"></a><span id="l69.1214" class="difflineminus">-  }</span>
<a href="#l69.1215"></a><span id="l69.1215" class="difflineminus">-  // TODO test that they don't say &quot;thanks for contributing&quot; if the</span>
<a href="#l69.1216"></a><span id="l69.1216" class="difflineminus">-  // user didn't actually complete them...</span>
<a href="#l69.1217"></a><span id="l69.1217" class="difflineminus">-};</span>
<a href="#l69.1218"></a><span id="l69.1218" class="difflineminus">-TestPilotLegacyStudy.prototype.__proto__ = TestPilotTask;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l70.1"></a><span id="l70.1">deleted file mode 100644</span>
<a href="#l70.2"></a><span id="l70.2">index 865218dfa4679e7629119645a5e2e1b87b7c1ea1..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l70.3"></a><span id="l70.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l71.1"></a><span id="l71.1">deleted file mode 100644</span>
<a href="#l71.2"></a><span id="l71.2">index ab1335e69de65199742e912b8d95651dba1f1908..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l71.3"></a><span id="l71.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l72.1"></a><span id="l72.1">deleted file mode 100644</span>
<a href="#l72.2"></a><span id="l72.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/css/screen-standalone-mobile.css</span>
<a href="#l72.3"></a><span id="l72.3" class="difflineplus">+++ /dev/null</span>
<a href="#l72.4"></a><span id="l72.4" class="difflineat">@@ -1,309 +0,0 @@</span>
<a href="#l72.5"></a><span id="l72.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l72.6"></a><span id="l72.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l72.7"></a><span id="l72.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l72.8"></a><span id="l72.8" class="difflineminus">-</span>
<a href="#l72.9"></a><span id="l72.9" class="difflineminus">-</span>
<a href="#l72.10"></a><span id="l72.10" class="difflineminus">-.initially-hidden {</span>
<a href="#l72.11"></a><span id="l72.11" class="difflineminus">-    display: none;</span>
<a href="#l72.12"></a><span id="l72.12" class="difflineminus">-}</span>
<a href="#l72.13"></a><span id="l72.13" class="difflineminus">-</span>
<a href="#l72.14"></a><span id="l72.14" class="difflineminus">-html {</span>
<a href="#l72.15"></a><span id="l72.15" class="difflineminus">-	padding-bottom: 40px; </span>
<a href="#l72.16"></a><span id="l72.16" class="difflineminus">-	padding-top: 20px;</span>
<a href="#l72.17"></a><span id="l72.17" class="difflineminus">-	padding-left: 0px;</span>
<a href="#l72.18"></a><span id="l72.18" class="difflineminus">-	padding-right: 0px;</span>
<a href="#l72.19"></a><span id="l72.19" class="difflineminus">-}</span>
<a href="#l72.20"></a><span id="l72.20" class="difflineminus">-</span>
<a href="#l72.21"></a><span id="l72.21" class="difflineminus">-body { </span>
<a href="#l72.22"></a><span id="l72.22" class="difflineminus">-	font-family: 'Lucida Grande', 'Lucida Sans Unicode', Lucida, Arial, Helvetica, sans-serif;</span>
<a href="#l72.23"></a><span id="l72.23" class="difflineminus">-	background: #fff;</span>
<a href="#l72.24"></a><span id="l72.24" class="difflineminus">-        padding: 0px; </span>
<a href="#l72.25"></a><span id="l72.25" class="difflineminus">-	color:#787878;</span>
<a href="#l72.26"></a><span id="l72.26" class="difflineminus">-	margin: 0 auto;</span>
<a href="#l72.27"></a><span id="l72.27" class="difflineminus">-}</span>
<a href="#l72.28"></a><span id="l72.28" class="difflineminus">-</span>
<a href="#l72.29"></a><span id="l72.29" class="difflineminus">-.section-title {</span>
<a href="#l72.30"></a><span id="l72.30" class="difflineminus">-    color: #54717b; font-size: 24px; line-height: 24px;font-weight: normal; letter-spacing: -1px</span>
<a href="#l72.31"></a><span id="l72.31" class="difflineminus">-}</span>
<a href="#l72.32"></a><span id="l72.32" class="difflineminus">-</span>
<a href="#l72.33"></a><span id="l72.33" class="difflineminus">-	h1 {color: #3a3a3a; font-size: 28px; font-weight: normal; letter-spacing: -1px}</span>
<a href="#l72.34"></a><span id="l72.34" class="difflineminus">-	h2 {color: #54717b; font-size: 24px; line-height: 24px;font-weight: normal; letter-spacing: -1px}</span>
<a href="#l72.35"></a><span id="l72.35" class="difflineminus">-	h3 {color: #54717b; font-size: 18px; line-height: 18px;font-weight: normal; letter-spacing: -1px}</span>
<a href="#l72.36"></a><span id="l72.36" class="difflineminus">-	</span>
<a href="#l72.37"></a><span id="l72.37" class="difflineminus">-	p, ul {font-size: 12px;}</span>
<a href="#l72.38"></a><span id="l72.38" class="difflineminus">-</span>
<a href="#l72.39"></a><span id="l72.39" class="difflineminus">-button {font-size: 18px;}</span>
<a href="#l72.40"></a><span id="l72.40" class="difflineminus">-	</span>
<a href="#l72.41"></a><span id="l72.41" class="difflineminus">-	a {</span>
<a href="#l72.42"></a><span id="l72.42" class="difflineminus">-            font-size: 18px;</span>
<a href="#l72.43"></a><span id="l72.43" class="difflineminus">-            color: #9f423b;</span>
<a href="#l72.44"></a><span id="l72.44" class="difflineminus">-            text-decoration: none;</span>
<a href="#l72.45"></a><span id="l72.45" class="difflineminus">-        }</span>
<a href="#l72.46"></a><span id="l72.46" class="difflineminus">-</span>
<a href="#l72.47"></a><span id="l72.47" class="difflineminus">-        h2 a {font-size: 24px;}</span>
<a href="#l72.48"></a><span id="l72.48" class="difflineminus">-        h1 a {font-size: 28px;}</span>
<a href="#l72.49"></a><span id="l72.49" class="difflineminus">-</span>
<a href="#l72.50"></a><span id="l72.50" class="difflineminus">-        a:hover, a:active {</span>
<a href="#l72.51"></a><span id="l72.51" class="difflineminus">-            text-decoration: underline;</span>
<a href="#l72.52"></a><span id="l72.52" class="difflineminus">-        }</span>
<a href="#l72.53"></a><span id="l72.53" class="difflineminus">-	</span>
<a href="#l72.54"></a><span id="l72.54" class="difflineminus">-	.bold {color:#3a3a3a;}</span>
<a href="#l72.55"></a><span id="l72.55" class="difflineminus">-	.address {margin-left: 20px;}</span>
<a href="#l72.56"></a><span id="l72.56" class="difflineminus">-	.inactive {color:#ccc;}</span>
<a href="#l72.57"></a><span id="l72.57" class="difflineminus">-	</span>
<a href="#l72.58"></a><span id="l72.58" class="difflineminus">-	li {list-style-type: circle;}</span>
<a href="#l72.59"></a><span id="l72.59" class="difflineminus">-</span>
<a href="#l72.60"></a><span id="l72.60" class="difflineminus">-	.spacer {height: 40px;}</span>
<a href="#l72.61"></a><span id="l72.61" class="difflineminus">-	</span>
<a href="#l72.62"></a><span id="l72.62" class="difflineminus">-	.center {text-align: center;}</span>
<a href="#l72.63"></a><span id="l72.63" class="difflineminus">-</span>
<a href="#l72.64"></a><span id="l72.64" class="difflineminus">-	.data {</span>
<a href="#l72.65"></a><span id="l72.65" class="difflineminus">-	</span>
<a href="#l72.66"></a><span id="l72.66" class="difflineminus">-	    background-color: #fff;</span>
<a href="#l72.67"></a><span id="l72.67" class="difflineminus">-        margin-bottom: 6px;</span>
<a href="#l72.68"></a><span id="l72.68" class="difflineminus">-        border: 1px solid rgba(133, 153, 166, 0.2);</span>
<a href="#l72.69"></a><span id="l72.69" class="difflineminus">-        border-bottom: 4px solid rgba(133, 153, 166, 0.2);</span>
<a href="#l72.70"></a><span id="l72.70" class="difflineminus">-		-moz-border-bottom-colors:rgba(133, 153, 166, 0.3) rgba(133, 153, 166, 0.2) rgba(133, 153, 166, 0.2) rgba(133, 153, 166, 0.2);</span>
<a href="#l72.71"></a><span id="l72.71" class="difflineminus">-        padding: 6px;</span>
<a href="#l72.72"></a><span id="l72.72" class="difflineminus">-        box-shadow:</span>
<a href="#l72.73"></a><span id="l72.73" class="difflineminus">-			rgba(133, 153, 166, 0.4) 0px 1px 24px;</span>
<a href="#l72.74"></a><span id="l72.74" class="difflineminus">-		</span>
<a href="#l72.75"></a><span id="l72.75" class="difflineminus">-	}</span>
<a href="#l72.76"></a><span id="l72.76" class="difflineminus">-	</span>
<a href="#l72.77"></a><span id="l72.77" class="difflineminus">-	.dataBox {</span>
<a href="#l72.78"></a><span id="l72.78" class="difflineminus">-		font-size: 16px;</span>
<a href="#l72.79"></a><span id="l72.79" class="difflineminus">-		padding: 6px 20px 20px 20px;</span>
<a href="#l72.80"></a><span id="l72.80" class="difflineminus">-		border-radius: 0.5em;</span>
<a href="#l72.81"></a><span id="l72.81" class="difflineminus">-		background: rgba(220, 240, 247, 0.8) url('chrome://testpilot/skin/images/callout.png') no-repeat top center;</span>
<a href="#l72.82"></a><span id="l72.82" class="difflineminus">-		/* display: inline; */</span>
<a href="#l72.83"></a><span id="l72.83" class="difflineminus">-	}</span>
<a href="#l72.84"></a><span id="l72.84" class="difflineminus">-</span>
<a href="#l72.85"></a><span id="l72.85" class="difflineminus">-#container {</span>
<a href="#l72.86"></a><span id="l72.86" class="difflineminus">-	margin: 0px auto;</span>
<a href="#l72.87"></a><span id="l72.87" class="difflineminus">-</span>
<a href="#l72.88"></a><span id="l72.88" class="difflineminus">-}</span>
<a href="#l72.89"></a><span id="l72.89" class="difflineminus">-</span>
<a href="#l72.90"></a><span id="l72.90" class="difflineminus">-#logo {</span>
<a href="#l72.91"></a><span id="l72.91" class="difflineminus">-	margin-left: 20px;</span>
<a href="#l72.92"></a><span id="l72.92" class="difflineminus">-}</span>
<a href="#l72.93"></a><span id="l72.93" class="difflineminus">-</span>
<a href="#l72.94"></a><span id="l72.94" class="difflineminus">-#contentWelcome {</span>
<a href="#l72.95"></a><span id="l72.95" class="difflineminus">-	margin-top: 380px;</span>
<a href="#l72.96"></a><span id="l72.96" class="difflineminus">-	padding: 8px 24px 24px 24px;</span>
<a href="#l72.97"></a><span id="l72.97" class="difflineminus">-	text-align: left;</span>
<a href="#l72.98"></a><span id="l72.98" class="difflineminus">-}</span>
<a href="#l72.99"></a><span id="l72.99" class="difflineminus">-</span>
<a href="#l72.100"></a><span id="l72.100" class="difflineminus">-#content-standalone {</span>
<a href="#l72.101"></a><span id="l72.101" class="difflineminus">-	padding: 8px 24px 24px 24px;</span>
<a href="#l72.102"></a><span id="l72.102" class="difflineminus">-	text-align: left;</span>
<a href="#l72.103"></a><span id="l72.103" class="difflineminus">-}</span>
<a href="#l72.104"></a><span id="l72.104" class="difflineminus">-</span>
<a href="#l72.105"></a><span id="l72.105" class="difflineminus">-#download {</span>
<a href="#l72.106"></a><span id="l72.106" class="difflineminus">-	width: 300px;</span>
<a href="#l72.107"></a><span id="l72.107" class="difflineminus">-	margin-left: 410px;</span>
<a href="#l72.108"></a><span id="l72.108" class="difflineminus">-	margin-top: 240px;</span>
<a href="#l72.109"></a><span id="l72.109" class="difflineminus">-}</span>
<a href="#l72.110"></a><span id="l72.110" class="difflineminus">-</span>
<a href="#l72.111"></a><span id="l72.111" class="difflineminus">-.downloadButton {</span>
<a href="#l72.112"></a><span id="l72.112" class="difflineminus">-	margin-bottom: -10px;</span>
<a href="#l72.113"></a><span id="l72.113" class="difflineminus">-	margin-top: -2px;</span>
<a href="#l72.114"></a><span id="l72.114" class="difflineminus">-	margin-right: 12px;</span>
<a href="#l72.115"></a><span id="l72.115" class="difflineminus">-}</span>
<a href="#l72.116"></a><span id="l72.116" class="difflineminus">-</span>
<a href="#l72.117"></a><span id="l72.117" class="difflineminus">-.downloadH1 {color: #3a3a3a; font-size: 24px; font-weight: normal; letter-spacing: -1px; margin-right: 8px;}</span>
<a href="#l72.118"></a><span id="l72.118" class="difflineminus">-</span>
<a href="#l72.119"></a><span id="l72.119" class="difflineminus">-.downloadH2 {color: #3a3a3a; font-size: 22px; font-weight: normal; letter-spacing: -1px; line-height: 28px; margin-left: 46px;}</span>
<a href="#l72.120"></a><span id="l72.120" class="difflineminus">-</span>
<a href="#l72.121"></a><span id="l72.121" class="difflineminus">-#intro {</span>
<a href="#l72.122"></a><span id="l72.122" class="difflineminus">-	float: left;</span>
<a href="#l72.123"></a><span id="l72.123" class="difflineminus">-	width: 500px;</span>
<a href="#l72.124"></a><span id="l72.124" class="difflineminus">-	margin-top: 30px;</span>
<a href="#l72.125"></a><span id="l72.125" class="difflineminus">-}</span>
<a href="#l72.126"></a><span id="l72.126" class="difflineminus">-</span>
<a href="#l72.127"></a><span id="l72.127" class="difflineminus">-#links {</span>
<a href="#l72.128"></a><span id="l72.128" class="difflineminus">-	float: right;</span>
<a href="#l72.129"></a><span id="l72.129" class="difflineminus">-	padding: 24px 0px;</span>
<a href="#l72.130"></a><span id="l72.130" class="difflineminus">-	margin-right: 0px;</span>
<a href="#l72.131"></a><span id="l72.131" class="difflineminus">-	margin-top: 260px;</span>
<a href="#l72.132"></a><span id="l72.132" class="difflineminus">-}</span>
<a href="#l72.133"></a><span id="l72.133" class="difflineminus">-</span>
<a href="#l72.134"></a><span id="l72.134" class="difflineminus">-.button {</span>
<a href="#l72.135"></a><span id="l72.135" class="difflineminus">-	font-size: 16px;</span>
<a href="#l72.136"></a><span id="l72.136" class="difflineminus">-	padding: 8px 12px;</span>
<a href="#l72.137"></a><span id="l72.137" class="difflineminus">-	color: rgba(0, 0, 0, 0.8);</span>
<a href="#l72.138"></a><span id="l72.138" class="difflineminus">-	border-radius: 0.5em;</span>
<a href="#l72.139"></a><span id="l72.139" class="difflineminus">-	box-shadow: </span>
<a href="#l72.140"></a><span id="l72.140" class="difflineminus">-		inset rgba(0, 0, 0, 0.2) 0 1px 1px,</span>
<a href="#l72.141"></a><span id="l72.141" class="difflineminus">-		inset rgba(255, 255, 255, 1) 0 3px 1px,</span>
<a href="#l72.142"></a><span id="l72.142" class="difflineminus">-		inset rgba(255, 255, 255, 0.3) 0 16px 0px,</span>
<a href="#l72.143"></a><span id="l72.143" class="difflineminus">-		inset rgba(0, 0, 0, 0.2) 0 -1px 1px,</span>
<a href="#l72.144"></a><span id="l72.144" class="difflineminus">-		inset rgba(0, 0, 0, 0.1) 0 -2px 1px, </span>
<a href="#l72.145"></a><span id="l72.145" class="difflineminus">-		rgba(255, 255, 255, 1) 0 1px,</span>
<a href="#l72.146"></a><span id="l72.146" class="difflineminus">-		rgba(133, 153, 166, 0.3) 0px 1px 12px;</span>
<a href="#l72.147"></a><span id="l72.147" class="difflineminus">-	background-color: #e7eaec;</span>
<a href="#l72.148"></a><span id="l72.148" class="difflineminus">-	/* display: inline; */</span>
<a href="#l72.149"></a><span id="l72.149" class="difflineminus">-}</span>
<a href="#l72.150"></a><span id="l72.150" class="difflineminus">-</span>
<a href="#l72.151"></a><span id="l72.151" class="difflineminus">-.home_button {</span>
<a href="#l72.152"></a><span id="l72.152" class="difflineminus">-	font-size: 16px;</span>
<a href="#l72.153"></a><span id="l72.153" class="difflineminus">-	padding: 8px 12px;</span>
<a href="#l72.154"></a><span id="l72.154" class="difflineminus">-	width: 240px;</span>
<a href="#l72.155"></a><span id="l72.155" class="difflineminus">-	color: rgba(0, 0, 0, 0.8);</span>
<a href="#l72.156"></a><span id="l72.156" class="difflineminus">-	border-radius: 0.5em;</span>
<a href="#l72.157"></a><span id="l72.157" class="difflineminus">-	box-shadow: </span>
<a href="#l72.158"></a><span id="l72.158" class="difflineminus">-		inset rgba(0, 0, 0, 0.2) 0 1px 1px,</span>
<a href="#l72.159"></a><span id="l72.159" class="difflineminus">-		inset rgba(255, 255, 255, 1) 0 3px 1px,</span>
<a href="#l72.160"></a><span id="l72.160" class="difflineminus">-		inset rgba(255, 255, 255, 0.3) 0 16px 0px,</span>
<a href="#l72.161"></a><span id="l72.161" class="difflineminus">-		inset rgba(0, 0, 0, 0.2) 0 -1px 1px,</span>
<a href="#l72.162"></a><span id="l72.162" class="difflineminus">-		inset rgba(0, 0, 0, 0.1) 0 -2px 1px, </span>
<a href="#l72.163"></a><span id="l72.163" class="difflineminus">-		rgba(255, 255, 255, 1) 0 1px,</span>
<a href="#l72.164"></a><span id="l72.164" class="difflineminus">-		rgba(133, 153, 166, 0.3) 0px 1px 12px;</span>
<a href="#l72.165"></a><span id="l72.165" class="difflineminus">-	background-color: #e7eaec;</span>
<a href="#l72.166"></a><span id="l72.166" class="difflineminus">-	/* display: inline; */</span>
<a href="#l72.167"></a><span id="l72.167" class="difflineminus">-}</span>
<a href="#l72.168"></a><span id="l72.168" class="difflineminus">-</span>
<a href="#l72.169"></a><span id="l72.169" class="difflineminus">-.callout {</span>
<a href="#l72.170"></a><span id="l72.170" class="difflineminus">-	font-size: 16px;</span>
<a href="#l72.171"></a><span id="l72.171" class="difflineminus">-	padding: 8px 24px;</span>
<a href="#l72.172"></a><span id="l72.172" class="difflineminus">-	margin: 24px auto;</span>
<a href="#l72.173"></a><span id="l72.173" class="difflineminus">-	color: rgba(0, 0, 0, 0.8);</span>
<a href="#l72.174"></a><span id="l72.174" class="difflineminus">-	border-radius: 0.5em;</span>
<a href="#l72.175"></a><span id="l72.175" class="difflineminus">-	background: rgba(220, 240, 247, 0.8) url('chrome://testpilot/skin/images/callout.png') no-repeat top center;</span>
<a href="#l72.176"></a><span id="l72.176" class="difflineminus">-	box-shadow: </span>
<a href="#l72.177"></a><span id="l72.177" class="difflineminus">-		inset rgba(185, 221, 234, 0.2) 0 -10px 12px,</span>
<a href="#l72.178"></a><span id="l72.178" class="difflineminus">-		inset rgba(185, 221, 234, 1) 0 0px 1px,</span>
<a href="#l72.179"></a><span id="l72.179" class="difflineminus">-		inset rgba(255, 255, 255, 0.2) 0 10px 12px;</span>
<a href="#l72.180"></a><span id="l72.180" class="difflineminus">-	/* display: inline; */</span>
<a href="#l72.181"></a><span id="l72.181" class="difflineminus">-}</span>
<a href="#l72.182"></a><span id="l72.182" class="difflineminus">-</span>
<a href="#l72.183"></a><span id="l72.183" class="difflineminus">-#data-privacy-text {</span>
<a href="#l72.184"></a><span id="l72.184" class="difflineminus">-  width: 320px;</span>
<a href="#l72.185"></a><span id="l72.185" class="difflineminus">-  margin-bottom: 50px;</span>
<a href="#l72.186"></a><span id="l72.186" class="difflineminus">-}</span>
<a href="#l72.187"></a><span id="l72.187" class="difflineminus">-</span>
<a href="#l72.188"></a><span id="l72.188" class="difflineminus">-.home_callout {</span>
<a href="#l72.189"></a><span id="l72.189" class="difflineminus">-	font-size: 16px;</span>
<a href="#l72.190"></a><span id="l72.190" class="difflineminus">-	vertical-align: middle;</span>
<a href="#l72.191"></a><span id="l72.191" class="difflineminus">-	/* width: 280px;*/</span>
<a href="#l72.192"></a><span id="l72.192" class="difflineminus">-	padding: 8px 24px;</span>
<a href="#l72.193"></a><span id="l72.193" class="difflineminus">-	margin: 8px auto;</span>
<a href="#l72.194"></a><span id="l72.194" class="difflineminus">-	color: rgba(0, 0, 0, 0.8);</span>
<a href="#l72.195"></a><span id="l72.195" class="difflineminus">-	border-radius: 0.5em;</span>
<a href="#l72.196"></a><span id="l72.196" class="difflineminus">-	background: rgba(220, 240, 247, 0.8) url('chrome://testpilot/skin/images/callout.png') no-repeat top center;</span>
<a href="#l72.197"></a><span id="l72.197" class="difflineminus">-	box-shadow: </span>
<a href="#l72.198"></a><span id="l72.198" class="difflineminus">-		inset rgba(185, 221, 234, 0.2) 0 -10px 12px,</span>
<a href="#l72.199"></a><span id="l72.199" class="difflineminus">-		inset rgba(185, 221, 234, 1) 0 0px 1px,</span>
<a href="#l72.200"></a><span id="l72.200" class="difflineminus">-		inset rgba(255, 255, 255, 0.2) 0 10px 12px;</span>
<a href="#l72.201"></a><span id="l72.201" class="difflineminus">-	/* display: inline; */</span>
<a href="#l72.202"></a><span id="l72.202" class="difflineminus">-}</span>
<a href="#l72.203"></a><span id="l72.203" class="difflineminus">-</span>
<a href="#l72.204"></a><span id="l72.204" class="difflineminus">-.home_callout_continue {</span>
<a href="#l72.205"></a><span id="l72.205" class="difflineminus">-	font-size: 16px;</span>
<a href="#l72.206"></a><span id="l72.206" class="difflineminus">-	vertical-align: middle;</span>
<a href="#l72.207"></a><span id="l72.207" class="difflineminus">-	width: 280px;</span>
<a href="#l72.208"></a><span id="l72.208" class="difflineminus">-	padding: 8px 24px;</span>
<a href="#l72.209"></a><span id="l72.209" class="difflineminus">-	margin: 8px auto;</span>
<a href="#l72.210"></a><span id="l72.210" class="difflineminus">-	color: rgba(0, 0, 0, 0.8);</span>
<a href="#l72.211"></a><span id="l72.211" class="difflineminus">-	border-radius: 0.5em;</span>
<a href="#l72.212"></a><span id="l72.212" class="difflineminus">-	background: rgba(220, 240, 247, 0.8) url('chrome://testpilot/skin/images/callout_continue.png') no-repeat top center;</span>
<a href="#l72.213"></a><span id="l72.213" class="difflineminus">-	box-shadow: </span>
<a href="#l72.214"></a><span id="l72.214" class="difflineminus">-		inset rgba(185, 221, 234, 0.2) 0 -10px 12px,</span>
<a href="#l72.215"></a><span id="l72.215" class="difflineminus">-		inset rgba(185, 221, 234, 1) 0 0px 1px,</span>
<a href="#l72.216"></a><span id="l72.216" class="difflineminus">-		inset rgba(255, 255, 255, 0.2) 0 10px 12px;</span>
<a href="#l72.217"></a><span id="l72.217" class="difflineminus">-	/* display: inline; */</span>
<a href="#l72.218"></a><span id="l72.218" class="difflineminus">-}</span>
<a href="#l72.219"></a><span id="l72.219" class="difflineminus">-</span>
<a href="#l72.220"></a><span id="l72.220" class="difflineminus">-.home_callout_continue a {color: #6c9735; text-decoration: none;}</span>
<a href="#l72.221"></a><span id="l72.221" class="difflineminus">-.home_callout_continue a:hover {color: #6c9735; text-decoration: none; border-bottom: 1px dotted #6c9735;}</span>
<a href="#l72.222"></a><span id="l72.222" class="difflineminus">-</span>
<a href="#l72.223"></a><span id="l72.223" class="difflineminus">-</span>
<a href="#l72.224"></a><span id="l72.224" class="difflineminus">-.homeIcon {</span>
<a href="#l72.225"></a><span id="l72.225" class="difflineminus">-	margin-top: -32px;</span>
<a href="#l72.226"></a><span id="l72.226" class="difflineminus">-	margin-bottom: -32px;</span>
<a href="#l72.227"></a><span id="l72.227" class="difflineminus">-	margin-right: 12px;</span>
<a href="#l72.228"></a><span id="l72.228" class="difflineminus">-}</span>
<a href="#l72.229"></a><span id="l72.229" class="difflineminus">-</span>
<a href="#l72.230"></a><span id="l72.230" class="difflineminus">-.homeIconSubmit {</span>
<a href="#l72.231"></a><span id="l72.231" class="difflineminus">-	margin-top: -32px;</span>
<a href="#l72.232"></a><span id="l72.232" class="difflineminus">-	margin-bottom: -32px;</span>
<a href="#l72.233"></a><span id="l72.233" class="difflineminus">-	margin-right: 12px;</span>
<a href="#l72.234"></a><span id="l72.234" class="difflineminus">-	visibility: hidden;</span>
<a href="#l72.235"></a><span id="l72.235" class="difflineminus">-}</span>
<a href="#l72.236"></a><span id="l72.236" class="difflineminus">-</span>
<a href="#l72.237"></a><span id="l72.237" class="difflineminus">-#footer {</span>
<a href="#l72.238"></a><span id="l72.238" class="difflineminus">-	clear: both;</span>
<a href="#l72.239"></a><span id="l72.239" class="difflineminus">-	padding: 24px;</span>
<a href="#l72.240"></a><span id="l72.240" class="difflineminus">-	font-size: 9px;</span>
<a href="#l72.241"></a><span id="l72.241" class="difflineminus">-</span>
<a href="#l72.242"></a><span id="l72.242" class="difflineminus">-}</span>
<a href="#l72.243"></a><span id="l72.243" class="difflineminus">-</span>
<a href="#l72.244"></a><span id="l72.244" class="difflineminus">-.mozLogo {</span>
<a href="#l72.245"></a><span id="l72.245" class="difflineminus">-	margin-bottom: -10px;</span>
<a href="#l72.246"></a><span id="l72.246" class="difflineminus">-	margin-right: 6px;</span>
<a href="#l72.247"></a><span id="l72.247" class="difflineminus">-}</span>
<a href="#l72.248"></a><span id="l72.248" class="difflineminus">-</span>
<a href="#l72.249"></a><span id="l72.249" class="difflineminus">-/* ------- MENU ------- </span>
<a href="#l72.250"></a><span id="l72.250" class="difflineminus">-</span>
<a href="#l72.251"></a><span id="l72.251" class="difflineminus">-#menu {</span>
<a href="#l72.252"></a><span id="l72.252" class="difflineminus">-	margin: 20px auto;</span>
<a href="#l72.253"></a><span id="l72.253" class="difflineminus">-	max-width: 800px;</span>
<a href="#l72.254"></a><span id="l72.254" class="difflineminus">-	padding: 4px 40px;</span>
<a href="#l72.255"></a><span id="l72.255" class="difflineminus">-	width: 800px;</span>
<a href="#l72.256"></a><span id="l72.256" class="difflineminus">-	text-align: left;</span>
<a href="#l72.257"></a><span id="l72.257" class="difflineminus">-	border-radius: 0.25em;</span>
<a href="#l72.258"></a><span id="l72.258" class="difflineminus">-	border-top: 1px solid #adb6ba;</span>
<a href="#l72.259"></a><span id="l72.259" class="difflineminus">-	border-left: 1px solid #adb6ba;</span>
<a href="#l72.260"></a><span id="l72.260" class="difflineminus">-	border-right: 1px solid #adb6ba;</span>
<a href="#l72.261"></a><span id="l72.261" class="difflineminus">-	border-bottom: 3px solid #adb6ba;</span>
<a href="#l72.262"></a><span id="l72.262" class="difflineminus">-	-moz-border-bottom-colors:#adb6ba #e7eaec #e7eaec;</span>
<a href="#l72.263"></a><span id="l72.263" class="difflineminus">-	background-color: #fff;</span>
<a href="#l72.264"></a><span id="l72.264" class="difflineminus">-} </span>
<a href="#l72.265"></a><span id="l72.265" class="difflineminus">-</span>
<a href="#l72.266"></a><span id="l72.266" class="difflineminus">-*/</span>
<a href="#l72.267"></a><span id="l72.267" class="difflineminus">-</span>
<a href="#l72.268"></a><span id="l72.268" class="difflineminus">-.menuItem {</span>
<a href="#l72.269"></a><span id="l72.269" class="difflineminus">-	margin-right: 30px;</span>
<a href="#l72.270"></a><span id="l72.270" class="difflineminus">-	margin-bottom: 40px;</span>
<a href="#l72.271"></a><span id="l72.271" class="difflineminus">-	font-size: 14px;</span>
<a href="#l72.272"></a><span id="l72.272" class="difflineminus">-	text-shadow: 1px 1px 1px rgba(173, 182, 186, 0.6);</span>
<a href="#l72.273"></a><span id="l72.273" class="difflineminus">-	padding: 9px 8px 8px 8px;</span>
<a href="#l72.274"></a><span id="l72.274" class="difflineminus">-}</span>
<a href="#l72.275"></a><span id="l72.275" class="difflineminus">-</span>
<a href="#l72.276"></a><span id="l72.276" class="difflineminus">-.menuOn {</span>
<a href="#l72.277"></a><span id="l72.277" class="difflineminus">-	margin-right: 30px;</span>
<a href="#l72.278"></a><span id="l72.278" class="difflineminus">-	margin-bottom: 40px;</span>
<a href="#l72.279"></a><span id="l72.279" class="difflineminus">-	font-size: 14px;</span>
<a href="#l72.280"></a><span id="l72.280" class="difflineminus">-	text-shadow: 1px 1px 1px rgba(173, 182, 186, 1);</span>
<a href="#l72.281"></a><span id="l72.281" class="difflineminus">-	background-color: rgba(173, 182, 186, 0.3);</span>
<a href="#l72.282"></a><span id="l72.282" class="difflineminus">-	box-shadow: </span>
<a href="#l72.283"></a><span id="l72.283" class="difflineminus">-		inset rgba(0, 0, 0, 0.2) 0 -10px 12px;</span>
<a href="#l72.284"></a><span id="l72.284" class="difflineminus">-	padding: 9px 8px 8px 8px;</span>
<a href="#l72.285"></a><span id="l72.285" class="difflineminus">-}</span>
<a href="#l72.286"></a><span id="l72.286" class="difflineminus">-</span>
<a href="#l72.287"></a><span id="l72.287" class="difflineminus">-.menuItem a {color: #9f423b; text-decoration: none;}</span>
<a href="#l72.288"></a><span id="l72.288" class="difflineminus">-.menuItem a:hover {color: #9f423b; text-decoration: none; border-bottom: 1px dotted #9f423b;}</span>
<a href="#l72.289"></a><span id="l72.289" class="difflineminus">-</span>
<a href="#l72.290"></a><span id="l72.290" class="difflineminus">-</span>
<a href="#l72.291"></a><span id="l72.291" class="difflineminus">-.menuOn a {color: #666666; text-decoration: none;}</span>
<a href="#l72.292"></a><span id="l72.292" class="difflineminus">-.menuOn a:hover {color: #666666; text-decoration: none;}</span>
<a href="#l72.293"></a><span id="l72.293" class="difflineminus">-</span>
<a href="#l72.294"></a><span id="l72.294" class="difflineminus">-canvas {</span>
<a href="#l72.295"></a><span id="l72.295" class="difflineminus">-    border: 1px solid black;</span>
<a href="#l72.296"></a><span id="l72.296" class="difflineminus">-}</span>
<a href="#l72.297"></a><span id="l72.297" class="difflineminus">-</span>
<a href="#l72.298"></a><span id="l72.298" class="difflineminus">-a {</span>
<a href="#l72.299"></a><span id="l72.299" class="difflineminus">-    color: #9f423b;</span>
<a href="#l72.300"></a><span id="l72.300" class="difflineminus">-}</span>
<a href="#l72.301"></a><span id="l72.301" class="difflineminus">-</span>
<a href="#l72.302"></a><span id="l72.302" class="difflineminus">-a:hover {</span>
<a href="#l72.303"></a><span id="l72.303" class="difflineminus">-    color: #9f423b; text-decoration: underline; cursor: pointer;</span>
<a href="#l72.304"></a><span id="l72.304" class="difflineminus">-}</span>
<a href="#l72.305"></a><span id="l72.305" class="difflineminus">-</span>
<a href="#l72.306"></a><span id="l72.306" class="difflineminus">-#survey-explanation {</span>
<a href="#l72.307"></a><span id="l72.307" class="difflineminus">-  color: #787878;</span>
<a href="#l72.308"></a><span id="l72.308" class="difflineminus">-  font-size: 14px;</span>
<a href="#l72.309"></a><span id="l72.309" class="difflineminus">-}</span>
<a href="#l72.310"></a><span id="l72.310" class="difflineminus">-</span>
<a href="#l72.311"></a><span id="l72.311" class="difflineminus">-.survey-question-explanation {</span>
<a href="#l72.312"></a><span id="l72.312" class="difflineminus">-  color: #787878;</span>
<a href="#l72.313"></a><span id="l72.313" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l73.1"></a><span id="l73.1">deleted file mode 100644</span>
<a href="#l73.2"></a><span id="l73.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/all/css/screen-standalone.css</span>
<a href="#l73.3"></a><span id="l73.3" class="difflineplus">+++ /dev/null</span>
<a href="#l73.4"></a><span id="l73.4" class="difflineat">@@ -1,292 +0,0 @@</span>
<a href="#l73.5"></a><span id="l73.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l73.6"></a><span id="l73.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l73.7"></a><span id="l73.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l73.8"></a><span id="l73.8" class="difflineminus">-</span>
<a href="#l73.9"></a><span id="l73.9" class="difflineminus">-html {</span>
<a href="#l73.10"></a><span id="l73.10" class="difflineminus">-	padding-bottom: 40px; </span>
<a href="#l73.11"></a><span id="l73.11" class="difflineminus">-	padding-top: 20px;</span>
<a href="#l73.12"></a><span id="l73.12" class="difflineminus">-	padding-left: 0px;</span>
<a href="#l73.13"></a><span id="l73.13" class="difflineminus">-	padding-right: 0px;</span>
<a href="#l73.14"></a><span id="l73.14" class="difflineminus">-}</span>
<a href="#l73.15"></a><span id="l73.15" class="difflineminus">-</span>
<a href="#l73.16"></a><span id="l73.16" class="difflineminus">-body { </span>
<a href="#l73.17"></a><span id="l73.17" class="difflineminus">-	font-family: 'Lucida Grande', 'Lucida Sans Unicode', Lucida, Arial, Helvetica, sans-serif;</span>
<a href="#l73.18"></a><span id="l73.18" class="difflineminus">-	background: #fff url('chrome://testpilot/skin/images/bg-status.jpg') repeat-x top center;	padding: 0px; </span>
<a href="#l73.19"></a><span id="l73.19" class="difflineminus">-	color:#787878;</span>
<a href="#l73.20"></a><span id="l73.20" class="difflineminus">-	font-size:12px;</span>
<a href="#l73.21"></a><span id="l73.21" class="difflineminus">-	line-height: 18px;</span>
<a href="#l73.22"></a><span id="l73.22" class="difflineminus">-	margin: 0 auto;</span>
<a href="#l73.23"></a><span id="l73.23" class="difflineminus">-	</span>
<a href="#l73.24"></a><span id="l73.24" class="difflineminus">-}</span>
<a href="#l73.25"></a><span id="l73.25" class="difflineminus">-</span>
<a href="#l73.26"></a><span id="l73.26" class="difflineminus">-	h1 {color: #3a3a3a; font-size: 28px; font-weight: normal; letter-spacing: -1px}</span>
<a href="#l73.27"></a><span id="l73.27" class="difflineminus">-	h2 {color: #54717b; font-size: 24px; line-height: 24px;font-weight: normal; letter-spacing: -1px}</span>
<a href="#l73.28"></a><span id="l73.28" class="difflineminus">-	h3 {color: #54717b; font-size: 18px; line-height: 18px;font-weight: normal; letter-spacing: -1px}</span>
<a href="#l73.29"></a><span id="l73.29" class="difflineminus">-	</span>
<a href="#l73.30"></a><span id="l73.30" class="difflineminus">-	p, ul {font-size: 12px;}</span>
<a href="#l73.31"></a><span id="l73.31" class="difflineminus">-	</span>
<a href="#l73.32"></a><span id="l73.32" class="difflineminus">-	a:link, a:hover, a:active, a:focus, a:visited {color: #9f423b; text-decoration: none;}</span>
<a href="#l73.33"></a><span id="l73.33" class="difflineminus">-	a:hover {color: #9f423b; text-decoration: none;}</span>
<a href="#l73.34"></a><span id="l73.34" class="difflineminus">-	</span>
<a href="#l73.35"></a><span id="l73.35" class="difflineminus">-	.bold {color:#3a3a3a;}</span>
<a href="#l73.36"></a><span id="l73.36" class="difflineminus">-	.address {margin-left: 20px;}</span>
<a href="#l73.37"></a><span id="l73.37" class="difflineminus">-	.inactive {color:#ccc;}</span>
<a href="#l73.38"></a><span id="l73.38" class="difflineminus">-	</span>
<a href="#l73.39"></a><span id="l73.39" class="difflineminus">-	li {list-style-type: circle;}</span>
<a href="#l73.40"></a><span id="l73.40" class="difflineminus">-</span>
<a href="#l73.41"></a><span id="l73.41" class="difflineminus">-	.spacer {height: 40px;}</span>
<a href="#l73.42"></a><span id="l73.42" class="difflineminus">-	</span>
<a href="#l73.43"></a><span id="l73.43" class="difflineminus">-	.center {text-align: center;}</span>
<a href="#l73.44"></a><span id="l73.44" class="difflineminus">-</span>
<a href="#l73.45"></a><span id="l73.45" class="difflineminus">-	.data {</span>
<a href="#l73.46"></a><span id="l73.46" class="difflineminus">-	</span>
<a href="#l73.47"></a><span id="l73.47" class="difflineminus">-	    background-color: #fff;</span>
<a href="#l73.48"></a><span id="l73.48" class="difflineminus">-        margin-bottom: 6px;</span>
<a href="#l73.49"></a><span id="l73.49" class="difflineminus">-        border: 1px solid rgba(133, 153, 166, 0.2);</span>
<a href="#l73.50"></a><span id="l73.50" class="difflineminus">-        border-bottom: 4px solid rgba(133, 153, 166, 0.2);</span>
<a href="#l73.51"></a><span id="l73.51" class="difflineminus">-		-moz-border-bottom-colors:rgba(133, 153, 166, 0.3) rgba(133, 153, 166, 0.2) rgba(133, 153, 166, 0.2) rgba(133, 153, 166, 0.2);</span>
<a href="#l73.52"></a><span id="l73.52" class="difflineminus">-        padding: 6px;</span>
<a href="#l73.53"></a><span id="l73.53" class="difflineminus">-        box-shadow:</span>
<a href="#l73.54"></a><span id="l73.54" class="difflineminus">-			rgba(133, 153, 166, 0.4) 0px 1px 24px;</span>
<a href="#l73.55"></a><span id="l73.55" class="difflineminus">-		</span>
<a href="#l73.56"></a><span id="l73.56" class="difflineminus">-	}</span>
<a href="#l73.57"></a><span id="l73.57" class="difflineminus">-	</span>
<a href="#l73.58"></a><span id="l73.58" class="difflineminus">-	.dataBox {</span>
<a href="#l73.59"></a><span id="l73.59" class="difflineminus">-		font-size: 16px;</span>
<a href="#l73.60"></a><span id="l73.60" class="difflineminus">-		padding: 6px 20px 20px 20px;</span>
<a href="#l73.61"></a><span id="l73.61" class="difflineminus">-		border-radius: 0.5em;</span>
<a href="#l73.62"></a><span id="l73.62" class="difflineminus">-		background: rgba(220, 240, 247, 0.8) url('chrome://testpilot/skin/images/callout.png') no-repeat top center;</span>
<a href="#l73.63"></a><span id="l73.63" class="difflineminus">-		/* display: inline; */</span>
<a href="#l73.64"></a><span id="l73.64" class="difflineminus">-	}</span>
<a href="#l73.65"></a><span id="l73.65" class="difflineminus">-</span>
<a href="#l73.66"></a><span id="l73.66" class="difflineminus">-#container {</span>
<a href="#l73.67"></a><span id="l73.67" class="difflineminus">-	margin: 0px auto;</span>
<a href="#l73.68"></a><span id="l73.68" class="difflineminus">-	width: 950px;</span>
<a href="#l73.69"></a><span id="l73.69" class="difflineminus">-</span>
<a href="#l73.70"></a><span id="l73.70" class="difflineminus">-}</span>
<a href="#l73.71"></a><span id="l73.71" class="difflineminus">-</span>
<a href="#l73.72"></a><span id="l73.72" class="difflineminus">-#logo {</span>
<a href="#l73.73"></a><span id="l73.73" class="difflineminus">-	margin-left: 20px;</span>
<a href="#l73.74"></a><span id="l73.74" class="difflineminus">-}</span>
<a href="#l73.75"></a><span id="l73.75" class="difflineminus">-</span>
<a href="#l73.76"></a><span id="l73.76" class="difflineminus">-#contentWelcome {</span>
<a href="#l73.77"></a><span id="l73.77" class="difflineminus">-	margin-top: 380px;</span>
<a href="#l73.78"></a><span id="l73.78" class="difflineminus">-	padding: 8px 24px 24px 24px;</span>
<a href="#l73.79"></a><span id="l73.79" class="difflineminus">-	text-align: left;</span>
<a href="#l73.80"></a><span id="l73.80" class="difflineminus">-}</span>
<a href="#l73.81"></a><span id="l73.81" class="difflineminus">-</span>
<a href="#l73.82"></a><span id="l73.82" class="difflineminus">-#content-standalone {</span>
<a href="#l73.83"></a><span id="l73.83" class="difflineminus">-	margin-top: 120px;</span>
<a href="#l73.84"></a><span id="l73.84" class="difflineminus">-	padding: 8px 24px 24px 24px;</span>
<a href="#l73.85"></a><span id="l73.85" class="difflineminus">-	text-align: left;</span>
<a href="#l73.86"></a><span id="l73.86" class="difflineminus">-}</span>
<a href="#l73.87"></a><span id="l73.87" class="difflineminus">-</span>
<a href="#l73.88"></a><span id="l73.88" class="difflineminus">-#download {</span>
<a href="#l73.89"></a><span id="l73.89" class="difflineminus">-	width: 300px;</span>
<a href="#l73.90"></a><span id="l73.90" class="difflineminus">-	margin-left: 410px;</span>
<a href="#l73.91"></a><span id="l73.91" class="difflineminus">-	margin-top: 240px;</span>
<a href="#l73.92"></a><span id="l73.92" class="difflineminus">-}</span>
<a href="#l73.93"></a><span id="l73.93" class="difflineminus">-</span>
<a href="#l73.94"></a><span id="l73.94" class="difflineminus">-.downloadButton {</span>
<a href="#l73.95"></a><span id="l73.95" class="difflineminus">-	margin-bottom: -10px;</span>
<a href="#l73.96"></a><span id="l73.96" class="difflineminus">-	margin-top: -2px;</span>
<a href="#l73.97"></a><span id="l73.97" class="difflineminus">-	margin-right: 12px;</span>
<a href="#l73.98"></a><span id="l73.98" class="difflineminus">-}</span>
<a href="#l73.99"></a><span id="l73.99" class="difflineminus">-</span>
<a href="#l73.100"></a><span id="l73.100" class="difflineminus">-.downloadH1 {color: #3a3a3a; font-size: 24px; font-weight: normal; letter-spacing: -1px; margin-right: 8px;}</span>
<a href="#l73.101"></a><span id="l73.101" class="difflineminus">-</span>
<a href="#l73.102"></a><span id="l73.102" class="difflineminus">-.downloadH2 {color: #3a3a3a; font-size: 22px; font-weight: normal; letter-spacing: -1px; line-height: 28px; margin-left: 46px;}</span>
<a href="#l73.103"></a><span id="l73.103" class="difflineminus">-</span>
<a href="#l73.104"></a><span id="l73.104" class="difflineminus">-#intro {</span>
<a href="#l73.105"></a><span id="l73.105" class="difflineminus">-	float: left;</span>
<a href="#l73.106"></a><span id="l73.106" class="difflineminus">-	width: 500px;</span>
<a href="#l73.107"></a><span id="l73.107" class="difflineminus">-	margin-top: 30px;</span>
<a href="#l73.108"></a><span id="l73.108" class="difflineminus">-}</span>
<a href="#l73.109"></a><span id="l73.109" class="difflineminus">-</span>
<a href="#l73.110"></a><span id="l73.110" class="difflineminus">-#links {</span>
<a href="#l73.111"></a><span id="l73.111" class="difflineminus">-	float: right;</span>
<a href="#l73.112"></a><span id="l73.112" class="difflineminus">-	padding: 24px 0px;</span>
<a href="#l73.113"></a><span id="l73.113" class="difflineminus">-	margin-right: 0px;</span>
<a href="#l73.114"></a><span id="l73.114" class="difflineminus">-	margin-top: 260px;</span>
<a href="#l73.115"></a><span id="l73.115" class="difflineminus">-}</span>
<a href="#l73.116"></a><span id="l73.116" class="difflineminus">-</span>
<a href="#l73.117"></a><span id="l73.117" class="difflineminus">-.button {</span>
<a href="#l73.118"></a><span id="l73.118" class="difflineminus">-	font-size: 16px;</span>
<a href="#l73.119"></a><span id="l73.119" class="difflineminus">-	padding: 8px 12px;</span>
<a href="#l73.120"></a><span id="l73.120" class="difflineminus">-	color: rgba(0, 0, 0, 0.8);</span>
<a href="#l73.121"></a><span id="l73.121" class="difflineminus">-	border-radius: 0.5em;</span>
<a href="#l73.122"></a><span id="l73.122" class="difflineminus">-	box-shadow: </span>
<a href="#l73.123"></a><span id="l73.123" class="difflineminus">-		inset rgba(0, 0, 0, 0.2) 0 1px 1px,</span>
<a href="#l73.124"></a><span id="l73.124" class="difflineminus">-		inset rgba(255, 255, 255, 1) 0 3px 1px,</span>
<a href="#l73.125"></a><span id="l73.125" class="difflineminus">-		inset rgba(255, 255, 255, 0.3) 0 16px 0px,</span>
<a href="#l73.126"></a><span id="l73.126" class="difflineminus">-		inset rgba(0, 0, 0, 0.2) 0 -1px 1px,</span>
<a href="#l73.127"></a><span id="l73.127" class="difflineminus">-		inset rgba(0, 0, 0, 0.1) 0 -2px 1px, </span>
<a href="#l73.128"></a><span id="l73.128" class="difflineminus">-		rgba(255, 255, 255, 1) 0 1px,</span>
<a href="#l73.129"></a><span id="l73.129" class="difflineminus">-		rgba(133, 153, 166, 0.3) 0px 1px 12px;</span>
<a href="#l73.130"></a><span id="l73.130" class="difflineminus">-	background-color: #e7eaec;</span>
<a href="#l73.131"></a><span id="l73.131" class="difflineminus">-	/* display: inline; */</span>
<a href="#l73.132"></a><span id="l73.132" class="difflineminus">-}</span>
<a href="#l73.133"></a><span id="l73.133" class="difflineminus">-</span>
<a href="#l73.134"></a><span id="l73.134" class="difflineminus">-.home_button {</span>
<a href="#l73.135"></a><span id="l73.135" class="difflineminus">-	font-size: 16px;</span>
<a href="#l73.136"></a><span id="l73.136" class="difflineminus">-	padding: 8px 12px;</span>
<a href="#l73.137"></a><span id="l73.137" class="difflineminus">-	width: 240px;</span>
<a href="#l73.138"></a><span id="l73.138" class="difflineminus">-	color: rgba(0, 0, 0, 0.8);</span>
<a href="#l73.139"></a><span id="l73.139" class="difflineminus">-	border-radius: 0.5em;</span>
<a href="#l73.140"></a><span id="l73.140" class="difflineminus">-	box-shadow: </span>
<a href="#l73.141"></a><span id="l73.141" class="difflineminus">-		inset rgba(0, 0, 0, 0.2) 0 1px 1px,</span>
<a href="#l73.142"></a><span id="l73.142" class="difflineminus">-		inset rgba(255, 255, 255, 1) 0 3px 1px,</span>
<a href="#l73.143"></a><span id="l73.143" class="difflineminus">-		inset rgba(255, 255, 255, 0.3) 0 16px 0px,</span>
<a href="#l73.144"></a><span id="l73.144" class="difflineminus">-		inset rgba(0, 0, 0, 0.2) 0 -1px 1px,</span>
<a href="#l73.145"></a><span id="l73.145" class="difflineminus">-		inset rgba(0, 0, 0, 0.1) 0 -2px 1px, </span>
<a href="#l73.146"></a><span id="l73.146" class="difflineminus">-		rgba(255, 255, 255, 1) 0 1px,</span>
<a href="#l73.147"></a><span id="l73.147" class="difflineminus">-		rgba(133, 153, 166, 0.3) 0px 1px 12px;</span>
<a href="#l73.148"></a><span id="l73.148" class="difflineminus">-	background-color: #e7eaec;</span>
<a href="#l73.149"></a><span id="l73.149" class="difflineminus">-	/* display: inline; */</span>
<a href="#l73.150"></a><span id="l73.150" class="difflineminus">-}</span>
<a href="#l73.151"></a><span id="l73.151" class="difflineminus">-</span>
<a href="#l73.152"></a><span id="l73.152" class="difflineminus">-.callout {</span>
<a href="#l73.153"></a><span id="l73.153" class="difflineminus">-	font-size: 16px;</span>
<a href="#l73.154"></a><span id="l73.154" class="difflineminus">-	padding: 8px 24px;</span>
<a href="#l73.155"></a><span id="l73.155" class="difflineminus">-	margin: 24px auto;</span>
<a href="#l73.156"></a><span id="l73.156" class="difflineminus">-	color: rgba(0, 0, 0, 0.8);</span>
<a href="#l73.157"></a><span id="l73.157" class="difflineminus">-	border-radius: 0.5em;</span>
<a href="#l73.158"></a><span id="l73.158" class="difflineminus">-	background: rgba(220, 240, 247, 0.8) url('chrome://testpilot/skin/images/callout.png') no-repeat top center;</span>
<a href="#l73.159"></a><span id="l73.159" class="difflineminus">-	box-shadow: </span>
<a href="#l73.160"></a><span id="l73.160" class="difflineminus">-		inset rgba(185, 221, 234, 0.2) 0 -10px 12px,</span>
<a href="#l73.161"></a><span id="l73.161" class="difflineminus">-		inset rgba(185, 221, 234, 1) 0 0px 1px,</span>
<a href="#l73.162"></a><span id="l73.162" class="difflineminus">-		inset rgba(255, 255, 255, 0.2) 0 10px 12px;</span>
<a href="#l73.163"></a><span id="l73.163" class="difflineminus">-	/* display: inline; */</span>
<a href="#l73.164"></a><span id="l73.164" class="difflineminus">-}</span>
<a href="#l73.165"></a><span id="l73.165" class="difflineminus">-</span>
<a href="#l73.166"></a><span id="l73.166" class="difflineminus">-#data-privacy-text {</span>
<a href="#l73.167"></a><span id="l73.167" class="difflineminus">-  width: 320px;</span>
<a href="#l73.168"></a><span id="l73.168" class="difflineminus">-  margin-bottom: 50px;</span>
<a href="#l73.169"></a><span id="l73.169" class="difflineminus">-}</span>
<a href="#l73.170"></a><span id="l73.170" class="difflineminus">-</span>
<a href="#l73.171"></a><span id="l73.171" class="difflineminus">-.home_callout {</span>
<a href="#l73.172"></a><span id="l73.172" class="difflineminus">-	font-size: 16px;</span>
<a href="#l73.173"></a><span id="l73.173" class="difflineminus">-	vertical-align: middle;</span>
<a href="#l73.174"></a><span id="l73.174" class="difflineminus">-	/* width: 280px;*/</span>
<a href="#l73.175"></a><span id="l73.175" class="difflineminus">-	padding: 8px 24px;</span>
<a href="#l73.176"></a><span id="l73.176" class="difflineminus">-	margin: 8px auto;</span>
<a href="#l73.177"></a><span id="l73.177" class="difflineminus">-	color: rgba(0, 0, 0, 0.8);</span>
<a href="#l73.178"></a><span id="l73.178" class="difflineminus">-	border-radius: 0.5em;</span>
<a href="#l73.179"></a><span id="l73.179" class="difflineminus">-	background: rgba(220, 240, 247, 0.8) url('chrome://testpilot/skin/images/callout.png') no-repeat top center;</span>
<a href="#l73.180"></a><span id="l73.180" class="difflineminus">-	box-shadow: </span>
<a href="#l73.181"></a><span id="l73.181" class="difflineminus">-		inset rgba(185, 221, 234, 0.2) 0 -10px 12px,</span>
<a href="#l73.182"></a><span id="l73.182" class="difflineminus">-		inset rgba(185, 221, 234, 1) 0 0px 1px,</span>
<a href="#l73.183"></a><span id="l73.183" class="difflineminus">-		inset rgba(255, 255, 255, 0.2) 0 10px 12px;</span>
<a href="#l73.184"></a><span id="l73.184" class="difflineminus">-	/* display: inline; */</span>
<a href="#l73.185"></a><span id="l73.185" class="difflineminus">-}</span>
<a href="#l73.186"></a><span id="l73.186" class="difflineminus">-</span>
<a href="#l73.187"></a><span id="l73.187" class="difflineminus">-.home_callout_continue {</span>
<a href="#l73.188"></a><span id="l73.188" class="difflineminus">-	font-size: 16px;</span>
<a href="#l73.189"></a><span id="l73.189" class="difflineminus">-	vertical-align: middle;</span>
<a href="#l73.190"></a><span id="l73.190" class="difflineminus">-	width: 280px;</span>
<a href="#l73.191"></a><span id="l73.191" class="difflineminus">-	padding: 8px 24px;</span>
<a href="#l73.192"></a><span id="l73.192" class="difflineminus">-	margin: 8px auto;</span>
<a href="#l73.193"></a><span id="l73.193" class="difflineminus">-	color: rgba(0, 0, 0, 0.8);</span>
<a href="#l73.194"></a><span id="l73.194" class="difflineminus">-	border-radius: 0.5em;</span>
<a href="#l73.195"></a><span id="l73.195" class="difflineminus">-	background: rgba(220, 240, 247, 0.8) url('chrome://testpilot/skin/images/callout_continue.png') no-repeat top center;</span>
<a href="#l73.196"></a><span id="l73.196" class="difflineminus">-	box-shadow: </span>
<a href="#l73.197"></a><span id="l73.197" class="difflineminus">-		inset rgba(185, 221, 234, 0.2) 0 -10px 12px,</span>
<a href="#l73.198"></a><span id="l73.198" class="difflineminus">-		inset rgba(185, 221, 234, 1) 0 0px 1px,</span>
<a href="#l73.199"></a><span id="l73.199" class="difflineminus">-		inset rgba(255, 255, 255, 0.2) 0 10px 12px;</span>
<a href="#l73.200"></a><span id="l73.200" class="difflineminus">-	/* display: inline; */</span>
<a href="#l73.201"></a><span id="l73.201" class="difflineminus">-}</span>
<a href="#l73.202"></a><span id="l73.202" class="difflineminus">-</span>
<a href="#l73.203"></a><span id="l73.203" class="difflineminus">-.home_callout_continue a {color: #6c9735; text-decoration: none;}</span>
<a href="#l73.204"></a><span id="l73.204" class="difflineminus">-.home_callout_continue a:hover {color: #6c9735; text-decoration: none; border-bottom: 1px dotted #6c9735;}</span>
<a href="#l73.205"></a><span id="l73.205" class="difflineminus">-</span>
<a href="#l73.206"></a><span id="l73.206" class="difflineminus">-</span>
<a href="#l73.207"></a><span id="l73.207" class="difflineminus">-.homeIcon {</span>
<a href="#l73.208"></a><span id="l73.208" class="difflineminus">-	margin-top: -32px;</span>
<a href="#l73.209"></a><span id="l73.209" class="difflineminus">-	margin-bottom: -32px;</span>
<a href="#l73.210"></a><span id="l73.210" class="difflineminus">-	margin-right: 12px;</span>
<a href="#l73.211"></a><span id="l73.211" class="difflineminus">-}</span>
<a href="#l73.212"></a><span id="l73.212" class="difflineminus">-</span>
<a href="#l73.213"></a><span id="l73.213" class="difflineminus">-.homeIconSubmit {</span>
<a href="#l73.214"></a><span id="l73.214" class="difflineminus">-	margin-top: -32px;</span>
<a href="#l73.215"></a><span id="l73.215" class="difflineminus">-	margin-bottom: -32px;</span>
<a href="#l73.216"></a><span id="l73.216" class="difflineminus">-	margin-right: 12px;</span>
<a href="#l73.217"></a><span id="l73.217" class="difflineminus">-	visibility: hidden;</span>
<a href="#l73.218"></a><span id="l73.218" class="difflineminus">-}</span>
<a href="#l73.219"></a><span id="l73.219" class="difflineminus">-</span>
<a href="#l73.220"></a><span id="l73.220" class="difflineminus">-#footer {</span>
<a href="#l73.221"></a><span id="l73.221" class="difflineminus">-	clear: both;</span>
<a href="#l73.222"></a><span id="l73.222" class="difflineminus">-	padding: 24px;</span>
<a href="#l73.223"></a><span id="l73.223" class="difflineminus">-	font-size: 9px;</span>
<a href="#l73.224"></a><span id="l73.224" class="difflineminus">-</span>
<a href="#l73.225"></a><span id="l73.225" class="difflineminus">-}</span>
<a href="#l73.226"></a><span id="l73.226" class="difflineminus">-</span>
<a href="#l73.227"></a><span id="l73.227" class="difflineminus">-.mozLogo {</span>
<a href="#l73.228"></a><span id="l73.228" class="difflineminus">-	margin-bottom: -10px;</span>
<a href="#l73.229"></a><span id="l73.229" class="difflineminus">-	margin-right: 6px;</span>
<a href="#l73.230"></a><span id="l73.230" class="difflineminus">-}</span>
<a href="#l73.231"></a><span id="l73.231" class="difflineminus">-</span>
<a href="#l73.232"></a><span id="l73.232" class="difflineminus">-/* ------- MENU ------- </span>
<a href="#l73.233"></a><span id="l73.233" class="difflineminus">-</span>
<a href="#l73.234"></a><span id="l73.234" class="difflineminus">-#menu {</span>
<a href="#l73.235"></a><span id="l73.235" class="difflineminus">-	margin: 20px auto;</span>
<a href="#l73.236"></a><span id="l73.236" class="difflineminus">-	max-width: 800px;</span>
<a href="#l73.237"></a><span id="l73.237" class="difflineminus">-	padding: 4px 40px;</span>
<a href="#l73.238"></a><span id="l73.238" class="difflineminus">-	width: 800px;</span>
<a href="#l73.239"></a><span id="l73.239" class="difflineminus">-	text-align: left;</span>
<a href="#l73.240"></a><span id="l73.240" class="difflineminus">-	border-radius: 0.25em;</span>
<a href="#l73.241"></a><span id="l73.241" class="difflineminus">-	border-top: 1px solid #adb6ba;</span>
<a href="#l73.242"></a><span id="l73.242" class="difflineminus">-	border-left: 1px solid #adb6ba;</span>
<a href="#l73.243"></a><span id="l73.243" class="difflineminus">-	border-right: 1px solid #adb6ba;</span>
<a href="#l73.244"></a><span id="l73.244" class="difflineminus">-	border-bottom: 3px solid #adb6ba;</span>
<a href="#l73.245"></a><span id="l73.245" class="difflineminus">-	-moz-border-bottom-colors:#adb6ba #e7eaec #e7eaec;</span>
<a href="#l73.246"></a><span id="l73.246" class="difflineminus">-	background-color: #fff;</span>
<a href="#l73.247"></a><span id="l73.247" class="difflineminus">-} </span>
<a href="#l73.248"></a><span id="l73.248" class="difflineminus">-</span>
<a href="#l73.249"></a><span id="l73.249" class="difflineminus">-*/</span>
<a href="#l73.250"></a><span id="l73.250" class="difflineminus">-</span>
<a href="#l73.251"></a><span id="l73.251" class="difflineminus">-.menuItem {</span>
<a href="#l73.252"></a><span id="l73.252" class="difflineminus">-	margin-right: 30px;</span>
<a href="#l73.253"></a><span id="l73.253" class="difflineminus">-	margin-bottom: 40px;</span>
<a href="#l73.254"></a><span id="l73.254" class="difflineminus">-	font-size: 14px;</span>
<a href="#l73.255"></a><span id="l73.255" class="difflineminus">-	text-shadow: 1px 1px 1px rgba(173, 182, 186, 0.6);</span>
<a href="#l73.256"></a><span id="l73.256" class="difflineminus">-	padding: 9px 8px 8px 8px;</span>
<a href="#l73.257"></a><span id="l73.257" class="difflineminus">-}</span>
<a href="#l73.258"></a><span id="l73.258" class="difflineminus">-</span>
<a href="#l73.259"></a><span id="l73.259" class="difflineminus">-.menuOn {</span>
<a href="#l73.260"></a><span id="l73.260" class="difflineminus">-	margin-right: 30px;</span>
<a href="#l73.261"></a><span id="l73.261" class="difflineminus">-	margin-bottom: 40px;</span>
<a href="#l73.262"></a><span id="l73.262" class="difflineminus">-	font-size: 14px;</span>
<a href="#l73.263"></a><span id="l73.263" class="difflineminus">-	text-shadow: 1px 1px 1px rgba(173, 182, 186, 1);</span>
<a href="#l73.264"></a><span id="l73.264" class="difflineminus">-	background-color: rgba(173, 182, 186, 0.3);</span>
<a href="#l73.265"></a><span id="l73.265" class="difflineminus">-	box-shadow: </span>
<a href="#l73.266"></a><span id="l73.266" class="difflineminus">-		inset rgba(0, 0, 0, 0.2) 0 -10px 12px;</span>
<a href="#l73.267"></a><span id="l73.267" class="difflineminus">-	padding: 9px 8px 8px 8px;</span>
<a href="#l73.268"></a><span id="l73.268" class="difflineminus">-}</span>
<a href="#l73.269"></a><span id="l73.269" class="difflineminus">-</span>
<a href="#l73.270"></a><span id="l73.270" class="difflineminus">-.menuItem a {color: #9f423b; text-decoration: none;}</span>
<a href="#l73.271"></a><span id="l73.271" class="difflineminus">-.menuItem a:hover {color: #9f423b; text-decoration: none; border-bottom: 1px dotted #9f423b;}</span>
<a href="#l73.272"></a><span id="l73.272" class="difflineminus">-</span>
<a href="#l73.273"></a><span id="l73.273" class="difflineminus">-</span>
<a href="#l73.274"></a><span id="l73.274" class="difflineminus">-.menuOn a {color: #666666; text-decoration: none;}</span>
<a href="#l73.275"></a><span id="l73.275" class="difflineminus">-.menuOn a:hover {color: #666666; text-decoration: none;}</span>
<a href="#l73.276"></a><span id="l73.276" class="difflineminus">-</span>
<a href="#l73.277"></a><span id="l73.277" class="difflineminus">-canvas {</span>
<a href="#l73.278"></a><span id="l73.278" class="difflineminus">-    border: 1px solid black;</span>
<a href="#l73.279"></a><span id="l73.279" class="difflineminus">-}</span>
<a href="#l73.280"></a><span id="l73.280" class="difflineminus">-</span>
<a href="#l73.281"></a><span id="l73.281" class="difflineminus">-a {</span>
<a href="#l73.282"></a><span id="l73.282" class="difflineminus">-    color: #9f423b;</span>
<a href="#l73.283"></a><span id="l73.283" class="difflineminus">-}</span>
<a href="#l73.284"></a><span id="l73.284" class="difflineminus">-</span>
<a href="#l73.285"></a><span id="l73.285" class="difflineminus">-a:hover {</span>
<a href="#l73.286"></a><span id="l73.286" class="difflineminus">-    color: #9f423b; text-decoration: underline; cursor: pointer;</span>
<a href="#l73.287"></a><span id="l73.287" class="difflineminus">-}</span>
<a href="#l73.288"></a><span id="l73.288" class="difflineminus">-</span>
<a href="#l73.289"></a><span id="l73.289" class="difflineminus">-#survey-explanation {</span>
<a href="#l73.290"></a><span id="l73.290" class="difflineminus">-  color: #787878;</span>
<a href="#l73.291"></a><span id="l73.291" class="difflineminus">-  font-size: 14px;</span>
<a href="#l73.292"></a><span id="l73.292" class="difflineminus">-}</span>
<a href="#l73.293"></a><span id="l73.293" class="difflineminus">-</span>
<a href="#l73.294"></a><span id="l73.294" class="difflineminus">-.survey-question-explanation {</span>
<a href="#l73.295"></a><span id="l73.295" class="difflineminus">-  color: #787878;</span>
<a href="#l73.296"></a><span id="l73.296" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l74.1"></a><span id="l74.1">deleted file mode 100644</span>
<a href="#l74.2"></a><span id="l74.2">index 35b3a174a5585a0f92f491066ef92dabb975cae9..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l74.3"></a><span id="l74.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l75.1"></a><span id="l75.1">deleted file mode 100644</span>
<a href="#l75.2"></a><span id="l75.2">index ddb9e9700af194fd778ade5f743898840e02501a..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l75.3"></a><span id="l75.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l76.1"></a><span id="l76.1">deleted file mode 100644</span>
<a href="#l76.2"></a><span id="l76.2">index 5dca8b1077bdb20fe6fa74c88c789757a1184379..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l76.3"></a><span id="l76.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l77.1"></a><span id="l77.1">deleted file mode 100644</span>
<a href="#l77.2"></a><span id="l77.2">index 8ae284ab9f7125264d96687d51b4a0eec113d658..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l77.3"></a><span id="l77.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l78.1"></a><span id="l78.1">deleted file mode 100644</span>
<a href="#l78.2"></a><span id="l78.2">index ed4cea1fa4feb65c9c7d8677f28876e4bcde34e8..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l78.3"></a><span id="l78.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l79.1"></a><span id="l79.1">deleted file mode 100644</span>
<a href="#l79.2"></a><span id="l79.2">index 59be0625278cf774e4629ee617271f47448a6a54..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l79.3"></a><span id="l79.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l80.1"></a><span id="l80.1">deleted file mode 100644</span>
<a href="#l80.2"></a><span id="l80.2">index ed78310d8cdcec4c2caf28ca34d9fc233dc723c8..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l80.3"></a><span id="l80.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l81.1"></a><span id="l81.1">deleted file mode 100644</span>
<a href="#l81.2"></a><span id="l81.2">index 2ed3b6bc12a7b824965dfb8d0492331d5d50a1b3..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l81.3"></a><span id="l81.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l82.1"></a><span id="l82.1">deleted file mode 100644</span>
<a href="#l82.2"></a><span id="l82.2">index 5b492173bcaf958e64c7be04573e9e2987939a71..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l82.3"></a><span id="l82.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l83.1"></a><span id="l83.1">deleted file mode 100644</span>
<a href="#l83.2"></a><span id="l83.2">index 73e191e65f9cbdc1415408145a11ae6d28e63325..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l83.3"></a><span id="l83.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l84.1"></a><span id="l84.1">deleted file mode 100644</span>
<a href="#l84.2"></a><span id="l84.2">index ec8bcd737fb5516fed5733a2b55c358a019596a2..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l84.3"></a><span id="l84.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l85.1"></a><span id="l85.1">deleted file mode 100644</span>
<a href="#l85.2"></a><span id="l85.2">index c5526450f4e8ef7289ac71dc8f1a4f018f35cd36..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l85.3"></a><span id="l85.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l86.1"></a><span id="l86.1">deleted file mode 100644</span>
<a href="#l86.2"></a><span id="l86.2">index 7efe52d8f75518b1f96b497ce53d3144d4e63449..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l86.3"></a><span id="l86.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l87.1"></a><span id="l87.1">deleted file mode 100644</span>
<a href="#l87.2"></a><span id="l87.2">index 5f8f7a46dd4be56f310e8891575c6b5686b6572f..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l87.3"></a><span id="l87.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l88.1"></a><span id="l88.1">deleted file mode 100644</span>
<a href="#l88.2"></a><span id="l88.2">index 6587744c0ba4f23f570317cdde365f770eaf2121..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l88.3"></a><span id="l88.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l89.1"></a><span id="l89.1">deleted file mode 100644</span>
<a href="#l89.2"></a><span id="l89.2">index 27628ce1c2aa2e57200a5d179310b6a86b5e5ca7..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l89.3"></a><span id="l89.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l90.1"></a><span id="l90.1">deleted file mode 100644</span>
<a href="#l90.2"></a><span id="l90.2">index 98c421a8bb8e69bcf832e55905e48764af8476cb..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l90.3"></a><span id="l90.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l91.1"></a><span id="l91.1">deleted file mode 100644</span>
<a href="#l91.2"></a><span id="l91.2">index 9b9c0331babf67b88b19141938f4559eb9e5f079..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l91.3"></a><span id="l91.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l92.1"></a><span id="l92.1">deleted file mode 100644</span>
<a href="#l92.2"></a><span id="l92.2">index dc2e3c87c6806e819cf7519643ab6b8be1d6a3d3..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l92.3"></a><span id="l92.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l93.1"></a><span id="l93.1">deleted file mode 100644</span>
<a href="#l93.2"></a><span id="l93.2">index 40372b499dfacb9ec7eccf5dd8fa4da2848126d7..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l93.3"></a><span id="l93.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l94.1"></a><span id="l94.1">deleted file mode 100644</span>
<a href="#l94.2"></a><span id="l94.2">index bfb05225deb708389d1f6028936185ad042130af..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l94.3"></a><span id="l94.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l95.1"></a><span id="l95.1">deleted file mode 100644</span>
<a href="#l95.2"></a><span id="l95.2">index ff2f3c886282c73de4c9855fe1a026c5a9ee1ec5..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l95.3"></a><span id="l95.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l96.1"></a><span id="l96.1">deleted file mode 100644</span>
<a href="#l96.2"></a><span id="l96.2">index e2e5014751aaf9b5087bed99736223d8a268a221..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l96.3"></a><span id="l96.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l97.1"></a><span id="l97.1">deleted file mode 100644</span>
<a href="#l97.2"></a><span id="l97.2">index a5950e9309756d4affcebeca56848ccc2cf624fe..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l97.3"></a><span id="l97.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l98.1"></a><span id="l98.1">deleted file mode 100644</span>
<a href="#l98.2"></a><span id="l98.2">index 31f80b17ec0848b3c31e91aad1b46aaa8fa5b88f..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l98.3"></a><span id="l98.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l99.1"></a><span id="l99.1">deleted file mode 100644</span>
<a href="#l99.2"></a><span id="l99.2">index 6ac3311ea9364c2b6f780b76d50887d94c672ff0..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l99.3"></a><span id="l99.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l100.1"></a><span id="l100.1">deleted file mode 100644</span>
<a href="#l100.2"></a><span id="l100.2">index 1aa0777cd1d4496bf2f96f9ba71cf14094e98db2..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l100.3"></a><span id="l100.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l101.1"></a><span id="l101.1">deleted file mode 100644</span>
<a href="#l101.2"></a><span id="l101.2">index df7dc98111f001c9d3f4c707c47ec0658046c48a..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l101.3"></a><span id="l101.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l102.1"></a><span id="l102.1">deleted file mode 100644</span>
<a href="#l102.2"></a><span id="l102.2">index 0597ad7c15c9e8dddc7cf0fa385d52c0d08d1cbe..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l102.3"></a><span id="l102.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l103.1"></a><span id="l103.1">deleted file mode 100644</span>
<a href="#l103.2"></a><span id="l103.2">index eb6061192ef8bd1cad2f6e8541e87f169cd3fb66..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l103.3"></a><span id="l103.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l104.1"></a><span id="l104.1">deleted file mode 100644</span>
<a href="#l104.2"></a><span id="l104.2">index c4dfbe740b58cc00168facb730a64e4211c7c2b6..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l104.3"></a><span id="l104.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l105.1"></a><span id="l105.1">deleted file mode 100644</span>
<a href="#l105.2"></a><span id="l105.2">index df6cc3f2b90a27921677275310eb284e94b2c152..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l105.3"></a><span id="l105.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l106.1"></a><span id="l106.1">deleted file mode 100644</span>
<a href="#l106.2"></a><span id="l106.2">index 014be181ffcf7bbdb50b653709673b94ed3a9325..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l106.3"></a><span id="l106.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l107.1"></a><span id="l107.1">deleted file mode 100644</span>
<a href="#l107.2"></a><span id="l107.2">index 6f175d1a51ffadd2f01f28b86d65866cc6418af9..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l107.3"></a><span id="l107.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l108.1"></a><span id="l108.1">deleted file mode 100644</span>
<a href="#l108.2"></a><span id="l108.2">index 34aa346c1d1a75d11728f43edd6e2281ad13e34a..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l108.3"></a><span id="l108.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l109.1"></a><span id="l109.1">deleted file mode 100644</span>
<a href="#l109.2"></a><span id="l109.2">index 4f5445cfb6cfcb5354e78d80d364cf089abb6856..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l109.3"></a><span id="l109.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l110.1"></a><span id="l110.1">deleted file mode 100644</span>
<a href="#l110.2"></a><span id="l110.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/linux/feedback.css</span>
<a href="#l110.3"></a><span id="l110.3" class="difflineplus">+++ /dev/null</span>
<a href="#l110.4"></a><span id="l110.4" class="difflineat">@@ -1,27 +0,0 @@</span>
<a href="#l110.5"></a><span id="l110.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l110.6"></a><span id="l110.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l110.7"></a><span id="l110.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l110.8"></a><span id="l110.8" class="difflineminus">-</span>
<a href="#l110.9"></a><span id="l110.9" class="difflineminus">-#pilot-notification-popup {</span>
<a href="#l110.10"></a><span id="l110.10" class="difflineminus">-  -moz-appearance: none;</span>
<a href="#l110.11"></a><span id="l110.11" class="difflineminus">-  background-color: Menu;</span>
<a href="#l110.12"></a><span id="l110.12" class="difflineminus">-  background-image: linear-gradient(hsla(0,0%,100%,.2), transparent);</span>
<a href="#l110.13"></a><span id="l110.13" class="difflineminus">-  box-shadow: inset 0 0 10px hsla(0,0%,100%,.2),</span>
<a href="#l110.14"></a><span id="l110.14" class="difflineminus">-              inset 0 1px 0 hsla(0,0%,100%,.3);</span>
<a href="#l110.15"></a><span id="l110.15" class="difflineminus">-  border-radius: 4px;</span>
<a href="#l110.16"></a><span id="l110.16" class="difflineminus">-  border: 1px solid Menu;</span>
<a href="#l110.17"></a><span id="l110.17" class="difflineminus">-  margin: -6px 0 0 0;</span>
<a href="#l110.18"></a><span id="l110.18" class="difflineminus">-  width: 480px;</span>
<a href="#l110.19"></a><span id="l110.19" class="difflineminus">-}</span>
<a href="#l110.20"></a><span id="l110.20" class="difflineminus">-</span>
<a href="#l110.21"></a><span id="l110.21" class="difflineminus">-.tail-up,</span>
<a href="#l110.22"></a><span id="l110.22" class="difflineminus">-.tail-down {</span>
<a href="#l110.23"></a><span id="l110.23" class="difflineminus">- -moz-border-image: none;</span>
<a href="#l110.24"></a><span id="l110.24" class="difflineminus">-}</span>
<a href="#l110.25"></a><span id="l110.25" class="difflineminus">-</span>
<a href="#l110.26"></a><span id="l110.26" class="difflineminus">-.pilot-notification-popup-container {</span>
<a href="#l110.27"></a><span id="l110.27" class="difflineminus">-  -moz-appearance: none;</span>
<a href="#l110.28"></a><span id="l110.28" class="difflineminus">-  margin: 0;</span>
<a href="#l110.29"></a><span id="l110.29" class="difflineminus">-  padding: 10px;</span>
<a href="#l110.30"></a><span id="l110.30" class="difflineminus">-  font-size: 14px;</span>
<a href="#l110.31"></a><span id="l110.31" class="difflineminus">-}</span>
<a href="#l110.32"></a><span id="l110.32">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l111.1"></a><span id="l111.1">deleted file mode 100644</span>
<a href="#l111.2"></a><span id="l111.2">index 95f05aee2f1b22e46cad9b52e086e7abb4f67e76..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l111.3"></a><span id="l111.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l112.1"></a><span id="l112.1">deleted file mode 100644</span>
<a href="#l112.2"></a><span id="l112.2">index 74df9fb10fd59f61c63d606a778b2dc2d230c877..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l112.3"></a><span id="l112.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l113.1"></a><span id="l113.1">deleted file mode 100644</span>
<a href="#l113.2"></a><span id="l113.2">index e74a0d3cd152ecc76f1fd0525ca13c23622904b3..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l113.3"></a><span id="l113.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l114.1"></a><span id="l114.1">deleted file mode 100644</span>
<a href="#l114.2"></a><span id="l114.2">index 57e253de7107e8aaf7bb86e893dd390939cb11f6..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l114.3"></a><span id="l114.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l115.1"></a><span id="l115.1">deleted file mode 100644</span>
<a href="#l115.2"></a><span id="l115.2">index 6b47859c1a2b4777d2bdeb7d10b71591499b94c1..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l115.3"></a><span id="l115.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l116.1"></a><span id="l116.1">deleted file mode 100644</span>
<a href="#l116.2"></a><span id="l116.2">index d2a2bb36cc7c5743b1d6db3abb275a155256a743..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l116.3"></a><span id="l116.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l117.1"></a><span id="l117.1">deleted file mode 100644</span>
<a href="#l117.2"></a><span id="l117.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/mac/feedback.css</span>
<a href="#l117.3"></a><span id="l117.3" class="difflineplus">+++ /dev/null</span>
<a href="#l117.4"></a><span id="l117.4" class="difflineat">@@ -1,37 +0,0 @@</span>
<a href="#l117.5"></a><span id="l117.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l117.6"></a><span id="l117.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l117.7"></a><span id="l117.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l117.8"></a><span id="l117.8" class="difflineminus">-</span>
<a href="#l117.9"></a><span id="l117.9" class="difflineminus">-/* Submit Button Style */</span>
<a href="#l117.10"></a><span id="l117.10" class="difflineminus">-</span>
<a href="#l117.11"></a><span id="l117.11" class="difflineminus">-#pilot-notification-submit {</span>
<a href="#l117.12"></a><span id="l117.12" class="difflineminus">-  -moz-appearance: none;</span>
<a href="#l117.13"></a><span id="l117.13" class="difflineminus">-  background: #666 linear-gradient(rgba(110,110,110,.9), rgba(70,70,70,.9) 49%,</span>
<a href="#l117.14"></a><span id="l117.14" class="difflineminus">-                                   rgba(60,60,60,.9) 51%, rgba(50,50,50,.9));</span>
<a href="#l117.15"></a><span id="l117.15" class="difflineminus">-  background-clip: padding-box;</span>
<a href="#l117.16"></a><span id="l117.16" class="difflineminus">-  background-origin: padding-box;</span>
<a href="#l117.17"></a><span id="l117.17" class="difflineminus">-  border-radius: 12px;</span>
<a href="#l117.18"></a><span id="l117.18" class="difflineminus">-  border: 1px solid rgba(0,0,0,.65);</span>
<a href="#l117.19"></a><span id="l117.19" class="difflineminus">-  box-shadow: inset 0 1px 0 rgba(255,255,255,.2),</span>
<a href="#l117.20"></a><span id="l117.20" class="difflineminus">-              inset 0 0 1px rgba(255,255,255,.1),</span>
<a href="#l117.21"></a><span id="l117.21" class="difflineminus">-              0 1px 0 rgba(255,255,255,.1);</span>
<a href="#l117.22"></a><span id="l117.22" class="difflineminus">-  color: #fff;</span>
<a href="#l117.23"></a><span id="l117.23" class="difflineminus">-  text-shadow: 0 -1px 0 rgba(0,0,0,.5);</span>
<a href="#l117.24"></a><span id="l117.24" class="difflineminus">-}</span>
<a href="#l117.25"></a><span id="l117.25" class="difflineminus">-</span>
<a href="#l117.26"></a><span id="l117.26" class="difflineminus">-#pilot-notification-submit:hover:active {</span>
<a href="#l117.27"></a><span id="l117.27" class="difflineminus">-  background: linear-gradient(rgba(40,40,40,.9), rgba(70,70,70,.9));</span>
<a href="#l117.28"></a><span id="l117.28" class="difflineminus">-  box-shadow: inset 0 0 3px rgba(0,0,0,.2),</span>
<a href="#l117.29"></a><span id="l117.29" class="difflineminus">-              inset 0 1px 7px rgba(0,0,0,.4),</span>
<a href="#l117.30"></a><span id="l117.30" class="difflineminus">-              0 1px 0 rgba(255,255,255,.1);</span>
<a href="#l117.31"></a><span id="l117.31" class="difflineminus">-}</span>
<a href="#l117.32"></a><span id="l117.32" class="difflineminus">-</span>
<a href="#l117.33"></a><span id="l117.33" class="difflineminus">-/* Text Colors */</span>
<a href="#l117.34"></a><span id="l117.34" class="difflineminus">-</span>
<a href="#l117.35"></a><span id="l117.35" class="difflineminus">-.pilot-notification-popup-container {</span>
<a href="#l117.36"></a><span id="l117.36" class="difflineminus">-  color: #fff;</span>
<a href="#l117.37"></a><span id="l117.37" class="difflineminus">-}</span>
<a href="#l117.38"></a><span id="l117.38" class="difflineminus">-</span>
<a href="#l117.39"></a><span id="l117.39" class="difflineminus">-.notification-link {</span>
<a href="#l117.40"></a><span id="l117.40" class="difflineminus">-  color: #fff;</span>
<a href="#l117.41"></a><span id="l117.41" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l118.1"></a><span id="l118.1">deleted file mode 100644</span>
<a href="#l118.2"></a><span id="l118.2">index 43821c443cbb04e680dfa54e56ce89857b0fa5f3..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l118.3"></a><span id="l118.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l119.1"></a><span id="l119.1">deleted file mode 100644</span>
<a href="#l119.2"></a><span id="l119.2">index 168dcb8c6f74d2e8335923992540a2a8a3de39d0..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l119.3"></a><span id="l119.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l120.1"></a><span id="l120.1">deleted file mode 100644</span>
<a href="#l120.2"></a><span id="l120.2">index c4dfbe740b58cc00168facb730a64e4211c7c2b6..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l120.3"></a><span id="l120.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l121.1"></a><span id="l121.1">deleted file mode 100644</span>
<a href="#l121.2"></a><span id="l121.2">index 8d74c50464e3777744430f0ffc478864d70c6b1f..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l121.3"></a><span id="l121.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l122.1"></a><span id="l122.1">deleted file mode 100644</span>
<a href="#l122.2"></a><span id="l122.2">index ac03c486a2f340b64fa76a8e9422b1376a98dace..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l122.3"></a><span id="l122.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l123.1"></a><span id="l123.1">deleted file mode 100644</span>
<a href="#l123.2"></a><span id="l123.2">index 1fe6eab6f52c00bd1a172001e0fd6e10994dd4f6..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l123.3"></a><span id="l123.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l124.1"></a><span id="l124.1">deleted file mode 100644</span>
<a href="#l124.2"></a><span id="l124.2">index 78c322a4fe808ac367f342c8adac5a2a1ecf6018..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l124.3"></a><span id="l124.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l125.1"></a><span id="l125.1">deleted file mode 100644</span>
<a href="#l125.2"></a><span id="l125.2">index 3c8b97e8e23725c2318e13621e5f0cbc08639141..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l125.3"></a><span id="l125.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l126.1"></a><span id="l126.1">deleted file mode 100644</span>
<a href="#l126.2"></a><span id="l126.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/skin/win/feedback.css</span>
<a href="#l126.3"></a><span id="l126.3" class="difflineplus">+++ /dev/null</span>
<a href="#l126.4"></a><span id="l126.4" class="difflineat">@@ -1,8 +0,0 @@</span>
<a href="#l126.5"></a><span id="l126.5" class="difflineminus">-/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l126.6"></a><span id="l126.6" class="difflineminus">- * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l126.7"></a><span id="l126.7" class="difflineminus">- * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l126.8"></a><span id="l126.8" class="difflineminus">-</span>
<a href="#l126.9"></a><span id="l126.9" class="difflineminus">-</span>
<a href="#l126.10"></a><span id="l126.10" class="difflineminus">-#pilot-notification-popup {</span>
<a href="#l126.11"></a><span id="l126.11" class="difflineminus">-  color: -moz-dialogtext;</span>
<a href="#l126.12"></a><span id="l126.12" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l127.1"></a><span id="l127.1">deleted file mode 100644</span>
<a href="#l127.2"></a><span id="l127.2">index d0d6f4b2e83d403972f8a735d8c4abc1041a162a..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l127.3"></a><span id="l127.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l128.1"></a><span id="l128.1">deleted file mode 100644</span>
<a href="#l128.2"></a><span id="l128.2">index 843db1863c4b7b2559b95dbd3d653c8c8c0f46b8..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l128.3"></a><span id="l128.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l129.1"></a><span id="l129.1">deleted file mode 100644</span>
<a href="#l129.2"></a><span id="l129.2">index ddeed5ea3c60eaf8539b78320bbcafc14c0785b2..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l129.3"></a><span id="l129.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l130.1"></a><span id="l130.1">deleted file mode 100644</span>
<a href="#l130.2"></a><span id="l130.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/tests/foo.js</span>
<a href="#l130.3"></a><span id="l130.3" class="difflineplus">+++ /dev/null</span>
<a href="#l130.4"></a><span id="l130.4" class="difflineat">@@ -1,1 +0,0 @@</span>
<a href="#l130.5"></a><span id="l130.5" class="difflineminus">-exports.foo = function(x, y) { return x * y; };</span>
<a href="#l130.6"></a><span id="l130.6">\ No newline at end of file</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l131.1"></a><span id="l131.1">deleted file mode 100644</span>
<a href="#l131.2"></a><span id="l131.2" class="difflineminus">--- a/mail/app/profile/extensions/tbtestpilot@labs.mozilla.com/tests/test_data_store.js</span>
<a href="#l131.3"></a><span id="l131.3" class="difflineplus">+++ /dev/null</span>
<a href="#l131.4"></a><span id="l131.4" class="difflineat">@@ -1,957 +0,0 @@</span>
<a href="#l131.5"></a><span id="l131.5" class="difflineminus">-EXPORTED_SYMBOLS = [&quot;runAllTests&quot;];</span>
<a href="#l131.6"></a><span id="l131.6" class="difflineminus">-var Cu = Components.utils;</span>
<a href="#l131.7"></a><span id="l131.7" class="difflineminus">-var Cc = Components.classes;</span>
<a href="#l131.8"></a><span id="l131.8" class="difflineminus">-var Ci = Components.interfaces;</span>
<a href="#l131.9"></a><span id="l131.9" class="difflineminus">-var testsRun = 0;</span>
<a href="#l131.10"></a><span id="l131.10" class="difflineminus">-var testsPassed = 0;</span>
<a href="#l131.11"></a><span id="l131.11" class="difflineminus">-Cu.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l131.12"></a><span id="l131.12" class="difflineminus">-</span>
<a href="#l131.13"></a><span id="l131.13" class="difflineminus">-function output(txt) {</span>
<a href="#l131.14"></a><span id="l131.14" class="difflineminus">-  // dump on desktop, Services.console on mobile</span>
<a href="#l131.15"></a><span id="l131.15" class="difflineminus">-  Services.console.logStringMessage(txt);</span>
<a href="#l131.16"></a><span id="l131.16" class="difflineminus">-}</span>
<a href="#l131.17"></a><span id="l131.17" class="difflineminus">-</span>
<a href="#l131.18"></a><span id="l131.18" class="difflineminus">-// Utility functions for testing:</span>
<a href="#l131.19"></a><span id="l131.19" class="difflineminus">-</span>
<a href="#l131.20"></a><span id="l131.20" class="difflineminus">-function cheapAssertEqual(a, b, errorMsg) {</span>
<a href="#l131.21"></a><span id="l131.21" class="difflineminus">-  testsRun += 1;</span>
<a href="#l131.22"></a><span id="l131.22" class="difflineminus">-  if (a == b) {</span>
<a href="#l131.23"></a><span id="l131.23" class="difflineminus">-    output(&quot;UNIT TEST PASSED.\n&quot;);</span>
<a href="#l131.24"></a><span id="l131.24" class="difflineminus">-    testsPassed += 1;</span>
<a href="#l131.25"></a><span id="l131.25" class="difflineminus">-  } else {</span>
<a href="#l131.26"></a><span id="l131.26" class="difflineminus">-    output(&quot;UNIT TEST FAILED: &quot;);</span>
<a href="#l131.27"></a><span id="l131.27" class="difflineminus">-    output(errorMsg + &quot;\n&quot;);</span>
<a href="#l131.28"></a><span id="l131.28" class="difflineminus">-    output(a + &quot; does not equal &quot; + b + &quot;\n&quot;);</span>
<a href="#l131.29"></a><span id="l131.29" class="difflineminus">-  }</span>
<a href="#l131.30"></a><span id="l131.30" class="difflineminus">-}</span>
<a href="#l131.31"></a><span id="l131.31" class="difflineminus">-</span>
<a href="#l131.32"></a><span id="l131.32" class="difflineminus">-function cheapAssertNotEqual(a, b, errorMsg) {</span>
<a href="#l131.33"></a><span id="l131.33" class="difflineminus">-  testsRun += 1;</span>
<a href="#l131.34"></a><span id="l131.34" class="difflineminus">-  if (a != b) {</span>
<a href="#l131.35"></a><span id="l131.35" class="difflineminus">-    output(&quot;UNIT TEST PASSED.\n&quot;);</span>
<a href="#l131.36"></a><span id="l131.36" class="difflineminus">-    testsPassed += 1;</span>
<a href="#l131.37"></a><span id="l131.37" class="difflineminus">-  } else {</span>
<a href="#l131.38"></a><span id="l131.38" class="difflineminus">-    output(&quot;UNIT TEST FAILED: &quot;);</span>
<a href="#l131.39"></a><span id="l131.39" class="difflineminus">-    output(errorMsg + &quot;\n&quot;);</span>
<a href="#l131.40"></a><span id="l131.40" class="difflineminus">-    output(a + &quot; equals &quot; + b + &quot; when it shouldn't.\n&quot;);</span>
<a href="#l131.41"></a><span id="l131.41" class="difflineminus">-  }</span>
<a href="#l131.42"></a><span id="l131.42" class="difflineminus">-}</span>
<a href="#l131.43"></a><span id="l131.43" class="difflineminus">-</span>
<a href="#l131.44"></a><span id="l131.44" class="difflineminus">-function cheapAssertStringContains(bigString, subString, errorMsg) {</span>
<a href="#l131.45"></a><span id="l131.45" class="difflineminus">-  testsRun += 1;</span>
<a href="#l131.46"></a><span id="l131.46" class="difflineminus">-  if (bigString.indexOf(subString) &gt; -1) {</span>
<a href="#l131.47"></a><span id="l131.47" class="difflineminus">-    output(&quot;UNIT TEST PASSED.\n&quot;);</span>
<a href="#l131.48"></a><span id="l131.48" class="difflineminus">-    testsPassed += 1;</span>
<a href="#l131.49"></a><span id="l131.49" class="difflineminus">-  } else {</span>
<a href="#l131.50"></a><span id="l131.50" class="difflineminus">-    output(&quot;UNIT TEST FAILED: &quot;);</span>
<a href="#l131.51"></a><span id="l131.51" class="difflineminus">-    output(errorMsg + &quot;\n&quot;);</span>
<a href="#l131.52"></a><span id="l131.52" class="difflineminus">-    output(bigString + &quot; does not contain &quot; + subString + &quot;\n&quot;);</span>
<a href="#l131.53"></a><span id="l131.53" class="difflineminus">-  }</span>
<a href="#l131.54"></a><span id="l131.54" class="difflineminus">-}</span>
<a href="#l131.55"></a><span id="l131.55" class="difflineminus">-</span>
<a href="#l131.56"></a><span id="l131.56" class="difflineminus">-function cheapAssertEqualArrays(a, b, errorMsg) {</span>
<a href="#l131.57"></a><span id="l131.57" class="difflineminus">-  testsRun += 1;</span>
<a href="#l131.58"></a><span id="l131.58" class="difflineminus">-  let equal = true;</span>
<a href="#l131.59"></a><span id="l131.59" class="difflineminus">-  if (a.length != b.length) {</span>
<a href="#l131.60"></a><span id="l131.60" class="difflineminus">-    equal = false;</span>
<a href="#l131.61"></a><span id="l131.61" class="difflineminus">-  } else {</span>
<a href="#l131.62"></a><span id="l131.62" class="difflineminus">-    for (let i = 0; i &lt; a.length; i++) {</span>
<a href="#l131.63"></a><span id="l131.63" class="difflineminus">-      if (a[i] != b[i]) {</span>
<a href="#l131.64"></a><span id="l131.64" class="difflineminus">-        equal = false;</span>
<a href="#l131.65"></a><span id="l131.65" class="difflineminus">-      }</span>
<a href="#l131.66"></a><span id="l131.66" class="difflineminus">-    }</span>
<a href="#l131.67"></a><span id="l131.67" class="difflineminus">-  }</span>
<a href="#l131.68"></a><span id="l131.68" class="difflineminus">-  if (equal) {</span>
<a href="#l131.69"></a><span id="l131.69" class="difflineminus">-    output(&quot;UNIT TEST PASSED.\n&quot;);</span>
<a href="#l131.70"></a><span id="l131.70" class="difflineminus">-    testsPassed += 1;</span>
<a href="#l131.71"></a><span id="l131.71" class="difflineminus">-  } else {</span>
<a href="#l131.72"></a><span id="l131.72" class="difflineminus">-    output(&quot;UNIT TEST FAILED: &quot;);</span>
<a href="#l131.73"></a><span id="l131.73" class="difflineminus">-    output(errorMsg + &quot;\n&quot;);</span>
<a href="#l131.74"></a><span id="l131.74" class="difflineminus">-    output(a + &quot; does not equal &quot; + b + &quot;\n&quot;);</span>
<a href="#l131.75"></a><span id="l131.75" class="difflineminus">-  }</span>
<a href="#l131.76"></a><span id="l131.76" class="difflineminus">-}</span>
<a href="#l131.77"></a><span id="l131.77" class="difflineminus">-</span>
<a href="#l131.78"></a><span id="l131.78" class="difflineminus">-function cheapAssertRange(lowerBound, value, upperBound, errorMsg) {</span>
<a href="#l131.79"></a><span id="l131.79" class="difflineminus">-  testsRun += 1;</span>
<a href="#l131.80"></a><span id="l131.80" class="difflineminus">-  if (lowerBound &lt;= value &amp;&amp; value &lt;= upperBound) {</span>
<a href="#l131.81"></a><span id="l131.81" class="difflineminus">-    output(&quot;UNIT TEST PASSED.\n&quot;);</span>
<a href="#l131.82"></a><span id="l131.82" class="difflineminus">-    testsPassed += 1;</span>
<a href="#l131.83"></a><span id="l131.83" class="difflineminus">-  } else {</span>
<a href="#l131.84"></a><span id="l131.84" class="difflineminus">-    output(&quot;UNIT TEST FAILED: &quot;);</span>
<a href="#l131.85"></a><span id="l131.85" class="difflineminus">-    output(errorMsg + &quot;\n&quot;);</span>
<a href="#l131.86"></a><span id="l131.86" class="difflineminus">-    output(value + &quot; is outside the range of &quot; + lowerBound + &quot; to &quot;</span>
<a href="#l131.87"></a><span id="l131.87" class="difflineminus">-         + upperBound + &quot;\n&quot;);</span>
<a href="#l131.88"></a><span id="l131.88" class="difflineminus">-  }</span>
<a href="#l131.89"></a><span id="l131.89" class="difflineminus">-}</span>
<a href="#l131.90"></a><span id="l131.90" class="difflineminus">-</span>
<a href="#l131.91"></a><span id="l131.91" class="difflineminus">-function cheapAssertFail(errorMsg) {</span>
<a href="#l131.92"></a><span id="l131.92" class="difflineminus">-  testsRun += 1;</span>
<a href="#l131.93"></a><span id="l131.93" class="difflineminus">-  output(&quot;UNIT TEST FAILED: &quot;);</span>
<a href="#l131.94"></a><span id="l131.94" class="difflineminus">-  output(errorMsg + &quot;\n&quot;);</span>
<a href="#l131.95"></a><span id="l131.95" class="difflineminus">-}</span>
<a href="#l131.96"></a><span id="l131.96" class="difflineminus">-</span>
<a href="#l131.97"></a><span id="l131.97" class="difflineminus">-// Utility functions for cleanup:</span>
<a href="#l131.98"></a><span id="l131.98" class="difflineminus">-</span>
<a href="#l131.99"></a><span id="l131.99" class="difflineminus">-function clearAllPrefsForStudy(studyId) {</span>
<a href="#l131.100"></a><span id="l131.100" class="difflineminus">-  output(&quot;Looking for prefs to delete...\n&quot;);</span>
<a href="#l131.101"></a><span id="l131.101" class="difflineminus">-  let prefService = Cc[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l131.102"></a><span id="l131.102" class="difflineminus">-                     .getService(Ci.nsIPrefService)</span>
<a href="#l131.103"></a><span id="l131.103" class="difflineminus">-                     .QueryInterface(Ci.nsIPrefBranch);</span>
<a href="#l131.104"></a><span id="l131.104" class="difflineminus">-  let prefStem = &quot;extensions.testpilot&quot;;</span>
<a href="#l131.105"></a><span id="l131.105" class="difflineminus">-  let prefNames = prefService.getChildList(prefStem);</span>
<a href="#l131.106"></a><span id="l131.106" class="difflineminus">-  for each (let prefName in prefNames) {</span>
<a href="#l131.107"></a><span id="l131.107" class="difflineminus">-    if (prefName.indexOf(studyId) != -1) {</span>
<a href="#l131.108"></a><span id="l131.108" class="difflineminus">-      output(&quot;Clearing pref &quot; + prefName + &quot;\n&quot;);</span>
<a href="#l131.109"></a><span id="l131.109" class="difflineminus">-      prefService.clearUserPref(prefName);</span>
<a href="#l131.110"></a><span id="l131.110" class="difflineminus">-    }</span>
<a href="#l131.111"></a><span id="l131.111" class="difflineminus">-  }</span>
<a href="#l131.112"></a><span id="l131.112" class="difflineminus">-}</span>
<a href="#l131.113"></a><span id="l131.113" class="difflineminus">-</span>
<a href="#l131.114"></a><span id="l131.114" class="difflineminus">-function clearDbFile(filename) {</span>
<a href="#l131.115"></a><span id="l131.115" class="difflineminus">-  let dirSvc = Cc[&quot;@mozilla.org/file/directory_service;1&quot;]</span>
<a href="#l131.116"></a><span id="l131.116" class="difflineminus">-                .getService(Ci.nsIProperties);</span>
<a href="#l131.117"></a><span id="l131.117" class="difflineminus">-  let file = dirSvc.get(&quot;ProfD&quot;, Ci.nsIFile);</span>
<a href="#l131.118"></a><span id="l131.118" class="difflineminus">-  file.append(filename);</span>
<a href="#l131.119"></a><span id="l131.119" class="difflineminus">-  if (file.exists()) {</span>
<a href="#l131.120"></a><span id="l131.120" class="difflineminus">-    file.remove(false);</span>
<a href="#l131.121"></a><span id="l131.121" class="difflineminus">-  }</span>
<a href="#l131.122"></a><span id="l131.122" class="difflineminus">-}</span>
<a href="#l131.123"></a><span id="l131.123" class="difflineminus">-</span>
<a href="#l131.124"></a><span id="l131.124" class="difflineminus">-// Other utility functions</span>
<a href="#l131.125"></a><span id="l131.125" class="difflineminus">-</span>
<a href="#l131.126"></a><span id="l131.126" class="difflineminus">-function waitABit(seconds, callback) {</span>
<a href="#l131.127"></a><span id="l131.127" class="difflineminus">- let timer = Cc[&quot;@mozilla.org/timer;1&quot;].createInstance(Ci.nsITimer);</span>
<a href="#l131.128"></a><span id="l131.128" class="difflineminus">- timer.initWithCallback({ notify: function(timer) {</span>
<a href="#l131.129"></a><span id="l131.129" class="difflineminus">-                            callback();</span>
<a href="#l131.130"></a><span id="l131.130" class="difflineminus">-                          }}, seconds * 1000, Ci.nsITimer.TYPE_ONE_SHOT);</span>
<a href="#l131.131"></a><span id="l131.131" class="difflineminus">-}</span>
<a href="#l131.132"></a><span id="l131.132" class="difflineminus">-</span>
<a href="#l131.133"></a><span id="l131.133" class="difflineminus">-</span>
<a href="#l131.134"></a><span id="l131.134" class="difflineminus">-function base64decode(data) {</span>
<a href="#l131.135"></a><span id="l131.135" class="difflineminus">-  // base64 encode/decode is built into window object, but we're in a module so we</span>
<a href="#l131.136"></a><span id="l131.136" class="difflineminus">-  // need to fetch a window reference first:</span>
<a href="#l131.137"></a><span id="l131.137" class="difflineminus">-  let wm = Cc[&quot;@mozilla.org/appshell/window-mediator;1&quot;].</span>
<a href="#l131.138"></a><span id="l131.138" class="difflineminus">-    getService(Ci.nsIWindowMediator);</span>
<a href="#l131.139"></a><span id="l131.139" class="difflineminus">-  let window = wm.getMostRecentWindow(&quot;navigator:browser&quot;) ||</span>
<a href="#l131.140"></a><span id="l131.140" class="difflineminus">-               wm.getMostRecentWindow(&quot;mail:3pane&quot;);</span>
<a href="#l131.141"></a><span id="l131.141" class="difflineminus">-  return window.atob(data);</span>
<a href="#l131.142"></a><span id="l131.142" class="difflineminus">-}</span>
<a href="#l131.143"></a><span id="l131.143" class="difflineminus">-</span>
<a href="#l131.144"></a><span id="l131.144" class="difflineminus">-function ensureExperimentIsRunning(experiment) {</span>
<a href="#l131.145"></a><span id="l131.145" class="difflineminus">-  if (!experiment.experimentIsRunning) {</span>
<a href="#l131.146"></a><span id="l131.146" class="difflineminus">-    experiment.changeStatus(TaskConstants.STATUS_STARTING, true);</span>
<a href="#l131.147"></a><span id="l131.147" class="difflineminus">-    experiment.checkDate(); // will call onExperimentStartup()</span>
<a href="#l131.148"></a><span id="l131.148" class="difflineminus">-  }</span>
<a href="#l131.149"></a><span id="l131.149" class="difflineminus">-}</span>
<a href="#l131.150"></a><span id="l131.150" class="difflineminus">-</span>
<a href="#l131.151"></a><span id="l131.151" class="difflineminus">-// Beginning of tests</span>
<a href="#l131.152"></a><span id="l131.152" class="difflineminus">-</span>
<a href="#l131.153"></a><span id="l131.153" class="difflineminus">-</span>
<a href="#l131.154"></a><span id="l131.154" class="difflineminus">-function testFirefoxVersionCheck() {</span>
<a href="#l131.155"></a><span id="l131.155" class="difflineminus">-  Cu.import(&quot;resource://testpilot/modules/setup.js&quot;);</span>
<a href="#l131.156"></a><span id="l131.156" class="difflineminus">-  cheapAssertEqual(true, TestPilotSetup._isNewerThanFirefox(&quot;4.0&quot;));</span>
<a href="#l131.157"></a><span id="l131.157" class="difflineminus">-  cheapAssertEqual(false, TestPilotSetup._isNewerThanFirefox(&quot;3.5&quot;));</span>
<a href="#l131.158"></a><span id="l131.158" class="difflineminus">-  cheapAssertEqual(false, TestPilotSetup._isNewerThanFirefox(&quot;3.6&quot;));</span>
<a href="#l131.159"></a><span id="l131.159" class="difflineminus">-}</span>
<a href="#l131.160"></a><span id="l131.160" class="difflineminus">-</span>
<a href="#l131.161"></a><span id="l131.161" class="difflineminus">-function testStringSanitizer() {</span>
<a href="#l131.162"></a><span id="l131.162" class="difflineminus">-  Cu.import(&quot;resource://testpilot/modules/string_sanitizer.js&quot;);</span>
<a href="#l131.163"></a><span id="l131.163" class="difflineminus">-  var evilString = &quot;I *have* (evil) ^characters^ [hahaha];&quot;;</span>
<a href="#l131.164"></a><span id="l131.164" class="difflineminus">-  output(&quot;Sanitized evil string is &quot; + sanitizeString(evilString) + &quot;\n&quot;);</span>
<a href="#l131.165"></a><span id="l131.165" class="difflineminus">-  cheapAssertEqual(sanitizeString(evilString),</span>
<a href="#l131.166"></a><span id="l131.166" class="difflineminus">-                   &quot;I ?have? ?evil? ?characters? ?hahaha??&quot;);</span>
<a href="#l131.167"></a><span id="l131.167" class="difflineminus">-}</span>
<a href="#l131.168"></a><span id="l131.168" class="difflineminus">-</span>
<a href="#l131.169"></a><span id="l131.169" class="difflineminus">-function testTheDataStore() {</span>
<a href="#l131.170"></a><span id="l131.170" class="difflineminus">-  // Geez, async unit tests are a pain.</span>
<a href="#l131.171"></a><span id="l131.171" class="difflineminus">-  Cu.import(&quot;resource://testpilot/modules/experiment_data_store.js&quot;);</span>
<a href="#l131.172"></a><span id="l131.172" class="difflineminus">-</span>
<a href="#l131.173"></a><span id="l131.173" class="difflineminus">-  var columns =  [{property: &quot;prop_a&quot;, type: TYPE_INT_32, displayName: &quot;Length&quot;},</span>
<a href="#l131.174"></a><span id="l131.174" class="difflineminus">-                  {property: &quot;prop_b&quot;, type: TYPE_INT_32, displayName: &quot;Type&quot;,</span>
<a href="#l131.175"></a><span id="l131.175" class="difflineminus">-                   displayValue: [&quot;Spam&quot;, &quot;Egg&quot;, &quot;Sausage&quot;, &quot;Baked Beans&quot;]},</span>
<a href="#l131.176"></a><span id="l131.176" class="difflineminus">-                  {property: &quot;prop_c&quot;, type: TYPE_DOUBLE, displayName: &quot;Depth&quot;},</span>
<a href="#l131.177"></a><span id="l131.177" class="difflineminus">-                  {property: &quot;prop_s&quot;, type: TYPE_STRING, displayName: &quot;Text&quot;}</span>
<a href="#l131.178"></a><span id="l131.178" class="difflineminus">-                  ];</span>
<a href="#l131.179"></a><span id="l131.179" class="difflineminus">-</span>
<a href="#l131.180"></a><span id="l131.180" class="difflineminus">-  var fileName = &quot;testpilot_storage_unit_test.sqlite&quot;;</span>
<a href="#l131.181"></a><span id="l131.181" class="difflineminus">-  var tableName = &quot;testpilot_storage_unit_test&quot;;</span>
<a href="#l131.182"></a><span id="l131.182" class="difflineminus">-  var storedCount = 0;</span>
<a href="#l131.183"></a><span id="l131.183" class="difflineminus">-  clearDbFile(fileName);</span>
<a href="#l131.184"></a><span id="l131.184" class="difflineminus">-  var store = new ExperimentDataStore(fileName, tableName, columns);</span>
<a href="#l131.185"></a><span id="l131.185" class="difflineminus">-</span>
<a href="#l131.186"></a><span id="l131.186" class="difflineminus">-</span>
<a href="#l131.187"></a><span id="l131.187" class="difflineminus">-  store.storeEvent({prop_a: 13, prop_b: 3, prop_c: 0.001, prop_s: &quot;How&quot;},</span>
<a href="#l131.188"></a><span id="l131.188" class="difflineminus">-                   function(stored) {</span>
<a href="#l131.189"></a><span id="l131.189" class="difflineminus">-                     storedCount++;</span>
<a href="#l131.190"></a><span id="l131.190" class="difflineminus">-                     if (storedCount == 4) {</span>
<a href="#l131.191"></a><span id="l131.191" class="difflineminus">-                       _testTheDataStore(store);</span>
<a href="#l131.192"></a><span id="l131.192" class="difflineminus">-                     }</span>
<a href="#l131.193"></a><span id="l131.193" class="difflineminus">-                   });</span>
<a href="#l131.194"></a><span id="l131.194" class="difflineminus">-  store.storeEvent({prop_a: 26, prop_b: 2, prop_c: 0.002, prop_s: &quot; do&quot;},</span>
<a href="#l131.195"></a><span id="l131.195" class="difflineminus">-                    function(stored) {</span>
<a href="#l131.196"></a><span id="l131.196" class="difflineminus">-                     storedCount++;</span>
<a href="#l131.197"></a><span id="l131.197" class="difflineminus">-                     if (storedCount == 4) {</span>
<a href="#l131.198"></a><span id="l131.198" class="difflineminus">-                       _testTheDataStore(store);</span>
<a href="#l131.199"></a><span id="l131.199" class="difflineminus">-                     }</span>
<a href="#l131.200"></a><span id="l131.200" class="difflineminus">-                   });</span>
<a href="#l131.201"></a><span id="l131.201" class="difflineminus">-  store.storeEvent({prop_a: 39, prop_b: 1, prop_c: 0.003, prop_s: &quot; you&quot;},</span>
<a href="#l131.202"></a><span id="l131.202" class="difflineminus">-                    function(stored) {</span>
<a href="#l131.203"></a><span id="l131.203" class="difflineminus">-                     storedCount++;</span>
<a href="#l131.204"></a><span id="l131.204" class="difflineminus">-                     if (storedCount == 4) {</span>
<a href="#l131.205"></a><span id="l131.205" class="difflineminus">-                       _testTheDataStore(store);</span>
<a href="#l131.206"></a><span id="l131.206" class="difflineminus">-                     }</span>
<a href="#l131.207"></a><span id="l131.207" class="difflineminus">-                   });</span>
<a href="#l131.208"></a><span id="l131.208" class="difflineminus">-  store.storeEvent({prop_a: 52, prop_b: 0, prop_c: 0.004, prop_s: &quot; do?&quot;},</span>
<a href="#l131.209"></a><span id="l131.209" class="difflineminus">-                    function(stored) {</span>
<a href="#l131.210"></a><span id="l131.210" class="difflineminus">-                     storedCount++;</span>
<a href="#l131.211"></a><span id="l131.211" class="difflineminus">-                     if (storedCount == 4) {</span>
<a href="#l131.212"></a><span id="l131.212" class="difflineminus">-                       _testTheDataStore(store);</span>
<a href="#l131.213"></a><span id="l131.213" class="difflineminus">-                     }</span>
<a href="#l131.214"></a><span id="l131.214" class="difflineminus">-                   });</span>
<a href="#l131.215"></a><span id="l131.215" class="difflineminus">-</span>
<a href="#l131.216"></a><span id="l131.216" class="difflineminus">-</span>
<a href="#l131.217"></a><span id="l131.217" class="difflineminus">-  function _testTheDataStore(store) {</span>
<a href="#l131.218"></a><span id="l131.218" class="difflineminus">-    cheapAssertEqualArrays(store.getHumanReadableColumnNames(), [&quot;Length&quot;, &quot;Type&quot;, &quot;Depth&quot;, &quot;Text&quot;],</span>
<a href="#l131.219"></a><span id="l131.219" class="difflineminus">-                   &quot;Human readable column names are not correct.&quot;);</span>
<a href="#l131.220"></a><span id="l131.220" class="difflineminus">-    cheapAssertEqualArrays(store.getPropertyNames(), [&quot;prop_a&quot;, &quot;prop_b&quot;, &quot;prop_c&quot;, &quot;prop_s&quot;],</span>
<a href="#l131.221"></a><span id="l131.221" class="difflineminus">-                        &quot;Property names are not correct.&quot;);</span>
<a href="#l131.222"></a><span id="l131.222" class="difflineminus">-    store.getAllDataAsJSON(false, function(json) {</span>
<a href="#l131.223"></a><span id="l131.223" class="difflineminus">-      var expectedJson = [{prop_a: 13, prop_b: 3, prop_c: 0.001, prop_s: &quot;How&quot;},</span>
<a href="#l131.224"></a><span id="l131.224" class="difflineminus">-                      {prop_a: 26, prop_b: 2, prop_c: 0.002, prop_s: &quot; do&quot;},</span>
<a href="#l131.225"></a><span id="l131.225" class="difflineminus">-                       {prop_a: 39, prop_b: 1, prop_c: 0.003, prop_s: &quot; you&quot;},</span>
<a href="#l131.226"></a><span id="l131.226" class="difflineminus">-                      {prop_a: 52, prop_b: 0, prop_c: 0.004, prop_s: &quot; do?&quot;}];</span>
<a href="#l131.227"></a><span id="l131.227" class="difflineminus">-      cheapAssertEqual(JSON.stringify(json),</span>
<a href="#l131.228"></a><span id="l131.228" class="difflineminus">-                       JSON.stringify(expectedJson),</span>
<a href="#l131.229"></a><span id="l131.229" class="difflineminus">-                       &quot;Stringified JSON does not match expectations.&quot;);</span>
<a href="#l131.230"></a><span id="l131.230" class="difflineminus">-</span>
<a href="#l131.231"></a><span id="l131.231" class="difflineminus">-      _testTheDataStore2(store);</span>
<a href="#l131.232"></a><span id="l131.232" class="difflineminus">-    });</span>
<a href="#l131.233"></a><span id="l131.233" class="difflineminus">-  }</span>
<a href="#l131.234"></a><span id="l131.234" class="difflineminus">-</span>
<a href="#l131.235"></a><span id="l131.235" class="difflineminus">-  function _testTheDataStore2(store) {</span>
<a href="#l131.236"></a><span id="l131.236" class="difflineminus">-    // Let's ask for the human-readable values now...</span>
<a href="#l131.237"></a><span id="l131.237" class="difflineminus">-    store.getAllDataAsJSON(true, function(json) {</span>
<a href="#l131.238"></a><span id="l131.238" class="difflineminus">-      var expectedJson = [{prop_a: 13, prop_b: &quot;Baked Beans&quot;, prop_c: 0.001, prop_s: &quot;How&quot;},</span>
<a href="#l131.239"></a><span id="l131.239" class="difflineminus">-                      {prop_a: 26, prop_b: &quot;Sausage&quot;, prop_c: 0.002, prop_s: &quot; do&quot;},</span>
<a href="#l131.240"></a><span id="l131.240" class="difflineminus">-                      {prop_a: 39, prop_b: &quot;Egg&quot;, prop_c: 0.003, prop_s: &quot; you&quot;},</span>
<a href="#l131.241"></a><span id="l131.241" class="difflineminus">-                      {prop_a: 52, prop_b: &quot;Spam&quot;, prop_c: 0.004, prop_s: &quot; do?&quot;}];</span>
<a href="#l131.242"></a><span id="l131.242" class="difflineminus">-      cheapAssertEqual(JSON.stringify(json),</span>
<a href="#l131.243"></a><span id="l131.243" class="difflineminus">-                       JSON.stringify(expectedJson),</span>
<a href="#l131.244"></a><span id="l131.244" class="difflineminus">-                       &quot;JSON with human-radable values does not match expectations.&quot;);</span>
<a href="#l131.245"></a><span id="l131.245" class="difflineminus">-      _testDataStoreWipe(store);</span>
<a href="#l131.246"></a><span id="l131.246" class="difflineminus">-    });</span>
<a href="#l131.247"></a><span id="l131.247" class="difflineminus">-  }</span>
<a href="#l131.248"></a><span id="l131.248" class="difflineminus">-</span>
<a href="#l131.249"></a><span id="l131.249" class="difflineminus">-  function _testDataStoreWipe(store) {</span>
<a href="#l131.250"></a><span id="l131.250" class="difflineminus">-    // Wipe all data and ensure that we get back blanks:</span>
<a href="#l131.251"></a><span id="l131.251" class="difflineminus">-    store.wipeAllData(function(wiped) {</span>
<a href="#l131.252"></a><span id="l131.252" class="difflineminus">-      store.getAllDataAsJSON(false, function(json) {</span>
<a href="#l131.253"></a><span id="l131.253" class="difflineminus">-        var expectedJson = [];</span>
<a href="#l131.254"></a><span id="l131.254" class="difflineminus">-        cheapAssertEqual(JSON.stringify(json),</span>
<a href="#l131.255"></a><span id="l131.255" class="difflineminus">-                         JSON.stringify(expectedJson),</span>
<a href="#l131.256"></a><span id="l131.256" class="difflineminus">-                        &quot;JSON after wipe fails to be empty.&quot;);</span>
<a href="#l131.257"></a><span id="l131.257" class="difflineminus">-        // end test by clearing file - TODO this should be in teardown</span>
<a href="#l131.258"></a><span id="l131.258" class="difflineminus">-        clearDbFile(fileName);</span>
<a href="#l131.259"></a><span id="l131.259" class="difflineminus">-      });</span>
<a href="#l131.260"></a><span id="l131.260" class="difflineminus">-    });</span>
<a href="#l131.261"></a><span id="l131.261" class="difflineminus">-  }</span>
<a href="#l131.262"></a><span id="l131.262" class="difflineminus">-};</span>
<a href="#l131.263"></a><span id="l131.263" class="difflineminus">-</span>
<a href="#l131.264"></a><span id="l131.264" class="difflineminus">-</span>
<a href="#l131.265"></a><span id="l131.265" class="difflineminus">-function testTheCuddlefishPreferencesFilesystem() {</span>
<a href="#l131.266"></a><span id="l131.266" class="difflineminus">-</span>
<a href="#l131.267"></a><span id="l131.267" class="difflineminus">-  // Put some sample code into various 'files' in the preferences filesystem</span>
<a href="#l131.268"></a><span id="l131.268" class="difflineminus">-  // Get it out, make sure it's the same code.</span>
<a href="#l131.269"></a><span id="l131.269" class="difflineminus">-  // Shut it down, start it up, make sure it's still got the same code in it.</span>
<a href="#l131.270"></a><span id="l131.270" class="difflineminus">-  // Put in new code; make sure we get the new code, not the old code.</span>
<a href="#l131.271"></a><span id="l131.271" class="difflineminus">-  var Cuddlefish = {};</span>
<a href="#l131.272"></a><span id="l131.272" class="difflineminus">-  Cu.import(&quot;resource://testpilot/modules/lib/cuddlefish.js&quot;,</span>
<a href="#l131.273"></a><span id="l131.273" class="difflineminus">-                          Cuddlefish);</span>
<a href="#l131.274"></a><span id="l131.274" class="difflineminus">-  let cfl = new Cuddlefish.Loader({rootPaths: [&quot;resource://testpilot/modules/&quot;,</span>
<a href="#l131.275"></a><span id="l131.275" class="difflineminus">-                                               &quot;resource://testpilot/modules/lib/&quot;]});</span>
<a href="#l131.276"></a><span id="l131.276" class="difflineminus">-  let remoteLoaderModule = cfl.require(&quot;remote-experiment-loader&quot;);</span>
<a href="#l131.277"></a><span id="l131.277" class="difflineminus">-  let prefName = &quot;extensions.testpilot.unittest.prefCodeStore&quot;;</span>
<a href="#l131.278"></a><span id="l131.278" class="difflineminus">-  let pfs = new remoteLoaderModule.PreferencesStore(prefName);</span>
<a href="#l131.279"></a><span id="l131.279" class="difflineminus">-  let contents1 = &quot;function foo(x, y) { return x * y; }&quot;;</span>
<a href="#l131.280"></a><span id="l131.280" class="difflineminus">-  let contents2 = &quot;function bar(x, y) { return x / y; }&quot;;</span>
<a href="#l131.281"></a><span id="l131.281" class="difflineminus">-</span>
<a href="#l131.282"></a><span id="l131.282" class="difflineminus">-  let earlyBoundDate = new Date();</span>
<a href="#l131.283"></a><span id="l131.283" class="difflineminus">-  pfs.setFile(&quot;foo.js&quot;, contents1);</span>
<a href="#l131.284"></a><span id="l131.284" class="difflineminus">-  pfs.setFile(&quot;bar.js&quot;, contents2);</span>
<a href="#l131.285"></a><span id="l131.285" class="difflineminus">-  let lateBoundDate = new Date();</span>
<a href="#l131.286"></a><span id="l131.286" class="difflineminus">-</span>
<a href="#l131.287"></a><span id="l131.287" class="difflineminus">-  let path = pfs.resolveModule(&quot;/&quot;, &quot;foo.js&quot;);</span>
<a href="#l131.288"></a><span id="l131.288" class="difflineminus">-  cheapAssertEqual(path, &quot;foo.js&quot;, &quot;resolveModule does not return expected path.&quot;);</span>
<a href="#l131.289"></a><span id="l131.289" class="difflineminus">-  path = pfs.resolveModule(&quot;/&quot;, &quot;bar.js&quot;);</span>
<a href="#l131.290"></a><span id="l131.290" class="difflineminus">-  cheapAssertEqual(path, &quot;bar.js&quot;, &quot;resolveModule does not return expected path.&quot;);</span>
<a href="#l131.291"></a><span id="l131.291" class="difflineminus">-  path = pfs.resolveModule(&quot;/&quot;, &quot;baz.js&quot;);</span>
<a href="#l131.292"></a><span id="l131.292" class="difflineminus">-  cheapAssertEqual(path, null, &quot;Found a match for nonexistent file.&quot;);</span>
<a href="#l131.293"></a><span id="l131.293" class="difflineminus">-</span>
<a href="#l131.294"></a><span id="l131.294" class="difflineminus">-  let file = pfs.getFile(&quot;foo.js&quot;);</span>
<a href="#l131.295"></a><span id="l131.295" class="difflineminus">-  cheapAssertEqual(file.contents, contents1, &quot;File contents do not match.&quot;);</span>
<a href="#l131.296"></a><span id="l131.296" class="difflineminus">-  cheapAssertRange(earlyBoundDate, pfs.getFileModifiedDate(&quot;foo.js&quot;), lateBoundDate,</span>
<a href="#l131.297"></a><span id="l131.297" class="difflineminus">-                   &quot;File modified date not correct.&quot;);</span>
<a href="#l131.298"></a><span id="l131.298" class="difflineminus">-</span>
<a href="#l131.299"></a><span id="l131.299" class="difflineminus">-  file = pfs.getFile(&quot;bar.js&quot;);</span>
<a href="#l131.300"></a><span id="l131.300" class="difflineminus">-  cheapAssertEqual(file.contents, contents2, &quot;File contents do not match.&quot;);</span>
<a href="#l131.301"></a><span id="l131.301" class="difflineminus">-  cheapAssertRange(earlyBoundDate, pfs.getFileModifiedDate(&quot;bar.js&quot;), lateBoundDate,</span>
<a href="#l131.302"></a><span id="l131.302" class="difflineminus">-                   &quot;File modified date not correct.&quot;);</span>
<a href="#l131.303"></a><span id="l131.303" class="difflineminus">-</span>
<a href="#l131.304"></a><span id="l131.304" class="difflineminus">-  delete pfs;</span>
<a href="#l131.305"></a><span id="l131.305" class="difflineminus">-  let pfs2 = new remoteLoaderModule.PreferencesStore(prefName);</span>
<a href="#l131.306"></a><span id="l131.306" class="difflineminus">-</span>
<a href="#l131.307"></a><span id="l131.307" class="difflineminus">-  file = pfs2.getFile(&quot;foo.js&quot;);</span>
<a href="#l131.308"></a><span id="l131.308" class="difflineminus">-  cheapAssertEqual(file.contents, contents1, &quot;File contents do not match after reloading.&quot;);</span>
<a href="#l131.309"></a><span id="l131.309" class="difflineminus">-  file = pfs2.getFile(&quot;bar.js&quot;);</span>
<a href="#l131.310"></a><span id="l131.310" class="difflineminus">-  cheapAssertEqual(file.contents, contents2, &quot;File contents do not match after reloading.&quot;);</span>
<a href="#l131.311"></a><span id="l131.311" class="difflineminus">-</span>
<a href="#l131.312"></a><span id="l131.312" class="difflineminus">-  let contents3 = &quot;function foo(x, y) { return (x + y)/2; }&quot;;</span>
<a href="#l131.313"></a><span id="l131.313" class="difflineminus">-</span>
<a href="#l131.314"></a><span id="l131.314" class="difflineminus">-  pfs2.setFile(&quot;foo.js&quot;, contents3);</span>
<a href="#l131.315"></a><span id="l131.315" class="difflineminus">-  file = pfs2.getFile(&quot;foo.js&quot;);</span>
<a href="#l131.316"></a><span id="l131.316" class="difflineminus">-  cheapAssertEqual(file.contents, contents3, &quot;File contents do not newly set contents.&quot;);</span>
<a href="#l131.317"></a><span id="l131.317" class="difflineminus">-}</span>
<a href="#l131.318"></a><span id="l131.318" class="difflineminus">-</span>
<a href="#l131.319"></a><span id="l131.319" class="difflineminus">-function testRemoteLoader() {</span>
<a href="#l131.320"></a><span id="l131.320" class="difflineminus">-  // this tests loading modules through cuddlefish from prefs store...</span>
<a href="#l131.321"></a><span id="l131.321" class="difflineminus">-  // Need to make sure that a</span>
<a href="#l131.322"></a><span id="l131.322" class="difflineminus">-  var Cuddlefish = {};</span>
<a href="#l131.323"></a><span id="l131.323" class="difflineminus">-  Cu.import(&quot;resource://testpilot/modules/lib/cuddlefish.js&quot;,</span>
<a href="#l131.324"></a><span id="l131.324" class="difflineminus">-                          Cuddlefish);</span>
<a href="#l131.325"></a><span id="l131.325" class="difflineminus">-  let cfl = new Cuddlefish.Loader({rootPaths: [&quot;resource://testpilot/modules/&quot;,</span>
<a href="#l131.326"></a><span id="l131.326" class="difflineminus">-                                               &quot;resource://testpilot/modules/lib/&quot;]});</span>
<a href="#l131.327"></a><span id="l131.327" class="difflineminus">-  let remoteLoaderModule = cfl.require(&quot;remote-experiment-loader&quot;);</span>
<a href="#l131.328"></a><span id="l131.328" class="difflineminus">-</span>
<a href="#l131.329"></a><span id="l131.329" class="difflineminus">-  var indexJson = '{&quot;experiments&quot;: [{&quot;name&quot;: &quot;Foo Study&quot;, '</span>
<a href="#l131.330"></a><span id="l131.330" class="difflineminus">-                  + '&quot;filename&quot;: &quot;foo.js&quot;}]}';</span>
<a href="#l131.331"></a><span id="l131.331" class="difflineminus">-</span>
<a href="#l131.332"></a><span id="l131.332" class="difflineminus">-  var theRemoteFile = &quot;exports.foo = function(x, y) { return x * y; }&quot;;</span>
<a href="#l131.333"></a><span id="l131.333" class="difflineminus">-</span>
<a href="#l131.334"></a><span id="l131.334" class="difflineminus">-  let getFileFunc = function(url, callback) {</span>
<a href="#l131.335"></a><span id="l131.335" class="difflineminus">-    if (url.indexOf(&quot;index.json&quot;) &gt; -1) {</span>
<a href="#l131.336"></a><span id="l131.336" class="difflineminus">-      if (indexJson != &quot;&quot;) {</span>
<a href="#l131.337"></a><span id="l131.337" class="difflineminus">-        callback(indexJson);</span>
<a href="#l131.338"></a><span id="l131.338" class="difflineminus">-      } else {</span>
<a href="#l131.339"></a><span id="l131.339" class="difflineminus">-        callback(null);</span>
<a href="#l131.340"></a><span id="l131.340" class="difflineminus">-      }</span>
<a href="#l131.341"></a><span id="l131.341" class="difflineminus">-    } else if (url.indexOf(&quot;foo.js&quot;) &gt; -1) {</span>
<a href="#l131.342"></a><span id="l131.342" class="difflineminus">-      callback(theRemoteFile);</span>
<a href="#l131.343"></a><span id="l131.343" class="difflineminus">-    } else {</span>
<a href="#l131.344"></a><span id="l131.344" class="difflineminus">-      callback(null);</span>
<a href="#l131.345"></a><span id="l131.345" class="difflineminus">-    }</span>
<a href="#l131.346"></a><span id="l131.346" class="difflineminus">-  };</span>
<a href="#l131.347"></a><span id="l131.347" class="difflineminus">-</span>
<a href="#l131.348"></a><span id="l131.348" class="difflineminus">-  let remoteLoader = new remoteLoaderModule.RemoteExperimentLoader(stubLogger, getFileFunc);</span>
<a href="#l131.349"></a><span id="l131.349" class="difflineminus">-</span>
<a href="#l131.350"></a><span id="l131.350" class="difflineminus">-  remoteLoader.checkForUpdates(function(success) {</span>
<a href="#l131.351"></a><span id="l131.351" class="difflineminus">-    if (success) {</span>
<a href="#l131.352"></a><span id="l131.352" class="difflineminus">-      let foo = remoteLoader.getExperiments()[&quot;foo.js&quot;];</span>
<a href="#l131.353"></a><span id="l131.353" class="difflineminus">-      cheapAssertEqual(foo.foo(6, 7), 42, &quot;Foo doesn't work.&quot;);</span>
<a href="#l131.354"></a><span id="l131.354" class="difflineminus">-    } else {</span>
<a href="#l131.355"></a><span id="l131.355" class="difflineminus">-      cheapAssertFail(&quot;checkForUpdates returned failure.&quot;);</span>
<a href="#l131.356"></a><span id="l131.356" class="difflineminus">-    }</span>
<a href="#l131.357"></a><span id="l131.357" class="difflineminus">-</span>
<a href="#l131.358"></a><span id="l131.358" class="difflineminus">-    /* Now we change the remote code and call checkForUpdates again...</span>
<a href="#l131.359"></a><span id="l131.359" class="difflineminus">-     * test that this results in the newly redefined version of function foo</span>
<a href="#l131.360"></a><span id="l131.360" class="difflineminus">-     * being the one that is used.  (Note that this failed until I modified</span>
<a href="#l131.361"></a><span id="l131.361" class="difflineminus">-     * remoteExperimentLoader to reinitialize its</span>
<a href="#l131.362"></a><span id="l131.362" class="difflineminus">-     * Cuddlefish.loader during the call to checkForUpdates. */</span>
<a href="#l131.363"></a><span id="l131.363" class="difflineminus">-    theRemoteFile = &quot;exports.foo = function(x, y) { return x + y; }&quot;;</span>
<a href="#l131.364"></a><span id="l131.364" class="difflineminus">-    remoteLoader.checkForUpdates( function(success) {</span>
<a href="#l131.365"></a><span id="l131.365" class="difflineminus">-      if (success) {</span>
<a href="#l131.366"></a><span id="l131.366" class="difflineminus">-         let foo = remoteLoader.getExperiments()[&quot;foo.js&quot;];</span>
<a href="#l131.367"></a><span id="l131.367" class="difflineminus">-        cheapAssertEqual(foo.foo(6, 7), 13, &quot;2nd version of Foo doesn't work.&quot;);</span>
<a href="#l131.368"></a><span id="l131.368" class="difflineminus">-      } else {</span>
<a href="#l131.369"></a><span id="l131.369" class="difflineminus">-        cheapAssertFail(&quot;checkForUpdates 2nd time returned failure.&quot;);</span>
<a href="#l131.370"></a><span id="l131.370" class="difflineminus">-      }</span>
<a href="#l131.371"></a><span id="l131.371" class="difflineminus">-      /* For the third part of the test, make getFileFunc FAIL,</span>
<a href="#l131.372"></a><span id="l131.372" class="difflineminus">-       * and make sure the cached version still gets used and still works! */</span>
<a href="#l131.373"></a><span id="l131.373" class="difflineminus">-      indexJson = &quot;&quot;;</span>
<a href="#l131.374"></a><span id="l131.374" class="difflineminus">-      remoteLoader.checkForUpdates( function(success) {</span>
<a href="#l131.375"></a><span id="l131.375" class="difflineminus">-        cheapAssertEqual(success, false, &quot;3rd check for updates should have failed.&quot;);</span>
<a href="#l131.376"></a><span id="l131.376" class="difflineminus">-        let foo = remoteLoader.getExperiments()[&quot;foo.js&quot;];</span>
<a href="#l131.377"></a><span id="l131.377" class="difflineminus">-        cheapAssertEqual(foo.foo(6, 7), 13, &quot;Should still have the 2nd version of Foo.&quot;);</span>
<a href="#l131.378"></a><span id="l131.378" class="difflineminus">-      });</span>
<a href="#l131.379"></a><span id="l131.379" class="difflineminus">-    });</span>
<a href="#l131.380"></a><span id="l131.380" class="difflineminus">-  });</span>
<a href="#l131.381"></a><span id="l131.381" class="difflineminus">-}</span>
<a href="#l131.382"></a><span id="l131.382" class="difflineminus">-</span>
<a href="#l131.383"></a><span id="l131.383" class="difflineminus">-function testRemotelyLoadTabsExperiment() {</span>
<a href="#l131.384"></a><span id="l131.384" class="difflineminus">-</span>
<a href="#l131.385"></a><span id="l131.385" class="difflineminus">-  // TODO: Stub out the function downloadFile in remote-experiment-loader with</span>
<a href="#l131.386"></a><span id="l131.386" class="difflineminus">-  // something that will give us the files from the local repo on the disk.</span>
<a href="#l131.387"></a><span id="l131.387" class="difflineminus">-  // (~/testpilot/website/testcases/tab-open-close/tabs_experiment.js)</span>
<a href="#l131.388"></a><span id="l131.388" class="difflineminus">-}</span>
<a href="#l131.389"></a><span id="l131.389" class="difflineminus">-</span>
<a href="#l131.390"></a><span id="l131.390" class="difflineminus">-let stubLogger = {</span>
<a href="#l131.391"></a><span id="l131.391" class="difflineminus">-  getLogger: function() { return {trace: function(str) {output(&quot;Trace: &quot; + str +&quot;\n&quot;);},</span>
<a href="#l131.392"></a><span id="l131.392" class="difflineminus">-                                  warn: function(str) {output(&quot;Warn: &quot; + str +&quot;\n&quot;);},</span>
<a href="#l131.393"></a><span id="l131.393" class="difflineminus">-                                  info: function(str) {output(&quot;Info: &quot; + str +&quot;\n&quot;);},</span>
<a href="#l131.394"></a><span id="l131.394" class="difflineminus">-                                  debug: function(str) {output(&quot;Debug: &quot; + str +&quot;\n&quot;);}};}</span>
<a href="#l131.395"></a><span id="l131.395" class="difflineminus">-};</span>
<a href="#l131.396"></a><span id="l131.396" class="difflineminus">-</span>
<a href="#l131.397"></a><span id="l131.397" class="difflineminus">-</span>
<a href="#l131.398"></a><span id="l131.398" class="difflineminus">-function testRemoteLoaderIndexCache() {</span>
<a href="#l131.399"></a><span id="l131.399" class="difflineminus">-  var Cuddlefish = {};</span>
<a href="#l131.400"></a><span id="l131.400" class="difflineminus">-  Cu.import(&quot;resource://testpilot/modules/lib/cuddlefish.js&quot;,</span>
<a href="#l131.401"></a><span id="l131.401" class="difflineminus">-                          Cuddlefish);</span>
<a href="#l131.402"></a><span id="l131.402" class="difflineminus">-  let cfl = new Cuddlefish.Loader({rootPaths: [&quot;resource://testpilot/modules/&quot;,</span>
<a href="#l131.403"></a><span id="l131.403" class="difflineminus">-                                               &quot;resource://testpilot/modules/lib/&quot;]});</span>
<a href="#l131.404"></a><span id="l131.404" class="difflineminus">-  let remoteLoaderModule = cfl.require(&quot;remote-experiment-loader&quot;);</span>
<a href="#l131.405"></a><span id="l131.405" class="difflineminus">-</span>
<a href="#l131.406"></a><span id="l131.406" class="difflineminus">-  let getFileFunc = function(url, callback) {</span>
<a href="#l131.407"></a><span id="l131.407" class="difflineminus">-    callback(null);</span>
<a href="#l131.408"></a><span id="l131.408" class="difflineminus">-  };</span>
<a href="#l131.409"></a><span id="l131.409" class="difflineminus">-</span>
<a href="#l131.410"></a><span id="l131.410" class="difflineminus">-  let remoteLoader = new remoteLoaderModule.RemoteExperimentLoader(stubLogger, getFileFunc);</span>
<a href="#l131.411"></a><span id="l131.411" class="difflineminus">-  let data = &quot;Foo bar baz quux&quot;;</span>
<a href="#l131.412"></a><span id="l131.412" class="difflineminus">-  remoteLoader._cacheIndexFile(data);</span>
<a href="#l131.413"></a><span id="l131.413" class="difflineminus">-  cheapAssertEqual(remoteLoader._loadCachedIndexFile(), data);</span>
<a href="#l131.414"></a><span id="l131.414" class="difflineminus">-</span>
<a href="#l131.415"></a><span id="l131.415" class="difflineminus">-  // Clean up by killing the file so we don't break Test Pilot so bad</span>
<a href="#l131.416"></a><span id="l131.416" class="difflineminus">-  output(&quot;Killing the mungled index file.\n&quot;);</span>
<a href="#l131.417"></a><span id="l131.417" class="difflineminus">-  let indexFile = remoteLoader.cachedIndexNsiFile;</span>
<a href="#l131.418"></a><span id="l131.418" class="difflineminus">-  if (indexFile.exists()) {</span>
<a href="#l131.419"></a><span id="l131.419" class="difflineminus">-    indexFile.remove(false);</span>
<a href="#l131.420"></a><span id="l131.420" class="difflineminus">-  }</span>
<a href="#l131.421"></a><span id="l131.421" class="difflineminus">-}</span>
<a href="#l131.422"></a><span id="l131.422" class="difflineminus">-</span>
<a href="#l131.423"></a><span id="l131.423" class="difflineminus">-</span>
<a href="#l131.424"></a><span id="l131.424" class="difflineminus">-function StubDataStore(fileName, tableName, columns) {</span>
<a href="#l131.425"></a><span id="l131.425" class="difflineminus">-}</span>
<a href="#l131.426"></a><span id="l131.426" class="difflineminus">-StubDataStore.prototype = {</span>
<a href="#l131.427"></a><span id="l131.427" class="difflineminus">-  storeEvent: function(uiEvent, callback) {</span>
<a href="#l131.428"></a><span id="l131.428" class="difflineminus">-    callback(true);</span>
<a href="#l131.429"></a><span id="l131.429" class="difflineminus">-  },</span>
<a href="#l131.430"></a><span id="l131.430" class="difflineminus">-  getJSONRows: function(callback) {</span>
<a href="#l131.431"></a><span id="l131.431" class="difflineminus">-    callback([]);</span>
<a href="#l131.432"></a><span id="l131.432" class="difflineminus">-  },</span>
<a href="#l131.433"></a><span id="l131.433" class="difflineminus">-  getAllDataAsJSON: function(useDisplayValues, callback) {</span>
<a href="#l131.434"></a><span id="l131.434" class="difflineminus">-    callback([]);</span>
<a href="#l131.435"></a><span id="l131.435" class="difflineminus">-  },</span>
<a href="#l131.436"></a><span id="l131.436" class="difflineminus">-  wipeAllData: function(callback) {</span>
<a href="#l131.437"></a><span id="l131.437" class="difflineminus">-    callback(true);</span>
<a href="#l131.438"></a><span id="l131.438" class="difflineminus">-  },</span>
<a href="#l131.439"></a><span id="l131.439" class="difflineminus">-  nukeTable: function() {</span>
<a href="#l131.440"></a><span id="l131.440" class="difflineminus">-  },</span>
<a href="#l131.441"></a><span id="l131.441" class="difflineminus">-  haveData: function(callback) {</span>
<a href="#l131.442"></a><span id="l131.442" class="difflineminus">-    callback(true);</span>
<a href="#l131.443"></a><span id="l131.443" class="difflineminus">-  },</span>
<a href="#l131.444"></a><span id="l131.444" class="difflineminus">-  getHumanReadableColumnNames: function() {</span>
<a href="#l131.445"></a><span id="l131.445" class="difflineminus">-  },</span>
<a href="#l131.446"></a><span id="l131.446" class="difflineminus">-  getPropertyNames: function() {</span>
<a href="#l131.447"></a><span id="l131.447" class="difflineminus">-  }</span>
<a href="#l131.448"></a><span id="l131.448" class="difflineminus">-};</span>
<a href="#l131.449"></a><span id="l131.449" class="difflineminus">-</span>
<a href="#l131.450"></a><span id="l131.450" class="difflineminus">-function StubWebContent() {</span>
<a href="#l131.451"></a><span id="l131.451" class="difflineminus">-}</span>
<a href="#l131.452"></a><span id="l131.452" class="difflineminus">-StubWebContent.prototype = {</span>
<a href="#l131.453"></a><span id="l131.453" class="difflineminus">-  inProgressHtml: &quot;&quot;,</span>
<a href="#l131.454"></a><span id="l131.454" class="difflineminus">-  completedHtml: &quot;&quot;,</span>
<a href="#l131.455"></a><span id="l131.455" class="difflineminus">-  upcomingHtml: &quot;&quot;,</span>
<a href="#l131.456"></a><span id="l131.456" class="difflineminus">-  canceledHtml: &quot;&quot;,</span>
<a href="#l131.457"></a><span id="l131.457" class="difflineminus">-  remainDataHtml: &quot;&quot;,</span>
<a href="#l131.458"></a><span id="l131.458" class="difflineminus">-  dataExpiredHtml: &quot;&quot;,</span>
<a href="#l131.459"></a><span id="l131.459" class="difflineminus">-  deletedRemainDataHtml: &quot;&quot;,</span>
<a href="#l131.460"></a><span id="l131.460" class="difflineminus">-  inProgressDataPrivacyHtml: &quot;&quot;,</span>
<a href="#l131.461"></a><span id="l131.461" class="difflineminus">-  completedDataPrivacyHtml: &quot;&quot;,</span>
<a href="#l131.462"></a><span id="l131.462" class="difflineminus">-  canceledDataPrivacyHtml: &quot;&quot;,</span>
<a href="#l131.463"></a><span id="l131.463" class="difflineminus">-  dataExpiredDataPrivacyHtml: &quot;&quot;,</span>
<a href="#l131.464"></a><span id="l131.464" class="difflineminus">-  remainDataPrivacyHtml: &quot;&quot;,</span>
<a href="#l131.465"></a><span id="l131.465" class="difflineminus">-  deletedRemainDataPrivacyHtml: &quot;&quot;,</span>
<a href="#l131.466"></a><span id="l131.466" class="difflineminus">-  onPageLoad: function(experiment, document, graphUtils) {</span>
<a href="#l131.467"></a><span id="l131.467" class="difflineminus">-  }</span>
<a href="#l131.468"></a><span id="l131.468" class="difflineminus">-};</span>
<a href="#l131.469"></a><span id="l131.469" class="difflineminus">-</span>
<a href="#l131.470"></a><span id="l131.470" class="difflineminus">-function StubHandlers() {</span>
<a href="#l131.471"></a><span id="l131.471" class="difflineminus">-}</span>
<a href="#l131.472"></a><span id="l131.472" class="difflineminus">-StubHandlers.prototype = {</span>
<a href="#l131.473"></a><span id="l131.473" class="difflineminus">-  onNewWindow: function(window) {</span>
<a href="#l131.474"></a><span id="l131.474" class="difflineminus">-  },</span>
<a href="#l131.475"></a><span id="l131.475" class="difflineminus">-  onWindowClosed: function(window) {</span>
<a href="#l131.476"></a><span id="l131.476" class="difflineminus">-  },</span>
<a href="#l131.477"></a><span id="l131.477" class="difflineminus">-  onAppStartup: function() {</span>
<a href="#l131.478"></a><span id="l131.478" class="difflineminus">-  },</span>
<a href="#l131.479"></a><span id="l131.479" class="difflineminus">-  onAppShutdown: function() {</span>
<a href="#l131.480"></a><span id="l131.480" class="difflineminus">-  },</span>
<a href="#l131.481"></a><span id="l131.481" class="difflineminus">-  onExperimentStartup: function(store) {</span>
<a href="#l131.482"></a><span id="l131.482" class="difflineminus">-  },</span>
<a href="#l131.483"></a><span id="l131.483" class="difflineminus">-  onExperimentShutdown: function() {</span>
<a href="#l131.484"></a><span id="l131.484" class="difflineminus">-  },</span>
<a href="#l131.485"></a><span id="l131.485" class="difflineminus">-  onEnterPrivateBrowsing: function() {</span>
<a href="#l131.486"></a><span id="l131.486" class="difflineminus">-  },</span>
<a href="#l131.487"></a><span id="l131.487" class="difflineminus">-  onExitPrivateBrowsing: function() {</span>
<a href="#l131.488"></a><span id="l131.488" class="difflineminus">-  },</span>
<a href="#l131.489"></a><span id="l131.489" class="difflineminus">-  uninstallAll: function() {</span>
<a href="#l131.490"></a><span id="l131.490" class="difflineminus">-  }</span>
<a href="#l131.491"></a><span id="l131.491" class="difflineminus">-};</span>
<a href="#l131.492"></a><span id="l131.492" class="difflineminus">-</span>
<a href="#l131.493"></a><span id="l131.493" class="difflineminus">-function testRecurringStudyStateChange() {</span>
<a href="#l131.494"></a><span id="l131.494" class="difflineminus">-</span>
<a href="#l131.495"></a><span id="l131.495" class="difflineminus">-  Cu.import(&quot;resource://testpilot/modules/tasks.js&quot;);</span>
<a href="#l131.496"></a><span id="l131.496" class="difflineminus">-</span>
<a href="#l131.497"></a><span id="l131.497" class="difflineminus">-  let expInfo = {</span>
<a href="#l131.498"></a><span id="l131.498" class="difflineminus">-    startDate: null,</span>
<a href="#l131.499"></a><span id="l131.499" class="difflineminus">-    duration: 7,</span>
<a href="#l131.500"></a><span id="l131.500" class="difflineminus">-    testName: &quot;Unit Test Recurring Study&quot;,</span>
<a href="#l131.501"></a><span id="l131.501" class="difflineminus">-    testId: &quot;unit_test_recur_study&quot;,</span>
<a href="#l131.502"></a><span id="l131.502" class="difflineminus">-    testInfoUrl: &quot;https://testpilot.mozillalabs.com/&quot;,</span>
<a href="#l131.503"></a><span id="l131.503" class="difflineminus">-    summary: &quot;Be sure to wipe all prefs and the store in the setup/teardown&quot;,</span>
<a href="#l131.504"></a><span id="l131.504" class="difflineminus">-    thumbnail: &quot;&quot;,</span>
<a href="#l131.505"></a><span id="l131.505" class="difflineminus">-    optInRequired: false,</span>
<a href="#l131.506"></a><span id="l131.506" class="difflineminus">-    recursAutomatically: true,</span>
<a href="#l131.507"></a><span id="l131.507" class="difflineminus">-    recurrenceInterval: 30,</span>
<a href="#l131.508"></a><span id="l131.508" class="difflineminus">-    versionNumber: 1</span>
<a href="#l131.509"></a><span id="l131.509" class="difflineminus">-  };</span>
<a href="#l131.510"></a><span id="l131.510" class="difflineminus">-</span>
<a href="#l131.511"></a><span id="l131.511" class="difflineminus">-  clearAllPrefsForStudy(&quot;unit_test_recur_study&quot;);</span>
<a href="#l131.512"></a><span id="l131.512" class="difflineminus">-</span>
<a href="#l131.513"></a><span id="l131.513" class="difflineminus">-  const START_DATE = 1292629441000;</span>
<a href="#l131.514"></a><span id="l131.514" class="difflineminus">-  let stubDate = START_DATE;</span>
<a href="#l131.515"></a><span id="l131.515" class="difflineminus">-</span>
<a href="#l131.516"></a><span id="l131.516" class="difflineminus">-  let stubDateFunction = function() {</span>
<a href="#l131.517"></a><span id="l131.517" class="difflineminus">-    return stubDate;</span>
<a href="#l131.518"></a><span id="l131.518" class="difflineminus">-  };</span>
<a href="#l131.519"></a><span id="l131.519" class="difflineminus">-</span>
<a href="#l131.520"></a><span id="l131.520" class="difflineminus">-  let advanceDate = function(days) {</span>
<a href="#l131.521"></a><span id="l131.521" class="difflineminus">-    stubDate += days * 24 * 60 * 60 * 1000;</span>
<a href="#l131.522"></a><span id="l131.522" class="difflineminus">-  };</span>
<a href="#l131.523"></a><span id="l131.523" class="difflineminus">-</span>
<a href="#l131.524"></a><span id="l131.524" class="difflineminus">-  let dataStore = new StubDataStore();</span>
<a href="#l131.525"></a><span id="l131.525" class="difflineminus">-  let handlers = new StubHandlers();</span>
<a href="#l131.526"></a><span id="l131.526" class="difflineminus">-  let webContent = new StubWebContent();</span>
<a href="#l131.527"></a><span id="l131.527" class="difflineminus">-  let task = new TestPilotExperiment(expInfo, dataStore, handlers, webContent,</span>
<a href="#l131.528"></a><span id="l131.528" class="difflineminus">-                                    stubDateFunction);</span>
<a href="#l131.529"></a><span id="l131.529" class="difflineminus">-</span>
<a href="#l131.530"></a><span id="l131.530" class="difflineminus">-  // for this test, show popup on new study is set to true...</span>
<a href="#l131.531"></a><span id="l131.531" class="difflineminus">-  prefService.setBoolPref(&quot;extensions.testpilot.popup.showOnNewStudy&quot;, true);</span>
<a href="#l131.532"></a><span id="l131.532" class="difflineminus">-  // TODO another test with this turned off.</span>
<a href="#l131.533"></a><span id="l131.533" class="difflineminus">-</span>
<a href="#l131.534"></a><span id="l131.534" class="difflineminus">-  cheapAssertEqual(task.id, &quot;unit_test_recur_study&quot;, &quot;id should be id&quot;);</span>
<a href="#l131.535"></a><span id="l131.535" class="difflineminus">-  cheapAssertEqual(task.version, 1, &quot;version should be version&quot;);</span>
<a href="#l131.536"></a><span id="l131.536" class="difflineminus">-  cheapAssertEqual(task.title, &quot;Unit Test Recurring Study&quot;, &quot;title should be title&quot;);</span>
<a href="#l131.537"></a><span id="l131.537" class="difflineminus">-  cheapAssertEqual(task.taskType, TaskConstants.TYPE_EXPERIMENT, &quot;Should be experiment&quot;);</span>
<a href="#l131.538"></a><span id="l131.538" class="difflineminus">-  // Ensure that end date is 7 days past the start date</span>
<a href="#l131.539"></a><span id="l131.539" class="difflineminus">-  cheapAssertEqual(task.startDate, START_DATE, &quot;Start date is wrong&quot;);</span>
<a href="#l131.540"></a><span id="l131.540" class="difflineminus">-  cheapAssertEqual(task.endDate, START_DATE + 7 * 24 * 60 * 60 * 1000, &quot;End date is wrong&quot;);</span>
<a href="#l131.541"></a><span id="l131.541" class="difflineminus">-</span>
<a href="#l131.542"></a><span id="l131.542" class="difflineminus">-  cheapAssertEqual(task.status, TaskConstants.STATUS_NEW, &quot;Status should be new&quot;);</span>
<a href="#l131.543"></a><span id="l131.543" class="difflineminus">-  // advance time a little and check date... b/c showOnNewStudy is true, it won't start:</span>
<a href="#l131.544"></a><span id="l131.544" class="difflineminus">-  advanceDate(1);</span>
<a href="#l131.545"></a><span id="l131.545" class="difflineminus">-  task.checkDate();</span>
<a href="#l131.546"></a><span id="l131.546" class="difflineminus">-  cheapAssertEqual(task.status, TaskConstants.STATUS_NEW, &quot;Status should still be new&quot;);</span>
<a href="#l131.547"></a><span id="l131.547" class="difflineminus">-  // Now we fake the user action needed to advance it from NEW to STARTING:</span>
<a href="#l131.548"></a><span id="l131.548" class="difflineminus">-  task.changeStatus(TaskConstants.STATUS_STARTING);</span>
<a href="#l131.549"></a><span id="l131.549" class="difflineminus">-  cheapAssertEqual(task.status, TaskConstants.STATUS_STARTING, &quot;Status should now be starting&quot;);</span>
<a href="#l131.550"></a><span id="l131.550" class="difflineminus">-  // when we check date again, it should advance from starting to in-progress:</span>
<a href="#l131.551"></a><span id="l131.551" class="difflineminus">-  task.checkDate();</span>
<a href="#l131.552"></a><span id="l131.552" class="difflineminus">-  cheapAssertEqual(task.status, TaskConstants.STATUS_IN_PROGRESS, &quot;Status should be in progress&quot;);</span>
<a href="#l131.553"></a><span id="l131.553" class="difflineminus">-</span>
<a href="#l131.554"></a><span id="l131.554" class="difflineminus">-  // Go 7 days into the future</span>
<a href="#l131.555"></a><span id="l131.555" class="difflineminus">-  advanceDate(7);</span>
<a href="#l131.556"></a><span id="l131.556" class="difflineminus">-  task.checkDate();</span>
<a href="#l131.557"></a><span id="l131.557" class="difflineminus">-  cheapAssertEqual(task.status, TaskConstants.STATUS_FINISHED, &quot;Status should be finished&quot;);</span>
<a href="#l131.558"></a><span id="l131.558" class="difflineminus">-</span>
<a href="#l131.559"></a><span id="l131.559" class="difflineminus">-  /* So how is the buggy bug happening?  It seems like:</span>
<a href="#l131.560"></a><span id="l131.560" class="difflineminus">-   *</span>
<a href="#l131.561"></a><span id="l131.561" class="difflineminus">-   * - Data is posted successfully</span>
<a href="#l131.562"></a><span id="l131.562" class="difflineminus">-   * - Task status set to 6</span>
<a href="#l131.563"></a><span id="l131.563" class="difflineminus">-   * - (Reschedule is happening somewhere silently in here, which is screwing things</span>
<a href="#l131.564"></a><span id="l131.564" class="difflineminus">-   *    up maybe?)</span>
<a href="#l131.565"></a><span id="l131.565" class="difflineminus">-   * - Reload everything</span>
<a href="#l131.566"></a><span id="l131.566" class="difflineminus">-   * - It's past its end date, so the task status gets switched to Finished.</span>
<a href="#l131.567"></a><span id="l131.567" class="difflineminus">-   */</span>
<a href="#l131.568"></a><span id="l131.568" class="difflineminus">-</span>
<a href="#l131.569"></a><span id="l131.569" class="difflineminus">-  // TODO ideally figure out how to fake an upload - until then, just set status to 6.</span>
<a href="#l131.570"></a><span id="l131.570" class="difflineminus">-  task.changeStatus(TaskConstants.STATUS_SUBMITTED);</span>
<a href="#l131.571"></a><span id="l131.571" class="difflineminus">-  cheapAssertEqual(task.status, TaskConstants.STATUS_SUBMITTED, &quot;Should be submitted.&quot;);</span>
<a href="#l131.572"></a><span id="l131.572" class="difflineminus">-</span>
<a href="#l131.573"></a><span id="l131.573" class="difflineminus">-  // Delete and recreate task, make sure it recovers its status and start/end</span>
<a href="#l131.574"></a><span id="l131.574" class="difflineminus">-  // dates correctly</span>
<a href="#l131.575"></a><span id="l131.575" class="difflineminus">-  task = null;</span>
<a href="#l131.576"></a><span id="l131.576" class="difflineminus">-  let task2 = new TestPilotExperiment(expInfo, dataStore, handlers, webContent,</span>
<a href="#l131.577"></a><span id="l131.577" class="difflineminus">-                                      stubDateFunction);</span>
<a href="#l131.578"></a><span id="l131.578" class="difflineminus">-  cheapAssertEqual(task2.status, TaskConstants.STATUS_SUBMITTED, &quot;Status should be submitted!&quot;);</span>
<a href="#l131.579"></a><span id="l131.579" class="difflineminus">-  // It should remain submitted; it should have rescheduled itself to 30 days ahead.</span>
<a href="#l131.580"></a><span id="l131.580" class="difflineminus">-  cheapAssertEqual(task2.startDate, START_DATE + 30 * 24 * 60 * 60 * 1000,</span>
<a href="#l131.581"></a><span id="l131.581" class="difflineminus">-                   &quot;Start date is wrong&quot;);</span>
<a href="#l131.582"></a><span id="l131.582" class="difflineminus">-  cheapAssertEqual(task2.endDate, START_DATE + 37 * 24 * 60 * 60 * 1000,</span>
<a href="#l131.583"></a><span id="l131.583" class="difflineminus">-                   &quot;End date is wrong&quot;);</span>
<a href="#l131.584"></a><span id="l131.584" class="difflineminus">-</span>
<a href="#l131.585"></a><span id="l131.585" class="difflineminus">-</span>
<a href="#l131.586"></a><span id="l131.586" class="difflineminus">-</span>
<a href="#l131.587"></a><span id="l131.587" class="difflineminus">-  // test task._reschedule()?</span>
<a href="#l131.588"></a><span id="l131.588" class="difflineminus">-  // basically test everything that can happen in checkDate:</span>
<a href="#l131.589"></a><span id="l131.589" class="difflineminus">-  /* - reset of automatically recurring test (with NEVER_SUBMIT on and with it off) when</span>
<a href="#l131.590"></a><span id="l131.590" class="difflineminus">-   *    we pass the (new) start date.</span>
<a href="#l131.591"></a><span id="l131.591" class="difflineminus">-  * - test that we jumped ahead to STARTING if optInRequired is false... and that</span>
<a href="#l131.592"></a><span id="l131.592" class="difflineminus">-  *    we don't jump ahead to starting if it's true!  And the popup.showOnNewStudy pref</span>
<a href="#l131.593"></a><span id="l131.593" class="difflineminus">-  *    should have the same effect!!</span>
<a href="#l131.594"></a><span id="l131.594" class="difflineminus">-  *</span>
<a href="#l131.595"></a><span id="l131.595" class="difflineminus">-  * - When a test finishes (status is less than finished and current date passes end date)</span>
<a href="#l131.596"></a><span id="l131.596" class="difflineminus">-  *     then it should switch to finish.  If it recurs automatically, it should then</span>
<a href="#l131.597"></a><span id="l131.597" class="difflineminus">-  *     reschedule; if study-specific recur pref is ALWAYS_SUBMIT (OR if global</span>
<a href="#l131.598"></a><span id="l131.598" class="difflineminus">-  *      extensions.testpilot.alwaysSubmitData is true) it should then submit, but if it's</span>
<a href="#l131.599"></a><span id="l131.599" class="difflineminus">-  *      NEVER_SUBMIT it should then cancel and wipe data.  If none of these are true</span>
<a href="#l131.600"></a><span id="l131.600" class="difflineminus">-  *      it should just reschedule but remain on status = finished.</span>
<a href="#l131.601"></a><span id="l131.601" class="difflineminus">-  *</span>
<a href="#l131.602"></a><span id="l131.602" class="difflineminus">-  *    If it ends and doesn't recur automatically, then it should autosubmit if</span>
<a href="#l131.603"></a><span id="l131.603" class="difflineminus">-  *      extensions.testpilot.alwaysSubmitData is true.</span>
<a href="#l131.604"></a><span id="l131.604" class="difflineminus">-  *</span>
<a href="#l131.605"></a><span id="l131.605" class="difflineminus">-  *    At this point, a data deletion date and an expiration date for data submission</span>
<a href="#l131.606"></a><span id="l131.606" class="difflineminus">-  *     should be set (unless dat was already wiped as a result of NEVER_SUBMIT).</span>
<a href="#l131.607"></a><span id="l131.607" class="difflineminus">-  *</span>
<a href="#l131.608"></a><span id="l131.608" class="difflineminus">-  *</span>
<a href="#l131.609"></a><span id="l131.609" class="difflineminus">-  * - Data expiration (this clause looks maybe wrong in the code - why is there another</span>
<a href="#l131.610"></a><span id="l131.610" class="difflineminus">-  *                        autosubmit command here?)</span>
<a href="#l131.611"></a><span id="l131.611" class="difflineminus">-  *     If study is finished but not submitted and we pass expiration date for data</span>
<a href="#l131.612"></a><span id="l131.612" class="difflineminus">-  *      submission, cancel and wipe data.  (Expired should really be a status code!!)</span>
<a href="#l131.613"></a><span id="l131.613" class="difflineminus">-  *    If study is submitted and we pass the date for data deletion, then wipe the data.</span>
<a href="#l131.614"></a><span id="l131.614" class="difflineminus">-  *</span>
<a href="#l131.615"></a><span id="l131.615" class="difflineminus">-  * */</span>
<a href="#l131.616"></a><span id="l131.616" class="difflineminus">-  // Trying to upload when status is already submitted or greater should be a no-op.</span>
<a href="#l131.617"></a><span id="l131.617" class="difflineminus">-  // Successful submit should advance us to SUBMITTED and generate/store a time for</span>
<a href="#l131.618"></a><span id="l131.618" class="difflineminus">-  // data deletion.</span>
<a href="#l131.619"></a><span id="l131.619" class="difflineminus">-</span>
<a href="#l131.620"></a><span id="l131.620" class="difflineminus">-  /* getWebContent and getDataPrivacyContent should give us back the right strings</span>
<a href="#l131.621"></a><span id="l131.621" class="difflineminus">-   * based on all the state. */</span>
<a href="#l131.622"></a><span id="l131.622" class="difflineminus">-</span>
<a href="#l131.623"></a><span id="l131.623" class="difflineminus">-}</span>
<a href="#l131.624"></a><span id="l131.624" class="difflineminus">-</span>
<a href="#l131.625"></a><span id="l131.625" class="difflineminus">-</span>
<a href="#l131.626"></a><span id="l131.626" class="difflineminus">-//exports.runAllTests = runAllTests;</span>
<a href="#l131.627"></a><span id="l131.627" class="difflineminus">-</span>
<a href="#l131.628"></a><span id="l131.628" class="difflineminus">-</span>
<a href="#l131.629"></a><span id="l131.629" class="difflineminus">-// Test that observers get installed on any windows that are already open.</span>
<a href="#l131.630"></a><span id="l131.630" class="difflineminus">-</span>
<a href="#l131.631"></a><span id="l131.631" class="difflineminus">-// Test that every observer that is installed gets uninstalled.</span>
<a href="#l131.632"></a><span id="l131.632" class="difflineminus">-</span>
<a href="#l131.633"></a><span id="l131.633" class="difflineminus">-// Test that the observer is writing to the data store correctly.</span>
<a href="#l131.634"></a><span id="l131.634" class="difflineminus">-</span>
<a href="#l131.635"></a><span id="l131.635" class="difflineminus">-function testKillSwitch() {</span>
<a href="#l131.636"></a><span id="l131.636" class="difflineminus">-  var Cuddlefish = {};</span>
<a href="#l131.637"></a><span id="l131.637" class="difflineminus">-  Cu.import(&quot;resource://testpilot/modules/lib/cuddlefish.js&quot;,</span>
<a href="#l131.638"></a><span id="l131.638" class="difflineminus">-                          Cuddlefish);</span>
<a href="#l131.639"></a><span id="l131.639" class="difflineminus">-  let cfl = new Cuddlefish.Loader({rootPaths: [&quot;resource://testpilot/modules/&quot;,</span>
<a href="#l131.640"></a><span id="l131.640" class="difflineminus">-                                               &quot;resource://testpilot/modules/lib/&quot;]});</span>
<a href="#l131.641"></a><span id="l131.641" class="difflineminus">-  let remoteLoaderModule = cfl.require(&quot;remote-experiment-loader&quot;);</span>
<a href="#l131.642"></a><span id="l131.642" class="difflineminus">-</span>
<a href="#l131.643"></a><span id="l131.643" class="difflineminus">-  var indexJson1 = '{&quot;new_experiments&quot;: [{&quot;default&quot;: {&quot;name&quot;: &quot;Foo Study&quot;, '</span>
<a href="#l131.644"></a><span id="l131.644" class="difflineminus">-                    + '&quot;jarfile&quot;: &quot;foo.jar&quot;, &quot;studyfile&quot;: &quot;foo.js&quot;,'</span>
<a href="#l131.645"></a><span id="l131.645" class="difflineminus">-                    + '&quot;hash&quot;: &quot;19f32c805f93697e1b180a782bc7a8c7575f32138008d2617e9843a9bde14b38&quot;}}]}';</span>
<a href="#l131.646"></a><span id="l131.646" class="difflineminus">-</span>
<a href="#l131.647"></a><span id="l131.647" class="difflineminus">-  var indexJson2 = '{&quot;new_experiments&quot;: [], &quot;maintain_experiments&quot;: [&quot;foo.js&quot;]}';</span>
<a href="#l131.648"></a><span id="l131.648" class="difflineminus">-  var indexJson3 = '{&quot;new_experiments&quot;: []}';</span>
<a href="#l131.649"></a><span id="l131.649" class="difflineminus">-</span>
<a href="#l131.650"></a><span id="l131.650" class="difflineminus">-  var indexJson = indexJson1;</span>
<a href="#l131.651"></a><span id="l131.651" class="difflineminus">-</span>
<a href="#l131.652"></a><span id="l131.652" class="difflineminus">-  var theRemoteFile = &quot;exports.foo = function(x, y) { return x * y; }&quot;;</span>
<a href="#l131.653"></a><span id="l131.653" class="difflineminus">-</span>
<a href="#l131.654"></a><span id="l131.654" class="difflineminus">-  let getFileFunc = function(url, callback) {</span>
<a href="#l131.655"></a><span id="l131.655" class="difflineminus">-    if (url.indexOf(&quot;index.json&quot;) &gt; -1 || url.indexOf(&quot;index-dev.json&quot;) &gt; -1) {</span>
<a href="#l131.656"></a><span id="l131.656" class="difflineminus">-      if (indexJson != &quot;&quot;) {</span>
<a href="#l131.657"></a><span id="l131.657" class="difflineminus">-        callback(indexJson);</span>
<a href="#l131.658"></a><span id="l131.658" class="difflineminus">-      } else {</span>
<a href="#l131.659"></a><span id="l131.659" class="difflineminus">-        callback(null);</span>
<a href="#l131.660"></a><span id="l131.660" class="difflineminus">-      }</span>
<a href="#l131.661"></a><span id="l131.661" class="difflineminus">-    } else if (url.indexOf(&quot;foo.jar&quot;) &gt; -1) {</span>
<a href="#l131.662"></a><span id="l131.662" class="difflineminus">-      // Binary file (got this by base64encoding foo.jar):</span>
<a href="#l131.663"></a><span id="l131.663" class="difflineminus">-      callback(base64decode(</span>
<a href="#l131.664"></a><span id="l131.664" class="difflineminus">-        'UEsDBBQACAAIAFd2Pj4AAAAAAAAAAAAAAAAJAAQATUVUQS1JTkYv/soAAAMAUEsHCAAAAAACAAAAAAAA' +</span>
<a href="#l131.665"></a><span id="l131.665" class="difflineminus">-	'AFBLAwQUAAgACABXdj4+AAAAAAAAAAAAAAAAFAAAAE1FVEEtSU5GL01BTklGRVNULk1G803My0xLLS7R' +</span>
<a href="#l131.666"></a><span id="l131.666" class="difflineminus">-	'DUstKs7Mz7NSMNQz4OVyLkpNLElN0XWqBAmY6RnEGxkpaDgWFOSkKnjmJetp8nLxcgEAUEsHCPlAfs88' +</span>
<a href="#l131.667"></a><span id="l131.667" class="difflineminus">-	'AAAAPAAAAFBLAwQUAAgACAA1dj4+AAAAAAAAAAAAAAAABgAAAGZvby5qc0utKMgvKinWS8vPV7BVSCvN' +</span>
<a href="#l131.668"></a><span id="l131.668" class="difflineminus">-	'Sy7JzM/TqNBRqNRUqFYoSi0pLcpTqFDQUqi0Vqi1BgBQSwcIGwhXqzEAAAAvAAAAUEsBAhQAFAAIAAgA' +</span>
<a href="#l131.669"></a><span id="l131.669" class="difflineminus">-	'V3Y+PgAAAAACAAAAAAAAAAkABAAAAAAAAAAAAAAAAAAAAE1FVEEtSU5GL/7KAABQSwECFAAUAAgACABX' +</span>
<a href="#l131.670"></a><span id="l131.670" class="difflineminus">-	'dj4++UB+zzwAAAA8AAAAFAAAAAAAAAAAAAAAAAA9AAAATUVUQS1JTkYvTUFOSUZFU1QuTUZQSwECFAAU' +</span>
<a href="#l131.671"></a><span id="l131.671" class="difflineminus">-	'AAgACAA1dj4+GwhXqzEAAAAvAAAABgAAAAAAAAAAAAAAAAC7AAAAZm9vLmpzUEsFBgAAAAADAAMAsQAA' +</span>
<a href="#l131.672"></a><span id="l131.672" class="difflineminus">-	'ACABAAAAAA=='));</span>
<a href="#l131.673"></a><span id="l131.673" class="difflineminus">-    } else {</span>
<a href="#l131.674"></a><span id="l131.674" class="difflineminus">-      callback(null);</span>
<a href="#l131.675"></a><span id="l131.675" class="difflineminus">-    }</span>
<a href="#l131.676"></a><span id="l131.676" class="difflineminus">-  };</span>
<a href="#l131.677"></a><span id="l131.677" class="difflineminus">-</span>
<a href="#l131.678"></a><span id="l131.678" class="difflineminus">-  let remoteLoader = new remoteLoaderModule.RemoteExperimentLoader(stubLogger, getFileFunc);</span>
<a href="#l131.679"></a><span id="l131.679" class="difflineminus">-</span>
<a href="#l131.680"></a><span id="l131.680" class="difflineminus">-  function clearIndexFileCache() {</span>
<a href="#l131.681"></a><span id="l131.681" class="difflineminus">-    // TODO this needs to go in a teardown</span>
<a href="#l131.682"></a><span id="l131.682" class="difflineminus">-    output(&quot;Killing the mungled index file.\n&quot;);</span>
<a href="#l131.683"></a><span id="l131.683" class="difflineminus">-    let indexFile = remoteLoader.cachedIndexNsiFile;</span>
<a href="#l131.684"></a><span id="l131.684" class="difflineminus">-    if (indexFile.exists()) {</span>
<a href="#l131.685"></a><span id="l131.685" class="difflineminus">-      indexFile.remove(false);</span>
<a href="#l131.686"></a><span id="l131.686" class="difflineminus">-    }</span>
<a href="#l131.687"></a><span id="l131.687" class="difflineminus">-  }</span>
<a href="#l131.688"></a><span id="l131.688" class="difflineminus">-</span>
<a href="#l131.689"></a><span id="l131.689" class="difflineminus">-  output(&quot;Preparing To Test Kill Switch!!!\n&quot;);</span>
<a href="#l131.690"></a><span id="l131.690" class="difflineminus">-  remoteLoader.checkForUpdates(function(hasChanges) {</span>
<a href="#l131.691"></a><span id="l131.691" class="difflineminus">-    if (hasChanges) {</span>
<a href="#l131.692"></a><span id="l131.692" class="difflineminus">-      output(&quot;Testing that foo study is loaded.\n&quot;);</span>
<a href="#l131.693"></a><span id="l131.693" class="difflineminus">-      let exp = remoteLoader.getExperiments();</span>
<a href="#l131.694"></a><span id="l131.694" class="difflineminus">-      let count = 0;</span>
<a href="#l131.695"></a><span id="l131.695" class="difflineminus">-      for (let i in exp) {</span>
<a href="#l131.696"></a><span id="l131.696" class="difflineminus">-        count += 1;</span>
<a href="#l131.697"></a><span id="l131.697" class="difflineminus">-      }</span>
<a href="#l131.698"></a><span id="l131.698" class="difflineminus">-      cheapAssertEqual(count, 1, &quot;Supposed to find one file.&quot;);</span>
<a href="#l131.699"></a><span id="l131.699" class="difflineminus">-      let fooModule = exp[&quot;foo.js&quot;];</span>
<a href="#l131.700"></a><span id="l131.700" class="difflineminus">-      cheapAssertEqual(fooModule.foo(3, 4), 12, &quot;Supposed to load the foo module.\n&quot;);</span>
<a href="#l131.701"></a><span id="l131.701" class="difflineminus">-    } else {</span>
<a href="#l131.702"></a><span id="l131.702" class="difflineminus">-      cheapAssertFail(&quot;checkForUpdates is supposed to find changes.&quot;);</span>
<a href="#l131.703"></a><span id="l131.703" class="difflineminus">-    }</span>
<a href="#l131.704"></a><span id="l131.704" class="difflineminus">-</span>
<a href="#l131.705"></a><span id="l131.705" class="difflineminus">-    /* Now we change the index file and call checkForUpdates again... test that:</span>
<a href="#l131.706"></a><span id="l131.706" class="difflineminus">-     * a. with indexJson2, the Foo Study continues to run.</span>
<a href="#l131.707"></a><span id="l131.707" class="difflineminus">-     * b. with indexJson3, the Foo Study stops immediately.</span>
<a href="#l131.708"></a><span id="l131.708" class="difflineminus">-     * */</span>
<a href="#l131.709"></a><span id="l131.709" class="difflineminus">-    clearIndexFileCache();</span>
<a href="#l131.710"></a><span id="l131.710" class="difflineminus">-    indexJson = indexJson2;</span>
<a href="#l131.711"></a><span id="l131.711" class="difflineminus">-    output(&quot;Preparing to check for updates 2nd time.\n&quot;);</span>
<a href="#l131.712"></a><span id="l131.712" class="difflineminus">-    remoteLoader.checkForUpdates( function(hasChanges) {</span>
<a href="#l131.713"></a><span id="l131.713" class="difflineminus">-      output(&quot;in the callback for check for updates 2nd time.\n&quot;);</span>
<a href="#l131.714"></a><span id="l131.714" class="difflineminus">-      if (hasChanges) {</span>
<a href="#l131.715"></a><span id="l131.715" class="difflineminus">-        output(&quot;checkforUpdates 2nd time - has changes.\n&quot;);</span>
<a href="#l131.716"></a><span id="l131.716" class="difflineminus">-      } else {</span>
<a href="#l131.717"></a><span id="l131.717" class="difflineminus">-        output(&quot;checkforUpdates 2nd time - does not have changes.\n&quot;);</span>
<a href="#l131.718"></a><span id="l131.718" class="difflineminus">-      }</span>
<a href="#l131.719"></a><span id="l131.719" class="difflineminus">-</span>
<a href="#l131.720"></a><span id="l131.720" class="difflineminus">-      output(&quot;Testing that foo study is loaded. (2nd time)\n&quot;);</span>
<a href="#l131.721"></a><span id="l131.721" class="difflineminus">-      let exp = remoteLoader.getExperiments();</span>
<a href="#l131.722"></a><span id="l131.722" class="difflineminus">-      let count = 0;</span>
<a href="#l131.723"></a><span id="l131.723" class="difflineminus">-      for (let i in exp) {</span>
<a href="#l131.724"></a><span id="l131.724" class="difflineminus">-        count += 1;</span>
<a href="#l131.725"></a><span id="l131.725" class="difflineminus">-      }</span>
<a href="#l131.726"></a><span id="l131.726" class="difflineminus">-      cheapAssertEqual(count, 1, &quot;Supposed to find one file (2nd time).&quot;);</span>
<a href="#l131.727"></a><span id="l131.727" class="difflineminus">-      let fooModule = exp[&quot;foo.js&quot;];</span>
<a href="#l131.728"></a><span id="l131.728" class="difflineminus">-      cheapAssertEqual(fooModule.foo(3, 4), 12, &quot;Supposed to load the foo module (2).\n&quot;);</span>
<a href="#l131.729"></a><span id="l131.729" class="difflineminus">-</span>
<a href="#l131.730"></a><span id="l131.730" class="difflineminus">-</span>
<a href="#l131.731"></a><span id="l131.731" class="difflineminus">-      clearIndexFileCache();</span>
<a href="#l131.732"></a><span id="l131.732" class="difflineminus">-      indexJson = indexJson3;</span>
<a href="#l131.733"></a><span id="l131.733" class="difflineminus">-      remoteLoader.checkForUpdates( function(hasChanges) {</span>
<a href="#l131.734"></a><span id="l131.734" class="difflineminus">-        if (hasChanges) {</span>
<a href="#l131.735"></a><span id="l131.735" class="difflineminus">-          output(&quot;checkForUpdates 3rd time - has changes.\n&quot;);</span>
<a href="#l131.736"></a><span id="l131.736" class="difflineminus">-        } else {</span>
<a href="#l131.737"></a><span id="l131.737" class="difflineminus">-          output(&quot;checkForUpdates 3rd time - has no changes.\n&quot;);</span>
<a href="#l131.738"></a><span id="l131.738" class="difflineminus">-        }</span>
<a href="#l131.739"></a><span id="l131.739" class="difflineminus">-</span>
<a href="#l131.740"></a><span id="l131.740" class="difflineminus">-        output(&quot;Testing that foo study is NOT loaded. (3rd time)\n&quot;);</span>
<a href="#l131.741"></a><span id="l131.741" class="difflineminus">-        let exp = remoteLoader.getExperiments();</span>
<a href="#l131.742"></a><span id="l131.742" class="difflineminus">-        let count = 0;</span>
<a href="#l131.743"></a><span id="l131.743" class="difflineminus">-        for (let i in exp) {</span>
<a href="#l131.744"></a><span id="l131.744" class="difflineminus">-          count += 1;</span>
<a href="#l131.745"></a><span id="l131.745" class="difflineminus">-        }</span>
<a href="#l131.746"></a><span id="l131.746" class="difflineminus">-        cheapAssertEqual(count, 0, &quot;File should be killed!\n&quot;);</span>
<a href="#l131.747"></a><span id="l131.747" class="difflineminus">-</span>
<a href="#l131.748"></a><span id="l131.748" class="difflineminus">-        clearIndexFileCache();</span>
<a href="#l131.749"></a><span id="l131.749" class="difflineminus">-      });</span>
<a href="#l131.750"></a><span id="l131.750" class="difflineminus">-    });</span>
<a href="#l131.751"></a><span id="l131.751" class="difflineminus">-  });</span>
<a href="#l131.752"></a><span id="l131.752" class="difflineminus">-}</span>
<a href="#l131.753"></a><span id="l131.753" class="difflineminus">-</span>
<a href="#l131.754"></a><span id="l131.754" class="difflineminus">-// To test:  The random subsample deployment... deployment when fx version or test pilot version</span>
<a href="#l131.755"></a><span id="l131.755" class="difflineminus">-// is or is not sufficient for study... deployment with arbitrary runOrNot func returning true</span>
<a href="#l131.756"></a><span id="l131.756" class="difflineminus">-// or false.</span>
<a href="#l131.757"></a><span id="l131.757" class="difflineminus">-</span>
<a href="#l131.758"></a><span id="l131.758" class="difflineminus">-function testSameGUIDs() {</span>
<a href="#l131.759"></a><span id="l131.759" class="difflineminus">-</span>
<a href="#l131.760"></a><span id="l131.760" class="difflineminus">-  // make a study and survey that knows the study as 'related study'.</span>
<a href="#l131.761"></a><span id="l131.761" class="difflineminus">-</span>
<a href="#l131.762"></a><span id="l131.762" class="difflineminus">-  // start and submit study first, start and submit survey second: ensure that both have same</span>
<a href="#l131.763"></a><span id="l131.763" class="difflineminus">-  // submission GUID.</span>
<a href="#l131.764"></a><span id="l131.764" class="difflineminus">-  Cu.import(&quot;resource://testpilot/modules/tasks.js&quot;);</span>
<a href="#l131.765"></a><span id="l131.765" class="difflineminus">-</span>
<a href="#l131.766"></a><span id="l131.766" class="difflineminus">-  let expInfo = {</span>
<a href="#l131.767"></a><span id="l131.767" class="difflineminus">-    startDate: null,</span>
<a href="#l131.768"></a><span id="l131.768" class="difflineminus">-    duration: 7,</span>
<a href="#l131.769"></a><span id="l131.769" class="difflineminus">-    testName: &quot;Study w Survey n Guid&quot;,</span>
<a href="#l131.770"></a><span id="l131.770" class="difflineminus">-    testId: &quot;unit_test_guid_study&quot;,</span>
<a href="#l131.771"></a><span id="l131.771" class="difflineminus">-    testInfoUrl: &quot;https://testpilot.mozillalabs.com/&quot;,</span>
<a href="#l131.772"></a><span id="l131.772" class="difflineminus">-    summary: &quot;Be sure to wipe all prefs and the store in the setup/teardown&quot;,</span>
<a href="#l131.773"></a><span id="l131.773" class="difflineminus">-    thumbnail: &quot;&quot;,</span>
<a href="#l131.774"></a><span id="l131.774" class="difflineminus">-    optInRequired: false,</span>
<a href="#l131.775"></a><span id="l131.775" class="difflineminus">-    recursAutomatically: false,</span>
<a href="#l131.776"></a><span id="l131.776" class="difflineminus">-    recurrenceInterval: 0,</span>
<a href="#l131.777"></a><span id="l131.777" class="difflineminus">-    versionNumber: 1</span>
<a href="#l131.778"></a><span id="l131.778" class="difflineminus">-  };</span>
<a href="#l131.779"></a><span id="l131.779" class="difflineminus">-</span>
<a href="#l131.780"></a><span id="l131.780" class="difflineminus">-  let surveyInfo = { surveyId: &quot;unit_test_guid_survey&quot;,</span>
<a href="#l131.781"></a><span id="l131.781" class="difflineminus">-      surveyName: &quot;Survey with associated study&quot;,</span>
<a href="#l131.782"></a><span id="l131.782" class="difflineminus">-      surveyUrl: &quot;&quot;,</span>
<a href="#l131.783"></a><span id="l131.783" class="difflineminus">-      summary: &quot;&quot;,</span>
<a href="#l131.784"></a><span id="l131.784" class="difflineminus">-      thumbnail: &quot;&quot;,</span>
<a href="#l131.785"></a><span id="l131.785" class="difflineminus">-      uploadWithExperiment: expInfo.testId,</span>
<a href="#l131.786"></a><span id="l131.786" class="difflineminus">-      versionNumber: 1,</span>
<a href="#l131.787"></a><span id="l131.787" class="difflineminus">-      surveyQuestions: {},</span>
<a href="#l131.788"></a><span id="l131.788" class="difflineminus">-      surveyExplanation: &quot;&quot;</span>
<a href="#l131.789"></a><span id="l131.789" class="difflineminus">-  };</span>
<a href="#l131.790"></a><span id="l131.790" class="difflineminus">-</span>
<a href="#l131.791"></a><span id="l131.791" class="difflineminus">-  clearAllPrefsForStudy(&quot;unit_test_guid_study&quot;);</span>
<a href="#l131.792"></a><span id="l131.792" class="difflineminus">-  clearAllPrefsForStudy(&quot;unit_test_guid_survey&quot;);</span>
<a href="#l131.793"></a><span id="l131.793" class="difflineminus">-</span>
<a href="#l131.794"></a><span id="l131.794" class="difflineminus">-  let dataStore = new StubDataStore();</span>
<a href="#l131.795"></a><span id="l131.795" class="difflineminus">-  let handlers = new StubHandlers();</span>
<a href="#l131.796"></a><span id="l131.796" class="difflineminus">-  let webContent = new StubWebContent();</span>
<a href="#l131.797"></a><span id="l131.797" class="difflineminus">-  let experiment = new TestPilotExperiment(expInfo, dataStore, handlers, webContent);</span>
<a href="#l131.798"></a><span id="l131.798" class="difflineminus">-  let survey = new TestPilotBuiltinSurvey(surveyInfo);</span>
<a href="#l131.799"></a><span id="l131.799" class="difflineminus">-</span>
<a href="#l131.800"></a><span id="l131.800" class="difflineminus">-  // Start the study so it will generate a GUID</span>
<a href="#l131.801"></a><span id="l131.801" class="difflineminus">-  ensureExperimentIsRunning(experiment);</span>
<a href="#l131.802"></a><span id="l131.802" class="difflineminus">-</span>
<a href="#l131.803"></a><span id="l131.803" class="difflineminus">-  // Get GUIDs from study and from survey, compare:</span>
<a href="#l131.804"></a><span id="l131.804" class="difflineminus">-  experiment._prependMetadataToJSON(function(jsonString) {</span>
<a href="#l131.805"></a><span id="l131.805" class="difflineminus">-    let expGuid = JSON.parse(jsonString).metadata.task_guid;</span>
<a href="#l131.806"></a><span id="l131.806" class="difflineminus">-    survey._prependMetadataToJSON(function(jsonString) {</span>
<a href="#l131.807"></a><span id="l131.807" class="difflineminus">-      let surveyGuid = JSON.parse(jsonString).metadata.task_guid;</span>
<a href="#l131.808"></a><span id="l131.808" class="difflineminus">-      output(&quot;expGuid is &quot; + expGuid + &quot;, surveyGuid is &quot; + surveyGuid + &quot;\n&quot;);</span>
<a href="#l131.809"></a><span id="l131.809" class="difflineminus">-      cheapAssertEqual(expGuid, surveyGuid, &quot;guids should match&quot;);</span>
<a href="#l131.810"></a><span id="l131.810" class="difflineminus">-      cheapAssertEqual((expGuid != &quot;&quot;), true, &quot;guid should be non-empty&quot;);</span>
<a href="#l131.811"></a><span id="l131.811" class="difflineminus">-</span>
<a href="#l131.812"></a><span id="l131.812" class="difflineminus">-      // Clear everything for next part of test:</span>
<a href="#l131.813"></a><span id="l131.813" class="difflineminus">-      clearAllPrefsForStudy(&quot;unit_test_guid_study&quot;);</span>
<a href="#l131.814"></a><span id="l131.814" class="difflineminus">-      clearAllPrefsForStudy(&quot;unit_test_guid_survey&quot;);</span>
<a href="#l131.815"></a><span id="l131.815" class="difflineminus">-</span>
<a href="#l131.816"></a><span id="l131.816" class="difflineminus">-      let experiment2 = new TestPilotExperiment(expInfo, dataStore, handlers, webContent);</span>
<a href="#l131.817"></a><span id="l131.817" class="difflineminus">-      let survey2 = new TestPilotBuiltinSurvey(surveyInfo);</span>
<a href="#l131.818"></a><span id="l131.818" class="difflineminus">-</span>
<a href="#l131.819"></a><span id="l131.819" class="difflineminus">-      // this time we query the survey for the GUID first, without starting the study:</span>
<a href="#l131.820"></a><span id="l131.820" class="difflineminus">-      survey2._prependMetadataToJSON(function(jsonString) {</span>
<a href="#l131.821"></a><span id="l131.821" class="difflineminus">-        let survey2Guid = JSON.parse(jsonString).metadata.task_guid;</span>
<a href="#l131.822"></a><span id="l131.822" class="difflineminus">-        // after that, start the study:</span>
<a href="#l131.823"></a><span id="l131.823" class="difflineminus">-        experiment2.changeStatus(TaskConstants.STATUS_STARTING, true);</span>
<a href="#l131.824"></a><span id="l131.824" class="difflineminus">-        experiment2.checkDate();</span>
<a href="#l131.825"></a><span id="l131.825" class="difflineminus">-        // experiment and survey should have same GUID again:</span>
<a href="#l131.826"></a><span id="l131.826" class="difflineminus">-        experiment2._prependMetadataToJSON(function(jsonString) {</span>
<a href="#l131.827"></a><span id="l131.827" class="difflineminus">-          let exp2Guid = JSON.parse(jsonString).metadata.task_guid;</span>
<a href="#l131.828"></a><span id="l131.828" class="difflineminus">-          output(&quot;exp2Guid is &quot; + exp2Guid + &quot;, survey2Guid is &quot; + survey2Guid + &quot;\n&quot;);</span>
<a href="#l131.829"></a><span id="l131.829" class="difflineminus">-          cheapAssertEqual(exp2Guid, survey2Guid, &quot;guids should match&quot;);</span>
<a href="#l131.830"></a><span id="l131.830" class="difflineminus">-          cheapAssertNotEqual(exp2Guid, &quot;&quot;, &quot;guid should be non-empty&quot;);</span>
<a href="#l131.831"></a><span id="l131.831" class="difflineminus">-        });</span>
<a href="#l131.832"></a><span id="l131.832" class="difflineminus">-      });</span>
<a href="#l131.833"></a><span id="l131.833" class="difflineminus">-    });</span>
<a href="#l131.834"></a><span id="l131.834" class="difflineminus">-  });</span>
<a href="#l131.835"></a><span id="l131.835" class="difflineminus">-}</span>
<a href="#l131.836"></a><span id="l131.836" class="difflineminus">-</span>
<a href="#l131.837"></a><span id="l131.837" class="difflineminus">-// TODO test for continuity of GUID with recurring study (longitudinal) - i don't think this</span>
<a href="#l131.838"></a><span id="l131.838" class="difflineminus">-// has actually been working so far because a new GUID is generted every time the study starts up...</span>
<a href="#l131.839"></a><span id="l131.839" class="difflineminus">-</span>
<a href="#l131.840"></a><span id="l131.840" class="difflineminus">-function testExceptionLogging() {</span>
<a href="#l131.841"></a><span id="l131.841" class="difflineminus">-</span>
<a href="#l131.842"></a><span id="l131.842" class="difflineminus">-  Cu.import(&quot;resource://testpilot/modules/experiment_data_store.js&quot;);</span>
<a href="#l131.843"></a><span id="l131.843" class="difflineminus">-  Cu.import(&quot;resource://testpilot/modules/tasks.js&quot;);</span>
<a href="#l131.844"></a><span id="l131.844" class="difflineminus">-</span>
<a href="#l131.845"></a><span id="l131.845" class="difflineminus">-  var columns =  [{property: &quot;prop_a&quot;, type: TYPE_INT_32, displayName: &quot;Length&quot;} ];</span>
<a href="#l131.846"></a><span id="l131.846" class="difflineminus">-</span>
<a href="#l131.847"></a><span id="l131.847" class="difflineminus">-  var fileName = &quot;testpilot_exception_unit_test.sqlite&quot;;</span>
<a href="#l131.848"></a><span id="l131.848" class="difflineminus">-  var tableName = &quot;testpilot_exception_unit_test&quot;;</span>
<a href="#l131.849"></a><span id="l131.849" class="difflineminus">-  clearDbFile(fileName);</span>
<a href="#l131.850"></a><span id="l131.850" class="difflineminus">-  clearAllPrefsForStudy(&quot;unit_test_exception_study&quot;);</span>
<a href="#l131.851"></a><span id="l131.851" class="difflineminus">-  var store = new ExperimentDataStore(fileName, tableName, columns);</span>
<a href="#l131.852"></a><span id="l131.852" class="difflineminus">-</span>
<a href="#l131.853"></a><span id="l131.853" class="difflineminus">-  let buggyHandlers = {</span>
<a href="#l131.854"></a><span id="l131.854" class="difflineminus">-    onNewWindow: function(window) {</span>
<a href="#l131.855"></a><span id="l131.855" class="difflineminus">-      throw (new Error(&quot;new window FAIL&quot;));</span>
<a href="#l131.856"></a><span id="l131.856" class="difflineminus">-    },</span>
<a href="#l131.857"></a><span id="l131.857" class="difflineminus">-    onWindowClosed: function(window) {</span>
<a href="#l131.858"></a><span id="l131.858" class="difflineminus">-      throw (new Error(&quot;close window FAIL&quot;));</span>
<a href="#l131.859"></a><span id="l131.859" class="difflineminus">-    },</span>
<a href="#l131.860"></a><span id="l131.860" class="difflineminus">-    onAppStartup: function() {</span>
<a href="#l131.861"></a><span id="l131.861" class="difflineminus">-      throw (new Error(&quot;app startup FAIL&quot;));</span>
<a href="#l131.862"></a><span id="l131.862" class="difflineminus">-    },</span>
<a href="#l131.863"></a><span id="l131.863" class="difflineminus">-    onAppShutdown: function() {</span>
<a href="#l131.864"></a><span id="l131.864" class="difflineminus">-      throw (new Error(&quot;app shutdown FAIL&quot;));</span>
<a href="#l131.865"></a><span id="l131.865" class="difflineminus">-    },</span>
<a href="#l131.866"></a><span id="l131.866" class="difflineminus">-    onExperimentStartup: function() {</span>
<a href="#l131.867"></a><span id="l131.867" class="difflineminus">-      throw (new Error(&quot;experiment startup FAIL&quot;));</span>
<a href="#l131.868"></a><span id="l131.868" class="difflineminus">-    },</span>
<a href="#l131.869"></a><span id="l131.869" class="difflineminus">-    onExperimentShutdown: function() {</span>
<a href="#l131.870"></a><span id="l131.870" class="difflineminus">-      throw (new Error(&quot;experiment shutdown FAIL&quot;));</span>
<a href="#l131.871"></a><span id="l131.871" class="difflineminus">-    },</span>
<a href="#l131.872"></a><span id="l131.872" class="difflineminus">-    doExperimentCleanup: function() {</span>
<a href="#l131.873"></a><span id="l131.873" class="difflineminus">-      throw (new Error(&quot;experiment cleanup FAIL&quot;));</span>
<a href="#l131.874"></a><span id="l131.874" class="difflineminus">-    },</span>
<a href="#l131.875"></a><span id="l131.875" class="difflineminus">-    onEnterPrivateBrowsing: function() {</span>
<a href="#l131.876"></a><span id="l131.876" class="difflineminus">-      throw (new Error(&quot;enter private browsing FAIL&quot;));</span>
<a href="#l131.877"></a><span id="l131.877" class="difflineminus">-    },</span>
<a href="#l131.878"></a><span id="l131.878" class="difflineminus">-    onExitPrivateBrowsing: function() {</span>
<a href="#l131.879"></a><span id="l131.879" class="difflineminus">-      throw (new Error(&quot;exit private browsing FAIL&quot;));</span>
<a href="#l131.880"></a><span id="l131.880" class="difflineminus">-    }</span>
<a href="#l131.881"></a><span id="l131.881" class="difflineminus">-  };</span>
<a href="#l131.882"></a><span id="l131.882" class="difflineminus">-</span>
<a href="#l131.883"></a><span id="l131.883" class="difflineminus">-  let expInfo = {</span>
<a href="#l131.884"></a><span id="l131.884" class="difflineminus">-    startDate: null,</span>
<a href="#l131.885"></a><span id="l131.885" class="difflineminus">-    duration: 7,</span>
<a href="#l131.886"></a><span id="l131.886" class="difflineminus">-    testName: &quot;Unit Test Exception Reporting&quot;,</span>
<a href="#l131.887"></a><span id="l131.887" class="difflineminus">-    testId: &quot;unit_test_exception_study&quot;,</span>
<a href="#l131.888"></a><span id="l131.888" class="difflineminus">-    testInfoUrl: &quot;https://testpilot.mozillalabs.com/&quot;,</span>
<a href="#l131.889"></a><span id="l131.889" class="difflineminus">-    summary: &quot;Be sure to wipe all prefs and the store in the setup/teardown&quot;,</span>
<a href="#l131.890"></a><span id="l131.890" class="difflineminus">-    thumbnail: &quot;&quot;,</span>
<a href="#l131.891"></a><span id="l131.891" class="difflineminus">-    optInRequired: false,</span>
<a href="#l131.892"></a><span id="l131.892" class="difflineminus">-    recursAutomatically: false,</span>
<a href="#l131.893"></a><span id="l131.893" class="difflineminus">-    recurrenceInterval: 30,</span>
<a href="#l131.894"></a><span id="l131.894" class="difflineminus">-    versionNumber: 1</span>
<a href="#l131.895"></a><span id="l131.895" class="difflineminus">-  };</span>
<a href="#l131.896"></a><span id="l131.896" class="difflineminus">-</span>
<a href="#l131.897"></a><span id="l131.897" class="difflineminus">-  let webContent = new StubWebContent();</span>
<a href="#l131.898"></a><span id="l131.898" class="difflineminus">-  let experiment = new TestPilotExperiment(expInfo, store, buggyHandlers, webContent);</span>
<a href="#l131.899"></a><span id="l131.899" class="difflineminus">-  ensureExperimentIsRunning(experiment);</span>
<a href="#l131.900"></a><span id="l131.900" class="difflineminus">-</span>
<a href="#l131.901"></a><span id="l131.901" class="difflineminus">-  // Wait for the wipeAllData and the onExperimentStartup to finish</span>
<a href="#l131.902"></a><span id="l131.902" class="difflineminus">-  waitABit(4, function() {</span>
<a href="#l131.903"></a><span id="l131.903" class="difflineminus">-  experiment.onNewWindow();</span>
<a href="#l131.904"></a><span id="l131.904" class="difflineminus">-  experiment.onWindowClosed();</span>
<a href="#l131.905"></a><span id="l131.905" class="difflineminus">-  experiment.onAppStartup();</span>
<a href="#l131.906"></a><span id="l131.906" class="difflineminus">-  experiment.onAppShutdown();</span>
<a href="#l131.907"></a><span id="l131.907" class="difflineminus">-  experiment.onExperimentShutdown();</span>
<a href="#l131.908"></a><span id="l131.908" class="difflineminus">-  experiment.doExperimentCleanup();</span>
<a href="#l131.909"></a><span id="l131.909" class="difflineminus">-  experiment.onEnterPrivateBrowsing();</span>
<a href="#l131.910"></a><span id="l131.910" class="difflineminus">-  experiment.onExitPrivateBrowsing();</span>
<a href="#l131.911"></a><span id="l131.911" class="difflineminus">-</span>
<a href="#l131.912"></a><span id="l131.912" class="difflineminus">-  // TODO weird problem:</span>
<a href="#l131.913"></a><span id="l131.913" class="difflineminus">-  //  If you try to re-run tests, logException fails with a disk I/O error the 2nd time!!</span>
<a href="#l131.914"></a><span id="l131.914" class="difflineminus">-</span>
<a href="#l131.915"></a><span id="l131.915" class="difflineminus">-  // Pause here for 4 secs to give the database writes a chance to finish.</span>
<a href="#l131.916"></a><span id="l131.916" class="difflineminus">-  waitABit(4, function() {</span>
<a href="#l131.917"></a><span id="l131.917" class="difflineminus">-    experiment._prependMetadataToJSON(function(jsonString) {</span>
<a href="#l131.918"></a><span id="l131.918" class="difflineminus">-      let exceptions = JSON.parse(jsonString).exceptions;</span>
<a href="#l131.919"></a><span id="l131.919" class="difflineminus">-      cheapAssertEqual(exceptions.length, 9, &quot;Should have 9 exceptions&quot;);</span>
<a href="#l131.920"></a><span id="l131.920" class="difflineminus">-      cheapAssertStringContains(exceptions[0].exception, &quot;experiment startup FAIL&quot;, &quot;should have failed&quot;);</span>
<a href="#l131.921"></a><span id="l131.921" class="difflineminus">-      cheapAssertStringContains(exceptions[1].exception, &quot;new window FAIL&quot;, &quot;should have failed&quot;);</span>
<a href="#l131.922"></a><span id="l131.922" class="difflineminus">-      cheapAssertStringContains(exceptions[2].exception, &quot;close window FAIL&quot;, &quot;should have failed&quot;);</span>
<a href="#l131.923"></a><span id="l131.923" class="difflineminus">-      cheapAssertStringContains(exceptions[3].exception, &quot;app startup FAIL&quot;, &quot;should have failed&quot;);</span>
<a href="#l131.924"></a><span id="l131.924" class="difflineminus">-      cheapAssertStringContains(exceptions[4].exception, &quot;app shutdown FAIL&quot;, &quot;should have failed&quot;);</span>
<a href="#l131.925"></a><span id="l131.925" class="difflineminus">-      cheapAssertStringContains(exceptions[5].exception, &quot;experiment shutdown FAIL&quot;, &quot;should have failed&quot;);</span>
<a href="#l131.926"></a><span id="l131.926" class="difflineminus">-      cheapAssertStringContains(exceptions[6].exception, &quot;experiment cleanup FAIL&quot;, &quot;should have failed&quot;);</span>
<a href="#l131.927"></a><span id="l131.927" class="difflineminus">-      cheapAssertStringContains(exceptions[7].exception, &quot;enter private browsing FAIL&quot;, &quot;should have failed&quot;);</span>
<a href="#l131.928"></a><span id="l131.928" class="difflineminus">-      cheapAssertStringContains(exceptions[8].exception, &quot;exit private browsing FAIL&quot;, &quot;should have failed&quot;);</span>
<a href="#l131.929"></a><span id="l131.929" class="difflineminus">-</span>
<a href="#l131.930"></a><span id="l131.930" class="difflineminus">-      // Now do a wipe and verify that it clears all exceptions.</span>
<a href="#l131.931"></a><span id="l131.931" class="difflineminus">-      store.wipeAllData(function() {</span>
<a href="#l131.932"></a><span id="l131.932" class="difflineminus">-        experiment._prependMetadataToJSON(function(jsonString) {</span>
<a href="#l131.933"></a><span id="l131.933" class="difflineminus">-          let exceptions = JSON.parse(jsonString).exceptions;</span>
<a href="#l131.934"></a><span id="l131.934" class="difflineminus">-          cheapAssertEqual(exceptions.length, 0, &quot;Exceptions should be wiped!&quot;);</span>
<a href="#l131.935"></a><span id="l131.935" class="difflineminus">-          // TODO this should be a teardown:</span>
<a href="#l131.936"></a><span id="l131.936" class="difflineminus">-          clearDbFile(fileName);</span>
<a href="#l131.937"></a><span id="l131.937" class="difflineminus">-        });</span>
<a href="#l131.938"></a><span id="l131.938" class="difflineminus">-      });</span>
<a href="#l131.939"></a><span id="l131.939" class="difflineminus">-    });</span>
<a href="#l131.940"></a><span id="l131.940" class="difflineminus">-  });</span>
<a href="#l131.941"></a><span id="l131.941" class="difflineminus">-});</span>
<a href="#l131.942"></a><span id="l131.942" class="difflineminus">-}</span>
<a href="#l131.943"></a><span id="l131.943" class="difflineminus">-</span>
<a href="#l131.944"></a><span id="l131.944" class="difflineminus">-</span>
<a href="#l131.945"></a><span id="l131.945" class="difflineminus">-function runAllTests() {</span>
<a href="#l131.946"></a><span id="l131.946" class="difflineminus">-  testsRun = 0;</span>
<a href="#l131.947"></a><span id="l131.947" class="difflineminus">-  testsPassed = 0;</span>
<a href="#l131.948"></a><span id="l131.948" class="difflineminus">-</span>
<a href="#l131.949"></a><span id="l131.949" class="difflineminus">-  testTheDataStore();</span>
<a href="#l131.950"></a><span id="l131.950" class="difflineminus">-  //testFirefoxVersionCheck();</span>
<a href="#l131.951"></a><span id="l131.951" class="difflineminus">-  //testStringSanitizer();</span>
<a href="#l131.952"></a><span id="l131.952" class="difflineminus">-  //testTheCuddlefishPreferencesFilesystem();</span>
<a href="#l131.953"></a><span id="l131.953" class="difflineminus">-  //testRemoteLoader();</span>
<a href="#l131.954"></a><span id="l131.954" class="difflineminus">-  //testRemoteLoaderIndexCache();</span>
<a href="#l131.955"></a><span id="l131.955" class="difflineminus">-  //testRecurringStudyStateChange();</span>
<a href="#l131.956"></a><span id="l131.956" class="difflineminus">-  //testKillSwitch();</span>
<a href="#l131.957"></a><span id="l131.957" class="difflineminus">-  //testSameGUIDs();</span>
<a href="#l131.958"></a><span id="l131.958" class="difflineminus">-  //testExceptionLogging();</span>
<a href="#l131.959"></a><span id="l131.959" class="difflineminus">-  output(&quot;TESTING COMPLETE.  &quot; + testsPassed + &quot; out of &quot; + testsRun +</span>
<a href="#l131.960"></a><span id="l131.960" class="difflineminus">-       &quot; tests passed.&quot;);</span>
<a href="#l131.961"></a><span id="l131.961" class="difflineminus">-}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l132.1"></a><span id="l132.1" class="difflineminus">--- a/mail/installer/package-manifest.in</span>
<a href="#l132.2"></a><span id="l132.2" class="difflineplus">+++ b/mail/installer/package-manifest.in</span>
<a href="#l132.3"></a><span id="l132.3" class="difflineat">@@ -216,17 +216,16 @@</span>
<a href="#l132.4"></a><span id="l132.4"> @BINPATH@/chrome/icons/default/msgcomposeWindow.ico</span>
<a href="#l132.5"></a><span id="l132.5"> #elifdef UNIX_BUT_NOT_MAC</span>
<a href="#l132.6"></a><span id="l132.6"> @BINPATH@/chrome/icons/default/*.png</span>
<a href="#l132.7"></a><span id="l132.7"> #endif</span>
<a href="#l132.8"></a><span id="l132.8"> @BINPATH@/extensions/{972ce4c6-7e08-4474-a285-3208198ce6fd}/install.rdf</span>
<a href="#l132.9"></a><span id="l132.9"> @BINPATH@/extensions/{972ce4c6-7e08-4474-a285-3208198ce6fd}/icon.png</span>
<a href="#l132.10"></a><span id="l132.10"> @BINPATH@/extensions/{972ce4c6-7e08-4474-a285-3208198ce6fd}/preview.png</span>
<a href="#l132.11"></a><span id="l132.11"> @BINPATH@/extensions/{972ce4c6-7e08-4474-a285-3208198ce6fd}/chrome.manifest</span>
<a href="#l132.12"></a><span id="l132.12" class="difflineminus">-@BINPATH@/distribution/extensions/tbtestpilot@labs.mozilla.com.xpi</span>
<a href="#l132.13"></a><span id="l132.13"> </span>
<a href="#l132.14"></a><span id="l132.14"> ; Gloda</span>
<a href="#l132.15"></a><span id="l132.15"> @BINPATH@/chrome/gloda@JAREXT@</span>
<a href="#l132.16"></a><span id="l132.16"> @BINPATH@/chrome/gloda.manifest</span>
<a href="#l132.17"></a><span id="l132.17"> @BINPATH@/components/glautocomp.js</span>
<a href="#l132.18"></a><span id="l132.18"> @BINPATH@/components/gloda.manifest</span>
<a href="#l132.19"></a><span id="l132.19"> @BINPATH@/components/jsmimeemitter.js</span>
<a href="#l132.20"></a><span id="l132.20"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l133.1"></a><span id="l133.1" class="difflineminus">--- a/mail/installer/removed-files.in</span>
<a href="#l133.2"></a><span id="l133.2" class="difflineplus">+++ b/mail/installer/removed-files.in</span>
<a href="#l133.3"></a><span id="l133.3" class="difflineat">@@ -161,16 +161,27 @@ defaults/profile/US/</span>
<a href="#l133.4"></a><span id="l133.4"> #endif</span>
<a href="#l133.5"></a><span id="l133.5"> defaults/wallet/VcardSchema.tbl</span>
<a href="#l133.6"></a><span id="l133.6"> defaults/wallet/FieldSchema.tbl</span>
<a href="#l133.7"></a><span id="l133.7"> defaults/wallet/SchemaConcat.tbl</span>
<a href="#l133.8"></a><span id="l133.8"> defaults/wallet/DistinguishedSchema.tbl</span>
<a href="#l133.9"></a><span id="l133.9"> defaults/wallet/SchemaStrings.tbl</span>
<a href="#l133.10"></a><span id="l133.10"> defaults/wallet/PositionalSchema.tbl</span>
<a href="#l133.11"></a><span id="l133.11"> defaults/wallet/StateSchema.tbl</span>
<a href="#l133.12"></a><span id="l133.12" class="difflineplus">+</span>
<a href="#l133.13"></a><span id="l133.13" class="difflineplus">+# Remove obsolete bundled thunderbird test pilot.</span>
<a href="#l133.14"></a><span id="l133.14" class="difflineplus">+# In the average case, this directory is only used by Test Pilot, and will get</span>
<a href="#l133.15"></a><span id="l133.15" class="difflineplus">+# removed by the updater. In some cases (eg, partner builds), distribution/</span>
<a href="#l133.16"></a><span id="l133.16" class="difflineplus">+# will have other files and/or directories in it. In these cases, the updater</span>
<a href="#l133.17"></a><span id="l133.17" class="difflineplus">+# will print a non-fatal error and continue on, because we're not appending</span>
<a href="#l133.18"></a><span id="l133.18" class="difflineplus">+# '*' to force a recursive removal.</span>
<a href="#l133.19"></a><span id="l133.19" class="difflineplus">+distribution/</span>
<a href="#l133.20"></a><span id="l133.20" class="difflineplus">+distribution/extensions/</span>
<a href="#l133.21"></a><span id="l133.21" class="difflineplus">+distribution/extensions/tbtestpilot@labs.mozilla.com.xpi</span>
<a href="#l133.22"></a><span id="l133.22" class="difflineplus">+</span>
<a href="#l133.23"></a><span id="l133.23"> greprefs/all.js</span>
<a href="#l133.24"></a><span id="l133.24"> greprefs/security-prefs.js</span>
<a href="#l133.25"></a><span id="l133.25"> greprefs/xpinstall.js</span>
<a href="#l133.26"></a><span id="l133.26"> greprefs/</span>
<a href="#l133.27"></a><span id="l133.27"> hyphenation/</span>
<a href="#l133.28"></a><span id="l133.28"> hyphenation/hyph_af.dic</span>
<a href="#l133.29"></a><span id="l133.29"> hyphenation/hyph_bg.dic</span>
<a href="#l133.30"></a><span id="l133.30"> hyphenation/hyph_ca.dic</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l134.1"></a><span id="l134.1">deleted file mode 100644</span>
<a href="#l134.2"></a><span id="l134.2" class="difflineminus">--- a/mail/locales/en-US/feedback/main.dtd</span>
<a href="#l134.3"></a><span id="l134.3" class="difflineplus">+++ /dev/null</span>
<a href="#l134.4"></a><span id="l134.4" class="difflineat">@@ -1,40 +0,0 @@</span>
<a href="#l134.5"></a><span id="l134.5" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l134.6"></a><span id="l134.6" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l134.7"></a><span id="l134.7" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l134.8"></a><span id="l134.8" class="difflineminus">-</span>
<a href="#l134.9"></a><span id="l134.9" class="difflineminus">-&lt;!ENTITY testpilot.brand.label                          &quot;Test Pilot&quot;&gt;</span>
<a href="#l134.10"></a><span id="l134.10" class="difflineminus">-&lt;!-- browser window: menu and status bar --&gt;</span>
<a href="#l134.11"></a><span id="l134.11" class="difflineminus">-&lt;!ENTITY testpilot.settings.label                       &quot;Settings&quot;&gt;</span>
<a href="#l134.12"></a><span id="l134.12" class="difflineminus">-&lt;!ENTITY testpilot.settings.dataSubmission.label        &quot;Data Submission&quot;&gt;</span>
<a href="#l134.13"></a><span id="l134.13" class="difflineminus">-&lt;!ENTITY testpilot.settings.notifications.label         &quot;Notifications&quot;&gt;</span>
<a href="#l134.14"></a><span id="l134.14" class="difflineminus">-&lt;!ENTITY testpilot.settings.notifyWhen.label            &quot;Notify me when…&quot;&gt;</span>
<a href="#l134.15"></a><span id="l134.15" class="difflineminus">-&lt;!ENTITY testpilot.settings.readyToSubmit.label         &quot;A study is ready to submit&quot;&gt;</span>
<a href="#l134.16"></a><span id="l134.16" class="difflineminus">-&lt;!ENTITY testpilot.settings.newStudy.label              &quot;There's a new study&quot;&gt;</span>
<a href="#l134.17"></a><span id="l134.17" class="difflineminus">-&lt;!ENTITY testpilot.settings.hasNewResults.label         &quot;A study has new results&quot;&gt;</span>
<a href="#l134.18"></a><span id="l134.18" class="difflineminus">-&lt;!ENTITY testpilot.settings.alwaysSubmitData.shortLabel &quot;Always submit my data (don't ask me)&quot;&gt;</span>
<a href="#l134.19"></a><span id="l134.19" class="difflineminus">-&lt;!ENTITY testpilot.allYourStudies.label                 &quot;All Your User Studies…&quot;&gt;</span>
<a href="#l134.20"></a><span id="l134.20" class="difflineminus">-&lt;!ENTITY testpilot.about.label                          &quot;About Test Pilot&quot;&gt;</span>
<a href="#l134.21"></a><span id="l134.21" class="difflineminus">-</span>
<a href="#l134.22"></a><span id="l134.22" class="difflineminus">-&lt;!-- all studies window --&gt;</span>
<a href="#l134.23"></a><span id="l134.23" class="difflineminus">-&lt;!ENTITY testpilot.studiesWindow.title                  &quot;Your Test Pilot Studies&quot;&gt;</span>
<a href="#l134.24"></a><span id="l134.24" class="difflineminus">-&lt;!ENTITY testpilot.studiesWindow.currentStudies.label   &quot;Current Studies&quot;&gt;</span>
<a href="#l134.25"></a><span id="l134.25" class="difflineminus">-&lt;!ENTITY testpilot.studiesWindow.finishedStudies.label  &quot;Finished Studies&quot;&gt;</span>
<a href="#l134.26"></a><span id="l134.26" class="difflineminus">-&lt;!ENTITY testpilot.studiesWindow.studyFindings.label    &quot;Study Findings&quot;&gt;</span>
<a href="#l134.27"></a><span id="l134.27" class="difflineminus">-&lt;!ENTITY testpilot.studiesWindow.settings.label         &quot;Settings&quot;&gt;</span>
<a href="#l134.28"></a><span id="l134.28" class="difflineminus">-&lt;!ENTITY testpilot.studiesWindow.stillLoadingMessage    &quot;Loading, please wait…&quot;&gt;</span>
<a href="#l134.29"></a><span id="l134.29" class="difflineminus">-</span>
<a href="#l134.30"></a><span id="l134.30" class="difflineminus">-&lt;!-- raw data dialog --&gt;</span>
<a href="#l134.31"></a><span id="l134.31" class="difflineminus">-&lt;!ENTITY testpilot.rawDataWindow.title                  &quot;Test Pilot: Raw Data&quot;&gt;</span>
<a href="#l134.32"></a><span id="l134.32" class="difflineminus">-</span>
<a href="#l134.33"></a><span id="l134.33" class="difflineminus">-&lt;!-- notification --&gt;</span>
<a href="#l134.34"></a><span id="l134.34" class="difflineminus">-&lt;!ENTITY testpilot.notification.close.tooltip           &quot;Close&quot;&gt;</span>
<a href="#l134.35"></a><span id="l134.35" class="difflineminus">-</span>
<a href="#l134.36"></a><span id="l134.36" class="difflineminus">-&lt;!-- Firefox 4 beta version UI --&gt;</span>
<a href="#l134.37"></a><span id="l134.37" class="difflineminus">-&lt;!ENTITY testpilot.enable.label                         &quot;Turn On User Studies&quot;&gt;</span>
<a href="#l134.38"></a><span id="l134.38" class="difflineminus">-&lt;!ENTITY testpilot.feedbackbutton.label                 &quot;Feedback&quot;&gt;</span>
<a href="#l134.39"></a><span id="l134.39" class="difflineminus">-&lt;!ENTITY testpilot.happy.label                          &quot;Firefox Made Me Happy Because…&quot;&gt;</span>
<a href="#l134.40"></a><span id="l134.40" class="difflineminus">-&lt;!ENTITY testpilot.sad.label                            &quot;Firefox Made Me Sad Because…&quot;&gt;</span>
<a href="#l134.41"></a><span id="l134.41" class="difflineminus">-&lt;!ENTITY testpilot.happy.thunderbirdLabel               &quot;Thunderbird Made Me Happy Because…&quot;&gt;</span>
<a href="#l134.42"></a><span id="l134.42" class="difflineminus">-&lt;!ENTITY testpilot.sad.thunderbirdLabel                 &quot;Thunderbird Made Me Sad Because…&quot;&gt;</span>
<a href="#l134.43"></a><span id="l134.43" class="difflineminus">-&lt;!ENTITY testpilot.broken.label                         &quot;Report this website as broken…&quot;&gt;</span>
<a href="#l134.44"></a><span id="l134.44" class="difflineminus">-&lt;!ENTITY testpilot.idea.label                           &quot;Give us a suggestion…&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l135.1"></a><span id="l135.1">deleted file mode 100644</span>
<a href="#l135.2"></a><span id="l135.2" class="difflineminus">--- a/mail/locales/en-US/feedback/main.properties</span>
<a href="#l135.3"></a><span id="l135.3" class="difflineplus">+++ /dev/null</span>
<a href="#l135.4"></a><span id="l135.4" class="difflineat">@@ -1,119 +0,0 @@</span>
<a href="#l135.5"></a><span id="l135.5" class="difflineminus">-# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l135.6"></a><span id="l135.6" class="difflineminus">-# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l135.7"></a><span id="l135.7" class="difflineminus">-# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l135.8"></a><span id="l135.8" class="difflineminus">-</span>
<a href="#l135.9"></a><span id="l135.9" class="difflineminus">-# description for add-on manager</span>
<a href="#l135.10"></a><span id="l135.10" class="difflineminus">-extensions.tbtestpilot@labs.mozilla.com.description = Help make Thunderbird better by running user studies.</span>
<a href="#l135.11"></a><span id="l135.11" class="difflineminus">-</span>
<a href="#l135.12"></a><span id="l135.12" class="difflineminus">-# common</span>
<a href="#l135.13"></a><span id="l135.13" class="difflineminus">-testpilot.fullBrandName = Mozilla Labs Test Pilot</span>
<a href="#l135.14"></a><span id="l135.14" class="difflineminus">-testpilot.moreInfo = More Info</span>
<a href="#l135.15"></a><span id="l135.15" class="difflineminus">-testpilot.submit = Submit</span>
<a href="#l135.16"></a><span id="l135.16" class="difflineminus">-testpilot.takeSurvey = Take the Survey</span>
<a href="#l135.17"></a><span id="l135.17" class="difflineminus">-</span>
<a href="#l135.18"></a><span id="l135.18" class="difflineminus">-# Feedback button menu</span>
<a href="#l135.19"></a><span id="l135.19" class="difflineminus">-testpilot.turnOn = Turn On User Studies</span>
<a href="#l135.20"></a><span id="l135.20" class="difflineminus">-testpilot.turnOff = Turn Off User Studies</span>
<a href="#l135.21"></a><span id="l135.21" class="difflineminus">-</span>
<a href="#l135.22"></a><span id="l135.22" class="difflineminus">-# studies window</span>
<a href="#l135.23"></a><span id="l135.23" class="difflineminus">-testpilot.studiesWindow.noStudies = We are working on a new study now; it will knock on your door soon! Stay Tuned!</span>
<a href="#l135.24"></a><span id="l135.24" class="difflineminus">-testpilot.studiesWindow.uploading = Uploading…</span>
<a href="#l135.25"></a><span id="l135.25" class="difflineminus">-testpilot.studiesWindow.unableToReachServer = Unable to reach Mozilla; please try again later.</span>
<a href="#l135.26"></a><span id="l135.26" class="difflineminus">-testpilot.studiesWindow.thanksForContributing = Thanks for contributing!</span>
<a href="#l135.27"></a><span id="l135.27" class="difflineminus">-testpilot.studiesWindow.finishedOn = Finished on %S</span>
<a href="#l135.28"></a><span id="l135.28" class="difflineminus">-testpilot.studiesWindow.canceledStudy = (You canceled this study)</span>
<a href="#l135.29"></a><span id="l135.29" class="difflineminus">-testpilot.studiesWindow.missedStudy = (You missed this study)</span>
<a href="#l135.30"></a><span id="l135.30" class="difflineminus">-testpilot.studiesWindow.willStart = Will start on %S</span>
<a href="#l135.31"></a><span id="l135.31" class="difflineminus">-testpilot.studiesWindow.gatheringData = Currently gathering data.</span>
<a href="#l135.32"></a><span id="l135.32" class="difflineminus">-testpilot.studiesWindow.willFinish = Will finish on %S</span>
<a href="#l135.33"></a><span id="l135.33" class="difflineminus">-testpilot.studiesWindow.proposeStudy = Propose your own study</span>
<a href="#l135.34"></a><span id="l135.34" class="difflineminus">-</span>
<a href="#l135.35"></a><span id="l135.35" class="difflineminus">-# for pages</span>
<a href="#l135.36"></a><span id="l135.36" class="difflineminus">-testpilot.page.commentsAndDiscussions = Comments &amp; Discussions »</span>
<a href="#l135.37"></a><span id="l135.37" class="difflineminus">-testpilot.page.proposeATest = Propose a Test »</span>
<a href="#l135.38"></a><span id="l135.38" class="difflineminus">-testpilot.page.testpilotOnTwitter = @MozTestPilot on Twitter »</span>
<a href="#l135.39"></a><span id="l135.39" class="difflineminus">-</span>
<a href="#l135.40"></a><span id="l135.40" class="difflineminus">-# status page</span>
<a href="#l135.41"></a><span id="l135.41" class="difflineminus">-testpilot.statusPage.uploadingData = Now uploading data…</span>
<a href="#l135.42"></a><span id="l135.42" class="difflineminus">-testpilot.statusPage.uploadErrorMsg = Oops! There was an error connecting to the Mozilla servers.  Maybe your network connection is down?</span>
<a href="#l135.43"></a><span id="l135.43" class="difflineminus">-testpilot.statusPage.willRetry = Test Pilot will retry automatically, so it's OK to close this page now.</span>
<a href="#l135.44"></a><span id="l135.44" class="difflineminus">-testpilot.statusPage.endedAlready = (It has already ended and you should not be seeing this page)</span>
<a href="#l135.45"></a><span id="l135.45" class="difflineminus">-testpilot.statusPage.todayAt =  today, at %S</span>
<a href="#l135.46"></a><span id="l135.46" class="difflineminus">-testpilot.statusPage.endOn = on %S</span>
<a href="#l135.47"></a><span id="l135.47" class="difflineminus">-# LOCALIZATION NOTE (numExtensions): Semi-colon list of plural forms.</span>
<a href="#l135.48"></a><span id="l135.48" class="difflineminus">-# See: http://developer.mozilla.org/en/docs/Localization_and_Plurals</span>
<a href="#l135.49"></a><span id="l135.49" class="difflineminus">-# #1 = number of extensions</span>
<a href="#l135.50"></a><span id="l135.50" class="difflineminus">-# example: &quot;2 extensions&quot;</span>
<a href="#l135.51"></a><span id="l135.51" class="difflineminus">-testpilot.statusPage.numExtensions = #1 extension;#1 extensions</span>
<a href="#l135.52"></a><span id="l135.52" class="difflineminus">-testpilot.statusPage.recursEveryNumberOfDays = This test recurs every %S days. Each time it completes:</span>
<a href="#l135.53"></a><span id="l135.53" class="difflineminus">-testpilot.statusPage.askMeBeforeSubmitData = Ask me whether I want to submit my data.</span>
<a href="#l135.54"></a><span id="l135.54" class="difflineminus">-testpilot.statusPage.alwaysSubmitData = Always submit my data, and don't ask me about it.</span>
<a href="#l135.55"></a><span id="l135.55" class="difflineminus">-testpilot.statusPage.neverSubmitData = Never submit my data, and don't ask me about it.</span>
<a href="#l135.56"></a><span id="l135.56" class="difflineminus">-testpilot.statusPage.loading = Loading, please wait a moment…</span>
<a href="#l135.57"></a><span id="l135.57" class="difflineminus">-</span>
<a href="#l135.58"></a><span id="l135.58" class="difflineminus">-# quit page</span>
<a href="#l135.59"></a><span id="l135.59" class="difflineminus">-testpilot.quitPage.aboutToQuit = You are about to quit the &quot;%S&quot; study.</span>
<a href="#l135.60"></a><span id="l135.60" class="difflineminus">-testpilot.quitPage.optionalMessage = (Optional) If you have a minute, please let us know why you have chosen to quit the study.</span>
<a href="#l135.61"></a><span id="l135.61" class="difflineminus">-testpilot.quitPage.reason = Reason:</span>
<a href="#l135.62"></a><span id="l135.62" class="difflineminus">-testpilot.quitPage.recurringStudy = This is a recurring study. Normally we will let you know the next time we run the study.  If you never want to hear about this study again, check the box below:</span>
<a href="#l135.63"></a><span id="l135.63" class="difflineminus">-testpilot.quitPage.quitForever = Quit this recurring study.</span>
<a href="#l135.64"></a><span id="l135.64" class="difflineminus">-testpilot.quitPage.quitStudy = Quit the Study »</span>
<a href="#l135.65"></a><span id="l135.65" class="difflineminus">-</span>
<a href="#l135.66"></a><span id="l135.66" class="difflineminus">-# welcome page</span>
<a href="#l135.67"></a><span id="l135.67" class="difflineminus">-testpilot.welcomePage.thankYou = Thank You for Joining the Test Pilot Team!</span>
<a href="#l135.68"></a><span id="l135.68" class="difflineminus">-testpilot.welcomePage.gettingStarted = Getting Started</span>
<a href="#l135.69"></a><span id="l135.69" class="difflineminus">-testpilot.welcomePage.pleaseTake = Please take the</span>
<a href="#l135.70"></a><span id="l135.70" class="difflineminus">-testpilot.welcomePage.backgroundSurvey = Pilot Background Survey</span>
<a href="#l135.71"></a><span id="l135.71" class="difflineminus">-testpilot.welcomePage.clickToOpenStudiesWindow = Click here to see the studies that are currently running.</span>
<a href="#l135.72"></a><span id="l135.72" class="difflineminus">-testpilot.welcomePage.testpilotAddon = Test Pilot Add-on</span>
<a href="#l135.73"></a><span id="l135.73" class="difflineminus">-testpilot.welcomePage.iconExplanation = « look for this icon in the bottom right of the mail window.</span>
<a href="#l135.74"></a><span id="l135.74" class="difflineminus">-testpilot.welcomePage.iconExplanation2 = « look for this icon in the Tools menu.</span>
<a href="#l135.75"></a><span id="l135.75" class="difflineminus">-testpilot.welcomePage.moreIconExplanation = You can click on it to get the main Test Pilot menu.</span>
<a href="#l135.76"></a><span id="l135.76" class="difflineminus">-testpilot.welcomePage.moreIconExplanation2 = Use the sub-menu to see what Test Pilot studies are running on your computer and to set your preferences.</span>
<a href="#l135.77"></a><span id="l135.77" class="difflineminus">-testpilot.welcomePage.notificationInfo = The icon will pop up a notification when a study needs your attention.</span>
<a href="#l135.78"></a><span id="l135.78" class="difflineminus">-testpilot.welcomePage.notificationInfo2 = The icon will appear and pop up a notification when a study needs your attention.</span>
<a href="#l135.79"></a><span id="l135.79" class="difflineminus">-testpilot.welcomePage.privacyPolicy = Privacy Policy</span>
<a href="#l135.80"></a><span id="l135.80" class="difflineminus">-testpilot.welcomePage.legalNotices = Legal Notices</span>
<a href="#l135.81"></a><span id="l135.81" class="difflineminus">-</span>
<a href="#l135.82"></a><span id="l135.82" class="difflineminus">-# survey page</span>
<a href="#l135.83"></a><span id="l135.83" class="difflineminus">-testpilot.surveyPage.saveAnswers = Save Answers</span>
<a href="#l135.84"></a><span id="l135.84" class="difflineminus">-testpilot.surveyPage.submitAnswers = Submit Answers</span>
<a href="#l135.85"></a><span id="l135.85" class="difflineminus">-testpilot.surveyPage.changeAnswers = Change Answers</span>
<a href="#l135.86"></a><span id="l135.86" class="difflineminus">-testpilot.surveyPage.loading = Loading, please wait a moment…</span>
<a href="#l135.87"></a><span id="l135.87" class="difflineminus">-testpilot.surveyPage.thankYouForFinishingSurvey = Thank you for finishing this survey. Your answers will be uploaded along with the next set of experimental data.</span>
<a href="#l135.88"></a><span id="l135.88" class="difflineminus">-testpilot.surveyPage.reviewOrChangeYourAnswers = If you would like to review or change your answers, you can do so at any time using the button below.</span>
<a href="#l135.89"></a><span id="l135.89" class="difflineminus">-</span>
<a href="#l135.90"></a><span id="l135.90" class="difflineminus">-# modules/task.js</span>
<a href="#l135.91"></a><span id="l135.91" class="difflineminus">-testpilot.finishedTask.finishedStudy = Excellent! You finished the &quot;%S&quot; Study!</span>
<a href="#l135.92"></a><span id="l135.92" class="difflineminus">-testpilot.finishedTask.allRelatedDataDeleted = All data related to this study has been removed from your computer.</span>
<a href="#l135.93"></a><span id="l135.93" class="difflineminus">-</span>
<a href="#l135.94"></a><span id="l135.94" class="difflineminus">-# modules/setup.js</span>
<a href="#l135.95"></a><span id="l135.95" class="difflineminus">-testpilot.notification.update = Update…</span>
<a href="#l135.96"></a><span id="l135.96" class="difflineminus">-testpilot.notification.thankYouForUploadingData = Thanks!</span>
<a href="#l135.97"></a><span id="l135.97" class="difflineminus">-testpilot.notification.thankYouForUploadingData.message = Thank you for uploading your data.</span>
<a href="#l135.98"></a><span id="l135.98" class="difflineminus">-testpilot.notification.readyToSubmit = Ready to Submit</span>
<a href="#l135.99"></a><span id="l135.99" class="difflineminus">-testpilot.notification.readyToSubmit.message = The Test Pilot &quot;%S&quot; study is finished gathering data and is ready to submit.</span>
<a href="#l135.100"></a><span id="l135.100" class="difflineminus">-testpilot.notification.newTestPilotStudy = New Test Pilot Study</span>
<a href="#l135.101"></a><span id="l135.101" class="difflineminus">-testpilot.notification.newTestPilotStudy.pre.message = The Test Pilot &quot;%S&quot; study is about to begin.</span>
<a href="#l135.102"></a><span id="l135.102" class="difflineminus">-testpilot.notification.newTestPilotSurvey = New Test Pilot Survey</span>
<a href="#l135.103"></a><span id="l135.103" class="difflineminus">-testpilot.notification.newTestPilotSurvey.message = The Test Pilot &quot;%S&quot; survey is available.</span>
<a href="#l135.104"></a><span id="l135.104" class="difflineminus">-testpilot.notification.newTestPilotResults = New Test Pilot Results</span>
<a href="#l135.105"></a><span id="l135.105" class="difflineminus">-testpilot.notification.newTestPilotResults.message = New results are now available for the Test Pilot &quot;%S&quot; study.</span>
<a href="#l135.106"></a><span id="l135.106" class="difflineminus">-testpilot.notification.autoUploadedData = Thank you!</span>
<a href="#l135.107"></a><span id="l135.107" class="difflineminus">-testpilot.notification.autoUploadedData.message = The Test Pilot &quot;%S&quot; study is completed and your data has been submitted!</span>
<a href="#l135.108"></a><span id="l135.108" class="difflineminus">-testpilot.notification.extensionUpdate = Extension Update</span>
<a href="#l135.109"></a><span id="l135.109" class="difflineminus">-testpilot.notification.extensionUpdate.message = One of your studies requires a newer version of Test Pilot. You can get the latest version using the Add-ons window.</span>
<a href="#l135.110"></a><span id="l135.110" class="difflineminus">-</span>
<a href="#l135.111"></a><span id="l135.111" class="difflineminus">-# modules/setup.js - doorhanger notification buttons</span>
<a href="#l135.112"></a><span id="l135.112" class="difflineminus">-testpilot.notification.cancelLabel = Cancel Study</span>
<a href="#l135.113"></a><span id="l135.113" class="difflineminus">-testpilot.notification.alwaysSubmitLabel = Don't Ask, Always Submit</span>
<a href="#l135.114"></a><span id="l135.114" class="difflineminus">-testpilot.notification.dontShowNewLabel = Don't Notify Me of New Studies</span>
<a href="#l135.115"></a><span id="l135.115" class="difflineminus">-testpilot.notification.seeAllStudiesLabel = See All User Studies</span>
<a href="#l135.116"></a><span id="l135.116" class="difflineminus">-testpilot.notification.seeYourData = See Your Data</span>
<a href="#l135.117"></a><span id="l135.117" class="difflineminus">-</span>
<a href="#l135.118"></a><span id="l135.118" class="difflineminus">-# modules/notifications.js - doorhanger notification button shortcut keys</span>
<a href="#l135.119"></a><span id="l135.119" class="difflineminus">-testpilot.notification.accessKey.submit = S</span>
<a href="#l135.120"></a><span id="l135.120" class="difflineminus">-testpilot.notification.accessKey.moreInfo = M</span>
<a href="#l135.121"></a><span id="l135.121" class="difflineminus">-testpilot.notification.accessKey.allStudies = A</span>
<a href="#l135.122"></a><span id="l135.122" class="difflineminus">-testpilot.notification.accessKey.alwaysSubmit = D</span>
<a href="#l135.123"></a><span id="l135.123" class="difflineminus">-testpilot.notification.accessKey.cancel = C</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l136.1"></a><span id="l136.1" class="difflineminus">--- a/mail/locales/jar.mn</span>
<a href="#l136.2"></a><span id="l136.2" class="difflineplus">+++ b/mail/locales/jar.mn</span>
<a href="#l136.3"></a><span id="l136.3" class="difflineat">@@ -208,11 +208,9 @@</span>
<a href="#l136.4"></a><span id="l136.4">   locale/@AB_CD@/messenger-smime/certFetchingStatus.dtd                 (%chrome/messenger-smime/certFetchingStatus.dtd)</span>
<a href="#l136.5"></a><span id="l136.5">   locale/@AB_CD@/messenger-smime/msgSecurityInfo.properties             (%chrome/messenger-smime/msgSecurityInfo.properties)</span>
<a href="#l136.6"></a><span id="l136.6"> % locale messenger-region @AB_CD@ %locale/@AB_CD@/messenger-region/</span>
<a href="#l136.7"></a><span id="l136.7">   locale/@AB_CD@/messenger-region/region.properties                     (%chrome/messenger-region/region.properties)</span>
<a href="#l136.8"></a><span id="l136.8"> % locale mozldap @AB_CD@ %locale/@AB_CD@/mozldap/</span>
<a href="#l136.9"></a><span id="l136.9">   locale/@AB_CD@/mozldap/ldap.properties                                (%chrome/mozldap/ldap.properties)</span>
<a href="#l136.10"></a><span id="l136.10"> % locale communicator @AB_CD@ %locale/@AB_CD@/communicator/</span>
<a href="#l136.11"></a><span id="l136.11">   locale/@AB_CD@/communicator/utilityOverlay.dtd                        (%chrome/communicator/utilityOverlay.dtd)</span>
<a href="#l136.12"></a><span id="l136.12" class="difflineminus">-% locale testpilot @AB_CD@ %locale/@AB_CD@/feedback/</span>
<a href="#l136.13"></a><span id="l136.13" class="difflineminus">-  locale/@AB_CD@/feedback/main.dtd                       (%feedback/main.dtd)</span>
<a href="#l136.14"></a><span id="l136.14" class="difflineminus">-  locale/@AB_CD@/feedback/main.properties                (%feedback/main.properties)</span>
<a href="#l136.15"></a><span id="l136.15" class="difflineplus">+</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l137.1"></a><span id="l137.1" class="difflineminus">--- a/mail/test/mozmill/runtest.py</span>
<a href="#l137.2"></a><span id="l137.2" class="difflineplus">+++ b/mail/test/mozmill/runtest.py</span>
<a href="#l137.3"></a><span id="l137.3" class="difflineat">@@ -119,18 +119,16 @@ class ThunderTestProfile(mozrunner.Thund</span>
<a href="#l137.4"></a><span id="l137.4">         'mail.root.none-rel' :  &quot;[ProfD]Mail&quot;,</span>
<a href="#l137.5"></a><span id="l137.5">         'mail.root.pop3-rel' :  &quot;[ProfD]Mail&quot;,</span>
<a href="#l137.6"></a><span id="l137.6">         # Do not allow check new mail to be set</span>
<a href="#l137.7"></a><span id="l137.7">         'mail.startup.enabledMailCheckOnce' :  True,</span>
<a href="#l137.8"></a><span id="l137.8">         # Disable compatibility checking</span>
<a href="#l137.9"></a><span id="l137.9">         'extensions.checkCompatibility.nightly': False,</span>
<a href="#l137.10"></a><span id="l137.10">         # Stop any pings to AMO on add-on install</span>
<a href="#l137.11"></a><span id="l137.11">         'extensions.getAddons.cache.enabled': False,</span>
<a href="#l137.12"></a><span id="l137.12" class="difflineminus">-        # Disable test pilot new tab (this can be set to anything currently, just needs to be set).</span>
<a href="#l137.13"></a><span id="l137.13" class="difflineminus">-        'extensions.testpilot.lastversion': '1.0',</span>
<a href="#l137.14"></a><span id="l137.14">         # In case a developer is working on a laptop without a network</span>
<a href="#l137.15"></a><span id="l137.15">         # connection, don't detect offline mode; hence we'll still startup</span>
<a href="#l137.16"></a><span id="l137.16">         # online which is what mozmill currently requires. It'll also protect us</span>
<a href="#l137.17"></a><span id="l137.17">         # from any random network failures.</span>
<a href="#l137.18"></a><span id="l137.18">         'offline.autoDetect': False,</span>
<a href="#l137.19"></a><span id="l137.19">         # Don't load what's new or the remote start page - keep everything local</span>
<a href="#l137.20"></a><span id="l137.20">         # under our control.</span>
<a href="#l137.21"></a><span id="l137.21">         'mailnews.start_page_override.mstone' :  &quot;ignore&quot;,</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

