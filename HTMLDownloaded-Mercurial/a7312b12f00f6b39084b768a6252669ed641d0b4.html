<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 20043:a7312b12f00f6b39084b768a6252669ed641d0b4</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ a7312b12f00f6b39084b768a6252669ed641d0b4" />
<meta property="og:url" content="/comm-central/rev/a7312b12f00f6b39084b768a6252669ed641d0b4" />
<meta property="og:description" content="Bug 1280898 - Set up eslint for calendar files - enable padded-blocks rule. r=MakeMyDay" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / a7312b12f00f6b39084b768a6252669ed641d0b4 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/a7312b12f00f6b39084b768a6252669ed641d0b4">shortlog</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/a7312b12f00f6b39084b768a6252669ed641d0b4">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4">files</a> |
changeset |
<a href="/comm-central/raw-rev/a7312b12f00f6b39084b768a6252669ed641d0b4">raw</a>  | <a href="/comm-central/archive/a7312b12f00f6b39084b768a6252669ed641d0b4.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">Bug 1280898</a> - Set up eslint for calendar files - enable padded-blocks rule. r=MakeMyDay
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#101;&#115;&#108;&#105;&#110;&#116;&#32;&#60;&#101;&#115;&#108;&#105;&#110;&#116;&#64;&#98;&#117;&#103;&#122;&#105;&#108;&#108;&#97;&#46;&#107;&#101;&#119;&#105;&#115;&#46;&#99;&#104;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 08 Jul 2016 11:19:16 +0200</td></tr>

<tr>
 <td>changeset 20043</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/a7312b12f00f6b39084b768a6252669ed641d0b4">a7312b12f00f6b39084b768a6252669ed641d0b4</a></td>
</tr>



<tr>
<td>parent 20042</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/830d0c78b66315d9a78a687da644559dc748bb95">830d0c78b66315d9a78a687da644559dc748bb95</a>
</td>
</tr>

<tr>
<td>child 20044</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/332b96ae958ea1363628fb66362bd7533e2b613c">332b96ae958ea1363628fb66362bd7533e2b613c</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=a7312b12f00f6b39084b768a6252669ed641d0b4">12297</a></td></tr>
<tr><td>push user</td><td>mozilla@kewis.ch</td></tr>
<tr><td>push date</td><td class="date age">Fri, 16 Sep 2016 20:17:21 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@f3dc3e4a87d4 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=f3dc3e4a87d4590884873d9248b3e6f6a01f0165">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=f3dc3e4a87d4590884873d9248b3e6f6a01f0165&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=f3dc3e4a87d4590884873d9248b3e6f6a01f0165&newProject=comm-central&newRevision=a7312b12f00f6b39084b768a6252669ed641d0b4&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=f3dc3e4a87d4590884873d9248b3e6f6a01f0165&newProject=comm-central&newRevision=a7312b12f00f6b39084b768a6252669ed641d0b4&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=f3dc3e4a87d4590884873d9248b3e6f6a01f0165&newProject=comm-central&newRevision=a7312b12f00f6b39084b768a6252669ed641d0b4&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28MakeMyDay%29&revcount=50">MakeMyDay</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">1280898</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">Bug 1280898</a> - Set up eslint for calendar files - enable padded-blocks rule. r=MakeMyDay

MozReview-Commit-ID: 5lyblIK0it5</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/.eslintrc">calendar/.eslintrc</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/.eslintrc">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/.eslintrc">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/.eslintrc">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/.eslintrc">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/.eslintrc">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/agenda-listbox.js">calendar/base/content/agenda-listbox.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/agenda-listbox.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/agenda-listbox.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/agenda-listbox.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/agenda-listbox.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/agenda-listbox.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-base-view.xml">calendar/base/content/calendar-base-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-base-view.xml">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-base-view.xml">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-base-view.xml">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-base-view.xml">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-base-view.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-item-editing.js">calendar/base/content/calendar-item-editing.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-item-editing.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-item-editing.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-item-editing.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-item-editing.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-item-editing.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-management.js">calendar/base/content/calendar-management.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-management.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-management.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-management.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-management.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-management.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-month-view.xml">calendar/base/content/calendar-month-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-month-view.xml">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-month-view.xml">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-month-view.xml">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-month-view.xml">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-month-view.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-multiday-view.xml">calendar/base/content/calendar-multiday-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-multiday-view.xml">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-multiday-view.xml">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-multiday-view.xml">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-multiday-view.xml">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-multiday-view.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-task-view.js">calendar/base/content/calendar-task-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-task-view.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-task-view.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-task-view.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-task-view.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-task-view.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-ui-utils.js">calendar/base/content/calendar-ui-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-ui-utils.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-ui-utils.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-ui-utils.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-ui-utils.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-ui-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-views.js">calendar/base/content/calendar-views.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-views.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-views.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-views.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-views.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/calendar-views.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-alarm-dialog.js">calendar/base/content/dialogs/calendar-alarm-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-alarm-dialog.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-alarm-dialog.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-alarm-dialog.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-alarm-dialog.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-alarm-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-dialog-utils.js">calendar/base/content/dialogs/calendar-dialog-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-dialog-utils.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-dialog-utils.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-dialog-utils.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-dialog-utils.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-dialog-utils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">calendar/base/content/dialogs/calendar-event-dialog-attendees.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml">calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-print-dialog.js">calendar/base/content/dialogs/calendar-print-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-print-dialog.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-print-dialog.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-print-dialog.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-print-dialog.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-print-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-summary-dialog.js">calendar/base/content/dialogs/calendar-summary-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-summary-dialog.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-summary-dialog.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-summary-dialog.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-summary-dialog.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/dialogs/calendar-summary-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/import-export.js">calendar/base/content/import-export.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/import-export.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/import-export.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/import-export.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/import-export.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/import-export.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/widgets/calendar-list-tree.xml">calendar/base/content/widgets/calendar-list-tree.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/widgets/calendar-list-tree.xml">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/widgets/calendar-list-tree.xml">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/widgets/calendar-list-tree.xml">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/widgets/calendar-list-tree.xml">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/content/widgets/calendar-list-tree.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calAuthUtils.jsm">calendar/base/modules/calAuthUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calAuthUtils.jsm">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calAuthUtils.jsm">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calAuthUtils.jsm">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calAuthUtils.jsm">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calAuthUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calExtract.jsm">calendar/base/modules/calExtract.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calExtract.jsm">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calExtract.jsm">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calExtract.jsm">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calExtract.jsm">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calExtract.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calItipUtils.jsm">calendar/base/modules/calItipUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calItipUtils.jsm">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calItipUtils.jsm">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calItipUtils.jsm">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calItipUtils.jsm">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calItipUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calProviderUtils.jsm">calendar/base/modules/calProviderUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calProviderUtils.jsm">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calProviderUtils.jsm">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calProviderUtils.jsm">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calProviderUtils.jsm">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calProviderUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calRecurrenceUtils.jsm">calendar/base/modules/calRecurrenceUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calRecurrenceUtils.jsm">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calRecurrenceUtils.jsm">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calRecurrenceUtils.jsm">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calRecurrenceUtils.jsm">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/modules/calRecurrenceUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calAlarm.js">calendar/base/src/calAlarm.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calAlarm.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calAlarm.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calAlarm.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calAlarm.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calAlarm.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calAlarmService.js">calendar/base/src/calAlarmService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calAlarmService.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calAlarmService.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calAlarmService.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calAlarmService.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calAlarmService.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calCalendarManager.js">calendar/base/src/calCalendarManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calCalendarManager.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calCalendarManager.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calCalendarManager.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calCalendarManager.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calCalendarManager.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calTransactionManager.js">calendar/base/src/calTransactionManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calTransactionManager.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calTransactionManager.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calTransactionManager.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calTransactionManager.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calTransactionManager.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calUtils.js">calendar/base/src/calUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calUtils.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calUtils.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calUtils.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calUtils.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/base/src/calUtils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/import-export/calOutlookCSVImportExport.js">calendar/import-export/calOutlookCSVImportExport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/import-export/calOutlookCSVImportExport.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/import-export/calOutlookCSVImportExport.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/import-export/calOutlookCSVImportExport.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/import-export/calOutlookCSVImportExport.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/import-export/calOutlookCSVImportExport.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/import-export/calWeekPrinter.js">calendar/import-export/calWeekPrinter.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/import-export/calWeekPrinter.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/import-export/calWeekPrinter.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/import-export/calWeekPrinter.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/import-export/calWeekPrinter.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/import-export/calWeekPrinter.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/imip-bar.js">calendar/lightning/content/imip-bar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/imip-bar.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/imip-bar.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/imip-bar.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/imip-bar.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/imip-bar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/lightning-item-iframe.js">calendar/lightning/content/lightning-item-iframe.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/lightning-item-iframe.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/lightning-item-iframe.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/lightning-item-iframe.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/lightning-item-iframe.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/lightning-item-iframe.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/lightning-item-panel.js">calendar/lightning/content/lightning-item-panel.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/lightning-item-panel.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/lightning-item-panel.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/lightning-item-panel.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/lightning-item-panel.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/lightning-item-panel.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/messenger-overlay-sidebar.js">calendar/lightning/content/messenger-overlay-sidebar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/messenger-overlay-sidebar.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/messenger-overlay-sidebar.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/messenger-overlay-sidebar.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/messenger-overlay-sidebar.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/messenger-overlay-sidebar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/suite-overlay-sidebar.js">calendar/lightning/content/suite-overlay-sidebar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/suite-overlay-sidebar.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/suite-overlay-sidebar.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/suite-overlay-sidebar.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/suite-overlay-sidebar.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/lightning/content/suite-overlay-sidebar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/caldav/calDavCalendar.js">calendar/providers/caldav/calDavCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/caldav/calDavCalendar.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/caldav/calDavCalendar.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/caldav/calDavCalendar.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/caldav/calDavCalendar.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/caldav/calDavCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/caldav/calDavRequestHandlers.js">calendar/providers/caldav/calDavRequestHandlers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/caldav/calDavRequestHandlers.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/caldav/calDavRequestHandlers.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/caldav/calDavRequestHandlers.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/caldav/calDavRequestHandlers.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/caldav/calDavRequestHandlers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/ics/calICSCalendar.js">calendar/providers/ics/calICSCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/ics/calICSCalendar.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/ics/calICSCalendar.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/ics/calICSCalendar.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/ics/calICSCalendar.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/ics/calICSCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/storage/calStorageCalendar.js">calendar/providers/storage/calStorageCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/storage/calStorageCalendar.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/storage/calStorageCalendar.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/storage/calStorageCalendar.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/storage/calStorageCalendar.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/storage/calStorageCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/storage/calStorageUpgrade.jsm">calendar/providers/storage/calStorageUpgrade.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/storage/calStorageUpgrade.jsm">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/storage/calStorageUpgrade.jsm">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/storage/calStorageUpgrade.jsm">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/storage/calStorageUpgrade.jsm">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/storage/calStorageUpgrade.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapCalendar.js">calendar/providers/wcap/calWcapCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapCalendar.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapCalendar.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapCalendar.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapCalendar.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapCalendarItems.js">calendar/providers/wcap/calWcapCalendarItems.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapCalendarItems.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapCalendarItems.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapCalendarItems.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapCalendarItems.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapCalendarItems.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapSession.js">calendar/providers/wcap/calWcapSession.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapSession.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapSession.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapSession.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapSession.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/providers/wcap/calWcapSession.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/resources/content/publish.js">calendar/resources/content/publish.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/resources/content/publish.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/resources/content/publish.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/resources/content/publish.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/resources/content/publish.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/resources/content/publish.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_alarm.js">calendar/test/unit/test_alarm.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_alarm.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_alarm.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_alarm.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_alarm.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_alarm.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_alarmutils.js">calendar/test/unit/test_alarmutils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_alarmutils.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_alarmutils.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_alarmutils.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_alarmutils.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_alarmutils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_attendee.js">calendar/test/unit/test_attendee.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_attendee.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_attendee.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_attendee.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_attendee.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_attendee.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_bug759324.js">calendar/test/unit/test_bug759324.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_bug759324.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_bug759324.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_bug759324.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_bug759324.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_bug759324.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_datetime_before_1970.js">calendar/test/unit/test_datetime_before_1970.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_datetime_before_1970.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_datetime_before_1970.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_datetime_before_1970.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_datetime_before_1970.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_datetime_before_1970.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_freebusy_service.js">calendar/test/unit/test_freebusy_service.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_freebusy_service.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_freebusy_service.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_freebusy_service.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_freebusy_service.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_freebusy_service.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_ics_parser.js">calendar/test/unit/test_ics_parser.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_ics_parser.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_ics_parser.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_ics_parser.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_ics_parser.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_ics_parser.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_ics_service.js">calendar/test/unit/test_ics_service.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_ics_service.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_ics_service.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_ics_service.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_ics_service.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_ics_service.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_items.js">calendar/test/unit/test_items.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_items.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_items.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_items.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_items.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_items.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_recur.js">calendar/test/unit/test_recur.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_recur.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_recur.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_recur.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_recur.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_recur.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_search_service.js">calendar/test/unit/test_search_service.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_search_service.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_search_service.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_search_service.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_search_service.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_search_service.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_weekinfo_service.js">calendar/test/unit/test_weekinfo_service.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_weekinfo_service.js">file</a> |
<a href="/comm-central/annotate/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_weekinfo_service.js">annotate</a> |
<a href="/comm-central/diff/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_weekinfo_service.js">diff</a> |
<a href="/comm-central/comparison/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_weekinfo_service.js">comparison</a> |
<a href="/comm-central/log/a7312b12f00f6b39084b768a6252669ed641d0b4/calendar/test/unit/test_weekinfo_service.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/.eslintrc</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/.eslintrc</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -157,16 +157,19 @@</span>
<a href="#l1.4"></a><span id="l1.4"> </span>
<a href="#l1.5"></a><span id="l1.5">     // Disallow use of comma operator.</span>
<a href="#l1.6"></a><span id="l1.6">     &quot;no-sequences&quot;: 2,</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8">     // Disallow use of assignment in return statement. It is preferable for a</span>
<a href="#l1.9"></a><span id="l1.9">     // single line of code to have only one easily predictable effect.</span>
<a href="#l1.10"></a><span id="l1.10">     &quot;no-return-assign&quot;: 2,</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+    // Disallow padding within blocks.</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    &quot;padded-blocks&quot;: [2, &quot;never&quot;],</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+</span>
<a href="#l1.15"></a><span id="l1.15">     // Will enable these rules later</span>
<a href="#l1.16"></a><span id="l1.16">     &quot;block-spacing&quot;: 0,</span>
<a href="#l1.17"></a><span id="l1.17">     &quot;no-lonely-if&quot;: 0,</span>
<a href="#l1.18"></a><span id="l1.18">     &quot;space-before-blocks&quot;: 0,</span>
<a href="#l1.19"></a><span id="l1.19">     &quot;computed-property-spacing&quot;: 0,</span>
<a href="#l1.20"></a><span id="l1.20">     &quot;consistent-return&quot;: 0,</span>
<a href="#l1.21"></a><span id="l1.21">     &quot;no-redeclare&quot;: 0,</span>
<a href="#l1.22"></a><span id="l1.22">     &quot;no-empty&quot;: 0,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/agenda-listbox.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/agenda-listbox.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -1125,17 +1125,16 @@ var gEventTimer;</span>
<a href="#l2.4"></a><span id="l2.4">  *  Pass in a function as aRefreshCallback that should be called at that time.</span>
<a href="#l2.5"></a><span id="l2.5">  *</span>
<a href="#l2.6"></a><span id="l2.6">  * @param aRefreshCallback      The function to call when the next event is</span>
<a href="#l2.7"></a><span id="l2.7">  *                                current.</span>
<a href="#l2.8"></a><span id="l2.8">  * @param aMsUntil              The number of milliseconds until the next event</span>
<a href="#l2.9"></a><span id="l2.9">  *                                is current.</span>
<a href="#l2.10"></a><span id="l2.10">  */</span>
<a href="#l2.11"></a><span id="l2.11"> function scheduleNextCurrentEventUpdate(aRefreshCallback, aMsUntil) {</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-</span>
<a href="#l2.13"></a><span id="l2.13">     // Is an nsITimer/callback extreme overkill here? Yes, but it's necessary to</span>
<a href="#l2.14"></a><span id="l2.14">     // workaround bug 291386.  If we don't, we stand a decent chance of getting</span>
<a href="#l2.15"></a><span id="l2.15">     // stuck in an infinite loop.</span>
<a href="#l2.16"></a><span id="l2.16">     var udCallback = {</span>
<a href="#l2.17"></a><span id="l2.17">         notify: function(timer) {</span>
<a href="#l2.18"></a><span id="l2.18">             aRefreshCallback();</span>
<a href="#l2.19"></a><span id="l2.19">         }</span>
<a href="#l2.20"></a><span id="l2.20">     };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/calendar-base-view.xml</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/calendar-base-view.xml</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -74,17 +74,16 @@</span>
<a href="#l3.4"></a><span id="l3.4">             onEndBatch: function onEndBatch() {</span>
<a href="#l3.5"></a><span id="l3.5">             },</span>
<a href="#l3.6"></a><span id="l3.6"> </span>
<a href="#l3.7"></a><span id="l3.7">             onLoad: function onLoad() {</span>
<a href="#l3.8"></a><span id="l3.8">                 this.calView.refresh();</span>
<a href="#l3.9"></a><span id="l3.9">             },</span>
<a href="#l3.10"></a><span id="l3.10"> </span>
<a href="#l3.11"></a><span id="l3.11">             onAddItem: function onAddItem(aItem) {</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-</span>
<a href="#l3.13"></a><span id="l3.13">                 if (cal.isToDo(aItem)) {</span>
<a href="#l3.14"></a><span id="l3.14">                     if (!aItem.entryDate &amp;&amp; !aItem.dueDate) {</span>
<a href="#l3.15"></a><span id="l3.15">                         return;</span>
<a href="#l3.16"></a><span id="l3.16">                     }</span>
<a href="#l3.17"></a><span id="l3.17">                     if (!this.calView.mTasksInView){</span>
<a href="#l3.18"></a><span id="l3.18">                         return;</span>
<a href="#l3.19"></a><span id="l3.19">                     }</span>
<a href="#l3.20"></a><span id="l3.20">                     if (aItem.isCompleted &amp;&amp; !this.calView.mShowCompleted) {</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineat">@@ -97,17 +96,16 @@</span>
<a href="#l3.22"></a><span id="l3.22">                                                        {});</span>
<a href="#l3.23"></a><span id="l3.23">                 for (let occ of occs) {</span>
<a href="#l3.24"></a><span id="l3.24">                     this.calView.doAddItem(occ);</span>
<a href="#l3.25"></a><span id="l3.25">                 }</span>
<a href="#l3.26"></a><span id="l3.26">                 return;</span>
<a href="#l3.27"></a><span id="l3.27">             },</span>
<a href="#l3.28"></a><span id="l3.28"> </span>
<a href="#l3.29"></a><span id="l3.29">             onModifyItem: function onModifyItem(aNewItem, aOldItem) {</span>
<a href="#l3.30"></a><span id="l3.30" class="difflineminus">-</span>
<a href="#l3.31"></a><span id="l3.31">                 if (cal.isToDo(aNewItem) &amp;&amp; cal.isToDo(aOldItem) &amp;&amp;</span>
<a href="#l3.32"></a><span id="l3.32">                     !this.calView.mTasksInView) {</span>
<a href="#l3.33"></a><span id="l3.33">                     return;</span>
<a href="#l3.34"></a><span id="l3.34">                 }</span>
<a href="#l3.35"></a><span id="l3.35">                 let occs;</span>
<a href="#l3.36"></a><span id="l3.36"> </span>
<a href="#l3.37"></a><span id="l3.37">                 if (!cal.isToDo(aOldItem) || aOldItem.entryDate || aOldItem.dueDate) {</span>
<a href="#l3.38"></a><span id="l3.38">                     occs = aOldItem.getOccurrencesBetween(this.calView.startDate,</span>
<a href="#l3.39"></a><span id="l3.39" class="difflineat">@@ -130,17 +128,16 @@</span>
<a href="#l3.40"></a><span id="l3.40">                                                       this.calView.queryEndDate,</span>
<a href="#l3.41"></a><span id="l3.41">                                                       {});</span>
<a href="#l3.42"></a><span id="l3.42">                 for (let occ of occs) {</span>
<a href="#l3.43"></a><span id="l3.43">                     this.calView.doAddItem(occ);</span>
<a href="#l3.44"></a><span id="l3.44">                 }</span>
<a href="#l3.45"></a><span id="l3.45">             },</span>
<a href="#l3.46"></a><span id="l3.46"> </span>
<a href="#l3.47"></a><span id="l3.47">             onDeleteItem: function onDeleteItem(aItem) {</span>
<a href="#l3.48"></a><span id="l3.48" class="difflineminus">-</span>
<a href="#l3.49"></a><span id="l3.49">                 if (cal.isToDo(aItem)) {</span>
<a href="#l3.50"></a><span id="l3.50">                     if (!this.calView.mTasksInView) {</span>
<a href="#l3.51"></a><span id="l3.51">                         return;</span>
<a href="#l3.52"></a><span id="l3.52">                     }</span>
<a href="#l3.53"></a><span id="l3.53">                     if (!aItem.entryDate &amp;&amp; !aItem.dueDate) {</span>
<a href="#l3.54"></a><span id="l3.54">                         return;</span>
<a href="#l3.55"></a><span id="l3.55">                     }</span>
<a href="#l3.56"></a><span id="l3.56">                     if (aItem.isCompleted &amp;&amp; !this.calView.mShowCompleted) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/calendar-item-editing.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/calendar-item-editing.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -87,17 +87,16 @@ function setDefaultItemValues(aItem, aCa</span>
<a href="#l4.4"></a><span id="l4.4">             } else {</span>
<a href="#l4.5"></a><span id="l4.5">                 // All day events need to go to the beginning of the next day.</span>
<a href="#l4.6"></a><span id="l4.6">                 aItem.endDate.day++;</span>
<a href="#l4.7"></a><span id="l4.7">             }</span>
<a href="#l4.8"></a><span id="l4.8">         }</span>
<a href="#l4.9"></a><span id="l4.9"> </span>
<a href="#l4.10"></a><span id="l4.10">         // Free/busy status is only valid for events, must not be set for tasks.</span>
<a href="#l4.11"></a><span id="l4.11">         aItem.setProperty(&quot;TRANSP&quot;, cal.getEventDefaultTransparency(aForceAllday));</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-</span>
<a href="#l4.13"></a><span id="l4.13">     } else if (cal.isToDo(aItem)) {</span>
<a href="#l4.14"></a><span id="l4.14">         let now = cal.now();</span>
<a href="#l4.15"></a><span id="l4.15">         let initDate = initialDate ? initialDate.clone() : now;</span>
<a href="#l4.16"></a><span id="l4.16">         initDate.isDate = false;</span>
<a href="#l4.17"></a><span id="l4.17">         initDate.hour = now.hour;</span>
<a href="#l4.18"></a><span id="l4.18">         initDate.minute = now.minute;</span>
<a href="#l4.19"></a><span id="l4.19">         initDate.second = now.second;</span>
<a href="#l4.20"></a><span id="l4.20"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/content/calendar-management.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/content/calendar-management.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -408,17 +408,16 @@ var calendarOfflineManager = {</span>
<a href="#l5.4"></a><span id="l5.4">             throw Components.results.NS_ERROR_NOT_INITIALIZED;</span>
<a href="#l5.5"></a><span id="l5.5">         }</span>
<a href="#l5.6"></a><span id="l5.6">         Services.obs.removeObserver(this, &quot;network:offline-status-changed&quot;, false);</span>
<a href="#l5.7"></a><span id="l5.7">         this.initialized = false;</span>
<a href="#l5.8"></a><span id="l5.8">     },</span>
<a href="#l5.9"></a><span id="l5.9"> </span>
<a href="#l5.10"></a><span id="l5.10">     isOnline: function cOM_isOnline() {</span>
<a href="#l5.11"></a><span id="l5.11">         return (!Services.io.offline);</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-</span>
<a href="#l5.13"></a><span id="l5.13">     },</span>
<a href="#l5.14"></a><span id="l5.14"> </span>
<a href="#l5.15"></a><span id="l5.15">     updateOfflineUI: function cOM_updateOfflineUI(aIsOffline) {</span>
<a href="#l5.16"></a><span id="l5.16">         // Refresh the current view</span>
<a href="#l5.17"></a><span id="l5.17">         currentView().goToDay(currentView().selectedDay);</span>
<a href="#l5.18"></a><span id="l5.18"> </span>
<a href="#l5.19"></a><span id="l5.19">         // Set up disabled locks for offline</span>
<a href="#l5.20"></a><span id="l5.20">         document.commandDispatcher.updateCommands(&quot;calendar_commands&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/content/calendar-month-view.xml</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/content/calendar-month-view.xml</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -679,17 +679,16 @@</span>
<a href="#l6.4"></a><span id="l6.4">           }</span>
<a href="#l6.5"></a><span id="l6.5"> </span>
<a href="#l6.6"></a><span id="l6.6">           // Check whether view range has been changed since last call to</span>
<a href="#l6.7"></a><span id="l6.7">           // relayout()</span>
<a href="#l6.8"></a><span id="l6.8">           if (!this.mViewStart || !this.mViewEnd ||</span>
<a href="#l6.9"></a><span id="l6.9">               this.mViewEnd.compare(viewEnd) != 0 ||</span>
<a href="#l6.10"></a><span id="l6.10">               this.mViewStart.compare(viewStart) != 0 ||</span>
<a href="#l6.11"></a><span id="l6.11">               this.mToggleStatus != toggleStatus) {</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-</span>
<a href="#l6.13"></a><span id="l6.13">               this.refresh();</span>
<a href="#l6.14"></a><span id="l6.14">           }</span>
<a href="#l6.15"></a><span id="l6.15"> </span>
<a href="#l6.16"></a><span id="l6.16">         ]]&gt;&lt;/body&gt;</span>
<a href="#l6.17"></a><span id="l6.17">       &lt;/method&gt;</span>
<a href="#l6.18"></a><span id="l6.18"> </span>
<a href="#l6.19"></a><span id="l6.19">       &lt;method name=&quot;getDateList&quot;&gt;</span>
<a href="#l6.20"></a><span id="l6.20">         &lt;parameter name=&quot;aCount&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -721,17 +721,16 @@</span>
<a href="#l7.4"></a><span id="l7.4">           stack.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l7.5"></a><span id="l7.5">           this.topbox.appendChild(stack);</span>
<a href="#l7.6"></a><span id="l7.6"> </span>
<a href="#l7.7"></a><span id="l7.7">           let boxToEdit;</span>
<a href="#l7.8"></a><span id="l7.8">           let columnCount = 1;</span>
<a href="#l7.9"></a><span id="l7.9">           let spanTotal = 0;</span>
<a href="#l7.10"></a><span id="l7.10"> </span>
<a href="#l7.11"></a><span id="l7.11">           for (let layer of this.mEventMap) {</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-</span>
<a href="#l7.13"></a><span id="l7.13">               // The event-map (this.mEventMap) contains an array of layers.</span>
<a href="#l7.14"></a><span id="l7.14">               // For each layer we create a box below the stack just created above.</span>
<a href="#l7.15"></a><span id="l7.15">               // So each different layer lives in a box that's contained in the stack.</span>
<a href="#l7.16"></a><span id="l7.16">               let xulColumn = createXULElement(&quot;box&quot;);</span>
<a href="#l7.17"></a><span id="l7.17">               xulColumn.setAttribute(&quot;orient&quot;, otherorient);</span>
<a href="#l7.18"></a><span id="l7.18">               xulColumn.setAttribute(&quot;flex&quot;, &quot;1&quot;);</span>
<a href="#l7.19"></a><span id="l7.19">               xulColumn.setAttribute(&quot;style&quot;, &quot;min-width: 1px; min-height: 1px;&quot;);</span>
<a href="#l7.20"></a><span id="l7.20">               stack.appendChild(xulColumn);</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineat">@@ -781,17 +780,16 @@</span>
<a href="#l7.22"></a><span id="l7.22">                                                 this.getAttribute(&quot;item-context&quot;) ||</span>
<a href="#l7.23"></a><span id="l7.23">                                                   this.getAttribute(&quot;context&quot;));</span>
<a href="#l7.24"></a><span id="l7.24">                           chunkBox.setAttribute(&quot;orient&quot;, orient);</span>
<a href="#l7.25"></a><span id="l7.25"> </span>
<a href="#l7.26"></a><span id="l7.26">                           // Set the gripBars visibility in the chunk. Keep it</span>
<a href="#l7.27"></a><span id="l7.27">                           // hidden for tasks with only entry date OR due date.</span>
<a href="#l7.28"></a><span id="l7.28">                           if ((chunk.event.entryDate || !chunk.event.dueDate) &amp;&amp;</span>
<a href="#l7.29"></a><span id="l7.29">                               (!chunk.event.entryDate || chunk.event.dueDate)) {</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineminus">-</span>
<a href="#l7.31"></a><span id="l7.31">                               let startGripVisible = (chunk.event.startDate || chunk.event.entryDate)</span>
<a href="#l7.32"></a><span id="l7.32">                                                          .compare(chunk.startDate) == 0;</span>
<a href="#l7.33"></a><span id="l7.33">                               let endGripVisible = (chunk.event.endDate || chunk.event.dueDate)</span>
<a href="#l7.34"></a><span id="l7.34">                                                        .compare(chunk.endDate) &lt;= 0;</span>
<a href="#l7.35"></a><span id="l7.35">                               if (startGripVisible &amp;&amp; endGripVisible) {</span>
<a href="#l7.36"></a><span id="l7.36">                                   chunkBox.setAttribute(&quot;gripBars&quot;, &quot;both&quot;);</span>
<a href="#l7.37"></a><span id="l7.37">                               } else if (endGripVisible) {</span>
<a href="#l7.38"></a><span id="l7.38">                                   chunkBox.setAttribute(&quot;gripBars&quot;, &quot;end&quot;);</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineat">@@ -1117,22 +1115,20 @@</span>
<a href="#l7.40"></a><span id="l7.40">           //   columns won't actually have the same size, but will only all</span>
<a href="#l7.41"></a><span id="l7.41">           //   be multiples of a common size.  See the note in the relayout</span>
<a href="#l7.42"></a><span id="l7.42">           //   function for more info on this (fairly rare) case.</span>
<a href="#l7.43"></a><span id="l7.43">           var layers = [];</span>
<a href="#l7.44"></a><span id="l7.44"> </span>
<a href="#l7.45"></a><span id="l7.45">           // When we start a new blob, move to a new set of layers</span>
<a href="#l7.46"></a><span id="l7.46">           var layerOffset = 0;</span>
<a href="#l7.47"></a><span id="l7.47">           for (var glob of aBlobs) {</span>
<a href="#l7.48"></a><span id="l7.48" class="difflineminus">-</span>
<a href="#l7.49"></a><span id="l7.49">               var layerArray = [];</span>
<a href="#l7.50"></a><span id="l7.50">               var layerCounter = 1;</span>
<a href="#l7.51"></a><span id="l7.51"> </span>
<a href="#l7.52"></a><span id="l7.52">               for (var data of glob.blob) {</span>
<a href="#l7.53"></a><span id="l7.53" class="difflineminus">-</span>
<a href="#l7.54"></a><span id="l7.54">                   // from the item at hand we need to figure out on which</span>
<a href="#l7.55"></a><span id="l7.55">                   // layer and on which column it should go.</span>
<a href="#l7.56"></a><span id="l7.56">                   var layerIndex;</span>
<a href="#l7.57"></a><span id="l7.57">                   var specialSpan = null;</span>
<a href="#l7.58"></a><span id="l7.58"> </span>
<a href="#l7.59"></a><span id="l7.59">                   // each blob receives its own layer, that's the first part of the story. within</span>
<a href="#l7.60"></a><span id="l7.60">                   // a given blob we need to distribute the items on different layers depending on</span>
<a href="#l7.61"></a><span id="l7.61">                   // the number of columns each item spans. if each item just spans a single column</span>
<a href="#l7.62"></a><span id="l7.62" class="difflineat">@@ -1446,17 +1442,16 @@</span>
<a href="#l7.63"></a><span id="l7.63"> </span>
<a href="#l7.64"></a><span id="l7.64">           // If we leave the view, then stop our internal sweeping and start a</span>
<a href="#l7.65"></a><span id="l7.65">           // real drag session. Someday we need to fix the sweep to soely be a</span>
<a href="#l7.66"></a><span id="l7.66">           // drag session, no sweeping.</span>
<a href="#l7.67"></a><span id="l7.67">           if (event.clientX &lt; (event.target.boxObject.x) ||</span>
<a href="#l7.68"></a><span id="l7.68">               event.clientX &gt; (event.target.boxObject.x + event.target.boxObject.width) ||</span>
<a href="#l7.69"></a><span id="l7.69">               event.clientY &lt; (event.target.boxObject.y) ||</span>
<a href="#l7.70"></a><span id="l7.70">               event.clientY &gt; (event.target.boxObject.y + event.target.boxObject.height)) {</span>
<a href="#l7.71"></a><span id="l7.71" class="difflineminus">-</span>
<a href="#l7.72"></a><span id="l7.72">               // Remove the drag state</span>
<a href="#l7.73"></a><span id="l7.73">               for (let column = firstCol, i = firstIndex;</span>
<a href="#l7.74"></a><span id="l7.74">                    column &amp;&amp; i &lt; col.mDragState.shadows;</span>
<a href="#l7.75"></a><span id="l7.75">                    column = column.nextSibling, i++) {</span>
<a href="#l7.76"></a><span id="l7.76">                   column.fgboxes.dragbox.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l7.77"></a><span id="l7.77">                   column.fgboxes.box.removeAttribute(&quot;dragging&quot;);</span>
<a href="#l7.78"></a><span id="l7.78">               }</span>
<a href="#l7.79"></a><span id="l7.79"> </span>
<a href="#l7.80"></a><span id="l7.80" class="difflineat">@@ -1860,17 +1855,16 @@</span>
<a href="#l7.81"></a><span id="l7.81">               this.mDragState.offset = shadowElements.offset;</span>
<a href="#l7.82"></a><span id="l7.82">               this.updateShadowsBoxes(this.mDragState.origMin, this.mDragState.endMin,</span>
<a href="#l7.83"></a><span id="l7.83">                                       0, this.mDragState.shadows,</span>
<a href="#l7.84"></a><span id="l7.84">                                       sizeattr);</span>
<a href="#l7.85"></a><span id="l7.85"> </span>
<a href="#l7.86"></a><span id="l7.86">               // update drag labels</span>
<a href="#l7.87"></a><span id="l7.87">               let lastCol = this.firstLastShadowColumns().lastCol;</span>
<a href="#l7.88"></a><span id="l7.88">               this.updateDragLabels(this, lastCol);</span>
<a href="#l7.89"></a><span id="l7.89" class="difflineminus">-</span>
<a href="#l7.90"></a><span id="l7.90">           } else if (aGrabbedElement == &quot;end&quot;) {</span>
<a href="#l7.91"></a><span id="l7.91">               this.mDragState.dragType = &quot;modify-end&quot;;</span>
<a href="#l7.92"></a><span id="l7.92">               // we have to use &quot;realStart&quot; as fixed end value</span>
<a href="#l7.93"></a><span id="l7.93">               this.mDragState.limitStartMin = mins.realStart;</span>
<a href="#l7.94"></a><span id="l7.94"> </span>
<a href="#l7.95"></a><span id="l7.95">               // snap end</span>
<a href="#l7.96"></a><span id="l7.96">               this.mDragState.origMin = Math.floor(mins.end / snapIntMin) * snapIntMin;</span>
<a href="#l7.97"></a><span id="l7.97"> </span>
<a href="#l7.98"></a><span id="l7.98" class="difflineat">@@ -1883,17 +1877,16 @@</span>
<a href="#l7.99"></a><span id="l7.99">               this.mDragState.offset = shadowElements.offset;</span>
<a href="#l7.100"></a><span id="l7.100">               this.updateShadowsBoxes(this.mDragState.startMin, this.mDragState.endMin,</span>
<a href="#l7.101"></a><span id="l7.101">                                       shadowElements.offset, this.mDragState.shadows,</span>
<a href="#l7.102"></a><span id="l7.102">                                       sizeattr);</span>
<a href="#l7.103"></a><span id="l7.103"> </span>
<a href="#l7.104"></a><span id="l7.104">               // update drag labels</span>
<a href="#l7.105"></a><span id="l7.105">               let firstCol = this.firstLastShadowColumns().firstCol;</span>
<a href="#l7.106"></a><span id="l7.106">               this.updateDragLabels(firstCol, this);</span>
<a href="#l7.107"></a><span id="l7.107" class="difflineminus">-</span>
<a href="#l7.108"></a><span id="l7.108">           } else if (aGrabbedElement == &quot;middle&quot;) {</span>
<a href="#l7.109"></a><span id="l7.109">               this.mDragState.dragType = &quot;move&quot;;</span>
<a href="#l7.110"></a><span id="l7.110">               // in a move, origMin will be the start minute of the element where</span>
<a href="#l7.111"></a><span id="l7.111">               // the drag occurs. Along with mouseOffset, it allows to track the</span>
<a href="#l7.112"></a><span id="l7.112">               // shadow position. origMinStart and origMinEnd allow to figure out</span>
<a href="#l7.113"></a><span id="l7.113">               // the real shadow size.</span>
<a href="#l7.114"></a><span id="l7.114">               // We snap to the start and add the real duration to find the end</span>
<a href="#l7.115"></a><span id="l7.115">               let limitDurationMin = mins.realEnd - mins.realStart;</span>
<a href="#l7.116"></a><span id="l7.116" class="difflineat">@@ -1993,18 +1986,17 @@</span>
<a href="#l7.117"></a><span id="l7.117">         &lt;parameter name=&quot;aDayStartMin&quot;/&gt;</span>
<a href="#l7.118"></a><span id="l7.118">         &lt;parameter name=&quot;aDayEndMin&quot;/&gt;</span>
<a href="#l7.119"></a><span id="l7.119">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l7.120"></a><span id="l7.120">           if (aDayStartMin &lt; this.mStartMin || aDayStartMin &gt; aDayEndMin ||</span>
<a href="#l7.121"></a><span id="l7.121">             aDayEndMin &gt; this.mEndMin) {</span>
<a href="#l7.122"></a><span id="l7.122">             throw Components.results.NS_ERROR_INVALID_ARG;</span>
<a href="#l7.123"></a><span id="l7.123">           }</span>
<a href="#l7.124"></a><span id="l7.124">           if (this.mDayStartMin != aDayStartMin ||</span>
<a href="#l7.125"></a><span id="l7.125" class="difflineminus">-            this.mDayEndMin != aDayEndMin) {</span>
<a href="#l7.126"></a><span id="l7.126" class="difflineminus">-</span>
<a href="#l7.127"></a><span id="l7.127" class="difflineplus">+              this.mDayEndMin != aDayEndMin) {</span>
<a href="#l7.128"></a><span id="l7.128">             this.mDayStartMin = aDayStartMin;</span>
<a href="#l7.129"></a><span id="l7.129">             this.mDayEndMin = aDayEndMin;</span>
<a href="#l7.130"></a><span id="l7.130">           }</span>
<a href="#l7.131"></a><span id="l7.131">         ]]&gt;&lt;/body&gt;</span>
<a href="#l7.132"></a><span id="l7.132">       &lt;/method&gt;</span>
<a href="#l7.133"></a><span id="l7.133"> </span>
<a href="#l7.134"></a><span id="l7.134">       &lt;method name=&quot;getClickedDateTime&quot;&gt;</span>
<a href="#l7.135"></a><span id="l7.135">         &lt;parameter name=&quot;event&quot;/&gt;</span>
<a href="#l7.136"></a><span id="l7.136" class="difflineat">@@ -2192,17 +2184,16 @@</span>
<a href="#l7.137"></a><span id="l7.137"> </span>
<a href="#l7.138"></a><span id="l7.138">       &lt;method name=&quot;selectOccurrence&quot;&gt;</span>
<a href="#l7.139"></a><span id="l7.139">         &lt;parameter name=&quot;aItem&quot;/&gt;</span>
<a href="#l7.140"></a><span id="l7.140">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l7.141"></a><span id="l7.141">           for (let itemBox of this.mItemBoxes) {</span>
<a href="#l7.142"></a><span id="l7.142">             if (aItem &amp;&amp; (itemBox.occurrence.hashId == aItem.hashId)) {</span>
<a href="#l7.143"></a><span id="l7.143">               itemBox.selected = true;</span>
<a href="#l7.144"></a><span id="l7.144">             }</span>
<a href="#l7.145"></a><span id="l7.145" class="difflineminus">-</span>
<a href="#l7.146"></a><span id="l7.146">           }</span>
<a href="#l7.147"></a><span id="l7.147">         ]]&gt;&lt;/body&gt;</span>
<a href="#l7.148"></a><span id="l7.148">       &lt;/method&gt;</span>
<a href="#l7.149"></a><span id="l7.149">       &lt;method name=&quot;unselectOccurrence&quot;&gt;</span>
<a href="#l7.150"></a><span id="l7.150">         &lt;parameter name=&quot;aItem&quot;/&gt;</span>
<a href="#l7.151"></a><span id="l7.151">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l7.152"></a><span id="l7.152">           for (let itemBox of this.mItemBoxes) {</span>
<a href="#l7.153"></a><span id="l7.153">             if (aItem &amp;&amp; (itemBox.occurrence.hashId == aItem.hashId)) {</span>
<a href="#l7.154"></a><span id="l7.154" class="difflineat">@@ -2911,20 +2902,18 @@</span>
<a href="#l7.155"></a><span id="l7.155">           }</span>
<a href="#l7.156"></a><span id="l7.156"> </span>
<a href="#l7.157"></a><span id="l7.157">           // Check whether view range has been changed since last call to</span>
<a href="#l7.158"></a><span id="l7.158">           // relayout()</span>
<a href="#l7.159"></a><span id="l7.159">           if (!this.mViewStart || !this.mViewEnd ||</span>
<a href="#l7.160"></a><span id="l7.160">               this.mViewEnd.compare(viewEnd) != 0 ||</span>
<a href="#l7.161"></a><span id="l7.161">               this.mViewStart.compare(viewStart) != 0 ||</span>
<a href="#l7.162"></a><span id="l7.162">               this.mToggleStatus != toggleStatus) {</span>
<a href="#l7.163"></a><span id="l7.163" class="difflineminus">-</span>
<a href="#l7.164"></a><span id="l7.164">               this.refresh();</span>
<a href="#l7.165"></a><span id="l7.165">           }</span>
<a href="#l7.166"></a><span id="l7.166" class="difflineminus">-</span>
<a href="#l7.167"></a><span id="l7.167">         ]]&gt;&lt;/body&gt;</span>
<a href="#l7.168"></a><span id="l7.168">       &lt;/method&gt;</span>
<a href="#l7.169"></a><span id="l7.169"> </span>
<a href="#l7.170"></a><span id="l7.170">       &lt;method name=&quot;getDateList&quot;&gt;</span>
<a href="#l7.171"></a><span id="l7.171">         &lt;parameter name=&quot;aCount&quot;/&gt;</span>
<a href="#l7.172"></a><span id="l7.172">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l7.173"></a><span id="l7.173">            let dates = [];</span>
<a href="#l7.174"></a><span id="l7.174">            if (this.mStartDate &amp;&amp; this.mEndDate) {</span>
<a href="#l7.175"></a><span id="l7.175" class="difflineat">@@ -3795,18 +3784,17 @@</span>
<a href="#l7.176"></a><span id="l7.176">         &lt;parameter name=&quot;aDayStartMin&quot;/&gt;</span>
<a href="#l7.177"></a><span id="l7.177">         &lt;parameter name=&quot;aDayEndMin&quot;/&gt;</span>
<a href="#l7.178"></a><span id="l7.178">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l7.179"></a><span id="l7.179">           if (aDayStartMin &lt; this.mStartMin || aDayStartMin &gt; aDayEndMin ||</span>
<a href="#l7.180"></a><span id="l7.180">             aDayEndMin &gt; this.mEndMin) {</span>
<a href="#l7.181"></a><span id="l7.181">             throw Components.results.NS_ERROR_INVALID_ARG;</span>
<a href="#l7.182"></a><span id="l7.182">           }</span>
<a href="#l7.183"></a><span id="l7.183">           if (this.mDayStartMin != aDayStartMin ||</span>
<a href="#l7.184"></a><span id="l7.184" class="difflineminus">-            this.mDayEndMin != aDayEndMin) {</span>
<a href="#l7.185"></a><span id="l7.185" class="difflineminus">-</span>
<a href="#l7.186"></a><span id="l7.186" class="difflineplus">+              this.mDayEndMin != aDayEndMin) {</span>
<a href="#l7.187"></a><span id="l7.187">             this.mDayStartMin = aDayStartMin;</span>
<a href="#l7.188"></a><span id="l7.188">             this.mDayEndMin = aDayEndMin;</span>
<a href="#l7.189"></a><span id="l7.189"> </span>
<a href="#l7.190"></a><span id="l7.190">             // Also update on the time-bar</span>
<a href="#l7.191"></a><span id="l7.191">             document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;timebar&quot;)</span>
<a href="#l7.192"></a><span id="l7.192">                     .setDayStartEndHours(this.mDayStartMin / 60,</span>
<a href="#l7.193"></a><span id="l7.193">                                          this.mDayEndMin / 60);</span>
<a href="#l7.194"></a><span id="l7.194">           }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/content/calendar-task-view.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-view.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -10,30 +10,28 @@ var taskDetailsView = {</span>
<a href="#l8.4"></a><span id="l8.4"> </span>
<a href="#l8.5"></a><span id="l8.5">     /**</span>
<a href="#l8.6"></a><span id="l8.6">      * Task Details Events</span>
<a href="#l8.7"></a><span id="l8.7">      *</span>
<a href="#l8.8"></a><span id="l8.8">      * XXXberend Please document this function, possibly also consolidate since</span>
<a href="#l8.9"></a><span id="l8.9">      * its the only function in taskDetailsView.</span>
<a href="#l8.10"></a><span id="l8.10">      */</span>
<a href="#l8.11"></a><span id="l8.11">     onSelect: function tDV_onSelect(event) {</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-</span>
<a href="#l8.13"></a><span id="l8.13">         var dateFormatter =</span>
<a href="#l8.14"></a><span id="l8.14">             Components.classes[&quot;@mozilla.org/calendar/datetime-formatter;1&quot;]</span>
<a href="#l8.15"></a><span id="l8.15">             .getService(Components.interfaces.calIDateTimeFormatter);</span>
<a href="#l8.16"></a><span id="l8.16"> </span>
<a href="#l8.17"></a><span id="l8.17">         function displayElement(id, flag) {</span>
<a href="#l8.18"></a><span id="l8.18">             setBooleanAttribute(id, &quot;hidden&quot;, !flag);</span>
<a href="#l8.19"></a><span id="l8.19">             return flag;</span>
<a href="#l8.20"></a><span id="l8.20">         }</span>
<a href="#l8.21"></a><span id="l8.21"> </span>
<a href="#l8.22"></a><span id="l8.22">         var item = document.getElementById(&quot;calendar-task-tree&quot;).currentTask;</span>
<a href="#l8.23"></a><span id="l8.23">         if (displayElement(&quot;calendar-task-details-container&quot;, item != null) &amp;&amp;</span>
<a href="#l8.24"></a><span id="l8.24">             displayElement(&quot;calendar-task-view-splitter&quot;, item != null)) {</span>
<a href="#l8.25"></a><span id="l8.25" class="difflineminus">-</span>
<a href="#l8.26"></a><span id="l8.26">             displayElement(&quot;calendar-task-details-title-row&quot;, true);</span>
<a href="#l8.27"></a><span id="l8.27">             document.getElementById(&quot;calendar-task-details-title&quot;).textContent =</span>
<a href="#l8.28"></a><span id="l8.28">                 (item.title ? item.title.replace(/\n/g, ' ') : &quot;&quot;);</span>
<a href="#l8.29"></a><span id="l8.29"> </span>
<a href="#l8.30"></a><span id="l8.30">             var organizer = item.organizer;</span>
<a href="#l8.31"></a><span id="l8.31">             if (displayElement(&quot;calendar-task-details-organizer-row&quot;, organizer != null)) {</span>
<a href="#l8.32"></a><span id="l8.32">                 var name = organizer.commonName;</span>
<a href="#l8.33"></a><span id="l8.33">                 if (!name || name.length &lt;= 0) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/base/content/calendar-ui-utils.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/base/content/calendar-ui-utils.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -142,17 +142,16 @@ function disableElement(aElement) {</span>
<a href="#l9.4"></a><span id="l9.4">  * the given key (lockId). In case the control should be</span>
<a href="#l9.5"></a><span id="l9.5">  * enabled again the lock gets removed, but the control only</span>
<a href="#l9.6"></a><span id="l9.6">  * gets enabled if *all* possibly held locks have been removed.</span>
<a href="#l9.7"></a><span id="l9.7">  *</span>
<a href="#l9.8"></a><span id="l9.8">  * @param elementId     The element ID of the element to disable.</span>
<a href="#l9.9"></a><span id="l9.9">  * @param lockId        The ID of the lock to set.</span>
<a href="#l9.10"></a><span id="l9.10">  */</span>
<a href="#l9.11"></a><span id="l9.11"> function disableElementWithLock(elementId, lockId) {</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-</span>
<a href="#l9.13"></a><span id="l9.13">     // unconditionally disable the element.</span>
<a href="#l9.14"></a><span id="l9.14">     disableElement(elementId);</span>
<a href="#l9.15"></a><span id="l9.15"> </span>
<a href="#l9.16"></a><span id="l9.16">     // remember that this element has been locked with</span>
<a href="#l9.17"></a><span id="l9.17">     // the key passed as argument. we keep a primitive</span>
<a href="#l9.18"></a><span id="l9.18">     // form of ref-count in the attribute 'lock'.</span>
<a href="#l9.19"></a><span id="l9.19">     var element = document.getElementById(elementId);</span>
<a href="#l9.20"></a><span id="l9.20">     if (element) {</span>
<a href="#l9.21"></a><span id="l9.21" class="difflineat">@@ -169,17 +168,16 @@ function disableElementWithLock(elementI</span>
<a href="#l9.22"></a><span id="l9.22">  * above defined function 'disableElementWithLock()'.</span>
<a href="#l9.23"></a><span id="l9.23">  * See the respective comment for further details.</span>
<a href="#l9.24"></a><span id="l9.24">  *</span>
<a href="#l9.25"></a><span id="l9.25">  * @see disableElementWithLock</span>
<a href="#l9.26"></a><span id="l9.26">  * @param elementId     The element ID of the element to enable.</span>
<a href="#l9.27"></a><span id="l9.27">  * @param lockId        The ID of the lock to set.</span>
<a href="#l9.28"></a><span id="l9.28">  */</span>
<a href="#l9.29"></a><span id="l9.29"> function enableElementWithLock(elementId, lockId) {</span>
<a href="#l9.30"></a><span id="l9.30" class="difflineminus">-</span>
<a href="#l9.31"></a><span id="l9.31">     var element = document.getElementById(elementId);</span>
<a href="#l9.32"></a><span id="l9.32">     if (!element) {</span>
<a href="#l9.33"></a><span id="l9.33">         dump(&quot;unable to find &quot; + elementId + &quot;\n&quot;);</span>
<a href="#l9.34"></a><span id="l9.34">         return;</span>
<a href="#l9.35"></a><span id="l9.35">     }</span>
<a href="#l9.36"></a><span id="l9.36"> </span>
<a href="#l9.37"></a><span id="l9.37">     if (element.hasAttribute(lockId)) {</span>
<a href="#l9.38"></a><span id="l9.38">         element.removeAttribute(lockId);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/base/content/calendar-views.js</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/base/content/calendar-views.js</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -22,17 +22,16 @@ var calendarViewController = {</span>
<a href="#l10.4"></a><span id="l10.4">         return this;</span>
<a href="#l10.5"></a><span id="l10.5">     },</span>
<a href="#l10.6"></a><span id="l10.6"> </span>
<a href="#l10.7"></a><span id="l10.7">     /**</span>
<a href="#l10.8"></a><span id="l10.8">      * Creates a new event</span>
<a href="#l10.9"></a><span id="l10.9">      * @see calICalendarViewController</span>
<a href="#l10.10"></a><span id="l10.10">      */</span>
<a href="#l10.11"></a><span id="l10.11">     createNewEvent: function (aCalendar, aStartTime, aEndTime, aForceAllday) {</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-</span>
<a href="#l10.13"></a><span id="l10.13">         // if we're given both times, skip the dialog</span>
<a href="#l10.14"></a><span id="l10.14">         if (aStartTime &amp;&amp; aEndTime &amp;&amp; !aStartTime.isDate &amp;&amp; !aEndTime.isDate) {</span>
<a href="#l10.15"></a><span id="l10.15">             let item = cal.createEvent();</span>
<a href="#l10.16"></a><span id="l10.16">             setDefaultItemValues(item, aCalendar, aStartTime, aEndTime);</span>
<a href="#l10.17"></a><span id="l10.17">             item.title = calGetString(&quot;calendar&quot;, &quot;newEvent&quot;);</span>
<a href="#l10.18"></a><span id="l10.18">             doTransaction('add', item, item.calendar, null, null);</span>
<a href="#l10.19"></a><span id="l10.19">         } else {</span>
<a href="#l10.20"></a><span id="l10.20">             createEventWithDialog(aCalendar, aStartTime, null, null, null, aForceAllday);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-alarm-dialog.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-alarm-dialog.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -296,17 +296,16 @@ function removeWidgetFor(aItem, aAlarm) </span>
<a href="#l11.4"></a><span id="l11.4">     let hashId = aItem.hashId;</span>
<a href="#l11.5"></a><span id="l11.5">     let alarmRichlist = document.getElementById(&quot;alarm-richlist&quot;);</span>
<a href="#l11.6"></a><span id="l11.6">     let nodes = alarmRichlist.childNodes;</span>
<a href="#l11.7"></a><span id="l11.7">     let notfound = true;</span>
<a href="#l11.8"></a><span id="l11.8">     for (let i = nodes.length - 1; notfound &amp;&amp; i &gt;= 0; --i) {</span>
<a href="#l11.9"></a><span id="l11.9">         let widget = nodes[i];</span>
<a href="#l11.10"></a><span id="l11.10">         if (widget.item &amp;&amp; widget.item.hashId == hashId &amp;&amp;</span>
<a href="#l11.11"></a><span id="l11.11">             widget.alarm &amp;&amp; widget.alarm.icalString == aAlarm.icalString) {</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-</span>
<a href="#l11.13"></a><span id="l11.13">             if (widget.selected) {</span>
<a href="#l11.14"></a><span id="l11.14">                 // Advance selection if needed</span>
<a href="#l11.15"></a><span id="l11.15">                 widget.control.selectedItem = widget.previousSibling ||</span>
<a href="#l11.16"></a><span id="l11.16">                                               widget.nextSibling;</span>
<a href="#l11.17"></a><span id="l11.17">             }</span>
<a href="#l11.18"></a><span id="l11.18"> </span>
<a href="#l11.19"></a><span id="l11.19">             widget.removeEventListener(&quot;snooze&quot;, onSnoozeAlarm, false);</span>
<a href="#l11.20"></a><span id="l11.20">             widget.removeEventListener(&quot;dismiss&quot;, onDismissAlarm, false);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-dialog-utils.js</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-dialog-utils.js</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -549,21 +549,20 @@ function updateLink() {</span>
<a href="#l12.4"></a><span id="l12.4">         }, 0);</span>
<a href="#l12.5"></a><span id="l12.5">     }</span>
<a href="#l12.6"></a><span id="l12.6"> }</span>
<a href="#l12.7"></a><span id="l12.7"> </span>
<a href="#l12.8"></a><span id="l12.8"> /*</span>
<a href="#l12.9"></a><span id="l12.9">  * setup attendees in event and summary dialog</span>
<a href="#l12.10"></a><span id="l12.10">  */</span>
<a href="#l12.11"></a><span id="l12.11"> function setupAttendees() {</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-</span>
<a href="#l12.13"></a><span id="l12.13">     let attBox = document.getElementById(&quot;item-attendees-box&quot;);</span>
<a href="#l12.14"></a><span id="l12.14">     let attBoxRows = attBox.getElementsByClassName(&quot;item-attendees-row&quot;);</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+</span>
<a href="#l12.16"></a><span id="l12.16">     if (window.attendees &amp;&amp; window.attendees.length &gt; 0) {</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineminus">-</span>
<a href="#l12.18"></a><span id="l12.18">         // cloning of the template nodes</span>
<a href="#l12.19"></a><span id="l12.19">         let selector = &quot;#item-attendees-box-template .item-attendees-row&quot;;</span>
<a href="#l12.20"></a><span id="l12.20">         let clonedRow = document.querySelector(selector).cloneNode(false);</span>
<a href="#l12.21"></a><span id="l12.21">         selector = &quot;#item-attendees-box-template .item-attendees-row box:nth-of-type(1)&quot;;</span>
<a href="#l12.22"></a><span id="l12.22">         let clonedCell = document.querySelector(selector).cloneNode(true);</span>
<a href="#l12.23"></a><span id="l12.23">         selector = &quot;#item-attendees-box-template .item-attendees-row box:nth-of-type(2)&quot;;</span>
<a href="#l12.24"></a><span id="l12.24">         let clonedSpacer = document.querySelector(selector).cloneNode(false);</span>
<a href="#l12.25"></a><span id="l12.25"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -477,17 +477,16 @@</span>
<a href="#l13.4"></a><span id="l13.4">               try {</span>
<a href="#l13.5"></a><span id="l13.5">                 abDir = allAddressBooks.getNext()</span>
<a href="#l13.6"></a><span id="l13.6">                                   .QueryInterface(Components.interfaces.nsIAbDirectory);</span>
<a href="#l13.7"></a><span id="l13.7">               } catch (ex) {</span>
<a href="#l13.8"></a><span id="l13.8">                 cal.WARN(&quot;[eventDialog] Error Encountered&quot; + ex);</span>
<a href="#l13.9"></a><span id="l13.9">               }</span>
<a href="#l13.10"></a><span id="l13.10"> </span>
<a href="#l13.11"></a><span id="l13.11">               if (abDir != null &amp;&amp; abDir.supportsMailingLists) {</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-</span>
<a href="#l13.13"></a><span id="l13.13">                 let childNodes = abDir.childNodes;</span>
<a href="#l13.14"></a><span id="l13.14">                 while (childNodes.hasMoreElements()) {</span>
<a href="#l13.15"></a><span id="l13.15">                   let dir = null;</span>
<a href="#l13.16"></a><span id="l13.16">                   try {</span>
<a href="#l13.17"></a><span id="l13.17">                     dir = childNodes.getNext().QueryInterface(Components.interfaces.nsIAbDirectory);</span>
<a href="#l13.18"></a><span id="l13.18">                   } catch (ex) {</span>
<a href="#l13.19"></a><span id="l13.19">                     cal.WARN(&quot;[eventDialog] Error Encountered&quot; + ex);</span>
<a href="#l13.20"></a><span id="l13.20">                   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -179,28 +179,25 @@</span>
<a href="#l14.4"></a><span id="l14.4">           start.second = 0;</span>
<a href="#l14.5"></a><span id="l14.5">           var end = start.clone();</span>
<a href="#l14.6"></a><span id="l14.6">           end.month++;</span>
<a href="#l14.7"></a><span id="l14.7"> </span>
<a href="#l14.8"></a><span id="l14.8">           // the 'minimonth' controls are arranged in a</span>
<a href="#l14.9"></a><span id="l14.9">           // grid, sorted by rows first -&gt; iterate the rows that may exist.</span>
<a href="#l14.10"></a><span id="l14.10">           var row = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;row&quot;);</span>
<a href="#l14.11"></a><span id="l14.11">           while (row) {</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-</span>
<a href="#l14.13"></a><span id="l14.13">               // now iterater all the child nodes of this row</span>
<a href="#l14.14"></a><span id="l14.14">               // in order to visit each minimonth in turn.</span>
<a href="#l14.15"></a><span id="l14.15">               var numChilds = row.childNodes.length - 1;</span>
<a href="#l14.16"></a><span id="l14.16">               for (var i = 0; i &lt; numChilds; i++) {</span>
<a href="#l14.17"></a><span id="l14.17" class="difflineminus">-</span>
<a href="#l14.18"></a><span id="l14.18">                   // we now have one of the minimonth controls while 'start'</span>
<a href="#l14.19"></a><span id="l14.19">                   // and 'end' are set to the interval this minimonth shows.</span>
<a href="#l14.20"></a><span id="l14.20">                   var minimonth = row.childNodes[i];</span>
<a href="#l14.21"></a><span id="l14.21">                   minimonth.showMonth(cal.dateTimeToJsDate(start));</span>
<a href="#l14.22"></a><span id="l14.22">                   if (aRecurrenceInfo) {</span>
<a href="#l14.23"></a><span id="l14.23" class="difflineminus">-</span>
<a href="#l14.24"></a><span id="l14.24">                       // retrieve an array of dates that represents all occurrences</span>
<a href="#l14.25"></a><span id="l14.25">                       // that fall into this time interval [start,end[.</span>
<a href="#l14.26"></a><span id="l14.26">                       // note: the following loop assumes that this array conains</span>
<a href="#l14.27"></a><span id="l14.27">                       // dates that are strictly monotonically increasing.</span>
<a href="#l14.28"></a><span id="l14.28">                       // should getOccurrenceDates() not enforce this assumption we</span>
<a href="#l14.29"></a><span id="l14.29">                       // need to fall back to some different algorithm.</span>
<a href="#l14.30"></a><span id="l14.30">                       var dates = aRecurrenceInfo.getOccurrenceDates(start, end, 0, {});</span>
<a href="#l14.31"></a><span id="l14.31"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-print-dialog.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-print-dialog.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -244,17 +244,16 @@ function refreshHtml(finishFunc) {</span>
<a href="#l15.4"></a><span id="l15.4"> }</span>
<a href="#l15.5"></a><span id="l15.5"> </span>
<a href="#l15.6"></a><span id="l15.6"> /**</span>
<a href="#l15.7"></a><span id="l15.7">  * This is a nsIWebProgressListener that closes the dialog on completion, makes</span>
<a href="#l15.8"></a><span id="l15.8">  * sure printing works without issues</span>
<a href="#l15.9"></a><span id="l15.9">  */</span>
<a href="#l15.10"></a><span id="l15.10"> var closeOnComplete = {</span>
<a href="#l15.11"></a><span id="l15.11">     onStateChange: function onStateChange(aProgress, aRequest, aStateFlags, aStatus) {</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-</span>
<a href="#l15.13"></a><span id="l15.13">         if (aStateFlags &amp; Components.interfaces.nsIWebProgressListener.STATE_STOP) {</span>
<a href="#l15.14"></a><span id="l15.14">             // The request is complete, close the window.</span>
<a href="#l15.15"></a><span id="l15.15">             document.documentElement.cancelDialog();</span>
<a href="#l15.16"></a><span id="l15.16">         }</span>
<a href="#l15.17"></a><span id="l15.17">     },</span>
<a href="#l15.18"></a><span id="l15.18"> </span>
<a href="#l15.19"></a><span id="l15.19">     onProgressChange: function() {},</span>
<a href="#l15.20"></a><span id="l15.20">     onLocationChange: function() {},</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-summary-dialog.js</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-summary-dialog.js</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -19,23 +19,21 @@ function onLoad() {</span>
<a href="#l16.4"></a><span id="l16.4"> </span>
<a href="#l16.5"></a><span id="l16.5">     // the calling entity provides us with an object that is responsible</span>
<a href="#l16.6"></a><span id="l16.6">     // for recording details about the initiated modification. the 'finalize'-property</span>
<a href="#l16.7"></a><span id="l16.7">     // is our hook in order to receive a notification in case the operation needs</span>
<a href="#l16.8"></a><span id="l16.8">     // to be terminated prematurely. this function will be called if the calling</span>
<a href="#l16.9"></a><span id="l16.9">     // entity needs to immediately terminate the pending modification. in this</span>
<a href="#l16.10"></a><span id="l16.10">     // case we serialize the item and close the window.</span>
<a href="#l16.11"></a><span id="l16.11">     if (args.job) {</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-</span>
<a href="#l16.13"></a><span id="l16.13">         // keep this context...</span>
<a href="#l16.14"></a><span id="l16.14">         var self = this;</span>
<a href="#l16.15"></a><span id="l16.15"> </span>
<a href="#l16.16"></a><span id="l16.16">         // store the 'finalize'-functor in the provided job-object.</span>
<a href="#l16.17"></a><span id="l16.17">         args.job.finalize = function finalize() {</span>
<a href="#l16.18"></a><span id="l16.18" class="difflineminus">-</span>
<a href="#l16.19"></a><span id="l16.19">             // store any pending modifications...</span>
<a href="#l16.20"></a><span id="l16.20">             self.onAccept();</span>
<a href="#l16.21"></a><span id="l16.21"> </span>
<a href="#l16.22"></a><span id="l16.22">             let item = window.calendarItem;</span>
<a href="#l16.23"></a><span id="l16.23"> </span>
<a href="#l16.24"></a><span id="l16.24">             // ...and close the window.</span>
<a href="#l16.25"></a><span id="l16.25">             window.close();</span>
<a href="#l16.26"></a><span id="l16.26"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/calendar/base/content/import-export.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/calendar/base/content/import-export.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -60,17 +60,16 @@ function loadEventsFromFile(aCalendar) {</span>
<a href="#l17.4"></a><span id="l17.4">             currentListLength++;</span>
<a href="#l17.5"></a><span id="l17.5">         }</span>
<a href="#l17.6"></a><span id="l17.6">     }</span>
<a href="#l17.7"></a><span id="l17.7"> </span>
<a href="#l17.8"></a><span id="l17.8">     let rv = fp.show();</span>
<a href="#l17.9"></a><span id="l17.9"> </span>
<a href="#l17.10"></a><span id="l17.10">     if (rv != nsIFilePicker.returnCancel &amp;&amp;</span>
<a href="#l17.11"></a><span id="l17.11">         fp.file &amp;&amp; fp.file.path &amp;&amp; fp.file.path.length &gt; 0) {</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-</span>
<a href="#l17.13"></a><span id="l17.13">         let filterIndex = fp.filterIndex;</span>
<a href="#l17.14"></a><span id="l17.14">         if (fp.filterIndex &lt; 0 || fp.filterIndex &gt; contractids.length) {</span>
<a href="#l17.15"></a><span id="l17.15">             // For some reason the wrong filter was selected, assume default extension</span>
<a href="#l17.16"></a><span id="l17.16">             filterIndex = defaultCIDIndex;</span>
<a href="#l17.17"></a><span id="l17.17">         }</span>
<a href="#l17.18"></a><span id="l17.18"> </span>
<a href="#l17.19"></a><span id="l17.19">         let filePath = fp.file.path;</span>
<a href="#l17.20"></a><span id="l17.20">         let importer = Components.classes[contractids[filterIndex]]</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/calendar/base/content/widgets/calendar-list-tree.xml</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/calendar/base/content/widgets/calendar-list-tree.xml</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -598,17 +598,16 @@</span>
<a href="#l18.4"></a><span id="l18.4">               // If we have a client point, get the row directly from the client</span>
<a href="#l18.5"></a><span id="l18.5">               // point.</span>
<a href="#l18.6"></a><span id="l18.6">               aRow = aRow || {};</span>
<a href="#l18.7"></a><span id="l18.7">               this.treebox.getCellAt(event.clientX,</span>
<a href="#l18.8"></a><span id="l18.8">                                      event.clientY,</span>
<a href="#l18.9"></a><span id="l18.9">                                      aRow,</span>
<a href="#l18.10"></a><span id="l18.10">                                      aCol || {},</span>
<a href="#l18.11"></a><span id="l18.11">                                      {});</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-</span>
<a href="#l18.13"></a><span id="l18.13">           } else {</span>
<a href="#l18.14"></a><span id="l18.14">               // Otherwise, we can try to get the context calendar from the popupNode.</span>
<a href="#l18.15"></a><span id="l18.15">               if (document.popupNode &amp;&amp; document.popupNode.contextCalendar) {</span>
<a href="#l18.16"></a><span id="l18.16">                   return document.popupNode.contextCalendar;</span>
<a href="#l18.17"></a><span id="l18.17">               }</span>
<a href="#l18.18"></a><span id="l18.18">           }</span>
<a href="#l18.19"></a><span id="l18.19">           return aRow &amp;&amp; aRow.value &gt; -1 &amp;&amp; this.mCalendarList[aRow.value];</span>
<a href="#l18.20"></a><span id="l18.20">         ]]&gt;&lt;/body&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/calendar/base/modules/calAuthUtils.jsm</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/calendar/base/modules/calAuthUtils.jsm</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -33,17 +33,16 @@ cal.auth = {</span>
<a href="#l19.4"></a><span id="l19.4">      * @return  Could a password be retrieved?</span>
<a href="#l19.5"></a><span id="l19.5">      */</span>
<a href="#l19.6"></a><span id="l19.6">     getCredentials: function calGetCredentials(aTitle,</span>
<a href="#l19.7"></a><span id="l19.7">                                                aCalendarName,</span>
<a href="#l19.8"></a><span id="l19.8">                                                aUsername,</span>
<a href="#l19.9"></a><span id="l19.9">                                                aPassword,</span>
<a href="#l19.10"></a><span id="l19.10">                                                aSavePassword,</span>
<a href="#l19.11"></a><span id="l19.11">                                                aFixedUsername) {</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-</span>
<a href="#l19.13"></a><span id="l19.13">         if (typeof aUsername != &quot;object&quot; ||</span>
<a href="#l19.14"></a><span id="l19.14">             typeof aPassword != &quot;object&quot; ||</span>
<a href="#l19.15"></a><span id="l19.15">             typeof aSavePassword != &quot;object&quot;) {</span>
<a href="#l19.16"></a><span id="l19.16">             throw new Components.Exception(&quot;&quot;, Components.results.NS_ERROR_XPC_NEED_OUT_OBJECT);</span>
<a href="#l19.17"></a><span id="l19.17">         }</span>
<a href="#l19.18"></a><span id="l19.18"> </span>
<a href="#l19.19"></a><span id="l19.19">         let prompter = Services.ww.getNewPrompter(null);</span>
<a href="#l19.20"></a><span id="l19.20"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/calendar/base/modules/calExtract.jsm</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/calendar/base/modules/calExtract.jsm</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -370,17 +370,16 @@ Extractor.prototype = {</span>
<a href="#l20.4"></a><span id="l20.4">             while ((res = re.exec(this.email)) != null) {</span>
<a href="#l20.5"></a><span id="l20.5">                 if (!this.limitNums(res, this.email) &amp;&amp; !this.limitChars(res, this.email)) {</span>
<a href="#l20.6"></a><span id="l20.6">                     let day = parseInt(res[positions[1]], 10);</span>
<a href="#l20.7"></a><span id="l20.7">                     let month = parseInt(res[positions[2]], 10);</span>
<a href="#l20.8"></a><span id="l20.8">                     let year = parseInt(this.normalizeYear(res[positions[3]]), 10);</span>
<a href="#l20.9"></a><span id="l20.9"> </span>
<a href="#l20.10"></a><span id="l20.10">                     if (this.isValidDay(day) &amp;&amp; this.isValidMonth(month) &amp;&amp;</span>
<a href="#l20.11"></a><span id="l20.11">                         this.isValidYear(year)) {</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-</span>
<a href="#l20.13"></a><span id="l20.13">                         let rev = this.prefixSuffixStartEnd(res, relation, this.email);</span>
<a href="#l20.14"></a><span id="l20.14">                         this.guess(year, month, day, null, null,</span>
<a href="#l20.15"></a><span id="l20.15">                                    rev.start, rev.end, rev.pattern, rev.relation, pattern);</span>
<a href="#l20.16"></a><span id="l20.16">                     }</span>
<a href="#l20.17"></a><span id="l20.17">                 }</span>
<a href="#l20.18"></a><span id="l20.18">             }</span>
<a href="#l20.19"></a><span id="l20.19">         }</span>
<a href="#l20.20"></a><span id="l20.20">     },</span>
<a href="#l20.21"></a><span id="l20.21" class="difflineat">@@ -706,17 +705,16 @@ Extractor.prototype = {</span>
<a href="#l20.22"></a><span id="l20.22">                 // included but not exactly the same</span>
<a href="#l20.23"></a><span id="l20.23">                 if (outer != inner &amp;&amp;</span>
<a href="#l20.24"></a><span id="l20.24">                     this.collected[outer].start &amp;&amp; this.collected[outer].end &amp;&amp;</span>
<a href="#l20.25"></a><span id="l20.25">                     this.collected[inner].start &amp;&amp; this.collected[inner].end &amp;&amp;</span>
<a href="#l20.26"></a><span id="l20.26">                     this.collected[inner].start &gt;= this.collected[outer].start &amp;&amp;</span>
<a href="#l20.27"></a><span id="l20.27">                     this.collected[inner].end &lt;= this.collected[outer].end &amp;&amp;</span>
<a href="#l20.28"></a><span id="l20.28">                     !(this.collected[inner].start == this.collected[outer].start &amp;&amp;</span>
<a href="#l20.29"></a><span id="l20.29">                         this.collected[inner].end == this.collected[outer].end)) {</span>
<a href="#l20.30"></a><span id="l20.30" class="difflineminus">-</span>
<a href="#l20.31"></a><span id="l20.31">                         cal.LOG(&quot;[calExtract] &quot; + this.collected[outer].str + &quot; found as well, disgarding &quot; + this.collected[inner].str);</span>
<a href="#l20.32"></a><span id="l20.32">                         this.collected[inner].relation = &quot;notadatetime&quot;;</span>
<a href="#l20.33"></a><span id="l20.33">                 }</span>
<a href="#l20.34"></a><span id="l20.34">             }</span>
<a href="#l20.35"></a><span id="l20.35">         }</span>
<a href="#l20.36"></a><span id="l20.36">     },</span>
<a href="#l20.37"></a><span id="l20.37"> </span>
<a href="#l20.38"></a><span id="l20.38">     markSelected: function markSelected(sel, title) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/calendar/base/modules/calItipUtils.jsm</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/calendar/base/modules/calItipUtils.jsm</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -264,17 +264,16 @@ cal.itip = {</span>
<a href="#l21.4"></a><span id="l21.4">                 }</span>
<a href="#l21.5"></a><span id="l21.5">                 if (delTime) {</span>
<a href="#l21.6"></a><span id="l21.6">                     data.label = _gs(&quot;imipBarReplyToRecentlyRemovedItem&quot;, [delTime.toString()]);</span>
<a href="#l21.7"></a><span id="l21.7">                 } else {</span>
<a href="#l21.8"></a><span id="l21.8">                     data.label = _gs(&quot;imipBarReplyToNotExistingItem&quot;);</span>
<a href="#l21.9"></a><span id="l21.9">                 }</span>
<a href="#l21.10"></a><span id="l21.10">             }</span>
<a href="#l21.11"></a><span id="l21.11">         } else if (Components.isSuccessCode(rc)) {</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-</span>
<a href="#l21.13"></a><span id="l21.13">             cal.LOG(&quot;iTIP options on: &quot; + actionFunc.method);</span>
<a href="#l21.14"></a><span id="l21.14">             switch (actionFunc.method) {</span>
<a href="#l21.15"></a><span id="l21.15">                 case &quot;REPLY&quot;:</span>
<a href="#l21.16"></a><span id="l21.16">                     // fall-thru intended</span>
<a href="#l21.17"></a><span id="l21.17">                 case &quot;PUBLISH:UPDATE&quot;:</span>
<a href="#l21.18"></a><span id="l21.18">                 case &quot;REQUEST:UPDATE-MINOR&quot;:</span>
<a href="#l21.19"></a><span id="l21.19">                     data.label = _gs(&quot;imipBarUpdateText&quot;);</span>
<a href="#l21.20"></a><span id="l21.20">                     data.buttons.push(&quot;imipUpdateButton&quot;);</span>
<a href="#l21.21"></a><span id="l21.21" class="difflineat">@@ -541,17 +540,16 @@ cal.itip = {</span>
<a href="#l21.22"></a><span id="l21.22"> </span>
<a href="#l21.23"></a><span id="l21.23">     /**</span>
<a href="#l21.24"></a><span id="l21.24">      * Scope: iTIP message sender</span>
<a href="#l21.25"></a><span id="l21.25">      *</span>
<a href="#l21.26"></a><span id="l21.26">      * Checks to see if e.g. attendees were added/removed or an item has been</span>
<a href="#l21.27"></a><span id="l21.27">      * deleted and sends out appropriate iTIP messages.</span>
<a href="#l21.28"></a><span id="l21.28">      */</span>
<a href="#l21.29"></a><span id="l21.29">     checkAndSend: function cal_itip_checkAndSend(aOpType, aItem, aOriginalItem) {</span>
<a href="#l21.30"></a><span id="l21.30" class="difflineminus">-</span>
<a href="#l21.31"></a><span id="l21.31">         // balance out parts of the modification vs delete confusion, deletion of occurrences</span>
<a href="#l21.32"></a><span id="l21.32">         // are notified as parent modifications and modifications of occurrences are notified</span>
<a href="#l21.33"></a><span id="l21.33">         // as mixed new-occurrence, old-parent (IIRC).</span>
<a href="#l21.34"></a><span id="l21.34">         if (aOriginalItem &amp;&amp; aItem.recurrenceInfo) {</span>
<a href="#l21.35"></a><span id="l21.35">             if (aOriginalItem.recurrenceId &amp;&amp; !aItem.recurrenceId) {</span>
<a href="#l21.36"></a><span id="l21.36">                 // sanity check: assure aItem doesn't refer to the master</span>
<a href="#l21.37"></a><span id="l21.37">                 aItem = aItem.recurrenceInfo.getOccurrenceFor(aOriginalItem.recurrenceId);</span>
<a href="#l21.38"></a><span id="l21.38">                 cal.ASSERT(aItem, &quot;unexpected!&quot;);</span>
<a href="#l21.39"></a><span id="l21.39" class="difflineat">@@ -560,17 +558,16 @@ cal.itip = {</span>
<a href="#l21.40"></a><span id="l21.40">                 }</span>
<a href="#l21.41"></a><span id="l21.41">             }</span>
<a href="#l21.42"></a><span id="l21.42"> </span>
<a href="#l21.43"></a><span id="l21.43">             if (aOriginalItem.recurrenceInfo &amp;&amp; aItem.recurrenceInfo) {</span>
<a href="#l21.44"></a><span id="l21.44">                 // check whether the two differ only in EXDATEs</span>
<a href="#l21.45"></a><span id="l21.45">                 let clonedItem = aItem.clone();</span>
<a href="#l21.46"></a><span id="l21.46">                 let exdates = [];</span>
<a href="#l21.47"></a><span id="l21.47">                 for (let ritem of clonedItem.recurrenceInfo.getRecurrenceItems({})) {</span>
<a href="#l21.48"></a><span id="l21.48" class="difflineminus">-</span>
<a href="#l21.49"></a><span id="l21.49">                     let wrappedRItem = cal.wrapInstance(ritem, Components.interfaces.calIRecurrenceDate);</span>
<a href="#l21.50"></a><span id="l21.50">                     if (ritem.isNegative &amp;&amp;</span>
<a href="#l21.51"></a><span id="l21.51">                         wrappedRItem &amp;&amp;</span>
<a href="#l21.52"></a><span id="l21.52">                         !aOriginalItem.recurrenceInfo.getRecurrenceItems({}).some(</span>
<a href="#l21.53"></a><span id="l21.53">                             function(r) {</span>
<a href="#l21.54"></a><span id="l21.54">                                 let wrappedR = cal.wrapInstance(r, Components.interfaces.calIRecurrenceDate);</span>
<a href="#l21.55"></a><span id="l21.55">                                 return (r.isNegative &amp;&amp;</span>
<a href="#l21.56"></a><span id="l21.56">                                         wrappedR &amp;&amp;</span>
<a href="#l21.57"></a><span id="l21.57" class="difflineat">@@ -669,17 +666,16 @@ cal.itip = {</span>
<a href="#l21.58"></a><span id="l21.58">         if (aItem.getProperty(&quot;X-MOZ-SEND-INVITATIONS&quot;) != &quot;TRUE&quot;) { // Only send invitations/cancellations</span>
<a href="#l21.59"></a><span id="l21.59">                                                                      // if the user checked the checkbox</span>
<a href="#l21.60"></a><span id="l21.60">             return;</span>
<a href="#l21.61"></a><span id="l21.61">         }</span>
<a href="#l21.62"></a><span id="l21.62"> </span>
<a href="#l21.63"></a><span id="l21.63">         // special handling for invitation with event status cancelled</span>
<a href="#l21.64"></a><span id="l21.64">         if (aItem.getAttendees({}).length &gt; 0 &amp;&amp;</span>
<a href="#l21.65"></a><span id="l21.65">             aItem.getProperty(&quot;STATUS&quot;) == &quot;CANCELLED&quot;) {</span>
<a href="#l21.66"></a><span id="l21.66" class="difflineminus">-</span>
<a href="#l21.67"></a><span id="l21.67">             if (cal.itip.getSequence(aItem) &gt; 0) {</span>
<a href="#l21.68"></a><span id="l21.68">                 // make sure we send a cancellation and not an request</span>
<a href="#l21.69"></a><span id="l21.69">                 aOpType = Components.interfaces.calIOperationListener.DELETE;</span>
<a href="#l21.70"></a><span id="l21.70">             } else {</span>
<a href="#l21.71"></a><span id="l21.71">                 // don't send an invitation, if the event was newly created and has status cancelled</span>
<a href="#l21.72"></a><span id="l21.72">                 return;</span>
<a href="#l21.73"></a><span id="l21.73">             }</span>
<a href="#l21.74"></a><span id="l21.74">         }</span>
<a href="#l21.75"></a><span id="l21.75" class="difflineat">@@ -716,23 +712,21 @@ cal.itip = {</span>
<a href="#l21.76"></a><span id="l21.76">             }</span>
<a href="#l21.77"></a><span id="l21.77">         }</span>
<a href="#l21.78"></a><span id="l21.78"> </span>
<a href="#l21.79"></a><span id="l21.79">         // setting default value to control for sending (cancellation) messages</span>
<a href="#l21.80"></a><span id="l21.80">         // this will be set to false, once the user cancels sending manually</span>
<a href="#l21.81"></a><span id="l21.81">         let sendOut = true;</span>
<a href="#l21.82"></a><span id="l21.82">         // Check to see if some part of the item was updated, if so, re-send REQUEST</span>
<a href="#l21.83"></a><span id="l21.83">         if (!aOriginalItem || (cal.itip.compare(aItem, aOriginalItem) &gt; 0)) { // REQUEST</span>
<a href="#l21.84"></a><span id="l21.84" class="difflineminus">-</span>
<a href="#l21.85"></a><span id="l21.85">             // check whether it's a simple UPDATE (no SEQUENCE change) or real (RE)REQUEST,</span>
<a href="#l21.86"></a><span id="l21.86">             // in case of time or location/description change.</span>
<a href="#l21.87"></a><span id="l21.87">             let isMinorUpdate = (aOriginalItem &amp;&amp; (cal.itip.getSequence(aItem) == cal.itip.getSequence(aOriginalItem)));</span>
<a href="#l21.88"></a><span id="l21.88"> </span>
<a href="#l21.89"></a><span id="l21.89">             if (!isMinorUpdate || !cal.compareItemContent(stripUserData(aItem), stripUserData(aOriginalItem))) {</span>
<a href="#l21.90"></a><span id="l21.90" class="difflineminus">-</span>
<a href="#l21.91"></a><span id="l21.91">                 let requestItem = aItem.clone();</span>
<a href="#l21.92"></a><span id="l21.92">                 if (!requestItem.organizer) {</span>
<a href="#l21.93"></a><span id="l21.93">                     requestItem.organizer = createOrganizer(requestItem.calendar);</span>
<a href="#l21.94"></a><span id="l21.94">                 }</span>
<a href="#l21.95"></a><span id="l21.95"> </span>
<a href="#l21.96"></a><span id="l21.96">                 // Fix up our attendees for invitations using some good defaults</span>
<a href="#l21.97"></a><span id="l21.97">                 let recipients = [];</span>
<a href="#l21.98"></a><span id="l21.98">                 let itemAtt = requestItem.getAttendees({});</span>
<a href="#l21.99"></a><span id="l21.99" class="difflineat">@@ -761,17 +755,16 @@ cal.itip = {</span>
<a href="#l21.100"></a><span id="l21.100">                     addedAttendees.length &gt; 0 &amp;&amp;</span>
<a href="#l21.101"></a><span id="l21.101">                     Preferences.get(&quot;calendar.itip.updateInvitationForNewAttendeesOnly&quot;, false)) {</span>
<a href="#l21.102"></a><span id="l21.102">                     recipients = addedAttendees;</span>
<a href="#l21.103"></a><span id="l21.103">                 }</span>
<a href="#l21.104"></a><span id="l21.104"> </span>
<a href="#l21.105"></a><span id="l21.105">                 if (recipients.length &gt; 0) {</span>
<a href="#l21.106"></a><span id="l21.106">                     sendOut = sendMessage(requestItem, &quot;REQUEST&quot;, recipients, autoResponse);</span>
<a href="#l21.107"></a><span id="l21.107">                 }</span>
<a href="#l21.108"></a><span id="l21.108" class="difflineminus">-</span>
<a href="#l21.109"></a><span id="l21.109">             }</span>
<a href="#l21.110"></a><span id="l21.110">         }</span>
<a href="#l21.111"></a><span id="l21.111"> </span>
<a href="#l21.112"></a><span id="l21.112">         // Cancel the event for all canceled attendees</span>
<a href="#l21.113"></a><span id="l21.113">         if (canceledAttendees.length &gt; 0) {</span>
<a href="#l21.114"></a><span id="l21.114">             let cancelItem = aOriginalItem.clone();</span>
<a href="#l21.115"></a><span id="l21.115">             cancelItem.removeAllAttendees();</span>
<a href="#l21.116"></a><span id="l21.116">             for (let att of canceledAttendees) {</span>
<a href="#l21.117"></a><span id="l21.117" class="difflineat">@@ -843,17 +836,16 @@ cal.itip = {</span>
<a href="#l21.118"></a><span id="l21.118">      * Returns a copy of an itipItem with modified properties and items build from scratch</span>
<a href="#l21.119"></a><span id="l21.119">      * Use itipItem.clone() instead if only a simple copy is required</span>
<a href="#l21.120"></a><span id="l21.120">      *</span>
<a href="#l21.121"></a><span id="l21.121">      * @param aItipItem     ItipItem to derive a new one from</span>
<a href="#l21.122"></a><span id="l21.122">      * @param aItems        List of items to be contained in the new itipItem</span>
<a href="#l21.123"></a><span id="l21.123">      * @param aProps        List of properties to be different in the new itipItem</span>
<a href="#l21.124"></a><span id="l21.124">      */</span>
<a href="#l21.125"></a><span id="l21.125">     getModifiedItipItem: function cal_getModifiedItipItem(aItipItem, aItems, aProps) {</span>
<a href="#l21.126"></a><span id="l21.126" class="difflineminus">-</span>
<a href="#l21.127"></a><span id="l21.127">         let itipItem = Components.classes[&quot;@mozilla.org/calendar/itip-item;1&quot;]</span>
<a href="#l21.128"></a><span id="l21.128">                                  .createInstance(Components.interfaces.calIItipItem);</span>
<a href="#l21.129"></a><span id="l21.129">         let serializedItems = &quot;&quot;;</span>
<a href="#l21.130"></a><span id="l21.130">         for (let item of (aItems || [])) {</span>
<a href="#l21.131"></a><span id="l21.131">             serializedItems += cal.getSerializedItem(item)</span>
<a href="#l21.132"></a><span id="l21.132">         }</span>
<a href="#l21.133"></a><span id="l21.133">         itipItem.init(serializedItems);</span>
<a href="#l21.134"></a><span id="l21.134"> </span>
<a href="#l21.135"></a><span id="l21.135" class="difflineat">@@ -872,17 +864,16 @@ cal.itip = {</span>
<a href="#l21.136"></a><span id="l21.136"> </span>
<a href="#l21.137"></a><span id="l21.137"> /** local to this module file</span>
<a href="#l21.138"></a><span id="l21.138">  * Sets the received info either on the passed attendee or item object.</span>
<a href="#l21.139"></a><span id="l21.139">  *</span>
<a href="#l21.140"></a><span id="l21.140">  * @param item either  calIAttendee or calIItemBase</span>
<a href="#l21.141"></a><span id="l21.141">  * @param itipItemItem received iTIP item</span>
<a href="#l21.142"></a><span id="l21.142">  */</span>
<a href="#l21.143"></a><span id="l21.143"> function setReceivedInfo(item, itipItemItem) {</span>
<a href="#l21.144"></a><span id="l21.144" class="difflineminus">-</span>
<a href="#l21.145"></a><span id="l21.145">     let wrappedItem = cal.wrapInstance(item, Components.interfaces.calIAttendee);</span>
<a href="#l21.146"></a><span id="l21.146">     item.setProperty(wrappedItem ? &quot;RECEIVED-SEQUENCE&quot;</span>
<a href="#l21.147"></a><span id="l21.147">                                  : &quot;X-MOZ-RECEIVED-SEQUENCE&quot;,</span>
<a href="#l21.148"></a><span id="l21.148">                                  String(cal.itip.getSequence(itipItemItem)));</span>
<a href="#l21.149"></a><span id="l21.149">     let dtstamp = cal.itip.getStamp(itipItemItem);</span>
<a href="#l21.150"></a><span id="l21.150">     if (dtstamp) {</span>
<a href="#l21.151"></a><span id="l21.151">         item.setProperty(wrappedItem ? &quot;RECEIVED-DTSTAMP&quot;</span>
<a href="#l21.152"></a><span id="l21.152">                                      : &quot;X-MOZ-RECEIVED-DTSTAMP&quot;,</span>
<a href="#l21.153"></a><span id="l21.153" class="difflineat">@@ -1354,33 +1345,31 @@ ItipItemFinder.prototype = {</span>
<a href="#l21.154"></a><span id="l21.154">                                             // If the the user hasn't responded to the invitation yet and we</span>
<a href="#l21.155"></a><span id="l21.155">                                             // are viewing the current representation of the item, show the</span>
<a href="#l21.156"></a><span id="l21.156">                                             // accept/decline buttons. This means newer events will show the</span>
<a href="#l21.157"></a><span id="l21.157">                                             // &quot;Update&quot; button and older events will show the &quot;already</span>
<a href="#l21.158"></a><span id="l21.158">                                             // processed&quot; text.</span>
<a href="#l21.159"></a><span id="l21.159">                                             if (foundAttendee.participationStatus == &quot;NEEDS-ACTION&quot; &amp;&amp;</span>
<a href="#l21.160"></a><span id="l21.160">                                                 (item.calendar.getProperty(&quot;itip.disableRevisionChecks&quot;) ||</span>
<a href="#l21.161"></a><span id="l21.161">                                                  cal.itip.compare(itipItemItem, item) == 0)) {</span>
<a href="#l21.162"></a><span id="l21.162" class="difflineminus">-</span>
<a href="#l21.163"></a><span id="l21.163">                                                 actionMethod = &quot;REQUEST:NEEDS-ACTION&quot;;</span>
<a href="#l21.164"></a><span id="l21.164">                                                 operations.push(function(opListener, partStat) {</span>
<a href="#l21.165"></a><span id="l21.165">                                                     let changedItem = firstFoundItem.clone();</span>
<a href="#l21.166"></a><span id="l21.166">                                                     changedItem.removeAttendee(foundAttendee);</span>
<a href="#l21.167"></a><span id="l21.167">                                                     foundAttendee = foundAttendee.clone();</span>
<a href="#l21.168"></a><span id="l21.168">                                                     if (partStat) {</span>
<a href="#l21.169"></a><span id="l21.169">                                                         foundAttendee.participationStatus = partStat;</span>
<a href="#l21.170"></a><span id="l21.170">                                                     }</span>
<a href="#l21.171"></a><span id="l21.171">                                                     changedItem.addAttendee(foundAttendee);</span>
<a href="#l21.172"></a><span id="l21.172"> </span>
<a href="#l21.173"></a><span id="l21.173">                                                     return changedItem.calendar.modifyItem(</span>
<a href="#l21.174"></a><span id="l21.174">                                                         changedItem, firstFoundItem, new ItipOpListener(opListener, firstFoundItem));</span>
<a href="#l21.175"></a><span id="l21.175">                                                 });</span>
<a href="#l21.176"></a><span id="l21.176">                                             } else if (item.calendar.getProperty(&quot;itip.disableRevisionChecks&quot;) ||</span>
<a href="#l21.177"></a><span id="l21.177">                                                        cal.itip.compare(itipItemItem, item) &gt; 0) {</span>
<a href="#l21.178"></a><span id="l21.178" class="difflineminus">-</span>
<a href="#l21.179"></a><span id="l21.179">                                                 addScheduleAgentClient(newItem, item.calendar);</span>
<a href="#l21.180"></a><span id="l21.180"> </span>
<a href="#l21.181"></a><span id="l21.181">                                                 let isMinorUpdate = (cal.itip.getSequence(newItem) ==</span>
<a href="#l21.182"></a><span id="l21.182">                                                                      cal.itip.getSequence(item));</span>
<a href="#l21.183"></a><span id="l21.183">                                                 actionMethod = (isMinorUpdate ? method + &quot;:UPDATE-MINOR&quot;</span>
<a href="#l21.184"></a><span id="l21.184">                                                                               : method + &quot;:UPDATE&quot;);</span>
<a href="#l21.185"></a><span id="l21.185">                                                 operations.push(function(opListener, partStat) {</span>
<a href="#l21.186"></a><span id="l21.186">                                                     if (!partStat) { // keep PARTSTAT</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/calendar/base/modules/calProviderUtils.jsm</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/calendar/base/modules/calProviderUtils.jsm</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -250,17 +250,16 @@ cal.getEmailIdentityOfCalendar = functio</span>
<a href="#l22.4"></a><span id="l22.4">             });</span>
<a href="#l22.5"></a><span id="l22.5">         if (!identity) {</span>
<a href="#l22.6"></a><span id="l22.6">             // dangling identity:</span>
<a href="#l22.7"></a><span id="l22.7">             cal.WARN(&quot;Calendar &quot; + (aCalendar.uri ? aCalendar.uri.spec : aCalendar.id) +</span>
<a href="#l22.8"></a><span id="l22.8">                      &quot; has a dangling E-Mail identity configured.&quot;);</span>
<a href="#l22.9"></a><span id="l22.9">         }</span>
<a href="#l22.10"></a><span id="l22.10">         return identity;</span>
<a href="#l22.11"></a><span id="l22.11">     } else { // take default account/identity:</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-</span>
<a href="#l22.13"></a><span id="l22.13">         let accounts = MailServices.accounts.accounts;</span>
<a href="#l22.14"></a><span id="l22.14">         let account = null;</span>
<a href="#l22.15"></a><span id="l22.15">         let identity = null;</span>
<a href="#l22.16"></a><span id="l22.16">         try {</span>
<a href="#l22.17"></a><span id="l22.17">             account = MailServices.accounts.defaultAccount;</span>
<a href="#l22.18"></a><span id="l22.18">         } catch (exc) {}</span>
<a href="#l22.19"></a><span id="l22.19"> </span>
<a href="#l22.20"></a><span id="l22.20">         for (let i = 0; accounts &amp;&amp; (i &lt; accounts.length) &amp;&amp; (!account || !identity); ++i) {</span>
<a href="#l22.21"></a><span id="l22.21" class="difflineat">@@ -299,17 +298,16 @@ cal.getEmailIdentityOfCalendar = functio</span>
<a href="#l22.22"></a><span id="l22.22">  * fromRFC3339</span>
<a href="#l22.23"></a><span id="l22.23">  * Convert a RFC3339 compliant Date string to a calIDateTime.</span>
<a href="#l22.24"></a><span id="l22.24">  *</span>
<a href="#l22.25"></a><span id="l22.25">  * @param aStr          The RFC3339 compliant Date String</span>
<a href="#l22.26"></a><span id="l22.26">  * @param aTimezone     The timezone this date string is most likely in</span>
<a href="#l22.27"></a><span id="l22.27">  * @return              A calIDateTime object</span>
<a href="#l22.28"></a><span id="l22.28">  */</span>
<a href="#l22.29"></a><span id="l22.29"> cal.fromRFC3339 = function fromRFC3339(aStr, aTimezone) {</span>
<a href="#l22.30"></a><span id="l22.30" class="difflineminus">-</span>
<a href="#l22.31"></a><span id="l22.31">     // XXX I have not covered leapseconds (matches[8]), this might need to</span>
<a href="#l22.32"></a><span id="l22.32">     // be done. The only reference to leap seconds I found is bug 227329.</span>
<a href="#l22.33"></a><span id="l22.33">     //</span>
<a href="#l22.34"></a><span id="l22.34"> </span>
<a href="#l22.35"></a><span id="l22.35">     // Create a DateTime instance (calUtils.js)</span>
<a href="#l22.36"></a><span id="l22.36">     let dateTime = cal.createDateTime();</span>
<a href="#l22.37"></a><span id="l22.37"> </span>
<a href="#l22.38"></a><span id="l22.38">     // Killer regex to parse RFC3339 dates</span>
<a href="#l22.39"></a><span id="l22.39" class="difflineat">@@ -336,24 +334,22 @@ cal.fromRFC3339 = function fromRFC3339(a</span>
<a href="#l22.40"></a><span id="l22.40">         dateTime.second = matches[7];</span>
<a href="#l22.41"></a><span id="l22.41">     }</span>
<a href="#l22.42"></a><span id="l22.42"> </span>
<a href="#l22.43"></a><span id="l22.43">     // Timezone handling</span>
<a href="#l22.44"></a><span id="l22.44">     if (matches[9] == &quot;Z&quot; || matches[9] == &quot;z&quot;) {</span>
<a href="#l22.45"></a><span id="l22.45">         // If the dates timezone is &quot;Z&quot; or &quot;z&quot;, then this is UTC, no matter</span>
<a href="#l22.46"></a><span id="l22.46">         // what timezone was passed</span>
<a href="#l22.47"></a><span id="l22.47">         dateTime.timezone = cal.UTC();</span>
<a href="#l22.48"></a><span id="l22.48" class="difflineminus">-</span>
<a href="#l22.49"></a><span id="l22.49">     } else if (matches[9] == null) {</span>
<a href="#l22.50"></a><span id="l22.50">         // We have no timezone info, only a date. We have no way to</span>
<a href="#l22.51"></a><span id="l22.51">         // know what timezone we are in, so lets assume we are in the</span>
<a href="#l22.52"></a><span id="l22.52">         // timezone of our local calendar, or whatever was passed.</span>
<a href="#l22.53"></a><span id="l22.53"> </span>
<a href="#l22.54"></a><span id="l22.54">         dateTime.timezone = aTimezone;</span>
<a href="#l22.55"></a><span id="l22.55" class="difflineminus">-</span>
<a href="#l22.56"></a><span id="l22.56">     } else {</span>
<a href="#l22.57"></a><span id="l22.57">         let offset_in_s = (matches[11] == &quot;-&quot; ? -1 : 1) *</span>
<a href="#l22.58"></a><span id="l22.58">             ( (matches[12] * 3600) + (matches[13] * 60) );</span>
<a href="#l22.59"></a><span id="l22.59"> </span>
<a href="#l22.60"></a><span id="l22.60">         // try local timezone first</span>
<a href="#l22.61"></a><span id="l22.61">         dateTime.timezone = aTimezone;</span>
<a href="#l22.62"></a><span id="l22.62"> </span>
<a href="#l22.63"></a><span id="l22.63">         // If offset does not match, go through timezones. This will</span>
<a href="#l22.64"></a><span id="l22.64" class="difflineat">@@ -387,17 +383,16 @@ cal.fromRFC3339 = function fromRFC3339(a</span>
<a href="#l22.65"></a><span id="l22.65"> /**</span>
<a href="#l22.66"></a><span id="l22.66">  * toRFC3339</span>
<a href="#l22.67"></a><span id="l22.67">  * Convert a calIDateTime to a RFC3339 compliant Date string</span>
<a href="#l22.68"></a><span id="l22.68">  *</span>
<a href="#l22.69"></a><span id="l22.69">  * @param aDateTime     The calIDateTime object</span>
<a href="#l22.70"></a><span id="l22.70">  * @return              The RFC3339 compliant date string</span>
<a href="#l22.71"></a><span id="l22.71">  */</span>
<a href="#l22.72"></a><span id="l22.72"> cal.toRFC3339 = function toRFC3339(aDateTime) {</span>
<a href="#l22.73"></a><span id="l22.73" class="difflineminus">-</span>
<a href="#l22.74"></a><span id="l22.74">     if (!aDateTime) {</span>
<a href="#l22.75"></a><span id="l22.75">         return &quot;&quot;;</span>
<a href="#l22.76"></a><span id="l22.76">     }</span>
<a href="#l22.77"></a><span id="l22.77"> </span>
<a href="#l22.78"></a><span id="l22.78">     var full_tzoffset = aDateTime.timezoneOffset;</span>
<a href="#l22.79"></a><span id="l22.79">     var tzoffset_hr = Math.floor(Math.abs(full_tzoffset) / 3600);</span>
<a href="#l22.80"></a><span id="l22.80"> </span>
<a href="#l22.81"></a><span id="l22.81">     var tzoffset_mn = ((Math.abs(full_tzoffset) / 3600).toFixed(2) -</span>
<a href="#l22.82"></a><span id="l22.82" class="difflineat">@@ -636,17 +631,16 @@ cal.ProviderBase.prototype = {</span>
<a href="#l22.83"></a><span id="l22.83">                                                                           aDetail) {</span>
<a href="#l22.84"></a><span id="l22.84">         if (aListener) {</span>
<a href="#l22.85"></a><span id="l22.85">             try {</span>
<a href="#l22.86"></a><span id="l22.86">                 aListener.onOperationComplete(this.superCalendar, aStatus, aOperationType, aId, aDetail);</span>
<a href="#l22.87"></a><span id="l22.87">             } catch (exc) {</span>
<a href="#l22.88"></a><span id="l22.88">                 cal.ERROR(exc);</span>
<a href="#l22.89"></a><span id="l22.89">             }</span>
<a href="#l22.90"></a><span id="l22.90">         }</span>
<a href="#l22.91"></a><span id="l22.91" class="difflineminus">-</span>
<a href="#l22.92"></a><span id="l22.92">     },</span>
<a href="#l22.93"></a><span id="l22.93"> </span>
<a href="#l22.94"></a><span id="l22.94">     notifyOperationComplete: function cPB_notifyOperationComplete(aListener,</span>
<a href="#l22.95"></a><span id="l22.95">                                                                   aStatus,</span>
<a href="#l22.96"></a><span id="l22.96">                                                                   aOperationType,</span>
<a href="#l22.97"></a><span id="l22.97">                                                                   aId,</span>
<a href="#l22.98"></a><span id="l22.98">                                                                   aDetail,</span>
<a href="#l22.99"></a><span id="l22.99">                                                                   aExtraMessage) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/calendar/base/modules/calRecurrenceUtils.jsm</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/calendar/base/modules/calRecurrenceUtils.jsm</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -106,17 +106,16 @@ function recurrenceRule2String(recurrenc</span>
<a href="#l23.4"></a><span id="l23.4">                         } else if (i &lt; days.length - 1) {</span>
<a href="#l23.5"></a><span id="l23.5">                             weekdays += ', ';</span>
<a href="#l23.6"></a><span id="l23.6">                         }</span>
<a href="#l23.7"></a><span id="l23.7">                     }</span>
<a href="#l23.8"></a><span id="l23.8"> </span>
<a href="#l23.9"></a><span id="l23.9">                     weeklyString = getRString(weeklyString, [weekdays]);</span>
<a href="#l23.10"></a><span id="l23.10">                     ruleString = PluralForm.get(rule.interval, weeklyString)</span>
<a href="#l23.11"></a><span id="l23.11">                                            .replace(&quot;#2&quot;, rule.interval);</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-</span>
<a href="#l23.13"></a><span id="l23.13">                 } else {</span>
<a href="#l23.14"></a><span id="l23.14">                     let weeklyString = getRString(&quot;weeklyEveryNth&quot;);</span>
<a href="#l23.15"></a><span id="l23.15">                     ruleString = PluralForm.get(rule.interval, weeklyString)</span>
<a href="#l23.16"></a><span id="l23.16">                                            .replace(&quot;#1&quot;, rule.interval);</span>
<a href="#l23.17"></a><span id="l23.17">                 }</span>
<a href="#l23.18"></a><span id="l23.18">             } else if (rule.type == 'MONTHLY') {</span>
<a href="#l23.19"></a><span id="l23.19">                 if (checkRecurrenceRule(rule, ['BYDAY'])) {</span>
<a href="#l23.20"></a><span id="l23.20">                     let byday = rule.getComponent(&quot;BYDAY&quot;, {});</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/calendar/base/src/calAlarm.js</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/calendar/base/src/calAlarm.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -633,17 +633,16 @@ calAlarm.prototype = {</span>
<a href="#l24.4"></a><span id="l24.4"> </span>
<a href="#l24.5"></a><span id="l24.5">         if (this.related == ALARM_RELATED_ABSOLUTE &amp;&amp; this.mAbsoluteDate) {</span>
<a href="#l24.6"></a><span id="l24.6">             // this is an absolute alarm. Use the calendar default timezone and</span>
<a href="#l24.7"></a><span id="l24.7">             // format it.</span>
<a href="#l24.8"></a><span id="l24.8">             let formatter = cal.getDateFormatter();</span>
<a href="#l24.9"></a><span id="l24.9">             let formatDate = this.mAbsoluteDate.getInTimezone(cal.calendarDefaultTimezone());</span>
<a href="#l24.10"></a><span id="l24.10">             return formatter.formatDateTime(formatDate);</span>
<a href="#l24.11"></a><span id="l24.11">         } else if (this.related != ALARM_RELATED_ABSOLUTE &amp;&amp; this.mOffset) {</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-</span>
<a href="#l24.13"></a><span id="l24.13">             // Relative alarm length</span>
<a href="#l24.14"></a><span id="l24.14">             let alarmlen = Math.abs(this.mOffset.inSeconds / 60);</span>
<a href="#l24.15"></a><span id="l24.15">             if (alarmlen == 0) {</span>
<a href="#l24.16"></a><span id="l24.16">                 // No need to get the other information if the alarm is at the start</span>
<a href="#l24.17"></a><span id="l24.17">                 // of the event/task.</span>
<a href="#l24.18"></a><span id="l24.18">                 if (this.related == ALARM_RELATED_START) {</span>
<a href="#l24.19"></a><span id="l24.19">                     return calGetString(&quot;calendar-alarms&quot;,</span>
<a href="#l24.20"></a><span id="l24.20">                                         getItemBundleStringName(&quot;reminderTitleAtStart&quot;));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/calendar/base/src/calAlarmService.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/calendar/base/src/calAlarmService.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -333,17 +333,16 @@ calAlarmService.prototype = {</span>
<a href="#l25.4"></a><span id="l25.4">                 alarmDate.isDate = false;</span>
<a href="#l25.5"></a><span id="l25.5">             }</span>
<a href="#l25.6"></a><span id="l25.6">             alarmDate = alarmDate.getInTimezone(UTC());</span>
<a href="#l25.7"></a><span id="l25.7"> </span>
<a href="#l25.8"></a><span id="l25.8">             // Check for snooze</span>
<a href="#l25.9"></a><span id="l25.9">             let snoozeDate;</span>
<a href="#l25.10"></a><span id="l25.10">             if (aItem.parentItem != aItem) {</span>
<a href="#l25.11"></a><span id="l25.11">                 snoozeDate = aItem.parentItem.getProperty(&quot;X-MOZ-SNOOZE-TIME-&quot; + aItem.recurrenceId.nativeTime)</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-</span>
<a href="#l25.13"></a><span id="l25.13">             } else {</span>
<a href="#l25.14"></a><span id="l25.14">                 snoozeDate = aItem.getProperty(&quot;X-MOZ-SNOOZE-TIME&quot;);</span>
<a href="#l25.15"></a><span id="l25.15">             }</span>
<a href="#l25.16"></a><span id="l25.16"> </span>
<a href="#l25.17"></a><span id="l25.17">             if (snoozeDate &amp;&amp; !(snoozeDate instanceof Components.interfaces.calIDateTime)) {</span>
<a href="#l25.18"></a><span id="l25.18">                 snoozeDate = cal.createDateTime(snoozeDate);</span>
<a href="#l25.19"></a><span id="l25.19">             }</span>
<a href="#l25.20"></a><span id="l25.20"> </span>
<a href="#l25.21"></a><span id="l25.21" class="difflineat">@@ -442,17 +441,17 @@ calAlarmService.prototype = {</span>
<a href="#l25.22"></a><span id="l25.22"> </span>
<a href="#l25.23"></a><span id="l25.23">     removeTimer: function cAS_removeTimers(aItem, aAlarm) {</span>
<a href="#l25.24"></a><span id="l25.24">             /* Is the calendar in the timer map */</span>
<a href="#l25.25"></a><span id="l25.25">         if (aItem.calendar.id in this.mTimerMap &amp;&amp;</span>
<a href="#l25.26"></a><span id="l25.26">             /* ...and is the item in the calendar map */</span>
<a href="#l25.27"></a><span id="l25.27">             aItem.hashId in this.mTimerMap[aItem.calendar.id] &amp;&amp;</span>
<a href="#l25.28"></a><span id="l25.28">             /* ...and is the alarm in the item map ? */</span>
<a href="#l25.29"></a><span id="l25.29">             aAlarm.icalString in this.mTimerMap[aItem.calendar.id][aItem.hashId]) {</span>
<a href="#l25.30"></a><span id="l25.30" class="difflineminus">-</span>
<a href="#l25.31"></a><span id="l25.31" class="difflineplus">+            // First cancel the existing timer</span>
<a href="#l25.32"></a><span id="l25.32">             let timer = this.mTimerMap[aItem.calendar.id][aItem.hashId][aAlarm.icalString];</span>
<a href="#l25.33"></a><span id="l25.33">             timer.cancel();</span>
<a href="#l25.34"></a><span id="l25.34"> </span>
<a href="#l25.35"></a><span id="l25.35">             // Remove the alarm from the item map</span>
<a href="#l25.36"></a><span id="l25.36">             delete this.mTimerMap[aItem.calendar.id][aItem.hashId][aAlarm.icalString];</span>
<a href="#l25.37"></a><span id="l25.37"> </span>
<a href="#l25.38"></a><span id="l25.38">             // If the item map is empty, remove it from the calendar map</span>
<a href="#l25.39"></a><span id="l25.39">             if (this.mTimerMap[aItem.calendar.id][aItem.hashId].toSource() == &quot;({})&quot;) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/calendar/base/src/calCalendarManager.js</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/calendar/base/src/calCalendarManager.js</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -310,17 +310,16 @@ calCalendarManager.prototype = {</span>
<a href="#l26.4"></a><span id="l26.4"> </span>
<a href="#l26.5"></a><span id="l26.5">             let sortOrderAr = [];</span>
<a href="#l26.6"></a><span id="l26.6">             for (let id in sortOrder) {</span>
<a href="#l26.7"></a><span id="l26.7">                 let s = sortOrder[id];</span>
<a href="#l26.8"></a><span id="l26.8">                 sortOrderAr.push(s);</span>
<a href="#l26.9"></a><span id="l26.9">             }</span>
<a href="#l26.10"></a><span id="l26.10">             Preferences.set(&quot;calendar.list.sortOrder&quot;, sortOrderAr.join(&quot; &quot;));</span>
<a href="#l26.11"></a><span id="l26.11">             flushPrefs();</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-</span>
<a href="#l26.13"></a><span id="l26.13">         } finally {</span>
<a href="#l26.14"></a><span id="l26.14">             selectPrefs.reset();</span>
<a href="#l26.15"></a><span id="l26.15">             selectCalendars.reset();</span>
<a href="#l26.16"></a><span id="l26.16">         }</span>
<a href="#l26.17"></a><span id="l26.17">     },</span>
<a href="#l26.18"></a><span id="l26.18"> </span>
<a href="#l26.19"></a><span id="l26.19">     checkAndMigrateDB: function calmgr_checkAndMigrateDB() {</span>
<a href="#l26.20"></a><span id="l26.20">         let storageSdb = Services.dirsvc.get(&quot;ProfD&quot;, Components.interfaces.nsILocalFile);</span>
<a href="#l26.21"></a><span id="l26.21" class="difflineat">@@ -906,17 +905,16 @@ calMgrCalendarObserver.prototype = {</span>
<a href="#l26.22"></a><span id="l26.22">     },</span>
<a href="#l26.23"></a><span id="l26.23"> </span>
<a href="#l26.24"></a><span id="l26.24">     onPropertyDeleting: function(aCalendar, aName) {</span>
<a href="#l26.25"></a><span id="l26.25">         this.onPropertyChanged(aCalendar, aName, false, true);</span>
<a href="#l26.26"></a><span id="l26.26">     },</span>
<a href="#l26.27"></a><span id="l26.27"> </span>
<a href="#l26.28"></a><span id="l26.28">     // Error announcer specific functions</span>
<a href="#l26.29"></a><span id="l26.29">     announceError: function(aCalendar, aErrNo, aMessage) {</span>
<a href="#l26.30"></a><span id="l26.30" class="difflineminus">-</span>
<a href="#l26.31"></a><span id="l26.31">         var paramBlock = Components.classes[&quot;@mozilla.org/embedcomp/dialogparam;1&quot;]</span>
<a href="#l26.32"></a><span id="l26.32">                                    .createInstance(Components.interfaces.nsIDialogParamBlock);</span>
<a href="#l26.33"></a><span id="l26.33">         var props = Services.strings.createBundle(&quot;chrome://calendar/locale/calendar.properties&quot;);</span>
<a href="#l26.34"></a><span id="l26.34">         var errMsg;</span>
<a href="#l26.35"></a><span id="l26.35">         paramBlock.SetNumberStrings(3);</span>
<a href="#l26.36"></a><span id="l26.36">         if (!this.storedReadOnly &amp;&amp; this.calendar.readOnly) {</span>
<a href="#l26.37"></a><span id="l26.37">             // Major errors change the calendar to readOnly</span>
<a href="#l26.38"></a><span id="l26.38">             errMsg = props.formatStringFromName(&quot;readOnlyMode&quot;, [this.calendar.name], 1);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/calendar/base/src/calTransactionManager.js</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/calendar/base/src/calTransactionManager.js</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -113,17 +113,16 @@ calTransaction.prototype = {</span>
<a href="#l27.4"></a><span id="l27.4">     mIsDoTransaction: false,</span>
<a href="#l27.5"></a><span id="l27.5"> </span>
<a href="#l27.6"></a><span id="l27.6">     onOperationComplete: function cT_onOperationComplete(aCalendar,</span>
<a href="#l27.7"></a><span id="l27.7">                                                          aStatus,</span>
<a href="#l27.8"></a><span id="l27.8">                                                          aOperationType,</span>
<a href="#l27.9"></a><span id="l27.9">                                                          aId,</span>
<a href="#l27.10"></a><span id="l27.10">                                                          aDetail) {</span>
<a href="#l27.11"></a><span id="l27.11">         if (Components.isSuccessCode(aStatus)) {</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-</span>
<a href="#l27.13"></a><span id="l27.13">             cal.itip.checkAndSend(aOperationType,</span>
<a href="#l27.14"></a><span id="l27.14">                                   aDetail,</span>
<a href="#l27.15"></a><span id="l27.15">                                   this.mIsDoTransaction ? this.mOldItem : this.mItem);</span>
<a href="#l27.16"></a><span id="l27.16"> </span>
<a href="#l27.17"></a><span id="l27.17">             if (aOperationType == Components.interfaces.calIOperationListener.ADD ||</span>
<a href="#l27.18"></a><span id="l27.18">                 aOperationType == Components.interfaces.calIOperationListener.MODIFY) {</span>
<a href="#l27.19"></a><span id="l27.19">                 if (this.mIsDoTransaction) {</span>
<a href="#l27.20"></a><span id="l27.20">                     this.mItem = aDetail;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/calendar/base/src/calUtils.js</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/calendar/base/src/calUtils.js</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -1799,17 +1799,16 @@ function binaryInsertNode(parentNode, in</span>
<a href="#l28.4"></a><span id="l28.4">     // Get the index of the node before which the inserNode will be inserted</span>
<a href="#l28.5"></a><span id="l28.5">     let newIndex = binarySearch(Array.map(parentNode.childNodes, accessor), aItem, comptor);</span>
<a href="#l28.6"></a><span id="l28.6"> </span>
<a href="#l28.7"></a><span id="l28.7">     if (newIndex &lt; 0) {</span>
<a href="#l28.8"></a><span id="l28.8">         parentNode.appendChild(insertNode);</span>
<a href="#l28.9"></a><span id="l28.9">         newIndex = 0;</span>
<a href="#l28.10"></a><span id="l28.10">     } else if (!discardDuplicates ||</span>
<a href="#l28.11"></a><span id="l28.11">         comptor(accessor(parentNode.childNodes[Math.min(newIndex, parentNode.childNodes.length - 1)]), aItem) &gt;= 0) {</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-</span>
<a href="#l28.13"></a><span id="l28.13">         // Only add the node if duplicates should not be discarded, or if</span>
<a href="#l28.14"></a><span id="l28.14">         // they should and the childNode[newIndex] == node.</span>
<a href="#l28.15"></a><span id="l28.15">         let node = parentNode.childNodes[newIndex];</span>
<a href="#l28.16"></a><span id="l28.16">         parentNode.insertBefore(insertNode, node);</span>
<a href="#l28.17"></a><span id="l28.17">     }</span>
<a href="#l28.18"></a><span id="l28.18">     return newIndex;</span>
<a href="#l28.19"></a><span id="l28.19"> }</span>
<a href="#l28.20"></a><span id="l28.20"> binaryInsertNode.defaultAccessor = n =&gt; n.item;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/calendar/import-export/calOutlookCSVImportExport.js</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/calendar/import-export/calOutlookCSVImportExport.js</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -358,17 +358,16 @@ calOutlookCSVImporter.prototype = {</span>
<a href="#l29.4"></a><span id="l29.4">                 }</span>
<a href="#l29.5"></a><span id="l29.5"> </span>
<a href="#l29.6"></a><span id="l29.6">                 // save the event into return array</span>
<a href="#l29.7"></a><span id="l29.7">                 eventArray.push(event);</span>
<a href="#l29.8"></a><span id="l29.8">             }</span>
<a href="#l29.9"></a><span id="l29.9"> </span>
<a href="#l29.10"></a><span id="l29.10">             // get next events fields</span>
<a href="#l29.11"></a><span id="l29.11">             eventFields = eventRegExp.exec(str);</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-</span>
<a href="#l29.13"></a><span id="l29.13">         } while (eventRegExp.lastIndex != 0);</span>
<a href="#l29.14"></a><span id="l29.14"> </span>
<a href="#l29.15"></a><span id="l29.15">         // return results</span>
<a href="#l29.16"></a><span id="l29.16">         aCount.value = eventArray.length;</span>
<a href="#l29.17"></a><span id="l29.17">         return eventArray;</span>
<a href="#l29.18"></a><span id="l29.18">     },</span>
<a href="#l29.19"></a><span id="l29.19"> </span>
<a href="#l29.20"></a><span id="l29.20">     parseDateTime: function parseDateTime(aDate, aTime, aLocale) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/calendar/import-export/calWeekPrinter.js</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/calendar/import-export/calWeekPrinter.js</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -58,17 +58,16 @@ calWeekPrinter.prototype = {</span>
<a href="#l30.4"></a><span id="l30.4">                 continue;</span>
<a href="#l30.5"></a><span id="l30.5">             }</span>
<a href="#l30.6"></a><span id="l30.6">             itemStartDate = itemStartDate.getInTimezone(defaultTimezone);</span>
<a href="#l30.7"></a><span id="l30.7">             itemEndDate = itemEndDate.getInTimezone(defaultTimezone);</span>
<a href="#l30.8"></a><span id="l30.8"> </span>
<a href="#l30.9"></a><span id="l30.9">             let boxDate = itemStartDate.clone();</span>
<a href="#l30.10"></a><span id="l30.10">             boxDate.isDate = true;</span>
<a href="#l30.11"></a><span id="l30.11">             for (boxDate; boxDate.compare(itemEndDate) &lt; (itemEndDate.isDate ? 0 : 1); boxDate.day++) {</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-</span>
<a href="#l30.13"></a><span id="l30.13">                 // Ignore items outside of the range, i.e tasks without start date</span>
<a href="#l30.14"></a><span id="l30.14">                 // where the end date is somewhere else.</span>
<a href="#l30.15"></a><span id="l30.15">                 if (aStart &amp;&amp; aEnd &amp;&amp; boxDate &amp;&amp;</span>
<a href="#l30.16"></a><span id="l30.16">                     (boxDate.compare(aStart) &lt; 0 || boxDate.compare(aEnd) &gt;= 0)) {</span>
<a href="#l30.17"></a><span id="l30.17">                     continue;</span>
<a href="#l30.18"></a><span id="l30.18">                 }</span>
<a href="#l30.19"></a><span id="l30.19"> </span>
<a href="#l30.20"></a><span id="l30.20">                 let boxDateKey = cal.print.getDateKey(boxDate);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/calendar/lightning/content/imip-bar.js</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/calendar/lightning/content/imip-bar.js</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -275,17 +275,16 @@ var ltnImipBar = {</span>
<a href="#l31.4"></a><span id="l31.4">                 msgOverlay = ltn.invitation.compareInvitationOverlay(msgOverlay, serializedOverlay,</span>
<a href="#l31.5"></a><span id="l31.5">                                                                      organizerId);</span>
<a href="#l31.6"></a><span id="l31.6">             }</span>
<a href="#l31.7"></a><span id="l31.7">         }</span>
<a href="#l31.8"></a><span id="l31.8">         msgWindow.displayHTMLInMessagePane('', msgOverlay, false);</span>
<a href="#l31.9"></a><span id="l31.9">     },</span>
<a href="#l31.10"></a><span id="l31.10"> </span>
<a href="#l31.11"></a><span id="l31.11">     executeAction: function ltnExecAction(partStat, extendResponse) {</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-</span>
<a href="#l31.13"></a><span id="l31.13">         function _execAction(aActionFunc, aItipItem, aWindow, aPartStat) {</span>
<a href="#l31.14"></a><span id="l31.14">             if (cal.itip.promptCalendar(aActionFunc.method, aItipItem, aWindow)) {</span>
<a href="#l31.15"></a><span id="l31.15">                 // filter out fake partstats</span>
<a href="#l31.16"></a><span id="l31.16">                 if (aPartStat.startsWith(&quot;X-&quot;)) {</span>
<a href="#l31.17"></a><span id="l31.17">                     partstat = &quot;&quot;;</span>
<a href="#l31.18"></a><span id="l31.18">                 }</span>
<a href="#l31.19"></a><span id="l31.19">                 // hide the buttons now, to disable pressing them twice...</span>
<a href="#l31.20"></a><span id="l31.20">                 if (aPartStat == partStat) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/calendar/lightning/content/lightning-item-iframe.js</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-item-iframe.js</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -602,17 +602,16 @@ function loadDialog(aItem) {</span>
<a href="#l32.4"></a><span id="l32.4">     if (hasAttachments &amp;&amp; attachments &amp;&amp; attachments.length &gt; 0) {</span>
<a href="#l32.5"></a><span id="l32.5">         for (let attachment of attachments) {</span>
<a href="#l32.6"></a><span id="l32.6">             if (gNewItemUI) {</span>
<a href="#l32.7"></a><span id="l32.7">                 if (attachment &amp;&amp;</span>
<a href="#l32.8"></a><span id="l32.8">                     attachment.hashId &amp;&amp;</span>
<a href="#l32.9"></a><span id="l32.9">                     !(attachment.hashId in gAttachMap) &amp;&amp;</span>
<a href="#l32.10"></a><span id="l32.10">                     // We currently only support uri attachments.</span>
<a href="#l32.11"></a><span id="l32.11">                     attachment.uri) {</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-</span>
<a href="#l32.13"></a><span id="l32.13">                     itemProps.initialAttachments[attachment.hashId] = attachment;</span>
<a href="#l32.14"></a><span id="l32.14"> </span>
<a href="#l32.15"></a><span id="l32.15">                     // XXX eventually we probably need to call addAttachment(attachment)</span>
<a href="#l32.16"></a><span id="l32.16">                     // here, until this works we just call updateAttachment()</span>
<a href="#l32.17"></a><span id="l32.17">                     updateAttachment();</span>
<a href="#l32.18"></a><span id="l32.18">                 }</span>
<a href="#l32.19"></a><span id="l32.19">             } else {</span>
<a href="#l32.20"></a><span id="l32.20">                 addAttachment(attachment);</span>
<a href="#l32.21"></a><span id="l32.21" class="difflineat">@@ -1913,17 +1912,16 @@ function loadCloudProviders() {</span>
<a href="#l32.22"></a><span id="l32.22">     let isHidden = cloudFileAccounts.accounts.length == 0;</span>
<a href="#l32.23"></a><span id="l32.23">     cmd.hidden = isHidden;</span>
<a href="#l32.24"></a><span id="l32.24">     message.argument.value = isHidden;</span>
<a href="#l32.25"></a><span id="l32.25">     sendMessage(message);</span>
<a href="#l32.26"></a><span id="l32.26"> </span>
<a href="#l32.27"></a><span id="l32.27">     let itemObjects = [];</span>
<a href="#l32.28"></a><span id="l32.28"> </span>
<a href="#l32.29"></a><span id="l32.29">     for (let [, cloudProvider] in Iterator(cloudFileAccounts.accounts)) {</span>
<a href="#l32.30"></a><span id="l32.30" class="difflineminus">-</span>
<a href="#l32.31"></a><span id="l32.31">         // Create a serializable object to pass in a message outside the iframe</span>
<a href="#l32.32"></a><span id="l32.32">         let itemObject = {};</span>
<a href="#l32.33"></a><span id="l32.33">         itemObject.displayName = cloudFileAccounts.getDisplayName(cloudProvider);</span>
<a href="#l32.34"></a><span id="l32.34">         itemObject.label = cal.calGetString(&quot;calendar-event-dialog&quot;, &quot;attachViaFilelink&quot;, [itemObject.displayName]);</span>
<a href="#l32.35"></a><span id="l32.35">         itemObject.cloudProviderAccountKey = cloudProvider.accountKey;</span>
<a href="#l32.36"></a><span id="l32.36">         if (cloudProvider.iconClass) {</span>
<a href="#l32.37"></a><span id="l32.37">             itemObject.class = &quot;menuitem-iconic&quot;;</span>
<a href="#l32.38"></a><span id="l32.38">             itemObject.image = cloudProvider.iconClass;</span>
<a href="#l32.39"></a><span id="l32.39" class="difflineat">@@ -1961,17 +1959,16 @@ function attachURL() {</span>
<a href="#l32.40"></a><span id="l32.40">         if (Services.prompt.prompt(window,</span>
<a href="#l32.41"></a><span id="l32.41">                                    calGetString(&quot;calendar-event-dialog&quot;,</span>
<a href="#l32.42"></a><span id="l32.42">                                                 &quot;specifyLinkLocation&quot;),</span>
<a href="#l32.43"></a><span id="l32.43">                                    calGetString(&quot;calendar-event-dialog&quot;,</span>
<a href="#l32.44"></a><span id="l32.44">                                                 &quot;enterLinkLocation&quot;),</span>
<a href="#l32.45"></a><span id="l32.45">                                    result,</span>
<a href="#l32.46"></a><span id="l32.46">                                    null,</span>
<a href="#l32.47"></a><span id="l32.47">                                    { value: 0 })) {</span>
<a href="#l32.48"></a><span id="l32.48" class="difflineminus">-</span>
<a href="#l32.49"></a><span id="l32.49">             try {</span>
<a href="#l32.50"></a><span id="l32.50">                 // If something bogus was entered, makeURL may fail.</span>
<a href="#l32.51"></a><span id="l32.51">                 var attachment = createAttachment();</span>
<a href="#l32.52"></a><span id="l32.52">                 attachment.uri = makeURL(result.value);</span>
<a href="#l32.53"></a><span id="l32.53">                 addAttachment(attachment);</span>
<a href="#l32.54"></a><span id="l32.54">             } catch (e) {</span>
<a href="#l32.55"></a><span id="l32.55">                 // TODO We might want to show a warning instead of just not</span>
<a href="#l32.56"></a><span id="l32.56">                 // adding the file</span>
<a href="#l32.57"></a><span id="l32.57" class="difflineat">@@ -3013,17 +3010,16 @@ function onCommandSave(aIsClosing) {</span>
<a href="#l32.58"></a><span id="l32.58">         },</span>
<a href="#l32.59"></a><span id="l32.59">         onGetResult: function() {}</span>
<a href="#l32.60"></a><span id="l32.60">     };</span>
<a href="#l32.61"></a><span id="l32.61"> </span>
<a href="#l32.62"></a><span id="l32.62">     // Let the caller decide how to handle the modified/added item. Only pass</span>
<a href="#l32.63"></a><span id="l32.63">     // the above item if we are not closing, otherwise the listener will be</span>
<a href="#l32.64"></a><span id="l32.64">     // missing its window afterwards.</span>
<a href="#l32.65"></a><span id="l32.65">     window.onAcceptCallback(item, calendar, originalItem, !aIsClosing &amp;&amp; listener);</span>
<a href="#l32.66"></a><span id="l32.66" class="difflineminus">-</span>
<a href="#l32.67"></a><span id="l32.67"> }</span>
<a href="#l32.68"></a><span id="l32.68"> </span>
<a href="#l32.69"></a><span id="l32.69"> /**</span>
<a href="#l32.70"></a><span id="l32.70">  * This function is called when the user chooses to delete an Item</span>
<a href="#l32.71"></a><span id="l32.71">  * from the Event/Task dialog</span>
<a href="#l32.72"></a><span id="l32.72">  *</span>
<a href="#l32.73"></a><span id="l32.73">  */</span>
<a href="#l32.74"></a><span id="l32.74"> function onCommandDeleteItem() {</span>
<a href="#l32.75"></a><span id="l32.75" class="difflineat">@@ -3483,32 +3479,30 @@ function showOrHideItemURL(aShow, aUrl) </span>
<a href="#l32.76"></a><span id="l32.76">             // No protocol handler for the given protocol, or invalid uri</span>
<a href="#l32.77"></a><span id="l32.77">             // hideOrShow(false);</span>
<a href="#l32.78"></a><span id="l32.78">             return false;</span>
<a href="#l32.79"></a><span id="l32.79">         }</span>
<a href="#l32.80"></a><span id="l32.80">         // Only show if its either an internal protcol handler, or its external</span>
<a href="#l32.81"></a><span id="l32.81">         // and there is an external app for the scheme</span>
<a href="#l32.82"></a><span id="l32.82">         handler = cal.wrapInstance(handler, Components.interfaces.nsIExternalProtocolHandler);</span>
<a href="#l32.83"></a><span id="l32.83">         return !handler || handler.externalAppExistsForScheme(uri.scheme);</span>
<a href="#l32.84"></a><span id="l32.84" class="difflineminus">-</span>
<a href="#l32.85"></a><span id="l32.85">     } else {</span>
<a href="#l32.86"></a><span id="l32.86">         // Hide if there is no url, or the menuitem was chosen so that the url</span>
<a href="#l32.87"></a><span id="l32.87">         // should be hidden.</span>
<a href="#l32.88"></a><span id="l32.88">         return false;</span>
<a href="#l32.89"></a><span id="l32.89">     }</span>
<a href="#l32.90"></a><span id="l32.90"> }</span>
<a href="#l32.91"></a><span id="l32.91"> </span>
<a href="#l32.92"></a><span id="l32.92"> /**</span>
<a href="#l32.93"></a><span id="l32.93">  * Updates the related link on the dialog (rfc2445 URL property).</span>
<a href="#l32.94"></a><span id="l32.94">  *</span>
<a href="#l32.95"></a><span id="l32.95">  * @param {boolean} aShow  Show the link (true) or not (false)</span>
<a href="#l32.96"></a><span id="l32.96">  * @param {string} aUrl    The url</span>
<a href="#l32.97"></a><span id="l32.97">  */</span>
<a href="#l32.98"></a><span id="l32.98"> function updateItemURL(aShow, aUrl) {</span>
<a href="#l32.99"></a><span id="l32.99" class="difflineminus">-</span>
<a href="#l32.100"></a><span id="l32.100">     // Hide or show the link</span>
<a href="#l32.101"></a><span id="l32.101">     setElementValue(&quot;event-grid-link-row&quot;, !aShow &amp;&amp; &quot;true&quot;, &quot;hidden&quot;);</span>
<a href="#l32.102"></a><span id="l32.102">     // The separator is not there in the summary dialog</span>
<a href="#l32.103"></a><span id="l32.103">     let separator = document.getElementById(&quot;event-grid-link-separator&quot;);</span>
<a href="#l32.104"></a><span id="l32.104">     if (separator) {</span>
<a href="#l32.105"></a><span id="l32.105">         setElementValue(&quot;event-grid-link-separator&quot;, !aShow &amp;&amp; &quot;true&quot;, &quot;hidden&quot;);</span>
<a href="#l32.106"></a><span id="l32.106">     }</span>
<a href="#l32.107"></a><span id="l32.107"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/calendar/lightning/content/lightning-item-panel.js</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-item-panel.js</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -213,17 +213,16 @@ function onLoadLightningItemPanel(aIfram</span>
<a href="#l33.4"></a><span id="l33.4">     if (gTabmail) {</span>
<a href="#l33.5"></a><span id="l33.5">         // tab case</span>
<a href="#l33.6"></a><span id="l33.6">         let iframeId = aIframeId || gTabmail.currentTabInfo.iframe.id;</span>
<a href="#l33.7"></a><span id="l33.7">         iframe = document.getElementById(iframeId);</span>
<a href="#l33.8"></a><span id="l33.8">         iframeSrc = aUrl;</span>
<a href="#l33.9"></a><span id="l33.9"> </span>
<a href="#l33.10"></a><span id="l33.10">         // Add a listener to detect close events, prompt user about saving changes.</span>
<a href="#l33.11"></a><span id="l33.11">         window.addEventListener(&quot;close&quot;, windowCloseListener, false);</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-</span>
<a href="#l33.13"></a><span id="l33.13">     } else {</span>
<a href="#l33.14"></a><span id="l33.14">         // window dialog case</span>
<a href="#l33.15"></a><span id="l33.15">         iframe = document.createElement(&quot;iframe&quot;);</span>
<a href="#l33.16"></a><span id="l33.16">         iframeSrc = window.arguments[0].useNewItemUI ?</span>
<a href="#l33.17"></a><span id="l33.17">             &quot;chrome://lightning/content/html-item-editing/lightning-item-iframe.html&quot; :</span>
<a href="#l33.18"></a><span id="l33.18">             &quot;chrome://lightning/content/lightning-item-iframe.xul&quot;;</span>
<a href="#l33.19"></a><span id="l33.19"> </span>
<a href="#l33.20"></a><span id="l33.20">         iframe.setAttribute(&quot;id&quot;, &quot;lightning-item-panel-iframe&quot;);</span>
<a href="#l33.21"></a><span id="l33.21" class="difflineat">@@ -905,17 +904,16 @@ function onCommandViewToolbar(aToolbarId</span>
<a href="#l33.22"></a><span id="l33.22"> /**</span>
<a href="#l33.23"></a><span id="l33.23">  * Called after the customize toolbar dialog has been closed by the</span>
<a href="#l33.24"></a><span id="l33.24">  * user. We need to restore the state of all buttons and commands of</span>
<a href="#l33.25"></a><span id="l33.25">  * all customizable toolbars.</span>
<a href="#l33.26"></a><span id="l33.26">  *</span>
<a href="#l33.27"></a><span id="l33.27">  * @param {boolean} aToolboxChanged  When true the toolbox has changed</span>
<a href="#l33.28"></a><span id="l33.28">  */</span>
<a href="#l33.29"></a><span id="l33.29"> function dialogToolboxCustomizeDone(aToolboxChanged) {</span>
<a href="#l33.30"></a><span id="l33.30" class="difflineminus">-</span>
<a href="#l33.31"></a><span id="l33.31">     // Re-enable menu items (disabled during toolbar customization).</span>
<a href="#l33.32"></a><span id="l33.32">     let menubarId = gTabmail ? &quot;mail-menubar&quot; : &quot;event-menubar&quot;;</span>
<a href="#l33.33"></a><span id="l33.33">     let menubar = document.getElementById(menubarId);</span>
<a href="#l33.34"></a><span id="l33.34">     for (let menuitem of menubar.childNodes) {</span>
<a href="#l33.35"></a><span id="l33.35">         menuitem.removeAttribute(&quot;disabled&quot;);</span>
<a href="#l33.36"></a><span id="l33.36">     }</span>
<a href="#l33.37"></a><span id="l33.37"> </span>
<a href="#l33.38"></a><span id="l33.38">     // make sure our toolbar buttons have the correct enabled state restored to them...</span>
<a href="#l33.39"></a><span id="l33.39" class="difflineat">@@ -964,17 +962,16 @@ function onCommandCustomize() {</span>
<a href="#l33.40"></a><span id="l33.40"> </span>
<a href="#l33.41"></a><span id="l33.41"> /**</span>
<a href="#l33.42"></a><span id="l33.42">  * Add menu items to the UI for attaching files using a cloud provider.</span>
<a href="#l33.43"></a><span id="l33.43">  *</span>
<a href="#l33.44"></a><span id="l33.44">  * @param {Object[]} aItemObjects  Array of objects that each contain</span>
<a href="#l33.45"></a><span id="l33.45">  *                                 data to create a menuitem</span>
<a href="#l33.46"></a><span id="l33.46">  */</span>
<a href="#l33.47"></a><span id="l33.47"> function loadCloudProviders(aItemObjects) {</span>
<a href="#l33.48"></a><span id="l33.48" class="difflineminus">-</span>
<a href="#l33.49"></a><span id="l33.49">     /**</span>
<a href="#l33.50"></a><span id="l33.50">      * Deletes any existing menu items in aParentNode that have a</span>
<a href="#l33.51"></a><span id="l33.51">      * cloudProviderAccountKey attribute.</span>
<a href="#l33.52"></a><span id="l33.52">      *</span>
<a href="#l33.53"></a><span id="l33.53">      * @param {nsIDOMNode} aParentNode  A menupopup containing menu items</span>
<a href="#l33.54"></a><span id="l33.54">      */</span>
<a href="#l33.55"></a><span id="l33.55">     function deleteAlreadyExisting(aParentNode) {</span>
<a href="#l33.56"></a><span id="l33.56">         for (let node of aParentNode.childNodes) {</span>
<a href="#l33.57"></a><span id="l33.57" class="difflineat">@@ -992,17 +989,16 @@ function loadCloudProviders(aItemObjects</span>
<a href="#l33.58"></a><span id="l33.58">         deleteAlreadyExisting(toolbarPopup);</span>
<a href="#l33.59"></a><span id="l33.59">     }</span>
<a href="#l33.60"></a><span id="l33.60">     let optionsPopup = document.getElementById(&quot;options-attachments-menupopup&quot;);</span>
<a href="#l33.61"></a><span id="l33.61">     if (optionsPopup) {</span>
<a href="#l33.62"></a><span id="l33.62">         deleteAlreadyExisting(optionsPopup);</span>
<a href="#l33.63"></a><span id="l33.63">     }</span>
<a href="#l33.64"></a><span id="l33.64"> </span>
<a href="#l33.65"></a><span id="l33.65">     for (let itemObject of aItemObjects) {</span>
<a href="#l33.66"></a><span id="l33.66" class="difflineminus">-</span>
<a href="#l33.67"></a><span id="l33.67">         // Create a menu item.</span>
<a href="#l33.68"></a><span id="l33.68">         let item = createXULElement(&quot;menuitem&quot;);</span>
<a href="#l33.69"></a><span id="l33.69">         item.setAttribute(&quot;label&quot;, itemObject.label);</span>
<a href="#l33.70"></a><span id="l33.70">         item.setAttribute(&quot;observes&quot;, &quot;cmd_attach_cloud&quot;);</span>
<a href="#l33.71"></a><span id="l33.71">         item.setAttribute(&quot;oncommand&quot;, &quot;attachFileByAccountKey(event.target.cloudProviderAccountKey); event.stopPropagation();&quot;);</span>
<a href="#l33.72"></a><span id="l33.72"> </span>
<a href="#l33.73"></a><span id="l33.73">         if (itemObject.class) {</span>
<a href="#l33.74"></a><span id="l33.74">             item.setAttribute(&quot;class&quot;, itemObject.class);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/calendar/lightning/content/messenger-overlay-sidebar.js</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/calendar/lightning/content/messenger-overlay-sidebar.js</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -289,17 +289,16 @@ var calendarItemTabType = {</span>
<a href="#l34.4"></a><span id="l34.4">     persistTab: function(aTab) {</span>
<a href="#l34.5"></a><span id="l34.5">         let args = aTab.iframe.contentWindow.arguments[0];</span>
<a href="#l34.6"></a><span id="l34.6">         // Serialize args, with manual handling of some properties.</span>
<a href="#l34.7"></a><span id="l34.7">         // persistTab is called even for new events/tasks in tabs that</span>
<a href="#l34.8"></a><span id="l34.8">         // were closed and never saved (for 'undo close tab'</span>
<a href="#l34.9"></a><span id="l34.9">         // functionality), thus we confirm we have the expected values.</span>
<a href="#l34.10"></a><span id="l34.10">         if (args &amp;&amp; args.calendar &amp;&amp; args.calendar.id &amp;&amp;</span>
<a href="#l34.11"></a><span id="l34.11">             args.calendarEvent &amp;&amp; args.calendarEvent.id) {</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-</span>
<a href="#l34.13"></a><span id="l34.13">             let calendarId = args.calendar.id;</span>
<a href="#l34.14"></a><span id="l34.14">             let itemId = args.calendarEvent.id;</span>
<a href="#l34.15"></a><span id="l34.15">             // Handle null args.initialStartDateValue, just for good measure.</span>
<a href="#l34.16"></a><span id="l34.16">             // Note that this is not the start date for the event or task.</span>
<a href="#l34.17"></a><span id="l34.17">             let hasDateValue = args.initialStartDateValue &amp;&amp;</span>
<a href="#l34.18"></a><span id="l34.18">                                args.initialStartDateValue.icalString;</span>
<a href="#l34.19"></a><span id="l34.19">             let initialStartDate = hasDateValue</span>
<a href="#l34.20"></a><span id="l34.20">                 ? args.initialStartDateValue.icalString : null;</span>
<a href="#l34.21"></a><span id="l34.21" class="difflineat">@@ -350,17 +349,16 @@ window.addEventListener(&quot;load&quot;, function</span>
<a href="#l34.22"></a><span id="l34.22">     let tabmail = document.getElementById('tabmail');</span>
<a href="#l34.23"></a><span id="l34.23">     tabmail.registerTabType(calendarTabType);</span>
<a href="#l34.24"></a><span id="l34.24">     tabmail.registerTabType(calendarItemTabType);</span>
<a href="#l34.25"></a><span id="l34.25">     tabmail.registerTabMonitor(calendarTabMonitor);</span>
<a href="#l34.26"></a><span id="l34.26"> }, false);</span>
<a href="#l34.27"></a><span id="l34.27"> </span>
<a href="#l34.28"></a><span id="l34.28"> </span>
<a href="#l34.29"></a><span id="l34.29"> function ltnOnLoad(event) {</span>
<a href="#l34.30"></a><span id="l34.30" class="difflineminus">-</span>
<a href="#l34.31"></a><span id="l34.31">     // nuke the onload, or we get called every time there's</span>
<a href="#l34.32"></a><span id="l34.32">     // any load that occurs</span>
<a href="#l34.33"></a><span id="l34.33">     window.removeEventListener(&quot;load&quot;, ltnOnLoad, false);</span>
<a href="#l34.34"></a><span id="l34.34"> </span>
<a href="#l34.35"></a><span id="l34.35">     // Check if the binary component was loaded</span>
<a href="#l34.36"></a><span id="l34.36">     checkCalendarBinaryComponent();</span>
<a href="#l34.37"></a><span id="l34.37"> </span>
<a href="#l34.38"></a><span id="l34.38">     document.getElementById(&quot;calendarDisplayDeck&quot;).</span>
<a href="#l34.39"></a><span id="l34.39" class="difflineat">@@ -553,17 +551,16 @@ function refreshUIBits() {</span>
<a href="#l34.40"></a><span id="l34.40">             TodayPane.setDay(now());</span>
<a href="#l34.41"></a><span id="l34.41">         }</span>
<a href="#l34.42"></a><span id="l34.42"> </span>
<a href="#l34.43"></a><span id="l34.43">         // update the unifinder</span>
<a href="#l34.44"></a><span id="l34.44">         refreshEventTree();</span>
<a href="#l34.45"></a><span id="l34.45"> </span>
<a href="#l34.46"></a><span id="l34.46">         // update today's date on todaypane button</span>
<a href="#l34.47"></a><span id="l34.47">         document.getElementById(&quot;calendar-status-todaypane-button&quot;).setUpTodayDate();</span>
<a href="#l34.48"></a><span id="l34.48" class="difflineminus">-</span>
<a href="#l34.49"></a><span id="l34.49">     } catch (exc) {</span>
<a href="#l34.50"></a><span id="l34.50">         ASSERT(false, exc);</span>
<a href="#l34.51"></a><span id="l34.51">     }</span>
<a href="#l34.52"></a><span id="l34.52"> </span>
<a href="#l34.53"></a><span id="l34.53">     // schedule our next update...</span>
<a href="#l34.54"></a><span id="l34.54">     scheduleMidnightUpdate(refreshUIBits);</span>
<a href="#l34.55"></a><span id="l34.55"> }</span>
<a href="#l34.56"></a><span id="l34.56"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/calendar/lightning/content/suite-overlay-sidebar.js</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/calendar/lightning/content/suite-overlay-sidebar.js</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -5,17 +5,16 @@</span>
<a href="#l35.4"></a><span id="l35.4"> Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l35.5"></a><span id="l35.5"> </span>
<a href="#l35.6"></a><span id="l35.6"> var ltnSuiteUtils = {</span>
<a href="#l35.7"></a><span id="l35.7"> </span>
<a href="#l35.8"></a><span id="l35.8">   addStartupObserver: function lSU_addStartupObserver() {</span>
<a href="#l35.9"></a><span id="l35.9">     Services.obs.addObserver(this.startupObserver, &quot;lightning-startup-done&quot;, false);</span>
<a href="#l35.10"></a><span id="l35.10">     Services.obs.addObserver(this.startupObserver, &quot;calendar-taskview-startup-done&quot;,</span>
<a href="#l35.11"></a><span id="l35.11">                     false);</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-</span>
<a href="#l35.13"></a><span id="l35.13">   },</span>
<a href="#l35.14"></a><span id="l35.14"> </span>
<a href="#l35.15"></a><span id="l35.15">   startupObserver: {</span>
<a href="#l35.16"></a><span id="l35.16">     observe: function lSU_observe(subject, topic, state) {</span>
<a href="#l35.17"></a><span id="l35.17">       if (topic != &quot;lightning-startup-done&quot; &amp;&amp;</span>
<a href="#l35.18"></a><span id="l35.18">           topic != &quot;calendar-taskview-startup-done&quot;) {</span>
<a href="#l35.19"></a><span id="l35.19">         return;</span>
<a href="#l35.20"></a><span id="l35.20">       }</span>
<a href="#l35.21"></a><span id="l35.21" class="difflineat">@@ -35,12 +34,11 @@ var ltnSuiteUtils = {</span>
<a href="#l35.22"></a><span id="l35.22">           toolboxCustomizeDone(&quot;mail-menubar&quot;, toolbox, aToolboxChanged);</span>
<a href="#l35.23"></a><span id="l35.23">         };</span>
<a href="#l35.24"></a><span id="l35.24">         toolbox.customizeChange = function(aEvent) {</span>
<a href="#l35.25"></a><span id="l35.25">           toolboxCustomizeChange(toolbox, aEvent);</span>
<a href="#l35.26"></a><span id="l35.26">         };</span>
<a href="#l35.27"></a><span id="l35.27">       });</span>
<a href="#l35.28"></a><span id="l35.28">     }</span>
<a href="#l35.29"></a><span id="l35.29">   }</span>
<a href="#l35.30"></a><span id="l35.30" class="difflineminus">-</span>
<a href="#l35.31"></a><span id="l35.31"> }</span>
<a href="#l35.32"></a><span id="l35.32"> </span>
<a href="#l35.33"></a><span id="l35.33"> ltnSuiteUtils.addStartupObserver();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -1157,17 +1157,16 @@ calDavCalendar.prototype = {</span>
<a href="#l36.4"></a><span id="l36.4">      */</span>
<a href="#l36.5"></a><span id="l36.5">     deleteTargetCalendarItem: Task.async(function* (path) {</span>
<a href="#l36.6"></a><span id="l36.6">         let pcal = cal.async.promisifyCalendar(this.mOfflineStorage);</span>
<a href="#l36.7"></a><span id="l36.7"> </span>
<a href="#l36.8"></a><span id="l36.8">         let foundItem = (yield pcal.getItem(this.mHrefIndex[path]))[0];</span>
<a href="#l36.9"></a><span id="l36.9">         let wasInboxItem = this.mItemInfoCache[foundItem.id].isInboxItem;</span>
<a href="#l36.10"></a><span id="l36.10">         if ((wasInboxItem &amp;&amp; this.isInbox(path)) ||</span>
<a href="#l36.11"></a><span id="l36.11">             (wasInboxItem === false &amp;&amp; !this.isInbox(path))) {</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-</span>
<a href="#l36.13"></a><span id="l36.13">             cal.LOG(&quot;CalDAV: deleting item: &quot; + path + &quot;, uid: &quot; + foundItem.id);</span>
<a href="#l36.14"></a><span id="l36.14">             delete this.mHrefIndex[path];</span>
<a href="#l36.15"></a><span id="l36.15">             delete this.mItemInfoCache[foundItem.id];</span>
<a href="#l36.16"></a><span id="l36.16">             if (this.isCached) {</span>
<a href="#l36.17"></a><span id="l36.17">                 this.mOfflineStorage.deleteMetaData(foundItem.id);</span>
<a href="#l36.18"></a><span id="l36.18">             }</span>
<a href="#l36.19"></a><span id="l36.19">             yield pcal.deleteItem(foundItem);</span>
<a href="#l36.20"></a><span id="l36.20">         }</span>
<a href="#l36.21"></a><span id="l36.21" class="difflineat">@@ -1253,17 +1252,16 @@ calDavCalendar.prototype = {</span>
<a href="#l36.22"></a><span id="l36.22">     /**</span>
<a href="#l36.23"></a><span id="l36.23">      * Retrieves a specific item from the CalDAV store.</span>
<a href="#l36.24"></a><span id="l36.24">      * Use when an outdated copy of the item is in hand.</span>
<a href="#l36.25"></a><span id="l36.25">      *</span>
<a href="#l36.26"></a><span id="l36.26">      * @param aItem       item to fetch</span>
<a href="#l36.27"></a><span id="l36.27">      * @param aListener   listener for method completion</span>
<a href="#l36.28"></a><span id="l36.28">      */</span>
<a href="#l36.29"></a><span id="l36.29">     getUpdatedItem: function caldav_getUpdatedItem(aItem, aListener, aChangeLogListener) {</span>
<a href="#l36.30"></a><span id="l36.30" class="difflineminus">-</span>
<a href="#l36.31"></a><span id="l36.31">         if (aItem == null) {</span>
<a href="#l36.32"></a><span id="l36.32">             this.notifyOperationComplete(aListener,</span>
<a href="#l36.33"></a><span id="l36.33">                                          Components.results.NS_ERROR_FAILURE,</span>
<a href="#l36.34"></a><span id="l36.34">                                          cIOL.GET,</span>
<a href="#l36.35"></a><span id="l36.35">                                          null,</span>
<a href="#l36.36"></a><span id="l36.36">                                          &quot;passed in null item&quot;);</span>
<a href="#l36.37"></a><span id="l36.37">             return;</span>
<a href="#l36.38"></a><span id="l36.38">         }</span>
<a href="#l36.39"></a><span id="l36.39" class="difflineat">@@ -1444,17 +1442,16 @@ calDavCalendar.prototype = {</span>
<a href="#l36.40"></a><span id="l36.40">             if (!ctag || ctag != thisCalendar.mCtag) {</span>
<a href="#l36.41"></a><span id="l36.41">                 // ctag mismatch, need to fetch calendar-data</span>
<a href="#l36.42"></a><span id="l36.42">                 thisCalendar.mProposedCtag = ctag;</span>
<a href="#l36.43"></a><span id="l36.43">                 thisCalendar.getUpdatedItems(thisCalendar.calendarUri,</span>
<a href="#l36.44"></a><span id="l36.44">                                              aChangeLogListener);</span>
<a href="#l36.45"></a><span id="l36.45">                 if (thisCalendar.verboseLogging()) {</span>
<a href="#l36.46"></a><span id="l36.46">                     cal.LOG(&quot;CalDAV: ctag mismatch on refresh, fetching data for &quot; +</span>
<a href="#l36.47"></a><span id="l36.47">                             &quot;calendar &quot; + thisCalendar.name);</span>
<a href="#l36.48"></a><span id="l36.48" class="difflineminus">-</span>
<a href="#l36.49"></a><span id="l36.49">                 }</span>
<a href="#l36.50"></a><span id="l36.50">             } else {</span>
<a href="#l36.51"></a><span id="l36.51">                 if (thisCalendar.verboseLogging()) {</span>
<a href="#l36.52"></a><span id="l36.52">                     cal.LOG(&quot;CalDAV: ctag matches, no need to fetch data for &quot; +</span>
<a href="#l36.53"></a><span id="l36.53">                             &quot;calendar &quot; + thisCalendar.name);</span>
<a href="#l36.54"></a><span id="l36.54">                 }</span>
<a href="#l36.55"></a><span id="l36.55"> </span>
<a href="#l36.56"></a><span id="l36.56">                 // Notify the listener, but don't return just yet...</span>
<a href="#l36.57"></a><span id="l36.57" class="difflineat">@@ -1967,17 +1964,16 @@ calDavCalendar.prototype = {</span>
<a href="#l36.58"></a><span id="l36.58">                 dav = request.getResponseHeader(&quot;DAV&quot;);</span>
<a href="#l36.59"></a><span id="l36.59">                 if (thisCalendar.verboseLogging()) {</span>
<a href="#l36.60"></a><span id="l36.60">                     cal.LOG(&quot;CalDAV: DAV header: &quot; + dav);</span>
<a href="#l36.61"></a><span id="l36.61">                 }</span>
<a href="#l36.62"></a><span id="l36.62">             } catch (ex) {</span>
<a href="#l36.63"></a><span id="l36.63">                 cal.LOG(&quot;CalDAV: Error getting DAV header for &quot; + thisCalendar.name +</span>
<a href="#l36.64"></a><span id="l36.64">                         &quot;, status &quot; + request.responseStatus +</span>
<a href="#l36.65"></a><span id="l36.65">                         &quot;, data: &quot; + cal.convertByteArray(aResult, aResultLength));</span>
<a href="#l36.66"></a><span id="l36.66" class="difflineminus">-</span>
<a href="#l36.67"></a><span id="l36.67">             }</span>
<a href="#l36.68"></a><span id="l36.68">             // Google does not yet support OPTIONS but does support scheduling</span>
<a href="#l36.69"></a><span id="l36.69">             // so we'll spoof the DAV header until Google gets fixed</span>
<a href="#l36.70"></a><span id="l36.70">             if (thisCalendar.calendarUri.host == &quot;www.google.com&quot;) {</span>
<a href="#l36.71"></a><span id="l36.71">                 dav = &quot;calendar-schedule&quot;;</span>
<a href="#l36.72"></a><span id="l36.72">                 // Google also reports an inbox URL distinct from the calendar</span>
<a href="#l36.73"></a><span id="l36.73">                 // URL but a) doesn't use it and b) 405s on etag queries to it</span>
<a href="#l36.74"></a><span id="l36.74">                 thisCalendar.mShouldPollInbox = false;</span>
<a href="#l36.75"></a><span id="l36.75" class="difflineat">@@ -2377,26 +2373,24 @@ calDavCalendar.prototype = {</span>
<a href="#l36.76"></a><span id="l36.76">             statusString = props.GetStringFromName(&quot;caldavRequestStatusCodeString&quot; + status);</span>
<a href="#l36.77"></a><span id="l36.77">         } catch (e) {</span>
<a href="#l36.78"></a><span id="l36.78">             // Fallback on generic string if no string is defined for the status code</span>
<a href="#l36.79"></a><span id="l36.79">             statusString = props.GetStringFromName(&quot;caldavRequestStatusCodeStringGeneric&quot;);</span>
<a href="#l36.80"></a><span id="l36.80">         }</span>
<a href="#l36.81"></a><span id="l36.81">         return props.formatStringFromName(&quot;caldavRequestStatusCode&quot;, [ status ], 1) + &quot;, &quot; +</span>
<a href="#l36.82"></a><span id="l36.82">                statusString + &quot;\n\n&quot; +</span>
<a href="#l36.83"></a><span id="l36.83">                (extraInfo ? extraInfo : &quot;&quot;);</span>
<a href="#l36.84"></a><span id="l36.84" class="difflineminus">-</span>
<a href="#l36.85"></a><span id="l36.85">     },</span>
<a href="#l36.86"></a><span id="l36.86"> </span>
<a href="#l36.87"></a><span id="l36.87">     //</span>
<a href="#l36.88"></a><span id="l36.88">     // calIFreeBusyProvider interface</span>
<a href="#l36.89"></a><span id="l36.89">     //</span>
<a href="#l36.90"></a><span id="l36.90"> </span>
<a href="#l36.91"></a><span id="l36.91">     getFreeBusyIntervals: function caldav_getFreeBusyIntervals(</span>
<a href="#l36.92"></a><span id="l36.92" class="difflineminus">-        aCalId, aRangeStart, aRangeEnd, aBusyTypes, aListener) {</span>
<a href="#l36.93"></a><span id="l36.93" class="difflineminus">-</span>
<a href="#l36.94"></a><span id="l36.94" class="difflineplus">+                             aCalId, aRangeStart, aRangeEnd, aBusyTypes, aListener) {</span>
<a href="#l36.95"></a><span id="l36.95">         // We explicitly don't check for hasScheduling here to allow free-busy queries</span>
<a href="#l36.96"></a><span id="l36.96">         // even in case sched is turned off.</span>
<a href="#l36.97"></a><span id="l36.97">         if (!this.outboxUrl || !this.calendarUserAddress) {</span>
<a href="#l36.98"></a><span id="l36.98">             cal.LOG(&quot;CalDAV: Calendar &quot; + this.name + &quot; doen't support scheduling;&quot; +</span>
<a href="#l36.99"></a><span id="l36.99">                     &quot; freebusy query not possible&quot;);</span>
<a href="#l36.100"></a><span id="l36.100">             aListener.onResult(null, null);</span>
<a href="#l36.101"></a><span id="l36.101">             return;</span>
<a href="#l36.102"></a><span id="l36.102">         }</span>
<a href="#l36.103"></a><span id="l36.103" class="difflineat">@@ -2736,17 +2730,16 @@ calDavCalendar.prototype = {</span>
<a href="#l36.104"></a><span id="l36.104">     get senderAddress() {</span>
<a href="#l36.105"></a><span id="l36.105">         return this.mSenderAddress || this.calendarUserAddress;</span>
<a href="#l36.106"></a><span id="l36.106">     },</span>
<a href="#l36.107"></a><span id="l36.107">     set senderAddress(aString) {</span>
<a href="#l36.108"></a><span id="l36.108">         return (this.mSenderAddress = aString);</span>
<a href="#l36.109"></a><span id="l36.109">     },</span>
<a href="#l36.110"></a><span id="l36.110"> </span>
<a href="#l36.111"></a><span id="l36.111">     sendItems: function caldav_sendItems(aCount, aRecipients, aItipItem) {</span>
<a href="#l36.112"></a><span id="l36.112" class="difflineminus">-</span>
<a href="#l36.113"></a><span id="l36.113">         if (this.hasAutoScheduling) {</span>
<a href="#l36.114"></a><span id="l36.114">             // If auto scheduling is supported by the server we still need</span>
<a href="#l36.115"></a><span id="l36.115">             // to send out REPLIES for meetings where the ORGANIZER has the</span>
<a href="#l36.116"></a><span id="l36.116">             // parameter SCHEDULE-AGENT set to CLIENT, this property is</span>
<a href="#l36.117"></a><span id="l36.117">             // checked in in canNotify()</span>
<a href="#l36.118"></a><span id="l36.118">             if (aItipItem.responseMethod == &quot;REPLY&quot;) {</span>
<a href="#l36.119"></a><span id="l36.119">                 let imipTransport = cal.getImipTransport(this);</span>
<a href="#l36.120"></a><span id="l36.120">                 if (imipTransport) {</span>
<a href="#l36.121"></a><span id="l36.121" class="difflineat">@@ -2768,17 +2761,16 @@ calDavCalendar.prototype = {</span>
<a href="#l36.122"></a><span id="l36.122">             if (!attendee) {</span>
<a href="#l36.123"></a><span id="l36.123">                 return false;</span>
<a href="#l36.124"></a><span id="l36.124">             }</span>
<a href="#l36.125"></a><span id="l36.125">             // work around BUG 351589, the below just removes RSVP:</span>
<a href="#l36.126"></a><span id="l36.126">             aItipItem.setAttendeeStatus(attendee.id, attendee.participationStatus);</span>
<a href="#l36.127"></a><span id="l36.127">         }</span>
<a href="#l36.128"></a><span id="l36.128"> </span>
<a href="#l36.129"></a><span id="l36.129">         for (var item of aItipItem.getItemList({})) {</span>
<a href="#l36.130"></a><span id="l36.130" class="difflineminus">-</span>
<a href="#l36.131"></a><span id="l36.131">             var serializer = Components.classes[&quot;@mozilla.org/calendar/ics-serializer;1&quot;]</span>
<a href="#l36.132"></a><span id="l36.132">                                        .createInstance(Components.interfaces.calIIcsSerializer);</span>
<a href="#l36.133"></a><span id="l36.133">             serializer.addItems([item], 1);</span>
<a href="#l36.134"></a><span id="l36.134">             var methodProp = getIcsService().createIcalProperty(&quot;METHOD&quot;);</span>
<a href="#l36.135"></a><span id="l36.135">             methodProp.value = aItipItem.responseMethod;</span>
<a href="#l36.136"></a><span id="l36.136">             serializer.addProperty(methodProp);</span>
<a href="#l36.137"></a><span id="l36.137"> </span>
<a href="#l36.138"></a><span id="l36.138">             var thisCalendar = this;</span>
<a href="#l36.139"></a><span id="l36.139" class="difflineat">@@ -2894,17 +2886,16 @@ calDavCalendar.prototype = {</span>
<a href="#l36.140"></a><span id="l36.140">         if (this.verboseLogging()) {</span>
<a href="#l36.141"></a><span id="l36.141">             cal.LOG(&quot;CalDAV: send: &quot; + serializedItem);</span>
<a href="#l36.142"></a><span id="l36.142">         }</span>
<a href="#l36.143"></a><span id="l36.143">         return serializedItem;</span>
<a href="#l36.144"></a><span id="l36.144">     },</span>
<a href="#l36.145"></a><span id="l36.145"> </span>
<a href="#l36.146"></a><span id="l36.146">     // nsIChannelEventSink implementation</span>
<a href="#l36.147"></a><span id="l36.147">     asyncOnChannelRedirect: function caldav_asyncOonChannelRedirect(aOldChannel, aNewChannel, aFlags, aCallback) {</span>
<a href="#l36.148"></a><span id="l36.148" class="difflineminus">-</span>
<a href="#l36.149"></a><span id="l36.149">         let uploadData;</span>
<a href="#l36.150"></a><span id="l36.150">         let uploadContent;</span>
<a href="#l36.151"></a><span id="l36.151">         if (aOldChannel instanceof Components.interfaces.nsIUploadChannel &amp;&amp;</span>
<a href="#l36.152"></a><span id="l36.152">             aOldChannel instanceof Components.interfaces.nsIHttpChannel &amp;&amp;</span>
<a href="#l36.153"></a><span id="l36.153">             aOldChannel.uploadStream) {</span>
<a href="#l36.154"></a><span id="l36.154">             uploadData = aOldChannel.uploadStream;</span>
<a href="#l36.155"></a><span id="l36.155">             uploadContent = aOldChannel.getRequestHeader(&quot;Content-Type&quot;);</span>
<a href="#l36.156"></a><span id="l36.156">         }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/calendar/providers/caldav/calDavRequestHandlers.js</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavRequestHandlers.js</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -210,29 +210,27 @@ etagsHandler.prototype = {</span>
<a href="#l37.4"></a><span id="l37.4">             case &quot;getcontenttype&quot;:</span>
<a href="#l37.5"></a><span id="l37.5">                 this.tag = aLocalName;</span>
<a href="#l37.6"></a><span id="l37.6">                 this.currentResponse[aLocalName] = &quot;&quot;;</span>
<a href="#l37.7"></a><span id="l37.7">                 break;</span>
<a href="#l37.8"></a><span id="l37.8">         }</span>
<a href="#l37.9"></a><span id="l37.9">         if (this.calendar.verboseLogging()) {</span>
<a href="#l37.10"></a><span id="l37.10">             this.logXML += &quot;&lt;&quot; + aQName + &quot;&gt;&quot;;</span>
<a href="#l37.11"></a><span id="l37.11">         }</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-</span>
<a href="#l37.13"></a><span id="l37.13">     },</span>
<a href="#l37.14"></a><span id="l37.14"> </span>
<a href="#l37.15"></a><span id="l37.15">     endElement: function eH_endElement(aUri, aLocalName, aQName) {</span>
<a href="#l37.16"></a><span id="l37.16">         switch (aLocalName) {</span>
<a href="#l37.17"></a><span id="l37.17">             case &quot;response&quot;:</span>
<a href="#l37.18"></a><span id="l37.18">                 this.tag = null;</span>
<a href="#l37.19"></a><span id="l37.19">                 let r = this.currentResponse;</span>
<a href="#l37.20"></a><span id="l37.20">                 if (r.getetag &amp;&amp; r.getetag.length &amp;&amp;</span>
<a href="#l37.21"></a><span id="l37.21">                     r.href &amp;&amp; r.href.length &amp;&amp;</span>
<a href="#l37.22"></a><span id="l37.22">                     r.getcontenttype &amp;&amp; r.getcontenttype.length &amp;&amp;</span>
<a href="#l37.23"></a><span id="l37.23">                     !r.isCollection) {</span>
<a href="#l37.24"></a><span id="l37.24" class="difflineminus">-</span>
<a href="#l37.25"></a><span id="l37.25">                     r.href = this.calendar.ensureDecodedPath(r.href);</span>
<a href="#l37.26"></a><span id="l37.26"> </span>
<a href="#l37.27"></a><span id="l37.27">                     if (r.getcontenttype.substr(0, 14) == &quot;message/rfc822&quot;) {</span>
<a href="#l37.28"></a><span id="l37.28">                         // workaround for a Scalix bug which causes incorrect</span>
<a href="#l37.29"></a><span id="l37.29">                         // contenttype to be returned.</span>
<a href="#l37.30"></a><span id="l37.30">                         r.getcontenttype = &quot;text/calendar&quot;;</span>
<a href="#l37.31"></a><span id="l37.31">                     }</span>
<a href="#l37.32"></a><span id="l37.32">                     if (r.getcontenttype == &quot;text/vtodo&quot;) {</span>
<a href="#l37.33"></a><span id="l37.33" class="difflineat">@@ -493,17 +491,16 @@ webDavSyncHandler.prototype = {</span>
<a href="#l37.34"></a><span id="l37.34">                                                    this.calendar,</span>
<a href="#l37.35"></a><span id="l37.35">                                                    this.baseUri,</span>
<a href="#l37.36"></a><span id="l37.36">                                                    this.newSyncToken,</span>
<a href="#l37.37"></a><span id="l37.37">                                                    this.additionalSyncNeeded,</span>
<a href="#l37.38"></a><span id="l37.38">                                                    null,</span>
<a href="#l37.39"></a><span id="l37.39">                                                    this.changeLogListener)</span>
<a href="#l37.40"></a><span id="l37.40">             multiget.doMultiGet();</span>
<a href="#l37.41"></a><span id="l37.41">         }</span>
<a href="#l37.42"></a><span id="l37.42" class="difflineminus">-</span>
<a href="#l37.43"></a><span id="l37.43">     },</span>
<a href="#l37.44"></a><span id="l37.44"> </span>
<a href="#l37.45"></a><span id="l37.45">     startElement: function wH_startElement(aUri, aLocalName, aQName, aAttributes) {</span>
<a href="#l37.46"></a><span id="l37.46">         switch (aLocalName) {</span>
<a href="#l37.47"></a><span id="l37.47">             case &quot;response&quot;: // WebDAV Sync draft 3</span>
<a href="#l37.48"></a><span id="l37.48">                 this.currentResponse = {};</span>
<a href="#l37.49"></a><span id="l37.49">                 this.tag = null</span>
<a href="#l37.50"></a><span id="l37.50">                 this.isInPropStat = false;</span>
<a href="#l37.51"></a><span id="l37.51" class="difflineat">@@ -526,17 +523,16 @@ webDavSyncHandler.prototype = {</span>
<a href="#l37.52"></a><span id="l37.52">             case &quot;sync-token&quot;:</span>
<a href="#l37.53"></a><span id="l37.53">                 this.tag = aLocalName.replace(/-/g, '');</span>
<a href="#l37.54"></a><span id="l37.54">                 this.currentResponse[this.tag ] = &quot;&quot;;</span>
<a href="#l37.55"></a><span id="l37.55">                 break;</span>
<a href="#l37.56"></a><span id="l37.56">         }</span>
<a href="#l37.57"></a><span id="l37.57">         if (this.calendar.verboseLogging()) {</span>
<a href="#l37.58"></a><span id="l37.58">             this.logXML += &quot;&lt;&quot; + aQName + &quot;&gt;&quot;;</span>
<a href="#l37.59"></a><span id="l37.59">         }</span>
<a href="#l37.60"></a><span id="l37.60" class="difflineminus">-</span>
<a href="#l37.61"></a><span id="l37.61">     },</span>
<a href="#l37.62"></a><span id="l37.62"> </span>
<a href="#l37.63"></a><span id="l37.63">     endElement: function wH_endElement(aUri, aLocalName, aQName) {</span>
<a href="#l37.64"></a><span id="l37.64">         switch (aLocalName) {</span>
<a href="#l37.65"></a><span id="l37.65">             case &quot;response&quot;: // WebDAV Sync draft 3</span>
<a href="#l37.66"></a><span id="l37.66">             case &quot;sync-response&quot;: // WebDAV Sync draft 0,1,2</span>
<a href="#l37.67"></a><span id="l37.67">                 let r = this.currentResponse;</span>
<a href="#l37.68"></a><span id="l37.68">                 if (r.href &amp;&amp; r.href.length) {</span>
<a href="#l37.69"></a><span id="l37.69" class="difflineat">@@ -883,17 +879,16 @@ multigetSyncHandler.prototype = {</span>
<a href="#l37.70"></a><span id="l37.70">             case &quot;getetag&quot;:</span>
<a href="#l37.71"></a><span id="l37.71">                 this.tag = aLocalName.replace(/-/g, '');</span>
<a href="#l37.72"></a><span id="l37.72">                 this.currentResponse[this.tag ] = &quot;&quot;;</span>
<a href="#l37.73"></a><span id="l37.73">                 break;</span>
<a href="#l37.74"></a><span id="l37.74">         }</span>
<a href="#l37.75"></a><span id="l37.75">         if (this.calendar.verboseLogging()) {</span>
<a href="#l37.76"></a><span id="l37.76">             this.logXML += &quot;&lt;&quot; + aQName + &quot;&gt;&quot;;</span>
<a href="#l37.77"></a><span id="l37.77">         }</span>
<a href="#l37.78"></a><span id="l37.78" class="difflineminus">-</span>
<a href="#l37.79"></a><span id="l37.79">     },</span>
<a href="#l37.80"></a><span id="l37.80"> </span>
<a href="#l37.81"></a><span id="l37.81">     endElement: function mg_endElement(aUri, aLocalName, aQName) {</span>
<a href="#l37.82"></a><span id="l37.82">         switch (aLocalName) {</span>
<a href="#l37.83"></a><span id="l37.83">             case &quot;response&quot;:</span>
<a href="#l37.84"></a><span id="l37.84">                 let r = this.currentResponse;</span>
<a href="#l37.85"></a><span id="l37.85">                 if (r.href &amp;&amp;</span>
<a href="#l37.86"></a><span id="l37.86">                     r.href.length) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/calendar/providers/ics/calICSCalendar.js</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/calendar/providers/ics/calICSCalendar.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -289,17 +289,16 @@ calICSCalendar.prototype = {</span>
<a href="#l38.4"></a><span id="l38.4">                 this_.mObserver.onLoad(this_);</span>
<a href="#l38.5"></a><span id="l38.5"> </span>
<a href="#l38.6"></a><span id="l38.6">                 // Now that all items have been stuffed into the memory calendar</span>
<a href="#l38.7"></a><span id="l38.7">                 // we should add ourselves as observer. It is important that this</span>
<a href="#l38.8"></a><span id="l38.8">                 // happens *after* the calls to adoptItem in the above loop to prevent</span>
<a href="#l38.9"></a><span id="l38.9">                 // the views from being notified.</span>
<a href="#l38.10"></a><span id="l38.10">                 this_.mMemoryCalendar.addObserver(this_.mObserver);</span>
<a href="#l38.11"></a><span id="l38.11">                 this_.unlock();</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-</span>
<a href="#l38.13"></a><span id="l38.13">             }</span>
<a href="#l38.14"></a><span id="l38.14">         };</span>
<a href="#l38.15"></a><span id="l38.15">         parser.parseString(str, null, listener);</span>
<a href="#l38.16"></a><span id="l38.16">     },</span>
<a href="#l38.17"></a><span id="l38.17"> </span>
<a href="#l38.18"></a><span id="l38.18">     writeICS: function () {</span>
<a href="#l38.19"></a><span id="l38.19">         cal.LOG(&quot;[calICSCalendar] Commencing write of ICS Calendar &quot; + this.name);</span>
<a href="#l38.20"></a><span id="l38.20">         this.lock();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/calendar/providers/storage/calStorageCalendar.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/calendar/providers/storage/calStorageCalendar.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -194,17 +194,16 @@ calStorageCalendar.prototype = {</span>
<a href="#l39.4"></a><span id="l39.4">             let fileURL = this.uri.QueryInterface(Components.interfaces.nsIFileURL);</span>
<a href="#l39.5"></a><span id="l39.5">             if (!fileURL) {</span>
<a href="#l39.6"></a><span id="l39.6">                 throw new Components.Exception(&quot;Invalid file&quot;, Components.results.NS_ERROR_NOT_IMPLEMENTED);</span>
<a href="#l39.7"></a><span id="l39.7">             }</span>
<a href="#l39.8"></a><span id="l39.8">             // open the database</span>
<a href="#l39.9"></a><span id="l39.9">             this.mDB = Services.storage.openDatabase(fileURL.file);</span>
<a href="#l39.10"></a><span id="l39.10">             this.mDB.executeSimpleSQL(&quot;PRAGMA journal_mode=WAL&quot;);</span>
<a href="#l39.11"></a><span id="l39.11">             upgradeDB(this.mDB);</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-</span>
<a href="#l39.13"></a><span id="l39.13">         } else if (this.uri.schemeIs(&quot;moz-profile-calendar&quot;)) {</span>
<a href="#l39.14"></a><span id="l39.14">             // This is an old-style moz-profile-calendar. It requires some</span>
<a href="#l39.15"></a><span id="l39.15">             // migration steps.</span>
<a href="#l39.16"></a><span id="l39.16"> </span>
<a href="#l39.17"></a><span id="l39.17">             let localDB = cal.getCalendarDirectory();</span>
<a href="#l39.18"></a><span id="l39.18">             localDB.append(&quot;local.sqlite&quot;);</span>
<a href="#l39.19"></a><span id="l39.19">             localDB = Services.storage.openDatabase(localDB);</span>
<a href="#l39.20"></a><span id="l39.20"> </span>
<a href="#l39.21"></a><span id="l39.21" class="difflineat">@@ -920,17 +919,16 @@ calStorageCalendar.prototype = {</span>
<a href="#l39.22"></a><span id="l39.22">                 let todoitem = this.mRecTodoCache[id];</span>
<a href="#l39.23"></a><span id="l39.23">                 let offline_journal_flag = this.mRecTodoCacheOfflineFlags[todoitem.id] || null;</span>
<a href="#l39.24"></a><span id="l39.24">                 if ((sp.offline_journal == null &amp;&amp;</span>
<a href="#l39.25"></a><span id="l39.25">                      (offline_journal_flag == cICL.OFFLINE_FLAG_MODIFIED_RECORD ||</span>
<a href="#l39.26"></a><span id="l39.26">                       offline_journal_flag == cICL.OFFLINE_FLAG_CREATED_RECORD ||</span>
<a href="#l39.27"></a><span id="l39.27">                       offline_journal_flag == null)) ||</span>
<a href="#l39.28"></a><span id="l39.28">                     (sp.offline_journal != null &amp;&amp;</span>
<a href="#l39.29"></a><span id="l39.29">                      (offline_journal_flag == sp.offline_journal))) {</span>
<a href="#l39.30"></a><span id="l39.30" class="difflineminus">-</span>
<a href="#l39.31"></a><span id="l39.31">                     count += handleResultItem(todoitem,</span>
<a href="#l39.32"></a><span id="l39.32">                                               Components.interfaces.calITodo,</span>
<a href="#l39.33"></a><span id="l39.33">                                               checkCompleted);</span>
<a href="#l39.34"></a><span id="l39.34">                     if (checkCount()) {</span>
<a href="#l39.35"></a><span id="l39.35">                         return;</span>
<a href="#l39.36"></a><span id="l39.36">                     }</span>
<a href="#l39.37"></a><span id="l39.37">                 }</span>
<a href="#l39.38"></a><span id="l39.38">             }</span>
<a href="#l39.39"></a><span id="l39.39" class="difflineat">@@ -940,17 +938,16 @@ calStorageCalendar.prototype = {</span>
<a href="#l39.40"></a><span id="l39.40">         queueItems(null);</span>
<a href="#l39.41"></a><span id="l39.41"> </span>
<a href="#l39.42"></a><span id="l39.42">         // and finish</span>
<a href="#l39.43"></a><span id="l39.43">         this.notifyOperationComplete(aListener,</span>
<a href="#l39.44"></a><span id="l39.44">                                      Components.results.NS_OK,</span>
<a href="#l39.45"></a><span id="l39.45">                                      Components.interfaces.calIOperationListener.GET,</span>
<a href="#l39.46"></a><span id="l39.46">                                      null,</span>
<a href="#l39.47"></a><span id="l39.47">                                      null);</span>
<a href="#l39.48"></a><span id="l39.48" class="difflineminus">-</span>
<a href="#l39.49"></a><span id="l39.49">     },</span>
<a href="#l39.50"></a><span id="l39.50"> </span>
<a href="#l39.51"></a><span id="l39.51">     getItemOfflineFlag: function cSC_getOfflineJournalFlag(aItem, aListener) {</span>
<a href="#l39.52"></a><span id="l39.52">         let flag = null;</span>
<a href="#l39.53"></a><span id="l39.53">         if (!aItem) {</span>
<a href="#l39.54"></a><span id="l39.54">             // It is possible that aItem can be null, flag provided should be null in this case</span>
<a href="#l39.55"></a><span id="l39.55">             aListener.onOperationComplete(this, Components.results.NS_OK,</span>
<a href="#l39.56"></a><span id="l39.56">                                                Components.interfaces.calIOperationListener.GET, null, flag);</span>
<a href="#l39.57"></a><span id="l39.57" class="difflineat">@@ -992,17 +989,16 @@ calStorageCalendar.prototype = {</span>
<a href="#l39.58"></a><span id="l39.58">             this.mEditEventOfflineFlag.params.offline_journal = flag || null;</span>
<a href="#l39.59"></a><span id="l39.59">             try {</span>
<a href="#l39.60"></a><span id="l39.60">                 this.mEditEventOfflineFlag.executeStep();</span>
<a href="#l39.61"></a><span id="l39.61">             } catch (e) {</span>
<a href="#l39.62"></a><span id="l39.62">                 this.logError(&quot;Error setting offline journal flag for &quot; + aItem.title, e);</span>
<a href="#l39.63"></a><span id="l39.63">             } finally {</span>
<a href="#l39.64"></a><span id="l39.64">                 this.mEditEventOfflineFlag.reset();</span>
<a href="#l39.65"></a><span id="l39.65">             }</span>
<a href="#l39.66"></a><span id="l39.66" class="difflineminus">-</span>
<a href="#l39.67"></a><span id="l39.67">         } else if (cal.isToDo(aItem)) {</span>
<a href="#l39.68"></a><span id="l39.68">             this.prepareStatement(this.mEditTodoOfflineFlag);</span>
<a href="#l39.69"></a><span id="l39.69">             this.mEditTodoOfflineFlag.params.id = aID;</span>
<a href="#l39.70"></a><span id="l39.70">             this.mEditTodoOfflineFlag.params.offline_journal = flag || null;</span>
<a href="#l39.71"></a><span id="l39.71">             try {</span>
<a href="#l39.72"></a><span id="l39.72">                 this.mEditTodoOfflineFlag.executeStep();</span>
<a href="#l39.73"></a><span id="l39.73">             } catch (e) {</span>
<a href="#l39.74"></a><span id="l39.74">                 this.logError(&quot;Error setting offline journal flag for &quot; + aItem.title, e);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/calendar/providers/storage/calStorageUpgrade.jsm</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/calendar/providers/storage/calStorageUpgrade.jsm</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -739,17 +739,16 @@ upgrade.v3 = function upgrade_v3(db, ver</span>
<a href="#l40.4"></a><span id="l40.4">                              &quot; WHERE &quot; + field + &quot; IS NOT NULL&quot;);</span>
<a href="#l40.5"></a><span id="l40.5">     }</span>
<a href="#l40.6"></a><span id="l40.6"> </span>
<a href="#l40.7"></a><span id="l40.7">     let tbl = upgrade.v2(version &lt; 2 &amp;&amp; db, version);</span>
<a href="#l40.8"></a><span id="l40.8">     LOGdb(db, &quot;Storage: Upgrading to v3&quot;);</span>
<a href="#l40.9"></a><span id="l40.9"> </span>
<a href="#l40.10"></a><span id="l40.10">     beginTransaction(db);</span>
<a href="#l40.11"></a><span id="l40.11">     try {</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-</span>
<a href="#l40.13"></a><span id="l40.13">         copyTable(tbl, &quot;cal_items&quot;, &quot;cal_events&quot;, db, &quot;item_type = 0&quot;);</span>
<a href="#l40.14"></a><span id="l40.14">         copyTable(tbl, &quot;cal_items&quot;, &quot;cal_todos&quot;, db, &quot;item_type = 1&quot;);</span>
<a href="#l40.15"></a><span id="l40.15"> </span>
<a href="#l40.16"></a><span id="l40.16">         dropTable(tbl, &quot;cal_items&quot;, db);</span>
<a href="#l40.17"></a><span id="l40.17"> </span>
<a href="#l40.18"></a><span id="l40.18">         let removeEventCols = [&quot;item_type&quot;,</span>
<a href="#l40.19"></a><span id="l40.19">                                &quot;item_type&quot;,</span>
<a href="#l40.20"></a><span id="l40.20">                                &quot;todo_entry&quot;,</span>
<a href="#l40.21"></a><span id="l40.21" class="difflineat">@@ -1156,17 +1155,16 @@ upgrade.v16 = function upgrade_v16(db, v</span>
<a href="#l40.22"></a><span id="l40.22">                                  &quot;                        recurrence_id, &quot; +</span>
<a href="#l40.23"></a><span id="l40.23">                                  &quot;                        recurrence_id_tz, &quot; +</span>
<a href="#l40.24"></a><span id="l40.24">                                  &quot;                        icalString)&quot; +</span>
<a href="#l40.25"></a><span id="l40.25">                                  &quot; SELECT cal_id, id, recurrence_id,&quot; +</span>
<a href="#l40.26"></a><span id="l40.26">                                  &quot;        recurrence_id_tz, &quot; + transAlarm +</span>
<a href="#l40.27"></a><span id="l40.27">                                  &quot;   FROM &quot; + tbl +</span>
<a href="#l40.28"></a><span id="l40.28">                                  &quot;  WHERE alarm_offset IS NOT NULL&quot; +</span>
<a href="#l40.29"></a><span id="l40.29">                                  &quot;     OR alarm_time IS NOT NULL;&quot;);</span>
<a href="#l40.30"></a><span id="l40.30" class="difflineminus">-</span>
<a href="#l40.31"></a><span id="l40.31">         };</span>
<a href="#l40.32"></a><span id="l40.32">         copyDataOver(&quot;cal_events&quot;);</span>
<a href="#l40.33"></a><span id="l40.33">         copyDataOver(&quot;cal_todos&quot;);</span>
<a href="#l40.34"></a><span id="l40.34">         removeFunction(db, &quot;translateAlarm&quot;);</span>
<a href="#l40.35"></a><span id="l40.35"> </span>
<a href="#l40.36"></a><span id="l40.36">         // Make sure the alarm flag is set on the item</span>
<a href="#l40.37"></a><span id="l40.37">         executeSimpleSQL(db, &quot;UPDATE cal_events &quot; +</span>
<a href="#l40.38"></a><span id="l40.38">                              &quot;   SET flags = flags | &quot; + CAL_ITEM_FLAG.HAS_ALARMS +</span>
<a href="#l40.39"></a><span id="l40.39" class="difflineat">@@ -1253,17 +1251,16 @@ upgrade.v17 = function upgrade_v17(db, v</span>
<a href="#l40.40"></a><span id="l40.40">                       db,</span>
<a href="#l40.41"></a><span id="l40.41">                       null,</span>
<a href="#l40.42"></a><span id="l40.42">                       &quot;DISTINCT&quot;);</span>
<a href="#l40.43"></a><span id="l40.43">             renameTable(tbl,</span>
<a href="#l40.44"></a><span id="l40.44">                         &quot;cal_&quot; + tblName + &quot;_v17&quot;,</span>
<a href="#l40.45"></a><span id="l40.45">                         &quot;cal_&quot; + tblName,</span>
<a href="#l40.46"></a><span id="l40.46">                         db,</span>
<a href="#l40.47"></a><span id="l40.47">                         true);</span>
<a href="#l40.48"></a><span id="l40.48" class="difflineminus">-</span>
<a href="#l40.49"></a><span id="l40.49">         }</span>
<a href="#l40.50"></a><span id="l40.50">         setDbVersionAndCommit(db, 17);</span>
<a href="#l40.51"></a><span id="l40.51">     } catch (e) {</span>
<a href="#l40.52"></a><span id="l40.52">         throw reportErrorAndRollback(db, e);</span>
<a href="#l40.53"></a><span id="l40.53">     }</span>
<a href="#l40.54"></a><span id="l40.54"> </span>
<a href="#l40.55"></a><span id="l40.55">     return tbl;</span>
<a href="#l40.56"></a><span id="l40.56"> };</span>
<a href="#l40.57"></a><span id="l40.57" class="difflineat">@@ -1365,18 +1362,18 @@ upgrade.v20 = function upgrade_v20(db, v</span>
<a href="#l40.58"></a><span id="l40.58">  * Bug 785659 - Get rid of calIRecurrenceDateSet</span>
<a href="#l40.59"></a><span id="l40.59">  * Migrate x-dateset to x-date in the storage database</span>
<a href="#l40.60"></a><span id="l40.60">  * r=mmecca, p=philipp</span>
<a href="#l40.61"></a><span id="l40.61">  */</span>
<a href="#l40.62"></a><span id="l40.62"> upgrade.v21 = function upgrade_v21(db, version) {</span>
<a href="#l40.63"></a><span id="l40.63">     let tbl = upgrade.v20(version &lt; 20 &amp;&amp; db, version);</span>
<a href="#l40.64"></a><span id="l40.64">     LOGdb(db, &quot;Storage: Upgrading to v21&quot;);</span>
<a href="#l40.65"></a><span id="l40.65">     beginTransaction(db);</span>
<a href="#l40.66"></a><span id="l40.66" class="difflineplus">+</span>
<a href="#l40.67"></a><span id="l40.67">     try {</span>
<a href="#l40.68"></a><span id="l40.68" class="difflineminus">-</span>
<a href="#l40.69"></a><span id="l40.69">         // The following operation is only important on a live DB, since we are</span>
<a href="#l40.70"></a><span id="l40.70">         // changing only the values on the DB, not the schema itself.</span>
<a href="#l40.71"></a><span id="l40.71">         if (db) {</span>
<a href="#l40.72"></a><span id="l40.72">             // Oh boy, here we go :-)</span>
<a href="#l40.73"></a><span id="l40.73">             // Insert a new row with the following columns...</span>
<a href="#l40.74"></a><span id="l40.74">             let insertSQL = 'INSERT INTO cal_recurrence ' +</span>
<a href="#l40.75"></a><span id="l40.75">                             '            (item_id, cal_id, recur_type, recur_index,' +</span>
<a href="#l40.76"></a><span id="l40.76">                             '             is_negative, dates, end_date, count,' +</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapCalendar.js</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapCalendar.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -206,18 +206,17 @@ calWcapCalendar.prototype = {</span>
<a href="#l41.4"></a><span id="l41.4">         log(&quot;refresh.&quot;, this);</span>
<a href="#l41.5"></a><span id="l41.5">         // invalidate cached results:</span>
<a href="#l41.6"></a><span id="l41.6">         delete this.m_cachedResults;</span>
<a href="#l41.7"></a><span id="l41.7">         // notify about refreshed calendar:</span>
<a href="#l41.8"></a><span id="l41.8">         this.notifyObservers(&quot;onLoad&quot;, [this]);</span>
<a href="#l41.9"></a><span id="l41.9">     },</span>
<a href="#l41.10"></a><span id="l41.10"> </span>
<a href="#l41.11"></a><span id="l41.11">     issueNetworkRequest: function calWcapCalendar_issueNetworkRequest(</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-        request, respFunc, dataConvFunc, wcapCommand, params, accessRights) {</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineminus">-</span>
<a href="#l41.14"></a><span id="l41.14" class="difflineplus">+              request, respFunc, dataConvFunc, wcapCommand, params, accessRights) {</span>
<a href="#l41.15"></a><span id="l41.15">         var this_ = this;</span>
<a href="#l41.16"></a><span id="l41.16">         // - bootstrap problem: no cal_props, no access check, no default calId</span>
<a href="#l41.17"></a><span id="l41.17">         // - assure being logged in, thus the default cal_props are available</span>
<a href="#l41.18"></a><span id="l41.18">         // - every subscribed calendar will come along with cal_props</span>
<a href="#l41.19"></a><span id="l41.19">         return this.session.getSessionId(</span>
<a href="#l41.20"></a><span id="l41.20">             request,</span>
<a href="#l41.21"></a><span id="l41.21">             function getSessionId_resp(err, sessionId) {</span>
<a href="#l41.22"></a><span id="l41.22">                 try {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapCalendarItems.js</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapCalendarItems.js</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -345,17 +345,16 @@ function calWcapCalendar_storeItem(bAddI</span>
<a href="#l42.4"></a><span id="l42.4">             }</span>
<a href="#l42.5"></a><span id="l42.5">             if (!oldAtt || (att.participationStatus != oldAtt.participationStatus)) {</span>
<a href="#l42.6"></a><span id="l42.6">                 // REPLY first for just this calendar:</span>
<a href="#l42.7"></a><span id="l42.7">                 params += (&quot;&amp;attendees=PARTSTAT=&quot; + att.participationStatus +</span>
<a href="#l42.8"></a><span id="l42.8">                            &quot;^&quot; + encodeURIComponent(att.id));</span>
<a href="#l42.9"></a><span id="l42.9">             }</span>
<a href="#l42.10"></a><span id="l42.10">         }</span>
<a href="#l42.11"></a><span id="l42.11">     } else { // PUBLISH, REQUEST</span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-</span>
<a href="#l42.13"></a><span id="l42.13">         // workarounds for server bugs concerning recurrences/exceptions:</span>
<a href="#l42.14"></a><span id="l42.14">         // - if first occurrence is an exception</span>
<a href="#l42.15"></a><span id="l42.15">         //   and an EXDATE for that occurrence ought to be written,</span>
<a href="#l42.16"></a><span id="l42.16">         //   then the master item's data is replaced with that EXDATEd exception. WTF.</span>
<a href="#l42.17"></a><span id="l42.17">         // - if start/end date is being written on master, the previously EXDATEd</span>
<a href="#l42.18"></a><span id="l42.18">         //   exception overwrites master, why ever.</span>
<a href="#l42.19"></a><span id="l42.19">         // So in these cases: write all data of master.</span>
<a href="#l42.20"></a><span id="l42.20"> </span>
<a href="#l42.21"></a><span id="l42.21" class="difflineat">@@ -728,17 +727,16 @@ function calWcapCalendar_modifyItem(newI</span>
<a href="#l42.22"></a><span id="l42.22">                                              } finally {</span>
<a href="#l42.23"></a><span id="l42.23">                                                  request.unlockPending();</span>
<a href="#l42.24"></a><span id="l42.24">                                              }</span>
<a href="#l42.25"></a><span id="l42.25">                                          },</span>
<a href="#l42.26"></a><span id="l42.26">                                          stringToXml, isEvent(newItem) ? &quot;deleteevents_by_id&quot; : &quot;deletetodos_by_id&quot;,</span>
<a href="#l42.27"></a><span id="l42.27">                                          params, calIWcapCalendar.AC_COMP_WRITE);</span>
<a href="#l42.28"></a><span id="l42.28">                 return request;</span>
<a href="#l42.29"></a><span id="l42.29">             }</span>
<a href="#l42.30"></a><span id="l42.30" class="difflineminus">-</span>
<a href="#l42.31"></a><span id="l42.31">         } else if (oldItem &amp;&amp; !oldItem.parentItem.recurrenceInfo.getExceptionFor(newItem.recurrenceId)) {</span>
<a href="#l42.32"></a><span id="l42.32">             // pass null for oldItem when creating new exceptions, write whole item:</span>
<a href="#l42.33"></a><span id="l42.33">             oldItem_ = null;</span>
<a href="#l42.34"></a><span id="l42.34">         }</span>
<a href="#l42.35"></a><span id="l42.35">         this.storeItem(false /* bAddItem */, newItem, oldItem_, request);</span>
<a href="#l42.36"></a><span id="l42.36">     } catch (exc) {</span>
<a href="#l42.37"></a><span id="l42.37">         request.execRespFunc(exc);</span>
<a href="#l42.38"></a><span id="l42.38">     }</span>
<a href="#l42.39"></a><span id="l42.39" class="difflineat">@@ -846,17 +844,16 @@ calWcapCalendar.prototype.parseItems = f</span>
<a href="#l42.40"></a><span id="l42.40">             componentType = &quot;VEVENT&quot;;</span>
<a href="#l42.41"></a><span id="l42.41">             break;</span>
<a href="#l42.42"></a><span id="l42.42">     }</span>
<a href="#l42.43"></a><span id="l42.43"> </span>
<a href="#l42.44"></a><span id="l42.44">     let recurrenceBound = this.session.recurrenceBound;</span>
<a href="#l42.45"></a><span id="l42.45"> </span>
<a href="#l42.46"></a><span id="l42.46">     let count = 0;</span>
<a href="#l42.47"></a><span id="l42.47">     for (let subComp of cal.ical.calendarComponentIterator(icalRootComp, componentType)) {</span>
<a href="#l42.48"></a><span id="l42.48" class="difflineminus">-</span>
<a href="#l42.49"></a><span id="l42.49">         let organizer = subComp.getFirstProperty(&quot;ORGANIZER&quot;);</span>
<a href="#l42.50"></a><span id="l42.50">         if (organizer &amp;&amp; organizer.getParameter(&quot;SENT-BY&quot;)) { // has SENT-BY</span>
<a href="#l42.51"></a><span id="l42.51">             // &amp;emailorcalid=1 sets wrong email, workaround setting calid...</span>
<a href="#l42.52"></a><span id="l42.52">             let id = organizer.getParameter(&quot;X-S1CS-CALID&quot;);</span>
<a href="#l42.53"></a><span id="l42.53">             if (id) {</span>
<a href="#l42.54"></a><span id="l42.54">                 organizer.value = id;</span>
<a href="#l42.55"></a><span id="l42.55">             }</span>
<a href="#l42.56"></a><span id="l42.56">         }</span>
<a href="#l42.57"></a><span id="l42.57" class="difflineat">@@ -910,17 +907,16 @@ calWcapCalendar.prototype.parseItems = f</span>
<a href="#l42.58"></a><span id="l42.58">                 rid = rid.getInTimezone(dtstart.timezone);</span>
<a href="#l42.59"></a><span id="l42.59">                 item.recurrenceId = rid;</span>
<a href="#l42.60"></a><span id="l42.60">                 if (LOG_LEVEL &gt; 1) {</span>
<a href="#l42.61"></a><span id="l42.61">                     log(&quot;exception item: &quot; + item.title +</span>
<a href="#l42.62"></a><span id="l42.62">                         &quot;\nrid=&quot; + getIcalUTC(rid) +</span>
<a href="#l42.63"></a><span id="l42.63">                         &quot;\nitem.id=&quot; + item.id, this);</span>
<a href="#l42.64"></a><span id="l42.64">                 }</span>
<a href="#l42.65"></a><span id="l42.65">                 excItems.push(item);</span>
<a href="#l42.66"></a><span id="l42.66" class="difflineminus">-</span>
<a href="#l42.67"></a><span id="l42.67">             } else if (item.recurrenceInfo) {</span>
<a href="#l42.68"></a><span id="l42.68">                 unexpandedItems.push(item);</span>
<a href="#l42.69"></a><span id="l42.69">                 uid2parent[item.id] = item;</span>
<a href="#l42.70"></a><span id="l42.70">             } else if ((maxResults == 0 || items.length &lt; maxResults) &amp;&amp;</span>
<a href="#l42.71"></a><span id="l42.71">                        checkIfInRange(item, rangeStart, rangeEnd)) {</span>
<a href="#l42.72"></a><span id="l42.72">                 if (LOG_LEVEL &gt; 2) {</span>
<a href="#l42.73"></a><span id="l42.73">                     log(&quot;item: &quot; + item.title + &quot;\n&quot; + item.icalString, this);</span>
<a href="#l42.74"></a><span id="l42.74">                 }</span>
<a href="#l42.75"></a><span id="l42.75" class="difflineat">@@ -1010,17 +1006,16 @@ calWcapCalendar.prototype.parseItems = f</span>
<a href="#l42.76"></a><span id="l42.76">                     for (let occ of occurrences) {</span>
<a href="#l42.77"></a><span id="l42.77">                         log(&quot;item: &quot; + occ.title + &quot;\n&quot; + occ.icalString, this);</span>
<a href="#l42.78"></a><span id="l42.78">                     }</span>
<a href="#l42.79"></a><span id="l42.79">                 }</span>
<a href="#l42.80"></a><span id="l42.80">             }</span>
<a href="#l42.81"></a><span id="l42.81">             // only proxies returned:</span>
<a href="#l42.82"></a><span id="l42.82">             items = items.concat(occurrences);</span>
<a href="#l42.83"></a><span id="l42.83">         }</span>
<a href="#l42.84"></a><span id="l42.84" class="difflineminus">-</span>
<a href="#l42.85"></a><span id="l42.85">     } else {</span>
<a href="#l42.86"></a><span id="l42.86">         if (maxResults != 0 &amp;&amp;</span>
<a href="#l42.87"></a><span id="l42.87">             (items.length + unexpandedItems.length) &gt; maxResults) {</span>
<a href="#l42.88"></a><span id="l42.88">             unexpandedItems.length = (maxResults - items.length);</span>
<a href="#l42.89"></a><span id="l42.89">         }</span>
<a href="#l42.90"></a><span id="l42.90">         if (!bLeaveMutable) {</span>
<a href="#l42.91"></a><span id="l42.91">             for (let item of unexpandedItems) {</span>
<a href="#l42.92"></a><span id="l42.92">                 item.makeImmutable();</span>
<a href="#l42.93"></a><span id="l42.93" class="difflineat">@@ -1213,17 +1208,16 @@ function calWcapCalendar_getItems(itemFi</span>
<a href="#l42.94"></a><span id="l42.94">             request,</span>
<a href="#l42.95"></a><span id="l42.95">             function netResp(err, icalRootComp) {</span>
<a href="#l42.96"></a><span id="l42.96">                 if (err) {</span>
<a href="#l42.97"></a><span id="l42.97">                     if (checkErrorCode(err, calIWcapErrors.WCAP_ACCESS_DENIED_TO_CALENDAR)) {</span>
<a href="#l42.98"></a><span id="l42.98">                         // try free-busy times:</span>
<a href="#l42.99"></a><span id="l42.99">                         if (listener &amp;&amp;</span>
<a href="#l42.100"></a><span id="l42.100">                             (itemFilter &amp; calICalendar.ITEM_FILTER_TYPE_EVENT) &amp;&amp;</span>
<a href="#l42.101"></a><span id="l42.101">                             rangeStart &amp;&amp; rangeEnd) {</span>
<a href="#l42.102"></a><span id="l42.102" class="difflineminus">-</span>
<a href="#l42.103"></a><span id="l42.103">                             var freeBusyListener = { // calIGenericOperationListener:</span>
<a href="#l42.104"></a><span id="l42.104">                                 onResult: function freeBusyListener_onResult(request, result) {</span>
<a href="#l42.105"></a><span id="l42.105">                                     if (!Components.isSuccessCode(request.status)) {</span>
<a href="#l42.106"></a><span id="l42.106">                                         throw request.status;</span>
<a href="#l42.107"></a><span id="l42.107">                                     }</span>
<a href="#l42.108"></a><span id="l42.108">                                     var items = [];</span>
<a href="#l42.109"></a><span id="l42.109">                                     for (var entry of result) {</span>
<a href="#l42.110"></a><span id="l42.110">                                         var item = createEvent();</span>
<a href="#l42.111"></a><span id="l42.111" class="difflineat">@@ -1243,25 +1237,23 @@ function calWcapCalendar_getItems(itemFi</span>
<a href="#l42.112"></a><span id="l42.112">                                 this_.session.getFreeBusyIntervals(</span>
<a href="#l42.113"></a><span id="l42.113">                                     this_.calId, rangeStart, rangeEnd, calIFreeBusyInterval.BUSY_ALL,</span>
<a href="#l42.114"></a><span id="l42.114">                                     freeBusyListener));</span>
<a href="#l42.115"></a><span id="l42.115">                         }</span>
<a href="#l42.116"></a><span id="l42.116">                     } else {</span>
<a href="#l42.117"></a><span id="l42.117">                         throw err;</span>
<a href="#l42.118"></a><span id="l42.118">                     }</span>
<a href="#l42.119"></a><span id="l42.119">                 } else if (listener) {</span>
<a href="#l42.120"></a><span id="l42.120" class="difflineminus">-</span>
<a href="#l42.121"></a><span id="l42.121">                     var items = this_.parseItems(</span>
<a href="#l42.122"></a><span id="l42.122">                         icalRootComp, itemFilter, maxResults,</span>
<a href="#l42.123"></a><span id="l42.123">                         rangeStart, rangeEnd);</span>
<a href="#l42.124"></a><span id="l42.124"> </span>
<a href="#l42.125"></a><span id="l42.125">                     if (CACHE_LAST_RESULTS &gt; 0) {</span>
<a href="#l42.126"></a><span id="l42.126">                         // auto invalidate after X minutes:</span>
<a href="#l42.127"></a><span id="l42.127">                         if (!this_.m_cachedResultsTimer) {</span>
<a href="#l42.128"></a><span id="l42.128" class="difflineminus">-</span>
<a href="#l42.129"></a><span id="l42.129">                             var callback = {</span>
<a href="#l42.130"></a><span id="l42.130">                                 notify: function notify(timer) {</span>
<a href="#l42.131"></a><span id="l42.131">                                     if (!this_.m_cachedResults) {</span>
<a href="#l42.132"></a><span id="l42.132">                                         return;</span>
<a href="#l42.133"></a><span id="l42.133">                                     }</span>
<a href="#l42.134"></a><span id="l42.134">                                     var now = (new Date()).getTime();</span>
<a href="#l42.135"></a><span id="l42.135">                                     // sort out old entries:</span>
<a href="#l42.136"></a><span id="l42.136">                                     var entries = [];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapSession.js</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapSession.js</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -247,17 +247,16 @@ calWcapSession.prototype = {</span>
<a href="#l43.4"></a><span id="l43.4">                                });</span>
<a href="#l43.5"></a><span id="l43.5">         }</span>
<a href="#l43.6"></a><span id="l43.6">     },</span>
<a href="#l43.7"></a><span id="l43.7"> </span>
<a href="#l43.8"></a><span id="l43.8">     // this is a server limit for recurrencies; default is 60</span>
<a href="#l43.9"></a><span id="l43.9">     recurrenceBound: 60,</span>
<a href="#l43.10"></a><span id="l43.10"> </span>
<a href="#l43.11"></a><span id="l43.11">     getSessionId_: function calWcapSession_getSessionId_(request, respFunc) {</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-</span>
<a href="#l43.13"></a><span id="l43.13">         var this_ = this;</span>
<a href="#l43.14"></a><span id="l43.14">         this.checkServerVersion(</span>
<a href="#l43.15"></a><span id="l43.15">             request,</span>
<a href="#l43.16"></a><span id="l43.16">             // probe whether server is accessible and responds:</span>
<a href="#l43.17"></a><span id="l43.17">             function checkServerVersion_resp(err) {</span>
<a href="#l43.18"></a><span id="l43.18">                 if (err) {</span>
<a href="#l43.19"></a><span id="l43.19">                     respFunc(err);</span>
<a href="#l43.20"></a><span id="l43.20">                     return;</span>
<a href="#l43.21"></a><span id="l43.21" class="difflineat">@@ -455,17 +454,16 @@ calWcapSession.prototype = {</span>
<a href="#l43.22"></a><span id="l43.22"> </span>
<a href="#l43.23"></a><span id="l43.23">                         var prompt = Services.ww.getNewPrompter(null);</span>
<a href="#l43.24"></a><span id="l43.24">                         var labelText = cal.calGetString(&quot;wcap&quot;, &quot;insufficientWcapVersionConfirmation.label&quot;);</span>
<a href="#l43.25"></a><span id="l43.25">                         if (!prompt.confirm(labelText,</span>
<a href="#l43.26"></a><span id="l43.26">                                             cal.calGetString(&quot;wcap&quot;, &quot;insufficientWcapVersionConfirmation.text&quot;, vars))) {</span>
<a href="#l43.27"></a><span id="l43.27">                             throw new Components.Exception(labelText, calIWcapErrors.WCAP_LOGIN_FAILED);</span>
<a href="#l43.28"></a><span id="l43.28">                         }</span>
<a href="#l43.29"></a><span id="l43.29">                     }</span>
<a href="#l43.30"></a><span id="l43.30" class="difflineminus">-</span>
<a href="#l43.31"></a><span id="l43.31">                 } catch (exc) {</span>
<a href="#l43.32"></a><span id="l43.32">                     err = exc;</span>
<a href="#l43.33"></a><span id="l43.33">                 }</span>
<a href="#l43.34"></a><span id="l43.34">                 respFunc(err);</span>
<a href="#l43.35"></a><span id="l43.35">             },</span>
<a href="#l43.36"></a><span id="l43.36">             this_.sessionUri.spec + &quot;version.wcap?fmt-out=text%2Fcalendar&quot;);</span>
<a href="#l43.37"></a><span id="l43.37">     },</span>
<a href="#l43.38"></a><span id="l43.38"> </span>
<a href="#l43.39"></a><span id="l43.39" class="difflineat">@@ -495,17 +493,16 @@ calWcapSession.prototype = {</span>
<a href="#l43.40"></a><span id="l43.40">                     // get calprops for all registered calendars:</span>
<a href="#l43.41"></a><span id="l43.41">                     var cals = this_.getRegisteredCalendars(true);</span>
<a href="#l43.42"></a><span id="l43.42"> </span>
<a href="#l43.43"></a><span id="l43.43">                     var calprops_resp = null;</span>
<a href="#l43.44"></a><span id="l43.44">                     var defaultCal = this_.defaultCalendar;</span>
<a href="#l43.45"></a><span id="l43.45">                     if (defaultCal &amp;&amp; cals[defaultCal.calId] &amp;&amp; // default calendar is registered</span>
<a href="#l43.46"></a><span id="l43.46">                         getPref(&quot;calendar.wcap.subscriptions&quot;, true) &amp;&amp;</span>
<a href="#l43.47"></a><span id="l43.47">                         !defaultCal.getProperty(&quot;subscriptions_registered&quot;)) {</span>
<a href="#l43.48"></a><span id="l43.48" class="difflineminus">-</span>
<a href="#l43.49"></a><span id="l43.49">                         var hasSubscriptions = false;</span>
<a href="#l43.50"></a><span id="l43.50">                         // post register subscribed calendars:</span>
<a href="#l43.51"></a><span id="l43.51">                         var list = this_.getUserPreferences(&quot;X-NSCP-WCAP-PREF-icsSubscribed&quot;);</span>
<a href="#l43.52"></a><span id="l43.52">                         for (var item of list) {</span>
<a href="#l43.53"></a><span id="l43.53">                             var ar = item.split(',');</span>
<a href="#l43.54"></a><span id="l43.54">                             // ',', '$' are not encoded. ',' can be handled here. WTF.</span>
<a href="#l43.55"></a><span id="l43.55">                             for (var a of ar) {</span>
<a href="#l43.56"></a><span id="l43.56">                                 var dollar = a.indexOf('$');</span>
<a href="#l43.57"></a><span id="l43.57" class="difflineat">@@ -545,25 +542,23 @@ calWcapSession.prototype = {</span>
<a href="#l43.58"></a><span id="l43.58">                         this_.installCalProps_get_calprops(calprops_resp, sessionId, cals, request);</span>
<a href="#l43.59"></a><span id="l43.59">                     }</span>
<a href="#l43.60"></a><span id="l43.60">                 },</span>
<a href="#l43.61"></a><span id="l43.61">                 stringToXml, &quot;get_userprefs&quot;,</span>
<a href="#l43.62"></a><span id="l43.62">                 &quot;&amp;fmt-out=text%2Fxml&amp;userid=&quot; + encodeURIComponent(this.credentials.userId),</span>
<a href="#l43.63"></a><span id="l43.63">                 sessionId);</span>
<a href="#l43.64"></a><span id="l43.64">             this.installServerTimeDiff(sessionId, request);</span>
<a href="#l43.65"></a><span id="l43.65">             this.installServerTimezones(sessionId, request);</span>
<a href="#l43.66"></a><span id="l43.66" class="difflineminus">-</span>
<a href="#l43.67"></a><span id="l43.67">         } finally {</span>
<a href="#l43.68"></a><span id="l43.68">             request.unlockPending();</span>
<a href="#l43.69"></a><span id="l43.69">         }</span>
<a href="#l43.70"></a><span id="l43.70">     },</span>
<a href="#l43.71"></a><span id="l43.71"> </span>
<a href="#l43.72"></a><span id="l43.72">     installCalProps_get_calprops:</span>
<a href="#l43.73"></a><span id="l43.73">     function calWcapSession_installCalProps_get_calprops(respFunc, sessionId, cals, request) {</span>
<a href="#l43.74"></a><span id="l43.74" class="difflineminus">-</span>
<a href="#l43.75"></a><span id="l43.75">         var this_ = this;</span>
<a href="#l43.76"></a><span id="l43.76">         function calprops_resp(err, data) {</span>
<a href="#l43.77"></a><span id="l43.77">             if (err) {</span>
<a href="#l43.78"></a><span id="l43.78">                 throw err;</span>
<a href="#l43.79"></a><span id="l43.79">             }</span>
<a href="#l43.80"></a><span id="l43.80">             // string to xml converter func without WCAP errno check:</span>
<a href="#l43.81"></a><span id="l43.81">             if (!data || data.length == 0) { // assuming time-out</span>
<a href="#l43.82"></a><span id="l43.82">                 throw new Components.Exception(errorToString(calIWcapErrors.WCAP_LOGIN_FAILED),</span>
<a href="#l43.83"></a><span id="l43.83" class="difflineat">@@ -587,17 +582,16 @@ calWcapSession.prototype = {</span>
<a href="#l43.84"></a><span id="l43.84">                         }</span>
<a href="#l43.85"></a><span id="l43.85">                         if (calendar) {</span>
<a href="#l43.86"></a><span id="l43.86">                             calendar.m_calProps = node;</span>
<a href="#l43.87"></a><span id="l43.87">                             if (respFunc) {</span>
<a href="#l43.88"></a><span id="l43.88">                                 respFunc(calendar);</span>
<a href="#l43.89"></a><span id="l43.89">                             }</span>
<a href="#l43.90"></a><span id="l43.90">                         }</span>
<a href="#l43.91"></a><span id="l43.91">                     }</span>
<a href="#l43.92"></a><span id="l43.92" class="difflineminus">-</span>
<a href="#l43.93"></a><span id="l43.93">                 } catch (exc) { // ignore but log any errors on subscribed calendars:</span>
<a href="#l43.94"></a><span id="l43.94">                     logError(exc, this_);</span>
<a href="#l43.95"></a><span id="l43.95">                 }</span>
<a href="#l43.96"></a><span id="l43.96">             }</span>
<a href="#l43.97"></a><span id="l43.97">         }</span>
<a href="#l43.98"></a><span id="l43.98"> </span>
<a href="#l43.99"></a><span id="l43.99">         var calidParam = &quot;&quot;;</span>
<a href="#l43.100"></a><span id="l43.100">         for (var calId in cals) {</span>
<a href="#l43.101"></a><span id="l43.101" class="difflineat">@@ -709,18 +703,17 @@ calWcapSession.prototype = {</span>
<a href="#l43.102"></a><span id="l43.102">         var url = this.sessionUri.spec;</span>
<a href="#l43.103"></a><span id="l43.103">         url += (wcapCommand + &quot;.wcap?appid=mozilla-calendar&amp;id=&quot;);</span>
<a href="#l43.104"></a><span id="l43.104">         url += sessionId;</span>
<a href="#l43.105"></a><span id="l43.105">         url += params;</span>
<a href="#l43.106"></a><span id="l43.106">         return url;</span>
<a href="#l43.107"></a><span id="l43.107">     },</span>
<a href="#l43.108"></a><span id="l43.108"> </span>
<a href="#l43.109"></a><span id="l43.109">     issueNetworkRequest: function calWcapSession_issueNetworkRequest(</span>
<a href="#l43.110"></a><span id="l43.110" class="difflineminus">-        request, respFunc, dataConvFunc, wcapCommand, params) {</span>
<a href="#l43.111"></a><span id="l43.111" class="difflineminus">-</span>
<a href="#l43.112"></a><span id="l43.112" class="difflineplus">+                    request, respFunc, dataConvFunc, wcapCommand, params) {</span>
<a href="#l43.113"></a><span id="l43.113">         var this_ = this;</span>
<a href="#l43.114"></a><span id="l43.114">         function getSessionId_resp(err, sessionId) {</span>
<a href="#l43.115"></a><span id="l43.115">             if (err) {</span>
<a href="#l43.116"></a><span id="l43.116">                 request.execSubRespFunc(respFunc, err);</span>
<a href="#l43.117"></a><span id="l43.117">             } else {</span>
<a href="#l43.118"></a><span id="l43.118">                 // else have session uri and id:</span>
<a href="#l43.119"></a><span id="l43.119">                 this_.issueNetworkRequest_(</span>
<a href="#l43.120"></a><span id="l43.120">                     request,</span>
<a href="#l43.121"></a><span id="l43.121" class="difflineat">@@ -738,18 +731,17 @@ calWcapSession.prototype = {</span>
<a href="#l43.122"></a><span id="l43.122">                     },</span>
<a href="#l43.123"></a><span id="l43.123">                     dataConvFunc, wcapCommand, params, sessionId);</span>
<a href="#l43.124"></a><span id="l43.124">             }</span>
<a href="#l43.125"></a><span id="l43.125">         }</span>
<a href="#l43.126"></a><span id="l43.126">         this.getSessionId(request, getSessionId_resp);</span>
<a href="#l43.127"></a><span id="l43.127">     },</span>
<a href="#l43.128"></a><span id="l43.128"> </span>
<a href="#l43.129"></a><span id="l43.129">     issueNetworkRequest_: function calWcapSession_issueNetworkRequest_(</span>
<a href="#l43.130"></a><span id="l43.130" class="difflineminus">-        request, respFunc, dataConvFunc, wcapCommand, params, sessionId) {</span>
<a href="#l43.131"></a><span id="l43.131" class="difflineminus">-</span>
<a href="#l43.132"></a><span id="l43.132" class="difflineplus">+                    request, respFunc, dataConvFunc, wcapCommand, params, sessionId) {</span>
<a href="#l43.133"></a><span id="l43.133">         var url = this.getCommandUrl(wcapCommand, params, sessionId);</span>
<a href="#l43.134"></a><span id="l43.134">         var this_ = this;</span>
<a href="#l43.135"></a><span id="l43.135">         issueNetworkRequest(request,</span>
<a href="#l43.136"></a><span id="l43.136">                             function netResp(err, str) {</span>
<a href="#l43.137"></a><span id="l43.137">                                 var data;</span>
<a href="#l43.138"></a><span id="l43.138">                                 if (!err) {</span>
<a href="#l43.139"></a><span id="l43.139">                                     try {</span>
<a href="#l43.140"></a><span id="l43.140">                                         if (dataConvFunc) {</span>
<a href="#l43.141"></a><span id="l43.141" class="difflineat">@@ -938,17 +930,16 @@ calWcapSession.prototype = {</span>
<a href="#l43.142"></a><span id="l43.142">                                     break;</span>
<a href="#l43.143"></a><span id="l43.143">                             }</span>
<a href="#l43.144"></a><span id="l43.144">                         }</span>
<a href="#l43.145"></a><span id="l43.145">                     }</span>
<a href="#l43.146"></a><span id="l43.146">                     log(&quot;search done. number of found calendars: &quot; + ret.length, this_);</span>
<a href="#l43.147"></a><span id="l43.147">                     request.execRespFunc(null, ret);</span>
<a href="#l43.148"></a><span id="l43.148">                 },</span>
<a href="#l43.149"></a><span id="l43.149">                 null, &quot;search_calprops&quot;, params);</span>
<a href="#l43.150"></a><span id="l43.150" class="difflineminus">-</span>
<a href="#l43.151"></a><span id="l43.151">         } catch (exc) {</span>
<a href="#l43.152"></a><span id="l43.152">             request.execRespFunc(exc);</span>
<a href="#l43.153"></a><span id="l43.153">         }</span>
<a href="#l43.154"></a><span id="l43.154">         return request;</span>
<a href="#l43.155"></a><span id="l43.155">     },</span>
<a href="#l43.156"></a><span id="l43.156"> </span>
<a href="#l43.157"></a><span id="l43.157">     // calIFreeBusyProvider:</span>
<a href="#l43.158"></a><span id="l43.158">     getFreeBusyIntervals:</span>
<a href="#l43.159"></a><span id="l43.159" class="difflineat">@@ -1031,17 +1022,16 @@ calWcapSession.prototype = {</span>
<a href="#l43.160"></a><span id="l43.160"> </span>
<a href="#l43.161"></a><span id="l43.161">                                 ret.push(new cal.FreeBusyInterval(calId, fbType, start, end));</span>
<a href="#l43.162"></a><span id="l43.162">                             }</span>
<a href="#l43.163"></a><span id="l43.163">                         }</span>
<a href="#l43.164"></a><span id="l43.164">                         request.execRespFunc(null, ret);</span>
<a href="#l43.165"></a><span id="l43.165">                     }</span>
<a href="#l43.166"></a><span id="l43.166">                 },</span>
<a href="#l43.167"></a><span id="l43.167">                 stringToXml_, &quot;get_freebusy&quot;, params);</span>
<a href="#l43.168"></a><span id="l43.168" class="difflineminus">-</span>
<a href="#l43.169"></a><span id="l43.169">         } catch (exc) {</span>
<a href="#l43.170"></a><span id="l43.170">             request.execRespFunc(exc);</span>
<a href="#l43.171"></a><span id="l43.171">         }</span>
<a href="#l43.172"></a><span id="l43.172">         return request;</span>
<a href="#l43.173"></a><span id="l43.173">     },</span>
<a href="#l43.174"></a><span id="l43.174"> </span>
<a href="#l43.175"></a><span id="l43.175">     // nsIObserver:</span>
<a href="#l43.176"></a><span id="l43.176">     observe: function calWcapSession_observer(subject, topic, data) {</span>
<a href="#l43.177"></a><span id="l43.177" class="difflineat">@@ -1063,18 +1053,16 @@ calWcapSession.prototype = {</span>
<a href="#l43.178"></a><span id="l43.178">             if (aCalendar.getProperty(pref) === null) {</span>
<a href="#l43.179"></a><span id="l43.179">                 aCalendar.setProperty(pref, val);</span>
<a href="#l43.180"></a><span id="l43.180">             }</span>
<a href="#l43.181"></a><span id="l43.181">         }</span>
<a href="#l43.182"></a><span id="l43.182"> </span>
<a href="#l43.183"></a><span id="l43.183">         try {</span>
<a href="#l43.184"></a><span id="l43.184">             // make sure the calendar belongs to this session:</span>
<a href="#l43.185"></a><span id="l43.185">             if (this.belongsTo(aCalendar)) {</span>
<a href="#l43.186"></a><span id="l43.186" class="difflineminus">-</span>
<a href="#l43.187"></a><span id="l43.187" class="difflineminus">-</span>
<a href="#l43.188"></a><span id="l43.188">                 assureDefault(&quot;shared_context&quot;, this.m_contextId);</span>
<a href="#l43.189"></a><span id="l43.189">                 assureDefault(&quot;name&quot;, aCalendar.name);</span>
<a href="#l43.190"></a><span id="l43.190"> </span>
<a href="#l43.191"></a><span id="l43.191">                 const s_colors = [&quot;#FFCCCC&quot;, &quot;#FFCC99&quot;, &quot;#FFFF99&quot;, &quot;#FFFFCC&quot;, &quot;#99FF99&quot;,</span>
<a href="#l43.192"></a><span id="l43.192">                                   &quot;#99FFFF&quot;, &quot;#CCFFFF&quot;, &quot;#CCCCFF&quot;, &quot;#FFCCFF&quot;, &quot;#FF6666&quot;,</span>
<a href="#l43.193"></a><span id="l43.193">                                   &quot;#FF9966&quot;, &quot;#FFFF66&quot;, &quot;#FFFF33&quot;, &quot;#66FF99&quot;, &quot;#33FFFF&quot;,</span>
<a href="#l43.194"></a><span id="l43.194">                                   &quot;#66FFFF&quot;, &quot;#9999FF&quot;, &quot;#FF99FF&quot;, &quot;#FF0000&quot;, &quot;#FF9900&quot;,</span>
<a href="#l43.195"></a><span id="l43.195">                                   &quot;#FFCC66&quot;, &quot;#FFFF00&quot;, &quot;#33FF33&quot;, &quot;#66CCCC&quot;, &quot;#33CCFF&quot;,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/calendar/resources/content/publish.js</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/calendar/resources/content/publish.js</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -114,17 +114,16 @@ function publishEntireCalendarDialogResp</span>
<a href="#l44.4"></a><span id="l44.4">                 }</span>
<a href="#l44.5"></a><span id="l44.5">             }</span>
<a href="#l44.6"></a><span id="l44.6">         }</span>
<a href="#l44.7"></a><span id="l44.7">     };</span>
<a href="#l44.8"></a><span id="l44.8">     aProgressDialog.onStartUpload();</span>
<a href="#l44.9"></a><span id="l44.9">     var oldCalendar = CalendarPublishObject.calendar;</span>
<a href="#l44.10"></a><span id="l44.10">     oldCalendar.getItems(Components.interfaces.calICalendar.ITEM_FILTER_ALL_ITEMS,</span>
<a href="#l44.11"></a><span id="l44.11">                          0, null, null, getListener);</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-</span>
<a href="#l44.13"></a><span id="l44.13"> }</span>
<a href="#l44.14"></a><span id="l44.14"> </span>
<a href="#l44.15"></a><span id="l44.15"> function publishItemArray(aItemArray, aPath, aProgressDialog) {</span>
<a href="#l44.16"></a><span id="l44.16">     var outputStream;</span>
<a href="#l44.17"></a><span id="l44.17">     var inputStream;</span>
<a href="#l44.18"></a><span id="l44.18">     var storageStream;</span>
<a href="#l44.19"></a><span id="l44.19"> </span>
<a href="#l44.20"></a><span id="l44.20">     var icsURL = makeURL(aPath);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/calendar/test/unit/test_alarm.js</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/calendar/test/unit/test_alarm.js</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -371,18 +371,18 @@ var propMap = { &quot;related&quot;: Ci.calIAlarm.</span>
<a href="#l45.4"></a><span id="l45.4"> var clonePropMap = { &quot;related&quot;: Ci.calIAlarm.ALARM_RELATED_END,</span>
<a href="#l45.5"></a><span id="l45.5">                      &quot;repeat&quot;: 2,</span>
<a href="#l45.6"></a><span id="l45.6">                      &quot;action&quot;: &quot;X-CHANGED&quot;,</span>
<a href="#l45.7"></a><span id="l45.7">                      &quot;description&quot;: &quot;description-changed&quot;,</span>
<a href="#l45.8"></a><span id="l45.8">                      &quot;summary&quot;: &quot;summary-changed&quot;,</span>
<a href="#l45.9"></a><span id="l45.9">                      &quot;offset&quot;: createDuration(&quot;PT5M&quot;),</span>
<a href="#l45.10"></a><span id="l45.10">                      &quot;repeatOffset&quot;: createDuration(&quot;PT2M&quot;)</span>
<a href="#l45.11"></a><span id="l45.11"> };</span>
<a href="#l45.12"></a><span id="l45.12" class="difflineplus">+</span>
<a href="#l45.13"></a><span id="l45.13"> function test_immutable() {</span>
<a href="#l45.14"></a><span id="l45.14" class="difflineminus">-</span>
<a href="#l45.15"></a><span id="l45.15">     dump(&quot;Testing immutable alarms...&quot;);</span>
<a href="#l45.16"></a><span id="l45.16">     let alarm = cal.createAlarm();</span>
<a href="#l45.17"></a><span id="l45.17">     // Set up each attribute</span>
<a href="#l45.18"></a><span id="l45.18">     for (let prop in propMap) {</span>
<a href="#l45.19"></a><span id="l45.19">         alarm[prop] = propMap[prop];</span>
<a href="#l45.20"></a><span id="l45.20">     }</span>
<a href="#l45.21"></a><span id="l45.21"> </span>
<a href="#l45.22"></a><span id="l45.22">     // Set up some extra props</span>
<a href="#l45.23"></a><span id="l45.23" class="difflineat">@@ -544,17 +544,16 @@ function test_serialize() {</span>
<a href="#l45.24"></a><span id="l45.24"> </span>
<a href="#l45.25"></a><span id="l45.25">     // Missing repeat with duration</span>
<a href="#l45.26"></a><span id="l45.26">     throws(function() {</span>
<a href="#l45.27"></a><span id="l45.27">         comp = srv.createIcalComponent(&quot;VALARM&quot;);</span>
<a href="#l45.28"></a><span id="l45.28">         addActionDisplay(); addTrigger(); addDescr();</span>
<a href="#l45.29"></a><span id="l45.29">         addDuration();</span>
<a href="#l45.30"></a><span id="l45.30">         alarm.icalComponent = comp;</span>
<a href="#l45.31"></a><span id="l45.31">     }, /Illegal value/, &quot;Invalid Argument&quot;);</span>
<a href="#l45.32"></a><span id="l45.32" class="difflineminus">-</span>
<a href="#l45.33"></a><span id="l45.33"> }</span>
<a href="#l45.34"></a><span id="l45.34"> </span>
<a href="#l45.35"></a><span id="l45.35"> function test_strings() {</span>
<a href="#l45.36"></a><span id="l45.36">     // Serializing the string shouldn't throw, but we don't really care about</span>
<a href="#l45.37"></a><span id="l45.37">     // the string itself.</span>
<a href="#l45.38"></a><span id="l45.38">     let alarm = cal.createAlarm();</span>
<a href="#l45.39"></a><span id="l45.39">     alarm.action = &quot;DISPLAY&quot;;</span>
<a href="#l45.40"></a><span id="l45.40">     alarm.related = Components.interfaces.calIAlarm.ALARM_RELATED_ABSOLUTE;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/calendar/test/unit/test_alarmutils.js</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/calendar/test/unit/test_alarmutils.js</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -57,17 +57,16 @@ add_task(function* test_setDefaultValues</span>
<a href="#l46.4"></a><span id="l46.4">     ok(alarm);</span>
<a href="#l46.5"></a><span id="l46.5">     equal(alarm.related, alarm.ALARM_RELATED_START);</span>
<a href="#l46.6"></a><span id="l46.6">     equal(alarm.action, &quot;SHOUT&quot;);</span>
<a href="#l46.7"></a><span id="l46.7">     equal(alarm.offset.icalString, &quot;-P2DT12H&quot;);</span>
<a href="#l46.8"></a><span id="l46.8"> </span>
<a href="#l46.9"></a><span id="l46.9">     Preferences.reset(&quot;calendar.alarms.onforevents&quot;);</span>
<a href="#l46.10"></a><span id="l46.10">     Preferences.reset(&quot;calendar.alarms.eventalarmunit&quot;);</span>
<a href="#l46.11"></a><span id="l46.11">     Preferences.reset(&quot;calendar.alarms.eventalarmlen&quot;);</span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-</span>
<a href="#l46.13"></a><span id="l46.13"> });</span>
<a href="#l46.14"></a><span id="l46.14"> </span>
<a href="#l46.15"></a><span id="l46.15"> add_task(function* test_setDefaultValues_tasks() {</span>
<a href="#l46.16"></a><span id="l46.16">     let item, alarm;</span>
<a href="#l46.17"></a><span id="l46.17">     let calnow = cal.now;</span>
<a href="#l46.18"></a><span id="l46.18">     let nowDate = cal.createDateTime(&quot;20150815T120000&quot;);</span>
<a href="#l46.19"></a><span id="l46.19">     cal.now = function() {</span>
<a href="#l46.20"></a><span id="l46.20">       return nowDate;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/calendar/test/unit/test_attendee.js</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/calendar/test/unit/test_attendee.js</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -146,17 +146,16 @@ function test_serialize() {</span>
<a href="#l47.4"></a><span id="l47.4">     equal(prop.value, &quot;horst&quot;);</span>
<a href="#l47.5"></a><span id="l47.5">     equal(prop.propertyName, &quot;ORGANIZER&quot;);</span>
<a href="#l47.6"></a><span id="l47.6">     equal(prop.getParameter(&quot;CN&quot;), &quot;Horst&quot;);</span>
<a href="#l47.7"></a><span id="l47.7">     equal(prop.getParameter(&quot;RSVP&quot;), &quot;TRUE&quot;);</span>
<a href="#l47.8"></a><span id="l47.8">     equal(prop.getParameter(&quot;ROLE&quot;), &quot;CHAIR&quot;);</span>
<a href="#l47.9"></a><span id="l47.9">     equal(prop.getParameter(&quot;PARTSTAT&quot;), &quot;DECLINED&quot;);</span>
<a href="#l47.10"></a><span id="l47.10">     equal(prop.getParameter(&quot;CUTYPE&quot;), &quot;RESOURCE&quot;);</span>
<a href="#l47.11"></a><span id="l47.11">     equal(prop.getParameter(&quot;X-NAME&quot;), &quot;X-VALUE&quot;);</span>
<a href="#l47.12"></a><span id="l47.12" class="difflineminus">-</span>
<a href="#l47.13"></a><span id="l47.13"> }</span>
<a href="#l47.14"></a><span id="l47.14"> </span>
<a href="#l47.15"></a><span id="l47.15"> function test_properties() {</span>
<a href="#l47.16"></a><span id="l47.16">     let a = cal.createAttendee();</span>
<a href="#l47.17"></a><span id="l47.17"> </span>
<a href="#l47.18"></a><span id="l47.18">     throws(function() {</span>
<a href="#l47.19"></a><span id="l47.19">         a.icalProperty;</span>
<a href="#l47.20"></a><span id="l47.20">     }, /Component not initialized/);</span>
<a href="#l47.21"></a><span id="l47.21" class="difflineat">@@ -197,17 +196,16 @@ function test_doubleParameters() {</span>
<a href="#l47.22"></a><span id="l47.22">             let prop = attendee.icalProperty;</span>
<a href="#l47.23"></a><span id="l47.23">             let parNames = [];</span>
<a href="#l47.24"></a><span id="l47.24">             let parValues = [];</span>
<a href="#l47.25"></a><span id="l47.25"> </span>
<a href="#l47.26"></a><span id="l47.26">             // Extract the parameters</span>
<a href="#l47.27"></a><span id="l47.27">             for (let paramName = prop.getFirstParameterName();</span>
<a href="#l47.28"></a><span id="l47.28">                  paramName;</span>
<a href="#l47.29"></a><span id="l47.29">                  paramName = prop.getNextParameterName()) {</span>
<a href="#l47.30"></a><span id="l47.30" class="difflineminus">-</span>
<a href="#l47.31"></a><span id="l47.31">                 parNames.push(paramName);</span>
<a href="#l47.32"></a><span id="l47.32">                 parValues.push(prop.getParameter(paramName));</span>
<a href="#l47.33"></a><span id="l47.33">             }</span>
<a href="#l47.34"></a><span id="l47.34"> </span>
<a href="#l47.35"></a><span id="l47.35">             // Check the results</span>
<a href="#l47.36"></a><span id="l47.36">             let att_n = attendee.id.substr(7, 9);</span>
<a href="#l47.37"></a><span id="l47.37">             for (let parIndex in parNames) {</span>
<a href="#l47.38"></a><span id="l47.38">                 ok(aExpected[att_n].param.includes(parNames[parIndex]),</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1" class="difflineminus">--- a/calendar/test/unit/test_bug759324.js</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineplus">+++ b/calendar/test/unit/test_bug759324.js</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineat">@@ -23,17 +23,16 @@ function run_test() {</span>
<a href="#l48.4"></a><span id="l48.4">     let rec = item.recurrenceInfo.getOccurrenceFor(rid);</span>
<a href="#l48.5"></a><span id="l48.5">     rec.title = &quot;changed&quot;;</span>
<a href="#l48.6"></a><span id="l48.6">     item.recurrenceInfo.modifyException(rec, true);</span>
<a href="#l48.7"></a><span id="l48.7"> </span>
<a href="#l48.8"></a><span id="l48.8">     do_test_pending();</span>
<a href="#l48.9"></a><span id="l48.9">     storage.addItem(item, { onOperationComplete: checkAddedItem });</span>
<a href="#l48.10"></a><span id="l48.10"> </span>
<a href="#l48.11"></a><span id="l48.11">     function checkAddedItem(c, s, o, i, addedItem) {</span>
<a href="#l48.12"></a><span id="l48.12" class="difflineminus">-</span>
<a href="#l48.13"></a><span id="l48.13">         let seq = addedItem.getProperty(&quot;SEQUENCE&quot;);</span>
<a href="#l48.14"></a><span id="l48.14">         let rec = addedItem.recurrenceInfo.getOccurrenceFor(rid);</span>
<a href="#l48.15"></a><span id="l48.15"> </span>
<a href="#l48.16"></a><span id="l48.16">         equal(seq, 3);</span>
<a href="#l48.17"></a><span id="l48.17">         equal(rec.getProperty(&quot;SEQUENCE&quot;), seq);</span>
<a href="#l48.18"></a><span id="l48.18"> </span>
<a href="#l48.19"></a><span id="l48.19">         let changedItem = addedItem.clone();</span>
<a href="#l48.20"></a><span id="l48.20">         changedItem.setProperty(&quot;SEQUENCE&quot;, parseInt(seq, 10) + 1);</span>
<a href="#l48.21"></a><span id="l48.21" class="difflineat">@@ -50,17 +49,16 @@ function run_test() {</span>
<a href="#l48.22"></a><span id="l48.22"> </span>
<a href="#l48.23"></a><span id="l48.23">         // Now check with the pref off</span>
<a href="#l48.24"></a><span id="l48.24">         storage.deleteProperty(&quot;capabilities.propagate-sequence&quot;);</span>
<a href="#l48.25"></a><span id="l48.25"> </span>
<a href="#l48.26"></a><span id="l48.26">         let changedItem2 = changedItem.clone();</span>
<a href="#l48.27"></a><span id="l48.27">         changedItem2.setProperty(&quot;SEQUENCE&quot;, parseInt(seq, 10) + 1);</span>
<a href="#l48.28"></a><span id="l48.28"> </span>
<a href="#l48.29"></a><span id="l48.29">         storage.modifyItem(changedItem2, changedItem, { onOperationComplete: checkNormalItem });</span>
<a href="#l48.30"></a><span id="l48.30" class="difflineminus">-</span>
<a href="#l48.31"></a><span id="l48.31">     }</span>
<a href="#l48.32"></a><span id="l48.32"> </span>
<a href="#l48.33"></a><span id="l48.33">     function checkNormalItem(c, s, o, i, changedItem) {</span>
<a href="#l48.34"></a><span id="l48.34">         let seq = changedItem.getProperty(&quot;SEQUENCE&quot;);</span>
<a href="#l48.35"></a><span id="l48.35">         let rec = changedItem.recurrenceInfo.getOccurrenceFor(rid);</span>
<a href="#l48.36"></a><span id="l48.36"> </span>
<a href="#l48.37"></a><span id="l48.37">         equal(seq, 5);</span>
<a href="#l48.38"></a><span id="l48.38">         equal(rec.getProperty(&quot;SEQUENCE&quot;), 4);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1" class="difflineminus">--- a/calendar/test/unit/test_datetime_before_1970.js</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineplus">+++ b/calendar/test/unit/test_datetime_before_1970.js</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineat">@@ -1,14 +1,13 @@</span>
<a href="#l49.4"></a><span id="l49.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l49.5"></a><span id="l49.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l49.6"></a><span id="l49.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l49.7"></a><span id="l49.7"> </span>
<a href="#l49.8"></a><span id="l49.8"> function run_test() {</span>
<a href="#l49.9"></a><span id="l49.9" class="difflineminus">-</span>
<a href="#l49.10"></a><span id="l49.10">     // Bug 769938 - dates before 1970 are not handled correctly</span>
<a href="#l49.11"></a><span id="l49.11">     // due to signed vs. unsigned mismatch in PRTime in xpconnect</span>
<a href="#l49.12"></a><span id="l49.12"> </span>
<a href="#l49.13"></a><span id="l49.13">     let dateTime1950 = cal.createDateTime();</span>
<a href="#l49.14"></a><span id="l49.14">     dateTime1950.year = 1950;</span>
<a href="#l49.15"></a><span id="l49.15">     equal(dateTime1950.year, 1950);</span>
<a href="#l49.16"></a><span id="l49.16"> </span>
<a href="#l49.17"></a><span id="l49.17">     let dateTime1955 = cal.jsDateToDateTime(new Date(1955, 6, 15));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/calendar/test/unit/test_freebusy_service.js</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/calendar/test/unit/test_freebusy_service.js</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -106,17 +106,16 @@ function test_failure() {</span>
<a href="#l50.4"></a><span id="l50.4"> }</span>
<a href="#l50.5"></a><span id="l50.5"> </span>
<a href="#l50.6"></a><span id="l50.6"> function test_cancel() {</span>
<a href="#l50.7"></a><span id="l50.7">     _clearProviders();</span>
<a href="#l50.8"></a><span id="l50.8"> </span>
<a href="#l50.9"></a><span id="l50.9">     let provider = {</span>
<a href="#l50.10"></a><span id="l50.10">         QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIFreeBusyProvider, Components.interfaces.calIOperation]),</span>
<a href="#l50.11"></a><span id="l50.11">         getFreeBusyIntervals: function(aCalId, aStart, aEnd, aTypes, aListener) {</span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-</span>
<a href="#l50.13"></a><span id="l50.13">             Services.tm.currentThread.dispatch({run: function() {</span>
<a href="#l50.14"></a><span id="l50.14">                 dump(&quot;Cancelling freebusy query...&quot;);</span>
<a href="#l50.15"></a><span id="l50.15">                 op.cancel();</span>
<a href="#l50.16"></a><span id="l50.16">             }}, Components.interfaces.nsIEventTarget.DISPATCH_NORMAL);</span>
<a href="#l50.17"></a><span id="l50.17"> </span>
<a href="#l50.18"></a><span id="l50.18">             // No listener call, we emulate a long running search</span>
<a href="#l50.19"></a><span id="l50.19">             // Do return the operation though</span>
<a href="#l50.20"></a><span id="l50.20">             return this;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1" class="difflineminus">--- a/calendar/test/unit/test_ics_parser.js</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineplus">+++ b/calendar/test/unit/test_ics_parser.js</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineat">@@ -64,17 +64,16 @@ function test_failures() {</span>
<a href="#l51.4"></a><span id="l51.4">         &quot;BEGIN:VEVENT&quot;,</span>
<a href="#l51.5"></a><span id="l51.5">         &quot;UID:123&quot;,</span>
<a href="#l51.6"></a><span id="l51.6">         &quot;END:VEVENT&quot;,</span>
<a href="#l51.7"></a><span id="l51.7">         &quot;END:VWORLD&quot;].join(&quot;\r\n&quot;);</span>
<a href="#l51.8"></a><span id="l51.8">     dump(&quot;Note: The following error message is expected:\n&quot;);</span>
<a href="#l51.9"></a><span id="l51.9">     parser.parseString(str);</span>
<a href="#l51.10"></a><span id="l51.10">     equal(parser.getComponents({}).length, 0);</span>
<a href="#l51.11"></a><span id="l51.11">     equal(parser.getItems({}).length, 0);</span>
<a href="#l51.12"></a><span id="l51.12" class="difflineminus">-</span>
<a href="#l51.13"></a><span id="l51.13"> }</span>
<a href="#l51.14"></a><span id="l51.14"> </span>
<a href="#l51.15"></a><span id="l51.15"> function test_fake_parent() {</span>
<a href="#l51.16"></a><span id="l51.16">     let parser = Components.classes[&quot;@mozilla.org/calendar/ics-parser;1&quot;]</span>
<a href="#l51.17"></a><span id="l51.17">                            .createInstance(Components.interfaces.calIIcsParser);</span>
<a href="#l51.18"></a><span id="l51.18"> </span>
<a href="#l51.19"></a><span id="l51.19">     let str = [</span>
<a href="#l51.20"></a><span id="l51.20">         &quot;BEGIN:VCALENDAR&quot;,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1" class="difflineminus">--- a/calendar/test/unit/test_ics_service.js</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineplus">+++ b/calendar/test/unit/test_ics_service.js</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineat">@@ -212,17 +212,16 @@ function test_param() {</span>
<a href="#l52.4"></a><span id="l52.4">     equal(prop.icalString, &quot;DTSTART;VALUE=TEXT:20120101T010101\r\n&quot;);</span>
<a href="#l52.5"></a><span id="l52.5">     prop.removeParameter(&quot;VALUE&quot;);</span>
<a href="#l52.6"></a><span id="l52.6">     equal(prop.icalString, &quot;DTSTART:20120101T010101\r\n&quot;);</span>
<a href="#l52.7"></a><span id="l52.7"> </span>
<a href="#l52.8"></a><span id="l52.8">     prop.setParameter(&quot;X-FOO&quot;, &quot;BAR&quot;);</span>
<a href="#l52.9"></a><span id="l52.9">     equal(prop.icalString, &quot;DTSTART;X-FOO=BAR:20120101T010101\r\n&quot;);</span>
<a href="#l52.10"></a><span id="l52.10">     prop.removeParameter(&quot;X-FOO&quot;, &quot;BAR&quot;);</span>
<a href="#l52.11"></a><span id="l52.11">     equal(prop.icalString, &quot;DTSTART:20120101T010101\r\n&quot;);</span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">-</span>
<a href="#l52.13"></a><span id="l52.13"> }</span>
<a href="#l52.14"></a><span id="l52.14"> </span>
<a href="#l52.15"></a><span id="l52.15"> function test_iterator() {</span>
<a href="#l52.16"></a><span id="l52.16">     let svc = cal.getIcsService();</span>
<a href="#l52.17"></a><span id="l52.17"> </span>
<a href="#l52.18"></a><span id="l52.18">     // Property iterator</span>
<a href="#l52.19"></a><span id="l52.19">     let comp = svc.createIcalComponent(&quot;VEVENT&quot;);</span>
<a href="#l52.20"></a><span id="l52.20">     let propNames = [&quot;X-ONE&quot;, &quot;X-TWO&quot;];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/calendar/test/unit/test_items.js</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/calendar/test/unit/test_items.js</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -60,21 +60,19 @@ function test_aclmanager() {</span>
<a href="#l53.4"></a><span id="l53.4">     equal(pe.aclEntry.userCanRespond, itemEntry.userCanRespond);</span>
<a href="#l53.5"></a><span id="l53.5">     equal(pe.aclEntry.userCanViewAll, itemEntry.userCanViewAll);</span>
<a href="#l53.6"></a><span id="l53.6">     equal(pe.aclEntry.userCanViewDateAndTime, itemEntry.userCanViewDateAndTime);</span>
<a href="#l53.7"></a><span id="l53.7"> </span>
<a href="#l53.8"></a><span id="l53.8">     e = cal.createEvent();</span>
<a href="#l53.9"></a><span id="l53.9">     e.id = &quot;noentry&quot;;</span>
<a href="#l53.10"></a><span id="l53.10">     e.calendar = mockCalendar;</span>
<a href="#l53.11"></a><span id="l53.11">     equal(e.aclEntry, null);</span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-</span>
<a href="#l53.13"></a><span id="l53.13"> }</span>
<a href="#l53.14"></a><span id="l53.14"> </span>
<a href="#l53.15"></a><span id="l53.15"> function test_calendar() {</span>
<a href="#l53.16"></a><span id="l53.16" class="difflineminus">-</span>
<a href="#l53.17"></a><span id="l53.17">     let e = cal.createEvent();</span>
<a href="#l53.18"></a><span id="l53.18">     let pe = cal.createEvent();</span>
<a href="#l53.19"></a><span id="l53.19"> </span>
<a href="#l53.20"></a><span id="l53.20">     let mockCalendar = {</span>
<a href="#l53.21"></a><span id="l53.21">         QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calICalendar]),</span>
<a href="#l53.22"></a><span id="l53.22">         id: &quot;one&quot;</span>
<a href="#l53.23"></a><span id="l53.23">     };</span>
<a href="#l53.24"></a><span id="l53.24"> </span>
<a href="#l53.25"></a><span id="l53.25" class="difflineat">@@ -103,17 +101,16 @@ function test_attachment() {</span>
<a href="#l53.26"></a><span id="l53.26">     e.removeAttachment(a);</span>
<a href="#l53.27"></a><span id="l53.27">     equal(e.getAttachments({}).length, 1);</span>
<a href="#l53.28"></a><span id="l53.28"> </span>
<a href="#l53.29"></a><span id="l53.29">     e.removeAllAttachments();</span>
<a href="#l53.30"></a><span id="l53.30">     equal(e.getAttachments({}).length, 0);</span>
<a href="#l53.31"></a><span id="l53.31"> }</span>
<a href="#l53.32"></a><span id="l53.32"> </span>
<a href="#l53.33"></a><span id="l53.33"> function test_attendee() {</span>
<a href="#l53.34"></a><span id="l53.34" class="difflineminus">-</span>
<a href="#l53.35"></a><span id="l53.35">     let e = cal.createEvent();</span>
<a href="#l53.36"></a><span id="l53.36">     equal(e.getAttendeeById(&quot;unknown&quot;), null);</span>
<a href="#l53.37"></a><span id="l53.37">     equal(e.getAttendees({}).length, 0);</span>
<a href="#l53.38"></a><span id="l53.38"> </span>
<a href="#l53.39"></a><span id="l53.39">     let a = cal.createAttendee();</span>
<a href="#l53.40"></a><span id="l53.40">     a.id = &quot;mailto:horst&quot;;</span>
<a href="#l53.41"></a><span id="l53.41"> </span>
<a href="#l53.42"></a><span id="l53.42">     let b = cal.createAttendee();</span>
<a href="#l53.43"></a><span id="l53.43" class="difflineat">@@ -137,17 +134,16 @@ function test_attendee() {</span>
<a href="#l53.44"></a><span id="l53.44">     equal(e.getAttendees({}).length, 1);</span>
<a href="#l53.45"></a><span id="l53.45">     equal(e.getAttendeeById(&quot;mailto:horst&quot;), null);</span>
<a href="#l53.46"></a><span id="l53.46"> </span>
<a href="#l53.47"></a><span id="l53.47">     e.removeAllAttendees();</span>
<a href="#l53.48"></a><span id="l53.48">     equal(e.getAttendees({}).length, 0);</span>
<a href="#l53.49"></a><span id="l53.49"> }</span>
<a href="#l53.50"></a><span id="l53.50"> </span>
<a href="#l53.51"></a><span id="l53.51"> function test_categories() {</span>
<a href="#l53.52"></a><span id="l53.52" class="difflineminus">-</span>
<a href="#l53.53"></a><span id="l53.53">     let e = cal.createEvent();</span>
<a href="#l53.54"></a><span id="l53.54"> </span>
<a href="#l53.55"></a><span id="l53.55">     equal(e.getCategories({}).length, 0);</span>
<a href="#l53.56"></a><span id="l53.56"> </span>
<a href="#l53.57"></a><span id="l53.57">     let cat = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;];</span>
<a href="#l53.58"></a><span id="l53.58">     e.setCategories(3, cat);</span>
<a href="#l53.59"></a><span id="l53.59"> </span>
<a href="#l53.60"></a><span id="l53.60">     cat[0] = &quot;err&quot;;</span>
<a href="#l53.61"></a><span id="l53.61" class="difflineat">@@ -185,17 +181,16 @@ function test_alarm() {</span>
<a href="#l53.62"></a><span id="l53.62">     equal(e.getAlarms({}).length, 1);</span>
<a href="#l53.63"></a><span id="l53.63">     equal(e.getAlarms({})[0], alarm2);</span>
<a href="#l53.64"></a><span id="l53.64"> </span>
<a href="#l53.65"></a><span id="l53.65">     e.clearAlarms();</span>
<a href="#l53.66"></a><span id="l53.66">     equal(e.getAlarms({}).length, 0);</span>
<a href="#l53.67"></a><span id="l53.67"> }</span>
<a href="#l53.68"></a><span id="l53.68"> </span>
<a href="#l53.69"></a><span id="l53.69"> function test_immutable() {</span>
<a href="#l53.70"></a><span id="l53.70" class="difflineminus">-</span>
<a href="#l53.71"></a><span id="l53.71">     let e = cal.createEvent();</span>
<a href="#l53.72"></a><span id="l53.72"> </span>
<a href="#l53.73"></a><span id="l53.73">     let dt = cal.createDateTime();</span>
<a href="#l53.74"></a><span id="l53.74">     dt.timezone = cal.getTimezoneService().getTimezone(&quot;Europe/Berlin&quot;);</span>
<a href="#l53.75"></a><span id="l53.75">     e.alarmLastAck = dt;</span>
<a href="#l53.76"></a><span id="l53.76"> </span>
<a href="#l53.77"></a><span id="l53.77">     let org = cal.createAttendee();</span>
<a href="#l53.78"></a><span id="l53.78">     org.id = &quot;one&quot;;</span>
<a href="#l53.79"></a><span id="l53.79" class="difflineat">@@ -248,17 +243,16 @@ function test_immutable() {</span>
<a href="#l53.80"></a><span id="l53.80"> </span>
<a href="#l53.81"></a><span id="l53.81">     e2.setPropertyParameter(&quot;X-NAME&quot;, &quot;X-PARAM&quot;, null);</span>
<a href="#l53.82"></a><span id="l53.82">     equal(e2.getPropertyParameter(&quot;X-NAME&quot;, &quot;X-PARAM&quot;), null);</span>
<a href="#l53.83"></a><span id="l53.83"> </span>
<a href="#l53.84"></a><span id="l53.84">     // TODO more clone checks</span>
<a href="#l53.85"></a><span id="l53.85"> }</span>
<a href="#l53.86"></a><span id="l53.86"> </span>
<a href="#l53.87"></a><span id="l53.87"> function test_lastack() {</span>
<a href="#l53.88"></a><span id="l53.88" class="difflineminus">-</span>
<a href="#l53.89"></a><span id="l53.89">     let e = cal.createEvent();</span>
<a href="#l53.90"></a><span id="l53.90"> </span>
<a href="#l53.91"></a><span id="l53.91">     e.alarmLastAck = cal.createDateTime(&quot;20120101T010101&quot;);</span>
<a href="#l53.92"></a><span id="l53.92"> </span>
<a href="#l53.93"></a><span id="l53.93">     // Our items don't support this yet</span>
<a href="#l53.94"></a><span id="l53.94">     //  equal(e.getProperty(&quot;X-MOZ-LASTACK&quot;), &quot;20120101T010101&quot;);</span>
<a href="#l53.95"></a><span id="l53.95"> </span>
<a href="#l53.96"></a><span id="l53.96">     let comp = e.icalComponent;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1" class="difflineminus">--- a/calendar/test/unit/test_recur.js</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineplus">+++ b/calendar/test/unit/test_recur.js</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineat">@@ -680,17 +680,16 @@ function test_rrule_interface() {</span>
<a href="#l54.4"></a><span id="l54.4">     untilDate.timezone = cal.UTC();</span>
<a href="#l54.5"></a><span id="l54.5">     rrule.untilDate = untilDate;</span>
<a href="#l54.6"></a><span id="l54.6">     ok(!rrule.isByCount)</span>
<a href="#l54.7"></a><span id="l54.7">     throws(() =&gt; rrule.count, /0x80004005/);</span>
<a href="#l54.8"></a><span id="l54.8">     equal(rrule.untilDate.icalString, untilDate.icalString);</span>
<a href="#l54.9"></a><span id="l54.9"> }</span>
<a href="#l54.10"></a><span id="l54.10"> </span>
<a href="#l54.11"></a><span id="l54.11"> function test_startdate_change() {</span>
<a href="#l54.12"></a><span id="l54.12" class="difflineminus">-</span>
<a href="#l54.13"></a><span id="l54.13">     // Setting a start date if its missing shouldn't throw</span>
<a href="#l54.14"></a><span id="l54.14">     let item = makeEvent(&quot;DTEND:20020402T124500Z\r\n&quot; +</span>
<a href="#l54.15"></a><span id="l54.15">                          &quot;RRULE:FREQ=DAILY\r\n&quot;);</span>
<a href="#l54.16"></a><span id="l54.16">     item.startDate = cal.createDateTime(&quot;20020502T114500Z&quot;);</span>
<a href="#l54.17"></a><span id="l54.17"> </span>
<a href="#l54.18"></a><span id="l54.18">     function makeRecEvent(str) {</span>
<a href="#l54.19"></a><span id="l54.19">         return makeEvent(&quot;DTSTART:20020402T114500Z\r\n&quot; +</span>
<a href="#l54.20"></a><span id="l54.20">                          &quot;DTEND:20020402T134500Z\r\n&quot; +</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1" class="difflineminus">--- a/calendar/test/unit/test_search_service.js</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineplus">+++ b/calendar/test/unit/test_search_service.js</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineat">@@ -55,17 +55,16 @@ function test_found() {</span>
<a href="#l55.4"></a><span id="l55.4">     let listener = {</span>
<a href="#l55.5"></a><span id="l55.5">         called: false,</span>
<a href="#l55.6"></a><span id="l55.6">         onResult: function(request, result) {</span>
<a href="#l55.7"></a><span id="l55.7">             ok(!this.called);</span>
<a href="#l55.8"></a><span id="l55.8">             this.called = true;</span>
<a href="#l55.9"></a><span id="l55.9"> </span>
<a href="#l55.10"></a><span id="l55.10">             equal(result.length, 1);</span>
<a href="#l55.11"></a><span id="l55.11">             equal(result[0].id, &quot;test&quot;);</span>
<a href="#l55.12"></a><span id="l55.12" class="difflineminus">-</span>
<a href="#l55.13"></a><span id="l55.13">         }</span>
<a href="#l55.14"></a><span id="l55.14">     };</span>
<a href="#l55.15"></a><span id="l55.15"> </span>
<a href="#l55.16"></a><span id="l55.16">     let op = search.searchForCalendars(&quot;str&quot;, HINT_EXACT_MATCH, 0, listener);</span>
<a href="#l55.17"></a><span id="l55.17">     ok(listener.called);</span>
<a href="#l55.18"></a><span id="l55.18">     ok(provider2.called);</span>
<a href="#l55.19"></a><span id="l55.19"> }</span>
<a href="#l55.20"></a><span id="l55.20"> </span>
<a href="#l55.21"></a><span id="l55.21" class="difflineat">@@ -94,17 +93,16 @@ function test_failure() {</span>
<a href="#l55.22"></a><span id="l55.22"> }</span>
<a href="#l55.23"></a><span id="l55.23"> </span>
<a href="#l55.24"></a><span id="l55.24"> function test_cancel() {</span>
<a href="#l55.25"></a><span id="l55.25">     search.getProviders({}).forEach(search.removeProvider, search);</span>
<a href="#l55.26"></a><span id="l55.26"> </span>
<a href="#l55.27"></a><span id="l55.27">     let provider = {</span>
<a href="#l55.28"></a><span id="l55.28">         QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calICalendarSearchProvider, Components.interfaces.calIOperation]),</span>
<a href="#l55.29"></a><span id="l55.29">         searchForCalendars: function(aStr, aHint, aMax, aListener) {</span>
<a href="#l55.30"></a><span id="l55.30" class="difflineminus">-</span>
<a href="#l55.31"></a><span id="l55.31">             Services.tm.currentThread.dispatch({run: function() {</span>
<a href="#l55.32"></a><span id="l55.32">                 dump(&quot;Cancelling search...&quot;);</span>
<a href="#l55.33"></a><span id="l55.33">                 op.cancel();</span>
<a href="#l55.34"></a><span id="l55.34">             }}, Components.interfaces.nsIEventTarget.DISPATCH_NORMAL);</span>
<a href="#l55.35"></a><span id="l55.35"> </span>
<a href="#l55.36"></a><span id="l55.36">             // No listener call, we emulate a long running search</span>
<a href="#l55.37"></a><span id="l55.37">             // Do return the operation though</span>
<a href="#l55.38"></a><span id="l55.38">             return this;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1" class="difflineminus">--- a/calendar/test/unit/test_weekinfo_service.js</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineplus">+++ b/calendar/test/unit/test_weekinfo_service.js</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineat">@@ -1,14 +1,13 @@</span>
<a href="#l56.4"></a><span id="l56.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l56.5"></a><span id="l56.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l56.6"></a><span id="l56.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l56.7"></a><span id="l56.7"> </span>
<a href="#l56.8"></a><span id="l56.8"> function run_test() {</span>
<a href="#l56.9"></a><span id="l56.9" class="difflineminus">-</span>
<a href="#l56.10"></a><span id="l56.10">     // Bug 1239622. The 1st of January after a leap year which ends with</span>
<a href="#l56.11"></a><span id="l56.11">     // a Thursday belongs to week number 53 unless the start of week is</span>
<a href="#l56.12"></a><span id="l56.12">     // set on Friday.</span>
<a href="#l56.13"></a><span id="l56.13">     let wkst_wknum_date = [</span>
<a href="#l56.14"></a><span id="l56.14">         [1, 53, &quot;20210101T000000Z&quot;],   // Year 2021 affected by Bug 1239622</span>
<a href="#l56.15"></a><span id="l56.15">         [5, 1, &quot;20210101T000000Z&quot;],    //</span>
<a href="#l56.16"></a><span id="l56.16">         [3, 53, &quot;20490101T000000Z&quot;],   // Year 2049 affected by Bug 1239622</span>
<a href="#l56.17"></a><span id="l56.17">         [5, 1, &quot;20490101T000000Z&quot;],    //</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

