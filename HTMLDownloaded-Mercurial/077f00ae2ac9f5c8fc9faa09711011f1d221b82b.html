<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/4b0de666d1a4/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/4b0de666d1a4/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/4b0de666d1a4/mercurial.js"></script>

<meta property="og:image" content="/static/4b0de666d1a4/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 27516:077f00ae2ac9f5c8fc9faa09711011f1d221b82b</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 077f00ae2ac9f5c8fc9faa09711011f1d221b82b" />
<meta property="og:url" content="/comm-central/rev/077f00ae2ac9f5c8fc9faa09711011f1d221b82b" />
<meta property="og:description" content="Bug 1567424 - remove broadcaster usage from calendar/: remove modeBroadcaster. r=pmorris" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/4b0de666d1a4/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 077f00ae2ac9f5c8fc9faa09711011f1d221b82b 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/077f00ae2ac9f5c8fc9faa09711011f1d221b82b">shortlog</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/077f00ae2ac9f5c8fc9faa09711011f1d221b82b">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b">files</a> |
changeset |
<a href="/comm-central/raw-rev/077f00ae2ac9f5c8fc9faa09711011f1d221b82b">raw</a>  | <a href="/comm-central/archive/077f00ae2ac9f5c8fc9faa09711011f1d221b82b.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1567424">Bug 1567424</a> - remove broadcaster usage from calendar/: remove modeBroadcaster. r=pmorris
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#77;&#97;&#103;&#110;&#117;&#115;&#32;&#77;&#101;&#108;&#105;&#110;&#32;&#60;&#109;&#107;&#109;&#101;&#108;&#105;&#110;&#43;&#109;&#111;&#122;&#105;&#108;&#108;&#97;&#64;&#105;&#107;&#105;&#46;&#102;&#105;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 06 Sep 2019 13:17:07 +0300</td></tr>

<tr>
 <td>changeset 27516</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/077f00ae2ac9f5c8fc9faa09711011f1d221b82b">077f00ae2ac9f5c8fc9faa09711011f1d221b82b</a></td>
</tr>



<tr>
<td>parent 27515</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/dcba32994a29db819cc0f90a5f716d1398ad92da">dcba32994a29db819cc0f90a5f716d1398ad92da</a>
</td>
</tr>

<tr>
<td>child 27517</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/cb573c0a6d0985398e03fdd1def354b098c2eed6">cb573c0a6d0985398e03fdd1def354b098c2eed6</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=077f00ae2ac9f5c8fc9faa09711011f1d221b82b">16372</a></td></tr>
<tr><td>push user</td><td>mkmelin@iki.fi</td></tr>
<tr><td>push date</td><td class="date age">Fri, 06 Sep 2019 10:18:26 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@cb573c0a6d09 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=cb573c0a6d0985398e03fdd1def354b098c2eed6">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=cb573c0a6d0985398e03fdd1def354b098c2eed6&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=cb573c0a6d0985398e03fdd1def354b098c2eed6&newProject=comm-central&newRevision=7d0f5d3a4d33ab882b3c286553a208990bd53a7e&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=cb573c0a6d0985398e03fdd1def354b098c2eed6&newProject=comm-central&newRevision=7d0f5d3a4d33ab882b3c286553a208990bd53a7e&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=cb573c0a6d0985398e03fdd1def354b098c2eed6&newProject=comm-central&newRevision=7d0f5d3a4d33ab882b3c286553a208990bd53a7e&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28pmorris%29&revcount=50">pmorris</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1567424">1567424</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1567424">Bug 1567424</a> - remove broadcaster usage from calendar/: remove modeBroadcaster. r=pmorris</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-base-view.js">calendar/base/content/calendar-base-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-base-view.js">file</a> |
<a href="/comm-central/annotate/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-base-view.js">annotate</a> |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-base-view.js">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-base-view.js">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-base-view.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-common-sets.js">calendar/base/content/calendar-common-sets.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-common-sets.js">file</a> |
<a href="/comm-central/annotate/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-common-sets.js">annotate</a> |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-common-sets.js">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-common-sets.js">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-common-sets.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-common-sets.xul">calendar/base/content/calendar-common-sets.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-common-sets.xul">file</a> |
<a href="/comm-central/annotate/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-common-sets.xul">annotate</a> |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-common-sets.xul">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-common-sets.xul">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-common-sets.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-multiday-base-view.js">calendar/base/content/calendar-multiday-base-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-multiday-base-view.js">file</a> |
<a href="/comm-central/annotate/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-multiday-base-view.js">annotate</a> |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-multiday-base-view.js">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-multiday-base-view.js">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-multiday-base-view.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-task-tree-utils.js">calendar/base/content/calendar-task-tree-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-task-tree-utils.js">file</a> |
<a href="/comm-central/annotate/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-task-tree-utils.js">annotate</a> |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-task-tree-utils.js">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-task-tree-utils.js">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-task-tree-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-unifinder-todo.xul">calendar/base/content/calendar-unifinder-todo.xul</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-unifinder-todo.xul">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-unifinder-todo.xul">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-unifinder-todo.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-views-utils.js">calendar/base/content/calendar-views-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-views-utils.js">file</a> |
<a href="/comm-central/annotate/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-views-utils.js">annotate</a> |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-views-utils.js">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-views-utils.js">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-views-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-views.js">calendar/base/content/calendar-views.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-views.js">file</a> |
<a href="/comm-central/annotate/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-views.js">annotate</a> |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-views.js">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-views.js">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/calendar-views.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/today-pane.js">calendar/base/content/today-pane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/today-pane.js">file</a> |
<a href="/comm-central/annotate/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/today-pane.js">annotate</a> |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/today-pane.js">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/today-pane.js">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/today-pane.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/today-pane.xul">calendar/base/content/today-pane.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/today-pane.xul">file</a> |
<a href="/comm-central/annotate/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/today-pane.xul">annotate</a> |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/today-pane.xul">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/today-pane.xul">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/today-pane.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/widgets/calendar-modebox.js">calendar/base/content/widgets/calendar-modebox.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/widgets/calendar-modebox.js">file</a> |
<a href="/comm-central/annotate/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/widgets/calendar-modebox.js">annotate</a> |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/widgets/calendar-modebox.js">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/widgets/calendar-modebox.js">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/content/widgets/calendar-modebox.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/jar.mn">calendar/base/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/jar.mn">file</a> |
<a href="/comm-central/annotate/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/jar.mn">annotate</a> |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/jar.mn">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/jar.mn">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/base/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/lightning-menus.xul">calendar/lightning/content/lightning-menus.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/lightning-menus.xul">file</a> |
<a href="/comm-central/annotate/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/lightning-menus.xul">annotate</a> |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/lightning-menus.xul">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/lightning-menus.xul">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/lightning-menus.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/messenger-overlay-sidebar.js">calendar/lightning/content/messenger-overlay-sidebar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/messenger-overlay-sidebar.js">file</a> |
<a href="/comm-central/annotate/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/messenger-overlay-sidebar.js">annotate</a> |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/messenger-overlay-sidebar.js">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/messenger-overlay-sidebar.js">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/messenger-overlay-sidebar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/messenger-overlay-sidebar.xul">calendar/lightning/content/messenger-overlay-sidebar.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/messenger-overlay-sidebar.xul">file</a> |
<a href="/comm-central/annotate/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/messenger-overlay-sidebar.xul">annotate</a> |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/messenger-overlay-sidebar.xul">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/messenger-overlay-sidebar.xul">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/content/messenger-overlay-sidebar.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/jar.mn">calendar/lightning/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/jar.mn">file</a> |
<a href="/comm-central/annotate/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/jar.mn">annotate</a> |
<a href="/comm-central/diff/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/jar.mn">diff</a> |
<a href="/comm-central/comparison/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/jar.mn">comparison</a> |
<a href="/comm-central/log/077f00ae2ac9f5c8fc9faa09711011f1d221b82b/calendar/lightning/jar.mn">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/content/calendar-base-view.js</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/content/calendar-base-view.js</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -3,16 +3,18 @@</span>
<a href="#l1.4"></a><span id="l1.4">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l1.5"></a><span id="l1.5"> </span>
<a href="#l1.6"></a><span id="l1.6"> /* globals cal currentView MozElements MozXULElement Services toggleOrientation */</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8"> &quot;use strict&quot;;</span>
<a href="#l1.9"></a><span id="l1.9"> </span>
<a href="#l1.10"></a><span id="l1.10"> // Wrap in a block to prevent leaking to window scope.</span>
<a href="#l1.11"></a><span id="l1.11"> {</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+  const { Log4Moz } = ChromeUtils.import(&quot;resource:///modules/gloda/log4moz.js&quot;);</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+</span>
<a href="#l1.14"></a><span id="l1.14">   /**</span>
<a href="#l1.15"></a><span id="l1.15">    * Calendar observer for calendar view elements. Used in CalendarBaseView class.</span>
<a href="#l1.16"></a><span id="l1.16">    *</span>
<a href="#l1.17"></a><span id="l1.17">    * @implements {calIObserver}</span>
<a href="#l1.18"></a><span id="l1.18">    * @implements {calICompositeObserver}</span>
<a href="#l1.19"></a><span id="l1.19">    * @implements {calIAlarmServiceObserver}</span>
<a href="#l1.20"></a><span id="l1.20">    */</span>
<a href="#l1.21"></a><span id="l1.21">   class CalendarViewObserver {</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineat">@@ -435,17 +437,17 @@</span>
<a href="#l1.23"></a><span id="l1.23"> </span>
<a href="#l1.24"></a><span id="l1.24">       this.mTasksInView = false;</span>
<a href="#l1.25"></a><span id="l1.25">       this.mShowCompleted = false;</span>
<a href="#l1.26"></a><span id="l1.26"> </span>
<a href="#l1.27"></a><span id="l1.27">       this.mDisplayDaysOff = true;</span>
<a href="#l1.28"></a><span id="l1.28">       this.mDaysOffArray = [0, 6];</span>
<a href="#l1.29"></a><span id="l1.29"> </span>
<a href="#l1.30"></a><span id="l1.30">       this.mTimezone = null;</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineminus">-      this.mFlashingEvents = null;</span>
<a href="#l1.32"></a><span id="l1.32" class="difflineplus">+      this.mFlashingEvents = {};</span>
<a href="#l1.33"></a><span id="l1.33"> </span>
<a href="#l1.34"></a><span id="l1.34">       this.mSelectedItems = [];</span>
<a href="#l1.35"></a><span id="l1.35">       this.mLongWeekdayTotalPixels = -1;</span>
<a href="#l1.36"></a><span id="l1.36"> </span>
<a href="#l1.37"></a><span id="l1.37">       this.mDropShadowsLength = null;</span>
<a href="#l1.38"></a><span id="l1.38"> </span>
<a href="#l1.39"></a><span id="l1.39">       this.mShadowOffset = null;</span>
<a href="#l1.40"></a><span id="l1.40">       this.mDropShadows = null;</span>
<a href="#l1.41"></a><span id="l1.41" class="difflineat">@@ -513,19 +515,17 @@</span>
<a href="#l1.42"></a><span id="l1.42">       // Add a preference observer to monitor changes.</span>
<a href="#l1.43"></a><span id="l1.43">       Services.prefs.addObserver(&quot;calendar.&quot;, this.mPrefObserver);</span>
<a href="#l1.44"></a><span id="l1.44">       Services.obs.addObserver(this.mTimezoneObserver, &quot;defaultTimezoneChanged&quot;);</span>
<a href="#l1.45"></a><span id="l1.45"> </span>
<a href="#l1.46"></a><span id="l1.46">       this.weekStartOffset = Services.prefs.getIntPref(&quot;calendar.week.start&quot;, 0);</span>
<a href="#l1.47"></a><span id="l1.47">       this.updateDaysOffPrefs();</span>
<a href="#l1.48"></a><span id="l1.48">       this.mPendingRefreshJobs = new Map();</span>
<a href="#l1.49"></a><span id="l1.49"> </span>
<a href="#l1.50"></a><span id="l1.50" class="difflineminus">-      const { Log4Moz } = ChromeUtils.import(&quot;resource:///modules/gloda/log4moz.js&quot;);</span>
<a href="#l1.51"></a><span id="l1.51">       this.mLog = Log4Moz.getConfiguredLogger(&quot;calBaseView&quot;);</span>
<a href="#l1.52"></a><span id="l1.52" class="difflineminus">-      this.mFlashingEvents = {};</span>
<a href="#l1.53"></a><span id="l1.53"> </span>
<a href="#l1.54"></a><span id="l1.54">       // Remove observers on window unload.</span>
<a href="#l1.55"></a><span id="l1.55">       window.addEventListener(</span>
<a href="#l1.56"></a><span id="l1.56">         &quot;unload&quot;,</span>
<a href="#l1.57"></a><span id="l1.57">         () =&gt; {</span>
<a href="#l1.58"></a><span id="l1.58">           if (this.mCalendar) {</span>
<a href="#l1.59"></a><span id="l1.59">             this.mCalendar.removeObserver(this.mObserver);</span>
<a href="#l1.60"></a><span id="l1.60">           }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/calendar-common-sets.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/calendar-common-sets.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -440,18 +440,20 @@ var calendarController = {</span>
<a href="#l2.4"></a><span id="l2.4">         if (</span>
<a href="#l2.5"></a><span id="l2.5">           !this.todo_tasktree_focused &amp;&amp;</span>
<a href="#l2.6"></a><span id="l2.6">           this.defaultController &amp;&amp;</span>
<a href="#l2.7"></a><span id="l2.7">           !this.isCalendarInForeground()</span>
<a href="#l2.8"></a><span id="l2.8">         ) {</span>
<a href="#l2.9"></a><span id="l2.9">           // Unless a task tree is focused, make the default controller</span>
<a href="#l2.10"></a><span id="l2.10">           // take care.</span>
<a href="#l2.11"></a><span id="l2.11">           this.defaultController.doCommand(aCommand);</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-        } else {</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineminus">-          selectAllItems();</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+        } else if (this.todo_tasktree_focused) {</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+          getTaskTree().selectAll();</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+        } else if (this.isInMode(&quot;calendar&quot;)) {</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+          selectAllEvents();</span>
<a href="#l2.18"></a><span id="l2.18">         }</span>
<a href="#l2.19"></a><span id="l2.19">         break;</span>
<a href="#l2.20"></a><span id="l2.20"> </span>
<a href="#l2.21"></a><span id="l2.21">       default:</span>
<a href="#l2.22"></a><span id="l2.22">         if (this.defaultController &amp;&amp; !this.isCalendarInForeground()) {</span>
<a href="#l2.23"></a><span id="l2.23">           // If calendar is not in foreground, let the default controller take</span>
<a href="#l2.24"></a><span id="l2.24">           // care. If we don't have a default controller, just continue.</span>
<a href="#l2.25"></a><span id="l2.25">           this.defaultController.doCommand(aCommand);</span>
<a href="#l2.26"></a><span id="l2.26" class="difflineat">@@ -868,28 +870,17 @@ function minimonthPick(aNewDate) {</span>
<a href="#l2.27"></a><span id="l2.27"> </span>
<a href="#l2.28"></a><span id="l2.28">     // update date filter for task tree</span>
<a href="#l2.29"></a><span id="l2.29">     let tree = document.getElementById(&quot;calendar-task-tree&quot;);</span>
<a href="#l2.30"></a><span id="l2.30">     tree.updateFilter();</span>
<a href="#l2.31"></a><span id="l2.31">   }</span>
<a href="#l2.32"></a><span id="l2.32"> }</span>
<a href="#l2.33"></a><span id="l2.33"> </span>
<a href="#l2.34"></a><span id="l2.34"> /**</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineminus">- * Selects all items, based on which mode we are currently in and what task tree is focused</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineminus">- */</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineminus">-function selectAllItems() {</span>
<a href="#l2.38"></a><span id="l2.38" class="difflineminus">-  if (calendarController.todo_tasktree_focused) {</span>
<a href="#l2.39"></a><span id="l2.39" class="difflineminus">-    getTaskTree().selectAll();</span>
<a href="#l2.40"></a><span id="l2.40" class="difflineminus">-  } else if (calendarController.isInMode(&quot;calendar&quot;)) {</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineminus">-    selectAllEvents();</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineminus">-  }</span>
<a href="#l2.43"></a><span id="l2.43" class="difflineminus">-}</span>
<a href="#l2.44"></a><span id="l2.44" class="difflineminus">-</span>
<a href="#l2.45"></a><span id="l2.45" class="difflineminus">-/**</span>
<a href="#l2.46"></a><span id="l2.46" class="difflineminus">- * Returns the selected items, based on which mode we are currently in and what task tree is focused</span>
<a href="#l2.47"></a><span id="l2.47" class="difflineplus">+ * Returns the selected items, based on which mode we are currently in and what task tree is focused.</span>
<a href="#l2.48"></a><span id="l2.48">  */</span>
<a href="#l2.49"></a><span id="l2.49"> function getSelectedItems() {</span>
<a href="#l2.50"></a><span id="l2.50">   if (calendarController.todo_tasktree_focused) {</span>
<a href="#l2.51"></a><span id="l2.51">     return getSelectedTasks();</span>
<a href="#l2.52"></a><span id="l2.52">   }</span>
<a href="#l2.53"></a><span id="l2.53"> </span>
<a href="#l2.54"></a><span id="l2.54">   return currentView().getSelectedItems({});</span>
<a href="#l2.55"></a><span id="l2.55"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/calendar-common-sets.xul</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/calendar-common-sets.xul</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -8,20 +8,16 @@</span>
<a href="#l3.4"></a><span id="l3.4">   &lt;!ENTITY % eventDialogDTD SYSTEM &quot;chrome://calendar/locale/calendar-event-dialog.dtd&quot;&gt; %eventDialogDTD;</span>
<a href="#l3.5"></a><span id="l3.5">   &lt;!ENTITY % menuOverlayDTD SYSTEM &quot;chrome://calendar/locale/menuOverlay.dtd&quot; &gt; %menuOverlayDTD;</span>
<a href="#l3.6"></a><span id="l3.6"> ]&gt;</span>
<a href="#l3.7"></a><span id="l3.7"> </span>
<a href="#l3.8"></a><span id="l3.8"> &lt;overlay id=&quot;calendar-common-sets-overlay&quot;</span>
<a href="#l3.9"></a><span id="l3.9">          xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot; xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span>
<a href="#l3.10"></a><span id="l3.10">   &lt;script src=&quot;chrome://calendar/content/calendar-common-sets.js&quot;/&gt;</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-  &lt;broadcasterset id=&quot;calendar_broadcasters&quot;&gt;</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-    &lt;broadcaster id=&quot;modeBroadcaster&quot; mode=&quot;calendar&quot;/&gt;</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineminus">-  &lt;/broadcasterset&gt;</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineminus">-</span>
<a href="#l3.16"></a><span id="l3.16">   &lt;commandset id=&quot;calendar_commands&quot;</span>
<a href="#l3.17"></a><span id="l3.17">               commandupdater=&quot;true&quot;</span>
<a href="#l3.18"></a><span id="l3.18">               events=&quot;calendar_commands&quot;</span>
<a href="#l3.19"></a><span id="l3.19">               oncommandupdate=&quot;calendarController.updateCommands()&quot;&gt;</span>
<a href="#l3.20"></a><span id="l3.20">     &lt;command id=&quot;calendar_new_event_command&quot; oncommand=&quot;goDoCommand('calendar_new_event_command')&quot;/&gt;</span>
<a href="#l3.21"></a><span id="l3.21">     &lt;command id=&quot;calendar_new_event_context_command&quot; oncommand=&quot;goDoCommand('calendar_new_event_context_command')&quot;/&gt;</span>
<a href="#l3.22"></a><span id="l3.22">     &lt;command id=&quot;calendar_modify_event_command&quot; oncommand=&quot;goDoCommand('calendar_modify_event_command')&quot;/&gt;</span>
<a href="#l3.23"></a><span id="l3.23">     &lt;command id=&quot;calendar_delete_event_command&quot; oncommand=&quot;goDoCommand('calendar_delete_event_command')&quot;/&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/calendar-multiday-base-view.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/calendar-multiday-base-view.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -1,14 +1,14 @@</span>
<a href="#l4.4"></a><span id="l4.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l4.5"></a><span id="l4.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l4.6"></a><span id="l4.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l4.7"></a><span id="l4.7"> </span>
<a href="#l4.8"></a><span id="l4.8"> /* global currentView, getOtherOrientation, MozElements, MozXULElement, Services,</span>
<a href="#l4.9"></a><span id="l4.9" class="difflineminus">-   setAttributeToChildren, setBooleanAttribute, timeIndicator */</span>
<a href="#l4.10"></a><span id="l4.10" class="difflineplus">+   setAttributeToChildren, setBooleanAttribute, timeIndicator, gCurrentMode */</span>
<a href="#l4.11"></a><span id="l4.11"> </span>
<a href="#l4.12"></a><span id="l4.12"> &quot;use strict&quot;;</span>
<a href="#l4.13"></a><span id="l4.13"> </span>
<a href="#l4.14"></a><span id="l4.14"> // Wrap in a block to prevent leaking to window scope.</span>
<a href="#l4.15"></a><span id="l4.15"> {</span>
<a href="#l4.16"></a><span id="l4.16">   var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l4.17"></a><span id="l4.17">   /**</span>
<a href="#l4.18"></a><span id="l4.18">    * The time bar that displays time divisions to the side or top of a multiday (day or week) view.</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineat">@@ -559,21 +559,19 @@</span>
<a href="#l4.20"></a><span id="l4.20"> </span>
<a href="#l4.21"></a><span id="l4.21">       const todayColumn = this.findColumnForDate(this.today());</span>
<a href="#l4.22"></a><span id="l4.22">       if (todayColumn) {</span>
<a href="#l4.23"></a><span id="l4.23">         setBooleanAttribute(todayColumn.column.timeIndicatorBox, &quot;hidden&quot;, hideIndicator);</span>
<a href="#l4.24"></a><span id="l4.24">       }</span>
<a href="#l4.25"></a><span id="l4.25"> </span>
<a href="#l4.26"></a><span id="l4.26">       // Update the timer but only under some circumstances, otherwise</span>
<a href="#l4.27"></a><span id="l4.27">       // it will update the wrong view or it will start without need.</span>
<a href="#l4.28"></a><span id="l4.28" class="difflineminus">-      const currentMode = document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;);</span>
<a href="#l4.29"></a><span id="l4.29">       const currView = currentView().type;</span>
<a href="#l4.30"></a><span id="l4.30" class="difflineminus">-</span>
<a href="#l4.31"></a><span id="l4.31">       if (</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineminus">-        currentMode == &quot;calendar&quot; &amp;&amp;</span>
<a href="#l4.33"></a><span id="l4.33" class="difflineplus">+        gCurrentMode == &quot;calendar&quot; &amp;&amp;</span>
<a href="#l4.34"></a><span id="l4.34">         currView == this.type &amp;&amp;</span>
<a href="#l4.35"></a><span id="l4.35">         !hideIndicator &amp;&amp;</span>
<a href="#l4.36"></a><span id="l4.36">         (currView == &quot;day&quot; || currView == &quot;week&quot;)</span>
<a href="#l4.37"></a><span id="l4.37">       ) {</span>
<a href="#l4.38"></a><span id="l4.38">         this.updateTimeIndicatorPosition(true);</span>
<a href="#l4.39"></a><span id="l4.39">       }</span>
<a href="#l4.40"></a><span id="l4.40">     }</span>
<a href="#l4.41"></a><span id="l4.41"> </span>
<a href="#l4.42"></a><span id="l4.42" class="difflineat">@@ -701,20 +699,18 @@</span>
<a href="#l4.43"></a><span id="l4.43">       setTimeout(() =&gt; self.scrollToMinute(self.mFirstVisibleMinute), 0);</span>
<a href="#l4.44"></a><span id="l4.44"> </span>
<a href="#l4.45"></a><span id="l4.45">       // Fit the weekday labels while scrolling.</span>
<a href="#l4.46"></a><span id="l4.46">       self.adjustWeekdayLength(isOrientHorizontal);</span>
<a href="#l4.47"></a><span id="l4.47"> </span>
<a href="#l4.48"></a><span id="l4.48">       // Adjust the time indicator position and the related timer.</span>
<a href="#l4.49"></a><span id="l4.49">       if (this.mTimeIndicatorInterval != 0) {</span>
<a href="#l4.50"></a><span id="l4.50">         const viewHasChanged = isARelayout &amp;&amp; timeIndicator.lastView != this.id;</span>
<a href="#l4.51"></a><span id="l4.51" class="difflineminus">-        const currentMode = document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;);</span>
<a href="#l4.52"></a><span id="l4.52" class="difflineminus">-</span>
<a href="#l4.53"></a><span id="l4.53">         if (</span>
<a href="#l4.54"></a><span id="l4.54" class="difflineminus">-          currentMode == &quot;calendar&quot; &amp;&amp;</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineplus">+          gCurrentMode == &quot;calendar&quot; &amp;&amp;</span>
<a href="#l4.56"></a><span id="l4.56">           (!timeIndicator.timer || ppmHasChanged || viewHasChanged)</span>
<a href="#l4.57"></a><span id="l4.57">         ) {</span>
<a href="#l4.58"></a><span id="l4.58">           self.updateTimeIndicatorPosition(true, ppmHasChanged, viewHasChanged);</span>
<a href="#l4.59"></a><span id="l4.59">         }</span>
<a href="#l4.60"></a><span id="l4.60">       }</span>
<a href="#l4.61"></a><span id="l4.61">     }</span>
<a href="#l4.62"></a><span id="l4.62"> </span>
<a href="#l4.63"></a><span id="l4.63">     /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/content/calendar-task-tree-utils.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-tree-utils.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -291,22 +291,20 @@ function deleteToDoCommand(aEvent, aDoNo</span>
<a href="#l5.4"></a><span id="l5.4"> }</span>
<a href="#l5.5"></a><span id="l5.5"> </span>
<a href="#l5.6"></a><span id="l5.6"> /**</span>
<a href="#l5.7"></a><span id="l5.7">  * Gets the currently visible task tree</span>
<a href="#l5.8"></a><span id="l5.8">  *</span>
<a href="#l5.9"></a><span id="l5.9">  * @return    The XUL task tree element.</span>
<a href="#l5.10"></a><span id="l5.10">  */</span>
<a href="#l5.11"></a><span id="l5.11"> function getTaskTree() {</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-  let currentMode = document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;);</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineminus">-  if (currentMode == &quot;task&quot;) {</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+  if (gCurrentMode == &quot;task&quot;) {</span>
<a href="#l5.15"></a><span id="l5.15">     return document.getElementById(&quot;calendar-task-tree&quot;);</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineminus">-  } else {</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineminus">-    return document.getElementById(&quot;unifinder-todo-tree&quot;);</span>
<a href="#l5.18"></a><span id="l5.18">   }</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+  return document.getElementById(&quot;unifinder-todo-tree&quot;);</span>
<a href="#l5.20"></a><span id="l5.20"> }</span>
<a href="#l5.21"></a><span id="l5.21"> </span>
<a href="#l5.22"></a><span id="l5.22"> /**</span>
<a href="#l5.23"></a><span id="l5.23">  * Gets the tasks selected in the currently visible task tree.</span>
<a href="#l5.24"></a><span id="l5.24">  *</span>
<a href="#l5.25"></a><span id="l5.25">  * XXX Parameter aEvent is unused, needs to be removed here and in calling</span>
<a href="#l5.26"></a><span id="l5.26">  * functions.</span>
<a href="#l5.27"></a><span id="l5.27">  *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1">deleted file mode 100644</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineminus">--- a/calendar/base/content/calendar-unifinder-todo.xul</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineplus">+++ /dev/null</span>
<a href="#l6.4"></a><span id="l6.4" class="difflineat">@@ -1,48 +0,0 @@</span>
<a href="#l6.5"></a><span id="l6.5" class="difflineminus">-&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l6.6"></a><span id="l6.6" class="difflineminus">-&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l6.7"></a><span id="l6.7" class="difflineminus">-   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l6.8"></a><span id="l6.8" class="difflineminus">-   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l6.9"></a><span id="l6.9" class="difflineminus">-</span>
<a href="#l6.10"></a><span id="l6.10" class="difflineminus">-&lt;!DOCTYPE overlay [</span>
<a href="#l6.11"></a><span id="l6.11" class="difflineminus">-  &lt;!ENTITY % dtd2 SYSTEM &quot;chrome://calendar/locale/calendar.dtd&quot; &gt; %dtd2;</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-  &lt;!ENTITY % dtd3 SYSTEM &quot;chrome://calendar/locale/calendar-event-dialog.dtd&quot;&gt; %dtd3;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-]&gt;</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineminus">-</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineminus">-&lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar/skin/calendar-task-view.css&quot;?&gt;</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineminus">-</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineminus">-&lt;overlay xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineminus">-         xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineminus">-</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineminus">-  &lt;script src=&quot;chrome://global/content/globalOverlay.js&quot;/&gt;</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineminus">-  &lt;script src=&quot;chrome://global/content/editMenuOverlay.js&quot;/&gt;</span>
<a href="#l6.22"></a><span id="l6.22" class="difflineminus">-  &lt;script src=&quot;chrome://calendar/content/calFilter.js&quot;/&gt;</span>
<a href="#l6.23"></a><span id="l6.23" class="difflineminus">-  &lt;script src=&quot;chrome://calendar/content/calendar-task-tree-utils.js&quot;/&gt;</span>
<a href="#l6.24"></a><span id="l6.24" class="difflineminus">-  &lt;script src=&quot;chrome://calendar/content/calendar-unifinder-todo.js&quot;/&gt;</span>
<a href="#l6.25"></a><span id="l6.25" class="difflineminus">-</span>
<a href="#l6.26"></a><span id="l6.26" class="difflineminus">-  &lt;vbox id=&quot;todo-tab-panel&quot; persist=&quot;height,collapsed&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l6.27"></a><span id="l6.27" class="difflineminus">-    &lt;!-- This second vbox means all of this is added to the DOM at once,</span>
<a href="#l6.28"></a><span id="l6.28" class="difflineminus">-         so the label's binding doesn't complain about not having a control. --&gt;</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineminus">-    &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l6.30"></a><span id="l6.30" class="difflineminus">-      &lt;box id=&quot;show-completed-checkbox-box&quot; align=&quot;center&quot;&gt;</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineminus">-        &lt;checkbox id=&quot;show-completed-checkbox&quot;</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineminus">-                  label=&quot;&amp;calendar.unifinder.showcompletedtodos.label;&quot;</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineminus">-                  flex=&quot;1&quot;</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineminus">-                  crop=&quot;end&quot;</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineminus">-                  oncommand=&quot;updateCalendarToDoUnifinder()&quot;</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineminus">-                  persist=&quot;checked&quot;/&gt;</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineminus">-      &lt;/box&gt;</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineminus">-      &lt;vbox id=&quot;calendar-task-tree-detail&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineminus">-        &lt;tree is=&quot;calendar-task-tree-todaypane&quot; id=&quot;unifinder-todo-tree&quot;</span>
<a href="#l6.40"></a><span id="l6.40" class="difflineminus">-              flex=&quot;1&quot;</span>
<a href="#l6.41"></a><span id="l6.41" class="difflineminus">-              visible-columns=&quot;completed priority title&quot;</span>
<a href="#l6.42"></a><span id="l6.42" class="difflineminus">-              persist=&quot;visible-columns ordinals widths sort-active sort-direction filterValue&quot;</span>
<a href="#l6.43"></a><span id="l6.43" class="difflineminus">-              context=&quot;taskitem-context-menu&quot;/&gt;</span>
<a href="#l6.44"></a><span id="l6.44" class="difflineminus">-        &lt;html:input id=&quot;unifinder-task-edit-field&quot;</span>
<a href="#l6.45"></a><span id="l6.45" class="difflineminus">-                    class=&quot;task-edit-field themeableSearchBox&quot;</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineminus">-                    onfocus=&quot;taskEdit.onFocus(event)&quot;</span>
<a href="#l6.47"></a><span id="l6.47" class="difflineminus">-                    onblur=&quot;taskEdit.onBlur(event)&quot;</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineminus">-                    onkeypress=&quot;taskEdit.onKeyPress(event)&quot;/&gt;</span>
<a href="#l6.49"></a><span id="l6.49" class="difflineminus">-      &lt;/vbox&gt;</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineminus">-    &lt;/vbox&gt;</span>
<a href="#l6.51"></a><span id="l6.51" class="difflineminus">-  &lt;/vbox&gt;</span>
<a href="#l6.52"></a><span id="l6.52" class="difflineminus">-&lt;/overlay&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/content/calendar-views-utils.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/content/calendar-views-utils.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -6,16 +6,17 @@</span>
<a href="#l7.4"></a><span id="l7.4">  *          observeViewDaySelect, toggleOrientation,</span>
<a href="#l7.5"></a><span id="l7.5">  *          toggleWorkdaysOnly, toggleTasksInView, toggleShowCompletedInView,</span>
<a href="#l7.6"></a><span id="l7.6">  *          goToDate, getLastCalendarView, deleteSelectedEvents,</span>
<a href="#l7.7"></a><span id="l7.7">  *          editSelectedEvents, selectAllEvents</span>
<a href="#l7.8"></a><span id="l7.8">  */</span>
<a href="#l7.9"></a><span id="l7.9"> </span>
<a href="#l7.10"></a><span id="l7.10"> /* import-globals-from calendar-chrome-startup.js */</span>
<a href="#l7.11"></a><span id="l7.11"> /* import-globals-from calendar-item-editing.js */</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+/* global gCurrentMode */</span>
<a href="#l7.13"></a><span id="l7.13"> </span>
<a href="#l7.14"></a><span id="l7.14"> var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l7.15"></a><span id="l7.15"> var { countOccurrences } = ChromeUtils.import(&quot;resource://calendar/modules/calRecurrenceUtils.jsm&quot;);</span>
<a href="#l7.16"></a><span id="l7.16"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l7.17"></a><span id="l7.17"> </span>
<a href="#l7.18"></a><span id="l7.18"> /**</span>
<a href="#l7.19"></a><span id="l7.19">  * Controller for the views</span>
<a href="#l7.20"></a><span id="l7.20">  * @see calIcalendarViewController</span>
<a href="#l7.21"></a><span id="l7.21" class="difflineat">@@ -603,17 +604,17 @@ cal.navigationBar = {</span>
<a href="#l7.22"></a><span id="l7.22">         ]);</span>
<a href="#l7.23"></a><span id="l7.23">         weekLabel.tooltipText = cal.l10n.getCalString(&quot;severalLongCalendarWeeks&quot;, [</span>
<a href="#l7.24"></a><span id="l7.24">           firstWeekNo,</span>
<a href="#l7.25"></a><span id="l7.25">           secondWeekNo,</span>
<a href="#l7.26"></a><span id="l7.26">         ]);</span>
<a href="#l7.27"></a><span id="l7.27">       }</span>
<a href="#l7.28"></a><span id="l7.28">       docTitle = intervalLabel.value;</span>
<a href="#l7.29"></a><span id="l7.29">     }</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineminus">-    if (document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;) == &quot;calendar&quot;) {</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineplus">+    if (gCurrentMode == &quot;calendar&quot;) {</span>
<a href="#l7.32"></a><span id="l7.32">       document.title =</span>
<a href="#l7.33"></a><span id="l7.33">         (docTitle ? docTitle + &quot; - &quot; : &quot;&quot;) +</span>
<a href="#l7.34"></a><span id="l7.34">         cal.l10n.getAnyString(&quot;branding&quot;, &quot;brand&quot;, &quot;brandFullName&quot;);</span>
<a href="#l7.35"></a><span id="l7.35">     }</span>
<a href="#l7.36"></a><span id="l7.36">     let viewTabs = document.getElementById(&quot;view-tabs&quot;);</span>
<a href="#l7.37"></a><span id="l7.37">     viewTabs.selectedIndex = getViewDeck().selectedIndex;</span>
<a href="#l7.38"></a><span id="l7.38">   },</span>
<a href="#l7.39"></a><span id="l7.39"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/content/calendar-views.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/content/calendar-views.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -1,44 +1,36 @@</span>
<a href="#l8.4"></a><span id="l8.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l8.5"></a><span id="l8.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l8.6"></a><span id="l8.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l8.7"></a><span id="l8.7"> </span>
<a href="#l8.8"></a><span id="l8.8" class="difflineminus">-/* global MozElements, MozXULElement, timeIndicator */</span>
<a href="#l8.9"></a><span id="l8.9" class="difflineplus">+/* global MozElements, MozXULElement */</span>
<a href="#l8.10"></a><span id="l8.10"> </span>
<a href="#l8.11"></a><span id="l8.11"> &quot;use strict&quot;;</span>
<a href="#l8.12"></a><span id="l8.12"> </span>
<a href="#l8.13"></a><span id="l8.13"> //                           The calendar view class hierarchy.</span>
<a href="#l8.14"></a><span id="l8.14"> //</span>
<a href="#l8.15"></a><span id="l8.15"> //                                     CalendarBaseView</span>
<a href="#l8.16"></a><span id="l8.16"> //                                     /               \</span>
<a href="#l8.17"></a><span id="l8.17"> //             CalendarMultidayBaseView                CalendarMonthBaseView</span>
<a href="#l8.18"></a><span id="l8.18"> //                 /           \                           /               \</span>
<a href="#l8.19"></a><span id="l8.19"> //     CalendarDayView     CalendarWeekView    CalendarMultiweekView    CalendarMonthView</span>
<a href="#l8.20"></a><span id="l8.20"> </span>
<a href="#l8.21"></a><span id="l8.21"> // Wrap in a block to prevent leaking to window scope.</span>
<a href="#l8.22"></a><span id="l8.22"> {</span>
<a href="#l8.23"></a><span id="l8.23">   var { cal } = ChromeUtils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l8.24"></a><span id="l8.24">   var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l8.25"></a><span id="l8.25" class="difflineplus">+</span>
<a href="#l8.26"></a><span id="l8.26">   /**</span>
<a href="#l8.27"></a><span id="l8.27">    * The calendar view for viewing a single day.</span>
<a href="#l8.28"></a><span id="l8.28">    *</span>
<a href="#l8.29"></a><span id="l8.29">    * @extends {MozElements.CalendarMultidayBaseView}</span>
<a href="#l8.30"></a><span id="l8.30" class="difflineplus">+   * @implements {calICalendarView}</span>
<a href="#l8.31"></a><span id="l8.31">    */</span>
<a href="#l8.32"></a><span id="l8.32">   class CalendarDayView extends MozElements.CalendarMultidayBaseView {</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineminus">-    connectedCallback() {</span>
<a href="#l8.34"></a><span id="l8.34" class="difflineminus">-      if (this.delayConnectedCallback() || this.hasConnected) {</span>
<a href="#l8.35"></a><span id="l8.35" class="difflineminus">-        return;</span>
<a href="#l8.36"></a><span id="l8.36" class="difflineminus">-      }</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineminus">-      // this.hasConnected is set to true via super.connectedCallback.</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineminus">-      super.connectedCallback();</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineminus">-    }</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineminus">-</span>
<a href="#l8.41"></a><span id="l8.41" class="difflineminus">-    // calICalendarView Methods and Properties.</span>
<a href="#l8.42"></a><span id="l8.42" class="difflineminus">-</span>
<a href="#l8.43"></a><span id="l8.43">     get observerID() {</span>
<a href="#l8.44"></a><span id="l8.44">       return &quot;day-view-observer&quot;;</span>
<a href="#l8.45"></a><span id="l8.45">     }</span>
<a href="#l8.46"></a><span id="l8.46"> </span>
<a href="#l8.47"></a><span id="l8.47">     get supportsWorkdaysOnly() {</span>
<a href="#l8.48"></a><span id="l8.48">       return false;</span>
<a href="#l8.49"></a><span id="l8.49">     }</span>
<a href="#l8.50"></a><span id="l8.50"> </span>
<a href="#l8.51"></a><span id="l8.51" class="difflineat">@@ -56,65 +48,29 @@</span>
<a href="#l8.52"></a><span id="l8.52">       if (number) {</span>
<a href="#l8.53"></a><span id="l8.53">         const currentDay = this.startDay.clone();</span>
<a href="#l8.54"></a><span id="l8.54">         currentDay.day += number;</span>
<a href="#l8.55"></a><span id="l8.55">         this.goToDay(currentDay);</span>
<a href="#l8.56"></a><span id="l8.56">       } else {</span>
<a href="#l8.57"></a><span id="l8.57">         this.goToDay(cal.dtz.now());</span>
<a href="#l8.58"></a><span id="l8.58">       }</span>
<a href="#l8.59"></a><span id="l8.59">     }</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineminus">-</span>
<a href="#l8.61"></a><span id="l8.61" class="difflineminus">-    // End calICalendarView Methods and Properties.</span>
<a href="#l8.62"></a><span id="l8.62">   }</span>
<a href="#l8.63"></a><span id="l8.63"> </span>
<a href="#l8.64"></a><span id="l8.64">   MozXULElement.implementCustomInterface(CalendarDayView, [Ci.calICalendarView]);</span>
<a href="#l8.65"></a><span id="l8.65"> </span>
<a href="#l8.66"></a><span id="l8.66">   customElements.define(&quot;calendar-day-view&quot;, CalendarDayView);</span>
<a href="#l8.67"></a><span id="l8.67"> </span>
<a href="#l8.68"></a><span id="l8.68">   /**</span>
<a href="#l8.69"></a><span id="l8.69">    * The calendar view for viewing a single week.</span>
<a href="#l8.70"></a><span id="l8.70">    *</span>
<a href="#l8.71"></a><span id="l8.71">    * @extends {MozElements.CalendarMultidayBaseView}</span>
<a href="#l8.72"></a><span id="l8.72" class="difflineplus">+   * @implements {calICalendarView}</span>
<a href="#l8.73"></a><span id="l8.73">    */</span>
<a href="#l8.74"></a><span id="l8.74">   class CalendarWeekView extends MozElements.CalendarMultidayBaseView {</span>
<a href="#l8.75"></a><span id="l8.75" class="difflineminus">-    connectedCallback() {</span>
<a href="#l8.76"></a><span id="l8.76" class="difflineminus">-      if (this.delayConnectedCallback() || this.hasConnected) {</span>
<a href="#l8.77"></a><span id="l8.77" class="difflineminus">-        return;</span>
<a href="#l8.78"></a><span id="l8.78" class="difflineminus">-      }</span>
<a href="#l8.79"></a><span id="l8.79" class="difflineminus">-      // this.hasConnected is set to true via super.connectedCallback.</span>
<a href="#l8.80"></a><span id="l8.80" class="difflineminus">-      super.connectedCallback();</span>
<a href="#l8.81"></a><span id="l8.81" class="difflineminus">-</span>
<a href="#l8.82"></a><span id="l8.82" class="difflineminus">-      // Add a listener for mode changes.</span>
<a href="#l8.83"></a><span id="l8.83" class="difflineminus">-      this.mModeHandler = event =&gt; {</span>
<a href="#l8.84"></a><span id="l8.84" class="difflineminus">-        if (event.attrName != &quot;mode&quot;) {</span>
<a href="#l8.85"></a><span id="l8.85" class="difflineminus">-          return;</span>
<a href="#l8.86"></a><span id="l8.86" class="difflineminus">-        }</span>
<a href="#l8.87"></a><span id="l8.87" class="difflineminus">-        const currentMode = document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;);</span>
<a href="#l8.88"></a><span id="l8.88" class="difflineminus">-        if (currentMode != &quot;calendar&quot;) {</span>
<a href="#l8.89"></a><span id="l8.89" class="difflineminus">-          timeIndicator.cancel();</span>
<a href="#l8.90"></a><span id="l8.90" class="difflineminus">-        }</span>
<a href="#l8.91"></a><span id="l8.91" class="difflineminus">-      };</span>
<a href="#l8.92"></a><span id="l8.92" class="difflineminus">-</span>
<a href="#l8.93"></a><span id="l8.93" class="difflineminus">-      document</span>
<a href="#l8.94"></a><span id="l8.94" class="difflineminus">-        .getElementById(&quot;modeBroadcaster&quot;)</span>
<a href="#l8.95"></a><span id="l8.95" class="difflineminus">-        .addEventListener(&quot;DOMAttrModified&quot;, this.mModeHandler, true);</span>
<a href="#l8.96"></a><span id="l8.96" class="difflineminus">-</span>
<a href="#l8.97"></a><span id="l8.97" class="difflineminus">-      window.addEventListener(</span>
<a href="#l8.98"></a><span id="l8.98" class="difflineminus">-        &quot;unload&quot;,</span>
<a href="#l8.99"></a><span id="l8.99" class="difflineminus">-        () =&gt; {</span>
<a href="#l8.100"></a><span id="l8.100" class="difflineminus">-          document</span>
<a href="#l8.101"></a><span id="l8.101" class="difflineminus">-            .getElementById(&quot;modeBroadcaster&quot;)</span>
<a href="#l8.102"></a><span id="l8.102" class="difflineminus">-            .removeEventListener(&quot;DOMAttrModified&quot;, this.mModeHandler, true);</span>
<a href="#l8.103"></a><span id="l8.103" class="difflineminus">-        },</span>
<a href="#l8.104"></a><span id="l8.104" class="difflineminus">-        { once: true }</span>
<a href="#l8.105"></a><span id="l8.105" class="difflineminus">-      );</span>
<a href="#l8.106"></a><span id="l8.106" class="difflineminus">-    }</span>
<a href="#l8.107"></a><span id="l8.107" class="difflineminus">-</span>
<a href="#l8.108"></a><span id="l8.108" class="difflineminus">-    // calICalendarView Methods and Properties.</span>
<a href="#l8.109"></a><span id="l8.109" class="difflineminus">-</span>
<a href="#l8.110"></a><span id="l8.110">     get observerID() {</span>
<a href="#l8.111"></a><span id="l8.111">       return &quot;week-view-observer&quot;;</span>
<a href="#l8.112"></a><span id="l8.112">     }</span>
<a href="#l8.113"></a><span id="l8.113"> </span>
<a href="#l8.114"></a><span id="l8.114">     goToDay(date) {</span>
<a href="#l8.115"></a><span id="l8.115">       this.displayDaysOff = !this.mWorkdaysOnly;</span>
<a href="#l8.116"></a><span id="l8.116"> </span>
<a href="#l8.117"></a><span id="l8.117">       if (!date) {</span>
<a href="#l8.118"></a><span id="l8.118" class="difflineat">@@ -133,28 +89,27 @@</span>
<a href="#l8.119"></a><span id="l8.119">       if (number) {</span>
<a href="#l8.120"></a><span id="l8.120">         const date = this.selectedDay.clone();</span>
<a href="#l8.121"></a><span id="l8.121">         date.day += 7 * number;</span>
<a href="#l8.122"></a><span id="l8.122">         this.goToDay(date);</span>
<a href="#l8.123"></a><span id="l8.123">       } else {</span>
<a href="#l8.124"></a><span id="l8.124">         this.goToDay(cal.dtz.now());</span>
<a href="#l8.125"></a><span id="l8.125">       }</span>
<a href="#l8.126"></a><span id="l8.126">     }</span>
<a href="#l8.127"></a><span id="l8.127" class="difflineminus">-</span>
<a href="#l8.128"></a><span id="l8.128" class="difflineminus">-    // End calICalendarView Methods and Properties.</span>
<a href="#l8.129"></a><span id="l8.129">   }</span>
<a href="#l8.130"></a><span id="l8.130"> </span>
<a href="#l8.131"></a><span id="l8.131">   MozXULElement.implementCustomInterface(CalendarWeekView, [Ci.calICalendarView]);</span>
<a href="#l8.132"></a><span id="l8.132"> </span>
<a href="#l8.133"></a><span id="l8.133">   customElements.define(&quot;calendar-week-view&quot;, CalendarWeekView);</span>
<a href="#l8.134"></a><span id="l8.134"> </span>
<a href="#l8.135"></a><span id="l8.135">   /**</span>
<a href="#l8.136"></a><span id="l8.136">    * The calendar view for viewing multiple weeks.</span>
<a href="#l8.137"></a><span id="l8.137">    *</span>
<a href="#l8.138"></a><span id="l8.138">    * @extends {MozElements.CalendarMonthBaseView}</span>
<a href="#l8.139"></a><span id="l8.139" class="difflineplus">+   * @implements {calICalendarView}</span>
<a href="#l8.140"></a><span id="l8.140">    */</span>
<a href="#l8.141"></a><span id="l8.141">   class CalendarMultiweekView extends MozElements.CalendarMonthBaseView {</span>
<a href="#l8.142"></a><span id="l8.142">     connectedCallback() {</span>
<a href="#l8.143"></a><span id="l8.143">       if (this.delayConnectedCallback() || this.hasConnected) {</span>
<a href="#l8.144"></a><span id="l8.144">         return;</span>
<a href="#l8.145"></a><span id="l8.145">       }</span>
<a href="#l8.146"></a><span id="l8.146">       // this.hasConnected is set to true via super.connectedCallback.</span>
<a href="#l8.147"></a><span id="l8.147">       super.connectedCallback();</span>
<a href="#l8.148"></a><span id="l8.148" class="difflineat">@@ -168,18 +123,16 @@</span>
<a href="#l8.149"></a><span id="l8.149">       this.refreshView();</span>
<a href="#l8.150"></a><span id="l8.150">       return weeks;</span>
<a href="#l8.151"></a><span id="l8.151">     }</span>
<a href="#l8.152"></a><span id="l8.152"> </span>
<a href="#l8.153"></a><span id="l8.153">     get weeksInView() {</span>
<a href="#l8.154"></a><span id="l8.154">       return this.mWeeksInView;</span>
<a href="#l8.155"></a><span id="l8.155">     }</span>
<a href="#l8.156"></a><span id="l8.156"> </span>
<a href="#l8.157"></a><span id="l8.157" class="difflineminus">-    // calICalendarView Methods and Properties.</span>
<a href="#l8.158"></a><span id="l8.158" class="difflineminus">-</span>
<a href="#l8.159"></a><span id="l8.159">     get supportsZoom() {</span>
<a href="#l8.160"></a><span id="l8.160">       return true;</span>
<a href="#l8.161"></a><span id="l8.161">     }</span>
<a href="#l8.162"></a><span id="l8.162"> </span>
<a href="#l8.163"></a><span id="l8.163">     get observerID() {</span>
<a href="#l8.164"></a><span id="l8.164">       return &quot;multiweek-view-observer&quot;;</span>
<a href="#l8.165"></a><span id="l8.165">     }</span>
<a href="#l8.166"></a><span id="l8.166"> </span>
<a href="#l8.167"></a><span id="l8.167" class="difflineat">@@ -237,28 +190,27 @@</span>
<a href="#l8.168"></a><span id="l8.168">         savedSelectedDay.day += 7 * weeksToMove;</span>
<a href="#l8.169"></a><span id="l8.169">         this.selectedDay = savedSelectedDay;</span>
<a href="#l8.170"></a><span id="l8.170">       } else {</span>
<a href="#l8.171"></a><span id="l8.171">         const date = cal.dtz.now();</span>
<a href="#l8.172"></a><span id="l8.172">         this.goToDay(date);</span>
<a href="#l8.173"></a><span id="l8.173">         this.selectedDay = date;</span>
<a href="#l8.174"></a><span id="l8.174">       }</span>
<a href="#l8.175"></a><span id="l8.175">     }</span>
<a href="#l8.176"></a><span id="l8.176" class="difflineminus">-</span>
<a href="#l8.177"></a><span id="l8.177" class="difflineminus">-    // End calICalendarView Methods and Properties.</span>
<a href="#l8.178"></a><span id="l8.178">   }</span>
<a href="#l8.179"></a><span id="l8.179"> </span>
<a href="#l8.180"></a><span id="l8.180">   MozXULElement.implementCustomInterface(CalendarMultiweekView, [Ci.calICalendarView]);</span>
<a href="#l8.181"></a><span id="l8.181"> </span>
<a href="#l8.182"></a><span id="l8.182">   customElements.define(&quot;calendar-multiweek-view&quot;, CalendarMultiweekView);</span>
<a href="#l8.183"></a><span id="l8.183"> </span>
<a href="#l8.184"></a><span id="l8.184">   /**</span>
<a href="#l8.185"></a><span id="l8.185">    * The calendar view for viewing a single month.</span>
<a href="#l8.186"></a><span id="l8.186">    *</span>
<a href="#l8.187"></a><span id="l8.187">    * @extends {MozElements.CalendarMonthBaseView}</span>
<a href="#l8.188"></a><span id="l8.188" class="difflineplus">+   * @implements {calICalendarView}</span>
<a href="#l8.189"></a><span id="l8.189">    */</span>
<a href="#l8.190"></a><span id="l8.190">   class CalendarMonthView extends MozElements.CalendarMonthBaseView {</span>
<a href="#l8.191"></a><span id="l8.191">     connectedCallback() {</span>
<a href="#l8.192"></a><span id="l8.192">       if (this.delayConnectedCallback() || this.hasConnected) {</span>
<a href="#l8.193"></a><span id="l8.193">         return;</span>
<a href="#l8.194"></a><span id="l8.194">       }</span>
<a href="#l8.195"></a><span id="l8.195">       // this.hasConnected is set to true via super.connectedCallback.</span>
<a href="#l8.196"></a><span id="l8.196">       super.connectedCallback();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/base/content/today-pane.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/base/content/today-pane.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -36,36 +36,30 @@ var TodayPane = {</span>
<a href="#l9.4"></a><span id="l9.4">       cal.l10n.getCalString(&quot;eventsandtasks&quot;),</span>
<a href="#l9.5"></a><span id="l9.5">       cal.l10n.getCalString(&quot;tasksonly&quot;),</span>
<a href="#l9.6"></a><span id="l9.6">       cal.l10n.getCalString(&quot;eventsonly&quot;),</span>
<a href="#l9.7"></a><span id="l9.7">     ];</span>
<a href="#l9.8"></a><span id="l9.8"> </span>
<a href="#l9.9"></a><span id="l9.9">     TodayPane.setShortWeekdays();</span>
<a href="#l9.10"></a><span id="l9.10">     TodayPane.updateDisplay();</span>
<a href="#l9.11"></a><span id="l9.11">     TodayPane.updateSplitterState();</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    TodayPane.previousMode = document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;);</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+    TodayPane.previousMode = gCurrentMode;</span>
<a href="#l9.14"></a><span id="l9.14">     TodayPane.showTodayPaneStatusLabel();</span>
<a href="#l9.15"></a><span id="l9.15"> </span>
<a href="#l9.16"></a><span id="l9.16" class="difflineminus">-    document</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineminus">-      .getElementById(&quot;modeBroadcaster&quot;)</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineminus">-      .addEventListener(&quot;DOMAttrModified&quot;, TodayPane.onModeModified);</span>
<a href="#l9.19"></a><span id="l9.19">     document.getElementById(&quot;today-splitter&quot;).addEventListener(&quot;command&quot;, () =&gt; {</span>
<a href="#l9.20"></a><span id="l9.20">       document.dispatchEvent(new CustomEvent(&quot;viewresize&quot;, { bubbles: true }));</span>
<a href="#l9.21"></a><span id="l9.21">     });</span>
<a href="#l9.22"></a><span id="l9.22"> </span>
<a href="#l9.23"></a><span id="l9.23">     Services.obs.addObserver(TodayPane, &quot;defaultTimezoneChanged&quot;);</span>
<a href="#l9.24"></a><span id="l9.24">   },</span>
<a href="#l9.25"></a><span id="l9.25"> </span>
<a href="#l9.26"></a><span id="l9.26">   /**</span>
<a href="#l9.27"></a><span id="l9.27">    * Unload handler, cleans up the today pane on window unload.</span>
<a href="#l9.28"></a><span id="l9.28">    */</span>
<a href="#l9.29"></a><span id="l9.29">   onUnload: function() {</span>
<a href="#l9.30"></a><span id="l9.30" class="difflineminus">-    document</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineminus">-      .getElementById(&quot;modeBroadcaster&quot;)</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineminus">-      .removeEventListener(&quot;DOMAttrModified&quot;, TodayPane.onModeModified);</span>
<a href="#l9.33"></a><span id="l9.33">     Services.obs.removeObserver(TodayPane, &quot;defaultTimezoneChanged&quot;);</span>
<a href="#l9.34"></a><span id="l9.34">   },</span>
<a href="#l9.35"></a><span id="l9.35"> </span>
<a href="#l9.36"></a><span id="l9.36">   /**</span>
<a href="#l9.37"></a><span id="l9.37">    * React if the default timezone changes.</span>
<a href="#l9.38"></a><span id="l9.38">    */</span>
<a href="#l9.39"></a><span id="l9.39">   observe: function() {</span>
<a href="#l9.40"></a><span id="l9.40">     if (this.start !== null) {</span>
<a href="#l9.41"></a><span id="l9.41" class="difflineat">@@ -73,19 +67,18 @@ var TodayPane = {</span>
<a href="#l9.42"></a><span id="l9.42">     }</span>
<a href="#l9.43"></a><span id="l9.43">   },</span>
<a href="#l9.44"></a><span id="l9.44"> </span>
<a href="#l9.45"></a><span id="l9.45">   /**</span>
<a href="#l9.46"></a><span id="l9.46">    * Sets up the label for the switcher that allows switching between today pane</span>
<a href="#l9.47"></a><span id="l9.47">    * views. (event+task, task only, event only)</span>
<a href="#l9.48"></a><span id="l9.48">    */</span>
<a href="#l9.49"></a><span id="l9.49">   updateDisplay: function() {</span>
<a href="#l9.50"></a><span id="l9.50" class="difflineminus">-    let currentMode = document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;);</span>
<a href="#l9.51"></a><span id="l9.51" class="difflineminus">-    let agendaIsVisible = document.getElementById(&quot;agenda-panel&quot;).isVisible(currentMode);</span>
<a href="#l9.52"></a><span id="l9.52" class="difflineminus">-    let todoIsVisible = document.getElementById(&quot;todo-tab-panel&quot;).isVisible(currentMode);</span>
<a href="#l9.53"></a><span id="l9.53" class="difflineplus">+    let agendaIsVisible = document.getElementById(&quot;agenda-panel&quot;).isVisible(gCurrentMode);</span>
<a href="#l9.54"></a><span id="l9.54" class="difflineplus">+    let todoIsVisible = document.getElementById(&quot;todo-tab-panel&quot;).isVisible(gCurrentMode);</span>
<a href="#l9.55"></a><span id="l9.55">     let index = 2;</span>
<a href="#l9.56"></a><span id="l9.56">     if (agendaIsVisible &amp;&amp; todoIsVisible) {</span>
<a href="#l9.57"></a><span id="l9.57">       index = 0;</span>
<a href="#l9.58"></a><span id="l9.58">     } else if (!agendaIsVisible &amp;&amp; todoIsVisible) {</span>
<a href="#l9.59"></a><span id="l9.59">       index = 1;</span>
<a href="#l9.60"></a><span id="l9.60">     } else if (agendaIsVisible &amp;&amp; !todoIsVisible) {</span>
<a href="#l9.61"></a><span id="l9.61">       index = 2;</span>
<a href="#l9.62"></a><span id="l9.62">     } else {</span>
<a href="#l9.63"></a><span id="l9.63" class="difflineat">@@ -308,19 +301,18 @@ var TodayPane = {</span>
<a href="#l9.64"></a><span id="l9.64">     let nViewLen = this.paneViews.length;</span>
<a href="#l9.65"></a><span id="l9.65">     if (index &gt;= nViewLen) {</span>
<a href="#l9.66"></a><span id="l9.66">       index = 0;</span>
<a href="#l9.67"></a><span id="l9.67">     } else if (index == -1) {</span>
<a href="#l9.68"></a><span id="l9.68">       index = nViewLen - 1;</span>
<a href="#l9.69"></a><span id="l9.69">     }</span>
<a href="#l9.70"></a><span id="l9.70">     let agendaPanel = document.getElementById(&quot;agenda-panel&quot;);</span>
<a href="#l9.71"></a><span id="l9.71">     let todoPanel = document.getElementById(&quot;todo-tab-panel&quot;);</span>
<a href="#l9.72"></a><span id="l9.72" class="difflineminus">-    let currentMode = document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;);</span>
<a href="#l9.73"></a><span id="l9.73" class="difflineminus">-    let isTodoPanelVisible = index != 2 &amp;&amp; todoPanel.isVisibleInMode(currentMode);</span>
<a href="#l9.74"></a><span id="l9.74" class="difflineminus">-    let isAgendaPanelVisible = index != 1 &amp;&amp; agendaPanel.isVisibleInMode(currentMode);</span>
<a href="#l9.75"></a><span id="l9.75" class="difflineplus">+    let isTodoPanelVisible = index != 2 &amp;&amp; todoPanel.isVisibleInMode(gCurrentMode);</span>
<a href="#l9.76"></a><span id="l9.76" class="difflineplus">+    let isAgendaPanelVisible = index != 1 &amp;&amp; agendaPanel.isVisibleInMode(gCurrentMode);</span>
<a href="#l9.77"></a><span id="l9.77">     todoPanel.setVisible(isTodoPanelVisible);</span>
<a href="#l9.78"></a><span id="l9.78">     agendaPanel.setVisible(isAgendaPanelVisible);</span>
<a href="#l9.79"></a><span id="l9.79">     this.updateDisplay();</span>
<a href="#l9.80"></a><span id="l9.80">   },</span>
<a href="#l9.81"></a><span id="l9.81"> </span>
<a href="#l9.82"></a><span id="l9.82">   /**</span>
<a href="#l9.83"></a><span id="l9.83">    * Shows short weekday names in the weekdayNameContainer</span>
<a href="#l9.84"></a><span id="l9.84">    */</span>
<a href="#l9.85"></a><span id="l9.85" class="difflineat">@@ -433,32 +425,27 @@ var TodayPane = {</span>
<a href="#l9.86"></a><span id="l9.86">     setBooleanAttribute(</span>
<a href="#l9.87"></a><span id="l9.87">       document.getElementById(&quot;today-minimonth&quot;),</span>
<a href="#l9.88"></a><span id="l9.88">       &quot;freebusy&quot;,</span>
<a href="#l9.89"></a><span id="l9.89">       aSection == &quot;minimonth&quot;</span>
<a href="#l9.90"></a><span id="l9.90">     );</span>
<a href="#l9.91"></a><span id="l9.91">   },</span>
<a href="#l9.92"></a><span id="l9.92"> </span>
<a href="#l9.93"></a><span id="l9.93">   /**</span>
<a href="#l9.94"></a><span id="l9.94" class="difflineminus">-   * Handler function for the DOMAttrModified event used to observe the</span>
<a href="#l9.95"></a><span id="l9.95" class="difflineminus">-   * todaypane-splitter.</span>
<a href="#l9.96"></a><span id="l9.96" class="difflineminus">-   *</span>
<a href="#l9.97"></a><span id="l9.97" class="difflineminus">-   * @param aEvent        The DOM event occurring on attribute modification.</span>
<a href="#l9.98"></a><span id="l9.98" class="difflineplus">+   * Handler function to update the today-pane when the current mode changes.</span>
<a href="#l9.99"></a><span id="l9.99">    */</span>
<a href="#l9.100"></a><span id="l9.100" class="difflineminus">-  onModeModified: function(aEvent) {</span>
<a href="#l9.101"></a><span id="l9.101" class="difflineminus">-    if (aEvent.attrName == &quot;mode&quot;) {</span>
<a href="#l9.102"></a><span id="l9.102" class="difflineminus">-      let todaypane = document.getElementById(&quot;today-pane-panel&quot;);</span>
<a href="#l9.103"></a><span id="l9.103" class="difflineminus">-      // Store the previous mode panel's width.</span>
<a href="#l9.104"></a><span id="l9.104" class="difflineminus">-      todaypane.setModeAttribute(&quot;modewidths&quot;, todaypane.width, TodayPane.previousMode);</span>
<a href="#l9.105"></a><span id="l9.105" class="difflineplus">+  onModeModified: function() {</span>
<a href="#l9.106"></a><span id="l9.106" class="difflineplus">+    let todayPanePanel = document.getElementById(&quot;today-pane-panel&quot;);</span>
<a href="#l9.107"></a><span id="l9.107" class="difflineplus">+    // Store the previous mode panel's width.</span>
<a href="#l9.108"></a><span id="l9.108" class="difflineplus">+    todayPanePanel.setModeAttribute(&quot;modewidths&quot;, todayPanePanel.width, TodayPane.previousMode);</span>
<a href="#l9.109"></a><span id="l9.109"> </span>
<a href="#l9.110"></a><span id="l9.110" class="difflineminus">-      TodayPane.updateDisplay();</span>
<a href="#l9.111"></a><span id="l9.111" class="difflineminus">-      TodayPane.updateSplitterState();</span>
<a href="#l9.112"></a><span id="l9.112" class="difflineminus">-      todaypane.width = todaypane.getModeAttribute(&quot;modewidths&quot;);</span>
<a href="#l9.113"></a><span id="l9.113" class="difflineminus">-      TodayPane.previousMode = document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;);</span>
<a href="#l9.114"></a><span id="l9.114" class="difflineminus">-    }</span>
<a href="#l9.115"></a><span id="l9.115" class="difflineplus">+    TodayPane.updateDisplay();</span>
<a href="#l9.116"></a><span id="l9.116" class="difflineplus">+    TodayPane.updateSplitterState();</span>
<a href="#l9.117"></a><span id="l9.117" class="difflineplus">+    todayPanePanel.width = todayPanePanel.getModeAttribute(&quot;modewidths&quot;);</span>
<a href="#l9.118"></a><span id="l9.118" class="difflineplus">+    TodayPane.previousMode = gCurrentMode;</span>
<a href="#l9.119"></a><span id="l9.119">   },</span>
<a href="#l9.120"></a><span id="l9.120"> </span>
<a href="#l9.121"></a><span id="l9.121">   get isVisible() {</span>
<a href="#l9.122"></a><span id="l9.122">     return document.getElementById(&quot;today-pane-panel&quot;).isVisible();</span>
<a href="#l9.123"></a><span id="l9.123">   },</span>
<a href="#l9.124"></a><span id="l9.124"> </span>
<a href="#l9.125"></a><span id="l9.125">   /**</span>
<a href="#l9.126"></a><span id="l9.126">    * Toggle the today-pane and update its visual appearance.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/base/content/today-pane.xul</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/base/content/today-pane.xul</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -8,38 +8,44 @@</span>
<a href="#l10.4"></a><span id="l10.4">   &lt;!ENTITY % dtd2 SYSTEM &quot;chrome://lightning/locale/lightning.dtd&quot; &gt; %dtd2;</span>
<a href="#l10.5"></a><span id="l10.5">   &lt;!ENTITY % dtd3 SYSTEM &quot;chrome://messenger/locale/messenger.dtd&quot; &gt; %dtd3;</span>
<a href="#l10.6"></a><span id="l10.6">   &lt;!ENTITY % dtd4 SYSTEM &quot;chrome://calendar/locale/calendar.dtd&quot; &gt; %dtd4;</span>
<a href="#l10.7"></a><span id="l10.7">   &lt;!ENTITY % dtd5 SYSTEM &quot;chrome://global/locale/global.dtd&quot; &gt; %dtd5;</span>
<a href="#l10.8"></a><span id="l10.8">   &lt;!ENTITY % dtd6 SYSTEM &quot;chrome://calendar/locale/calendar-event-dialog.dtd&quot;&gt; %dtd6;</span>
<a href="#l10.9"></a><span id="l10.9"> ]&gt;</span>
<a href="#l10.10"></a><span id="l10.10"> </span>
<a href="#l10.11"></a><span id="l10.11"> &lt;?xml-stylesheet href=&quot;chrome://calendar/skin/today-pane.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineplus">+&lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar/skin/calendar-task-view.css&quot;?&gt;</span>
<a href="#l10.13"></a><span id="l10.13"> </span>
<a href="#l10.14"></a><span id="l10.14"> &lt;overlay xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot; xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span>
<a href="#l10.15"></a><span id="l10.15"> </span>
<a href="#l10.16"></a><span id="l10.16" class="difflineplus">+  &lt;script src=&quot;chrome://global/content/globalOverlay.js&quot;/&gt;</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineplus">+  &lt;script src=&quot;chrome://global/content/editMenuOverlay.js&quot;/&gt;</span>
<a href="#l10.18"></a><span id="l10.18" class="difflineplus">+</span>
<a href="#l10.19"></a><span id="l10.19">   &lt;script src=&quot;chrome://calendar/content/agenda-listbox.js&quot;/&gt;</span>
<a href="#l10.20"></a><span id="l10.20">   &lt;script src=&quot;chrome://calendar/content/today-pane.js&quot;/&gt;</span>
<a href="#l10.21"></a><span id="l10.21">   &lt;script src=&quot;chrome://calendar/content/agenda-listbox-utils.js&quot;/&gt;</span>
<a href="#l10.22"></a><span id="l10.22">   &lt;script src=&quot;chrome://calendar/content/calendar-management.js&quot;/&gt;</span>
<a href="#l10.23"></a><span id="l10.23">   &lt;script src=&quot;chrome://calendar/content/calendar-dnd-listener.js&quot;/&gt;</span>
<a href="#l10.24"></a><span id="l10.24">   &lt;script src=&quot;chrome://calendar/content/calendar-item-editing.js&quot;/&gt;</span>
<a href="#l10.25"></a><span id="l10.25"> </span>
<a href="#l10.26"></a><span id="l10.26" class="difflineplus">+  &lt;script src=&quot;chrome://calendar/content/calFilter.js&quot;/&gt;</span>
<a href="#l10.27"></a><span id="l10.27" class="difflineplus">+  &lt;script src=&quot;chrome://calendar/content/calendar-task-tree-utils.js&quot;/&gt;</span>
<a href="#l10.28"></a><span id="l10.28" class="difflineplus">+  &lt;script src=&quot;chrome://calendar/content/calendar-unifinder-todo.js&quot;/&gt;</span>
<a href="#l10.29"></a><span id="l10.29" class="difflineplus">+</span>
<a href="#l10.30"></a><span id="l10.30">   &lt;calendar-modevbox id=&quot;today-pane-panel&quot;</span>
<a href="#l10.31"></a><span id="l10.31">                      mode=&quot;mail,calendar,task&quot;</span>
<a href="#l10.32"></a><span id="l10.32">                      modewidths=&quot;200,200,200&quot;</span>
<a href="#l10.33"></a><span id="l10.33">                      modesplitterstates=&quot;open,open,open&quot;</span>
<a href="#l10.34"></a><span id="l10.34">                      refcontrol=&quot;calendar_toggle_todaypane_command&quot;</span>
<a href="#l10.35"></a><span id="l10.35" class="difflineminus">-                     broadcaster=&quot;modeBroadcaster&quot;</span>
<a href="#l10.36"></a><span id="l10.36">                      persist=&quot;modewidths&quot;&gt;</span>
<a href="#l10.37"></a><span id="l10.37">     &lt;sidebarheader align=&quot;center&quot;&gt;</span>
<a href="#l10.38"></a><span id="l10.38" class="difflineminus">-      &lt;label id =&quot;today-pane-header&quot;/&gt;</span>
<a href="#l10.39"></a><span id="l10.39" class="difflineplus">+      &lt;label id=&quot;today-pane-header&quot;/&gt;</span>
<a href="#l10.40"></a><span id="l10.40">       &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l10.41"></a><span id="l10.41" class="difflineminus">-      &lt;calendar-modebox mode=&quot;mail,calendar&quot;</span>
<a href="#l10.42"></a><span id="l10.42" class="difflineminus">-                        broadcaster=&quot;modeBroadcaster&quot;&gt;</span>
<a href="#l10.43"></a><span id="l10.43" class="difflineplus">+      &lt;calendar-modebox mode=&quot;mail,calendar&quot;&gt;</span>
<a href="#l10.44"></a><span id="l10.44">         &lt;toolbarbutton id=&quot;today-pane-cycler-prev&quot;</span>
<a href="#l10.45"></a><span id="l10.45">                        dir=&quot;prev&quot;</span>
<a href="#l10.46"></a><span id="l10.46">                        class=&quot;today-pane-cycler&quot;</span>
<a href="#l10.47"></a><span id="l10.47">                        oncommand=&quot;TodayPane.cyclePaneView(-1);&quot;/&gt;</span>
<a href="#l10.48"></a><span id="l10.48">         &lt;toolbarbutton id=&quot;today-pane-cycler-next&quot;</span>
<a href="#l10.49"></a><span id="l10.49">                        dir=&quot;next&quot;</span>
<a href="#l10.50"></a><span id="l10.50">                        class=&quot;today-pane-cycler&quot;</span>
<a href="#l10.51"></a><span id="l10.51">                        oncommand=&quot;TodayPane.cyclePaneView(1);&quot;/&gt;</span>
<a href="#l10.52"></a><span id="l10.52" class="difflineat">@@ -50,40 +56,36 @@</span>
<a href="#l10.53"></a><span id="l10.53">                                 TodayPane.updateDisplay();</span>
<a href="#l10.54"></a><span id="l10.54">                                 TodayPane.updateSplitterState();&quot;/&gt;</span>
<a href="#l10.55"></a><span id="l10.55">     &lt;/sidebarheader&gt;</span>
<a href="#l10.56"></a><span id="l10.56">     &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l10.57"></a><span id="l10.57">       &lt;calendar-modevbox id=&quot;agenda-panel&quot;</span>
<a href="#l10.58"></a><span id="l10.58">                          flex=&quot;1&quot;</span>
<a href="#l10.59"></a><span id="l10.59">                          mode=&quot;mail,calendar,task&quot;</span>
<a href="#l10.60"></a><span id="l10.60">                          collapsedinmodes=&quot;calendar&quot;</span>
<a href="#l10.61"></a><span id="l10.61" class="difflineminus">-                         persist=&quot;collapsed height collapsedinmodes&quot;</span>
<a href="#l10.62"></a><span id="l10.62" class="difflineminus">-                         broadcaster=&quot;modeBroadcaster&quot;&gt;</span>
<a href="#l10.63"></a><span id="l10.63" class="difflineplus">+                         persist=&quot;collapsed height collapsedinmodes&quot;&gt;</span>
<a href="#l10.64"></a><span id="l10.64">         &lt;calendar-modebox id=&quot;today-none-box&quot;</span>
<a href="#l10.65"></a><span id="l10.65">                           mode=&quot;mail,calendar,task&quot;</span>
<a href="#l10.66"></a><span id="l10.66">                           collapsedinmodes=&quot;mail,calendar,task&quot;</span>
<a href="#l10.67"></a><span id="l10.67" class="difflineminus">-                          broadcaster=&quot;modeBroadcaster&quot;</span>
<a href="#l10.68"></a><span id="l10.68">                           refcontrol=&quot;ltnTodayPaneDisplayNone&quot;</span>
<a href="#l10.69"></a><span id="l10.69">                           persist=&quot;collapsedinmodes&quot;/&gt;</span>
<a href="#l10.70"></a><span id="l10.70">         &lt;calendar-modebox id=&quot;today-minimonth-box&quot;</span>
<a href="#l10.71"></a><span id="l10.71">                           pack=&quot;center&quot;</span>
<a href="#l10.72"></a><span id="l10.72">                           class=&quot;today-subpane&quot;</span>
<a href="#l10.73"></a><span id="l10.73">                           mode=&quot;mail,calendar,task&quot;</span>
<a href="#l10.74"></a><span id="l10.74" class="difflineminus">-                          broadcaster=&quot;modeBroadcaster&quot;</span>
<a href="#l10.75"></a><span id="l10.75">                           collapsedinmodes=&quot;mail,calendar,task&quot;</span>
<a href="#l10.76"></a><span id="l10.76">                           refcontrol=&quot;ltnTodayPaneDisplayMinimonth&quot;</span>
<a href="#l10.77"></a><span id="l10.77">                           persist=&quot;collapsedinmodes&quot;&gt;</span>
<a href="#l10.78"></a><span id="l10.78">           &lt;calendar-minimonth id=&quot;today-minimonth&quot;</span>
<a href="#l10.79"></a><span id="l10.79">                               onchange=&quot;TodayPane.setDaywithjsDate(this.value);&quot;/&gt;</span>
<a href="#l10.80"></a><span id="l10.80">         &lt;/calendar-modebox&gt;</span>
<a href="#l10.81"></a><span id="l10.81">         &lt;calendar-modebox id=&quot;mini-day-box&quot;</span>
<a href="#l10.82"></a><span id="l10.82">                           mode=&quot;mail,calendar,task&quot;</span>
<a href="#l10.83"></a><span id="l10.83">                           class=&quot;today-subpane&quot;</span>
<a href="#l10.84"></a><span id="l10.84">                           refcontrol=&quot;ltnTodayPaneDisplayMiniday&quot;</span>
<a href="#l10.85"></a><span id="l10.85" class="difflineminus">-                          broadcaster=&quot;modeBroadcaster&quot;</span>
<a href="#l10.86"></a><span id="l10.86">                           collapsedinmodes=&quot;&quot;</span>
<a href="#l10.87"></a><span id="l10.87">                           persist=&quot;collapsedinmodes&quot;</span>
<a href="#l10.88"></a><span id="l10.88">                           onDOMMouseScroll=&quot;TodayPane.advance(event.detail &gt; 0 ? 1 : -1);&quot;&gt;</span>
<a href="#l10.89"></a><span id="l10.89">           &lt;stack flex=&quot;1&quot;&gt;</span>
<a href="#l10.90"></a><span id="l10.90">             &lt;image id=&quot;mini-day-image&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l10.91"></a><span id="l10.91">             &lt;hbox flex=&quot;1&quot;&gt;</span>
<a href="#l10.92"></a><span id="l10.92">               &lt;stack id=&quot;dateContainer&quot;&gt;</span>
<a href="#l10.93"></a><span id="l10.93">                 &lt;hbox pack=&quot;center&quot;</span>
<a href="#l10.94"></a><span id="l10.94" class="difflineat">@@ -373,20 +375,45 @@</span>
<a href="#l10.95"></a><span id="l10.95">           &lt;/richlistbox&gt;</span>
<a href="#l10.96"></a><span id="l10.96">         &lt;/vbox&gt;</span>
<a href="#l10.97"></a><span id="l10.97">       &lt;/calendar-modevbox&gt;</span>
<a href="#l10.98"></a><span id="l10.98">       &lt;splitter id=&quot;today-pane-splitter&quot; persist=&quot;hidden&quot;/&gt;</span>
<a href="#l10.99"></a><span id="l10.99">       &lt;calendar-modevbox id=&quot;todo-tab-panel&quot;</span>
<a href="#l10.100"></a><span id="l10.100">                          flex=&quot;1&quot;</span>
<a href="#l10.101"></a><span id="l10.101">                          mode=&quot;mail,calendar&quot;</span>
<a href="#l10.102"></a><span id="l10.102">                          collapsedinmodes=&quot;mail,task&quot;</span>
<a href="#l10.103"></a><span id="l10.103" class="difflineminus">-                         broadcaster=&quot;modeBroadcaster&quot;</span>
<a href="#l10.104"></a><span id="l10.104">                          persist=&quot;height collapsedinmodes&quot;</span>
<a href="#l10.105"></a><span id="l10.105">                          ondragstart=&quot;nsDragAndDrop.startDrag(event, calendarTaskButtonDNDObserver);&quot;</span>
<a href="#l10.106"></a><span id="l10.106">                          ondragover=&quot;nsDragAndDrop.dragOver(event, calendarTaskButtonDNDObserver);&quot;</span>
<a href="#l10.107"></a><span id="l10.107" class="difflineminus">-                         ondrop=&quot;nsDragAndDrop.drop(event, calendarTaskButtonDNDObserver);&quot;/&gt;</span>
<a href="#l10.108"></a><span id="l10.108" class="difflineplus">+                         ondrop=&quot;nsDragAndDrop.drop(event, calendarTaskButtonDNDObserver);&quot;&gt;</span>
<a href="#l10.109"></a><span id="l10.109" class="difflineplus">+        &lt;!-- This second vbox means all of this is added to the DOM at once,</span>
<a href="#l10.110"></a><span id="l10.110" class="difflineplus">+             so the label's binding doesn't complain about not having a control. --&gt;</span>
<a href="#l10.111"></a><span id="l10.111" class="difflineplus">+        &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l10.112"></a><span id="l10.112" class="difflineplus">+          &lt;box id=&quot;show-completed-checkbox-box&quot; align=&quot;center&quot;&gt;</span>
<a href="#l10.113"></a><span id="l10.113" class="difflineplus">+            &lt;checkbox id=&quot;show-completed-checkbox&quot;</span>
<a href="#l10.114"></a><span id="l10.114" class="difflineplus">+                      label=&quot;&amp;calendar.unifinder.showcompletedtodos.label;&quot;</span>
<a href="#l10.115"></a><span id="l10.115" class="difflineplus">+                      flex=&quot;1&quot;</span>
<a href="#l10.116"></a><span id="l10.116" class="difflineplus">+                      crop=&quot;end&quot;</span>
<a href="#l10.117"></a><span id="l10.117" class="difflineplus">+                      oncommand=&quot;updateCalendarToDoUnifinder()&quot;</span>
<a href="#l10.118"></a><span id="l10.118" class="difflineplus">+                      persist=&quot;checked&quot;</span>
<a href="#l10.119"></a><span id="l10.119" class="difflineplus">+                      autocheck=&quot;false&quot;/&gt;</span>
<a href="#l10.120"></a><span id="l10.120" class="difflineplus">+          &lt;/box&gt;</span>
<a href="#l10.121"></a><span id="l10.121" class="difflineplus">+          &lt;vbox id=&quot;calendar-task-tree-detail&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l10.122"></a><span id="l10.122" class="difflineplus">+            &lt;tree is=&quot;calendar-task-tree-todaypane&quot; id=&quot;unifinder-todo-tree&quot;</span>
<a href="#l10.123"></a><span id="l10.123" class="difflineplus">+                  flex=&quot;1&quot;</span>
<a href="#l10.124"></a><span id="l10.124" class="difflineplus">+                  visible-columns=&quot;completed priority title&quot;</span>
<a href="#l10.125"></a><span id="l10.125" class="difflineplus">+                  persist=&quot;visible-columns ordinals widths sort-active sort-direction filterValue&quot;</span>
<a href="#l10.126"></a><span id="l10.126" class="difflineplus">+                  context=&quot;taskitem-context-menu&quot;/&gt;</span>
<a href="#l10.127"></a><span id="l10.127" class="difflineplus">+            &lt;html:input id=&quot;unifinder-task-edit-field&quot;</span>
<a href="#l10.128"></a><span id="l10.128" class="difflineplus">+                        class=&quot;task-edit-field themeableSearchBox&quot;</span>
<a href="#l10.129"></a><span id="l10.129" class="difflineplus">+                        onfocus=&quot;taskEdit.onFocus(event)&quot;</span>
<a href="#l10.130"></a><span id="l10.130" class="difflineplus">+                        onblur=&quot;taskEdit.onBlur(event)&quot;</span>
<a href="#l10.131"></a><span id="l10.131" class="difflineplus">+                        onkeypress=&quot;taskEdit.onKeyPress(event)&quot;/&gt;</span>
<a href="#l10.132"></a><span id="l10.132" class="difflineplus">+          &lt;/vbox&gt;</span>
<a href="#l10.133"></a><span id="l10.133" class="difflineplus">+        &lt;/vbox&gt;</span>
<a href="#l10.134"></a><span id="l10.134" class="difflineplus">+      &lt;/calendar-modevbox&gt;</span>
<a href="#l10.135"></a><span id="l10.135">     &lt;/vbox&gt;</span>
<a href="#l10.136"></a><span id="l10.136">   &lt;/calendar-modevbox&gt;</span>
<a href="#l10.137"></a><span id="l10.137"> </span>
<a href="#l10.138"></a><span id="l10.138">   &lt;commandset id=&quot;calendar_commands&quot;&gt;</span>
<a href="#l10.139"></a><span id="l10.139">     &lt;command id=&quot;calendar_toggle_todaypane_command&quot; oncommand=&quot;TodayPane.toggleVisibility(event)&quot;/&gt;</span>
<a href="#l10.140"></a><span id="l10.140">   &lt;/commandset&gt;</span>
<a href="#l10.141"></a><span id="l10.141"> &lt;/overlay&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/base/content/widgets/calendar-modebox.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/base/content/widgets/calendar-modebox.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -13,19 +13,17 @@</span>
<a href="#l11.4"></a><span id="l11.4">   /**</span>
<a href="#l11.5"></a><span id="l11.5">    * A calendar-modebox directly extends to a xul:box element with extra functionality. Like a</span>
<a href="#l11.6"></a><span id="l11.6">    * xul:hbox it has a horizontal orientation. It is designed to be displayed only:</span>
<a href="#l11.7"></a><span id="l11.7">    * 1) in given application modes (e.g &quot;task&quot; mode, &quot;calendar&quot; mode) and</span>
<a href="#l11.8"></a><span id="l11.8">    * 2) only in relation to the &quot;checked&quot; attribute of a control (e.g. a command or checkbox).</span>
<a href="#l11.9"></a><span id="l11.9">    *</span>
<a href="#l11.10"></a><span id="l11.10">    * - The attribute &quot;mode&quot; denotes a comma-separated list of all modes that the modebox should</span>
<a href="#l11.11"></a><span id="l11.11">    *   not be collapsed in, e.g. `mode=&quot;calendar,task&quot;`.</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-   * - The attribute &quot;broadcaster&quot; points to the id of a broadcaster that is supposed to be</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-   *   notified (by the application) as soon as the mode changes. When this happens the modebox</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineminus">-   *   will be notified and then either will or won't collapse itself.</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineplus">+   * - The attribute &quot;current&quot; denotes the current viewing mode.</span>
<a href="#l11.16"></a><span id="l11.16">    * - The attribute &quot;refcontrol&quot; points to a control, either a &quot;command&quot;, &quot;checkbox&quot; or other</span>
<a href="#l11.17"></a><span id="l11.17">    *   elements that support a &quot;checked&quot; attribute, that is often used to denote whether a</span>
<a href="#l11.18"></a><span id="l11.18">    *   modebox should be displayed or not. If &quot;refcontrol&quot; is set to the id of a command you</span>
<a href="#l11.19"></a><span id="l11.19">    *   can there set the oncommand attribute like:</span>
<a href="#l11.20"></a><span id="l11.20">    *   `oncommand='document.getElementById('my-mode-pane').togglePane(event)`.</span>
<a href="#l11.21"></a><span id="l11.21">    *   In case it is a checkbox element or derived checkbox element this is done automatically</span>
<a href="#l11.22"></a><span id="l11.22">    *   by listening to the event &quot;CheckboxChange&quot;. So if the current application mode is one of</span>
<a href="#l11.23"></a><span id="l11.23">    *   the modes listed in the &quot;mode&quot; attribute it is additionally verified whether the element</span>
<a href="#l11.24"></a><span id="l11.24" class="difflineat">@@ -33,54 +31,54 @@</span>
<a href="#l11.25"></a><span id="l11.25">    * - The attribute &quot;collapsedinmodes&quot; is a comma-separated list of the modes the modebox</span>
<a href="#l11.26"></a><span id="l11.26">    *   should be collapsed in (e.g. &quot;mail,calendar&quot;).  For example, if the user collapses a</span>
<a href="#l11.27"></a><span id="l11.27">    *   modebox when in a given mode, that mode would be added to &quot;collapsedinmodes&quot;. This</span>
<a href="#l11.28"></a><span id="l11.28">    *   attribute is made persistent across restarts.</span>
<a href="#l11.29"></a><span id="l11.29">    *</span>
<a href="#l11.30"></a><span id="l11.30">    * @extends {MozXULElement}</span>
<a href="#l11.31"></a><span id="l11.31">    */</span>
<a href="#l11.32"></a><span id="l11.32">   class CalendarModebox extends MozXULElement {</span>
<a href="#l11.33"></a><span id="l11.33" class="difflineplus">+    static get observedAttributes() {</span>
<a href="#l11.34"></a><span id="l11.34" class="difflineplus">+      return [&quot;current&quot;];</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineplus">+    }</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineplus">+</span>
<a href="#l11.37"></a><span id="l11.37">     connectedCallback() {</span>
<a href="#l11.38"></a><span id="l11.38">       if (this.delayConnectedCallback()) {</span>
<a href="#l11.39"></a><span id="l11.39">         return;</span>
<a href="#l11.40"></a><span id="l11.40">       }</span>
<a href="#l11.41"></a><span id="l11.41"> </span>
<a href="#l11.42"></a><span id="l11.42" class="difflineminus">-      this.mBroadcaster = null;</span>
<a href="#l11.43"></a><span id="l11.43">       this.mRefControl = null;</span>
<a href="#l11.44"></a><span id="l11.44"> </span>
<a href="#l11.45"></a><span id="l11.45" class="difflineminus">-      if (this.hasAttribute(&quot;broadcaster&quot;)) {</span>
<a href="#l11.46"></a><span id="l11.46" class="difflineminus">-        // This sets up an event listener for the broadcaster.</span>
<a href="#l11.47"></a><span id="l11.47" class="difflineminus">-        this.setAttribute(&quot;broadcaster&quot;, this.getAttribute(&quot;broadcaster&quot;));</span>
<a href="#l11.48"></a><span id="l11.48" class="difflineminus">-      }</span>
<a href="#l11.49"></a><span id="l11.49" class="difflineminus">-</span>
<a href="#l11.50"></a><span id="l11.50">       if (this.hasAttribute(&quot;refcontrol&quot;)) {</span>
<a href="#l11.51"></a><span id="l11.51">         this.mRefControl = document.getElementById(this.getAttribute(&quot;refcontrol&quot;));</span>
<a href="#l11.52"></a><span id="l11.52">         if (this.mRefControl &amp;&amp; this.mRefControl.localName == &quot;checkbox&quot;) {</span>
<a href="#l11.53"></a><span id="l11.53">           this.mRefControl.addEventListener(&quot;CheckboxStateChange&quot;, this, true);</span>
<a href="#l11.54"></a><span id="l11.54">         }</span>
<a href="#l11.55"></a><span id="l11.55">       }</span>
<a href="#l11.56"></a><span id="l11.56">     }</span>
<a href="#l11.57"></a><span id="l11.57"> </span>
<a href="#l11.58"></a><span id="l11.58" class="difflineplus">+    attributeChangedCallback(name, oldValue, newValue) {</span>
<a href="#l11.59"></a><span id="l11.59" class="difflineplus">+      if (name == &quot;current&quot; &amp;&amp; oldValue != newValue) {</span>
<a href="#l11.60"></a><span id="l11.60" class="difflineplus">+        let display = this.isVisibleInMode(newValue);</span>
<a href="#l11.61"></a><span id="l11.61" class="difflineplus">+        this.setVisible(display, false, true);</span>
<a href="#l11.62"></a><span id="l11.62" class="difflineplus">+      }</span>
<a href="#l11.63"></a><span id="l11.63" class="difflineplus">+    }</span>
<a href="#l11.64"></a><span id="l11.64" class="difflineplus">+</span>
<a href="#l11.65"></a><span id="l11.65">     get currentMode() {</span>
<a href="#l11.66"></a><span id="l11.66" class="difflineminus">-      if (this.mBroadcaster &amp;&amp; this.mBroadcaster.hasAttribute(&quot;mode&quot;)) {</span>
<a href="#l11.67"></a><span id="l11.67" class="difflineminus">-        return this.mBroadcaster.getAttribute(&quot;mode&quot;);</span>
<a href="#l11.68"></a><span id="l11.68" class="difflineminus">-      }</span>
<a href="#l11.69"></a><span id="l11.69" class="difflineminus">-      return &quot;&quot;;</span>
<a href="#l11.70"></a><span id="l11.70" class="difflineplus">+      return this.getAttribute(&quot;current&quot;);</span>
<a href="#l11.71"></a><span id="l11.71">     }</span>
<a href="#l11.72"></a><span id="l11.72"> </span>
<a href="#l11.73"></a><span id="l11.73">     /**</span>
<a href="#l11.74"></a><span id="l11.74">      * The event handler for various events relevant to CalendarModebox.</span>
<a href="#l11.75"></a><span id="l11.75">      *</span>
<a href="#l11.76"></a><span id="l11.76">      * @param {Event} event  The event.</span>
<a href="#l11.77"></a><span id="l11.77">      */</span>
<a href="#l11.78"></a><span id="l11.78">     handleEvent(event) {</span>
<a href="#l11.79"></a><span id="l11.79">       if (event.type == &quot;CheckboxStateChange&quot;) {</span>
<a href="#l11.80"></a><span id="l11.80">         this.onCheckboxStateChange(event);</span>
<a href="#l11.81"></a><span id="l11.81" class="difflineminus">-      } else if (event.type == &quot;DOMAttrModified&quot;) {</span>
<a href="#l11.82"></a><span id="l11.82" class="difflineminus">-        this.onModeModified(event);</span>
<a href="#l11.83"></a><span id="l11.83">       }</span>
<a href="#l11.84"></a><span id="l11.84">     }</span>
<a href="#l11.85"></a><span id="l11.85"> </span>
<a href="#l11.86"></a><span id="l11.86">     /**</span>
<a href="#l11.87"></a><span id="l11.87">      * A &quot;mode attribute&quot; contains comma-separated lists of values, for example:</span>
<a href="#l11.88"></a><span id="l11.88">      * `modewidths=&quot;200,200,200&quot;`. Each of these values corresponds to one of the modes in</span>
<a href="#l11.89"></a><span id="l11.89">      * the &quot;mode&quot; attribute: `mode=&quot;mail,calendar,task&quot;`. This function sets a new value for</span>
<a href="#l11.90"></a><span id="l11.90">      * a given mode in a given &quot;mode attribute&quot;.</span>
<a href="#l11.91"></a><span id="l11.91" class="difflineat">@@ -202,28 +200,16 @@</span>
<a href="#l11.92"></a><span id="l11.92">       return this.hasAttribute(&quot;mode&quot;)</span>
<a href="#l11.93"></a><span id="l11.93">         ? this.getAttribute(&quot;mode&quot;)</span>
<a href="#l11.94"></a><span id="l11.94">             .split(&quot;,&quot;)</span>
<a href="#l11.95"></a><span id="l11.95">             .includes(mode)</span>
<a href="#l11.96"></a><span id="l11.96">         : true;</span>
<a href="#l11.97"></a><span id="l11.97">     }</span>
<a href="#l11.98"></a><span id="l11.98"> </span>
<a href="#l11.99"></a><span id="l11.99">     /**</span>
<a href="#l11.100"></a><span id="l11.100" class="difflineminus">-     * Handles changes to the current mode by making the modebox visible or not.</span>
<a href="#l11.101"></a><span id="l11.101" class="difflineminus">-     *</span>
<a href="#l11.102"></a><span id="l11.102" class="difflineminus">-     * @param {Event} event  An event, e.g. &quot;DOMAttributeModified&quot;.</span>
<a href="#l11.103"></a><span id="l11.103" class="difflineminus">-     */</span>
<a href="#l11.104"></a><span id="l11.104" class="difflineminus">-    onModeModified(event) {</span>
<a href="#l11.105"></a><span id="l11.105" class="difflineminus">-      if (event.attrName == &quot;mode&quot;) {</span>
<a href="#l11.106"></a><span id="l11.106" class="difflineminus">-        let display = this.isVisibleInMode(event.newValue);</span>
<a href="#l11.107"></a><span id="l11.107" class="difflineminus">-        this.setVisible(display, false, true);</span>
<a href="#l11.108"></a><span id="l11.108" class="difflineminus">-      }</span>
<a href="#l11.109"></a><span id="l11.109" class="difflineminus">-    }</span>
<a href="#l11.110"></a><span id="l11.110" class="difflineminus">-</span>
<a href="#l11.111"></a><span id="l11.111" class="difflineminus">-    /**</span>
<a href="#l11.112"></a><span id="l11.112">      * Used to toggle the checked state of a command connected to this modebox, and set the</span>
<a href="#l11.113"></a><span id="l11.113">      * visibility of this modebox accordingly.</span>
<a href="#l11.114"></a><span id="l11.114">      *</span>
<a href="#l11.115"></a><span id="l11.115">      * @param {Event} event  An event with a command (with a checked attribute) as its target.</span>
<a href="#l11.116"></a><span id="l11.116">      */</span>
<a href="#l11.117"></a><span id="l11.117">     togglePane(event) {</span>
<a href="#l11.118"></a><span id="l11.118">       let command = event.target;</span>
<a href="#l11.119"></a><span id="l11.119">       let newValue = command.getAttribute(&quot;checked&quot;) == &quot;true&quot; ? &quot;false&quot; : &quot;true&quot;;</span>
<a href="#l11.120"></a><span id="l11.120" class="difflineat">@@ -235,47 +221,16 @@</span>
<a href="#l11.121"></a><span id="l11.121">      * Handles a change in a checkbox state, by making this modebox visible or not.</span>
<a href="#l11.122"></a><span id="l11.122">      *</span>
<a href="#l11.123"></a><span id="l11.123">      * @param {Event} event  An event with a target that has a `checked` attribute.</span>
<a href="#l11.124"></a><span id="l11.124">      */</span>
<a href="#l11.125"></a><span id="l11.125">     onCheckboxStateChange(event) {</span>
<a href="#l11.126"></a><span id="l11.126">       let newValue = event.target.checked;</span>
<a href="#l11.127"></a><span id="l11.127">       this.setVisible(newValue, true, true);</span>
<a href="#l11.128"></a><span id="l11.128">     }</span>
<a href="#l11.129"></a><span id="l11.129" class="difflineminus">-</span>
<a href="#l11.130"></a><span id="l11.130" class="difflineminus">-    /**</span>
<a href="#l11.131"></a><span id="l11.131" class="difflineminus">-     * Set an attribute to a value. If the attribute is &quot;broadcaster&quot; then also set up an</span>
<a href="#l11.132"></a><span id="l11.132" class="difflineminus">-     * event listener for the new broadcaster and remove any existing event listener from</span>
<a href="#l11.133"></a><span id="l11.133" class="difflineminus">-     * the previous broadcaster.</span>
<a href="#l11.134"></a><span id="l11.134" class="difflineminus">-     *</span>
<a href="#l11.135"></a><span id="l11.135" class="difflineminus">-     * @param {string} attr  The attribute to set.</span>
<a href="#l11.136"></a><span id="l11.136" class="difflineminus">-     * @param {string} val  The value to set.</span>
<a href="#l11.137"></a><span id="l11.137" class="difflineminus">-     */</span>
<a href="#l11.138"></a><span id="l11.138" class="difflineminus">-    setAttribute(attr, val) {</span>
<a href="#l11.139"></a><span id="l11.139" class="difflineminus">-      if (attr == &quot;broadcaster&quot;) {</span>
<a href="#l11.140"></a><span id="l11.140" class="difflineminus">-        const newBroadcaster = document.getElementById(val);</span>
<a href="#l11.141"></a><span id="l11.141" class="difflineminus">-        if (newBroadcaster) {</span>
<a href="#l11.142"></a><span id="l11.142" class="difflineminus">-          if (this.mBroadcaster) {</span>
<a href="#l11.143"></a><span id="l11.143" class="difflineminus">-            this.mBroadcaster.removeEventListener(&quot;DOMAttrModified&quot;, this, true);</span>
<a href="#l11.144"></a><span id="l11.144" class="difflineminus">-          }</span>
<a href="#l11.145"></a><span id="l11.145" class="difflineminus">-          this.mBroadcaster = newBroadcaster;</span>
<a href="#l11.146"></a><span id="l11.146" class="difflineminus">-          this.mBroadcaster.addEventListener(&quot;DOMAttrModified&quot;, this, true);</span>
<a href="#l11.147"></a><span id="l11.147" class="difflineminus">-        }</span>
<a href="#l11.148"></a><span id="l11.148" class="difflineminus">-      }</span>
<a href="#l11.149"></a><span id="l11.149" class="difflineminus">-      return super.setAttribute(attr, val);</span>
<a href="#l11.150"></a><span id="l11.150" class="difflineminus">-    }</span>
<a href="#l11.151"></a><span id="l11.151" class="difflineminus">-</span>
<a href="#l11.152"></a><span id="l11.152" class="difflineminus">-    disconnectedCallback() {</span>
<a href="#l11.153"></a><span id="l11.153" class="difflineminus">-      if (this.mBroadcaster) {</span>
<a href="#l11.154"></a><span id="l11.154" class="difflineminus">-        this.mBroadcaster.removeEventListener(&quot;DOMAttrModified&quot;, this, true);</span>
<a href="#l11.155"></a><span id="l11.155" class="difflineminus">-      }</span>
<a href="#l11.156"></a><span id="l11.156" class="difflineminus">-      if (this.mRefControl) {</span>
<a href="#l11.157"></a><span id="l11.157" class="difflineminus">-        this.mRefControl.removeEventListener(&quot;CheckboxStateChange&quot;, this, true);</span>
<a href="#l11.158"></a><span id="l11.158" class="difflineminus">-      }</span>
<a href="#l11.159"></a><span id="l11.159" class="difflineminus">-    }</span>
<a href="#l11.160"></a><span id="l11.160">   }</span>
<a href="#l11.161"></a><span id="l11.161"> </span>
<a href="#l11.162"></a><span id="l11.162">   customElements.define(&quot;calendar-modebox&quot;, CalendarModebox);</span>
<a href="#l11.163"></a><span id="l11.163"> </span>
<a href="#l11.164"></a><span id="l11.164">   /**</span>
<a href="#l11.165"></a><span id="l11.165">    * A `calendar-modebox` but with a vertical orientation like a `vbox`. (Different Custom</span>
<a href="#l11.166"></a><span id="l11.166">    * Elements cannot be defined using the same class, thus we need this subclass.)</span>
<a href="#l11.167"></a><span id="l11.167">    *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/base/jar.mn</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/base/jar.mn</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -33,17 +33,16 @@ calendar.jar:</span>
<a href="#l12.4"></a><span id="l12.4">     content/calendar-task-editing.js                            (content/calendar-task-editing.js)</span>
<a href="#l12.5"></a><span id="l12.5">     content/calendar-task-tree-utils.js                         (content/calendar-task-tree-utils.js)</span>
<a href="#l12.6"></a><span id="l12.6">     content/calendar-task-tree-view.js                          (content/calendar-task-tree-view.js)</span>
<a href="#l12.7"></a><span id="l12.7">     content/calendar-task-tree.js                               (content/calendar-task-tree.js)</span>
<a href="#l12.8"></a><span id="l12.8">     content/calendar-task-view.js                               (content/calendar-task-view.js)</span>
<a href="#l12.9"></a><span id="l12.9">     content/calendar-task-view.xul                              (content/calendar-task-view.xul)</span>
<a href="#l12.10"></a><span id="l12.10">     content/calendar-ui-utils.js                                (content/calendar-ui-utils.js)</span>
<a href="#l12.11"></a><span id="l12.11">     content/calendar-unifinder-todo.js                          (content/calendar-unifinder-todo.js)</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-    content/calendar-unifinder-todo.xul                         (content/calendar-unifinder-todo.xul)</span>
<a href="#l12.13"></a><span id="l12.13">     content/calendar-unifinder.js                               (content/calendar-unifinder.js)</span>
<a href="#l12.14"></a><span id="l12.14">     content/calendar-unifinder.xul                              (content/calendar-unifinder.xul)</span>
<a href="#l12.15"></a><span id="l12.15">     content/calendar-views-utils.js                             (content/calendar-views-utils.js)</span>
<a href="#l12.16"></a><span id="l12.16">     content/calendar-views.js                                   (content/calendar-views.js)</span>
<a href="#l12.17"></a><span id="l12.17">     content/calendar-editable-item.js                           (content/calendar-editable-item.js)</span>
<a href="#l12.18"></a><span id="l12.18">     content/calendar-views.xul                                  (content/calendar-views.xul)</span>
<a href="#l12.19"></a><span id="l12.19">     content/calendar-alarm-dialog.js                            (content/dialogs/calendar-alarm-dialog.js)</span>
<a href="#l12.20"></a><span id="l12.20">     content/calendar-alarm-dialog.xul                           (content/dialogs/calendar-alarm-dialog.xul)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/lightning/content/lightning-menus.xul</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-menus.xul</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -344,32 +344,28 @@</span>
<a href="#l13.4"></a><span id="l13.4">                   command=&quot;calendar_new_todo_command&quot;</span>
<a href="#l13.5"></a><span id="l13.5">                   observes=&quot;calendar_new_todo_command&quot;/&gt;</span>
<a href="#l13.6"></a><span id="l13.6">         &lt;menuseparator id=&quot;before-Calendar-Mode-Section&quot;/&gt;</span>
<a href="#l13.7"></a><span id="l13.7">         &lt;menuitem id=&quot;ltnMenuSwitchToCalendar&quot;</span>
<a href="#l13.8"></a><span id="l13.8">                   type=&quot;checkbox&quot;</span>
<a href="#l13.9"></a><span id="l13.9">                   label=&quot;&amp;lightning.toolbar.calendar.label;&quot;</span>
<a href="#l13.10"></a><span id="l13.10">                   accesskey=&quot;&amp;lightning.toolbar.calendar.accesskey;&quot;</span>
<a href="#l13.11"></a><span id="l13.11">                   command=&quot;switch2calendar&quot;</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineplus">+                  value=&quot;calendar&quot;</span>
<a href="#l13.13"></a><span id="l13.13">                   key=&quot;openLightningKey&quot;</span>
<a href="#l13.14"></a><span id="l13.14">                   autocheck=&quot;false&quot;&gt;</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineminus">-          &lt;observes element=&quot;modeBroadcaster&quot;</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineminus">-                    attribute=&quot;mode&quot;</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineminus">-                    onbroadcast=&quot;this.parentNode.setAttribute('checked', '' + document.getElementById('modeBroadcaster').getAttribute('mode') == 'calendar')&quot;/&gt;</span>
<a href="#l13.18"></a><span id="l13.18">         &lt;/menuitem&gt;</span>
<a href="#l13.19"></a><span id="l13.19">         &lt;menuitem id=&quot;ltnMenuSwitchToTask&quot;</span>
<a href="#l13.20"></a><span id="l13.20">                   type=&quot;checkbox&quot;</span>
<a href="#l13.21"></a><span id="l13.21">                   label=&quot;&amp;lightning.toolbar.task.label;&quot;</span>
<a href="#l13.22"></a><span id="l13.22">                   accesskey=&quot;&amp;lightning.toolbar.task.accesskey;&quot;</span>
<a href="#l13.23"></a><span id="l13.23">                   command=&quot;switch2task&quot;</span>
<a href="#l13.24"></a><span id="l13.24" class="difflineplus">+                  value=&quot;task&quot;</span>
<a href="#l13.25"></a><span id="l13.25">                   key=&quot;openTasksKey&quot;</span>
<a href="#l13.26"></a><span id="l13.26">                   autocheck=&quot;false&quot;&gt;</span>
<a href="#l13.27"></a><span id="l13.27" class="difflineminus">-          &lt;observes element=&quot;modeBroadcaster&quot;</span>
<a href="#l13.28"></a><span id="l13.28" class="difflineminus">-                    attribute=&quot;mode&quot;</span>
<a href="#l13.29"></a><span id="l13.29" class="difflineminus">-                    onbroadcast=&quot;this.parentNode.setAttribute('checked', '' + document.getElementById('modeBroadcaster').getAttribute('mode') == 'task')&quot;/&gt;</span>
<a href="#l13.30"></a><span id="l13.30">         &lt;/menuitem&gt;</span>
<a href="#l13.31"></a><span id="l13.31">         &lt;menuseparator id=&quot;ltnBeforeCalendarSection&quot;/&gt;</span>
<a href="#l13.32"></a><span id="l13.32">         &lt;menuitem id=&quot;ltnExportCalendar&quot;</span>
<a href="#l13.33"></a><span id="l13.33">                   label=&quot;&amp;calendar.export.label;&quot;</span>
<a href="#l13.34"></a><span id="l13.34">                   accesskey=&quot;&amp;calendar.export.accesskey;&quot;</span>
<a href="#l13.35"></a><span id="l13.35">                   command=&quot;calendar_export_command&quot;</span>
<a href="#l13.36"></a><span id="l13.36">                   observes=&quot;calendar_export_command&quot;/&gt;</span>
<a href="#l13.37"></a><span id="l13.37">         &lt;menuitem id=&quot;ltnImportCalendar&quot;</span>
<a href="#l13.38"></a><span id="l13.38" class="difflineat">@@ -606,30 +602,26 @@</span>
<a href="#l13.39"></a><span id="l13.39">     &lt;panelview id=&quot;appmenu_Event_Task_View&quot;</span>
<a href="#l13.40"></a><span id="l13.40">                class=&quot;PanelUI-subView&quot;&gt;</span>
<a href="#l13.41"></a><span id="l13.41">       &lt;vbox class=&quot;panel-subview-body&quot;&gt;</span>
<a href="#l13.42"></a><span id="l13.42">         &lt;toolbarbutton id=&quot;appmenu_ltnMenuSwitchToCalendar&quot;</span>
<a href="#l13.43"></a><span id="l13.43">                        class=&quot;subviewbutton subviewbutton-iconic&quot;</span>
<a href="#l13.44"></a><span id="l13.44">                        type=&quot;checkbox&quot;</span>
<a href="#l13.45"></a><span id="l13.45">                        label=&quot;&amp;lightning.toolbar.calendar.label;&quot;</span>
<a href="#l13.46"></a><span id="l13.46">                        command=&quot;switch2calendar&quot;</span>
<a href="#l13.47"></a><span id="l13.47" class="difflineplus">+                       value=&quot;calendar&quot;</span>
<a href="#l13.48"></a><span id="l13.48">                        autocheck=&quot;false&quot;&gt;</span>
<a href="#l13.49"></a><span id="l13.49" class="difflineminus">-          &lt;observes element=&quot;modeBroadcaster&quot;</span>
<a href="#l13.50"></a><span id="l13.50" class="difflineminus">-                    attribute=&quot;mode&quot;</span>
<a href="#l13.51"></a><span id="l13.51" class="difflineminus">-                    onbroadcast=&quot;this.parentNode.setAttribute('checked', '' + document.getElementById('modeBroadcaster').getAttribute('mode') == 'calendar')&quot;/&gt;</span>
<a href="#l13.52"></a><span id="l13.52">         &lt;/toolbarbutton&gt;</span>
<a href="#l13.53"></a><span id="l13.53">         &lt;toolbarbutton id=&quot;appmenu_ltnMenuSwitchToTask&quot;</span>
<a href="#l13.54"></a><span id="l13.54">                        class=&quot;subviewbutton subviewbutton-iconic&quot;</span>
<a href="#l13.55"></a><span id="l13.55">                        type=&quot;checkbox&quot;</span>
<a href="#l13.56"></a><span id="l13.56">                        label=&quot;&amp;lightning.toolbar.task.label;&quot;</span>
<a href="#l13.57"></a><span id="l13.57">                        command=&quot;switch2task&quot;</span>
<a href="#l13.58"></a><span id="l13.58" class="difflineplus">+                       value=&quot;task&quot;</span>
<a href="#l13.59"></a><span id="l13.59">                        autocheck=&quot;false&quot;&gt;</span>
<a href="#l13.60"></a><span id="l13.60" class="difflineminus">-          &lt;observes element=&quot;modeBroadcaster&quot;</span>
<a href="#l13.61"></a><span id="l13.61" class="difflineminus">-                    attribute=&quot;mode&quot;</span>
<a href="#l13.62"></a><span id="l13.62" class="difflineminus">-                    onbroadcast=&quot;this.parentNode.setAttribute('checked', '' + document.getElementById('modeBroadcaster').getAttribute('mode') == 'task')&quot;/&gt;</span>
<a href="#l13.63"></a><span id="l13.63">         &lt;/toolbarbutton&gt;</span>
<a href="#l13.64"></a><span id="l13.64">         &lt;toolbarseparator id=&quot;appmenu_ltnBeforeCalendarSection&quot;/&gt;</span>
<a href="#l13.65"></a><span id="l13.65">         &lt;toolbarbutton id=&quot;appmenu_ltnExportCalendar&quot;</span>
<a href="#l13.66"></a><span id="l13.66">                        class=&quot;subviewbutton subviewbutton-iconic&quot;</span>
<a href="#l13.67"></a><span id="l13.67">                        label=&quot;&amp;calendar.export.label;&quot;</span>
<a href="#l13.68"></a><span id="l13.68">                        command=&quot;calendar_export_command&quot;</span>
<a href="#l13.69"></a><span id="l13.69">                        observes=&quot;calendar_export_command&quot;/&gt;</span>
<a href="#l13.70"></a><span id="l13.70">         &lt;toolbarbutton id=&quot;appmenu_ltnImportCalendar&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/lightning/content/messenger-overlay-sidebar.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/lightning/content/messenger-overlay-sidebar.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -1,16 +1,16 @@</span>
<a href="#l14.4"></a><span id="l14.4"> /* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l14.5"></a><span id="l14.5">  * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l14.6"></a><span id="l14.6">  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l14.7"></a><span id="l14.7"> </span>
<a href="#l14.8"></a><span id="l14.8"> /* exported refreshUIBits, switchCalendarView, rescheduleInvitationsUpdate,</span>
<a href="#l14.9"></a><span id="l14.9">  *          openInvitationsDialog, onToolbarsPopupShowingWithMode,</span>
<a href="#l14.10"></a><span id="l14.10">  *          InitViewCalendarPaneMenu, onToolbarsPopupShowingForTabType,</span>
<a href="#l14.11"></a><span id="l14.11" class="difflineminus">- *          customizeMailToolbarForTabType</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineplus">+ *          customizeMailToolbarForTabType, gCurrentMode</span>
<a href="#l14.13"></a><span id="l14.13">  */</span>
<a href="#l14.14"></a><span id="l14.14"> </span>
<a href="#l14.15"></a><span id="l14.15"> /* import-globals-from ../../base/content/calendar-common-sets.js */</span>
<a href="#l14.16"></a><span id="l14.16"> /* import-globals-from ../../base/content/calendar-invitations-manager.js */</span>
<a href="#l14.17"></a><span id="l14.17"> /* import-globals-from ../../base/content/today-pane.js */</span>
<a href="#l14.18"></a><span id="l14.18"> /* import-globals-from lightning-item-panel.js */</span>
<a href="#l14.19"></a><span id="l14.19"> </span>
<a href="#l14.20"></a><span id="l14.20"> var { Services } = ChromeUtils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l14.21"></a><span id="l14.21" class="difflineat">@@ -394,18 +394,17 @@ async function ltnOnLoad(event) {</span>
<a href="#l14.22"></a><span id="l14.22">   window.addEventListener(&quot;unload&quot;, ltnFinish);</span>
<a href="#l14.23"></a><span id="l14.23"> </span>
<a href="#l14.24"></a><span id="l14.24">   // Set up invitations manager</span>
<a href="#l14.25"></a><span id="l14.25">   scheduleInvitationsUpdate(FIRST_DELAY_STARTUP);</span>
<a href="#l14.26"></a><span id="l14.26">   cal.getCalendarManager().addObserver(gInvitationsCalendarManagerObserver);</span>
<a href="#l14.27"></a><span id="l14.27"> </span>
<a href="#l14.28"></a><span id="l14.28">   let filter = document.getElementById(&quot;task-tree-filtergroup&quot;);</span>
<a href="#l14.29"></a><span id="l14.29">   filter.value = filter.value || &quot;all&quot;;</span>
<a href="#l14.30"></a><span id="l14.30" class="difflineminus">-  document.getElementById(&quot;modeBroadcaster&quot;).setAttribute(&quot;mode&quot;, gCurrentMode);</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineminus">-  document.getElementById(&quot;modeBroadcaster&quot;).setAttribute(&quot;checked&quot;, &quot;true&quot;);</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+  changeMode();</span>
<a href="#l14.33"></a><span id="l14.33"> </span>
<a href="#l14.34"></a><span id="l14.34">   let mailContextPopup = document.getElementById(&quot;mailContext&quot;);</span>
<a href="#l14.35"></a><span id="l14.35">   if (mailContextPopup) {</span>
<a href="#l14.36"></a><span id="l14.36">     mailContextPopup.addEventListener(&quot;popupshowing&quot;, gCalSetupMailContext.popup);</span>
<a href="#l14.37"></a><span id="l14.37">   }</span>
<a href="#l14.38"></a><span id="l14.38"> </span>
<a href="#l14.39"></a><span id="l14.39">   // Setup customizeDone handlers for our toolbars</span>
<a href="#l14.40"></a><span id="l14.40">   let toolbox = document.getElementById(&quot;calendar-toolbox&quot;);</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineat">@@ -626,46 +625,68 @@ function openInvitationsDialog() {</span>
<a href="#l14.42"></a><span id="l14.42">   getInvitationsManager().cancelInvitationsUpdate();</span>
<a href="#l14.43"></a><span id="l14.43">   gInvitationsOperationListener.mCount = 0;</span>
<a href="#l14.44"></a><span id="l14.44">   getInvitationsManager().openInvitationsDialog(gInvitationsOperationListener, () =&gt;</span>
<a href="#l14.45"></a><span id="l14.45">     scheduleInvitationsUpdate(FIRST_DELAY_RESCHEDULE)</span>
<a href="#l14.46"></a><span id="l14.46">   );</span>
<a href="#l14.47"></a><span id="l14.47"> }</span>
<a href="#l14.48"></a><span id="l14.48"> </span>
<a href="#l14.49"></a><span id="l14.49"> /**</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineminus">- * the current mode is set to a string defining the current</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineminus">- * mode we're in. allowed values are:</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineplus">+ * The current mode defining the current mode we're in. Allowed values are:</span>
<a href="#l14.53"></a><span id="l14.53">  *  - 'mail'</span>
<a href="#l14.54"></a><span id="l14.54">  *  - 'calendar'</span>
<a href="#l14.55"></a><span id="l14.55">  *  - 'task'</span>
<a href="#l14.56"></a><span id="l14.56" class="difflineplus">+ * @global</span>
<a href="#l14.57"></a><span id="l14.57">  */</span>
<a href="#l14.58"></a><span id="l14.58"> var gCurrentMode = &quot;mail&quot;;</span>
<a href="#l14.59"></a><span id="l14.59"> </span>
<a href="#l14.60"></a><span id="l14.60"> /**</span>
<a href="#l14.61"></a><span id="l14.61" class="difflineminus">- * ltnSwitch2Mail() switches to the mail mode</span>
<a href="#l14.62"></a><span id="l14.62" class="difflineplus">+ * Changes the mode (gCurrentMode) and adapts the UI to the new mode.</span>
<a href="#l14.63"></a><span id="l14.63" class="difflineplus">+ * @param {string} [mode=&quot;mail&quot;] - the new mode: one of 'mail', 'calendar' or 'task'</span>
<a href="#l14.64"></a><span id="l14.64">  */</span>
<a href="#l14.65"></a><span id="l14.65" class="difflineplus">+function changeMode(mode = &quot;mail&quot;) {</span>
<a href="#l14.66"></a><span id="l14.66" class="difflineplus">+  gCurrentMode = mode; // eslint-disable-line no-global-assign</span>
<a href="#l14.67"></a><span id="l14.67"> </span>
<a href="#l14.68"></a><span id="l14.68" class="difflineplus">+  document</span>
<a href="#l14.69"></a><span id="l14.69" class="difflineplus">+    .querySelectorAll(</span>
<a href="#l14.70"></a><span id="l14.70" class="difflineplus">+      `menuitem[command=&quot;switch2calendar&quot;],menuitem[command=&quot;switch2task&quot;],</span>
<a href="#l14.71"></a><span id="l14.71" class="difflineplus">+       toolbarbutton[command=&quot;switch2calendar&quot;],toolbarbutton[command=&quot;switch2task&quot;]`</span>
<a href="#l14.72"></a><span id="l14.72" class="difflineplus">+    )</span>
<a href="#l14.73"></a><span id="l14.73" class="difflineplus">+    .forEach(elem =&gt; {</span>
<a href="#l14.74"></a><span id="l14.74" class="difflineplus">+      elem.setAttribute(&quot;checked&quot;, elem.getAttribute(&quot;value&quot;) == gCurrentMode);</span>
<a href="#l14.75"></a><span id="l14.75" class="difflineplus">+    });</span>
<a href="#l14.76"></a><span id="l14.76" class="difflineplus">+</span>
<a href="#l14.77"></a><span id="l14.77" class="difflineplus">+  document.querySelectorAll(&quot;calendar-modebox,calendar-modevbox&quot;).forEach(elem =&gt; {</span>
<a href="#l14.78"></a><span id="l14.78" class="difflineplus">+    elem.setAttribute(&quot;current&quot;, gCurrentMode);</span>
<a href="#l14.79"></a><span id="l14.79" class="difflineplus">+  });</span>
<a href="#l14.80"></a><span id="l14.80" class="difflineplus">+</span>
<a href="#l14.81"></a><span id="l14.81" class="difflineplus">+  TodayPane.onModeModified();</span>
<a href="#l14.82"></a><span id="l14.82" class="difflineplus">+  if (gCurrentMode != &quot;calendar&quot;) {</span>
<a href="#l14.83"></a><span id="l14.83" class="difflineplus">+    timeIndicator.cancel();</span>
<a href="#l14.84"></a><span id="l14.84" class="difflineplus">+  }</span>
<a href="#l14.85"></a><span id="l14.85" class="difflineplus">+}</span>
<a href="#l14.86"></a><span id="l14.86" class="difflineplus">+</span>
<a href="#l14.87"></a><span id="l14.87" class="difflineplus">+/**</span>
<a href="#l14.88"></a><span id="l14.88" class="difflineplus">+ * Switches to the mail mode.</span>
<a href="#l14.89"></a><span id="l14.89" class="difflineplus">+ */</span>
<a href="#l14.90"></a><span id="l14.90"> function ltnSwitch2Mail() {</span>
<a href="#l14.91"></a><span id="l14.91">   if (gCurrentMode != &quot;mail&quot;) {</span>
<a href="#l14.92"></a><span id="l14.92" class="difflineminus">-    gCurrentMode = &quot;mail&quot;;</span>
<a href="#l14.93"></a><span id="l14.93" class="difflineminus">-    document.getElementById(&quot;modeBroadcaster&quot;).setAttribute(&quot;mode&quot;, gCurrentMode);</span>
<a href="#l14.94"></a><span id="l14.94" class="difflineplus">+    changeMode(&quot;mail&quot;);</span>
<a href="#l14.95"></a><span id="l14.95"> </span>
<a href="#l14.96"></a><span id="l14.96">     document.commandDispatcher.updateCommands(&quot;calendar_commands&quot;);</span>
<a href="#l14.97"></a><span id="l14.97">     window.setCursor(&quot;auto&quot;);</span>
<a href="#l14.98"></a><span id="l14.98">   }</span>
<a href="#l14.99"></a><span id="l14.99"> }</span>
<a href="#l14.100"></a><span id="l14.100"> </span>
<a href="#l14.101"></a><span id="l14.101"> /**</span>
<a href="#l14.102"></a><span id="l14.102" class="difflineminus">- * ltnSwitch2Calendar() switches to the calendar mode</span>
<a href="#l14.103"></a><span id="l14.103" class="difflineplus">+ * Switches to the calendar mode.</span>
<a href="#l14.104"></a><span id="l14.104">  */</span>
<a href="#l14.105"></a><span id="l14.105" class="difflineminus">-</span>
<a href="#l14.106"></a><span id="l14.106"> function ltnSwitch2Calendar() {</span>
<a href="#l14.107"></a><span id="l14.107">   if (gCurrentMode != &quot;calendar&quot;) {</span>
<a href="#l14.108"></a><span id="l14.108" class="difflineminus">-    gCurrentMode = &quot;calendar&quot;;</span>
<a href="#l14.109"></a><span id="l14.109" class="difflineminus">-    document.getElementById(&quot;modeBroadcaster&quot;).setAttribute(&quot;mode&quot;, gCurrentMode);</span>
<a href="#l14.110"></a><span id="l14.110" class="difflineplus">+    changeMode(&quot;calendar&quot;);</span>
<a href="#l14.111"></a><span id="l14.111"> </span>
<a href="#l14.112"></a><span id="l14.112">     // display the calendar panel on the display deck</span>
<a href="#l14.113"></a><span id="l14.113">     let deck = document.getElementById(&quot;calendarDisplayDeck&quot;);</span>
<a href="#l14.114"></a><span id="l14.114">     deck.selectedPanel = document.getElementById(&quot;calendar-view-box&quot;);</span>
<a href="#l14.115"></a><span id="l14.115"> </span>
<a href="#l14.116"></a><span id="l14.116">     // show the last displayed type of calendar view</span>
<a href="#l14.117"></a><span id="l14.117">     switchToView(gLastShownCalendarView);</span>
<a href="#l14.118"></a><span id="l14.118">     document.getElementById(&quot;calMinimonth&quot;).setAttribute(&quot;freebusy&quot;, &quot;true&quot;);</span>
<a href="#l14.119"></a><span id="l14.119" class="difflineat">@@ -677,23 +698,21 @@ function ltnSwitch2Calendar() {</span>
<a href="#l14.120"></a><span id="l14.120">     document.dispatchEvent(new CustomEvent(&quot;viewresize&quot;, { bubbles: true }));</span>
<a href="#l14.121"></a><span id="l14.121"> </span>
<a href="#l14.122"></a><span id="l14.122">     // Load the unifinder if it isn't already loaded.</span>
<a href="#l14.123"></a><span id="l14.123">     ensureUnifinderLoaded();</span>
<a href="#l14.124"></a><span id="l14.124">   }</span>
<a href="#l14.125"></a><span id="l14.125"> }</span>
<a href="#l14.126"></a><span id="l14.126"> </span>
<a href="#l14.127"></a><span id="l14.127"> /**</span>
<a href="#l14.128"></a><span id="l14.128" class="difflineminus">- * ltnSwitch2Task() switches to the task mode</span>
<a href="#l14.129"></a><span id="l14.129" class="difflineplus">+ * Switches to the task mode.</span>
<a href="#l14.130"></a><span id="l14.130">  */</span>
<a href="#l14.131"></a><span id="l14.131" class="difflineminus">-</span>
<a href="#l14.132"></a><span id="l14.132"> function ltnSwitch2Task() {</span>
<a href="#l14.133"></a><span id="l14.133">   if (gCurrentMode != &quot;task&quot;) {</span>
<a href="#l14.134"></a><span id="l14.134" class="difflineminus">-    gCurrentMode = &quot;task&quot;;</span>
<a href="#l14.135"></a><span id="l14.135" class="difflineminus">-    document.getElementById(&quot;modeBroadcaster&quot;).setAttribute(&quot;mode&quot;, gCurrentMode);</span>
<a href="#l14.136"></a><span id="l14.136" class="difflineplus">+    changeMode(&quot;task&quot;);</span>
<a href="#l14.137"></a><span id="l14.137"> </span>
<a href="#l14.138"></a><span id="l14.138">     // display the task panel on the display deck</span>
<a href="#l14.139"></a><span id="l14.139">     let deck = document.getElementById(&quot;calendarDisplayDeck&quot;);</span>
<a href="#l14.140"></a><span id="l14.140">     deck.selectedPanel = document.getElementById(&quot;calendar-task-box&quot;);</span>
<a href="#l14.141"></a><span id="l14.141"> </span>
<a href="#l14.142"></a><span id="l14.142">     document.getElementById(&quot;calMinimonth&quot;).setAttribute(&quot;freebusy&quot;, &quot;true&quot;);</span>
<a href="#l14.143"></a><span id="l14.143"> </span>
<a href="#l14.144"></a><span id="l14.144">     document.commandDispatcher.updateCommands(&quot;calendar_commands&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/calendar/lightning/content/messenger-overlay-sidebar.xul</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/calendar/lightning/content/messenger-overlay-sidebar.xul</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -25,16 +25,20 @@</span>
<a href="#l15.4"></a><span id="l15.4"> &lt;?xul-overlay href=&quot;chrome://calendar/content/calendar-common-sets.xul&quot;?&gt;</span>
<a href="#l15.5"></a><span id="l15.5"> &lt;?xul-overlay href=&quot;chrome://calendar/content/calendar-views.xul&quot;?&gt;</span>
<a href="#l15.6"></a><span id="l15.6"> </span>
<a href="#l15.7"></a><span id="l15.7"> &lt;?xul-overlay href=&quot;chrome://lightning/content/lightning-toolbar.xul&quot;?&gt;</span>
<a href="#l15.8"></a><span id="l15.8"> &lt;?xul-overlay href=&quot;chrome://lightning/content/lightning-menus.xul&quot;?&gt;</span>
<a href="#l15.9"></a><span id="l15.9"> </span>
<a href="#l15.10"></a><span id="l15.10"> &lt;overlay id=&quot;ltnSidebarOverlay&quot;</span>
<a href="#l15.11"></a><span id="l15.11">          xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot; xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineplus">+</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+  &lt;script src=&quot;chrome://lightning/content/lightning-utils.js&quot;/&gt;</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineplus">+  &lt;script src=&quot;chrome://lightning/content/messenger-overlay-sidebar.js&quot;/&gt;</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineplus">+</span>
<a href="#l15.16"></a><span id="l15.16">   &lt;script src=&quot;chrome://calendar/content/calendar-day-label.js&quot;/&gt;</span>
<a href="#l15.17"></a><span id="l15.17"> </span>
<a href="#l15.18"></a><span id="l15.18">   &lt;!-- NEEDED FOR MULTIPLE CALENDAR SUPPORT --&gt;</span>
<a href="#l15.19"></a><span id="l15.19">   &lt;script src=&quot;chrome://calendar/content/calendar-management.js&quot;/&gt;</span>
<a href="#l15.20"></a><span id="l15.20"> </span>
<a href="#l15.21"></a><span id="l15.21">   &lt;!-- NEEDED FOR CLIPBOARD SUPPORT --&gt;</span>
<a href="#l15.22"></a><span id="l15.22">   &lt;script src=&quot;chrome://calendar/content/calendar-clipboard.js&quot;/&gt;</span>
<a href="#l15.23"></a><span id="l15.23"> </span>
<a href="#l15.24"></a><span id="l15.24" class="difflineat">@@ -67,18 +71,16 @@</span>
<a href="#l15.25"></a><span id="l15.25">   &lt;script src=&quot;chrome://global/content/nsDragAndDrop.js&quot;/&gt;</span>
<a href="#l15.26"></a><span id="l15.26">   &lt;script src=&quot;chrome://calendar/content/widgets/calendar-modebox.js&quot;/&gt;</span>
<a href="#l15.27"></a><span id="l15.27"> </span>
<a href="#l15.28"></a><span id="l15.28">   &lt;!-- NEEDED FOR TASK VIEW/LIST SUPPORT --&gt;</span>
<a href="#l15.29"></a><span id="l15.29">   &lt;script src=&quot;chrome://calendar/content/calendar-task-editing.js&quot;/&gt;</span>
<a href="#l15.30"></a><span id="l15.30"> </span>
<a href="#l15.31"></a><span id="l15.31">   &lt;script src=&quot;chrome://calendar/content/calendar-extract.js&quot;/&gt;</span>
<a href="#l15.32"></a><span id="l15.32"> </span>
<a href="#l15.33"></a><span id="l15.33" class="difflineminus">-  &lt;script src=&quot;chrome://lightning/content/lightning-utils.js&quot;/&gt;</span>
<a href="#l15.34"></a><span id="l15.34" class="difflineminus">-  &lt;script src=&quot;chrome://lightning/content/messenger-overlay-sidebar.js&quot;/&gt;</span>
<a href="#l15.35"></a><span id="l15.35">   &lt;script src=&quot;chrome://calendar/content/calendar-invitations-manager.js&quot;/&gt;</span>
<a href="#l15.36"></a><span id="l15.36"> </span>
<a href="#l15.37"></a><span id="l15.37">   &lt;!-- NEEDED FOR EVENT/TASK IN A TAB --&gt;</span>
<a href="#l15.38"></a><span id="l15.38">   &lt;script src=&quot;chrome://lightning/content/lightning-item-panel.js&quot;/&gt;</span>
<a href="#l15.39"></a><span id="l15.39"> </span>
<a href="#l15.40"></a><span id="l15.40">   &lt;window id=&quot;messengerWindow&quot;&gt;</span>
<a href="#l15.41"></a><span id="l15.41">     &lt;!-- Be sure to keep these sets, since they will be overlaid by</span>
<a href="#l15.42"></a><span id="l15.42">          calendar/base/content/calendar-common-sets.xul --&gt;</span>
<a href="#l15.43"></a><span id="l15.43" class="difflineat">@@ -115,18 +117,16 @@</span>
<a href="#l15.44"></a><span id="l15.44">            key=&quot;&amp;lightning.keys.event.showTasks.key;&quot;</span>
<a href="#l15.45"></a><span id="l15.45">            modifiers=&quot;accel, shift&quot;</span>
<a href="#l15.46"></a><span id="l15.46">            command=&quot;new_task_tab&quot;/&gt;</span>
<a href="#l15.47"></a><span id="l15.47">       &lt;key id=&quot;todaypanekey&quot; command=&quot;calendar_toggle_todaypane_command&quot; keycode=&quot;VK_F11&quot;/&gt;</span>
<a href="#l15.48"></a><span id="l15.48">       &lt;key id=&quot;calendar-new-event-key&quot; key=&quot;&amp;lightning.keys.event.new;&quot; modifiers=&quot;accel&quot; command=&quot;calendar_new_event_command&quot;/&gt;</span>
<a href="#l15.49"></a><span id="l15.49">       &lt;key id=&quot;calendar-new-todo-key&quot; key=&quot;&amp;lightning.keys.todo.new;&quot; modifiers=&quot;accel&quot; command=&quot;calendar_new_todo_command&quot;/&gt;</span>
<a href="#l15.50"></a><span id="l15.50">     &lt;/keyset&gt;</span>
<a href="#l15.51"></a><span id="l15.51"> </span>
<a href="#l15.52"></a><span id="l15.52" class="difflineminus">-    &lt;broadcasterset id=&quot;calendar_broadcasters&quot;/&gt;</span>
<a href="#l15.53"></a><span id="l15.53" class="difflineminus">-</span>
<a href="#l15.54"></a><span id="l15.54">     &lt;popupset id=&quot;calendar-popupset&quot;&gt;</span>
<a href="#l15.55"></a><span id="l15.55">       &lt;menupopup id=&quot;list-calendars-context-menu&quot;</span>
<a href="#l15.56"></a><span id="l15.56">                  onpopupshowing=&quot;return calendarListSetupContextMenu(event);&quot;&gt;</span>
<a href="#l15.57"></a><span id="l15.57">         &lt;menuitem id=&quot;list-calendars-context-togglevisible&quot;</span>
<a href="#l15.58"></a><span id="l15.58">                   accesskeyshow=&quot;&amp;calendar.context.showcalendar.accesskey;&quot;</span>
<a href="#l15.59"></a><span id="l15.59">                   accesskeyhide=&quot;&amp;calendar.context.hidecalendar.accesskey;&quot;</span>
<a href="#l15.60"></a><span id="l15.60">                   oncommand=&quot;toggleCalendarVisible(document.getElementById('list-calendars-context-menu').contextCalendar);&quot;/&gt;</span>
<a href="#l15.61"></a><span id="l15.61">         &lt;menuitem id=&quot;list-calendars-context-showonly&quot;</span>
<a href="#l15.62"></a><span id="l15.62" class="difflineat">@@ -192,53 +192,48 @@</span>
<a href="#l15.63"></a><span id="l15.63">   &lt;/toolbar&gt;</span>
<a href="#l15.64"></a><span id="l15.64"> </span>
<a href="#l15.65"></a><span id="l15.65">   &lt;tabpanels id=&quot;tabpanelcontainer&quot;&gt;</span>
<a href="#l15.66"></a><span id="l15.66">     &lt;vbox id=&quot;calendarTabPanel&quot;&gt;</span>
<a href="#l15.67"></a><span id="l15.67">       &lt;!-- Unfortunately we use the same panel for task and calendar tabs, so</span>
<a href="#l15.68"></a><span id="l15.68">            we need to differ which toolbar is being shown. The actual toolbar</span>
<a href="#l15.69"></a><span id="l15.69">            content will be added via a further overlay --&gt;</span>
<a href="#l15.70"></a><span id="l15.70">       &lt;calendar-modevbox id=&quot;calendar-toolbox-container&quot;</span>
<a href="#l15.71"></a><span id="l15.71" class="difflineminus">-                         mode=&quot;calendar&quot;</span>
<a href="#l15.72"></a><span id="l15.72" class="difflineminus">-                         broadcaster=&quot;modeBroadcaster&quot;&gt;</span>
<a href="#l15.73"></a><span id="l15.73" class="difflineplus">+                         mode=&quot;calendar&quot;&gt;</span>
<a href="#l15.74"></a><span id="l15.74">         &lt;toolbox id=&quot;calendar-toolbox&quot;/&gt;</span>
<a href="#l15.75"></a><span id="l15.75">       &lt;/calendar-modevbox&gt;</span>
<a href="#l15.76"></a><span id="l15.76">       &lt;calendar-modevbox id=&quot;task-toolbox-container&quot;</span>
<a href="#l15.77"></a><span id="l15.77" class="difflineminus">-                         mode=&quot;task&quot;</span>
<a href="#l15.78"></a><span id="l15.78" class="difflineminus">-                         broadcaster=&quot;modeBroadcaster&quot;&gt;</span>
<a href="#l15.79"></a><span id="l15.79" class="difflineplus">+                         mode=&quot;task&quot;&gt;</span>
<a href="#l15.80"></a><span id="l15.80">         &lt;toolbox id=&quot;task-toolbox&quot;/&gt;</span>
<a href="#l15.81"></a><span id="l15.81">       &lt;/calendar-modevbox&gt;</span>
<a href="#l15.82"></a><span id="l15.82">       &lt;hbox id=&quot;calendarContent&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l15.83"></a><span id="l15.83">         &lt;vbox id=&quot;ltnSidebar&quot;</span>
<a href="#l15.84"></a><span id="l15.84">               width=&quot;200&quot;</span>
<a href="#l15.85"></a><span id="l15.85">               persist=&quot;collapsed width&quot;&gt;</span>
<a href="#l15.86"></a><span id="l15.86">           &lt;calendar-modevbox id=&quot;minimonth-pane&quot;</span>
<a href="#l15.87"></a><span id="l15.87">                              mode=&quot;calendar,task&quot;</span>
<a href="#l15.88"></a><span id="l15.88" class="difflineminus">-                             broadcaster=&quot;modeBroadcaster&quot;</span>
<a href="#l15.89"></a><span id="l15.89">                              refcontrol=&quot;calendar_toggle_minimonthpane_command&quot;&gt;</span>
<a href="#l15.90"></a><span id="l15.90">             &lt;vbox align=&quot;center&quot;&gt;</span>
<a href="#l15.91"></a><span id="l15.91">               &lt;hbox id=&quot;calMinimonthBox&quot; pack=&quot;center&quot;&gt;</span>
<a href="#l15.92"></a><span id="l15.92">                 &lt;calendar-minimonth id=&quot;calMinimonth&quot; onchange=&quot;minimonthPick(this.value);&quot;/&gt;</span>
<a href="#l15.93"></a><span id="l15.93">               &lt;/hbox&gt;</span>
<a href="#l15.94"></a><span id="l15.94">             &lt;/vbox&gt;</span>
<a href="#l15.95"></a><span id="l15.95">           &lt;/calendar-modevbox&gt;</span>
<a href="#l15.96"></a><span id="l15.96">           &lt;separator id=&quot;minimonth-splitter&quot; minwidth=&quot;100&quot;/&gt;</span>
<a href="#l15.97"></a><span id="l15.97">           &lt;vbox id=&quot;calendar-panel&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l15.98"></a><span id="l15.98">             &lt;calendar-modevbox id=&quot;task-filter-pane&quot;</span>
<a href="#l15.99"></a><span id="l15.99">                                mode=&quot;task&quot;</span>
<a href="#l15.100"></a><span id="l15.100" class="difflineminus">-                               broadcaster=&quot;modeBroadcaster&quot;</span>
<a href="#l15.101"></a><span id="l15.101">                                refcontrol=&quot;calendar_toggle_filter_command&quot;&gt;</span>
<a href="#l15.102"></a><span id="l15.102">               &lt;checkbox id=&quot;task-tree-filter-header&quot;</span>
<a href="#l15.103"></a><span id="l15.103">                                checked=&quot;true&quot;</span>
<a href="#l15.104"></a><span id="l15.104">                                class=&quot;treenode-checkbox&quot;</span>
<a href="#l15.105"></a><span id="l15.105">                                label=&quot;&amp;calendar.task.filter.title.label;&quot;/&gt;</span>
<a href="#l15.106"></a><span id="l15.106">               &lt;calendar-modevbox id=&quot;task-filtertree-pane&quot;</span>
<a href="#l15.107"></a><span id="l15.107">                                  flex=&quot;1&quot;</span>
<a href="#l15.108"></a><span id="l15.108">                                  mode=&quot;task&quot;</span>
<a href="#l15.109"></a><span id="l15.109" class="difflineminus">-                                 broadcaster=&quot;modeBroadcaster&quot;</span>
<a href="#l15.110"></a><span id="l15.110">                                  refcontrol=&quot;task-tree-filter-header&quot;&gt;</span>
<a href="#l15.111"></a><span id="l15.111">                 &lt;radiogroup id=&quot;task-tree-filtergroup&quot; class=&quot;task-tree-subpane&quot;</span>
<a href="#l15.112"></a><span id="l15.112">                             persist=&quot;value&quot;&gt;</span>
<a href="#l15.113"></a><span id="l15.113">                   &lt;radio id=&quot;opt_throughcurrent_filter&quot; label=&quot;&amp;calendar.task.filter.current.label;&quot; value=&quot;throughcurrent&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l15.114"></a><span id="l15.114">                   &lt;radio id=&quot;opt_today_filter&quot; label=&quot;&amp;calendar.task.filter.today.label;&quot; value=&quot;throughtoday&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l15.115"></a><span id="l15.115">                   &lt;radio id=&quot;opt_next7days_filter&quot; label=&quot;&amp;calendar.task.filter.next7days.label;&quot; value=&quot;throughsevendays&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l15.116"></a><span id="l15.116">                   &lt;radio id=&quot;opt_notstarted_filter&quot; label=&quot;&amp;calendar.task.filter.notstarted.label;&quot; value=&quot;notstarted&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l15.117"></a><span id="l15.117">                   &lt;radio id=&quot;opt_overdue_filter&quot; label=&quot;&amp;calendar.task.filter.overdue.label;&quot; value=&quot;overdue&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l15.118"></a><span id="l15.118" class="difflineat">@@ -246,26 +241,24 @@</span>
<a href="#l15.119"></a><span id="l15.119">                   &lt;radio id=&quot;opt_open_filter&quot; label=&quot;&amp;calendar.task.filter.open.label;&quot; value=&quot;open&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l15.120"></a><span id="l15.120">                   &lt;radio id=&quot;opt_all_filter&quot; label=&quot;&amp;calendar.task.filter.all.label;&quot; value=&quot;all&quot; command=&quot;calendar_task_filter_command&quot;/&gt;</span>
<a href="#l15.121"></a><span id="l15.121">                 &lt;/radiogroup&gt;</span>
<a href="#l15.122"></a><span id="l15.122">               &lt;/calendar-modevbox&gt;</span>
<a href="#l15.123"></a><span id="l15.123">             &lt;/calendar-modevbox&gt;</span>
<a href="#l15.124"></a><span id="l15.124">             &lt;calendar-modevbox id=&quot;calendar-list-pane&quot;</span>
<a href="#l15.125"></a><span id="l15.125">                                flex=&quot;1&quot;</span>
<a href="#l15.126"></a><span id="l15.126">                                mode=&quot;calendar,task&quot;</span>
<a href="#l15.127"></a><span id="l15.127" class="difflineminus">-                               broadcaster=&quot;modeBroadcaster&quot;</span>
<a href="#l15.128"></a><span id="l15.128">                                refcontrol=&quot;calendar_toggle_calendarlist_command&quot;&gt;</span>
<a href="#l15.129"></a><span id="l15.129">               &lt;checkbox id=&quot;calendar-list-header&quot;</span>
<a href="#l15.130"></a><span id="l15.130">                                checked=&quot;true&quot;</span>
<a href="#l15.131"></a><span id="l15.131">                                class=&quot;treenode-checkbox&quot;</span>
<a href="#l15.132"></a><span id="l15.132">                                label=&quot;&amp;calendar.list.header.label;&quot;/&gt;</span>
<a href="#l15.133"></a><span id="l15.133">               &lt;calendar-modevbox id=&quot;calendar-list-inner-pane&quot;</span>
<a href="#l15.134"></a><span id="l15.134">                                  flex=&quot;1&quot;</span>
<a href="#l15.135"></a><span id="l15.135">                                  mode=&quot;calendar,task&quot;</span>
<a href="#l15.136"></a><span id="l15.136" class="difflineminus">-                                 broadcaster=&quot;modeBroadcaster&quot;</span>
<a href="#l15.137"></a><span id="l15.137">                                  refcontrol=&quot;calendar-list-header&quot;&gt;</span>
<a href="#l15.138"></a><span id="l15.138">                 &lt;richlistbox id=&quot;calendar-list&quot; flex=&quot;1&quot; context=&quot;list-calendars-context-menu&quot;/&gt;</span>
<a href="#l15.139"></a><span id="l15.139">               &lt;/calendar-modevbox&gt;</span>
<a href="#l15.140"></a><span id="l15.140">             &lt;/calendar-modevbox&gt;</span>
<a href="#l15.141"></a><span id="l15.141">           &lt;/vbox&gt;</span>
<a href="#l15.142"></a><span id="l15.142">         &lt;/vbox&gt;</span>
<a href="#l15.143"></a><span id="l15.143"> </span>
<a href="#l15.144"></a><span id="l15.144">         &lt;splitter id=&quot;calsidebar_splitter&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/calendar/lightning/jar.mn</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/calendar/lightning/jar.mn</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -14,17 +14,16 @@ lightning.jar:</span>
<a href="#l16.4"></a><span id="l16.4"> % overlay chrome://messenger/content/messageWindow.xul chrome://lightning/content/messenger-overlay-messageWindow.xul</span>
<a href="#l16.5"></a><span id="l16.5"> % overlay chrome://lightning/content/messenger-overlay-sidebar.xul chrome://lightning/content/imip-bar-overlay.xul</span>
<a href="#l16.6"></a><span id="l16.6"> % overlay chrome://communicator/content/pref/preferences.xul chrome://lightning/content/suite-overlay-preferences.xul application={92650c4d-4b8e-4d2a-b7eb-24ecf4f6b63a}</span>
<a href="#l16.7"></a><span id="l16.7"> % overlay about:addons chrome://lightning/content/suite-overlay-addons.xul application={92650c4d-4b8e-4d2a-b7eb-24ecf4f6b63a}</span>
<a href="#l16.8"></a><span id="l16.8"> % overlay chrome://mozapps/content/extensions/extensions.xul chrome://lightning/content/suite-overlay-addons.xul application={92650c4d-4b8e-4d2a-b7eb-24ecf4f6b63a}</span>
<a href="#l16.9"></a><span id="l16.9"> % overlay chrome://messenger/content/preferences/preferences.xul chrome://lightning/content/messenger-overlay-preferences.xul</span>
<a href="#l16.10"></a><span id="l16.10"> % overlay about:preferences chrome://lightning/content/messenger-overlay-preferences.xul</span>
<a href="#l16.11"></a><span id="l16.11"> % overlay chrome://lightning/content/messenger-overlay-sidebar.xul chrome://calendar/content/calendar-unifinder.xul</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-% overlay chrome://lightning/content/messenger-overlay-sidebar.xul chrome://calendar/content/calendar-unifinder-todo.xul</span>
<a href="#l16.13"></a><span id="l16.13"> % overlay chrome://lightning/content/messenger-overlay-sidebar.xul chrome://calendar/content/calendar-task-view.xul</span>
<a href="#l16.14"></a><span id="l16.14"> % overlay chrome://lightning/content/messenger-overlay-sidebar.xul chrome://calendar/content/today-pane.xul</span>
<a href="#l16.15"></a><span id="l16.15"> % overlay chrome://lightning/content/messenger-overlay-sidebar.xul chrome://lightning/content/suite-overlay-sidebar.xul application={92650c4d-4b8e-4d2a-b7eb-24ecf4f6b63a}</span>
<a href="#l16.16"></a><span id="l16.16"> % overlay chrome://calendar/content/calendarCreation.xul chrome://lightning/content/lightning-calendar-creation.xul</span>
<a href="#l16.17"></a><span id="l16.17"> % overlay chrome://calendar/content/calendar-properties-dialog.xul chrome://lightning/content/lightning-calendar-properties.xul</span>
<a href="#l16.18"></a><span id="l16.18"> % overlay chrome://lightning/content/lightning-calendar-creation.xul chrome://lightning/content/caldav-lightning-calendar-creation.xul</span>
<a href="#l16.19"></a><span id="l16.19"> % overlay chrome://lightning/content/lightning-calendar-properties.xul chrome://lightning/content/caldav-lightning-calendar-properties.xul</span>
<a href="#l16.20"></a><span id="l16.20"> % override chrome://lightning-common/skin/accountCentral.css chrome://lightning-common/skin/suite-accountCentral.css application={92650c4d-4b8e-4d2a-b7eb-24ecf4f6b63a}</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/4b0de666d1a4">4b0de666d1a4</a> at 2020-07-30T19:32:32Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

