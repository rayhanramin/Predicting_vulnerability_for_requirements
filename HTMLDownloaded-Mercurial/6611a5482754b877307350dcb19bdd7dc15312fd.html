<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 1463:6611a5482754b877307350dcb19bdd7dc15312fd</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 6611a5482754b877307350dcb19bdd7dc15312fd" />
<meta property="og:url" content="/comm-central/rev/6611a5482754b877307350dcb19bdd7dc15312fd" />
<meta property="og:description" content="[Sunbird] Bug 470197 - Update installer. r=ctalbert" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 6611a5482754b877307350dcb19bdd7dc15312fd 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/6611a5482754b877307350dcb19bdd7dc15312fd">shortlog</a> |
<a href="/comm-central/log/6611a5482754b877307350dcb19bdd7dc15312fd">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/6611a5482754b877307350dcb19bdd7dc15312fd">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/6611a5482754b877307350dcb19bdd7dc15312fd">files</a> |
changeset |
<a href="/comm-central/raw-rev/6611a5482754b877307350dcb19bdd7dc15312fd">raw</a>  | <a href="/comm-central/archive/6611a5482754b877307350dcb19bdd7dc15312fd.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
[Sunbird] <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=470197">Bug 470197</a> - Update installer. r=ctalbert
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#82;&#111;&#98;&#101;&#114;&#116;&#32;&#83;&#116;&#114;&#111;&#110;&#103;&#32;&#60;&#114;&#111;&#98;&#101;&#114;&#116;&#46;&#98;&#117;&#103;&#122;&#105;&#108;&#108;&#97;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 19 Dec 2008 16:02:38 -0800</td></tr>

<tr>
 <td>changeset 1463</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/6611a5482754b877307350dcb19bdd7dc15312fd">6611a5482754b877307350dcb19bdd7dc15312fd</a></td>
</tr>



<tr>
<td>parent 1462</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/e10a3baac8d7d6c7ce987e315134a9047d0de4f1">e10a3baac8d7d6c7ce987e315134a9047d0de4f1</a>
</td>
</tr>

<tr>
<td>child 1464</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/4daac073741d2876dbcaded7f6d4a52b41129419">4daac073741d2876dbcaded7f6d4a52b41129419</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=6611a5482754b877307350dcb19bdd7dc15312fd">1162</a></td></tr>
<tr><td>push user</td><td>rstrong@mozilla.com</td></tr>
<tr><td>push date</td><td class="date age">Sat, 20 Dec 2008 00:03:57 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@6611a5482754 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=6611a5482754b877307350dcb19bdd7dc15312fd">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=6611a5482754b877307350dcb19bdd7dc15312fd&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=6611a5482754b877307350dcb19bdd7dc15312fd&newProject=comm-central&newRevision=6611a5482754b877307350dcb19bdd7dc15312fd&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=6611a5482754b877307350dcb19bdd7dc15312fd&newProject=comm-central&newRevision=6611a5482754b877307350dcb19bdd7dc15312fd&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=6611a5482754b877307350dcb19bdd7dc15312fd&newProject=comm-central&newRevision=6611a5482754b877307350dcb19bdd7dc15312fd&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28ctalbert%29&revcount=50">ctalbert</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=470197">470197</a></td></tr>




</table></div>

<div class="page_body description">[Sunbird] <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=470197">Bug 470197</a> - Update installer. r=ctalbert</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/removed-files.in">calendar/installer/removed-files.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/removed-files.in">file</a> |
<a href="/comm-central/annotate/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/removed-files.in">annotate</a> |
<a href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/removed-files.in">diff</a> |
<a href="/comm-central/comparison/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/removed-files.in">comparison</a> |
<a href="/comm-central/log/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/removed-files.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/Makefile.in">calendar/installer/windows/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/Makefile.in">file</a> |
<a href="/comm-central/annotate/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/Makefile.in">annotate</a> |
<a href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/Makefile.in">diff</a> |
<a href="/comm-central/comparison/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/Makefile.in">comparison</a> |
<a href="/comm-central/log/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/defines.nsi.in">calendar/installer/windows/nsis/defines.nsi.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/defines.nsi.in">file</a> |
<a href="/comm-central/annotate/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/defines.nsi.in">annotate</a> |
<a href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/defines.nsi.in">diff</a> |
<a href="/comm-central/comparison/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/defines.nsi.in">comparison</a> |
<a href="/comm-central/log/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/defines.nsi.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/installer.nsi">calendar/installer/windows/nsis/installer.nsi</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/installer.nsi">file</a> |
<a href="/comm-central/annotate/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/installer.nsi">annotate</a> |
<a href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/installer.nsi">diff</a> |
<a href="/comm-central/comparison/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/installer.nsi">comparison</a> |
<a href="/comm-central/log/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/installer.nsi">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/shared.nsh">calendar/installer/windows/nsis/shared.nsh</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/shared.nsh">file</a> |
<a href="/comm-central/annotate/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/shared.nsh">annotate</a> |
<a href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/shared.nsh">diff</a> |
<a href="/comm-central/comparison/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/shared.nsh">comparison</a> |
<a href="/comm-central/log/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/shared.nsh">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/uninstaller.nsi">calendar/installer/windows/nsis/uninstaller.nsi</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/uninstaller.nsi">file</a> |
<a href="/comm-central/annotate/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/uninstaller.nsi">annotate</a> |
<a href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/uninstaller.nsi">diff</a> |
<a href="/comm-central/comparison/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/uninstaller.nsi">comparison</a> |
<a href="/comm-central/log/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/uninstaller.nsi">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/updater_append.ini">calendar/installer/windows/nsis/updater_append.ini</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/updater_append.ini">file</a> |
<a href="/comm-central/annotate/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/updater_append.ini">annotate</a> |
<a href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/updater_append.ini">diff</a> |
<a href="/comm-central/comparison/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/updater_append.ini">comparison</a> |
<a href="/comm-central/log/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/nsis/updater_append.ini">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/packages-static">calendar/installer/windows/packages-static</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/packages-static">file</a> |
<a href="/comm-central/annotate/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/packages-static">annotate</a> |
<a href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/packages-static">diff</a> |
<a href="/comm-central/comparison/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/packages-static">comparison</a> |
<a href="/comm-central/log/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/installer/windows/packages-static">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/Makefile.in">calendar/locales/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/Makefile.in">file</a> |
<a href="/comm-central/annotate/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/Makefile.in">annotate</a> |
<a href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/Makefile.in">diff</a> |
<a href="/comm-central/comparison/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/Makefile.in">comparison</a> |
<a href="/comm-central/log/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/Makefile.in">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/custom.properties">calendar/locales/en-US/installer/custom.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/custom.properties">file</a> |
<a href="/comm-central/annotate/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/custom.properties">annotate</a> |
<a href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/custom.properties">diff</a> |
<a href="/comm-central/comparison/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/custom.properties">comparison</a> |
<a href="/comm-central/log/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/custom.properties">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/mui.properties">calendar/locales/en-US/installer/mui.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/mui.properties">file</a> |
<a href="/comm-central/annotate/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/mui.properties">annotate</a> |
<a href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/mui.properties">diff</a> |
<a href="/comm-central/comparison/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/mui.properties">comparison</a> |
<a href="/comm-central/log/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/mui.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/override.properties">calendar/locales/en-US/installer/override.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/override.properties">file</a> |
<a href="/comm-central/annotate/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/override.properties">annotate</a> |
<a href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/override.properties">diff</a> |
<a href="/comm-central/comparison/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/override.properties">comparison</a> |
<a href="/comm-central/log/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/locales/en-US/installer/override.properties">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/sunbird/locales/Makefile.in">calendar/sunbird/locales/Makefile.in</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/sunbird/locales/Makefile.in">file</a> |
<a href="/comm-central/annotate/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/sunbird/locales/Makefile.in">annotate</a> |
<a href="/comm-central/diff/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/sunbird/locales/Makefile.in">diff</a> |
<a href="/comm-central/comparison/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/sunbird/locales/Makefile.in">comparison</a> |
<a href="/comm-central/log/6611a5482754b877307350dcb19bdd7dc15312fd/calendar/sunbird/locales/Makefile.in">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/installer/removed-files.in</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/installer/removed-files.in</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -253,16 +253,18 @@ res/table-remove-row.gif</span>
<a href="#l1.4"></a><span id="l1.4"> res/viewer.properties</span>
<a href="#l1.5"></a><span id="l1.5"> dependentlibs.list</span>
<a href="#l1.6"></a><span id="l1.6"> mozctl.dll</span>
<a href="#l1.7"></a><span id="l1.7"> mozctlx.dll</span>
<a href="#l1.8"></a><span id="l1.8"> regxpcom.exe</span>
<a href="#l1.9"></a><span id="l1.9"> sunbird.url</span>
<a href="#l1.10"></a><span id="l1.10"> unins000.dat</span>
<a href="#l1.11"></a><span id="l1.11"> unins000.exe</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+uninstall/UninstallSunbird.exe</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+uninstall/uninst.exe</span>
<a href="#l1.14"></a><span id="l1.14"> xpcom_compat.dll</span>
<a href="#l1.15"></a><span id="l1.15"> components/nsInterfaceInfoToIDL.js</span>
<a href="#l1.16"></a><span id="l1.16"> xpcshell.exe</span>
<a href="#l1.17"></a><span id="l1.17"> xpidl.exe</span>
<a href="#l1.18"></a><span id="l1.18"> xpt_dump.exe</span>
<a href="#l1.19"></a><span id="l1.19"> xpt_link.exe</span>
<a href="#l1.20"></a><span id="l1.20"> #</span>
<a href="#l1.21"></a><span id="l1.21"> # Clean out obsolete files from Sunbird 0.5 installer</span>
<a href="#l1.22"></a><span id="l1.22" class="difflineat">@@ -273,17 +275,16 @@ js/calWcapCachedCalendar.js</span>
<a href="#l1.23"></a><span id="l1.23"> #endif</span>
<a href="#l1.24"></a><span id="l1.24"> #</span>
<a href="#l1.25"></a><span id="l1.25"> #ifndef XP_MACOSX</span>
<a href="#l1.26"></a><span id="l1.26"> components/autocomplete.xpt</span>
<a href="#l1.27"></a><span id="l1.27"> #endif</span>
<a href="#l1.28"></a><span id="l1.28"> @DLL_PREFIX@zlib@DLL_SUFFIX@</span>
<a href="#l1.29"></a><span id="l1.29"> extensions/inspector@mozilla.org/components/inspector.xpt</span>
<a href="#l1.30"></a><span id="l1.30"> extensions/inspector@mozilla.org/components/@DLL_PREFIX@inspector@DLL_SUFFIX@</span>
<a href="#l1.31"></a><span id="l1.31" class="difflineminus">-uninstall/UninstallSunbird.exe</span>
<a href="#l1.32"></a><span id="l1.32"> #</span>
<a href="#l1.33"></a><span id="l1.33"> #</span>
<a href="#l1.34"></a><span id="l1.34"> # Clean out obsolete Talkback files</span>
<a href="#l1.35"></a><span id="l1.35"> #</span>
<a href="#l1.36"></a><span id="l1.36"> extensions/talkback@mozilla.org/</span>
<a href="#l1.37"></a><span id="l1.37"> extensions/talkback@mozilla.org/install.rdf</span>
<a href="#l1.38"></a><span id="l1.38"> extensions/talkback@mozilla.org/chrome.manifest</span>
<a href="#l1.39"></a><span id="l1.39"> extensions/talkback@mozilla.org/components/qfaservices.xpt</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/installer/windows/Makefile.in</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/installer/windows/Makefile.in</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -50,16 +50,17 @@ SFX_MODULE = $(MOZILLA_SRCDIR)/other-lic</span>
<a href="#l2.4"></a><span id="l2.4"> PP_LOCALIZED_FILES = \</span>
<a href="#l2.5"></a><span id="l2.5"> 	packages-static \</span>
<a href="#l2.6"></a><span id="l2.6"> 	$(NULL)</span>
<a href="#l2.7"></a><span id="l2.7"> </span>
<a href="#l2.8"></a><span id="l2.8"> INSTALLER_FILES = \</span>
<a href="#l2.9"></a><span id="l2.9"> 	app.tag \</span>
<a href="#l2.10"></a><span id="l2.10"> 	nsis/installer.nsi \</span>
<a href="#l2.11"></a><span id="l2.11"> 	nsis/uninstaller.nsi \</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+	nsis/shared.nsh \</span>
<a href="#l2.13"></a><span id="l2.13"> 	$(NULL)</span>
<a href="#l2.14"></a><span id="l2.14"> </span>
<a href="#l2.15"></a><span id="l2.15"> BRANDING_FILES = \</span>
<a href="#l2.16"></a><span id="l2.16"> 	branding.nsi \</span>
<a href="#l2.17"></a><span id="l2.17"> 	license.txt \</span>
<a href="#l2.18"></a><span id="l2.18"> 	wizHeader.bmp \</span>
<a href="#l2.19"></a><span id="l2.19"> 	wizHeaderRTL.bmp \</span>
<a href="#l2.20"></a><span id="l2.20"> 	wizWatermark.bmp \</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/installer/windows/nsis/defines.nsi.in</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/installer/windows/nsis/defines.nsi.in</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -1,11 +1,9 @@</span>
<a href="#l3.4"></a><span id="l3.4"> #filter substitution</span>
<a href="#l3.5"></a><span id="l3.5"> !define AppVersion            &quot;@MOZ_APP_VERSION@&quot;</span>
<a href="#l3.6"></a><span id="l3.6"> !define GREVersion            @MOZILLA_VERSION@</span>
<a href="#l3.7"></a><span id="l3.7"> !define AB_CD                 &quot;@AB_CD@&quot;</span>
<a href="#l3.8"></a><span id="l3.8" class="difflineminus">-!define FileInstallerEXE      &quot;@PKG_BASENAME@.installer.exe&quot;</span>
<a href="#l3.9"></a><span id="l3.9" class="difflineminus">-!define FileInstallerMSI      &quot;@PKG_BASENAME@.installer.msi&quot;</span>
<a href="#l3.10"></a><span id="l3.10" class="difflineminus">-!define FileInstallerNETRoot  &quot;@PKG_BASENAME@.net-installer&quot;</span>
<a href="#l3.11"></a><span id="l3.11"> </span>
<a href="#l3.12"></a><span id="l3.12"> !define FileMainEXE           &quot;sunbird.exe&quot;</span>
<a href="#l3.13"></a><span id="l3.13"> !define NO_UNINSTALL_SURVEY</span>
<a href="#l3.14"></a><span id="l3.14"> !define WindowClass           &quot;SunbirdMessageWindow&quot;</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineplus">+!define MinSupportedVer       &quot;Microsoft Windows 2000&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/installer/windows/nsis/installer.nsi</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/installer/windows/nsis/installer.nsi</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -29,98 +29,112 @@</span>
<a href="#l4.4"></a><span id="l4.4"> # use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l4.5"></a><span id="l4.5"> # decision by deleting the provisions above and replace them with the notice</span>
<a href="#l4.6"></a><span id="l4.6"> # and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l4.7"></a><span id="l4.7"> # the provisions above, a recipient may use your version of this file under</span>
<a href="#l4.8"></a><span id="l4.8"> # the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l4.9"></a><span id="l4.9"> #</span>
<a href="#l4.10"></a><span id="l4.10"> # ***** END LICENSE BLOCK *****</span>
<a href="#l4.11"></a><span id="l4.11"> </span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-# Also requires:</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-# ShellLink plugin http://nsis.sourceforge.net/ShellLink_plug-in</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineplus">+# Required Plugins:</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineplus">+# AppAssocReg http://nsis.sourceforge.net/Application_Association_Registration_plug-in</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineplus">+# ShellLink   http://nsis.sourceforge.net/ShellLink_plug-in</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineplus">+# UAC         http://nsis.sourceforge.net/UAC_plug-in</span>
<a href="#l4.18"></a><span id="l4.18"> </span>
<a href="#l4.19"></a><span id="l4.19"> ; Set verbosity to 3 (e.g. no script) to lessen the noise in the build logs</span>
<a href="#l4.20"></a><span id="l4.20"> !verbose 3</span>
<a href="#l4.21"></a><span id="l4.21"> </span>
<a href="#l4.22"></a><span id="l4.22"> ; 7-Zip provides better compression than the lzma from NSIS so we add the files</span>
<a href="#l4.23"></a><span id="l4.23"> ; uncompressed and use 7-Zip to create a SFX archive of it</span>
<a href="#l4.24"></a><span id="l4.24"> SetDatablockOptimize on</span>
<a href="#l4.25"></a><span id="l4.25"> SetCompress off</span>
<a href="#l4.26"></a><span id="l4.26"> CRCCheck on</span>
<a href="#l4.27"></a><span id="l4.27"> </span>
<a href="#l4.28"></a><span id="l4.28" class="difflineplus">+RequestExecutionLevel user</span>
<a href="#l4.29"></a><span id="l4.29" class="difflineplus">+</span>
<a href="#l4.30"></a><span id="l4.30"> !addplugindir ./</span>
<a href="#l4.31"></a><span id="l4.31"> </span>
<a href="#l4.32"></a><span id="l4.32"> ; empty files - except for the comment line - for generating custom pages.</span>
<a href="#l4.33"></a><span id="l4.33"> !system 'echo ; &gt; options.ini'</span>
<a href="#l4.34"></a><span id="l4.34" class="difflineminus">-!system 'echo ; &gt; components.ini'</span>
<a href="#l4.35"></a><span id="l4.35"> !system 'echo ; &gt; shortcuts.ini'</span>
<a href="#l4.36"></a><span id="l4.36" class="difflineplus">+!system 'echo ; &gt; summary.ini'</span>
<a href="#l4.37"></a><span id="l4.37" class="difflineplus">+</span>
<a href="#l4.38"></a><span id="l4.38" class="difflineplus">+; USE_UAC_PLUGIN is temporary until all applications have been updated to use</span>
<a href="#l4.39"></a><span id="l4.39" class="difflineplus">+; the UAC plugin</span>
<a href="#l4.40"></a><span id="l4.40" class="difflineplus">+!define USE_UAC_PLUGIN</span>
<a href="#l4.41"></a><span id="l4.41"> </span>
<a href="#l4.42"></a><span id="l4.42"> Var TmpVal</span>
<a href="#l4.43"></a><span id="l4.43"> Var StartMenuDir</span>
<a href="#l4.44"></a><span id="l4.44"> Var InstallType</span>
<a href="#l4.45"></a><span id="l4.45"> Var AddStartMenuSC</span>
<a href="#l4.46"></a><span id="l4.46"> Var AddQuickLaunchSC</span>
<a href="#l4.47"></a><span id="l4.47"> Var AddDesktopSC</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineminus">-Var fhInstallLog</span>
<a href="#l4.49"></a><span id="l4.49" class="difflineminus">-Var fhUninstallLog</span>
<a href="#l4.50"></a><span id="l4.50"> </span>
<a href="#l4.51"></a><span id="l4.51"> ; Other included files may depend upon these includes!</span>
<a href="#l4.52"></a><span id="l4.52"> ; The following includes are provided by NSIS.</span>
<a href="#l4.53"></a><span id="l4.53"> !include FileFunc.nsh</span>
<a href="#l4.54"></a><span id="l4.54"> !include LogicLib.nsh</span>
<a href="#l4.55"></a><span id="l4.55" class="difflineminus">-!include TextFunc.nsh</span>
<a href="#l4.56"></a><span id="l4.56" class="difflineplus">+!include MUI.nsh</span>
<a href="#l4.57"></a><span id="l4.57"> !include WinMessages.nsh</span>
<a href="#l4.58"></a><span id="l4.58" class="difflineplus">+!include WinVer.nsh</span>
<a href="#l4.59"></a><span id="l4.59"> !include WordFunc.nsh</span>
<a href="#l4.60"></a><span id="l4.60" class="difflineminus">-!include MUI.nsh</span>
<a href="#l4.61"></a><span id="l4.61"> </span>
<a href="#l4.62"></a><span id="l4.62" class="difflineminus">-!insertmacro FileJoin</span>
<a href="#l4.63"></a><span id="l4.63" class="difflineminus">-!insertmacro GetTime</span>
<a href="#l4.64"></a><span id="l4.64" class="difflineminus">-!insertmacro LineFind</span>
<a href="#l4.65"></a><span id="l4.65" class="difflineplus">+!insertmacro GetOptions</span>
<a href="#l4.66"></a><span id="l4.66" class="difflineplus">+!insertmacro GetParameters</span>
<a href="#l4.67"></a><span id="l4.67" class="difflineplus">+!insertmacro GetSize</span>
<a href="#l4.68"></a><span id="l4.68"> !insertmacro StrFilter</span>
<a href="#l4.69"></a><span id="l4.69" class="difflineminus">-!insertmacro TrimNewLines</span>
<a href="#l4.70"></a><span id="l4.70" class="difflineminus">-!insertmacro WordFind</span>
<a href="#l4.71"></a><span id="l4.71"> !insertmacro WordReplace</span>
<a href="#l4.72"></a><span id="l4.72" class="difflineminus">-!insertmacro GetSize</span>
<a href="#l4.73"></a><span id="l4.73" class="difflineminus">-!insertmacro GetParameters</span>
<a href="#l4.74"></a><span id="l4.74" class="difflineminus">-!insertmacro GetOptions</span>
<a href="#l4.75"></a><span id="l4.75" class="difflineminus">-!insertmacro GetRoot</span>
<a href="#l4.76"></a><span id="l4.76" class="difflineminus">-!insertmacro DriveSpace</span>
<a href="#l4.77"></a><span id="l4.77"> </span>
<a href="#l4.78"></a><span id="l4.78"> ; The following includes are custom.</span>
<a href="#l4.79"></a><span id="l4.79"> !include branding.nsi</span>
<a href="#l4.80"></a><span id="l4.80"> !include defines.nsi</span>
<a href="#l4.81"></a><span id="l4.81"> !include common.nsh</span>
<a href="#l4.82"></a><span id="l4.82"> !include locales.nsi</span>
<a href="#l4.83"></a><span id="l4.83"> !include version.nsh</span>
<a href="#l4.84"></a><span id="l4.84"> </span>
<a href="#l4.85"></a><span id="l4.85"> VIAddVersionKey &quot;FileDescription&quot; &quot;${BrandShortName} Installer&quot;</span>
<a href="#l4.86"></a><span id="l4.86" class="difflineplus">+VIAddVersionKey &quot;OriginalFilename&quot; &quot;setup.exe&quot;</span>
<a href="#l4.87"></a><span id="l4.87"> </span>
<a href="#l4.88"></a><span id="l4.88" class="difflineplus">+; Must be inserted before other macros that use logging</span>
<a href="#l4.89"></a><span id="l4.89" class="difflineplus">+!insertmacro _LoggingCommon</span>
<a href="#l4.90"></a><span id="l4.90" class="difflineplus">+</span>
<a href="#l4.91"></a><span id="l4.91" class="difflineplus">+!insertmacro ChangeMUIHeaderImage</span>
<a href="#l4.92"></a><span id="l4.92" class="difflineplus">+!insertmacro CheckForFilesInUse</span>
<a href="#l4.93"></a><span id="l4.93" class="difflineplus">+!insertmacro CleanUpdatesDir</span>
<a href="#l4.94"></a><span id="l4.94" class="difflineplus">+!insertmacro CopyFilesFromDir</span>
<a href="#l4.95"></a><span id="l4.95" class="difflineplus">+!insertmacro GetPathFromString</span>
<a href="#l4.96"></a><span id="l4.96" class="difflineplus">+!insertmacro GetParent</span>
<a href="#l4.97"></a><span id="l4.97" class="difflineplus">+!insertmacro ManualCloseAppPrompt</span>
<a href="#l4.98"></a><span id="l4.98"> !insertmacro RegCleanMain</span>
<a href="#l4.99"></a><span id="l4.99"> !insertmacro RegCleanUninstall</span>
<a href="#l4.100"></a><span id="l4.100" class="difflineminus">-!insertmacro CloseApp</span>
<a href="#l4.101"></a><span id="l4.101" class="difflineplus">+!insertmacro SetBrandNameVars</span>
<a href="#l4.102"></a><span id="l4.102" class="difflineplus">+!insertmacro UnloadUAC</span>
<a href="#l4.103"></a><span id="l4.103"> !insertmacro WriteRegStr2</span>
<a href="#l4.104"></a><span id="l4.104"> !insertmacro WriteRegDWORD2</span>
<a href="#l4.105"></a><span id="l4.105" class="difflineminus">-!insertmacro WriteRegStrHKCR</span>
<a href="#l4.106"></a><span id="l4.106" class="difflineminus">-!insertmacro CreateRegKey</span>
<a href="#l4.107"></a><span id="l4.107" class="difflineminus">-!insertmacro CanWriteToInstallDir</span>
<a href="#l4.108"></a><span id="l4.108" class="difflineminus">-!insertmacro CheckDiskSpace</span>
<a href="#l4.109"></a><span id="l4.109" class="difflineplus">+</span>
<a href="#l4.110"></a><span id="l4.110" class="difflineplus">+!include shared.nsh</span>
<a href="#l4.111"></a><span id="l4.111"> </span>
<a href="#l4.112"></a><span id="l4.112" class="difflineminus">-!include overrides.nsh</span>
<a href="#l4.113"></a><span id="l4.113" class="difflineminus">-!insertmacro LocateNoDetails</span>
<a href="#l4.114"></a><span id="l4.114" class="difflineminus">-!insertmacro TextCompareNoDetails</span>
<a href="#l4.115"></a><span id="l4.115" class="difflineplus">+; Helper macros for ui callbacks. Insert these after shared.nsh</span>
<a href="#l4.116"></a><span id="l4.116" class="difflineplus">+!insertmacro CheckCustomCommon</span>
<a href="#l4.117"></a><span id="l4.117" class="difflineplus">+!insertmacro InstallEndCleanupCommon</span>
<a href="#l4.118"></a><span id="l4.118" class="difflineplus">+!insertmacro InstallOnInitCommon</span>
<a href="#l4.119"></a><span id="l4.119" class="difflineplus">+!insertmacro InstallStartCleanupCommon</span>
<a href="#l4.120"></a><span id="l4.120" class="difflineplus">+!insertmacro LeaveDirectoryCommon</span>
<a href="#l4.121"></a><span id="l4.121" class="difflineplus">+!insertmacro OnEndCommon</span>
<a href="#l4.122"></a><span id="l4.122" class="difflineplus">+!insertmacro PreDirectoryCommon</span>
<a href="#l4.123"></a><span id="l4.123"> </span>
<a href="#l4.124"></a><span id="l4.124"> Name &quot;${BrandFullName}&quot;</span>
<a href="#l4.125"></a><span id="l4.125"> OutFile &quot;setup.exe&quot;</span>
<a href="#l4.126"></a><span id="l4.126"> InstallDirRegKey HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${BrandFullNameInternal} (${AppVersion})&quot; &quot;InstallLocation&quot;</span>
<a href="#l4.127"></a><span id="l4.127" class="difflineminus">-InstallDir &quot;$PROGRAMFILES\${BrandFullName}&quot;</span>
<a href="#l4.128"></a><span id="l4.128" class="difflineplus">+InstallDir &quot;$PROGRAMFILES\${BrandFullName}\&quot;</span>
<a href="#l4.129"></a><span id="l4.129"> ShowInstDetails nevershow</span>
<a href="#l4.130"></a><span id="l4.130"> </span>
<a href="#l4.131"></a><span id="l4.131"> ReserveFile options.ini</span>
<a href="#l4.132"></a><span id="l4.132" class="difflineminus">-ReserveFile components.ini</span>
<a href="#l4.133"></a><span id="l4.133"> ReserveFile shortcuts.ini</span>
<a href="#l4.134"></a><span id="l4.134" class="difflineplus">+ReserveFile summary.ini</span>
<a href="#l4.135"></a><span id="l4.135"> </span>
<a href="#l4.136"></a><span id="l4.136"> ################################################################################</span>
<a href="#l4.137"></a><span id="l4.137"> # Modern User Interface - MUI</span>
<a href="#l4.138"></a><span id="l4.138"> </span>
<a href="#l4.139"></a><span id="l4.139"> !define MUI_ABORTWARNING</span>
<a href="#l4.140"></a><span id="l4.140"> !define MUI_ICON setup.ico</span>
<a href="#l4.141"></a><span id="l4.141"> !define MUI_UNICON setup.ico</span>
<a href="#l4.142"></a><span id="l4.142"> !define MUI_WELCOMEPAGE_TITLE_3LINES</span>
<a href="#l4.143"></a><span id="l4.143" class="difflineat">@@ -134,152 +148,103 @@ ReserveFile shortcuts.ini</span>
<a href="#l4.144"></a><span id="l4.144"> !else</span>
<a href="#l4.145"></a><span id="l4.145"> !define MUI_HEADERIMAGE_BITMAP wizHeader.bmp</span>
<a href="#l4.146"></a><span id="l4.146"> !endif</span>
<a href="#l4.147"></a><span id="l4.147"> </span>
<a href="#l4.148"></a><span id="l4.148"> /**</span>
<a href="#l4.149"></a><span id="l4.149">  * Installation Pages</span>
<a href="#l4.150"></a><span id="l4.150">  */</span>
<a href="#l4.151"></a><span id="l4.151"> ; Welcome Page</span>
<a href="#l4.152"></a><span id="l4.152" class="difflineplus">+!define MUI_PAGE_CUSTOMFUNCTION_PRE preWelcome</span>
<a href="#l4.153"></a><span id="l4.153"> !insertmacro MUI_PAGE_WELCOME</span>
<a href="#l4.154"></a><span id="l4.154"> </span>
<a href="#l4.155"></a><span id="l4.155"> ; License Page</span>
<a href="#l4.156"></a><span id="l4.156" class="difflineminus">-!define MUI_LICENSEPAGE_RADIOBUTTONS</span>
<a href="#l4.157"></a><span id="l4.157" class="difflineplus">+!define MUI_PAGE_CUSTOMFUNCTION_SHOW showLicense</span>
<a href="#l4.158"></a><span id="l4.158" class="difflineplus">+!define MUI_LICENSEPAGE_CHECKBOX</span>
<a href="#l4.159"></a><span id="l4.159"> !insertmacro MUI_PAGE_LICENSE license.txt</span>
<a href="#l4.160"></a><span id="l4.160"> </span>
<a href="#l4.161"></a><span id="l4.161"> ; Custom Options Page</span>
<a href="#l4.162"></a><span id="l4.162"> Page custom preOptions leaveOptions</span>
<a href="#l4.163"></a><span id="l4.163"> </span>
<a href="#l4.164"></a><span id="l4.164" class="difflineminus">-; Custom Components Page</span>
<a href="#l4.165"></a><span id="l4.165" class="difflineminus">-Page custom preComponents leaveComponents</span>
<a href="#l4.166"></a><span id="l4.166" class="difflineminus">-</span>
<a href="#l4.167"></a><span id="l4.167"> ; Select Install Directory Page</span>
<a href="#l4.168"></a><span id="l4.168"> !define MUI_PAGE_CUSTOMFUNCTION_PRE preDirectory</span>
<a href="#l4.169"></a><span id="l4.169"> !define MUI_PAGE_CUSTOMFUNCTION_LEAVE leaveDirectory</span>
<a href="#l4.170"></a><span id="l4.170"> !define MUI_DIRECTORYPAGE_VERIFYONLEAVE</span>
<a href="#l4.171"></a><span id="l4.171"> !insertmacro MUI_PAGE_DIRECTORY</span>
<a href="#l4.172"></a><span id="l4.172"> </span>
<a href="#l4.173"></a><span id="l4.173"> ; Custom Shortcuts Page</span>
<a href="#l4.174"></a><span id="l4.174"> Page custom preShortcuts leaveShortcuts</span>
<a href="#l4.175"></a><span id="l4.175"> </span>
<a href="#l4.176"></a><span id="l4.176"> ; Start Menu Folder Page Configuration</span>
<a href="#l4.177"></a><span id="l4.177"> !define MUI_PAGE_CUSTOMFUNCTION_PRE preStartMenu</span>
<a href="#l4.178"></a><span id="l4.178" class="difflineplus">+!define MUI_PAGE_CUSTOMFUNCTION_LEAVE leaveStartMenu</span>
<a href="#l4.179"></a><span id="l4.179"> !define MUI_STARTMENUPAGE_NODISABLE</span>
<a href="#l4.180"></a><span id="l4.180"> !define MUI_STARTMENUPAGE_REGISTRY_ROOT &quot;HKLM&quot;</span>
<a href="#l4.181"></a><span id="l4.181"> !define MUI_STARTMENUPAGE_REGISTRY_KEY &quot;Software\Mozilla\${BrandFullNameInternal}\${AppVersion} (${AB_CD})\Main&quot;</span>
<a href="#l4.182"></a><span id="l4.182"> !define MUI_STARTMENUPAGE_REGISTRY_VALUENAME &quot;Start Menu Folder&quot;</span>
<a href="#l4.183"></a><span id="l4.183"> !insertmacro MUI_PAGE_STARTMENU Application $StartMenuDir</span>
<a href="#l4.184"></a><span id="l4.184"> </span>
<a href="#l4.185"></a><span id="l4.185" class="difflineplus">+; Custom Summary Page</span>
<a href="#l4.186"></a><span id="l4.186" class="difflineplus">+Page custom preSummary leaveSummary</span>
<a href="#l4.187"></a><span id="l4.187" class="difflineplus">+</span>
<a href="#l4.188"></a><span id="l4.188"> ; Install Files Page</span>
<a href="#l4.189"></a><span id="l4.189" class="difflineminus">-!define MUI_PAGE_CUSTOMFUNCTION_LEAVE leaveInstFiles</span>
<a href="#l4.190"></a><span id="l4.190"> !insertmacro MUI_PAGE_INSTFILES</span>
<a href="#l4.191"></a><span id="l4.191"> </span>
<a href="#l4.192"></a><span id="l4.192"> ; Finish Page</span>
<a href="#l4.193"></a><span id="l4.193" class="difflineminus">-!define MUI_FINISHPAGE_NOREBOOTSUPPORT</span>
<a href="#l4.194"></a><span id="l4.194"> !define MUI_FINISHPAGE_TITLE_3LINES</span>
<a href="#l4.195"></a><span id="l4.195"> !define MUI_FINISHPAGE_RUN</span>
<a href="#l4.196"></a><span id="l4.196"> !define MUI_FINISHPAGE_RUN_FUNCTION LaunchApp</span>
<a href="#l4.197"></a><span id="l4.197"> !define MUI_FINISHPAGE_RUN_TEXT $(LAUNCH_TEXT)</span>
<a href="#l4.198"></a><span id="l4.198"> !define MUI_PAGE_CUSTOMFUNCTION_PRE preFinish</span>
<a href="#l4.199"></a><span id="l4.199"> !insertmacro MUI_PAGE_FINISH</span>
<a href="#l4.200"></a><span id="l4.200"> </span>
<a href="#l4.201"></a><span id="l4.201" class="difflineplus">+; Use the default dialog for IDD_VERIFY for a simple Banner</span>
<a href="#l4.202"></a><span id="l4.202" class="difflineplus">+ChangeUI IDD_VERIFY &quot;${NSISDIR}\Contrib\UIs\default.exe&quot;</span>
<a href="#l4.203"></a><span id="l4.203" class="difflineplus">+</span>
<a href="#l4.204"></a><span id="l4.204"> ################################################################################</span>
<a href="#l4.205"></a><span id="l4.205"> # Install Sections</span>
<a href="#l4.206"></a><span id="l4.206"> </span>
<a href="#l4.207"></a><span id="l4.207" class="difflineminus">-Section &quot;-Application&quot; Section1</span>
<a href="#l4.208"></a><span id="l4.208" class="difflineminus">-  SectionIn 1 RO</span>
<a href="#l4.209"></a><span id="l4.209" class="difflineminus">-  SetDetailsPrint textonly</span>
<a href="#l4.210"></a><span id="l4.210" class="difflineplus">+; Cleanup operations to perform at the start of the installation.</span>
<a href="#l4.211"></a><span id="l4.211" class="difflineplus">+Section &quot;-InstallStartCleanup&quot;</span>
<a href="#l4.212"></a><span id="l4.212" class="difflineplus">+  SetDetailsPrint both</span>
<a href="#l4.213"></a><span id="l4.213">   DetailPrint $(STATUS_CLEANUP)</span>
<a href="#l4.214"></a><span id="l4.214">   SetDetailsPrint none</span>
<a href="#l4.215"></a><span id="l4.215" class="difflineminus">-  SetOutPath $INSTDIR</span>
<a href="#l4.216"></a><span id="l4.216"> </span>
<a href="#l4.217"></a><span id="l4.217" class="difflineminus">-  ; Try to delete the app executable and if we can't delete it try to close the</span>
<a href="#l4.218"></a><span id="l4.218" class="difflineminus">-  ; app. This allows running an instance that is located in another directory.</span>
<a href="#l4.219"></a><span id="l4.219" class="difflineplus">+  SetOutPath &quot;$INSTDIR&quot;</span>
<a href="#l4.220"></a><span id="l4.220" class="difflineplus">+  ${StartInstallLog} &quot;${BrandFullName}&quot; &quot;${AB_CD}&quot; &quot;${AppVersion}&quot; &quot;${GREVersion}&quot;</span>
<a href="#l4.221"></a><span id="l4.221" class="difflineplus">+</span>
<a href="#l4.222"></a><span id="l4.222" class="difflineplus">+  ; Delete the app exe to prevent launching the app while we are installing.</span>
<a href="#l4.223"></a><span id="l4.223">   ClearErrors</span>
<a href="#l4.224"></a><span id="l4.224" class="difflineminus">-  ${If} ${FileExists} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.225"></a><span id="l4.225" class="difflineminus">-    ${DeleteFile} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.226"></a><span id="l4.226" class="difflineminus">-  ${EndIf}</span>
<a href="#l4.227"></a><span id="l4.227" class="difflineplus">+  ${DeleteFile} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.228"></a><span id="l4.228">   ${If} ${Errors}</span>
<a href="#l4.229"></a><span id="l4.229" class="difflineminus">-    ClearErrors</span>
<a href="#l4.230"></a><span id="l4.230" class="difflineminus">-    ${CloseApp} &quot;true&quot; $(WARN_APP_RUNNING_INSTALL)</span>
<a href="#l4.231"></a><span id="l4.231" class="difflineminus">-    ; Try to delete it again to prevent launching the app while we are</span>
<a href="#l4.232"></a><span id="l4.232" class="difflineminus">-    ; installing.</span>
<a href="#l4.233"></a><span id="l4.233" class="difflineplus">+    ; If the user closed the application it can take several seconds for it to</span>
<a href="#l4.234"></a><span id="l4.234" class="difflineplus">+    ; shut down completely. If the application is being used by another user we</span>
<a href="#l4.235"></a><span id="l4.235" class="difflineplus">+    ; can rename the file and then delete is when the system is restarted.</span>
<a href="#l4.236"></a><span id="l4.236" class="difflineplus">+    Sleep 5000</span>
<a href="#l4.237"></a><span id="l4.237">     ${DeleteFile} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.238"></a><span id="l4.238">     ClearErrors</span>
<a href="#l4.239"></a><span id="l4.239">   ${EndIf}</span>
<a href="#l4.240"></a><span id="l4.240"> </span>
<a href="#l4.241"></a><span id="l4.241" class="difflineminus">-  ${If} $InstallType != 1</span>
<a href="#l4.242"></a><span id="l4.242" class="difflineminus">-    ; Custom installs.</span>
<a href="#l4.243"></a><span id="l4.243" class="difflineminus">-    ; If DOMi is installed and this install includes DOMi remove it from</span>
<a href="#l4.244"></a><span id="l4.244" class="difflineminus">-    ; the installation directory. This will remove it if the user deselected</span>
<a href="#l4.245"></a><span id="l4.245" class="difflineminus">-    ; DOMi on the components page.</span>
<a href="#l4.246"></a><span id="l4.246" class="difflineminus">-    ${If} ${FileExists} &quot;$INSTDIR\extensions\inspector@mozilla.org&quot;</span>
<a href="#l4.247"></a><span id="l4.247" class="difflineminus">-    ${AndIf} ${FileExists} &quot;$EXEDIR\optional\extensions\inspector@mozilla.org&quot;</span>
<a href="#l4.248"></a><span id="l4.248" class="difflineminus">-      RmDir /r &quot;$INSTDIR\extensions\inspector@mozilla.org&quot;</span>
<a href="#l4.249"></a><span id="l4.249" class="difflineminus">-    ${EndIf}</span>
<a href="#l4.250"></a><span id="l4.250" class="difflineminus">-  ${EndIf}</span>
<a href="#l4.251"></a><span id="l4.251" class="difflineminus">-</span>
<a href="#l4.252"></a><span id="l4.252" class="difflineminus">-  Call CleanupOldLogs</span>
<a href="#l4.253"></a><span id="l4.253" class="difflineminus">-</span>
<a href="#l4.254"></a><span id="l4.254" class="difflineminus">-  ${If} ${FileExists} &quot;$INSTDIR\uninstall\uninstall.log&quot;</span>
<a href="#l4.255"></a><span id="l4.255" class="difflineminus">-    ; Diff cleanup.log with uninstall.bak</span>
<a href="#l4.256"></a><span id="l4.256" class="difflineminus">-    ${LogHeader} &quot;Updating Uninstall Log With XPInstall Wizard Logs&quot;</span>
<a href="#l4.257"></a><span id="l4.257" class="difflineminus">-    StrCpy $R0 &quot;$INSTDIR\uninstall\uninstall.log&quot;</span>
<a href="#l4.258"></a><span id="l4.258" class="difflineminus">-    StrCpy $R1 &quot;$INSTDIR\uninstall\cleanup.log&quot;</span>
<a href="#l4.259"></a><span id="l4.259" class="difflineminus">-    GetTempFileName $R2</span>
<a href="#l4.260"></a><span id="l4.260" class="difflineminus">-    FileOpen $R3 $R2 w</span>
<a href="#l4.261"></a><span id="l4.261" class="difflineminus">-    ${TextCompareNoDetails} &quot;$R1&quot; &quot;$R0&quot; &quot;SlowDiff&quot; &quot;GetDiff&quot;</span>
<a href="#l4.262"></a><span id="l4.262" class="difflineminus">-    FileClose $R3</span>
<a href="#l4.263"></a><span id="l4.263" class="difflineminus">-</span>
<a href="#l4.264"></a><span id="l4.264" class="difflineminus">-    ${Unless} ${Errors}</span>
<a href="#l4.265"></a><span id="l4.265" class="difflineminus">-      ${FileJoin} &quot;$INSTDIR\uninstall\uninstall.log&quot; &quot;$R2&quot; &quot;$INSTDIR\uninstall\uninstall.log&quot;</span>
<a href="#l4.266"></a><span id="l4.266" class="difflineminus">-    ${EndUnless}</span>
<a href="#l4.267"></a><span id="l4.267" class="difflineminus">-    ${DeleteFile} &quot;$INSTDIR\uninstall\cleanup.log&quot;</span>
<a href="#l4.268"></a><span id="l4.268" class="difflineminus">-    ${DeleteFile} &quot;$R2&quot;</span>
<a href="#l4.269"></a><span id="l4.269" class="difflineminus">-    ${DeleteFile} &quot;$INSTDIR\uninstall\uninstall.bak&quot;</span>
<a href="#l4.270"></a><span id="l4.270" class="difflineminus">-    Rename &quot;$INSTDIR\uninstall\uninstall.log&quot; &quot;$INSTDIR\uninstall\uninstall.bak&quot;</span>
<a href="#l4.271"></a><span id="l4.271" class="difflineminus">-  ${EndIf}</span>
<a href="#l4.272"></a><span id="l4.272" class="difflineplus">+  ; Remove the updates directory for Vista and above</span>
<a href="#l4.273"></a><span id="l4.273" class="difflineplus">+  ${CleanUpdatesDir} &quot;Mozilla\Sunbird&quot;</span>
<a href="#l4.274"></a><span id="l4.274"> </span>
<a href="#l4.275"></a><span id="l4.275" class="difflineminus">-  ${Unless} ${FileExists} &quot;$INSTDIR\uninstall&quot;</span>
<a href="#l4.276"></a><span id="l4.276" class="difflineminus">-    CreateDirectory &quot;$INSTDIR\uninstall&quot;</span>
<a href="#l4.277"></a><span id="l4.277" class="difflineminus">-  ${EndUnless}</span>
<a href="#l4.278"></a><span id="l4.278" class="difflineminus">-</span>
<a href="#l4.279"></a><span id="l4.279" class="difflineminus">-  FileOpen $fhUninstallLog &quot;$INSTDIR\uninstall\uninstall.log&quot; w</span>
<a href="#l4.280"></a><span id="l4.280" class="difflineminus">-  FileOpen $fhInstallLog &quot;$INSTDIR\install.log&quot; w</span>
<a href="#l4.281"></a><span id="l4.281" class="difflineminus">-</span>
<a href="#l4.282"></a><span id="l4.282" class="difflineminus">-  ${GetTime} &quot;&quot; &quot;L&quot; $0 $1 $2 $3 $4 $5 $6</span>
<a href="#l4.283"></a><span id="l4.283" class="difflineminus">-  FileWrite $fhInstallLog &quot;${BrandFullName} Installation Started: $2-$1-$0 $4:$5:$6&quot;</span>
<a href="#l4.284"></a><span id="l4.284" class="difflineminus">-  Call WriteLogSeparator</span>
<a href="#l4.285"></a><span id="l4.285" class="difflineplus">+  ${InstallStartCleanupCommon}</span>
<a href="#l4.286"></a><span id="l4.286" class="difflineplus">+SectionEnd</span>
<a href="#l4.287"></a><span id="l4.287"> </span>
<a href="#l4.288"></a><span id="l4.288" class="difflineminus">-  ${LogHeader} &quot;Installation Details&quot;</span>
<a href="#l4.289"></a><span id="l4.289" class="difflineminus">-  ${LogMsg} &quot;Install Dir: $INSTDIR&quot;</span>
<a href="#l4.290"></a><span id="l4.290" class="difflineminus">-  ${LogMsg} &quot;Locale     : ${AB_CD}&quot;</span>
<a href="#l4.291"></a><span id="l4.291" class="difflineminus">-  ${LogMsg} &quot;App Version: ${AppVersion}&quot;</span>
<a href="#l4.292"></a><span id="l4.292" class="difflineminus">-  ${LogMsg} &quot;GRE Version: ${GREVersion}&quot;</span>
<a href="#l4.293"></a><span id="l4.293" class="difflineplus">+Section &quot;-Application&quot; APP_IDX</span>
<a href="#l4.294"></a><span id="l4.294" class="difflineplus">+  ${StartUninstallLog}</span>
<a href="#l4.295"></a><span id="l4.295"> </span>
<a href="#l4.296"></a><span id="l4.296" class="difflineminus">-  ${If} ${FileExists} &quot;$EXEDIR\removed-files.log&quot;</span>
<a href="#l4.297"></a><span id="l4.297" class="difflineminus">-    ${LogHeader} &quot;Removing Obsolete Files and Directories&quot;</span>
<a href="#l4.298"></a><span id="l4.298" class="difflineminus">-    ${LineFind} &quot;$EXEDIR\removed-files.log&quot; &quot;/NUL&quot; &quot;1:-1&quot; &quot;onInstallDeleteFile&quot;</span>
<a href="#l4.299"></a><span id="l4.299" class="difflineminus">-    ${LineFind} &quot;$EXEDIR\removed-files.log&quot; &quot;/NUL&quot; &quot;1:-1&quot; &quot;onInstallRemoveDir&quot;</span>
<a href="#l4.300"></a><span id="l4.300" class="difflineminus">-  ${EndIf}</span>
<a href="#l4.301"></a><span id="l4.301" class="difflineminus">-</span>
<a href="#l4.302"></a><span id="l4.302" class="difflineminus">-  ${DeleteFile} &quot;$INSTDIR\install_wizard.log&quot;</span>
<a href="#l4.303"></a><span id="l4.303" class="difflineminus">-  ${DeleteFile} &quot;$INSTDIR\install_status.log&quot;</span>
<a href="#l4.304"></a><span id="l4.304" class="difflineminus">-</span>
<a href="#l4.305"></a><span id="l4.305" class="difflineminus">-  RmDir /r &quot;$INSTDIR\updates&quot;</span>
<a href="#l4.306"></a><span id="l4.306" class="difflineminus">-  ${DeleteFile} &quot;$INSTDIR\updates.xml&quot;</span>
<a href="#l4.307"></a><span id="l4.307" class="difflineminus">-  ${DeleteFile} &quot;$INSTDIR\active-update.xml&quot;</span>
<a href="#l4.308"></a><span id="l4.308" class="difflineminus">-</span>
<a href="#l4.309"></a><span id="l4.309" class="difflineminus">-  SetDetailsPrint textonly</span>
<a href="#l4.310"></a><span id="l4.310" class="difflineplus">+  SetDetailsPrint both</span>
<a href="#l4.311"></a><span id="l4.311">   DetailPrint $(STATUS_INSTALL_APP)</span>
<a href="#l4.312"></a><span id="l4.312">   SetDetailsPrint none</span>
<a href="#l4.313"></a><span id="l4.313" class="difflineplus">+</span>
<a href="#l4.314"></a><span id="l4.314">   ${LogHeader} &quot;Installing Main Files&quot;</span>
<a href="#l4.315"></a><span id="l4.315" class="difflineminus">-  StrCpy $R0 &quot;$EXEDIR\nonlocalized&quot;</span>
<a href="#l4.316"></a><span id="l4.316" class="difflineminus">-  StrCpy $R1 &quot;$INSTDIR&quot;</span>
<a href="#l4.317"></a><span id="l4.317" class="difflineminus">-  Call DoCopyFiles</span>
<a href="#l4.318"></a><span id="l4.318" class="difflineplus">+  ${CopyFilesFromDir} &quot;$EXEDIR\nonlocalized&quot; &quot;$INSTDIR&quot; \</span>
<a href="#l4.319"></a><span id="l4.319" class="difflineplus">+                      &quot;$(ERROR_CREATE_DIRECTORY_PREFIX)&quot; \</span>
<a href="#l4.320"></a><span id="l4.320" class="difflineplus">+                      &quot;$(ERROR_CREATE_DIRECTORY_SUFFIX)&quot;</span>
<a href="#l4.321"></a><span id="l4.321"> </span>
<a href="#l4.322"></a><span id="l4.322">   ; Register DLLs</span>
<a href="#l4.323"></a><span id="l4.323">   ; XXXrstrong - AccessibleMarshal.dll can be used by multiple applications but</span>
<a href="#l4.324"></a><span id="l4.324">   ; is only registered for the last application installed. When the last</span>
<a href="#l4.325"></a><span id="l4.325">   ; application installed is uninstalled AccessibleMarshal.dll will no longer be</span>
<a href="#l4.326"></a><span id="l4.326">   ; registered. bug 338878</span>
<a href="#l4.327"></a><span id="l4.327">   ${LogHeader} &quot;DLL Registration&quot;</span>
<a href="#l4.328"></a><span id="l4.328">   ClearErrors</span>
<a href="#l4.329"></a><span id="l4.329" class="difflineat">@@ -299,29 +264,24 @@ Section &quot;-Application&quot; Section1</span>
<a href="#l4.330"></a><span id="l4.330">   ${LogUninstall} &quot;File: \components\xpti.dat&quot;</span>
<a href="#l4.331"></a><span id="l4.331">   ${LogUninstall} &quot;File: \.autoreg&quot;</span>
<a href="#l4.332"></a><span id="l4.332">   ${LogUninstall} &quot;File: \active-update.xml&quot;</span>
<a href="#l4.333"></a><span id="l4.333">   ${LogUninstall} &quot;File: \install.log&quot;</span>
<a href="#l4.334"></a><span id="l4.334">   ${LogUninstall} &quot;File: \install_status.log&quot;</span>
<a href="#l4.335"></a><span id="l4.335">   ${LogUninstall} &quot;File: \install_wizard.log&quot;</span>
<a href="#l4.336"></a><span id="l4.336">   ${LogUninstall} &quot;File: \updates.xml&quot;</span>
<a href="#l4.337"></a><span id="l4.337"> </span>
<a href="#l4.338"></a><span id="l4.338" class="difflineminus">-  SetDetailsPrint textonly</span>
<a href="#l4.339"></a><span id="l4.339" class="difflineplus">+  SetDetailsPrint both</span>
<a href="#l4.340"></a><span id="l4.340">   DetailPrint $(STATUS_INSTALL_LANG)</span>
<a href="#l4.341"></a><span id="l4.341">   SetDetailsPrint none</span>
<a href="#l4.342"></a><span id="l4.342" class="difflineplus">+</span>
<a href="#l4.343"></a><span id="l4.343">   ${LogHeader} &quot;Installing Localized Files&quot;</span>
<a href="#l4.344"></a><span id="l4.344" class="difflineminus">-  StrCpy $R0 &quot;$EXEDIR\localized&quot;</span>
<a href="#l4.345"></a><span id="l4.345" class="difflineminus">-  StrCpy $R1 &quot;$INSTDIR&quot;</span>
<a href="#l4.346"></a><span id="l4.346" class="difflineminus">-  Call DoCopyFiles</span>
<a href="#l4.347"></a><span id="l4.347" class="difflineminus">-</span>
<a href="#l4.348"></a><span id="l4.348" class="difflineminus">-  ${If} $InstallType != 4</span>
<a href="#l4.349"></a><span id="l4.349" class="difflineminus">-    ${If} ${FileExists} &quot;$INSTDIR\extensions\inspector@mozilla.org&quot;</span>
<a href="#l4.350"></a><span id="l4.350" class="difflineminus">-      Call installInspector</span>
<a href="#l4.351"></a><span id="l4.351" class="difflineminus">-    ${EndIf}</span>
<a href="#l4.352"></a><span id="l4.352" class="difflineminus">-  ${EndIf}</span>
<a href="#l4.353"></a><span id="l4.353" class="difflineplus">+  ${CopyFilesFromDir} &quot;$EXEDIR\localized&quot; &quot;$INSTDIR&quot; \</span>
<a href="#l4.354"></a><span id="l4.354" class="difflineplus">+                      &quot;$(ERROR_CREATE_DIRECTORY_PREFIX)&quot; \</span>
<a href="#l4.355"></a><span id="l4.355" class="difflineplus">+                      &quot;$(ERROR_CREATE_DIRECTORY_SUFFIX)&quot;</span>
<a href="#l4.356"></a><span id="l4.356"> </span>
<a href="#l4.357"></a><span id="l4.357">   ; Default for creating Start Menu folder and shortcuts</span>
<a href="#l4.358"></a><span id="l4.358">   ; (1 = create, 0 = don't create)</span>
<a href="#l4.359"></a><span id="l4.359">   ${If} $AddStartMenuSC == &quot;&quot;</span>
<a href="#l4.360"></a><span id="l4.360">     StrCpy $AddStartMenuSC &quot;1&quot;</span>
<a href="#l4.361"></a><span id="l4.361">   ${EndIf}</span>
<a href="#l4.362"></a><span id="l4.362"> </span>
<a href="#l4.363"></a><span id="l4.363">   ; Default for creating Quick Launch shortcut (1 = create, 0 = don't create)</span>
<a href="#l4.364"></a><span id="l4.364" class="difflineat">@@ -329,348 +289,214 @@ Section &quot;-Application&quot; Section1</span>
<a href="#l4.365"></a><span id="l4.365">     StrCpy $AddQuickLaunchSC &quot;1&quot;</span>
<a href="#l4.366"></a><span id="l4.366">   ${EndIf}</span>
<a href="#l4.367"></a><span id="l4.367"> </span>
<a href="#l4.368"></a><span id="l4.368">   ; Default for creating Desktop shortcut (1 = create, 0 = don't create)</span>
<a href="#l4.369"></a><span id="l4.369">   ${If} $AddDesktopSC == &quot;&quot;</span>
<a href="#l4.370"></a><span id="l4.370">     StrCpy $AddDesktopSC &quot;1&quot;</span>
<a href="#l4.371"></a><span id="l4.371">   ${EndIf}</span>
<a href="#l4.372"></a><span id="l4.372"> </span>
<a href="#l4.373"></a><span id="l4.373" class="difflineminus">-  ; Remove registry entries for non-existent apps and for apps that point to our</span>
<a href="#l4.374"></a><span id="l4.374" class="difflineminus">-  ; install location in the Software\Mozilla key and uninstall registry entries</span>
<a href="#l4.375"></a><span id="l4.375" class="difflineminus">-  ; that point to our install location for both HKCU and HKLM.</span>
<a href="#l4.376"></a><span id="l4.376" class="difflineplus">+  ${LogHeader} &quot;Adding Registry Entries&quot;</span>
<a href="#l4.377"></a><span id="l4.377">   SetShellVarContext current  ; Set SHCTX to HKCU</span>
<a href="#l4.378"></a><span id="l4.378">   ${RegCleanMain} &quot;Software\Mozilla&quot;</span>
<a href="#l4.379"></a><span id="l4.379">   ${RegCleanUninstall}</span>
<a href="#l4.380"></a><span id="l4.380"> </span>
<a href="#l4.381"></a><span id="l4.381" class="difflineminus">-  SetShellVarContext all  ; Set SHCTX to HKLM</span>
<a href="#l4.382"></a><span id="l4.382" class="difflineminus">-  ${RegCleanMain} &quot;Software\Mozilla&quot;</span>
<a href="#l4.383"></a><span id="l4.383" class="difflineminus">-  ${RegCleanUninstall}</span>
<a href="#l4.384"></a><span id="l4.384" class="difflineminus">-</span>
<a href="#l4.385"></a><span id="l4.385" class="difflineminus">-  ${LogHeader} &quot;Adding Registry Entries&quot;</span>
<a href="#l4.386"></a><span id="l4.386">   ClearErrors</span>
<a href="#l4.387"></a><span id="l4.387" class="difflineminus">-  WriteRegStr HKLM &quot;Software\Mozilla\InstallerTest&quot; &quot;InstallerTest&quot; &quot;Test&quot;</span>
<a href="#l4.388"></a><span id="l4.388" class="difflineplus">+  WriteRegStr HKLM &quot;Software\Mozilla&quot; &quot;${BrandShortName}InstallerTest&quot; &quot;Write Test&quot;</span>
<a href="#l4.389"></a><span id="l4.389">   ${If} ${Errors}</span>
<a href="#l4.390"></a><span id="l4.390" class="difflineminus">-    SetShellVarContext current  ; Set SHCTX to HKCU</span>
<a href="#l4.391"></a><span id="l4.391">     StrCpy $TmpVal &quot;HKCU&quot; ; used primarily for logging</span>
<a href="#l4.392"></a><span id="l4.392">   ${Else}</span>
<a href="#l4.393"></a><span id="l4.393">     SetShellVarContext all  ; Set SHCTX to HKLM</span>
<a href="#l4.394"></a><span id="l4.394" class="difflineminus">-    DeleteRegKey HKLM &quot;Software\Mozilla\InstallerTest&quot;</span>
<a href="#l4.395"></a><span id="l4.395" class="difflineplus">+    DeleteRegValue HKLM &quot;Software\Mozilla&quot; &quot;${BrandShortName}InstallerTest&quot;</span>
<a href="#l4.396"></a><span id="l4.396">     StrCpy $TmpVal &quot;HKLM&quot; ; used primarily for logging</span>
<a href="#l4.397"></a><span id="l4.397" class="difflineplus">+    ${RegCleanMain} &quot;Software\Mozilla&quot;</span>
<a href="#l4.398"></a><span id="l4.398" class="difflineplus">+    ${RegCleanUninstall}</span>
<a href="#l4.399"></a><span id="l4.399">   ${EndIf}</span>
<a href="#l4.400"></a><span id="l4.400"> </span>
<a href="#l4.401"></a><span id="l4.401">   ; The previous installer adds several regsitry values to both HKLM and HKCU.</span>
<a href="#l4.402"></a><span id="l4.402">   ; We now try to add to HKLM and if that fails to HKCU</span>
<a href="#l4.403"></a><span id="l4.403"> </span>
<a href="#l4.404"></a><span id="l4.404">   ; The order that reg keys and values are added is important if you use the</span>
<a href="#l4.405"></a><span id="l4.405">   ; uninstall log to remove them on uninstall. When using the uninstall log you</span>
<a href="#l4.406"></a><span id="l4.406">   ; MUST add children first so they will be removed first on uninstall so they</span>
<a href="#l4.407"></a><span id="l4.407">   ; will be empty when the key is deleted. This allows the uninstaller to</span>
<a href="#l4.408"></a><span id="l4.408">   ; specify that only empty keys will be deleted.</span>
<a href="#l4.409"></a><span id="l4.409" class="difflineplus">+  ${SetAppKeys}</span>
<a href="#l4.410"></a><span id="l4.410"> </span>
<a href="#l4.411"></a><span id="l4.411" class="difflineminus">-  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal}\${AppVersion} (${AB_CD})\Main&quot;</span>
<a href="#l4.412"></a><span id="l4.412" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Install Directory&quot; &quot;$INSTDIR&quot; 0</span>
<a href="#l4.413"></a><span id="l4.413" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;PathToExe&quot; &quot;$INSTDIR\${FileMainEXE}&quot; 0</span>
<a href="#l4.414"></a><span id="l4.414" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Program Folder Path&quot; &quot;$SMPROGRAMS\$StartMenuDir&quot; 0</span>
<a href="#l4.415"></a><span id="l4.415" class="difflineminus">-  ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;Create Quick Launch Shortcut&quot; $AddQuickLaunchSC 0</span>
<a href="#l4.416"></a><span id="l4.416" class="difflineminus">-  ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;Create Desktop Shortcut&quot; $AddDesktopSC 0</span>
<a href="#l4.417"></a><span id="l4.417" class="difflineplus">+  ; XXXrstrong - this should be set in shared.nsh along with &quot;Create Quick</span>
<a href="#l4.418"></a><span id="l4.418" class="difflineplus">+  ; Launch Shortcut&quot; and Create Desktop Shortcut.</span>
<a href="#l4.419"></a><span id="l4.419" class="difflineplus">+  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal}\${AppVersion} (${AB_CD})\Uninstall&quot;</span>
<a href="#l4.420"></a><span id="l4.420">   ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;Create Start Menu Shortcut&quot; $AddStartMenuSC 0</span>
<a href="#l4.421"></a><span id="l4.421"> </span>
<a href="#l4.422"></a><span id="l4.422" class="difflineminus">-  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal}\${AppVersion} (${AB_CD})\Uninstall&quot;</span>
<a href="#l4.423"></a><span id="l4.423" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Uninstall Log Folder&quot; &quot;$INSTDIR\uninstall&quot; 0</span>
<a href="#l4.424"></a><span id="l4.424" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Description&quot; &quot;${BrandFullNameInternal} (${AppVersion})&quot; 0</span>
<a href="#l4.425"></a><span id="l4.425" class="difflineminus">-</span>
<a href="#l4.426"></a><span id="l4.426" class="difflineminus">-  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal}\${AppVersion} (${AB_CD})&quot;</span>
<a href="#l4.427"></a><span id="l4.427" class="difflineminus">-  ${WriteRegStr2} $TmpVal  &quot;$0&quot; &quot;&quot; &quot;${AppVersion} (${AB_CD})&quot; 0</span>
<a href="#l4.428"></a><span id="l4.428" class="difflineminus">-</span>
<a href="#l4.429"></a><span id="l4.429" class="difflineminus">-  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal} ${AppVersion}\bin&quot;</span>
<a href="#l4.430"></a><span id="l4.430" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;PathToExe&quot; &quot;$INSTDIR\${FileMainEXE}&quot; 0</span>
<a href="#l4.431"></a><span id="l4.431" class="difflineplus">+  ; The following keys should only be set if we can write to HKLM</span>
<a href="#l4.432"></a><span id="l4.432" class="difflineplus">+  ${If} $TmpVal == &quot;HKLM&quot;</span>
<a href="#l4.433"></a><span id="l4.433" class="difflineplus">+    ; Uninstall keys can only exist under HKLM on some versions of windows.</span>
<a href="#l4.434"></a><span id="l4.434" class="difflineplus">+    ${SetUninstallKeys}</span>
<a href="#l4.435"></a><span id="l4.435"> </span>
<a href="#l4.436"></a><span id="l4.436" class="difflineminus">-  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal} ${AppVersion}\extensions&quot;</span>
<a href="#l4.437"></a><span id="l4.437" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Components&quot; &quot;$INSTDIR\components&quot; 0</span>
<a href="#l4.438"></a><span id="l4.438" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Plugins&quot; &quot;$INSTDIR\plugins&quot; 0</span>
<a href="#l4.439"></a><span id="l4.439" class="difflineminus">-</span>
<a href="#l4.440"></a><span id="l4.440" class="difflineminus">-  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal} ${AppVersion}&quot;</span>
<a href="#l4.441"></a><span id="l4.441" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;GeckoVer&quot; &quot;${GREVersion}&quot; 0</span>
<a href="#l4.442"></a><span id="l4.442" class="difflineminus">-</span>
<a href="#l4.443"></a><span id="l4.443" class="difflineminus">-  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal}&quot;</span>
<a href="#l4.444"></a><span id="l4.444" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;&quot; &quot;${GREVersion}&quot; 0</span>
<a href="#l4.445"></a><span id="l4.445" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;CurrentVersion&quot; &quot;${AppVersion} (${AB_CD})&quot; 0</span>
<a href="#l4.446"></a><span id="l4.446" class="difflineminus">-</span>
<a href="#l4.447"></a><span id="l4.447" class="difflineminus">-  ; XXXrstrong - Add registry values for HKLM\Software\Clients\Calendar here.</span>
<a href="#l4.448"></a><span id="l4.448" class="difflineminus">-  ; See Thunderbird's installer.nsi for an example.</span>
<a href="#l4.449"></a><span id="l4.449" class="difflineplus">+    ; If we are writing to HKLM and create the quick launch and the desktop</span>
<a href="#l4.450"></a><span id="l4.450" class="difflineplus">+    ; shortcuts set IconsVisible to 1 otherwise to 0.</span>
<a href="#l4.451"></a><span id="l4.451" class="difflineplus">+    ${StrFilter} &quot;${FileMainEXE}&quot; &quot;+&quot; &quot;&quot; &quot;&quot; $R9</span>
<a href="#l4.452"></a><span id="l4.452" class="difflineplus">+    StrCpy $0 &quot;Software\Clients\StartMenuInternet\$R9\InstallInfo&quot;</span>
<a href="#l4.453"></a><span id="l4.453" class="difflineplus">+    ${If} $AddQuickLaunchSC == 1</span>
<a href="#l4.454"></a><span id="l4.454" class="difflineplus">+    ${OrIf} $AddDesktopSC == 1</span>
<a href="#l4.455"></a><span id="l4.455" class="difflineplus">+      WriteRegDWORD HKLM &quot;$0&quot; &quot;IconsVisible&quot; 1</span>
<a href="#l4.456"></a><span id="l4.456" class="difflineplus">+    ${Else}</span>
<a href="#l4.457"></a><span id="l4.457" class="difflineplus">+      WriteRegDWORD HKLM &quot;$0&quot; &quot;IconsVisible&quot; 0</span>
<a href="#l4.458"></a><span id="l4.458" class="difflineplus">+    ${EndIf}</span>
<a href="#l4.459"></a><span id="l4.459" class="difflineplus">+  ${EndIf}</span>
<a href="#l4.460"></a><span id="l4.460"> </span>
<a href="#l4.461"></a><span id="l4.461">   ; These need special handling on uninstall since they may be overwritten by</span>
<a href="#l4.462"></a><span id="l4.462">   ; an install into a different location.</span>
<a href="#l4.463"></a><span id="l4.463">   StrCpy $0 &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\${FileMainEXE}&quot;</span>
<a href="#l4.464"></a><span id="l4.464">   ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;&quot; &quot;$INSTDIR\${FileMainEXE}&quot; 0</span>
<a href="#l4.465"></a><span id="l4.465">   ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Path&quot; &quot;$INSTDIR&quot; 0</span>
<a href="#l4.466"></a><span id="l4.466"> </span>
<a href="#l4.467"></a><span id="l4.467" class="difflineminus">-  ; Write the uninstall registry keys</span>
<a href="#l4.468"></a><span id="l4.468" class="difflineminus">-  StrCpy $0 &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${BrandFullNameInternal} (${AppVersion})&quot;</span>
<a href="#l4.469"></a><span id="l4.469" class="difflineminus">-  StrCpy $1 &quot;$INSTDIR\uninstall\uninst.exe&quot;</span>
<a href="#l4.470"></a><span id="l4.470" class="difflineminus">-</span>
<a href="#l4.471"></a><span id="l4.471" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Comments&quot; &quot;${BrandFullNameInternal}&quot; 0</span>
<a href="#l4.472"></a><span id="l4.472" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;DisplayIcon&quot; &quot;$INSTDIR\${FileMainEXE},0&quot; 0</span>
<a href="#l4.473"></a><span id="l4.473" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;DisplayName&quot; &quot;${BrandFullNameInternal} (${AppVersion})&quot; 0</span>
<a href="#l4.474"></a><span id="l4.474" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;DisplayVersion&quot; &quot;${AppVersion} (${AB_CD})&quot; 0</span>
<a href="#l4.475"></a><span id="l4.475" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;InstallLocation&quot; &quot;$INSTDIR&quot; 0</span>
<a href="#l4.476"></a><span id="l4.476" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Publisher&quot; &quot;Mozilla&quot; 0</span>
<a href="#l4.477"></a><span id="l4.477" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;UninstallString&quot; &quot;$1&quot; 0</span>
<a href="#l4.478"></a><span id="l4.478" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;URLInfoAbout&quot; &quot;${URLInfoAbout}&quot; 0</span>
<a href="#l4.479"></a><span id="l4.479" class="difflineminus">-  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;URLUpdateInfo&quot; &quot;${URLUpdateInfo}&quot; 0</span>
<a href="#l4.480"></a><span id="l4.480" class="difflineminus">-  ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;NoModify&quot; 1 0</span>
<a href="#l4.481"></a><span id="l4.481" class="difflineminus">-  ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;NoRepair&quot; 1 0</span>
<a href="#l4.482"></a><span id="l4.482">   !insertmacro MUI_STARTMENU_WRITE_BEGIN Application</span>
<a href="#l4.483"></a><span id="l4.483"> </span>
<a href="#l4.484"></a><span id="l4.484">   ; Create Start Menu shortcuts</span>
<a href="#l4.485"></a><span id="l4.485">   ${LogHeader} &quot;Adding Shortcuts&quot;</span>
<a href="#l4.486"></a><span id="l4.486">   ${If} $AddStartMenuSC == 1</span>
<a href="#l4.487"></a><span id="l4.487" class="difflineminus">-    CreateDirectory &quot;$SMPROGRAMS\$StartMenuDir&quot;</span>
<a href="#l4.488"></a><span id="l4.488" class="difflineplus">+    ${Unless} ${FileExists} &quot;$SMPROGRAMS\$StartMenuDir&quot;</span>
<a href="#l4.489"></a><span id="l4.489" class="difflineplus">+      CreateDirectory &quot;$SMPROGRAMS\$StartMenuDir&quot;</span>
<a href="#l4.490"></a><span id="l4.490" class="difflineplus">+      ${LogMsg} &quot;Added Start Menu Directory: $SMPROGRAMS\$StartMenuDir&quot;</span>
<a href="#l4.491"></a><span id="l4.491" class="difflineplus">+    ${EndUnless}</span>
<a href="#l4.492"></a><span id="l4.492">     CreateShortCut &quot;$SMPROGRAMS\$StartMenuDir\${BrandFullNameInternal}.lnk&quot; &quot;$INSTDIR\${FileMainEXE}&quot; &quot;&quot; &quot;$INSTDIR\${FileMainEXE}&quot; 0</span>
<a href="#l4.493"></a><span id="l4.493">     ${LogUninstall} &quot;File: $SMPROGRAMS\$StartMenuDir\${BrandFullNameInternal}.lnk&quot;</span>
<a href="#l4.494"></a><span id="l4.494" class="difflineplus">+    ${LogMsg} &quot;Added Shortcut: $SMPROGRAMS\$StartMenuDir\${BrandFullNameInternal}.lnk&quot;</span>
<a href="#l4.495"></a><span id="l4.495">     CreateShortCut &quot;$SMPROGRAMS\$StartMenuDir\${BrandFullNameInternal} ($(SAFE_MODE)).lnk&quot; &quot;$INSTDIR\${FileMainEXE}&quot; &quot;-safe-mode&quot; &quot;$INSTDIR\${FileMainEXE}&quot; 0</span>
<a href="#l4.496"></a><span id="l4.496">     ${LogUninstall} &quot;File: $SMPROGRAMS\$StartMenuDir\${BrandFullNameInternal} ($(SAFE_MODE)).lnk&quot;</span>
<a href="#l4.497"></a><span id="l4.497" class="difflineplus">+    ${LogMsg} &quot;Added Shortcut: $SMPROGRAMS\$StartMenuDir\${BrandFullNameInternal} ($(SAFE_MODE)).lnk&quot;</span>
<a href="#l4.498"></a><span id="l4.498">   ${EndIf}</span>
<a href="#l4.499"></a><span id="l4.499"> </span>
<a href="#l4.500"></a><span id="l4.500">   ; perhaps use the uninstall keys</span>
<a href="#l4.501"></a><span id="l4.501">   ${If} $AddQuickLaunchSC == 1</span>
<a href="#l4.502"></a><span id="l4.502">     CreateShortCut &quot;$QUICKLAUNCH\${BrandFullName}.lnk&quot; &quot;$INSTDIR\${FileMainEXE}&quot; &quot;&quot; &quot;$INSTDIR\${FileMainEXE}&quot; 0</span>
<a href="#l4.503"></a><span id="l4.503">     ${LogUninstall} &quot;File: $QUICKLAUNCH\${BrandFullName}.lnk&quot;</span>
<a href="#l4.504"></a><span id="l4.504" class="difflineplus">+    ${LogMsg} &quot;Added Shortcut: $QUICKLAUNCH\${BrandFullName}.lnk&quot;</span>
<a href="#l4.505"></a><span id="l4.505">   ${EndIf}</span>
<a href="#l4.506"></a><span id="l4.506"> </span>
<a href="#l4.507"></a><span id="l4.507" class="difflineminus">-  ${LogHeader} &quot;Updating Quick Launch Shortcuts&quot;</span>
<a href="#l4.508"></a><span id="l4.508">   ${If} $AddDesktopSC == 1</span>
<a href="#l4.509"></a><span id="l4.509">     CreateShortCut &quot;$DESKTOP\${BrandFullName}.lnk&quot; &quot;$INSTDIR\${FileMainEXE}&quot; &quot;&quot; &quot;$INSTDIR\${FileMainEXE}&quot; 0</span>
<a href="#l4.510"></a><span id="l4.510">     ${LogUninstall} &quot;File: $DESKTOP\${BrandFullName}.lnk&quot;</span>
<a href="#l4.511"></a><span id="l4.511" class="difflineplus">+    ${LogMsg} &quot;Added Shortcut: $DESKTOP\${BrandFullName}.lnk&quot;</span>
<a href="#l4.512"></a><span id="l4.512">   ${EndIf}</span>
<a href="#l4.513"></a><span id="l4.513"> </span>
<a href="#l4.514"></a><span id="l4.514">   !insertmacro MUI_STARTMENU_WRITE_END</span>
<a href="#l4.515"></a><span id="l4.515" class="difflineplus">+SectionEnd</span>
<a href="#l4.516"></a><span id="l4.516" class="difflineplus">+</span>
<a href="#l4.517"></a><span id="l4.517" class="difflineplus">+; Cleanup operations to perform at the end of the installation.</span>
<a href="#l4.518"></a><span id="l4.518" class="difflineplus">+Section &quot;-InstallEndCleanup&quot;</span>
<a href="#l4.519"></a><span id="l4.519" class="difflineplus">+  SetDetailsPrint both</span>
<a href="#l4.520"></a><span id="l4.520" class="difflineplus">+  DetailPrint &quot;$(STATUS_CLEANUP)&quot;</span>
<a href="#l4.521"></a><span id="l4.521" class="difflineplus">+  SetDetailsPrint none</span>
<a href="#l4.522"></a><span id="l4.522" class="difflineplus">+</span>
<a href="#l4.523"></a><span id="l4.523" class="difflineplus">+  ${LogHeader} &quot;Updating Uninstall Log With Previous Uninstall Log&quot;</span>
<a href="#l4.524"></a><span id="l4.524"> </span>
<a href="#l4.525"></a><span id="l4.525">   ; Refresh desktop icons</span>
<a href="#l4.526"></a><span id="l4.526">   System::Call &quot;shell32::SHChangeNotify(i, i, i, i) v (0x08000000, 0, 0, 0)&quot;</span>
<a href="#l4.527"></a><span id="l4.527" class="difflineminus">-SectionEnd</span>
<a href="#l4.528"></a><span id="l4.528" class="difflineplus">+</span>
<a href="#l4.529"></a><span id="l4.529" class="difflineplus">+  ${InstallEndCleanupCommon}</span>
<a href="#l4.530"></a><span id="l4.530" class="difflineplus">+</span>
<a href="#l4.531"></a><span id="l4.531" class="difflineplus">+  ; If we have to reboot give SHChangeNotify time to finish the refreshing</span>
<a href="#l4.532"></a><span id="l4.532" class="difflineplus">+  ; the icons so the OS doesn't display the icons from helper.exe</span>
<a href="#l4.533"></a><span id="l4.533" class="difflineplus">+  ${If} ${RebootFlag}</span>
<a href="#l4.534"></a><span id="l4.534" class="difflineplus">+    Sleep 10000</span>
<a href="#l4.535"></a><span id="l4.535" class="difflineplus">+    ${LogHeader} &quot;Reboot Required To Finish Installation&quot;</span>
<a href="#l4.536"></a><span id="l4.536" class="difflineplus">+    ; ${FileMainEXE}.moz-upgrade should never exist but just in case...</span>
<a href="#l4.537"></a><span id="l4.537" class="difflineplus">+    ${Unless} ${FileExists} &quot;$INSTDIR\${FileMainEXE}.moz-upgrade&quot;</span>
<a href="#l4.538"></a><span id="l4.538" class="difflineplus">+      Rename &quot;$INSTDIR\${FileMainEXE}&quot; &quot;$INSTDIR\${FileMainEXE}.moz-upgrade&quot;</span>
<a href="#l4.539"></a><span id="l4.539" class="difflineplus">+    ${EndUnless}</span>
<a href="#l4.540"></a><span id="l4.540"> </span>
<a href="#l4.541"></a><span id="l4.541" class="difflineminus">-Section /o &quot;Developer Tools&quot; Section2</span>
<a href="#l4.542"></a><span id="l4.542" class="difflineminus">-  Call installInspector</span>
<a href="#l4.543"></a><span id="l4.543" class="difflineplus">+    ${If} ${FileExists} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.544"></a><span id="l4.544" class="difflineplus">+      ClearErrors</span>
<a href="#l4.545"></a><span id="l4.545" class="difflineplus">+      Rename &quot;$INSTDIR\${FileMainEXE}&quot; &quot;$INSTDIR\${FileMainEXE}.moz-delete&quot;</span>
<a href="#l4.546"></a><span id="l4.546" class="difflineplus">+      ${Unless} ${Errors}</span>
<a href="#l4.547"></a><span id="l4.547" class="difflineplus">+        Delete /REBOOTOK &quot;$INSTDIR\${FileMainEXE}.moz-delete&quot;</span>
<a href="#l4.548"></a><span id="l4.548" class="difflineplus">+      ${EndUnless}</span>
<a href="#l4.549"></a><span id="l4.549" class="difflineplus">+    ${EndUnless}</span>
<a href="#l4.550"></a><span id="l4.550" class="difflineplus">+</span>
<a href="#l4.551"></a><span id="l4.551" class="difflineplus">+    ${Unless} ${FileExists} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.552"></a><span id="l4.552" class="difflineplus">+      CopyFiles /SILENT &quot;$INSTDIR\uninstall\helper.exe&quot; &quot;$INSTDIR&quot;</span>
<a href="#l4.553"></a><span id="l4.553" class="difflineplus">+      FileOpen $0 &quot;$INSTDIR\${FileMainEXE}&quot; w</span>
<a href="#l4.554"></a><span id="l4.554" class="difflineplus">+      FileWrite $0 &quot;Will be deleted on restart&quot;</span>
<a href="#l4.555"></a><span id="l4.555" class="difflineplus">+      Rename /REBOOTOK &quot;$INSTDIR\${FileMainEXE}.moz-upgrade&quot; &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.556"></a><span id="l4.556" class="difflineplus">+      FileClose $0</span>
<a href="#l4.557"></a><span id="l4.557" class="difflineplus">+      Delete &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.558"></a><span id="l4.558" class="difflineplus">+      Rename &quot;$INSTDIR\helper.exe&quot; &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.559"></a><span id="l4.559" class="difflineplus">+    ${EndUnless}</span>
<a href="#l4.560"></a><span id="l4.560" class="difflineplus">+  ${EndIf}</span>
<a href="#l4.561"></a><span id="l4.561"> SectionEnd</span>
<a href="#l4.562"></a><span id="l4.562"> </span>
<a href="#l4.563"></a><span id="l4.563"> ################################################################################</span>
<a href="#l4.564"></a><span id="l4.564"> # Helper Functions</span>
<a href="#l4.565"></a><span id="l4.565"> </span>
<a href="#l4.566"></a><span id="l4.566" class="difflineminus">-Function installInspector</span>
<a href="#l4.567"></a><span id="l4.567" class="difflineminus">-  ${If} ${FileExists} &quot;$EXEDIR\optional\extensions\inspector@mozilla.org&quot;</span>
<a href="#l4.568"></a><span id="l4.568" class="difflineminus">-    SetDetailsPrint textonly</span>
<a href="#l4.569"></a><span id="l4.569" class="difflineminus">-    DetailPrint $(STATUS_INSTALL_OPTIONAL)</span>
<a href="#l4.570"></a><span id="l4.570" class="difflineminus">-    SetDetailsPrint none</span>
<a href="#l4.571"></a><span id="l4.571" class="difflineminus">-    ${RemoveDir} &quot;$INSTDIR\extensions\inspector@mozilla.org&quot;</span>
<a href="#l4.572"></a><span id="l4.572" class="difflineminus">-    ClearErrors</span>
<a href="#l4.573"></a><span id="l4.573" class="difflineminus">-    ${LogHeader} &quot;Installing Developer Tools&quot;</span>
<a href="#l4.574"></a><span id="l4.574" class="difflineminus">-    StrCpy $R0 &quot;$EXEDIR\optional\extensions\inspector@mozilla.org&quot;</span>
<a href="#l4.575"></a><span id="l4.575" class="difflineminus">-    StrCpy $R1 &quot;$INSTDIR\extensions\inspector@mozilla.org&quot;</span>
<a href="#l4.576"></a><span id="l4.576" class="difflineminus">-    Call DoCopyFiles</span>
<a href="#l4.577"></a><span id="l4.577" class="difflineminus">-  ${EndIf}</span>
<a href="#l4.578"></a><span id="l4.578" class="difflineminus">-FunctionEnd</span>
<a href="#l4.579"></a><span id="l4.579" class="difflineplus">+Function CheckExistingInstall</span>
<a href="#l4.580"></a><span id="l4.580" class="difflineplus">+  ; If there is a pending file copy from a previous uninstall don't allow</span>
<a href="#l4.581"></a><span id="l4.581" class="difflineplus">+  ; installing until after the system has rebooted.</span>
<a href="#l4.582"></a><span id="l4.582" class="difflineplus">+  IfFileExists &quot;$INSTDIR\${FileMainEXE}.moz-upgrade&quot; +1 +4</span>
<a href="#l4.583"></a><span id="l4.583" class="difflineplus">+  MessageBox MB_YESNO &quot;$(WARN_RESTART_REQUIRED_UPGRADE)&quot; IDNO +2</span>
<a href="#l4.584"></a><span id="l4.584" class="difflineplus">+  Reboot</span>
<a href="#l4.585"></a><span id="l4.585" class="difflineplus">+  Quit</span>
<a href="#l4.586"></a><span id="l4.586" class="difflineplus">+</span>
<a href="#l4.587"></a><span id="l4.587" class="difflineplus">+  ; If there is a pending file deletion from a previous uninstall don't allow</span>
<a href="#l4.588"></a><span id="l4.588" class="difflineplus">+  ; installing until after the system has rebooted.</span>
<a href="#l4.589"></a><span id="l4.589" class="difflineplus">+  IfFileExists &quot;$INSTDIR\${FileMainEXE}.moz-delete&quot; +1 +4</span>
<a href="#l4.590"></a><span id="l4.590" class="difflineplus">+  MessageBox MB_YESNO &quot;$(WARN_RESTART_REQUIRED_UNINSTALL)&quot; IDNO +2</span>
<a href="#l4.591"></a><span id="l4.591" class="difflineplus">+  Reboot</span>
<a href="#l4.592"></a><span id="l4.592" class="difflineplus">+  Quit</span>
<a href="#l4.593"></a><span id="l4.593" class="difflineplus">+</span>
<a href="#l4.594"></a><span id="l4.594" class="difflineplus">+  ${If} ${FileExists} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.595"></a><span id="l4.595" class="difflineplus">+    Banner::show /NOUNLOAD &quot;$(BANNER_CHECK_EXISTING)&quot;</span>
<a href="#l4.596"></a><span id="l4.596"> </span>
<a href="#l4.597"></a><span id="l4.597" class="difflineminus">-; Adds a section divider to the human readable log.</span>
<a href="#l4.598"></a><span id="l4.598" class="difflineminus">-Function WriteLogSeparator</span>
<a href="#l4.599"></a><span id="l4.599" class="difflineminus">-  FileWrite $fhInstallLog &quot;$\r$\n-------------------------------------------------------------------------------$\r$\n&quot;</span>
<a href="#l4.600"></a><span id="l4.600" class="difflineminus">-FunctionEnd</span>
<a href="#l4.601"></a><span id="l4.601" class="difflineplus">+    ${If} &quot;$TmpVal&quot; == &quot;FoundMessageWindow&quot;</span>
<a href="#l4.602"></a><span id="l4.602" class="difflineplus">+      Sleep 5000</span>
<a href="#l4.603"></a><span id="l4.603" class="difflineplus">+    ${EndIf}</span>
<a href="#l4.604"></a><span id="l4.604" class="difflineplus">+</span>
<a href="#l4.605"></a><span id="l4.605" class="difflineplus">+    ${PushFilesToCheck}</span>
<a href="#l4.606"></a><span id="l4.606"> </span>
<a href="#l4.607"></a><span id="l4.607" class="difflineminus">-; Check whether to display the current page (e.g. if we aren't performing a</span>
<a href="#l4.608"></a><span id="l4.608" class="difflineminus">-; custom install don't display the custom pages).</span>
<a href="#l4.609"></a><span id="l4.609" class="difflineminus">-Function CheckCustom</span>
<a href="#l4.610"></a><span id="l4.610" class="difflineminus">-  ${If} $InstallType != 4</span>
<a href="#l4.611"></a><span id="l4.611" class="difflineminus">-    Abort</span>
<a href="#l4.612"></a><span id="l4.612" class="difflineplus">+    ; Store the return value in $TmpVal so it is less likely to be accidentally</span>
<a href="#l4.613"></a><span id="l4.613" class="difflineplus">+    ; overwritten elsewhere.</span>
<a href="#l4.614"></a><span id="l4.614" class="difflineplus">+    ${CheckForFilesInUse} $TmpVal</span>
<a href="#l4.615"></a><span id="l4.615" class="difflineplus">+</span>
<a href="#l4.616"></a><span id="l4.616" class="difflineplus">+    Banner::destroy</span>
<a href="#l4.617"></a><span id="l4.617" class="difflineplus">+</span>
<a href="#l4.618"></a><span id="l4.618" class="difflineplus">+    ${If} &quot;$TmpVal&quot; == &quot;true&quot;</span>
<a href="#l4.619"></a><span id="l4.619" class="difflineplus">+      StrCpy $TmpVal &quot;FoundMessageWindow&quot;</span>
<a href="#l4.620"></a><span id="l4.620" class="difflineplus">+      ${ManualCloseAppPrompt} &quot;${WindowClass}&quot; &quot;$(WARN_MANUALLY_CLOSE_APP_INSTALL)&quot;</span>
<a href="#l4.621"></a><span id="l4.621" class="difflineplus">+      StrCpy $TmpVal &quot;true&quot;</span>
<a href="#l4.622"></a><span id="l4.622" class="difflineplus">+    ${EndIf}</span>
<a href="#l4.623"></a><span id="l4.623">   ${EndIf}</span>
<a href="#l4.624"></a><span id="l4.624"> FunctionEnd</span>
<a href="#l4.625"></a><span id="l4.625"> </span>
<a href="#l4.626"></a><span id="l4.626" class="difflineminus">-Function onInstallDeleteFile</span>
<a href="#l4.627"></a><span id="l4.627" class="difflineminus">-  ${TrimNewLines} &quot;$R9&quot; &quot;$R9&quot;</span>
<a href="#l4.628"></a><span id="l4.628" class="difflineminus">-  StrCpy $R1 &quot;$R9&quot; 5</span>
<a href="#l4.629"></a><span id="l4.629" class="difflineminus">-  ${If} $R1 == &quot;File:&quot;</span>
<a href="#l4.630"></a><span id="l4.630" class="difflineminus">-    StrCpy $R9 &quot;$R9&quot; &quot;&quot; 6</span>
<a href="#l4.631"></a><span id="l4.631" class="difflineminus">-    ${If} ${FileExists} &quot;$INSTDIR$R9&quot;</span>
<a href="#l4.632"></a><span id="l4.632" class="difflineminus">-      ClearErrors</span>
<a href="#l4.633"></a><span id="l4.633" class="difflineminus">-      Delete &quot;$INSTDIR$R9&quot;</span>
<a href="#l4.634"></a><span id="l4.634" class="difflineminus">-      ${If} ${Errors}</span>
<a href="#l4.635"></a><span id="l4.635" class="difflineminus">-        ${LogMsg} &quot;** ERROR Deleting File: $INSTDIR$R9 **&quot;</span>
<a href="#l4.636"></a><span id="l4.636" class="difflineminus">-      ${Else}</span>
<a href="#l4.637"></a><span id="l4.637" class="difflineminus">-        ${LogMsg} &quot;Deleted File: $INSTDIR$R9&quot;</span>
<a href="#l4.638"></a><span id="l4.638" class="difflineminus">-      ${EndIf}</span>
<a href="#l4.639"></a><span id="l4.639" class="difflineminus">-    ${EndIf}</span>
<a href="#l4.640"></a><span id="l4.640" class="difflineminus">-  ${EndIf}</span>
<a href="#l4.641"></a><span id="l4.641" class="difflineplus">+Function LaunchApp</span>
<a href="#l4.642"></a><span id="l4.642">   ClearErrors</span>
<a href="#l4.643"></a><span id="l4.643" class="difflineminus">-  Push 0</span>
<a href="#l4.644"></a><span id="l4.644" class="difflineminus">-FunctionEnd</span>
<a href="#l4.645"></a><span id="l4.645" class="difflineminus">-</span>
<a href="#l4.646"></a><span id="l4.646" class="difflineminus">-; The previous installer removed directories even when they aren't empty so this</span>
<a href="#l4.647"></a><span id="l4.647" class="difflineminus">-; function does as well.</span>
<a href="#l4.648"></a><span id="l4.648" class="difflineminus">-Function onInstallRemoveDir</span>
<a href="#l4.649"></a><span id="l4.649" class="difflineminus">-  ${TrimNewLines} &quot;$R9&quot; &quot;$R9&quot;</span>
<a href="#l4.650"></a><span id="l4.650" class="difflineminus">-  StrCpy $R1 &quot;$R9&quot; 4</span>
<a href="#l4.651"></a><span id="l4.651" class="difflineminus">-  ${If} $R1 == &quot;Dir:&quot;</span>
<a href="#l4.652"></a><span id="l4.652" class="difflineminus">-    StrCpy $R9 &quot;$R9&quot; &quot;&quot; 5</span>
<a href="#l4.653"></a><span id="l4.653" class="difflineminus">-    StrCpy $R1 &quot;$R9&quot; &quot;&quot; -1</span>
<a href="#l4.654"></a><span id="l4.654" class="difflineminus">-    ${If} $R1 == &quot;\&quot;</span>
<a href="#l4.655"></a><span id="l4.655" class="difflineminus">-      StrCpy $R9 &quot;$R9&quot; -1</span>
<a href="#l4.656"></a><span id="l4.656" class="difflineminus">-    ${EndIf}</span>
<a href="#l4.657"></a><span id="l4.657" class="difflineminus">-    ${If} ${FileExists} &quot;$INSTDIR$R9&quot;</span>
<a href="#l4.658"></a><span id="l4.658" class="difflineminus">-      ClearErrors</span>
<a href="#l4.659"></a><span id="l4.659" class="difflineminus">-      RmDir /r &quot;$INSTDIR$R9&quot;</span>
<a href="#l4.660"></a><span id="l4.660" class="difflineminus">-      ${If} ${Errors}</span>
<a href="#l4.661"></a><span id="l4.661" class="difflineminus">-        ${LogMsg} &quot;** ERROR Removing Directory: $INSTDIR$R9 **&quot;</span>
<a href="#l4.662"></a><span id="l4.662" class="difflineminus">-      ${Else}</span>
<a href="#l4.663"></a><span id="l4.663" class="difflineminus">-        ${LogMsg} &quot;Removed Directory: $INSTDIR$R9&quot;</span>
<a href="#l4.664"></a><span id="l4.664" class="difflineminus">-      ${EndIf}</span>
<a href="#l4.665"></a><span id="l4.665" class="difflineminus">-    ${EndIf}</span>
<a href="#l4.666"></a><span id="l4.666" class="difflineplus">+  ${GetParameters} $0</span>
<a href="#l4.667"></a><span id="l4.667" class="difflineplus">+  ${GetOptions} &quot;$0&quot; &quot;/UAC:&quot; $1</span>
<a href="#l4.668"></a><span id="l4.668" class="difflineplus">+  ${If} ${Errors}</span>
<a href="#l4.669"></a><span id="l4.669" class="difflineplus">+    ${ManualCloseAppPrompt} &quot;${WindowClass}&quot; &quot;$(WARN_MANUALLY_CLOSE_APP_LAUNCH)&quot;</span>
<a href="#l4.670"></a><span id="l4.670" class="difflineplus">+    Exec &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.671"></a><span id="l4.671" class="difflineplus">+  ${Else}</span>
<a href="#l4.672"></a><span id="l4.672" class="difflineplus">+    GetFunctionAddress $0 LaunchAppFromElevatedProcess</span>
<a href="#l4.673"></a><span id="l4.673" class="difflineplus">+    UAC::ExecCodeSegment $0</span>
<a href="#l4.674"></a><span id="l4.674">   ${EndIf}</span>
<a href="#l4.675"></a><span id="l4.675" class="difflineminus">-  ClearErrors</span>
<a href="#l4.676"></a><span id="l4.676" class="difflineminus">-  Push 0</span>
<a href="#l4.677"></a><span id="l4.677" class="difflineminus">-FunctionEnd</span>
<a href="#l4.678"></a><span id="l4.678" class="difflineminus">-</span>
<a href="#l4.679"></a><span id="l4.679" class="difflineminus">-Function GetDiff</span>
<a href="#l4.680"></a><span id="l4.680" class="difflineminus">-  ${TrimNewLines} &quot;$9&quot; &quot;$9&quot;</span>
<a href="#l4.681"></a><span id="l4.681" class="difflineminus">-  ${If} $9 != &quot;&quot;</span>
<a href="#l4.682"></a><span id="l4.682" class="difflineminus">-    FileWrite $R3 &quot;$9$\r$\n&quot;</span>
<a href="#l4.683"></a><span id="l4.683" class="difflineminus">-    ${LogMsg} &quot;Added To Uninstall Log: $9&quot;</span>
<a href="#l4.684"></a><span id="l4.684" class="difflineminus">-  ${EndIf}</span>
<a href="#l4.685"></a><span id="l4.685" class="difflineminus">-  Push 0</span>
<a href="#l4.686"></a><span id="l4.686" class="difflineminus">-FunctionEnd</span>
<a href="#l4.687"></a><span id="l4.687" class="difflineminus">-</span>
<a href="#l4.688"></a><span id="l4.688" class="difflineminus">-Function DoCopyFiles</span>
<a href="#l4.689"></a><span id="l4.689" class="difflineminus">-  StrLen $R2 $R0</span>
<a href="#l4.690"></a><span id="l4.690" class="difflineminus">-  ${LocateNoDetails} &quot;$R0&quot; &quot;/L=FD&quot; &quot;CopyFile&quot;</span>
<a href="#l4.691"></a><span id="l4.691"> FunctionEnd</span>
<a href="#l4.692"></a><span id="l4.692"> </span>
<a href="#l4.693"></a><span id="l4.693" class="difflineminus">-Function CopyFile</span>
<a href="#l4.694"></a><span id="l4.694" class="difflineminus">-  StrCpy $R3 $R8 &quot;&quot; $R2</span>
<a href="#l4.695"></a><span id="l4.695" class="difflineminus">-  ${If} $R6 ==  &quot;&quot;</span>
<a href="#l4.696"></a><span id="l4.696" class="difflineminus">-    ${Unless} ${FileExists} &quot;$R1$R3\$R7&quot;</span>
<a href="#l4.697"></a><span id="l4.697" class="difflineminus">-      ClearErrors</span>
<a href="#l4.698"></a><span id="l4.698" class="difflineminus">-      CreateDirectory &quot;$R1$R3\$R7&quot;</span>
<a href="#l4.699"></a><span id="l4.699" class="difflineminus">-      ${If} ${Errors}</span>
<a href="#l4.700"></a><span id="l4.700" class="difflineminus">-        ${LogMsg}  &quot;** ERROR Creating Directory: $R1$R3\$R7 **&quot;</span>
<a href="#l4.701"></a><span id="l4.701" class="difflineminus">-      ${Else}</span>
<a href="#l4.702"></a><span id="l4.702" class="difflineminus">-        ${LogMsg}  &quot;Created Directory: $R1$R3\$R7&quot;</span>
<a href="#l4.703"></a><span id="l4.703" class="difflineminus">-      ${EndIf}</span>
<a href="#l4.704"></a><span id="l4.704" class="difflineminus">-    ${EndUnless}</span>
<a href="#l4.705"></a><span id="l4.705" class="difflineminus">-  ${Else}</span>
<a href="#l4.706"></a><span id="l4.706" class="difflineminus">-    ${Unless} ${FileExists} &quot;$R1$R3&quot;</span>
<a href="#l4.707"></a><span id="l4.707" class="difflineminus">-      ClearErrors</span>
<a href="#l4.708"></a><span id="l4.708" class="difflineminus">-      CreateDirectory &quot;$R1$R3&quot;</span>
<a href="#l4.709"></a><span id="l4.709" class="difflineminus">-      ${If} ${Errors}</span>
<a href="#l4.710"></a><span id="l4.710" class="difflineminus">-        ${LogMsg}  &quot;** ERROR Creating Directory: $R1$R3 **&quot;</span>
<a href="#l4.711"></a><span id="l4.711" class="difflineminus">-      ${Else}</span>
<a href="#l4.712"></a><span id="l4.712" class="difflineminus">-        ${LogMsg}  &quot;Created Directory: $R1$R3&quot;</span>
<a href="#l4.713"></a><span id="l4.713" class="difflineminus">-      ${EndIf}</span>
<a href="#l4.714"></a><span id="l4.714" class="difflineminus">-    ${EndUnless}</span>
<a href="#l4.715"></a><span id="l4.715" class="difflineminus">-    ${If} ${FileExists} &quot;$R1$R3\$R7&quot;</span>
<a href="#l4.716"></a><span id="l4.716" class="difflineminus">-      Delete &quot;$R1$R3\$R7&quot;</span>
<a href="#l4.717"></a><span id="l4.717" class="difflineminus">-    ${EndIf}</span>
<a href="#l4.718"></a><span id="l4.718" class="difflineminus">-    ClearErrors</span>
<a href="#l4.719"></a><span id="l4.719" class="difflineminus">-    CopyFiles /SILENT $R9 &quot;$R1$R3&quot;</span>
<a href="#l4.720"></a><span id="l4.720" class="difflineminus">-    ${If} ${Errors}</span>
<a href="#l4.721"></a><span id="l4.721" class="difflineminus">-      ; XXXrstrong - what should we do if there is an error installing a file?</span>
<a href="#l4.722"></a><span id="l4.722" class="difflineminus">-      ${LogMsg} &quot;** ERROR Installing File: $R1$R3\$R7 **&quot;</span>
<a href="#l4.723"></a><span id="l4.723" class="difflineminus">-    ${Else}</span>
<a href="#l4.724"></a><span id="l4.724" class="difflineminus">-      ${LogMsg} &quot;Installed File: $R1$R3\$R7&quot;</span>
<a href="#l4.725"></a><span id="l4.725" class="difflineminus">-    ${EndIf}</span>
<a href="#l4.726"></a><span id="l4.726" class="difflineminus">-    ; If the file is installed into the installation directory remove the</span>
<a href="#l4.727"></a><span id="l4.727" class="difflineminus">-    ; installation directory's path from the file path when writing to the</span>
<a href="#l4.728"></a><span id="l4.728" class="difflineminus">-    ; uninstall.log so it will be a relative path. This allows the same</span>
<a href="#l4.729"></a><span id="l4.729" class="difflineminus">-    ; uninst.exe to be used with zip builds if we supply an uninstall.log.</span>
<a href="#l4.730"></a><span id="l4.730" class="difflineminus">-    ${WordReplace} &quot;$R1$R3\$R7&quot; &quot;$INSTDIR&quot; &quot;&quot; &quot;+&quot; $R3</span>
<a href="#l4.731"></a><span id="l4.731" class="difflineminus">-    ${LogUninstall} &quot;File: $R3&quot;</span>
<a href="#l4.732"></a><span id="l4.732" class="difflineminus">-  ${EndIf}</span>
<a href="#l4.733"></a><span id="l4.733" class="difflineminus">-  Push 0</span>
<a href="#l4.734"></a><span id="l4.734" class="difflineminus">-FunctionEnd</span>
<a href="#l4.735"></a><span id="l4.735" class="difflineminus">-</span>
<a href="#l4.736"></a><span id="l4.736" class="difflineminus">-; Clean up the old log files. We only diff the first two found since it is</span>
<a href="#l4.737"></a><span id="l4.737" class="difflineminus">-; possible for there to be several MB and comparing that many would take a very</span>
<a href="#l4.738"></a><span id="l4.738" class="difflineminus">-; long time to diff.</span>
<a href="#l4.739"></a><span id="l4.739" class="difflineminus">-Function CleanupOldLogs</span>
<a href="#l4.740"></a><span id="l4.740" class="difflineminus">-  FindFirst $0 $TmpVal &quot;$INSTDIR\uninstall\*wizard*&quot;</span>
<a href="#l4.741"></a><span id="l4.741" class="difflineminus">-  StrCmp $TmpVal &quot;&quot; done</span>
<a href="#l4.742"></a><span id="l4.742" class="difflineminus">-  StrCpy $TmpVal &quot;$INSTDIR\uninstall\$TmpVal&quot;</span>
<a href="#l4.743"></a><span id="l4.743" class="difflineminus">-</span>
<a href="#l4.744"></a><span id="l4.744" class="difflineminus">-  FindNext $0 $1</span>
<a href="#l4.745"></a><span id="l4.745" class="difflineminus">-  StrCmp $1 &quot;&quot; cleanup</span>
<a href="#l4.746"></a><span id="l4.746" class="difflineminus">-  StrCpy $1 &quot;$INSTDIR\uninstall\$1&quot;</span>
<a href="#l4.747"></a><span id="l4.747" class="difflineminus">-  Push $1</span>
<a href="#l4.748"></a><span id="l4.748" class="difflineminus">-  Call DiffOldLogFiles</span>
<a href="#l4.749"></a><span id="l4.749" class="difflineminus">-  FindClose $0</span>
<a href="#l4.750"></a><span id="l4.750" class="difflineminus">-  ${DeleteFile} &quot;$1&quot;</span>
<a href="#l4.751"></a><span id="l4.751" class="difflineplus">+Function LaunchAppFromElevatedProcess</span>
<a href="#l4.752"></a><span id="l4.752" class="difflineplus">+  ${ManualCloseAppPrompt} &quot;${WindowClass}&quot; &quot;$(WARN_MANUALLY_CLOSE_APP_LAUNCH)&quot;</span>
<a href="#l4.753"></a><span id="l4.753"> </span>
<a href="#l4.754"></a><span id="l4.754" class="difflineminus">-  cleanup:</span>
<a href="#l4.755"></a><span id="l4.755" class="difflineminus">-    StrCpy $2 &quot;$INSTDIR\uninstall\cleanup.log&quot;</span>
<a href="#l4.756"></a><span id="l4.756" class="difflineminus">-    ${DeleteFile} &quot;$2&quot;</span>
<a href="#l4.757"></a><span id="l4.757" class="difflineminus">-    FileOpen $R2 $2 w</span>
<a href="#l4.758"></a><span id="l4.758" class="difflineminus">-    Push $TmpVal</span>
<a href="#l4.759"></a><span id="l4.759" class="difflineminus">-    ${LineFind} &quot;$INSTDIR\uninstall\$TmpVal&quot; &quot;/NUL&quot; &quot;1:-1&quot; &quot;CleanOldLogFilesCallback&quot;</span>
<a href="#l4.760"></a><span id="l4.760" class="difflineminus">-    ${DeleteFile} &quot;$INSTDIR\uninstall\$TmpVal&quot;</span>
<a href="#l4.761"></a><span id="l4.761" class="difflineminus">-  done:</span>
<a href="#l4.762"></a><span id="l4.762" class="difflineminus">-    FindClose $0</span>
<a href="#l4.763"></a><span id="l4.763" class="difflineminus">-    FileClose $R2</span>
<a href="#l4.764"></a><span id="l4.764" class="difflineminus">-    FileClose $R3</span>
<a href="#l4.765"></a><span id="l4.765" class="difflineminus">-FunctionEnd</span>
<a href="#l4.766"></a><span id="l4.766" class="difflineminus">-</span>
<a href="#l4.767"></a><span id="l4.767" class="difflineminus">-Function DiffOldLogFiles</span>
<a href="#l4.768"></a><span id="l4.768" class="difflineminus">-  StrCpy $R1 &quot;$1&quot;</span>
<a href="#l4.769"></a><span id="l4.769" class="difflineminus">-  GetTempFileName $R2</span>
<a href="#l4.770"></a><span id="l4.770" class="difflineminus">-  FileOpen $R3 $R2 w</span>
<a href="#l4.771"></a><span id="l4.771" class="difflineminus">-  ${TextCompareNoDetails} &quot;$R1&quot; &quot;$TmpVal&quot; &quot;SlowDiff&quot; &quot;GetDiff&quot;</span>
<a href="#l4.772"></a><span id="l4.772" class="difflineminus">-  FileClose $R3</span>
<a href="#l4.773"></a><span id="l4.773" class="difflineminus">-  ${FileJoin} &quot;$TmpVal&quot; &quot;$R2&quot; &quot;$TmpVal&quot;</span>
<a href="#l4.774"></a><span id="l4.774" class="difflineminus">-  ${DeleteFile} &quot;$R2&quot;</span>
<a href="#l4.775"></a><span id="l4.775" class="difflineminus">-FunctionEnd</span>
<a href="#l4.776"></a><span id="l4.776" class="difflineminus">-</span>
<a href="#l4.777"></a><span id="l4.777" class="difflineminus">-Function CleanOldLogFilesCallback</span>
<a href="#l4.778"></a><span id="l4.778" class="difflineminus">-  ${TrimNewLines} &quot;$R9&quot; $R9</span>
<a href="#l4.779"></a><span id="l4.779" class="difflineminus">-  ${WordReplace} &quot;$R9&quot; &quot;$INSTDIR&quot; &quot;&quot; &quot;+&quot; $R3</span>
<a href="#l4.780"></a><span id="l4.780" class="difflineminus">-  ${WordFind} &quot;$R9&quot; &quot;	&quot; &quot;E+1}&quot; $R0</span>
<a href="#l4.781"></a><span id="l4.781" class="difflineminus">-  IfErrors updater 0</span>
<a href="#l4.782"></a><span id="l4.782" class="difflineminus">-</span>
<a href="#l4.783"></a><span id="l4.783" class="difflineminus">-  ${WordFind} &quot;$R0&quot; &quot;Installing: &quot; &quot;E+1}&quot; $R1</span>
<a href="#l4.784"></a><span id="l4.784" class="difflineminus">-  ${Unless} ${Errors}</span>
<a href="#l4.785"></a><span id="l4.785" class="difflineminus">-    FileWrite $R2 &quot;File: $R1$\r$\n&quot;</span>
<a href="#l4.786"></a><span id="l4.786" class="difflineminus">-    GoTo done</span>
<a href="#l4.787"></a><span id="l4.787" class="difflineminus">-  ${EndUnless}</span>
<a href="#l4.788"></a><span id="l4.788" class="difflineminus">-</span>
<a href="#l4.789"></a><span id="l4.789" class="difflineminus">-  ${WordFind} &quot;$R0&quot; &quot;Replacing: &quot; &quot;E+1}&quot; $R1</span>
<a href="#l4.790"></a><span id="l4.790" class="difflineminus">-  ${Unless} ${Errors}</span>
<a href="#l4.791"></a><span id="l4.791" class="difflineminus">-    FileWrite $R2 &quot;File: $R1$\r$\n&quot;</span>
<a href="#l4.792"></a><span id="l4.792" class="difflineminus">-    GoTo done</span>
<a href="#l4.793"></a><span id="l4.793" class="difflineminus">-  ${EndUnless}</span>
<a href="#l4.794"></a><span id="l4.794" class="difflineminus">-</span>
<a href="#l4.795"></a><span id="l4.795" class="difflineminus">-  ${WordFind} &quot;$R0&quot; &quot;Windows Shortcut: &quot; &quot;E+1}&quot; $R1</span>
<a href="#l4.796"></a><span id="l4.796" class="difflineminus">-  ${Unless} ${Errors}</span>
<a href="#l4.797"></a><span id="l4.797" class="difflineminus">-    FileWrite $R2 &quot;File: $R1.lnk$\r$\n&quot;</span>
<a href="#l4.798"></a><span id="l4.798" class="difflineminus">-    GoTo done</span>
<a href="#l4.799"></a><span id="l4.799" class="difflineminus">-  ${EndUnless}</span>
<a href="#l4.800"></a><span id="l4.800" class="difflineminus">-</span>
<a href="#l4.801"></a><span id="l4.801" class="difflineminus">-  ${WordFind} &quot;$R0&quot; &quot;Create Folder: &quot; &quot;E+1}&quot; $R1</span>
<a href="#l4.802"></a><span id="l4.802" class="difflineminus">-  ${Unless} ${Errors}</span>
<a href="#l4.803"></a><span id="l4.803" class="difflineminus">-    FileWrite $R2 &quot;Dir: $R1$\r$\n&quot;</span>
<a href="#l4.804"></a><span id="l4.804" class="difflineminus">-    GoTo done</span>
<a href="#l4.805"></a><span id="l4.805" class="difflineminus">-  ${EndUnless}</span>
<a href="#l4.806"></a><span id="l4.806" class="difflineminus">-</span>
<a href="#l4.807"></a><span id="l4.807" class="difflineminus">-  updater:</span>
<a href="#l4.808"></a><span id="l4.808" class="difflineminus">-    ${WordFind} &quot;$R9&quot; &quot;installing: &quot; &quot;E+1}&quot; $R0</span>
<a href="#l4.809"></a><span id="l4.809" class="difflineminus">-    ${Unless} ${Errors}</span>
<a href="#l4.810"></a><span id="l4.810" class="difflineminus">-      FileWrite $R2 &quot;File: $R0$\r$\n&quot;</span>
<a href="#l4.811"></a><span id="l4.811" class="difflineminus">-    ${EndUnless}</span>
<a href="#l4.812"></a><span id="l4.812" class="difflineminus">-</span>
<a href="#l4.813"></a><span id="l4.813" class="difflineminus">-  done:</span>
<a href="#l4.814"></a><span id="l4.814" class="difflineminus">-    Push 0</span>
<a href="#l4.815"></a><span id="l4.815" class="difflineminus">-FunctionEnd</span>
<a href="#l4.816"></a><span id="l4.816" class="difflineminus">-</span>
<a href="#l4.817"></a><span id="l4.817" class="difflineminus">-Function LaunchApp</span>
<a href="#l4.818"></a><span id="l4.818" class="difflineminus">-  ${CloseApp} &quot;true&quot; $(WARN_APP_RUNNING_INSTALL)</span>
<a href="#l4.819"></a><span id="l4.819" class="difflineminus">-  Exec &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.820"></a><span id="l4.820" class="difflineplus">+  ; Find the installation directory when launching using GetFunctionAddress</span>
<a href="#l4.821"></a><span id="l4.821" class="difflineplus">+  ; from an elevated installer since $INSTDIR will not be set in this installer</span>
<a href="#l4.822"></a><span id="l4.822" class="difflineplus">+  ${StrFilter} &quot;${FileMainEXE}&quot; &quot;+&quot; &quot;&quot; &quot;&quot; $R9</span>
<a href="#l4.823"></a><span id="l4.823" class="difflineplus">+  ReadRegStr $0 HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${BrandFullNameInternal} (${AppVersion})&quot; &quot;DisplayIcon&quot;</span>
<a href="#l4.824"></a><span id="l4.824" class="difflineplus">+  ${GetPathFromString} &quot;$0&quot; $0</span>
<a href="#l4.825"></a><span id="l4.825" class="difflineplus">+  ${GetParent} &quot;$0&quot; $1</span>
<a href="#l4.826"></a><span id="l4.826" class="difflineplus">+  ; Set our current working directory to the application's install directory</span>
<a href="#l4.827"></a><span id="l4.827" class="difflineplus">+  ; otherwise the 7-Zip temp directory will be in use and won't be deleted.</span>
<a href="#l4.828"></a><span id="l4.828" class="difflineplus">+  SetOutPath &quot;$1&quot;</span>
<a href="#l4.829"></a><span id="l4.829" class="difflineplus">+  Exec &quot;$0&quot;</span>
<a href="#l4.830"></a><span id="l4.830"> FunctionEnd</span>
<a href="#l4.831"></a><span id="l4.831"> </span>
<a href="#l4.832"></a><span id="l4.832"> ################################################################################</span>
<a href="#l4.833"></a><span id="l4.833"> # Language</span>
<a href="#l4.834"></a><span id="l4.834"> </span>
<a href="#l4.835"></a><span id="l4.835"> !insertmacro MOZ_MUI_LANGUAGE 'baseLocale'</span>
<a href="#l4.836"></a><span id="l4.836"> !verbose push</span>
<a href="#l4.837"></a><span id="l4.837"> !verbose 3</span>
<a href="#l4.838"></a><span id="l4.838" class="difflineat">@@ -678,259 +504,271 @@ FunctionEnd</span>
<a href="#l4.839"></a><span id="l4.839"> !include &quot;customLocale.nsh&quot;</span>
<a href="#l4.840"></a><span id="l4.840"> !verbose pop</span>
<a href="#l4.841"></a><span id="l4.841"> </span>
<a href="#l4.842"></a><span id="l4.842"> ; Set this after the locale files to override it if it is in the locale</span>
<a href="#l4.843"></a><span id="l4.843"> ; using &quot; &quot; for BrandingText will hide the &quot;Nullsoft Install System...&quot; branding</span>
<a href="#l4.844"></a><span id="l4.844"> BrandingText &quot; &quot;</span>
<a href="#l4.845"></a><span id="l4.845"> </span>
<a href="#l4.846"></a><span id="l4.846"> ################################################################################</span>
<a href="#l4.847"></a><span id="l4.847" class="difflineminus">-# Page pre and leave functions</span>
<a href="#l4.848"></a><span id="l4.848" class="difflineplus">+# Page pre, show, and leave functions</span>
<a href="#l4.849"></a><span id="l4.849" class="difflineplus">+</span>
<a href="#l4.850"></a><span id="l4.850" class="difflineplus">+Function preWelcome</span>
<a href="#l4.851"></a><span id="l4.851" class="difflineplus">+  ${If} ${FileExists} &quot;$EXEDIR\localized\distribution\modern-wizard.bmp&quot;</span>
<a href="#l4.852"></a><span id="l4.852" class="difflineplus">+    Delete &quot;$PLUGINSDIR\modern-wizard.bmp&quot;</span>
<a href="#l4.853"></a><span id="l4.853" class="difflineplus">+    CopyFiles /SILENT &quot;$EXEDIR\localized\distribution\modern-wizard.bmp&quot; &quot;$PLUGINSDIR\modern-wizard.bmp&quot;</span>
<a href="#l4.854"></a><span id="l4.854" class="difflineplus">+  ${EndIf}</span>
<a href="#l4.855"></a><span id="l4.855" class="difflineplus">+FunctionEnd</span>
<a href="#l4.856"></a><span id="l4.856" class="difflineplus">+</span>
<a href="#l4.857"></a><span id="l4.857" class="difflineplus">+Function showLicense</span>
<a href="#l4.858"></a><span id="l4.858" class="difflineplus">+  ${If} ${FileExists} &quot;$EXEDIR\localized\distribution\modern-header.bmp&quot;</span>
<a href="#l4.859"></a><span id="l4.859" class="difflineplus">+  ${AndIf} $hHeaderBitmap == &quot;&quot;</span>
<a href="#l4.860"></a><span id="l4.860" class="difflineplus">+    Delete &quot;$PLUGINSDIR\modern-header.bmp&quot;</span>
<a href="#l4.861"></a><span id="l4.861" class="difflineplus">+    CopyFiles /SILENT &quot;$EXEDIR\localized\distribution\modern-header.bmp&quot; &quot;$PLUGINSDIR\modern-header.bmp&quot;</span>
<a href="#l4.862"></a><span id="l4.862" class="difflineplus">+    ${ChangeMUIHeaderImage} &quot;$PLUGINSDIR\modern-header.bmp&quot;</span>
<a href="#l4.863"></a><span id="l4.863" class="difflineplus">+  ${EndIf}</span>
<a href="#l4.864"></a><span id="l4.864" class="difflineplus">+FunctionEnd</span>
<a href="#l4.865"></a><span id="l4.865"> </span>
<a href="#l4.866"></a><span id="l4.866"> Function preOptions</span>
<a href="#l4.867"></a><span id="l4.867">   !insertmacro MUI_HEADER_TEXT &quot;$(OPTIONS_PAGE_TITLE)&quot; &quot;$(OPTIONS_PAGE_SUBTITLE)&quot;</span>
<a href="#l4.868"></a><span id="l4.868">   !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;options.ini&quot;</span>
<a href="#l4.869"></a><span id="l4.869"> FunctionEnd</span>
<a href="#l4.870"></a><span id="l4.870"> </span>
<a href="#l4.871"></a><span id="l4.871"> Function leaveOptions</span>
<a href="#l4.872"></a><span id="l4.872">   ${MUI_INSTALLOPTIONS_READ} $0 &quot;options.ini&quot; &quot;Settings&quot; &quot;State&quot;</span>
<a href="#l4.873"></a><span id="l4.873">   ${If} $0 != 0</span>
<a href="#l4.874"></a><span id="l4.874">     Abort</span>
<a href="#l4.875"></a><span id="l4.875">   ${EndIf}</span>
<a href="#l4.876"></a><span id="l4.876">   ${MUI_INSTALLOPTIONS_READ} $R0 &quot;options.ini&quot; &quot;Field 2&quot; &quot;State&quot;</span>
<a href="#l4.877"></a><span id="l4.877">   StrCmp $R0 &quot;1&quot; +1 +2</span>
<a href="#l4.878"></a><span id="l4.878" class="difflineminus">-  StrCpy $InstallType &quot;1&quot;</span>
<a href="#l4.879"></a><span id="l4.879" class="difflineplus">+  StrCpy $InstallType ${INSTALLTYPE_BASIC}</span>
<a href="#l4.880"></a><span id="l4.880">   ${MUI_INSTALLOPTIONS_READ} $R0 &quot;options.ini&quot; &quot;Field 3&quot; &quot;State&quot;</span>
<a href="#l4.881"></a><span id="l4.881">   StrCmp $R0 &quot;1&quot; +1 +2</span>
<a href="#l4.882"></a><span id="l4.882" class="difflineminus">-  StrCpy $InstallType &quot;4&quot;</span>
<a href="#l4.883"></a><span id="l4.883" class="difflineminus">-FunctionEnd</span>
<a href="#l4.884"></a><span id="l4.884" class="difflineplus">+  StrCpy $InstallType ${INSTALLTYPE_CUSTOM}</span>
<a href="#l4.885"></a><span id="l4.885" class="difflineplus">+</span>
<a href="#l4.886"></a><span id="l4.886" class="difflineplus">+  ${If} $InstallType != ${INSTALLTYPE_CUSTOM}</span>
<a href="#l4.887"></a><span id="l4.887" class="difflineplus">+!ifndef NO_INSTDIR_FROM_REG</span>
<a href="#l4.888"></a><span id="l4.888" class="difflineplus">+    SetShellVarContext all      ; Set SHCTX to HKLM</span>
<a href="#l4.889"></a><span id="l4.889" class="difflineplus">+    ${GetSingleInstallPath} &quot;Software\Mozilla\${BrandFullNameInternal}&quot; $R9</span>
<a href="#l4.890"></a><span id="l4.890" class="difflineplus">+</span>
<a href="#l4.891"></a><span id="l4.891" class="difflineplus">+    StrCmp &quot;$R9&quot; &quot;false&quot; +1 fix_install_dir</span>
<a href="#l4.892"></a><span id="l4.892"> </span>
<a href="#l4.893"></a><span id="l4.893" class="difflineminus">-Function preComponents</span>
<a href="#l4.894"></a><span id="l4.894" class="difflineminus">-  Call CheckCustom</span>
<a href="#l4.895"></a><span id="l4.895" class="difflineminus">-  ; If DOMi isn't available skip the components page</span>
<a href="#l4.896"></a><span id="l4.896" class="difflineminus">-  ${Unless} ${FileExists} &quot;$EXEDIR\optional\extensions\inspector@mozilla.org&quot;</span>
<a href="#l4.897"></a><span id="l4.897" class="difflineminus">-    Abort</span>
<a href="#l4.898"></a><span id="l4.898" class="difflineminus">-  ${EndUnless}</span>
<a href="#l4.899"></a><span id="l4.899" class="difflineminus">-  !insertmacro MUI_HEADER_TEXT &quot;$(OPTIONAL_COMPONENTS_TITLE)&quot; &quot;$(OPTIONAL_COMPONENTS_SUBTITLE)&quot;</span>
<a href="#l4.900"></a><span id="l4.900" class="difflineminus">-  !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;components.ini&quot;</span>
<a href="#l4.901"></a><span id="l4.901" class="difflineminus">-FunctionEnd</span>
<a href="#l4.902"></a><span id="l4.902" class="difflineplus">+    SetShellVarContext current  ; Set SHCTX to HKCU</span>
<a href="#l4.903"></a><span id="l4.903" class="difflineplus">+    ${GetSingleInstallPath} &quot;Software\Mozilla\${BrandFullNameInternal}&quot; $R9</span>
<a href="#l4.904"></a><span id="l4.904"> </span>
<a href="#l4.905"></a><span id="l4.905" class="difflineminus">-Function leaveComponents</span>
<a href="#l4.906"></a><span id="l4.906" class="difflineminus">-  ${MUI_INSTALLOPTIONS_READ} $R0 &quot;components.ini&quot; &quot;Field 2&quot; &quot;State&quot;</span>
<a href="#l4.907"></a><span id="l4.907" class="difflineminus">-  ; State will be 1 for checked and 0 for unchecked so we can use that to set</span>
<a href="#l4.908"></a><span id="l4.908" class="difflineminus">-  ; the section flags for installation.</span>
<a href="#l4.909"></a><span id="l4.909" class="difflineminus">-  SectionSetFlags ${Section2} $R0</span>
<a href="#l4.910"></a><span id="l4.910" class="difflineplus">+    fix_install_dir:</span>
<a href="#l4.911"></a><span id="l4.911" class="difflineplus">+    StrCmp &quot;$R9&quot; &quot;false&quot; +2 +1</span>
<a href="#l4.912"></a><span id="l4.912" class="difflineplus">+    StrCpy $INSTDIR &quot;$R9&quot;</span>
<a href="#l4.913"></a><span id="l4.913" class="difflineplus">+!endif</span>
<a href="#l4.914"></a><span id="l4.914" class="difflineplus">+</span>
<a href="#l4.915"></a><span id="l4.915" class="difflineplus">+    Call CheckExistingInstall</span>
<a href="#l4.916"></a><span id="l4.916" class="difflineplus">+  ${EndIf}</span>
<a href="#l4.917"></a><span id="l4.917"> FunctionEnd</span>
<a href="#l4.918"></a><span id="l4.918"> </span>
<a href="#l4.919"></a><span id="l4.919"> Function preDirectory</span>
<a href="#l4.920"></a><span id="l4.920" class="difflineminus">-  ${If} $InstallType != 4</span>
<a href="#l4.921"></a><span id="l4.921" class="difflineminus">-    ${CheckDiskSpace} $R9</span>
<a href="#l4.922"></a><span id="l4.922" class="difflineminus">-    ${If} $R9 != &quot;false&quot;</span>
<a href="#l4.923"></a><span id="l4.923" class="difflineminus">-      ${CanWriteToInstallDir} $R9</span>
<a href="#l4.924"></a><span id="l4.924" class="difflineminus">-      ${If} $R9 != &quot;false&quot;</span>
<a href="#l4.925"></a><span id="l4.925" class="difflineminus">-        Abort</span>
<a href="#l4.926"></a><span id="l4.926" class="difflineminus">-      ${EndIf}</span>
<a href="#l4.927"></a><span id="l4.927" class="difflineminus">-    ${EndIf}</span>
<a href="#l4.928"></a><span id="l4.928" class="difflineminus">-  ${EndIf}</span>
<a href="#l4.929"></a><span id="l4.929" class="difflineplus">+  ${PreDirectoryCommon}</span>
<a href="#l4.930"></a><span id="l4.930"> FunctionEnd</span>
<a href="#l4.931"></a><span id="l4.931"> </span>
<a href="#l4.932"></a><span id="l4.932"> Function leaveDirectory</span>
<a href="#l4.933"></a><span id="l4.933" class="difflineminus">-  ${CheckDiskSpace} $R9</span>
<a href="#l4.934"></a><span id="l4.934" class="difflineminus">-  ${If} $R9 == &quot;false&quot;</span>
<a href="#l4.935"></a><span id="l4.935" class="difflineminus">-    MessageBox MB_OK &quot;$(WARN_DISK_SPACE)&quot;</span>
<a href="#l4.936"></a><span id="l4.936" class="difflineminus">-    Abort</span>
<a href="#l4.937"></a><span id="l4.937" class="difflineminus">-  ${EndIf}</span>
<a href="#l4.938"></a><span id="l4.938" class="difflineminus">-</span>
<a href="#l4.939"></a><span id="l4.939" class="difflineminus">-  ${CanWriteToInstallDir} $R9</span>
<a href="#l4.940"></a><span id="l4.940" class="difflineminus">-  ${If} $R9 == &quot;false&quot;</span>
<a href="#l4.941"></a><span id="l4.941" class="difflineminus">-    MessageBox MB_OK &quot;$(WARN_WRITE_ACCESS)&quot;</span>
<a href="#l4.942"></a><span id="l4.942" class="difflineminus">-    Abort</span>
<a href="#l4.943"></a><span id="l4.943" class="difflineminus">-  ${EndIf}</span>
<a href="#l4.944"></a><span id="l4.944" class="difflineplus">+  ${LeaveDirectoryCommon} &quot;$(WARN_DISK_SPACE)&quot; &quot;$(WARN_WRITE_ACCESS)&quot;</span>
<a href="#l4.945"></a><span id="l4.945"> FunctionEnd</span>
<a href="#l4.946"></a><span id="l4.946"> </span>
<a href="#l4.947"></a><span id="l4.947"> Function preShortcuts</span>
<a href="#l4.948"></a><span id="l4.948" class="difflineminus">-  Call CheckCustom</span>
<a href="#l4.949"></a><span id="l4.949" class="difflineplus">+  ${CheckCustomCommon}</span>
<a href="#l4.950"></a><span id="l4.950">   !insertmacro MUI_HEADER_TEXT &quot;$(SHORTCUTS_PAGE_TITLE)&quot; &quot;$(SHORTCUTS_PAGE_SUBTITLE)&quot;</span>
<a href="#l4.951"></a><span id="l4.951">   !insertmacro MUI_INSTALLOPTIONS_DISPLAY &quot;shortcuts.ini&quot;</span>
<a href="#l4.952"></a><span id="l4.952"> FunctionEnd</span>
<a href="#l4.953"></a><span id="l4.953"> </span>
<a href="#l4.954"></a><span id="l4.954"> Function leaveShortcuts</span>
<a href="#l4.955"></a><span id="l4.955">   ${MUI_INSTALLOPTIONS_READ} $0 &quot;shortcuts.ini&quot; &quot;Settings&quot; &quot;State&quot;</span>
<a href="#l4.956"></a><span id="l4.956">   ${If} $0 != 0</span>
<a href="#l4.957"></a><span id="l4.957">     Abort</span>
<a href="#l4.958"></a><span id="l4.958">   ${EndIf}</span>
<a href="#l4.959"></a><span id="l4.959">   ${MUI_INSTALLOPTIONS_READ} $AddDesktopSC &quot;shortcuts.ini&quot; &quot;Field 2&quot; &quot;State&quot;</span>
<a href="#l4.960"></a><span id="l4.960">   ${MUI_INSTALLOPTIONS_READ} $AddStartMenuSC &quot;shortcuts.ini&quot; &quot;Field 3&quot; &quot;State&quot;</span>
<a href="#l4.961"></a><span id="l4.961">   ${MUI_INSTALLOPTIONS_READ} $AddQuickLaunchSC &quot;shortcuts.ini&quot; &quot;Field 4&quot; &quot;State&quot;</span>
<a href="#l4.962"></a><span id="l4.962"> FunctionEnd</span>
<a href="#l4.963"></a><span id="l4.963"> </span>
<a href="#l4.964"></a><span id="l4.964"> Function preStartMenu</span>
<a href="#l4.965"></a><span id="l4.965" class="difflineminus">-  Call CheckCustom</span>
<a href="#l4.966"></a><span id="l4.966" class="difflineplus">+  ${CheckCustomCommon}</span>
<a href="#l4.967"></a><span id="l4.967">   ${If} $AddStartMenuSC != 1</span>
<a href="#l4.968"></a><span id="l4.968">     Abort</span>
<a href="#l4.969"></a><span id="l4.969">   ${EndIf}</span>
<a href="#l4.970"></a><span id="l4.970"> FunctionEnd</span>
<a href="#l4.971"></a><span id="l4.971"> </span>
<a href="#l4.972"></a><span id="l4.972" class="difflineminus">-Function leaveInstFiles</span>
<a href="#l4.973"></a><span id="l4.973" class="difflineminus">-  FileClose $fhUninstallLog</span>
<a href="#l4.974"></a><span id="l4.974" class="difflineminus">-  ; Diff and add missing entries from the previous file log if it exists</span>
<a href="#l4.975"></a><span id="l4.975" class="difflineminus">-  ${If} ${FileExists} &quot;$INSTDIR\uninstall\uninstall.bak&quot;</span>
<a href="#l4.976"></a><span id="l4.976" class="difflineminus">-    SetDetailsPrint textonly</span>
<a href="#l4.977"></a><span id="l4.977" class="difflineminus">-    DetailPrint $(STATUS_CLEANUP)</span>
<a href="#l4.978"></a><span id="l4.978" class="difflineminus">-    SetDetailsPrint none</span>
<a href="#l4.979"></a><span id="l4.979" class="difflineminus">-    ${LogHeader} &quot;Updating Uninstall Log With Previous Uninstall Log&quot;</span>
<a href="#l4.980"></a><span id="l4.980" class="difflineminus">-    StrCpy $R0 &quot;$INSTDIR\uninstall\uninstall.log&quot;</span>
<a href="#l4.981"></a><span id="l4.981" class="difflineminus">-    StrCpy $R1 &quot;$INSTDIR\uninstall\uninstall.bak&quot;</span>
<a href="#l4.982"></a><span id="l4.982" class="difflineminus">-    GetTempFileName $R2</span>
<a href="#l4.983"></a><span id="l4.983" class="difflineminus">-    FileOpen $R3 $R2 w</span>
<a href="#l4.984"></a><span id="l4.984" class="difflineminus">-    ${TextCompareNoDetails} &quot;$R1&quot; &quot;$R0&quot; &quot;SlowDiff&quot; &quot;GetDiff&quot;</span>
<a href="#l4.985"></a><span id="l4.985" class="difflineminus">-    FileClose $R3</span>
<a href="#l4.986"></a><span id="l4.986" class="difflineminus">-    ${Unless} ${Errors}</span>
<a href="#l4.987"></a><span id="l4.987" class="difflineminus">-      ${FileJoin} &quot;$INSTDIR\uninstall\uninstall.log&quot; &quot;$R2&quot; &quot;$INSTDIR\uninstall\uninstall.log&quot;</span>
<a href="#l4.988"></a><span id="l4.988" class="difflineminus">-    ${EndUnless}</span>
<a href="#l4.989"></a><span id="l4.989" class="difflineminus">-    ${DeleteFile} &quot;$INSTDIR\uninstall\uninstall.bak&quot;</span>
<a href="#l4.990"></a><span id="l4.990" class="difflineminus">-    ${DeleteFile} &quot;$R2&quot;</span>
<a href="#l4.991"></a><span id="l4.991" class="difflineplus">+Function leaveStartMenu</span>
<a href="#l4.992"></a><span id="l4.992" class="difflineplus">+  ${If} $InstallType == ${INSTALLTYPE_CUSTOM}</span>
<a href="#l4.993"></a><span id="l4.993" class="difflineplus">+    Call CheckExistingInstall</span>
<a href="#l4.994"></a><span id="l4.994" class="difflineplus">+  ${EndIf}</span>
<a href="#l4.995"></a><span id="l4.995" class="difflineplus">+FunctionEnd</span>
<a href="#l4.996"></a><span id="l4.996" class="difflineplus">+</span>
<a href="#l4.997"></a><span id="l4.997" class="difflineplus">+Function preSummary</span>
<a href="#l4.998"></a><span id="l4.998" class="difflineplus">+  ; Setup the summary.ini file for the Custom Summary Page</span>
<a href="#l4.999"></a><span id="l4.999" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Settings&quot; NumFields &quot;3&quot;</span>
<a href="#l4.1000"></a><span id="l4.1000" class="difflineplus">+</span>
<a href="#l4.1001"></a><span id="l4.1001" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 1&quot; Type   &quot;label&quot;</span>
<a href="#l4.1002"></a><span id="l4.1002" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 1&quot; Text   &quot;$(SUMMARY_INSTALLED_TO)&quot;</span>
<a href="#l4.1003"></a><span id="l4.1003" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 1&quot; Left   &quot;0&quot;</span>
<a href="#l4.1004"></a><span id="l4.1004" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 1&quot; Right  &quot;-1&quot;</span>
<a href="#l4.1005"></a><span id="l4.1005" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 1&quot; Top    &quot;5&quot;</span>
<a href="#l4.1006"></a><span id="l4.1006" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 1&quot; Bottom &quot;15&quot;</span>
<a href="#l4.1007"></a><span id="l4.1007" class="difflineplus">+</span>
<a href="#l4.1008"></a><span id="l4.1008" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 2&quot; Type   &quot;text&quot;</span>
<a href="#l4.1009"></a><span id="l4.1009" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 2&quot; state  &quot;&quot;</span>
<a href="#l4.1010"></a><span id="l4.1010" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 2&quot; Left   &quot;0&quot;</span>
<a href="#l4.1011"></a><span id="l4.1011" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 2&quot; Right  &quot;-1&quot;</span>
<a href="#l4.1012"></a><span id="l4.1012" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 2&quot; Top    &quot;17&quot;</span>
<a href="#l4.1013"></a><span id="l4.1013" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 2&quot; Bottom &quot;30&quot;</span>
<a href="#l4.1014"></a><span id="l4.1014" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 2&quot; flags  &quot;READONLY&quot;</span>
<a href="#l4.1015"></a><span id="l4.1015" class="difflineplus">+</span>
<a href="#l4.1016"></a><span id="l4.1016" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 3&quot; Type   &quot;label&quot;</span>
<a href="#l4.1017"></a><span id="l4.1017" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 3&quot; Text   &quot;$(SUMMARY_CLICK)&quot;</span>
<a href="#l4.1018"></a><span id="l4.1018" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 3&quot; Left   &quot;0&quot;</span>
<a href="#l4.1019"></a><span id="l4.1019" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 3&quot; Right  &quot;-1&quot;</span>
<a href="#l4.1020"></a><span id="l4.1020" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 3&quot; Top    &quot;130&quot;</span>
<a href="#l4.1021"></a><span id="l4.1021" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 3&quot; Bottom &quot;150&quot;</span>
<a href="#l4.1022"></a><span id="l4.1022" class="difflineplus">+</span>
<a href="#l4.1023"></a><span id="l4.1023" class="difflineplus">+  ${If} &quot;$TmpVal&quot; == &quot;true&quot;</span>
<a href="#l4.1024"></a><span id="l4.1024" class="difflineplus">+    WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 4&quot; Type   &quot;label&quot;</span>
<a href="#l4.1025"></a><span id="l4.1025" class="difflineplus">+    WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 4&quot; Text   &quot;$(SUMMARY_REBOOT_REQUIRED_INSTALL)&quot;</span>
<a href="#l4.1026"></a><span id="l4.1026" class="difflineplus">+    WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 4&quot; Left   &quot;0&quot;</span>
<a href="#l4.1027"></a><span id="l4.1027" class="difflineplus">+    WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 4&quot; Right  &quot;-1&quot;</span>
<a href="#l4.1028"></a><span id="l4.1028" class="difflineplus">+    WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 4&quot; Top    &quot;35&quot;</span>
<a href="#l4.1029"></a><span id="l4.1029" class="difflineplus">+    WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Field 4&quot; Bottom &quot;45&quot;</span>
<a href="#l4.1030"></a><span id="l4.1030" class="difflineplus">+</span>
<a href="#l4.1031"></a><span id="l4.1031" class="difflineplus">+    WriteINIStr &quot;$PLUGINSDIR\summary.ini&quot; &quot;Settings&quot; NumFields &quot;4&quot;</span>
<a href="#l4.1032"></a><span id="l4.1032">   ${EndIf}</span>
<a href="#l4.1033"></a><span id="l4.1033"> </span>
<a href="#l4.1034"></a><span id="l4.1034" class="difflineminus">-  Call WriteLogSeparator</span>
<a href="#l4.1035"></a><span id="l4.1035" class="difflineminus">-  ${GetTime} &quot;&quot; &quot;L&quot; $0 $1 $2 $3 $4 $5 $6</span>
<a href="#l4.1036"></a><span id="l4.1036" class="difflineminus">-  FileWrite $fhInstallLog &quot;${BrandFullName} Installation Finished: $2-$1-$0 $4:$5:$6$\r$\n&quot;</span>
<a href="#l4.1037"></a><span id="l4.1037" class="difflineminus">-  FileClose $fhInstallLog</span>
<a href="#l4.1038"></a><span id="l4.1038" class="difflineplus">+  !insertmacro MUI_HEADER_TEXT &quot;$(SUMMARY_PAGE_TITLE)&quot; &quot;$(SUMMARY_PAGE_SUBTITLE)&quot;</span>
<a href="#l4.1039"></a><span id="l4.1039" class="difflineplus">+</span>
<a href="#l4.1040"></a><span id="l4.1040" class="difflineplus">+  ; The Summary custom page has a textbox that will automatically receive</span>
<a href="#l4.1041"></a><span id="l4.1041" class="difflineplus">+  ; focus. This sets the focus to the Install button instead.</span>
<a href="#l4.1042"></a><span id="l4.1042" class="difflineplus">+  !insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;summary.ini&quot;</span>
<a href="#l4.1043"></a><span id="l4.1043" class="difflineplus">+  GetDlgItem $0 $HWNDPARENT 1</span>
<a href="#l4.1044"></a><span id="l4.1044" class="difflineplus">+  System::Call &quot;user32::SetFocus(i r0, i 0x0007, i,i)i&quot;</span>
<a href="#l4.1045"></a><span id="l4.1045" class="difflineplus">+  ${MUI_INSTALLOPTIONS_READ} $1 &quot;summary.ini&quot; &quot;Field 2&quot; &quot;HWND&quot;</span>
<a href="#l4.1046"></a><span id="l4.1046" class="difflineplus">+  SendMessage $1 ${WM_SETTEXT} 0 &quot;STR:$INSTDIR&quot;</span>
<a href="#l4.1047"></a><span id="l4.1047" class="difflineplus">+  !insertmacro MUI_INSTALLOPTIONS_SHOW</span>
<a href="#l4.1048"></a><span id="l4.1048" class="difflineplus">+FunctionEnd</span>
<a href="#l4.1049"></a><span id="l4.1049" class="difflineplus">+</span>
<a href="#l4.1050"></a><span id="l4.1050" class="difflineplus">+Function leaveSummary</span>
<a href="#l4.1051"></a><span id="l4.1051" class="difflineplus">+  ; Try to delete the app executable and if we can't delete it try to find the</span>
<a href="#l4.1052"></a><span id="l4.1052" class="difflineplus">+  ; app's message window and prompt the user to close the app. This allows</span>
<a href="#l4.1053"></a><span id="l4.1053" class="difflineplus">+  ; running an instance that is located in another directory. If for whatever</span>
<a href="#l4.1054"></a><span id="l4.1054" class="difflineplus">+  ; reason there is no message window we will just rename the app's files and</span>
<a href="#l4.1055"></a><span id="l4.1055" class="difflineplus">+  ; then remove them on restart.</span>
<a href="#l4.1056"></a><span id="l4.1056" class="difflineplus">+  ClearErrors</span>
<a href="#l4.1057"></a><span id="l4.1057" class="difflineplus">+  ${DeleteFile} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.1058"></a><span id="l4.1058" class="difflineplus">+  ${If} ${Errors}</span>
<a href="#l4.1059"></a><span id="l4.1059" class="difflineplus">+    ${ManualCloseAppPrompt} &quot;${WindowClass}&quot; &quot;$(WARN_MANUALLY_CLOSE_APP_INSTALL)&quot;</span>
<a href="#l4.1060"></a><span id="l4.1060" class="difflineplus">+  ${EndIf}</span>
<a href="#l4.1061"></a><span id="l4.1061"> FunctionEnd</span>
<a href="#l4.1062"></a><span id="l4.1062"> </span>
<a href="#l4.1063"></a><span id="l4.1063"> ; When we add an optional action to the finish page the cancel button is</span>
<a href="#l4.1064"></a><span id="l4.1064"> ; enabled. This disables it and leaves the finish button as the only choice.</span>
<a href="#l4.1065"></a><span id="l4.1065"> Function preFinish</span>
<a href="#l4.1066"></a><span id="l4.1066" class="difflineplus">+  ${EndInstallLog} &quot;${BrandFullName}&quot;</span>
<a href="#l4.1067"></a><span id="l4.1067">   !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;settings&quot; &quot;cancelenabled&quot; &quot;0&quot;</span>
<a href="#l4.1068"></a><span id="l4.1068"> FunctionEnd</span>
<a href="#l4.1069"></a><span id="l4.1069"> </span>
<a href="#l4.1070"></a><span id="l4.1070"> ################################################################################</span>
<a href="#l4.1071"></a><span id="l4.1071"> # Initialization Functions</span>
<a href="#l4.1072"></a><span id="l4.1072"> </span>
<a href="#l4.1073"></a><span id="l4.1073"> Function .onInit</span>
<a href="#l4.1074"></a><span id="l4.1074" class="difflineminus">-  ${GetParameters} $R0</span>
<a href="#l4.1075"></a><span id="l4.1075" class="difflineminus">-  ${If} $R0 != &quot;&quot;</span>
<a href="#l4.1076"></a><span id="l4.1076" class="difflineminus">-    ClearErrors</span>
<a href="#l4.1077"></a><span id="l4.1077" class="difflineminus">-    ${GetOptions} &quot;$R0&quot; &quot;-ms&quot; $R1</span>
<a href="#l4.1078"></a><span id="l4.1078" class="difflineminus">-    ${If} ${Errors}</span>
<a href="#l4.1079"></a><span id="l4.1079" class="difflineminus">-      ; Default install type</span>
<a href="#l4.1080"></a><span id="l4.1080" class="difflineminus">-      StrCpy $InstallType &quot;1&quot;</span>
<a href="#l4.1081"></a><span id="l4.1081" class="difflineminus">-      ; Support for specifying an installation configuration file.</span>
<a href="#l4.1082"></a><span id="l4.1082" class="difflineminus">-      ClearErrors</span>
<a href="#l4.1083"></a><span id="l4.1083" class="difflineminus">-      ${GetOptions} &quot;$R0&quot; &quot;/INI=&quot; $R1</span>
<a href="#l4.1084"></a><span id="l4.1084" class="difflineminus">-      ${Unless} ${Errors}</span>
<a href="#l4.1085"></a><span id="l4.1085" class="difflineminus">-        ; The configuration file must also exist</span>
<a href="#l4.1086"></a><span id="l4.1086" class="difflineminus">-        ${If} ${FileExists} &quot;$R1&quot;</span>
<a href="#l4.1087"></a><span id="l4.1087" class="difflineminus">-          SetSilent silent</span>
<a href="#l4.1088"></a><span id="l4.1088" class="difflineminus">-          ReadINIStr $0 $R1 &quot;Install&quot; &quot;InstallDirectoryName&quot;</span>
<a href="#l4.1089"></a><span id="l4.1089" class="difflineminus">-          ${If} $0 != &quot;&quot;</span>
<a href="#l4.1090"></a><span id="l4.1090" class="difflineminus">-            StrCpy $INSTDIR &quot;$PROGRAMFILES\$0&quot;</span>
<a href="#l4.1091"></a><span id="l4.1091" class="difflineminus">-          ${Else}</span>
<a href="#l4.1092"></a><span id="l4.1092" class="difflineminus">-            ReadINIStr $0 $R1 &quot;Install&quot; &quot;InstallDirectoryPath&quot;</span>
<a href="#l4.1093"></a><span id="l4.1093" class="difflineminus">-            ${If} $$0 != &quot;&quot;</span>
<a href="#l4.1094"></a><span id="l4.1094" class="difflineminus">-              StrCpy $INSTDIR &quot;$0&quot;</span>
<a href="#l4.1095"></a><span id="l4.1095" class="difflineminus">-            ${EndIf}</span>
<a href="#l4.1096"></a><span id="l4.1096" class="difflineminus">-          ${EndIf}</span>
<a href="#l4.1097"></a><span id="l4.1097" class="difflineplus">+  StrCpy $LANGUAGE 0</span>
<a href="#l4.1098"></a><span id="l4.1098" class="difflineplus">+  ${SetBrandNameVars} &quot;$EXEDIR\localized\distribution\setup.ini&quot;</span>
<a href="#l4.1099"></a><span id="l4.1099" class="difflineplus">+</span>
<a href="#l4.1100"></a><span id="l4.1100" class="difflineplus">+  ${InstallOnInitCommon} &quot;$(WARN_UNSUPPORTED_MSG)&quot;</span>
<a href="#l4.1101"></a><span id="l4.1101" class="difflineplus">+</span>
<a href="#l4.1102"></a><span id="l4.1102" class="difflineplus">+  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;options.ini&quot;</span>
<a href="#l4.1103"></a><span id="l4.1103" class="difflineplus">+  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;shortcuts.ini&quot;</span>
<a href="#l4.1104"></a><span id="l4.1104" class="difflineplus">+  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;summary.ini&quot;</span>
<a href="#l4.1105"></a><span id="l4.1105" class="difflineplus">+</span>
<a href="#l4.1106"></a><span id="l4.1106" class="difflineplus">+  ; Setup the options.ini file for the Custom Options Page</span>
<a href="#l4.1107"></a><span id="l4.1107" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Settings&quot; NumFields &quot;5&quot;</span>
<a href="#l4.1108"></a><span id="l4.1108"> </span>
<a href="#l4.1109"></a><span id="l4.1109" class="difflineminus">-          ${If} $INSTDIR == &quot;&quot;</span>
<a href="#l4.1110"></a><span id="l4.1110" class="difflineminus">-            ; Check if there is an existing uninstall registry entry for this</span>
<a href="#l4.1111"></a><span id="l4.1111" class="difflineminus">-            ; version of the application and if present install into that location</span>
<a href="#l4.1112"></a><span id="l4.1112" class="difflineminus">-            ReadRegStr $0 HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${BrandFullNameInternal} (${AppVersion})&quot; &quot;InstallLocation&quot;</span>
<a href="#l4.1113"></a><span id="l4.1113" class="difflineminus">-            ${If} $0 == &quot;&quot;</span>
<a href="#l4.1114"></a><span id="l4.1114" class="difflineminus">-              StrCpy $INSTDIR &quot;$PROGRAMFILES\${BrandFullName}&quot;</span>
<a href="#l4.1115"></a><span id="l4.1115" class="difflineminus">-            ${Else}</span>
<a href="#l4.1116"></a><span id="l4.1116" class="difflineminus">-              GetFullPathName $INSTDIR &quot;$0&quot;</span>
<a href="#l4.1117"></a><span id="l4.1117" class="difflineminus">-              ${Unless} ${FileExists} &quot;$INSTDIR&quot;</span>
<a href="#l4.1118"></a><span id="l4.1118" class="difflineminus">-                StrCpy $INSTDIR &quot;$PROGRAMFILES\${BrandFullName}&quot;</span>
<a href="#l4.1119"></a><span id="l4.1119" class="difflineminus">-              ${EndUnless}</span>
<a href="#l4.1120"></a><span id="l4.1120" class="difflineminus">-            ${EndIf}</span>
<a href="#l4.1121"></a><span id="l4.1121" class="difflineminus">-          ${EndIf}</span>
<a href="#l4.1122"></a><span id="l4.1122" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 1&quot; Type   &quot;label&quot;</span>
<a href="#l4.1123"></a><span id="l4.1123" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 1&quot; Text   &quot;$(OPTIONS_SUMMARY)&quot;</span>
<a href="#l4.1124"></a><span id="l4.1124" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 1&quot; Left   &quot;0&quot;</span>
<a href="#l4.1125"></a><span id="l4.1125" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 1&quot; Right  &quot;-1&quot;</span>
<a href="#l4.1126"></a><span id="l4.1126" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 1&quot; Top    &quot;0&quot;</span>
<a href="#l4.1127"></a><span id="l4.1127" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 1&quot; Bottom &quot;10&quot;</span>
<a href="#l4.1128"></a><span id="l4.1128" class="difflineplus">+</span>
<a href="#l4.1129"></a><span id="l4.1129" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 2&quot; Type   &quot;RadioButton&quot;</span>
<a href="#l4.1130"></a><span id="l4.1130" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 2&quot; Text   &quot;$(OPTION_STANDARD_RADIO)&quot;</span>
<a href="#l4.1131"></a><span id="l4.1131" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 2&quot; Left   &quot;15&quot;</span>
<a href="#l4.1132"></a><span id="l4.1132" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 2&quot; Right  &quot;-1&quot;</span>
<a href="#l4.1133"></a><span id="l4.1133" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 2&quot; Top    &quot;25&quot;</span>
<a href="#l4.1134"></a><span id="l4.1134" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 2&quot; Bottom &quot;35&quot;</span>
<a href="#l4.1135"></a><span id="l4.1135" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 2&quot; State  &quot;1&quot;</span>
<a href="#l4.1136"></a><span id="l4.1136" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 2&quot; Flags  &quot;GROUP&quot;</span>
<a href="#l4.1137"></a><span id="l4.1137" class="difflineplus">+</span>
<a href="#l4.1138"></a><span id="l4.1138" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 3&quot; Type   &quot;RadioButton&quot;</span>
<a href="#l4.1139"></a><span id="l4.1139" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 3&quot; Text   &quot;$(OPTION_CUSTOM_RADIO)&quot;</span>
<a href="#l4.1140"></a><span id="l4.1140" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 3&quot; Left   &quot;15&quot;</span>
<a href="#l4.1141"></a><span id="l4.1141" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 3&quot; Right  &quot;-1&quot;</span>
<a href="#l4.1142"></a><span id="l4.1142" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 3&quot; Top    &quot;55&quot;</span>
<a href="#l4.1143"></a><span id="l4.1143" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 3&quot; Bottom &quot;65&quot;</span>
<a href="#l4.1144"></a><span id="l4.1144" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 3&quot; State  &quot;0&quot;</span>
<a href="#l4.1145"></a><span id="l4.1145"> </span>
<a href="#l4.1146"></a><span id="l4.1146" class="difflineminus">-          ; Quit if we are unable to create the installation directory or we are</span>
<a href="#l4.1147"></a><span id="l4.1147" class="difflineminus">-          ; unable to write to a file in the installation directory.</span>
<a href="#l4.1148"></a><span id="l4.1148" class="difflineminus">-          ClearErrors</span>
<a href="#l4.1149"></a><span id="l4.1149" class="difflineminus">-          ${If} ${FileExists} &quot;$INSTDIR&quot;</span>
<a href="#l4.1150"></a><span id="l4.1150" class="difflineminus">-            GetTempFileName $R2 &quot;$INSTDIR&quot;</span>
<a href="#l4.1151"></a><span id="l4.1151" class="difflineminus">-            FileOpen $R3 $R2 w</span>
<a href="#l4.1152"></a><span id="l4.1152" class="difflineminus">-            FileWrite $R3 &quot;Write Access Test&quot;</span>
<a href="#l4.1153"></a><span id="l4.1153" class="difflineminus">-            FileClose $R3</span>
<a href="#l4.1154"></a><span id="l4.1154" class="difflineminus">-            Delete $R2</span>
<a href="#l4.1155"></a><span id="l4.1155" class="difflineminus">-            ${If} ${Errors}</span>
<a href="#l4.1156"></a><span id="l4.1156" class="difflineminus">-              Quit</span>
<a href="#l4.1157"></a><span id="l4.1157" class="difflineminus">-            ${EndIf}</span>
<a href="#l4.1158"></a><span id="l4.1158" class="difflineminus">-          ${Else}</span>
<a href="#l4.1159"></a><span id="l4.1159" class="difflineminus">-            CreateDirectory &quot;$INSTDIR&quot;</span>
<a href="#l4.1160"></a><span id="l4.1160" class="difflineminus">-            ${If} ${Errors}</span>
<a href="#l4.1161"></a><span id="l4.1161" class="difflineminus">-              Quit</span>
<a href="#l4.1162"></a><span id="l4.1162" class="difflineminus">-            ${EndIf}</span>
<a href="#l4.1163"></a><span id="l4.1163" class="difflineminus">-          ${EndIf}</span>
<a href="#l4.1164"></a><span id="l4.1164" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 4&quot; Type   &quot;label&quot;</span>
<a href="#l4.1165"></a><span id="l4.1165" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 4&quot; Text   &quot;$(OPTION_STANDARD_DESC)&quot;</span>
<a href="#l4.1166"></a><span id="l4.1166" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 4&quot; Left   &quot;30&quot;</span>
<a href="#l4.1167"></a><span id="l4.1167" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 4&quot; Right  &quot;-1&quot;</span>
<a href="#l4.1168"></a><span id="l4.1168" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 4&quot; Top    &quot;37&quot;</span>
<a href="#l4.1169"></a><span id="l4.1169" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 4&quot; Bottom &quot;57&quot;</span>
<a href="#l4.1170"></a><span id="l4.1170"> </span>
<a href="#l4.1171"></a><span id="l4.1171" class="difflineminus">-          ReadINIStr $0 $R1 &quot;Install&quot; &quot;CloseAppNoPrompt&quot;</span>
<a href="#l4.1172"></a><span id="l4.1172" class="difflineminus">-          ${If} $0 == &quot;true&quot;</span>
<a href="#l4.1173"></a><span id="l4.1173" class="difflineminus">-            ClearErrors</span>
<a href="#l4.1174"></a><span id="l4.1174" class="difflineminus">-            ${If} ${FileExists} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.1175"></a><span id="l4.1175" class="difflineminus">-              ${DeleteFile} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.1176"></a><span id="l4.1176" class="difflineminus">-            ${EndIf}</span>
<a href="#l4.1177"></a><span id="l4.1177" class="difflineminus">-            ${If} ${Errors}</span>
<a href="#l4.1178"></a><span id="l4.1178" class="difflineminus">-              ClearErrors</span>
<a href="#l4.1179"></a><span id="l4.1179" class="difflineminus">-              ${CloseApp} &quot;false&quot; &quot;&quot;</span>
<a href="#l4.1180"></a><span id="l4.1180" class="difflineminus">-              ${DeleteFile} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l4.1181"></a><span id="l4.1181" class="difflineminus">-            ${EndIf}</span>
<a href="#l4.1182"></a><span id="l4.1182" class="difflineminus">-          ${EndIf}</span>
<a href="#l4.1183"></a><span id="l4.1183" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 5&quot; Type   &quot;label&quot;</span>
<a href="#l4.1184"></a><span id="l4.1184" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 5&quot; Text   &quot;$(OPTION_CUSTOM_DESC)&quot;</span>
<a href="#l4.1185"></a><span id="l4.1185" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 5&quot; Left   &quot;30&quot;</span>
<a href="#l4.1186"></a><span id="l4.1186" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 5&quot; Right  &quot;-1&quot;</span>
<a href="#l4.1187"></a><span id="l4.1187" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 5&quot; Top    &quot;67&quot;</span>
<a href="#l4.1188"></a><span id="l4.1188" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\options.ini&quot; &quot;Field 5&quot; Bottom &quot;87&quot;</span>
<a href="#l4.1189"></a><span id="l4.1189" class="difflineplus">+</span>
<a href="#l4.1190"></a><span id="l4.1190" class="difflineplus">+  ; Setup the shortcuts.ini file for the Custom Shortcuts Page</span>
<a href="#l4.1191"></a><span id="l4.1191" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Settings&quot; NumFields &quot;4&quot;</span>
<a href="#l4.1192"></a><span id="l4.1192" class="difflineplus">+</span>
<a href="#l4.1193"></a><span id="l4.1193" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 1&quot; Type   &quot;label&quot;</span>
<a href="#l4.1194"></a><span id="l4.1194" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 1&quot; Text   &quot;$(CREATE_ICONS_DESC)&quot;</span>
<a href="#l4.1195"></a><span id="l4.1195" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 1&quot; Left   &quot;0&quot;</span>
<a href="#l4.1196"></a><span id="l4.1196" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 1&quot; Right  &quot;-1&quot;</span>
<a href="#l4.1197"></a><span id="l4.1197" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 1&quot; Top    &quot;5&quot;</span>
<a href="#l4.1198"></a><span id="l4.1198" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 1&quot; Bottom &quot;15&quot;</span>
<a href="#l4.1199"></a><span id="l4.1199"> </span>
<a href="#l4.1200"></a><span id="l4.1200" class="difflineminus">-          ReadINIStr $0 $R1 &quot;Install&quot; &quot;QuickLaunchShortcut&quot;</span>
<a href="#l4.1201"></a><span id="l4.1201" class="difflineminus">-          ${If} $0 == &quot;false&quot;</span>
<a href="#l4.1202"></a><span id="l4.1202" class="difflineminus">-            StrCpy $AddQuickLaunchSC &quot;0&quot;</span>
<a href="#l4.1203"></a><span id="l4.1203" class="difflineminus">-          ${Else}</span>
<a href="#l4.1204"></a><span id="l4.1204" class="difflineminus">-            StrCpy $AddQuickLaunchSC &quot;1&quot;</span>
<a href="#l4.1205"></a><span id="l4.1205" class="difflineminus">-          ${EndIf}</span>
<a href="#l4.1206"></a><span id="l4.1206" class="difflineminus">-</span>
<a href="#l4.1207"></a><span id="l4.1207" class="difflineminus">-          ReadINIStr $0 $R1 &quot;Install&quot; &quot;DesktopShortcut&quot;</span>
<a href="#l4.1208"></a><span id="l4.1208" class="difflineminus">-          ${If} $0 == &quot;false&quot;</span>
<a href="#l4.1209"></a><span id="l4.1209" class="difflineminus">-            StrCpy $AddDesktopSC &quot;0&quot;</span>
<a href="#l4.1210"></a><span id="l4.1210" class="difflineminus">-          ${Else}</span>
<a href="#l4.1211"></a><span id="l4.1211" class="difflineminus">-            StrCpy $AddDesktopSC &quot;1&quot;</span>
<a href="#l4.1212"></a><span id="l4.1212" class="difflineminus">-          ${EndIf}</span>
<a href="#l4.1213"></a><span id="l4.1213" class="difflineminus">-</span>
<a href="#l4.1214"></a><span id="l4.1214" class="difflineminus">-          ReadINIStr $0 $R1 &quot;Install&quot; &quot;StartMenuShortcuts&quot;</span>
<a href="#l4.1215"></a><span id="l4.1215" class="difflineminus">-          ${If} $0 == &quot;false&quot;</span>
<a href="#l4.1216"></a><span id="l4.1216" class="difflineminus">-            StrCpy $AddStartMenuSC &quot;0&quot;</span>
<a href="#l4.1217"></a><span id="l4.1217" class="difflineminus">-          ${Else}</span>
<a href="#l4.1218"></a><span id="l4.1218" class="difflineminus">-            StrCpy $AddStartMenuSC &quot;1&quot;</span>
<a href="#l4.1219"></a><span id="l4.1219" class="difflineminus">-          ${EndIf}</span>
<a href="#l4.1220"></a><span id="l4.1220" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 2&quot; Type   &quot;checkbox&quot;</span>
<a href="#l4.1221"></a><span id="l4.1221" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 2&quot; Text   &quot;$(ICONS_DESKTOP)&quot;</span>
<a href="#l4.1222"></a><span id="l4.1222" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 2&quot; Left   &quot;15&quot;</span>
<a href="#l4.1223"></a><span id="l4.1223" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 2&quot; Right  &quot;-1&quot;</span>
<a href="#l4.1224"></a><span id="l4.1224" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 2&quot; Top    &quot;20&quot;</span>
<a href="#l4.1225"></a><span id="l4.1225" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 2&quot; Bottom &quot;30&quot;</span>
<a href="#l4.1226"></a><span id="l4.1226" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 2&quot; State  &quot;1&quot;</span>
<a href="#l4.1227"></a><span id="l4.1227" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 2&quot; Flags  &quot;GROUP&quot;</span>
<a href="#l4.1228"></a><span id="l4.1228"> </span>
<a href="#l4.1229"></a><span id="l4.1229" class="difflineminus">-          ReadINIStr $0 $R1 &quot;Install&quot; &quot;StartMenuDirectoryName&quot;</span>
<a href="#l4.1230"></a><span id="l4.1230" class="difflineminus">-          ${If} $0 != &quot;&quot;</span>
<a href="#l4.1231"></a><span id="l4.1231" class="difflineminus">-            StrCpy $StartMenuDir &quot;$0&quot;</span>
<a href="#l4.1232"></a><span id="l4.1232" class="difflineminus">-          ${EndIf}</span>
<a href="#l4.1233"></a><span id="l4.1233" class="difflineminus">-        ${EndIf}</span>
<a href="#l4.1234"></a><span id="l4.1234" class="difflineminus">-      ${EndUnless}</span>
<a href="#l4.1235"></a><span id="l4.1235" class="difflineminus">-    ${Else}</span>
<a href="#l4.1236"></a><span id="l4.1236" class="difflineminus">-      ; Support for the deprecated -ms command line argument. The new command</span>
<a href="#l4.1237"></a><span id="l4.1237" class="difflineminus">-      ; line arguments are not supported when -ms is used.</span>
<a href="#l4.1238"></a><span id="l4.1238" class="difflineminus">-      SetSilent silent</span>
<a href="#l4.1239"></a><span id="l4.1239" class="difflineminus">-    ${EndIf}</span>
<a href="#l4.1240"></a><span id="l4.1240" class="difflineminus">-  ${EndIf}</span>
<a href="#l4.1241"></a><span id="l4.1241" class="difflineminus">-  ClearErrors</span>
<a href="#l4.1242"></a><span id="l4.1242" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 3&quot; Type   &quot;checkbox&quot;</span>
<a href="#l4.1243"></a><span id="l4.1243" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 3&quot; Text   &quot;$(ICONS_STARTMENU)&quot;</span>
<a href="#l4.1244"></a><span id="l4.1244" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 3&quot; Left   &quot;15&quot;</span>
<a href="#l4.1245"></a><span id="l4.1245" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 3&quot; Right  &quot;-1&quot;</span>
<a href="#l4.1246"></a><span id="l4.1246" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 3&quot; Top    &quot;40&quot;</span>
<a href="#l4.1247"></a><span id="l4.1247" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 3&quot; Bottom &quot;50&quot;</span>
<a href="#l4.1248"></a><span id="l4.1248" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 3&quot; State  &quot;1&quot;</span>
<a href="#l4.1249"></a><span id="l4.1249"> </span>
<a href="#l4.1250"></a><span id="l4.1250" class="difflineminus">-  StrCpy $LANGUAGE 0</span>
<a href="#l4.1251"></a><span id="l4.1251" class="difflineminus">-  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;options.ini&quot;</span>
<a href="#l4.1252"></a><span id="l4.1252" class="difflineminus">-  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;components.ini&quot;</span>
<a href="#l4.1253"></a><span id="l4.1253" class="difflineminus">-  !insertmacro MUI_INSTALLOPTIONS_EXTRACT &quot;shortcuts.ini&quot;</span>
<a href="#l4.1254"></a><span id="l4.1254" class="difflineminus">-  !insertmacro createBasicCustomOptionsINI</span>
<a href="#l4.1255"></a><span id="l4.1255" class="difflineminus">-  !insertmacro createComponentsINI</span>
<a href="#l4.1256"></a><span id="l4.1256" class="difflineminus">-  !insertmacro createShortcutsINI</span>
<a href="#l4.1257"></a><span id="l4.1257" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 4&quot; Type   &quot;checkbox&quot;</span>
<a href="#l4.1258"></a><span id="l4.1258" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 4&quot; Text   &quot;$(ICONS_QUICKLAUNCH)&quot;</span>
<a href="#l4.1259"></a><span id="l4.1259" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 4&quot; Left   &quot;15&quot;</span>
<a href="#l4.1260"></a><span id="l4.1260" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 4&quot; Right  &quot;-1&quot;</span>
<a href="#l4.1261"></a><span id="l4.1261" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 4&quot; Top    &quot;60&quot;</span>
<a href="#l4.1262"></a><span id="l4.1262" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 4&quot; Bottom &quot;70&quot;</span>
<a href="#l4.1263"></a><span id="l4.1263" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\shortcuts.ini&quot; &quot;Field 4&quot; State  &quot;1&quot;</span>
<a href="#l4.1264"></a><span id="l4.1264"> </span>
<a href="#l4.1265"></a><span id="l4.1265">   ; There must always be nonlocalized and localized directories.</span>
<a href="#l4.1266"></a><span id="l4.1266" class="difflineminus">-  ${GetSize} &quot;$EXEDIR\nonlocalized\&quot; &quot;/S=0K&quot; $1 $8 $9</span>
<a href="#l4.1267"></a><span id="l4.1267" class="difflineminus">-  ${GetSize} &quot;$EXEDIR\localized\&quot; &quot;/S=0K&quot; $2 $8 $9</span>
<a href="#l4.1268"></a><span id="l4.1268" class="difflineminus">-  IntOp $0 $1 + $2</span>
<a href="#l4.1269"></a><span id="l4.1269" class="difflineminus">-  SectionSetSize 0 $0</span>
<a href="#l4.1270"></a><span id="l4.1270" class="difflineplus">+  ${GetSize} &quot;$EXEDIR\nonlocalized\&quot; &quot;/S=0K&quot; $R5 $R7 $R8</span>
<a href="#l4.1271"></a><span id="l4.1271" class="difflineplus">+  ${GetSize} &quot;$EXEDIR\localized\&quot; &quot;/S=0K&quot; $R6 $R7 $R8</span>
<a href="#l4.1272"></a><span id="l4.1272" class="difflineplus">+  IntOp $R8 $R5 + $R6</span>
<a href="#l4.1273"></a><span id="l4.1273" class="difflineplus">+  SectionSetSize ${APP_IDX} $R8</span>
<a href="#l4.1274"></a><span id="l4.1274"> </span>
<a href="#l4.1275"></a><span id="l4.1275" class="difflineminus">-  ${If} ${FileExists} &quot;$EXEDIR\optional\extensions\inspector@mozilla.org&quot;</span>
<a href="#l4.1276"></a><span id="l4.1276" class="difflineminus">-    ; Set the section size for DOMi.</span>
<a href="#l4.1277"></a><span id="l4.1277" class="difflineminus">-    ${GetSize} &quot;$EXEDIR\optional\extensions\inspector@mozilla.org&quot; &quot;/S=0K&quot; $0 $8 $9</span>
<a href="#l4.1278"></a><span id="l4.1278" class="difflineminus">-    SectionSetSize 1 $0</span>
<a href="#l4.1279"></a><span id="l4.1279" class="difflineminus">-  ${Else}</span>
<a href="#l4.1280"></a><span id="l4.1280" class="difflineminus">-    ; Hide DOMi in the components page if it isn't available.</span>
<a href="#l4.1281"></a><span id="l4.1281" class="difflineminus">-    SectionSetText 1 &quot;&quot;</span>
<a href="#l4.1282"></a><span id="l4.1282" class="difflineminus">-  ${EndIf}</span>
<a href="#l4.1283"></a><span id="l4.1283" class="difflineplus">+  ; Initialize $hHeaderBitmap to prevent redundant changing of the bitmap if</span>
<a href="#l4.1284"></a><span id="l4.1284" class="difflineplus">+  ; the user clicks the back button</span>
<a href="#l4.1285"></a><span id="l4.1285" class="difflineplus">+  StrCpy $hHeaderBitmap &quot;&quot;</span>
<a href="#l4.1286"></a><span id="l4.1286"> FunctionEnd</span>
<a href="#l4.1287"></a><span id="l4.1287" class="difflineplus">+</span>
<a href="#l4.1288"></a><span id="l4.1288" class="difflineplus">+Function .onGUIEnd</span>
<a href="#l4.1289"></a><span id="l4.1289" class="difflineplus">+  ${OnEndCommon}</span>
<a href="#l4.1290"></a><span id="l4.1290" class="difflineplus">+FunctionEnd</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1">new file mode 100644</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineminus">--- /dev/null</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineplus">+++ b/calendar/installer/windows/nsis/shared.nsh</span>
<a href="#l5.4"></a><span id="l5.4" class="difflineat">@@ -0,0 +1,207 @@</span>
<a href="#l5.5"></a><span id="l5.5" class="difflineplus">+# ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l5.6"></a><span id="l5.6" class="difflineplus">+# Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l5.7"></a><span id="l5.7" class="difflineplus">+#</span>
<a href="#l5.8"></a><span id="l5.8" class="difflineplus">+# The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l5.9"></a><span id="l5.9" class="difflineplus">+# 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l5.10"></a><span id="l5.10" class="difflineplus">+# the License. You may obtain a copy of the License at</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineplus">+# http://www.mozilla.org/MPL/</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+#</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+# Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+# for the specific language governing rights and limitations under the</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+# License.</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+#</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineplus">+# The Original Code is the Mozilla Installer code.</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+#</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineplus">+# The Initial Developer of the Original Code is Mozilla Foundation</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineplus">+# Portions created by the Initial Developer are Copyright (C) 2006</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineplus">+# the Initial Developer. All Rights Reserved.</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineplus">+#</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineplus">+# Contributor(s):</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineplus">+#  Robert Strong &lt;robert.bugzilla@gmail.com&gt;</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineplus">+#</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineplus">+# Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineplus">+# either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineplus">+# the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineplus">+# in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineplus">+# of those above. If you wish to allow use of your version of this file only</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+# under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineplus">+# use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineplus">+# decision by deleting the provisions above and replace them with the notice</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineplus">+# and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineplus">+# the provisions above, a recipient may use your version of this file under</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+# the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineplus">+#</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineplus">+# ***** END LICENSE BLOCK *****</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineplus">+</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+!macro PostUpdate</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+  ; Remove registry entries for non-existent apps and for apps that point to our</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineplus">+  ; install location in the Software\Mozilla key and uninstall registry entries</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineplus">+  ; that point to our install location for both HKCU and HKLM.</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineplus">+  SetShellVarContext current  ; Set SHCTX to the current user (e.g. HKCU)</span>
<a href="#l5.46"></a><span id="l5.46" class="difflineplus">+  ${RegCleanMain} &quot;Software\Mozilla&quot;</span>
<a href="#l5.47"></a><span id="l5.47" class="difflineplus">+  ${RegCleanUninstall}</span>
<a href="#l5.48"></a><span id="l5.48" class="difflineplus">+</span>
<a href="#l5.49"></a><span id="l5.49" class="difflineplus">+  ClearErrors</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineplus">+  WriteRegStr HKLM &quot;Software\Mozilla&quot; &quot;${BrandShortName}InstallerTest&quot; &quot;Write Test&quot;</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineplus">+  ${If} ${Errors}</span>
<a href="#l5.52"></a><span id="l5.52" class="difflineplus">+    StrCpy $TmpVal &quot;HKCU&quot; ; used primarily for logging</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineplus">+  ${Else}</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineplus">+    DeleteRegValue HKLM &quot;Software\Mozilla&quot; &quot;${BrandShortName}InstallerTest&quot;</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineplus">+    SetShellVarContext all    ; Set SHCTX to all users (e.g. HKLM)</span>
<a href="#l5.56"></a><span id="l5.56" class="difflineplus">+    StrCpy $TmpVal &quot;HKLM&quot; ; used primarily for logging</span>
<a href="#l5.57"></a><span id="l5.57" class="difflineplus">+    ${RegCleanMain} &quot;Software\Mozilla&quot;</span>
<a href="#l5.58"></a><span id="l5.58" class="difflineplus">+    ${RegCleanUninstall}</span>
<a href="#l5.59"></a><span id="l5.59" class="difflineplus">+    ${SetUninstallKeys}</span>
<a href="#l5.60"></a><span id="l5.60" class="difflineplus">+  ${EndIf}</span>
<a href="#l5.61"></a><span id="l5.61" class="difflineplus">+</span>
<a href="#l5.62"></a><span id="l5.62" class="difflineplus">+  ; Add Software\Mozilla\ registry entries</span>
<a href="#l5.63"></a><span id="l5.63" class="difflineplus">+  ${SetAppKeys}</span>
<a href="#l5.64"></a><span id="l5.64" class="difflineplus">+</span>
<a href="#l5.65"></a><span id="l5.65" class="difflineplus">+  ; Remove files that may be left behind by the application in the</span>
<a href="#l5.66"></a><span id="l5.66" class="difflineplus">+  ; VirtualStore directory.</span>
<a href="#l5.67"></a><span id="l5.67" class="difflineplus">+  ${CleanVirtualStore}</span>
<a href="#l5.68"></a><span id="l5.68" class="difflineplus">+</span>
<a href="#l5.69"></a><span id="l5.69" class="difflineplus">+  ; Remove talkback if it is present (remove after bug 386760 is fixed)</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineplus">+  ${If} ${FileExists} &quot;$INSTDIR\extensions\talkback@mozilla.org\&quot;</span>
<a href="#l5.71"></a><span id="l5.71" class="difflineplus">+    RmDir /r &quot;$INSTDIR\extensions\talkback@mozilla.org\&quot;</span>
<a href="#l5.72"></a><span id="l5.72" class="difflineplus">+  ${EndIf}</span>
<a href="#l5.73"></a><span id="l5.73" class="difflineplus">+!macroend</span>
<a href="#l5.74"></a><span id="l5.74" class="difflineplus">+!define PostUpdate &quot;!insertmacro PostUpdate&quot;</span>
<a href="#l5.75"></a><span id="l5.75" class="difflineplus">+</span>
<a href="#l5.76"></a><span id="l5.76" class="difflineplus">+!macro SetAsDefaultAppUser</span>
<a href="#l5.77"></a><span id="l5.77" class="difflineplus">+  ; This macro must be defined to use UninstallOnInitCommon in commmon.nsh</span>
<a href="#l5.78"></a><span id="l5.78" class="difflineplus">+!macroend</span>
<a href="#l5.79"></a><span id="l5.79" class="difflineplus">+!define SetAsDefaultAppUser &quot;!insertmacro SetAsDefaultAppUser&quot;</span>
<a href="#l5.80"></a><span id="l5.80" class="difflineplus">+</span>
<a href="#l5.81"></a><span id="l5.81" class="difflineplus">+!macro SetAsDefaultAppGlobal</span>
<a href="#l5.82"></a><span id="l5.82" class="difflineplus">+  ; This macro must be defined to use UninstallOnInitCommon in commmon.nsh</span>
<a href="#l5.83"></a><span id="l5.83" class="difflineplus">+!macroend</span>
<a href="#l5.84"></a><span id="l5.84" class="difflineplus">+!define SetAsDefaultAppGlobal &quot;!insertmacro SetAsDefaultAppGlobal&quot;</span>
<a href="#l5.85"></a><span id="l5.85" class="difflineplus">+</span>
<a href="#l5.86"></a><span id="l5.86" class="difflineplus">+!macro HideShortcuts</span>
<a href="#l5.87"></a><span id="l5.87" class="difflineplus">+  ; This macro must be defined to use UninstallOnInitCommon in commmon.nsh</span>
<a href="#l5.88"></a><span id="l5.88" class="difflineplus">+!macroend</span>
<a href="#l5.89"></a><span id="l5.89" class="difflineplus">+!define HideShortcuts &quot;!insertmacro HideShortcuts&quot;</span>
<a href="#l5.90"></a><span id="l5.90" class="difflineplus">+</span>
<a href="#l5.91"></a><span id="l5.91" class="difflineplus">+!macro ShowShortcuts</span>
<a href="#l5.92"></a><span id="l5.92" class="difflineplus">+  ; This macro must be defined to use UninstallOnInitCommon in commmon.nsh</span>
<a href="#l5.93"></a><span id="l5.93" class="difflineplus">+!macroend</span>
<a href="#l5.94"></a><span id="l5.94" class="difflineplus">+!define ShowShortcuts &quot;!insertmacro ShowShortcuts&quot;</span>
<a href="#l5.95"></a><span id="l5.95" class="difflineplus">+</span>
<a href="#l5.96"></a><span id="l5.96" class="difflineplus">+!macro SetAppKeys</span>
<a href="#l5.97"></a><span id="l5.97" class="difflineplus">+  ${GetLongPath} &quot;$INSTDIR&quot; $8</span>
<a href="#l5.98"></a><span id="l5.98" class="difflineplus">+  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal}\${AppVersion} (${AB_CD})\Main&quot;</span>
<a href="#l5.99"></a><span id="l5.99" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Install Directory&quot; &quot;$8&quot; 0</span>
<a href="#l5.100"></a><span id="l5.100" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;PathToExe&quot; &quot;$8\${FileMainEXE}&quot; 0</span>
<a href="#l5.101"></a><span id="l5.101" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Program Folder Path&quot; &quot;$SMPROGRAMS\$StartMenuDir&quot; 0</span>
<a href="#l5.102"></a><span id="l5.102" class="difflineplus">+</span>
<a href="#l5.103"></a><span id="l5.103" class="difflineplus">+  SetShellVarContext all  ; Set $DESKTOP to All Users</span>
<a href="#l5.104"></a><span id="l5.104" class="difflineplus">+  ${Unless} ${FileExists} &quot;$DESKTOP\${BrandFullName}.lnk&quot;</span>
<a href="#l5.105"></a><span id="l5.105" class="difflineplus">+    SetShellVarContext current  ; Set $DESKTOP to the current user's desktop</span>
<a href="#l5.106"></a><span id="l5.106" class="difflineplus">+  ${EndUnless}</span>
<a href="#l5.107"></a><span id="l5.107" class="difflineplus">+</span>
<a href="#l5.108"></a><span id="l5.108" class="difflineplus">+  ${If} ${FileExists} &quot;$DESKTOP\${BrandFullName}.lnk&quot;</span>
<a href="#l5.109"></a><span id="l5.109" class="difflineplus">+    ShellLink::GetShortCutArgs &quot;$DESKTOP\${BrandFullName}.lnk&quot;</span>
<a href="#l5.110"></a><span id="l5.110" class="difflineplus">+    Pop $1</span>
<a href="#l5.111"></a><span id="l5.111" class="difflineplus">+    ${If} &quot;$1&quot; == &quot;&quot;</span>
<a href="#l5.112"></a><span id="l5.112" class="difflineplus">+      ShellLink::GetShortCutTarget &quot;$DESKTOP\${BrandFullName}.lnk&quot;</span>
<a href="#l5.113"></a><span id="l5.113" class="difflineplus">+      Pop $1</span>
<a href="#l5.114"></a><span id="l5.114" class="difflineplus">+      ${GetLongPath} &quot;$1&quot; $1</span>
<a href="#l5.115"></a><span id="l5.115" class="difflineplus">+      ${If} &quot;$1&quot; == &quot;$8\${FileMainEXE}&quot;</span>
<a href="#l5.116"></a><span id="l5.116" class="difflineplus">+        ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;Create Desktop Shortcut&quot; 1 0</span>
<a href="#l5.117"></a><span id="l5.117" class="difflineplus">+      ${Else}</span>
<a href="#l5.118"></a><span id="l5.118" class="difflineplus">+        ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;Create Desktop Shortcut&quot; 0 0</span>
<a href="#l5.119"></a><span id="l5.119" class="difflineplus">+      ${EndIf}</span>
<a href="#l5.120"></a><span id="l5.120" class="difflineplus">+    ${EndIf}</span>
<a href="#l5.121"></a><span id="l5.121" class="difflineplus">+  ${EndIf}</span>
<a href="#l5.122"></a><span id="l5.122" class="difflineplus">+</span>
<a href="#l5.123"></a><span id="l5.123" class="difflineplus">+  ; XXXrstrong - need a cleaner way to prevent unsetting SHCTX from HKLM when</span>
<a href="#l5.124"></a><span id="l5.124" class="difflineplus">+  ; trying to find the desktop shortcut.</span>
<a href="#l5.125"></a><span id="l5.125" class="difflineplus">+  ${If} &quot;$TmpVal&quot; == &quot;HKCU&quot;</span>
<a href="#l5.126"></a><span id="l5.126" class="difflineplus">+    SetShellVarContext current ; Set SHCTX to the current user (e.g. HKCU)</span>
<a href="#l5.127"></a><span id="l5.127" class="difflineplus">+  ${Else}</span>
<a href="#l5.128"></a><span id="l5.128" class="difflineplus">+    SetShellVarContext all     ; Set SHCTX to all users (e.g. HKLM)</span>
<a href="#l5.129"></a><span id="l5.129" class="difflineplus">+  ${EndIf}</span>
<a href="#l5.130"></a><span id="l5.130" class="difflineplus">+</span>
<a href="#l5.131"></a><span id="l5.131" class="difflineplus">+  ${If} ${FileExists} &quot;$QUICKLAUNCH\${BrandFullName}.lnk&quot;</span>
<a href="#l5.132"></a><span id="l5.132" class="difflineplus">+    ShellLink::GetShortCutArgs &quot;$QUICKLAUNCH\${BrandFullName}.lnk&quot;</span>
<a href="#l5.133"></a><span id="l5.133" class="difflineplus">+    Pop $1</span>
<a href="#l5.134"></a><span id="l5.134" class="difflineplus">+    ${If} &quot;$1&quot; == &quot;&quot;</span>
<a href="#l5.135"></a><span id="l5.135" class="difflineplus">+      ShellLink::GetShortCutTarget &quot;$QUICKLAUNCH\${BrandFullName}.lnk&quot;</span>
<a href="#l5.136"></a><span id="l5.136" class="difflineplus">+      Pop $1</span>
<a href="#l5.137"></a><span id="l5.137" class="difflineplus">+      ${GetLongPath} &quot;$1&quot; $1</span>
<a href="#l5.138"></a><span id="l5.138" class="difflineplus">+      ${If} &quot;$1&quot; == &quot;$8\${FileMainEXE}&quot;</span>
<a href="#l5.139"></a><span id="l5.139" class="difflineplus">+        ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;Create Quick Launch Shortcut&quot; 1 0</span>
<a href="#l5.140"></a><span id="l5.140" class="difflineplus">+      ${Else}</span>
<a href="#l5.141"></a><span id="l5.141" class="difflineplus">+        ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;Create Quick Launch Shortcut&quot; 0 0</span>
<a href="#l5.142"></a><span id="l5.142" class="difflineplus">+      ${EndIf}</span>
<a href="#l5.143"></a><span id="l5.143" class="difflineplus">+    ${EndIf}</span>
<a href="#l5.144"></a><span id="l5.144" class="difflineplus">+  ${EndIf}</span>
<a href="#l5.145"></a><span id="l5.145" class="difflineplus">+  ; XXXrstrong - &quot;Create Start Menu Shortcut&quot; and &quot;Start Menu Folder&quot; are only</span>
<a href="#l5.146"></a><span id="l5.146" class="difflineplus">+  ; set in the installer and should also be set here for software update.</span>
<a href="#l5.147"></a><span id="l5.147" class="difflineplus">+</span>
<a href="#l5.148"></a><span id="l5.148" class="difflineplus">+  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal}\${AppVersion} (${AB_CD})\Uninstall&quot;</span>
<a href="#l5.149"></a><span id="l5.149" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Uninstall Log Folder&quot; &quot;$8\uninstall&quot; 0</span>
<a href="#l5.150"></a><span id="l5.150" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Description&quot; &quot;${BrandFullNameInternal} (${AppVersion})&quot; 0</span>
<a href="#l5.151"></a><span id="l5.151" class="difflineplus">+</span>
<a href="#l5.152"></a><span id="l5.152" class="difflineplus">+  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal}\${AppVersion} (${AB_CD})&quot;</span>
<a href="#l5.153"></a><span id="l5.153" class="difflineplus">+  ${WriteRegStr2} $TmpVal  &quot;$0&quot; &quot;&quot; &quot;${AppVersion} (${AB_CD})&quot; 0</span>
<a href="#l5.154"></a><span id="l5.154" class="difflineplus">+</span>
<a href="#l5.155"></a><span id="l5.155" class="difflineplus">+  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal} ${AppVersion}\bin&quot;</span>
<a href="#l5.156"></a><span id="l5.156" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;PathToExe&quot; &quot;$8\${FileMainEXE}&quot; 0</span>
<a href="#l5.157"></a><span id="l5.157" class="difflineplus">+</span>
<a href="#l5.158"></a><span id="l5.158" class="difflineplus">+  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal} ${AppVersion}\extensions&quot;</span>
<a href="#l5.159"></a><span id="l5.159" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Components&quot; &quot;$8\components&quot; 0</span>
<a href="#l5.160"></a><span id="l5.160" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Plugins&quot; &quot;$8\plugins&quot; 0</span>
<a href="#l5.161"></a><span id="l5.161" class="difflineplus">+</span>
<a href="#l5.162"></a><span id="l5.162" class="difflineplus">+  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal} ${AppVersion}&quot;</span>
<a href="#l5.163"></a><span id="l5.163" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;GeckoVer&quot; &quot;${GREVersion}&quot; 0</span>
<a href="#l5.164"></a><span id="l5.164" class="difflineplus">+</span>
<a href="#l5.165"></a><span id="l5.165" class="difflineplus">+  StrCpy $0 &quot;Software\Mozilla\${BrandFullNameInternal}&quot;</span>
<a href="#l5.166"></a><span id="l5.166" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;&quot; &quot;${GREVersion}&quot; 0</span>
<a href="#l5.167"></a><span id="l5.167" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;CurrentVersion&quot; &quot;${AppVersion} (${AB_CD})&quot; 0</span>
<a href="#l5.168"></a><span id="l5.168" class="difflineplus">+!macroend</span>
<a href="#l5.169"></a><span id="l5.169" class="difflineplus">+!define SetAppKeys &quot;!insertmacro SetAppKeys&quot;</span>
<a href="#l5.170"></a><span id="l5.170" class="difflineplus">+</span>
<a href="#l5.171"></a><span id="l5.171" class="difflineplus">+!macro SetUninstallKeys</span>
<a href="#l5.172"></a><span id="l5.172" class="difflineplus">+  StrCpy $0 &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${BrandFullNameInternal} (${AppVersion})&quot;</span>
<a href="#l5.173"></a><span id="l5.173" class="difflineplus">+  ${GetLongPath} &quot;$INSTDIR&quot; $8</span>
<a href="#l5.174"></a><span id="l5.174" class="difflineplus">+</span>
<a href="#l5.175"></a><span id="l5.175" class="difflineplus">+  ; Write the uninstall registry keys</span>
<a href="#l5.176"></a><span id="l5.176" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Comments&quot; &quot;${BrandFullNameInternal}&quot; 0</span>
<a href="#l5.177"></a><span id="l5.177" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;DisplayIcon&quot; &quot;$8\${FileMainEXE},0&quot; 0</span>
<a href="#l5.178"></a><span id="l5.178" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;DisplayName&quot; &quot;${BrandFullNameInternal} (${AppVersion})&quot; 0</span>
<a href="#l5.179"></a><span id="l5.179" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;DisplayVersion&quot; &quot;${AppVersion} (${AB_CD})&quot; 0</span>
<a href="#l5.180"></a><span id="l5.180" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;InstallLocation&quot; &quot;$8&quot; 0</span>
<a href="#l5.181"></a><span id="l5.181" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;Publisher&quot; &quot;Mozilla&quot; 0</span>
<a href="#l5.182"></a><span id="l5.182" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;UninstallString&quot; &quot;$8\uninstall\helper.exe&quot; 0</span>
<a href="#l5.183"></a><span id="l5.183" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;URLInfoAbout&quot; &quot;${URLInfoAbout}&quot; 0</span>
<a href="#l5.184"></a><span id="l5.184" class="difflineplus">+  ${WriteRegStr2} $TmpVal &quot;$0&quot; &quot;URLUpdateInfo&quot; &quot;${URLUpdateInfo}&quot; 0</span>
<a href="#l5.185"></a><span id="l5.185" class="difflineplus">+  ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;NoModify&quot; 1 0</span>
<a href="#l5.186"></a><span id="l5.186" class="difflineplus">+  ${WriteRegDWORD2} $TmpVal &quot;$0&quot; &quot;NoRepair&quot; 1 0</span>
<a href="#l5.187"></a><span id="l5.187" class="difflineplus">+!macroend</span>
<a href="#l5.188"></a><span id="l5.188" class="difflineplus">+!define SetUninstallKeys &quot;!insertmacro SetUninstallKeys&quot;</span>
<a href="#l5.189"></a><span id="l5.189" class="difflineplus">+</span>
<a href="#l5.190"></a><span id="l5.190" class="difflineplus">+; The files to check if they are in use during (un)install so the restart is</span>
<a href="#l5.191"></a><span id="l5.191" class="difflineplus">+; required message is displayed. All files must be located in the $INSTDIR</span>
<a href="#l5.192"></a><span id="l5.192" class="difflineplus">+; directory.</span>
<a href="#l5.193"></a><span id="l5.193" class="difflineplus">+!macro PushFilesToCheck</span>
<a href="#l5.194"></a><span id="l5.194" class="difflineplus">+  ; The first string to be pushed onto the stack MUST be &quot;end&quot; to indicate</span>
<a href="#l5.195"></a><span id="l5.195" class="difflineplus">+  ; that there are no more files to check in $INSTDIR and the last string</span>
<a href="#l5.196"></a><span id="l5.196" class="difflineplus">+  ; should be ${FileMainEXE} so if it is in use the CheckForFilesInUse macro</span>
<a href="#l5.197"></a><span id="l5.197" class="difflineplus">+  ; returns after the first check.</span>
<a href="#l5.198"></a><span id="l5.198" class="difflineplus">+  Push &quot;end&quot;</span>
<a href="#l5.199"></a><span id="l5.199" class="difflineplus">+  Push &quot;AccessibleMarshal.dll&quot;</span>
<a href="#l5.200"></a><span id="l5.200" class="difflineplus">+  Push &quot;freebl3.dll&quot;</span>
<a href="#l5.201"></a><span id="l5.201" class="difflineplus">+  Push &quot;nssckbi.dll&quot;</span>
<a href="#l5.202"></a><span id="l5.202" class="difflineplus">+  Push &quot;nspr4.dll&quot;</span>
<a href="#l5.203"></a><span id="l5.203" class="difflineplus">+  Push &quot;nssdbm3.dll&quot;</span>
<a href="#l5.204"></a><span id="l5.204" class="difflineplus">+  Push &quot;sqlite3.dll&quot;</span>
<a href="#l5.205"></a><span id="l5.205" class="difflineplus">+  Push &quot;xpcom.dll&quot;</span>
<a href="#l5.206"></a><span id="l5.206" class="difflineplus">+  Push &quot;crashreporter.exe&quot;</span>
<a href="#l5.207"></a><span id="l5.207" class="difflineplus">+  Push &quot;updater.exe&quot;</span>
<a href="#l5.208"></a><span id="l5.208" class="difflineplus">+  Push &quot;xpicleanup.exe&quot;</span>
<a href="#l5.209"></a><span id="l5.209" class="difflineplus">+  Push &quot;${FileMainEXE}&quot;</span>
<a href="#l5.210"></a><span id="l5.210" class="difflineplus">+!macroend</span>
<a href="#l5.211"></a><span id="l5.211" class="difflineplus">+!define PushFilesToCheck &quot;!insertmacro PushFilesToCheck&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/installer/windows/nsis/uninstaller.nsi</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/installer/windows/nsis/uninstaller.nsi</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -29,63 +29,102 @@</span>
<a href="#l6.4"></a><span id="l6.4"> # use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l6.5"></a><span id="l6.5"> # decision by deleting the provisions above and replace them with the notice</span>
<a href="#l6.6"></a><span id="l6.6"> # and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l6.7"></a><span id="l6.7"> # the provisions above, a recipient may use your version of this file under</span>
<a href="#l6.8"></a><span id="l6.8"> # the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l6.9"></a><span id="l6.9"> #</span>
<a href="#l6.10"></a><span id="l6.10"> # ***** END LICENSE BLOCK *****</span>
<a href="#l6.11"></a><span id="l6.11"> </span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-# Also requires:</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-# ShellLink plugin http://nsis.sourceforge.net/ShellLink_plug-in</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineplus">+# Required Plugins:</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineplus">+# AppAssocReg http://nsis.sourceforge.net/Application_Association_Registration_plug-in</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineplus">+# ShellLink   http://nsis.sourceforge.net/ShellLink_plug-in</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineplus">+# UAC         http://nsis.sourceforge.net/UAC_plug-in</span>
<a href="#l6.18"></a><span id="l6.18"> </span>
<a href="#l6.19"></a><span id="l6.19"> ; Set verbosity to 3 (e.g. no script) to lessen the noise in the build logs</span>
<a href="#l6.20"></a><span id="l6.20"> !verbose 3</span>
<a href="#l6.21"></a><span id="l6.21"> </span>
<a href="#l6.22"></a><span id="l6.22"> ; 7-Zip provides better compression than the lzma from NSIS so we add the files</span>
<a href="#l6.23"></a><span id="l6.23"> ; uncompressed and use 7-Zip to create a SFX archive of it</span>
<a href="#l6.24"></a><span id="l6.24"> SetDatablockOptimize on</span>
<a href="#l6.25"></a><span id="l6.25"> SetCompress off</span>
<a href="#l6.26"></a><span id="l6.26"> CRCCheck on</span>
<a href="#l6.27"></a><span id="l6.27"> </span>
<a href="#l6.28"></a><span id="l6.28" class="difflineplus">+RequestExecutionLevel user</span>
<a href="#l6.29"></a><span id="l6.29" class="difflineplus">+</span>
<a href="#l6.30"></a><span id="l6.30"> !addplugindir ./</span>
<a href="#l6.31"></a><span id="l6.31"> </span>
<a href="#l6.32"></a><span id="l6.32" class="difflineplus">+; USE_UAC_PLUGIN is temporary until all applications have been updated to use</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineplus">+; the UAC plugin</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineplus">+!define USE_UAC_PLUGIN</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineplus">+</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineplus">+; prevents compiling of the reg write logging.</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineplus">+!define NO_LOG</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineplus">+</span>
<a href="#l6.39"></a><span id="l6.39"> Var TmpVal</span>
<a href="#l6.40"></a><span id="l6.40"> </span>
<a href="#l6.41"></a><span id="l6.41"> ; Other included files may depend upon these includes!</span>
<a href="#l6.42"></a><span id="l6.42"> ; The following includes are provided by NSIS.</span>
<a href="#l6.43"></a><span id="l6.43"> !include FileFunc.nsh</span>
<a href="#l6.44"></a><span id="l6.44"> !include LogicLib.nsh</span>
<a href="#l6.45"></a><span id="l6.45" class="difflineminus">-!include TextFunc.nsh</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineplus">+!include MUI.nsh</span>
<a href="#l6.47"></a><span id="l6.47"> !include WinMessages.nsh</span>
<a href="#l6.48"></a><span id="l6.48" class="difflineplus">+!include WinVer.nsh</span>
<a href="#l6.49"></a><span id="l6.49"> !include WordFunc.nsh</span>
<a href="#l6.50"></a><span id="l6.50" class="difflineminus">-!include MUI.nsh</span>
<a href="#l6.51"></a><span id="l6.51"> </span>
<a href="#l6.52"></a><span id="l6.52" class="difflineplus">+!insertmacro GetOptions</span>
<a href="#l6.53"></a><span id="l6.53"> !insertmacro GetParameters</span>
<a href="#l6.54"></a><span id="l6.54" class="difflineminus">-!insertmacro un.LineFind</span>
<a href="#l6.55"></a><span id="l6.55" class="difflineminus">-!insertmacro un.TrimNewLines</span>
<a href="#l6.56"></a><span id="l6.56" class="difflineplus">+!insertmacro GetParent</span>
<a href="#l6.57"></a><span id="l6.57" class="difflineplus">+</span>
<a href="#l6.58"></a><span id="l6.58" class="difflineplus">+!insertmacro un.GetParent</span>
<a href="#l6.59"></a><span id="l6.59"> </span>
<a href="#l6.60"></a><span id="l6.60"> ; The following includes are custom.</span>
<a href="#l6.61"></a><span id="l6.61"> !include branding.nsi</span>
<a href="#l6.62"></a><span id="l6.62"> !include defines.nsi</span>
<a href="#l6.63"></a><span id="l6.63"> !include common.nsh</span>
<a href="#l6.64"></a><span id="l6.64"> !include locales.nsi</span>
<a href="#l6.65"></a><span id="l6.65"> !include version.nsh</span>
<a href="#l6.66"></a><span id="l6.66"> </span>
<a href="#l6.67"></a><span id="l6.67"> ; This is named BrandShortName helper because we use this for software update</span>
<a href="#l6.68"></a><span id="l6.68"> ; post update cleanup.</span>
<a href="#l6.69"></a><span id="l6.69" class="difflineminus">-VIAddVersionKey &quot;FileDescription&quot; &quot;${BrandShortName} Helper&quot;</span>
<a href="#l6.70"></a><span id="l6.70" class="difflineplus">+VIAddVersionKey &quot;FileDescription&quot;  &quot;${BrandShortName} Helper&quot;</span>
<a href="#l6.71"></a><span id="l6.71" class="difflineplus">+VIAddVersionKey &quot;OriginalFilename&quot; &quot;helper.exe&quot;</span>
<a href="#l6.72"></a><span id="l6.72"> </span>
<a href="#l6.73"></a><span id="l6.73" class="difflineplus">+!insertmacro CleanVirtualStore</span>
<a href="#l6.74"></a><span id="l6.74" class="difflineplus">+!insertmacro GetLongPath</span>
<a href="#l6.75"></a><span id="l6.75" class="difflineplus">+!insertmacro RegCleanMain</span>
<a href="#l6.76"></a><span id="l6.76" class="difflineplus">+!insertmacro RegCleanUninstall</span>
<a href="#l6.77"></a><span id="l6.77" class="difflineplus">+!insertmacro SetBrandNameVars</span>
<a href="#l6.78"></a><span id="l6.78" class="difflineplus">+!insertmacro UnloadUAC</span>
<a href="#l6.79"></a><span id="l6.79" class="difflineplus">+!insertmacro WriteRegDWORD2</span>
<a href="#l6.80"></a><span id="l6.80" class="difflineplus">+!insertmacro WriteRegStr2</span>
<a href="#l6.81"></a><span id="l6.81" class="difflineplus">+</span>
<a href="#l6.82"></a><span id="l6.82" class="difflineplus">+!insertmacro un.ChangeMUIHeaderImage</span>
<a href="#l6.83"></a><span id="l6.83" class="difflineplus">+!insertmacro un.CheckForFilesInUse</span>
<a href="#l6.84"></a><span id="l6.84" class="difflineplus">+!insertmacro un.CleanUpdatesDir</span>
<a href="#l6.85"></a><span id="l6.85" class="difflineplus">+!insertmacro un.CleanVirtualStore</span>
<a href="#l6.86"></a><span id="l6.86" class="difflineplus">+!insertmacro un.GetLongPath</span>
<a href="#l6.87"></a><span id="l6.87" class="difflineplus">+!insertmacro un.GetSecondInstallPath</span>
<a href="#l6.88"></a><span id="l6.88" class="difflineplus">+!insertmacro un.ManualCloseAppPrompt</span>
<a href="#l6.89"></a><span id="l6.89" class="difflineplus">+!insertmacro un.ParseUninstallLog</span>
<a href="#l6.90"></a><span id="l6.90"> !insertmacro un.RegCleanMain</span>
<a href="#l6.91"></a><span id="l6.91"> !insertmacro un.RegCleanUninstall</span>
<a href="#l6.92"></a><span id="l6.92" class="difflineminus">-!insertmacro un.CloseApp</span>
<a href="#l6.93"></a><span id="l6.93" class="difflineminus">-!insertmacro un.GetSecondInstallPath</span>
<a href="#l6.94"></a><span id="l6.94" class="difflineplus">+!insertmacro un.RemoveQuotesFromPath</span>
<a href="#l6.95"></a><span id="l6.95" class="difflineplus">+!insertmacro un.SetBrandNameVars</span>
<a href="#l6.96"></a><span id="l6.96" class="difflineplus">+</span>
<a href="#l6.97"></a><span id="l6.97" class="difflineplus">+!include shared.nsh</span>
<a href="#l6.98"></a><span id="l6.98" class="difflineplus">+</span>
<a href="#l6.99"></a><span id="l6.99" class="difflineplus">+; Helper macros for ui callbacks. Insert these after shared.nsh</span>
<a href="#l6.100"></a><span id="l6.100" class="difflineplus">+!insertmacro OnEndCommon</span>
<a href="#l6.101"></a><span id="l6.101" class="difflineplus">+!insertmacro UninstallOnInitCommon</span>
<a href="#l6.102"></a><span id="l6.102" class="difflineplus">+</span>
<a href="#l6.103"></a><span id="l6.103" class="difflineplus">+!insertmacro un.OnEndCommon</span>
<a href="#l6.104"></a><span id="l6.104"> </span>
<a href="#l6.105"></a><span id="l6.105"> Name &quot;${BrandFullName}&quot;</span>
<a href="#l6.106"></a><span id="l6.106" class="difflineminus">-OutFile &quot;uninst.exe&quot;</span>
<a href="#l6.107"></a><span id="l6.107" class="difflineplus">+OutFile &quot;helper.exe&quot;</span>
<a href="#l6.108"></a><span id="l6.108"> InstallDirRegKey HKLM &quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\${BrandFullNameInternal} (${AppVersion})&quot; &quot;InstallLocation&quot;</span>
<a href="#l6.109"></a><span id="l6.109"> InstallDir &quot;$PROGRAMFILES\${BrandFullName}&quot;</span>
<a href="#l6.110"></a><span id="l6.110"> ShowUnInstDetails nevershow</span>
<a href="#l6.111"></a><span id="l6.111"> </span>
<a href="#l6.112"></a><span id="l6.112"> ################################################################################</span>
<a href="#l6.113"></a><span id="l6.113"> # Modern User Interface - MUI</span>
<a href="#l6.114"></a><span id="l6.114"> </span>
<a href="#l6.115"></a><span id="l6.115"> !define MUI_ABORTWARNING</span>
<a href="#l6.116"></a><span id="l6.116" class="difflineat">@@ -102,222 +141,162 @@ ShowUnInstDetails nevershow</span>
<a href="#l6.117"></a><span id="l6.117"> !else</span>
<a href="#l6.118"></a><span id="l6.118"> !define MUI_HEADERIMAGE_BITMAP wizHeader.bmp</span>
<a href="#l6.119"></a><span id="l6.119"> !endif</span>
<a href="#l6.120"></a><span id="l6.120"> </span>
<a href="#l6.121"></a><span id="l6.121"> /**</span>
<a href="#l6.122"></a><span id="l6.122">  * Uninstall Pages</span>
<a href="#l6.123"></a><span id="l6.123">  */</span>
<a href="#l6.124"></a><span id="l6.124"> ; Welcome Page</span>
<a href="#l6.125"></a><span id="l6.125" class="difflineplus">+!define MUI_PAGE_CUSTOMFUNCTION_PRE un.preWelcome</span>
<a href="#l6.126"></a><span id="l6.126" class="difflineplus">+!define MUI_PAGE_CUSTOMFUNCTION_LEAVE un.leaveWelcome</span>
<a href="#l6.127"></a><span id="l6.127"> !insertmacro MUI_UNPAGE_WELCOME</span>
<a href="#l6.128"></a><span id="l6.128"> </span>
<a href="#l6.129"></a><span id="l6.129" class="difflineminus">-; Uninstall Confirm Page</span>
<a href="#l6.130"></a><span id="l6.130" class="difflineminus">-!insertmacro MUI_UNPAGE_CONFIRM</span>
<a href="#l6.131"></a><span id="l6.131" class="difflineplus">+; Custom Uninstall Confirm Page</span>
<a href="#l6.132"></a><span id="l6.132" class="difflineplus">+UninstPage custom un.preConfirm un.leaveConfirm</span>
<a href="#l6.133"></a><span id="l6.133"> </span>
<a href="#l6.134"></a><span id="l6.134"> ; Remove Files Page</span>
<a href="#l6.135"></a><span id="l6.135" class="difflineminus">-!define MUI_PAGE_CUSTOMFUNCTION_PRE un.preInstFiles</span>
<a href="#l6.136"></a><span id="l6.136"> !insertmacro MUI_UNPAGE_INSTFILES</span>
<a href="#l6.137"></a><span id="l6.137"> </span>
<a href="#l6.138"></a><span id="l6.138"> ; Finish Page</span>
<a href="#l6.139"></a><span id="l6.139" class="difflineplus">+</span>
<a href="#l6.140"></a><span id="l6.140" class="difflineplus">+; Don't setup the survey controls, functions, etc. when the application has</span>
<a href="#l6.141"></a><span id="l6.141" class="difflineplus">+; defined NO_UNINSTALL_SURVEY</span>
<a href="#l6.142"></a><span id="l6.142" class="difflineplus">+!ifndef NO_UNINSTALL_SURVEY</span>
<a href="#l6.143"></a><span id="l6.143"> !define MUI_PAGE_CUSTOMFUNCTION_PRE un.preFinish</span>
<a href="#l6.144"></a><span id="l6.144"> !define MUI_FINISHPAGE_SHOWREADME_NOTCHECKED</span>
<a href="#l6.145"></a><span id="l6.145"> !define MUI_FINISHPAGE_SHOWREADME &quot;&quot;</span>
<a href="#l6.146"></a><span id="l6.146" class="difflineminus">-</span>
<a href="#l6.147"></a><span id="l6.147" class="difflineminus">-; Setup the survey controls, functions, etc. except when the application has</span>
<a href="#l6.148"></a><span id="l6.148" class="difflineminus">-; defined NO_UNINSTALL_SURVEY</span>
<a href="#l6.149"></a><span id="l6.149" class="difflineminus">-!ifndef NO_UNINSTALL_SURVEY</span>
<a href="#l6.150"></a><span id="l6.150"> !define MUI_FINISHPAGE_SHOWREADME_TEXT $(SURVEY_TEXT)</span>
<a href="#l6.151"></a><span id="l6.151"> !define MUI_FINISHPAGE_SHOWREADME_FUNCTION un.Survey</span>
<a href="#l6.152"></a><span id="l6.152"> !endif</span>
<a href="#l6.153"></a><span id="l6.153"> </span>
<a href="#l6.154"></a><span id="l6.154"> !insertmacro MUI_UNPAGE_FINISH</span>
<a href="#l6.155"></a><span id="l6.155"> </span>
<a href="#l6.156"></a><span id="l6.156" class="difflineplus">+; Use the default dialog for IDD_VERIFY for a simple Banner</span>
<a href="#l6.157"></a><span id="l6.157" class="difflineplus">+ChangeUI IDD_VERIFY &quot;${NSISDIR}\Contrib\UIs\default.exe&quot;</span>
<a href="#l6.158"></a><span id="l6.158" class="difflineplus">+</span>
<a href="#l6.159"></a><span id="l6.159"> ################################################################################</span>
<a href="#l6.160"></a><span id="l6.160"> # Install Sections</span>
<a href="#l6.161"></a><span id="l6.161"> ; Empty section required for the installer to compile as an uninstaller</span>
<a href="#l6.162"></a><span id="l6.162"> Section &quot;&quot;</span>
<a href="#l6.163"></a><span id="l6.163"> SectionEnd</span>
<a href="#l6.164"></a><span id="l6.164"> </span>
<a href="#l6.165"></a><span id="l6.165"> ################################################################################</span>
<a href="#l6.166"></a><span id="l6.166"> # Uninstall Sections</span>
<a href="#l6.167"></a><span id="l6.167"> </span>
<a href="#l6.168"></a><span id="l6.168"> Section &quot;Uninstall&quot;</span>
<a href="#l6.169"></a><span id="l6.169">   SetDetailsPrint textonly</span>
<a href="#l6.170"></a><span id="l6.170">   DetailPrint $(STATUS_UNINSTALL_MAIN)</span>
<a href="#l6.171"></a><span id="l6.171">   SetDetailsPrint none</span>
<a href="#l6.172"></a><span id="l6.172"> </span>
<a href="#l6.173"></a><span id="l6.173" class="difflineminus">-  ; Remove registry entries for non-existent apps and for apps that point to our</span>
<a href="#l6.174"></a><span id="l6.174" class="difflineminus">-  ; install location in the Software\Mozilla key and uninstall registry entries</span>
<a href="#l6.175"></a><span id="l6.175" class="difflineminus">-  ; that point to our install location for both HKCU and HKLM.</span>
<a href="#l6.176"></a><span id="l6.176" class="difflineminus">-  SetShellVarContext current  ; Sets SHCTX to HKCU</span>
<a href="#l6.177"></a><span id="l6.177" class="difflineplus">+  ; Delete the app exe to prevent launching the app while we are uninstalling.</span>
<a href="#l6.178"></a><span id="l6.178" class="difflineplus">+  ClearErrors</span>
<a href="#l6.179"></a><span id="l6.179" class="difflineplus">+  ${DeleteFile} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l6.180"></a><span id="l6.180" class="difflineplus">+  ${If} ${Errors}</span>
<a href="#l6.181"></a><span id="l6.181" class="difflineplus">+    ; If the user closed the application it can take several seconds for it to</span>
<a href="#l6.182"></a><span id="l6.182" class="difflineplus">+    ; shut down completely. If the application is being used by another user we</span>
<a href="#l6.183"></a><span id="l6.183" class="difflineplus">+    ; can still delete the files when the system is restarted. </span>
<a href="#l6.184"></a><span id="l6.184" class="difflineplus">+    Sleep 5000</span>
<a href="#l6.185"></a><span id="l6.185" class="difflineplus">+    ${DeleteFile} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l6.186"></a><span id="l6.186" class="difflineplus">+    ClearErrors</span>
<a href="#l6.187"></a><span id="l6.187" class="difflineplus">+  ${EndIf}</span>
<a href="#l6.188"></a><span id="l6.188" class="difflineplus">+</span>
<a href="#l6.189"></a><span id="l6.189" class="difflineplus">+  SetShellVarContext current  ; Set SHCTX to HKCU</span>
<a href="#l6.190"></a><span id="l6.190">   ${un.RegCleanMain} &quot;Software\Mozilla&quot;</span>
<a href="#l6.191"></a><span id="l6.191">   ${un.RegCleanUninstall}</span>
<a href="#l6.192"></a><span id="l6.192"> </span>
<a href="#l6.193"></a><span id="l6.193" class="difflineminus">-  SetShellVarContext all  ; Sets SHCTX to HKLM</span>
<a href="#l6.194"></a><span id="l6.194" class="difflineminus">-  ${un.RegCleanMain} &quot;Software\Mozilla&quot;</span>
<a href="#l6.195"></a><span id="l6.195" class="difflineminus">-  ${un.RegCleanUninstall}</span>
<a href="#l6.196"></a><span id="l6.196" class="difflineplus">+  ClearErrors</span>
<a href="#l6.197"></a><span id="l6.197" class="difflineplus">+  WriteRegStr HKLM &quot;Software\Mozilla&quot; &quot;${BrandShortName}InstallerTest&quot; &quot;Write Test&quot;</span>
<a href="#l6.198"></a><span id="l6.198" class="difflineplus">+  ${If} ${Errors}</span>
<a href="#l6.199"></a><span id="l6.199" class="difflineplus">+    StrCpy $TmpVal &quot;HKCU&quot; ; used primarily for logging</span>
<a href="#l6.200"></a><span id="l6.200" class="difflineplus">+  ${Else}</span>
<a href="#l6.201"></a><span id="l6.201" class="difflineplus">+    SetShellVarContext all  ; Set SHCTX to HKLM</span>
<a href="#l6.202"></a><span id="l6.202" class="difflineplus">+    DeleteRegValue HKLM &quot;Software\Mozilla&quot; &quot;${BrandShortName}InstallerTest&quot;</span>
<a href="#l6.203"></a><span id="l6.203" class="difflineplus">+    StrCpy $TmpVal &quot;HKLM&quot; ; used primarily for logging</span>
<a href="#l6.204"></a><span id="l6.204" class="difflineplus">+    ${un.RegCleanMain} &quot;Software\Mozilla&quot;</span>
<a href="#l6.205"></a><span id="l6.205" class="difflineplus">+    ${un.RegCleanUninstall}</span>
<a href="#l6.206"></a><span id="l6.206" class="difflineplus">+  ${EndIf}</span>
<a href="#l6.207"></a><span id="l6.207"> </span>
<a href="#l6.208"></a><span id="l6.208">   SetShellVarContext all  ; Set SHCTX to HKLM</span>
<a href="#l6.209"></a><span id="l6.209">   ${un.GetSecondInstallPath} &quot;Software\Mozilla&quot; $R9</span>
<a href="#l6.210"></a><span id="l6.210">   ${If} $R9 == &quot;false&quot;</span>
<a href="#l6.211"></a><span id="l6.211">     SetShellVarContext current  ; Set SHCTX to HKCU</span>
<a href="#l6.212"></a><span id="l6.212">     ${un.GetSecondInstallPath} &quot;Software\Mozilla&quot; $R9</span>
<a href="#l6.213"></a><span id="l6.213">   ${EndIf}</span>
<a href="#l6.214"></a><span id="l6.214"> </span>
<a href="#l6.215"></a><span id="l6.215" class="difflineminus">-  ; XXXrstrong - Remove registry values for HKLM\Software\Clients\Calendar here.</span>
<a href="#l6.216"></a><span id="l6.216" class="difflineminus">-  ; See Thunderbird's uninstaller.nsi for an example.</span>
<a href="#l6.217"></a><span id="l6.217" class="difflineminus">-</span>
<a href="#l6.218"></a><span id="l6.218">   StrCpy $0 &quot;Software\Microsoft\Windows\CurrentVersion\App Paths\${FileMainEXE}&quot;</span>
<a href="#l6.219"></a><span id="l6.219">   ${If} $R9 == &quot;false&quot;</span>
<a href="#l6.220"></a><span id="l6.220">     DeleteRegKey HKLM &quot;$0&quot;</span>
<a href="#l6.221"></a><span id="l6.221">     DeleteRegKey HKCU &quot;$0&quot;</span>
<a href="#l6.222"></a><span id="l6.222">   ${Else}</span>
<a href="#l6.223"></a><span id="l6.223" class="difflineminus">-    ReadRegStr $1 HKLM &quot;$0&quot; &quot;&quot;</span>
<a href="#l6.224"></a><span id="l6.224" class="difflineminus">-    Push $1</span>
<a href="#l6.225"></a><span id="l6.225" class="difflineminus">-    ${GetPathFromRegStr}</span>
<a href="#l6.226"></a><span id="l6.226" class="difflineminus">-    Pop $R0</span>
<a href="#l6.227"></a><span id="l6.227" class="difflineminus">-    Push $R0</span>
<a href="#l6.228"></a><span id="l6.228" class="difflineminus">-    ${GetParentDir}</span>
<a href="#l6.229"></a><span id="l6.229" class="difflineminus">-    Pop $R1</span>
<a href="#l6.230"></a><span id="l6.230" class="difflineminus">-    ${If} $INSTDIR == $R1</span>
<a href="#l6.231"></a><span id="l6.231" class="difflineplus">+    ReadRegStr $R1 HKLM &quot;$0&quot; &quot;&quot;</span>
<a href="#l6.232"></a><span id="l6.232" class="difflineplus">+    ${un.RemoveQuotesFromPath} &quot;$R1&quot; $R1</span>
<a href="#l6.233"></a><span id="l6.233" class="difflineplus">+    ${un.GetParent} &quot;$R1&quot; $R1</span>
<a href="#l6.234"></a><span id="l6.234" class="difflineplus">+    ${If} &quot;$INSTDIR&quot; == &quot;$R1&quot;</span>
<a href="#l6.235"></a><span id="l6.235">       WriteRegStr HKLM &quot;$0&quot; &quot;&quot; &quot;$R9&quot;</span>
<a href="#l6.236"></a><span id="l6.236" class="difflineminus">-      Push $R9</span>
<a href="#l6.237"></a><span id="l6.237" class="difflineminus">-      ${GetParentDir}</span>
<a href="#l6.238"></a><span id="l6.238" class="difflineminus">-      Pop $R1</span>
<a href="#l6.239"></a><span id="l6.239" class="difflineplus">+      ${un.GetParent} &quot;$R9&quot; $R1</span>
<a href="#l6.240"></a><span id="l6.240">       WriteRegStr HKLM &quot;$0&quot; &quot;Path&quot; &quot;$R1&quot;</span>
<a href="#l6.241"></a><span id="l6.241">     ${EndIf}</span>
<a href="#l6.242"></a><span id="l6.242">   ${EndIf}</span>
<a href="#l6.243"></a><span id="l6.243"> </span>
<a href="#l6.244"></a><span id="l6.244" class="difflineminus">-  ; Remove files. If we don't have a log file skip</span>
<a href="#l6.245"></a><span id="l6.245" class="difflineminus">-  ${If} ${FileExists} &quot;$INSTDIR\uninstall\uninstall.log&quot;</span>
<a href="#l6.246"></a><span id="l6.246" class="difflineminus">-    ; Copy the uninstall log file to a temporary file</span>
<a href="#l6.247"></a><span id="l6.247" class="difflineminus">-    GetTempFileName $TmpVal</span>
<a href="#l6.248"></a><span id="l6.248" class="difflineminus">-    CopyFiles &quot;$INSTDIR\uninstall\uninstall.log&quot; &quot;$TmpVal&quot;</span>
<a href="#l6.249"></a><span id="l6.249" class="difflineplus">+  ; Remove directories and files we always control before parsing the uninstall</span>
<a href="#l6.250"></a><span id="l6.250" class="difflineplus">+  ; log so empty directories can be removed.</span>
<a href="#l6.251"></a><span id="l6.251" class="difflineplus">+  ${If} ${FileExists} &quot;$INSTDIR\updates&quot;</span>
<a href="#l6.252"></a><span id="l6.252" class="difflineplus">+    RmDir /r /REBOOTOK &quot;$INSTDIR\updates&quot;</span>
<a href="#l6.253"></a><span id="l6.253" class="difflineplus">+  ${EndIf}</span>
<a href="#l6.254"></a><span id="l6.254" class="difflineplus">+  ${If} ${FileExists} &quot;$INSTDIR\defaults\shortcuts&quot;</span>
<a href="#l6.255"></a><span id="l6.255" class="difflineplus">+    RmDir /r /REBOOTOK &quot;$INSTDIR\defaults\shortcuts&quot;</span>
<a href="#l6.256"></a><span id="l6.256" class="difflineplus">+  ${EndIf}</span>
<a href="#l6.257"></a><span id="l6.257" class="difflineplus">+  ${If} ${FileExists} &quot;$INSTDIR\distribution&quot;</span>
<a href="#l6.258"></a><span id="l6.258" class="difflineplus">+    RmDir /r /REBOOTOK &quot;$INSTDIR\distribution&quot;</span>
<a href="#l6.259"></a><span id="l6.259" class="difflineplus">+  ${EndIf}</span>
<a href="#l6.260"></a><span id="l6.260" class="difflineplus">+  ${If} ${FileExists} &quot;$INSTDIR\removed-files&quot;</span>
<a href="#l6.261"></a><span id="l6.261" class="difflineplus">+    Delete /REBOOTOK &quot;$INSTDIR\removed-files&quot;</span>
<a href="#l6.262"></a><span id="l6.262" class="difflineplus">+  ${EndIf}</span>
<a href="#l6.263"></a><span id="l6.263"> </span>
<a href="#l6.264"></a><span id="l6.264" class="difflineminus">-    ; Unregister DLL's</span>
<a href="#l6.265"></a><span id="l6.265" class="difflineminus">-    ${un.LineFind} &quot;$TmpVal&quot; &quot;/NUL&quot; &quot;1:-1&quot; &quot;un.UnRegDLLsCallback&quot;</span>
<a href="#l6.266"></a><span id="l6.266" class="difflineplus">+  ; Remove the updates directory for Vista and above</span>
<a href="#l6.267"></a><span id="l6.267" class="difflineplus">+  ${un.CleanUpdatesDir} &quot;Mozilla\Sunbird&quot;</span>
<a href="#l6.268"></a><span id="l6.268"> </span>
<a href="#l6.269"></a><span id="l6.269" class="difflineminus">-    ; Delete files</span>
<a href="#l6.270"></a><span id="l6.270" class="difflineminus">-    ${un.LineFind} &quot;$TmpVal&quot; &quot;/NUL&quot; &quot;1:-1&quot; &quot;un.RemoveFilesCallback&quot;</span>
<a href="#l6.271"></a><span id="l6.271" class="difflineplus">+  ; Remove files that may be left behind by the application in the</span>
<a href="#l6.272"></a><span id="l6.272" class="difflineplus">+  ; VirtualStore directory.</span>
<a href="#l6.273"></a><span id="l6.273" class="difflineplus">+  ${un.CleanVirtualStore}</span>
<a href="#l6.274"></a><span id="l6.274"> </span>
<a href="#l6.275"></a><span id="l6.275" class="difflineminus">-    ; Remove directories we always control</span>
<a href="#l6.276"></a><span id="l6.276" class="difflineminus">-    RmDir /r &quot;$INSTDIR\uninstall&quot;</span>
<a href="#l6.277"></a><span id="l6.277" class="difflineminus">-    RmDir /r &quot;$INSTDIR\updates&quot;</span>
<a href="#l6.278"></a><span id="l6.278" class="difflineminus">-    RmDir /r &quot;$INSTDIR\defaults\shortcuts&quot;</span>
<a href="#l6.279"></a><span id="l6.279" class="difflineplus">+  ; Parse the uninstall log to unregister dll's and remove all installed</span>
<a href="#l6.280"></a><span id="l6.280" class="difflineplus">+  ; files / directories this install is responsible for.</span>
<a href="#l6.281"></a><span id="l6.281" class="difflineplus">+  ${un.ParseUninstallLog}</span>
<a href="#l6.282"></a><span id="l6.282" class="difflineplus">+</span>
<a href="#l6.283"></a><span id="l6.283" class="difflineplus">+  ; Remove the uninstall directory that we control</span>
<a href="#l6.284"></a><span id="l6.284" class="difflineplus">+  RmDir /r /REBOOTOK &quot;$INSTDIR\uninstall&quot;</span>
<a href="#l6.285"></a><span id="l6.285" class="difflineplus">+</span>
<a href="#l6.286"></a><span id="l6.286" class="difflineplus">+  ; Remove the installation directory if it is empty</span>
<a href="#l6.287"></a><span id="l6.287" class="difflineplus">+  ${RemoveDir} &quot;$INSTDIR&quot;</span>
<a href="#l6.288"></a><span id="l6.288"> </span>
<a href="#l6.289"></a><span id="l6.289" class="difflineminus">-    ; Remove empty directories</span>
<a href="#l6.290"></a><span id="l6.290" class="difflineminus">-    ${un.LineFind} &quot;$TmpVal&quot; &quot;/NUL&quot; &quot;1:-1&quot; &quot;un.RemoveDirsCallback&quot;</span>
<a href="#l6.291"></a><span id="l6.291" class="difflineminus">-</span>
<a href="#l6.292"></a><span id="l6.292" class="difflineminus">-    ; Delete the temporary uninstall log file</span>
<a href="#l6.293"></a><span id="l6.293" class="difflineminus">-    ${DeleteFile} &quot;$TmpVal&quot;</span>
<a href="#l6.294"></a><span id="l6.294" class="difflineminus">-</span>
<a href="#l6.295"></a><span id="l6.295" class="difflineminus">-    ; Remove the installation directory if it is empty</span>
<a href="#l6.296"></a><span id="l6.296" class="difflineminus">-    ${RemoveDir} &quot;$INSTDIR&quot;</span>
<a href="#l6.297"></a><span id="l6.297" class="difflineplus">+  ; If thunderbird.exe was successfully deleted yet we still need to restart to</span>
<a href="#l6.298"></a><span id="l6.298" class="difflineplus">+  ; remove other files create a dummy thunderbird.exe.moz-delete to prevent the</span>
<a href="#l6.299"></a><span id="l6.299" class="difflineplus">+  ; installer from allowing an install without restart when it is required</span>
<a href="#l6.300"></a><span id="l6.300" class="difflineplus">+  ; to complete an uninstall.</span>
<a href="#l6.301"></a><span id="l6.301" class="difflineplus">+  ${If} ${RebootFlag}</span>
<a href="#l6.302"></a><span id="l6.302" class="difflineplus">+    ${Unless} ${FileExists} &quot;$INSTDIR\${FileMainEXE}.moz-delete&quot;</span>
<a href="#l6.303"></a><span id="l6.303" class="difflineplus">+      FileOpen $0 &quot;$INSTDIR\${FileMainEXE}.moz-delete&quot; w</span>
<a href="#l6.304"></a><span id="l6.304" class="difflineplus">+      FileWrite $0 &quot;Will be deleted on restart&quot;</span>
<a href="#l6.305"></a><span id="l6.305" class="difflineplus">+      Delete /REBOOTOK &quot;$INSTDIR\${FileMainEXE}.moz-delete&quot;</span>
<a href="#l6.306"></a><span id="l6.306" class="difflineplus">+      FileClose $0</span>
<a href="#l6.307"></a><span id="l6.307" class="difflineplus">+    ${EndUnless}</span>
<a href="#l6.308"></a><span id="l6.308">   ${EndIf}</span>
<a href="#l6.309"></a><span id="l6.309"> </span>
<a href="#l6.310"></a><span id="l6.310">   ; Refresh desktop icons otherwise the start menu internet item won't be</span>
<a href="#l6.311"></a><span id="l6.311" class="difflineminus">-  ; removed and other ugly things will happen like recreation of the registry</span>
<a href="#l6.312"></a><span id="l6.312" class="difflineminus">-  ; key by the OS under some conditions.</span>
<a href="#l6.313"></a><span id="l6.313" class="difflineplus">+  ; removed and other ugly things will happen like recreation of the app's</span>
<a href="#l6.314"></a><span id="l6.314" class="difflineplus">+  ; clients registry key by the OS under some conditions.</span>
<a href="#l6.315"></a><span id="l6.315">   System::Call &quot;shell32::SHChangeNotify(i, i, i, i) v (0x08000000, 0, 0, 0)&quot;</span>
<a href="#l6.316"></a><span id="l6.316"> SectionEnd</span>
<a href="#l6.317"></a><span id="l6.317"> </span>
<a href="#l6.318"></a><span id="l6.318"> ################################################################################</span>
<a href="#l6.319"></a><span id="l6.319"> # Helper Functions</span>
<a href="#l6.320"></a><span id="l6.320"> </span>
<a href="#l6.321"></a><span id="l6.321" class="difflineminus">-Function un.RemoveFilesCallback</span>
<a href="#l6.322"></a><span id="l6.322" class="difflineminus">-  ${un.TrimNewLines} &quot;$R9&quot; &quot;$R9&quot;</span>
<a href="#l6.323"></a><span id="l6.323" class="difflineminus">-  StrCpy $R1 &quot;$R9&quot; 5</span>
<a href="#l6.324"></a><span id="l6.324" class="difflineminus">-  ${If} $R1 == &quot;File:&quot;</span>
<a href="#l6.325"></a><span id="l6.325" class="difflineminus">-    StrCpy $R9 &quot;$R9&quot; &quot;&quot; 6</span>
<a href="#l6.326"></a><span id="l6.326" class="difflineminus">-    StrCpy $R0 &quot;$R9&quot; 1</span>
<a href="#l6.327"></a><span id="l6.327" class="difflineminus">-    ; If the path is relative prepend the install directory</span>
<a href="#l6.328"></a><span id="l6.328" class="difflineminus">-    ${If} $R0 == &quot;\&quot;</span>
<a href="#l6.329"></a><span id="l6.329" class="difflineminus">-      StrCpy $R0 &quot;$INSTDIR$R9&quot;</span>
<a href="#l6.330"></a><span id="l6.330" class="difflineminus">-    ${Else}</span>
<a href="#l6.331"></a><span id="l6.331" class="difflineminus">-      StrCpy $R0 &quot;$R9&quot;</span>
<a href="#l6.332"></a><span id="l6.332" class="difflineminus">-    ${EndIf}</span>
<a href="#l6.333"></a><span id="l6.333" class="difflineminus">-    ${If} ${FileExists} &quot;$R0&quot;</span>
<a href="#l6.334"></a><span id="l6.334" class="difflineminus">-      ${DeleteFile} &quot;$R0&quot;</span>
<a href="#l6.335"></a><span id="l6.335" class="difflineminus">-    ${EndIf}</span>
<a href="#l6.336"></a><span id="l6.336" class="difflineminus">-  ${EndIf}</span>
<a href="#l6.337"></a><span id="l6.337" class="difflineminus">-  ClearErrors</span>
<a href="#l6.338"></a><span id="l6.338" class="difflineminus">-  Push 0</span>
<a href="#l6.339"></a><span id="l6.339" class="difflineminus">-FunctionEnd</span>
<a href="#l6.340"></a><span id="l6.340" class="difflineminus">-</span>
<a href="#l6.341"></a><span id="l6.341" class="difflineminus">-; Using locate will leave file handles open to some of the directories which</span>
<a href="#l6.342"></a><span id="l6.342" class="difflineminus">-; will prevent the deletion of these directories. This parses the uninstall.log</span>
<a href="#l6.343"></a><span id="l6.343" class="difflineminus">-; and uses the file entries to find / remove empty directories.</span>
<a href="#l6.344"></a><span id="l6.344" class="difflineminus">-Function un.RemoveDirsCallback</span>
<a href="#l6.345"></a><span id="l6.345" class="difflineminus">-  ${un.TrimNewLines} &quot;$R9&quot; &quot;$R9&quot;</span>
<a href="#l6.346"></a><span id="l6.346" class="difflineminus">-  StrCpy $R1 &quot;$R9&quot; 5</span>
<a href="#l6.347"></a><span id="l6.347" class="difflineminus">-  ${If} $R1 == &quot;File:&quot;</span>
<a href="#l6.348"></a><span id="l6.348" class="difflineminus">-    StrCpy $R9 &quot;$R9&quot; &quot;&quot; 6</span>
<a href="#l6.349"></a><span id="l6.349" class="difflineminus">-    StrCpy $R1 &quot;$R9&quot; 1</span>
<a href="#l6.350"></a><span id="l6.350" class="difflineminus">-    ${If} $R1 == &quot;\&quot;</span>
<a href="#l6.351"></a><span id="l6.351" class="difflineminus">-      StrCpy $R2 &quot;$INSTDIR&quot;</span>
<a href="#l6.352"></a><span id="l6.352" class="difflineminus">-      StrCpy $R1 &quot;$INSTDIR$R9&quot;</span>
<a href="#l6.353"></a><span id="l6.353" class="difflineminus">-    ${Else}</span>
<a href="#l6.354"></a><span id="l6.354" class="difflineminus">-      StrCpy $R2 &quot;&quot;</span>
<a href="#l6.355"></a><span id="l6.355" class="difflineminus">-      StrCpy $R1 &quot;$R9&quot;</span>
<a href="#l6.356"></a><span id="l6.356" class="difflineminus">-    ${EndIf}</span>
<a href="#l6.357"></a><span id="l6.357" class="difflineminus">-    loop:</span>
<a href="#l6.358"></a><span id="l6.358" class="difflineminus">-      Push $R1</span>
<a href="#l6.359"></a><span id="l6.359" class="difflineminus">-      ${GetParentDir}</span>
<a href="#l6.360"></a><span id="l6.360" class="difflineminus">-      Pop $R0</span>
<a href="#l6.361"></a><span id="l6.361" class="difflineminus">-      GetFullPathName $R1 &quot;$R0&quot;</span>
<a href="#l6.362"></a><span id="l6.362" class="difflineminus">-      ; We only try to remove empty directories but the Desktop, StartMenu, and</span>
<a href="#l6.363"></a><span id="l6.363" class="difflineminus">-      ; QuickLaunch directories can be empty so guard against removing them.</span>
<a href="#l6.364"></a><span id="l6.364" class="difflineminus">-      ${If} &quot;$R2&quot; != &quot;$INSTDIR&quot;</span>
<a href="#l6.365"></a><span id="l6.365" class="difflineminus">-        SetShellVarContext all</span>
<a href="#l6.366"></a><span id="l6.366" class="difflineminus">-        ${If} $R1 == &quot;$DESKTOP&quot;</span>
<a href="#l6.367"></a><span id="l6.367" class="difflineminus">-        ${OrIf} $R1 == &quot;$STARTMENU&quot;</span>
<a href="#l6.368"></a><span id="l6.368" class="difflineminus">-          GoTo end</span>
<a href="#l6.369"></a><span id="l6.369" class="difflineminus">-        ${EndIf}</span>
<a href="#l6.370"></a><span id="l6.370" class="difflineminus">-        SetShellVarContext current</span>
<a href="#l6.371"></a><span id="l6.371" class="difflineminus">-        ${If} $R1 == &quot;$QUICKLAUNCH&quot;</span>
<a href="#l6.372"></a><span id="l6.372" class="difflineminus">-        ${OrIf} $R1 == &quot;$DESKTOP&quot;</span>
<a href="#l6.373"></a><span id="l6.373" class="difflineminus">-        ${OrIf} $R1 == &quot;$STARTMENU&quot;</span>
<a href="#l6.374"></a><span id="l6.374" class="difflineminus">-          GoTo end</span>
<a href="#l6.375"></a><span id="l6.375" class="difflineminus">-        ${EndIf}</span>
<a href="#l6.376"></a><span id="l6.376" class="difflineminus">-      ${ElseIf} &quot;$R1&quot; == &quot;$INSTDIR&quot;</span>
<a href="#l6.377"></a><span id="l6.377" class="difflineminus">-        GoTo end</span>
<a href="#l6.378"></a><span id="l6.378" class="difflineminus">-      ${EndIf}</span>
<a href="#l6.379"></a><span id="l6.379" class="difflineminus">-      ${If} ${FileExists} &quot;$R1&quot;</span>
<a href="#l6.380"></a><span id="l6.380" class="difflineminus">-        RmDir &quot;$R1&quot;</span>
<a href="#l6.381"></a><span id="l6.381" class="difflineminus">-      ${EndIf}</span>
<a href="#l6.382"></a><span id="l6.382" class="difflineminus">-      ${If} ${Errors}</span>
<a href="#l6.383"></a><span id="l6.383" class="difflineminus">-      ${OrIf} &quot;$R2&quot; != &quot;$INSTDIR&quot;</span>
<a href="#l6.384"></a><span id="l6.384" class="difflineminus">-        GoTo end</span>
<a href="#l6.385"></a><span id="l6.385" class="difflineminus">-      ${EndIf}</span>
<a href="#l6.386"></a><span id="l6.386" class="difflineminus">-      GoTo loop</span>
<a href="#l6.387"></a><span id="l6.387" class="difflineminus">-  ${EndIf}</span>
<a href="#l6.388"></a><span id="l6.388" class="difflineminus">-</span>
<a href="#l6.389"></a><span id="l6.389" class="difflineminus">-  end:</span>
<a href="#l6.390"></a><span id="l6.390" class="difflineminus">-    ClearErrors</span>
<a href="#l6.391"></a><span id="l6.391" class="difflineminus">-    Push 0</span>
<a href="#l6.392"></a><span id="l6.392" class="difflineminus">-FunctionEnd</span>
<a href="#l6.393"></a><span id="l6.393" class="difflineminus">-</span>
<a href="#l6.394"></a><span id="l6.394" class="difflineminus">-Function un.UnRegDLLsCallback</span>
<a href="#l6.395"></a><span id="l6.395" class="difflineminus">-  ${un.TrimNewLines} &quot;$R9&quot; &quot;$R9&quot;</span>
<a href="#l6.396"></a><span id="l6.396" class="difflineminus">-  StrCpy $R1 &quot;$R9&quot; 7</span>
<a href="#l6.397"></a><span id="l6.397" class="difflineminus">-  ${If} $R1 == &quot;DLLReg:&quot;</span>
<a href="#l6.398"></a><span id="l6.398" class="difflineminus">-    StrCpy $R9 &quot;$R9&quot; &quot;&quot; 8</span>
<a href="#l6.399"></a><span id="l6.399" class="difflineminus">-    StrCpy $R1 &quot;$R9&quot; 1</span>
<a href="#l6.400"></a><span id="l6.400" class="difflineminus">-    ${If} $R1 == &quot;\&quot;</span>
<a href="#l6.401"></a><span id="l6.401" class="difflineminus">-      StrCpy $R1 &quot;$INSTDIR$R9&quot;</span>
<a href="#l6.402"></a><span id="l6.402" class="difflineminus">-    ${Else}</span>
<a href="#l6.403"></a><span id="l6.403" class="difflineminus">-      StrCpy $R1 &quot;$R9&quot;</span>
<a href="#l6.404"></a><span id="l6.404" class="difflineminus">-    ${EndIf}</span>
<a href="#l6.405"></a><span id="l6.405" class="difflineminus">-    UnRegDLL $R1</span>
<a href="#l6.406"></a><span id="l6.406" class="difflineminus">-  ${EndIf}</span>
<a href="#l6.407"></a><span id="l6.407" class="difflineminus">-  ClearErrors</span>
<a href="#l6.408"></a><span id="l6.408" class="difflineminus">-  Push 0</span>
<a href="#l6.409"></a><span id="l6.409" class="difflineminus">-FunctionEnd</span>
<a href="#l6.410"></a><span id="l6.410" class="difflineminus">-</span>
<a href="#l6.411"></a><span id="l6.411" class="difflineminus">-; Setup the survey controls, functions, etc. except when the application has</span>
<a href="#l6.412"></a><span id="l6.412" class="difflineplus">+; Don't setup the survey controls, functions, etc. when the application has</span>
<a href="#l6.413"></a><span id="l6.413"> ; defined NO_UNINSTALL_SURVEY</span>
<a href="#l6.414"></a><span id="l6.414"> !ifndef NO_UNINSTALL_SURVEY</span>
<a href="#l6.415"></a><span id="l6.415"> Function un.Survey</span>
<a href="#l6.416"></a><span id="l6.416">   ExecShell &quot;open&quot; &quot;${SurveyURL}&quot;</span>
<a href="#l6.417"></a><span id="l6.417"> FunctionEnd</span>
<a href="#l6.418"></a><span id="l6.418"> !endif</span>
<a href="#l6.419"></a><span id="l6.419"> </span>
<a href="#l6.420"></a><span id="l6.420"> ################################################################################</span>
<a href="#l6.421"></a><span id="l6.421" class="difflineat">@@ -330,76 +309,156 @@ FunctionEnd</span>
<a href="#l6.422"></a><span id="l6.422"> !include &quot;customLocale.nsh&quot;</span>
<a href="#l6.423"></a><span id="l6.423"> !verbose pop</span>
<a href="#l6.424"></a><span id="l6.424"> </span>
<a href="#l6.425"></a><span id="l6.425"> ; Set this after the locale files to override it if it is in the locale. Using</span>
<a href="#l6.426"></a><span id="l6.426"> ; &quot; &quot; for BrandingText will hide the &quot;Nullsoft Install System...&quot; branding.</span>
<a href="#l6.427"></a><span id="l6.427"> BrandingText &quot; &quot;</span>
<a href="#l6.428"></a><span id="l6.428"> </span>
<a href="#l6.429"></a><span id="l6.429"> ################################################################################</span>
<a href="#l6.430"></a><span id="l6.430" class="difflineminus">-# Page pre and leave functions</span>
<a href="#l6.431"></a><span id="l6.431" class="difflineplus">+# Page pre, show, and leave functions</span>
<a href="#l6.432"></a><span id="l6.432"> </span>
<a href="#l6.433"></a><span id="l6.433" class="difflineminus">-; Checks if the app being uninstalled is running.</span>
<a href="#l6.434"></a><span id="l6.434" class="difflineminus">-Function un.preInstFiles</span>
<a href="#l6.435"></a><span id="l6.435" class="difflineminus">-  ; Try to delete the app executable and if we can't delete it try to close the</span>
<a href="#l6.436"></a><span id="l6.436" class="difflineminus">-  ; app. This allows running an instance that is located in another directory.</span>
<a href="#l6.437"></a><span id="l6.437" class="difflineminus">-  ClearErrors</span>
<a href="#l6.438"></a><span id="l6.438" class="difflineplus">+Function un.preWelcome</span>
<a href="#l6.439"></a><span id="l6.439" class="difflineplus">+  ${If} ${FileExists} &quot;$INSTDIR\distribution\modern-wizard.bmp&quot;</span>
<a href="#l6.440"></a><span id="l6.440" class="difflineplus">+    Delete &quot;$PLUGINSDIR\modern-wizard.bmp&quot;</span>
<a href="#l6.441"></a><span id="l6.441" class="difflineplus">+    CopyFiles /SILENT &quot;$INSTDIR\distribution\modern-wizard.bmp&quot; &quot;$PLUGINSDIR\modern-wizard.bmp&quot;</span>
<a href="#l6.442"></a><span id="l6.442" class="difflineplus">+  ${EndIf}</span>
<a href="#l6.443"></a><span id="l6.443" class="difflineplus">+FunctionEnd</span>
<a href="#l6.444"></a><span id="l6.444" class="difflineplus">+</span>
<a href="#l6.445"></a><span id="l6.445" class="difflineplus">+Function un.leaveWelcome</span>
<a href="#l6.446"></a><span id="l6.446">   ${If} ${FileExists} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l6.447"></a><span id="l6.447" class="difflineminus">-    ${DeleteFile} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l6.448"></a><span id="l6.448" class="difflineminus">-  ${EndIf}</span>
<a href="#l6.449"></a><span id="l6.449" class="difflineminus">-  ${If} ${Errors}</span>
<a href="#l6.450"></a><span id="l6.450" class="difflineminus">-    ClearErrors</span>
<a href="#l6.451"></a><span id="l6.451" class="difflineminus">-    ${un.CloseApp} &quot;true&quot; $(WARN_APP_RUNNING_UNINSTALL)</span>
<a href="#l6.452"></a><span id="l6.452" class="difflineminus">-    ; Delete the app exe to prevent launching the app while we are uninstalling.</span>
<a href="#l6.453"></a><span id="l6.453" class="difflineminus">-    ${DeleteFile} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l6.454"></a><span id="l6.454" class="difflineminus">-    ClearErrors</span>
<a href="#l6.455"></a><span id="l6.455" class="difflineplus">+    Banner::show /NOUNLOAD &quot;$(BANNER_CHECK_EXISTING)&quot;</span>
<a href="#l6.456"></a><span id="l6.456" class="difflineplus">+</span>
<a href="#l6.457"></a><span id="l6.457" class="difflineplus">+    ${If} &quot;$TmpVal&quot; == &quot;FoundMessageWindow&quot;</span>
<a href="#l6.458"></a><span id="l6.458" class="difflineplus">+      Sleep 5000</span>
<a href="#l6.459"></a><span id="l6.459" class="difflineplus">+    ${EndIf}</span>
<a href="#l6.460"></a><span id="l6.460" class="difflineplus">+</span>
<a href="#l6.461"></a><span id="l6.461" class="difflineplus">+    ${PushFilesToCheck}</span>
<a href="#l6.462"></a><span id="l6.462" class="difflineplus">+</span>
<a href="#l6.463"></a><span id="l6.463" class="difflineplus">+    ${un.CheckForFilesInUse} $TmpVal</span>
<a href="#l6.464"></a><span id="l6.464" class="difflineplus">+</span>
<a href="#l6.465"></a><span id="l6.465" class="difflineplus">+    Banner::destroy</span>
<a href="#l6.466"></a><span id="l6.466" class="difflineplus">+</span>
<a href="#l6.467"></a><span id="l6.467" class="difflineplus">+    ${If} &quot;$TmpVal&quot; == &quot;true&quot;</span>
<a href="#l6.468"></a><span id="l6.468" class="difflineplus">+      StrCpy $TmpVal &quot;FoundMessageWindow&quot;</span>
<a href="#l6.469"></a><span id="l6.469" class="difflineplus">+      ${un.ManualCloseAppPrompt} &quot;${WindowClass}&quot; &quot;$(WARN_MANUALLY_CLOSE_APP_UNINSTALL)&quot;</span>
<a href="#l6.470"></a><span id="l6.470" class="difflineplus">+      StrCpy $TmpVal &quot;true&quot;</span>
<a href="#l6.471"></a><span id="l6.471" class="difflineplus">+    ${EndIf}</span>
<a href="#l6.472"></a><span id="l6.472">   ${EndIf}</span>
<a href="#l6.473"></a><span id="l6.473"> FunctionEnd</span>
<a href="#l6.474"></a><span id="l6.474"> </span>
<a href="#l6.475"></a><span id="l6.475" class="difflineminus">-; When we add an optional action to the finish page the cancel button is</span>
<a href="#l6.476"></a><span id="l6.476" class="difflineminus">-; enabled. This disables it and leaves the finish button as the only choice.</span>
<a href="#l6.477"></a><span id="l6.477" class="difflineminus">-Function un.preFinish</span>
<a href="#l6.478"></a><span id="l6.478" class="difflineminus">-  !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;settings&quot; &quot;cancelenabled&quot; &quot;0&quot;</span>
<a href="#l6.479"></a><span id="l6.479" class="difflineplus">+Function un.preConfirm</span>
<a href="#l6.480"></a><span id="l6.480" class="difflineplus">+  ${If} ${FileExists} &quot;$INSTDIR\distribution\modern-header.bmp&quot;</span>
<a href="#l6.481"></a><span id="l6.481" class="difflineplus">+  ${AndIf} $hHeaderBitmap == &quot;&quot;</span>
<a href="#l6.482"></a><span id="l6.482" class="difflineplus">+    Delete &quot;$PLUGINSDIR\modern-header.bmp&quot;</span>
<a href="#l6.483"></a><span id="l6.483" class="difflineplus">+    CopyFiles /SILENT &quot;$INSTDIR\distribution\modern-header.bmp&quot; &quot;$PLUGINSDIR\modern-header.bmp&quot;</span>
<a href="#l6.484"></a><span id="l6.484" class="difflineplus">+    ${un.ChangeMUIHeaderImage} &quot;$PLUGINSDIR\modern-header.bmp&quot;</span>
<a href="#l6.485"></a><span id="l6.485" class="difflineplus">+  ${EndIf}</span>
<a href="#l6.486"></a><span id="l6.486" class="difflineplus">+</span>
<a href="#l6.487"></a><span id="l6.487" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Settings&quot; NumFields &quot;3&quot;</span>
<a href="#l6.488"></a><span id="l6.488" class="difflineplus">+</span>
<a href="#l6.489"></a><span id="l6.489" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 1&quot; Type   &quot;label&quot;</span>
<a href="#l6.490"></a><span id="l6.490" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 1&quot; Text   &quot;$(UN_CONFIRM_UNINSTALLED_FROM)&quot;</span>
<a href="#l6.491"></a><span id="l6.491" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 1&quot; Left   &quot;0&quot;</span>
<a href="#l6.492"></a><span id="l6.492" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 1&quot; Right  &quot;-1&quot;</span>
<a href="#l6.493"></a><span id="l6.493" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 1&quot; Top    &quot;5&quot;</span>
<a href="#l6.494"></a><span id="l6.494" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 1&quot; Bottom &quot;15&quot;</span>
<a href="#l6.495"></a><span id="l6.495" class="difflineplus">+</span>
<a href="#l6.496"></a><span id="l6.496" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 2&quot; Type   &quot;text&quot;</span>
<a href="#l6.497"></a><span id="l6.497" class="difflineplus">+  ; The contents of this control must be set as follows in the pre function</span>
<a href="#l6.498"></a><span id="l6.498" class="difflineplus">+  ; ${MUI_INSTALLOPTIONS_READ} $1 &quot;unconfirm.ini&quot; &quot;Field 2&quot; &quot;HWND&quot;</span>
<a href="#l6.499"></a><span id="l6.499" class="difflineplus">+  ; SendMessage $1 ${WM_SETTEXT} 0 &quot;STR:$INSTDIR&quot;</span>
<a href="#l6.500"></a><span id="l6.500" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 2&quot; State  &quot;&quot;</span>
<a href="#l6.501"></a><span id="l6.501" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 2&quot; Left   &quot;0&quot;</span>
<a href="#l6.502"></a><span id="l6.502" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 2&quot; Right  &quot;-1&quot;</span>
<a href="#l6.503"></a><span id="l6.503" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 2&quot; Top    &quot;17&quot;</span>
<a href="#l6.504"></a><span id="l6.504" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 2&quot; Bottom &quot;30&quot;</span>
<a href="#l6.505"></a><span id="l6.505" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 2&quot; flags  &quot;READONLY&quot;</span>
<a href="#l6.506"></a><span id="l6.506" class="difflineplus">+</span>
<a href="#l6.507"></a><span id="l6.507" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 3&quot; Type   &quot;label&quot;</span>
<a href="#l6.508"></a><span id="l6.508" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 3&quot; Text   &quot;$(UN_CONFIRM_CLICK)&quot;</span>
<a href="#l6.509"></a><span id="l6.509" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 3&quot; Left   &quot;0&quot;</span>
<a href="#l6.510"></a><span id="l6.510" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 3&quot; Right  &quot;-1&quot;</span>
<a href="#l6.511"></a><span id="l6.511" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 3&quot; Top    &quot;130&quot;</span>
<a href="#l6.512"></a><span id="l6.512" class="difflineplus">+  WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 3&quot; Bottom &quot;150&quot;</span>
<a href="#l6.513"></a><span id="l6.513" class="difflineplus">+</span>
<a href="#l6.514"></a><span id="l6.514" class="difflineplus">+  ${If} &quot;$TmpVal&quot; == &quot;true&quot;</span>
<a href="#l6.515"></a><span id="l6.515" class="difflineplus">+    WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 4&quot; Type   &quot;label&quot;</span>
<a href="#l6.516"></a><span id="l6.516" class="difflineplus">+    WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 4&quot; Text   &quot;$(SUMMARY_REBOOT_REQUIRED_UNINSTALL)&quot;</span>
<a href="#l6.517"></a><span id="l6.517" class="difflineplus">+    WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 4&quot; Left   &quot;0&quot;</span>
<a href="#l6.518"></a><span id="l6.518" class="difflineplus">+    WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 4&quot; Right  &quot;-1&quot;</span>
<a href="#l6.519"></a><span id="l6.519" class="difflineplus">+    WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 4&quot; Top    &quot;35&quot;</span>
<a href="#l6.520"></a><span id="l6.520" class="difflineplus">+    WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Field 4&quot; Bottom &quot;45&quot;</span>
<a href="#l6.521"></a><span id="l6.521"> </span>
<a href="#l6.522"></a><span id="l6.522" class="difflineminus">-  ; Setup the survey controls, functions, etc. except when the application has</span>
<a href="#l6.523"></a><span id="l6.523" class="difflineminus">-  ; defined NO_UNINSTALL_SURVEY</span>
<a href="#l6.524"></a><span id="l6.524" class="difflineminus">-  !ifdef NO_UNINSTALL_SURVEY</span>
<a href="#l6.525"></a><span id="l6.525" class="difflineminus">-    !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;settings&quot; &quot;NumFields&quot; &quot;3&quot;</span>
<a href="#l6.526"></a><span id="l6.526" class="difflineminus">-  !endif</span>
<a href="#l6.527"></a><span id="l6.527" class="difflineplus">+    WriteINIStr &quot;$PLUGINSDIR\unconfirm.ini&quot; &quot;Settings&quot; NumFields &quot;4&quot;</span>
<a href="#l6.528"></a><span id="l6.528" class="difflineplus">+  ${EndIf}</span>
<a href="#l6.529"></a><span id="l6.529" class="difflineplus">+</span>
<a href="#l6.530"></a><span id="l6.530" class="difflineplus">+  !insertmacro MUI_HEADER_TEXT &quot;$(UN_CONFIRM_PAGE_TITLE)&quot; &quot;$(UN_CONFIRM_PAGE_SUBTITLE)&quot;</span>
<a href="#l6.531"></a><span id="l6.531" class="difflineplus">+  ; The Summary custom page has a textbox that will automatically receive</span>
<a href="#l6.532"></a><span id="l6.532" class="difflineplus">+  ; focus. This sets the focus to the Install button instead.</span>
<a href="#l6.533"></a><span id="l6.533" class="difflineplus">+  !insertmacro MUI_INSTALLOPTIONS_INITDIALOG &quot;unconfirm.ini&quot;</span>
<a href="#l6.534"></a><span id="l6.534" class="difflineplus">+  GetDlgItem $0 $HWNDPARENT 1</span>
<a href="#l6.535"></a><span id="l6.535" class="difflineplus">+  System::Call &quot;user32::SetFocus(i r0, i 0x0007, i,i)i&quot;</span>
<a href="#l6.536"></a><span id="l6.536" class="difflineplus">+  ${MUI_INSTALLOPTIONS_READ} $1 &quot;unconfirm.ini&quot; &quot;Field 2&quot; &quot;HWND&quot;</span>
<a href="#l6.537"></a><span id="l6.537" class="difflineplus">+  SendMessage $1 ${WM_SETTEXT} 0 &quot;STR:$INSTDIR&quot;</span>
<a href="#l6.538"></a><span id="l6.538" class="difflineplus">+  !insertmacro MUI_INSTALLOPTIONS_SHOW</span>
<a href="#l6.539"></a><span id="l6.539"> FunctionEnd</span>
<a href="#l6.540"></a><span id="l6.540"> </span>
<a href="#l6.541"></a><span id="l6.541" class="difflineplus">+Function un.leaveConfirm</span>
<a href="#l6.542"></a><span id="l6.542" class="difflineplus">+  ; Try to delete the app executable and if we can't delete it try to find the</span>
<a href="#l6.543"></a><span id="l6.543" class="difflineplus">+  ; app's message window and prompt the user to close the app. This allows</span>
<a href="#l6.544"></a><span id="l6.544" class="difflineplus">+  ; running an instance that is located in another directory. If for whatever</span>
<a href="#l6.545"></a><span id="l6.545" class="difflineplus">+  ; reason there is no message window we will just rename the app's files and</span>
<a href="#l6.546"></a><span id="l6.546" class="difflineplus">+  ; then remove them on restart if they are in use.</span>
<a href="#l6.547"></a><span id="l6.547" class="difflineplus">+  ClearErrors</span>
<a href="#l6.548"></a><span id="l6.548" class="difflineplus">+  ${DeleteFile} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l6.549"></a><span id="l6.549" class="difflineplus">+  ${If} ${Errors}</span>
<a href="#l6.550"></a><span id="l6.550" class="difflineplus">+    ${un.ManualCloseAppPrompt} &quot;${WindowClass}&quot; &quot;$(WARN_MANUALLY_CLOSE_APP_UNINSTALL)&quot;</span>
<a href="#l6.551"></a><span id="l6.551" class="difflineplus">+  ${EndIf}</span>
<a href="#l6.552"></a><span id="l6.552" class="difflineplus">+FunctionEnd</span>
<a href="#l6.553"></a><span id="l6.553" class="difflineplus">+</span>
<a href="#l6.554"></a><span id="l6.554" class="difflineplus">+!ifndef NO_UNINSTALL_SURVEY</span>
<a href="#l6.555"></a><span id="l6.555" class="difflineplus">+Function un.preFinish</span>
<a href="#l6.556"></a><span id="l6.556" class="difflineplus">+  ; Do not modify the finish page if there is a reboot pending.</span>
<a href="#l6.557"></a><span id="l6.557" class="difflineplus">+  ${Unless} ${RebootFlag}</span>
<a href="#l6.558"></a><span id="l6.558" class="difflineplus">+    ; Don't display the option to take a survey on the finish page if the OS is</span>
<a href="#l6.559"></a><span id="l6.559" class="difflineplus">+    ; Vista or above since the process will be running elevated.</span>
<a href="#l6.560"></a><span id="l6.560" class="difflineplus">+    ${If} ${AtLeastWinVista}</span>
<a href="#l6.561"></a><span id="l6.561" class="difflineplus">+      !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;settings&quot; &quot;NumFields&quot; &quot;3&quot;</span>
<a href="#l6.562"></a><span id="l6.562" class="difflineplus">+    ${Else}</span>
<a href="#l6.563"></a><span id="l6.563" class="difflineplus">+      ; When we add an optional action to the finish page the cancel button</span>
<a href="#l6.564"></a><span id="l6.564" class="difflineplus">+      ; is enabled. This disables it and leaves the finish button as the</span>
<a href="#l6.565"></a><span id="l6.565" class="difflineplus">+      ; only choice.</span>
<a href="#l6.566"></a><span id="l6.566" class="difflineplus">+      !insertmacro MUI_INSTALLOPTIONS_WRITE &quot;ioSpecial.ini&quot; &quot;settings&quot; &quot;cancelenabled&quot; &quot;0&quot;</span>
<a href="#l6.567"></a><span id="l6.567" class="difflineplus">+    ${EndIf}</span>
<a href="#l6.568"></a><span id="l6.568" class="difflineplus">+  ${EndUnless}</span>
<a href="#l6.569"></a><span id="l6.569" class="difflineplus">+FunctionEnd</span>
<a href="#l6.570"></a><span id="l6.570" class="difflineplus">+!endif</span>
<a href="#l6.571"></a><span id="l6.571" class="difflineplus">+</span>
<a href="#l6.572"></a><span id="l6.572"> ################################################################################</span>
<a href="#l6.573"></a><span id="l6.573"> # Initialization Functions</span>
<a href="#l6.574"></a><span id="l6.574"> </span>
<a href="#l6.575"></a><span id="l6.575"> Function .onInit</span>
<a href="#l6.576"></a><span id="l6.576" class="difflineminus">-  GetFullPathName $INSTDIR &quot;$EXEDIR\..&quot;</span>
<a href="#l6.577"></a><span id="l6.577" class="difflineminus">-  ${Unless} ${FileExists} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l6.578"></a><span id="l6.578" class="difflineminus">-    Abort</span>
<a href="#l6.579"></a><span id="l6.579" class="difflineminus">-  ${EndUnless}</span>
<a href="#l6.580"></a><span id="l6.580" class="difflineminus">-  ${GetParameters} $R0</span>
<a href="#l6.581"></a><span id="l6.581" class="difflineminus">-</span>
<a href="#l6.582"></a><span id="l6.582" class="difflineminus">-  ; XXXrstrong - Add support for setting program access here (e.g. hide and</span>
<a href="#l6.583"></a><span id="l6.583" class="difflineminus">-  ; display shortcuts). See Thunderbird's uninstaller.nsi for an example.</span>
<a href="#l6.584"></a><span id="l6.584" class="difflineminus">-</span>
<a href="#l6.585"></a><span id="l6.585" class="difflineminus">-  ; If we made it this far then this installer is being used as an uninstaller.</span>
<a href="#l6.586"></a><span id="l6.586" class="difflineminus">-  WriteUninstaller &quot;$EXEDIR\uninstaller.exe&quot;</span>
<a href="#l6.587"></a><span id="l6.587" class="difflineminus">-</span>
<a href="#l6.588"></a><span id="l6.588" class="difflineminus">-  ${If} $R0 == &quot;/S&quot;</span>
<a href="#l6.589"></a><span id="l6.589" class="difflineminus">-    StrCpy $TmpVal &quot;$\&quot;$EXEDIR\uninstaller.exe$\&quot; /S&quot;</span>
<a href="#l6.590"></a><span id="l6.590" class="difflineminus">-  ${Else}</span>
<a href="#l6.591"></a><span id="l6.591" class="difflineminus">-    StrCpy $TmpVal &quot;$\&quot;$EXEDIR\uninstaller.exe$\&quot;&quot;</span>
<a href="#l6.592"></a><span id="l6.592" class="difflineminus">-  ${EndIf}</span>
<a href="#l6.593"></a><span id="l6.593" class="difflineminus">-</span>
<a href="#l6.594"></a><span id="l6.594" class="difflineminus">-  ; When the uninstaller is launched it copies itself to the temp directory so</span>
<a href="#l6.595"></a><span id="l6.595" class="difflineminus">-  ; it won't be in use so it can delete itself.</span>
<a href="#l6.596"></a><span id="l6.596" class="difflineminus">-  ExecWait $TmpVal</span>
<a href="#l6.597"></a><span id="l6.597" class="difflineminus">-  ${DeleteFile} &quot;$EXEDIR\uninstaller.exe&quot;</span>
<a href="#l6.598"></a><span id="l6.598" class="difflineminus">-  SetErrorLevel 0</span>
<a href="#l6.599"></a><span id="l6.599" class="difflineminus">-  Quit</span>
<a href="#l6.600"></a><span id="l6.600" class="difflineplus">+  ${UninstallOnInitCommon}</span>
<a href="#l6.601"></a><span id="l6.601"> FunctionEnd</span>
<a href="#l6.602"></a><span id="l6.602"> </span>
<a href="#l6.603"></a><span id="l6.603"> Function un.onInit</span>
<a href="#l6.604"></a><span id="l6.604">   GetFullPathName $INSTDIR &quot;$INSTDIR\..&quot;</span>
<a href="#l6.605"></a><span id="l6.605" class="difflineplus">+  ${un.GetLongPath} &quot;$INSTDIR&quot; $INSTDIR</span>
<a href="#l6.606"></a><span id="l6.606">   ${Unless} ${FileExists} &quot;$INSTDIR\${FileMainEXE}&quot;</span>
<a href="#l6.607"></a><span id="l6.607">     Abort</span>
<a href="#l6.608"></a><span id="l6.608">   ${EndUnless}</span>
<a href="#l6.609"></a><span id="l6.609" class="difflineplus">+</span>
<a href="#l6.610"></a><span id="l6.610">   StrCpy $LANGUAGE 0</span>
<a href="#l6.611"></a><span id="l6.611" class="difflineplus">+  ${un.SetBrandNameVars} &quot;$INSTDIR\distribution\setup.ini&quot;</span>
<a href="#l6.612"></a><span id="l6.612" class="difflineplus">+</span>
<a href="#l6.613"></a><span id="l6.613" class="difflineplus">+  ; Initialize $hHeaderBitmap to prevent redundant changing of the bitmap if</span>
<a href="#l6.614"></a><span id="l6.614" class="difflineplus">+  ; the user clicks the back button</span>
<a href="#l6.615"></a><span id="l6.615" class="difflineplus">+  StrCpy $hHeaderBitmap &quot;&quot;</span>
<a href="#l6.616"></a><span id="l6.616"> FunctionEnd</span>
<a href="#l6.617"></a><span id="l6.617" class="difflineplus">+</span>
<a href="#l6.618"></a><span id="l6.618" class="difflineplus">+Function .onGUIEnd</span>
<a href="#l6.619"></a><span id="l6.619" class="difflineplus">+  ${OnEndCommon}</span>
<a href="#l6.620"></a><span id="l6.620" class="difflineplus">+FunctionEnd</span>
<a href="#l6.621"></a><span id="l6.621" class="difflineplus">+</span>
<a href="#l6.622"></a><span id="l6.622" class="difflineplus">+Function un.onGUIEnd</span>
<a href="#l6.623"></a><span id="l6.623" class="difflineplus">+  ${un.OnEndCommon}</span>
<a href="#l6.624"></a><span id="l6.624" class="difflineplus">+FunctionEnd</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1">new file mode 100644</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineminus">--- /dev/null</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineplus">+++ b/calendar/installer/windows/nsis/updater_append.ini</span>
<a href="#l7.4"></a><span id="l7.4" class="difflineat">@@ -0,0 +1,12 @@</span>
<a href="#l7.5"></a><span id="l7.5" class="difflineplus">+</span>
<a href="#l7.6"></a><span id="l7.6" class="difflineplus">+; IMPORTANT: This file should always start with a newline in case a locale</span>
<a href="#l7.7"></a><span id="l7.7" class="difflineplus">+; provided updater.ini does not end with a newline.</span>
<a href="#l7.8"></a><span id="l7.8" class="difflineplus">+; Application to launch after an update has been successfully applied. This</span>
<a href="#l7.9"></a><span id="l7.9" class="difflineplus">+; must be in the same directory or a sub-directory of the directory of the</span>
<a href="#l7.10"></a><span id="l7.10" class="difflineplus">+; application executable that initiated the software update.</span>
<a href="#l7.11"></a><span id="l7.11" class="difflineplus">+[PostUpdateWin]</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineplus">+; ExeRelPath is the path to the PostUpdateWin executable relative to the</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+; application executable.</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+ExeRelPath=uninstall\helper.exe</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+; ExeArg is the argument to pass to the PostUpdateWin exe</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+ExeArg=/PostUpdate</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/installer/windows/packages-static</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/installer/windows/packages-static</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -18,17 +18,17 @@ bin\chrome\@AB_CD@.manifest</span>
<a href="#l8.4"></a><span id="l8.4"> bin\chrome\calendar-@AB_CD@.jar</span>
<a href="#l8.5"></a><span id="l8.5"> bin\chrome\calendar-@AB_CD@.manifest</span>
<a href="#l8.6"></a><span id="l8.6"> bin\chrome\sunbird-@AB_CD@.jar</span>
<a href="#l8.7"></a><span id="l8.7"> bin\chrome\sunbird-@AB_CD@.manifest</span>
<a href="#l8.8"></a><span id="l8.8"> bin\defaults\pref\sunbird-l10n.js</span>
<a href="#l8.9"></a><span id="l8.9"> bin\defaults\profile\prefs.js</span>
<a href="#l8.10"></a><span id="l8.10"> bin\defaults\profile\chrome\*</span>
<a href="#l8.11"></a><span id="l8.11"> bin\dictionaries\*</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-bin\uninstall\uninst.exe</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+bin\uninstall\helper.exe</span>
<a href="#l8.14"></a><span id="l8.14"> bin\updater.ini</span>
<a href="#l8.15"></a><span id="l8.15"> </span>
<a href="#l8.16"></a><span id="l8.16"> [xpcom]</span>
<a href="#l8.17"></a><span id="l8.17"> bin\js3250.dll</span>
<a href="#l8.18"></a><span id="l8.18"> bin\plc4.dll</span>
<a href="#l8.19"></a><span id="l8.19"> bin\plds4.dll</span>
<a href="#l8.20"></a><span id="l8.20"> bin\xpcom.dll</span>
<a href="#l8.21"></a><span id="l8.21"> bin\xpcom_core.dll</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/locales/Makefile.in</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/locales/Makefile.in</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -92,19 +92,23 @@ endif</span>
<a href="#l9.4"></a><span id="l9.4"> </span>
<a href="#l9.5"></a><span id="l9.5"> ifeq (,$(filter-out pref,$(MOZ_EXTENSIONS)))</span>
<a href="#l9.6"></a><span id="l9.6"> DEFINES += -DEXTENSION_PREF</span>
<a href="#l9.7"></a><span id="l9.7"> endif</span>
<a href="#l9.8"></a><span id="l9.8"> </span>
<a href="#l9.9"></a><span id="l9.9"> include $(topsrcdir)/config/rules.mk</span>
<a href="#l9.10"></a><span id="l9.10"> </span>
<a href="#l9.11"></a><span id="l9.11"> tests:</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+ifdef MOZ_SUNBIRD</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+ifeq ($(OS_ARCH), WINNT)</span>
<a href="#l9.14"></a><span id="l9.14"> ifneq (en-US, $(AB_CD))</span>
<a href="#l9.15"></a><span id="l9.15" class="difflineminus">-	#@echo &quot;Verifying $(AB_CD) installer variable usage&quot;</span>
<a href="#l9.16"></a><span id="l9.16" class="difflineminus">-	#@$(PERL) $(MOZ_SRCDIR)/toolkit/mozapps/installer/windows/nsis/check-locales.pl $(LOCALE_SRCDIR)/installer</span>
<a href="#l9.17"></a><span id="l9.17" class="difflineplus">+	@echo &quot;Verifying $(AB_CD) installer variable usage $(MOZILLA_SRCDIR)&quot;</span>
<a href="#l9.18"></a><span id="l9.18" class="difflineplus">+	@$(PERL) $(MOZILLA_SRCDIR)/toolkit/mozapps/installer/windows/nsis/check-locales.pl $(LOCALE_SRCDIR)/installer</span>
<a href="#l9.19"></a><span id="l9.19" class="difflineplus">+endif</span>
<a href="#l9.20"></a><span id="l9.20" class="difflineplus">+endif</span>
<a href="#l9.21"></a><span id="l9.21"> endif</span>
<a href="#l9.22"></a><span id="l9.22"> </span>
<a href="#l9.23"></a><span id="l9.23"> clobber-%:</span>
<a href="#l9.24"></a><span id="l9.24"> 	$(RM) -rf $(DIST)/xpi-stage/locale-$*</span>
<a href="#l9.25"></a><span id="l9.25"> </span>
<a href="#l9.26"></a><span id="l9.26"> libs-%:</span>
<a href="#l9.27"></a><span id="l9.27"> 	$(NSINSTALL) -D $(DIST)/install</span>
<a href="#l9.28"></a><span id="l9.28"> 	@$(MAKE) -C ../../mozilla/toolkit/locales libs-$* BOTH_MANIFESTS=1</span>
<a href="#l9.29"></a><span id="l9.29" class="difflineat">@@ -112,17 +116,17 @@ ifdef MOZ_SUNBIRD</span>
<a href="#l9.30"></a><span id="l9.30"> 	@$(MAKE) -C ../sunbird/locales libs AB_CD=$* XPI_NAME=locale-$* PREF_DIR=defaults/pref BOTH_MANIFESTS=1</span>
<a href="#l9.31"></a><span id="l9.31"> endif</span>
<a href="#l9.32"></a><span id="l9.32"> 	@$(MAKE) libs AB_CD=$* XPI_NAME=locale-$* PREF_DIR=defaults/pref BOTH_MANIFESTS=1</span>
<a href="#l9.33"></a><span id="l9.33"> ifdef MOZ_BRANDING_DIRECTORY</span>
<a href="#l9.34"></a><span id="l9.34"> 	@$(MAKE) -C $(DEPTH)/$(MOZ_BRANDING_DIRECTORY)/locales AB_CD=$* XPI_NAME=locale-$* BOTH_MANIFESTS=1</span>
<a href="#l9.35"></a><span id="l9.35"> endif</span>
<a href="#l9.36"></a><span id="l9.36"> 	@$(MAKE) tests AB_CD=$*</span>
<a href="#l9.37"></a><span id="l9.37"> </span>
<a href="#l9.38"></a><span id="l9.38" class="difflineminus">-ifneq (,$(filter mac cocoa,$(MOZ_WIDGET_TOOLKIT)))</span>
<a href="#l9.39"></a><span id="l9.39" class="difflineplus">+ifneq (,$(filter cocoa,$(MOZ_WIDGET_TOOLKIT)))</span>
<a href="#l9.40"></a><span id="l9.40"> MOZ_PKG_MAC_DSSTORE=$(_ABS_DIST)/branding/dsstore</span>
<a href="#l9.41"></a><span id="l9.41"> MOZ_PKG_MAC_BACKGROUND=$(_ABS_DIST)/branding/background.png</span>
<a href="#l9.42"></a><span id="l9.42"> MOZ_PKG_MAC_ICON=$(_ABS_DIST)/branding/disk.icns</span>
<a href="#l9.43"></a><span id="l9.43"> MOZ_PKG_MAC_RSRC=$(_ABS_DIST)/branding/license.r</span>
<a href="#l9.44"></a><span id="l9.44"> endif</span>
<a href="#l9.45"></a><span id="l9.45"> </span>
<a href="#l9.46"></a><span id="l9.46"> PACKAGER_NO_LIBS = 1</span>
<a href="#l9.47"></a><span id="l9.47"> include $(MOZILLA_SRCDIR)/toolkit/mozapps/installer/packager.mk</span>
<a href="#l9.48"></a><span id="l9.48" class="difflineat">@@ -147,44 +151,44 @@ endif</span>
<a href="#l9.49"></a><span id="l9.49"> 	cp -r $(DIST)/xpi-stage/locale-$(AB_CD) l10n-stage/localized</span>
<a href="#l9.50"></a><span id="l9.50"> 	$(RM) -rf $(DIST)/xpi-stage/calendar-timezones</span>
<a href="#l9.51"></a><span id="l9.51"> 	$(MAKE) -C ../timezones libs-$(AB_CD) USE_EXTENSION_MANIFEST=1</span>
<a href="#l9.52"></a><span id="l9.52"> 	mv $(DIST)/xpi-stage/calendar-timezones/chrome l10n-stage/nonlocalized/extensions/calendar-timezones@mozilla.org</span>
<a href="#l9.53"></a><span id="l9.53"> 	mv $(DIST)/xpi-stage/calendar-timezones/chrome.manifest l10n-stage/nonlocalized/extensions/calendar-timezones@mozilla.org</span>
<a href="#l9.54"></a><span id="l9.54"> 	$(MAKE) -C ../installer/windows CONFIG_DIR=l10ngen l10ngen/setup.exe l10ngen/7zSD.sfx</span>
<a href="#l9.55"></a><span id="l9.55"> 	cp ../installer/windows/l10ngen/setup.exe l10n-stage</span>
<a href="#l9.56"></a><span id="l9.56"> 	$(NSINSTALL) -D l10n-stage/localized/uninstall</span>
<a href="#l9.57"></a><span id="l9.57" class="difflineminus">-	cp ../installer/windows/l10ngen/uninst.exe l10n-stage/localized/uninstall</span>
<a href="#l9.58"></a><span id="l9.58" class="difflineplus">+	cp ../installer/windows/l10ngen/helper.exe l10n-stage/localized/uninstall</span>
<a href="#l9.59"></a><span id="l9.59"> 	rm -f app.7z</span>
<a href="#l9.60"></a><span id="l9.60"> 	cd l10n-stage &amp;&amp; \</span>
<a href="#l9.61"></a><span id="l9.61"> 	  $(CYGWIN_WRAPPER) 7z a -r -t7z ../app.7z -mx -m0=BCJ2 -m1=LZMA:d24 -m2=LZMA:d19 -m3=LZMA:d19 -mb0:1 -mb0s1:2 -mb0s2:3</span>
<a href="#l9.62"></a><span id="l9.62"> 	cat ../installer/windows/l10ngen/7zSD.sfx \</span>
<a href="#l9.63"></a><span id="l9.63"> 	    $(topsrcdir)/calendar/installer/windows/app.tag \</span>
<a href="#l9.64"></a><span id="l9.64"> 	    app.7z &gt; $(WIN32_INSTALLER_OUT)</span>
<a href="#l9.65"></a><span id="l9.65"> 	chmod 0755 $(WIN32_INSTALLER_OUT)</span>
<a href="#l9.66"></a><span id="l9.66"> </span>
<a href="#l9.67"></a><span id="l9.67"> ifeq (WINNT,$(OS_ARCH))</span>
<a href="#l9.68"></a><span id="l9.68"> repackage-win32-installer-%: WIN32_INSTALLER_IN=$(_ABS_DIST)/$(PKG_INST_PATH)$(PKG_INST_BASENAME).exe</span>
<a href="#l9.69"></a><span id="l9.69"> repackage-win32-installer-%: $(WIN32_INSTALLER_IN) libs-%</span>
<a href="#l9.70"></a><span id="l9.70"> 	@$(MAKE) repackage-win32-installer AB_CD=$* WIN32_INSTALLER_IN=$(WIN32_INSTALLER_IN)</span>
<a href="#l9.71"></a><span id="l9.71"> else</span>
<a href="#l9.72"></a><span id="l9.72"> repackage-win32-installer-%: ;</span>
<a href="#l9.73"></a><span id="l9.73"> endif</span>
<a href="#l9.74"></a><span id="l9.74"> </span>
<a href="#l9.75"></a><span id="l9.75" class="difflineminus">-ifneq (,$(filter mac cocoa,$(MOZ_WIDGET_TOOLKIT)))</span>
<a href="#l9.76"></a><span id="l9.76" class="difflineplus">+ifneq (,$(filter cocoa,$(MOZ_WIDGET_TOOLKIT)))</span>
<a href="#l9.77"></a><span id="l9.77"> STAGEDIST = $(_ABS_DIST)/l10n-stage/$(MOZ_PKG_APPNAME)/$(_APPNAME)/Contents/MacOS</span>
<a href="#l9.78"></a><span id="l9.78"> else</span>
<a href="#l9.79"></a><span id="l9.79"> STAGEDIST = $(_ABS_DIST)/l10n-stage/$(MOZ_PKG_APPNAME)</span>
<a href="#l9.80"></a><span id="l9.80"> endif</span>
<a href="#l9.81"></a><span id="l9.81"> </span>
<a href="#l9.82"></a><span id="l9.82"> $(STAGEDIST): AB_CD:=en-US</span>
<a href="#l9.83"></a><span id="l9.83"> $(STAGEDIST): UNPACKAGE=$(ZIP_IN)</span>
<a href="#l9.84"></a><span id="l9.84"> $(STAGEDIST): $(ZIP_IN)</span>
<a href="#l9.85"></a><span id="l9.85"> # only mac needs to remove the parent of STAGEDIST...</span>
<a href="#l9.86"></a><span id="l9.86" class="difflineminus">-ifneq (,$(filter mac cocoa,$(MOZ_WIDGET_TOOLKIT)))</span>
<a href="#l9.87"></a><span id="l9.87" class="difflineplus">+ifneq (,$(filter cocoa,$(MOZ_WIDGET_TOOLKIT)))</span>
<a href="#l9.88"></a><span id="l9.88"> 	if test -d $(DIST)/l10n-stage; then \</span>
<a href="#l9.89"></a><span id="l9.89"> 	  $(RM) -r -v $(DIST)/l10n-stage; \</span>
<a href="#l9.90"></a><span id="l9.90"> 	fi</span>
<a href="#l9.91"></a><span id="l9.91"> else</span>
<a href="#l9.92"></a><span id="l9.92"> # ... and windows doesn't like removing STAGEDIST itself, remove all children</span>
<a href="#l9.93"></a><span id="l9.93"> 	if test -d $(DIST)/l10n-stage; then \</span>
<a href="#l9.94"></a><span id="l9.94"> 	  find $(STAGEDIST) -maxdepth 1 -print0 | xargs -0 $(RM) -r ; \</span>
<a href="#l9.95"></a><span id="l9.95"> 	fi</span>
<a href="#l9.96"></a><span id="l9.96" class="difflineat">@@ -225,38 +229,38 @@ unpack: $(STAGEDIST)</span>
<a href="#l9.97"></a><span id="l9.97"> </span>
<a href="#l9.98"></a><span id="l9.98"> repackage-zip: ZIP_OUT=&quot;$(_ABS_DIST)/$(PACKAGE)&quot;</span>
<a href="#l9.99"></a><span id="l9.99"> repackage-zip: UNPACKAGE=&quot;$(ZIP_IN)&quot;</span>
<a href="#l9.100"></a><span id="l9.100"> repackage-zip:</span>
<a href="#l9.101"></a><span id="l9.101"> 	$(MAKE) -C ../timezones libs-$(AB_CD) USE_EXTENSION_MANIFEST=1</span>
<a href="#l9.102"></a><span id="l9.102"> ifeq (WINNT,$(OS_ARCH))</span>
<a href="#l9.103"></a><span id="l9.103"> 	$(RM) -r $(STAGEDIST)/uninstall</span>
<a href="#l9.104"></a><span id="l9.104"> 	$(NSINSTALL) -D $(STAGEDIST)/uninstall</span>
<a href="#l9.105"></a><span id="l9.105" class="difflineminus">-	cp ../installer/windows/l10ngen/uninst.exe $(STAGEDIST)/uninstall</span>
<a href="#l9.106"></a><span id="l9.106" class="difflineplus">+	cp ../installer/windows/l10ngen/helper.exe $(STAGEDIST)/uninstall</span>
<a href="#l9.107"></a><span id="l9.107"> endif</span>
<a href="#l9.108"></a><span id="l9.108"> 	cd $(DIST)/xpi-stage/locale-$(AB_CD) &amp;&amp; \</span>
<a href="#l9.109"></a><span id="l9.109"> 	  tar $(TAR_CREATE_FLAGS) - * | ( cd $(STAGEDIST) &amp;&amp; tar -xf - )</span>
<a href="#l9.110"></a><span id="l9.110"> 	cd $(DIST)/xpi-stage/calendar-timezones &amp;&amp; \</span>
<a href="#l9.111"></a><span id="l9.111"> 	  tar $(TAR_CREATE_FLAGS) - * | ( cd $(STAGEDIST)/extensions/calendar-timezones@mozilla.org &amp;&amp; tar -xf - )</span>
<a href="#l9.112"></a><span id="l9.112"> ifneq (en,$(AB))</span>
<a href="#l9.113"></a><span id="l9.113" class="difflineminus">-ifneq (,$(filter mac cocoa,$(MOZ_WIDGET_TOOLKIT)))</span>
<a href="#l9.114"></a><span id="l9.114" class="difflineplus">+ifneq (,$(filter cocoa,$(MOZ_WIDGET_TOOLKIT)))</span>
<a href="#l9.115"></a><span id="l9.115"> 	mv $(_ABS_DIST)/l10n-stage/$(MOZ_PKG_APPNAME)/$(_APPNAME)/Contents/Resources/en.lproj $(_ABS_DIST)/l10n-stage/$(MOZ_PKG_APPNAME)/$(_APPNAME)/Contents/Resources/$(AB).lproj</span>
<a href="#l9.116"></a><span id="l9.116"> endif</span>
<a href="#l9.117"></a><span id="l9.117"> endif</span>
<a href="#l9.118"></a><span id="l9.118"> 	cd $(DIST)/l10n-stage; \</span>
<a href="#l9.119"></a><span id="l9.119"> 	  $(MAKE_PACKAGE)</span>
<a href="#l9.120"></a><span id="l9.120"> ifdef MOZ_MAKE_COMPLETE_MAR</span>
<a href="#l9.121"></a><span id="l9.121"> 	$(MAKE) -C $(MOZDEPTH)/tools/update-packaging full-update AB_CD=$(AB_CD) \</span>
<a href="#l9.122"></a><span id="l9.122"> 	  MOZ_PKG_PRETTYNAMES=$(MOZ_PKG_PRETTYNAMES) \</span>
<a href="#l9.123"></a><span id="l9.123"> 	  PACKAGE_BASE_DIR=&quot;$(_ABS_DIST)/l10n-stage&quot; \</span>
<a href="#l9.124"></a><span id="l9.124"> 	  DIST=&quot;$(_ABS_DIST)&quot;</span>
<a href="#l9.125"></a><span id="l9.125"> endif</span>
<a href="#l9.126"></a><span id="l9.126"> # packaging done, undo l10n stuff</span>
<a href="#l9.127"></a><span id="l9.127"> ifneq (en,$(AB))</span>
<a href="#l9.128"></a><span id="l9.128" class="difflineminus">-ifneq (,$(filter mac cocoa,$(MOZ_WIDGET_TOOLKIT)))</span>
<a href="#l9.129"></a><span id="l9.129" class="difflineplus">+ifneq (,$(filter cocoa,$(MOZ_WIDGET_TOOLKIT)))</span>
<a href="#l9.130"></a><span id="l9.130"> 	mv $(_ABS_DIST)/l10n-stage/$(MOZ_PKG_APPNAME)/$(_APPNAME)/Contents/Resources/$(AB).lproj $(_ABS_DIST)/l10n-stage/$(MOZ_PKG_APPNAME)/$(_APPNAME)/Contents/Resources/en.lproj</span>
<a href="#l9.131"></a><span id="l9.131"> endif</span>
<a href="#l9.132"></a><span id="l9.132"> endif</span>
<a href="#l9.133"></a><span id="l9.133"> 	$(MAKE) clobber-zip AB_CD=$(AB_CD)</span>
<a href="#l9.134"></a><span id="l9.134"> 	mv -f &quot;$(DIST)/l10n-stage/$(PACKAGE)&quot; &quot;$(DIST)/$(PACKAGE)&quot;</span>
<a href="#l9.135"></a><span id="l9.135"> </span>
<a href="#l9.136"></a><span id="l9.136"> repackage-zip-%: ZIP_IN=$(_ABS_DIST)/$(PACKAGE)</span>
<a href="#l9.137"></a><span id="l9.137"> repackage-zip-%: $(ZIP_IN) $(STAGEDIST) libs-%</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/locales/en-US/installer/custom.properties</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/locales/en-US/installer/custom.properties</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -36,56 +36,68 @@</span>
<a href="#l10.4"></a><span id="l10.4"> </span>
<a href="#l10.5"></a><span id="l10.5"> # LOCALIZATION NOTE:</span>
<a href="#l10.6"></a><span id="l10.6"> </span>
<a href="#l10.7"></a><span id="l10.7"> # This file must be saved as UTF8</span>
<a href="#l10.8"></a><span id="l10.8"> </span>
<a href="#l10.9"></a><span id="l10.9"> # Accesskeys are defined by prefixing the letter that is to be used for the</span>
<a href="#l10.10"></a><span id="l10.10"> # accesskey with an ampersand (e.g. &amp;).</span>
<a href="#l10.11"></a><span id="l10.11"> </span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-# Don't replace ${BrandShortName}, $(^Name), or $(^NameDA) with a custom string.</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+# Do not replace $BrandShortName, $BrandFullName, or $BrandFullNameDA with a</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+# custom string and always use the same one as used by the en-US files.</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+# $BrandFullNameDA allows the string to contain an ampersand (e.g. DA stands</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineplus">+# for double ampersand) and prevents the letter following the ampersand from</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineplus">+# being used as an accesskey.</span>
<a href="#l10.18"></a><span id="l10.18"> </span>
<a href="#l10.19"></a><span id="l10.19"> # You can use \n to create a newline in the string but only when the string</span>
<a href="#l10.20"></a><span id="l10.20"> # from en-US contains a \n.</span>
<a href="#l10.21"></a><span id="l10.21"> </span>
<a href="#l10.22"></a><span id="l10.22" class="difflineminus">-OPTIONAL_COMPONENTS_TITLE=Choose Optional Components</span>
<a href="#l10.23"></a><span id="l10.23" class="difflineminus">-OPTIONAL_COMPONENTS_SUBTITLE=Choose which features of $(^NameDA) you want to install.</span>
<a href="#l10.24"></a><span id="l10.24" class="difflineminus">-OPTIONAL_COMPONENTS_LABEL=Optional Components:</span>
<a href="#l10.25"></a><span id="l10.25" class="difflineminus">-APP_DESC=Required files for the ${BrandShortName} application</span>
<a href="#l10.26"></a><span id="l10.26" class="difflineminus">-DOMI_TITLE=DOM Inspector</span>
<a href="#l10.27"></a><span id="l10.27" class="difflineminus">-DOMI_TEXT=Inspects the structure and properties of a window and its contents.</span>
<a href="#l10.28"></a><span id="l10.28" class="difflineminus">-QFA_TITLE=Quality Feedback Agent</span>
<a href="#l10.29"></a><span id="l10.29" class="difflineminus">-QFA_TEXT=Sends information about program crashes to Mozilla.</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineminus">-OPTIONS=$(^NameDA) &amp;Options</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineplus">+CONTEXT_OPTIONS=$BrandShortName &amp;Options</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+CONTEXT_SAFE_MODE=$BrandShortName &amp;Safe Mode</span>
<a href="#l10.33"></a><span id="l10.33"> SAFE_MODE=Safe Mode</span>
<a href="#l10.34"></a><span id="l10.34"> OPTIONS_PAGE_TITLE=Setup Type</span>
<a href="#l10.35"></a><span id="l10.35"> OPTIONS_PAGE_SUBTITLE=Choose setup options</span>
<a href="#l10.36"></a><span id="l10.36"> SHORTCUTS_PAGE_TITLE=Set Up Shortcuts</span>
<a href="#l10.37"></a><span id="l10.37"> SHORTCUTS_PAGE_SUBTITLE=Create Program Icons</span>
<a href="#l10.38"></a><span id="l10.38" class="difflineminus">-SURVEY_TEXT=&amp;Tell us what you thought of ${BrandShortName}</span>
<a href="#l10.39"></a><span id="l10.39" class="difflineminus">-LAUNCH_TEXT=&amp;Launch $(^Name) now</span>
<a href="#l10.40"></a><span id="l10.40" class="difflineminus">-WARN_APP_RUNNING_INSTALL=$(^Name) must be closed to proceed with the installation.\n\nClick &quot;OK&quot; to exit $(^Name) automatically and continue.</span>
<a href="#l10.41"></a><span id="l10.41" class="difflineminus">-WARN_APP_RUNNING_UNINSTALL=$(^Name) must be closed to proceed with the uninstall.\n\nClick &quot;OK&quot; to exit $(^Name) automatically and continue.</span>
<a href="#l10.42"></a><span id="l10.42" class="difflineminus">-CREATE_ICONS_DESC=Create icons for ${BrandShortName}:</span>
<a href="#l10.43"></a><span id="l10.43" class="difflineplus">+SUMMARY_PAGE_TITLE=Summary</span>
<a href="#l10.44"></a><span id="l10.44" class="difflineplus">+SUMMARY_PAGE_SUBTITLE=Ready to start installing $BrandShortName</span>
<a href="#l10.45"></a><span id="l10.45" class="difflineplus">+SUMMARY_INSTALLED_TO=$BrandShortName will be installed to the following location:</span>
<a href="#l10.46"></a><span id="l10.46" class="difflineplus">+SUMMARY_REBOOT_REQUIRED_INSTALL=A restart of your computer may be required to complete the installation.</span>
<a href="#l10.47"></a><span id="l10.47" class="difflineplus">+SUMMARY_REBOOT_REQUIRED_UNINSTALL=A restart of your computer may be required to complete the uninstall.</span>
<a href="#l10.48"></a><span id="l10.48" class="difflineplus">+SUMMARY_CLICK=Click Install to continue.</span>
<a href="#l10.49"></a><span id="l10.49" class="difflineplus">+SURVEY_TEXT=&amp;Tell us what you thought of $BrandShortName</span>
<a href="#l10.50"></a><span id="l10.50" class="difflineplus">+LAUNCH_TEXT=&amp;Launch $BrandShortName now</span>
<a href="#l10.51"></a><span id="l10.51" class="difflineplus">+CREATE_ICONS_DESC=Create icons for $BrandShortName:</span>
<a href="#l10.52"></a><span id="l10.52"> ICONS_DESKTOP=On my &amp;Desktop</span>
<a href="#l10.53"></a><span id="l10.53"> ICONS_STARTMENU=In my &amp;Start Menu Programs folder</span>
<a href="#l10.54"></a><span id="l10.54"> ICONS_QUICKLAUNCH=In my &amp;Quick Launch bar</span>
<a href="#l10.55"></a><span id="l10.55" class="difflineplus">+WARN_MANUALLY_CLOSE_APP_INSTALL=$BrandShortName must be closed to proceed with the installation.\n\nPlease close $BrandShortName to continue.</span>
<a href="#l10.56"></a><span id="l10.56" class="difflineplus">+WARN_MANUALLY_CLOSE_APP_UNINSTALL=$BrandShortName must be closed to proceed with the uninstall.\n\nPlease close $BrandShortName to continue.</span>
<a href="#l10.57"></a><span id="l10.57" class="difflineplus">+WARN_MANUALLY_CLOSE_APP_LAUNCH=$BrandShortName is already running.\n\nPlease close $BrandShortName prior to launching the version you have just installed.</span>
<a href="#l10.58"></a><span id="l10.58"> WARN_WRITE_ACCESS=You don't have access to write to the installation directory.\n\nClick OK to select a different directory.</span>
<a href="#l10.59"></a><span id="l10.59"> WARN_DISK_SPACE=You don't have sufficient disk space to install to this location.\n\nClick OK to select a different location.</span>
<a href="#l10.60"></a><span id="l10.60" class="difflineplus">+WARN_UNSUPPORTED_MSG=Sorry, $BrandShortName can't be installed. This version of $BrandShortName requires ${MinSupportedVer} or newer.</span>
<a href="#l10.61"></a><span id="l10.61" class="difflineplus">+WARN_RESTART_REQUIRED_UNINSTALL=Your computer must be restarted to complete a previous uninstall of $BrandShortName. Do you want to reboot now?</span>
<a href="#l10.62"></a><span id="l10.62" class="difflineplus">+WARN_RESTART_REQUIRED_UPGRADE=Your computer must be restarted to complete a previous upgrade of $BrandShortName. Do you want to reboot now?</span>
<a href="#l10.63"></a><span id="l10.63" class="difflineplus">+ERROR_CREATE_DIRECTORY_PREFIX=Error creating directory:</span>
<a href="#l10.64"></a><span id="l10.64" class="difflineplus">+ERROR_CREATE_DIRECTORY_SUFFIX=Click Cancel to stop the installation or\nRetry to try again.</span>
<a href="#l10.65"></a><span id="l10.65"> </span>
<a href="#l10.66"></a><span id="l10.66" class="difflineminus">-STATUS_INSTALL_APP=Installing ${BrandShortName}...</span>
<a href="#l10.67"></a><span id="l10.67" class="difflineminus">-STATUS_INSTALL_LANG=Installing Language Files (${AB_CD})...</span>
<a href="#l10.68"></a><span id="l10.68" class="difflineminus">-STATUS_INSTALL_OPTIONAL=Installing Optional Components...</span>
<a href="#l10.69"></a><span id="l10.69" class="difflineminus">-STATUS_UNINSTALL_MAIN=Uninstalling ${BrandShortName}...</span>
<a href="#l10.70"></a><span id="l10.70" class="difflineminus">-STATUS_CLEANUP=A Little Housekeeping...</span>
<a href="#l10.71"></a><span id="l10.71" class="difflineplus">+UN_CONFIRM_PAGE_TITLE=Uninstall $BrandFullName</span>
<a href="#l10.72"></a><span id="l10.72" class="difflineplus">+UN_CONFIRM_PAGE_SUBTITLE=Remove $BrandFullName from your computer.</span>
<a href="#l10.73"></a><span id="l10.73" class="difflineplus">+UN_CONFIRM_UNINSTALLED_FROM=$BrandShortName will be uninstalled from the following location:</span>
<a href="#l10.74"></a><span id="l10.74" class="difflineplus">+UN_CONFIRM_CLICK=Click Uninstall to continue.</span>
<a href="#l10.75"></a><span id="l10.75" class="difflineplus">+</span>
<a href="#l10.76"></a><span id="l10.76" class="difflineplus">+BANNER_CHECK_EXISTING=Checking existing installation…</span>
<a href="#l10.77"></a><span id="l10.77" class="difflineplus">+</span>
<a href="#l10.78"></a><span id="l10.78" class="difflineplus">+STATUS_INSTALL_APP=Installing $BrandShortName…</span>
<a href="#l10.79"></a><span id="l10.79" class="difflineplus">+STATUS_INSTALL_LANG=Installing Language Files (${AB_CD})…</span>
<a href="#l10.80"></a><span id="l10.80" class="difflineplus">+STATUS_UNINSTALL_MAIN=Uninstalling $BrandShortName…</span>
<a href="#l10.81"></a><span id="l10.81" class="difflineplus">+STATUS_CLEANUP=A Little Housekeeping…</span>
<a href="#l10.82"></a><span id="l10.82"> </span>
<a href="#l10.83"></a><span id="l10.83"> # _DESC strings support approximately 65 characters per line.</span>
<a href="#l10.84"></a><span id="l10.84"> # One line</span>
<a href="#l10.85"></a><span id="l10.85"> OPTIONS_SUMMARY=Choose the type of setup you prefer, then click Next.</span>
<a href="#l10.86"></a><span id="l10.86"> # One line</span>
<a href="#l10.87"></a><span id="l10.87" class="difflineminus">-OPTION_STANDARD_DESC=${BrandShortName} will be installed with the most common options.</span>
<a href="#l10.88"></a><span id="l10.88" class="difflineplus">+OPTION_STANDARD_DESC=$BrandShortName will be installed with the most common options.</span>
<a href="#l10.89"></a><span id="l10.89"> OPTION_STANDARD_RADIO=&amp;Standard</span>
<a href="#l10.90"></a><span id="l10.90" class="difflineminus">-# One line</span>
<a href="#l10.91"></a><span id="l10.91" class="difflineminus">-OPTION_COMPLETE_DESC=${BrandShortName} will be installed with all available options.</span>
<a href="#l10.92"></a><span id="l10.92" class="difflineminus">-OPTION_COMPLETE_RADIO=C&amp;omplete</span>
<a href="#l10.93"></a><span id="l10.93"> # Two lines</span>
<a href="#l10.94"></a><span id="l10.94"> OPTION_CUSTOM_DESC=You may choose individual options to be installed. Recommended for experienced users.</span>
<a href="#l10.95"></a><span id="l10.95"> OPTION_CUSTOM_RADIO=&amp;Custom</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/locales/en-US/installer/mui.properties</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/locales/en-US/installer/mui.properties</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -39,58 +39,59 @@</span>
<a href="#l11.4"></a><span id="l11.4"> </span>
<a href="#l11.5"></a><span id="l11.5"> # LOCALIZATION NOTE:</span>
<a href="#l11.6"></a><span id="l11.6"> </span>
<a href="#l11.7"></a><span id="l11.7"> # This file must be saved as UTF8</span>
<a href="#l11.8"></a><span id="l11.8"> </span>
<a href="#l11.9"></a><span id="l11.9"> # Accesskeys are defined by prefixing the letter that is to be used for the</span>
<a href="#l11.10"></a><span id="l11.10"> # accesskey with an ampersand (e.g. &amp;).</span>
<a href="#l11.11"></a><span id="l11.11"> </span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-# Do not replace $(^NameDA) or $(^Name) with a custom string.</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineminus">-</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineminus">-# Do not change $(^NameDA) to $(^Name) or $(^Name) to $(^NameDA). NameDA allows</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineminus">-# Name to contain an ampersand (e.g. DA stands for double ampersand) and</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineminus">-# prevents the letter following the ampersand being used as an accesskey.</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineplus">+# Do not replace $BrandShortName, $BrandFullName, or $BrandFullNameDA with a</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineplus">+# custom string and always use the same one as used by the en-US files.</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineplus">+# $BrandFullNameDA allows the string to contain an ampersand (e.g. DA stands</span>
<a href="#l11.20"></a><span id="l11.20" class="difflineplus">+# for double ampersand) and prevents the letter following the ampersand from</span>
<a href="#l11.21"></a><span id="l11.21" class="difflineplus">+# being used as an accesskey.</span>
<a href="#l11.22"></a><span id="l11.22"> </span>
<a href="#l11.23"></a><span id="l11.23"> # You can use \n to create a newline in the string but only when the string</span>
<a href="#l11.24"></a><span id="l11.24"> # from en-US contains a \n.</span>
<a href="#l11.25"></a><span id="l11.25" class="difflineminus">-MUI_TEXT_WELCOME_INFO_TITLE=Welcome to the $(^NameDA) Setup Wizard</span>
<a href="#l11.26"></a><span id="l11.26" class="difflineminus">-MUI_TEXT_WELCOME_INFO_TEXT=This wizard will guide you through the installation of $(^NameDA).\n\nIt is recommended that you close all other applications before starting Setup. This will make it possible to update relevant system files without having to reboot your computer.\n\n$_CLICK</span>
<a href="#l11.27"></a><span id="l11.27" class="difflineplus">+</span>
<a href="#l11.28"></a><span id="l11.28" class="difflineplus">+MUI_TEXT_WELCOME_INFO_TITLE=Welcome to the $BrandFullNameDA Setup Wizard</span>
<a href="#l11.29"></a><span id="l11.29" class="difflineplus">+MUI_TEXT_WELCOME_INFO_TEXT=This wizard will guide you through the installation of $BrandFullNameDA.\n\nIt is recommended that you close all other applications before starting Setup. This will make it possible to update relevant system files without having to reboot your computer.\n\n$_CLICK</span>
<a href="#l11.30"></a><span id="l11.30"> MUI_TEXT_LICENSE_TITLE=License Agreement</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineminus">-MUI_TEXT_LICENSE_SUBTITLE=Please review the license terms before installing $(^NameDA).</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+MUI_TEXT_LICENSE_SUBTITLE=Please review the license terms before installing $BrandFullNameDA.</span>
<a href="#l11.33"></a><span id="l11.33"> MUI_INNERTEXT_LICENSE_TOP=Press Page Down to see the rest of the agreement.</span>
<a href="#l11.34"></a><span id="l11.34" class="difflineminus">-MUI_INNERTEXT_LICENSE_BOTTOM_RADIOBUTTONS=If you accept the terms of the agreement, select the first option below. You must accept the agreement to install $(^NameDA). $_CLICK</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineplus">+MUI_INNERTEXT_LICENSE_BOTTOM_CHECKBOX=If you accept the terms of the agreement, click the check box below. You must accept the agreement to install $BrandFullNameDA. $_CLICK</span>
<a href="#l11.36"></a><span id="l11.36"> MUI_TEXT_COMPONENTS_TITLE=Choose Components</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineminus">-MUI_TEXT_COMPONENTS_SUBTITLE=Choose which features of $(^NameDA) you want to install.</span>
<a href="#l11.38"></a><span id="l11.38" class="difflineplus">+MUI_TEXT_COMPONENTS_SUBTITLE=Choose which features of $BrandFullNameDA you want to install.</span>
<a href="#l11.39"></a><span id="l11.39"> MUI_INNERTEXT_COMPONENTS_DESCRIPTION_TITLE=Description</span>
<a href="#l11.40"></a><span id="l11.40"> MUI_INNERTEXT_COMPONENTS_DESCRIPTION_INFO=Position your mouse over a component to see its description.</span>
<a href="#l11.41"></a><span id="l11.41"> MUI_TEXT_DIRECTORY_TITLE=Choose Install Location</span>
<a href="#l11.42"></a><span id="l11.42" class="difflineminus">-MUI_TEXT_DIRECTORY_SUBTITLE=Choose the folder in which to install $(^NameDA).</span>
<a href="#l11.43"></a><span id="l11.43" class="difflineplus">+MUI_TEXT_DIRECTORY_SUBTITLE=Choose the folder in which to install $BrandFullNameDA.</span>
<a href="#l11.44"></a><span id="l11.44"> MUI_TEXT_INSTALLING_TITLE=Installing</span>
<a href="#l11.45"></a><span id="l11.45" class="difflineminus">-MUI_TEXT_INSTALLING_SUBTITLE=Please wait while $(^NameDA) is being installed.</span>
<a href="#l11.46"></a><span id="l11.46" class="difflineplus">+MUI_TEXT_INSTALLING_SUBTITLE=Please wait while $BrandFullNameDA is being installed.</span>
<a href="#l11.47"></a><span id="l11.47"> MUI_TEXT_FINISH_TITLE=Installation Complete</span>
<a href="#l11.48"></a><span id="l11.48"> MUI_TEXT_FINISH_SUBTITLE=Setup was completed successfully.</span>
<a href="#l11.49"></a><span id="l11.49"> MUI_TEXT_ABORT_TITLE=Installation Aborted</span>
<a href="#l11.50"></a><span id="l11.50"> MUI_TEXT_ABORT_SUBTITLE=Setup was not completed successfully.</span>
<a href="#l11.51"></a><span id="l11.51"> MUI_BUTTONTEXT_FINISH=&amp;Finish</span>
<a href="#l11.52"></a><span id="l11.52" class="difflineminus">-MUI_TEXT_FINISH_INFO_TITLE=Completing the $(^NameDA) Setup Wizard</span>
<a href="#l11.53"></a><span id="l11.53" class="difflineminus">-MUI_TEXT_FINISH_INFO_TEXT=$(^NameDA) has been installed on your computer.\n\nClick Finish to close this wizard.</span>
<a href="#l11.54"></a><span id="l11.54" class="difflineminus">-MUI_TEXT_FINISH_INFO_REBOOT=Your computer must be restarted in order to complete the installation of $(^NameDA). Do you want to reboot now?</span>
<a href="#l11.55"></a><span id="l11.55" class="difflineplus">+MUI_TEXT_FINISH_INFO_TITLE=Completing the $BrandFullNameDA Setup Wizard</span>
<a href="#l11.56"></a><span id="l11.56" class="difflineplus">+MUI_TEXT_FINISH_INFO_TEXT=$BrandFullNameDA has been installed on your computer.\n\nClick Finish to close this wizard.</span>
<a href="#l11.57"></a><span id="l11.57" class="difflineplus">+MUI_TEXT_FINISH_INFO_REBOOT=Your computer must be restarted in order to complete the installation of $BrandFullNameDA. Do you want to reboot now?</span>
<a href="#l11.58"></a><span id="l11.58"> MUI_TEXT_FINISH_REBOOTNOW=Reboot now</span>
<a href="#l11.59"></a><span id="l11.59"> MUI_TEXT_FINISH_REBOOTLATER=I want to manually reboot later</span>
<a href="#l11.60"></a><span id="l11.60"> MUI_TEXT_STARTMENU_TITLE=Choose Start Menu Folder</span>
<a href="#l11.61"></a><span id="l11.61" class="difflineminus">-MUI_TEXT_STARTMENU_SUBTITLE=Choose a Start Menu folder for the $(^NameDA) shortcuts.</span>
<a href="#l11.62"></a><span id="l11.62" class="difflineplus">+MUI_TEXT_STARTMENU_SUBTITLE=Choose a Start Menu folder for the $BrandFullNameDA shortcuts.</span>
<a href="#l11.63"></a><span id="l11.63"> MUI_INNERTEXT_STARTMENU_TOP=Select the Start Menu folder in which you would like to create the program's shortcuts. You can also enter a name to create a new folder.</span>
<a href="#l11.64"></a><span id="l11.64" class="difflineminus">-MUI_TEXT_ABORTWARNING=Are you sure you want to quit $(^Name) Setup?</span>
<a href="#l11.65"></a><span id="l11.65" class="difflineminus">-MUI_UNTEXT_WELCOME_INFO_TITLE=Welcome to the $(^NameDA) Uninstall Wizard</span>
<a href="#l11.66"></a><span id="l11.66" class="difflineminus">-MUI_UNTEXT_WELCOME_INFO_TEXT=This wizard will guide you through the uninstallation of $(^NameDA).\n\nBefore starting the uninstallation, make sure $(^NameDA) is not running.\n\n$_CLICK</span>
<a href="#l11.67"></a><span id="l11.67" class="difflineminus">-MUI_UNTEXT_CONFIRM_TITLE=Uninstall $(^NameDA)</span>
<a href="#l11.68"></a><span id="l11.68" class="difflineminus">-MUI_UNTEXT_CONFIRM_SUBTITLE=Remove $(^NameDA) from your computer.</span>
<a href="#l11.69"></a><span id="l11.69" class="difflineplus">+MUI_TEXT_ABORTWARNING=Are you sure you want to quit $BrandFullName Setup?</span>
<a href="#l11.70"></a><span id="l11.70" class="difflineplus">+MUI_UNTEXT_WELCOME_INFO_TITLE=Welcome to the $BrandFullNameDA Uninstall Wizard</span>
<a href="#l11.71"></a><span id="l11.71" class="difflineplus">+MUI_UNTEXT_WELCOME_INFO_TEXT=This wizard will guide you through the uninstallation of $BrandFullNameDA.\n\nBefore starting the uninstallation, make sure $BrandFullNameDA is not running.\n\n$_CLICK</span>
<a href="#l11.72"></a><span id="l11.72" class="difflineplus">+MUI_UNTEXT_CONFIRM_TITLE=Uninstall $BrandFullNameDA</span>
<a href="#l11.73"></a><span id="l11.73" class="difflineplus">+MUI_UNTEXT_CONFIRM_SUBTITLE=Remove $BrandFullNameDA from your computer.</span>
<a href="#l11.74"></a><span id="l11.74"> MUI_UNTEXT_UNINSTALLING_TITLE=Uninstalling</span>
<a href="#l11.75"></a><span id="l11.75" class="difflineminus">-MUI_UNTEXT_UNINSTALLING_SUBTITLE=Please wait while $(^NameDA) is being uninstalled.</span>
<a href="#l11.76"></a><span id="l11.76" class="difflineplus">+MUI_UNTEXT_UNINSTALLING_SUBTITLE=Please wait while $BrandFullNameDA is being uninstalled.</span>
<a href="#l11.77"></a><span id="l11.77"> MUI_UNTEXT_FINISH_TITLE=Uninstallation Complete</span>
<a href="#l11.78"></a><span id="l11.78"> MUI_UNTEXT_FINISH_SUBTITLE=Uninstall was completed successfully.</span>
<a href="#l11.79"></a><span id="l11.79"> MUI_UNTEXT_ABORT_TITLE=Uninstallation Aborted</span>
<a href="#l11.80"></a><span id="l11.80"> MUI_UNTEXT_ABORT_SUBTITLE=Uninstall was not completed successfully.</span>
<a href="#l11.81"></a><span id="l11.81" class="difflineminus">-MUI_UNTEXT_FINISH_INFO_TITLE=Completing the $(^NameDA) Uninstall Wizard</span>
<a href="#l11.82"></a><span id="l11.82" class="difflineminus">-MUI_UNTEXT_FINISH_INFO_TEXT=$(^NameDA) has been uninstalled from your computer.\n\nClick Finish to close this wizard.</span>
<a href="#l11.83"></a><span id="l11.83" class="difflineminus">-MUI_UNTEXT_FINISH_INFO_REBOOT=Your computer must be restarted in order to complete the uninstallation of $(^NameDA). Do you want to reboot now?</span>
<a href="#l11.84"></a><span id="l11.84" class="difflineminus">-MUI_UNTEXT_ABORTWARNING=Are you sure you want to quit $(^Name) Uninstall?</span>
<a href="#l11.85"></a><span id="l11.85" class="difflineplus">+MUI_UNTEXT_FINISH_INFO_TITLE=Completing the $BrandFullNameDA Uninstall Wizard</span>
<a href="#l11.86"></a><span id="l11.86" class="difflineplus">+MUI_UNTEXT_FINISH_INFO_TEXT=$BrandFullNameDA has been uninstalled from your computer.\n\nClick Finish to close this wizard.</span>
<a href="#l11.87"></a><span id="l11.87" class="difflineplus">+MUI_UNTEXT_FINISH_INFO_REBOOT=Your computer must be restarted in order to complete the uninstallation of $BrandFullNameDA. Do you want to reboot now?</span>
<a href="#l11.88"></a><span id="l11.88" class="difflineplus">+MUI_UNTEXT_ABORTWARNING=Are you sure you want to quit $BrandFullName Uninstall?</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/locales/en-US/installer/override.properties</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/locales/en-US/installer/override.properties</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -36,55 +36,55 @@</span>
<a href="#l12.4"></a><span id="l12.4"> </span>
<a href="#l12.5"></a><span id="l12.5"> # LOCALIZATION NOTE:</span>
<a href="#l12.6"></a><span id="l12.6"> </span>
<a href="#l12.7"></a><span id="l12.7"> # This file must be saved as UTF8</span>
<a href="#l12.8"></a><span id="l12.8"> </span>
<a href="#l12.9"></a><span id="l12.9"> # Accesskeys are defined by prefixing the letter that is to be used for the</span>
<a href="#l12.10"></a><span id="l12.10"> # accesskey with an ampersand (e.g. &amp;).</span>
<a href="#l12.11"></a><span id="l12.11"> </span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-# Do not replace $(^NameDA) or $(^Name) with a custom string.</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-# Do not change $(^NameDA) to $(^Name) or $(^Name) to $(^NameDA). NameDA allows</span>
<a href="#l12.15"></a><span id="l12.15" class="difflineminus">-# Name to contain an ampersand (e.g. DA stands for double ampersand) and</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineminus">-# prevents the letter following the ampersand being used as an accesskey.</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineplus">+# Do not replace $BrandShortName, $BrandFullName, or $BrandFullNameDA with a</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+# custom string and always use the same one as used by the en-US files.</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+# $BrandFullNameDA allows the string to contain an ampersand (e.g. DA stands</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineplus">+# for double ampersand) and prevents the letter following the ampersand from</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineplus">+# being used as an accesskey.</span>
<a href="#l12.22"></a><span id="l12.22"> </span>
<a href="#l12.23"></a><span id="l12.23"> # You can use \n to create a newline in the string but only when the string</span>
<a href="#l12.24"></a><span id="l12.24"> # from en-US contains a \n.</span>
<a href="#l12.25"></a><span id="l12.25"> </span>
<a href="#l12.26"></a><span id="l12.26"> # Strings that require a space at the end should be enclosed with double</span>
<a href="#l12.27"></a><span id="l12.27"> # quotes and the double quotes will be removed. To add quotes to the beginning</span>
<a href="#l12.28"></a><span id="l12.28"> # and end of a strong enclose the add and additional double quote to the</span>
<a href="#l12.29"></a><span id="l12.29"> # beginning and end of the string (e.g. &quot;&quot;This will include quotes&quot;&quot;).</span>
<a href="#l12.30"></a><span id="l12.30"> </span>
<a href="#l12.31"></a><span id="l12.31" class="difflineminus">-SetupCaption=$(^Name) Setup</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineminus">-UninstallCaption=$(^Name) Uninstall</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineplus">+SetupCaption=$BrandFullName Setup</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineplus">+UninstallCaption=$BrandFullName Uninstall</span>
<a href="#l12.35"></a><span id="l12.35"> BackBtn=&lt; &amp;Back</span>
<a href="#l12.36"></a><span id="l12.36"> NextBtn=&amp;Next &gt;</span>
<a href="#l12.37"></a><span id="l12.37"> AcceptBtn=I &amp;accept the terms in the License Agreement</span>
<a href="#l12.38"></a><span id="l12.38"> DontAcceptBtn=I &amp;do not accept the terms in the License Agreement</span>
<a href="#l12.39"></a><span id="l12.39"> InstallBtn=&amp;Install</span>
<a href="#l12.40"></a><span id="l12.40"> UninstallBtn=&amp;Uninstall</span>
<a href="#l12.41"></a><span id="l12.41"> CancelBtn=Cancel</span>
<a href="#l12.42"></a><span id="l12.42"> CloseBtn=&amp;Close</span>
<a href="#l12.43"></a><span id="l12.43"> BrowseBtn=B&amp;rowse...</span>
<a href="#l12.44"></a><span id="l12.44"> ShowDetailsBtn=Show &amp;details</span>
<a href="#l12.45"></a><span id="l12.45"> ClickNext=Click Next to continue.</span>
<a href="#l12.46"></a><span id="l12.46"> ClickInstall=Click Install to start the installation.</span>
<a href="#l12.47"></a><span id="l12.47"> ClickUninstall=Click Uninstall to start the uninstallation.</span>
<a href="#l12.48"></a><span id="l12.48"> Completed=Completed</span>
<a href="#l12.49"></a><span id="l12.49" class="difflineminus">-LicenseTextRB=Please review the license agreement before installing $(^NameDA). If you accept all terms of the agreement, select the first option below. $_CLICK</span>
<a href="#l12.50"></a><span id="l12.50" class="difflineplus">+LicenseTextRB=Please review the license agreement before installing $BrandFullNameDA. If you accept all terms of the agreement, select the first option below. $_CLICK</span>
<a href="#l12.51"></a><span id="l12.51"> ComponentsText=Check the components you want to install and uncheck the components you don't want to install. $_CLICK</span>
<a href="#l12.52"></a><span id="l12.52"> ComponentsSubText2_NoInstTypes=Select components to install:</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineminus">-DirText=Setup will install $(^NameDA) in the following folder. To install in a different folder, click Browse and select another folder. $_CLICK</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineplus">+DirText=Setup will install $BrandFullNameDA in the following folder. To install in a different folder, click Browse and select another folder. $_CLICK</span>
<a href="#l12.55"></a><span id="l12.55"> DirSubText=Destination Folder</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineminus">-DirBrowseText=Select the folder to install $(^NameDA) in:</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineplus">+DirBrowseText=Select the folder to install $BrandFullNameDA in:</span>
<a href="#l12.58"></a><span id="l12.58"> SpaceAvailable=&quot;Space available: &quot;</span>
<a href="#l12.59"></a><span id="l12.59"> SpaceRequired=&quot;Space required: &quot;</span>
<a href="#l12.60"></a><span id="l12.60" class="difflineminus">-UninstallingText=$(^NameDA) will be uninstalled from the following folder. $_CLICK</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineplus">+UninstallingText=$BrandFullNameDA will be uninstalled from the following folder. $_CLICK</span>
<a href="#l12.62"></a><span id="l12.62"> UninstallingSubText=Uninstalling from:</span>
<a href="#l12.63"></a><span id="l12.63"> FileError=Error opening file for writing: \r\n\r\n$0\r\n\r\nClick Abort to stop the installation,\r\nRetry to try again, or\r\nIgnore to skip this file.</span>
<a href="#l12.64"></a><span id="l12.64"> FileError_NoIgnore=Error opening file for writing: \r\n\r\n$0\r\n\r\nClick Retry to try again, or\r\nCancel to stop the installation.</span>
<a href="#l12.65"></a><span id="l12.65"> CantWrite=&quot;Can't write: &quot;</span>
<a href="#l12.66"></a><span id="l12.66"> CopyFailed=Copy failed</span>
<a href="#l12.67"></a><span id="l12.67"> CopyTo=&quot;Copy to &quot;</span>
<a href="#l12.68"></a><span id="l12.68"> Registering=&quot;Registering: &quot;</span>
<a href="#l12.69"></a><span id="l12.69"> Unregistering=&quot;Unregistering: &quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/sunbird/locales/Makefile.in</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/sunbird/locales/Makefile.in</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -70,24 +70,16 @@ ifeq ($(OS_ARCH),WINNT)</span>
<a href="#l13.4"></a><span id="l13.4"> 	done</span>
<a href="#l13.5"></a><span id="l13.5"> else</span>
<a href="#l13.6"></a><span id="l13.6"> 	$(INSTALL) $^ $(FINAL_TARGET)</span>
<a href="#l13.7"></a><span id="l13.7"> endif</span>
<a href="#l13.8"></a><span id="l13.8"> </span>
<a href="#l13.9"></a><span id="l13.9"> ifdef MOZ_UPDATER</span>
<a href="#l13.10"></a><span id="l13.10"> libs:: $(addprefix $(LOCALE_SRCDIR)/,updater/updater.ini)</span>
<a href="#l13.11"></a><span id="l13.11"> ifeq ($(OS_ARCH),WINNT)</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-	cat $&lt; $(srcdir)/updater_append.ini | \</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+	cat $&lt; $(srcdir)/updater_append.ini $(srcdir)/../../installer/windows/nsis/updater_append.ini | \</span>
<a href="#l13.14"></a><span id="l13.14"> 	  sed -e &quot;s/%AB_CD%/$(AB_CD)/&quot; | \</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineminus">- 	  iconv -f UTF-8 -t $(WIN_INSTALLER_CHARSET) &gt; $(FINAL_TARGET)/updater.ini</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineminus">-else</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineminus">-ifneq (,$(filter mac cocoa,$(MOZ_WIDGET_TOOLKIT)))</span>
<a href="#l13.18"></a><span id="l13.18" class="difflineminus">-	if test ! -d $(FINAL_TARGET)/updater.app/Contents/MacOS; then \</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineminus">-	  mkdir -p $(FINAL_TARGET)/updater.app/Contents/MacOS; \</span>
<a href="#l13.20"></a><span id="l13.20" class="difflineminus">-	fi</span>
<a href="#l13.21"></a><span id="l13.21" class="difflineminus">-	cat $&lt; $(srcdir)/updater_append.ini | \</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineminus">-	  sed -e &quot;s/%AB_CD%/$(AB_CD)/&quot; &gt; $(FINAL_TARGET)/updater.app/Contents/MacOS/updater.ini</span>
<a href="#l13.23"></a><span id="l13.23" class="difflineplus">+	  iconv -f UTF-8 -t $(WIN_INSTALLER_CHARSET) &gt; $(FINAL_TARGET)/updater.ini</span>
<a href="#l13.24"></a><span id="l13.24"> else</span>
<a href="#l13.25"></a><span id="l13.25"> 	cat $&lt; $(srcdir)/updater_append.ini | \</span>
<a href="#l13.26"></a><span id="l13.26"> 	  sed -e &quot;s/%AB_CD%/$(AB_CD)/&quot; &gt; $(FINAL_TARGET)/updater.ini</span>
<a href="#l13.27"></a><span id="l13.27"> endif</span>
<a href="#l13.28"></a><span id="l13.28"> endif</span>
<a href="#l13.29"></a><span id="l13.29" class="difflineminus">-endif</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

