<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 20635:d2345e14a58802e703ee9338e9890a494119bf5b</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ d2345e14a58802e703ee9338e9890a494119bf5b" />
<meta property="og:url" content="/comm-central/rev/d2345e14a58802e703ee9338e9890a494119bf5b" />
<meta property="og:description" content="Bug 274452 - When accounts are removed, offer to delete files in the Local Directory path. ui-r=paenglab, r=mkmelin,IanN a=IanN" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / d2345e14a58802e703ee9338e9890a494119bf5b 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/d2345e14a58802e703ee9338e9890a494119bf5b">shortlog</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/d2345e14a58802e703ee9338e9890a494119bf5b">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b">files</a> |
changeset |
<a href="/comm-central/raw-rev/d2345e14a58802e703ee9338e9890a494119bf5b">raw</a>  | <a href="/comm-central/archive/d2345e14a58802e703ee9338e9890a494119bf5b.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=274452">Bug 274452</a> - When accounts are removed, offer to delete files in the Local Directory path. ui-r=paenglab, r=mkmelin,IanN a=IanN
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#97;&#99;&#101;&#109;&#97;&#110;&#32;&#60;&#97;&#99;&#101;&#108;&#105;&#115;&#116;&#115;&#64;&#97;&#116;&#108;&#97;&#115;&#46;&#115;&#107;&#62;</td></tr>
<tr><td></td><td class="date age">Sat, 22 Oct 2016 15:51:00 +0200</td></tr>

<tr>
 <td>changeset 20635</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/d2345e14a58802e703ee9338e9890a494119bf5b">d2345e14a58802e703ee9338e9890a494119bf5b</a></td>
</tr>



<tr>
<td>parent 20634</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/d1955b8fbe8644eff457c8cfec3666e759e2beee">d1955b8fbe8644eff457c8cfec3666e759e2beee</a>
</td>
</tr>

<tr>
<td>child 20636</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/dd56104d2a03835869611acc5837e5f74cfeb5fd">dd56104d2a03835869611acc5837e5f74cfeb5fd</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=d2345e14a58802e703ee9338e9890a494119bf5b">12472</a></td></tr>
<tr><td>push user</td><td>mozilla@jorgk.com</td></tr>
<tr><td>push date</td><td class="date age">Thu, 03 Nov 2016 11:01:01 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@d2345e14a588 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=d2345e14a58802e703ee9338e9890a494119bf5b">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=d2345e14a58802e703ee9338e9890a494119bf5b&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=d2345e14a58802e703ee9338e9890a494119bf5b&newProject=comm-central&newRevision=191d56de22eb528ca8ff707ba880697b1fddc784&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=d2345e14a58802e703ee9338e9890a494119bf5b&newProject=comm-central&newRevision=191d56de22eb528ca8ff707ba880697b1fddc784&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=d2345e14a58802e703ee9338e9890a494119bf5b&newProject=comm-central&newRevision=191d56de22eb528ca8ff707ba880697b1fddc784&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28paenglab%29&revcount=50">paenglab</a>, <a href="/comm-central/log?rev=reviewer%28mkmelin%29&revcount=50">mkmelin</a>, <a href="/comm-central/log?rev=reviewer%28IanN%29&revcount=50">IanN</a>, <a href="/comm-central/log?rev=reviewer%28IanN%29&revcount=50">IanN</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=274452">274452</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=274452">Bug 274452</a> - When accounts are removed, offer to delete files in the Local Directory path. ui-r=paenglab, r=mkmelin,IanN a=IanN</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/prefs.properties">mail/locales/en-US/chrome/messenger/prefs.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/prefs.properties">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/prefs.properties">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/prefs.properties">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/prefs.properties">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/prefs.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/removeAccount.dtd">mail/locales/en-US/chrome/messenger/removeAccount.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/removeAccount.dtd">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/removeAccount.dtd">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/removeAccount.dtd">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/removeAccount.dtd">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/removeAccount.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/removeAccount.properties">mail/locales/en-US/chrome/messenger/removeAccount.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/removeAccount.properties">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/removeAccount.properties">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/removeAccount.properties">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/removeAccount.properties">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/en-US/chrome/messenger/removeAccount.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/jar.mn">mail/locales/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/jar.mn">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/jar.mn">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/jar.mn">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/jar.mn">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mail/locales/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-account-deletion.js">mail/test/mozmill/account/test-account-deletion.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-account-deletion.js">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-account-deletion.js">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-account-deletion.js">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-account-deletion.js">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-account-deletion.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-account-tree.js">mail/test/mozmill/account/test-account-tree.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-account-tree.js">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-account-tree.js">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-account-tree.js">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-account-tree.js">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-account-tree.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-mail-account-setup-wizard.js">mail/test/mozmill/account/test-mail-account-setup-wizard.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-mail-account-setup-wizard.js">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-mail-account-setup-wizard.js">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-mail-account-setup-wizard.js">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-mail-account-setup-wizard.js">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/account/test-mail-account-setup-wizard.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/shared-modules/test-account-manager-helpers.js">mail/test/mozmill/shared-modules/test-account-manager-helpers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/shared-modules/test-account-manager-helpers.js">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/shared-modules/test-account-manager-helpers.js">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/shared-modules/test-account-manager-helpers.js">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/shared-modules/test-account-manager-helpers.js">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mail/test/mozmill/shared-modules/test-account-manager-helpers.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/AccountManager.js">mailnews/base/prefs/content/AccountManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/AccountManager.js">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/AccountManager.js">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/AccountManager.js">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/AccountManager.js">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/AccountManager.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/removeAccount.js">mailnews/base/prefs/content/removeAccount.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/removeAccount.js">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/removeAccount.js">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/removeAccount.js">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/removeAccount.js">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/removeAccount.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/removeAccount.xul">mailnews/base/prefs/content/removeAccount.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/removeAccount.xul">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/removeAccount.xul">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/removeAccount.xul">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/removeAccount.xul">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/prefs/content/removeAccount.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/public/nsIMsgAccountManager.idl">mailnews/base/public/nsIMsgAccountManager.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/public/nsIMsgAccountManager.idl">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/public/nsIMsgAccountManager.idl">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/public/nsIMsgAccountManager.idl">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/public/nsIMsgAccountManager.idl">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/public/nsIMsgAccountManager.idl">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/public/nsIMsgIncomingServer.idl">mailnews/base/public/nsIMsgIncomingServer.idl</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/public/nsIMsgIncomingServer.idl">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/public/nsIMsgIncomingServer.idl">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/public/nsIMsgIncomingServer.idl">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/public/nsIMsgIncomingServer.idl">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/public/nsIMsgIncomingServer.idl">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/src/nsMsgAccountManager.cpp">mailnews/base/src/nsMsgAccountManager.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/src/nsMsgAccountManager.cpp">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/src/nsMsgAccountManager.cpp">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/src/nsMsgAccountManager.cpp">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/src/nsMsgAccountManager.cpp">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/src/nsMsgAccountManager.cpp">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/util/nsMsgIncomingServer.cpp">mailnews/base/util/nsMsgIncomingServer.cpp</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/util/nsMsgIncomingServer.cpp">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/util/nsMsgIncomingServer.cpp">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/util/nsMsgIncomingServer.cpp">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/util/nsMsgIncomingServer.cpp">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/base/util/nsMsgIncomingServer.cpp">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/jar.mn">mailnews/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/jar.mn">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/jar.mn">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/jar.mn">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/jar.mn">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/test/resources/messageInjection.js">mailnews/test/resources/messageInjection.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/test/resources/messageInjection.js">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/test/resources/messageInjection.js">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/test/resources/messageInjection.js">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/test/resources/messageInjection.js">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/mailnews/test/resources/messageInjection.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/prefs.properties">suite/locales/en-US/chrome/mailnews/pref/prefs.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/prefs.properties">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/prefs.properties">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/prefs.properties">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/prefs.properties">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/prefs.properties">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/removeAccount.dtd">suite/locales/en-US/chrome/mailnews/pref/removeAccount.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/removeAccount.dtd">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/removeAccount.dtd">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/removeAccount.dtd">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/removeAccount.dtd">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/removeAccount.dtd">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/removeAccount.properties">suite/locales/en-US/chrome/mailnews/pref/removeAccount.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/removeAccount.properties">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/removeAccount.properties">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/removeAccount.properties">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/removeAccount.properties">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/en-US/chrome/mailnews/pref/removeAccount.properties">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/jar.mn">suite/locales/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/jar.mn">file</a> |
<a href="/comm-central/annotate/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/jar.mn">annotate</a> |
<a href="/comm-central/diff/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/jar.mn">diff</a> |
<a href="/comm-central/comparison/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/jar.mn">comparison</a> |
<a href="/comm-central/log/d2345e14a58802e703ee9338e9890a494119bf5b/suite/locales/jar.mn">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/mail/locales/en-US/chrome/messenger/prefs.properties</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/prefs.properties</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -25,19 +25,16 @@ localDirectoryNotAllowed=The Local Direc</span>
<a href="#l1.4"></a><span id="l1.4"> # do not localize &quot;\n\n&quot;</span>
<a href="#l1.5"></a><span id="l1.5"> cancelWizard=Are you sure you want to exit the Account Wizard?\n\nIf you exit, any information you have entered will be lost and the account will not be created.</span>
<a href="#l1.6"></a><span id="l1.6"> accountWizard=Account Wizard</span>
<a href="#l1.7"></a><span id="l1.7"> WizardExit=Exit</span>
<a href="#l1.8"></a><span id="l1.8"> WizardContinue=Cancel</span>
<a href="#l1.9"></a><span id="l1.9"> # when the wizard already has a domain (Should we say something different?)</span>
<a href="#l1.10"></a><span id="l1.10"> enterValidServerName=Please enter a valid server name.</span>
<a href="#l1.11"></a><span id="l1.11"> failedRemoveAccount=Failed to remove this account.</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineminus">-#LOCALIZATION NOTE: confirmRemoveAccount: %S is the account pretty name</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineminus">-confirmRemoveAccount=Are you sure you want to remove the account &quot;%S&quot;?</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineminus">-confirmRemoveAccountTitle=Remove Account</span>
<a href="#l1.15"></a><span id="l1.15"> #LOCALIZATION NOTE: accountName: %1$S is server name, %2$S is user name</span>
<a href="#l1.16"></a><span id="l1.16"> accountName=%1$S - %2$S</span>
<a href="#l1.17"></a><span id="l1.17"> </span>
<a href="#l1.18"></a><span id="l1.18"> # LOCALIZATION NOTE: confirmDeferAccountWarning: do not localize &quot;\n\n&quot;, it means a new empty line in the string.</span>
<a href="#l1.19"></a><span id="l1.19"> confirmDeferAccountWarning=If you store this account's new mail in a different account's Inbox, you will no longer be able to access already downloaded e-mail for this account. If you have mail in this account, please copy it to another account first.\n\nIf you have filters that filter mail into this account, you should disable them or change the destination folder. If any accounts have special folders in this account (Sent, Drafts, Templates, Archives, Junk), you should change them to be in another account.\n\nDo you still want to store this account's e-mail in a different account?</span>
<a href="#l1.20"></a><span id="l1.20"> confirmDeferAccountTitle=Defer Account?</span>
<a href="#l1.21"></a><span id="l1.21"> </span>
<a href="#l1.22"></a><span id="l1.22"> directoryAlreadyUsedByOtherAccount=The directory specified in the Local Directory setting is already used by the &quot;%S&quot; account. Please pick a different directory.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1">new file mode 100644</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineminus">--- /dev/null</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/removeAccount.dtd</span>
<a href="#l2.4"></a><span id="l2.4" class="difflineat">@@ -0,0 +1,19 @@</span>
<a href="#l2.5"></a><span id="l2.5" class="difflineplus">+&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l2.6"></a><span id="l2.6" class="difflineplus">+   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l2.7"></a><span id="l2.7" class="difflineplus">+   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l2.8"></a><span id="l2.8" class="difflineplus">+</span>
<a href="#l2.9"></a><span id="l2.9" class="difflineplus">+&lt;!ENTITY dialogTitle                  &quot;Remove Account and Data&quot;&gt;</span>
<a href="#l2.10"></a><span id="l2.10" class="difflineplus">+&lt;!ENTITY removeButton.label           &quot;Remove&quot;&gt;</span>
<a href="#l2.11"></a><span id="l2.11" class="difflineplus">+&lt;!ENTITY removeButton.accesskey       &quot;R&quot;&gt;</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+&lt;!ENTITY removeAccount.label          &quot;Remove account information&quot;&gt;</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+&lt;!ENTITY removeAccount.accesskey      &quot;a&quot;&gt;</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+&lt;!ENTITY removeAccount.desc           &quot;Removes only &amp;brandShortName;'s knowledge of this account. Does not affect the account itself on the server.&quot;&gt;</span>
<a href="#l2.15"></a><span id="l2.15" class="difflineplus">+&lt;!ENTITY removeData.label             &quot;Remove message data&quot;&gt;</span>
<a href="#l2.16"></a><span id="l2.16" class="difflineplus">+&lt;!ENTITY removeData.accesskey         &quot;d&quot;&gt;</span>
<a href="#l2.17"></a><span id="l2.17" class="difflineplus">+&lt;!ENTITY removeDataLocalAccount.desc  &quot;Removes all messages, folders and filters associated with this account from your local disk. This does not affect some messages which may still be kept on the server. Do not choose this if you plan to archive the local data or re-use it in &amp;brandShortName; later.&quot;&gt;</span>
<a href="#l2.18"></a><span id="l2.18" class="difflineplus">+&lt;!ENTITY removeDataServerAccount.desc &quot;Removes all messages, folders and filters associated with this account from your local disk. Your messages and folders are still kept on the server.&quot;&gt;</span>
<a href="#l2.19"></a><span id="l2.19" class="difflineplus">+&lt;!ENTITY showData.label               &quot;Show data location&quot;&gt;</span>
<a href="#l2.20"></a><span id="l2.20" class="difflineplus">+&lt;!ENTITY showData.accesskey           &quot;S&quot;&gt;</span>
<a href="#l2.21"></a><span id="l2.21" class="difflineplus">+&lt;!ENTITY progressPending              &quot;Removing selected data…&quot;&gt;</span>
<a href="#l2.22"></a><span id="l2.22" class="difflineplus">+&lt;!ENTITY progressSuccess              &quot;Removal succeeded.&quot;&gt;</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineplus">+&lt;!ENTITY progressFailure              &quot;Removal failed.&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1">new file mode 100644</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineminus">--- /dev/null</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineplus">+++ b/mail/locales/en-US/chrome/messenger/removeAccount.properties</span>
<a href="#l3.4"></a><span id="l3.4" class="difflineat">@@ -0,0 +1,5 @@</span>
<a href="#l3.5"></a><span id="l3.5" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l3.6"></a><span id="l3.6" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l3.7"></a><span id="l3.7" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l3.8"></a><span id="l3.8" class="difflineplus">+</span>
<a href="#l3.9"></a><span id="l3.9" class="difflineplus">+removeQuestion=Are you sure you want to remove the account &quot;%S&quot;?</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/mail/locales/jar.mn</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/mail/locales/jar.mn</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -47,16 +47,18 @@</span>
<a href="#l4.4"></a><span id="l4.4">   locale/@AB_CD@/messenger/am-identity-edit.dtd                         (%chrome/messenger/am-identity-edit.dtd)</span>
<a href="#l4.5"></a><span id="l4.5">   locale/@AB_CD@/messenger/am-im.dtd                                    (%chrome/messenger/am-im.dtd)</span>
<a href="#l4.6"></a><span id="l4.6">   locale/@AB_CD@/messenger/am-serverwithnoidentities.dtd                (%chrome/messenger/am-serverwithnoidentities.dtd)</span>
<a href="#l4.7"></a><span id="l4.7">   locale/@AB_CD@/messenger/am-junk.dtd                                  (%chrome/messenger/am-junk.dtd)</span>
<a href="#l4.8"></a><span id="l4.8">   locale/@AB_CD@/messenger/prefs.properties                             (%chrome/messenger/prefs.properties)</span>
<a href="#l4.9"></a><span id="l4.9">   locale/@AB_CD@/messenger/smtpEditOverlay.dtd                          (%chrome/messenger/smtpEditOverlay.dtd)</span>
<a href="#l4.10"></a><span id="l4.10">   locale/@AB_CD@/messenger/am-smime.dtd                                 (%chrome/messenger/am-smime.dtd)</span>
<a href="#l4.11"></a><span id="l4.11">   locale/@AB_CD@/messenger/am-smime.properties                          (%chrome/messenger/am-smime.properties)</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineplus">+  locale/@AB_CD@/messenger/removeAccount.dtd                            (%chrome/messenger/removeAccount.dtd)</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+  locale/@AB_CD@/messenger/removeAccount.properties                     (%chrome/messenger/removeAccount.properties)</span>
<a href="#l4.14"></a><span id="l4.14">   locale/@AB_CD@/messenger/messenger.properties                         (%chrome/messenger/messenger.properties)</span>
<a href="#l4.15"></a><span id="l4.15">   locale/@AB_CD@/messenger/newFolderDialog.dtd                          (%chrome/messenger/newFolderDialog.dtd)</span>
<a href="#l4.16"></a><span id="l4.16">   locale/@AB_CD@/messenger/newTagDialog.dtd                             (%chrome/messenger/newTagDialog.dtd)</span>
<a href="#l4.17"></a><span id="l4.17">   locale/@AB_CD@/messenger/renameFolderDialog.dtd                       (%chrome/messenger/renameFolderDialog.dtd)</span>
<a href="#l4.18"></a><span id="l4.18">   locale/@AB_CD@/messenger/folderpane.dtd                               (%chrome/messenger/folderpane.dtd)</span>
<a href="#l4.19"></a><span id="l4.19">   locale/@AB_CD@/messenger/folderProps.dtd                              (%chrome/messenger/folderProps.dtd)</span>
<a href="#l4.20"></a><span id="l4.20">   locale/@AB_CD@/messenger/folderWidgets.properties                     (%chrome/messenger/folderWidgets.properties)</span>
<a href="#l4.21"></a><span id="l4.21">   locale/@AB_CD@/messenger/subscribe.dtd                                (%chrome/messenger/subscribe.dtd)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1">new file mode 100644</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineminus">--- /dev/null</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineplus">+++ b/mail/test/mozmill/account/test-account-deletion.js</span>
<a href="#l5.4"></a><span id="l5.4" class="difflineat">@@ -0,0 +1,105 @@</span>
<a href="#l5.5"></a><span id="l5.5" class="difflineplus">+/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l5.6"></a><span id="l5.6" class="difflineplus">+ * License, v. 2.0. If a copy of the MPL was not distributed with this file,</span>
<a href="#l5.7"></a><span id="l5.7" class="difflineplus">+ * You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l5.8"></a><span id="l5.8" class="difflineplus">+</span>
<a href="#l5.9"></a><span id="l5.9" class="difflineplus">+/**</span>
<a href="#l5.10"></a><span id="l5.10" class="difflineplus">+ * This test checks proper deletion of an account from the Account manager.</span>
<a href="#l5.11"></a><span id="l5.11" class="difflineplus">+ */</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineplus">+</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+var MODULE_NAME = &quot;test-account-deletion&quot;;</span>
<a href="#l5.14"></a><span id="l5.14" class="difflineplus">+</span>
<a href="#l5.15"></a><span id="l5.15" class="difflineplus">+var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l5.16"></a><span id="l5.16" class="difflineplus">+var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;window-helpers&quot;,</span>
<a href="#l5.17"></a><span id="l5.17" class="difflineplus">+                       &quot;account-manager-helpers&quot;];</span>
<a href="#l5.18"></a><span id="l5.18" class="difflineplus">+</span>
<a href="#l5.19"></a><span id="l5.19" class="difflineplus">+var gPopAccount, gImapAccount, gNntpAccount, gOriginalAccountCount;</span>
<a href="#l5.20"></a><span id="l5.20" class="difflineplus">+</span>
<a href="#l5.21"></a><span id="l5.21" class="difflineplus">+function setupModule(module) {</span>
<a href="#l5.22"></a><span id="l5.22" class="difflineplus">+  for (let lib of MODULE_REQUIRES) {</span>
<a href="#l5.23"></a><span id="l5.23" class="difflineplus">+    collector.getModule(lib).installInto(module);</span>
<a href="#l5.24"></a><span id="l5.24" class="difflineplus">+  }</span>
<a href="#l5.25"></a><span id="l5.25" class="difflineplus">+</span>
<a href="#l5.26"></a><span id="l5.26" class="difflineplus">+  // There may be pre-existing accounts from other tests.</span>
<a href="#l5.27"></a><span id="l5.27" class="difflineplus">+  gOriginalAccountCount = MailServices.accounts.allServers.length;</span>
<a href="#l5.28"></a><span id="l5.28" class="difflineplus">+</span>
<a href="#l5.29"></a><span id="l5.29" class="difflineplus">+  // Create a POP server</span>
<a href="#l5.30"></a><span id="l5.30" class="difflineplus">+  let popServer = MailServices.accounts</span>
<a href="#l5.31"></a><span id="l5.31" class="difflineplus">+    .createIncomingServer(&quot;nobody&quot;, &quot;pop.foo.invalid&quot;, &quot;pop3&quot;)</span>
<a href="#l5.32"></a><span id="l5.32" class="difflineplus">+    .QueryInterface(Ci.nsIPop3IncomingServer);</span>
<a href="#l5.33"></a><span id="l5.33" class="difflineplus">+</span>
<a href="#l5.34"></a><span id="l5.34" class="difflineplus">+  let identity = MailServices.accounts.createIdentity();</span>
<a href="#l5.35"></a><span id="l5.35" class="difflineplus">+  identity.email = &quot;tinderbox@pop.foo.invalid&quot;;</span>
<a href="#l5.36"></a><span id="l5.36" class="difflineplus">+</span>
<a href="#l5.37"></a><span id="l5.37" class="difflineplus">+  gPopAccount = MailServices.accounts.createAccount();</span>
<a href="#l5.38"></a><span id="l5.38" class="difflineplus">+  gPopAccount.incomingServer = popServer;</span>
<a href="#l5.39"></a><span id="l5.39" class="difflineplus">+  gPopAccount.addIdentity(identity);</span>
<a href="#l5.40"></a><span id="l5.40" class="difflineplus">+</span>
<a href="#l5.41"></a><span id="l5.41" class="difflineplus">+  // Create an IMAP server</span>
<a href="#l5.42"></a><span id="l5.42" class="difflineplus">+  let imapServer = MailServices.accounts</span>
<a href="#l5.43"></a><span id="l5.43" class="difflineplus">+    .createIncomingServer(&quot;nobody&quot;, &quot;imap.foo.invalid&quot;, &quot;imap&quot;)</span>
<a href="#l5.44"></a><span id="l5.44" class="difflineplus">+    .QueryInterface(Ci.nsIImapIncomingServer);</span>
<a href="#l5.45"></a><span id="l5.45" class="difflineplus">+</span>
<a href="#l5.46"></a><span id="l5.46" class="difflineplus">+  identity = MailServices.accounts.createIdentity();</span>
<a href="#l5.47"></a><span id="l5.47" class="difflineplus">+  identity.email = &quot;tinderbox@imap.foo.invalid&quot;;</span>
<a href="#l5.48"></a><span id="l5.48" class="difflineplus">+</span>
<a href="#l5.49"></a><span id="l5.49" class="difflineplus">+  gImapAccount = MailServices.accounts.createAccount();</span>
<a href="#l5.50"></a><span id="l5.50" class="difflineplus">+  gImapAccount.incomingServer = imapServer;</span>
<a href="#l5.51"></a><span id="l5.51" class="difflineplus">+  gImapAccount.addIdentity(identity);</span>
<a href="#l5.52"></a><span id="l5.52" class="difflineplus">+</span>
<a href="#l5.53"></a><span id="l5.53" class="difflineplus">+  assert_equals(MailServices.accounts.allServers.length, gOriginalAccountCount + 2);</span>
<a href="#l5.54"></a><span id="l5.54" class="difflineplus">+}</span>
<a href="#l5.55"></a><span id="l5.55" class="difflineplus">+</span>
<a href="#l5.56"></a><span id="l5.56" class="difflineplus">+function teardownModule(module) {</span>
<a href="#l5.57"></a><span id="l5.57" class="difflineplus">+  // There should be only the original accounts left.</span>
<a href="#l5.58"></a><span id="l5.58" class="difflineplus">+  assert_equals(MailServices.accounts.allServers.length, gOriginalAccountCount);</span>
<a href="#l5.59"></a><span id="l5.59" class="difflineplus">+}</span>
<a href="#l5.60"></a><span id="l5.60" class="difflineplus">+</span>
<a href="#l5.61"></a><span id="l5.61" class="difflineplus">+function test_account_data_deletion() {</span>
<a href="#l5.62"></a><span id="l5.62" class="difflineplus">+  open_advanced_settings(function(amc) {</span>
<a href="#l5.63"></a><span id="l5.63" class="difflineplus">+    subtest_account_data_deletion1(amc);</span>
<a href="#l5.64"></a><span id="l5.64" class="difflineplus">+  });</span>
<a href="#l5.65"></a><span id="l5.65" class="difflineplus">+</span>
<a href="#l5.66"></a><span id="l5.66" class="difflineplus">+  open_advanced_settings(function(amc) {</span>
<a href="#l5.67"></a><span id="l5.67" class="difflineplus">+    subtest_account_data_deletion2(amc);</span>
<a href="#l5.68"></a><span id="l5.68" class="difflineplus">+  });</span>
<a href="#l5.69"></a><span id="l5.69" class="difflineplus">+}</span>
<a href="#l5.70"></a><span id="l5.70" class="difflineplus">+</span>
<a href="#l5.71"></a><span id="l5.71" class="difflineplus">+/**</span>
<a href="#l5.72"></a><span id="l5.72" class="difflineplus">+ * Bug 274452</span>
<a href="#l5.73"></a><span id="l5.73" class="difflineplus">+ * Check if files of an account are preserved.</span>
<a href="#l5.74"></a><span id="l5.74" class="difflineplus">+ *</span>
<a href="#l5.75"></a><span id="l5.75" class="difflineplus">+ * @param amc  The account options controller.</span>
<a href="#l5.76"></a><span id="l5.76" class="difflineplus">+ */</span>
<a href="#l5.77"></a><span id="l5.77" class="difflineplus">+function subtest_account_data_deletion1(amc)</span>
<a href="#l5.78"></a><span id="l5.78" class="difflineplus">+{</span>
<a href="#l5.79"></a><span id="l5.79" class="difflineplus">+  let accountDir = gPopAccount.incomingServer.localPath;</span>
<a href="#l5.80"></a><span id="l5.80" class="difflineplus">+  assert_true(accountDir.isDirectory());</span>
<a href="#l5.81"></a><span id="l5.81" class="difflineplus">+</span>
<a href="#l5.82"></a><span id="l5.82" class="difflineplus">+  // Get some existing file in the POP3 account data dir.</span>
<a href="#l5.83"></a><span id="l5.83" class="difflineplus">+  let inboxFile = accountDir.clone();</span>
<a href="#l5.84"></a><span id="l5.84" class="difflineplus">+  inboxFile.append(&quot;Inbox.msf&quot;);</span>
<a href="#l5.85"></a><span id="l5.85" class="difflineplus">+  assert_true(inboxFile.isFile());</span>
<a href="#l5.86"></a><span id="l5.86" class="difflineplus">+</span>
<a href="#l5.87"></a><span id="l5.87" class="difflineplus">+  remove_account(gPopAccount, amc, true, false);</span>
<a href="#l5.88"></a><span id="l5.88" class="difflineplus">+  assert_true(accountDir.exists());</span>
<a href="#l5.89"></a><span id="l5.89" class="difflineplus">+}</span>
<a href="#l5.90"></a><span id="l5.90" class="difflineplus">+</span>
<a href="#l5.91"></a><span id="l5.91" class="difflineplus">+/**</span>
<a href="#l5.92"></a><span id="l5.92" class="difflineplus">+ * Bug 274452</span>
<a href="#l5.93"></a><span id="l5.93" class="difflineplus">+ * Check if files of an account can be deleted.</span>
<a href="#l5.94"></a><span id="l5.94" class="difflineplus">+ *</span>
<a href="#l5.95"></a><span id="l5.95" class="difflineplus">+ * @param amc  The account options controller.</span>
<a href="#l5.96"></a><span id="l5.96" class="difflineplus">+ */</span>
<a href="#l5.97"></a><span id="l5.97" class="difflineplus">+function subtest_account_data_deletion2(amc)</span>
<a href="#l5.98"></a><span id="l5.98" class="difflineplus">+{</span>
<a href="#l5.99"></a><span id="l5.99" class="difflineplus">+  let accountDir = gImapAccount.incomingServer.localPath;</span>
<a href="#l5.100"></a><span id="l5.100" class="difflineplus">+  assert_true(accountDir.isDirectory());</span>
<a href="#l5.101"></a><span id="l5.101" class="difflineplus">+</span>
<a href="#l5.102"></a><span id="l5.102" class="difflineplus">+  // Get some file in the IMAP account data dir.</span>
<a href="#l5.103"></a><span id="l5.103" class="difflineplus">+  let inboxFile = accountDir.clone();</span>
<a href="#l5.104"></a><span id="l5.104" class="difflineplus">+  inboxFile.append(&quot;INBOX.msf&quot;);</span>
<a href="#l5.105"></a><span id="l5.105" class="difflineplus">+  assert_true(inboxFile.isFile());</span>
<a href="#l5.106"></a><span id="l5.106" class="difflineplus">+</span>
<a href="#l5.107"></a><span id="l5.107" class="difflineplus">+  remove_account(gImapAccount, amc, true, true);</span>
<a href="#l5.108"></a><span id="l5.108" class="difflineplus">+  assert_false(accountDir.exists());</span>
<a href="#l5.109"></a><span id="l5.109" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/mail/test/mozmill/account/test-account-tree.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/mail/test/mozmill/account/test-account-tree.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -146,42 +146,32 @@ function test_selection_after_account_de</span>
<a href="#l6.4"></a><span id="l6.4"> </span>
<a href="#l6.5"></a><span id="l6.5"> /**</span>
<a href="#l6.6"></a><span id="l6.6">  * Check if after deleting an account the next one is selected.</span>
<a href="#l6.7"></a><span id="l6.7">  *</span>
<a href="#l6.8"></a><span id="l6.8">  * @param amc           The account options controller.</span>
<a href="#l6.9"></a><span id="l6.9">  */</span>
<a href="#l6.10"></a><span id="l6.10"> function subtest_check_selection_after_account_deletion(amc)</span>
<a href="#l6.11"></a><span id="l6.11"> {</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-  // Select the default account.</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-  let accountRow = get_account_tree_row(gPopAccount.key, &quot;am-server.xul&quot;, amc);</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineminus">-  click_account_tree_row(amc, accountRow);</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineminus">-</span>
<a href="#l6.16"></a><span id="l6.16">   let accountList = [];</span>
<a href="#l6.17"></a><span id="l6.17">   let accountTreeNode = amc.e(&quot;account-tree-children&quot;);</span>
<a href="#l6.18"></a><span id="l6.18">   // Build the list of accounts in the account tree (order is important).</span>
<a href="#l6.19"></a><span id="l6.19">   for (let i = 0; i &lt; accountTreeNode.childNodes.length; i++) {</span>
<a href="#l6.20"></a><span id="l6.20">     if (&quot;_account&quot; in accountTreeNode.childNodes[i]) {</span>
<a href="#l6.21"></a><span id="l6.21">       let curAccount = accountTreeNode.childNodes[i]._account;</span>
<a href="#l6.22"></a><span id="l6.22">       if (!accountList.includes(curAccount))</span>
<a href="#l6.23"></a><span id="l6.23">         accountList.push(curAccount);</span>
<a href="#l6.24"></a><span id="l6.24">     }</span>
<a href="#l6.25"></a><span id="l6.25">   }</span>
<a href="#l6.26"></a><span id="l6.26"> </span>
<a href="#l6.27"></a><span id="l6.27">   // Get position of the current account in the account list.</span>
<a href="#l6.28"></a><span id="l6.28">   let accountIndex = accountList.indexOf(gPopAccount);</span>
<a href="#l6.29"></a><span id="l6.29"> </span>
<a href="#l6.30"></a><span id="l6.30" class="difflineminus">-  plan_for_modal_dialog(&quot;commonDialog&quot;, function(cdc) {</span>
<a href="#l6.31"></a><span id="l6.31" class="difflineminus">-    // Account removal confirmation dialog. Just accept it.</span>
<a href="#l6.32"></a><span id="l6.32" class="difflineminus">-    cdc.window.document.documentElement.acceptDialog();</span>
<a href="#l6.33"></a><span id="l6.33" class="difflineminus">-  });</span>
<a href="#l6.34"></a><span id="l6.34" class="difflineminus">-  // Use the Remove item in the Account actions menu.</span>
<a href="#l6.35"></a><span id="l6.35" class="difflineminus">-  amc.click_menus_in_sequence(amc.e(&quot;accountActionsDropdown&quot;),</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineminus">-                              [ {id: &quot;accountActionsDropdownRemove&quot;} ]);</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineminus">-  wait_for_modal_dialog(&quot;commonDialog&quot;);</span>
<a href="#l6.38"></a><span id="l6.38" class="difflineplus">+  // Remove our account.</span>
<a href="#l6.39"></a><span id="l6.39" class="difflineplus">+  remove_account(gPopAccount, amc);</span>
<a href="#l6.40"></a><span id="l6.40">   // Now there should be only the original accounts left.</span>
<a href="#l6.41"></a><span id="l6.41">   assert_equals(MailServices.accounts.allServers.length, gOriginalAccountCount);</span>
<a href="#l6.42"></a><span id="l6.42"> </span>
<a href="#l6.43"></a><span id="l6.43">   // See if the currently selected account is the one next in the account list.</span>
<a href="#l6.44"></a><span id="l6.44">   let accountTree = amc.e(&quot;accounttree&quot;);</span>
<a href="#l6.45"></a><span id="l6.45">   accountRow = accountTree.view.selection.currentIndex;</span>
<a href="#l6.46"></a><span id="l6.46">   assert_equals(accountTree.view.getItemAtIndex(accountRow)._account,</span>
<a href="#l6.47"></a><span id="l6.47">                 accountList[accountIndex + 1]);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/mail/test/mozmill/account/test-mail-account-setup-wizard.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/mail/test/mozmill/account/test-mail-account-setup-wizard.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -38,18 +38,18 @@ function setupModule(module) {</span>
<a href="#l7.4"></a><span id="l7.4"> </span>
<a href="#l7.5"></a><span id="l7.5"> // Select File &gt; New &gt; Mail Account to open the Mail Account Setup Wizard</span>
<a href="#l7.6"></a><span id="l7.6"> function open_mail_account_setup_wizard(k) {</span>
<a href="#l7.7"></a><span id="l7.7">   plan_for_modal_dialog(&quot;mail:autoconfig&quot;, k);</span>
<a href="#l7.8"></a><span id="l7.8">   mc.click(new elib.Elem(mc.menus.menu_File.menu_New.newMailAccountMenuItem));</span>
<a href="#l7.9"></a><span id="l7.9">   return wait_for_modal_dialog(&quot;mail:autoconfig&quot;);</span>
<a href="#l7.10"></a><span id="l7.10"> }</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-// Remove an account on the Account Manager</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-function remove_account(amc, aAccount, aOutgoing) {</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineplus">+// Remove an account in the Account Manager, but not via the UI.</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+function remove_account_internal(amc, aAccount, aOutgoing) {</span>
<a href="#l7.16"></a><span id="l7.16">   let win = amc.window;</span>
<a href="#l7.17"></a><span id="l7.17"> </span>
<a href="#l7.18"></a><span id="l7.18">   try {</span>
<a href="#l7.19"></a><span id="l7.19">     // Remove the account and incoming server</span>
<a href="#l7.20"></a><span id="l7.20">     let serverId = aAccount.incomingServer.serverURI;</span>
<a href="#l7.21"></a><span id="l7.21">     MailServices.accounts.removeAccount(aAccount);</span>
<a href="#l7.22"></a><span id="l7.22">     if (serverId in win.accountArray)</span>
<a href="#l7.23"></a><span id="l7.23">       delete win.accountArray[serverId];</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineat">@@ -135,17 +135,17 @@ function subtest_verify_account(amc) {</span>
<a href="#l7.25"></a><span id="l7.25">   try {</span>
<a href="#l7.26"></a><span id="l7.26">     for (let i in config) {</span>
<a href="#l7.27"></a><span id="l7.27">       if (config[i].actual != config[i].expected) {</span>
<a href="#l7.28"></a><span id="l7.28">         throw new Error(&quot;Configured &quot; + i + &quot; is &quot; + config[i].actual +</span>
<a href="#l7.29"></a><span id="l7.29">                         &quot;. It should be &quot; + config[i].expected + &quot;.&quot;);</span>
<a href="#l7.30"></a><span id="l7.30">       }</span>
<a href="#l7.31"></a><span id="l7.31">     }</span>
<a href="#l7.32"></a><span id="l7.32">   } finally {</span>
<a href="#l7.33"></a><span id="l7.33" class="difflineminus">-    remove_account(amc, account, outgoing);</span>
<a href="#l7.34"></a><span id="l7.34" class="difflineplus">+    remove_account_internal(amc, account, outgoing);</span>
<a href="#l7.35"></a><span id="l7.35">   }</span>
<a href="#l7.36"></a><span id="l7.36"> }</span>
<a href="#l7.37"></a><span id="l7.37"> </span>
<a href="#l7.38"></a><span id="l7.38"> /**</span>
<a href="#l7.39"></a><span id="l7.39">  * Make sure that we don't re-set the information we get from the config</span>
<a href="#l7.40"></a><span id="l7.40">  * file if the password is incorrect.</span>
<a href="#l7.41"></a><span id="l7.41">  */</span>
<a href="#l7.42"></a><span id="l7.42"> function test_bad_password_uses_old_settings() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/mail/test/mozmill/shared-modules/test-account-manager-helpers.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/mail/test/mozmill/shared-modules/test-account-manager-helpers.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -5,16 +5,18 @@</span>
<a href="#l8.4"></a><span id="l8.4"> var MODULE_NAME = &quot;account-manager-helpers&quot;;</span>
<a href="#l8.5"></a><span id="l8.5"> </span>
<a href="#l8.6"></a><span id="l8.6"> var RELATIVE_ROOT = &quot;../shared-modules&quot;;</span>
<a href="#l8.7"></a><span id="l8.7"> // we need this for the main controller</span>
<a href="#l8.8"></a><span id="l8.8"> var MODULE_REQUIRES = [&quot;folder-display-helpers&quot;, &quot;window-helpers&quot;];</span>
<a href="#l8.9"></a><span id="l8.9"> </span>
<a href="#l8.10"></a><span id="l8.10"> var utils = {};</span>
<a href="#l8.11"></a><span id="l8.11"> Cu.import('resource://mozmill/modules/utils.js', utils);</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+var elib = {};</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+Components.utils.import(&quot;resource://mozmill/modules/elementslib.js&quot;, elib);</span>
<a href="#l8.14"></a><span id="l8.14"> </span>
<a href="#l8.15"></a><span id="l8.15"> var wh, fdh, mc;</span>
<a href="#l8.16"></a><span id="l8.16"> </span>
<a href="#l8.17"></a><span id="l8.17"> function setupModule() {</span>
<a href="#l8.18"></a><span id="l8.18">   fdh = collector.getModule('folder-display-helpers');</span>
<a href="#l8.19"></a><span id="l8.19">   mc = fdh.mc;</span>
<a href="#l8.20"></a><span id="l8.20">   wh = collector.getModule('window-helpers');</span>
<a href="#l8.21"></a><span id="l8.21"> }</span>
<a href="#l8.22"></a><span id="l8.22" class="difflineat">@@ -23,16 +25,17 @@ function installInto(module) {</span>
<a href="#l8.23"></a><span id="l8.23">   setupModule();</span>
<a href="#l8.24"></a><span id="l8.24"> </span>
<a href="#l8.25"></a><span id="l8.25">   // Now copy helper functions</span>
<a href="#l8.26"></a><span id="l8.26">   module.open_advanced_settings = open_advanced_settings;</span>
<a href="#l8.27"></a><span id="l8.27">   module.open_advanced_settings_from_account_wizard =</span>
<a href="#l8.28"></a><span id="l8.28">     open_advanced_settings_from_account_wizard;</span>
<a href="#l8.29"></a><span id="l8.29">   module.click_account_tree_row = click_account_tree_row;</span>
<a href="#l8.30"></a><span id="l8.30">   module.get_account_tree_row = get_account_tree_row;</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineplus">+  module.remove_account = remove_account;</span>
<a href="#l8.32"></a><span id="l8.32"> }</span>
<a href="#l8.33"></a><span id="l8.33"> </span>
<a href="#l8.34"></a><span id="l8.34"> /**</span>
<a href="#l8.35"></a><span id="l8.35">  * Opens the Account Manager.</span>
<a href="#l8.36"></a><span id="l8.36">  *</span>
<a href="#l8.37"></a><span id="l8.37">  * @param callback Callback for the modal dialog that is opened.</span>
<a href="#l8.38"></a><span id="l8.38">  */</span>
<a href="#l8.39"></a><span id="l8.39"> function open_advanced_settings(aCallback, aController) {</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineat">@@ -125,8 +128,41 @@ function get_account_tree_row(aAccountKe</span>
<a href="#l8.41"></a><span id="l8.41">     }</span>
<a href="#l8.42"></a><span id="l8.42">     rowIndex++;</span>
<a href="#l8.43"></a><span id="l8.43">   }</span>
<a href="#l8.44"></a><span id="l8.44"> </span>
<a href="#l8.45"></a><span id="l8.45">   // The account was not found.</span>
<a href="#l8.46"></a><span id="l8.46">   dump(&quot;The treerow for account &quot; + aAccountKey + &quot; was not found!\n&quot;);</span>
<a href="#l8.47"></a><span id="l8.47">   return -1;</span>
<a href="#l8.48"></a><span id="l8.48"> }</span>
<a href="#l8.49"></a><span id="l8.49" class="difflineplus">+</span>
<a href="#l8.50"></a><span id="l8.50" class="difflineplus">+/**</span>
<a href="#l8.51"></a><span id="l8.51" class="difflineplus">+ * Remove an account via the account manager UI.</span>
<a href="#l8.52"></a><span id="l8.52" class="difflineplus">+ *</span>
<a href="#l8.53"></a><span id="l8.53" class="difflineplus">+ * @param aAccount        The account to remove.</span>
<a href="#l8.54"></a><span id="l8.54" class="difflineplus">+ * @param aController     The controller of the account manager window.</span>
<a href="#l8.55"></a><span id="l8.55" class="difflineplus">+ * @param aRemoveAccount  Remove the account itself.</span>
<a href="#l8.56"></a><span id="l8.56" class="difflineplus">+ * @param aRemoveData     Remove the message data of the account.</span>
<a href="#l8.57"></a><span id="l8.57" class="difflineplus">+ */</span>
<a href="#l8.58"></a><span id="l8.58" class="difflineplus">+function remove_account(aAccount, aController, aRemoveAccount = true, aRemoveData = false) {</span>
<a href="#l8.59"></a><span id="l8.59" class="difflineplus">+  let accountRow = get_account_tree_row(aAccount.key, &quot;am-server.xul&quot;, aController);</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineplus">+  click_account_tree_row(aController, accountRow);</span>
<a href="#l8.61"></a><span id="l8.61" class="difflineplus">+</span>
<a href="#l8.62"></a><span id="l8.62" class="difflineplus">+  wh.plan_for_modal_dialog(&quot;removeAccountDialog&quot;, function(cdc) {</span>
<a href="#l8.63"></a><span id="l8.63" class="difflineplus">+    // Account removal confirmation dialog. Select what to remove.</span>
<a href="#l8.64"></a><span id="l8.64" class="difflineplus">+    if (aRemoveAccount)</span>
<a href="#l8.65"></a><span id="l8.65" class="difflineplus">+      cdc.click(new elib.Elem(cdc.window.document.getElementById(&quot;removeAccount&quot;)));</span>
<a href="#l8.66"></a><span id="l8.66" class="difflineplus">+    if (aRemoveData)</span>
<a href="#l8.67"></a><span id="l8.67" class="difflineplus">+      cdc.click(new elib.Elem(cdc.window.document.getElementById(&quot;removeData&quot;)));</span>
<a href="#l8.68"></a><span id="l8.68" class="difflineplus">+</span>
<a href="#l8.69"></a><span id="l8.69" class="difflineplus">+    cdc.window.document.documentElement.acceptDialog();</span>
<a href="#l8.70"></a><span id="l8.70" class="difflineplus">+    cdc.waitFor(() =&gt; !cdc.window.document.documentElement.getButton(&quot;accept&quot;).disabled,</span>
<a href="#l8.71"></a><span id="l8.71" class="difflineplus">+                &quot;Timeout waiting for finish of account removal&quot;,</span>
<a href="#l8.72"></a><span id="l8.72" class="difflineplus">+                5000, 100);</span>
<a href="#l8.73"></a><span id="l8.73" class="difflineplus">+    cdc.window.document.documentElement.acceptDialog();</span>
<a href="#l8.74"></a><span id="l8.74" class="difflineplus">+  });</span>
<a href="#l8.75"></a><span id="l8.75" class="difflineplus">+</span>
<a href="#l8.76"></a><span id="l8.76" class="difflineplus">+  // Use the Remove item in the Account actions menu.</span>
<a href="#l8.77"></a><span id="l8.77" class="difflineplus">+  aController.click_menus_in_sequence(aController.e(&quot;accountActionsDropdown&quot;),</span>
<a href="#l8.78"></a><span id="l8.78" class="difflineplus">+                                      [ {id: &quot;accountActionsDropdownRemove&quot;} ]);</span>
<a href="#l8.79"></a><span id="l8.79" class="difflineplus">+  wh.wait_for_modal_dialog(&quot;removeAccountDialog&quot;);</span>
<a href="#l8.80"></a><span id="l8.80" class="difflineplus">+  // TODO: For unknown reason this also closes the whole account manager.</span>
<a href="#l8.81"></a><span id="l8.81" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/mailnews/base/prefs/content/AccountManager.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/mailnews/base/prefs/content/AccountManager.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -677,16 +677,19 @@ function AddIMAccount()</span>
<a href="#l9.4"></a><span id="l9.4">  * optionally un-highlight the previous one.</span>
<a href="#l9.5"></a><span id="l9.5">  *</span>
<a href="#l9.6"></a><span id="l9.6">  * @param newDefault  The account that has become the new default.</span>
<a href="#l9.7"></a><span id="l9.7">  *                    Can be given as null if there is none.</span>
<a href="#l9.8"></a><span id="l9.8">  * @param oldDefault  The account that has stopped being the default.</span>
<a href="#l9.9"></a><span id="l9.9">  *                    Can be given as null if there was none.</span>
<a href="#l9.10"></a><span id="l9.10">  */</span>
<a href="#l9.11"></a><span id="l9.11"> function markDefaultServer(newDefault, oldDefault) {</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineplus">+  if (oldDefault == newDefault)</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+    return;</span>
<a href="#l9.14"></a><span id="l9.14" class="difflineplus">+</span>
<a href="#l9.15"></a><span id="l9.15">   let accountTreeNodes = document.getElementById(&quot;account-tree-children&quot;)</span>
<a href="#l9.16"></a><span id="l9.16">                                  .childNodes;</span>
<a href="#l9.17"></a><span id="l9.17">   for (let i = 0; i &lt; accountTreeNodes.length; i++) {</span>
<a href="#l9.18"></a><span id="l9.18">     let accountNode = accountTreeNodes[i];</span>
<a href="#l9.19"></a><span id="l9.19">     if (newDefault &amp;&amp; newDefault == accountNode._account) {</span>
<a href="#l9.20"></a><span id="l9.20">       let props = accountNode.firstChild.firstChild.getAttribute(&quot;properties&quot;);</span>
<a href="#l9.21"></a><span id="l9.21">       accountNode.firstChild.firstChild</span>
<a href="#l9.22"></a><span id="l9.22">                             .setAttribute(&quot;properties&quot;, props + &quot; isDefaultServer-true&quot;);</span>
<a href="#l9.23"></a><span id="l9.23" class="difflineat">@@ -715,32 +718,21 @@ function onSetDefault(event) {</span>
<a href="#l9.24"></a><span id="l9.24">   setEnabled(document.getElementById(&quot;setDefaultButton&quot;), false);</span>
<a href="#l9.25"></a><span id="l9.25"> }</span>
<a href="#l9.26"></a><span id="l9.26"> </span>
<a href="#l9.27"></a><span id="l9.27"> function onRemoveAccount(event) {</span>
<a href="#l9.28"></a><span id="l9.28">   if (event.target.getAttribute(&quot;disabled&quot;) == &quot;true&quot; || !currentAccount)</span>
<a href="#l9.29"></a><span id="l9.29">     return;</span>
<a href="#l9.30"></a><span id="l9.30"> </span>
<a href="#l9.31"></a><span id="l9.31">   let server = currentAccount.incomingServer;</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineminus">-  let prettyName = server.prettyName;</span>
<a href="#l9.33"></a><span id="l9.33"> </span>
<a href="#l9.34"></a><span id="l9.34">   let canDelete = server.protocolInfo.canDelete || server.canDelete;</span>
<a href="#l9.35"></a><span id="l9.35" class="difflineminus">-</span>
<a href="#l9.36"></a><span id="l9.36">   if (!canDelete)</span>
<a href="#l9.37"></a><span id="l9.37">     return;</span>
<a href="#l9.38"></a><span id="l9.38"> </span>
<a href="#l9.39"></a><span id="l9.39" class="difflineminus">-  let bundle = document.getElementById(&quot;bundle_prefs&quot;);</span>
<a href="#l9.40"></a><span id="l9.40" class="difflineminus">-  let confirmRemoveAccount = bundle.getFormattedString(&quot;confirmRemoveAccount&quot;,</span>
<a href="#l9.41"></a><span id="l9.41" class="difflineminus">-                                                       [prettyName]);</span>
<a href="#l9.42"></a><span id="l9.42" class="difflineminus">-</span>
<a href="#l9.43"></a><span id="l9.43" class="difflineminus">-  let confirmTitle = bundle.getString(&quot;confirmRemoveAccountTitle&quot;);</span>
<a href="#l9.44"></a><span id="l9.44" class="difflineminus">-</span>
<a href="#l9.45"></a><span id="l9.45" class="difflineminus">-  if (!Services.prompt.confirm(window, confirmTitle, confirmRemoveAccount))</span>
<a href="#l9.46"></a><span id="l9.46" class="difflineminus">-    return;</span>
<a href="#l9.47"></a><span id="l9.47" class="difflineminus">-</span>
<a href="#l9.48"></a><span id="l9.48">   let serverList = [];</span>
<a href="#l9.49"></a><span id="l9.49">   let accountTreeNode = document.getElementById(&quot;account-tree-children&quot;);</span>
<a href="#l9.50"></a><span id="l9.50">   // build the list of servers in the account tree (order is important)</span>
<a href="#l9.51"></a><span id="l9.51">   for (let i = 0; i &lt; accountTreeNode.childNodes.length; i++) {</span>
<a href="#l9.52"></a><span id="l9.52">     if (&quot;_account&quot; in accountTreeNode.childNodes[i]) {</span>
<a href="#l9.53"></a><span id="l9.53">       let curServer = accountTreeNode.childNodes[i]._account.incomingServer;</span>
<a href="#l9.54"></a><span id="l9.54">       if (serverList.indexOf(curServer) == -1)</span>
<a href="#l9.55"></a><span id="l9.55">         serverList.push(curServer);</span>
<a href="#l9.56"></a><span id="l9.56" class="difflineat">@@ -752,46 +744,40 @@ function onRemoveAccount(event) {</span>
<a href="#l9.57"></a><span id="l9.57"> </span>
<a href="#l9.58"></a><span id="l9.58">   // After the current server is deleted, choose the next server/account,</span>
<a href="#l9.59"></a><span id="l9.59">   // or the previous one if the last one was deleted.</span>
<a href="#l9.60"></a><span id="l9.60">   if (serverIndex == serverList.length - 1)</span>
<a href="#l9.61"></a><span id="l9.61">     serverIndex--;</span>
<a href="#l9.62"></a><span id="l9.62">   else</span>
<a href="#l9.63"></a><span id="l9.63">     serverIndex++;</span>
<a href="#l9.64"></a><span id="l9.64"> </span>
<a href="#l9.65"></a><span id="l9.65" class="difflineminus">-  // Remove password information.</span>
<a href="#l9.66"></a><span id="l9.66" class="difflineminus">-  let serverUri = server.type + &quot;://&quot; + server.hostName;</span>
<a href="#l9.67"></a><span id="l9.67" class="difflineplus">+  // Need to save these before the account and its server is removed.</span>
<a href="#l9.68"></a><span id="l9.68" class="difflineplus">+  let serverId = server.serverURI;</span>
<a href="#l9.69"></a><span id="l9.69"> </span>
<a href="#l9.70"></a><span id="l9.70" class="difflineminus">-  let logins = Services.logins.findLogins({}, serverUri, null, serverUri);</span>
<a href="#l9.71"></a><span id="l9.71" class="difflineplus">+  // Confirm account deletion.</span>
<a href="#l9.72"></a><span id="l9.72" class="difflineplus">+  let removeArgs = { server: server, account: currentAccount,</span>
<a href="#l9.73"></a><span id="l9.73" class="difflineplus">+                     result: false };</span>
<a href="#l9.74"></a><span id="l9.74"> </span>
<a href="#l9.75"></a><span id="l9.75" class="difflineminus">-  for (let i = 0; i &lt; logins.length; i++) {</span>
<a href="#l9.76"></a><span id="l9.76" class="difflineminus">-    if (logins[i].username == server.username) {</span>
<a href="#l9.77"></a><span id="l9.77" class="difflineminus">-      Services.logins.removeLogin(logins[i]);</span>
<a href="#l9.78"></a><span id="l9.78" class="difflineminus">-      break;</span>
<a href="#l9.79"></a><span id="l9.79" class="difflineminus">-    }</span>
<a href="#l9.80"></a><span id="l9.80" class="difflineplus">+  window.openDialog(&quot;chrome://messenger/content/removeAccount.xul&quot;,</span>
<a href="#l9.81"></a><span id="l9.81" class="difflineplus">+                    &quot;removeAccount&quot;,</span>
<a href="#l9.82"></a><span id="l9.82" class="difflineplus">+                    &quot;chrome,titlebar,modal,centerscreen,resizable=no&quot;,</span>
<a href="#l9.83"></a><span id="l9.83" class="difflineplus">+                    removeArgs);</span>
<a href="#l9.84"></a><span id="l9.84" class="difflineplus">+</span>
<a href="#l9.85"></a><span id="l9.85" class="difflineplus">+  // If result is true, the account was removed.</span>
<a href="#l9.86"></a><span id="l9.86" class="difflineplus">+  if (!removeArgs.result)</span>
<a href="#l9.87"></a><span id="l9.87" class="difflineplus">+    return;</span>
<a href="#l9.88"></a><span id="l9.88" class="difflineplus">+</span>
<a href="#l9.89"></a><span id="l9.89" class="difflineplus">+  // clear cached data out of the account array</span>
<a href="#l9.90"></a><span id="l9.90" class="difflineplus">+  currentAccount = currentPageId = null;</span>
<a href="#l9.91"></a><span id="l9.91" class="difflineplus">+  if (serverId in accountArray) {</span>
<a href="#l9.92"></a><span id="l9.92" class="difflineplus">+    delete accountArray[serverId];</span>
<a href="#l9.93"></a><span id="l9.93">   }</span>
<a href="#l9.94"></a><span id="l9.94"> </span>
<a href="#l9.95"></a><span id="l9.95" class="difflineminus">-  try {</span>
<a href="#l9.96"></a><span id="l9.96" class="difflineminus">-    let serverId = server.serverURI;</span>
<a href="#l9.97"></a><span id="l9.97" class="difflineminus">-    MailServices.accounts.removeAccount(currentAccount);</span>
<a href="#l9.98"></a><span id="l9.98" class="difflineminus">-</span>
<a href="#l9.99"></a><span id="l9.99" class="difflineminus">-    // clear cached data out of the account array</span>
<a href="#l9.100"></a><span id="l9.100" class="difflineminus">-    currentAccount = currentPageId = null;</span>
<a href="#l9.101"></a><span id="l9.101" class="difflineminus">-    if (serverId in accountArray) {</span>
<a href="#l9.102"></a><span id="l9.102" class="difflineminus">-      delete accountArray[serverId];</span>
<a href="#l9.103"></a><span id="l9.103" class="difflineminus">-    }</span>
<a href="#l9.104"></a><span id="l9.104" class="difflineminus">-</span>
<a href="#l9.105"></a><span id="l9.105" class="difflineminus">-    if ((serverIndex &gt;= 0) &amp;&amp; (serverIndex &lt; serverList.length))</span>
<a href="#l9.106"></a><span id="l9.106" class="difflineminus">-      selectServer(serverList[serverIndex], null);</span>
<a href="#l9.107"></a><span id="l9.107" class="difflineminus">-  }</span>
<a href="#l9.108"></a><span id="l9.108" class="difflineminus">-  catch (ex) {</span>
<a href="#l9.109"></a><span id="l9.109" class="difflineminus">-    Components.utils.reportError(&quot;Failure to remove account: &quot; + ex);</span>
<a href="#l9.110"></a><span id="l9.110" class="difflineminus">-    let alertText = bundle.getString(&quot;failedRemoveAccount&quot;);</span>
<a href="#l9.111"></a><span id="l9.111" class="difflineminus">-    Services.prompt.alert(window, null, alertText);</span>
<a href="#l9.112"></a><span id="l9.112" class="difflineminus">-  }</span>
<a href="#l9.113"></a><span id="l9.113" class="difflineplus">+  if ((serverIndex &gt;= 0) &amp;&amp; (serverIndex &lt; serverList.length))</span>
<a href="#l9.114"></a><span id="l9.114" class="difflineplus">+    selectServer(serverList[serverIndex], null);</span>
<a href="#l9.115"></a><span id="l9.115"> </span>
<a href="#l9.116"></a><span id="l9.116">   // Either the default account was deleted so there is a new one</span>
<a href="#l9.117"></a><span id="l9.117">   // or the default account was not changed. Either way, there is</span>
<a href="#l9.118"></a><span id="l9.118">   // no need to unmark the old one.</span>
<a href="#l9.119"></a><span id="l9.119">   markDefaultServer(getDefaultAccount(), null);</span>
<a href="#l9.120"></a><span id="l9.120"> }</span>
<a href="#l9.121"></a><span id="l9.121"> </span>
<a href="#l9.122"></a><span id="l9.122"> function saveAccount(accountValues, account)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1">new file mode 100644</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineminus">--- /dev/null</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineplus">+++ b/mailnews/base/prefs/content/removeAccount.js</span>
<a href="#l10.4"></a><span id="l10.4" class="difflineat">@@ -0,0 +1,140 @@</span>
<a href="#l10.5"></a><span id="l10.5" class="difflineplus">+/* -*- Mode: Java; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */</span>
<a href="#l10.6"></a><span id="l10.6" class="difflineplus">+/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l10.7"></a><span id="l10.7" class="difflineplus">+ * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l10.8"></a><span id="l10.8" class="difflineplus">+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a href="#l10.9"></a><span id="l10.9" class="difflineplus">+</span>
<a href="#l10.10"></a><span id="l10.10" class="difflineplus">+Components.utils.import(&quot;resource:///modules/mailServices.js&quot;);</span>
<a href="#l10.11"></a><span id="l10.11" class="difflineplus">+Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineplus">+</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+var gServer;</span>
<a href="#l10.14"></a><span id="l10.14" class="difflineplus">+var gDialog;</span>
<a href="#l10.15"></a><span id="l10.15" class="difflineplus">+</span>
<a href="#l10.16"></a><span id="l10.16" class="difflineplus">+function onLoad(event) {</span>
<a href="#l10.17"></a><span id="l10.17" class="difflineplus">+  gServer = window.arguments[0].account.incomingServer;</span>
<a href="#l10.18"></a><span id="l10.18" class="difflineplus">+  gDialog = document.documentElement;</span>
<a href="#l10.19"></a><span id="l10.19" class="difflineplus">+</span>
<a href="#l10.20"></a><span id="l10.20" class="difflineplus">+  let bundle = document.getElementById(&quot;bundle_removeAccount&quot;);</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineplus">+  let removeQuestion = bundle.getFormattedString(&quot;removeQuestion&quot;,</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineplus">+                                                 [gServer.prettyName]);</span>
<a href="#l10.23"></a><span id="l10.23" class="difflineplus">+  document.getElementById(&quot;accountName&quot;).textContent = removeQuestion;</span>
<a href="#l10.24"></a><span id="l10.24" class="difflineplus">+</span>
<a href="#l10.25"></a><span id="l10.25" class="difflineplus">+  // Do not allow removal if localPath is outside of profile folder.</span>
<a href="#l10.26"></a><span id="l10.26" class="difflineplus">+  let profilePath = Services.dirsvc.get(&quot;ProfD&quot;, Components.interfaces.nsIFile)</span>
<a href="#l10.27"></a><span id="l10.27" class="difflineplus">+  profilePath.normalize();</span>
<a href="#l10.28"></a><span id="l10.28" class="difflineplus">+  let localDirectory = gServer.localPath</span>
<a href="#l10.29"></a><span id="l10.29" class="difflineplus">+  localDirectory.normalize();</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineplus">+  // TODO: bug 77652, decide what to do for deferred accounts.</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineplus">+  // And inform the user if the account localPath is outside the profile.</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+  if ((gServer.isDeferredTo ||</span>
<a href="#l10.33"></a><span id="l10.33" class="difflineplus">+      (gServer instanceof Components.interfaces.nsIPop3IncomingServer &amp;&amp;</span>
<a href="#l10.34"></a><span id="l10.34" class="difflineplus">+       gServer.deferredToAccount)) ||</span>
<a href="#l10.35"></a><span id="l10.35" class="difflineplus">+       !profilePath.contains(localDirectory)) {</span>
<a href="#l10.36"></a><span id="l10.36" class="difflineplus">+    document.getElementById(&quot;removeData&quot;).disabled = true;</span>
<a href="#l10.37"></a><span id="l10.37" class="difflineplus">+  }</span>
<a href="#l10.38"></a><span id="l10.38" class="difflineplus">+</span>
<a href="#l10.39"></a><span id="l10.39" class="difflineplus">+  enableRemove();</span>
<a href="#l10.40"></a><span id="l10.40" class="difflineplus">+  window.sizeToContent();</span>
<a href="#l10.41"></a><span id="l10.41" class="difflineplus">+}</span>
<a href="#l10.42"></a><span id="l10.42" class="difflineplus">+</span>
<a href="#l10.43"></a><span id="l10.43" class="difflineplus">+function enableRemove() {</span>
<a href="#l10.44"></a><span id="l10.44" class="difflineplus">+  gDialog.getButton(&quot;accept&quot;).disabled =</span>
<a href="#l10.45"></a><span id="l10.45" class="difflineplus">+    (!document.getElementById(&quot;removeAccount&quot;).checked &amp;&amp;</span>
<a href="#l10.46"></a><span id="l10.46" class="difflineplus">+     !document.getElementById(&quot;removeData&quot;).checked);</span>
<a href="#l10.47"></a><span id="l10.47" class="difflineplus">+}</span>
<a href="#l10.48"></a><span id="l10.48" class="difflineplus">+</span>
<a href="#l10.49"></a><span id="l10.49" class="difflineplus">+/**</span>
<a href="#l10.50"></a><span id="l10.50" class="difflineplus">+ * Show the local directory.</span>
<a href="#l10.51"></a><span id="l10.51" class="difflineplus">+ */</span>
<a href="#l10.52"></a><span id="l10.52" class="difflineplus">+function openLocalDirectory() {</span>
<a href="#l10.53"></a><span id="l10.53" class="difflineplus">+  let nsLocalFile = Components.Constructor(&quot;@mozilla.org/file/local;1&quot;,</span>
<a href="#l10.54"></a><span id="l10.54" class="difflineplus">+                                           &quot;nsILocalFile&quot;, &quot;initWithPath&quot;);</span>
<a href="#l10.55"></a><span id="l10.55" class="difflineplus">+  let localDir = gServer.localPath.path;</span>
<a href="#l10.56"></a><span id="l10.56" class="difflineplus">+  try {</span>
<a href="#l10.57"></a><span id="l10.57" class="difflineplus">+    new nsLocalFile(localDir).reveal();</span>
<a href="#l10.58"></a><span id="l10.58" class="difflineplus">+  } catch(e) {</span>
<a href="#l10.59"></a><span id="l10.59" class="difflineplus">+    // Reveal may fail e.g. on Linux, then just show the path as a string.</span>
<a href="#l10.60"></a><span id="l10.60" class="difflineplus">+    document.getElementById(&quot;localDirectory&quot;).value = localDir;</span>
<a href="#l10.61"></a><span id="l10.61" class="difflineplus">+    document.getElementById(&quot;localDirectory&quot;).collapsed = false;</span>
<a href="#l10.62"></a><span id="l10.62" class="difflineplus">+  }</span>
<a href="#l10.63"></a><span id="l10.63" class="difflineplus">+}</span>
<a href="#l10.64"></a><span id="l10.64" class="difflineplus">+</span>
<a href="#l10.65"></a><span id="l10.65" class="difflineplus">+function showInfo() {</span>
<a href="#l10.66"></a><span id="l10.66" class="difflineplus">+  let descs = document.querySelectorAll(&quot;vbox.indent&quot;);</span>
<a href="#l10.67"></a><span id="l10.67" class="difflineplus">+  for (let desc of descs) {</span>
<a href="#l10.68"></a><span id="l10.68" class="difflineplus">+    desc.collapsed = false;</span>
<a href="#l10.69"></a><span id="l10.69" class="difflineplus">+  }</span>
<a href="#l10.70"></a><span id="l10.70" class="difflineplus">+</span>
<a href="#l10.71"></a><span id="l10.71" class="difflineplus">+  if (gServer.type == &quot;imap&quot; || gServer.type == &quot;nntp&quot;) {</span>
<a href="#l10.72"></a><span id="l10.72" class="difflineplus">+    document.getElementById(&quot;serverAccount&quot;).collapsed = false;</span>
<a href="#l10.73"></a><span id="l10.73" class="difflineplus">+  } else {</span>
<a href="#l10.74"></a><span id="l10.74" class="difflineplus">+    document.getElementById(&quot;localAccount&quot;).collapsed = false;</span>
<a href="#l10.75"></a><span id="l10.75" class="difflineplus">+  }</span>
<a href="#l10.76"></a><span id="l10.76" class="difflineplus">+</span>
<a href="#l10.77"></a><span id="l10.77" class="difflineplus">+  window.sizeToContent();</span>
<a href="#l10.78"></a><span id="l10.78" class="difflineplus">+  gDialog.getButton(&quot;disclosure&quot;).disabled = true;</span>
<a href="#l10.79"></a><span id="l10.79" class="difflineplus">+  gDialog.getButton(&quot;disclosure&quot;).blur();</span>
<a href="#l10.80"></a><span id="l10.80" class="difflineplus">+}</span>
<a href="#l10.81"></a><span id="l10.81" class="difflineplus">+</span>
<a href="#l10.82"></a><span id="l10.82" class="difflineplus">+function removeAccount() {</span>
<a href="#l10.83"></a><span id="l10.83" class="difflineplus">+  let removeAccount = document.getElementById(&quot;removeAccount&quot;).checked;</span>
<a href="#l10.84"></a><span id="l10.84" class="difflineplus">+  let removeData = document.getElementById(&quot;removeData&quot;).checked;</span>
<a href="#l10.85"></a><span id="l10.85" class="difflineplus">+  try {</span>
<a href="#l10.86"></a><span id="l10.86" class="difflineplus">+    // Remove the requested account data.</span>
<a href="#l10.87"></a><span id="l10.87" class="difflineplus">+    if (removeAccount) {</span>
<a href="#l10.88"></a><span id="l10.88" class="difflineplus">+      // Remove account</span>
<a href="#l10.89"></a><span id="l10.89" class="difflineplus">+      // Need to save these before the account and its server is removed.</span>
<a href="#l10.90"></a><span id="l10.90" class="difflineplus">+      let serverUri = gServer.type + &quot;://&quot; + gServer.hostName;</span>
<a href="#l10.91"></a><span id="l10.91" class="difflineplus">+      let serverUsername = gServer.username;</span>
<a href="#l10.92"></a><span id="l10.92" class="difflineplus">+</span>
<a href="#l10.93"></a><span id="l10.93" class="difflineplus">+      MailServices.accounts.removeAccount(window.arguments[0].account, removeData);</span>
<a href="#l10.94"></a><span id="l10.94" class="difflineplus">+      window.arguments[0].result = true;</span>
<a href="#l10.95"></a><span id="l10.95" class="difflineplus">+</span>
<a href="#l10.96"></a><span id="l10.96" class="difflineplus">+      // Remove password information.</span>
<a href="#l10.97"></a><span id="l10.97" class="difflineplus">+      let logins = Services.logins.findLogins({}, serverUri, null, serverUri);</span>
<a href="#l10.98"></a><span id="l10.98" class="difflineplus">+      for (let i = 0; i &lt; logins.length; i++) {</span>
<a href="#l10.99"></a><span id="l10.99" class="difflineplus">+        if (logins[i].username == serverUsername) {</span>
<a href="#l10.100"></a><span id="l10.100" class="difflineplus">+          Services.logins.removeLogin(logins[i]);</span>
<a href="#l10.101"></a><span id="l10.101" class="difflineplus">+          break;</span>
<a href="#l10.102"></a><span id="l10.102" class="difflineplus">+        }</span>
<a href="#l10.103"></a><span id="l10.103" class="difflineplus">+      }</span>
<a href="#l10.104"></a><span id="l10.104" class="difflineplus">+    } else if (removeData) {</span>
<a href="#l10.105"></a><span id="l10.105" class="difflineplus">+      // Remove files only.</span>
<a href="#l10.106"></a><span id="l10.106" class="difflineplus">+      // TODO: bug 1302193</span>
<a href="#l10.107"></a><span id="l10.107" class="difflineplus">+      window.arguments[0].result = false;</span>
<a href="#l10.108"></a><span id="l10.108" class="difflineplus">+    }</span>
<a href="#l10.109"></a><span id="l10.109" class="difflineplus">+</span>
<a href="#l10.110"></a><span id="l10.110" class="difflineplus">+    document.getElementById(&quot;status&quot;).selectedPanel =</span>
<a href="#l10.111"></a><span id="l10.111" class="difflineplus">+      document.getElementById(&quot;success&quot;);</span>
<a href="#l10.112"></a><span id="l10.112" class="difflineplus">+  } catch (ex) {</span>
<a href="#l10.113"></a><span id="l10.113" class="difflineplus">+    document.getElementById(&quot;status&quot;).selectedPanel =</span>
<a href="#l10.114"></a><span id="l10.114" class="difflineplus">+      document.getElementById(&quot;failure&quot;);</span>
<a href="#l10.115"></a><span id="l10.115" class="difflineplus">+    Components.utils.reportError(&quot;Failure to remove account: &quot; + ex);</span>
<a href="#l10.116"></a><span id="l10.116" class="difflineplus">+    window.arguments[0].result = false;</span>
<a href="#l10.117"></a><span id="l10.117" class="difflineplus">+  }</span>
<a href="#l10.118"></a><span id="l10.118" class="difflineplus">+}</span>
<a href="#l10.119"></a><span id="l10.119" class="difflineplus">+</span>
<a href="#l10.120"></a><span id="l10.120" class="difflineplus">+function onAccept() {</span>
<a href="#l10.121"></a><span id="l10.121" class="difflineplus">+  // If Cancel is disabled, we already tried to remove the account</span>
<a href="#l10.122"></a><span id="l10.122" class="difflineplus">+  // and can only close the dialog.</span>
<a href="#l10.123"></a><span id="l10.123" class="difflineplus">+  if (gDialog.getButton(&quot;cancel&quot;).disabled)</span>
<a href="#l10.124"></a><span id="l10.124" class="difflineplus">+    return true;</span>
<a href="#l10.125"></a><span id="l10.125" class="difflineplus">+</span>
<a href="#l10.126"></a><span id="l10.126" class="difflineplus">+  gDialog.getButton(&quot;accept&quot;).disabled = true;</span>
<a href="#l10.127"></a><span id="l10.127" class="difflineplus">+  gDialog.getButton(&quot;cancel&quot;).disabled = true;</span>
<a href="#l10.128"></a><span id="l10.128" class="difflineplus">+  gDialog.getButton(&quot;disclosure&quot;).disabled = true;</span>
<a href="#l10.129"></a><span id="l10.129" class="difflineplus">+</span>
<a href="#l10.130"></a><span id="l10.130" class="difflineplus">+  // Change the &quot;Remove&quot; to an &quot;OK&quot; button by clearing the custom label.</span>
<a href="#l10.131"></a><span id="l10.131" class="difflineplus">+  gDialog.removeAttribute(&quot;buttonlabelaccept&quot;);</span>
<a href="#l10.132"></a><span id="l10.132" class="difflineplus">+  gDialog.removeAttribute(&quot;buttonaccesskeyaccept&quot;);</span>
<a href="#l10.133"></a><span id="l10.133" class="difflineplus">+  gDialog.getButton(&quot;accept&quot;).removeAttribute(&quot;label&quot;);</span>
<a href="#l10.134"></a><span id="l10.134" class="difflineplus">+  gDialog.getButton(&quot;accept&quot;).removeAttribute(&quot;accesskey&quot;);</span>
<a href="#l10.135"></a><span id="l10.135" class="difflineplus">+  gDialog.buttons = &quot;accept&quot;;</span>
<a href="#l10.136"></a><span id="l10.136" class="difflineplus">+</span>
<a href="#l10.137"></a><span id="l10.137" class="difflineplus">+  document.getElementById(&quot;infoPane&quot;).selectedIndex = 1;</span>
<a href="#l10.138"></a><span id="l10.138" class="difflineplus">+  window.sizeToContent();</span>
<a href="#l10.139"></a><span id="l10.139" class="difflineplus">+</span>
<a href="#l10.140"></a><span id="l10.140" class="difflineplus">+  removeAccount();</span>
<a href="#l10.141"></a><span id="l10.141" class="difflineplus">+</span>
<a href="#l10.142"></a><span id="l10.142" class="difflineplus">+  gDialog.getButton(&quot;accept&quot;).disabled = false;</span>
<a href="#l10.143"></a><span id="l10.143" class="difflineplus">+  return false;</span>
<a href="#l10.144"></a><span id="l10.144" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1">new file mode 100644</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineminus">--- /dev/null</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineplus">+++ b/mailnews/base/prefs/content/removeAccount.xul</span>
<a href="#l11.4"></a><span id="l11.4" class="difflineat">@@ -0,0 +1,79 @@</span>
<a href="#l11.5"></a><span id="l11.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<a href="#l11.6"></a><span id="l11.6" class="difflineplus">+&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l11.7"></a><span id="l11.7" class="difflineplus">+   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l11.8"></a><span id="l11.8" class="difflineplus">+   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l11.9"></a><span id="l11.9" class="difflineplus">+</span>
<a href="#l11.10"></a><span id="l11.10" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://messenger/skin/messenger.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l11.11"></a><span id="l11.11" class="difflineplus">+&lt;?xml-stylesheet href=&quot;chrome://messenger/skin/dialogs.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineplus">+</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+&lt;!DOCTYPE dialog [</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineplus">+&lt;!ENTITY % brandDTD SYSTEM &quot;chrome://branding/locale/brand.dtd&quot;&gt;</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineplus">+%brandDTD;</span>
<a href="#l11.16"></a><span id="l11.16" class="difflineplus">+&lt;!ENTITY % removalDTD SYSTEM &quot;chrome://messenger/locale/removeAccount.dtd&quot;&gt;</span>
<a href="#l11.17"></a><span id="l11.17" class="difflineplus">+%removalDTD;</span>
<a href="#l11.18"></a><span id="l11.18" class="difflineplus">+]&gt;</span>
<a href="#l11.19"></a><span id="l11.19" class="difflineplus">+</span>
<a href="#l11.20"></a><span id="l11.20" class="difflineplus">+&lt;dialog id=&quot;removeAccountDialog&quot;</span>
<a href="#l11.21"></a><span id="l11.21" class="difflineplus">+        xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l11.22"></a><span id="l11.22" class="difflineplus">+        title=&quot;&amp;dialogTitle;&quot;</span>
<a href="#l11.23"></a><span id="l11.23" class="difflineplus">+        width=&quot;600&quot;</span>
<a href="#l11.24"></a><span id="l11.24" class="difflineplus">+        buttons=&quot;accept,disclosure,cancel&quot;</span>
<a href="#l11.25"></a><span id="l11.25" class="difflineplus">+        buttonlabelaccept=&quot;&amp;removeButton.label;&quot;</span>
<a href="#l11.26"></a><span id="l11.26" class="difflineplus">+        buttonaccesskeyaccept=&quot;&amp;removeButton.accesskey;&quot;</span>
<a href="#l11.27"></a><span id="l11.27" class="difflineplus">+        defaultButton=&quot;cancel&quot;</span>
<a href="#l11.28"></a><span id="l11.28" class="difflineplus">+        onload=&quot;onLoad();&quot;</span>
<a href="#l11.29"></a><span id="l11.29" class="difflineplus">+        ondialogdisclosure=&quot;showInfo();&quot;</span>
<a href="#l11.30"></a><span id="l11.30" class="difflineplus">+        ondialogaccept=&quot;return onAccept();&quot;&gt;</span>
<a href="#l11.31"></a><span id="l11.31" class="difflineplus">+  &lt;stringbundle id=&quot;bundle_removeAccount&quot;</span>
<a href="#l11.32"></a><span id="l11.32" class="difflineplus">+                src=&quot;chrome://messenger/locale/removeAccount.properties&quot;/&gt;</span>
<a href="#l11.33"></a><span id="l11.33" class="difflineplus">+  &lt;script type=&quot;application/javascript&quot;</span>
<a href="#l11.34"></a><span id="l11.34" class="difflineplus">+          src=&quot;chrome://messenger/content/removeAccount.js&quot;/&gt;</span>
<a href="#l11.35"></a><span id="l11.35" class="difflineplus">+  &lt;deck id=&quot;infoPane&quot;&gt;</span>
<a href="#l11.36"></a><span id="l11.36" class="difflineplus">+    &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l11.37"></a><span id="l11.37" class="difflineplus">+      &lt;label id=&quot;accountName&quot;&gt;&lt;/label&gt;</span>
<a href="#l11.38"></a><span id="l11.38" class="difflineplus">+      &lt;separator class=&quot;thin&quot;/&gt;</span>
<a href="#l11.39"></a><span id="l11.39" class="difflineplus">+      &lt;checkbox id=&quot;removeAccount&quot;</span>
<a href="#l11.40"></a><span id="l11.40" class="difflineplus">+                label=&quot;&amp;removeAccount.label;&quot;</span>
<a href="#l11.41"></a><span id="l11.41" class="difflineplus">+                checked=&quot;true&quot;</span>
<a href="#l11.42"></a><span id="l11.42" class="difflineplus">+                disabled=&quot;true&quot;</span>
<a href="#l11.43"></a><span id="l11.43" class="difflineplus">+                accesskey=&quot;&amp;removeAccount.accesskey;&quot;</span>
<a href="#l11.44"></a><span id="l11.44" class="difflineplus">+                oncommand=&quot;enableRemove();&quot;/&gt;</span>
<a href="#l11.45"></a><span id="l11.45" class="difflineplus">+      &lt;vbox class=&quot;indent&quot; collapsed=&quot;true&quot;&gt;</span>
<a href="#l11.46"></a><span id="l11.46" class="difflineplus">+        &lt;description&gt;</span>
<a href="#l11.47"></a><span id="l11.47" class="difflineplus">+          &amp;removeAccount.desc;</span>
<a href="#l11.48"></a><span id="l11.48" class="difflineplus">+        &lt;/description&gt;</span>
<a href="#l11.49"></a><span id="l11.49" class="difflineplus">+      &lt;/vbox&gt;</span>
<a href="#l11.50"></a><span id="l11.50" class="difflineplus">+      &lt;checkbox id=&quot;removeData&quot;</span>
<a href="#l11.51"></a><span id="l11.51" class="difflineplus">+                label=&quot;&amp;removeData.label;&quot;</span>
<a href="#l11.52"></a><span id="l11.52" class="difflineplus">+                checked=&quot;false&quot;</span>
<a href="#l11.53"></a><span id="l11.53" class="difflineplus">+                accesskey=&quot;&amp;removeData.accesskey;&quot;</span>
<a href="#l11.54"></a><span id="l11.54" class="difflineplus">+                oncommand=&quot;enableRemove();&quot;/&gt;</span>
<a href="#l11.55"></a><span id="l11.55" class="difflineplus">+      &lt;vbox class=&quot;indent&quot; collapsed=&quot;true&quot;&gt;</span>
<a href="#l11.56"></a><span id="l11.56" class="difflineplus">+        &lt;description id=&quot;localAccount&quot; collapsed=&quot;true&quot;&gt;</span>
<a href="#l11.57"></a><span id="l11.57" class="difflineplus">+          &amp;removeDataLocalAccount.desc;</span>
<a href="#l11.58"></a><span id="l11.58" class="difflineplus">+        &lt;/description&gt;</span>
<a href="#l11.59"></a><span id="l11.59" class="difflineplus">+        &lt;description id=&quot;serverAccount&quot; collapsed=&quot;true&quot;&gt;</span>
<a href="#l11.60"></a><span id="l11.60" class="difflineplus">+          &amp;removeDataServerAccount.desc;</span>
<a href="#l11.61"></a><span id="l11.61" class="difflineplus">+        &lt;/description&gt;</span>
<a href="#l11.62"></a><span id="l11.62" class="difflineplus">+        &lt;hbox align=&quot;center&quot;&gt;</span>
<a href="#l11.63"></a><span id="l11.63" class="difflineplus">+          &lt;button label=&quot;&amp;showData.label;&quot;</span>
<a href="#l11.64"></a><span id="l11.64" class="difflineplus">+                  accesskey=&quot;&amp;showData.accesskey;&quot;</span>
<a href="#l11.65"></a><span id="l11.65" class="difflineplus">+                  oncommand=&quot;openLocalDirectory();&quot;/&gt;</span>
<a href="#l11.66"></a><span id="l11.66" class="difflineplus">+          &lt;label id=&quot;localDirectory&quot; collapsed=&quot;true&quot;/&gt;</span>
<a href="#l11.67"></a><span id="l11.67" class="difflineplus">+        &lt;/hbox&gt;</span>
<a href="#l11.68"></a><span id="l11.68" class="difflineplus">+      &lt;/vbox&gt;</span>
<a href="#l11.69"></a><span id="l11.69" class="difflineplus">+    &lt;/vbox&gt;</span>
<a href="#l11.70"></a><span id="l11.70" class="difflineplus">+    &lt;vbox align=&quot;center&quot;&gt;</span>
<a href="#l11.71"></a><span id="l11.71" class="difflineplus">+      &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l11.72"></a><span id="l11.72" class="difflineplus">+      &lt;deck id=&quot;status&quot;&gt;</span>
<a href="#l11.73"></a><span id="l11.73" class="difflineplus">+        &lt;vbox align=&quot;center&quot;&gt;</span>
<a href="#l11.74"></a><span id="l11.74" class="difflineplus">+          &lt;label&gt;&amp;progressPending;&lt;/label&gt;</span>
<a href="#l11.75"></a><span id="l11.75" class="difflineplus">+          &lt;progressmeter mode=&quot;undetermined&quot;/&gt;</span>
<a href="#l11.76"></a><span id="l11.76" class="difflineplus">+        &lt;/vbox&gt;</span>
<a href="#l11.77"></a><span id="l11.77" class="difflineplus">+        &lt;label id=&quot;success&quot;&gt;&amp;progressSuccess;&lt;/label&gt;</span>
<a href="#l11.78"></a><span id="l11.78" class="difflineplus">+        &lt;label id=&quot;failure&quot;&gt;&amp;progressFailure;&lt;/label&gt;</span>
<a href="#l11.79"></a><span id="l11.79" class="difflineplus">+      &lt;/deck&gt;</span>
<a href="#l11.80"></a><span id="l11.80" class="difflineplus">+      &lt;spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l11.81"></a><span id="l11.81" class="difflineplus">+    &lt;/vbox&gt;</span>
<a href="#l11.82"></a><span id="l11.82" class="difflineplus">+  &lt;/deck&gt;</span>
<a href="#l11.83"></a><span id="l11.83" class="difflineplus">+&lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/mailnews/base/public/nsIMsgAccountManager.idl</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/mailnews/base/public/nsIMsgAccountManager.idl</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -16,19 +16,25 @@ interface nsIFolderListener;</span>
<a href="#l12.4"></a><span id="l12.4"> [scriptable, uuid(d5ab0eea-49c5-42f2-b2e6-8ad306606d8b)]</span>
<a href="#l12.5"></a><span id="l12.5"> interface nsIMsgAccountManager : nsISupports {</span>
<a href="#l12.6"></a><span id="l12.6"> </span>
<a href="#l12.7"></a><span id="l12.7">   nsIMsgAccount createAccount();</span>
<a href="#l12.8"></a><span id="l12.8">   /*</span>
<a href="#l12.9"></a><span id="l12.9">    * Return the account with the provided key, or null if none found.</span>
<a href="#l12.10"></a><span id="l12.10">    */</span>
<a href="#l12.11"></a><span id="l12.11">   nsIMsgAccount getAccount(in ACString key);</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-    </span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-  void removeAccount(in nsIMsgAccount account);</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineminus">-  </span>
<a href="#l12.15"></a><span id="l12.15" class="difflineplus">+</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineplus">+  /**</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineplus">+   * Removes the account from the list of accounts.</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+   *</span>
<a href="#l12.19"></a><span id="l12.19" class="difflineplus">+   * @param aAccount      the account to remove</span>
<a href="#l12.20"></a><span id="l12.20" class="difflineplus">+   * @param aRemoveFiles  remove data directory (local directory) of this account</span>
<a href="#l12.21"></a><span id="l12.21" class="difflineplus">+   */</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineplus">+  void removeAccount(in nsIMsgAccount aAccount, [optional] in boolean aRemoveFiles);</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineplus">+</span>
<a href="#l12.24"></a><span id="l12.24">   /*</span>
<a href="#l12.25"></a><span id="l12.25">    * creates a new identity and assigns it a new, unique &quot;key&quot;</span>
<a href="#l12.26"></a><span id="l12.26">    */</span>
<a href="#l12.27"></a><span id="l12.27">   nsIMsgIdentity createIdentity();</span>
<a href="#l12.28"></a><span id="l12.28"> </span>
<a href="#l12.29"></a><span id="l12.29">   /*</span>
<a href="#l12.30"></a><span id="l12.30">    * creates a new server and assigns it a new, unique &quot;key&quot;</span>
<a href="#l12.31"></a><span id="l12.31">    * the given type will be used to construct a ContractID</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineat">@@ -39,22 +45,22 @@ interface nsIMsgAccountManager : nsISupp</span>
<a href="#l12.33"></a><span id="l12.33">   nsIMsgIncomingServer createIncomingServer(in ACString username,</span>
<a href="#l12.34"></a><span id="l12.34">                                             in ACString hostname,</span>
<a href="#l12.35"></a><span id="l12.35">                                             in ACString type);</span>
<a href="#l12.36"></a><span id="l12.36"> </span>
<a href="#l12.37"></a><span id="l12.37">   /**</span>
<a href="#l12.38"></a><span id="l12.38">    * Removes the server from the list of servers</span>
<a href="#l12.39"></a><span id="l12.39">    * </span>
<a href="#l12.40"></a><span id="l12.40">    * @param aServer        server to remove</span>
<a href="#l12.41"></a><span id="l12.41" class="difflineminus">-   * @param aCleanupFiles  remove directory from profile</span>
<a href="#l12.42"></a><span id="l12.42" class="difflineplus">+   * @param aRemoveFiles   remove directory from profile</span>
<a href="#l12.43"></a><span id="l12.43">    *</span>
<a href="#l12.44"></a><span id="l12.44">    * @throws NS_ERROR_FAILURE if server not found </span>
<a href="#l12.45"></a><span id="l12.45">    */</span>
<a href="#l12.46"></a><span id="l12.46">   void removeIncomingServer(in nsIMsgIncomingServer aServer, </span>
<a href="#l12.47"></a><span id="l12.47" class="difflineminus">-                            in boolean aCleanupFiles);</span>
<a href="#l12.48"></a><span id="l12.48" class="difflineplus">+                            in boolean aRemoveFiles);</span>
<a href="#l12.49"></a><span id="l12.49">   /*</span>
<a href="#l12.50"></a><span id="l12.50">    * get the identity with the given key</span>
<a href="#l12.51"></a><span id="l12.51">    * if the identity does not exist, it will be created</span>
<a href="#l12.52"></a><span id="l12.52">    */</span>
<a href="#l12.53"></a><span id="l12.53">   nsIMsgIdentity getIdentity(in ACString key);</span>
<a href="#l12.54"></a><span id="l12.54"> </span>
<a href="#l12.55"></a><span id="l12.55">   /*</span>
<a href="#l12.56"></a><span id="l12.56">    * Gets the existing incoming server with the given key</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/mailnews/base/public/nsIMsgIncomingServer.idl</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/mailnews/base/public/nsIMsgIncomingServer.idl</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -330,24 +330,24 @@ interface nsIMsgIncomingServer : nsISupp</span>
<a href="#l13.4"></a><span id="l13.4">   /** @} */</span>
<a href="#l13.5"></a><span id="l13.5"> </span>
<a href="#l13.6"></a><span id="l13.6">   /**</span>
<a href="#l13.7"></a><span id="l13.7">    * this is really dangerous. this destroys all pref values</span>
<a href="#l13.8"></a><span id="l13.8">    * do not call this unless you know what you're doing!</span>
<a href="#l13.9"></a><span id="l13.9">    */</span>
<a href="#l13.10"></a><span id="l13.10">   void clearAllValues();</span>
<a href="#l13.11"></a><span id="l13.11"> </span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-  /** </span>
<a href="#l13.13"></a><span id="l13.13" class="difflineminus">-   * this is also very dangerous.  this will remove the files</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineminus">-   * associated with this server on disk.</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineplus">+  /**</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineplus">+   * This is also very dangerous. This will low-level remove the files</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineplus">+   * associated with this server on disk. It does not notify any listeners.</span>
<a href="#l13.18"></a><span id="l13.18">    */</span>
<a href="#l13.19"></a><span id="l13.19">   void removeFiles();</span>
<a href="#l13.20"></a><span id="l13.20" class="difflineminus">-  </span>
<a href="#l13.21"></a><span id="l13.21" class="difflineplus">+</span>
<a href="#l13.22"></a><span id="l13.22">   attribute boolean valid;</span>
<a href="#l13.23"></a><span id="l13.23" class="difflineminus">-  </span>
<a href="#l13.24"></a><span id="l13.24" class="difflineplus">+</span>
<a href="#l13.25"></a><span id="l13.25">   AString toString();</span>
<a href="#l13.26"></a><span id="l13.26"> </span>
<a href="#l13.27"></a><span id="l13.27">   void displayOfflineMsg(in nsIMsgWindow aWindow);</span>
<a href="#l13.28"></a><span id="l13.28"> </span>
<a href="#l13.29"></a><span id="l13.29">   /* used for comparing nsIMsgIncomingServers */</span>
<a href="#l13.30"></a><span id="l13.30">   boolean equals(in nsIMsgIncomingServer server);</span>
<a href="#l13.31"></a><span id="l13.31"> </span>
<a href="#l13.32"></a><span id="l13.32">   /* Get Messages at startup */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/mailnews/base/src/nsMsgAccountManager.cpp</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/mailnews/base/src/nsMsgAccountManager.cpp</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -492,17 +492,17 @@ nsMsgAccountManager::GetIncomingServer(c</span>
<a href="#l14.4"></a><span id="l14.4">   rv = m_prefs-&gt;GetCharPref(serverPref.get(), getter_Copies(hostname));</span>
<a href="#l14.5"></a><span id="l14.5">   NS_ENSURE_SUCCESS(rv, NS_ERROR_NOT_INITIALIZED);</span>
<a href="#l14.6"></a><span id="l14.6"> </span>
<a href="#l14.7"></a><span id="l14.7">   return createKeyedServer(key, username, hostname, serverType, _retval);</span>
<a href="#l14.8"></a><span id="l14.8"> }</span>
<a href="#l14.9"></a><span id="l14.9"> </span>
<a href="#l14.10"></a><span id="l14.10"> NS_IMETHODIMP</span>
<a href="#l14.11"></a><span id="l14.11"> nsMsgAccountManager::RemoveIncomingServer(nsIMsgIncomingServer *aServer,</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-                                          bool aCleanupFiles)</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+                                          bool aRemoveFiles)</span>
<a href="#l14.14"></a><span id="l14.14"> {</span>
<a href="#l14.15"></a><span id="l14.15">   NS_ENSURE_ARG_POINTER(aServer);</span>
<a href="#l14.16"></a><span id="l14.16"> </span>
<a href="#l14.17"></a><span id="l14.17">   nsCString serverKey;</span>
<a href="#l14.18"></a><span id="l14.18">   nsresult rv = aServer-&gt;GetKey(serverKey);</span>
<a href="#l14.19"></a><span id="l14.19">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l14.20"></a><span id="l14.20"> </span>
<a href="#l14.21"></a><span id="l14.21">   LogoutOfServer(aServer); // close cached connections and forget session password</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineat">@@ -549,17 +549,17 @@ nsMsgAccountManager::RemoveIncomingServe</span>
<a href="#l14.23"></a><span id="l14.23">   }</span>
<a href="#l14.24"></a><span id="l14.24">   if (notifier)</span>
<a href="#l14.25"></a><span id="l14.25">     notifier-&gt;NotifyFolderDeleted(rootFolder);</span>
<a href="#l14.26"></a><span id="l14.26">   if (mailSession)</span>
<a href="#l14.27"></a><span id="l14.27">     mailSession-&gt;OnItemRemoved(nullptr, rootFolder);</span>
<a href="#l14.28"></a><span id="l14.28"> </span>
<a href="#l14.29"></a><span id="l14.29">   removeListenersFromFolder(rootFolder);</span>
<a href="#l14.30"></a><span id="l14.30">   NotifyServerUnloaded(aServer);</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineminus">-  if (aCleanupFiles)</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineplus">+  if (aRemoveFiles)</span>
<a href="#l14.33"></a><span id="l14.33">   {</span>
<a href="#l14.34"></a><span id="l14.34">     rv = aServer-&gt;RemoveFiles();</span>
<a href="#l14.35"></a><span id="l14.35">     NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l14.36"></a><span id="l14.36">   }</span>
<a href="#l14.37"></a><span id="l14.37"> </span>
<a href="#l14.38"></a><span id="l14.38">   // now clear out the server once and for all.</span>
<a href="#l14.39"></a><span id="l14.39">   // watch out! could be scary</span>
<a href="#l14.40"></a><span id="l14.40">   aServer-&gt;ClearAllValues();</span>
<a href="#l14.41"></a><span id="l14.41" class="difflineat">@@ -626,17 +626,18 @@ nsMsgAccountManager::removeListenersFrom</span>
<a href="#l14.42"></a><span id="l14.42">   nsTObserverArray&lt;nsCOMPtr&lt;nsIFolderListener&gt; &gt;::ForwardIterator iter(mFolderListeners);</span>
<a href="#l14.43"></a><span id="l14.43">   while (iter.HasMore())</span>
<a href="#l14.44"></a><span id="l14.44">   {</span>
<a href="#l14.45"></a><span id="l14.45">     aFolder-&gt;RemoveFolderListener(iter.GetNext());</span>
<a href="#l14.46"></a><span id="l14.46">   }</span>
<a href="#l14.47"></a><span id="l14.47"> }</span>
<a href="#l14.48"></a><span id="l14.48"> </span>
<a href="#l14.49"></a><span id="l14.49"> NS_IMETHODIMP</span>
<a href="#l14.50"></a><span id="l14.50" class="difflineminus">-nsMsgAccountManager::RemoveAccount(nsIMsgAccount *aAccount)</span>
<a href="#l14.51"></a><span id="l14.51" class="difflineplus">+nsMsgAccountManager::RemoveAccount(nsIMsgAccount *aAccount,</span>
<a href="#l14.52"></a><span id="l14.52" class="difflineplus">+                                   bool aRemoveFiles = false)</span>
<a href="#l14.53"></a><span id="l14.53"> {</span>
<a href="#l14.54"></a><span id="l14.54">   NS_ENSURE_ARG_POINTER(aAccount);</span>
<a href="#l14.55"></a><span id="l14.55">   nsresult rv = LoadAccounts();</span>
<a href="#l14.56"></a><span id="l14.56">   NS_ENSURE_SUCCESS(rv, rv);</span>
<a href="#l14.57"></a><span id="l14.57"> </span>
<a href="#l14.58"></a><span id="l14.58">   bool accountRemoved = m_accounts.RemoveElement(aAccount);</span>
<a href="#l14.59"></a><span id="l14.59"> </span>
<a href="#l14.60"></a><span id="l14.60">   rv  = OutputAccountsPref();</span>
<a href="#l14.61"></a><span id="l14.61" class="difflineat">@@ -652,17 +653,17 @@ nsMsgAccountManager::RemoveAccount(nsIMs</span>
<a href="#l14.62"></a><span id="l14.62">     SetDefaultAccount(nullptr);</span>
<a href="#l14.63"></a><span id="l14.63"> </span>
<a href="#l14.64"></a><span id="l14.64">   // XXX - need to figure out if this is the last time this server is</span>
<a href="#l14.65"></a><span id="l14.65">   // being used, and only send notification then.</span>
<a href="#l14.66"></a><span id="l14.66">   // (and only remove from hashtable then too!)</span>
<a href="#l14.67"></a><span id="l14.67">   nsCOMPtr&lt;nsIMsgIncomingServer&gt; server;</span>
<a href="#l14.68"></a><span id="l14.68">   rv = aAccount-&gt;GetIncomingServer(getter_AddRefs(server));</span>
<a href="#l14.69"></a><span id="l14.69">   if (NS_SUCCEEDED(rv) &amp;&amp; server)</span>
<a href="#l14.70"></a><span id="l14.70" class="difflineminus">-    RemoveIncomingServer(server, false);</span>
<a href="#l14.71"></a><span id="l14.71" class="difflineplus">+    RemoveIncomingServer(server, aRemoveFiles);</span>
<a href="#l14.72"></a><span id="l14.72"> </span>
<a href="#l14.73"></a><span id="l14.73">   nsCOMPtr&lt;nsIArray&gt; identityArray;</span>
<a href="#l14.74"></a><span id="l14.74">   rv = aAccount-&gt;GetIdentities(getter_AddRefs(identityArray));</span>
<a href="#l14.75"></a><span id="l14.75">   if (NS_SUCCEEDED(rv)) {</span>
<a href="#l14.76"></a><span id="l14.76">     uint32_t count = 0;</span>
<a href="#l14.77"></a><span id="l14.77">     identityArray-&gt;GetLength(&amp;count);</span>
<a href="#l14.78"></a><span id="l14.78">     uint32_t i;</span>
<a href="#l14.79"></a><span id="l14.79">     for (i = 0; i &lt; count; i++)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/mailnews/base/util/nsMsgIncomingServer.cpp</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/mailnews/base/util/nsMsgIncomingServer.cpp</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -1025,21 +1025,17 @@ nsMsgIncomingServer::ClearAllValues()</span>
<a href="#l15.4"></a><span id="l15.4"> </span>
<a href="#l15.5"></a><span id="l15.5">   return mPrefBranch-&gt;DeleteBranch(&quot;&quot;);</span>
<a href="#l15.6"></a><span id="l15.6"> }</span>
<a href="#l15.7"></a><span id="l15.7"> </span>
<a href="#l15.8"></a><span id="l15.8"> NS_IMETHODIMP</span>
<a href="#l15.9"></a><span id="l15.9"> nsMsgIncomingServer::RemoveFiles()</span>
<a href="#l15.10"></a><span id="l15.10"> {</span>
<a href="#l15.11"></a><span id="l15.11">   // IMPORTANT, see bug #77652</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-  // don't turn this code on yet.  we don't inform the user that</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineminus">-  // we are going to be deleting the directory, and they might have</span>
<a href="#l15.14"></a><span id="l15.14" class="difflineminus">-  // tweaked their localPath pref for this server to point to</span>
<a href="#l15.15"></a><span id="l15.15" class="difflineminus">-  // somewhere they didn't want deleted.</span>
<a href="#l15.16"></a><span id="l15.16" class="difflineminus">-  // until we tell them, we shouldn't do the delete.</span>
<a href="#l15.17"></a><span id="l15.17" class="difflineplus">+  // TODO: Decide what to do for deferred accounts.</span>
<a href="#l15.18"></a><span id="l15.18">   nsCString deferredToAccount;</span>
<a href="#l15.19"></a><span id="l15.19">   GetCharValue(&quot;deferred_to_account&quot;, deferredToAccount);</span>
<a href="#l15.20"></a><span id="l15.20">   bool isDeferredTo = true;</span>
<a href="#l15.21"></a><span id="l15.21">   GetIsDeferredTo(&amp;isDeferredTo);</span>
<a href="#l15.22"></a><span id="l15.22">   if (!deferredToAccount.IsEmpty() || isDeferredTo)</span>
<a href="#l15.23"></a><span id="l15.23">   {</span>
<a href="#l15.24"></a><span id="l15.24">     NS_ASSERTION(false, &quot;shouldn't remove files for a deferred account&quot;);</span>
<a href="#l15.25"></a><span id="l15.25">     return NS_ERROR_FAILURE;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/mailnews/jar.mn</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/mailnews/jar.mn</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -58,16 +58,18 @@ messenger.jar:</span>
<a href="#l16.4"></a><span id="l16.4">     content/messenger/aw-done.js                                               (base/prefs/content/aw-done.js)</span>
<a href="#l16.5"></a><span id="l16.5">     content/messenger/accountUtils.js                                          (base/prefs/content/accountUtils.js)</span>
<a href="#l16.6"></a><span id="l16.6">     content/messenger/amUtils.js                                               (base/prefs/content/amUtils.js)</span>
<a href="#l16.7"></a><span id="l16.7">     content/messenger/ispUtils.js                                              (base/prefs/content/ispUtils.js)</span>
<a href="#l16.8"></a><span id="l16.8">     content/messenger/SmtpServerEdit.xul                                       (base/prefs/content/SmtpServerEdit.xul)</span>
<a href="#l16.9"></a><span id="l16.9">     content/messenger/SmtpServerEdit.js                                        (base/prefs/content/SmtpServerEdit.js)</span>
<a href="#l16.10"></a><span id="l16.10">     content/messenger/smtpEditOverlay.xul                                      (base/prefs/content/smtpEditOverlay.xul)</span>
<a href="#l16.11"></a><span id="l16.11">     content/messenger/smtpEditOverlay.js                                       (base/prefs/content/smtpEditOverlay.js)</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineplus">+    content/messenger/removeAccount.xul                                        (base/prefs/content/removeAccount.xul)</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+    content/messenger/removeAccount.js                                         (base/prefs/content/removeAccount.js)</span>
<a href="#l16.14"></a><span id="l16.14"> #ifdef MOZ_THUNDERBIRD</span>
<a href="#l16.15"></a><span id="l16.15">     content/messenger/accountcreation/accountConfig.js                         (base/prefs/content/accountcreation/accountConfig.js)</span>
<a href="#l16.16"></a><span id="l16.16">     content/messenger/accountcreation/createInBackend.js                       (base/prefs/content/accountcreation/createInBackend.js)</span>
<a href="#l16.17"></a><span id="l16.17">     content/messenger/accountcreation/emailWizard.js                           (base/prefs/content/accountcreation/emailWizard.js)</span>
<a href="#l16.18"></a><span id="l16.18">     content/messenger/accountcreation/emailWizard.xul                          (base/prefs/content/accountcreation/emailWizard.xul)</span>
<a href="#l16.19"></a><span id="l16.19">     content/messenger/accountcreation/fetchConfig.js                           (base/prefs/content/accountcreation/fetchConfig.js)</span>
<a href="#l16.20"></a><span id="l16.20">     content/messenger/accountcreation/fetchhttp.js                             (base/prefs/content/accountcreation/fetchhttp.js)</span>
<a href="#l16.21"></a><span id="l16.21">     content/messenger/accountcreation/guessConfig.js                           (base/prefs/content/accountcreation/guessConfig.js)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/mailnews/test/resources/messageInjection.js</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/mailnews/test/resources/messageInjection.js</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -566,17 +566,17 @@ var make_new_sets_in_folder = make_new_s</span>
<a href="#l17.4"></a><span id="l17.4"> </span>
<a href="#l17.5"></a><span id="l17.5"> /**</span>
<a href="#l17.6"></a><span id="l17.6">  * An iterator that generates an infinite sequence of its argument.  So</span>
<a href="#l17.7"></a><span id="l17.7">  *  _looperator(1, 2, 3) will generate the iteration stream: [1, 2, 3, 1, 2, 3,</span>
<a href="#l17.8"></a><span id="l17.8">  *  1, 2, 3, ...].  For use by add_sets_across_folders.</span>
<a href="#l17.9"></a><span id="l17.9">  */</span>
<a href="#l17.10"></a><span id="l17.10"> function* _looperator(aList) {</span>
<a href="#l17.11"></a><span id="l17.11">   if (aList.length == 0)</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-    throw Exception(&quot;aList must have at least one item!&quot;);</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+    throw new Exception(&quot;aList must have at least one item!&quot;);</span>
<a href="#l17.14"></a><span id="l17.14"> </span>
<a href="#l17.15"></a><span id="l17.15">   let i = 0, length = aList.length;</span>
<a href="#l17.16"></a><span id="l17.16">   while (true) {</span>
<a href="#l17.17"></a><span id="l17.17">     yield aList[i];</span>
<a href="#l17.18"></a><span id="l17.18">     i = (i + 1) % length;</span>
<a href="#l17.19"></a><span id="l17.19">   }</span>
<a href="#l17.20"></a><span id="l17.20"> }</span>
<a href="#l17.21"></a><span id="l17.21"> </span>
<a href="#l17.22"></a><span id="l17.22" class="difflineat">@@ -624,17 +624,17 @@ function add_sets_to_folders(aMsgFolders</span>
<a href="#l17.23"></a><span id="l17.23">   let popMessages, msgHdrs;</span>
<a href="#l17.24"></a><span id="l17.24"> </span>
<a href="#l17.25"></a><span id="l17.25">   _messageInjectionSetup.notifyListeners(&quot;onInjectingMessages&quot;, []);</span>
<a href="#l17.26"></a><span id="l17.26"> </span>
<a href="#l17.27"></a><span id="l17.27">   // -- Pre-loop</span>
<a href="#l17.28"></a><span id="l17.28">   if (mis.injectionConfig.mode == &quot;local&quot;) {</span>
<a href="#l17.29"></a><span id="l17.29">     for (let folder of aMsgFolders) {</span>
<a href="#l17.30"></a><span id="l17.30">       if (!(folder instanceof Components.interfaces.nsIMsgLocalMailFolder))</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineminus">-        throw Exception(&quot;All folders in aMsgFolders must be local folders!&quot;);</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineplus">+        throw new Exception(&quot;All folders in aMsgFolders must be local folders!&quot;);</span>
<a href="#l17.33"></a><span id="l17.33">     }</span>
<a href="#l17.34"></a><span id="l17.34">     folderList = aMsgFolders;</span>
<a href="#l17.35"></a><span id="l17.35">   }</span>
<a href="#l17.36"></a><span id="l17.36">   else if (mis.injectionConfig.mode == &quot;imap&quot;) {</span>
<a href="#l17.37"></a><span id="l17.37">     // no protection is possible because of our dependency on promises,</span>
<a href="#l17.38"></a><span id="l17.38">     //  although we could check that the fake URL is one we handed out.</span>
<a href="#l17.39"></a><span id="l17.39">     folderList = aMsgFolders;</span>
<a href="#l17.40"></a><span id="l17.40">   }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/suite/locales/en-US/chrome/mailnews/pref/prefs.properties</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/suite/locales/en-US/chrome/mailnews/pref/prefs.properties</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -26,19 +26,16 @@ localDirectoryNotAllowed=The Local Direc</span>
<a href="#l18.4"></a><span id="l18.4"> # do not localize &quot;\n\n&quot;</span>
<a href="#l18.5"></a><span id="l18.5"> cancelWizard=Are you sure you want to exit the Account Wizard?\n\nIf you exit, any information you have entered will be lost and the account will not be created.</span>
<a href="#l18.6"></a><span id="l18.6"> accountWizard=Account Wizard</span>
<a href="#l18.7"></a><span id="l18.7"> WizardExit=Exit</span>
<a href="#l18.8"></a><span id="l18.8"> WizardContinue=Cancel</span>
<a href="#l18.9"></a><span id="l18.9"> # when the wizard already has a domain (Should we say something different?)</span>
<a href="#l18.10"></a><span id="l18.10"> enterValidServerName=Please enter a valid server name.</span>
<a href="#l18.11"></a><span id="l18.11"> failedRemoveAccount=Failed to remove this account.</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-#LOCALIZATION NOTE: confirmRemoveAccount: %S is the account pretty name</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineminus">-confirmRemoveAccount=Are you sure you want to remove the account &quot;%S&quot;?</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineminus">-confirmRemoveAccountTitle=Remove Account</span>
<a href="#l18.15"></a><span id="l18.15"> #LOCALIZATION NOTE: accountName: %1$S is server name, %2$S is user name</span>
<a href="#l18.16"></a><span id="l18.16"> accountName=%1$S - %2$S</span>
<a href="#l18.17"></a><span id="l18.17"> </span>
<a href="#l18.18"></a><span id="l18.18"> # LOCALIZATION NOTE: confirmDeferAccountWarning: do not localize &quot;\n\n&quot;, it means a new empty line in the string.</span>
<a href="#l18.19"></a><span id="l18.19"> confirmDeferAccountWarning=If you store this account's new mail in a different account's Inbox, you will no longer be able to access already downloaded e-mail for this account. If you have mail in this account, please copy it to another account first.\n\nIf you have filters that filter mail into this account, you should disable them or change the destination folder. If any accounts have special folders in this account (Sent, Drafts, Templates, Archives, Junk), you should change them to be in another account.\n\nDo you still want to store this account's e-mail in a different account?</span>
<a href="#l18.20"></a><span id="l18.20"> confirmDeferAccountTitle=Defer Account?</span>
<a href="#l18.21"></a><span id="l18.21"> </span>
<a href="#l18.22"></a><span id="l18.22"> directoryAlreadyUsedByOtherAccount=The directory specified in the Local Directory setting is already used by the &quot;%S&quot; account. Please pick a different directory.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1">new file mode 100644</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineminus">--- /dev/null</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineplus">+++ b/suite/locales/en-US/chrome/mailnews/pref/removeAccount.dtd</span>
<a href="#l19.4"></a><span id="l19.4" class="difflineat">@@ -0,0 +1,19 @@</span>
<a href="#l19.5"></a><span id="l19.5" class="difflineplus">+&lt;!-- This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l19.6"></a><span id="l19.6" class="difflineplus">+   - License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l19.7"></a><span id="l19.7" class="difflineplus">+   - file, You can obtain one at http://mozilla.org/MPL/2.0/. --&gt;</span>
<a href="#l19.8"></a><span id="l19.8" class="difflineplus">+</span>
<a href="#l19.9"></a><span id="l19.9" class="difflineplus">+&lt;!ENTITY dialogTitle                  &quot;Remove Account and Data&quot;&gt;</span>
<a href="#l19.10"></a><span id="l19.10" class="difflineplus">+&lt;!ENTITY removeButton.label           &quot;Remove&quot;&gt;</span>
<a href="#l19.11"></a><span id="l19.11" class="difflineplus">+&lt;!ENTITY removeButton.accesskey       &quot;R&quot;&gt;</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineplus">+&lt;!ENTITY removeAccount.label          &quot;Remove account information&quot;&gt;</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+&lt;!ENTITY removeAccount.accesskey      &quot;a&quot;&gt;</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineplus">+&lt;!ENTITY removeAccount.desc           &quot;Removes only &amp;brandShortName;'s knowledge of this account. Does not affect the account itself on the server.&quot;&gt;</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineplus">+&lt;!ENTITY removeData.label             &quot;Remove message data&quot;&gt;</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineplus">+&lt;!ENTITY removeData.accesskey         &quot;d&quot;&gt;</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineplus">+&lt;!ENTITY removeDataLocalAccount.desc  &quot;Removes all messages, folders and filters associated with this account from your local disk. This does not affect some messages which may still be kept on the server. Do not choose this if you plan to archive the local data or re-use it in &amp;brandShortName; later.&quot;&gt;</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineplus">+&lt;!ENTITY removeDataServerAccount.desc &quot;Removes all messages, folders and filters associated with this account from your local disk. Your messages and folders are still kept on the server.&quot;&gt;</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineplus">+&lt;!ENTITY showData.label               &quot;Show data location&quot;&gt;</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineplus">+&lt;!ENTITY showData.accesskey           &quot;S&quot;&gt;</span>
<a href="#l19.21"></a><span id="l19.21" class="difflineplus">+&lt;!ENTITY progressPending              &quot;Removing selected data…&quot;&gt;</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineplus">+&lt;!ENTITY progressSuccess              &quot;Removal succeeded.&quot;&gt;</span>
<a href="#l19.23"></a><span id="l19.23" class="difflineplus">+&lt;!ENTITY progressFailure              &quot;Removal failed.&quot;&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1">new file mode 100644</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineminus">--- /dev/null</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineplus">+++ b/suite/locales/en-US/chrome/mailnews/pref/removeAccount.properties</span>
<a href="#l20.4"></a><span id="l20.4" class="difflineat">@@ -0,0 +1,5 @@</span>
<a href="#l20.5"></a><span id="l20.5" class="difflineplus">+# This Source Code Form is subject to the terms of the Mozilla Public</span>
<a href="#l20.6"></a><span id="l20.6" class="difflineplus">+# License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a href="#l20.7"></a><span id="l20.7" class="difflineplus">+# file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a href="#l20.8"></a><span id="l20.8" class="difflineplus">+</span>
<a href="#l20.9"></a><span id="l20.9" class="difflineplus">+removeQuestion=Are you sure you want to remove the account &quot;%S&quot;?</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/suite/locales/jar.mn</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/suite/locales/jar.mn</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -247,16 +247,18 @@</span>
<a href="#l21.4"></a><span id="l21.4">   locale/@AB_CD@/messenger/am-main.dtd                                      (%chrome/mailnews/pref/am-main.dtd)</span>
<a href="#l21.5"></a><span id="l21.5">   locale/@AB_CD@/messenger/am-mdn.dtd                                       (%chrome/mailnews/pref/am-mdn.dtd)</span>
<a href="#l21.6"></a><span id="l21.6">   locale/@AB_CD@/messenger/am-mdn.properties                                (%chrome/mailnews/pref/am-mdn.properties)</span>
<a href="#l21.7"></a><span id="l21.7">   locale/@AB_CD@/messenger/am-offline.dtd                                   (%chrome/mailnews/pref/am-offline.dtd)</span>
<a href="#l21.8"></a><span id="l21.8">   locale/@AB_CD@/messenger/am-serverwithnoidentities.dtd                    (%chrome/mailnews/pref/am-serverwithnoidentities.dtd)</span>
<a href="#l21.9"></a><span id="l21.9">   locale/@AB_CD@/messenger/am-server-advanced.dtd                           (%chrome/mailnews/pref/am-server-advanced.dtd)</span>
<a href="#l21.10"></a><span id="l21.10">   locale/@AB_CD@/messenger/am-server-top.dtd                                (%chrome/mailnews/pref/am-server-top.dtd)</span>
<a href="#l21.11"></a><span id="l21.11">   locale/@AB_CD@/messenger/am-archiveoptions.dtd                            (%chrome/mailnews/pref/am-archiveoptions.dtd)</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineplus">+  locale/@AB_CD@/messenger/removeAccount.dtd                                (%chrome/mailnews/pref/removeAccount.dtd)</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+  locale/@AB_CD@/messenger/removeAccount.properties                         (%chrome/mailnews/pref/removeAccount.properties)</span>
<a href="#l21.14"></a><span id="l21.14">   locale/@AB_CD@/messenger/appleMailImportMsgs.properties                   (%chrome/mailnews/appleMailImportMsgs.properties)</span>
<a href="#l21.15"></a><span id="l21.15">   locale/@AB_CD@/messenger/beckyImportMsgs.properties                       (%chrome/mailnews/beckyImportMsgs.properties)</span>
<a href="#l21.16"></a><span id="l21.16">   locale/@AB_CD@/messenger/charsetTitles.properties                         (%chrome/mailnews/charsetTitles.properties)</span>
<a href="#l21.17"></a><span id="l21.17">   locale/@AB_CD@/messenger/custom.properties                                (%chrome/mailnews/custom.properties)</span>
<a href="#l21.18"></a><span id="l21.18">   locale/@AB_CD@/messenger/CustomHeaders.dtd                                (%chrome/mailnews/CustomHeaders.dtd)</span>
<a href="#l21.19"></a><span id="l21.19">   locale/@AB_CD@/messenger/downloadheaders.dtd                              (%chrome/mailnews/downloadheaders.dtd)</span>
<a href="#l21.20"></a><span id="l21.20">   locale/@AB_CD@/messenger/fieldMapImport.dtd                               (%chrome/mailnews/fieldMapImport.dtd)</span>
<a href="#l21.21"></a><span id="l21.21">   locale/@AB_CD@/messenger/filter.properties                                (%chrome/mailnews/filter.properties)</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

