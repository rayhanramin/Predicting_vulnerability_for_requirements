<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 1802:125c3a73ab463b369716dcdec58df67ef420fe0d</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 125c3a73ab463b369716dcdec58df67ef420fe0d" />
<meta property="og:url" content="/comm-central/rev/125c3a73ab463b369716dcdec58df67ef420fe0d" />
<meta property="og:description" content="Fix (part of) bug 353492 - support multiple alarms per events/task, support absolute alarms with fixed date/time - Frontend patch, r=berend" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 125c3a73ab463b369716dcdec58df67ef420fe0d 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/125c3a73ab463b369716dcdec58df67ef420fe0d">shortlog</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/125c3a73ab463b369716dcdec58df67ef420fe0d">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d">files</a> |
changeset |
<a href="/comm-central/raw-rev/125c3a73ab463b369716dcdec58df67ef420fe0d">raw</a>  | <a href="/comm-central/archive/125c3a73ab463b369716dcdec58df67ef420fe0d.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
Fix (part of) <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=353492">bug 353492</a> - support multiple alarms per events/task, support absolute alarms with fixed date/time - Frontend patch, r=berend
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#80;&#104;&#105;&#108;&#105;&#112;&#112;&#32;&#75;&#101;&#119;&#105;&#115;&#99;&#104;&#32;&#60;&#109;&#111;&#122;&#105;&#108;&#108;&#97;&#64;&#107;&#101;&#119;&#105;&#115;&#46;&#99;&#104;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 30 Jan 2009 17:01:19 +0100</td></tr>

<tr>
 <td>changeset 1802</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/125c3a73ab463b369716dcdec58df67ef420fe0d">125c3a73ab463b369716dcdec58df67ef420fe0d</a></td>
</tr>



<tr>
<td>parent 1801</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/9d574eae525edfac3a5068d5453ac5b4c65aa31b">9d574eae525edfac3a5068d5453ac5b4c65aa31b</a>
</td>
</tr>

<tr>
<td>child 1803</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/f651a179b304c1d5a82ed657b174be90fcc1036f">f651a179b304c1d5a82ed657b174be90fcc1036f</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=125c3a73ab463b369716dcdec58df67ef420fe0d">1452</a></td></tr>
<tr><td>push user</td><td>mozilla@kewis.ch</td></tr>
<tr><td>push date</td><td class="date age">Fri, 30 Jan 2009 16:01:49 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@125c3a73ab46 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=125c3a73ab463b369716dcdec58df67ef420fe0d">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=125c3a73ab463b369716dcdec58df67ef420fe0d&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=125c3a73ab463b369716dcdec58df67ef420fe0d&newProject=comm-central&newRevision=9d574eae525edfac3a5068d5453ac5b4c65aa31b&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=125c3a73ab463b369716dcdec58df67ef420fe0d&newProject=comm-central&newRevision=9d574eae525edfac3a5068d5453ac5b4c65aa31b&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=125c3a73ab463b369716dcdec58df67ef420fe0d&newProject=comm-central&newRevision=9d574eae525edfac3a5068d5453ac5b4c65aa31b&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28berend%29&revcount=50">berend</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=353492">353492</a></td></tr>




</table></div>

<div class="page_body description">Fix (part of) <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=353492">bug 353492</a> - support multiple alarms per events/task, support absolute alarms with fixed date/time - Frontend patch, r=berend</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-base-view.xml">calendar/base/content/calendar-base-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-base-view.xml">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-base-view.xml">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-base-view.xml">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-base-view.xml">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-base-view.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-dialog-utils.js">calendar/base/content/calendar-dialog-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-dialog-utils.js">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-dialog-utils.js">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-dialog-utils.js">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-dialog-utils.js">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-dialog-utils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-month-view.xml">calendar/base/content/calendar-month-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-month-view.xml">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-month-view.xml">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-month-view.xml">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-month-view.xml">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-month-view.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-multiday-view.xml">calendar/base/content/calendar-multiday-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-multiday-view.xml">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-multiday-view.xml">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-multiday-view.xml">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-multiday-view.xml">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-multiday-view.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-summary-dialog.js">calendar/base/content/calendar-summary-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-summary-dialog.js">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-summary-dialog.js">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-summary-dialog.js">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-summary-dialog.js">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-summary-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-view-core.xml">calendar/base/content/calendar-view-core.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-view-core.xml">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-view-core.xml">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-view-core.xml">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-view-core.xml">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/calendar-view-core.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">calendar/base/content/dialogs/calendar-event-dialog-reminder.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul">calendar/base/content/dialogs/calendar-event-dialog-reminder.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog.js">calendar/base/content/dialogs/calendar-event-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog.js">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog.js">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog.js">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog.js">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog.xul">calendar/base/content/dialogs/calendar-event-dialog.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog.xul">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog.xul">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog.xul">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog.xul">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/content/dialogs/calendar-event-dialog.xul">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/jar.mn">calendar/base/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/jar.mn">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/jar.mn">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/jar.mn">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/jar.mn">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/modules/calAlarmUtils.jsm">calendar/base/modules/calAlarmUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/modules/calAlarmUtils.jsm">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/modules/calAlarmUtils.jsm">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/modules/calAlarmUtils.jsm">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/modules/calAlarmUtils.jsm">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/modules/calAlarmUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/modules/calIteratorUtils.jsm">calendar/base/modules/calIteratorUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/modules/calIteratorUtils.jsm">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/modules/calIteratorUtils.jsm">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/modules/calIteratorUtils.jsm">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/modules/calIteratorUtils.jsm">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/modules/calIteratorUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/src/calAlarmService.js">calendar/base/src/calAlarmService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/src/calAlarmService.js">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/src/calAlarmService.js">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/src/calAlarmService.js">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/src/calAlarmService.js">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/src/calAlarmService.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/common/alarm-icons.png">calendar/base/themes/common/alarm-icons.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/common/alarm-icons.png">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/common/alarm-icons.png">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/common/alarm-icons.png">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/common/alarm-icons.png">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/common/alarm-icons.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/common/alarm-suppressed.png">calendar/base/themes/common/alarm-suppressed.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/common/alarm-suppressed.png">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/common/alarm-suppressed.png">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/common/alarm-suppressed.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/common/alarm.png">calendar/base/themes/common/alarm.png</a></td>
<td></td>
<td class="link">
file |
annotate |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/common/alarm.png">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/common/alarm.png">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/common/alarm.png">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/pinstripe/calendar-alarms.css">calendar/base/themes/pinstripe/calendar-alarms.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/pinstripe/calendar-alarms.css">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/pinstripe/calendar-alarms.css">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/pinstripe/calendar-alarms.css">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/pinstripe/calendar-alarms.css">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/pinstripe/calendar-alarms.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/pinstripe/calendar-views.css">calendar/base/themes/pinstripe/calendar-views.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/pinstripe/calendar-views.css">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/pinstripe/calendar-views.css">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/pinstripe/calendar-views.css">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/pinstripe/calendar-views.css">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/pinstripe/calendar-views.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/winstripe/calendar-alarms.css">calendar/base/themes/winstripe/calendar-alarms.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/winstripe/calendar-alarms.css">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/winstripe/calendar-alarms.css">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/winstripe/calendar-alarms.css">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/winstripe/calendar-alarms.css">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/winstripe/calendar-alarms.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/winstripe/calendar-views.css">calendar/base/themes/winstripe/calendar-views.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/winstripe/calendar-views.css">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/winstripe/calendar-views.css">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/winstripe/calendar-views.css">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/winstripe/calendar-views.css">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/base/themes/winstripe/calendar-views.css">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/import-export/calOutlookCSVImportExport.js">calendar/import-export/calOutlookCSVImportExport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/import-export/calOutlookCSVImportExport.js">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/import-export/calOutlookCSVImportExport.js">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/import-export/calOutlookCSVImportExport.js">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/import-export/calOutlookCSVImportExport.js">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/import-export/calOutlookCSVImportExport.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-alarms.properties">calendar/locales/en-US/chrome/calendar/calendar-alarms.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-alarms.properties">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-alarms.properties">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-alarms.properties">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-alarms.properties">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-alarms.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.dtd">calendar/locales/en-US/chrome/calendar/calendar-event-dialog.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.dtd">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.dtd">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.dtd">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.dtd">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.properties">calendar/locales/en-US/chrome/calendar/calendar-event-dialog.properties</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.properties">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.properties">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.properties">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.properties">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.properties">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/dialogs/calendar-event-dialog-reminder.dtd">calendar/locales/en-US/chrome/calendar/dialogs/calendar-event-dialog-reminder.dtd</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/dialogs/calendar-event-dialog-reminder.dtd">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/dialogs/calendar-event-dialog-reminder.dtd">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/dialogs/calendar-event-dialog-reminder.dtd">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/dialogs/calendar-event-dialog-reminder.dtd">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/en-US/chrome/calendar/dialogs/calendar-event-dialog-reminder.dtd">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/jar.mn">calendar/locales/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/jar.mn">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/jar.mn">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/jar.mn">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/jar.mn">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/locales/jar.mn">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/components/calGoogleCalendar.js">calendar/providers/gdata/components/calGoogleCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/components/calGoogleCalendar.js">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/components/calGoogleCalendar.js">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/components/calGoogleCalendar.js">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/components/calGoogleCalendar.js">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/components/calGoogleCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-calendar-event-dialog.xul">calendar/providers/gdata/content/gdata-calendar-event-dialog.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-calendar-event-dialog.xul">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-calendar-event-dialog.xul">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-calendar-event-dialog.xul">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-calendar-event-dialog.xul">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-calendar-event-dialog.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-event-dialog-reminder.css">calendar/providers/gdata/content/gdata-event-dialog-reminder.css</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-event-dialog-reminder.css">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-event-dialog-reminder.css">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-event-dialog-reminder.css">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-event-dialog-reminder.css">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-event-dialog-reminder.css">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-event-dialog-reminder.xul">calendar/providers/gdata/content/gdata-event-dialog-reminder.xul</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-event-dialog-reminder.xul">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-event-dialog-reminder.xul">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-event-dialog-reminder.xul">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-event-dialog-reminder.xul">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/gdata-event-dialog-reminder.xul">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/reminder-action-sms.png">calendar/providers/gdata/content/reminder-action-sms.png</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/reminder-action-sms.png">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/reminder-action-sms.png">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/reminder-action-sms.png">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/reminder-action-sms.png">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/content/reminder-action-sms.png">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/install.rdf">calendar/providers/gdata/install.rdf</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/install.rdf">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/install.rdf">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/install.rdf">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/install.rdf">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/install.rdf">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/jar.mn">calendar/providers/gdata/jar.mn</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/jar.mn">file</a> |
<a href="/comm-central/annotate/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/jar.mn">annotate</a> |
<a href="/comm-central/diff/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/jar.mn">diff</a> |
<a href="/comm-central/comparison/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/jar.mn">comparison</a> |
<a href="/comm-central/log/125c3a73ab463b369716dcdec58df67ef420fe0d/calendar/providers/gdata/jar.mn">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/base/content/calendar-base-view.xml</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/base/content/calendar-base-view.xml</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -39,16 +39,19 @@</span>
<a href="#l1.4"></a><span id="l1.4"> </span>
<a href="#l1.5"></a><span id="l1.5"> &lt;bindings id=&quot;calendar-multiday-view-bindings&quot;</span>
<a href="#l1.6"></a><span id="l1.6">   xmlns=&quot;http://www.mozilla.org/xbl&quot;</span>
<a href="#l1.7"></a><span id="l1.7">   xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<a href="#l1.8"></a><span id="l1.8">   xmlns:xul=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;</span>
<a href="#l1.9"></a><span id="l1.9">   xmlns:xbl=&quot;http://www.mozilla.org/xbl&quot;&gt;</span>
<a href="#l1.10"></a><span id="l1.10"> </span>
<a href="#l1.11"></a><span id="l1.11">   &lt;binding id=&quot;calendar-base-view&quot;&gt;</span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+    &lt;resources&gt;</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+      &lt;stylesheet src=&quot;chrome://calendar/skin/calendar-alarms.css&quot;/&gt;</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+    &lt;/resources&gt;</span>
<a href="#l1.15"></a><span id="l1.15">     &lt;implementation&gt;</span>
<a href="#l1.16"></a><span id="l1.16">       &lt;field name=&quot;mWeekStartOffset&quot;&gt;0&lt;/field&gt;</span>
<a href="#l1.17"></a><span id="l1.17">       &lt;field name=&quot;mRangeStartDate&quot;&gt;null&lt;/field&gt;;</span>
<a href="#l1.18"></a><span id="l1.18">       &lt;field name=&quot;mRangeEndDate&quot;&gt;null&lt;/field&gt;;</span>
<a href="#l1.19"></a><span id="l1.19">       &lt;field name=&quot;mWorkdaysOnly&quot;&gt;false&lt;/field&gt;</span>
<a href="#l1.20"></a><span id="l1.20">       &lt;field name=&quot;mRefreshQueue&quot;&gt;[]&lt;/field&gt;</span>
<a href="#l1.21"></a><span id="l1.21">       &lt;field name=&quot;mRefreshPending&quot;&gt;null&lt;/field&gt;</span>
<a href="#l1.22"></a><span id="l1.22">       &lt;field name=&quot;mCalendar&quot;&gt;null&lt;/field&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/content/calendar-dialog-utils.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/content/calendar-dialog-utils.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -35,16 +35,19 @@</span>
<a href="#l2.4"></a><span id="l2.4">  * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l2.5"></a><span id="l2.5">  * the provisions above, a recipient may use your version of this file under</span>
<a href="#l2.6"></a><span id="l2.6">  * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l2.7"></a><span id="l2.7">  *</span>
<a href="#l2.8"></a><span id="l2.8">  * ***** END LICENSE BLOCK ***** */</span>
<a href="#l2.9"></a><span id="l2.9"> </span>
<a href="#l2.10"></a><span id="l2.10"> Components.utils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l2.11"></a><span id="l2.11"> </span>
<a href="#l2.12"></a><span id="l2.12" class="difflineplus">+Components.utils.import(&quot;resource://calendar/modules/calAlarmUtils.jsm&quot;);</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+Components.utils.import(&quot;resource://calendar/modules/calIteratorUtils.jsm&quot;);</span>
<a href="#l2.14"></a><span id="l2.14" class="difflineplus">+</span>
<a href="#l2.15"></a><span id="l2.15"> /**</span>
<a href="#l2.16"></a><span id="l2.16">  * This function takes the recurrence info passed as argument and creates a</span>
<a href="#l2.17"></a><span id="l2.17">  * literal string representing the repeat pattern in natural language.</span>
<a href="#l2.18"></a><span id="l2.18">  *</span>
<a href="#l2.19"></a><span id="l2.19">  * @param recurrenceInfo    An item's recurrence info to parse.</span>
<a href="#l2.20"></a><span id="l2.20">  * @param startDate         The start date to base rules on.</span>
<a href="#l2.21"></a><span id="l2.21">  * @param endDate           The end date to base rules on.</span>
<a href="#l2.22"></a><span id="l2.22">  * @param allDay            If true, the pattern should assume an allday item.</span>
<a href="#l2.23"></a><span id="l2.23" class="difflineat">@@ -338,27 +341,41 @@ function checkRecurrenceRule(aRule, aArr</span>
<a href="#l2.24"></a><span id="l2.24"> function dispose() {</span>
<a href="#l2.25"></a><span id="l2.25">     var args = window.arguments[0];</span>
<a href="#l2.26"></a><span id="l2.26">     if (args.job &amp;&amp; args.job.dispose) {</span>
<a href="#l2.27"></a><span id="l2.27">         args.job.dispose();</span>
<a href="#l2.28"></a><span id="l2.28">     }</span>
<a href="#l2.29"></a><span id="l2.29"> }</span>
<a href="#l2.30"></a><span id="l2.30"> </span>
<a href="#l2.31"></a><span id="l2.31"> /**</span>
<a href="#l2.32"></a><span id="l2.32" class="difflineminus">- * Opens the edit reminder dialog modally, setting the custom menuitem's</span>
<a href="#l2.33"></a><span id="l2.33" class="difflineminus">- * 'reminder' property when done.</span>
<a href="#l2.34"></a><span id="l2.34" class="difflineplus">+ * This function opens the needed dialogs to edit the reminder. Note however</span>
<a href="#l2.35"></a><span id="l2.35" class="difflineplus">+ * that calling this function from an extension is not recommended. To allow an</span>
<a href="#l2.36"></a><span id="l2.36" class="difflineplus">+ * extension to open the reminder dialog, set the menulist &quot;item-alarm&quot; to the</span>
<a href="#l2.37"></a><span id="l2.37" class="difflineplus">+ * custom menuitem and call updateReminder().</span>
<a href="#l2.38"></a><span id="l2.38">  */</span>
<a href="#l2.39"></a><span id="l2.39"> function editReminder() {</span>
<a href="#l2.40"></a><span id="l2.40" class="difflineminus">-    var customReminder =</span>
<a href="#l2.41"></a><span id="l2.41" class="difflineminus">-        document.getElementById(&quot;reminder-custom-menuitem&quot;);</span>
<a href="#l2.42"></a><span id="l2.42" class="difflineminus">-    var args = new Object();</span>
<a href="#l2.43"></a><span id="l2.43" class="difflineminus">-    args.reminder = customReminder.reminder;</span>
<a href="#l2.44"></a><span id="l2.44" class="difflineminus">-    var savedWindow = window;</span>
<a href="#l2.45"></a><span id="l2.45" class="difflineminus">-    args.onOk = function(reminder) {</span>
<a href="#l2.46"></a><span id="l2.46" class="difflineminus">-        customReminder.reminder = reminder;</span>
<a href="#l2.47"></a><span id="l2.47" class="difflineplus">+    let customItem =  document.getElementById(&quot;reminder-custom-menuitem&quot;);</span>
<a href="#l2.48"></a><span id="l2.48" class="difflineplus">+    let args = {};</span>
<a href="#l2.49"></a><span id="l2.49" class="difflineplus">+    args.reminders = customItem.reminders;</span>
<a href="#l2.50"></a><span id="l2.50" class="difflineplus">+    args.item = window.calendarItem;</span>
<a href="#l2.51"></a><span id="l2.51" class="difflineplus">+    args.timezone = gStartTimezone || gEndTimezone;</span>
<a href="#l2.52"></a><span id="l2.52" class="difflineplus">+    </span>
<a href="#l2.53"></a><span id="l2.53" class="difflineplus">+    let calendarNode = document.getElementById(&quot;item-calendar&quot;);</span>
<a href="#l2.54"></a><span id="l2.54" class="difflineplus">+    args.calendar = (calendarNode &amp;&amp; calendarNode.selectedItem ?</span>
<a href="#l2.55"></a><span id="l2.55" class="difflineplus">+                        calendarNode.selectedItem.calendar :</span>
<a href="#l2.56"></a><span id="l2.56" class="difflineplus">+                        window.calendarItem.calendar);</span>
<a href="#l2.57"></a><span id="l2.57" class="difflineplus">+    let savedWindow = window;</span>
<a href="#l2.58"></a><span id="l2.58" class="difflineplus">+</span>
<a href="#l2.59"></a><span id="l2.59" class="difflineplus">+    // While these are &quot;just&quot; callbacks, the dialog is opened modally, so aside</span>
<a href="#l2.60"></a><span id="l2.60" class="difflineplus">+    // from whats needed to set up the reminders, nothing else needs to be done.</span>
<a href="#l2.61"></a><span id="l2.61" class="difflineplus">+    args.onOk = function(reminders) {</span>
<a href="#l2.62"></a><span id="l2.62" class="difflineplus">+        customItem.reminders = reminders;</span>
<a href="#l2.63"></a><span id="l2.63" class="difflineplus">+    };</span>
<a href="#l2.64"></a><span id="l2.64" class="difflineplus">+    args.onCancel = function() {</span>
<a href="#l2.65"></a><span id="l2.65" class="difflineplus">+        document.getElementById(&quot;item-alarm&quot;).selectedIndex = gLastAlarmSelection;</span>
<a href="#l2.66"></a><span id="l2.66">     };</span>
<a href="#l2.67"></a><span id="l2.67"> </span>
<a href="#l2.68"></a><span id="l2.68">     window.setCursor(&quot;wait&quot;);</span>
<a href="#l2.69"></a><span id="l2.69"> </span>
<a href="#l2.70"></a><span id="l2.70">     // open the dialog modally</span>
<a href="#l2.71"></a><span id="l2.71">     openDialog(</span>
<a href="#l2.72"></a><span id="l2.72">         &quot;chrome://calendar/content/calendar-event-dialog-reminder.xul&quot;,</span>
<a href="#l2.73"></a><span id="l2.73">         &quot;_blank&quot;,</span>
<a href="#l2.74"></a><span id="l2.74" class="difflineat">@@ -368,309 +385,222 @@ function editReminder() {</span>
<a href="#l2.75"></a><span id="l2.75"> </span>
<a href="#l2.76"></a><span id="l2.76"> /**</span>
<a href="#l2.77"></a><span id="l2.77">  * Update the reminder details from the selected alarm. This shows a string</span>
<a href="#l2.78"></a><span id="l2.78">  * describing the reminder set, or nothing in case a preselected reminder was</span>
<a href="#l2.79"></a><span id="l2.79">  * chosen.</span>
<a href="#l2.80"></a><span id="l2.80">  */</span>
<a href="#l2.81"></a><span id="l2.81"> function updateReminderDetails() {</span>
<a href="#l2.82"></a><span id="l2.82">     // find relevant elements in the document</span>
<a href="#l2.83"></a><span id="l2.83" class="difflineminus">-    var reminderPopup = document.getElementById(&quot;item-alarm&quot;);</span>
<a href="#l2.84"></a><span id="l2.84" class="difflineminus">-    var reminderDetails = document.getElementById(&quot;reminder-details&quot;);</span>
<a href="#l2.85"></a><span id="l2.85" class="difflineminus">-    var reminder = document.getElementById(&quot;reminder-custom-menuitem&quot;).reminder;</span>
<a href="#l2.86"></a><span id="l2.86" class="difflineminus">-</span>
<a href="#l2.87"></a><span id="l2.87" class="difflineminus">-    // first of all collapse the details text. if we fail to</span>
<a href="#l2.88"></a><span id="l2.88" class="difflineminus">-    // create a details string, we simply don't show anything.</span>
<a href="#l2.89"></a><span id="l2.89" class="difflineminus">-    reminderDetails.setAttribute(&quot;collapsed&quot;, &quot;true&quot;);</span>
<a href="#l2.90"></a><span id="l2.90" class="difflineplus">+    let reminderList = document.getElementById(&quot;item-alarm&quot;);</span>
<a href="#l2.91"></a><span id="l2.91" class="difflineplus">+    let reminderDetails = document.getElementById(&quot;reminder-details&quot;);</span>
<a href="#l2.92"></a><span id="l2.92" class="difflineplus">+    let reminderMultipleLabel = document.getElementById(&quot;reminder-multiple-alarms-label&quot;);</span>
<a href="#l2.93"></a><span id="l2.93"> </span>
<a href="#l2.94"></a><span id="l2.94" class="difflineminus">-    // don't try to show the details text</span>
<a href="#l2.95"></a><span id="l2.95" class="difflineminus">-    // for anything but a custom recurrence rule.</span>
<a href="#l2.96"></a><span id="l2.96" class="difflineminus">-    if (reminderPopup.value == &quot;custom&quot; &amp;&amp; reminder) {</span>
<a href="#l2.97"></a><span id="l2.97" class="difflineminus">-        var unitString;</span>
<a href="#l2.98"></a><span id="l2.98" class="difflineminus">-        switch (reminder.unit) {</span>
<a href="#l2.99"></a><span id="l2.99" class="difflineminus">-            case 'minutes':</span>
<a href="#l2.100"></a><span id="l2.100" class="difflineminus">-                unitString = Number(reminder.length) &lt;= 1 ?</span>
<a href="#l2.101"></a><span id="l2.101" class="difflineminus">-                    calGetString(</span>
<a href="#l2.102"></a><span id="l2.102" class="difflineminus">-                        &quot;calendar-event-dialog&quot;,</span>
<a href="#l2.103"></a><span id="l2.103" class="difflineminus">-                        &quot;reminderCustomUnitMinute&quot;) :</span>
<a href="#l2.104"></a><span id="l2.104" class="difflineminus">-                    calGetString(</span>
<a href="#l2.105"></a><span id="l2.105" class="difflineminus">-                        &quot;calendar-event-dialog&quot;,</span>
<a href="#l2.106"></a><span id="l2.106" class="difflineminus">-                        &quot;reminderCustomUnitMinutes&quot;);</span>
<a href="#l2.107"></a><span id="l2.107" class="difflineminus">-                break;</span>
<a href="#l2.108"></a><span id="l2.108" class="difflineminus">-            case 'hours':</span>
<a href="#l2.109"></a><span id="l2.109" class="difflineminus">-                unitString = Number(reminder.length) &lt;= 1 ?</span>
<a href="#l2.110"></a><span id="l2.110" class="difflineminus">-                    calGetString(</span>
<a href="#l2.111"></a><span id="l2.111" class="difflineminus">-                        &quot;calendar-event-dialog&quot;,</span>
<a href="#l2.112"></a><span id="l2.112" class="difflineminus">-                        &quot;reminderCustomUnitHour&quot;) :</span>
<a href="#l2.113"></a><span id="l2.113" class="difflineminus">-                    calGetString(</span>
<a href="#l2.114"></a><span id="l2.114" class="difflineminus">-                        &quot;calendar-event-dialog&quot;,</span>
<a href="#l2.115"></a><span id="l2.115" class="difflineminus">-                        &quot;reminderCustomUnitHours&quot;);</span>
<a href="#l2.116"></a><span id="l2.116" class="difflineminus">-                break;</span>
<a href="#l2.117"></a><span id="l2.117" class="difflineminus">-            case 'days':</span>
<a href="#l2.118"></a><span id="l2.118" class="difflineminus">-                unitString = Number(reminder.length) &lt;= 1 ?</span>
<a href="#l2.119"></a><span id="l2.119" class="difflineminus">-                    calGetString(</span>
<a href="#l2.120"></a><span id="l2.120" class="difflineminus">-                        &quot;calendar-event-dialog&quot;,</span>
<a href="#l2.121"></a><span id="l2.121" class="difflineminus">-                        &quot;reminderCustomUnitDay&quot;) :</span>
<a href="#l2.122"></a><span id="l2.122" class="difflineminus">-                    calGetString(</span>
<a href="#l2.123"></a><span id="l2.123" class="difflineminus">-                        &quot;calendar-event-dialog&quot;,</span>
<a href="#l2.124"></a><span id="l2.124" class="difflineminus">-                        &quot;reminderCustomUnitDays&quot;);</span>
<a href="#l2.125"></a><span id="l2.125" class="difflineminus">-                break;</span>
<a href="#l2.126"></a><span id="l2.126" class="difflineminus">-        }</span>
<a href="#l2.127"></a><span id="l2.127" class="difflineplus">+    let reminderSingleLabel = document.getElementById(&quot;reminder-single-alarms-label&quot;);</span>
<a href="#l2.128"></a><span id="l2.128" class="difflineplus">+    let reminders = document.getElementById(&quot;reminder-custom-menuitem&quot;).reminders || [];</span>
<a href="#l2.129"></a><span id="l2.129" class="difflineplus">+    let calendar = document.getElementById(&quot;item-calendar&quot;)</span>
<a href="#l2.130"></a><span id="l2.130" class="difflineplus">+                           .selectedItem.calendar;</span>
<a href="#l2.131"></a><span id="l2.131" class="difflineplus">+    let actionValues = calendar.getProperty(&quot;capabilities.alarms.actionValues&quot;) || [&quot;DISPLAY&quot;];</span>
<a href="#l2.132"></a><span id="l2.132" class="difflineplus">+    let actionMap = {};</span>
<a href="#l2.133"></a><span id="l2.133" class="difflineplus">+    for each (var action in actionValues) {</span>
<a href="#l2.134"></a><span id="l2.134" class="difflineplus">+        actionMap[action] = true;</span>
<a href="#l2.135"></a><span id="l2.135" class="difflineplus">+    }</span>
<a href="#l2.136"></a><span id="l2.136" class="difflineplus">+</span>
<a href="#l2.137"></a><span id="l2.137" class="difflineplus">+    // Filter out any unsupported action types.</span>
<a href="#l2.138"></a><span id="l2.138" class="difflineplus">+    reminders = reminders.filter(function(x) x.action in actionMap);</span>
<a href="#l2.139"></a><span id="l2.139"> </span>
<a href="#l2.140"></a><span id="l2.140" class="difflineminus">-        var relationString;</span>
<a href="#l2.141"></a><span id="l2.141" class="difflineminus">-        switch (reminder.relation) {</span>
<a href="#l2.142"></a><span id="l2.142" class="difflineminus">-            case 'START':</span>
<a href="#l2.143"></a><span id="l2.143" class="difflineminus">-                relationString = calGetString(</span>
<a href="#l2.144"></a><span id="l2.144" class="difflineminus">-                    &quot;calendar-event-dialog&quot;,</span>
<a href="#l2.145"></a><span id="l2.145" class="difflineminus">-                    &quot;reminderCustomRelationBefore&quot;);</span>
<a href="#l2.146"></a><span id="l2.146" class="difflineminus">-                break;</span>
<a href="#l2.147"></a><span id="l2.147" class="difflineminus">-            case 'END':</span>
<a href="#l2.148"></a><span id="l2.148" class="difflineminus">-                relationString = calGetString(</span>
<a href="#l2.149"></a><span id="l2.149" class="difflineminus">-                    &quot;calendar-event-dialog&quot;,</span>
<a href="#l2.150"></a><span id="l2.150" class="difflineminus">-                    &quot;reminderCustomRelationAfter&quot;);</span>
<a href="#l2.151"></a><span id="l2.151" class="difflineminus">-                break;</span>
<a href="#l2.152"></a><span id="l2.152" class="difflineminus">-        }</span>
<a href="#l2.153"></a><span id="l2.153" class="difflineplus">+    if (reminderList.value != &quot;custom&quot; || !reminders.length) {</span>
<a href="#l2.154"></a><span id="l2.154" class="difflineplus">+        // Don't try to show the details text for anything but a custom</span>
<a href="#l2.155"></a><span id="l2.155" class="difflineplus">+        // recurrence rule.</span>
<a href="#l2.156"></a><span id="l2.156" class="difflineplus">+        hideElement(reminderDetails);</span>
<a href="#l2.157"></a><span id="l2.157" class="difflineplus">+        return;</span>
<a href="#l2.158"></a><span id="l2.158" class="difflineplus">+    } else {</span>
<a href="#l2.159"></a><span id="l2.159" class="difflineplus">+        showElement(reminderDetails);</span>
<a href="#l2.160"></a><span id="l2.160" class="difflineplus">+    }</span>
<a href="#l2.161"></a><span id="l2.161"> </span>
<a href="#l2.162"></a><span id="l2.162" class="difflineminus">-        var originString;</span>
<a href="#l2.163"></a><span id="l2.163" class="difflineminus">-        if (reminder.origin &amp;&amp; reminder.origin &lt; 0) {</span>
<a href="#l2.164"></a><span id="l2.164" class="difflineminus">-            originString = calGetString(</span>
<a href="#l2.165"></a><span id="l2.165" class="difflineminus">-                &quot;calendar-event-dialog&quot;,</span>
<a href="#l2.166"></a><span id="l2.166" class="difflineminus">-                &quot;reminderCustomOriginEndEvent&quot;);</span>
<a href="#l2.167"></a><span id="l2.167" class="difflineminus">-        } else {</span>
<a href="#l2.168"></a><span id="l2.168" class="difflineminus">-            originString = calGetString(</span>
<a href="#l2.169"></a><span id="l2.169" class="difflineminus">-                &quot;calendar-event-dialog&quot;,</span>
<a href="#l2.170"></a><span id="l2.170" class="difflineminus">-                &quot;reminderCustomOriginBeginEvent&quot;);</span>
<a href="#l2.171"></a><span id="l2.171" class="difflineminus">-        }</span>
<a href="#l2.172"></a><span id="l2.172" class="difflineplus">+    // Depending on how many alarms we have, show either the &quot;Multiple Alarms&quot;</span>
<a href="#l2.173"></a><span id="l2.173" class="difflineplus">+    // label or the single reminder label.</span>
<a href="#l2.174"></a><span id="l2.174" class="difflineplus">+    setElementValue(reminderMultipleLabel,</span>
<a href="#l2.175"></a><span id="l2.175" class="difflineplus">+                    reminders.length &lt; 2 &amp;&amp; &quot;true&quot;,</span>
<a href="#l2.176"></a><span id="l2.176" class="difflineplus">+                    &quot;hidden&quot;);</span>
<a href="#l2.177"></a><span id="l2.177" class="difflineplus">+    setElementValue(reminderSingleLabel,</span>
<a href="#l2.178"></a><span id="l2.178" class="difflineplus">+                    reminders.length &gt; 1 &amp;&amp; &quot;true&quot;,</span>
<a href="#l2.179"></a><span id="l2.179" class="difflineplus">+                    &quot;hidden&quot;);</span>
<a href="#l2.180"></a><span id="l2.180"> </span>
<a href="#l2.181"></a><span id="l2.181" class="difflineminus">-        var detailsString = calGetString(</span>
<a href="#l2.182"></a><span id="l2.182" class="difflineminus">-          &quot;calendar-event-dialog&quot;,</span>
<a href="#l2.183"></a><span id="l2.183" class="difflineminus">-          &quot;reminderCustomTitle&quot;,</span>
<a href="#l2.184"></a><span id="l2.184" class="difflineminus">-          [ reminder.length,</span>
<a href="#l2.185"></a><span id="l2.185" class="difflineminus">-            unitString,</span>
<a href="#l2.186"></a><span id="l2.186" class="difflineminus">-            relationString,</span>
<a href="#l2.187"></a><span id="l2.187" class="difflineminus">-            originString]);</span>
<a href="#l2.188"></a><span id="l2.188" class="difflineplus">+    cal.alarms.addReminderImages(document.getElementById(&quot;reminder-icon-box&quot;),</span>
<a href="#l2.189"></a><span id="l2.189" class="difflineplus">+                                 reminders);</span>
<a href="#l2.190"></a><span id="l2.190"> </span>
<a href="#l2.191"></a><span id="l2.191" class="difflineminus">-        var lines = detailsString.split(&quot;\n&quot;);</span>
<a href="#l2.192"></a><span id="l2.192" class="difflineminus">-        reminderDetails.removeAttribute(&quot;collapsed&quot;);</span>
<a href="#l2.193"></a><span id="l2.193" class="difflineminus">-        while (reminderDetails.childNodes.length &gt; lines.length) {</span>
<a href="#l2.194"></a><span id="l2.194" class="difflineminus">-            reminderDetails.removeChild(reminderDetails.lastChild);</span>
<a href="#l2.195"></a><span id="l2.195" class="difflineminus">-        }</span>
<a href="#l2.196"></a><span id="l2.196" class="difflineminus">-        var numChilds = reminderDetails.childNodes.length;</span>
<a href="#l2.197"></a><span id="l2.197" class="difflineminus">-        for (var i = 0; i &lt; lines.length; i++) {</span>
<a href="#l2.198"></a><span id="l2.198" class="difflineminus">-            if (i &gt;= numChilds) {</span>
<a href="#l2.199"></a><span id="l2.199" class="difflineminus">-                var newNode = reminderDetails.childNodes[0].cloneNode(true);</span>
<a href="#l2.200"></a><span id="l2.200" class="difflineminus">-                reminderDetails.appendChild(newNode);</span>
<a href="#l2.201"></a><span id="l2.201" class="difflineminus">-            }</span>
<a href="#l2.202"></a><span id="l2.202" class="difflineminus">-            var node = reminderDetails.childNodes[i];</span>
<a href="#l2.203"></a><span id="l2.203" class="difflineminus">-            node.setAttribute('value', lines[i]);</span>
<a href="#l2.204"></a><span id="l2.204" class="difflineminus">-        }</span>
<a href="#l2.205"></a><span id="l2.205" class="difflineplus">+    // If there is only one reminder, display the reminder string</span>
<a href="#l2.206"></a><span id="l2.206" class="difflineplus">+    if (reminders.length == 1) {</span>
<a href="#l2.207"></a><span id="l2.207" class="difflineplus">+        setElementValue(reminderSingleLabel,</span>
<a href="#l2.208"></a><span id="l2.208" class="difflineplus">+                        reminders[0].toString(window.calendarItem));</span>
<a href="#l2.209"></a><span id="l2.209">     }</span>
<a href="#l2.210"></a><span id="l2.210"> }</span>
<a href="#l2.211"></a><span id="l2.211"> </span>
<a href="#l2.212"></a><span id="l2.212"> var gLastAlarmSelection = 0;</span>
<a href="#l2.213"></a><span id="l2.213"> </span>
<a href="#l2.214"></a><span id="l2.214"> /**</span>
<a href="#l2.215"></a><span id="l2.215">  * Load an item's reminders into the dialog</span>
<a href="#l2.216"></a><span id="l2.216">  *</span>
<a href="#l2.217"></a><span id="l2.217" class="difflineminus">- * @param item      The item to load.</span>
<a href="#l2.218"></a><span id="l2.218" class="difflineplus">+ * @param reminders     An array of calIAlarms to load. </span>
<a href="#l2.219"></a><span id="l2.219">  */</span>
<a href="#l2.220"></a><span id="l2.220" class="difflineminus">-function loadReminder(item) {</span>
<a href="#l2.221"></a><span id="l2.221" class="difflineplus">+function loadReminders(reminders) {</span>
<a href="#l2.222"></a><span id="l2.222">     // select 'no reminder' by default</span>
<a href="#l2.223"></a><span id="l2.223" class="difflineminus">-    let reminderPopup = document.getElementById(&quot;item-alarm&quot;);</span>
<a href="#l2.224"></a><span id="l2.224" class="difflineminus">-    reminderPopup.selectedIndex = 0;</span>
<a href="#l2.225"></a><span id="l2.225" class="difflineplus">+    let reminderList = document.getElementById(&quot;item-alarm&quot;);</span>
<a href="#l2.226"></a><span id="l2.226" class="difflineplus">+    let reminderPopup = reminderList.firstChild;</span>
<a href="#l2.227"></a><span id="l2.227" class="difflineplus">+    let customItem = document.getElementById(&quot;reminder-custom-menuitem&quot;);</span>
<a href="#l2.228"></a><span id="l2.228" class="difflineplus">+</span>
<a href="#l2.229"></a><span id="l2.229" class="difflineplus">+    reminderList.selectedIndex = 0;</span>
<a href="#l2.230"></a><span id="l2.230">     gLastAlarmSelection = 0;</span>
<a href="#l2.231"></a><span id="l2.231"> </span>
<a href="#l2.232"></a><span id="l2.232" class="difflineminus">-    // TODO ALARMSUPPORT right now, just consider the first relative alarm. This</span>
<a href="#l2.233"></a><span id="l2.233" class="difflineminus">-    // should change as soon as the UI supports multiple alarms.</span>
<a href="#l2.234"></a><span id="l2.234" class="difflineminus">-    let alarms = item.getAlarms({})</span>
<a href="#l2.235"></a><span id="l2.235" class="difflineminus">-                     .filter(function(x) x.related != x.ALARM_RELATED_ABSOLUTE);</span>
<a href="#l2.236"></a><span id="l2.236" class="difflineminus">-    let alarm = alarms[0];</span>
<a href="#l2.237"></a><span id="l2.237" class="difflineminus">-    if (!alarm) {</span>
<a href="#l2.238"></a><span id="l2.238" class="difflineplus">+    if (!reminders || !reminders.length) {</span>
<a href="#l2.239"></a><span id="l2.239" class="difflineplus">+        // No reminders selected, we are done</span>
<a href="#l2.240"></a><span id="l2.240">         return;</span>
<a href="#l2.241"></a><span id="l2.241">     }</span>
<a href="#l2.242"></a><span id="l2.242" class="difflineminus">-    // END TODO ALARMSUPPORT</span>
<a href="#l2.243"></a><span id="l2.243" class="difflineminus">-        </span>
<a href="#l2.244"></a><span id="l2.244" class="difflineplus">+</span>
<a href="#l2.245"></a><span id="l2.245" class="difflineplus">+    if (reminders.length == 1 &amp;&amp;</span>
<a href="#l2.246"></a><span id="l2.246" class="difflineplus">+        reminders[0].related != Components.interfaces.calIAlarm.ALARM_RELATED_ABSOLUTE &amp;&amp;</span>
<a href="#l2.247"></a><span id="l2.247" class="difflineplus">+        reminders[0].offset &amp;&amp;</span>
<a href="#l2.248"></a><span id="l2.248" class="difflineplus">+        reminders[0].action == &quot;DISPLAY&quot;) {</span>
<a href="#l2.249"></a><span id="l2.249" class="difflineplus">+        // Exactly one reminder thats not absolute, we may be able to match up</span>
<a href="#l2.250"></a><span id="l2.250" class="difflineplus">+        // popup items. The reminder should also be a DISPLAY alarm</span>
<a href="#l2.251"></a><span id="l2.251" class="difflineplus">+        let reminder = reminders[0];</span>
<a href="#l2.252"></a><span id="l2.252" class="difflineplus">+</span>
<a href="#l2.253"></a><span id="l2.253" class="difflineplus">+        let relation = (reminder.related == reminder.ALARM_RELATED_START ? &quot;START&quot; : &quot;END&quot;);</span>
<a href="#l2.254"></a><span id="l2.254" class="difflineplus">+        let origin = (reminder.offset.isNegative ? &quot;before&quot; : &quot;after&quot;);</span>
<a href="#l2.255"></a><span id="l2.255"> </span>
<a href="#l2.256"></a><span id="l2.256" class="difflineminus">-    // try to match the reminder setting with the available popup items</span>
<a href="#l2.257"></a><span id="l2.257" class="difflineminus">-    let origin = &quot;1&quot;;</span>
<a href="#l2.258"></a><span id="l2.258" class="difflineminus">-    if (alarm.related == Components.interfaces.calIAlarm.ALARM_RELATED_END) {</span>
<a href="#l2.259"></a><span id="l2.259" class="difflineminus">-        origin = &quot;-1&quot;;</span>
<a href="#l2.260"></a><span id="l2.260" class="difflineminus">-    }</span>
<a href="#l2.261"></a><span id="l2.261" class="difflineminus">-    let duration = alarm.offset.clone();</span>
<a href="#l2.262"></a><span id="l2.262" class="difflineminus">-    let relation = &quot;END&quot;;</span>
<a href="#l2.263"></a><span id="l2.263" class="difflineminus">-    if (duration.isNegative) {</span>
<a href="#l2.264"></a><span id="l2.264" class="difflineminus">-        duration.isNegative = false;</span>
<a href="#l2.265"></a><span id="l2.265" class="difflineminus">-        duration.normalize();</span>
<a href="#l2.266"></a><span id="l2.266" class="difflineminus">-        relation = &quot;START&quot;;</span>
<a href="#l2.267"></a><span id="l2.267" class="difflineminus">-    }</span>
<a href="#l2.268"></a><span id="l2.268" class="difflineminus">-    let matchingItem = null;</span>
<a href="#l2.269"></a><span id="l2.269" class="difflineminus">-    let menuItems = reminderPopup.getElementsByTagName(&quot;menuitem&quot;);</span>
<a href="#l2.270"></a><span id="l2.270" class="difflineminus">-    let numItems = menuItems.length;</span>
<a href="#l2.271"></a><span id="l2.271" class="difflineminus">-    for (let i = 0; i &lt; numItems; i++) {</span>
<a href="#l2.272"></a><span id="l2.272" class="difflineminus">-        let menuitem = menuItems[i];</span>
<a href="#l2.273"></a><span id="l2.273" class="difflineminus">-        if (menuitem.hasAttribute(&quot;length&quot;)) {</span>
<a href="#l2.274"></a><span id="l2.274" class="difflineminus">-            if (menuitem.getAttribute(&quot;origin&quot;) == origin &amp;&amp;</span>
<a href="#l2.275"></a><span id="l2.275" class="difflineplus">+        let unitMap = {</span>
<a href="#l2.276"></a><span id="l2.276" class="difflineplus">+          days: 86400,</span>
<a href="#l2.277"></a><span id="l2.277" class="difflineplus">+          hours: 3600,</span>
<a href="#l2.278"></a><span id="l2.278" class="difflineplus">+          minutes: 60</span>
<a href="#l2.279"></a><span id="l2.279" class="difflineplus">+        };</span>
<a href="#l2.280"></a><span id="l2.280" class="difflineplus">+</span>
<a href="#l2.281"></a><span id="l2.281" class="difflineplus">+        for each (let menuitem in Array.slice(reminderPopup.childNodes)) {</span>
<a href="#l2.282"></a><span id="l2.282" class="difflineplus">+            if (menuitem.localName == &quot;menuitem&quot; &amp;&amp;</span>
<a href="#l2.283"></a><span id="l2.283" class="difflineplus">+                menuitem.hasAttribute(&quot;length&quot;) &amp;&amp;</span>
<a href="#l2.284"></a><span id="l2.284" class="difflineplus">+                menuitem.getAttribute(&quot;origin&quot;) == origin &amp;&amp;</span>
<a href="#l2.285"></a><span id="l2.285">                 menuitem.getAttribute(&quot;relation&quot;) == relation) {</span>
<a href="#l2.286"></a><span id="l2.286" class="difflineminus">-                let unit = menuitem.getAttribute(&quot;unit&quot;);</span>
<a href="#l2.287"></a><span id="l2.287" class="difflineminus">-                let length = menuitem.getAttribute(&quot;length&quot;);</span>
<a href="#l2.288"></a><span id="l2.288" class="difflineminus">-                if (unit == &quot;days&quot;) {</span>
<a href="#l2.289"></a><span id="l2.289" class="difflineminus">-                    length = length * 60 * 60 * 24;</span>
<a href="#l2.290"></a><span id="l2.290" class="difflineminus">-                } else if (unit == &quot;hours&quot;) {</span>
<a href="#l2.291"></a><span id="l2.291" class="difflineminus">-                    length = length * 60 * 60;</span>
<a href="#l2.292"></a><span id="l2.292" class="difflineminus">-                } else if (unit == &quot;minutes&quot;) {</span>
<a href="#l2.293"></a><span id="l2.293" class="difflineminus">-                    length = length * 60;</span>
<a href="#l2.294"></a><span id="l2.294" class="difflineminus">-                } else {</span>
<a href="#l2.295"></a><span id="l2.295" class="difflineminus">-                    continue;</span>
<a href="#l2.296"></a><span id="l2.296" class="difflineminus">-                }</span>
<a href="#l2.297"></a><span id="l2.297" class="difflineminus">-                if (duration.inSeconds == length) {</span>
<a href="#l2.298"></a><span id="l2.298" class="difflineminus">-                    matchingItem = menuitem;</span>
<a href="#l2.299"></a><span id="l2.299" class="difflineminus">-                    break;</span>
<a href="#l2.300"></a><span id="l2.300" class="difflineplus">+                let unitMult = unitMap[menuitem.getAttribute(&quot;unit&quot;)] || 1;</span>
<a href="#l2.301"></a><span id="l2.301" class="difflineplus">+                let length = menuitem.getAttribute(&quot;length&quot;) * unitMult;</span>
<a href="#l2.302"></a><span id="l2.302" class="difflineplus">+</span>
<a href="#l2.303"></a><span id="l2.303" class="difflineplus">+                if (Math.abs(reminder.offset.inSeconds) == length) {</span>
<a href="#l2.304"></a><span id="l2.304" class="difflineplus">+                    reminderList.selectedItem = menuitem;</span>
<a href="#l2.305"></a><span id="l2.305" class="difflineplus">+                    // We've selected an item, so we are done here.</span>
<a href="#l2.306"></a><span id="l2.306" class="difflineplus">+                    return;</span>
<a href="#l2.307"></a><span id="l2.307">                 }</span>
<a href="#l2.308"></a><span id="l2.308">             }</span>
<a href="#l2.309"></a><span id="l2.309">         }</span>
<a href="#l2.310"></a><span id="l2.310">     }</span>
<a href="#l2.311"></a><span id="l2.311"> </span>
<a href="#l2.312"></a><span id="l2.312" class="difflineminus">-    if (matchingItem) {</span>
<a href="#l2.313"></a><span id="l2.313" class="difflineminus">-        var numChilds = reminderPopup.childNodes[0].childNodes.length;</span>
<a href="#l2.314"></a><span id="l2.314" class="difflineminus">-        for (var i = 0; i &lt; numChilds; i++) {</span>
<a href="#l2.315"></a><span id="l2.315" class="difflineminus">-            var node = reminderPopup.childNodes[0].childNodes[i];</span>
<a href="#l2.316"></a><span id="l2.316" class="difflineminus">-            if (node == matchingItem) {</span>
<a href="#l2.317"></a><span id="l2.317" class="difflineminus">-                reminderPopup.selectedIndex = i;</span>
<a href="#l2.318"></a><span id="l2.318" class="difflineminus">-                break;</span>
<a href="#l2.319"></a><span id="l2.319" class="difflineminus">-            }</span>
<a href="#l2.320"></a><span id="l2.320" class="difflineminus">-        }</span>
<a href="#l2.321"></a><span id="l2.321" class="difflineminus">-    } else {</span>
<a href="#l2.322"></a><span id="l2.322" class="difflineminus">-        reminderPopup.value = 'custom';</span>
<a href="#l2.323"></a><span id="l2.323" class="difflineminus">-        var customReminder =</span>
<a href="#l2.324"></a><span id="l2.324" class="difflineminus">-            document.getElementById(&quot;reminder-custom-menuitem&quot;);</span>
<a href="#l2.325"></a><span id="l2.325" class="difflineminus">-        var reminder = {};</span>
<a href="#l2.326"></a><span id="l2.326" class="difflineminus">-        if (alarm.related == Components.interfaces.calIAlarm.ALARM_RELATED_START) {</span>
<a href="#l2.327"></a><span id="l2.327" class="difflineminus">-            reminder.origin = &quot;1&quot;;</span>
<a href="#l2.328"></a><span id="l2.328" class="difflineminus">-        } else {</span>
<a href="#l2.329"></a><span id="l2.329" class="difflineminus">-            reminder.origin = &quot;-1&quot;;</span>
<a href="#l2.330"></a><span id="l2.330" class="difflineminus">-        }</span>
<a href="#l2.331"></a><span id="l2.331" class="difflineminus">-        let offset = alarm.offset.clone();</span>
<a href="#l2.332"></a><span id="l2.332" class="difflineminus">-        relation = &quot;END&quot;;</span>
<a href="#l2.333"></a><span id="l2.333" class="difflineminus">-        if (offset.isNegative) {</span>
<a href="#l2.334"></a><span id="l2.334" class="difflineminus">-            offset.isNegative = false;</span>
<a href="#l2.335"></a><span id="l2.335" class="difflineminus">-            offset.normalize();</span>
<a href="#l2.336"></a><span id="l2.336" class="difflineminus">-            relation = &quot;START&quot;;</span>
<a href="#l2.337"></a><span id="l2.337" class="difflineminus">-        }</span>
<a href="#l2.338"></a><span id="l2.338" class="difflineminus">-        reminder.relation = relation;</span>
<a href="#l2.339"></a><span id="l2.339" class="difflineminus">-        if (offset.minutes) {</span>
<a href="#l2.340"></a><span id="l2.340" class="difflineminus">-            let minutes = offset.minutes +</span>
<a href="#l2.341"></a><span id="l2.341" class="difflineminus">-                          offset.hours * 60 +</span>
<a href="#l2.342"></a><span id="l2.342" class="difflineminus">-                          offset.days * 24 * 60 +</span>
<a href="#l2.343"></a><span id="l2.343" class="difflineminus">-                          offset.weeks * 60 * 24 * 7;</span>
<a href="#l2.344"></a><span id="l2.344" class="difflineminus">-            reminder.unit = 'minutes';</span>
<a href="#l2.345"></a><span id="l2.345" class="difflineminus">-            reminder.length = minutes;</span>
<a href="#l2.346"></a><span id="l2.346" class="difflineminus">-        } else if (offset.hours) {</span>
<a href="#l2.347"></a><span id="l2.347" class="difflineminus">-            var hours = offset.hours + offset.days * 24 + offset.weeks * 24 * 7;</span>
<a href="#l2.348"></a><span id="l2.348" class="difflineminus">-            reminder.unit = 'hours';</span>
<a href="#l2.349"></a><span id="l2.349" class="difflineminus">-            reminder.length = hours;</span>
<a href="#l2.350"></a><span id="l2.350" class="difflineminus">-        } else {</span>
<a href="#l2.351"></a><span id="l2.351" class="difflineminus">-            var days = offset.days + offset.weeks * 7;</span>
<a href="#l2.352"></a><span id="l2.352" class="difflineminus">-            reminder.unit = 'days';</span>
<a href="#l2.353"></a><span id="l2.353" class="difflineminus">-            reminder.length = days;</span>
<a href="#l2.354"></a><span id="l2.354" class="difflineminus">-        }</span>
<a href="#l2.355"></a><span id="l2.355" class="difflineminus">-        customReminder.reminder = reminder;</span>
<a href="#l2.356"></a><span id="l2.356" class="difflineplus">+    // If more than one alarm is selected, or we didn't find a matching item</span>
<a href="#l2.357"></a><span id="l2.357" class="difflineplus">+    // above, then select the &quot;custom&quot; item and attach the item's reminders to</span>
<a href="#l2.358"></a><span id="l2.358" class="difflineplus">+    // it.</span>
<a href="#l2.359"></a><span id="l2.359" class="difflineplus">+    if (reminderList.selectedIndex &lt; 1) {</span>
<a href="#l2.360"></a><span id="l2.360" class="difflineplus">+        reminderList.value = 'custom';</span>
<a href="#l2.361"></a><span id="l2.361" class="difflineplus">+        customItem.reminders = reminders;</span>
<a href="#l2.362"></a><span id="l2.362">     }</span>
<a href="#l2.363"></a><span id="l2.363"> </span>
<a href="#l2.364"></a><span id="l2.364">     // remember the selected index</span>
<a href="#l2.365"></a><span id="l2.365" class="difflineminus">-    gLastAlarmSelection = reminderPopup.selectedIndex;</span>
<a href="#l2.366"></a><span id="l2.366" class="difflineplus">+    gLastAlarmSelection = reminderList.selectedIndex;</span>
<a href="#l2.367"></a><span id="l2.367"> }</span>
<a href="#l2.368"></a><span id="l2.368"> </span>
<a href="#l2.369"></a><span id="l2.369"> /**</span>
<a href="#l2.370"></a><span id="l2.370">  * Save the selected reminder into the passed item.</span>
<a href="#l2.371"></a><span id="l2.371">  *</span>
<a href="#l2.372"></a><span id="l2.372">  * @param item      The item save the reminder into.</span>
<a href="#l2.373"></a><span id="l2.373">  */</span>
<a href="#l2.374"></a><span id="l2.374"> function saveReminder(item) {</span>
<a href="#l2.375"></a><span id="l2.375" class="difflineplus">+    // Clear alarms, we'll need to remove alarms later  anyway.</span>
<a href="#l2.376"></a><span id="l2.376">     item.clearAlarms();</span>
<a href="#l2.377"></a><span id="l2.377" class="difflineminus">-    var reminderPopup = document.getElementById(&quot;item-alarm&quot;);</span>
<a href="#l2.378"></a><span id="l2.378" class="difflineminus">-    if (reminderPopup.value == 'none') {</span>
<a href="#l2.379"></a><span id="l2.379" class="difflineminus">-        item.alarmLastAck = null;</span>
<a href="#l2.380"></a><span id="l2.380" class="difflineminus">-    } else {</span>
<a href="#l2.381"></a><span id="l2.381" class="difflineminus">-        var menuitem = reminderPopup.selectedItem;</span>
<a href="#l2.382"></a><span id="l2.382" class="difflineplus">+</span>
<a href="#l2.383"></a><span id="l2.383" class="difflineplus">+    let reminderList = document.getElementById(&quot;item-alarm&quot;);</span>
<a href="#l2.384"></a><span id="l2.384" class="difflineplus">+    if (reminderList.value != 'none') {</span>
<a href="#l2.385"></a><span id="l2.385" class="difflineplus">+        let menuitem = reminderList.selectedItem;</span>
<a href="#l2.386"></a><span id="l2.386" class="difflineplus">+        let reminders;</span>
<a href="#l2.387"></a><span id="l2.387" class="difflineplus">+</span>
<a href="#l2.388"></a><span id="l2.388" class="difflineplus">+        if (menuitem.reminders) {</span>
<a href="#l2.389"></a><span id="l2.389" class="difflineplus">+            // Custom reminder entries carry their own reminder object with</span>
<a href="#l2.390"></a><span id="l2.390" class="difflineplus">+            // them. Make sure to clone in case these are the original item's</span>
<a href="#l2.391"></a><span id="l2.391" class="difflineplus">+            // reminders.</span>
<a href="#l2.392"></a><span id="l2.392"> </span>
<a href="#l2.393"></a><span id="l2.393" class="difflineminus">-        // custom reminder entries carry their own reminder object</span>
<a href="#l2.394"></a><span id="l2.394" class="difflineminus">-        // with them, pre-defined entries specify the necessary information</span>
<a href="#l2.395"></a><span id="l2.395" class="difflineminus">-        // as attributes attached to the menuitem elements.</span>
<a href="#l2.396"></a><span id="l2.396" class="difflineminus">-        var reminder = menuitem.reminder;</span>
<a href="#l2.397"></a><span id="l2.397" class="difflineminus">-        if (!reminder) {</span>
<a href="#l2.398"></a><span id="l2.398" class="difflineminus">-            reminder = {};</span>
<a href="#l2.399"></a><span id="l2.399" class="difflineminus">-            reminder.length = menuitem.getAttribute('length');</span>
<a href="#l2.400"></a><span id="l2.400" class="difflineminus">-            reminder.unit = menuitem.getAttribute('unit');</span>
<a href="#l2.401"></a><span id="l2.401" class="difflineminus">-            reminder.relation = menuitem.getAttribute('relation');</span>
<a href="#l2.402"></a><span id="l2.402" class="difflineminus">-            reminder.origin = menuitem.getAttribute('origin');</span>
<a href="#l2.403"></a><span id="l2.403" class="difflineplus">+            // XXX do we need to clone here?</span>
<a href="#l2.404"></a><span id="l2.404" class="difflineplus">+            reminders = menuitem.reminders.map(function(x) x.clone());</span>
<a href="#l2.405"></a><span id="l2.405" class="difflineplus">+        } else {</span>
<a href="#l2.406"></a><span id="l2.406" class="difflineplus">+            // Pre-defined entries specify the necessary information</span>
<a href="#l2.407"></a><span id="l2.407" class="difflineplus">+            // as attributes attached to the menuitem elements.</span>
<a href="#l2.408"></a><span id="l2.408" class="difflineplus">+            let reminder = cal.createAlarm();</span>
<a href="#l2.409"></a><span id="l2.409" class="difflineplus">+            let offset = cal.createDuration();</span>
<a href="#l2.410"></a><span id="l2.410" class="difflineplus">+            offset[menuitem.getAttribute(&quot;unit&quot;)] = menuitem.getAttribute(&quot;length&quot;);</span>
<a href="#l2.411"></a><span id="l2.411" class="difflineplus">+            offset.normalize();</span>
<a href="#l2.412"></a><span id="l2.412" class="difflineplus">+            offset.isNegative = (menuitem.getAttribute(&quot;origin&quot;) == &quot;before&quot;);</span>
<a href="#l2.413"></a><span id="l2.413" class="difflineplus">+            reminder.related = (menuitem.getAttribute(&quot;relation&quot;) == &quot;START&quot; ?</span>
<a href="#l2.414"></a><span id="l2.414" class="difflineplus">+                                reminder.ALARM_RELATED_START : reminder.ALARM_RELATED_END);</span>
<a href="#l2.415"></a><span id="l2.415" class="difflineplus">+            reminder.offset = offset;</span>
<a href="#l2.416"></a><span id="l2.416" class="difflineplus">+            reminders = [reminder];</span>
<a href="#l2.417"></a><span id="l2.417">         }</span>
<a href="#l2.418"></a><span id="l2.418"> </span>
<a href="#l2.419"></a><span id="l2.419" class="difflineminus">-        var duration = Components.classes[&quot;@mozilla.org/calendar/duration;1&quot;]</span>
<a href="#l2.420"></a><span id="l2.420" class="difflineminus">-                       .createInstance(Components.interfaces.calIDuration);</span>
<a href="#l2.421"></a><span id="l2.421" class="difflineminus">-</span>
<a href="#l2.422"></a><span id="l2.422" class="difflineminus">-        duration[reminder.unit] = Number(reminder.length);</span>
<a href="#l2.423"></a><span id="l2.423" class="difflineminus">-        if (reminder.relation != &quot;END&quot;) {</span>
<a href="#l2.424"></a><span id="l2.424" class="difflineminus">-            duration.isNegative = true;</span>
<a href="#l2.425"></a><span id="l2.425" class="difflineminus">-        }</span>
<a href="#l2.426"></a><span id="l2.426" class="difflineminus">-        duration.normalize();</span>
<a href="#l2.427"></a><span id="l2.427" class="difflineminus">-        let alarm = cal.createAlarm();</span>
<a href="#l2.428"></a><span id="l2.428" class="difflineminus">-</span>
<a href="#l2.429"></a><span id="l2.429" class="difflineminus">-        if (Number(reminder.origin) &gt;= 0) {</span>
<a href="#l2.430"></a><span id="l2.430" class="difflineminus">-            alarm.related = Components.interfaces.calIAlarm.ALARM_RELATED_START;</span>
<a href="#l2.431"></a><span id="l2.431" class="difflineminus">-        } else {</span>
<a href="#l2.432"></a><span id="l2.432" class="difflineminus">-            alarm.related = Components.interfaces.calIAlarm.ALARM_RELATED_END;</span>
<a href="#l2.433"></a><span id="l2.433" class="difflineplus">+        let alarmCaps = item.calendar.getProperty(&quot;capabilities.alarms.actionValues&quot;) ||</span>
<a href="#l2.434"></a><span id="l2.434" class="difflineplus">+                        [&quot;DISPLAY&quot;];</span>
<a href="#l2.435"></a><span id="l2.435" class="difflineplus">+        let alarmActions = {};</span>
<a href="#l2.436"></a><span id="l2.436" class="difflineplus">+        for each (let action in alarmCaps) {</span>
<a href="#l2.437"></a><span id="l2.437" class="difflineplus">+            alarmActions[action] = true;</span>
<a href="#l2.438"></a><span id="l2.438">         }</span>
<a href="#l2.439"></a><span id="l2.439"> </span>
<a href="#l2.440"></a><span id="l2.440" class="difflineminus">-        alarm.offset = duration;</span>
<a href="#l2.441"></a><span id="l2.441" class="difflineminus">-        item.addAlarm(alarm);</span>
<a href="#l2.442"></a><span id="l2.442" class="difflineplus">+        // Make sure only alarms are saved that work in the given calendar.</span>
<a href="#l2.443"></a><span id="l2.443" class="difflineplus">+        reminders.filter(function(x) x.action in alarmActions)</span>
<a href="#l2.444"></a><span id="l2.444" class="difflineplus">+                 .forEach(item.addAlarm, item);</span>
<a href="#l2.445"></a><span id="l2.445">     }</span>
<a href="#l2.446"></a><span id="l2.446"> }</span>
<a href="#l2.447"></a><span id="l2.447"> </span>
<a href="#l2.448"></a><span id="l2.448"> /**</span>
<a href="#l2.449"></a><span id="l2.449">  * Common update functions for both event dialogs. Called when a reminder has</span>
<a href="#l2.450"></a><span id="l2.450">  * been selected from the menulist.</span>
<a href="#l2.451"></a><span id="l2.451">  */</span>
<a href="#l2.452"></a><span id="l2.452"> function commonUpdateReminder() {</span>
<a href="#l2.453"></a><span id="l2.453">     // if a custom reminder has been selected, we show the appropriate</span>
<a href="#l2.454"></a><span id="l2.454">     // dialog in order to allow the user to specify the details.</span>
<a href="#l2.455"></a><span id="l2.455">     // the result will be placed in the 'reminder-custom-menuitem' tag.</span>
<a href="#l2.456"></a><span id="l2.456" class="difflineminus">-    var reminderPopup = document.getElementById(&quot;item-alarm&quot;);</span>
<a href="#l2.457"></a><span id="l2.457" class="difflineminus">-    if (reminderPopup.value == 'custom') {</span>
<a href="#l2.458"></a><span id="l2.458" class="difflineminus">-        // show the dialog.</span>
<a href="#l2.459"></a><span id="l2.459" class="difflineminus">-        // don't pop up the dialog if this happens during</span>
<a href="#l2.460"></a><span id="l2.460" class="difflineminus">-        // initialization of the dialog.</span>
<a href="#l2.461"></a><span id="l2.461" class="difflineminus">-        if (reminderPopup.hasAttribute(&quot;last-value&quot;)) {</span>
<a href="#l2.462"></a><span id="l2.462" class="difflineplus">+    let reminderList = document.getElementById(&quot;item-alarm&quot;);</span>
<a href="#l2.463"></a><span id="l2.463" class="difflineplus">+    if (reminderList.value == 'custom') {</span>
<a href="#l2.464"></a><span id="l2.464" class="difflineplus">+        // show the dialog. This call blocks until the dialog is closed. Don't</span>
<a href="#l2.465"></a><span id="l2.465" class="difflineplus">+        // pop up the dialog if this happens during initialization of the dialog</span>
<a href="#l2.466"></a><span id="l2.466" class="difflineplus">+        if (reminderList.hasAttribute(&quot;last-value&quot;)) {</span>
<a href="#l2.467"></a><span id="l2.467">             editReminder();</span>
<a href="#l2.468"></a><span id="l2.468">         }</span>
<a href="#l2.469"></a><span id="l2.469"> </span>
<a href="#l2.470"></a><span id="l2.470" class="difflineminus">-        // Now check if the resulting custom reminder is valid.</span>
<a href="#l2.471"></a><span id="l2.471" class="difflineminus">-        // possibly we receive an invalid reminder if the user cancels the</span>
<a href="#l2.472"></a><span id="l2.472" class="difflineminus">-        // dialog. In that case we revert to the previous selection of the</span>
<a href="#l2.473"></a><span id="l2.473" class="difflineminus">-        // reminder drop down.</span>
<a href="#l2.474"></a><span id="l2.474" class="difflineminus">-        if (!document.getElementById(&quot;reminder-custom-menuitem&quot;).reminder) {</span>
<a href="#l2.475"></a><span id="l2.475" class="difflineminus">-            reminderPopup.selectedIndex = gLastAlarmSelection;</span>
<a href="#l2.476"></a><span id="l2.476" class="difflineplus">+        // If one or no reminders were selected, we have a chance of mapping</span>
<a href="#l2.477"></a><span id="l2.477" class="difflineplus">+        // them to the existing elements in the dropdown.</span>
<a href="#l2.478"></a><span id="l2.478" class="difflineplus">+        let customItem = reminderList.selectedItem;</span>
<a href="#l2.479"></a><span id="l2.479" class="difflineplus">+        if (customItem.reminders.length == 0) {</span>
<a href="#l2.480"></a><span id="l2.480" class="difflineplus">+            // No reminder was selected</span>
<a href="#l2.481"></a><span id="l2.481" class="difflineplus">+            reminderList.value = &quot;none&quot;;</span>
<a href="#l2.482"></a><span id="l2.482" class="difflineplus">+        } else if (customItem.reminders.length == 1 &amp;&amp;</span>
<a href="#l2.483"></a><span id="l2.483" class="difflineplus">+                   customItem.reminders[0].action == &quot;DISPLAY&quot;) {</span>
<a href="#l2.484"></a><span id="l2.484" class="difflineplus">+            // TODO This can be taken care of in a different bug. What needs to</span>
<a href="#l2.485"></a><span id="l2.485" class="difflineplus">+            // be done is to go through the menuitems in item-alarm and check if</span>
<a href="#l2.486"></a><span id="l2.486" class="difflineplus">+            // customItem.reminders[0] matches with that.</span>
<a href="#l2.487"></a><span id="l2.487">         }</span>
<a href="#l2.488"></a><span id="l2.488">     }</span>
<a href="#l2.489"></a><span id="l2.489"> </span>
<a href="#l2.490"></a><span id="l2.490">     // remember the current reminder drop down selection index.</span>
<a href="#l2.491"></a><span id="l2.491" class="difflineminus">-    gLastAlarmSelection = reminderPopup.selectedIndex;</span>
<a href="#l2.492"></a><span id="l2.492" class="difflineminus">-    reminderPopup.setAttribute(&quot;last-value&quot;, reminderPopup.value);</span>
<a href="#l2.493"></a><span id="l2.493" class="difflineplus">+    gLastAlarmSelection = reminderList.selectedIndex;</span>
<a href="#l2.494"></a><span id="l2.494" class="difflineplus">+    reminderList.setAttribute(&quot;last-value&quot;, reminderList.value);</span>
<a href="#l2.495"></a><span id="l2.495"> </span>
<a href="#l2.496"></a><span id="l2.496">     // possibly the selected reminder conflicts with the item.</span>
<a href="#l2.497"></a><span id="l2.497">     // for example an end-relation combined with a task without duedate</span>
<a href="#l2.498"></a><span id="l2.498">     // is an invalid state we need to take care of. we take the same</span>
<a href="#l2.499"></a><span id="l2.499">     // approach as with recurring tasks. in case the reminder is related</span>
<a href="#l2.500"></a><span id="l2.500">     // to the entry date we check the entry date automatically and disable</span>
<a href="#l2.501"></a><span id="l2.501">     // the checkbox. the same goes for end related reminder and the due date.</span>
<a href="#l2.502"></a><span id="l2.502">     if (isToDo(window.calendarItem)) {</span>
<a href="#l2.503"></a><span id="l2.503"> </span>
<a href="#l2.504"></a><span id="l2.504">         // custom reminder entries carry their own reminder object</span>
<a href="#l2.505"></a><span id="l2.505">         // with them, pre-defined entries specify the necessary information</span>
<a href="#l2.506"></a><span id="l2.506">         // as attributes attached to the menuitem elements.</span>
<a href="#l2.507"></a><span id="l2.507" class="difflineminus">-        var menuitem = reminderPopup.selectedItem;</span>
<a href="#l2.508"></a><span id="l2.508" class="difflineplus">+        let menuitem = reminderList.selectedItem;</span>
<a href="#l2.509"></a><span id="l2.509">         if (menuitem.value == 'none') {</span>
<a href="#l2.510"></a><span id="l2.510">             enableElementWithLock(&quot;todo-has-entrydate&quot;, &quot;reminder-lock&quot;);</span>
<a href="#l2.511"></a><span id="l2.511">             enableElementWithLock(&quot;todo-has-duedate&quot;, &quot;reminder-lock&quot;);</span>
<a href="#l2.512"></a><span id="l2.512">         } else {</span>
<a href="#l2.513"></a><span id="l2.513">             var reminder = menuitem.reminder;</span>
<a href="#l2.514"></a><span id="l2.514">             if (!reminder) {</span>
<a href="#l2.515"></a><span id="l2.515">                 reminder = {};</span>
<a href="#l2.516"></a><span id="l2.516">                 reminder.length = menuitem.getAttribute('length');</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/content/calendar-month-view.xml</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/content/calendar-month-view.xml</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -81,22 +81,20 @@</span>
<a href="#l3.4"></a><span id="l3.4">                                style=&quot;margin: 0;&quot;/&gt;</span>
<a href="#l3.5"></a><span id="l3.5">                     &lt;xul:textbox anonid=&quot;event-name-textbox&quot;</span>
<a href="#l3.6"></a><span id="l3.6">                                  class=&quot;plain calendar-event-name-textbox&quot;</span>
<a href="#l3.7"></a><span id="l3.7">                                  crop=&quot;end&quot;</span>
<a href="#l3.8"></a><span id="l3.8">                                  hidden=&quot;true&quot;</span>
<a href="#l3.9"></a><span id="l3.9">                                  wrap=&quot;true&quot;/&gt;</span>
<a href="#l3.10"></a><span id="l3.10">                     &lt;xul:spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l3.11"></a><span id="l3.11">                   &lt;/xul:vbox&gt;</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-                  &lt;xul:vbox pack=&quot;center&quot;&gt;</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineminus">-                    &lt;xul:image anonid=&quot;alarm-image&quot;</span>
<a href="#l3.14"></a><span id="l3.14" class="difflineminus">-                               class=&quot;alarm-image&quot;</span>
<a href="#l3.15"></a><span id="l3.15" class="difflineminus">-                               xbl:inherits=&quot;flashing&quot;</span>
<a href="#l3.16"></a><span id="l3.16" class="difflineminus">-                               hidden=&quot;true&quot;/&gt;</span>
<a href="#l3.17"></a><span id="l3.17" class="difflineminus">-                  &lt;/xul:vbox&gt;</span>
<a href="#l3.18"></a><span id="l3.18" class="difflineplus">+                  &lt;xul:hbox anonid=&quot;alarm-icons-box&quot;</span>
<a href="#l3.19"></a><span id="l3.19" class="difflineplus">+                            class=&quot;alarm-icons-box&quot;</span>
<a href="#l3.20"></a><span id="l3.20" class="difflineplus">+                            align=&quot;center&quot;</span>
<a href="#l3.21"></a><span id="l3.21" class="difflineplus">+                            xbl:inherits=&quot;flashing&quot;/&gt;</span>
<a href="#l3.22"></a><span id="l3.22">                 &lt;/xul:hbox&gt;</span>
<a href="#l3.23"></a><span id="l3.23">                 &lt;xul:image anonid=&quot;gradient&quot;</span>
<a href="#l3.24"></a><span id="l3.24">                            class=&quot;calendar-event-box-gradient&quot;</span>
<a href="#l3.25"></a><span id="l3.25">                            height=&quot;1px&quot;/&gt;</span>
<a href="#l3.26"></a><span id="l3.26">               &lt;/xul:stack&gt;</span>
<a href="#l3.27"></a><span id="l3.27">             &lt;/xul:box&gt;</span>
<a href="#l3.28"></a><span id="l3.28">             &lt;xul:calendar-category-box anonid=&quot;category-box&quot; xbl:inherits=&quot;categories&quot;/&gt;</span>
<a href="#l3.29"></a><span id="l3.29">           &lt;/xul:box&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -1906,24 +1906,23 @@</span>
<a href="#l4.4"></a><span id="l4.4">                   &lt;xul:description anonid=&quot;event-name&quot; class=&quot;calendar-event-details-core&quot; flex=&quot;1&quot;/&gt;</span>
<a href="#l4.5"></a><span id="l4.5">                   &lt;xul:textbox anonid=&quot;event-name-textbox&quot;</span>
<a href="#l4.6"></a><span id="l4.6">                                class=&quot;plain calendar-event-details-core calendar-event-name-textbox&quot;</span>
<a href="#l4.7"></a><span id="l4.7">                                flex=&quot;1&quot;</span>
<a href="#l4.8"></a><span id="l4.8">                                hidden=&quot;true&quot;</span>
<a href="#l4.9"></a><span id="l4.9">                                wrap=&quot;true&quot;/&gt;</span>
<a href="#l4.10"></a><span id="l4.10">                 &lt;/xul:vbox&gt;</span>
<a href="#l4.11"></a><span id="l4.11">                 &lt;xul:hbox pack=&quot;end&quot;&gt;</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-                  &lt;xul:hbox align=&quot;start&quot;&gt;</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineminus">-                    &lt;xul:image anonid=&quot;alarm-image&quot;</span>
<a href="#l4.14"></a><span id="l4.14" class="difflineminus">-                               class=&quot;alarm-image&quot;</span>
<a href="#l4.15"></a><span id="l4.15" class="difflineminus">-                               xbl:inherits=&quot;flashing&quot;</span>
<a href="#l4.16"></a><span id="l4.16" class="difflineminus">-                               hidden=&quot;true&quot;/&gt;</span>
<a href="#l4.17"></a><span id="l4.17" class="difflineminus">-                   &lt;/xul:hbox&gt;</span>
<a href="#l4.18"></a><span id="l4.18" class="difflineplus">+                   &lt;xul:hbox anonid=&quot;alarm-icons-box&quot;</span>
<a href="#l4.19"></a><span id="l4.19" class="difflineplus">+                             class=&quot;alarm-icons-box&quot;</span>
<a href="#l4.20"></a><span id="l4.20" class="difflineplus">+                             pack=&quot;end&quot;</span>
<a href="#l4.21"></a><span id="l4.21" class="difflineplus">+                             align=&quot;top&quot;</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineplus">+                             xbl:inherits=&quot;flashing&quot;/&gt;</span>
<a href="#l4.23"></a><span id="l4.23">                    &lt;xul:calendar-category-box anonid=&quot;category-box&quot; xbl:inherits=&quot;categories&quot; pack=&quot;end&quot;/&gt;</span>
<a href="#l4.24"></a><span id="l4.24" class="difflineminus">-                 &lt;/xul:hbox&gt;</span>
<a href="#l4.25"></a><span id="l4.25" class="difflineplus">+                &lt;/xul:hbox&gt;</span>
<a href="#l4.26"></a><span id="l4.26">                 &lt;xul:box xbl:inherits=&quot;orient&quot;&gt;</span>
<a href="#l4.27"></a><span id="l4.27">                   &lt;xul:calendar-event-gripbar anonid=&quot;gripbar1&quot;</span>
<a href="#l4.28"></a><span id="l4.28">                                               class=&quot;calendar-event-box-grippy-top&quot;</span>
<a href="#l4.29"></a><span id="l4.29">                                               whichside=&quot;start&quot;</span>
<a href="#l4.30"></a><span id="l4.30">                                               xbl:inherits=&quot;parentorient=orient&quot;/&gt;</span>
<a href="#l4.31"></a><span id="l4.31">                   &lt;xul:spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l4.32"></a><span id="l4.32">                   &lt;xul:calendar-event-gripbar anonid=&quot;gripbar2&quot;</span>
<a href="#l4.33"></a><span id="l4.33">                                               class=&quot;calendar-event-box-grippy-bottom&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/content/calendar-summary-dialog.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/content/calendar-summary-dialog.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -105,17 +105,17 @@ function onLoad() {</span>
<a href="#l5.4"></a><span id="l5.4"> </span>
<a href="#l5.5"></a><span id="l5.5">     // show reminder if this item is *not* readonly.</span>
<a href="#l5.6"></a><span id="l5.6">     // this case happens for example if this is an invitation.</span>
<a href="#l5.7"></a><span id="l5.7">     var calendar = window.arguments[0].calendarEvent.calendar;</span>
<a href="#l5.8"></a><span id="l5.8">     var supportsReminders =</span>
<a href="#l5.9"></a><span id="l5.9">         (calendar.getProperty(&quot;capabilities.alarms.oninvitations.supported&quot;) !== false);</span>
<a href="#l5.10"></a><span id="l5.10">     if (!window.readOnly &amp;&amp; supportsReminders) {</span>
<a href="#l5.11"></a><span id="l5.11">         document.getElementById(&quot;reminder-row&quot;).removeAttribute(&quot;hidden&quot;);</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-        loadReminder(window.item);</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+        loadReminders(window.item.getAlarms({}));</span>
<a href="#l5.14"></a><span id="l5.14">         updateReminderDetails();</span>
<a href="#l5.15"></a><span id="l5.15">     }</span>
<a href="#l5.16"></a><span id="l5.16"> </span>
<a href="#l5.17"></a><span id="l5.17">     updateRepeatDetails();</span>
<a href="#l5.18"></a><span id="l5.18">     updateAttendees();</span>
<a href="#l5.19"></a><span id="l5.19">     updateLink();</span>
<a href="#l5.20"></a><span id="l5.20"> </span>
<a href="#l5.21"></a><span id="l5.21">     var location = item.getProperty(&quot;LOCATION&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/content/calendar-view-core.xml</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/content/calendar-view-core.xml</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -71,36 +71,36 @@</span>
<a href="#l6.4"></a><span id="l6.4">                     &lt;xul:textbox anonid=&quot;event-name-textbox&quot;</span>
<a href="#l6.5"></a><span id="l6.5">                                  class=&quot;plain&quot;</span>
<a href="#l6.6"></a><span id="l6.6">                                  crop=&quot;end&quot;</span>
<a href="#l6.7"></a><span id="l6.7">                                  hidden=&quot;true&quot;</span>
<a href="#l6.8"></a><span id="l6.8">                                  style=&quot;background: transparent !important;&quot;</span>
<a href="#l6.9"></a><span id="l6.9">                                  wrap=&quot;true&quot;/&gt;</span>
<a href="#l6.10"></a><span id="l6.10">                     &lt;xul:spacer flex=&quot;1&quot;/&gt;</span>
<a href="#l6.11"></a><span id="l6.11">                   &lt;/xul:vbox&gt;</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-                  &lt;xul:vbox pack=&quot;center&quot;&gt;</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineminus">-                    &lt;xul:image anonid=&quot;alarm-image&quot;</span>
<a href="#l6.14"></a><span id="l6.14" class="difflineminus">-                               class=&quot;alarm-image&quot;</span>
<a href="#l6.15"></a><span id="l6.15" class="difflineminus">-                               xbl:inherits=&quot;flashing&quot;</span>
<a href="#l6.16"></a><span id="l6.16" class="difflineminus">-                               hidden=&quot;true&quot;/&gt;</span>
<a href="#l6.17"></a><span id="l6.17" class="difflineminus">-                  &lt;/xul:vbox&gt;</span>
<a href="#l6.18"></a><span id="l6.18" class="difflineplus">+                  &lt;xul:hbox anonid=&quot;alarm-icons-box&quot;</span>
<a href="#l6.19"></a><span id="l6.19" class="difflineplus">+                            class=&quot;alarm-icons-box&quot;</span>
<a href="#l6.20"></a><span id="l6.20" class="difflineplus">+                            align=&quot;center&quot;</span>
<a href="#l6.21"></a><span id="l6.21" class="difflineplus">+                            xbl:inherits=&quot;flashing&quot;/&gt;</span>
<a href="#l6.22"></a><span id="l6.22">                 &lt;/xul:hbox&gt;</span>
<a href="#l6.23"></a><span id="l6.23">                 &lt;xul:image anonid=&quot;gradient&quot;</span>
<a href="#l6.24"></a><span id="l6.24">                            class=&quot;calendar-event-box-gradient&quot;</span>
<a href="#l6.25"></a><span id="l6.25">                            height=&quot;1px&quot;/&gt;</span>
<a href="#l6.26"></a><span id="l6.26">               &lt;/xul:stack&gt;</span>
<a href="#l6.27"></a><span id="l6.27">             &lt;/xul:box&gt;</span>
<a href="#l6.28"></a><span id="l6.28">             &lt;xul:calendar-category-box anonid=&quot;category-box&quot; xbl:inherits=&quot;categories&quot;/&gt;</span>
<a href="#l6.29"></a><span id="l6.29">           &lt;/xul:box&gt;</span>
<a href="#l6.30"></a><span id="l6.30">         &lt;/xul:hbox&gt;</span>
<a href="#l6.31"></a><span id="l6.31">       &lt;/xul:vbox&gt;</span>
<a href="#l6.32"></a><span id="l6.32">     &lt;/content&gt;</span>
<a href="#l6.33"></a><span id="l6.33"> </span>
<a href="#l6.34"></a><span id="l6.34">     &lt;implementation&gt;</span>
<a href="#l6.35"></a><span id="l6.35">       &lt;constructor&gt;&lt;![CDATA[</span>
<a href="#l6.36"></a><span id="l6.36" class="difflineplus">+         Components.utils.import(&quot;resource://calendar/modules/calAlarmUtils.jsm&quot;);</span>
<a href="#l6.37"></a><span id="l6.37" class="difflineplus">+</span>
<a href="#l6.38"></a><span id="l6.38">          var self = this;</span>
<a href="#l6.39"></a><span id="l6.39">          this.eventNameInput.onblur = function onBlur() { self.stopEditing(true); };</span>
<a href="#l6.40"></a><span id="l6.40">          this.eventNameInput.onkeypress = function onKeyPress(event) {</span>
<a href="#l6.41"></a><span id="l6.41">              // save on enter</span>
<a href="#l6.42"></a><span id="l6.42">              if (event.keyCode == 13)</span>
<a href="#l6.43"></a><span id="l6.43">                  self.stopEditing(true);</span>
<a href="#l6.44"></a><span id="l6.44">              // abort on escape</span>
<a href="#l6.45"></a><span id="l6.45">              else if (event.keyCode == 27)</span>
<a href="#l6.46"></a><span id="l6.46" class="difflineat">@@ -186,28 +186,25 @@</span>
<a href="#l6.47"></a><span id="l6.47">           var item = this.mOccurrence;          </span>
<a href="#l6.48"></a><span id="l6.48">           this.setAttribute(&quot;item-calendar&quot;, item.calendar.uri.spec);</span>
<a href="#l6.49"></a><span id="l6.49">           var categoriesArray = item.getCategories({});</span>
<a href="#l6.50"></a><span id="l6.50">           if (categoriesArray.length &gt; 0) {</span>
<a href="#l6.51"></a><span id="l6.51">             var cssClassesArray = categoriesArray.map(formatStringForCSSRule);</span>
<a href="#l6.52"></a><span id="l6.52">             this.setAttribute(&quot;categories&quot;, cssClassesArray.join(&quot; &quot;));</span>
<a href="#l6.53"></a><span id="l6.53">           }</span>
<a href="#l6.54"></a><span id="l6.54"> </span>
<a href="#l6.55"></a><span id="l6.55" class="difflineminus">-          if (item.getAlarms({}).length &amp;&amp; getPrefSafe(&quot;calendar.alarms.indicator.show&quot;, true)) {</span>
<a href="#l6.56"></a><span id="l6.56" class="difflineminus">-              var alarmImage = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;alarm-image&quot;);</span>
<a href="#l6.57"></a><span id="l6.57" class="difflineminus">-              if (item.calendar.getProperty(&quot;suppressAlarms&quot;) &amp;&amp;</span>
<a href="#l6.58"></a><span id="l6.58" class="difflineminus">-                  item.calendar.getProperty(&quot;capabilities.alarms.popup.supported&quot;) !== false) {</span>
<a href="#l6.59"></a><span id="l6.59" class="difflineminus">-                  // Only show the suppressed icon if alarms are suppressed and</span>
<a href="#l6.60"></a><span id="l6.60" class="difflineminus">-                  // popup alarms are supported. This keeps us from making the</span>
<a href="#l6.61"></a><span id="l6.61" class="difflineminus">-                  // alarm look disabled when the server supports only email</span>
<a href="#l6.62"></a><span id="l6.62" class="difflineminus">-                  // alarms (e.g. currently WCAP).</span>
<a href="#l6.63"></a><span id="l6.63" class="difflineminus">-                  alarmImage.setAttribute(&quot;suppressed&quot;, &quot;true&quot;);</span>
<a href="#l6.64"></a><span id="l6.64" class="difflineminus">-              }</span>
<a href="#l6.65"></a><span id="l6.65" class="difflineminus">-              alarmImage.removeAttribute(&quot;hidden&quot;);</span>
<a href="#l6.66"></a><span id="l6.66" class="difflineminus">-          }</span>
<a href="#l6.67"></a><span id="l6.67" class="difflineplus">+          // Add alarm icons as needed. Also add parent item alarms in case this is an occurrence.</span>
<a href="#l6.68"></a><span id="l6.68" class="difflineplus">+          let alarms = item.getAlarms({}).concat(item.parentItem.getAlarms({}));</span>
<a href="#l6.69"></a><span id="l6.69" class="difflineplus">+          let iconsBox = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;alarm-icons-box&quot;);</span>
<a href="#l6.70"></a><span id="l6.70" class="difflineplus">+          cal.alarms.addReminderImages(iconsBox, alarms);</span>
<a href="#l6.71"></a><span id="l6.71" class="difflineplus">+</span>
<a href="#l6.72"></a><span id="l6.72" class="difflineplus">+          // Set suppressed status on the icons box</span>
<a href="#l6.73"></a><span id="l6.73" class="difflineplus">+          setElementValue(iconsBox,</span>
<a href="#l6.74"></a><span id="l6.74" class="difflineplus">+                          item.calendar.getProperty(&quot;suppressAlarms&quot;) || false,</span>
<a href="#l6.75"></a><span id="l6.75" class="difflineplus">+                          &quot;suppressed&quot;);</span>
<a href="#l6.76"></a><span id="l6.76"> </span>
<a href="#l6.77"></a><span id="l6.77">           // Set up event box attributes for use in css selectors. Note if</span>
<a href="#l6.78"></a><span id="l6.78">           // something is added here, it should also be xbl:inherited correctly</span>
<a href="#l6.79"></a><span id="l6.79">           // in the &lt;content&gt; section of this binding, and all that inherit it.</span>
<a href="#l6.80"></a><span id="l6.80"> </span>
<a href="#l6.81"></a><span id="l6.81">           // Event type specific properties</span>
<a href="#l6.82"></a><span id="l6.82">           if (isEvent(item)) {</span>
<a href="#l6.83"></a><span id="l6.83">               if (item.startDate.isDate) {</span>
<a href="#l6.84"></a><span id="l6.84" class="difflineat">@@ -218,17 +215,17 @@</span>
<a href="#l6.85"></a><span id="l6.85">               this.setAttribute(&quot;progress&quot;, getProgressAtom(item));</span>
<a href="#l6.86"></a><span id="l6.86">           }</span>
<a href="#l6.87"></a><span id="l6.87"> </span>
<a href="#l6.88"></a><span id="l6.88">           if (this.calendarView &amp;&amp;</span>
<a href="#l6.89"></a><span id="l6.89">               item.hashId in this.calendarView.mFlashingEvents) {</span>
<a href="#l6.90"></a><span id="l6.90">               this.setAttribute(&quot;flashing&quot;, &quot;true&quot;);</span>
<a href="#l6.91"></a><span id="l6.91">           }</span>
<a href="#l6.92"></a><span id="l6.92"> </span>
<a href="#l6.93"></a><span id="l6.93" class="difflineminus">-          if (item.getAlarms({}).length) {</span>
<a href="#l6.94"></a><span id="l6.94" class="difflineplus">+          if (alarms.length) {</span>
<a href="#l6.95"></a><span id="l6.95">               this.setAttribute(&quot;alarm&quot;, &quot;true&quot;)</span>
<a href="#l6.96"></a><span id="l6.96">           }</span>
<a href="#l6.97"></a><span id="l6.97"> </span>
<a href="#l6.98"></a><span id="l6.98">           // priority</span>
<a href="#l6.99"></a><span id="l6.99">           if (item.priority &gt; 0 &amp;&amp; item.priority &lt; 5) {</span>
<a href="#l6.100"></a><span id="l6.100">               this.setAttribute(&quot;priority&quot;, &quot;high&quot;);</span>
<a href="#l6.101"></a><span id="l6.101">           } else if (item.priority &gt; 5 &amp;&amp; item.priority &lt; 10) {</span>
<a href="#l6.102"></a><span id="l6.102">               this.setAttribute(&quot;priority&quot;, &quot;low&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-reminder.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-reminder.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -29,281 +29,432 @@</span>
<a href="#l7.4"></a><span id="l7.4">  * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l7.5"></a><span id="l7.5">  * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l7.6"></a><span id="l7.6">  * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l7.7"></a><span id="l7.7">  * the provisions above, a recipient may use your version of this file under</span>
<a href="#l7.8"></a><span id="l7.8">  * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l7.9"></a><span id="l7.9">  *</span>
<a href="#l7.10"></a><span id="l7.10">  * ***** END LICENSE BLOCK ***** */</span>
<a href="#l7.11"></a><span id="l7.11"> </span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-function onLoad() {</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineminus">-    var args = window.arguments[0];</span>
<a href="#l7.14"></a><span id="l7.14" class="difflineminus">-    window.onAcceptCallback = args.onOk;</span>
<a href="#l7.15"></a><span id="l7.15" class="difflineplus">+Components.utils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l7.16"></a><span id="l7.16" class="difflineplus">+Components.utils.import(&quot;resource://calendar/modules/calIteratorUtils.jsm&quot;);</span>
<a href="#l7.17"></a><span id="l7.17" class="difflineplus">+Components.utils.import(&quot;resource://gre/modules/PluralForm.jsm&quot;);</span>
<a href="#l7.18"></a><span id="l7.18" class="difflineplus">+</span>
<a href="#l7.19"></a><span id="l7.19" class="difflineplus">+let allowedActionsMap = {}; </span>
<a href="#l7.20"></a><span id="l7.20"> </span>
<a href="#l7.21"></a><span id="l7.21" class="difflineminus">-    // set the current date/time for the duedate control.</span>
<a href="#l7.22"></a><span id="l7.22" class="difflineminus">-    // this is just a placeholder until we support absolute reminders.</span>
<a href="#l7.23"></a><span id="l7.23" class="difflineminus">-    var duedate = document.getElementById(&quot;reminder-duetime&quot;);</span>
<a href="#l7.24"></a><span id="l7.24" class="difflineminus">-    duedate.value = new Date();</span>
<a href="#l7.25"></a><span id="l7.25" class="difflineminus">-</span>
<a href="#l7.26"></a><span id="l7.26" class="difflineminus">-    // load the reminders from preferences</span>
<a href="#l7.27"></a><span id="l7.27" class="difflineminus">-    var reminders = loadReminders();</span>
<a href="#l7.28"></a><span id="l7.28" class="difflineplus">+/**</span>
<a href="#l7.29"></a><span id="l7.29" class="difflineplus">+ * Sets up the reminder dialog.</span>
<a href="#l7.30"></a><span id="l7.30" class="difflineplus">+ */</span>
<a href="#l7.31"></a><span id="l7.31" class="difflineplus">+function onLoad() {</span>
<a href="#l7.32"></a><span id="l7.32" class="difflineplus">+    let calendar = window.arguments[0].calendar;</span>
<a href="#l7.33"></a><span id="l7.33"> </span>
<a href="#l7.34"></a><span id="l7.34" class="difflineminus">-    // check if a possibly incoming reminder object matches</span>
<a href="#l7.35"></a><span id="l7.35" class="difflineminus">-    // the ones we already know about...</span>
<a href="#l7.36"></a><span id="l7.36" class="difflineminus">-    var incoming = args.reminder;</span>
<a href="#l7.37"></a><span id="l7.37" class="difflineminus">-    var selectedIndex = -1;</span>
<a href="#l7.38"></a><span id="l7.38" class="difflineminus">-    if (incoming) {</span>
<a href="#l7.39"></a><span id="l7.39" class="difflineminus">-        for (var i = 0; i &lt; reminders.length; i++) {</span>
<a href="#l7.40"></a><span id="l7.40" class="difflineminus">-            var reminder = reminders[i];</span>
<a href="#l7.41"></a><span id="l7.41" class="difflineminus">-            if (reminder.relation == incoming.relation &amp;&amp;</span>
<a href="#l7.42"></a><span id="l7.42" class="difflineminus">-                reminder.length == incoming.length &amp;&amp;</span>
<a href="#l7.43"></a><span id="l7.43" class="difflineminus">-                reminder.unit == incoming.unit) {</span>
<a href="#l7.44"></a><span id="l7.44" class="difflineminus">-                selectedIndex = i;</span>
<a href="#l7.45"></a><span id="l7.45" class="difflineminus">-                break;</span>
<a href="#l7.46"></a><span id="l7.46" class="difflineminus">-            }</span>
<a href="#l7.47"></a><span id="l7.47" class="difflineminus">-        }</span>
<a href="#l7.48"></a><span id="l7.48" class="difflineplus">+    // Make sure the origin menulist uses the right labels, depending on if the</span>
<a href="#l7.49"></a><span id="l7.49" class="difflineplus">+    // dialog is showing an event or task.</span>
<a href="#l7.50"></a><span id="l7.50" class="difflineplus">+    document.getElementById(&quot;reminder-origin-start-menuitem&quot;)</span>
<a href="#l7.51"></a><span id="l7.51" class="difflineplus">+            .setAttribute(&quot;label&quot;, calGetString(&quot;calendar-alarms&quot;,</span>
<a href="#l7.52"></a><span id="l7.52" class="difflineplus">+                                                getItemBundleStringName(&quot;reminderDialogOriginBegin&quot;)));</span>
<a href="#l7.53"></a><span id="l7.53" class="difflineplus">+    document.getElementById(&quot;reminder-origin-end-menuitem&quot;)</span>
<a href="#l7.54"></a><span id="l7.54" class="difflineplus">+            .setAttribute(&quot;label&quot;, calGetString(&quot;calendar-alarms&quot;,</span>
<a href="#l7.55"></a><span id="l7.55" class="difflineplus">+                                                getItemBundleStringName(&quot;reminderDialogOriginEnd&quot;)));</span>
<a href="#l7.56"></a><span id="l7.56"> </span>
<a href="#l7.57"></a><span id="l7.57" class="difflineminus">-        // if we didn't find a match, we append the unknown</span>
<a href="#l7.58"></a><span id="l7.58" class="difflineminus">-        // reminder to the array of custom reminders.</span>
<a href="#l7.59"></a><span id="l7.59" class="difflineminus">-        if (selectedIndex &lt; 0) {</span>
<a href="#l7.60"></a><span id="l7.60" class="difflineminus">-            reminders.push(incoming);</span>
<a href="#l7.61"></a><span id="l7.61" class="difflineminus">-            selectedIndex = reminders.length - 1;</span>
<a href="#l7.62"></a><span id="l7.62" class="difflineplus">+    // Set up the action map</span>
<a href="#l7.63"></a><span id="l7.63" class="difflineplus">+    let supportedActions = calendar.getProperty(&quot;capabilities.alarms.actionValues&quot;) ||</span>
<a href="#l7.64"></a><span id="l7.64" class="difflineplus">+                           [&quot;DISPLAY&quot; /* TODO email support, &quot;EMAIL&quot; */];</span>
<a href="#l7.65"></a><span id="l7.65" class="difflineplus">+    for each (let action in supportedActions) {</span>
<a href="#l7.66"></a><span id="l7.66" class="difflineplus">+        allowedActionsMap[action] = true;</span>
<a href="#l7.67"></a><span id="l7.67" class="difflineplus">+    }</span>
<a href="#l7.68"></a><span id="l7.68" class="difflineplus">+</span>
<a href="#l7.69"></a><span id="l7.69" class="difflineplus">+    // Hide all actions that are not supported by this provider</span>
<a href="#l7.70"></a><span id="l7.70" class="difflineplus">+    let firstAvailableItem;</span>
<a href="#l7.71"></a><span id="l7.71" class="difflineplus">+    let actionNodes = document.getElementById(&quot;reminder-actions-menupopup&quot;).childNodes;</span>
<a href="#l7.72"></a><span id="l7.72" class="difflineplus">+    for each (let actionNode in Array.slice(actionNodes)) {</span>
<a href="#l7.73"></a><span id="l7.73" class="difflineplus">+        let shouldHide = (!(actionNode.value in allowedActionsMap) ||</span>
<a href="#l7.74"></a><span id="l7.74" class="difflineplus">+                          (actionNode.hasAttribute(&quot;provider&quot;) &amp;&amp;</span>
<a href="#l7.75"></a><span id="l7.75" class="difflineplus">+                           actionNode.getAttribute(&quot;provider&quot;) != calendar.type));</span>
<a href="#l7.76"></a><span id="l7.76" class="difflineplus">+        setElementValue(actionNode, shouldHide &amp;&amp; &quot;true&quot;, &quot;hidden&quot;);</span>
<a href="#l7.77"></a><span id="l7.77" class="difflineplus">+        if (!firstAvailableItem &amp;&amp; !shouldHide) {</span>
<a href="#l7.78"></a><span id="l7.78" class="difflineplus">+            firstAvailableItem = actionNode;</span>
<a href="#l7.79"></a><span id="l7.79">         }</span>
<a href="#l7.80"></a><span id="l7.80">     }</span>
<a href="#l7.81"></a><span id="l7.81"> </span>
<a href="#l7.82"></a><span id="l7.82" class="difflineminus">-    var listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l7.83"></a><span id="l7.83" class="difflineminus">-    while (listbox.childNodes.length &gt; reminders.length) {</span>
<a href="#l7.84"></a><span id="l7.84" class="difflineminus">-        listbox.removeChild(listbox.lastChild);</span>
<a href="#l7.85"></a><span id="l7.85" class="difflineminus">-    }</span>
<a href="#l7.86"></a><span id="l7.86" class="difflineminus">-    var numChilds = listbox.childNodes.length;</span>
<a href="#l7.87"></a><span id="l7.87" class="difflineminus">-    for (var i = 0; i &lt; reminders.length; i++) {</span>
<a href="#l7.88"></a><span id="l7.88" class="difflineminus">-        if (i &gt;= numChilds) {</span>
<a href="#l7.89"></a><span id="l7.89" class="difflineminus">-            var newNode = listbox.childNodes[0].cloneNode(true);</span>
<a href="#l7.90"></a><span id="l7.90" class="difflineminus">-            listbox.appendChild(newNode);</span>
<a href="#l7.91"></a><span id="l7.91" class="difflineminus">-        }</span>
<a href="#l7.92"></a><span id="l7.92" class="difflineminus">-        var node = listbox.childNodes[i];</span>
<a href="#l7.93"></a><span id="l7.93" class="difflineminus">-        var reminder = reminders[i];</span>
<a href="#l7.94"></a><span id="l7.94" class="difflineminus">-        var details = stringFromReminderObject(reminder);</span>
<a href="#l7.95"></a><span id="l7.95" class="difflineminus">-        node.setAttribute('label', details);</span>
<a href="#l7.96"></a><span id="l7.96" class="difflineminus">-        node.reminder = reminder;</span>
<a href="#l7.97"></a><span id="l7.97" class="difflineplus">+    // Correct the selected item on the supported actions list. This will be</span>
<a href="#l7.98"></a><span id="l7.98" class="difflineplus">+    // changed when reminders are loaded, but in case there are none we need to</span>
<a href="#l7.99"></a><span id="l7.99" class="difflineplus">+    // provide a sensible default.</span>
<a href="#l7.100"></a><span id="l7.100" class="difflineplus">+    if (firstAvailableItem) {</span>
<a href="#l7.101"></a><span id="l7.101" class="difflineplus">+        document.getElementById(&quot;reminder-actions-menulist&quot;).selectedItem = firstAvailableItem;</span>
<a href="#l7.102"></a><span id="l7.102">     }</span>
<a href="#l7.103"></a><span id="l7.103"> </span>
<a href="#l7.104"></a><span id="l7.104" class="difflineminus">-    if (selectedIndex &lt; 0) {</span>
<a href="#l7.105"></a><span id="l7.105" class="difflineminus">-        selectedIndex = 0;</span>
<a href="#l7.106"></a><span id="l7.106" class="difflineminus">-    }</span>
<a href="#l7.107"></a><span id="l7.107" class="difflineminus">-    listbox.selectedIndex = selectedIndex;</span>
<a href="#l7.108"></a><span id="l7.108" class="difflineminus">-</span>
<a href="#l7.109"></a><span id="l7.109" class="difflineplus">+    loadReminders();</span>
<a href="#l7.110"></a><span id="l7.110">     opener.setCursor(&quot;auto&quot;);</span>
<a href="#l7.111"></a><span id="l7.111"> }</span>
<a href="#l7.112"></a><span id="l7.112"> </span>
<a href="#l7.113"></a><span id="l7.113" class="difflineminus">-function stringFromReminderObject(reminder) {</span>
<a href="#l7.114"></a><span id="l7.114" class="difflineminus">-    var sbs = Components.classes[&quot;@mozilla.org/intl/stringbundle;1&quot;]</span>
<a href="#l7.115"></a><span id="l7.115" class="difflineminus">-              .getService(Components.interfaces.nsIStringBundleService);</span>
<a href="#l7.116"></a><span id="l7.116" class="difflineminus">-</span>
<a href="#l7.117"></a><span id="l7.117" class="difflineminus">-    var props =</span>
<a href="#l7.118"></a><span id="l7.118" class="difflineminus">-        sbs.createBundle(</span>
<a href="#l7.119"></a><span id="l7.119" class="difflineminus">-            &quot;chrome://calendar/locale/calendar-event-dialog.properties&quot;);</span>
<a href="#l7.120"></a><span id="l7.120" class="difflineminus">-</span>
<a href="#l7.121"></a><span id="l7.121" class="difflineminus">-    var unitString;</span>
<a href="#l7.122"></a><span id="l7.122" class="difflineminus">-    switch (reminder.unit) {</span>
<a href="#l7.123"></a><span id="l7.123" class="difflineminus">-        case 'minutes':</span>
<a href="#l7.124"></a><span id="l7.124" class="difflineminus">-            unitString = Number(reminder.length) &lt;= 1 ?</span>
<a href="#l7.125"></a><span id="l7.125" class="difflineminus">-                props.GetStringFromName('reminderCustomUnitMinute') :</span>
<a href="#l7.126"></a><span id="l7.126" class="difflineminus">-                props.GetStringFromName('reminderCustomUnitMinutes');</span>
<a href="#l7.127"></a><span id="l7.127" class="difflineminus">-            break;</span>
<a href="#l7.128"></a><span id="l7.128" class="difflineminus">-        case 'hours':</span>
<a href="#l7.129"></a><span id="l7.129" class="difflineminus">-            unitString = Number(reminder.length) &lt;= 1 ?</span>
<a href="#l7.130"></a><span id="l7.130" class="difflineminus">-                props.GetStringFromName('reminderCustomUnitHour') :</span>
<a href="#l7.131"></a><span id="l7.131" class="difflineminus">-                props.GetStringFromName('reminderCustomUnitHours');</span>
<a href="#l7.132"></a><span id="l7.132" class="difflineminus">-            break;</span>
<a href="#l7.133"></a><span id="l7.133" class="difflineminus">-        case 'days':</span>
<a href="#l7.134"></a><span id="l7.134" class="difflineminus">-            unitString = Number(reminder.length) &lt;= 1 ?</span>
<a href="#l7.135"></a><span id="l7.135" class="difflineminus">-                props.GetStringFromName('reminderCustomUnitDay') :</span>
<a href="#l7.136"></a><span id="l7.136" class="difflineminus">-                props.GetStringFromName('reminderCustomUnitDays');</span>
<a href="#l7.137"></a><span id="l7.137" class="difflineminus">-            break;</span>
<a href="#l7.138"></a><span id="l7.138" class="difflineminus">-    }</span>
<a href="#l7.139"></a><span id="l7.139" class="difflineminus">-</span>
<a href="#l7.140"></a><span id="l7.140" class="difflineminus">-    var relationString;</span>
<a href="#l7.141"></a><span id="l7.141" class="difflineminus">-    switch (reminder.relation) {</span>
<a href="#l7.142"></a><span id="l7.142" class="difflineminus">-        case 'START':</span>
<a href="#l7.143"></a><span id="l7.143" class="difflineminus">-            relationString = props.GetStringFromName('reminderCustomRelationBefore');</span>
<a href="#l7.144"></a><span id="l7.144" class="difflineminus">-            break;</span>
<a href="#l7.145"></a><span id="l7.145" class="difflineminus">-        case 'END':</span>
<a href="#l7.146"></a><span id="l7.146" class="difflineminus">-            relationString = props.GetStringFromName('reminderCustomRelationAfter');</span>
<a href="#l7.147"></a><span id="l7.147" class="difflineminus">-            break;</span>
<a href="#l7.148"></a><span id="l7.148" class="difflineminus">-    }</span>
<a href="#l7.149"></a><span id="l7.149" class="difflineplus">+/**</span>
<a href="#l7.150"></a><span id="l7.150" class="difflineplus">+ * Load Reminders from the window's arguments and set up dialog controls to</span>
<a href="#l7.151"></a><span id="l7.151" class="difflineplus">+ * their initial values.</span>
<a href="#l7.152"></a><span id="l7.152" class="difflineplus">+ */</span>
<a href="#l7.153"></a><span id="l7.153" class="difflineplus">+function loadReminders() {</span>
<a href="#l7.154"></a><span id="l7.154" class="difflineplus">+    let args = window.arguments[0];</span>
<a href="#l7.155"></a><span id="l7.155" class="difflineplus">+    let listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l7.156"></a><span id="l7.156" class="difflineplus">+    let reminders = args.reminders || args.item.getAlarms({});</span>
<a href="#l7.157"></a><span id="l7.157"> </span>
<a href="#l7.158"></a><span id="l7.158" class="difflineminus">-    var originString;</span>
<a href="#l7.159"></a><span id="l7.159" class="difflineminus">-    if (reminder.origin &amp;&amp; reminder.origin &lt; 0) {</span>
<a href="#l7.160"></a><span id="l7.160" class="difflineminus">-        originString = props.GetStringFromName('reminderCustomOriginEndEvent');</span>
<a href="#l7.161"></a><span id="l7.161" class="difflineminus">-    } else {</span>
<a href="#l7.162"></a><span id="l7.162" class="difflineminus">-        originString = props.GetStringFromName('reminderCustomOriginBeginEvent');</span>
<a href="#l7.163"></a><span id="l7.163" class="difflineminus">-    }</span>
<a href="#l7.164"></a><span id="l7.164" class="difflineminus">-</span>
<a href="#l7.165"></a><span id="l7.165" class="difflineminus">-    return props.formatStringFromName('reminderCustomTitle',</span>
<a href="#l7.166"></a><span id="l7.166" class="difflineminus">-                                      [reminder.length,</span>
<a href="#l7.167"></a><span id="l7.167" class="difflineminus">-                                       unitString,</span>
<a href="#l7.168"></a><span id="l7.168" class="difflineminus">-                                       relationString,</span>
<a href="#l7.169"></a><span id="l7.169" class="difflineminus">-                                       originString],</span>
<a href="#l7.170"></a><span id="l7.170" class="difflineminus">-                                      4);</span>
<a href="#l7.171"></a><span id="l7.171" class="difflineminus">-}</span>
<a href="#l7.172"></a><span id="l7.172" class="difflineminus">-</span>
<a href="#l7.173"></a><span id="l7.173" class="difflineminus">-function loadReminders() {</span>
<a href="#l7.174"></a><span id="l7.174" class="difflineminus">-    var prefService = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l7.175"></a><span id="l7.175" class="difflineminus">-                      .getService(Components.interfaces.nsIPrefService);</span>
<a href="#l7.176"></a><span id="l7.176" class="difflineminus">-    var prefBranch = prefService.getBranch(&quot;calendar.reminder.&quot;);</span>
<a href="#l7.177"></a><span id="l7.177" class="difflineminus">-</span>
<a href="#l7.178"></a><span id="l7.178" class="difflineminus">-    var pref = &quot;length=15;unit=minutes;relation=START;origin=1,length=3;&quot; +</span>
<a href="#l7.179"></a><span id="l7.179" class="difflineminus">-               &quot;unit=hours;relation=START;origin=1&quot;;</span>
<a href="#l7.180"></a><span id="l7.180" class="difflineminus">-    try {</span>
<a href="#l7.181"></a><span id="l7.181" class="difflineminus">-        var newPref = prefBranch.getCharPref(&quot;custom&quot;);</span>
<a href="#l7.182"></a><span id="l7.182" class="difflineminus">-        if (newPref &amp;&amp; newPref != &quot;&quot;) {</span>
<a href="#l7.183"></a><span id="l7.183" class="difflineminus">-            pref = newPref;</span>
<a href="#l7.184"></a><span id="l7.184" class="difflineminus">-        }</span>
<a href="#l7.185"></a><span id="l7.185" class="difflineminus">-    } catch (ex) {</span>
<a href="#l7.186"></a><span id="l7.186" class="difflineminus">-    }</span>
<a href="#l7.187"></a><span id="l7.187" class="difflineminus">-</span>
<a href="#l7.188"></a><span id="l7.188" class="difflineminus">-    var reminderArray = [];</span>
<a href="#l7.189"></a><span id="l7.189" class="difflineminus">-    var reminders = pref.split(',');</span>
<a href="#l7.190"></a><span id="l7.190" class="difflineminus">-    for each (var reminder in reminders) {</span>
<a href="#l7.191"></a><span id="l7.191" class="difflineminus">-        if (reminder.indexOf(';') &gt;= 0) {</span>
<a href="#l7.192"></a><span id="l7.192" class="difflineminus">-            var object = {};</span>
<a href="#l7.193"></a><span id="l7.193" class="difflineminus">-            var attributes = reminder.split(';');</span>
<a href="#l7.194"></a><span id="l7.194" class="difflineminus">-            for each (var attribute in attributes) {</span>
<a href="#l7.195"></a><span id="l7.195" class="difflineminus">-                var index = attribute.indexOf('=');</span>
<a href="#l7.196"></a><span id="l7.196" class="difflineminus">-                if (index &gt; 0) {</span>
<a href="#l7.197"></a><span id="l7.197" class="difflineminus">-                    var key = attribute.substring(0, index);</span>
<a href="#l7.198"></a><span id="l7.198" class="difflineminus">-                    var value = attribute.substring(index + 1,</span>
<a href="#l7.199"></a><span id="l7.199" class="difflineminus">-                                                    attribute.length);</span>
<a href="#l7.200"></a><span id="l7.200" class="difflineminus">-                    object[key] = value;</span>
<a href="#l7.201"></a><span id="l7.201" class="difflineminus">-                }</span>
<a href="#l7.202"></a><span id="l7.202" class="difflineminus">-            }</span>
<a href="#l7.203"></a><span id="l7.203" class="difflineminus">-            reminderArray.push(object);</span>
<a href="#l7.204"></a><span id="l7.204" class="difflineplus">+    // This dialog should not be shown if the calendar doesn't support alarms at</span>
<a href="#l7.205"></a><span id="l7.205" class="difflineplus">+    // all, so the case of maxCount = 0 breaking this logic doesn't apply.</span>
<a href="#l7.206"></a><span id="l7.206" class="difflineplus">+    let maxReminders = args.calendar.getProperty(&quot;capabilities.alarms.maxCount&quot;);</span>
<a href="#l7.207"></a><span id="l7.207" class="difflineplus">+    let count = Math.min(reminders.length, maxReminders || reminders.length);</span>
<a href="#l7.208"></a><span id="l7.208" class="difflineplus">+    for (let i = 0; i &lt; count; i++) {</span>
<a href="#l7.209"></a><span id="l7.209" class="difflineplus">+        if (reminders[i].action in allowedActionsMap) {</span>
<a href="#l7.210"></a><span id="l7.210" class="difflineplus">+            // Set up the listitem and add it to the listbox, but only if the</span>
<a href="#l7.211"></a><span id="l7.211" class="difflineplus">+            // action is actually supported by the calendar.</span>
<a href="#l7.212"></a><span id="l7.212" class="difflineplus">+            listbox.appendChild(setupListItem(null, reminders[i].clone(), args.item));</span>
<a href="#l7.213"></a><span id="l7.213">         }</span>
<a href="#l7.214"></a><span id="l7.214">     }</span>
<a href="#l7.215"></a><span id="l7.215"> </span>
<a href="#l7.216"></a><span id="l7.216" class="difflineminus">-    return reminderArray;</span>
<a href="#l7.217"></a><span id="l7.217" class="difflineplus">+    // Set up a default absolute date. This will be overridden if the selected</span>
<a href="#l7.218"></a><span id="l7.218" class="difflineplus">+    // alarm is absolute.</span>
<a href="#l7.219"></a><span id="l7.219" class="difflineplus">+    let absDate = document.getElementById(&quot;reminder-absolute-date&quot;);</span>
<a href="#l7.220"></a><span id="l7.220" class="difflineplus">+    absDate.value = getDefaultStartDate().jsDate;</span>
<a href="#l7.221"></a><span id="l7.221" class="difflineplus">+</span>
<a href="#l7.222"></a><span id="l7.222" class="difflineplus">+    if (listbox.childNodes.length) {</span>
<a href="#l7.223"></a><span id="l7.223" class="difflineplus">+        // We have reminders, select the first by default. For some reason,</span>
<a href="#l7.224"></a><span id="l7.224" class="difflineplus">+        // setting the selected index in a load handler makes the selection</span>
<a href="#l7.225"></a><span id="l7.225" class="difflineplus">+        // break for the set item, therefore we need a setTimeout.</span>
<a href="#l7.226"></a><span id="l7.226" class="difflineplus">+        setupMaxReminders();</span>
<a href="#l7.227"></a><span id="l7.227" class="difflineplus">+        setTimeout(function() { listbox.selectedIndex = 0; }, 0);</span>
<a href="#l7.228"></a><span id="l7.228" class="difflineplus">+    } else {</span>
<a href="#l7.229"></a><span id="l7.229" class="difflineplus">+        // Make sure the fields are disabled if we have no alarms</span>
<a href="#l7.230"></a><span id="l7.230" class="difflineplus">+        setupRadioEnabledState(true);</span>
<a href="#l7.231"></a><span id="l7.231" class="difflineplus">+    }</span>
<a href="#l7.232"></a><span id="l7.232"> }</span>
<a href="#l7.233"></a><span id="l7.233"> </span>
<a href="#l7.234"></a><span id="l7.234" class="difflineminus">-function saveReminders(reminderArray) {</span>
<a href="#l7.235"></a><span id="l7.235" class="difflineminus">-    var prefService = Components.classes[&quot;@mozilla.org/preferences-service;1&quot;]</span>
<a href="#l7.236"></a><span id="l7.236" class="difflineminus">-                      .getService(Components.interfaces.nsIPrefService);</span>
<a href="#l7.237"></a><span id="l7.237" class="difflineminus">-    var prefBranch = prefService.getBranch(&quot;calendar.reminder.&quot;);</span>
<a href="#l7.238"></a><span id="l7.238" class="difflineplus">+/**</span>
<a href="#l7.239"></a><span id="l7.239" class="difflineplus">+ * Sets up the enabled state of the reminder details controls. Used when</span>
<a href="#l7.240"></a><span id="l7.240" class="difflineplus">+ * switching between absolute and relative alarms to disable and enable the</span>
<a href="#l7.241"></a><span id="l7.241" class="difflineplus">+ * needed controls.</span>
<a href="#l7.242"></a><span id="l7.242" class="difflineplus">+ *</span>
<a href="#l7.243"></a><span id="l7.243" class="difflineplus">+ * @param aDisableAll       Disable all relation controls. Used when no alarms</span>
<a href="#l7.244"></a><span id="l7.244" class="difflineplus">+ *                            are added yet.</span>
<a href="#l7.245"></a><span id="l7.245" class="difflineplus">+ */</span>
<a href="#l7.246"></a><span id="l7.246" class="difflineplus">+function setupRadioEnabledState(aDisableAll) {</span>
<a href="#l7.247"></a><span id="l7.247" class="difflineplus">+    let relationItem = document.getElementById(&quot;reminder-relation-radiogroup&quot;).selectedItem;</span>
<a href="#l7.248"></a><span id="l7.248" class="difflineplus">+    let relativeDisabled, absoluteDisabled;</span>
<a href="#l7.249"></a><span id="l7.249"> </span>
<a href="#l7.250"></a><span id="l7.250" class="difflineminus">-    var result = &quot;&quot;;</span>
<a href="#l7.251"></a><span id="l7.251" class="difflineminus">-    for each (var reminder in reminderArray) {</span>
<a href="#l7.252"></a><span id="l7.252" class="difflineminus">-        for (var key in reminder) {</span>
<a href="#l7.253"></a><span id="l7.253" class="difflineminus">-            result += key + '=' + reminder[key] + ';';</span>
<a href="#l7.254"></a><span id="l7.254" class="difflineminus">-        }</span>
<a href="#l7.255"></a><span id="l7.255" class="difflineminus">-        if (result.length &amp;&amp; result[result.length - 1] == ';') {</span>
<a href="#l7.256"></a><span id="l7.256" class="difflineminus">-            result = result.substr(0, result.length - 1);</span>
<a href="#l7.257"></a><span id="l7.257" class="difflineminus">-        }</span>
<a href="#l7.258"></a><span id="l7.258" class="difflineminus">-        result += ',';</span>
<a href="#l7.259"></a><span id="l7.259" class="difflineminus">-    }</span>
<a href="#l7.260"></a><span id="l7.260" class="difflineminus">-    if (result.length &amp;&amp; result[result.length - 1] == ',') {</span>
<a href="#l7.261"></a><span id="l7.261" class="difflineminus">-        result = result.substr(0, result.length - 1);</span>
<a href="#l7.262"></a><span id="l7.262" class="difflineplus">+    // Note that the mix of string/boolean here is not a mistake.</span>
<a href="#l7.263"></a><span id="l7.263" class="difflineplus">+    // setElementValue removes the attribute from the node if the second</span>
<a href="#l7.264"></a><span id="l7.264" class="difflineplus">+    // parameter is === false, otherwise sets the attribute value to the given</span>
<a href="#l7.265"></a><span id="l7.265" class="difflineplus">+    // string (i.e &quot;true&quot;).</span>
<a href="#l7.266"></a><span id="l7.266" class="difflineplus">+    if (aDisableAll) {</span>
<a href="#l7.267"></a><span id="l7.267" class="difflineplus">+        relativeDisabled = &quot;true&quot;;</span>
<a href="#l7.268"></a><span id="l7.268" class="difflineplus">+        absoluteDisabled = &quot;true&quot;;</span>
<a href="#l7.269"></a><span id="l7.269" class="difflineplus">+    } else if (relationItem) {</span>
<a href="#l7.270"></a><span id="l7.270" class="difflineplus">+        // This is not a mistake, when this function is called from onselect,</span>
<a href="#l7.271"></a><span id="l7.271" class="difflineplus">+        // the value has not been set.</span>
<a href="#l7.272"></a><span id="l7.272" class="difflineplus">+        relativeDisabled = (relationItem.value == &quot;absolute&quot;) &amp;&amp; &quot;true&quot;;</span>
<a href="#l7.273"></a><span id="l7.273" class="difflineplus">+        absoluteDisabled = (relationItem.value == &quot;relative&quot;) &amp;&amp; &quot;true&quot;;</span>
<a href="#l7.274"></a><span id="l7.274" class="difflineplus">+    } else {</span>
<a href="#l7.275"></a><span id="l7.275" class="difflineplus">+        relativeDisabled = false;</span>
<a href="#l7.276"></a><span id="l7.276" class="difflineplus">+        absoluteDisabled = false;</span>
<a href="#l7.277"></a><span id="l7.277">     }</span>
<a href="#l7.278"></a><span id="l7.278"> </span>
<a href="#l7.279"></a><span id="l7.279" class="difflineminus">-    prefBranch.setCharPref(&quot;custom&quot;, result);</span>
<a href="#l7.280"></a><span id="l7.280" class="difflineplus">+    setElementValue(&quot;reminder-length&quot;, relativeDisabled, &quot;disabled&quot;);</span>
<a href="#l7.281"></a><span id="l7.281" class="difflineplus">+    setElementValue(&quot;reminder-unit&quot;, relativeDisabled, &quot;disabled&quot;);</span>
<a href="#l7.282"></a><span id="l7.282" class="difflineplus">+    setElementValue(&quot;reminder-relation&quot;, relativeDisabled, &quot;disabled&quot;);</span>
<a href="#l7.283"></a><span id="l7.283" class="difflineplus">+    setElementValue(&quot;reminder-origin&quot;, relativeDisabled, &quot;disabled&quot;);</span>
<a href="#l7.284"></a><span id="l7.284" class="difflineplus">+</span>
<a href="#l7.285"></a><span id="l7.285" class="difflineplus">+    setElementValue(&quot;reminder-absolute-date&quot;, absoluteDisabled, &quot;disabled&quot;);</span>
<a href="#l7.286"></a><span id="l7.286" class="difflineplus">+</span>
<a href="#l7.287"></a><span id="l7.287" class="difflineplus">+    let disableAll = (aDisableAll ? &quot;true&quot; : false);</span>
<a href="#l7.288"></a><span id="l7.288" class="difflineplus">+    setElementValue(&quot;reminder-relative-radio&quot;, disableAll, &quot;disabled&quot;);</span>
<a href="#l7.289"></a><span id="l7.289" class="difflineplus">+    setElementValue(&quot;reminder-absolute-radio&quot;, disableAll, &quot;disabled&quot;);</span>
<a href="#l7.290"></a><span id="l7.290" class="difflineplus">+    setElementValue(&quot;reminder-actions-menulist&quot;, disableAll, &quot;disabled&quot;);</span>
<a href="#l7.291"></a><span id="l7.291"> }</span>
<a href="#l7.292"></a><span id="l7.292"> </span>
<a href="#l7.293"></a><span id="l7.293" class="difflineminus">-function onReminderSelected() {</span>
<a href="#l7.294"></a><span id="l7.294" class="difflineminus">-    var length = document.getElementById(&quot;reminder-length&quot;);</span>
<a href="#l7.295"></a><span id="l7.295" class="difflineminus">-    var unit = document.getElementById(&quot;reminder-unit&quot;);</span>
<a href="#l7.296"></a><span id="l7.296" class="difflineminus">-    var relation = document.getElementById(&quot;reminder-relation&quot;);</span>
<a href="#l7.297"></a><span id="l7.297" class="difflineminus">-    var origin = document.getElementById(&quot;reminder-origin&quot;);</span>
<a href="#l7.298"></a><span id="l7.298" class="difflineplus">+/**</span>
<a href="#l7.299"></a><span id="l7.299" class="difflineplus">+ * Sets up the max reminders notification. Shows or hides the notification</span>
<a href="#l7.300"></a><span id="l7.300" class="difflineplus">+ * depending on if the max reminders limit has been hit or not.</span>
<a href="#l7.301"></a><span id="l7.301" class="difflineplus">+ */</span>
<a href="#l7.302"></a><span id="l7.302" class="difflineplus">+function setupMaxReminders() {</span>
<a href="#l7.303"></a><span id="l7.303" class="difflineplus">+    let args = window.arguments[0];</span>
<a href="#l7.304"></a><span id="l7.304" class="difflineplus">+    let listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l7.305"></a><span id="l7.305" class="difflineplus">+    let notificationbox = document.getElementById(&quot;reminder-notifications&quot;);</span>
<a href="#l7.306"></a><span id="l7.306" class="difflineplus">+    // TODO ALARMSUPPORT right now some of our backend still only supports one</span>
<a href="#l7.307"></a><span id="l7.307" class="difflineplus">+    // alarm. Limit this in the UI to not confuse users too much.</span>
<a href="#l7.308"></a><span id="l7.308" class="difflineplus">+    // let maxReminders = args.calendar.getProperty(&quot;capabilities.alarms.maxCount&quot;);</span>
<a href="#l7.309"></a><span id="l7.309" class="difflineplus">+    let maxReminders = 1;</span>
<a href="#l7.310"></a><span id="l7.310" class="difflineplus">+</span>
<a href="#l7.311"></a><span id="l7.311" class="difflineplus">+    // != null is needed here to ensure cond to be true/false, instead of</span>
<a href="#l7.312"></a><span id="l7.312" class="difflineplus">+    // true/null. The former is needed for setElementValue.</span>
<a href="#l7.313"></a><span id="l7.313" class="difflineplus">+    let cond = (maxReminders != null &amp;&amp; listbox.childNodes.length &gt;= maxReminders);</span>
<a href="#l7.314"></a><span id="l7.314"> </span>
<a href="#l7.315"></a><span id="l7.315" class="difflineminus">-    var listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l7.316"></a><span id="l7.316" class="difflineminus">-    var listitem = listbox.selectedItem;</span>
<a href="#l7.317"></a><span id="l7.317" class="difflineplus">+    // If we hit the maximum number of reminders, show the error box and</span>
<a href="#l7.318"></a><span id="l7.318" class="difflineplus">+    // disable the new button.</span>
<a href="#l7.319"></a><span id="l7.319" class="difflineplus">+    setElementValue(&quot;reminder-new-button&quot;, cond &amp;&amp; &quot;true&quot;, &quot;disabled&quot;);</span>
<a href="#l7.320"></a><span id="l7.320" class="difflineplus">+    </span>
<a href="#l7.321"></a><span id="l7.321" class="difflineplus">+    if (!setupMaxReminders.notification) {</span>
<a href="#l7.322"></a><span id="l7.322" class="difflineplus">+        let notification = createXULElement(&quot;notification&quot;);</span>
<a href="#l7.323"></a><span id="l7.323" class="difflineplus">+        let localeErrorString = </span>
<a href="#l7.324"></a><span id="l7.324" class="difflineplus">+            calGetString(&quot;calendar-alarms&quot;,</span>
<a href="#l7.325"></a><span id="l7.325" class="difflineplus">+                         getItemBundleStringName(&quot;reminderErrorMaxCountReached&quot;),</span>
<a href="#l7.326"></a><span id="l7.326" class="difflineplus">+                         [maxReminders]);</span>
<a href="#l7.327"></a><span id="l7.327" class="difflineplus">+        let pluralErrorLabel = PluralForm.get(maxReminders, localeErrorString)</span>
<a href="#l7.328"></a><span id="l7.328" class="difflineplus">+                                         .replace(&quot;#1&quot;, maxReminders);</span>
<a href="#l7.329"></a><span id="l7.329"> </span>
<a href="#l7.330"></a><span id="l7.330" class="difflineminus">-    if (listitem) {</span>
<a href="#l7.331"></a><span id="l7.331" class="difflineminus">-        var reminder = listitem.reminder;</span>
<a href="#l7.332"></a><span id="l7.332" class="difflineminus">-        length.value = reminder.length;</span>
<a href="#l7.333"></a><span id="l7.333" class="difflineminus">-        unit.value = reminder.unit;</span>
<a href="#l7.334"></a><span id="l7.334" class="difflineminus">-        relation.value = reminder.relation;</span>
<a href="#l7.335"></a><span id="l7.335" class="difflineminus">-        origin.value = reminder.origin;</span>
<a href="#l7.336"></a><span id="l7.336" class="difflineplus">+        notification.setAttribute(&quot;label&quot;, pluralErrorLabel);</span>
<a href="#l7.337"></a><span id="l7.337" class="difflineplus">+        notification.setAttribute(&quot;type&quot;, &quot;warning&quot;);</span>
<a href="#l7.338"></a><span id="l7.338" class="difflineplus">+        notification.setAttribute(&quot;hideclose&quot;, &quot;true&quot;);</span>
<a href="#l7.339"></a><span id="l7.339" class="difflineplus">+        setupMaxReminders.notification = notification;</span>
<a href="#l7.340"></a><span id="l7.340" class="difflineplus">+    }</span>
<a href="#l7.341"></a><span id="l7.341" class="difflineplus">+</span>
<a href="#l7.342"></a><span id="l7.342" class="difflineplus">+    if (cond) {</span>
<a href="#l7.343"></a><span id="l7.343" class="difflineplus">+        notificationbox.appendChild(setupMaxReminders.notification);</span>
<a href="#l7.344"></a><span id="l7.344" class="difflineplus">+    } else {</span>
<a href="#l7.345"></a><span id="l7.345" class="difflineplus">+        notificationbox.removeNotification(setupMaxReminders.notification);</span>
<a href="#l7.346"></a><span id="l7.346">     }</span>
<a href="#l7.347"></a><span id="l7.347"> }</span>
<a href="#l7.348"></a><span id="l7.348"> </span>
<a href="#l7.349"></a><span id="l7.349" class="difflineminus">-function updateReminderLength(event) {</span>
<a href="#l7.350"></a><span id="l7.350" class="difflineminus">-    validateIntegers(event);</span>
<a href="#l7.351"></a><span id="l7.351" class="difflineminus">-    updateReminder();</span>
<a href="#l7.352"></a><span id="l7.352" class="difflineplus">+/**</span>
<a href="#l7.353"></a><span id="l7.353" class="difflineplus">+ * Sets up a reminder listitem for the list of reminders applied to this item.</span>
<a href="#l7.354"></a><span id="l7.354" class="difflineplus">+ *</span>
<a href="#l7.355"></a><span id="l7.355" class="difflineplus">+ * @param aListItem     (optional) A reference listitem to set up. If not</span>
<a href="#l7.356"></a><span id="l7.356" class="difflineplus">+ *                                   passed, a new listitem will be created.</span>
<a href="#l7.357"></a><span id="l7.357" class="difflineplus">+ * @param aReminder     The calIAlarm to display in this listitem</span>
<a href="#l7.358"></a><span id="l7.358" class="difflineplus">+ * @param aItem         The item the alarm is set up on.</span>
<a href="#l7.359"></a><span id="l7.359" class="difflineplus">+ * @return              The  XUL listitem node showing the passed reminder.</span>
<a href="#l7.360"></a><span id="l7.360" class="difflineplus">+ */</span>
<a href="#l7.361"></a><span id="l7.361" class="difflineplus">+function setupListItem(aListItem, aReminder, aItem) {</span>
<a href="#l7.362"></a><span id="l7.362" class="difflineplus">+    let listitem = aListItem || createXULElement(&quot;listitem&quot;);</span>
<a href="#l7.363"></a><span id="l7.363" class="difflineplus">+</span>
<a href="#l7.364"></a><span id="l7.364" class="difflineplus">+    // Create a random id to be used for accessibility</span>
<a href="#l7.365"></a><span id="l7.365" class="difflineplus">+    let reminderId = cal.getUUID();</span>
<a href="#l7.366"></a><span id="l7.366" class="difflineplus">+    let ariaLabel = &quot;reminder-action-&quot; + aReminder.action + &quot; &quot; + reminderId;</span>
<a href="#l7.367"></a><span id="l7.367" class="difflineplus">+</span>
<a href="#l7.368"></a><span id="l7.368" class="difflineplus">+    listitem.reminder = aReminder;</span>
<a href="#l7.369"></a><span id="l7.369" class="difflineplus">+    listitem.setAttribute(&quot;id&quot;, reminderId);</span>
<a href="#l7.370"></a><span id="l7.370" class="difflineplus">+    listitem.setAttribute(&quot;label&quot;, aReminder.toString(aItem));</span>
<a href="#l7.371"></a><span id="l7.371" class="difflineplus">+    listitem.setAttribute(&quot;aria-labelledby&quot;, ariaLabel);</span>
<a href="#l7.372"></a><span id="l7.372" class="difflineplus">+    listitem.setAttribute(&quot;class&quot;, &quot;reminder-icon listitem-iconic&quot;);</span>
<a href="#l7.373"></a><span id="l7.373" class="difflineplus">+    listitem.setAttribute(&quot;value&quot;, aReminder.action);</span>
<a href="#l7.374"></a><span id="l7.374" class="difflineplus">+    return listitem;</span>
<a href="#l7.375"></a><span id="l7.375"> }</span>
<a href="#l7.376"></a><span id="l7.376"> </span>
<a href="#l7.377"></a><span id="l7.377" class="difflineminus">-function updateReminder() {</span>
<a href="#l7.378"></a><span id="l7.378" class="difflineminus">-    var length = document.getElementById(&quot;reminder-length&quot;);</span>
<a href="#l7.379"></a><span id="l7.379" class="difflineminus">-    var unit = document.getElementById(&quot;reminder-unit&quot;);</span>
<a href="#l7.380"></a><span id="l7.380" class="difflineminus">-    var relation = document.getElementById(&quot;reminder-relation&quot;);</span>
<a href="#l7.381"></a><span id="l7.381" class="difflineminus">-    var origin = document.getElementById(&quot;reminder-origin&quot;);</span>
<a href="#l7.382"></a><span id="l7.382" class="difflineplus">+/**</span>
<a href="#l7.383"></a><span id="l7.383" class="difflineplus">+ * Handler function to be called when a reminder is selected in the listbox.</span>
<a href="#l7.384"></a><span id="l7.384" class="difflineplus">+ * Sets up remaining controls to show the selected alarm.</span>
<a href="#l7.385"></a><span id="l7.385" class="difflineplus">+ */</span>
<a href="#l7.386"></a><span id="l7.386" class="difflineplus">+function onReminderSelected() {</span>
<a href="#l7.387"></a><span id="l7.387" class="difflineplus">+    let length = document.getElementById(&quot;reminder-length&quot;);</span>
<a href="#l7.388"></a><span id="l7.388" class="difflineplus">+    let unit = document.getElementById(&quot;reminder-unit&quot;);</span>
<a href="#l7.389"></a><span id="l7.389" class="difflineplus">+    let relation = document.getElementById(&quot;reminder-relation&quot;);</span>
<a href="#l7.390"></a><span id="l7.390" class="difflineplus">+    let origin = document.getElementById(&quot;reminder-origin&quot;);</span>
<a href="#l7.391"></a><span id="l7.391" class="difflineplus">+    let absDate = document.getElementById(&quot;reminder-absolute-date&quot;);</span>
<a href="#l7.392"></a><span id="l7.392" class="difflineplus">+    let actionType = document.getElementById(&quot;reminder-actions-menulist&quot;);</span>
<a href="#l7.393"></a><span id="l7.393" class="difflineplus">+    let relationType = document.getElementById(&quot;reminder-relation-radiogroup&quot;);</span>
<a href="#l7.394"></a><span id="l7.394"> </span>
<a href="#l7.395"></a><span id="l7.395" class="difflineminus">-    var listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l7.396"></a><span id="l7.396" class="difflineminus">-    var listitem = listbox.selectedItem;</span>
<a href="#l7.397"></a><span id="l7.397" class="difflineminus">-    var reminder = listitem.reminder;</span>
<a href="#l7.398"></a><span id="l7.398" class="difflineplus">+    let listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l7.399"></a><span id="l7.399" class="difflineplus">+    let listitem = listbox.selectedItem;</span>
<a href="#l7.400"></a><span id="l7.400" class="difflineplus">+</span>
<a href="#l7.401"></a><span id="l7.401" class="difflineplus">+    if (listitem) {</span>
<a href="#l7.402"></a><span id="l7.402" class="difflineplus">+        let reminder = listitem.reminder;</span>
<a href="#l7.403"></a><span id="l7.403" class="difflineplus">+</span>
<a href="#l7.404"></a><span id="l7.404" class="difflineplus">+        // Action</span>
<a href="#l7.405"></a><span id="l7.405" class="difflineplus">+        actionType.value = reminder.action;</span>
<a href="#l7.406"></a><span id="l7.406"> </span>
<a href="#l7.407"></a><span id="l7.407" class="difflineminus">-    reminder.length = length.value;</span>
<a href="#l7.408"></a><span id="l7.408" class="difflineminus">-    reminder.unit = unit.value;</span>
<a href="#l7.409"></a><span id="l7.409" class="difflineminus">-    reminder.relation = relation.value;</span>
<a href="#l7.410"></a><span id="l7.410" class="difflineminus">-    reminder.origin = origin.value;</span>
<a href="#l7.411"></a><span id="l7.411" class="difflineplus">+        // Absolute/relative things</span>
<a href="#l7.412"></a><span id="l7.412" class="difflineplus">+        if (reminder.related == Components.interfaces.calIAlarm.ALARM_RELATED_ABSOLUTE) {</span>
<a href="#l7.413"></a><span id="l7.413" class="difflineplus">+            relationType.value = &quot;absolute&quot;;</span>
<a href="#l7.414"></a><span id="l7.414"> </span>
<a href="#l7.415"></a><span id="l7.415" class="difflineminus">-    var details = stringFromReminderObject(reminder);</span>
<a href="#l7.416"></a><span id="l7.416" class="difflineminus">-    listitem.setAttribute('label', details);</span>
<a href="#l7.417"></a><span id="l7.417" class="difflineminus">-}</span>
<a href="#l7.418"></a><span id="l7.418" class="difflineplus">+            // Date</span>
<a href="#l7.419"></a><span id="l7.419" class="difflineplus">+            absDate.value = (reminder.alarmDate || getDefaultStartDate()).jsDate;</span>
<a href="#l7.420"></a><span id="l7.420" class="difflineplus">+        } else {</span>
<a href="#l7.421"></a><span id="l7.421" class="difflineplus">+            relationType.value =  &quot;relative&quot;;</span>
<a href="#l7.422"></a><span id="l7.422"> </span>
<a href="#l7.423"></a><span id="l7.423" class="difflineminus">-function onNewReminder() {</span>
<a href="#l7.424"></a><span id="l7.424" class="difflineminus">-    var listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l7.425"></a><span id="l7.425" class="difflineminus">-    var listitem = listbox.selectedItem;</span>
<a href="#l7.426"></a><span id="l7.426" class="difflineminus">-    var reminder = listitem.reminder;</span>
<a href="#l7.427"></a><span id="l7.427" class="difflineminus">-    listbox.clearSelection();</span>
<a href="#l7.428"></a><span id="l7.428" class="difflineminus">-    var newNode = listitem.cloneNode(true);</span>
<a href="#l7.429"></a><span id="l7.429" class="difflineminus">-    var newReminder = {};</span>
<a href="#l7.430"></a><span id="l7.430" class="difflineminus">-    newReminder.length = reminder.length;</span>
<a href="#l7.431"></a><span id="l7.431" class="difflineminus">-    newReminder.unit = reminder.unit;</span>
<a href="#l7.432"></a><span id="l7.432" class="difflineminus">-    newReminder.relation = reminder.relation;</span>
<a href="#l7.433"></a><span id="l7.433" class="difflineminus">-    newReminder.origin = reminder.origin;</span>
<a href="#l7.434"></a><span id="l7.434" class="difflineminus">-    newNode.reminder = newReminder;</span>
<a href="#l7.435"></a><span id="l7.435" class="difflineminus">-    listbox.appendChild(newNode);</span>
<a href="#l7.436"></a><span id="l7.436" class="difflineminus">-    listbox.selectItem(newNode);</span>
<a href="#l7.437"></a><span id="l7.437" class="difflineplus">+            // Unit and length</span>
<a href="#l7.438"></a><span id="l7.438" class="difflineplus">+            let alarmlen = Math.abs(reminder.offset.inSeconds / 60);</span>
<a href="#l7.439"></a><span id="l7.439" class="difflineplus">+            if (alarmlen % 1440 == 0) {</span>
<a href="#l7.440"></a><span id="l7.440" class="difflineplus">+                unit.value = &quot;days&quot;;</span>
<a href="#l7.441"></a><span id="l7.441" class="difflineplus">+                length.value = alarmlen / 1440;</span>
<a href="#l7.442"></a><span id="l7.442" class="difflineplus">+            } else if (alarmlen % 60 == 0) {</span>
<a href="#l7.443"></a><span id="l7.443" class="difflineplus">+                unit.value = &quot;hours&quot;;</span>
<a href="#l7.444"></a><span id="l7.444" class="difflineplus">+                length.value = alarmlen / 60;</span>
<a href="#l7.445"></a><span id="l7.445" class="difflineplus">+            } else {</span>
<a href="#l7.446"></a><span id="l7.446" class="difflineplus">+                unit.value = &quot;minutes&quot;;</span>
<a href="#l7.447"></a><span id="l7.447" class="difflineplus">+                length.value = alarmlen;</span>
<a href="#l7.448"></a><span id="l7.448" class="difflineplus">+            }</span>
<a href="#l7.449"></a><span id="l7.449"> </span>
<a href="#l7.450"></a><span id="l7.450" class="difflineminus">-    var button = document.getElementById(&quot;reminder-delete&quot;);</span>
<a href="#l7.451"></a><span id="l7.451" class="difflineminus">-    if (listbox.childNodes.length &gt; 1) {</span>
<a href="#l7.452"></a><span id="l7.452" class="difflineminus">-        button.removeAttribute('disabled');</span>
<a href="#l7.453"></a><span id="l7.453" class="difflineplus">+            // Relation</span>
<a href="#l7.454"></a><span id="l7.454" class="difflineplus">+            if (reminder.offset.isNegative) {</span>
<a href="#l7.455"></a><span id="l7.455" class="difflineplus">+                relation.value =  &quot;before&quot;;</span>
<a href="#l7.456"></a><span id="l7.456" class="difflineplus">+            } else {</span>
<a href="#l7.457"></a><span id="l7.457" class="difflineplus">+                relation.value = &quot;after&quot;;</span>
<a href="#l7.458"></a><span id="l7.458" class="difflineplus">+            }</span>
<a href="#l7.459"></a><span id="l7.459" class="difflineplus">+</span>
<a href="#l7.460"></a><span id="l7.460" class="difflineplus">+            // Origin</span>
<a href="#l7.461"></a><span id="l7.461" class="difflineplus">+            if (reminder.related == Components.interfaces.calIAlarm.ALARM_RELATED_START) {</span>
<a href="#l7.462"></a><span id="l7.462" class="difflineplus">+                origin.value = &quot;START&quot;;</span>
<a href="#l7.463"></a><span id="l7.463" class="difflineplus">+            } else if (reminder.related == Components.interfaces.calIAlarm.ALARM_RELATED_END) {</span>
<a href="#l7.464"></a><span id="l7.464" class="difflineplus">+                origin.value = &quot;END&quot;;</span>
<a href="#l7.465"></a><span id="l7.465" class="difflineplus">+            }</span>
<a href="#l7.466"></a><span id="l7.466" class="difflineplus">+        }</span>
<a href="#l7.467"></a><span id="l7.467">     } else {</span>
<a href="#l7.468"></a><span id="l7.468" class="difflineminus">-        button.setAttribute('disabled', 'true');</span>
<a href="#l7.469"></a><span id="l7.469" class="difflineplus">+        // no list item is selected, disable elements</span>
<a href="#l7.470"></a><span id="l7.470" class="difflineplus">+        setupRadioEnabledState(true);</span>
<a href="#l7.471"></a><span id="l7.471">     }</span>
<a href="#l7.472"></a><span id="l7.472"> }</span>
<a href="#l7.473"></a><span id="l7.473"> </span>
<a href="#l7.474"></a><span id="l7.474" class="difflineminus">-function onDeleteReminder() {</span>
<a href="#l7.475"></a><span id="l7.475" class="difflineminus">-    var listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l7.476"></a><span id="l7.476" class="difflineminus">-    var listitem = listbox.selectedItem;</span>
<a href="#l7.477"></a><span id="l7.477" class="difflineminus">-    var selectitem = listitem.nextSibling;</span>
<a href="#l7.478"></a><span id="l7.478" class="difflineminus">-    if (!selectitem) {</span>
<a href="#l7.479"></a><span id="l7.479" class="difflineminus">-        selectitem = listitem.previousSibling;</span>
<a href="#l7.480"></a><span id="l7.480" class="difflineplus">+/**</span>
<a href="#l7.481"></a><span id="l7.481" class="difflineplus">+ * Handler function to be called when an aspect of the alarm has been changed</span>
<a href="#l7.482"></a><span id="l7.482" class="difflineplus">+ * using the dialog controls.</span>
<a href="#l7.483"></a><span id="l7.483" class="difflineplus">+ *</span>
<a href="#l7.484"></a><span id="l7.484" class="difflineplus">+ * @param event         The DOM event caused by the change.</span>
<a href="#l7.485"></a><span id="l7.485" class="difflineplus">+ */</span>
<a href="#l7.486"></a><span id="l7.486" class="difflineplus">+function updateReminder(event) {</span>
<a href="#l7.487"></a><span id="l7.487" class="difflineplus">+    if (event.explicitOriginalTarget.localName == &quot;listitem&quot; ||</span>
<a href="#l7.488"></a><span id="l7.488" class="difflineplus">+        !document.commandDispatcher.focusedElement) {</span>
<a href="#l7.489"></a><span id="l7.489" class="difflineplus">+        // Do not set things if the select came from selecting an alarm from the</span>
<a href="#l7.490"></a><span id="l7.490" class="difflineplus">+        // list, or from setting when the dialog initially loaded.</span>
<a href="#l7.491"></a><span id="l7.491" class="difflineplus">+        // XXX Quite fragile hack since radio/radiogroup doesn't have the</span>
<a href="#l7.492"></a><span id="l7.492" class="difflineplus">+        // supressOnSelect stuff.</span>
<a href="#l7.493"></a><span id="l7.493" class="difflineplus">+        return;</span>
<a href="#l7.494"></a><span id="l7.494" class="difflineplus">+    }</span>
<a href="#l7.495"></a><span id="l7.495" class="difflineplus">+    let listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l7.496"></a><span id="l7.496" class="difflineplus">+    let relationItem = document.getElementById(&quot;reminder-relation-radiogroup&quot;).selectedItem;</span>
<a href="#l7.497"></a><span id="l7.497" class="difflineplus">+    let listitem = listbox.selectedItem;</span>
<a href="#l7.498"></a><span id="l7.498" class="difflineplus">+    if (!listitem || !relationItem) {</span>
<a href="#l7.499"></a><span id="l7.499" class="difflineplus">+        return;</span>
<a href="#l7.500"></a><span id="l7.500">     }</span>
<a href="#l7.501"></a><span id="l7.501" class="difflineminus">-    listbox.clearSelection();</span>
<a href="#l7.502"></a><span id="l7.502" class="difflineminus">-    listbox.removeChild(listitem);</span>
<a href="#l7.503"></a><span id="l7.503" class="difflineminus">-    listbox.selectItem(selectitem);</span>
<a href="#l7.504"></a><span id="l7.504" class="difflineplus">+    let reminder = listitem.reminder;</span>
<a href="#l7.505"></a><span id="l7.505" class="difflineplus">+    let length = document.getElementById(&quot;reminder-length&quot;);</span>
<a href="#l7.506"></a><span id="l7.506" class="difflineplus">+    let unit = document.getElementById(&quot;reminder-unit&quot;);</span>
<a href="#l7.507"></a><span id="l7.507" class="difflineplus">+    let relation = document.getElementById(&quot;reminder-relation&quot;);</span>
<a href="#l7.508"></a><span id="l7.508" class="difflineplus">+    let origin = document.getElementById(&quot;reminder-origin&quot;);</span>
<a href="#l7.509"></a><span id="l7.509" class="difflineplus">+    let absDate = document.getElementById(&quot;reminder-absolute-date&quot;);</span>
<a href="#l7.510"></a><span id="l7.510" class="difflineplus">+    let action = document.getElementById(&quot;reminder-actions-menulist&quot;).selectedItem.value;</span>
<a href="#l7.511"></a><span id="l7.511" class="difflineplus">+</span>
<a href="#l7.512"></a><span id="l7.512" class="difflineplus">+    // Action</span>
<a href="#l7.513"></a><span id="l7.513" class="difflineplus">+    reminder.action = action;</span>
<a href="#l7.514"></a><span id="l7.514" class="difflineplus">+</span>
<a href="#l7.515"></a><span id="l7.515" class="difflineplus">+    let relationType;</span>
<a href="#l7.516"></a><span id="l7.516" class="difflineplus">+    if (relationItem.value == &quot;relative&quot;) {</span>
<a href="#l7.517"></a><span id="l7.517" class="difflineplus">+        if (origin.value == &quot;START&quot;) {</span>
<a href="#l7.518"></a><span id="l7.518" class="difflineplus">+            reminder.related = Components.interfaces.calIAlarm.ALARM_RELATED_START;</span>
<a href="#l7.519"></a><span id="l7.519" class="difflineplus">+        } else if (origin.value == &quot;END&quot;) {</span>
<a href="#l7.520"></a><span id="l7.520" class="difflineplus">+            reminder.related = Components.interfaces.calIAlarm.ALARM_RELATED_END;</span>
<a href="#l7.521"></a><span id="l7.521" class="difflineplus">+        }</span>
<a href="#l7.522"></a><span id="l7.522"> </span>
<a href="#l7.523"></a><span id="l7.523" class="difflineminus">-    var button = document.getElementById(&quot;reminder-delete&quot;);</span>
<a href="#l7.524"></a><span id="l7.524" class="difflineminus">-    if (listbox.childNodes.length &gt; 1) {</span>
<a href="#l7.525"></a><span id="l7.525" class="difflineminus">-        button.removeAttribute('disabled');</span>
<a href="#l7.526"></a><span id="l7.526" class="difflineplus">+        // Set up offset, taking units and before/after into account</span>
<a href="#l7.527"></a><span id="l7.527" class="difflineplus">+        let offset = cal.createDuration();</span>
<a href="#l7.528"></a><span id="l7.528" class="difflineplus">+        offset[unit.value] = length.value;</span>
<a href="#l7.529"></a><span id="l7.529" class="difflineplus">+        offset.normalize();</span>
<a href="#l7.530"></a><span id="l7.530" class="difflineplus">+        offset.isNegative = (relation.value == &quot;before&quot;);</span>
<a href="#l7.531"></a><span id="l7.531" class="difflineplus">+        reminder.offset = offset;</span>
<a href="#l7.532"></a><span id="l7.532" class="difflineplus">+    } else if (relationItem.value == &quot;absolute&quot;) {</span>
<a href="#l7.533"></a><span id="l7.533" class="difflineplus">+        reminder.related = Components.interfaces.calIAlarm.ALARM_RELATED_ABSOLUTE;</span>
<a href="#l7.534"></a><span id="l7.534" class="difflineplus">+</span>
<a href="#l7.535"></a><span id="l7.535" class="difflineplus">+        if (absDate.value) {</span>
<a href="#l7.536"></a><span id="l7.536" class="difflineplus">+            reminder.alarmDate = jsDateToDateTime(absDate.value,</span>
<a href="#l7.537"></a><span id="l7.537" class="difflineplus">+                                                  window.arguments[0].timezone);</span>
<a href="#l7.538"></a><span id="l7.538" class="difflineplus">+        } else {</span>
<a href="#l7.539"></a><span id="l7.539" class="difflineplus">+            reminder.alarmDate = null;</span>
<a href="#l7.540"></a><span id="l7.540" class="difflineplus">+        }</span>
<a href="#l7.541"></a><span id="l7.541" class="difflineplus">+    }</span>
<a href="#l7.542"></a><span id="l7.542" class="difflineplus">+</span>
<a href="#l7.543"></a><span id="l7.543" class="difflineplus">+    setupListItem(listitem, reminder, window.arguments[0].item);</span>
<a href="#l7.544"></a><span id="l7.544" class="difflineplus">+}</span>
<a href="#l7.545"></a><span id="l7.545" class="difflineplus">+</span>
<a href="#l7.546"></a><span id="l7.546" class="difflineplus">+/**</span>
<a href="#l7.547"></a><span id="l7.547" class="difflineplus">+ * Gets the locale stringname that is dependant on the item type. This function</span>
<a href="#l7.548"></a><span id="l7.548" class="difflineplus">+ * appends the item type, i.e |aPrefix + &quot;Event&quot;|.</span>
<a href="#l7.549"></a><span id="l7.549" class="difflineplus">+ *</span>
<a href="#l7.550"></a><span id="l7.550" class="difflineplus">+ * @param aPrefix       The prefix to prepend to the item type</span>
<a href="#l7.551"></a><span id="l7.551" class="difflineplus">+ * @return              The full string name.</span>
<a href="#l7.552"></a><span id="l7.552" class="difflineplus">+ */</span>
<a href="#l7.553"></a><span id="l7.553" class="difflineplus">+function getItemBundleStringName(aPrefix) {</span>
<a href="#l7.554"></a><span id="l7.554" class="difflineplus">+    if (isEvent(window.arguments[0].item)) {</span>
<a href="#l7.555"></a><span id="l7.555" class="difflineplus">+        return aPrefix + &quot;Event&quot;;</span>
<a href="#l7.556"></a><span id="l7.556">     } else {</span>
<a href="#l7.557"></a><span id="l7.557" class="difflineminus">-        button.setAttribute('disabled', 'true');</span>
<a href="#l7.558"></a><span id="l7.558" class="difflineplus">+        return aPrefix + &quot;Task&quot;;</span>
<a href="#l7.559"></a><span id="l7.559">     }</span>
<a href="#l7.560"></a><span id="l7.560"> }</span>
<a href="#l7.561"></a><span id="l7.561"> </span>
<a href="#l7.562"></a><span id="l7.562" class="difflineplus">+/**</span>
<a href="#l7.563"></a><span id="l7.563" class="difflineplus">+ * Handler function to be called when the &quot;new&quot; button is pressed, to create a</span>
<a href="#l7.564"></a><span id="l7.564" class="difflineplus">+ * new reminder item.</span>
<a href="#l7.565"></a><span id="l7.565" class="difflineplus">+ */</span>
<a href="#l7.566"></a><span id="l7.566" class="difflineplus">+function onNewReminder() {</span>
<a href="#l7.567"></a><span id="l7.567" class="difflineplus">+    let itemType = (isEvent(window.arguments[0].item) ? &quot;event&quot; : &quot;todo&quot;);</span>
<a href="#l7.568"></a><span id="l7.568" class="difflineplus">+    let listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l7.569"></a><span id="l7.569" class="difflineplus">+</span>
<a href="#l7.570"></a><span id="l7.570" class="difflineplus">+    let reminder = cal.createAlarm();</span>
<a href="#l7.571"></a><span id="l7.571" class="difflineplus">+    let alarmlen = getPrefSafe(&quot;calendar.alarms.&quot; + itemType + &quot;alarmlen&quot;, 15);</span>
<a href="#l7.572"></a><span id="l7.572" class="difflineplus">+</span>
<a href="#l7.573"></a><span id="l7.573" class="difflineplus">+    // Default is a relative DISPLAY alarm, |alarmlen| minutes before the event.</span>
<a href="#l7.574"></a><span id="l7.574" class="difflineplus">+    // If DISPLAY is not supported by the provider, then pick the provider's</span>
<a href="#l7.575"></a><span id="l7.575" class="difflineplus">+    // first alarm type.</span>
<a href="#l7.576"></a><span id="l7.576" class="difflineplus">+    let offset = cal.createDuration();</span>
<a href="#l7.577"></a><span id="l7.577" class="difflineplus">+    offset.minutes = alarmlen;</span>
<a href="#l7.578"></a><span id="l7.578" class="difflineplus">+    offset.normalize();</span>
<a href="#l7.579"></a><span id="l7.579" class="difflineplus">+    offset.isNegative = true;</span>
<a href="#l7.580"></a><span id="l7.580" class="difflineplus">+    reminder.related = reminder.ALARM_RELATED_START;</span>
<a href="#l7.581"></a><span id="l7.581" class="difflineplus">+    reminder.offset = offset;</span>
<a href="#l7.582"></a><span id="l7.582" class="difflineplus">+    if (&quot;DISPLAY&quot; in allowedActionsMap) {</span>
<a href="#l7.583"></a><span id="l7.583" class="difflineplus">+        reminder.action = &quot;DISPLAY&quot;;</span>
<a href="#l7.584"></a><span id="l7.584" class="difflineplus">+    } else {</span>
<a href="#l7.585"></a><span id="l7.585" class="difflineplus">+        let calendar = window.arguments[0].calendar</span>
<a href="#l7.586"></a><span id="l7.586" class="difflineplus">+        let actions = calendar.getProperty(&quot;capabilities.alarms.actionValues&quot;) || [];</span>
<a href="#l7.587"></a><span id="l7.587" class="difflineplus">+        reminder.action = actions[0];</span>
<a href="#l7.588"></a><span id="l7.588" class="difflineplus">+    }</span>
<a href="#l7.589"></a><span id="l7.589" class="difflineplus">+</span>
<a href="#l7.590"></a><span id="l7.590" class="difflineplus">+    // Set up the listbox</span>
<a href="#l7.591"></a><span id="l7.591" class="difflineplus">+    let listitem = setupListItem(null, reminder, window.arguments[0].item);</span>
<a href="#l7.592"></a><span id="l7.592" class="difflineplus">+    listbox.appendChild(listitem);</span>
<a href="#l7.593"></a><span id="l7.593" class="difflineplus">+    listbox.selectItem(listitem);</span>
<a href="#l7.594"></a><span id="l7.594" class="difflineplus">+</span>
<a href="#l7.595"></a><span id="l7.595" class="difflineplus">+    // Since we've added an item, its safe to always enable the button</span>
<a href="#l7.596"></a><span id="l7.596" class="difflineplus">+    enableElement(&quot;reminder-remove-button&quot;);</span>
<a href="#l7.597"></a><span id="l7.597" class="difflineplus">+</span>
<a href="#l7.598"></a><span id="l7.598" class="difflineplus">+    // Set up the enabled state and max reminders</span>
<a href="#l7.599"></a><span id="l7.599" class="difflineplus">+    setupRadioEnabledState();</span>
<a href="#l7.600"></a><span id="l7.600" class="difflineplus">+    setupMaxReminders();</span>
<a href="#l7.601"></a><span id="l7.601" class="difflineplus">+}</span>
<a href="#l7.602"></a><span id="l7.602" class="difflineplus">+</span>
<a href="#l7.603"></a><span id="l7.603" class="difflineplus">+/**</span>
<a href="#l7.604"></a><span id="l7.604" class="difflineplus">+ * Handler function to be called when the &quot;remove&quot; button is pressed to remove</span>
<a href="#l7.605"></a><span id="l7.605" class="difflineplus">+ * the selected reminder item and advance the selection.</span>
<a href="#l7.606"></a><span id="l7.606" class="difflineplus">+ */</span>
<a href="#l7.607"></a><span id="l7.607" class="difflineplus">+function onRemoveReminder() {</span>
<a href="#l7.608"></a><span id="l7.608" class="difflineplus">+    let listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l7.609"></a><span id="l7.609" class="difflineplus">+    let listitem = listbox.selectedItem;</span>
<a href="#l7.610"></a><span id="l7.610" class="difflineplus">+    let newSelection = (listitem ? listitem.nextSibling ||</span>
<a href="#l7.611"></a><span id="l7.611" class="difflineplus">+                                   listitem.previousSibling : null);</span>
<a href="#l7.612"></a><span id="l7.612" class="difflineplus">+</span>
<a href="#l7.613"></a><span id="l7.613" class="difflineplus">+    listbox.clearSelection();</span>
<a href="#l7.614"></a><span id="l7.614" class="difflineplus">+    listbox.removeChild(listitem);</span>
<a href="#l7.615"></a><span id="l7.615" class="difflineplus">+    listbox.selectItem(newSelection);</span>
<a href="#l7.616"></a><span id="l7.616" class="difflineplus">+</span>
<a href="#l7.617"></a><span id="l7.617" class="difflineplus">+    setElementValue(&quot;reminder-remove-button&quot;,</span>
<a href="#l7.618"></a><span id="l7.618" class="difflineplus">+                    listbox.childNodes.length &lt; 1 &amp;&amp; &quot;true&quot;,</span>
<a href="#l7.619"></a><span id="l7.619" class="difflineplus">+                    &quot;disabled&quot;);</span>
<a href="#l7.620"></a><span id="l7.620" class="difflineplus">+    setupMaxReminders();</span>
<a href="#l7.621"></a><span id="l7.621" class="difflineplus">+}</span>
<a href="#l7.622"></a><span id="l7.622" class="difflineplus">+</span>
<a href="#l7.623"></a><span id="l7.623" class="difflineplus">+/**</span>
<a href="#l7.624"></a><span id="l7.624" class="difflineplus">+ * Handler function to be called when the accept button is pressed.</span>
<a href="#l7.625"></a><span id="l7.625" class="difflineplus">+ *</span>
<a href="#l7.626"></a><span id="l7.626" class="difflineplus">+ * @return      Returns true if the window should be closed</span>
<a href="#l7.627"></a><span id="l7.627" class="difflineplus">+ */</span>
<a href="#l7.628"></a><span id="l7.628"> function onAccept() {</span>
<a href="#l7.629"></a><span id="l7.629" class="difflineminus">-    var array = [];</span>
<a href="#l7.630"></a><span id="l7.630" class="difflineminus">-    var listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l7.631"></a><span id="l7.631" class="difflineminus">-    var numChilds = listbox.childNodes.length;</span>
<a href="#l7.632"></a><span id="l7.632" class="difflineminus">-    for (var i = 0; i &lt; numChilds; i++) {</span>
<a href="#l7.633"></a><span id="l7.633" class="difflineminus">-        var item = listbox.childNodes[i];</span>
<a href="#l7.634"></a><span id="l7.634" class="difflineminus">-        array.push(item.reminder);</span>
<a href="#l7.635"></a><span id="l7.635" class="difflineplus">+    let listbox = document.getElementById(&quot;reminder-listbox&quot;);</span>
<a href="#l7.636"></a><span id="l7.636" class="difflineplus">+    let reminders = [ node.reminder </span>
<a href="#l7.637"></a><span id="l7.637" class="difflineplus">+                      for each (node in Array.slice(listbox.childNodes)) ];</span>
<a href="#l7.638"></a><span id="l7.638" class="difflineplus">+    if (window.arguments[0].onOk) {</span>
<a href="#l7.639"></a><span id="l7.639" class="difflineplus">+        window.arguments[0].onOk(reminders);</span>
<a href="#l7.640"></a><span id="l7.640">     }</span>
<a href="#l7.641"></a><span id="l7.641" class="difflineminus">-    saveReminders(array);</span>
<a href="#l7.642"></a><span id="l7.642" class="difflineminus">-</span>
<a href="#l7.643"></a><span id="l7.643" class="difflineminus">-    var listitem = listbox.selectedItem;</span>
<a href="#l7.644"></a><span id="l7.644" class="difflineminus">-    window.onAcceptCallback(listitem.reminder);</span>
<a href="#l7.645"></a><span id="l7.645"> </span>
<a href="#l7.646"></a><span id="l7.646">     return true;</span>
<a href="#l7.647"></a><span id="l7.647"> }</span>
<a href="#l7.648"></a><span id="l7.648"> </span>
<a href="#l7.649"></a><span id="l7.649" class="difflineplus">+/**</span>
<a href="#l7.650"></a><span id="l7.650" class="difflineplus">+ * Handler function to be called when the cancel button is pressed.</span>
<a href="#l7.651"></a><span id="l7.651" class="difflineplus">+ */</span>
<a href="#l7.652"></a><span id="l7.652"> function onCancel() {</span>
<a href="#l7.653"></a><span id="l7.653" class="difflineplus">+    if (window.arguments[0].onCancel) {</span>
<a href="#l7.654"></a><span id="l7.654" class="difflineplus">+        window.arguments[0].onCancel();</span>
<a href="#l7.655"></a><span id="l7.655" class="difflineplus">+    }</span>
<a href="#l7.656"></a><span id="l7.656"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-reminder.xul</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -15,124 +15,140 @@</span>
<a href="#l8.4"></a><span id="l8.4">    - The Original Code is Sun Microsystems code.</span>
<a href="#l8.5"></a><span id="l8.5">    -</span>
<a href="#l8.6"></a><span id="l8.6">    - The Initial Developer of the Original Code is Sun Microsystems.</span>
<a href="#l8.7"></a><span id="l8.7">    - Portions created by the Initial Developer are Copyright (C) 2006</span>
<a href="#l8.8"></a><span id="l8.8">    - the Initial Developer. All Rights Reserved.</span>
<a href="#l8.9"></a><span id="l8.9">    -</span>
<a href="#l8.10"></a><span id="l8.10">    - Contributor(s):</span>
<a href="#l8.11"></a><span id="l8.11">    -   Michael Buettner &lt;michael.buettner@sun.com&gt;</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineplus">+   -   Philipp Kewisch &lt;mozilla@kewis.ch&gt;</span>
<a href="#l8.13"></a><span id="l8.13">    -</span>
<a href="#l8.14"></a><span id="l8.14">    - Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l8.15"></a><span id="l8.15">    - either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l8.16"></a><span id="l8.16">    - the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l8.17"></a><span id="l8.17">    - in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l8.18"></a><span id="l8.18">    - of those above. If you wish to allow use of your version of this file only</span>
<a href="#l8.19"></a><span id="l8.19">    - under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l8.20"></a><span id="l8.20">    - use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l8.21"></a><span id="l8.21">    - decision by deleting the provisions above and replace them with the notice</span>
<a href="#l8.22"></a><span id="l8.22">    - and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l8.23"></a><span id="l8.23">    - the provisions above, a recipient may use your version of this file under</span>
<a href="#l8.24"></a><span id="l8.24">    - the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l8.25"></a><span id="l8.25">    -</span>
<a href="#l8.26"></a><span id="l8.26">    - ***** END LICENSE BLOCK ***** --&gt;</span>
<a href="#l8.27"></a><span id="l8.27"> </span>
<a href="#l8.28"></a><span id="l8.28"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://global/skin/global.css&quot;?&gt;</span>
<a href="#l8.29"></a><span id="l8.29" class="difflineplus">+&lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar/skin/calendar-alarms.css&quot;?&gt;</span>
<a href="#l8.30"></a><span id="l8.30"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar/skin/calendar-event-dialog.css&quot;?&gt;</span>
<a href="#l8.31"></a><span id="l8.31" class="difflineplus">+&lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar/skin/calendar-event-dialog-reminder.css&quot;?&gt;</span>
<a href="#l8.32"></a><span id="l8.32"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar/content/datetimepickers/datetimepickers.css&quot;?&gt;</span>
<a href="#l8.33"></a><span id="l8.33" class="difflineplus">+&lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar/content/calendar-bindings.css&quot;?&gt;</span>
<a href="#l8.34"></a><span id="l8.34"> </span>
<a href="#l8.35"></a><span id="l8.35" class="difflineminus">-&lt;!DOCTYPE dialog [</span>
<a href="#l8.36"></a><span id="l8.36" class="difflineminus">-  &lt;!ENTITY % dtd1 SYSTEM &quot;chrome://calendar/locale/global.dtd&quot; &gt; %dtd1;</span>
<a href="#l8.37"></a><span id="l8.37" class="difflineminus">-  &lt;!ENTITY % dtd2 SYSTEM &quot;chrome://calendar/locale/calendar.dtd&quot; &gt; %dtd2;</span>
<a href="#l8.38"></a><span id="l8.38" class="difflineminus">-  &lt;!ENTITY % dtd3 SYSTEM &quot;chrome://calendar/locale/calendar-event-dialog.dtd&quot; &gt; %dtd3;</span>
<a href="#l8.39"></a><span id="l8.39" class="difflineminus">-]&gt;</span>
<a href="#l8.40"></a><span id="l8.40" class="difflineplus">+&lt;!DOCTYPE dialog SYSTEM &quot;chrome://calendar/locale/dialogs/calendar-event-dialog-reminder.dtd&quot; &gt;</span>
<a href="#l8.41"></a><span id="l8.41"> </span>
<a href="#l8.42"></a><span id="l8.42"> &lt;dialog id=&quot;calendar-event-dialog-reminder&quot;</span>
<a href="#l8.43"></a><span id="l8.43" class="difflineminus">-        title=&quot;&amp;reminder.title.label;&quot;</span>
<a href="#l8.44"></a><span id="l8.44" class="difflineplus">+        title=&quot;&amp;reminderdialog.title;&quot;</span>
<a href="#l8.45"></a><span id="l8.45">         windowtype=&quot;Calendar:EventDialog:Reminder&quot;</span>
<a href="#l8.46"></a><span id="l8.46">         onload=&quot;onLoad()&quot;</span>
<a href="#l8.47"></a><span id="l8.47">         ondialogaccept=&quot;return onAccept();&quot;</span>
<a href="#l8.48"></a><span id="l8.48">         ondialogcancel=&quot;return onCancel();&quot;</span>
<a href="#l8.49"></a><span id="l8.49">         persist=&quot;screenX screenY width height&quot;</span>
<a href="#l8.50"></a><span id="l8.50">         xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l8.51"></a><span id="l8.51"> </span>
<a href="#l8.52"></a><span id="l8.52">   &lt;!-- Javascript includes --&gt;</span>
<a href="#l8.53"></a><span id="l8.53">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://calendar/content/calendar-event-dialog-reminder.js&quot;/&gt;</span>
<a href="#l8.54"></a><span id="l8.54">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://calendar/content/calendar-ui-utils.js&quot;/&gt;</span>
<a href="#l8.55"></a><span id="l8.55">   &lt;script type=&quot;application/javascript&quot; src=&quot;chrome://calendar/content/calUtils.js&quot;/&gt;</span>
<a href="#l8.56"></a><span id="l8.56"> </span>
<a href="#l8.57"></a><span id="l8.57" class="difflineplus">+  &lt;notificationbox id=&quot;reminder-notifications&quot;/&gt;</span>
<a href="#l8.58"></a><span id="l8.58" class="difflineplus">+</span>
<a href="#l8.59"></a><span id="l8.59">   &lt;!-- Listbox with custom reminders --&gt;</span>
<a href="#l8.60"></a><span id="l8.60" class="difflineminus">-  &lt;grid flex=&quot;1&quot;&gt;</span>
<a href="#l8.61"></a><span id="l8.61" class="difflineminus">-    &lt;rows&gt;</span>
<a href="#l8.62"></a><span id="l8.62" class="difflineminus">-      &lt;row/&gt;</span>
<a href="#l8.63"></a><span id="l8.63" class="difflineminus">-      &lt;row/&gt;</span>
<a href="#l8.64"></a><span id="l8.64" class="difflineminus">-      &lt;row flex=&quot;1&quot;/&gt;</span>
<a href="#l8.65"></a><span id="l8.65" class="difflineminus">-      &lt;row/&gt;</span>
<a href="#l8.66"></a><span id="l8.66" class="difflineminus">-    &lt;/rows&gt;</span>
<a href="#l8.67"></a><span id="l8.67" class="difflineminus">-    &lt;columns&gt;</span>
<a href="#l8.68"></a><span id="l8.68" class="difflineminus">-      &lt;listbox id=&quot;reminder-listbox&quot;</span>
<a href="#l8.69"></a><span id="l8.69" class="difflineminus">-               seltype=&quot;single&quot;</span>
<a href="#l8.70"></a><span id="l8.70" class="difflineminus">-               class=&quot;event-dialog-listbox&quot;</span>
<a href="#l8.71"></a><span id="l8.71" class="difflineminus">-               onselect=&quot;onReminderSelected()&quot;</span>
<a href="#l8.72"></a><span id="l8.72" class="difflineminus">-               flex=&quot;1&quot;&gt;</span>
<a href="#l8.73"></a><span id="l8.73" class="difflineminus">-        &lt;listitem/&gt;</span>
<a href="#l8.74"></a><span id="l8.74" class="difflineminus">-      &lt;/listbox&gt;</span>
<a href="#l8.75"></a><span id="l8.75" class="difflineminus">-      &lt;column&gt;</span>
<a href="#l8.76"></a><span id="l8.76" class="difflineminus">-        &lt;button id=&quot;reminder-new&quot; label=&quot;&amp;reminder.new.label;&quot; oncommand=&quot;onNewReminder()&quot;/&gt;</span>
<a href="#l8.77"></a><span id="l8.77" class="difflineminus">-        &lt;button id=&quot;reminder-delete&quot; label=&quot;&amp;reminder.delete.label;&quot; oncommand=&quot;onDeleteReminder()&quot;/&gt;</span>
<a href="#l8.78"></a><span id="l8.78" class="difflineminus">-      &lt;/column&gt;</span>
<a href="#l8.79"></a><span id="l8.79" class="difflineminus">-    &lt;/columns&gt;</span>
<a href="#l8.80"></a><span id="l8.80" class="difflineminus">-  &lt;/grid&gt;</span>
<a href="#l8.81"></a><span id="l8.81" class="difflineplus">+  &lt;vbox flex=&quot;1&quot;&gt;</span>
<a href="#l8.82"></a><span id="l8.82" class="difflineplus">+    &lt;listbox id=&quot;reminder-listbox&quot;</span>
<a href="#l8.83"></a><span id="l8.83" class="difflineplus">+             seltype=&quot;single&quot;</span>
<a href="#l8.84"></a><span id="l8.84" class="difflineplus">+             class=&quot;event-dialog-listbox&quot;</span>
<a href="#l8.85"></a><span id="l8.85" class="difflineplus">+             onselect=&quot;onReminderSelected()&quot;</span>
<a href="#l8.86"></a><span id="l8.86" class="difflineplus">+             flex=&quot;1&quot;/&gt;</span>
<a href="#l8.87"></a><span id="l8.87" class="difflineplus">+    &lt;hbox id=&quot;reminder-action-buttons-box&quot; pack=&quot;end&quot;&gt;</span>
<a href="#l8.88"></a><span id="l8.88" class="difflineplus">+      &lt;button id=&quot;reminder-new-button&quot;</span>
<a href="#l8.89"></a><span id="l8.89" class="difflineplus">+              label=&quot;&amp;reminder.add.label;&quot;</span>
<a href="#l8.90"></a><span id="l8.90" class="difflineplus">+              accesskey=&quot;&amp;reminder.add.accesskey;&quot;</span>
<a href="#l8.91"></a><span id="l8.91" class="difflineplus">+              oncommand=&quot;onNewReminder()&quot;/&gt;</span>
<a href="#l8.92"></a><span id="l8.92" class="difflineplus">+      &lt;button id=&quot;reminder-remove-button&quot;</span>
<a href="#l8.93"></a><span id="l8.93" class="difflineplus">+              label=&quot;&amp;reminder.remove.label;&quot;</span>
<a href="#l8.94"></a><span id="l8.94" class="difflineplus">+              accesskey=&quot;&amp;reminder.remove.accesskey;&quot;</span>
<a href="#l8.95"></a><span id="l8.95" class="difflineplus">+              oncommand=&quot;onRemoveReminder()&quot;/&gt;</span>
<a href="#l8.96"></a><span id="l8.96" class="difflineplus">+    &lt;/hbox&gt;</span>
<a href="#l8.97"></a><span id="l8.97" class="difflineplus">+  &lt;/vbox&gt;</span>
<a href="#l8.98"></a><span id="l8.98"> </span>
<a href="#l8.99"></a><span id="l8.99">   &lt;!-- Custom reminder details --&gt;</span>
<a href="#l8.100"></a><span id="l8.100" class="difflineminus">-  &lt;groupbox&gt;</span>
<a href="#l8.101"></a><span id="l8.101" class="difflineminus">-    &lt;caption label=&quot;&amp;reminder.reminderDetails.label;&quot;/&gt;</span>
<a href="#l8.102"></a><span id="l8.102" class="difflineminus">-    &lt;radiogroup&gt;</span>
<a href="#l8.103"></a><span id="l8.103" class="difflineminus">-      &lt;grid flex=&quot;1&quot;&gt;</span>
<a href="#l8.104"></a><span id="l8.104" class="difflineminus">-        &lt;columns&gt;</span>
<a href="#l8.105"></a><span id="l8.105" class="difflineminus">-          &lt;column/&gt;</span>
<a href="#l8.106"></a><span id="l8.106" class="difflineminus">-          &lt;column flex=&quot;1&quot;/&gt;</span>
<a href="#l8.107"></a><span id="l8.107" class="difflineminus">-        &lt;/columns&gt;</span>
<a href="#l8.108"></a><span id="l8.108" class="difflineminus">-        &lt;rows&gt;</span>
<a href="#l8.109"></a><span id="l8.109" class="difflineminus">-          &lt;row align=&quot;top&quot;&gt;</span>
<a href="#l8.110"></a><span id="l8.110" class="difflineminus">-            &lt;radio selected=&quot;true&quot;/&gt;</span>
<a href="#l8.111"></a><span id="l8.111" class="difflineminus">-            &lt;vbox&gt;</span>
<a href="#l8.112"></a><span id="l8.112" class="difflineminus">-              &lt;hbox&gt;</span>
<a href="#l8.113"></a><span id="l8.113" class="difflineminus">-                &lt;textbox id=&quot;reminder-length&quot; size=&quot;5&quot; type=&quot;number&quot; max=&quot;32767&quot;</span>
<a href="#l8.114"></a><span id="l8.114" class="difflineminus">-                         oninput=&quot;updateReminderLength(event)&quot;/&gt;</span>
<a href="#l8.115"></a><span id="l8.115" class="difflineminus">-                &lt;menulist id=&quot;reminder-unit&quot; oncommand=&quot;updateReminder()&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l8.116"></a><span id="l8.116" class="difflineminus">-                  &lt;menupopup&gt;</span>
<a href="#l8.117"></a><span id="l8.117" class="difflineminus">-                    &lt;menuitem label=&quot;&amp;alarm.units.minutes;&quot; value=&quot;minutes&quot; selected=&quot;true&quot;/&gt;</span>
<a href="#l8.118"></a><span id="l8.118" class="difflineminus">-                    &lt;menuitem label=&quot;&amp;alarm.units.hours;&quot; value=&quot;hours&quot;/&gt;</span>
<a href="#l8.119"></a><span id="l8.119" class="difflineminus">-                    &lt;menuitem label=&quot;&amp;alarm.units.days;&quot; value=&quot;days&quot;/&gt;</span>
<a href="#l8.120"></a><span id="l8.120" class="difflineminus">-                  &lt;/menupopup&gt;</span>
<a href="#l8.121"></a><span id="l8.121" class="difflineminus">-                &lt;/menulist&gt;</span>
<a href="#l8.122"></a><span id="l8.122" class="difflineminus">-                &lt;menulist id=&quot;reminder-relation&quot; oncommand=&quot;updateReminder()&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l8.123"></a><span id="l8.123" class="difflineminus">-                  &lt;menupopup&gt;</span>
<a href="#l8.124"></a><span id="l8.124" class="difflineminus">-                    &lt;menuitem label=&quot;&amp;newevent.before.label;&quot; value=&quot;START&quot; selected=&quot;true&quot;/&gt;</span>
<a href="#l8.125"></a><span id="l8.125" class="difflineminus">-                    &lt;menuitem label=&quot;&amp;newevent.after.label;&quot; value=&quot;END&quot;/&gt;</span>
<a href="#l8.126"></a><span id="l8.126" class="difflineminus">-                  &lt;/menupopup&gt;</span>
<a href="#l8.127"></a><span id="l8.127" class="difflineminus">-                &lt;/menulist&gt;</span>
<a href="#l8.128"></a><span id="l8.128" class="difflineminus">-              &lt;/hbox&gt;</span>
<a href="#l8.129"></a><span id="l8.129" class="difflineminus">-              &lt;menulist id=&quot;reminder-origin&quot; oncommand=&quot;updateReminder()&quot;&gt;</span>
<a href="#l8.130"></a><span id="l8.130" class="difflineminus">-                &lt;menupopup&gt;</span>
<a href="#l8.131"></a><span id="l8.131" class="difflineminus">-                  &lt;menuitem label=&quot;&amp;reminder.relation.start.label;&quot; value=&quot;1&quot; selected=&quot;true&quot;/&gt;</span>
<a href="#l8.132"></a><span id="l8.132" class="difflineminus">-                  &lt;menuitem label=&quot;&amp;reminder.relation.end.label;&quot; value=&quot;-1&quot;/&gt;</span>
<a href="#l8.133"></a><span id="l8.133" class="difflineminus">-                &lt;/menupopup&gt;</span>
<a href="#l8.134"></a><span id="l8.134" class="difflineminus">-              &lt;/menulist&gt;</span>
<a href="#l8.135"></a><span id="l8.135" class="difflineminus">-            &lt;/vbox&gt;</span>
<a href="#l8.136"></a><span id="l8.136" class="difflineminus">-          &lt;/row&gt;</span>
<a href="#l8.137"></a><span id="l8.137" class="difflineminus">-          &lt;row&gt;</span>
<a href="#l8.138"></a><span id="l8.138" class="difflineminus">-            &lt;radio disabled=&quot;true&quot;/&gt;</span>
<a href="#l8.139"></a><span id="l8.139" class="difflineminus">-            &lt;datetimepicker id=&quot;reminder-duetime&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l8.140"></a><span id="l8.140" class="difflineminus">-          &lt;/row&gt;</span>
<a href="#l8.141"></a><span id="l8.141" class="difflineminus">-        &lt;/rows&gt;</span>
<a href="#l8.142"></a><span id="l8.142" class="difflineminus">-      &lt;/grid&gt;</span>
<a href="#l8.143"></a><span id="l8.143" class="difflineminus">-    &lt;/radiogroup&gt;</span>
<a href="#l8.144"></a><span id="l8.144" class="difflineminus">-  &lt;/groupbox&gt;</span>
<a href="#l8.145"></a><span id="l8.145" class="difflineplus">+  &lt;calendar-caption id=&quot;reminder-details-caption&quot; label=&quot;&amp;reminder.reminderDetails.label;&quot;/&gt;</span>
<a href="#l8.146"></a><span id="l8.146" class="difflineplus">+  &lt;radiogroup id=&quot;reminder-relation-radiogroup&quot;</span>
<a href="#l8.147"></a><span id="l8.147" class="difflineplus">+                onselect=&quot;setupRadioEnabledState(); updateReminder(event)&quot;&gt;</span>
<a href="#l8.148"></a><span id="l8.148" class="difflineplus">+    &lt;hbox id=&quot;reminder-relative-box&quot; align=&quot;top&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l8.149"></a><span id="l8.149" class="difflineplus">+      &lt;radio id=&quot;reminder-relative-radio&quot;</span>
<a href="#l8.150"></a><span id="l8.150" class="difflineplus">+             value=&quot;relative&quot;</span>
<a href="#l8.151"></a><span id="l8.151" class="difflineplus">+             aria-labeledby=&quot;reminder-length reminder-unit reminder-relation reminder-origin&quot;/&gt;</span>
<a href="#l8.152"></a><span id="l8.152" class="difflineplus">+      &lt;vbox id=&quot;reminder-relative-box&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l8.153"></a><span id="l8.153" class="difflineplus">+        &lt;hbox id=&quot;reminder-relative-length-unit-relation&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l8.154"></a><span id="l8.154" class="difflineplus">+          &lt;textbox id=&quot;reminder-length&quot;</span>
<a href="#l8.155"></a><span id="l8.155" class="difflineplus">+                   size=&quot;1&quot;</span>
<a href="#l8.156"></a><span id="l8.156" class="difflineplus">+                   oninput=&quot;validateIntegers(event); updateReminder(event)&quot;/&gt;</span>
<a href="#l8.157"></a><span id="l8.157" class="difflineplus">+          &lt;menulist id=&quot;reminder-unit&quot; oncommand=&quot;updateReminder(event)&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l8.158"></a><span id="l8.158" class="difflineplus">+            &lt;menupopup id=&quot;reminder-unit-menupopup&quot;&gt;</span>
<a href="#l8.159"></a><span id="l8.159" class="difflineplus">+              &lt;menuitem id=&quot;reminder-minutes-menuitem&quot;</span>
<a href="#l8.160"></a><span id="l8.160" class="difflineplus">+                        label=&quot;&amp;alarm.units.minutes;&quot;</span>
<a href="#l8.161"></a><span id="l8.161" class="difflineplus">+                        value=&quot;minutes&quot;/&gt;</span>
<a href="#l8.162"></a><span id="l8.162" class="difflineplus">+              &lt;menuitem id=&quot;reminder-hours-menuitem&quot;</span>
<a href="#l8.163"></a><span id="l8.163" class="difflineplus">+                        label=&quot;&amp;alarm.units.hours;&quot;</span>
<a href="#l8.164"></a><span id="l8.164" class="difflineplus">+                        value=&quot;hours&quot;/&gt;</span>
<a href="#l8.165"></a><span id="l8.165" class="difflineplus">+              &lt;menuitem id=&quot;reminder-days-menuitem&quot;</span>
<a href="#l8.166"></a><span id="l8.166" class="difflineplus">+                        label=&quot;&amp;alarm.units.days;&quot;</span>
<a href="#l8.167"></a><span id="l8.167" class="difflineplus">+                        value=&quot;days&quot;/&gt;</span>
<a href="#l8.168"></a><span id="l8.168" class="difflineplus">+            &lt;/menupopup&gt;</span>
<a href="#l8.169"></a><span id="l8.169" class="difflineplus">+          &lt;/menulist&gt;</span>
<a href="#l8.170"></a><span id="l8.170" class="difflineplus">+          &lt;menulist id=&quot;reminder-relation&quot; oncommand=&quot;updateReminder(event)&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l8.171"></a><span id="l8.171" class="difflineplus">+            &lt;menupopup&gt;</span>
<a href="#l8.172"></a><span id="l8.172" class="difflineplus">+              &lt;menuitem label=&quot;&amp;reminder.relation.before.label;&quot; value=&quot;before&quot;/&gt;</span>
<a href="#l8.173"></a><span id="l8.173" class="difflineplus">+              &lt;menuitem label=&quot;&amp;reminder.relation.after.label;&quot; value=&quot;after&quot;/&gt;</span>
<a href="#l8.174"></a><span id="l8.174" class="difflineplus">+            &lt;/menupopup&gt;</span>
<a href="#l8.175"></a><span id="l8.175" class="difflineplus">+          &lt;/menulist&gt;</span>
<a href="#l8.176"></a><span id="l8.176" class="difflineplus">+        &lt;/hbox&gt;</span>
<a href="#l8.177"></a><span id="l8.177" class="difflineplus">+        &lt;menulist id=&quot;reminder-origin&quot; oncommand=&quot;updateReminder(event)&quot;&gt;</span>
<a href="#l8.178"></a><span id="l8.178" class="difflineplus">+          &lt;menupopup id=&quot;reminder-origin-menupopup&quot;&gt;</span>
<a href="#l8.179"></a><span id="l8.179" class="difflineplus">+            &lt;menuitem id=&quot;reminder-origin-start-menuitem&quot;</span>
<a href="#l8.180"></a><span id="l8.180" class="difflineplus">+                      value=&quot;START&quot;/&gt;</span>
<a href="#l8.181"></a><span id="l8.181" class="difflineplus">+            &lt;menuitem id=&quot;reminder-origin-end-menuitem&quot;</span>
<a href="#l8.182"></a><span id="l8.182" class="difflineplus">+                      value=&quot;END&quot;/&gt;</span>
<a href="#l8.183"></a><span id="l8.183" class="difflineplus">+          &lt;/menupopup&gt;</span>
<a href="#l8.184"></a><span id="l8.184" class="difflineplus">+        &lt;/menulist&gt;</span>
<a href="#l8.185"></a><span id="l8.185" class="difflineplus">+      &lt;/vbox&gt;</span>
<a href="#l8.186"></a><span id="l8.186" class="difflineplus">+    &lt;/hbox&gt;</span>
<a href="#l8.187"></a><span id="l8.187" class="difflineplus">+    &lt;hbox id=&quot;reminder-absolute-box&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l8.188"></a><span id="l8.188" class="difflineplus">+      &lt;radio id=&quot;reminder-absolute-radio&quot;</span>
<a href="#l8.189"></a><span id="l8.189" class="difflineplus">+             control=&quot;reminder-absolute-date&quot;</span>
<a href="#l8.190"></a><span id="l8.190" class="difflineplus">+             value=&quot;absolute&quot;/&gt;</span>
<a href="#l8.191"></a><span id="l8.191" class="difflineplus">+      &lt;datetimepicker id=&quot;reminder-absolute-date&quot;/&gt;</span>
<a href="#l8.192"></a><span id="l8.192" class="difflineplus">+    &lt;/hbox&gt;</span>
<a href="#l8.193"></a><span id="l8.193" class="difflineplus">+  &lt;/radiogroup&gt;</span>
<a href="#l8.194"></a><span id="l8.194"> </span>
<a href="#l8.195"></a><span id="l8.195">   &lt;!-- Custom reminder action --&gt;</span>
<a href="#l8.196"></a><span id="l8.196" class="difflineminus">-  &lt;groupbox&gt;</span>
<a href="#l8.197"></a><span id="l8.197" class="difflineminus">-    &lt;caption label=&quot;&amp;reminder.action.label;&quot;/&gt;</span>
<a href="#l8.198"></a><span id="l8.198" class="difflineminus">-    &lt;checkbox label=&quot;&amp;reminder.action.alert.label;&quot; checked=&quot;true&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l8.199"></a><span id="l8.199" class="difflineminus">-    &lt;checkbox label=&quot;&amp;reminder.action.email.label;&quot; disabled=&quot;true&quot;/&gt;</span>
<a href="#l8.200"></a><span id="l8.200" class="difflineminus">-  &lt;/groupbox&gt;</span>
<a href="#l8.201"></a><span id="l8.201" class="difflineplus">+  &lt;calendar-caption id=&quot;reminder-actions-caption&quot;</span>
<a href="#l8.202"></a><span id="l8.202" class="difflineplus">+                    control=&quot;reminder-actions-menulist&quot;</span>
<a href="#l8.203"></a><span id="l8.203" class="difflineplus">+                    label=&quot;&amp;reminder.action.label;&quot;/&gt;</span>
<a href="#l8.204"></a><span id="l8.204" class="difflineplus">+  &lt;menulist id=&quot;reminder-actions-menulist&quot;</span>
<a href="#l8.205"></a><span id="l8.205" class="difflineplus">+            oncommand=&quot;updateReminder(event)&quot;</span>
<a href="#l8.206"></a><span id="l8.206" class="difflineplus">+            class=&quot;reminder-icon&quot;&gt;</span>
<a href="#l8.207"></a><span id="l8.207" class="difflineplus">+    &lt;!-- Make sure the id is formatted &quot;reminder-action-&lt;VALUE&gt;&quot;, for accessibility --&gt;</span>
<a href="#l8.208"></a><span id="l8.208" class="difflineplus">+    &lt;!-- TODO provider specific --&gt;</span>
<a href="#l8.209"></a><span id="l8.209" class="difflineplus">+    &lt;menupopup id=&quot;reminder-actions-menupopup&quot;&gt;</span>
<a href="#l8.210"></a><span id="l8.210" class="difflineplus">+      &lt;menuitem id=&quot;reminder-action-DISPLAY&quot;</span>
<a href="#l8.211"></a><span id="l8.211" class="difflineplus">+                class=&quot;reminder-icon menuitem-iconic&quot;</span>
<a href="#l8.212"></a><span id="l8.212" class="difflineplus">+                value=&quot;DISPLAY&quot;</span>
<a href="#l8.213"></a><span id="l8.213" class="difflineplus">+                label=&quot;&amp;reminder.action.alert.label;&quot;/&gt;</span>
<a href="#l8.214"></a><span id="l8.214" class="difflineplus">+      &lt;menuitem id=&quot;reminder-action-EMAIL&quot;</span>
<a href="#l8.215"></a><span id="l8.215" class="difflineplus">+                class=&quot;reminder-icon menuitem-iconic&quot;</span>
<a href="#l8.216"></a><span id="l8.216" class="difflineplus">+                value=&quot;EMAIL&quot;</span>
<a href="#l8.217"></a><span id="l8.217" class="difflineplus">+                label=&quot;&amp;reminder.action.email.label;&quot;/&gt;</span>
<a href="#l8.218"></a><span id="l8.218" class="difflineplus">+    &lt;/menupopup&gt;</span>
<a href="#l8.219"></a><span id="l8.219" class="difflineplus">+  &lt;/menulist&gt;</span>
<a href="#l8.220"></a><span id="l8.220"> &lt;/dialog&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog.js</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog.js</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -385,17 +385,17 @@ function loadDialog(item) {</span>
<a href="#l9.4"></a><span id="l9.4">     // Privacy</span>
<a href="#l9.5"></a><span id="l9.5">     gPrivacy = item.privacy;</span>
<a href="#l9.6"></a><span id="l9.6">     updatePrivacy();</span>
<a href="#l9.7"></a><span id="l9.7"> </span>
<a href="#l9.8"></a><span id="l9.8">     // load repeat details</span>
<a href="#l9.9"></a><span id="l9.9">     loadRepeat(item);</span>
<a href="#l9.10"></a><span id="l9.10"> </span>
<a href="#l9.11"></a><span id="l9.11">     // load reminder details</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-    loadReminder(item);</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+    loadReminders(item.getAlarms({}));</span>
<a href="#l9.14"></a><span id="l9.14"> </span>
<a href="#l9.15"></a><span id="l9.15">     // hide rows based on if this is an event or todo</span>
<a href="#l9.16"></a><span id="l9.16">     updateStyle();</span>
<a href="#l9.17"></a><span id="l9.17"> </span>
<a href="#l9.18"></a><span id="l9.18">     updateDateTime();</span>
<a href="#l9.19"></a><span id="l9.19"> </span>
<a href="#l9.20"></a><span id="l9.20">     updateCalendar();</span>
<a href="#l9.21"></a><span id="l9.21"> </span>
<a href="#l9.22"></a><span id="l9.22" class="difflineat">@@ -2839,16 +2839,17 @@ function sendMailToAttendees(aAttendees)</span>
<a href="#l9.23"></a><span id="l9.23"> </span>
<a href="#l9.24"></a><span id="l9.24"> /**</span>
<a href="#l9.25"></a><span id="l9.25">  * Make sure all fields that may have calendar specific capabilities are updated</span>
<a href="#l9.26"></a><span id="l9.26">  */</span>
<a href="#l9.27"></a><span id="l9.27"> function updateCapabilities() {</span>
<a href="#l9.28"></a><span id="l9.28">     updateAttachment();</span>
<a href="#l9.29"></a><span id="l9.29">     updatePriority();</span>
<a href="#l9.30"></a><span id="l9.30">     updatePrivacy();</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineplus">+    updateReminderDetails();</span>
<a href="#l9.32"></a><span id="l9.32"> }</span>
<a href="#l9.33"></a><span id="l9.33"> </span>
<a href="#l9.34"></a><span id="l9.34"> /**</span>
<a href="#l9.35"></a><span id="l9.35">  * Test if a specific capability is supported</span>
<a href="#l9.36"></a><span id="l9.36">  *</span>
<a href="#l9.37"></a><span id="l9.37">  * @param aCap      The capability from &quot;capabilities.&lt;aCap&gt;.supported&quot;</span>
<a href="#l9.38"></a><span id="l9.38">  */</span>
<a href="#l9.39"></a><span id="l9.39"> function capSupported(aCap) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog.xul</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog.xul</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -34,16 +34,17 @@</span>
<a href="#l10.4"></a><span id="l10.4">    - decision by deleting the provisions above and replace them with the notice</span>
<a href="#l10.5"></a><span id="l10.5">    - and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l10.6"></a><span id="l10.6">    - the provisions above, a recipient may use your version of this file under</span>
<a href="#l10.7"></a><span id="l10.7">    - the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l10.8"></a><span id="l10.8">    -</span>
<a href="#l10.9"></a><span id="l10.9">    - ***** END LICENSE BLOCK ***** --&gt;</span>
<a href="#l10.10"></a><span id="l10.10"> </span>
<a href="#l10.11"></a><span id="l10.11"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://global/skin/global.css&quot;?&gt;</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineplus">+&lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar/skin/calendar-alarms.css&quot;?&gt;</span>
<a href="#l10.13"></a><span id="l10.13"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar/skin/calendar-event-dialog.css&quot;?&gt;</span>
<a href="#l10.14"></a><span id="l10.14"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar/content/calendar-event-dialog.css&quot;?&gt;</span>
<a href="#l10.15"></a><span id="l10.15"> &lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://calendar/content/datetimepickers/datetimepickers.css&quot;?&gt;</span>
<a href="#l10.16"></a><span id="l10.16"> </span>
<a href="#l10.17"></a><span id="l10.17"> &lt;!DOCTYPE dialog [</span>
<a href="#l10.18"></a><span id="l10.18">     &lt;!ENTITY % brandDTD SYSTEM &quot;chrome://branding/locale/brand.dtd&quot;&gt;</span>
<a href="#l10.19"></a><span id="l10.19">     &lt;!ENTITY % globalDTD SYSTEM &quot;chrome://calendar/locale/global.dtd&quot;&gt;</span>
<a href="#l10.20"></a><span id="l10.20">     &lt;!ENTITY % calendarDTD SYSTEM &quot;chrome://calendar/locale/calendar.dtd&quot;&gt;</span>
<a href="#l10.21"></a><span id="l10.21" class="difflineat">@@ -909,66 +910,66 @@</span>
<a href="#l10.22"></a><span id="l10.22">                         &lt;menupopup id=&quot;item-alarm-menupopup&quot;&gt;</span>
<a href="#l10.23"></a><span id="l10.23">                             &lt;menuitem id=&quot;reminder-none-menuitem&quot;</span>
<a href="#l10.24"></a><span id="l10.24">                                       label=&quot;&amp;event.reminder.none.label;&quot;</span>
<a href="#l10.25"></a><span id="l10.25">                                       selected=&quot;true&quot;</span>
<a href="#l10.26"></a><span id="l10.26">                                       value=&quot;none&quot;/&gt;</span>
<a href="#l10.27"></a><span id="l10.27">                             &lt;menuitem id=&quot;reminder-5minutes-menuitem&quot;</span>
<a href="#l10.28"></a><span id="l10.28">                                       label=&quot;&amp;event.reminder.5minutes.before.label;&quot;</span>
<a href="#l10.29"></a><span id="l10.29">                                       length=&quot;5&quot;</span>
<a href="#l10.30"></a><span id="l10.30" class="difflineminus">-                                      origin=&quot;1&quot;</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineplus">+                                      origin=&quot;before&quot;</span>
<a href="#l10.32"></a><span id="l10.32">                                       relation=&quot;START&quot;</span>
<a href="#l10.33"></a><span id="l10.33">                                       unit=&quot;minutes&quot;/&gt;</span>
<a href="#l10.34"></a><span id="l10.34">                             &lt;menuitem id=&quot;reminder-10minutes-menuitem&quot;</span>
<a href="#l10.35"></a><span id="l10.35">                                       label=&quot;&amp;event.reminder.10minutes.before.label;&quot;</span>
<a href="#l10.36"></a><span id="l10.36">                                       length=&quot;10&quot;</span>
<a href="#l10.37"></a><span id="l10.37" class="difflineminus">-                                      origin=&quot;1&quot;</span>
<a href="#l10.38"></a><span id="l10.38" class="difflineplus">+                                      origin=&quot;before&quot;</span>
<a href="#l10.39"></a><span id="l10.39">                                       relation=&quot;START&quot;</span>
<a href="#l10.40"></a><span id="l10.40">                                       unit=&quot;minutes&quot;/&gt;</span>
<a href="#l10.41"></a><span id="l10.41">                             &lt;menuitem id=&quot;reminder-15minutes-menuitem&quot;</span>
<a href="#l10.42"></a><span id="l10.42">                                       label=&quot;&amp;event.reminder.15minutes.before.label;&quot;</span>
<a href="#l10.43"></a><span id="l10.43">                                       length=&quot;15&quot;</span>
<a href="#l10.44"></a><span id="l10.44" class="difflineminus">-                                      origin=&quot;1&quot;</span>
<a href="#l10.45"></a><span id="l10.45" class="difflineplus">+                                      origin=&quot;before&quot;</span>
<a href="#l10.46"></a><span id="l10.46">                                       relation=&quot;START&quot;</span>
<a href="#l10.47"></a><span id="l10.47">                                       unit=&quot;minutes&quot;/&gt;</span>
<a href="#l10.48"></a><span id="l10.48">                             &lt;menuitem id=&quot;reminder-30minutes-menuitem&quot;</span>
<a href="#l10.49"></a><span id="l10.49">                                       label=&quot;&amp;event.reminder.30minutes.before.label;&quot;</span>
<a href="#l10.50"></a><span id="l10.50">                                       length=&quot;30&quot;</span>
<a href="#l10.51"></a><span id="l10.51" class="difflineminus">-                                      origin=&quot;1&quot;</span>
<a href="#l10.52"></a><span id="l10.52" class="difflineplus">+                                      origin=&quot;before&quot;</span>
<a href="#l10.53"></a><span id="l10.53">                                       relation=&quot;START&quot;</span>
<a href="#l10.54"></a><span id="l10.54">                                       unit=&quot;minutes&quot;/&gt;</span>
<a href="#l10.55"></a><span id="l10.55">                             &lt;menuitem id=&quot;reminder-45minutes-menuitem&quot;</span>
<a href="#l10.56"></a><span id="l10.56">                                       label=&quot;&amp;event.reminder.45minutes.before.label;&quot;</span>
<a href="#l10.57"></a><span id="l10.57">                                       length=&quot;45&quot;</span>
<a href="#l10.58"></a><span id="l10.58" class="difflineminus">-                                      origin=&quot;1&quot;</span>
<a href="#l10.59"></a><span id="l10.59" class="difflineplus">+                                      origin=&quot;before&quot;</span>
<a href="#l10.60"></a><span id="l10.60">                                       relation=&quot;START&quot;</span>
<a href="#l10.61"></a><span id="l10.61">                                       unit=&quot;minutes&quot;/&gt;</span>
<a href="#l10.62"></a><span id="l10.62">                             &lt;menuseparator id=&quot;reminder-minutes-separator&quot;/&gt;</span>
<a href="#l10.63"></a><span id="l10.63">                             &lt;menuitem id=&quot;reminder-1hour-menuitem&quot;</span>
<a href="#l10.64"></a><span id="l10.64">                                       label=&quot;&amp;event.reminder.1hour.before.label;&quot;</span>
<a href="#l10.65"></a><span id="l10.65">                                       length=&quot;1&quot;</span>
<a href="#l10.66"></a><span id="l10.66" class="difflineminus">-                                      origin=&quot;1&quot;</span>
<a href="#l10.67"></a><span id="l10.67" class="difflineplus">+                                      origin=&quot;before&quot;</span>
<a href="#l10.68"></a><span id="l10.68">                                       relation=&quot;START&quot;</span>
<a href="#l10.69"></a><span id="l10.69">                                       unit=&quot;hours&quot;/&gt;</span>
<a href="#l10.70"></a><span id="l10.70">                             &lt;menuitem id=&quot;reminder-2hours-menuitem&quot;</span>
<a href="#l10.71"></a><span id="l10.71">                                       label=&quot;&amp;event.reminder.2hours.before.label;&quot;</span>
<a href="#l10.72"></a><span id="l10.72">                                       length=&quot;2&quot;</span>
<a href="#l10.73"></a><span id="l10.73" class="difflineminus">-                                      origin=&quot;1&quot;</span>
<a href="#l10.74"></a><span id="l10.74" class="difflineplus">+                                      origin=&quot;before&quot;</span>
<a href="#l10.75"></a><span id="l10.75">                                       relation=&quot;START&quot;</span>
<a href="#l10.76"></a><span id="l10.76">                                       unit=&quot;hours&quot;/&gt;</span>
<a href="#l10.77"></a><span id="l10.77">                             &lt;menuitem id=&quot;reminder-5hours-menuitem&quot;</span>
<a href="#l10.78"></a><span id="l10.78">                                       label=&quot;&amp;event.reminder.5hours.before.label;&quot;</span>
<a href="#l10.79"></a><span id="l10.79">                                       length=&quot;5&quot;</span>
<a href="#l10.80"></a><span id="l10.80" class="difflineminus">-                                      origin=&quot;1&quot;</span>
<a href="#l10.81"></a><span id="l10.81" class="difflineplus">+                                      origin=&quot;before&quot;</span>
<a href="#l10.82"></a><span id="l10.82">                                       relation=&quot;START&quot;</span>
<a href="#l10.83"></a><span id="l10.83">                                       unit=&quot;hours&quot;/&gt;</span>
<a href="#l10.84"></a><span id="l10.84">                             &lt;menuitem id=&quot;reminder-15hours-menuitem&quot;</span>
<a href="#l10.85"></a><span id="l10.85">                                       label=&quot;&amp;event.reminder.15hours.before.label;&quot;</span>
<a href="#l10.86"></a><span id="l10.86">                                       length=&quot;15&quot;</span>
<a href="#l10.87"></a><span id="l10.87" class="difflineminus">-                                      origin=&quot;1&quot;</span>
<a href="#l10.88"></a><span id="l10.88" class="difflineplus">+                                      origin=&quot;before&quot;</span>
<a href="#l10.89"></a><span id="l10.89">                                       relation=&quot;START&quot;</span>
<a href="#l10.90"></a><span id="l10.90">                                       unit=&quot;hours&quot;/&gt;</span>
<a href="#l10.91"></a><span id="l10.91">                             &lt;menuseparator id=&quot;reminder-hours-separator&quot;/&gt;</span>
<a href="#l10.92"></a><span id="l10.92">                             &lt;menuitem id=&quot;reminder-1day-menuitem&quot;</span>
<a href="#l10.93"></a><span id="l10.93">                                       label=&quot;&amp;event.reminder.1day.before.label;&quot;</span>
<a href="#l10.94"></a><span id="l10.94">                                       length=&quot;1&quot;</span>
<a href="#l10.95"></a><span id="l10.95">                                       origin=&quot;1&quot;</span>
<a href="#l10.96"></a><span id="l10.96">                                       relation=&quot;START&quot;</span>
<a href="#l10.97"></a><span id="l10.97" class="difflineat">@@ -986,24 +987,38 @@</span>
<a href="#l10.98"></a><span id="l10.98">                                       relation=&quot;START&quot;</span>
<a href="#l10.99"></a><span id="l10.99">                                       unit=&quot;days&quot;/&gt;</span>
<a href="#l10.100"></a><span id="l10.100">                             &lt;menuseparator id=&quot;reminder-custom-separator&quot;/&gt;</span>
<a href="#l10.101"></a><span id="l10.101">                             &lt;menuitem id=&quot;reminder-custom-menuitem&quot;</span>
<a href="#l10.102"></a><span id="l10.102">                                       label=&quot;&amp;event.reminder.custom.label;&quot;</span>
<a href="#l10.103"></a><span id="l10.103">                                       value=&quot;custom&quot;/&gt;</span>
<a href="#l10.104"></a><span id="l10.104">                         &lt;/menupopup&gt;</span>
<a href="#l10.105"></a><span id="l10.105">                     &lt;/menulist&gt;</span>
<a href="#l10.106"></a><span id="l10.106" class="difflineminus">-                    &lt;vbox id=&quot;reminder-details&quot;&gt;</span>
<a href="#l10.107"></a><span id="l10.107" class="difflineminus">-                        &lt;label class=&quot;text-link&quot;</span>
<a href="#l10.108"></a><span id="l10.108" class="difflineminus">-                               disable-on-readonly=&quot;true&quot;</span>
<a href="#l10.109"></a><span id="l10.109" class="difflineminus">-                               flex=&quot;1&quot;</span>
<a href="#l10.110"></a><span id="l10.110" class="difflineminus">-                               hyperlink=&quot;true&quot;</span>
<a href="#l10.111"></a><span id="l10.111" class="difflineminus">-                               onclick=&quot;updateReminder()&quot;/&gt;</span>
<a href="#l10.112"></a><span id="l10.112" class="difflineminus">-                    &lt;/vbox&gt;</span>
<a href="#l10.113"></a><span id="l10.113" class="difflineminus">-                &lt;/hbox&gt;</span>
<a href="#l10.114"></a><span id="l10.114" class="difflineplus">+                    &lt;hbox id=&quot;reminder-details&quot;&gt;</span>
<a href="#l10.115"></a><span id="l10.115" class="difflineplus">+                      &lt;hbox id=&quot;reminder-icon-box&quot;</span>
<a href="#l10.116"></a><span id="l10.116" class="difflineplus">+                            class=&quot;alarm-icons-box&quot;</span>
<a href="#l10.117"></a><span id="l10.117" class="difflineplus">+                            align=&quot;center&quot;/&gt;</span>
<a href="#l10.118"></a><span id="l10.118" class="difflineplus">+                      &lt;!-- TODO oncommand? onkeypress? --&gt;</span>
<a href="#l10.119"></a><span id="l10.119" class="difflineplus">+                      &lt;label id=&quot;reminder-multiple-alarms-label&quot;</span>
<a href="#l10.120"></a><span id="l10.120" class="difflineplus">+                             hidden=&quot;true&quot;</span>
<a href="#l10.121"></a><span id="l10.121" class="difflineplus">+                             value=&quot;&amp;event.reminder.multiple.label;&quot;</span>
<a href="#l10.122"></a><span id="l10.122" class="difflineplus">+                             class=&quot;text-link&quot;</span>
<a href="#l10.123"></a><span id="l10.123" class="difflineplus">+                             disable-on-readonly=&quot;true&quot;</span>
<a href="#l10.124"></a><span id="l10.124" class="difflineplus">+                             flex=&quot;1&quot;</span>
<a href="#l10.125"></a><span id="l10.125" class="difflineplus">+                             hyperlink=&quot;true&quot;</span>
<a href="#l10.126"></a><span id="l10.126" class="difflineplus">+                             onclick=&quot;updateReminder()&quot;/&gt;</span>
<a href="#l10.127"></a><span id="l10.127" class="difflineplus">+                      &lt;label id=&quot;reminder-single-alarms-label&quot;</span>
<a href="#l10.128"></a><span id="l10.128" class="difflineplus">+                             hidden=&quot;true&quot;</span>
<a href="#l10.129"></a><span id="l10.129" class="difflineplus">+                             class=&quot;text-link&quot;</span>
<a href="#l10.130"></a><span id="l10.130" class="difflineplus">+                             disable-on-readonly=&quot;true&quot;</span>
<a href="#l10.131"></a><span id="l10.131" class="difflineplus">+                             flex=&quot;1&quot;</span>
<a href="#l10.132"></a><span id="l10.132" class="difflineplus">+                             hyperlink=&quot;true&quot;</span>
<a href="#l10.133"></a><span id="l10.133" class="difflineplus">+                             onclick=&quot;updateReminder()&quot;/&gt;</span>
<a href="#l10.134"></a><span id="l10.134" class="difflineplus">+                    &lt;/hbox&gt;</span>
<a href="#l10.135"></a><span id="l10.135" class="difflineplus">+               &lt;/hbox&gt;</span>
<a href="#l10.136"></a><span id="l10.136">             &lt;/row&gt;</span>
<a href="#l10.137"></a><span id="l10.137"> </span>
<a href="#l10.138"></a><span id="l10.138">             &lt;separator id=&quot;event-grid-description-separator&quot;</span>
<a href="#l10.139"></a><span id="l10.139">                        class=&quot;groove&quot;/&gt;</span>
<a href="#l10.140"></a><span id="l10.140"> </span>
<a href="#l10.141"></a><span id="l10.141">             &lt;!-- Description --&gt;</span>
<a href="#l10.142"></a><span id="l10.142">             &lt;row id=&quot;description-row&quot; flex=&quot;1&quot;&gt;</span>
<a href="#l10.143"></a><span id="l10.143">                 &lt;label value=&quot;&amp;event.description.label;&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/base/jar.mn</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/base/jar.mn</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -93,19 +93,18 @@ calendar.jar:</span>
<a href="#l11.4"></a><span id="l11.4">     content/calendar/widgets/calendar-widget-bindings.css  (content/widgets/calendar-widget-bindings.css)</span>
<a href="#l11.5"></a><span id="l11.5"> *   content/calendar/calApplicationUtils.js                (src/calApplicationUtils.js)</span>
<a href="#l11.6"></a><span id="l11.6">     content/calendar/calUtils.js                           (src/calUtils.js)</span>
<a href="#l11.7"></a><span id="l11.7">     content/calendar/calFilter.js                          (src/calFilter.js)</span>
<a href="#l11.8"></a><span id="l11.8">     content/calendar/Windows98ToZoneInfoTZId.properties    (src/Windows98ToZoneInfoTZId.properties)</span>
<a href="#l11.9"></a><span id="l11.9">     content/calendar/WindowsNTToZoneInfoTZId.properties    (src/WindowsNTToZoneInfoTZId.properties)</span>
<a href="#l11.10"></a><span id="l11.10"> % skin calendar classic/1.0 %skin/calendar/</span>
<a href="#l11.11"></a><span id="l11.11">     skin/calendar/abcard.png                               (themes/common/abcard.png)</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-    skin/calendar/alarm-suppressed.png                     (themes/common/alarm-suppressed.png)</span>
<a href="#l11.13"></a><span id="l11.13">     skin/calendar/alarm-flashing.png                       (themes/common/alarm-flashing.png)</span>
<a href="#l11.14"></a><span id="l11.14" class="difflineminus">-    skin/calendar/alarm.png                                (themes/common/alarm.png)</span>
<a href="#l11.15"></a><span id="l11.15" class="difflineplus">+    skin/calendar/alarm-icons.png                          (themes/common/alarm-icons.png)</span>
<a href="#l11.16"></a><span id="l11.16">     skin/calendar/calendar-day-label-back.png              (themes/common/calendar-day-label-back.png)</span>
<a href="#l11.17"></a><span id="l11.17">     skin/calendar/calendar-overlay.png                     (themes/common/calendar-overlay.png)</span>
<a href="#l11.18"></a><span id="l11.18">     skin/calendar/category-overlay.png                     (themes/common/category-overlay.png)</span>
<a href="#l11.19"></a><span id="l11.19">     skin/calendar/calendar-status.png                      (themes/common/calendar-status.png)</span>
<a href="#l11.20"></a><span id="l11.20">     skin/calendar/daypicker-background.png                 (themes/common/daypicker-background.png)</span>
<a href="#l11.21"></a><span id="l11.21">     skin/calendar/day-box-item-image.png                   (themes/common/day-box-item-image.png)</span>
<a href="#l11.22"></a><span id="l11.22">     skin/calendar/event-grippy-bottom.png                  (themes/common/event-grippy-bottom.png)</span>
<a href="#l11.23"></a><span id="l11.23">     skin/calendar/event-grippy-left.png                    (themes/common/event-grippy-left.png)</span>
<a href="#l11.24"></a><span id="l11.24" class="difflineat">@@ -113,16 +112,17 @@ calendar.jar:</span>
<a href="#l11.25"></a><span id="l11.25">     skin/calendar/event-grippy-top.png                     (themes/common/event-grippy-top.png)</span>
<a href="#l11.26"></a><span id="l11.26">     skin/calendar/gradient-overlay.png                     (themes/common/gradient-overlay.png)</span>
<a href="#l11.27"></a><span id="l11.27">     skin/calendar/mini-day-background.png                  (themes/common/mini-day-background.png)</span>
<a href="#l11.28"></a><span id="l11.28">     skin/calendar/unifinder-images.png                     (themes/common/unifinder-images.png)</span>
<a href="#l11.29"></a><span id="l11.29">     skin/calendar/widgets/nav-buttons.png                  (themes/common/widgets/nav-buttons.png)</span>
<a href="#l11.30"></a><span id="l11.30">     skin/calendar/widgets/view-navigation.png              (themes/common/widgets/view-navigation.png)</span>
<a href="#l11.31"></a><span id="l11.31">     skin/calendar/cal-icon32.png                           (themes/@THEME@/cal-icon32.png)</span>
<a href="#l11.32"></a><span id="l11.32">     skin/calendar/calendar-alarm-dialog.css                (themes/@THEME@/calendar-alarm-dialog.css)</span>
<a href="#l11.33"></a><span id="l11.33" class="difflineplus">+    skin/calendar/calendar-alarms.css                      (themes/@THEME@/calendar-alarms.css)</span>
<a href="#l11.34"></a><span id="l11.34">     skin/calendar/calendar-creation-wizard.css             (themes/@THEME@/calendar-creation-wizard.css)</span>
<a href="#l11.35"></a><span id="l11.35">     skin/calendar/calendar-daypicker.css                   (themes/@THEME@/calendar-daypicker.css)</span>
<a href="#l11.36"></a><span id="l11.36">     skin/calendar/calendar-event-dialog.css                (themes/@THEME@/calendar-event-dialog.css)</span>
<a href="#l11.37"></a><span id="l11.37">     skin/calendar/calendar-event-dialog-attendees.png      (themes/@THEME@/dialogs/calendar-event-dialog-attendees.png)</span>
<a href="#l11.38"></a><span id="l11.38">     skin/calendar/calendar-event-dialog-toolbar.png        (themes/@THEME@/dialogs/calendar-event-dialog-toolbar.png)</span>
<a href="#l11.39"></a><span id="l11.39">     skin/calendar/calendar-event-dialog.png                (themes/@THEME@/dialogs/calendar-event-dialog.png)</span>
<a href="#l11.40"></a><span id="l11.40">     skin/calendar/calendar-invitations-dialog.css          (themes/@THEME@/dialogs/calendar-invitations-dialog.css)</span>
<a href="#l11.41"></a><span id="l11.41">     skin/calendar/calendar-invitations-dialog-button-images.png  (themes/@THEME@/dialogs/calendar-invitations-dialog-button-images.png)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/base/modules/calAlarmUtils.jsm</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/base/modules/calAlarmUtils.jsm</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -71,24 +71,35 @@ cal.alarms = {</span>
<a href="#l12.4"></a><span id="l12.4">      * @return          The alarm offset.</span>
<a href="#l12.5"></a><span id="l12.5">      */</span>
<a href="#l12.6"></a><span id="l12.6">     calculateAlarmDate: function cal_alarm_calculateAlarmDate(aItem, aAlarm) {</span>
<a href="#l12.7"></a><span id="l12.7">         if (aAlarm.related == aAlarm.ALARM_RELATED_ABSOLUTE) {</span>
<a href="#l12.8"></a><span id="l12.8">             return aAlarm.alarmDate;</span>
<a href="#l12.9"></a><span id="l12.9">         } else {</span>
<a href="#l12.10"></a><span id="l12.10">             let returnDate;</span>
<a href="#l12.11"></a><span id="l12.11">             if (aAlarm.related == aAlarm.ALARM_RELATED_START) {</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-                let startDate = aItem[cal.calGetStartDateProp(aItem)];</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineminus">-                returnDate = startDate &amp;&amp; startDate.clone();</span>
<a href="#l12.14"></a><span id="l12.14" class="difflineplus">+                returnDate = aItem[cal.calGetStartDateProp(aItem)];</span>
<a href="#l12.15"></a><span id="l12.15">             } else if (aAlarm.related = aAlarm.ALARM_RELATED_END) {</span>
<a href="#l12.16"></a><span id="l12.16" class="difflineminus">-                let endDate = aItem[cal.calGetEndDateProp(aItem)];</span>
<a href="#l12.17"></a><span id="l12.17" class="difflineminus">-                returnDate = endDate &amp;&amp; endDate.clone();</span>
<a href="#l12.18"></a><span id="l12.18" class="difflineplus">+                returnDate = aItem[cal.calGetEndDateProp(aItem)];</span>
<a href="#l12.19"></a><span id="l12.19">             }</span>
<a href="#l12.20"></a><span id="l12.20"> </span>
<a href="#l12.21"></a><span id="l12.21">             if (returnDate &amp;&amp; aAlarm.offset) {</span>
<a href="#l12.22"></a><span id="l12.22" class="difflineplus">+                // Handle all day events.  This is kinda weird, because they don't</span>
<a href="#l12.23"></a><span id="l12.23" class="difflineplus">+                // have a well defined startTime.  We just consider the start/end</span>
<a href="#l12.24"></a><span id="l12.24" class="difflineplus">+                // to be midnight in the user's timezone.</span>
<a href="#l12.25"></a><span id="l12.25" class="difflineplus">+                if (returnDate.isDate) {</span>
<a href="#l12.26"></a><span id="l12.26" class="difflineplus">+                    let tz = cal.calendarDefaultTimezone();</span>
<a href="#l12.27"></a><span id="l12.27" class="difflineplus">+                    // This returns a copy, so no extra cloning needed.</span>
<a href="#l12.28"></a><span id="l12.28" class="difflineplus">+                    returnDate = alarmDate.getInTimezone(tz);</span>
<a href="#l12.29"></a><span id="l12.29" class="difflineplus">+                    returnDate.isDate = false;</span>
<a href="#l12.30"></a><span id="l12.30" class="difflineplus">+                } else {</span>
<a href="#l12.31"></a><span id="l12.31" class="difflineplus">+                    // Clone the date to correctly add the duration.</span>
<a href="#l12.32"></a><span id="l12.32" class="difflineplus">+                    returnDate = returnDate.clone();</span>
<a href="#l12.33"></a><span id="l12.33" class="difflineplus">+                }</span>
<a href="#l12.34"></a><span id="l12.34" class="difflineplus">+</span>
<a href="#l12.35"></a><span id="l12.35">                 returnDate.addDuration(aAlarm.offset);</span>
<a href="#l12.36"></a><span id="l12.36">                 return returnDate;</span>
<a href="#l12.37"></a><span id="l12.37">             }</span>
<a href="#l12.38"></a><span id="l12.38">         }</span>
<a href="#l12.39"></a><span id="l12.39">         return null;</span>
<a href="#l12.40"></a><span id="l12.40">     },</span>
<a href="#l12.41"></a><span id="l12.41"> </span>
<a href="#l12.42"></a><span id="l12.42">     /**</span>
<a href="#l12.43"></a><span id="l12.43" class="difflineat">@@ -113,10 +124,59 @@ cal.alarms = {</span>
<a href="#l12.44"></a><span id="l12.44">             if (returnDate &amp;&amp; aAlarm.alarmDate) {</span>
<a href="#l12.45"></a><span id="l12.45">                 return returnDate.subtractDate(aAlarm.alarmDate);</span>
<a href="#l12.46"></a><span id="l12.46">             }</span>
<a href="#l12.47"></a><span id="l12.47">                 </span>
<a href="#l12.48"></a><span id="l12.48">             return offset;</span>
<a href="#l12.49"></a><span id="l12.49">         } else {</span>
<a href="#l12.50"></a><span id="l12.50">             return aAlarm.offset;</span>
<a href="#l12.51"></a><span id="l12.51">         }</span>
<a href="#l12.52"></a><span id="l12.52" class="difflineplus">+    },</span>
<a href="#l12.53"></a><span id="l12.53" class="difflineplus">+</span>
<a href="#l12.54"></a><span id="l12.54" class="difflineplus">+    /**</span>
<a href="#l12.55"></a><span id="l12.55" class="difflineplus">+     * Adds reminder images to a given node, making sure only one icon per alarm</span>
<a href="#l12.56"></a><span id="l12.56" class="difflineplus">+     * action is added.</span>
<a href="#l12.57"></a><span id="l12.57" class="difflineplus">+     *</span>
<a href="#l12.58"></a><span id="l12.58" class="difflineplus">+     * @param aElement    The element to add the images to.</span>
<a href="#l12.59"></a><span id="l12.59" class="difflineplus">+     * @param aReminders  The set of reminders to add images for.</span>
<a href="#l12.60"></a><span id="l12.60" class="difflineplus">+     */</span>
<a href="#l12.61"></a><span id="l12.61" class="difflineplus">+    addReminderImages: function cal_alarms_addReminderImages(aElement, aReminders) {</span>
<a href="#l12.62"></a><span id="l12.62" class="difflineplus">+        function createOwnedXULNode(el) {</span>
<a href="#l12.63"></a><span id="l12.63" class="difflineplus">+            const XUL_NS = &quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;;</span>
<a href="#l12.64"></a><span id="l12.64" class="difflineplus">+            return aElement.ownerDocument.createElementNS(XUL_NS, el);</span>
<a href="#l12.65"></a><span id="l12.65" class="difflineplus">+        }</span>
<a href="#l12.66"></a><span id="l12.66" class="difflineplus">+</span>
<a href="#l12.67"></a><span id="l12.67" class="difflineplus">+        function setupActionImage(node, reminder) {</span>
<a href="#l12.68"></a><span id="l12.68" class="difflineplus">+            let image = node || createOwnedXULNode(&quot;image&quot;);</span>
<a href="#l12.69"></a><span id="l12.69" class="difflineplus">+            image.setAttribute(&quot;class&quot;, &quot;reminder-icon&quot;);</span>
<a href="#l12.70"></a><span id="l12.70" class="difflineplus">+            image.setAttribute(&quot;value&quot;, reminder.action);</span>
<a href="#l12.71"></a><span id="l12.71" class="difflineplus">+            return image;</span>
<a href="#l12.72"></a><span id="l12.72" class="difflineplus">+        }</span>
<a href="#l12.73"></a><span id="l12.73" class="difflineplus">+</span>
<a href="#l12.74"></a><span id="l12.74" class="difflineplus">+        // Fill up the icon box with the alarm icons, show max one icon per</span>
<a href="#l12.75"></a><span id="l12.75" class="difflineplus">+        // alarm type.</span>
<a href="#l12.76"></a><span id="l12.76" class="difflineplus">+        let countIconChildren = aElement.childNodes.length;</span>
<a href="#l12.77"></a><span id="l12.77" class="difflineplus">+        let actionMap = {};</span>
<a href="#l12.78"></a><span id="l12.78" class="difflineplus">+        let i, offset;</span>
<a href="#l12.79"></a><span id="l12.79" class="difflineplus">+        for (i = 0, offset = 0; i &lt; aReminders.length; i++) {</span>
<a href="#l12.80"></a><span id="l12.80" class="difflineplus">+            var reminder = aReminders[i];</span>
<a href="#l12.81"></a><span id="l12.81" class="difflineplus">+            if (reminder.action in actionMap) {</span>
<a href="#l12.82"></a><span id="l12.82" class="difflineplus">+                // Only show one icon of each type;</span>
<a href="#l12.83"></a><span id="l12.83" class="difflineplus">+                offset++;</span>
<a href="#l12.84"></a><span id="l12.84" class="difflineplus">+                continue;</span>
<a href="#l12.85"></a><span id="l12.85" class="difflineplus">+            }</span>
<a href="#l12.86"></a><span id="l12.86" class="difflineplus">+            actionMap[reminder.action] = true;</span>
<a href="#l12.87"></a><span id="l12.87" class="difflineplus">+</span>
<a href="#l12.88"></a><span id="l12.88" class="difflineplus">+            if (i - offset &gt;= countIconChildren) {</span>
<a href="#l12.89"></a><span id="l12.89" class="difflineplus">+                // Not enough nodes, append it.</span>
<a href="#l12.90"></a><span id="l12.90" class="difflineplus">+                aElement.appendChild(setupActionImage(null, reminder));</span>
<a href="#l12.91"></a><span id="l12.91" class="difflineplus">+            } else {</span>
<a href="#l12.92"></a><span id="l12.92" class="difflineplus">+                // There is already a node there, change its properties</span>
<a href="#l12.93"></a><span id="l12.93" class="difflineplus">+                setupActionImage(aElement.childNodes[i - offset], reminder);</span>
<a href="#l12.94"></a><span id="l12.94" class="difflineplus">+            }</span>
<a href="#l12.95"></a><span id="l12.95" class="difflineplus">+        }</span>
<a href="#l12.96"></a><span id="l12.96" class="difflineplus">+</span>
<a href="#l12.97"></a><span id="l12.97" class="difflineplus">+        // Remove unused image nodes</span>
<a href="#l12.98"></a><span id="l12.98" class="difflineplus">+        for (i -= offset; i &lt; countIconChildren; i++) {</span>
<a href="#l12.99"></a><span id="l12.99" class="difflineplus">+            aElement.removeChild(aElement.childNodes[i]);</span>
<a href="#l12.100"></a><span id="l12.100" class="difflineplus">+        }</span>
<a href="#l12.101"></a><span id="l12.101">     }</span>
<a href="#l12.102"></a><span id="l12.102"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/base/modules/calIteratorUtils.jsm</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/base/modules/calIteratorUtils.jsm</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -57,33 +57,16 @@ cal.itemIterator = function cal_itemIter</span>
<a href="#l13.4"></a><span id="l13.4">                     }</span>
<a href="#l13.5"></a><span id="l13.5">                 }</span>
<a href="#l13.6"></a><span id="l13.6">             }</span>
<a href="#l13.7"></a><span id="l13.7">         }</span>
<a href="#l13.8"></a><span id="l13.8">     };</span>
<a href="#l13.9"></a><span id="l13.9"> };</span>
<a href="#l13.10"></a><span id="l13.10"> </span>
<a href="#l13.11"></a><span id="l13.11"> /**</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">- * Iterator for a DOM NodeList where for each() cannot be used directly.</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineminus">- *</span>
<a href="#l13.14"></a><span id="l13.14" class="difflineminus">- * @param nodeList          The NodeList to iterate (i.e el.childNodes)</span>
<a href="#l13.15"></a><span id="l13.15" class="difflineminus">- */</span>
<a href="#l13.16"></a><span id="l13.16" class="difflineminus">-cal.nodeIterator = function cal_nodeIterator(nodeList) {</span>
<a href="#l13.17"></a><span id="l13.17" class="difflineminus">-    return {</span>
<a href="#l13.18"></a><span id="l13.18" class="difflineminus">-        __iterator__: function nodeIterator(aWantKeys) {</span>
<a href="#l13.19"></a><span id="l13.19" class="difflineminus">-            cal.ASSERT(!aWantKeys, &quot;Please use for each() on the node iterator&quot;);</span>
<a href="#l13.20"></a><span id="l13.20" class="difflineminus">-            let nodeListLength = nodeList.length;</span>
<a href="#l13.21"></a><span id="l13.21" class="difflineminus">-            for (let i = 0; i &lt; nodeListLength; i++) {</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineminus">-                yield nodeList[i];</span>
<a href="#l13.23"></a><span id="l13.23" class="difflineminus">-            }</span>
<a href="#l13.24"></a><span id="l13.24" class="difflineminus">-        }</span>
<a href="#l13.25"></a><span id="l13.25" class="difflineminus">-    };</span>
<a href="#l13.26"></a><span id="l13.26" class="difflineminus">-};</span>
<a href="#l13.27"></a><span id="l13.27" class="difflineminus">-</span>
<a href="#l13.28"></a><span id="l13.28" class="difflineminus">-/**</span>
<a href="#l13.29"></a><span id="l13.29">  * &quot;ical&quot; namespace. Used for all iterators (and possibly other functions) that</span>
<a href="#l13.30"></a><span id="l13.30">  * are related to libical.</span>
<a href="#l13.31"></a><span id="l13.31">  */</span>
<a href="#l13.32"></a><span id="l13.32"> cal.ical = {</span>
<a href="#l13.33"></a><span id="l13.33">     /**</span>
<a href="#l13.34"></a><span id="l13.34">      *  Yields all subcomponents in all calendars in the passed component.</span>
<a href="#l13.35"></a><span id="l13.35">      *  - If the passed component is an XROOT (contains multiple calendars),</span>
<a href="#l13.36"></a><span id="l13.36">      *    then go through all VCALENDARs in it and get their subcomponents.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/base/src/calAlarmService.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/base/src/calAlarmService.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -33,16 +33,18 @@</span>
<a href="#l14.4"></a><span id="l14.4">  * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l14.5"></a><span id="l14.5">  * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l14.6"></a><span id="l14.6">  * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l14.7"></a><span id="l14.7">  * the provisions above, a recipient may use your version of this file under</span>
<a href="#l14.8"></a><span id="l14.8">  * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l14.9"></a><span id="l14.9">  *</span>
<a href="#l14.10"></a><span id="l14.10">  * ***** END LICENSE BLOCK ***** */</span>
<a href="#l14.11"></a><span id="l14.11"> </span>
<a href="#l14.12"></a><span id="l14.12" class="difflineplus">+Components.utils.import(&quot;resource://calendar/modules/calAlarmUtils.jsm&quot;);</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+</span>
<a href="#l14.14"></a><span id="l14.14"> const kHoursBetweenUpdates = 6;</span>
<a href="#l14.15"></a><span id="l14.15"> </span>
<a href="#l14.16"></a><span id="l14.16"> function nowUTC() {</span>
<a href="#l14.17"></a><span id="l14.17">     return jsDateToDateTime(new Date()).getInTimezone(UTC());</span>
<a href="#l14.18"></a><span id="l14.18"> }</span>
<a href="#l14.19"></a><span id="l14.19"> </span>
<a href="#l14.20"></a><span id="l14.20"> function newTimerWithCallback(callback, delay, repeating)</span>
<a href="#l14.21"></a><span id="l14.21"> {</span>
<a href="#l14.22"></a><span id="l14.22" class="difflineat">@@ -371,18 +373,18 @@ calAlarmService.prototype = {</span>
<a href="#l14.23"></a><span id="l14.23">         calendar.removeObserver(this.calendarObserver);</span>
<a href="#l14.24"></a><span id="l14.24">         this.disposeCalendarTimers([calendar]);</span>
<a href="#l14.25"></a><span id="l14.25">         this.notifyObservers(&quot;onRemoveAlarmsByCalendar&quot;, [calendar]);</span>
<a href="#l14.26"></a><span id="l14.26">     },</span>
<a href="#l14.27"></a><span id="l14.27"> </span>
<a href="#l14.28"></a><span id="l14.28">     getAlarmDate: function cas_getAlarmTime(aItem) {</span>
<a href="#l14.29"></a><span id="l14.29">         var alarmDate = null;</span>
<a href="#l14.30"></a><span id="l14.30">         // TODO ALARMSUPPORT This will change as soon as we support multiple</span>
<a href="#l14.31"></a><span id="l14.31" class="difflineminus">-        // alarms. Get the first alarm for now.</span>
<a href="#l14.32"></a><span id="l14.32" class="difflineminus">-        let alarms = aItem.getAlarms({});</span>
<a href="#l14.33"></a><span id="l14.33" class="difflineplus">+        // alarms. Get the first DISPLAY alarm for now.</span>
<a href="#l14.34"></a><span id="l14.34" class="difflineplus">+        let alarms = aItem.getAlarms({}).filter(function(x) x.action == &quot;DISPLAY&quot;);</span>
<a href="#l14.35"></a><span id="l14.35">         let alarm = alarms[0];</span>
<a href="#l14.36"></a><span id="l14.36">         if (!alarm) {</span>
<a href="#l14.37"></a><span id="l14.37">             // No relative alarm available.</span>
<a href="#l14.38"></a><span id="l14.38">             return null;</span>
<a href="#l14.39"></a><span id="l14.39">         }</span>
<a href="#l14.40"></a><span id="l14.40">         // END TODO ALARMSUPPORT</span>
<a href="#l14.41"></a><span id="l14.41">         </span>
<a href="#l14.42"></a><span id="l14.42">         let alarmDate = cal.alarms.calculateAlarmDate(aItem, alarm)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1">new file mode 100644</span>
<a href="#l15.2"></a><span id="l15.2">index e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..554f823a0a9e38c81f0366674378fcb0f639ddfd</span>
<a href="#l15.3"></a><span id="l15.3">GIT binary patch
literal 1013
zc$@+C0}A|!P)&lt;h;3K|Lk000e1NJLTq001li000XJ1^@s61TAlm00001b5ch_0Itp)
z=&gt;Px#24YJ`L;(K){{a7&gt;y{D4^000SaNLh0L01Cta01CtbW^IDh00007bV*G`2iOJ_
z4GuA-2fu9q00VVNL_t(I%bk@?XdP7)$A9&lt;E%=^ffY0SbdVjmGJFN&amp;syYE&gt;{$i!r81
zq1oA@3#}+9QR%`;L=1KzRntX{iV8v&amp;LKiK9U)^ZBuz8lWA{BLENn51Gq&amp;DWmm-)Eo
zxOgv*yp|W6-r;a&amp;4*c%@&amp;;Q)HV&lt;ry2qb?4)p5dj^boIYvR@TN3aeKPKAGLKG?$mgS
zcz)q0=h(I7IeuPku50EBqx-dbNGZgrN}?)}s)VYpsOlC~-GWLor;^NSVf0O{TJ$}F
zlOHp&amp;bn#Qw;&amp;FAq-&gt;-`&amp;(9@qVF+M_2Q|uZz&gt;zo4=R6t!hV$i4(sv)WoDiN=}9W!{q
z5r+{jaa9Ye(C620*pyy(EAiwDB!7QTx*jlWLg}j|crBcjq%4qSk!5ijp%Nl4LXrp&lt;
zha_=`h$0Fu4slMZ7S3eZnQCk|`tNUOcor;(fFEEm?5rhtEu3}ERoqjJ5Q&amp;f^M3N8}
zmxQ_~tmIdoo@3urm(e6dRybT3p+yW``K^bL`EiKmz?2%du&gt;-87tMEQ8SBhPYyRED9
zD$bY0p)Nv2P?d7l$}=_Ui3p|b1cec9ROJyNotOFVklD|`TkbcQ#%_!^mY0a$!U$jA
z`z)9Km-8NC`d||+r)KlOrE~qc^UaU%&gt;G7R&amp;BvA+|96tIjB63yBcJ$l&gt;swLs7fWa73
zaae`dQ)#wtd|)^7=c{P)53D#lOfp6Oz8(B&gt;;^;mXvjup5HO^!^nLgM=@ziNrUmT&gt;d
zub-LWp_^w%Km5u{;!6873K3PbWJ)&lt;o*O702;K;F)C&gt;HCb@PZ6pkgYfzWZ2%;PDeKU
z2qTxV9#~rr4|M5Q&gt;arJUziV4ZQ0H%7evw)nP!T)x?huP($7mfGB)%}2^IhU_QHZMY
z*tWYtwWQV&lt;jIm%W##)T=sxrn_9CitxpF2zUALqG4l~|Na)rVqOGPV#n#~GI}wp_2x
z{m2dEXzc69HZ&lt;|q&amp;|X&gt;&gt;=E|ppbGRf%oWo$THoyjHydaC0%HpT8m3uG9;sqIO*&lt;mR=
ztjd6k+1&amp;XgepsYudJ5X}&gt;uJxgXL&lt;_4B0Zf?;5Rq0S%rbhakdJ_EjKYUJVbr&gt;!xg84
zw%nxo;;om}MN8N9r}NWU9^HGuTv;C*=0QK;1ArvvneG9OU(0+expkS|{q&lt;iK--s_v
j&lt;^Y1W++_2vJ-z&lt;{mAHOz)Z6kg00000NkvXXu0mjf%&lt;|jx</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1">deleted file mode 100644</span>
<a href="#l16.2"></a><span id="l16.2">index 21bd46b9bb46a731e39c24c451ab9cc8f8f00794..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l16.3"></a><span id="l16.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1">deleted file mode 100644</span>
<a href="#l17.2"></a><span id="l17.2">index 81b44d927e0f7e40332a1616e08ffa6a277d4eca..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
<a href="#l17.3"></a><span id="l17.3">GIT binary patch
literal 0
Hc$@&lt;O00001</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1">new file mode 100644</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineminus">--- /dev/null</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineplus">+++ b/calendar/base/themes/pinstripe/calendar-alarms.css</span>
<a href="#l18.4"></a><span id="l18.4" class="difflineat">@@ -0,0 +1,98 @@</span>
<a href="#l18.5"></a><span id="l18.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l18.6"></a><span id="l18.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l18.7"></a><span id="l18.7" class="difflineplus">+ *</span>
<a href="#l18.8"></a><span id="l18.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l18.9"></a><span id="l18.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l18.10"></a><span id="l18.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l18.11"></a><span id="l18.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineplus">+ *</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l18.14"></a><span id="l18.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l18.15"></a><span id="l18.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l18.16"></a><span id="l18.16" class="difflineplus">+ * License.</span>
<a href="#l18.17"></a><span id="l18.17" class="difflineplus">+ *</span>
<a href="#l18.18"></a><span id="l18.18" class="difflineplus">+ * The Original Code is Sun Microsystems code.</span>
<a href="#l18.19"></a><span id="l18.19" class="difflineplus">+ *</span>
<a href="#l18.20"></a><span id="l18.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l18.21"></a><span id="l18.21" class="difflineplus">+ *   Philipp Kewisch &lt;mozilla@kewis.ch&gt;</span>
<a href="#l18.22"></a><span id="l18.22" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2008-2009</span>
<a href="#l18.23"></a><span id="l18.23" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l18.24"></a><span id="l18.24" class="difflineplus">+ *</span>
<a href="#l18.25"></a><span id="l18.25" class="difflineplus">+ * Contributor(s):</span>
<a href="#l18.26"></a><span id="l18.26" class="difflineplus">+ *</span>
<a href="#l18.27"></a><span id="l18.27" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l18.28"></a><span id="l18.28" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l18.29"></a><span id="l18.29" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l18.30"></a><span id="l18.30" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l18.31"></a><span id="l18.31" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l18.32"></a><span id="l18.32" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l18.33"></a><span id="l18.33" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l18.34"></a><span id="l18.34" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l18.35"></a><span id="l18.35" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l18.36"></a><span id="l18.36" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l18.37"></a><span id="l18.37" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l18.38"></a><span id="l18.38" class="difflineplus">+ *</span>
<a href="#l18.39"></a><span id="l18.39" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l18.40"></a><span id="l18.40" class="difflineplus">+</span>
<a href="#l18.41"></a><span id="l18.41" class="difflineplus">+/**</span>
<a href="#l18.42"></a><span id="l18.42" class="difflineplus">+ * Reminder icons (used from the event dialog, reminder dialog, views, ...)</span>
<a href="#l18.43"></a><span id="l18.43" class="difflineplus">+ */</span>
<a href="#l18.44"></a><span id="l18.44" class="difflineplus">+.reminder-icon {</span>
<a href="#l18.45"></a><span id="l18.45" class="difflineplus">+    list-style-image: url(chrome://calendar/skin/alarm-icons.png);</span>
<a href="#l18.46"></a><span id="l18.46" class="difflineplus">+}</span>
<a href="#l18.47"></a><span id="l18.47" class="difflineplus">+</span>
<a href="#l18.48"></a><span id="l18.48" class="difflineplus">+.reminder-icon[value=&quot;DISPLAY&quot;] {</span>
<a href="#l18.49"></a><span id="l18.49" class="difflineplus">+    -moz-image-region: rect(0px 30px 11px 17px);</span>
<a href="#l18.50"></a><span id="l18.50" class="difflineplus">+}</span>
<a href="#l18.51"></a><span id="l18.51" class="difflineplus">+</span>
<a href="#l18.52"></a><span id="l18.52" class="difflineplus">+.alarm-icons-box[suppressed=&quot;true&quot;] &gt; .reminder-icon[value=&quot;DISPLAY&quot;] {</span>
<a href="#l18.53"></a><span id="l18.53" class="difflineplus">+    -moz-image-region: rect(0px 44px 11px 31px);</span>
<a href="#l18.54"></a><span id="l18.54" class="difflineplus">+}</span>
<a href="#l18.55"></a><span id="l18.55" class="difflineplus">+</span>
<a href="#l18.56"></a><span id="l18.56" class="difflineplus">+.reminder-icon[value=&quot;EMAIL&quot;] {</span>
<a href="#l18.57"></a><span id="l18.57" class="difflineplus">+    -moz-image-region: rect(0px 16px 11px 0px);</span>
<a href="#l18.58"></a><span id="l18.58" class="difflineplus">+}</span>
<a href="#l18.59"></a><span id="l18.59" class="difflineplus">+</span>
<a href="#l18.60"></a><span id="l18.60" class="difflineplus">+.alarm-icons-box[flashing=&quot;true&quot;] &gt; .reminder-icon[value=&quot;DISPLAY&quot;] {</span>
<a href="#l18.61"></a><span id="l18.61" class="difflineplus">+    list-style-image: url(chrome://calendar/skin/alarm-flashing.png);</span>
<a href="#l18.62"></a><span id="l18.62" class="difflineplus">+    -moz-image-region: auto;</span>
<a href="#l18.63"></a><span id="l18.63" class="difflineplus">+}</span>
<a href="#l18.64"></a><span id="l18.64" class="difflineplus">+</span>
<a href="#l18.65"></a><span id="l18.65" class="difflineplus">+/**</span>
<a href="#l18.66"></a><span id="l18.66" class="difflineplus">+ * Reminder dialog (i.e &quot;custom&quot; alarm in the event dialog)</span>
<a href="#l18.67"></a><span id="l18.67" class="difflineplus">+ * Please make sure rules added here are very specific and won't hurt other</span>
<a href="#l18.68"></a><span id="l18.68" class="difflineplus">+ * dialogs.</span>
<a href="#l18.69"></a><span id="l18.69" class="difflineplus">+ */</span>
<a href="#l18.70"></a><span id="l18.70" class="difflineplus">+#reminder-relative-radio &gt; .radio-label-center-box &gt; .radio-label-box,</span>
<a href="#l18.71"></a><span id="l18.71" class="difflineplus">+#reminder-absolute-radio &gt; .radio-label-center-box &gt; .radio-label-box {</span>
<a href="#l18.72"></a><span id="l18.72" class="difflineplus">+    display: none;</span>
<a href="#l18.73"></a><span id="l18.73" class="difflineplus">+}</span>
<a href="#l18.74"></a><span id="l18.74" class="difflineplus">+</span>
<a href="#l18.75"></a><span id="l18.75" class="difflineplus">+#reminder-actions-menulist &gt; menupopup &gt; menuitem &gt; .menu-iconic-left {</span>
<a href="#l18.76"></a><span id="l18.76" class="difflineplus">+    display: -moz-box;</span>
<a href="#l18.77"></a><span id="l18.77" class="difflineplus">+}</span>
<a href="#l18.78"></a><span id="l18.78" class="difflineplus">+</span>
<a href="#l18.79"></a><span id="l18.79" class="difflineplus">+#reminder-notifications {</span>
<a href="#l18.80"></a><span id="l18.80" class="difflineplus">+    overflow-y: visible;</span>
<a href="#l18.81"></a><span id="l18.81" class="difflineplus">+}</span>
<a href="#l18.82"></a><span id="l18.82" class="difflineplus">+</span>
<a href="#l18.83"></a><span id="l18.83" class="difflineplus">+#reminder-notifications &gt; notification {</span>
<a href="#l18.84"></a><span id="l18.84" class="difflineplus">+    background-color: transparent;</span>
<a href="#l18.85"></a><span id="l18.85" class="difflineplus">+}</span>
<a href="#l18.86"></a><span id="l18.86" class="difflineplus">+#reminder-notifications &gt; notification &gt; .notification-inner {</span>
<a href="#l18.87"></a><span id="l18.87" class="difflineplus">+    border: 0;</span>
<a href="#l18.88"></a><span id="l18.88" class="difflineplus">+}</span>
<a href="#l18.89"></a><span id="l18.89" class="difflineplus">+#reminder-notifications &gt; notification[type=&quot;warning&quot;] {</span>
<a href="#l18.90"></a><span id="l18.90" class="difflineplus">+    list-style-image: url(chrome://global/skin/icons/Warning.png);</span>
<a href="#l18.91"></a><span id="l18.91" class="difflineplus">+}</span>
<a href="#l18.92"></a><span id="l18.92" class="difflineplus">+</span>
<a href="#l18.93"></a><span id="l18.93" class="difflineplus">+#reminder-actions-caption,</span>
<a href="#l18.94"></a><span id="l18.94" class="difflineplus">+#reminder-details-caption,</span>
<a href="#l18.95"></a><span id="l18.95" class="difflineplus">+#calendar-event-dialog-reminder &gt; .dialog-button-box {</span>
<a href="#l18.96"></a><span id="l18.96" class="difflineplus">+    padding-top: 20px;</span>
<a href="#l18.97"></a><span id="l18.97" class="difflineplus">+}</span>
<a href="#l18.98"></a><span id="l18.98" class="difflineplus">+</span>
<a href="#l18.99"></a><span id="l18.99" class="difflineplus">+.reminder-icon &gt; .menu-iconic-left &gt; .menu-iconic-icon {</span>
<a href="#l18.100"></a><span id="l18.100" class="difflineplus">+    width: auto;</span>
<a href="#l18.101"></a><span id="l18.101" class="difflineplus">+    height: auto;</span>
<a href="#l18.102"></a><span id="l18.102" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/calendar/base/themes/pinstripe/calendar-views.css</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/calendar/base/themes/pinstripe/calendar-views.css</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -535,30 +535,16 @@ calendar-event-box[orient=&quot;horizontal&quot;] </span>
<a href="#l19.4"></a><span id="l19.4"> }</span>
<a href="#l19.5"></a><span id="l19.5"> </span>
<a href="#l19.6"></a><span id="l19.6"> calendar-event-box[readonly=&quot;true&quot;]:hover .calendar-event-box-grippy-top,</span>
<a href="#l19.7"></a><span id="l19.7"> calendar-event-box[readonly=&quot;true&quot;]:hover .calendar-event-box-grippy-bottom {</span>
<a href="#l19.8"></a><span id="l19.8">     visibility: hidden;</span>
<a href="#l19.9"></a><span id="l19.9">     cursor: auto;</span>
<a href="#l19.10"></a><span id="l19.10"> }</span>
<a href="#l19.11"></a><span id="l19.11"> </span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-/* Alarm image */</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineminus">-.alarm-image {</span>
<a href="#l19.14"></a><span id="l19.14" class="difflineminus">-    list-style-image: url(chrome://calendar/skin/alarm.png);</span>
<a href="#l19.15"></a><span id="l19.15" class="difflineminus">-    margin: 2px 2px 0px;</span>
<a href="#l19.16"></a><span id="l19.16" class="difflineminus">-}</span>
<a href="#l19.17"></a><span id="l19.17" class="difflineminus">-</span>
<a href="#l19.18"></a><span id="l19.18" class="difflineminus">-.alarm-image[flashing=&quot;true&quot;] {</span>
<a href="#l19.19"></a><span id="l19.19" class="difflineminus">-    list-style-image: url(chrome://calendar/skin/alarm-flashing.png);</span>
<a href="#l19.20"></a><span id="l19.20" class="difflineminus">-}</span>
<a href="#l19.21"></a><span id="l19.21" class="difflineminus">-</span>
<a href="#l19.22"></a><span id="l19.22" class="difflineminus">-.alarm-image[suppressed=&quot;true&quot;] {</span>
<a href="#l19.23"></a><span id="l19.23" class="difflineminus">-    list-style-image: url(chrome://calendar/skin/alarm-suppressed.png);</span>
<a href="#l19.24"></a><span id="l19.24" class="difflineminus">-}</span>
<a href="#l19.25"></a><span id="l19.25" class="difflineminus">-</span>
<a href="#l19.26"></a><span id="l19.26"> /* tooltips */</span>
<a href="#l19.27"></a><span id="l19.27"> vbox.tooltipBox {</span>
<a href="#l19.28"></a><span id="l19.28">     max-width: 40em;</span>
<a href="#l19.29"></a><span id="l19.29"> }</span>
<a href="#l19.30"></a><span id="l19.30"> </span>
<a href="#l19.31"></a><span id="l19.31"> column.tooltipValueColumn {</span>
<a href="#l19.32"></a><span id="l19.32">     max-width: 35em; /* tooltipBox max-width minus space for label */</span>
<a href="#l19.33"></a><span id="l19.33"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1">new file mode 100644</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineminus">--- /dev/null</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineplus">+++ b/calendar/base/themes/winstripe/calendar-alarms.css</span>
<a href="#l20.4"></a><span id="l20.4" class="difflineat">@@ -0,0 +1,98 @@</span>
<a href="#l20.5"></a><span id="l20.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l20.6"></a><span id="l20.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l20.7"></a><span id="l20.7" class="difflineplus">+ *</span>
<a href="#l20.8"></a><span id="l20.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l20.9"></a><span id="l20.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l20.10"></a><span id="l20.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l20.11"></a><span id="l20.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineplus">+ *</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l20.14"></a><span id="l20.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l20.15"></a><span id="l20.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l20.16"></a><span id="l20.16" class="difflineplus">+ * License.</span>
<a href="#l20.17"></a><span id="l20.17" class="difflineplus">+ *</span>
<a href="#l20.18"></a><span id="l20.18" class="difflineplus">+ * The Original Code is Sun Microsystems code.</span>
<a href="#l20.19"></a><span id="l20.19" class="difflineplus">+ *</span>
<a href="#l20.20"></a><span id="l20.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l20.21"></a><span id="l20.21" class="difflineplus">+ *   Philipp Kewisch &lt;mozilla@kewis.ch&gt;</span>
<a href="#l20.22"></a><span id="l20.22" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2008-2009</span>
<a href="#l20.23"></a><span id="l20.23" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l20.24"></a><span id="l20.24" class="difflineplus">+ *</span>
<a href="#l20.25"></a><span id="l20.25" class="difflineplus">+ * Contributor(s):</span>
<a href="#l20.26"></a><span id="l20.26" class="difflineplus">+ *</span>
<a href="#l20.27"></a><span id="l20.27" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l20.28"></a><span id="l20.28" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l20.29"></a><span id="l20.29" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l20.30"></a><span id="l20.30" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l20.31"></a><span id="l20.31" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l20.32"></a><span id="l20.32" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l20.33"></a><span id="l20.33" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l20.34"></a><span id="l20.34" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l20.35"></a><span id="l20.35" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l20.36"></a><span id="l20.36" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l20.37"></a><span id="l20.37" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l20.38"></a><span id="l20.38" class="difflineplus">+ *</span>
<a href="#l20.39"></a><span id="l20.39" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l20.40"></a><span id="l20.40" class="difflineplus">+</span>
<a href="#l20.41"></a><span id="l20.41" class="difflineplus">+/**</span>
<a href="#l20.42"></a><span id="l20.42" class="difflineplus">+ * Reminder icons (used from the event dialog, reminder dialog, views, ...)</span>
<a href="#l20.43"></a><span id="l20.43" class="difflineplus">+ */</span>
<a href="#l20.44"></a><span id="l20.44" class="difflineplus">+.reminder-icon {</span>
<a href="#l20.45"></a><span id="l20.45" class="difflineplus">+    list-style-image: url(chrome://calendar/skin/alarm-icons.png);</span>
<a href="#l20.46"></a><span id="l20.46" class="difflineplus">+}</span>
<a href="#l20.47"></a><span id="l20.47" class="difflineplus">+</span>
<a href="#l20.48"></a><span id="l20.48" class="difflineplus">+.reminder-icon[value=&quot;DISPLAY&quot;] {</span>
<a href="#l20.49"></a><span id="l20.49" class="difflineplus">+    -moz-image-region: rect(0px 30px 11px 17px);</span>
<a href="#l20.50"></a><span id="l20.50" class="difflineplus">+}</span>
<a href="#l20.51"></a><span id="l20.51" class="difflineplus">+</span>
<a href="#l20.52"></a><span id="l20.52" class="difflineplus">+.alarm-icons-box[suppressed=&quot;true&quot;] &gt; .reminder-icon[value=&quot;DISPLAY&quot;] {</span>
<a href="#l20.53"></a><span id="l20.53" class="difflineplus">+    -moz-image-region: rect(0px 44px 11px 31px);</span>
<a href="#l20.54"></a><span id="l20.54" class="difflineplus">+}</span>
<a href="#l20.55"></a><span id="l20.55" class="difflineplus">+</span>
<a href="#l20.56"></a><span id="l20.56" class="difflineplus">+.reminder-icon[value=&quot;EMAIL&quot;] {</span>
<a href="#l20.57"></a><span id="l20.57" class="difflineplus">+    -moz-image-region: rect(0px 16px 11px 0px);</span>
<a href="#l20.58"></a><span id="l20.58" class="difflineplus">+}</span>
<a href="#l20.59"></a><span id="l20.59" class="difflineplus">+</span>
<a href="#l20.60"></a><span id="l20.60" class="difflineplus">+.alarm-icons-box[flashing=&quot;true&quot;] &gt; .reminder-icon[value=&quot;DISPLAY&quot;] {</span>
<a href="#l20.61"></a><span id="l20.61" class="difflineplus">+    list-style-image: url(chrome://calendar/skin/alarm-flashing.png);</span>
<a href="#l20.62"></a><span id="l20.62" class="difflineplus">+    -moz-image-region: auto;</span>
<a href="#l20.63"></a><span id="l20.63" class="difflineplus">+}</span>
<a href="#l20.64"></a><span id="l20.64" class="difflineplus">+</span>
<a href="#l20.65"></a><span id="l20.65" class="difflineplus">+/**</span>
<a href="#l20.66"></a><span id="l20.66" class="difflineplus">+ * Reminder dialog (i.e &quot;custom&quot; alarm in the event dialog)</span>
<a href="#l20.67"></a><span id="l20.67" class="difflineplus">+ * Please make sure rules added here are very specific and won't hurt other</span>
<a href="#l20.68"></a><span id="l20.68" class="difflineplus">+ * dialogs.</span>
<a href="#l20.69"></a><span id="l20.69" class="difflineplus">+ */</span>
<a href="#l20.70"></a><span id="l20.70" class="difflineplus">+#reminder-relative-radio &gt; .radio-label-center-box &gt; .radio-label-box,</span>
<a href="#l20.71"></a><span id="l20.71" class="difflineplus">+#reminder-absolute-radio &gt; .radio-label-center-box &gt; .radio-label-box {</span>
<a href="#l20.72"></a><span id="l20.72" class="difflineplus">+    display: none;</span>
<a href="#l20.73"></a><span id="l20.73" class="difflineplus">+}</span>
<a href="#l20.74"></a><span id="l20.74" class="difflineplus">+</span>
<a href="#l20.75"></a><span id="l20.75" class="difflineplus">+#reminder-actions-menulist &gt; menupopup &gt; menuitem &gt; .menu-iconic-left {</span>
<a href="#l20.76"></a><span id="l20.76" class="difflineplus">+    display: -moz-box;</span>
<a href="#l20.77"></a><span id="l20.77" class="difflineplus">+}</span>
<a href="#l20.78"></a><span id="l20.78" class="difflineplus">+</span>
<a href="#l20.79"></a><span id="l20.79" class="difflineplus">+#reminder-notifications {</span>
<a href="#l20.80"></a><span id="l20.80" class="difflineplus">+    overflow-y: visible;</span>
<a href="#l20.81"></a><span id="l20.81" class="difflineplus">+}</span>
<a href="#l20.82"></a><span id="l20.82" class="difflineplus">+</span>
<a href="#l20.83"></a><span id="l20.83" class="difflineplus">+#reminder-notifications &gt; notification {</span>
<a href="#l20.84"></a><span id="l20.84" class="difflineplus">+    background-color: transparent;</span>
<a href="#l20.85"></a><span id="l20.85" class="difflineplus">+}</span>
<a href="#l20.86"></a><span id="l20.86" class="difflineplus">+#reminder-notifications &gt; notification &gt; .notification-inner {</span>
<a href="#l20.87"></a><span id="l20.87" class="difflineplus">+    border: 0;</span>
<a href="#l20.88"></a><span id="l20.88" class="difflineplus">+}</span>
<a href="#l20.89"></a><span id="l20.89" class="difflineplus">+#reminder-notifications &gt; notification[type=&quot;warning&quot;] {</span>
<a href="#l20.90"></a><span id="l20.90" class="difflineplus">+    list-style-image: url(chrome://global/skin/icons/Warning.png);</span>
<a href="#l20.91"></a><span id="l20.91" class="difflineplus">+}</span>
<a href="#l20.92"></a><span id="l20.92" class="difflineplus">+</span>
<a href="#l20.93"></a><span id="l20.93" class="difflineplus">+#reminder-actions-caption,</span>
<a href="#l20.94"></a><span id="l20.94" class="difflineplus">+#reminder-details-caption,</span>
<a href="#l20.95"></a><span id="l20.95" class="difflineplus">+#calendar-event-dialog-reminder &gt; .dialog-button-box {</span>
<a href="#l20.96"></a><span id="l20.96" class="difflineplus">+    padding-top: 20px;</span>
<a href="#l20.97"></a><span id="l20.97" class="difflineplus">+}</span>
<a href="#l20.98"></a><span id="l20.98" class="difflineplus">+</span>
<a href="#l20.99"></a><span id="l20.99" class="difflineplus">+.reminder-icon &gt; .menu-iconic-left &gt; .menu-iconic-icon {</span>
<a href="#l20.100"></a><span id="l20.100" class="difflineplus">+    width: auto;</span>
<a href="#l20.101"></a><span id="l20.101" class="difflineplus">+    height: auto;</span>
<a href="#l20.102"></a><span id="l20.102" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/calendar/base/themes/winstripe/calendar-views.css</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/calendar/base/themes/winstripe/calendar-views.css</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -535,32 +535,16 @@ calendar-event-box[orient=&quot;horizontal&quot;] </span>
<a href="#l21.4"></a><span id="l21.4"> }</span>
<a href="#l21.5"></a><span id="l21.5"> </span>
<a href="#l21.6"></a><span id="l21.6"> calendar-event-box[readonly=&quot;true&quot;]:hover .calendar-event-box-grippy-top,</span>
<a href="#l21.7"></a><span id="l21.7"> calendar-event-box[readonly=&quot;true&quot;]:hover .calendar-event-box-grippy-bottom {</span>
<a href="#l21.8"></a><span id="l21.8">     visibility: hidden;</span>
<a href="#l21.9"></a><span id="l21.9">     cursor: auto;</span>
<a href="#l21.10"></a><span id="l21.10"> }</span>
<a href="#l21.11"></a><span id="l21.11"> </span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-/* Alarm image */</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineminus">-.alarm-image {</span>
<a href="#l21.14"></a><span id="l21.14" class="difflineminus">-    list-style-image: url(chrome://calendar/skin/alarm.png);</span>
<a href="#l21.15"></a><span id="l21.15" class="difflineminus">-    margin: 2px 2px 0px;</span>
<a href="#l21.16"></a><span id="l21.16" class="difflineminus">-}</span>
<a href="#l21.17"></a><span id="l21.17" class="difflineminus">-</span>
<a href="#l21.18"></a><span id="l21.18" class="difflineminus">-.alarm-image[flashing=&quot;true&quot;] {</span>
<a href="#l21.19"></a><span id="l21.19" class="difflineminus">-    list-style-image: url(chrome://calendar/skin/alarm-flashing.png);</span>
<a href="#l21.20"></a><span id="l21.20" class="difflineminus">-}</span>
<a href="#l21.21"></a><span id="l21.21" class="difflineminus">-</span>
<a href="#l21.22"></a><span id="l21.22" class="difflineminus">-.alarm-image[suppressed=&quot;true&quot;] {</span>
<a href="#l21.23"></a><span id="l21.23" class="difflineminus">-    list-style-image: url(chrome://calendar/skin/alarm-suppressed.png);</span>
<a href="#l21.24"></a><span id="l21.24" class="difflineminus">-}</span>
<a href="#l21.25"></a><span id="l21.25" class="difflineminus">-</span>
<a href="#l21.26"></a><span id="l21.26" class="difflineminus">-</span>
<a href="#l21.27"></a><span id="l21.27" class="difflineminus">-</span>
<a href="#l21.28"></a><span id="l21.28"> /* tooltips */</span>
<a href="#l21.29"></a><span id="l21.29"> vbox.tooltipBox {</span>
<a href="#l21.30"></a><span id="l21.30">     max-width: 40em;</span>
<a href="#l21.31"></a><span id="l21.31"> }</span>
<a href="#l21.32"></a><span id="l21.32"> </span>
<a href="#l21.33"></a><span id="l21.33"> column.tooltipValueColumn {</span>
<a href="#l21.34"></a><span id="l21.34">     max-width: 35em; /* tooltipBox max-width minus space for label */</span>
<a href="#l21.35"></a><span id="l21.35"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/calendar/import-export/calOutlookCSVImportExport.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/calendar/import-export/calOutlookCSVImportExport.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -33,16 +33,18 @@</span>
<a href="#l22.4"></a><span id="l22.4">  * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l22.5"></a><span id="l22.5">  * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l22.6"></a><span id="l22.6">  * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l22.7"></a><span id="l22.7">  * the provisions above, a recipient may use your version of this file under</span>
<a href="#l22.8"></a><span id="l22.8">  * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l22.9"></a><span id="l22.9">  *</span>
<a href="#l22.10"></a><span id="l22.10">  * ***** END LICENSE BLOCK ***** */</span>
<a href="#l22.11"></a><span id="l22.11"> </span>
<a href="#l22.12"></a><span id="l22.12" class="difflineplus">+Components.utils.import(&quot;resource://calendar/modules/calAlarmUtils.jsm&quot;);</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+</span>
<a href="#l22.14"></a><span id="l22.14"> // Import</span>
<a href="#l22.15"></a><span id="l22.15"> </span>
<a href="#l22.16"></a><span id="l22.16"> function calOutlookCSVImporter() {</span>
<a href="#l22.17"></a><span id="l22.17">     this.wrappedJSObject = this;</span>
<a href="#l22.18"></a><span id="l22.18"> }</span>
<a href="#l22.19"></a><span id="l22.19"> </span>
<a href="#l22.20"></a><span id="l22.20"> calOutlookCSVImporter.prototype.QueryInterface =</span>
<a href="#l22.21"></a><span id="l22.21"> function QueryInterface(aIID) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/calendar/locales/en-US/chrome/calendar/calendar-alarms.properties</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/calendar/locales/en-US/chrome/calendar/calendar-alarms.properties</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -51,10 +51,18 @@ reminderCustomOriginBeginBeforeEvent=bef</span>
<a href="#l23.4"></a><span id="l23.4"> reminderCustomOriginBeginAfterEvent=after the event starts</span>
<a href="#l23.5"></a><span id="l23.5"> reminderCustomOriginEndBeforeEvent=before the event ends</span>
<a href="#l23.6"></a><span id="l23.6"> reminderCustomOriginEndAfterEvent=after the event ends</span>
<a href="#l23.7"></a><span id="l23.7"> reminderCustomOriginBeginBeforeTask=before the task starts</span>
<a href="#l23.8"></a><span id="l23.8"> reminderCustomOriginBeginAfterTask=after the task starts</span>
<a href="#l23.9"></a><span id="l23.9"> reminderCustomOriginEndBeforeTask=before the task ends</span>
<a href="#l23.10"></a><span id="l23.10"> reminderCustomOriginEndAfterTask=after the task ends</span>
<a href="#l23.11"></a><span id="l23.11"> </span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-reminderErrorMaxCountReachedEventN=The selected calendar has a limitation of #1 reminder per event.;The selected calendar has a limitation of #1 reminders per event.</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineminus">-reminderErrorMaxCountReachedTaskN=The selected calendar has a limitation of #1 reminder per task.;The selected calendar has a limitation of #1 reminders per task.</span>
<a href="#l23.14"></a><span id="l23.14" class="difflineplus">+# Sorry about this, but the reminder dialog possibly needs to support changing the</span>
<a href="#l23.15"></a><span id="l23.15" class="difflineplus">+# order of its elements for some locales. This needs to be done in a different</span>
<a href="#l23.16"></a><span id="l23.16" class="difflineplus">+# bug. Please comment in bug XXX what your needs are.</span>
<a href="#l23.17"></a><span id="l23.17" class="difflineplus">+reminderDialogOriginBeginEvent=the event starts</span>
<a href="#l23.18"></a><span id="l23.18" class="difflineplus">+reminderDialogOriginEndEvent=the event ends</span>
<a href="#l23.19"></a><span id="l23.19" class="difflineplus">+reminderDialogOriginBeginTask=the task starts</span>
<a href="#l23.20"></a><span id="l23.20" class="difflineplus">+reminderDialogOriginEndTask=the task ends</span>
<a href="#l23.21"></a><span id="l23.21" class="difflineplus">+</span>
<a href="#l23.22"></a><span id="l23.22" class="difflineplus">+reminderErrorMaxCountReachedEvent=The selected calendar has a limitation of #1 reminder per event.;The selected calendar has a limitation of #1 reminders per event.</span>
<a href="#l23.23"></a><span id="l23.23" class="difflineplus">+reminderErrorMaxCountReachedTask=The selected calendar has a limitation of #1 reminder per task.;The selected calendar has a limitation of #1 reminders per task.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.dtd</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.dtd</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -39,18 +39,16 @@</span>
<a href="#l24.4"></a><span id="l24.4">    - and other provisions required by the LGPL or the GPL. If you do not delete</span>
<a href="#l24.5"></a><span id="l24.5">    - the provisions above, a recipient may use your version of this file under</span>
<a href="#l24.6"></a><span id="l24.6">    - the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l24.7"></a><span id="l24.7">    -</span>
<a href="#l24.8"></a><span id="l24.8">    - ***** END LICENSE BLOCK ***** --&gt;</span>
<a href="#l24.9"></a><span id="l24.9"> </span>
<a href="#l24.10"></a><span id="l24.10"> &lt;!ENTITY event.title.label                  &quot;Edit Item&quot; &gt;</span>
<a href="#l24.11"></a><span id="l24.11"> </span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-&lt;!ENTITY newevent.before.label              &quot;before&quot; &gt;</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineminus">-&lt;!ENTITY newevent.after.label               &quot;after&quot; &gt;</span>
<a href="#l24.14"></a><span id="l24.14"> </span>
<a href="#l24.15"></a><span id="l24.15"> &lt;!ENTITY newevent.from.label                &quot;From&quot; &gt;</span>
<a href="#l24.16"></a><span id="l24.16"> &lt;!ENTITY newevent.to.label                  &quot;To&quot; &gt;</span>
<a href="#l24.17"></a><span id="l24.17"> &lt;!ENTITY newevent.attendees.notify.label    &quot;Notify attendees&quot;&gt;</span>
<a href="#l24.18"></a><span id="l24.18"> </span>
<a href="#l24.19"></a><span id="l24.19"> &lt;!ENTITY newevent.status.label              &quot;Status&quot; &gt;</span>
<a href="#l24.20"></a><span id="l24.20"> &lt;!ENTITY newevent.status.accesskey          &quot;S&quot; &gt;</span>
<a href="#l24.21"></a><span id="l24.21"> &lt;!ENTITY newevent.status.none.label         &quot;Not specified&quot; &gt;</span>
<a href="#l24.22"></a><span id="l24.22" class="difflineat">@@ -332,37 +330,16 @@</span>
<a href="#l24.23"></a><span id="l24.23"> </span>
<a href="#l24.24"></a><span id="l24.24"> &lt;!ENTITY event.recurrence.range.label                   &quot;Range of recurrence&quot;&gt;</span>
<a href="#l24.25"></a><span id="l24.25"> &lt;!ENTITY event.recurrence.forever.label                 &quot;No end date&quot; &gt;</span>
<a href="#l24.26"></a><span id="l24.26"> &lt;!ENTITY event.recurrence.repeat.for.label              &quot;Create&quot; &gt;</span>
<a href="#l24.27"></a><span id="l24.27"> &lt;!ENTITY event.recurrence.appointments.label            &quot;Appointment(s)&quot; &gt;</span>
<a href="#l24.28"></a><span id="l24.28"> &lt;!ENTITY event.repeat.until.label                       &quot;Repeat until&quot; &gt;</span>
<a href="#l24.29"></a><span id="l24.29"> &lt;!ENTITY event.recurrence.preview.label                 &quot;Preview&quot;&gt;</span>
<a href="#l24.30"></a><span id="l24.30"> </span>
<a href="#l24.31"></a><span id="l24.31" class="difflineminus">-&lt;!-- Reminder dialog --&gt;</span>
<a href="#l24.32"></a><span id="l24.32" class="difflineminus">-&lt;!ENTITY alarm.units.minutes                &quot;minutes&quot; &gt;</span>
<a href="#l24.33"></a><span id="l24.33" class="difflineminus">-&lt;!ENTITY alarm.units.hours                  &quot;hours&quot; &gt;</span>
<a href="#l24.34"></a><span id="l24.34" class="difflineminus">-&lt;!ENTITY alarm.units.days                   &quot;days&quot; &gt;</span>
<a href="#l24.35"></a><span id="l24.35" class="difflineminus">-</span>
<a href="#l24.36"></a><span id="l24.36" class="difflineminus">-&lt;!ENTITY reminder.title.label                           &quot;Custom Reminder&quot;&gt;</span>
<a href="#l24.37"></a><span id="l24.37" class="difflineminus">-&lt;!ENTITY reminder.dialogtitle.label                     &quot;Set up reminders&quot;&gt;</span>
<a href="#l24.38"></a><span id="l24.38" class="difflineminus">-&lt;!ENTITY reminder.reminderDetails.label                 &quot;Reminder Details&quot;&gt;</span>
<a href="#l24.39"></a><span id="l24.39" class="difflineminus">-&lt;!ENTITY reminder.action.label                          &quot;Choose a Reminder Action&quot;&gt;</span>
<a href="#l24.40"></a><span id="l24.40" class="difflineminus">-&lt;!ENTITY reminder.action.alert.label                    &quot;Show an Alert&quot;&gt;</span>
<a href="#l24.41"></a><span id="l24.41" class="difflineminus">-&lt;!ENTITY reminder.action.email.label                    &quot;Send an E-mail&quot;&gt;</span>
<a href="#l24.42"></a><span id="l24.42" class="difflineminus">-&lt;!ENTITY reminder.new.label                             &quot;New&quot;&gt;</span>
<a href="#l24.43"></a><span id="l24.43" class="difflineminus">-&lt;!ENTITY reminder.delete.label                          &quot;Delete&quot;&gt;</span>
<a href="#l24.44"></a><span id="l24.44" class="difflineminus">-&lt;!ENTITY reminder.relation.start.label                  &quot;the event starts&quot;&gt;</span>
<a href="#l24.45"></a><span id="l24.45" class="difflineminus">-&lt;!ENTITY reminder.relation.end.label                    &quot;the event ends&quot;&gt;</span>
<a href="#l24.46"></a><span id="l24.46" class="difflineminus">-&lt;!ENTITY reminder.add.label                             &quot;Add&quot;&gt;</span>
<a href="#l24.47"></a><span id="l24.47" class="difflineminus">-&lt;!ENTITY reminder.add.accesskey                         &quot;A&quot;&gt;</span>
<a href="#l24.48"></a><span id="l24.48" class="difflineminus">-&lt;!ENTITY reminder.remove.label                          &quot;Remove&quot;&gt;</span>
<a href="#l24.49"></a><span id="l24.49" class="difflineminus">-&lt;!ENTITY reminder.remove.accesskey                      &quot;R&quot;&gt;</span>
<a href="#l24.50"></a><span id="l24.50" class="difflineminus">-</span>
<a href="#l24.51"></a><span id="l24.51" class="difflineminus">-</span>
<a href="#l24.52"></a><span id="l24.52"> &lt;!-- Attendees dialog --&gt;</span>
<a href="#l24.53"></a><span id="l24.53"> &lt;!ENTITY invite.title.label                     &quot;Invite Attendees&quot;&gt;</span>
<a href="#l24.54"></a><span id="l24.54"> &lt;!ENTITY event.organizer.label                  &quot;Organizer&quot;&gt;</span>
<a href="#l24.55"></a><span id="l24.55"> &lt;!ENTITY event.freebusy.suggest.slot            &quot;Suggest time slot:&quot;&gt;</span>
<a href="#l24.56"></a><span id="l24.56"> &lt;!ENTITY event.freebusy.next.slot               &quot;Next slot &quot; &gt;</span>
<a href="#l24.57"></a><span id="l24.57"> &lt;!ENTITY event.freebusy.previous.slot           &quot; Previous slot&quot; &gt;</span>
<a href="#l24.58"></a><span id="l24.58"> &lt;!ENTITY event.freebusy.zoom                    &quot;Zoom:&quot;&gt;</span>
<a href="#l24.59"></a><span id="l24.59"> &lt;!ENTITY event.freebusy.plus                    &quot;Next hour&quot; &gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.properties</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/calendar/locales/en-US/chrome/calendar/calendar-event-dialog.properties</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -196,42 +196,16 @@ repeatDetailsInfinite=Occurs %1$S\neffec</span>
<a href="#l25.4"></a><span id="l25.4"> #  effective 1/1/2009&quot;</span>
<a href="#l25.5"></a><span id="l25.5"> repeatDetailsInfiniteAllDay=Occurs %1$S\neffective %2$S.</span>
<a href="#l25.6"></a><span id="l25.6"> </span>
<a href="#l25.7"></a><span id="l25.7"> # LOCALIZATION NOTE (ruleTooComplex):</span>
<a href="#l25.8"></a><span id="l25.8"> # This string is shown in the reminder details area if our code can't handle the</span>
<a href="#l25.9"></a><span id="l25.9"> # complexity of the recurrence rule yet.</span>
<a href="#l25.10"></a><span id="l25.10"> ruleTooComplex=Click here for details</span>
<a href="#l25.11"></a><span id="l25.11"> </span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-# LOCALIZATION NOTE (reminderCustomTitle):</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineminus">-# Edit reminder window -&gt; Reminder details link on Event/Task dialog window</span>
<a href="#l25.14"></a><span id="l25.14" class="difflineminus">-# 1%$S - number (reminder length)</span>
<a href="#l25.15"></a><span id="l25.15" class="difflineminus">-# 2%$S - reminderCustomUnit... (minute/hour/day)</span>
<a href="#l25.16"></a><span id="l25.16" class="difflineminus">-# %3$S - reminderCustomRelation... (before/after)</span>
<a href="#l25.17"></a><span id="l25.17" class="difflineminus">-# %4$S - reminderCustomOrigin... (the event starts/ends)</span>
<a href="#l25.18"></a><span id="l25.18" class="difflineminus">-# e.g. &quot;5 hours before the event starts&quot;</span>
<a href="#l25.19"></a><span id="l25.19" class="difflineminus">-reminderCustomTitle=%1$S %2$S %3$S %4$S</span>
<a href="#l25.20"></a><span id="l25.20" class="difflineminus">-reminderTitleAtStartEvent=The moment the event starts</span>
<a href="#l25.21"></a><span id="l25.21" class="difflineminus">-reminderTitleAtStartTask=The moment the task starts</span>
<a href="#l25.22"></a><span id="l25.22" class="difflineminus">-reminderTitleAtEndEvent=The moment the event ends</span>
<a href="#l25.23"></a><span id="l25.23" class="difflineminus">-reminderTitleAtEndTask=The moment the task ends</span>
<a href="#l25.24"></a><span id="l25.24" class="difflineminus">-reminderCustomUnitMinute=minute</span>
<a href="#l25.25"></a><span id="l25.25" class="difflineminus">-reminderCustomUnitMinutes=minutes</span>
<a href="#l25.26"></a><span id="l25.26" class="difflineminus">-reminderCustomUnitHour=hour</span>
<a href="#l25.27"></a><span id="l25.27" class="difflineminus">-reminderCustomUnitHours=hours</span>
<a href="#l25.28"></a><span id="l25.28" class="difflineminus">-reminderCustomUnitDay=day</span>
<a href="#l25.29"></a><span id="l25.29" class="difflineminus">-reminderCustomUnitDays=days</span>
<a href="#l25.30"></a><span id="l25.30" class="difflineminus">-reminderCustomRelationBefore=before</span>
<a href="#l25.31"></a><span id="l25.31" class="difflineminus">-reminderCustomRelationAfter=after</span>
<a href="#l25.32"></a><span id="l25.32" class="difflineminus">-reminderCustomOriginBeginEvent=the event starts</span>
<a href="#l25.33"></a><span id="l25.33" class="difflineminus">-reminderCustomOriginEndEvent=the event ends</span>
<a href="#l25.34"></a><span id="l25.34" class="difflineminus">-reminderCustomOriginBeginTask=the task starts</span>
<a href="#l25.35"></a><span id="l25.35" class="difflineminus">-reminderCustomOriginEndTask=the task ends</span>
<a href="#l25.36"></a><span id="l25.36" class="difflineminus">-reminderErrorMaxCountReachedEvent=The selected calendar has a limitation of %1$S reminders per event.</span>
<a href="#l25.37"></a><span id="l25.37" class="difflineminus">-reminderErrorMaxCountReachedTask=The selected calendar has a limitation of %1$S reminders per task.</span>
<a href="#l25.38"></a><span id="l25.38"> newEvent=New Event</span>
<a href="#l25.39"></a><span id="l25.39"> newTask=New Task</span>
<a href="#l25.40"></a><span id="l25.40"> </span>
<a href="#l25.41"></a><span id="l25.41"> emailSubjectReply=Re: %1$S</span>
<a href="#l25.42"></a><span id="l25.42"> </span>
<a href="#l25.43"></a><span id="l25.43"> # Link Location Dialog</span>
<a href="#l25.44"></a><span id="l25.44"> specifyLinkLocation=Please specify the link location</span>
<a href="#l25.45"></a><span id="l25.45"> enterLinkLocation=Enter a web page, or document location.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1">new file mode 100644</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineminus">--- /dev/null</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineplus">+++ b/calendar/locales/en-US/chrome/calendar/dialogs/calendar-event-dialog-reminder.dtd</span>
<a href="#l26.4"></a><span id="l26.4" class="difflineat">@@ -0,0 +1,54 @@</span>
<a href="#l26.5"></a><span id="l26.5" class="difflineplus">+&lt;!-- ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l26.6"></a><span id="l26.6" class="difflineplus">+   - Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l26.7"></a><span id="l26.7" class="difflineplus">+   -</span>
<a href="#l26.8"></a><span id="l26.8" class="difflineplus">+   - The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l26.9"></a><span id="l26.9" class="difflineplus">+   - 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l26.10"></a><span id="l26.10" class="difflineplus">+   - the License. You may obtain a copy of the License at</span>
<a href="#l26.11"></a><span id="l26.11" class="difflineplus">+   - http://www.mozilla.org/MPL/</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineplus">+   -</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+   - Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l26.14"></a><span id="l26.14" class="difflineplus">+   - WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l26.15"></a><span id="l26.15" class="difflineplus">+   - for the specific language governing rights and limitations under the</span>
<a href="#l26.16"></a><span id="l26.16" class="difflineplus">+   - License.</span>
<a href="#l26.17"></a><span id="l26.17" class="difflineplus">+   -</span>
<a href="#l26.18"></a><span id="l26.18" class="difflineplus">+   - The Original Code is Sun Microsystems code.</span>
<a href="#l26.19"></a><span id="l26.19" class="difflineplus">+   -</span>
<a href="#l26.20"></a><span id="l26.20" class="difflineplus">+   - The Initial Developer of the Original Code is</span>
<a href="#l26.21"></a><span id="l26.21" class="difflineplus">+   -   Philipp Kewisch &lt;mozilla@kewis.ch&gt;</span>
<a href="#l26.22"></a><span id="l26.22" class="difflineplus">+   - Portions created by the Initial Developer are Copyright (C) 2008-2009</span>
<a href="#l26.23"></a><span id="l26.23" class="difflineplus">+   - the Initial Developer. All Rights Reserved.</span>
<a href="#l26.24"></a><span id="l26.24" class="difflineplus">+   -</span>
<a href="#l26.25"></a><span id="l26.25" class="difflineplus">+   - Contributor(s):</span>
<a href="#l26.26"></a><span id="l26.26" class="difflineplus">+   -</span>
<a href="#l26.27"></a><span id="l26.27" class="difflineplus">+   - Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l26.28"></a><span id="l26.28" class="difflineplus">+   - either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l26.29"></a><span id="l26.29" class="difflineplus">+   - the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l26.30"></a><span id="l26.30" class="difflineplus">+   - in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l26.31"></a><span id="l26.31" class="difflineplus">+   - of those above. If you wish to allow use of your version of this file only</span>
<a href="#l26.32"></a><span id="l26.32" class="difflineplus">+   - under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l26.33"></a><span id="l26.33" class="difflineplus">+   - use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l26.34"></a><span id="l26.34" class="difflineplus">+   - decision by deleting the provisions above and replace them with the notice</span>
<a href="#l26.35"></a><span id="l26.35" class="difflineplus">+   - and other provisions required by the LGPL or the GPL. If you do not delete</span>
<a href="#l26.36"></a><span id="l26.36" class="difflineplus">+   - the provisions above, a recipient may use your version of this file under</span>
<a href="#l26.37"></a><span id="l26.37" class="difflineplus">+   - the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l26.38"></a><span id="l26.38" class="difflineplus">+   -</span>
<a href="#l26.39"></a><span id="l26.39" class="difflineplus">+   - ***** END LICENSE BLOCK ***** --&gt;</span>
<a href="#l26.40"></a><span id="l26.40" class="difflineplus">+</span>
<a href="#l26.41"></a><span id="l26.41" class="difflineplus">+&lt;!ENTITY reminderdialog.title                              &quot;Set up Reminders&quot;&gt;</span>
<a href="#l26.42"></a><span id="l26.42" class="difflineplus">+&lt;!ENTITY reminder.add.label                                &quot;Add&quot;&gt;</span>
<a href="#l26.43"></a><span id="l26.43" class="difflineplus">+&lt;!ENTITY reminder.add.accesskey                            &quot;A&quot;&gt;</span>
<a href="#l26.44"></a><span id="l26.44" class="difflineplus">+&lt;!ENTITY reminder.remove.label                             &quot;Remove&quot;&gt;</span>
<a href="#l26.45"></a><span id="l26.45" class="difflineplus">+&lt;!ENTITY reminder.remove.accesskey                         &quot;R&quot;&gt;</span>
<a href="#l26.46"></a><span id="l26.46" class="difflineplus">+</span>
<a href="#l26.47"></a><span id="l26.47" class="difflineplus">+&lt;!ENTITY reminder.reminderDetails.label                    &quot;Reminder Details&quot;&gt;</span>
<a href="#l26.48"></a><span id="l26.48" class="difflineplus">+&lt;!ENTITY reminder.action.label                             &quot;Choose a Reminder Action&quot;&gt;</span>
<a href="#l26.49"></a><span id="l26.49" class="difflineplus">+</span>
<a href="#l26.50"></a><span id="l26.50" class="difflineplus">+&lt;!ENTITY reminder.relation.before.label                    &quot;before&quot; &gt;</span>
<a href="#l26.51"></a><span id="l26.51" class="difflineplus">+&lt;!ENTITY reminder.relation.after.label                     &quot;after&quot; &gt;</span>
<a href="#l26.52"></a><span id="l26.52" class="difflineplus">+</span>
<a href="#l26.53"></a><span id="l26.53" class="difflineplus">+&lt;!ENTITY reminder.action.alert.label                       &quot;Show an Alert&quot;&gt;</span>
<a href="#l26.54"></a><span id="l26.54" class="difflineplus">+&lt;!ENTITY reminder.action.email.label                       &quot;Send an E-mail&quot;&gt;</span>
<a href="#l26.55"></a><span id="l26.55" class="difflineplus">+</span>
<a href="#l26.56"></a><span id="l26.56" class="difflineplus">+&lt;!ENTITY alarm.units.minutes                               &quot;minutes&quot; &gt;</span>
<a href="#l26.57"></a><span id="l26.57" class="difflineplus">+&lt;!ENTITY alarm.units.hours                                 &quot;hours&quot; &gt;</span>
<a href="#l26.58"></a><span id="l26.58" class="difflineplus">+&lt;!ENTITY alarm.units.days                                  &quot;days&quot; &gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/calendar/locales/jar.mn</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/calendar/locales/jar.mn</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -22,8 +22,9 @@ calendar-@AB_CD@.jar:</span>
<a href="#l27.4"></a><span id="l27.4">     locale/@AB_CD@/calendar/preferences/general.dtd        (%chrome/calendar/preferences/general.dtd)</span>
<a href="#l27.5"></a><span id="l27.5">     locale/@AB_CD@/calendar/preferences/preferences.dtd    (%chrome/calendar/preferences/preferences.dtd)</span>
<a href="#l27.6"></a><span id="l27.6">     locale/@AB_CD@/calendar/preferences/timezones.dtd      (%chrome/calendar/preferences/timezones.dtd)</span>
<a href="#l27.7"></a><span id="l27.7">     locale/@AB_CD@/calendar/preferences/views.dtd          (%chrome/calendar/preferences/views.dtd)</span>
<a href="#l27.8"></a><span id="l27.8">     locale/@AB_CD@/calendar/calendar-event-dialog.dtd      (%chrome/calendar/calendar-event-dialog.dtd)</span>
<a href="#l27.9"></a><span id="l27.9">     locale/@AB_CD@/calendar/calendar-event-dialog.properties  (%chrome/calendar/calendar-event-dialog.properties)</span>
<a href="#l27.10"></a><span id="l27.10">     locale/@AB_CD@/calendar/calendar-invitations-dialog.dtd  (%chrome/calendar/calendar-invitations-dialog.dtd)</span>
<a href="#l27.11"></a><span id="l27.11">     locale/@AB_CD@/calendar/calendar-subscriptions-dialog.dtd  (%chrome/calendar/calendar-subscriptions-dialog.dtd)</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineplus">+    locale/@AB_CD@/calendar/dialogs/calendar-event-dialog-reminder.dtd  (%chrome/calendar/dialogs/calendar-event-dialog-reminder.dtd)</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/calendar/providers/gdata/components/calGoogleCalendar.js</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/calendar/providers/gdata/components/calGoogleCalendar.js</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -254,16 +254,20 @@ calGoogleCalendar.prototype = {</span>
<a href="#l28.4"></a><span id="l28.4">             case &quot;capabilities.timezones.floating.supported&quot;:</span>
<a href="#l28.5"></a><span id="l28.5">             case &quot;capabilities.attachments.supported&quot;:</span>
<a href="#l28.6"></a><span id="l28.6">             case &quot;capabilities.priority.supported&quot;:</span>
<a href="#l28.7"></a><span id="l28.7">             case &quot;capabilities.tasks.supported&quot;:</span>
<a href="#l28.8"></a><span id="l28.8">             case &quot;capabilities.alarms.oninvitations.supported&quot;:</span>
<a href="#l28.9"></a><span id="l28.9">                 return false;</span>
<a href="#l28.10"></a><span id="l28.10">             case &quot;capabilities.privacy.values&quot;:</span>
<a href="#l28.11"></a><span id="l28.11">                 return [&quot;DEFAULT&quot;, &quot;PUBLIC&quot;, &quot;PRIVATE&quot;];</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineplus">+            case &quot;capabilities.alarms.maxCount&quot;:</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+                return 5;</span>
<a href="#l28.14"></a><span id="l28.14" class="difflineplus">+            case &quot;capabilities.alarms.actionValues&quot;:</span>
<a href="#l28.15"></a><span id="l28.15" class="difflineplus">+                return [&quot;DISPLAY&quot;, &quot;EMAIL&quot;, &quot;SMS&quot;];</span>
<a href="#l28.16"></a><span id="l28.16">             case &quot;organizerId&quot;:</span>
<a href="#l28.17"></a><span id="l28.17">                 if (this.mSession) {</span>
<a href="#l28.18"></a><span id="l28.18">                     return &quot;mailto:&quot; + this.session.userName;</span>
<a href="#l28.19"></a><span id="l28.19">                 }</span>
<a href="#l28.20"></a><span id="l28.20">                 break;</span>
<a href="#l28.21"></a><span id="l28.21">             case &quot;organizerCN&quot;:</span>
<a href="#l28.22"></a><span id="l28.22">                 if (this.mSession) {</span>
<a href="#l28.23"></a><span id="l28.23">                     return this.session.fullName;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/calendar/providers/gdata/content/gdata-calendar-event-dialog.xul</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/calendar/providers/gdata/content/gdata-calendar-event-dialog.xul</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -32,18 +32,16 @@</span>
<a href="#l29.4"></a><span id="l29.4">    - and other provisions required by the LGPL or the GPL. If you do not delete</span>
<a href="#l29.5"></a><span id="l29.5">    - the provisions above, a recipient may use your version of this file under</span>
<a href="#l29.6"></a><span id="l29.6">    - the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l29.7"></a><span id="l29.7">    -</span>
<a href="#l29.8"></a><span id="l29.8">    - ***** END LICENSE BLOCK ***** --&gt;</span>
<a href="#l29.9"></a><span id="l29.9"> </span>
<a href="#l29.10"></a><span id="l29.10"> &lt;!DOCTYPE overlay SYSTEM &quot;chrome://gdata-provider/locale/gdata.dtd&quot;&gt;</span>
<a href="#l29.11"></a><span id="l29.11"> </span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-&lt;?xml-stylesheet href=&quot;chrome://gdata-provider/skin/gdata-calendar-event-dialog.css&quot; type=&quot;text/css&quot;?&gt;</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineminus">-</span>
<a href="#l29.14"></a><span id="l29.14"> &lt;overlay id=&quot;gdata-calendar-event-dialog&quot;</span>
<a href="#l29.15"></a><span id="l29.15">          xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l29.16"></a><span id="l29.16"> </span>
<a href="#l29.17"></a><span id="l29.17">   &lt;!-- Privacy items --&gt;</span>
<a href="#l29.18"></a><span id="l29.18">   &lt;menupopup id=&quot;options-privacy-menupopup&quot;&gt;</span>
<a href="#l29.19"></a><span id="l29.19">     &lt;menuitem id=&quot;gdata-options-privacy-default-menuitem&quot;</span>
<a href="#l29.20"></a><span id="l29.20">               insertbefore=&quot;options-privacy-public-menuitem,options-privacy-private-menuitem&quot;</span>
<a href="#l29.21"></a><span id="l29.21">               label=&quot;&amp;gdata.privacy.default.label;&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1">new file mode 100644</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineminus">--- /dev/null</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineplus">+++ b/calendar/providers/gdata/content/gdata-event-dialog-reminder.css</span>
<a href="#l30.4"></a><span id="l30.4" class="difflineat">@@ -0,0 +1,39 @@</span>
<a href="#l30.5"></a><span id="l30.5" class="difflineplus">+/* ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l30.6"></a><span id="l30.6" class="difflineplus">+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l30.7"></a><span id="l30.7" class="difflineplus">+ *</span>
<a href="#l30.8"></a><span id="l30.8" class="difflineplus">+ * The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l30.9"></a><span id="l30.9" class="difflineplus">+ * 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l30.10"></a><span id="l30.10" class="difflineplus">+ * the License. You may obtain a copy of the License at</span>
<a href="#l30.11"></a><span id="l30.11" class="difflineplus">+ * http://www.mozilla.org/MPL/</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineplus">+ *</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineplus">+ * Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l30.14"></a><span id="l30.14" class="difflineplus">+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l30.15"></a><span id="l30.15" class="difflineplus">+ * for the specific language governing rights and limitations under the</span>
<a href="#l30.16"></a><span id="l30.16" class="difflineplus">+ * License.</span>
<a href="#l30.17"></a><span id="l30.17" class="difflineplus">+ *</span>
<a href="#l30.18"></a><span id="l30.18" class="difflineplus">+ * The Original Code is Sun Microsystems code.</span>
<a href="#l30.19"></a><span id="l30.19" class="difflineplus">+ *</span>
<a href="#l30.20"></a><span id="l30.20" class="difflineplus">+ * The Initial Developer of the Original Code is</span>
<a href="#l30.21"></a><span id="l30.21" class="difflineplus">+ *   Philipp Kewisch &lt;mozilla@kewis.ch&gt;</span>
<a href="#l30.22"></a><span id="l30.22" class="difflineplus">+ * Portions created by the Initial Developer are Copyright (C) 2008</span>
<a href="#l30.23"></a><span id="l30.23" class="difflineplus">+ * the Initial Developer. All Rights Reserved.</span>
<a href="#l30.24"></a><span id="l30.24" class="difflineplus">+ *</span>
<a href="#l30.25"></a><span id="l30.25" class="difflineplus">+ * Contributor(s):</span>
<a href="#l30.26"></a><span id="l30.26" class="difflineplus">+ *</span>
<a href="#l30.27"></a><span id="l30.27" class="difflineplus">+ * Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l30.28"></a><span id="l30.28" class="difflineplus">+ * either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l30.29"></a><span id="l30.29" class="difflineplus">+ * the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l30.30"></a><span id="l30.30" class="difflineplus">+ * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l30.31"></a><span id="l30.31" class="difflineplus">+ * of those above. If you wish to allow use of your version of this file only</span>
<a href="#l30.32"></a><span id="l30.32" class="difflineplus">+ * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l30.33"></a><span id="l30.33" class="difflineplus">+ * use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l30.34"></a><span id="l30.34" class="difflineplus">+ * decision by deleting the provisions above and replace them with the notice</span>
<a href="#l30.35"></a><span id="l30.35" class="difflineplus">+ * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a href="#l30.36"></a><span id="l30.36" class="difflineplus">+ * the provisions above, a recipient may use your version of this file under</span>
<a href="#l30.37"></a><span id="l30.37" class="difflineplus">+ * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l30.38"></a><span id="l30.38" class="difflineplus">+ *</span>
<a href="#l30.39"></a><span id="l30.39" class="difflineplus">+ * ***** END LICENSE BLOCK ***** */</span>
<a href="#l30.40"></a><span id="l30.40" class="difflineplus">+</span>
<a href="#l30.41"></a><span id="l30.41" class="difflineplus">+.reminder-icon[value=&quot;SMS&quot;] {</span>
<a href="#l30.42"></a><span id="l30.42" class="difflineplus">+  list-style-image: url(chrome://gdata-provider/skin/reminder-action-sms.png);</span>
<a href="#l30.43"></a><span id="l30.43" class="difflineplus">+}</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1">new file mode 100644</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineminus">--- /dev/null</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineplus">+++ b/calendar/providers/gdata/content/gdata-event-dialog-reminder.xul</span>
<a href="#l31.4"></a><span id="l31.4" class="difflineat">@@ -0,0 +1,52 @@</span>
<a href="#l31.5"></a><span id="l31.5" class="difflineplus">+&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<a href="#l31.6"></a><span id="l31.6" class="difflineplus">+&lt;!-- ***** BEGIN LICENSE BLOCK *****</span>
<a href="#l31.7"></a><span id="l31.7" class="difflineplus">+   - Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a href="#l31.8"></a><span id="l31.8" class="difflineplus">+   -</span>
<a href="#l31.9"></a><span id="l31.9" class="difflineplus">+   - The contents of this file are subject to the Mozilla Public License Version</span>
<a href="#l31.10"></a><span id="l31.10" class="difflineplus">+   - 1.1 (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a href="#l31.11"></a><span id="l31.11" class="difflineplus">+   - the License. You may obtain a copy of the License at</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineplus">+   - http://www.mozilla.org/MPL/</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+   -</span>
<a href="#l31.14"></a><span id="l31.14" class="difflineplus">+   - Software distributed under the License is distributed on an &quot;AS IS&quot; basis,</span>
<a href="#l31.15"></a><span id="l31.15" class="difflineplus">+   - WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a href="#l31.16"></a><span id="l31.16" class="difflineplus">+   - for the specific language governing rights and limitations under the</span>
<a href="#l31.17"></a><span id="l31.17" class="difflineplus">+   - License.</span>
<a href="#l31.18"></a><span id="l31.18" class="difflineplus">+   -</span>
<a href="#l31.19"></a><span id="l31.19" class="difflineplus">+   - The Original Code is Sun Microsystems code.</span>
<a href="#l31.20"></a><span id="l31.20" class="difflineplus">+   -</span>
<a href="#l31.21"></a><span id="l31.21" class="difflineplus">+   - The Initial Developer of the Original Code is</span>
<a href="#l31.22"></a><span id="l31.22" class="difflineplus">+   -   Philipp Kewisch &lt;mozilla@kewis.ch&gt;</span>
<a href="#l31.23"></a><span id="l31.23" class="difflineplus">+   - Portions created by the Initial Developer are Copyright (C) 2008</span>
<a href="#l31.24"></a><span id="l31.24" class="difflineplus">+   - the Initial Developer. All Rights Reserved.</span>
<a href="#l31.25"></a><span id="l31.25" class="difflineplus">+   -</span>
<a href="#l31.26"></a><span id="l31.26" class="difflineplus">+   - Contributor(s):</span>
<a href="#l31.27"></a><span id="l31.27" class="difflineplus">+   -</span>
<a href="#l31.28"></a><span id="l31.28" class="difflineplus">+   - Alternatively, the contents of this file may be used under the terms of</span>
<a href="#l31.29"></a><span id="l31.29" class="difflineplus">+   - either the GNU General Public License Version 2 or later (the &quot;GPL&quot;), or</span>
<a href="#l31.30"></a><span id="l31.30" class="difflineplus">+   - the GNU Lesser General Public License Version 2.1 or later (the &quot;LGPL&quot;),</span>
<a href="#l31.31"></a><span id="l31.31" class="difflineplus">+   - in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a href="#l31.32"></a><span id="l31.32" class="difflineplus">+   - of those above. If you wish to allow use of your version of this file only</span>
<a href="#l31.33"></a><span id="l31.33" class="difflineplus">+   - under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a href="#l31.34"></a><span id="l31.34" class="difflineplus">+   - use your version of this file under the terms of the MPL, indicate your</span>
<a href="#l31.35"></a><span id="l31.35" class="difflineplus">+   - decision by deleting the provisions above and replace them with the notice</span>
<a href="#l31.36"></a><span id="l31.36" class="difflineplus">+   - and other provisions required by the LGPL or the GPL. If you do not delete</span>
<a href="#l31.37"></a><span id="l31.37" class="difflineplus">+   - the provisions above, a recipient may use your version of this file under</span>
<a href="#l31.38"></a><span id="l31.38" class="difflineplus">+   - the terms of any one of the MPL, the GPL or the LGPL.</span>
<a href="#l31.39"></a><span id="l31.39" class="difflineplus">+   -</span>
<a href="#l31.40"></a><span id="l31.40" class="difflineplus">+   - ***** END LICENSE BLOCK ***** --&gt;</span>
<a href="#l31.41"></a><span id="l31.41" class="difflineplus">+</span>
<a href="#l31.42"></a><span id="l31.42" class="difflineplus">+&lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;chrome://gdata-provider/skin/gdata-event-dialog-reminder.css&quot;?&gt;</span>
<a href="#l31.43"></a><span id="l31.43" class="difflineplus">+</span>
<a href="#l31.44"></a><span id="l31.44" class="difflineplus">+&lt;!DOCTYPE overlay SYSTEM &quot;chrome://gdata-provider/locale/gdata.dtd&quot;&gt;</span>
<a href="#l31.45"></a><span id="l31.45" class="difflineplus">+</span>
<a href="#l31.46"></a><span id="l31.46" class="difflineplus">+&lt;overlay id=&quot;gdata-event-dialog-reminder-overlay&quot;</span>
<a href="#l31.47"></a><span id="l31.47" class="difflineplus">+         xmlns=&quot;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&quot;&gt;</span>
<a href="#l31.48"></a><span id="l31.48" class="difflineplus">+  &lt;menupopup id=&quot;reminder-actions-menupopup&quot;&gt;</span>
<a href="#l31.49"></a><span id="l31.49" class="difflineplus">+    &lt;menuitem id=&quot;reminder-action-SMS&quot;</span>
<a href="#l31.50"></a><span id="l31.50" class="difflineplus">+              class=&quot;reminder-icon menuitem-iconic&quot;</span>
<a href="#l31.51"></a><span id="l31.51" class="difflineplus">+              value=&quot;SMS&quot;</span>
<a href="#l31.52"></a><span id="l31.52" class="difflineplus">+              insertafter=&quot;reminder-action-EMAIL reminder-action-DISPLAY&quot;</span>
<a href="#l31.53"></a><span id="l31.53" class="difflineplus">+              provider=&quot;gdata&quot;</span>
<a href="#l31.54"></a><span id="l31.54" class="difflineplus">+              label=&quot;&amp;gdata.reminder.action.sms.label;&quot;/&gt;</span>
<a href="#l31.55"></a><span id="l31.55" class="difflineplus">+  &lt;/menupopup&gt;</span>
<a href="#l31.56"></a><span id="l31.56" class="difflineplus">+&lt;/overlay&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1">new file mode 100644</span>
<a href="#l32.2"></a><span id="l32.2">index e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..c39f162f854a7c412fab9b6ff38fffdc61754a58</span>
<a href="#l32.3"></a><span id="l32.3">GIT binary patch
literal 488
zc$@*~0T=#&gt;P)&lt;h;3K|Lk000e1NJLTq000mG000mO1^@s6AM^iV00004XF*Lt006JZ
zHwB960000PbVXQnQ*UN;cVTj606}DLVr3vnZDD6+Qe|Oed2z{QJOBUzdPzh&lt;R5;6x
zlfO&amp;DKorNnm&amp;7yyB@|s83iTgw6gS&lt;vb#?U*aB^rj{{iXXQt03yI0^0O=;GE&lt;oC&gt;A1
zOEJ*J2%-6P-uFsN(314vc)81apZC3Y?}U^RyNqtPD}x|FyWJM~eFHm=EXyz)4*%_2
z`9-hS&gt;nKH+LWpCvJW_K{ee2+Qy$;K=iUCm+-8LExR4SE?bDE}l5@MQWF@R2&lt;=i#hh
zg==L9Gagssz&gt;e{B{#CAk4$LM@iPnXHWk?Xw`LOUEW#s_FFc8NvgbK8&amp;R^1S*OrR37
zn*ts~sNlPI6{FG%N)TkF&lt;p36mfS1!xZP&amp;%4^-OOoz}N=p2hVs-`WTHydVTot2sT{l
zEvx}e=W3PtWTn8rxkeQzSFo&lt;Zcs$m2GMVViv)OEup!5g~VApZb5&gt;%_zHVFy=yhaAh
z=X2P$4d3_SI1Uzzg$DC~VGUH@|Ab+&lt;pI5-QK+FD6uTd5Prqk*DU@&amp;MdmrEU(10zWi
exUT#57w`*0Xt}|&lt;Lu*t30000&lt;MNUMnLSTXhgxDSc</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/calendar/providers/gdata/install.rdf</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/calendar/providers/gdata/install.rdf</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -70,12 +70,13 @@</span>
<a href="#l33.4"></a><span id="l33.4">         &lt;em:minVersion&gt;@CALENDAR_VERSION@&lt;/em:minVersion&gt;</span>
<a href="#l33.5"></a><span id="l33.5">         &lt;em:maxVersion&gt;@CALENDAR_VERSION@&lt;/em:maxVersion&gt;</span>
<a href="#l33.6"></a><span id="l33.6">       &lt;/Description&gt;</span>
<a href="#l33.7"></a><span id="l33.7">     &lt;/em:requires&gt;</span>
<a href="#l33.8"></a><span id="l33.8"> </span>
<a href="#l33.9"></a><span id="l33.9">     &lt;em:name&gt;Provider for Google Calendar&lt;/em:name&gt;</span>
<a href="#l33.10"></a><span id="l33.10">     &lt;em:description&gt;Allows bidirectional access to Google Calendar&lt;/em:description&gt;</span>
<a href="#l33.11"></a><span id="l33.11">     &lt;em:creator&gt;Philipp Kewisch&lt;/em:creator&gt;</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineplus">+    &lt;em:contributor&gt;Mark James (http://www.famfamfam.com/lab/icons/silk/)&lt;/em:contributor&gt;</span>
<a href="#l33.13"></a><span id="l33.13">     &lt;em:homepageURL&gt;https://addons.mozilla.org/en-US/sunbird/addon/4631&lt;/em:homepageURL&gt;</span>
<a href="#l33.14"></a><span id="l33.14">     &lt;em:iconURL&gt;chrome://gdata-provider/content/gcal.png&lt;/em:iconURL&gt;</span>
<a href="#l33.15"></a><span id="l33.15">   &lt;/Description&gt;</span>
<a href="#l33.16"></a><span id="l33.16"> &lt;/RDF&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/calendar/providers/gdata/jar.mn</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/calendar/providers/gdata/jar.mn</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -1,15 +1,22 @@</span>
<a href="#l34.4"></a><span id="l34.4"> #filter substitution</span>
<a href="#l34.5"></a><span id="l34.5"> </span>
<a href="#l34.6"></a><span id="l34.6"> gdata-provider.jar:</span>
<a href="#l34.7"></a><span id="l34.7"> % content gdata-provider %content/</span>
<a href="#l34.8"></a><span id="l34.8" class="difflineminus">-% skin gdata-provider classic/1.0 %skin/</span>
<a href="#l34.9"></a><span id="l34.9"> % overlay chrome://calendar/content/calendarCreation.xul chrome://gdata-provider/content/calendarCreation.xul</span>
<a href="#l34.10"></a><span id="l34.10"> % overlay chrome://sunbird/content/calendar.xul chrome://gdata-provider/content/gdata-migration-overlay.xul    application={718e30fb-e89b-41dd-9da7-e25a45638b28}</span>
<a href="#l34.11"></a><span id="l34.11"> % overlay chrome://messenger/content/messenger.xul chrome://gdata-provider/content/gdata-migration-overlay.xul  application={3550f703-e582-4d05-9a08-453d09bdfdc6}</span>
<a href="#l34.12"></a><span id="l34.12"> % overlay chrome://calendar/content/calendar-event-dialog.xul chrome://gdata-provider/content/gdata-calendar-event-dialog.xul</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+% overlay chrome://calendar/content/sun-calendar-event-dialog-reminder.xul chrome://gdata-provider/content/gdata-event-dialog-reminder.xul</span>
<a href="#l34.14"></a><span id="l34.14" class="difflineplus">+% style chrome://calendar/content/sun-calendar-event-dialog.xul chrome://gdata-provider/skin/gdata-event-dialog-reminder.css</span>
<a href="#l34.15"></a><span id="l34.15" class="difflineplus">+% style chrome://calendar/content/calendar.xul chrome://gdata-provider/skin/gdata-event-dialog-reminder.css     application={718e30fb-e89b-41dd-9da7-e25a45638b28}</span>
<a href="#l34.16"></a><span id="l34.16" class="difflineplus">+% style chrome://messenger/content/messenger.xul chrome://gdata-provider/skin/gdata-event-dialog-reminder.css   application={3550f703-e582-4d05-9a08-453d09bdfdc6}</span>
<a href="#l34.17"></a><span id="l34.17">     content/calendarCreation.xul                 (content/calendarCreation.xul)</span>
<a href="#l34.18"></a><span id="l34.18">     content/gdata-calendar-event-dialog.xul      (content/gdata-calendar-event-dialog.xul)</span>
<a href="#l34.19"></a><span id="l34.19" class="difflineplus">+    content/gdata-event-dialog-reminder.xul      (content/gdata-event-dialog-reminder.xul)</span>
<a href="#l34.20"></a><span id="l34.20">     content/gdata-migration.js                   (content/gdata-migration.js)</span>
<a href="#l34.21"></a><span id="l34.21">     content/gdata-migration-overlay.xul          (content/gdata-migration-overlay.xul)</span>
<a href="#l34.22"></a><span id="l34.22">     content/gdata-migration-wizard.xul           (content/gdata-migration-wizard.xul)</span>
<a href="#l34.23"></a><span id="l34.23">     content/gcal.png                             (content/gcal.png)</span>
<a href="#l34.24"></a><span id="l34.24" class="difflineplus">+% skin gdata-provider classic/1.0 %skin/</span>
<a href="#l34.25"></a><span id="l34.25" class="difflineplus">+    skin/reminder-action-sms.png                 (content/reminder-action-sms.png)</span>
<a href="#l34.26"></a><span id="l34.26" class="difflineplus">+    skin/gdata-event-dialog-reminder.css         (content/gdata-event-dialog-reminder.css)</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

