<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<link rel="icon" href="/static/35f393d6769a/hgicon.png" type="image/png" />
<meta name="robots" content="index, nofollow"/>
<link rel="stylesheet" href="/static/35f393d6769a/style-gitweb.css" type="text/css" />

<style type="text/css">
div.feed {
  float: right;
}
a img {
  border-width: 0px;
}
div.log_link {
  width: 80px;
  background-color: white;
}

div.log_body {
  padding-left: 96px;
}
</style>
<script type="text/javascript" src="/static/35f393d6769a/mercurial.js"></script>

<meta property="og:image" content="/static/35f393d6769a/moz-logo-bw-rgb.svg"/>
<meta property="og:type" content="website"/>

<title>comm-central: changeset 20048:42fb631fc841ecac5ae911a85fdc9fa38ba68954</title>
<link rel="alternate" type="application/atom+xml"
   href="/comm-central/atom-log" title="Atom feed for comm-central"/>
<link rel="alternate" type="application/rss+xml"
   href="/comm-central/rss-log" title="RSS feed for comm-central"/>

<meta property="og:title" content="comm-central @ 42fb631fc841ecac5ae911a85fdc9fa38ba68954" />
<meta property="og:url" content="/comm-central/rev/42fb631fc841ecac5ae911a85fdc9fa38ba68954" />
<meta property="og:description" content="Bug 1280898 - Set up eslint for calendar files - enable semi rule. r=MakeMyDay" />

</head>
<body>

<div class="page_header">
<div class="logo">
    <a href="https://developer.mozilla.org/en/docs/Mercurial">
        <img src="/static/35f393d6769a/moz-logo-bw-rgb.svg" alt="mercurial" />
    </a>
</div>
<a href="/">Mercurial</a> &gt; <a href="/comm-central">comm-central</a>  / changeset / 42fb631fc841ecac5ae911a85fdc9fa38ba68954 
</div>

<div class="page_nav">
<div>
<a href="/comm-central/summary">summary</a> |
<a href="/comm-central/shortlog/42fb631fc841ecac5ae911a85fdc9fa38ba68954">shortlog</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954">changelog</a> |
<a href="/comm-central/pushloghtml">pushlog</a> |
<a href="/comm-central/graph/42fb631fc841ecac5ae911a85fdc9fa38ba68954">graph</a> |
<a href="/comm-central/tags">tags</a> |
<a href="/comm-central/bookmarks">bookmarks</a> |
<a href="/comm-central/branches">branches</a> |
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954">files</a> |
changeset |
<a href="/comm-central/raw-rev/42fb631fc841ecac5ae911a85fdc9fa38ba68954">raw</a>  | <a href="/comm-central/archive/42fb631fc841ecac5ae911a85fdc9fa38ba68954.zip">zip</a>  |
<a href="/comm-central/help">help</a>
</div>

<div class="search">
<form id="searchform" action="/comm-central/log">

<input name="rev" type="text" value="" size="40" />
<div id="hint">Find changesets by keywords (author, files, the commit message), revision
number or hash, or <a href="/comm-central/help/revsets">revset expression</a>.</div>
</form>
</div>
</div>

<div class="title">
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">Bug 1280898</a> - Set up eslint for calendar files - enable semi rule. r=MakeMyDay
<span class="logtags"></span>
</div>
<div class="title_text">
<table cellspacing="0">

<tr><td>author</td><td>&#101;&#115;&#108;&#105;&#110;&#116;&#32;&#60;&#101;&#115;&#108;&#105;&#110;&#116;&#64;&#98;&#117;&#103;&#122;&#105;&#108;&#108;&#97;&#46;&#107;&#101;&#119;&#105;&#115;&#46;&#99;&#104;&#62;</td></tr>
<tr><td></td><td class="date age">Fri, 08 Jul 2016 11:19:24 +0200</td></tr>

<tr>
 <td>changeset 20048</td>
 <td style="font-family:monospace"><a class="list" href="/comm-central/rev/42fb631fc841ecac5ae911a85fdc9fa38ba68954">42fb631fc841ecac5ae911a85fdc9fa38ba68954</a></td>
</tr>



<tr>
<td>parent 20047</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/626c889fd0927fd07df3bfe982a09c19ea7a8e7e">626c889fd0927fd07df3bfe982a09c19ea7a8e7e</a>
</td>
</tr>

<tr>
<td>child 20049</td>
<td style="font-family:monospace">
<a class="list" href="/comm-central/rev/305102c9beddb775c8841d10118d73e0adc5e3a3">305102c9beddb775c8841d10118d73e0adc5e3a3</a>
</td>
</tr>
<tr><td>push id</td><td><a href="/comm-central/pushloghtml?changeset=42fb631fc841ecac5ae911a85fdc9fa38ba68954">12298</a></td></tr>
<tr><td>push user</td><td>mozilla@kewis.ch</td></tr>
<tr><td>push date</td><td class="date age">Fri, 16 Sep 2016 20:23:58 +0000</td></tr>

<tr><td>treeherder</td><td>comm-central@fd02e757b142 [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=fd02e757b1420b415cd3df380922d350c3dbefb6">default view</a>] [<a href="https://treeherder.mozilla.org/#/jobs?repo=comm-central&revision=fd02e757b1420b415cd3df380922d350c3dbefb6&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception">failures only]</td></tr>
<tr><td>perfherder</td><td>[<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=fd02e757b1420b415cd3df380922d350c3dbefb6&newProject=comm-central&newRevision=626c889fd0927fd07df3bfe982a09c19ea7a8e7e&framework=1" target="_blank">talos</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=fd02e757b1420b415cd3df380922d350c3dbefb6&newProject=comm-central&newRevision=626c889fd0927fd07df3bfe982a09c19ea7a8e7e&framework=2" target="_blank">build metrics</a>] [<a href="https://treeherder.mozilla.org/perf.html#/compare?originalProject=comm-central&originalRevision=fd02e757b1420b415cd3df380922d350c3dbefb6&newProject=comm-central&newRevision=626c889fd0927fd07df3bfe982a09c19ea7a8e7e&framework=6" target="_blank">platform microbench</a>] (compared to previous push)</td></tr>
<tr><td>reviewers</td><td><a href="/comm-central/log?rev=reviewer%28MakeMyDay%29&revcount=50">MakeMyDay</a></td></tr>
<tr><td>bugs</td><td><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">1280898</a></td></tr>




</table></div>

<div class="page_body description"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1280898">Bug 1280898</a> - Set up eslint for calendar files - enable semi rule. r=MakeMyDay

MozReview-Commit-ID: 6uLD7JQnPWh</div>
<div class="list_head"></div>
<div class="title_text">
<table cellspacing="0">

<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/.eslintrc">calendar/.eslintrc</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/.eslintrc">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/.eslintrc">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/.eslintrc">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/.eslintrc">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/.eslintrc">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/backend/icaljs/calICSService-worker.js">calendar/base/backend/icaljs/calICSService-worker.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/backend/icaljs/calICSService-worker.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/backend/icaljs/calICSService-worker.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/backend/icaljs/calICSService-worker.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/backend/icaljs/calICSService-worker.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/backend/icaljs/calICSService-worker.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/backend/icaljs/calICSService.js">calendar/base/backend/icaljs/calICSService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/backend/icaljs/calICSService.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/backend/icaljs/calICSService.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/backend/icaljs/calICSService.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/backend/icaljs/calICSService.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/backend/icaljs/calICSService.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/agenda-listbox.js">calendar/base/content/agenda-listbox.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/agenda-listbox.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/agenda-listbox.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/agenda-listbox.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/agenda-listbox.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/agenda-listbox.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-chrome-startup.js">calendar/base/content/calendar-chrome-startup.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-chrome-startup.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-chrome-startup.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-chrome-startup.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-chrome-startup.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-chrome-startup.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-extract.js">calendar/base/content/calendar-extract.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-extract.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-extract.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-extract.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-extract.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-extract.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-invitations-manager.js">calendar/base/content/calendar-invitations-manager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-invitations-manager.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-invitations-manager.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-invitations-manager.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-invitations-manager.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-invitations-manager.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-item-editing.js">calendar/base/content/calendar-item-editing.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-item-editing.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-item-editing.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-item-editing.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-item-editing.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-item-editing.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-month-view.xml">calendar/base/content/calendar-month-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-month-view.xml">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-month-view.xml">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-month-view.xml">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-month-view.xml">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-month-view.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-multiday-view.xml">calendar/base/content/calendar-multiday-view.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-multiday-view.xml">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-multiday-view.xml">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-multiday-view.xml">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-multiday-view.xml">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-multiday-view.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-task-view.js">calendar/base/content/calendar-task-view.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-task-view.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-task-view.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-task-view.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-task-view.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-task-view.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-view-core.xml">calendar/base/content/calendar-view-core.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-view-core.xml">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-view-core.xml">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-view-core.xml">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-view-core.xml">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-view-core.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-views.js">calendar/base/content/calendar-views.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-views.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-views.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-views.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-views.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/calendar-views.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-alarm-dialog.js">calendar/base/content/dialogs/calendar-alarm-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-alarm-dialog.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-alarm-dialog.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-alarm-dialog.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-alarm-dialog.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-alarm-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">calendar/base/content/dialogs/calendar-event-dialog-attendees.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-attendees.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">calendar/base/content/dialogs/calendar-event-dialog-attendees.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml">calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">calendar/base/content/dialogs/calendar-event-dialog-recurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">calendar/base/content/dialogs/calendar-event-dialog-reminder.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-event-dialog-reminder.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-print-dialog.js">calendar/base/content/dialogs/calendar-print-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-print-dialog.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-print-dialog.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-print-dialog.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-print-dialog.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-print-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-properties-dialog.js">calendar/base/content/dialogs/calendar-properties-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-properties-dialog.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-properties-dialog.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-properties-dialog.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-properties-dialog.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-properties-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-summary-dialog.js">calendar/base/content/dialogs/calendar-summary-dialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-summary-dialog.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-summary-dialog.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-summary-dialog.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-summary-dialog.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/dialogs/calendar-summary-dialog.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/import-export.js">calendar/base/content/import-export.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/import-export.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/import-export.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/import-export.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/import-export.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/import-export.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/preferences/categories.js">calendar/base/content/preferences/categories.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/preferences/categories.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/preferences/categories.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/preferences/categories.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/preferences/categories.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/preferences/categories.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/calendar-list-tree.xml">calendar/base/content/widgets/calendar-list-tree.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/calendar-list-tree.xml">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/calendar-list-tree.xml">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/calendar-list-tree.xml">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/calendar-list-tree.xml">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/calendar-list-tree.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/calendar-widgets.xml">calendar/base/content/widgets/calendar-widgets.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/calendar-widgets.xml">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/calendar-widgets.xml">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/calendar-widgets.xml">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/calendar-widgets.xml">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/calendar-widgets.xml">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/minimonth.xml">calendar/base/content/widgets/minimonth.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/minimonth.xml">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/minimonth.xml">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/minimonth.xml">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/minimonth.xml">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/content/widgets/minimonth.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calAsyncUtils.jsm">calendar/base/modules/calAsyncUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calAsyncUtils.jsm">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calAsyncUtils.jsm">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calAsyncUtils.jsm">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calAsyncUtils.jsm">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calAsyncUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calExtract.jsm">calendar/base/modules/calExtract.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calExtract.jsm">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calExtract.jsm">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calExtract.jsm">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calExtract.jsm">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calExtract.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calHashedArray.jsm">calendar/base/modules/calHashedArray.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calHashedArray.jsm">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calHashedArray.jsm">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calHashedArray.jsm">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calHashedArray.jsm">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calHashedArray.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calItipUtils.jsm">calendar/base/modules/calItipUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calItipUtils.jsm">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calItipUtils.jsm">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calItipUtils.jsm">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calItipUtils.jsm">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calItipUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calPrintUtils.jsm">calendar/base/modules/calPrintUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calPrintUtils.jsm">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calPrintUtils.jsm">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calPrintUtils.jsm">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calPrintUtils.jsm">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calPrintUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calProviderUtils.jsm">calendar/base/modules/calProviderUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calProviderUtils.jsm">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calProviderUtils.jsm">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calProviderUtils.jsm">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calProviderUtils.jsm">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calProviderUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calRecurrenceUtils.jsm">calendar/base/modules/calRecurrenceUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calRecurrenceUtils.jsm">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calRecurrenceUtils.jsm">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calRecurrenceUtils.jsm">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calRecurrenceUtils.jsm">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calRecurrenceUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calUtils.jsm">calendar/base/modules/calUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calUtils.jsm">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calUtils.jsm">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calUtils.jsm">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calUtils.jsm">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calViewUtils.jsm">calendar/base/modules/calViewUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calViewUtils.jsm">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calViewUtils.jsm">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calViewUtils.jsm">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calViewUtils.jsm">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/modules/calViewUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calAlarmService.js">calendar/base/src/calAlarmService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calAlarmService.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calAlarmService.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calAlarmService.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calAlarmService.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calAlarmService.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCachedCalendar.js">calendar/base/src/calCachedCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCachedCalendar.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCachedCalendar.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCachedCalendar.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCachedCalendar.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCachedCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCalendarManager.js">calendar/base/src/calCalendarManager.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCalendarManager.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCalendarManager.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCalendarManager.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCalendarManager.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCalendarManager.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCalendarSearchService.js">calendar/base/src/calCalendarSearchService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCalendarSearchService.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCalendarSearchService.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCalendarSearchService.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCalendarSearchService.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calCalendarSearchService.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calEvent.js">calendar/base/src/calEvent.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calEvent.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calEvent.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calEvent.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calEvent.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calEvent.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calFreeBusyService.js">calendar/base/src/calFreeBusyService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calFreeBusyService.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calFreeBusyService.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calFreeBusyService.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calFreeBusyService.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calFreeBusyService.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calItemBase.js">calendar/base/src/calItemBase.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calItemBase.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calItemBase.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calItemBase.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calItemBase.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calItemBase.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calRecurrenceInfo.js">calendar/base/src/calRecurrenceInfo.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calRecurrenceInfo.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calRecurrenceInfo.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calRecurrenceInfo.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calRecurrenceInfo.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calRecurrenceInfo.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calTimezoneService.js">calendar/base/src/calTimezoneService.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calTimezoneService.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calTimezoneService.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calTimezoneService.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calTimezoneService.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calTimezoneService.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calTodo.js">calendar/base/src/calTodo.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calTodo.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calTodo.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calTodo.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calTodo.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calTodo.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calUtils.js">calendar/base/src/calUtils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calUtils.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calUtils.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calUtils.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calUtils.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/base/src/calUtils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/import-export/calOutlookCSVImportExport.js">calendar/import-export/calOutlookCSVImportExport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/import-export/calOutlookCSVImportExport.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/import-export/calOutlookCSVImportExport.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/import-export/calOutlookCSVImportExport.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/import-export/calOutlookCSVImportExport.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/import-export/calOutlookCSVImportExport.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/itip/calItipEmailTransport.js">calendar/itip/calItipEmailTransport.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/itip/calItipEmailTransport.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/itip/calItipEmailTransport.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/itip/calItipEmailTransport.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/itip/calItipEmailTransport.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/itip/calItipEmailTransport.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/html-item-editing/react-code.js">calendar/lightning/content/html-item-editing/react-code.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/html-item-editing/react-code.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/html-item-editing/react-code.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/html-item-editing/react-code.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/html-item-editing/react-code.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/html-item-editing/react-code.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/imip-bar.js">calendar/lightning/content/imip-bar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/imip-bar.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/imip-bar.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/imip-bar.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/imip-bar.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/imip-bar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/lightning-item-iframe.js">calendar/lightning/content/lightning-item-iframe.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/lightning-item-iframe.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/lightning-item-iframe.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/lightning-item-iframe.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/lightning-item-iframe.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/lightning-item-iframe.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/lightning-item-panel.js">calendar/lightning/content/lightning-item-panel.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/lightning-item-panel.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/lightning-item-panel.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/lightning-item-panel.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/lightning-item-panel.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/lightning-item-panel.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/messenger-overlay-sidebar.js">calendar/lightning/content/messenger-overlay-sidebar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/messenger-overlay-sidebar.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/messenger-overlay-sidebar.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/messenger-overlay-sidebar.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/messenger-overlay-sidebar.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/messenger-overlay-sidebar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/suite-overlay-sidebar.js">calendar/lightning/content/suite-overlay-sidebar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/suite-overlay-sidebar.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/suite-overlay-sidebar.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/suite-overlay-sidebar.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/suite-overlay-sidebar.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/content/suite-overlay-sidebar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/modules/ltnInvitationUtils.jsm">calendar/lightning/modules/ltnInvitationUtils.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/modules/ltnInvitationUtils.jsm">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/modules/ltnInvitationUtils.jsm">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/modules/ltnInvitationUtils.jsm">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/modules/ltnInvitationUtils.jsm">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/lightning/modules/ltnInvitationUtils.jsm">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/caldav/calDavCalendar.js">calendar/providers/caldav/calDavCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/caldav/calDavCalendar.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/caldav/calDavCalendar.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/caldav/calDavCalendar.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/caldav/calDavCalendar.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/caldav/calDavCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/caldav/calDavRequestHandlers.js">calendar/providers/caldav/calDavRequestHandlers.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/caldav/calDavRequestHandlers.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/caldav/calDavRequestHandlers.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/caldav/calDavRequestHandlers.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/caldav/calDavRequestHandlers.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/caldav/calDavRequestHandlers.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/ics/calICSCalendar.js">calendar/providers/ics/calICSCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/ics/calICSCalendar.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/ics/calICSCalendar.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/ics/calICSCalendar.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/ics/calICSCalendar.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/ics/calICSCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/storage/calStorageCalendar.js">calendar/providers/storage/calStorageCalendar.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/storage/calStorageCalendar.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/storage/calStorageCalendar.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/storage/calStorageCalendar.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/storage/calStorageCalendar.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/storage/calStorageCalendar.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/storage/calStorageUpgrade.jsm">calendar/providers/storage/calStorageUpgrade.jsm</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/storage/calStorageUpgrade.jsm">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/storage/calStorageUpgrade.jsm">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/storage/calStorageUpgrade.jsm">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/storage/calStorageUpgrade.jsm">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/storage/calStorageUpgrade.jsm">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/wcap/calWcapCalendarItems.js">calendar/providers/wcap/calWcapCalendarItems.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/wcap/calWcapCalendarItems.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/wcap/calWcapCalendarItems.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/wcap/calWcapCalendarItems.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/wcap/calWcapCalendarItems.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/wcap/calWcapCalendarItems.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/wcap/calWcapSession.js">calendar/providers/wcap/calWcapSession.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/wcap/calWcapSession.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/wcap/calWcapSession.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/wcap/calWcapSession.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/wcap/calWcapSession.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/providers/wcap/calWcapSession.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/calendarCreation.js">calendar/resources/content/calendarCreation.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/calendarCreation.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/calendarCreation.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/calendarCreation.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/calendarCreation.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/calendarCreation.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/datetimepickers/datetimepickers.xml">calendar/resources/content/datetimepickers/datetimepickers.xml</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/datetimepickers/datetimepickers.xml">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/datetimepickers/datetimepickers.xml">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/datetimepickers/datetimepickers.xml">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/datetimepickers/datetimepickers.xml">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/datetimepickers/datetimepickers.xml">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/publish.js">calendar/resources/content/publish.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/publish.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/publish.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/publish.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/publish.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/resources/content/publish.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testEventDialog.js">calendar/test/mozmill/eventDialog/testEventDialog.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testEventDialog.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testEventDialog.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testEventDialog.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testEventDialog.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testEventDialog.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testUTF8.js">calendar/test/mozmill/eventDialog/testUTF8.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testUTF8.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testUTF8.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testUTF8.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testUTF8.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/eventDialog/testUTF8.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testAnnualRecurrence.js">calendar/test/mozmill/recurrence/testAnnualRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testAnnualRecurrence.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testAnnualRecurrence.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testAnnualRecurrence.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testAnnualRecurrence.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testAnnualRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js">calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testDailyRecurrence.js">calendar/test/mozmill/recurrence/testDailyRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testDailyRecurrence.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testDailyRecurrence.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testDailyRecurrence.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testDailyRecurrence.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testDailyRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js">calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/shared-modules/calendar-utils.js">calendar/test/mozmill/shared-modules/calendar-utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/shared-modules/calendar-utils.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/shared-modules/calendar-utils.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/shared-modules/calendar-utils.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/shared-modules/calendar-utils.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/shared-modules/calendar-utils.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testAlarmDefaultValue.js">calendar/test/mozmill/testAlarmDefaultValue.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testAlarmDefaultValue.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testAlarmDefaultValue.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testAlarmDefaultValue.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testAlarmDefaultValue.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testAlarmDefaultValue.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testBasicFunctionality.js">calendar/test/mozmill/testBasicFunctionality.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testBasicFunctionality.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testBasicFunctionality.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testBasicFunctionality.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testBasicFunctionality.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testBasicFunctionality.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testLocalICS.js">calendar/test/mozmill/testLocalICS.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testLocalICS.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testLocalICS.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testLocalICS.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testLocalICS.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testLocalICS.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testTodayPane.js">calendar/test/mozmill/testTodayPane.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testTodayPane.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testTodayPane.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testTodayPane.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testTodayPane.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/testTodayPane.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test1.js">calendar/test/mozmill/timezoneTests/test1.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test1.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test1.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test1.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test1.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test1.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test10.js">calendar/test/mozmill/timezoneTests/test10.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test10.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test10.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test10.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test10.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test10.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test2.js">calendar/test/mozmill/timezoneTests/test2.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test2.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test2.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test2.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test2.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test2.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test3.js">calendar/test/mozmill/timezoneTests/test3.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test3.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test3.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test3.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test3.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test3.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test4.js">calendar/test/mozmill/timezoneTests/test4.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test4.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test4.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test4.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test4.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test4.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test5.js">calendar/test/mozmill/timezoneTests/test5.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test5.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test5.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test5.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test5.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test5.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test6.js">calendar/test/mozmill/timezoneTests/test6.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test6.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test6.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test6.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test6.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test6.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test7.js">calendar/test/mozmill/timezoneTests/test7.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test7.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test7.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test7.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test7.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test7.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test8.js">calendar/test/mozmill/timezoneTests/test8.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test8.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test8.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test8.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test8.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test8.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test9.js">calendar/test/mozmill/timezoneTests/test9.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test9.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test9.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test9.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test9.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/timezoneTests/test9.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testDayView.js">calendar/test/mozmill/views/testDayView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testDayView.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testDayView.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testDayView.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testDayView.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testDayView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testMonthView.js">calendar/test/mozmill/views/testMonthView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testMonthView.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testMonthView.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testMonthView.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testMonthView.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testMonthView.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testMultiweekView.js">calendar/test/mozmill/views/testMultiweekView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testMultiweekView.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testMultiweekView.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testMultiweekView.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testMultiweekView.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testMultiweekView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testTaskView.js">calendar/test/mozmill/views/testTaskView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testTaskView.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testTaskView.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testTaskView.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testTaskView.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testTaskView.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testWeekView.js">calendar/test/mozmill/views/testWeekView.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testWeekView.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testWeekView.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testWeekView.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testWeekView.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/mozmill/views/testWeekView.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_alarm.js">calendar/test/unit/test_alarm.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_alarm.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_alarm.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_alarm.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_alarm.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_alarm.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_alarmutils.js">calendar/test/unit/test_alarmutils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_alarmutils.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_alarmutils.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_alarmutils.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_alarmutils.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_alarmutils.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_attendee.js">calendar/test/unit/test_attendee.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_attendee.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_attendee.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_attendee.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_attendee.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_attendee.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_calmgr.js">calendar/test/unit/test_calmgr.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_calmgr.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_calmgr.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_calmgr.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_calmgr.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_calmgr.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_deleted_items.js">calendar/test/unit/test_deleted_items.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_deleted_items.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_deleted_items.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_deleted_items.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_deleted_items.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_deleted_items.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_freebusy_service.js">calendar/test/unit/test_freebusy_service.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_freebusy_service.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_freebusy_service.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_freebusy_service.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_freebusy_service.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_freebusy_service.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_gdata_provider.js">calendar/test/unit/test_gdata_provider.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_gdata_provider.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_gdata_provider.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_gdata_provider.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_gdata_provider.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_gdata_provider.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_hashedarray.js">calendar/test/unit/test_hashedarray.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_hashedarray.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_hashedarray.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_hashedarray.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_hashedarray.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_hashedarray.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_ics_parser.js">calendar/test/unit/test_ics_parser.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_ics_parser.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_ics_parser.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_ics_parser.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_ics_parser.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_ics_parser.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_recur.js">calendar/test/unit/test_recur.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_recur.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_recur.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_recur.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_recur.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_recur.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_relation.js">calendar/test/unit/test_relation.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_relation.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_relation.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_relation.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_relation.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_relation.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_rfc3339_parser.js">calendar/test/unit/test_rfc3339_parser.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_rfc3339_parser.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_rfc3339_parser.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_rfc3339_parser.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_rfc3339_parser.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_rfc3339_parser.js">revisions</a>
</td>
</tr>
<tr class="parity0">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_search_service.js">calendar/test/unit/test_search_service.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_search_service.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_search_service.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_search_service.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_search_service.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_search_service.js">revisions</a>
</td>
</tr>
<tr class="parity1">
<td><a class="list" href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_utils.js">calendar/test/unit/test_utils.js</a></td>
<td></td>
<td class="link">
<a href="/comm-central/file/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_utils.js">file</a> |
<a href="/comm-central/annotate/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_utils.js">annotate</a> |
<a href="/comm-central/diff/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_utils.js">diff</a> |
<a href="/comm-central/comparison/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_utils.js">comparison</a> |
<a href="/comm-central/log/42fb631fc841ecac5ae911a85fdc9fa38ba68954/calendar/test/unit/test_utils.js">revisions</a>
</td>
</tr>
</table></div>

<div class="page_body diffblocks"><div class="diffblock"><pre class="sourcelines">
<a href="#l1.1"></a><span id="l1.1" class="difflineminus">--- a/calendar/.eslintrc</span>
<a href="#l1.2"></a><span id="l1.2" class="difflineplus">+++ b/calendar/.eslintrc</span>
<a href="#l1.3"></a><span id="l1.3" class="difflineat">@@ -175,16 +175,19 @@</span>
<a href="#l1.4"></a><span id="l1.4">     // Require space after keyword for anonymous functions, but disallow space</span>
<a href="#l1.5"></a><span id="l1.5">     // after name of named functions.</span>
<a href="#l1.6"></a><span id="l1.6">     &quot;space-before-function-paren&quot;: [2, {&quot;anonymous&quot;: &quot;never&quot;, &quot;named&quot;: &quot;never&quot;}],</span>
<a href="#l1.7"></a><span id="l1.7"> </span>
<a href="#l1.8"></a><span id="l1.8">     // Disallow unreachable statements after a return, throw, continue, or break</span>
<a href="#l1.9"></a><span id="l1.9">     // statement.</span>
<a href="#l1.10"></a><span id="l1.10">     &quot;no-unreachable&quot;: 2,</span>
<a href="#l1.11"></a><span id="l1.11"> </span>
<a href="#l1.12"></a><span id="l1.12" class="difflineplus">+    // Always require use of semicolons wherever they are valid.</span>
<a href="#l1.13"></a><span id="l1.13" class="difflineplus">+    &quot;semi&quot;: [2, &quot;always&quot;],</span>
<a href="#l1.14"></a><span id="l1.14" class="difflineplus">+</span>
<a href="#l1.15"></a><span id="l1.15">     // Will enable these rules later</span>
<a href="#l1.16"></a><span id="l1.16">     &quot;block-spacing&quot;: 0,</span>
<a href="#l1.17"></a><span id="l1.17">     &quot;no-lonely-if&quot;: 0,</span>
<a href="#l1.18"></a><span id="l1.18">     &quot;space-before-blocks&quot;: 0,</span>
<a href="#l1.19"></a><span id="l1.19">     &quot;computed-property-spacing&quot;: 0,</span>
<a href="#l1.20"></a><span id="l1.20">     &quot;consistent-return&quot;: 0,</span>
<a href="#l1.21"></a><span id="l1.21">     &quot;no-redeclare&quot;: 0,</span>
<a href="#l1.22"></a><span id="l1.22">     &quot;no-empty&quot;: 0,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l2.1"></a><span id="l2.1" class="difflineminus">--- a/calendar/base/backend/icaljs/calICSService-worker.js</span>
<a href="#l2.2"></a><span id="l2.2" class="difflineplus">+++ b/calendar/base/backend/icaljs/calICSService-worker.js</span>
<a href="#l2.3"></a><span id="l2.3" class="difflineat">@@ -15,9 +15,9 @@ importScripts(&quot;resource://calendar/modul</span>
<a href="#l2.4"></a><span id="l2.4"> onmessage = function onmessage(event) {</span>
<a href="#l2.5"></a><span id="l2.5">     try {</span>
<a href="#l2.6"></a><span id="l2.6">         let comp = ICAL.parse(event.data);</span>
<a href="#l2.7"></a><span id="l2.7">         postMessage({ rc: NS_OK, data: comp });</span>
<a href="#l2.8"></a><span id="l2.8">     } catch (e) {</span>
<a href="#l2.9"></a><span id="l2.9">         postMessage({ rc: NS_ERROR_FAILURE, data: &quot;Exception occurred: &quot; + e});</span>
<a href="#l2.10"></a><span id="l2.10">     }</span>
<a href="#l2.11"></a><span id="l2.11">     close();</span>
<a href="#l2.12"></a><span id="l2.12" class="difflineminus">-}</span>
<a href="#l2.13"></a><span id="l2.13" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l3.1"></a><span id="l3.1" class="difflineminus">--- a/calendar/base/backend/icaljs/calICSService.js</span>
<a href="#l3.2"></a><span id="l3.2" class="difflineplus">+++ b/calendar/base/backend/icaljs/calICSService.js</span>
<a href="#l3.3"></a><span id="l3.3" class="difflineat">@@ -28,17 +28,17 @@ calIcalProperty.prototype = {</span>
<a href="#l3.4"></a><span id="l3.4">     set icalProperty(val) { this.innerObject = val; },</span>
<a href="#l3.5"></a><span id="l3.5"> </span>
<a href="#l3.6"></a><span id="l3.6">     get parent() { return this.innerObject.parent; },</span>
<a href="#l3.7"></a><span id="l3.7">     toString: function() { return this.innerObject.toICAL(); },</span>
<a href="#l3.8"></a><span id="l3.8"> </span>
<a href="#l3.9"></a><span id="l3.9">     get value() {</span>
<a href="#l3.10"></a><span id="l3.10">         // Unescaped value for properties of TEXT, escaped otherwise.</span>
<a href="#l3.11"></a><span id="l3.11">         if (this.innerObject.type == &quot;text&quot;) {</span>
<a href="#l3.12"></a><span id="l3.12" class="difflineminus">-            return this.innerObject.getValues().join(&quot;,&quot;)</span>
<a href="#l3.13"></a><span id="l3.13" class="difflineplus">+            return this.innerObject.getValues().join(&quot;,&quot;);</span>
<a href="#l3.14"></a><span id="l3.14">         }</span>
<a href="#l3.15"></a><span id="l3.15">         return this.valueAsIcalString;</span>
<a href="#l3.16"></a><span id="l3.16">     },</span>
<a href="#l3.17"></a><span id="l3.17">     set value(val) {</span>
<a href="#l3.18"></a><span id="l3.18">         // Unescaped value for properties of TEXT, escaped otherwise.</span>
<a href="#l3.19"></a><span id="l3.19">         if (this.innerObject.type == &quot;text&quot;) {</span>
<a href="#l3.20"></a><span id="l3.20">             this.innerObject.setValue(val);</span>
<a href="#l3.21"></a><span id="l3.21">             return val;</span>
<a href="#l3.22"></a><span id="l3.22" class="difflineat">@@ -246,17 +246,17 @@ calIcalComponent.prototype = {</span>
<a href="#l3.23"></a><span id="l3.23">         this.componentIterator = (function* () {</span>
<a href="#l3.24"></a><span id="l3.24">             let comps = innerObject.getAllSubcomponents(kind);</span>
<a href="#l3.25"></a><span id="l3.25">             if (comps) {</span>
<a href="#l3.26"></a><span id="l3.26">                 for (let comp of comps) {</span>
<a href="#l3.27"></a><span id="l3.27">                     yield new calIcalComponent(comp);</span>
<a href="#l3.28"></a><span id="l3.28">                 }</span>
<a href="#l3.29"></a><span id="l3.29">             }</span>
<a href="#l3.30"></a><span id="l3.30">         })();</span>
<a href="#l3.31"></a><span id="l3.31" class="difflineminus">-        return this.getNextSubcomponent(kind)</span>
<a href="#l3.32"></a><span id="l3.32" class="difflineplus">+        return this.getNextSubcomponent(kind);</span>
<a href="#l3.33"></a><span id="l3.33">     },</span>
<a href="#l3.34"></a><span id="l3.34">     getNextSubcomponent: function(kind) {</span>
<a href="#l3.35"></a><span id="l3.35">         if (this.componentIterator) {</span>
<a href="#l3.36"></a><span id="l3.36">             let next = this.componentIterator.next();</span>
<a href="#l3.37"></a><span id="l3.37">             if (next.done) {</span>
<a href="#l3.38"></a><span id="l3.38">                 this.componentIterator = null;</span>
<a href="#l3.39"></a><span id="l3.39">             }</span>
<a href="#l3.40"></a><span id="l3.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l4.1"></a><span id="l4.1" class="difflineminus">--- a/calendar/base/content/agenda-listbox.js</span>
<a href="#l4.2"></a><span id="l4.2" class="difflineplus">+++ b/calendar/base/content/agenda-listbox.js</span>
<a href="#l4.3"></a><span id="l4.3" class="difflineat">@@ -42,17 +42,17 @@ function initAgendaListbox() {</span>
<a href="#l4.4"></a><span id="l4.4">         observe: function aL_observe(aSubject, aTopic, aPrefName) {</span>
<a href="#l4.5"></a><span id="l4.5">             switch (aPrefName) {</span>
<a href="#l4.6"></a><span id="l4.6">                 case &quot;calendar.agendaListbox.soondays&quot;:</span>
<a href="#l4.7"></a><span id="l4.7">                     agendaListbox.soonDays = getSoondaysPreference();</span>
<a href="#l4.8"></a><span id="l4.8">                     agendaListbox.updateSoonSection();</span>
<a href="#l4.9"></a><span id="l4.9">                     break;</span>
<a href="#l4.10"></a><span id="l4.10">             }</span>
<a href="#l4.11"></a><span id="l4.11">         }</span>
<a href="#l4.12"></a><span id="l4.12" class="difflineminus">-    }</span>
<a href="#l4.13"></a><span id="l4.13" class="difflineplus">+    };</span>
<a href="#l4.14"></a><span id="l4.14">     Services.prefs.addObserver(&quot;calendar.agendaListbox&quot;, prefObserver, false);</span>
<a href="#l4.15"></a><span id="l4.15"> </span>
<a href="#l4.16"></a><span id="l4.16">     // Make sure the agenda listbox is unloaded</span>
<a href="#l4.17"></a><span id="l4.17">     var self = this;</span>
<a href="#l4.18"></a><span id="l4.18">     window.addEventListener(&quot;unload&quot;,</span>
<a href="#l4.19"></a><span id="l4.19">                             function unload_agendaListbox() {</span>
<a href="#l4.20"></a><span id="l4.20">                                 Services.prefs.removeObserver(&quot;calendar.agendaListbox&quot;, prefObserver);</span>
<a href="#l4.21"></a><span id="l4.21">                                 self.uninit();</span>
<a href="#l4.22"></a><span id="l4.22" class="difflineat">@@ -90,32 +90,32 @@ function uninit() {</span>
<a href="#l4.23"></a><span id="l4.23">  */</span>
<a href="#l4.24"></a><span id="l4.24"> agendaListbox.addPeriodListItem =</span>
<a href="#l4.25"></a><span id="l4.25"> function addPeriodListItem(aPeriod, aItemId) {</span>
<a href="#l4.26"></a><span id="l4.26">     aPeriod.listItem = document.getElementById(aItemId + &quot;-hidden&quot;).cloneNode(true);</span>
<a href="#l4.27"></a><span id="l4.27">     agendaListbox.agendaListboxControl.appendChild(aPeriod.listItem);</span>
<a href="#l4.28"></a><span id="l4.28">     aPeriod.listItem.id = aItemId;</span>
<a href="#l4.29"></a><span id="l4.29">     aPeriod.listItem.getCheckbox().setChecked(aPeriod.open);</span>
<a href="#l4.30"></a><span id="l4.30">     aPeriod.listItem.getCheckbox().addEventListener(&quot;CheckboxStateChange&quot;, this.onCheckboxChange, true);</span>
<a href="#l4.31"></a><span id="l4.31" class="difflineminus">-}</span>
<a href="#l4.32"></a><span id="l4.32" class="difflineplus">+};</span>
<a href="#l4.33"></a><span id="l4.33"> </span>
<a href="#l4.34"></a><span id="l4.34"> /**</span>
<a href="#l4.35"></a><span id="l4.35">  * Remove a period item from the agenda listbox.</span>
<a href="#l4.36"></a><span id="l4.36">  * @see agendaListbox::addPeriodListItem</span>
<a href="#l4.37"></a><span id="l4.37">  */</span>
<a href="#l4.38"></a><span id="l4.38"> agendaListbox.removePeriodListItem =</span>
<a href="#l4.39"></a><span id="l4.39"> function removePeriodListItem(aPeriod) {</span>
<a href="#l4.40"></a><span id="l4.40">     if (aPeriod.listItem) {</span>
<a href="#l4.41"></a><span id="l4.41">         aPeriod.listItem.getCheckbox().removeEventListener(&quot;CheckboxStateChange&quot;, this.onCheckboxChange, true);</span>
<a href="#l4.42"></a><span id="l4.42">         if (aPeriod.listItem) {</span>
<a href="#l4.43"></a><span id="l4.43">             aPeriod.listItem.remove();</span>
<a href="#l4.44"></a><span id="l4.44">             aPeriod.listItem = null;</span>
<a href="#l4.45"></a><span id="l4.45">         }</span>
<a href="#l4.46"></a><span id="l4.46">     }</span>
<a href="#l4.47"></a><span id="l4.47" class="difflineminus">-}</span>
<a href="#l4.48"></a><span id="l4.48" class="difflineplus">+};</span>
<a href="#l4.49"></a><span id="l4.49"> </span>
<a href="#l4.50"></a><span id="l4.50"> /**</span>
<a href="#l4.51"></a><span id="l4.51">  * Handler function called when changing the checkbox state on period items.</span>
<a href="#l4.52"></a><span id="l4.52">  *</span>
<a href="#l4.53"></a><span id="l4.53">  * @param event     The DOM event that triggered the checkbox state change.</span>
<a href="#l4.54"></a><span id="l4.54">  */</span>
<a href="#l4.55"></a><span id="l4.55"> agendaListbox.onCheckboxChange =</span>
<a href="#l4.56"></a><span id="l4.56"> function onCheckboxChange(event) {</span>
<a href="#l4.57"></a><span id="l4.57" class="difflineat">@@ -156,34 +156,34 @@ function onCheckboxChange(event) {</span>
<a href="#l4.58"></a><span id="l4.58"> agendaListbox.onSelect =</span>
<a href="#l4.59"></a><span id="l4.59"> function onSelect(aListItem) {</span>
<a href="#l4.60"></a><span id="l4.60">     let listbox = document.getElementById(&quot;agenda-listbox&quot;);</span>
<a href="#l4.61"></a><span id="l4.61">     let item = aListItem || listbox.selectedItem;</span>
<a href="#l4.62"></a><span id="l4.62">     if (aListItem) {</span>
<a href="#l4.63"></a><span id="l4.63">         listbox.selectedItem = item;</span>
<a href="#l4.64"></a><span id="l4.64">     }</span>
<a href="#l4.65"></a><span id="l4.65">     calendarController.onSelectionChanged({detail: agendaListbox.getSelectedItems()});</span>
<a href="#l4.66"></a><span id="l4.66" class="difflineminus">-}</span>
<a href="#l4.67"></a><span id="l4.67" class="difflineplus">+};</span>
<a href="#l4.68"></a><span id="l4.68"> </span>
<a href="#l4.69"></a><span id="l4.69"> /**</span>
<a href="#l4.70"></a><span id="l4.70">  * Handler function called when the agenda listbox becomes focused</span>
<a href="#l4.71"></a><span id="l4.71">  */</span>
<a href="#l4.72"></a><span id="l4.72"> agendaListbox.onFocus =</span>
<a href="#l4.73"></a><span id="l4.73"> function onFocus() {</span>
<a href="#l4.74"></a><span id="l4.74">     let listbox = document.getElementById(&quot;agenda-listbox&quot;);</span>
<a href="#l4.75"></a><span id="l4.75">     calendarController.onSelectionChanged({detail: agendaListbox.getSelectedItems()});</span>
<a href="#l4.76"></a><span id="l4.76" class="difflineminus">-}</span>
<a href="#l4.77"></a><span id="l4.77" class="difflineplus">+};</span>
<a href="#l4.78"></a><span id="l4.78"> </span>
<a href="#l4.79"></a><span id="l4.79"> /**</span>
<a href="#l4.80"></a><span id="l4.80">  * Handler function called when the agenda listbox loses focus.</span>
<a href="#l4.81"></a><span id="l4.81">  */</span>
<a href="#l4.82"></a><span id="l4.82"> agendaListbox.onBlur =</span>
<a href="#l4.83"></a><span id="l4.83"> function onBlur() {</span>
<a href="#l4.84"></a><span id="l4.84">     calendarController.onSelectionChanged({detail: []});</span>
<a href="#l4.85"></a><span id="l4.85" class="difflineminus">-}</span>
<a href="#l4.86"></a><span id="l4.86" class="difflineplus">+};</span>
<a href="#l4.87"></a><span id="l4.87"> </span>
<a href="#l4.88"></a><span id="l4.88"> </span>
<a href="#l4.89"></a><span id="l4.89"> /**</span>
<a href="#l4.90"></a><span id="l4.90">  * Handler function called when a key was pressed on the agenda listbox</span>
<a href="#l4.91"></a><span id="l4.91">  */</span>
<a href="#l4.92"></a><span id="l4.92"> agendaListbox.onKeyPress =</span>
<a href="#l4.93"></a><span id="l4.93"> function onKeyPress(aEvent) {</span>
<a href="#l4.94"></a><span id="l4.94">     var listItem = aEvent.target;</span>
<a href="#l4.95"></a><span id="l4.95" class="difflineat">@@ -205,28 +205,28 @@ function onKeyPress(aEvent) {</span>
<a href="#l4.96"></a><span id="l4.96">             }</span>
<a href="#l4.97"></a><span id="l4.97">             break;</span>
<a href="#l4.98"></a><span id="l4.98">         case aEvent.DOM_VK_RIGHT:</span>
<a href="#l4.99"></a><span id="l4.99">             if (!this.isEventListItem(listItem)) {</span>
<a href="#l4.100"></a><span id="l4.100">                 listItem.getCheckbox().setChecked(true);</span>
<a href="#l4.101"></a><span id="l4.101">             }</span>
<a href="#l4.102"></a><span id="l4.102">             break;</span>
<a href="#l4.103"></a><span id="l4.103">     }</span>
<a href="#l4.104"></a><span id="l4.104" class="difflineminus">-}</span>
<a href="#l4.105"></a><span id="l4.105" class="difflineplus">+};</span>
<a href="#l4.106"></a><span id="l4.106"> </span>
<a href="#l4.107"></a><span id="l4.107"> /**</span>
<a href="#l4.108"></a><span id="l4.108">  * Calls the event dialog to edit the currently selected item</span>
<a href="#l4.109"></a><span id="l4.109">  */</span>
<a href="#l4.110"></a><span id="l4.110"> agendaListbox.editSelectedItem =</span>
<a href="#l4.111"></a><span id="l4.111"> function editSelectedItem() {</span>
<a href="#l4.112"></a><span id="l4.112">     var listItem = document.getElementById(&quot;agenda-listbox&quot;).selectedItem;</span>
<a href="#l4.113"></a><span id="l4.113">     if (listItem) {</span>
<a href="#l4.114"></a><span id="l4.114">         modifyEventWithDialog(listItem.occurrence, null, true);</span>
<a href="#l4.115"></a><span id="l4.115">     }</span>
<a href="#l4.116"></a><span id="l4.116" class="difflineminus">-}</span>
<a href="#l4.117"></a><span id="l4.117" class="difflineplus">+};</span>
<a href="#l4.118"></a><span id="l4.118"> </span>
<a href="#l4.119"></a><span id="l4.119"> /**</span>
<a href="#l4.120"></a><span id="l4.120">  * Finds the appropriate period for the given item, i.e finds &quot;Tomorrow&quot; if the</span>
<a href="#l4.121"></a><span id="l4.121">  * item occurrs tomorrow.</span>
<a href="#l4.122"></a><span id="l4.122">  *</span>
<a href="#l4.123"></a><span id="l4.123">  * @param aItem     The item to find the period for.</span>
<a href="#l4.124"></a><span id="l4.124">  */</span>
<a href="#l4.125"></a><span id="l4.125"> agendaListbox.findPeriodsForItem =</span>
<a href="#l4.126"></a><span id="l4.126" class="difflineat">@@ -250,62 +250,62 @@ function getStart(){</span>
<a href="#l4.127"></a><span id="l4.127">     var retStart = null;</span>
<a href="#l4.128"></a><span id="l4.128">     for (var i = 0; i &lt; this.periods.length; i++) {</span>
<a href="#l4.129"></a><span id="l4.129">         if (this.periods[i].open) {</span>
<a href="#l4.130"></a><span id="l4.130">             retStart = this.periods[i].start;</span>
<a href="#l4.131"></a><span id="l4.131">             break;</span>
<a href="#l4.132"></a><span id="l4.132">         }</span>
<a href="#l4.133"></a><span id="l4.133">     }</span>
<a href="#l4.134"></a><span id="l4.134">     return retStart;</span>
<a href="#l4.135"></a><span id="l4.135" class="difflineminus">-}</span>
<a href="#l4.136"></a><span id="l4.136" class="difflineplus">+};</span>
<a href="#l4.137"></a><span id="l4.137"> </span>
<a href="#l4.138"></a><span id="l4.138"> /**</span>
<a href="#l4.139"></a><span id="l4.139">  * Gets the end of the latest period shown in the agenda listbox</span>
<a href="#l4.140"></a><span id="l4.140">  */</span>
<a href="#l4.141"></a><span id="l4.141"> agendaListbox.getEnd =</span>
<a href="#l4.142"></a><span id="l4.142"> function getEnd(){</span>
<a href="#l4.143"></a><span id="l4.143">     var retEnd = null;</span>
<a href="#l4.144"></a><span id="l4.144">     for (var i = this.periods.length - 1; i &gt;= 0; i--) {</span>
<a href="#l4.145"></a><span id="l4.145">         if (this.periods[i].open) {</span>
<a href="#l4.146"></a><span id="l4.146">             retEnd = this.periods[i].end;</span>
<a href="#l4.147"></a><span id="l4.147">             break;</span>
<a href="#l4.148"></a><span id="l4.148">         }</span>
<a href="#l4.149"></a><span id="l4.149">     }</span>
<a href="#l4.150"></a><span id="l4.150">     return retEnd;</span>
<a href="#l4.151"></a><span id="l4.151" class="difflineminus">-}</span>
<a href="#l4.152"></a><span id="l4.152" class="difflineplus">+};</span>
<a href="#l4.153"></a><span id="l4.153"> </span>
<a href="#l4.154"></a><span id="l4.154"> /**</span>
<a href="#l4.155"></a><span id="l4.155">  * Adds an item to an agenda period before another existing item.</span>
<a href="#l4.156"></a><span id="l4.156">  *</span>
<a href="#l4.157"></a><span id="l4.157">  * @param aNewItem      The calIItemBase to add.</span>
<a href="#l4.158"></a><span id="l4.158">  * @param aAgendaItem   The existing item to insert before.</span>
<a href="#l4.159"></a><span id="l4.159">  * @param aPeriod       The period to add the item to.</span>
<a href="#l4.160"></a><span id="l4.160">  * @param visible       If true, the item should be visible.</span>
<a href="#l4.161"></a><span id="l4.161">  * @return              The newly created XUL element.</span>
<a href="#l4.162"></a><span id="l4.162">  */</span>
<a href="#l4.163"></a><span id="l4.163"> agendaListbox.addItemBefore =</span>
<a href="#l4.164"></a><span id="l4.164"> function addItemBefore(aNewItem, aAgendaItem, aPeriod, visible) {</span>
<a href="#l4.165"></a><span id="l4.165">     var newelement = null;</span>
<a href="#l4.166"></a><span id="l4.166">     if (aNewItem.startDate.isDate) {</span>
<a href="#l4.167"></a><span id="l4.167">         newelement = createXULElement(&quot;agenda-allday-richlist-item&quot;);</span>
<a href="#l4.168"></a><span id="l4.168">     } else {</span>
<a href="#l4.169"></a><span id="l4.169" class="difflineminus">-        newelement = createXULElement(&quot;agenda-richlist-item&quot;)</span>
<a href="#l4.170"></a><span id="l4.170" class="difflineplus">+        newelement = createXULElement(&quot;agenda-richlist-item&quot;);</span>
<a href="#l4.171"></a><span id="l4.171">     }</span>
<a href="#l4.172"></a><span id="l4.172">     // set the item at the richlistItem. When the duration of the period</span>
<a href="#l4.173"></a><span id="l4.173">     // is bigger than 1 (day) the starttime of the item has to include</span>
<a href="#l4.174"></a><span id="l4.174">     // information about the day of the item</span>
<a href="#l4.175"></a><span id="l4.175">     if (aAgendaItem == null) {</span>
<a href="#l4.176"></a><span id="l4.176">         this.agendaListboxControl.appendChild(newelement);</span>
<a href="#l4.177"></a><span id="l4.177">     } else {</span>
<a href="#l4.178"></a><span id="l4.178">         this.agendaListboxControl.insertBefore(newelement, aAgendaItem);</span>
<a href="#l4.179"></a><span id="l4.179">     }</span>
<a href="#l4.180"></a><span id="l4.180">     newelement.setOccurrence(aNewItem, aPeriod);</span>
<a href="#l4.181"></a><span id="l4.181">     newelement.removeAttribute(&quot;selected&quot;);</span>
<a href="#l4.182"></a><span id="l4.182">     return newelement;</span>
<a href="#l4.183"></a><span id="l4.183" class="difflineminus">-}</span>
<a href="#l4.184"></a><span id="l4.184" class="difflineplus">+};</span>
<a href="#l4.185"></a><span id="l4.185"> </span>
<a href="#l4.186"></a><span id="l4.186"> /**</span>
<a href="#l4.187"></a><span id="l4.187">  * Adds an item to the agenda listbox. This function finds the correct period</span>
<a href="#l4.188"></a><span id="l4.188">  * for the item and inserts it correctly so the period stays sorted.</span>
<a href="#l4.189"></a><span id="l4.189">  *</span>
<a href="#l4.190"></a><span id="l4.190">  * @param aItem         The calIItemBase to add.</span>
<a href="#l4.191"></a><span id="l4.191">  * @return              The newly created XUL element.</span>
<a href="#l4.192"></a><span id="l4.192">  */</span>
<a href="#l4.193"></a><span id="l4.193" class="difflineat">@@ -338,24 +338,24 @@ function addItem(aItem) {</span>
<a href="#l4.194"></a><span id="l4.194">                     if (this.isSameEvent(aItem, compitem)) {</span>
<a href="#l4.195"></a><span id="l4.195">                         // The same event occurs on several calendars but we only</span>
<a href="#l4.196"></a><span id="l4.196">                         // display the first one.</span>
<a href="#l4.197"></a><span id="l4.197">                         // TODO: find a way to display this special circumstance</span>
<a href="#l4.198"></a><span id="l4.198">                         break;</span>
<a href="#l4.199"></a><span id="l4.199">                     } else if (this.isBefore(aItem, compitem, period)) {</span>
<a href="#l4.200"></a><span id="l4.200">                         if (this.isSameEvent(aItem, compitem)) {</span>
<a href="#l4.201"></a><span id="l4.201">                             newlistItem = this.addItemBefore(aItem, complistItem, period, visible);</span>
<a href="#l4.202"></a><span id="l4.202" class="difflineminus">-                            break</span>
<a href="#l4.203"></a><span id="l4.203" class="difflineplus">+                            break;</span>
<a href="#l4.204"></a><span id="l4.204">                         } else {</span>
<a href="#l4.205"></a><span id="l4.205">                             newlistItem = this.addItemBefore(aItem, complistItem, period, visible);</span>
<a href="#l4.206"></a><span id="l4.206">                             break;</span>
<a href="#l4.207"></a><span id="l4.207">                         }</span>
<a href="#l4.208"></a><span id="l4.208">                     }</span>
<a href="#l4.209"></a><span id="l4.209">                 }</span>
<a href="#l4.210"></a><span id="l4.210" class="difflineminus">-            } while (complistItem)</span>
<a href="#l4.211"></a><span id="l4.211" class="difflineplus">+            } while (complistItem);</span>
<a href="#l4.212"></a><span id="l4.212">         }</span>
<a href="#l4.213"></a><span id="l4.213">     }</span>
<a href="#l4.214"></a><span id="l4.214">     return newlistItem;</span>
<a href="#l4.215"></a><span id="l4.215"> };</span>
<a href="#l4.216"></a><span id="l4.216"> </span>
<a href="#l4.217"></a><span id="l4.217"> /**</span>
<a href="#l4.218"></a><span id="l4.218">  * Checks if the given item happens before the comparison item.</span>
<a href="#l4.219"></a><span id="l4.219">  *</span>
<a href="#l4.220"></a><span id="l4.220" class="difflineat">@@ -402,17 +402,17 @@ function isBefore(aItem, aCompItem, aPer</span>
<a href="#l4.221"></a><span id="l4.221">     let comp = itemDate.compare(compItemDate);</span>
<a href="#l4.222"></a><span id="l4.222">     if (comp == 0) {</span>
<a href="#l4.223"></a><span id="l4.223">         comp = aItem.startDate.compare(aCompItem.startDate);</span>
<a href="#l4.224"></a><span id="l4.224">         if (comp == 0) {</span>
<a href="#l4.225"></a><span id="l4.225">             comp = aItem.endDate.compare(aCompItem.endDate);</span>
<a href="#l4.226"></a><span id="l4.226">         }</span>
<a href="#l4.227"></a><span id="l4.227">     }</span>
<a href="#l4.228"></a><span id="l4.228">     return (comp &lt;= 0);</span>
<a href="#l4.229"></a><span id="l4.229" class="difflineminus">-}</span>
<a href="#l4.230"></a><span id="l4.230" class="difflineplus">+};</span>
<a href="#l4.231"></a><span id="l4.231"> </span>
<a href="#l4.232"></a><span id="l4.232"> /**</span>
<a href="#l4.233"></a><span id="l4.233">  * Returns the start or end date of an item according to which of them</span>
<a href="#l4.234"></a><span id="l4.234">  * must be displayed in a given period of the agenda</span>
<a href="#l4.235"></a><span id="l4.235">  *</span>
<a href="#l4.236"></a><span id="l4.236">  * @param aItem         The item to compare.</span>
<a href="#l4.237"></a><span id="l4.237">  * @param aPeriod       The period where the item is inserted.</span>
<a href="#l4.238"></a><span id="l4.238">  * @return              The start or end date of the item showed in the agenda.</span>
<a href="#l4.239"></a><span id="l4.239" class="difflineat">@@ -442,17 +442,17 @@ function comparisonDate(aItem, aPeriod) </span>
<a href="#l4.240"></a><span id="l4.240">     endDate.isDate = true;</span>
<a href="#l4.241"></a><span id="l4.241">     if (startDate.compare(endDate) != 0 &amp;&amp;</span>
<a href="#l4.242"></a><span id="l4.242">          startDate.compare(periodStartDate) &lt; 0) {</span>
<a href="#l4.243"></a><span id="l4.243">         // returns a end date when the item is a multiday event AND</span>
<a href="#l4.244"></a><span id="l4.244">         // it starts before the given period</span>
<a href="#l4.245"></a><span id="l4.245">         return endDateToReturn;</span>
<a href="#l4.246"></a><span id="l4.246">     }</span>
<a href="#l4.247"></a><span id="l4.247">     return aItem.startDate.clone();</span>
<a href="#l4.248"></a><span id="l4.248" class="difflineminus">-}</span>
<a href="#l4.249"></a><span id="l4.249" class="difflineplus">+};</span>
<a href="#l4.250"></a><span id="l4.250"> </span>
<a href="#l4.251"></a><span id="l4.251"> /**</span>
<a href="#l4.252"></a><span id="l4.252">  * Gets the listitems for a given item, possibly in a given period.</span>
<a href="#l4.253"></a><span id="l4.253">  *</span>
<a href="#l4.254"></a><span id="l4.254">  * @param aItem         The item to get the list items for.</span>
<a href="#l4.255"></a><span id="l4.255">  * @param aPeriod       (optional) the period to search in.</span>
<a href="#l4.256"></a><span id="l4.256">  * @return              An array of list items for the given item.</span>
<a href="#l4.257"></a><span id="l4.257">  */</span>
<a href="#l4.258"></a><span id="l4.258" class="difflineat">@@ -472,21 +472,21 @@ function getListItems(aItem, aPeriod) {</span>
<a href="#l4.259"></a><span id="l4.259">                 complistItem = complistItem.nextSibling;</span>
<a href="#l4.260"></a><span id="l4.260">                 leaveloop = (!this.isEventListItem(complistItem));</span>
<a href="#l4.261"></a><span id="l4.261">                 if (!leaveloop) {</span>
<a href="#l4.262"></a><span id="l4.262">                     if (this.isSameEvent(aItem, complistItem.occurrence)){</span>
<a href="#l4.263"></a><span id="l4.263">                         retlistItems.push(complistItem);</span>
<a href="#l4.264"></a><span id="l4.264">                         break;</span>
<a href="#l4.265"></a><span id="l4.265">                     }</span>
<a href="#l4.266"></a><span id="l4.266">                 }</span>
<a href="#l4.267"></a><span id="l4.267" class="difflineminus">-            } while (!leaveloop)</span>
<a href="#l4.268"></a><span id="l4.268" class="difflineplus">+            } while (!leaveloop);</span>
<a href="#l4.269"></a><span id="l4.269">         }</span>
<a href="#l4.270"></a><span id="l4.270">     }</span>
<a href="#l4.271"></a><span id="l4.271">     return retlistItems;</span>
<a href="#l4.272"></a><span id="l4.272" class="difflineminus">-}</span>
<a href="#l4.273"></a><span id="l4.273" class="difflineplus">+};</span>
<a href="#l4.274"></a><span id="l4.274"> </span>
<a href="#l4.275"></a><span id="l4.275"> /**</span>
<a href="#l4.276"></a><span id="l4.276">  * Removes the given item from the agenda listbox</span>
<a href="#l4.277"></a><span id="l4.277">  *</span>
<a href="#l4.278"></a><span id="l4.278">  * @param aItem             The item to remove.</span>
<a href="#l4.279"></a><span id="l4.279">  * @param aMoveSelection    If true, the selection will be moved to the next</span>
<a href="#l4.280"></a><span id="l4.280">  *                            sibling that is not an period item.</span>
<a href="#l4.281"></a><span id="l4.281">  * @return                  Returns true if the removed item was selected.</span>
<a href="#l4.282"></a><span id="l4.282" class="difflineat">@@ -504,79 +504,79 @@ function deleteItem(aItem, aMoveSelectio</span>
<a href="#l4.283"></a><span id="l4.283">                 if (aMoveSelection) {</span>
<a href="#l4.284"></a><span id="l4.284">                     this.moveSelection();</span>
<a href="#l4.285"></a><span id="l4.285">                 }</span>
<a href="#l4.286"></a><span id="l4.286">             }</span>
<a href="#l4.287"></a><span id="l4.287">             listItem.remove();</span>
<a href="#l4.288"></a><span id="l4.288">         }</span>
<a href="#l4.289"></a><span id="l4.289">     }</span>
<a href="#l4.290"></a><span id="l4.290">     return isSelected;</span>
<a href="#l4.291"></a><span id="l4.291" class="difflineminus">-}</span>
<a href="#l4.292"></a><span id="l4.292" class="difflineplus">+};</span>
<a href="#l4.293"></a><span id="l4.293"> </span>
<a href="#l4.294"></a><span id="l4.294"> /**</span>
<a href="#l4.295"></a><span id="l4.295">  * Remove all items belonging to the specified calendar.</span>
<a href="#l4.296"></a><span id="l4.296">  *</span>
<a href="#l4.297"></a><span id="l4.297">  * @param aCalendar         The item to compare.</span>
<a href="#l4.298"></a><span id="l4.298">  */</span>
<a href="#l4.299"></a><span id="l4.299"> agendaListbox.deleteItemsFromCalendar =</span>
<a href="#l4.300"></a><span id="l4.300"> function deleteItemsFromCalendar(aCalendar) {</span>
<a href="#l4.301"></a><span id="l4.301">     let childNodes = Array.from(this.agendaListboxControl.childNodes);</span>
<a href="#l4.302"></a><span id="l4.302">     for (let childNode of childNodes) {</span>
<a href="#l4.303"></a><span id="l4.303">         if (childNode &amp;&amp; childNode.occurrence</span>
<a href="#l4.304"></a><span id="l4.304">             &amp;&amp; childNode.occurrence.calendar.id == aCalendar.id) {</span>
<a href="#l4.305"></a><span id="l4.305">             childNode.remove();</span>
<a href="#l4.306"></a><span id="l4.306">         }</span>
<a href="#l4.307"></a><span id="l4.307">     }</span>
<a href="#l4.308"></a><span id="l4.308" class="difflineminus">-}</span>
<a href="#l4.309"></a><span id="l4.309" class="difflineplus">+};</span>
<a href="#l4.310"></a><span id="l4.310"> </span>
<a href="#l4.311"></a><span id="l4.311"> /**</span>
<a href="#l4.312"></a><span id="l4.312">  * Compares two items to see if they have the same id and their start date</span>
<a href="#l4.313"></a><span id="l4.313">  * matches</span>
<a href="#l4.314"></a><span id="l4.314">  *</span>
<a href="#l4.315"></a><span id="l4.315">  * @param aItem         The item to compare.</span>
<a href="#l4.316"></a><span id="l4.316">  * @param aCompItem     The item to compare with.</span>
<a href="#l4.317"></a><span id="l4.317">  * @return              True, if the items match with the above noted criteria.</span>
<a href="#l4.318"></a><span id="l4.318">  */</span>
<a href="#l4.319"></a><span id="l4.319"> agendaListbox.isSameEvent =</span>
<a href="#l4.320"></a><span id="l4.320"> function isSameEvent(aItem, aCompItem) {</span>
<a href="#l4.321"></a><span id="l4.321">     return ((aItem.id == aCompItem.id) &amp;&amp;</span>
<a href="#l4.322"></a><span id="l4.322">             (aItem[calGetStartDateProp(aItem)].compare(aCompItem[calGetStartDateProp(aCompItem)]) == 0));</span>
<a href="#l4.323"></a><span id="l4.323" class="difflineminus">-}</span>
<a href="#l4.324"></a><span id="l4.324" class="difflineplus">+};</span>
<a href="#l4.325"></a><span id="l4.325"> </span>
<a href="#l4.326"></a><span id="l4.326"> /**</span>
<a href="#l4.327"></a><span id="l4.327">  * Checks if the currently selected node in the listbox is an Event item (not a</span>
<a href="#l4.328"></a><span id="l4.328">  * period item).</span>
<a href="#l4.329"></a><span id="l4.329">  *</span>
<a href="#l4.330"></a><span id="l4.330">  * @return              True, if the node is not a period item.</span>
<a href="#l4.331"></a><span id="l4.331">  */</span>
<a href="#l4.332"></a><span id="l4.332"> agendaListbox.isEventSelected =</span>
<a href="#l4.333"></a><span id="l4.333"> function isEventSelected() {</span>
<a href="#l4.334"></a><span id="l4.334">     var listItem = this.agendaListboxControl.selectedItem;</span>
<a href="#l4.335"></a><span id="l4.335">     if (listItem) {</span>
<a href="#l4.336"></a><span id="l4.336">         return (this.isEventListItem(listItem));</span>
<a href="#l4.337"></a><span id="l4.337">     }</span>
<a href="#l4.338"></a><span id="l4.338">     return false;</span>
<a href="#l4.339"></a><span id="l4.339" class="difflineminus">-}</span>
<a href="#l4.340"></a><span id="l4.340" class="difflineplus">+};</span>
<a href="#l4.341"></a><span id="l4.341"> </span>
<a href="#l4.342"></a><span id="l4.342"> /**</span>
<a href="#l4.343"></a><span id="l4.343">  * Delete the selected item from its calendar (if it is an event item)</span>
<a href="#l4.344"></a><span id="l4.344">  *</span>
<a href="#l4.345"></a><span id="l4.345">  * @param aDoNotConfirm     If true, the user will not be prompted.</span>
<a href="#l4.346"></a><span id="l4.346">  */</span>
<a href="#l4.347"></a><span id="l4.347"> agendaListbox.deleteSelectedItem =</span>
<a href="#l4.348"></a><span id="l4.348"> function deleteSelectedItem(aDoNotConfirm) {</span>
<a href="#l4.349"></a><span id="l4.349">     var listItem = this.agendaListboxControl.selectedItem;</span>
<a href="#l4.350"></a><span id="l4.350">     if (this.isEventListItem(listItem)) {</span>
<a href="#l4.351"></a><span id="l4.351">         var selectedItems = [listItem.occurrence];</span>
<a href="#l4.352"></a><span id="l4.352">         calendarViewController.deleteOccurrences(selectedItems.length,</span>
<a href="#l4.353"></a><span id="l4.353">                                                  selectedItems,</span>
<a href="#l4.354"></a><span id="l4.354">                                                  false,</span>
<a href="#l4.355"></a><span id="l4.355">                                                  aDoNotConfirm);</span>
<a href="#l4.356"></a><span id="l4.356">     }</span>
<a href="#l4.357"></a><span id="l4.357" class="difflineminus">-}</span>
<a href="#l4.358"></a><span id="l4.358" class="difflineplus">+};</span>
<a href="#l4.359"></a><span id="l4.359"> </span>
<a href="#l4.360"></a><span id="l4.360"> /**</span>
<a href="#l4.361"></a><span id="l4.361">  * If a Period item is targeted by the passed DOM event, opens the event dialog</span>
<a href="#l4.362"></a><span id="l4.362">  * with the period's start date prefilled.</span>
<a href="#l4.363"></a><span id="l4.363">  *</span>
<a href="#l4.364"></a><span id="l4.364">  * @param aEvent            The DOM event that targets the period.</span>
<a href="#l4.365"></a><span id="l4.365">  */</span>
<a href="#l4.366"></a><span id="l4.366"> agendaListbox.createNewEvent =</span>
<a href="#l4.367"></a><span id="l4.367" class="difflineat">@@ -585,17 +585,17 @@ function createNewEvent(aEvent) {</span>
<a href="#l4.368"></a><span id="l4.368">         // Create new event for the date currently displayed in the agenda. Setting</span>
<a href="#l4.369"></a><span id="l4.369">         // isDate = true automatically makes the start time be the next full hour.</span>
<a href="#l4.370"></a><span id="l4.370">         var eventStart = agendaListbox.today.start.clone();</span>
<a href="#l4.371"></a><span id="l4.371">         eventStart.isDate = true;</span>
<a href="#l4.372"></a><span id="l4.372">         if (calendarController.isCommandEnabled(&quot;calendar_new_event_command&quot;)) {</span>
<a href="#l4.373"></a><span id="l4.373">             createEventWithDialog(getSelectedCalendar(), eventStart);</span>
<a href="#l4.374"></a><span id="l4.374">         }</span>
<a href="#l4.375"></a><span id="l4.375">     }</span>
<a href="#l4.376"></a><span id="l4.376" class="difflineminus">-}</span>
<a href="#l4.377"></a><span id="l4.377" class="difflineplus">+};</span>
<a href="#l4.378"></a><span id="l4.378"> </span>
<a href="#l4.379"></a><span id="l4.379"> /**</span>
<a href="#l4.380"></a><span id="l4.380">  * Sets up the context menu for the agenda listbox</span>
<a href="#l4.381"></a><span id="l4.381">  *</span>
<a href="#l4.382"></a><span id="l4.382">  * @param popup         The &lt;menupopup&gt; element to set up.</span>
<a href="#l4.383"></a><span id="l4.383">  */</span>
<a href="#l4.384"></a><span id="l4.384"> agendaListbox.setupContextMenu =</span>
<a href="#l4.385"></a><span id="l4.385"> function setupContextMenu(popup) {</span>
<a href="#l4.386"></a><span id="l4.386" class="difflineat">@@ -603,17 +603,17 @@ function setupContextMenu(popup) {</span>
<a href="#l4.387"></a><span id="l4.387">     let enabled = this.isEventListItem(listItem);</span>
<a href="#l4.388"></a><span id="l4.388">     let menuitems = popup.childNodes;</span>
<a href="#l4.389"></a><span id="l4.389">     for (let i = 0; i &lt; menuitems.length; i++) {</span>
<a href="#l4.390"></a><span id="l4.390">         setBooleanAttribute(menuitems[i], &quot;disabled&quot;, !enabled);</span>
<a href="#l4.391"></a><span id="l4.391">     }</span>
<a href="#l4.392"></a><span id="l4.392"> </span>
<a href="#l4.393"></a><span id="l4.393">     let menu = document.getElementById(&quot;calendar-today-pane-menu-attendance-menu&quot;);</span>
<a href="#l4.394"></a><span id="l4.394">     setupAttendanceMenu(menu, agendaListbox.getSelectedItems({}));</span>
<a href="#l4.395"></a><span id="l4.395" class="difflineminus">-}</span>
<a href="#l4.396"></a><span id="l4.396" class="difflineplus">+};</span>
<a href="#l4.397"></a><span id="l4.397"> </span>
<a href="#l4.398"></a><span id="l4.398"> </span>
<a href="#l4.399"></a><span id="l4.399"> /**</span>
<a href="#l4.400"></a><span id="l4.400">  * Refreshes the agenda listbox. If aStart or aEnd is not passed, the agenda</span>
<a href="#l4.401"></a><span id="l4.401">  * listbox's limiting dates will be used.</span>
<a href="#l4.402"></a><span id="l4.402">  *</span>
<a href="#l4.403"></a><span id="l4.403">  * @param aStart        (optional) The start date for the item query.</span>
<a href="#l4.404"></a><span id="l4.404">  * @param aEnd          (optional) The end date for the item query.</span>
<a href="#l4.405"></a><span id="l4.405" class="difflineat">@@ -767,17 +767,17 @@ function refreshPeriodDates(newDate) {</span>
<a href="#l4.406"></a><span id="l4.406"> /**</span>
<a href="#l4.407"></a><span id="l4.407">  * Adds a listener to this agenda listbox.</span>
<a href="#l4.408"></a><span id="l4.408">  *</span>
<a href="#l4.409"></a><span id="l4.409">  * @param aListener     The listener to add.</span>
<a href="#l4.410"></a><span id="l4.410">  */</span>
<a href="#l4.411"></a><span id="l4.411"> agendaListbox.addListener =</span>
<a href="#l4.412"></a><span id="l4.412"> function addListener(aListener) {</span>
<a href="#l4.413"></a><span id="l4.413">     this.mListener = aListener;</span>
<a href="#l4.414"></a><span id="l4.414" class="difflineminus">-}</span>
<a href="#l4.415"></a><span id="l4.415" class="difflineplus">+};</span>
<a href="#l4.416"></a><span id="l4.416"> </span>
<a href="#l4.417"></a><span id="l4.417"> /**</span>
<a href="#l4.418"></a><span id="l4.418">  * Checks if the agenda listbox is showing &quot;today&quot;. Without arguments, this</span>
<a href="#l4.419"></a><span id="l4.419">  * function assumes the today attribute of the agenda listbox.</span>
<a href="#l4.420"></a><span id="l4.420">  *</span>
<a href="#l4.421"></a><span id="l4.421">  * @param aStartDate    (optional) The day to check if its &quot;today&quot;.</span>
<a href="#l4.422"></a><span id="l4.422">  * @return              Returns true if today is shown.</span>
<a href="#l4.423"></a><span id="l4.423">  */</span>
<a href="#l4.424"></a><span id="l4.424" class="difflineat">@@ -803,17 +803,17 @@ function showsToday(aStartDate) {</span>
<a href="#l4.425"></a><span id="l4.425"> agendaListbox.moveSelection =</span>
<a href="#l4.426"></a><span id="l4.426"> function moveSelection() {</span>
<a href="#l4.427"></a><span id="l4.427">     var selindex = this.agendaListboxControl.selectedIndex;</span>
<a href="#l4.428"></a><span id="l4.428">     if (!this.isEventListItem(this.agendaListboxControl.selectedItem.nextSibling)) {</span>
<a href="#l4.429"></a><span id="l4.429">         this.agendaListboxControl.goUp();</span>
<a href="#l4.430"></a><span id="l4.430">     } else {</span>
<a href="#l4.431"></a><span id="l4.431">         this.agendaListboxControl.goDown();</span>
<a href="#l4.432"></a><span id="l4.432">     }</span>
<a href="#l4.433"></a><span id="l4.433" class="difflineminus">-}</span>
<a href="#l4.434"></a><span id="l4.434" class="difflineplus">+};</span>
<a href="#l4.435"></a><span id="l4.435"> </span>
<a href="#l4.436"></a><span id="l4.436"> /**</span>
<a href="#l4.437"></a><span id="l4.437">  * Gets an array of selected items. If a period node is selected, it is not</span>
<a href="#l4.438"></a><span id="l4.438">  * included.</span>
<a href="#l4.439"></a><span id="l4.439">  *</span>
<a href="#l4.440"></a><span id="l4.440">  * @return      An array with all selected items.</span>
<a href="#l4.441"></a><span id="l4.441">  */</span>
<a href="#l4.442"></a><span id="l4.442"> agendaListbox.getSelectedItems =</span>
<a href="#l4.443"></a><span id="l4.443" class="difflineat">@@ -821,17 +821,17 @@ function getSelectedItems() {</span>
<a href="#l4.444"></a><span id="l4.444">     var selindex = this.agendaListboxControl.selectedIndex;</span>
<a href="#l4.445"></a><span id="l4.445">     var items = [];</span>
<a href="#l4.446"></a><span id="l4.446">     if (this.isEventListItem(this.agendaListboxControl.selectedItem)) {</span>
<a href="#l4.447"></a><span id="l4.447">         // If at some point we support selecting multiple items, this array can</span>
<a href="#l4.448"></a><span id="l4.448">         // be expanded.</span>
<a href="#l4.449"></a><span id="l4.449">         items = [this.agendaListboxControl.selectedItem.occurrence];</span>
<a href="#l4.450"></a><span id="l4.450">     }</span>
<a href="#l4.451"></a><span id="l4.451">     return items;</span>
<a href="#l4.452"></a><span id="l4.452" class="difflineminus">-}</span>
<a href="#l4.453"></a><span id="l4.453" class="difflineplus">+};</span>
<a href="#l4.454"></a><span id="l4.454"> </span>
<a href="#l4.455"></a><span id="l4.455"> /**</span>
<a href="#l4.456"></a><span id="l4.456">  * Checks if the passed node in the listbox is an Event item (not a</span>
<a href="#l4.457"></a><span id="l4.457">  * period item).</span>
<a href="#l4.458"></a><span id="l4.458">  *</span>
<a href="#l4.459"></a><span id="l4.459">  * @param aListItem     The node to check for.</span>
<a href="#l4.460"></a><span id="l4.460">  * @return              True, if the node is not a period item.</span>
<a href="#l4.461"></a><span id="l4.461">  */</span>
<a href="#l4.462"></a><span id="l4.462" class="difflineat">@@ -839,17 +839,17 @@ agendaListbox.isEventListItem =</span>
<a href="#l4.463"></a><span id="l4.463"> function isEventListItem(aListItem) {</span>
<a href="#l4.464"></a><span id="l4.464">     var isEventListItem = (aListItem != null);</span>
<a href="#l4.465"></a><span id="l4.465">     if (isEventListItem) {</span>
<a href="#l4.466"></a><span id="l4.466">         var localName = aListItem.localName;</span>
<a href="#l4.467"></a><span id="l4.467">         isEventListItem = (localName == &quot;agenda-richlist-item&quot; ||</span>
<a href="#l4.468"></a><span id="l4.468">                            localName == &quot;agenda-allday-richlist-item&quot;);</span>
<a href="#l4.469"></a><span id="l4.469">     }</span>
<a href="#l4.470"></a><span id="l4.470">     return isEventListItem;</span>
<a href="#l4.471"></a><span id="l4.471" class="difflineminus">-}</span>
<a href="#l4.472"></a><span id="l4.472" class="difflineplus">+};</span>
<a href="#l4.473"></a><span id="l4.473"> </span>
<a href="#l4.474"></a><span id="l4.474"> /**</span>
<a href="#l4.475"></a><span id="l4.475">  * Removes all Event items, keeping the period items intact.</span>
<a href="#l4.476"></a><span id="l4.476">  */</span>
<a href="#l4.477"></a><span id="l4.477"> agendaListbox.removeListItems =</span>
<a href="#l4.478"></a><span id="l4.478"> function removeListItems() {</span>
<a href="#l4.479"></a><span id="l4.479">     var listItem = this.agendaListboxControl.lastChild;</span>
<a href="#l4.480"></a><span id="l4.480">     if (listItem) {</span>
<a href="#l4.481"></a><span id="l4.481" class="difflineat">@@ -864,19 +864,19 @@ function removeListItems() {</span>
<a href="#l4.482"></a><span id="l4.482">             if (this.isEventListItem(listItem)) {</span>
<a href="#l4.483"></a><span id="l4.483">                 if (listItem != this.agendaListboxControl.firstChild) {</span>
<a href="#l4.484"></a><span id="l4.484">                     listItem.remove();</span>
<a href="#l4.485"></a><span id="l4.485">                 } else {</span>
<a href="#l4.486"></a><span id="l4.486">                     leaveloop = true;</span>
<a href="#l4.487"></a><span id="l4.487">                 }</span>
<a href="#l4.488"></a><span id="l4.488">             }</span>
<a href="#l4.489"></a><span id="l4.489">             listItem = newlistItem;</span>
<a href="#l4.490"></a><span id="l4.490" class="difflineminus">-        } while (!leaveloop)</span>
<a href="#l4.491"></a><span id="l4.491" class="difflineplus">+        } while (!leaveloop);</span>
<a href="#l4.492"></a><span id="l4.492">     }</span>
<a href="#l4.493"></a><span id="l4.493" class="difflineminus">-}</span>
<a href="#l4.494"></a><span id="l4.494" class="difflineplus">+};</span>
<a href="#l4.495"></a><span id="l4.495"> </span>
<a href="#l4.496"></a><span id="l4.496"> /**</span>
<a href="#l4.497"></a><span id="l4.497">  * Gets the list item node by its associated event's hashId.</span>
<a href="#l4.498"></a><span id="l4.498">  *</span>
<a href="#l4.499"></a><span id="l4.499">  * @return The XUL node if successful, otherwise null.</span>
<a href="#l4.500"></a><span id="l4.500">  */</span>
<a href="#l4.501"></a><span id="l4.501"> agendaListbox.getListItemByHashId =</span>
<a href="#l4.502"></a><span id="l4.502"> function getListItemByHashId(ahashId) {</span>
<a href="#l4.503"></a><span id="l4.503" class="difflineat">@@ -885,19 +885,19 @@ function getListItemByHashId(ahashId) {</span>
<a href="#l4.504"></a><span id="l4.504">     do {</span>
<a href="#l4.505"></a><span id="l4.505">         if (this.isEventListItem(listItem)) {</span>
<a href="#l4.506"></a><span id="l4.506">             if (listItem.occurrence.hashId == ahashId) {</span>
<a href="#l4.507"></a><span id="l4.507">                 return listItem;</span>
<a href="#l4.508"></a><span id="l4.508">             }</span>
<a href="#l4.509"></a><span id="l4.509">         }</span>
<a href="#l4.510"></a><span id="l4.510">         listItem = listItem.nextSibling;</span>
<a href="#l4.511"></a><span id="l4.511">         leaveloop = (listItem == null);</span>
<a href="#l4.512"></a><span id="l4.512" class="difflineminus">-    } while (!leaveloop)</span>
<a href="#l4.513"></a><span id="l4.513" class="difflineplus">+    } while (!leaveloop);</span>
<a href="#l4.514"></a><span id="l4.514">     return null;</span>
<a href="#l4.515"></a><span id="l4.515" class="difflineminus">-}</span>
<a href="#l4.516"></a><span id="l4.516" class="difflineplus">+};</span>
<a href="#l4.517"></a><span id="l4.517"> </span>
<a href="#l4.518"></a><span id="l4.518"> /**</span>
<a href="#l4.519"></a><span id="l4.519">  * The operation listener used for calendar queries.</span>
<a href="#l4.520"></a><span id="l4.520">  * Implements calIOperationListener.</span>
<a href="#l4.521"></a><span id="l4.521">  */</span>
<a href="#l4.522"></a><span id="l4.522"> agendaListbox.calendarOpListener = {</span>
<a href="#l4.523"></a><span id="l4.523">     agendaListbox: agendaListbox</span>
<a href="#l4.524"></a><span id="l4.524"> };</span>
<a href="#l4.525"></a><span id="l4.525" class="difflineat">@@ -947,17 +947,17 @@ agendaListbox.calendarObserver.getOccurr</span>
<a href="#l4.526"></a><span id="l4.526"> function getOccurrencesBetween(aItem) {</span>
<a href="#l4.527"></a><span id="l4.527">     var occs = [];</span>
<a href="#l4.528"></a><span id="l4.528">     var start = this.agendaListbox.getStart();</span>
<a href="#l4.529"></a><span id="l4.529">     var end = this.agendaListbox.getEnd();</span>
<a href="#l4.530"></a><span id="l4.530">     if (start &amp;&amp; end) {</span>
<a href="#l4.531"></a><span id="l4.531">         occs = aItem.getOccurrencesBetween(start, end, {});</span>
<a href="#l4.532"></a><span id="l4.532">     }</span>
<a href="#l4.533"></a><span id="l4.533">     return occs;</span>
<a href="#l4.534"></a><span id="l4.534" class="difflineminus">-}</span>
<a href="#l4.535"></a><span id="l4.535" class="difflineplus">+};</span>
<a href="#l4.536"></a><span id="l4.536"> </span>
<a href="#l4.537"></a><span id="l4.537"> agendaListbox.calendarObserver.onDeleteItem =</span>
<a href="#l4.538"></a><span id="l4.538"> function observer_onDeleteItem(item, rebuildFlag) {</span>
<a href="#l4.539"></a><span id="l4.539">     this.onLocalDeleteItem(item, true);</span>
<a href="#l4.540"></a><span id="l4.540"> };</span>
<a href="#l4.541"></a><span id="l4.541"> </span>
<a href="#l4.542"></a><span id="l4.542"> agendaListbox.calendarObserver.onLocalDeleteItem =</span>
<a href="#l4.543"></a><span id="l4.543"> function observer_onLocalDeleteItem(item, moveSelection) {</span>
<a href="#l4.544"></a><span id="l4.544" class="difflineat">@@ -1045,17 +1045,17 @@ agendaListbox.updateSoonSection =</span>
<a href="#l4.545"></a><span id="l4.545"> function updateSoonSection() {</span>
<a href="#l4.546"></a><span id="l4.546">     this.soon.duration = this.soonDays;</span>
<a href="#l4.547"></a><span id="l4.547">     this.soon.open = true;</span>
<a href="#l4.548"></a><span id="l4.548">     let soonHeader = document.getElementById(&quot;nextweek-header&quot;);</span>
<a href="#l4.549"></a><span id="l4.549">     if (soonHeader) {</span>
<a href="#l4.550"></a><span id="l4.550">         soonHeader.setItem(this.soon, true);</span>
<a href="#l4.551"></a><span id="l4.551">         agendaListbox.refreshPeriodDates(now());</span>
<a href="#l4.552"></a><span id="l4.552">     }</span>
<a href="#l4.553"></a><span id="l4.553" class="difflineminus">-}</span>
<a href="#l4.554"></a><span id="l4.554" class="difflineplus">+};</span>
<a href="#l4.555"></a><span id="l4.555"> </span>
<a href="#l4.556"></a><span id="l4.556"> /**</span>
<a href="#l4.557"></a><span id="l4.557">  * Updates the event considered &quot;current&quot;. This goes through all &quot;today&quot; items</span>
<a href="#l4.558"></a><span id="l4.558">  * and sets the &quot;current&quot; attribute on all list items that are currently</span>
<a href="#l4.559"></a><span id="l4.559">  * occurring.</span>
<a href="#l4.560"></a><span id="l4.560">  *</span>
<a href="#l4.561"></a><span id="l4.561">  * @see scheduleNextCurrentEventUpdate</span>
<a href="#l4.562"></a><span id="l4.562">  */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l5.1"></a><span id="l5.1" class="difflineminus">--- a/calendar/base/content/calendar-chrome-startup.js</span>
<a href="#l5.2"></a><span id="l5.2" class="difflineplus">+++ b/calendar/base/content/calendar-chrome-startup.js</span>
<a href="#l5.3"></a><span id="l5.3" class="difflineat">@@ -136,17 +136,17 @@ var calendarWindowPrefs = {</span>
<a href="#l5.4"></a><span id="l5.4">         } else if (aTopic == &quot;domwindowopened&quot;) {</span>
<a href="#l5.5"></a><span id="l5.5">             let win = aSubject.QueryInterface(Components.interfaces.nsIDOMWindow);</span>
<a href="#l5.6"></a><span id="l5.6">             win.addEventListener(&quot;load&quot;, function() {</span>
<a href="#l5.7"></a><span id="l5.7">                 let attributeValue = Preferences.get(&quot;calendar.view.useSystemColors&quot;, false) &amp;&amp; &quot;true&quot;;</span>
<a href="#l5.8"></a><span id="l5.8">                 setElementValue(win.document.documentElement, attributeValue, &quot;systemcolors&quot;);</span>
<a href="#l5.9"></a><span id="l5.9">             }, false);</span>
<a href="#l5.10"></a><span id="l5.10">         }</span>
<a href="#l5.11"></a><span id="l5.11">     }</span>
<a href="#l5.12"></a><span id="l5.12" class="difflineminus">-}</span>
<a href="#l5.13"></a><span id="l5.13" class="difflineplus">+};</span>
<a href="#l5.14"></a><span id="l5.14"> </span>
<a href="#l5.15"></a><span id="l5.15"> /**</span>
<a href="#l5.16"></a><span id="l5.16">  * Migrate calendar UI. This function is called at each startup and can be used</span>
<a href="#l5.17"></a><span id="l5.17">  * to change UI items that require js code intervention</span>
<a href="#l5.18"></a><span id="l5.18">  */</span>
<a href="#l5.19"></a><span id="l5.19"> function migrateCalendarUI() {</span>
<a href="#l5.20"></a><span id="l5.20">     const UI_VERSION = 2;</span>
<a href="#l5.21"></a><span id="l5.21">     let currentUIVersion = Preferences.get(&quot;calendar.ui.version&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l6.1"></a><span id="l6.1" class="difflineminus">--- a/calendar/base/content/calendar-extract.js</span>
<a href="#l6.2"></a><span id="l6.2" class="difflineplus">+++ b/calendar/base/content/calendar-extract.js</span>
<a href="#l6.3"></a><span id="l6.3" class="difflineat">@@ -45,17 +45,17 @@ var calendarExtract = {</span>
<a href="#l6.4"></a><span id="l6.4">                     return a[0].localeCompare(b[0]);</span>
<a href="#l6.5"></a><span id="l6.5">                 } else if (idx_a != -1 &amp;&amp; idx_b != -1) {</span>
<a href="#l6.6"></a><span id="l6.6">                     return idx_a - idx_b;</span>
<a href="#l6.7"></a><span id="l6.7">                 } else if (idx_a != -1) {</span>
<a href="#l6.8"></a><span id="l6.8">                     return -1;</span>
<a href="#l6.9"></a><span id="l6.9">                 } else {</span>
<a href="#l6.10"></a><span id="l6.10">                     return 1;</span>
<a href="#l6.11"></a><span id="l6.11">                 }</span>
<a href="#l6.12"></a><span id="l6.12" class="difflineminus">-            }</span>
<a href="#l6.13"></a><span id="l6.13" class="difflineplus">+            };</span>
<a href="#l6.14"></a><span id="l6.14">         }</span>
<a href="#l6.15"></a><span id="l6.15"> </span>
<a href="#l6.16"></a><span id="l6.16">         langs.sort(createLanguageComptor(lastUsedLangs));</span>
<a href="#l6.17"></a><span id="l6.17">         removeChildren(localeList);</span>
<a href="#l6.18"></a><span id="l6.18"> </span>
<a href="#l6.19"></a><span id="l6.19">         for (let lang of langs) {</span>
<a href="#l6.20"></a><span id="l6.20">             addMenuItem(localeList, lang[0], lang[1], null);</span>
<a href="#l6.21"></a><span id="l6.21">         }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l7.1"></a><span id="l7.1" class="difflineminus">--- a/calendar/base/content/calendar-invitations-manager.js</span>
<a href="#l7.2"></a><span id="l7.2" class="difflineplus">+++ b/calendar/base/content/calendar-invitations-manager.js</span>
<a href="#l7.3"></a><span id="l7.3" class="difflineat">@@ -141,17 +141,17 @@ InvitationsManager.prototype = {</span>
<a href="#l7.4"></a><span id="l7.4">             // calIOperationListener</span>
<a href="#l7.5"></a><span id="l7.5">             onOperationComplete: function(aCalendar,</span>
<a href="#l7.6"></a><span id="l7.6">                                           aStatus,</span>
<a href="#l7.7"></a><span id="l7.7">                                           aOperationType,</span>
<a href="#l7.8"></a><span id="l7.8">                                           aId,</span>
<a href="#l7.9"></a><span id="l7.9">                                           aDetail) {</span>
<a href="#l7.10"></a><span id="l7.10">                 if (--this.mCount == 0) {</span>
<a href="#l7.11"></a><span id="l7.11">                     this.mInvitationsManager.mItemList.sort((a, b) =&gt; {</span>
<a href="#l7.12"></a><span id="l7.12" class="difflineminus">-                        return a.startDate.compare(b.startDate)</span>
<a href="#l7.13"></a><span id="l7.13" class="difflineplus">+                        return a.startDate.compare(b.startDate);</span>
<a href="#l7.14"></a><span id="l7.14">                     });</span>
<a href="#l7.15"></a><span id="l7.15">                     for (var listener of listeners) {</span>
<a href="#l7.16"></a><span id="l7.16">                         try {</span>
<a href="#l7.17"></a><span id="l7.17">                             if (this.mInvitationsManager.mItemList.length) {</span>
<a href="#l7.18"></a><span id="l7.18">                                 // Only call if there are actually items</span>
<a href="#l7.19"></a><span id="l7.19">                                 listener.onGetResult(null,</span>
<a href="#l7.20"></a><span id="l7.20">                                                      Components.results.NS_OK,</span>
<a href="#l7.21"></a><span id="l7.21">                                                      Components.interfaces.calIItemBase,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l8.1"></a><span id="l8.1" class="difflineminus">--- a/calendar/base/content/calendar-item-editing.js</span>
<a href="#l8.2"></a><span id="l8.2" class="difflineplus">+++ b/calendar/base/content/calendar-item-editing.js</span>
<a href="#l8.3"></a><span id="l8.3" class="difflineat">@@ -288,17 +288,17 @@ function createTodoWithDialog(calendar, </span>
<a href="#l8.4"></a><span id="l8.4">         if (item.id) {</span>
<a href="#l8.5"></a><span id="l8.5">             // If the item already has an id, then this is the result of</span>
<a href="#l8.6"></a><span id="l8.6">             // saving the item without closing, and then saving again.</span>
<a href="#l8.7"></a><span id="l8.7">             doTransaction('modify', item, calendar, originalItem, listener);</span>
<a href="#l8.8"></a><span id="l8.8">         } else {</span>
<a href="#l8.9"></a><span id="l8.9">             // Otherwise, this is an addition</span>
<a href="#l8.10"></a><span id="l8.10">             doTransaction('add', item, calendar, null, listener);</span>
<a href="#l8.11"></a><span id="l8.11">         }</span>
<a href="#l8.12"></a><span id="l8.12" class="difflineminus">-    }</span>
<a href="#l8.13"></a><span id="l8.13" class="difflineplus">+    };</span>
<a href="#l8.14"></a><span id="l8.14"> </span>
<a href="#l8.15"></a><span id="l8.15">     if (todo) {</span>
<a href="#l8.16"></a><span id="l8.16">         // If the todo should be created from a template, then make sure to</span>
<a href="#l8.17"></a><span id="l8.17">         // remove the id so that the item obtains a new id when doing the</span>
<a href="#l8.18"></a><span id="l8.18">         // transaction</span>
<a href="#l8.19"></a><span id="l8.19">         if (todo.id) {</span>
<a href="#l8.20"></a><span id="l8.20">             todo = todo.clone();</span>
<a href="#l8.21"></a><span id="l8.21">             todo.id = null;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l9.1"></a><span id="l9.1" class="difflineminus">--- a/calendar/base/content/calendar-month-view.xml</span>
<a href="#l9.2"></a><span id="l9.2" class="difflineplus">+++ b/calendar/base/content/calendar-month-view.xml</span>
<a href="#l9.3"></a><span id="l9.3" class="difflineat">@@ -761,17 +761,17 @@</span>
<a href="#l9.4"></a><span id="l9.4">             mainMonth = mainMonth % 12;</span>
<a href="#l9.5"></a><span id="l9.5">           }</span>
<a href="#l9.6"></a><span id="l9.6"> </span>
<a href="#l9.7"></a><span id="l9.7">           var dateBoxes = [];</span>
<a href="#l9.8"></a><span id="l9.8">           var today = this.today();</span>
<a href="#l9.9"></a><span id="l9.9"> </span>
<a href="#l9.10"></a><span id="l9.10">           // This gets set to true, telling us to collapse the rest of the rows</span>
<a href="#l9.11"></a><span id="l9.11">           var finished = false;</span>
<a href="#l9.12"></a><span id="l9.12" class="difflineminus">-          var dateList = this.getDateList({})</span>
<a href="#l9.13"></a><span id="l9.13" class="difflineplus">+          var dateList = this.getDateList({});</span>
<a href="#l9.14"></a><span id="l9.14"> </span>
<a href="#l9.15"></a><span id="l9.15">           // This allows to find the first column of dayboxes where to set the</span>
<a href="#l9.16"></a><span id="l9.16">           // week labels taking into account whether days-off are displayed or not.</span>
<a href="#l9.17"></a><span id="l9.17">           let weekLabelColumnPos = -1;</span>
<a href="#l9.18"></a><span id="l9.18"> </span>
<a href="#l9.19"></a><span id="l9.19">           var rows = this.monthgridrows.childNodes;</span>
<a href="#l9.20"></a><span id="l9.20"> </span>
<a href="#l9.21"></a><span id="l9.21">           // Iterate through each monthgridrow and set up the day-boxes that</span>
<a href="#l9.22"></a><span id="l9.22" class="difflineat">@@ -1095,17 +1095,17 @@</span>
<a href="#l9.23"></a><span id="l9.23">               }</span>
<a href="#l9.24"></a><span id="l9.24">             }</span>
<a href="#l9.25"></a><span id="l9.25">           }</span>
<a href="#l9.26"></a><span id="l9.26"> </span>
<a href="#l9.27"></a><span id="l9.27">           if (!aStop) {</span>
<a href="#l9.28"></a><span id="l9.28">             // Set up a timer to stop the flashing after the total time.</span>
<a href="#l9.29"></a><span id="l9.29">             var this_ = this;</span>
<a href="#l9.30"></a><span id="l9.30">             this.mFlashingEvents[aAlarmItem.hashId] = aAlarmItem;</span>
<a href="#l9.31"></a><span id="l9.31" class="difflineminus">-            setTimeout(function() { this_.flashAlarm(aAlarmItem, true) }, totaltime);</span>
<a href="#l9.32"></a><span id="l9.32" class="difflineplus">+            setTimeout(function() { this_.flashAlarm(aAlarmItem, true); }, totaltime);</span>
<a href="#l9.33"></a><span id="l9.33">           } else {</span>
<a href="#l9.34"></a><span id="l9.34">             // We are done flashing, prevent newly created event boxes from flashing.</span>
<a href="#l9.35"></a><span id="l9.35">             delete this.mFlashingEvents[aAlarmItem.hashId];</span>
<a href="#l9.36"></a><span id="l9.36">           }</span>
<a href="#l9.37"></a><span id="l9.37">         ]]&gt;&lt;/body&gt;</span>
<a href="#l9.38"></a><span id="l9.38">       &lt;/method&gt;</span>
<a href="#l9.39"></a><span id="l9.39">     &lt;/implementation&gt;</span>
<a href="#l9.40"></a><span id="l9.40"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l10.1"></a><span id="l10.1" class="difflineminus">--- a/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l10.2"></a><span id="l10.2" class="difflineplus">+++ b/calendar/base/content/calendar-multiday-view.xml</span>
<a href="#l10.3"></a><span id="l10.3" class="difflineat">@@ -599,17 +599,17 @@</span>
<a href="#l10.4"></a><span id="l10.4">                clearTimeout(this.mEventMapTimeout);</span>
<a href="#l10.5"></a><span id="l10.5">            }</span>
<a href="#l10.6"></a><span id="l10.6">            var column = this;</span>
<a href="#l10.7"></a><span id="l10.7"> </span>
<a href="#l10.8"></a><span id="l10.8">            if (this.mCreatedNewEvent) {</span>
<a href="#l10.9"></a><span id="l10.9">                this.mEventToEdit = aOccurrence;</span>
<a href="#l10.10"></a><span id="l10.10">            }</span>
<a href="#l10.11"></a><span id="l10.11">            // Fun with scoping...</span>
<a href="#l10.12"></a><span id="l10.12" class="difflineminus">-           this.mEventMapTimeout = setTimeout(function() { column.relayout.call(column) }, 5);</span>
<a href="#l10.13"></a><span id="l10.13" class="difflineplus">+           this.mEventMapTimeout = setTimeout(function() { column.relayout.call(column); }, 5);</span>
<a href="#l10.14"></a><span id="l10.14">         ]]&gt;&lt;/body&gt;</span>
<a href="#l10.15"></a><span id="l10.15">       &lt;/method&gt;</span>
<a href="#l10.16"></a><span id="l10.16"> </span>
<a href="#l10.17"></a><span id="l10.17">       &lt;method name=&quot;deleteEvent&quot;&gt;</span>
<a href="#l10.18"></a><span id="l10.18">         &lt;parameter name=&quot;aOccurrence&quot;/&gt;</span>
<a href="#l10.19"></a><span id="l10.19">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l10.20"></a><span id="l10.20">            if (this.internalDeleteEvent(aOccurrence)) {</span>
<a href="#l10.21"></a><span id="l10.21">                this.relayout();</span>
<a href="#l10.22"></a><span id="l10.22" class="difflineat">@@ -1138,17 +1138,17 @@</span>
<a href="#l10.23"></a><span id="l10.23">                   // are introduced based on the start column and number of spanning columns of an item.</span>
<a href="#l10.24"></a><span id="l10.24">                   if (data.colSpan != 1) {</span>
<a href="#l10.25"></a><span id="l10.25">                       var index = glob.totalCols * data.colSpan + data.startCol;</span>
<a href="#l10.26"></a><span id="l10.26">                       layerIndex = layerArray[index];</span>
<a href="#l10.27"></a><span id="l10.27">                       if (!layerIndex) {</span>
<a href="#l10.28"></a><span id="l10.28">                           layerIndex = layerCounter++;</span>
<a href="#l10.29"></a><span id="l10.29">                           layerArray[index] = layerIndex;</span>
<a href="#l10.30"></a><span id="l10.30">                       }</span>
<a href="#l10.31"></a><span id="l10.31" class="difflineminus">-                      var offset = ((glob.totalCols - data.colSpan) % glob.totalCols)</span>
<a href="#l10.32"></a><span id="l10.32" class="difflineplus">+                      var offset = ((glob.totalCols - data.colSpan) % glob.totalCols);</span>
<a href="#l10.33"></a><span id="l10.33">                       if (offset != 0) {</span>
<a href="#l10.34"></a><span id="l10.34">                           specialSpan = data.colSpan / glob.totalCols;</span>
<a href="#l10.35"></a><span id="l10.35">                       }</span>
<a href="#l10.36"></a><span id="l10.36">                   } else {</span>
<a href="#l10.37"></a><span id="l10.37">                       layerIndex = 0;</span>
<a href="#l10.38"></a><span id="l10.38">                   }</span>
<a href="#l10.39"></a><span id="l10.39">                   layerIndex += layerOffset;</span>
<a href="#l10.40"></a><span id="l10.40"> </span>
<a href="#l10.41"></a><span id="l10.41" class="difflineat">@@ -2576,20 +2576,20 @@</span>
<a href="#l10.42"></a><span id="l10.42">           }</span>
<a href="#l10.43"></a><span id="l10.43">         ]]&gt;&lt;/body&gt;</span>
<a href="#l10.44"></a><span id="l10.44">       &lt;/method&gt;</span>
<a href="#l10.45"></a><span id="l10.45"> </span>
<a href="#l10.46"></a><span id="l10.46">       &lt;method name=&quot;enableTimeIndicator&quot;&gt;</span>
<a href="#l10.47"></a><span id="l10.47">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l10.48"></a><span id="l10.48">           // Hide or show the time indicator if the preference becomes 0 or greater than 0.</span>
<a href="#l10.49"></a><span id="l10.49">           let hideIndicator = this.mTimeIndicatorInterval == 0;</span>
<a href="#l10.50"></a><span id="l10.50" class="difflineminus">-          setBooleanAttribute(this.timeBarTimeIndicator, &quot;hidden&quot;, hideIndicator)</span>
<a href="#l10.51"></a><span id="l10.51" class="difflineplus">+          setBooleanAttribute(this.timeBarTimeIndicator, &quot;hidden&quot;, hideIndicator);</span>
<a href="#l10.52"></a><span id="l10.52">           let todayColumn = this.findColumnForDate(this.today());</span>
<a href="#l10.53"></a><span id="l10.53">           if (todayColumn) {</span>
<a href="#l10.54"></a><span id="l10.54" class="difflineminus">-              setBooleanAttribute(todayColumn.column.timeIndicatorBox, &quot;hidden&quot;, hideIndicator)</span>
<a href="#l10.55"></a><span id="l10.55" class="difflineplus">+              setBooleanAttribute(todayColumn.column.timeIndicatorBox, &quot;hidden&quot;, hideIndicator);</span>
<a href="#l10.56"></a><span id="l10.56">           }</span>
<a href="#l10.57"></a><span id="l10.57">           // Update the timer but only under some circumstances, otherwise</span>
<a href="#l10.58"></a><span id="l10.58">           // it will update the wrong view or it will start without need.</span>
<a href="#l10.59"></a><span id="l10.59">           let currentMode = document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;);</span>
<a href="#l10.60"></a><span id="l10.60">           let currView = currentView().type;</span>
<a href="#l10.61"></a><span id="l10.61">           if (currentMode == &quot;calendar&quot; &amp;&amp; currView == this.type &amp;&amp; !hideIndicator</span>
<a href="#l10.62"></a><span id="l10.62">               &amp;&amp; (currView == &quot;day&quot; || currView == &quot;week&quot;)) {</span>
<a href="#l10.63"></a><span id="l10.63">               this.updateTimeIndicatorPosition(true);</span>
<a href="#l10.64"></a><span id="l10.64" class="difflineat">@@ -2602,17 +2602,17 @@</span>
<a href="#l10.65"></a><span id="l10.65">         &lt;parameter name=&quot;aPpmChanged&quot;/&gt;</span>
<a href="#l10.66"></a><span id="l10.66">         &lt;parameter name=&quot;aViewChanged&quot;/&gt;</span>
<a href="#l10.67"></a><span id="l10.67">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l10.68"></a><span id="l10.68">           let now = cal.now();</span>
<a href="#l10.69"></a><span id="l10.69">           let nowMinutes = now.hour * 60 + now.minute;</span>
<a href="#l10.70"></a><span id="l10.70">           if (aUpdateTheTimer) {</span>
<a href="#l10.71"></a><span id="l10.71">               let prefInt = this.mTimeIndicatorInterval;</span>
<a href="#l10.72"></a><span id="l10.72">               if (prefInt == 0) {</span>
<a href="#l10.73"></a><span id="l10.73" class="difflineminus">-                  timeIndicator.cancel()</span>
<a href="#l10.74"></a><span id="l10.74" class="difflineplus">+                  timeIndicator.cancel();</span>
<a href="#l10.75"></a><span id="l10.75">                   return;</span>
<a href="#l10.76"></a><span id="l10.76">               }</span>
<a href="#l10.77"></a><span id="l10.77"> </span>
<a href="#l10.78"></a><span id="l10.78">               // Increase the update interval if pixels per minute is small.</span>
<a href="#l10.79"></a><span id="l10.79">               let oldPrefInt = prefInt;</span>
<a href="#l10.80"></a><span id="l10.80">               if (aPpmChanged &amp;&amp; this.mPixPerMin &lt; 0.6) {</span>
<a href="#l10.81"></a><span id="l10.81">                   prefInt = Math.round(prefInt / this.mPixPerMin);</span>
<a href="#l10.82"></a><span id="l10.82">               }</span>
<a href="#l10.83"></a><span id="l10.83" class="difflineat">@@ -2705,17 +2705,17 @@</span>
<a href="#l10.84"></a><span id="l10.84">           }</span>
<a href="#l10.85"></a><span id="l10.85">           let ppm = size / self.mVisibleMinutes;</span>
<a href="#l10.86"></a><span id="l10.86">           ppm = Math.floor(ppm * 1000) / 1000;</span>
<a href="#l10.87"></a><span id="l10.87">           if (ppm &lt; self.mMinPixelsPerMinute) {</span>
<a href="#l10.88"></a><span id="l10.88">               ppm = self.mMinPixelsPerMinute;</span>
<a href="#l10.89"></a><span id="l10.89">           }</span>
<a href="#l10.90"></a><span id="l10.90">           let ppmChanged = (self.pixelsPerMinute != ppm);</span>
<a href="#l10.91"></a><span id="l10.91">           self.pixelsPerMinute = ppm;</span>
<a href="#l10.92"></a><span id="l10.92" class="difflineminus">-          setTimeout(function(){self.scrollToMinute(self.mFirstVisibleMinute)}, 0);</span>
<a href="#l10.93"></a><span id="l10.93" class="difflineplus">+          setTimeout(function() { self.scrollToMinute(self.mFirstVisibleMinute); }, 0);</span>
<a href="#l10.94"></a><span id="l10.94"> </span>
<a href="#l10.95"></a><span id="l10.95">           // Fit the weekday labels while scrolling.</span>
<a href="#l10.96"></a><span id="l10.96">           self.adjustWeekdayLength(self.getAttribute(&quot;orient&quot;) == &quot;horizontal&quot;);</span>
<a href="#l10.97"></a><span id="l10.97"> </span>
<a href="#l10.98"></a><span id="l10.98">           // Adjust the time indicator position and the related timer.</span>
<a href="#l10.99"></a><span id="l10.99">           if (this.mTimeIndicatorInterval != 0) {</span>
<a href="#l10.100"></a><span id="l10.100">               let viewChanged = isARelayout &amp;&amp; (timeIndicator.lastView != this.id);</span>
<a href="#l10.101"></a><span id="l10.101">               let currentMode = document.getElementById(&quot;modeBroadcaster&quot;).getAttribute(&quot;mode&quot;);</span>
<a href="#l10.102"></a><span id="l10.102" class="difflineat">@@ -2778,17 +2778,17 @@</span>
<a href="#l10.103"></a><span id="l10.103">               setFlashingAttribute(box);</span>
<a href="#l10.104"></a><span id="l10.104">             }</span>
<a href="#l10.105"></a><span id="l10.105">           }</span>
<a href="#l10.106"></a><span id="l10.106"> </span>
<a href="#l10.107"></a><span id="l10.107">           if (!aStop) {</span>
<a href="#l10.108"></a><span id="l10.108">             // Set up a timer to stop the flashing after the total time.</span>
<a href="#l10.109"></a><span id="l10.109">             var this_ = this;</span>
<a href="#l10.110"></a><span id="l10.110">             this.mFlashingEvents[aAlarmItem.hashId] = aAlarmItem;</span>
<a href="#l10.111"></a><span id="l10.111" class="difflineminus">-            setTimeout(function() { this_.flashAlarm(aAlarmItem, true) }, totaltime);</span>
<a href="#l10.112"></a><span id="l10.112" class="difflineplus">+            setTimeout(function() { this_.flashAlarm(aAlarmItem, true); }, totaltime);</span>
<a href="#l10.113"></a><span id="l10.113">           } else {</span>
<a href="#l10.114"></a><span id="l10.114">             // We are done flashing, prevent newly created event boxes from flashing.</span>
<a href="#l10.115"></a><span id="l10.115">             delete this.mFlashingEvents[aAlarmItem.hashId];</span>
<a href="#l10.116"></a><span id="l10.116">           }</span>
<a href="#l10.117"></a><span id="l10.117">         ]]&gt;&lt;/body&gt;</span>
<a href="#l10.118"></a><span id="l10.118">       &lt;/method&gt;</span>
<a href="#l10.119"></a><span id="l10.119"> </span>
<a href="#l10.120"></a><span id="l10.120">       &lt;!-- calICalendarView --&gt;</span>
<a href="#l10.121"></a><span id="l10.121" class="difflineat">@@ -3111,32 +3111,32 @@</span>
<a href="#l10.122"></a><span id="l10.122">               }</span>
<a href="#l10.123"></a><span id="l10.123">           }</span>
<a href="#l10.124"></a><span id="l10.124"> </span>
<a href="#l10.125"></a><span id="l10.125">           var displayDuration = highMinute - lowMinute;</span>
<a href="#l10.126"></a><span id="l10.126">           if (this.mSelectedItems.length &amp;&amp;</span>
<a href="#l10.127"></a><span id="l10.127">               displayDuration &gt;= 0) {</span>
<a href="#l10.128"></a><span id="l10.128">               let minute;</span>
<a href="#l10.129"></a><span id="l10.129">               if (displayDuration &lt;= this.mVisibleMinutes) {</span>
<a href="#l10.130"></a><span id="l10.130" class="difflineminus">-                  minute = lowMinute + (displayDuration - this.mVisibleMinutes) / 2</span>
<a href="#l10.131"></a><span id="l10.131" class="difflineplus">+                  minute = lowMinute + (displayDuration - this.mVisibleMinutes) / 2;</span>
<a href="#l10.132"></a><span id="l10.132">               } else if (this.mSelectedItems.length == 1) {</span>
<a href="#l10.133"></a><span id="l10.133">                   // If the displayDuration doesn't fit into the visible</span>
<a href="#l10.134"></a><span id="l10.134">                   // minutes, but only one event is selected, then go ahead and</span>
<a href="#l10.135"></a><span id="l10.135">                   // center the event start.</span>
<a href="#l10.136"></a><span id="l10.136"> </span>
<a href="#l10.137"></a><span id="l10.137">                   minute = Math.max(0, lowMinute - (this.mVisibleMinutes / 2));</span>
<a href="#l10.138"></a><span id="l10.138">               }</span>
<a href="#l10.139"></a><span id="l10.139">               this.scrollToMinute(minute);</span>
<a href="#l10.140"></a><span id="l10.140">           }</span>
<a href="#l10.141"></a><span id="l10.141">         ]]&gt;&lt;/body&gt;</span>
<a href="#l10.142"></a><span id="l10.142">       &lt;/method&gt;</span>
<a href="#l10.143"></a><span id="l10.143"> </span>
<a href="#l10.144"></a><span id="l10.144">       &lt;property name=&quot;pixelsPerMinute&quot;&gt;</span>
<a href="#l10.145"></a><span id="l10.145">         &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l10.146"></a><span id="l10.146" class="difflineminus">-          return this.mPixPerMin</span>
<a href="#l10.147"></a><span id="l10.147" class="difflineplus">+          return this.mPixPerMin;</span>
<a href="#l10.148"></a><span id="l10.148">         ]]&gt;&lt;/getter&gt;</span>
<a href="#l10.149"></a><span id="l10.149">         &lt;setter&gt;&lt;![CDATA[</span>
<a href="#l10.150"></a><span id="l10.150">           this.mPixPerMin = val;</span>
<a href="#l10.151"></a><span id="l10.151"> </span>
<a href="#l10.152"></a><span id="l10.152">           let timebar = document.getAnonymousElementByAttribute(this, &quot;anonid&quot;, &quot;timebar&quot;);</span>
<a href="#l10.153"></a><span id="l10.153">           timebar.pixelsPerMinute = val;</span>
<a href="#l10.154"></a><span id="l10.154"> </span>
<a href="#l10.155"></a><span id="l10.155">           if (!this.mDateColumns) {</span>
<a href="#l10.156"></a><span id="l10.156" class="difflineat">@@ -3392,17 +3392,17 @@</span>
<a href="#l10.157"></a><span id="l10.157">                       dayEventsBox.setAttribute(&quot;relation&quot;, &quot;past&quot;);</span>
<a href="#l10.158"></a><span id="l10.158">                       labelbox.setAttribute(&quot;relation&quot;, &quot;past&quot;);</span>
<a href="#l10.159"></a><span id="l10.159">                       break;</span>
<a href="#l10.160"></a><span id="l10.160">                   case 0:</span>
<a href="#l10.161"></a><span id="l10.161">                       let relation_ = this.numVisibleDates == 1 ? &quot;today1day&quot; : &quot;today&quot;;</span>
<a href="#l10.162"></a><span id="l10.162">                       dayHeaderBox.setAttribute(&quot;relation&quot;, relation_);</span>
<a href="#l10.163"></a><span id="l10.163">                       dayEventsBox.setAttribute(&quot;relation&quot;, relation_);</span>
<a href="#l10.164"></a><span id="l10.164">                       labelbox.setAttribute(&quot;relation&quot;, relation_);</span>
<a href="#l10.165"></a><span id="l10.165" class="difflineminus">-                      setBooleanAttribute(dayEventsBox.timeIndicatorBox, &quot;hidden&quot;, this.mTimeIndicatorInterval == 0)</span>
<a href="#l10.166"></a><span id="l10.166" class="difflineplus">+                      setBooleanAttribute(dayEventsBox.timeIndicatorBox, &quot;hidden&quot;, this.mTimeIndicatorInterval == 0);</span>
<a href="#l10.167"></a><span id="l10.167">                       updateTimeIndicator = true;</span>
<a href="#l10.168"></a><span id="l10.168"> </span>
<a href="#l10.169"></a><span id="l10.169">                       // Due to equalsize=always being set on the dayboxes</span>
<a href="#l10.170"></a><span id="l10.170">                       // parent, there are a few issues showing the border of</span>
<a href="#l10.171"></a><span id="l10.171">                       // the last daybox correctly. To work around this, we're</span>
<a href="#l10.172"></a><span id="l10.172">                       // setting an attribute we can use in CSS. For more</span>
<a href="#l10.173"></a><span id="l10.173">                       // information about this hack, see bug 455045</span>
<a href="#l10.174"></a><span id="l10.174">                       if (dayHeaderBox == headerdaybox.childNodes[headerdaybox.childNodes.length - 1] &amp;&amp;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l11.1"></a><span id="l11.1" class="difflineminus">--- a/calendar/base/content/calendar-task-view.js</span>
<a href="#l11.2"></a><span id="l11.2" class="difflineplus">+++ b/calendar/base/content/calendar-task-view.js</span>
<a href="#l11.3"></a><span id="l11.3" class="difflineat">@@ -125,17 +125,17 @@ var taskDetailsView = {</span>
<a href="#l11.4"></a><span id="l11.4">             textbox.value = description;</span>
<a href="#l11.5"></a><span id="l11.5">             textbox.inputField.readOnly = true;</span>
<a href="#l11.6"></a><span id="l11.6">             let attachmentRows = document.getElementById(&quot;calendar-task-details-attachment-rows&quot;);</span>
<a href="#l11.7"></a><span id="l11.7">             removeChildren(attachmentRows);</span>
<a href="#l11.8"></a><span id="l11.8">             let attachments = item.getAttachments({});</span>
<a href="#l11.9"></a><span id="l11.9">             if (displayElement(&quot;calendar-task-details-attachment-row&quot;, attachments.length &gt; 0)) {</span>
<a href="#l11.10"></a><span id="l11.10">                 displayElement(&quot;calendar-task-details-attachment-rows&quot;, true);</span>
<a href="#l11.11"></a><span id="l11.11">                 for (let attachment of attachments) {</span>
<a href="#l11.12"></a><span id="l11.12" class="difflineminus">-                    let url = attachment.calIAttachment.uri.spec</span>
<a href="#l11.13"></a><span id="l11.13" class="difflineplus">+                    let url = attachment.calIAttachment.uri.spec;</span>
<a href="#l11.14"></a><span id="l11.14">                     let urlLabel = createXULElement(&quot;label&quot;);</span>
<a href="#l11.15"></a><span id="l11.15">                     urlLabel.setAttribute(&quot;value&quot;, url);</span>
<a href="#l11.16"></a><span id="l11.16">                     urlLabel.setAttribute(&quot;tooltiptext&quot;, url);</span>
<a href="#l11.17"></a><span id="l11.17">                     urlLabel.setAttribute(&quot;class&quot;, &quot;text-link&quot;);</span>
<a href="#l11.18"></a><span id="l11.18">                     urlLabel.setAttribute(&quot;crop&quot;, &quot;end&quot;);</span>
<a href="#l11.19"></a><span id="l11.19">                     urlLabel.setAttribute(&quot;onclick&quot;,</span>
<a href="#l11.20"></a><span id="l11.20">                                           &quot;if (event.button != 2) launchBrowser(this.value);&quot;);</span>
<a href="#l11.21"></a><span id="l11.21">                     urlLabel.setAttribute(&quot;context&quot;, &quot;taskview-link-context-menu&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l12.1"></a><span id="l12.1" class="difflineminus">--- a/calendar/base/content/calendar-view-core.xml</span>
<a href="#l12.2"></a><span id="l12.2" class="difflineplus">+++ b/calendar/base/content/calendar-view-core.xml</span>
<a href="#l12.3"></a><span id="l12.3" class="difflineat">@@ -209,17 +209,17 @@</span>
<a href="#l12.4"></a><span id="l12.4">           }</span>
<a href="#l12.5"></a><span id="l12.5"> </span>
<a href="#l12.6"></a><span id="l12.6">           if (this.calendarView &amp;&amp;</span>
<a href="#l12.7"></a><span id="l12.7">               item.hashId in this.calendarView.mFlashingEvents) {</span>
<a href="#l12.8"></a><span id="l12.8">               this.setAttribute(&quot;flashing&quot;, &quot;true&quot;);</span>
<a href="#l12.9"></a><span id="l12.9">           }</span>
<a href="#l12.10"></a><span id="l12.10"> </span>
<a href="#l12.11"></a><span id="l12.11">           if (alarms.length) {</span>
<a href="#l12.12"></a><span id="l12.12" class="difflineminus">-              this.setAttribute(&quot;alarm&quot;, &quot;true&quot;)</span>
<a href="#l12.13"></a><span id="l12.13" class="difflineplus">+              this.setAttribute(&quot;alarm&quot;, &quot;true&quot;);</span>
<a href="#l12.14"></a><span id="l12.14">           }</span>
<a href="#l12.15"></a><span id="l12.15"> </span>
<a href="#l12.16"></a><span id="l12.16">           // priority</span>
<a href="#l12.17"></a><span id="l12.17">           if (item.priority &gt; 0 &amp;&amp; item.priority &lt; 5) {</span>
<a href="#l12.18"></a><span id="l12.18">               this.setAttribute(&quot;priority&quot;, &quot;high&quot;);</span>
<a href="#l12.19"></a><span id="l12.19">           } else if (item.priority &gt; 5 &amp;&amp; item.priority &lt; 10) {</span>
<a href="#l12.20"></a><span id="l12.20">               this.setAttribute(&quot;priority&quot;, &quot;low&quot;);</span>
<a href="#l12.21"></a><span id="l12.21">           }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l13.1"></a><span id="l13.1" class="difflineminus">--- a/calendar/base/content/calendar-views.js</span>
<a href="#l13.2"></a><span id="l13.2" class="difflineplus">+++ b/calendar/base/content/calendar-views.js</span>
<a href="#l13.3"></a><span id="l13.3" class="difflineat">@@ -208,17 +208,17 @@ function switchToView(aViewType) {</span>
<a href="#l13.4"></a><span id="l13.4">     // Set up the labels and accesskeys for the context menu</span>
<a href="#l13.5"></a><span id="l13.5">     [&quot;calendar-view-context-menu-next&quot;,</span>
<a href="#l13.6"></a><span id="l13.6">      &quot;calendar-view-context-menu-previous&quot;,</span>
<a href="#l13.7"></a><span id="l13.7">      &quot;calendar-go-menu-next&quot;,</span>
<a href="#l13.8"></a><span id="l13.8">      &quot;calendar-go-menu-previous&quot;,</span>
<a href="#l13.9"></a><span id="l13.9">      &quot;appmenu_calendar-go-menu-next&quot;,</span>
<a href="#l13.10"></a><span id="l13.10">      &quot;appmenu_calendar-go-menu-previous&quot;].forEach(function(x) {</span>
<a href="#l13.11"></a><span id="l13.11">             setupViewNode(x, &quot;label&quot;);</span>
<a href="#l13.12"></a><span id="l13.12" class="difflineminus">-            setupViewNode(x, &quot;accesskey&quot;)</span>
<a href="#l13.13"></a><span id="l13.13" class="difflineplus">+            setupViewNode(x, &quot;accesskey&quot;);</span>
<a href="#l13.14"></a><span id="l13.14">      });</span>
<a href="#l13.15"></a><span id="l13.15"> </span>
<a href="#l13.16"></a><span id="l13.16">     // Set up the labels for the view navigation</span>
<a href="#l13.17"></a><span id="l13.17">     [&quot;previous-view-button&quot;,</span>
<a href="#l13.18"></a><span id="l13.18">      &quot;today-view-button&quot;,</span>
<a href="#l13.19"></a><span id="l13.19">      &quot;next-view-button&quot;].forEach(x =&gt; setupViewNode(x, &quot;tooltiptext&quot;));</span>
<a href="#l13.20"></a><span id="l13.20"> </span>
<a href="#l13.21"></a><span id="l13.21">     try {</span>
<a href="#l13.22"></a><span id="l13.22" class="difflineat">@@ -713,9 +713,9 @@ var timeIndicator = {</span>
<a href="#l13.23"></a><span id="l13.23">     },</span>
<a href="#l13.24"></a><span id="l13.24">     cancel: function() {</span>
<a href="#l13.25"></a><span id="l13.25">         if (timeIndicator.timer) {</span>
<a href="#l13.26"></a><span id="l13.26">             clearTimeout(timeIndicator.timer);</span>
<a href="#l13.27"></a><span id="l13.27">             timeIndicator.timer = null;</span>
<a href="#l13.28"></a><span id="l13.28">         }</span>
<a href="#l13.29"></a><span id="l13.29">     },</span>
<a href="#l13.30"></a><span id="l13.30">     lastView: null</span>
<a href="#l13.31"></a><span id="l13.31" class="difflineminus">-}</span>
<a href="#l13.32"></a><span id="l13.32" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l14.1"></a><span id="l14.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-alarm-dialog.js</span>
<a href="#l14.2"></a><span id="l14.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-alarm-dialog.js</span>
<a href="#l14.3"></a><span id="l14.3" class="difflineat">@@ -335,17 +335,17 @@ function closeIfEmpty() {</span>
<a href="#l14.4"></a><span id="l14.4"> }</span>
<a href="#l14.5"></a><span id="l14.5"> </span>
<a href="#l14.6"></a><span id="l14.6"> /**</span>
<a href="#l14.7"></a><span id="l14.7">  * Handler function called when an alarm entry in the richlistbox is selected</span>
<a href="#l14.8"></a><span id="l14.8">  *</span>
<a href="#l14.9"></a><span id="l14.9">  * @param event         The DOM event from the click action</span>
<a href="#l14.10"></a><span id="l14.10">  */</span>
<a href="#l14.11"></a><span id="l14.11"> function onSelectAlarm(event) {</span>
<a href="#l14.12"></a><span id="l14.12" class="difflineminus">-    let richList = document.getElementById(&quot;alarm-richlist&quot;)</span>
<a href="#l14.13"></a><span id="l14.13" class="difflineplus">+    let richList = document.getElementById(&quot;alarm-richlist&quot;);</span>
<a href="#l14.14"></a><span id="l14.14">     if (richList == event.target) {</span>
<a href="#l14.15"></a><span id="l14.15">         richList.ensureElementIsVisible(richList.getSelectedItem(0));</span>
<a href="#l14.16"></a><span id="l14.16">         richList.userSelectedWidget = true;</span>
<a href="#l14.17"></a><span id="l14.17">     }</span>
<a href="#l14.18"></a><span id="l14.18"> }</span>
<a href="#l14.19"></a><span id="l14.19"> </span>
<a href="#l14.20"></a><span id="l14.20"> function ensureCalendarVisible(aCalendar) {</span>
<a href="#l14.21"></a><span id="l14.21">     // This function is called on the alarm dialog from calendar-item-editing.js.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l15.1"></a><span id="l15.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-attendees.js</span>
<a href="#l15.2"></a><span id="l15.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-attendees.js</span>
<a href="#l15.3"></a><span id="l15.3" class="difflineat">@@ -110,17 +110,17 @@ function onLoad() {</span>
<a href="#l15.4"></a><span id="l15.4">             switch (aPrefName) {</span>
<a href="#l15.5"></a><span id="l15.5">                 case &quot;calendar.view.daystarthour&quot;:</span>
<a href="#l15.6"></a><span id="l15.6">                 case &quot;calendar.view.dayendhour&quot;:</span>
<a href="#l15.7"></a><span id="l15.7">                     initTimeRange();</span>
<a href="#l15.8"></a><span id="l15.8">                     propagateDateTime();</span>
<a href="#l15.9"></a><span id="l15.9">                     break;</span>
<a href="#l15.10"></a><span id="l15.10">             }</span>
<a href="#l15.11"></a><span id="l15.11">         }</span>
<a href="#l15.12"></a><span id="l15.12" class="difflineminus">-    }</span>
<a href="#l15.13"></a><span id="l15.13" class="difflineplus">+    };</span>
<a href="#l15.14"></a><span id="l15.14">     Services.prefs.addObserver(&quot;calendar.&quot;, prefObserver, false);</span>
<a href="#l15.15"></a><span id="l15.15">     window.addEventListener(&quot;unload&quot;,</span>
<a href="#l15.16"></a><span id="l15.16">         function() {</span>
<a href="#l15.17"></a><span id="l15.17">             Services.prefs.removeObserver(&quot;calendar.&quot;, prefObserver);</span>
<a href="#l15.18"></a><span id="l15.18">         },</span>
<a href="#l15.19"></a><span id="l15.19">         false);</span>
<a href="#l15.20"></a><span id="l15.20"> </span>
<a href="#l15.21"></a><span id="l15.21">     opener.setCursor(&quot;auto&quot;);</span>
<a href="#l15.22"></a><span id="l15.22" class="difflineat">@@ -421,17 +421,17 @@ function updateEndTime() {</span>
<a href="#l15.23"></a><span id="l15.23">     propagateDateTime();</span>
<a href="#l15.24"></a><span id="l15.24"> </span>
<a href="#l15.25"></a><span id="l15.25">     if (warning) {</span>
<a href="#l15.26"></a><span id="l15.26">         var callback = function() {</span>
<a href="#l15.27"></a><span id="l15.27">             Services.prompt.alert(</span>
<a href="#l15.28"></a><span id="l15.28">                 null,</span>
<a href="#l15.29"></a><span id="l15.29">                 document.title,</span>
<a href="#l15.30"></a><span id="l15.30">                 calGetString(&quot;calendar&quot;, &quot;warningEndBeforeStart&quot;));</span>
<a href="#l15.31"></a><span id="l15.31" class="difflineminus">-        }</span>
<a href="#l15.32"></a><span id="l15.32" class="difflineplus">+        };</span>
<a href="#l15.33"></a><span id="l15.33">         setTimeout(callback, 1);</span>
<a href="#l15.34"></a><span id="l15.34">     }</span>
<a href="#l15.35"></a><span id="l15.35"> }</span>
<a href="#l15.36"></a><span id="l15.36"> </span>
<a href="#l15.37"></a><span id="l15.37"> /**</span>
<a href="#l15.38"></a><span id="l15.38">  * Prompts the user to pick a new timezone for the starttime. The dialog is</span>
<a href="#l15.39"></a><span id="l15.39">  * opened modally.</span>
<a href="#l15.40"></a><span id="l15.40">  */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l16.1"></a><span id="l16.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml</span>
<a href="#l16.2"></a><span id="l16.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-attendees.xml</span>
<a href="#l16.3"></a><span id="l16.3" class="difflineat">@@ -91,17 +91,17 @@</span>
<a href="#l16.4"></a><span id="l16.4"> </span>
<a href="#l16.5"></a><span id="l16.5">           // this trigger the continous update chain, which</span>
<a href="#l16.6"></a><span id="l16.6">           // effectively calls this.onModify() on predefined</span>
<a href="#l16.7"></a><span id="l16.7">           // time intervals [each second].</span>
<a href="#l16.8"></a><span id="l16.8">           var self = this;</span>
<a href="#l16.9"></a><span id="l16.9">           var callback = function() {</span>
<a href="#l16.10"></a><span id="l16.10">               setTimeout(callback, 1000);</span>
<a href="#l16.11"></a><span id="l16.11">               self.onModify();</span>
<a href="#l16.12"></a><span id="l16.12" class="difflineminus">-          }</span>
<a href="#l16.13"></a><span id="l16.13" class="difflineplus">+          };</span>
<a href="#l16.14"></a><span id="l16.14">           callback();</span>
<a href="#l16.15"></a><span id="l16.15">         ]]&gt;&lt;/body&gt;</span>
<a href="#l16.16"></a><span id="l16.16">       &lt;/method&gt;</span>
<a href="#l16.17"></a><span id="l16.17"> </span>
<a href="#l16.18"></a><span id="l16.18">       &lt;method name=&quot;onInitialize&quot;&gt;</span>
<a href="#l16.19"></a><span id="l16.19">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l16.20"></a><span id="l16.20">           var args = window.arguments[0];</span>
<a href="#l16.21"></a><span id="l16.21">           var organizer = args.organizer;</span>
<a href="#l16.22"></a><span id="l16.22" class="difflineat">@@ -390,17 +390,17 @@</span>
<a href="#l16.23"></a><span id="l16.23">               let attendee = inputField.attendee.clone();</span>
<a href="#l16.24"></a><span id="l16.24">               if (attendee.isOrganizer) {</span>
<a href="#l16.25"></a><span id="l16.25">                   continue;</span>
<a href="#l16.26"></a><span id="l16.26">               }</span>
<a href="#l16.27"></a><span id="l16.27"> </span>
<a href="#l16.28"></a><span id="l16.28">               attendee.role = this.getRoleElement(i).getAttribute(&quot;role&quot;);</span>
<a href="#l16.29"></a><span id="l16.29">               // attendee.participationStatus = this.getStatusElement(i).getAttribute(&quot;status&quot;);</span>
<a href="#l16.30"></a><span id="l16.30">               let userType = this.getUserTypeElement(i).getAttribute(&quot;cutype&quot;);</span>
<a href="#l16.31"></a><span id="l16.31" class="difflineminus">-              attendee.userType = (userType == &quot;INDIVIDUAL&quot; ? null : userType) // INDIVIDUAL is the default</span>
<a href="#l16.32"></a><span id="l16.32" class="difflineplus">+              attendee.userType = (userType == &quot;INDIVIDUAL&quot; ? null : userType); // INDIVIDUAL is the default</span>
<a href="#l16.33"></a><span id="l16.33"> </span>
<a href="#l16.34"></a><span id="l16.34">               // break the list of potentially many attendees back into individual names. This</span>
<a href="#l16.35"></a><span id="l16.35">               // is required in case the user entered comma-separated attendees in one field and</span>
<a href="#l16.36"></a><span id="l16.36">               // then clicked OK without switching to the next line.</span>
<a href="#l16.37"></a><span id="l16.37">               let parsedInput = MailServices.headerParser.makeFromDisplayAddress(inputField.value);</span>
<a href="#l16.38"></a><span id="l16.38">               let j = 0;</span>
<a href="#l16.39"></a><span id="l16.39">               let addAttendee = function(aAddress) {</span>
<a href="#l16.40"></a><span id="l16.40">                   if (j &gt; 0) {</span>
<a href="#l16.41"></a><span id="l16.41" class="difflineat">@@ -678,17 +678,17 @@</span>
<a href="#l16.42"></a><span id="l16.42">             let role = targetIcon.getAttribute(&quot;role&quot;);</span>
<a href="#l16.43"></a><span id="l16.43">             // Set tooltip for rolenames</span>
<a href="#l16.44"></a><span id="l16.44"> </span>
<a href="#l16.45"></a><span id="l16.45">             const roleMap = {</span>
<a href="#l16.46"></a><span id="l16.46">               &quot;REQ-PARTICIPANT&quot;: &quot;required&quot;,</span>
<a href="#l16.47"></a><span id="l16.47">               &quot;OPT-PARTICIPANT&quot;: &quot;optional&quot;,</span>
<a href="#l16.48"></a><span id="l16.48">               &quot;NON-PARTICIPANT&quot;: &quot;nonparticipant&quot;,</span>
<a href="#l16.49"></a><span id="l16.49">               &quot;CHAIR&quot;: &quot;chair&quot;</span>
<a href="#l16.50"></a><span id="l16.50" class="difflineminus">-            }</span>
<a href="#l16.51"></a><span id="l16.51" class="difflineplus">+            };</span>
<a href="#l16.52"></a><span id="l16.52"> </span>
<a href="#l16.53"></a><span id="l16.53">             let roleNameString = &quot;event.attendee.role.&quot; + (role in roleMap ? roleMap[role] : &quot;unknown&quot;);</span>
<a href="#l16.54"></a><span id="l16.54">             let tooltip = cal.calGetString(&quot;calendar-event-dialog-attendees&quot;,</span>
<a href="#l16.55"></a><span id="l16.55">                                            roleNameString,</span>
<a href="#l16.56"></a><span id="l16.56">                                            (role in roleMap ? null : [role]));</span>
<a href="#l16.57"></a><span id="l16.57">             targetIcon.setAttribute(&quot;tooltiptext&quot;, tooltip);</span>
<a href="#l16.58"></a><span id="l16.58">         } else if (targetIcon.className == &quot;usertype-icon&quot;) {</span>
<a href="#l16.59"></a><span id="l16.59">             let cutype = targetIcon.getAttribute(&quot;cutype&quot;);</span>
<a href="#l16.60"></a><span id="l16.60" class="difflineat">@@ -715,17 +715,17 @@</span>
<a href="#l16.61"></a><span id="l16.61">       &lt;/property&gt;</span>
<a href="#l16.62"></a><span id="l16.62"> </span>
<a href="#l16.63"></a><span id="l16.63">       &lt;method name=&quot;fitDummyRows&quot;&gt;</span>
<a href="#l16.64"></a><span id="l16.64">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l16.65"></a><span id="l16.65">           var self = this;</span>
<a href="#l16.66"></a><span id="l16.66">           var func = function attendees_list_fitDummyRows() {</span>
<a href="#l16.67"></a><span id="l16.67">               self.calcContentHeight();</span>
<a href="#l16.68"></a><span id="l16.68">               self.createOrRemoveDummyRows();</span>
<a href="#l16.69"></a><span id="l16.69" class="difflineminus">-          }</span>
<a href="#l16.70"></a><span id="l16.70" class="difflineplus">+          };</span>
<a href="#l16.71"></a><span id="l16.71">           setTimeout(func, 0);</span>
<a href="#l16.72"></a><span id="l16.72">         ]]&gt;&lt;/body&gt;</span>
<a href="#l16.73"></a><span id="l16.73">       &lt;/method&gt;</span>
<a href="#l16.74"></a><span id="l16.74"> </span>
<a href="#l16.75"></a><span id="l16.75">       &lt;method name=&quot;calcContentHeight&quot;&gt;</span>
<a href="#l16.76"></a><span id="l16.76">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l16.77"></a><span id="l16.77">           var listbox =</span>
<a href="#l16.78"></a><span id="l16.78">               document.getAnonymousElementByAttribute(</span>
<a href="#l16.79"></a><span id="l16.79" class="difflineat">@@ -910,17 +910,17 @@</span>
<a href="#l16.80"></a><span id="l16.80">                   if (aRow - 1 &gt;= (firstVisibleRow + numOfVisibleRows)) {</span>
<a href="#l16.81"></a><span id="l16.81">                       listbox.scrollToIndex(aRow - numOfVisibleRows);</span>
<a href="#l16.82"></a><span id="l16.82">                   }</span>
<a href="#l16.83"></a><span id="l16.83">               }</span>
<a href="#l16.84"></a><span id="l16.84">               var input =</span>
<a href="#l16.85"></a><span id="l16.85">                   document.getAnonymousElementByAttribute(</span>
<a href="#l16.86"></a><span id="l16.86">                       node, &quot;anonid&quot;, &quot;input&quot;);</span>
<a href="#l16.87"></a><span id="l16.87">               input.focus();</span>
<a href="#l16.88"></a><span id="l16.88" class="difflineminus">-          }</span>
<a href="#l16.89"></a><span id="l16.89" class="difflineplus">+          };</span>
<a href="#l16.90"></a><span id="l16.90">           setTimeout(set_focus, 0);</span>
<a href="#l16.91"></a><span id="l16.91">         ]]&gt;&lt;/body&gt;</span>
<a href="#l16.92"></a><span id="l16.92">       &lt;/method&gt;</span>
<a href="#l16.93"></a><span id="l16.93"> </span>
<a href="#l16.94"></a><span id="l16.94">       &lt;property name=&quot;firstVisibleRow&quot;&gt;</span>
<a href="#l16.95"></a><span id="l16.95">         &lt;getter&gt;&lt;![CDATA[</span>
<a href="#l16.96"></a><span id="l16.96">           var listbox =</span>
<a href="#l16.97"></a><span id="l16.97">               document.getAnonymousElementByAttribute(</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l17.1"></a><span id="l17.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml</span>
<a href="#l17.2"></a><span id="l17.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-freebusy.xml</span>
<a href="#l17.3"></a><span id="l17.3" class="difflineat">@@ -196,17 +196,17 @@</span>
<a href="#l17.4"></a><span id="l17.4">                       newNode.className += &quot; first-in-day&quot;;</span>
<a href="#l17.5"></a><span id="l17.5">                       first = false;</span>
<a href="#l17.6"></a><span id="l17.6">                   }</span>
<a href="#l17.7"></a><span id="l17.7">                   newNode.setAttribute(&quot;value&quot;, value);</span>
<a href="#l17.8"></a><span id="l17.8">                   hours.appendChild(newNode);</span>
<a href="#l17.9"></a><span id="l17.9">                   date.minute += step_in_minutes;</span>
<a href="#l17.10"></a><span id="l17.10"> </span>
<a href="#l17.11"></a><span id="l17.11">                   if (remain == 0) {</span>
<a href="#l17.12"></a><span id="l17.12" class="difflineminus">-                      newNode.className += &quot; last-in-day&quot;</span>
<a href="#l17.13"></a><span id="l17.13" class="difflineplus">+                      newNode.className += &quot; last-in-day&quot;;</span>
<a href="#l17.14"></a><span id="l17.14">                   }</span>
<a href="#l17.15"></a><span id="l17.15">               }</span>
<a href="#l17.16"></a><span id="l17.16">           }</span>
<a href="#l17.17"></a><span id="l17.17"> </span>
<a href="#l17.18"></a><span id="l17.18">           return val;</span>
<a href="#l17.19"></a><span id="l17.19">         ]]&gt;&lt;/setter&gt;</span>
<a href="#l17.20"></a><span id="l17.20">       &lt;/property&gt;</span>
<a href="#l17.21"></a><span id="l17.21">     &lt;/implementation&gt;</span>
<a href="#l17.22"></a><span id="l17.22" class="difflineat">@@ -724,17 +724,17 @@</span>
<a href="#l17.23"></a><span id="l17.23">                           first = false;</span>
<a href="#l17.24"></a><span id="l17.24">                       }</span>
<a href="#l17.25"></a><span id="l17.25"> </span>
<a href="#l17.26"></a><span id="l17.26">                       newNode.setAttribute(&quot;value&quot;, value);</span>
<a href="#l17.27"></a><span id="l17.27">                       hours.appendChild(newNode);</span>
<a href="#l17.28"></a><span id="l17.28">                       date.minute += step_in_minutes;</span>
<a href="#l17.29"></a><span id="l17.29"> </span>
<a href="#l17.30"></a><span id="l17.30">                       if (remain == 0) {</span>
<a href="#l17.31"></a><span id="l17.31" class="difflineminus">-                          newNode.className += &quot; last-in-day&quot;</span>
<a href="#l17.32"></a><span id="l17.32" class="difflineplus">+                          newNode.className += &quot; last-in-day&quot;;</span>
<a href="#l17.33"></a><span id="l17.33">                       }</span>
<a href="#l17.34"></a><span id="l17.34">                   }</span>
<a href="#l17.35"></a><span id="l17.35">                   date.hour = this.mStartHour;</span>
<a href="#l17.36"></a><span id="l17.36">                   date.day++;</span>
<a href="#l17.37"></a><span id="l17.37">                   remain = count;</span>
<a href="#l17.38"></a><span id="l17.38">               }</span>
<a href="#l17.39"></a><span id="l17.39">           }</span>
<a href="#l17.40"></a><span id="l17.40">         ]]&gt;&lt;/body&gt;</span>
<a href="#l17.41"></a><span id="l17.41" class="difflineat">@@ -1498,17 +1498,17 @@</span>
<a href="#l17.42"></a><span id="l17.42">       &lt;/method&gt;</span>
<a href="#l17.43"></a><span id="l17.43"> </span>
<a href="#l17.44"></a><span id="l17.44">       &lt;method name=&quot;fitDummyRows&quot;&gt;</span>
<a href="#l17.45"></a><span id="l17.45">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l17.46"></a><span id="l17.46">           var self = this;</span>
<a href="#l17.47"></a><span id="l17.47">           var func = function func() {</span>
<a href="#l17.48"></a><span id="l17.48">               self.calcContentHeight();</span>
<a href="#l17.49"></a><span id="l17.49">               self.createOrRemoveDummyRows();</span>
<a href="#l17.50"></a><span id="l17.50" class="difflineminus">-          }</span>
<a href="#l17.51"></a><span id="l17.51" class="difflineplus">+          };</span>
<a href="#l17.52"></a><span id="l17.52">           setTimeout(func, 0);</span>
<a href="#l17.53"></a><span id="l17.53">         ]]&gt;&lt;/body&gt;</span>
<a href="#l17.54"></a><span id="l17.54">       &lt;/method&gt;</span>
<a href="#l17.55"></a><span id="l17.55"> </span>
<a href="#l17.56"></a><span id="l17.56">       &lt;method name=&quot;calcContentHeight&quot;&gt;</span>
<a href="#l17.57"></a><span id="l17.57">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l17.58"></a><span id="l17.58">           var listbox =</span>
<a href="#l17.59"></a><span id="l17.59">               document.getAnonymousElementByAttribute(</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l18.1"></a><span id="l18.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml</span>
<a href="#l18.2"></a><span id="l18.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-recurrence-preview.xml</span>
<a href="#l18.3"></a><span id="l18.3" class="difflineat">@@ -110,17 +110,17 @@</span>
<a href="#l18.4"></a><span id="l18.4">           // Adjust rows</span>
<a href="#l18.5"></a><span id="l18.5">           while (numRows &lt; numVertical) {</span>
<a href="#l18.6"></a><span id="l18.6">               let newNode = row.cloneNode(true);</span>
<a href="#l18.7"></a><span id="l18.7">               rows.appendChild(newNode);</span>
<a href="#l18.8"></a><span id="l18.8">               numRows++;</span>
<a href="#l18.9"></a><span id="l18.9">           }</span>
<a href="#l18.10"></a><span id="l18.10">           while (numRows &gt; numVertical) {</span>
<a href="#l18.11"></a><span id="l18.11">               rows.firstChild.remove();</span>
<a href="#l18.12"></a><span id="l18.12" class="difflineminus">-              numRows--</span>
<a href="#l18.13"></a><span id="l18.13" class="difflineplus">+              numRows--;</span>
<a href="#l18.14"></a><span id="l18.14">           }</span>
<a href="#l18.15"></a><span id="l18.15"> </span>
<a href="#l18.16"></a><span id="l18.16">           // Adjust columns in the grid</span>
<a href="#l18.17"></a><span id="l18.17">           var column =</span>
<a href="#l18.18"></a><span id="l18.18">               document.getAnonymousElementByAttribute(</span>
<a href="#l18.19"></a><span id="l18.19">                   this, &quot;anonid&quot;, &quot;column&quot;);</span>
<a href="#l18.20"></a><span id="l18.20">           var columns = column.parentNode;</span>
<a href="#l18.21"></a><span id="l18.21">           while ((columns.childNodes.length - 1) &lt; numHorizontal) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l19.1"></a><span id="l19.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js</span>
<a href="#l19.2"></a><span id="l19.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-recurrence.js</span>
<a href="#l19.3"></a><span id="l19.3" class="difflineat">@@ -641,17 +641,17 @@ function checkUntilDate() {</span>
<a href="#l19.4"></a><span id="l19.4">         let callback = function() {</span>
<a href="#l19.5"></a><span id="l19.5">             // No warning when the dialog is being closed with the Cancel button.</span>
<a href="#l19.6"></a><span id="l19.6">             if (!checkUntilDate.warning) {</span>
<a href="#l19.7"></a><span id="l19.7">                 return;</span>
<a href="#l19.8"></a><span id="l19.8">             }</span>
<a href="#l19.9"></a><span id="l19.9">             Services.prompt.alert(null, document.title,</span>
<a href="#l19.10"></a><span id="l19.10">                                   cal.calGetString(&quot;calendar&quot;, &quot;warningUntilDateBeforeStart&quot;));</span>
<a href="#l19.11"></a><span id="l19.11">             checkUntilDate.warning = false;</span>
<a href="#l19.12"></a><span id="l19.12" class="difflineminus">-        }</span>
<a href="#l19.13"></a><span id="l19.13" class="difflineplus">+        };</span>
<a href="#l19.14"></a><span id="l19.14">         setTimeout(callback, 1);</span>
<a href="#l19.15"></a><span id="l19.15">     } else {</span>
<a href="#l19.16"></a><span id="l19.16">         gUntilDate = untilDate;</span>
<a href="#l19.17"></a><span id="l19.17">         updateRecurrenceControls();</span>
<a href="#l19.18"></a><span id="l19.18">     }</span>
<a href="#l19.19"></a><span id="l19.19"> }</span>
<a href="#l19.20"></a><span id="l19.20"> </span>
<a href="#l19.21"></a><span id="l19.21"> /**</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l20.1"></a><span id="l20.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-event-dialog-reminder.js</span>
<a href="#l20.2"></a><span id="l20.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-event-dialog-reminder.js</span>
<a href="#l20.3"></a><span id="l20.3" class="difflineat">@@ -375,17 +375,17 @@ function onNewReminder() {</span>
<a href="#l20.4"></a><span id="l20.4">     offset.minutes = alarmlen;</span>
<a href="#l20.5"></a><span id="l20.5">     offset.normalize();</span>
<a href="#l20.6"></a><span id="l20.6">     offset.isNegative = true;</span>
<a href="#l20.7"></a><span id="l20.7">     reminder.related = reminder.ALARM_RELATED_START;</span>
<a href="#l20.8"></a><span id="l20.8">     reminder.offset = offset;</span>
<a href="#l20.9"></a><span id="l20.9">     if (&quot;DISPLAY&quot; in allowedActionsMap) {</span>
<a href="#l20.10"></a><span id="l20.10">         reminder.action = &quot;DISPLAY&quot;;</span>
<a href="#l20.11"></a><span id="l20.11">     } else {</span>
<a href="#l20.12"></a><span id="l20.12" class="difflineminus">-        let calendar = window.arguments[0].calendar</span>
<a href="#l20.13"></a><span id="l20.13" class="difflineplus">+        let calendar = window.arguments[0].calendar;</span>
<a href="#l20.14"></a><span id="l20.14">         let actions = calendar.getProperty(&quot;capabilities.alarms.actionValues&quot;) || [];</span>
<a href="#l20.15"></a><span id="l20.15">         reminder.action = actions[0];</span>
<a href="#l20.16"></a><span id="l20.16">     }</span>
<a href="#l20.17"></a><span id="l20.17"> </span>
<a href="#l20.18"></a><span id="l20.18">     // Set up the listbox</span>
<a href="#l20.19"></a><span id="l20.19">     let listitem = setupListItem(null, reminder, window.arguments[0].item);</span>
<a href="#l20.20"></a><span id="l20.20">     listbox.appendChild(listitem);</span>
<a href="#l20.21"></a><span id="l20.21">     listbox.selectItem(listitem);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l21.1"></a><span id="l21.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-print-dialog.js</span>
<a href="#l21.2"></a><span id="l21.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-print-dialog.js</span>
<a href="#l21.3"></a><span id="l21.3" class="difflineat">@@ -143,17 +143,17 @@ function getPrintSettings(receiverFunc) </span>
<a href="#l21.4"></a><span id="l21.4">             },</span>
<a href="#l21.5"></a><span id="l21.5">             onGetResult:</span>
<a href="#l21.6"></a><span id="l21.6">             function onGetResult(aCalendar, aStatus, aItemType, aDetail, aCount, aItems) {</span>
<a href="#l21.7"></a><span id="l21.7">                 settings.eventList = settings.eventList.concat(aItems);</span>
<a href="#l21.8"></a><span id="l21.8">                 if (!settings.printTasksWithNoDueDate) {</span>
<a href="#l21.9"></a><span id="l21.9">                     eventWithDueDate = [];</span>
<a href="#l21.10"></a><span id="l21.10">                     for (var item of settings.eventList) {</span>
<a href="#l21.11"></a><span id="l21.11">                         if (item.dueDate || item.endDate) {</span>
<a href="#l21.12"></a><span id="l21.12" class="difflineminus">-                            eventWithDueDate.push(item)</span>
<a href="#l21.13"></a><span id="l21.13" class="difflineplus">+                            eventWithDueDate.push(item);</span>
<a href="#l21.14"></a><span id="l21.14">                         }</span>
<a href="#l21.15"></a><span id="l21.15">                     }</span>
<a href="#l21.16"></a><span id="l21.16">                     settings.eventList = eventWithDueDate;</span>
<a href="#l21.17"></a><span id="l21.17">                 }</span>
<a href="#l21.18"></a><span id="l21.18">             }</span>
<a href="#l21.19"></a><span id="l21.19">         };</span>
<a href="#l21.20"></a><span id="l21.20">         let filter = getFilter(settings);</span>
<a href="#l21.21"></a><span id="l21.21">         if (filter) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l22.1"></a><span id="l22.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-properties-dialog.js</span>
<a href="#l22.2"></a><span id="l22.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-properties-dialog.js</span>
<a href="#l22.3"></a><span id="l22.3" class="difflineat">@@ -25,17 +25,17 @@ function onLoad() {</span>
<a href="#l22.4"></a><span id="l22.4">     document.getElementById(&quot;read-only&quot;).checked = gCalendar.readOnly;</span>
<a href="#l22.5"></a><span id="l22.5"> </span>
<a href="#l22.6"></a><span id="l22.6">     // Set up refresh interval</span>
<a href="#l22.7"></a><span id="l22.7">     initRefreshInterval();</span>
<a href="#l22.8"></a><span id="l22.8"> </span>
<a href="#l22.9"></a><span id="l22.9">     // Set up the cache field</span>
<a href="#l22.10"></a><span id="l22.10">     let cacheBox = document.getElementById(&quot;cache&quot;);</span>
<a href="#l22.11"></a><span id="l22.11">     let canCache = (gCalendar.getProperty(&quot;cache.supported&quot;) !== false);</span>
<a href="#l22.12"></a><span id="l22.12" class="difflineminus">-    let alwaysCache = (gCalendar.getProperty(&quot;cache.always&quot;))</span>
<a href="#l22.13"></a><span id="l22.13" class="difflineplus">+    let alwaysCache = (gCalendar.getProperty(&quot;cache.always&quot;));</span>
<a href="#l22.14"></a><span id="l22.14">     if (!canCache || alwaysCache) {</span>
<a href="#l22.15"></a><span id="l22.15">         cacheBox.setAttribute(&quot;disable-capability&quot;, &quot;true&quot;);</span>
<a href="#l22.16"></a><span id="l22.16">         cacheBox.hidden = true;</span>
<a href="#l22.17"></a><span id="l22.17">         cacheBox.disabled = true;</span>
<a href="#l22.18"></a><span id="l22.18">     }</span>
<a href="#l22.19"></a><span id="l22.19">     cacheBox.checked = (alwaysCache || (canCache &amp;&amp; gCalendar.getProperty(&quot;cache.enabled&quot;)));</span>
<a href="#l22.20"></a><span id="l22.20"> </span>
<a href="#l22.21"></a><span id="l22.21">     // Set up the show alarms row and checkbox</span>
<a href="#l22.22"></a><span id="l22.22" class="difflineat">@@ -86,17 +86,17 @@ function onAcceptDialog() {</span>
<a href="#l22.23"></a><span id="l22.23"> </span>
<a href="#l22.24"></a><span id="l22.24">     // Save refresh interval</span>
<a href="#l22.25"></a><span id="l22.25">     if (gCalendar.canRefresh) {</span>
<a href="#l22.26"></a><span id="l22.26">         let value = getElementValue(&quot;calendar-refreshInterval-menulist&quot;);</span>
<a href="#l22.27"></a><span id="l22.27">         gCalendar.setProperty(&quot;refreshInterval&quot;, value);</span>
<a href="#l22.28"></a><span id="l22.28">     }</span>
<a href="#l22.29"></a><span id="l22.29"> </span>
<a href="#l22.30"></a><span id="l22.30">     // Save cache options</span>
<a href="#l22.31"></a><span id="l22.31" class="difflineminus">-    let alwaysCache = (gCalendar.getProperty(&quot;cache.always&quot;))</span>
<a href="#l22.32"></a><span id="l22.32" class="difflineplus">+    let alwaysCache = (gCalendar.getProperty(&quot;cache.always&quot;));</span>
<a href="#l22.33"></a><span id="l22.33">     if (!alwaysCache) {</span>
<a href="#l22.34"></a><span id="l22.34">         gCalendar.setProperty(&quot;cache.enabled&quot;, document.getElementById(&quot;cache&quot;).checked);</span>
<a href="#l22.35"></a><span id="l22.35">     }</span>
<a href="#l22.36"></a><span id="l22.36"> </span>
<a href="#l22.37"></a><span id="l22.37">     if (!gCalendar.getProperty(&quot;force-disabled&quot;)) {</span>
<a href="#l22.38"></a><span id="l22.38">         // Save disabled option (should do this last), remove auto-enabled</span>
<a href="#l22.39"></a><span id="l22.39">         gCalendar.setProperty(&quot;disabled&quot;, !document.getElementById(&quot;calendar-enabled-checkbox&quot;).checked);</span>
<a href="#l22.40"></a><span id="l22.40">         gCalendar.deleteProperty(&quot;auto-enabled&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l23.1"></a><span id="l23.1" class="difflineminus">--- a/calendar/base/content/dialogs/calendar-summary-dialog.js</span>
<a href="#l23.2"></a><span id="l23.2" class="difflineplus">+++ b/calendar/base/content/dialogs/calendar-summary-dialog.js</span>
<a href="#l23.3"></a><span id="l23.3" class="difflineat">@@ -330,17 +330,17 @@ function updateReminder() {</span>
<a href="#l23.4"></a><span id="l23.4"> /**</span>
<a href="#l23.5"></a><span id="l23.5">  * Browse the item's attached URL.</span>
<a href="#l23.6"></a><span id="l23.6">  *</span>
<a href="#l23.7"></a><span id="l23.7">  * XXX This function is broken, should be fixed in bug 471967</span>
<a href="#l23.8"></a><span id="l23.8">  */</span>
<a href="#l23.9"></a><span id="l23.9"> function browseDocument() {</span>
<a href="#l23.10"></a><span id="l23.10">     var args = window.arguments[0];</span>
<a href="#l23.11"></a><span id="l23.11">     var item = args.calendarEvent;</span>
<a href="#l23.12"></a><span id="l23.12" class="difflineminus">-    var url = item.getProperty(&quot;URL&quot;)</span>
<a href="#l23.13"></a><span id="l23.13" class="difflineplus">+    var url = item.getProperty(&quot;URL&quot;);</span>
<a href="#l23.14"></a><span id="l23.14">     launchBrowser(url);</span>
<a href="#l23.15"></a><span id="l23.15"> }</span>
<a href="#l23.16"></a><span id="l23.16"> </span>
<a href="#l23.17"></a><span id="l23.17"> /**</span>
<a href="#l23.18"></a><span id="l23.18">  * Extracts the item's organizer and opens a compose window to send the</span>
<a href="#l23.19"></a><span id="l23.19">  * organizer an email.</span>
<a href="#l23.20"></a><span id="l23.20">  */</span>
<a href="#l23.21"></a><span id="l23.21"> function sendMailToOrganizer() {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l24.1"></a><span id="l24.1" class="difflineminus">--- a/calendar/base/content/import-export.js</span>
<a href="#l24.2"></a><span id="l24.2" class="difflineplus">+++ b/calendar/base/content/import-export.js</span>
<a href="#l24.3"></a><span id="l24.3" class="difflineat">@@ -169,17 +169,17 @@ function putItemsIntoCal(destCal, aItems</span>
<a href="#l24.4"></a><span id="l24.4">                 destCal.endBatch();</span>
<a href="#l24.5"></a><span id="l24.5">                 if (!failedCount &amp;&amp; duplicateCount) {</span>
<a href="#l24.6"></a><span id="l24.6">                     showError(calGetString(&quot;calendar&quot;, &quot;duplicateError&quot;, [duplicateCount, aFilePath]));</span>
<a href="#l24.7"></a><span id="l24.7">                 } else if (failedCount) {</span>
<a href="#l24.8"></a><span id="l24.8">                     showError(calGetString(&quot;calendar&quot;, &quot;importItemsFailed&quot;, [failedCount, lastError.toString()]));</span>
<a href="#l24.9"></a><span id="l24.9">                 }</span>
<a href="#l24.10"></a><span id="l24.10">             }</span>
<a href="#l24.11"></a><span id="l24.11">         }</span>
<a href="#l24.12"></a><span id="l24.12" class="difflineminus">-    }</span>
<a href="#l24.13"></a><span id="l24.13" class="difflineplus">+    };</span>
<a href="#l24.14"></a><span id="l24.14"> </span>
<a href="#l24.15"></a><span id="l24.15">     for (let item of aItems) {</span>
<a href="#l24.16"></a><span id="l24.16">         // XXX prompt when finding a duplicate.</span>
<a href="#l24.17"></a><span id="l24.17">         try {</span>
<a href="#l24.18"></a><span id="l24.18">             destCal.addItem(item, listener);</span>
<a href="#l24.19"></a><span id="l24.19">         } catch (e) {</span>
<a href="#l24.20"></a><span id="l24.20">             failedCount++;</span>
<a href="#l24.21"></a><span id="l24.21">             lastError = e;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l25.1"></a><span id="l25.1" class="difflineminus">--- a/calendar/base/content/preferences/categories.js</span>
<a href="#l25.2"></a><span id="l25.2" class="difflineplus">+++ b/calendar/base/content/preferences/categories.js</span>
<a href="#l25.3"></a><span id="l25.3" class="difflineat">@@ -247,17 +247,17 @@ var gCategoriesPane = {</span>
<a href="#l25.4"></a><span id="l25.4">     },</span>
<a href="#l25.5"></a><span id="l25.5"> </span>
<a href="#l25.6"></a><span id="l25.6">     /**</span>
<a href="#l25.7"></a><span id="l25.7">      * Enable the edit and delete category buttons.</span>
<a href="#l25.8"></a><span id="l25.8">      */</span>
<a href="#l25.9"></a><span id="l25.9">     updateButtons: function gCP_updateButtons() {</span>
<a href="#l25.10"></a><span id="l25.10">         let categoriesList = document.getElementById(&quot;categorieslist&quot;);</span>
<a href="#l25.11"></a><span id="l25.11">         document.getElementById(&quot;deleteCButton&quot;).disabled = (categoriesList.selectedCount &lt;= 0);</span>
<a href="#l25.12"></a><span id="l25.12" class="difflineminus">-        document.getElementById(&quot;editCButton&quot;).disabled = (categoriesList.selectedCount != 1)</span>
<a href="#l25.13"></a><span id="l25.13" class="difflineplus">+        document.getElementById(&quot;editCButton&quot;).disabled = (categoriesList.selectedCount != 1);</span>
<a href="#l25.14"></a><span id="l25.14">     },</span>
<a href="#l25.15"></a><span id="l25.15"> </span>
<a href="#l25.16"></a><span id="l25.16">     /**</span>
<a href="#l25.17"></a><span id="l25.17">      * Backs up the category name in case the dialog is canceled.</span>
<a href="#l25.18"></a><span id="l25.18">      *</span>
<a href="#l25.19"></a><span id="l25.19">      * @see formatStringForCSSRule</span>
<a href="#l25.20"></a><span id="l25.20">      * @param categoryNameFix     The formatted category name.</span>
<a href="#l25.21"></a><span id="l25.21">      */</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l26.1"></a><span id="l26.1" class="difflineminus">--- a/calendar/base/content/widgets/calendar-list-tree.xml</span>
<a href="#l26.2"></a><span id="l26.2" class="difflineplus">+++ b/calendar/base/content/widgets/calendar-list-tree.xml</span>
<a href="#l26.3"></a><span id="l26.3" class="difflineat">@@ -397,17 +397,17 @@</span>
<a href="#l26.4"></a><span id="l26.4">       &lt;method name=&quot;sortOrderChanged&quot;&gt;</span>
<a href="#l26.5"></a><span id="l26.5">         &lt;parameter name=&quot;&quot;/&gt;</span>
<a href="#l26.6"></a><span id="l26.6">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l26.7"></a><span id="l26.7">           if (this.mAddingFromComposite) {</span>
<a href="#l26.8"></a><span id="l26.8">               return;</span>
<a href="#l26.9"></a><span id="l26.9">           }</span>
<a href="#l26.10"></a><span id="l26.10">           let event = document.createEvent('Events');</span>
<a href="#l26.11"></a><span id="l26.11">           event.initEvent(&quot;SortOrderChanged&quot;, true, false);</span>
<a href="#l26.12"></a><span id="l26.12" class="difflineminus">-          event.sortOrder = this.sortOrder</span>
<a href="#l26.13"></a><span id="l26.13" class="difflineplus">+          event.sortOrder = this.sortOrder;</span>
<a href="#l26.14"></a><span id="l26.14">           this.dispatchEvent(event);</span>
<a href="#l26.15"></a><span id="l26.15"> </span>
<a href="#l26.16"></a><span id="l26.16">           let handler = this.getAttribute(&quot;onSortOrderChanged&quot;);</span>
<a href="#l26.17"></a><span id="l26.17">           if (handler) {</span>
<a href="#l26.18"></a><span id="l26.18">               // Call the given code in a function</span>
<a href="#l26.19"></a><span id="l26.19">               (new Function(&quot;event&quot;, handler))(event);</span>
<a href="#l26.20"></a><span id="l26.20">           }</span>
<a href="#l26.21"></a><span id="l26.21">         ]]&gt;&lt;/body&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l27.1"></a><span id="l27.1" class="difflineminus">--- a/calendar/base/content/widgets/calendar-widgets.xml</span>
<a href="#l27.2"></a><span id="l27.2" class="difflineplus">+++ b/calendar/base/content/widgets/calendar-widgets.xml</span>
<a href="#l27.3"></a><span id="l27.3" class="difflineat">@@ -377,17 +377,17 @@</span>
<a href="#l27.4"></a><span id="l27.4">         ]]&gt;&lt;/body&gt;</span>
<a href="#l27.5"></a><span id="l27.5">       &lt;/method&gt;</span>
<a href="#l27.6"></a><span id="l27.6"> </span>
<a href="#l27.7"></a><span id="l27.7">       &lt;method name=&quot;setVisible&quot;&gt;</span>
<a href="#l27.8"></a><span id="l27.8">         &lt;parameter name=&quot;aVisible&quot;/&gt;</span>
<a href="#l27.9"></a><span id="l27.9">         &lt;parameter name=&quot;aPushModeCollapsedAttribute&quot;/&gt;</span>
<a href="#l27.10"></a><span id="l27.10">         &lt;parameter name=&quot;aNotifyRefControl&quot;/&gt;</span>
<a href="#l27.11"></a><span id="l27.11">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l27.12"></a><span id="l27.12" class="difflineminus">-            var notifyRefControl = ((aNotifyRefControl == null) || (aNotifyRefControl === true))</span>
<a href="#l27.13"></a><span id="l27.13" class="difflineplus">+            var notifyRefControl = ((aNotifyRefControl == null) || (aNotifyRefControl === true));</span>
<a href="#l27.14"></a><span id="l27.14">             var pushModeCollapsedAttribute = ((aPushModeCollapsedAttribute == null)</span>
<a href="#l27.15"></a><span id="l27.15">                                                  || (aPushModeCollapsedAttribute === true));</span>
<a href="#l27.16"></a><span id="l27.16">             var collapsedModes = [];</span>
<a href="#l27.17"></a><span id="l27.17">             var modeIndex = -1;</span>
<a href="#l27.18"></a><span id="l27.18">             var display = aVisible;</span>
<a href="#l27.19"></a><span id="l27.19">             var collapsedInMode = false;</span>
<a href="#l27.20"></a><span id="l27.20">             if (this.hasAttribute(&quot;collapsedinmodes&quot;)) {</span>
<a href="#l27.21"></a><span id="l27.21">                 collapsedModes = this.getAttribute(&quot;collapsedinmodes&quot;).split(&quot;,&quot;);</span>
<a href="#l27.22"></a><span id="l27.22" class="difflineat">@@ -418,17 +418,17 @@</span>
<a href="#l27.23"></a><span id="l27.23">                 this.setAttribute(&quot;collapsedinmodes&quot;, collapsedModes.join(&quot;,&quot;));</span>
<a href="#l27.24"></a><span id="l27.24">                 var id = this.getAttribute(&quot;id&quot;);</span>
<a href="#l27.25"></a><span id="l27.25">                 if (id) {</span>
<a href="#l27.26"></a><span id="l27.26">                     document.persist(id, &quot;collapsedinmodes&quot;);</span>
<a href="#l27.27"></a><span id="l27.27">                 }</span>
<a href="#l27.28"></a><span id="l27.28">             }</span>
<a href="#l27.29"></a><span id="l27.29">             if (notifyRefControl === true) {</span>
<a href="#l27.30"></a><span id="l27.30">                 if (this.hasAttribute(&quot;refcontrol&quot;)) {</span>
<a href="#l27.31"></a><span id="l27.31" class="difflineminus">-                    var command = document.getElementById(this.getAttribute(&quot;refcontrol&quot;))</span>
<a href="#l27.32"></a><span id="l27.32" class="difflineplus">+                    var command = document.getElementById(this.getAttribute(&quot;refcontrol&quot;));</span>
<a href="#l27.33"></a><span id="l27.33">                     if (command) {</span>
<a href="#l27.34"></a><span id="l27.34">                         command.setAttribute(&quot;checked&quot;, display);</span>
<a href="#l27.35"></a><span id="l27.35">                         setBooleanAttribute(command, &quot;disabled&quot;, !this.isVisibleInMode());</span>
<a href="#l27.36"></a><span id="l27.36">                     }</span>
<a href="#l27.37"></a><span id="l27.37">                 }</span>
<a href="#l27.38"></a><span id="l27.38">             }</span>
<a href="#l27.39"></a><span id="l27.39">         ]]&gt;&lt;/body&gt;</span>
<a href="#l27.40"></a><span id="l27.40">       &lt;/method&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l28.1"></a><span id="l28.1" class="difflineminus">--- a/calendar/base/content/widgets/minimonth.xml</span>
<a href="#l28.2"></a><span id="l28.2" class="difflineplus">+++ b/calendar/base/content/widgets/minimonth.xml</span>
<a href="#l28.3"></a><span id="l28.3" class="difflineat">@@ -288,17 +288,17 @@</span>
<a href="#l28.4"></a><span id="l28.4">     &lt;handlers&gt;</span>
<a href="#l28.5"></a><span id="l28.5">       &lt;handler event=&quot;bindingattached&quot; action=&quot;this.initialize();&quot;/&gt;</span>
<a href="#l28.6"></a><span id="l28.6">       &lt;!-- handle click from nested months popup and years popup --&gt;</span>
<a href="#l28.7"></a><span id="l28.7">       &lt;handler event=&quot;click&quot;&gt;</span>
<a href="#l28.8"></a><span id="l28.8">         &lt;![CDATA[</span>
<a href="#l28.9"></a><span id="l28.9">           let element = event.originalTarget;</span>
<a href="#l28.10"></a><span id="l28.10">           let popup = getParentNodeOrThis(element, &quot;menupopup&quot;);</span>
<a href="#l28.11"></a><span id="l28.11">           if (popup) {</span>
<a href="#l28.12"></a><span id="l28.12" class="difflineminus">-              let anonid = popup.getAttribute(&quot;anonid&quot;)</span>
<a href="#l28.13"></a><span id="l28.13" class="difflineplus">+              let anonid = popup.getAttribute(&quot;anonid&quot;);</span>
<a href="#l28.14"></a><span id="l28.14">               switch (anonid) {</span>
<a href="#l28.15"></a><span id="l28.15">                   case &quot;months-popup&quot;:</span>
<a href="#l28.16"></a><span id="l28.16">                       this.hidePopupList();</span>
<a href="#l28.17"></a><span id="l28.17">                       this.kMinimonth.switchMonth(element.getAttribute(&quot;index&quot;));</span>
<a href="#l28.18"></a><span id="l28.18">                       break;</span>
<a href="#l28.19"></a><span id="l28.19">                   case &quot;years-popup&quot;:</span>
<a href="#l28.20"></a><span id="l28.20">                       this.hidePopupList();</span>
<a href="#l28.21"></a><span id="l28.21">                       let value = element.getAttribute(&quot;value&quot;);</span>
<a href="#l28.22"></a><span id="l28.22" class="difflineat">@@ -432,17 +432,17 @@</span>
<a href="#l28.23"></a><span id="l28.23">       &lt;field name=&quot;mShowWeekNumber&quot;&gt;true&lt;/field&gt;</span>
<a href="#l28.24"></a><span id="l28.24">       &lt;constructor&gt;&lt;![CDATA[</span>
<a href="#l28.25"></a><span id="l28.25">           Components.utils.import(&quot;resource://gre/modules/Services.jsm&quot;);</span>
<a href="#l28.26"></a><span id="l28.26">           Components.utils.import(&quot;resource://gre/modules/Preferences.jsm&quot;);</span>
<a href="#l28.27"></a><span id="l28.27"> </span>
<a href="#l28.28"></a><span id="l28.28">           this.mToday = false;</span>
<a href="#l28.29"></a><span id="l28.29">           this.mSelected = false;</span>
<a href="#l28.30"></a><span id="l28.30">           this.mExtra = false;</span>
<a href="#l28.31"></a><span id="l28.31" class="difflineminus">-          this.mValue = new Date() // Default to &quot;today&quot;</span>
<a href="#l28.32"></a><span id="l28.32" class="difflineplus">+          this.mValue = new Date(); // Default to &quot;today&quot;</span>
<a href="#l28.33"></a><span id="l28.33">           // save references for convenience</span>
<a href="#l28.34"></a><span id="l28.34">           if (this.hasAttribute(&quot;readonly&quot;)) {</span>
<a href="#l28.35"></a><span id="l28.35">               this.mIsReadOnly = this.getAttribute(&quot;readonly&quot;) == &quot;true&quot;;</span>
<a href="#l28.36"></a><span id="l28.36">           }</span>
<a href="#l28.37"></a><span id="l28.37">           this.refreshDisplay();</span>
<a href="#l28.38"></a><span id="l28.38">           if (this.hasAttribute(&quot;freebusy&quot;)) {</span>
<a href="#l28.39"></a><span id="l28.39">               this._setFreeBusy(this.getAttribute(&quot;freebusy&quot;) == &quot;true&quot;);</span>
<a href="#l28.40"></a><span id="l28.40">           }</span>
<a href="#l28.41"></a><span id="l28.41" class="difflineat">@@ -774,17 +774,17 @@</span>
<a href="#l28.42"></a><span id="l28.42">                   for (j = 0; j &lt; dayList.length; j++) {</span>
<a href="#l28.43"></a><span id="l28.43">                       if (i != j) {</span>
<a href="#l28.44"></a><span id="l28.44">                           if (dayList[i].substring(0, 1) == dayList[j].substring(0, 1)) {</span>
<a href="#l28.45"></a><span id="l28.45">                               foundMatch = 2;</span>
<a href="#l28.46"></a><span id="l28.46">                               break;</span>
<a href="#l28.47"></a><span id="l28.47">                           }</span>
<a href="#l28.48"></a><span id="l28.48">                       }</span>
<a href="#l28.49"></a><span id="l28.49">                   }</span>
<a href="#l28.50"></a><span id="l28.50" class="difflineminus">-                  dayList[i] = dayList[i].substring(0, foundMatch)</span>
<a href="#l28.51"></a><span id="l28.51" class="difflineplus">+                  dayList[i] = dayList[i].substring(0, foundMatch);</span>
<a href="#l28.52"></a><span id="l28.52">               }</span>
<a href="#l28.53"></a><span id="l28.53">           }</span>
<a href="#l28.54"></a><span id="l28.54"> </span>
<a href="#l28.55"></a><span id="l28.55">           setBooleanAttribute(header.childNodes[0], &quot;hidden&quot;, !this.mShowWeekNumber);</span>
<a href="#l28.56"></a><span id="l28.56">           for (var column = 1; column &lt; header.childNodes.length; column++) {</span>
<a href="#l28.57"></a><span id="l28.57">               header.childNodes[column].setAttribute(&quot;value&quot;, dayList[column - 1]);</span>
<a href="#l28.58"></a><span id="l28.58">           }</span>
<a href="#l28.59"></a><span id="l28.59">         ]]&gt;&lt;/body&gt;</span>
<a href="#l28.60"></a><span id="l28.60" class="difflineat">@@ -966,17 +966,17 @@</span>
<a href="#l28.61"></a><span id="l28.61">       &lt;/method&gt;</span>
<a href="#l28.62"></a><span id="l28.62">       &lt;method name=&quot;_setFreeBusy&quot;&gt;</span>
<a href="#l28.63"></a><span id="l28.63">         &lt;parameter name=&quot;aFreeBusy&quot;/&gt;</span>
<a href="#l28.64"></a><span id="l28.64">         &lt;body&gt;&lt;![CDATA[</span>
<a href="#l28.65"></a><span id="l28.65">             if (aFreeBusy == true) {</span>
<a href="#l28.66"></a><span id="l28.66">                 if (this.mObservesComposite == false) {</span>
<a href="#l28.67"></a><span id="l28.67">                     getCompositeCalendar().addObserver(this);</span>
<a href="#l28.68"></a><span id="l28.68">                     this.mObservesComposite = true;</span>
<a href="#l28.69"></a><span id="l28.69" class="difflineminus">-                    this.getItems()</span>
<a href="#l28.70"></a><span id="l28.70" class="difflineplus">+                    this.getItems();</span>
<a href="#l28.71"></a><span id="l28.71">                  }</span>
<a href="#l28.72"></a><span id="l28.72">             } else {</span>
<a href="#l28.73"></a><span id="l28.73">                 if (this.mObservesComposite == true) {</span>
<a href="#l28.74"></a><span id="l28.74">                     getCompositeCalendar().removeObserver(this);</span>
<a href="#l28.75"></a><span id="l28.75">                     this.mObservesComposite = false;</span>
<a href="#l28.76"></a><span id="l28.76">                  }</span>
<a href="#l28.77"></a><span id="l28.77">             }</span>
<a href="#l28.78"></a><span id="l28.78">         ]]&gt;&lt;/body&gt;</span>
<a href="#l28.79"></a><span id="l28.79" class="difflineat">@@ -1189,14 +1189,14 @@</span>
<a href="#l28.80"></a><span id="l28.80">     &lt;/handlers&gt;</span>
<a href="#l28.81"></a><span id="l28.81">   &lt;/binding&gt;</span>
<a href="#l28.82"></a><span id="l28.82"> </span>
<a href="#l28.83"></a><span id="l28.83">   &lt;binding id=&quot;minimonth-day&quot; extends=&quot;xul:text&quot;&gt;</span>
<a href="#l28.84"></a><span id="l28.84">     &lt;handlers&gt;</span>
<a href="#l28.85"></a><span id="l28.85">       &lt;handler event=&quot;click&quot; button=&quot;0&quot;&gt;&lt;![CDATA[</span>
<a href="#l28.86"></a><span id="l28.86">         if (this.minimonthParent.getAttribute(&quot;readonly&quot;) != &quot;true&quot;) {</span>
<a href="#l28.87"></a><span id="l28.87">             this.setAttribute(&quot;selected&quot;, &quot;true&quot;);</span>
<a href="#l28.88"></a><span id="l28.88" class="difflineminus">-            this.minimonthParent.onSelectDay(this)</span>
<a href="#l28.89"></a><span id="l28.89" class="difflineplus">+            this.minimonthParent.onSelectDay(this);</span>
<a href="#l28.90"></a><span id="l28.90">         }</span>
<a href="#l28.91"></a><span id="l28.91">       ]]&gt;&lt;/handler&gt;</span>
<a href="#l28.92"></a><span id="l28.92">     &lt;/handlers&gt;</span>
<a href="#l28.93"></a><span id="l28.93">   &lt;/binding&gt;</span>
<a href="#l28.94"></a><span id="l28.94"> &lt;/bindings&gt;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l29.1"></a><span id="l29.1" class="difflineminus">--- a/calendar/base/modules/calAsyncUtils.jsm</span>
<a href="#l29.2"></a><span id="l29.2" class="difflineplus">+++ b/calendar/base/modules/calAsyncUtils.jsm</span>
<a href="#l29.3"></a><span id="l29.3" class="difflineat">@@ -104,25 +104,25 @@ cal.async = {</span>
<a href="#l29.4"></a><span id="l29.4">                 } else {</span>
<a href="#l29.5"></a><span id="l29.5">                     this.itemSuccess = aStatus;</span>
<a href="#l29.6"></a><span id="l29.6">                 }</span>
<a href="#l29.7"></a><span id="l29.7">             },</span>
<a href="#l29.8"></a><span id="l29.8"> </span>
<a href="#l29.9"></a><span id="l29.9">             onOperationComplete: function(aCalendar, aStatus, aOpType, aId, aDetail) {</span>
<a href="#l29.10"></a><span id="l29.10">                 if (!Components.isSuccessCode(aStatus)) {</span>
<a href="#l29.11"></a><span id="l29.11">                     // This function has failed, reject with the status</span>
<a href="#l29.12"></a><span id="l29.12" class="difflineminus">-                    deferred.reject(aStatus)</span>
<a href="#l29.13"></a><span id="l29.13" class="difflineplus">+                    deferred.reject(aStatus);</span>
<a href="#l29.14"></a><span id="l29.14">                 } else if (!Components.isSuccessCode(this.itemStatus)) {</span>
<a href="#l29.15"></a><span id="l29.15">                     // onGetResult has failed, reject with its status</span>
<a href="#l29.16"></a><span id="l29.16">                     deferred.reject(this.itemStatus);</span>
<a href="#l29.17"></a><span id="l29.17">                 } else if (aOpType == cIOL.GET) {</span>
<a href="#l29.18"></a><span id="l29.18">                      // Success of a GET operation: resolve with array of</span>
<a href="#l29.19"></a><span id="l29.19">                      // resulting items.</span>
<a href="#l29.20"></a><span id="l29.20">                     deferred.resolve(this.items);</span>
<a href="#l29.21"></a><span id="l29.21">                 } else { /* ADD,MODIFY,DELETE: resolve with 1 item */</span>
<a href="#l29.22"></a><span id="l29.22">                     // Success of an ADD MODIFY or DELETE operation, resolve</span>
<a href="#l29.23"></a><span id="l29.23">                     // with the one item that was processed.</span>
<a href="#l29.24"></a><span id="l29.24" class="difflineminus">-                    deferred.resolve(aDetail)</span>
<a href="#l29.25"></a><span id="l29.25" class="difflineplus">+                    deferred.resolve(aDetail);</span>
<a href="#l29.26"></a><span id="l29.26">                 }</span>
<a href="#l29.27"></a><span id="l29.27">             }</span>
<a href="#l29.28"></a><span id="l29.28" class="difflineminus">-        }</span>
<a href="#l29.29"></a><span id="l29.29" class="difflineplus">+        };</span>
<a href="#l29.30"></a><span id="l29.30">     }</span>
<a href="#l29.31"></a><span id="l29.31"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l30.1"></a><span id="l30.1" class="difflineminus">--- a/calendar/base/modules/calExtract.jsm</span>
<a href="#l30.2"></a><span id="l30.2" class="difflineplus">+++ b/calendar/base/modules/calExtract.jsm</span>
<a href="#l30.3"></a><span id="l30.3" class="difflineat">@@ -44,17 +44,17 @@ function Extractor(fallbackLocale, daySt</span>
<a href="#l30.4"></a><span id="l30.4">     }</span>
<a href="#l30.5"></a><span id="l30.5"> </span>
<a href="#l30.6"></a><span id="l30.6">     if (fixedLang != null) {</span>
<a href="#l30.7"></a><span id="l30.7">         this.fixedLang = fixedLang;</span>
<a href="#l30.8"></a><span id="l30.8">     }</span>
<a href="#l30.9"></a><span id="l30.9"> </span>
<a href="#l30.10"></a><span id="l30.10">     if (!this.checkBundle(fallbackLocale)) {</span>
<a href="#l30.11"></a><span id="l30.11">         this.bundleUrl = this.packagedUrl;</span>
<a href="#l30.12"></a><span id="l30.12" class="difflineminus">-        cal.WARN(&quot;Your installed Lightning only includes a single locale, extracting event info from other languages is likely inaccurate. You can install Lightning from addons.mozilla.org manually for multiple locale support.&quot;)</span>
<a href="#l30.13"></a><span id="l30.13" class="difflineplus">+        cal.WARN(&quot;Your installed Lightning only includes a single locale, extracting event info from other languages is likely inaccurate. You can install Lightning from addons.mozilla.org manually for multiple locale support.&quot;);</span>
<a href="#l30.14"></a><span id="l30.14">     }</span>
<a href="#l30.15"></a><span id="l30.15"> }</span>
<a href="#l30.16"></a><span id="l30.16"> </span>
<a href="#l30.17"></a><span id="l30.17"> Extractor.prototype = {</span>
<a href="#l30.18"></a><span id="l30.18">     /**</span>
<a href="#l30.19"></a><span id="l30.19">     * Removes confusing data like urls, timezones and phone numbers from email</span>
<a href="#l30.20"></a><span id="l30.20">     * Also removes standard signatures and quoted content from previous emails</span>
<a href="#l30.21"></a><span id="l30.21">     */</span>
<a href="#l30.22"></a><span id="l30.22" class="difflineat">@@ -763,17 +763,17 @@ Extractor.prototype = {</span>
<a href="#l30.23"></a><span id="l30.23">                     return rc;</span>
<a href="#l30.24"></a><span id="l30.24">                 }</span>
<a href="#l30.25"></a><span id="l30.25">             }</span>
<a href="#l30.26"></a><span id="l30.26">         } else {</span>
<a href="#l30.27"></a><span id="l30.27">             rc = (one.hour &gt; two.hour) - (one.hour &lt; two.hour);</span>
<a href="#l30.28"></a><span id="l30.28">             if (rc != 0) {</span>
<a href="#l30.29"></a><span id="l30.29">                 return rc;</span>
<a href="#l30.30"></a><span id="l30.30">             } else {</span>
<a href="#l30.31"></a><span id="l30.31" class="difflineminus">-                rc = (one.minute &gt; two.minute) - (one.minute &lt; two.minute)</span>
<a href="#l30.32"></a><span id="l30.32" class="difflineplus">+                rc = (one.minute &gt; two.minute) - (one.minute &lt; two.minute);</span>
<a href="#l30.33"></a><span id="l30.33">                 return rc;</span>
<a href="#l30.34"></a><span id="l30.34">             }</span>
<a href="#l30.35"></a><span id="l30.35">         }</span>
<a href="#l30.36"></a><span id="l30.36">     },</span>
<a href="#l30.37"></a><span id="l30.37"> </span>
<a href="#l30.38"></a><span id="l30.38">     /**</span>
<a href="#l30.39"></a><span id="l30.39">     * Guesses start time from list of guessed datetimes</span>
<a href="#l30.40"></a><span id="l30.40">     *</span>
<a href="#l30.41"></a><span id="l30.41" class="difflineat">@@ -946,17 +946,17 @@ Extractor.prototype = {</span>
<a href="#l30.42"></a><span id="l30.42">                         startDate.setMinutes(0);</span>
<a href="#l30.43"></a><span id="l30.43">                     }</span>
<a href="#l30.44"></a><span id="l30.44"> </span>
<a href="#l30.45"></a><span id="l30.45">                     let endTime = new Date(startDate.getTime() + duration * 60 * 1000);</span>
<a href="#l30.46"></a><span id="l30.46">                     guess.year = endTime.getFullYear();</span>
<a href="#l30.47"></a><span id="l30.47">                     guess.month = endTime.getMonth() + 1;</span>
<a href="#l30.48"></a><span id="l30.48">                     guess.day = endTime.getDate();</span>
<a href="#l30.49"></a><span id="l30.49">                     if (!(endTime.getHours() == 0 &amp;&amp; endTime.getMinutes() == 0)) {</span>
<a href="#l30.50"></a><span id="l30.50" class="difflineminus">-                        guess.hour = endTime.getHours()</span>
<a href="#l30.51"></a><span id="l30.51" class="difflineplus">+                        guess.hour = endTime.getHours();</span>
<a href="#l30.52"></a><span id="l30.52">                         guess.minute = endTime.getMinutes();</span>
<a href="#l30.53"></a><span id="l30.53">                     }</span>
<a href="#l30.54"></a><span id="l30.54">                 }</span>
<a href="#l30.55"></a><span id="l30.55">             }</span>
<a href="#l30.56"></a><span id="l30.56"> </span>
<a href="#l30.57"></a><span id="l30.57">             // no zero or negative length events/tasks</span>
<a href="#l30.58"></a><span id="l30.58">             let startTime = new Date(start.year || 0, start.month - 1 || 0, start.day || 0,</span>
<a href="#l30.59"></a><span id="l30.59">                                      start.hour || 0, start.minute || 0).getTime();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l31.1"></a><span id="l31.1" class="difflineminus">--- a/calendar/base/modules/calHashedArray.jsm</span>
<a href="#l31.2"></a><span id="l31.2" class="difflineplus">+++ b/calendar/base/modules/calHashedArray.jsm</span>
<a href="#l31.3"></a><span id="l31.3" class="difflineat">@@ -13,17 +13,17 @@ var EXPORTED_SYMBOLS = [&quot;cal&quot;]; // even </span>
<a href="#l31.4"></a><span id="l31.4">  * Performance Considerations:</span>
<a href="#l31.5"></a><span id="l31.5">  *  - Accessing items is fast</span>
<a href="#l31.6"></a><span id="l31.6">  *  - Adding items is fast (they are added to the end)</span>
<a href="#l31.7"></a><span id="l31.7">  *  - Deleting items is O(n)</span>
<a href="#l31.8"></a><span id="l31.8">  *  - Modifying items is fast.</span>
<a href="#l31.9"></a><span id="l31.9">  */</span>
<a href="#l31.10"></a><span id="l31.10"> cal.HashedArray = function HashedArray() {</span>
<a href="#l31.11"></a><span id="l31.11">     this.clear();</span>
<a href="#l31.12"></a><span id="l31.12" class="difflineminus">-}</span>
<a href="#l31.13"></a><span id="l31.13" class="difflineplus">+};</span>
<a href="#l31.14"></a><span id="l31.14"> </span>
<a href="#l31.15"></a><span id="l31.15"> cal.HashedArray.prototype = {</span>
<a href="#l31.16"></a><span id="l31.16">     mArray: null,</span>
<a href="#l31.17"></a><span id="l31.17">     mHash: null,</span>
<a href="#l31.18"></a><span id="l31.18"> </span>
<a href="#l31.19"></a><span id="l31.19">     mBatch: 0,</span>
<a href="#l31.20"></a><span id="l31.20">     mFirstDirty: -1,</span>
<a href="#l31.21"></a><span id="l31.21"> </span>
<a href="#l31.22"></a><span id="l31.22" class="difflineat">@@ -217,20 +217,20 @@ cal.HashedArray.prototype = {</span>
<a href="#l31.23"></a><span id="l31.23">  * Performance Considerations:</span>
<a href="#l31.24"></a><span id="l31.24">  *  - Accessing items is fast</span>
<a href="#l31.25"></a><span id="l31.25">  *  - Adding and deleting items is O(n)</span>
<a href="#l31.26"></a><span id="l31.26">  *  - Modifying items is fast.</span>
<a href="#l31.27"></a><span id="l31.27">  */</span>
<a href="#l31.28"></a><span id="l31.28"> cal.SortedHashedArray = function SortedHashedArray(comparator) {</span>
<a href="#l31.29"></a><span id="l31.29">     cal.HashedArray.apply(this, arguments);</span>
<a href="#l31.30"></a><span id="l31.30">     if (!comparator) {</span>
<a href="#l31.31"></a><span id="l31.31" class="difflineminus">-        throw &quot;Sorted Hashed Array needs a comparator&quot;</span>
<a href="#l31.32"></a><span id="l31.32" class="difflineplus">+        throw &quot;Sorted Hashed Array needs a comparator&quot;;</span>
<a href="#l31.33"></a><span id="l31.33">     }</span>
<a href="#l31.34"></a><span id="l31.34">     this.mCompFunc = comparator;</span>
<a href="#l31.35"></a><span id="l31.35" class="difflineminus">-}</span>
<a href="#l31.36"></a><span id="l31.36" class="difflineplus">+};</span>
<a href="#l31.37"></a><span id="l31.37"> </span>
<a href="#l31.38"></a><span id="l31.38"> cal.SortedHashedArray.prototype = {</span>
<a href="#l31.39"></a><span id="l31.39">     __proto__: cal.HashedArray.prototype,</span>
<a href="#l31.40"></a><span id="l31.40"> </span>
<a href="#l31.41"></a><span id="l31.41">     mCompFunc: null,</span>
<a href="#l31.42"></a><span id="l31.42"> </span>
<a href="#l31.43"></a><span id="l31.43">     addItem: function addItem(item) {</span>
<a href="#l31.44"></a><span id="l31.44">         let newIndex = cal.binaryInsert(this.mArray, item, this.mCompFunc, false);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l32.1"></a><span id="l32.1" class="difflineminus">--- a/calendar/base/modules/calItipUtils.jsm</span>
<a href="#l32.2"></a><span id="l32.2" class="difflineplus">+++ b/calendar/base/modules/calItipUtils.jsm</span>
<a href="#l32.3"></a><span id="l32.3" class="difflineat">@@ -839,17 +839,17 @@ cal.itip = {</span>
<a href="#l32.4"></a><span id="l32.4">      * @param aItems        List of items to be contained in the new itipItem</span>
<a href="#l32.5"></a><span id="l32.5">      * @param aProps        List of properties to be different in the new itipItem</span>
<a href="#l32.6"></a><span id="l32.6">      */</span>
<a href="#l32.7"></a><span id="l32.7">     getModifiedItipItem: function cal_getModifiedItipItem(aItipItem, aItems, aProps) {</span>
<a href="#l32.8"></a><span id="l32.8">         let itipItem = Components.classes[&quot;@mozilla.org/calendar/itip-item;1&quot;]</span>
<a href="#l32.9"></a><span id="l32.9">                                  .createInstance(Components.interfaces.calIItipItem);</span>
<a href="#l32.10"></a><span id="l32.10">         let serializedItems = &quot;&quot;;</span>
<a href="#l32.11"></a><span id="l32.11">         for (let item of (aItems || [])) {</span>
<a href="#l32.12"></a><span id="l32.12" class="difflineminus">-            serializedItems += cal.getSerializedItem(item)</span>
<a href="#l32.13"></a><span id="l32.13" class="difflineplus">+            serializedItems += cal.getSerializedItem(item);</span>
<a href="#l32.14"></a><span id="l32.14">         }</span>
<a href="#l32.15"></a><span id="l32.15">         itipItem.init(serializedItems);</span>
<a href="#l32.16"></a><span id="l32.16"> </span>
<a href="#l32.17"></a><span id="l32.17">         let props = aProps || {};</span>
<a href="#l32.18"></a><span id="l32.18">         itipItem.autoResponse = (&quot;autoResponse&quot; in props) ? props.autoResponse : aItipItem.autoResponse;</span>
<a href="#l32.19"></a><span id="l32.19">         itipItem.identity = (&quot;identity&quot; in props) ? props.identity : aItipItem.identity;</span>
<a href="#l32.20"></a><span id="l32.20">         itipItem.isSend = (&quot;isSend&quot; in props) ? props.isSend : aItipItem.isSend;</span>
<a href="#l32.21"></a><span id="l32.21">         itipItem.localStatus = (&quot;localStatus&quot; in props) ? props.localStatus : aItipItem.localStatus;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l33.1"></a><span id="l33.1" class="difflineminus">--- a/calendar/base/modules/calPrintUtils.jsm</span>
<a href="#l33.2"></a><span id="l33.2" class="difflineplus">+++ b/calendar/base/modules/calPrintUtils.jsm</span>
<a href="#l33.3"></a><span id="l33.3" class="difflineat">@@ -192,9 +192,9 @@ cal.print = {</span>
<a href="#l33.4"></a><span id="l33.4">                 return &quot;\u21ff&quot;;                                        // unicode ''</span>
<a href="#l33.5"></a><span id="l33.5">             } else if (compareEnd == 0) {</span>
<a href="#l33.6"></a><span id="l33.6">                 return &quot;\u21e5 &quot; + dateFormatter.formatTime(endDate);   // unicode ''</span>
<a href="#l33.7"></a><span id="l33.7">             } else {</span>
<a href="#l33.8"></a><span id="l33.8">                 return &quot;&quot;;</span>
<a href="#l33.9"></a><span id="l33.9">             }</span>
<a href="#l33.10"></a><span id="l33.10">         }</span>
<a href="#l33.11"></a><span id="l33.11">     }</span>
<a href="#l33.12"></a><span id="l33.12" class="difflineminus">-}</span>
<a href="#l33.13"></a><span id="l33.13" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l34.1"></a><span id="l34.1" class="difflineminus">--- a/calendar/base/modules/calProviderUtils.jsm</span>
<a href="#l34.2"></a><span id="l34.2" class="difflineplus">+++ b/calendar/base/modules/calProviderUtils.jsm</span>
<a href="#l34.3"></a><span id="l34.3" class="difflineat">@@ -192,17 +192,17 @@ cal.BadCertHandler.prototype = {</span>
<a href="#l34.4"></a><span id="l34.4">  *</span>
<a href="#l34.5"></a><span id="l34.5">  * @param aCalId         The calendar id to set up with.</span>
<a href="#l34.6"></a><span id="l34.6">  * @param aFreeBusyType  The type from calIFreeBusyInterval.</span>
<a href="#l34.7"></a><span id="l34.7">  * @param aStart         The start of the interval.</span>
<a href="#l34.8"></a><span id="l34.8">  * @param aEnd           The end of the interval.</span>
<a href="#l34.9"></a><span id="l34.9">  * @return               The fresh calIFreeBusyInterval.</span>
<a href="#l34.10"></a><span id="l34.10">  */</span>
<a href="#l34.11"></a><span id="l34.11"> cal.FreeBusyInterval = function calFreeBusyInterval(aCalId, aFreeBusyType, aStart, aEnd) {</span>
<a href="#l34.12"></a><span id="l34.12" class="difflineminus">-    this.calId = aCalId</span>
<a href="#l34.13"></a><span id="l34.13" class="difflineplus">+    this.calId = aCalId;</span>
<a href="#l34.14"></a><span id="l34.14">     this.interval = Components.classes[&quot;@mozilla.org/calendar/period;1&quot;]</span>
<a href="#l34.15"></a><span id="l34.15">                               .createInstance(Components.interfaces.calIPeriod);</span>
<a href="#l34.16"></a><span id="l34.16">     this.interval.start = aStart;</span>
<a href="#l34.17"></a><span id="l34.17">     this.interval.end = aEnd;</span>
<a href="#l34.18"></a><span id="l34.18"> </span>
<a href="#l34.19"></a><span id="l34.19">     this.freeBusyType = aFreeBusyType || Components.interfaces.calIFreeBusyInterval.UNKNOWN;</span>
<a href="#l34.20"></a><span id="l34.20"> };</span>
<a href="#l34.21"></a><span id="l34.21"> cal.FreeBusyInterval.prototype = {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l35.1"></a><span id="l35.1" class="difflineminus">--- a/calendar/base/modules/calRecurrenceUtils.jsm</span>
<a href="#l35.2"></a><span id="l35.2" class="difflineplus">+++ b/calendar/base/modules/calRecurrenceUtils.jsm</span>
<a href="#l35.3"></a><span id="l35.3" class="difflineat">@@ -274,17 +274,17 @@ function recurrenceRule2String(recurrenc</span>
<a href="#l35.4"></a><span id="l35.4">                             yearlyString = getRString(yearlyString, [day, month]);</span>
<a href="#l35.5"></a><span id="l35.5">                             ruleString = PluralForm.get(rule.interval, yearlyString)</span>
<a href="#l35.6"></a><span id="l35.6">                                                    .replace(&quot;#3&quot;, rule.interval);</span>
<a href="#l35.7"></a><span id="l35.7">                         } else if (day_position(byday[0]) &gt;= -1 ||</span>
<a href="#l35.8"></a><span id="l35.8">                                    day_position(byday[0]) &lt;= 5) {</span>
<a href="#l35.9"></a><span id="l35.9">                             // The first|the second|...|the last  Monday, Tuesday, ..., day.</span>
<a href="#l35.10"></a><span id="l35.10">                             let yearlyString = &quot;yearlyNthOnNthOf&quot;;</span>
<a href="#l35.11"></a><span id="l35.11">                             yearlyString = nounClass(dayString, yearlyString);</span>
<a href="#l35.12"></a><span id="l35.12" class="difflineminus">-                            let ordinalString = &quot;repeatOrdinal&quot; + day_position(byday[0])</span>
<a href="#l35.13"></a><span id="l35.13" class="difflineplus">+                            let ordinalString = &quot;repeatOrdinal&quot; + day_position(byday[0]);</span>
<a href="#l35.14"></a><span id="l35.14">                             ordinalString = nounClass(dayString, ordinalString);</span>
<a href="#l35.15"></a><span id="l35.15">                             let ordinal = getRString(ordinalString);</span>
<a href="#l35.16"></a><span id="l35.16">                             let day = getRString(dayString);</span>
<a href="#l35.17"></a><span id="l35.17">                             yearlyString = getRString(yearlyString, [ordinal, day, month]);</span>
<a href="#l35.18"></a><span id="l35.18">                             ruleString = PluralForm.get(rule.interval, yearlyString)</span>
<a href="#l35.19"></a><span id="l35.19">                                                    .replace(&quot;#4&quot;, rule.interval);</span>
<a href="#l35.20"></a><span id="l35.20">                         } else {</span>
<a href="#l35.21"></a><span id="l35.21">                             return getRString(&quot;ruleTooComplex&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l36.1"></a><span id="l36.1" class="difflineminus">--- a/calendar/base/modules/calUtils.jsm</span>
<a href="#l36.2"></a><span id="l36.2" class="difflineplus">+++ b/calendar/base/modules/calUtils.jsm</span>
<a href="#l36.3"></a><span id="l36.3" class="difflineat">@@ -430,17 +430,17 @@ var cal = {</span>
<a href="#l36.4"></a><span id="l36.4">      */</span>
<a href="#l36.5"></a><span id="l36.5">     getRecipientList: function(aAttendees) {</span>
<a href="#l36.6"></a><span id="l36.6">         let cbEmail = function(aVal, aInd, aArr) {</span>
<a href="#l36.7"></a><span id="l36.7">             let email = cal.getAttendeeEmail(aVal, true);</span>
<a href="#l36.8"></a><span id="l36.8">             if (!email.length) {</span>
<a href="#l36.9"></a><span id="l36.9">                 cal.LOG(&quot;Dropping invalid recipient for email transport: &quot; + aVal.toString());</span>
<a href="#l36.10"></a><span id="l36.10">             }</span>
<a href="#l36.11"></a><span id="l36.11">             return email;</span>
<a href="#l36.12"></a><span id="l36.12" class="difflineminus">-        }</span>
<a href="#l36.13"></a><span id="l36.13" class="difflineplus">+        };</span>
<a href="#l36.14"></a><span id="l36.14">         return aAttendees.map(cbEmail)</span>
<a href="#l36.15"></a><span id="l36.15">                          .filter(aVal =&gt; aVal.length &gt; 0)</span>
<a href="#l36.16"></a><span id="l36.16">                          .join(', ');</span>
<a href="#l36.17"></a><span id="l36.17">     },</span>
<a href="#l36.18"></a><span id="l36.18"> </span>
<a href="#l36.19"></a><span id="l36.19">     /**</span>
<a href="#l36.20"></a><span id="l36.20">      * Returns the default transparency to apply for an event depending on whether its an all-day event</span>
<a href="#l36.21"></a><span id="l36.21">      *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l37.1"></a><span id="l37.1" class="difflineminus">--- a/calendar/base/modules/calViewUtils.jsm</span>
<a href="#l37.2"></a><span id="l37.2" class="difflineplus">+++ b/calendar/base/modules/calViewUtils.jsm</span>
<a href="#l37.3"></a><span id="l37.3" class="difflineat">@@ -56,9 +56,9 @@ cal.view = {</span>
<a href="#l37.4"></a><span id="l37.4">         cmp = a.endDate.compare(b.endDate);</span>
<a href="#l37.5"></a><span id="l37.5">         if (cmp != 0) {</span>
<a href="#l37.6"></a><span id="l37.6">             return cmp;</span>
<a href="#l37.7"></a><span id="l37.7">         }</span>
<a href="#l37.8"></a><span id="l37.8"> </span>
<a href="#l37.9"></a><span id="l37.9">         cmp = (a.title &gt; b.title) - (a.title &lt; b.title);</span>
<a href="#l37.10"></a><span id="l37.10">         return cmp;</span>
<a href="#l37.11"></a><span id="l37.11">     }</span>
<a href="#l37.12"></a><span id="l37.12" class="difflineminus">-}</span>
<a href="#l37.13"></a><span id="l37.13" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l38.1"></a><span id="l38.1" class="difflineminus">--- a/calendar/base/src/calAlarmService.js</span>
<a href="#l38.2"></a><span id="l38.2" class="difflineplus">+++ b/calendar/base/src/calAlarmService.js</span>
<a href="#l38.3"></a><span id="l38.3" class="difflineat">@@ -332,17 +332,17 @@ calAlarmService.prototype = {</span>
<a href="#l38.4"></a><span id="l38.4">                 alarmDate = alarmDate.getInTimezone(this.timezone);</span>
<a href="#l38.5"></a><span id="l38.5">                 alarmDate.isDate = false;</span>
<a href="#l38.6"></a><span id="l38.6">             }</span>
<a href="#l38.7"></a><span id="l38.7">             alarmDate = alarmDate.getInTimezone(UTC());</span>
<a href="#l38.8"></a><span id="l38.8"> </span>
<a href="#l38.9"></a><span id="l38.9">             // Check for snooze</span>
<a href="#l38.10"></a><span id="l38.10">             let snoozeDate;</span>
<a href="#l38.11"></a><span id="l38.11">             if (aItem.parentItem != aItem) {</span>
<a href="#l38.12"></a><span id="l38.12" class="difflineminus">-                snoozeDate = aItem.parentItem.getProperty(&quot;X-MOZ-SNOOZE-TIME-&quot; + aItem.recurrenceId.nativeTime)</span>
<a href="#l38.13"></a><span id="l38.13" class="difflineplus">+                snoozeDate = aItem.parentItem.getProperty(&quot;X-MOZ-SNOOZE-TIME-&quot; + aItem.recurrenceId.nativeTime);</span>
<a href="#l38.14"></a><span id="l38.14">             } else {</span>
<a href="#l38.15"></a><span id="l38.15">                 snoozeDate = aItem.getProperty(&quot;X-MOZ-SNOOZE-TIME&quot;);</span>
<a href="#l38.16"></a><span id="l38.16">             }</span>
<a href="#l38.17"></a><span id="l38.17"> </span>
<a href="#l38.18"></a><span id="l38.18">             if (snoozeDate &amp;&amp; !(snoozeDate instanceof Components.interfaces.calIDateTime)) {</span>
<a href="#l38.19"></a><span id="l38.19">                 snoozeDate = cal.createDateTime(snoozeDate);</span>
<a href="#l38.20"></a><span id="l38.20">             }</span>
<a href="#l38.21"></a><span id="l38.21"> </span>
<a href="#l38.22"></a><span id="l38.22" class="difflineat">@@ -470,17 +470,17 @@ calAlarmService.prototype = {</span>
<a href="#l38.23"></a><span id="l38.23">             if (calendar.id in this.mTimerMap) {</span>
<a href="#l38.24"></a><span id="l38.24">                 for (let hashId in this.mTimerMap[calendar.id]) {</span>
<a href="#l38.25"></a><span id="l38.25">                     let itemTimerMap = this.mTimerMap[calendar.id][hashId];</span>
<a href="#l38.26"></a><span id="l38.26">                     for (let icalString in itemTimerMap) {</span>
<a href="#l38.27"></a><span id="l38.27">                         let timer = itemTimerMap[icalString];</span>
<a href="#l38.28"></a><span id="l38.28">                         timer.cancel();</span>
<a href="#l38.29"></a><span id="l38.29">                     }</span>
<a href="#l38.30"></a><span id="l38.30">                 }</span>
<a href="#l38.31"></a><span id="l38.31" class="difflineminus">-                delete this.mTimerMap[calendar.id]</span>
<a href="#l38.32"></a><span id="l38.32" class="difflineplus">+                delete this.mTimerMap[calendar.id];</span>
<a href="#l38.33"></a><span id="l38.33">             }</span>
<a href="#l38.34"></a><span id="l38.34">         }</span>
<a href="#l38.35"></a><span id="l38.35">     },</span>
<a href="#l38.36"></a><span id="l38.36"> </span>
<a href="#l38.37"></a><span id="l38.37">     findAlarms: function cAS_findAlarms(aCalendars, aStart, aUntil) {</span>
<a href="#l38.38"></a><span id="l38.38">         let getListener = {</span>
<a href="#l38.39"></a><span id="l38.39">             QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIOperationListener]),</span>
<a href="#l38.40"></a><span id="l38.40">             alarmService: this,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l39.1"></a><span id="l39.1" class="difflineminus">--- a/calendar/base/src/calCachedCalendar.js</span>
<a href="#l39.2"></a><span id="l39.2" class="difflineplus">+++ b/calendar/base/src/calCachedCalendar.js</span>
<a href="#l39.3"></a><span id="l39.3" class="difflineat">@@ -680,17 +680,17 @@ calCachedCalendar.prototype = {</span>
<a href="#l39.4"></a><span id="l39.4">                     // On success, add the item to the cache.</span>
<a href="#l39.5"></a><span id="l39.5">                     self.mCachedCalendar.addItem(detail, listener);</span>
<a href="#l39.6"></a><span id="l39.6">                 } else if (listener) {</span>
<a href="#l39.7"></a><span id="l39.7">                     // Either an error occurred or this is a successful add</span>
<a href="#l39.8"></a><span id="l39.8">                     // to a cached calendar. Forward the call to the listener</span>
<a href="#l39.9"></a><span id="l39.9">                     listener.onOperationComplete(self, status, opType, id, detail);</span>
<a href="#l39.10"></a><span id="l39.10">                 }</span>
<a href="#l39.11"></a><span id="l39.11">             }</span>
<a href="#l39.12"></a><span id="l39.12" class="difflineminus">-        }</span>
<a href="#l39.13"></a><span id="l39.13" class="difflineplus">+        };</span>
<a href="#l39.14"></a><span id="l39.14"> </span>
<a href="#l39.15"></a><span id="l39.15">         if (this.offline) {</span>
<a href="#l39.16"></a><span id="l39.16">             // If we are offline, don't even try to add the item</span>
<a href="#l39.17"></a><span id="l39.17">             this.adoptOfflineItem(item, listener);</span>
<a href="#l39.18"></a><span id="l39.18">         } else {</span>
<a href="#l39.19"></a><span id="l39.19">             // Otherwise ask the provider to add the item now.</span>
<a href="#l39.20"></a><span id="l39.20">             this.mUncachedCalendar.adoptItem(item, cacheListener);</span>
<a href="#l39.21"></a><span id="l39.21">         }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l40.1"></a><span id="l40.1" class="difflineminus">--- a/calendar/base/src/calCalendarManager.js</span>
<a href="#l40.2"></a><span id="l40.2" class="difflineplus">+++ b/calendar/base/src/calCalendarManager.js</span>
<a href="#l40.3"></a><span id="l40.3" class="difflineat">@@ -561,17 +561,17 @@ calCalendarManager.prototype = {</span>
<a href="#l40.4"></a><span id="l40.4">                                   Components.interfaces.nsITimer.TYPE_REPEATING_SLACK);</span>
<a href="#l40.5"></a><span id="l40.5">         }</span>
<a href="#l40.6"></a><span id="l40.6">     },</span>
<a href="#l40.7"></a><span id="l40.7"> </span>
<a href="#l40.8"></a><span id="l40.8">     clearRefreshTimer: function clearRefreshTimer(aCalendar) {</span>
<a href="#l40.9"></a><span id="l40.9">         if (aCalendar.id in this.mRefreshTimer &amp;&amp;</span>
<a href="#l40.10"></a><span id="l40.10">             this.mRefreshTimer[aCalendar.id]) {</span>
<a href="#l40.11"></a><span id="l40.11">             this.mRefreshTimer[aCalendar.id].cancel();</span>
<a href="#l40.12"></a><span id="l40.12" class="difflineminus">-            delete this.mRefreshTimer[aCalendar.id]</span>
<a href="#l40.13"></a><span id="l40.13" class="difflineplus">+            delete this.mRefreshTimer[aCalendar.id];</span>
<a href="#l40.14"></a><span id="l40.14">         }</span>
<a href="#l40.15"></a><span id="l40.15">     },</span>
<a href="#l40.16"></a><span id="l40.16"> </span>
<a href="#l40.17"></a><span id="l40.17">     unregisterCalendar: function(calendar) {</span>
<a href="#l40.18"></a><span id="l40.18">         this.notifyObservers(&quot;onCalendarUnregistering&quot;, [calendar]);</span>
<a href="#l40.19"></a><span id="l40.19"> </span>
<a href="#l40.20"></a><span id="l40.20">         // calendar may be a calICalendar wrapper:</span>
<a href="#l40.21"></a><span id="l40.21">         if (calendar.wrappedJSObject instanceof calCachedCalendar) {</span>
<a href="#l40.22"></a><span id="l40.22" class="difflineat">@@ -1051,17 +1051,17 @@ function flushPrefs() {</span>
<a href="#l40.23"></a><span id="l40.23">  *</span>
<a href="#l40.24"></a><span id="l40.24">  * @param aCalendar     The calendar to refresh on notification</span>
<a href="#l40.25"></a><span id="l40.25">  */</span>
<a href="#l40.26"></a><span id="l40.26"> function timerCallback(aCalendar) {</span>
<a href="#l40.27"></a><span id="l40.27">     this.notify = function refreshNotify(aTimer) {</span>
<a href="#l40.28"></a><span id="l40.28">         if (!aCalendar.getProperty(&quot;disabled&quot;) &amp;&amp; aCalendar.canRefresh) {</span>
<a href="#l40.29"></a><span id="l40.29">             aCalendar.refresh();</span>
<a href="#l40.30"></a><span id="l40.30">         }</span>
<a href="#l40.31"></a><span id="l40.31" class="difflineminus">-    }</span>
<a href="#l40.32"></a><span id="l40.32" class="difflineplus">+    };</span>
<a href="#l40.33"></a><span id="l40.33"> }</span>
<a href="#l40.34"></a><span id="l40.34"> </span>
<a href="#l40.35"></a><span id="l40.35"> var gCalendarManagerAddonListener = {</span>
<a href="#l40.36"></a><span id="l40.36">     onDisabling: function(aAddon, aNeedsRestart) {</span>
<a href="#l40.37"></a><span id="l40.37">         if (!this.queryUninstallProvider(aAddon)) {</span>
<a href="#l40.38"></a><span id="l40.38">             // If the addon should not be disabled, then re-enable it.</span>
<a href="#l40.39"></a><span id="l40.39">             aAddon.userDisabled = false;</span>
<a href="#l40.40"></a><span id="l40.40">         }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l41.1"></a><span id="l41.1" class="difflineminus">--- a/calendar/base/src/calCalendarSearchService.js</span>
<a href="#l41.2"></a><span id="l41.2" class="difflineplus">+++ b/calendar/base/src/calCalendarSearchService.js</span>
<a href="#l41.3"></a><span id="l41.3" class="difflineat">@@ -14,17 +14,17 @@ function calCalendarSearchListener(numOp</span>
<a href="#l41.4"></a><span id="l41.4">     this.opGroup = new calOperationGroup(cancelFunc);</span>
<a href="#l41.5"></a><span id="l41.5"> }</span>
<a href="#l41.6"></a><span id="l41.6"> calCalendarSearchListener.prototype = {</span>
<a href="#l41.7"></a><span id="l41.7">     mFinalListener: null,</span>
<a href="#l41.8"></a><span id="l41.8">     mNumOperations: 0,</span>
<a href="#l41.9"></a><span id="l41.9">     opGroup: null,</span>
<a href="#l41.10"></a><span id="l41.10"> </span>
<a href="#l41.11"></a><span id="l41.11">     notifyResult: function calCalendarSearchListener_notifyResult(result) {</span>
<a href="#l41.12"></a><span id="l41.12" class="difflineminus">-        var listener = this.mFinalListener</span>
<a href="#l41.13"></a><span id="l41.13" class="difflineplus">+        var listener = this.mFinalListener;</span>
<a href="#l41.14"></a><span id="l41.14">         if (listener) {</span>
<a href="#l41.15"></a><span id="l41.15">             if (!this.opGroup.isPending) {</span>
<a href="#l41.16"></a><span id="l41.16">                 this.mFinalListener = null;</span>
<a href="#l41.17"></a><span id="l41.17">             }</span>
<a href="#l41.18"></a><span id="l41.18">             listener.onResult(this.opGroup, result);</span>
<a href="#l41.19"></a><span id="l41.19">         }</span>
<a href="#l41.20"></a><span id="l41.20">     },</span>
<a href="#l41.21"></a><span id="l41.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l42.1"></a><span id="l42.1" class="difflineminus">--- a/calendar/base/src/calEvent.js</span>
<a href="#l42.2"></a><span id="l42.2" class="difflineplus">+++ b/calendar/base/src/calEvent.js</span>
<a href="#l42.3"></a><span id="l42.3" class="difflineat">@@ -10,17 +10,17 @@ Components.utils.import(&quot;resource://gre/</span>
<a href="#l42.4"></a><span id="l42.4"> //</span>
<a href="#l42.5"></a><span id="l42.5"> function calEvent() {</span>
<a href="#l42.6"></a><span id="l42.6">     this.initItemBase();</span>
<a href="#l42.7"></a><span id="l42.7"> </span>
<a href="#l42.8"></a><span id="l42.8">     this.eventPromotedProps = {</span>
<a href="#l42.9"></a><span id="l42.9">         &quot;DTSTART&quot;: true,</span>
<a href="#l42.10"></a><span id="l42.10">         &quot;DTEND&quot;: true,</span>
<a href="#l42.11"></a><span id="l42.11">         __proto__: this.itemBasePromotedProps</span>
<a href="#l42.12"></a><span id="l42.12" class="difflineminus">-    }</span>
<a href="#l42.13"></a><span id="l42.13" class="difflineplus">+    };</span>
<a href="#l42.14"></a><span id="l42.14"> }</span>
<a href="#l42.15"></a><span id="l42.15"> var calEventClassID = Components.ID(&quot;{974339d5-ab86-4491-aaaf-2b2ca177c12b}&quot;);</span>
<a href="#l42.16"></a><span id="l42.16"> var calEventInterfaces = [</span>
<a href="#l42.17"></a><span id="l42.17">     Components.interfaces.calIItemBase,</span>
<a href="#l42.18"></a><span id="l42.18">     Components.interfaces.calIEvent,</span>
<a href="#l42.19"></a><span id="l42.19">     Components.interfaces.calIInternalShallowCopy</span>
<a href="#l42.20"></a><span id="l42.20"> ];</span>
<a href="#l42.21"></a><span id="l42.21"> calEvent.prototype = {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l43.1"></a><span id="l43.1" class="difflineminus">--- a/calendar/base/src/calFreeBusyService.js</span>
<a href="#l43.2"></a><span id="l43.2" class="difflineplus">+++ b/calendar/base/src/calFreeBusyService.js</span>
<a href="#l43.3"></a><span id="l43.3" class="difflineat">@@ -17,17 +17,17 @@ function calFreeBusyListener(numOperatio</span>
<a href="#l43.4"></a><span id="l43.4"> calFreeBusyListener.prototype = {</span>
<a href="#l43.5"></a><span id="l43.5">     mFinalListener: null,</span>
<a href="#l43.6"></a><span id="l43.6">     mNumOperations: 0,</span>
<a href="#l43.7"></a><span id="l43.7">     opGroup: null,</span>
<a href="#l43.8"></a><span id="l43.8"> </span>
<a href="#l43.9"></a><span id="l43.9">     QueryInterface: XPCOMUtils.generateQI([Components.interfaces.calIGenericOperationListener]),</span>
<a href="#l43.10"></a><span id="l43.10"> </span>
<a href="#l43.11"></a><span id="l43.11">     notifyResult: function calFreeBusyListener_notifyResult(result) {</span>
<a href="#l43.12"></a><span id="l43.12" class="difflineminus">-        var listener = this.mFinalListener</span>
<a href="#l43.13"></a><span id="l43.13" class="difflineplus">+        var listener = this.mFinalListener;</span>
<a href="#l43.14"></a><span id="l43.14">         if (listener) {</span>
<a href="#l43.15"></a><span id="l43.15">             if (!this.opGroup.isPending) {</span>
<a href="#l43.16"></a><span id="l43.16">                 this.mFinalListener = null;</span>
<a href="#l43.17"></a><span id="l43.17">             }</span>
<a href="#l43.18"></a><span id="l43.18">             listener.onResult(this.opGroup, result);</span>
<a href="#l43.19"></a><span id="l43.19">         }</span>
<a href="#l43.20"></a><span id="l43.20">     },</span>
<a href="#l43.21"></a><span id="l43.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l44.1"></a><span id="l44.1" class="difflineminus">--- a/calendar/base/src/calItemBase.js</span>
<a href="#l44.2"></a><span id="l44.2" class="difflineplus">+++ b/calendar/base/src/calItemBase.js</span>
<a href="#l44.3"></a><span id="l44.3" class="difflineat">@@ -489,17 +489,17 @@ calItemBase.prototype = {</span>
<a href="#l44.4"></a><span id="l44.4">         let parameters = this.mPropertyParams[propName];</span>
<a href="#l44.5"></a><span id="l44.5">         return { // nsISimpleEnumerator</span>
<a href="#l44.6"></a><span id="l44.6">             mParamNames: Object.keys(parameters),</span>
<a href="#l44.7"></a><span id="l44.7">             hasMoreElements: function cIB_gPE_hasMoreElements() {</span>
<a href="#l44.8"></a><span id="l44.8">                 return (this.mParamNames.length &gt; 0);</span>
<a href="#l44.9"></a><span id="l44.9">             },</span>
<a href="#l44.10"></a><span id="l44.10"> </span>
<a href="#l44.11"></a><span id="l44.11">             getNext: function cIB_gPE_getNext() {</span>
<a href="#l44.12"></a><span id="l44.12" class="difflineminus">-                let paramName = this.mParamNames.pop()</span>
<a href="#l44.13"></a><span id="l44.13" class="difflineplus">+                let paramName = this.mParamNames.pop();</span>
<a href="#l44.14"></a><span id="l44.14">                 return { // nsIProperty</span>
<a href="#l44.15"></a><span id="l44.15">                     QueryInterface: XPCOMUtils.generateQI([Components.interfaces.nsIProperty]),</span>
<a href="#l44.16"></a><span id="l44.16">                     name: paramName,</span>
<a href="#l44.17"></a><span id="l44.17">                     value: parameters[paramName]</span>
<a href="#l44.18"></a><span id="l44.18">                 };</span>
<a href="#l44.19"></a><span id="l44.19">             }</span>
<a href="#l44.20"></a><span id="l44.20">         };</span>
<a href="#l44.21"></a><span id="l44.21">     },</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l45.1"></a><span id="l45.1" class="difflineminus">--- a/calendar/base/src/calRecurrenceInfo.js</span>
<a href="#l45.2"></a><span id="l45.2" class="difflineplus">+++ b/calendar/base/src/calRecurrenceInfo.js</span>
<a href="#l45.3"></a><span id="l45.3" class="difflineat">@@ -548,17 +548,17 @@ calRecurrenceInfo.prototype = {</span>
<a href="#l45.4"></a><span id="l45.4">             for (let dateToRemove of cur_dates) {</span>
<a href="#l45.5"></a><span id="l45.5">                 let dateToRemoveKey = getRidKey(dateToRemove);</span>
<a href="#l45.6"></a><span id="l45.6">                 if (dateToRemove.isDate) {</span>
<a href="#l45.7"></a><span id="l45.7">                     // As decided in bug 734245, an EXDATE of type DATE shall also match a DTSTART of type DATE-TIME</span>
<a href="#l45.8"></a><span id="l45.8">                     let toRemove = [];</span>
<a href="#l45.9"></a><span id="l45.9">                     for (let occurenceKey in occurrenceMap) {</span>
<a href="#l45.10"></a><span id="l45.10">                         if (occurrenceMap[occurenceKey] &amp;&amp; occurenceKey.substring(0, 8) == dateToRemoveKey) {</span>
<a href="#l45.11"></a><span id="l45.11">                             dates = dates.filter(d =&gt; d.id.compare(dateToRemove) != 0);</span>
<a href="#l45.12"></a><span id="l45.12" class="difflineminus">-                            toRemove.push(occurenceKey)</span>
<a href="#l45.13"></a><span id="l45.13" class="difflineplus">+                            toRemove.push(occurenceKey);</span>
<a href="#l45.14"></a><span id="l45.14">                         }</span>
<a href="#l45.15"></a><span id="l45.15">                     }</span>
<a href="#l45.16"></a><span id="l45.16">                     for (let i = 0; i &lt; toRemove.length; i++) {</span>
<a href="#l45.17"></a><span id="l45.17">                         delete occurrenceMap[toRemove[i]];</span>
<a href="#l45.18"></a><span id="l45.18">                     }</span>
<a href="#l45.19"></a><span id="l45.19">                 } else if (occurrenceMap[dateToRemoveKey]) {</span>
<a href="#l45.20"></a><span id="l45.20">                     // TODO PERF Theoretically we could use occurrence map</span>
<a href="#l45.21"></a><span id="l45.21">                     // to construct the array of occurrences. Right now I'm</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l46.1"></a><span id="l46.1" class="difflineminus">--- a/calendar/base/src/calTimezoneService.js</span>
<a href="#l46.2"></a><span id="l46.2" class="difflineplus">+++ b/calendar/base/src/calTimezoneService.js</span>
<a href="#l46.3"></a><span id="l46.3" class="difflineat">@@ -603,17 +603,17 @@ function guessSystemTimezone() {</span>
<a href="#l46.4"></a><span id="l46.4">                 osUserTimeZone = wrk.readStringValue(&quot;TimeZoneKeyName&quot;).split(&quot;\0&quot;)[0];</span>
<a href="#l46.5"></a><span id="l46.5">             } else {</span>
<a href="#l46.6"></a><span id="l46.6">                 // If on Windows XP, current timezone only lists its localized name,</span>
<a href="#l46.7"></a><span id="l46.7">                 // so to find its registry key name, match localized name to</span>
<a href="#l46.8"></a><span id="l46.8">                 // localized names of each windows timezone listed in registry.</span>
<a href="#l46.9"></a><span id="l46.9">                 // Then use the registry key name to see if this timezone has a</span>
<a href="#l46.10"></a><span id="l46.10">                 // known ZoneInfo name.</span>
<a href="#l46.11"></a><span id="l46.11">                 var currentTZStandardName = wrk.readStringValue(&quot;StandardName&quot;);</span>
<a href="#l46.12"></a><span id="l46.12" class="difflineminus">-                wrk.close()</span>
<a href="#l46.13"></a><span id="l46.13" class="difflineplus">+                wrk.close();</span>
<a href="#l46.14"></a><span id="l46.14"> </span>
<a href="#l46.15"></a><span id="l46.15">                 wrk.open(wrk.ROOT_KEY_LOCAL_MACHINE,</span>
<a href="#l46.16"></a><span id="l46.16">                          &quot;SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Time Zones&quot;,</span>
<a href="#l46.17"></a><span id="l46.17">                          wrk.ACCESS_READ);</span>
<a href="#l46.18"></a><span id="l46.18"> </span>
<a href="#l46.19"></a><span id="l46.19">                 // Linear search matching localized name of standard timezone</span>
<a href="#l46.20"></a><span id="l46.20">                 // to find the non-localized registry key.</span>
<a href="#l46.21"></a><span id="l46.21">                 // (Registry keys are sorted by subkeyName, not by localized name</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l47.1"></a><span id="l47.1" class="difflineminus">--- a/calendar/base/src/calTodo.js</span>
<a href="#l47.2"></a><span id="l47.2" class="difflineplus">+++ b/calendar/base/src/calTodo.js</span>
<a href="#l47.3"></a><span id="l47.3" class="difflineat">@@ -138,17 +138,17 @@ calTodo.prototype = {</span>
<a href="#l47.4"></a><span id="l47.4">         var bagenum = this.propertyEnumerator;</span>
<a href="#l47.5"></a><span id="l47.5">         while (bagenum.hasMoreElements()) {</span>
<a href="#l47.6"></a><span id="l47.6">             var iprop = bagenum.getNext().</span>
<a href="#l47.7"></a><span id="l47.7">                 QueryInterface(Components.interfaces.nsIProperty);</span>
<a href="#l47.8"></a><span id="l47.8">             try {</span>
<a href="#l47.9"></a><span id="l47.9">                 if (!this.todoPromotedProps[iprop.name]) {</span>
<a href="#l47.10"></a><span id="l47.10">                     var icalprop = icssvc.createIcalProperty(iprop.name);</span>
<a href="#l47.11"></a><span id="l47.11">                     icalprop.value = iprop.value;</span>
<a href="#l47.12"></a><span id="l47.12" class="difflineminus">-                    var propBucket = this.mPropertyParams[iprop.name]</span>
<a href="#l47.13"></a><span id="l47.13" class="difflineplus">+                    var propBucket = this.mPropertyParams[iprop.name];</span>
<a href="#l47.14"></a><span id="l47.14">                     if (propBucket) {</span>
<a href="#l47.15"></a><span id="l47.15">                         for (let paramName in propBucket) {</span>
<a href="#l47.16"></a><span id="l47.16">                             try {</span>
<a href="#l47.17"></a><span id="l47.17">                                 icalprop.setParameter(paramName, propBucket[paramName]);</span>
<a href="#l47.18"></a><span id="l47.18">                             } catch (e) {</span>
<a href="#l47.19"></a><span id="l47.19">                                 if (e.result == Components.results.NS_ERROR_ILLEGAL_VALUE) {</span>
<a href="#l47.20"></a><span id="l47.20">                                     // Illegal values should be ignored, but we could log them if</span>
<a href="#l47.21"></a><span id="l47.21">                                     // the user has enabled logging.</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l48.1"></a><span id="l48.1" class="difflineminus">--- a/calendar/base/src/calUtils.js</span>
<a href="#l48.2"></a><span id="l48.2" class="difflineplus">+++ b/calendar/base/src/calUtils.js</span>
<a href="#l48.3"></a><span id="l48.3" class="difflineat">@@ -1478,17 +1478,17 @@ function getParentNodeOrThisByAttribute(</span>
<a href="#l48.4"></a><span id="l48.4">         if (node.tagName == undefined) {</span>
<a href="#l48.5"></a><span id="l48.5">             return null;</span>
<a href="#l48.6"></a><span id="l48.6">         }</span>
<a href="#l48.7"></a><span id="l48.7">     }</span>
<a href="#l48.8"></a><span id="l48.8">     return node;</span>
<a href="#l48.9"></a><span id="l48.9"> }</span>
<a href="#l48.10"></a><span id="l48.10"> </span>
<a href="#l48.11"></a><span id="l48.11"> function setItemProperty(item, propertyName, aValue, aCapability) {</span>
<a href="#l48.12"></a><span id="l48.12" class="difflineminus">-    var isSupported = (item.calendar.getProperty(&quot;capabilities.&quot; + aCapability + &quot;.supported&quot;) !== false)</span>
<a href="#l48.13"></a><span id="l48.13" class="difflineplus">+    var isSupported = (item.calendar.getProperty(&quot;capabilities.&quot; + aCapability + &quot;.supported&quot;) !== false);</span>
<a href="#l48.14"></a><span id="l48.14">     var value = (aCapability &amp;&amp; !isSupported ? null : aValue);</span>
<a href="#l48.15"></a><span id="l48.15"> </span>
<a href="#l48.16"></a><span id="l48.16">     switch (propertyName) {</span>
<a href="#l48.17"></a><span id="l48.17">         case &quot;startDate&quot;:</span>
<a href="#l48.18"></a><span id="l48.18">             if (value.isDate &amp;&amp; !item.startDate.isDate ||</span>
<a href="#l48.19"></a><span id="l48.19">                 !value.isDate &amp;&amp; item.startDate.isDate ||</span>
<a href="#l48.20"></a><span id="l48.20">                 !compareObjects(value.timezone, item.startDate.timezone) ||</span>
<a href="#l48.21"></a><span id="l48.21">                 value.compare(item.startDate) != 0) {</span>
<a href="#l48.22"></a><span id="l48.22" class="difflineat">@@ -1767,17 +1767,17 @@ function binarySearch(itemArray, newItem</span>
<a href="#l48.23"></a><span id="l48.23">     }</span>
<a href="#l48.24"></a><span id="l48.24"> </span>
<a href="#l48.25"></a><span id="l48.25">     if (itemArray.length &lt; 1) {</span>
<a href="#l48.26"></a><span id="l48.26">         return -1;</span>
<a href="#l48.27"></a><span id="l48.27">     }</span>
<a href="#l48.28"></a><span id="l48.28">     if (!comptor) {</span>
<a href="#l48.29"></a><span id="l48.29">         comptor = function defaultComptor(a, b) {</span>
<a href="#l48.30"></a><span id="l48.30">             return (a &gt; b) - (a &lt; b);</span>
<a href="#l48.31"></a><span id="l48.31" class="difflineminus">-        }</span>
<a href="#l48.32"></a><span id="l48.32" class="difflineplus">+        };</span>
<a href="#l48.33"></a><span id="l48.33">     }</span>
<a href="#l48.34"></a><span id="l48.34">     return binarySearchInternal(0, itemArray.length - 1);</span>
<a href="#l48.35"></a><span id="l48.35"> }</span>
<a href="#l48.36"></a><span id="l48.36"> </span>
<a href="#l48.37"></a><span id="l48.37"> /**</span>
<a href="#l48.38"></a><span id="l48.38">  * Insert a new node underneath the given parentNode, using binary search. See binarySearch</span>
<a href="#l48.39"></a><span id="l48.39">  * for a note on how the comptor works.</span>
<a href="#l48.40"></a><span id="l48.40">  *</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l49.1"></a><span id="l49.1" class="difflineminus">--- a/calendar/import-export/calOutlookCSVImportExport.js</span>
<a href="#l49.2"></a><span id="l49.2" class="difflineplus">+++ b/calendar/import-export/calOutlookCSVImportExport.js</span>
<a href="#l49.3"></a><span id="l49.3" class="difflineat">@@ -190,17 +190,17 @@ calOutlookCSVImporter.prototype = {</span>
<a href="#l49.4"></a><span id="l49.4">             args.alarmTimeIndex = 9;</span>
<a href="#l49.5"></a><span id="l49.5">             args.categoriesIndex = 15;</span>
<a href="#l49.6"></a><span id="l49.6">             args.descriptionIndex = 16;</span>
<a href="#l49.7"></a><span id="l49.7">             args.locationIndex = 17;</span>
<a href="#l49.8"></a><span id="l49.8">             args.privateIndex = 20;</span>
<a href="#l49.9"></a><span id="l49.9">         }</span>
<a href="#l49.10"></a><span id="l49.10"> </span>
<a href="#l49.11"></a><span id="l49.11">         if (args.titleIndex == 0 || args.startDateIndex == 0) {</span>
<a href="#l49.12"></a><span id="l49.12" class="difflineminus">-            dump(&quot;Can't import. Life sucks\n&quot;)</span>
<a href="#l49.13"></a><span id="l49.13" class="difflineplus">+            dump(&quot;Can't import. Life sucks\n&quot;);</span>
<a href="#l49.14"></a><span id="l49.14">             aCount.value = 0;</span>
<a href="#l49.15"></a><span id="l49.15">             return [];</span>
<a href="#l49.16"></a><span id="l49.16">         }</span>
<a href="#l49.17"></a><span id="l49.17"> </span>
<a href="#l49.18"></a><span id="l49.18">         // Construct event regexp according to field indexes. The regexp can</span>
<a href="#l49.19"></a><span id="l49.19">         // be made stricter, if it seems this matches too loosely.</span>
<a href="#l49.20"></a><span id="l49.20">         let regExpStr = &quot;^&quot;;</span>
<a href="#l49.21"></a><span id="l49.21">         for (i = 1; i &lt;= header.length; i++) {</span>
<a href="#l49.22"></a><span id="l49.22" class="difflineat">@@ -333,30 +333,30 @@ calOutlookCSVImporter.prototype = {</span>
<a href="#l49.23"></a><span id="l49.23">                     if (locale.valueTrue == eventFields[args.privateIndex]) {</span>
<a href="#l49.24"></a><span id="l49.24">                         event.privacy = &quot;PRIVATE&quot;;</span>
<a href="#l49.25"></a><span id="l49.25">                     }</span>
<a href="#l49.26"></a><span id="l49.26">                 }</span>
<a href="#l49.27"></a><span id="l49.27"> </span>
<a href="#l49.28"></a><span id="l49.28">                 // Avoid setting empty properties</span>
<a href="#l49.29"></a><span id="l49.29">                 let txt = &quot;&quot;;</span>
<a href="#l49.30"></a><span id="l49.30">                 if (&quot;descriptionIndex&quot; in args) {</span>
<a href="#l49.31"></a><span id="l49.31" class="difflineminus">-                    txt = this.parseTextField(eventFields[args.descriptionIndex])</span>
<a href="#l49.32"></a><span id="l49.32" class="difflineplus">+                    txt = this.parseTextField(eventFields[args.descriptionIndex]);</span>
<a href="#l49.33"></a><span id="l49.33">                     if (txt) {</span>
<a href="#l49.34"></a><span id="l49.34">                         event.setProperty(&quot;DESCRIPTION&quot;, txt);</span>
<a href="#l49.35"></a><span id="l49.35">                     }</span>
<a href="#l49.36"></a><span id="l49.36">                 }</span>
<a href="#l49.37"></a><span id="l49.37">                 if (&quot;categoriesIndex&quot; in args) {</span>
<a href="#l49.38"></a><span id="l49.38" class="difflineminus">-                    txt = this.parseTextField(eventFields[args.categoriesIndex])</span>
<a href="#l49.39"></a><span id="l49.39" class="difflineplus">+                    txt = this.parseTextField(eventFields[args.categoriesIndex]);</span>
<a href="#l49.40"></a><span id="l49.40">                     if (txt) {</span>
<a href="#l49.41"></a><span id="l49.41">                         let categories = cal.categoriesStringToArray(txt);</span>
<a href="#l49.42"></a><span id="l49.42">                         event.setCategories(categories.length, categories);</span>
<a href="#l49.43"></a><span id="l49.43">                     }</span>
<a href="#l49.44"></a><span id="l49.44">                 }</span>
<a href="#l49.45"></a><span id="l49.45">                 if (&quot;locationIndex&quot; in args) {</span>
<a href="#l49.46"></a><span id="l49.46" class="difflineminus">-                    txt = this.parseTextField(eventFields[args.locationIndex])</span>
<a href="#l49.47"></a><span id="l49.47" class="difflineplus">+                    txt = this.parseTextField(eventFields[args.locationIndex]);</span>
<a href="#l49.48"></a><span id="l49.48">                     if (txt) {</span>
<a href="#l49.49"></a><span id="l49.49">                         event.setProperty(&quot;LOCATION&quot;, txt);</span>
<a href="#l49.50"></a><span id="l49.50">                     }</span>
<a href="#l49.51"></a><span id="l49.51">                 }</span>
<a href="#l49.52"></a><span id="l49.52"> </span>
<a href="#l49.53"></a><span id="l49.53">                 // save the event into return array</span>
<a href="#l49.54"></a><span id="l49.54">                 eventArray.push(event);</span>
<a href="#l49.55"></a><span id="l49.55">             }</span>
<a href="#l49.56"></a><span id="l49.56" class="difflineat">@@ -485,14 +485,14 @@ calOutlookCSVExporter.prototype = {</span>
<a href="#l49.57"></a><span id="l49.57">             line.push(txtString(cal.categoriesArrayToString(item.getCategories({})))); // xxx todo: what's the correct way to encode ',' in csv?, how are multi-values expressed?</span>
<a href="#l49.58"></a><span id="l49.58">             line.push(txtString(item.getProperty(&quot;DESCRIPTION&quot;)));</span>
<a href="#l49.59"></a><span id="l49.59">             line.push(txtString(item.getProperty(&quot;LOCATION&quot;)));</span>
<a href="#l49.60"></a><span id="l49.60">             line.push((item.privacy == &quot;PRIVATE&quot;) ? localeEn.valueTrue : localeEn.valueFalse);</span>
<a href="#l49.61"></a><span id="l49.61"> </span>
<a href="#l49.62"></a><span id="l49.62">             line = line.map(function(v) {</span>
<a href="#l49.63"></a><span id="l49.63">                 v = String(v).replace(/&quot;/g, '&quot;&quot;');</span>
<a href="#l49.64"></a><span id="l49.64">                 return '&quot;' + v + '&quot;';</span>
<a href="#l49.65"></a><span id="l49.65" class="difflineminus">-            })</span>
<a href="#l49.66"></a><span id="l49.66" class="difflineplus">+            });</span>
<a href="#l49.67"></a><span id="l49.67">             str = line.join(',') + exportLineEnding;</span>
<a href="#l49.68"></a><span id="l49.68">             aStream.write(str, str.length);</span>
<a href="#l49.69"></a><span id="l49.69">         }</span>
<a href="#l49.70"></a><span id="l49.70">     }</span>
<a href="#l49.71"></a><span id="l49.71"> };</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l50.1"></a><span id="l50.1" class="difflineminus">--- a/calendar/itip/calItipEmailTransport.js</span>
<a href="#l50.2"></a><span id="l50.2" class="difflineplus">+++ b/calendar/itip/calItipEmailTransport.js</span>
<a href="#l50.3"></a><span id="l50.3" class="difflineat">@@ -260,18 +260,18 @@ calItipEmailTransport.prototype = {</span>
<a href="#l50.4"></a><span id="l50.4">                     cal.LOG(&quot;sendXpcomMail: Found AUTO autoResponse type.&quot;);</span>
<a href="#l50.5"></a><span id="l50.5">                 }</span>
<a href="#l50.6"></a><span id="l50.6">                 let cbEmail = function(aVal, aInd, aArr) {</span>
<a href="#l50.7"></a><span id="l50.7">                     let email = cal.getAttendeeEmail(aVal, true);</span>
<a href="#l50.8"></a><span id="l50.8">                     if (!email.length) {</span>
<a href="#l50.9"></a><span id="l50.9">                         cal.LOG(&quot;Invalid recipient for email transport: &quot; + aVal.toString());</span>
<a href="#l50.10"></a><span id="l50.10">                     }</span>
<a href="#l50.11"></a><span id="l50.11">                     return email;</span>
<a href="#l50.12"></a><span id="l50.12" class="difflineminus">-                }</span>
<a href="#l50.13"></a><span id="l50.13" class="difflineminus">-                let toMap = aToList.map(cbEmail).filter(function(aVal, aInd, aArr) {return (aVal.length)});</span>
<a href="#l50.14"></a><span id="l50.14" class="difflineplus">+                };</span>
<a href="#l50.15"></a><span id="l50.15" class="difflineplus">+                let toMap = aToList.map(cbEmail).filter(function(aVal, aInd, aArr) {return (aVal.length);});</span>
<a href="#l50.16"></a><span id="l50.16">                 if (toMap.length &lt; aToList.length) {</span>
<a href="#l50.17"></a><span id="l50.17">                     // at least one invalid recipient, so we skip sending for this message</span>
<a href="#l50.18"></a><span id="l50.18">                     return false;</span>
<a href="#l50.19"></a><span id="l50.19">                 }</span>
<a href="#l50.20"></a><span id="l50.20">                 let toList = toMap.join(', ');</span>
<a href="#l50.21"></a><span id="l50.21">                 let composeUtils = Components.classes[&quot;@mozilla.org/messengercompose/computils;1&quot;]</span>
<a href="#l50.22"></a><span id="l50.22">                                              .createInstance(Components.interfaces.nsIMsgCompUtils);</span>
<a href="#l50.23"></a><span id="l50.23">                 let messageId = composeUtils.msgGenerateMessageId(identity);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l51.1"></a><span id="l51.1" class="difflineminus">--- a/calendar/lightning/content/html-item-editing/react-code.js</span>
<a href="#l51.2"></a><span id="l51.2" class="difflineplus">+++ b/calendar/lightning/content/html-item-editing/react-code.js</span>
<a href="#l51.3"></a><span id="l51.3" class="difflineat">@@ -23,17 +23,17 @@ var Tabstrip = React.createClass({</span>
<a href="#l51.4"></a><span id="l51.4">                         className: style + ' tab',</span>
<a href="#l51.5"></a><span id="l51.5">                         key: 'tabkey' + index,</span>
<a href="#l51.6"></a><span id="l51.6">                         onClick: this.handleChange.bind(this, index)</span>
<a href="#l51.7"></a><span id="l51.7">                     },</span>
<a href="#l51.8"></a><span id="l51.8">                     tab</span>
<a href="#l51.9"></a><span id="l51.9">                     );</span>
<a href="#l51.10"></a><span id="l51.10">                 }</span>
<a href="#l51.11"></a><span id="l51.11">             )</span>
<a href="#l51.12"></a><span id="l51.12" class="difflineminus">-        )</span>
<a href="#l51.13"></a><span id="l51.13" class="difflineplus">+        );</span>
<a href="#l51.14"></a><span id="l51.14">     }</span>
<a href="#l51.15"></a><span id="l51.15"> });</span>
<a href="#l51.16"></a><span id="l51.16"> </span>
<a href="#l51.17"></a><span id="l51.17"> var TextField = React.createClass({</span>
<a href="#l51.18"></a><span id="l51.18">     handleChange: function(event) {</span>
<a href="#l51.19"></a><span id="l51.19">         this.props.onInput(this.props.keyprop, event.target.value);</span>
<a href="#l51.20"></a><span id="l51.20">     },</span>
<a href="#l51.21"></a><span id="l51.21">     render: function() {</span>
<a href="#l51.22"></a><span id="l51.22" class="difflineat">@@ -215,17 +215,17 @@ var TopComponent = React.createClass({</span>
<a href="#l51.23"></a><span id="l51.23">                 [6, '2 Hours Before'],</span>
<a href="#l51.24"></a><span id="l51.24">                 [7, '12 Hours Before'],</span>
<a href="#l51.25"></a><span id="l51.25">                 [8, '1 Day Before'],</span>
<a href="#l51.26"></a><span id="l51.26">                 [9, '2 Days Before'],</span>
<a href="#l51.27"></a><span id="l51.27">                 [10, '1 Week Before'],</span>
<a href="#l51.28"></a><span id="l51.28">                 [11, 'Custom...']</span>
<a href="#l51.29"></a><span id="l51.29">             ],</span>
<a href="#l51.30"></a><span id="l51.30">             supportsPriority: false</span>
<a href="#l51.31"></a><span id="l51.31" class="difflineminus">-        }</span>
<a href="#l51.32"></a><span id="l51.32" class="difflineplus">+        };</span>
<a href="#l51.33"></a><span id="l51.33">     },</span>
<a href="#l51.34"></a><span id="l51.34">     getInitialState: function() {</span>
<a href="#l51.35"></a><span id="l51.35">         // all the passed-in props that begin with 'initial' become state</span>
<a href="#l51.36"></a><span id="l51.36">         return {</span>
<a href="#l51.37"></a><span id="l51.37">             title: this.props.initialTitle,</span>
<a href="#l51.38"></a><span id="l51.38">             location: this.props.initialLocation,</span>
<a href="#l51.39"></a><span id="l51.39">             startTimezone: this.props.initialStartTimezone,</span>
<a href="#l51.40"></a><span id="l51.40">             endTimezone: this.props.initialEndTimezone,</span>
<a href="#l51.41"></a><span id="l51.41" class="difflineat">@@ -394,20 +394,20 @@ var TopComponent = React.createClass({</span>
<a href="#l51.42"></a><span id="l51.42">             categoriesCapsules =</span>
<a href="#l51.43"></a><span id="l51.43">                 this.state.categories.map((cat, index) =&gt; {</span>
<a href="#l51.44"></a><span id="l51.44">                     return React.createElement(Capsule, {</span>
<a href="#l51.45"></a><span id="l51.45">                         // color: this.props.categoryList.color,</span>
<a href="#l51.46"></a><span id="l51.46">                         value: cat,</span>
<a href="#l51.47"></a><span id="l51.47">                         key: cat + 'key',</span>
<a href="#l51.48"></a><span id="l51.48">                         keyprop: 'categories',</span>
<a href="#l51.49"></a><span id="l51.49">                         onDelete: this.onDeleteCapsule</span>
<a href="#l51.50"></a><span id="l51.50" class="difflineminus">-                    })</span>
<a href="#l51.51"></a><span id="l51.51" class="difflineminus">-                })</span>
<a href="#l51.52"></a><span id="l51.52" class="difflineplus">+                    });</span>
<a href="#l51.53"></a><span id="l51.53" class="difflineplus">+                });</span>
<a href="#l51.54"></a><span id="l51.54">         } else {</span>
<a href="#l51.55"></a><span id="l51.55" class="difflineminus">-            categoriesCapsules = null</span>
<a href="#l51.56"></a><span id="l51.56" class="difflineplus">+            categoriesCapsules = null;</span>
<a href="#l51.57"></a><span id="l51.57">         }</span>
<a href="#l51.58"></a><span id="l51.58">         let categoriesDiv = React.DOM.div(</span>
<a href="#l51.59"></a><span id="l51.59">             {id: 'categoriesDiv', className: 'box'},</span>
<a href="#l51.60"></a><span id="l51.60">             'Categories ',</span>
<a href="#l51.61"></a><span id="l51.61">             categoriesCapsules,</span>
<a href="#l51.62"></a><span id="l51.62">             React.createElement(Link, {</span>
<a href="#l51.63"></a><span id="l51.63">                 value: 'Add Categories',</span>
<a href="#l51.64"></a><span id="l51.64">                 onInput: this.linkClicked</span>
<a href="#l51.65"></a><span id="l51.65" class="difflineat">@@ -581,10 +581,10 @@ var TopComponent = React.createClass({</span>
<a href="#l51.66"></a><span id="l51.66">                 )</span>
<a href="#l51.67"></a><span id="l51.67">             );</span>
<a href="#l51.68"></a><span id="l51.68">         }</span>
<a href="#l51.69"></a><span id="l51.69">     }</span>
<a href="#l51.70"></a><span id="l51.70"> });</span>
<a href="#l51.71"></a><span id="l51.71"> </span>
<a href="#l51.72"></a><span id="l51.72"> window.onload = function() {</span>
<a href="#l51.73"></a><span id="l51.73">     onLoad();</span>
<a href="#l51.74"></a><span id="l51.74" class="difflineminus">-}</span>
<a href="#l51.75"></a><span id="l51.75" class="difflineplus">+};</span>
<a href="#l51.76"></a><span id="l51.76"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l52.1"></a><span id="l52.1" class="difflineminus">--- a/calendar/lightning/content/imip-bar.js</span>
<a href="#l52.2"></a><span id="l52.2" class="difflineplus">+++ b/calendar/lightning/content/imip-bar.js</span>
<a href="#l52.3"></a><span id="l52.3" class="difflineat">@@ -217,17 +217,17 @@ var ltnImipBar = {</span>
<a href="#l52.4"></a><span id="l52.4">                 for (let identity in fixIterator(am.allIdentities,</span>
<a href="#l52.5"></a><span id="l52.5">                                                  Components.interfaces.nsIMsgIdentity)) {</span>
<a href="#l52.6"></a><span id="l52.6">                     if (author.includes(identity.email) &amp;&amp; !identity.fccReplyFollowParent) {</span>
<a href="#l52.7"></a><span id="l52.7">                         return true;</span>
<a href="#l52.8"></a><span id="l52.8">                     }</span>
<a href="#l52.9"></a><span id="l52.9">                 }</span>
<a href="#l52.10"></a><span id="l52.10">             }</span>
<a href="#l52.11"></a><span id="l52.11">             return false;</span>
<a href="#l52.12"></a><span id="l52.12" class="difflineminus">-        }</span>
<a href="#l52.13"></a><span id="l52.13" class="difflineplus">+        };</span>
<a href="#l52.14"></a><span id="l52.14"> </span>
<a href="#l52.15"></a><span id="l52.15">         // We override the bar label for sent out invitations and in case the event does not exist</span>
<a href="#l52.16"></a><span id="l52.16">         // anymore, we also clear the buttons if any to avoid e.g. accept/decline buttons</span>
<a href="#l52.17"></a><span id="l52.17">         if (isOutgoing(gMessageDisplay.displayedMessage)) {</span>
<a href="#l52.18"></a><span id="l52.18">             if (ltnImipBar.foundItems &amp;&amp; ltnImipBar.foundItems[0]) {</span>
<a href="#l52.19"></a><span id="l52.19">                 data.label = ltn.getString(&quot;lightning&quot;, &quot;imipBarSentText&quot;);</span>
<a href="#l52.20"></a><span id="l52.20">             } else {</span>
<a href="#l52.21"></a><span id="l52.21">                 data = {label: ltn.getString(&quot;lightning&quot;, &quot;imipBarSentButRemovedText&quot;),</span>
<a href="#l52.22"></a><span id="l52.22" class="difflineat">@@ -368,17 +368,17 @@ var ltnImipBar = {</span>
<a href="#l52.23"></a><span id="l52.23">                                                                     responseMethod: &quot;PUBLISH&quot;});</span>
<a href="#l52.24"></a><span id="l52.24">                     // control to avoid processing _execAction on later user changes on the item</span>
<a href="#l52.25"></a><span id="l52.25">                     let isFirstProcessing = true;</span>
<a href="#l52.26"></a><span id="l52.26">                     // setup callback and trigger re-processing</span>
<a href="#l52.27"></a><span id="l52.27">                     let storeCopy = function storeCopy(aItipItem, aRc, aActionFunc, aFoundItems) {</span>
<a href="#l52.28"></a><span id="l52.28">                         if (isFirstProcessing &amp;&amp; aActionFunc &amp;&amp; Components.isSuccessCode(aRc)) {</span>
<a href="#l52.29"></a><span id="l52.29">                             _execAction(aActionFunc, aItipItem, window, partStat);</span>
<a href="#l52.30"></a><span id="l52.30">                         }</span>
<a href="#l52.31"></a><span id="l52.31" class="difflineminus">-                    }</span>
<a href="#l52.32"></a><span id="l52.32" class="difflineplus">+                    };</span>
<a href="#l52.33"></a><span id="l52.33">                     cal.itip.processItipItem(newItipItem, storeCopy);</span>
<a href="#l52.34"></a><span id="l52.34">                     isFirstProcessing = false;</span>
<a href="#l52.35"></a><span id="l52.35">                 }</span>
<a href="#l52.36"></a><span id="l52.36">                 // we stop here to not process the original item</span>
<a href="#l52.37"></a><span id="l52.37">                 return false;</span>
<a href="#l52.38"></a><span id="l52.38">             }</span>
<a href="#l52.39"></a><span id="l52.39">             return _execAction(ltnImipBar.actionFunc, ltnImipBar.itipItem, window, partStat);</span>
<a href="#l52.40"></a><span id="l52.40">         }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l53.1"></a><span id="l53.1" class="difflineminus">--- a/calendar/lightning/content/lightning-item-iframe.js</span>
<a href="#l53.2"></a><span id="l53.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-item-iframe.js</span>
<a href="#l53.3"></a><span id="l53.3" class="difflineat">@@ -38,17 +38,17 @@ var gWarning = false;</span>
<a href="#l53.4"></a><span id="l53.4"> var gPreviousCalendarId = null;</span>
<a href="#l53.5"></a><span id="l53.5"> var gTabInfoObject;</span>
<a href="#l53.6"></a><span id="l53.6"> var gConfig = {</span>
<a href="#l53.7"></a><span id="l53.7">     priority: 0,</span>
<a href="#l53.8"></a><span id="l53.8">     privacy: null,</span>
<a href="#l53.9"></a><span id="l53.9">     status: &quot;NONE&quot;,</span>
<a href="#l53.10"></a><span id="l53.10">     showTimeAs: null,</span>
<a href="#l53.11"></a><span id="l53.11">     percentComplete: 0</span>
<a href="#l53.12"></a><span id="l53.12" class="difflineminus">-}</span>
<a href="#l53.13"></a><span id="l53.13" class="difflineplus">+};</span>
<a href="#l53.14"></a><span id="l53.14"> // The following variables are set by the load handler function of the</span>
<a href="#l53.15"></a><span id="l53.15"> // parent context, so that they are already set before iframe content load:</span>
<a href="#l53.16"></a><span id="l53.16"> //   - gTimezoneEnabled</span>
<a href="#l53.17"></a><span id="l53.17"> //   - gShowLink</span>
<a href="#l53.18"></a><span id="l53.18"> </span>
<a href="#l53.19"></a><span id="l53.19"> var eventDialogQuitObserver = {</span>
<a href="#l53.20"></a><span id="l53.20">   observe: function(aSubject, aTopic, aData) {</span>
<a href="#l53.21"></a><span id="l53.21">     // Check whether or not we want to veto the quit request (unless another</span>
<a href="#l53.22"></a><span id="l53.22" class="difflineat">@@ -270,17 +270,17 @@ function onLoad() {</span>
<a href="#l53.23"></a><span id="l53.23">             this.onAccept();</span>
<a href="#l53.24"></a><span id="l53.24"> </span>
<a href="#l53.25"></a><span id="l53.25">             let item = window.calendarItem;</span>
<a href="#l53.26"></a><span id="l53.26"> </span>
<a href="#l53.27"></a><span id="l53.27">             // ...and close the window.</span>
<a href="#l53.28"></a><span id="l53.28">             sendMessage({ command: &quot;closeWindowOrTab&quot;, iframeId: iframeId });</span>
<a href="#l53.29"></a><span id="l53.29"> </span>
<a href="#l53.30"></a><span id="l53.30">             return item;</span>
<a href="#l53.31"></a><span id="l53.31" class="difflineminus">-        }</span>
<a href="#l53.32"></a><span id="l53.32" class="difflineplus">+        };</span>
<a href="#l53.33"></a><span id="l53.33">     }</span>
<a href="#l53.34"></a><span id="l53.34"> </span>
<a href="#l53.35"></a><span id="l53.35">     window.fbWrapper = args.fbWrapper;</span>
<a href="#l53.36"></a><span id="l53.36"> </span>
<a href="#l53.37"></a><span id="l53.37">     // the most important attribute we expect from the</span>
<a href="#l53.38"></a><span id="l53.38">     // arguments is the item we'll edit in the dialog.</span>
<a href="#l53.39"></a><span id="l53.39">     let item = args.calendarEvent;</span>
<a href="#l53.40"></a><span id="l53.40"> </span>
<a href="#l53.41"></a><span id="l53.41" class="difflineat">@@ -291,17 +291,17 @@ function onLoad() {</span>
<a href="#l53.42"></a><span id="l53.42"> </span>
<a href="#l53.43"></a><span id="l53.43">     // new items should have a non-empty title.</span>
<a href="#l53.44"></a><span id="l53.44">     if (item.isMutable &amp;&amp; (!item.title || item.title.length &lt;= 0)) {</span>
<a href="#l53.45"></a><span id="l53.45">         item.title = cal.calGetString(&quot;calendar-event-dialog&quot;,</span>
<a href="#l53.46"></a><span id="l53.46">                                       isEvent(item) ? &quot;newEvent&quot; : &quot;newTask&quot;);</span>
<a href="#l53.47"></a><span id="l53.47">     }</span>
<a href="#l53.48"></a><span id="l53.48"> </span>
<a href="#l53.49"></a><span id="l53.49">     window.onAcceptCallback = args.onOk;</span>
<a href="#l53.50"></a><span id="l53.50" class="difflineminus">-    window.mode = args.mode</span>
<a href="#l53.51"></a><span id="l53.51" class="difflineplus">+    window.mode = args.mode;</span>
<a href="#l53.52"></a><span id="l53.52"> </span>
<a href="#l53.53"></a><span id="l53.53">     // we store the item in the window to be able</span>
<a href="#l53.54"></a><span id="l53.54">     // to access this from any location. please note</span>
<a href="#l53.55"></a><span id="l53.55">     // that the item is either an occurrence [proxy]</span>
<a href="#l53.56"></a><span id="l53.56">     // or the stand-alone item [single occurrence item].</span>
<a href="#l53.57"></a><span id="l53.57">     window.calendarItem = item;</span>
<a href="#l53.58"></a><span id="l53.58">     // store the initial date value for datepickers in New Task dialog</span>
<a href="#l53.59"></a><span id="l53.59">     window.initialStartDateValue = args.initialStartDateValue;</span>
<a href="#l53.60"></a><span id="l53.60" class="difflineat">@@ -535,17 +535,17 @@ function loadDialog(aItem) {</span>
<a href="#l53.61"></a><span id="l53.61">         // Properties for initializing the React component/UI.</span>
<a href="#l53.62"></a><span id="l53.62">         itemProps = {</span>
<a href="#l53.63"></a><span id="l53.63">             initialTitle: aItem.title,</span>
<a href="#l53.64"></a><span id="l53.64">             initialLocation: aItem.getProperty('LOCATION'),</span>
<a href="#l53.65"></a><span id="l53.65">             initialStartTimezone: gStartTimezone,</span>
<a href="#l53.66"></a><span id="l53.66">             initialEndTimezone: gEndTimezone,</span>
<a href="#l53.67"></a><span id="l53.67">             initialStartTime: gStartTime,</span>
<a href="#l53.68"></a><span id="l53.68">             initialEndTime: gEndTime</span>
<a href="#l53.69"></a><span id="l53.69" class="difflineminus">-        }</span>
<a href="#l53.70"></a><span id="l53.70" class="difflineplus">+        };</span>
<a href="#l53.71"></a><span id="l53.71">     } else {</span>
<a href="#l53.72"></a><span id="l53.72">         setElementValue(&quot;item-title&quot;, aItem.title);</span>
<a href="#l53.73"></a><span id="l53.73">         setElementValue(&quot;item-location&quot;, aItem.getProperty(&quot;LOCATION&quot;));</span>
<a href="#l53.74"></a><span id="l53.74">     }</span>
<a href="#l53.75"></a><span id="l53.75"> </span>
<a href="#l53.76"></a><span id="l53.76">     // add calendars to the calendar menulist</span>
<a href="#l53.77"></a><span id="l53.77">     if (gNewItemUI) {</span>
<a href="#l53.78"></a><span id="l53.78">         let calendarToUse = aItem.calendar || window.arguments[0].calendar;</span>
<a href="#l53.79"></a><span id="l53.79" class="difflineat">@@ -1809,17 +1809,17 @@ function editAttendees() {</span>
<a href="#l53.80"></a><span id="l53.80">         gEndTimezone = endTime.timezone;</span>
<a href="#l53.81"></a><span id="l53.81">         gStartTime = startTime.getInTimezone(kDefaultTimezone);</span>
<a href="#l53.82"></a><span id="l53.82">         gEndTime = endTime.getInTimezone(kDefaultTimezone);</span>
<a href="#l53.83"></a><span id="l53.83">         gItemDuration = duration;</span>
<a href="#l53.84"></a><span id="l53.84">         updateAttendees();</span>
<a href="#l53.85"></a><span id="l53.85">         updateDateTime();</span>
<a href="#l53.86"></a><span id="l53.86">         updateAllDay();</span>
<a href="#l53.87"></a><span id="l53.87">         if (isAllDay != gStartTime.isDate){</span>
<a href="#l53.88"></a><span id="l53.88" class="difflineminus">-            setShowTimeAs(gStartTime.isDate)</span>
<a href="#l53.89"></a><span id="l53.89" class="difflineplus">+            setShowTimeAs(gStartTime.isDate);</span>
<a href="#l53.90"></a><span id="l53.90">         }</span>
<a href="#l53.91"></a><span id="l53.91">     };</span>
<a href="#l53.92"></a><span id="l53.92"> </span>
<a href="#l53.93"></a><span id="l53.93">     var startTime = gStartTime.getInTimezone(gStartTimezone);</span>
<a href="#l53.94"></a><span id="l53.94">     var endTime = gEndTime.getInTimezone(gEndTimezone);</span>
<a href="#l53.95"></a><span id="l53.95"> </span>
<a href="#l53.96"></a><span id="l53.96">     var isAllDay = getElementValue(&quot;event-all-day&quot;, &quot;checked&quot;);</span>
<a href="#l53.97"></a><span id="l53.97">     if (isAllDay) {</span>
<a href="#l53.98"></a><span id="l53.98" class="difflineat">@@ -3357,17 +3357,17 @@ function updateDateTime() {</span>
<a href="#l53.99"></a><span id="l53.99">             } else if (hasDueDate) {</span>
<a href="#l53.100"></a><span id="l53.100">                 endTime.timezone = floating();</span>
<a href="#l53.101"></a><span id="l53.101">                 setElementValue(&quot;todo-entrydate&quot;, cal.dateTimeToJsDate(endTime));</span>
<a href="#l53.102"></a><span id="l53.102"> </span>
<a href="#l53.103"></a><span id="l53.103">                 setElementValue(&quot;todo-has-duedate&quot;, hasDueDate, &quot;checked&quot;);</span>
<a href="#l53.104"></a><span id="l53.104">                 endTime.timezone = floating();</span>
<a href="#l53.105"></a><span id="l53.105">                 setElementValue(&quot;todo-duedate&quot;, cal.dateTimeToJsDate(endTime));</span>
<a href="#l53.106"></a><span id="l53.106">             } else {</span>
<a href="#l53.107"></a><span id="l53.107" class="difflineminus">-                startTime = window.initialStartDateValue</span>
<a href="#l53.108"></a><span id="l53.108" class="difflineplus">+                startTime = window.initialStartDateValue;</span>
<a href="#l53.109"></a><span id="l53.109">                 startTime.timezone = floating();</span>
<a href="#l53.110"></a><span id="l53.110">                 endTime = startTime.clone();</span>
<a href="#l53.111"></a><span id="l53.111"> </span>
<a href="#l53.112"></a><span id="l53.112">                 setElementValue(&quot;todo-entrydate&quot;, cal.dateTimeToJsDate(startTime));</span>
<a href="#l53.113"></a><span id="l53.113">                 setElementValue(&quot;todo-duedate&quot;, cal.dateTimeToJsDate(endTime));</span>
<a href="#l53.114"></a><span id="l53.114">             }</span>
<a href="#l53.115"></a><span id="l53.115">         }</span>
<a href="#l53.116"></a><span id="l53.116">     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l54.1"></a><span id="l54.1" class="difflineminus">--- a/calendar/lightning/content/lightning-item-panel.js</span>
<a href="#l54.2"></a><span id="l54.2" class="difflineplus">+++ b/calendar/lightning/content/lightning-item-panel.js</span>
<a href="#l54.3"></a><span id="l54.3" class="difflineat">@@ -30,39 +30,39 @@ if (!gTabmail) {</span>
<a href="#l54.4"></a><span id="l54.4">      */</span>
<a href="#l54.5"></a><span id="l54.5">     window.goUpdateGlobalEditMenuItems = () =&gt; {</span>
<a href="#l54.6"></a><span id="l54.6">         goUpdateCommand(&quot;cmd_undo&quot;);</span>
<a href="#l54.7"></a><span id="l54.7">         goUpdateCommand(&quot;cmd_redo&quot;);</span>
<a href="#l54.8"></a><span id="l54.8">         goUpdateCommand(&quot;cmd_cut&quot;);</span>
<a href="#l54.9"></a><span id="l54.9">         goUpdateCommand(&quot;cmd_copy&quot;);</span>
<a href="#l54.10"></a><span id="l54.10">         goUpdateCommand(&quot;cmd_paste&quot;);</span>
<a href="#l54.11"></a><span id="l54.11">         goUpdateCommand(&quot;cmd_selectAll&quot;);</span>
<a href="#l54.12"></a><span id="l54.12" class="difflineminus">-    }</span>
<a href="#l54.13"></a><span id="l54.13" class="difflineplus">+    };</span>
<a href="#l54.14"></a><span id="l54.14">     /**</span>
<a href="#l54.15"></a><span id="l54.15">      * Update menu items that rely on the current selection.</span>
<a href="#l54.16"></a><span id="l54.16">      */</span>
<a href="#l54.17"></a><span id="l54.17">     window.goUpdateSelectEditMenuItems = () =&gt; {</span>
<a href="#l54.18"></a><span id="l54.18">         goUpdateCommand(&quot;cmd_cut&quot;);</span>
<a href="#l54.19"></a><span id="l54.19">         goUpdateCommand(&quot;cmd_copy&quot;);</span>
<a href="#l54.20"></a><span id="l54.20">         goUpdateCommand(&quot;cmd_delete&quot;);</span>
<a href="#l54.21"></a><span id="l54.21">         goUpdateCommand(&quot;cmd_selectAll&quot;);</span>
<a href="#l54.22"></a><span id="l54.22" class="difflineminus">-    }</span>
<a href="#l54.23"></a><span id="l54.23" class="difflineplus">+    };</span>
<a href="#l54.24"></a><span id="l54.24">     /**</span>
<a href="#l54.25"></a><span id="l54.25">      * Update menu items that relate to undo/redo.</span>
<a href="#l54.26"></a><span id="l54.26">      */</span>
<a href="#l54.27"></a><span id="l54.27">     window.goUpdateUndoEditMenuItems = () =&gt; {</span>
<a href="#l54.28"></a><span id="l54.28">         goUpdateCommand(&quot;cmd_undo&quot;);</span>
<a href="#l54.29"></a><span id="l54.29">         goUpdateCommand(&quot;cmd_redo&quot;);</span>
<a href="#l54.30"></a><span id="l54.30" class="difflineminus">-    }</span>
<a href="#l54.31"></a><span id="l54.31" class="difflineplus">+    };</span>
<a href="#l54.32"></a><span id="l54.32">     /**</span>
<a href="#l54.33"></a><span id="l54.33">      * Update menu items that depend on clipboard contents.</span>
<a href="#l54.34"></a><span id="l54.34">      */</span>
<a href="#l54.35"></a><span id="l54.35">     window.goUpdatePasteMenuItems = () =&gt; {</span>
<a href="#l54.36"></a><span id="l54.36">         goUpdateCommand(&quot;cmd_paste&quot;);</span>
<a href="#l54.37"></a><span id="l54.37" class="difflineminus">-    }</span>
<a href="#l54.38"></a><span id="l54.38" class="difflineplus">+    };</span>
<a href="#l54.39"></a><span id="l54.39"> }</span>
<a href="#l54.40"></a><span id="l54.40"> </span>
<a href="#l54.41"></a><span id="l54.41"> // Stores the ids of the iframes of currently open event/task tabs, used</span>
<a href="#l54.42"></a><span id="l54.42"> // when window is closed to prompt for saving changes.</span>
<a href="#l54.43"></a><span id="l54.43"> var gItemTabIds = [];</span>
<a href="#l54.44"></a><span id="l54.44"> var gItemTabIdsCopy;</span>
<a href="#l54.45"></a><span id="l54.45"> </span>
<a href="#l54.46"></a><span id="l54.46"> // gConfig is used when switching tabs to restore the state of</span>
<a href="#l54.47"></a><span id="l54.47" class="difflineat">@@ -80,17 +80,17 @@ var gConfig = {</span>
<a href="#l54.48"></a><span id="l54.48">     showTimeAs: null,</span>
<a href="#l54.49"></a><span id="l54.49">     // whether commands are enabled or disabled</span>
<a href="#l54.50"></a><span id="l54.50">     attendeesCommand: null, // cmd_attendees</span>
<a href="#l54.51"></a><span id="l54.51">     attachUrlCommand: null, // cmd_attach_url</span>
<a href="#l54.52"></a><span id="l54.52">     timezonesEnabled: false, // cmd_timezone</span>
<a href="#l54.53"></a><span id="l54.53">     // XXX Currently there is no toolbar button or menu item for</span>
<a href="#l54.54"></a><span id="l54.54">     // cmd_toggle_link for event/task tabs</span>
<a href="#l54.55"></a><span id="l54.55">     toggleLinkCommand: null // cmd_toggle_link</span>
<a href="#l54.56"></a><span id="l54.56" class="difflineminus">-}</span>
<a href="#l54.57"></a><span id="l54.57" class="difflineplus">+};</span>
<a href="#l54.58"></a><span id="l54.58"> </span>
<a href="#l54.59"></a><span id="l54.59"> /**</span>
<a href="#l54.60"></a><span id="l54.60">  * Receive an asynchronous message from the iframe.</span>
<a href="#l54.61"></a><span id="l54.61">  *</span>
<a href="#l54.62"></a><span id="l54.62">  * @param {MessageEvent} aEvent  Contains the message being received</span>
<a href="#l54.63"></a><span id="l54.63">  */</span>
<a href="#l54.64"></a><span id="l54.64"> function receiveMessage(aEvent) {</span>
<a href="#l54.65"></a><span id="l54.65">     if (aEvent.origin !== &quot;chrome://lightning&quot;) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l55.1"></a><span id="l55.1" class="difflineminus">--- a/calendar/lightning/content/messenger-overlay-sidebar.js</span>
<a href="#l55.2"></a><span id="l55.2" class="difflineplus">+++ b/calendar/lightning/content/messenger-overlay-sidebar.js</span>
<a href="#l55.3"></a><span id="l55.3" class="difflineat">@@ -517,17 +517,17 @@ function ltnIntegrationCheck() {</span>
<a href="#l55.4"></a><span id="l55.4">         if (cnt.value == 1 &amp;&amp;</span>
<a href="#l55.5"></a><span id="l55.5">             calMgr.getCalendarPref_(cals[0], &quot;type&quot;) == &quot;storage&quot; &amp;&amp;</span>
<a href="#l55.6"></a><span id="l55.6">             calMgr.getCalendarPref_(cals[0], &quot;name&quot;) == homeCalName) {</span>
<a href="#l55.7"></a><span id="l55.7">             // this looks like a default setup, so let's see whether the calendar contains any items</span>
<a href="#l55.8"></a><span id="l55.8">             let pCal = cal.async.promisifyCalendar(cals[0]);</span>
<a href="#l55.9"></a><span id="l55.9">             // we look at all items at any time, but we can stop if the first item was found</span>
<a href="#l55.10"></a><span id="l55.10">             // if we've found no items, we call ltnIntegrationNotification to display the bar</span>
<a href="#l55.11"></a><span id="l55.11">             pCal.getItems(Components.interfaces.calICalendar.ITEM_FILTER_ALL_ITEMS, 1, null, null)</span>
<a href="#l55.12"></a><span id="l55.12" class="difflineminus">-                .then(function(aItems) {if (!aItems.length) {ltnIntegrationNotification()}});</span>
<a href="#l55.13"></a><span id="l55.13" class="difflineplus">+                .then(function(aItems) {if (!aItems.length) {ltnIntegrationNotification();}});</span>
<a href="#l55.14"></a><span id="l55.14">         }</span>
<a href="#l55.15"></a><span id="l55.15">     }</span>
<a href="#l55.16"></a><span id="l55.16"> }</span>
<a href="#l55.17"></a><span id="l55.17"> </span>
<a href="#l55.18"></a><span id="l55.18"> /* Called at midnight to tell us to redraw date-specific widgets.  Do NOT call</span>
<a href="#l55.19"></a><span id="l55.19">  * this for normal refresh, since it also calls scheduleMidnightRefresh.</span>
<a href="#l55.20"></a><span id="l55.20">  */</span>
<a href="#l55.21"></a><span id="l55.21"> function refreshUIBits() {</span>
<a href="#l55.22"></a><span id="l55.22" class="difflineat">@@ -602,17 +602,17 @@ function LtnObserveDisplayDeckChange(eve</span>
<a href="#l55.23"></a><span id="l55.23"> </span>
<a href="#l55.24"></a><span id="l55.24">     // Bug 309505: The 'select' event also fires when we change the selected</span>
<a href="#l55.25"></a><span id="l55.25">     // panel of calendar-view-box.  Workaround with this check.</span>
<a href="#l55.26"></a><span id="l55.26">     if (deck.id != &quot;calendarDisplayDeck&quot;) {</span>
<a href="#l55.27"></a><span id="l55.27">         return;</span>
<a href="#l55.28"></a><span id="l55.28">     }</span>
<a href="#l55.29"></a><span id="l55.29"> </span>
<a href="#l55.30"></a><span id="l55.30">     var id = null;</span>
<a href="#l55.31"></a><span id="l55.31" class="difflineminus">-    try { id = deck.selectedPanel.id } catch (e) { }</span>
<a href="#l55.32"></a><span id="l55.32" class="difflineplus">+    try { id = deck.selectedPanel.id; } catch (e) { }</span>
<a href="#l55.33"></a><span id="l55.33"> </span>
<a href="#l55.34"></a><span id="l55.34">     // Switch back to mail mode in case we find that this</span>
<a href="#l55.35"></a><span id="l55.35">     // notification has been fired but we're still in calendar or task mode.</span>
<a href="#l55.36"></a><span id="l55.36">     // Specifically, switch back if we're *not* in mail mode but the notification</span>
<a href="#l55.37"></a><span id="l55.37">     // did *not* come from either the &quot;calendar-view-box&quot; or the &quot;calendar-task-box&quot;.</span>
<a href="#l55.38"></a><span id="l55.38">     if (gCurrentMode != 'mail') {</span>
<a href="#l55.39"></a><span id="l55.39">         if (id != &quot;calendar-view-box&quot; &amp;&amp; id != &quot;calendar-task-box&quot;) {</span>
<a href="#l55.40"></a><span id="l55.40">             ltnSwitch2Mail();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l56.1"></a><span id="l56.1" class="difflineminus">--- a/calendar/lightning/content/suite-overlay-sidebar.js</span>
<a href="#l56.2"></a><span id="l56.2" class="difflineplus">+++ b/calendar/lightning/content/suite-overlay-sidebar.js</span>
<a href="#l56.3"></a><span id="l56.3" class="difflineat">@@ -34,11 +34,11 @@ var ltnSuiteUtils = {</span>
<a href="#l56.4"></a><span id="l56.4">           toolboxCustomizeDone(&quot;mail-menubar&quot;, toolbox, aToolboxChanged);</span>
<a href="#l56.5"></a><span id="l56.5">         };</span>
<a href="#l56.6"></a><span id="l56.6">         toolbox.customizeChange = function(aEvent) {</span>
<a href="#l56.7"></a><span id="l56.7">           toolboxCustomizeChange(toolbox, aEvent);</span>
<a href="#l56.8"></a><span id="l56.8">         };</span>
<a href="#l56.9"></a><span id="l56.9">       });</span>
<a href="#l56.10"></a><span id="l56.10">     }</span>
<a href="#l56.11"></a><span id="l56.11">   }</span>
<a href="#l56.12"></a><span id="l56.12" class="difflineminus">-}</span>
<a href="#l56.13"></a><span id="l56.13" class="difflineplus">+};</span>
<a href="#l56.14"></a><span id="l56.14"> </span>
<a href="#l56.15"></a><span id="l56.15"> ltnSuiteUtils.addStartupObserver();</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l57.1"></a><span id="l57.1" class="difflineminus">--- a/calendar/lightning/modules/ltnInvitationUtils.jsm</span>
<a href="#l57.2"></a><span id="l57.2" class="difflineplus">+++ b/calendar/lightning/modules/ltnInvitationUtils.jsm</span>
<a href="#l57.3"></a><span id="l57.3" class="difflineat">@@ -97,17 +97,17 @@ ltn.invitation = {</span>
<a href="#l57.4"></a><span id="l57.4">                     mode = Components.interfaces.mozITXTToHTMLConv.kStructPhrase +</span>
<a href="#l57.5"></a><span id="l57.5">                            Components.interfaces.mozITXTToHTMLConv.kGlyphSubstitution +</span>
<a href="#l57.6"></a><span id="l57.6">                            Components.interfaces.mozITXTToHTMLConv.kURLs;</span>
<a href="#l57.7"></a><span id="l57.7">                     content.innerHTML = linkConverter.scanHTML(contentText, mode);</span>
<a href="#l57.8"></a><span id="l57.8">                 } else {</span>
<a href="#l57.9"></a><span id="l57.9">                     content.textContent = aContentText;</span>
<a href="#l57.10"></a><span id="l57.10">                 }</span>
<a href="#l57.11"></a><span id="l57.11">             }</span>
<a href="#l57.12"></a><span id="l57.12" class="difflineminus">-        }</span>
<a href="#l57.13"></a><span id="l57.13" class="difflineplus">+        };</span>
<a href="#l57.14"></a><span id="l57.14"> </span>
<a href="#l57.15"></a><span id="l57.15">         // Simple fields</span>
<a href="#l57.16"></a><span id="l57.16">         let headerDescr = doc.getElementById(&quot;imipHtml-header-descr&quot;);</span>
<a href="#l57.17"></a><span id="l57.17">         if (headerDescr) {</span>
<a href="#l57.18"></a><span id="l57.18">             headerDescr.textContent = ltn.invitation.getItipHeader(aItipItem);</span>
<a href="#l57.19"></a><span id="l57.19">         }</span>
<a href="#l57.20"></a><span id="l57.20"> </span>
<a href="#l57.21"></a><span id="l57.21">         field(&quot;summary&quot;, aEvent.title);</span>
<a href="#l57.22"></a><span id="l57.22" class="difflineat">@@ -127,28 +127,28 @@ ltn.invitation = {</span>
<a href="#l57.23"></a><span id="l57.23">                 dateString = repeatString;</span>
<a href="#l57.24"></a><span id="l57.24">             }</span>
<a href="#l57.25"></a><span id="l57.25"> </span>
<a href="#l57.26"></a><span id="l57.26">             let formattedExDates = [];</span>
<a href="#l57.27"></a><span id="l57.27">             let modifiedOccurrences = [];</span>
<a href="#l57.28"></a><span id="l57.28"> </span>
<a href="#l57.29"></a><span id="l57.29">             let dateComptor = function(a, b) {</span>
<a href="#l57.30"></a><span id="l57.30">                 return a.startDate.compare(b.startDate);</span>
<a href="#l57.31"></a><span id="l57.31" class="difflineminus">-            }</span>
<a href="#l57.32"></a><span id="l57.32" class="difflineplus">+            };</span>
<a href="#l57.33"></a><span id="l57.33"> </span>
<a href="#l57.34"></a><span id="l57.34">             // Show removed instances</span>
<a href="#l57.35"></a><span id="l57.35">             for (let exc of aEvent.recurrenceInfo.getRecurrenceItems({})) {</span>
<a href="#l57.36"></a><span id="l57.36">                 if (exc instanceof Components.interfaces.calIRecurrenceDate) {</span>
<a href="#l57.37"></a><span id="l57.37">                     if (exc.isNegative) {</span>
<a href="#l57.38"></a><span id="l57.38">                         // This is an EXDATE</span>
<a href="#l57.39"></a><span id="l57.39">                         formattedExDates.push(formatter.formatDateTime(exc.date));</span>
<a href="#l57.40"></a><span id="l57.40">                     } else {</span>
<a href="#l57.41"></a><span id="l57.41">                         // This is an RDATE, close enough to a modified occurrence</span>
<a href="#l57.42"></a><span id="l57.42">                         let excItem = aEvent.recurrenceInfo.getOccurrenceFor(exc.date);</span>
<a href="#l57.43"></a><span id="l57.43" class="difflineminus">-                        cal.binaryInsert(modifiedOccurrences, excItem, dateComptor, true)</span>
<a href="#l57.44"></a><span id="l57.44" class="difflineplus">+                        cal.binaryInsert(modifiedOccurrences, excItem, dateComptor, true);</span>
<a href="#l57.45"></a><span id="l57.45">                     }</span>
<a href="#l57.46"></a><span id="l57.46">                 }</span>
<a href="#l57.47"></a><span id="l57.47">             }</span>
<a href="#l57.48"></a><span id="l57.48">             if (formattedExDates.length &gt; 0) {</span>
<a href="#l57.49"></a><span id="l57.49">                 field(&quot;canceledOccurrences&quot;, formattedExDates.join(&quot;\n&quot;));</span>
<a href="#l57.50"></a><span id="l57.50">             }</span>
<a href="#l57.51"></a><span id="l57.51"> </span>
<a href="#l57.52"></a><span id="l57.52">             // Show modified occurrences</span>
<a href="#l57.53"></a><span id="l57.53" class="difflineat">@@ -156,29 +156,29 @@ ltn.invitation = {</span>
<a href="#l57.54"></a><span id="l57.54">                 let exc = aEvent.recurrenceInfo.getExceptionFor(recurrenceId);</span>
<a href="#l57.55"></a><span id="l57.55">                 let excLocation = exc.getProperty(&quot;LOCATION&quot;);</span>
<a href="#l57.56"></a><span id="l57.56"> </span>
<a href="#l57.57"></a><span id="l57.57">                 // Only show modified occurrence if start, duration or location</span>
<a href="#l57.58"></a><span id="l57.58">                 // has changed.</span>
<a href="#l57.59"></a><span id="l57.59">                 if (exc.startDate.compare(exc.recurrenceId) != 0 ||</span>
<a href="#l57.60"></a><span id="l57.60">                     exc.duration.compare(aEvent.duration) != 0 ||</span>
<a href="#l57.61"></a><span id="l57.61">                     excLocation != aEvent.getProperty(&quot;LOCATION&quot;)) {</span>
<a href="#l57.62"></a><span id="l57.62" class="difflineminus">-                    cal.binaryInsert(modifiedOccurrences, exc, dateComptor, true)</span>
<a href="#l57.63"></a><span id="l57.63" class="difflineplus">+                    cal.binaryInsert(modifiedOccurrences, exc, dateComptor, true);</span>
<a href="#l57.64"></a><span id="l57.64">                 }</span>
<a href="#l57.65"></a><span id="l57.65">             }</span>
<a href="#l57.66"></a><span id="l57.66"> </span>
<a href="#l57.67"></a><span id="l57.67">             let stringifyOcc = function(occ) {</span>
<a href="#l57.68"></a><span id="l57.68">                 let formattedExc = formatter.formatItemInterval(occ);</span>
<a href="#l57.69"></a><span id="l57.69">                 let occLocation = occ.getProperty(&quot;LOCATION&quot;);</span>
<a href="#l57.70"></a><span id="l57.70">                 if (occLocation != aEvent.getProperty(&quot;LOCATION&quot;)) {</span>
<a href="#l57.71"></a><span id="l57.71">                     let location = ltn.getString(&quot;lightning&quot;, &quot;imipHtml.newLocation&quot;, [occLocation]);</span>
<a href="#l57.72"></a><span id="l57.72">                     formattedExc += &quot; (&quot; + location + &quot;)&quot;;</span>
<a href="#l57.73"></a><span id="l57.73">                 }</span>
<a href="#l57.74"></a><span id="l57.74">                 return formattedExc;</span>
<a href="#l57.75"></a><span id="l57.75" class="difflineminus">-            }</span>
<a href="#l57.76"></a><span id="l57.76" class="difflineplus">+            };</span>
<a href="#l57.77"></a><span id="l57.77"> </span>
<a href="#l57.78"></a><span id="l57.78">             if (modifiedOccurrences.length &gt; 0) {</span>
<a href="#l57.79"></a><span id="l57.79">                 field(&quot;modifiedOccurrences&quot;, modifiedOccurrences.map(stringifyOcc).join(&quot;\n&quot;));</span>
<a href="#l57.80"></a><span id="l57.80">             }</span>
<a href="#l57.81"></a><span id="l57.81">         }</span>
<a href="#l57.82"></a><span id="l57.82"> </span>
<a href="#l57.83"></a><span id="l57.83">         field(&quot;when&quot;, dateString);</span>
<a href="#l57.84"></a><span id="l57.84">         field(&quot;comment&quot;, aEvent.getProperty(&quot;COMMENT&quot;), true);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l58.1"></a><span id="l58.1" class="difflineminus">--- a/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l58.2"></a><span id="l58.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavCalendar.js</span>
<a href="#l58.3"></a><span id="l58.3" class="difflineat">@@ -19,17 +19,17 @@ Components.utils.import(&quot;resource://cale</span>
<a href="#l58.4"></a><span id="l58.4"> Components.utils.import(&quot;resource://calendar/modules/calAsyncUtils.jsm&quot;);</span>
<a href="#l58.5"></a><span id="l58.5"> </span>
<a href="#l58.6"></a><span id="l58.6"> //</span>
<a href="#l58.7"></a><span id="l58.7"> // calDavCalendar.js</span>
<a href="#l58.8"></a><span id="l58.8"> //</span>
<a href="#l58.9"></a><span id="l58.9"> </span>
<a href="#l58.10"></a><span id="l58.10"> var xmlHeader = '&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n';</span>
<a href="#l58.11"></a><span id="l58.11"> </span>
<a href="#l58.12"></a><span id="l58.12" class="difflineminus">-var davNS = &quot;DAV:&quot;</span>
<a href="#l58.13"></a><span id="l58.13" class="difflineplus">+var davNS = &quot;DAV:&quot;;</span>
<a href="#l58.14"></a><span id="l58.14"> var caldavNS = &quot;urn:ietf:params:xml:ns:caldav&quot;;</span>
<a href="#l58.15"></a><span id="l58.15"> var calservNS = &quot;http://calendarserver.org/ns/&quot;;</span>
<a href="#l58.16"></a><span id="l58.16"> var MIME_TEXT_CALENDAR = &quot;text/calendar; charset=utf-8&quot;;</span>
<a href="#l58.17"></a><span id="l58.17"> var MIME_TEXT_XML = &quot;text/xml; charset=utf-8&quot;;</span>
<a href="#l58.18"></a><span id="l58.18"> </span>
<a href="#l58.19"></a><span id="l58.19"> var cICL = Components.interfaces.calIChangeLog;</span>
<a href="#l58.20"></a><span id="l58.20"> var cIOL = Components.interfaces.calIOperationListener;</span>
<a href="#l58.21"></a><span id="l58.21"> </span>
<a href="#l58.22"></a><span id="l58.22" class="difflineat">@@ -659,17 +659,17 @@ calDavCalendar.prototype = {</span>
<a href="#l58.23"></a><span id="l58.23">                 try {</span>
<a href="#l58.24"></a><span id="l58.24">                     responseStatus = request.responseStatus;</span>
<a href="#l58.25"></a><span id="l58.25"> </span>
<a href="#l58.26"></a><span id="l58.26">                     if (thisCalendar.verboseLogging()) {</span>
<a href="#l58.27"></a><span id="l58.27">                         let str = cal.convertByteArray(aResult, aResultLength);</span>
<a href="#l58.28"></a><span id="l58.28">                         cal.LOG(&quot;CalDAV: recv: &quot; + (str || &quot;&quot;));</span>
<a href="#l58.29"></a><span id="l58.29">                     }</span>
<a href="#l58.30"></a><span id="l58.30">                 } catch (ex) {</span>
<a href="#l58.31"></a><span id="l58.31" class="difflineminus">-                    listenerStatus = ex.result</span>
<a href="#l58.32"></a><span id="l58.32" class="difflineplus">+                    listenerStatus = ex.result;</span>
<a href="#l58.33"></a><span id="l58.33">                     listenerDetail = &quot;Request Failed: &quot; + ex.message;</span>
<a href="#l58.34"></a><span id="l58.34">                     cal.LOG(&quot;CalDAV: Request error during add: &quot; + ex);</span>
<a href="#l58.35"></a><span id="l58.35">                 }</span>
<a href="#l58.36"></a><span id="l58.36"> </span>
<a href="#l58.37"></a><span id="l58.37"> </span>
<a href="#l58.38"></a><span id="l58.38">                 // Translate the HTTP status code to a status and message for the listener</span>
<a href="#l58.39"></a><span id="l58.39">                 if (responseStatus == 201 || responseStatus == 204) {</span>
<a href="#l58.40"></a><span id="l58.40">                     // 201 = HTTP &quot;Created&quot;</span>
<a href="#l58.41"></a><span id="l58.41" class="difflineat">@@ -781,17 +781,17 @@ calDavCalendar.prototype = {</span>
<a href="#l58.42"></a><span id="l58.42">                 try {</span>
<a href="#l58.43"></a><span id="l58.43">                     responseStatus = request.responseStatus;</span>
<a href="#l58.44"></a><span id="l58.44"> </span>
<a href="#l58.45"></a><span id="l58.45">                     if (thisCalendar.verboseLogging()) {</span>
<a href="#l58.46"></a><span id="l58.46">                        let str = cal.convertByteArray(aResult, aResultLength);</span>
<a href="#l58.47"></a><span id="l58.47">                        cal.LOG(&quot;CalDAV: recv: &quot; + (str || &quot;&quot;));</span>
<a href="#l58.48"></a><span id="l58.48">                     }</span>
<a href="#l58.49"></a><span id="l58.49">                 } catch (ex) {</span>
<a href="#l58.50"></a><span id="l58.50" class="difflineminus">-                    listenerStatus = ex.result</span>
<a href="#l58.51"></a><span id="l58.51" class="difflineplus">+                    listenerStatus = ex.result;</span>
<a href="#l58.52"></a><span id="l58.52">                     listenerDetail = &quot;Request Failed: &quot; + ex.message;</span>
<a href="#l58.53"></a><span id="l58.53">                     cal.LOG(&quot;CalDAV: Request error during add: &quot; + ex);</span>
<a href="#l58.54"></a><span id="l58.54">                 }</span>
<a href="#l58.55"></a><span id="l58.55"> </span>
<a href="#l58.56"></a><span id="l58.56">                 if (responseStatus == 204 || responseStatus == 201 || responseStatus == 200) {</span>
<a href="#l58.57"></a><span id="l58.57">                     // We should not accept a 201 status here indefinitely: it indicates a server error</span>
<a href="#l58.58"></a><span id="l58.58">                     // of some kind that we want to know about. It's convenient to accept it for now</span>
<a href="#l58.59"></a><span id="l58.59">                     // since a number of server impls don't get this right yet.</span>
<a href="#l58.60"></a><span id="l58.60" class="difflineat">@@ -909,17 +909,17 @@ calDavCalendar.prototype = {</span>
<a href="#l58.61"></a><span id="l58.61">                 try {</span>
<a href="#l58.62"></a><span id="l58.62">                     responseStatus = request.responseStatus;</span>
<a href="#l58.63"></a><span id="l58.63"> </span>
<a href="#l58.64"></a><span id="l58.64">                     if (thisCalendar.verboseLogging()) {</span>
<a href="#l58.65"></a><span id="l58.65">                         let str = cal.convertByteArray(aResult, aResultLength);</span>
<a href="#l58.66"></a><span id="l58.66">                         cal.LOG(&quot;CalDAV: recv: &quot; + (str || &quot;&quot;));</span>
<a href="#l58.67"></a><span id="l58.67">                     }</span>
<a href="#l58.68"></a><span id="l58.68">                 } catch (ex) {</span>
<a href="#l58.69"></a><span id="l58.69" class="difflineminus">-                    listenerStatus = ex.result</span>
<a href="#l58.70"></a><span id="l58.70" class="difflineplus">+                    listenerStatus = ex.result;</span>
<a href="#l58.71"></a><span id="l58.71">                     listenerDetail = &quot;Request Failed: &quot; + ex.message;</span>
<a href="#l58.72"></a><span id="l58.72">                     cal.LOG(&quot;CalDAV: Request error during delete: &quot; + ex);</span>
<a href="#l58.73"></a><span id="l58.73">                 }</span>
<a href="#l58.74"></a><span id="l58.74"> </span>
<a href="#l58.75"></a><span id="l58.75">                 // 204 = HTTP &quot;No content&quot;</span>
<a href="#l58.76"></a><span id="l58.76">                 // 404 = Not Found - This is kind of a success, since the item is already deleted.</span>
<a href="#l58.77"></a><span id="l58.77">                 //</span>
<a href="#l58.78"></a><span id="l58.78">                 if (responseStatus == 204 || responseStatus == 200 || responseStatus == 404) {</span>
<a href="#l58.79"></a><span id="l58.79" class="difflineat">@@ -979,17 +979,17 @@ calDavCalendar.prototype = {</span>
<a href="#l58.80"></a><span id="l58.80">                 try {</span>
<a href="#l58.81"></a><span id="l58.81">                     responseStatus = request.responseStatus;</span>
<a href="#l58.82"></a><span id="l58.82"> </span>
<a href="#l58.83"></a><span id="l58.83">                     if (thisCalendar.verboseLogging()) {</span>
<a href="#l58.84"></a><span id="l58.84">                         let str = cal.convertByteArray(aResult, aResultLength);</span>
<a href="#l58.85"></a><span id="l58.85">                         cal.LOG(&quot;CalDAV: recv: &quot; + (str || &quot;&quot;));</span>
<a href="#l58.86"></a><span id="l58.86">                     }</span>
<a href="#l58.87"></a><span id="l58.87">                 } catch (ex) {</span>
<a href="#l58.88"></a><span id="l58.88" class="difflineminus">-                    listenerStatus = ex.result</span>
<a href="#l58.89"></a><span id="l58.89" class="difflineplus">+                    listenerStatus = ex.result;</span>
<a href="#l58.90"></a><span id="l58.90">                     listenerDetail = &quot;Request Failed: &quot; + ex.message;</span>
<a href="#l58.91"></a><span id="l58.91">                     cal.LOG(&quot;CalDAV: Request error during add: &quot; + ex);</span>
<a href="#l58.92"></a><span id="l58.92">                 }</span>
<a href="#l58.93"></a><span id="l58.93"> </span>
<a href="#l58.94"></a><span id="l58.94">                 if (responseStatus == 404) {</span>
<a href="#l58.95"></a><span id="l58.95">                     // Nothing to do (except notify the listener below)</span>
<a href="#l58.96"></a><span id="l58.96">                     // Someone else has already deleted it</span>
<a href="#l58.97"></a><span id="l58.97">                 } else if (responseStatus &gt;= 500 &amp;&amp; responseStatus &lt;= 510) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l59.1"></a><span id="l59.1" class="difflineminus">--- a/calendar/providers/caldav/calDavRequestHandlers.js</span>
<a href="#l59.2"></a><span id="l59.2" class="difflineplus">+++ b/calendar/providers/caldav/calDavRequestHandlers.js</span>
<a href="#l59.3"></a><span id="l59.3" class="difflineat">@@ -57,17 +57,17 @@ etagsHandler.prototype = {</span>
<a href="#l59.4"></a><span id="l59.4">     /**</span>
<a href="#l59.5"></a><span id="l59.5">      * @see nsIStreamListener</span>
<a href="#l59.6"></a><span id="l59.6">      */</span>
<a href="#l59.7"></a><span id="l59.7">     onStartRequest: function eSL_onStartRequest(request, context) {</span>
<a href="#l59.8"></a><span id="l59.8">         let httpchannel = request.QueryInterface(Components.interfaces.nsIHttpChannel);</span>
<a href="#l59.9"></a><span id="l59.9"> </span>
<a href="#l59.10"></a><span id="l59.10">         let responseStatus;</span>
<a href="#l59.11"></a><span id="l59.11">         try {</span>
<a href="#l59.12"></a><span id="l59.12" class="difflineminus">-            responseStatus = httpchannel.responseStatus</span>
<a href="#l59.13"></a><span id="l59.13" class="difflineplus">+            responseStatus = httpchannel.responseStatus;</span>
<a href="#l59.14"></a><span id="l59.14">         } catch (ex) {</span>
<a href="#l59.15"></a><span id="l59.15">             cal.WARN(&quot;CalDAV: No response status getting etags for calendar &quot; + this.calendar.name);</span>
<a href="#l59.16"></a><span id="l59.16">         }</span>
<a href="#l59.17"></a><span id="l59.17"> </span>
<a href="#l59.18"></a><span id="l59.18">         if (responseStatus == 207) {</span>
<a href="#l59.19"></a><span id="l59.19">             // We only need to parse 207's, anything else is probably a</span>
<a href="#l59.20"></a><span id="l59.20">             // server error (i.e 50x).</span>
<a href="#l59.21"></a><span id="l59.21">             httpchannel.contentType = &quot;application/xml&quot;;</span>
<a href="#l59.22"></a><span id="l59.22" class="difflineat">@@ -115,17 +115,17 @@ etagsHandler.prototype = {</span>
<a href="#l59.23"></a><span id="l59.23">                 // safely set variables from this function.</span>
<a href="#l59.24"></a><span id="l59.24">                 let pcal = cal.async.promisifyCalendar(this.calendar.mOfflineStorage);</span>
<a href="#l59.25"></a><span id="l59.25">                 let foundItem = (yield pcal.getItem(this.calendar.mHrefIndex[path]))[0];</span>
<a href="#l59.26"></a><span id="l59.26"> </span>
<a href="#l59.27"></a><span id="l59.27">                 if (foundItem) {</span>
<a href="#l59.28"></a><span id="l59.28">                     let wasInboxItem = this.calendar.mItemInfoCache[foundItem.id].isInboxItem;</span>
<a href="#l59.29"></a><span id="l59.29">                     if ((wasInboxItem &amp;&amp; this.calendar.isInbox(this.baseUri.spec)) ||</span>
<a href="#l59.30"></a><span id="l59.30">                         (wasInboxItem === false &amp;&amp; !this.calendar.isInbox(this.baseUri.spec))) {</span>
<a href="#l59.31"></a><span id="l59.31" class="difflineminus">-                        cal.LOG(&quot;Deleting local href: &quot; + path)</span>
<a href="#l59.32"></a><span id="l59.32" class="difflineplus">+                        cal.LOG(&quot;Deleting local href: &quot; + path);</span>
<a href="#l59.33"></a><span id="l59.33">                         delete this.calendar.mHrefIndex[path];</span>
<a href="#l59.34"></a><span id="l59.34">                         yield pcal.deleteItem(foundItem);</span>
<a href="#l59.35"></a><span id="l59.35">                         needsRefresh = true;</span>
<a href="#l59.36"></a><span id="l59.36">                     }</span>
<a href="#l59.37"></a><span id="l59.37">                 }</span>
<a href="#l59.38"></a><span id="l59.38">             }</span>
<a href="#l59.39"></a><span id="l59.39">         } finally {</span>
<a href="#l59.40"></a><span id="l59.40">             if (this.calendar.isCached) {</span>
<a href="#l59.41"></a><span id="l59.41" class="difflineat">@@ -152,17 +152,17 @@ etagsHandler.prototype = {</span>
<a href="#l59.42"></a><span id="l59.42">             }</span>
<a href="#l59.43"></a><span id="l59.43">         } else {</span>
<a href="#l59.44"></a><span id="l59.44">             let multiget = new multigetSyncHandler(this.itemsNeedFetching,</span>
<a href="#l59.45"></a><span id="l59.45">                                        this.calendar,</span>
<a href="#l59.46"></a><span id="l59.46">                                        this.baseUri,</span>
<a href="#l59.47"></a><span id="l59.47">                                        null,</span>
<a href="#l59.48"></a><span id="l59.48">                                        false,</span>
<a href="#l59.49"></a><span id="l59.49">                                        null,</span>
<a href="#l59.50"></a><span id="l59.50" class="difflineminus">-                                       this.changeLogListener)</span>
<a href="#l59.51"></a><span id="l59.51" class="difflineplus">+                                       this.changeLogListener);</span>
<a href="#l59.52"></a><span id="l59.52">             multiget.doMultiGet();</span>
<a href="#l59.53"></a><span id="l59.53">         }</span>
<a href="#l59.54"></a><span id="l59.54">     }),</span>
<a href="#l59.55"></a><span id="l59.55"> </span>
<a href="#l59.56"></a><span id="l59.56">     onDataAvailable: function eSL_onDataAvailable(request, context, inputStream, offset, count) {</span>
<a href="#l59.57"></a><span id="l59.57">         if (this._reader) {</span>
<a href="#l59.58"></a><span id="l59.58">             // No reader means request error</span>
<a href="#l59.59"></a><span id="l59.59">             this._reader.onDataAvailable(request, context, inputStream, offset, count);</span>
<a href="#l59.60"></a><span id="l59.60" class="difflineat">@@ -186,27 +186,27 @@ etagsHandler.prototype = {</span>
<a href="#l59.61"></a><span id="l59.61">             this.logXML += aValue;</span>
<a href="#l59.62"></a><span id="l59.62">         }</span>
<a href="#l59.63"></a><span id="l59.63">         this.currentResponse[this.tag] += aValue;</span>
<a href="#l59.64"></a><span id="l59.64">     },</span>
<a href="#l59.65"></a><span id="l59.65"> </span>
<a href="#l59.66"></a><span id="l59.66">     startDocument: function eH_startDocument() {</span>
<a href="#l59.67"></a><span id="l59.67">         this.hrefMap = {};</span>
<a href="#l59.68"></a><span id="l59.68">         this.currentResponse = {};</span>
<a href="#l59.69"></a><span id="l59.69" class="difflineminus">-        this.tag = null</span>
<a href="#l59.70"></a><span id="l59.70" class="difflineplus">+        this.tag = null;</span>
<a href="#l59.71"></a><span id="l59.71">     },</span>
<a href="#l59.72"></a><span id="l59.72"> </span>
<a href="#l59.73"></a><span id="l59.73">     endDocument: function eH_endDocument() { },</span>
<a href="#l59.74"></a><span id="l59.74"> </span>
<a href="#l59.75"></a><span id="l59.75">     startElement: function eH_startElement(aUri, aLocalName, aQName, aAttributes) {</span>
<a href="#l59.76"></a><span id="l59.76">         switch (aLocalName) {</span>
<a href="#l59.77"></a><span id="l59.77">             case &quot;response&quot;:</span>
<a href="#l59.78"></a><span id="l59.78">                 this.currentResponse = {};</span>
<a href="#l59.79"></a><span id="l59.79">                 this.currentResponse.isCollection = false;</span>
<a href="#l59.80"></a><span id="l59.80" class="difflineminus">-                this.tag = null</span>
<a href="#l59.81"></a><span id="l59.81" class="difflineplus">+                this.tag = null;</span>
<a href="#l59.82"></a><span id="l59.82">                 break;</span>
<a href="#l59.83"></a><span id="l59.83">             case &quot;collection&quot;:</span>
<a href="#l59.84"></a><span id="l59.84">                 this.currentResponse.isCollection = true;</span>
<a href="#l59.85"></a><span id="l59.85">             case &quot;href&quot;:</span>
<a href="#l59.86"></a><span id="l59.86">             case &quot;getetag&quot;:</span>
<a href="#l59.87"></a><span id="l59.87">             case &quot;getcontenttype&quot;:</span>
<a href="#l59.88"></a><span id="l59.88">                 this.tag = aLocalName;</span>
<a href="#l59.89"></a><span id="l59.89">                 this.currentResponse[aLocalName] = &quot;&quot;;</span>
<a href="#l59.90"></a><span id="l59.90" class="difflineat">@@ -367,17 +367,17 @@ webDavSyncHandler.prototype = {</span>
<a href="#l59.91"></a><span id="l59.91">     /**</span>
<a href="#l59.92"></a><span id="l59.92">      * @see nsIStreamListener</span>
<a href="#l59.93"></a><span id="l59.93">      */</span>
<a href="#l59.94"></a><span id="l59.94">     onStartRequest: function wSL_onStartRequest(request, context) {</span>
<a href="#l59.95"></a><span id="l59.95">         let httpchannel = request.QueryInterface(Components.interfaces.nsIHttpChannel);</span>
<a href="#l59.96"></a><span id="l59.96"> </span>
<a href="#l59.97"></a><span id="l59.97">         let responseStatus;</span>
<a href="#l59.98"></a><span id="l59.98">         try {</span>
<a href="#l59.99"></a><span id="l59.99" class="difflineminus">-            responseStatus = httpchannel.responseStatus</span>
<a href="#l59.100"></a><span id="l59.100" class="difflineplus">+            responseStatus = httpchannel.responseStatus;</span>
<a href="#l59.101"></a><span id="l59.101">         } catch (ex) {</span>
<a href="#l59.102"></a><span id="l59.102">             cal.WARN(&quot;CalDAV: No response status doing webdav sync for calendar &quot; + this.calendar.name);</span>
<a href="#l59.103"></a><span id="l59.103">         }</span>
<a href="#l59.104"></a><span id="l59.104"> </span>
<a href="#l59.105"></a><span id="l59.105">         if (responseStatus == 207) {</span>
<a href="#l59.106"></a><span id="l59.106">             // We only need to parse 207's, anything else is probably a</span>
<a href="#l59.107"></a><span id="l59.107">             // server error (i.e 50x).</span>
<a href="#l59.108"></a><span id="l59.108">             httpchannel.contentType = &quot;application/xml&quot;;</span>
<a href="#l59.109"></a><span id="l59.109" class="difflineat">@@ -441,17 +441,17 @@ webDavSyncHandler.prototype = {</span>
<a href="#l59.110"></a><span id="l59.110">             this.logXML += aValue;</span>
<a href="#l59.111"></a><span id="l59.111">         }</span>
<a href="#l59.112"></a><span id="l59.112">         this.currentResponse[this.tag] += aValue;</span>
<a href="#l59.113"></a><span id="l59.113">     },</span>
<a href="#l59.114"></a><span id="l59.114"> </span>
<a href="#l59.115"></a><span id="l59.115">     startDocument: function wH_startDocument() {</span>
<a href="#l59.116"></a><span id="l59.116">         this.hrefMap = {};</span>
<a href="#l59.117"></a><span id="l59.117">         this.currentResponse = {};</span>
<a href="#l59.118"></a><span id="l59.118" class="difflineminus">-        this.tag = null</span>
<a href="#l59.119"></a><span id="l59.119" class="difflineplus">+        this.tag = null;</span>
<a href="#l59.120"></a><span id="l59.120">         if (this.calendar.isCached) {</span>
<a href="#l59.121"></a><span id="l59.121">             this.calendar.superCalendar.startBatch();</span>
<a href="#l59.122"></a><span id="l59.122">         }</span>
<a href="#l59.123"></a><span id="l59.123">     },</span>
<a href="#l59.124"></a><span id="l59.124"> </span>
<a href="#l59.125"></a><span id="l59.125">     endDocument: function wH_endDocument() {</span>
<a href="#l59.126"></a><span id="l59.126">         if (this.unhandledErrors) {</span>
<a href="#l59.127"></a><span id="l59.127">             this.calendar.superCalendar.endBatch();</span>
<a href="#l59.128"></a><span id="l59.128" class="difflineat">@@ -487,26 +487,26 @@ webDavSyncHandler.prototype = {</span>
<a href="#l59.129"></a><span id="l59.129">                                                this.baseUri);</span>
<a href="#l59.130"></a><span id="l59.130">         } else {</span>
<a href="#l59.131"></a><span id="l59.131">             let multiget = new multigetSyncHandler(this.itemsNeedFetching,</span>
<a href="#l59.132"></a><span id="l59.132">                                                    this.calendar,</span>
<a href="#l59.133"></a><span id="l59.133">                                                    this.baseUri,</span>
<a href="#l59.134"></a><span id="l59.134">                                                    this.newSyncToken,</span>
<a href="#l59.135"></a><span id="l59.135">                                                    this.additionalSyncNeeded,</span>
<a href="#l59.136"></a><span id="l59.136">                                                    null,</span>
<a href="#l59.137"></a><span id="l59.137" class="difflineminus">-                                                   this.changeLogListener)</span>
<a href="#l59.138"></a><span id="l59.138" class="difflineplus">+                                                   this.changeLogListener);</span>
<a href="#l59.139"></a><span id="l59.139">             multiget.doMultiGet();</span>
<a href="#l59.140"></a><span id="l59.140">         }</span>
<a href="#l59.141"></a><span id="l59.141">     },</span>
<a href="#l59.142"></a><span id="l59.142"> </span>
<a href="#l59.143"></a><span id="l59.143">     startElement: function wH_startElement(aUri, aLocalName, aQName, aAttributes) {</span>
<a href="#l59.144"></a><span id="l59.144">         switch (aLocalName) {</span>
<a href="#l59.145"></a><span id="l59.145">             case &quot;response&quot;: // WebDAV Sync draft 3</span>
<a href="#l59.146"></a><span id="l59.146">                 this.currentResponse = {};</span>
<a href="#l59.147"></a><span id="l59.147" class="difflineminus">-                this.tag = null</span>
<a href="#l59.148"></a><span id="l59.148" class="difflineplus">+                this.tag = null;</span>
<a href="#l59.149"></a><span id="l59.149">                 this.isInPropStat = false;</span>
<a href="#l59.150"></a><span id="l59.150">                 break;</span>
<a href="#l59.151"></a><span id="l59.151">             case &quot;propstat&quot;:</span>
<a href="#l59.152"></a><span id="l59.152">                 this.isInPropStat = true;</span>
<a href="#l59.153"></a><span id="l59.153">                 break;</span>
<a href="#l59.154"></a><span id="l59.154">             case &quot;status&quot;:</span>
<a href="#l59.155"></a><span id="l59.155">                 if (this.isInPropStat) {</span>
<a href="#l59.156"></a><span id="l59.156">                     this.tag = &quot;propstat_&quot; + aLocalName;</span>
<a href="#l59.157"></a><span id="l59.157" class="difflineat">@@ -728,17 +728,17 @@ multigetSyncHandler.prototype = {</span>
<a href="#l59.158"></a><span id="l59.158">     /**</span>
<a href="#l59.159"></a><span id="l59.159">      * @see nsIStreamListener</span>
<a href="#l59.160"></a><span id="l59.160">      */</span>
<a href="#l59.161"></a><span id="l59.161">     onStartRequest: function mg_onStartRequest(request, context) {</span>
<a href="#l59.162"></a><span id="l59.162">         let httpchannel = request.QueryInterface(Components.interfaces.nsIHttpChannel);</span>
<a href="#l59.163"></a><span id="l59.163"> </span>
<a href="#l59.164"></a><span id="l59.164">         let responseStatus;</span>
<a href="#l59.165"></a><span id="l59.165">         try {</span>
<a href="#l59.166"></a><span id="l59.166" class="difflineminus">-            responseStatus = httpchannel.responseStatus</span>
<a href="#l59.167"></a><span id="l59.167" class="difflineplus">+            responseStatus = httpchannel.responseStatus;</span>
<a href="#l59.168"></a><span id="l59.168">         } catch (ex) {</span>
<a href="#l59.169"></a><span id="l59.169">             cal.WARN(&quot;CalDAV: No response status doing multiget for calendar &quot; + this.calendar.name);</span>
<a href="#l59.170"></a><span id="l59.170">         }</span>
<a href="#l59.171"></a><span id="l59.171"> </span>
<a href="#l59.172"></a><span id="l59.172">         if (responseStatus == 207) {</span>
<a href="#l59.173"></a><span id="l59.173">             // We only need to parse 207's, anything else is probably a</span>
<a href="#l59.174"></a><span id="l59.174">             // server error (i.e 50x).</span>
<a href="#l59.175"></a><span id="l59.175">             httpchannel.contentType = &quot;application/xml&quot;;</span>
<a href="#l59.176"></a><span id="l59.176" class="difflineat">@@ -834,34 +834,34 @@ multigetSyncHandler.prototype = {</span>
<a href="#l59.177"></a><span id="l59.177">             this.logXML += aValue;</span>
<a href="#l59.178"></a><span id="l59.178">         }</span>
<a href="#l59.179"></a><span id="l59.179">         this.currentResponse[this.tag] += aValue;</span>
<a href="#l59.180"></a><span id="l59.180">     },</span>
<a href="#l59.181"></a><span id="l59.181"> </span>
<a href="#l59.182"></a><span id="l59.182">     startDocument: function mg_startDocument() {</span>
<a href="#l59.183"></a><span id="l59.183">         this.hrefMap = {};</span>
<a href="#l59.184"></a><span id="l59.184">         this.currentResponse = {};</span>
<a href="#l59.185"></a><span id="l59.185" class="difflineminus">-        this.tag = null</span>
<a href="#l59.186"></a><span id="l59.186" class="difflineplus">+        this.tag = null;</span>
<a href="#l59.187"></a><span id="l59.187">         this.logXML = &quot;&quot;;</span>
<a href="#l59.188"></a><span id="l59.188">         if (this.calendar.isCached) {</span>
<a href="#l59.189"></a><span id="l59.189">             this.calendar.superCalendar.startBatch();</span>
<a href="#l59.190"></a><span id="l59.190">         }</span>
<a href="#l59.191"></a><span id="l59.191">     },</span>
<a href="#l59.192"></a><span id="l59.192"> </span>
<a href="#l59.193"></a><span id="l59.193">     endDocument: function mg_endDocument() {</span>
<a href="#l59.194"></a><span id="l59.194">         if (this.calendar.isCached) {</span>
<a href="#l59.195"></a><span id="l59.195">             this.calendar.superCalendar.endBatch();</span>
<a href="#l59.196"></a><span id="l59.196">         }</span>
<a href="#l59.197"></a><span id="l59.197">     },</span>
<a href="#l59.198"></a><span id="l59.198"> </span>
<a href="#l59.199"></a><span id="l59.199">     startElement: function mg_startElement(aUri, aLocalName, aQName, aAttributes) {</span>
<a href="#l59.200"></a><span id="l59.200">         switch (aLocalName) {</span>
<a href="#l59.201"></a><span id="l59.201">             case &quot;response&quot;:</span>
<a href="#l59.202"></a><span id="l59.202">                 this.currentResponse = {};</span>
<a href="#l59.203"></a><span id="l59.203" class="difflineminus">-                this.tag = null</span>
<a href="#l59.204"></a><span id="l59.204" class="difflineplus">+                this.tag = null;</span>
<a href="#l59.205"></a><span id="l59.205">                 this.isInPropStat = false;</span>
<a href="#l59.206"></a><span id="l59.206">                 break;</span>
<a href="#l59.207"></a><span id="l59.207">             case &quot;propstat&quot;:</span>
<a href="#l59.208"></a><span id="l59.208">                 this.isInPropStat = true;</span>
<a href="#l59.209"></a><span id="l59.209">                 break;</span>
<a href="#l59.210"></a><span id="l59.210">             case &quot;status&quot;:</span>
<a href="#l59.211"></a><span id="l59.211">                 if (this.isInPropStat) {</span>
<a href="#l59.212"></a><span id="l59.212">                     this.tag = &quot;propstat_&quot; + aLocalName;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l60.1"></a><span id="l60.1" class="difflineminus">--- a/calendar/providers/ics/calICSCalendar.js</span>
<a href="#l60.2"></a><span id="l60.2" class="difflineplus">+++ b/calendar/providers/ics/calICSCalendar.js</span>
<a href="#l60.3"></a><span id="l60.3" class="difflineat">@@ -104,17 +104,17 @@ calICSCalendar.prototype = {</span>
<a href="#l60.4"></a><span id="l60.4">     // calICalendar interface</span>
<a href="#l60.5"></a><span id="l60.5">     //</span>
<a href="#l60.6"></a><span id="l60.6">     get type() { return &quot;ics&quot;; },</span>
<a href="#l60.7"></a><span id="l60.7"> </span>
<a href="#l60.8"></a><span id="l60.8">     get canRefresh() {</span>
<a href="#l60.9"></a><span id="l60.9">         return true;</span>
<a href="#l60.10"></a><span id="l60.10">     },</span>
<a href="#l60.11"></a><span id="l60.11"> </span>
<a href="#l60.12"></a><span id="l60.12" class="difflineminus">-    get uri() { return this.mUri },</span>
<a href="#l60.13"></a><span id="l60.13" class="difflineplus">+    get uri() { return this.mUri; },</span>
<a href="#l60.14"></a><span id="l60.14">     set uri(aUri) {</span>
<a href="#l60.15"></a><span id="l60.15">         this.mUri = aUri;</span>
<a href="#l60.16"></a><span id="l60.16">         this.mMemoryCalendar.uri = this.mUri;</span>
<a href="#l60.17"></a><span id="l60.17"> </span>
<a href="#l60.18"></a><span id="l60.18">         // Use the ioservice, to create a channel, which makes finding the</span>
<a href="#l60.19"></a><span id="l60.19">         // right hooks to use easier.</span>
<a href="#l60.20"></a><span id="l60.20">         var channel = Services.io.newChannelFromURI2(this.mUri,</span>
<a href="#l60.21"></a><span id="l60.21">                                                      null,</span>
<a href="#l60.22"></a><span id="l60.22" class="difflineat">@@ -801,17 +801,17 @@ calICSCalendar.prototype = {</span>
<a href="#l60.23"></a><span id="l60.23">                     copyToOverwriting(result, backupDir, makeName('initial'));</span>
<a href="#l60.24"></a><span id="l60.24">                 }</span>
<a href="#l60.25"></a><span id="l60.25">                 if (doDailyBackup) {</span>
<a href="#l60.26"></a><span id="l60.26">                     copyToOverwriting(result, backupDir, dailyBackupFileName);</span>
<a href="#l60.27"></a><span id="l60.27">                 }</span>
<a href="#l60.28"></a><span id="l60.28"> </span>
<a href="#l60.29"></a><span id="l60.29">                 aCallback.call(savedthis);</span>
<a href="#l60.30"></a><span id="l60.30">             }</span>
<a href="#l60.31"></a><span id="l60.31" class="difflineminus">-        }</span>
<a href="#l60.32"></a><span id="l60.32" class="difflineplus">+        };</span>
<a href="#l60.33"></a><span id="l60.33"> </span>
<a href="#l60.34"></a><span id="l60.34">         downloader.init(listener, backupFile);</span>
<a href="#l60.35"></a><span id="l60.35">         try {</span>
<a href="#l60.36"></a><span id="l60.36">             channel.asyncOpen(downloader, null);</span>
<a href="#l60.37"></a><span id="l60.37">         } catch (e) {</span>
<a href="#l60.38"></a><span id="l60.38">             // For local files, asyncOpen throws on new (calendar) files</span>
<a href="#l60.39"></a><span id="l60.39">             // No problem, go and upload something</span>
<a href="#l60.40"></a><span id="l60.40">             cal.ERROR(&quot;[calICSCalendar] Backup failed in asyncOpen:&quot; + e);</span>
<a href="#l60.41"></a><span id="l60.41" class="difflineat">@@ -1021,17 +1021,17 @@ httpHooks.prototype = {</span>
<a href="#l60.42"></a><span id="l60.42">                     let str = resultConverter.convertFromByteArray(aResult, aResultLength);</span>
<a href="#l60.43"></a><span id="l60.43">                     multistatus = cal.xml.parseString(str);</span>
<a href="#l60.44"></a><span id="l60.44">                 } catch (ex) {</span>
<a href="#l60.45"></a><span id="l60.45">                     cal.LOG(&quot;[calICSCalendar] Failed to fetch channel etag&quot;);</span>
<a href="#l60.46"></a><span id="l60.46">                 }</span>
<a href="#l60.47"></a><span id="l60.47"> </span>
<a href="#l60.48"></a><span id="l60.48">                 thisHook.mEtag = icsXPathFirst(multistatus, &quot;/D:propfind/D:response/D:propstat/D:prop/D:getetag&quot;);</span>
<a href="#l60.49"></a><span id="l60.49">                 aRespFunc();</span>
<a href="#l60.50"></a><span id="l60.50" class="difflineminus">-            }</span>
<a href="#l60.51"></a><span id="l60.51" class="difflineplus">+            };</span>
<a href="#l60.52"></a><span id="l60.52">             let queryXml =</span>
<a href="#l60.53"></a><span id="l60.53">                 '&lt;D:propfind xmlns:D=&quot;DAV:&quot;&gt;' +</span>
<a href="#l60.54"></a><span id="l60.54">                   '&lt;D:prop&gt;' +</span>
<a href="#l60.55"></a><span id="l60.55">                     '&lt;D:getetag/&gt;' +</span>
<a href="#l60.56"></a><span id="l60.56">                   '&lt;/D:prop&gt;' +</span>
<a href="#l60.57"></a><span id="l60.57">                 '&lt;/D:propfind&gt;';</span>
<a href="#l60.58"></a><span id="l60.58"> </span>
<a href="#l60.59"></a><span id="l60.59">             let etagChannel = cal.prepHttpChannel(aChannel.URI, queryXml,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l61.1"></a><span id="l61.1" class="difflineminus">--- a/calendar/providers/storage/calStorageCalendar.js</span>
<a href="#l61.2"></a><span id="l61.2" class="difflineplus">+++ b/calendar/providers/storage/calStorageCalendar.js</span>
<a href="#l61.3"></a><span id="l61.3" class="difflineat">@@ -1113,20 +1113,20 @@ calStorageCalendar.prototype = {</span>
<a href="#l61.4"></a><span id="l61.4">             //   WHERE  ((event_end &gt; :range_start OR</span>
<a href="#l61.5"></a><span id="l61.5">             //           (event_end = :range_start AND</span>
<a href="#l61.6"></a><span id="l61.6">             //           event_start = :range_start))</span>
<a href="#l61.7"></a><span id="l61.7">             //          AND event_start &lt; :range_end)</span>
<a href="#l61.8"></a><span id="l61.8">             //</span>
<a href="#l61.9"></a><span id="l61.9">             // but that doesn't work with floating start or end times. The logic</span>
<a href="#l61.10"></a><span id="l61.10">             // is the same though.</span>
<a href="#l61.11"></a><span id="l61.11">             // For readability, a few helpers:</span>
<a href="#l61.12"></a><span id="l61.12" class="difflineminus">-            var floatingEventStart = &quot;event_start_tz = 'floating' AND event_start&quot;</span>
<a href="#l61.13"></a><span id="l61.13" class="difflineminus">-            var nonFloatingEventStart = &quot;event_start_tz != 'floating' AND event_start&quot;</span>
<a href="#l61.14"></a><span id="l61.14" class="difflineminus">-            var floatingEventEnd = &quot;event_end_tz = 'floating' AND event_end&quot;</span>
<a href="#l61.15"></a><span id="l61.15" class="difflineminus">-            var nonFloatingEventEnd = &quot;event_end_tz != 'floating' AND event_end&quot;</span>
<a href="#l61.16"></a><span id="l61.16" class="difflineplus">+            var floatingEventStart = &quot;event_start_tz = 'floating' AND event_start&quot;;</span>
<a href="#l61.17"></a><span id="l61.17" class="difflineplus">+            var nonFloatingEventStart = &quot;event_start_tz != 'floating' AND event_start&quot;;</span>
<a href="#l61.18"></a><span id="l61.18" class="difflineplus">+            var floatingEventEnd = &quot;event_end_tz = 'floating' AND event_end&quot;;</span>
<a href="#l61.19"></a><span id="l61.19" class="difflineplus">+            var nonFloatingEventEnd = &quot;event_end_tz != 'floating' AND event_end&quot;;</span>
<a href="#l61.20"></a><span id="l61.20">             // The query needs to take both floating and non floating into account</span>
<a href="#l61.21"></a><span id="l61.21">             this.mSelectNonRecurringEventsByRange = this.mDB.createStatement(</span>
<a href="#l61.22"></a><span id="l61.22">                 &quot;SELECT * FROM cal_events &quot; +</span>
<a href="#l61.23"></a><span id="l61.23">                 &quot;WHERE &quot; +</span>
<a href="#l61.24"></a><span id="l61.24">                 &quot; ((&quot; + floatingEventEnd + &quot; &gt; :range_start + :start_offset) OR &quot; +</span>
<a href="#l61.25"></a><span id="l61.25">                 &quot;  (&quot; + nonFloatingEventEnd + &quot; &gt; :range_start) OR &quot; +</span>
<a href="#l61.26"></a><span id="l61.26">                 &quot;  (((&quot; + floatingEventEnd + &quot; = :range_start + :start_offset) OR &quot; +</span>
<a href="#l61.27"></a><span id="l61.27">                 &quot;    (&quot; + nonFloatingEventEnd + &quot; = :range_start)) AND &quot; +</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l62.1"></a><span id="l62.1" class="difflineminus">--- a/calendar/providers/storage/calStorageUpgrade.jsm</span>
<a href="#l62.2"></a><span id="l62.2" class="difflineplus">+++ b/calendar/providers/storage/calStorageUpgrade.jsm</span>
<a href="#l62.3"></a><span id="l62.3" class="difflineat">@@ -274,17 +274,17 @@ function createDBDelegate(funcName) {</span>
<a href="#l62.4"></a><span id="l62.4">  * database is passed, no error is thrown but null is returned.</span>
<a href="#l62.5"></a><span id="l62.5">  *</span>
<a href="#l62.6"></a><span id="l62.6">  * @param getterAttr        The getter to delegate.</span>
<a href="#l62.7"></a><span id="l62.7">  * @return                  The function that delegates the getter.</span>
<a href="#l62.8"></a><span id="l62.8">  */</span>
<a href="#l62.9"></a><span id="l62.9"> function createDBDelegateGetter(getterAttr) {</span>
<a href="#l62.10"></a><span id="l62.10">     return function(db) {</span>
<a href="#l62.11"></a><span id="l62.11">         return (db ? db[getterAttr] : null);</span>
<a href="#l62.12"></a><span id="l62.12" class="difflineminus">-    }</span>
<a href="#l62.13"></a><span id="l62.13" class="difflineplus">+    };</span>
<a href="#l62.14"></a><span id="l62.14"> }</span>
<a href="#l62.15"></a><span id="l62.15"> </span>
<a href="#l62.16"></a><span id="l62.16"> // These functions use the db delegate to allow easier calling of common</span>
<a href="#l62.17"></a><span id="l62.17"> // database functions.</span>
<a href="#l62.18"></a><span id="l62.18"> var beginTransaction = createDBDelegate(&quot;beginTransaction&quot;);</span>
<a href="#l62.19"></a><span id="l62.19"> var commitTransaction = createDBDelegate(&quot;commitTransaction&quot;);</span>
<a href="#l62.20"></a><span id="l62.20"> var rollbackTransaction = createDBDelegate(&quot;rollbackTransaction&quot;);</span>
<a href="#l62.21"></a><span id="l62.21"> var createStatement = createDBDelegate(&quot;createStatement&quot;);</span>
<a href="#l62.22"></a><span id="l62.22" class="difflineat">@@ -1349,17 +1349,17 @@ upgrade.v20 = function upgrade_v20(db, v</span>
<a href="#l62.23"></a><span id="l62.23">         for (let tblName of [&quot;cal_events&quot;, &quot;cal_todos&quot;]) {</span>
<a href="#l62.24"></a><span id="l62.24">             addColumn(tbl, tblName, [&quot;offline_journal&quot;], &quot;INTEGER&quot;, db);</span>
<a href="#l62.25"></a><span id="l62.25">         }</span>
<a href="#l62.26"></a><span id="l62.26">         setDbVersionAndCommit(db, 20);</span>
<a href="#l62.27"></a><span id="l62.27">     } catch (e) {</span>
<a href="#l62.28"></a><span id="l62.28">         throw reportErrorAndRollback(db, e);</span>
<a href="#l62.29"></a><span id="l62.29">     }</span>
<a href="#l62.30"></a><span id="l62.30">     return tbl;</span>
<a href="#l62.31"></a><span id="l62.31" class="difflineminus">-}</span>
<a href="#l62.32"></a><span id="l62.32" class="difflineplus">+};</span>
<a href="#l62.33"></a><span id="l62.33"> </span>
<a href="#l62.34"></a><span id="l62.34"> /**</span>
<a href="#l62.35"></a><span id="l62.35">  * Bug 785659 - Get rid of calIRecurrenceDateSet</span>
<a href="#l62.36"></a><span id="l62.36">  * Migrate x-dateset to x-date in the storage database</span>
<a href="#l62.37"></a><span id="l62.37">  * r=mmecca, p=philipp</span>
<a href="#l62.38"></a><span id="l62.38">  */</span>
<a href="#l62.39"></a><span id="l62.39"> upgrade.v21 = function upgrade_v21(db, version) {</span>
<a href="#l62.40"></a><span id="l62.40">     let tbl = upgrade.v20(version &lt; 20 &amp;&amp; db, version);</span>
<a href="#l62.41"></a><span id="l62.41" class="difflineat">@@ -1422,17 +1422,17 @@ upgrade.v21 = function upgrade_v21(db, v</span>
<a href="#l62.42"></a><span id="l62.42">             executeSimpleSQL(db, 'DELETE FROM cal_recurrence WHERE recur_type = &quot;x-dateset&quot;');</span>
<a href="#l62.43"></a><span id="l62.43">         }</span>
<a href="#l62.44"></a><span id="l62.44"> </span>
<a href="#l62.45"></a><span id="l62.45">         setDbVersionAndCommit(db, 21);</span>
<a href="#l62.46"></a><span id="l62.46">     } catch (e) {</span>
<a href="#l62.47"></a><span id="l62.47">         throw reportErrorAndRollback(db, e);</span>
<a href="#l62.48"></a><span id="l62.48">     }</span>
<a href="#l62.49"></a><span id="l62.49">     return tbl;</span>
<a href="#l62.50"></a><span id="l62.50" class="difflineminus">-}</span>
<a href="#l62.51"></a><span id="l62.51" class="difflineplus">+};</span>
<a href="#l62.52"></a><span id="l62.52"> </span>
<a href="#l62.53"></a><span id="l62.53"> /**</span>
<a href="#l62.54"></a><span id="l62.54">  * Bug 785733 - Move some properties to use icalString in database.</span>
<a href="#l62.55"></a><span id="l62.55">  * Use the full icalString in attendees, attachments, relations and recurrence</span>
<a href="#l62.56"></a><span id="l62.56">  * tables.</span>
<a href="#l62.57"></a><span id="l62.57">  * r=mmecca, p=philipp</span>
<a href="#l62.58"></a><span id="l62.58">  */</span>
<a href="#l62.59"></a><span id="l62.59"> upgrade.v22 = function upgrade_v22(db, version) {</span>
<a href="#l62.60"></a><span id="l62.60" class="difflineat">@@ -1574,17 +1574,17 @@ upgrade.v22 = function upgrade_v22(db, v</span>
<a href="#l62.61"></a><span id="l62.61">                             WEEKNO: aWeekno,</span>
<a href="#l62.62"></a><span id="l62.62">                             MONTH: aMonth,</span>
<a href="#l62.63"></a><span id="l62.63">                             SETPOS: aSetPos</span>
<a href="#l62.64"></a><span id="l62.64">                         };</span>
<a href="#l62.65"></a><span id="l62.65"> </span>
<a href="#l62.66"></a><span id="l62.66">                         for (let rtype in rtypes) {</span>
<a href="#l62.67"></a><span id="l62.67">                             if (rtypes[rtype]) {</span>
<a href="#l62.68"></a><span id="l62.68">                                 let comp = &quot;BY&quot; + rtype;</span>
<a href="#l62.69"></a><span id="l62.69" class="difflineminus">-                                let rstr = rtypes[rtype].toString()</span>
<a href="#l62.70"></a><span id="l62.70" class="difflineplus">+                                let rstr = rtypes[rtype].toString();</span>
<a href="#l62.71"></a><span id="l62.71">                                 let rarray = rstr.split(&quot;,&quot;).map(parseInt10);</span>
<a href="#l62.72"></a><span id="l62.72">                                 ritem.setComponent(comp, rarray.length, rarray);</span>
<a href="#l62.73"></a><span id="l62.73">                             }</span>
<a href="#l62.74"></a><span id="l62.74">                         }</span>
<a href="#l62.75"></a><span id="l62.75">                     }</span>
<a href="#l62.76"></a><span id="l62.76"> </span>
<a href="#l62.77"></a><span id="l62.77">                     return ritem.icalString;</span>
<a href="#l62.78"></a><span id="l62.78">                 } catch (e) {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l63.1"></a><span id="l63.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapCalendarItems.js</span>
<a href="#l63.2"></a><span id="l63.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapCalendarItems.js</span>
<a href="#l63.3"></a><span id="l63.3" class="difflineat">@@ -650,17 +650,17 @@ function calWcapCalendar_adoptItem(item,</span>
<a href="#l63.4"></a><span id="l63.4">         log(&quot;adoptItem() call: &quot; + item.title, this));</span>
<a href="#l63.5"></a><span id="l63.5"> </span>
<a href="#l63.6"></a><span id="l63.6">     try {</span>
<a href="#l63.7"></a><span id="l63.7">         this.storeItem(true /* bAddItem */, item, null, request);</span>
<a href="#l63.8"></a><span id="l63.8">     } catch (exc) {</span>
<a href="#l63.9"></a><span id="l63.9">         request.execRespFunc(exc);</span>
<a href="#l63.10"></a><span id="l63.10">     }</span>
<a href="#l63.11"></a><span id="l63.11">     return request;</span>
<a href="#l63.12"></a><span id="l63.12" class="difflineminus">-}</span>
<a href="#l63.13"></a><span id="l63.13" class="difflineplus">+};</span>
<a href="#l63.14"></a><span id="l63.14"> </span>
<a href="#l63.15"></a><span id="l63.15"> calWcapCalendar.prototype.addItem =</span>
<a href="#l63.16"></a><span id="l63.16"> function calWcapCalendar_addItem(item, listener) {</span>
<a href="#l63.17"></a><span id="l63.17">     this.adoptItem(item.clone(), listener);</span>
<a href="#l63.18"></a><span id="l63.18"> };</span>
<a href="#l63.19"></a><span id="l63.19"> </span>
<a href="#l63.20"></a><span id="l63.20"> calWcapCalendar.prototype.modifyItem =</span>
<a href="#l63.21"></a><span id="l63.21"> function calWcapCalendar_modifyItem(newItem, oldItem, listener) {</span>
<a href="#l63.22"></a><span id="l63.22" class="difflineat">@@ -820,17 +820,17 @@ calWcapCalendar.prototype.patchTimezone </span>
<a href="#l63.23"></a><span id="l63.23">                 log(&quot;patching &quot; + xpropOrTz + &quot;: from &quot; +</span>
<a href="#l63.24"></a><span id="l63.24">                     dt + &quot; to &quot; + dt.getInTimezone(tz), this);</span>
<a href="#l63.25"></a><span id="l63.25">             }</span>
<a href="#l63.26"></a><span id="l63.26">             dt = dt.getInTimezone(tz);</span>
<a href="#l63.27"></a><span id="l63.27">             subComp[attr] = dt;</span>
<a href="#l63.28"></a><span id="l63.28">         }</span>
<a href="#l63.29"></a><span id="l63.29">     }</span>
<a href="#l63.30"></a><span id="l63.30">     return dt;</span>
<a href="#l63.31"></a><span id="l63.31" class="difflineminus">-}</span>
<a href="#l63.32"></a><span id="l63.32" class="difflineplus">+};</span>
<a href="#l63.33"></a><span id="l63.33"> </span>
<a href="#l63.34"></a><span id="l63.34"> calWcapCalendar.prototype.parseItems = function calWcapCalendar_parseItems(</span>
<a href="#l63.35"></a><span id="l63.35">     icalRootComp, itemFilter, maxResults, rangeStart, rangeEnd, bLeaveMutable) {</span>
<a href="#l63.36"></a><span id="l63.36">     let items = [];</span>
<a href="#l63.37"></a><span id="l63.37">     let unexpandedItems = [];</span>
<a href="#l63.38"></a><span id="l63.38">     let uid2parent = {};</span>
<a href="#l63.39"></a><span id="l63.39">     let excItems = [];</span>
<a href="#l63.40"></a><span id="l63.40">     let fakedParents = {};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l64.1"></a><span id="l64.1" class="difflineminus">--- a/calendar/providers/wcap/calWcapSession.js</span>
<a href="#l64.2"></a><span id="l64.2" class="difflineplus">+++ b/calendar/providers/wcap/calWcapSession.js</span>
<a href="#l64.3"></a><span id="l64.3" class="difflineat">@@ -520,17 +520,17 @@ calWcapSession.prototype = {</span>
<a href="#l64.4"></a><span id="l64.4">                             calprops_resp = function(aCalendar) {</span>
<a href="#l64.5"></a><span id="l64.5">                                 if (aCalendar.isDefaultCalendar) {</span>
<a href="#l64.6"></a><span id="l64.6">                                     // tweak name:</span>
<a href="#l64.7"></a><span id="l64.7">                                     aCalendar.setProperty(&quot;name&quot;, aCalendar.displayName);</span>
<a href="#l64.8"></a><span id="l64.8">                                 } else {</span>
<a href="#l64.9"></a><span id="l64.9">                                     log(&quot;registering subscribed calendar: &quot; + aCalendar.calId, this_);</span>
<a href="#l64.10"></a><span id="l64.10">                                     cal.getCalendarManager().registerCalendar(aCalendar);</span>
<a href="#l64.11"></a><span id="l64.11">                                 }</span>
<a href="#l64.12"></a><span id="l64.12" class="difflineminus">-                            }</span>
<a href="#l64.13"></a><span id="l64.13" class="difflineplus">+                            };</span>
<a href="#l64.14"></a><span id="l64.14">                             // do only once:</span>
<a href="#l64.15"></a><span id="l64.15">                             defaultCal.setProperty(&quot;subscriptions_registered&quot;, true);</span>
<a href="#l64.16"></a><span id="l64.16">                         }</span>
<a href="#l64.17"></a><span id="l64.17">                     }</span>
<a href="#l64.18"></a><span id="l64.18"> </span>
<a href="#l64.19"></a><span id="l64.19">                     if (!defaultCal.getProperty(&quot;user_id&quot;)) { // nail once:</span>
<a href="#l64.20"></a><span id="l64.20">                         defaultCal.setProperty(&quot;user_id&quot;, this_.credentials.userId);</span>
<a href="#l64.21"></a><span id="l64.21">                     }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l65.1"></a><span id="l65.1" class="difflineminus">--- a/calendar/resources/content/calendarCreation.js</span>
<a href="#l65.2"></a><span id="l65.2" class="difflineplus">+++ b/calendar/resources/content/calendarCreation.js</span>
<a href="#l65.3"></a><span id="l65.3" class="difflineat">@@ -6,17 +6,17 @@</span>
<a href="#l65.4"></a><span id="l65.4"> Components.utils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l65.5"></a><span id="l65.5"> </span>
<a href="#l65.6"></a><span id="l65.6"> var gCalendar;</span>
<a href="#l65.7"></a><span id="l65.7"> </span>
<a href="#l65.8"></a><span id="l65.8"> var errorConstants = {</span>
<a href="#l65.9"></a><span id="l65.9">     SUCCESS: 0,</span>
<a href="#l65.10"></a><span id="l65.10">     INVALID_URI: 1,</span>
<a href="#l65.11"></a><span id="l65.11">     ALREADY_EXISTS: 2</span>
<a href="#l65.12"></a><span id="l65.12" class="difflineminus">-}</span>
<a href="#l65.13"></a><span id="l65.13" class="difflineplus">+};</span>
<a href="#l65.14"></a><span id="l65.14"> </span>
<a href="#l65.15"></a><span id="l65.15"> var l10nStrings = {};</span>
<a href="#l65.16"></a><span id="l65.16"> l10nStrings[errorConstants.SUCCESS] = &quot;&quot;;</span>
<a href="#l65.17"></a><span id="l65.17"> l10nStrings[errorConstants.INVALID_URI] = cal.calGetString(&quot;calendarCreation&quot;, &quot;error.invalidUri&quot;);</span>
<a href="#l65.18"></a><span id="l65.18"> l10nStrings[errorConstants.ALREADY_EXISTS] = cal.calGetString(&quot;calendarCreation&quot;, &quot;error.alreadyExists&quot;);</span>
<a href="#l65.19"></a><span id="l65.19"> </span>
<a href="#l65.20"></a><span id="l65.20"> /**</span>
<a href="#l65.21"></a><span id="l65.21">  * Initialize the location page</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l66.1"></a><span id="l66.1" class="difflineminus">--- a/calendar/resources/content/datetimepickers/datetimepickers.xml</span>
<a href="#l66.2"></a><span id="l66.2" class="difflineplus">+++ b/calendar/resources/content/datetimepickers/datetimepickers.xml</span>
<a href="#l66.3"></a><span id="l66.3" class="difflineat">@@ -711,17 +711,17 @@</span>
<a href="#l66.4"></a><span id="l66.4">         if (event.deltaMode == event.DOM_DELTA_PAGE ||</span>
<a href="#l66.5"></a><span id="l66.5">             event.deltaMode == event.DOM_DELTA_LINE) {</span>
<a href="#l66.6"></a><span id="l66.6">             // Line/Page scrolling is usually vertical</span>
<a href="#l66.7"></a><span id="l66.7">             if (event.deltaY) {</span>
<a href="#l66.8"></a><span id="l66.8">                 deltaView = event.deltaY &lt; 0 ? -1 : 1;</span>
<a href="#l66.9"></a><span id="l66.9">             }</span>
<a href="#l66.10"></a><span id="l66.10">         } else if (event.deltaMode == event.DOM_DELTA_PIXEL) {</span>
<a href="#l66.11"></a><span id="l66.11">             // The natural direction for pixel scrolling is left/right</span>
<a href="#l66.12"></a><span id="l66.12" class="difflineminus">-            this.mPixelScrollDelta += event.deltaX</span>
<a href="#l66.13"></a><span id="l66.13" class="difflineplus">+            this.mPixelScrollDelta += event.deltaX;</span>
<a href="#l66.14"></a><span id="l66.14">             if (this.mPixelScrollDelta &gt; pixelThreshold) {</span>
<a href="#l66.15"></a><span id="l66.15">                 deltaView = 1;</span>
<a href="#l66.16"></a><span id="l66.16">                 this.mPixelScrollDelta = 0;</span>
<a href="#l66.17"></a><span id="l66.17">             } else if (this.mPixelScrollDelta &lt; -pixelThreshold) {</span>
<a href="#l66.18"></a><span id="l66.18">                 deltaView = -1;</span>
<a href="#l66.19"></a><span id="l66.19">                 this.mPixelScrollDelta = 0;</span>
<a href="#l66.20"></a><span id="l66.20">             }</span>
<a href="#l66.21"></a><span id="l66.21">         }</span>
<a href="#l66.22"></a><span id="l66.22" class="difflineat">@@ -760,17 +760,17 @@</span>
<a href="#l66.23"></a><span id="l66.23">         if (event.deltaMode == event.DOM_DELTA_PAGE ||</span>
<a href="#l66.24"></a><span id="l66.24">             event.deltaMode == event.DOM_DELTA_LINE) {</span>
<a href="#l66.25"></a><span id="l66.25">             // Line/Page scrolling is usually vertical</span>
<a href="#l66.26"></a><span id="l66.26">             if (event.deltaY) {</span>
<a href="#l66.27"></a><span id="l66.27">                 deltaView = event.deltaY &lt; 0 ? -1 : 1;</span>
<a href="#l66.28"></a><span id="l66.28">             }</span>
<a href="#l66.29"></a><span id="l66.29">         } else if (event.deltaMode == event.DOM_DELTA_PIXEL) {</span>
<a href="#l66.30"></a><span id="l66.30">             // The natural direction for pixel scrolling is left/right</span>
<a href="#l66.31"></a><span id="l66.31" class="difflineminus">-            this.mPixelScrollDelta += event.deltaX</span>
<a href="#l66.32"></a><span id="l66.32" class="difflineplus">+            this.mPixelScrollDelta += event.deltaX;</span>
<a href="#l66.33"></a><span id="l66.33">             if (this.mPixelScrollDelta &gt; pixelThreshold) {</span>
<a href="#l66.34"></a><span id="l66.34">                 deltaView = 1;</span>
<a href="#l66.35"></a><span id="l66.35">                 this.mPixelScrollDelta = 0;</span>
<a href="#l66.36"></a><span id="l66.36">             } else if (this.mPixelScrollDelta &lt; -pixelThreshold) {</span>
<a href="#l66.37"></a><span id="l66.37">                 deltaView = -1;</span>
<a href="#l66.38"></a><span id="l66.38">                 this.mPixelScrollDelta = 0;</span>
<a href="#l66.39"></a><span id="l66.39">             }</span>
<a href="#l66.40"></a><span id="l66.40">         }</span>
<a href="#l66.41"></a><span id="l66.41" class="difflineat">@@ -1707,17 +1707,17 @@</span>
<a href="#l66.42"></a><span id="l66.42">             } catch (ex) {</span>
<a href="#l66.43"></a><span id="l66.43">             }</span>
<a href="#l66.44"></a><span id="l66.44"> </span>
<a href="#l66.45"></a><span id="l66.45">             var time = null;</span>
<a href="#l66.46"></a><span id="l66.46">             var timePartsArray = this.parseTimeRegExp.exec(aValue);</span>
<a href="#l66.47"></a><span id="l66.47">             const PRE_INDEX = 1, HR_INDEX = 2, MIN_INDEX = 4, SEC_INDEX = 6, POST_INDEX = 8;</span>
<a href="#l66.48"></a><span id="l66.48"> </span>
<a href="#l66.49"></a><span id="l66.49">             if (timePartsArray != null) {</span>
<a href="#l66.50"></a><span id="l66.50" class="difflineminus">-              var hoursString = timePartsArray[HR_INDEX]</span>
<a href="#l66.51"></a><span id="l66.51" class="difflineplus">+              var hoursString = timePartsArray[HR_INDEX];</span>
<a href="#l66.52"></a><span id="l66.52">               var hours = Number(hoursString);</span>
<a href="#l66.53"></a><span id="l66.53">               var hoursSuffix = timePartsArray[HR_INDEX + 1];</span>
<a href="#l66.54"></a><span id="l66.54">               if (!(hours &gt;= 0 &amp;&amp; hours &lt; 24)) {</span>
<a href="#l66.55"></a><span id="l66.55">                 return null;</span>
<a href="#l66.56"></a><span id="l66.56">               }</span>
<a href="#l66.57"></a><span id="l66.57"> </span>
<a href="#l66.58"></a><span id="l66.58">               var minutesString = timePartsArray[MIN_INDEX];</span>
<a href="#l66.59"></a><span id="l66.59">               var minutes = (minutesString == null ? 0 : Number(minutesString));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l67.1"></a><span id="l67.1" class="difflineminus">--- a/calendar/resources/content/publish.js</span>
<a href="#l67.2"></a><span id="l67.2" class="difflineplus">+++ b/calendar/resources/content/publish.js</span>
<a href="#l67.3"></a><span id="l67.3" class="difflineat">@@ -189,17 +189,17 @@ var notificationCallbacks =</span>
<a href="#l67.4"></a><span id="l67.4">     getInterface: function(iid, instance) {</span>
<a href="#l67.5"></a><span id="l67.5">         if (iid.equals(Components.interfaces.nsIAuthPrompt)) {</span>
<a href="#l67.6"></a><span id="l67.6">             // use the window watcher service to get a nsIAuthPrompt impl</span>
<a href="#l67.7"></a><span id="l67.7">             return Services.ww.getNewAuthPrompter(null);</span>
<a href="#l67.8"></a><span id="l67.8">         }</span>
<a href="#l67.9"></a><span id="l67.9"> </span>
<a href="#l67.10"></a><span id="l67.10">         throw Components.results.NS_ERROR_NO_INTERFACE;</span>
<a href="#l67.11"></a><span id="l67.11">     }</span>
<a href="#l67.12"></a><span id="l67.12" class="difflineminus">-}</span>
<a href="#l67.13"></a><span id="l67.13" class="difflineplus">+};</span>
<a href="#l67.14"></a><span id="l67.14"> </span>
<a href="#l67.15"></a><span id="l67.15"> </span>
<a href="#l67.16"></a><span id="l67.16"> var publishingListener = {</span>
<a href="#l67.17"></a><span id="l67.17">     QueryInterface: XPCOMUtils.generateQI([Components.interfaces.nsIStreamListener]),</span>
<a href="#l67.18"></a><span id="l67.18"> </span>
<a href="#l67.19"></a><span id="l67.19">     onStartRequest: function(request, ctxt) {</span>
<a href="#l67.20"></a><span id="l67.20">     },</span>
<a href="#l67.21"></a><span id="l67.21"> </span>
<a href="#l67.22"></a><span id="l67.22" class="difflineat">@@ -221,9 +221,9 @@ var publishingListener = {</span>
<a href="#l67.23"></a><span id="l67.23">             // XXX this should be made human-readable.</span>
<a href="#l67.24"></a><span id="l67.24">             Services.prompt.alert(null, calGetString(&quot;calendar&quot;, &quot;genericErrorTitle&quot;),</span>
<a href="#l67.25"></a><span id="l67.25">                                   props.formatStringFromName('otherPutError', [request.status.toString(16)], 1));</span>
<a href="#l67.26"></a><span id="l67.26">         }</span>
<a href="#l67.27"></a><span id="l67.27">     },</span>
<a href="#l67.28"></a><span id="l67.28"> </span>
<a href="#l67.29"></a><span id="l67.29">     onDataAvailable: function(request, ctxt, inStream, sourceOffset, count) {</span>
<a href="#l67.30"></a><span id="l67.30">     }</span>
<a href="#l67.31"></a><span id="l67.31" class="difflineminus">-}</span>
<a href="#l67.32"></a><span id="l67.32" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l68.1"></a><span id="l68.1" class="difflineminus">--- a/calendar/test/mozmill/eventDialog/testEventDialog.js</span>
<a href="#l68.2"></a><span id="l68.2" class="difflineplus">+++ b/calendar/test/mozmill/eventDialog/testEventDialog.js</span>
<a href="#l68.3"></a><span id="l68.3" class="difflineat">@@ -13,17 +13,17 @@ var location = &quot;Location&quot;;</span>
<a href="#l68.4"></a><span id="l68.4"> var desc = &quot;Event Decription&quot;;</span>
<a href="#l68.5"></a><span id="l68.5"> var attendee = &quot;foo@bar.com&quot;;</span>
<a href="#l68.6"></a><span id="l68.6"> var url = &quot;http://mozilla.org&quot;;</span>
<a href="#l68.7"></a><span id="l68.7"> var tmp;</span>
<a href="#l68.8"></a><span id="l68.8"> </span>
<a href="#l68.9"></a><span id="l68.9"> var setupModule = function(module) {</span>
<a href="#l68.10"></a><span id="l68.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l68.11"></a><span id="l68.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l68.12"></a><span id="l68.12" class="difflineminus">-}</span>
<a href="#l68.13"></a><span id="l68.13" class="difflineplus">+};</span>
<a href="#l68.14"></a><span id="l68.14"> </span>
<a href="#l68.15"></a><span id="l68.15"> var testEventDialog = function() {</span>
<a href="#l68.16"></a><span id="l68.16">   // paths</span>
<a href="#l68.17"></a><span id="l68.17">   let monthView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l68.18"></a><span id="l68.18">     + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/'</span>
<a href="#l68.19"></a><span id="l68.19">     + 'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-view-box&quot;)/id(&quot;view-deck&quot;)/id(&quot;month-view&quot;)/';</span>
<a href="#l68.20"></a><span id="l68.20">   let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l68.21"></a><span id="l68.21">     + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/'</span>
<a href="#l68.22"></a><span id="l68.22" class="difflineat">@@ -56,27 +56,27 @@ var testEventDialog = function() {</span>
<a href="#l68.23"></a><span id="l68.23"> </span>
<a href="#l68.24"></a><span id="l68.24">   // pick day</span>
<a href="#l68.25"></a><span id="l68.25">   controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l68.26"></a><span id="l68.26">     + 'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l68.27"></a><span id="l68.27">   controller.sleep(sleep);</span>
<a href="#l68.28"></a><span id="l68.28"> </span>
<a href="#l68.29"></a><span id="l68.29">   // create new event</span>
<a href="#l68.30"></a><span id="l68.30">   controller.mainMenu.click(&quot;#ltnNewEvent&quot;);</span>
<a href="#l68.31"></a><span id="l68.31" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l68.32"></a><span id="l68.32" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l68.33"></a><span id="l68.33">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l68.34"></a><span id="l68.34"> </span>
<a href="#l68.35"></a><span id="l68.35">   // check that the start time is correct</span>
<a href="#l68.36"></a><span id="l68.36">   // next full hour except last hour hour of the day</span>
<a href="#l68.37"></a><span id="l68.37">   let now = new Date();</span>
<a href="#l68.38"></a><span id="l68.38">   let hour = now.getHours();</span>
<a href="#l68.39"></a><span id="l68.39">   let startHour = (hour == 23) ? hour : (hour + 1) % 24;</span>
<a href="#l68.40"></a><span id="l68.40">   let ampm = &quot;&quot;;</span>
<a href="#l68.41"></a><span id="l68.41">   if (now.toLocaleTimeString().match(/AM|PM/)) {</span>
<a href="#l68.42"></a><span id="l68.42" class="difflineminus">-    ampm = (hour &gt;= 12 ? &quot; PM&quot; : &quot; AM&quot;)</span>
<a href="#l68.43"></a><span id="l68.43" class="difflineplus">+    ampm = (hour &gt;= 12 ? &quot; PM&quot; : &quot; AM&quot;);</span>
<a href="#l68.44"></a><span id="l68.44">     startHour = startHour % 12;</span>
<a href="#l68.45"></a><span id="l68.45">     if (startHour == 0) {</span>
<a href="#l68.46"></a><span id="l68.46">       startHour = 12;</span>
<a href="#l68.47"></a><span id="l68.47">     }</span>
<a href="#l68.48"></a><span id="l68.48">   }</span>
<a href="#l68.49"></a><span id="l68.49"> </span>
<a href="#l68.50"></a><span id="l68.50">   let startTime = startHour + ':00' + ampm;</span>
<a href="#l68.51"></a><span id="l68.51">   let endTime = ((startHour + 1) % 24) + ':00' + ampm;</span>
<a href="#l68.52"></a><span id="l68.52" class="difflineat">@@ -87,17 +87,17 @@ var testEventDialog = function() {</span>
<a href="#l68.53"></a><span id="l68.53">     + 'anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'</span>
<a href="#l68.54"></a><span id="l68.54">     );</span>
<a href="#l68.55"></a><span id="l68.55">   event.waitForElement(startTimeInput);</span>
<a href="#l68.56"></a><span id="l68.56">   event.assertValue(startTimeInput, startTime);</span>
<a href="#l68.57"></a><span id="l68.57"> </span>
<a href="#l68.58"></a><span id="l68.58">   // check selected calendar</span>
<a href="#l68.59"></a><span id="l68.59">   event.assertNode(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l68.60"></a><span id="l68.60">     + 'id(&quot;event-grid-category-color-row&quot;)/id(&quot;event-grid-category-box&quot;)/id(&quot;item-calendar&quot;)/[0]/'</span>
<a href="#l68.61"></a><span id="l68.61" class="difflineminus">-    + '{&quot;selected&quot;:&quot;true&quot;,&quot;label&quot;:&quot;' + calendar + '&quot;}'))</span>
<a href="#l68.62"></a><span id="l68.62" class="difflineplus">+    + '{&quot;selected&quot;:&quot;true&quot;,&quot;label&quot;:&quot;' + calendar + '&quot;}'));</span>
<a href="#l68.63"></a><span id="l68.63"> </span>
<a href="#l68.64"></a><span id="l68.64">   // fill in name, location, description</span>
<a href="#l68.65"></a><span id="l68.65">   event.type(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l68.66"></a><span id="l68.66">     + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l68.67"></a><span id="l68.67">     + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l68.68"></a><span id="l68.68">     title);</span>
<a href="#l68.69"></a><span id="l68.69">   event.type(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l68.70"></a><span id="l68.70">     + 'id(&quot;event-grid-location-row&quot;)/id(&quot;item-location&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l68.71"></a><span id="l68.71" class="difflineat">@@ -137,22 +137,22 @@ var testEventDialog = function() {</span>
<a href="#l68.72"></a><span id="l68.72">   event.assertNode(new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l68.73"></a><span id="l68.73">     + 'id(&quot;event-grid-attachment-row&quot;)/id(&quot;attachment-link&quot;)/{&quot;label&quot;:&quot;mozilla.org&quot;}'));</span>
<a href="#l68.74"></a><span id="l68.74"> </span>
<a href="#l68.75"></a><span id="l68.75">   // save</span>
<a href="#l68.76"></a><span id="l68.76">   calUtils.acceptSendingNotificationMail(event);</span>
<a href="#l68.77"></a><span id="l68.77">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l68.78"></a><span id="l68.78"> </span>
<a href="#l68.79"></a><span id="l68.79">   // catch and dismiss alarm</span>
<a href="#l68.80"></a><span id="l68.80" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:AlarmWindow&quot;).length &gt; 0}, sleep);</span>
<a href="#l68.81"></a><span id="l68.81" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:AlarmWindow&quot;).length &gt; 0;}, sleep);</span>
<a href="#l68.82"></a><span id="l68.82">   let alarm = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:AlarmWindow&quot;)[0]);</span>
<a href="#l68.83"></a><span id="l68.83">   // dismiss all button, label in .dtd file, bug #504635</span>
<a href="#l68.84"></a><span id="l68.84">   alarm.waitThenClick(new elementslib.Lookup(alarm.window.document, '/id(&quot;calendar-alarm-dialog&quot;)/'</span>
<a href="#l68.85"></a><span id="l68.85">     + 'id(&quot;alarm-actionbar&quot;)/[1]'));</span>
<a href="#l68.86"></a><span id="l68.86" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:AlarmWindow&quot;).length == 0}, sleep);</span>
<a href="#l68.87"></a><span id="l68.87" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:AlarmWindow&quot;).length == 0;}, sleep);</span>
<a href="#l68.88"></a><span id="l68.88"> </span>
<a href="#l68.89"></a><span id="l68.89">   // verify event and alarm icon visible every day of the month and check tooltip</span>
<a href="#l68.90"></a><span id="l68.90">   // 1st January is Thursday so there's three days to check in the first row</span>
<a href="#l68.91"></a><span id="l68.91">   controller.assertNode(new elementslib.Lookup(controller.window.document,</span>
<a href="#l68.92"></a><span id="l68.92">     eventBox.replace(&quot;rowNumber&quot;, &quot;0&quot;).replace(&quot;columnNumber&quot;, &quot;4&quot;)));</span>
<a href="#l68.93"></a><span id="l68.93">   checkIcon(eventBox, &quot;0&quot;, &quot;4&quot;);</span>
<a href="#l68.94"></a><span id="l68.94">   checkTooltip(monthView, &quot;0&quot;, &quot;4&quot;, &quot;1&quot;, startTime, endTime);</span>
<a href="#l68.95"></a><span id="l68.95"> </span>
<a href="#l68.96"></a><span id="l68.96" class="difflineat">@@ -216,17 +216,17 @@ var testEventDialog = function() {</span>
<a href="#l68.97"></a><span id="l68.97">     eventBox.replace(&quot;rowNumber&quot;, &quot;0&quot;).replace(&quot;columnNumber&quot;, &quot;6&quot;)));</span>
<a href="#l68.98"></a><span id="l68.98"> </span>
<a href="#l68.99"></a><span id="l68.99">   for (row = 1; row &lt; 5; row++) {</span>
<a href="#l68.100"></a><span id="l68.100">     for (col = 0; col &lt; 7; col++) {</span>
<a href="#l68.101"></a><span id="l68.101">         controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document,</span>
<a href="#l68.102"></a><span id="l68.102">           eventBox.replace(&quot;rowNumber&quot;, row).replace(&quot;columnNumber&quot;, col)));</span>
<a href="#l68.103"></a><span id="l68.103">     }</span>
<a href="#l68.104"></a><span id="l68.104">   }</span>
<a href="#l68.105"></a><span id="l68.105" class="difflineminus">-}</span>
<a href="#l68.106"></a><span id="l68.106" class="difflineplus">+};</span>
<a href="#l68.107"></a><span id="l68.107"> </span>
<a href="#l68.108"></a><span id="l68.108"> function handleAttendees(attendees){</span>
<a href="#l68.109"></a><span id="l68.109">   let input = new elementslib.Lookup(attendees.window.document,</span>
<a href="#l68.110"></a><span id="l68.110">     '/id(&quot;calendar-event-dialog-attendees-v2&quot;)/[6]/[0]/id(&quot;attendees-list&quot;)/'</span>
<a href="#l68.111"></a><span id="l68.111">     + 'anon({&quot;anonid&quot;:&quot;listbox&quot;})/[1]/[1]/anon({&quot;anonid&quot;:&quot;input&quot;})/'</span>
<a href="#l68.112"></a><span id="l68.112">     + 'anon({&quot;class&quot;:&quot;autocomplete-textbox-container&quot;})/'</span>
<a href="#l68.113"></a><span id="l68.113">     + '{&quot;class&quot;:&quot;textbox-input-box&quot;}/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l68.114"></a><span id="l68.114">   attendees.waitForElement(input);</span>
<a href="#l68.115"></a><span id="l68.115" class="difflineat">@@ -261,9 +261,9 @@ function checkTooltip(monthView, row, co</span>
<a href="#l68.116"></a><span id="l68.116">     '/id(&quot;messengerWindow&quot;)/id(&quot;calendar-popupset&quot;)/id(&quot;itemTooltip&quot;)/'</span>
<a href="#l68.117"></a><span id="l68.117">     + '{&quot;class&quot;:&quot;tooltipBox&quot;}/{&quot;class&quot;:&quot;tooltipHeaderGrid&quot;}/[1]/[2]/[1]').getNode().textContent + '';</span>
<a href="#l68.118"></a><span id="l68.118">   controller.assertJS(dateTime.includes(date) &amp;&amp; dateTime.includes(startTime)</span>
<a href="#l68.119"></a><span id="l68.119">     &amp;&amp; dateTime.includes(endTime));</span>
<a href="#l68.120"></a><span id="l68.120"> }</span>
<a href="#l68.121"></a><span id="l68.121"> </span>
<a href="#l68.122"></a><span id="l68.122"> var teardownTest = function(module) {</span>
<a href="#l68.123"></a><span id="l68.123">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l68.124"></a><span id="l68.124" class="difflineminus">-}</span>
<a href="#l68.125"></a><span id="l68.125" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l69.1"></a><span id="l69.1" class="difflineminus">--- a/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js</span>
<a href="#l69.2"></a><span id="l69.2" class="difflineplus">+++ b/calendar/test/mozmill/eventDialog/testEventDialogModificationPrompt.js</span>
<a href="#l69.3"></a><span id="l69.3" class="difflineat">@@ -31,61 +31,61 @@ var newlines = [{title: &quot;title&quot;, descrip</span>
<a href="#l69.4"></a><span id="l69.4"> </span>
<a href="#l69.5"></a><span id="l69.5"> var setupModule = function(module) {</span>
<a href="#l69.6"></a><span id="l69.6">   controller = mozmill.getMail3PaneController();</span>
<a href="#l69.7"></a><span id="l69.7">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l69.8"></a><span id="l69.8"> </span>
<a href="#l69.9"></a><span id="l69.9">   let categories = prefs.preferences.getPref(&quot;calendar.categories.names&quot;, &quot;string&quot;).split(',');</span>
<a href="#l69.10"></a><span id="l69.10">   data[0].category = categories[0];</span>
<a href="#l69.11"></a><span id="l69.11">   data[1].category = categories[1];</span>
<a href="#l69.12"></a><span id="l69.12" class="difflineminus">-}</span>
<a href="#l69.13"></a><span id="l69.13" class="difflineplus">+};</span>
<a href="#l69.14"></a><span id="l69.14"> </span>
<a href="#l69.15"></a><span id="l69.15"> // Test that closing an event dialog with no changes does not prompt for save</span>
<a href="#l69.16"></a><span id="l69.16"> var testEventDialogModificationPrompt = function() {</span>
<a href="#l69.17"></a><span id="l69.17">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l69.18"></a><span id="l69.18">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l69.19"></a><span id="l69.19">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l69.20"></a><span id="l69.20"> </span>
<a href="#l69.21"></a><span id="l69.21">   // create new event</span>
<a href="#l69.22"></a><span id="l69.22">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l69.23"></a><span id="l69.23">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, 8)), 1, 1);</span>
<a href="#l69.24"></a><span id="l69.24" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l69.25"></a><span id="l69.25" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l69.26"></a><span id="l69.26">   let event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l69.27"></a><span id="l69.27">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l69.28"></a><span id="l69.28"> </span>
<a href="#l69.29"></a><span id="l69.29">   // enter first set of data</span>
<a href="#l69.30"></a><span id="l69.30">   calUtils.setData(event, data[0]);</span>
<a href="#l69.31"></a><span id="l69.31"> </span>
<a href="#l69.32"></a><span id="l69.32">   // save</span>
<a href="#l69.33"></a><span id="l69.33">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l69.34"></a><span id="l69.34"> </span>
<a href="#l69.35"></a><span id="l69.35">   // open, but change nothing</span>
<a href="#l69.36"></a><span id="l69.36">   let eventBox = new elementslib.Lookup(controller.window.document,</span>
<a href="#l69.37"></a><span id="l69.37">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8)</span>
<a href="#l69.38"></a><span id="l69.38">     + '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;}');</span>
<a href="#l69.39"></a><span id="l69.39">   controller.waitForElement(eventBox);</span>
<a href="#l69.40"></a><span id="l69.40">   controller.doubleClick(eventBox);</span>
<a href="#l69.41"></a><span id="l69.41" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l69.42"></a><span id="l69.42" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l69.43"></a><span id="l69.43">   event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l69.44"></a><span id="l69.44">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l69.45"></a><span id="l69.45"> </span>
<a href="#l69.46"></a><span id="l69.46">   // modal dialog setup</span>
<a href="#l69.47"></a><span id="l69.47">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l69.48"></a><span id="l69.48">   md.start(handleSavePrompt);</span>
<a href="#l69.49"></a><span id="l69.49"> </span>
<a href="#l69.50"></a><span id="l69.50">   // escape the event window, there should be no prompt to save event</span>
<a href="#l69.51"></a><span id="l69.51">   event.keypress(undefined, &quot;VK_ESCAPE&quot;, {});</span>
<a href="#l69.52"></a><span id="l69.52">   controller.sleep(sleep);</span>
<a href="#l69.53"></a><span id="l69.53">   md.stop();</span>
<a href="#l69.54"></a><span id="l69.54"> </span>
<a href="#l69.55"></a><span id="l69.55">   // open</span>
<a href="#l69.56"></a><span id="l69.56">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l69.57"></a><span id="l69.57">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8)</span>
<a href="#l69.58"></a><span id="l69.58">     + '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;}'));</span>
<a href="#l69.59"></a><span id="l69.59" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l69.60"></a><span id="l69.60" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l69.61"></a><span id="l69.61">   event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l69.62"></a><span id="l69.62">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l69.63"></a><span id="l69.63"> </span>
<a href="#l69.64"></a><span id="l69.64">   // change all values</span>
<a href="#l69.65"></a><span id="l69.65">   calUtils.setData(event, data[1]);</span>
<a href="#l69.66"></a><span id="l69.66"> </span>
<a href="#l69.67"></a><span id="l69.67">   // edit all values back to original</span>
<a href="#l69.68"></a><span id="l69.68">   calUtils.setData(event, data[0]);</span>
<a href="#l69.69"></a><span id="l69.69" class="difflineat">@@ -106,53 +106,53 @@ var testEventDialogModificationPrompt = </span>
<a href="#l69.70"></a><span id="l69.70">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l69.71"></a><span id="l69.71">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document,</span>
<a href="#l69.72"></a><span id="l69.72">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8)));</span>
<a href="#l69.73"></a><span id="l69.73"> </span>
<a href="#l69.74"></a><span id="l69.74">   for (let i = 0; i &lt; newlines.length; i++) {</span>
<a href="#l69.75"></a><span id="l69.75">     // test set i</span>
<a href="#l69.76"></a><span id="l69.76">     controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l69.77"></a><span id="l69.77">       calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, 8)), 1, 1);</span>
<a href="#l69.78"></a><span id="l69.78" class="difflineminus">-    controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l69.79"></a><span id="l69.79" class="difflineplus">+    controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l69.80"></a><span id="l69.80">     event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l69.81"></a><span id="l69.81">       .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l69.82"></a><span id="l69.82">     calUtils.setData(event, newlines[i]);</span>
<a href="#l69.83"></a><span id="l69.83">     event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l69.84"></a><span id="l69.84"> </span>
<a href="#l69.85"></a><span id="l69.85">     // open and close</span>
<a href="#l69.86"></a><span id="l69.86">     eventBox = new elementslib.Lookup(controller.window.document,</span>
<a href="#l69.87"></a><span id="l69.87">       calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8)</span>
<a href="#l69.88"></a><span id="l69.88">       + '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;}');</span>
<a href="#l69.89"></a><span id="l69.89">     controller.waitForElement(eventBox);</span>
<a href="#l69.90"></a><span id="l69.90">     controller.doubleClick(eventBox);</span>
<a href="#l69.91"></a><span id="l69.91" class="difflineminus">-    controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l69.92"></a><span id="l69.92" class="difflineplus">+    controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l69.93"></a><span id="l69.93">     event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l69.94"></a><span id="l69.94">       .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l69.95"></a><span id="l69.95">     md = new modalDialog.modalDialog(event.window);</span>
<a href="#l69.96"></a><span id="l69.96">     md.start(handleSavePrompt);</span>
<a href="#l69.97"></a><span id="l69.97">     event.keypress(undefined, &quot;VK_ESCAPE&quot;, {});</span>
<a href="#l69.98"></a><span id="l69.98">     controller.sleep(sleep);</span>
<a href="#l69.99"></a><span id="l69.99">     md.stop();</span>
<a href="#l69.100"></a><span id="l69.100"> </span>
<a href="#l69.101"></a><span id="l69.101">     // delete it</span>
<a href="#l69.102"></a><span id="l69.102">     // XXX somehow the event is selected at this point, this didn't use to be the case</span>
<a href="#l69.103"></a><span id="l69.103">     // and can't be reproduced manually</span>
<a href="#l69.104"></a><span id="l69.104">     controller.keypress(new elementslib.ID(controller.window.document, &quot;day-view&quot;),</span>
<a href="#l69.105"></a><span id="l69.105">       &quot;VK_DELETE&quot;, {});</span>
<a href="#l69.106"></a><span id="l69.106">     controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document,</span>
<a href="#l69.107"></a><span id="l69.107">       calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8)));</span>
<a href="#l69.108"></a><span id="l69.108">   }</span>
<a href="#l69.109"></a><span id="l69.109" class="difflineminus">-}</span>
<a href="#l69.110"></a><span id="l69.110" class="difflineplus">+};</span>
<a href="#l69.111"></a><span id="l69.111"> </span>
<a href="#l69.112"></a><span id="l69.112"> var teardownTest = function(module) {</span>
<a href="#l69.113"></a><span id="l69.113">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l69.114"></a><span id="l69.114">   if (pass != undefined &amp;&amp; pass == false) {</span>
<a href="#l69.115"></a><span id="l69.115">     controller.assertJS('&quot;Prompt appeared&quot; == &quot;Prompt didn\'t appear.&quot;');</span>
<a href="#l69.116"></a><span id="l69.116">   }</span>
<a href="#l69.117"></a><span id="l69.117" class="difflineminus">-}</span>
<a href="#l69.118"></a><span id="l69.118" class="difflineplus">+};</span>
<a href="#l69.119"></a><span id="l69.119"> </span>
<a href="#l69.120"></a><span id="l69.120"> function handleSavePrompt(controller) {</span>
<a href="#l69.121"></a><span id="l69.121">   // unexpected prompt, thus the test has already failed</span>
<a href="#l69.122"></a><span id="l69.122">   // can't trigger a failure though, because the following click wouldn't be executed</span>
<a href="#l69.123"></a><span id="l69.123">   // so remembering it</span>
<a href="#l69.124"></a><span id="l69.124">   pass = false;</span>
<a href="#l69.125"></a><span id="l69.125">   // application close is blocked without it</span>
<a href="#l69.126"></a><span id="l69.126">   controller.click(new elementslib.Lookup(controller.window.document,</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l70.1"></a><span id="l70.1" class="difflineminus">--- a/calendar/test/mozmill/eventDialog/testUTF8.js</span>
<a href="#l70.2"></a><span id="l70.2" class="difflineplus">+++ b/calendar/test/mozmill/eventDialog/testUTF8.js</span>
<a href="#l70.3"></a><span id="l70.3" class="difflineat">@@ -9,28 +9,28 @@ Components.utils.import(&quot;resource://gre/</span>
<a href="#l70.4"></a><span id="l70.4"> </span>
<a href="#l70.5"></a><span id="l70.5"> var sleep = 500;</span>
<a href="#l70.6"></a><span id="l70.6"> var UTF8string = &quot;&quot;;</span>
<a href="#l70.7"></a><span id="l70.7"> </span>
<a href="#l70.8"></a><span id="l70.8"> var setupModule = function(module) {</span>
<a href="#l70.9"></a><span id="l70.9">   controller = mozmill.getMail3PaneController();</span>
<a href="#l70.10"></a><span id="l70.10">   calUtils.createCalendar(controller, UTF8string);</span>
<a href="#l70.11"></a><span id="l70.11">   Preferences.set(&quot;calendar.categories.names&quot;, UTF8string);</span>
<a href="#l70.12"></a><span id="l70.12" class="difflineminus">-}</span>
<a href="#l70.13"></a><span id="l70.13" class="difflineplus">+};</span>
<a href="#l70.14"></a><span id="l70.14"> </span>
<a href="#l70.15"></a><span id="l70.15"> var testUTF8 = function() {</span>
<a href="#l70.16"></a><span id="l70.16">   let eventDialog = '/id(&quot;calendar-event-dialog&quot;)/id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/';</span>
<a href="#l70.17"></a><span id="l70.17"> </span>
<a href="#l70.18"></a><span id="l70.18">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l70.19"></a><span id="l70.19">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l70.20"></a><span id="l70.20"> </span>
<a href="#l70.21"></a><span id="l70.21">   // create new event</span>
<a href="#l70.22"></a><span id="l70.22">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l70.23"></a><span id="l70.23">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, 8)));</span>
<a href="#l70.24"></a><span id="l70.24" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l70.25"></a><span id="l70.25" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l70.26"></a><span id="l70.26">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l70.27"></a><span id="l70.27"> </span>
<a href="#l70.28"></a><span id="l70.28">   // fill in name, location, description</span>
<a href="#l70.29"></a><span id="l70.29">   let titleTextBox = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l70.30"></a><span id="l70.30">     + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l70.31"></a><span id="l70.31">     + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l70.32"></a><span id="l70.32">   event.waitForElement(titleTextBox);</span>
<a href="#l70.33"></a><span id="l70.33">   event.type(titleTextBox, UTF8string);</span>
<a href="#l70.34"></a><span id="l70.34" class="difflineat">@@ -51,17 +51,17 @@ var testUTF8 = function() {</span>
<a href="#l70.35"></a><span id="l70.35">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l70.36"></a><span id="l70.36"> </span>
<a href="#l70.37"></a><span id="l70.37">   // open</span>
<a href="#l70.38"></a><span id="l70.38">   let eventBox = new elementslib.Lookup(controller.window.document,</span>
<a href="#l70.39"></a><span id="l70.39">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, 8)</span>
<a href="#l70.40"></a><span id="l70.40">     + '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + UTF8string.toLowerCase() + '&quot;}');</span>
<a href="#l70.41"></a><span id="l70.41">   controller.waitForElement(eventBox);</span>
<a href="#l70.42"></a><span id="l70.42">   controller.doubleClick(eventBox);</span>
<a href="#l70.43"></a><span id="l70.43" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l70.44"></a><span id="l70.44" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l70.45"></a><span id="l70.45">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l70.46"></a><span id="l70.46"> </span>
<a href="#l70.47"></a><span id="l70.47">   // check values</span>
<a href="#l70.48"></a><span id="l70.48">   titleTextBox = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l70.49"></a><span id="l70.49">     + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l70.50"></a><span id="l70.50">     + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l70.51"></a><span id="l70.51">   event.waitForElement(titleTextBox);</span>
<a href="#l70.52"></a><span id="l70.52">   event.assertValue(titleTextBox, UTF8string);</span>
<a href="#l70.53"></a><span id="l70.53" class="difflineat">@@ -73,14 +73,14 @@ var testUTF8 = function() {</span>
<a href="#l70.54"></a><span id="l70.54">     + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l70.55"></a><span id="l70.55">     + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l70.56"></a><span id="l70.56">     UTF8string);</span>
<a href="#l70.57"></a><span id="l70.57">   event.assertValue(new elementslib.ID(event.window.document, &quot;item-categories&quot;),</span>
<a href="#l70.58"></a><span id="l70.58">     UTF8string);</span>
<a href="#l70.59"></a><span id="l70.59"> </span>
<a href="#l70.60"></a><span id="l70.60">   // escape the event window</span>
<a href="#l70.61"></a><span id="l70.61">   event.keypress(undefined, &quot;VK_ESCAPE&quot;, {});</span>
<a href="#l70.62"></a><span id="l70.62" class="difflineminus">-}</span>
<a href="#l70.63"></a><span id="l70.63" class="difflineplus">+};</span>
<a href="#l70.64"></a><span id="l70.64"> </span>
<a href="#l70.65"></a><span id="l70.65"> var teardownTest = function(module) {</span>
<a href="#l70.66"></a><span id="l70.66">   calUtils.deleteCalendars(controller, UTF8string);</span>
<a href="#l70.67"></a><span id="l70.67">   prefs.preferences.clearUserPref(&quot;calendar.categories.names&quot;);</span>
<a href="#l70.68"></a><span id="l70.68" class="difflineminus">-}</span>
<a href="#l70.69"></a><span id="l70.69" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l71.1"></a><span id="l71.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testAnnualRecurrence.js</span>
<a href="#l71.2"></a><span id="l71.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testAnnualRecurrence.js</span>
<a href="#l71.3"></a><span id="l71.3" class="difflineat">@@ -7,31 +7,31 @@ var calUtils = require(&quot;../shared-module</span>
<a href="#l71.4"></a><span id="l71.4"> var sleep = 500;</span>
<a href="#l71.5"></a><span id="l71.5"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l71.6"></a><span id="l71.6"> var startYear = 1950;</span>
<a href="#l71.7"></a><span id="l71.7"> var epoch = 1970;</span>
<a href="#l71.8"></a><span id="l71.8"> </span>
<a href="#l71.9"></a><span id="l71.9"> var setupModule = function(module) {</span>
<a href="#l71.10"></a><span id="l71.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l71.11"></a><span id="l71.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l71.12"></a><span id="l71.12" class="difflineminus">-}</span>
<a href="#l71.13"></a><span id="l71.13" class="difflineplus">+};</span>
<a href="#l71.14"></a><span id="l71.14"> </span>
<a href="#l71.15"></a><span id="l71.15"> var testAnnualRecurrence = function() {</span>
<a href="#l71.16"></a><span id="l71.16">   var eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l71.17"></a><span id="l71.17"> </span>
<a href="#l71.18"></a><span id="l71.18">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l71.19"></a><span id="l71.19">   controller.sleep(sleep);</span>
<a href="#l71.20"></a><span id="l71.20"> </span>
<a href="#l71.21"></a><span id="l71.21">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l71.22"></a><span id="l71.22">   calUtils.goToDate(controller, startYear, 1, 1);</span>
<a href="#l71.23"></a><span id="l71.23"> </span>
<a href="#l71.24"></a><span id="l71.24">   // create yearly recurring all-day event</span>
<a href="#l71.25"></a><span id="l71.25">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l71.26"></a><span id="l71.26">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.ALLDAY, undefined, 1, undefined)));</span>
<a href="#l71.27"></a><span id="l71.27" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l71.28"></a><span id="l71.28" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l71.29"></a><span id="l71.29">   let event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l71.30"></a><span id="l71.30">                  .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l71.31"></a><span id="l71.31">   event.sleep(sleep);</span>
<a href="#l71.32"></a><span id="l71.32">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined,</span>
<a href="#l71.33"></a><span id="l71.33">     &quot;yearly&quot;);</span>
<a href="#l71.34"></a><span id="l71.34">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l71.35"></a><span id="l71.35">   controller.sleep(sleep);</span>
<a href="#l71.36"></a><span id="l71.36"> </span>
<a href="#l71.37"></a><span id="l71.37" class="difflineat">@@ -72,13 +72,13 @@ var testAnnualRecurrence = function() {</span>
<a href="#l71.38"></a><span id="l71.38">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l71.39"></a><span id="l71.39">   box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.ALLDAY, undefined, 1, undefined)</span>
<a href="#l71.40"></a><span id="l71.40">     + eventPath;</span>
<a href="#l71.41"></a><span id="l71.41">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l71.42"></a><span id="l71.42">   controller.click(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l71.43"></a><span id="l71.43">   controller.keypress(new elementslib.ID(controller.window.document, &quot;day-view&quot;),</span>
<a href="#l71.44"></a><span id="l71.44">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l71.45"></a><span id="l71.45">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l71.46"></a><span id="l71.46" class="difflineminus">-}</span>
<a href="#l71.47"></a><span id="l71.47" class="difflineplus">+};</span>
<a href="#l71.48"></a><span id="l71.48"> </span>
<a href="#l71.49"></a><span id="l71.49"> var teardownTest = function(module) {</span>
<a href="#l71.50"></a><span id="l71.50">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l71.51"></a><span id="l71.51" class="difflineminus">-}</span>
<a href="#l71.52"></a><span id="l71.52" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l72.1"></a><span id="l72.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js</span>
<a href="#l72.2"></a><span id="l72.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testBiweeklyRecurrence.js</span>
<a href="#l72.3"></a><span id="l72.3" class="difflineat">@@ -6,35 +6,35 @@ var calUtils = require(&quot;../shared-module</span>
<a href="#l72.4"></a><span id="l72.4"> </span>
<a href="#l72.5"></a><span id="l72.5"> var sleep = 500;</span>
<a href="#l72.6"></a><span id="l72.6"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l72.7"></a><span id="l72.7"> var hour = 8;</span>
<a href="#l72.8"></a><span id="l72.8"> </span>
<a href="#l72.9"></a><span id="l72.9"> var setupModule = function(module) {</span>
<a href="#l72.10"></a><span id="l72.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l72.11"></a><span id="l72.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l72.12"></a><span id="l72.12" class="difflineminus">-}</span>
<a href="#l72.13"></a><span id="l72.13" class="difflineplus">+};</span>
<a href="#l72.14"></a><span id="l72.14"> </span>
<a href="#l72.15"></a><span id="l72.15"> var testBiweeklyRecurrence = function() {</span>
<a href="#l72.16"></a><span id="l72.16">   var eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l72.17"></a><span id="l72.17"> </span>
<a href="#l72.18"></a><span id="l72.18">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l72.19"></a><span id="l72.19">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l72.20"></a><span id="l72.20">   calUtils.goToDate(controller, 2009, 1, 31);</span>
<a href="#l72.21"></a><span id="l72.21"> </span>
<a href="#l72.22"></a><span id="l72.22">   // create biweekly event</span>
<a href="#l72.23"></a><span id="l72.23">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l72.24"></a><span id="l72.24">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l72.25"></a><span id="l72.25" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l72.26"></a><span id="l72.26" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l72.27"></a><span id="l72.27">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l72.28"></a><span id="l72.28"> </span>
<a href="#l72.29"></a><span id="l72.29">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l72.30"></a><span id="l72.30">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;bi.weekly&quot;);</span>
<a href="#l72.31"></a><span id="l72.31">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l72.32"></a><span id="l72.32" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l72.33"></a><span id="l72.33" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l72.34"></a><span id="l72.34"> </span>
<a href="#l72.35"></a><span id="l72.35">   let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l72.36"></a><span id="l72.36">     + eventPath;</span>
<a href="#l72.37"></a><span id="l72.37"> </span>
<a href="#l72.38"></a><span id="l72.38">   // check day view</span>
<a href="#l72.39"></a><span id="l72.39">   for (let i = 0; i &lt; 4; i++){</span>
<a href="#l72.40"></a><span id="l72.40">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l72.41"></a><span id="l72.41">     calUtils.forward(controller, 14);</span>
<a href="#l72.42"></a><span id="l72.42" class="difflineat">@@ -94,13 +94,13 @@ var testBiweeklyRecurrence = function() </span>
<a href="#l72.43"></a><span id="l72.43">   controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l72.44"></a><span id="l72.44"> </span>
<a href="#l72.45"></a><span id="l72.45">   // delete event</span>
<a href="#l72.46"></a><span id="l72.46">   controller.click(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l72.47"></a><span id="l72.47">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l72.48"></a><span id="l72.48">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l72.49"></a><span id="l72.49">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l72.50"></a><span id="l72.50">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l72.51"></a><span id="l72.51" class="difflineminus">-}</span>
<a href="#l72.52"></a><span id="l72.52" class="difflineplus">+};</span>
<a href="#l72.53"></a><span id="l72.53"> </span>
<a href="#l72.54"></a><span id="l72.54"> var teardownTest = function(module) {</span>
<a href="#l72.55"></a><span id="l72.55">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l72.56"></a><span id="l72.56" class="difflineminus">-}</span>
<a href="#l72.57"></a><span id="l72.57" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l73.1"></a><span id="l73.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testDailyRecurrence.js</span>
<a href="#l73.2"></a><span id="l73.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testDailyRecurrence.js</span>
<a href="#l73.3"></a><span id="l73.3" class="difflineat">@@ -6,29 +6,29 @@ var calUtils = require(&quot;../shared-module</span>
<a href="#l73.4"></a><span id="l73.4"> </span>
<a href="#l73.5"></a><span id="l73.5"> var sleep = 500;</span>
<a href="#l73.6"></a><span id="l73.6"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l73.7"></a><span id="l73.7"> var hour = 8;</span>
<a href="#l73.8"></a><span id="l73.8"> </span>
<a href="#l73.9"></a><span id="l73.9"> var setupModule = function(module) {</span>
<a href="#l73.10"></a><span id="l73.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l73.11"></a><span id="l73.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l73.12"></a><span id="l73.12" class="difflineminus">-}</span>
<a href="#l73.13"></a><span id="l73.13" class="difflineplus">+};</span>
<a href="#l73.14"></a><span id="l73.14"> </span>
<a href="#l73.15"></a><span id="l73.15"> var testDailyRecurrence = function() {</span>
<a href="#l73.16"></a><span id="l73.16">   let eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l73.17"></a><span id="l73.17"> </span>
<a href="#l73.18"></a><span id="l73.18">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l73.19"></a><span id="l73.19">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l73.20"></a><span id="l73.20">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l73.21"></a><span id="l73.21"> </span>
<a href="#l73.22"></a><span id="l73.22">   // create daily event</span>
<a href="#l73.23"></a><span id="l73.23">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l73.24"></a><span id="l73.24">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l73.25"></a><span id="l73.25" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l73.26"></a><span id="l73.26" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l73.27"></a><span id="l73.27">   let event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l73.28"></a><span id="l73.28">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l73.29"></a><span id="l73.29"> </span>
<a href="#l73.30"></a><span id="l73.30">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l73.31"></a><span id="l73.31">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined,</span>
<a href="#l73.32"></a><span id="l73.32">     &quot;daily&quot;);</span>
<a href="#l73.33"></a><span id="l73.33">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l73.34"></a><span id="l73.34"> </span>
<a href="#l73.35"></a><span id="l73.35" class="difflineat">@@ -125,25 +125,25 @@ var testDailyRecurrence = function() {</span>
<a href="#l73.36"></a><span id="l73.36">   // go to previous day to edit event to occur only on weekdays</span>
<a href="#l73.37"></a><span id="l73.37">   calUtils.back(controller, 1);</span>
<a href="#l73.38"></a><span id="l73.38"> </span>
<a href="#l73.39"></a><span id="l73.39">   calUtils.handleParentModification(controller, false);</span>
<a href="#l73.40"></a><span id="l73.40">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l73.41"></a><span id="l73.41">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l73.42"></a><span id="l73.42">       + eventPath));</span>
<a href="#l73.43"></a><span id="l73.43"> </span>
<a href="#l73.44"></a><span id="l73.44" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l73.45"></a><span id="l73.45" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l73.46"></a><span id="l73.46">   event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l73.47"></a><span id="l73.47">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l73.48"></a><span id="l73.48"> </span>
<a href="#l73.49"></a><span id="l73.49">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l73.50"></a><span id="l73.50">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined,</span>
<a href="#l73.51"></a><span id="l73.51">     &quot;every.weekday&quot;);</span>
<a href="#l73.52"></a><span id="l73.52">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l73.53"></a><span id="l73.53" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l73.54"></a><span id="l73.54" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l73.55"></a><span id="l73.55"> </span>
<a href="#l73.56"></a><span id="l73.56">   // check day view for 7 days</span>
<a href="#l73.57"></a><span id="l73.57">   let day = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, undefined)</span>
<a href="#l73.58"></a><span id="l73.58">     + eventPath;</span>
<a href="#l73.59"></a><span id="l73.59">   var dates = [[2009, 1, 3],</span>
<a href="#l73.60"></a><span id="l73.60">                [2009, 1, 4]];</span>
<a href="#l73.61"></a><span id="l73.61">   for (let i = 0; i &lt; dates.length; i++){</span>
<a href="#l73.62"></a><span id="l73.62">     calUtils.goToDate(controller, dates[i][0], dates[i][1], dates[i][2]);</span>
<a href="#l73.63"></a><span id="l73.63" class="difflineat">@@ -193,13 +193,13 @@ var testDailyRecurrence = function() {</span>
<a href="#l73.64"></a><span id="l73.64">   // delete event</span>
<a href="#l73.65"></a><span id="l73.65">   day = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 1, 5, undefined)</span>
<a href="#l73.66"></a><span id="l73.66">     + eventPath;</span>
<a href="#l73.67"></a><span id="l73.67">   controller.click(new elementslib.Lookup(controller.window.document, day));</span>
<a href="#l73.68"></a><span id="l73.68">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l73.69"></a><span id="l73.69">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l73.70"></a><span id="l73.70">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l73.71"></a><span id="l73.71">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, day));</span>
<a href="#l73.72"></a><span id="l73.72" class="difflineminus">-}</span>
<a href="#l73.73"></a><span id="l73.73" class="difflineplus">+};</span>
<a href="#l73.74"></a><span id="l73.74"> </span>
<a href="#l73.75"></a><span id="l73.75"> var teardownTest = function(module) {</span>
<a href="#l73.76"></a><span id="l73.76">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l73.77"></a><span id="l73.77" class="difflineminus">-}</span>
<a href="#l73.78"></a><span id="l73.78" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l74.1"></a><span id="l74.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js</span>
<a href="#l74.2"></a><span id="l74.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testLastDayOfMonthRecurrence.js</span>
<a href="#l74.3"></a><span id="l74.3" class="difflineat">@@ -7,39 +7,39 @@ var modalDialog = require(&quot;../shared-mod</span>
<a href="#l74.4"></a><span id="l74.4"> </span>
<a href="#l74.5"></a><span id="l74.5"> var sleep = 500;</span>
<a href="#l74.6"></a><span id="l74.6"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l74.7"></a><span id="l74.7"> var hour = 8;</span>
<a href="#l74.8"></a><span id="l74.8"> </span>
<a href="#l74.9"></a><span id="l74.9"> var setupModule = function(module) {</span>
<a href="#l74.10"></a><span id="l74.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l74.11"></a><span id="l74.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l74.12"></a><span id="l74.12" class="difflineminus">-}</span>
<a href="#l74.13"></a><span id="l74.13" class="difflineplus">+};</span>
<a href="#l74.14"></a><span id="l74.14"> </span>
<a href="#l74.15"></a><span id="l74.15"> var testLastDayOfMonthRecurrence = function() {</span>
<a href="#l74.16"></a><span id="l74.16">   var eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l74.17"></a><span id="l74.17">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l74.18"></a><span id="l74.18">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l74.19"></a><span id="l74.19">   calUtils.goToDate(controller, 2008, 1, 31); // start with a leap year</span>
<a href="#l74.20"></a><span id="l74.20"> </span>
<a href="#l74.21"></a><span id="l74.21">   // create monthly recurring event</span>
<a href="#l74.22"></a><span id="l74.22">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l74.23"></a><span id="l74.23">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l74.24"></a><span id="l74.24" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l74.25"></a><span id="l74.25" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l74.26"></a><span id="l74.26">   let event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l74.27"></a><span id="l74.27">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l74.28"></a><span id="l74.28"> </span>
<a href="#l74.29"></a><span id="l74.29">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l74.30"></a><span id="l74.30">   md.start(setRecurrence);</span>
<a href="#l74.31"></a><span id="l74.31">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l74.32"></a><span id="l74.32">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined,</span>
<a href="#l74.33"></a><span id="l74.33">     &quot;custom&quot;);</span>
<a href="#l74.34"></a><span id="l74.34"> </span>
<a href="#l74.35"></a><span id="l74.35">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l74.36"></a><span id="l74.36" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l74.37"></a><span id="l74.37" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l74.38"></a><span id="l74.38"> </span>
<a href="#l74.39"></a><span id="l74.39">   //                        date     correct row in month view</span>
<a href="#l74.40"></a><span id="l74.40">   let checkingData = [[2008, 1, 31, 5],</span>
<a href="#l74.41"></a><span id="l74.41">                       [2008, 2, 29, 5],</span>
<a href="#l74.42"></a><span id="l74.42">                       [2008, 3, 31, 6],</span>
<a href="#l74.43"></a><span id="l74.43">                       [2008, 4, 30, 5],</span>
<a href="#l74.44"></a><span id="l74.44">                       [2008, 5, 31, 5],</span>
<a href="#l74.45"></a><span id="l74.45">                       [2008, 6, 30, 5],</span>
<a href="#l74.46"></a><span id="l74.46" class="difflineat">@@ -90,17 +90,17 @@ var testLastDayOfMonthRecurrence = funct</span>
<a href="#l74.47"></a><span id="l74.47">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l74.48"></a><span id="l74.48">   box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX,</span>
<a href="#l74.49"></a><span id="l74.49">     undefined, 1, hour) + eventPath;</span>
<a href="#l74.50"></a><span id="l74.50">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l74.51"></a><span id="l74.51">   controller.waitThenClick(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l74.52"></a><span id="l74.52">   controller.keypress(new elementslib.ID(controller.window.document, &quot;day-view&quot;),</span>
<a href="#l74.53"></a><span id="l74.53">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l74.54"></a><span id="l74.54">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l74.55"></a><span id="l74.55" class="difflineminus">-}</span>
<a href="#l74.56"></a><span id="l74.56" class="difflineplus">+};</span>
<a href="#l74.57"></a><span id="l74.57"> </span>
<a href="#l74.58"></a><span id="l74.58"> function setRecurrence(recurrence){</span>
<a href="#l74.59"></a><span id="l74.59">   recurrence.sleep(sleep);</span>
<a href="#l74.60"></a><span id="l74.60"> </span>
<a href="#l74.61"></a><span id="l74.61">   // monthly</span>
<a href="#l74.62"></a><span id="l74.62">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined,</span>
<a href="#l74.63"></a><span id="l74.63">     undefined, &quot;2&quot;);</span>
<a href="#l74.64"></a><span id="l74.64"> </span>
<a href="#l74.65"></a><span id="l74.65" class="difflineat">@@ -116,9 +116,9 @@ function setRecurrence(recurrence){</span>
<a href="#l74.66"></a><span id="l74.66"> </span>
<a href="#l74.67"></a><span id="l74.67">   // close dialog</span>
<a href="#l74.68"></a><span id="l74.68">   recurrence.click(new elementslib.Lookup(recurrence.window.document,</span>
<a href="#l74.69"></a><span id="l74.69">     '/id(&quot;calendar-event-dialog-recurrence&quot;)/anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l74.70"></a><span id="l74.70"> }</span>
<a href="#l74.71"></a><span id="l74.71"> </span>
<a href="#l74.72"></a><span id="l74.72"> var teardownTest = function(module) {</span>
<a href="#l74.73"></a><span id="l74.73">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l74.74"></a><span id="l74.74" class="difflineminus">-}</span>
<a href="#l74.75"></a><span id="l74.75" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l75.1"></a><span id="l75.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js</span>
<a href="#l75.2"></a><span id="l75.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testWeeklyNRecurrence.js</span>
<a href="#l75.3"></a><span id="l75.3" class="difflineat">@@ -9,27 +9,27 @@ var utils = require(&quot;../shared-modules/u</span>
<a href="#l75.4"></a><span id="l75.4"> var sleep = 500;</span>
<a href="#l75.5"></a><span id="l75.5"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l75.6"></a><span id="l75.6"> var hour = 8;</span>
<a href="#l75.7"></a><span id="l75.7"> var eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l75.8"></a><span id="l75.8"> </span>
<a href="#l75.9"></a><span id="l75.9"> var setupModule = function(module) {</span>
<a href="#l75.10"></a><span id="l75.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l75.11"></a><span id="l75.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l75.12"></a><span id="l75.12" class="difflineminus">-}</span>
<a href="#l75.13"></a><span id="l75.13" class="difflineplus">+};</span>
<a href="#l75.14"></a><span id="l75.14"> </span>
<a href="#l75.15"></a><span id="l75.15"> var testWeeklyNRecurrence = function() {</span>
<a href="#l75.16"></a><span id="l75.16">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l75.17"></a><span id="l75.17">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l75.18"></a><span id="l75.18">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l75.19"></a><span id="l75.19"> </span>
<a href="#l75.20"></a><span id="l75.20">   // create weekly recurring event</span>
<a href="#l75.21"></a><span id="l75.21">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l75.22"></a><span id="l75.22">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l75.23"></a><span id="l75.23" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l75.24"></a><span id="l75.24" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l75.25"></a><span id="l75.25">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l75.26"></a><span id="l75.26"> </span>
<a href="#l75.27"></a><span id="l75.27">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l75.28"></a><span id="l75.28">   md.start(setRecurrence);</span>
<a href="#l75.29"></a><span id="l75.29">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l75.30"></a><span id="l75.30">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l75.31"></a><span id="l75.31"> </span>
<a href="#l75.32"></a><span id="l75.32">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l75.33"></a><span id="l75.33" class="difflineat">@@ -74,17 +74,17 @@ var testWeeklyNRecurrence = function() {</span>
<a href="#l75.34"></a><span id="l75.34">   // delete event</span>
<a href="#l75.35"></a><span id="l75.35">   box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 2, hour)</span>
<a href="#l75.36"></a><span id="l75.36">     + eventPath;</span>
<a href="#l75.37"></a><span id="l75.37">   controller.click(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l75.38"></a><span id="l75.38">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l75.39"></a><span id="l75.39">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l75.40"></a><span id="l75.40">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l75.41"></a><span id="l75.41">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l75.42"></a><span id="l75.42" class="difflineminus">-}</span>
<a href="#l75.43"></a><span id="l75.43" class="difflineplus">+};</span>
<a href="#l75.44"></a><span id="l75.44"> </span>
<a href="#l75.45"></a><span id="l75.45"> function setRecurrence(recurrence){</span>
<a href="#l75.46"></a><span id="l75.46">   // weekly</span>
<a href="#l75.47"></a><span id="l75.47">   recurrence.waitForElement(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;));</span>
<a href="#l75.48"></a><span id="l75.48">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined, undefined, &quot;1&quot;);</span>
<a href="#l75.49"></a><span id="l75.49">   recurrence.sleep(sleep);</span>
<a href="#l75.50"></a><span id="l75.50"> </span>
<a href="#l75.51"></a><span id="l75.51">   let mon = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.2.Mmm&quot;);</span>
<a href="#l75.52"></a><span id="l75.52" class="difflineat">@@ -137,9 +137,9 @@ function checkMultiWeekView(view){</span>
<a href="#l75.53"></a><span id="l75.53">   // Saturday</span>
<a href="#l75.54"></a><span id="l75.54">   let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 7, undefined)</span>
<a href="#l75.55"></a><span id="l75.55">     + eventPath;</span>
<a href="#l75.56"></a><span id="l75.56">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l75.57"></a><span id="l75.57"> }</span>
<a href="#l75.58"></a><span id="l75.58"> </span>
<a href="#l75.59"></a><span id="l75.59"> var teardownTest = function(module) {</span>
<a href="#l75.60"></a><span id="l75.60">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l75.61"></a><span id="l75.61" class="difflineminus">-}</span>
<a href="#l75.62"></a><span id="l75.62" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l76.1"></a><span id="l76.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js</span>
<a href="#l76.2"></a><span id="l76.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testWeeklyUntilRecurrence.js</span>
<a href="#l76.3"></a><span id="l76.3" class="difflineat">@@ -11,36 +11,36 @@ var calendar = &quot;Mozmill&quot;;</span>
<a href="#l76.4"></a><span id="l76.4"> var endDate = new Date(2009, 0, 26); // last Monday in month</span>
<a href="#l76.5"></a><span id="l76.5"> </span>
<a href="#l76.6"></a><span id="l76.6"> var hour = 8;</span>
<a href="#l76.7"></a><span id="l76.7"> var eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l76.8"></a><span id="l76.8"> </span>
<a href="#l76.9"></a><span id="l76.9"> var setupModule = function(module) {</span>
<a href="#l76.10"></a><span id="l76.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l76.11"></a><span id="l76.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l76.12"></a><span id="l76.12" class="difflineminus">-}</span>
<a href="#l76.13"></a><span id="l76.13" class="difflineplus">+};</span>
<a href="#l76.14"></a><span id="l76.14"> </span>
<a href="#l76.15"></a><span id="l76.15"> var testWeeklyUntilRecurrence = function() {</span>
<a href="#l76.16"></a><span id="l76.16">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l76.17"></a><span id="l76.17">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l76.18"></a><span id="l76.18">   calUtils.goToDate(controller, 2009, 1, 5); // Monday</span>
<a href="#l76.19"></a><span id="l76.19"> </span>
<a href="#l76.20"></a><span id="l76.20">   // create weekly recurring event</span>
<a href="#l76.21"></a><span id="l76.21">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l76.22"></a><span id="l76.22">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l76.23"></a><span id="l76.23" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l76.24"></a><span id="l76.24" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l76.25"></a><span id="l76.25">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l76.26"></a><span id="l76.26"> </span>
<a href="#l76.27"></a><span id="l76.27">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l76.28"></a><span id="l76.28">   md.start(setRecurrence);</span>
<a href="#l76.29"></a><span id="l76.29">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l76.30"></a><span id="l76.30">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l76.31"></a><span id="l76.31"> </span>
<a href="#l76.32"></a><span id="l76.32">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l76.33"></a><span id="l76.33" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l76.34"></a><span id="l76.34" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l76.35"></a><span id="l76.35"> </span>
<a href="#l76.36"></a><span id="l76.36">   let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l76.37"></a><span id="l76.37">     + eventPath;</span>
<a href="#l76.38"></a><span id="l76.38"> </span>
<a href="#l76.39"></a><span id="l76.39">   // check day view</span>
<a href="#l76.40"></a><span id="l76.40">   for (let week = 0; week &lt; 3; week++){</span>
<a href="#l76.41"></a><span id="l76.41">     // Monday</span>
<a href="#l76.42"></a><span id="l76.42">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l76.43"></a><span id="l76.43" class="difflineat">@@ -102,17 +102,17 @@ var testWeeklyUntilRecurrence = function</span>
<a href="#l76.44"></a><span id="l76.44">   // delete event</span>
<a href="#l76.45"></a><span id="l76.45">   box = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 2, 2, undefined)</span>
<a href="#l76.46"></a><span id="l76.46">     + eventPath;</span>
<a href="#l76.47"></a><span id="l76.47">   controller.click(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l76.48"></a><span id="l76.48">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l76.49"></a><span id="l76.49">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l76.50"></a><span id="l76.50">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l76.51"></a><span id="l76.51">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l76.52"></a><span id="l76.52" class="difflineminus">-}</span>
<a href="#l76.53"></a><span id="l76.53" class="difflineplus">+};</span>
<a href="#l76.54"></a><span id="l76.54"> </span>
<a href="#l76.55"></a><span id="l76.55"> function setRecurrence(recurrence){</span>
<a href="#l76.56"></a><span id="l76.56">   // weekly</span>
<a href="#l76.57"></a><span id="l76.57">   recurrence.waitForElement(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;));</span>
<a href="#l76.58"></a><span id="l76.58">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined, undefined, &quot;1&quot;);</span>
<a href="#l76.59"></a><span id="l76.59">   recurrence.sleep(sleep);</span>
<a href="#l76.60"></a><span id="l76.60"> </span>
<a href="#l76.61"></a><span id="l76.61">   let mon = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.2.Mmm&quot;);</span>
<a href="#l76.62"></a><span id="l76.62" class="difflineat">@@ -180,9 +180,9 @@ function checkMultiWeekView(view){</span>
<a href="#l76.63"></a><span id="l76.63">   // Wednesday</span>
<a href="#l76.64"></a><span id="l76.64">   box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek + 3, 4,</span>
<a href="#l76.65"></a><span id="l76.65">     undefined) + eventPath;</span>
<a href="#l76.66"></a><span id="l76.66">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l76.67"></a><span id="l76.67"> }</span>
<a href="#l76.68"></a><span id="l76.68"> </span>
<a href="#l76.69"></a><span id="l76.69"> var teardownTest = function(module) {</span>
<a href="#l76.70"></a><span id="l76.70">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l76.71"></a><span id="l76.71" class="difflineminus">-}</span>
<a href="#l76.72"></a><span id="l76.72" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l77.1"></a><span id="l77.1" class="difflineminus">--- a/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l77.2"></a><span id="l77.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrence/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l77.3"></a><span id="l77.3" class="difflineat">@@ -10,43 +10,43 @@ var sleep = 500;</span>
<a href="#l77.4"></a><span id="l77.4"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l77.5"></a><span id="l77.5"> var hour = 8;</span>
<a href="#l77.6"></a><span id="l77.6"> var startDate = new Date(2009, 0, 6);</span>
<a href="#l77.7"></a><span id="l77.7"> var eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l77.8"></a><span id="l77.8"> </span>
<a href="#l77.9"></a><span id="l77.9"> var setupModule = function(module) {</span>
<a href="#l77.10"></a><span id="l77.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l77.11"></a><span id="l77.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l77.12"></a><span id="l77.12" class="difflineminus">-}</span>
<a href="#l77.13"></a><span id="l77.13" class="difflineplus">+};</span>
<a href="#l77.14"></a><span id="l77.14"> </span>
<a href="#l77.15"></a><span id="l77.15"> var testWeeklyWithExceptionRecurrence = function() {</span>
<a href="#l77.16"></a><span id="l77.16">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l77.17"></a><span id="l77.17">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l77.18"></a><span id="l77.18">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l77.19"></a><span id="l77.19"> </span>
<a href="#l77.20"></a><span id="l77.20">   // create weekly recurring event</span>
<a href="#l77.21"></a><span id="l77.21">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l77.22"></a><span id="l77.22">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l77.23"></a><span id="l77.23" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l77.24"></a><span id="l77.24" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l77.25"></a><span id="l77.25">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l77.26"></a><span id="l77.26"> </span>
<a href="#l77.27"></a><span id="l77.27">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l77.28"></a><span id="l77.28">   md.start(setRecurrence);</span>
<a href="#l77.29"></a><span id="l77.29">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l77.30"></a><span id="l77.30">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l77.31"></a><span id="l77.31"> </span>
<a href="#l77.32"></a><span id="l77.32">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l77.33"></a><span id="l77.33" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l77.34"></a><span id="l77.34" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l77.35"></a><span id="l77.35"> </span>
<a href="#l77.36"></a><span id="l77.36">   // move 5th January occurrence to 6th January</span>
<a href="#l77.37"></a><span id="l77.37">   calUtils.handleOccurrenceModification(controller, false);</span>
<a href="#l77.38"></a><span id="l77.38">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l77.39"></a><span id="l77.39">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l77.40"></a><span id="l77.40">       + eventPath));</span>
<a href="#l77.41"></a><span id="l77.41" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l77.42"></a><span id="l77.42" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l77.43"></a><span id="l77.43">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l77.44"></a><span id="l77.44">   event.sleep(sleep);</span>
<a href="#l77.45"></a><span id="l77.45"> </span>
<a href="#l77.46"></a><span id="l77.46">   let startDateInput = new elementslib.Lookup(event.window.document, '/id(&quot;calendar-event-dialog&quot;)/'</span>
<a href="#l77.47"></a><span id="l77.47">     + 'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-startdate-row&quot;)/'</span>
<a href="#l77.48"></a><span id="l77.48">     + 'id(&quot;event-grid-startdate-picker-box&quot;)/id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/'</span>
<a href="#l77.49"></a><span id="l77.49">     + 'anon({&quot;anonid&quot;:&quot;date-picker&quot;})/anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/'</span>
<a href="#l77.50"></a><span id="l77.50">     + '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/'</span>
<a href="#l77.51"></a><span id="l77.51" class="difflineat">@@ -63,34 +63,34 @@ var testWeeklyWithExceptionRecurrence = </span>
<a href="#l77.52"></a><span id="l77.52">                      .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l77.53"></a><span id="l77.53">   let startDateString = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l77.54"></a><span id="l77.54">                                              startDate.getFullYear(), startDate.getMonth() + 1, startDate.getDate());</span>
<a href="#l77.55"></a><span id="l77.55">   event.type(startDateInput, startDateString);</span>
<a href="#l77.56"></a><span id="l77.56">   // applies startdate change</span>
<a href="#l77.57"></a><span id="l77.57">   event.click(endDateInput);</span>
<a href="#l77.58"></a><span id="l77.58"> </span>
<a href="#l77.59"></a><span id="l77.59">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l77.60"></a><span id="l77.60" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l77.61"></a><span id="l77.61" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l77.62"></a><span id="l77.62"> </span>
<a href="#l77.63"></a><span id="l77.63">   // change recurrence rule</span>
<a href="#l77.64"></a><span id="l77.64">   calUtils.goToDate(controller, 2009, 1, 7);</span>
<a href="#l77.65"></a><span id="l77.65">   calUtils.handleParentModification(controller, false);</span>
<a href="#l77.66"></a><span id="l77.66">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l77.67"></a><span id="l77.67">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l77.68"></a><span id="l77.68">       + eventPath));</span>
<a href="#l77.69"></a><span id="l77.69" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l77.70"></a><span id="l77.70" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l77.71"></a><span id="l77.71">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l77.72"></a><span id="l77.72"> </span>
<a href="#l77.73"></a><span id="l77.73">   md = new modalDialog.modalDialog(event.window);</span>
<a href="#l77.74"></a><span id="l77.74">   md.start(changeRecurrence);</span>
<a href="#l77.75"></a><span id="l77.75">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l77.76"></a><span id="l77.76">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l77.77"></a><span id="l77.77"> </span>
<a href="#l77.78"></a><span id="l77.78">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l77.79"></a><span id="l77.79" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l77.80"></a><span id="l77.80" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l77.81"></a><span id="l77.81"> </span>
<a href="#l77.82"></a><span id="l77.82">   // check two weeks</span>
<a href="#l77.83"></a><span id="l77.83">   // day view</span>
<a href="#l77.84"></a><span id="l77.84">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l77.85"></a><span id="l77.85">   let path = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l77.86"></a><span id="l77.86">     + eventPath;</span>
<a href="#l77.87"></a><span id="l77.87"> </span>
<a href="#l77.88"></a><span id="l77.88">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l77.89"></a><span id="l77.89" class="difflineat">@@ -195,17 +195,17 @@ var testWeeklyWithExceptionRecurrence = </span>
<a href="#l77.90"></a><span id="l77.90">   calUtils.goToDate(controller, 2009, 1, 12);</span>
<a href="#l77.91"></a><span id="l77.91">   path = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l77.92"></a><span id="l77.92">     + eventPath;</span>
<a href="#l77.93"></a><span id="l77.93">   controller.click(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l77.94"></a><span id="l77.94">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l77.95"></a><span id="l77.95">   controller.keypress(new elementslib.ID(controller.window.document, &quot;day-view&quot;),</span>
<a href="#l77.96"></a><span id="l77.96">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l77.97"></a><span id="l77.97">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l77.98"></a><span id="l77.98" class="difflineminus">-}</span>
<a href="#l77.99"></a><span id="l77.99" class="difflineplus">+};</span>
<a href="#l77.100"></a><span id="l77.100"> </span>
<a href="#l77.101"></a><span id="l77.101"> function setRecurrence(recurrence){</span>
<a href="#l77.102"></a><span id="l77.102">   // weekly</span>
<a href="#l77.103"></a><span id="l77.103">   recurrence.waitForElement(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;));</span>
<a href="#l77.104"></a><span id="l77.104">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined, undefined, &quot;1&quot;);</span>
<a href="#l77.105"></a><span id="l77.105">   recurrence.sleep(sleep);</span>
<a href="#l77.106"></a><span id="l77.106"> </span>
<a href="#l77.107"></a><span id="l77.107">   let mon = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.2.Mmm&quot;);</span>
<a href="#l77.108"></a><span id="l77.108" class="difflineat">@@ -251,17 +251,17 @@ function changeRecurrence(recurrence){</span>
<a href="#l77.109"></a><span id="l77.109">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + tue + '&quot;}'));</span>
<a href="#l77.110"></a><span id="l77.110"> </span>
<a href="#l77.111"></a><span id="l77.111">   // close dialog</span>
<a href="#l77.112"></a><span id="l77.112">   recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/'</span>
<a href="#l77.113"></a><span id="l77.113">     + 'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l77.114"></a><span id="l77.114"> }</span>
<a href="#l77.115"></a><span id="l77.115"> </span>
<a href="#l77.116"></a><span id="l77.116"> function checkMultiWeekView(view){</span>
<a href="#l77.117"></a><span id="l77.117" class="difflineminus">-  let startWeek = view == &quot;multiweek&quot; ? 1 : 2</span>
<a href="#l77.118"></a><span id="l77.118" class="difflineplus">+  let startWeek = view == &quot;multiweek&quot; ? 1 : 2;</span>
<a href="#l77.119"></a><span id="l77.119"> </span>
<a href="#l77.120"></a><span id="l77.120">   let path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 2, hour);</span>
<a href="#l77.121"></a><span id="l77.121">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l77.122"></a><span id="l77.122">   // assert exactly two</span>
<a href="#l77.123"></a><span id="l77.123">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 3, hour);</span>
<a href="#l77.124"></a><span id="l77.124">   controller.assertNode(new elementslib.Lookup(controller.window.document, path + '/[0]'));</span>
<a href="#l77.125"></a><span id="l77.125">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 3, hour);</span>
<a href="#l77.126"></a><span id="l77.126">   controller.assertNode(new elementslib.Lookup(controller.window.document, path + '/[1]'));</span>
<a href="#l77.127"></a><span id="l77.127" class="difflineat">@@ -289,9 +289,9 @@ function checkMultiWeekView(view){</span>
<a href="#l77.128"></a><span id="l77.128">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek + 1, 6, hour);</span>
<a href="#l77.129"></a><span id="l77.129">   controller.assertNode(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l77.130"></a><span id="l77.130">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek + 1, 7, hour);</span>
<a href="#l77.131"></a><span id="l77.131">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l77.132"></a><span id="l77.132"> }</span>
<a href="#l77.133"></a><span id="l77.133"> </span>
<a href="#l77.134"></a><span id="l77.134"> var teardownTest = function(module) {</span>
<a href="#l77.135"></a><span id="l77.135">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l77.136"></a><span id="l77.136" class="difflineminus">-}</span>
<a href="#l77.137"></a><span id="l77.137" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l78.1"></a><span id="l78.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js</span>
<a href="#l78.2"></a><span id="l78.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testAnnualRecurrence.js</span>
<a href="#l78.3"></a><span id="l78.3" class="difflineat">@@ -7,17 +7,17 @@ var calUtils = require(&quot;../shared-module</span>
<a href="#l78.4"></a><span id="l78.4"> var sleep = 500;</span>
<a href="#l78.5"></a><span id="l78.5"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l78.6"></a><span id="l78.6"> var startYear = 1950;</span>
<a href="#l78.7"></a><span id="l78.7"> var epoch = 1970;</span>
<a href="#l78.8"></a><span id="l78.8"> </span>
<a href="#l78.9"></a><span id="l78.9"> var setupModule = function(module) {</span>
<a href="#l78.10"></a><span id="l78.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l78.11"></a><span id="l78.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l78.12"></a><span id="l78.12" class="difflineminus">-}</span>
<a href="#l78.13"></a><span id="l78.13" class="difflineplus">+};</span>
<a href="#l78.14"></a><span id="l78.14"> </span>
<a href="#l78.15"></a><span id="l78.15"> var testAnnualRecurrence = function() {</span>
<a href="#l78.16"></a><span id="l78.16">   var eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l78.17"></a><span id="l78.17"> </span>
<a href="#l78.18"></a><span id="l78.18">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l78.19"></a><span id="l78.19">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l78.20"></a><span id="l78.20">   calUtils.goToDate(controller, startYear, 1, 1);</span>
<a href="#l78.21"></a><span id="l78.21"> </span>
<a href="#l78.22"></a><span id="l78.22" class="difflineat">@@ -26,17 +26,17 @@ var testAnnualRecurrence = function() {</span>
<a href="#l78.23"></a><span id="l78.23">   controller.waitFor(function() {</span>
<a href="#l78.24"></a><span id="l78.24">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l78.25"></a><span id="l78.25">     return view.orient == &quot;horizontal&quot;;</span>
<a href="#l78.26"></a><span id="l78.26">   });</span>
<a href="#l78.27"></a><span id="l78.27"> </span>
<a href="#l78.28"></a><span id="l78.28">   // create yearly recurring all-day event</span>
<a href="#l78.29"></a><span id="l78.29">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l78.30"></a><span id="l78.30">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.ALLDAY, undefined, 1, undefined)));</span>
<a href="#l78.31"></a><span id="l78.31" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l78.32"></a><span id="l78.32" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l78.33"></a><span id="l78.33">   let event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l78.34"></a><span id="l78.34">                  .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l78.35"></a><span id="l78.35">   event.sleep(sleep);</span>
<a href="#l78.36"></a><span id="l78.36">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined,</span>
<a href="#l78.37"></a><span id="l78.37">     &quot;yearly&quot;);</span>
<a href="#l78.38"></a><span id="l78.38">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l78.39"></a><span id="l78.39">   controller.sleep(sleep);</span>
<a href="#l78.40"></a><span id="l78.40"> </span>
<a href="#l78.41"></a><span id="l78.41" class="difflineat">@@ -84,13 +84,13 @@ var testAnnualRecurrence = function() {</span>
<a href="#l78.42"></a><span id="l78.42">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l78.43"></a><span id="l78.43"> </span>
<a href="#l78.44"></a><span id="l78.44">   // reset view</span>
<a href="#l78.45"></a><span id="l78.45">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l78.46"></a><span id="l78.46">   controller.waitFor(function() {</span>
<a href="#l78.47"></a><span id="l78.47">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l78.48"></a><span id="l78.48">     return view.orient == &quot;vertical&quot;;</span>
<a href="#l78.49"></a><span id="l78.49">   });</span>
<a href="#l78.50"></a><span id="l78.50" class="difflineminus">-}</span>
<a href="#l78.51"></a><span id="l78.51" class="difflineplus">+};</span>
<a href="#l78.52"></a><span id="l78.52"> </span>
<a href="#l78.53"></a><span id="l78.53"> var teardownTest = function(module) {</span>
<a href="#l78.54"></a><span id="l78.54">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l78.55"></a><span id="l78.55" class="difflineminus">-}</span>
<a href="#l78.56"></a><span id="l78.56" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l79.1"></a><span id="l79.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js</span>
<a href="#l79.2"></a><span id="l79.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testBiweeklyRecurrence.js</span>
<a href="#l79.3"></a><span id="l79.3" class="difflineat">@@ -6,17 +6,17 @@ var calUtils = require(&quot;../shared-module</span>
<a href="#l79.4"></a><span id="l79.4"> </span>
<a href="#l79.5"></a><span id="l79.5"> var sleep = 500;</span>
<a href="#l79.6"></a><span id="l79.6"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l79.7"></a><span id="l79.7"> var hour = 8;</span>
<a href="#l79.8"></a><span id="l79.8"> </span>
<a href="#l79.9"></a><span id="l79.9"> var setupModule = function(module) {</span>
<a href="#l79.10"></a><span id="l79.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l79.11"></a><span id="l79.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l79.12"></a><span id="l79.12" class="difflineminus">-}</span>
<a href="#l79.13"></a><span id="l79.13" class="difflineplus">+};</span>
<a href="#l79.14"></a><span id="l79.14"> </span>
<a href="#l79.15"></a><span id="l79.15"> var testBiweeklyRecurrence = function() {</span>
<a href="#l79.16"></a><span id="l79.16">   var eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l79.17"></a><span id="l79.17"> </span>
<a href="#l79.18"></a><span id="l79.18">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l79.19"></a><span id="l79.19">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l79.20"></a><span id="l79.20">   calUtils.goToDate(controller, 2009, 1, 31);</span>
<a href="#l79.21"></a><span id="l79.21"> </span>
<a href="#l79.22"></a><span id="l79.22" class="difflineat">@@ -25,23 +25,23 @@ var testBiweeklyRecurrence = function() </span>
<a href="#l79.23"></a><span id="l79.23">   controller.waitFor(function() {</span>
<a href="#l79.24"></a><span id="l79.24">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l79.25"></a><span id="l79.25">     return view.orient == &quot;horizontal&quot;;</span>
<a href="#l79.26"></a><span id="l79.26">   });</span>
<a href="#l79.27"></a><span id="l79.27"> </span>
<a href="#l79.28"></a><span id="l79.28">   // create biweekly event</span>
<a href="#l79.29"></a><span id="l79.29">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l79.30"></a><span id="l79.30">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l79.31"></a><span id="l79.31" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l79.32"></a><span id="l79.32" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l79.33"></a><span id="l79.33">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l79.34"></a><span id="l79.34"> </span>
<a href="#l79.35"></a><span id="l79.35">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l79.36"></a><span id="l79.36">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;bi.weekly&quot;);</span>
<a href="#l79.37"></a><span id="l79.37">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l79.38"></a><span id="l79.38" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l79.39"></a><span id="l79.39" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l79.40"></a><span id="l79.40"> </span>
<a href="#l79.41"></a><span id="l79.41">   let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l79.42"></a><span id="l79.42">     + eventPath;</span>
<a href="#l79.43"></a><span id="l79.43"> </span>
<a href="#l79.44"></a><span id="l79.44">   // check day view</span>
<a href="#l79.45"></a><span id="l79.45">   for (let i = 0; i &lt; 4; i++){</span>
<a href="#l79.46"></a><span id="l79.46">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l79.47"></a><span id="l79.47">     calUtils.forward(controller, 14);</span>
<a href="#l79.48"></a><span id="l79.48" class="difflineat">@@ -109,13 +109,13 @@ var testBiweeklyRecurrence = function() </span>
<a href="#l79.49"></a><span id="l79.49"> </span>
<a href="#l79.50"></a><span id="l79.50">   // reset view</span>
<a href="#l79.51"></a><span id="l79.51">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l79.52"></a><span id="l79.52">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l79.53"></a><span id="l79.53">   controller.waitFor(function() {</span>
<a href="#l79.54"></a><span id="l79.54">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l79.55"></a><span id="l79.55">     return view.orient == &quot;vertical&quot;;</span>
<a href="#l79.56"></a><span id="l79.56">   });</span>
<a href="#l79.57"></a><span id="l79.57" class="difflineminus">-}</span>
<a href="#l79.58"></a><span id="l79.58" class="difflineplus">+};</span>
<a href="#l79.59"></a><span id="l79.59"> </span>
<a href="#l79.60"></a><span id="l79.60"> var teardownTest = function(module) {</span>
<a href="#l79.61"></a><span id="l79.61">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l79.62"></a><span id="l79.62" class="difflineminus">-}</span>
<a href="#l79.63"></a><span id="l79.63" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l80.1"></a><span id="l80.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js</span>
<a href="#l80.2"></a><span id="l80.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testDailyRecurrence.js</span>
<a href="#l80.3"></a><span id="l80.3" class="difflineat">@@ -6,17 +6,17 @@ var calUtils = require(&quot;../shared-module</span>
<a href="#l80.4"></a><span id="l80.4"> </span>
<a href="#l80.5"></a><span id="l80.5"> var sleep = 500;</span>
<a href="#l80.6"></a><span id="l80.6"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l80.7"></a><span id="l80.7"> var hour = 8;</span>
<a href="#l80.8"></a><span id="l80.8"> </span>
<a href="#l80.9"></a><span id="l80.9"> var setupModule = function(module) {</span>
<a href="#l80.10"></a><span id="l80.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l80.11"></a><span id="l80.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l80.12"></a><span id="l80.12" class="difflineminus">-}</span>
<a href="#l80.13"></a><span id="l80.13" class="difflineplus">+};</span>
<a href="#l80.14"></a><span id="l80.14"> </span>
<a href="#l80.15"></a><span id="l80.15"> var testDailyRecurrence = function() {</span>
<a href="#l80.16"></a><span id="l80.16">   let eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l80.17"></a><span id="l80.17"> </span>
<a href="#l80.18"></a><span id="l80.18">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l80.19"></a><span id="l80.19">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l80.20"></a><span id="l80.20">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l80.21"></a><span id="l80.21"> </span>
<a href="#l80.22"></a><span id="l80.22" class="difflineat">@@ -25,17 +25,17 @@ var testDailyRecurrence = function() {</span>
<a href="#l80.23"></a><span id="l80.23">   controller.waitFor(function() {</span>
<a href="#l80.24"></a><span id="l80.24">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l80.25"></a><span id="l80.25">     return view.orient == &quot;horizontal&quot;;</span>
<a href="#l80.26"></a><span id="l80.26">   });</span>
<a href="#l80.27"></a><span id="l80.27"> </span>
<a href="#l80.28"></a><span id="l80.28">   // create daily event</span>
<a href="#l80.29"></a><span id="l80.29">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l80.30"></a><span id="l80.30">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l80.31"></a><span id="l80.31" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l80.32"></a><span id="l80.32" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l80.33"></a><span id="l80.33">   let event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l80.34"></a><span id="l80.34">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l80.35"></a><span id="l80.35"> </span>
<a href="#l80.36"></a><span id="l80.36">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l80.37"></a><span id="l80.37">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined,</span>
<a href="#l80.38"></a><span id="l80.38">     &quot;daily&quot;);</span>
<a href="#l80.39"></a><span id="l80.39">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l80.40"></a><span id="l80.40"> </span>
<a href="#l80.41"></a><span id="l80.41" class="difflineat">@@ -132,25 +132,25 @@ var testDailyRecurrence = function() {</span>
<a href="#l80.42"></a><span id="l80.42">   // go to previous day to edit event to occur only on weekdays</span>
<a href="#l80.43"></a><span id="l80.43">   calUtils.back(controller, 1);</span>
<a href="#l80.44"></a><span id="l80.44"> </span>
<a href="#l80.45"></a><span id="l80.45">   calUtils.handleParentModification(controller, false);</span>
<a href="#l80.46"></a><span id="l80.46">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l80.47"></a><span id="l80.47">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l80.48"></a><span id="l80.48">       + eventPath));</span>
<a href="#l80.49"></a><span id="l80.49"> </span>
<a href="#l80.50"></a><span id="l80.50" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l80.51"></a><span id="l80.51" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l80.52"></a><span id="l80.52">   event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l80.53"></a><span id="l80.53">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l80.54"></a><span id="l80.54"> </span>
<a href="#l80.55"></a><span id="l80.55">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l80.56"></a><span id="l80.56">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined,</span>
<a href="#l80.57"></a><span id="l80.57">     &quot;every.weekday&quot;);</span>
<a href="#l80.58"></a><span id="l80.58">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l80.59"></a><span id="l80.59" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l80.60"></a><span id="l80.60" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l80.61"></a><span id="l80.61"> </span>
<a href="#l80.62"></a><span id="l80.62">   // check day view for 7 days</span>
<a href="#l80.63"></a><span id="l80.63">   let day = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, undefined)</span>
<a href="#l80.64"></a><span id="l80.64">     + eventPath;</span>
<a href="#l80.65"></a><span id="l80.65">   var dates = [[2009, 1, 3],</span>
<a href="#l80.66"></a><span id="l80.66">                [2009, 1, 4]];</span>
<a href="#l80.67"></a><span id="l80.67">   for (let i = 0; i &lt; dates.length; i++){</span>
<a href="#l80.68"></a><span id="l80.68">     calUtils.goToDate(controller, dates[i][0], dates[i][1], dates[i][2]);</span>
<a href="#l80.69"></a><span id="l80.69" class="difflineat">@@ -194,27 +194,27 @@ var testDailyRecurrence = function() {</span>
<a href="#l80.70"></a><span id="l80.70">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, day));</span>
<a href="#l80.71"></a><span id="l80.71">     day = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, i, 7, undefined)</span>
<a href="#l80.72"></a><span id="l80.72">       + eventPath;</span>
<a href="#l80.73"></a><span id="l80.73">     controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, day));</span>
<a href="#l80.74"></a><span id="l80.74">   }</span>
<a href="#l80.75"></a><span id="l80.75"> </span>
<a href="#l80.76"></a><span id="l80.76">   // delete event</span>
<a href="#l80.77"></a><span id="l80.77">   day = calUtils.getEventBoxPath(controller, &quot;month&quot;, calUtils.EVENT_BOX, 1, 5, undefined)</span>
<a href="#l80.78"></a><span id="l80.78" class="difflineminus">-    + eventPath</span>
<a href="#l80.79"></a><span id="l80.79" class="difflineplus">+    + eventPath;</span>
<a href="#l80.80"></a><span id="l80.80">   controller.click(new elementslib.Lookup(controller.window.document, day));</span>
<a href="#l80.81"></a><span id="l80.81">   calUtils.handleParentDeletion(controller, false);</span>
<a href="#l80.82"></a><span id="l80.82">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l80.83"></a><span id="l80.83">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l80.84"></a><span id="l80.84">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, day));</span>
<a href="#l80.85"></a><span id="l80.85"> </span>
<a href="#l80.86"></a><span id="l80.86">   // reset view</span>
<a href="#l80.87"></a><span id="l80.87">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l80.88"></a><span id="l80.88">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l80.89"></a><span id="l80.89">   controller.waitFor(function() {</span>
<a href="#l80.90"></a><span id="l80.90">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l80.91"></a><span id="l80.91">     return view.orient == &quot;vertical&quot;;</span>
<a href="#l80.92"></a><span id="l80.92">   });</span>
<a href="#l80.93"></a><span id="l80.93" class="difflineminus">-}</span>
<a href="#l80.94"></a><span id="l80.94" class="difflineplus">+};</span>
<a href="#l80.95"></a><span id="l80.95"> </span>
<a href="#l80.96"></a><span id="l80.96"> var teardownTest = function(module) {</span>
<a href="#l80.97"></a><span id="l80.97">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l80.98"></a><span id="l80.98" class="difflineminus">-}</span>
<a href="#l80.99"></a><span id="l80.99" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l81.1"></a><span id="l81.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js</span>
<a href="#l81.2"></a><span id="l81.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testLastDayOfMonthRecurrence.js</span>
<a href="#l81.3"></a><span id="l81.3" class="difflineat">@@ -7,17 +7,17 @@ var modalDialog = require(&quot;../shared-mod</span>
<a href="#l81.4"></a><span id="l81.4"> </span>
<a href="#l81.5"></a><span id="l81.5"> var sleep = 500;</span>
<a href="#l81.6"></a><span id="l81.6"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l81.7"></a><span id="l81.7"> var hour = 8;</span>
<a href="#l81.8"></a><span id="l81.8"> </span>
<a href="#l81.9"></a><span id="l81.9"> var setupModule = function(module) {</span>
<a href="#l81.10"></a><span id="l81.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l81.11"></a><span id="l81.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l81.12"></a><span id="l81.12" class="difflineminus">-}</span>
<a href="#l81.13"></a><span id="l81.13" class="difflineplus">+};</span>
<a href="#l81.14"></a><span id="l81.14"> </span>
<a href="#l81.15"></a><span id="l81.15"> var testLastDayOfMonthRecurrence = function() {</span>
<a href="#l81.16"></a><span id="l81.16">   var eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l81.17"></a><span id="l81.17">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l81.18"></a><span id="l81.18">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l81.19"></a><span id="l81.19">   calUtils.goToDate(controller, 2008, 1, 31); // start with a leap year</span>
<a href="#l81.20"></a><span id="l81.20"> </span>
<a href="#l81.21"></a><span id="l81.21">   // rotate view</span>
<a href="#l81.22"></a><span id="l81.22" class="difflineat">@@ -25,28 +25,28 @@ var testLastDayOfMonthRecurrence = funct</span>
<a href="#l81.23"></a><span id="l81.23">   controller.waitFor(function() {</span>
<a href="#l81.24"></a><span id="l81.24">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l81.25"></a><span id="l81.25">     return view.orient == &quot;horizontal&quot;;</span>
<a href="#l81.26"></a><span id="l81.26">   });</span>
<a href="#l81.27"></a><span id="l81.27"> </span>
<a href="#l81.28"></a><span id="l81.28">   // create monthly recurring event</span>
<a href="#l81.29"></a><span id="l81.29">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l81.30"></a><span id="l81.30">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l81.31"></a><span id="l81.31" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l81.32"></a><span id="l81.32" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l81.33"></a><span id="l81.33">   let event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l81.34"></a><span id="l81.34">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l81.35"></a><span id="l81.35"> </span>
<a href="#l81.36"></a><span id="l81.36">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l81.37"></a><span id="l81.37">   md.start(setRecurrence);</span>
<a href="#l81.38"></a><span id="l81.38">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l81.39"></a><span id="l81.39">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined,</span>
<a href="#l81.40"></a><span id="l81.40">     &quot;custom&quot;);</span>
<a href="#l81.41"></a><span id="l81.41"> </span>
<a href="#l81.42"></a><span id="l81.42">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l81.43"></a><span id="l81.43" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l81.44"></a><span id="l81.44" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l81.45"></a><span id="l81.45"> </span>
<a href="#l81.46"></a><span id="l81.46">   //                      date      correct row in month view</span>
<a href="#l81.47"></a><span id="l81.47">   //                   vvvvvvvvvvv  v</span>
<a href="#l81.48"></a><span id="l81.48">   let checkingData = [[2008, 1, 31, 5],</span>
<a href="#l81.49"></a><span id="l81.49">                       [2008, 2, 29, 5],</span>
<a href="#l81.50"></a><span id="l81.50">                       [2008, 3, 31, 6],</span>
<a href="#l81.51"></a><span id="l81.51">                       [2008, 4, 30, 5],</span>
<a href="#l81.52"></a><span id="l81.52">                       [2008, 5, 31, 5],</span>
<a href="#l81.53"></a><span id="l81.53" class="difflineat">@@ -105,17 +105,17 @@ var testLastDayOfMonthRecurrence = funct</span>
<a href="#l81.54"></a><span id="l81.54">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l81.55"></a><span id="l81.55"> </span>
<a href="#l81.56"></a><span id="l81.56">   // reset view</span>
<a href="#l81.57"></a><span id="l81.57">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l81.58"></a><span id="l81.58">   controller.waitFor(function() {</span>
<a href="#l81.59"></a><span id="l81.59">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l81.60"></a><span id="l81.60">     return view.orient == &quot;vertical&quot;;</span>
<a href="#l81.61"></a><span id="l81.61">   });</span>
<a href="#l81.62"></a><span id="l81.62" class="difflineminus">-}</span>
<a href="#l81.63"></a><span id="l81.63" class="difflineplus">+};</span>
<a href="#l81.64"></a><span id="l81.64"> </span>
<a href="#l81.65"></a><span id="l81.65"> function setRecurrence(recurrence){</span>
<a href="#l81.66"></a><span id="l81.66">   recurrence.sleep(sleep);</span>
<a href="#l81.67"></a><span id="l81.67"> </span>
<a href="#l81.68"></a><span id="l81.68">   // monthly</span>
<a href="#l81.69"></a><span id="l81.69">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined,</span>
<a href="#l81.70"></a><span id="l81.70">     undefined, &quot;2&quot;);</span>
<a href="#l81.71"></a><span id="l81.71"> </span>
<a href="#l81.72"></a><span id="l81.72" class="difflineat">@@ -131,9 +131,9 @@ function setRecurrence(recurrence){</span>
<a href="#l81.73"></a><span id="l81.73"> </span>
<a href="#l81.74"></a><span id="l81.74">   // close dialog</span>
<a href="#l81.75"></a><span id="l81.75">   recurrence.click(new elementslib.Lookup(recurrence.window.document,</span>
<a href="#l81.76"></a><span id="l81.76">     '/id(&quot;calendar-event-dialog-recurrence&quot;)/anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l81.77"></a><span id="l81.77"> }</span>
<a href="#l81.78"></a><span id="l81.78"> </span>
<a href="#l81.79"></a><span id="l81.79"> var teardownTest = function(module) {</span>
<a href="#l81.80"></a><span id="l81.80">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l81.81"></a><span id="l81.81" class="difflineminus">-}</span>
<a href="#l81.82"></a><span id="l81.82" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l82.1"></a><span id="l82.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js</span>
<a href="#l82.2"></a><span id="l82.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyNRecurrence.js</span>
<a href="#l82.3"></a><span id="l82.3" class="difflineat">@@ -9,34 +9,34 @@ var utils = require(&quot;../shared-modules/u</span>
<a href="#l82.4"></a><span id="l82.4"> var sleep = 500;</span>
<a href="#l82.5"></a><span id="l82.5"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l82.6"></a><span id="l82.6"> var hour = 8;</span>
<a href="#l82.7"></a><span id="l82.7"> var eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l82.8"></a><span id="l82.8"> </span>
<a href="#l82.9"></a><span id="l82.9"> var setupModule = function(module) {</span>
<a href="#l82.10"></a><span id="l82.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l82.11"></a><span id="l82.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l82.12"></a><span id="l82.12" class="difflineminus">-}</span>
<a href="#l82.13"></a><span id="l82.13" class="difflineplus">+};</span>
<a href="#l82.14"></a><span id="l82.14"> </span>
<a href="#l82.15"></a><span id="l82.15"> var testWeeklyNRecurrence = function() {</span>
<a href="#l82.16"></a><span id="l82.16">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l82.17"></a><span id="l82.17">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l82.18"></a><span id="l82.18">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l82.19"></a><span id="l82.19"> </span>
<a href="#l82.20"></a><span id="l82.20">   // rotate view</span>
<a href="#l82.21"></a><span id="l82.21">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l82.22"></a><span id="l82.22">   controller.waitFor(function() {</span>
<a href="#l82.23"></a><span id="l82.23">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l82.24"></a><span id="l82.24">     return view.orient == &quot;horizontal&quot;;</span>
<a href="#l82.25"></a><span id="l82.25">   });</span>
<a href="#l82.26"></a><span id="l82.26"> </span>
<a href="#l82.27"></a><span id="l82.27">   // create weekly recurring event</span>
<a href="#l82.28"></a><span id="l82.28">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l82.29"></a><span id="l82.29">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l82.30"></a><span id="l82.30" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l82.31"></a><span id="l82.31" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l82.32"></a><span id="l82.32">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l82.33"></a><span id="l82.33"> </span>
<a href="#l82.34"></a><span id="l82.34">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l82.35"></a><span id="l82.35">   md.start(setRecurrence);</span>
<a href="#l82.36"></a><span id="l82.36">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l82.37"></a><span id="l82.37">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l82.38"></a><span id="l82.38"> </span>
<a href="#l82.39"></a><span id="l82.39">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l82.40"></a><span id="l82.40" class="difflineat">@@ -89,17 +89,17 @@ var testWeeklyNRecurrence = function() {</span>
<a href="#l82.41"></a><span id="l82.41"> </span>
<a href="#l82.42"></a><span id="l82.42">   // reset view</span>
<a href="#l82.43"></a><span id="l82.43">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l82.44"></a><span id="l82.44">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l82.45"></a><span id="l82.45">   controller.waitFor(function() {</span>
<a href="#l82.46"></a><span id="l82.46">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l82.47"></a><span id="l82.47">     return view.orient == &quot;vertical&quot;;</span>
<a href="#l82.48"></a><span id="l82.48">   });</span>
<a href="#l82.49"></a><span id="l82.49" class="difflineminus">-}</span>
<a href="#l82.50"></a><span id="l82.50" class="difflineplus">+};</span>
<a href="#l82.51"></a><span id="l82.51"> </span>
<a href="#l82.52"></a><span id="l82.52"> function setRecurrence(recurrence){</span>
<a href="#l82.53"></a><span id="l82.53">   // weekly</span>
<a href="#l82.54"></a><span id="l82.54">   recurrence.waitForElement(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;));</span>
<a href="#l82.55"></a><span id="l82.55">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined, undefined, &quot;1&quot;);</span>
<a href="#l82.56"></a><span id="l82.56">   recurrence.sleep(sleep);</span>
<a href="#l82.57"></a><span id="l82.57"> </span>
<a href="#l82.58"></a><span id="l82.58">   let mon = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.2.Mmm&quot;);</span>
<a href="#l82.59"></a><span id="l82.59" class="difflineat">@@ -152,9 +152,9 @@ function checkMultiWeekView(view){</span>
<a href="#l82.60"></a><span id="l82.60">   // Saturday</span>
<a href="#l82.61"></a><span id="l82.61">   let box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, week, 7, undefined)</span>
<a href="#l82.62"></a><span id="l82.62">     + eventPath;</span>
<a href="#l82.63"></a><span id="l82.63">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l82.64"></a><span id="l82.64"> }</span>
<a href="#l82.65"></a><span id="l82.65"> </span>
<a href="#l82.66"></a><span id="l82.66"> var teardownTest = function(module) {</span>
<a href="#l82.67"></a><span id="l82.67">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l82.68"></a><span id="l82.68" class="difflineminus">-}</span>
<a href="#l82.69"></a><span id="l82.69" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l83.1"></a><span id="l83.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js</span>
<a href="#l83.2"></a><span id="l83.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyUntilRecurrence.js</span>
<a href="#l83.3"></a><span id="l83.3" class="difflineat">@@ -10,43 +10,43 @@ var sleep = 500;</span>
<a href="#l83.4"></a><span id="l83.4"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l83.5"></a><span id="l83.5"> var endDate = new Date(2009, 0, 26); // last Monday in month</span>
<a href="#l83.6"></a><span id="l83.6"> var hour = 8;</span>
<a href="#l83.7"></a><span id="l83.7"> var eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l83.8"></a><span id="l83.8"> </span>
<a href="#l83.9"></a><span id="l83.9"> var setupModule = function(module) {</span>
<a href="#l83.10"></a><span id="l83.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l83.11"></a><span id="l83.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l83.12"></a><span id="l83.12" class="difflineminus">-}</span>
<a href="#l83.13"></a><span id="l83.13" class="difflineplus">+};</span>
<a href="#l83.14"></a><span id="l83.14"> </span>
<a href="#l83.15"></a><span id="l83.15"> var testWeeklyUntilRecurrence = function() {</span>
<a href="#l83.16"></a><span id="l83.16">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l83.17"></a><span id="l83.17">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l83.18"></a><span id="l83.18">   calUtils.goToDate(controller, 2009, 1, 5); // Monday</span>
<a href="#l83.19"></a><span id="l83.19"> </span>
<a href="#l83.20"></a><span id="l83.20">   // rotate view</span>
<a href="#l83.21"></a><span id="l83.21">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l83.22"></a><span id="l83.22">   controller.waitFor(function() {</span>
<a href="#l83.23"></a><span id="l83.23">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l83.24"></a><span id="l83.24">     return view.orient == &quot;horizontal&quot;;</span>
<a href="#l83.25"></a><span id="l83.25">   });</span>
<a href="#l83.26"></a><span id="l83.26"> </span>
<a href="#l83.27"></a><span id="l83.27">   // create weekly recurring event</span>
<a href="#l83.28"></a><span id="l83.28">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l83.29"></a><span id="l83.29">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l83.30"></a><span id="l83.30" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l83.31"></a><span id="l83.31" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l83.32"></a><span id="l83.32">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l83.33"></a><span id="l83.33"> </span>
<a href="#l83.34"></a><span id="l83.34">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l83.35"></a><span id="l83.35">   md.start(setRecurrence);</span>
<a href="#l83.36"></a><span id="l83.36">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l83.37"></a><span id="l83.37">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l83.38"></a><span id="l83.38"> </span>
<a href="#l83.39"></a><span id="l83.39">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l83.40"></a><span id="l83.40" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l83.41"></a><span id="l83.41" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l83.42"></a><span id="l83.42"> </span>
<a href="#l83.43"></a><span id="l83.43">   let box = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l83.44"></a><span id="l83.44">     + eventPath;</span>
<a href="#l83.45"></a><span id="l83.45"> </span>
<a href="#l83.46"></a><span id="l83.46">   // check day view</span>
<a href="#l83.47"></a><span id="l83.47">   for (let week = 0; week &lt; 3; week++){</span>
<a href="#l83.48"></a><span id="l83.48">     // Monday</span>
<a href="#l83.49"></a><span id="l83.49">     controller.assertNode(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l83.50"></a><span id="l83.50" class="difflineat">@@ -116,17 +116,17 @@ var testWeeklyUntilRecurrence = function</span>
<a href="#l83.51"></a><span id="l83.51"> </span>
<a href="#l83.52"></a><span id="l83.52">   // reset view</span>
<a href="#l83.53"></a><span id="l83.53">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l83.54"></a><span id="l83.54">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l83.55"></a><span id="l83.55">   controller.waitFor(function() {</span>
<a href="#l83.56"></a><span id="l83.56">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l83.57"></a><span id="l83.57">     return view.orient == &quot;vertical&quot;;</span>
<a href="#l83.58"></a><span id="l83.58">   });</span>
<a href="#l83.59"></a><span id="l83.59" class="difflineminus">-}</span>
<a href="#l83.60"></a><span id="l83.60" class="difflineplus">+};</span>
<a href="#l83.61"></a><span id="l83.61"> </span>
<a href="#l83.62"></a><span id="l83.62"> function setRecurrence(recurrence){</span>
<a href="#l83.63"></a><span id="l83.63">   // weekly</span>
<a href="#l83.64"></a><span id="l83.64">   recurrence.waitForElement(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;));</span>
<a href="#l83.65"></a><span id="l83.65">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined, undefined, &quot;1&quot;);</span>
<a href="#l83.66"></a><span id="l83.66">   recurrence.sleep(sleep);</span>
<a href="#l83.67"></a><span id="l83.67"> </span>
<a href="#l83.68"></a><span id="l83.68">   let mon = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.2.Mmm&quot;);</span>
<a href="#l83.69"></a><span id="l83.69" class="difflineat">@@ -195,9 +195,9 @@ function checkMultiWeekView(view){</span>
<a href="#l83.70"></a><span id="l83.70">   // Wednesday</span>
<a href="#l83.71"></a><span id="l83.71">   box = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek + 3, 4,</span>
<a href="#l83.72"></a><span id="l83.72">     undefined) + eventPath;</span>
<a href="#l83.73"></a><span id="l83.73">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, box));</span>
<a href="#l83.74"></a><span id="l83.74"> }</span>
<a href="#l83.75"></a><span id="l83.75"> </span>
<a href="#l83.76"></a><span id="l83.76"> var teardownTest = function(module) {</span>
<a href="#l83.77"></a><span id="l83.77">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l83.78"></a><span id="l83.78" class="difflineminus">-}</span>
<a href="#l83.79"></a><span id="l83.79" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l84.1"></a><span id="l84.1" class="difflineminus">--- a/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l84.2"></a><span id="l84.2" class="difflineplus">+++ b/calendar/test/mozmill/recurrenceRotated/testWeeklyWithExceptionRecurrence.js</span>
<a href="#l84.3"></a><span id="l84.3" class="difflineat">@@ -10,49 +10,49 @@ var sleep = 500;</span>
<a href="#l84.4"></a><span id="l84.4"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l84.5"></a><span id="l84.5"> var hour = 8;</span>
<a href="#l84.6"></a><span id="l84.6"> var startDate = new Date(2009, 0, 6);</span>
<a href="#l84.7"></a><span id="l84.7"> var eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l84.8"></a><span id="l84.8"> </span>
<a href="#l84.9"></a><span id="l84.9"> var setupModule = function(module) {</span>
<a href="#l84.10"></a><span id="l84.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l84.11"></a><span id="l84.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l84.12"></a><span id="l84.12" class="difflineminus">-}</span>
<a href="#l84.13"></a><span id="l84.13" class="difflineplus">+};</span>
<a href="#l84.14"></a><span id="l84.14"> </span>
<a href="#l84.15"></a><span id="l84.15"> var testWeeklyWithExceptionRecurrence = function() {</span>
<a href="#l84.16"></a><span id="l84.16">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l84.17"></a><span id="l84.17">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l84.18"></a><span id="l84.18">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l84.19"></a><span id="l84.19"> </span>
<a href="#l84.20"></a><span id="l84.20">   // rotate view</span>
<a href="#l84.21"></a><span id="l84.21">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l84.22"></a><span id="l84.22">   controller.waitFor(function() {</span>
<a href="#l84.23"></a><span id="l84.23">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l84.24"></a><span id="l84.24">     return view.orient == &quot;horizontal&quot;;</span>
<a href="#l84.25"></a><span id="l84.25">   });</span>
<a href="#l84.26"></a><span id="l84.26"> </span>
<a href="#l84.27"></a><span id="l84.27">   // create weekly recurring event</span>
<a href="#l84.28"></a><span id="l84.28">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l84.29"></a><span id="l84.29">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l84.30"></a><span id="l84.30" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l84.31"></a><span id="l84.31" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l84.32"></a><span id="l84.32">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l84.33"></a><span id="l84.33"> </span>
<a href="#l84.34"></a><span id="l84.34">   let md = new modalDialog.modalDialog(event.window);</span>
<a href="#l84.35"></a><span id="l84.35">   md.start(setRecurrence);</span>
<a href="#l84.36"></a><span id="l84.36">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l84.37"></a><span id="l84.37">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l84.38"></a><span id="l84.38"> </span>
<a href="#l84.39"></a><span id="l84.39">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l84.40"></a><span id="l84.40"> </span>
<a href="#l84.41"></a><span id="l84.41">   // move 5th January occurrence to 6th January</span>
<a href="#l84.42"></a><span id="l84.42">   calUtils.handleOccurrenceModification(controller, false);</span>
<a href="#l84.43"></a><span id="l84.43">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l84.44"></a><span id="l84.44">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l84.45"></a><span id="l84.45">       + eventPath));</span>
<a href="#l84.46"></a><span id="l84.46" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l84.47"></a><span id="l84.47" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l84.48"></a><span id="l84.48">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l84.49"></a><span id="l84.49">   event.sleep(sleep);</span>
<a href="#l84.50"></a><span id="l84.50"> </span>
<a href="#l84.51"></a><span id="l84.51">   let startDateInput = new elementslib.Lookup(event.window.document, '/id(&quot;calendar-event-dialog&quot;)/'</span>
<a href="#l84.52"></a><span id="l84.52">     + 'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-startdate-row&quot;)/'</span>
<a href="#l84.53"></a><span id="l84.53">     + 'id(&quot;event-grid-startdate-picker-box&quot;)/id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/'</span>
<a href="#l84.54"></a><span id="l84.54">     + 'anon({&quot;anonid&quot;:&quot;date-picker&quot;})/anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/'</span>
<a href="#l84.55"></a><span id="l84.55">     + '{&quot;class&quot;:&quot;datepicker-text-class&quot;}/anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/'</span>
<a href="#l84.56"></a><span id="l84.56" class="difflineat">@@ -69,34 +69,34 @@ var testWeeklyWithExceptionRecurrence = </span>
<a href="#l84.57"></a><span id="l84.57">                      .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l84.58"></a><span id="l84.58">   let startDateString = dateService.FormatDate(&quot;&quot;, dateService.dateFormatShort,</span>
<a href="#l84.59"></a><span id="l84.59">                                              startDate.getFullYear(), startDate.getMonth() + 1, startDate.getDate());</span>
<a href="#l84.60"></a><span id="l84.60">   event.type(startDateInput, startDateString);</span>
<a href="#l84.61"></a><span id="l84.61">   // applies startdate change</span>
<a href="#l84.62"></a><span id="l84.62">   event.click(endDateInput);</span>
<a href="#l84.63"></a><span id="l84.63"> </span>
<a href="#l84.64"></a><span id="l84.64">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l84.65"></a><span id="l84.65" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l84.66"></a><span id="l84.66" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l84.67"></a><span id="l84.67"> </span>
<a href="#l84.68"></a><span id="l84.68">   // change recurrence rule</span>
<a href="#l84.69"></a><span id="l84.69">   calUtils.goToDate(controller, 2009, 1, 7);</span>
<a href="#l84.70"></a><span id="l84.70">   calUtils.handleParentModification(controller, false);</span>
<a href="#l84.71"></a><span id="l84.71">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l84.72"></a><span id="l84.72">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l84.73"></a><span id="l84.73">       + eventPath));</span>
<a href="#l84.74"></a><span id="l84.74" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l84.75"></a><span id="l84.75" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l84.76"></a><span id="l84.76">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l84.77"></a><span id="l84.77"> </span>
<a href="#l84.78"></a><span id="l84.78">   md = new modalDialog.modalDialog(event.window);</span>
<a href="#l84.79"></a><span id="l84.79">   md.start(changeRecurrence);</span>
<a href="#l84.80"></a><span id="l84.80">   event.waitForElement(new elementslib.ID(event.window.document, &quot;item-repeat&quot;));</span>
<a href="#l84.81"></a><span id="l84.81">   event.select(new elementslib.ID(event.window.document, &quot;item-repeat&quot;), undefined, undefined, &quot;custom&quot;);</span>
<a href="#l84.82"></a><span id="l84.82"> </span>
<a href="#l84.83"></a><span id="l84.83">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l84.84"></a><span id="l84.84" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l84.85"></a><span id="l84.85" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l84.86"></a><span id="l84.86"> </span>
<a href="#l84.87"></a><span id="l84.87">   // check two weeks</span>
<a href="#l84.88"></a><span id="l84.88">   // day view</span>
<a href="#l84.89"></a><span id="l84.89">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l84.90"></a><span id="l84.90">   let path = calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.EVENT_BOX, undefined, 1, hour)</span>
<a href="#l84.91"></a><span id="l84.91">     + eventPath;</span>
<a href="#l84.92"></a><span id="l84.92"> </span>
<a href="#l84.93"></a><span id="l84.93">   calUtils.goToDate(controller, 2009, 1, 5);</span>
<a href="#l84.94"></a><span id="l84.94" class="difflineat">@@ -208,17 +208,17 @@ var testWeeklyWithExceptionRecurrence = </span>
<a href="#l84.95"></a><span id="l84.95">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, path));</span>
<a href="#l84.96"></a><span id="l84.96"> </span>
<a href="#l84.97"></a><span id="l84.97">   // reset view</span>
<a href="#l84.98"></a><span id="l84.98">   controller.mainMenu.click(&quot;#ltnViewRotated&quot;);</span>
<a href="#l84.99"></a><span id="l84.99">   controller.waitFor(function() {</span>
<a href="#l84.100"></a><span id="l84.100">     let view = (new elementslib.ID(controller.window.document, &quot;day-view&quot;)).getNode();</span>
<a href="#l84.101"></a><span id="l84.101">     return view.orient == &quot;vertical&quot;;</span>
<a href="#l84.102"></a><span id="l84.102">   });</span>
<a href="#l84.103"></a><span id="l84.103" class="difflineminus">-}</span>
<a href="#l84.104"></a><span id="l84.104" class="difflineplus">+};</span>
<a href="#l84.105"></a><span id="l84.105"> </span>
<a href="#l84.106"></a><span id="l84.106"> function setRecurrence(recurrence){</span>
<a href="#l84.107"></a><span id="l84.107">   // weekly</span>
<a href="#l84.108"></a><span id="l84.108">   recurrence.waitForElement(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;));</span>
<a href="#l84.109"></a><span id="l84.109">   recurrence.select(new elementslib.ID(recurrence.window.document, &quot;period-list&quot;), undefined, undefined, &quot;1&quot;);</span>
<a href="#l84.110"></a><span id="l84.110">   recurrence.sleep(sleep);</span>
<a href="#l84.111"></a><span id="l84.111"> </span>
<a href="#l84.112"></a><span id="l84.112">   let mon = utils.getProperty(&quot;chrome://calendar/locale/dateFormat.properties&quot;, &quot;day.2.Mmm&quot;);</span>
<a href="#l84.113"></a><span id="l84.113" class="difflineat">@@ -264,17 +264,17 @@ function changeRecurrence(recurrence){</span>
<a href="#l84.114"></a><span id="l84.114">   recurrence.click(new elementslib.Lookup(recurrence.window.document, days + '{&quot;label&quot;:&quot;' + tue + '&quot;}'));</span>
<a href="#l84.115"></a><span id="l84.115"> </span>
<a href="#l84.116"></a><span id="l84.116">   // close dialog</span>
<a href="#l84.117"></a><span id="l84.117">   recurrence.click(new elementslib.Lookup(recurrence.window.document, '/id(&quot;calendar-event-dialog-recurrence&quot;)/'</span>
<a href="#l84.118"></a><span id="l84.118">     + 'anon({&quot;anonid&quot;:&quot;buttons&quot;})/{&quot;dlgtype&quot;:&quot;accept&quot;}'));</span>
<a href="#l84.119"></a><span id="l84.119"> }</span>
<a href="#l84.120"></a><span id="l84.120"> </span>
<a href="#l84.121"></a><span id="l84.121"> function checkMultiWeekView(view){</span>
<a href="#l84.122"></a><span id="l84.122" class="difflineminus">-  let startWeek = view == &quot;multiweek&quot; ? 1 : 2</span>
<a href="#l84.123"></a><span id="l84.123" class="difflineplus">+  let startWeek = view == &quot;multiweek&quot; ? 1 : 2;</span>
<a href="#l84.124"></a><span id="l84.124"> </span>
<a href="#l84.125"></a><span id="l84.125">   let path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 2, hour);</span>
<a href="#l84.126"></a><span id="l84.126">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l84.127"></a><span id="l84.127">   // assert exactly two</span>
<a href="#l84.128"></a><span id="l84.128">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 3, hour);</span>
<a href="#l84.129"></a><span id="l84.129">   controller.assertNode(new elementslib.Lookup(controller.window.document, path + '/[0]'));</span>
<a href="#l84.130"></a><span id="l84.130">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek, 3, hour);</span>
<a href="#l84.131"></a><span id="l84.131">   controller.assertNode(new elementslib.Lookup(controller.window.document, path + '/[1]'));</span>
<a href="#l84.132"></a><span id="l84.132" class="difflineat">@@ -302,9 +302,9 @@ function checkMultiWeekView(view){</span>
<a href="#l84.133"></a><span id="l84.133">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek + 1, 6, hour);</span>
<a href="#l84.134"></a><span id="l84.134">   controller.assertNode(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l84.135"></a><span id="l84.135">   path = calUtils.getEventBoxPath(controller, view, calUtils.EVENT_BOX, startWeek + 1, 7, hour);</span>
<a href="#l84.136"></a><span id="l84.136">   controller.assertNodeNotExist(new elementslib.Lookup(controller.window.document, path + eventPath));</span>
<a href="#l84.137"></a><span id="l84.137"> }</span>
<a href="#l84.138"></a><span id="l84.138"> </span>
<a href="#l84.139"></a><span id="l84.139"> var teardownTest = function(module) {</span>
<a href="#l84.140"></a><span id="l84.140">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l84.141"></a><span id="l84.141" class="difflineminus">-}</span>
<a href="#l84.142"></a><span id="l84.142" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l85.1"></a><span id="l85.1" class="difflineminus">--- a/calendar/test/mozmill/shared-modules/calendar-utils.js</span>
<a href="#l85.2"></a><span id="l85.2" class="difflineplus">+++ b/calendar/test/mozmill/shared-modules/calendar-utils.js</span>
<a href="#l85.3"></a><span id="l85.3" class="difflineat">@@ -394,17 +394,17 @@ function setData(controller, data) {</span>
<a href="#l85.4"></a><span id="l85.4">     dialog = taskDialog;</span>
<a href="#l85.5"></a><span id="l85.5">     isEvent = false;</span>
<a href="#l85.6"></a><span id="l85.6">   }</span>
<a href="#l85.7"></a><span id="l85.7"> </span>
<a href="#l85.8"></a><span id="l85.8">   let dateInput = 'anon({&quot;class&quot;:&quot;datepicker-box-class&quot;})/{&quot;class&quot;:&quot;datepicker-text-class&quot;}/'</span>
<a href="#l85.9"></a><span id="l85.9">     + 'anon({&quot;class&quot;:&quot;menulist-editable-box textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l85.10"></a><span id="l85.10">   let timeInput = 'anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/'</span>
<a href="#l85.11"></a><span id="l85.11">     + 'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/'</span>
<a href="#l85.12"></a><span id="l85.12" class="difflineminus">-    + 'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'</span>
<a href="#l85.13"></a><span id="l85.13" class="difflineplus">+    + 'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})';</span>
<a href="#l85.14"></a><span id="l85.14">   let startDateInput = new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l85.15"></a><span id="l85.15">     + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l85.16"></a><span id="l85.16">     + (isEvent ? 'id(&quot;event-starttime&quot;)/' : 'id(&quot;todo-entrydate&quot;)/')</span>
<a href="#l85.17"></a><span id="l85.17">     + 'anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/' + dateInput);</span>
<a href="#l85.18"></a><span id="l85.18">   let endDateInput = new elementslib.Lookup(controller.window.document, dialog</span>
<a href="#l85.19"></a><span id="l85.19">     + 'id(&quot;event-grid-enddate-row&quot;)/[1]/id(&quot;event-grid-enddate-picker-box&quot;)/'</span>
<a href="#l85.20"></a><span id="l85.20">     + (isEvent ? 'id(&quot;event-endtime&quot;)/' : 'id(&quot;todo-duedate&quot;)/')</span>
<a href="#l85.21"></a><span id="l85.21">     + 'anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;date-picker&quot;})/' + dateInput);</span>
<a href="#l85.22"></a><span id="l85.22" class="difflineat">@@ -640,25 +640,25 @@ function setData(controller, data) {</span>
<a href="#l85.23"></a><span id="l85.23"> function open_lightning_prefs(aCallback, aParentController, collector, windowTimeout) {</span>
<a href="#l85.24"></a><span id="l85.24">   function paneLoadedChecker() {</span>
<a href="#l85.25"></a><span id="l85.25">     let pane = prefsController.window.document.getElementById(&quot;paneLightning&quot;);</span>
<a href="#l85.26"></a><span id="l85.26">     return pane.loaded;</span>
<a href="#l85.27"></a><span id="l85.27">   }</span>
<a href="#l85.28"></a><span id="l85.28"> </span>
<a href="#l85.29"></a><span id="l85.29">   let timeout = windowTimeout || 30000;</span>
<a href="#l85.30"></a><span id="l85.30">   aParentController.window.openOptionsDialog(&quot;paneLightning&quot;);</span>
<a href="#l85.31"></a><span id="l85.31" class="difflineminus">-  aParentController.waitFor(function() {return mozmill.utils.getWindows(&quot;Mail:Preferences&quot;).length == 1},</span>
<a href="#l85.32"></a><span id="l85.32" class="difflineplus">+  aParentController.waitFor(function() {return mozmill.utils.getWindows(&quot;Mail:Preferences&quot;).length == 1;},</span>
<a href="#l85.33"></a><span id="l85.33">                             &quot;Error opening preferences window&quot;, timeout);</span>
<a href="#l85.34"></a><span id="l85.34">   let prefsController = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Mail:Preferences&quot;)[0]);</span>
<a href="#l85.35"></a><span id="l85.35">   prefsController.waitFor(paneLoadedChecker, &quot;Timed out waiting for lightning prefpane to load.&quot;);</span>
<a href="#l85.36"></a><span id="l85.36"> </span>
<a href="#l85.37"></a><span id="l85.37">   aCallback(prefsController);</span>
<a href="#l85.38"></a><span id="l85.38"> </span>
<a href="#l85.39"></a><span id="l85.39">   prefsController.window.close();</span>
<a href="#l85.40"></a><span id="l85.40" class="difflineminus">-  aParentController.waitFor(function() {return mozmill.utils.getWindows(&quot;Mail:Preferences&quot;).length == 0},</span>
<a href="#l85.41"></a><span id="l85.41" class="difflineplus">+  aParentController.waitFor(function() {return mozmill.utils.getWindows(&quot;Mail:Preferences&quot;).length == 0;},</span>
<a href="#l85.42"></a><span id="l85.42">                             &quot;Error closing preferences window&quot;, timeout);</span>
<a href="#l85.43"></a><span id="l85.43"> }</span>
<a href="#l85.44"></a><span id="l85.44"> </span>
<a href="#l85.45"></a><span id="l85.45"> // Export of constants</span>
<a href="#l85.46"></a><span id="l85.46"> exports.ALLDAY = ALLDAY;</span>
<a href="#l85.47"></a><span id="l85.47"> exports.CANVAS_BOX = CANVAS_BOX;</span>
<a href="#l85.48"></a><span id="l85.48"> exports.EVENT_BOX = EVENT_BOX;</span>
<a href="#l85.49"></a><span id="l85.49"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l86.1"></a><span id="l86.1" class="difflineminus">--- a/calendar/test/mozmill/testAlarmDefaultValue.js</span>
<a href="#l86.2"></a><span id="l86.2" class="difflineplus">+++ b/calendar/test/mozmill/testAlarmDefaultValue.js</span>
<a href="#l86.3"></a><span id="l86.3" class="difflineat">@@ -40,52 +40,52 @@ function testDefaultAlarms() {</span>
<a href="#l86.4"></a><span id="l86.4"> </span>
<a href="#l86.5"></a><span id="l86.5">   // Configure the lightning preferences</span>
<a href="#l86.6"></a><span id="l86.6">   calUtils.open_lightning_prefs(handle_pref_dialog, calendarController, collector);</span>
<a href="#l86.7"></a><span id="l86.7"> </span>
<a href="#l86.8"></a><span id="l86.8">   // Create New Event</span>
<a href="#l86.9"></a><span id="l86.9">   calendarController.click(new elementslib.ID(calendarController.window.document, &quot;newMsgButton-calendar-menuitem&quot;));</span>
<a href="#l86.10"></a><span id="l86.10"> </span>
<a href="#l86.11"></a><span id="l86.11">   // Set up the event dialog controller</span>
<a href="#l86.12"></a><span id="l86.12" class="difflineminus">-  calendarController.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0});</span>
<a href="#l86.13"></a><span id="l86.13" class="difflineplus">+  calendarController.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;});</span>
<a href="#l86.14"></a><span id="l86.14">   let eventController = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l86.15"></a><span id="l86.15"> </span>
<a href="#l86.16"></a><span id="l86.16">   // Check if the &quot;custom&quot; item was selected</span>
<a href="#l86.17"></a><span id="l86.17">   eventController.assertDOMProperty(new elementslib.ID(eventController.window.document, &quot;item-alarm&quot;),</span>
<a href="#l86.18"></a><span id="l86.18">                                     &quot;value&quot;,</span>
<a href="#l86.19"></a><span id="l86.19">                                     &quot;custom&quot;);</span>
<a href="#l86.20"></a><span id="l86.20">   eventController.assertDOMProperty(new elementslib.XPath(eventController.window.document,</span>
<a href="#l86.21"></a><span id="l86.21">                                       '//*[@id=&quot;reminder-details&quot;]/*[local-name()=&quot;label&quot; ' +</span>
<a href="#l86.22"></a><span id="l86.22">                                       'and (not(@hidden) or @hidden=&quot;false&quot;)]'),</span>
<a href="#l86.23"></a><span id="l86.23">                                     &quot;value&quot;,</span>
<a href="#l86.24"></a><span id="l86.24">                                     expectedEventReminder);</span>
<a href="#l86.25"></a><span id="l86.25"> </span>
<a href="#l86.26"></a><span id="l86.26">   // Close the event dialog</span>
<a href="#l86.27"></a><span id="l86.27">   eventController.window.close();</span>
<a href="#l86.28"></a><span id="l86.28" class="difflineminus">-  calendarController.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l86.29"></a><span id="l86.29" class="difflineplus">+  calendarController.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l86.30"></a><span id="l86.30"> </span>
<a href="#l86.31"></a><span id="l86.31">   // Create New Task</span>
<a href="#l86.32"></a><span id="l86.32">   calendarController.click(new elementslib.ID(calendarController.window.document, &quot;newMsgButton-task-menuitem&quot;));</span>
<a href="#l86.33"></a><span id="l86.33"> </span>
<a href="#l86.34"></a><span id="l86.34">   // Set up the task dialog controller</span>
<a href="#l86.35"></a><span id="l86.35" class="difflineminus">-  calendarController.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0});</span>
<a href="#l86.36"></a><span id="l86.36" class="difflineplus">+  calendarController.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;});</span>
<a href="#l86.37"></a><span id="l86.37">   let taskController = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l86.38"></a><span id="l86.38"> </span>
<a href="#l86.39"></a><span id="l86.39">   // Check if the &quot;custom&quot; item was selected</span>
<a href="#l86.40"></a><span id="l86.40">   taskController.assertDOMProperty(new elementslib.ID(taskController.window.document, &quot;item-alarm&quot;),</span>
<a href="#l86.41"></a><span id="l86.41">                                    &quot;value&quot;,</span>
<a href="#l86.42"></a><span id="l86.42">                                    &quot;custom&quot;);</span>
<a href="#l86.43"></a><span id="l86.43">   taskController.assertDOMProperty(new elementslib.XPath(taskController.window.document,</span>
<a href="#l86.44"></a><span id="l86.44">                                      '//*[@id=&quot;reminder-details&quot;]/*[local-name()=&quot;label&quot; ' +</span>
<a href="#l86.45"></a><span id="l86.45">                                       'and (not(@hidden) or @hidden=&quot;false&quot;)]'),</span>
<a href="#l86.46"></a><span id="l86.46">                                    &quot;value&quot;,</span>
<a href="#l86.47"></a><span id="l86.47">                                    expectedTaskReminder);</span>
<a href="#l86.48"></a><span id="l86.48">   // Close the task dialog</span>
<a href="#l86.49"></a><span id="l86.49">   taskController.window.close();</span>
<a href="#l86.50"></a><span id="l86.50" class="difflineminus">-  calendarController.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l86.51"></a><span id="l86.51" class="difflineplus">+  calendarController.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l86.52"></a><span id="l86.52"> }</span>
<a href="#l86.53"></a><span id="l86.53"> </span>
<a href="#l86.54"></a><span id="l86.54"> function handle_pref_dialog(prefsController) {</span>
<a href="#l86.55"></a><span id="l86.55">   // Click on the alarms tab</span>
<a href="#l86.56"></a><span id="l86.56">   prefsController.click(new elementslib.ID(prefsController.window.document, &quot;calPreferencesTabAlarms&quot;));</span>
<a href="#l86.57"></a><span id="l86.57"> </span>
<a href="#l86.58"></a><span id="l86.58">   // Turn on alarms for events and tasks</span>
<a href="#l86.59"></a><span id="l86.59">   prefsController.waitThenClick(new elementslib.ID(prefsController.window.document, &quot;eventdefalarm&quot;));</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l87.1"></a><span id="l87.1" class="difflineminus">--- a/calendar/test/mozmill/testBasicFunctionality.js</span>
<a href="#l87.2"></a><span id="l87.2" class="difflineplus">+++ b/calendar/test/mozmill/testBasicFunctionality.js</span>
<a href="#l87.3"></a><span id="l87.3" class="difflineat">@@ -8,17 +8,17 @@ var MODULE_REQUIRES = [&quot;calendar-utils&quot;,</span>
<a href="#l87.4"></a><span id="l87.4"> </span>
<a href="#l87.5"></a><span id="l87.5"> var calUtils = require(&quot;shared-modules/calendar-utils&quot;);</span>
<a href="#l87.6"></a><span id="l87.6"> var TIMEOUT_MODAL_DIALOG = 30000;</span>
<a href="#l87.7"></a><span id="l87.7"> </span>
<a href="#l87.8"></a><span id="l87.8"> var modalDialog;</span>
<a href="#l87.9"></a><span id="l87.9"> var setupModule = function(module) {</span>
<a href="#l87.10"></a><span id="l87.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l87.11"></a><span id="l87.11">   modalDialog = collector.getModule('window-helpers');</span>
<a href="#l87.12"></a><span id="l87.12" class="difflineminus">-}</span>
<a href="#l87.13"></a><span id="l87.13" class="difflineplus">+};</span>
<a href="#l87.14"></a><span id="l87.14"> </span>
<a href="#l87.15"></a><span id="l87.15"> var testSmokeTest = function() {</span>
<a href="#l87.16"></a><span id="l87.16">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l87.17"></a><span id="l87.17">                               .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l87.18"></a><span id="l87.18">   let path = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/id(&quot;tabpanelcontainer&quot;)/'</span>
<a href="#l87.19"></a><span id="l87.19">     + 'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/';</span>
<a href="#l87.20"></a><span id="l87.20"> </span>
<a href="#l87.21"></a><span id="l87.21">   // open calendar view</span>
<a href="#l87.22"></a><span id="l87.22" class="difflineat">@@ -66,17 +66,17 @@ var testSmokeTest = function() {</span>
<a href="#l87.23"></a><span id="l87.23"> </span>
<a href="#l87.24"></a><span id="l87.24">   // create test calendar</span>
<a href="#l87.25"></a><span id="l87.25">   modalDialog.plan_for_modal_dialog(&quot;Calendar:NewCalendarWizard&quot;, handleNewCalendarWizard);</span>
<a href="#l87.26"></a><span id="l87.26">   let calendarList = new elementslib.Lookup(controller.window.document, path</span>
<a href="#l87.27"></a><span id="l87.27">     + '/id(&quot;ltnSidebar&quot;)/id(&quot;calendar-panel&quot;)/id(&quot;calendar-list-pane&quot;)/id(&quot;calendar-listtree-pane&quot;)/'</span>
<a href="#l87.28"></a><span id="l87.28">     + 'id(&quot;calendar-list-tree-widget&quot;)/anon({&quot;anonid&quot;:&quot;tree&quot;})/anon({&quot;anonid&quot;:&quot;treechildren&quot;})');</span>
<a href="#l87.29"></a><span id="l87.29">   controller.doubleClick(calendarList, 0, calendarList.getNode().boxObject.height); // bottom left</span>
<a href="#l87.30"></a><span id="l87.30">   modalDialog.wait_for_modal_dialog(&quot;Calendar:NewCalendarWizard&quot;, TIMEOUT_MODAL_DIALOG);</span>
<a href="#l87.31"></a><span id="l87.31" class="difflineminus">-}</span>
<a href="#l87.32"></a><span id="l87.32" class="difflineplus">+};</span>
<a href="#l87.33"></a><span id="l87.33"> </span>
<a href="#l87.34"></a><span id="l87.34"> function handleNewCalendarWizard(controller) {</span>
<a href="#l87.35"></a><span id="l87.35">   let docEl = controller.window.document.documentElement;</span>
<a href="#l87.36"></a><span id="l87.36">   // click next</span>
<a href="#l87.37"></a><span id="l87.37">   docEl.getButton(&quot;next&quot;).doCommand();</span>
<a href="#l87.38"></a><span id="l87.38"> </span>
<a href="#l87.39"></a><span id="l87.39">   // set calendar name</span>
<a href="#l87.40"></a><span id="l87.40">   let calendarNameTextBox = new elementslib.Lookup(controller.window.document, '/id(&quot;calendar-wizard&quot;)/'</span>
<a href="#l87.41"></a><span id="l87.41" class="difflineat">@@ -89,9 +89,9 @@ function handleNewCalendarWizard(control</span>
<a href="#l87.42"></a><span id="l87.42">   docEl.getButton(&quot;next&quot;).doCommand();</span>
<a href="#l87.43"></a><span id="l87.43"> </span>
<a href="#l87.44"></a><span id="l87.44">   // click finish</span>
<a href="#l87.45"></a><span id="l87.45">   docEl.getButton(&quot;finish&quot;).doCommand();</span>
<a href="#l87.46"></a><span id="l87.46"> }</span>
<a href="#l87.47"></a><span id="l87.47"> </span>
<a href="#l87.48"></a><span id="l87.48"> var teardownTest = function(module) {</span>
<a href="#l87.49"></a><span id="l87.49">   calUtils.deleteCalendars(controller, &quot;Mozmill&quot;);</span>
<a href="#l87.50"></a><span id="l87.50" class="difflineminus">-}</span>
<a href="#l87.51"></a><span id="l87.51" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l88.1"></a><span id="l88.1" class="difflineminus">--- a/calendar/test/mozmill/testLocalICS.js</span>
<a href="#l88.2"></a><span id="l88.2" class="difflineplus">+++ b/calendar/test/mozmill/testLocalICS.js</span>
<a href="#l88.3"></a><span id="l88.3" class="difflineat">@@ -28,46 +28,46 @@ var setupModule = function(module) {</span>
<a href="#l88.4"></a><span id="l88.4">   let time = (new Date()).getTime() + '';</span>
<a href="#l88.5"></a><span id="l88.5">   calendar = time;</span>
<a href="#l88.6"></a><span id="l88.6">   title = time;</span>
<a href="#l88.7"></a><span id="l88.7"> </span>
<a href="#l88.8"></a><span id="l88.8">   file = Services.dirsvc.get(&quot;TmpD&quot;, Components.interfaces.nsIFile);</span>
<a href="#l88.9"></a><span id="l88.9">   file.append(calendar + &quot;.ics&quot;);</span>
<a href="#l88.10"></a><span id="l88.10">   let fileURI = Services.io.newFileURI(file);</span>
<a href="#l88.11"></a><span id="l88.11">   uri = fileURI.prePath + fileURI.path;</span>
<a href="#l88.12"></a><span id="l88.12" class="difflineminus">-}</span>
<a href="#l88.13"></a><span id="l88.13" class="difflineplus">+};</span>
<a href="#l88.14"></a><span id="l88.14"> </span>
<a href="#l88.15"></a><span id="l88.15"> var testLocalICS = function() {</span>
<a href="#l88.16"></a><span id="l88.16">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l88.17"></a><span id="l88.17">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l88.18"></a><span id="l88.18"> </span>
<a href="#l88.19"></a><span id="l88.19">   modalDialog.plan_for_modal_dialog(&quot;Calendar:NewCalendarWizard&quot;, handleNewCalendarWizard);</span>
<a href="#l88.20"></a><span id="l88.20">   controller.mainMenu.click(&quot;#ltnNewCalendar&quot;);</span>
<a href="#l88.21"></a><span id="l88.21">   modalDialog.wait_for_modal_dialog(&quot;Calendar:NewCalendarWizard&quot;, TIMEOUT_MODAL_DIALOG);</span>
<a href="#l88.22"></a><span id="l88.22"> </span>
<a href="#l88.23"></a><span id="l88.23">   // create new event</span>
<a href="#l88.24"></a><span id="l88.24">   controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l88.25"></a><span id="l88.25">     calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, hour)), 1, 1);</span>
<a href="#l88.26"></a><span id="l88.26" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l88.27"></a><span id="l88.27" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l88.28"></a><span id="l88.28">   let event = new mozmill.controller.MozMillController(mozmill.utils</span>
<a href="#l88.29"></a><span id="l88.29">     .getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l88.30"></a><span id="l88.30"> </span>
<a href="#l88.31"></a><span id="l88.31">   // let the iframe load</span>
<a href="#l88.32"></a><span id="l88.32">   let iframe = event.window.document.getElementById(&quot;lightning-item-panel-iframe&quot;);</span>
<a href="#l88.33"></a><span id="l88.33">   event.waitFor(() =&gt; iframe.contentWindow.onLoad &amp;&amp; iframe.contentWindow.onLoad.hasLoaded == true);</span>
<a href="#l88.34"></a><span id="l88.34"> </span>
<a href="#l88.35"></a><span id="l88.35">   // title</span>
<a href="#l88.36"></a><span id="l88.36">   let titleTextBox = new elementslib.Lookup(iframe.contentDocument, '/id(&quot;calendar-event-dialog-inner&quot;)/'</span>
<a href="#l88.37"></a><span id="l88.37">     + 'id(&quot;event-grid&quot;)/id(&quot;event-grid-rows&quot;)/id(&quot;event-grid-title-row&quot;)/'</span>
<a href="#l88.38"></a><span id="l88.38">     + 'id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l88.39"></a><span id="l88.39">   event.waitForElement(titleTextBox);</span>
<a href="#l88.40"></a><span id="l88.40">   event.type(titleTextBox, title);</span>
<a href="#l88.41"></a><span id="l88.41"> </span>
<a href="#l88.42"></a><span id="l88.42">   // set calendar</span>
<a href="#l88.43"></a><span id="l88.43" class="difflineminus">-  let itemCalendar = new elementslib.ID(event.window.document, &quot;item-calendar&quot;)</span>
<a href="#l88.44"></a><span id="l88.44" class="difflineplus">+  let itemCalendar = new elementslib.ID(event.window.document, &quot;item-calendar&quot;);</span>
<a href="#l88.45"></a><span id="l88.45">   event.select(itemCalendar, undefined, calendar);</span>
<a href="#l88.46"></a><span id="l88.46">   // HACK - Wait for the value to be selected. This is needed for platforms</span>
<a href="#l88.47"></a><span id="l88.47">   // like mac where selecting the menuitem is an asynchronous process, it might</span>
<a href="#l88.48"></a><span id="l88.48">   // be fixed in a later version of mozmill.</span>
<a href="#l88.49"></a><span id="l88.49">   event.waitFor(() =&gt; itemCalendar.getNode().value == calendar);</span>
<a href="#l88.50"></a><span id="l88.50"> </span>
<a href="#l88.51"></a><span id="l88.51">   // save</span>
<a href="#l88.52"></a><span id="l88.52">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l88.53"></a><span id="l88.53" class="difflineat">@@ -93,21 +93,21 @@ var testLocalICS = function() {</span>
<a href="#l88.54"></a><span id="l88.54">   fstream.init(file, -1, 0, 0);</span>
<a href="#l88.55"></a><span id="l88.55">   cstream.init(fstream, &quot;UTF-8&quot;, 0, 0);</span>
<a href="#l88.56"></a><span id="l88.56"> </span>
<a href="#l88.57"></a><span id="l88.57">   let str = {};</span>
<a href="#l88.58"></a><span id="l88.58">   cstream.readString(-1, str);</span>
<a href="#l88.59"></a><span id="l88.59">   cstream.close();</span>
<a href="#l88.60"></a><span id="l88.60"> </span>
<a href="#l88.61"></a><span id="l88.61">   controller.assertJS(str.value.includes(&quot;SUMMARY:&quot; + title));</span>
<a href="#l88.62"></a><span id="l88.62" class="difflineminus">-}</span>
<a href="#l88.63"></a><span id="l88.63" class="difflineplus">+};</span>
<a href="#l88.64"></a><span id="l88.64"> </span>
<a href="#l88.65"></a><span id="l88.65"> var teardownTest = function(module) {</span>
<a href="#l88.66"></a><span id="l88.66">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l88.67"></a><span id="l88.67" class="difflineminus">-}</span>
<a href="#l88.68"></a><span id="l88.68" class="difflineplus">+};</span>
<a href="#l88.69"></a><span id="l88.69"> </span>
<a href="#l88.70"></a><span id="l88.70"> function handleNewCalendarWizard(wizard) {</span>
<a href="#l88.71"></a><span id="l88.71">   let docEl = wizard.window.document.documentElement;</span>
<a href="#l88.72"></a><span id="l88.72"> </span>
<a href="#l88.73"></a><span id="l88.73">   // choose network calendar</span>
<a href="#l88.74"></a><span id="l88.74">   let remoteOption = new elementslib.Lookup(wizard.window.document, '/id(&quot;calendar-wizard&quot;)/'</span>
<a href="#l88.75"></a><span id="l88.75">     + '{&quot;pageid&quot;:&quot;initialPage&quot;}/id(&quot;calendar-type&quot;)/{&quot;value&quot;:&quot;remote&quot;}');</span>
<a href="#l88.76"></a><span id="l88.76">   wizard.waitForElement(remoteOption);</span>
<a href="#l88.77"></a><span id="l88.77" class="difflineat">@@ -122,14 +122,14 @@ function handleNewCalendarWizard(wizard)</span>
<a href="#l88.78"></a><span id="l88.78">   // enter location</span>
<a href="#l88.79"></a><span id="l88.79">   wizard.type(new elementslib.Lookup(wizard.window.document, '/id(&quot;calendar-wizard&quot;)/'</span>
<a href="#l88.80"></a><span id="l88.80">     + '{&quot;pageid&quot;:&quot;locationPage&quot;}/[1]/[1]/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calendar-uri&quot;)/'</span>
<a href="#l88.81"></a><span id="l88.81">     + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l88.82"></a><span id="l88.82">     uri);</span>
<a href="#l88.83"></a><span id="l88.83">   docEl.getButton(&quot;next&quot;).doCommand();</span>
<a href="#l88.84"></a><span id="l88.84"> </span>
<a href="#l88.85"></a><span id="l88.85">   // name is filled in automatically using filename</span>
<a href="#l88.86"></a><span id="l88.86" class="difflineminus">-  wizard.waitFor(function() {return docEl.getButton(&quot;next&quot;).disabled == false});</span>
<a href="#l88.87"></a><span id="l88.87" class="difflineplus">+  wizard.waitFor(function() {return docEl.getButton(&quot;next&quot;).disabled == false;});</span>
<a href="#l88.88"></a><span id="l88.88">   docEl.getButton(&quot;next&quot;).doCommand();</span>
<a href="#l88.89"></a><span id="l88.89"> </span>
<a href="#l88.90"></a><span id="l88.90">   // finish</span>
<a href="#l88.91"></a><span id="l88.91">   docEl.getButton(&quot;finish&quot;).doCommand();</span>
<a href="#l88.92"></a><span id="l88.92"> }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l89.1"></a><span id="l89.1" class="difflineminus">--- a/calendar/test/mozmill/testTodayPane.js</span>
<a href="#l89.2"></a><span id="l89.2" class="difflineplus">+++ b/calendar/test/mozmill/testTodayPane.js</span>
<a href="#l89.3"></a><span id="l89.3" class="difflineat">@@ -12,17 +12,17 @@ var MOZMILL_CALENDAR = &quot;Mozmill&quot;;</span>
<a href="#l89.4"></a><span id="l89.4"> </span>
<a href="#l89.5"></a><span id="l89.5"> var calUtils = require(&quot;./shared-modules/calendar-utils&quot;);</span>
<a href="#l89.6"></a><span id="l89.6"> </span>
<a href="#l89.7"></a><span id="l89.7"> Components.utils.import(&quot;resource://calendar/modules/calUtils.jsm&quot;);</span>
<a href="#l89.8"></a><span id="l89.8"> </span>
<a href="#l89.9"></a><span id="l89.9"> var setupModule = function(module) {</span>
<a href="#l89.10"></a><span id="l89.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l89.11"></a><span id="l89.11">   calUtils.createCalendar(controller, MOZMILL_CALENDAR);</span>
<a href="#l89.12"></a><span id="l89.12" class="difflineminus">-}</span>
<a href="#l89.13"></a><span id="l89.13" class="difflineplus">+};</span>
<a href="#l89.14"></a><span id="l89.14"> </span>
<a href="#l89.15"></a><span id="l89.15"> var testTodayPane = function() {</span>
<a href="#l89.16"></a><span id="l89.16">   // paths</span>
<a href="#l89.17"></a><span id="l89.17">   let panels = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l89.18"></a><span id="l89.18">     + 'id(&quot;tabpanelcontainer&quot;)/';</span>
<a href="#l89.19"></a><span id="l89.19">   let miniMonth = panels + 'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/'</span>
<a href="#l89.20"></a><span id="l89.20">     + 'id(&quot;minimonth-pane&quot;)/';</span>
<a href="#l89.21"></a><span id="l89.21">   let dayView = panels + 'id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;calendarDisplayDeck&quot;)/'</span>
<a href="#l89.22"></a><span id="l89.22" class="difflineat">@@ -54,64 +54,64 @@ var testTodayPane = function() {</span>
<a href="#l89.23"></a><span id="l89.23">   if (startHour &lt; 8 || startHour &gt; 16) {</span>
<a href="#l89.24"></a><span id="l89.24">     view.scrollToMinute(60 * startHour);</span>
<a href="#l89.25"></a><span id="l89.25">   }</span>
<a href="#l89.26"></a><span id="l89.26"> </span>
<a href="#l89.27"></a><span id="l89.27">   controller.doubleClick(new elementslib.Lookup(controller.window.document, dayView</span>
<a href="#l89.28"></a><span id="l89.28">     + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l89.29"></a><span id="l89.29">     + '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/'</span>
<a href="#l89.30"></a><span id="l89.30">     + 'anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[' + startHour + ']'), 1, 1);</span>
<a href="#l89.31"></a><span id="l89.31" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l89.32"></a><span id="l89.32" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l89.33"></a><span id="l89.33">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l89.34"></a><span id="l89.34">   let iframe = event.window.document.getElementById(&quot;lightning-item-panel-iframe&quot;);</span>
<a href="#l89.35"></a><span id="l89.35">   event.waitFor(() =&gt; iframe.contentWindow.onLoad &amp;&amp; iframe.contentWindow.onLoad.hasLoaded == true);</span>
<a href="#l89.36"></a><span id="l89.36"> </span>
<a href="#l89.37"></a><span id="l89.37">   event.waitForElement(new elementslib.Lookup(iframe.contentDocument, eventName));</span>
<a href="#l89.38"></a><span id="l89.38">   event.type(new elementslib.Lookup(iframe.contentDocument, eventName), &quot;Today's Event&quot;);</span>
<a href="#l89.39"></a><span id="l89.39">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l89.40"></a><span id="l89.40" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l89.41"></a><span id="l89.41" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l89.42"></a><span id="l89.42"> </span>
<a href="#l89.43"></a><span id="l89.43">   // reset view</span>
<a href="#l89.44"></a><span id="l89.44">   view.scrollToMinute(60 * 8);</span>
<a href="#l89.45"></a><span id="l89.45"> </span>
<a href="#l89.46"></a><span id="l89.46">   // go to tomorrow and add an event</span>
<a href="#l89.47"></a><span id="l89.47">   controller.click(new elementslib.ID(controller.window.document, &quot;next-view-button&quot;));</span>
<a href="#l89.48"></a><span id="l89.48">   controller.doubleClick(new elementslib.Lookup(controller.window.document, dayView</span>
<a href="#l89.49"></a><span id="l89.49">     + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l89.50"></a><span id="l89.50">     + '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/'</span>
<a href="#l89.51"></a><span id="l89.51">     + 'anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[9]'), 1, 1);</span>
<a href="#l89.52"></a><span id="l89.52" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l89.53"></a><span id="l89.53" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l89.54"></a><span id="l89.54">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l89.55"></a><span id="l89.55">   iframe = event.window.document.getElementById(&quot;lightning-item-panel-iframe&quot;);</span>
<a href="#l89.56"></a><span id="l89.56">   event.waitFor(() =&gt; iframe.contentWindow.onLoad &amp;&amp; iframe.contentWindow.onLoad.hasLoaded == true);</span>
<a href="#l89.57"></a><span id="l89.57"> </span>
<a href="#l89.58"></a><span id="l89.58">   event.waitForElement(new elementslib.Lookup(iframe.contentDocument, eventName));</span>
<a href="#l89.59"></a><span id="l89.59">   event.type(new elementslib.Lookup(iframe.contentDocument, eventName), &quot;Tomorrow's Event&quot;);</span>
<a href="#l89.60"></a><span id="l89.60">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l89.61"></a><span id="l89.61" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l89.62"></a><span id="l89.62" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l89.63"></a><span id="l89.63"> </span>
<a href="#l89.64"></a><span id="l89.64">   // go 5 days forward and add an event</span>
<a href="#l89.65"></a><span id="l89.65">   for (let i = 0; i &lt; 5; i++) {</span>
<a href="#l89.66"></a><span id="l89.66">     controller.click(new elementslib.ID(controller.window.document, &quot;next-view-button&quot;));</span>
<a href="#l89.67"></a><span id="l89.67">   }</span>
<a href="#l89.68"></a><span id="l89.68">   controller.sleep(WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l89.69"></a><span id="l89.69"> </span>
<a href="#l89.70"></a><span id="l89.70">   controller.doubleClick(new elementslib.Lookup(controller.window.document, dayView</span>
<a href="#l89.71"></a><span id="l89.71">     + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l89.72"></a><span id="l89.72">     + '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/'</span>
<a href="#l89.73"></a><span id="l89.73">     + 'anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[9]'), 1, 1);</span>
<a href="#l89.74"></a><span id="l89.74" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l89.75"></a><span id="l89.75" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l89.76"></a><span id="l89.76">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l89.77"></a><span id="l89.77">   iframe = event.window.document.getElementById(&quot;lightning-item-panel-iframe&quot;);</span>
<a href="#l89.78"></a><span id="l89.78">   event.waitFor(() =&gt; iframe.contentWindow.onLoad &amp;&amp; iframe.contentWindow.onLoad.hasLoaded == true);</span>
<a href="#l89.79"></a><span id="l89.79"> </span>
<a href="#l89.80"></a><span id="l89.80">   event.waitForElement(new elementslib.Lookup(iframe.contentDocument, eventName));</span>
<a href="#l89.81"></a><span id="l89.81">   event.type(new elementslib.Lookup(iframe.contentDocument, eventName), &quot;Future's Event&quot;);</span>
<a href="#l89.82"></a><span id="l89.82">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l89.83"></a><span id="l89.83" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l89.84"></a><span id="l89.84" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l89.85"></a><span id="l89.85"> </span>
<a href="#l89.86"></a><span id="l89.86">   // go to mail tab</span>
<a href="#l89.87"></a><span id="l89.87">   controller.click(new elementslib.Lookup(controller.window.document, '/id(&quot;messengerWindow&quot;)/'</span>
<a href="#l89.88"></a><span id="l89.88">     + 'id(&quot;navigation-toolbox&quot;)/id(&quot;tabs-toolbar&quot;)/id(&quot;tabcontainer&quot;)/{&quot;first-tab&quot;:&quot;true&quot;,&quot;type&quot;:&quot;folder&quot;}/'</span>
<a href="#l89.89"></a><span id="l89.89">     + 'anon({&quot;class&quot;:&quot;tab-stack&quot;})/{&quot;class&quot;:&quot;tab-background&quot;}/{&quot;class&quot;:&quot;tab-background-middle&quot;}'));</span>
<a href="#l89.90"></a><span id="l89.90">   controller.sleep(WAIT_FOR_WINDOW_TIMEOUT);</span>
<a href="#l89.91"></a><span id="l89.91"> </span>
<a href="#l89.92"></a><span id="l89.92">   // verify today pane open</span>
<a href="#l89.93"></a><span id="l89.93" class="difflineat">@@ -232,22 +232,22 @@ var testTodayPane = function() {</span>
<a href="#l89.94"></a><span id="l89.94">   let soon = (new elementslib.Lookup(controller.window.document,</span>
<a href="#l89.95"></a><span id="l89.95">     '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;today-pane-panel&quot;)/[1]/id(&quot;agenda-panel&quot;)/'</span>
<a href="#l89.96"></a><span id="l89.96">     + '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;agenda-listbox&quot;)/[2]/anon({&quot;class&quot;:&quot;agenda-checkbox&quot;})')).getNode();</span>
<a href="#l89.97"></a><span id="l89.97"> // TODO This is failing, which might actually be an error in our code!</span>
<a href="#l89.98"></a><span id="l89.98"> //  controller.assertJS(!tomorrow.hasAttribute(&quot;checked&quot;)</span>
<a href="#l89.99"></a><span id="l89.99"> //    || tomorrow.getAttribute(&quot;checked&quot;) != &quot;true&quot;);</span>
<a href="#l89.100"></a><span id="l89.100">   controller.assertJS(!soon.hasAttribute(&quot;checked&quot;)</span>
<a href="#l89.101"></a><span id="l89.101">     || soon.getAttribute(&quot;checked&quot;) != &quot;true&quot;);</span>
<a href="#l89.102"></a><span id="l89.102" class="difflineminus">-}</span>
<a href="#l89.103"></a><span id="l89.103" class="difflineplus">+};</span>
<a href="#l89.104"></a><span id="l89.104"> </span>
<a href="#l89.105"></a><span id="l89.105"> var getIsoDate = function() {</span>
<a href="#l89.106"></a><span id="l89.106">   let date = new Date();</span>
<a href="#l89.107"></a><span id="l89.107">   let year = date.getFullYear();</span>
<a href="#l89.108"></a><span id="l89.108">   let month = (date.getMonth() &lt; 9) ? '0' + (date.getMonth() + 1) : (date.getMonth() + 1);</span>
<a href="#l89.109"></a><span id="l89.109">   let day = (date.getDate() &lt; 10) ? '0' + date.getDate() : date.getDate();</span>
<a href="#l89.110"></a><span id="l89.110">   let isoDate = year + '' + month + '' + day;</span>
<a href="#l89.111"></a><span id="l89.111">   return isoDate;</span>
<a href="#l89.112"></a><span id="l89.112" class="difflineminus">-}</span>
<a href="#l89.113"></a><span id="l89.113" class="difflineplus">+};</span>
<a href="#l89.114"></a><span id="l89.114"> </span>
<a href="#l89.115"></a><span id="l89.115"> var teardownTest = function(module) {</span>
<a href="#l89.116"></a><span id="l89.116">   calUtils.deleteCalendars(controller, MOZMILL_CALENDAR);</span>
<a href="#l89.117"></a><span id="l89.117" class="difflineminus">-}</span>
<a href="#l89.118"></a><span id="l89.118" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l90.1"></a><span id="l90.1" class="difflineminus">--- a/calendar/test/mozmill/timezoneTests/test1.js</span>
<a href="#l90.2"></a><span id="l90.2" class="difflineplus">+++ b/calendar/test/mozmill/timezoneTests/test1.js</span>
<a href="#l90.3"></a><span id="l90.3" class="difflineat">@@ -5,13 +5,13 @@</span>
<a href="#l90.4"></a><span id="l90.4"> var calUtils = require(&quot;../shared-modules/calendar-utils&quot;);</span>
<a href="#l90.5"></a><span id="l90.5"> var timezoneUtils = require(&quot;../shared-modules/timezone-utils&quot;);</span>
<a href="#l90.6"></a><span id="l90.6"> </span>
<a href="#l90.7"></a><span id="l90.7"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l90.8"></a><span id="l90.8"> </span>
<a href="#l90.9"></a><span id="l90.9"> var setupModule = function(module) {</span>
<a href="#l90.10"></a><span id="l90.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l90.11"></a><span id="l90.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l90.12"></a><span id="l90.12" class="difflineminus">-}</span>
<a href="#l90.13"></a><span id="l90.13" class="difflineplus">+};</span>
<a href="#l90.14"></a><span id="l90.14"> </span>
<a href="#l90.15"></a><span id="l90.15"> var testTimezones1_SetGMT = function() {</span>
<a href="#l90.16"></a><span id="l90.16">   timezoneUtils.switchAppTimezone(&quot;Europe/London&quot;);</span>
<a href="#l90.17"></a><span id="l90.17" class="difflineminus">-}</span>
<a href="#l90.18"></a><span id="l90.18" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l91.1"></a><span id="l91.1" class="difflineminus">--- a/calendar/test/mozmill/timezoneTests/test10.js</span>
<a href="#l91.2"></a><span id="l91.2" class="difflineplus">+++ b/calendar/test/mozmill/timezoneTests/test10.js</span>
<a href="#l91.3"></a><span id="l91.3" class="difflineat">@@ -16,28 +16,28 @@ var timezones = [&quot;America/St_Johns&quot;, &quot;Am</span>
<a href="#l91.4"></a><span id="l91.4">    columns - correct time for each event */</span>
<a href="#l91.5"></a><span id="l91.5"> var times = [[[18, 30], [19, 30], [20, 30], [21, 30], [22, 30], [23, 30], [0, 30, +1], [1, 30, +1]],</span>
<a href="#l91.6"></a><span id="l91.6">              [[17, 30], [19, 30], [20, 30], [20, 30], [22, 30], [22, 30], [0, 30, +1], [1, 30, +1]],</span>
<a href="#l91.7"></a><span id="l91.7">              [[16, 30], [18, 30], [19, 30], [19, 30], [21, 30], [21, 30], [23, 30], [1, 30, +1]],</span>
<a href="#l91.8"></a><span id="l91.8">              [[16, 30], [18, 30], [19, 30], [19, 30], [21, 30], [21, 30], [23, 30], [1, 30, +1]],</span>
<a href="#l91.9"></a><span id="l91.9">              [[16, 30], [18, 30], [19, 30], [19, 30], [21, 30], [21, 30], [23, 30], [1, 30, +1]],</span>
<a href="#l91.10"></a><span id="l91.10">              [[17, 30], [19, 30], [20, 30], [20, 30], [22, 30], [22, 30], [0, 30, +1], [1, 30, +1]],</span>
<a href="#l91.11"></a><span id="l91.11">              [[17, 30], [19, 30], [20, 30], [20, 30], [22, 30], [23, 30], [0, 30, +1], [1, 30, +1]],</span>
<a href="#l91.12"></a><span id="l91.12" class="difflineminus">-             [[18, 30], [19, 30], [20, 30], [21, 30], [22, 30], [23, 30], [0, 30, +1], [1, 30, +1]]]</span>
<a href="#l91.13"></a><span id="l91.13" class="difflineplus">+             [[18, 30], [19, 30], [20, 30], [21, 30], [22, 30], [23, 30], [0, 30, +1], [1, 30, +1]]];</span>
<a href="#l91.14"></a><span id="l91.14"> </span>
<a href="#l91.15"></a><span id="l91.15"> var setupModule = function(module) {</span>
<a href="#l91.16"></a><span id="l91.16">   controller = mozmill.getMail3PaneController();</span>
<a href="#l91.17"></a><span id="l91.17" class="difflineminus">-}</span>
<a href="#l91.18"></a><span id="l91.18" class="difflineplus">+};</span>
<a href="#l91.19"></a><span id="l91.19"> </span>
<a href="#l91.20"></a><span id="l91.20"> var testTimezones10_checkAdelaide = function() {</span>
<a href="#l91.21"></a><span id="l91.21">   let eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l91.22"></a><span id="l91.22"> </span>
<a href="#l91.23"></a><span id="l91.23">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l91.24"></a><span id="l91.24">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l91.25"></a><span id="l91.25">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l91.26"></a><span id="l91.26"> </span>
<a href="#l91.27"></a><span id="l91.27">   timezoneUtils.verify(controller, dates, timezones, times);</span>
<a href="#l91.28"></a><span id="l91.28" class="difflineminus">-}</span>
<a href="#l91.29"></a><span id="l91.29" class="difflineplus">+};</span>
<a href="#l91.30"></a><span id="l91.30"> </span>
<a href="#l91.31"></a><span id="l91.31"> var teardownTest = function(module) {</span>
<a href="#l91.32"></a><span id="l91.32">   prefs.preferences.clearUserPref(&quot;calendar.timezone.local&quot;);</span>
<a href="#l91.33"></a><span id="l91.33">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l91.34"></a><span id="l91.34" class="difflineminus">-}</span>
<a href="#l91.35"></a><span id="l91.35" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l92.1"></a><span id="l92.1" class="difflineminus">--- a/calendar/test/mozmill/timezoneTests/test2.js</span>
<a href="#l92.2"></a><span id="l92.2" class="difflineplus">+++ b/calendar/test/mozmill/timezoneTests/test2.js</span>
<a href="#l92.3"></a><span id="l92.3" class="difflineat">@@ -10,49 +10,49 @@ var sleep = 500;</span>
<a href="#l92.4"></a><span id="l92.4"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l92.5"></a><span id="l92.5"> var timezones = [&quot;America/St_Johns&quot;, &quot;America/Caracas&quot;, &quot;America/Phoenix&quot;, &quot;America/Los_Angeles&quot;,</span>
<a href="#l92.6"></a><span id="l92.6">                  &quot;America/Argentina/Buenos_Aires&quot;, &quot;Europe/Paris&quot;, &quot;Asia/Kathmandu&quot;, &quot;Australia/Adelaide&quot;];</span>
<a href="#l92.7"></a><span id="l92.7"> var times = [[4, 30], [4, 30], [3, 0], [3, 0], [9, 0], [14, 0], [19, 45], [1, 30]];</span>
<a href="#l92.8"></a><span id="l92.8"> var gTimezone;</span>
<a href="#l92.9"></a><span id="l92.9"> </span>
<a href="#l92.10"></a><span id="l92.10"> var setupModule = function(module) {</span>
<a href="#l92.11"></a><span id="l92.11">   controller = mozmill.getMail3PaneController();</span>
<a href="#l92.12"></a><span id="l92.12" class="difflineminus">-}</span>
<a href="#l92.13"></a><span id="l92.13" class="difflineplus">+};</span>
<a href="#l92.14"></a><span id="l92.14"> </span>
<a href="#l92.15"></a><span id="l92.15"> var testTimezones2_CreateEvents = function() {</span>
<a href="#l92.16"></a><span id="l92.16">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l92.17"></a><span id="l92.17">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l92.18"></a><span id="l92.18">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l92.19"></a><span id="l92.19"> </span>
<a href="#l92.20"></a><span id="l92.20">   // create daily recurring events in all timezones</span>
<a href="#l92.21"></a><span id="l92.21">   let time = new Date();</span>
<a href="#l92.22"></a><span id="l92.22">   for (let i = 0; i &lt; timezones.length; i++) {</span>
<a href="#l92.23"></a><span id="l92.23">     controller.doubleClick(new elementslib.Lookup(controller.window.document,</span>
<a href="#l92.24"></a><span id="l92.24">       calUtils.getEventBoxPath(controller, &quot;day&quot;, calUtils.CANVAS_BOX, undefined, 1, i + 8)), 1, 1);</span>
<a href="#l92.25"></a><span id="l92.25" class="difflineminus">-    controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l92.26"></a><span id="l92.26" class="difflineplus">+    controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l92.27"></a><span id="l92.27">     let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l92.28"></a><span id="l92.28"> </span>
<a href="#l92.29"></a><span id="l92.29">     time.setHours(times[i][0]);</span>
<a href="#l92.30"></a><span id="l92.30">     time.setMinutes(times[i][1]);</span>
<a href="#l92.31"></a><span id="l92.31"> </span>
<a href="#l92.32"></a><span id="l92.32">     // set timezone</span>
<a href="#l92.33"></a><span id="l92.33">     setTimezone(event, timezones[i]);</span>
<a href="#l92.34"></a><span id="l92.34"> </span>
<a href="#l92.35"></a><span id="l92.35">     // set title and repeat</span>
<a href="#l92.36"></a><span id="l92.36">     calUtils.setData(event, {title: timezones[i], repeat: &quot;weekly&quot;, starttime: time});</span>
<a href="#l92.37"></a><span id="l92.37"> </span>
<a href="#l92.38"></a><span id="l92.38">     // save</span>
<a href="#l92.39"></a><span id="l92.39">     event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l92.40"></a><span id="l92.40" class="difflineminus">-    controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l92.41"></a><span id="l92.41" class="difflineplus">+    controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l92.42"></a><span id="l92.42">   }</span>
<a href="#l92.43"></a><span id="l92.43" class="difflineminus">-}</span>
<a href="#l92.44"></a><span id="l92.44" class="difflineplus">+};</span>
<a href="#l92.45"></a><span id="l92.45"> </span>
<a href="#l92.46"></a><span id="l92.46"> var teardownTest = function(module) {</span>
<a href="#l92.47"></a><span id="l92.47">   timezoneUtils.switchAppTimezone(timezones[0]);</span>
<a href="#l92.48"></a><span id="l92.48" class="difflineminus">-}</span>
<a href="#l92.49"></a><span id="l92.49" class="difflineplus">+};</span>
<a href="#l92.50"></a><span id="l92.50"> </span>
<a href="#l92.51"></a><span id="l92.51"> function setTimezone(event, timezone) {</span>
<a href="#l92.52"></a><span id="l92.52">   gTimezone = timezone;</span>
<a href="#l92.53"></a><span id="l92.53"> </span>
<a href="#l92.54"></a><span id="l92.54">   // for some reason setting checked is needed, no other menuitem with checkbox needs it</span>
<a href="#l92.55"></a><span id="l92.55">   let menuitem = new elementslib.ID(event.window.document, &quot;options-timezones-menuitem&quot;);</span>
<a href="#l92.56"></a><span id="l92.56">   event.waitForElement(menuitem);</span>
<a href="#l92.57"></a><span id="l92.57">   menuitem.getNode().setAttribute(&quot;checked&quot;, &quot;true&quot;);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l93.1"></a><span id="l93.1" class="difflineminus">--- a/calendar/test/mozmill/timezoneTests/test3.js</span>
<a href="#l93.2"></a><span id="l93.2" class="difflineplus">+++ b/calendar/test/mozmill/timezoneTests/test3.js</span>
<a href="#l93.3"></a><span id="l93.3" class="difflineat">@@ -15,27 +15,27 @@ var timezones = [&quot;America/St_Johns&quot;, &quot;Am</span>
<a href="#l93.4"></a><span id="l93.4">    columns - correct time for each event */</span>
<a href="#l93.5"></a><span id="l93.5"> var times = [[[4, 30], [5, 30], [6, 30], [7, 30], [8, 30], [9, 30], [10, 30], [11, 30]],</span>
<a href="#l93.6"></a><span id="l93.6">              [[4, 30], [6, 30], [7, 30], [7, 30], [9, 30], [9, 30], [11, 30], [12, 30]],</span>
<a href="#l93.7"></a><span id="l93.7">              [[4, 30], [6, 30], [7, 30], [7, 30], [9, 30], [9, 30], [11, 30], [13, 30]],</span>
<a href="#l93.8"></a><span id="l93.8">              [[4, 30], [6, 30], [7, 30], [7, 30], [9, 30], [9, 30], [11, 30], [13, 30]],</span>
<a href="#l93.9"></a><span id="l93.9">              [[4, 30], [6, 30], [7, 30], [7, 30], [9, 30], [9, 30], [11, 30], [13, 30]],</span>
<a href="#l93.10"></a><span id="l93.10">              [[4, 30], [6, 30], [7, 30], [7, 30], [9, 30], [9, 30], [11, 30], [12, 30]],</span>
<a href="#l93.11"></a><span id="l93.11">              [[4, 30], [6, 30], [7, 30], [7, 30], [9, 30], [10, 30], [11, 30], [12, 30]],</span>
<a href="#l93.12"></a><span id="l93.12" class="difflineminus">-             [[4, 30], [5, 30], [6, 30], [7, 30], [8, 30], [9, 30], [10, 30], [11, 30]]]</span>
<a href="#l93.13"></a><span id="l93.13" class="difflineplus">+             [[4, 30], [5, 30], [6, 30], [7, 30], [8, 30], [9, 30], [10, 30], [11, 30]]];</span>
<a href="#l93.14"></a><span id="l93.14"> </span>
<a href="#l93.15"></a><span id="l93.15"> var setupModule = function(module) {</span>
<a href="#l93.16"></a><span id="l93.16">   controller = mozmill.getMail3PaneController();</span>
<a href="#l93.17"></a><span id="l93.17" class="difflineminus">-}</span>
<a href="#l93.18"></a><span id="l93.18" class="difflineplus">+};</span>
<a href="#l93.19"></a><span id="l93.19"> </span>
<a href="#l93.20"></a><span id="l93.20"> var testTimezones3_checkStJohns = function() {</span>
<a href="#l93.21"></a><span id="l93.21">   let eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l93.22"></a><span id="l93.22"> </span>
<a href="#l93.23"></a><span id="l93.23">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l93.24"></a><span id="l93.24">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l93.25"></a><span id="l93.25">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l93.26"></a><span id="l93.26"> </span>
<a href="#l93.27"></a><span id="l93.27">   timezoneUtils.verify(controller, dates, timezones, times);</span>
<a href="#l93.28"></a><span id="l93.28" class="difflineminus">-}</span>
<a href="#l93.29"></a><span id="l93.29" class="difflineplus">+};</span>
<a href="#l93.30"></a><span id="l93.30"> </span>
<a href="#l93.31"></a><span id="l93.31"> var teardownTest = function(module) {</span>
<a href="#l93.32"></a><span id="l93.32">   timezoneUtils.switchAppTimezone(timezones[1]);</span>
<a href="#l93.33"></a><span id="l93.33" class="difflineminus">-}</span>
<a href="#l93.34"></a><span id="l93.34" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l94.1"></a><span id="l94.1" class="difflineminus">--- a/calendar/test/mozmill/timezoneTests/test4.js</span>
<a href="#l94.2"></a><span id="l94.2" class="difflineplus">+++ b/calendar/test/mozmill/timezoneTests/test4.js</span>
<a href="#l94.3"></a><span id="l94.3" class="difflineat">@@ -15,27 +15,27 @@ var timezones = [&quot;America/St_Johns&quot;, &quot;Am</span>
<a href="#l94.4"></a><span id="l94.4">    columns - correct time for each event */</span>
<a href="#l94.5"></a><span id="l94.5"> var times = [[[3, 30], [4, 30], [5, 30], [6, 30], [7, 30], [8, 30], [9, 30], [10, 30]],</span>
<a href="#l94.6"></a><span id="l94.6">              [[2, 30], [4, 30], [5, 30], [5, 30], [7, 30], [7, 30], [9, 30], [10, 30]],</span>
<a href="#l94.7"></a><span id="l94.7">              [[2, 30], [4, 30], [5, 30], [5, 30], [7, 30], [7, 30], [9, 30], [11, 30]],</span>
<a href="#l94.8"></a><span id="l94.8">              [[2, 30], [4, 30], [5, 30], [5, 30], [7, 30], [7, 30], [9, 30], [11, 30]],</span>
<a href="#l94.9"></a><span id="l94.9">              [[2, 30], [4, 30], [5, 30], [5, 30], [7, 30], [7, 30], [9, 30], [11, 30]],</span>
<a href="#l94.10"></a><span id="l94.10">              [[2, 30], [4, 30], [5, 30], [5, 30], [7, 30], [7, 30], [9, 30], [10, 30]],</span>
<a href="#l94.11"></a><span id="l94.11">              [[2, 30], [4, 30], [5, 30], [5, 30], [7, 30], [8, 30], [9, 30], [10, 30]],</span>
<a href="#l94.12"></a><span id="l94.12" class="difflineminus">-             [[3, 30], [4, 30], [5, 30], [6, 30], [7, 30], [8, 30], [9, 30], [10, 30]]]</span>
<a href="#l94.13"></a><span id="l94.13" class="difflineplus">+             [[3, 30], [4, 30], [5, 30], [6, 30], [7, 30], [8, 30], [9, 30], [10, 30]]];</span>
<a href="#l94.14"></a><span id="l94.14"> </span>
<a href="#l94.15"></a><span id="l94.15"> var setupModule = function(module) {</span>
<a href="#l94.16"></a><span id="l94.16">   controller = mozmill.getMail3PaneController();</span>
<a href="#l94.17"></a><span id="l94.17" class="difflineminus">-}</span>
<a href="#l94.18"></a><span id="l94.18" class="difflineplus">+};</span>
<a href="#l94.19"></a><span id="l94.19"> </span>
<a href="#l94.20"></a><span id="l94.20"> var testTimezones4_checkCaracas = function() {</span>
<a href="#l94.21"></a><span id="l94.21">   let eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l94.22"></a><span id="l94.22"> </span>
<a href="#l94.23"></a><span id="l94.23">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l94.24"></a><span id="l94.24">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l94.25"></a><span id="l94.25">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l94.26"></a><span id="l94.26"> </span>
<a href="#l94.27"></a><span id="l94.27">   timezoneUtils.verify(controller, dates, timezones, times);</span>
<a href="#l94.28"></a><span id="l94.28" class="difflineminus">-}</span>
<a href="#l94.29"></a><span id="l94.29" class="difflineplus">+};</span>
<a href="#l94.30"></a><span id="l94.30"> </span>
<a href="#l94.31"></a><span id="l94.31"> var teardownTest = function(module) {</span>
<a href="#l94.32"></a><span id="l94.32">   timezoneUtils.switchAppTimezone(timezones[2]);</span>
<a href="#l94.33"></a><span id="l94.33" class="difflineminus">-}</span>
<a href="#l94.34"></a><span id="l94.34" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l95.1"></a><span id="l95.1" class="difflineminus">--- a/calendar/test/mozmill/timezoneTests/test5.js</span>
<a href="#l95.2"></a><span id="l95.2" class="difflineplus">+++ b/calendar/test/mozmill/timezoneTests/test5.js</span>
<a href="#l95.3"></a><span id="l95.3" class="difflineat">@@ -15,27 +15,27 @@ var timezones = [&quot;America/St_Johns&quot;, &quot;Am</span>
<a href="#l95.4"></a><span id="l95.4">    columns - correct time for each event */</span>
<a href="#l95.5"></a><span id="l95.5"> var times = [[[1, 0], [2, 0], [3, 0], [4, 0], [5, 0], [6, 0], [7, 0], [8, 0]],</span>
<a href="#l95.6"></a><span id="l95.6">              [[0, 0], [2, 0], [3, 0], [3, 0], [5, 0], [5, 0], [7, 0], [8, 0]],</span>
<a href="#l95.7"></a><span id="l95.7">              [[0, 0], [2, 0], [3, 0], [3, 0], [5, 0], [5, 0], [7, 0], [9, 0]],</span>
<a href="#l95.8"></a><span id="l95.8">              [[0, 0], [2, 0], [3, 0], [3, 0], [5, 0], [5, 0], [7, 0], [9, 0]],</span>
<a href="#l95.9"></a><span id="l95.9">              [[0, 0], [2, 0], [3, 0], [3, 0], [5, 0], [5, 0], [7, 0], [9, 0]],</span>
<a href="#l95.10"></a><span id="l95.10">              [[0, 0], [2, 0], [3, 0], [3, 0], [5, 0], [5, 0], [7, 0], [8, 0]],</span>
<a href="#l95.11"></a><span id="l95.11">              [[0, 0], [2, 0], [3, 0], [3, 0], [5, 0], [6, 0], [7, 0], [8, 0]],</span>
<a href="#l95.12"></a><span id="l95.12" class="difflineminus">-             [[1, 0], [2, 0], [3, 0], [4, 0], [5, 0], [6, 0], [7, 0], [8, 0]]]</span>
<a href="#l95.13"></a><span id="l95.13" class="difflineplus">+             [[1, 0], [2, 0], [3, 0], [4, 0], [5, 0], [6, 0], [7, 0], [8, 0]]];</span>
<a href="#l95.14"></a><span id="l95.14"> </span>
<a href="#l95.15"></a><span id="l95.15"> var setupModule = function(module) {</span>
<a href="#l95.16"></a><span id="l95.16">   controller = mozmill.getMail3PaneController();</span>
<a href="#l95.17"></a><span id="l95.17" class="difflineminus">-}</span>
<a href="#l95.18"></a><span id="l95.18" class="difflineplus">+};</span>
<a href="#l95.19"></a><span id="l95.19"> </span>
<a href="#l95.20"></a><span id="l95.20"> var testTimezones5_checkPhoenix = function() {</span>
<a href="#l95.21"></a><span id="l95.21">   let eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l95.22"></a><span id="l95.22"> </span>
<a href="#l95.23"></a><span id="l95.23">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l95.24"></a><span id="l95.24">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l95.25"></a><span id="l95.25">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l95.26"></a><span id="l95.26"> </span>
<a href="#l95.27"></a><span id="l95.27">   timezoneUtils.verify(controller, dates, timezones, times);</span>
<a href="#l95.28"></a><span id="l95.28" class="difflineminus">-}</span>
<a href="#l95.29"></a><span id="l95.29" class="difflineplus">+};</span>
<a href="#l95.30"></a><span id="l95.30"> </span>
<a href="#l95.31"></a><span id="l95.31"> var teardownTest = function(module) {</span>
<a href="#l95.32"></a><span id="l95.32">   timezoneUtils.switchAppTimezone(timezones[3]);</span>
<a href="#l95.33"></a><span id="l95.33" class="difflineminus">-}</span>
<a href="#l95.34"></a><span id="l95.34" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l96.1"></a><span id="l96.1" class="difflineminus">--- a/calendar/test/mozmill/timezoneTests/test6.js</span>
<a href="#l96.2"></a><span id="l96.2" class="difflineplus">+++ b/calendar/test/mozmill/timezoneTests/test6.js</span>
<a href="#l96.3"></a><span id="l96.3" class="difflineat">@@ -15,27 +15,27 @@ var timezones = [&quot;America/St_Johns&quot;, &quot;Am</span>
<a href="#l96.4"></a><span id="l96.4">    columns - correct time for each event */</span>
<a href="#l96.5"></a><span id="l96.5"> var times = [[[0, 0], [1, 0], [2, 0], [3, 0], [4, 0], [5, 0], [6, 0], [7, 0]],</span>
<a href="#l96.6"></a><span id="l96.6">              [[0, 0], [2, 0], [3, 0], [3, 0], [5, 0], [5, 0], [7, 0], [8, 0]],</span>
<a href="#l96.7"></a><span id="l96.7">              [[0, 0], [2, 0], [3, 0], [3, 0], [5, 0], [5, 0], [7, 0], [9, 0]],</span>
<a href="#l96.8"></a><span id="l96.8">              [[0, 0], [2, 0], [3, 0], [3, 0], [5, 0], [5, 0], [7, 0], [9, 0]],</span>
<a href="#l96.9"></a><span id="l96.9">              [[0, 0], [2, 0], [3, 0], [3, 0], [5, 0], [5, 0], [7, 0], [9, 0]],</span>
<a href="#l96.10"></a><span id="l96.10">              [[0, 0], [2, 0], [3, 0], [3, 0], [5, 0], [5, 0], [7, 0], [8, 0]],</span>
<a href="#l96.11"></a><span id="l96.11">              [[0, 0], [2, 0], [3, 0], [3, 0], [5, 0], [6, 0], [7, 0], [8, 0]],</span>
<a href="#l96.12"></a><span id="l96.12" class="difflineminus">-             [[0, 0], [1, 0], [2, 0], [3, 0], [4, 0], [5, 0], [6, 0], [7, 0]]]</span>
<a href="#l96.13"></a><span id="l96.13" class="difflineplus">+             [[0, 0], [1, 0], [2, 0], [3, 0], [4, 0], [5, 0], [6, 0], [7, 0]]];</span>
<a href="#l96.14"></a><span id="l96.14"> </span>
<a href="#l96.15"></a><span id="l96.15"> var setupModule = function(module) {</span>
<a href="#l96.16"></a><span id="l96.16">   controller = mozmill.getMail3PaneController();</span>
<a href="#l96.17"></a><span id="l96.17" class="difflineminus">-}</span>
<a href="#l96.18"></a><span id="l96.18" class="difflineplus">+};</span>
<a href="#l96.19"></a><span id="l96.19"> </span>
<a href="#l96.20"></a><span id="l96.20"> var testTimezones6_checkLosAngeles = function() {</span>
<a href="#l96.21"></a><span id="l96.21">   let eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l96.22"></a><span id="l96.22"> </span>
<a href="#l96.23"></a><span id="l96.23">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l96.24"></a><span id="l96.24">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l96.25"></a><span id="l96.25">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l96.26"></a><span id="l96.26"> </span>
<a href="#l96.27"></a><span id="l96.27">   timezoneUtils.verify(controller, dates, timezones, times);</span>
<a href="#l96.28"></a><span id="l96.28" class="difflineminus">-}</span>
<a href="#l96.29"></a><span id="l96.29" class="difflineplus">+};</span>
<a href="#l96.30"></a><span id="l96.30"> </span>
<a href="#l96.31"></a><span id="l96.31"> var teardownTest = function(module) {</span>
<a href="#l96.32"></a><span id="l96.32">   timezoneUtils.switchAppTimezone(timezones[4]);</span>
<a href="#l96.33"></a><span id="l96.33" class="difflineminus">-}</span>
<a href="#l96.34"></a><span id="l96.34" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l97.1"></a><span id="l97.1" class="difflineminus">--- a/calendar/test/mozmill/timezoneTests/test7.js</span>
<a href="#l97.2"></a><span id="l97.2" class="difflineplus">+++ b/calendar/test/mozmill/timezoneTests/test7.js</span>
<a href="#l97.3"></a><span id="l97.3" class="difflineat">@@ -15,27 +15,27 @@ var timezones = [&quot;America/St_Johns&quot;, &quot;Am</span>
<a href="#l97.4"></a><span id="l97.4">    columns - correct time for each event */</span>
<a href="#l97.5"></a><span id="l97.5"> var times = [[[5, 0], [6, 0], [7, 0], [8, 0], [9, 0], [10, 0], [11, 0], [12, 0]],</span>
<a href="#l97.6"></a><span id="l97.6">              [[4, 0], [6, 0], [7, 0], [7, 0], [9, 0], [9, 0], [11, 0], [12, 0]],</span>
<a href="#l97.7"></a><span id="l97.7">              [[4, 0], [6, 0], [7, 0], [7, 0], [9, 0], [9, 0], [11, 0], [13, 0]],</span>
<a href="#l97.8"></a><span id="l97.8">              [[4, 0], [6, 0], [7, 0], [7, 0], [9, 0], [9, 0], [11, 0], [13, 0]],</span>
<a href="#l97.9"></a><span id="l97.9">              [[4, 0], [6, 0], [7, 0], [7, 0], [9, 0], [9, 0], [11, 0], [13, 0]],</span>
<a href="#l97.10"></a><span id="l97.10">              [[4, 0], [6, 0], [7, 0], [7, 0], [9, 0], [9, 0], [11, 0], [12, 0]],</span>
<a href="#l97.11"></a><span id="l97.11">              [[4, 0], [6, 0], [7, 0], [7, 0], [9, 0], [10, 0], [11, 0], [12, 0]],</span>
<a href="#l97.12"></a><span id="l97.12" class="difflineminus">-             [[5, 0], [6, 0], [7, 0], [8, 0], [9, 0], [10, 0], [11, 0], [12, 0]]]</span>
<a href="#l97.13"></a><span id="l97.13" class="difflineplus">+             [[5, 0], [6, 0], [7, 0], [8, 0], [9, 0], [10, 0], [11, 0], [12, 0]]];</span>
<a href="#l97.14"></a><span id="l97.14"> </span>
<a href="#l97.15"></a><span id="l97.15"> var setupModule = function(module) {</span>
<a href="#l97.16"></a><span id="l97.16">   controller = mozmill.getMail3PaneController();</span>
<a href="#l97.17"></a><span id="l97.17" class="difflineminus">-}</span>
<a href="#l97.18"></a><span id="l97.18" class="difflineplus">+};</span>
<a href="#l97.19"></a><span id="l97.19"> </span>
<a href="#l97.20"></a><span id="l97.20"> var testTimezones7_checkBuenosAires = function() {</span>
<a href="#l97.21"></a><span id="l97.21">   let eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l97.22"></a><span id="l97.22"> </span>
<a href="#l97.23"></a><span id="l97.23">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l97.24"></a><span id="l97.24">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l97.25"></a><span id="l97.25">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l97.26"></a><span id="l97.26"> </span>
<a href="#l97.27"></a><span id="l97.27">   timezoneUtils.verify(controller, dates, timezones, times);</span>
<a href="#l97.28"></a><span id="l97.28" class="difflineminus">-}</span>
<a href="#l97.29"></a><span id="l97.29" class="difflineplus">+};</span>
<a href="#l97.30"></a><span id="l97.30"> </span>
<a href="#l97.31"></a><span id="l97.31"> var teardownTest = function(module) {</span>
<a href="#l97.32"></a><span id="l97.32">   timezoneUtils.switchAppTimezone(timezones[5]);</span>
<a href="#l97.33"></a><span id="l97.33" class="difflineminus">-}</span>
<a href="#l97.34"></a><span id="l97.34" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l98.1"></a><span id="l98.1" class="difflineminus">--- a/calendar/test/mozmill/timezoneTests/test8.js</span>
<a href="#l98.2"></a><span id="l98.2" class="difflineplus">+++ b/calendar/test/mozmill/timezoneTests/test8.js</span>
<a href="#l98.3"></a><span id="l98.3" class="difflineat">@@ -15,27 +15,27 @@ var timezones = [&quot;America/St_Johns&quot;, &quot;Am</span>
<a href="#l98.4"></a><span id="l98.4">    columns - correct time for each event */</span>
<a href="#l98.5"></a><span id="l98.5"> var times = [[[9, 0], [10, 0], [11, 0], [12, 0], [13, 0], [14, 0], [15, 0], [16, 0]],</span>
<a href="#l98.6"></a><span id="l98.6">              [[9, 0], [11, 0], [12, 0], [12, 0], [14, 0], [14, 0], [16, 0], [17, 0]],</span>
<a href="#l98.7"></a><span id="l98.7">              [[9, 0], [11, 0], [12, 0], [12, 0], [14, 0], [14, 0], [16, 0], [18, 0]],</span>
<a href="#l98.8"></a><span id="l98.8">              [[9, 0], [11, 0], [12, 0], [12, 0], [14, 0], [14, 0], [16, 0], [18, 0]],</span>
<a href="#l98.9"></a><span id="l98.9">              [[9, 0], [11, 0], [12, 0], [12, 0], [14, 0], [14, 0], [16, 0], [18, 0]],</span>
<a href="#l98.10"></a><span id="l98.10">              [[9, 0], [11, 0], [12, 0], [12, 0], [14, 0], [14, 0], [16, 0], [17, 0]],</span>
<a href="#l98.11"></a><span id="l98.11">              [[8, 0], [10, 0], [11, 0], [11, 0], [13, 0], [14, 0], [15, 0], [16, 0]],</span>
<a href="#l98.12"></a><span id="l98.12" class="difflineminus">-             [[9, 0], [10, 0], [11, 0], [12, 0], [13, 0], [14, 0], [15, 0], [16, 0]]]</span>
<a href="#l98.13"></a><span id="l98.13" class="difflineplus">+             [[9, 0], [10, 0], [11, 0], [12, 0], [13, 0], [14, 0], [15, 0], [16, 0]]];</span>
<a href="#l98.14"></a><span id="l98.14"> </span>
<a href="#l98.15"></a><span id="l98.15"> var setupModule = function(module) {</span>
<a href="#l98.16"></a><span id="l98.16">   controller = mozmill.getMail3PaneController();</span>
<a href="#l98.17"></a><span id="l98.17" class="difflineminus">-}</span>
<a href="#l98.18"></a><span id="l98.18" class="difflineplus">+};</span>
<a href="#l98.19"></a><span id="l98.19"> </span>
<a href="#l98.20"></a><span id="l98.20"> var testTimezones8_checkParis = function() {</span>
<a href="#l98.21"></a><span id="l98.21">   let eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l98.22"></a><span id="l98.22"> </span>
<a href="#l98.23"></a><span id="l98.23">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l98.24"></a><span id="l98.24">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l98.25"></a><span id="l98.25">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l98.26"></a><span id="l98.26"> </span>
<a href="#l98.27"></a><span id="l98.27">   timezoneUtils.verify(controller, dates, timezones, times);</span>
<a href="#l98.28"></a><span id="l98.28" class="difflineminus">-}</span>
<a href="#l98.29"></a><span id="l98.29" class="difflineplus">+};</span>
<a href="#l98.30"></a><span id="l98.30"> </span>
<a href="#l98.31"></a><span id="l98.31"> var teardownTest = function(module) {</span>
<a href="#l98.32"></a><span id="l98.32">   timezoneUtils.switchAppTimezone(timezones[6]);</span>
<a href="#l98.33"></a><span id="l98.33" class="difflineminus">-}</span>
<a href="#l98.34"></a><span id="l98.34" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l99.1"></a><span id="l99.1" class="difflineminus">--- a/calendar/test/mozmill/timezoneTests/test9.js</span>
<a href="#l99.2"></a><span id="l99.2" class="difflineplus">+++ b/calendar/test/mozmill/timezoneTests/test9.js</span>
<a href="#l99.3"></a><span id="l99.3" class="difflineat">@@ -15,27 +15,27 @@ var timezones = [&quot;America/St_Johns&quot;, &quot;Am</span>
<a href="#l99.4"></a><span id="l99.4">    columns - correct time for each event */</span>
<a href="#l99.5"></a><span id="l99.5"> var times = [[[13, 45], [14, 45], [15, 45], [16, 45], [17, 45], [18, 45], [19, 45], [20, 45]],</span>
<a href="#l99.6"></a><span id="l99.6">              [[12, 45], [14, 45], [15, 45], [15, 45], [17, 45], [17, 45], [19, 45], [20, 45]],</span>
<a href="#l99.7"></a><span id="l99.7">              [[12, 45], [14, 45], [15, 45], [15, 45], [17, 45], [17, 45], [19, 45], [21, 45]],</span>
<a href="#l99.8"></a><span id="l99.8">              [[12, 45], [14, 45], [15, 45], [15, 45], [17, 45], [17, 45], [19, 45], [21, 45]],</span>
<a href="#l99.9"></a><span id="l99.9">              [[12, 45], [14, 45], [15, 45], [15, 45], [17, 45], [17, 45], [19, 45], [21, 45]],</span>
<a href="#l99.10"></a><span id="l99.10">              [[12, 45], [14, 45], [15, 45], [15, 45], [17, 45], [17, 45], [19, 45], [20, 45]],</span>
<a href="#l99.11"></a><span id="l99.11">              [[12, 45], [14, 45], [15, 45], [15, 45], [17, 45], [18, 45], [19, 45], [20, 45]],</span>
<a href="#l99.12"></a><span id="l99.12" class="difflineminus">-             [[13, 45], [14, 45], [15, 45], [16, 45], [17, 45], [18, 45], [19, 45], [20, 45]]]</span>
<a href="#l99.13"></a><span id="l99.13" class="difflineplus">+             [[13, 45], [14, 45], [15, 45], [16, 45], [17, 45], [18, 45], [19, 45], [20, 45]]];</span>
<a href="#l99.14"></a><span id="l99.14"> </span>
<a href="#l99.15"></a><span id="l99.15"> var setupModule = function(module) {</span>
<a href="#l99.16"></a><span id="l99.16">   controller = mozmill.getMail3PaneController();</span>
<a href="#l99.17"></a><span id="l99.17" class="difflineminus">-}</span>
<a href="#l99.18"></a><span id="l99.18" class="difflineplus">+};</span>
<a href="#l99.19"></a><span id="l99.19"> </span>
<a href="#l99.20"></a><span id="l99.20"> var testTimezones9_checkKathmandu = function() {</span>
<a href="#l99.21"></a><span id="l99.21">   let eventPath = '/{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}';</span>
<a href="#l99.22"></a><span id="l99.22"> </span>
<a href="#l99.23"></a><span id="l99.23">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-tab-button&quot;));</span>
<a href="#l99.24"></a><span id="l99.24">   calUtils.switchToView(controller, &quot;day&quot;);</span>
<a href="#l99.25"></a><span id="l99.25">   calUtils.goToDate(controller, 2009, 1, 1);</span>
<a href="#l99.26"></a><span id="l99.26"> </span>
<a href="#l99.27"></a><span id="l99.27">   timezoneUtils.verify(controller, dates, timezones, times);</span>
<a href="#l99.28"></a><span id="l99.28" class="difflineminus">-}</span>
<a href="#l99.29"></a><span id="l99.29" class="difflineplus">+};</span>
<a href="#l99.30"></a><span id="l99.30"> </span>
<a href="#l99.31"></a><span id="l99.31"> var teardownTest = function(module) {</span>
<a href="#l99.32"></a><span id="l99.32">   timezoneUtils.switchAppTimezone(timezones[7]);</span>
<a href="#l99.33"></a><span id="l99.33" class="difflineminus">-}</span>
<a href="#l99.34"></a><span id="l99.34" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l100.1"></a><span id="l100.1" class="difflineminus">--- a/calendar/test/mozmill/views/testDayView.js</span>
<a href="#l100.2"></a><span id="l100.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testDayView.js</span>
<a href="#l100.3"></a><span id="l100.3" class="difflineat">@@ -8,17 +8,17 @@ var sleep = 500;</span>
<a href="#l100.4"></a><span id="l100.4"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l100.5"></a><span id="l100.5"> var title1 = &quot;Day View Event&quot;;</span>
<a href="#l100.6"></a><span id="l100.6"> var title2 = &quot;Day View Event Changed&quot;;</span>
<a href="#l100.7"></a><span id="l100.7"> var desc = &quot;Day View Event Description&quot;;</span>
<a href="#l100.8"></a><span id="l100.8"> </span>
<a href="#l100.9"></a><span id="l100.9"> var setupModule = function(module) {</span>
<a href="#l100.10"></a><span id="l100.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l100.11"></a><span id="l100.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l100.12"></a><span id="l100.12" class="difflineminus">-}</span>
<a href="#l100.13"></a><span id="l100.13" class="difflineplus">+};</span>
<a href="#l100.14"></a><span id="l100.14"> </span>
<a href="#l100.15"></a><span id="l100.15"> var testDayView = function() {</span>
<a href="#l100.16"></a><span id="l100.16">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l100.17"></a><span id="l100.17">                               .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l100.18"></a><span id="l100.18">   // paths</span>
<a href="#l100.19"></a><span id="l100.19">   let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l100.20"></a><span id="l100.20">     + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/'</span>
<a href="#l100.21"></a><span id="l100.21">     + 'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l100.22"></a><span id="l100.22" class="difflineat">@@ -48,24 +48,24 @@ var testDayView = function() {</span>
<a href="#l100.23"></a><span id="l100.23">     + 'anon({&quot;anonid&quot;:&quot;minimonth-header&quot;})/anon({&quot;anonid&quot;:&quot;minmonth-popupset&quot;})/'</span>
<a href="#l100.24"></a><span id="l100.24">     + 'anon({&quot;anonid&quot;:&quot;months-popup&quot;})/[0]/{&quot;index&quot;:&quot;0&quot;}'));</span>
<a href="#l100.25"></a><span id="l100.25"> </span>
<a href="#l100.26"></a><span id="l100.26">   // pick day</span>
<a href="#l100.27"></a><span id="l100.27">   controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l100.28"></a><span id="l100.28">     + 'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l100.29"></a><span id="l100.29"> </span>
<a href="#l100.30"></a><span id="l100.30">   // verify date in view</span>
<a href="#l100.31"></a><span id="l100.31" class="difflineminus">-  controller.waitFor(function() {return day.getNode().mDate.icalString == &quot;20090101&quot;});</span>
<a href="#l100.32"></a><span id="l100.32" class="difflineplus">+  controller.waitFor(function() {return day.getNode().mDate.icalString == &quot;20090101&quot;;});</span>
<a href="#l100.33"></a><span id="l100.33"> </span>
<a href="#l100.34"></a><span id="l100.34">   // create event at 8 AM</span>
<a href="#l100.35"></a><span id="l100.35">   controller.doubleClick(new elementslib.Lookup(controller.window.document, dayView</span>
<a href="#l100.36"></a><span id="l100.36">     + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l100.37"></a><span id="l100.37">     + '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/'</span>
<a href="#l100.38"></a><span id="l100.38">     + 'anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[8]'), 1, 1);</span>
<a href="#l100.39"></a><span id="l100.39" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l100.40"></a><span id="l100.40" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l100.41"></a><span id="l100.41">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l100.42"></a><span id="l100.42"> </span>
<a href="#l100.43"></a><span id="l100.43">   // check that the start time is correct</span>
<a href="#l100.44"></a><span id="l100.44">   let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l100.45"></a><span id="l100.45">     + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l100.46"></a><span id="l100.46">     + 'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/'</span>
<a href="#l100.47"></a><span id="l100.47">     + 'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/'</span>
<a href="#l100.48"></a><span id="l100.48">     + 'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l100.49"></a><span id="l100.49" class="difflineat">@@ -98,17 +98,17 @@ var testDayView = function() {</span>
<a href="#l100.50"></a><span id="l100.50">   // if it was created successfully, it can be opened</span>
<a href="#l100.51"></a><span id="l100.51">   let eventBox = new elementslib.Lookup(controller.window.document, dayView</span>
<a href="#l100.52"></a><span id="l100.52">     + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l100.53"></a><span id="l100.53">     + '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/'</span>
<a href="#l100.54"></a><span id="l100.54">     + 'anon({&quot;anonid&quot;:&quot;topbox&quot;})/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/[0]/'</span>
<a href="#l100.55"></a><span id="l100.55">     + '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}');</span>
<a href="#l100.56"></a><span id="l100.56">   controller.waitForElement(eventBox);</span>
<a href="#l100.57"></a><span id="l100.57">   controller.doubleClick(eventBox);</span>
<a href="#l100.58"></a><span id="l100.58" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l100.59"></a><span id="l100.59" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l100.60"></a><span id="l100.60">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l100.61"></a><span id="l100.61"> </span>
<a href="#l100.62"></a><span id="l100.62">   // change title and save changes</span>
<a href="#l100.63"></a><span id="l100.63">   let titleTextBox = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l100.64"></a><span id="l100.64">     + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l100.65"></a><span id="l100.65">     + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l100.66"></a><span id="l100.66">   event.waitForElement(titleTextBox);</span>
<a href="#l100.67"></a><span id="l100.67">   event.type(titleTextBox, title2);</span>
<a href="#l100.68"></a><span id="l100.68" class="difflineat">@@ -133,13 +133,13 @@ var testDayView = function() {</span>
<a href="#l100.69"></a><span id="l100.69">     + '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}'));</span>
<a href="#l100.70"></a><span id="l100.70">   controller.keypress(new elementslib.ID(controller.window.document, &quot;day-view&quot;),</span>
<a href="#l100.71"></a><span id="l100.71">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l100.72"></a><span id="l100.72">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, dayView</span>
<a href="#l100.73"></a><span id="l100.73">     + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l100.74"></a><span id="l100.74">     + '{&quot;class&quot;:&quot;calendar-event-column-even&quot;}/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/'</span>
<a href="#l100.75"></a><span id="l100.75">     + 'anon({&quot;anonid&quot;:&quot;topbox&quot;})/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/{&quot;flex&quot;:&quot;1&quot;}/'</span>
<a href="#l100.76"></a><span id="l100.76">     + '{&quot;tooltip&quot;:&quot;itemTooltip&quot;,&quot;calendar&quot;:&quot;' + calendar.toLowerCase() + '&quot;}'));</span>
<a href="#l100.77"></a><span id="l100.77" class="difflineminus">-}</span>
<a href="#l100.78"></a><span id="l100.78" class="difflineplus">+};</span>
<a href="#l100.79"></a><span id="l100.79"> </span>
<a href="#l100.80"></a><span id="l100.80"> var teardownTest = function(module) {</span>
<a href="#l100.81"></a><span id="l100.81">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l100.82"></a><span id="l100.82" class="difflineminus">-}</span>
<a href="#l100.83"></a><span id="l100.83" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l101.1"></a><span id="l101.1" class="difflineminus">--- a/calendar/test/mozmill/views/testMonthView.js</span>
<a href="#l101.2"></a><span id="l101.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testMonthView.js</span>
<a href="#l101.3"></a><span id="l101.3" class="difflineat">@@ -8,17 +8,17 @@ var sleep = 500;</span>
<a href="#l101.4"></a><span id="l101.4"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l101.5"></a><span id="l101.5"> var title1 = &quot;Month View Event&quot;;</span>
<a href="#l101.6"></a><span id="l101.6"> var title2 = &quot;Month View Event Changed&quot;;</span>
<a href="#l101.7"></a><span id="l101.7"> var desc = &quot;Month View Event Description&quot;;</span>
<a href="#l101.8"></a><span id="l101.8"> </span>
<a href="#l101.9"></a><span id="l101.9"> var setupModule = function(module) {</span>
<a href="#l101.10"></a><span id="l101.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l101.11"></a><span id="l101.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l101.12"></a><span id="l101.12" class="difflineminus">-}</span>
<a href="#l101.13"></a><span id="l101.13" class="difflineplus">+};</span>
<a href="#l101.14"></a><span id="l101.14"> </span>
<a href="#l101.15"></a><span id="l101.15"> var testMonthView = function() {</span>
<a href="#l101.16"></a><span id="l101.16">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l101.17"></a><span id="l101.17">                               .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l101.18"></a><span id="l101.18">   // paths</span>
<a href="#l101.19"></a><span id="l101.19">   let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l101.20"></a><span id="l101.20">     + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/'</span>
<a href="#l101.21"></a><span id="l101.21">     + 'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l101.22"></a><span id="l101.22" class="difflineat">@@ -52,25 +52,25 @@ var testMonthView = function() {</span>
<a href="#l101.23"></a><span id="l101.23">   // pick day</span>
<a href="#l101.24"></a><span id="l101.24">   controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l101.25"></a><span id="l101.25">     + 'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l101.26"></a><span id="l101.26"> </span>
<a href="#l101.27"></a><span id="l101.27">   // verify date</span>
<a href="#l101.28"></a><span id="l101.28">   let day = new elementslib.Lookup(controller.window.document, monthView</span>
<a href="#l101.29"></a><span id="l101.29">     + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/'</span>
<a href="#l101.30"></a><span id="l101.30">     + '[0]/{&quot;selected&quot;:&quot;true&quot;}');</span>
<a href="#l101.31"></a><span id="l101.31" class="difflineminus">-  controller.waitFor(function() {return day.getNode().mDate.icalString == &quot;20090101&quot;});</span>
<a href="#l101.32"></a><span id="l101.32" class="difflineplus">+  controller.waitFor(function() {return day.getNode().mDate.icalString == &quot;20090101&quot;;});</span>
<a href="#l101.33"></a><span id="l101.33"> </span>
<a href="#l101.34"></a><span id="l101.34">   // create event</span>
<a href="#l101.35"></a><span id="l101.35">   // Thursday of 2009-01-01 should be the selected box in the first row with default settings</span>
<a href="#l101.36"></a><span id="l101.36">   let hour = new Date().getHours(); // remember time at click</span>
<a href="#l101.37"></a><span id="l101.37">   controller.doubleClick(new elementslib.Lookup(controller.window.document, monthView</span>
<a href="#l101.38"></a><span id="l101.38">     + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/'</span>
<a href="#l101.39"></a><span id="l101.39">     + '[0]/{&quot;selected&quot;:&quot;true&quot;}/anon({&quot;anonid&quot;:&quot;day-items&quot;})'));</span>
<a href="#l101.40"></a><span id="l101.40" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l101.41"></a><span id="l101.41" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l101.42"></a><span id="l101.42">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l101.43"></a><span id="l101.43"> </span>
<a href="#l101.44"></a><span id="l101.44">   // check that the start time is correct</span>
<a href="#l101.45"></a><span id="l101.45">   // next full hour except last hour hour of the day</span>
<a href="#l101.46"></a><span id="l101.46">   let nextHour = (hour == 23) ? hour : (hour + 1) % 24;</span>
<a href="#l101.47"></a><span id="l101.47">   let startTime = nextHour + ':00'; // next full hour</span>
<a href="#l101.48"></a><span id="l101.48">   let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l101.49"></a><span id="l101.49">     + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l101.50"></a><span id="l101.50" class="difflineat">@@ -104,17 +104,17 @@ var testMonthView = function() {</span>
<a href="#l101.51"></a><span id="l101.51">     + '[0]/{&quot;label&quot;:&quot;' + calendar + '&quot;}'));</span>
<a href="#l101.52"></a><span id="l101.52"> </span>
<a href="#l101.53"></a><span id="l101.53">   // save</span>
<a href="#l101.54"></a><span id="l101.54">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l101.55"></a><span id="l101.55"> </span>
<a href="#l101.56"></a><span id="l101.56">   // if it was created successfully, it can be opened</span>
<a href="#l101.57"></a><span id="l101.57">   controller.waitForElement(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l101.58"></a><span id="l101.58">   controller.doubleClick(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l101.59"></a><span id="l101.59" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l101.60"></a><span id="l101.60" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l101.61"></a><span id="l101.61">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l101.62"></a><span id="l101.62"> </span>
<a href="#l101.63"></a><span id="l101.63">   // change title and save changes</span>
<a href="#l101.64"></a><span id="l101.64">   let titleTextBox = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l101.65"></a><span id="l101.65">     + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l101.66"></a><span id="l101.66">     + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l101.67"></a><span id="l101.67">   event.waitForElement(titleTextBox);</span>
<a href="#l101.68"></a><span id="l101.68">   event.type(titleTextBox, title2);</span>
<a href="#l101.69"></a><span id="l101.69" class="difflineat">@@ -126,13 +126,13 @@ var testMonthView = function() {</span>
<a href="#l101.70"></a><span id="l101.70">   controller.waitForElement(eventName);</span>
<a href="#l101.71"></a><span id="l101.71">   controller.assertValue(eventName, title2);</span>
<a href="#l101.72"></a><span id="l101.72"> </span>
<a href="#l101.73"></a><span id="l101.73">   // delete event</span>
<a href="#l101.74"></a><span id="l101.74">   controller.click(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l101.75"></a><span id="l101.75">   controller.keypress(new elementslib.ID(controller.window.document, &quot;month-view&quot;),</span>
<a href="#l101.76"></a><span id="l101.76">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l101.77"></a><span id="l101.77">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l101.78"></a><span id="l101.78" class="difflineminus">-}</span>
<a href="#l101.79"></a><span id="l101.79" class="difflineplus">+};</span>
<a href="#l101.80"></a><span id="l101.80"> </span>
<a href="#l101.81"></a><span id="l101.81"> var teardownTest = function(module) {</span>
<a href="#l101.82"></a><span id="l101.82">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l101.83"></a><span id="l101.83" class="difflineminus">-}</span>
<a href="#l101.84"></a><span id="l101.84" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l102.1"></a><span id="l102.1" class="difflineminus">--- a/calendar/test/mozmill/views/testMultiweekView.js</span>
<a href="#l102.2"></a><span id="l102.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testMultiweekView.js</span>
<a href="#l102.3"></a><span id="l102.3" class="difflineat">@@ -8,17 +8,17 @@ var sleep = 500;</span>
<a href="#l102.4"></a><span id="l102.4"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l102.5"></a><span id="l102.5"> var title1 = &quot;Multiweek View Event&quot;;</span>
<a href="#l102.6"></a><span id="l102.6"> var title2 = &quot;Multiweek View Event Changed&quot;;</span>
<a href="#l102.7"></a><span id="l102.7"> var desc = &quot;Multiweek View Event Description&quot;;</span>
<a href="#l102.8"></a><span id="l102.8"> </span>
<a href="#l102.9"></a><span id="l102.9"> var setupModule = function(module) {</span>
<a href="#l102.10"></a><span id="l102.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l102.11"></a><span id="l102.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l102.12"></a><span id="l102.12" class="difflineminus">-}</span>
<a href="#l102.13"></a><span id="l102.13" class="difflineplus">+};</span>
<a href="#l102.14"></a><span id="l102.14"> </span>
<a href="#l102.15"></a><span id="l102.15"> var testMultiWeekView = function() {</span>
<a href="#l102.16"></a><span id="l102.16">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l102.17"></a><span id="l102.17">                               .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l102.18"></a><span id="l102.18">   // paths</span>
<a href="#l102.19"></a><span id="l102.19">   let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l102.20"></a><span id="l102.20">     + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/'</span>
<a href="#l102.21"></a><span id="l102.21">     + 'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l102.22"></a><span id="l102.22" class="difflineat">@@ -52,25 +52,25 @@ var testMultiWeekView = function() {</span>
<a href="#l102.23"></a><span id="l102.23">   // pick day</span>
<a href="#l102.24"></a><span id="l102.24">   controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l102.25"></a><span id="l102.25">     + 'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l102.26"></a><span id="l102.26"> </span>
<a href="#l102.27"></a><span id="l102.27">   // verify date</span>
<a href="#l102.28"></a><span id="l102.28">   let day = new elementslib.Lookup(controller.window.document, multiWeekView</span>
<a href="#l102.29"></a><span id="l102.29">     + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/'</span>
<a href="#l102.30"></a><span id="l102.30">     + '[0]/{&quot;selected&quot;:&quot;true&quot;}');</span>
<a href="#l102.31"></a><span id="l102.31" class="difflineminus">-  controller.waitFor(function() {return day.getNode().mDate.icalString == &quot;20090101&quot;});</span>
<a href="#l102.32"></a><span id="l102.32" class="difflineplus">+  controller.waitFor(function() {return day.getNode().mDate.icalString == &quot;20090101&quot;;});</span>
<a href="#l102.33"></a><span id="l102.33"> </span>
<a href="#l102.34"></a><span id="l102.34">   // create event</span>
<a href="#l102.35"></a><span id="l102.35">   // Thursday of 2009-01-01 should be the selected box in the first row with default settings</span>
<a href="#l102.36"></a><span id="l102.36">   let hour = new Date().getHours(); // remember time at click</span>
<a href="#l102.37"></a><span id="l102.37">   controller.doubleClick(new elementslib.Lookup(controller.window.document, multiWeekView</span>
<a href="#l102.38"></a><span id="l102.38">     + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;monthgrid&quot;})/anon({&quot;anonid&quot;:&quot;monthgridrows&quot;})/'</span>
<a href="#l102.39"></a><span id="l102.39">     + '[0]/{&quot;selected&quot;:&quot;true&quot;}/anon({&quot;anonid&quot;:&quot;day-items&quot;})'));</span>
<a href="#l102.40"></a><span id="l102.40" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l102.41"></a><span id="l102.41" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l102.42"></a><span id="l102.42">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l102.43"></a><span id="l102.43"> </span>
<a href="#l102.44"></a><span id="l102.44">   // check that the start time is correct</span>
<a href="#l102.45"></a><span id="l102.45">   // next full hour except last hour hour of the day</span>
<a href="#l102.46"></a><span id="l102.46">   let nextHour = (hour == 23) ? hour : (hour + 1) % 24;</span>
<a href="#l102.47"></a><span id="l102.47">   let startTime = nextHour + ':00';</span>
<a href="#l102.48"></a><span id="l102.48">   let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l102.49"></a><span id="l102.49">     + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l102.50"></a><span id="l102.50" class="difflineat">@@ -104,17 +104,17 @@ var testMultiWeekView = function() {</span>
<a href="#l102.51"></a><span id="l102.51">     + '[0]/{&quot;label&quot;:&quot;' + calendar + '&quot;}'));</span>
<a href="#l102.52"></a><span id="l102.52"> </span>
<a href="#l102.53"></a><span id="l102.53">   // save</span>
<a href="#l102.54"></a><span id="l102.54">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l102.55"></a><span id="l102.55"> </span>
<a href="#l102.56"></a><span id="l102.56">   // if it was created successfully, it can be opened</span>
<a href="#l102.57"></a><span id="l102.57">   controller.waitForElement(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l102.58"></a><span id="l102.58">   controller.doubleClick(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l102.59"></a><span id="l102.59" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l102.60"></a><span id="l102.60" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l102.61"></a><span id="l102.61">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l102.62"></a><span id="l102.62"> </span>
<a href="#l102.63"></a><span id="l102.63">   // change title and save changes</span>
<a href="#l102.64"></a><span id="l102.64">   let titmeTextBox = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l102.65"></a><span id="l102.65">     + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l102.66"></a><span id="l102.66">     + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l102.67"></a><span id="l102.67">   event.waitForElement(titmeTextBox);</span>
<a href="#l102.68"></a><span id="l102.68">   event.type(titmeTextBox, title2);</span>
<a href="#l102.69"></a><span id="l102.69" class="difflineat">@@ -126,13 +126,13 @@ var testMultiWeekView = function() {</span>
<a href="#l102.70"></a><span id="l102.70">   controller.waitForElement(eventName);</span>
<a href="#l102.71"></a><span id="l102.71">   controller.assertValue(eventName, title2);</span>
<a href="#l102.72"></a><span id="l102.72"> </span>
<a href="#l102.73"></a><span id="l102.73">   // delete event</span>
<a href="#l102.74"></a><span id="l102.74">   controller.click(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l102.75"></a><span id="l102.75">   controller.keypress(new elementslib.ID(controller.window.document, &quot;multiweek-view&quot;),</span>
<a href="#l102.76"></a><span id="l102.76">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l102.77"></a><span id="l102.77">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l102.78"></a><span id="l102.78" class="difflineminus">-}</span>
<a href="#l102.79"></a><span id="l102.79" class="difflineplus">+};</span>
<a href="#l102.80"></a><span id="l102.80"> </span>
<a href="#l102.81"></a><span id="l102.81"> var teardownTest = function(module) {</span>
<a href="#l102.82"></a><span id="l102.82">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l102.83"></a><span id="l102.83" class="difflineminus">-}</span>
<a href="#l102.84"></a><span id="l102.84" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l103.1"></a><span id="l103.1" class="difflineminus">--- a/calendar/test/mozmill/views/testTaskView.js</span>
<a href="#l103.2"></a><span id="l103.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testTaskView.js</span>
<a href="#l103.3"></a><span id="l103.3" class="difflineat">@@ -9,17 +9,17 @@ var sleep = 500;</span>
<a href="#l103.4"></a><span id="l103.4"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l103.5"></a><span id="l103.5"> var title = &quot;Task&quot;;</span>
<a href="#l103.6"></a><span id="l103.6"> var description = &quot;1. Do A\n2. Do B&quot;;</span>
<a href="#l103.7"></a><span id="l103.7"> var percentComplete = &quot;50&quot;;</span>
<a href="#l103.8"></a><span id="l103.8"> </span>
<a href="#l103.9"></a><span id="l103.9"> var setupModule = function(module) {</span>
<a href="#l103.10"></a><span id="l103.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l103.11"></a><span id="l103.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l103.12"></a><span id="l103.12" class="difflineminus">-}</span>
<a href="#l103.13"></a><span id="l103.13" class="difflineplus">+};</span>
<a href="#l103.14"></a><span id="l103.14"> </span>
<a href="#l103.15"></a><span id="l103.15"> // mozmill doesn't support trees yet, therefore completed checkbox and line-through style are not</span>
<a href="#l103.16"></a><span id="l103.16"> // checked</span>
<a href="#l103.17"></a><span id="l103.17"> var testTaskView = function() {</span>
<a href="#l103.18"></a><span id="l103.18">   // paths</span>
<a href="#l103.19"></a><span id="l103.19">   let taskView = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l103.20"></a><span id="l103.20">     + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/'</span>
<a href="#l103.21"></a><span id="l103.21">     + 'id(&quot;calendarDisplayDeck&quot;)/id(&quot;calendar-task-box&quot;)/';</span>
<a href="#l103.22"></a><span id="l103.22" class="difflineat">@@ -70,23 +70,23 @@ var testTaskView = function() {</span>
<a href="#l103.23"></a><span id="l103.23">   // last added task is automatically selected so verify detail window data</span>
<a href="#l103.24"></a><span id="l103.24">   controller.assertJSProperty(new elementslib.ID(controller.window.document,</span>
<a href="#l103.25"></a><span id="l103.25">     &quot;calendar-task-details-title&quot;), &quot;textContent&quot;, title);</span>
<a href="#l103.26"></a><span id="l103.26"> </span>
<a href="#l103.27"></a><span id="l103.27">   // open added task</span>
<a href="#l103.28"></a><span id="l103.28">   // doubleclick on completion checkbox is ignored as opening action, so don't click at immediate</span>
<a href="#l103.29"></a><span id="l103.29">   // left where the checkbox is located</span>
<a href="#l103.30"></a><span id="l103.30">   controller.doubleClick(new elementslib.Lookup(controller.window.document, treeChildren), 50, 0);</span>
<a href="#l103.31"></a><span id="l103.31" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l103.32"></a><span id="l103.32" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l103.33"></a><span id="l103.33">   let task = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l103.34"></a><span id="l103.34"> </span>
<a href="#l103.35"></a><span id="l103.35">   // verify calendar</span>
<a href="#l103.36"></a><span id="l103.36">   task.waitForElement(new elementslib.Lookup(task.window.document, taskDialog</span>
<a href="#l103.37"></a><span id="l103.37">     + 'id(&quot;event-grid-category-color-row&quot;)/id(&quot;event-grid-category-box&quot;)/id(&quot;item-calendar&quot;)/[0]/'</span>
<a href="#l103.38"></a><span id="l103.38" class="difflineminus">-    + '{&quot;selected&quot;:&quot;true&quot;,&quot;label&quot;:&quot;' + calendar + '&quot;}'))</span>
<a href="#l103.39"></a><span id="l103.39" class="difflineplus">+    + '{&quot;selected&quot;:&quot;true&quot;,&quot;label&quot;:&quot;' + calendar + '&quot;}'));</span>
<a href="#l103.40"></a><span id="l103.40"> </span>
<a href="#l103.41"></a><span id="l103.41">   // add description, mark needs action and add percent complete</span>
<a href="#l103.42"></a><span id="l103.42">   task.type(new elementslib.Lookup(task.window.document, taskDialog</span>
<a href="#l103.43"></a><span id="l103.43">     + 'id(&quot;event-grid-description-row&quot;)/id(&quot;item-description&quot;)/'</span>
<a href="#l103.44"></a><span id="l103.44">     + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l103.45"></a><span id="l103.45">     description);</span>
<a href="#l103.46"></a><span id="l103.46">   task.click(new elementslib.ID(task.window.document, &quot;todo-status-needsaction-menuitem&quot;));</span>
<a href="#l103.47"></a><span id="l103.47"> </span>
<a href="#l103.48"></a><span id="l103.48" class="difflineat">@@ -99,17 +99,17 @@ var testTaskView = function() {</span>
<a href="#l103.49"></a><span id="l103.49">   task.type(new elementslib.Lookup(task.window.document, taskDialog</span>
<a href="#l103.50"></a><span id="l103.50">     + 'id(&quot;event-grid-todo-status-row&quot;)/id(&quot;event-grid-todo-status-picker-box&quot;)/'</span>
<a href="#l103.51"></a><span id="l103.51">     + 'id(&quot;percent-complete-textbox&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box numberbox-input-box&quot;})/'</span>
<a href="#l103.52"></a><span id="l103.52">     + 'anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l103.53"></a><span id="l103.53">     percentComplete);</span>
<a href="#l103.54"></a><span id="l103.54"> </span>
<a href="#l103.55"></a><span id="l103.55">   // save</span>
<a href="#l103.56"></a><span id="l103.56">   task.click(new elementslib.ID(task.window.document, &quot;button-save&quot;));</span>
<a href="#l103.57"></a><span id="l103.57" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0});</span>
<a href="#l103.58"></a><span id="l103.58" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length == 0;});</span>
<a href="#l103.59"></a><span id="l103.59"> </span>
<a href="#l103.60"></a><span id="l103.60">   // verify description and status in details pane</span>
<a href="#l103.61"></a><span id="l103.61">   controller.assertValue(new elementslib.Lookup(controller.window.document, taskView</span>
<a href="#l103.62"></a><span id="l103.62">     + '{&quot;flex&quot;:&quot;1&quot;}/id(&quot;calendar-task-details-container&quot;)/id(&quot;calendar-task-details-description&quot;)/'</span>
<a href="#l103.63"></a><span id="l103.63">     + 'anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})'),</span>
<a href="#l103.64"></a><span id="l103.64">     description);</span>
<a href="#l103.65"></a><span id="l103.65">   let status = utils.getProperty(&quot;chrome://calendar/locale/calendar.properties&quot;,</span>
<a href="#l103.66"></a><span id="l103.66">     &quot;taskDetailsStatusNeedsAction&quot;);</span>
<a href="#l103.67"></a><span id="l103.67" class="difflineat">@@ -152,13 +152,13 @@ var testTaskView = function() {</span>
<a href="#l103.68"></a><span id="l103.68">   toolTipNode.ownerDocument.defaultView.showToolTip(toolTipNode, taskTreeNode.getTaskAtRow(0));</span>
<a href="#l103.69"></a><span id="l103.69">   controller.assertJS(toolTipStatus.getNode().textContent.toLowerCase() == status.toLowerCase());</span>
<a href="#l103.70"></a><span id="l103.70"> </span>
<a href="#l103.71"></a><span id="l103.71">   // delete task, verify</span>
<a href="#l103.72"></a><span id="l103.72">   controller.click(new elementslib.ID(controller.window.document, &quot;task-context-menu-delete&quot;));</span>
<a href="#l103.73"></a><span id="l103.73">   controller.click(new elementslib.ID(controller.window.document, &quot;calendar-delete-task-button&quot;));</span>
<a href="#l103.74"></a><span id="l103.74">   let countAfterDelete = taskTreeNode.mTaskArray.length;</span>
<a href="#l103.75"></a><span id="l103.75">   controller.assertJS(countAfter - 1 == countAfterDelete);</span>
<a href="#l103.76"></a><span id="l103.76" class="difflineminus">-}</span>
<a href="#l103.77"></a><span id="l103.77" class="difflineplus">+};</span>
<a href="#l103.78"></a><span id="l103.78"> </span>
<a href="#l103.79"></a><span id="l103.79"> var teardownTest = function(module) {</span>
<a href="#l103.80"></a><span id="l103.80">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l103.81"></a><span id="l103.81" class="difflineminus">-}</span>
<a href="#l103.82"></a><span id="l103.82" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l104.1"></a><span id="l104.1" class="difflineminus">--- a/calendar/test/mozmill/views/testWeekView.js</span>
<a href="#l104.2"></a><span id="l104.2" class="difflineplus">+++ b/calendar/test/mozmill/views/testWeekView.js</span>
<a href="#l104.3"></a><span id="l104.3" class="difflineat">@@ -8,17 +8,17 @@ var sleep = 500;</span>
<a href="#l104.4"></a><span id="l104.4"> var calendar = &quot;Mozmill&quot;;</span>
<a href="#l104.5"></a><span id="l104.5"> var title1 = &quot;Week View Event&quot;;</span>
<a href="#l104.6"></a><span id="l104.6"> var title2 = &quot;Week View Event Changed&quot;;</span>
<a href="#l104.7"></a><span id="l104.7"> var desc = &quot;Week View Event Description&quot;;</span>
<a href="#l104.8"></a><span id="l104.8"> </span>
<a href="#l104.9"></a><span id="l104.9"> var setupModule = function(module) {</span>
<a href="#l104.10"></a><span id="l104.10">   controller = mozmill.getMail3PaneController();</span>
<a href="#l104.11"></a><span id="l104.11">   calUtils.createCalendar(controller, calendar);</span>
<a href="#l104.12"></a><span id="l104.12" class="difflineminus">-}</span>
<a href="#l104.13"></a><span id="l104.13" class="difflineplus">+};</span>
<a href="#l104.14"></a><span id="l104.14"> </span>
<a href="#l104.15"></a><span id="l104.15"> var testWeekView = function() {</span>
<a href="#l104.16"></a><span id="l104.16">   let dateService = Components.classes[&quot;@mozilla.org/intl/scriptabledateformat;1&quot;]</span>
<a href="#l104.17"></a><span id="l104.17">                               .getService(Components.interfaces.nsIScriptableDateFormat);</span>
<a href="#l104.18"></a><span id="l104.18">   // paths</span>
<a href="#l104.19"></a><span id="l104.19">   let miniMonth = '/id(&quot;messengerWindow&quot;)/id(&quot;tabmail-container&quot;)/id(&quot;tabmail&quot;)/'</span>
<a href="#l104.20"></a><span id="l104.20">     + 'id(&quot;tabpanelcontainer&quot;)/id(&quot;calendarTabPanel&quot;)/id(&quot;calendarContent&quot;)/id(&quot;ltnSidebar&quot;)/'</span>
<a href="#l104.21"></a><span id="l104.21">     + 'id(&quot;minimonth-pane&quot;)/{&quot;align&quot;:&quot;center&quot;}/id(&quot;calMinimonthBox&quot;)/id(&quot;calMinimonth&quot;)/';</span>
<a href="#l104.22"></a><span id="l104.22" class="difflineat">@@ -51,24 +51,24 @@ var testWeekView = function() {</span>
<a href="#l104.23"></a><span id="l104.23">   // pick day</span>
<a href="#l104.24"></a><span id="l104.24">   controller.waitThenClick(new elementslib.Lookup(controller.window.document, miniMonth</span>
<a href="#l104.25"></a><span id="l104.25">     + 'anon({&quot;anonid&quot;:&quot;minimonth-calendar&quot;})/[1]/{&quot;value&quot;:&quot;1&quot;}'));</span>
<a href="#l104.26"></a><span id="l104.26"> </span>
<a href="#l104.27"></a><span id="l104.27">   // verify date</span>
<a href="#l104.28"></a><span id="l104.28">   let day = new elementslib.Lookup(controller.window.document, weekView</span>
<a href="#l104.29"></a><span id="l104.29">     + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;labelbox&quot;})/anon({&quot;anonid&quot;:&quot;labeldaybox&quot;})/'</span>
<a href="#l104.30"></a><span id="l104.30">     + '{&quot;selected&quot;:&quot;true&quot;}');</span>
<a href="#l104.31"></a><span id="l104.31" class="difflineminus">-  controller.waitFor(function() {return day.getNode().mDate.icalString == &quot;20090101&quot;});</span>
<a href="#l104.32"></a><span id="l104.32" class="difflineplus">+  controller.waitFor(function() {return day.getNode().mDate.icalString == &quot;20090101&quot;;});</span>
<a href="#l104.33"></a><span id="l104.33"> </span>
<a href="#l104.34"></a><span id="l104.34">   // create event at 8 AM</span>
<a href="#l104.35"></a><span id="l104.35">   // Thursday of 2009-01-01 is 4th with default settings</span>
<a href="#l104.36"></a><span id="l104.36">   controller.doubleClick(new elementslib.Lookup(controller.window.document, weekView</span>
<a href="#l104.37"></a><span id="l104.37">     + 'anon({&quot;anonid&quot;:&quot;mainbox&quot;})/anon({&quot;anonid&quot;:&quot;scrollbox&quot;})/anon({&quot;anonid&quot;:&quot;daybox&quot;})/'</span>
<a href="#l104.38"></a><span id="l104.38">     + '[4]/anon({&quot;anonid&quot;:&quot;boxstack&quot;})/anon({&quot;anonid&quot;:&quot;bgbox&quot;})/[8]'), 1, 1);</span>
<a href="#l104.39"></a><span id="l104.39" class="difflineminus">-  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l104.40"></a><span id="l104.40" class="difflineplus">+  controller.waitFor(function() {return mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l104.41"></a><span id="l104.41">   let event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l104.42"></a><span id="l104.42"> </span>
<a href="#l104.43"></a><span id="l104.43">   // check that the start time is correct</span>
<a href="#l104.44"></a><span id="l104.44">   let startTimeInput = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l104.45"></a><span id="l104.45">     + 'id(&quot;event-grid-startdate-row&quot;)/id(&quot;event-grid-startdate-picker-box&quot;)/'</span>
<a href="#l104.46"></a><span id="l104.46">     + 'id(&quot;event-starttime&quot;)/anon({&quot;anonid&quot;:&quot;hbox&quot;})/anon({&quot;anonid&quot;:&quot;time-picker&quot;})/'</span>
<a href="#l104.47"></a><span id="l104.47">     + 'anon({&quot;class&quot;:&quot;timepicker-box-class&quot;})/anon({&quot;class&quot;:&quot;timepicker-text-class&quot;})/'</span>
<a href="#l104.48"></a><span id="l104.48">     + 'anon({&quot;flex&quot;:&quot;1&quot;})/anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l104.49"></a><span id="l104.49" class="difflineat">@@ -96,17 +96,17 @@ var testWeekView = function() {</span>
<a href="#l104.50"></a><span id="l104.50">   event.select(new elementslib.ID(event.window.document, &quot;item-calendar&quot;), null, calendar);</span>
<a href="#l104.51"></a><span id="l104.51"> </span>
<a href="#l104.52"></a><span id="l104.52">   // save</span>
<a href="#l104.53"></a><span id="l104.53">   event.click(new elementslib.ID(event.window.document, &quot;button-save&quot;));</span>
<a href="#l104.54"></a><span id="l104.54"> </span>
<a href="#l104.55"></a><span id="l104.55">   // if it was created successfully, it can be opened</span>
<a href="#l104.56"></a><span id="l104.56">   controller.waitForElement(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l104.57"></a><span id="l104.57">   controller.doubleClick(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l104.58"></a><span id="l104.58" class="difflineminus">-  controller.waitFor(function() {return utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0}, sleep);</span>
<a href="#l104.59"></a><span id="l104.59" class="difflineplus">+  controller.waitFor(function() {return utils.getWindows(&quot;Calendar:EventDialog&quot;).length &gt; 0;}, sleep);</span>
<a href="#l104.60"></a><span id="l104.60">   event = new mozmill.controller.MozMillController(mozmill.utils.getWindows(&quot;Calendar:EventDialog&quot;)[0]);</span>
<a href="#l104.61"></a><span id="l104.61"> </span>
<a href="#l104.62"></a><span id="l104.62">   // change title and save changes</span>
<a href="#l104.63"></a><span id="l104.63">   let titleTextBox = new elementslib.Lookup(event.window.document, eventDialog</span>
<a href="#l104.64"></a><span id="l104.64">     + 'id(&quot;event-grid-title-row&quot;)/id(&quot;item-title&quot;)/anon({&quot;class&quot;:&quot;textbox-input-box&quot;})/'</span>
<a href="#l104.65"></a><span id="l104.65">     + 'anon({&quot;anonid&quot;:&quot;input&quot;})');</span>
<a href="#l104.66"></a><span id="l104.66">   event.waitForElement(titleTextBox);</span>
<a href="#l104.67"></a><span id="l104.67">   event.type(titleTextBox, title2);</span>
<a href="#l104.68"></a><span id="l104.68" class="difflineat">@@ -120,13 +120,13 @@ var testWeekView = function() {</span>
<a href="#l104.69"></a><span id="l104.69">   controller.waitForElement(eventName);</span>
<a href="#l104.70"></a><span id="l104.70">   controller.assertJSProperty(eventName, &quot;textContent&quot;, title2);</span>
<a href="#l104.71"></a><span id="l104.71"> </span>
<a href="#l104.72"></a><span id="l104.72">   // delete event</span>
<a href="#l104.73"></a><span id="l104.73">   controller.click(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l104.74"></a><span id="l104.74">   controller.keypress(new elementslib.ID(controller.window.document, &quot;week-view&quot;),</span>
<a href="#l104.75"></a><span id="l104.75">     &quot;VK_DELETE&quot;, {});</span>
<a href="#l104.76"></a><span id="l104.76">   controller.waitForElementNotPresent(new elementslib.Lookup(controller.window.document, eventBox));</span>
<a href="#l104.77"></a><span id="l104.77" class="difflineminus">-}</span>
<a href="#l104.78"></a><span id="l104.78" class="difflineplus">+};</span>
<a href="#l104.79"></a><span id="l104.79"> </span>
<a href="#l104.80"></a><span id="l104.80"> var teardownTest = function(module) {</span>
<a href="#l104.81"></a><span id="l104.81">   calUtils.deleteCalendars(controller, calendar);</span>
<a href="#l104.82"></a><span id="l104.82" class="difflineminus">-}</span>
<a href="#l104.83"></a><span id="l104.83" class="difflineplus">+};</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l105.1"></a><span id="l105.1" class="difflineminus">--- a/calendar/test/unit/test_alarm.js</span>
<a href="#l105.2"></a><span id="l105.2" class="difflineplus">+++ b/calendar/test/unit/test_alarm.js</span>
<a href="#l105.3"></a><span id="l105.3" class="difflineat">@@ -184,17 +184,17 @@ function test_audio_alarm() {</span>
<a href="#l105.4"></a><span id="l105.4"> </span>
<a href="#l105.5"></a><span id="l105.5">     dump(&quot;Done\n&quot;);</span>
<a href="#l105.6"></a><span id="l105.6"> }</span>
<a href="#l105.7"></a><span id="l105.7"> </span>
<a href="#l105.8"></a><span id="l105.8"> function test_custom_alarm() {</span>
<a href="#l105.9"></a><span id="l105.9">     dump(&quot;Testing X-SMS (custom) alarms...&quot;);</span>
<a href="#l105.10"></a><span id="l105.10">     let alarm = cal.createAlarm();</span>
<a href="#l105.11"></a><span id="l105.11">     // Set ACTION to a custom value, make sure this was not rejected</span>
<a href="#l105.12"></a><span id="l105.12" class="difflineminus">-    alarm.action = &quot;X-SMS&quot;</span>
<a href="#l105.13"></a><span id="l105.13" class="difflineplus">+    alarm.action = &quot;X-SMS&quot;;</span>
<a href="#l105.14"></a><span id="l105.14">     equal(alarm.action, &quot;X-SMS&quot;);</span>
<a href="#l105.15"></a><span id="l105.15"> </span>
<a href="#l105.16"></a><span id="l105.16">     // There is no restriction on DESCRIPTION for custom alarms</span>
<a href="#l105.17"></a><span id="l105.17">     alarm.description = &quot;description&quot;;</span>
<a href="#l105.18"></a><span id="l105.18">     equal(alarm.description, &quot;description&quot;);</span>
<a href="#l105.19"></a><span id="l105.19"> </span>
<a href="#l105.20"></a><span id="l105.20">     // There is no restriction on SUMMARY for custom alarms</span>
<a href="#l105.21"></a><span id="l105.21">     alarm.summary = &quot;summary&quot;;</span>
<a href="#l105.22"></a><span id="l105.22" class="difflineat">@@ -303,17 +303,17 @@ function test_xprop() {</span>
<a href="#l105.23"></a><span id="l105.23">     ok(!alarm.hasProperty(&quot;X-PROP&quot;));</span>
<a href="#l105.24"></a><span id="l105.24">     equal(alarm.getProperty(&quot;X-PROP&quot;), null);</span>
<a href="#l105.25"></a><span id="l105.25"> </span>
<a href="#l105.26"></a><span id="l105.26">     // also check X-MOZ-LASTACK prop</span>
<a href="#l105.27"></a><span id="l105.27">     let dt = cal.createDateTime();</span>
<a href="#l105.28"></a><span id="l105.28">     alarm.setProperty(&quot;X-MOZ-LASTACK&quot;, dt.icalString);</span>
<a href="#l105.29"></a><span id="l105.29">     alarm.action = &quot;DISPLAY&quot;;</span>
<a href="#l105.30"></a><span id="l105.30">     alarm.description = &quot;test&quot;;</span>
<a href="#l105.31"></a><span id="l105.31" class="difflineminus">-    alarm.related = Ci.calIAlarm.ALARM_RELATED_START</span>
<a href="#l105.32"></a><span id="l105.32" class="difflineplus">+    alarm.related = Ci.calIAlarm.ALARM_RELATED_START;</span>
<a href="#l105.33"></a><span id="l105.33">     alarm.offset = createDuration(&quot;-PT5M&quot;);</span>
<a href="#l105.34"></a><span id="l105.34">     ok(alarm.icalComponent.serializeToICS().includes(dt.icalString));</span>
<a href="#l105.35"></a><span id="l105.35"> </span>
<a href="#l105.36"></a><span id="l105.36">     alarm.deleteProperty(&quot;X-MOZ-LASTACK&quot;);</span>
<a href="#l105.37"></a><span id="l105.37">     ok(!alarm.icalComponent.serializeToICS().includes(dt.icalString));</span>
<a href="#l105.38"></a><span id="l105.38">     dump(&quot;Done\n&quot;);</span>
<a href="#l105.39"></a><span id="l105.39"> }</span>
<a href="#l105.40"></a><span id="l105.40"> </span>
<a href="#l105.41"></a><span id="l105.41" class="difflineat">@@ -321,17 +321,17 @@ function test_dates() {</span>
<a href="#l105.42"></a><span id="l105.42">     dump(&quot;Testing alarm dates...&quot;);</span>
<a href="#l105.43"></a><span id="l105.43">     let passed;</span>
<a href="#l105.44"></a><span id="l105.44">     // Initial value</span>
<a href="#l105.45"></a><span id="l105.45">     let alarm = cal.createAlarm();</span>
<a href="#l105.46"></a><span id="l105.46">     equal(alarm.alarmDate, null);</span>
<a href="#l105.47"></a><span id="l105.47">     equal(alarm.offset, null);</span>
<a href="#l105.48"></a><span id="l105.48"> </span>
<a href="#l105.49"></a><span id="l105.49">     // Set an offset and check it</span>
<a href="#l105.50"></a><span id="l105.50" class="difflineminus">-    alarm.related = Ci.calIAlarm.ALARM_RELATED_START</span>
<a href="#l105.51"></a><span id="l105.51" class="difflineplus">+    alarm.related = Ci.calIAlarm.ALARM_RELATED_START;</span>
<a href="#l105.52"></a><span id="l105.52">     let offset = createDuration(&quot;-PT5M&quot;);</span>
<a href="#l105.53"></a><span id="l105.53">     alarm.offset = offset;</span>
<a href="#l105.54"></a><span id="l105.54">     equal(alarm.alarmDate, null);</span>
<a href="#l105.55"></a><span id="l105.55">     equal(alarm.offset, offset);</span>
<a href="#l105.56"></a><span id="l105.56">     try {</span>
<a href="#l105.57"></a><span id="l105.57">         alarm.alarmDate = createDateTime();</span>
<a href="#l105.58"></a><span id="l105.58">         passed = false;</span>
<a href="#l105.59"></a><span id="l105.59">     } catch (e) {</span>
<a href="#l105.60"></a><span id="l105.60" class="difflineat">@@ -442,17 +442,17 @@ function test_clone() {</span>
<a href="#l105.61"></a><span id="l105.61">     newAlarm = newAlarm.clone();</span>
<a href="#l105.62"></a><span id="l105.62">     ok(newAlarm.isMutable);</span>
<a href="#l105.63"></a><span id="l105.63"> </span>
<a href="#l105.64"></a><span id="l105.64">     // Check if item is still the same</span>
<a href="#l105.65"></a><span id="l105.65">     // TODO This is not quite optimal, maybe someone can find a better way to do</span>
<a href="#l105.66"></a><span id="l105.66">     // the comparisons.</span>
<a href="#l105.67"></a><span id="l105.67">     for (let prop in propMap) {</span>
<a href="#l105.68"></a><span id="l105.68">         if (prop == &quot;item&quot;) {</span>
<a href="#l105.69"></a><span id="l105.69" class="difflineminus">-            equal(alarm.item.icalString, newAlarm.item.icalString)</span>
<a href="#l105.70"></a><span id="l105.70" class="difflineplus">+            equal(alarm.item.icalString, newAlarm.item.icalString);</span>
<a href="#l105.71"></a><span id="l105.71">         } else {</span>
<a href="#l105.72"></a><span id="l105.72">             if ((alarm[prop] instanceof Ci.nsISupports &amp;&amp;</span>
<a href="#l105.73"></a><span id="l105.73">                  alarm[prop].icalString != newAlarm[prop].icalString) ||</span>
<a href="#l105.74"></a><span id="l105.74">                 !(alarm[prop] instanceof Ci.nsISupports) &amp;&amp;</span>
<a href="#l105.75"></a><span id="l105.75">                   alarm[prop] != newAlarm[prop]) {</span>
<a href="#l105.76"></a><span id="l105.76">                 do_throw(prop + &quot; differs, &quot; + alarm[prop] + &quot; == &quot; + newAlarm[prop]);</span>
<a href="#l105.77"></a><span id="l105.77">             }</span>
<a href="#l105.78"></a><span id="l105.78">         }</span>
<a href="#l105.79"></a><span id="l105.79" class="difflineat">@@ -492,17 +492,17 @@ function test_serialize() {</span>
<a href="#l105.80"></a><span id="l105.80">     // most checks done by other tests, these don't fit into categories</span>
<a href="#l105.81"></a><span id="l105.81">     let alarm = cal.createAlarm();</span>
<a href="#l105.82"></a><span id="l105.82">     let srv = cal.getIcsService();</span>
<a href="#l105.83"></a><span id="l105.83"> </span>
<a href="#l105.84"></a><span id="l105.84">     throws(function() {</span>
<a href="#l105.85"></a><span id="l105.85">         alarm.icalComponent = srv.createIcalComponent(&quot;BARF&quot;);</span>
<a href="#l105.86"></a><span id="l105.86">     }, /0x80070057/, &quot;Invalid Argument&quot;);</span>
<a href="#l105.87"></a><span id="l105.87"> </span>
<a href="#l105.88"></a><span id="l105.88" class="difflineminus">-    function addProp(k, v) { let p = srv.createIcalProperty(k); p.value = v; comp.addProperty(p) }</span>
<a href="#l105.89"></a><span id="l105.89" class="difflineplus">+    function addProp(k, v) { let p = srv.createIcalProperty(k); p.value = v; comp.addProperty(p); }</span>
<a href="#l105.90"></a><span id="l105.90">     function addActionDisplay() { addProp(&quot;ACTION&quot;, &quot;DISPLAY&quot;); }</span>
<a href="#l105.91"></a><span id="l105.91">     function addActionEmail() { addProp(&quot;ACTION&quot;, &quot;EMAIL&quot;); }</span>
<a href="#l105.92"></a><span id="l105.92">     function addTrigger() { addProp(&quot;TRIGGER&quot;, &quot;-PT15M&quot;); }</span>
<a href="#l105.93"></a><span id="l105.93">     function addDescr() { addProp(&quot;DESCRIPTION&quot;, &quot;TEST&quot;); }</span>
<a href="#l105.94"></a><span id="l105.94">     function addDuration() { addProp(&quot;DURATION&quot;, &quot;-PT15M&quot;); }</span>
<a href="#l105.95"></a><span id="l105.95">     function addRepeat() { addProp(&quot;REPEAT&quot;, &quot;1&quot;); }</span>
<a href="#l105.96"></a><span id="l105.96">     function addAttendee() { addProp(&quot;ATTENDEE&quot;, &quot;mailto:horst&quot;); }</span>
<a href="#l105.97"></a><span id="l105.97">     function addAttachment() { addProp(&quot;ATTACH&quot;, &quot;data:yeah&quot;); }</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l106.1"></a><span id="l106.1" class="difflineminus">--- a/calendar/test/unit/test_alarmutils.js</span>
<a href="#l106.2"></a><span id="l106.2" class="difflineplus">+++ b/calendar/test/unit/test_alarmutils.js</span>
<a href="#l106.3"></a><span id="l106.3" class="difflineat">@@ -65,17 +65,17 @@ add_task(function* test_setDefaultValues</span>
<a href="#l106.4"></a><span id="l106.4"> });</span>
<a href="#l106.5"></a><span id="l106.5"> </span>
<a href="#l106.6"></a><span id="l106.6"> add_task(function* test_setDefaultValues_tasks() {</span>
<a href="#l106.7"></a><span id="l106.7">     let item, alarm;</span>
<a href="#l106.8"></a><span id="l106.8">     let calnow = cal.now;</span>
<a href="#l106.9"></a><span id="l106.9">     let nowDate = cal.createDateTime(&quot;20150815T120000&quot;);</span>
<a href="#l106.10"></a><span id="l106.10">     cal.now = function() {</span>
<a href="#l106.11"></a><span id="l106.11">       return nowDate;</span>
<a href="#l106.12"></a><span id="l106.12" class="difflineminus">-    }</span>
<a href="#l106.13"></a><span id="l106.13" class="difflineplus">+    };</span>
<a href="#l106.14"></a><span id="l106.14"> </span>
<a href="#l106.15"></a><span id="l106.15">     Preferences.set(&quot;calendar.alarms.onfortodos&quot;, 1);</span>
<a href="#l106.16"></a><span id="l106.16">     Preferences.set(&quot;calendar.alarms.todoalarmunit&quot;, &quot;hours&quot;);</span>
<a href="#l106.17"></a><span id="l106.17">     Preferences.set(&quot;calendar.alarms.todoalarmlen&quot;, 60);</span>
<a href="#l106.18"></a><span id="l106.18">     item = cal.createTodo();</span>
<a href="#l106.19"></a><span id="l106.19">     equal(item.entryDate, null);</span>
<a href="#l106.20"></a><span id="l106.20">     cal.alarms.setDefaultValues(item);</span>
<a href="#l106.21"></a><span id="l106.21">     alarm = item.getAlarms({})[0];</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l107.1"></a><span id="l107.1" class="difflineminus">--- a/calendar/test/unit/test_attendee.js</span>
<a href="#l107.2"></a><span id="l107.2" class="difflineplus">+++ b/calendar/test/unit/test_attendee.js</span>
<a href="#l107.3"></a><span id="l107.3" class="difflineat">@@ -86,34 +86,34 @@ function test_values() {</span>
<a href="#l107.4"></a><span id="l107.4">     // Testing cascaded immutability (event -&gt; attendee)</span>
<a href="#l107.5"></a><span id="l107.5">     event.makeImmutable();</span>
<a href="#l107.6"></a><span id="l107.6">     testImmutability(a2, properties);</span>
<a href="#l107.7"></a><span id="l107.7"> </span>
<a href="#l107.8"></a><span id="l107.8">     // Testing cloning</span>
<a href="#l107.9"></a><span id="l107.9">     var ec = event.clone();</span>
<a href="#l107.10"></a><span id="l107.10">     var clonedatts = ec.getAttendees({});</span>
<a href="#l107.11"></a><span id="l107.11">     var atts = event.getAttendees({});</span>
<a href="#l107.12"></a><span id="l107.12" class="difflineminus">-    equal(atts.length, clonedatts.length)</span>
<a href="#l107.13"></a><span id="l107.13" class="difflineplus">+    equal(atts.length, clonedatts.length);</span>
<a href="#l107.14"></a><span id="l107.14"> </span>
<a href="#l107.15"></a><span id="l107.15">     for (let i = 0; i &lt; clonedatts.length; i++) {</span>
<a href="#l107.16"></a><span id="l107.16">         // The attributes should not be equal</span>
<a href="#l107.17"></a><span id="l107.17">         notEqual(atts[i], clonedatts[i]);</span>
<a href="#l107.18"></a><span id="l107.18">         // But the ids should</span>
<a href="#l107.19"></a><span id="l107.19" class="difflineminus">-        equal(atts[i].id, clonedatts[i].id)</span>
<a href="#l107.20"></a><span id="l107.20" class="difflineplus">+        equal(atts[i].id, clonedatts[i].id);</span>
<a href="#l107.21"></a><span id="l107.21">     }</span>
<a href="#l107.22"></a><span id="l107.22"> </span>
<a href="#l107.23"></a><span id="l107.23">     // Make sure organizers are also cloned correctly</span>
<a href="#l107.24"></a><span id="l107.24">     let a3 = cal.createAttendee();</span>
<a href="#l107.25"></a><span id="l107.25">     a3.id = &quot;horst&quot;;</span>
<a href="#l107.26"></a><span id="l107.26">     a3.isOrganizer = true;</span>
<a href="#l107.27"></a><span id="l107.27">     let a4 = a3.clone();</span>
<a href="#l107.28"></a><span id="l107.28"> </span>
<a href="#l107.29"></a><span id="l107.29" class="difflineminus">-    ok(a4.isOrganizer)</span>
<a href="#l107.30"></a><span id="l107.30" class="difflineplus">+    ok(a4.isOrganizer);</span>
<a href="#l107.31"></a><span id="l107.31">     a3.isOrganizer = false;</span>
<a href="#l107.32"></a><span id="l107.32" class="difflineminus">-    ok(a4.isOrganizer)</span>
<a href="#l107.33"></a><span id="l107.33" class="difflineplus">+    ok(a4.isOrganizer);</span>
<a href="#l107.34"></a><span id="l107.34"> }</span>
<a href="#l107.35"></a><span id="l107.35"> </span>
<a href="#l107.36"></a><span id="l107.36"> function test_serialize() {</span>
<a href="#l107.37"></a><span id="l107.37">     let a = cal.createAttendee();</span>
<a href="#l107.38"></a><span id="l107.38"> </span>
<a href="#l107.39"></a><span id="l107.39">     throws(function() {</span>
<a href="#l107.40"></a><span id="l107.40">         a.icalProperty;</span>
<a href="#l107.41"></a><span id="l107.41">     }, /Component not initialized/);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l108.1"></a><span id="l108.1" class="difflineminus">--- a/calendar/test/unit/test_calmgr.js</span>
<a href="#l108.2"></a><span id="l108.2" class="difflineplus">+++ b/calendar/test/unit/test_calmgr.js</span>
<a href="#l108.3"></a><span id="l108.3" class="difflineat">@@ -147,17 +147,17 @@ add_test(function test_calobserver() {</span>
<a href="#l108.4"></a><span id="l108.4">     resetCounters();</span>
<a href="#l108.5"></a><span id="l108.5">     calmgr.registerCalendar(memory);</span>
<a href="#l108.6"></a><span id="l108.6">     calmgr.registerCalendar(memory2);</span>
<a href="#l108.7"></a><span id="l108.7">     calmgr.addCalendarObserver(allobs);</span>
<a href="#l108.8"></a><span id="l108.8">     memory.addObserver(calobs);</span>
<a href="#l108.9"></a><span id="l108.9"> </span>
<a href="#l108.10"></a><span id="l108.10">     // Add an item</span>
<a href="#l108.11"></a><span id="l108.11">     let item = cal.createEvent();</span>
<a href="#l108.12"></a><span id="l108.12" class="difflineminus">-    item.id = cal.getUUID()</span>
<a href="#l108.13"></a><span id="l108.13" class="difflineplus">+    item.id = cal.getUUID();</span>
<a href="#l108.14"></a><span id="l108.14">     item.startDate = cal.now();</span>
<a href="#l108.15"></a><span id="l108.15">     item.endDate = cal.now();</span>
<a href="#l108.16"></a><span id="l108.16">     memory.addItem(item, null);</span>
<a href="#l108.17"></a><span id="l108.17">     checkCounters(1, 0, 0);</span>
<a href="#l108.18"></a><span id="l108.18"> </span>
<a href="#l108.19"></a><span id="l108.19">     // Modify the item</span>
<a href="#l108.20"></a><span id="l108.20">     let newItem = item.clone();</span>
<a href="#l108.21"></a><span id="l108.21">     newItem.title = &quot;title&quot;;</span>
<a href="#l108.22"></a><span id="l108.22" class="difflineat">@@ -259,17 +259,17 @@ add_test(function test_calprefs() {</span>
<a href="#l108.23"></a><span id="l108.23">     // Before checking the value, reinitialize the memory calendar with the</span>
<a href="#l108.24"></a><span id="l108.24">     // same id to make sure the pref value isn't just cached</span>
<a href="#l108.25"></a><span id="l108.25">     memory = calmgr.createCalendar(&quot;memory&quot;, Services.io.newURI(&quot;moz-memory-calendar://&quot;, null, null));</span>
<a href="#l108.26"></a><span id="l108.26">     memory.id = memid;</span>
<a href="#l108.27"></a><span id="l108.27"> </span>
<a href="#l108.28"></a><span id="l108.28">     // First test the standard types</span>
<a href="#l108.29"></a><span id="l108.29">     prop = memory.getProperty(&quot;stringpref&quot;);</span>
<a href="#l108.30"></a><span id="l108.30">     equal(typeof prop, &quot;string&quot;);</span>
<a href="#l108.31"></a><span id="l108.31" class="difflineminus">-    equal(prop, &quot;abc&quot;)</span>
<a href="#l108.32"></a><span id="l108.32" class="difflineplus">+    equal(prop, &quot;abc&quot;);</span>
<a href="#l108.33"></a><span id="l108.33"> </span>
<a href="#l108.34"></a><span id="l108.34">     prop = memory.getProperty(&quot;boolpref&quot;);</span>
<a href="#l108.35"></a><span id="l108.35">     equal(typeof prop, &quot;boolean&quot;);</span>
<a href="#l108.36"></a><span id="l108.36">     equal(prop, true);</span>
<a href="#l108.37"></a><span id="l108.37"> </span>
<a href="#l108.38"></a><span id="l108.38">     prop = memory.getProperty(&quot;intpref&quot;);</span>
<a href="#l108.39"></a><span id="l108.39">     equal(typeof prop, &quot;number&quot;);</span>
<a href="#l108.40"></a><span id="l108.40">     equal(prop, 123);</span>
<a href="#l108.41"></a><span id="l108.41" class="difflineat">@@ -286,17 +286,17 @@ add_test(function test_calprefs() {</span>
<a href="#l108.42"></a><span id="l108.42">     // Check if changing pref types works. We need to reset the calendar again</span>
<a href="#l108.43"></a><span id="l108.43">     // because retrieving the value just cached it again.</span>
<a href="#l108.44"></a><span id="l108.44">     memory = calmgr.createCalendar(&quot;memory&quot;, Services.io.newURI(&quot;moz-memory-calendar://&quot;, null, null));</span>
<a href="#l108.45"></a><span id="l108.45">     memory.id = memid;</span>
<a href="#l108.46"></a><span id="l108.46"> </span>
<a href="#l108.47"></a><span id="l108.47">     calmgr.setCalendarPref_(memory, &quot;boolpref&quot;, &quot;kinda true&quot;);</span>
<a href="#l108.48"></a><span id="l108.48">     prop = memory.getProperty(&quot;boolpref&quot;);</span>
<a href="#l108.49"></a><span id="l108.49">     equal(typeof prop, &quot;string&quot;);</span>
<a href="#l108.50"></a><span id="l108.50" class="difflineminus">-    equal(prop, &quot;kinda true&quot;)</span>
<a href="#l108.51"></a><span id="l108.51" class="difflineplus">+    equal(prop, &quot;kinda true&quot;);</span>
<a href="#l108.52"></a><span id="l108.52"> </span>
<a href="#l108.53"></a><span id="l108.53">     // Check if unsetting a pref works</span>
<a href="#l108.54"></a><span id="l108.54">     memory.setProperty(&quot;intpref&quot;, null);</span>
<a href="#l108.55"></a><span id="l108.55">     memory = calmgr.createCalendar(&quot;memory&quot;, Services.io.newURI(&quot;moz-memory-calendar://&quot;, null, null));</span>
<a href="#l108.56"></a><span id="l108.56">     memory.id = memid;</span>
<a href="#l108.57"></a><span id="l108.57">     prop = memory.getProperty(&quot;intpref&quot;);</span>
<a href="#l108.58"></a><span id="l108.58">     ok(prop === null);</span>
<a href="#l108.59"></a><span id="l108.59"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l109.1"></a><span id="l109.1" class="difflineminus">--- a/calendar/test/unit/test_deleted_items.js</span>
<a href="#l109.2"></a><span id="l109.2" class="difflineplus">+++ b/calendar/test/unit/test_deleted_items.js</span>
<a href="#l109.3"></a><span id="l109.3" class="difflineat">@@ -51,17 +51,17 @@ add_task(function* test_deleted_items() </span>
<a href="#l109.4"></a><span id="l109.4"> </span>
<a href="#l109.5"></a><span id="l109.5">     // We need to stop time so we have something to compare with.</span>
<a href="#l109.6"></a><span id="l109.6">     let referenceDate = cal.createDateTime(&quot;20120726T112045&quot;); referenceDate.timezone = cal.calendarDefaultTimezone();</span>
<a href="#l109.7"></a><span id="l109.7">     let futureDate = cal.createDateTime(&quot;20380101T000000&quot;); futureDate.timezone = cal.calendarDefaultTimezone();</span>
<a href="#l109.8"></a><span id="l109.8">     let useFutureDate = false;</span>
<a href="#l109.9"></a><span id="l109.9">     let oldNowFunction = cal.now;</span>
<a href="#l109.10"></a><span id="l109.10">     cal.now = function test_specific_now() {</span>
<a href="#l109.11"></a><span id="l109.11">         return (useFutureDate ? futureDate : referenceDate).clone();</span>
<a href="#l109.12"></a><span id="l109.12" class="difflineminus">-    }</span>
<a href="#l109.13"></a><span id="l109.13" class="difflineplus">+    };</span>
<a href="#l109.14"></a><span id="l109.14"> </span>
<a href="#l109.15"></a><span id="l109.15">     // Deleting an item should trigger it being marked for deletion.</span>
<a href="#l109.16"></a><span id="l109.16">     yield check_delmgr_call(() =&gt; memory.deleteItem(item, null));</span>
<a href="#l109.17"></a><span id="l109.17"> </span>
<a href="#l109.18"></a><span id="l109.18">     // Now check if it was deleted at our reference date.</span>
<a href="#l109.19"></a><span id="l109.19">     let deltime = delmgr.getDeletedDate(item.id);</span>
<a href="#l109.20"></a><span id="l109.20">     notEqual(deltime, null);</span>
<a href="#l109.21"></a><span id="l109.21">     equal(deltime.compare(referenceDate), 0);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l110.1"></a><span id="l110.1" class="difflineminus">--- a/calendar/test/unit/test_freebusy_service.js</span>
<a href="#l110.2"></a><span id="l110.2" class="difflineplus">+++ b/calendar/test/unit/test_freebusy_service.js</span>
<a href="#l110.3"></a><span id="l110.3" class="difflineat">@@ -30,17 +30,17 @@ function test_found() {</span>
<a href="#l110.4"></a><span id="l110.4">           aListener.onResult(null, []);</span>
<a href="#l110.5"></a><span id="l110.5">         }</span>
<a href="#l110.6"></a><span id="l110.6">     };</span>
<a href="#l110.7"></a><span id="l110.7"> </span>
<a href="#l110.8"></a><span id="l110.8">     let provider2 = {</span>
<a href="#l110.9"></a><span id="l110.9">         id: 2,</span>
<a href="#l110.10"></a><span id="l110.10">         called: false,</span>
<a href="#l110.11"></a><span id="l110.11">         getFreeBusyIntervals: function(aCalId, aStart, aEnd, aTypes, aListener) {</span>
<a href="#l110.12"></a><span id="l110.12" class="difflineminus">-            ok(!this.called)</span>
<a href="#l110.13"></a><span id="l110.13" class="difflineplus">+            ok(!this.called);</span>
<a href="#l110.14"></a><span id="l110.14">             this.called = true;</span>
<a href="#l110.15"></a><span id="l110.15"> </span>
<a href="#l110.16"></a><span id="l110.16">             let interval = new cal.FreeBusyInterval(aCalId, cIFI.BUSY, aStart, aEnd);</span>
<a href="#l110.17"></a><span id="l110.17">             aListener.onResult(null, [interval]);</span>
<a href="#l110.18"></a><span id="l110.18">         }</span>
<a href="#l110.19"></a><span id="l110.19">     };</span>
<a href="#l110.20"></a><span id="l110.20">     provider2.wrappedJSObject = provider2;</span>
<a href="#l110.21"></a><span id="l110.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l111.1"></a><span id="l111.1" class="difflineminus">--- a/calendar/test/unit/test_gdata_provider.js</span>
<a href="#l111.2"></a><span id="l111.2" class="difflineplus">+++ b/calendar/test/unit/test_gdata_provider.js</span>
<a href="#l111.3"></a><span id="l111.3" class="difflineat">@@ -468,17 +468,17 @@ function findKey(container, key, searchK</span>
<a href="#l111.4"></a><span id="l111.4">         }</span>
<a href="#l111.5"></a><span id="l111.5">     }</span>
<a href="#l111.6"></a><span id="l111.6"> </span>
<a href="#l111.7"></a><span id="l111.7">     let foundItem = foundIndex == -1 ? null : container[foundIndex];</span>
<a href="#l111.8"></a><span id="l111.8">     return [foundIndex, foundItem];</span>
<a href="#l111.9"></a><span id="l111.9"> }</span>
<a href="#l111.10"></a><span id="l111.10"> </span>
<a href="#l111.11"></a><span id="l111.11"> function generateID() {</span>
<a href="#l111.12"></a><span id="l111.12" class="difflineminus">-    let c = &quot;abcdefghijklmnopqrstuvwxyz0123456789&quot;</span>
<a href="#l111.13"></a><span id="l111.13" class="difflineplus">+    let c = &quot;abcdefghijklmnopqrstuvwxyz0123456789&quot;;</span>
<a href="#l111.14"></a><span id="l111.14">     let s = &quot;&quot;;</span>
<a href="#l111.15"></a><span id="l111.15">     for (let i = 26; i; i--) {</span>
<a href="#l111.16"></a><span id="l111.16">       s += c[Math.floor(Math.random() * c.length)];</span>
<a href="#l111.17"></a><span id="l111.17">     }</span>
<a href="#l111.18"></a><span id="l111.18">     return s;</span>
<a href="#l111.19"></a><span id="l111.19"> }</span>
<a href="#l111.20"></a><span id="l111.20"> </span>
<a href="#l111.21"></a><span id="l111.21"> function getAllMeta(calendar) {</span>
<a href="#l111.22"></a><span id="l111.22" class="difflineat">@@ -748,30 +748,30 @@ add_task(function* test_always_readOnly(</span>
<a href="#l111.23"></a><span id="l111.23">        &quot;organizer&quot;: gServer.creator,</span>
<a href="#l111.24"></a><span id="l111.24">        &quot;start&quot;: { &quot;dateTime&quot;: &quot;2006-06-10T18:00:00+02:00&quot; },</span>
<a href="#l111.25"></a><span id="l111.25">        &quot;end&quot;: {&quot;dateTime&quot;: &quot;2006-06-10T20:00:00+02:00&quot; },</span>
<a href="#l111.26"></a><span id="l111.26">        &quot;iCalUID&quot;: &quot;go6ijb0b46hlpbu4eeu92njevo@google.com&quot;</span>
<a href="#l111.27"></a><span id="l111.27">     }];</span>
<a href="#l111.28"></a><span id="l111.28">     gServer.calendarListData.accessRole = &quot;freeBusyReader&quot;;</span>
<a href="#l111.29"></a><span id="l111.29">     let client = yield gServer.getClient();</span>
<a href="#l111.30"></a><span id="l111.30">     let pclient = cal.async.promisifyCalendar(client);</span>
<a href="#l111.31"></a><span id="l111.31" class="difflineminus">-    ok(client.readOnly)</span>
<a href="#l111.32"></a><span id="l111.32" class="difflineplus">+    ok(client.readOnly);</span>
<a href="#l111.33"></a><span id="l111.33">     client.readOnly = false;</span>
<a href="#l111.34"></a><span id="l111.34" class="difflineminus">-    ok(client.readOnly)</span>
<a href="#l111.35"></a><span id="l111.35" class="difflineplus">+    ok(client.readOnly);</span>
<a href="#l111.36"></a><span id="l111.36"> </span>
<a href="#l111.37"></a><span id="l111.37">     let items = yield pclient.getAllItems();</span>
<a href="#l111.38"></a><span id="l111.38">     equal(items.length, 1);</span>
<a href="#l111.39"></a><span id="l111.39">     notEqual(items[0].title, &quot;New Event&quot;);</span>
<a href="#l111.40"></a><span id="l111.40">     gServer.resetClient(client);</span>
<a href="#l111.41"></a><span id="l111.41"> </span>
<a href="#l111.42"></a><span id="l111.42">     gServer.calendarListData.accessRole = &quot;reader&quot;;</span>
<a href="#l111.43"></a><span id="l111.43">     client = yield gServer.getClient();</span>
<a href="#l111.44"></a><span id="l111.44" class="difflineminus">-    ok(client.readOnly)</span>
<a href="#l111.45"></a><span id="l111.45" class="difflineplus">+    ok(client.readOnly);</span>
<a href="#l111.46"></a><span id="l111.46">     client.readOnly = false;</span>
<a href="#l111.47"></a><span id="l111.47" class="difflineminus">-    ok(client.readOnly)</span>
<a href="#l111.48"></a><span id="l111.48" class="difflineplus">+    ok(client.readOnly);</span>
<a href="#l111.49"></a><span id="l111.49">     gServer.resetClient(client);</span>
<a href="#l111.50"></a><span id="l111.50"> });</span>
<a href="#l111.51"></a><span id="l111.51"> </span>
<a href="#l111.52"></a><span id="l111.52"> add_task(function* test_reset_sync() {</span>
<a href="#l111.53"></a><span id="l111.53">     gServer.tasks = [</span>
<a href="#l111.54"></a><span id="l111.54">        {</span>
<a href="#l111.55"></a><span id="l111.55">         &quot;kind&quot;: &quot;tasks#task&quot;,</span>
<a href="#l111.56"></a><span id="l111.56">         &quot;id&quot;: &quot;MTEyMDE2MDE5NzE0NjYzMDk4ODI6MDo0MDI1NDg2NjU&quot;,</span>
<a href="#l111.57"></a><span id="l111.57" class="difflineat">@@ -1024,28 +1024,28 @@ add_task(function* test_addModifyDeleteI</span>
<a href="#l111.58"></a><span id="l111.58">     notEqual(addedEvent.id, null);</span>
<a href="#l111.59"></a><span id="l111.59">     equal(addedEvent.organizer.id, &quot;mailto:xpcshell@example.com&quot;);</span>
<a href="#l111.60"></a><span id="l111.60"> </span>
<a href="#l111.61"></a><span id="l111.61">     let items = yield pclient.getAllItems();</span>
<a href="#l111.62"></a><span id="l111.62">     equal(items.length, 1);</span>
<a href="#l111.63"></a><span id="l111.63">     equal(items[0].id, addedEvent.id);</span>
<a href="#l111.64"></a><span id="l111.64">     equal(items[0].organizer.id, &quot;mailto:xpcshell@example.com&quot;);</span>
<a href="#l111.65"></a><span id="l111.65"> </span>
<a href="#l111.66"></a><span id="l111.66" class="difflineminus">-    equal(gServer.events.length, 1)</span>
<a href="#l111.67"></a><span id="l111.67" class="difflineplus">+    equal(gServer.events.length, 1);</span>
<a href="#l111.68"></a><span id="l111.68">     equal(gServer.tasks.length, 0);</span>
<a href="#l111.69"></a><span id="l111.69"> </span>
<a href="#l111.70"></a><span id="l111.70">     // Add a task</span>
<a href="#l111.71"></a><span id="l111.71">     let addedTask = yield pclient.adoptItem(task);</span>
<a href="#l111.72"></a><span id="l111.72">     notEqual(addedTask.id, null);</span>
<a href="#l111.73"></a><span id="l111.73"> </span>
<a href="#l111.74"></a><span id="l111.74">     items = yield pclient.getAllItems();</span>
<a href="#l111.75"></a><span id="l111.75">     equal(items.length, 2);</span>
<a href="#l111.76"></a><span id="l111.76">     equal(items[1].id, addedTask.id);</span>
<a href="#l111.77"></a><span id="l111.77"> </span>
<a href="#l111.78"></a><span id="l111.78" class="difflineminus">-    equal(gServer.events.length, 1)</span>
<a href="#l111.79"></a><span id="l111.79" class="difflineplus">+    equal(gServer.events.length, 1);</span>
<a href="#l111.80"></a><span id="l111.80">     equal(gServer.tasks.length, 1);</span>
<a href="#l111.81"></a><span id="l111.81"> </span>
<a href="#l111.82"></a><span id="l111.82">     // Modify an event</span>
<a href="#l111.83"></a><span id="l111.83">     let newEvent = items[0].clone();</span>
<a href="#l111.84"></a><span id="l111.84">     newEvent.title = &quot;changed&quot;;</span>
<a href="#l111.85"></a><span id="l111.85"> </span>
<a href="#l111.86"></a><span id="l111.86">     let modifiedEvent = yield pclient.modifyItem(newEvent, items[0]);</span>
<a href="#l111.87"></a><span id="l111.87">     equal(modifiedEvent.title, &quot;changed&quot;);</span>
<a href="#l111.88"></a><span id="l111.88" class="difflineat">@@ -1371,17 +1371,17 @@ add_task(function* test_metadata() {</span>
<a href="#l111.89"></a><span id="l111.89">         &quot;updated&quot;: &quot;2014-09-08T16:30:27.000Z&quot;,</span>
<a href="#l111.90"></a><span id="l111.90">         &quot;selfLink&quot;: gServer.baseUri + &quot;/tasks/v1/lists/MTEyMDE2MDE5NzE0NjYzMDk4ODI6MDow/tasks/MTEyMDE2MDE5NzE0NjYzMDk4ODI6MDo0MDI1NDg2NjU&quot;,</span>
<a href="#l111.91"></a><span id="l111.91">         &quot;notes&quot;: &quot;description&quot;</span>
<a href="#l111.92"></a><span id="l111.92">     }];</span>
<a href="#l111.93"></a><span id="l111.93"> </span>
<a href="#l111.94"></a><span id="l111.94">     let idToEtag = {</span>
<a href="#l111.95"></a><span id="l111.95">         &quot;go6ijb0b46hlpbu4eeu92njevo@google.com&quot;: '&quot;1&quot;',</span>
<a href="#l111.96"></a><span id="l111.96">         &quot;MTEyMDE2MDE5NzE0NjYzMDk4ODI6MDo0MDI1NDg2NjU&quot;: '&quot;2&quot;'</span>
<a href="#l111.97"></a><span id="l111.97" class="difflineminus">-    }</span>
<a href="#l111.98"></a><span id="l111.98" class="difflineplus">+    };</span>
<a href="#l111.99"></a><span id="l111.99"> </span>
<a href="#l111.100"></a><span id="l111.100">     let client = yield gServer.getClient();</span>
<a href="#l111.101"></a><span id="l111.101">     let offline = client.wrappedJSObject.mCachedCalendar;</span>
<a href="#l111.102"></a><span id="l111.102">     let pclient = cal.async.promisifyCalendar(client.wrappedJSObject);</span>
<a href="#l111.103"></a><span id="l111.103"> </span>
<a href="#l111.104"></a><span id="l111.104">     // Check initial metadata</span>
<a href="#l111.105"></a><span id="l111.105">     let items = yield pclient.getAllItems();</span>
<a href="#l111.106"></a><span id="l111.106">     let meta = getAllMeta(offline);</span>
<a href="#l111.107"></a><span id="l111.107" class="difflineat">@@ -1553,17 +1553,17 @@ add_task(function* test_conflict_modify(</span>
<a href="#l111.108"></a><span id="l111.108">     MockConflictPrompt.overwrite = true;</span>
<a href="#l111.109"></a><span id="l111.109">     let newItem = item.clone();</span>
<a href="#l111.110"></a><span id="l111.110">     newItem.title = &quot;local change&quot;;</span>
<a href="#l111.111"></a><span id="l111.111">     gServer.events[0].etag = '&quot;2&quot;';</span>
<a href="#l111.112"></a><span id="l111.112">     gServer.events[0].summary = &quot;remote change&quot;;</span>
<a href="#l111.113"></a><span id="l111.113">     let modifiedItem = yield pclient.modifyItem(newItem, item);</span>
<a href="#l111.114"></a><span id="l111.114">     item = (yield pclient.getAllItems())[0];</span>
<a href="#l111.115"></a><span id="l111.115">     equal(gServer.events[0].summary, &quot;local change&quot;);</span>
<a href="#l111.116"></a><span id="l111.116" class="difflineminus">-    notEqual(gServer.events[0].etag, '&quot;2&quot;')</span>
<a href="#l111.117"></a><span id="l111.117" class="difflineplus">+    notEqual(gServer.events[0].etag, '&quot;2&quot;');</span>
<a href="#l111.118"></a><span id="l111.118">     equal(item.title, &quot;local change&quot;);</span>
<a href="#l111.119"></a><span id="l111.119">     equal(modifiedItem.title, &quot;local change&quot;);</span>
<a href="#l111.120"></a><span id="l111.120">     equal(gServer.events.length, 1);</span>
<a href="#l111.121"></a><span id="l111.121"> </span>
<a href="#l111.122"></a><span id="l111.122">     // Case #2: Modified on server, modify locally, don't overwrite conflict</span>
<a href="#l111.123"></a><span id="l111.123">     MockConflictPrompt.overwrite = false;</span>
<a href="#l111.124"></a><span id="l111.124">     gServer.events[0].etag = '&quot;3&quot;';</span>
<a href="#l111.125"></a><span id="l111.125">     gServer.events[0].summary = &quot;remote change&quot;;</span>
<a href="#l111.126"></a><span id="l111.126" class="difflineat">@@ -1576,17 +1576,17 @@ add_task(function* test_conflict_modify(</span>
<a href="#l111.127"></a><span id="l111.127">             throw e;</span>
<a href="#l111.128"></a><span id="l111.128">         }</span>
<a href="#l111.129"></a><span id="l111.129">     }</span>
<a href="#l111.130"></a><span id="l111.130"> </span>
<a href="#l111.131"></a><span id="l111.131">     yield gServer.waitForLoad(client);</span>
<a href="#l111.132"></a><span id="l111.132"> </span>
<a href="#l111.133"></a><span id="l111.133">     item = (yield pclient.getAllItems())[0];</span>
<a href="#l111.134"></a><span id="l111.134">     equal(gServer.events[0].summary, &quot;remote change&quot;);</span>
<a href="#l111.135"></a><span id="l111.135" class="difflineminus">-    equal(gServer.events[0].etag, '&quot;3&quot;')</span>
<a href="#l111.136"></a><span id="l111.136" class="difflineplus">+    equal(gServer.events[0].etag, '&quot;3&quot;');</span>
<a href="#l111.137"></a><span id="l111.137">     equal(item.title, &quot;remote change&quot;);</span>
<a href="#l111.138"></a><span id="l111.138"> </span>
<a href="#l111.139"></a><span id="l111.139">     // Case #3: Modified on server, delete locally, don't overwrite conflict</span>
<a href="#l111.140"></a><span id="l111.140">     MockConflictPrompt.overwrite = false;</span>
<a href="#l111.141"></a><span id="l111.141">     gServer.events[0].etag = '&quot;4&quot;';</span>
<a href="#l111.142"></a><span id="l111.142">     gServer.events[0].summary = &quot;remote change&quot;;</span>
<a href="#l111.143"></a><span id="l111.143">     try {</span>
<a href="#l111.144"></a><span id="l111.144">         yield pclient.deleteItem(item);</span>
<a href="#l111.145"></a><span id="l111.145" class="difflineat">@@ -1597,17 +1597,17 @@ add_task(function* test_conflict_modify(</span>
<a href="#l111.146"></a><span id="l111.146">             throw e;</span>
<a href="#l111.147"></a><span id="l111.147">         }</span>
<a href="#l111.148"></a><span id="l111.148">     }</span>
<a href="#l111.149"></a><span id="l111.149"> </span>
<a href="#l111.150"></a><span id="l111.150">     yield gServer.waitForLoad(client);</span>
<a href="#l111.151"></a><span id="l111.151"> </span>
<a href="#l111.152"></a><span id="l111.152">     item = (yield pclient.getAllItems())[0];</span>
<a href="#l111.153"></a><span id="l111.153">     equal(gServer.events[0].summary, &quot;remote change&quot;);</span>
<a href="#l111.154"></a><span id="l111.154" class="difflineminus">-    equal(gServer.events[0].etag, '&quot;4&quot;')</span>
<a href="#l111.155"></a><span id="l111.155" class="difflineplus">+    equal(gServer.events[0].etag, '&quot;4&quot;');</span>
<a href="#l111.156"></a><span id="l111.156">     equal(item.title, &quot;remote change&quot;);</span>
<a href="#l111.157"></a><span id="l111.157"> </span>
<a href="#l111.158"></a><span id="l111.158">     // Case #4: Modified on server, delete locally, overwrite conflict</span>
<a href="#l111.159"></a><span id="l111.159">     MockConflictPrompt.overwrite = true;</span>
<a href="#l111.160"></a><span id="l111.160">     gServer.events[0].etag = '&quot;5&quot;';</span>
<a href="#l111.161"></a><span id="l111.161">     gServer.events[0].summary = &quot;remote change&quot;;</span>
<a href="#l111.162"></a><span id="l111.162">     yield pclient.deleteItem(item);</span>
<a href="#l111.163"></a><span id="l111.163">     item = (yield pclient.getAllItems())[0];</span>
<a href="#l111.164"></a><span id="l111.164" class="difflineat">@@ -1643,17 +1643,17 @@ add_task(function* test_conflict_delete(</span>
<a href="#l111.165"></a><span id="l111.165">     // Case #1: Deleted on server, modify locally, overwrite conflict</span>
<a href="#l111.166"></a><span id="l111.166">     MockConflictPrompt.overwrite = true;</span>
<a href="#l111.167"></a><span id="l111.167">     gServer.events = [];</span>
<a href="#l111.168"></a><span id="l111.168">     let newItem = item.clone();</span>
<a href="#l111.169"></a><span id="l111.169">     newItem.title = &quot;local change&quot;;</span>
<a href="#l111.170"></a><span id="l111.170">     let modifiedItem = yield pclient.modifyItem(newItem, item);</span>
<a href="#l111.171"></a><span id="l111.171">     item = (yield pclient.getAllItems())[0];</span>
<a href="#l111.172"></a><span id="l111.172">     equal(gServer.events[0].summary, &quot;local change&quot;);</span>
<a href="#l111.173"></a><span id="l111.173" class="difflineminus">-    notEqual(gServer.events[0].etag, '&quot;2&quot;')</span>
<a href="#l111.174"></a><span id="l111.174" class="difflineplus">+    notEqual(gServer.events[0].etag, '&quot;2&quot;');</span>
<a href="#l111.175"></a><span id="l111.175">     equal(item.title, &quot;local change&quot;);</span>
<a href="#l111.176"></a><span id="l111.176">     equal(modifiedItem.title, &quot;local change&quot;);</span>
<a href="#l111.177"></a><span id="l111.177">     equal(gServer.events.length, 1);</span>
<a href="#l111.178"></a><span id="l111.178"> </span>
<a href="#l111.179"></a><span id="l111.179">     // Case #2: Deleted on server, modify locally, don't overwrite conflict</span>
<a href="#l111.180"></a><span id="l111.180">     MockConflictPrompt.overwrite = false;</span>
<a href="#l111.181"></a><span id="l111.181">     gServer.events = [];</span>
<a href="#l111.182"></a><span id="l111.182">     try {</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l112.1"></a><span id="l112.1" class="difflineminus">--- a/calendar/test/unit/test_hashedarray.js</span>
<a href="#l112.2"></a><span id="l112.2" class="difflineplus">+++ b/calendar/test/unit/test_hashedarray.js</span>
<a href="#l112.3"></a><span id="l112.3" class="difflineat">@@ -14,17 +14,17 @@ function run_test() {</span>
<a href="#l112.4"></a><span id="l112.4">  * Helper function to create an item that has a sensible hash id, with the given</span>
<a href="#l112.5"></a><span id="l112.5">  * title identification.</span>
<a href="#l112.6"></a><span id="l112.6">  *</span>
<a href="#l112.7"></a><span id="l112.7">  * @param ident     The title to identify the item.</span>
<a href="#l112.8"></a><span id="l112.8">  * @return          The created item.</span>
<a href="#l112.9"></a><span id="l112.9">  */</span>
<a href="#l112.10"></a><span id="l112.10"> function hashedCreateItem(ident) {</span>
<a href="#l112.11"></a><span id="l112.11">     let item = cal.createEvent();</span>
<a href="#l112.12"></a><span id="l112.12" class="difflineminus">-    item.calendar = { id: &quot;test&quot; }</span>
<a href="#l112.13"></a><span id="l112.13" class="difflineplus">+    item.calendar = { id: &quot;test&quot; };</span>
<a href="#l112.14"></a><span id="l112.14">     item.id = cal.getUUID();</span>
<a href="#l112.15"></a><span id="l112.15">     item.title = ident;</span>
<a href="#l112.16"></a><span id="l112.16">     return item;</span>
<a href="#l112.17"></a><span id="l112.17"> }</span>
<a href="#l112.18"></a><span id="l112.18"> </span>
<a href="#l112.19"></a><span id="l112.19"> /**</span>
<a href="#l112.20"></a><span id="l112.20">  * Comparator function to sort the items by their title</span>
<a href="#l112.21"></a><span id="l112.21">  *</span>
<a href="#l112.22"></a><span id="l112.22" class="difflineat">@@ -47,17 +47,17 @@ function titleComptor(a, b) {</span>
<a href="#l112.23"></a><span id="l112.23">  * items array.</span>
<a href="#l112.24"></a><span id="l112.24">  *</span>
<a href="#l112.25"></a><span id="l112.25">  * @param har           The Hashed Array</span>
<a href="#l112.26"></a><span id="l112.26">  * @param testItems     The array of test items</span>
<a href="#l112.27"></a><span id="l112.27">  * @param itemAccessor  The accessor func to retrieve the items</span>
<a href="#l112.28"></a><span id="l112.28">  * @throws Exception    If the arrays are not the same.</span>
<a href="#l112.29"></a><span id="l112.29">  */</span>
<a href="#l112.30"></a><span id="l112.30"> function checkConsistancy(har, testItems, itemAccessor) {</span>
<a href="#l112.31"></a><span id="l112.31" class="difflineminus">-    itemAccessor = itemAccessor || function(o) { return o; }</span>
<a href="#l112.32"></a><span id="l112.32" class="difflineplus">+    itemAccessor = itemAccessor || function(o) { return o; };</span>
<a href="#l112.33"></a><span id="l112.33">     for (let idx in testItems) {</span>
<a href="#l112.34"></a><span id="l112.34">         let ti = itemAccessor(testItems[idx]);</span>
<a href="#l112.35"></a><span id="l112.35">         equal(itemAccessor(har.itemByIndex(idx)).title,</span>
<a href="#l112.36"></a><span id="l112.36">                     ti.title);</span>
<a href="#l112.37"></a><span id="l112.37">         equal(itemAccessor(har.itemById(ti.hashId)).title,</span>
<a href="#l112.38"></a><span id="l112.38">                     ti.title);</span>
<a href="#l112.39"></a><span id="l112.39">         equal(har.indexOf(testItems[idx]), idx);</span>
<a href="#l112.40"></a><span id="l112.40">     }</span>
<a href="#l112.41"></a><span id="l112.41" class="difflineat">@@ -85,17 +85,17 @@ function dumpArray(ar) {</span>
<a href="#l112.42"></a><span id="l112.42">  * @param itemAccessor      (optional) The function to access the item for an</span>
<a href="#l112.43"></a><span id="l112.43">  *                            array element.</span>
<a href="#l112.44"></a><span id="l112.44">  * @param itemCreator       (optional) Function to create a new item for the</span>
<a href="#l112.45"></a><span id="l112.45">  *                            array.</span>
<a href="#l112.46"></a><span id="l112.46">  */</span>
<a href="#l112.47"></a><span id="l112.47"> function testRemoveModify(har, testItems, postprocessFunc, itemAccessor, itemCreator) {</span>
<a href="#l112.48"></a><span id="l112.48">     postprocessFunc = postprocessFunc || function(a, b) { return [a, b]; };</span>
<a href="#l112.49"></a><span id="l112.49">     itemCreator = itemCreator || (title =&gt; hashedCreateItem(title));</span>
<a href="#l112.50"></a><span id="l112.50" class="difflineminus">-    itemAccessor = itemAccessor || function(o) { return o; }</span>
<a href="#l112.51"></a><span id="l112.51" class="difflineplus">+    itemAccessor = itemAccessor || function(o) { return o; };</span>
<a href="#l112.52"></a><span id="l112.52"> </span>
<a href="#l112.53"></a><span id="l112.53">     // Now, delete the second item and check again</span>
<a href="#l112.54"></a><span id="l112.54">     har.removeById(itemAccessor(testItems[1]).hashId);</span>
<a href="#l112.55"></a><span id="l112.55">     testItems.splice(1, 1);</span>
<a href="#l112.56"></a><span id="l112.56">     [har, testItems] = postprocessFunc(har, testItems);</span>
<a href="#l112.57"></a><span id="l112.57"> </span>
<a href="#l112.58"></a><span id="l112.58">     checkConsistancy(har, testItems, itemAccessor);</span>
<a href="#l112.59"></a><span id="l112.59"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l113.1"></a><span id="l113.1" class="difflineminus">--- a/calendar/test/unit/test_ics_parser.js</span>
<a href="#l113.2"></a><span id="l113.2" class="difflineplus">+++ b/calendar/test/unit/test_ics_parser.js</span>
<a href="#l113.3"></a><span id="l113.3" class="difflineat">@@ -42,17 +42,17 @@ function test_props_comps() {</span>
<a href="#l113.4"></a><span id="l113.4">     equal(comps[0].componentType, &quot;VJOURNAL&quot;);</span>
<a href="#l113.5"></a><span id="l113.5">     equal(comps[0].location, &quot;BEFORE TIME&quot;);</span>
<a href="#l113.6"></a><span id="l113.6"> }</span>
<a href="#l113.7"></a><span id="l113.7"> </span>
<a href="#l113.8"></a><span id="l113.8"> function test_failures() {</span>
<a href="#l113.9"></a><span id="l113.9">     let parser = Components.classes[&quot;@mozilla.org/calendar/ics-parser;1&quot;]</span>
<a href="#l113.10"></a><span id="l113.10">                            .createInstance(Components.interfaces.calIIcsParser);</span>
<a href="#l113.11"></a><span id="l113.11"> </span>
<a href="#l113.12"></a><span id="l113.12" class="difflineminus">-    do_test_pending()</span>
<a href="#l113.13"></a><span id="l113.13" class="difflineplus">+    do_test_pending();</span>
<a href="#l113.14"></a><span id="l113.14">     parser.parseString(&quot;BOGUS&quot;, null, {</span>
<a href="#l113.15"></a><span id="l113.15">         onParsingComplete: function(rc, parser) {</span>
<a href="#l113.16"></a><span id="l113.16">             dump(&quot;Note: The previous error message is expected ^^\n&quot;);</span>
<a href="#l113.17"></a><span id="l113.17">             equal(rc, Components.results.NS_ERROR_FAILURE);</span>
<a href="#l113.18"></a><span id="l113.18">             do_test_finished();</span>
<a href="#l113.19"></a><span id="l113.19">         }</span>
<a href="#l113.20"></a><span id="l113.20">     });</span>
<a href="#l113.21"></a><span id="l113.21"> </span>
<a href="#l113.22"></a><span id="l113.22" class="difflineat">@@ -191,17 +191,17 @@ function test_roundtrip() {</span>
<a href="#l113.23"></a><span id="l113.23"> </span>
<a href="#l113.24"></a><span id="l113.24">     items = parser.getItems({});</span>
<a href="#l113.25"></a><span id="l113.25">     let comps = parser.getComponents({});</span>
<a href="#l113.26"></a><span id="l113.26">     let props = parser.getProperties({});</span>
<a href="#l113.27"></a><span id="l113.27">     equal(items.length, 1);</span>
<a href="#l113.28"></a><span id="l113.28">     equal(comps.length, 1);</span>
<a href="#l113.29"></a><span id="l113.29">     equal(props.length, 1);</span>
<a href="#l113.30"></a><span id="l113.30"> </span>
<a href="#l113.31"></a><span id="l113.31" class="difflineminus">-    let everything = items[0].icalString.split(&quot;\r\n&quot;).concat(comps[0].serializeToICS().split(&quot;\r\n&quot;))</span>
<a href="#l113.32"></a><span id="l113.32" class="difflineplus">+    let everything = items[0].icalString.split(&quot;\r\n&quot;).concat(comps[0].serializeToICS().split(&quot;\r\n&quot;));</span>
<a href="#l113.33"></a><span id="l113.33">     everything.push((props[0].icalString.split(&quot;\r\n&quot;))[0]);</span>
<a href="#l113.34"></a><span id="l113.34">     everything.sort();</span>
<a href="#l113.35"></a><span id="l113.35"> </span>
<a href="#l113.36"></a><span id="l113.36">     equal(everything.join(&quot;\r\n&quot;), str.split(&quot;\r\n&quot;).concat([&quot;&quot;]).sort().join(&quot;\r\n&quot;));</span>
<a href="#l113.37"></a><span id="l113.37"> </span>
<a href="#l113.38"></a><span id="l113.38">     // Test serializeToStream/parseFromStream</span>
<a href="#l113.39"></a><span id="l113.39">     parser = Components.classes[&quot;@mozilla.org/calendar/ics-parser;1&quot;]</span>
<a href="#l113.40"></a><span id="l113.40">                        .createInstance(Components.interfaces.calIIcsParser);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l114.1"></a><span id="l114.1" class="difflineminus">--- a/calendar/test/unit/test_recur.js</span>
<a href="#l114.2"></a><span id="l114.2" class="difflineplus">+++ b/calendar/test/unit/test_recur.js</span>
<a href="#l114.3"></a><span id="l114.3" class="difflineat">@@ -533,17 +533,17 @@ function test_interface() {</span>
<a href="#l114.4"></a><span id="l114.4">     newRItems[1].date = cal.createDateTime(&quot;20020404T114500Z&quot;);</span>
<a href="#l114.5"></a><span id="l114.5"> </span>
<a href="#l114.6"></a><span id="l114.6">     rinfo.setRecurrenceItems(2, newRItems);</span>
<a href="#l114.7"></a><span id="l114.7">     let itemString = item.icalString;</span>
<a href="#l114.8"></a><span id="l114.8"> </span>
<a href="#l114.9"></a><span id="l114.9">     equal(itemString.match(/RRULE:[A-Z=,]*FREQ=WEEKLY/), null);</span>
<a href="#l114.10"></a><span id="l114.10">     equal(itemString.match(/EXDATE[A-Z;=-]*:20020403T114500Z/, null));</span>
<a href="#l114.11"></a><span id="l114.11">     equal(itemString.match(/RDATE[A-Z;=-]*:20020401T114500Z/, null));</span>
<a href="#l114.12"></a><span id="l114.12" class="difflineminus">-    notEqual(itemString.match(/RRULE:[A-Z=,]*FREQ=DAILY/), null)</span>
<a href="#l114.13"></a><span id="l114.13" class="difflineplus">+    notEqual(itemString.match(/RRULE:[A-Z=,]*FREQ=DAILY/), null);</span>
<a href="#l114.14"></a><span id="l114.14">     notEqual(itemString.match(/EXDATE[A-Z;=-]*:20020404T114500Z/, null));</span>
<a href="#l114.15"></a><span id="l114.15"> </span>
<a href="#l114.16"></a><span id="l114.16">     // This may be an implementation detail, but we don't want this breaking</span>
<a href="#l114.17"></a><span id="l114.17">     rinfo.wrappedJSObject.ensureSortedRecurrenceRules();</span>
<a href="#l114.18"></a><span id="l114.18">     equal(rinfo.wrappedJSObject.mNegativeRules[0].icalProperty.icalString, newRItems[1].icalProperty.icalString);</span>
<a href="#l114.19"></a><span id="l114.19">     equal(rinfo.wrappedJSObject.mPositiveRules[0].icalProperty.icalString, newRItems[0].icalProperty.icalString);</span>
<a href="#l114.20"></a><span id="l114.20"> </span>
<a href="#l114.21"></a><span id="l114.21">     // countRecurrenceItems</span>
<a href="#l114.22"></a><span id="l114.22" class="difflineat">@@ -597,17 +597,17 @@ function test_interface() {</span>
<a href="#l114.23"></a><span id="l114.23">                           &quot;RRULE:FREQ=WEEKLY;BYDAY=TU,WE\n&quot;);</span>
<a href="#l114.24"></a><span id="l114.24">     ok(!item2.recurrenceInfo.isFinite);</span>
<a href="#l114.25"></a><span id="l114.25"> </span>
<a href="#l114.26"></a><span id="l114.26">     // removeOccurrenceAt/restoreOccurreceAt</span>
<a href="#l114.27"></a><span id="l114.27">     let occDate1 = cal.createDateTime(&quot;20020403T114500Z&quot;);</span>
<a href="#l114.28"></a><span id="l114.28">     let occDate2 = cal.createDateTime(&quot;20020404T114500Z&quot;);</span>
<a href="#l114.29"></a><span id="l114.29">     rinfo.removeOccurrenceAt(occDate1);</span>
<a href="#l114.30"></a><span id="l114.30">     ok(item.icalString.includes(&quot;EXDATE&quot;));</span>
<a href="#l114.31"></a><span id="l114.31" class="difflineminus">-    rinfo.restoreOccurrenceAt(occDate1)</span>
<a href="#l114.32"></a><span id="l114.32" class="difflineplus">+    rinfo.restoreOccurrenceAt(occDate1);</span>
<a href="#l114.33"></a><span id="l114.33">     ok(!item.icalString.includes(&quot;EXDATE&quot;));</span>
<a href="#l114.34"></a><span id="l114.34"> </span>
<a href="#l114.35"></a><span id="l114.35">     // modifyException / getExceptionFor</span>
<a href="#l114.36"></a><span id="l114.36">     let occ1 = rinfo.getOccurrenceFor(occDate1);</span>
<a href="#l114.37"></a><span id="l114.37">     occ1.startDate = cal.createDateTime(&quot;20020401T114500&quot;);</span>
<a href="#l114.38"></a><span id="l114.38">     rinfo.modifyException(occ1, true);</span>
<a href="#l114.39"></a><span id="l114.39">     ok(rinfo.getExceptionFor(occDate1) != null);</span>
<a href="#l114.40"></a><span id="l114.40"> </span>
<a href="#l114.41"></a><span id="l114.41" class="difflineat">@@ -665,26 +665,26 @@ function test_rrule_interface() {</span>
<a href="#l114.42"></a><span id="l114.42">     equal(rrule.type, &quot;MONTHLY&quot;);</span>
<a href="#l114.43"></a><span id="l114.43">     equal(rrule.icalString.match(/FREQ=MONTHLY/), &quot;FREQ=MONTHLY&quot;);</span>
<a href="#l114.44"></a><span id="l114.44"> </span>
<a href="#l114.45"></a><span id="l114.45">     // untilDate (without UTC)</span>
<a href="#l114.46"></a><span id="l114.46">     rrule.count = 3;</span>
<a href="#l114.47"></a><span id="l114.47">     let untilDate = cal.createDateTime();</span>
<a href="#l114.48"></a><span id="l114.48">     untilDate.timezone = cal.getTimezoneService().getTimezone(&quot;Europe/Berlin&quot;);</span>
<a href="#l114.49"></a><span id="l114.49">     rrule.untilDate = untilDate;</span>
<a href="#l114.50"></a><span id="l114.50" class="difflineminus">-    ok(!rrule.isByCount)</span>
<a href="#l114.51"></a><span id="l114.51" class="difflineplus">+    ok(!rrule.isByCount);</span>
<a href="#l114.52"></a><span id="l114.52">     throws(() =&gt; rrule.count, /0x80004005/);</span>
<a href="#l114.53"></a><span id="l114.53">     equal(rrule.untilDate.icalString, untilDate.getInTimezone(cal.UTC()).icalString);</span>
<a href="#l114.54"></a><span id="l114.54"> </span>
<a href="#l114.55"></a><span id="l114.55">     // untilDate (with UTC)</span>
<a href="#l114.56"></a><span id="l114.56">     rrule.count = 3;</span>
<a href="#l114.57"></a><span id="l114.57">     untilDate = cal.createDateTime();</span>
<a href="#l114.58"></a><span id="l114.58">     untilDate.timezone = cal.UTC();</span>
<a href="#l114.59"></a><span id="l114.59">     rrule.untilDate = untilDate;</span>
<a href="#l114.60"></a><span id="l114.60" class="difflineminus">-    ok(!rrule.isByCount)</span>
<a href="#l114.61"></a><span id="l114.61" class="difflineplus">+    ok(!rrule.isByCount);</span>
<a href="#l114.62"></a><span id="l114.62">     throws(() =&gt; rrule.count, /0x80004005/);</span>
<a href="#l114.63"></a><span id="l114.63">     equal(rrule.untilDate.icalString, untilDate.icalString);</span>
<a href="#l114.64"></a><span id="l114.64"> }</span>
<a href="#l114.65"></a><span id="l114.65"> </span>
<a href="#l114.66"></a><span id="l114.66"> function test_startdate_change() {</span>
<a href="#l114.67"></a><span id="l114.67">     // Setting a start date if its missing shouldn't throw</span>
<a href="#l114.68"></a><span id="l114.68">     let item = makeEvent(&quot;DTEND:20020402T124500Z\r\n&quot; +</span>
<a href="#l114.69"></a><span id="l114.69">                          &quot;RRULE:FREQ=DAILY\r\n&quot;);</span>
<a href="#l114.70"></a><span id="l114.70" class="difflineat">@@ -767,17 +767,17 @@ function test_failures() {</span>
<a href="#l114.71"></a><span id="l114.71">     throws(() =&gt; rinfo.deleteRecurrenceItem(ritem), /Illegal value/, &quot;Invalid Argument&quot;);</span>
<a href="#l114.72"></a><span id="l114.72">     throws(() =&gt; rinfo.insertRecurrenceItemAt(ritem, -1), /Illegal value/, &quot;Invalid Argument&quot;);</span>
<a href="#l114.73"></a><span id="l114.73">     throws(() =&gt; rinfo.insertRecurrenceItemAt(ritem, 2), /Illegal value/, &quot;Invalid Argument&quot;);</span>
<a href="#l114.74"></a><span id="l114.74">     throws(() =&gt; rinfo.restoreOccurrenceAt(cal.createDateTime(&quot;20080101T010101&quot;)), /Illegal value/, &quot;Invalid Argument&quot;);</span>
<a href="#l114.75"></a><span id="l114.75">     throws(() =&gt; cal.createRecurrenceInfo().isFinite, /Component not initialized/);</span>
<a href="#l114.76"></a><span id="l114.76"> </span>
<a href="#l114.77"></a><span id="l114.77">     // modifyException with a different parent item</span>
<a href="#l114.78"></a><span id="l114.78">     let occ = rinfo.getOccurrenceFor(cal.createDateTime(&quot;20120102T114500Z&quot;));</span>
<a href="#l114.79"></a><span id="l114.79" class="difflineminus">-    occ.calendar = {}</span>
<a href="#l114.80"></a><span id="l114.80" class="difflineplus">+    occ.calendar = {};</span>
<a href="#l114.81"></a><span id="l114.81">     occ.id = &quot;1234&quot;;</span>
<a href="#l114.82"></a><span id="l114.82">     occ.parentItem = occ;</span>
<a href="#l114.83"></a><span id="l114.83">     throws(() =&gt; rinfo.modifyException(occ, true), /Illegal value/, &quot;Invalid Argument&quot;);</span>
<a href="#l114.84"></a><span id="l114.84"> </span>
<a href="#l114.85"></a><span id="l114.85">     occ = rinfo.getOccurrenceFor(cal.createDateTime(&quot;20120102T114500Z&quot;));</span>
<a href="#l114.86"></a><span id="l114.86">     occ.recurrenceId = null;</span>
<a href="#l114.87"></a><span id="l114.87">     throws(() =&gt; rinfo.modifyException(occ, true), /Illegal value/, &quot;Invalid Argument&quot;);</span>
<a href="#l114.88"></a><span id="l114.88"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l115.1"></a><span id="l115.1" class="difflineminus">--- a/calendar/test/unit/test_relation.js</span>
<a href="#l115.2"></a><span id="l115.2" class="difflineplus">+++ b/calendar/test/unit/test_relation.js</span>
<a href="#l115.3"></a><span id="l115.3" class="difflineat">@@ -9,17 +9,17 @@ function run_test() {</span>
<a href="#l115.4"></a><span id="l115.4">     // Create Items</span>
<a href="#l115.5"></a><span id="l115.5">     let e1 = cal.createEvent();</span>
<a href="#l115.6"></a><span id="l115.6">     let e2 = cal.createEvent();</span>
<a href="#l115.7"></a><span id="l115.7"> </span>
<a href="#l115.8"></a><span id="l115.8">     // Testing relation set/get.</span>
<a href="#l115.9"></a><span id="l115.9">     let properties = {</span>
<a href="#l115.10"></a><span id="l115.10">         relType: &quot;PARENT&quot;,</span>
<a href="#l115.11"></a><span id="l115.11">         relId: e2.id</span>
<a href="#l115.12"></a><span id="l115.12" class="difflineminus">-    }</span>
<a href="#l115.13"></a><span id="l115.13" class="difflineplus">+    };</span>
<a href="#l115.14"></a><span id="l115.14"> </span>
<a href="#l115.15"></a><span id="l115.15">     for (let [property, value] in Iterator(properties)) {</span>
<a href="#l115.16"></a><span id="l115.16">         r1[property] = value;</span>
<a href="#l115.17"></a><span id="l115.17">         equal(r1[property], value);</span>
<a href="#l115.18"></a><span id="l115.18">     }</span>
<a href="#l115.19"></a><span id="l115.19"> </span>
<a href="#l115.20"></a><span id="l115.20">     // Add relation to event</span>
<a href="#l115.21"></a><span id="l115.21">     e1.addRelation(r1);</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l116.1"></a><span id="l116.1" class="difflineminus">--- a/calendar/test/unit/test_rfc3339_parser.js</span>
<a href="#l116.2"></a><span id="l116.2" class="difflineplus">+++ b/calendar/test/unit/test_rfc3339_parser.js</span>
<a href="#l116.3"></a><span id="l116.3" class="difflineat">@@ -28,17 +28,17 @@ function really_run_test() {</span>
<a href="#l116.4"></a><span id="l116.4">             timezone: aExpectedDateTime[6],</span>
<a href="#l116.5"></a><span id="l116.5">             isDate: aExpectedDateTime[7]</span>
<a href="#l116.6"></a><span id="l116.6">         };</span>
<a href="#l116.7"></a><span id="l116.7">         for (let prop in expectedDateProps) {</span>
<a href="#l116.8"></a><span id="l116.8">             do_print(&quot;Checking prop: &quot; + prop);</span>
<a href="#l116.9"></a><span id="l116.9">             // Object comparison fails with ical.js, and we only want to check</span>
<a href="#l116.10"></a><span id="l116.10">             // that we have the right timezone.</span>
<a href="#l116.11"></a><span id="l116.11">             if (prop == &quot;timezone&quot;) {</span>
<a href="#l116.12"></a><span id="l116.12" class="difflineminus">-                equal(dateTime[prop].tzid, expectedDateProps[prop].tzid)</span>
<a href="#l116.13"></a><span id="l116.13" class="difflineplus">+                equal(dateTime[prop].tzid, expectedDateProps[prop].tzid);</span>
<a href="#l116.14"></a><span id="l116.14">             } else {</span>
<a href="#l116.15"></a><span id="l116.15">                 equal(dateTime[prop], expectedDateProps[prop]);</span>
<a href="#l116.16"></a><span id="l116.16">             }</span>
<a href="#l116.17"></a><span id="l116.17">         }</span>
<a href="#l116.18"></a><span id="l116.18"> </span>
<a href="#l116.19"></a><span id="l116.19">         // Test round tripping that dateTime object back to an RFC 3339 string.</span>
<a href="#l116.20"></a><span id="l116.20">         let rfc3339Date = cal.toRFC3339(dateTime);</span>
<a href="#l116.21"></a><span id="l116.21"> </span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l117.1"></a><span id="l117.1" class="difflineminus">--- a/calendar/test/unit/test_search_service.js</span>
<a href="#l117.2"></a><span id="l117.2" class="difflineplus">+++ b/calendar/test/unit/test_search_service.js</span>
<a href="#l117.3"></a><span id="l117.3" class="difflineat">@@ -23,17 +23,17 @@ function test_found() {</span>
<a href="#l117.4"></a><span id="l117.4">         id: 1,</span>
<a href="#l117.5"></a><span id="l117.5">         searchForCalendars: function() {}</span>
<a href="#l117.6"></a><span id="l117.6">     };</span>
<a href="#l117.7"></a><span id="l117.7"> </span>
<a href="#l117.8"></a><span id="l117.8">     let provider2 = {</span>
<a href="#l117.9"></a><span id="l117.9">         id: 2,</span>
<a href="#l117.10"></a><span id="l117.10">         called: false,</span>
<a href="#l117.11"></a><span id="l117.11">         searchForCalendars: function(aStr, aHint, aMax, aListener) {</span>
<a href="#l117.12"></a><span id="l117.12" class="difflineminus">-            ok(!this.called)</span>
<a href="#l117.13"></a><span id="l117.13" class="difflineplus">+            ok(!this.called);</span>
<a href="#l117.14"></a><span id="l117.14">             this.called = true;</span>
<a href="#l117.15"></a><span id="l117.15"> </span>
<a href="#l117.16"></a><span id="l117.16">             equal(aStr, &quot;str&quot;);</span>
<a href="#l117.17"></a><span id="l117.17">             equal(aHint, HINT_EXACT_MATCH);</span>
<a href="#l117.18"></a><span id="l117.18">             equal(aMax, 0);</span>
<a href="#l117.19"></a><span id="l117.19"> </span>
<a href="#l117.20"></a><span id="l117.20">             let mockCalendar = {</span>
<a href="#l117.21"></a><span id="l117.21">                 id: &quot;test&quot;</span></pre></div><div class="diffblock"><pre class="sourcelines">
<a href="#l118.1"></a><span id="l118.1" class="difflineminus">--- a/calendar/test/unit/test_utils.js</span>
<a href="#l118.2"></a><span id="l118.2" class="difflineplus">+++ b/calendar/test/unit/test_utils.js</span>
<a href="#l118.3"></a><span id="l118.3" class="difflineat">@@ -179,12 +179,12 @@ function test_sameDay() {</span>
<a href="#l118.4"></a><span id="l118.4"> }</span>
<a href="#l118.5"></a><span id="l118.5"> </span>
<a href="#l118.6"></a><span id="l118.6"> function test_binarySearch() {</span>
<a href="#l118.7"></a><span id="l118.7">     let arr = [2, 5, 7, 9, 20, 27, 34, 39, 41, 53, 62];</span>
<a href="#l118.8"></a><span id="l118.8">     equal(binarySearch(arr, 27), 5); // Center</span>
<a href="#l118.9"></a><span id="l118.9">     equal(binarySearch(arr, 2), 0); // Left most</span>
<a href="#l118.10"></a><span id="l118.10">     equal(binarySearch(arr, 62), 11); // Right most</span>
<a href="#l118.11"></a><span id="l118.11"> </span>
<a href="#l118.12"></a><span id="l118.12" class="difflineminus">-    equal(binarySearch([5], 5), 1) // One element found</span>
<a href="#l118.13"></a><span id="l118.13" class="difflineminus">-    equal(binarySearch([1], 0), 0) // One element insert left</span>
<a href="#l118.14"></a><span id="l118.14" class="difflineminus">-    equal(binarySearch([1], 2), 1) // One element insert right</span>
<a href="#l118.15"></a><span id="l118.15" class="difflineplus">+    equal(binarySearch([5], 5), 1); // One element found</span>
<a href="#l118.16"></a><span id="l118.16" class="difflineplus">+    equal(binarySearch([1], 0), 0); // One element insert left</span>
<a href="#l118.17"></a><span id="l118.17" class="difflineplus">+    equal(binarySearch([1], 2), 1); // One element insert right</span>
<a href="#l118.18"></a><span id="l118.18"> }</span></pre></div></div>

<div class="page_footer">
<div class="page_footer_text">comm-central</div>
<div class="page_footer_text" style="padding-left: 10px">Deployed from <a href="https://hg.mozilla.org/hgcustom/version-control-tools/rev/35f393d6769a">35f393d6769a</a> at 2020-07-16T17:23:43Z.</div>
<div class="rss_logo">
<a href="/comm-central/rss-log">RSS</a>
<a href="/comm-central/atom-log">Atom</a>
</div>
<br />

</div>
</body>
</html>

